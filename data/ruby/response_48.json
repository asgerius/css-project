[{"tags": ["ruby-on-rails", "ruby", "activerecord", "migration"], "comments": [{"owner": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1449703885, "post_id": 34190920, "comment_id": 56128398, "body": "it says you have a &quot;duplicate column name: email&quot;..."}, {"owner": {"reputation": 267, "user_id": 4656993, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/757dbff2728d60d50976c772e7e689f4?s=128&d=identicon&r=PG", "display_name": "Kim", "link": "https://stackoverflow.com/users/4656993/kim"}, "reply_to_user": {"reputation": 16229, "user_id": 525478, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/3b6c0b47a0c430a0b141baee7ea845be?s=128&d=identicon&r=PG", "display_name": "Brad Werth", "link": "https://stackoverflow.com/users/525478/brad-werth"}, "edited": false, "score": 0, "creation_date": 1449704753, "post_id": 34190920, "comment_id": 56128718, "body": "Any idea on how I can fix it since I didn&#39;t generate these files?"}], "answers": [{"comments": [{"owner": {"reputation": 267, "user_id": 4656993, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/757dbff2728d60d50976c772e7e689f4?s=128&d=identicon&r=PG", "display_name": "Kim", "link": "https://stackoverflow.com/users/4656993/kim"}, "edited": false, "score": 0, "creation_date": 1449706380, "post_id": 34191245, "comment_id": 56129322, "body": "I&#39;ve add the file. Could you please point me to removing the email column creation"}, {"owner": {"reputation": 267, "user_id": 4656993, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/757dbff2728d60d50976c772e7e689f4?s=128&d=identicon&r=PG", "display_name": "Kim", "link": "https://stackoverflow.com/users/4656993/kim"}, "edited": false, "score": 0, "creation_date": 1449763213, "post_id": 34191245, "comment_id": 56157195, "body": "ok...I&#39;m not sure at ALL what&#39;s going on but it finally started working once I followed the trace after running the command over and over and each time I had to comment out the next line. Can you tell me why this file was created if most of it has to be commented out?"}, {"owner": {"reputation": 3785, "user_id": 839925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfa54eccd89d7c0d2225e0ca279c1191?s=128&d=identicon&r=PG", "display_name": "Alexandre Angelim", "link": "https://stackoverflow.com/users/839925/alexandre-angelim"}, "reply_to_user": {"reputation": 267, "user_id": 4656993, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/757dbff2728d60d50976c772e7e689f4?s=128&d=identicon&r=PG", "display_name": "Kim", "link": "https://stackoverflow.com/users/4656993/kim"}, "edited": false, "score": 0, "creation_date": 1449957026, "post_id": 34191245, "comment_id": 56232573, "body": "The file is created because Devise(the authentication gem you&#39;re using) needs those columns to work properly. Take a look at your db/migrate folder and try to find another migration file with those same definitions, but under a different name. The fact that you had to comment out all of the lines implies that all of the columns were already defined on your db. They could have gotten there from another migration or manually. Did you start your project from scratch or is it based on a template? If it comes from a template, maybe they had a migration for those fields already."}], "tags": [], "owner": {"reputation": 3785, "user_id": 839925, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dfa54eccd89d7c0d2225e0ca279c1191?s=128&d=identicon&r=PG", "display_name": "Alexandre Angelim", "link": "https://stackoverflow.com/users/839925/alexandre-angelim"}, "is_accepted": true, "score": 1, "last_activity_date": 1449704979, "creation_date": 1449704979, "answer_id": 34191245, "question_id": 34190920, "link": "https://stackoverflow.com/questions/34190920/activerecordpendingmigrationerror-migrations-are-pending-to-resolve-this-iss/34191245#34191245", "title": "ActiveRecord::PendingMigrationError: Migrations are pending. To resolve this issue, run: bin/rake db:migrate RAILS_ENV=development", "body": "<p>Looking into the <code>AddDeviseToUsers</code> migration error stack trace, you may notice that you have a duplicate email column. You already have an email column on the users table and that particular migration is trying to add another one.</p>\n\n<p>I'd advise you to edit AddDeviseToUsers to remove the email column creation. If you're not familiar with Rails directory structure, you may find that file at <code>db/migrate/xxxxxxxxxxx_add_devise_to_users.rb</code></p>\n\n<p>I hope it helps.</p>\n"}], "owner": {"reputation": 267, "user_id": 4656993, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/757dbff2728d60d50976c772e7e689f4?s=128&d=identicon&r=PG", "display_name": "Kim", "link": "https://stackoverflow.com/users/4656993/kim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 559, "favorite_count": 0, "accepted_answer_id": 34191245, "answer_count": 1, "score": 0, "last_activity_date": 1449705247, "creation_date": 1449703329, "last_edit_date": 1495542655, "question_id": 34190920, "link": "https://stackoverflow.com/questions/34190920/activerecordpendingmigrationerror-migrations-are-pending-to-resolve-this-iss", "title": "ActiveRecord::PendingMigrationError: Migrations are pending. To resolve this issue, run: bin/rake db:migrate RAILS_ENV=development", "body": "<p>NEWBIE: I am trying to set up the membership part of my site. I ran the following commands: </p>\n\n<pre><code>git checkout development \ngit merge user_authentication \ngit checkout -b stripe_integration \nbundle exec rails g migration CreatePlans\n</code></pre>\n\n<p>and received the this error: </p>\n\n<pre><code>ActiveRecord::PendingMigrationError: Migrations are pending. To\nresolve this issue, run: bin/rake db:migrate RAILS_ENV=development\n</code></pre>\n\n<p>I've tried running it and other commands with no success. Below are links to other Stack Overflow answers to this issue that did not work for me and a full trace.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/31658151/migrations-are-pending\">Link from Stack Overflow 1</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/24339902/rails-app-error-activerecordpendingmigrationerror-migrations-are-pending-ru\">Link from Stack Overflow 2</a></p>\n\n<p>Full trace:</p>\n\n<pre><code>kmcrayton7:~/workspace (stripe_integration) $ bin/rake db:migrate RAILS_ENV=development\n== 20151209220651 AddDeviseToUsers: migrating =================================\n-- change_table(:users)\nrake aborted!\nStandardError: An error has occurred, this and all later migrations canceled:\n\nSQLite3::SQLException: duplicate column name: email: ALTER TABLE \"users\" ADD \"email\" varchar(255) DEFAULT '' NOT NULL/usr/local/rvm/gems/ruby-2.2.1/gems/sqlite3-1.3.11/lib/sqlite3/database.rb:91:in `initialize'\n/usr/local/rvm/gems/ruby-2.2.1/gems/sqlite3-1.3.11/lib/sqlite3/database.rb:91:in `new'\n/usr/local/rvm/gems/ruby-2.2.1/gems/sqlite3-1.3.11/lib/sqlite3/database.rb:91:in `prepare'\n/usr/local/rvm/gems/ruby-2.2.1/gems/sqlite3-1.3.11/lib/sqlite3/database.rb:134:in `execute'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/sqlite3_adapter.rb:331:in `block in execute'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract_adapter.rb:373:in `block in log'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activesupport-4.1.0/lib/active_support/notifications/instrumenter.rb:20:in `instrument'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract_adapter.rb:367:in `log'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/sqlite3_adapter.rb:331:in `execute'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract/schema_statements.rb:375:in `add_column'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/sqlite3_adapter.rb:454:in `add_column'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract/schema_definitions.rb:490:in `block (3 levels) in &lt;class:Table&gt;'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract/schema_definitions.rb:489:in `each'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract/schema_definitions.rb:489:in `block (2 levels) in &lt;class:Table&gt;'\n/home/ubuntu/workspace/db/migrate/20151209220651_add_devise_to_users.rb:5:in `block in up'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract/schema_statements.rb:349:in `change_table'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:649:in `block in method_missing'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:621:in `block in say_with_time'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:621:in `say_with_time'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:641:in `method_missing'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:406:in `method_missing'\n/home/ubuntu/workspace/db/migrate/20151209220651_add_devise_to_users.rb:3:in `up'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:558:in `up'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:598:in `exec_migration'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:579:in `block (2 levels) in migrate'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:578:in `block in migrate'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:294:in `with_connection'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:577:in `migrate'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:752:in `migrate'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:992:in `block in execute_migration_in_transaction'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:1038:in `block in ddl_transaction'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract/database_statements.rb:211:in `block in transaction'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract/database_statements.rb:219:in `within_new_transaction'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract/database_statements.rb:211:in `transaction'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/transactions.rb:208:in `transaction'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:1038:in `ddl_transaction'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:991:in `execute_migration_in_transaction'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:953:in `block in migrate'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:949:in `each'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:949:in `migrate'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:807:in `up'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:785:in `migrate'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/railties/databases.rake:34:in `block (2 levels) in &lt;top (required)&gt;'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activesupport-4.1.0/lib/active_support/dependencies.rb:241:in `load'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activesupport-4.1.0/lib/active_support/dependencies.rb:241:in `block in load'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activesupport-4.1.0/lib/active_support/dependencies.rb:232:in `load_dependency'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activesupport-4.1.0/lib/active_support/dependencies.rb:241:in `load'\n-e:1:in `&lt;main&gt;'\nActiveRecord::StatementInvalid: SQLite3::SQLException: duplicate column name: email: ALTER TABLE \"users\" ADD \"email\" varchar(255) DEFAULT '' NOT NULL\n/usr/local/rvm/gems/ruby-2.2.1/gems/sqlite3-1.3.11/lib/sqlite3/database.rb:91:in `initialize'\n/usr/local/rvm/gems/ruby-2.2.1/gems/sqlite3-1.3.11/lib/sqlite3/database.rb:91:in `new'\n/usr/local/rvm/gems/ruby-2.2.1/gems/sqlite3-1.3.11/lib/sqlite3/database.rb:91:in `prepare'\n/usr/local/rvm/gems/ruby-2.2.1/gems/sqlite3-1.3.11/lib/sqlite3/database.rb:134:in `execute'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/sqlite3_adapter.rb:331:in `block in execute'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract_adapter.rb:373:in `block in log'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activesupport-4.1.0/lib/active_support/notifications/instrumenter.rb:20:in `instrument'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract_adapter.rb:367:in `log'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/sqlite3_adapter.rb:331:in `execute'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract/schema_statements.rb:375:in `add_column'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/sqlite3_adapter.rb:454:in `add_column'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract/schema_definitions.rb:490:in `block (3 levels) in &lt;class:Table&gt;'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract/schema_definitions.rb:489:in `each'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract/schema_definitions.rb:489:in `block (2 levels) in &lt;class:Table&gt;'\n/home/ubuntu/workspace/db/migrate/20151209220651_add_devise_to_users.rb:5:in `block in up'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract/schema_statements.rb:349:in `change_table'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:649:in `block in method_missing'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:621:in `block in say_with_time'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:621:in `say_with_time'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:641:in `method_missing'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:406:in `method_missing'\n/home/ubuntu/workspace/db/migrate/20151209220651_add_devise_to_users.rb:3:in `up'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:558:in `up'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:598:in `exec_migration'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:579:in `block (2 levels) in migrate'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:578:in `block in migrate'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:294:in `with_connection'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:577:in `migrate'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:752:in `migrate'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:992:in `block in execute_migration_in_transaction'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:1038:in `block in ddl_transaction'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract/database_statements.rb:211:in `block in transaction'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract/database_statements.rb:219:in `within_new_transaction'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract/database_statements.rb:211:in `transaction'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/transactions.rb:208:in `transaction'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:1038:in `ddl_transaction'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:991:in `execute_migration_in_transaction'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:953:in `block in migrate'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:949:in `each'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:949:in `migrate'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:807:in `up'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:785:in `migrate'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/railties/databases.rake:34:in `block (2 levels) in &lt;top (required)&gt;'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activesupport-4.1.0/lib/active_support/dependencies.rb:241:in `load'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activesupport-4.1.0/lib/active_support/dependencies.rb:241:in `block in load'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activesupport-4.1.0/lib/active_support/dependencies.rb:232:in `load_dependency'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activesupport-4.1.0/lib/active_support/dependencies.rb:241:in `load'\n-e:1:in `&lt;main&gt;'\nSQLite3::SQLException: duplicate column name: email\n/usr/local/rvm/gems/ruby-2.2.1/gems/sqlite3-1.3.11/lib/sqlite3/database.rb:91:in `initialize'\n/usr/local/rvm/gems/ruby-2.2.1/gems/sqlite3-1.3.11/lib/sqlite3/database.rb:91:in `new'\n/usr/local/rvm/gems/ruby-2.2.1/gems/sqlite3-1.3.11/lib/sqlite3/database.rb:91:in `prepare'\n/usr/local/rvm/gems/ruby-2.2.1/gems/sqlite3-1.3.11/lib/sqlite3/database.rb:134:in `execute'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/sqlite3_adapter.rb:331:in `block in execute'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract_adapter.rb:373:in `block in log'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activesupport-4.1.0/lib/active_support/notifications/instrumenter.rb:20:in `instrument'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract_adapter.rb:367:in `log'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/sqlite3_adapter.rb:331:in `execute'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract/schema_statements.rb:375:in `add_column'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/sqlite3_adapter.rb:454:in `add_column'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract/schema_definitions.rb:490:in `block (3 levels) in &lt;class:Table&gt;'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract/schema_definitions.rb:489:in `each'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract/schema_definitions.rb:489:in `block (2 levels) in &lt;class:Table&gt;'\n/home/ubuntu/workspace/db/migrate/20151209220651_add_devise_to_users.rb:5:in `block in up'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract/schema_statements.rb:349:in `change_table'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:649:in `block in method_missing'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:621:in `block in say_with_time'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:621:in `say_with_time'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:641:in `method_missing'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:406:in `method_missing'\n/home/ubuntu/workspace/db/migrate/20151209220651_add_devise_to_users.rb:3:in `up'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:558:in `up'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:598:in `exec_migration'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:579:in `block (2 levels) in migrate'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:578:in `block in migrate'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract/connection_pool.rb:294:in `with_connection'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:577:in `migrate'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:752:in `migrate'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:992:in `block in execute_migration_in_transaction'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:1038:in `block in ddl_transaction'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract/database_statements.rb:211:in `block in transaction'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract/database_statements.rb:219:in `within_new_transaction'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/connection_adapters/abstract/database_statements.rb:211:in `transaction'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/transactions.rb:208:in `transaction'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:1038:in `ddl_transaction'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:991:in `execute_migration_in_transaction'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:953:in `block in migrate'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:949:in `each'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:949:in `migrate'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:807:in `up'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/migration.rb:785:in `migrate'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activerecord-4.1.0/lib/active_record/railties/databases.rake:34:in `block (2 levels) in &lt;top (required)&gt;'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activesupport-4.1.0/lib/active_support/dependencies.rb:241:in `load'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activesupport-4.1.0/lib/active_support/dependencies.rb:241:in `block in load'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activesupport-4.1.0/lib/active_support/dependencies.rb:232:in `load_dependency'\n/usr/local/rvm/gems/ruby-2.2.1/gems/activesupport-4.1.0/lib/active_support/dependencies.rb:241:in `load'\n-e:1:in `&lt;main&gt;'\nTasks: TOP =&gt; db:migrate\n(See full trace by running task with --trace)\n</code></pre>\n\n<p>Which email should I remove from the add_devise_to_user.rb file?</p>\n\n<pre><code>class AddDeviseToUsers &lt; ActiveRecord::Migration\n  def self.up\n    change_table(:users) do |t|\n      ## Database authenticatable\n      t.string :email,              null: false, default: \"\"\n      t.string :encrypted_password, null: false, default: \"\"\n\n      ## Recoverable\n      t.string   :reset_password_token\n      t.datetime :reset_password_sent_at\n\n      ## Rememberable\n      t.datetime :remember_created_at\n\n      ## Trackable\n      t.integer  :sign_in_count, default: 0, null: false\n      t.datetime :current_sign_in_at\n      t.datetime :last_sign_in_at\n      t.string   :current_sign_in_ip\n      t.string   :last_sign_in_ip\n\n      ## Confirmable\n      # t.string   :confirmation_token\n      # t.datetime :confirmed_at\n      # t.datetime :confirmation_sent_at\n      # t.string   :unconfirmed_email # Only if using reconfirmable\n\n      ## Lockable\n      # t.integer  :failed_attempts, default: 0, null: false # Only if lock strategy is :failed_attempts\n      # t.string   :unlock_token # Only if unlock strategy is :email or :both\n      # t.datetime :locked_at\n\n\n      # Uncomment below if timestamps were not included in your original model.\n      # t.timestamps\n    end\n\n    add_index :users, :email,                unique: true\n    add_index :users, :reset_password_token, unique: true\n    # add_index :users, :confirmation_token,   unique: true\n    # add_index :users, :unlock_token,         unique: true\n  end\n\n  def self.down\n    # By default, we don't want to make any assumption about how to roll back a migration when your\n    # model already existed. Please edit below which fields you would like to remove in this migration.\n    raise ActiveRecord::IrreversibleMigration\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "postgresql", "file", "uploading"], "comments": [{"owner": {"reputation": 1287, "user_id": 3137549, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/H7moE.png?s=128&g=1", "display_name": "rdnewman", "link": "https://stackoverflow.com/users/3137549/rdnewman"}, "edited": false, "score": 1, "creation_date": 1449705437, "post_id": 34190859, "comment_id": 56128995, "body": "Just confirming do you really mean <code>Table.create([...])</code>?  The <code>pg_insert</code> is an Array of Strings, but the argument to :create appears that you meant a Hash.  If it is to be a Hash, I think I have an idea for you..."}, {"owner": {"reputation": 228, "user_id": 4926416, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4d070bb169cd682d87532a39be50f5db?s=128&d=identicon&r=PG&f=1", "display_name": "mgtemp", "link": "https://stackoverflow.com/users/4926416/mgtemp"}, "reply_to_user": {"reputation": 1287, "user_id": 3137549, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/H7moE.png?s=128&g=1", "display_name": "rdnewman", "link": "https://stackoverflow.com/users/3137549/rdnewman"}, "edited": false, "score": 0, "creation_date": 1449705902, "post_id": 34190859, "comment_id": 56129142, "body": "Whatever uploads. I think it works both ways."}, {"owner": {"reputation": 228, "user_id": 4926416, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4d070bb169cd682d87532a39be50f5db?s=128&d=identicon&r=PG&f=1", "display_name": "mgtemp", "link": "https://stackoverflow.com/users/4926416/mgtemp"}, "reply_to_user": {"reputation": 1287, "user_id": 3137549, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/H7moE.png?s=128&g=1", "display_name": "rdnewman", "link": "https://stackoverflow.com/users/3137549/rdnewman"}, "edited": false, "score": 0, "creation_date": 1449706132, "post_id": 34190859, "comment_id": 56129234, "body": "Table.create(date: pg_insert[0], account_number: pg_insert[1]) works if that&#39;s what you were asking."}], "answers": [{"comments": [{"owner": {"reputation": 228, "user_id": 4926416, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4d070bb169cd682d87532a39be50f5db?s=128&d=identicon&r=PG&f=1", "display_name": "mgtemp", "link": "https://stackoverflow.com/users/4926416/mgtemp"}, "edited": false, "score": 0, "creation_date": 1450826636, "post_id": 34191858, "comment_id": 56593715, "body": "Yeah it took me a while to get back to that script, but once I tried it out it did work. Thanks!"}], "tags": [], "owner": {"reputation": 1287, "user_id": 3137549, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/H7moE.png?s=128&g=1", "display_name": "rdnewman", "link": "https://stackoverflow.com/users/3137549/rdnewman"}, "is_accepted": true, "score": 2, "last_activity_date": 1449714550, "last_edit_date": 1495541245, "creation_date": 1449708601, "answer_id": 34191858, "question_id": 34190859, "link": "https://stackoverflow.com/questions/34190859/better-way-to-loop-through-a-set-of-hashes-assigning-array-values-in-ruby/34191858#34191858", "title": "Better way to loop through a set of hashes assigning array values in Ruby", "body": "<p><code>Table.create</code> is accepting a Hash, I'm sure.</p>\n\n<p>So here is what you can do:</p>\n\n<ol>\n<li>Make an Array called <code>keys</code> that contains 4 symbols <code>:date</code>, <code>:account_number</code>, <code>:account_name</code>, and <code>:values</code>.</li>\n<li><code>pg_insert</code> is already an Array.</li>\n<li>Now you can put the two Arrays together to make the Hash you need: <code>Hash[keys.zip(pg_insert)]</code></li>\n<li>This allows you to call <code>Table.create</code> like this:  <code>Table.create(Hash[keys.zip(pg_insert)])</code></li>\n</ol>\n\n<p>Here is the finished code then:</p>\n\n<pre><code>keys = [:date, :account_number, :account_name, :values]\npg_insert = ['12/09/2015', 41, 'test account', '41.0']\nTable.create(Hash[keys.zip(pg_insert)])  # or Table.create Hash[keys.zip(pg_insert)]  if you don't want so many parentheses.\n</code></pre>\n\n<p>Note that <code>pg_insert</code> will always have to be in the same order as <code>keys</code>.</p>\n\n<p>You can read more about Array#zip and Hash.new to understand how those work.   This SO link might also be helpful: <a href=\"https://stackoverflow.com/questions/740732/converting-an-array-of-keys-and-an-array-of-values-into-a-hash-in-ruby\">Converting an array of keys and an array of values into a hash in Ruby</a></p>\n"}], "owner": {"reputation": 228, "user_id": 4926416, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4d070bb169cd682d87532a39be50f5db?s=128&d=identicon&r=PG&f=1", "display_name": "mgtemp", "link": "https://stackoverflow.com/users/4926416/mgtemp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 34191858, "answer_count": 1, "score": 0, "last_activity_date": 1449714550, "creation_date": 1449703009, "last_edit_date": 1449703693, "question_id": 34190859, "link": "https://stackoverflow.com/questions/34190859/better-way-to-loop-through-a-set-of-hashes-assigning-array-values-in-ruby", "title": "Better way to loop through a set of hashes assigning array values in Ruby", "body": "<p>I am trying to insert data into Postgres. I have an array of data and I am trying to assign each column a value of the array. Here is an example.</p>\n\n<pre><code>pg_insert = ['12/09/2015', 41, 'test account', '41.0']\nTable.create([date: pg_insert[0],\n            account_number: pg_insert[1],\n            account_name: pg_insert[2],\n            values: pg_insert[3]])\n</code></pre>\n\n<p>Is there a way where I can loop this so I can put i in pg_insert instead of having to type out numbers? I'm not sure how to loop inside of the create() parameter. Is there any way around this?</p>\n\n<p>Any suggestions would be great thanks. </p>\n"}, {"tags": ["ruby", "permissions", "homebrew"], "comments": [{"owner": {"reputation": 10812, "user_id": 1241782, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/576b21d9efadc9217270e971fd6d5027?s=128&d=identicon&r=PG", "display_name": "Mike S", "link": "https://stackoverflow.com/users/1241782/mike-s"}, "edited": false, "score": 1, "creation_date": 1449702287, "post_id": 34190642, "comment_id": 56127764, "body": "Try putting &quot;sudo&quot; in front of your command."}, {"owner": {"reputation": 546, "user_id": 5625861, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/AU7uQ.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5625861/joe"}, "reply_to_user": {"reputation": 10812, "user_id": 1241782, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/576b21d9efadc9217270e971fd6d5027?s=128&d=identicon&r=PG", "display_name": "Mike S", "link": "https://stackoverflow.com/users/1241782/mike-s"}, "edited": false, "score": 0, "creation_date": 1449702649, "post_id": 34190642, "comment_id": 56127923, "body": "Thanks Mike, this did actually pop up whilst I was looking about this site earlier and I tried it, my terminal just tells me I am cowardly, then refuses to do it?"}, {"owner": {"reputation": 10812, "user_id": 1241782, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/576b21d9efadc9217270e971fd6d5027?s=128&d=identicon&r=PG", "display_name": "Mike S", "link": "https://stackoverflow.com/users/1241782/mike-s"}, "edited": false, "score": 1, "creation_date": 1449702956, "post_id": 34190642, "comment_id": 56128065, "body": "Apparently that is because <code>brew</code> must be owned by root in order to run it as root. See this <a href=\"http://stackoverflow.com/questions/19039404/error-cowardly-refusing-to-sudo-brew-install-for-installing-glue-0-3-for-mac\" title=\"error cowardly refusing to sudo brew install for installing glue 0 3 for mac\">stackoverflow.com/questions/19039404/&hellip;</a>"}, {"owner": {"reputation": 546, "user_id": 5625861, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/AU7uQ.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5625861/joe"}, "reply_to_user": {"reputation": 10812, "user_id": 1241782, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/576b21d9efadc9217270e971fd6d5027?s=128&d=identicon&r=PG", "display_name": "Mike S", "link": "https://stackoverflow.com/users/1241782/mike-s"}, "edited": false, "score": 0, "creation_date": 1449703571, "post_id": 34190642, "comment_id": 56128276, "body": "Thanks Mike, i am working my way through that now."}], "answers": [{"comments": [{"owner": {"reputation": 546, "user_id": 5625861, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/AU7uQ.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5625861/joe"}, "edited": false, "score": 0, "creation_date": 1449704963, "post_id": 34190963, "comment_id": 56128814, "body": "I&#39;ve tried changing the ownership of brew to the root user and had no success, beginning option 1. I maybe some time!"}, {"owner": {"reputation": 546, "user_id": 5625861, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/AU7uQ.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5625861/joe"}, "edited": false, "score": 0, "creation_date": 1449705316, "post_id": 34190963, "comment_id": 56128950, "body": "Mike, thank you for your help! That was the only directory that needed changing, its now all done!"}], "tags": [], "owner": {"reputation": 10812, "user_id": 1241782, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/576b21d9efadc9217270e971fd6d5027?s=128&d=identicon&r=PG", "display_name": "Mike S", "link": "https://stackoverflow.com/users/1241782/mike-s"}, "is_accepted": true, "score": 6, "last_activity_date": 1449703847, "last_edit_date": 1449703847, "creation_date": 1449703508, "answer_id": 34190963, "question_id": 34190642, "link": "https://stackoverflow.com/questions/34190642/unable-to-install-ruby-through-homebrew-permission-denied-error/34190963#34190963", "title": "Unable to install Ruby through Homebrew, Permission denied error", "body": "<p>Simply being the only admin user on the machine does not mean that all the commands you run with that user will be run with root privilege. There is a still a separate root user inside the machine even though you don't get a GUI login for it. That would be a security risk and it also helps prevent you from accidentally hanging yourself by running a destructive command without slapping <code>sudo</code> in front of it.</p>\n\n<p>You have two choices to resolve the issue:</p>\n\n<ol>\n<li>Adjust the permission of every directory that installer needs (in this case <code>/usr/local/etc/openssl/misc</code>). Looks like it needs write permission based on the error. But there may be many more directories once you get past that specific error.</li>\n</ol>\n\n<p>You can make it fully open like this:</p>\n\n<pre><code>chmod -R 777 /usr/local/etc/openssl/misc\n</code></pre>\n\n<p>or <code>chown</code> everything to yourself:</p>\n\n<pre><code>chown -R \"$USER\":admin /usr/local\n</code></pre>\n\n<ol start=\"2\">\n<li>Run <code>brew</code> as the root user (or with root privilege via <code>sudo</code>). This will require you to <code>chown</code> the <code>brew</code> executable to root instead of your user.</li>\n</ol>\n"}], "owner": {"reputation": 546, "user_id": 5625861, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/AU7uQ.jpg?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5625861/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2384, "favorite_count": 1, "accepted_answer_id": 34190963, "answer_count": 1, "score": 1, "last_activity_date": 1449703847, "creation_date": 1449701999, "last_edit_date": 1449702728, "question_id": 34190642, "link": "https://stackoverflow.com/questions/34190642/unable-to-install-ruby-through-homebrew-permission-denied-error", "title": "Unable to install Ruby through Homebrew, Permission denied error", "body": "<p>As someone brand new to programming, I am attempting to install Ruby using homebrew. The installation keeps getting stuck at the 'openssl' stage. This appears to be down to permissions on the directory:</p>\n\n<pre><code>/usr/local/etc/openssl/\n</code></pre>\n\n<p>Research on here and elsewhere online has pointed to attempting to install 'openssl' separately via Homebrew, which I have done and ended with the error:</p>\n\n<pre><code>==&gt; Downloading https://homebrew.bintray.com/bottles/openssl-1.0.2e.yosemite.bot\nAlready downloaded: /Library/Caches/Homebrew/openssl-1.0.2e.yosemite.bottle.tar.gz\n==&gt; Pouring openssl-1.0.2e.yosemite.bottle.tar.gz\nError: Permission denied - /usr/local/etc/openssl/certs\nWarning: Bottle installation failed: building from source.\n==&gt; Downloading https://www.openssl.org/source/openssl-1.0.2e.tar.gz\nAlready downloaded: /Library/Caches/Homebrew/openssl-1.0.2e.tar.gz\n==&gt; perl ./Configure --prefix=/usr/local/Cellar/openssl/1.0.2e --openssldir=/usr\n==&gt; make depend\n\n==&gt; make\n==&gt; make test\n==&gt; make install MANDIR=/usr/local/Cellar/openssl/1.0.2e/share/man MANSUFFIX=ssl\nLast 15 lines from /Users/Joe/Library/Logs/Homebrew/openssl/05.make:\nSSL_want_read.3ssl =&gt; SSL_want.3ssl\nSSL_want_write.3ssl =&gt; SSL_want.3ssl\nSSL_want_x509_lookup.3ssl =&gt; SSL_want.3ssl\ninstalling man3/SSL_write.3ssl\ninstalling man3/d2i_SSL_SESSION.3ssl\ni2d_SSL_SESSION.3ssl =&gt; d2i_SSL_SESSION.3ssl\ninstalling man3/ssl.3ssl\nCannot create directory /usr/local/etc/openssl/certs: Permission denied\ncreated directory `/usr/local/Cellar/openssl/1.0.2e/bin'\ncreated directory `/usr/local/Cellar/openssl/1.0.2e/lib'\ncreated directory `/usr/local/Cellar/openssl/1.0.2e/lib/engines'\ncreated directory `/usr/local/Cellar/openssl/1.0.2e/lib/pkgconfig'\ncreated directory `/usr/local/Cellar/openssl/1.0.2e/include'\ncreated directory `/usr/local/Cellar/openssl/1.0.2e/include/openssl'\nmake: *** [install_sw] Error 13\n</code></pre>\n\n<p>So I used 'chown' to change the ownership of the /openssl/ directory and managed to get a little further but am now stuck with this error:</p>\n\n<pre><code>==&gt; Downloading https://homebrew.bintray.com/bottles/openssl-1.0.2e.yosemite.bot\nAlready downloaded: /Library/Caches/Homebrew/openssl-1.0.2e.yosemite.bottle.tar.gz\n==&gt; Pouring openssl-1.0.2e.yosemite.bottle.tar.gz\nError: Permission denied - /usr/local/etc/openssl/misc/c_hash\nWarning: Bottle installation failed: building from source.\n==&gt; Downloading https://www.openssl.org/source/openssl-1.0.2e.tar.gz\nAlready downloaded: /Library/Caches/Homebrew/openssl-1.0.2e.tar.gz\n==&gt; perl ./Configure --prefix=/usr/local/Cellar/openssl/1.0.2e --openssldir=/usr\n==&gt; make depend\n==&gt; make\n==&gt; make test\n==&gt; make install MANDIR=/usr/local/Cellar/openssl/1.0.2e/share/man MANSUFFIX=ssl\nLast 15 lines from /Users/Joe/Library/Logs/Homebrew/openssl/05.make:\n            *DSO_WIN32*) sfx=\"eay32.dll\"; pfx=;; \\\n            *) sfx=\".bad\";; \\\n            esac; \\\n            cp ${pfx}gost$sfx /usr/local/Cellar/openssl/1.0.2e/lib/engines/${pfx}gost$sfx.new; \\\n        fi; \\\n        chmod 555 /usr/local/Cellar/openssl/1.0.2e/lib/engines/${pfx}gost$sfx.new; \\\n        mv -f /usr/local/Cellar/openssl/1.0.2e/lib/engines/${pfx}gost$sfx.new /usr/local/Cellar/openssl/1.0.2e/lib/engines/${pfx}gost$sfx; \\\n    fi\ninstalling gost\nmaking install in apps...\ninstalling openssl\ninstalling CA.sh\ncp: /usr/local/etc/openssl/misc/CA.sh.new: Permission denied\nmake[1]: *** [install] Error 1\nmake: *** [install_sw] Error 1\n</code></pre>\n\n<p>Again, to do with permissions on things in the openssl folder?</p>\n\n<p>Does anyone know how to change this?</p>\n\n<p>I guess the thing that has confused me MOST of all though is that I am the ONLY user on this computer and therefore the only admin as well, so I cannot get my head around why I would not have permission to access anything?</p>\n\n<p>Two other things I have tried:</p>\n\n<ul>\n<li>Using sudo before my command</li>\n<li>Full reinstall of the OS X</li>\n</ul>\n\n<p>Thanks for any help in advance.</p>\n"}, {"tags": ["ruby", "internet-explorer", "rspec", "capybara"], "answers": [{"tags": [], "owner": {"reputation": 4457, "user_id": 4856698, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YF1b0zyYypU/AAAAAAAAAAI/AAAAAAAAAB0/6hdTAeg_61s/photo.jpg?sz=128", "display_name": "NickGnd", "link": "https://stackoverflow.com/users/4856698/nickgnd"}, "is_accepted": true, "score": 1, "last_activity_date": 1449702660, "last_edit_date": 1449702660, "creation_date": 1449702341, "answer_id": 34190722, "question_id": 34190084, "link": "https://stackoverflow.com/questions/34190084/does-rspec-capybara-support-testing-against-different-drivers-such-as-ie/34190722#34190722", "title": "Does rspec capybara support testing against different drivers such as ie?", "body": "<p>Yes, you can use <strong>selenium</strong> as webdriver instead of the default <code>:rack_test</code>, and then you can decide with which browser.</p>\n\n<p>in your rspec_helper.rb</p>\n\n<pre><code>require 'capybara/rspec'\n\nCapybara.register_driver :ie do |app|\n  Capybara::Selenium::Driver.new(app, :browser =&gt; :ie)\nend\nCapybara.default_driver = :ie\n</code></pre>\n\n<p>I don't think you can use a specific broswer with other web driver like rack_test, Capybara-webkit or poltergeist.</p>\n\n<p><strong>Note</strong>: for chrome you have to download the <em>chromeDriver</em> to use it for your test. I think you have to do the same think with ie.</p>\n\n<p><strong>Update</strong>: here you can find the driver for IE <a href=\"https://code.google.com/p/selenium/wiki/InternetExplorerDriver\" rel=\"nofollow\">https://code.google.com/p/selenium/wiki/InternetExplorerDriver</a></p>\n"}, {"tags": [], "owner": {"reputation": 2080, "user_id": 1033737, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/iJ3qS.jpg?s=128&g=1", "display_name": "thefabbulus", "link": "https://stackoverflow.com/users/1033737/thefabbulus"}, "is_accepted": false, "score": 0, "last_activity_date": 1449756384, "creation_date": 1449756384, "answer_id": 34203944, "question_id": 34190084, "link": "https://stackoverflow.com/questions/34190084/does-rspec-capybara-support-testing-against-different-drivers-such-as-ie/34203944#34203944", "title": "Does rspec capybara support testing against different drivers such as ie?", "body": "<p>Yes, it does support a lot of different browsers. You can check them here: <a href=\"https://github.com/jnicklas/capybara#drivers\" rel=\"nofollow\">https://github.com/jnicklas/capybara#drivers</a></p>\n\n<p>Also, you can edit the drivers configuration to adapt to your necessities.<br> For example, if you are using <code>webkit</code> but you don't want the <code>qt</code> warning messages appear in the console, you can set your browser to <code>webkit_with_qt_plugin_messages_suppressed</code></p>\n"}], "owner": {"reputation": 84135, "user_id": 631619, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/b6f3159af5195eddff62a2dd4f9ad969?s=128&d=identicon&r=PG", "display_name": "Michael Durrant", "link": "https://stackoverflow.com/users/631619/michael-durrant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 335, "favorite_count": 0, "accepted_answer_id": 34190722, "answer_count": 2, "score": -1, "last_activity_date": 1449756384, "creation_date": 1449699552, "question_id": 34190084, "link": "https://stackoverflow.com/questions/34190084/does-rspec-capybara-support-testing-against-different-drivers-such-as-ie", "title": "Does rspec capybara support testing against different drivers such as ie?", "body": "<p>In selenium I can run firefox, chrome and internetExplorer drivers.</p>\n\n<p>Can I do that with rspec capybara ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rubygems", "state"], "comments": [{"owner": {"reputation": 1835, "user_id": 4985645, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NMblv.png?s=128&g=1", "display_name": "Vishal JAIN", "link": "https://stackoverflow.com/users/4985645/vishal-jain"}, "edited": false, "score": 0, "creation_date": 1449724630, "post_id": 34189885, "comment_id": 56134402, "body": "you have two separate callbacks for before and after transition so you know from which particular method is fired"}, {"owner": {"reputation": 1670, "user_id": 2879095, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/55e57925a99ca7e09d2e6e0d232e6734?s=128&d=identicon&r=PG", "display_name": "Arthur", "link": "https://stackoverflow.com/users/2879095/arthur"}, "reply_to_user": {"reputation": 1835, "user_id": 4985645, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NMblv.png?s=128&g=1", "display_name": "Vishal JAIN", "link": "https://stackoverflow.com/users/4985645/vishal-jain"}, "edited": false, "score": 0, "creation_date": 1449760796, "post_id": 34189885, "comment_id": 56155412, "body": "Hey, thanks for the reply.  I know that much but I may be being a complete idiot here.  Say when a setup an after and before transition to hit the same method called email in the statemachine class.  Anyway to tell within the email method if its the after or before transition."}], "owner": {"reputation": 1670, "user_id": 2879095, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/55e57925a99ca7e09d2e6e0d232e6734?s=128&d=identicon&r=PG", "display_name": "Arthur", "link": "https://stackoverflow.com/users/2879095/arthur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 338, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1449698806, "creation_date": 1449698806, "question_id": 34189885, "link": "https://stackoverflow.com/questions/34189885/ruby-state-machine-after-or-before-transition", "title": "Ruby State Machine - After or Before transition", "body": "<p>I am using the gem state_machines found here <a href=\"https://github.com/state-machines/state_machines\" rel=\"nofollow\">https://github.com/state-machines/state_machines</a></p>\n\n<p>I have it setup so you can dynamically generate state flows via the web browser and also have a few pre determined events.  For example.  You can setup a before or after transition to fire and send and email.</p>\n\n<p>Is there anyway to tell which transition is being fired i.e is it a before or after transition?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby", "heroku"], "comments": [{"owner": {"reputation": 16874, "user_id": 3743222, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/12f03e5bb18f6cc77efaa8eb7193d5dd?s=128&d=identicon&r=PG&f=1", "display_name": "user3743222", "link": "https://stackoverflow.com/users/3743222/user3743222"}, "edited": false, "score": 0, "creation_date": 1449719634, "post_id": 34189725, "comment_id": 56132909, "body": "What are those other posts describing the things you tried?"}, {"owner": {"reputation": 1, "user_id": 5661320, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153858504382022/picture?type=large", "display_name": "Thomas Beigle", "link": "https://stackoverflow.com/users/5661320/thomas-beigle"}, "reply_to_user": {"reputation": 16874, "user_id": 3743222, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/12f03e5bb18f6cc77efaa8eb7193d5dd?s=128&d=identicon&r=PG&f=1", "display_name": "user3743222", "link": "https://stackoverflow.com/users/3743222/user3743222"}, "edited": false, "score": 0, "creation_date": 1449757477, "post_id": 34189725, "comment_id": 56153041, "body": "I tried <code>bundle install --binstubs --path=vendor</code> and adding to the application.rb file <code>config.assets.initialize_on_precompile = false</code>.  I read through several posts but most did not seem wholly relevant. But then, like I said, I&#39;m new to this so I might not be doing the best job at hunting down an answer. Is there any other information I should provide?"}], "owner": {"reputation": 1, "user_id": 5661320, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153858504382022/picture?type=large", "display_name": "Thomas Beigle", "link": "https://stackoverflow.com/users/5661320/thomas-beigle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1449698062, "creation_date": 1449698062, "question_id": 34189725, "link": "https://stackoverflow.com/questions/34189725/heroku-push-rejected-failed-to-compile-ruby-app-freetds-is-missing", "title": "heroku push rejected failed to compile ruby app / freetds is missing", "body": "<p>I'm new to Heroku and I'm trying to update the stack for an app but my attempts to push keep getting rejected. In each case it's telling me that freetds is missing but I've tried following several responses on other posts as well as docs I've been able to find. freetds is installed via homebrew on my machine. I tried  Following is the output.</p>\n\n<pre><code>remote: Compressing source files... done.\nremote: Building source:\nremote: \nremote: -----&gt; Ruby app detected\nremote: -----&gt; Compiling Ruby/Rails\nremote: -----&gt; Using Ruby version: ruby-2.0.0\nremote: -----&gt; Installing dependencies using bundler 1.9.7\nremote:        Running: bundle install --without development:test --path vendor/bundle --binstubs vendor/bundle/bin -j4 --deployment\nremote:        Fetching gem metadata from https://rubygems.org/...........\nremote:        Fetching version metadata from https://rubygems.org/...\nremote:        Fetching dependency metadata from https://rubygems.org/..\nremote:        Fetching git://github.com/centresource/activerecord-sqlserver-adapter.git\nremote:        Fetching git://github.com/contextoptional/oauth-ruby.git\nremote:        Rubygems 2.0.14 is not threadsafe, so your gems must be installed one at a time. Upgrade to Rubygems 2.1.0 or higher to enable parallel gem installation.\nremote:        Installing rake 10.3.2\nremote:        Installing i18n 0.6.11\nremote:        Installing json 1.8.1\nremote:        Installing minitest 5.4.0\nremote:        Installing atomic 1.1.14\nremote:        Installing thread_safe 0.1.3\nremote:        Installing tzinfo 1.2.1\nremote:        Installing activesupport 4.1.4\nremote:        Installing builder 3.2.2\nremote:        Installing erubis 2.7.0\nremote:        Installing actionview 4.1.4\nremote:        Installing rack 1.5.2\nremote:        Installing rack-test 0.6.2\nremote:        Installing actionpack 4.1.4\nremote:        Installing mime-types 1.25.1\nremote:        Installing polyglot 0.3.5\nremote:        Installing treetop 1.4.15\nremote:        Installing mail 2.5.4\nremote:        Installing actionmailer 4.1.4\nremote:        Installing activemodel 4.1.4\nremote:        Installing arel 5.0.1.20140414130214\nremote:        Installing activerecord 4.1.4\nremote:        Using activerecord-sqlserver-adapter 4.1.0.pre from git://github.com/centresource/activerecord-sqlserver-adapter.git (at 4.1-stable)\nremote:        Installing rails-observers 0.1.2\nremote:        Installing activeresource 4.0.0\nremote:        Installing bcrypt-ruby 3.1.2\nremote:        Installing coffee-script-source 1.7.1\nremote:        Installing execjs 2.0.2\nremote:        Installing coffee-script 2.3.0\nremote:        Installing thor 0.19.1\nremote:        Installing railties 4.1.4\nremote:        Installing coffee-rails 4.0.1\nremote:        Installing daemons 1.1.9\nremote:        Installing multipart-post 1.2.0\nremote:        Installing databasedotcom 1.3.2\nremote:        Installing orm_adapter 0.4.0\nremote:        Installing warden 1.2.3\nremote:        Installing devise 3.1.1\nremote:        Installing eventmachine 1.0.8\nremote:        Installing excon 0.38.0\nremote:        Installing hike 1.2.3\nremote:        Installing jquery-rails 3.0.4\nremote:        Installing kaminari 0.14.1\nremote:        Installing mailchimp-api 2.0.5\nremote:        Installing mono_logger 1.1.0\nremote:        Installing multi_json 1.10.1\nremote:        Using oauth 0.4.7 from git://github.com/contextoptional/oauth-ruby.git (at master)\nremote:        Installing pg 0.17.0\nremote:        Installing rack-protection 1.5.3\nremote:        Using bundler 1.9.7\nremote:        Installing tilt 1.4.1\nremote:        Installing sprockets 2.11.0\nremote:        Installing sprockets-rails 2.1.3\nremote:        Installing rails 4.1.4\nremote:        Installing redis 3.1.0\nremote:        Installing redis-namespace 1.5.0\nremote:        Installing sinatra 1.4.5\nremote:        Installing vegas 0.1.11\nremote:        Installing resque 1.25.2\nremote:        Installing xml-simple 1.1.4\nremote:        Installing salesforce_bulk 1.0.3\nremote:        Installing sass 3.2.19\nremote:        Installing sass-rails 4.0.3\nremote:        Installing thin 1.6.2\nremote:        Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.\nremote:        /tmp/build_f5103be1ef5608a727364f54cfa6332a/vendor/ruby-2.0.0/bin/ruby extconf.rb\nremote:        checking for iconv_open() in iconv.h... yes\nremote:        checking for sybfront.h... no\nremote:        -----\nremote:        freetds is missing.\nremote:        -----\nremote:        *** extconf.rb failed ***\nremote:        Could not create Makefile due to some reason, probably lack of necessary\nremote:        libraries and/or headers.  Check the mkmf.log file for more details.  You may\nremote:        need configuration options.\nremote:        Provided configuration options:\nremote:        --with-opt-dir\nremote:        --without-opt-dir\nremote:        --with-opt-include\nremote:        --without-opt-include=${opt-dir}/include\nremote:        --with-opt-lib\nremote:        --without-opt-lib=${opt-dir}/lib\nremote:        --with-make-prog\nremote:        --without-make-prog\nremote:        --srcdir=.\nremote:        --curdir\nremote:        --ruby=/tmp/build_f5103be1ef5608a727364f54cfa6332a/vendor/ruby-2.0.0/bin/ruby\nremote:        --enable-lookup\nremote:        --disable-lookup\nremote:        --with-iconv-dir\nremote:        --without-iconv-dir\nremote:        --with-iconv-include\nremote:        --without-iconv-include=${iconv-dir}/include\nremote:        --with-iconv-lib\nremote:        --without-iconv-lib=${iconv-dir}/\nremote:        --with-freetds-dir\nremote:        --without-freetds-dir\nremote:        --with-freetds-include\nremote:        --without-freetds-include=${freetds-dir}/include\nremote:        --with-freetds-lib\nremote:        --without-freetds-lib=${freetds-dir}/\nremote:        Gem files will remain installed in /tmp/build_f5103be1ef5608a727364f54cfa6332a/vendor/bundle/ruby/2.0.0/gems/tiny_tds-0.6.1 for inspection.\nremote:        Results logged to /tmp/build_f5103be1ef5608a727364f54cfa6332a/vendor/bundle/ruby/2.0.0/gems/tiny_tds-0.6.1/ext/tiny_tds/gem_make.out\nremote:        An error occurred while installing tiny_tds (0.6.1), and Bundler cannot\nremote:        continue.\nremote:        Make sure that `gem install tiny_tds -v '0.6.1'` succeeds before bundling.\nremote:        Bundler Output: Fetching gem metadata from https://rubygems.org/...........\nremote:        Fetching version metadata from https://rubygems.org/...\nremote:        Fetching dependency metadata from https://rubygems.org/..\nremote:        Fetching git://github.com/centresource/activerecord-sqlserver-adapter.git\nremote:        Fetching git://github.com/contextoptional/oauth-ruby.git\nremote:        Rubygems 2.0.14 is not threadsafe, so your gems must be installed one at a time. Upgrade to Rubygems 2.1.0 or higher to enable parallel gem installation.\nremote:        Installing rake 10.3.2\nremote:        Installing i18n 0.6.11\nremote:        Installing json 1.8.1\nremote:        Installing minitest 5.4.0\nremote:        Installing atomic 1.1.14\nremote:        Installing thread_safe 0.1.3\nremote:        Installing tzinfo 1.2.1\nremote:        Installing activesupport 4.1.4\nremote:        Installing builder 3.2.2\nremote:        Installing erubis 2.7.0\nremote:        Installing actionview 4.1.4\nremote:        Installing rack 1.5.2\nremote:        Installing rack-test 0.6.2\nremote:        Installing actionpack 4.1.4\nremote:        Installing mime-types 1.25.1\nremote:        Installing polyglot 0.3.5\nremote:        Installing treetop 1.4.15\nremote:        Installing mail 2.5.4\nremote:        Installing actionmailer 4.1.4\nremote:        Installing activemodel 4.1.4\nremote:        Installing arel 5.0.1.20140414130214\nremote:        Installing activerecord 4.1.4\nremote:        Using activerecord-sqlserver-adapter 4.1.0.pre from git://github.com/centresource/activerecord-sqlserver-adapter.git (at 4.1-stable)\nremote:        Installing rails-observers 0.1.2\nremote:        Installing activeresource 4.0.0\nremote:        Installing bcrypt-ruby 3.1.2\nremote:        Installing coffee-script-source 1.7.1\nremote:        Installing execjs 2.0.2\nremote:        Installing coffee-script 2.3.0\nremote:        Installing thor 0.19.1\nremote:        Installing railties 4.1.4\nremote:        Installing coffee-rails 4.0.1\nremote:        Installing daemons 1.1.9\nremote:        Installing multipart-post 1.2.0\nremote:        Installing databasedotcom 1.3.2\nremote:        Installing orm_adapter 0.4.0\nremote:        Installing warden 1.2.3\nremote:        Installing devise 3.1.1\nremote:        Installing eventmachine 1.0.8\nremote:        Installing excon 0.38.0\nremote:        Installing hike 1.2.3\nremote:        Installing jquery-rails 3.0.4\nremote:        Installing kaminari 0.14.1\nremote:        Installing mailchimp-api 2.0.5\nremote:        Installing mono_logger 1.1.0\nremote:        Installing multi_json 1.10.1\nremote:        Using oauth 0.4.7 from git://github.com/contextoptional/oauth-ruby.git (at master)\nremote:        Installing pg 0.17.0\nremote:        Installing rack-protection 1.5.3\nremote:        Using bundler 1.9.7\nremote:        Installing tilt 1.4.1\nremote:        Installing sprockets 2.11.0\nremote:        Installing sprockets-rails 2.1.3\nremote:        Installing rails 4.1.4\nremote:        Installing redis 3.1.0\nremote:        Installing redis-namespace 1.5.0\nremote:        Installing sinatra 1.4.5\nremote:        Installing vegas 0.1.11\nremote:        Installing resque 1.25.2\nremote:        Installing xml-simple 1.1.4\nremote:        Installing salesforce_bulk 1.0.3\nremote:        Installing sass 3.2.19\nremote:        Installing sass-rails 4.0.3\nremote:        Installing thin 1.6.2\nremote:        \nremote:        Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.\nremote:        \nremote:        /tmp/build_f5103be1ef5608a727364f54cfa6332a/vendor/ruby-2.0.0/bin/ruby extconf.rb\nremote:        checking for iconv_open() in iconv.h... yes\nremote:        checking for sybfront.h... no\nremote:        -----\nremote:        freetds is missing.\nremote:        -----\nremote:        *** extconf.rb failed ***\nremote:        Could not create Makefile due to some reason, probably lack of necessary\nremote:        libraries and/or headers.  Check the mkmf.log file for more details.  You may\nremote:        need configuration options.\nremote:        \nremote:        Provided configuration options:\nremote:        --with-opt-dir\nremote:        --without-opt-dir\nremote:        --with-opt-include\nremote:        --without-opt-include=${opt-dir}/include\nremote:        --with-opt-lib\nremote:        --without-opt-lib=${opt-dir}/lib\nremote:        --with-make-prog\nremote:        --without-make-prog\nremote:        --srcdir=.\nremote:        --curdir\nremote:        --ruby=/tmp/build_f5103be1ef5608a727364f54cfa6332a/vendor/ruby-2.0.0/bin/ruby\nremote:        --enable-lookup\nremote:        --disable-lookup\nremote:        --with-iconv-dir\nremote:        --without-iconv-dir\nremote:        --with-iconv-include\nremote:        --without-iconv-include=${iconv-dir}/include\nremote:        --with-iconv-lib\nremote:        --without-iconv-lib=${iconv-dir}/\nremote:        --with-freetds-dir\nremote:        --without-freetds-dir\nremote:        --with-freetds-include\nremote:        --without-freetds-include=${freetds-dir}/include\nremote:        --with-freetds-lib\nremote:        --without-freetds-lib=${freetds-dir}/\nremote:        \nremote:        \nremote:        Gem files will remain installed in /tmp/build_f5103be1ef5608a727364f54cfa6332a/vendor/bundle/ruby/2.0.0/gems/tiny_tds-0.6.1 for inspection.\nremote:        Results logged to /tmp/build_f5103be1ef5608a727364f54cfa6332a/vendor/bundle/ruby/2.0.0/gems/tiny_tds-0.6.1/ext/tiny_tds/gem_make.out\nremote:        An error occurred while installing tiny_tds (0.6.1), and Bundler cannot\nremote:        continue.\nremote:        Make sure that `gem install tiny_tds -v '0.6.1'` succeeds before bundling.\nremote:  !\nremote:  !     Failed to install gems via Bundler.\nremote:  !\nremote: \nremote:  !     Push rejected, failed to compile Ruby app\n</code></pre>\n"}, {"tags": ["ruby", "undefined"], "comments": [{"owner": {"reputation": 1, "user_id": 5486996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb7ea4760ab9d05b813e545b9a22b4ae?s=128&d=identicon&r=PG&f=1", "display_name": "user309190", "link": "https://stackoverflow.com/users/5486996/user309190"}, "reply_to_user": {"reputation": 8771, "user_id": 2050, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2d1e9a607c47a89730352dd7b9dacaab?s=128&d=identicon&r=PG", "display_name": "Eric Platon", "link": "https://stackoverflow.com/users/2050/eric-platon"}, "edited": false, "score": 0, "creation_date": 1449698277, "post_id": 34189598, "comment_id": 56125878, "body": "Thanks Eric. So if you don&#39;t initialize a variable before referencing that variable in the loop, Ruby will always give a nil:NilClass error?"}, {"owner": {"reputation": 8771, "user_id": 2050, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2d1e9a607c47a89730352dd7b9dacaab?s=128&d=identicon&r=PG", "display_name": "Eric Platon", "link": "https://stackoverflow.com/users/2050/eric-platon"}, "edited": false, "score": 0, "creation_date": 1449698453, "post_id": 34189598, "comment_id": 56125959, "body": "Well, in this case yes. The variable is dynamically declared, but it&#39;s value is <code>nil</code> here. So calling <code>+</code> fails."}], "answers": [{"tags": [], "owner": {"reputation": 8771, "user_id": 2050, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2d1e9a607c47a89730352dd7b9dacaab?s=128&d=identicon&r=PG", "display_name": "Eric Platon", "link": "https://stackoverflow.com/users/2050/eric-platon"}, "is_accepted": true, "score": 2, "last_activity_date": 1449698299, "creation_date": 1449698299, "answer_id": 34189782, "question_id": 34189598, "link": "https://stackoverflow.com/questions/34189598/undefined-method-nilnilclass/34189782#34189782", "title": "undefined method: nil:NilClass", "body": "<p><code>start_count</code> must be initialized to <code>0</code> before the loop in this case.</p>\n\n<p>Anyway, there is more idiomatic in Ruby:</p>\n\n<pre><code>5.times do |index|\n  puts '*' * (index + 1)\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5713, "user_id": 846163, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/623857ee8390f91edba65fcac0d152ab?s=128&d=identicon&r=PG", "display_name": "sschmeck", "link": "https://stackoverflow.com/users/846163/sschmeck"}, "is_accepted": false, "score": 2, "last_activity_date": 1449698915, "creation_date": 1449698915, "answer_id": 34189912, "question_id": 34189598, "link": "https://stackoverflow.com/questions/34189598/undefined-method-nilnilclass/34189912#34189912", "title": "undefined method: nil:NilClass", "body": "<p>You can also use <code>upto</code> instead of <code>times</code> to start from another index than zero.</p>\n\n<pre><code>1.upto(5) do |index|\n  puts '*' * index\nend\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5486996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb7ea4760ab9d05b813e545b9a22b4ae?s=128&d=identicon&r=PG&f=1", "display_name": "user309190", "link": "https://stackoverflow.com/users/5486996/user309190"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 34189782, "answer_count": 2, "score": 0, "last_activity_date": 1449705293, "creation_date": 1449697525, "last_edit_date": 1449705293, "question_id": 34189598, "link": "https://stackoverflow.com/questions/34189598/undefined-method-nilnilclass", "title": "undefined method: nil:NilClass", "body": "<p>Can someone help explain why the following code produces a: </p>\n\n<pre><code>5.times do \n  star_count = star_count + 1\n  puts \"*\" * star_count\nend\n\n#=&gt; NoMethodError: undefined method `+' for nil:NilClass\n</code></pre>\n\n<p>The desired effect of the code is the following image below:</p>\n\n<pre><code>*\n**\n***\n****\n*****\n</code></pre>\n\n<p>Sorry for including the asterisk triangle as code ... was not outputting right so that was the only solution I could think of. Treating the triangle as an image did not work either. </p>\n"}, {"tags": ["ruby", "xml", "xslt", "amazon-web-services", "nokogiri"], "answers": [{"tags": [], "owner": {"reputation": 125, "user_id": 5153044, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/090414ef0184ca02c7a9a4fe986a0f86?s=128&d=identicon&r=PG&f=1", "display_name": "charint", "link": "https://stackoverflow.com/users/5153044/charint"}, "is_accepted": false, "score": 1, "last_activity_date": 1454540112, "creation_date": 1454540112, "answer_id": 35189359, "question_id": 34189400, "link": "https://stackoverflow.com/questions/34189400/systemstackerror-caught-locally-but-causes-production-server-to-stop/35189359#35189359", "title": "SystemStackError caught locally but causes production server to stop", "body": "<p>I found the cause for the issue and thought I'd share what I learned:</p>\n\n<ul>\n<li>even when I was rescuing the <strong>SystemStackError</strong>, the garbage collector wasn't cleaning up the memory and the memory leak eventually led to the production instance stopping to work</li>\n<li>the same memory leak was happening locally as well but because my local machine had a lot more memory than our production instance, it took much much longer to crash (so it <em>appeared</em> to be working properly locally in the beginning)</li>\n<li>the \"fix\" was to use both Nokogiri and <a href=\"https://github.com/glejeune/ruby-xslt\" rel=\"nofollow\">Ruby-xslt</a> gems - Nokogiri handles the majority of the xsl transformations beautifully but when it does fail the Ruby-xslt gem seems to handle the weird cases alright. So in my code I ended up trying to transform with Nokogiri first, and if it fails, when transform with xslt. </li>\n</ul>\n\n<p>Hope this helps. :)</p>\n"}], "owner": {"reputation": 125, "user_id": 5153044, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/090414ef0184ca02c7a9a4fe986a0f86?s=128&d=identicon&r=PG&f=1", "display_name": "charint", "link": "https://stackoverflow.com/users/5153044/charint"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1454540112, "creation_date": 1449696781, "question_id": 34189400, "link": "https://stackoverflow.com/questions/34189400/systemstackerror-caught-locally-but-causes-production-server-to-stop", "title": "SystemStackError caught locally but causes production server to stop", "body": "<p>I am working on a Ruby project where I need to transform a raw xml document using an xsl stylesheet from my user. </p>\n\n<p>Recently I realized that some of the stylesheets from my user have infinite loops, causing my app to crash so I added some error handling to prevent such event from happening. </p>\n\n<pre><code> rescue SystemStackError, NoMemoryError  =&gt; e\n   puts \"error caught #{e.inspect}\"\n</code></pre>\n\n<p>I was able to successfully rescue this error when I was running the app locally but when I deployed it to my aws instance, <strong>using the same stylesheet</strong>, this error was only caught for small files (for example, a ~200KB xml). </p>\n\n<p>With larger xmls (say 4MB) the app seems to be stuck (it will never finish the current task nor move on to the next). </p>\n\n<p>I thought I did not have enough memory on my aws instance but even after changing it from t2.micro to t2.large (which has the same amount of memory as my local machine) my app would still get stuck for no reason. </p>\n\n<p>I have compared all the gems in both my local machine and my aws instance and they all have the same versions. I am using Nokorigi (1.6.7). </p>\n\n<p>Can someone please give me some suggestions as to where I should look? Any help will be greatly appreciated!</p>\n\n<p>PS: I should mention that, out of desperation, I even added statements like this</p>\n\n<pre><code>rescue Exception =&gt; e\n  #log exception here\n</code></pre>\n\n<p>at the end of all my other error handling code, hoping to catch a glimpse of the problem... but alas the ghost remains anonymous and deadly. :(</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1449696490, "post_id": 34189260, "comment_id": 56124936, "body": "I&#39;m pretty sure you want <code>belongs_to :product</code> not <code>product_id</code>"}, {"owner": {"reputation": 523, "user_id": 5153177, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/DEorO.png?s=128&g=1", "display_name": "jgrant", "link": "https://stackoverflow.com/users/5153177/jgrant"}, "reply_to_user": {"reputation": 14469, "user_id": 2191105, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/tPiCW.png?s=128&g=1", "display_name": "David Hoelzer", "link": "https://stackoverflow.com/users/2191105/david-hoelzer"}, "edited": false, "score": 0, "creation_date": 1449696992, "post_id": 34189260, "comment_id": 56125215, "body": "What&#39;s up with the down vote?"}], "answers": [{"comments": [{"owner": {"reputation": 523, "user_id": 5153177, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/DEorO.png?s=128&g=1", "display_name": "jgrant", "link": "https://stackoverflow.com/users/5153177/jgrant"}, "edited": false, "score": 0, "creation_date": 1449697826, "post_id": 34189318, "comment_id": 56125654, "body": "So you&#39;re saying my error is coming from the initialize method in my user.rb file?"}, {"owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "reply_to_user": {"reputation": 523, "user_id": 5153177, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/DEorO.png?s=128&g=1", "display_name": "jgrant", "link": "https://stackoverflow.com/users/5153177/jgrant"}, "edited": false, "score": 0, "creation_date": 1449697863, "post_id": 34189318, "comment_id": 56125678, "body": "Yes. <b>You never set <code>current_user.shopping_cart</code></b>. You assign a new shopping cart to a temporary local variable, which is then immediately discarded."}, {"owner": {"reputation": 523, "user_id": 5153177, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/DEorO.png?s=128&g=1", "display_name": "jgrant", "link": "https://stackoverflow.com/users/5153177/jgrant"}, "edited": false, "score": 0, "creation_date": 1450120135, "post_id": 34189318, "comment_id": 56291194, "body": "Thanks for your help.  My apologies for the lack of evidence.  Your advice solved the problem."}], "tags": [], "owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "is_accepted": true, "score": 0, "last_activity_date": 1449697764, "last_edit_date": 1449697764, "creation_date": 1449696415, "answer_id": 34189318, "question_id": 34189260, "link": "https://stackoverflow.com/questions/34189260/rails-undefined-method-product-ids-for-nilnilclass/34189318#34189318", "title": "Rails undefined method `product_ids&#39; for nil:NilClass", "body": "<p><code>current_user.shopping_cart</code> is nil, but you invoked a method on it anyways. There is no evidence that you've tried to assign a value to it in the code you've posted, and Rails will not automatically assign a value to the variable for you.</p>\n\n<hr>\n\n<p>RE your edits:</p>\n\n<pre><code>after_initialize do \n if shopping_cart.nil? \n  shopping_cart = ShoppingCart.create\n end\nend\n</code></pre>\n\n<p>That isn't how you assign to member variables in Ruby. You're assigning to a local variable called <code>shopping_cart</code> which has absolutely nothing to do with <code>self.shopping_cart</code>. If you want to assign to <code>self.shopping_cart</code>, you cannot omit <code>self.</code></p>\n\n<p>You need to use <code>self.shopping_cart = ShoppingCart.create</code>.</p>\n"}], "owner": {"reputation": 523, "user_id": 5153177, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/DEorO.png?s=128&g=1", "display_name": "jgrant", "link": "https://stackoverflow.com/users/5153177/jgrant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 0, "accepted_answer_id": 34189318, "answer_count": 1, "score": -1, "last_activity_date": 1449697764, "creation_date": 1449696187, "last_edit_date": 1449697339, "question_id": 34189260, "link": "https://stackoverflow.com/questions/34189260/rails-undefined-method-product-ids-for-nilnilclass", "title": "Rails undefined method `product_ids&#39; for nil:NilClass", "body": "<p>Beginner error here... trying to create a shopping cart for users.  I get this error, \"undefined method `product_ids' for nil:NilClass\", when I add a product to cart. </p>\n\n<p><strong>ShoppingCart Model:</strong> </p>\n\n<pre><code>    class ShoppingCart &lt; ActiveRecord::Base\n      belongs_to :user\n      belongs_to :order\n      belongs_to :product_id\n    end\n</code></pre>\n\n<p><strong>Product Model:</strong> </p>\n\n<pre><code>    class Product &lt; ActiveRecord::Base\n      has_many :books\n      belongs_to :user\n      has_many :orders\n      has_many :shopping_carts\n    end\n</code></pre>\n\n<p><strong>ProductSelectionsController</strong></p>\n\n<pre><code>    class ProductSelectionsController &lt; ApplicationController\n      def create\n        current_user.shopping_cart.product_ids &lt;&lt; params[:product_id]\n        current_user.shopping_cart.save\n        redirect_to :back\n      end\n    end\n</code></pre>\n\n<p><strong>ShoppingCart Migration:</strong> </p>\n\n<pre><code>    class CreateShoppingCarts &lt; ActiveRecord::Migration\n      def change\n        create_table :shopping_carts do |t|\n          t.references :user, index: true, foreign_key: true\n          t.references :order, index: true, foreign_key: true\n          t.string :orderstatus\n          t.integer :quantity\n          t.text :product_ids, array: true, default: []\n\n          t.timestamps null: false\n        end\n      end\n    end\n</code></pre>\n\n<p><strong>Add to Cart link Product.show:</strong> </p>\n\n<pre><code>&lt;%= link_to \"Add to cart\", product_selections_path(product_ids: @product.id), method: :post %&gt;\n</code></pre>\n\n<p><strong>Initialize cart in User.rb</strong></p>\n\n<pre><code>after_initialize do \n if shopping_cart.nil? \n  shopping_cart = ShoppingCart.create\n end\nend\n</code></pre>\n\n<p>I know it's right under my nose, what am I missing? </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "heroku", "paypal"], "comments": [{"owner": {"reputation": 16822, "user_id": 560073, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh6.googleusercontent.com/-A_vJq0ilPI8/AAAAAAAAAAI/AAAAAAAAAJI/dKesA-ExUzA/photo.jpg?sz=128", "display_name": "Linus Oleander", "link": "https://stackoverflow.com/users/560073/linus-oleander"}, "edited": false, "score": 0, "creation_date": 1449696347, "post_id": 34189095, "comment_id": 56124860, "body": "Paypal is really difficult to work with, API wise. My company eventually switched to <a href=\"https://stripe.com/\" rel=\"nofollow noreferrer\">Stripe</a> which only took an hour to implement."}, {"owner": {"reputation": 1258, "user_id": 1852651, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/rfKGa.jpg?s=128&g=1", "display_name": "Graham S.", "link": "https://stackoverflow.com/users/1852651/graham-s"}, "edited": false, "score": 0, "creation_date": 1449697040, "post_id": 34189095, "comment_id": 56125245, "body": "Haven&#39;t used the Paypal API before, but have you switched out the URLs? Sometimes APIs have a url for development and different one for production. Same for API keys. Also, check your <code>config&#47;development.rb</code> and make sure any necessary Paypal API configurations are also in <code>config&#47;production.rb</code> as well."}, {"owner": {"reputation": 1322, "user_id": 1005978, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8e5bea69284b027f4d9c9c95baaaf781?s=128&d=identicon&r=PG", "display_name": "maor10", "link": "https://stackoverflow.com/users/1005978/maor10"}, "edited": false, "score": 0, "creation_date": 1449697909, "post_id": 34189095, "comment_id": 56125713, "body": "Nope... not the issue, checked both"}, {"owner": {"reputation": 12135, "user_id": 538471, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/d2051553a8bdd27c26fec84b47806714?s=128&d=identicon&r=PG", "display_name": "dan-klasson", "link": "https://stackoverflow.com/users/538471/dan-klasson"}, "edited": false, "score": 0, "creation_date": 1449712928, "post_id": 34189095, "comment_id": 56131255, "body": "Did you set all your environment variables in Heroku?"}, {"owner": {"reputation": 398, "user_id": 3139201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SYXuC.gif?s=128&g=1", "display_name": "paypal_louis", "link": "https://stackoverflow.com/users/3139201/paypal-louis"}, "edited": false, "score": 0, "creation_date": 1449716947, "post_id": 34189095, "comment_id": 56132259, "body": "when you switch to Live, did you change your credentials to Live one as well? The error seems to be coming from token&#39;s endpoint."}, {"owner": {"reputation": 1322, "user_id": 1005978, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8e5bea69284b027f4d9c9c95baaaf781?s=128&d=identicon&r=PG", "display_name": "maor10", "link": "https://stackoverflow.com/users/1005978/maor10"}, "edited": false, "score": 0, "creation_date": 1449719443, "post_id": 34189095, "comment_id": 56132854, "body": "Yes, I did. It&#39;s live"}], "owner": {"reputation": 1322, "user_id": 1005978, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8e5bea69284b027f4d9c9c95baaaf781?s=128&d=identicon&r=PG", "display_name": "maor10", "link": "https://stackoverflow.com/users/1005978/maor10"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 355, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1493196239, "creation_date": 1449695615, "last_edit_date": 1449695978, "question_id": 34189095, "link": "https://stackoverflow.com/questions/34189095/paypal-rest-api-giving-401-error-when-moving-to-production", "title": "Paypal REST API giving 401 error when moving to production", "body": "<p>We're trying to use Paypal's REST API in Ruby on Rails, it worked perfectly in sandbox.\nWhen we moved to production, it all of a sudden doesn't work. Here's the logs from heroku:</p>\n\n<pre><code>Started POST \"/transfer/payments/start_payment\" for 77.127.249.103 at 2015-12-09 21:05:37 +0000\n2015-12-09T21:05:37.709999+00:00 app[web.1]: Request[post]: https://api.paypal.com/v1/oauth2/token\n2015-12-09T21:05:38.383206+00:00 app[web.1]: Response[401]: Unauthorized, Duration: 0.673s\n2015-12-09T21:05:38.396230+00:00 app[web.1]: \n2015-12-09T21:05:38.396233+00:00 app[web.1]: PayPal::SDK::Core::Exceptions::UnauthorizedAccess (Failed.  Response code = 401.  Response message = Unauthorized.  Response debug ID = 9287826b548af.):\n2015-12-09T21:05:38.396234+00:00 app[web.1]:   app/controllers/transfer/payments_controller.rb:23:in `start_payment'\n2015-12-09T21:05:38.396234+00:00 app[web.1]: \n2015-12-09T21:05:38.396235+00:00 app[web.1]: \n2015-12-09T21:05:38.394396+00:00 app[web.1]: Completed 500 Internal Server Error in 1020ms (ActiveRecord: 23.9ms)\n2015-12-09T21:05:38.394396+00:00 app[web.1]: Completed 500 Internal Server Error in 1020ms (ActiveRecord: 23.9ms)\n</code></pre>\n\n<p>Our code is:</p>\n\n<pre><code>def start_payment\n            @payment = Payment.new(payment_params)\n            @paypal_payment = PayPal::SDK::REST::Payment.new({\n                :intent =&gt; \"sale\",\n                :payer =&gt; {\n                :payment_method =&gt; \"paypal\" },\n                :redirect_urls =&gt; {\n                :return_url =&gt; root_url + transfer_payments_path,\n                :cancel_url =&gt; \"https://devtools-paypal.com/guide/pay_paypal/ruby?cancel=true\" },\n                :transactions =&gt; [ {\n                    :amount =&gt; {\n                    :total =&gt; sprintf('%.2f', @payment.amount),\n                    :currency =&gt; \"USD\" \n                    },\n                    :description =&gt; \"Bounty Balance\" \n                    } ]              \n                })\n            @paypal_payment.create\n\n            index = @paypal_payment.links.find_index {|item| item.rel == \"approval_url\"}\n            link = @paypal_payment.links[index]\n            redirect_to link.href\n        end \n</code></pre>\n\n<p>We checked on paypal.com, and we have green checkmarks next to the relevant services in paypal- the only things we don't have are direct credit cards, future payments, and payouts.</p>\n\n<p>Anyone have any idea what the issue might be?</p>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1449695594, "post_id": 34188279, "comment_id": 56124439, "body": "Why does this have to use a regex? Break down the URL using the URI module, and look at its individual parts. It&#39;ll be more easily maintained. See <a href=\"http://blog.codinghorror.com/regular-expressions-now-you-have-two-problems/\" rel=\"nofollow noreferrer\">blog.codinghorror.com/&hellip;</a>"}, {"owner": {"reputation": 17608, "user_id": 661624, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/347231f8387561ef324e25b48b96ba16?s=128&d=identicon&r=PG&f=1", "display_name": "Henley Chiu", "link": "https://stackoverflow.com/users/661624/henley-chiu"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1449783454, "post_id": 34188279, "comment_id": 56168714, "body": "It doesn&#39;t have to be a regex, but it sure will make it easier to maintain, and less code to write. I simply have to add this regex to my already long list of regex&#39;s. With your method, I&#39;d have to write another function, and 100+ more functions if I encounter 100 more cases"}], "answers": [{"tags": [], "owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "is_accepted": true, "score": 3, "last_activity_date": 1449694446, "last_edit_date": 1449694446, "creation_date": 1449693347, "answer_id": 34188479, "question_id": 34188279, "link": "https://stackoverflow.com/questions/34188279/how-to-get-regex-of-url-that-does-not-have-a-word-as-a-token/34188479#34188479", "title": "How to get regex of URL that does not have a word as a token?", "body": "<pre><code>%r{^https?://[^/]*(?&lt;!blog\\.)example\\.com/(?!news/|archives/|blog/)(?!.*/blog(/|$)).*}\n</code></pre>\n\n<p><a href=\"http://rubular.com/r/X8OCNlkAE9\" rel=\"nofollow\">See it in action</a></p>\n\n<p><hr>\nThere were quite some problems with your original regex. Mainly, <code>$</code> doesn't mean what I think you means and you were not excluding <code>blog/</code>.</p>\n\n<p>So here is a breakdown:</p>\n\n<ul>\n<li>There is an alternative syntax for creating regexes <code>%r{}</code>, use it if you are going to escape <em>forward slashes</em> a lot</li>\n<li><code>^</code> -from the start</li>\n<li><code>https?//</code> - <em>http//</em> or <em>https//</em></li>\n<li><code>[^/]*</code> - multiple characters, which are not <em>forward slash</em>es</li>\n<li><code>(?&lt;!blog\\.)</code> - negative lookbehind to ensure the subdomain was not <em>blog.example.com</em></li>\n<li><code>example\\.com</code> - the <em>example.com</em> domain itself</li>\n<li><code>/(?!news/|archives/|blog/)</code> - after first slash, the <em>\"url token\"</em> is not <em>news</em> or <em>archives</em> or <em>blog</em></li>\n<li><code>(?!.*/blog(/|$))</code> - any of the further <em>\"url tokens\"</em> are not <em>blog</em></li>\n<li><code>.*</code> - match the remaining characters</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 17608, "user_id": 661624, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/347231f8387561ef324e25b48b96ba16?s=128&d=identicon&r=PG&f=1", "display_name": "Henley Chiu", "link": "https://stackoverflow.com/users/661624/henley-chiu"}, "edited": false, "score": 0, "creation_date": 1449783355, "post_id": 34189405, "comment_id": 56168648, "body": "Thanks but actually this would make less easy to maintain, not easier. This is because I already have a list of regular expressions to check against, and if I make this a regular expression, I don&#39;t need to write more code to handle 1 more case. So everything is more elegant."}], "tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": false, "score": 1, "last_activity_date": 1449696794, "creation_date": 1449696794, "answer_id": 34189405, "question_id": 34188279, "link": "https://stackoverflow.com/questions/34188279/how-to-get-regex-of-url-that-does-not-have-a-word-as-a-token/34189405#34189405", "title": "How to get regex of URL that does not have a word as a token?", "body": "<p>Rather than use a complex regex, which will usually grow even more complex and difficult to manage over time, I'd recommend writing a simple method that breaks the test down into smaller parts, and returns a true/false whether the URL is valid/usable.</p>\n\n<pre><code>require 'uri'\n\ndef match_uri(url)\n  uri = URI.parse(url)\n\n  if uri.host != 'example.com' ||\n    uri.path[%r!^/(?:news|archives|blog)/!i] ||\n    uri.path[%r!/blog/!i]\n    return false\n  end\n\n  true\nend\n\n\n# 'http://example.com/test' should match\nmatch_uri('http://example.com/test') # =&gt; true\n\n# 'http://blog.example.com/test' should not match\nmatch_uri('http://blog.example.com/test') # =&gt; false\n\n# 'http://example.com/test/blog/test' should not match\nmatch_uri('http://example.com/test/blog/test') # =&gt; false\n\n# 'http://example.com/test/test2' should match\nmatch_uri('http://example.com/test/test2') # =&gt; true\n</code></pre>\n\n<p>Here's what URI is returning:</p>\n\n<pre><code>uri = URI.parse('http://example.com/path/to/file')\nuri.host # =&gt; \"example.com\"\nuri.path # =&gt; \"/path/to/file\"\n</code></pre>\n\n<p>The only problem I see with the logic you're using, is a \"path/to/file\" could actually be \"path/to/blog.ext\" which would cause the logic to break. If that's possible, using:</p>\n\n<pre><code>File.dirname(uri.path) # =&gt; \"/path/to\"\n</code></pre>\n\n<p>will strip the filename off so the test only looks at the true path, not the path and file:</p>\n\n<pre><code>def match_uri(url)\n  uri = URI.parse(url)\n\n  uri_dir = File.dirname(uri.path)\n\n  if uri.host != 'example.com' ||\n    uri_dir[%r!^/(?:news|archives|blog)!i] ||\n    uri_dir[%r!/blog!i]\n    return false\n  end\n\n  true\nend\n</code></pre>\n\n<p>\"<a href=\"http://blog.codinghorror.com/regular-expressions-now-you-have-two-problems/\" rel=\"nofollow\">Regular Expressions: Now You Have Two Problems</a>\" is a good read.</p>\n"}], "owner": {"reputation": 17608, "user_id": 661624, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/347231f8387561ef324e25b48b96ba16?s=128&d=identicon&r=PG&f=1", "display_name": "Henley Chiu", "link": "https://stackoverflow.com/users/661624/henley-chiu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 34188479, "answer_count": 2, "score": 0, "last_activity_date": 1449696794, "creation_date": 1449692595, "last_edit_date": 1449695497, "question_id": 34188279, "link": "https://stackoverflow.com/questions/34188279/how-to-get-regex-of-url-that-does-not-have-a-word-as-a-token", "title": "How to get regex of URL that does not have a word as a token?", "body": "<p>How do I match an URL that matches all of these conditions:</p>\n\n<ul>\n<li>the domain is <em>example.com</em>, but subdomain is not <em>blog.example.com</em></li>\n<li>the first URL token is not <em>\"news\"</em> or <em>\"archives\"</em> or <em>\"blog\"</em>  (ie <code>example.com/FIRST_URL_TOKEN</code>)</li>\n<li>none of the subsequent URL tokens is <em>\"blog\"</em> (ie <code>example.com/FIRST_URL_TOKEN/SUBSEQUENT_URL_TOKEN/SUBSEQUENT_URL_TOKEN</code>) </li>\n</ul>\n\n<p>So:</p>\n\n<p><code>http://example.com/test</code> should match</p>\n\n<p><code>http://blog.example.com/test</code> should not match</p>\n\n<p><code>http://example.com/test/blog/test</code> should not match</p>\n\n<p><code>http://example.com/test/test2</code> should match</p>\n\n<p>Here is what I have so far:</p>\n\n<pre><code>regex = /^http(s)?:\\/\\/(?!blog\\.$)example.com(\\.\\w+)?\\/(?!news$|archive$|blog$).*/\n</code></pre>\n\n<p>However, I'm missing something as <code>http://example.com/test/blog/test</code> should not match.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "factory-bot", "factory"], "answers": [{"comments": [{"owner": {"reputation": 6654, "user_id": 654457, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8806c26cc5687109c0669221ab54ecb7?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Nelson", "link": "https://stackoverflow.com/users/654457/ben-nelson"}, "edited": false, "score": 0, "creation_date": 1449707374, "post_id": 34188451, "comment_id": 56129641, "body": "right, sorry i guess i needed to clarify a bit. i edited the question but the main problem i keep seeing is that i need the particular model for whatever association for multiple different factories and that dependency is causing issues for me. lemme know if that makes sense, appreciate the answer!"}], "tags": [], "owner": {"reputation": 20590, "user_id": 504963, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xlYLo.jpg?s=128&g=1", "display_name": "Antarr Byrd", "link": "https://stackoverflow.com/users/504963/antarr-byrd"}, "is_accepted": false, "score": 0, "last_activity_date": 1449693678, "last_edit_date": 1449693678, "creation_date": 1449693211, "answer_id": 34188451, "question_id": 34188228, "link": "https://stackoverflow.com/questions/34188228/use-existing-models-with-factorygirl-associations/34188451#34188451", "title": "Use existing models with FactoryGirl associations", "body": "<p>FactoryGirl includes <a href=\"https://github.com/thoughtbot/factory_girl/blob/master/GETTING_STARTED.md#rails-preloaders-and-rspec\" rel=\"nofollow\">associations</a> you can very easily use existing factories. The example below assumes you have orders that belong_to a customer.</p>\n\n<pre><code>FactoryGirl.define do \n  factory :order do\n    association :customer, factory: :customer\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 6654, "user_id": 654457, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/8806c26cc5687109c0669221ab54ecb7?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Nelson", "link": "https://stackoverflow.com/users/654457/ben-nelson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449693678, "creation_date": 1449692372, "last_edit_date": 1449693282, "question_id": 34188228, "link": "https://stackoverflow.com/questions/34188228/use-existing-models-with-factorygirl-associations", "title": "Use existing models with FactoryGirl associations", "body": "<p>I have some models setup with FactoryGirl and I want to do associations between them. The association keyword on the particular models is super helpful! However, I don't want to create new models which I think is what the association keyword does. I want to associate with already created instances of my particular model, or have the option to do so easily. I know there is a code smell in here somewhere with all this setup, but an example is below.</p>\n\n<pre><code>obj1 = create(:thing_one)\nobj2 = create(:thing_two, :with_thing_one)\n</code></pre>\n\n<p>would be the setup I'm doing right now (but with a few more models and associations than just two) and it doesn't have the obj2 and obj1 objects associate properly in the database. If I do something like</p>\n\n<pre><code>obj1 = create(:thing_one)\nobj2 = create(:thing_two, thing_one: obj1)\n</code></pre>\n\n<p>It would associate everything correctly.</p>\n\n<p>The problem is that this makes it seem like it would be more work than it's really worth to use the Factories if I just have to setup everything myself. Why wouldn't I just use ActiveRecord and manually setup those objects?</p>\n\n<p>EDIT: </p>\n\n<p>Another situation that could come up is the following:</p>\n\n<pre><code>obj1 = create(:object)\nobj2 = create(:object_two, needed_object: obj1)\n# obj3 is dependent on obj2 being created which is dependent on obj1\nobj3 = create(:object_three, needed_object_two: obj2)\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "api", "oauth-2.0", "linkedin"], "owner": {"reputation": 4027, "user_id": 4139179, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/IXenf.jpg?s=128&g=1", "display_name": "Daniel Bonnell", "link": "https://stackoverflow.com/users/4139179/daniel-bonnell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 160, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1449691318, "creation_date": 1449691318, "question_id": 34187946, "link": "https://stackoverflow.com/questions/34187946/linkedin-api-ruby-oauth2-integration", "title": "LinkedIn API Ruby/OAuth2 integration", "body": "<p>I'm trying to write an integration with the LinkedIn API for my Rails app using <code>OAuth2</code> but I'm having a hard time figuring out how to make authenticated API calls. I can't seem to find any resources on the topic that don't rely on the linkedin gem. I already have that gem installed in my app, but need to make some API calls that are not possible using that gem.</p>\n\n<p>What I want to do is set up a controller with some endpoints that my Angular client can ping. When the client pings the controller, it should in turn ping the LinkedIn API. Once it gets a response it will perform some operations to store the information in the database and then pass it along to the Angular client.</p>\n\n<p>I found a single <a href=\"https://developer-programs.linkedin.com/documents/code-samples#toggleview:id=ruby\" rel=\"nofollow\">code sample</a> in Ruby from LinkedIn, which I'm attempting to modify into a controller for my app. Here is my controller:</p>\n\n<pre><code>class Employers::LinkedinApiController &lt; ApplicationController\n    require 'net/http'\n    layout 'employers/layouts/application'\n    before_action :authorize_viewer\n    skip_after_filter :intercom_rails_auto_include\n\n    REDIRECT_URI = 'http://app.mysite.local:3000/linkedin/callback'\n    STATE = SecureRandom.hex(15)\n    CLIENT = parameterize(client.auth_code.get_token(STATE, redirect_uri: REDIRECT_URI))\n\n    def get_update(update_key=nil)\n        company = current_employer.company\n        update_key = company.social_media_posts.where(\"linkedin IS true AND linkedin_id IS NOT NULL\").last.linkedin_id\n        page_id = company.linkedin.page_id\n        end_point = \"https://api.linkedin.com/v1/companies/#{page_id}/updates/key=#{update_key}?format=json\"\n\n        access_token = OAuth2::AccessToken.new(client, CLIENT['token'], {\n            :mode =&gt; :header,\n            :header_format =&gt; 'Bearer %s'\n        })\n\n        response = access_token.get(end_point)\n\n        # Do something with the response to save it to the database\n\n        # Pass response on to Angular client\n        respond_to do\n            format.json { render json: response }\n        end\n    end\n\n    private\n\n    #Instantiate your OAuth2 client object\n    def client\n        OAuth2::Client.new(\n            ENV['LINKEDIN_APP_ID'], \n            ENV['LINKEDIN_APP_SECRET'], \n            authorize_url: \"/uas/oauth2/authorization?response_type=code\",\n            token_url: \"/uas/oauth2/accessToken\",\n            site: \"https://www.linkedin.com\"\n        )\n    end\n\n    def parameterize(string)\n        parameters = {}\n        string.split('?')[-1].split('&amp;').each do |param|\n            parameters[param.split('=')[0]] = param.split('=')[-1]\n        end\n        parameters\n    end\n\n    def authorize_viewer\n        if !employer_signed_in?\n            redirect_to new_employer_session_path\n        end\n    end\nend\n</code></pre>\n\n<p>In the code sample from LinkedIn, the only way to get data from the <code>accept</code> method is to ping the <code>authorize</code> method, whose callback points to the <code>accept</code> method. What I can't figure out is how I can ping the <code>get_update</code> method in my controller and make an authenticated API call, without having to set up an <code>authorize</code> method that calls back to <code>get_update</code>. </p>\n\n<p>How can I do this?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 5713, "user_id": 846163, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/623857ee8390f91edba65fcac0d152ab?s=128&d=identicon&r=PG", "display_name": "sschmeck", "link": "https://stackoverflow.com/users/846163/sschmeck"}, "edited": false, "score": 1, "creation_date": 1449691362, "post_id": 34187895, "comment_id": 56122141, "body": "What should be the result of your search? Where do you want to search, only for the <code>:element</code> key or the entire hash, array. Please update your questions."}], "answers": [{"comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1449691679, "post_id": 34187954, "comment_id": 56122307, "body": "Your code will also return <code>true</code> for <code>com bar.com</code>."}, {"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1449691771, "post_id": 34187954, "comment_id": 56122370, "body": "@Jordan, didn&#39;t follow. Can you write the specific example you are trying to express?"}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 2, "creation_date": 1449691829, "post_id": 34187954, "comment_id": 56122406, "body": "Here&#39;s a better example: <code>&#39;foo.com domain.com bar.com&#39;.include?(&#39;main.com&#39;)</code> will also return <code>true</code>, which is almost certainly not what OP wants."}], "tags": [], "owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "is_accepted": true, "score": 2, "last_activity_date": 1449691957, "last_edit_date": 1449691957, "creation_date": 1449691351, "answer_id": 34187954, "question_id": 34187895, "link": "https://stackoverflow.com/questions/34187895/how-to-search-for-a-string-match-within-a-set-of-key-values/34187954#34187954", "title": "how to search for a string match within a set of key values", "body": "<pre><code>'foo.com domain.com bar.com'.split.include?('domain.com') # =&gt; true\n</code></pre>\n\n<p>Now if I understand you correctly, you want to find all hashes which have a value, which contains that domain:</p>\n\n<pre><code>test.select { |hash| hash.values.any? { |value| value.split.include?('domain.com') } }\n</code></pre>\n"}], "owner": {"reputation": 1094, "user_id": 2386620, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/65ad9f1a1aafff45f439ab9d622e00ac?s=128&d=identicon&r=PG", "display_name": "adbarads", "link": "https://stackoverflow.com/users/2386620/adbarads"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 34187954, "answer_count": 1, "score": -1, "last_activity_date": 1449691957, "creation_date": 1449691096, "last_edit_date": 1449691594, "question_id": 34187895, "link": "https://stackoverflow.com/questions/34187895/how-to-search-for-a-string-match-within-a-set-of-key-values", "title": "how to search for a string match within a set of key values", "body": "<p>I need a simple way to search through a string to match another string.</p>\n\n<pre><code>example:\ndomain.com\n</code></pre>\n\n<p>data that looks like this:</p>\n\n<pre><code>test[0][:element] = \"foo.com domain.com bar.com\"\n</code></pre>\n\n<p>The domains are separated by a space.\n<code>test[]</code> is an array of hashes.</p>\n\n<p>I was thinking something along these lines of:</p>\n\n<pre><code>test[0][:element].select #?\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "factory-bot"], "comments": [{"owner": {"reputation": 20590, "user_id": 504963, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xlYLo.jpg?s=128&g=1", "display_name": "Antarr Byrd", "link": "https://stackoverflow.com/users/504963/antarr-byrd"}, "edited": false, "score": 0, "creation_date": 1449690699, "post_id": 34187583, "comment_id": 56121741, "body": "What does your spec file look like"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 1, "creation_date": 1449691171, "post_id": 34187583, "comment_id": 56122022, "body": "For older versions of FactoryGirl I think you use traits differently, e.g., <a href=\"https://github.com/thoughtbot/factory_girl/blob/v2.2.0/GETTING_STARTED.md\" rel=\"nofollow noreferrer\">github.com/thoughtbot/factory_girl/blob/v2.2.0/&hellip;</a>"}, {"owner": {"reputation": 75558, "user_id": 544825, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/UFdOO.png?s=128&g=1", "display_name": "max", "link": "https://stackoverflow.com/users/544825/max"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1449691541, "post_id": 34187583, "comment_id": 56122235, "body": "I would try to update your app as soon as possible, Ruby 1.9.3 is no longer supported and is insecure. Your issues also seem to be that you are using an outdated version of FactoryGirl with newer docs as @DaveNewton pointed out."}, {"owner": {"reputation": 838, "user_id": 4107375, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/92eb78c7c4b20429f9d22a1d5e38be57?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/4107375/jay"}, "reply_to_user": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1449691620, "post_id": 34187583, "comment_id": 56122272, "body": "@DaveNewton I looked through the docs, it seems that the trait is setup correctly.  They don&#39;t give any example on using a trait when building a factory though."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1449692257, "post_id": 34187583, "comment_id": 56122652, "body": "<i>Which</i> docs? For which version of FG? AFAIK both the error message and the 2.2 docs indicate you&#39;re not using it right for what <code>create</code> expects in your version."}, {"owner": {"reputation": 962, "user_id": 2011580, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/E9Ket.png?s=128&g=1", "display_name": "James B. Byrne", "link": "https://stackoverflow.com/users/2011580/james-b-byrne"}, "edited": false, "score": 0, "creation_date": 1449694155, "post_id": 34187583, "comment_id": 56123717, "body": "What happens if you do this:      let!(:notification) { FactoryGirl.create(:notification, &#39;confirmable&#39;) }  or perhaps this:        let!(:notification) { FactoryGirl.create(:notification, &#39;confirmable&#39; =&gt; true) }"}, {"owner": {"reputation": 838, "user_id": 4107375, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/92eb78c7c4b20429f9d22a1d5e38be57?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/4107375/jay"}, "edited": false, "score": 0, "creation_date": 1449694306, "post_id": 34187583, "comment_id": 56123812, "body": "I updated my factory to how the docs have the traits setup.  It&#39;s works now, but is returning notification as a hash and not a object.  I call the factory like this <code>create(:confirmable_notification)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1449693651, "post_id": 34188173, "comment_id": 56123458, "body": "... &quot;The problem is with the arguments you&#39;re passing in.&quot; Right, but the OP is asking <i>why</i> it&#39;s a problem, not for confirmation that it&#39;s a problem."}], "tags": [], "owner": {"reputation": 962, "user_id": 2011580, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/E9Ket.png?s=128&g=1", "display_name": "James B. Byrne", "link": "https://stackoverflow.com/users/2011580/james-b-byrne"}, "is_accepted": false, "score": -1, "last_activity_date": 1449695506, "last_edit_date": 1449695506, "creation_date": 1449692156, "answer_id": 34188173, "question_id": 34187583, "link": "https://stackoverflow.com/questions/34187583/undefined-method-symbolize-keys-when-using-factory-girl-traits/34188173#34188173", "title": "undefined method `symbolize_keys&#39; when using factory girl traits", "body": "<p>No, the version of Ruby you are using has nothing to do with <code>symbolize_keys</code> because it is not part of the the Ruby core.  Neither 1.9.3 nor 2.2.2 contain it. Rather, <code>symbolize_keys</code> is an ActiveSupport extension to the Hash class.  You must have Active support loaded to get this to work. See: <a href=\"http://api.rubyonrails.org/classes/ActiveSupport/HashWithIndifferentAccess.html\" rel=\"nofollow\">Rails-4.2.5 : Object::HashWithIndifferentAccess &lt; Hash</a>.</p>\n\n<p>Since this is a RoR question, which I missed (mea culpa), the problem evidently lies with the declaration of <code>confirmable</code> as a symbol rather than a hash.  However, the version of Ruby in use has nothing to do with the problem in either case.</p>\n"}], "owner": {"reputation": 838, "user_id": 4107375, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/92eb78c7c4b20429f9d22a1d5e38be57?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/4107375/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 585, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1449786800, "creation_date": 1449690024, "last_edit_date": 1449690935, "question_id": 34187583, "link": "https://stackoverflow.com/questions/34187583/undefined-method-symbolize-keys-when-using-factory-girl-traits", "title": "undefined method `symbolize_keys&#39; when using factory girl traits", "body": "<p>I'm using ruby v1.9.3 and factory_girl v2.2  and trying to setup traits.  But am getting this error when I try to use my trait. Is it because of the ruby version I am using?</p>\n\n<pre><code> Failure/Error: let!(:notification) { create(:notification, :confirmable) }\n NoMethodError:\n   undefined method `symbolize_keys' for :confirmable:Symbol\n # ./spec/controllers/api/v1/sms_controller_spec.rb:13:in `block (3 levels) in &lt;top (required)&gt;\n</code></pre>\n\n<p>This is my factory:</p>\n\n<pre><code>FactoryGirl.define do\n  factory :notification do\n    smssid { Faker::Number.number(10) }\n    msg    { Faker::Lorem.sentence(3) }\n    to     { Faker::PhoneNumber.phone_number }\n\n    trait :confirmable do\n      confirmable  \"true\"\n    end\n  end\nend\n</code></pre>\n\n<p>spec:</p>\n\n<pre><code>require 'spec_helper'\n\ndescribe Api::V1::SmsController do\n\n  let!(:user) { create(:user) }\n\n  describe \"GET /api/v1/user/sms\" do\n\n    let!(:notification) { FactoryGirl.create(:notification, :confirmable) }\n\n    context \"a user replies to a confirmation with c\" do\n      it \"does something\" do\n        get :incomming_message, :sid =&gt; notification.smssid,\n                                :to =&gt; notification.to,\n                                :from =&gt; user.phone_number,\n                                :body =&gt; \"c\",\n                                :status =&gt; \"recieved\",\n                                :format =&gt; :json\n        notification.reload\n        notification.confirmed.should eq(true)\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>*** Edit, updated with my spec file</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "controller"], "comments": [{"owner": {"reputation": 84, "user_id": 3573300, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zLoEI.jpg?s=128&g=1", "display_name": "richessler", "link": "https://stackoverflow.com/users/3573300/richessler"}, "edited": false, "score": 0, "creation_date": 1449701736, "post_id": 34187426, "comment_id": 56127534, "body": "Can you post your markup?  Are you using <code>simple_form</code>?"}, {"owner": {"reputation": 1637, "user_id": 3353794, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/m0hyF.png?s=128&g=1", "display_name": "agbodike", "link": "https://stackoverflow.com/users/3353794/agbodike"}, "reply_to_user": {"reputation": 84, "user_id": 3573300, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zLoEI.jpg?s=128&g=1", "display_name": "richessler", "link": "https://stackoverflow.com/users/3573300/richessler"}, "edited": false, "score": 0, "creation_date": 1449702160, "post_id": 34187426, "comment_id": 56127711, "body": "I think posting the markup would be a distraction, but I will add details about the gems / versions. The code works properly, it is the test that is the problem."}], "answers": [{"comments": [{"owner": {"reputation": 1637, "user_id": 3353794, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/m0hyF.png?s=128&g=1", "display_name": "agbodike", "link": "https://stackoverflow.com/users/3353794/agbodike"}, "edited": false, "score": 0, "creation_date": 1449782770, "post_id": 34195827, "comment_id": 56168324, "body": "We use FactoryGirl elsewhere, but I didn&#39;t write the test. My guess is the author is just testing simple functionality and doesn&#39;t want to build up a full suite of objects to test this. How would FactoryGirl help here?"}], "tags": [], "owner": {"reputation": 190, "user_id": 2186369, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9caebb18c7dbc1040df4201f0e7902d1?s=128&d=identicon&r=PG", "display_name": "Alexei.B", "link": "https://stackoverflow.com/users/2186369/alexei-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1449731806, "creation_date": 1449731806, "answer_id": 34195827, "question_id": 34187426, "link": "https://stackoverflow.com/questions/34187426/rspec-rails-controller-submit-form-params-uri-encoded-rather-than-hash/34195827#34195827", "title": "Rspec Rails controller submit form params URI encoded rather than hash", "body": "<p>Why don't you use FactoryGirl to build attributes?</p>\n"}], "owner": {"reputation": 1637, "user_id": 3353794, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/m0hyF.png?s=128&g=1", "display_name": "agbodike", "link": "https://stackoverflow.com/users/3353794/agbodike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 462, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1449731806, "creation_date": 1449689465, "last_edit_date": 1449703302, "question_id": 34187426, "link": "https://stackoverflow.com/questions/34187426/rspec-rails-controller-submit-form-params-uri-encoded-rather-than-hash", "title": "Rspec Rails controller submit form params URI encoded rather than hash", "body": "<p>I'm testing a controller, and when I submit the form data some of it is coming into the controller as a string, rather than the hash I am expecting.</p>\n\n<pre><code>def send_request(params={})\n  patch :update, params.merge(:id =&gt; @company.id)\nend\n\ndescribe 'should_receive' do\n  let(:test_params) do\n    {\n      \"utf8\"=&gt;\"\u2713\",\n      \"_method\"=&gt;\"patch\",\n      \"button\"=&gt;\"\",\n      \"company\"=&gt;\n      { \"label_ids\"=&gt;[\"\"],\n        \"customer_users_attributes\"=&gt;{\"0\"=&gt;{\"id\"=&gt;\"3\", \"is_primary\"=&gt;\"true\"}},\n        \"baselines_attributes\"=&gt;{\"0\"=&gt;{\"label_ids\"=&gt;[\"\"], \"benchmark_ids\"=&gt;[\"\"], \"id\"=&gt;\"1\"}}},\n      \"action\"=&gt;\"update\",\n      \"controller\"=&gt;\"admin/companies\",\n    }\n  end\n\n  after(:each) do\n    send_request(test_params)\n  end\n\n  it { @company.should_receive(:update).with(test_params).and_return(true) }\n</code></pre>\n\n<p>The error when the test is run:</p>\n\n<pre><code> Failure/Error: patch :update, params.merge(:id =&gt; @company.id)\n NoMethodError:\n   undefined method `has_key?' for \"baselines_attributes%5Bsite_url%5D=site_url\":String\n</code></pre>\n\n<p>the params just before the failure:</p>\n\n<pre><code>{\"utf8\"=&gt;\"\u2713\",\n \"_method\"=&gt;\"patch\",\n \"button\"=&gt;\"\",\n \"company\"=&gt;\n  \"baselines_attributes%5B0%5D%5Bbenchmark_ids%5D%5B%5D=&amp;baselines_attributes%5B0%5D%5Bid%5D=1&amp;baselines_attributes%5B0%5D%5Blabel_ids%5D%5B%5D=&amp;customer_users_attributes%5B0%5D%5Bid%5D=3&amp;customer_users_attributes%5B0%5D%5Bis_primary%5D=true&amp;label_ids%5B%5D=\",\n \"action\"=&gt;\"update\",\n \"controller\"=&gt;\"admin/companies\",\n \"id\"=&gt;\"1\"}\n</code></pre>\n\n<p>The params at the same location when the form is submitted via a browser:</p>\n\n<pre><code>{\"utf8\"=&gt;\"\u2713\",\n \"_method\"=&gt;\"patch\",\n \"button\"=&gt;\"\",\n \"company\"=&gt;\n  {\"label_ids\"=&gt;[\"\"],\n   \"customer_users_attributes\"=&gt;{\"0\"=&gt;{\"id\"=&gt;\"3\",\n     \"is_primary\"=&gt;\"true\"}},\n   \"baselines_attributes\"=&gt;{\n     \"0\"=&gt;{\"label_ids\"=&gt;[\"\"], \"benchmark_ids\"=&gt;[\"\"], \"id\"=&gt;\"1\"}}},\n \"action\"=&gt;\"update\",\n \"controller\"=&gt;\"admin/companies\",\n \"id\"=&gt;\"1\"}\n</code></pre>\n\n<p>in the test everything in params[:company] is a URI encoded string, whereas in the real code it comes in properly as a hash.</p>\n\n<p>How can I get the test data to be properly handled?</p>\n\n<p><strong>Update</strong></p>\n\n<p>Ruby 2.2.0</p>\n\n<p>Relevant gems:</p>\n\n<ul>\n<li>rails (4.0.13)</li>\n<li>rspec-core (2.14.8)</li>\n<li>nested_form (0.3.2)</li>\n</ul>\n"}, {"tags": ["ruby-on-rails", "ruby", "select2-rails"], "answers": [{"tags": [], "owner": {"reputation": 19714, "user_id": 1006863, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/sYOuq.jpg?s=128&g=1", "display_name": "Paulo Fidalgo", "link": "https://stackoverflow.com/users/1006863/paulo-fidalgo"}, "is_accepted": false, "score": 4, "last_activity_date": 1495725872, "last_edit_date": 1592644375, "creation_date": 1495725872, "answer_id": 44184173, "question_id": 34187345, "link": "https://stackoverflow.com/questions/34187345/select2-automatically-adding-blank-value/44184173#44184173", "title": "Select2 automatically adding blank value", "body": "<p>Directly taken from the <code>select</code> <a href=\"http://api.rubyonrails.org/classes/ActionView/Helpers/FormOptionsHelper.html#method-i-select\" rel=\"nofollow noreferrer\">documentation</a>:</p>\n<p><strong>Gotcha</strong></p>\n<p>The HTML specification says when multiple parameter passed to select and all options got deselected web browsers do not send any value to server. Unfortunately this introduces a gotcha: if an User model has many roles and have role_ids accessor, and in the form that edits roles of the user the user deselects all roles from role_ids multiple select box, no role_ids parameter is sent. So, any mass-assignment idiom like</p>\n<pre><code>@user.update(params[:user])\n</code></pre>\n<p>wouldn't update roles.</p>\n<p>To prevent this the helper generates an auxiliary hidden field before every multiple select. The hidden field has the same name as multiple select and blank value.</p>\n<p>Note: The client either sends only the hidden field (representing the deselected multiple select box), or both fields. This means that the resulting array always contains a blank string.</p>\n<p>In case if you don't want the helper to generate this hidden field you can specify <code>include_hidden: false</code> option.</p>\n<p>So bottom line is to add:</p>\n<p><code>include_hidden: false</code></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6921068, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SDvj8.jpg?s=128&g=1", "display_name": "3xcellent", "link": "https://stackoverflow.com/users/6921068/3xcellent"}, "is_accepted": false, "score": 0, "last_activity_date": 1502136810, "creation_date": 1502136810, "answer_id": 45554983, "question_id": 34187345, "link": "https://stackoverflow.com/questions/34187345/select2-automatically-adding-blank-value/45554983#45554983", "title": "Select2 automatically adding blank value", "body": "<p>For me the issue was I didn't pass the 'multiple: true' option to the select_tag in my erb/haml, and only set the option in select2 when initializing.</p>\n\n<p>Make sure you have the option in both places.</p>\n"}], "owner": {"reputation": 355, "user_id": 3101708, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3dc939dafecbb4a4d2aed751f25320bb?s=128&d=identicon&r=PG", "display_name": "nhyne", "link": "https://stackoverflow.com/users/3101708/nhyne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1546, "favorite_count": 1, "answer_count": 2, "score": 5, "last_activity_date": 1502136810, "creation_date": 1449689181, "question_id": 34187345, "link": "https://stackoverflow.com/questions/34187345/select2-automatically-adding-blank-value", "title": "Select2 automatically adding blank value", "body": "<p>I'm using select2 for a multiple selector. Currently this is in my HTML file: </p>\n\n<pre><code> &lt;%= form.select \"page_request_set_ids\", @multiautocomplete_set_options.unshift(\"\"),\n {}, id: \"page-request-sets\", multiple: true,\n allowClear: true, data: {placeholder: \"Start typing sets...\"} %&gt;\n</code></pre>\n\n<p><code>@multiautocomplete_set_options</code> is an array of strings. \nWhen I go to access <code>:page_request_set_ids</code> later, the strings I typed in are there, along with an empty string.</p>\n\n<p>I've tried to remove the <code>unshift(\"\")</code>, which kept my placeholder, but did not remove the issue of the blank string in <code>:page_request_set_ids</code>.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["ruby", "json", "svg", "tree"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1449690808, "post_id": 34187212, "comment_id": 56121794, "body": "Please edit your question to include an example of your input data, the output you&#39;re getting and the output you expect."}], "owner": {"reputation": 353, "user_id": 5257994, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/100002859431844/picture?type=large", "display_name": "Reaper9806", "link": "https://stackoverflow.com/users/5257994/reaper9806"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1449734185, "creation_date": 1449688759, "last_edit_date": 1449733300, "question_id": 34187212, "link": "https://stackoverflow.com/questions/34187212/ruby-json-tree-to-svg", "title": "Ruby JSON tree to SVG", "body": "<p>I have this project where I have to parse a JSON tree and generate an SVG image and this is my code so far:</p>\n\n<pre><code>require 'json'\n\n\ndef treeNode(x, y, str)\n    textX = x - 15\n    textY = y + 5\n    '&lt;circle cx = \"'+x.to_s+'\" cy = \"'+y.to_s+'\" r = \"40\" stroke = \"black\" stroke-width = \"2\" fill = \"none\"/&gt;'+\"\\n\"+\n    '&lt;text x = \"'+textX.to_s+'\" y = \"'+textY.to_s+'\" fill = \"black\"&gt;'+str.to_s+'&lt;/text&gt; '+\"\\n\"\nend\n\ndef makeTree(x, y, hash, file)\n\n xDistance = 140\n yDistance = 100\n\n hash.each do |key, value| \n    if value.kind_of?(String)\n      file &lt;&lt; treeNode(x, y, value)\n    elsif value.kind_of?(Hash)\n      file &lt;&lt; makeTree(x, y, value, file)\n    elsif value.kind_of?(Array)\n      value.each do |e|\n        file &lt;&lt; makeTree(x, y, e, file)\n        x += xDistance\n      end\n    end\n    y += yDistance\n  end\nend\n\njsonFile = ARGV[0]\ndata = Hash.new()\nfile = File.read(jsonFile)\ndata = JSON.parse(file)\n\nFile.open('B_14_Ivo_Gerginov.svg', 'w') do |svg|\n  svg &lt;&lt; '&lt;svg xmlns = \"http://www.w3.org/2000/svg\" width=\"10000\" height=\"10000\"&gt;' + \"\\n\"\n  makeTree(60, 60, data, svg)\n  svg &lt;&lt; '&lt;/svg&gt;'\nend\n</code></pre>\n\n<p>My problem is that the branches kind of overlap, and their positioning is a little screwy. I'm supposed to do it recursively, so it has to be fixed in the <code>makeTree()</code> method. Can anyone give me an idea?</p>\n\n<p>Input: <code>ruby tree.rb test.json</code></p>\n\n<p>the test JSON file(disclaimer, i didn't write the JSON file, it was given to me for the task):</p>\n\n<pre><code>{\n  \"node_name\" : \"TUES\",\n  \"children\" : [\n    { \"node_name\": \"11a\",\n      \"children\" : [\n                        {\"node_name\": \"Kiril\"},\n                        {\"node_name\": \"Mitov\"}  \n      ]},\n    { \"node_name\": \"11b\",\n      \"children\" : [\n                        {\"node_name\": \"Nenko\"},\n                        {\"node_name\": \"Tabakov\"},\n                        {\"node_name\": \"Bojidar\"}\n      ]}\n  ]\n}\n</code></pre>\n\n<p>Output: a .svg file containing this:</p>\n\n<pre><code>&lt;svg xmlns = \"http://www.w3.org/2000/svg\" width=\"10000\" height=\"10000\"&gt;\n&lt;circle cx = \"60\" cy = \"60\" r = \"40\" stroke = \"black\" stroke-width = \"2\" fill = \"none\"/&gt;\n&lt;text x = \"45\" y = \"65\" fill = \"black\"&gt;TUES&lt;/text&gt; \n&lt;circle cx = \"60\" cy = \"160\" r = \"40\" stroke = \"black\" stroke-width = \"2\" fill = \"none\"/&gt;\n&lt;text x = \"45\" y = \"165\" fill = \"black\"&gt;11a&lt;/text&gt; \n&lt;circle cx = \"60\" cy = \"260\" r = \"40\" stroke = \"black\" stroke-width = \"2\" fill = \"none\"/&gt;\n&lt;text x = \"45\" y = \"265\" fill = \"black\"&gt;Kiril&lt;/text&gt; \n{\"node_name\"=&gt;\"Kiril\"}&lt;circle cx = \"200\" cy = \"260\" r = \"40\" stroke = \"black\" stroke-width = \"2\" fill = \"none\"/&gt;\n&lt;text x = \"185\" y = \"265\" fill = \"black\"&gt;Mitov&lt;/text&gt; \n{\"node_name\"=&gt;\"Mitov\"}{\"node_name\"=&gt;\"11a\", \"children\"=&gt;[{\"node_name\"=&gt;\"Kiril\"}, {\"node_name\"=&gt;\"Mitov\"}]}&lt;circle cx = \"200\" cy = \"160\" r = \"40\" stroke = \"black\" stroke-width = \"2\" fill = \"none\"/&gt;\n&lt;text x = \"185\" y = \"165\" fill = \"black\"&gt;11b&lt;/text&gt; \n&lt;circle cx = \"200\" cy = \"260\" r = \"40\" stroke = \"black\" stroke-width = \"2\" fill = \"none\"/&gt;\n&lt;text x = \"185\" y = \"265\" fill = \"black\"&gt;Nenko&lt;/text&gt; \n{\"node_name\"=&gt;\"Nenko\"}&lt;circle cx = \"340\" cy = \"260\" r = \"40\" stroke = \"black\" stroke-width = \"2\" fill = \"none\"/&gt;\n&lt;text x = \"325\" y = \"265\" fill = \"black\"&gt;Tabakov&lt;/text&gt; \n{\"node_name\"=&gt;\"Tabakov\"}&lt;circle cx = \"480\" cy = \"260\" r = \"40\" stroke = \"black\" stroke-width = \"2\" fill = \"none\"/&gt;\n&lt;text x = \"465\" y = \"265\" fill = \"black\"&gt;Bojidar&lt;/text&gt; \n{\"node_name\"=&gt;\"Bojidar\"}{\"node_name\"=&gt;\"11b\", \"children\"=&gt;[{\"node_name\"=&gt;\"Nenko\"}, {\"node_name\"=&gt;\"Tabakov\"}, {\"node_name\"=&gt;\"Bojidar\"}]}&lt;/svg&gt;\n</code></pre>\n\n<p>It's supposed to look like a tree, but I haven't done the lines yet, and the second branch is overlapping the first one.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1698, "user_id": 4587148, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/VjBAv.jpg?s=128&g=1", "display_name": "Sajan", "link": "https://stackoverflow.com/users/4587148/sajan"}, "edited": false, "score": 0, "creation_date": 1449688909, "post_id": 34186914, "comment_id": 56120744, "body": "I don&#39;t get your need exactly but I guess you can send param through link to know which one is clicked."}, {"owner": {"reputation": 47, "user_id": 4006170, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/763e84606137ddaeb2da7e771f5d5646?s=128&d=identicon&r=PG&f=1", "display_name": "sjk2426", "link": "https://stackoverflow.com/users/4006170/sjk2426"}, "reply_to_user": {"reputation": 1698, "user_id": 4587148, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/VjBAv.jpg?s=128&g=1", "display_name": "Sajan", "link": "https://stackoverflow.com/users/4587148/sajan"}, "edited": false, "score": 0, "creation_date": 1449689058, "post_id": 34186914, "comment_id": 56120819, "body": "what do you think about my solution?"}, {"owner": {"reputation": 1698, "user_id": 4587148, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/VjBAv.jpg?s=128&g=1", "display_name": "Sajan", "link": "https://stackoverflow.com/users/4587148/sajan"}, "edited": false, "score": 0, "creation_date": 1449689153, "post_id": 34186914, "comment_id": 56120865, "body": "That&#39;s what I was suggesting. You can filter from Follow according to the param. No need of two tables."}, {"owner": {"reputation": 47, "user_id": 4006170, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/763e84606137ddaeb2da7e771f5d5646?s=128&d=identicon&r=PG&f=1", "display_name": "sjk2426", "link": "https://stackoverflow.com/users/4006170/sjk2426"}, "reply_to_user": {"reputation": 1698, "user_id": 4587148, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/VjBAv.jpg?s=128&g=1", "display_name": "Sajan", "link": "https://stackoverflow.com/users/4587148/sajan"}, "edited": false, "score": 0, "creation_date": 1449689180, "post_id": 34186914, "comment_id": 56120879, "body": "perfect. thanks for the quick review"}], "answers": [{"comments": [{"owner": {"reputation": 1407, "user_id": 889074, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/YwYtO.jpg?s=128&g=1", "display_name": "kalelc", "link": "https://stackoverflow.com/users/889074/kalelc"}, "reply_to_user": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1525446932, "post_id": 34187251, "comment_id": 87373526, "body": "Is only one example, the main problem is how to render two views using render."}, {"owner": {"reputation": 1407, "user_id": 889074, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/YwYtO.jpg?s=128&g=1", "display_name": "kalelc", "link": "https://stackoverflow.com/users/889074/kalelc"}, "reply_to_user": {"reputation": 4600, "user_id": 5961578, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/df7cbfdd2a92a7926af3bbb8648318aa?s=128&d=identicon&r=PG", "display_name": "moveson", "link": "https://stackoverflow.com/users/5961578/moveson"}, "edited": false, "score": 0, "creation_date": 1525447528, "post_id": 34187251, "comment_id": 87373922, "body": "yeah, in this case; you have the reason. I only wrote without think in that hahaha"}], "tags": [], "owner": {"reputation": 1407, "user_id": 889074, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/YwYtO.jpg?s=128&g=1", "display_name": "kalelc", "link": "https://stackoverflow.com/users/889074/kalelc"}, "is_accepted": false, "score": 3, "last_activity_date": 1525447596, "last_edit_date": 1525447596, "creation_date": 1449688904, "answer_id": 34187251, "question_id": 34186914, "link": "https://stackoverflow.com/questions/34186914/rails-two-views-with-one-controlleraction/34187251#34187251", "title": "Rails Two Views With One Controller#Action", "body": "<p>Example:</p>\n\n<pre><code>def index\n  @follows = Follow.all    \n  if @follows.present?\n    render 'show_with_followers'\n  else\n    render 'show_without_followings'\n  end\nend\n</code></pre>\n\n<p><strong>views</strong></p>\n\n<pre><code>app/views/follows/_show_with_followers.html.erb\napp/views/follows/_show_without_followings.html.erb\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 47, "user_id": 4006170, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/763e84606137ddaeb2da7e771f5d5646?s=128&d=identicon&r=PG&f=1", "display_name": "sjk2426", "link": "https://stackoverflow.com/users/4006170/sjk2426"}, "is_accepted": false, "score": 1, "last_activity_date": 1449689003, "creation_date": 1449689003, "answer_id": 34187291, "question_id": 34186914, "link": "https://stackoverflow.com/questions/34186914/rails-two-views-with-one-controlleraction/34187291#34187291", "title": "Rails Two Views With One Controller#Action", "body": "<p>Here is an answer I found so far. I will be using in my view</p>\n\n<pre><code>&lt;%= link_to 'Followers', follows_path(:follows =&gt; 'followers') %&gt;\n&lt;%= link_to 'Followings', follows_path(:follows =&gt; 'followings') %&gt;\n</code></pre>\n\n<p>and use</p>\n\n<pre><code>def index\n    if params[\"follows\"] == 'followers'\n      #render followers\n    else\n      #render followings\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 4006170, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/763e84606137ddaeb2da7e771f5d5646?s=128&d=identicon&r=PG&f=1", "display_name": "sjk2426", "link": "https://stackoverflow.com/users/4006170/sjk2426"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1288, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1525447596, "creation_date": 1449687745, "question_id": 34186914, "link": "https://stackoverflow.com/questions/34186914/rails-two-views-with-one-controlleraction", "title": "Rails Two Views With One Controller#Action", "body": "<p>I created a rails association \"user has many follows\" currently have lists of user's followers and followings. I want to have 2 links on<code>users#show</code> to display lists of followers and followings. I know I can render two different views in my <code>follows#index</code> using <code>if else</code> statement but I'm not sure how to go about it. My initial thought was to have rails check which link was clicked (either 'Followers' or 'Followings') but I couldn't find an exact answer. I also thought of creating two different tables (Followers, Followings) but adding 2 same values for 1 action seemed redundant and waste of space.</p>\n\n<p>Here is my FollowsController:</p>\n\n<pre><code>class FollowsController &lt; ApplicationController\n\n  def index\n    @follows = Follow.all\n    render :index\n  end\n\n  def create\n    @follow = Follow.create(follow_params)\n    redirect_to user_url(@follow.user_id)\n  end\n\n  def destroy\n    @follow = Follow.find(params[:id])\n    @follower_id = @follow.user_id\n    @follow.destroy!\n    redirect_to user_url(@follower_id)\n  end\n\n  private\n\n  def follow_params\n    params.require(:follow).permit(:follower_id, :user_id)\n  end\n\nend\n</code></pre>\n\n<p>What would be the best approach?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "strong-parameters"], "comments": [{"owner": {"reputation": 4457, "user_id": 4856698, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YF1b0zyYypU/AAAAAAAAAAI/AAAAAAAAAB0/6hdTAeg_61s/photo.jpg?sz=128", "display_name": "NickGnd", "link": "https://stackoverflow.com/users/4856698/nickgnd"}, "edited": false, "score": 1, "creation_date": 1449687233, "post_id": 34186682, "comment_id": 56119841, "body": "How is malformed_parmas ? Could you share it please?"}, {"owner": {"reputation": 2597, "user_id": 2948793, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/YkdhN.png?s=128&g=1", "display_name": "ConorB", "link": "https://stackoverflow.com/users/2948793/conorb"}, "edited": false, "score": 0, "creation_date": 1591783348, "post_id": 34186682, "comment_id": 110184717, "body": "<a href=\"https://medium.com/@edgar/rspec-how-to-have-rails-request-specs-handling-errors-like-production-a8c21ed0308a\" rel=\"nofollow noreferrer\">medium.com/@edgar/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 9917, "user_id": 1586221, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96ab4c67eb62b315a8e7584f7dfd547a?s=128&d=identicon&r=PG", "display_name": "tompave", "link": "https://stackoverflow.com/users/1586221/tompave"}, "edited": false, "score": 0, "creation_date": 1449687977, "post_id": 34186955, "comment_id": 56120248, "body": "No, I want to test that the controller responds with 400 if a parameter is missing. I don&#39;t want to test the successful response. I&#39;m deliberately sending a malformed request."}], "tags": [], "owner": {"reputation": 4054, "user_id": 3756358, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/41dcc37fe83d035fa725a8fa6f591c74?s=128&d=identicon&r=PG", "display_name": "Tobias", "link": "https://stackoverflow.com/users/3756358/tobias"}, "is_accepted": false, "score": -1, "last_activity_date": 1449687883, "creation_date": 1449687883, "answer_id": 34186955, "question_id": 34186682, "link": "https://stackoverflow.com/questions/34186682/rails-how-to-test-400-response-with-missing-parameter/34186955#34186955", "title": "Rails, how to test 400 response with missing parameter", "body": "<p>The problem is that you are trying to get the hash with the <code>:user</code> key in your controller. Since this hash isn't available for the incorrect tests it will raise an exception.</p>\n\n<p>Try something like this:</p>\n\n<pre><code>post :action, user: malformed_params\n</code></pre>\n\n<p>I haven't tested it but it should work.</p>\n\n<p>Happy coding. :)</p>\n"}, {"comments": [{"owner": {"reputation": 9917, "user_id": 1586221, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96ab4c67eb62b315a8e7584f7dfd547a?s=128&d=identicon&r=PG", "display_name": "tompave", "link": "https://stackoverflow.com/users/1586221/tompave"}, "edited": false, "score": 0, "creation_date": 1449688037, "post_id": 34186963, "comment_id": 56120283, "body": "No, I&#39;m not trying to validate the JSON syntactical structure. I&#39;m trying to check the response if a parameter is missing, and the response <i>should</i> be 400, not an exception."}], "tags": [], "owner": {"reputation": 4457, "user_id": 4856698, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YF1b0zyYypU/AAAAAAAAAAI/AAAAAAAAAB0/6hdTAeg_61s/photo.jpg?sz=128", "display_name": "NickGnd", "link": "https://stackoverflow.com/users/4856698/nickgnd"}, "is_accepted": false, "score": -1, "last_activity_date": 1449687906, "creation_date": 1449687906, "answer_id": 34186963, "question_id": 34186682, "link": "https://stackoverflow.com/questions/34186682/rails-how-to-test-400-response-with-missing-parameter/34186963#34186963", "title": "Rails, how to test 400 response with missing parameter", "body": "<p>The exception raised is correct because are not sending a malformed json. \nThe payload is formatted well, but is missing a params.</p>\n\n<p>You have to try with something similar at : </p>\n\n<pre><code>'{ i am malformed json'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 514, "user_id": 1320811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/336eb87cea8c89c857b227397f6fa4a5?s=128&d=identicon&r=PG", "display_name": "dferrazm", "link": "https://stackoverflow.com/users/1320811/dferrazm"}, "is_accepted": false, "score": 4, "last_activity_date": 1545913333, "creation_date": 1545913333, "answer_id": 53945015, "question_id": 34186682, "link": "https://stackoverflow.com/questions/34186682/rails-how-to-test-400-response-with-missing-parameter/53945015#53945015", "title": "Rails, how to test 400 response with missing parameter", "body": "<p>If you want to simulate production across all environments and always raise 400 when any required parameter is missing, instead of changing each config file, you could just put in your controller (or <code>ApplicationController</code> or any other mixin to make it more general):</p>\n\n<pre><code># assuming we're talking about a JSON API\n\nrescue_from ActionController::ParameterMissing do |e|\n  render json: { error: e.message }, status: :bad_request\nend\n\n# or more general for any kind of response\n\nrescue_from ActionController::ParameterMissing do |e|\n  head :bad_request\nend\n</code></pre>\n"}], "owner": {"reputation": 9917, "user_id": 1586221, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/96ab4c67eb62b315a8e7584f7dfd547a?s=128&d=identicon&r=PG", "display_name": "tompave", "link": "https://stackoverflow.com/users/1586221/tompave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1876, "favorite_count": 0, "answer_count": 3, "score": 8, "last_activity_date": 1545913333, "creation_date": 1449686921, "last_edit_date": 1592644375, "question_id": 34186682, "link": "https://stackoverflow.com/questions/34186682/rails-how-to-test-400-response-with-missing-parameter", "title": "Rails, how to test 400 response with missing parameter", "body": "<p>I'm working with Rails <code>4.2.5</code>, and I'm trying to test an expected 400 response from a controller in case of malformed request. The parameter validation logic is handled by <code>strong_parameters</code>.</p>\n<h3>the context</h3>\n<p>In my controller I have:</p>\n<pre><code>def user_params\n  params.require(:user).permit(:foo, :bar, :baz)\nend\n</code></pre>\n<p>And I'm referencing <code>user_params</code> in a POST request with <code>Accept</code> and <code>ContentType</code> headers set to <code>application/json</code>.</p>\n<p>In <code>development</code>, POSTing without a <code>user</code> parameter will raise a <code>ActionController::ParameterMissing</code> exception.<br />\nIf I set this in my <code>environments/development.rb</code> file:</p>\n<pre><code>Rails.application.configure do\n  config.consider_all_requests_local = false\nend\n</code></pre>\n<p>Rails will act like in <code>production</code> and return a simple 400 response instead of the debug page. Great.</p>\n<h3>the problem</h3>\n<p>I'm having troubles doing the same thing in my controller tests, though (<code>rspec-rails ~&gt; 3.4</code>).</p>\n<p>Specifically, this will pass:</p>\n<pre><code>expect {\n  post :action, malformed_params\n}.to raise_error(ActionController::ParameterMissing)\n</code></pre>\n<p>but this won't because of the raised exception:</p>\n<pre><code>post :action, malformed_params\nexpect(response.status).to eql 400\n</code></pre>\n<p>I have already tried to flip the <code>consider_all_requests_local</code> for the test environment, to no avail.</p>\n<p>Any solution?\nThere is <a href=\"https://stackoverflow.com/questions/20810660/trying-to-get-a-post-to-return-400-bad-request\">an old answer</a> on this, but it does not help (and even the asker recognized it was not useful).</p>\n<h3>Edit:</h3>\n<p>As asked in the comments, here are the parameters from the controller spec:</p>\n<pre><code>let(:user_data) do\n  { foo: &quot;foo&quot;, bar: &quot;bar&quot;, baz: &quot;baz&quot; }\nend\n\nlet(:good_params) do\n  {\n    some_id: SecureRandom.uuid,\n    user: user_data\n  }\nend\n\nlet(:malformed_params) do\n  { some_id: SecureRandom.uuid }.merge(user_data)\nend\n\nlet(:incomplete_params) do\n  { some_id: SecureRandom.uuid }\nend\n</code></pre>\n<p><code>good_params</code> works for the <em>happy path</em>. Neither <code>malformed_params</code> nor <code>incomplete_params</code> work when I want to test the 400: both will raise the exception and cause the test to fail.</p>\n<p>I've already verified that the same parameter payloads will work when POSTing to a running server (in <code>development</code>, but with the configuration tweaked as described above).</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec"], "answers": [{"comments": [{"owner": {"reputation": 11294, "user_id": 609043, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/979a0b3e2f9d19f8e1acf34716221c59?s=128&d=identicon&r=PG", "display_name": "ibaralf", "link": "https://stackoverflow.com/users/609043/ibaralf"}, "edited": false, "score": 0, "creation_date": 1449685469, "post_id": 34186195, "comment_id": 56118740, "body": "Would this execute the files in the order of the arguments? Anyway, thanks so much for this answer."}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "reply_to_user": {"reputation": 11294, "user_id": 609043, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/979a0b3e2f9d19f8e1acf34716221c59?s=128&d=identicon&r=PG", "display_name": "ibaralf", "link": "https://stackoverflow.com/users/609043/ibaralf"}, "edited": false, "score": 1, "creation_date": 1449685548, "post_id": 34186195, "comment_id": 56118794, "body": "Yes, by default <code>rspec</code> will read and execute spec files in the order they&#39;re given. You can change this behavior using the <code>--order</code> option: <a href=\"https://relishapp.com/rspec/rspec-core/docs/command-line/order\" rel=\"nofollow noreferrer\">relishapp.com/rspec/rspec-core/docs/command-line/order</a>"}, {"owner": {"reputation": 11294, "user_id": 609043, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/979a0b3e2f9d19f8e1acf34716221c59?s=128&d=identicon&r=PG", "display_name": "ibaralf", "link": "https://stackoverflow.com/users/609043/ibaralf"}, "edited": false, "score": 1, "creation_date": 1449858418, "post_id": 34186195, "comment_id": 56204050, "body": "Just a note: the order of execution of spec files is not by order of the spec files given on the command line.  <a href=\"https://github.com/rspec/rspec-core/issues/1900\" rel=\"nofollow noreferrer\">github.com/rspec/rspec-core/issues/1900</a> One workaround I got working is alphabetically naming the spec files to determine the order."}], "tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": true, "score": 2, "last_activity_date": 1449685232, "creation_date": 1449685232, "answer_id": 34186195, "question_id": 34186024, "link": "https://stackoverflow.com/questions/34186024/rspec-results-appended-to-just-1-file/34186195#34186195", "title": "RSPEC results appended to just 1 file", "body": "<p>You can pass multiple filenames to <code>rspec</code>:</p>\n\n<pre><code>$ bundle exec rspec basic1_spec.rb basic2_spec.rb\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11294, "user_id": 609043, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/979a0b3e2f9d19f8e1acf34716221c59?s=128&d=identicon&r=PG", "display_name": "ibaralf", "link": "https://stackoverflow.com/users/609043/ibaralf"}, "edited": false, "score": 0, "creation_date": 1449685900, "post_id": 34186345, "comment_id": 56119013, "body": "I tried your suggestion but got this error - C:/Ruby22-x64/lib/ruby/gems/2.2.0/gems/rspec-core-3.3.2/lib/&zwnj;&#8203;rspec/core/formatter&zwnj;&#8203;s.rb:251:in `initialize&#39;: Permission denied @ rb_s ysopen - ./results/rspec_results.xml (Errno::EACCES)   Any reason why I&#39;m getting Permission error? Thanks."}, {"owner": {"reputation": 4457, "user_id": 4856698, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YF1b0zyYypU/AAAAAAAAAAI/AAAAAAAAAB0/6hdTAeg_61s/photo.jpg?sz=128", "display_name": "NickGnd", "link": "https://stackoverflow.com/users/4856698/nickgnd"}, "reply_to_user": {"reputation": 11294, "user_id": 609043, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/979a0b3e2f9d19f8e1acf34716221c59?s=128&d=identicon&r=PG", "display_name": "ibaralf", "link": "https://stackoverflow.com/users/609043/ibaralf"}, "edited": false, "score": 0, "creation_date": 1449686676, "post_id": 34186345, "comment_id": 56119479, "body": "Do you have the right permission to write in the path that you have specified? It seems that you don&#39;t have the ownership of the folder."}, {"owner": {"reputation": 11294, "user_id": 609043, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/979a0b3e2f9d19f8e1acf34716221c59?s=128&d=identicon&r=PG", "display_name": "ibaralf", "link": "https://stackoverflow.com/users/609043/ibaralf"}, "edited": false, "score": 0, "creation_date": 1449690619, "post_id": 34186345, "comment_id": 56121702, "body": "Is this for shell? Or would this work on a windows CMD prompt? I am using windows at the moment (yeah, it&#39;s a nightmare), because of system requirements."}], "tags": [], "owner": {"reputation": 4457, "user_id": 4856698, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YF1b0zyYypU/AAAAAAAAAAI/AAAAAAAAAB0/6hdTAeg_61s/photo.jpg?sz=128", "display_name": "NickGnd", "link": "https://stackoverflow.com/users/4856698/nickgnd"}, "is_accepted": false, "score": 0, "last_activity_date": 1449685660, "creation_date": 1449685660, "answer_id": 34186345, "question_id": 34186024, "link": "https://stackoverflow.com/questions/34186024/rspec-results-appended-to-just-1-file/34186345#34186345", "title": "RSPEC results appended to just 1 file", "body": "<p>You could try also with:</p>\n\n<pre><code>$ bundle exec rspec basic1_spec.rb &gt;&gt; file.xml\n$ bundle exec rspec basic2_spec.rb &gt;&gt; file.xml\n</code></pre>\n"}], "owner": {"reputation": 11294, "user_id": 609043, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/979a0b3e2f9d19f8e1acf34716221c59?s=128&d=identicon&r=PG", "display_name": "ibaralf", "link": "https://stackoverflow.com/users/609043/ibaralf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 34186195, "answer_count": 2, "score": 1, "last_activity_date": 1449685660, "creation_date": 1449684747, "question_id": 34186024, "link": "https://stackoverflow.com/questions/34186024/rspec-results-appended-to-just-1-file", "title": "RSPEC results appended to just 1 file", "body": "<p>Whenever I run several Spec files, it overwrites the previous results file. How can I run several spec files with the results appended to just 1 file. I have the following configuration:</p>\n\n<pre><code>require 'etc'\nrequire 'yarjuf'\n\nRSpec.configure do |config|\n  config.color=true\n  config.add_formatter(:documentation)\n  config.add_formatter(JUnit,\"./results/rspec_results.xml\")\nend\n</code></pre>\n\n<p>And I just call the specfiles as:</p>\n\n<pre><code>$ bundle exec rspec basic1_spec.rb\n$ bundle exec rspec basic2_spec.rb\n</code></pre>\n\n<p>I need to have the results of both basic1 and basic2 in the same file 'rspec_results.xml'</p>\n\n<p><strong>NOTE: I don't want to do \"bundle exec rspec *spec.rb\"</strong> => since I run the spec files individually sometimes. Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1449684763, "post_id": 34185980, "comment_id": 56118283, "body": "Unrelated, but <code>@category</code> and <code>@product</code> are mis-named. And shouldn&#39;t be instance variables."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 2, "creation_date": 1449684801, "post_id": 34185980, "comment_id": 56118314, "body": "You&#39;re calling <code>id</code> on all the categories, <code>@category</code>. The list of categories does not have an id."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1449685008, "post_id": 34185980, "comment_id": 56118457, "body": "Also, the repetition of identical DOM besides the style name should be abstracted away."}, {"owner": {"reputation": 653, "user_id": 3153821, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/100002670873292/picture?type=large", "display_name": "Michal", "link": "https://stackoverflow.com/users/3153821/michal"}, "edited": false, "score": 0, "creation_date": 1449685030, "post_id": 34185980, "comment_id": 56118475, "body": "Use == instead of ===. === is used in case statements."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "reply_to_user": {"reputation": 653, "user_id": 3153821, "user_type": "registered", "accept_rate": 58, "profile_image": "https://graph.facebook.com/100002670873292/picture?type=large", "display_name": "Michal", "link": "https://stackoverflow.com/users/3153821/michal"}, "edited": false, "score": 0, "creation_date": 1449685080, "post_id": 34185980, "comment_id": 56118503, "body": "@Michal\tTrue(-ish), but not the issue."}, {"owner": {"reputation": 3, "user_id": 5635370, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/88090ae6d92e2def641d958f3299c06b?s=128&d=identicon&r=PG&f=1", "display_name": "Mistthrt", "link": "https://stackoverflow.com/users/5635370/mistthrt"}, "edited": false, "score": 0, "creation_date": 1449685424, "post_id": 34185980, "comment_id": 56118717, "body": "I have applied all the changes but the error didn&#39;t gone."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1449685579, "post_id": 34185980, "comment_id": 56118813, "body": "@Mistthrt\tUnhelpful. First of all, don&#39;t keep editing the question with changes you&#39;re making. Second, if the error didn&#39;t go away, you&#39;re still calling <code>id</code> on a relation (e.g., all the categories)."}, {"owner": {"reputation": 3, "user_id": 5635370, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/88090ae6d92e2def641d958f3299c06b?s=128&d=identicon&r=PG&f=1", "display_name": "Mistthrt", "link": "https://stackoverflow.com/users/5635370/mistthrt"}, "edited": false, "score": 0, "creation_date": 1449686707, "post_id": 34185980, "comment_id": 56119499, "body": "I&#39;m sorry, but what should I do to call <code>id</code> of category?"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1449686807, "post_id": 34185980, "comment_id": 56119558, "body": "@Mistthrt\tCall it on a category, not all of them. You see where you have <code>category.id</code>? <code>category</code> (the mis-named collection of all categories) is all the categories. It doesn&#39;t have an <code>id</code> method."}, {"owner": {"reputation": 8378, "user_id": 2076787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bfe965ab5ef94a0568bc61c36b46d4c?s=128&d=identicon&r=PG", "display_name": "D-side", "link": "https://stackoverflow.com/users/2076787/d-side"}, "edited": false, "score": 0, "creation_date": 1449687073, "post_id": 34185980, "comment_id": 56119737, "body": "The code actually makes much less sense with the following renames: <code>category</code> -&gt; <code>categories</code>; <code>category_c</code> -&gt; <code>category</code> and the error might even be spotted by the OP."}, {"owner": {"reputation": 3, "user_id": 5635370, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/88090ae6d92e2def641d958f3299c06b?s=128&d=identicon&r=PG&f=1", "display_name": "Mistthrt", "link": "https://stackoverflow.com/users/5635370/mistthrt"}, "edited": false, "score": 0, "creation_date": 1449687445, "post_id": 34185980, "comment_id": 56119958, "body": "Ahh, can&#39;t understand. May somebody give me a link of good tutorial for theme?"}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1449687922, "post_id": 34185980, "comment_id": 56120214, "body": "@Mistthrt\tYou have: <code>category = Category.all</code>. You later call <code>category.id</code>. But <code>category</code> is the result of <code>Category.all</code>. The complete list of categories doesn&#39;t have an id."}, {"owner": {"reputation": 3, "user_id": 5635370, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/88090ae6d92e2def641d958f3299c06b?s=128&d=identicon&r=PG&f=1", "display_name": "Mistthrt", "link": "https://stackoverflow.com/users/5635370/mistthrt"}, "edited": false, "score": 0, "creation_date": 1449688403, "post_id": 34185980, "comment_id": 56120476, "body": "Okay, so I renamed <code>category</code> to <code>categories</code>. But I don&#39;t know how should I call just an item from db, not the complete list."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 0, "creation_date": 1449688513, "post_id": 34185980, "comment_id": 56120531, "body": "Give it an ID or a name or something and search on it?"}, {"owner": {"reputation": 3, "user_id": 5635370, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/88090ae6d92e2def641d958f3299c06b?s=128&d=identicon&r=PG&f=1", "display_name": "Mistthrt", "link": "https://stackoverflow.com/users/5635370/mistthrt"}, "edited": false, "score": 0, "creation_date": 1449692318, "post_id": 34185980, "comment_id": 56122696, "body": "I know. But what should I use instead of .all method?"}], "answers": [{"tags": [], "owner": {"reputation": 84, "user_id": 3573300, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zLoEI.jpg?s=128&g=1", "display_name": "richessler", "link": "https://stackoverflow.com/users/3573300/richessler"}, "is_accepted": false, "score": 1, "last_activity_date": 1449701567, "creation_date": 1449701567, "answer_id": 34190538, "question_id": 34185980, "link": "https://stackoverflow.com/questions/34185980/cant-configure-my-if-else-statement/34190538#34190538", "title": "Can&#39;t configure my If...else statement", "body": "<p>So Your problem exists because you're calling <code>.id</code> on <code>category</code> which is a collection of all your <code>Category</code> models in your db because you assigned it as such here <code>&lt;% category = Category.all %&gt;</code>, no <code>id</code> would be associated with it.  </p>\n"}, {"tags": [], "owner": {"reputation": 26120, "user_id": 219883, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c35b5b0f9e7cce48864f4f1545ead995?s=128&d=identicon&r=PG", "display_name": "Taryn East", "link": "https://stackoverflow.com/users/219883/taryn-east"}, "is_accepted": true, "score": 0, "last_activity_date": 1449723019, "last_edit_date": 1449723019, "creation_date": 1449722306, "answer_id": 34193775, "question_id": 34185980, "link": "https://stackoverflow.com/questions/34185980/cant-configure-my-if-else-statement/34193775#34193775", "title": "Can&#39;t configure my If...else statement", "body": "<p>As mentioned - you are comparing a single id <code>category_c.id</code> to a set of categories - which doesn't work.</p>\n\n<p>Now, for starters... it is good to get in the habit of naming <em>sets of things</em> in the plural... this will make this sort of error stand out more clearly next time. In which case your code should be adjusted to:</p>\n\n<pre><code>&lt;% categories = Category.all %&gt;\n&lt;% products  = Product.all %&gt;\n\n&lt;% categories.each do |category_c| %&gt;\n  &lt;%# note, this line will still break at this stage %&gt;\n  &lt;% if category_c.id == product.category.id or category_c.id == categories.id then %&gt;\n    &lt;div class=\"current\"&gt;\n      &lt;%= link_to category_c.name, category_c %&gt;\n    &lt;/div&gt;\n  &lt;% else %&gt;\n    &lt;div class=\"category_link\"&gt;\n      &lt;%= link_to category_c.name, category_c %&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>You might notice that you were <em>also</em> using the variable <code>category</code> (which was a set of categories) when trying to <em>display a link to the current category</em> which is wrong because you should be displaying a <em>single</em> category.</p>\n\n<p>Naming the set of categories to be <code>categories</code> makes it more obvious when you are accidentally using a <em>set</em> when you mean a single one (and vice versa)... so stick to the habit.</p>\n\n<p>If there is just one, use singular (eg category/product) if there is a set, use plural (eg categories/products)</p>\n\n<hr>\n\n<p>Secondly - if what you want is to see if the product's category is in the set of categories... then you need to use a slightly different way of comparing:</p>\n\n<pre><code>if category_c.id == categories.id\n</code></pre>\n\n<p>breaks - because you are trying to call \"id\" on a set of categories... \nbut a set of categories doesn't have a single id... \nonly each category in the set has an id.</p>\n\n<p>Instead try first fetching out the set of ids of the categories... then deciding if this category is <em>included</em> in that set</p>\n\n<pre><code>if categories.map(&amp;:id).include?(category_c.id)\n</code></pre>\n\n<hr>\n\n<p>Thirdly... generally it's good to put the if/else only about the smallest part possible - only the part that changes depending on your conditions.</p>\n\n<p>If you look at your if/else -  the link to the category and the div are the same, regardless of whether your condition is true or false. The only part that is different is the css-class that you are using in the div... so just put the if/else around that part like this:</p>\n\n<pre><code>&lt;% categories = Category.all %&gt;\n&lt;% products  = Product.all %&gt;\n\n&lt;% categories.each do |category_c| %&gt;\n  &lt;div class=\"&lt;% if category_c.id == product.category.id or category_c.id == categories.id then %&gt;current&lt;% else %&gt;category_link&lt;% end %&gt;\"&gt;\n    &lt;%= link_to category_c.name, category_c %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Note: this has become a bit ugly... so lets put that condition into a variable and use that:</p>\n\n<pre><code>&lt;% categories = Category.all %&gt;\n&lt;% products  = Product.all %&gt;\n\n&lt;% categories.each do |category_c| %&gt;\n  &lt;% category_matches = category_c.id == product.category.id or category_c.id == categories.id %&gt;\n  &lt;div class=\"&lt;%= category_matches ? 'current' : 'category_link' %&gt;\"&gt;\n    &lt;%= link_to category_c.name, category_c %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<hr>\n\n<p>Fourthly.\nUnless you know what the difference is... <strong>always</strong> use <code>&amp;&amp;</code> and <code>||</code> instead of <code>and</code> and <code>or</code> - you can study the difference later if you like... but even ruby professionals will use <code>&amp;&amp;</code> and <code>||</code> instead of <code>and</code> and <code>or</code> - so until you know why to use the other ones... just follow the standard practice so:</p>\n\n<pre><code>&lt;% categories = Category.all %&gt;\n&lt;% products  = Product.all %&gt;\n\n&lt;% categories.each do |category_c| %&gt;\n  &lt;% category_matches = category_c.id == product.category.id || category_c.id == categories.id %&gt;\n  &lt;div class=\"&lt;%= category_matches ? 'current' : 'category_link' %&gt;\"&gt;\n    &lt;%= link_to category_c.name, category_c %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<hr>\n\n<p>Now - I don't think we need the <code>categories</code> variable really... it isn't used again anywhere else... so just get rid of it.</p>\n\n<pre><code>&lt;% products  = Product.all %&gt;\n\n&lt;% Category.all.each do |category_c| %&gt;\n  &lt;% category_matches = category_c.id == product.category.id || category_c.id == categories.id %&gt;\n  &lt;div class=\"&lt;%= category_matches ? 'current' : 'category_link' %&gt;\"&gt;\n    &lt;%= link_to category_c.name, category_c %&gt;\n  &lt;/div&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>So the final thing is.... you have a set of products... but you're comparing against the id of a single product... \nI don't know how you get from a set of products to a singe product here - you aren't iterating over the set... you will have to have a think to figure out how you want to find <em>which</em> product is relevant to this code. I leave that as an exercise for you.</p>\n"}], "owner": {"reputation": 3, "user_id": 5635370, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/88090ae6d92e2def641d958f3299c06b?s=128&d=identicon&r=PG&f=1", "display_name": "Mistthrt", "link": "https://stackoverflow.com/users/5635370/mistthrt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 34193775, "answer_count": 2, "score": -2, "last_activity_date": 1449723019, "creation_date": 1449684626, "last_edit_date": 1449690686, "question_id": 34185980, "link": "https://stackoverflow.com/questions/34185980/cant-configure-my-if-else-statement", "title": "Can&#39;t configure my If...else statement", "body": "<p>I want to make statement like \"if your product in belongs to category or you are in this category now, then category has different <code>&lt;div&gt;</code> tag\".</p>\n\n<p>I've tried some variants but I get this error:</p>\n\n<pre><code>&lt;undefined method 'id' for #&lt;Category::ActiveRecord_Relation:XXX&gt;\n</code></pre>\n\n<p>This is the code from my aplication.html.erb:</p>\n\n<pre><code>&lt;% category = Category.all %&gt;\n&lt;% product  = Product.all %&gt;\n\n&lt;% category.each do |category_c| %&gt;\n  &lt;% if category_c.id == product.category.id or category_c.id == category.id then %&gt;\n    &lt;div class=\"current\"&gt;\n      &lt;%= link_to category.name, category %&gt;\n    &lt;/div&gt;\n  &lt;% else %&gt;\n    &lt;div class=\"category_link\"&gt;\n      &lt;%= link_to category.name, category %&gt;\n    &lt;/div&gt;\n  &lt;% end %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>What should I do to make it work?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1449684686, "post_id": 34185831, "comment_id": 56118237, "body": "just a sidenote - <code>if !</code> is same as <code>unless</code>"}], "answers": [{"comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1449684589, "post_id": 34185856, "comment_id": 56118177, "body": "nice to know about <code>presence</code>, +1. I used to using <code>present?</code>"}, {"owner": {"reputation": 349, "user_id": 1594258, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/BShvi.jpg?s=128&g=1", "display_name": "Slenny", "link": "https://stackoverflow.com/users/1594258/slenny"}, "edited": false, "score": 0, "creation_date": 1449689468, "post_id": 34185856, "comment_id": 56121061, "body": "Thanks for the explanation on assignment too."}], "tags": [], "owner": {"reputation": 7844, "user_id": 1520557, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/9KKRA.png?s=128&g=1", "display_name": "Drenmi", "link": "https://stackoverflow.com/users/1520557/drenmi"}, "is_accepted": false, "score": 4, "last_activity_date": 1449684478, "last_edit_date": 1449684478, "creation_date": 1449684151, "answer_id": 34185856, "question_id": 34185831, "link": "https://stackoverflow.com/questions/34185831/idiomatic-way-of-assigning-parameter-or-default-value/34185856#34185856", "title": "Idiomatic way of assigning parameter or default value", "body": "<p>You can always do:</p>\n\n<pre><code>equity = params[:equity].presence || 0.00\n</code></pre>\n\n<p>The <a href=\"http://apidock.com/rails/Object/presence\" rel=\"nofollow\"><code>presence</code></a> method is part of ActiveSupport, and works like this:</p>\n\n<blockquote>\n  <p>Returns the receiver if it\u2019s present otherwise returns nil.</p>\n</blockquote>\n\n<p>The logical or (<code>||</code>) operator, when used in assignment, assigns the first value that is not falsey.</p>\n"}, {"tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": false, "score": 1, "last_activity_date": 1449684924, "creation_date": 1449684924, "answer_id": 34186082, "question_id": 34185831, "link": "https://stackoverflow.com/questions/34185831/idiomatic-way-of-assigning-parameter-or-default-value/34186082#34186082", "title": "Idiomatic way of assigning parameter or default value", "body": "<p>This is very common in Ruby:</p>\n\n<pre><code>equity = params[:equity] || 0.00\n</code></pre>\n\n<p>It will assign <code>0.00</code> to <code>equity</code> when <code>params[:equity]</code> is <code>nil</code> or <code>false</code>.</p>\n\n<p>If you want to assign <code>0.00</code> to <code>equity</code> only when <code>params[:equity]</code> is <code>nil</code> (not <code>false</code>), and you're using Rails, <code>presence</code> as mentioned by Drenmi is a good alternative.</p>\n"}, {"comments": [{"owner": {"reputation": 349, "user_id": 1594258, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/BShvi.jpg?s=128&g=1", "display_name": "Slenny", "link": "https://stackoverflow.com/users/1594258/slenny"}, "edited": false, "score": 0, "creation_date": 1449689423, "post_id": 34186256, "comment_id": 56121030, "body": "Thank you.  I can&#39;t believe I didn&#39;t try this before, I must&#39;ve had ||= plus I had a mess of code everywhere :\\  Interesting side effect of the to_f too."}], "tags": [], "owner": {"reputation": 7251, "user_id": 2493089, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c34c815a19c6a2f6ed200cbd95503682?s=128&d=identicon&r=PG", "display_name": "SHS", "link": "https://stackoverflow.com/users/2493089/shs"}, "is_accepted": true, "score": 2, "last_activity_date": 1449685425, "creation_date": 1449685425, "answer_id": 34186256, "question_id": 34185831, "link": "https://stackoverflow.com/questions/34185831/idiomatic-way-of-assigning-parameter-or-default-value/34186256#34186256", "title": "Idiomatic way of assigning parameter or default value", "body": "<p>You could use the short-circuit OR operator <code>||</code> like so:</p>\n\n<pre><code>value = param || 0.00 # where param is something like params[key]\n</code></pre>\n\n<p>If you want to ignore blank values (like empty strings), you can add the presence method, like so:</p>\n\n<pre><code>value = param.presence || 0.00\n</code></pre>\n\n<p>If the param value can be Numeric (Float / Integer), nil, or empty string, you can shorten the command like so:</p>\n\n<pre><code>value = param.to_f # will return 0.0 when param is nil or empty string\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 1, "last_activity_date": 1449691447, "last_edit_date": 1449691447, "creation_date": 1449690601, "answer_id": 34187733, "question_id": 34185831, "link": "https://stackoverflow.com/questions/34185831/idiomatic-way-of-assigning-parameter-or-default-value/34187733#34187733", "title": "Idiomatic way of assigning parameter or default value", "body": "<p>You can pass a default value to <a href=\"http://ruby-doc.org/core-2.2.3/Hash.html#method-i-fetch\" rel=\"nofollow\"><code>Hash#fetch</code></a>:</p>\n\n<pre><code>equity = params.fetch(:equity, 0.0) #=&gt; 0.0\n</code></pre>\n"}], "owner": {"reputation": 349, "user_id": 1594258, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/BShvi.jpg?s=128&g=1", "display_name": "Slenny", "link": "https://stackoverflow.com/users/1594258/slenny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 34186256, "answer_count": 4, "score": 1, "last_activity_date": 1449691447, "creation_date": 1449684076, "last_edit_date": 1449690772, "question_id": 34185831, "link": "https://stackoverflow.com/questions/34185831/idiomatic-way-of-assigning-parameter-or-default-value", "title": "Idiomatic way of assigning parameter or default value", "body": "<p>There has got to be a better way of assigning a default value if <code>params[:value]</code> is nil.  Now I'm doing this:</p>\n\n<pre><code>if !params[:equity].nil?\n   equity = params[:equity]\nelse\n   equity = 0.00\nend\n</code></pre>\n\n<p>Isn't there a way of doing something like this:</p>\n\n<pre><code>equity = params[:equity].nil? ? 0.00 : params[:equity]\n</code></pre>\n\n<p>I tried Hash methods like <code>replace</code>, <code>select</code>, or <code>merge</code>, but they don't really work as I need.</p>\n"}, {"tags": ["ruby", "jekyll", "liquid"], "comments": [{"owner": {"reputation": 46692, "user_id": 1548376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qCZQw.gif?s=128&g=1", "display_name": "David Jacquel", "link": "https://stackoverflow.com/users/1548376/david-jacquel"}, "edited": false, "score": 0, "creation_date": 1449684492, "post_id": 34185464, "comment_id": 56118116, "body": "Do you want to have <code>first post month year - last post month year</code>? Not very clear."}, {"owner": {"reputation": 97, "user_id": 2137232, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/cUfQi.jpg?s=128&g=1", "display_name": "User1911", "link": "https://stackoverflow.com/users/2137232/user1911"}, "reply_to_user": {"reputation": 46692, "user_id": 1548376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qCZQw.gif?s=128&g=1", "display_name": "David Jacquel", "link": "https://stackoverflow.com/users/1548376/david-jacquel"}, "edited": false, "score": 0, "creation_date": 1449684592, "post_id": 34185464, "comment_id": 56118179, "body": "Basically I want to add my prof. experience so I want to add custom year duration , like on the example mentioned ! Is that possible?"}, {"owner": {"reputation": 46692, "user_id": 1548376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qCZQw.gif?s=128&g=1", "display_name": "David Jacquel", "link": "https://stackoverflow.com/users/1548376/david-jacquel"}, "edited": false, "score": 0, "creation_date": 1449687610, "post_id": 34185464, "comment_id": 56120038, "body": "Can you add an example post ?"}, {"owner": {"reputation": 97, "user_id": 2137232, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/cUfQi.jpg?s=128&g=1", "display_name": "User1911", "link": "https://stackoverflow.com/users/2137232/user1911"}, "reply_to_user": {"reputation": 46692, "user_id": 1548376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qCZQw.gif?s=128&g=1", "display_name": "David Jacquel", "link": "https://stackoverflow.com/users/1548376/david-jacquel"}, "edited": false, "score": 0, "creation_date": 1449695430, "post_id": 34185464, "comment_id": 56124359, "body": "@DavidJacquel I added one ! check it, hope it helps"}, {"owner": {"reputation": 97, "user_id": 2137232, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/cUfQi.jpg?s=128&g=1", "display_name": "User1911", "link": "https://stackoverflow.com/users/2137232/user1911"}, "reply_to_user": {"reputation": 46692, "user_id": 1548376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qCZQw.gif?s=128&g=1", "display_name": "David Jacquel", "link": "https://stackoverflow.com/users/1548376/david-jacquel"}, "edited": false, "score": 0, "creation_date": 1449704238, "post_id": 34185464, "comment_id": 56128537, "body": "I now found out that  Jekyll requires posts to be named year-month-day-title.md What i want is : year-month-day-year-month-day-title.md !! I think it&#39;s not possible right?"}, {"owner": {"reputation": 46692, "user_id": 1548376, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qCZQw.gif?s=128&g=1", "display_name": "David Jacquel", "link": "https://stackoverflow.com/users/1548376/david-jacquel"}, "edited": false, "score": 1, "creation_date": 1449736048, "post_id": 34185464, "comment_id": 56139368, "body": "It&#39;s not possible to change post file name pattern. But you can change the permalink. Can you show one post file code, in order to see how is your front matter."}, {"owner": {"reputation": 2916, "user_id": 1745432, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/de8eed2933662cd85e6a5eee3eb9f2fa?s=128&d=identicon&r=PG", "display_name": "Kpym", "link": "https://stackoverflow.com/users/1745432/kpym"}, "edited": false, "score": 2, "creation_date": 1449737146, "post_id": 34185464, "comment_id": 56139963, "body": "@User1911 you don&#39;t need to put the end date in the file name, you can put in the yaml front matter of your posts &quot;end date: YYYY-MM-DD&quot;."}, {"owner": {"reputation": 97, "user_id": 2137232, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/cUfQi.jpg?s=128&g=1", "display_name": "User1911", "link": "https://stackoverflow.com/users/2137232/user1911"}, "reply_to_user": {"reputation": 2916, "user_id": 1745432, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/de8eed2933662cd85e6a5eee3eb9f2fa?s=128&d=identicon&r=PG", "display_name": "Kpym", "link": "https://stackoverflow.com/users/1745432/kpym"}, "edited": false, "score": 0, "creation_date": 1449738214, "post_id": 34185464, "comment_id": 56140623, "body": "@Kpym Can you post me an example please ?"}, {"owner": {"reputation": 97, "user_id": 2137232, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/cUfQi.jpg?s=128&g=1", "display_name": "User1911", "link": "https://stackoverflow.com/users/2137232/user1911"}, "reply_to_user": {"reputation": 2916, "user_id": 1745432, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/de8eed2933662cd85e6a5eee3eb9f2fa?s=128&d=identicon&r=PG", "display_name": "Kpym", "link": "https://stackoverflow.com/users/1745432/kpym"}, "edited": false, "score": 0, "creation_date": 1449742259, "post_id": 34185464, "comment_id": 56143172, "body": "@Kpym @DavidJacquel <code>--- layout: post title: &quot;Sample title&quot; excerpt: &quot;Internship at . . . . &quot; tags: [sample post, code, highlighting] end date: 2015-02-13 share: true ---</code> something like that??"}, {"owner": {"reputation": 2916, "user_id": 1745432, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/de8eed2933662cd85e6a5eee3eb9f2fa?s=128&d=identicon&r=PG", "display_name": "Kpym", "link": "https://stackoverflow.com/users/1745432/kpym"}, "edited": false, "score": 2, "creation_date": 1449744915, "post_id": 34185464, "comment_id": 56144935, "body": "@User1911 Yes, something like that. But probably with underscore in place of space <code>end_date</code> is better. Then you can access it with <code>{{post.end_date}}</code>."}, {"owner": {"reputation": 97, "user_id": 2137232, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/cUfQi.jpg?s=128&g=1", "display_name": "User1911", "link": "https://stackoverflow.com/users/2137232/user1911"}, "edited": false, "score": 0, "creation_date": 1449745464, "post_id": 34185464, "comment_id": 56145282, "body": "DAAAAAAAAAAAAAAMN :D YES!! That&#39;s it :-) Thank you soooooo much place it as an answer so I can vote it !"}], "owner": {"reputation": 97, "user_id": 2137232, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/cUfQi.jpg?s=128&g=1", "display_name": "User1911", "link": "https://stackoverflow.com/users/2137232/user1911"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1449695401, "creation_date": 1449682959, "last_edit_date": 1449695401, "question_id": 34185464, "link": "https://stackoverflow.com/questions/34185464/read-posts-based-on-duration-jekyll", "title": "Read posts based on duration Jekyll", "body": "<p>I am trying to archive some posts using - <em>Jekyll and Liquid</em> - based on the Month and Year Duration . My purpose is like this :</p>\n\n<pre><code>&lt;h3&gt; {{ month. year }} - {{month. next_year}} &lt;/h3&gt;\n</code></pre>\n\n<p>...where the output will be like this:</p>\n\n<blockquote>\n  <p>Oct. 2014 - Jan. 2015</p>\n</blockquote>\n\n<p>I am new into jekyll/liquid and I don't understand much, tried the following code but it doesn't work:</p>\n\n<pre><code>{% capture written_year %}'None'{% endcapture %}\n\n{% capture written_next_year %}'None'{% endcapture %}\n\n{% for post in site.posts %}  \n  {% capture year %}{{ post.date | date: '%b.%Y' }}{% endcapture %}\n\n  {% capture next_year %}{{ post.next.date | date: '%b.%Y' }}{% endcapture %}\n\n  {% if year != written_year %}\n\n    &lt;h3&gt; {{ year }} - {{next_year}} &lt;/h3&gt;\n    {% capture written_year %}{{ year }}{% endcapture %}\n\n    {% capture written_next_year %}'None'{% endcapture %}\n  {% endif %}\n</code></pre>\n\n<p><em>Example Post:</em></p>\n\n<blockquote>\n  <p><a href=\"http://prntscr.com/9cajee\" rel=\"nofollow\">http://prntscr.com/9cajee</a> [Positions held is a &lt; header > , IT User bla bla .. is the post title ]</p>\n</blockquote>\n\n<p>Any tips/ documentation to read are welcome!</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["ruby", "ibm-cloud-infrastructure"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1449683502, "post_id": 34185043, "comment_id": 56117504, "body": "What version of Ruby are you using? We haven&#39;t had to use <code>require &#39;rubygems&#39;</code> since Ruby 1.9. Also, don&#39;t catch generic <code>Exception</code>, catch specific Exceptions. There are lots of pages out there about why but this is a good start: <a href=\"http://stackoverflow.com/q/10048173/128421\">stackoverflow.com/q/10048173/128421</a>"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 5660396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4dd907f8d2df4bc71d0579884901369d?s=128&d=identicon&r=PG&f=1", "display_name": "haunm", "link": "https://stackoverflow.com/users/5660396/haunm"}, "edited": false, "score": 0, "creation_date": 1449691591, "post_id": 34187225, "comment_id": 56122257, "body": "mcruz, do you know why I get multiple invoices per day when I run this?  I got a lot more results than I expected.  Thank you."}, {"owner": {"reputation": 1536, "user_id": 5094381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67e8c1f673b4f8767f765f9253b566da?s=128&d=identicon&r=PG&f=1", "display_name": "mcruz", "link": "https://stackoverflow.com/users/5094381/mcruz"}, "reply_to_user": {"reputation": 39, "user_id": 5660396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4dd907f8d2df4bc71d0579884901369d?s=128&d=identicon&r=PG&f=1", "display_name": "haunm", "link": "https://stackoverflow.com/users/5660396/haunm"}, "edited": false, "score": 0, "creation_date": 1449693180, "post_id": 34187225, "comment_id": 56123187, "body": "The amount of items should not be affected when using the filters. I executed some tests using a short range and it is working well. I suggest you to reduce the range of date in order to see if the amount of items being affected. for example my range of dates are: startDate = &#39;02/04/2014 0:0:0&#39; and the endDate = &#39;02/04/2014 23:59:59&#39; (1 day) and verify if are the same values using this script and using only &quot;getInvoices&quot; without filters.  Regards."}, {"owner": {"reputation": 39, "user_id": 5660396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4dd907f8d2df4bc71d0579884901369d?s=128&d=identicon&r=PG&f=1", "display_name": "haunm", "link": "https://stackoverflow.com/users/5660396/haunm"}, "edited": false, "score": 0, "creation_date": 1449700694, "post_id": 34187225, "comment_id": 56127081, "body": "Thank you again.  However, I may have been too vague in my question.  I made the call with the filter you showed but I&#39;m getting multiple invoices per day.  Either with a typeCode of &quot;NEW&quot; or &quot;ONE-TIME-CHARGE&quot;.  I&#39;m not sure I understand why I&#39;m seeing all of these.  Is there some place this is document with more detail?  Honestly, I was just expecting one invoice per month.  Thank you again!"}, {"owner": {"reputation": 1536, "user_id": 5094381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67e8c1f673b4f8767f765f9253b566da?s=128&d=identicon&r=PG&f=1", "display_name": "mcruz", "link": "https://stackoverflow.com/users/5094381/mcruz"}, "reply_to_user": {"reputation": 39, "user_id": 5660396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4dd907f8d2df4bc71d0579884901369d?s=128&d=identicon&r=PG&f=1", "display_name": "haunm", "link": "https://stackoverflow.com/users/5660396/haunm"}, "edited": false, "score": 0, "creation_date": 1449770801, "post_id": 34187225, "comment_id": 56161913, "body": "I was reviewing some filters via portal; I can see some cases that the filter retrieves more than one item in a range of 1 month.  The case that the filter retrieves 1 item per month is when we select typeCode =\u201crecurring\u201d. Is this item with  typeCode =\u201crecurring\u201d that you want to get?"}, {"owner": {"reputation": 1536, "user_id": 5094381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67e8c1f673b4f8767f765f9253b566da?s=128&d=identicon&r=PG&f=1", "display_name": "mcruz", "link": "https://stackoverflow.com/users/5094381/mcruz"}, "reply_to_user": {"reputation": 39, "user_id": 5660396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4dd907f8d2df4bc71d0579884901369d?s=128&d=identicon&r=PG&f=1", "display_name": "haunm", "link": "https://stackoverflow.com/users/5660396/haunm"}, "edited": false, "score": 0, "creation_date": 1449781668, "post_id": 34187225, "comment_id": 56167721, "body": "@haunm, I added other filter criteria in the previous filter (typeCode = &quot;RECURRING&quot;):"}], "tags": [], "owner": {"reputation": 1536, "user_id": 5094381, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/67e8c1f673b4f8767f765f9253b566da?s=128&d=identicon&r=PG&f=1", "display_name": "mcruz", "link": "https://stackoverflow.com/users/5094381/mcruz"}, "is_accepted": true, "score": 0, "last_activity_date": 1449781853, "last_edit_date": 1449781853, "creation_date": 1449688792, "answer_id": 34187225, "question_id": 34185043, "link": "https://stackoverflow.com/questions/34185043/using-object-filters-with-softlayer-ruby-api/34187225#34187225", "title": "Using object filters with SoftLayer Ruby API", "body": "<p>Try this ruby example to filter items using Dates:</p>\n\n<pre><code>require 'rubygems'\nrequire 'softlayer_api'\n\n# Your SoftLayer API username.\nSL_API_USERNAME = 'set me'\n\n# Your SoftLayer API key.\nSL_API_KEY = 'set me'\n\naccount_service = SoftLayer::Service.new('SoftLayer_Account',\n                                         :username =&gt; SL_API_USERNAME,\n                                         :api_key =&gt; SL_API_KEY)\n\nbegin\n  object_filter = SoftLayer::ObjectFilter.new\n  object_filter.set_criteria_for_key_path('invoices.createDate',\n        'operation' =&gt; 'betweenDate',\n        'options' =&gt; [{\n                        'name' =&gt; 'startDate',\n                        'value' =&gt; [\"02/01/2014 0:0:0\"]\n                      },\n                      {\n                        'name' =&gt; 'endDate',\n                        'value' =&gt; [\"02/13/2014 0:0:0\"]\n                      }\n                      ]\n                      )\n\n  result = account_service.object_filter(object_filter).getInvoices\n  puts result.inspect\nrescue =&gt; e\n  $stdout.print(e.inspect)\nend\n</code></pre>\n\n<p><strong>Some references:</strong></p>\n\n<pre><code>https://github.com/softlayer/softlayer-ruby/blob/master/lib/softlayer/ObjectFilter.rb\nhttps://www.omniref.com/ruby/gems/softlayer_api/3.0.b1/symbols/SoftLayer::ObjectFilter/set_criteria_for_key_path\nhttps://coveralls.io/files/239537934\nhttp://www.rubydoc.info/github/softlayer/softlayer-api-ruby-client/SoftLayer%2FObjectFilter%3Aset_criteria_for_key_path\nhttps://github.com/softlayer/softlayer-ruby/issues/77\n</code></pre>\n\n<p>If you are still using the old filter, you can try the below example (But I recommend to update the Softlayer ruby client and ruby versions):</p>\n\n<pre><code>require 'rubygems'\nrequire 'softlayer_api'\n\n$SL_API_USERNAME = 'set me';       \n$SL_API_KEY = 'set me'\n\naccount_service = SoftLayer::Service.new('SoftLayer_Account',\n                                         :username =&gt; $SL_API_USERNAME,\n                                         :api_key =&gt; $SL_API_KEY)\n\nbegin\n  filter_instance =  {\n      'invoices'=&gt; {\n          'createDate'=&gt; {\n              'operation'=&gt; 'betweenDate',\n              'options'=&gt; [\n                  {\n                      'name'=&gt; 'startDate',\n                      'value'=&gt; [\n                          '02/01/2014 0:0:0'\n                      ]\n                  },\n                  {\n                      'name'=&gt; 'endDate',\n                      'value'=&gt; [\n                          '02/13/2014 0:0:0'\n                      ]\n                  }\n              ]\n          }\n      }\n  }\n  result = account_service.object_filter(filter_instance).getInvoices\n  puts result.inspect\nrescue =&gt; e\n  $stdout.print(e.inspect)\nend\n</code></pre>\n\n<p>I you want to use more filters criteria in your current filter, here is an example:</p>\n\n<pre><code>filter_instance =  {\n      'invoices'=&gt; {\n          'createDate'=&gt; {\n              'operation'=&gt; 'betweenDate',\n              'options'=&gt; [\n                  {\n                      'name'=&gt; 'startDate',\n                      'value'=&gt; [\n                          '11/01/2015 0:0:0'\n                      ]\n                  },\n                  {\n                      'name'=&gt; 'endDate',\n                      'value'=&gt; [\n                          '11/30/2015 23:59:59'\n                      ]\n                  }\n              ]\n          },\n\n          'typeCode'=&gt; {\n              'operation'=&gt; 'RECURRING'\n          }\n      }\n  }\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 5660396, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4dd907f8d2df4bc71d0579884901369d?s=128&d=identicon&r=PG&f=1", "display_name": "haunm", "link": "https://stackoverflow.com/users/5660396/haunm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 371, "favorite_count": 0, "accepted_answer_id": 34187225, "answer_count": 1, "score": 0, "last_activity_date": 1449781853, "creation_date": 1449681607, "last_edit_date": 1449682813, "question_id": 34185043, "link": "https://stackoverflow.com/questions/34185043/using-object-filters-with-softlayer-ruby-api", "title": "Using object filters with SoftLayer Ruby API", "body": "<p>When I try to run the following program, the object filter doesn't seem to work. I still get invoices which don't meet the filter criteria. Can someone help me understand what I am doing wrong? Unfortunately there is practically no documentation I could find on using object filters in Ruby</p>\n\n<p>Thanks in advance</p>\n\n<pre><code>require 'rubygems'\nrequire 'softlayer_api'\nrequire 'pp'\n\nbegin\n  date = DateTime.new(2015,11,1)\n  account_service = SoftLayer::Service.new(\"SoftLayer_Account\",:username =&gt; \"USER\", :api_key =&gt; \"KEY\", :timeout =&gt; 999)\n  latest_invoices = account_service.result_limit(0,10).object_mask(\"mask[id]\").getInvoices(filter={'invoices'=&gt; {'createDate'=&gt; {'&gt;='=&gt; date}}})\n  pp latest_invoices\n\nrescue Exception =&gt; exception\n  puts \"Unable to retrieve the invoice #{exception}\"\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "arrays", "ruby"], "comments": [{"owner": {"reputation": 5958, "user_id": 1789479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/WlgWK.jpg?s=128&g=1", "display_name": "Hieu Pham", "link": "https://stackoverflow.com/users/1789479/hieu-pham"}, "edited": false, "score": 0, "creation_date": 1449682036, "post_id": 34184996, "comment_id": 56116582, "body": "sorry i don&#39;t really understand your mean, could you gimme the expected result here?"}, {"owner": {"reputation": 283, "user_id": 1745832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ba14bc2f99682187ea50d885e853ff2d?s=128&d=identicon&r=PG", "display_name": "massaskillz", "link": "https://stackoverflow.com/users/1745832/massaskillz"}, "reply_to_user": {"reputation": 5958, "user_id": 1789479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/WlgWK.jpg?s=128&g=1", "display_name": "Hieu Pham", "link": "https://stackoverflow.com/users/1789479/hieu-pham"}, "edited": false, "score": 0, "creation_date": 1449682138, "post_id": 34184996, "comment_id": 56116646, "body": "The expected result is 60."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1449682759, "post_id": 34184996, "comment_id": 56117029, "body": "@massaskillz you might want to explain, <i>why</i> 60 is the better fit. I don&#39;t think it&#39;s obvious."}, {"owner": {"reputation": 283, "user_id": 1745832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ba14bc2f99682187ea50d885e853ff2d?s=128&d=identicon&r=PG", "display_name": "massaskillz", "link": "https://stackoverflow.com/users/1745832/massaskillz"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1449683686, "post_id": 34184996, "comment_id": 56117631, "body": "@Stefan, thanks for the suggestion. I edited the question."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1449691339, "post_id": 34184996, "comment_id": 56122129, "body": "Seems like you could just use <code>sizes.min_by { |size| size % fit_this }</code>"}, {"owner": {"reputation": 283, "user_id": 1745832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ba14bc2f99682187ea50d885e853ff2d?s=128&d=identicon&r=PG", "display_name": "massaskillz", "link": "https://stackoverflow.com/users/1745832/massaskillz"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1449692929, "post_id": 34184996, "comment_id": 56123056, "body": "@Stefan ah yes, this one is much cleaner. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 3, "last_activity_date": 1449682308, "creation_date": 1449682308, "answer_id": 34185248, "question_id": 34184996, "link": "https://stackoverflow.com/questions/34184996/how-to-get-the-minimum-value-of-an-array-based-on-comparing-more-than-one-block/34185248#34185248", "title": "How to get the minimum value of an array, based on comparing more than one block using min_by?", "body": "<p>Let's examine the intermediate arrays by replacing <code>min_by</code> with <code>map</code>:</p>\n\n<pre><code>sizes.map { |size| (size - fit_this).abs }\n#=&gt; [5, 10, 15, 20, 25, 30]\n\nsizes.map { |size| (size - fit_this*2).abs }\n#=&gt; [25, 20, 15, 10, 5, 0]\n</code></pre>\n\n<p>We can combine both calculations by returning element-wise arrays:</p>\n\n<pre><code>sizes.map { |size| [(size - fit_this).abs, (size - fit_this*2).abs] }\n#=&gt; [[5, 25], [10, 20], [15, 15], [20, 10], [25, 5], [30, 0]]\n</code></pre>\n\n<p>And use <code>min</code> to fetch the smaller number of each pair:</p>\n\n<pre><code>sizes.map { |size| [(size - fit_this).abs, (size - fit_this*2).abs].min }\n#=&gt; [5, 10, 15, 10, 5, 0]\n</code></pre>\n\n<p>Applied to <code>min_by</code>:</p>\n\n<pre><code>sizes.min_by { |size| [(size - fit_this).abs, (size - fit_this*2).abs].min }\n#=&gt; 60\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5958, "user_id": 1789479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/WlgWK.jpg?s=128&g=1", "display_name": "Hieu Pham", "link": "https://stackoverflow.com/users/1789479/hieu-pham"}, "is_accepted": false, "score": 0, "last_activity_date": 1449690981, "last_edit_date": 1449690981, "creation_date": 1449682962, "answer_id": 34185466, "question_id": 34184996, "link": "https://stackoverflow.com/questions/34184996/how-to-get-the-minimum-value-of-an-array-based-on-comparing-more-than-one-block/34185466#34185466", "title": "How to get the minimum value of an array, based on comparing more than one block using min_by?", "body": "<p>Yes, we can do that. </p>\n\n<p>The basic idea is we want to try for two cases for all sizes and choose what is the best fit:</p>\n\n<pre><code>sizes.min_by { |size| [(size - fit_this).abs, (size - fit_this * 2).abs].min }\n</code></pre>\n"}], "owner": {"reputation": 283, "user_id": 1745832, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/ba14bc2f99682187ea50d885e853ff2d?s=128&d=identicon&r=PG", "display_name": "massaskillz", "link": "https://stackoverflow.com/users/1745832/massaskillz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 207, "favorite_count": 0, "accepted_answer_id": 34185248, "answer_count": 2, "score": 0, "last_activity_date": 1449690981, "creation_date": 1449681473, "last_edit_date": 1449690872, "question_id": 34184996, "link": "https://stackoverflow.com/questions/34184996/how-to-get-the-minimum-value-of-an-array-based-on-comparing-more-than-one-block", "title": "How to get the minimum value of an array, based on comparing more than one block using min_by?", "body": "<p>Given this example array of numbers:</p>\n\n<pre><code>sizes = [35, 40, 45, 50, 55, 60]\n</code></pre>\n\n<p>And this required size to fit:</p>\n\n<pre><code>fit_this = 30\n</code></pre>\n\n<p>I want to find the minimum size based on these given blocks:</p>\n\n<pre><code>sizes.min_by { |size| (size - fit_this).abs }   #=&gt; 35\nsizes.min_by { |size| (size - fit_this*2).abs } #=&gt; 60\n</code></pre>\n\n<p>The sizes are widths, and I'm trying to put as many <code>fit_this</code> items into the width with the least amount of wasted space, so the <code>fit_this</code> number can be doubled up if it's a better fit.</p>\n\n<p>Is it possible to do this with <code>min_by</code>? If not, what's the best way to do it in Ruby?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "answers": [{"comments": [{"owner": {"reputation": 2353, "user_id": 4765497, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0217f81111ddda08859b0d6cca6de0b9?s=128&d=identicon&r=PG&f=1", "display_name": "Amr Noman", "link": "https://stackoverflow.com/users/4765497/amr-noman"}, "edited": false, "score": 0, "creation_date": 1449681226, "post_id": 34184738, "comment_id": 56116003, "body": "Why go to <code>user_profiles#new</code> in the first route? I think that in both cases he wants to edit (just different information), so shouldn&#39;t it be something like <code>user_profiles#edit_credentials</code> instead ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user44484"}, "reply_to_user": {"reputation": 2353, "user_id": 4765497, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0217f81111ddda08859b0d6cca6de0b9?s=128&d=identicon&r=PG&f=1", "display_name": "Amr Noman", "link": "https://stackoverflow.com/users/4765497/amr-noman"}, "edited": false, "score": 0, "creation_date": 1449681259, "post_id": 34184738, "comment_id": 56116022, "body": "It was a typo @AmrNoman. Thanks for pointing that out. I&#39;ve edited it to <code>show</code> as I originally intended."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user44484"}, "is_accepted": false, "score": 1, "last_activity_date": 1449691050, "last_edit_date": 1449691050, "creation_date": 1449680756, "answer_id": 34184738, "question_id": 34184233, "link": "https://stackoverflow.com/questions/34184233/ruby-on-rails-devise-split-user-edit-page-into-2-pages/34184738#34184738", "title": "Ruby on Rails / Devise - Split user edit page into 2 pages", "body": "<p>As you suggested, one method would be to create a new controller, route, and view to handle this. </p>\n\n<p>I might create a <code>UserProfilesController</code> controller with two actions: <code>UserProfilesController#show</code> and <code>UserProfilesController#edit</code>.</p>\n\n<p>Then as you suggested, a route, e.g., </p>\n\n<pre><code>get 'user_profiles/:id' =&gt; 'user_profiles#show'\nget 'user_profiles/:id/edit' =&gt; 'user_profiles#edit'\n</code></pre>\n\n<p>In Devise parlance, the <code>resource</code> refers to the user. So the <code>:id</code> being passed above must be a <code>User</code> id of course. If you don't want to do that, you could always just assume you meant the <code>current_user</code> in which case you can skip using <code>:id</code> in the routes and just retrieve it in the controllers via <code>current_user.id</code>.</p>\n\n<p>Finally, you just have to split out the profile details from the Devise view and create some under <code>app/views/user_profiles/new.html.erb</code> and similarly for <code>edit.html.erb</code>. Remember to remove the profile bits from the Devise view and I think you're on your way.</p>\n\n<p><strong>An Addendum</strong></p>\n\n<p>@AmrNoman made a good suggestion re: the update method. If you are following with my solution, you would add another action <code>UserProfilesController#update</code>, and a new route in your <code>routes.rb</code> file:</p>\n\n<pre><code>put 'user_profiles/:id/update' =&gt; 'user_profiles#update'\n</code></pre>\n\n<p>Additionally, if you intend to later refactor <code>User</code> to remove the profile details and handle them in a separate model, it may be prudent to replace my references to <code>:id</code> in the above code to <code>:user_id</code>. In this way, if you at some point create, e.g., a model called <code>UserProfile</code> it will be clearer that the <code>:id</code> is not the <code>UserProfile#id</code> but the <code>UserProfile#user_id</code> foreign key. This will leave you the ability to use <code>:id</code> to refer to <code>UserProfile.id</code> directly without affecting any API consumer in your app.</p>\n\n<p>It may be a bit overkill but I think it's good practice.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user44484"}, "edited": false, "score": 0, "creation_date": 1449690431, "post_id": 34185560, "comment_id": 56121589, "body": "ah and you also though to include the put/update method which I did not. I&#39;ll have to amend my answer later. Good thinking."}], "tags": [], "owner": {"reputation": 2353, "user_id": 4765497, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0217f81111ddda08859b0d6cca6de0b9?s=128&d=identicon&r=PG&f=1", "display_name": "Amr Noman", "link": "https://stackoverflow.com/users/4765497/amr-noman"}, "is_accepted": false, "score": 0, "last_activity_date": 1449683276, "creation_date": 1449683276, "answer_id": 34185560, "question_id": 34184233, "link": "https://stackoverflow.com/questions/34184233/ruby-on-rails-devise-split-user-edit-page-into-2-pages/34185560#34185560", "title": "Ruby on Rails / Devise - Split user edit page into 2 pages", "body": "<p>Chris Cameron's answer is right, but I think this is closer to what you want:</p>\n\n<p>First create your routes in <strong>routes.rb</strong>:</p>\n\n<pre><code>  # this gets the edit page for login details\n  get \"settings\" =&gt; \"user_profiles#edit_credentials\", as: \"edit_credentials\"\n\n  # this gets the edit page for other profile info\n  get \"settings/edit\" =&gt; \"user_profiles#edit_profile\", as: \"edit_profile\"\n\n  # update method shared by both forms \n  # (you can create another one to handle both forms separately if you want)\n  put \"settings\" =&gt; \"user_profiles#update\"\n</code></pre>\n\n<p>Then your controller <strong>user_profiles_controller.rb</strong>:</p>\n\n<pre><code>class UserProfilesController &lt; ApplicationController\n  # fill the methods as you need, you can always get the user using current_user\n\n  def edit_credentials\n  end\n\n  def edit_profile\n  end\n\n  def update\n  end\nend\n</code></pre>\n\n<p>and finally your views, first <strong>views/user_profiles/edit_credentials.erb.html</strong>, here you show form for login details:</p>\n\n<pre><code>&lt;%= form_for(current_user, url: settings_path) do |f| %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>then same thing in <strong>views/user_profiles/edit_profile.erb.html</strong>, just change your form contents:</p>\n\n<pre><code>&lt;%= form_for(current_user, url: settings_path) do |f| %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>There might be some errors, but hopefully this gets you in the right direction (also make sure to handle authentication and authorization).</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user44484"}, "edited": false, "score": 0, "creation_date": 1449690626, "post_id": 34186152, "comment_id": 56121703, "body": "I agree - the separate controller isn&#39;t necessary. However there are two reasons I chose that path. The first is it matches the OP&#39;s thinking in a way, and when possible I try to provide an answer that isn&#39;t too out-of-band from the OP&#39;s intuition (unless of course doing so would be harmful). Second, I find the coupling of the controller to the data model to be an enduring and strange Rails-ism. By creating a separate user profile controller and a separate route, future changes to the model will have no impact on the API of this app. e.g. if the profile is factored out of User model"}, {"owner": {"reputation": 767, "user_id": 714808, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40cbc00e62bd52ec2b57439ddabe060c?s=128&d=identicon&r=PG", "display_name": "sicks", "link": "https://stackoverflow.com/users/714808/sicks"}, "edited": false, "score": 0, "creation_date": 1449691088, "post_id": 34186152, "comment_id": 56121969, "body": "I also came from PHP when I first started learning Rails, and in hindsight I feel the mindset I came in with was mostly wrong. I fell in love with Rails because of how frequently I said to myself &quot;oh wow, I didn&#39;t actually need to do ANY of all that&quot; after learning more about the conventions. While I&#39;d normally try to stick with the OP&#39;s intuition on how they&#39;re looking to implement something, I feel like this is an opportunity for the OP to enjoy some of the comforts of convention over configuration, and not do the needless."}, {"owner": {"reputation": 767, "user_id": 714808, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40cbc00e62bd52ec2b57439ddabe060c?s=128&d=identicon&r=PG", "display_name": "sicks", "link": "https://stackoverflow.com/users/714808/sicks"}, "edited": false, "score": 0, "creation_date": 1449691278, "post_id": 34186152, "comment_id": 56122097, "body": "Also, I&#39;m not sure what you mean in regards to the coupling of controller data to the model? I&#39;m not touching the model at all here, once any new attributes are white listed in the controller all we&#39;re doing is pointing an extra route to an extra view."}, {"owner": {"user_type": "does_not_exist", "display_name": "user44484"}, "edited": false, "score": 0, "creation_date": 1449691321, "post_id": 34186152, "comment_id": 56122116, "body": "Oh absolutely CoC is a great burden lifter, especially if OP has no reason to care about API consumers at all, or if refactoring their app will have no impact on anyone but themselves."}, {"owner": {"user_type": "does_not_exist", "display_name": "user44484"}, "edited": false, "score": 0, "creation_date": 1449691487, "post_id": 34186152, "comment_id": 56122199, "body": "So in Rails&#39; CoC you often have e.g.,  resource model like User, and then a set of views associated to it, and a UserController. And due to the Rails conventions a lot of things automatically work, e.g., parameters sent into the UserController will be enveloped in a JSON struct named <code>&quot;user&quot;</code>. And then also Strong params can make use of that to prevent mass assignment, etc. There&#39;s a lot of good there. (cont&#39;d)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user44484"}, "edited": false, "score": 0, "creation_date": 1449691610, "post_id": 34186152, "comment_id": 56122263, "body": "But it also then expects a <code>Users</code> table, and that the whole stack of things lines up perfectly. But things get more difficult if you come from languages where Data Access Objects (DAO) are more prevalent. Or if you want to load two tables into a single model for instance. Or two models into a combined Model which then gets a single view and controller.  Rails&#39; prescriptive way of handling things is great - no question about it. But the flexibility is lost if you enjoy other paradigms which don&#39;t believe in coupling everything from the API to the database."}, {"owner": {"user_type": "does_not_exist", "display_name": "user44484"}, "edited": false, "score": 0, "creation_date": 1449691687, "post_id": 34186152, "comment_id": 56122314, "body": "Ah your comment has changed. Re: the model I wasn&#39;t referring to your solution touching the model. I&#39;ve updated my answer to explain the coupling thing."}, {"owner": {"reputation": 767, "user_id": 714808, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40cbc00e62bd52ec2b57439ddabe060c?s=128&d=identicon&r=PG", "display_name": "sicks", "link": "https://stackoverflow.com/users/714808/sicks"}, "edited": false, "score": 0, "creation_date": 1449691752, "post_id": 34186152, "comment_id": 56122353, "body": "Well, it sounds like the OP was just looking to make it so a User can manage their password and account status on one page, and then their email/phone/website/facebook/twitter/whatever else on another page. So with that in mind, he should do as little as possible. If requirements change later he can make things more complex as needed."}, {"owner": {"reputation": 729, "user_id": 5655756, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/100005069719213/picture?type=large", "display_name": "Catalin", "link": "https://stackoverflow.com/users/5655756/catalin"}, "edited": false, "score": 0, "creation_date": 1449694217, "post_id": 34186152, "comment_id": 56123759, "body": "@sicks, this is exactly what I was trying to achieve, but my lack of RoR skills complicated things for me. For future development, do you think it&#39;s good practice to have a separate Profile model, instead of simply adding fields to the Devise&#39;s User model ? Guys thank you so much, I will re-read everything, try it out to better understand how things work and I will select a solution after that."}, {"owner": {"reputation": 767, "user_id": 714808, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40cbc00e62bd52ec2b57439ddabe060c?s=128&d=identicon&r=PG", "display_name": "sicks", "link": "https://stackoverflow.com/users/714808/sicks"}, "edited": false, "score": 0, "creation_date": 1449695159, "post_id": 34186152, "comment_id": 56124244, "body": "It totally depends on your implementation and how you plan to use it. Use the rubber-ducky method and try to describe your objects and methods to a friend in plain English. If, describing your &quot;user&quot; methods finds you talking about &quot;the user&#39;s profile&quot; rather than &quot;the user&quot;, then perhaps you do need to abstract that functionality to its own object."}, {"owner": {"reputation": 729, "user_id": 5655756, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/100005069719213/picture?type=large", "display_name": "Catalin", "link": "https://stackoverflow.com/users/5655756/catalin"}, "edited": false, "score": 0, "creation_date": 1449769017, "post_id": 34186152, "comment_id": 56160961, "body": "I stumbled on a problem, the resource is nil in profile view, it doesn&#39;t get passed there. I have found the situation described in an older SO question, but the answer didn&#39;t work for me: <a href=\"http://stackoverflow.com/questions/11254895/custom-action-for-devise-registrations-controller-getting-nil-resource\" title=\"custom action for devise registrations controller getting nil resource\">stackoverflow.com/questions/11254895/&hellip;</a> Any ideas ? I know I can probably access the info through current_user, but I&#39;d like to do it through resourse..."}, {"owner": {"reputation": 767, "user_id": 714808, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40cbc00e62bd52ec2b57439ddabe060c?s=128&d=identicon&r=PG", "display_name": "sicks", "link": "https://stackoverflow.com/users/714808/sicks"}, "edited": false, "score": 0, "creation_date": 1449778552, "post_id": 34186152, "comment_id": 56165918, "body": "I&#39;ve updated my answer to include how to get resource working in your profile action as well. I&#39;d just use <code>current_user</code> however. More effort goes into resource only because devise needs to be flexible enough to handle user models not named &quot;user&quot;."}], "tags": [], "owner": {"reputation": 767, "user_id": 714808, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40cbc00e62bd52ec2b57439ddabe060c?s=128&d=identicon&r=PG", "display_name": "sicks", "link": "https://stackoverflow.com/users/714808/sicks"}, "is_accepted": true, "score": 1, "last_activity_date": 1449778479, "last_edit_date": 1449778479, "creation_date": 1449685077, "answer_id": 34186152, "question_id": 34184233, "link": "https://stackoverflow.com/questions/34184233/ruby-on-rails-devise-split-user-edit-page-into-2-pages/34186152#34186152", "title": "Ruby on Rails / Devise - Split user edit page into 2 pages", "body": "<p>You don't need a separate controller, especially since you're already extending the default Devise RegistrationsController, which already works fine for updating user attributes.</p>\n\n<p><strong>Edit:</strong> If these aren't just extended user attributes, and <code>profile</code> is it's own object with its own logic and behaviour, <em>then</em> consider creating it's own controller, to manage the CRUD for that object.</p>\n\n<p>If you're using devise's user/edit page as part one, all you need to do is add a <code>profile</code> action in your custom controller, and create a view file to go with it.</p>\n\n<pre><code># this is all that's in the edit action from Devise\ndef edit\n  render :edit\nend\n\n# add this to your custom RegistrationsController\ndef profile\n  render :profile\nend\n</code></pre>\n\n<p>Then you can fiddle with your routes (see <a href=\"https://github.com/plataformatec/devise#configuring-routes\" rel=\"nofollow\">this</a> and <a href=\"http://guides.rubyonrails.org/routing.html\" rel=\"nofollow\">this</a>) until they route the URLs you want to use to the correct controller:</p>\n\n<pre><code># you probably have this, which covers your current user/edit route\ndevise_for :users\n\n# but you can add this to extend these routes\ndevise_scope :user do\n  # will route /profile to the profile action on User::RegistrationsController\n  get :profile, to: 'users/registrations'\n\n  # or if you want more control over the specifics\n  get 'users/settings/profile', to: 'users/registrations#profile', as: :user_profile\nend\n</code></pre>\n\n<p>For your second view/form to update user attributes from another, non-devise controller, you can use <code>form_for current_user, { url: user_registration_path }</code></p>\n\n<p>If you do want to use resource, you'll have to add this to the top of your registrations controller, so that the resource gets defined on your profile action as well:</p>\n\n<pre><code>prepend_before_filter :authenticate_scope!, only: [:edit, :profile, :update, :destroy]\n</code></pre>\n\n<p>Take a look at <a href=\"https://github.com/plataformatec/devise#strong-parameters\" rel=\"nofollow\">devise's documentation around strong parameters</a> to see how to make sure whatever additional attributes you're going to add to your user are white listed by your custom <code>RegistrationsController</code>.</p>\n"}], "owner": {"reputation": 729, "user_id": 5655756, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/100005069719213/picture?type=large", "display_name": "Catalin", "link": "https://stackoverflow.com/users/5655756/catalin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 971, "favorite_count": 1, "accepted_answer_id": 34186152, "answer_count": 3, "score": 1, "last_activity_date": 1449778479, "creation_date": 1449679411, "question_id": 34184233, "link": "https://stackoverflow.com/questions/34184233/ruby-on-rails-devise-split-user-edit-page-into-2-pages", "title": "Ruby on Rails / Devise - Split user edit page into 2 pages", "body": "<p>I'm trying to split the users edit page (app/views/devise/registrations/edit.html.erb) into 2 pages for better UI, like:</p>\n\n<pre><code>/settings \n/settings/profile\n</code></pre>\n\n<p>I'm fairly new to Rails, did Michael Hartl's tutorial and had read a few more I got my hands on, just building my first application, even if I have some experience with php</p>\n\n<p>This is the view I try to split in 2, it is a view provided by the Devise gem (app/views/devise/registrations/edit.html.erb)</p>\n\n<pre><code>&lt;h2&gt;Login Details&lt;/h2&gt;\n\n&lt;%= form_for(resource, as: resource_name, url: registration_path(resource_name), html: { method: :put }) do |f| %&gt;\n  &lt;%= devise_error_messages! %&gt;\n\n  &lt;%# sensitive info %&gt;\n  &lt;%= f.label :email %&gt;&lt;br /&gt;\n  &lt;%= f.email_field :email, autofocus: true %&gt;\n  ....\n  &lt;%= f.label :current_password %&gt; &lt;i&gt;(to confirm changes)&lt;/i&gt;&lt;br /&gt;\n  &lt;%= f.password_field :current_password, autocomplete: \"off\" %&gt;\n\n  &lt;h2&gt;Profile Details&lt;/h2&gt;\n\n  &lt;%# non-sensitive info %&gt;\n  &lt;%= f.label :name %&gt;&lt;br /&gt;\n  &lt;%= f.text_field :name %&gt;\n\n  &lt;%= f.submit \"Update\" %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>It uses a custom RegistrationsController (app/controllers/registrations_controller.rb)</p>\n\n<pre><code>class RegistrationsController &lt; Devise::RegistrationsController\n  def update\n    ....\n  end\nend\n</code></pre>\n\n<p>Further more, this view is accessed via this route:</p>\n\n<pre><code>edit_user GET      /users/:id/edit(.:format)              users#edit\n</code></pre>\n\n<p>My main question is, how do I split this page into 2:</p>\n\n<ul>\n<li>/settings containing Login Details</li>\n<li>/settings/profile containing Profile details</li>\n</ul>\n\n<p>and both to processed by the same controller, or the same action</p>\n\n<p>Do I need to create a new controler/route/view, like:</p>\n\n<ul>\n<li>controller: SettingsProfile</li>\n<li>route: get 'settings/profile' => 'settings_profile#new'</li>\n<li>view: app/views/settings_profile/new.html.erb</li>\n</ul>\n\n<p>If so how do I pass the view the \"resource\" information, or any information for the matter of fact:</p>\n\n<pre><code>&lt;%= form_for(resource, as: resource_name, url: registration_path(resource_name), html: { method: :put }) do |f| %&gt;\n</code></pre>\n\n<p>Things are pretty fuzzy at this point, please bear with me on this one</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 4, "creation_date": 1449679624, "post_id": 34184231, "comment_id": 56114918, "body": "You can use <a href=\"http://ruby-doc.org/stdlib-2.2.3/libdoc/erb/rdoc/ERB.html\" rel=\"nofollow noreferrer\">ERB</a> for this."}], "answers": [{"tags": [], "owner": {"reputation": 2345, "user_id": 4511585, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IC7eZ.jpg?s=128&g=1", "display_name": "albttx", "link": "https://stackoverflow.com/users/4511585/albttx"}, "is_accepted": true, "score": 0, "last_activity_date": 1449691621, "last_edit_date": 1449691621, "creation_date": 1449681221, "answer_id": 34184910, "question_id": 34184231, "link": "https://stackoverflow.com/questions/34184231/read-a-file-with-variable-inside-a-text-file/34184910#34184910", "title": "Read a file with variable inside a text file", "body": "<p>The Solution :</p>\n\n<p><code>tamplate.erb</code> file with your variable inside a <code>&lt;%= var_name %&gt;</code></p>\n\n<p>in <code>script.rb</code></p>\n\n<pre><code>require 'erb'\ntemplate = File.open(\"template.erb\", \"r\")\nstr_template = ERB.new(template.read).result()\ntemplate.close\n\nfile = File.new(\"newfile\", \"w\")\nfile.puts(str_template)\nfile.close\n</code></pre>\n\n<p>Thanks to Sergio Tulentsev!</p>\n"}], "owner": {"reputation": 2345, "user_id": 4511585, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/IC7eZ.jpg?s=128&g=1", "display_name": "albttx", "link": "https://stackoverflow.com/users/4511585/albttx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 34184910, "answer_count": 1, "score": 0, "last_activity_date": 1449691621, "creation_date": 1449679402, "last_edit_date": 1449691585, "question_id": 34184231, "link": "https://stackoverflow.com/questions/34184231/read-a-file-with-variable-inside-a-text-file", "title": "Read a file with variable inside a text file", "body": "<p>Can I read a file containing <code>#{var_name}</code>, and when I read and print it, write the value of <code>var_name</code>?</p>\n\n<p>I tried using</p>\n\n<pre><code>File.open(filename, \"w\").read\n</code></pre>\n\n<p>to get it as a String, but I didn't find the solution:</p>\n\n<pre><code>var_name = \"HelloWorld\"\nf = File.open(\"file.ex\", \"r\").read\n    # puts f.class =&gt; String\nputs f\n    #  #{var_name} is print and no HelloWorld\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "answers": [{"tags": [], "owner": {"reputation": 4416, "user_id": 2552259, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6d74162f339b5acd772d3f5dadaa8ea?s=128&d=identicon&r=PG", "display_name": "Jorge de los Santos", "link": "https://stackoverflow.com/users/2552259/jorge-de-los-santos"}, "is_accepted": false, "score": 1, "last_activity_date": 1449679653, "creation_date": 1449679653, "answer_id": 34184334, "question_id": 34184069, "link": "https://stackoverflow.com/questions/34184069/undefined-local-variable-or-method-feed-item-in-10-3-3-of-michael-harts-ruby/34184334#34184334", "title": "undefined local variable or method `feed_item` in 10.3.3 of Michael Hart&#39;s Ruby on Rails Tutorial", "body": "<p>If I'm right and you copied and pasted:</p>\n\n<pre><code>&lt;ol class=\"microposts\"&gt;\n&lt;%= render partial:'shared/feed_item', collecton: @feed_items %&gt;\n&lt;/ol&gt;\n</code></pre>\n\n<p>You have a typo in <code>app/views/shared/_feed.html.erb</code></p>\n\n<p>Should be <code>collection</code></p>\n"}, {"tags": [], "owner": {"reputation": 171, "user_id": 1115678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6fd65896407439fed9bfa455e5445457?s=128&d=identicon&r=PG", "display_name": "Herk", "link": "https://stackoverflow.com/users/1115678/herk"}, "is_accepted": true, "score": 1, "last_activity_date": 1449679760, "creation_date": 1449679760, "answer_id": 34184379, "question_id": 34184069, "link": "https://stackoverflow.com/questions/34184069/undefined-local-variable-or-method-feed-item-in-10-3-3-of-michael-harts-ruby/34184379#34184379", "title": "undefined local variable or method `feed_item` in 10.3.3 of Michael Hart&#39;s Ruby on Rails Tutorial", "body": "<p>You have misspelled <code>collection</code> in app/views/shared/_feed.html.erb line 3, try changing it to:\n<code>&lt;%= render partial:'shared/feed_item', collection: @feed_items %&gt;</code></p>\n\n<p>You can also find the reference implementation <a href=\"https://github.com/railstutorial/sample_app_2nd_ed\" rel=\"nofollow\">here</a> which should help you compare the code.</p>\n"}], "owner": {"reputation": 13, "user_id": 5659895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c197257023222ff780f2ad2a963f7c2?s=128&d=identicon&r=PG&f=1", "display_name": "lilyxue", "link": "https://stackoverflow.com/users/5659895/lilyxue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 34184379, "answer_count": 2, "score": 0, "last_activity_date": 1449679760, "creation_date": 1449678912, "question_id": 34184069, "link": "https://stackoverflow.com/questions/34184069/undefined-local-variable-or-method-feed-item-in-10-3-3-of-michael-harts-ruby", "title": "undefined local variable or method `feed_item` in 10.3.3 of Michael Hart&#39;s Ruby on Rails Tutorial", "body": "<p>When I run  'rails s'and visit the URL '<a href=\"http://localhost:3000\" rel=\"nofollow\">http://localhost:3000</a>',error occurred</p>\n\n<pre><code>ActionView::Template::Error (undefined local variable or method `feed_item` for #&lt;#&lt;Class:0xb7c6d9c&gt;:0xb7c6310&gt;):\n1: &lt;li id=\"&lt;%= feed_item.id %&gt;\"&gt;\n2: &lt;%= link_to gravatar_for(feed_item.user), feed_item.user %&gt;\n3: &lt;span class=\"user\"&gt;\n4: &lt;%= link_to feed_item.user.name,feed_item.user %&gt;\napp/views/shared/_feed_item.html.erb:1:in `_app_views_shared__feed_item_html_erb___55615773_95474750`\napp/views/shared/_feed.html.erb:3:in `_app_views_shared__feed_html_erb__499283038_95518450`\napp/views/static_pages/home.html.erb:14:in `_app_views_static_pages_home_html_erb___238258941_96211170` `\n</code></pre>\n\n<p>1.app/views/shared/_feed_item.html.erb</p>\n\n<pre><code>&lt;li id=\"&lt;%= feed_item.id %&gt;\"&gt;\n&lt;%= link_to gravatar_for(feed_item.user), feed_item.user %&gt;\n&lt;span class=\"user\"&gt;\n&lt;%= link_to feed_item.user.name,feed_item.user %&gt;\n&lt;/span&gt;\n&lt;span class=\"content\"&gt;&lt;%=feed_item.content %&gt;&lt;/span&gt;\n&lt;span class=\"timestamp\"&gt;\nPosted &lt;%=time_ago_in_words(feed_item.created_at) %&gt;ago.\n&lt;/span&gt;\n&lt;/li&gt;\n</code></pre>\n\n<p>2.app/views/shared/_feed.html.erb</p>\n\n<pre><code>&lt;% if @feed_items.any? %&gt;\n&lt;ol class=\"microposts\"&gt;\n&lt;%= render partial:'shared/feed_item',collecton:@feed_items %&gt;\n&lt;/ol&gt;\n&lt;%= will_paginate @feed_items%&gt;\n&lt;%end%&gt;\n</code></pre>\n\n<p>3.app/controllers/static_pages_controller.rb</p>\n\n<pre><code>class StaticPagesController &lt; ApplicationController\n  def home\nif signed_in?\n@micropost = current_user.microposts.build\n@feed_items = current_user.feed.paginate(page:params[:page])\n\nend\n\n  end\n  def help\n  end\n\n  def about\n  end\n\n  def show\n  end\n  def contact\n  end\nend\n</code></pre>\n\n<p>4.app/views/static_pages/home.html.erb</p>\n\n<pre><code> &lt;% if signed_in? %&gt;\n    &lt;div class=\"row\" &gt;\n    &lt;aside class=\"span4\" &gt;\n    &lt;section&gt;\n    &lt;%= render 'shared/user_info' %&gt;\n    &lt;/section&gt;\n    &lt;section&gt;\n    &lt;%=render 'shared/micropost_form' %&gt;\n    &lt;/section&gt;\n    &lt;/aside&gt;\n\n    &lt;div class=\"span8\"&gt;\n    &lt;h3&gt;Micropost Feed &lt;/h3&gt;\n    &lt;%= render 'shared/feed' %&gt;\n    &lt;/div&gt;\n    &lt;/div&gt;\n\n    &lt;%else%&gt;\n    &lt;div class=\"center hero-unit\"&gt;\n    &lt;h1&gt;Welcome to the Sample App&lt;/h1&gt;\n    &lt;h2&gt;\n    This is the home page for the \n    &lt;a href=\"http://railstutorial.org/\"&gt;Ruby on Rails Tutorial&lt;/a&gt;\n    sample application.\n    &lt;/h2&gt;\n    &lt;%= link_to \"Sign up now\",signup_path,class: \"btn btn-large btn-primary\" %&gt;\n    &lt;/div&gt;\n\n    &lt;%= link_to image_tag(\"rails.png\",alt: \"Rails\"),'http://`rubyonrails`.org/' %&gt;\n    &lt;%end%&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1449678272, "post_id": 34183149, "comment_id": 56113872, "body": "Ruby isn&#39;t Java. We don&#39;t need, or use <code>String str =...</code> and <code>getChecksum</code> should be <code>get_checksum</code> as methods, like variables, are written in snake_case."}, {"owner": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1449680072, "post_id": 34183149, "comment_id": 56115225, "body": "@theTinMan Yes...you are right...But learned quite a lot with this single question..Thank you all for the help.."}], "answers": [{"comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 1, "creation_date": 1449676794, "post_id": 34183228, "comment_id": 56112875, "body": "With this many arguments a hash is probably preferable. You could get the best of both words by using keyword arguments: <a href=\"https://robots.thoughtbot.com/ruby-2-keyword-arguments\" rel=\"nofollow noreferrer\">robots.thoughtbot.com/ruby-2-keyword-arguments</a>"}, {"owner": {"reputation": 6200, "user_id": 637094, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fd50f61387b63900335c8556f86237be?s=128&d=identicon&r=PG", "display_name": "Leonel Gal&#225;n", "link": "https://stackoverflow.com/users/637094/leonel-gal%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1449676812, "post_id": 34183228, "comment_id": 56112896, "body": "Welcome to Ruby! You will find it entertaining and behind a strong community ready to help."}, {"owner": {"reputation": 962, "user_id": 2011580, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/E9Ket.png?s=128&g=1", "display_name": "James B. Byrne", "link": "https://stackoverflow.com/users/2011580/james-b-byrne"}, "edited": false, "score": 1, "creation_date": 1449677098, "post_id": 34183228, "comment_id": 56113087, "body": "WRT to the method signature.  You can either pass the values from the controller to your method as a comma delimited parameter list; or you can keep what you have in the controller and re-factor your target method to take a hash and extract the keys. Something like <code>def getChecksum( myhash ) ; mykey = myhash[ :key ] ; mytxnid = myhash[ :txnid ] ; . . .; end</code>"}, {"owner": {"reputation": 962, "user_id": 2011580, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/E9Ket.png?s=128&g=1", "display_name": "James B. Byrne", "link": "https://stackoverflow.com/users/2011580/james-b-byrne"}, "edited": false, "score": 0, "creation_date": 1449678238, "post_id": 34183228, "comment_id": 56113848, "body": "That is because the code formatting in comments is limited.  Each of those &#39;;&#39; would instead be a line break if I were writing it.  But, a &#39;;&#39; is a valid statement terminator. So, the example is correct Ruby.  Just not idiomatic."}, {"owner": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "reply_to_user": {"reputation": 962, "user_id": 2011580, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/E9Ket.png?s=128&g=1", "display_name": "James B. Byrne", "link": "https://stackoverflow.com/users/2011580/james-b-byrne"}, "edited": false, "score": 0, "creation_date": 1449679623, "post_id": 34183228, "comment_id": 56114917, "body": "@JamesB.Byrne didnt meant its bad code in anyway..I just meant the method with my scenario as mine has quite some values.."}, {"owner": {"reputation": 962, "user_id": 2011580, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/E9Ket.png?s=128&g=1", "display_name": "James B. Byrne", "link": "https://stackoverflow.com/users/2011580/james-b-byrne"}, "edited": false, "score": 0, "creation_date": 1449684639, "post_id": 34183228, "comment_id": 56118209, "body": "All the more reason to tease each one out into its own variable so that its value can be inspected and manipulated without affecting any of the others."}], "tags": [], "owner": {"reputation": 6200, "user_id": 637094, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fd50f61387b63900335c8556f86237be?s=128&d=identicon&r=PG", "display_name": "Leonel Gal&#225;n", "link": "https://stackoverflow.com/users/637094/leonel-gal%c3%a1n"}, "is_accepted": false, "score": 2, "last_activity_date": 1449676675, "last_edit_date": 1449676675, "creation_date": 1449676489, "answer_id": 34183228, "question_id": 34183149, "link": "https://stackoverflow.com/questions/34183149/creating-a-checksum-for-passed-in-parameters-in-ruby/34183228#34183228", "title": "Creating a checksum for passed in parameters in Ruby", "body": "<p>You are sending a single hash as the parameter, instead you need to send the values only (without keys). Also no need to declare the type <code>String str</code>, you should review your Ruby fundamentals, I'm guessing you come from another language.</p>\n\n<pre><code># You are calling this\ngetChecksum(key: 'key_value', txnid: '4', ...)\n# which syntactically equals this, a single hash as a parameter\ngetChecksum({key: 'key_value', txnid: '4', ...})\n# Instead, send the values alone\ngetChecksum('key_value', '4', ...)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "edited": false, "score": 0, "creation_date": 1449678161, "post_id": 34183584, "comment_id": 56113777, "body": "This last solution looks much elegant without those pipes. Thanks."}], "tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": false, "score": 1, "last_activity_date": 1449677791, "last_edit_date": 1449677791, "creation_date": 1449677459, "answer_id": 34183584, "question_id": 34183149, "link": "https://stackoverflow.com/questions/34183149/creating-a-checksum-for-passed-in-parameters-in-ruby/34183584#34183584", "title": "Creating a checksum for passed in parameters in Ruby", "body": "<p>Here's how you would define the method with keyword arguments:</p>\n\n<pre><code>def getChecksum(key:, txnid:, amount:, productinfo:, firstname:, email:, phone:, surl:, furl:)\n  str = key + '|' + txnid + '|' + amount + '|' + productinfo + '|' + firstname + '|' + email + '|' + phone + '|' + surl + '|' + furl+ '|'+ '|'+ '|'+ '|'+ '|'+ '|'+ '|'+ '|' + 'salt'\n  Digest::SHA512.hexdigest( str )\nend\n</code></pre>\n\n<p>Then you can call it with a hash like you are currently.</p>\n\n<p>I think this looks a bit cleaner, though:</p>\n\n<pre><code>def get_checksum(key:, txnid:, amount:, productinfo:, firstname:, email:, phone:, surl:, furl:)\n  str = \"#{key}|#{txnid}|#{amount}|#{productinfo}|#{firstname}|#{email}|#{phone}|#{surl}|#{furl}||||||||salt\"\n  Digest::SHA512.hexdigest(str)\nend\n</code></pre>\n\n<p>Or perhaps:</p>\n\n<pre><code>def get_checksum(key:, txnid:, amount:, productinfo:, firstname:, email:, phone:, surl:, furl:)\n  str = [ key, txnid, amount, productinfo, firstname, email, phone, surl, furl ].join(\"|\")\n  Digest::SHA512.hexdigest(\"#{str}||||||||salt\")\nend\n</code></pre>\n\n<p>You can learn more about keyword arguments, including how to give keywords default values to make them optional, here: <a href=\"https://robots.thoughtbot.com/ruby-2-keyword-arguments\" rel=\"nofollow\">https://robots.thoughtbot.com/ruby-2-keyword-arguments</a></p>\n"}, {"comments": [{"owner": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "edited": false, "score": 0, "creation_date": 1449687239, "post_id": 34185529, "comment_id": 56119845, "body": "Thank you for taking the time in putting this all together..I now feels like  I understand it all like a breeze....Changed the chosen answer to this as this explains a lot in detail...Couldn&#39;t thank more...Have a great day..."}], "tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": true, "score": 1, "last_activity_date": 1449683193, "creation_date": 1449683193, "answer_id": 34185529, "question_id": 34183149, "link": "https://stackoverflow.com/questions/34183149/creating-a-checksum-for-passed-in-parameters-in-ruby/34185529#34185529", "title": "Creating a checksum for passed in parameters in Ruby", "body": "<p>Let's look at how you're writing your code and see if we can make it more Ruby-like and hopefully more production-worthy.</p>\n\n<p>You wrote this:</p>\n\n<pre><code>def getChecksum(key, txnid, amount, productinfo, firstname, email, phone, surl, furl)\n  String str = key + '|' + txnid + '|' + amount + '|' + productinfo + '|' + firstname + '|' + email + '|' + phone + '|' + surl + '|' + furl+ '|'+ '|'+ '|'+ '|'+ '|'+ '|'+ '|'+ '|' + 'salt'\n  Digest::SHA512.hexdigest( str )\nend\n</code></pre>\n\n<p>First, ick. </p>\n\n<ul>\n<li>Methods and variables in Ruby are snake_case, not camelCase. ItsAReadabilityThing.</li>\n<li>We don't define variables using <code>String str =...</code>. Ruby can figure out what type of variable it is 99.99% of the time, so <code>str =...</code> is sufficient.</li>\n<li><p>Think about how you're using fixed-strings and values. <code>'|'</code> is your separator, so define it as such:</p>\n\n<pre><code>SEPARATOR = '|'\n</code></pre>\n\n<p>And you need eleven of them as a divider, so define that:</p>\n\n<pre><code>DIVIDER = SEPARATOR * 11\n</code></pre></li>\n</ul>\n\n<p>I'd write the code more like this:</p>\n\n<pre><code>require 'digest/sha2'\n\nSEPARATOR = '|'\nDIVIDER = SEPARATOR * 11 # =&gt; \"|||||||||||\"\n\ndef checksum_1(key, txnid, amount, productinfo, firstname, email, phone, surl, furl)\n  str = [key, txnid, amount, productinfo, firstname, email, phone, surl, furl].join(SEPARATOR) + DIVIDER + 'salt'\n  Digest::SHA512.hexdigest(str)\nend\n</code></pre>\n\n<p>But even that can be improved upon. </p>\n\n<p>When we have more than three parameters it's time to refactor and clean up the parameter list. There are many ways to do it, but using a hash is the most common:</p>\n\n<pre><code>def checksum_2(params)\n  str = params.values_at(\n    :key, :txnid, :amount, :productinfo, :firstname, :email, :phone, :surl, :furl\n  ).join(SEPARATOR) + DIVIDER + 'salt'\n\n  Digest::SHA512.hexdigest( str )\nend\n</code></pre>\n\n<p>Using <code>values_at</code> is a nice way to extract the values of the keys in a hash. They come out in an array in the same order of the keys.</p>\n\n<p>The problem now is that a parameter could be missing and Ruby won't catch it. Named parameters are the new-hotness for dealing with that, but for older Rubies, or to get an idea how it might be done in other languages, we can look at the keys received, then their associated values, and if things don't look good raise an exception rather than return a bogus value. </p>\n\n<p>To make things easier I'm going to use Active Support's <a href=\"http://edgeguides.rubyonrails.org/active_support_core_extensions.html#blank-questionmark-and-present-questionmark\" rel=\"nofollow\"><code>blank?</code></a> method, found in the Core Extensions:</p>\n\n<pre><code>require 'active_support/core_ext/object/blank'\ndef checksum_3(params)\n  required_values = [:key, :txnid, :amount, :productinfo, :firstname, :email, :phone, :surl, :furl]\n\n  missing_keys = required_values - params.keys\n  fail ArgumentError, \"Missing keys: #{ missing_keys.map{ |k| \":#{ k }\" }.join(', ') }\" unless missing_keys.empty?\n\n  missing_values = required_values.select{ |k| params[k].blank? }\n  fail ArgumentError, \"Missing values for: #{ missing_values.map{ |k| \":#{ k }\" }.join(', ') }\" unless missing_values.empty?\n\n  str = params.values_at(*required_values).join(SEPARATOR) + DIVIDER + 'salt'\n  Digest::SHA512.hexdigest(str)\nend\n</code></pre>\n\n<p>Here's how the calls to the various versions of the method look, along with the associated checksum that's returned:</p>\n\n<pre><code>c1 = checksum_1('key_value', '4', '2000', 'first sales', 'John', 'johndepp@gmail.com', '123456789', 'http://someurl.io', 'http://someurl.io')\n\nc2 = checksum_2(\n  key: 'key_value',\n  txnid: '4',\n  amount: '2000',\n  productinfo: 'first sales',\n  firstname: 'John',\n  email: 'johndepp@gmail.com',\n  phone: '123456789',\n  surl: 'http://someurl.io',\n  furl: 'http://someurl.io'\n)\n\nc3 = checksum_3(\n  key: 'key_value',\n  txnid: '4',\n  amount: '2000',\n  productinfo: 'first sales',\n  firstname: 'John',\n  email: 'johndepp@gmail.com',\n  phone: '123456789',\n  surl: 'http://someurl.io',\n  furl: 'http://someurl.io'\n)\n\nc1 # =&gt; \"fcf4e21c6e711808a6984824f09552dccc5c4378b55720c88b3abd4a1904931b8d883beaef51edec705a9d8b0ccd3ba898a0d4c05f75bd41fa3b90f0df7b5c79\"\nc2 # =&gt; \"fcf4e21c6e711808a6984824f09552dccc5c4378b55720c88b3abd4a1904931b8d883beaef51edec705a9d8b0ccd3ba898a0d4c05f75bd41fa3b90f0df7b5c79\"\nc3 # =&gt; \"fcf4e21c6e711808a6984824f09552dccc5c4378b55720c88b3abd4a1904931b8d883beaef51edec705a9d8b0ccd3ba898a0d4c05f75bd41fa3b90f0df7b5c79\"\n</code></pre>\n\n<p>While we still have to pass in the same amount of information, using the hash allows us to see what each parameter is being assigned to, resulting in self-documenting code, which is a very important thing for long-term maintenance. Also, the hash doesn't require a specific order of the parameters, making it easier to write the code calling it; I usually know I need certain things but can't remember what order they're in.</p>\n\n<p>That's all my take on how to write this type of code. See \"<a href=\"https://robots.thoughtbot.com/ruby-2-keyword-arguments\" rel=\"nofollow\">Ruby 2 Keyword Arguments</a>\" for a similar write-up on the same topic.</p>\n"}], "owner": {"reputation": 2300, "user_id": 2874507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-bTf3QWEeXi0/AAAAAAAAAAI/AAAAAAAAAvA/G7Uh0JZWsOk/photo.jpg?sz=128", "display_name": "Abhilash", "link": "https://stackoverflow.com/users/2874507/abhilash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 0, "accepted_answer_id": 34185529, "answer_count": 3, "score": 0, "last_activity_date": 1449683193, "creation_date": 1449676284, "last_edit_date": 1449678775, "question_id": 34183149, "link": "https://stackoverflow.com/questions/34183149/creating-a-checksum-for-passed-in-parameters-in-ruby", "title": "Creating a checksum for passed in parameters in Ruby", "body": "<p>I am creating a checksum for my payment gateway. The checksum should be in this format:</p>\n\n<pre><code>key|txnid|amount|productinfo|firstname|email|||||||||||salt\n</code></pre>\n\n<p>I need to leave 11 pipes between the email and the salt. </p>\n\n<p>In my controller I created a method:</p>\n\n<pre><code>require 'digest/sha2'\n\ndef getChecksum(key, txnid, amount, productinfo, firstname, email, phone, surl, furl)\n  String str = key + '|' + txnid + '|' + amount + '|' + productinfo + '|' + firstname + '|' + email + '|' + phone + '|' + surl + '|' + furl+ '|'+ '|'+ '|'+ '|'+ '|'+ '|'+ '|'+ '|' + 'salt'\n  Digest::SHA512.hexdigest( str )\nend\n</code></pre>\n\n<p>I called this method in my controller:</p>\n\n<pre><code>hash: getChecksum(\n              key: 'key_value',\n              txnid: '4',\n              amount: '2000',\n              productinfo: 'first sales',\n              firstname: 'John',\n              email: 'johndepp@gmail.com',\n              phone: '123456789',\n              surl: 'http://someurl.io',\n              furl: 'http://someurl.io')\n</code></pre>\n\n<p>But now I am getting a \"wrong number of arguments\" error:</p>\n\n<pre><code>wrong number of arguments (1 for 9)    \ndef getChecksum( key,  txnid, \namount,  productinfo,  firstname, email, phone, surl, furl)\n</code></pre>\n\n<p>I think all the parameters are considered as a single one. Can someone tell me what I am doing wrong here?</p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 2347, "user_id": 3905832, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/ee3a70b9947104f3b4b6f1cb9c8c6d20?s=128&d=identicon&r=PG&f=1", "display_name": "Kraal", "link": "https://stackoverflow.com/users/3905832/kraal"}, "edited": false, "score": 1, "creation_date": 1449679258, "post_id": 34182963, "comment_id": 56114653, "body": "Yes it is possible... But I guess that you&#39;re expecting another answer. Show what you tried, and what problem you&#39;re facing, then people will be able to help you."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1449682776, "post_id": 34182963, "comment_id": 56117041, "body": "You could improve your question by including a complete example. Here I&#39;d suggest that <code>arr</code> contain four or five arrays. That way, all the answers will use that example. Aside from that, I don&#39;t understand why your question has been downvoted."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1449691779, "post_id": 34182963, "comment_id": 56122375, "body": "Welcome to Stack Overflow. Please read &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;. As is, you&#39;ve asked a very broad question, so you get broad answers."}], "answers": [{"tags": [], "owner": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "is_accepted": false, "score": 0, "last_activity_date": 1449676458, "creation_date": 1449676458, "answer_id": 34183217, "question_id": 34182963, "link": "https://stackoverflow.com/questions/34182963/ruby-hash-of-arrays-remove-first-element-from-array/34183217#34183217", "title": "Ruby hash of arrays remove first element from array", "body": "<p>You can use this code</p>\n\n<pre><code>arr = [[\"U6342\", \"2015-01-12\", \"Account\"], [\"U6343\", \"2015-02-12\", \"Bank\"]]\n\nHash[arr.map{|ar| [ar.first, ar[1..-1]]}]\n# =&gt; {\"U6342\"=&gt;[\"2015-01-12\", \"Account\"], \"U6343\"=&gt;[\"2015-02-12\", \"Bank\"]}\n</code></pre>\n\n<p>or with \"modify\" the orginal <code>arr</code> variable</p>\n\n<pre><code>Hash[arr.map{|ar| [ar.shift, ar]}]\n</code></pre>\n\n<p>I hope this helps</p>\n"}, {"comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1449677287, "post_id": 34183478, "comment_id": 56113211, "body": "awesome, just awesome!"}, {"owner": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "edited": false, "score": 0, "creation_date": 1449677360, "post_id": 34183478, "comment_id": 56113255, "body": "<code>shift</code> also modify &quot;original&quot; array. Just for info;)"}, {"owner": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "edited": false, "score": 0, "creation_date": 1449677830, "post_id": 34183478, "comment_id": 56113574, "body": "@mudasobwa no problem, but this your update also modify &quot;original&quot; bcs. <code>dup</code> method duplicate only first level of array :) use this <code>Marshal.load(Marshal.dump(arr)).group_by &amp;:shift</code>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "edited": false, "score": 1, "creation_date": 1449677959, "post_id": 34183478, "comment_id": 56113641, "body": "@LukasBaliak indeed, but <code>Marshal</code> is an overkill here. Pls see an update."}, {"owner": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "edited": false, "score": 0, "creation_date": 1449678703, "post_id": 34183478, "comment_id": 56114229, "body": "@mudasobwa yes, <code>Marshal</code> is overkil in this case:) And yes, you can do it with <code>map(&amp;:dup)</code>. nice work ;)"}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 6, "last_activity_date": 1449677936, "last_edit_date": 1449677936, "creation_date": 1449677202, "answer_id": 34183478, "question_id": 34182963, "link": "https://stackoverflow.com/questions/34182963/ruby-hash-of-arrays-remove-first-element-from-array/34183478#34183478", "title": "Ruby hash of arrays remove first element from array", "body": "<p>One might <a href=\"http://ruby-doc.org/core-2.2.0/Array.html#method-i-shift\" rel=\"nofollow\"><code>shift</code></a> a required element inplace.</p>\n\n<pre><code>arr.group_by &amp;:shift\n</code></pre>\n\n<p>Whether you do not want to modify an original array:</p>\n\n<pre><code>arr.map(&amp;:dup).group_by &amp;:shift\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1449681816, "post_id": 34183519, "comment_id": 56116418, "body": "Excelllent! You posted shortly after @mudasobwa (the time it took to add your example), but close enough that I&#39;d call it a tie, so leave your answer."}], "tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": false, "score": 1, "last_activity_date": 1449677302, "creation_date": 1449677302, "answer_id": 34183519, "question_id": 34182963, "link": "https://stackoverflow.com/questions/34182963/ruby-hash-of-arrays-remove-first-element-from-array/34183519#34183519", "title": "Ruby hash of arrays remove first element from array", "body": "<p>I think some of the other answerers are overthinking it:</p>\n\n<pre><code>arr = [ [\"U6342\", \"2015-01-12\", \"Account\"],\n        [\"U1234\", \"2015-02-12\", \"Foo\"],\n        [\"U6342\", \"2015-03-12\", \"Bar\"],\n        [\"U1234\", \"2015-04-12\", \"Qux\"] ]\n\narr.group_by(&amp;:shift)\n# =&gt; { \"U6342\" =&gt; [ [ \"2015-01-12\", \"Account\" ],\n#                   [ \"2015-03-12\", \"Bar\"     ] ],\n#      \"U1234\" =&gt; [ [ \"2015-02-12\", \"Foo\"     ],\n#                   [ \"2015-04-12\", \"Qux\"     ] ]\n#    }\n</code></pre>\n\n<p><code>Array#shift</code> removes the first element from the array and returns it. <code>arr.group_by(&amp;:shift)</code> removes the first element from each element in <code>arr</code> and groups by it.</p>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1449682551, "creation_date": 1449682551, "answer_id": 34185331, "question_id": 34182963, "link": "https://stackoverflow.com/questions/34182963/ruby-hash-of-arrays-remove-first-element-from-array/34185331#34185331", "title": "Ruby hash of arrays remove first element from array", "body": "<p>You don't have to use <code>group_by</code> to group-by:</p>\n\n<pre><code>arr = [[\"dog\", \"named\", \"Bert\"],\n       [\"cat\", \"named\", \"Boots\"],\n       [\"dog\", \"named\", \"Hank\"],\n       [\"pig\", \"named\", \"Porky\"],\n       [\"cat\", \"named\", \"Tiger\"]]\n\narr.each_with_object(Hash.new { |h,k| h[k]=[] }) { |(f,*a),h| h[f] &lt;&lt; a }\n  # =&gt; {\"dog\"=&gt;[[\"named\", \"Bert\"], [\"named\", \"Hank\"]],\n  #     \"cat\"=&gt;[[\"named\", \"Boots\"], [\"named\", \"Tiger\"]],\n  #     \"pig\"=&gt;[[\"named\", \"Porky\"]]} \n</code></pre>\n\n<p>Note this doesn't mutate <code>arr</code>.</p>\n"}], "owner": {"reputation": 426, "user_id": 4637854, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/21b4842b1feb3ce6b2795df0af0f226f?s=128&d=identicon&r=PG&f=1", "display_name": "xxx", "link": "https://stackoverflow.com/users/4637854/xxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 34183478, "answer_count": 4, "score": -3, "last_activity_date": 1449682551, "creation_date": 1449675801, "question_id": 34182963, "link": "https://stackoverflow.com/questions/34182963/ruby-hash-of-arrays-remove-first-element-from-array", "title": "Ruby hash of arrays remove first element from array", "body": "<p>I have an array of arrays <code>arr = [[\"U6342\", \"2015-01-12\", \"Account\"],other similar arrays]</code></p>\n\n<p>then i group it by first element </p>\n\n<pre><code>arr.group_by(&amp;:first)\n =&gt; {\"U6342\"=&gt;[[\"U6342\", \"2015-01-12\", \"Account\"],other similar arrays]]\n</code></pre>\n\n<p>But i want to remove first element from all of arrays and get </p>\n\n<pre><code> =&gt; {\"U6342\"=&gt;[[ \"2015-01-12\", \"Account\"],other similar arrays]]\n</code></pre>\n\n<p>Is it possible?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "simple-form"], "comments": [{"owner": {"reputation": 3307, "user_id": 2266827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Frcc8.png?s=128&g=1", "display_name": "jeffdill2", "link": "https://stackoverflow.com/users/2266827/jeffdill2"}, "edited": false, "score": 0, "creation_date": 1449677053, "post_id": 34182858, "comment_id": 56113060, "body": "Why do you need to change that (assumedly working) <code>form_tag</code> to a <code>form_for</code>?"}, {"owner": {"reputation": 3307, "user_id": 2266827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Frcc8.png?s=128&g=1", "display_name": "jeffdill2", "link": "https://stackoverflow.com/users/2266827/jeffdill2"}, "edited": false, "score": 0, "creation_date": 1449677203, "post_id": 34182858, "comment_id": 56113157, "body": "The best way to see if the output is the same between the two is to run them and compare the output. Not trying to be facetious - that&#39;s just the only way to verify what you&#39;re trying to confirm."}, {"owner": {"reputation": 81, "user_id": 5636776, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/6KWhh.jpg?s=128&g=1", "display_name": "Green Chief", "link": "https://stackoverflow.com/users/5636776/green-chief"}, "reply_to_user": {"reputation": 3307, "user_id": 2266827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Frcc8.png?s=128&g=1", "display_name": "jeffdill2", "link": "https://stackoverflow.com/users/2266827/jeffdill2"}, "edited": false, "score": 0, "creation_date": 1449677710, "post_id": 34182858, "comment_id": 56113483, "body": "My issue is getting my older but working rails form helper code to work properly with the simple form gem...without too much run around. See below..."}, {"owner": {"reputation": 3307, "user_id": 2266827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Frcc8.png?s=128&g=1", "display_name": "jeffdill2", "link": "https://stackoverflow.com/users/2266827/jeffdill2"}, "edited": false, "score": 0, "creation_date": 1449679374, "post_id": 34182858, "comment_id": 56114730, "body": "Well, now you&#39;re talking about something completely different. <code>form_for</code> and <code>simple_form_for</code> are not the same thing. Your question is comparing <code>form_for</code> to <code>form_tag</code>."}, {"owner": {"reputation": 81, "user_id": 5636776, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/6KWhh.jpg?s=128&g=1", "display_name": "Green Chief", "link": "https://stackoverflow.com/users/5636776/green-chief"}, "reply_to_user": {"reputation": 3307, "user_id": 2266827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Frcc8.png?s=128&g=1", "display_name": "jeffdill2", "link": "https://stackoverflow.com/users/2266827/jeffdill2"}, "edited": false, "score": 0, "creation_date": 1449679561, "post_id": 34182858, "comment_id": 56114865, "body": "Yes, I guess I made a mistake. The first statement in the question should of been. &lt;% simple_form_for @user :url =&gt; {:action =&gt; &quot;attempt_login&quot;},  do |f| %&gt;"}, {"owner": {"reputation": 81, "user_id": 5636776, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/6KWhh.jpg?s=128&g=1", "display_name": "Green Chief", "link": "https://stackoverflow.com/users/5636776/green-chief"}, "reply_to_user": {"reputation": 3307, "user_id": 2266827, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/Frcc8.png?s=128&g=1", "display_name": "jeffdill2", "link": "https://stackoverflow.com/users/2266827/jeffdill2"}, "edited": false, "score": 0, "creation_date": 1449681102, "post_id": 34182858, "comment_id": 56115922, "body": "Well anyway... thanks for trying to help. It appears the following post had what I was looking for  <a href=\"https://stackoverflow.com/questions/4855801/rails-3-using-simple-form-how-do-i-create-a-form-that-do-a-post-to-specialities\" title=\"rails 3 using simple form how do i create a form that do a post to specialities\">stackoverflow.com/questions/4855801/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 5636776, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/6KWhh.jpg?s=128&g=1", "display_name": "Green Chief", "link": "https://stackoverflow.com/users/5636776/green-chief"}, "edited": false, "score": 0, "creation_date": 1449681055, "post_id": 34183037, "comment_id": 56115886, "body": "Thanks for trying to help... It appears the following post had what I was looking for  <a href=\"https://stackoverflow.com/questions/4855801/rails-3-using-simple-form-how-do-i-create-a-form-that-do-a-post-to-specialities\" title=\"rails 3 using simple form how do i create a form that do a post to specialities\">stackoverflow.com/questions/4855801/&hellip;</a>"}], "tags": [], "owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "is_accepted": false, "score": 2, "last_activity_date": 1449677131, "last_edit_date": 1449677131, "creation_date": 1449675994, "answer_id": 34183037, "question_id": 34182858, "link": "https://stackoverflow.com/questions/34182858/re-writing-rails-form-helper-in-simple-form/34183037#34183037", "title": "Re-writing Rails form helper in simple form", "body": "<p>The <strong><code>form_for</code></strong> is <em>usually</em> used for a specific record in order to <code>update</code> or <code>create</code> it.</p>\n\n<p>Example:</p>\n\n<pre><code># view in HAML (not ERB)\n= form_for @user do |f|\n  = f.text_field :username\n\n# matched with the routes\nresources :users\n</code></pre>\n\n<p>other example with nested resources:</p>\n\n<pre><code># routes.rb\nresources :users do\n  resources :posts\nend\n\n# view in HAML\n= form_for [@user, @post] do |f|\n  = f.text_field :content\n</code></pre>\n\n<p>Since you gave a record as an argument to the <code>form_for</code> method, it can \"pre-fill\" some fields of your record, i.e. if the <code>@user</code> already has a value for <code>username</code>, the field will be populated with that username.</p>\n\n<p>It is true that <strong>you can specify an action</strong> to the <code>form_for</code>, something like this:</p>\n\n<pre><code>= form_for @user, url: { action: :custom_action } do |f|\n</code></pre>\n\n<hr>\n\n<p>The <strong><code>form_tag</code></strong> is used for the \"<em>other forms</em>\", such as a <code>login</code> form or a specific controller's action to be done.</p>\n\n<p>Example:</p>\n\n<pre><code># view in HAML\n- form_tag action: :login do\n  = text_field_tag :username\n  = password_field_tag :password\n</code></pre>\n\n<hr>\n\n<p><strong>To conclude</strong>, I would (based on my opinion) use the <code>form_for</code> helper if you are actually using a model's instance in the form and trying to modify/create it. So <strong>in your case</strong>, I would not use the <code>form_for</code> helper but use the <code>form_tag</code> instead (because you want a login form).</p>\n"}, {"comments": [{"owner": {"reputation": 81, "user_id": 5636776, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/6KWhh.jpg?s=128&g=1", "display_name": "Green Chief", "link": "https://stackoverflow.com/users/5636776/green-chief"}, "edited": false, "score": 0, "creation_date": 1449708983, "post_id": 34185530, "comment_id": 56130168, "body": "Thanks for the answer!"}, {"owner": {"reputation": 81, "user_id": 5636776, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/6KWhh.jpg?s=128&g=1", "display_name": "Green Chief", "link": "https://stackoverflow.com/users/5636776/green-chief"}, "edited": false, "score": 0, "creation_date": 1449710016, "post_id": 34185530, "comment_id": 56130473, "body": "But would that work with   &lt;%= f.input :username %&gt; \t\t\t\t         &lt;%= f.input :password %&gt; \t\t\t\t         &lt;%= f.button :login %&gt;"}, {"owner": {"reputation": 1318, "user_id": 5586783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/060731280703cb6c69bff0df57eb8898?s=128&d=identicon&r=PG", "display_name": "Andy Gauge", "link": "https://stackoverflow.com/users/5586783/andy-gauge"}, "reply_to_user": {"reputation": 81, "user_id": 5636776, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/6KWhh.jpg?s=128&g=1", "display_name": "Green Chief", "link": "https://stackoverflow.com/users/5636776/green-chief"}, "edited": false, "score": 0, "creation_date": 1449752844, "post_id": 34185530, "comment_id": 56149923, "body": "Yes: <code>&lt;%= simple_form_for(:login, :action =&gt; &#39;attempt_login&#39;) do |f| %&gt;&lt;%=f.input :username %&gt;&lt;% end %&gt;</code>  It was a lot easier for me to do this than to replace all the syntax to prettify the forms.  In the controller though, You will need to update the <code>param[:username]</code> to <code>param[:login][:username]</code> etc"}], "tags": [], "owner": {"reputation": 1318, "user_id": 5586783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/060731280703cb6c69bff0df57eb8898?s=128&d=identicon&r=PG", "display_name": "Andy Gauge", "link": "https://stackoverflow.com/users/5586783/andy-gauge"}, "is_accepted": false, "score": 0, "last_activity_date": 1449683196, "creation_date": 1449683196, "answer_id": 34185530, "question_id": 34182858, "link": "https://stackoverflow.com/questions/34182858/re-writing-rails-form-helper-in-simple-form/34185530#34185530", "title": "Re-writing Rails form helper in simple form", "body": "<p>I recently migrated my form_tag methods to form_for because form_for was used in a gem that formatted my form using bootstrap.  This was for a login form with no model.  Here's how I used form_for without a model:</p>\n\n<pre><code>&lt;%= form_for(:login, :action =&gt; 'attempt_login') do %&gt;\n</code></pre>\n\n<p>I assume this works for simple_form as well:</p>\n\n<pre><code>&lt;%= simple_form_for(:login, :action =&gt; 'attempt_login') do %&gt;\n</code></pre>\n\n<p>Instead of using a <code>form_tag</code>, because the gem didn't decorate it, I used a <code>form_for</code> with a <code>:symbol</code> instead of a <code>@model</code></p>\n"}], "owner": {"reputation": 81, "user_id": 5636776, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/6KWhh.jpg?s=128&g=1", "display_name": "Green Chief", "link": "https://stackoverflow.com/users/5636776/green-chief"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 273, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1449683196, "creation_date": 1449675549, "last_edit_date": 1449676038, "question_id": 34182858, "link": "https://stackoverflow.com/questions/34182858/re-writing-rails-form-helper-in-simple-form", "title": "Re-writing Rails form helper in simple form", "body": "<p>Is the following line in Rails Simple form</p>\n\n<pre><code>&lt;% form_for @user :url =&gt; {:action =&gt; \"attempt_login\"},  do |f| %&gt;\n</code></pre>\n\n<p>The same as the following in Rails form helper?</p>\n\n<pre><code>&lt;%= form_tag(:action =&gt; 'attempt_login') do %&gt;\n</code></pre>\n\n<p>If not, can you tell me what it would be? I need to redo some form code and I would like write down the correct syntax before running the app...\nFor in the case of passing parameters (i.e. :action) the simple form documentation is rather ambiguous.\nThanks!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "voting", "acts-as-votable"], "comments": [{"owner": {"reputation": 16076, "user_id": 802618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6111449042dd940f360673d25d61ea6b?s=128&d=identicon&r=PG", "display_name": "Kristj&#225;n", "link": "https://stackoverflow.com/users/802618/kristj%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1449678059, "post_id": 34182834, "comment_id": 56113710, "body": "Look at your server logs when you click up/downvote - see anything wrong? What&#39;s the HTTP response? Are there any votes in the DB afterwards?"}, {"owner": {"reputation": 45, "user_id": 4194893, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/148353803e1e8a205759260b32d5b449?s=128&d=identicon&r=PG&f=1", "display_name": "Fergus Morton", "link": "https://stackoverflow.com/users/4194893/fergus-morton"}, "reply_to_user": {"reputation": 16076, "user_id": 802618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6111449042dd940f360673d25d61ea6b?s=128&d=identicon&r=PG", "display_name": "Kristj&#225;n", "link": "https://stackoverflow.com/users/802618/kristj%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1449678228, "post_id": 34182834, "comment_id": 56113841, "body": "@Kristj&#225;n I added the server log to the original post"}, {"owner": {"reputation": 16076, "user_id": 802618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6111449042dd940f360673d25d61ea6b?s=128&d=identicon&r=PG", "display_name": "Kristj&#225;n", "link": "https://stackoverflow.com/users/802618/kristj%c3%a1n"}, "edited": false, "score": 2, "creation_date": 1449678772, "post_id": 34182834, "comment_id": 56114295, "body": "Your log shows no <code>INSERT</code>s for the new vote. Is <code>@current_user.nil?</code> Should that be <code>current_user</code>?"}, {"owner": {"reputation": 45, "user_id": 4194893, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/148353803e1e8a205759260b32d5b449?s=128&d=identicon&r=PG&f=1", "display_name": "Fergus Morton", "link": "https://stackoverflow.com/users/4194893/fergus-morton"}, "reply_to_user": {"reputation": 16076, "user_id": 802618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6111449042dd940f360673d25d61ea6b?s=128&d=identicon&r=PG", "display_name": "Kristj&#225;n", "link": "https://stackoverflow.com/users/802618/kristj%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1449679369, "post_id": 34182834, "comment_id": 56114725, "body": "I think you are right, i changed it to  <code>current_user</code>. But I am now getting the error <code>undefined local variable or method </code>current_user&#39; ` even though it is defined in the <code>ApplicationHelper</code> in another method <code>def signed_in?</code>"}, {"owner": {"reputation": 16076, "user_id": 802618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6111449042dd940f360673d25d61ea6b?s=128&d=identicon&r=PG", "display_name": "Kristj&#225;n", "link": "https://stackoverflow.com/users/802618/kristj%c3%a1n"}, "edited": false, "score": 0, "creation_date": 1449679649, "post_id": 34182834, "comment_id": 56114937, "body": "Helpers aren&#39;t loaded in controllers unless you&#39;ve explicitly <code>include</code>d them, and naming things the same <a href=\"https://stackoverflow.com/questions/34138265/variable-defined-in-a-function-throws-nameerror-global-name-not-defined-when-us/34138511#34138511\">doesn&#39;t make them the same</a>. You probably want to write a <code>current_user</code> method in <code>ApplicationController</code>, or run a <code>before_action</code> that sets <code>@current_user</code>, which will persist for the duration of the action."}, {"owner": {"reputation": 2353, "user_id": 4765497, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0217f81111ddda08859b0d6cca6de0b9?s=128&d=identicon&r=PG&f=1", "display_name": "Amr Noman", "link": "https://stackoverflow.com/users/4765497/amr-noman"}, "edited": false, "score": 0, "creation_date": 1449679738, "post_id": 34182834, "comment_id": 56114996, "body": "@FergusMorton <code>ApplicationHelper</code> methods are visible to your views, if you want to use them in your controllers you&#39;ll have to either <code>include ApplicationHelper</code> in your <code>application_controller.rb</code> or define your method in that file directly."}], "answers": [{"tags": [], "owner": {"reputation": 45, "user_id": 4194893, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/148353803e1e8a205759260b32d5b449?s=128&d=identicon&r=PG&f=1", "display_name": "Fergus Morton", "link": "https://stackoverflow.com/users/4194893/fergus-morton"}, "is_accepted": false, "score": 0, "last_activity_date": 1449679647, "creation_date": 1449679647, "answer_id": 34184329, "question_id": 34182834, "link": "https://stackoverflow.com/questions/34182834/acts-as-votable-not-working-when-i-upvote-downvote/34184329#34184329", "title": "acts_as_votable not working when I upvote/downvote", "body": "<p>Thanks to the help of Kristjan I realised there was no insertion happening. I defined current_user within the upvote and downvote methods. The revised working versions look like so.</p>\n\n<pre><code> def upvote\n  current_user = User.find_by_id(session[:user_id])\n  @treatment = Treatment.find(params[:id])\n  @treatment.upvote_by current_user\n\n  render 'show'\nend\n\ndef downvote\n  current_user = User.find_by_id(session[:user_id])\n  @treatment = Treatment.find(params[:id])\n  @treatment.downvote_by current_user\n\n  render 'show'\nend\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 4194893, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/148353803e1e8a205759260b32d5b449?s=128&d=identicon&r=PG&f=1", "display_name": "Fergus Morton", "link": "https://stackoverflow.com/users/4194893/fergus-morton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 344, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449679647, "creation_date": 1449675482, "last_edit_date": 1449678289, "question_id": 34182834, "link": "https://stackoverflow.com/questions/34182834/acts-as-votable-not-working-when-i-upvote-downvote", "title": "acts_as_votable not working when I upvote/downvote", "body": "<p>I am trying to allow <code>treatment</code> to be votable with upvotes or downvotes but the methods provided by act_as_votable don't seem to be working as intended. When I try to display the sum of upvotes-downvotes it returns 0 each time, implying votes aren't registering like they should.</p>\n\n<p>My <code>treatments_controller.rb</code></p>\n\n<pre><code>def upvote\n  @treatment = Treatment.find(params[:id])\n  @treatment.upvote_by @current_user\n\n  render 'show'\nend\n\ndef downvote\n  @treatment = Treatment.find(params[:id])\n  @treatment.downvote_by @current_user\n\n  redirect_to treatments_path\nend\n</code></pre>\n\n<p>My <code>treatment.rb</code></p>\n\n<pre><code>class Treatment &lt; ActiveRecord::Base\nacts_as_votable\n\n\n has_many :review\n has_one :service\n\n\n    def score\n  self.get_upvotes.size - self.get_downvotes.size\nend\n\nend\n</code></pre>\n\n<p>My <code>routes.rb</code></p>\n\n<pre><code>resources :treatments do\n  member do\n    put \"like\", to: \"treatments#upvote\"\n    put \"dislike\", to: \"treatments#downvote\"\n  end\nend\n</code></pre>\n\n<p>And my <code>treatments/show.html.erb</code></p>\n\n<pre><code>&lt;div class=\"container\"&gt;\n    &lt;div class=\"row\"&gt;\n      &lt;div class=\"col-sx-12 col-sm-12 col-md-8\"&gt;\n        &lt;h3&gt;&lt;%= @treatment.name %&gt;&lt;/h3&gt;&lt;/br&gt;&lt;/br&gt;\n &lt;h3&gt;\n           &lt;%= link_to \"upvote\", like_treatment_path(@treatment), method: :put %&gt;&lt;/br&gt;\n            &lt;%= link_to \"downvote\", dislike_treatment_path(@treatment), method: :put %&gt;&lt;/br&gt;\n            &lt;%= @treatment.score %&gt;&lt;/br&gt; &lt;/h3&gt;\n</code></pre>\n\n<p>The server log says the following </p>\n\n<pre><code>Started PUT \"/treatments/1/like\" for ::1 at 2015-12-09 16:22:14 +0000\nProcessing by TreatmentsController#upvote as HTML\n  Parameters: {\"authenticity_token\"=&gt;\"hQnqV+OZ6m/9kFnr5YH6j563DIjyKfA4K/8fH6kpFbXbJRbsHCcNYn1AX4usZmUNXPlnFpxHMwTM8ilFxcbdhQ==\", \"id\"=&gt;\"1\"}\nGeokit is using the domain: localhost\n  Treatment Load (0.5ms)  SELECT  \"treatments\".* FROM \"treatments\" WHERE \"treatments\".\"id\" = ? LIMIT 1  [[\"id\", 1]]\n   (0.5ms)  SELECT COUNT(*) FROM \"votes\" WHERE \"votes\".\"votable_id\" = ? AND \"votes\".\"votable_type\" = ? AND \"votes\".\"vote_flag\" = ? AND \"votes\".\"vote_scope\" IS NULL  [[\"votable_id\", 1], [\"votable_type\", \"Treatment\"], [\"vote_flag\", \"t\"]]\n   (0.0ms)  SELECT COUNT(*) FROM \"votes\" WHERE \"votes\".\"votable_id\" = ? AND \"votes\".\"votable_type\" = ? AND \"votes\".\"vote_flag\" = ? AND \"votes\".\"vote_scope\" IS NULL  [[\"votable_id\", 1], [\"votable_type\", \"Treatment\"], [\"vote_flag\", \"f\"]]\n  Rendered treatments/show.html.erb within layouts/application (6.5ms)\n  User Load (0.0ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = ? LIMIT 1  [[\"id\", 4]]\nCompleted 200 OK in 569ms (Views: 563.3ms | ActiveRecord: 1.0ms)\n</code></pre>\n"}, {"tags": ["ruby", "rspec", "watir", "page-object-gem", "rspec-expectations"], "comments": [{"owner": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1449674714, "post_id": 34182291, "comment_id": 56111248, "body": "are these html elements?"}, {"owner": {"reputation": 199, "user_id": 4389785, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/hu07Y.png?s=128&g=1", "display_name": "Den Silver", "link": "https://stackoverflow.com/users/4389785/den-silver"}, "reply_to_user": {"reputation": 14010, "user_id": 3109182, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/a4b305f0077055b4fdcf715067775d5a?s=128&d=identicon&r=PG", "display_name": "Anthony", "link": "https://stackoverflow.com/users/3109182/anthony"}, "edited": false, "score": 0, "creation_date": 1449675071, "post_id": 34182291, "comment_id": 56111517, "body": "Yes, they are. Described via Page-Object"}, {"owner": {"reputation": 2080, "user_id": 1033737, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/iJ3qS.jpg?s=128&g=1", "display_name": "thefabbulus", "link": "https://stackoverflow.com/users/1033737/thefabbulus"}, "edited": false, "score": 0, "creation_date": 1449675365, "post_id": 34182291, "comment_id": 56111737, "body": "can you share the part of html code you want to work on?"}, {"owner": {"reputation": 199, "user_id": 4389785, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/hu07Y.png?s=128&g=1", "display_name": "Den Silver", "link": "https://stackoverflow.com/users/4389785/den-silver"}, "edited": false, "score": 0, "creation_date": 1449675703, "post_id": 34182291, "comment_id": 56112007, "body": "It is just a simple TD which becomes visible/invisible when I check/uncheck checkbox. When I check visibility <code>expect(actual).to all(be_visible)</code> it works. But I need a method for check invisible."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1449675730, "post_id": 34182291, "comment_id": 56112029, "body": "<code>expect(actual).to none(be_visible)</code>"}, {"owner": {"reputation": 199, "user_id": 4389785, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/hu07Y.png?s=128&g=1", "display_name": "Den Silver", "link": "https://stackoverflow.com/users/4389785/den-silver"}, "edited": false, "score": 0, "creation_date": 1449676000, "post_id": 34182291, "comment_id": 56112264, "body": "Types <code>undefined method &#39;none&#39; for</code>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1449677100, "post_id": 34182291, "comment_id": 56113090, "body": "Oh, indeed. Strange. Anyway: <code>expect(actual.map(&amp;:visible?)).to all(be_falsey)</code>"}, {"owner": {"reputation": 199, "user_id": 4389785, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/hu07Y.png?s=128&g=1", "display_name": "Den Silver", "link": "https://stackoverflow.com/users/4389785/den-silver"}, "edited": false, "score": 0, "creation_date": 1449677226, "post_id": 34182291, "comment_id": 56113169, "body": "Thank you. It is closer for idea."}], "answers": [{"tags": [], "owner": {"reputation": 13, "user_id": 5807083, "user_type": "registered", "profile_image": "https://graph.facebook.com/10103894416245702/picture?type=large", "display_name": "Justin Watts", "link": "https://stackoverflow.com/users/5807083/justin-watts"}, "is_accepted": false, "score": 1, "last_activity_date": 1454181293, "last_edit_date": 1454181293, "creation_date": 1453762615, "answer_id": 35004069, "question_id": 34182291, "link": "https://stackoverflow.com/questions/34182291/check-elements-from-array-are-not-visible/35004069#35004069", "title": "Check elements from array are not visible", "body": "<p>You can check the array without iterating through it yourself but using the include &amp; all matchers/modifiers. The best ones for this case would be .not_to + include.</p>\n\n<pre><code>expect(names).not_to include(be_visible)\n</code></pre>\n\n<p>A less sexy solution would be to match !(false) which = true. </p>\n\n<pre><code>expect(names).to all(!(be_visible))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4154, "user_id": 3123370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7856610653d1a0b44bf049c3d20b2a68?s=128&d=identicon&r=PG", "display_name": "MilesStanfield", "link": "https://stackoverflow.com/users/3123370/milesstanfield"}, "is_accepted": false, "score": 1, "last_activity_date": 1453828903, "last_edit_date": 1453828903, "creation_date": 1453780117, "answer_id": 35006782, "question_id": 34182291, "link": "https://stackoverflow.com/questions/34182291/check-elements-from-array-are-not-visible/35006782#35006782", "title": "Check elements from array are not visible", "body": "<p>Loop through each name and ensure the page does not have that text:</p>\n\n<pre><code>names=['tdColumn1','tdColumn2','tdColumn3']\n\nnames.each do |name|\n  expect(page).not_to have_text name\nend\n</code></pre>\n"}], "owner": {"reputation": 199, "user_id": 4389785, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/hu07Y.png?s=128&g=1", "display_name": "Den Silver", "link": "https://stackoverflow.com/users/4389785/den-silver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1454181293, "creation_date": 1449674000, "last_edit_date": 1449681381, "question_id": 34182291, "link": "https://stackoverflow.com/questions/34182291/check-elements-from-array-are-not-visible", "title": "Check elements from array are not visible", "body": "<p>I have an array with elements' names:</p>\n\n<pre><code>names=['tdColumn1','tdColumn2','tdColumn3']\n</code></pre>\n\n<p>And I wan't to check that they are not visible:</p>\n\n<pre><code>expect(actual).to all(not_be_visible)\n</code></pre>\n\n<p>But <code>be_not_visible</code>, <code>not_visible</code>, <code>not_be_visible</code>, <code>.not_to all(be_visible)</code> are not correct methods.\nWhat method is correct?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "devise"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2536065"}, "edited": false, "score": 0, "creation_date": 1449674227, "post_id": 34182027, "comment_id": 56110899, "body": "Can you also show the route for <code>index</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 23981, "user_id": 2813589, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/9axBj.jpg?s=128&g=1", "display_name": "\u30a2\u30ec\u30c3\u30af\u30b9", "link": "https://stackoverflow.com/users/2813589/%e3%82%a2%e3%83%ac%e3%83%83%e3%82%af%e3%82%b9"}, "is_accepted": false, "score": 1, "last_activity_date": 1449673799, "creation_date": 1449673799, "answer_id": 34182213, "question_id": 34182027, "link": "https://stackoverflow.com/questions/34182027/got-activerecordrecordnotfound-message-while-trying-to-retrieve-data-from-othe/34182213#34182213", "title": "Got ActiveRecord::RecordNotFound message while trying to retrieve data from other controller model", "body": "<p>That's because params[:id] is empty because there's no id in the url. You should change your code accordingly.</p>\n"}, {"tags": [], "owner": {"reputation": 1318, "user_id": 5586783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/060731280703cb6c69bff0df57eb8898?s=128&d=identicon&r=PG", "display_name": "Andy Gauge", "link": "https://stackoverflow.com/users/5586783/andy-gauge"}, "is_accepted": false, "score": 0, "last_activity_date": 1449674116, "creation_date": 1449674116, "answer_id": 34182332, "question_id": 34182027, "link": "https://stackoverflow.com/questions/34182027/got-activerecordrecordnotfound-message-while-trying-to-retrieve-data-from-othe/34182332#34182332", "title": "Got ActiveRecord::RecordNotFound message while trying to retrieve data from other controller model", "body": "<p>Your controller is expecting a User(id) and a Post(id) from the same variable (id)</p>\n\n<p>To get the page to load, you would need to access it using:</p>\n\n<pre><code>/index/home/?id=1\n</code></pre>\n\n<p>The problem is though, that you are looking up your Posts and Users by the same parameter.  You probably were looking for this:</p>\n\n<pre><code>@posts = @user.posts\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2536065"}, "is_accepted": false, "score": 0, "last_activity_date": 1449675127, "creation_date": 1449675127, "answer_id": 34182697, "question_id": 34182027, "link": "https://stackoverflow.com/questions/34182027/got-activerecordrecordnotfound-message-while-trying-to-retrieve-data-from-othe/34182697#34182697", "title": "Got ActiveRecord::RecordNotFound message while trying to retrieve data from other controller model", "body": "<p>It seems your code is trying to get the User by the id that is passed in the url for the home action. Since you are using devise, you can get the current signed in user by using the <code>current_user</code> helper method. If there is no signed in User, then <code>current_user</code> will return <code>nil</code>.</p>\n\n<p>Your code also seems to want to set <code>@posts</code> as the User's posts, filtered by the index type. Assuming that you have an <code>index_type</code> attribute set in the Post model, you could get the posts that belong to that user like this:</p>\n\n<pre><code>def home\n  @posts = set_posts\nend\n\ndef sports\n  @posts = set_posts(\"sports\")\nend\n\nprivate\ndef set_posts(type = %w{sports politics other})\n  current_user.posts.where(index_type: type)\nend\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 3859839, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RTE5f.jpg?s=128&g=1", "display_name": "C.K", "link": "https://stackoverflow.com/users/3859839/c-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1449675127, "creation_date": 1449673271, "question_id": 34182027, "link": "https://stackoverflow.com/questions/34182027/got-activerecordrecordnotfound-message-while-trying-to-retrieve-data-from-othe", "title": "Got ActiveRecord::RecordNotFound message while trying to retrieve data from other controller model", "body": "<p>I am trying to build a site kind like news website. Users are able to post articles, and those articles would be classified into different categories, such as sports, politics...etc. </p>\n\n<p>The thought was to have an index controller, which contains home/sports/politics...methods to make the url like xxx.com/index/home, xxx.com/index/sports. The home page will show every article. However I got the ActiveRecord::RecordNotFound message when trying to get data. </p>\n\n<p>There are 3 controllers so far. \n 1. Index \n 2. User (using devise)\n 3. Post (with post model)</p>\n\n<p>In Index controller: </p>\n\n<pre><code>class IndexController &lt; ApplicationController\nbefore_filter :find_post\n\ndef home\nend\n\ndef find_post\n@user = User.find(params[:id])\n@posts = @user.posts.find(params[:id])\nend\nend\n</code></pre>\n\n<p>In post model:</p>\n\n<pre><code>class Post &lt; ActiveRecord::Base\nbelongs_to :user\nvalidates :content, presence: true\nend\n</code></pre>\n\n<p>the route.rb contains</p>\n\n<pre><code>Rails.application.routes.draw do\ndevise_for :users\nresources :posts\n</code></pre>\n\n<p>while I ran /index/home page I got the message\nActiveRecord::RecordNotFound in IndexController#home\nCouldn't find User with 'id'=</p>\n\n<p>Extracted source (around line #39):\n37  def find_post\n38<br>\n39    @user = User.find(params[:id])</p>\n"}, {"tags": ["ruby", "postgresql", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 1, "creation_date": 1449673909, "post_id": 34182012, "comment_id": 56110653, "body": "Your code looks correct. The docs say that the argument should be a &quot;string, array, or hash representing the SET part of an SQL statement.&quot; What problem are you having?"}, {"owner": {"reputation": 3331, "user_id": 994210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32122073312c9c8b4c6a05f4c1257516?s=128&d=identicon&r=PG", "display_name": "Tom L", "link": "https://stackoverflow.com/users/994210/tom-l"}, "edited": false, "score": 0, "creation_date": 1449674736, "post_id": 34182012, "comment_id": 56111266, "body": "I don&#39;t think update_all is going to work in this case. You may need to use raw SQL (<code>ActiveRecord::Base.connection.execute(&quot;...&quot;)</code>) where you hold the value in a variable while swapping. I&#39;m not familiar with how to do that in PostGreSQL. The other option is to rename the columns. That will also require a bit of juggling because you can&#39;t have two columns with the same name at the same time."}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "reply_to_user": {"reputation": 3331, "user_id": 994210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32122073312c9c8b4c6a05f4c1257516?s=128&d=identicon&r=PG", "display_name": "Tom L", "link": "https://stackoverflow.com/users/994210/tom-l"}, "edited": false, "score": 2, "creation_date": 1449679992, "post_id": 34182012, "comment_id": 56115171, "body": "@TomL Suprisingly, it looks like in PostgreSQL <code>UPDATE tbl SET a = b, b = c</code> works fine: <a href=\"http://sqlfiddle.com/#!15/82461/1\" rel=\"nofollow noreferrer\">sqlfiddle.com/#!15/82461/1</a> Without knowing what problem Molle is having, though, it&#39;s hard to say what the right solution in Rails is."}, {"owner": {"reputation": 3331, "user_id": 994210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32122073312c9c8b4c6a05f4c1257516?s=128&d=identicon&r=PG", "display_name": "Tom L", "link": "https://stackoverflow.com/users/994210/tom-l"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 1, "creation_date": 1449690235, "post_id": 34182012, "comment_id": 56121486, "body": "@Jordan you are quite correct.  I was thinking about it as more of a &quot;b to a and a to b&quot; type of thing but that&#39;s not it. I don&#39;t see the problem either."}, {"owner": {"reputation": 108, "user_id": 2789760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d379668fa385646c9a162a8179b2b68c?s=128&d=identicon&r=PG&f=1", "display_name": "Molle", "link": "https://stackoverflow.com/users/2789760/molle"}, "edited": false, "score": 0, "creation_date": 1449763649, "post_id": 34182012, "comment_id": 56157509, "body": "Thanks for the anwsers guys! You are correct and it works fine. The problem was me selecting the wrong values in the view after a copy paste.. my bad."}], "owner": {"reputation": 108, "user_id": 2789760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d379668fa385646c9a162a8179b2b68c?s=128&d=identicon&r=PG&f=1", "display_name": "Molle", "link": "https://stackoverflow.com/users/2789760/molle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 297, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1449673244, "creation_date": 1449673244, "question_id": 34182012, "link": "https://stackoverflow.com/questions/34182012/using-rails-update-all-to-copy-current-value-from-other-cell", "title": "Using rails update_all to copy current value from other cell?", "body": "<p>I'm developing an rails 4 (using postgresql) app where performance is important. With that said I would like to not have to loop through my object to update these columns. I would be happy if it's possible to achieve what I'm trying to do with update_all/as few db queries as possible.</p>\n\n<p>To the problem. Say I have model User with three columns a,b,c.</p>\n\n<p>I want to update column a with the current value of column b and then put the current value of column c into b (without it affecting column a).</p>\n\n<p>I Tried with both:</p>\n\n<p>1)</p>\n\n<pre><code>User.update_all('a = b, b = c')\n</code></pre>\n\n<p>2) </p>\n\n<pre><code>User.update_all('a = b')\nUser.update_all('b = c')\n</code></pre>\n\n<p>I'm guessing the columns get linked on db level. But is there any way to achieve what I'm trying to do without selecting the values from each row?</p>\n"}, {"tags": ["ruby", "database", "list", "sorting", "search"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 5659722, "user_type": "registered", "profile_image": "https://graph.facebook.com/1034280346616247/picture?type=large", "display_name": "Domantas Namikaze", "link": "https://stackoverflow.com/users/5659722/domantas-namikaze"}, "edited": false, "score": 0, "creation_date": 1449753526, "post_id": 34184518, "comment_id": 56150367, "body": "And how i would call for books from array(list all books and their information )  ? Because if i try&quot; puts book_array&quot; it gives me bunch of numbers like this :#&lt;Book:0x27eb860&gt; #&lt;Book:0x27eb800&gt; #&lt;Book:0x27eb7a0&gt;"}, {"owner": {"reputation": 10812, "user_id": 1241782, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/576b21d9efadc9217270e971fd6d5027?s=128&d=identicon&r=PG", "display_name": "Mike S", "link": "https://stackoverflow.com/users/1241782/mike-s"}, "reply_to_user": {"reputation": 3, "user_id": 5659722, "user_type": "registered", "profile_image": "https://graph.facebook.com/1034280346616247/picture?type=large", "display_name": "Domantas Namikaze", "link": "https://stackoverflow.com/users/5659722/domantas-namikaze"}, "edited": false, "score": 0, "creation_date": 1449763707, "post_id": 34184518, "comment_id": 56157549, "body": "It&#39;s giving you numbers because you&#39;re printing out the Object and its ID, rather the contents of its attributes (name, author, genre). You can easily change that behavior by overriding the default <code>to_s</code> functionality and formatting the string however you want. I added an example to my answer."}, {"owner": {"reputation": 3, "user_id": 5659722, "user_type": "registered", "profile_image": "https://graph.facebook.com/1034280346616247/picture?type=large", "display_name": "Domantas Namikaze", "link": "https://stackoverflow.com/users/5659722/domantas-namikaze"}, "edited": false, "score": 0, "creation_date": 1449845761, "post_id": 34184518, "comment_id": 56196583, "body": "Thank You very much for your help, you are life saver."}, {"owner": {"reputation": 10812, "user_id": 1241782, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/576b21d9efadc9217270e971fd6d5027?s=128&d=identicon&r=PG", "display_name": "Mike S", "link": "https://stackoverflow.com/users/1241782/mike-s"}, "reply_to_user": {"reputation": 3, "user_id": 5659722, "user_type": "registered", "profile_image": "https://graph.facebook.com/1034280346616247/picture?type=large", "display_name": "Domantas Namikaze", "link": "https://stackoverflow.com/users/5659722/domantas-namikaze"}, "edited": false, "score": 0, "creation_date": 1449871617, "post_id": 34184518, "comment_id": 56210484, "body": "@DomantasNamikaze You&#39;re welcome. It is typically good etiquette to accept the answer if your question is resolved :)"}], "tags": [], "owner": {"reputation": 10812, "user_id": 1241782, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/576b21d9efadc9217270e971fd6d5027?s=128&d=identicon&r=PG", "display_name": "Mike S", "link": "https://stackoverflow.com/users/1241782/mike-s"}, "is_accepted": true, "score": 0, "last_activity_date": 1449763719, "last_edit_date": 1449763719, "creation_date": 1449680098, "answer_id": 34184518, "question_id": 34181947, "link": "https://stackoverflow.com/questions/34181947/how-to-create-list-of-information-and-later-search-and-sort-that-information/34184518#34184518", "title": "How to create list of information and later search and sort that information?", "body": "<p>You can create a <code>Book</code> class and then store those objects in an <code>Array</code>. It's pretty straight forward but you may want to read a little about Ruby and Object Oriented Programming.</p>\n\n<pre><code>class Book\n  attr_accessor :name\n  attr_accessor :author\n  attr_accessor :genre\n\n  def initialize name, author, genre\n    @name = name\n    @author = author\n    @genre = genre\n  end\n\n  def to_s\n    \"book name: \" + @name + \"\\nauthor: \" + @author + \"\\ngenre: \" + @genre\n  end\nend\n\n# create a few books\nbook_one = Book.new(\"Scary Book\",\"Michael\", \"horror\")\nbook_two = Book.new(\"Long Book\", \"Jim\", \"comedy\")\nbook_three = Book.new(\"Short Book\", \"Pam\", \"romance\")\n\n# store them in an Array for sorting and searching\nbook_array = [book_one, book_two, book_three]\n\n# sort the array by author\nsorted_array = book_array.sort_by {|book| book.author}\n\n# find the book(s) in the \"romance\" genre\nromance_books = book_array.select {|book| book.genre == \"romance\"}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 5659722, "user_type": "registered", "profile_image": "https://graph.facebook.com/1034280346616247/picture?type=large", "display_name": "Domantas Namikaze", "link": "https://stackoverflow.com/users/5659722/domantas-namikaze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "accepted_answer_id": 34184518, "answer_count": 1, "score": 0, "last_activity_date": 1449763719, "creation_date": 1449673049, "question_id": 34181947, "link": "https://stackoverflow.com/questions/34181947/how-to-create-list-of-information-and-later-search-and-sort-that-information", "title": "How to create list of information and later search and sort that information?", "body": "<p>I need to create simple book information list (database within code) which contain author, genre, name, release date and page number. And later search by author(sort by date, search by genre(sort by author). What is simplest way to do this ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "coding-style", "refactoring"], "answers": [{"tags": [], "owner": {"reputation": 72, "user_id": 985897, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aff5ca6e759d9c3c2c3ce8996ff531fe?s=128&d=identicon&r=PG", "display_name": "Alexandr Zavalny", "link": "https://stackoverflow.com/users/985897/alexandr-zavalny"}, "is_accepted": false, "score": 0, "last_activity_date": 1449673110, "creation_date": 1449673110, "answer_id": 34181966, "question_id": 34181856, "link": "https://stackoverflow.com/questions/34181856/rails-refactoring-more-efficient-activerecord-queries-and-condition-testing/34181966#34181966", "title": "Rails Refactoring: More efficient ActiveRecord Queries and Condition Testing", "body": "<p>Well, first of all you are now always doing 2 queries. 1 - to get present?, second to get either books or Articles. </p>\n\n<p>You can improve by changing code so that is selects books and if there are none, then returns articles. </p>\n\n<pre><code>def writings  \n  books = Books.where(author_id: 1) \n  if books.size &gt; 0 \n    books\n  else\n    Articles.where(author_id: 2)  \n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 51013, "user_id": 976775, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30bd66ad1795804aebe249d8bcb14409?s=128&d=identicon&r=PG", "display_name": "MrYoshiji", "link": "https://stackoverflow.com/users/976775/mryoshiji"}, "is_accepted": true, "score": 1, "last_activity_date": 1449673619, "creation_date": 1449673619, "answer_id": 34182144, "question_id": 34181856, "link": "https://stackoverflow.com/questions/34181856/rails-refactoring-more-efficient-activerecord-queries-and-condition-testing/34182144#34182144", "title": "Rails Refactoring: More efficient ActiveRecord Queries and Condition Testing", "body": "<p>You can use the <a href=\"http://apidock.com/rails/Object/presence\" rel=\"nofollow\"><code>presence</code></a> method combined with a double pipe:</p>\n\n<pre><code>def writings\n  Books.where(author_id: 1).presence || Articles.where(author_id: 2)\nend\n</code></pre>\n\n<hr>\n\n<p>From the documentation: <a href=\"http://apidock.com/rails/Object/presence\" rel=\"nofollow\">http://apidock.com/rails/Object/presence</a></p>\n\n<blockquote>\n  <p><code>presence() public</code></p>\n  \n  <p>Returns the receiver if it\u2019s present otherwise returns <code>nil</code>.</p>\n</blockquote>\n\n<p>Some examples:</p>\n\n<pre><code>true.presence # =&gt; true\n1.presence # =&gt; 1\nfalse.presence # =&gt; nil\n[].presence # =&gt; nil\n''.presence # =&gt; nil\nUser.where(id: -1).presence # =&gt; nil\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7188, "user_id": 597358, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/549be4b1e60fe2cbf6b0724802961705?s=128&d=identicon&r=PG", "display_name": "messanjah", "link": "https://stackoverflow.com/users/597358/messanjah"}, "is_accepted": false, "score": 1, "last_activity_date": 1449678303, "creation_date": 1449678303, "answer_id": 34183866, "question_id": 34181856, "link": "https://stackoverflow.com/questions/34181856/rails-refactoring-more-efficient-activerecord-queries-and-condition-testing/34183866#34183866", "title": "Rails Refactoring: More efficient ActiveRecord Queries and Condition Testing", "body": "<p>Consider implementing <code>counter_cache</code> on both Book and Article models.</p>\n\n<pre><code># class Book\nbelongs_to :author, counter_cache: true\n\n# class Article\nbelongs_to :author, counter_cache: true\n</code></pre>\n\n<p>Read more about counter caching <a href=\"http://guides.rubyonrails.org/association_basics.html#the-belongs-to-association\" rel=\"nofollow\">here</a>.</p>\n\n<p>Then you can inspect the value of <code>books_count</code> before running any queries.</p>\n\n<pre><code># class Author\n# assumes has_many :books\n# and     has_many :articles\ndef writings\n  if books_count.nonzero?\n    books\n  else\n    articles\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 8019, "user_id": 534003, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2d250e077cb530cf6ef4c9ea77105ad0?s=128&d=identicon&r=PG&f=1", "display_name": "csi", "link": "https://stackoverflow.com/users/534003/csi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 34182144, "answer_count": 3, "score": 1, "last_activity_date": 1449678303, "creation_date": 1449672784, "question_id": 34181856, "link": "https://stackoverflow.com/questions/34181856/rails-refactoring-more-efficient-activerecord-queries-and-condition-testing", "title": "Rails Refactoring: More efficient ActiveRecord Queries and Condition Testing", "body": "<p>In a model I am trying to return a conditional ActiveRecord result set.  If the author has written books, return those.  If the author hasn't written any books, return articles.  This works:  </p>\n\n<pre><code>def writings  \n  Books.where(author_id: 1).present? ? Books.where(author_id: 1)  : Articles.where(author_id: 2)  \nend\n</code></pre>\n\n<p>How can this be improved<br>\n1.  When checking conditions and setting values, i.e not executing the <code>Books.where</code> query twice?<br>\n2.  From a performance standpoint  </p>\n\n<p>I'm working on improving my efficiency and style and often use either <a href=\"https://github.com/bbatsov/ruby-style-guide\" rel=\"nofollow\">Style Guide bbatsov</a> or the <a href=\"https://github.com/styleguide/ruby\" rel=\"nofollow\">addition</a>.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "wrapper"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1449678757, "post_id": 34181617, "comment_id": 56114281, "body": "That&#39;s an array of hashes, one for each artist. It looks like each hash has a <code>:name</code> element for the artist&#39;s name and an <code>:mbid</code> element which can be used to perform further queries, as in the README: <code>@kasabian = MusicBrainz::Artist.find(&quot;69b39eab-6577-46a4-a9f5-8178390920&zwnj;&#8203;33&quot;)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 504, "user_id": 4357700, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0e0c2f562f1ed55fab85f543069b8a40?s=128&d=identicon&r=PG&f=1", "display_name": "Bastien", "link": "https://stackoverflow.com/users/4357700/bastien"}, "edited": false, "score": 0, "creation_date": 1449755059, "post_id": 34183683, "comment_id": 56151330, "body": "What would be the appropriate syntax if I want to put this in a view template? This does not seem to work: &lt;% @suggestions.each do |suggestion| %&gt; &lt;% suggestion[:name] %&gt; &lt;% end %&gt;"}, {"owner": {"reputation": 6200, "user_id": 637094, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fd50f61387b63900335c8556f86237be?s=128&d=identicon&r=PG", "display_name": "Leonel Gal&#225;n", "link": "https://stackoverflow.com/users/637094/leonel-gal%c3%a1n"}, "reply_to_user": {"reputation": 504, "user_id": 4357700, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0e0c2f562f1ed55fab85f543069b8a40?s=128&d=identicon&r=PG&f=1", "display_name": "Bastien", "link": "https://stackoverflow.com/users/4357700/bastien"}, "edited": false, "score": 0, "creation_date": 1449859768, "post_id": 34183683, "comment_id": 56204700, "body": "How it doesn&#39;t work? Perhaps you are missing the <code>&lt;%=</code> so the name is not being printed? Also try a debugger (prybug, for example) and tell me what value @suggestions hold, what about suggestion when inside the loop?"}], "tags": [], "owner": {"reputation": 6200, "user_id": 637094, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/fd50f61387b63900335c8556f86237be?s=128&d=identicon&r=PG", "display_name": "Leonel Gal&#225;n", "link": "https://stackoverflow.com/users/637094/leonel-gal%c3%a1n"}, "is_accepted": true, "score": 0, "last_activity_date": 1449677795, "creation_date": 1449677795, "answer_id": 34183683, "question_id": 34181617, "link": "https://stackoverflow.com/questions/34181617/musicbrainz-web-service-on-ruby-on-rails-wrapper-questions/34183683#34183683", "title": "MusicBrainz web service on Ruby on Rails wrapper questions", "body": "<p>Put it anywhere you want, just before you use it (probably not the best place) or on a initializer (go ahead and try this path first)</p>\n\n<p>Yeah, most API wrappers return a Hash or a object wrapping a Hash, that's because they are simply translating JSON (or XML) to Ruby. BTW, what you got is an array of hashes, loop through them and you will have the information you need:</p>\n\n<pre><code>@suggestions.each do |suggestion|\n  puts suggestion[:name]\nend\n</code></pre>\n\n<p>What you do with it is up to yo.</p>\n"}], "owner": {"reputation": 504, "user_id": 4357700, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/0e0c2f562f1ed55fab85f543069b8a40?s=128&d=identicon&r=PG&f=1", "display_name": "Bastien", "link": "https://stackoverflow.com/users/4357700/bastien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 34183683, "answer_count": 1, "score": 0, "last_activity_date": 1449680499, "creation_date": 1449672192, "last_edit_date": 1449680499, "question_id": 34181617, "link": "https://stackoverflow.com/questions/34181617/musicbrainz-web-service-on-ruby-on-rails-wrapper-questions", "title": "MusicBrainz web service on Ruby on Rails wrapper questions", "body": "<p>I am trying to use the following music wrapper</p>\n\n<p><a href=\"https://github.com/localhots/musicbrainz\" rel=\"nofollow\">https://github.com/localhots/musicbrainz</a></p>\n\n<p>The readme is too minimalist for me and I am not sure how to use this service wrapper. First, the readme mentions the following information on configuration</p>\n\n<pre><code>MusicBrainz.configure do |c|\n  # Application identity (required)\n  c.app_name = \"My Music App\"\n  c.app_version = \"1.0\"\n  c.contact = \"support@mymusicapp.com\"\n\n  # Cache config (optional)\n  c.cache_path = \"/tmp/musicbrainz-cache\"\n  c.perform_caching = true\n\n  # Querying config (optional)\n  c.query_interval = 1.2 # seconds\n  c.tries_limit = 2\nend\n</code></pre>\n\n<p>Where should I put this information? In a separate file under the config folder? Should I copy paste it somewhere in some of my config files (environment.rb?).</p>\n\n<p>Once the configuration is done. Do I have access to all methods presented in the readme? I tried the example:</p>\n\n<pre><code>@suggestions = MusicBrainz::Artist.search(\"Jet\")\n</code></pre>\n\n<p>But it return a hash, not an object</p>\n\n<pre><code>[{:name=&gt;\"Jec\", :sort_name=&gt;\"Jec\", :weight=&gt;0, :desc=&gt;nil, :type=&gt;nil, :mbid=&gt;\"a8e34279-511f-4d8b-b40e-be503faec482\"}, {:name=&gt;\"JDT\", :sort_name=&gt;\"JDT\", :weight=&gt;0, :desc=&gt;nil, :type=&gt;\"Group\", :mbid=&gt;\"f10c42bc-0679-46ea-ac3d-2b446088c659\"}, {:name=&gt;\"Jat\", :sort_name=&gt;\"Jat\", :weight=&gt;0, :desc=&gt;nil, :type=&gt;\"Group\", :mbid=&gt;\"9b00250c-0d4d-4bdc-bd8c-37ca6cef8707\"}, {:name=&gt;\"Jeti\", :sort_name=&gt;\"Jeti\", :weight=&gt;0, :desc=&gt;nil, :type=&gt;\"Group\", :mbid=&gt;\"0076ec01-5abb-4904-97c6-643b4bf58fd5\"}, {:name=&gt;\"JeV\", :sort_name=&gt;\"JeV\", :weight=&gt;0, :desc=&gt;nil, :type=&gt;nil, :mbid=&gt;\"238e1ea2-f267-47f3-9f24-9a55e312b05a\"}, {:name=&gt;\"Jei\", :sort_name=&gt;\"Jei\", :weight=&gt;0, :desc=&gt;nil, :type=&gt;nil, :mbid=&gt;\"ddb7dde4-2cf1-43b2-95a6-bb60adcd52de\"}, {:name=&gt;\"Jeto\", :sort_name=&gt;\"Jeto\", :weight=&gt;0, :desc=&gt;nil, :type=&gt;nil, :mbid=&gt;\"bef1576f-6db7-473b-8fbf-359326bf48e0\"}, {:name=&gt;\"Jest\", :sort_name=&gt;\"Jest\", :weight=&gt;0, :desc=&gt;nil, :type=&gt;nil, :mbid=&gt;\"ba3e36b1-21c7-466e-83fa-fef43e2b9731\"}, {:name=&gt;\"DJet\", :sort_name=&gt;\"DJet\", :weight=&gt;0, :desc=&gt;nil, :type=&gt;nil, :mbid=&gt;\"174961e4-2ccb-4c66-aa2d-d86ab244cfc5\"}, {:name=&gt;\"Jek\", :sort_name=&gt;\"Jek\", :weight=&gt;0, :desc=&gt;nil, :type=&gt;\"Person\", :mbid=&gt;\"900a8e05-ff80-4f8d-a559-98368ed7d5a3\"}]  \n</code></pre>\n\n<p>and I am not sure what to with this. Could anyone give me more guidance on how to use this resource? Thanks.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "sequel", "chartkick"], "answers": [{"comments": [{"owner": {"reputation": 290, "user_id": 2386326, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/eab9dff3a64f8d7ab28c7cb67088fbfd?s=128&d=identicon&r=PG", "display_name": "muhammadn", "link": "https://stackoverflow.com/users/2386326/muhammadn"}, "edited": false, "score": 0, "creation_date": 1449674270, "post_id": 34182053, "comment_id": 56110936, "body": "Yes. this is what i am looking for. I have accepted this answer. Many Thanks!"}], "tags": [], "owner": {"reputation": 91, "user_id": 2697510, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae1722e06a7292e77d6bdde449a58013?s=128&d=identicon&r=PG", "display_name": "SilviaDeGM", "link": "https://stackoverflow.com/users/2697510/silviadegm"}, "is_accepted": true, "score": 2, "last_activity_date": 1449673812, "last_edit_date": 1449673812, "creation_date": 1449673341, "answer_id": 34182053, "question_id": 34181537, "link": "https://stackoverflow.com/questions/34181537/chartkick-line-chart-not-series-data-with-hash-in-array/34182053#34182053", "title": "Chartkick, line_chart (not series) data with hash in array", "body": "<p>You need to put something like this : </p>\n\n<pre><code>array.collect{|i| [i[:date],i[:count]]}\n</code></pre>\n\n<p>And you get this: </p>\n\n<pre><code>array= [{\"date\":\"2015-11-08T19:59:57.000+08:00\",\"count\":4},{\"date\":\"2015-11-09T00:02:37.000+08:00\",\"count\":3}]\n=&gt; [{:date=&gt;\"2015-11-08T19:59:57.000+08:00\", :count=&gt;4}, {:date=&gt;\"2015-11-09T00:02:37.000+08:00\", :count=&gt;3}]\narray.collect{|i| [i[:date],i[:count]]}\n=&gt; [[\"2015-11-08T19:59:57.000+08:00\", 4], [\"2015-11-09T00:02:37.000+08:00\", 3]]\n</code></pre>\n"}], "owner": {"reputation": 290, "user_id": 2386326, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/eab9dff3a64f8d7ab28c7cb67088fbfd?s=128&d=identicon&r=PG", "display_name": "muhammadn", "link": "https://stackoverflow.com/users/2386326/muhammadn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1529, "favorite_count": 0, "accepted_answer_id": 34182053, "answer_count": 1, "score": 0, "last_activity_date": 1454611210, "creation_date": 1449671948, "last_edit_date": 1454611210, "question_id": 34181537, "link": "https://stackoverflow.com/questions/34181537/chartkick-line-chart-not-series-data-with-hash-in-array", "title": "Chartkick, line_chart (not series) data with hash in array", "body": "<p>I have the following query which is a raw SQL using Sequel's .fetch method (Hopefully i can use the sequel DSL for this)</p>\n\n<pre><code>Radacct.fetch(\"SELECT `acctstarttime` AS `date`, count(*) AS `count` FROM `radacct` WHERE (`calledstationid` = ?) GROUP BY DATE(acctstarttime)\", 'C8-60-00-95-4B-0F')\n</code></pre>\n\n<p>The result data is:</p>\n\n<pre><code>[{\"date\":\"2015-11-08T19:59:57.000+08:00\",\"count\":4},{\"date\":\"2015-11-09T00:02:37.000+08:00\",\"count\":3}]\n</code></pre>\n\n<p>Which is hash in array. What chartkick gem's line_chart reads the data should be like this:</p>\n\n<pre><code>{\"2015-12-09T03:31:25.000+08:00\":1}\n</code></pre>\n\n<p>I am unsure how to use the .map function or .collect to flatten and remove the keys (date and count) so i can render the line chart in chartkick properly.</p>\n"}, {"tags": ["ruby", "ipc", "trace"], "answers": [{"comments": [{"owner": {"reputation": 1402, "user_id": 275249, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f4a6789a3cfae583e20b747df4dfe519?s=128&d=identicon&r=PG&f=1", "display_name": "n_x_l", "link": "https://stackoverflow.com/users/275249/n-x-l"}, "edited": false, "score": 0, "creation_date": 1449853214, "post_id": 34227965, "comment_id": 56201303, "body": "Awesome. I was doing ruby -r from the command line; didn&#39;t know exec allowed this. This is the correct answer. One quick follow up question: how can I make this work with commands that themselves invoke ruby? Like rspec. As it stands now it through an error saying it can&#39;t find rspec, naturally."}, {"owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "reply_to_user": {"reputation": 1402, "user_id": 275249, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f4a6789a3cfae583e20b747df4dfe519?s=128&d=identicon&r=PG&f=1", "display_name": "n_x_l", "link": "https://stackoverflow.com/users/275249/n-x-l"}, "edited": false, "score": 0, "creation_date": 1449855229, "post_id": 34227965, "comment_id": 56202482, "body": "as I remember - rspec does not invoke ruby by default, but can work over a drb, also you can run into <code>spring</code>-ed executables"}, {"owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "reply_to_user": {"reputation": 1402, "user_id": 275249, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f4a6789a3cfae583e20b747df4dfe519?s=128&d=identicon&r=PG&f=1", "display_name": "n_x_l", "link": "https://stackoverflow.com/users/275249/n-x-l"}, "edited": false, "score": 0, "creation_date": 1449855363, "post_id": 34227965, "comment_id": 56202556, "body": "as for &#39;not found&#39; error - because running without shell you&#39;ll have to resolve script full path yourself (or by passing to <code>which</code> before/in runner)"}, {"owner": {"reputation": 1402, "user_id": 275249, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f4a6789a3cfae583e20b747df4dfe519?s=128&d=identicon&r=PG&f=1", "display_name": "n_x_l", "link": "https://stackoverflow.com/users/275249/n-x-l"}, "edited": false, "score": 0, "creation_date": 1450095580, "post_id": 34227965, "comment_id": 56274824, "body": "you said &quot;[rspec] can work over a drb&quot;, what do you mean by that? How can I make client (command I pass to my script) work over drb when I don&#39;t have access to the client code?"}, {"owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "reply_to_user": {"reputation": 1402, "user_id": 275249, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f4a6789a3cfae583e20b747df4dfe519?s=128&d=identicon&r=PG&f=1", "display_name": "n_x_l", "link": "https://stackoverflow.com/users/275249/n-x-l"}, "edited": false, "score": 0, "creation_date": 1450095879, "post_id": 34227965, "comment_id": 56275009, "body": "a meant that rspec can be (and in large project probably is) made to work with <code>spork</code> (<a href=\"https://github.com/sporkrb/spork\" rel=\"nofollow noreferrer\">github.com/sporkrb/spork</a>) which accelerates tests startup by preloading stuff and forking, it works over drb, and may be a problem for your tool, because heavy-lifting is done in other process"}], "tags": [], "owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "is_accepted": true, "score": 0, "last_activity_date": 1449850690, "creation_date": 1449850690, "answer_id": 34227965, "question_id": 34181355, "link": "https://stackoverflow.com/questions/34181355/ruby-set-trace-func-on-forked-processes/34227965#34227965", "title": "Ruby - set_trace_func on forked processes", "body": "<p>You can inject some code into ruby process by adding arguments to ruby interpreter, so your utility can be split in two parts - runner and payload. Payload is just another script, it registers for <code>set_trace_func</code> etc. upon require, and runner inject the former into target script like so:</p>\n\n<pre><code>exec('/usr/bin/env', 'ruby', '-r', payload_full_filename, *ARGV)\n</code></pre>\n\n<p>This will make ruby to <code>require</code> your payload into process first and then proceed with running target script itself (payload will run even if target script cannot compile)</p>\n"}], "owner": {"reputation": 1402, "user_id": 275249, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f4a6789a3cfae583e20b747df4dfe519?s=128&d=identicon&r=PG&f=1", "display_name": "n_x_l", "link": "https://stackoverflow.com/users/275249/n-x-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 1, "accepted_answer_id": 34227965, "answer_count": 1, "score": 7, "last_activity_date": 1449850690, "creation_date": 1449671503, "question_id": 34181355, "link": "https://stackoverflow.com/questions/34181355/ruby-set-trace-func-on-forked-processes", "title": "Ruby - set_trace_func on forked processes", "body": "<p>I'd like to achieve the following: </p>\n\n<p>Build a Ruby command line utility that registers some set_trace_func events, then invokes whatever ruby-executable argument you pass to it (say <code>rspec</code>). The registered events then carry over to the command invoked. </p>\n\n<p>Pseudo code of <code>myutility</code>:</p>\n\n<pre><code>set_trace_func() # Set some events here\n\nexec(ARGV.join(' ')) # Execute argument passed\n</code></pre>\n\n<p>Then call as <code>myutility rspec</code>.</p>\n\n<p>My objective here is to actually <strong>register trace points on arbitrary commands</strong> (as long as they are using ruby shims). </p>\n\n<p>Things I have tried: </p>\n\n<ol>\n<li><code>exec</code> Does not work, for obvious reasons (it replaces the process entirely). </li>\n<li>popen, system, backticks. These start an independent process.</li>\n</ol>\n\n<p>I can use some form of IPC, but that assumes control over the command I am invoking with my utility. This is not the case; I'd like to accept arbitrary Ruby-executable arguments. </p>\n\n<p>Is this possible? One thing I have not looked at closely is drb, but that too assumes some interference with outside arguments. </p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "edited": false, "score": 1, "creation_date": 1449671735, "post_id": 34181231, "comment_id": 56108982, "body": "In <code>Pippi</code>, lowercase <code>i</code> appears before lowercase <code>p</code> - the code has correctly returned <code>[&quot;i&quot;,&quot;p&quot;]</code> - why you think answer is wrong?  Same with other examples as well - code is doing what it is supposed to do"}, {"owner": {"reputation": 174, "user_id": 5460225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QsuJW.jpg?s=128&g=1", "display_name": "owade", "link": "https://stackoverflow.com/users/5460225/owade"}, "reply_to_user": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "edited": false, "score": 0, "creation_date": 1449671904, "post_id": 34181231, "comment_id": 56109114, "body": "I think its the distance between the items,the pair pp comes before ii"}, {"owner": {"reputation": 864, "user_id": 1423901, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mLA3B.jpg?s=128&g=1", "display_name": "Redithion", "link": "https://stackoverflow.com/users/1423901/redithion"}, "edited": false, "score": 0, "creation_date": 1449672008, "post_id": 34181231, "comment_id": 56109199, "body": "He means the character first repeated, this is, first character that appears twice. In &quot;Pippi&quot; p is first repeated. Demo: you find a &#39;P&#39;, next you find an &#39;i&#39;, then you find a &#39;p&#39;, then another &#39;p&#39; so &#39;p&#39; is the first repeated character, note that you haven&#39;t found the other &#39;i&#39; yet."}, {"owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "edited": false, "score": 0, "creation_date": 1449672056, "post_id": 34181231, "comment_id": 56109248, "body": "Looks like your problem statement is incomplete - unless you state that clearly and also code for it - you will not get right output from your code"}, {"owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "edited": false, "score": 1, "creation_date": 1449673326, "post_id": 34181231, "comment_id": 56110251, "body": "@owade I have posted a possible solution"}], "answers": [{"tags": [], "owner": {"reputation": 7844, "user_id": 1520557, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/9KKRA.png?s=128&g=1", "display_name": "Drenmi", "link": "https://stackoverflow.com/users/1520557/drenmi"}, "is_accepted": false, "score": 0, "last_activity_date": 1449673729, "creation_date": 1449673729, "answer_id": 34182184, "question_id": 34181231, "link": "https://stackoverflow.com/questions/34181231/items-in-order-of-repetition/34182184#34182184", "title": "Items in order of repetition", "body": "<p>I'm not sure if there's a trivial solution to this, but here's one that could serve as a starting point. It works by keeping a reference to the index of all occurrences of a character.</p>\n\n<p>Example using the string <code>\"abba\"</code>:</p>\n\n<pre><code>str = \"abba\"\n\nchar_map = str.chars.each_with_object(Hash.new { |h, k| h[k] = [] }).with_index { |(c, m), i| m[c] &lt;&lt; i }\n#=&gt; {\"a\"=&gt;[0, 3], \"b\"=&gt;[1, 2]} \n</code></pre>\n\n<p>We now have a hash with each character as a key, and the indices of their occurrences as values. We can now filter out the non-duplicates, and sort the rest by their second occurrence:</p>\n\n<pre><code>char_map.select { |_, v| v.length &gt; 1 }.to_a.sort_by { |e| e[1][1] }.map(&amp;:first)\n#=&gt; [\"b\", \"a\"]\n</code></pre>\n\n<p>And the complete implementation:</p>\n\n<pre><code>def repeated(str)\n  str.chars.each_with_object(Hash.new { |h, k| h[k] = [] }).with_index { |(c, m), i| m[c] &lt;&lt; i }.select { |_, v| v.length &gt; 1 }.to_a.sort_by { |e| e[1][1] }.map(&amp;:first)\nend\n\nrepeated(\"abba\")\n#=&gt; [\"b\", \"a\"]\n\nrepeated(\"Pippi\")\n#=&gt; [\"p\", \"i\"]\n\nrepeated(\"limbojackassin the garden\")\n#=&gt; [\"a\", \"s\", \"i\", \" \", \"e\", \"n\"]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "edited": false, "score": 0, "creation_date": 1449673981, "post_id": 34182207, "comment_id": 56110702, "body": "Works fine now.  Best answer!"}, {"owner": {"reputation": 864, "user_id": 1423901, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mLA3B.jpg?s=128&g=1", "display_name": "Redithion", "link": "https://stackoverflow.com/users/1423901/redithion"}, "edited": false, "score": 0, "creation_date": 1449674354, "post_id": 34182207, "comment_id": 56111000, "body": "I had the same idea, but you accomplished it better."}, {"owner": {"reputation": 7844, "user_id": 1520557, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/9KKRA.png?s=128&g=1", "display_name": "Drenmi", "link": "https://stackoverflow.com/users/1520557/drenmi"}, "edited": false, "score": 0, "creation_date": 1449674589, "post_id": 34182207, "comment_id": 56111167, "body": "This one is pretty neat."}], "tags": [], "owner": {"reputation": 5713, "user_id": 846163, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/623857ee8390f91edba65fcac0d152ab?s=128&d=identicon&r=PG", "display_name": "sschmeck", "link": "https://stackoverflow.com/users/846163/sschmeck"}, "is_accepted": true, "score": 2, "last_activity_date": 1449688740, "last_edit_date": 1449688740, "creation_date": 1449673788, "answer_id": 34182207, "question_id": 34181231, "link": "https://stackoverflow.com/questions/34181231/items-in-order-of-repetition/34182207#34182207", "title": "Items in order of repetition", "body": "<p>Another way using the index with <a href=\"http://ruby-doc.org/core-2.2.3/Enumerable.html#method-i-each_with_index\" rel=\"nofollow\"><code>Enumerable#each_with_index()</code></a>. </p>\n\n<p>The <code>select()</code> rejects all first occurances of characters since <code>index()</code> returns the first occurance.</p>\n\n<pre><code>def repeated(str)\n  puts str.chars.each_with_index\n                .select { |c,i| i != str.index(c) }\n                .map(&amp;:first)\n                .uniq\nend\n</code></pre>\n\n<p>Alternativly to <code>select()</code> you can use <code>reject  { |c,i| i == str.index(c) }</code>. Maybe it's more expressive. </p>\n\n<p><strong>Update</strong>: Insprired by Stefan's answer you can drop the <code>map()</code> method when using <a href=\"http://ruby-doc.org/core-2.2.3/Enumerator.html#method-i-with_index\" rel=\"nofollow\"><code>Enumerator#with_index()</code></a> instead of <code>Enumerable#each_with_index()</code> since Ruby 1.9.</p>\n\n<pre><code>def repeated(str)\n  p str.chars.reject\n             .with_index { |c,i| i == str.index(c) }\n             .uniq\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 864, "user_id": 1423901, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mLA3B.jpg?s=128&g=1", "display_name": "Redithion", "link": "https://stackoverflow.com/users/1423901/redithion"}, "is_accepted": false, "score": 0, "last_activity_date": 1449674199, "last_edit_date": 1449674199, "creation_date": 1449673812, "answer_id": 34182217, "question_id": 34181231, "link": "https://stackoverflow.com/questions/34181231/items-in-order-of-repetition/34182217#34182217", "title": "Items in order of repetition", "body": "<p><strong>Code:</strong></p>\n\n<pre><code>def repeated(str)\n    return str.chars.map { |e|\n        first_index = str.index(e)\n        [first_index, str.index(e,first_index+1)]\n    }.map{|e| e[1].nil? ? str.length + 1 : e[1]}\n     .select{|e| e &lt; str.length }.uniq.sort.map {|e| str[e]}\nend\n</code></pre>\n\n<p><strong>Example:</strong></p>\n\n<pre><code>repeated('Pippi')\n=&gt; [\"p\", \"i\"]\n</code></pre>\n\n<p><strong>Explanation:</strong></p>\n\n<p>It basically gets the two first indexes of each character, it removes the characters that weren't repeated (second index is null), then gets the second indexes, makes an uniq, sorts ascending and map those indexes to the corresponding character from the string.</p>\n"}, {"comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 1, "creation_date": 1449674499, "post_id": 34182348, "comment_id": 56111107, "body": "The requirement to <code>puts</code> the output is making it difficult to read. Somehow, beginners tend to write a method that <code>puts</code> something rather than returning that value."}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 3, "last_activity_date": 1449674166, "creation_date": 1449674166, "answer_id": 34182348, "question_id": 34181231, "link": "https://stackoverflow.com/questions/34181231/items-in-order-of-repetition/34182348#34182348", "title": "Items in order of repetition", "body": "<pre><code>def repeated(str)\n  puts(str.each_char.with_object([{}, []]) do\n    |c, (h, a)| h[c] ? a.push(c) : h.store(c, true)\n  end.last.uniq)\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1449728112, "post_id": 34183787, "comment_id": 56135699, "body": "Clever, but not very efficient, considering that you create a lot of temporary arrays and keep counting for characters after two have been found."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1449733703, "post_id": 34183787, "comment_id": 56138233, "body": "@CarySwoveland it creates temporary strings actually, but your point is valid. I&#39;ve added another - more efficient - version."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1449734055, "post_id": 34183787, "comment_id": 56138367, "body": "So that&#39;s what @sawa was doing. :-). I suggested something similar, but I prefer your revision as it&#39;s probably a bit faster. On the other hand, I don&#39;t have an array and append to it..."}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 3, "last_activity_date": 1449737644, "last_edit_date": 1495540349, "creation_date": 1449678063, "answer_id": 34183787, "question_id": 34181231, "link": "https://stackoverflow.com/questions/34181231/items-in-order-of-repetition/34183787#34183787", "title": "Items in order of repetition", "body": "<p>Here's a solution based on your code:</p>\n\n<pre><code>def repeated(str)\n  str.each_char.select.with_index { |c, i| str[0, i].count(c) == 1 }\nend\n</code></pre>\n\n<p>For each character, it <a href=\"http://ruby-doc.org/core-2.2.3/String.html#method-i-count\" rel=\"nofollow noreferrer\"><code>count</code></a>s the character in the substring before the character. If the count is 1, the character is <a href=\"http://ruby-doc.org/core-2.2.3/Enumerable.html#method-i-select\" rel=\"nofollow noreferrer\"><code>select</code></a>-ed.</p>\n\n<p>As noted by Cary Swoveland, this creates and scans an intermediate string for each character. I'd use a variation of <a href=\"https://stackoverflow.com/a/34182348/477037\">sawa's code</a> if efficiency was important:</p>\n\n<pre><code>def repeated(str)\n  h = Hash.new(0)\n  str.each_char.with_object([]) do |c, a|\n    a &lt;&lt; c if h[c] == 1\n    h[c] += 1\n  end\nend\n</code></pre>\n\n<p>This traverses the string via <a href=\"http://ruby-doc.org/core-2.2.3/String.html#method-i-each_char\" rel=\"nofollow noreferrer\"><code>each_char</code></a> and counts each character using a hash <code>h</code>. If a character is encountered a second time (count value is 1), it is added to an array <code>a</code> which is implicitly returned at the end by <a href=\"http://ruby-doc.org/core-2.2.3/Enumerator.html#method-i-with_object\" rel=\"nofollow noreferrer\"><code>each_object</code></a>.</p>\n\n<p>I've just realized that you can use <code>select</code> instead of <code>with_object</code>:</p>\n\n<pre><code>def repeated(str)\n  h = Hash.new(0)\n  str.each_char.select { |c| (h[c] += 1) == 2 }\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1449735593, "post_id": 34194383, "comment_id": 56139139, "body": "If I&#39;m not mistaken, the call to <code>read2.include?(c)</code> is superfluous."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1449735904, "post_id": 34194383, "comment_id": 56139295, "body": "Thanks, @Stefan. Even tighter! btw, my reaction when I see that conditional clause from you: :-D"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1449736648, "last_edit_date": 1449736648, "creation_date": 1449725495, "answer_id": 34194383, "question_id": 34181231, "link": "https://stackoverflow.com/questions/34181231/items-in-order-of-repetition/34194383#34194383", "title": "Items in order of repetition", "body": "<pre><code>str = \"Jack be nimble, jack be quick, Jack jumped over the candle stick\"\n\nrequire 'set'\n\nread1, read2 = Set.new, Set.new\nstr.each_char { |c| read2.add(c) unless read1.add?(c) }\nread2.to_a\n  #=&gt; [\" \", \"b\", \"e\", \"a\", \"c\", \"k\", \"i\", \",\", \"J\", \"j\", \"u\", \"m\", \"n\", \"d\", \"l\", \"t\"]  \n</code></pre>\n\n<p>An attempt is made to add each character to <code>read1</code>. If the character can be added, it is the first time that character has been encountered. If the character cannot be added to <code>read1</code> (because <code>read1</code> already contains the character), an attempt is made to add it to <code>read2</code>. Whether <code>read2</code> already contains that character is unimportant; all that matters is that <code>read2</code> will contain that character after the attempt is made to add it.</p>\n\n<p>Therefore, after all characters have been enumerated, <code>read2</code> will contain the characters that appear more than once in the proper order.</p>\n\n<p>Edit: I wish to thank @Stefan for pointing out that I did not need <code>read2.include?(c) ||</code> following <code>unless</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1449760248, "post_id": 34197732, "comment_id": 56155045, "body": "Probably depends on string length, too."}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 2, "last_activity_date": 1449780536, "last_edit_date": 1449780536, "creation_date": 1449738759, "answer_id": 34197732, "question_id": 34181231, "link": "https://stackoverflow.com/questions/34181231/items-in-order-of-repetition/34197732#34197732", "title": "Items in order of repetition", "body": "<p><strong>Ladies and gentlemen, start your engines!</strong></p>\n\n<pre><code>require 'fruity'\nrequire 'set'\n\ndef sschmeck(str)\n  str.chars.each_with_index.select { |c,i| i != str.index(c) }.map(&amp;:first).uniq\nend\n\ndef drenmi(str)\n  str.chars.each_with_object(Hash.new { |h, k| h[k] = [] }).\n      with_index { |(c, m), i| m[c] &lt;&lt; i }.select { |_, v| v.length &gt; 1 }.\n      to_a.sort_by { |e| e[1][1] }.map(&amp;:first)\nend\n\ndef redithion(str)\n    str.chars.map { |e|\n        first_index = str.index(e)\n        [first_index, str.index(e,first_index+1)]\n    }.map{|e| e[1].nil? ? str.length + 1 : e[1]}\n     .select{|e| e &lt; str.length }.uniq.sort.map {|e| str[e]}\nend\n</code></pre>\n\n<p><p></p>\n\n<pre><code>def sawa(str)\n  str.each_char.with_object([{}, []]) do\n    |c, (h, a)| h[c] ? a.push(c) : h.store(c, true)\n  end.last.uniq\nend\n\ndef stefan_1(str)\n  str.each_char.select.with_index { |c, i| str[0, i].count(c) == 1 }\nend\n\ndef stefan_2(str)\n  h = Hash.new(0)\n  str.each_char.with_object([]) do |c, a|\n    a &lt;&lt; c if h[c] == 1\n    h[c] += 1\n  end\nend\n\ndef stefan_3(str)\n  h = Hash.new(0)\n  str.each_char.select { |c| (h[c] += 1) == 2 }\nend\n\ndef cary(str)\n  read1, read2 = Set.new, Set.new\n  str.each_char { |c| read2.add(c) unless read1.add?(c) }\n  read2.to_a\nend\n</code></pre>\n\n<p><p></p>\n\n<pre><code>str = \"Jack be nimble, jack be quick, Jack jumped over the candle stick\"\n\ncompare(\n  { sschmeck:   -&gt; { sschmeck  str },\n    drenmi:     -&gt; { drenmi    str },\n    redithion:  -&gt; { redithion str },\n    sawa:       -&gt; { sawa      str },  \n    stefan_1:   -&gt; { stefan_1  str },  \n    stefan_2:   -&gt; { stefan_2  str },  \n    stefan_3:   -&gt; { stefan_3  str },  \n    cary:       -&gt; { cary      str }}\n)\n\nstefan_3 is faster than stefan_1 by 19.999999999999996% \u00b1 10.0%\nstefan_1 is similar to stefan_2\nstefan_2 is faster than sawa by 10.000000000000009% \u00b1 10.0%\nsawa is similar to cary\ncary is faster than sschmeck by 10.000000000000009% \u00b1 10.0%\nsschmeck is faster than drenmi by 39.99999999999999% \u00b1 10.0%\ndrenmi is similar to redithion\n</code></pre>\n\n<p>For:</p>\n\n<pre><code>str = \"It was the best of times, it was the worst of times, it was the age of wisdom, it was the age of foolishness, it was the epoch of belief, it was the epoch of incredulity, it was the season of Light, it was the season of Darkness, it was the spring of hope, it was the winter of despair, we had everything before us, we had nothing before us, we were all going direct to Heaven, we were all going direct the other way \u2013 in short, the period was so far like the present period, that some of its noisiest authorities insisted on its being received, for good or for evil, in the superlative degree of comparison only.\"\nstr.size #=&gt;613\n</code></pre>\n\n<p>we obtain:</p>\n\n<pre><code>Running each test 16 times. Test will take about 1 second.\nstefan_3 is faster than sawa by 10.000000000000009% \u00b1 10.0%\nsawa is similar to stefan_2\nstefan_2 is similar to drenmi\ndrenmi is similar to cary\ncary is faster than sschmeck by 60.00000000000001% \u00b1 1.0%\nsschmeck is faster than stefan_1 by 19.999999999999996% \u00b1 1.0%\nstefan_1 is faster than redithion by 39.99999999999999% \u00b1 10.0%\n</code></pre>\n\n<p>My takeaway is that the results are close enough that the choice of method should depend on other factors. I tested for readability with a stopwatch, stopping the timer when I thought, \"Oh, I see.\" I won that, but of course I already understood what I was reading. <code>stefan_3</code>, which clocked <code>0.3</code> seconds, was next. I figured out <code>sawa</code> at <code>1:23:14</code>.</p>\n"}], "owner": {"reputation": 174, "user_id": 5460225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QsuJW.jpg?s=128&g=1", "display_name": "owade", "link": "https://stackoverflow.com/users/5460225/owade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 34182207, "answer_count": 7, "score": 3, "last_activity_date": 1449780536, "creation_date": 1449671218, "last_edit_date": 1449675441, "question_id": 34181231, "link": "https://stackoverflow.com/questions/34181231/items-in-order-of-repetition", "title": "Items in order of repetition", "body": "<p>I want method <code>repeated</code> to take a string and return an array of its repeated characters in the order they are repeated. Case sensitivity applies. In this example,</p>\n\n<pre><code>repeated(\"abba\") # =&gt; [\"b\", \"a\"]\n</code></pre>\n\n<p><code>\"b\"</code> is repeated before <code>\"a\"</code> is. Another example:</p>\n\n<pre><code>repeated(\"limbojackassin the garden\") # =&gt; [\"a\", \"s\", \"i\", \" \", \"e\", \"n\"]\n</code></pre>\n\n<p>works like this:</p>\n\n<pre><code>limbojackassin the garden \n      |--^                \"a\"\n          |^              \"s\"\n |----------^             \"i\"\n              |---^       \" \"\n                    *     \"a\" ignored\n                 |-----^  \"e\"\n             |----------^ \"n\"\n</code></pre>\n\n<p>I have this method.</p>\n\n<pre><code>def repeated(str)\n  puts str.chars.select{|i| str.count(i) &gt; 1}.uniq\nend\n</code></pre>\n\n<p>which works unexpectedly:</p>\n\n<pre><code>repeated(\"limbojackassin the garden\")\n# =&gt; [\"i\", \"a\", \"s\", \"n\", \" \", \"e\"]\n# =&gt; expected [\"a\", \"s\", \"i\", \" \", \"e\", \"n\"]\nrepeated(\"Pippi\")\n# =&gt; [\"i\", \"p\"]\n# =&gt; expected [\"p\", \"i\"]\nrepeated(\"apple\")\n# =&gt; as expected [\"p\"]\n</code></pre>\n\n<p>How could one check the distances between the array's item indexes?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "copy"], "comments": [{"owner": {"reputation": 12965, "user_id": 2463570, "user_type": "registered", "accept_rate": 55, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rajarshi Das", "link": "https://stackoverflow.com/users/2463570/rajarshi-das"}, "edited": false, "score": 1, "creation_date": 1449670030, "post_id": 34180125, "comment_id": 56107681, "body": "<code>FileUtils.chmod(0777, source)</code> and then <code>FileUtils.cp_r source, &#39;destination&#39;, remove_destination: true</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1020, "user_id": 169513, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a5c20316d9d845b3586e55145a1753f2?s=128&d=identicon&r=PG", "display_name": "Mugen", "link": "https://stackoverflow.com/users/169513/mugen"}, "edited": false, "score": 0, "creation_date": 1527761520, "post_id": 34180209, "comment_id": 88253354, "body": "And how do we do that?"}], "tags": [], "owner": {"reputation": 3832, "user_id": 136508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/391f9b787cdc12aa2c179713f5103e3a?s=128&d=identicon&r=PG", "display_name": "ilan berci", "link": "https://stackoverflow.com/users/136508/ilan-berci"}, "is_accepted": true, "score": 1, "last_activity_date": 1449668306, "creation_date": 1449668306, "answer_id": 34180209, "question_id": 34180125, "link": "https://stackoverflow.com/questions/34180125/copy-file-from-source-to-dest-even-if-file-exist-in-dest-with-ruby/34180209#34180209", "title": "copy file from source to dest even if file exist in dest with ruby?", "body": "<p>send in <code>remove_destination: true</code> in your options block</p>\n"}], "owner": {"reputation": 729, "user_id": 5135400, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/340af7d7f56355c39b56f926cae83c0d?s=128&d=identicon&r=PG&f=1", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/5135400/johndoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3090, "favorite_count": 0, "accepted_answer_id": 34180209, "answer_count": 1, "score": 0, "last_activity_date": 1449668542, "creation_date": 1449668009, "question_id": 34180125, "link": "https://stackoverflow.com/questions/34180125/copy-file-from-source-to-dest-even-if-file-exist-in-dest-with-ruby", "title": "copy file from source to dest even if file exist in dest with ruby?", "body": "<p>as I understand, the following line should copy files even if the file exist already within the destination folder:</p>\n\n<pre><code>FileUtils.cp_r(source, 'destination')\n</code></pre>\n\n<p>I get the EACCES error:</p>\n\n<pre><code>fileutils.rb:1402:in `initialize': Permission denied @ rb_sysopen ...\n</code></pre>\n\n<p>Which means I can not overwrite the already existing file.</p>\n\n<p>How to overwrite  files with same name using FileUtils.cp_r?</p>\n"}, {"tags": ["ruby", "mongodb", "upsert"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1449666932, "post_id": 34179587, "comment_id": 56105669, "body": "Check for record existence in advance?"}, {"owner": {"reputation": 155, "user_id": 3505565, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0beaa04866b9050588e7b0160a38ec08?s=128&d=identicon&r=PG&f=1", "display_name": "Robs", "link": "https://stackoverflow.com/users/3505565/robs"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1449667064, "post_id": 34179587, "comment_id": 56105759, "body": "Thought about this already. If there is no other option, I&#39;ll do this way."}], "owner": {"reputation": 155, "user_id": 3505565, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0beaa04866b9050588e7b0160a38ec08?s=128&d=identicon&r=PG&f=1", "display_name": "Robs", "link": "https://stackoverflow.com/users/3505565/robs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1449666356, "creation_date": 1449666356, "question_id": 34179587, "link": "https://stackoverflow.com/questions/34179587/mongo-driver-upsert-false-creates-new-document", "title": "mongo driver upsert: false creates new document", "body": "<p>I am combining both <code>mongomapper</code> and <code>mongo</code> driver in my project. I had to downgrade version of <code>mongo</code> driver, cause <code>mongomapper</code> depends on <code>1.12.5</code>. Unfortunately I've got problem with <code>update({search_hash}, {update_hash}, upsert: false)</code>, because it will create new document if searched document doesn't exist. \nAlso, in documentation, no information about optional parameters of <code>update</code> is supplied. </p>\n\n<p>Here is documentation:\n<a href=\"http://api.mongodb.org/ruby/1.1.5/Mongo/Collection.html\" rel=\"nofollow\">http://api.mongodb.org/ruby/1.1.5/Mongo/Collection.html</a></p>\n\n<p>And some code here: </p>\n\n<pre><code>class MongoConnector\n\n\n attr_reader :type, :collection\n\n  def initialize(db_params, type)\n    @type = type\n    db = Mongo::Connection.new(connection_uri[:host], connection_uri[:port])\n    @collection = db[db_params[:key]][db_params[:collection]]\n  end\n\n  def update(id, update_query)\n    collection.update({ _id: bson_id(id) }, update_query, upsert: false)\n  end\n\n private\n\n def bson_id(id)\n    BSON::ObjectId(id)\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "session", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1449666343, "post_id": 34179407, "comment_id": 56105285, "body": "I believe this is because your code formatting is awful. Insert a carriage return between <code>if user &amp;&amp; user.authenticate(params[:password])</code> and <code>session[:user_id] = user.id</code>."}, {"owner": {"reputation": 2546, "user_id": 2603130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/60f46755895fd7c8bfa4f39d527ba9a8?s=128&d=identicon&r=PG", "display_name": "radubogdan", "link": "https://stackoverflow.com/users/2603130/radubogdan"}, "edited": false, "score": 0, "creation_date": 1449666406, "post_id": 34179407, "comment_id": 56105329, "body": "I improved the format of your question. Also I think I fixed the error :) Next time try to make a better format for your code so we can understand."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 2546, "user_id": 2603130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/60f46755895fd7c8bfa4f39d527ba9a8?s=128&d=identicon&r=PG", "display_name": "radubogdan", "link": "https://stackoverflow.com/users/2603130/radubogdan"}, "edited": false, "score": 0, "creation_date": 1449666546, "post_id": 34179407, "comment_id": 56105417, "body": "@radubogdan please in the future avoid attempts to improve anything but formatting."}, {"owner": {"reputation": 2546, "user_id": 2603130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/60f46755895fd7c8bfa4f39d527ba9a8?s=128&d=identicon&r=PG", "display_name": "radubogdan", "link": "https://stackoverflow.com/users/2603130/radubogdan"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1449667164, "post_id": 34179407, "comment_id": 56105826, "body": "@mudasobwa Agree. Still, he doesn&#39;t need to agree with my changes."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "reply_to_user": {"reputation": 2546, "user_id": 2603130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/60f46755895fd7c8bfa4f39d527ba9a8?s=128&d=identicon&r=PG", "display_name": "radubogdan", "link": "https://stackoverflow.com/users/2603130/radubogdan"}, "edited": false, "score": 0, "creation_date": 1449669452, "post_id": 34179407, "comment_id": 56107283, "body": "@radubogdan\t The point is that now the question doesn&#39;t make any sense."}, {"owner": {"reputation": 2546, "user_id": 2603130, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/60f46755895fd7c8bfa4f39d527ba9a8?s=128&d=identicon&r=PG", "display_name": "radubogdan", "link": "https://stackoverflow.com/users/2603130/radubogdan"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1449669636, "post_id": 34179407, "comment_id": 56107407, "body": "@mudasobwa totally get it."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 4194893, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/148353803e1e8a205759260b32d5b449?s=128&d=identicon&r=PG&f=1", "display_name": "Fergus Morton", "link": "https://stackoverflow.com/users/4194893/fergus-morton"}, "edited": false, "score": 0, "creation_date": 1449673727, "post_id": 34179670, "comment_id": 56110527, "body": "Thank you, resolved - apologies about my messy code!"}], "tags": [], "owner": {"reputation": 530, "user_id": 2275559, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Qr2dB.jpg?s=128&g=1", "display_name": "Charlie Harding", "link": "https://stackoverflow.com/users/2275559/charlie-harding"}, "is_accepted": true, "score": 2, "last_activity_date": 1449666581, "creation_date": 1449666581, "answer_id": 34179670, "question_id": 34179407, "link": "https://stackoverflow.com/questions/34179407/getting-a-syntax-error-in-sessionscontroller/34179670#34179670", "title": "Getting a syntax error in Sessions#controller", "body": "<p>You cannot use the body of an if statement on the same line as the condition unless you separate it from the condition with the keyword <code>then</code>. Here I have tidied your code, so there is a line break after the condition.</p>\n\n<pre><code>def create\n  user = User.find_by_username(params[:username]) \n\n  if user &amp;&amp; user.authenticate(params[:password])\n    session[:user_id] = user.id # stores the id in the session\n                                # displays the user/show view\n  else             \n    flash.now[:error] = \"Invalid name/password combination.\" # Shows the sign in page again \n    redirect_to user\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 4194893, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/148353803e1e8a205759260b32d5b449?s=128&d=identicon&r=PG&f=1", "display_name": "Fergus Morton", "link": "https://stackoverflow.com/users/4194893/fergus-morton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 0, "accepted_answer_id": 34179670, "answer_count": 1, "score": 0, "last_activity_date": 1449669275, "creation_date": 1449665820, "last_edit_date": 1449669275, "question_id": 34179407, "link": "https://stackoverflow.com/questions/34179407/getting-a-syntax-error-in-sessionscontroller", "title": "Getting a syntax error in Sessions#controller", "body": "<p>I am trying to use the same code that I used in rails 3 for sessions.</p>\n\n<pre><code> def create\n   user = User.find_by_name(params[:name])\n\n   if user &amp;&amp; user.authenticate(params[:password])\n     session[:user_id] = user.id    #stores the id in the session\n     redirect_to user       #displays the user/show view\n   else             \n     flash.now[:error] = \"Invalid name/password combination.\"\n     render 'new'                   \n   end\n end\n</code></pre>\n\n<p>I have adjusted it to </p>\n\n<pre><code>def create\n  user = User.find_by_username(params[:username])\n\n  if user &amp;&amp; user.authenticate(params[:password])\n    session[:user_id] = user.id #stores the id in the session \n    redirect_to user #displays the user/show view\n  else              \n    flash.now[:error] = \"Invalid name/password combination.\"\n    render 'new' #shows the signin page again \n  end\nend\n</code></pre>\n\n<p>But I am now getting the error:</p>\n\n<pre><code>\"SyntaxError in SessionsController#new\" \n /sessions_controller.rb:5: syntax error, unexpected tIDENTIFIER, expecting keyword_then or ';' or '\\n' ...te(params[:password]) session[:user_id] = user.id\n</code></pre>\n\n<p>I'm sure it is to do with the fact I am using rails 4 now and not 3 and there is some syntax that is not compatible with 4, but I can't seem to work it out.</p>\n"}, {"tags": ["ruby", "watir-webdriver"], "answers": [{"tags": [], "owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "is_accepted": true, "score": 1, "last_activity_date": 1449683273, "creation_date": 1449683273, "answer_id": 34185559, "question_id": 34178948, "link": "https://stackoverflow.com/questions/34178948/get-text-from-each-element/34185559#34185559", "title": "get text from each element", "body": "<p>You could create a <a href=\"http://ruby-doc.org/core-2.2.0/Range.html\" rel=\"nofollow\"><code>Range</code></a> and then iterate over it, which allows for incrementing the index.  Here's a hacky, contrived example:</p>\n\n<pre><code>(0..1).each do |i|\n  amount =  b.div(:class =&gt; 'single sort', :index =&gt; i).div(:class, 'amount').text.gsub!(/\\D/, \"\")\n  amount = amount.to_i\n  next if amount &lt; 5000\n  puts amount               #=&gt; 9479\nend\n</code></pre>\n\n<p>Since there are no <code>&lt;a&gt;</code> tags in the HTML snippet, it's not clear what should be clicked, but you could potentially replace <code>puts amount</code> with the <code>click</code> action.</p>\n"}, {"comments": [{"owner": {"reputation": 99, "user_id": 3492458, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/11f682562c623b84d8e368af5f64dec7?s=128&d=identicon&r=PG&f=1", "display_name": "2500mA", "link": "https://stackoverflow.com/users/3492458/2500ma"}, "edited": false, "score": 0, "creation_date": 1449823182, "post_id": 34205242, "comment_id": 56182660, "body": "i need to change index of clicked element each time, when amount lower than 5k. but thank you for answer."}], "tags": [], "owner": {"reputation": 817, "user_id": 1015666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/92c387e284bf68f12794b79ca55d3a14?s=128&d=identicon&r=PG", "display_name": "Sveatoslav", "link": "https://stackoverflow.com/users/1015666/sveatoslav"}, "is_accepted": false, "score": 1, "last_activity_date": 1449759898, "creation_date": 1449759898, "answer_id": 34205242, "question_id": 34178948, "link": "https://stackoverflow.com/questions/34178948/get-text-from-each-element/34205242#34205242", "title": "get text from each element", "body": "<p>here is more universal way, for any range of given elements, without the hardcoded (0..1), be there 2 elements, or 324834 :)</p>\n\n<pre><code>b.divs(:class =&gt; 'single sort').each {|x| if x.text.gsub!(/\\D/, \"\").to_i&lt;5000; puts x.text; else; puts \"The value is #{x.text}\"; end}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 99, "user_id": 3492458, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/11f682562c623b84d8e368af5f64dec7?s=128&d=identicon&r=PG&f=1", "display_name": "2500mA", "link": "https://stackoverflow.com/users/3492458/2500ma"}, "edited": false, "score": 0, "creation_date": 1449832465, "post_id": 34206020, "comment_id": 56188224, "body": "i wasn&#39;t completely honest with you, element I getting amount <code>div(class: &#39;single sort&#39;)</code>, element I must click <code>a.(:class, &#39;yellow front&#39;)</code>. that&#39;s why orde&#39;s way fits better"}, {"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "reply_to_user": {"reputation": 99, "user_id": 3492458, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/11f682562c623b84d8e368af5f64dec7?s=128&d=identicon&r=PG&f=1", "display_name": "2500mA", "link": "https://stackoverflow.com/users/3492458/2500ma"}, "edited": false, "score": 0, "creation_date": 1449832685, "post_id": 34206020, "comment_id": 56188353, "body": "But where is that <code>&lt;a&gt;</code> element? It is not anywhere in your provided HTML."}, {"owner": {"reputation": 99, "user_id": 3492458, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/11f682562c623b84d8e368af5f64dec7?s=128&d=identicon&r=PG&f=1", "display_name": "2500mA", "link": "https://stackoverflow.com/users/3492458/2500ma"}, "edited": false, "score": 0, "creation_date": 1449835505, "post_id": 34206020, "comment_id": 56189985, "body": "it&#39;s ok! but if developers add another numbers in <code>tr</code> we will get not proper result. need to target amount div. thank you for help!"}, {"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "reply_to_user": {"reputation": 99, "user_id": 3492458, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/11f682562c623b84d8e368af5f64dec7?s=128&d=identicon&r=PG&f=1", "display_name": "2500mA", "link": "https://stackoverflow.com/users/3492458/2500ma"}, "edited": false, "score": 1, "creation_date": 1449841955, "post_id": 34206020, "comment_id": 56194108, "body": "You do have the option of scoping the text check to the amount div (see update). Anyways, I was just trying to show the concept of using methods that do not require you manually calling <code>break</code>."}], "tags": [], "owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "is_accepted": false, "score": 1, "last_activity_date": 1449841656, "last_edit_date": 1449841656, "creation_date": 1449762126, "answer_id": 34206020, "question_id": 34178948, "link": "https://stackoverflow.com/questions/34178948/get-text-from-each-element/34206020#34206020", "title": "get text from each element", "body": "<p>Instead of finding the first one after the element that is less than 5000, I think it would be easier to find the first element that is 5000 or greater. Looking at the problem this way, you can simply create an element collection of the divs. Then <code>find</code> the first one where the text matches the specified condition.</p>\n\n<pre><code>match = browser.divs(class: 'single sort').find do |div|\n    div.div(class: 'amount').text.tr('^0-9', '').to_i &gt;= 5000\nend\nmatch.link(class: 'yellow front').click\n</code></pre>\n\n<p>If you prefer to find the first one after the one that is less than 5000, you could use the <code>drop_while</code> method instead. After dropping the ones that do not meet the criteria, the first element in the collection will be greater than the 5000.</p>\n\n<pre><code>matches = browser.divs(class: 'single sort').drop_while do |div|\n    div.div(class: 'amount').text.tr('^0-9', '').to_i &lt; 5000\nend\nmatches.first.link(class: 'yellow front').click\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 3492458, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/11f682562c623b84d8e368af5f64dec7?s=128&d=identicon&r=PG&f=1", "display_name": "2500mA", "link": "https://stackoverflow.com/users/3492458/2500ma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 714, "favorite_count": 0, "accepted_answer_id": 34185559, "answer_count": 3, "score": 0, "last_activity_date": 1449841656, "creation_date": 1449664456, "last_edit_date": 1449832818, "question_id": 34178948, "link": "https://stackoverflow.com/questions/34178948/get-text-from-each-element", "title": "get text from each element", "body": "<p>need to get amount text and check if it &lt; 5000 then click next element in class</p>\n\n<pre><code>&lt;div class=\"single sort\"&gt;\n    &lt;div class=\"svariant front one\" id=\"114_0\"&gt;\n        &lt;img src=\"http://pics.avs.io/al_square/24/24/TK@2x.png\" class=\"airlogo\"    title=\"Turkish Airlines\"&gt;\n        &lt;div class=\"amount\"&gt;4 479\n            &lt;span class=\"rub\"&gt;\u0420&lt;/span&gt;\n        &lt;/div&gt;\n      &lt;a href=\"/travel/Order/Index/h7676Rn7471rdd?fid=349&amp;amp;come=0\" class=\"yellow front\"&gt;BUY&lt;/a&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n\n&lt;div class=\"single sort\"&gt;\n    &lt;div class=\"svariant front one\" id=\"113_0\"&gt;\n        &lt;img src=\"http://pics.avs.io/al_square/24/24/TK@2x.png\" class=\"airlogo\"    title=\"Turkish Airlines\"&gt;\n        &lt;div class=\"amount\"&gt;9 479\n            &lt;span class=\"rub\"&gt;\u0420&lt;/span&gt;\n        &lt;/div&gt;\n        &lt;a href=\"/travel/Order/Index/h7676Rn7471rdd?fid=349&amp;amp;come=0\" class=\"yellow front\"&gt;BUY&lt;/a&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>If I get value &lt; 5 000 i clicked 'index +1'. How do this in cycle?</p>\n\n<pre><code>browser.div(:class =&gt; 'single sort', :index =&gt; 0).div(:class, 'amount').text\n</code></pre>\n\n<p>Formatting the text this way</p>\n\n<pre><code>sum = browser.div(:class =&gt; 'single sort', :index =&gt; 0).div(:class, 'amount').text\nsum.gsub!(/[^0-9]/, '')\nsum = sum.to_i\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "edited": false, "score": 0, "creation_date": 1449664531, "post_id": 34178919, "comment_id": 56104162, "body": "You understood correctly, but please show what log says about <code>Parameters: {...}</code> for your request"}, {"owner": {"reputation": 566, "user_id": 1590160, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/eUsM6.jpg?s=128&g=1", "display_name": "Uzair", "link": "https://stackoverflow.com/users/1590160/uzair"}, "edited": false, "score": 0, "creation_date": 1449664566, "post_id": 34178919, "comment_id": 56104182, "body": "Which Rails version you are using?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1449664811, "post_id": 34178919, "comment_id": 56104333, "body": "<i>Sidenote</i>: use banged version of <code>update_attributes!</code>\u2014it will throw an exception rather than silently return <code>false</code> on any error."}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 2, "creation_date": 1449665087, "post_id": 34178919, "comment_id": 56104489, "body": "How do you generate the form? Using the Rails form helper for example results in nested params: something like <code>params[:uploader][:name]</code> (where <code>:uploader</code> depends on your models class."}, {"owner": {"reputation": 568, "user_id": 1708150, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/8d730761b0b9ca2fcd5a1bad4bfd0df0?s=128&d=identicon&r=PG&f=1", "display_name": "BnMcG", "link": "https://stackoverflow.com/users/1708150/bnmcg"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1449673716, "post_id": 34178919, "comment_id": 56110518, "body": "@mudasobwa thanks for the tip, I&#39;ve changed to using that version! To others, I&#39;ve added the log file entry and the form itself. Thanks in advance!"}, {"owner": {"reputation": 2307, "user_id": 219594, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/87b214a1096bea2042c331b63eb1fa22?s=128&d=identicon&r=PG", "display_name": "andrykonchin", "link": "https://stackoverflow.com/users/219594/andrykonchin"}, "edited": false, "score": 0, "creation_date": 1449677077, "post_id": 34178919, "comment_id": 56113073, "body": "It seems your params are in nested hash, so you have to address them as <code>params[: s3_destination][...]</code>, like <code>params[: s3_destination][...][:name]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 568, "user_id": 1708150, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/8d730761b0b9ca2fcd5a1bad4bfd0df0?s=128&d=identicon&r=PG&f=1", "display_name": "BnMcG", "link": "https://stackoverflow.com/users/1708150/bnmcg"}, "edited": false, "score": 0, "creation_date": 1449685788, "post_id": 34184173, "comment_id": 56118953, "body": "Ahah! Thanks for the information! I was using strong parameters before but didn&#39;t know how to make it exclude certain values."}], "tags": [], "owner": {"reputation": 16076, "user_id": 802618, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6111449042dd940f360673d25d61ea6b?s=128&d=identicon&r=PG", "display_name": "Kristj&#225;n", "link": "https://stackoverflow.com/users/802618/kristj%c3%a1n"}, "is_accepted": true, "score": 1, "last_activity_date": 1449679240, "creation_date": 1449679240, "answer_id": 34184173, "question_id": 34178919, "link": "https://stackoverflow.com/questions/34178919/ruby-on-rails-params-variable-in-controller/34184173#34184173", "title": "Ruby on Rails: params[] Variable in Controller", "body": "<p>You're referencing <code>params[:name]</code>, but the parameters are all bundled up together under <code>params[:s3_destination]</code>, so you need to reference <code>params[:s3_destination][:name]</code>, etc.</p>\n\n<p>The nice thing about this is you don't need to call out each attribute you want to update. In simple cases, you can just</p>\n\n<pre><code>@s3_destination.update_attributes(params[:s3_destination])\n</code></pre>\n\n<p>For safety (eg, so I can't edit the form to submit attributes you don't want me editing), you should use <a href=\"http://edgeguides.rubyonrails.org/action_controller_overview.html#strong-parameters\" rel=\"nofollow\">strong parameters</a>:</p>\n\n<pre><code>s3_params = params.require(:s3_destination)\n  .permit(:name, :bucket, :region, :credentials_id, :credentials_secret)\n@s3_destination.update_attributes(s3_params)\n</code></pre>\n\n<p>And then for your <code>credentials_secret</code> logic, you can just delete the blank value from this hash:</p>\n\n<pre><code>s3_params = params.require(:s3_destination)\n  .permit(:name, :bucket, :region, :credentials_id, :credentials_secret)\ns3_params.delete(:credentials_secret) if s3_params[:credentials_secret].blank?\n@s3_destination.update_attributes(s3_params)\n</code></pre>\n\n<p><a href=\"http://api.rubyonrails.org/classes/Object.html#method-i-blank-3F\" rel=\"nofollow\"><code>blank?</code></a> will catch both <code>nil</code> and <code>\"\"</code> the way you're currently doing with <code>.to_s.empty?</code>.</p>\n"}], "owner": {"reputation": 568, "user_id": 1708150, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/8d730761b0b9ca2fcd5a1bad4bfd0df0?s=128&d=identicon&r=PG&f=1", "display_name": "BnMcG", "link": "https://stackoverflow.com/users/1708150/bnmcg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1324, "favorite_count": 0, "accepted_answer_id": 34184173, "answer_count": 1, "score": 0, "last_activity_date": 1449679240, "creation_date": 1449664356, "last_edit_date": 1449673688, "question_id": 34178919, "link": "https://stackoverflow.com/questions/34178919/ruby-on-rails-params-variable-in-controller", "title": "Ruby on Rails: params[] Variable in Controller", "body": "<p>I'm new to Ruby (and Rails), so apologies for the basic question.</p>\n\n<p>As I understand it, the <code>params[...]</code> variable inside of my controller is supposed to hold data from the form I've just submitted on my web page? I'm trying to use the following code to update a model depending on whether or not a field is blank:</p>\n\n<pre><code>@s3_destination = S3Destination.find(params[:id])\n\nif params[:credentials_secret].to_s.empty?\n\n    update = @s3_destination.update_attributes({\n         :name =&gt; params[:name],\n         :bucket =&gt; params[:bucket],\n         :region =&gt; params[:region],\n         :credentials_id =&gt; params[:credentials_id]\n    })\n\n    if update\n        redirect_to @s3_destination\n    else\n        render 'edit'\n    end\n\nelse\n\n    update = @s3_destination.update_attributes({\n         :name =&gt; params[:name],\n         :bucket =&gt; params[:bucket],\n         :region =&gt; params[:region],\n         :credentials_id =&gt; params[:credentials_id],\n         :credentials_secret =&gt; params[:credentials_secret],\n    })\n\n    if update\n        redirect_to @s3_destination\n    else\n        render 'edit'\n    end\n\nend\n</code></pre>\n\n<p>The controller action executes fine, but there is now no data in the model, so I'm assuming i'm doing something wrong when setting it in the update_attributes function.</p>\n\n<p>Shouldn't <code>params[:name]</code> take the value from the form element with the name \"name\"? Or have I misunderstood its purpose?</p>\n\n<p><strong>Edit</strong></p>\n\n<p>To answer some questions:</p>\n\n<p>I believe this is the relevant log entry, it all looks OK to me?</p>\n\n<pre>\nStarted PATCH \"/s3_destinations/1\" for 127.0.0.1 at 2015-12-09 12:40:51 +0000\nProcessing by S3DestinationsController#update as HTML\n  Parameters: {\"utf8\"=>\"\u2713\", \"authenticity_token\"=>\"a26uTf4+58v/O+pTqOYn0R7cjzGVWBnbFVdJ1OWwNnybEpUdYt2FNruOla/ikOnAFLpY3mn71Wow5oVee+R3Ng==\", \"s3_destination\"=>{\"name\"=>\"Cogative Bucket 1\", \"bucket\"=>\"cogative-backup-01\", \"region\"=>\"eu-west-1\", \"credentials_id\"=>\"AKIAIZG2HJ35NR3DQYGA\", \"credentials_secret\"=>\"12345\"}, \"commit\"=>\"Save S3 destination\", \"id\"=>\"1\"}\n  User Load (0.1ms)  SELECT  \"users\".* FROM \"users\" WHERE \"users\".\"id\" = ?  ORDER BY \"users\".\"id\" ASC LIMIT 1  [[\"id\", 1]]\n  S3Destination Load (0.0ms)  SELECT  \"s3_destinations\".* FROM \"s3_destinations\" WHERE \"s3_destinations\".\"id\" = ? LIMIT 1  [[\"id\", 1]]\n   (0.1ms)  begin transaction\n   (0.0ms)  commit transaction\nRedirected to http://localhost:3000/s3_destinations/1\nCompleted 302 Found in 3ms (ActiveRecord: 0.2ms)\n</pre>\n\n<p>The form itself is generated like this:</p>\n\n<pre><code>&lt;h2&gt;Editing AWS S3 Destination&lt;/h2&gt;\n\n&lt;%= form_for :s3_destination, url: s3_destination_path(@s3_destination), method: :patch do |f| %&gt;\n\n    &lt;% if @s3_destination.errors.any? %&gt;\n        &lt;div id=\"error_explanation\"&gt;\n          &lt;h2&gt;\n            &lt;%= pluralize(@s3_destination.errors.count, \"error\") %&gt; prohibited this source from being saved:\n          &lt;/h2&gt;\n          &lt;ul&gt;\n            &lt;% @s3_destination.errors.full_messages.each do |msg| %&gt;\n                &lt;li&gt;&lt;%= msg %&gt;&lt;/li&gt;\n            &lt;% end %&gt;\n          &lt;/ul&gt;\n        &lt;/div&gt;\n    &lt;%end %&gt;\n\n    &lt;p&gt;\n      &lt;%= f.label :name %&gt;&lt;br&gt;\n      &lt;%= f.text_field :name %&gt;\n    &lt;/p&gt;\n\n    &lt;p&gt;\n      &lt;%= f.label :bucket %&gt;&lt;br&gt;\n      &lt;%= f.text_field :bucket %&gt;\n    &lt;/p&gt;\n\n    &lt;select name=\"s3_destination[region]\"&gt;\n      &lt;option value=\"us-east-1\"&gt;US Standard (N. Virginia)&lt;/option&gt;\n      &lt;option value=\"us-west-2\"&gt;US West (Oregon)&lt;/option&gt;\n      &lt;option value=\"us-west-1\"&gt;US West (N. California)&lt;/option&gt;\n      &lt;option value=\"eu-west-1\"&gt;EU (Ireland)&lt;/option&gt;\n      &lt;option value=\"eu-central-1\"&gt;EU (Frankfurt)&lt;/option&gt;\n      &lt;option value=\"ap-southeast-1\"&gt;Asia Pacific (Singapore)&lt;/option&gt;\n      &lt;option value=\"ap-southeast-2\"&gt;Asia Pacific (Sydney)&lt;/option&gt;\n      &lt;option value=\"ap-northeast-1\"&gt;Asia Pacific (Tokyo)&lt;/option&gt;\n      &lt;option value=\"sa-east-1\"&gt;South America (Sao Paulo)&lt;/option&gt;\n    &lt;/select&gt;\n\n    &lt;p&gt;\n      &lt;%= f.label :credentials_id %&gt;&lt;br&gt;\n      &lt;%= f.text_field :credentials_id %&gt;\n    &lt;/p&gt;\n\n    &lt;p&gt;\n      &lt;%= f.label :credentials_secret %&gt;&lt;br&gt;\n      &lt;%= f.password_field :credentials_secret %&gt;\n    &lt;/p&gt;\n\n    &lt;p&gt;\n      &lt;%= f.submit %&gt;\n    &lt;/p&gt;\n\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "faraday", "exact-online"], "comments": [{"owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "edited": false, "score": 0, "creation_date": 1449664067, "post_id": 34178748, "comment_id": 56103897, "body": "By &#39;authorized on different page&#39; - do you mean that you passed auth data to api and authorized there?"}, {"owner": {"reputation": 765, "user_id": 3828533, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ovLic.jpg?s=128&g=1", "display_name": "Little Phild", "link": "https://stackoverflow.com/users/3828533/little-phild"}, "reply_to_user": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "edited": false, "score": 0, "creation_date": 1449664824, "post_id": 34178748, "comment_id": 56104346, "body": "Basically I have a button in App if you click on it, it connects to exactonline authentication system and then after loggin it returns  me back to the app.  <code>It acts like facebook login button</code>: After wards if I try to access some data from Exactonline API it returns me 401 error"}, {"owner": {"reputation": 4100, "user_id": 915364, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/40874c7300e2dccd3628b3542ae4d492?s=128&d=identicon&r=PG", "display_name": "Guido Leenders", "link": "https://stackoverflow.com/users/915364/guido-leenders"}, "edited": false, "score": 0, "creation_date": 1484474087, "post_id": 34178748, "comment_id": 70518178, "body": "Please remember to include the division ID in the URL. {division} is just a signal that you must fill it in. You can find division in the URL when logged on or use &#39;select * from systemdivisions&#39;."}], "answers": [{"comments": [{"owner": {"reputation": 765, "user_id": 3828533, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ovLic.jpg?s=128&g=1", "display_name": "Little Phild", "link": "https://stackoverflow.com/users/3828533/little-phild"}, "edited": false, "score": 0, "creation_date": 1449666295, "post_id": 34179087, "comment_id": 56105246, "body": "I have passed the access token but it is still outputting 404 error"}], "tags": [], "owner": {"reputation": 797, "user_id": 3067296, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZaNmN.png?s=128&g=1", "display_name": "DannyRosenblatt", "link": "https://stackoverflow.com/users/3067296/dannyrosenblatt"}, "is_accepted": false, "score": 0, "last_activity_date": 1449664874, "creation_date": 1449664874, "answer_id": 34179087, "question_id": 34178748, "link": "https://stackoverflow.com/questions/34178748/how-to-retrieve-data-from-an-api-using-faraday-gem/34179087#34179087", "title": "How to retrieve data from an Api using Faraday gem", "body": "<p>For APIs there is often authentication required on each request in the form of a token passed in your HTTP headers. If that is how this API works, you may try something like:</p>\n\n<pre><code>@exact_conn.get do |req|\n  req.url('/api/v1/{division}/salesinvoice/SalesInvoices')\n  req.headers['Authorization'] = \"Token token=#{your_token_here}\"\nend\n</code></pre>\n"}], "owner": {"reputation": 765, "user_id": 3828533, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/ovLic.jpg?s=128&g=1", "display_name": "Little Phild", "link": "https://stackoverflow.com/users/3828533/little-phild"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 504, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484474040, "creation_date": 1449663819, "last_edit_date": 1484474040, "question_id": 34178748, "link": "https://stackoverflow.com/questions/34178748/how-to-retrieve-data-from-an-api-using-faraday-gem", "title": "How to retrieve data from an Api using Faraday gem", "body": "<p>Am trying to access data from Exact Online API Using Faraday Gem and it is returning the status of <code>\"401\"</code> meaning am not authorized to access that link before I login, but I had already been authenticated and I logged in successfully in a different page. </p>\n\n<p>If I try to access that link individually via the browser URL bar I can see the data.</p>\n\n<p><strong>Here is my controller</strong></p>\n\n<pre><code> def example1\n    @exact_conn = Faraday.new(:url =&gt; 'https://start.exactonline.nl') do |data|\n      data.request :url_encoded\n      data.response :logger\n      data.adapter Faraday.default_adapter\n    end\n\n   data = @exact_conn.get(\"/api/v1/{division}/salesinvoice/SalesInvoices\"\n   @received_data = data.status\n  end\n</code></pre>\n\n<p><strong>my View</strong></p>\n\n<pre><code>&lt;h1&gt;Received Data&lt;/h1&gt;\n&lt;%= @received_data %&gt;\n</code></pre>\n\n<p>How can i solve this issue? <br>Or\nIs their any other option I can use in order to access that data directly without being authenticated for second time?.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "sass"], "answers": [{"tags": [], "owner": {"reputation": 2946, "user_id": 1002965, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/EHzyL.jpg?s=128&g=1", "display_name": "cedlemo", "link": "https://stackoverflow.com/users/1002965/cedlemo"}, "is_accepted": true, "score": 0, "last_activity_date": 1449842226, "creation_date": 1449842226, "answer_id": 34225231, "question_id": 34178101, "link": "https://stackoverflow.com/questions/34178101/sass-ruby-module-how-to-modify-a-css-property/34225231#34225231", "title": "Sass ruby module, how to modify a Css property", "body": "<p>The method <code>Sass::Script::Tree::Literal.new</code> take as argument one of the subclasses of <code>Sass::Script::Value::Base</code> which are</p>\n\n<ul>\n<li><code>Sass::Script::Value::Bool</code></li>\n<li><code>Sass::Script::Value::Color</code></li>\n<li><code>Sass::Script::Value::List</code></li>\n<li><code>Sass::Script::Value::Map</code></li>\n<li><code>Sass::Script::Value::Null</code></li>\n<li><code>Sass::Script::Value::Number</code></li>\n<li><code>Sass::Script::Value::String</code></li>\n</ul>\n\n<p>Which leads to the following code:</p>\n\n<pre><code>root_node.children.each do |node|\n  node.each do |prop|\n    if prop.class == Sass::Tree::PropNode\n      if prop.name[0] == \"-GerminalNotebook-show-tabs\"\n        new_val = Sass::Script::Value::Bool.new(true)\n        prop.value = Sass::Script::Tree::Literal.new(new_val)\n        # instead of prop.value =  Sass::Script::Tree::Literal.new(true).class\n      end\n    end\n  end\nend        \n</code></pre>\n"}], "owner": {"reputation": 2946, "user_id": 1002965, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/EHzyL.jpg?s=128&g=1", "display_name": "cedlemo", "link": "https://stackoverflow.com/users/1002965/cedlemo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 34225231, "answer_count": 1, "score": 0, "last_activity_date": 1449842226, "creation_date": 1449661670, "last_edit_date": 1449757400, "question_id": 34178101, "link": "https://stackoverflow.com/questions/34178101/sass-ruby-module-how-to-modify-a-css-property", "title": "Sass ruby module, how to modify a Css property", "body": "<p>I parse a Css configuration with the sass ruby gem. The idea it first get a tree for the css and then try to modify some of the properties in order to get a new css configuration. Here is the code I have so far:</p>\n\n<pre><code>require \"sass\"\n\nDEFAULT_CSS = %Q{* {\n  -GerminalTerminal-foreground: \"#aeafad\";\n}\nGtkWindow {\n  -GerminalTerminal-background: \"#323232\";\n  -GerminalTerminal-black: \"#000000\";\n  -GerminalTerminal-red: \"#b9214f\";\n  -GerminalTerminal-green: \"#A6E22E\";\n  -GerminalTerminal-yellow: \"#ff9800\";\n  -GerminalTerminal-blue: \"#3399ff\";\n  -GerminalTerminal-magenta: \"#8e33ff\";\n  -GerminalTerminal-cyan: \"#06a2dc\";\n  -GerminalWindow-shell: \"/usr/bin/fish\";\n}\nGtkWindow GtkNotebook{  -GerminalTerminal-white: \"#B0B0B0\";\n  -GerminalTerminal-brightblack: \"#5D5D5D\";\n  -GerminalTerminal-brightred: \"#ff5c8d\";\n  -GerminalTerminal-brightgreen: \"#CDEE69\";\n  -GerminalTerminal-brightyellow: \"#ffff00\";\n  -GerminalTerminal-brightblue: \"#9CD9F0\";\n  -GerminalTerminal-brightmagenta: \"#FBB1F9\";\n  -GerminalTerminal-brightcyan: \"#77DFD8\";\n  -GerminalTerminal-brightwhite: \"#F7F7F7\";\n  -GerminalNotebook-show-tabs: false;\n}\n}\n\nengine = Sass::Engine.new(DEFAULT_CSS, :syntax =&gt; :scss)\n\nroot_node = engine.to_tree\n\nroot_node.children.each do |node|\n  node.each do |prop|\n    if prop.class == Sass::Tree::PropNode\n      if prop.name[0] == \"-GerminalNotebook-show-tabs\"\n        puts prop.value.class\n        puts Sass::Script::Tree::Literal.new(true).class\n        prop.value =  Sass::Script::Tree::Literal.new(true).class\n        puts prop.value.class\n      end\n    end\n  end\nend\n\nputs root_node.render\n</code></pre>\n\n<p>This result in the following output:</p>\n\n<pre><code>Sass::Script::Tree::Literal\nSass::Script::Tree::Literal\nSass::Script::Tree::Literal\n/home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/script/tree/literal.rb:45:in `_perform': undefined method `source_range=' for true:TrueClass (NoMethodError)\n    from /home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/script/tree/node.rb:50:in `perform'\n    from /home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/tree/visitors/perform.rb:395:in `visit_prop'\n    from /home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/tree/visitors/base.rb:36:in `visit'\n    from /home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/tree/visitors/perform.rb:158:in `block in visit'\n    from /home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/stack.rb:79:in `block in with_base'\n    from /home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/stack.rb:115:in `with_frame'\n    from /home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/stack.rb:79:in `with_base'\n    from /home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/tree/visitors/perform.rb:158:in `visit'\n    from /home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/tree/visitors/perform.rb:431:in `block (2 levels) in visit_rule'\n    from /home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/tree/visitors/perform.rb:431:in `map'\n    from /home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/tree/visitors/perform.rb:431:in `block in visit_rule'\n    from /home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/tree/visitors/perform.rb:179:in `with_environment'\n    from /home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/tree/visitors/perform.rb:429:in `visit_rule'\n    from /home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/tree/visitors/base.rb:36:in `visit'\n    from /home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/tree/visitors/perform.rb:158:in `block in visit'\n    from /home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/stack.rb:79:in `block in with_base'\n    from /home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/stack.rb:115:in `with_frame'\n    from /home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/stack.rb:79:in `with_base'\n    from /home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/tree/visitors/perform.rb:158:in `visit'\n    from /home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/tree/visitors/base.rb:52:in `block in visit_children'\n    from /home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/tree/visitors/base.rb:52:in `map'\n    from /home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/tree/visitors/base.rb:52:in `visit_children'\n    from /home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/tree/visitors/perform.rb:167:in `block in visit_children'\n    from /home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/tree/visitors/perform.rb:179:in `with_environment'\n    from /home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/tree/visitors/perform.rb:166:in `visit_children'\n    from /home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/tree/visitors/base.rb:36:in `block in visit'\n    from /home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/tree/visitors/perform.rb:186:in `visit_root'\n    from /home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/tree/visitors/base.rb:36:in `visit'\n    from /home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/tree/visitors/perform.rb:157:in `visit'\n    from /home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/tree/visitors/perform.rb:8:in `visit'\n    from /home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/tree/root_node.rb:36:in `css_tree'\n    from /home/cedlemo/.gem/ruby/2.2.0/gems/sass-3.4.19/lib/sass/tree/root_node.rb:20:in `render'\n    from sass_test.rb:63:in `&lt;main&gt;'\n</code></pre>\n\n<p>If I don't modify the value, I have no error. So my problem is clearly related on how to modify the value in the tree in order to have a new css configuration.</p>\n"}, {"tags": ["ruby", "appium"], "answers": [{"tags": [], "owner": {"reputation": 14407, "user_id": 3035830, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/14809f2ad7f14e2867798697ab8f8006?s=128&d=identicon&r=PG", "display_name": "shivam", "link": "https://stackoverflow.com/users/3035830/shivam"}, "is_accepted": true, "score": 1, "last_activity_date": 1449661607, "creation_date": 1449661607, "answer_id": 34178075, "question_id": 34177969, "link": "https://stackoverflow.com/questions/34177969/getting-error-while-executing-arc-command-to-start-appium-console/34178075#34178075", "title": "Getting error while executing arc command to start appium console", "body": "<p>The appium ruby console requires an <code>appium.txt</code> file to start a session, failing which it throws error. </p>\n\n<p><a href=\"https://github.com/appium/ruby_lib/blob/master/android_tests/appium.txt\" rel=\"nofollow\">Check this file for reference.</a> As per your error logs, file path should be: <code>/Users/neetesh/appium/appium.txt</code></p>\n"}], "owner": {"reputation": 56, "user_id": 4380586, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-euIbDGRD1bQ/AAAAAAAAAAI/AAAAAAAAAHU/ZOlLcfsmL0A/photo.jpg?sz=128", "display_name": "Neetesh Kumar Gupta", "link": "https://stackoverflow.com/users/4380586/neetesh-kumar-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1114, "favorite_count": 0, "accepted_answer_id": 34178075, "answer_count": 1, "score": -2, "last_activity_date": 1449661661, "creation_date": 1449661309, "last_edit_date": 1449661661, "question_id": 34177969, "link": "https://stackoverflow.com/questions/34177969/getting-error-while-executing-arc-command-to-start-appium-console", "title": "Getting error while executing arc command to start appium console", "body": "<p>I am getting following error while executing arc command in terminal to start Appium console.</p>\n\n<pre><code>/Users/neetesh/.rvm/gems/ruby-2.2.3/gems/appium_lib-8.0.0/lib/appium_lib/driver.rb:85:in `load_appium_txt': toml doesn't exist /Users/neetesh/appium/appium.txt (RuntimeError)\nfrom /Users/neetesh/.rvm/gems/ruby-2.2.3/gems/appium_console-1.0.4/lib/appium_console.rb:14:in `block in &lt;top (required)&gt;'\nfrom /Users/neetesh/.rvm/gems/ruby-2.2.3/gems/appium_console-1.0.4/lib/appium_console.rb:37:in `&lt;module:Console&gt;'\nfrom /Users/neetesh/.rvm/gems/ruby-2.2.3/gems/appium_console-1.0.4/lib/appium_console.rb:31:in `&lt;module:Appium&gt;'\nfrom /Users/neetesh/.rvm/gems/ruby-2.2.3/gems/appium_console-1.0.4/lib/appium_console.rb:30:in `&lt;top (required)&gt;'\nfrom /Users/neetesh/.rvm/rubies/ruby-2.2.3/lib/ruby/site_ruby/2.2.0/rubygems/core_ext/kernel_require.rb:69:in `require'\nfrom /Users/neetesh/.rvm/rubies/ruby-2.2.3/lib/ruby/site_ruby/2.2.0/rubygems/core_ext/kernel_require.rb:69:in `require'\nfrom /Users/neetesh/.rvm/gems/ruby-2.2.3/gems/appium_console-1.0.4/bin/arc:66:in `&lt;top (required)&gt;'\nfrom /Users/neetesh/.rvm/gems/ruby-2.2.3/bin/arc:23:in `load'\nfrom /Users/neetesh/.rvm/gems/ruby-2.2.3/bin/arc:23:in `&lt;main&gt;'\nfrom /Users/neetesh/.rvm/gems/ruby-2.2.3/bin/ruby_executable_hooks:15:in `eval'\nfrom /Users/neetesh/.rvm/gems/ruby-2.2.3/bin/ruby_executable_hooks:15:in `&lt;main&gt;'\n</code></pre>\n"}, {"tags": ["ruby", "null"], "comments": [{"owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "edited": false, "score": 0, "creation_date": 1449660724, "post_id": 34177684, "comment_id": 56101908, "body": "Can <code>var</code> possibly be <code>false</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 8, "last_activity_date": 1449660560, "creation_date": 1449660560, "answer_id": 34177728, "question_id": 34177684, "link": "https://stackoverflow.com/questions/34177684/can-i-shortcut-check-if-a-variable-is-nil-and-replace-by-a-default-value/34177728#34177728", "title": "Can I shortcut-check if a variable is `nil` and replace by a default value?", "body": "<p>It's as simple as this (assuming that <code>false</code> and <code>nil</code> are treated the same)</p>\n\n<pre><code>result = var || defaultvalue\n</code></pre>\n\n<p>If <code>false</code> is a legitimate value (not a missing one), then you have to do that ternary.</p>\n\n<pre><code> result = var.nil? ? defaultvalue : var\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 539, "user_id": 5545463, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/DLDIb.jpg?s=128&g=1", "display_name": "Victoria S.", "link": "https://stackoverflow.com/users/5545463/victoria-s"}, "edited": false, "score": 0, "creation_date": 1449660645, "post_id": 34177731, "comment_id": 56101861, "body": "I&#39;ve seen some programmers use <code>result || = default</code>. Am I correct in assuming it&#39;s the same thing?"}, {"owner": {"reputation": 969, "user_id": 2406872, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0d4899e8a37c73408c105c4912393a04?s=128&d=identicon&r=PG", "display_name": "Matheus208", "link": "https://stackoverflow.com/users/2406872/matheus208"}, "reply_to_user": {"reputation": 539, "user_id": 5545463, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/DLDIb.jpg?s=128&g=1", "display_name": "Victoria S.", "link": "https://stackoverflow.com/users/5545463/victoria-s"}, "edited": false, "score": 1, "creation_date": 1449660694, "post_id": 34177731, "comment_id": 56101889, "body": "@VictoriaS. That is syntactic sugar for <code>result = result || default</code>"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 539, "user_id": 5545463, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/DLDIb.jpg?s=128&g=1", "display_name": "Victoria S.", "link": "https://stackoverflow.com/users/5545463/victoria-s"}, "edited": false, "score": 0, "creation_date": 1449660713, "post_id": 34177731, "comment_id": 56101903, "body": "@VictoriaS.: almost. Here it&#39;s not applicable, because another var is checked for value, not <code>result</code>"}, {"owner": {"reputation": 539, "user_id": 5545463, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/DLDIb.jpg?s=128&g=1", "display_name": "Victoria S.", "link": "https://stackoverflow.com/users/5545463/victoria-s"}, "edited": false, "score": 0, "creation_date": 1449660754, "post_id": 34177731, "comment_id": 56101930, "body": "Ah, I see. Thanks for clarifying! :)"}], "tags": [], "owner": {"reputation": 14407, "user_id": 3035830, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/14809f2ad7f14e2867798697ab8f8006?s=128&d=identicon&r=PG", "display_name": "shivam", "link": "https://stackoverflow.com/users/3035830/shivam"}, "is_accepted": false, "score": 1, "last_activity_date": 1449660568, "creation_date": 1449660568, "answer_id": 34177731, "question_id": 34177684, "link": "https://stackoverflow.com/questions/34177684/can-i-shortcut-check-if-a-variable-is-nil-and-replace-by-a-default-value/34177731#34177731", "title": "Can I shortcut-check if a variable is `nil` and replace by a default value?", "body": "<p>Since <code>nil</code> is a falsely value. Therefore:</p>\n\n<pre><code>result = var || defaultvalue\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 437121, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f61956bd5060d920da7b2951c3e9373f?s=128&d=identicon&r=PG", "display_name": "rocksoccer", "link": "https://stackoverflow.com/users/437121/rocksoccer"}, "is_accepted": false, "score": 1, "last_activity_date": 1449660692, "creation_date": 1449660692, "answer_id": 34177771, "question_id": 34177684, "link": "https://stackoverflow.com/questions/34177684/can-i-shortcut-check-if-a-variable-is-nil-and-replace-by-a-default-value/34177771#34177771", "title": "Can I shortcut-check if a variable is `nil` and replace by a default value?", "body": "<p>Or if it is to check the var itself and assign default value. Also, if you are from another language, be careful which values are false in ruby.</p>\n\n<pre><code>result ||= default\n</code></pre>\n"}], "owner": {"reputation": 13671, "user_id": 242076, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/96d841bf8f4319a20d46efb0d75878ce?s=128&d=identicon&r=PG", "display_name": "ariel", "link": "https://stackoverflow.com/users/242076/ariel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 34177728, "answer_count": 3, "score": 1, "last_activity_date": 1449660931, "creation_date": 1449660433, "last_edit_date": 1449660931, "question_id": 34177684, "link": "https://stackoverflow.com/questions/34177684/can-i-shortcut-check-if-a-variable-is-nil-and-replace-by-a-default-value", "title": "Can I shortcut-check if a variable is `nil` and replace by a default value?", "body": "<p>Is there a way to shortcut-check if a variable is <code>nil</code>, and give a default value if it is? For instance, replace</p>\n\n<pre><code>result = (var == nil ? defaultvalue : var)\n</code></pre>\n\n<p>with something like</p>\n\n<pre><code>result = selfifnotnil(var, default)\n</code></pre>\n\n<p>Of course I could write <code>selfifnotnil</code> function like the ternary above, but is there any built in option?</p>\n"}, {"tags": ["ruby", "symbols"], "answers": [{"comments": [{"owner": {"reputation": 2341, "user_id": 5198101, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e368f319f68500b32b5fdbe73e27f640?s=128&d=identicon&r=PG&f=1", "display_name": "RaGa__M", "link": "https://stackoverflow.com/users/5198101/raga-m"}, "edited": false, "score": 0, "creation_date": 1449660750, "post_id": 34177540, "comment_id": 56101926, "body": ":Vas, is there any clear hierarchies there for symbol lookup like what ruby does when looking up methods from object to class to module to &#39;Class&#39; until Object"}, {"owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "reply_to_user": {"reputation": 2341, "user_id": 5198101, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e368f319f68500b32b5fdbe73e27f640?s=128&d=identicon&r=PG&f=1", "display_name": "RaGa__M", "link": "https://stackoverflow.com/users/5198101/raga-m"}, "edited": false, "score": 0, "creation_date": 1449661043, "post_id": 34177540, "comment_id": 56102102, "body": "Yes, method is searched in self.class.ancestors, first for exact match, then calling <code>method_missing</code>-resolvers"}, {"owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "reply_to_user": {"reputation": 2341, "user_id": 5198101, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e368f319f68500b32b5fdbe73e27f640?s=128&d=identicon&r=PG&f=1", "display_name": "RaGa__M", "link": "https://stackoverflow.com/users/5198101/raga-m"}, "edited": false, "score": 0, "creation_date": 1449661083, "post_id": 34177540, "comment_id": 56102123, "body": "Btw, <code>Object</code> is not on top of hierarchy, <code>BasicObject</code> is"}, {"owner": {"reputation": 2341, "user_id": 5198101, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e368f319f68500b32b5fdbe73e27f640?s=128&d=identicon&r=PG&f=1", "display_name": "RaGa__M", "link": "https://stackoverflow.com/users/5198101/raga-m"}, "edited": false, "score": 0, "creation_date": 1449661648, "post_id": 34177540, "comment_id": 56102468, "body": "Thanks i missed the basic object :) but single symbol :a  points to &quot;a&quot;  and def &quot;a&quot; how discrimination made  any algorithm if anywhere around i call someobject.a it calls  instance variable or methods?"}, {"owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "reply_to_user": {"reputation": 2341, "user_id": 5198101, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e368f319f68500b32b5fdbe73e27f640?s=128&d=identicon&r=PG&f=1", "display_name": "RaGa__M", "link": "https://stackoverflow.com/users/5198101/raga-m"}, "edited": false, "score": 0, "creation_date": 1449661844, "post_id": 34177540, "comment_id": 56102580, "body": "instance variables are only accessed in object context via <code>@variable</code>, everything else is methods (<code>attr_accessor</code> is just a syntax sugar for defining accessor-methods), and they do not need resolution, it&#39;s just a ivar-table lookup by symbol"}, {"owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "reply_to_user": {"reputation": 2341, "user_id": 5198101, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e368f319f68500b32b5fdbe73e27f640?s=128&d=identicon&r=PG&f=1", "display_name": "RaGa__M", "link": "https://stackoverflow.com/users/5198101/raga-m"}, "edited": false, "score": 1, "creation_date": 1449662116, "post_id": 34177540, "comment_id": 56102746, "body": "symbol do not point to anything, they are just names, you can think of them as of array indexes for example - if you have two arrays - <code>a = [&#39;string&#39;]</code> and <code>b = [lambda{ puts &#39;this is lambda&#39;}]</code>, then &quot;symbol&quot; <code>0</code> will have some similarity - by itself it is just a value, by which you can fetch something in other place"}], "tags": [], "owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "is_accepted": false, "score": 1, "last_activity_date": 1449660041, "creation_date": 1449660041, "answer_id": 34177540, "question_id": 34176710, "link": "https://stackoverflow.com/questions/34176710/how-symbols-are-resolved-in-ruby/34177540#34177540", "title": "How symbols are resolved in ruby", "body": "<p>Symbols deep inside are actually a mapping of a constant string to a integer, and after lookup they behave this way, for example - indexing on a symbol is faster than on a string (if hash has symbol keys), also symbol variables consume as much memory as Fixnums</p>\n\n<p>About lookup - ruby has 'environment' for every execution context, which has local variables table, they are nested thus names can be overloaded.\nGlobal scope has context too.</p>\n\n<p>So upon seeing a name (at this time name is already a symbol) - ruby looks for variable with this name in current context, then for methods, then again in parent context etc. (simplified, there are several other things checked)</p>\n"}, {"comments": [{"owner": {"reputation": 2341, "user_id": 5198101, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e368f319f68500b32b5fdbe73e27f640?s=128&d=identicon&r=PG&f=1", "display_name": "RaGa__M", "link": "https://stackoverflow.com/users/5198101/raga-m"}, "edited": false, "score": 0, "creation_date": 1449661377, "post_id": 34177876, "comment_id": 56102302, "body": "Stefan thanks!,but  its not about the count i am curious, we know because of the uniqueness properties of symbol the count obviously will not increase, it is totally about the discrimination the ruby makes and how it makes between &quot;a&quot; and the def &quot;a&quot; though both turned into single symbol &quot;:a&quot;"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "reply_to_user": {"reputation": 2341, "user_id": 5198101, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e368f319f68500b32b5fdbe73e27f640?s=128&d=identicon&r=PG&f=1", "display_name": "RaGa__M", "link": "https://stackoverflow.com/users/5198101/raga-m"}, "edited": false, "score": 1, "creation_date": 1449670013, "post_id": 34177876, "comment_id": 56107669, "body": "@RichardGeorge the symbol table is used to keep track of the defined symbols, i.e. it&#39;s basically an array of all symbols. It does not store any references to variables or methods."}, {"owner": {"reputation": 671, "user_id": 1022988, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/3bd37d358d61584d5d08b42148ab090c?s=128&d=identicon&r=PG", "display_name": "mackshkatz", "link": "https://stackoverflow.com/users/1022988/mackshkatz"}, "edited": false, "score": 0, "creation_date": 1480799192, "post_id": 34177876, "comment_id": 69114746, "body": "FWIW, from The Well Grounded Rubyist, &quot;The symbol table is basically an integer-based hash.&quot;"}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 4, "last_activity_date": 1449661041, "creation_date": 1449661041, "answer_id": 34177876, "question_id": 34176710, "link": "https://stackoverflow.com/questions/34176710/how-symbols-are-resolved-in-ruby/34177876#34177876", "title": "How symbols are resolved in ruby", "body": "<blockquote>\n  <p>The count was the same; i.e., adding <code>def a</code> did not increase the symbol table count.</p>\n</blockquote>\n\n<p>This is because symbol <code>:a</code> already exists:</p>\n\n<pre><code>$ ruby -e \"puts Symbol.all_symbols.count\"\n2504\n\n$ ruby -e \"puts Symbol.all_symbols\" | grep ^a | sort | head -n 5\na\nabort\nabort_on_exception\nabort_on_exception=\nabs\n</code></pre>\n\n<p>You can start Ruby with the <code>--disable-gems</code> options to get rid of it (and many other symbols):</p>\n\n<pre><code>$ ruby --disable-gems -e \"puts Symbol.all_symbols.count\"\n1689\n\n$ ruby --disable-gems -e \"puts Symbol.all_symbols\" | grep ^a | sort | head -n 5\nabort\nabort_on_exception\nabort_on_exception=\nabs\nabs2\n</code></pre>\n\n<p>Now, defining or referencing <code>a</code> actually increases the symbol count:</p>\n\n<pre><code>$ ruby --disable-gems -e \"puts Symbol.all_symbols.count\"\n1689\n\n$ ruby --disable-gems -e \"def a; end; puts Symbol.all_symbols.count\"\n1690\n\n$ ruby --disable-gems -e \"a = 1; puts Symbol.all_symbols.count\"\n1690\n</code></pre>\n"}], "owner": {"reputation": 2341, "user_id": 5198101, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/e368f319f68500b32b5fdbe73e27f640?s=128&d=identicon&r=PG&f=1", "display_name": "RaGa__M", "link": "https://stackoverflow.com/users/5198101/raga-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "accepted_answer_id": 34177876, "answer_count": 2, "score": 3, "last_activity_date": 1449661041, "creation_date": 1449657624, "last_edit_date": 1449659491, "question_id": 34176710, "link": "https://stackoverflow.com/questions/34176710/how-symbols-are-resolved-in-ruby", "title": "How symbols are resolved in ruby", "body": "<p>A book says that all identifiers and variables we declare/initialize/define in ruby will be included in the internal symbol table as a symbol; then Ruby looks it up whenever the included symbol is used anywhere in the program. For example, in the procedure:</p>\n\n<ul>\n<li><code>a = \"1\"</code></li>\n<li>Ruby includes variable <code>a</code> as <code>:a</code> inside its table.</li>\n<li><p><code>a</code> is used in the program:</p>\n\n<pre><code>def a\n  puts \"stack_overflow\"\nend\n</code></pre></li>\n</ul>\n\n<p>variable <code>a</code> and identifier <code>def a</code> have the single symbol <code>:a</code> stored in them. I checked the symbol count using <code>Symbol.all_symbols.count</code>. The count was the same; i.e., adding <code>def a</code> did not increase the symbol table count.</p>\n\n<p>How does ruby discriminate between variable <code>a</code> and an identifier <code>def a</code> when it sees <code>a</code> anywhere in the code?</p>\n\n<p>In <code>s = :x</code>, is the symbol variable <code>s</code> stored in the symbol table, or just the <code>:x</code>?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 1, "creation_date": 1449658028, "post_id": 34176646, "comment_id": 56100176, "body": "What is your question?"}, {"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1449658700, "post_id": 34176646, "comment_id": 56100641, "body": "@mudasobwa no, it is on line 26 <code>str1[&quot;data&quot;][ids[n].to_s][&quot;nickname&quot;]</code>"}, {"owner": {"reputation": 101, "user_id": 5658683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h1B3w.png?s=128&g=1", "display_name": "Yalikesifulei", "link": "https://stackoverflow.com/users/5658683/yalikesifulei"}, "reply_to_user": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1449662535, "post_id": 34176646, "comment_id": 56102986, "body": "@\u0417\u0435\u043b\u0451\u043d\u044b\u0439 I don&#39;t know how to fix this"}, {"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1449662783, "post_id": 34176646, "comment_id": 56103136, "body": "something here <code>str1[&quot;data&quot;][ids[n].to_s][&quot;nickname&quot;]</code> return the <code>nil</code>, maybe <code>str</code> or <code>ids</code>, to debug it is an easy way, add <code>puts str</code> after <code>str1 = JSON.parse(res.body)</code> and check output."}, {"owner": {"reputation": 4457, "user_id": 4856698, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YF1b0zyYypU/AAAAAAAAAAI/AAAAAAAAAB0/6hdTAeg_61s/photo.jpg?sz=128", "display_name": "NickGnd", "link": "https://stackoverflow.com/users/4856698/nickgnd"}, "edited": false, "score": 0, "creation_date": 1449662985, "post_id": 34176646, "comment_id": 56103254, "body": "Could you share the results of <code>JSON.parse(res.body)</code>? It seems that is missing the &quot;data&quot; key"}, {"owner": {"reputation": 101, "user_id": 5658683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h1B3w.png?s=128&g=1", "display_name": "Yalikesifulei", "link": "https://stackoverflow.com/users/5658683/yalikesifulei"}, "reply_to_user": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1449663060, "post_id": 34176646, "comment_id": 56103301, "body": "@\u0417\u0435\u043b\u0451\u043d\u044b\u0439 trouble is that it crashes after first run. When I run code at first, there is no errors."}, {"owner": {"reputation": 101, "user_id": 5658683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h1B3w.png?s=128&g=1", "display_name": "Yalikesifulei", "link": "https://stackoverflow.com/users/5658683/yalikesifulei"}, "reply_to_user": {"reputation": 4457, "user_id": 4856698, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YF1b0zyYypU/AAAAAAAAAAI/AAAAAAAAAB0/6hdTAeg_61s/photo.jpg?sz=128", "display_name": "NickGnd", "link": "https://stackoverflow.com/users/4856698/nickgnd"}, "edited": false, "score": 0, "creation_date": 1449665103, "post_id": 34176646, "comment_id": 56104496, "body": "@NickGnd no, it isn&#39;t missing &quot;data&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 143, "user_id": 11465115, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-h9yOprTZAcg/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rd7XEw6oYI3nF6Rxq7Ujn8qk30j-g/mo/photo.jpg?sz=128", "display_name": "Adebola", "link": "https://stackoverflow.com/users/11465115/adebola"}, "is_accepted": false, "score": 0, "last_activity_date": 1614678840, "creation_date": 1614678840, "answer_id": 66437069, "question_id": 34176646, "link": "https://stackoverflow.com/questions/34176646/ruby-nomethoderror-telegram-bot/66437069#66437069", "title": "Ruby NoMethodError // Telegram Bot", "body": "<p>If anyone is facing this same issue, I found a hacky fix for it. When running this code from my macOS terminal, I get the <strong>undefined method 'run'</strong> message. When I run it inside my vscode terminal on the other hand, it works correctly. I had this same issue on a Linux machine aswell. It probably has something to do with how my environment is setup.</p>\n<p>Hope this helps someone out.</p>\n"}], "owner": {"reputation": 101, "user_id": 5658683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h1B3w.png?s=128&g=1", "display_name": "Yalikesifulei", "link": "https://stackoverflow.com/users/5658683/yalikesifulei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 386, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1614678840, "creation_date": 1449657432, "question_id": 34176646, "link": "https://stackoverflow.com/questions/34176646/ruby-nomethoderror-telegram-bot", "title": "Ruby NoMethodError // Telegram Bot", "body": "<p>I'm using this Ruby code for running Telegram messenger bot. After code is runned with <code>/start</code> command, it crashes with the following error:</p>\n\n<pre><code>./bot.rb:26:in `block (3 levels) in &lt;main&gt;': undefined method `[]' for nil:NilClass (NoMethodError)\n        from ./bot.rb:20:in `loop'\n        from ./bot.rb:20:in `block (2 levels) in &lt;main&gt;'\n        from /var/lib/gems/2.1.0/gems/telegram-bot-ruby-0.3.11/lib/telegram/bot/client.rb:41:in `block in fetch_updates'\n        from /var/lib/gems/2.1.0/gems/telegram-bot-ruby-0.3.11/lib/telegram/bot/client.rb:37:in `each'\n        from /var/lib/gems/2.1.0/gems/telegram-bot-ruby-0.3.11/lib/telegram/bot/client.rb:37:in `fetch_updates'\n        from /var/lib/gems/2.1.0/gems/telegram-bot-ruby-0.3.11/lib/telegram/bot/client.rb:29:in `listen'\n        from ./bot.rb:17:in `block in &lt;main&gt;'\n        from /var/lib/gems/2.1.0/gems/telegram-bot-ruby-0.3.11/lib/telegram/bot/client.rb:22:in `run'\n        from /var/lib/gems/2.1.0/gems/telegram-bot-ruby-0.3.11/lib/telegram/bot/client.rb:10:in `run'\n        from ./bot.rb:16:in `&lt;main&gt;'\n</code></pre>\n\n<p>Bot code is here:</p>\n\n<pre><code>require 'telegram/bot' \ntoken = '...' \nrequire 'net/http' \nurl = URI.parse('http://api.wotblitz.ru/wotb/clans/info/?application_id=...&amp;clan_id=8') \nreq = Net::HTTP::Get.new(url.to_s) \nres = Net::HTTP.start(url.host, url.port) {|http| \n   http.request(req) \n   } \n\nrequire 'json'\nstr = JSON.parse(res.body)\nids = str[\"data\"][\"8\"][\"members_ids\"]\nn = 0\nm = ids.size - 1\nplayers = ''\nTelegram::Bot::Client.run(token) do |bot| \n    bot.listen do |message|\n        case message.text\n        when '/start' \n        loop do \n           url = URI.parse('http://api.wotblitz.ru/wotb/account/info/?application_id=...&amp;account_id=' + ids[n].to_s)\n             req = Net::HTTP::Get.new(url.to_s) \n             res = Net::HTTP.start(url.host, url.port) {|http| http.request(req) \n             }\n             str1 = JSON.parse(res.body)\n             nick = str1[\"data\"][ids[n].to_s][\"nickname\"]\n             players = players + nick + \"\\n\"\n            n += 1\n            break if n == m\n        end\n        bot.api.sendMessage(chat_id: message.chat.id, text:\"#{players}\")\n        end\n    end\nend\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1449658171, "creation_date": 1449658171, "answer_id": 34176876, "question_id": 34176431, "link": "https://stackoverflow.com/questions/34176431/why-files-arent-found-with-file-exist/34176876#34176876", "title": "Why files aren&#39;t found with File.exist", "body": "<p><code>File.exist?</code> is related to the current script directory, not to the internals of <code>Dir</code>. One might use:</p>\n\n<pre><code>File.exist?(File.join Dir.pwd, \"#{filename}.ogg\")\n</code></pre>\n\n<p>to achieve the requested functionality.</p>\n"}], "owner": {"reputation": 1769, "user_id": 7404985, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/5af90c0ebf26f5ddfc448b2779ab8a57?s=128&d=identicon&r=PG", "display_name": "Sascha Manns", "link": "https://stackoverflow.com/users/7404985/sascha-manns"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449669477, "creation_date": 1449656841, "last_edit_date": 1449669477, "question_id": 34176431, "link": "https://stackoverflow.com/questions/34176431/why-files-arent-found-with-file-exist", "title": "Why files aren&#39;t found with File.exist", "body": "<p>I have a working directory like that one:</p>\n\n<pre><code>sascha@sascha-desktop:~/Musik/RMB/Youtube-Music$ ls -la\ninsgesamt 46456\ndrwxrwxr-x 2 sascha sascha     4096 Dez  9 10:32 .\ndrwxrwxr-x 3 sascha sascha     4096 Dez  6 22:47 ..\n-rw-rw-r-- 1 sascha sascha 20751305 Apr 22  2015 RMB - Spring-dJl7zWZYj-E.mp4\n-rw-rw-r-- 1 sascha sascha  6051641 Apr 22  2015 RMB - Spring.m4a\n-rw-rw-r-- 1 sascha sascha 20751305 Apr 22  2015 RMB - Spring.mp4\n</code></pre>\n\n<p>In my Ruby program i'm having two methods:</p>\n\n<pre><code>def self.rename(title)\n    filename = title.to_s\n    ext = file_exist_ogg_m4a(filename)\n    filenamenew0 = filename.gsub(/ /, '_')\n    pattern = /[a-zA-Z0-9\\-\\s\\_]/\n    filenamenew = filenamenew0.split(//).keep_if do |chr|\n      chr =~ pattern\n    end.join\n    puts 'Renaming the downloaded file'\n    puts \"Filename: #{filename}\" # debug\n    puts \"Filenamenew: #{filenamenew}\" # debug\n    puts \"Extension: #{ext}\" # debug\n    puts Dir.pwd # debug\n    #FileUtils.mv(\"#{filename}.#{ext}\", \"#{filenamenew}.#{ext}\")\n    #[filenamenew, filename]\nend\n\ndef self.file_exist_ogg_m4a(filename)\n    puts 'Accessing file_exist_ogg_m4a'\n    puts Dir.pwd # debug\n    if File.exist?(\"#{filename}.ogg\")\n      ext = 'ogg'\n    elsif File.exist?(\"#{filename}.m4a\")\n      ext = 'm4a'\n    elsif File.exist?(\"#{filename}.webm\")\n      ext = 'webm'\n    end\n    puts ext # debug\n    puts 'Closing file_exist_ogg_m4a'\n    return ext # debug\n  end\n</code></pre>\n\n<p>I'm getting the extension through the file_exist_ogg_m4a method.</p>\n\n<p>By running the program it gives me:</p>\n\n<pre><code>Accessing file_exist_ogg_m4a\n/home/sascha/Musik/RMB/Youtube-Music\n\nClosing file_exist_ogg_m4a\nRenaming the downloaded file\nFilename: RMB - Spring\nFilenamenew: RMB_-_Spring\nExtension: \n/home/sascha/Musik/RMB/Youtube-Music\n</code></pre>\n\n<p>So it looks like i'm in the right directory, a #{filename}.m4a should be found, and the ext variable should contain \"m4a\".\nBut if i'm looking the running method \"rename\" looks me a empty #{ext}.</p>\n\n<p>If i'm using that code it finds a m4a file:</p>\n\n<pre><code>dir = Dir.pwd\nif !Dir.glob(\"#{dir}/*.ogg\").empty?\n  ext = 'ogg'\nelsif !Dir.glob(\"#{dir}/*.m4a\").empty?\n  ext = 'm4a'\nelsif !Dir.glob(\"#{dir}/*.webm\").empty?\n  ext = 'webm'\nend\n</code></pre>\n\n<p>So i think it has to do with the string \"filename\".\nMaybe anyone has an idea?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "email", "csv", "paperclip"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2536065"}, "edited": false, "score": 0, "creation_date": 1449656170, "post_id": 34175973, "comment_id": 56098947, "body": "I think you might have to provide more information. How are you currently attempting to send the email? How are you doing it differently from sending the email for csv data? I would be great to see that code."}, {"owner": {"reputation": 1433, "user_id": 703997, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/c4bda24c22a7e56894feb140e6b79c77?s=128&d=identicon&r=PG&f=1", "display_name": "Shruthi R", "link": "https://stackoverflow.com/users/703997/shruthi-r"}, "edited": false, "score": 0, "creation_date": 1449656302, "post_id": 34175973, "comment_id": 56099020, "body": "I am using single method for both csv and xls data."}, {"owner": {"reputation": 1433, "user_id": 703997, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/c4bda24c22a7e56894feb140e6b79c77?s=128&d=identicon&r=PG&f=1", "display_name": "Shruthi R", "link": "https://stackoverflow.com/users/703997/shruthi-r"}, "edited": false, "score": 0, "creation_date": 1449656338, "post_id": 34175973, "comment_id": 56099056, "body": "<code>Email.delay(:queue =&gt; &#39;other&#39;).deliver_welcome_mail(user)</code>"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1449658709, "post_id": 34175973, "comment_id": 56100648, "body": "Call <code>sheet.to_csv</code> from <code>roo</code> and then use your proven-to-work csv handler. The problem is that <code>roo</code> tries to save all the formatting."}], "owner": {"reputation": 1433, "user_id": 703997, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/c4bda24c22a7e56894feb140e6b79c77?s=128&d=identicon&r=PG&f=1", "display_name": "Shruthi R", "link": "https://stackoverflow.com/users/703997/shruthi-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1449663264, "creation_date": 1449655566, "last_edit_date": 1449663264, "question_id": 34175973, "link": "https://stackoverflow.com/questions/34175973/delayed-job-mail-is-not-sending-for-spreadsheet-data", "title": "Delayed Job - Mail is not sending for spreadsheet data", "body": "<p>In rails 4.2.4, I am using <code>gem 'delayed_job_active_record'</code> &amp; <code>gem 'daemons'</code> for sending an emails. </p>\n\n<p>Also I am importing a data from <code>.csv</code> and <code>.xls</code> file to my database. After saving an object I am trying to send an email using delay, but right now mail is sending only for data which is imported from <code>.csv</code> file. Mail is not sending for the data which is imported from <code>.xls</code> file.</p>\n\n<p>I am using <code>gem 'roo'</code> for extracting <code>xls</code> file data.</p>\n\n<p>In delayed_jobs table for spreadsheet data, <code>handler</code> field contains like below,</p>\n\n<pre><code>raw_attributes:\nname: User1\nemail: &amp;5 !ruby/string:Spreadsheet::Link\n  str: user1@gmail.com\n  url: mailto:user1@gmail.com\n  fragment: \n</code></pre>\n\n<p>In the same delayed_jobs table for csv data, <code>handler</code> field contains like below,</p>\n\n<pre><code>raw_attributes:\nname: \"User2\\tuser2@gmail.com\\t111111333\"\nid: 7\nemail: \nmobile_number: \n</code></pre>\n\n<p>I am extracting xls file data like below,</p>\n\n<pre><code>def extract_asset_data_from_xls(asset)\n  require 'spreadsheet'\n  filename = \"#{Rails.root}/#{asset.document.path}\"\n  if File.exist?(filename)\n    file = File.open(filename)\n    if file\n      worksheet = Spreadsheet.open(file).worksheet(0)\n      1.upto worksheet.last_row_index do |index|\n        row = worksheet.row(index)\n        user = User.new\n        user.name = row[0]\n        user.email = row[1]\n        user.save\n      end\n    end\n  else\n    puts \"#{filename} doesn't exists\".red\n    return\n  end\nend\n</code></pre>\n\n<p>How can I send an email to spreadsheet's data using <code>delay</code>?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "date", "ruby-on-rails-4", "timezone"], "comments": [{"owner": {"reputation": 3548, "user_id": 1381240, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VglOh.jpg?s=128&g=1", "display_name": "Dusht", "link": "https://stackoverflow.com/users/1381240/dusht"}, "edited": false, "score": 1, "creation_date": 1449655379, "post_id": 34175813, "comment_id": 56098411, "body": "I guess you need to provide time (instead of date) to convert to desired time_zone."}, {"owner": {"reputation": 4457, "user_id": 4856698, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YF1b0zyYypU/AAAAAAAAAAI/AAAAAAAAAB0/6hdTAeg_61s/photo.jpg?sz=128", "display_name": "NickGnd", "link": "https://stackoverflow.com/users/4856698/nickgnd"}, "edited": false, "score": 0, "creation_date": 1449656151, "post_id": 34175813, "comment_id": 56098927, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/5300493/convert-utc-to-local-time-in-rails-3\">Convert UTC to local time in Rails 3</a>"}, {"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1449656258, "post_id": 34175813, "comment_id": 56098993, "body": "I would use DateTime."}, {"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1449656788, "post_id": 34175813, "comment_id": 56099350, "body": "You question is vague. A date does not really have a timezone. TIME has a timezone. What are you trying to do with the date?"}, {"owner": {"reputation": 401, "user_id": 2248672, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3ea7b370b5f4b2807655a670194d8696?s=128&d=identicon&r=PG", "display_name": "Sakshi Jain", "link": "https://stackoverflow.com/users/2248672/sakshi-jain"}, "reply_to_user": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1449657709, "post_id": 34175813, "comment_id": 56099952, "body": "@Beartech I need to filter data according to the chosen date in a chosen admin timezone."}, {"owner": {"reputation": 401, "user_id": 2248672, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3ea7b370b5f4b2807655a670194d8696?s=128&d=identicon&r=PG", "display_name": "Sakshi Jain", "link": "https://stackoverflow.com/users/2248672/sakshi-jain"}, "reply_to_user": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1449657948, "post_id": 34175813, "comment_id": 56100126, "body": "@Beartech Wow! thanks a lot. Looks like it :)"}, {"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1449658052, "post_id": 34175813, "comment_id": 56100189, "body": "You can also check the DateTime object in someone else&#39;s timezone with `my_date.in_time_zone(&quot;UTC&quot;). That will show your Chicago DateTime in UTC."}, {"owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "edited": false, "score": 0, "creation_date": 1449658170, "post_id": 34175813, "comment_id": 56100279, "body": "If it works for you, please accept the answer."}], "answers": [{"tags": [], "owner": {"reputation": 5292, "user_id": 2727267, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0e7c773908a4f6095f63cb9553bbc7af?s=128&d=identicon&r=PG", "display_name": "Beartech", "link": "https://stackoverflow.com/users/2727267/beartech"}, "is_accepted": true, "score": 1, "last_activity_date": 1449658149, "last_edit_date": 1449658149, "creation_date": 1449656438, "answer_id": 34176272, "question_id": 34175813, "link": "https://stackoverflow.com/questions/34175813/convert-string-to-date-of-specific-timezone/34176272#34176272", "title": "Convert String to date of specific timezone", "body": "<p>Use DateTime:</p>\n\n<pre><code>from = \"June 13, 2015\"\n\nDateTime.strptime(from,\"%b %d, %Y\").in_time_zone(\"America/Chicago\")\n=&gt; Fri, 12 Jun 2015 19:00:00 CDT -05:00\n</code></pre>\n\n<p>Notice it is showing a time of 19:00. That's because a time is not specified so it thinks you are referring to 00:00 UTC, which is 19:00 CDT</p>\n\n<p>One way to achieve what you are trying to do is:</p>\n\n<pre><code>Date.strptime(from.strip,\"%b %d, %Y\").in_time_zone(\"America/Chicago\").to_datetime\n=&gt; Sat, 13 Jun 2015 00:00:00 -0500\n</code></pre>\n\n<p>This gives you a DateTime object at midnight on that date. You can then add time to get to a certain time of that day if you want.</p>\n\n<pre><code>my_date = Date.strptime(from.strip,\"%b %d, %Y\").in_time_zone(\"America/Chicago\").to_datetime\n  =&gt; Sat, 13 Jun 2015 00:00:00 -0500\n\nmy_date.in_time_zone(\"UTC\")\n  =&gt; Sat, 13 Jun 2015 05:00:00 UTC +00:00\n\nmy_date + 8.hours\n  =&gt; Sat, 13 Jun 2015 08:00:00 -0500\n</code></pre>\n"}], "owner": {"reputation": 401, "user_id": 2248672, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/3ea7b370b5f4b2807655a670194d8696?s=128&d=identicon&r=PG", "display_name": "Sakshi Jain", "link": "https://stackoverflow.com/users/2248672/sakshi-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 741, "favorite_count": 0, "accepted_answer_id": 34176272, "answer_count": 1, "score": -1, "last_activity_date": 1449658149, "creation_date": 1449655164, "last_edit_date": 1449657173, "question_id": 34175813, "link": "https://stackoverflow.com/questions/34175813/convert-string-to-date-of-specific-timezone", "title": "Convert String to date of specific timezone", "body": "<p>I need to convert a string to date in a specific timezone.</p>\n\n<p>Eg. </p>\n\n<pre><code>from = \"June 13, 2015\"\n\nDate.strptime(from,\"%b %d, %Y\") #=&gt; Sat, 13 Jun 2015\n\nDate.strptime(from.strip,\"%b %d, %Y\").in_time_zone(\"America/Chicago\") #=&gt; Sat, 13 Jun 2015 00:00:00 CDT -05:00 which is ActiveSupport::TimeWithZone format\n\nDate.strptime(from,\"%b %d, %Y\").in_time_zone(\"America/Chicago\").to_date #=&gt;Sat, 13 Jun 2015 which is in UTC Date class\n</code></pre>\n\n<p>I need the final date in America/Chicago timezone. How can I achieve that?</p>\n\n<p>I need to achieve a date in the desired timezone and not time in a desired timezone.</p>\n\n<p>Time.now.in_time_zone(\"Eastern Time (US &amp; Canada)\") will give ActiveSupport::TimeWithZone format while I need the date format in desired timezone.</p>\n"}, {"tags": ["ruby", "testing", "minitest"], "answers": [{"comments": [{"owner": {"reputation": 4054, "user_id": 3756358, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/41dcc37fe83d035fa725a8fa6f591c74?s=128&d=identicon&r=PG", "display_name": "Tobias", "link": "https://stackoverflow.com/users/3756358/tobias"}, "edited": false, "score": 1, "creation_date": 1449656077, "post_id": 34175932, "comment_id": 56098882, "body": "This is probably the reason. It removes overhead of writing a custom message but still describes why the assertion failed. I haven&#39;t looked onto this from this perspective. :)"}], "tags": [], "owner": {"reputation": 8160, "user_id": 163640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63f02794544d271573750a83842cf59?s=128&d=identicon&r=PG", "display_name": "eugen", "link": "https://stackoverflow.com/users/163640/eugen"}, "is_accepted": true, "score": 1, "last_activity_date": 1449655470, "creation_date": 1449655470, "answer_id": 34175932, "question_id": 34175800, "link": "https://stackoverflow.com/questions/34175800/why-should-i-use-assert-equal-instead-of-just-assert-with-an-equal-operator-in-m/34175932#34175932", "title": "Why should I use assert_equal instead of just assert with an equal operator in minitest?", "body": "<p>Usually you want <code>assert_equal</code> when you prefer clear failure messages.</p>\n\n<p>When you write <code>assert a == b</code> and the test fails for any reason, the message would just say something along the lines of <code>Assertion failed</code>.\nOn the other hand, if you use <code>assert_equal a, b</code> a failure will show a message like <code>Expected a to be equal to b</code> which gives you a bit more detail about why the test failed.</p>\n"}, {"comments": [{"owner": {"reputation": 4054, "user_id": 3756358, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/41dcc37fe83d035fa725a8fa6f591c74?s=128&d=identicon&r=PG", "display_name": "Tobias", "link": "https://stackoverflow.com/users/3756358/tobias"}, "edited": false, "score": 0, "creation_date": 1449656336, "post_id": 34175943, "comment_id": 56099053, "body": "I think this is exactly not the case since it&#39;s much more self describing if you look onto <code>a == b</code> than onto <code>assert_equal a, b</code>. Even more if you haven&#39;t used Minitest before. But I think @eugen is right with his assumption that&#39;s because of the custom message."}, {"owner": {"reputation": 6974, "user_id": 629873, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/37e0a0772ffc4ce993cedfb49c6ee6d2?s=128&d=identicon&r=PG", "display_name": "Sandip Ransing", "link": "https://stackoverflow.com/users/629873/sandip-ransing"}, "reply_to_user": {"reputation": 4054, "user_id": 3756358, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/41dcc37fe83d035fa725a8fa6f591c74?s=128&d=identicon&r=PG", "display_name": "Tobias", "link": "https://stackoverflow.com/users/3756358/tobias"}, "edited": false, "score": 0, "creation_date": 1449742119, "post_id": 34175943, "comment_id": 56143092, "body": "@Tobias As I said it is just matter of choice and of course <code>assert_equal</code> raises a different msg if assertion fails that is another advantage."}], "tags": [], "owner": {"reputation": 6974, "user_id": 629873, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/37e0a0772ffc4ce993cedfb49c6ee6d2?s=128&d=identicon&r=PG", "display_name": "Sandip Ransing", "link": "https://stackoverflow.com/users/629873/sandip-ransing"}, "is_accepted": false, "score": 2, "last_activity_date": 1449655489, "creation_date": 1449655489, "answer_id": 34175943, "question_id": 34175800, "link": "https://stackoverflow.com/questions/34175800/why-should-i-use-assert-equal-instead-of-just-assert-with-an-equal-operator-in-m/34175943#34175943", "title": "Why should I use assert_equal instead of just assert with an equal operator in minitest?", "body": "<p>I think it's just a matter of choice and for me <code>assert_equal</code> looks more readable than using <code>==</code></p>\n\n<pre><code>assert_equal expect, actual\n</code></pre>\n"}], "owner": {"reputation": 4054, "user_id": 3756358, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/41dcc37fe83d035fa725a8fa6f591c74?s=128&d=identicon&r=PG", "display_name": "Tobias", "link": "https://stackoverflow.com/users/3756358/tobias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 562, "favorite_count": 0, "accepted_answer_id": 34175932, "answer_count": 2, "score": 1, "last_activity_date": 1449655489, "creation_date": 1449655130, "question_id": 34175800, "link": "https://stackoverflow.com/questions/34175800/why-should-i-use-assert-equal-instead-of-just-assert-with-an-equal-operator-in-m", "title": "Why should I use assert_equal instead of just assert with an equal operator in minitest?", "body": "<p>I really enjoy Minitest and it's simplicity but I don't understand why I should use <code>assert_equal</code> instead of <code>assert</code> with the <code>==</code> operator.</p>\n\n<p>If I look into the <a href=\"https://github.com/seattlerb/minitest/blob/master/lib/minitest/assertions.rb#L161\" rel=\"nofollow\">Implementation</a> the <code>assert_equal</code> method does exactly the same as I said with the equal operator.</p>\n\n<p>Why do I need this step in between and not just use it directly?</p>\n\n<p>I also think that it won't be more readable just because of the <code>equal</code> there since <code>==</code> is pretty self explaining.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongodb", "mongoid", "geo"], "comments": [{"owner": {"reputation": 3528, "user_id": 626485, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b1640d773df77dab575dc0494f1cc996?s=128&d=identicon&r=PG", "display_name": "astroanu", "link": "https://stackoverflow.com/users/626485/astroanu"}, "edited": false, "score": 0, "creation_date": 1449655654, "post_id": 34175522, "comment_id": 56098589, "body": "i haven&#39;t used ruby see here for how to make a nearSphere query with mongo <a href=\"https://docs.mongodb.org/manual/reference/operator/query/nearSphere/\" rel=\"nofollow noreferrer\">docs.mongodb.org/manual/reference/operator/query/nearSphere</a>. $near and $nearSphere are differnt. The maxDistance should be in meters. what does 1000.fdiv(111.12) mean ?"}, {"owner": {"reputation": 2849, "user_id": 653378, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/99da5370aa9792c23e10d54b8a0bade2?s=128&d=identicon&r=PG", "display_name": "evuez", "link": "https://stackoverflow.com/users/653378/evuez"}, "reply_to_user": {"reputation": 3528, "user_id": 626485, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b1640d773df77dab575dc0494f1cc996?s=128&d=identicon&r=PG", "display_name": "astroanu", "link": "https://stackoverflow.com/users/626485/astroanu"}, "edited": false, "score": 0, "creation_date": 1449657008, "post_id": 34175522, "comment_id": 56099497, "body": "From <a href=\"http://stackoverflow.com/a/7702456/653378\">here</a>, the <code>1000.fdiv(111.12)</code> should convert km to degrees (so 1000km in degrees). I edited my question, in fact the <code>$near</code> work if I query on the <code>Location</code> model directly, so I think it has more to do with mongoid..."}, {"owner": {"reputation": 3528, "user_id": 626485, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b1640d773df77dab575dc0494f1cc996?s=128&d=identicon&r=PG", "display_name": "astroanu", "link": "https://stackoverflow.com/users/626485/astroanu"}, "edited": false, "score": 0, "creation_date": 1449661989, "post_id": 34175522, "comment_id": 56102678, "body": "degrees or radians ? i&#39;m sorry, i&#39;m not fluent with ruby syntax, but mongo does not support degree values, it must be radians. $nearSphere algorithm calculates distance as a sphere while $near would just calculate as a plain. For geolocation calculations $nearSphere will give you accurate results."}], "answers": [{"comments": [{"owner": {"reputation": 2849, "user_id": 653378, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/99da5370aa9792c23e10d54b8a0bade2?s=128&d=identicon&r=PG", "display_name": "evuez", "link": "https://stackoverflow.com/users/653378/evuez"}, "edited": false, "score": 0, "creation_date": 1449737639, "post_id": 34186574, "comment_id": 56140247, "body": "I use Mongoid 5, I tried with the <code>includes</code> but still no results."}], "tags": [], "owner": {"reputation": 1318, "user_id": 5586783, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/060731280703cb6c69bff0df57eb8898?s=128&d=identicon&r=PG", "display_name": "Andy Gauge", "link": "https://stackoverflow.com/users/5586783/andy-gauge"}, "is_accepted": false, "score": 0, "last_activity_date": 1449686588, "creation_date": 1449686588, "answer_id": 34186574, "question_id": 34175522, "link": "https://stackoverflow.com/questions/34175522/mongoid-2d-query-on-associated-model/34186574#34186574", "title": "Mongoid 2d query on associated model", "body": "<p>This looks like an eager loading issue to me.  Have you tried the <code>.includes(:location)</code> </p>\n\n<pre><code>Event.includes(:location).where('location.coordinates' =&gt; {'$near' =&gt; [40.7127837, -74.0059413], '$maxDistance' =&gt; 1000.fdiv(111.12)}).first\n</code></pre>\n\n<p>I've worked with mongoid before, but can't seem to nail down if it is needed, and which versions it is.  Eager loading is enabled by default on all models in some versions, and older versions inside the config file identity map needs to be set, but this was gone in version 4.</p>\n"}], "owner": {"reputation": 2849, "user_id": 653378, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/99da5370aa9792c23e10d54b8a0bade2?s=128&d=identicon&r=PG", "display_name": "evuez", "link": "https://stackoverflow.com/users/653378/evuez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449686588, "creation_date": 1449654425, "last_edit_date": 1449657095, "question_id": 34175522, "link": "https://stackoverflow.com/questions/34175522/mongoid-2d-query-on-associated-model", "title": "Mongoid 2d query on associated model", "body": "<p>I have two models, <code>Location</code> and <code>Event</code>.</p>\n\n<pre><code>class Event\n  include Mongoid::Document\n  field :name, type: String\n  belongs_to :location\n  index({'location.coordinates' =&gt; '2d'}, {unique: true})  # I added this later on because I had an error when querying on location.coordinates\nend\n\nclass Location\n  include Mongoid::Document\n  field :coordinates, type: Array\n  index({coordinates: '2d'}, {unique: true})\n  has_many :events\nend\n</code></pre>\n\n<p>Now if I create an <code>Event</code> with an associated location</p>\n\n<pre><code>Location.create({coordinates: [40.7127837, -74.0059413]})\nEvent.create({name: \"foo\", location: Location.first})\n</code></pre>\n\n<p>How can I query events near a specific location?\nI tried this:</p>\n\n<pre><code>Event.where('location.coordinates' =&gt; {'$near' =&gt; [40.7127837, -74.0059413], '$maxDistance' =&gt; 1000.fdiv(111.12)}).first\n</code></pre>\n\n<p>but it returns no results, while</p>\n\n<pre><code>Location.where('coordinates' =&gt; {'$near' =&gt; [40.7127837, -74.0059413], '$maxDistance' =&gt; 1000.fdiv(111.12)}).first\n</code></pre>\n\n<p>returns the <code>Location</code> object created earlier.</p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "nginx", "rvm"], "comments": [{"owner": {"reputation": 637, "user_id": 4012683, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0df29ae797a3cff85b01e88d75dc84b7?s=128&d=identicon&r=PG&f=1", "display_name": "huzefa biyawarwala", "link": "https://stackoverflow.com/users/4012683/huzefa-biyawarwala"}, "edited": false, "score": 0, "creation_date": 1449653223, "post_id": 34174950, "comment_id": 56096976, "body": "refer to this question , you will be able solve your error. <a href=\"https://stackoverflow.com/questions/33930368/ruby-on-rails-installing-error-on-ubuntu/33930487#33930487\" title=\"ruby on rails installing error on ubuntu\">stackoverflow.com/questions/33930368/&hellip;</a>"}, {"owner": {"reputation": 1509, "user_id": 5130783, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/MxMtc.jpg?s=128&g=1", "display_name": "Changnam Hong", "link": "https://stackoverflow.com/users/5130783/changnam-hong"}, "reply_to_user": {"reputation": 637, "user_id": 4012683, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0df29ae797a3cff85b01e88d75dc84b7?s=128&d=identicon&r=PG&f=1", "display_name": "huzefa biyawarwala", "link": "https://stackoverflow.com/users/4012683/huzefa-biyawarwala"}, "edited": false, "score": 0, "creation_date": 1449664195, "post_id": 34174950, "comment_id": 56103982, "body": "I&#39;m not sure it works, cause I already follow similar way to install my ruby."}], "owner": {"reputation": 1509, "user_id": 5130783, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/MxMtc.jpg?s=128&g=1", "display_name": "Changnam Hong", "link": "https://stackoverflow.com/users/5130783/changnam-hong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 404, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1449653219, "creation_date": 1449652878, "last_edit_date": 1449653219, "question_id": 34174950, "link": "https://stackoverflow.com/questions/34174950/how-to-handleor-update-ruby-version", "title": "How to handle(or update) ruby version", "body": "<p>I'm trying to use <code>nginx</code> to put my app on my domain. But while I'm doing I got this error.</p>\n\n<pre><code>   [ 2015-12-09 08:44:44.7819 23453/7f3b513b4700 age/Cor/CoreMain.cpp:794 ]: Disconnecting long-running connections for process 12443, application /home/ubuntu/bangcokelite/public\n    App 13735 stderr: ruby-2.2.2 is not installed.\n    App 13735 stdout: To install do: 'rvm install ruby-2.2.2'\n    App 13735 stdout:\n    App 13881 stdout:\n</code></pre>\n\n<p>So I followed recommendation, <code>rvm install ruby-2.2.2</code>, and got another error like </p>\n\n<pre><code>Searching for binary rubies, this might take some time.\nFound remote file https://rubies.travis-ci.org/ubuntu/14.04/x86_64/ruby-2.2.2.tar.bz2\nChecking requirements for ubuntu.\nRequirements installation successful.\nruby-2.2.2 - #configure\nruby-2.2.2 - #download\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\n  0 23.3M    0     0    0     0      0      0 --:--:--  0:00:01 --:--:--     0Warning: Failed to create the file bin-ruby-2.2.2.tar.bz2.part: Permission\nWarning: denied\n  0 23.3M    0 16384    0     0   9679      0  0:42:10  0:00:01  0:42:09  103k\ncurl: (23) Failed writing body (0 != 16384)\nThere was an error(23).\nChecking fallback: ftp://rubies.travis-ci.org/ubuntu/14.04/x86_64/ruby-2.2.2.tar.bz2?rvm=1.26.11\nChecking fallback: http://www.mirrorservice.org/sites/rubies.travis-ci.org/ubuntu/14.04/x86_64/ruby-2.2.2.tar.bz2?rvm=1.26.11\nNo fallback URL could be found, try increasing timeout with:\n\n    echo \"export rvm_max_time_flag=20\" &gt;&gt; ~/.rvmrc\n\nDownloading https://rubies.travis-ci.org/ubuntu/14.04/x86_64/ruby-2.2.2.tar.bz2 failed.\nMounting remote ruby failed with status 2, trying to compile.\nChecking requirements for ubuntu.\nRequirements installation successful.\nInstalling Ruby from source to: /home/ubuntu/.rvm/rubies/ruby-2.2.2, this may take a while depending on your cpu(s)...\nruby-2.2.2 - #downloading ruby-2.2.2, this may take a while depending on your connection...\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0Warning: Failed to create the file ruby-2.2.2.tar.bz2.part: Permission denied\n  0 12.6M    0 13032    0     0   728k      0  0:00:17 --:--:--  0:00:17  748k\ncurl: (23) Failed writing body (0 != 13032)\nThere was an error(23).\nChecking fallback: http://ftp.ruby-lang.org/pub/ruby/2.2/ruby-2.2.2.tar.bz2\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0Warning: Failed to create the file ruby-2.2.2.tar.bz2.part: Permission denied\n  0 12.6M    0  1167    0     0  16099      0  0:13:47 --:--:--  0:13:47 16208\ncurl: (23) Failed writing body (0 != 1167)\nThere was an error(23).\nFailed download\nThere has been an error fetching the ruby interpreter. Halting the installation.\n</code></pre>\n\n<p>Actually I got </p>\n\n<pre><code>ruby-2.2.2 is not installed.\nTo install do: 'rvm install ruby-2.2.2'\n</code></pre>\n\n<p>this error everytime when I run project from my Web IDE. However it didn't occur any problems, but right now I think I should fix it.\nAny ideas about this problem? Thanks</p>\n\n<p>edit from here------</p>\n\n<p>I started my project from this <a href=\"https://github.com/RailsApps/rails-devise\" rel=\"nofollow\">rails-devise</a> and it is based on <code>ruby-2.2.2</code>. But my Web IDE is <code>ruby-2.2.1</code>.</p>\n"}, {"tags": ["ruby", "refactoring"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1449651049, "post_id": 34174291, "comment_id": 56095539, "body": "Not sure what you&#39;re asking. if you&#39;re setting instance variables, you don&#39;t need to return multiple outputs, you can just later query those variables. If you return multiple outputs, you don&#39;t need to set instance variables. Can just use simple locals."}, {"owner": {"reputation": 1158, "user_id": 2747638, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/dWpWy.jpg?s=128&g=1", "display_name": "Mio", "link": "https://stackoverflow.com/users/2747638/mio"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1449651500, "post_id": 34174291, "comment_id": 56095830, "body": "@SergioTulentsev <code>@plugin</code> and <code>@plugin_found_by</code> are used in other place in my code. This code work I just wanted to know if it&#39;s possible to refactor it. Maybe it doesn&#39;t need to be refactored ? I&#39;m gonna edit the question."}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1449652158, "post_id": 34174629, "comment_id": 56096270, "body": "I think those methods are finders/scopes. So attaching additional logic to them is probably not good. Also it&#39;s debatable whether this field (<code>found_by</code>) even belongs to plugin. If we were to debate over OOP-purity, this field would belong to a <code>FoundPlugin</code>, not <code>Plugin</code>."}], "tags": [], "owner": {"reputation": 155803, "user_id": 314166, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zL1re.jpg?s=128&g=1", "display_name": "sawa", "link": "https://stackoverflow.com/users/314166/sawa"}, "is_accepted": false, "score": 2, "last_activity_date": 1449652171, "last_edit_date": 1449652171, "creation_date": 1449651947, "answer_id": 34174629, "question_id": 34174291, "link": "https://stackoverflow.com/questions/34174291/refactor-method-that-sets-two-instance-variables/34174629#34174629", "title": "Refactor method that sets two instance variables", "body": "<p>I am assuming that your <code>Plugin</code> class methods are constructors (return a new instance of <code>Plugin</code>).</p>\n\n<p>When you create new instances of <code>Plugin</code> using the constructors, you should make <code>@plugin_found_by</code> an instance variable of the <code>Plugin</code> instance, whose value depends on how it was created. You should also have a getter method in <code>Plugin</code> class.</p>\n\n<pre><code>class Plugin\n  attr_reader :plugin_found_by\n  def self.find_by_uid(plugin_id)\n    @plugin_found_by = :uid\n    ...\n  end\n  def self.find_by_adid(plugin_id)\n    @plugin_found_by = :aid\n    ...\n  end\nend\n</code></pre>\n\n<p>Then, your methods in the other class would be:</p>\n\n<pre><code>def plugin\n  @plugin ||= Plugin.find_by_uid(@plugin_id) || Plugin.find_by_adid(@plugin_id)\nend\ndef plugin_found_by\n  plugin.plugin_found_by\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1158, "user_id": 2747638, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/dWpWy.jpg?s=128&g=1", "display_name": "Mio", "link": "https://stackoverflow.com/users/2747638/mio"}, "edited": false, "score": 0, "creation_date": 1449653187, "post_id": 34174934, "comment_id": 56096955, "body": "thanks for the last one. Love it. Maybe not fan about monkey-patching found_by even with the super."}, {"owner": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "reply_to_user": {"reputation": 1158, "user_id": 2747638, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/dWpWy.jpg?s=128&g=1", "display_name": "Mio", "link": "https://stackoverflow.com/users/2747638/mio"}, "edited": false, "score": 1, "creation_date": 1449653806, "post_id": 34174934, "comment_id": 56097351, "body": "@BeniMio I like to help ;)"}], "tags": [], "owner": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "is_accepted": false, "score": 2, "last_activity_date": 1449652830, "creation_date": 1449652830, "answer_id": 34174934, "question_id": 34174291, "link": "https://stackoverflow.com/questions/34174291/refactor-method-that-sets-two-instance-variables/34174934#34174934", "title": "Refactor method that sets two instance variables", "body": "<p>You can use something like this.</p>\n\n<pre><code>def plugin_found_by\n  plugin unless @plugin_found_by\n  @plugin_found_by\nend\n\ndef plugin\n  find_plugin unless @plugin\n  @plugin\nend\n\ndef get_plugin(type = :uid)\n  Plugin.send(\"find_by_#{type}\", @plugin_id)\nend\n\ndef find_plugin\n  config = {:uid =&gt; :uid, :aid =&gt; :adid}\n  @plugin_found_by = config.select { |_, m| @plugin = get_plugin(m); !@plugin.nil? }.keys[0]\nend\n</code></pre>\n\n<p>but the better way is to use something like this</p>\n\n<pre><code>class Plugin\n  attr_reader :found_by\n\n  def self.find_by_uid(id)\n    @found_by = :uid\n    super(id)\n  end\n\n  def self.find_by_adid(id)\n    @found_by = :aid\n    super(id)\n  end\nend\n\ndef plugin_found_by\n  plugin unless @plugin\n  @plugin.found_by\nend\n\ndef plugin\n  [:uid, :adid].each { |m|\n    if @plugin = Plugin.send(\"find_by_#{m}\", @plugin_id)\n      return @plugin\n    end\n  }\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "edited": false, "score": 0, "creation_date": 1449654948, "post_id": 34175543, "comment_id": 56098114, "body": "Mine first answer does not require to modify the <code>Plugin</code> class ;)"}], "tags": [], "owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "is_accepted": false, "score": 1, "last_activity_date": 1449654456, "creation_date": 1449654456, "answer_id": 34175543, "question_id": 34174291, "link": "https://stackoverflow.com/questions/34174291/refactor-method-that-sets-two-instance-variables/34175543#34175543", "title": "Refactor method that sets two instance variables", "body": "<p>If we assume that the code you have shown does not belong to <code>Plugin</code> class, and it belongs to another class which is a client of <code>Plugin</code> class and it has responsibility to cache an instance of <code>Plugin</code> and also keep the information of how it was found, you can rewrite the <code>plugin</code> method like below:</p>\n\n<pre><code> def plugin\n    @plugin, @plugin_found_by = [Plugin.find_by_uid(@plugin_id), :uid] unless @plugin\n    @plugin, @plugin_found_by = [Plugin.find_by_adid(@plugin_id), :aid] unless @plugin\n    @plugin\n end\n</code></pre>\n\n<p>Unlike other suggested answers, this solution does not require you to modify the <code>Plugin</code> class implementation</p>\n"}, {"comments": [{"owner": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "edited": false, "score": 0, "creation_date": 1449661203, "post_id": 34175743, "comment_id": 56102204, "body": "Your code returns <code>:adid</code> not <code>:aid</code>, but nice example"}, {"owner": {"reputation": 7844, "user_id": 1520557, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/9KKRA.png?s=128&g=1", "display_name": "Drenmi", "link": "https://stackoverflow.com/users/1520557/drenmi"}, "reply_to_user": {"reputation": 2572, "user_id": 2862049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffd65bc37e559c2c407f064f308828a4?s=128&d=identicon&r=PG&f=1", "display_name": "Lukas Baliak", "link": "https://stackoverflow.com/users/2862049/lukas-baliak"}, "edited": false, "score": 0, "creation_date": 1449665762, "post_id": 34175743, "comment_id": 56104915, "body": "Good catch @LukasBaliak! I&#39;m a little confused as to why OP would want to  return <code>:aid</code> when the actual finder method was <code>:adid</code>. :-)"}], "tags": [], "owner": {"reputation": 7844, "user_id": 1520557, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/9KKRA.png?s=128&g=1", "display_name": "Drenmi", "link": "https://stackoverflow.com/users/1520557/drenmi"}, "is_accepted": false, "score": 2, "last_activity_date": 1449654985, "creation_date": 1449654985, "answer_id": 34175743, "question_id": 34174291, "link": "https://stackoverflow.com/questions/34174291/refactor-method-that-sets-two-instance-variables/34175743#34175743", "title": "Refactor method that sets two instance variables", "body": "<p>Here's another unobtrusive solution that wraps the behaviour you've expressed into its own <code>PluginFinder</code> class:</p>\n\n<pre><code>class PluginFinder\n  FINDER_METHODS = [:uid, :adid]\n\n  def initialize(id)\n    @id = id\n  end\n\n  def plugin\n    @plugin || (find_plugin &amp;&amp; @plugin)\n  end\n\n  def found_by\n    @found_by || (find_plugin &amp;&amp; @found_by)\n  end\n\n  private\n\n  def find_plugin\n    @found_by = FINDER_METHODS.find { |m| find_by(m) }\n  end\n\n  def find_by(finder_method)\n    @plugin = ::Plugin.send(\"find_by_#{ finder_method }\", @id)\n  end\nend\n</code></pre>\n\n<p>Example usage:</p>\n\n<pre><code>finder = PluginFinder.new(1)\n\nplugin = finder.plugin\n#=&gt; &lt;Plugin:0x007f7fe5c90dd0&gt;\n\nfound_by = finder.found_by\n#=&gt; :uid\n</code></pre>\n"}], "owner": {"reputation": 1158, "user_id": 2747638, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/dWpWy.jpg?s=128&g=1", "display_name": "Mio", "link": "https://stackoverflow.com/users/2747638/mio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "answer_count": 4, "score": 0, "last_activity_date": 1449654985, "creation_date": 1449650741, "last_edit_date": 1449652327, "question_id": 34174291, "link": "https://stackoverflow.com/questions/34174291/refactor-method-that-sets-two-instance-variables", "title": "Refactor method that sets two instance variables", "body": "<p>I'm wondering how to refactor this part of code. I need to know how I get a plugin depending on how I found it:</p>\n\n<pre><code>  def plugin\n    return @plugin unless @plugin.nil?\n\n    @plugin = Plugin.find_by_uid(@plugin_id)\n    if @plugin.nil?\n      @plugin_found_by = :aid\n      @plugin = Plugin.find_by_adid(@plugin_id)\n    else\n      @plugin_found_by = :uid\n    end\n    @plugin\n  end\n\n  def plugin_found_by\n    plugin\n    @plugin_found_by\n  end\n</code></pre>\n\n<p>Is there a better way to do it ? <code>plugin</code> method seems quite repetitive. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "redmine"], "answers": [{"comments": [{"owner": {"reputation": 243, "user_id": 1677043, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/12575d69f907b398038da8acf85aaabf?s=128&d=identicon&r=PG", "display_name": "Grinchman", "link": "https://stackoverflow.com/users/1677043/grinchman"}, "edited": false, "score": 0, "creation_date": 1449650292, "post_id": 34174035, "comment_id": 56095066, "body": "Why <code>@sunday</code> variable isn&#39;t initialized in go_next_week? I supposed that when occurs first call of action &#39;index&#39; (when view is loading) <code>@sunday</code> is initializing. Or index action and go_next_week actions is call for different instances?"}, {"owner": {"reputation": 243, "user_id": 1677043, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/12575d69f907b398038da8acf85aaabf?s=128&d=identicon&r=PG", "display_name": "Grinchman", "link": "https://stackoverflow.com/users/1677043/grinchman"}, "edited": false, "score": 0, "creation_date": 1449653049, "post_id": 34174035, "comment_id": 56096849, "body": "In above answers I got clear understanding of instance variables logic. But I still don&#39;t see how to pass <code>sunday</code> value from <code>form_tag</code> to go_next_week(sunday) action."}, {"owner": {"reputation": 4054, "user_id": 3756358, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/41dcc37fe83d035fa725a8fa6f591c74?s=128&d=identicon&r=PG", "display_name": "Tobias", "link": "https://stackoverflow.com/users/3756358/tobias"}, "reply_to_user": {"reputation": 243, "user_id": 1677043, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/12575d69f907b398038da8acf85aaabf?s=128&d=identicon&r=PG", "display_name": "Grinchman", "link": "https://stackoverflow.com/users/1677043/grinchman"}, "edited": false, "score": 0, "creation_date": 1449653668, "post_id": 34174035, "comment_id": 56097261, "body": "Ok I understand now what you mean. These are two other controller actions not just methods which are called in the index action. I will update my answer."}, {"owner": {"reputation": 243, "user_id": 1677043, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/12575d69f907b398038da8acf85aaabf?s=128&d=identicon&r=PG", "display_name": "Grinchman", "link": "https://stackoverflow.com/users/1677043/grinchman"}, "edited": false, "score": 0, "creation_date": 1449656521, "post_id": 34174035, "comment_id": 56099178, "body": "Tobias, it partially helps ( As I understand to render index view with updated variables I have to put <code>render index</code> in the end of method go_next_week. Is that right? If so, I got another error: <code>ArgumentError (&#39;Tue, 01 Dec 2015..Thu, 31 Dec 2015&#39; is not an ActiveModel-compatible object. It must implement :to_partial_path.)</code> Is it issue with <code>currentweek</code> Range variable in index view or what?"}, {"owner": {"reputation": 4054, "user_id": 3756358, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/41dcc37fe83d035fa725a8fa6f591c74?s=128&d=identicon&r=PG", "display_name": "Tobias", "link": "https://stackoverflow.com/users/3756358/tobias"}, "reply_to_user": {"reputation": 243, "user_id": 1677043, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/12575d69f907b398038da8acf85aaabf?s=128&d=identicon&r=PG", "display_name": "Grinchman", "link": "https://stackoverflow.com/users/1677043/grinchman"}, "edited": false, "score": 0, "creation_date": 1449656747, "post_id": 34174035, "comment_id": 56099323, "body": "You should probably change your implementation if you want the same view but only the dates changed. I will post another answer how I would achieve this."}], "tags": [], "owner": {"reputation": 4054, "user_id": 3756358, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/41dcc37fe83d035fa725a8fa6f591c74?s=128&d=identicon&r=PG", "display_name": "Tobias", "link": "https://stackoverflow.com/users/3756358/tobias"}, "is_accepted": false, "score": 1, "last_activity_date": 1449653610, "last_edit_date": 1449653610, "creation_date": 1449649843, "answer_id": 34174035, "question_id": 34173671, "link": "https://stackoverflow.com/questions/34173671/ruby-on-rails-change-controllers-variable-through-view-and-render-updated-view/34174035#34174035", "title": "Ruby On Rails. Change controller&#39;s variable through view and render updated view", "body": "<p>You should probably initialize these instance variables in a <code>before_action</code>.</p>\n\n<p>So for example:</p>\n\n<pre><code>class MyController &lt; ActionController\n  before_action :set_dates\n\n  def index\n    # ... Your index implementation\n  end\n\n  def go_next_week\n    @monday = @sunday + 1\n    @sunday = @monday.end_of_week\n  end\n\n  def go_prev_week\n    @sunday = @monday - 1\n    @monday = @sunday.beginning_of_week\n  end\n\n  private\n\n  def set_dates\n    @today = Date::today\n    @monday = @today.beginning_of_week\n    @sunday = @today.end_of_week\n\n    @currentweek = @monday..@sunday\n  end\nend\n</code></pre>\n\n<p>In this way the dates will be initialized in every single action. But be careful! This this implementation above just allows to go one week back of further. To make this work with every week you have to provide a <code>param</code> with the current week for example.</p>\n\n<p>I hope this helps and if you need more information you are welcome. :)</p>\n"}, {"comments": [{"owner": {"reputation": 243, "user_id": 1677043, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/12575d69f907b398038da8acf85aaabf?s=128&d=identicon&r=PG", "display_name": "Grinchman", "link": "https://stackoverflow.com/users/1677043/grinchman"}, "edited": false, "score": 0, "creation_date": 1449651370, "post_id": 34174108, "comment_id": 56095749, "body": "If I use variable monday in index action, then I can&#39;t use it in some other actions?"}, {"owner": {"reputation": 217, "user_id": 5378932, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hpecR.jpg?s=128&g=1", "display_name": "Arvind Kumar", "link": "https://stackoverflow.com/users/5378932/arvind-kumar"}, "reply_to_user": {"reputation": 243, "user_id": 1677043, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/12575d69f907b398038da8acf85aaabf?s=128&d=identicon&r=PG", "display_name": "Grinchman", "link": "https://stackoverflow.com/users/1677043/grinchman"}, "edited": false, "score": 0, "creation_date": 1449652218, "post_id": 34174108, "comment_id": 56096323, "body": "you could not access. either you have to call the index method or you need to calculate"}], "tags": [], "owner": {"reputation": 217, "user_id": 5378932, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hpecR.jpg?s=128&g=1", "display_name": "Arvind Kumar", "link": "https://stackoverflow.com/users/5378932/arvind-kumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1449650121, "creation_date": 1449650121, "answer_id": 34174108, "question_id": 34173671, "link": "https://stackoverflow.com/questions/34173671/ruby-on-rails-change-controllers-variable-through-view-and-render-updated-view/34174108#34174108", "title": "Ruby On Rails. Change controller&#39;s variable through view and render updated view", "body": "<p>You are using @monday in the action go_prev_week,you are not calculating @monday inside the method,@monday is an instance variable its by default value is nil.</p>\n\n<p>You have two way to resolve this issue -</p>\n\n<p>First -</p>\n\n<pre><code>  def go_prev_week\n     index\n     @sunday = @monday - 1\n     @monday = @sunday.beginning_of_week\n  end\n</code></pre>\n\n<p>Second  - calculate @monday</p>\n\n<pre><code>  def go_prev_week\n     @today = Date::today\n     @monday = @today.beginning_of_week\n     @sunday = @monday - 1\n     @monday = @sunday.beginning_of_week\n  end\n</code></pre>\n\n<p>You have to do same thing in the action <strong><em>go_next_week</em></strong></p>\n"}, {"comments": [{"owner": {"reputation": 243, "user_id": 1677043, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/12575d69f907b398038da8acf85aaabf?s=128&d=identicon&r=PG", "display_name": "Grinchman", "link": "https://stackoverflow.com/users/1677043/grinchman"}, "edited": false, "score": 0, "creation_date": 1449651239, "post_id": 34174209, "comment_id": 56095667, "body": "Thanks for answer! I supposed that sunday and monday variables are initialized in index action and then I may use it in actions go_next_week and etc. Get I missed some theory of this?"}, {"owner": {"reputation": 73119, "user_id": 1143732, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mFUOI.jpg?s=128&g=1", "display_name": "Richard Peck", "link": "https://stackoverflow.com/users/1143732/richard-peck"}, "reply_to_user": {"reputation": 243, "user_id": 1677043, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/12575d69f907b398038da8acf85aaabf?s=128&d=identicon&r=PG", "display_name": "Grinchman", "link": "https://stackoverflow.com/users/1677043/grinchman"}, "edited": false, "score": 0, "creation_date": 1449651432, "post_id": 34174209, "comment_id": 56095795, "body": "Yep - <code>index</code> is not being invoked when you call another action. This means that <code>@monday</code> &amp; <code>@sunday</code> are not present, a big problem. You&#39;d be best setting them explicitly with <code>before_action</code> to make sure they&#39;re available to all actions that you need."}, {"owner": {"reputation": 243, "user_id": 1677043, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/12575d69f907b398038da8acf85aaabf?s=128&d=identicon&r=PG", "display_name": "Grinchman", "link": "https://stackoverflow.com/users/1677043/grinchman"}, "edited": false, "score": 0, "creation_date": 1449652029, "post_id": 34174209, "comment_id": 56096182, "body": "So instance variables only presents in current action? Not it whole Controller class? Then how to pass from index view value of monday(sunday) variable to increment\\decrement week in action go_next(prev)_week?"}, {"owner": {"reputation": 73119, "user_id": 1143732, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mFUOI.jpg?s=128&g=1", "display_name": "Richard Peck", "link": "https://stackoverflow.com/users/1143732/richard-peck"}, "reply_to_user": {"reputation": 243, "user_id": 1677043, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/12575d69f907b398038da8acf85aaabf?s=128&d=identicon&r=PG", "display_name": "Grinchman", "link": "https://stackoverflow.com/users/1677043/grinchman"}, "edited": false, "score": 0, "creation_date": 1449652439, "post_id": 34174209, "comment_id": 56096470, "body": "You can use the <code>before_action</code> code I put above to make the variables accessible to the specific action. When you invoke a class through Rails, it&#39;s only the action instance method which is loaded. Whilst you can call the other methods, it&#39;s not advisable. Thus, if you wanted to keep certain data available for a number of actions, you&#39;d set them with an instance method in the <code>before_action</code> callback -- which would make the data available as required."}, {"owner": {"reputation": 243, "user_id": 1677043, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/12575d69f907b398038da8acf85aaabf?s=128&d=identicon&r=PG", "display_name": "Grinchman", "link": "https://stackoverflow.com/users/1677043/grinchman"}, "edited": false, "score": 0, "creation_date": 1449652693, "post_id": 34174209, "comment_id": 56096615, "body": "Thanks for info about <code>before_action</code> callback and instance variables logic. But next problem is passing value of instance variable from <code>form_tag</code> to action &#39;go_next_week&#39;. As I think I could get some <code>params[]</code> in action, but I don&#39;t understand what and how to pass from <code>form_tag</code> to <code>params[] </code>of action."}, {"owner": {"reputation": 217, "user_id": 5378932, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/hpecR.jpg?s=128&g=1", "display_name": "Arvind Kumar", "link": "https://stackoverflow.com/users/5378932/arvind-kumar"}, "edited": false, "score": 0, "creation_date": 1449652830, "post_id": 34174209, "comment_id": 56096705, "body": "Good one, I suggest to follow this answer.Thanks Rich Peck"}, {"owner": {"reputation": 243, "user_id": 1677043, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/12575d69f907b398038da8acf85aaabf?s=128&d=identicon&r=PG", "display_name": "Grinchman", "link": "https://stackoverflow.com/users/1677043/grinchman"}, "edited": false, "score": 0, "creation_date": 1449657432, "post_id": 34174209, "comment_id": 56099760, "body": "I suppose your code is able to change only to 1 week back and forward."}], "tags": [], "owner": {"reputation": 73119, "user_id": 1143732, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mFUOI.jpg?s=128&g=1", "display_name": "Richard Peck", "link": "https://stackoverflow.com/users/1143732/richard-peck"}, "is_accepted": false, "score": 3, "last_activity_date": 1449650449, "last_edit_date": 1491982281, "creation_date": 1449650449, "answer_id": 34174209, "question_id": 34173671, "link": "https://stackoverflow.com/questions/34173671/ruby-on-rails-change-controllers-variable-through-view-and-render-updated-view/34174209#34174209", "title": "Ruby On Rails. Change controller&#39;s variable through view and render updated view", "body": "<blockquote>\n  <p>I'm very beginner in RoR and even in web-programming.</p>\n</blockquote>\n\n<p>Welcome!</p>\n\n<hr>\n\n<p>Your problem is that you're populating your controller action with <code>@instance_variables</code> which are reliant on each other:</p>\n\n<pre><code>def go_next_week\n  @monday = @sunday + 1           # needs @sunday\n  @sunday = @monday.end_of_week   # needs @monday\nend\n</code></pre>\n\n<p>In old school programming, that would have probably lead to an unrecognized reference error or perhaps a stack overflow error, typically due to infinite <a href=\"https://softwareengineering.stackexchange.com/questions/25052/in-plain-english-what-is-recursion\">recursion</a>.</p>\n\n<p>The error confirms this:</p>\n\n<blockquote>\n  <p>undefined method `-' for nil:NilClass</p>\n</blockquote>\n\n<p><code>Ruby</code> is different than most other languages in that it assigns undeclared variables to the <code>NilClass</code> object. This makes it very difficult for developers to determine the error - basically if you receive <code>undefined method for NilClass</code>, it's that you've not declared your variable.</p>\n\n<p>--</p>\n\n<p>The fix would be to get the data you're trying to manipulate into the instance of the class. This can be achieved with a <a href=\"http://api.rubyonrails.org/classes/AbstractController/Callbacks/ClassMethods.html#method-i-before_action\" rel=\"nofollow noreferrer\"><code>before_action</code></a> filter:</p>\n\n<pre><code>#app/controllers/work_days_controller.rb\nclass WorkDaysController &lt; ApplicationController\n   before_action :set_dates\n\n   def index\n      #@today, @monday, @sunday will be available in here.\n   end\n\n   private\n\n   def set_dates\n      @today = Date::today\n      @monday = @today.beginning_of_week\n      @sunday = @today.end_of_week\n   end\nend \n</code></pre>\n\n<hr>\n\n<p>You could also improve your routes to make use of the <a href=\"http://guides.rubyonrails.org/routing.html#resources-on-the-web\" rel=\"nofollow noreferrer\"><code>resources</code></a> directive:</p>\n\n<pre><code>#config/routes.rb\nresources :work_days do\n   get :go_next_week, on: :collection\n   get :go_prev_week, on: :collection\nend\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 243, "user_id": 1677043, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/12575d69f907b398038da8acf85aaabf?s=128&d=identicon&r=PG", "display_name": "Grinchman", "link": "https://stackoverflow.com/users/1677043/grinchman"}, "edited": false, "score": 1, "creation_date": 1449660117, "post_id": 34176880, "comment_id": 56101575, "body": "At first look it works! At least weeks in calendar is changing now! Thanks, Tobias! And since it&#39;s just a beginning of &quot;project&quot; I&#39;m sure that there will be not only one more question from me ))))"}], "tags": [], "owner": {"reputation": 4054, "user_id": 3756358, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/41dcc37fe83d035fa725a8fa6f591c74?s=128&d=identicon&r=PG", "display_name": "Tobias", "link": "https://stackoverflow.com/users/3756358/tobias"}, "is_accepted": true, "score": 1, "last_activity_date": 1449658177, "creation_date": 1449658177, "answer_id": 34176880, "question_id": 34173671, "link": "https://stackoverflow.com/questions/34173671/ruby-on-rails-change-controllers-variable-through-view-and-render-updated-view/34176880#34176880", "title": "Ruby On Rails. Change controller&#39;s variable through view and render updated view", "body": "<p>It look like that you want to have the same controller action and view but only with other dates.</p>\n\n<p>If that's the case I would recommend you something like this:</p>\n\n<pre><code>class MyController &lt; ApplicationController\n  before_action :set_date\n\n  def index\n  end\n\n  private\n\n  def set_date\n    if params[:week].present? &amp;&amp; params[:year].present?\n      @today = Date.commercial(params[:year].to_i, params[:week].to_i)\n    end\n\n    @today ||= Date::today # &lt;= Just use date today if it's not set already\n\n    @monday = @today.beginning_of_week\n    @sunday = @monday - 1\n    @monday = @sunday.beginning_of_week\n  end\nend\n</code></pre>\n\n<p><strong>The routes:</strong></p>\n\n<pre><code>RedmineApp::Application.routes.draw do\n  get 'calendar' =&gt; 'my_controller#index', as: :index_action\nend\n</code></pre>\n\n<p>Then you can add next/previous links to your view like this:</p>\n\n<pre><code>&lt;%= link_to \"Next\", index_action_path(year: @today.year, week: @today.cweek + 1) %&gt;\n&lt;%= link_to \"Previous\", index_action_path(year: @today.year, week: @today.cweek - 1) %&gt;\n</code></pre>\n\n<p>I haven't tested this implementation yet but it should work. You should add tests anyway.</p>\n\n<p>But you should definitively check the parameters if they are correct. For example if they are in the range of 1 to 52 for week and so on. Otherwise it will raise an exception if the week is out of range.</p>\n\n<p>Try also to not put logic into the view but in helper methods.</p>\n\n<p>I hope this helps and happy coding. :)</p>\n"}], "owner": {"reputation": 243, "user_id": 1677043, "user_type": "registered", "accept_rate": 10, "profile_image": "https://www.gravatar.com/avatar/12575d69f907b398038da8acf85aaabf?s=128&d=identicon&r=PG", "display_name": "Grinchman", "link": "https://stackoverflow.com/users/1677043/grinchman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2474, "favorite_count": 1, "accepted_answer_id": 34176880, "answer_count": 4, "score": 2, "last_activity_date": 1449658177, "creation_date": 1449648431, "last_edit_date": 1449648762, "question_id": 34173671, "link": "https://stackoverflow.com/questions/34173671/ruby-on-rails-change-controllers-variable-through-view-and-render-updated-view", "title": "Ruby On Rails. Change controller&#39;s variable through view and render updated view", "body": "<p>I'm very beginner in RoR and even in web-programming. So I guess my question is so easy for many developers!</p>\n\n<p>I'm implementing simple weeks calendar, it should have day's names and two \"buttons\" - 'next week' and 'previous week'. That's all for beginning!</p>\n\n<p>I have controller with index action:</p>\n\n<pre><code>    def index\n\n      @today = Date::today\n      @monday = @today.beginning_of_week\n      @sunday = @today.end_of_week\n\n      @currentweek = @monday..@sunday    \n   end\n</code></pre>\n\n<p>and two other actions:</p>\n\n<pre><code>  def go_next_week\n      @monday = @sunday + 1\n      @sunday = @monday.end_of_week\n  end\n\n  def go_prev_week\n      @sunday = @monday - 1\n      @monday = @sunday.beginning_of_week\n  end\n</code></pre>\n\n<p>index view code:</p>\n\n<pre><code>&lt;div class=\"wrapper\"&gt;\n  &lt;table class=\"data\"&gt;\n    &lt;thead&gt;\n    &lt;tr class=\"month-names\"&gt;      \n      &lt;td&gt;&lt;%= form_tag(work_days_go_prev_week_path, method: \"get\") do %&gt;\n            &lt;%= submit_tag(l((\"workdays_show_prev\" + period).to_sym)) %&gt;\n        &lt;% end %&gt;\n      &lt;/td&gt;\n      &lt;td&gt;&lt;%= render :partial =&gt; 'days_names_header' %&gt;&lt;/td&gt;\n      &lt;td&gt;&lt;%= form_tag(work_days_go_next_week_path, method: \"get\") do %&gt;\n            &lt;%= submit_tag(l((\"workdays_show_next\" + period).to_sym)) %&gt;\n        &lt;% end %&gt;\n      &lt;/td&gt;\n    &lt;/tr&gt;\n    &lt;/thead&gt;\n  &lt;/table&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>And the routes file:</p>\n\n<pre><code>RedmineApp::Application.routes.draw do\n  match 'work_days/go_next_week'            ,:to =&gt; 'work_days#go_next_week',           via: [:get]\n  match 'work_days/go_prev_week'            ,:to =&gt; 'work_days#go_prev_week',           via: [:get]\n  match 'work_days/(:action(/:id))',via: [:get], :controller =&gt; 'work_days'\nend\n</code></pre>\n\n<p>The main goal on that stage in short terms is:</p>\n\n<ul>\n<li><p>Controller has a Date variables 'monday','sunday' and Range\n'currentweek'</p></li>\n<li><p>Index view shows table of days according that    variables</p></li>\n<li><p>Index view has 2 \"buttons\": 'next week' and 'previous    week'</p></li>\n<li><p>Clicking on this buttons should change Controller's    variables</p></li>\n<li><p>Index view should \"refresh\" with changed Controller's    variables</p></li>\n</ul>\n\n<p>This code isn't working. I got such error in log when clicking on 'Previous month' button:</p>\n\n<blockquote>\n  <p>Started GET\n  \"/work_days/go_prev_week?tf8=%E2%9C%93&amp;commit=Previous+week\" for\n  127.0.0.1 at 2015-12-09 14:00:27 +0600 Processing by WorkDaysController#go_prev_week as HTML Parameters:\n  {\"utf8\"=>\"\u2713\",\"commit\"=>\"Previous week\"} Current user: admin (id=1)\n  Completed 500 Internal Server Error in 3ms (ActiveRecord: 0.2ms)</p>\n  \n  <p>NoMethodError (undefined method `-' for nil:NilClass)</p>\n</blockquote>\n"}, {"tags": ["ruby", "string"], "answers": [{"comments": [{"owner": {"reputation": 426, "user_id": 4637854, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/21b4842b1feb3ce6b2795df0af0f226f?s=128&d=identicon&r=PG&f=1", "display_name": "xxx", "link": "https://stackoverflow.com/users/4637854/xxx"}, "edited": false, "score": 0, "creation_date": 1449647893, "post_id": 34173442, "comment_id": 56093728, "body": "&quot;.*&quot; what does it means?"}], "tags": [], "owner": {"reputation": 17582, "user_id": 280143, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/46ac5380f2c25f9901f83964916c0226?s=128&d=identicon&r=PG", "display_name": "casraf", "link": "https://stackoverflow.com/users/280143/casraf"}, "is_accepted": true, "score": 5, "last_activity_date": 1449648814, "last_edit_date": 1449648814, "creation_date": 1449647626, "answer_id": 34173442, "question_id": 34173368, "link": "https://stackoverflow.com/questions/34173368/ruby-parse-string-and-return-array/34173442#34173442", "title": "Ruby parse string and return array", "body": "<p>Ruby has a built-in File class for similar cases.</p>\n\n<pre><code>fname = File.basename(str, '.*') # \"U6342_Account_20150112\"\nfname.split('_') # [\"U6342\", \"Account\", \"20150112\"]\n</code></pre>\n\n<p>Or, in short:</p>\n\n<pre><code>File.basename(str, '.*').split('_')\n</code></pre>\n\n<p><strong>Edit:</strong> the second parameter in <code>basename</code> tells the function what suffix the file has. It supports the <code>*</code> wildcard to match any suffix, and then removes it from the result. Examples:</p>\n\n<pre><code>File.basename(str, '.*') # \"U6342_Account_20150112\"\nFile.basename(str, '.txt') # \"U6342_Account_20150112\"\nFile.basename(str, '.jpg') # \"U6342_Account_20150112.txt\" =&gt; suffix not removed\n</code></pre>\n\n<p>Read more here <a href=\"http://ruby-doc.org/core-2.2.0/File.html#method-c-basename\" rel=\"nofollow\">http://ruby-doc.org/core-2.2.0/File.html#method-c-basename</a></p>\n"}], "owner": {"reputation": 426, "user_id": 4637854, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/21b4842b1feb3ce6b2795df0af0f226f?s=128&d=identicon&r=PG&f=1", "display_name": "xxx", "link": "https://stackoverflow.com/users/4637854/xxx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 34173442, "answer_count": 1, "score": 1, "last_activity_date": 1449648814, "creation_date": 1449647284, "last_edit_date": 1449648495, "question_id": 34173368, "link": "https://stackoverflow.com/questions/34173368/ruby-parse-string-and-return-array", "title": "Ruby parse string and return array", "body": "<p>I have input string <code>str =\"/Users/user/Desktop/task/U6342_Account_20150112.txt\"</code></p>\n\n<p>and in return I want array <code>['U6342','Account','20150112']</code></p>\n\n<p>To get the result what I did </p>\n\n<pre><code>str.split('/')[-1].gsub('.txt','').split('_')\n</code></pre>\n\n<p>which outputs <code>['U6342','Account','20150112']</code></p>\n\n<p>Now my question- Is there any better solution?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 797, "user_id": 2811283, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/427813bc0c42956e5d48c1e85a9c9618?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Taylor", "link": "https://stackoverflow.com/users/2811283/thomas-taylor"}, "edited": false, "score": 0, "creation_date": 1449648319, "post_id": 34173287, "comment_id": 56093968, "body": "Thanks, your solution was very close have made a small amendment. Will mark as correct as it pointed me in the right direction."}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": true, "score": 1, "last_activity_date": 1449648261, "last_edit_date": 1449648261, "creation_date": 1449647015, "answer_id": 34173287, "question_id": 34173032, "link": "https://stackoverflow.com/questions/34173032/active-record-select-query-to-where-and-joins-query/34173287#34173287", "title": "Active record select query to where and joins query", "body": "<pre><code>where(agent_id: agent_id) - \n  where(agent_id: agent_id)\n   .joins(real_property_sale: :real_property_sale_project)\n    .where.not(real_property_sale_projects: { failed_date: nil })\n</code></pre>\n"}], "owner": {"reputation": 797, "user_id": 2811283, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/427813bc0c42956e5d48c1e85a9c9618?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Taylor", "link": "https://stackoverflow.com/users/2811283/thomas-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 34173287, "answer_count": 1, "score": 2, "last_activity_date": 1449648261, "creation_date": 1449646109, "question_id": 34173032, "link": "https://stackoverflow.com/questions/34173032/active-record-select-query-to-where-and-joins-query", "title": "Active record select query to where and joins query", "body": "<p>I currently have the following Active Record <code>.select</code> query being utilised in one of my controllers: </p>\n\n<pre><code>@bids = current_user.bids.select { |bid| !bid.bid_has_failed_date }\n</code></pre>\n\n<p>and the <code>bid_has_failed_date</code> method in my <code>Bid</code> model for the condition:</p>\n\n<pre><code>def bid_has_failed_date\n  self.real_property_sale.try(:real_property_sale_project).try(:failed_date).present?\nend \n</code></pre>\n\n<p>I would prefer to use <code>.where</code> and <code>.joins</code> to do the same thing. So far I've got this: </p>\n\n<pre><code>.where(agent_id: agent_id).joins(real_property_sale: :real_property_sale_project).where(real_property_sale_projects: { failed_date: nil })\n</code></pre>\n\n<p>The problem with this is that it will only return a bid that has <code>real_property_sale_project</code> and a <code>failed_date</code> of nil. Instead I need it to return all bids excluding those where <code>failed_date</code> is present. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "openssl", "rvm"], "answers": [{"tags": [], "owner": {"reputation": 935, "user_id": 5039866, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/oH8jw.jpg?s=128&g=1", "display_name": "Nirajan Pokharel", "link": "https://stackoverflow.com/users/5039866/nirajan-pokharel"}, "is_accepted": true, "score": 1, "last_activity_date": 1449734935, "creation_date": 1449734935, "answer_id": 34196659, "question_id": 34172525, "link": "https://stackoverflow.com/questions/34172525/symbol-not-found-sslv2-client-method-loaderror/34196659#34196659", "title": "Symbol not found: _SSLv2_client_method (LoadError)", "body": "<p>You probably need to set the correct ruby version on your project using your ruby version manager \n <code>rvm --default 'ruby-version'</code> \nLet me know if that works </p>\n"}], "owner": {"reputation": 594, "user_id": 8934465, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-tzs1gobeQZ8/AAAAAAAAAAI/AAAAAAAAAOw/irKKhYM8Xj4/photo.jpg?sz=128", "display_name": "Milan Pudasaini", "link": "https://stackoverflow.com/users/8934465/milan-pudasaini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 334, "favorite_count": 0, "accepted_answer_id": 34196659, "answer_count": 1, "score": 4, "last_activity_date": 1449734935, "creation_date": 1449644322, "last_edit_date": 1495542193, "question_id": 34172525, "link": "https://stackoverflow.com/questions/34172525/symbol-not-found-sslv2-client-method-loaderror", "title": "Symbol not found: _SSLv2_client_method (LoadError)", "body": "<p>When i try to run the server it gives the following error</p>\n\n<pre><code>/Users/brijesh/.rvm/rubies/ruby-2.0.0-p353/lib/ruby/2.0.0/openssl.rb:17:in `require': dlopen(/Users/brijesh/.rvm/rubies/ruby-2.0.0-p353/lib/ruby/2.0.0/x86_64-darwin12.5.0/openssl.bundle, 9): Symbol not found: _SSLv2_client_method (LoadError)\n  Referenced from: /Users/brijesh/.rvm/rubies/ruby-2.0.0-p353/lib/ruby/2.0.0/x86_64-darwin12.5.0/openssl.bundle\n  Expected in: /usr/local/opt/openssl/lib/libssl.1.0.0.dylib\n in /Users/brijesh/.rvm/rubies/ruby-2.0.0-p353/lib/ruby/2.0.0/x86_64-darwin12.5.0/openssl.bundle - /Users/brijesh/.rvm/rubies/ruby-2.0.0-p353/lib/ruby/2.0.0/x86_64-darwin12.5.0/openssl.bundle\n    from /Users/brijesh/.rvm/rubies/ruby-2.0.0-p353/lib/ruby/2.0.0/openssl.rb:17:in `&lt;top (required)&gt;'\n    from /Users/brijesh/.rvm/gems/ruby-2.0.0-p353/gems/activesupport-4.1.4/lib/active_support/key_generator.rb:2:in `require'\n    from /Users/brijesh/.rvm/gems/ruby-2.0.0-p353/gems/activesupport-4.1.4/lib/active_support/key_generator.rb:2:in `&lt;top (required)&gt;'\n    from /Users/brijesh/.rvm/gems/ruby-2.0.0-p353/gems/railties-4.1.4/lib/rails/application.rb:4:in `require'\n    from /Users/brijesh/.rvm/gems/ruby-2.0.0-p353/gems/railties-4.1.4/lib/rails/application.rb:4:in `&lt;top (required)&gt;'\n    from /Users/brijesh/.rvm/gems/ruby-2.0.0-p353/gems/railties-4.1.4/lib/rails.rb:11:in `require'\n    from /Users/brijesh/.rvm/gems/ruby-2.0.0-p353/gems/railties-4.1.4/lib/rails.rb:11:in `&lt;top (required)&gt;'\n    from /Users/brijesh/.rvm/gems/ruby-2.0.0-p353/gems/railties-4.1.4/lib/rails/commands/server.rb:4:in `require'\n    from /Users/brijesh/.rvm/gems/ruby-2.0.0-p353/gems/railties-4.1.4/lib/rails/commands/server.rb:4:in `&lt;top (required)&gt;'\n    from /Users/brijesh/.rvm/gems/ruby-2.0.0-p353/gems/railties-4.1.4/lib/rails/commands/commands_tasks.rb:128:in `require'\n    from /Users/brijesh/.rvm/gems/ruby-2.0.0-p353/gems/railties-4.1.4/lib/rails/commands/commands_tasks.rb:128:in `require_command!'\n    from /Users/brijesh/.rvm/gems/ruby-2.0.0-p353/gems/railties-4.1.4/lib/rails/commands/commands_tasks.rb:74:in `server'\n    from /Users/brijesh/.rvm/gems/ruby-2.0.0-p353/gems/railties-4.1.4/lib/rails/commands/commands_tasks.rb:40:in `run_command!'\n    from /Users/brijesh/.rvm/gems/ruby-2.0.0-p353/gems/railties-4.1.4/lib/rails/commands.rb:17:in `&lt;top (required)&gt;'\n    from bin/rails:4:in `require'\n    from bin/rails:4:in `&lt;main&gt;'\n</code></pre>\n\n<p>After looking at the suggestion in this\n<a href=\"https://stackoverflow.com/questions/25492787/ruby-bundle-symbol-not-found-sslv2-client-method-loaderror\">Ruby Bundle Symbol not found: _SSLv2_client_method (LoadError)</a>\nthe problem is solved. But after restarting the computer i have to again go through the same procedure that is to do get stable rvm and reinstall the ruby again.</p>\n\n<p>Another thing i noticed was after restarting and opening the terminal it starts with the following error:</p>\n\n<pre><code>/Users/brijesh/.rvm/scripts/initialize:48: __rvm_cleanse_variables: function definition file not found\n</code></pre>\n\n<p>I am not sure what is going on and have been stuck in this for this long. I would really appreciate the help.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 5, "creation_date": 1449644782, "post_id": 34172303, "comment_id": 56092216, "body": "Ruby doesn&#39;t have a concept of <code>2D</code> or <code>nD</code> arrays. Please define it. I assume all elements of <code>array</code> are arrays, but are they necessary all equal in size, as would be the case for a 2D matrix?"}], "answers": [{"comments": [{"owner": {"reputation": 440, "user_id": 953878, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/afafdb6c3fa4eb2f9a79943484fa5a37?s=128&d=identicon&r=PG", "display_name": "Ankush Ganatra", "link": "https://stackoverflow.com/users/953878/ankush-ganatra"}, "edited": false, "score": 0, "creation_date": 1449644128, "post_id": 34172349, "comment_id": 56091948, "body": "I want to check if all element are array inside an array. I think all should help. Thanks."}, {"owner": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "reply_to_user": {"reputation": 440, "user_id": 953878, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/afafdb6c3fa4eb2f9a79943484fa5a37?s=128&d=identicon&r=PG", "display_name": "Ankush Ganatra", "link": "https://stackoverflow.com/users/953878/ankush-ganatra"}, "edited": false, "score": 0, "creation_date": 1449644245, "post_id": 34172349, "comment_id": 56091995, "body": "@AnkushGanatra: In that case, <code>my_array.all? { |e| e.kind_of? Array }</code>."}], "tags": [], "owner": {"reputation": 887, "user_id": 4664086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca859ce2ca107d4a1110965ef40d7f6?s=128&d=identicon&r=PG&f=1", "display_name": "Damiano Stoffie", "link": "https://stackoverflow.com/users/4664086/damiano-stoffie"}, "is_accepted": false, "score": 3, "last_activity_date": 1449644599, "last_edit_date": 1449644599, "creation_date": 1449643561, "answer_id": 34172349, "question_id": 34172303, "link": "https://stackoverflow.com/questions/34172303/easy-way-to-find-if-an-array-is-2d-array-or-not/34172349#34172349", "title": "Easy way to find if an array is 2d array or not?", "body": "<p>Super easy!</p>\n\n<p><code>my_array.all? { |e| e.kind_of? Array }</code></p>\n\n<p>Take a look at the <a href=\"http://ruby-doc.org/core-2.2.3/Enumerable.html\" rel=\"nofollow\">enumerable</a> module. You use <code>all?</code> if you want to check all the elements and <code>any?</code> if having one element that is an array is enough. Those methods are documented in the link</p>\n"}, {"tags": [], "owner": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "is_accepted": false, "score": 0, "last_activity_date": 1449644392, "last_edit_date": 1449644392, "creation_date": 1449643728, "answer_id": 34172393, "question_id": 34172303, "link": "https://stackoverflow.com/questions/34172303/easy-way-to-find-if-an-array-is-2d-array-or-not/34172393#34172393", "title": "Easy way to find if an array is 2d array or not?", "body": "<p>Given the clarified specification, this would work to ensure that you only have a 2D, and not 3+D array:</p>\n\n<pre><code>my_array.all? { |e| (e.kind_of? Array) &amp;&amp; e.flatten(1) == e}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": false, "score": 1, "last_activity_date": 1449644760, "last_edit_date": 1449644760, "creation_date": 1449644301, "answer_id": 34172520, "question_id": 34172303, "link": "https://stackoverflow.com/questions/34172303/easy-way-to-find-if-an-array-is-2d-array-or-not/34172520#34172520", "title": "Easy way to find if an array is 2d array or not?", "body": "<p>What you need is <a href=\"http://apidock.com/ruby/Enumerable/all%3F\" rel=\"nofollow\"><code>all?</code></a>:</p>\n\n<pre><code>a = [[\"a\", \"b\"],[\"c\", \"d\"],[\"e\", \"f\"]]\n#=&gt; [[\"a\", \"b\"], [\"c\", \"d\"], [\"e\", \"f\"]]\na.all?{|el| el.is_a? Array}\n#=&gt;true\n</code></pre>\n\n<p>In Ruby, Arrays are objects, they <strong>only have one dimension</strong>. But they can hold anything, including other arrays, so they can behave as multi\ndimensional arrays.</p>\n"}, {"comments": [{"owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "edited": false, "score": 0, "creation_date": 1449645576, "post_id": 34172614, "comment_id": 56092523, "body": "Can we use just <code>uniq</code> instead of <code>minmax.uniq</code> as I think it <code>minmax</code> does not achieve anything?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "edited": false, "score": 0, "creation_date": 1449646395, "post_id": 34172614, "comment_id": 56092955, "body": "Hats off to Wand! (Wand you can <a href=\"https://s-media-cache-ak0.pinimg.com/736x/fe/9d/95/fe9d953c8dc8edccde5ad7dec9bdf039.jpg\" rel=\"nofollow noreferrer\">leave yours on</a>.)"}], "tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 7, "last_activity_date": 1515463312, "last_edit_date": 1515463312, "creation_date": 1449644641, "answer_id": 34172614, "question_id": 34172303, "link": "https://stackoverflow.com/questions/34172303/easy-way-to-find-if-an-array-is-2d-array-or-not/34172614#34172614", "title": "Easy way to find if an array is 2d array or not?", "body": "<p>I've assumed that by \"2d array\" (which has no meaning in Ruby), the OP wants to determine if every element of the array is an array and all those element arrays are the same size, as is the case with a \"2d matrix\". </p>\n\n<p><strong>Edit 2:</strong> Here's another way (much better than my original answer below!):</p>\n\n<pre><code>def all_elements_arrays_of_same_size?(a)\n  !!(a.transpose rescue nil)\nend\n\nall_elements_arrays_of_same_size? [[\"a\", \"b\"],[\"c\", \"d\"],[\"e\", \"f\"]]\n  #=&gt; true \nall_elements_arrays_of_same_size? [[\"a\", \"b\"],[\"c\", \"d\", \"g\"],[\"e\", \"f\"]]\n  #=&gt; false \nall_elements_arrays_of_same_size? [[\"a\", \"b\"],\"c\",[\"e\", \"f\"]]\n  #=&gt; false\nall_elements_arrays_of_same_size? [[\"a\", \"b\"],\"c\", {a:1}]\n  #=&gt; false\nall_elements_arrays_of_same_size? [[1,2,3,4,5,6,7,8], 1]\n  #=&gt; false\n</code></pre>\n\n<p><strong>Edit 1:</strong> @WandMaker makes a very good point [regarding my original answer below]. Formerly I had <code>a.map(&amp;:size).minmax.uniq.size</code>. Ive removed <code>minimax</code> as he suggested.]</p>\n\n<p>I assumed a \"2D array\" is an array whose elements are arrays of the same size. </p>\n\n<pre><code>def all_elements_arrays_of_same_size?(a)\n  a.all? { |e| e.class==Array } &amp;&amp; a.map(&amp;:size).uniq.size == 1\nend\n\nall_elements_arrays_of_same_size? [[\"a\", \"b\"],[\"c\", \"d\"],[\"e\", \"f\"]]\n  #=&gt; true \nall_elements_arrays_of_same_size? [[\"a\", \"b\"],[\"c\", \"d\", \"g\"],[\"e\", \"f\"]]\n  #=&gt; false \nall_elements_arrays_of_same_size? [[\"a\", \"b\"],\"c\",[\"e\", \"f\"]]\n  #=&gt; false\nall_elements_arrays_of_same_size? [[\"a\", \"b\"],\"c\", {a:1}]\n  #=&gt; false\nall_elements_arrays_of_same_size? [[1,2,3,4,5,6,7,8], 1]\n  #=&gt; false\n</code></pre>\n\n<p>For the last example, note <code>[1,2,3,4,5,6,7,8].size #=&gt; 8</code> and <code>1.size #=&gt; 8</code>.</p>\n\n<p>The steps are as follows:</p>\n\n<p>For:</p>\n\n<pre><code>array = [[\"a\", \"b\"],[\"c\", \"d\"],[\"e\", \"f\"]]\n\narray.all? { |e| e.class==Array }\n  #=&gt; true \na = array.map(&amp;:size)\n  #=&gt; [2, 2, 2] \nb = a.uniq\n  #=&gt; [2] \nb.size == 1\n  #=&gt; true \n</code></pre>\n\n<p>On the other hand, for:</p>\n\n<pre><code>array = [[\"a\", \"b\"],[\"c\", \"d\", \"g\"],[\"e\", \"f\"]]\n\narray.all? { |e| e.class==Array }\n  #=&gt; true \na = array.map(&amp;:size)\n  #=&gt; [2, 3, 2] \nb = a.uniq\n  #=&gt; [2, 3] \nb.size == 1\n  #=&gt; false\n</code></pre>\n\n<p>For:</p>\n\n<pre><code>array = [[\"a\", \"b\"],\"c\", {a:1}]\n\narray.all? { |e| e.class==Array }\n  #=&gt; false\n</code></pre>\n"}], "owner": {"reputation": 440, "user_id": 953878, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/afafdb6c3fa4eb2f9a79943484fa5a37?s=128&d=identicon&r=PG", "display_name": "Ankush Ganatra", "link": "https://stackoverflow.com/users/953878/ankush-ganatra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1313, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1515463312, "creation_date": 1449643390, "question_id": 34172303, "link": "https://stackoverflow.com/questions/34172303/easy-way-to-find-if-an-array-is-2d-array-or-not", "title": "Easy way to find if an array is 2d array or not?", "body": "<p>There has be a better alternative to find if array is 2d array. </p>\n\n<pre><code>my_array = [[\"a\", \"b\"],[\"c\", \"d\"],[\"e\", \"f\"]]\n!my_array.map{|element| element.is_a? Array}.include? false\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "git", "heroku", "sqlite"], "comments": [{"owner": {"reputation": 3548, "user_id": 1381240, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VglOh.jpg?s=128&g=1", "display_name": "Dusht", "link": "https://stackoverflow.com/users/1381240/dusht"}, "edited": false, "score": 0, "creation_date": 1449641827, "post_id": 34171874, "comment_id": 56091003, "body": "Which OS you are using ?"}, {"owner": {"reputation": 2060, "user_id": 3625058, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PEy9i.jpg?s=128&g=1", "display_name": "matanco", "link": "https://stackoverflow.com/users/3625058/matanco"}, "edited": false, "score": 1, "creation_date": 1449641875, "post_id": 34171874, "comment_id": 56091022, "body": "here is your answer: <a href=\"http://stackoverflow.com/questions/15795942/how-to-enable-c-extension-support-in-jruby\" title=\"how to enable c extension support in jruby\">stackoverflow.com/questions/15795942/&hellip;</a>"}, {"owner": {"reputation": 8160, "user_id": 163640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d63f02794544d271573750a83842cf59?s=128&d=identicon&r=PG", "display_name": "eugen", "link": "https://stackoverflow.com/users/163640/eugen"}, "edited": false, "score": 2, "creation_date": 1449642816, "post_id": 34171874, "comment_id": 56091396, "body": "You&#39;re trying to use the native sqlite gem with Jruby. This answer might be helpful: <a href=\"http://stackoverflow.com/a/7786796/163640\">stackoverflow.com/a/7786796/163640</a>"}, {"owner": {"reputation": 3548, "user_id": 1381240, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VglOh.jpg?s=128&g=1", "display_name": "Dusht", "link": "https://stackoverflow.com/users/1381240/dusht"}, "edited": false, "score": 0, "creation_date": 1449643313, "post_id": 34171874, "comment_id": 56091590, "body": "Windows for Ruby on Rails! I hope god will always be with you :)"}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 5657250, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153158447847793/picture?type=large", "display_name": "Frank Aaron Seager", "link": "https://stackoverflow.com/users/5657250/frank-aaron-seager"}, "edited": false, "score": 0, "creation_date": 1449684990, "post_id": 34173534, "comment_id": 56118448, "body": "I posted above the results i got from $ gem install sqlite3 . The i posted above is the error im having installing sqlite3."}, {"owner": {"reputation": 2130, "user_id": 384052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0badad420e8e5ef6285e105e81766904?s=128&d=identicon&r=PG", "display_name": "benjamin", "link": "https://stackoverflow.com/users/384052/benjamin"}, "reply_to_user": {"reputation": 81, "user_id": 5657250, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153158447847793/picture?type=large", "display_name": "Frank Aaron Seager", "link": "https://stackoverflow.com/users/5657250/frank-aaron-seager"}, "edited": false, "score": 0, "creation_date": 1449747662, "post_id": 34173534, "comment_id": 56146633, "body": "In case the link in Joel&#39;s answer is outdated, just google for installation+sqlite3+your_os_version. Installing other gems can fails with similar error messages, so repeat the procedure if necessary."}], "tags": [], "owner": {"reputation": 2130, "user_id": 384052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0badad420e8e5ef6285e105e81766904?s=128&d=identicon&r=PG", "display_name": "benjamin", "link": "https://stackoverflow.com/users/384052/benjamin"}, "is_accepted": false, "score": 0, "last_activity_date": 1449647934, "creation_date": 1449647934, "answer_id": 34173534, "question_id": 34171874, "link": "https://stackoverflow.com/questions/34171874/an-error-occurred-while-installing-sqlite3-1-3-11-and-bundler-cannot-continue/34173534#34173534", "title": "An error occurred while installing sqlite3 (1.3.11), and Bundler cannot continue", "body": "<p>You have to install the <em>sqlite3</em> database for your operating system, preferably through the tool your OS provides. After doing this, try installing the gem again. Chances are you have to resolve similar errors by the same procedure.</p>\n"}, {"tags": [], "owner": {"reputation": 361, "user_id": 3624347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fp4a5.jpg?s=128&g=1", "display_name": "Joel G", "link": "https://stackoverflow.com/users/3624347/joel-g"}, "is_accepted": false, "score": 2, "last_activity_date": 1449711643, "last_edit_date": 1495541846, "creation_date": 1449711643, "answer_id": 34192281, "question_id": 34171874, "link": "https://stackoverflow.com/questions/34171874/an-error-occurred-while-installing-sqlite3-1-3-11-and-bundler-cannot-continue/34192281#34192281", "title": "An error occurred while installing sqlite3 (1.3.11), and Bundler cannot continue", "body": "<p>As benjamin said, you need to install the sqlite3 database before you can install the sqlite3 gem. It looks like you are on Windows, so try following the instructions listed here: </p>\n\n<p><a href=\"https://stackoverflow.com/questions/15480381/how-do-i-install-sqlite3-for-ruby-on-windows\">How do I install sqlite3 for Ruby on Windows?</a></p>\n\n<p>For reference, here is the accepted answer on that thread, by user Williams:</p>\n\n<ol>\n<li><p>Install the Ruby Devkit for your setup (DevKit-mingw64-64-4.7.2-20130224-1432-sfx.exe for me since I use a x64 machine)</p></li>\n<li><p>Download and extract the autoconf package from Sqlite.org</p></li>\n<li><p>Run msys.bat (it is inside the ruby devkit root folder)</p></li>\n<li><p>cd into the path where you downloaded the sqlite source (for example: \"cd /c/dev/sqlite3\" for path \"c:\\dev\\sqlite3\" if you are new to MSYS/MINGW32)</p></li>\n<li><p>Run \"./configure\"</p></li>\n<li><p>Run \"make\"</p></li>\n<li><p>Run \"make install\"</p></li>\n<li><p>Get the sqlite3 gem again, this time specifying the platform and the path to the newly compiled binaries:</p>\n\n<p><code>gem install sqlite3 --platform=ruby -- --with-sqlite3-include=[path\\to\\sqlite3.h] --with-sqlite3-lib=[path\\to\\sqlite3.o]</code></p>\n\n<p>For example:</p>\n\n<p><code>gem install sqlite3 --platform=ruby -- --with-sqlite3-include=/c:/dev/sqlite3/ --with-sqlite3-lib=/c:/dev/sqlite3/.libs/</code></p>\n\n<p>(from the paths given in step 4)</p></li>\n<li><p>Check the Gemfile.lock of your rails app and make sure that it points to the correct sqlite3 version. Mine was \"sqlite3 (1.3.7-x86-mingw32)\" and manually changed it to \"sqlite3 (1.3.7-x64-mingw32)\". Removing the platform also works: \"sqlite3 (1.3.7)\".</p></li>\n</ol>\n\n<p>Good luck!</p>\n"}, {"comments": [{"owner": {"reputation": 197, "user_id": 9105008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46baf8e9e823a95c78cd0c4324fe82da?s=128&d=identicon&r=PG&f=1", "display_name": "iColdPlayer", "link": "https://stackoverflow.com/users/9105008/icoldplayer"}, "edited": false, "score": 1, "creation_date": 1584812331, "post_id": 36440832, "comment_id": 107554883, "body": "thank&#39;s a lot. It still works on Ubuntu 18.04 and rails 6.0."}], "tags": [], "owner": {"reputation": 2211, "user_id": 4305743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4156eb064951c0289be6370f49353d5b?s=128&d=identicon&r=PG&f=1", "display_name": "sudoz", "link": "https://stackoverflow.com/users/4305743/sudoz"}, "is_accepted": false, "score": 12, "last_activity_date": 1459912358, "creation_date": 1459912358, "answer_id": 36440832, "question_id": 34171874, "link": "https://stackoverflow.com/questions/34171874/an-error-occurred-while-installing-sqlite3-1-3-11-and-bundler-cannot-continue/36440832#36440832", "title": "An error occurred while installing sqlite3 (1.3.11), and Bundler cannot continue", "body": "<p>I think you need to install sqlite3 and sqlite3-dev first.</p>\n\n<pre><code>sudo apt-get install -y sqlite3 libsqlite3-dev\n</code></pre>\n\n<p>Have a try, might solve your problem</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 5676305, "user_type": "registered", "profile_image": "https://graph.facebook.com/198060083867486/picture?type=large", "display_name": "Hai Tran", "link": "https://stackoverflow.com/users/5676305/hai-tran"}, "is_accepted": false, "score": 3, "last_activity_date": 1587128756, "last_edit_date": 1587128756, "creation_date": 1462829017, "answer_id": 37125721, "question_id": 34171874, "link": "https://stackoverflow.com/questions/34171874/an-error-occurred-while-installing-sqlite3-1-3-11-and-bundler-cannot-continue/37125721#37125721", "title": "An error occurred while installing sqlite3 (1.3.11), and Bundler cannot continue", "body": "<p>This might help. I have the same problem. I searched a lot and I solved it. This is maybe just about sqlite3's version.</p>\n\n<p>You should do this first</p>\n\n<pre><code>sudo apt-get install -y sqlite3 libsqlite3-dev\n</code></pre>\n\n<p>then open your Gemfile and change the line of sqlite3 to</p>\n\n<pre><code>gem 'sqlite3', '~&gt; 1.3', '&gt;= 1.3.11'\n</code></pre>\n\n<p>then run  </p>\n\n<pre><code>bundle install\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 5657250, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153158447847793/picture?type=large", "display_name": "Frank Aaron Seager", "link": "https://stackoverflow.com/users/5657250/frank-aaron-seager"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15783, "favorite_count": 2, "answer_count": 4, "score": 8, "last_activity_date": 1587128756, "creation_date": 1449641447, "question_id": 34171874, "link": "https://stackoverflow.com/questions/34171874/an-error-occurred-while-installing-sqlite3-1-3-11-and-bundler-cannot-continue", "title": "An error occurred while installing sqlite3 (1.3.11), and Bundler cannot continue", "body": "<p>So im trying to <code>$ bundle install --without production</code> before I <code>$ git push heroku master</code>but i keep getting this error</p>\n\n<pre><code>$ bundle install --without production\nFetching gem metadata from https://rubygems.org/............\nFetching version metadata from https://rubygems.org/...\nFetching dependency metadata from https://rubygems.org/..\nResolving dependencies......\nUsing rake 10.4.2\nUsing i18n 0.7.0\nUsing json 1.8.3\nUsing minitest 5.8.3\nUsing thread_safe 0.3.5\nUsing tzinfo 1.2.2\nUsing activesupport 4.1.8\nUsing builder 3.2.2\nUsing erubis 2.7.0\nUsing actionview 4.1.8\nUsing rack 1.5.5\nUsing rack-test 0.6.3\nUsing actionpack 4.1.8\nUsing mime-types 2.99\nUsing mail 2.6.3\nUsing actionmailer 4.1.8\nUsing activemodel 4.1.8\nUsing arel 5.0.1.20140414130214\nUsing activerecord 4.1.8\nUsing execjs 2.6.0\nUsing autoprefixer-rails 6.1.2\nUsing sass 3.2.19\nUsing bootstrap-sass 3.3.5\nUsing bundler 1.10.6\nUsing coffee-script-source 1.10.0\nUsing coffee-script 2.4.1\nUsing thor 0.19.1\nUsing railties 4.1.8\nUsing coffee-rails 4.0.1\nUsing hike 1.2.3\nUsing multi_json 1.11.2\nUsing jbuilder 2.3.2\nUsing jquery-rails 3.1.4\nUsing tilt 1.4.1\nUsing sprockets 2.12.4\nUsing sprockets-rails 2.3.3\nUsing rails 4.1.8\nUsing rdoc 4.2.0\nUsing sass-rails 4.0.5\nUsing sdoc 0.4.1\nInstalling sqlite3 1.3.11 with native extensions\nC:/jruby-9.0.0.0/lib/ruby/stdlib/rubygems/ext/ext_conf_builder.rb:39: warning: Tempfile#unlink or delete called on open file; ignoring\n\nGem::Ext::BuildError: ERROR: Failed to build gem native extension.\n\n    C:/jruby-9.0.0.0/bin/jruby.exe -r ./siteconf20151208-25620-qipdd0.rb extconf.rb\nNotImplementedError: C extensions are not supported\n    &lt;top&gt; at C:/jruby-9.0.0.0/lib/ruby/stdlib/mkmf.rb:1\n  require at org/jruby/RubyKernel.java:940\n   (root) at C:/jruby-9.0.0.0/lib/ruby/stdlib/rubygems/core_ext/kernel_require.rb:1\n    &lt;top&gt; at extconf.rb:3\n\nextconf failed, exit code 1\n\nGem files will remain installed in C:/jruby-9.0.0.0/lib/ruby/gems/shared/gems/sqlite3-1.3.11 for inspection.\nResults logged to C:/jruby-9.0.0.0/lib/ruby/gems/shared/extensions/universal-java-1.8/2.2.0/sqlite3-1.3.11/gem_make.out\nAn error occurred while installing sqlite3 (1.3.11), and Bundler cannot\ncontinue.\nMake sure that `gem install sqlite3 -v '1.3.11'` succeeds before bundling.\n</code></pre>\n\n<p>this is my Gemfile</p>\n\n<pre><code>source 'https://rubygems.org'\n\ngem 'rails', '4.1.8'\ngem 'sass-rails', '~&gt; 4.0.3'\ngem 'uglifier', '&gt;= 1.3.0'\ngem 'coffee-rails', '~&gt; 4.0.0'\ngem 'jquery-rails'\ngem 'turbolinks'\ngem 'jbuilder', '~&gt; 2.0'\ngem 'bootstrap-sass'\n\n\n\ngroup :development, :test do\n gem 'sqlite3'\nend\n\ngroup :production do\n gem 'pg'\n gem 'rails_12factor'\nend\n\ngroup :doc do\n    gem 'sdoc', require: false\nend\n</code></pre>\n\n<p>I tried to </p>\n\n<pre><code>gem uninstall sqlite3\ngem install sqlite\n</code></pre>\n\n<p>But i got</p>\n\n<pre><code>$ gem install sqlite3\nBuilding native extensions.  This could take a while...\nC:/jruby-9.0.0.0/lib/ruby/stdlib/rubygems/ext/ext_conf_builder.rb:39: warning: Tempfile#unlink or delete called on open file; ignoring\nERROR:  Error installing sqlite3:\n        ERROR: Failed to build gem native extension.\n\n    C:/jruby-9.0.0.0/bin/jruby.exe -r ./siteconf20151208-19428-iytd2g.rb extconf.rb\nNotImplementedError: C extensions are not supported\n    &lt;top&gt; at C:/jruby-9.0.0.0/lib/ruby/stdlib/mkmf.rb:1\n  require at org/jruby/RubyKernel.java:940\n   (root) at C:/jruby-9.0.0.0/lib/ruby/stdlib/rubygems/core_ext/kernel_require.rb:1\n    &lt;top&gt; at extconf.rb:3\n\nextconf failed, exit code 1\n\nGem files will remain installed in C:/jruby-9.0.0.0/lib/ruby/gems/shared/gems/sqlite3-1.3.11 for inspection.\nResults logged to C:/jruby-9.0.0.0/lib/ruby/gems/shared/extensions/universal-java-1.8/2.2.0/sqlite3-1.3.11/gem_make.out\n</code></pre>\n\n<p>Does any one have any ideas to what could be causing this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "model-associations", "activemodel"], "comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 3150, "user_id": 3012550, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4e2667dc04d27136e29ccb9c9e19cfd3?s=128&d=identicon&r=PG", "display_name": "alexanderbird", "link": "https://stackoverflow.com/users/3012550/alexanderbird"}, "edited": false, "score": 0, "creation_date": 1449647330, "post_id": 34171730, "comment_id": 56093429, "body": "@alexanderbird in question OP never mentioned STI, so I dont think the link is usefull"}, {"owner": {"reputation": 3150, "user_id": 3012550, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4e2667dc04d27136e29ccb9c9e19cfd3?s=128&d=identicon&r=PG", "display_name": "alexanderbird", "link": "https://stackoverflow.com/users/3012550/alexanderbird"}, "edited": false, "score": 0, "creation_date": 1449647788, "post_id": 34171730, "comment_id": 56093666, "body": "Isn&#39;t the OP&#39;s sample code showing STI? I guess if there is no type column in the contacts table then it isn&#39;t STI..."}, {"owner": {"reputation": 2194, "user_id": 2086124, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c67773f6baa7837df50a17a42fd79b9f?s=128&d=identicon&r=PG", "display_name": "Adnan Ali", "link": "https://stackoverflow.com/users/2086124/adnan-ali"}, "edited": false, "score": 0, "creation_date": 1449647848, "post_id": 34171730, "comment_id": 56093695, "body": "yes we don&#39;t have any type column."}, {"owner": {"reputation": 3150, "user_id": 3012550, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/4e2667dc04d27136e29ccb9c9e19cfd3?s=128&d=identicon&r=PG", "display_name": "alexanderbird", "link": "https://stackoverflow.com/users/3012550/alexanderbird"}, "edited": false, "score": 0, "creation_date": 1449651112, "post_id": 34171730, "comment_id": 56095583, "body": "I&#39;ve deleted the link to avoid confusing people - you&#39;re right, it&#39;s not related."}], "answers": [{"comments": [{"owner": {"reputation": 2194, "user_id": 2086124, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c67773f6baa7837df50a17a42fd79b9f?s=128&d=identicon&r=PG", "display_name": "Adnan Ali", "link": "https://stackoverflow.com/users/2086124/adnan-ali"}, "edited": false, "score": 0, "creation_date": 1449642048, "post_id": 34171875, "comment_id": 56091101, "body": "No need to return true or false as we are adding error but even if we do it still doesn&#39;t work."}, {"owner": {"reputation": 2194, "user_id": 2086124, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c67773f6baa7837df50a17a42fd79b9f?s=128&d=identicon&r=PG", "display_name": "Adnan Ali", "link": "https://stackoverflow.com/users/2086124/adnan-ali"}, "edited": false, "score": 0, "creation_date": 1451627960, "post_id": 34171875, "comment_id": 56850626, "body": "No @mhaseeb this thing isn&#39;t working for inherited resources."}], "tags": [], "owner": {"reputation": 1479, "user_id": 5652910, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3441a0e365e8815594bda505f84a7c37?s=128&d=identicon&r=PG&f=1", "display_name": "mhaseeb", "link": "https://stackoverflow.com/users/5652910/mhaseeb"}, "is_accepted": false, "score": 3, "last_activity_date": 1449729169, "last_edit_date": 1449729169, "creation_date": 1449641455, "answer_id": 34171875, "question_id": 34171730, "link": "https://stackoverflow.com/questions/34171730/validates-association-in-child-class-of-a-model/34171875#34171875", "title": "Validates association in child class of a model", "body": "<p><code>add</code> needs an attribute. Try using:</p>\n\n<pre><code>errors.add(:base, \"Must not be blank\")\n</code></pre>\n\n<p>In this case, it is the base class but it can be any other attribute too. Mention an attribute name of the SubContract class or <code>:base</code>.</p>\n"}], "owner": {"reputation": 2194, "user_id": 2086124, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/c67773f6baa7837df50a17a42fd79b9f?s=128&d=identicon&r=PG", "display_name": "Adnan Ali", "link": "https://stackoverflow.com/users/2086124/adnan-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1449729215, "creation_date": 1449640720, "last_edit_date": 1449729215, "question_id": 34171730, "link": "https://stackoverflow.com/questions/34171730/validates-association-in-child-class-of-a-model", "title": "Validates association in child class of a model", "body": "<p>I am facing strange issue in validating presence of association in a derived class.</p>\n\n<pre><code>Class Contact &lt; ActiveRecord::Base\n\n  has_and_belongs_to_many :things\n\nend\n\nClass SubContact &lt; Contact\n\n# validates_presence_of :things\n  validate :must_have_things\n\n  def must_have_things\n    if things.blank?\n      errors.add(\"Must select things\")\n    end\n  end\n\nend\n</code></pre>\n\n<p>In <code>SubContact</code> class, I am trying to validate presence of things but nothing is working. I have tried both custom and built in validators\nHow can I achieve this? </p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1449643749, "post_id": 34171600, "comment_id": 56091793, "body": "<code>inject</code> isn&#39;t the right tool for this job: <code>[1,2,3,4].select { |v| v % 3 == 0 }.length</code> for example."}, {"owner": {"reputation": 1479, "user_id": 5652910, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3441a0e365e8815594bda505f84a7c37?s=128&d=identicon&r=PG&f=1", "display_name": "mhaseeb", "link": "https://stackoverflow.com/users/5652910/mhaseeb"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1449644118, "post_id": 34171600, "comment_id": 56091943, "body": "Yeah you are right. It will be a sugar if we were like adding all the items in an array or some other operation. I was just checking how it works."}], "answers": [{"comments": [{"owner": {"reputation": 1479, "user_id": 5652910, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3441a0e365e8815594bda505f84a7c37?s=128&d=identicon&r=PG&f=1", "display_name": "mhaseeb", "link": "https://stackoverflow.com/users/5652910/mhaseeb"}, "edited": false, "score": 1, "creation_date": 1449640568, "post_id": 34171640, "comment_id": 56090551, "body": "Yeah!. Just figured it out after I posted. Posted below too. Thanks!"}], "tags": [], "owner": {"reputation": 7844, "user_id": 1520557, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/9KKRA.png?s=128&g=1", "display_name": "Drenmi", "link": "https://stackoverflow.com/users/1520557/drenmi"}, "is_accepted": true, "score": 3, "last_activity_date": 1449651371, "last_edit_date": 1449651371, "creation_date": 1449640323, "answer_id": 34171640, "question_id": 34171600, "link": "https://stackoverflow.com/questions/34171600/rubys-dynamic-inject-method-not-working/34171640#34171640", "title": "Ruby&#39;s dynamic Inject method not working", "body": "<p>With <a href=\"http://ruby-doc.org/core-2.2.3/Enumerable.html#method-i-inject\" rel=\"nofollow\"><code>inject</code></a>, you need to return the memo-element on each iteration:</p>\n\n<pre><code>[1, 2, 3, 4].inject(0) do |count, value|\n  if value % 3 == 0\n    count = count + 1\n  end\n\n  count\nend\n#=&gt; 1\n</code></pre>\n\n<p>Or, if you prefer the one-line version:</p>\n\n<pre><code>[1, 2, 3, 4].inject(0) { |c, v| c += 1 if v % 3 == 0; c }\n#=&gt; 1\n</code></pre>\n\n<hr>\n\n<p>Worth noting. In some cases, you can substitute <a href=\"http://ruby-doc.org/core-2.2.3/Enumerable.html#method-i-inject\" rel=\"nofollow\"><code>inject</code></a> for <a href=\"http://ruby-doc.org/core-2.2.3/Enumerable.html#method-i-each_with_object\" rel=\"nofollow\"><code>each_with_object</code></a>, and avoid having to return the memo object, but since the return value of the latter is the original object passed in, it only works with objects passed by reference (i.e. not <code>Fixnum</code>s.)</p>\n\n<pre><code>[1, 2, 3, 4].each_with_object(0) { |v, c| c += 1 if v % 3 == 0 }\n#=&gt; 0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1479, "user_id": 5652910, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3441a0e365e8815594bda505f84a7c37?s=128&d=identicon&r=PG&f=1", "display_name": "mhaseeb", "link": "https://stackoverflow.com/users/5652910/mhaseeb"}, "is_accepted": false, "score": 1, "last_activity_date": 1449642067, "last_edit_date": 1449642067, "creation_date": 1449640476, "answer_id": 34171673, "question_id": 34171600, "link": "https://stackoverflow.com/questions/34171600/rubys-dynamic-inject-method-not-working/34171673#34171673", "title": "Ruby&#39;s dynamic Inject method not working", "body": "<p>So it turns out it was infact something minor. I didn't return the count at end of each loop so count was nil after first iteration since I didn't return it. Blunder!</p>\n\n<pre><code>[1,2,3,4].inject(0) do |count,value|\n   if value % 3 == 0\n     count = count + 1\n   end\ncount\nend\n</code></pre>\n"}], "owner": {"reputation": 1479, "user_id": 5652910, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3441a0e365e8815594bda505f84a7c37?s=128&d=identicon&r=PG&f=1", "display_name": "mhaseeb", "link": "https://stackoverflow.com/users/5652910/mhaseeb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 34171640, "answer_count": 2, "score": 1, "last_activity_date": 1449651371, "creation_date": 1449640162, "question_id": 34171600, "link": "https://stackoverflow.com/questions/34171600/rubys-dynamic-inject-method-not-working", "title": "Ruby&#39;s dynamic Inject method not working", "body": "<p>In irb to checkout the working of inject method I wrote down simple code to print the count of numbers divisible by 3 but somehow that's malfunctioning:</p>\n\n<pre><code>[1,2,3,4].inject(0) do |count,value|\n    if value % 3 == 0\n       count = count + 1\n    end\nend\n</code></pre>\n\n<p>It is something minor but I am not getting a hold on it.  </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "jquery-ui", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 898, "user_id": 4725295, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10153236941637953/picture?type=large", "display_name": "Juan Pablo Ugas", "link": "https://stackoverflow.com/users/4725295/juan-pablo-ugas"}, "edited": false, "score": 0, "creation_date": 1449639122, "post_id": 34171232, "comment_id": 56090044, "body": "I replaced the items and did what you said and that fixed my problem. Thanks mate!"}, {"owner": {"reputation": 898, "user_id": 4725295, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10153236941637953/picture?type=large", "display_name": "Juan Pablo Ugas", "link": "https://stackoverflow.com/users/4725295/juan-pablo-ugas"}, "edited": false, "score": 0, "creation_date": 1450131988, "post_id": 34171232, "comment_id": 56297554, "body": "Out of curiousity, is there any reason that I would actually need jquery_ujs? I have removed it and things seem to be working just fine."}, {"owner": {"reputation": 656, "user_id": 1571115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a14d53b497799c8835ba825923564b6?s=128&d=identicon&r=PG", "display_name": "titan", "link": "https://stackoverflow.com/users/1571115/titan"}, "reply_to_user": {"reputation": 898, "user_id": 4725295, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10153236941637953/picture?type=large", "display_name": "Juan Pablo Ugas", "link": "https://stackoverflow.com/users/4725295/juan-pablo-ugas"}, "edited": false, "score": 0, "creation_date": 1450157895, "post_id": 34171232, "comment_id": 56305339, "body": "jquery-ujs is the unobtrusive implementation to allow you to use jQuery in a Rails app. You can read about it in detail at <a href=\"https://robots.thoughtbot.com/a-tour-of-rails-jquery-ujs\" rel=\"nofollow noreferrer\">robots.thoughtbot.com/a-tour-of-rails-jquery-ujs</a>"}, {"owner": {"reputation": 898, "user_id": 4725295, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10153236941637953/picture?type=large", "display_name": "Juan Pablo Ugas", "link": "https://stackoverflow.com/users/4725295/juan-pablo-ugas"}, "edited": false, "score": 0, "creation_date": 1450343516, "post_id": 34171232, "comment_id": 56402678, "body": "Thanks! Just found out that if it&#39;s not including scaffolding will have some glitches when trying to delete entries but you have to also include  &quot;//= require jquery_ujs&quot; in your application.js Appreciate all of your help!"}], "tags": [], "owner": {"reputation": 656, "user_id": 1571115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a14d53b497799c8835ba825923564b6?s=128&d=identicon&r=PG", "display_name": "titan", "link": "https://stackoverflow.com/users/1571115/titan"}, "is_accepted": true, "score": 4, "last_activity_date": 1449638121, "creation_date": 1449638121, "answer_id": 34171232, "question_id": 34171147, "link": "https://stackoverflow.com/questions/34171147/rails-couldnt-find-file-jquery-ujs-with-type-application-javascript/34171232#34171232", "title": "Rails - couldn&#39;t find file &#39;jquery_ujs&#39; with type &#39;application/javascript&#39;", "body": "<p>Include <code>gem 'jquery-rails'</code> in your Gemfile.</p>\n"}], "owner": {"reputation": 898, "user_id": 4725295, "user_type": "registered", "accept_rate": 88, "profile_image": "https://graph.facebook.com/10153236941637953/picture?type=large", "display_name": "Juan Pablo Ugas", "link": "https://stackoverflow.com/users/4725295/juan-pablo-ugas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9056, "favorite_count": 0, "accepted_answer_id": 34171232, "answer_count": 1, "score": 5, "last_activity_date": 1449638300, "creation_date": 1449637648, "question_id": 34171147, "link": "https://stackoverflow.com/questions/34171147/rails-couldnt-find-file-jquery-ujs-with-type-application-javascript", "title": "Rails - couldn&#39;t find file &#39;jquery_ujs&#39; with type &#39;application/javascript&#39;", "body": "<p>I have been working on integrating a wrap bootstrap template onto an app and had the index page working without bootstrap glyphicons and then changed something and I have reversed previous changes but no longer have jquery_ujs working without this error. </p>\n\n<p>Here is my gemfile thus far:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>source 'https://rubygems.org'\r\n\r\n\r\n# Bundle edge Rails instead: gem 'rails', github: 'rails/rails'\r\ngem 'rails', '4.2.1'\r\n# Use sqlite3 as the database for Active Record\r\ngem 'sqlite3'\r\n# Use SCSS for stylesheets\r\ngem 'bootstrap-sass'\r\ngem 'sass-rails', '~&gt; 5.0'\r\n\r\n# Use Uglifier as compressor for JavaScript assets\r\ngem 'uglifier', '&gt;= 1.3.0'\r\n# Use CoffeeScript for .coffee assets and views\r\ngem 'coffee-rails', '~&gt; 4.1.0'\r\n# See https://github.com/rails/execjs#readme for more supported runtimes\r\n# gem 'therubyracer', platforms: :ruby\r\n\r\n# Use jquery as the JavaScript library\r\ngem 'jquery-ui-rails'\r\ngem 'jrails'\r\n# Turbolinks makes following links in your web application faster. Read more: https://github.com/rails/turbolinks\r\ngem 'turbolinks'\r\n# Build JSON APIs with ease. Read more: https://github.com/rails/jbuilder\r\ngem 'jbuilder', '~&gt; 2.0'\r\n# bundle exec rake doc:rails generates the API under doc/api.\r\ngem 'sdoc', '~&gt; 0.4.0', group: :doc\r\n\r\n# Use ActiveModel has_secure_password\r\ngem 'bcrypt', '~&gt; 3.1.7'\r\n\r\n#view database in console\r\ngem 'hirb'\r\n\r\n# mysql database \r\n# gem 'mysql', '~&gt; 2.9', '&gt;= 2.9.1'\r\n\r\n# Use Unicorn as the app server\r\n# gem 'unicorn'\r\n\r\n# Use Capistrano for deployment\r\n# gem 'capistrano-rails', group: :development\r\n\r\ngroup :development, :test do\r\n  # Call 'byebug' anywhere in the code to stop execution and get a debugger console\r\n  gem 'byebug'\r\n\r\n  # Access an IRB console on exception pages or by using &lt;%= console %&gt; in views\r\n  gem 'web-console', '~&gt; 2.0'\r\n\r\n  # Spring speeds up development by keeping your application running in the background. Read more: https://github.com/rails/spring\r\n  gem 'spring'\r\nend</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Here is my application.js:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>// This is a manifest file that'll be compiled into application.js, which will include all the files\r\n// listed below.\r\n//\r\n// Any JavaScript/Coffee file within this directory, lib/assets/javascripts, vendor/assets/javascripts,\r\n// or any plugin's vendor/assets/javascripts directory can be referenced here using a relative path.\r\n//\r\n// It's not advisable to add code directly here, but if you do, it'll appear at the bottom of the\r\n// compiled file.\r\n//\r\n// Read Sprockets README (https://github.com/rails/sprockets#sprockets-directives) for details\r\n// about supported directives.\r\n//\r\n//= require jquery\r\n//= require jquery-ui\r\n//= require jquery_ujs\r\n//= require twitter/bootstrap\r\n//= require turbolinks\r\n//= require_tree </code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Here is my application.scss:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-css lang-css prettyprint-override\"><code>/*\r\n * This is a manifest file that'll be compiled into application.css, which will include all the files\r\n * listed below.\r\n *\r\n * Any CSS and SCSS file within this directory, lib/assets/stylesheets, vendor/assets/stylesheets,\r\n * or any plugin's vendor/assets/stylesheets directory can be referenced here using a relative path.\r\n *\r\n * You're free to add application-wide styles to this file and they'll appear at the bottom of the\r\n * compiled file so the styles you add here take precedence over styles defined in any styles\r\n * defined in the other CSS/SCSS files in this directory. It is generally better to create a new\r\n * file per style scope.\r\n\r\n\r\n\r\n *= require jquery-ui\r\n *= require_tree \r\n *= require_self\r\n*/</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I appreciate any help!</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 1, "creation_date": 1449638686, "post_id": 34171031, "comment_id": 56089885, "body": "Please edit your question to include an example of the input you have and the output you want, and the code you&#39;ve written so far."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5657487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87c0a79a30c764aca39f0fa486a3732b?s=128&d=identicon&r=PG&f=1", "display_name": "Jane ", "link": "https://stackoverflow.com/users/5657487/jane"}, "edited": false, "score": 0, "creation_date": 1449642167, "post_id": 34171594, "comment_id": 56091151, "body": "This is perfect! Thanks for helping out a beginner programmer."}], "tags": [], "owner": {"reputation": 7844, "user_id": 1520557, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/9KKRA.png?s=128&g=1", "display_name": "Drenmi", "link": "https://stackoverflow.com/users/1520557/drenmi"}, "is_accepted": true, "score": 2, "last_activity_date": 1449640151, "creation_date": 1449640151, "answer_id": 34171594, "question_id": 34171031, "link": "https://stackoverflow.com/questions/34171031/how-do-i-remove-the-last-line-of-a-string-that-has-visible-characters-in-ruby/34171594#34171594", "title": "How do I remove the last line of a string that has visible characters in ruby?", "body": "<p>Consider a string like the following (line breaks written as <code>\\n</code>):</p>\n\n<pre><code>str = \"Hello\\nThere\\nWorld!\\n\\n\"\n</code></pre>\n\n<p>First, use <a href=\"http://ruby-doc.org/core-2.2.0/String.html#method-i-strip\" rel=\"nofollow\">String#strip</a> to remove trailing whitespace, and use <a href=\"http://ruby-doc.org/core-2.2.0/String.html#method-i-split\" rel=\"nofollow\">String#split</a> to break the string into an array where each element represents one line of the string.</p>\n\n<pre><code>str = str.strip.split(\"\\n\")\n#=&gt; [\"Hello\", \"There\", \"World!\"]\n</code></pre>\n\n<p>You can then extract the last line from the last element in the array using <a href=\"http://ruby-doc.org/core-2.2.0/Array.html#method-i-pop\" rel=\"nofollow\">Array#pop</a>.</p>\n\n<pre><code>last_line = str.pop\n#=&gt; \"World!\"\n</code></pre>\n\n<p>Finally, use <a href=\"http://ruby-doc.org/core-2.2.0/Array.html#method-i-join\" rel=\"nofollow\">Array#join</a> to re-assemble the array.</p>\n\n<pre><code>str = str.join(\"\\n\")\n#=&gt; \"Hello\\nThere\"\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5657487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87c0a79a30c764aca39f0fa486a3732b?s=128&d=identicon&r=PG&f=1", "display_name": "Jane ", "link": "https://stackoverflow.com/users/5657487/jane"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 967, "favorite_count": 0, "accepted_answer_id": 34171594, "answer_count": 1, "score": 1, "last_activity_date": 1449640151, "creation_date": 1449636997, "question_id": 34171031, "link": "https://stackoverflow.com/questions/34171031/how-do-i-remove-the-last-line-of-a-string-that-has-visible-characters-in-ruby", "title": "How do I remove the last line of a string that has visible characters in ruby?", "body": "<p>need to be able to take the last line of a string and put it in it's own string. and then more importantly I need to be able to remove the last line of the original string that has non-whitespace characters.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "json", "ember.js"], "owner": {"reputation": 63, "user_id": 3286320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5jqhB.jpg?s=128&g=1", "display_name": "Talha", "link": "https://stackoverflow.com/users/3286320/talha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 145, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1449720995, "creation_date": 1449636435, "last_edit_date": 1449720995, "question_id": 34170935, "link": "https://stackoverflow.com/questions/34170935/ember-cli-rails-api-json-api-format-ams-0-10-0-rc-not-working", "title": "Ember - Cli , Rails API JSON API FORMAT , AMS 0.10.0 rc Not Working", "body": "<p>I am stuck with the JSON API , AMS, RAILS combination....</p>\n\n<p>I covered ember with some books like \"Rock and Roll with ember js\" , \"Ember-cli -101\"\nBut here is a scenario where i need to put some has_many / belongs_to relationship with some data...</p>\n\n<p>In My Ember Application </p>\n\n<p>models/customer.js</p>\n\n<pre><code>export default DS.Model.extend({\n  name: DS.attr('string'),\n  contactname: DS.attr('string'),\n  contactno: DS.attr('string'),\n  othcontactno: DS.attr('string'),\n  othrefdetails: DS.attr('string'),\n  projects: DS.hasMany('project'),\n});\n</code></pre>\n\n<p>models/project.js</p>\n\n<pre><code>export default DS.Model.extend({\n  name: DS.attr('string'),\n  customer: DS.belongsTo('customer' , {async:true}),\n  agent: DS.belongsTo('agent' , {async:true})\n});\n</code></pre>\n\n<p>adapters/application.js</p>\n\n<pre><code>export default DS.JSONAPIAdapter.extend({\n  host: 'http://localhost:3000',\n  shouldReloadRecord(store, snapshot) {\n    return false;\n  },\n});\n</code></pre>\n\n<p>serializers/applicaiton.js</p>\n\n<pre><code> export default DS.JSONAPISerializer.extend({\n });\n</code></pre>\n\n<p>And in my Rails api</p>\n\n<pre><code>Rails.application.routes.draw do\n  resources :enquiries\n  resources :agents\n  resources :customers\n  resources :projects\nend\n\nclass Project &lt; ActiveRecord::Base\n   belongs_to :customer \n   #belongs_to :agent\n   #has_many :enquiries\n   accepts_nested_attributes_for :customer\nend\n\n\nclass Customer &lt; ActiveRecord::Base\n   has_many :projects\n   accepts_nested_attributes_for :projects\nend\n\n\n\nclass ProjectSerializer &lt; ActiveModel::Serializer\n  attributes :id, :name\n   belongs_to :customer\n   #has_one :agent\n   #has_many :enquiries\nend\n\n\nclass CustomerSerializer &lt; ActiveModel::Serializer\n  attributes :id, :name, :contactname, :contactno, :othcontactno, :othrefdetails\n    has_many :projects\nend\n</code></pre>\n\n<p>initializers/json_api.rb</p>\n\n<pre><code>ActiveModel::Serializer.config.adapter = ActiveModel::Serializer::Adapter::JsonApi\n</code></pre>\n\n<p>Gem File (I am using 0.10.0 rc3 due to some bugs in 0.9 version)</p>\n\n<pre><code>gem 'active_model_serializers' , '~&gt; 0.10.0.rc3'\n # gem 'active_model_serializers' , '~&gt; 0.9.3'\n</code></pre>\n\n<p>I am getting a json response for localhost:3000/customers From The rails api like this</p>\n\n<pre><code>{\"data\":[{\"id\":\"6\",\"type\":\"customers\",\"attributes\":{\"name\":\"Talhaqqq\",\"contactname\":\"Mohammed Talha\",\"contactno\":\"9744878171\",\"othcontactno\":\"+9104735253585\",\"othrefdetails\":\"nil\"},\"relationships\":{\"projects\":{\"data\":[{\"id\":\"1\",\"type\":\"projects\"}]}}},{\"id\":\"10\",\"type\":\"customers\",\"attributes\":{\"name\":\"Ameer Ali qq\",\"contactname\":\"Ameer Mohammed Ali\",\"contactno\":\"234234\",\"othcontactno\":\"439870987\",\"othrefdetails\":\"othr ref detaila\"},\"relationships\":{\"projects\":{\"data\":[]}}},{\"id\":\"67\",\"type\":\"customers\",\"attributes\":{\"name\":\"Signlab qqq\",\"contactname\":\"Sigblab contact\",\"contactno\":\"2340987\",\"othcontactno\":\"sjfdla98\",\"othrefdetails\":\"s098-\"},\"relationships\":{\"projects\":{\"data\":[{\"id\":\"2\",\"type\":\"projects\"}]}}},{\"id\":\"68\",\"type\":\"customers\",\"attributes\":{\"name\":\"Anwar Nazar\",\"contactname\":\"Anwar\",\"contactno\":\"2+87+968\",\"othcontactno\":\"354+641+9\",\"othrefdetails\":\"31651651\"},\"relationships\":{\"projects\":{\"data\":[]}}},{\"id\":\"69\",\"type\":\"customers\",\"attributes\":{\"name\":\"Cust name qqq\",\"contactname\":\"asdfda\",\"contactno\":\"sdfsdf\",\"othcontactno\":\"sadfafd\",\"othrefdetails\":\"asfdgadfg\"},\"relationships\":{\"projects\":{\"data\":[]}}},{\"id\":\"70\",\"type\":\"customers\",\"attributes\":{\"name\":\"dsasva\",\"contactname\":\"a\",\"contactno\":\"sdfvsfva\",\"othcontactno\":\"asdv\",\"othrefdetails\":\"vafasdfv\"},\"relationships\":{\"projects\":{\"data\":[]}}},{\"id\":\"71\",\"type\":\"customers\",\"attributes\":{\"name\":\"egrweg\",\"contactname\":\"aevg\",\"contactno\":\"asdgr\",\"othcontactno\":\"aergarg\",\"othrefdetails\":\"saerg\"},\"relationships\":{\"projects\":{\"data\":[]}}}]}\n</code></pre>\n\n<p>I am trying to set a customer for a project.... </p>\n\n<p>I tried it manually in one of the routes actions.... (I dont know the best way to do it in ember ).. Both of the tutorial books is not giving me a best way to set the relationship data</p>\n\n<pre><code>let project = this.store.peekRecord('project', 3);\nlet customer = this.store.peekRecord('customer', 6);\nproject.set('customer', customer ); \nproject.save();\n</code></pre>\n\n<p>And i am getting this on rails </p>\n\n<pre><code>  Parameters: {\"data\"=&gt;{\"id\"=&gt;\"3\", \"attributes\"=&gt;{\"name\"=&gt;\"Xyy project\"}, \"relationships\"=&gt;{\"customer\"=&gt;{\"data\"=&gt;{\"type\"=&gt;\"customers\", \"id\"=&gt;\"6\"}}}, \"type\"=&gt;\"projects\"}, \"id\"=&gt;\"3\"}\n</code></pre>\n\n<p>I tried to permit the relationships, attributes in Projects_controller</p>\n\n<pre><code>params.require(:data).permit!\n#  params.require(:data)\n# .permit(:id ,   :attributes =&gt; [:name] , :relationships =&gt; [:customer =&gt; [:data] =&gt;[:type] ] , :customer =&gt; [:data] )\n</code></pre>\n\n<p>But nothing worked well .. always given unpermitted parameter... and i ended up permitting all params using </p>\n\n<pre><code>params.require(:data).permit!\n</code></pre>\n\n<p>And finally , When i did the update using this function </p>\n\n<pre><code>  def update\n    @project = Project.find(params[:id])\n    @customer = Customer.find(6)\n    @project.update_attributes(:customer =&gt; params[:customer])\n    if @project.update(project_params)\n\n      head :no_content\n    else\n      render json: @project.errors, status: :unprocessable_entity\n    end\n  end \n</code></pre>\n\n<p>I got this response in rails customer_id = NULL..</p>\n\n<pre><code>Started PATCH \"/projects/1\" for 127.0.0.1 at 2015-12-09 09:32:42 +0530\nProcessing by ProjectsController#update as JSON\n  Parameters: {\"data\"=&gt;{\"id\"=&gt;\"1\", \"attributes\"=&gt;{\"name\"=&gt;\"Lulu Mall Project qw \"}, \"relationships\"=&gt;{\"customer\"=&gt;{\"data\"=&gt;{\"type\"=&gt;\"customers\", \"id\"=&gt;\"67\"}}}, \"type\"=&gt;\"projects\"}, \"id\"=&gt;\"1\"}\n  Project Load (1.0ms)  SELECT  `projects`.* FROM `projects` WHERE `projects`.`id` = 1 LIMIT 1\n  CACHE (0.0ms)  SELECT  `projects`.* FROM `projects` WHERE `projects`.`id` = 1 LIMIT 1  [[\"id\", \"1\"]]\n  Customer Load (0.9ms)  SELECT  `customers`.* FROM `customers` WHERE `customers`.`id` = 6 LIMIT 1\n   (0.3ms)  BEGIN\n  SQL (1.1ms)  UPDATE `projects` SET `customer_id` = NULL, `updated_at` = '2015-12-09 04:02:42' WHERE `projects`.`id` = 1\n   (50.4ms)  COMMIT\n\n{\"data\"=&gt;{\"id\"=&gt;\"1\", \"attributes\"=&gt;{\"name\"=&gt;\"Lulu Mall Project qw \"}, \"relationships\"=&gt;{\"customer\"=&gt;{\"data\"=&gt;{\"type\"=&gt;\"customers\", \"id\"=&gt;\"67\"}}}, \"type\"=&gt;\"projects\"}, \"controller\"=&gt;\"projects\", \"action\"=&gt;\"update\", \"id\"=&gt;\"1\"}\n   (0.8ms)  BEGIN\n</code></pre>\n\n<p>I know i am totally confused,, I tried to use AMS 0.9 version without the JSON API Standard , but ended up in stack level too deep error and come other problems.</p>\n\n<p>But using the AMS 0.10.0 rc version and standard JSON API Format, i couldn't find any tutorials or answers for these questions..</p>\n\n<ol>\n<li>How to set relationship data in ember ?</li>\n<li>The best json format from API (standart json / json with embed ids )?</li>\n<li>How to allow strong parametes in Rails (Especially nested with relationships{id, type} etc...  With STANDARD JSON API FORMAT)?</li>\n<li>Update relationship (update attributes ) in Rails with the json api request from ember?</li>\n<li>Is it best to go with the JSON API FORMAT , and AMS ...AND JSON API ADAPTER /SERIALIZER...</li>\n</ol>\n\n<p>It feels some thing like an eclipse should happen with these things to work all together...</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1449628721, "post_id": 34169816, "comment_id": 56086984, "body": "Are these Rails ActiveModel objects or Plain Old Ruby Objects?"}, {"owner": {"reputation": 171, "user_id": 447528, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/5843496c4a808f4d7a25397b29709d3d?s=128&d=identicon&r=PG", "display_name": "chadwtaylor", "link": "https://stackoverflow.com/users/447528/chadwtaylor"}, "reply_to_user": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1449628795, "post_id": 34169816, "comment_id": 56086999, "body": "ActiveRecord objects but I&#39;d love to see if it can be done for plain Ruby objects too."}], "answers": [{"tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 1, "last_activity_date": 1449629463, "creation_date": 1449629463, "answer_id": 34169944, "question_id": 34169816, "link": "https://stackoverflow.com/questions/34169816/effectively-comparing-two-ruby-objects-ignoring-selected-attributes/34169944#34169944", "title": "Effectively comparing two Ruby objects ignoring selected attributes", "body": "<p>This might work:</p>\n\n<pre><code>def same(p1, p2)\n  return false unless p1.class == p2.class\n  p1_vars = p1.instance_variables.inject({}) { |h, var| h[var] = p1.instance_variable_get(var); h }\n  p2_vars = p2.instance_variables.inject({}) { |h, var| h[var] = p2.instance_variable_get(var); h }\n  p1_vars == p2_vars\nend\n\n\nclass Person\n  def initialize(fname, lname)\n    @fname = fname\n    @lname = lname\n  end\nend\n\np1 = Person.new('Jane', 'Doe')\np2 = Person.new('Jane', 'Doe')\np3 = Person.new('John', 'Doe')\np4 = 7\n\nputs same(p1, p2) # true\nputs same(p1, p3) # false\nputs same(p1, p4) # false\n</code></pre>\n\n<p>You can use <code>Array#reject</code> or <code>Array#-</code> to subtract any undesirable attributes from <code>instance_variables</code>.</p>\n"}], "owner": {"reputation": 171, "user_id": 447528, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/5843496c4a808f4d7a25397b29709d3d?s=128&d=identicon&r=PG", "display_name": "chadwtaylor", "link": "https://stackoverflow.com/users/447528/chadwtaylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "closed_date": 1449628877, "answer_count": 1, "score": -1, "last_activity_date": 1449629463, "creation_date": 1449628486, "last_edit_date": 1449629372, "question_id": 34169816, "link": "https://stackoverflow.com/questions/34169816/effectively-comparing-two-ruby-objects-ignoring-selected-attributes", "closed_reason": "Duplicate", "title": "Effectively comparing two Ruby objects ignoring selected attributes", "body": "<p>Say, I have two Ruby objects <code>#&lt;Person id:1, first:\"Jane\", last:\"Doe\"&gt;</code> and <code>#&lt;Person id:2, first:\"Jane\", last:\"Doe\"&gt;</code> and I would like to compare them WITHOUT considering the attribute <code>id</code> (or any other undesired attributes) and see if the two objects are similar.</p>\n\n<p>Would be interested in learning how to use Ruby best practices to effectively ignore attributes and compare the two objects.</p>\n\n<p>We would appreciate code examples for both plain Ruby object and ActiveRecord object if possible.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "regex"], "comments": [{"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 1, "creation_date": 1449627066, "post_id": 34169585, "comment_id": 56086537, "body": "<code>h[link.text.strip] = link[&#39;href&#39;] if link[&#39;href&#39;] =~ &#47;http:\\&#47;\\&#47;skimmth.is\\&#47;&#47;</code>"}, {"owner": {"reputation": 469, "user_id": 3498283, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100003648493219/picture?type=large", "display_name": "alicht", "link": "https://stackoverflow.com/users/3498283/alicht"}, "reply_to_user": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1449627163, "post_id": 34169585, "comment_id": 56086556, "body": "Amazing, works like a charm- thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 47898, "user_id": 966023, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/917fcb4327159076f752c0c3c3fddfbb?s=128&d=identicon&r=PG", "display_name": "pguardiario", "link": "https://stackoverflow.com/users/966023/pguardiario"}, "edited": false, "score": 0, "creation_date": 1449629076, "post_id": 34169654, "comment_id": 56087066, "body": "It&#39;s actually a method, though. Right?"}], "tags": [], "owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "is_accepted": true, "score": 1, "last_activity_date": 1449631406, "last_edit_date": 1449631406, "creation_date": 1449627325, "answer_id": 34169654, "question_id": 34169585, "link": "https://stackoverflow.com/questions/34169585/adding-some-regex-code-to-my-ruby-webscraper/34169654#34169654", "title": "Adding some Regex code to my Ruby webscraper", "body": "<p>You can use <code>if</code> as a statement modifier to check that the value is appropriate before adding it to the hash.  For example, update this line:</p>\n\n<pre><code>h[link.text.strip] = link['href']\n</code></pre>\n\n<p>to</p>\n\n<pre><code>h[link.text.strip] = link['href'] if link['href'] =~ /http:\\/\\/skimmth.is\\//\n</code></pre>\n\n<p>FWIW: <a href=\"http://ruby-doc.org/core-2.2.0/Regexp.html#method-i-3D-7E\" rel=\"nofollow\"><code>=~</code></a> is the match method for the <code>Regexp</code> class.</p>\n"}, {"tags": [], "owner": {"reputation": 11845, "user_id": 1536527, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/Sgr8O.png?s=128&g=1", "display_name": "ironsand", "link": "https://stackoverflow.com/users/1536527/ironsand"}, "is_accepted": false, "score": 2, "last_activity_date": 1449627735, "creation_date": 1449627735, "answer_id": 34169709, "question_id": 34169585, "link": "https://stackoverflow.com/questions/34169585/adding-some-regex-code-to-my-ruby-webscraper/34169709#34169709", "title": "Adding some Regex code to my Ruby webscraper", "body": "<p>You can use <code>contains()</code> function of xpath.</p>\n\n<pre><code>doc.xpath('//a[contains(@href, \"http://skimmth.is/\")]').map{|e| e.attr(:href)}\n\n=&gt; [\"http://skimmth.is/1SKR0bP\",\n \"http://skimmth.is/1QbnCO8\",\n \"http://skimmth.is/1SHBSff\",\n \"http://skimmth.is/1N8dORo\",\n \"http://skimmth.is/1HRwGoO\",\n \"http://skimmth.is/1HRmEUG\",\n \"http://skimmth.is/1NePsmI\",\n \"http://skimmth.is/1IQoJLn\",\n \"http://skimmth.is/1ToQ6T1\",\n \"http://skimmth.is/1IAZ6mW\",\n \"http://skimmth.is/1N7Foy1\",\n \"http://skimmth.is/1m7B6Op\",\n \"http://skimmth.is/1SKBhJW\",\n \"http://skimmth.is/1ToQ6T1\",\n \"http://skimmth.is/1XfpwkX%20\",\n \"http://skimmth.is/1P9rq20\"]\n</code></pre>\n"}], "owner": {"reputation": 469, "user_id": 3498283, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100003648493219/picture?type=large", "display_name": "alicht", "link": "https://stackoverflow.com/users/3498283/alicht"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 34169654, "answer_count": 2, "score": 0, "last_activity_date": 1449631406, "creation_date": 1449626809, "last_edit_date": 1449627156, "question_id": 34169585, "link": "https://stackoverflow.com/questions/34169585/adding-some-regex-code-to-my-ruby-webscraper", "title": "Adding some Regex code to my Ruby webscraper", "body": "<p>I'm building a webscraper and using Nokogiri. Here is the code that I currently have:</p>\n\n<pre><code>require 'nokogiri'\nrequire 'open-uri'\nrequire 'pry'\n\n\n\nclass Scraper\n\n  def get_page\n    doc = Nokogiri::HTML(open(\"http://www.theskimm.com/recent\"))\n    h = {}\n    doc.xpath('//a[@href]').each do |link|   \n      h[link.text.strip] = link['href']\n    end\n    puts h\n  end\n  binding.pry\nend\n\nScraper.new.get_page\n</code></pre>\n\n<p>This returns me a hash of all URLs on the page (I only pasted the first few lines):</p>\n\n<pre><code>{\"Back to Sign Up\"=&gt;\"/\", \"SHARE\u00a0THIS\"=&gt;\"https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.theskimm.com%2F2015%2F12%2F07%2Fskimm-for-december-8th-2&amp;display=popup\", \"theSkimm\\nSkimm for December 8th\"=&gt;\"/\", \"Trump campaign press release\"=&gt;\"http://skimmth.is/1SKR0bP\", \"assault weapons ban\"=&gt;\"http://skimmth.is/1QbnCO8\"}\n</code></pre>\n\n<p>However, I'd like to only grab the URLs that contain \"<a href=\"http://skimmth.is/\" rel=\"nofollow\">http://skimmth.is/</a>\" as part of the value. What code/ Regular Expression would I need to add to my original Scraper class to ONLY selects URLs with that address?</p>\n"}, {"tags": ["arrays", "ruby", "immutability"], "comments": [{"owner": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 2, "creation_date": 1449626438, "post_id": 34169353, "comment_id": 56086382, "body": "You&#39;re running into a &quot;common gotcha&quot;, which is explained in the documentation: <a href=\"http://ruby-doc.org/core-2.2.0/Array.html#method-c-new-label-Common+gotchas\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.2.0/&hellip;</a>"}, {"owner": {"reputation": 936, "user_id": 4714084, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bRwuokuDNwY/AAAAAAAAAAI/AAAAAAAAAII/RlbsFxg5OQU/photo.jpg?sz=128", "display_name": "warkentien2", "link": "https://stackoverflow.com/users/4714084/warkentien2"}, "reply_to_user": {"reputation": 5134, "user_id": 1672197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i8HkV.png?s=128&g=1", "display_name": "orde", "link": "https://stackoverflow.com/users/1672197/orde"}, "edited": false, "score": 0, "creation_date": 1449627774, "post_id": 34169353, "comment_id": 56086718, "body": "&quot;common gotcha&#39;s&quot; I hoped that it was a list of common mistakes, but it&#39;s only the one. Anyhow, thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 936, "user_id": 4714084, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bRwuokuDNwY/AAAAAAAAAAI/AAAAAAAAAII/RlbsFxg5OQU/photo.jpg?sz=128", "display_name": "warkentien2", "link": "https://stackoverflow.com/users/4714084/warkentien2"}, "edited": false, "score": 0, "creation_date": 1449626160, "post_id": 34169405, "comment_id": 56086306, "body": "And how will I attribute a different value to each slot of the array?"}, {"owner": {"reputation": 31319, "user_id": 981183, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/88dd7155ef7c0e5f43ab8d1a9efdecab?s=128&d=identicon&r=PG&f=1", "display_name": "K M Rakibul Islam", "link": "https://stackoverflow.com/users/981183/k-m-rakibul-islam"}, "reply_to_user": {"reputation": 936, "user_id": 4714084, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bRwuokuDNwY/AAAAAAAAAAI/AAAAAAAAAII/RlbsFxg5OQU/photo.jpg?sz=128", "display_name": "warkentien2", "link": "https://stackoverflow.com/users/4714084/warkentien2"}, "edited": false, "score": 0, "creation_date": 1449626241, "post_id": 34169405, "comment_id": 56086326, "body": "Please look at my updated code."}, {"owner": {"reputation": 936, "user_id": 4714084, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bRwuokuDNwY/AAAAAAAAAAI/AAAAAAAAAII/RlbsFxg5OQU/photo.jpg?sz=128", "display_name": "warkentien2", "link": "https://stackoverflow.com/users/4714084/warkentien2"}, "edited": false, "score": 1, "creation_date": 1449627678, "post_id": 34169405, "comment_id": 56086689, "body": "This answer is way better than the &quot;duplicate&quot; one here: <a href=\"http://stackoverflow.com/questions/21051442/2d-array-pushing-to-one-array-shows-up-in-all-arrays\" title=\"2d array pushing to one array shows up in all arrays\">stackoverflow.com/questions/21051442/&hellip;</a>"}, {"owner": {"reputation": 936, "user_id": 4714084, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bRwuokuDNwY/AAAAAAAAAAI/AAAAAAAAAII/RlbsFxg5OQU/photo.jpg?sz=128", "display_name": "warkentien2", "link": "https://stackoverflow.com/users/4714084/warkentien2"}, "edited": false, "score": 0, "creation_date": 1449628050, "post_id": 34169405, "comment_id": 56086789, "body": "Thanks for the link. I thought the &quot;like&quot; from the OP was always the ones marked in green. But now I know the subtle difference."}, {"owner": {"reputation": 31319, "user_id": 981183, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/88dd7155ef7c0e5f43ab8d1a9efdecab?s=128&d=identicon&r=PG&f=1", "display_name": "K M Rakibul Islam", "link": "https://stackoverflow.com/users/981183/k-m-rakibul-islam"}, "reply_to_user": {"reputation": 936, "user_id": 4714084, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bRwuokuDNwY/AAAAAAAAAAI/AAAAAAAAAII/RlbsFxg5OQU/photo.jpg?sz=128", "display_name": "warkentien2", "link": "https://stackoverflow.com/users/4714084/warkentien2"}, "edited": false, "score": 0, "creation_date": 1449628111, "post_id": 34169405, "comment_id": 56086806, "body": "Great to hear that it cleared up your confusion and now you understand the difference between those two :) Happy learning :)"}], "tags": [], "owner": {"reputation": 31319, "user_id": 981183, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/88dd7155ef7c0e5f43ab8d1a9efdecab?s=128&d=identicon&r=PG&f=1", "display_name": "K M Rakibul Islam", "link": "https://stackoverflow.com/users/981183/k-m-rakibul-islam"}, "is_accepted": true, "score": 1, "last_activity_date": 1449627091, "last_edit_date": 1449627091, "creation_date": 1449625769, "answer_id": 34169405, "question_id": 34169353, "link": "https://stackoverflow.com/questions/34169353/adding-value-to-only-one-slot/34169405#34169405", "title": "Adding value to only one slot", "body": "<p>You see this behaviour because the new arrays refer to the same object. You can verify that looking at the <code>object_id</code>s of the sub-arrays:</p>\n\n<pre><code>a = Array.new(3, [])\np a[1] &lt;&lt; \"value\"\np a[0].object_id\n# =&gt; 70175034559160\np a[1].object_id\n# =&gt; 70175034559160\np a[2].object_id\n# =&gt; 70175034559160\n</code></pre>\n\n<p>You can do it this way:</p>\n\n<pre><code>a = []\n(1..3).each { |e| a &lt;&lt; [] }\na[1] &lt;&lt; \"value\"\np a\n# =&gt; [[], [\"value\"], []]\n</code></pre>\n\n<p>Or, even better to use this:</p>\n\n<pre><code>a = Array.new(3) { Array.new }\n</code></pre>\n\n<p>As shown in <a href=\"http://ruby-doc.org/core-2.2.0/Array.html#method-c-new-label-Common+gotchas\" rel=\"nofollow\">the documentation</a> provided by <code>@orde</code> in the comment section.</p>\n"}, {"comments": [{"owner": {"reputation": 936, "user_id": 4714084, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bRwuokuDNwY/AAAAAAAAAAI/AAAAAAAAAII/RlbsFxg5OQU/photo.jpg?sz=128", "display_name": "warkentien2", "link": "https://stackoverflow.com/users/4714084/warkentien2"}, "edited": false, "score": 1, "creation_date": 1449627706, "post_id": 34169465, "comment_id": 56086699, "body": "thanks man! it&#39;s 100% clear now."}], "tags": [], "owner": {"reputation": 2007, "user_id": 716039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b302eed6a8add5db6b3f2e1c7c9942?s=128&d=identicon&r=PG", "display_name": "dinjas", "link": "https://stackoverflow.com/users/716039/dinjas"}, "is_accepted": false, "score": 1, "last_activity_date": 1449626464, "last_edit_date": 1449626464, "creation_date": 1449626085, "answer_id": 34169465, "question_id": 34169353, "link": "https://stackoverflow.com/questions/34169353/adding-value-to-only-one-slot/34169465#34169465", "title": "Adding value to only one slot", "body": "<p>You can initialize your array like this to ensure each element gets its own array:</p>\n\n<pre><code>a = Array.new(3){ Array.new } # or a = Array.new(3){ [] }\n</code></pre>\n\n<p>And, yes, as stated in the other answer, you're seeing this because the same array object is being assigned to each element when you're initializing it. What you're doing is essentially the same as:</p>\n\n<pre><code>a1 = Array.new\na2 = Array.new(3, a1)\n</code></pre>\n\n<p>There's nothing wrong with the way you're adding values.</p>\n"}], "owner": {"reputation": 936, "user_id": 4714084, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bRwuokuDNwY/AAAAAAAAAAI/AAAAAAAAAII/RlbsFxg5OQU/photo.jpg?sz=128", "display_name": "warkentien2", "link": "https://stackoverflow.com/users/4714084/warkentien2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "closed_date": 1449626820, "accepted_answer_id": 34169405, "answer_count": 2, "score": 0, "last_activity_date": 1449634055, "creation_date": 1449625381, "last_edit_date": 1449634055, "question_id": 34169353, "link": "https://stackoverflow.com/questions/34169353/adding-value-to-only-one-slot", "closed_reason": "Duplicate", "title": "Adding value to only one slot", "body": "<p>I'm trying to add values to a single slot in an Array. E.g.:</p>\n\n<pre><code>a = Array.new(3,[])    # =&gt; [[],[],[]]\na[1] &lt;&lt; \"value\"        # =&gt; [[],[\"value\"],[]]\n</code></pre>\n\n<p>However, value gets added to all slots in the array.</p>\n\n<pre><code># =&gt; [[\"value\"],[\"value\"],[\"value\"]]\n</code></pre>\n\n<p>Is there a reason for this behavior? Is there a standard way to add values to an array to avoid this behavior?</p>\n"}, {"tags": ["ruby", "csv", "large-files"], "comments": [{"owner": {"reputation": 10490, "user_id": 513951, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6cace4406e1ea825e78ec0134a5ea6fd?s=128&d=identicon&r=PG&f=1", "display_name": "user513951", "link": "https://stackoverflow.com/users/513951/user513951"}, "edited": false, "score": 2, "creation_date": 1449623238, "post_id": 34168814, "comment_id": 56085463, "body": "I tested this by running <code>CSV.open(&#39;foo&#39;, &#39;wb&#39;) {|x| loop { x &lt;&lt; [1,2,3] ; sleep 0.001 } }</code>) and watching the file size of <code>foo</code> in another shell. Every ~3 seconds the buffer fills up with 8196 bytes and is written to disk."}], "answers": [{"tags": [], "owner": {"reputation": 10490, "user_id": 513951, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6cace4406e1ea825e78ec0134a5ea6fd?s=128&d=identicon&r=PG&f=1", "display_name": "user513951", "link": "https://stackoverflow.com/users/513951/user513951"}, "is_accepted": true, "score": 14, "last_activity_date": 1612797192, "last_edit_date": 1612797192, "creation_date": 1449622171, "answer_id": 34168891, "question_id": 34168814, "link": "https://stackoverflow.com/questions/34168814/does-rubys-csv-open-buffer-to-memory-and-write-all-at-once/34168891#34168891", "title": "Does Ruby&#39;s CSV.open buffer to memory and write all at once?", "body": "<p><code>CSV.open</code> will write to the underlying OS when the block closes, and it will also write every time the buffer fills and is flushed, which will happen automatically. (In my Ruby install, it happens at 8196 bytes.) You can also add <code>csv.flush</code> to your block to force it to write sequentially.</p>\n<pre><code>require 'csv'\n\nCSV.open('result.csv', 'wb') do |csv|\n  while row = next_row\n    csv &lt;&lt; row  # Without flush, writes to underlying OS only when buffer fills\n    csv.flush   # Adding this forces a write to underlying OS\n  end\nend             # Exiting block writes to underlying OS and closes file handle\n</code></pre>\n<p>(Note that the writes are to the underlying OS, which may buffer the stream again before actually writing to disk.)</p>\n"}], "owner": {"reputation": 219, "user_id": 2480539, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/54d9b74c5de4feb771b12683d6d1676f?s=128&d=identicon&r=PG", "display_name": "eee", "link": "https://stackoverflow.com/users/2480539/eee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2699, "favorite_count": 0, "accepted_answer_id": 34168891, "answer_count": 1, "score": 9, "last_activity_date": 1612797192, "creation_date": 1449621560, "last_edit_date": 1449622025, "question_id": 34168814, "link": "https://stackoverflow.com/questions/34168814/does-rubys-csv-open-buffer-to-memory-and-write-all-at-once", "title": "Does Ruby&#39;s CSV.open buffer to memory and write all at once?", "body": "<p>Will <code>CSV.open</code> store data in memory and write to file one time when the block exits, or it will automatically write in many batches?</p>\n\n<pre><code>require 'csv'\n\nCSV.open('result.csv', 'wb') do |csv|\n  while row = next_row\n    csv &lt;&lt; row\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby", "loops"], "comments": [{"owner": {"reputation": 2212, "user_id": 4803039, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh3.googleusercontent.com/-MmbDSCFLpd8/AAAAAAAAAAI/AAAAAAAAADg/2jruEOH8FM0/photo.jpg?sz=128", "display_name": "philip yoo", "link": "https://stackoverflow.com/users/4803039/philip-yoo"}, "edited": false, "score": 1, "creation_date": 1449621993, "post_id": 34168742, "comment_id": 56085110, "body": "instead of the <code>while</code> loop, you can swap it for an <code>if</code> statement. <code>if another != &quot;no&quot;</code>"}, {"owner": {"reputation": 49, "user_id": 3971751, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/6bPuS.jpg?s=128&g=1", "display_name": "zappdapper", "link": "https://stackoverflow.com/users/3971751/zappdapper"}, "reply_to_user": {"reputation": 2212, "user_id": 4803039, "user_type": "registered", "accept_rate": 96, "profile_image": "https://lh3.googleusercontent.com/-MmbDSCFLpd8/AAAAAAAAAAI/AAAAAAAAADg/2jruEOH8FM0/photo.jpg?sz=128", "display_name": "philip yoo", "link": "https://stackoverflow.com/users/4803039/philip-yoo"}, "edited": false, "score": 0, "creation_date": 1449622502, "post_id": 34168742, "comment_id": 56085284, "body": "@philipyoo this worked too! Upvoted."}], "answers": [{"tags": [], "owner": {"reputation": 4171, "user_id": 3258698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68f432d577e5550e36ec267b85884364?s=128&d=identicon&r=PG", "display_name": "hbejgel", "link": "https://stackoverflow.com/users/3258698/hbejgel"}, "is_accepted": true, "score": 2, "last_activity_date": 1449621795, "creation_date": 1449621795, "answer_id": 34168844, "question_id": 34168742, "link": "https://stackoverflow.com/questions/34168742/how-can-i-terminate-this-ruby-while-loop-when-the-user-inputs-no/34168844#34168844", "title": "How can I terminate this Ruby `while` loop when the user inputs &quot;no&quot;?", "body": "<p>Well, the way you are doing it you are getting an infinite loop since the value of the <code>another</code> variable is not being updated inside the <code>while</code> loop.</p>\n\n<p>Try this instead:</p>\n\n<pre><code>def math_num\n    while true\n        nums = [num_1 = rand(1..10), num_2 = rand(1..10), operator = [\"+\", \"-\", \"/\",\"*\"].sample]\n        problem = \"What is #{num_1} #{operator} #{num_2}?\"\n        puts problem\n\n        $input = gets.to_i\n        $answer = num_1.send(operator, num_2)\n\n        puts $input == $answer ? \"You answered #{$input}, and the answer is #{$answer}! You are correct!\" : \"The answer is #{$answer}, not #{$input}! You are incorrect!\"   \n\n        puts \"Would you like to do another question?\"\n        another = gets.chomp.to_s\n        if another == \"no\"\n            break\n        end\n    end\nend\n\nmath_num\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 3971751, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/6bPuS.jpg?s=128&g=1", "display_name": "zappdapper", "link": "https://stackoverflow.com/users/3971751/zappdapper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "accepted_answer_id": 34168844, "answer_count": 1, "score": 0, "last_activity_date": 1449632773, "creation_date": 1449621108, "last_edit_date": 1449632773, "question_id": 34168742, "link": "https://stackoverflow.com/questions/34168742/how-can-i-terminate-this-ruby-while-loop-when-the-user-inputs-no", "title": "How can I terminate this Ruby `while` loop when the user inputs &quot;no&quot;?", "body": "<p>I'm working on a program that gives the user two random numbers ranging from 0 to 10 for the user to divide, multiply, add, or subtract. </p>\n\n<p>After every question, the user has the opportunity to stop the program by typing <code>no</code>. </p>\n\n<p>I am using a <code>while</code> loop for this, but I can't get the loop to terminate when the user inputs <code>no</code>. How can I get the program to respond correctly to the user input?</p>\n\n<pre><code>def math_num\n  nums = [num_1 = rand(1..10), num_2 = rand(1..10), operator = [\"+\", \"-\", \"/\", \"*\"].sample]\n  problem = \"What is #{num_1} #{operator} #{num_2}?\"\n  puts problem\n\n  $input = gets.to_i\n  $answer = num_1.send(operator, num_2)\n\n  puts $input == $answer ? \"You answered #{$input}, and the answer is #{$answer}! You are correct!\" : \"The answer is #{$answer}, not #{$input}! You are incorrect!\"   \n\n  def try_again\n    puts \"Would you like to do another question?\"\n    another = gets.chomp.to_s\n    while another != \"no\"\n        math_num\n    end\n  end\n\n  try_again \n\nend\n\nmath_num\n</code></pre>\n"}, {"tags": ["arrays", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 45754, "user_id": 17410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1022b779bdc1ddef7cd9d29abd70ed15?s=128&d=identicon&r=PG", "display_name": "zetetic", "link": "https://stackoverflow.com/users/17410/zetetic"}, "edited": false, "score": 0, "creation_date": 1449619572, "post_id": 34168343, "comment_id": 56084333, "body": "The explicit return (and the last assignment for that matter) is unnecessary."}, {"owner": {"reputation": 45754, "user_id": 17410, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1022b779bdc1ddef7cd9d29abd70ed15?s=128&d=identicon&r=PG", "display_name": "zetetic", "link": "https://stackoverflow.com/users/17410/zetetic"}, "edited": false, "score": 1, "creation_date": 1449620692, "post_id": 34168343, "comment_id": 56084706, "body": "I get it. There is also value in writing idiomatic  code."}, {"owner": {"reputation": 146, "user_id": 976032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53edf05d54b46513c747c43e0ff0c356?s=128&d=identicon&r=PG", "display_name": "offbyjuan", "link": "https://stackoverflow.com/users/976032/offbyjuan"}, "edited": false, "score": 0, "creation_date": 1449620748, "post_id": 34168343, "comment_id": 56084730, "body": "Added that additional one liner that leverages <code>chars</code> and negates <code>to_a</code> after my post. Nice."}, {"owner": {"reputation": 146, "user_id": 976032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53edf05d54b46513c747c43e0ff0c356?s=128&d=identicon&r=PG", "display_name": "offbyjuan", "link": "https://stackoverflow.com/users/976032/offbyjuan"}, "edited": false, "score": 0, "creation_date": 1449620977, "post_id": 34168343, "comment_id": 56084815, "body": "@JesseSielaff yeah, I realized that I forgot to answer the question, and no you didn&#39;t. you <i>just</i> removed the final one, and the use of <code>chars</code>... anyways. Good show."}], "tags": [], "owner": {"reputation": 10490, "user_id": 513951, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6cace4406e1ea825e78ec0134a5ea6fd?s=128&d=identicon&r=PG&f=1", "display_name": "user513951", "link": "https://stackoverflow.com/users/513951/user513951"}, "is_accepted": true, "score": 2, "last_activity_date": 1449621398, "last_edit_date": 1449621398, "creation_date": 1449618808, "answer_id": 34168343, "question_id": 34168277, "link": "https://stackoverflow.com/questions/34168277/why-dont-the-effects-of-my-ruby-for-loop-persist/34168343#34168343", "title": "Why don&#39;t the effects of my Ruby `for` loop persist?", "body": "<p>In your example attempt, you failed to modify the contents of the array. I've replaced your <code>for</code> loop with a call to <code>Array#map</code>, which has a return value of a new Array containing the results of each iteration in order. Here is a verbose version of the method you want (for clarity).</p>\n\n<pre><code>def number_shuffle(number)\n  permutations = number.to_s.split('').permutation\n\n  numbers = permutations.map do |digits|\n    digits.join.to_i\n  end\n\n  return numbers\nend\n\nnumber_shuffle 123 # =&gt; [123, 132, 213, 231, 312, 321]\n</code></pre>\n\n<p>If you prefer a one-liner (replacing <code>split</code> with <code>chars</code>, per @timbetimbe below):</p>\n\n<pre><code>def number_shuffle(n)\n  n.to_s.chars.permutation.map {|x| x.join.to_i }\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 379, "user_id": 2604889, "user_type": "registered", "profile_image": "https://graph.facebook.com/809550496/picture?type=large", "display_name": "Jean Meyer", "link": "https://stackoverflow.com/users/2604889/jean-meyer"}, "is_accepted": false, "score": 1, "last_activity_date": 1449619069, "creation_date": 1449619069, "answer_id": 34168391, "question_id": 34168277, "link": "https://stackoverflow.com/questions/34168277/why-dont-the-effects-of-my-ruby-for-loop-persist/34168391#34168391", "title": "Why don&#39;t the effects of my Ruby `for` loop persist?", "body": "<p>Even faster and more efficient (to not have to copy anything in memory):</p>\n\n<pre><code>def number_shuffle(number)\n  number.to_s.split('').permutation.to_a.map do |combination|\n    combination.join.to_i\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 146, "user_id": 976032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53edf05d54b46513c747c43e0ff0c356?s=128&d=identicon&r=PG", "display_name": "offbyjuan", "link": "https://stackoverflow.com/users/976032/offbyjuan"}, "is_accepted": false, "score": 2, "last_activity_date": 1449620866, "last_edit_date": 1449620866, "creation_date": 1449619604, "answer_id": 34168484, "question_id": 34168277, "link": "https://stackoverflow.com/questions/34168277/why-dont-the-effects-of-my-ruby-for-loop-persist/34168484#34168484", "title": "Why don&#39;t the effects of my Ruby `for` loop persist?", "body": "<p>The reason why your <code>for</code> loop does not mutate <code>combo</code> is because it does nothing to it. The interpreter just evaluates <code>i.join.to_i</code> but does not edit the value in place. </p>\n\n<p>Secondly, you do not need to use <code>for</code>, <code>return</code>, <code>split('')</code> or <code>to_a</code> on the return from <code>permutation</code> as they are not really idiomatic approaches. A more concise approach would be:</p>\n\n<pre><code>def number_shuffle(number)\n  number.to_s.chars.permutation.map { |combo| combo.join.to_i }\nend\n</code></pre>\n\n<p>Reasoning:</p>\n\n<ul>\n<li>favor <code>each</code> over <code>for</code> as it's preferred in the community.</li>\n<li>use <code>map</code> from <code>permutation</code> as it includes <code>Enumerable</code> (same as <code>Array</code>) so you can just jump right into <code>map</code> </li>\n<li><code>returns</code> are implicit, embrace that :)</li>\n</ul>\n\n<p>Linters help tremendously when getting started: <a href=\"https://github.com/bbatsov/rubocop\" rel=\"nofollow\">Rubocop</a></p>\n\n<p>This style guide is enforced by: <a href=\"https://github.com/bbatsov/ruby-style-guide\" rel=\"nofollow\">bbatsov's Style Guide</a></p>\n"}], "owner": {"reputation": 275, "user_id": 614607, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/cb86ac54ec996980cc1bbbd17d76d2ea?s=128&d=identicon&r=PG", "display_name": "Andy", "link": "https://stackoverflow.com/users/614607/andy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 34168343, "answer_count": 3, "score": 1, "last_activity_date": 1449621398, "creation_date": 1449618418, "last_edit_date": 1449620038, "question_id": 34168277, "link": "https://stackoverflow.com/questions/34168277/why-dont-the-effects-of-my-ruby-for-loop-persist", "title": "Why don&#39;t the effects of my Ruby `for` loop persist?", "body": "<p>I'm trying to put all unique combinations of a number's individual digits into an array. I'm passing in an integer and then using the permutation method. But to do so I believe I need to convert the number argument into a string. However when I iterate through the array, it is not joining the strings such that I can convert to an integer. Also I realize I should be using <code>each</code> to do the loop and not <code>for</code> but not sure how to do this in the block.</p>\n\n<pre><code>def number_shuffle(number)\n  combo = []\n  combo = number.to_s.split(\"\").permutation.to_a\n  for i in combo\n    i.join.to_i\n  end\n  return combo\nend\n</code></pre>\n\n<p>Is there something wrong with my loop? When I test one item in the array using <code>combo[0].join.to_i</code> I get an integer as output. But for some reason my loop is leaving these as strings.</p>\n"}, {"tags": ["ruby", "openid"], "answers": [{"tags": [], "owner": {"reputation": 2929, "user_id": 4162864, "user_type": "registered", "accept_rate": 63, "profile_image": "https://lh3.googleusercontent.com/-_1V3BLkCY9s/AAAAAAAAAAI/AAAAAAAAAOQ/MvO2DnNuEzQ/photo.jpg?sz=128", "display_name": "John Pollard", "link": "https://stackoverflow.com/users/4162864/john-pollard"}, "is_accepted": false, "score": 0, "last_activity_date": 1449614344, "creation_date": 1449614344, "answer_id": 34167428, "question_id": 34166707, "link": "https://stackoverflow.com/questions/34166707/how-to-get-ruby-openid-to-use-sreg-1-1-and-not-1-0/34167428#34167428", "title": "How to get Ruby OpenID to use sreg 1.1 and not 1.0", "body": "<p>Finally I found the answer! I had to create a new sreg request and then that used 1.1</p>\n\n<pre><code>       sregreq = OpenID::SReg::Request.new\n       # required fields\n       sregreq.request_fields(['email'], true)\n       # optional fields\n       sregreq.request_fields(['fullname'], false)\n       oidreq.add_extension(sregreq)\n</code></pre>\n"}], "owner": {"reputation": 2929, "user_id": 4162864, "user_type": "registered", "accept_rate": 63, "profile_image": "https://lh3.googleusercontent.com/-_1V3BLkCY9s/AAAAAAAAAAI/AAAAAAAAAOQ/MvO2DnNuEzQ/photo.jpg?sz=128", "display_name": "John Pollard", "link": "https://stackoverflow.com/users/4162864/john-pollard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 20, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449614344, "creation_date": 1449611507, "question_id": 34166707, "link": "https://stackoverflow.com/questions/34166707/how-to-get-ruby-openid-to-use-sreg-1-1-and-not-1-0", "title": "How to get Ruby OpenID to use sreg 1.1 and not 1.0", "body": "<p>I need the namespace for the OpenID sreg to be <a href=\"http://openid.net/extensions/sreg/1.1\" rel=\"nofollow\">http://openid.net/extensions/sreg/1.1</a> and not <a href=\"http://openid.net/sreg/1.0\" rel=\"nofollow\">http://openid.net/sreg/1.0</a>. How can I set OpenID to use 1.1? Can I set something in an intializer? OR is there something else Im not setting making openid think it can't use sreg 1.1?</p>\n\n<p>More specifically I need </p>\n\n<p>openid.ns.ext0=<a href=\"http://openid.net/extensions/sreg/1.1\" rel=\"nofollow\">http://openid.net/extensions/sreg/1.1</a></p>\n\n<p>and not </p>\n\n<p>openid.ns.ext0=<a href=\"http://openid.net/sreg/1.0\" rel=\"nofollow\">http://openid.net/sreg/1.0</a></p>\n\n<pre><code>def open_id\n    begin\n      oidreq = openid_consumer.begin 'https://openid.intuit.com/openid/xrds'\n    rescue OpenID::DiscoveryFailure =&gt; why\n        \"Sorry, we couldn't find your identifier '#{openid}'\"\n    else\n        oidreq.add_extension_arg('sreg','required','email')\n        oidreq.add_extension_arg('sreg','optional','fullname')\n\n        redirect_to oidreq.redirect_url(root_url, root_url + \"open_id_complete\")    \n    end\n  end\n\n  def self.openid_store\n    @openid_store ||= OpenID::Store::Memory.new\n  end\n\n  def openid_consumer\n    @openid_consumer ||= OpenID::Consumer.new(session, self.class.openid_store)\n  end\n\n\nend\n</code></pre>\n"}, {"tags": ["ruby", "ruby-on-rails-3", "activerecord"], "answers": [{"comments": [{"owner": {"reputation": 2077, "user_id": 1681247, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rc51O.jpg?s=128&g=1", "display_name": "Sri", "link": "https://stackoverflow.com/users/1681247/sri"}, "edited": false, "score": 0, "creation_date": 1449613588, "post_id": 34167123, "comment_id": 56081847, "body": "Thanks @dinjas. Is it possible that we can get the same type results without using the column counter?"}, {"owner": {"reputation": 2007, "user_id": 716039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b302eed6a8add5db6b3f2e1c7c9942?s=128&d=identicon&r=PG", "display_name": "dinjas", "link": "https://stackoverflow.com/users/716039/dinjas"}, "reply_to_user": {"reputation": 2077, "user_id": 1681247, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rc51O.jpg?s=128&g=1", "display_name": "Sri", "link": "https://stackoverflow.com/users/1681247/sri"}, "edited": false, "score": 0, "creation_date": 1449614078, "post_id": 34167123, "comment_id": 56082107, "body": "@Vinay Yea, you should be able to do <code>Counter.group([:name, :flowers]).count</code>"}, {"owner": {"reputation": 2077, "user_id": 1681247, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rc51O.jpg?s=128&g=1", "display_name": "Sri", "link": "https://stackoverflow.com/users/1681247/sri"}, "edited": false, "score": 0, "creation_date": 1449615295, "post_id": 34167123, "comment_id": 56082640, "body": "Thank you very much @dinjas. That&#39;s worked. Can you advise that using REGEX is a good way to split the name from vino_rose to Vino?"}, {"owner": {"reputation": 2007, "user_id": 716039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b302eed6a8add5db6b3f2e1c7c9942?s=128&d=identicon&r=PG", "display_name": "dinjas", "link": "https://stackoverflow.com/users/716039/dinjas"}, "reply_to_user": {"reputation": 2077, "user_id": 1681247, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rc51O.jpg?s=128&g=1", "display_name": "Sri", "link": "https://stackoverflow.com/users/1681247/sri"}, "edited": false, "score": 0, "creation_date": 1449616234, "post_id": 34167123, "comment_id": 56083009, "body": "@Vinay, it depends on what you&#39;re doing with it. If you just need to split it, you can do <code>name = &quot;vino_rose&quot;.split(&quot;_&quot;).first; flower = &quot;vino_rose&quot;.split(&quot;_&quot;).last</code> You can use a regex to see if the string contains a substring like <code>&quot;vino_rose&quot; =~ &#47;vino&#47;</code> (will return the index in the string the match occurs at, <code>0</code> in this case, or <code>nil</code> if no match). You can also do <code>&quot;vino_rose&quot;.include?(&quot;vino&quot;)</code> which will return <code>true</code> or <code>false</code>"}, {"owner": {"reputation": 2077, "user_id": 1681247, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rc51O.jpg?s=128&g=1", "display_name": "Sri", "link": "https://stackoverflow.com/users/1681247/sri"}, "edited": false, "score": 0, "creation_date": 1449617996, "post_id": 34167123, "comment_id": 56083742, "body": "Thank you very much and really appreciate your explanations helps me to understand clearly. Thanks"}, {"owner": {"reputation": 2007, "user_id": 716039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b302eed6a8add5db6b3f2e1c7c9942?s=128&d=identicon&r=PG", "display_name": "dinjas", "link": "https://stackoverflow.com/users/716039/dinjas"}, "reply_to_user": {"reputation": 2077, "user_id": 1681247, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rc51O.jpg?s=128&g=1", "display_name": "Sri", "link": "https://stackoverflow.com/users/1681247/sri"}, "edited": false, "score": 0, "creation_date": 1449620027, "post_id": 34167123, "comment_id": 56084485, "body": "No problem, glad it was helpful!"}, {"owner": {"reputation": 2077, "user_id": 1681247, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rc51O.jpg?s=128&g=1", "display_name": "Sri", "link": "https://stackoverflow.com/users/1681247/sri"}, "edited": false, "score": 0, "creation_date": 1449621532, "post_id": 34167123, "comment_id": 56084963, "body": "One more question @dinjas Is it possible to put <code>0</code> if the <code>name</code> does not have <code>flowers</code>? E.g., <code>Name-Gaya</code> does not have <code>Flower-Rose</code>"}, {"owner": {"reputation": 2007, "user_id": 716039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b302eed6a8add5db6b3f2e1c7c9942?s=128&d=identicon&r=PG", "display_name": "dinjas", "link": "https://stackoverflow.com/users/716039/dinjas"}, "reply_to_user": {"reputation": 2077, "user_id": 1681247, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rc51O.jpg?s=128&g=1", "display_name": "Sri", "link": "https://stackoverflow.com/users/1681247/sri"}, "edited": false, "score": 0, "creation_date": 1449621897, "post_id": 34167123, "comment_id": 56085080, "body": "I&#39;m not sure how you&#39;re accessing your data, but you should be able to convert <code>nil</code> to <code>0</code>. E.g. if your hash is <code>h = { &quot;vino_rose&quot; =&gt; 1, &quot;vino_lily&quot; =&gt; 2, &quot;gaya_rose&quot; =&gt; 1 }</code> and you do <code>h[&quot;gaya_lily&quot;]</code>, you&#39;ll get <code>nil</code>, so you can do <code>h[&quot;gaya_lily&quot;].to_i</code>, which will give you <code>0</code>"}, {"owner": {"reputation": 2077, "user_id": 1681247, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rc51O.jpg?s=128&g=1", "display_name": "Sri", "link": "https://stackoverflow.com/users/1681247/sri"}, "reply_to_user": {"reputation": 2007, "user_id": 716039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b302eed6a8add5db6b3f2e1c7c9942?s=128&d=identicon&r=PG", "display_name": "dinjas", "link": "https://stackoverflow.com/users/716039/dinjas"}, "edited": false, "score": 0, "creation_date": 1449622216, "post_id": 34167123, "comment_id": 56085186, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/97352/discussion-between-vinay-and-dinjas\">continue this discussion in chat</a>."}, {"owner": {"reputation": 2077, "user_id": 1681247, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rc51O.jpg?s=128&g=1", "display_name": "Sri", "link": "https://stackoverflow.com/users/1681247/sri"}, "edited": false, "score": 0, "creation_date": 1449622643, "post_id": 34167123, "comment_id": 56085330, "body": "Thanks @dinjas. I am bit confused now. I want to display into the table of distinct of names and each flower count. E.g., <code>Vino 1 2 0</code> where <code>name, rose_count, lily_count, sunflower_count</code>."}], "tags": [], "owner": {"reputation": 2007, "user_id": 716039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76b302eed6a8add5db6b3f2e1c7c9942?s=128&d=identicon&r=PG", "display_name": "dinjas", "link": "https://stackoverflow.com/users/716039/dinjas"}, "is_accepted": true, "score": 2, "last_activity_date": 1449613045, "creation_date": 1449613045, "answer_id": 34167123, "question_id": 34166660, "link": "https://stackoverflow.com/questions/34166660/number-of-string-value-occurrences-for-distinct-another-column-value/34167123#34167123", "title": "Number of string value occurrences for distinct another column value", "body": "<p>This will give you slightly different output, but I think it is probably closer to what you want than what you showed.</p>\n\n<p>You can use the query:</p>\n\n<pre><code>Counter.group([:name, :flowers]).sum(:counter)\n</code></pre>\n\n<p>To get a result set that looks like:</p>\n\n<pre><code>{ [\"vino\", \"rose\"] =&gt; 1, [\"vino\", \"lily\"] =&gt; 2, [\"gaya\", \"rose\"] =&gt; 1, [\"gaya\", \"lily\"] =&gt; 0, ... }\n</code></pre>\n\n<p>And you can do something like this to generate your hash:</p>\n\n<pre><code>def counter_results\n  @counter_results = {}\n  Counter.group([:name, :flowers]).sum(:counter).each do |k, v|\n    @counter_results[k.join(\"_\")] = v\n  end\n  @counter_results\nend\n</code></pre>\n\n<p>The resulting hash would look like this:</p>\n\n<pre><code>{\n  \"vino_rose\" =&gt; 1,\n  \"vino_lily\" =&gt; 2,\n  \"gaya_rose\" =&gt; 1,\n  \"gaya_lily\" =&gt; 0,\n  ...\n}\n</code></pre>\n\n<p>Somebody else may have a better way to do it, but seems like that should get you pretty close.</p>\n"}], "owner": {"reputation": 2077, "user_id": 1681247, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/rc51O.jpg?s=128&g=1", "display_name": "Sri", "link": "https://stackoverflow.com/users/1681247/sri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 34167123, "answer_count": 1, "score": 0, "last_activity_date": 1449616331, "creation_date": 1449611322, "last_edit_date": 1449616331, "question_id": 34166660, "link": "https://stackoverflow.com/questions/34166660/number-of-string-value-occurrences-for-distinct-another-column-value", "title": "Number of string value occurrences for distinct another column value", "body": "<p>I have a model Counter which returns the following records:</p>\n\n<pre><code>name.....flowers.....counter  \nvino.....rose.........1\nvino.....lily.........1 \ngaya.....rose.........1 \nrosi.....lily.........1 \nvino.....lily.........1 \nrosi.....rose.........1 \nrosi.....rose.........1 \n</code></pre>\n\n<p>I want to display in the table like:</p>\n\n<pre><code>name | Rose | Lily |\n---------------------\nVino |  1   | 2    |\n---------------------\nGaya |  1   | 0    |\n---------------------\nRosi |  2   | 1    |\n</code></pre>\n\n<p>I want to display the count of flowers for each distinct name. I have tried the following and wondering how can I do it elegantly?</p>\n\n<pre><code>def counter_results\n  @counter_results= {}\n  Counter.each do |name|\n    rose = Counter.where(flower: 'rose').count\n    lily= Counter.where(flower: 'lily').count\n    @counter_results['name'] = name\n    @counter_results['rose_count'] = rose\n    @counter_results['lily_count'] = lily\n  end\n  return @counter_results\nend\n</code></pre>\n\n<p>which I don't get the hash values.</p>\n"}, {"tags": ["arrays", "ruby", "datetime", "hash", "average"], "answers": [{"comments": [{"owner": {"reputation": 1277, "user_id": 536738, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24b4d1626ba0cbe1539da76854e46a20?s=128&d=identicon&r=PG", "display_name": "Michael Stalker", "link": "https://stackoverflow.com/users/536738/michael-stalker"}, "edited": false, "score": 0, "creation_date": 1449624822, "post_id": 34166943, "comment_id": 56085910, "body": "<code>el</code> should already be a string, so I don&#39;t think you need to call <code>#to_s</code> on it."}, {"owner": {"reputation": 499, "user_id": 2974739, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/aa0b69edfbd9f807b1d66c9afa3e8b9b?s=128&d=identicon&r=PG&f=1", "display_name": "user2974739", "link": "https://stackoverflow.com/users/2974739/user2974739"}, "edited": false, "score": 0, "creation_date": 1449872998, "post_id": 34166943, "comment_id": 56210996, "body": "For some reason I&#39;m not getting the right average time for this array.  times = [2015-12-10 05:58:24 UTC, 2015-12-09 03:35:28 UTC, 2015-12-08 06:32:26 UTC, 2015-12-07 01:43:28 UTC, 2015-12-05 07:49:30 UTC, 2015-12-04 07:02:30 UTC]  ave = Time.at(bed_times.map(&amp;:to_f).inject(:+) / bed_times.size) 2015-12-07 01:26:57 -0800  This is not the right average time.  Also, how would I convert this to a different Time Zone?"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 499, "user_id": 2974739, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/aa0b69edfbd9f807b1d66c9afa3e8b9b?s=128&d=identicon&r=PG&f=1", "display_name": "user2974739", "link": "https://stackoverflow.com/users/2974739/user2974739"}, "edited": false, "score": 0, "creation_date": 1449947942, "post_id": 34166943, "comment_id": 56229525, "body": "@user2974739 why is it not? I think that between 04 and 10 the average is somewhere at 07. So I assume it is right avg."}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": true, "score": 4, "last_activity_date": 1449644143, "last_edit_date": 1449644143, "creation_date": 1449612352, "answer_id": 34166943, "question_id": 34166625, "link": "https://stackoverflow.com/questions/34166625/calculate-average-time-from-array-of-hashes/34166943#34166943", "title": "Calculate average time from array of hashes", "body": "<pre><code>require 'time'\n\narray = [\n  {\"startTime\"=&gt;\"2015-12-05T07:49:30.000Z\", \"endTime\"=&gt;\"2015-12-05T15:56:30.000Z\"},\n  {\"startTime\"=&gt;\"2015-12-04T07:02:30.000Z\", \"endTime\"=&gt;\"2015-12-04T14:59:30.000Z\"},\n  {\"id\"=&gt;\"5660614e8a3b090700bad845\", \"userId\"=&gt;\"55cd59542d98600100397c12\", \"day\"=&gt;\"2015-12-03\", \"startTime\"=&gt;\"2015-12-03T06:02:32.000Z\", \"endTime\"=&gt;\"2015-12-03T13:38:32.000Z\"},\n  {\"startTime\"=&gt;\"2015-12-02T09:17:33.000Z\", \"endTime\"=&gt;\"2015-12-02T15:27:33.000Z\"},\n  {\"startTime\"=&gt;\"2015-12-01T05:45:36.000Z\", \"endTime\"=&gt;\"2015-12-01T13:50:36.000Z\"}\n]\n\ntimes = array.map{|el| el['startTime']}.map{|el| Time.parse(el) }\n#=&gt; [2015-12-05 07:49:30 UTC, 2015-12-04 07:02:30 UTC, 2015-12-03 06:02:32 UTC, 2015-12-02 09:17:33 UTC, 2015-12-01 05:45:36 UTC]\n\naverage_time = Time.at(times.map(&amp;:to_f).inject(:+) / times.size)\n#=&gt; 2015-12-03 08:11:32 +0100\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1449628149, "last_edit_date": 1449628149, "creation_date": 1449624429, "answer_id": 34169200, "question_id": 34166625, "link": "https://stackoverflow.com/questions/34166625/calculate-average-time-from-array-of-hashes/34169200#34169200", "title": "Calculate average time from array of hashes", "body": "<pre><code>require 'time'\n\nkeys = [\"startTime\", \"endTime\"]\nn = array.size\nkeys.zip(array.map { |h| h.values_at(*keys).map { |d| Time.parse(d).to_f }}.\n     transpose.\n     map { |a| Time.at(a.reduce(:+)/n) }).to_h\n  #=&gt; {\"startTime\"=&gt;2015-12-02 23:11:32 -0800, \"endTime\"=&gt;2015-12-03 06:46:32 -0800} \n</code></pre>\n\n<p>The steps:</p>\n\n<pre><code>keys = [\"startTime\", \"endTime\"]\nn = array.size\n  #=&gt; 5\na = array.map { |h| h.values_at(*keys).map { |d| DateTime.parse(d).to_time.to_f }}\n  #=&gt; [[1449301770.0, 1449330990.0],\n  #    [1449212550.0, 1449241170.0],\n  #    [1449122552.0, 1449149912.0],\n  #    [1449047853.0, 1449070053.0],\n  #    [1448948736.0, 1448977836.0]] \n</code></pre>\n\n<p>In computing <code>a</code>, the block variable is initially set to the first element of <code>array</code>:</p>\n\n<pre><code>h = array.first\n  #=&gt; {\"startTime\"=&gt;\"2015-12-05T07:49:30.000Z\", \"endTime\"=&gt;\"2015-12-05T15:56:30.000Z\"}     \n</code></pre>\n\n<p>and the block calculation is performed:</p>\n\n<pre><code>b = h.values_at(*keys)    \n  #=&gt; [\"2015-12-05T07:49:30.000Z\", \"2015-12-05T15:56:30.000Z\"] \nb.map { |d| Time.parse(d).to_f }\n  #=&gt; [1449301770.0, 1449330990.0] \n</code></pre>\n\n<p>Other elements of <code>a</code> are calculated similarly.</p>\n\n<p>Continuing with the calculation:</p>\n\n<pre><code>c = a.transpose\n  #=&gt; [[1449301770.0, 1449212550.0, 1449122552.0, 1449047853.0, 1448948736.0],\n  #    [1449330990.0, 1449241170.0, 1449149912.0, 1449070053.0, 1448977836.0]] \n\nd = c.map { |a| Time.at(a.reduce(:+)/n) }\n  #=&gt; [2015-12-02 23:11:32 -0800, 2015-12-03 06:46:32 -0800] \n</code></pre>\n\n<p>The calculation of <code>d</code> is equivalent to:</p>\n\n<pre><code>e = c.map { |a| a.reduce(:+) }\n  #=&gt; [7245633461.0, 7245769961.0] \nf = e.map { |t| t/n }\n  #=&gt; [1449126692.2, 1449153992.2] \nd = f.map { |t| Time.at(t) }\n  #=&gt; [2015-12-02 23:11:32 -0800, 2015-12-03 06:46:32 -0800] \n</code></pre>\n\n<p>The last step is to present the result in a hash:</p>\n\n<pre><code>g = keys.zip(d)\n  #=&gt; [[\"startTime\", 2015-12-02 23:11:32 -0800], [\"endTime\", 2015-12-03 06:46:32 -0800]] \ng.to_h\n  #=&gt; {\"startTime\"=&gt;2015-12-02 23:11:32 -0800,\n  #    \"endTime\"=&gt;2015-12-03 06:46:32 -0800} \n</code></pre>\n"}], "owner": {"reputation": 499, "user_id": 2974739, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/aa0b69edfbd9f807b1d66c9afa3e8b9b?s=128&d=identicon&r=PG&f=1", "display_name": "user2974739", "link": "https://stackoverflow.com/users/2974739/user2974739"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 34166943, "answer_count": 2, "score": 1, "last_activity_date": 1449644143, "creation_date": 1449611180, "last_edit_date": 1449612707, "question_id": 34166625, "link": "https://stackoverflow.com/questions/34166625/calculate-average-time-from-array-of-hashes", "title": "Calculate average time from array of hashes", "body": "<p>I am trying to calculate the average time from an array of hashes.  Here's the array.</p>\n\n<pre><code>array = [\n  {\"startTime\"=&gt;\"2015-12-05T07:49:30.000Z\", \"endTime\"=&gt;\"2015-12-05T15:56:30.000Z\"},\n  {\"startTime\"=&gt;\"2015-12-04T07:02:30.000Z\", \"endTime\"=&gt;\"2015-12-04T14:59:30.000Z\"},\n  {\"id\"=&gt;\"5660614e8a3b090700bad845\", \"userId\"=&gt;\"55cd59542d98600100397c12\", \"day\"=&gt;\"2015-12-03\", \"startTime\"=&gt;\"2015-12-03T06:02:32.000Z\", \"endTime\"=&gt;\"2015-12-03T13:38:32.000Z\"},\n  {\"startTime\"=&gt;\"2015-12-02T09:17:33.000Z\", \"endTime\"=&gt;\"2015-12-02T15:27:33.000Z\"},\n  {\"startTime\"=&gt;\"2015-12-01T05:45:36.000Z\", \"endTime\"=&gt;\"2015-12-01T13:50:36.000Z\"}\n]\n</code></pre>\n\n<p>I'm trying to get the average startTime and endTime.  Here is what I have tried so far.</p>\n\n<pre><code>avg = Time.at(array.map {|x| x['startTime']}.reduce(:+).to_f / array.size.to_i)\n</code></pre>\n\n<p>The result I get is 1969-12-31 16:06:43 -0800.  This is not correct.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "activerecord", "indexing"], "answers": [{"comments": [{"owner": {"reputation": 395, "user_id": 4929684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lHOlC2oTvoA/AAAAAAAAAAI/AAAAAAAAAEc/2uhYxnUQvCs/photo.jpg?sz=128", "display_name": "Adam Stox", "link": "https://stackoverflow.com/users/4929684/adam-stox"}, "edited": false, "score": 0, "creation_date": 1449679674, "post_id": 34167986, "comment_id": 56114958, "body": "Thanks benizi! That was the problem."}], "tags": [], "owner": {"reputation": 3426, "user_id": 82723, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6954f7e8e5df595e0b16a9cd547843c1?s=128&d=identicon&r=PG", "display_name": "benizi", "link": "https://stackoverflow.com/users/82723/benizi"}, "is_accepted": true, "score": 0, "last_activity_date": 1449624759, "last_edit_date": 1449624759, "creation_date": 1449616923, "answer_id": 34167986, "question_id": 34166601, "link": "https://stackoverflow.com/questions/34166601/how-to-add-both-a-partial-and-full-index-to-a-single-column/34167986#34167986", "title": "How to add both a partial and full index to a single column?", "body": "<p>Using those two lines in a single migration in a <code>change_table</code> block works fine.  Adding them in a <code>create_table</code> block doesn't work.</p>\n\n<p>Based on <a href=\"https://github.com/rails/rails/blob/a61e4ae58d65d43a97e90bdb02b6c407791e3c53/activerecord/lib/active_record/connection_adapters/abstract/schema_definitions.rb#L323-L329\" rel=\"nofollow\">the source of ActiveRecord::ConnectionAdapters::TableDefinition#index</a>, this is a limitation of the <code>create_table</code>-scoped <code>index</code> function.  Adding them directly in the <code>create_table</code> seems unidiomatic anyway.  I'd suggest:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>create_table :referral_programs do |t|\n  # whatever columns you need in the table\nend\nadd_index :referral_programs, [:streamer_id], name: \"index_referral_programs_on_streamer_id\"\nadd_index :referral_programs, [:streamer_id], where: \"active is true\", unique: true, name: \"index_active_referral_programs_on_streamer_id\"\n</code></pre>\n"}], "owner": {"reputation": 395, "user_id": 4929684, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lHOlC2oTvoA/AAAAAAAAAAI/AAAAAAAAAEc/2uhYxnUQvCs/photo.jpg?sz=128", "display_name": "Adam Stox", "link": "https://stackoverflow.com/users/4929684/adam-stox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 0, "accepted_answer_id": 34167986, "answer_count": 1, "score": 0, "last_activity_date": 1449624759, "creation_date": 1449611110, "last_edit_date": 1449617974, "question_id": 34166601, "link": "https://stackoverflow.com/questions/34166601/how-to-add-both-a-partial-and-full-index-to-a-single-column", "title": "How to add both a partial and full index to a single column?", "body": "<p>I'm trying to index a table I have on a single column using both a full index, and a partial index inside a create_table block like so:</p>\n\n<pre><code>t.index [:streamer_id], :name =&gt; \"index_referral_programs_on_streamer_id\"\nt.index [:streamer_id], :where =&gt; \"active is true\", :unique =&gt; :true, :name =&gt; \"index_active_referral_programs_on_streamer_id\"\n</code></pre>\n\n<p>however, only the second index is added to my schema after migrating. Is it possible to have both a partial and full index on a single column? And if so, how can I go about achieving that?</p>\n"}, {"tags": ["ruby", "regex", "parsing"], "answers": [{"comments": [{"owner": {"reputation": 434, "user_id": 5149741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f387e2de222199c33e049f88eb3649bc?s=128&d=identicon&r=PG&f=1", "display_name": "zolo", "link": "https://stackoverflow.com/users/5149741/zolo"}, "edited": false, "score": 0, "creation_date": 1449611188, "post_id": 34166610, "comment_id": 56080583, "body": "The () around the last part is optional, probably you wouldn&#39;t need."}], "tags": [], "owner": {"reputation": 434, "user_id": 5149741, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f387e2de222199c33e049f88eb3649bc?s=128&d=identicon&r=PG&f=1", "display_name": "zolo", "link": "https://stackoverflow.com/users/5149741/zolo"}, "is_accepted": true, "score": 1, "last_activity_date": 1449611143, "creation_date": 1449611143, "answer_id": 34166610, "question_id": 34166568, "link": "https://stackoverflow.com/questions/34166568/regex-extract-the-next-and-only-the-first-line-after-string/34166610#34166610", "title": "Regex_extract the next (and only the first) line after string", "body": "<pre><code>^(?&lt;=Title:\\n)([^\\n]+$)\n</code></pre>\n\n<p><a href=\"https://regex101.com/r/cF2pP7/1\" rel=\"nofollow\">DEMO</a></p>\n\n<p>Check it please.</p>\n"}], "owner": {"reputation": 71, "user_id": 5636380, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6a0930c8a07e8960323899060180800e?s=128&d=identicon&r=PG&f=1", "display_name": "Abdel", "link": "https://stackoverflow.com/users/5636380/abdel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 34166610, "answer_count": 1, "score": 1, "last_activity_date": 1589089729, "creation_date": 1449610946, "last_edit_date": 1589089729, "question_id": 34166568, "link": "https://stackoverflow.com/questions/34166568/regex-extract-the-next-and-only-the-first-line-after-string", "title": "Regex_extract the next (and only the first) line after string", "body": "<p>Using regex (on Ruby), how can I extract one line (only next line) after strings, like this</p>\n\n<blockquote>\n  <p><strong>Title:</strong><br>\n    this is the text I'd like to extract<br>\n    Not this one<br>\n    Neither this  </p>\n</blockquote>\n\n<p>I managed to extract the text using \"Lookahead and Lookbehind\" like this:</p>\n\n<pre><code>puts text.scan(/Title:[^;]*)Not this one/)\n</code></pre>\n\n<p>but the second part (\"Not this one\") is not always mentionned</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "params"], "comments": [{"owner": {"reputation": 15583, "user_id": 177489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/sv6zK.jpg?s=128&g=1", "display_name": "Mark Swardstrom", "link": "https://stackoverflow.com/users/177489/mark-swardstrom"}, "edited": false, "score": 0, "creation_date": 1449611773, "post_id": 34166536, "comment_id": 56080912, "body": "you put <code>accepts_nested_attributes_for :user_instruments</code> on user?  And, to make sure, you have <code>b</code>, <code>c</code>, <code>d</code>, ect. boolean columns on <code>user_instrument</code>?"}, {"owner": {"reputation": 89, "user_id": 4603373, "user_type": "registered", "profile_image": "https://graph.facebook.com/821964261208418/picture?type=large", "display_name": "Chris Kroon", "link": "https://stackoverflow.com/users/4603373/chris-kroon"}, "reply_to_user": {"reputation": 15583, "user_id": 177489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/sv6zK.jpg?s=128&g=1", "display_name": "Mark Swardstrom", "link": "https://stackoverflow.com/users/177489/mark-swardstrom"}, "edited": false, "score": 0, "creation_date": 1449646521, "post_id": 34166536, "comment_id": 56093017, "body": "Thx for the reply, I will add that I had  &quot;accepts_nested_attributes_for :instruments allready&quot;"}, {"owner": {"reputation": 89, "user_id": 4603373, "user_type": "registered", "profile_image": "https://graph.facebook.com/821964261208418/picture?type=large", "display_name": "Chris Kroon", "link": "https://stackoverflow.com/users/4603373/chris-kroon"}, "reply_to_user": {"reputation": 15583, "user_id": 177489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/sv6zK.jpg?s=128&g=1", "display_name": "Mark Swardstrom", "link": "https://stackoverflow.com/users/177489/mark-swardstrom"}, "edited": false, "score": 0, "creation_date": 1449646558, "post_id": 34166536, "comment_id": 56093027, "body": "And yes, this is my migration files for the chords:  class AddChordsToIntruments &lt; ActiveRecord::Migration   def change     add_column :instruments, :c, :boolean, default: false     add_column :instruments, :d, :boolean, default: false     add_column :instruments, :e, :boolean, default: false     add_column :instruments, :f, :boolean, default: false     add_column :instruments, :g, :boolean, default: false     add_column :instruments, :a, :boolean, default: false     add_column :instruments, :b, :boolean, default: false   end end"}, {"owner": {"reputation": 15583, "user_id": 177489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/sv6zK.jpg?s=128&g=1", "display_name": "Mark Swardstrom", "link": "https://stackoverflow.com/users/177489/mark-swardstrom"}, "edited": false, "score": 0, "creation_date": 1449648999, "post_id": 34166536, "comment_id": 56094346, "body": "not <code>instruments</code> in the user class, <code>user_instruments</code>.  You need accepts nested attributes_for :instrument in the user_instrument class.  It only goes one level, it doesn&#39;t go through."}, {"owner": {"reputation": 89, "user_id": 4603373, "user_type": "registered", "profile_image": "https://graph.facebook.com/821964261208418/picture?type=large", "display_name": "Chris Kroon", "link": "https://stackoverflow.com/users/4603373/chris-kroon"}, "reply_to_user": {"reputation": 15583, "user_id": 177489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/sv6zK.jpg?s=128&g=1", "display_name": "Mark Swardstrom", "link": "https://stackoverflow.com/users/177489/mark-swardstrom"}, "edited": false, "score": 0, "creation_date": 1449649925, "post_id": 34166536, "comment_id": 56094855, "body": "Thx again, then I get this error: &#39;No association found for name `instruments&#39;. Has it been defined yet?&#39;"}, {"owner": {"reputation": 15583, "user_id": 177489, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/sv6zK.jpg?s=128&g=1", "display_name": "Mark Swardstrom", "link": "https://stackoverflow.com/users/177489/mark-swardstrom"}, "edited": false, "score": 0, "creation_date": 1449679725, "post_id": 34166536, "comment_id": 56114987, "body": "You named the association &quot;instrument&quot; (<code>belongs_to :instrument</code>)"}], "answers": [{"tags": [], "owner": {"reputation": 680, "user_id": 4307225, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/071751491d3587fff6acc61e7e92668a?s=128&d=identicon&r=PG&f=1", "display_name": "baron816", "link": "https://stackoverflow.com/users/4307225/baron816"}, "is_accepted": false, "score": 0, "last_activity_date": 1449611932, "creation_date": 1449611932, "answer_id": 34166831, "question_id": 34166536, "link": "https://stackoverflow.com/questions/34166536/how-to-save-params-when-your-saving-for-a-different-user-in-ruby-on-rails/34166831#34166831", "title": "How to save params when your saving for a different user in Ruby on Rails", "body": "<p>You want to keep that on the students side of things. The change you want to make is to allow teachers to update the attributes of students. You want to use cancan or <a href=\"https://github.com/chaps-io/access-granted\" rel=\"nofollow\">access granted</a> (I like access granted) to set who can update what.</p>\n"}], "owner": {"reputation": 89, "user_id": 4603373, "user_type": "registered", "profile_image": "https://graph.facebook.com/821964261208418/picture?type=large", "display_name": "Chris Kroon", "link": "https://stackoverflow.com/users/4603373/chris-kroon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1449611932, "creation_date": 1449610802, "question_id": 34166536, "link": "https://stackoverflow.com/questions/34166536/how-to-save-params-when-your-saving-for-a-different-user-in-ruby-on-rails", "title": "How to save params when your saving for a different user in Ruby on Rails", "body": "<p>I am building this page where teachers (a kind of user) can edit settings of their students. Every student can tell their teacher what instrument they play and teachers can let their students know what chords they have mastered.</p>\n\n<p><strong>Student page</strong>\nP.S. friend = student</p>\n\n<pre><code>= form_for :friend_instrument do |f|\n  %br\n  %h4.media-heading.text-post.search-result.center Basic chords\n  %hr\n  .half\n    = f.label :c, \"C chord\"\n    = f.select :c, [['No', false], ['Yes', true]], {}, class: 'form-control'\n  .half\n    = f.label :d, \"D chord\"\n    = f.select :d, [['No', false], ['Yes', true]], {}, class: 'form-control'\n  .half\n    = f.label :e, \"E chord\"\n    = f.select :e, [['No', false], ['Yes', true]], {}, class: 'form-control'\n  .half\n    = f.label :f, \"F chord\"\n    = f.select :f, [['No', false], ['Yes', true]], {}, class: 'form-control'\n  .half\n    = f.label :g, \"G chord\"\n    = f.select :g, [['No', false], ['Yes', true]], {}, class: 'form-control'\n  .half\n    = f.label :a, \"A chord\"\n    = f.select :a, [['No', false], ['Yes', true]], {}, class: 'form-control'\n  .half\n    = f.label :b, \"B chord\"\n    = f.select :b, [['No', false], ['Yes', true]], {}, class: 'form-control'                               \n  = f.submit \"Update #{instrument.name} chords #{friend.full_name} mastered\", class: 'btn btn-primary form-control'\n</code></pre>\n\n<p><strong>user_controller</strong> </p>\n\n<pre><code>  def students\n    @instrument = Instrument.all\n  end\n  private\n  def user_attributes\n    params.require(:user).permit(:profile_picture, :cover_photo, :username, :full_name, :facebook_url, :featured_song, :soundcloud_url, :twitter_url, :location, :date_of_birth, :about, :website, :phone, :terms, :playlist_id, :subscribed, :password, :sort_user, :school_is, instrument_ids: [])\n  end\n</code></pre>\n\n<p><strong>user model</strong></p>\n\n<pre><code>  has_many :user_instruments, dependent: :destroy\n  has_many :instruments, through: :user_instruments\n  accepts_nested_attributes_for :instruments\n</code></pre>\n\n<p><strong>instrument model</strong></p>\n\n<pre><code>class Instrument &lt; ActiveRecord::Base\n  has_many :user_instruments\n  has_many :users, through: :user_instruments\n\n  has_many :meeting_instruments\n  has_many :meetings, through: :meeting_instruments\nend\n</code></pre>\n\n<p><strong>user instrument model</strong></p>\n\n<pre><code>class UserInstrument &lt; ActiveRecord::Base\n  belongs_to :user\n  belongs_to :instrument\nend\n</code></pre>\n\n<p>I tried to add user_instruments_attributes but no luck!\nAny help would be much appreciated.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "gem", "rvm"], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 2120527, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7e0e52fd30494cd8c4a2f3c9f844842e?s=128&d=identicon&r=PG", "display_name": "Full Metal", "link": "https://stackoverflow.com/users/2120527/full-metal"}, "edited": false, "score": 0, "creation_date": 1449610549, "post_id": 34166435, "comment_id": 56080229, "body": "I am locked into using version 2.2.3. Changing the gemfile to use 2.1.5 won&#39;t fix any of the problems listed, unless I&#39;m severely misunderstanding what you&#39;re suggesting."}, {"owner": {"reputation": 3811, "user_id": 793330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432566b982c73ead26d886951ca7a05c?s=128&d=identicon&r=PG", "display_name": "engineerDave", "link": "https://stackoverflow.com/users/793330/engineerdave"}, "reply_to_user": {"reputation": 47, "user_id": 2120527, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7e0e52fd30494cd8c4a2f3c9f844842e?s=128&d=identicon&r=PG", "display_name": "Full Metal", "link": "https://stackoverflow.com/users/2120527/full-metal"}, "edited": false, "score": 0, "creation_date": 1449610868, "post_id": 34166435, "comment_id": 56080410, "body": "well you&#39;re setting the ruby version bundler will use in Gemfile (or via .rvm_version file) if you followed the above link. So to use that version you must prefix your gem commands with &quot;bundle exec&quot; otherwise you&#39;ll leverage your system version of ruby. You don&#39;t need to uninstall your system ruby."}, {"owner": {"reputation": 47, "user_id": 2120527, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7e0e52fd30494cd8c4a2f3c9f844842e?s=128&d=identicon&r=PG", "display_name": "Full Metal", "link": "https://stackoverflow.com/users/2120527/full-metal"}, "edited": false, "score": 0, "creation_date": 1449611002, "post_id": 34166435, "comment_id": 56080494, "body": "I don&#39;t want version 2.1.5 at all. I have no use for it. I want to change my system ruby to 2.2.3, not change the project. l:"}, {"owner": {"reputation": 3811, "user_id": 793330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432566b982c73ead26d886951ca7a05c?s=128&d=identicon&r=PG", "display_name": "engineerDave", "link": "https://stackoverflow.com/users/793330/engineerdave"}, "reply_to_user": {"reputation": 47, "user_id": 2120527, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7e0e52fd30494cd8c4a2f3c9f844842e?s=128&d=identicon&r=PG", "display_name": "Full Metal", "link": "https://stackoverflow.com/users/2120527/full-metal"}, "edited": false, "score": 1, "creation_date": 1449612136, "post_id": 34166435, "comment_id": 56081112, "body": "then this isn&#39;t an RVM question. Just install the appropriate version of ruby from source. download, extract, ./configure, make, sudo make install"}], "tags": [], "owner": {"reputation": 3811, "user_id": 793330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432566b982c73ead26d886951ca7a05c?s=128&d=identicon&r=PG", "display_name": "engineerDave", "link": "https://stackoverflow.com/users/793330/engineerdave"}, "is_accepted": false, "score": 0, "last_activity_date": 1449610404, "creation_date": 1449610404, "answer_id": 34166435, "question_id": 34166372, "link": "https://stackoverflow.com/questions/34166372/controlling-ruby-version/34166435#34166435", "title": "Controlling Ruby Version", "body": "<p>You have to modify the Gemfile. </p>\n\n<p><a href=\"http://bundler.io/v1.3/gemfile_ruby.html\" rel=\"nofollow\">http://bundler.io/v1.3/gemfile_ruby.html</a></p>\n"}, {"comments": [{"owner": {"reputation": 47, "user_id": 2120527, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7e0e52fd30494cd8c4a2f3c9f844842e?s=128&d=identicon&r=PG", "display_name": "Full Metal", "link": "https://stackoverflow.com/users/2120527/full-metal"}, "edited": false, "score": 0, "creation_date": 1449611380, "post_id": 34166622, "comment_id": 56080702, "body": "What exactly is a gemset? Alternatively, how do I change the global default? I&#39;ve tried <code>update-alternatives</code> but it says there are no available alternatives for Ruby, and symlink hacks aren&#39;t working either.  Here is my gemfile: <a href=\"http://i.snag.gy/C6knh.jpg\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 3665, "user_id": 4330954, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/340ffba5552ac48227741a8695a255ff?s=128&d=identicon&r=PG", "display_name": "x6iae", "link": "https://stackoverflow.com/users/4330954/x6iae"}, "reply_to_user": {"reputation": 47, "user_id": 2120527, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7e0e52fd30494cd8c4a2f3c9f844842e?s=128&d=identicon&r=PG", "display_name": "Full Metal", "link": "https://stackoverflow.com/users/2120527/full-metal"}, "edited": false, "score": 1, "creation_date": 1449611520, "post_id": 34166622, "comment_id": 56080792, "body": "I just included a link to gemsets on the second option. Kindly check that."}, {"owner": {"reputation": 3665, "user_id": 4330954, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/340ffba5552ac48227741a8695a255ff?s=128&d=identicon&r=PG", "display_name": "x6iae", "link": "https://stackoverflow.com/users/4330954/x6iae"}, "reply_to_user": {"reputation": 47, "user_id": 2120527, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7e0e52fd30494cd8c4a2f3c9f844842e?s=128&d=identicon&r=PG", "display_name": "Full Metal", "link": "https://stackoverflow.com/users/2120527/full-metal"}, "edited": false, "score": 1, "creation_date": 1449611861, "post_id": 34166622, "comment_id": 56080958, "body": "And I just included a link for making a ruby version the default version too."}, {"owner": {"reputation": 47, "user_id": 2120527, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7e0e52fd30494cd8c4a2f3c9f844842e?s=128&d=identicon&r=PG", "display_name": "Full Metal", "link": "https://stackoverflow.com/users/2120527/full-metal"}, "edited": false, "score": 0, "creation_date": 1449615041, "post_id": 34166622, "comment_id": 56082529, "body": "Thank you. As it turns out, this was a common/expected <a href=\"https://rvm.io/integration/gnome-terminal\" rel=\"nofollow noreferrer\">issue with Ubuntu</a>, but I appreciate the instructions on setting the default and gemsets."}], "tags": [], "owner": {"reputation": 3665, "user_id": 4330954, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/340ffba5552ac48227741a8695a255ff?s=128&d=identicon&r=PG", "display_name": "x6iae", "link": "https://stackoverflow.com/users/4330954/x6iae"}, "is_accepted": true, "score": 2, "last_activity_date": 1449611827, "last_edit_date": 1449611827, "creation_date": 1449611178, "answer_id": 34166622, "question_id": 34166372, "link": "https://stackoverflow.com/questions/34166372/controlling-ruby-version/34166622#34166622", "title": "Controlling Ruby Version", "body": "<p>What you need to do is not try to remove <code>ruby 2.1.5</code>.</p>\n\n<p>You have RVM, so, use that to get the new version you want.</p>\n\n<p>After this, you now have two options:</p>\n\n<p>1) <a href=\"https://rvm.io/rubies/default\" rel=\"nofollow\">make the newly installed version the global default version</a> on your machine,</p>\n\n<p>or</p>\n\n<p>2) <a href=\"https://rvm.io/gemsets\" rel=\"nofollow\">create a gemset for your project</a>, and specify the needed ruby version for the project.</p>\n\n<p>Either of these will fix your problem.</p>\n"}], "owner": {"reputation": 47, "user_id": 2120527, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7e0e52fd30494cd8c4a2f3c9f844842e?s=128&d=identicon&r=PG", "display_name": "Full Metal", "link": "https://stackoverflow.com/users/2120527/full-metal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 34166622, "answer_count": 2, "score": 0, "last_activity_date": 1449612280, "creation_date": 1449610145, "last_edit_date": 1449610643, "question_id": 34166372, "link": "https://stackoverflow.com/questions/34166372/controlling-ruby-version", "title": "Controlling Ruby Version", "body": "<p>Forgive me if there's a duplicate, but I'm honestly not sure what to search for. I'm working on a project with Ruby on Rails, and I get this message when doing anything related (ie: rake, rails, rspec, etc.): </p>\n\n<blockquote>\n  <p>Your Ruby version is 2.1.5, but your Gemfile specified 2.2.3 </p>\n</blockquote>\n\n<p>Now, I've installed RVM and I can fix this issue by issuing the command</p>\n\n<p><code>bash --login</code></p>\n\n<p><em>edit for clarity</em></p>\n\n<p>running the above command does use Ruby 2.2.3 to execute the commands.</p>\n\n<p><em>/edit</em></p>\n\n<p>Then those given commands work. What I would like to do is to remove version 2.1.5 entirely -- leaving only 2.2.3. I've gone about this so many different ways, but Ruby is pretty foreign territory to me so I'm not sure what to do about this. I'm sure I have at least three installations of Ruby on my machine - possibly two duplicates of the two versions I know I have - and I would like only one version and to avoid needing to enter the <code>bash --login</code> command in order to run my project.</p>\n\n<p>I'm running Ubuntu 15.10 and have at least some knowledge of how this works. If somebody could walk me through removing everything related to Ruby &amp; Ruby on Rails, then installing only Ruby 2.2.3 and Rails 4.2.4, I would greatly appreciate that. Let me know if this isn't the proper exchange for this question. It didn't quite seem to fit into Ubuntu or Sysadmin.</p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "ruby-on-rails-4", "rails-activerecord"], "answers": [{"tags": [], "owner": {"reputation": 165, "user_id": 1369567, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d28097dcad5fe8741ebe2e54fb5aa61?s=128&d=identicon&r=PG", "display_name": "Caleuanhopkins", "link": "https://stackoverflow.com/users/1369567/caleuanhopkins"}, "is_accepted": true, "score": 0, "last_activity_date": 1449611134, "creation_date": 1449611134, "answer_id": 34166608, "question_id": 34166207, "link": "https://stackoverflow.com/questions/34166207/acitverecord-map-exsisting-row-id-to-class-record/34166608#34166608", "title": "AcitveRecord - Map exsisting Row id to Class Record", "body": "<pre><code>belongs_to :classtypes, :foreign_key =&gt; :adtype\nbelongs_to :classcat, :foreign_key =&gt; :cat\n</code></pre>\n\n<p>This did the trick for me</p>\n"}], "owner": {"reputation": 165, "user_id": 1369567, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/1d28097dcad5fe8741ebe2e54fb5aa61?s=128&d=identicon&r=PG", "display_name": "Caleuanhopkins", "link": "https://stackoverflow.com/users/1369567/caleuanhopkins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "accepted_answer_id": 34166608, "answer_count": 1, "score": 0, "last_activity_date": 1449611134, "creation_date": 1449609533, "last_edit_date": 1449609956, "question_id": 34166207, "link": "https://stackoverflow.com/questions/34166207/acitverecord-map-exsisting-row-id-to-class-record", "title": "AcitveRecord - Map exsisting Row id to Class Record", "body": "<p>I have 3 tables:</p>\n\n<p>Table 1:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pQULy.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pQULy.png\" alt=\"table1\"></a></p>\n\n<p>Table 2:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Nwehk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Nwehk.png\" alt=\"table2\"></a></p>\n\n<p>Table 3:</p>\n\n<p><a href=\"https://i.stack.imgur.com/8DGbS.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8DGbS.png\" alt=\"table3\"></a></p>\n\n<p>Table1.cat == Table2.id\nTable1.adtype == Table3.id</p>\n\n<p>Table 2's and Table 3's rows preexist and are not create when a new row from Table 1 is created. Rows from Table 2 and Table 3 should not depend on rows from Table 1.</p>\n\n<p>Using ActiveRecord in Rails 4, how do I map these correct so the row data from Table 2 and Table 3 is loaded through association?</p>\n\n<p>Assuming the Class for Table 1 is <code>test</code>, I want to be able to do <code>test.classname</code> and have it show <code>Fairway Woods</code>.</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 2282664, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/439162a722368fb47ab1c63119183d65?s=128&d=identicon&r=PG", "display_name": "Tracey Beauchat", "link": "https://stackoverflow.com/users/2282664/tracey-beauchat"}, "edited": false, "score": 0, "creation_date": 1449609944, "post_id": 34166250, "comment_id": 56079892, "body": "Thanks for the response.  What if each subclass also contains other class specific fields.  For example, work also contains a work_time field.  Also, could you give me some insight on how to write a migration for this."}, {"owner": {"reputation": 3811, "user_id": 793330, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/432566b982c73ead26d886951ca7a05c?s=128&d=identicon&r=PG", "display_name": "engineerDave", "link": "https://stackoverflow.com/users/793330/engineerdave"}, "edited": false, "score": 1, "creation_date": 1449610567, "post_id": 34166250, "comment_id": 56080242, "body": "You&#39;ve just hit on the problem with subclasses. Inheritance and class methods. Which is the reason most people will probably warn you away from using STI as it tends to have a lot of unintended side effects."}, {"owner": {"reputation": 51, "user_id": 2282664, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/439162a722368fb47ab1c63119183d65?s=128&d=identicon&r=PG", "display_name": "Tracey Beauchat", "link": "https://stackoverflow.com/users/2282664/tracey-beauchat"}, "edited": false, "score": 0, "creation_date": 1449610846, "post_id": 34166250, "comment_id": 56080395, "body": "Yeah, understood.  Basically I already have my tables for comments and work.  What I want to be able to do is get all comments and work entries for a specific task sorted by their created_at field.  Would there be a way to do this with my existing set up?"}], "tags": [], "owner": {"reputation": 4159, "user_id": 1959050, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/421de4eb68c9e4a007b0c90f05c15999?s=128&d=identicon&r=PG", "display_name": "Philip7899", "link": "https://stackoverflow.com/users/1959050/philip7899"}, "is_accepted": false, "score": 0, "last_activity_date": 1449609669, "creation_date": 1449609669, "answer_id": 34166250, "question_id": 34166082, "link": "https://stackoverflow.com/questions/34166082/modeling-ruby-subclasses-in-activerecord/34166250#34166250", "title": "Modeling ruby subclasses in ActiveRecord", "body": "<p>What you are looking for is called single table inheritance.  </p>\n\n<pre><code>class Comment &lt; Activity\n   belongs_to :tasks\nend\n\nclass Work &lt; Activity\n    belongs_to :tasks\nend\n</code></pre>\n\n<p>You will not have a <code>Comments</code> table or a <code>Works</code> table. You will only have an <code>Activitys</code> table.  In the table, make a column called <code>type</code> that holds a string.  Rails considers this type column special and will know that you are referring to another model as opposed to just a string.</p>\n"}], "owner": {"reputation": 51, "user_id": 2282664, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/439162a722368fb47ab1c63119183d65?s=128&d=identicon&r=PG", "display_name": "Tracey Beauchat", "link": "https://stackoverflow.com/users/2282664/tracey-beauchat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449609669, "creation_date": 1449609068, "question_id": 34166082, "link": "https://stackoverflow.com/questions/34166082/modeling-ruby-subclasses-in-activerecord", "title": "Modeling ruby subclasses in ActiveRecord", "body": "<p>I have two classes:</p>\n\n<pre><code>class Comment &gt; ActiveRecord::Base\n   belongs_to :tasks\nend\n\nclass Work &gt; ActiveRecord::Base\n    belongs_to :tasks\nend\n</code></pre>\n\n<p>each also includes a common field called content: string (along with the standard fields for user_id, created_at, etc)</p>\n\n<p>belonging to</p>\n\n<pre><code>class Task &lt; ActiveRecord::Base \n    has_many :comments\n    has_many :works\nend\n</code></pre>\n\n<p>What I want to do now is add a parent class called Activity for Comment and Work so that I can pull all Comments and Works from their respective tables for a specified Task containing the common fields, and I'm not sure how to back fit this in Ruby and Rails.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "jenkins", "continuous-integration", "capistrano"], "answers": [{"comments": [{"owner": {"reputation": 715, "user_id": 2464536, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/87e89a45fb2a98bcf44a43ff0f475019?s=128&d=identicon&r=PG", "display_name": "ajk4550", "link": "https://stackoverflow.com/users/2464536/ajk4550"}, "edited": false, "score": 0, "creation_date": 1449755728, "post_id": 34176171, "comment_id": 56151777, "body": "Thanks! That was the issue, I didn&#39;t realize Jenkins was it&#39;s own user and needed RVM installed. Thanks for the help!"}], "tags": [], "owner": {"reputation": 1066, "user_id": 3215470, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/rclPe.jpg?s=128&g=1", "display_name": "Andy Jones", "link": "https://stackoverflow.com/users/3215470/andy-jones"}, "is_accepted": true, "score": 1, "last_activity_date": 1449656135, "creation_date": 1449656135, "answer_id": 34176171, "question_id": 34165806, "link": "https://stackoverflow.com/questions/34165806/setting-up-jenkins-in-ruby-on-rails-environment/34176171#34176171", "title": "Setting up Jenkins in Ruby on Rails Environment", "body": "<p>You have two options to solve this, I think:</p>\n\n<ul>\n<li><p>Install RVM for the jenkins user, just as you would for a developer. Then your build script will understand rvm.</p></li>\n<li><p>Install the rvm plugin.  (I had to install the LTS version of Jenkins before this would work for me.)  Then you can take the RVM part out of the build script and make it an action.</p></li>\n</ul>\n\n<p>I'm pretty certain that either one of these will fix the above problem.  You shouldn't need to do both.</p>\n\n<p>(Disclaimer: New to Jenkins myself.)</p>\n"}], "owner": {"reputation": 715, "user_id": 2464536, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/87e89a45fb2a98bcf44a43ff0f475019?s=128&d=identicon&r=PG", "display_name": "ajk4550", "link": "https://stackoverflow.com/users/2464536/ajk4550"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 675, "favorite_count": 0, "accepted_answer_id": 34176171, "answer_count": 1, "score": 1, "last_activity_date": 1449656135, "creation_date": 1449607995, "question_id": 34165806, "link": "https://stackoverflow.com/questions/34165806/setting-up-jenkins-in-ruby-on-rails-environment", "title": "Setting up Jenkins in Ruby on Rails Environment", "body": "<p>I am trying to setup Jenkins to build then deploy my rails application but my builds keep failing. It is because Jenkins is looking at the wrong version of Ruby and not using RVM. Here is the build fail log:</p>\n\n<pre><code>/tmp/hudson3481773306458146820.sh: line 4: rvm: command not found\n/tmp/hudson3481773306458146820.sh: line 5: rvm: command not found\n/tmp/hudson3481773306458146820.sh: /usr/local/bin/bundle: /usr/bin/ruby1.9.1: bad interpreter: No such file or directory\n/tmp/hudson3481773306458146820.sh: /usr/local/bin/bundle: /usr/bin/ruby1.9.1: bad interpreter: No such file or directory\n/tmp/hudson3481773306458146820.sh: /usr/local/bin/bundle: /usr/bin/ruby1.9.1: bad interpreter: No such file or directory\n/tmp/hudson3481773306458146820.sh: /usr/local/bin/bundle: /usr/bin/ruby1.9.1: bad interpreter: No such file or directory\nBuild step 'Execute shell' marked build as failure\nWarning: you have no plugins providing access control for builds, so falling back to legacy behavior of permitting any downstream builds to be triggered\nFinished: FAILURE\n</code></pre>\n\n<p>Here is my build script:</p>\n\n<pre><code>#!/bin/bash\nsource /home/web/.bashrc\nrvm use 2.2.3\nrvm info\nbundle install\nbundle exec rake db:schema:load RAILS_ENV=test\nbundle exec rake db:test:prepare\nbundle exec rspec spec --order random --fail-fast\n</code></pre>\n\n<p>I am very lost on what to do, I've even tried to specify the ruby version in build script but it cannot find rvm. </p>\n\n<p>Here is my .bashrc</p>\n\n<pre><code>[[ -s \"$HOME/.rvm/scripts/rvm\" ]] &amp;&amp; source \"$HOME/.rvm/scripts/rvm\"\nexport PATH=\"$PATH:$HOME/.rvm/bin\" # Add RVM to PATH for scripting\n</code></pre>\n\n<p>Here is the output of rvm list:</p>\n\n<pre><code>web@localhost:~$ rvm list\n\nrvm rubies\n\n   ruby-2.1.5 [ x86_64 ]\n=* ruby-2.2.3 [ x86_64 ]\n\n# =&gt; - current\n# =* - current &amp;&amp; default\n#  * - default\n</code></pre>\n\n<p>ruby -v</p>\n\n<pre><code>ruby 2.2.3p173 (2015-08-18 revision 51636) [x86_64-linux]\n</code></pre>\n\n<p>Any idea what is going wrong?</p>\n"}, {"tags": ["ruby", "nginx", "websocket", "lxc"], "comments": [{"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1449635996, "post_id": 34165672, "comment_id": 56089008, "body": "I&#39;m not sure, but I think Faye requires a specific javascript client and I think there might be some connection headers involved and an XHR request made before the websocket one (but I might be wrong)..."}, {"owner": {"reputation": 11332, "user_id": 52499, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e13c0896a2408caf559934466737f716?s=128&d=identicon&r=PG", "display_name": "x-yuri", "link": "https://stackoverflow.com/users/52499/x-yuri"}, "reply_to_user": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1449650069, "post_id": 34165672, "comment_id": 56094941, "body": "Using <code>faye</code> was the easiest way to set up websocket server I knew. And when moved to host, I can connect to the app from <a href=\"http://www.websocket.org/echo.html\" rel=\"nofollow noreferrer\">the page I mentioned</a>."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1449651659, "post_id": 34165672, "comment_id": 56095943, "body": "So it&#39;s not a client issue... that&#39;s good to know. It might be the request headers from the nginx proxy. Did you try using <a href=\"http://www.plezi.io\" rel=\"nofollow noreferrer\">Plezi</a> to print out the headers to STDOUT or a log file? I posted a small script that will print out the headers to STDOUT... maybe it would help with finding the problem."}, {"owner": {"reputation": 11332, "user_id": 52499, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e13c0896a2408caf559934466737f716?s=128&d=identicon&r=PG", "display_name": "x-yuri", "link": "https://stackoverflow.com/users/52499/x-yuri"}, "reply_to_user": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1449652278, "post_id": 34165672, "comment_id": 56096367, "body": "The headers doesn&#39;t get printed for some reason."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1449652821, "post_id": 34165672, "comment_id": 56096692, "body": "Okay... my bad (sorry)... Please see the updated <code>index</code> method in my answer (notice I changed the <code>request_data</code> method name)... the index method should now be a single line showing <code>Iodine.log request_data</code>... The reason was that the Http path didn&#39;t log the headers, and since the issue is with the headers, the request was assumed to be Http instead of Websockets."}, {"owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "edited": false, "score": 0, "creation_date": 1449654842, "post_id": 34165672, "comment_id": 56098034, "body": "Your missing the <code>upgrade: websocket</code> header... I have no idea why... try bumping the <code>&#47;faye</code> setup so it&#39;s above the root setup (just a thought, but I&#39;m at a loss for now, as it works on my machine, see my updated answer)."}], "answers": [{"comments": [{"owner": {"reputation": 11332, "user_id": 52499, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e13c0896a2408caf559934466737f716?s=128&d=identicon&r=PG", "display_name": "x-yuri", "link": "https://stackoverflow.com/users/52499/x-yuri"}, "edited": false, "score": 0, "creation_date": 1449700893, "post_id": 34171188, "comment_id": 56127176, "body": "I&#39;ve figured it out. It didn&#39;t come to me to pass <code>Host</code> header. See <a href=\"http://stackoverflow.com/a/34190367/52499\">my answer</a>. Thanks for bearing with me."}], "tags": [], "owner": {"reputation": 16402, "user_id": 4025095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/blJ4L.jpg?s=128&g=1", "display_name": "Myst", "link": "https://stackoverflow.com/users/4025095/myst"}, "is_accepted": false, "score": 1, "last_activity_date": 1449654819, "last_edit_date": 1449654819, "creation_date": 1449637932, "answer_id": 34171188, "question_id": 34165672, "link": "https://stackoverflow.com/questions/34165672/how-to-serve-websocket-apps-from-inside-lxc-container/34171188#34171188", "title": "How to serve websocket apps from inside lxc container?", "body": "<p><strong>This is not an answer, just a thought I had about how to debug the issue.</strong></p>\n\n<p>Outputting the request's headers to a log will provide more information about the issue (the headers, as seen by the app, after the proxy header changes, might be different than expected).</p>\n\n<p>Here's a small app using <a href=\"http://www.plezi.io\" rel=\"nofollow\">Plezi</a> that is both a websocket Echo server and should print out the headers to a log (the default log is STDOUT, but you can use a file too), allowing you to review the nginx setup and request headers:</p>\n\n<p>the <code>gemfile</code>:</p>\n\n<pre><code>gem plezi\n</code></pre>\n\n<p>It's important <strong>not</strong> to use <code>thin</code> or any other server, since Plezi uses it's own Iodine server.</p>\n\n<p>the <code>app.rb</code> file:</p>\n\n<pre><code>#!/usr/bin/env ruby\n# require the gems\nrequire 'bundler'\nBundler.require(:default, ENV['ENV'].to_s.to_sym)\n# handle requests\nclass MyController\n    # Http\n    def index\n        Iodine.log request_data_string\n    end\n    # Websockets\n    def on_message data\n        write ERB::Util.html_escape(data)\n    end\n    def pre_connect\n        puts Iodine.log(request_data_string)\n        true\n    end\n    def on_open\n        write 'Welcome!'\n    end\n    # formatting the request data\n    protected\n    def request_data_string\n        out = String.new\n        out &lt;&lt; \"Request headers:\\n\"\n        out &lt;&lt; (request.headers.to_a.map {|p| p.join ': '} .join \"\\n\")\n        out &lt;&lt; \"\\n\\nRequest cookies:\\n\"\n        out &lt;&lt; (request.cookies.to_a.map {|p| p.join ': '} .join \"\\n\")\n        out &lt;&lt; \"\\n\\nAll request data:\\n\"\n        out &lt;&lt; (request.to_a.map {|p| p.join ': '} .join \"\\n\")\n        out\n    end\nend\nroute '*', MyController\n# # you can also set up logging to a file:\n# Plezi.logger = Logger.new(\"filename.log\")\n</code></pre>\n\n<p>to start:</p>\n\n<pre><code>ruby app.rb\n</code></pre>\n\n<p>or (to use any port number, 3000 is default):</p>\n\n<pre><code>./app.rb -p 3000\n</code></pre>\n\n<p>This should be a good enough app for testing and debugging any headers.</p>\n\n<p>Post the header data in your question for any further help. It could be that the headers aren't correctly parsed for websocket connections.</p>\n\n<hr>\n\n<h3>EDIT</h3>\n\n<p>I noticed the response Plezi gave was a 200 OK status code - meaning the request was assumed to be an Http request.</p>\n\n<p>This means it is probably a header's issue, as the request wasn't recognized to be a websocket upgrade request.</p>\n\n<hr>\n\n<h3>EDIT 2</h3>\n\n<p>On my machine, the following setup allows me to proxy both Http requests and Websocket requests (but I'm using Plezi, which lets me use both Websockets, Plezi's Http and a Rack application (i.e. Rails) on the same port):</p>\n\n<pre><code>    location / {\n        proxy_pass http://localhost:3000;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection $http_connection;\n    }\n</code></pre>\n\n<p>... but your configuration worked too (just messed-up Http's keep-alive, not the websockets)...</p>\n\n<p>... so I doubt if I found the issue.</p>\n"}, {"tags": [], "owner": {"reputation": 11332, "user_id": 52499, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e13c0896a2408caf559934466737f716?s=128&d=identicon&r=PG", "display_name": "x-yuri", "link": "https://stackoverflow.com/users/52499/x-yuri"}, "is_accepted": true, "score": 0, "last_activity_date": 1449700810, "creation_date": 1449700810, "answer_id": 34190367, "question_id": 34165672, "link": "https://stackoverflow.com/questions/34165672/how-to-serve-websocket-apps-from-inside-lxc-container/34190367#34190367", "title": "How to serve websocket apps from inside lxc container?", "body": "<p>Probably, the easier way to set it up is to proxy from host <code>nginx</code> directly to the app:</p>\n\n<p><code>/etc/nginx/sites-available/domain.com</code> (host):</p>\n\n<pre><code>server {\n    server_name   domain.com;\n    location / {\n        proxy_pass   http://10.0.0.109:3000;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection 'upgrade';\n    }\n}\n</code></pre>\n\n<p>But if you want to have the same nginx configuration regardless whether the app is running on the host, or guest, you can proxy it with two <code>nginx</code>.</p>\n\n<p><code>/etc/nginx/sites-available/domain.com</code> (host):</p>\n\n<pre><code>server {\n    server_name   domain.com;\n    location / {\n        proxy_pass   http://10.0.0.109:80;\n        proxy_set_header   Host   $http_host;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection 'upgrade';\n    }\n}\n</code></pre>\n\n<p>Passing <code>Host</code> header here is vital. Or else guest <code>nginx</code> might let the wrong virtual host handle the request. That was what I couldn't realize for quite a while.</p>\n\n<p><code>/etc/nginx/sites-available/domain.com</code> (guest):</p>\n\n<pre><code>server {\n    server_name   domain.com;\n    location / {\n        proxy_pass http://localhost:3000;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection 'upgrade';\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 11332, "user_id": 52499, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e13c0896a2408caf559934466737f716?s=128&d=identicon&r=PG", "display_name": "x-yuri", "link": "https://stackoverflow.com/users/52499/x-yuri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 0, "accepted_answer_id": 34190367, "answer_count": 2, "score": 0, "last_activity_date": 1537532982, "creation_date": 1449607426, "last_edit_date": 1537532982, "question_id": 34165672, "link": "https://stackoverflow.com/questions/34165672/how-to-serve-websocket-apps-from-inside-lxc-container", "title": "How to serve websocket apps from inside lxc container?", "body": "<p>Inside <code>lxc</code> container I'm running a <code>faye</code> app.</p>\n\n<p><code>Gemfile</code>:</p>\n\n<pre><code>source 'https://rubygems.org'\ngem 'faye'\ngem 'thin'\n</code></pre>\n\n<p><code>config.ru</code>:</p>\n\n<pre><code>require 'faye'\nFaye::WebSocket.load_adapter('thin')\nbayeux = Faye::RackAdapter.new(:mount =&gt; '/faye', :timeout =&gt; 25)\nrun bayeux\n</code></pre>\n\n<p>Then</p>\n\n<pre><code>$ thin start\n</code></pre>\n\n<p><code>/etc/nginx/sites-available/domain.com</code>:</p>\n\n<pre><code>server {\n    server_name   domain.com;\n    location /faye {\n        proxy_pass http://localhost:3000;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection 'upgrade';\n    }\n}\n</code></pre>\n\n<p>On the host:</p>\n\n<p><code>/etc/nginx/sites-available/domain.com</code>:</p>\n\n<pre><code>server {\n    server_name   domain.com;\n    location / {\n        proxy_pass   http://10.0.0.109:80;\n        proxy_set_header   X-Forwarded-For   $proxy_add_x_forwarded_for;\n        proxy_set_header   X-Real-IP   $remote_addr;\n        proxy_set_header   Host   $http_host;\n    }\n}\n</code></pre>\n\n<p>Then, I try to connect to it from <a href=\"http://www.websocket.org/echo.html\" rel=\"nofollow noreferrer\">here</a> (<code>ws://domain.com/faye</code>), but it fails. What am I doing wrong?</p>\n\n<p>The app says:</p>\n\n<pre><code>Using rack adapter\nThin web server (v1.6.4 codename Gob Bluth)\nMaximum connections set to 1024\nListening on 0.0.0.0:3000, CTRL+C to stop\n</code></pre>\n\n<p>Guest <code>nginx</code> access log:</p>\n\n<pre><code>10.0.0.1 - - [09/Dec/2015:11:03:21 +0200] \"GET /faye?encoding=text HTTP/1.0\" 400 11 \"-\" \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36\"\n</code></pre>\n\n<p>Host <code>nginx</code> access log:</p>\n\n<pre><code>11.111.111.111 - - [09/Dec/2015:11:03:21 +0200] \"GET /faye?encoding=text HTTP/1.1\" 400 21 \"-\" \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36\"\n</code></pre>\n\n<p><code>chrome</code>'s Developer tools's console:</p>\n\n<blockquote>\n  <p>WebSocket connection to 'ws://domain.com/faye?encoding=text' failed: Error during WebSocket handshake: Unexpected response code: 400</p>\n</blockquote>\n\n<hr>\n\n<p>I tried to run the app suggested by Myst on the guest.</p>\n\n<p><code>Gemfile</code>:</p>\n\n<pre><code>source 'https://rubygems.org'\ngem 'plezi'\n</code></pre>\n\n<p><code>app.rb</code>:</p>\n\n<pre><code>#!/usr/bin/env ruby\n# require the gems\nrequire 'bundler'\nBundler.require(:default, ENV['ENV'].to_s.to_sym)\n# handle requests\nclass MyController\n    # Http\n    def index\n        Iodine.log request_data_string\n    end\n    # Websockets\n    def on_message data\n        write ERB::Util.html_escape(data)\n    end\n    def pre_connect\n        puts Iodine.log(request_data_string)\n        true\n    end\n    def on_open\n        write 'Welcome!'\n    end\n    # formatting the request data\n    protected\n    def request_data_string\n        out = String.new\n        out &lt;&lt; \"Request headers:\\n\"\n        out &lt;&lt; (request.headers.to_a.map {|p| p.join ': '} .join \"\\n\")\n        out &lt;&lt; \"\\n\\nRequest cookies:\\n\"\n        out &lt;&lt; (request.cookies.to_a.map {|p| p.join ': '} .join \"\\n\")\n        out &lt;&lt; \"\\n\\nAll request data:\\n\"\n        out &lt;&lt; (request.to_a.map {|p| p.join ': '} .join \"\\n\")\n        out\n    end\nend\nroute '*', MyController\n# # you can also set up logging to a file:\n# Plezi.logger = Logger.new(\"filename.log\")\n</code></pre>\n\n<p>Then</p>\n\n<pre><code>$ ruby app.rb\n</code></pre>\n\n<p><code>/etc/nginx/sites-available/domain.com</code>:</p>\n\n<pre><code>server {\n    server_name   domain.com;\n    location / {\n        proxy_pass http://localhost:3000;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection 'upgrade';\n    }\n}\n</code></pre>\n\n<p>With this when I connect to <code>ws://domain.com/</code> the app says:</p>\n\n<pre><code>Iodine 0.1.19 is listening on port 3000\nPlezi is feeling optimistic running version 0.12.21.\n\nPress ^C to stop the server.\nRequest headers:\nconnection: upgrade\nhost: localhost:3000\nx-forwarded-for: 11.111.111.111\npragma: no-cache\ncache-control: no-cache\norigin: http://www.websocket.org\nsec-websocket-version: 13\nuser-agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36\naccept-encoding: gzip, deflate, sdch\naccept-language: en-US,en;q=0.8\nsec-websocket-key: Qs2LMnJ12SjclOxlrYKwlg==\nsec-websocket-extensions: permessage-deflate; client_max_window_bits\n\nRequest cookies:\n\n\nAll request data:\nio: #&lt;Iodine::Http::Http1:0x007fd5a0006b08&gt;\ncookies: {}\nparams: {:encoding=&gt;\"text\"}\nmethod: GET\nquery: /?encoding=text\nversion: 1.1\ntime_recieved: 2015-12-09 11:24:16 +0200\nconnection: upgrade\nhost: localhost:3000\nx-forwarded-for: 11.111.111.111\npragma: no-cache\ncache-control: no-cache\norigin: http://www.websocket.org\nsec-websocket-version: 13\nuser-agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36\naccept-encoding: gzip, deflate, sdch\naccept-language: en-US,en;q=0.8\nsec-websocket-key: Qs2LMnJ12SjclOxlrYKwlg==\nsec-websocket-extensions: permessage-deflate; client_max_window_bits\nheaders_complete: true\nclient_ip: 11.111.111.111\nscheme: http\nhost_name: localhost\nport: 3000\npath:\noriginal_path: /\nquery_params: encoding=text\nhost_settings: {:index_file=&gt;\"index.html\", :assets_public=&gt;\"/assets\", :public=&gt;nil, :assets_public_regex=&gt;/^\\/assets\\//i, :assets_public_length=&gt;8, :assets_refuse_templates=&gt;/(erb|coffee|scss|sass|\\.\\.\\/)$/i}11.111.111.111 [2015-12-09 09:24:16 UTC] \"GET / http/1.1\" 200 1659 0.6ms\n</code></pre>\n\n<p>Guest <code>nginx</code> access log:</p>\n\n<pre><code>10.0.0.1 - - [09/Dec/2015:10:55:44 +0200] \"GET /?encoding=text HTTP/1.0\" 200 1526 \"-\" \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36\"\n</code></pre>\n\n<p>Host <code>nginx</code> access log:</p>\n\n<pre><code>11.111.111.111 - - [09/Dec/2015:10:55:44 +0200] \"GET /?encoding=text HTTP/1.1\" 200 1526 \"-\" \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/46.0.2490.86 Safari/537.36\"\n</code></pre>\n\n<p><code>chrome</code>'s Developer tools's console:</p>\n\n<blockquote>\n  <p>WebSocket connection to 'ws://domain.com/?encoding=text' failed: Error during WebSocket handshake: Unexpected response code: 200</p>\n</blockquote>\n"}, {"tags": ["ruby-on-rails", "ruby", "unit-testing"], "comments": [{"owner": {"reputation": 25573, "user_id": 676874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8e67ec01dc3e7c402255ff26785863f?s=128&d=identicon&r=PG", "display_name": "knut", "link": "https://stackoverflow.com/users/676874/knut"}, "edited": false, "score": 0, "creation_date": 1449607923, "post_id": 34165260, "comment_id": 56078731, "body": "Your method has a syntax error (a missing begin after <code>def method</code>?)."}, {"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "reply_to_user": {"reputation": 25573, "user_id": 676874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8e67ec01dc3e7c402255ff26785863f?s=128&d=identicon&r=PG", "display_name": "knut", "link": "https://stackoverflow.com/users/676874/knut"}, "edited": false, "score": 1, "creation_date": 1449615299, "post_id": 34165260, "comment_id": 56082641, "body": "@knut Adding <code>begin</code> to the top of the method would fix the syntax error, but removing the extra <code>end</code> instead would be preferable (<code>def method; rescue; end</code> is preferable to <code>def method; begin; rescue; end; end</code>)."}], "answers": [{"tags": [], "owner": {"reputation": 25573, "user_id": 676874, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/c8e67ec01dc3e7c402255ff26785863f?s=128&d=identicon&r=PG", "display_name": "knut", "link": "https://stackoverflow.com/users/676874/knut"}, "is_accepted": false, "score": 0, "last_activity_date": 1449608019, "creation_date": 1449608019, "answer_id": 34165814, "question_id": 34165260, "link": "https://stackoverflow.com/questions/34165260/how-to-unit-test-a-method-for-timeout-exception-in-ruby/34165814#34165814", "title": "How to unit test a method for timeout exception in ruby", "body": "<p>You don't use a return code. If you add it, you could test for the method result.</p>\n\n<p>Example: </p>\n\n<pre><code>def method\n  begin\n    x = callservice()\n    if x[:value]\n      display_positve_feedback(\"positive\")\n      return true\n    else\n      display_negative_feedback(\"negative\")\n      return false\n    end\n    rescue Timeout::Error =&gt; e\n      display_negative_feedback(\"Timeout, please wait for 5 mins and check again\")\n      return nil\n  end\n  raise \"This should never happen\"\nend\n</code></pre>\n\n<p>Now you can test on <code>true</code>, <code>false</code>or <code>nil</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 930, "user_id": 505650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/955d59c94342d4453d33feb2e1cc39c2?s=128&d=identicon&r=PG", "display_name": "Jarno Lamberg", "link": "https://stackoverflow.com/users/505650/jarno-lamberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1449613787, "creation_date": 1449613787, "answer_id": 34167298, "question_id": 34165260, "link": "https://stackoverflow.com/questions/34165260/how-to-unit-test-a-method-for-timeout-exception-in-ruby/34167298#34167298", "title": "How to unit test a method for timeout exception in ruby", "body": "<p>Suppressing exceptions is usually not a good practice that I would recommend to anyone.</p>\n\n<p>When you catch (rescue) the timeout exception, re-raise it (or your own application-specific one) in the rescue code and have the caller (your test) check that an exception is thrown for the timeout.</p>\n\n<p>You could use <code>assert_raise</code> or expect <code>raise_error</code>, for example, depending on what testing framework you use.</p>\n\n<p>Using an exception, the calling code only needs to know about a potential exception rather than having to check for specific return values, which makes the code simpler and more clear.</p>\n"}, {"tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": false, "score": 0, "last_activity_date": 1449615930, "creation_date": 1449615930, "answer_id": 34167802, "question_id": 34165260, "link": "https://stackoverflow.com/questions/34165260/how-to-unit-test-a-method-for-timeout-exception-in-ruby/34167802#34167802", "title": "How to unit test a method for timeout exception in ruby", "body": "<p>Stub the <code>callservice</code> method to raise a <code>Timeout::Error</code>. How you'll do that depends on what testing framework you're using. For example, in RSpec it might look something like this:</p>\n\n<pre><code>my_obj.stub(:callservice) { raise Timeout::Error }\n\nexpect(my_obj).to receive(:display_negative_feedback)\n  .with(\"Timeout, please wait for 5 mins and check again\")\n\nmy_obj.method\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 5472936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0fdc9ef187ab8a54c7b36151f90ce73e?s=128&d=identicon&r=PG&f=1", "display_name": "Mandar Dalvi", "link": "https://stackoverflow.com/users/5472936/mandar-dalvi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 628, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1449615930, "creation_date": 1449606037, "question_id": 34165260, "link": "https://stackoverflow.com/questions/34165260/how-to-unit-test-a-method-for-timeout-exception-in-ruby", "title": "How to unit test a method for timeout exception in ruby", "body": "<p>I want to test a method which makes a call to a service, if the call to that service times out I am displaying a negative feedback to user. How to unittest the timeout use case ??</p>\n\n<p>My method looks like:</p>\n\n<pre><code>def method\n  x = callservice()\n  if x[:value]\n    display_positve_feedback(\"positive\")\n  else\n    display_negative_feedback(\"negative\")\n  end\n  rescue Timeout::Error =&gt; e\n    display_negative_feedback(\"Timeout, please wait for 5 mins and check again\")\n  end\nend\n</code></pre>\n\n<p>I have mocked callservice but how to I make that service Timeout to check the timeout use case???</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "jquery-select2", "ui-select2", "select2-rails"], "answers": [{"comments": [{"owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "edited": false, "score": 0, "creation_date": 1449609319, "post_id": 34165455, "comment_id": 56079552, "body": "The docs for this are so confusing. Can you please help me? How would I list out the challenges in the model? The docs just show relationships between different models. And then I guess I could just call those challenges + the optgroup label via <code>@challenge.grouped_collection_select(:name)</code>?"}], "tags": [], "owner": {"reputation": 3994, "user_id": 37019, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e4354cb7ba5e9c6a01f77eb8de753b62?s=128&d=identicon&r=PG", "display_name": "danielrsmith", "link": "https://stackoverflow.com/users/37019/danielrsmith"}, "is_accepted": false, "score": 1, "last_activity_date": 1449680117, "last_edit_date": 1449680117, "creation_date": 1449606683, "answer_id": 34165455, "question_id": 34164954, "link": "https://stackoverflow.com/questions/34164954/how-to-bold-headline-with-select2/34165455#34165455", "title": "How to Bold Headline With .select2?", "body": "<p>Have you tried: <code>grouped_collection_select</code>?</p>\n\n<p><a href=\"http://apidock.com/rails/ActionView/Helpers/FormOptionsHelper/grouped_collection_select\" rel=\"nofollow\">http://apidock.com/rails/ActionView/Helpers/FormOptionsHelper/grouped_collection_select</a></p>\n\n<p>Updated with example:</p>\n\n<p>Controller:</p>\n\n<pre><code>@collection = [['Mind', ['Write a Book', 'Paint a Picture']], ['Body', ['Run a 5K', 'Lose 10 Pounds']]]\n</code></pre>\n\n<p>View:</p>\n\n<pre><code>&lt;%= @challenge.grouped_collection_select(:name, @collection, :last, :first, :to_s, :to_s, include_blank: true) %&gt;\n</code></pre>\n\n<p>Obviously I don't have your exact source code, but this should work.</p>\n"}], "owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1449680117, "creation_date": 1449604887, "last_edit_date": 1495542798, "question_id": 34164954, "link": "https://stackoverflow.com/questions/34164954/how-to-bold-headline-with-select2", "title": "How to Bold Headline With .select2?", "body": "<p>How can I add a bold headline (aka <code>optgroup)</code> with <code>select2</code> using ruby?</p>\n\n<pre><code>  &lt;%= @challenge.select(:name, [[], ['optgroup label: Mind'], ['Write a Book'], ['Paint a Picture'], ['optgroup label: Body'], ['Run a 5K'], ['Lose 10 Pounds']]) %&gt;\n\n  $('select').select2({\n    placeholder: \"Enter Challenge\",\n    theme: \"bootstrap\",\n    allowClear: false,\n    tags: true,\n    multiple: false,\n  });\n</code></pre>\n\n<p>I'm having a hard time translating the answers offered here to a ruby solution: <a href=\"https://stackoverflow.com/questions/26192319/select2-how-to-insert-a-bolded-headline\">Select2 - How to insert a bolded headline?</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "conditional"], "comments": [{"owner": {"reputation": 2541, "user_id": 1162683, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e05cd764cc2ecba1884b309e9dd5df5?s=128&d=identicon&r=PG", "display_name": "penner", "link": "https://stackoverflow.com/users/1162683/penner"}, "edited": false, "score": 0, "creation_date": 1449604757, "post_id": 34164737, "comment_id": 56076836, "body": "Have you looked into the gem paper_trail? Maybe your question is not as clear as it could be?"}, {"owner": {"reputation": 19544, "user_id": 317989, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2cc8d0c8db8ad0ff2ed65ff3f5a56dd6?s=128&d=identicon&r=PG", "display_name": "house9", "link": "https://stackoverflow.com/users/317989/house9"}, "edited": false, "score": 1, "creation_date": 1449606281, "post_id": 34164737, "comment_id": 56077724, "body": "I think this would work? <code>&lt;% if @post.created_at != @post.updated_at %&gt;</code>"}], "answers": [{"comments": [{"owner": {"reputation": 11210, "user_id": 3046413, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/0c4b85a42ee3c491c13d36b9a5b8a789?s=128&d=identicon&r=PG&f=1", "display_name": "Carl Edwards", "link": "https://stackoverflow.com/users/3046413/carl-edwards"}, "edited": false, "score": 0, "creation_date": 1449605096, "post_id": 34164971, "comment_id": 56077039, "body": "Why the double <code>!!</code>s?"}, {"owner": {"reputation": 4203, "user_id": 494094, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4f841e920d687e5706b52468061da268?s=128&d=identicon&r=PG", "display_name": "hattenn", "link": "https://stackoverflow.com/users/494094/hattenn"}, "reply_to_user": {"reputation": 11210, "user_id": 3046413, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/0c4b85a42ee3c491c13d36b9a5b8a789?s=128&d=identicon&r=PG&f=1", "display_name": "Carl Edwards", "link": "https://stackoverflow.com/users/3046413/carl-edwards"}, "edited": false, "score": 1, "creation_date": 1449605186, "post_id": 34164971, "comment_id": 56077095, "body": "@CarlEdwards, when <code>@updated</code> is not defined, it returns <code>nil</code>. If you do <code>!!</code> it will return <code>false</code> for <code>nil</code>."}, {"owner": {"reputation": 11210, "user_id": 3046413, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/0c4b85a42ee3c491c13d36b9a5b8a789?s=128&d=identicon&r=PG&f=1", "display_name": "Carl Edwards", "link": "https://stackoverflow.com/users/3046413/carl-edwards"}, "edited": false, "score": 0, "creation_date": 1449605250, "post_id": 34164971, "comment_id": 56077132, "body": "I think I&#39;m starting to understand. What&#39;s the main difference between a single <code>!</code> and a double <code>!!</code>. I thought one was enough to negate something."}, {"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "reply_to_user": {"reputation": 11210, "user_id": 3046413, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/0c4b85a42ee3c491c13d36b9a5b8a789?s=128&d=identicon&r=PG&f=1", "display_name": "Carl Edwards", "link": "https://stackoverflow.com/users/3046413/carl-edwards"}, "edited": false, "score": 0, "creation_date": 1449605352, "post_id": 34164971, "comment_id": 56077204, "body": "@CarlEdwards It is; this coerces to an actual boolean value instead of relying on truthy/falsey."}, {"owner": {"reputation": 11210, "user_id": 3046413, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/0c4b85a42ee3c491c13d36b9a5b8a789?s=128&d=identicon&r=PG&f=1", "display_name": "Carl Edwards", "link": "https://stackoverflow.com/users/3046413/carl-edwards"}, "edited": false, "score": 0, "creation_date": 1449695053, "post_id": 34164971, "comment_id": 56124183, "body": "Strangely couldn&#39;t get this to work. Just to give you an idea, both methods are setup in the <code>Post</code> model. I created a new post and the <code>Updated At</code> field doesn&#39;t show up (as expected). When I do update that post nothing shows. Any ideas?"}], "tags": [], "owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "is_accepted": false, "score": 0, "last_activity_date": 1449604945, "creation_date": 1449604945, "answer_id": 34164971, "question_id": 34164737, "link": "https://stackoverflow.com/questions/34164737/how-to-check-if-a-model-instance-was-updated/34164971#34164971", "title": "How to check if a model instance was updated", "body": "<p>One possible solution is to set a flag whenever the element is updated.</p>\n\n<pre><code>class Model\n  after_update :flag_update    \n\n  def updated?\n    !!@updated\n  end\n\n  private\n\n  def flag_update\n    @updated = true\n  end\nend\n</code></pre>\n\n<p>Then in your code simply check <code>@post.updated?</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 12085, "user_id": 632688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6c6e4e8117bbd27fd25e9e2ea350458?s=128&d=identicon&r=PG", "display_name": "Wizard of Ogz", "link": "https://stackoverflow.com/users/632688/wizard-of-ogz"}, "is_accepted": false, "score": 0, "last_activity_date": 1449605152, "creation_date": 1449605152, "answer_id": 34165037, "question_id": 34164737, "link": "https://stackoverflow.com/questions/34164737/how-to-check-if-a-model-instance-was-updated/34165037#34165037", "title": "How to check if a model instance was updated", "body": "<p>You have an updated record when</p>\n\n<pre><code>@post.previous_changes.present? &amp;&amp; @post.previous_changes[\"id\"].nil?\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 930, "user_id": 505650, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/955d59c94342d4453d33feb2e1cc39c2?s=128&d=identicon&r=PG", "display_name": "Jarno Lamberg", "link": "https://stackoverflow.com/users/505650/jarno-lamberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1449616008, "last_edit_date": 1449616008, "creation_date": 1449615649, "answer_id": 34167740, "question_id": 34164737, "link": "https://stackoverflow.com/questions/34164737/how-to-check-if-a-model-instance-was-updated/34167740#34167740", "title": "How to check if a model instance was updated", "body": "<p>Sounds like a good candidate for using <code>after_update</code> <a href=\"http://guides.rubyonrails.org/active_record_callbacks.html#updating-an-object\" rel=\"nofollow\">callback</a> and in it calling a job to send an e-mail, text message or whatever your means of notifying a user is.</p>\n\n<p>Using the callback to flag the model instance basically adds a state for the model and only works once because it is set after the first update. Any subsequent updates might go unnoticed depending on what and how you want to notify your users, unless you could somehow reset the state (flag), which may be a lot more work than what it is worth.</p>\n\n<p>Relying on the <code>updated_at</code> timestamp to be greater than the <code>created_at</code> suffers from the same one-time opportunity than flagging.</p>\n\n<p>We used an approach where we checked what a model's <code>changes</code> returns (you could also use <code>changed?</code>) before saving it, and then sent a notification after a successful save. </p>\n"}, {"comments": [{"owner": {"reputation": 11210, "user_id": 3046413, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/0c4b85a42ee3c491c13d36b9a5b8a789?s=128&d=identicon&r=PG&f=1", "display_name": "Carl Edwards", "link": "https://stackoverflow.com/users/3046413/carl-edwards"}, "edited": false, "score": 0, "creation_date": 1449694235, "post_id": 34175707, "comment_id": 56123767, "body": "Similar to Wizard of Ogz&#39;s answer this doesn&#39;t work either."}], "tags": [], "owner": {"reputation": 73119, "user_id": 1143732, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mFUOI.jpg?s=128&g=1", "display_name": "Richard Peck", "link": "https://stackoverflow.com/users/1143732/richard-peck"}, "is_accepted": false, "score": 0, "last_activity_date": 1449654885, "last_edit_date": 1495539877, "creation_date": 1449654885, "answer_id": 34175707, "question_id": 34164737, "link": "https://stackoverflow.com/questions/34164737/how-to-check-if-a-model-instance-was-updated/34175707#34175707", "title": "How to check if a model instance was updated", "body": "<p>If you're able to call <code>previous_changes</code>, why not just add a conditional to make sure that <code>id</code> was not changed (as per this <a href=\"https://stackoverflow.com/a/7183918/1143732\">answer</a>):</p>\n\n<pre><code>&lt;% if @post.previous_changes &amp;&amp; !@post.id_changed? %&gt;\n   ...\n&lt;% end %&gt;\n</code></pre>\n"}], "owner": {"reputation": 11210, "user_id": 3046413, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/0c4b85a42ee3c491c13d36b9a5b8a789?s=128&d=identicon&r=PG&f=1", "display_name": "Carl Edwards", "link": "https://stackoverflow.com/users/3046413/carl-edwards"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 190, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1449654885, "creation_date": 1449604135, "question_id": 34164737, "link": "https://stackoverflow.com/questions/34164737/how-to-check-if-a-model-instance-was-updated", "title": "How to check if a model instance was updated", "body": "<p>I've searched through the site on how to accomplish this and many answers point towards using the <code>changed?</code> method. I'm trying to notify users of an update <strong>after persisting the DB</strong> so unfortunately this won't work. </p>\n\n<p>I then found the <code>previous_changes</code> method but this also triggers when a post is first created. The goal for is to do this only edit actions. How can this be done?</p>\n\n<pre><code>&lt;% if @post.previous_changes %&gt;\n  &lt;span&gt;Updated:&lt;/span&gt; &lt;span&gt;&lt;%= time_ago_in_words(@post.updated_at) %&gt; ago&lt;/span&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby", "regex", "string"], "comments": [{"owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "edited": false, "score": 1, "creation_date": 1449604782, "post_id": 34164635, "comment_id": 56076850, "body": "You may want to explain what you have tried and what went wrong. Did you try to use <code>scan</code>?"}, {"owner": {"reputation": 16919, "user_id": 152825, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e990c2bcb4dfb7fd0c398098da9bca59?s=128&d=identicon&r=PG", "display_name": "timpone", "link": "https://stackoverflow.com/users/152825/timpone"}, "reply_to_user": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "edited": false, "score": 0, "creation_date": 1449604857, "post_id": 34164635, "comment_id": 56076893, "body": "scan - ah, not yet, was thinking match or split but knew there had to be a better way. partition, maybe???"}], "answers": [{"comments": [{"owner": {"reputation": 16919, "user_id": 152825, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e990c2bcb4dfb7fd0c398098da9bca59?s=128&d=identicon&r=PG", "display_name": "timpone", "link": "https://stackoverflow.com/users/152825/timpone"}, "edited": false, "score": 0, "creation_date": 1449605506, "post_id": 34165047, "comment_id": 56077295, "body": "cool thx - exactly what I was looking for! I think I would have spent a solid morning trying to get there (and probably wouldn&#39;t have been as elegant).  Yeah, as long as it requires both sides, I&#39;m ok with the non-nested [TN][/TN]"}, {"owner": {"reputation": 907, "user_id": 4564746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Im4Oc.jpg?s=128&g=1", "display_name": "aaron_world_traveler", "link": "https://stackoverflow.com/users/4564746/aaron-world-traveler"}, "reply_to_user": {"reputation": 16919, "user_id": 152825, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e990c2bcb4dfb7fd0c398098da9bca59?s=128&d=identicon&r=PG", "display_name": "timpone", "link": "https://stackoverflow.com/users/152825/timpone"}, "edited": false, "score": 0, "creation_date": 1449605642, "post_id": 34165047, "comment_id": 56077362, "body": "Well, I certainly love creating regexes, glad I could help!  Yeah, if you end up with nested tags, the matches will be incorrect."}, {"owner": {"reputation": 305, "user_id": 4118249, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/S5SNY.jpg?s=128&g=1", "display_name": "BlackBrain", "link": "https://stackoverflow.com/users/4118249/blackbrain"}, "edited": false, "score": 1, "creation_date": 1449607052, "post_id": 34165047, "comment_id": 56078207, "body": "You can add the <code>m</code> modifier to match the newline character too (just put <code>m</code> after the last <code>&#47;</code>)."}], "tags": [], "owner": {"reputation": 907, "user_id": 4564746, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Im4Oc.jpg?s=128&g=1", "display_name": "aaron_world_traveler", "link": "https://stackoverflow.com/users/4564746/aaron-world-traveler"}, "is_accepted": true, "score": 2, "last_activity_date": 1449605192, "creation_date": 1449605192, "answer_id": 34165047, "question_id": 34164635, "link": "https://stackoverflow.com/questions/34164635/how-to-copy-out-an-array-of-references-that-are-between-two-values-in-a-ruby-str/34165047#34165047", "title": "how to copy out an array of references that are between two values in a ruby string", "body": "<p>As long as you're certain that there won't be any nested <code>[TN]...[/TN]</code> tags, then you can use a simple regex for this:</p>\n\n<pre><code>a.scan(/(?&lt;=\\[TN\\]).*?(?=\\[\\/TN\\])/)\n</code></pre>\n"}], "owner": {"reputation": 16919, "user_id": 152825, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e990c2bcb4dfb7fd0c398098da9bca59?s=128&d=identicon&r=PG", "display_name": "timpone", "link": "https://stackoverflow.com/users/152825/timpone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 34165047, "answer_count": 1, "score": -2, "last_activity_date": 1449605192, "creation_date": 1449603792, "last_edit_date": 1449604337, "question_id": 34164635, "link": "https://stackoverflow.com/questions/34164635/how-to-copy-out-an-array-of-references-that-are-between-two-values-in-a-ruby-str", "title": "how to copy out an array of references that are between two values in a ruby string", "body": "<p>I'd like to get an array of values between delimiters. How would I do this? Like if I was using TN as delimiters and BBCode-type delimiting:</p>\n\n<p>Like:</p>\n\n<pre><code>a=\"things [TN]are like[/TN] this [TN]for you[/TN]\"\nb=a.xxxx\nb=[\"are like\",\"for you\"]\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "paperclip"], "answers": [{"comments": [{"owner": {"reputation": 75, "user_id": 5091165, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4a60d1250a221a060410fd2a69dfc38c?s=128&d=identicon&r=PG", "display_name": "Terence Devine", "link": "https://stackoverflow.com/users/5091165/terence-devine"}, "edited": false, "score": 0, "creation_date": 1449626204, "post_id": 34166135, "comment_id": 56086317, "body": "When I do this with <b>:threesixty_viewer_id</b> or any other attribute that should be available (ie :article_id) - it saves the directory as exactly that... so it now looks like <code>&#47;public&#47;system&#47;threesixty_viewer_images&#47;:threesixty_viewer_i&zwnj;&#8203;d&#47;large&#47;filename.jpg</code>"}, {"owner": {"reputation": 88, "user_id": 2444226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c84530e9b03d0f77f1ae8eb08b6b825?s=128&d=identicon&r=PG", "display_name": "Colin_Hagan", "link": "https://stackoverflow.com/users/2444226/colin-hagan"}, "reply_to_user": {"reputation": 75, "user_id": 5091165, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4a60d1250a221a060410fd2a69dfc38c?s=128&d=identicon&r=PG", "display_name": "Terence Devine", "link": "https://stackoverflow.com/users/5091165/terence-devine"}, "edited": false, "score": 0, "creation_date": 1452112753, "post_id": 34166135, "comment_id": 57030587, "body": "updated my answer with some more specific details about interpolations and how to use them."}], "tags": [], "owner": {"reputation": 88, "user_id": 2444226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4c84530e9b03d0f77f1ae8eb08b6b825?s=128&d=identicon&r=PG", "display_name": "Colin_Hagan", "link": "https://stackoverflow.com/users/2444226/colin-hagan"}, "is_accepted": false, "score": 2, "last_activity_date": 1499284048, "last_edit_date": 1499284048, "creation_date": 1449609250, "answer_id": 34166135, "question_id": 34164620, "link": "https://stackoverflow.com/questions/34164620/rails-paperclip-gem-save-parent-model-id-to-path/34166135#34166135", "title": "Rails Paperclip Gem - save parent model ID to path", "body": "<p>You can add any of the models attributes to that path for this object. I believe you can even go so far as adding anything that the method will respond to, so you can even create path helpers for returning specific strings (such as month it was saved, year, etc).</p>\n\n<p>In your case,  <strong>ThreesixtyViewerImage</strong> is a child model, your table should include a column for the parent model. In your case, that attribute is probably <strong>:threesixty_viewer_id</strong></p>\n\n<p>Here is what I think you need for setting that path on <strong>threesixty_viewer_image.rb</strong>:</p>\n\n<pre><code>has_attached_file :image, \n  styles: { small: \"500x500#\", large: \"1440x800&gt;\" },\n  path: \":rails_root/public/system/:class/:threesixty_viwer_id/:size/:filename\",\n  url: \"/system/:class/:threesixty_viewer_id/:size/:filename\"\n\nvalidates_attachment_content_type :image, content_type: /\\Aimage\\/.*\\Z/\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>Everything I said above is dead wrong. <em>My apologies!</em> What you need to use is a <code>Paperclip::Interpolation</code>. <a href=\"https://github.com/thoughtbot/paperclip/wiki/Interpolations\" rel=\"nofollow noreferrer\">Here's a link</a></p>\n\n<p>Here's what I did to make use:</p>\n\n<ol>\n<li>Create a new file: <code>config/initializers/paperclip_interpolators</code></li>\n<li><p>Place something like this in that file:</p>\n\n<pre><code>Paperclip.interpolates :threesixty_viewer_id do |attachment, style|\n  attachment.instance.threesixty_viewer_id\nend\n</code></pre></li>\n<li>Restart your application</li>\n<li>Regenerate your paths/folders for the attachments. <a href=\"https://github.com/thoughtbot/paperclip/wiki/Thumbnail-Generation#generatingregenerating-your-thumbnails\" rel=\"nofollow noreferrer\">Here's a Link</a></li>\n</ol>\n\n<p>Anytime you want another attribute in your path, just add another interpolator! Sorry again for misleading you before.</p>\n"}, {"comments": [{"owner": {"reputation": 75, "user_id": 5091165, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4a60d1250a221a060410fd2a69dfc38c?s=128&d=identicon&r=PG", "display_name": "Terence Devine", "link": "https://stackoverflow.com/users/5091165/terence-devine"}, "edited": false, "score": 0, "creation_date": 1449675438, "post_id": 34177367, "comment_id": 56111792, "body": "this took care of it thanks! the paperclip_defaults is a great tip too, will definitely plan on using that on my next project! Thanks again!"}], "tags": [], "owner": {"reputation": 73119, "user_id": 1143732, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mFUOI.jpg?s=128&g=1", "display_name": "Richard Peck", "link": "https://stackoverflow.com/users/1143732/richard-peck"}, "is_accepted": false, "score": 1, "last_activity_date": 1449659548, "creation_date": 1449659548, "answer_id": 34177367, "question_id": 34164620, "link": "https://stackoverflow.com/questions/34164620/rails-paperclip-gem-save-parent-model-id-to-path/34177367#34177367", "title": "Rails Paperclip Gem - save parent model ID to path", "body": "<p><code>@colin_hagan</code> is on the right path - I would suggest you look into <a href=\"https://github.com/thoughtbot/paperclip/wiki/Interpolations\" rel=\"nofollow\">Paperclip Interpolations</a>:</p>\n\n<pre><code>#app/models/threesixty_viewer_image.rb\nclass ThreesixtyViewerImage &lt; ActiveRecord::Base\n   belongs_to :threesixty_viewer\n\n   has_attached_file :image,\n      path: \":rails_root/public/system/:class/:threesixty_viewer_id/:size/:filename\",\n      url: \"/system/:class/:threesixty_viewer_id/:size/:filename\"\n\n   Paperclip.interpolates :threesixty_viewer_id do |attachment, style|\n      attachment.instance.threesixty_viewer_id\n   end\nend\n</code></pre>\n\n<p>Notice the double quotes, rather than single.</p>\n\n<p>Double quotes should be used for interpolation - single quotes are for literal strings (<em>I think</em>).</p>\n\n<hr>\n\n<p>Another thing I found some time back is the <a href=\"https://github.com/thoughtbot/paperclip#defaults\" rel=\"nofollow\"><code>paperclip_defaults</code></a> option -- allowing you to specify <code>styles</code> etc for any attachments:</p>\n\n<pre><code>#config/application.rb\n...\nconfig.paperclip_defaults = { \n   styles: { small: \"500x500#\", large: \"1440x800&gt;\" }\n}\n</code></pre>\n\n<p>These can be overridden in your respective models - it's just handy for me, as it means you don't have to explicitly define <code>styles</code> each time you have an attachment.</p>\n"}], "owner": {"reputation": 75, "user_id": 5091165, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4a60d1250a221a060410fd2a69dfc38c?s=128&d=identicon&r=PG", "display_name": "Terence Devine", "link": "https://stackoverflow.com/users/5091165/terence-devine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 973, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1499284048, "creation_date": 1449603741, "last_edit_date": 1592644375, "question_id": 34164620, "link": "https://stackoverflow.com/questions/34164620/rails-paperclip-gem-save-parent-model-id-to-path", "title": "Rails Paperclip Gem - save parent model ID to path", "body": "<p>I have a model of <strong>ThreesixtyViewer</strong> which also has a nested resource of the <strong>ThreesixtyViewerImage</strong> model. An image attribute is being saved via the <a href=\"https://github.com/thoughtbot/paperclip\" rel=\"nofollow noreferrer\">paperclip gem</a> - but I am having issues updating the file path how it's needed.</p>\n<p>The images for each <strong>ThreesixtyViewer</strong> needs to be saved together within one directory that is associated with the specific viewer. For example:</p>\n<pre><code>/public/system/threesixty_viewer_images/12/large/filename.jpg\n</code></pre>\n<p>In this example, the <strong>12</strong> in the path would be the id of the specific threesixtyviewer - but I cannot find any examples with that functionality. If the <strong>ThreesixtyViewer</strong> had an ID of 57, then the path would look like so:</p>\n<pre><code>/public/system/threesixty_viewer_images/57/large/filename.jpg\n</code></pre>\n<p><strong>threesixty_viewer.rb</strong></p>\n<pre><code>belongs_to :article\n\nhas_many :threesixty_viewer_images, dependent: :delete_all\naccepts_nested_attributes_for :threesixty_viewer_images, allow_destroy: true\n</code></pre>\n<p><strong>threesixty_viewer_image.rb</strong></p>\n<pre><code>belongs_to :threesixty_viewer\n\nhas_attached_file :image, styles: { small: &quot;500x500#&quot;, large: &quot;1440x800&gt;&quot; },\n  path: ':rails_root/public/system/:class/:VIEWER_ID/:size/:filename',\n  url: '/system/:class/:VIEWER_ID/:size/:filename'\nvalidates_attachment_content_type :image, content_type: /\\Aimage\\/.*\\Z/\n</code></pre>\n<p>I know the :path and :url attributes need to beupdated for the has_attached_file within the <strong>threesixty_viewer_image.rb</strong> - but I am unsure as to how I can get the id for the threesixty_viewer... for now I added a :VIEWER_ID in it's place.</p>\n<p>Any help would be greatly appreciated! Thanks in advance for anyone who can lend an eye!</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 152277, "user_id": 438992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/QouOz.jpg?s=128&g=1", "display_name": "Dave Newton", "link": "https://stackoverflow.com/users/438992/dave-newton"}, "edited": false, "score": 1, "creation_date": 1449603107, "post_id": 34164361, "comment_id": 56075714, "body": "Why do you have both <code>resources</code> and individual get/post/etc?"}, {"owner": {"reputation": 1698, "user_id": 4587148, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/VjBAv.jpg?s=128&g=1", "display_name": "Sajan", "link": "https://stackoverflow.com/users/4587148/sajan"}, "edited": false, "score": 0, "creation_date": 1449603452, "post_id": 34164361, "comment_id": 56075964, "body": "Remove the individual routes and keep the resource route only. and give your code for edit form."}, {"owner": {"reputation": 33, "user_id": 5655951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cd70aaf491ce45c67426720f09aa2c4?s=128&d=identicon&r=PG&f=1", "display_name": "A.J. Cee", "link": "https://stackoverflow.com/users/5655951/a-j-cee"}, "edited": false, "score": 0, "creation_date": 1449603599, "post_id": 34164361, "comment_id": 56076060, "body": "Thanks for responding. Guess that&#39;s not the way to go and I could just include the <code>get &#39;&#47;about&#39; =&gt; &#39;pages#index&#39;</code> in the routes.rb, since that&#39;s the only route not handled for me by <code>resources</code> or Devise? I understand that in the case of duplication the first instance of a route takes precedence.  If I rake routes in Terminal, the routes related to PATCH and PUT lack related prefixes. I&#39;m working under the impression that these verbs don&#39;t need their own views since they involve updating the database."}, {"owner": {"reputation": 2541, "user_id": 1162683, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8e05cd764cc2ecba1884b309e9dd5df5?s=128&d=identicon&r=PG", "display_name": "penner", "link": "https://stackoverflow.com/users/1162683/penner"}, "edited": false, "score": 0, "creation_date": 1449603836, "post_id": 34164361, "comment_id": 56076229, "body": "Can you post your _form.html.erb partial as well?"}, {"owner": {"reputation": 33, "user_id": 5655951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cd70aaf491ce45c67426720f09aa2c4?s=128&d=identicon&r=PG&f=1", "display_name": "A.J. Cee", "link": "https://stackoverflow.com/users/5655951/a-j-cee"}, "edited": false, "score": 0, "creation_date": 1449604234, "post_id": 34164361, "comment_id": 56076510, "body": "Posted the partial. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 2041, "user_id": 2071800, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e1f877eccccc9e714b4d4fe03917f2a7?s=128&d=identicon&r=PG", "display_name": "Joe Half Face", "link": "https://stackoverflow.com/users/2071800/joe-half-face"}, "is_accepted": false, "score": 0, "last_activity_date": 1449603616, "creation_date": 1449603616, "answer_id": 34164573, "question_id": 34164361, "link": "https://stackoverflow.com/questions/34164361/want-to-edit-put-patch-but-error-says-no-route-matches-post/34164573#34164573", "title": "Want to edit/PUT/PATCH but error says &quot;No route matches [POST]&quot;", "body": "<p><code>:method</code> in <code>link_to</code> helpers refers to HTML verb (get, post, etc), while controllers methods naming convention is action.</p>\n\n<p><a href=\"http://apidock.com/rails/ActionView/Helpers/UrlHelper/link_to\" rel=\"nofollow\">link_to</a></p>\n\n<p>You need something as</p>\n\n<pre><code>&lt;%= link_to 'Edit', @entry, :method =&gt; 'put' %&gt;\n</code></pre>\n\n<p>or</p>\n\n<pre><code>&lt;%= link_to 'Edit', @entry, :action =&gt; 'update' %&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1446, "user_id": 4005147, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100001011355894/picture?type=large", "display_name": "Padhu", "link": "https://stackoverflow.com/users/4005147/padhu"}, "is_accepted": false, "score": 0, "last_activity_date": 1449603729, "creation_date": 1449603729, "answer_id": 34164613, "question_id": 34164361, "link": "https://stackoverflow.com/questions/34164361/want-to-edit-put-patch-but-error-says-no-route-matches-post/34164613#34164613", "title": "Want to edit/PUT/PATCH but error says &quot;No route matches [POST]&quot;", "body": "<p>At a glance you are trying to post with the edit link. Remember new/edit are get methods to render form, so just just delete method part in your links. Like from</p>\n\n<pre><code>&lt;%= link_to 'Edit', @entry, :method =&gt; 'update' %&gt;\n</code></pre>\n\n<p>to </p>\n\n<pre><code>&lt;%= link_to 'Edit', edit_entry_path(@entry) %&gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12085, "user_id": 632688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6c6e4e8117bbd27fd25e9e2ea350458?s=128&d=identicon&r=PG", "display_name": "Wizard of Ogz", "link": "https://stackoverflow.com/users/632688/wizard-of-ogz"}, "edited": false, "score": 0, "creation_date": 1449604152, "post_id": 34164685, "comment_id": 56076453, "body": "Also, in your routes <code>resources :entries</code> should be sufficient. You can remove all the individual routes which start with &#39;/entries&#39;"}], "tags": [], "owner": {"reputation": 12085, "user_id": 632688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6c6e4e8117bbd27fd25e9e2ea350458?s=128&d=identicon&r=PG", "display_name": "Wizard of Ogz", "link": "https://stackoverflow.com/users/632688/wizard-of-ogz"}, "is_accepted": true, "score": 0, "last_activity_date": 1449603982, "creation_date": 1449603982, "answer_id": 34164685, "question_id": 34164361, "link": "https://stackoverflow.com/questions/34164361/want-to-edit-put-patch-but-error-says-no-route-matches-post/34164685#34164685", "title": "Want to edit/PUT/PATCH but error says &quot;No route matches [POST]&quot;", "body": "<p>To edit a record you </p>\n\n<ul>\n<li>first, should use a GET request to get the edit form</li>\n<li>second, should submit that form using a PUT/PATCH request </li>\n</ul>\n\n<p>To get to the edit form you should link to the edit path for your entry</p>\n\n<p><code>&lt;%= link_to 'Edit', edit_entry_path(@entry) %&gt;</code></p>\n\n<p>The Rails form helpers will automatically set the form to submit with the proper method, PUT OR PATCH.</p>\n"}, {"tags": [], "owner": {"reputation": 73119, "user_id": 1143732, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mFUOI.jpg?s=128&g=1", "display_name": "Richard Peck", "link": "https://stackoverflow.com/users/1143732/richard-peck"}, "is_accepted": false, "score": 0, "last_activity_date": 1449665469, "creation_date": 1449665469, "answer_id": 34179291, "question_id": 34164361, "link": "https://stackoverflow.com/questions/34164361/want-to-edit-put-patch-but-error-says-no-route-matches-post/34179291#34179291", "title": "Want to edit/PUT/PATCH but error says &quot;No route matches [POST]&quot;", "body": "<blockquote>\n  <p>I'm building my second-ever basic Ruby on Rails application </p>\n</blockquote>\n\n<p>Congrats! You need at least 3 more before it all starts to make sense</p>\n\n<hr>\n\n<p>To add to the existing answers, you'll be best looking at the <a href=\"http://guides.rubyonrails.org/routing.html#resource-routing-the-rails-default\" rel=\"nofollow\"><code>resources</code> directive</a> to clean the routes up:</p>\n\n<pre><code>#config/routes.rb\nroot 'entries#index'\ndevise_for :users\n\nresources  :entries\nresources  :pages,  only: [:index], path_names: { index: \"about\" }\nresources  :users,  only: [:index,:show]\n</code></pre>\n\n<p>--</p>\n\n<blockquote>\n  <p>A logged-in user should be able to edit <strong>only those entries that were originally created by that user</strong>.</p>\n</blockquote>\n\n<p>This is known as <em>authorization</em>.</p>\n\n<ul>\n<li><strong>Authentication</strong> = is user logged in?</li>\n<li><strong>Authorization</strong> = can user do this?</li>\n</ul>\n\n<p>Although people confuse Devise with being able to handle authorization, it only handles authentication. Whilst you have a simple implementation of this in your controller, you should check out either the <a href=\"https://github.com/CanCanCommunity/cancancan\" rel=\"nofollow\"><code>CanCanCan</code></a> or <a href=\"https://github.com/elabs/pundit\" rel=\"nofollow\"><code>Pundit</code></a> gems:</p>\n\n<pre><code>#Gemfile\ngem \"cancancan\"\n\n#app/models/ability.rb\nclass Ability\n  include CanCan::Ability\n  def initialize(user)\n    user ||= User.new # guest user (not logged in)\n    can :manage, Post, user_id: user.id\n  end\nend\n\n#app/controllers/entries_controller.rb\nclass EntriesController &lt; ApplicationController\n   def edit\n      authorize! :edit, @entry\n   end\nend\n</code></pre>\n\n<p>--</p>\n\n<p>Finally, to answer your question directly, you're calling the <code>update</code> method (which doesn't exist) to access the <em>edit</em> view:</p>\n\n<pre><code>&lt;% if current_user %&gt;\n   &lt;%= link_to 'Edit', @entry, :method =&gt; 'update' %&gt;\n   &lt;%= link_to 'Delete', @entry, :method =&gt; 'delete' %&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>You should read up about <a href=\"https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol#Request_methods\" rel=\"nofollow\">http verbs</a> - this is what the \"method\" option invokes with the <code>link</code>. As mentioned above, you don't need to set the method for <code>edit</code> as it uses <code>GET</code>. <code>Update</code> uses <code>put/patch</code>, which I can explain later.</p>\n\n<p>A much better way to achieve what you want would be the following:</p>\n\n<pre><code>&lt;%= link_to \"Edit\", edit_entry_path(@entry) if can? :edit, @entry %&gt;\n&lt;%= link_to \"Delete\", @entry, method: :delete, if can? :destroy, @entry %&gt;\n</code></pre>\n\n<p>The above uses the <code>CanCanCan</code> authorization method <a href=\"https://github.com/CanCanCommunity/cancancan#2-check-abilities--authorization\" rel=\"nofollow\"><code>can?</code></a></p>\n"}], "owner": {"reputation": 33, "user_id": 5655951, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4cd70aaf491ce45c67426720f09aa2c4?s=128&d=identicon&r=PG&f=1", "display_name": "A.J. Cee", "link": "https://stackoverflow.com/users/5655951/a-j-cee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 464, "favorite_count": 0, "accepted_answer_id": 34164685, "answer_count": 4, "score": 1, "last_activity_date": 1449665469, "creation_date": 1449602874, "last_edit_date": 1449604187, "question_id": 34164361, "link": "https://stackoverflow.com/questions/34164361/want-to-edit-put-patch-but-error-says-no-route-matches-post", "title": "Want to edit/PUT/PATCH but error says &quot;No route matches [POST]&quot;", "body": "<p>I'm building my second-ever basic Ruby on Rails application and having fun doing it, but have gotten stuck at precisely the same place that gave me trouble (and was never solved) on my last effort: the PUT or PATCH request.</p>\n\n<p>My application has two models: entries and users. A logged-in user should be able to edit only those entries that were originally created by that user. </p>\n\n<p>CONTROLLER</p>\n\n<pre><code>class EntriesController &lt; ApplicationController\n# authenticate user (Devise)\nbefore_action :authenticate_user!, :except =&gt; [:index, :show]\n# set entry upon page load\nbefore_action :set_entry, :only =&gt; [:show, :edit, :update, :destroy]\n\n# GET request - display all entries\ndef index\n    @all_entries = Entry.all\nend\n\n# GET request - display an individual entry\ndef show\n    # nothing required here because entry identified with before_action :set_entry on line 2 above\nend\n\n# GET request - access form to create a new entry\ndef new\n    @entry = Entry.new\n    @user = User.find(current_user[:id])\nend\n\n# GET request - access form to update an existing entry\ndef edit\n    if @entry[:user_id] != current_user[:id]\n        redirect_to root_path\n    else \n        redirect_to edit_entry_path\n    end\nend\n\n# POST request - make a new entry/save new data into db\ndef create\n    user = current_user[:id]\n    Entry.create({\n        entry_title: params[:entry][:entry_title], \n        book_title: params[:entry][:book_title],\n        text: params[:entry][:text], \n        img_url: params[:entry][:img_url], \n        tag: params[:entry][:tag], \n        created_at: params[:entry][:created_at], \n        user_id: user \n    })\n    redirect_to entries_path\nend\n\n# PUT request - save changes to an existing entry\ndef update\n    if @entry.update(entry_params)\n        redirect_to entry_path\n    else \n        render :new\n    end\nend\n\n# DELETE request - delete an existing entry from db\ndef destroy\n    @entry.destroy\n    redirect_to entries_path\nend\n\nprivate\n\ndef set_entry\n    @entry = Entry.find(params[:id])\nend\n\ndef entry_params\n    params.require(:entry).permit(:email, :text, :tag)\nend\n\nend\n</code></pre>\n\n<p>VIEW (show.html.erb - shows a single entry and includes links allowing the logged-in user who originally authored the entry to edit or delete it)</p>\n\n<pre><code>&lt;h3&gt;Selected Entry&lt;/h3&gt;\n    &lt;div class=\"row\"&gt;\n        &lt;div class=\"col-md-2\"&gt;&lt;/div&gt;\n        &lt;div class=\"col-md-6\"&gt;\n            &lt;div&gt;Entry title: &lt;%= @entry.entry_title %&gt;&lt;/div&gt;\n            &lt;div&gt;Book title: &lt;%= @entry.book_title %&gt;&lt;/div&gt;\n            &lt;div&gt;Text: &lt;%= @entry.text %&gt;&lt;/div&gt;\n        &lt;/div&gt;\n        &lt;div class=\"col-md-4\"&gt;\n            &lt;div&gt;&lt;%= @entry.created_at.strftime(\"%b %d, %Y\") %&gt;&lt;/div&gt;\n            &lt;div&gt;Submitted by: &lt;i&gt;&lt;%= @entry.user.email %&gt;&lt;/i&gt;&lt;/div&gt;\n            &lt;div&gt;File under: &lt;i&gt;&lt;%= @entry.tag %&gt;&lt;/i&gt;&lt;/div&gt;\n\n            &lt;% if current_user %&gt;\n                &lt;%= link_to 'Edit', @entry, :method =&gt; 'update' %&gt;\n                &lt;%= link_to 'Delete', @entry, :method =&gt; 'delete' %&gt;\n            &lt;% end %&gt;\n        &lt;/div&gt;\n    &lt;/div&gt;\n</code></pre>\n\n<p>ROUTES.RB - At first my routes were the commented-out lines, but then I had a thought that was either madness or sudden realization - should only the GET routes lead with \"get\"? So that's the non-commented-out attempt you see. Somehow the app works (except for the issue at hand) both ways. </p>\n\n<p>In researching I've come across routes defined using a much more elaborate syntax than that I'm using here. I've been unable to figure out whether a given way of doing things is different convention, outdated, or just inadequate to the task.</p>\n\n<pre><code>Rails.application.routes.draw do\n  devise_for :users\n  resources :entries\n\n  # root 'entries#index'\n\n  # get '/entries' =&gt; 'entries#index'\n\n  # get '/users' =&gt; 'users#index'\n\n  # get '/entries/:id' =&gt; 'entries#show'\n\n  # get '/entries/:id' =&gt; 'entries#update'\n\n  # get '/entries/new' =&gt; 'entries#new'\n\n  # get '/entries/:id/edit' =&gt; 'entries#edit'\n\n  # get '/users/:id' =&gt; 'users#show'\n\n  # get '/about' =&gt; 'pages#index'\n\n  root 'entries#index'\n\n  get '/entries' =&gt; 'entries#index'\n\n  get '/entries/new' =&gt; 'entries#new'\n\n  post '/entries' =&gt; 'entries#create'\n\n  get '/entries/:id' =&gt; 'entries#show'\n\n  get '/entries/:id/edit' =&gt; 'entries#edit'\n\n  put '/entries/:id' =&gt; 'entries#update'\n\n  delete '/entries/:id' =&gt; 'entries#destroy'\n\n  get '/users' =&gt; 'users#index'\n\n  get '/users/:id' =&gt; 'users#show'\n\n  get '/about' =&gt; 'pages#index'\n\nend\n</code></pre>\n\n<p>Thanks in advance for any insight. If additional context is needed I'm happy to provide.</p>\n\n<p>Edited to add:\nPARTIAL (_form.html.erb)</p>\n\n<pre><code>&lt;div class=\"row\"&gt;\n    &lt;div class=\"col-md-2\"&gt;&lt;/div&gt;\n    &lt;div class=\"col-md-6\" id=\"form-container\"&gt;\n        &lt;%= form_for @entry do |form| %&gt;\n            &lt;br&gt;\n            &lt;%= form.text_field :entry_title, :size =&gt; 59, :placeholder =&gt; \"Entry Title\"%&gt;\n            &lt;br&gt;&lt;br&gt;\n            &lt;%= form.text_field :book_title, :size =&gt; 59, :placeholder =&gt; \"Book Title\"%&gt;\n            &lt;br&gt;&lt;br&gt;\n            &lt;%= form.text_field :img_url, :size =&gt; 59, :placeholder =&gt; \"Image URL\"%&gt;\n            &lt;br&gt;&lt;br&gt;\n            &lt;%= form.text_area :text, :placeholder =&gt; \"Text\" %&gt;\n            &lt;br&gt;&lt;br&gt;\n            &lt;%= form.text_field :tag, :placeholder =&gt; \"Tag\" %&gt;\n            &lt;br&gt;&lt;br&gt;\n            &lt;%= form.submit %&gt;\n        &lt;% end %&gt;\n    &lt;/div&gt;\n    &lt;div class=\"col-md-4\"&gt;&lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "date"], "comments": [{"owner": {"reputation": 12085, "user_id": 632688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6c6e4e8117bbd27fd25e9e2ea350458?s=128&d=identicon&r=PG", "display_name": "Wizard of Ogz", "link": "https://stackoverflow.com/users/632688/wizard-of-ogz"}, "edited": false, "score": 0, "creation_date": 1449602976, "post_id": 34164296, "comment_id": 56075625, "body": "Request parameters are serialized as strings. You need to convert <code>params[:start_date]</code> to a <code>Date</code> object before you can use <code>strftime</code>. @simonecarletti beat me to the answer"}], "answers": [{"comments": [{"owner": {"reputation": 12085, "user_id": 632688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6c6e4e8117bbd27fd25e9e2ea350458?s=128&d=identicon&r=PG", "display_name": "Wizard of Ogz", "link": "https://stackoverflow.com/users/632688/wizard-of-ogz"}, "edited": false, "score": 0, "creation_date": 1449603107, "post_id": 34164368, "comment_id": 56075713, "body": "Or you could use <code>Date#parse</code> instead of <code>Time#parse</code> since the param in the example only has date values."}, {"owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "reply_to_user": {"reputation": 41, "user_id": 4858541, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-DdrD7f1CGjk/AAAAAAAAAAI/AAAAAAAAAPM/fcVaDasZicA/photo.jpg?sz=128", "display_name": "Bradley Farquhar", "link": "https://stackoverflow.com/users/4858541/bradley-farquhar"}, "edited": false, "score": 0, "creation_date": 1449913209, "post_id": 34164368, "comment_id": 56219267, "body": "@BradleyFarquhar please accept the answer if it solves your problem"}], "tags": [], "owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "is_accepted": false, "score": 2, "last_activity_date": 1449602889, "creation_date": 1449602889, "answer_id": 34164368, "question_id": 34164296, "link": "https://stackoverflow.com/questions/34164296/changing-a-string-with-a-date-into-a-format-to-get-the-day-of-the-week/34164368#34164368", "title": "Changing a string with a date into a format to get the day of the week", "body": "<p>You first need to convert the <code>String</code> into a <code>Time</code> object.</p>\n\n<pre><code>require 'time'\n\nt = Time.parse(\"Dec 22, 2015\")\n</code></pre>\n\n<p>and then format it</p>\n\n<pre><code>t.strftime(\"%A\")\n =&gt; \"Tuesday\"\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 4858541, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh5.googleusercontent.com/-DdrD7f1CGjk/AAAAAAAAAAI/AAAAAAAAAPM/fcVaDasZicA/photo.jpg?sz=128", "display_name": "Bradley Farquhar", "link": "https://stackoverflow.com/users/4858541/bradley-farquhar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1449607723, "creation_date": 1449602666, "last_edit_date": 1449607723, "question_id": 34164296, "link": "https://stackoverflow.com/questions/34164296/changing-a-string-with-a-date-into-a-format-to-get-the-day-of-the-week", "title": "Changing a string with a date into a format to get the day of the week", "body": "<p>I have an input field that gives me a date in this format \"Dec 22, 2015\" and I need to get the day for the week out of it. I have tried taking the params and using the <code>strftime(\"%A\")</code> however I keep getting nil back.</p>\n\n<p>This is the syntax I used:</p>\n\n<pre><code>a = params[:start_date] \na.strftime(\"%A\")\n</code></pre>\n\n<p>I have seen from other posts I can do:</p>\n\n<pre><code>t=Time.new\nt.strftime(\"%A\")\n</code></pre>\n\n<p>and that works for <code>Time.now</code>. I am not sure why it wouldn't work for my params. </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"comments": [{"owner": {"reputation": 185, "user_id": 5084871, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/26724d54785ca73d7a3d5b29ff16bbe3?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Roberts", "link": "https://stackoverflow.com/users/5084871/sam-roberts"}, "edited": false, "score": 0, "creation_date": 1449602839, "post_id": 34164315, "comment_id": 56075535, "body": "It now says that undefined method `strftime&#39; for nil:NilClass"}, {"owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "reply_to_user": {"reputation": 185, "user_id": 5084871, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/26724d54785ca73d7a3d5b29ff16bbe3?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Roberts", "link": "https://stackoverflow.com/users/5084871/sam-roberts"}, "edited": false, "score": 0, "creation_date": 1449602919, "post_id": 34164315, "comment_id": 56075589, "body": "It means <code>eventdate</code> is <code>nil</code> for that specific object. Make sure the value exists in the database."}], "tags": [], "owner": {"reputation": 163714, "user_id": 123527, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/99e0b39c091e10d9c7d4452a34ca52dc?s=128&d=identicon&r=PG", "display_name": "Simone Carletti", "link": "https://stackoverflow.com/users/123527/simone-carletti"}, "is_accepted": true, "score": 0, "last_activity_date": 1449602727, "creation_date": 1449602727, "answer_id": 34164315, "question_id": 34164253, "link": "https://stackoverflow.com/questions/34164253/date-format-in-rails/34164315#34164315", "title": "Date format in rails", "body": "<p><a href=\"http://ruby-doc.org/core-2.2.0/Time.html#method-i-strftime\" rel=\"nofollow\">According to the docs</a>, it should be <code>%b</code>. You also have another issue in your code: you are calling the method on an invalid object. The iterator element is <code>event</code>, not <code>events</code>.</p>\n\n<pre><code>&lt;span class=\"event-date--month\"&gt;&lt;%= event.eventdate.strftime(\"%b\") %&gt;&lt;/span&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18224, "user_id": 406987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8865b16d4f3493cfae865af2b3247fd3?s=128&d=identicon&r=PG", "display_name": "Doon", "link": "https://stackoverflow.com/users/406987/doon"}, "is_accepted": false, "score": 0, "last_activity_date": 1449603067, "last_edit_date": 1449603067, "creation_date": 1449602729, "answer_id": 34164316, "question_id": 34164253, "link": "https://stackoverflow.com/questions/34164253/date-format-in-rails/34164316#34164316", "title": "Date format in rails", "body": "<pre><code>&lt;%= event.eventdate.strftime(\"%b\") %&gt;\n</code></pre>\n\n<p>Lowercase b, shows abbreviated month. </p>\n"}], "owner": {"reputation": 185, "user_id": 5084871, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/26724d54785ca73d7a3d5b29ff16bbe3?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Roberts", "link": "https://stackoverflow.com/users/5084871/sam-roberts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 34164315, "answer_count": 2, "score": 0, "last_activity_date": 1449603067, "creation_date": 1449602540, "last_edit_date": 1449602769, "question_id": 34164253, "link": "https://stackoverflow.com/questions/34164253/date-format-in-rails", "title": "Date format in rails", "body": "<p>I'm trying to get the month from a date, The date in the database is saved as</p>\n\n<pre><code>2015-12-08\n</code></pre>\n\n<p>However its displaying as <code>2015 December 08</code>, I'm wanting to have it so that it shows only Dec and only Dec.</p>\n\n<p>Heres the code that i have so far.</p>\n\n<pre><code>&lt;% @events.each do |event| %&gt;\n\n&lt;ul class=\"event-list\" itemscope itemtype=\"http://schema.org/Event\"&gt;\n  &lt;li class=\"event-date\"&gt;\n  &lt;span class=\"event-date--month\"&gt;&lt;%= events.eventdate.strftime(\"%B\") %&gt;&lt;/span&gt;\n  &lt;span class=\"event-date--day\"&gt;27&lt;/span&gt;\n  &lt;span class=\"event-date--year\"&gt;2015&lt;/span&gt;\n</code></pre>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5601051, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9be9b37291012d923079be0a60d0c35f?s=128&d=identicon&r=PG&f=1", "display_name": "Ken Saluda", "link": "https://stackoverflow.com/users/5601051/ken-saluda"}, "edited": false, "score": 0, "creation_date": 1449602046, "post_id": 34164009, "comment_id": 56075049, "body": "Thanks a lot! And thanks for your link."}], "tags": [], "owner": {"reputation": 14254, "user_id": 1663383, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/3aaf8438a71124d393af5af486a7e78b?s=128&d=identicon&r=PG", "display_name": "Draco18s no longer trusts SE", "link": "https://stackoverflow.com/users/1663383/draco18s-no-longer-trusts-se"}, "is_accepted": false, "score": 2, "last_activity_date": 1449602344, "last_edit_date": 1449602344, "creation_date": 1449601683, "answer_id": 34164009, "question_id": 34163965, "link": "https://stackoverflow.com/questions/34163965/what-does-exactly-mean/34164009#34164009", "title": "What does || exactly Mean?", "body": "<p>Logical \"or\"</p>\n\n<p><code>A || B</code> is <code>true</code> when either <code>A</code> is true <em>or</em> <code>B</code> is true, or when both <code>A</code> <em>and</em> <code>B</code> are true.</p>\n\n<p><a href=\"http://www.tutorialspoint.com/ruby/ruby_operators.htm\" rel=\"nofollow\">http://www.tutorialspoint.com/ruby/ruby_operators.htm</a></p>\n"}, {"comments": [{"owner": {"reputation": 31, "user_id": 5601051, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9be9b37291012d923079be0a60d0c35f?s=128&d=identicon&r=PG&f=1", "display_name": "Ken Saluda", "link": "https://stackoverflow.com/users/5601051/ken-saluda"}, "edited": false, "score": 0, "creation_date": 1449602651, "post_id": 34164187, "comment_id": 56075416, "body": "Thanks a lot. What a thorough answer for my question. I would go through the materials you provide."}], "tags": [], "owner": {"reputation": 5795, "user_id": 1169705, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/ZWEMS.png?s=128&g=1", "display_name": "digitalextremist", "link": "https://stackoverflow.com/users/1169705/digitalextremist"}, "is_accepted": true, "score": 0, "last_activity_date": 1449602337, "creation_date": 1449602337, "answer_id": 34164187, "question_id": 34163965, "link": "https://stackoverflow.com/questions/34163965/what-does-exactly-mean/34164187#34164187", "title": "What does || exactly Mean?", "body": "<p>The <code>||</code> operator is similar to the keyword <code>or</code> but is different from the keyword <code>or</code> in extremely important ways. Below are two great write-ups on the topic, comparing the two and showing you how to use either one:</p>\n\n<ul>\n<li><a href=\"http://devblog.avdi.org/2010/08/02/using-and-and-or-in-ruby/\" rel=\"nofollow\">http://devblog.avdi.org/2010/08/02/using-and-and-or-in-ruby/</a></li>\n<li>New version, with video: <a href=\"http://devblog.avdi.org/2014/08/26/how-to-use-rubys-english-andor-operators-without-going-nuts/\" rel=\"nofollow\">http://devblog.avdi.org/2014/08/26/how-to-use-rubys-english-andor-operators-without-going-nuts/</a></li>\n</ul>\n\n<hr>\n\n<p>The most important thing to note in what Avdi says, is that <code>||</code> cannot be used for flow control, whereas <code>or</code> can be.</p>\n\n<p>For example...</p>\n\n<pre><code>a = :value\nc = b || a\n#de Since `b` is undefined/null, `c` will be set to `:value`\n\nc = b || puts(\"Failure!\") #de This will raise an exception!\n\nc = b or puts(\"Failure!\") #de Will set `c` to `NilClass` and output \"Failure!\"\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5601051, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9be9b37291012d923079be0a60d0c35f?s=128&d=identicon&r=PG&f=1", "display_name": "Ken Saluda", "link": "https://stackoverflow.com/users/5601051/ken-saluda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "closed_date": 1449602602, "accepted_answer_id": 34164187, "answer_count": 2, "score": -7, "last_activity_date": 1449602576, "creation_date": 1449601549, "last_edit_date": 1449602576, "question_id": 34163965, "link": "https://stackoverflow.com/questions/34163965/what-does-exactly-mean", "closed_reason": "Duplicate", "title": "What does || exactly Mean?", "body": "<p>Recently I saw code like</p>\n\n<pre><code>i &lt; 0 ||\n</code></pre>\n\n<p>I wonder what is \"||\" exactly mean? How to say that in english?</p>\n"}, {"tags": ["arrays", "ruby"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 3, "creation_date": 1449601521, "post_id": 34163851, "comment_id": 56074720, "body": "What have you tried so far? Your question look like <i>write-code-for-me-im-too-lazy-to-try</i>."}, {"owner": {"reputation": 1125, "user_id": 5398558, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-y55QNRIiBcA/AAAAAAAAAAI/AAAAAAAAABI/HLtIr-k2f7w/photo.jpg?sz=128", "display_name": "Nadiya", "link": "https://stackoverflow.com/users/5398558/nadiya"}, "reply_to_user": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 2, "creation_date": 1449601654, "post_id": 34163851, "comment_id": 56074797, "body": "As I said, I&#39;m new to Ruby, I need a hint, because I don&#39;t know where to start :("}, {"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 2, "creation_date": 1449601745, "post_id": 34163851, "comment_id": 56074865, "body": "Try something it&#39;s very easy. Just use google <a href=\"https://www.google.ru/webhp?sourceid=chrome-instant&amp;ion=1&amp;espv=2&amp;ie=UTF-8#q=ruby%20hash%20sum%20elements\" rel=\"nofollow noreferrer\">google.ru/&hellip;</a>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1449602777, "post_id": 34163851, "comment_id": 56075492, "body": "I see nothing wrong with the question (before the edit). It&#39;s clear and complete with a non-obvious solution, which is more than I can say for many of the questions posted on SO. +1 [The only suggestion for improvement I can make is to set a variable equal to the array (e.g, <code>arr = [{:report_data=&gt;...]</code>), so that readers can refer to the variable in answers and comments without defining it.)  Those who downvoted should give their reasons for doing so. I hope it&#39;s not because the OP has not shown code. He/she has explained why that has not been provided."}], "answers": [{"tags": [], "owner": {"reputation": 261375, "user_id": 174728, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eRO75.jpg?s=128&g=1", "display_name": "John La Rooy", "link": "https://stackoverflow.com/users/174728/john-la-rooy"}, "is_accepted": false, "score": 1, "last_activity_date": 1449607481, "creation_date": 1449607481, "answer_id": 34165685, "question_id": 34163851, "link": "https://stackoverflow.com/questions/34163851/sum-an-array-of-hashes-in-ruby/34165685#34165685", "title": "Sum an array of hashes in Ruby", "body": "<pre><code>arr = [{:report_data=&gt;\n  [{:type=&gt;\n      {\"id\"=&gt;1, \"name\"=&gt;\"electricity\"},\n    :data=&gt;[10, 20, 30, 40]},\n    {:type=&gt;\n      {\"id\"=&gt;2, \"name\"=&gt;\"water\"},\n    :data=&gt;[20, 30, 40, 50]}],\n  :monthes_data=&gt;\n    {:monthes=&gt;\n      [\"jan\", \"feb\"]}},\n\n {:report_data=&gt;\n  [{:type=&gt;\n      {\"id\"=&gt;1, \"name\"=&gt;\"electricity\"},\n    :data=&gt;[15, 25, 35, 45]},\n    {:type=&gt;\n      {\"id\"=&gt;2, \"name\"=&gt;\"water\"},\n    :data=&gt;[25, 35, 45, 55]}],\n  :monthes_data=&gt;\n    {:monthes=&gt;\n      [\"jan\", \"feb\"]}},\n\n {:report_data=&gt;\n  [{:type=&gt;\n      {\"id\"=&gt;1, \"name\"=&gt;\"electricity\"},\n    :data=&gt;[17, 27, 37, 47]},\n    {:type=&gt;\n      {\"id\"=&gt;2, \"name\"=&gt;\"water\"},\n    :data=&gt;[27, 37, 47, 57]}],\n  :monthes_data=&gt;\n    {:monthes=&gt;\n      [\"jan\", \"feb\"]}}]\n\n\nacc = {}\narr.each do\n    |e| e[:report_data].each_with_index do\n        |e, idx| \n        type = e[:type]['id']\n        e[:data].each_with_index do \n            |e, idx|\n            acc[type] = [] if not acc[type]\n            acc[type][idx] = (acc[type][idx] or 0) + e  \n        end\n    end\nend\np acc\n</code></pre>\n\n<p>outputs</p>\n\n<pre><code>{1=&gt;[42, 72, 102, 132], 2=&gt;[72, 102, 132, 162]}\n</code></pre>\n\n<p>You should be able to reformat this into your record</p>\n"}, {"tags": [], "owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "is_accepted": false, "score": 0, "last_activity_date": 1449614085, "creation_date": 1449614085, "answer_id": 34167388, "question_id": 34163851, "link": "https://stackoverflow.com/questions/34163851/sum-an-array-of-hashes-in-ruby/34167388#34167388", "title": "Sum an array of hashes in Ruby", "body": "<p>For clarity I've reformatted the input array and removed the <code>:monthes_data</code> key, since that seems to be unrelated to your question. Here's our data:</p>\n\n<h2>TL;DR</h2>\n\n\n\n<pre class=\"lang-ruby prettyprint-override\"><code>def zip_sum(arr1, arr2)\n  return arr2 if arr1.nil?\n  arr1.zip(arr2).map {|a, b| a + b }\nend\n\ndef sum_report_data(arr)\n  arr.flat_map do |item|\n    item[:report_data].map {|datum| datum.values_at(:type, :data) }\n  end\n  .reduce({}) do |sums, (type, data)|\n    sums.merge(type =&gt; data) do |_, old_data, new_data|\n      zip_sum(old_data, new_data)\n    end\n  end\n  .map {|type, data| { type: type, data: data } }\nend\n</code></pre>\n\n\n\n<pre class=\"lang-ruby prettyprint-override\"><code>p sum_report_data(arr)\n# =&gt;\n[ { type: { \"id\" =&gt; 1, \"name\" =&gt; \"electricity\" }, data: [ 42, 72, 102, 132 ] },\n  { type: { \"id\" =&gt; 2, \"name\" =&gt; \"water\" }, data: [ 72, 102, 132, 162 ] }\n]\n</code></pre>\n\n<h2>Explanation</h2>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>arr = [\n  { report_data: [\n      { type: { \"id\" =&gt; 1, \"name\" =&gt; \"electricity\" },\n        data: [ 10, 20, 30, 40 ]\n      },\n      { type: { \"id\" =&gt; 2, \"name\" =&gt; \"water\" },\n        data: [ 20, 30, 40, 50 ]\n      }\n    ]\n  },\n\n  { report_data: [\n      { type: { \"id\" =&gt; 1, \"name\" =&gt; \"electricity\" },\n        data: [ 15, 25, 35, 45 ]\n      },\n      { type: { \"id\" =&gt; 2, \"name\" =&gt; \"water\" },\n        data: [ 25, 35, 45, 55 ]\n      }\n    ]\n  },\n\n  { report_data: [\n      { type: { \"id\" =&gt; 1, \"name\" =&gt; \"electricity\" },\n        data: [ 17, 27, 37, 47 ]\n      },\n      { type: { \"id\" =&gt; 2, \"name\" =&gt; \"water\" },\n        data: [ 27, 37, 47, 57 ]\n      }\n    ]\n  }\n]\n</code></pre>\n\n<h3>Step 1</h3>\n\n<p>First, let's define a helper method to sum the values of two arrays:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>def zip_sum(arr1, arr2)\n  return arr2 if arr1.nil?\n  arr1.zip(arr2).map {|a, b| a + b }\nend\n\nzip_sum([ 1, 2, 3 ], [ 10, 20, 30 ])\n# =&gt; [ 11, 22, 33 ]\n\nzip_sum(nil, [ 5, 6, 7 ])\n# =&gt; [ 5, 6, 7 ]\n</code></pre>\n\n<p>The way <code>zip_sum</code> works is by \"zipping\" the two arrays together using <a href=\"http://ruby-doc.org/core-2.2.3/Enumerable.html#method-i-zip\" rel=\"nofollow\"><code>Enumerable#zip</code></a> (e.g. <code>[1, 2].zip([10, 20])</code> returns <code>[ [1, 10], [2, 20] ]</code>), then adding each pair together.</p>\n\n<h3>Step 2</h3>\n\n<p>Next, let's use <a href=\"http://ruby-doc.org/core-2.2.3/Enumerable.html#method-i-flat_map\" rel=\"nofollow\"><code>Enumerable#flat_map</code></a> to get the parts of the data we care about:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>result1 = arr.flat_map do |item|\n  item[:report_data].map {|datum| datum.values_at(:type, :data) }\nend\n</code></pre>\n\n\n\n<pre class=\"lang-ruby prettyprint-override\"><code># result1 =&gt;\n[ [ { \"id\" =&gt; 1, \"name\" =&gt; \"electricity\" }, [ 10, 20, 30, 40 ] ],\n  [ { \"id\" =&gt; 2, \"name\" =&gt; \"water\" },       [ 20, 30, 40, 50 ] ],\n  [ { \"id\" =&gt; 1, \"name\" =&gt; \"electricity\" }, [ 15, 25, 35, 45 ] ],\n  [ { \"id\" =&gt; 2, \"name\" =&gt; \"water\" },       [ 25, 35, 45, 55 ] ],\n  [ { \"id\" =&gt; 1, \"name\" =&gt; \"electricity\" }, [ 17, 27, 37, 47 ] ],\n  [ { \"id\" =&gt; 2, \"name\" =&gt; \"water\" },       [ 27, 37, 47, 57 ] ]\n]\n</code></pre>\n\n<p>Above we've just grabbed the <code>:type</code> and <code>:data</code> values out of each hash the <code>:report_data</code> arrays.</p>\n\n<h3>Step 3</h3>\n\n<p>Next let's use <a href=\"http://ruby-doc.org/core-2.2.3/Enumerable.html#method-i-reduce\" rel=\"nofollow\"><code>Enumerable#reduce</code></a> to iterate over the array of arrays and calculate a running sum of the <code>:data</code> values using the <code>zip_sum</code> method we defined earlier:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>result2 = result1.reduce({}) do |sums, (type, data)|\n  sums.merge(type =&gt; data) do |_, old_data, new_data|\n    zip_sum(old_data, new_data)\n  end\nend\n</code></pre>\n\n\n\n<pre class=\"lang-ruby prettyprint-override\"><code># result2 =&gt;\n{ { \"id\" =&gt; 1, \"name\" =&gt; \"electricity\" } =&gt; [ 42,  72, 102, 132 ],\n  { \"id\" =&gt; 2, \"name\" =&gt; \"water\" }       =&gt; [ 72, 102, 132, 162 ]\n}\n</code></pre>\n\n<p>The result might look a little odd to you because we usually use strings or symbols as hash keys, but in this hash we're using other hashes (the <code>:type</code> values from above) as keys. That's one nice thing about Ruby: You can use any object as a key in a hash.</p>\n\n<p>Inside the <code>reduce</code> block, <code>sums</code> is the hash that's ultimately returned. It starts out as an empty hash (<code>{}</code>, the value we passed to <code>reduce</code> as an argument). <code>type</code> is the hash we're using as a key and <code>data</code> is the array of integers. In each iteration the next values from the <code>result2</code> array are assigned to <code>type</code>, but <code>sums</code> is updated with whatever value was returned at the end of the block in the previous iteration.</p>\n\n<p>We're using <a href=\"http://ruby-doc.org/core-2.2.3/Hash.html#method-i-merge\" rel=\"nofollow\"><code>Hash#merge</code></a> in kind of a tricky way:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>sums.merge(type =&gt; data) do |_, old_data, new_data|\n  zip_sum(old_data, new_data)\nend\n</code></pre>\n\n<p>This merges the hash <code>{ type =&gt; data }</code> (remember that <code>type</code> is the <code>:type</code> hash\n and <code>data</code> is the array of integers) into the hash <code>sums</code>. If there are any key collisions, the block will be invoked. Since we only have one key, <code>type</code>, then the block will be invoked if <code>sums[type]</code> already exists. If it does, we call <code>zip_sum</code> with the previous value of <code>sums[type]</code> and <code>data</code>, effectively keeping a running sum of <code>data</code>.</p>\n\n<p>In effect, it's basically doing this:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>sums = {}\n\ntype, data = result2[0]\nsums[type] = zip_sum(sums[type], data)\n\ntype, data = result2[1]\nsums[type] = zip_sum(sums[type], data)\n\ntype, data = result2[3]\n# ...and so on.\n</code></pre>\n\n<h3>Step 4</h3>\n\n<p>We now have this hash in <code>result3</code>:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>{ { \"id\" =&gt; 1, \"name\" =&gt; \"electricity\" } =&gt; [ 42,  72, 102, 132 ],\n  { \"id\" =&gt; 2, \"name\" =&gt; \"water\" }       =&gt; [ 72, 102, 132, 162 ]\n}\n</code></pre>\n\n<p>That's the data we want, so now we just have to take it out of this weird format and put it into a regular hash with the keys <code>:type</code> and <code>:data</code>:</p>\n\n<pre class=\"lang-ruby prettyprint-override\"><code>result3 = result2.map {|type, data| { type: type, data: data } }\n</code></pre>\n\n\n\n<pre class=\"lang-ruby prettyprint-override\"><code># result3 =&gt;\n[ { type: { \"id\" =&gt; 1, \"name\" =&gt; \"electricity\" },\n    data: [ 42, 72, 102, 132 ]\n  },\n  { type: { \"id\" =&gt; 2, \"name\" =&gt; \"water\" },\n    data: [ 72, 102, 132, 162 ]\n  }\n]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": true, "score": 0, "last_activity_date": 1449679764, "last_edit_date": 1449679764, "creation_date": 1449616485, "answer_id": 34167910, "question_id": 34163851, "link": "https://stackoverflow.com/questions/34163851/sum-an-array-of-hashes-in-ruby/34167910#34167910", "title": "Sum an array of hashes in Ruby", "body": "<p><strong>Code</strong></p>\n\n<pre><code>def convert(arr)\n  { :months_data=&gt;arr.first[:months_data],\n    :report_data=&gt;arr.map { |h| h[:report_data] }.\n      transpose.\n      map { |d| { :type=&gt;d.first[:type] }.\n        merge(:data=&gt;d.map { |g| g[:data] }.transpose.map { |a| a.reduce(:+) }) }\n  }\nend\n</code></pre>\n\n<p><strong>Example</strong></p>\n\n<p>Half the battle in problems such as this one is visualizing the data. It's much clearer, imo, when written like this:</p>\n\n<pre><code>arr = [\n  {:report_data=&gt;[\n     {:type=&gt;{\"id\"=&gt;1, \"name\"=&gt;\"electricity\"}, :data=&gt;[10, 20, 30, 40]},\n     {:type=&gt;{\"id\"=&gt;2, \"name\"=&gt;\"water\"},       :data=&gt;[20, 30, 40, 50]}\n     ],\n   :months_data=&gt;{:months=&gt;[\"jan\", \"feb\"]}\n  },    \n  {:report_data=&gt;[\n     {:type=&gt;{\"id\"=&gt;1, \"name\"=&gt;\"electricity\"}, :data=&gt;[15, 25, 35, 45]},\n     {:type=&gt;{\"id\"=&gt;2, \"name\"=&gt;\"water\"},       :data=&gt;[25, 35, 45, 55]}\n     ],\n   :months_data=&gt;{:months=&gt;[\"jan\", \"feb\"]}\n  },    \n  {:report_data=&gt;[\n     {:type=&gt;{\"id\"=&gt;1, \"name\"=&gt;\"electricity\"}, :data=&gt;[17, 27, 37, 47]},\n     {:type=&gt;{\"id\"=&gt;2, \"name\"=&gt;\"water\"},       :data=&gt;[27, 37, 47, 57]}],\n   :months_data=&gt;{:months=&gt;[\"jan\", \"feb\"]}\n  }\n]\n</code></pre>\n\n<p>Let's try it:</p>\n\n<pre><code>convert(arr)\n  #=&gt; {:months_data=&gt;{:months=&gt;[\"jan\", \"feb\"]},\n  #    :report_data=&gt;[\n  #      {:type=&gt;{\"id\"=&gt;1, \"name\"=&gt;\"electricity\"}, :data=&gt;[42, 72, 102, 132]},\n  #      {:type=&gt;{\"id\"=&gt;2, \"name\"=&gt;\"water\"},       :data=&gt;[72, 102, 132, 162]}\n  #    ]\n  #   }\n</code></pre>\n\n<p><strong>Explanation</strong></p>\n\n<p>The first thing I did is concentrate on computing the sums, so I converted this to the values of <code>:report_data</code>. That key, and the key-value pair of months' data, which is the same for all elements (hashes) of <code>arr</code>, can be added back in later.</p>\n\n<pre><code>b = arr.map { |h| h[:report_data] }\n  #=&gt; [\n  #    [{:type=&gt;{\"id\"=&gt;1, \"name\"=&gt;\"electricity\"}, :data=&gt;[10, 20, 30, 40]},\n  #     {:type=&gt;{\"id\"=&gt;2, \"name\"=&gt;\"water\"},       :data=&gt;[20, 30, 40, 50]}\n  #    ],\n  #    [{:type=&gt;{\"id\"=&gt;1, \"name\"=&gt;\"electricity\"}, :data=&gt;[15, 25, 35, 45]},\n  #     {:type=&gt;{\"id\"=&gt;2, \"name\"=&gt;\"water\"},       :data=&gt;[25, 35, 45, 55]}\n  #    ],\n  #    [{:type=&gt;{\"id\"=&gt;1, \"name\"=&gt;\"electricity\"}, :data=&gt;[17, 27, 37, 47]},\n  #     {:type=&gt;{\"id\"=&gt;2, \"name\"=&gt;\"water\"},       :data=&gt;[27, 37, 47, 57]}\n  #    ]\n  #   ] \n</code></pre>\n\n<p>If you are not certain that the elements of each array will be sorted by <code>\"id\"</code>, you could write:</p>\n\n<pre><code>b = arr.map { |h| h[:report_data].sort_by { |g| g[:type][\"id\"] } }\n\nc = b.transpose\n  #=&gt; [\n  #    [{:type=&gt;{\"id\"=&gt;1, \"name\"=&gt;\"electricity\"}, :data=&gt;[10, 20, 30, 40]},\n  #     {:type=&gt;{\"id\"=&gt;1, \"name\"=&gt;\"electricity\"}, :data=&gt;[15, 25, 35, 45]},\n  #     {:type=&gt;{\"id\"=&gt;1, \"name\"=&gt;\"electricity\"}, :data=&gt;[17, 27, 37, 47]}\n  #    ],\n  #    [{:type=&gt;{\"id\"=&gt;2, \"name\"=&gt;\"water\"},       :data=&gt;[20, 30, 40, 50]},\n  #     {:type=&gt;{\"id\"=&gt;2, \"name\"=&gt;\"water\"},       :data=&gt;[25, 35, 45, 55]},\n  #     {:type=&gt;{\"id\"=&gt;2, \"name\"=&gt;\"water\"},       :data=&gt;[27, 37, 47, 57]}\n  #    ]\n  #   ] \n\ne = c.map {|d| { :type=&gt;d.first[:type] }.\n      merge(:data=&gt;d.map { |g| g[:data] }.transpose.map { |a| a.reduce(:+) }) }\n  #=&gt; [{:type=&gt;{\"id\"=&gt;1, \"name\"=&gt;\"electricity\"}, :data=&gt;[42, 72, 102, 132]},\n  #    {:type=&gt;{\"id\"=&gt;2, \"name\"=&gt;\"water\"}      , :data=&gt;[72, 102, 132, 162]}] \n</code></pre>\n\n<p>Lastly, we need to put the put the key <code>:report_data</code> back in and add the months' data:</p>\n\n<pre><code>{ :months_data=&gt;arr.first[:months_data], :report_data=&gt;e }\n  #=&gt; {:months_data=&gt;{:months=&gt;[\"jan\", \"feb\"]},\n  #    :report_data=&gt;[\n  #      {:type=&gt;{\"id\"=&gt;1, \"name\"=&gt;\"electricity\"}, :data=&gt;[42, 72, 102, 132]},\n  #      {:type=&gt;{\"id\"=&gt;2, \"name\"=&gt;\"water\"},       :data=&gt;[72, 102, 132, 162]}\n  #    ]\n  #   }\n</code></pre>\n"}], "owner": {"reputation": 1125, "user_id": 5398558, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-y55QNRIiBcA/AAAAAAAAAAI/AAAAAAAAABI/HLtIr-k2f7w/photo.jpg?sz=128", "display_name": "Nadiya", "link": "https://stackoverflow.com/users/5398558/nadiya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 0, "accepted_answer_id": 34167910, "answer_count": 3, "score": 0, "last_activity_date": 1449679764, "creation_date": 1449601186, "last_edit_date": 1449603946, "question_id": 34163851, "link": "https://stackoverflow.com/questions/34163851/sum-an-array-of-hashes-in-ruby", "title": "Sum an array of hashes in Ruby", "body": "<p>I have a ruby array of 3 hashes. Each peace has information about report_data (consumption of 2 types of energy) and monthes_data (same for each). Please see the code below.</p>\n\n<pre><code>arr = [{:report_data=&gt;\n  [{:type=&gt;\n      {\"id\"=&gt;1, \"name\"=&gt;\"electricity\"},\n    :data=&gt;[10, 20, 30, 40]},\n    {:type=&gt;\n      {\"id\"=&gt;2, \"name\"=&gt;\"water\"},\n    :data=&gt;[20, 30, 40, 50]}],\n  :monthes_data=&gt;\n    {:monthes=&gt;\n      [\"jan\", \"feb\"]},\n\n {:report_data=&gt;\n  [{:type=&gt;\n      {\"id\"=&gt;1, \"name\"=&gt;\"electricity\"},\n    :data=&gt;[15, 25, 35, 45]},\n    {:type=&gt;\n      {\"id\"=&gt;2, \"name\"=&gt;\"water\"},\n    :data=&gt;[25, 35, 45, 55]}],\n  :monthes_data=&gt;\n    {:monthes=&gt;\n      [\"jan\", \"feb\"]},\n\n {:report_data=&gt;\n  [{:type=&gt;\n      {\"id\"=&gt;1, \"name\"=&gt;\"electricity\"},\n    :data=&gt;[17, 27, 37, 47]},\n    {:type=&gt;\n      {\"id\"=&gt;2, \"name\"=&gt;\"water\"},\n    :data=&gt;[27, 37, 47, 57]}],\n  :monthes_data=&gt;\n    {:monthes=&gt;\n      [\"jan\", \"feb\"]}]\n</code></pre>\n\n<p>I'm new to Ruby. Please help me to sum all the data by energy types. In the end I want to have one hash with report_data and monthes_data. I need the result look like:</p>\n\n<pre><code>{:report_data=&gt;\n  [{:type=&gt;\n      {:\"id\"=&gt;1, \"name\"=&gt;\"electricity\"},\n    :data=&gt;[42, 72, 102, 132]},\n    {:type=&gt;\n      {\"id\"=&gt;2, \"name\"=&gt;\"water\"}},\n    :data=&gt;[72, 102, 132, 162]}],\n  :monthes_data=&gt;\n    {:monthes=&gt;\n      [\"jan\", \"feb\"]}}\n</code></pre>\n"}, {"tags": ["ruby", "chef-infra"], "answers": [{"tags": [], "owner": {"reputation": 43208, "user_id": 78722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf611565f0b79abd0b3dc200ad867661?s=128&d=identicon&r=PG", "display_name": "coderanger", "link": "https://stackoverflow.com/users/78722/coderanger"}, "is_accepted": false, "score": 1, "last_activity_date": 1449614169, "last_edit_date": 1449614169, "creation_date": 1449601573, "answer_id": 34163974, "question_id": 34163640, "link": "https://stackoverflow.com/questions/34163640/can-chef-lazy-load-multiple-attributes/34163974#34163974", "title": "Can CHEF lazy load multiple attributes?", "body": "<p>As I've explained to you before, this works like sprintf in any normal C-based language. There is no magic. You are also still using <code>#{}</code> in the string instead of <code>%{}</code> so none of this will work.</p>\n\n<p>Please follow the examples I've given you:</p>\n\n<pre><code>default['foo'] = 42  \ndefault['derp'] = \"bar-%{foo}\"  \ndefault['url'] = \"http://example.com/%{derp}\"  \n\nsome_resource 'derp' do\n  derp = node['derp'] % {foo: node['foo']}\n  url node['url'] % { foo: node['foo'], derp: derp } \nend\n</code></pre>\n"}], "owner": {"reputation": 13950, "user_id": 1626687, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8d4317dca5804dd7e9b30515b9bf3020?s=128&d=identicon&r=PG", "display_name": "spuder", "link": "https://stackoverflow.com/users/1626687/spuder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1450804370, "creation_date": 1449600420, "last_edit_date": 1450804370, "question_id": 34163640, "link": "https://stackoverflow.com/questions/34163640/can-chef-lazy-load-multiple-attributes", "title": "Can CHEF lazy load multiple attributes?", "body": "<p>If you have a wrapper cookbook that overrides a derived attributes, you need to use lazy loading like so: </p>\n\n<p>Library cookbook</p>\n\n<pre><code>default['foo'] = 42\ndefault['url'] = \"http://example.com/#{foo}\"\n</code></pre>\n\n<p>Wrapper cookbook</p>\n\n<pre><code>default['foo'] = 9000\ndefault['url'] = \"http://example.com/#{foo}\"\n\nsome_resource 'derp' do\n  url node['url'] % { foo: node['foo'] }\n  action :do_stuff\nend\n</code></pre>\n\n<p>The above works. </p>\n\n<p>How do you use lazy loading for multiple derived attributes? </p>\n\n<p>For example, I need to derive <code>url</code> off of <code>derp</code> which is derived off of <code>foo</code></p>\n\n<pre><code> default['foo'] = 42\n default['derp'] = \"bar-#{foo}\"\n default['url'] = \"http://example.com/#{derp}\"\n\nsome_resource 'derp' do\n  url node['url'] % { foo: node['foo'], derp: node['derp'] } #Guessing this is the right syntax\n  action :do_stuff\nend\n</code></pre>\n\n<p>However this gives the error</p>\n\n<pre><code>       KeyError\n   --------\n   key{node['url']} not found\n</code></pre>\n\n<p>This example is greatly simplified, the full code is outlined here: <a href=\"https://github.com/SimpleFinance/chef-zookeeper/issues/151\" rel=\"nofollow\">https://github.com/SimpleFinance/chef-zookeeper/issues/151</a></p>\n\n<p><strong>Update</strong></p>\n\n<p>For reference, the issue was resolved here: <a href=\"https://github.com/SimpleFinance/chef-zookeeper/commit/6750ea8c11a6dd7ef1c0f76ac8c61b71a172fb80\" rel=\"nofollow\">https://github.com/SimpleFinance/chef-zookeeper/commit/6750ea8c11a6dd7ef1c0f76ac8c61b71a172fb80</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "routes"], "comments": [{"owner": {"reputation": 17357, "user_id": 794242, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e871d15815cfef926f21737a5ccd30c4?s=128&d=identicon&r=PG", "display_name": "Wand Maker", "link": "https://stackoverflow.com/users/794242/wand-maker"}, "edited": false, "score": 1, "creation_date": 1449599968, "post_id": 34163405, "comment_id": 56073750, "body": "Shouldn&#39;t the title of your question be &quot;How to process requests for certain sub-domain(s) in Rails?&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 2549123, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e725c16853efc261e9d6cdd4e6c4f7e1?s=128&d=identicon&r=PG", "display_name": "Sean", "link": "https://stackoverflow.com/users/2549123/sean"}, "is_accepted": false, "score": 1, "last_activity_date": 1449599951, "creation_date": 1449599951, "answer_id": 34163496, "question_id": 34163405, "link": "https://stackoverflow.com/questions/34163405/how-to-process-requests-for-certain-sub-domains-in-rails/34163496#34163496", "title": "How to process requests for certain sub-domain(s) in Rails?", "body": "<p>Your code is acting as a type of filter, so only requests already utilizing the subdomain 'blog' will invoke the route. You need to ensure that the web server itself is also setup to handle that subdomain and point it to your application. </p>\n\n<p>Edit: Try checking out this post for further clarification (if you're on your local environment). <a href=\"https://reinteractive.net/posts/199-developing-and-testing-rails-applications-with-subdomains\" rel=\"nofollow\">https://reinteractive.net/posts/199-developing-and-testing-rails-applications-with-subdomains</a></p>\n"}], "owner": {"reputation": 1815, "user_id": 5110072, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0f00c171a617c7de7e8f29649ed44c5b?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Shmatko", "link": "https://stackoverflow.com/users/5110072/alex-shmatko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1449600181, "creation_date": 1449599666, "last_edit_date": 1449600181, "question_id": 34163405, "link": "https://stackoverflow.com/questions/34163405/how-to-process-requests-for-certain-sub-domains-in-rails", "title": "How to process requests for certain sub-domain(s) in Rails?", "body": "<p>For example, I want my project link to look like <code>http://blog.example.com</code>. How can I make that kind of route in Rails 4? And how it can interact with controller?</p>\n\n<p>The following stuff didn't work for me.</p>\n\n<pre><code>resource :article, constraints: {subdomain: 'blog'}\n</code></pre>\n"}]