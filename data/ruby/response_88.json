[{"tags": ["ruby", "methods"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1473894750, "post_id": 39500517, "comment_id": 66319336, "body": "try <code>puts &quot;Enter words separated by a space&quot;; words = gets.split; p words.sort</code>"}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 5394743, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/31568ed05460d1647cfe2b333058a477?s=128&d=identicon&r=PG&f=1", "display_name": "Chris K", "link": "https://stackoverflow.com/users/5394743/chris-k"}, "edited": false, "score": 0, "creation_date": 1473895570, "post_id": 39500696, "comment_id": 66319553, "body": "Hello. And thank a lot. It&#39;s no longer showing the message. I&#39;m also changing the code in accordance with what you&#39;ve said. I&#39;ve realised it would be better to use variable &quot;x&quot;.length - 1 as a loop, with the y loop within that.  Still not working, but I&#39;m past that hurdle. Thank you very much, I would not have been able to solve that problem."}, {"owner": {"reputation": 636, "user_id": 1253311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21acab710c6e17104c2af7bf8390a9d5?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/1253311/matt"}, "reply_to_user": {"reputation": 5, "user_id": 5394743, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/31568ed05460d1647cfe2b333058a477?s=128&d=identicon&r=PG&f=1", "display_name": "Chris K", "link": "https://stackoverflow.com/users/5394743/chris-k"}, "edited": false, "score": 0, "creation_date": 1473953184, "post_id": 39500696, "comment_id": 66345636, "body": "@ChrisK I&#39;m glad it helped. Are you able to accept the answer?"}, {"owner": {"reputation": 5, "user_id": 5394743, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/31568ed05460d1647cfe2b333058a477?s=128&d=identicon&r=PG&f=1", "display_name": "Chris K", "link": "https://stackoverflow.com/users/5394743/chris-k"}, "edited": false, "score": 0, "creation_date": 1475223533, "post_id": 39500696, "comment_id": 66867181, "body": "Hi. I know this is late. But how do I accept the answer?"}], "tags": [], "owner": {"reputation": 636, "user_id": 1253311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21acab710c6e17104c2af7bf8390a9d5?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/1253311/matt"}, "is_accepted": true, "score": 0, "last_activity_date": 1473892672, "creation_date": 1473892672, "answer_id": 39500696, "question_id": 39500517, "link": "https://stackoverflow.com/questions/39500517/ruby-undefined-method-in-alphabetical-sorting-program/39500696#39500696", "title": "Ruby - &quot;undefined method&quot; in alphabetical sorting program", "body": "<p>Your first <code>while</code> loop terminates once it gets to an empty string (but still appends this to the list), meaning that the last element of <code>words</code> is an empty string. When you split the empty string on itself, you get an empty array. </p>\n\n<pre><code>\"\".split(\"\") #=&gt; []\n\"\".split(\"\")[0] #=&gt; nil\n</code></pre>\n\n<p>You are eventually hitting this point in your second loop, and calling <code>.ord</code> on <code>nil</code>. You could avoid this by not including the empty string as part of the <code>words</code> array. </p>\n"}], "owner": {"reputation": 5, "user_id": 5394743, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/31568ed05460d1647cfe2b333058a477?s=128&d=identicon&r=PG&f=1", "display_name": "Chris K", "link": "https://stackoverflow.com/users/5394743/chris-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 39500696, "answer_count": 1, "score": 0, "last_activity_date": 1473908774, "creation_date": 1473891557, "last_edit_date": 1473908774, "question_id": 39500517, "link": "https://stackoverflow.com/questions/39500517/ruby-undefined-method-in-alphabetical-sorting-program", "title": "Ruby - &quot;undefined method&quot; in alphabetical sorting program", "body": "<p>I've tried to create a program that will take in strings, then sort them alphabetically, but I've hit a bump that I can't seem to understand with my current level.\nIf I run the code without the if branch, then things are fine; but the moment I do this:</p>\n\n<blockquote>\n  <p>junk.rb:20:in <code>&lt;main&gt;': undefined method</code>ord' for nil:NilClass\n  (NoMethodError)</p>\n</blockquote>\n\n<p>If I remove the <code>ord</code> method, I get the same message with <code>split</code> in place of \"ord\" in the returned message.\nDoes anyone know what the problem is?</p>\n\n<p>CODE:</p>\n\n<pre><code>words = []\ncWords = nil\nx = 0\ny = 0\n\nwhile (cWords != \"\")\n  cWords = gets.chomp\n  words[x] = cWords\n  x = x + 1\nend\n\nx = 0\n\nwhile (y &lt; 200) #arbitrary limit at the moment\n  if (words[x].split(\"\")[0].ord == y)\n    puts words[x]\n  end\n  y = y + 1\n  x = x + 1\nend\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1473889039, "post_id": 39499780, "comment_id": 66317586, "body": "I don&#39;t understand what you are asking. Is this a Ruby problem or a HackerRank problem?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1473889110, "post_id": 39499780, "comment_id": 66317616, "body": "&quot;gets didn&#39;t work&quot; is not much of a problem description, is it? It works, unless there is something special going on."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1473890025, "post_id": 39499780, "comment_id": 66317951, "body": "You&#39;ll get <code>nil</code> when there&#39;s no more input. As always, <a href=\"http://ruby-doc.org/core-2.3.1/IO.html#method-i-gets\" rel=\"nofollow noreferrer\">read the documentation</a>."}, {"owner": {"reputation": 1617, "user_id": 6174577, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9f31e03bb70b0cebb89f1e0b81efd485?s=128&d=identicon&r=PG&f=1", "display_name": "Ka Mok", "link": "https://stackoverflow.com/users/6174577/ka-mok"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1473890364, "post_id": 39499780, "comment_id": 66318077, "body": "@tadman On their platform they told me the first stdin was an integer to dictate how many lines were left, which gave me a 1. The second <code>gets</code> that I did yield nil. What do you make of that?"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1473909149, "post_id": 39499780, "comment_id": 66322457, "body": "If the first line yields two billion, what are the odds someone&#39;s actually going to type in that many? Plan for the best, prepare for the worst, and the worst here is you didn&#39;t get enough input because STDIN was closed."}, {"owner": {"reputation": 1617, "user_id": 6174577, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9f31e03bb70b0cebb89f1e0b81efd485?s=128&d=identicon&r=PG&f=1", "display_name": "Ka Mok", "link": "https://stackoverflow.com/users/6174577/ka-mok"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1473912872, "post_id": 39499780, "comment_id": 66323293, "body": "@tadman I don&#39;t get the hostility of this community. I ran into a problem with HackerRank during a code challenge for a job. Solved it. Posted an answer here to my own problem. And now I got people telling me that I&#39;m wrong. I&#39;m confused."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1473919315, "post_id": 39499780, "comment_id": 66325162, "body": "It&#39;s not hostility but frustration. Remember, you&#39;re not the only one asking questions like this, you&#39;re one of thousands, and when you see the same thing over and over again it&#39;s easy to get sarcastic, snippy, or be really snarky. Ruby&#39;s documentation is something you <i>must</i> at least skim, and whenever you&#39;re using a method, consult the documentation specific to that. Many methods are counter-intuitive, there&#39;s no other way to understand them than to do your homework and try things."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1473919420, "post_id": 39499780, "comment_id": 66325196, "body": "The problem with your question is it doesn&#39;t really say what the problem is, doesn&#39;t define what <i>should</i> happen, and doesn&#39;t show a whole lot of effort to solve it. Posting to Stack Overflow is not something you do after twenty five minutes. It&#39;s something you do after an hour when you&#39;ve read the documentation, when you&#39;ve tried a dozen different approaches, and when you still have some confusion. Be clear about the <i>input</i> and <i>expected output</i> of your program, something omitted here much to everyone&#39;s frustration. Guessing what your code does is not fun."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1473921716, "post_id": 39499780, "comment_id": 66326102, "body": "&quot;which gave me a 1&quot; - aha! So it <b>does</b> work? This means that the problem is not with <code>gets</code> but elsewhere. Perhaps, input data is set up to not provide subsequent data, or your code messes <code>gets</code> up, or something else. Given your claim that <code>STDIN.read</code> works, I&#39;d like to bet that your code breaks gets somehow."}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1473887988, "post_id": 39499781, "comment_id": 66317169, "body": "I&#39;m pretty sure that <code>gets</code> should work as well. You know, same as in regular ruby scripts."}, {"owner": {"reputation": 1617, "user_id": 6174577, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9f31e03bb70b0cebb89f1e0b81efd485?s=128&d=identicon&r=PG&f=1", "display_name": "Ka Mok", "link": "https://stackoverflow.com/users/6174577/ka-mok"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1473888844, "post_id": 39499781, "comment_id": 66317505, "body": "If that worked, I wouldn&#39;t have posted here. Nor would I be pulling teeth when I had to do it."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 1, "creation_date": 1473919528, "post_id": 39499781, "comment_id": 66325229, "body": "As a note, <code>$stdin.readlines</code> will do the splitting for you. The <a href=\"http://ruby-doc.org/core-2.3.1/IO.html\" rel=\"nofollow noreferrer\">Ruby <code>IO</code></a> class is unusually feature complete compared to most programming languages and offers a whole host of utility methods like this."}], "tags": [], "owner": {"reputation": 1617, "user_id": 6174577, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9f31e03bb70b0cebb89f1e0b81efd485?s=128&d=identicon&r=PG&f=1", "display_name": "Ka Mok", "link": "https://stackoverflow.com/users/6174577/ka-mok"}, "is_accepted": false, "score": 0, "last_activity_date": 1473887915, "creation_date": 1473887915, "answer_id": 39499781, "question_id": 39499780, "link": "https://stackoverflow.com/questions/39499780/how-to-read-from-stdin-on-hacker-rank-code-challenge-in-ruby/39499781#39499781", "title": "How to read from STDIN on Hacker Rank code challenge in Ruby?", "body": "<p>Just do <code>data = STDIN.read</code> for single line inputs. </p>\n\n<p>And for multi line inputs, do </p>\n\n<pre><code>STDIN.read.split(\"\\n\").each do |a|\n   puts a\nend\n</code></pre>\n"}], "owner": {"reputation": 1617, "user_id": 6174577, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/9f31e03bb70b0cebb89f1e0b81efd485?s=128&d=identicon&r=PG&f=1", "display_name": "Ka Mok", "link": "https://stackoverflow.com/users/6174577/ka-mok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1672, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473889989, "creation_date": 1473887915, "last_edit_date": 1473889989, "question_id": 39499780, "link": "https://stackoverflow.com/questions/39499780/how-to-read-from-stdin-on-hacker-rank-code-challenge-in-ruby", "title": "How to read from STDIN on Hacker Rank code challenge in Ruby?", "body": "<p>Just had this problem for a tech interview. Took me a good 25 minutes before I found out how to get the input for my method. The is the gist of instructions they give for how to use their platform:</p>\n\n<blockquote>\n  <p>The first stdin will be a integer that explains how many more lines are left. </p>\n</blockquote>\n\n<p>Use <code>n = gets.to_i</code></p>\n\n<pre><code>(0...n).times do |i|\n  data = gets\n  ##do stuff with data\nend\n</code></pre>\n\n<p>Edit: For the people who thinks <code>gets</code> works, it didn't. when <code>n = gets</code>, n = nil</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "rspec-rails"], "comments": [{"owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 1, "creation_date": 1473956314, "post_id": 39499592, "comment_id": 66347536, "body": "on your controller, add some debugging &quot;puts&quot;, output your objects &#39;errors&#39; and you will find why it&#39;s not saving"}, {"owner": {"reputation": 318, "user_id": 1068150, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/92ojm.jpg?s=128&g=1", "display_name": "Gareth Fuller", "link": "https://stackoverflow.com/users/1068150/gareth-fuller"}, "reply_to_user": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "edited": false, "score": 0, "creation_date": 1474009563, "post_id": 39499592, "comment_id": 66366346, "body": "@arieljuod thanks for this. It definitely would have helped me find the problem quicker."}], "answers": [{"comments": [{"owner": {"reputation": 318, "user_id": 1068150, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/92ojm.jpg?s=128&g=1", "display_name": "Gareth Fuller", "link": "https://stackoverflow.com/users/1068150/gareth-fuller"}, "edited": false, "score": 0, "creation_date": 1473890109, "post_id": 39499695, "comment_id": 66317988, "body": "Hmmm this is confusing. I disabled all my validations on the Post model and I still get the same test error."}], "tags": [], "owner": {"reputation": 1, "user_id": 3483055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/akZnI.jpg?s=128&g=1", "display_name": "benjwrdill", "link": "https://stackoverflow.com/users/3483055/benjwrdill"}, "is_accepted": false, "score": 0, "last_activity_date": 1473887466, "creation_date": 1473887466, "answer_id": 39499695, "question_id": 39499592, "link": "https://stackoverflow.com/questions/39499592/rails-5-rspec-expect-change-count-not-working/39499695#39499695", "title": "Rails 5 - Rspec Expect Change Count Not Working", "body": "<p>Your post change is not changing by one here. The relevant line from the test log:</p>\n\n<pre><code>[1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m\n</code></pre>\n\n<p>The \"ROLLBACK\" keyword means that your post failed validation and was not created.</p>\n"}, {"comments": [{"owner": {"reputation": 318, "user_id": 1068150, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/92ojm.jpg?s=128&g=1", "display_name": "Gareth Fuller", "link": "https://stackoverflow.com/users/1068150/gareth-fuller"}, "edited": false, "score": 0, "creation_date": 1473890143, "post_id": 39499729, "comment_id": 66317993, "body": "I&#39;ve been using Faker for my factories data. This is what I have for :post <code>title { Faker::Lorem.sentence }</code>. I tried using the before call <code>before { Post.destroy_all }</code> as you suggested and this didn&#39;t work either. I also tried setting the title in that test so that I could be sure it would be unique and that didn&#39;t work."}, {"owner": {"reputation": 318, "user_id": 1068150, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/92ojm.jpg?s=128&g=1", "display_name": "Gareth Fuller", "link": "https://stackoverflow.com/users/1068150/gareth-fuller"}, "edited": false, "score": 0, "creation_date": 1473892863, "post_id": 39499729, "comment_id": 66318806, "body": "I also tried using database_cleaner and that didn&#39;t work either. Totally lost on what to try next."}], "tags": [], "owner": {"reputation": 12542, "user_id": 156746, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8TsPx.jpg?s=128&g=1", "display_name": "DiegoSalazar", "link": "https://stackoverflow.com/users/156746/diegosalazar"}, "is_accepted": false, "score": 0, "last_activity_date": 1473887652, "creation_date": 1473887652, "answer_id": 39499729, "question_id": 39499592, "link": "https://stackoverflow.com/questions/39499592/rails-5-rspec-expect-change-count-not-working/39499729#39499729", "title": "Rails 5 - Rspec Expect Change Count Not Working", "body": "<p>You're most likely either not deleting old Posts at the beginning of your spec or not using random data to create new Posts and that is triggering your uniqueness validations.</p>\n\n<h2>Clearing your database during spec setup</h2>\n\n<h3>Manually</h3>\n\n<pre><code>before { Post.destroy_all }\n</code></pre>\n\n<h3>Automatically with Database Cleaner:</h3>\n\n<p>Using <a href=\"https://github.com/DatabaseCleaner/database_cleaner\" rel=\"nofollow\">https://github.com/DatabaseCleaner/database_cleaner</a></p>\n\n<pre><code>RSpec.configure do |config|\n  config.before(:suite) do\n    DatabaseCleaner.strategy = :transaction\n    DatabaseCleaner.clean_with(:truncation)\n  end\n\n  config.around(:each) do |example|\n    DatabaseCleaner.cleaning do\n      example.run\n    end\n  end\nend\n</code></pre>\n\n<h3>Using randomized data in factories</h3>\n\n<p>Using the Faker gem <a href=\"https://github.com/stympy/faker\" rel=\"nofollow\">https://github.com/stympy/faker</a></p>\n\n<pre><code>FactoryGirl.define do\n  factory :post do\n    title { Faker::Lorem.word }\n  end\nend\n</code></pre>\n\n<p>I recommend clearing your database manually before each spec example runs. No need to add a gem to do it for you when your app is still simple and you're only creating one or two models per example.</p>\n"}, {"tags": [], "owner": {"reputation": 318, "user_id": 1068150, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/92ojm.jpg?s=128&g=1", "display_name": "Gareth Fuller", "link": "https://stackoverflow.com/users/1068150/gareth-fuller"}, "is_accepted": true, "score": 0, "last_activity_date": 1473894740, "creation_date": 1473894740, "answer_id": 39500990, "question_id": 39499592, "link": "https://stackoverflow.com/questions/39499592/rails-5-rspec-expect-change-count-not-working/39500990#39500990", "title": "Rails 5 - Rspec Expect Change Count Not Working", "body": "<p>Ok, so I figured out why it wasn't saving a new Post record. For whatever reason, the author that was supposed to be assigned to the post in the :post factory was not being created. This meant that a validation failed.</p>\n\n<p>This is the :post factory I was using:</p>\n\n<pre><code>FactoryGirl.define do\n  factory :post do\n    title { Faker::Lorem.sentence }\n    excerpt { Faker::Lorem.paragraph }\n    content { Faker::Lorem.paragraph }\n    published false\n    published_at nil\n    post_type \"article\"\n    keywords \"blog, post, key, words\"\n    author\n  end\nend\n</code></pre>\n\n<p>And this was my :author factory for my Devise Author model:</p>\n\n<pre><code>FactoryGirl.define do\n  factory :author do\n    email { Faker::Internet.email }\n    password \"password\"\n    password_confirmation \"password\"\n  end\nend\n</code></pre>\n\n<p>When I was generating the attributes using the FactoryGirl</p>\n\n<pre><code>attributes_for(:post)\n</code></pre>\n\n<p>method, the author was not being created and therefore the author_id attribute of the post was not being set.</p>\n\n<p>To fix this I had to create the author in the test then set the author_id attribute in the <code>attributes_for</code> method.</p>\n\n<p>So my working test now looks like this:</p>\n\n<pre><code>it \"saves the new Post in the database\" do\n  author = create(:author)\n  expect{\n    process :create, method: :post, params: { post: attributes_for(:post, author_id: author.id) }\n  }.to change{Post.count}.by(1)  \nend\n</code></pre>\n\n<p>Although this solves my original problem, I'm not sure why the Author was not being created and associated to the Post within the <code>attributes_for</code> call.</p>\n"}], "owner": {"reputation": 318, "user_id": 1068150, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/92ojm.jpg?s=128&g=1", "display_name": "Gareth Fuller", "link": "https://stackoverflow.com/users/1068150/gareth-fuller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2542, "favorite_count": 0, "accepted_answer_id": 39500990, "answer_count": 3, "score": 1, "last_activity_date": 1473894740, "creation_date": 1473886931, "question_id": 39499592, "link": "https://stackoverflow.com/questions/39499592/rails-5-rspec-expect-change-count-not-working", "title": "Rails 5 - Rspec Expect Change Count Not Working", "body": "<p>This might be something really simple, but I can't get Rspec's expect change count to detect when a new record is created through the controller's create method.</p>\n\n<p>Here is my test:</p>\n\n<pre><code>it \"saves the new Post in the database\" do\n  expect{\n    process :create, method: :post, params: { post: attributes_for(:post) }\n  }.to change{Post.count}.by(1)  \nend\n</code></pre>\n\n<p>it just errors with:</p>\n\n<pre><code>expected result to have changed by 1, but was changed by 0\n</code></pre>\n\n<p>Looking at the test.log it doesnt seem to show any errors when the post is created:</p>\n\n<pre><code>  [1m[35m (0.0ms)[0m  [1m[36mbegin transaction[0m\n  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM \"posts\"[0m\n  Processing by PostsController#create as HTML\n  Parameters: {\"post\"=&gt;{\"content\"=&gt;\"Quas adipisci illum repellat sapiente eos. Quae temporibus facilis. Corporis odit eaque reiciendis eum tempora. Nam dolor sint pariatur.\", \"excerpt\"=&gt;\"Dicta veritatis voluptate at. Sed voluptatem corrupti sed impedit quae consequatur. Velit voluptates nisi est nihil. Explicabo qui animi expedita rerum.\", \"image_url\"=&gt;\"https://hd.unsplash.com/photo-1413781892741-08a142b23dfe\", \"keywords\"=&gt;\"blog, post, key, words\", \"post_type\"=&gt;\"article\", \"published\"=&gt;\"false\", \"title\"=&gt;\"Pariatur laborum ut nostrum quis rem sunt libero.\"}}\n  [1m[35m (0.0ms)[0m  [1m[35mSAVEPOINT active_record_1[0m\n  [1m[36mPost Exists (0.1ms)[0m  [1m[34mSELECT  1 AS one FROM \"posts\" WHERE \"posts\".\"title\" = ? LIMIT ?[0m  [[\"title\", \"Pariatur laborum ut nostrum quis rem sunt libero.\"], [\"LIMIT\", 1]]\n  [1m[35m (0.0ms)[0m  [1m[31mROLLBACK TO SAVEPOINT active_record_1[0m\n  Rendering /home/nitrous/code/blog/app/views/posts/index.html.haml within layouts/application\n  Rendered /home/nitrous/code/blog/app/views/posts/index.html.haml within layouts/application (0.0ms)\n  Completed 200 OK in 9ms (Views: 0.6ms | ActiveRecord: 0.2ms)\n  [1m[35m (0.1ms)[0m  [1m[34mSELECT COUNT(*) FROM \"posts\"[0m\n  [1m[35m (0.1ms)[0m  [1m[31mrollback transaction[0m\n</code></pre>\n\n<p>The post model validates that the title is unique.</p>\n\n<p>I can see that the log says 'Post Exists' but if it does and this is the reason it's not saving a new Post. Why is that?</p>\n"}, {"tags": ["ruby", "thor"], "answers": [{"tags": [], "owner": {"reputation": 195223, "user_id": 48523, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1c787bc735dbe80ec2f88824e1d10c6c?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/48523/andrew"}, "is_accepted": false, "score": 2, "last_activity_date": 1473892691, "creation_date": 1473892691, "answer_id": 39500698, "question_id": 39499523, "link": "https://stackoverflow.com/questions/39499523/how-to-accept-an-array-of-keyvalue-arguments-in-a-thor-generator-command/39500698#39500698", "title": "How to accept an array of key:value arguments in a Thor generator command?", "body": "<p>Looks like this feature is already supported. You just need to specify the argument type as a <code>:hash</code>.</p>\n\n<pre><code>argument :model_attributes, optional: true, type: :hash\n</code></pre>\n"}], "owner": {"reputation": 195223, "user_id": 48523, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/1c787bc735dbe80ec2f88824e1d10c6c?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/48523/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 336, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1473892691, "creation_date": 1473886604, "question_id": 39499523, "link": "https://stackoverflow.com/questions/39499523/how-to-accept-an-array-of-keyvalue-arguments-in-a-thor-generator-command", "title": "How to accept an array of key:value arguments in a Thor generator command?", "body": "<p>I am working on creating a generator similar to the Rails scaffolding generator. I would like to accept an array of <code>key:value</code> arguments. Like this:</p>\n\n<pre><code>mycli generate model BlogPost title:string body:text published:datetime\n</code></pre>\n\n<p>Currently my command class looks something like this:</p>\n\n<pre><code>require \"thor\"\n\nmodule Mycli\n  module Generators\n    class Model &lt; Thor::Group\n      include Thor::Actions\n\n      argument :model_name\n      # argument :model_attributes # TODO: figure out how to get array of attributes\n\n      def self.source_root\n        File.dirname(__FILE__)\n      end\n\n      def generate_model\n        template('templates/model.tt', \"app/models/#{model_name}.rb\")\n      end\n\n      def generate_migration\n        template('templates/migration.tt', \"migrations/#{model_name}.rb\")\n      end\n    end\n  end\nend\n</code></pre>\n\n<p>What do I need to do in order to access that list of attributes?</p>\n"}, {"tags": ["ruby", "irb"], "answers": [{"comments": [{"owner": {"reputation": 24966, "user_id": 2001031, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bd4f0d39f82be9c22f6f01c80d7ad800?s=128&d=identicon&r=PG", "display_name": "Neil Slater", "link": "https://stackoverflow.com/users/2001031/neil-slater"}, "edited": false, "score": 1, "creation_date": 1475011863, "post_id": 39685546, "comment_id": 66767151, "body": "Thank you for pointing me at Pry again. I looked at it before, but the focus on debugging features made me think it was not suitable. It may well be better than <code>irb</code> for me, even if just for the properly documented support to change config programatically."}], "tags": [], "owner": {"reputation": 2374, "user_id": 1941418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d8940942c798e82d460e0c058acfb3b7?s=128&d=identicon&r=PG", "display_name": "smefju", "link": "https://stackoverflow.com/users/1941418/smefju"}, "is_accepted": false, "score": 2, "last_activity_date": 1474797311, "creation_date": 1474797311, "answer_id": 39685546, "question_id": 39499514, "link": "https://stackoverflow.com/questions/39499514/customising-irb-console-for-gem/39685546#39685546", "title": "Customising IRB console for gem", "body": "<p>You can apply custom configurations in two ways.</p>\n\n<p>The first one is to use <a href=\"http://ruby-doc.org/stdlib-2.3.1/libdoc/irb/rdoc/IRB.html#module-IRB-label-Configuration\" rel=\"nofollow\">irbrc file</a>. It may be tricky in building console application (calling <code>IRB.start</code> from the ruby file instead of <code>irb</code> from the console).</p>\n\n<p>The second one is the approach that you have described in the post. You can write your own <code>IRB::start</code> method based on <a href=\"http://ruby-doc.org/stdlib-2.3.1/libdoc/irb/rdoc/IRB.html#method-c-start\" rel=\"nofollow\">the original one</a>. There are exactly the same potential issues as in using undocumented API - it can break in the future with newer versions of irb.</p>\n\n<p>You should think if you really need to build a console application on the top of irb. For example you can solve this problem using <a href=\"https://github.com/pry/pry\" rel=\"nofollow\"><code>Pry</code></a>. It allows to <a href=\"https://github.com/pry/pry/wiki/Customization-and-configuration\" rel=\"nofollow\">define configuration</a> before starting interactive session.</p>\n"}, {"comments": [{"owner": {"reputation": 24966, "user_id": 2001031, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bd4f0d39f82be9c22f6f01c80d7ad800?s=128&d=identicon&r=PG", "display_name": "Neil Slater", "link": "https://stackoverflow.com/users/2001031/neil-slater"}, "edited": false, "score": 0, "creation_date": 1475184046, "post_id": 39778822, "comment_id": 66854617, "body": "This is cleaner than my solution, but does share the problem that it works with the implementation, not the &quot;official&quot; interface."}, {"owner": {"reputation": 1704, "user_id": 3723506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wHveY.jpg?s=128&g=1", "display_name": "Rashmirathi", "link": "https://stackoverflow.com/users/3723506/rashmirathi"}, "reply_to_user": {"reputation": 24966, "user_id": 2001031, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bd4f0d39f82be9c22f6f01c80d7ad800?s=128&d=identicon&r=PG", "display_name": "Neil Slater", "link": "https://stackoverflow.com/users/2001031/neil-slater"}, "edited": false, "score": 0, "creation_date": 1475184480, "post_id": 39778822, "comment_id": 66854799, "body": "@NeilSlater Yeah, that&#39;s why I said it &quot;relies on internal knowledge of the implementation&quot;. I guess, <code>setup</code> is a public method, hence part of the public interface. It&#39;s just not documented very well."}], "tags": [], "owner": {"reputation": 1704, "user_id": 3723506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wHveY.jpg?s=128&g=1", "display_name": "Rashmirathi", "link": "https://stackoverflow.com/users/3723506/rashmirathi"}, "is_accepted": false, "score": 1, "last_activity_date": 1475179367, "last_edit_date": 1475179367, "creation_date": 1475178586, "answer_id": 39778822, "question_id": 39499514, "link": "https://stackoverflow.com/questions/39499514/customising-irb-console-for-gem/39778822#39778822", "title": "Customising IRB console for gem", "body": "<pre><code>require 'irb'\nIRB.conf[:PROMPT_MODE] = :SIMPLE\nIRB.start\n</code></pre>\n\n<p>The approach above doesn't work because <code>conf[:PROMPT_MODE]</code> gets over-riden in a method called <code>IRB.init_config</code> <a href=\"https://github.com/ruby/ruby/blob/trunk/lib/irb/init.rb#L107\" rel=\"nofollow\">here</a></p>\n\n<p>When <code>IRB.start</code> is called, it calls <code>IRB.setup</code> which in turn calls the method <code>IRB.init_config</code> -- which over-rides <code>conf[:PROMPT_MODE]</code> setting.</p>\n\n<hr>\n\n<p>Here is one approach which solves the problem (relies on internal knowledge of the implementation).</p>\n\n<pre><code>require 'irb'\n\nmodule IRB\n  singleton_class.send(:alias_method, :old_setup, :setup)\n\n  def IRB.setup(ap_path)\n    IRB.old_setup(ap_path)\n\n    conf[:PROMPT_MODE] = :SIMPLE\n  end\nend\n\nIRB.start\n</code></pre>\n"}], "owner": {"reputation": 24966, "user_id": 2001031, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bd4f0d39f82be9c22f6f01c80d7ad800?s=128&d=identicon&r=PG", "display_name": "Neil Slater", "link": "https://stackoverflow.com/users/2001031/neil-slater"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 313, "favorite_count": 1, "answer_count": 2, "score": 5, "last_activity_date": 1475179367, "creation_date": 1473886563, "question_id": 39499514, "link": "https://stackoverflow.com/questions/39499514/customising-irb-console-for-gem", "title": "Customising IRB console for gem", "body": "<p>I'd like to extend the default console application that is built as standard with <code>bundle gem</code> by applying some of the IRB config options.</p>\n\n<p><a href=\"http://ruby-doc.org/stdlib-2.3.1/libdoc/irb/rdoc/IRB.html#module-IRB-label-Configuration\">Looking at the documentation</a>, I can see that it should be possible for instance to change the prompt, and this works fine on an interactive session. For example I can play with the displayed prompt like this:</p>\n\n<pre><code>2.1.4 :001 &gt; conf.prompt_mode=:SIMPLE\n=&gt; :SIMPLE\n&gt;&gt;\n?&gt; conf.prompt_mode=:DEFAULT\n=&gt; :DEFAULT\nirb(main):004:0&gt;\n</code></pre>\n\n<p>However, I cannot find how to translate this into syntax for use in the console app. For example this script:</p>\n\n<pre><code>require 'irb'\nIRB.conf[:PROMPT_MODE] = :SIMPLE\nIRB.start\n</code></pre>\n\n<p>Just starts with the generic configured prompt:</p>\n\n<pre><code>2.1.4 :001 &gt;\n</code></pre>\n\n<p>I have spent some time trying to find an example use of IRB for a custom repl without loading global defaults, but not found anything I can copy from.</p>\n\n<p>I can see that the undocumented method <code>IRB.setup</code> has something to do with this, it is setting all the config somehow. Is my only option to write my own version of <code>IRB.start</code> that applies my desired config after calling <code>IRB.setup</code>, or is there support for what I want to do built-in but not documented in standard location?</p>\n\n<hr>\n\n<p>E.g. the following works, but I feel it's a bit heavy handed extending IRB module this way (and also prone to failing if IRB internals change).</p>\n\n<pre><code>require 'irb'\n\ndef IRB.custom_start custom_conf = {}\n  STDOUT.sync = true\n\n  IRB.setup(nil)\n\n  custom_conf.each do |k,v|\n    IRB.conf[k] = v\n  end\n\n  if @CONF[:SCRIPT]\n    irb = IRB::Irb.new(nil, @CONF[:SCRIPT])\n  else\n    irb = IRB::Irb.new\n  end\n\n  @CONF[:IRB_RC].call(irb.context) if @CONF[:IRB_RC]\n  @CONF[:MAIN_CONTEXT] = irb.context\n\n  trap(\"SIGINT\") do\n    irb.signal_handle\n  end\n\n  begin\n    catch(:IRB_EXIT) do\n      irb.eval_input\n    end\n  ensure\n    irb_at_exit\n  end\nend\n\nIRB.custom_start :PROMPT_MODE =&gt; :SIMPLE\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "answers": [{"tags": [], "owner": {"reputation": 4265, "user_id": 4601088, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bN143.jpg?s=128&g=1", "display_name": "Bart\u0142omiej G\u0142adys", "link": "https://stackoverflow.com/users/4601088/bart%c5%82omiej-g%c5%82adys"}, "is_accepted": true, "score": 1, "last_activity_date": 1473888378, "creation_date": 1473888378, "answer_id": 39499880, "question_id": 39499399, "link": "https://stackoverflow.com/questions/39499399/rails-active-record-get-the-average-value-of-a-column-after-grouping/39499880#39499880", "title": "Rails &amp; Active Record: Get the average value of a column after grouping", "body": "<p>try this:</p>\n\n<pre><code>Keyword.joins(:user_keywords)\n.select('keywords.name, avg(user_keywords.relevance_score) as score')\n.group('keywords.name')\n.order('score DESC')\n.map(&amp;:name)\n</code></pre>\n"}], "owner": {"reputation": 4213, "user_id": 4621100, "user_type": "registered", "accept_rate": 47, "profile_image": "https://lh5.googleusercontent.com/-BanGQaFKyzM/AAAAAAAAAAI/AAAAAAAAA_E/ZZaXEax3SZg/photo.jpg?sz=128", "display_name": "Jackson Cunningham", "link": "https://stackoverflow.com/users/4621100/jackson-cunningham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 417, "favorite_count": 0, "accepted_answer_id": 39499880, "answer_count": 1, "score": 0, "last_activity_date": 1473888378, "creation_date": 1473886032, "last_edit_date": 1473886174, "question_id": 39499399, "link": "https://stackoverflow.com/questions/39499399/rails-active-record-get-the-average-value-of-a-column-after-grouping", "title": "Rails &amp; Active Record: Get the average value of a column after grouping", "body": "<p>I have a table user_keywords which :belongs_to :keywords. user_keywords has a column keyword_id, user_id, and relevance_score (float).</p>\n\n<p>keyword table has a column 'name'.</p>\n\n<ol>\n<li>I want to group all the user_keywords by their keyword_id.</li>\n<li>I want to take the average of each of those groups' relevance_score</li>\n<li>I want to sort groups by the highest relevance score</li>\n<li>I want to return the name of the keyword from the groups, sorted by highest relevance score.</li>\n</ol>\n\n<p>What is the most efficient way to query this?</p>\n"}, {"tags": ["ruby", "ruby-on-rails-4", "google-analytics", "google-analytics-api"], "answers": [{"comments": [{"owner": {"reputation": 1436, "user_id": 2096740, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/67b4b0da1074e71906237509810c7eac?s=128&d=identicon&r=PG", "display_name": "arjun", "link": "https://stackoverflow.com/users/2096740/arjun"}, "edited": false, "score": 0, "creation_date": 1473922926, "post_id": 39499430, "comment_id": 66326654, "body": "Is there any alternative you are aware of?"}, {"owner": {"reputation": 905, "user_id": 5648801, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Iyo4e.png?s=128&g=1", "display_name": "emon", "link": "https://stackoverflow.com/users/5648801/emon"}, "reply_to_user": {"reputation": 1436, "user_id": 2096740, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/67b4b0da1074e71906237509810c7eac?s=128&d=identicon&r=PG", "display_name": "arjun", "link": "https://stackoverflow.com/users/2096740/arjun"}, "edited": false, "score": 0, "creation_date": 1607946196, "post_id": 39499430, "comment_id": 115422602, "body": "@arjun Follow this Link: <a href=\"https://stackoverflow.com/questions/44264088/create-a-demo-account-thats-usable-with-the-analytics-reporting-api-google-an\" title=\"create a demo account thats usable with the analytics reporting api google an\">stackoverflow.com/questions/44264088/&hellip;</a>"}], "tags": [], "owner": {"reputation": 4487, "user_id": 3791516, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CaaX7.jpg?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/3791516/matt"}, "is_accepted": false, "score": 2, "last_activity_date": 1473886161, "creation_date": 1473886161, "answer_id": 39499430, "question_id": 39499146, "link": "https://stackoverflow.com/questions/39499146/access-google-analytics-demo-account/39499430#39499430", "title": "Access Google analytics Demo account", "body": "<p>Unfortunately the Analytics Reporting API cannot access the demo account. From the <a href=\"https://support.google.com/analytics/answer/6367342#limitations\" rel=\"nofollow\">docs</a>:</p>\n\n<blockquote>\n  <p>The demo account cannot be used with the Analytics Reporting API.\n  Attempting to access the demo account with the Analytics Reporting API\n  will result in a permissions error: <code>(403) insufficientPermissions</code>.</p>\n</blockquote>\n"}], "owner": {"reputation": 1436, "user_id": 2096740, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/67b4b0da1074e71906237509810c7eac?s=128&d=identicon&r=PG", "display_name": "arjun", "link": "https://stackoverflow.com/users/2096740/arjun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 297, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1473886161, "creation_date": 1473884976, "question_id": 39499146, "link": "https://stackoverflow.com/questions/39499146/access-google-analytics-demo-account", "title": "Access Google analytics Demo account", "body": "<p>Google analytics is offering access <a href=\"https://support.google.com/analytics/answer/6367342?utm_source=GA%20Education&amp;utm_medium=affiliate&amp;utm_content=GA%20blog&amp;utm_campaign=Demo%20Account\" rel=\"nofollow\">Demo account</a>. But is the data available from the API?</p>\n\n<p>I tried testing it for simple pageviews, but I get an error\n<code>insufficientPermissions: User does not have sufficient permissions for this profile.</code>,\neven from the Query Explorer.<br>\nCan someone please confirm its availability and how to properly access it?</p>\n\n<p>It becomes useful to understand all scenarios and build a test app with demo data before putting it public.</p>\n"}, {"tags": ["ruby"], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 7, "last_activity_date": 1473890121, "last_edit_date": 1473890121, "creation_date": 1473884776, "answer_id": 39499101, "question_id": 39498890, "link": "https://stackoverflow.com/questions/39498890/puts-and-times-method-on-numbers/39499101#39499101", "title": "Puts and times method on numbers", "body": "<p>You've got a (quasi) loop within a loop within a loop so Ruby's doing exactly what you're asking of it. The way these loops are evaluated is, generally speaking, from the inside out.</p>\n\n<p>The return value from <code>times</code> is the number given in the first place, so <code>3.times</code> returns <code>3</code>.</p>\n\n<p>With all that in mind you can interpret what's happening as this:</p>\n\n<pre><code>4 # First iteration of 3.times { puts 4 }\n4\n4\n3 # Return value of 3.times displayed\n4 # Second iteration of 3.times { puts 4 }\n4\n4\n3 # Return value of 3.times displayed\n2 # Return value of 2.times displayed\n1 # Return value of 1.times displayed\n</code></pre>\n\n<p>Now when I see code like <code>puts 3.times</code> that's usually a mistake, same goes for <code>puts array.each ...</code> where someone probably means <code>.map</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 145, "user_id": 1950372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d4cdf47ef05c28297883fa65b1afd1?s=128&d=identicon&r=PG", "display_name": "snowbillr", "link": "https://stackoverflow.com/users/1950372/snowbillr"}, "edited": false, "score": 0, "creation_date": 1473946763, "post_id": 39499445, "comment_id": 66340961, "body": "Ah gotcha. Didn&#39;t realize that the <code>times</code> method returns the receiver. Makes sense now. Thanks for the detailed breakdown!"}], "tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": true, "score": 3, "last_activity_date": 1473886239, "creation_date": 1473886239, "answer_id": 39499445, "question_id": 39498890, "link": "https://stackoverflow.com/questions/39498890/puts-and-times-method-on-numbers/39499445#39499445", "title": "Puts and times method on numbers", "body": "<p>I don't really get that output either, so let's dissect it, starting with the innermost expression:</p>\n\n<pre><code>puts 4\n# 4           &lt;- this should denote output\n#=&gt; nil       &lt;- this should denote return value\n</code></pre>\n\n<p>It prints <code>4</code> and returns <code>nil</code> (<a href=\"http://ruby-doc.org/core-2.3.1/Kernel.html#method-i-puts\" rel=\"nofollow\"><code>puts</code></a> always returns <code>nil</code>).</p>\n\n<p>Wrapping it in <code>3.times { ... }</code> prints <code>4</code> 3 times:</p>\n\n<pre><code>3.times { puts 4 }\n# 4\n# 4\n# 4\n#=&gt; 3\n</code></pre>\n\n<p>But instead of returning <code>nil</code>, it returns <code>3</code>. This is because <a href=\"http://ruby-doc.org/core-2.3.1/Integer.html#method-i-times\" rel=\"nofollow\"><code>times</code></a> always returns the receiver (i.e. the integer you call <code>times</code> on).</p>\n\n<p>Now let's add another <code>puts</code>:</p>\n\n<pre><code>puts 3.times { puts 4 }\n# 4\n# 4\n# 4\n# 3\n#=&gt; nil\n</code></pre>\n\n<p>Same as above, but also prints the result of <code>3.times { ... }</code>, i.e. <code>3</code>.</p>\n\n<p>Wrapping everything in <code>2.times { ... }</code> duplicates the above output:</p>\n\n<pre><code>2.times { puts 3.times { puts 4 } }\n# 4\n# 4\n# 4\n# 3\n# 4\n# 4\n# 4\n# 3\n#=&gt; 2\n</code></pre>\n\n<p>It also returns <code>2</code> instead of <code>nil</code> because of <code>2.times { ... }</code>.</p>\n\n<p>Adding <code>puts</code> prints that <code>2</code>:</p>\n\n<pre><code>puts 2.times { puts 3.times { puts 4 } }\n# 4\n# 4\n# 4\n# 3\n# 4\n# 4\n# 4\n# 3\n# 2\n#=&gt; nil\n</code></pre>\n\n<p>Wrapping this in <code>1.times { ... }</code> produces the same output, but changes the result from <code>nil</code> to <code>1</code>:</p>\n\n<pre><code>1.times { puts 2.times { puts 3.times { puts 4 } } }\n# 4\n# 4\n# 4\n# 3\n# 4\n# 4\n# 4\n# 3\n# 2\n#=&gt; 1\n</code></pre>\n\n<p>Adding the last <code>puts</code> prints that <code>1</code>:</p>\n\n<pre><code>puts 1.times { puts 2.times { puts 3.times { puts 4 } } }\n# 4\n# 4\n# 4\n# 3\n# 4\n# 4\n# 4\n# 3\n# 2\n# 1\n#=&gt; nil\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 2, "last_activity_date": 1473899975, "last_edit_date": 1592644375, "creation_date": 1473899975, "answer_id": 39501613, "question_id": 39498890, "link": "https://stackoverflow.com/questions/39498890/puts-and-times-method-on-numbers/39501613#39501613", "title": "Puts and times method on numbers", "body": "<blockquote>\n<p>I guess I'd expect Ruby to output the return value of the <code>times</code> method, but it doesn't seem to do that. It prints out the number that <code>times</code> is being called on.</p>\n</blockquote>\n<p><a href=\"http://ruby-doc.org/core/Integer.html#method-i-times\" rel=\"nofollow noreferrer\">That <em>is</em> the return value of the <code>times</code> method</a>:</p>\n<blockquote>\n<h1><code>times {|i| block }</code> \u2192 <code>self</code></h1>\n</blockquote>\n"}], "owner": {"reputation": 145, "user_id": 1950372, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/96d4cdf47ef05c28297883fa65b1afd1?s=128&d=identicon&r=PG", "display_name": "snowbillr", "link": "https://stackoverflow.com/users/1950372/snowbillr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 1, "accepted_answer_id": 39499445, "answer_count": 3, "score": 7, "last_activity_date": 1475847565, "creation_date": 1473883925, "last_edit_date": 1475847565, "question_id": 39498890, "link": "https://stackoverflow.com/questions/39498890/puts-and-times-method-on-numbers", "title": "Puts and times method on numbers", "body": "<p>This code:</p>\n\n<pre><code>puts 1.times { puts 2.times { puts 3.times { puts 4 } } }\n</code></pre>\n\n<p>Outputs this:</p>\n\n<pre><code>4 4 4 3 4 4 4 3 2 1\n</code></pre>\n\n<p>I would expect Ruby to output the return value of the <code>times</code> method, but it doesn't seem to do that. It prints out the number that <code>times</code> is being called on. What is happening?</p>\n"}, {"tags": ["ruby", "mongodb", "mongodb-ruby"], "answers": [{"tags": [], "owner": {"reputation": 2301, "user_id": 6809935, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Achu.jpg?s=128&g=1", "display_name": "satish chennupati", "link": "https://stackoverflow.com/users/6809935/satish-chennupati"}, "is_accepted": true, "score": 0, "last_activity_date": 1473884571, "creation_date": 1473884571, "answer_id": 39499046, "question_id": 39498677, "link": "https://stackoverflow.com/questions/39498677/finding-the-size-of-a-mongocollectionview/39499046#39499046", "title": "Finding the size of a Mongo::Collection::View", "body": "<pre><code>collection.find({ foo: 'bar' }).count()\n</code></pre>\n\n<p>should solve your problem.  There is no size method available in mongo but there is count.</p>\n"}], "owner": {"reputation": 3, "user_id": 6590135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1628000d17fcc1538882026a0e39157?s=128&d=identicon&r=PG&f=1", "display_name": "Nova Wolf", "link": "https://stackoverflow.com/users/6590135/nova-wolf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 473, "favorite_count": 0, "accepted_answer_id": 39499046, "answer_count": 1, "score": 0, "last_activity_date": 1473884571, "creation_date": 1473883046, "last_edit_date": 1473884527, "question_id": 39498677, "link": "https://stackoverflow.com/questions/39498677/finding-the-size-of-a-mongocollectionview", "title": "Finding the size of a Mongo::Collection::View", "body": "<p>I am trying to find the size of the result of a query in MongoDB and ruby:</p>\n\n<pre><code>size = collection.find({ foo: 'bar' }).size\nif size &gt; 0\n  print \"There are #{size} results!\"\nelse\n  print \"There aren't any results.\"\nend\n</code></pre>\n\n<p>However, when I run this, I get the following error:</p>\n\n<pre><code>undefined method `size' for #&lt;Mongo::Collection::View:0x00000004141d48&gt;\n</code></pre>\n\n<p>How do I determine the number of items returned by this query properly? I couldn't find any information in the documentation.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "owner": {"reputation": 5828, "user_id": 5203069, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cf5b1613b2287cd6b8bf05baa2842b5?s=128&d=identicon&r=PG&f=1", "display_name": "skwidbreth", "link": "https://stackoverflow.com/users/5203069/skwidbreth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 483, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1473903821, "creation_date": 1473880918, "last_edit_date": 1495535631, "question_id": 39498120, "link": "https://stackoverflow.com/questions/39498120/rails-session-variable-lost-between-controller-actions", "title": "Rails - session variable lost between controller actions", "body": "<p><strong>Edit - I misunderstood the exact nature of the problem, have reposted here with a better grasp of the issue: <a href=\"https://stackoverflow.com/questions/39501992/rails-devise-updating-session-variables-between-controller-actions\">Rails / Devise - updating session variables between controller actions</a></strong></p>\n\n<p>I am using a session variable to pass data between three form submission controller actions in my Rails app, but I am having an issue where the process works the first time I run through but fails the second time because the session variable does not pass to a subsequent controller action - however, if I clear my browser history, it works fine (but will fail if I try to repeat without clearing history, etc.). The app uses Devise for user log in, and the problem seems to be related to the session being destroyed on log out.</p>\n\n<p>The session variable in question here is <code>session[:ids]</code>, and it seems that it is not being passed from the <code>submission</code> action to the <code>approval</code> action without first clearing the browser history.</p>\n\n<p>Here are the routes:</p>\n\n<pre><code>post 'report/submission'\nget 'report/approval'\nget 'report/summary' =&gt; 'report#summary'\n</code></pre>\n\n<p>And the associated controller actions (added a few groups of <code>puts</code> to check the variable values in the console):</p>\n\n<pre><code>def submission\n    @incomingReport = ActiveSupport::JSON.decode(params[:report])\n\n    @newReportIDArray = Array.new\n\n    @incomingReport.each do |x|\n        #DATA PROCESSING STUFF HERE\n        @newReportIDArray.push(@new_report.id)\n    end\n\n    session[:ids] = @newReportIDArray\n\n    puts \"submission_marker\"\n    puts @newReportIDArray\n    puts \"submission_marker_end\"\n\n    respond_to do |format|\n      format.json do\n        render json: {\n          success: 200\n        }.to_json\n      end\n    end\nend\n\n#USER LOGIN OCCURS HERE\ndef approval\n    @reportIDs = session[:ids]\n\n    puts \"approval_marker\"\n    puts @reportIDs\n    puts \"approval_marker_end\"\n\n    @reportIDs.each do |x|\n        @new_report = Report.find(x)\n        @new_report.user_id = current_user.id\n        @new_report.save\n    end\n\n    redirect_to report_summary_path\nend\n\n\ndef summary\n    @reportIDs = session[:ids]\n\n    puts \"summary_marker\"\n    puts @reportIDs\n    puts \"summary_marker_end\"\nend\n#USER LOGS OUT AFTER SUMMARY\n</code></pre>\n\n<p>So if I run this with clean history, my console looks like this:</p>\n\n<pre><code>submission_marker\n766\nsubmission_marker_end\n\napproval_marker\n766\napproval_marker_end\n\nsummary_marker\n766\nsummary_marker_end\n</code></pre>\n\n<p>but if I log out after the first <code>summary</code> and then I try to run through the process without clearing the history, I end up with</p>\n\n<pre><code>submission_marker\n767\nsubmission_marker_end\n\napproval_marker\n\napproval_marker_end\n</code></pre>\n\n<p>and the error <code>undefined method 'each' for nil:NilClass</code>, referring to <code>@reportIDs.each</code> in the <code>approval</code> action.</p>\n\n<p>What am I missing here? Why is it that with a clean history, everything runs ok, but with a 'dirty' history, the session variable sets for the <code>submission</code> action but is dropped by/on its way to the <code>approval</code> action?  I see that this has something to do with Devise and the destruction of the session, but I don't understand why I can't create a new session variable.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 3, "creation_date": 1473883454, "post_id": 39498065, "comment_id": 66315034, "body": "Do try and avoid double negatives. Flipping this to a positive test and reversing the order of the <code>puts</code> statements would make this a lot more sensible. If you&#39;re not careful you can end up with triple and quadruple negatives that are real head-spinners."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1473898148, "post_id": 39498065, "comment_id": 66320177, "body": "This is awful code. Further to @tadman&#39;s comment, isn&#39;t this a lot clearer: <code>@two = [nil, 2].sample; puts @two ? @two : &quot;there was an error&quot;</code>."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1473909230, "post_id": 39498065, "comment_id": 66322478, "body": "Even better would be to write a method like <code>def coin_flip; [ :heads, :tails ].sample; end</code> and then <code>if (coin_flip == :heads)</code> which conveys more of what&#39;s going on here."}], "answers": [{"comments": [{"owner": {"reputation": 3050, "user_id": 1810434, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/498Wj.png?s=128&g=1", "display_name": "Joe Essey", "link": "https://stackoverflow.com/users/1810434/joe-essey"}, "edited": false, "score": 0, "creation_date": 1473881026, "post_id": 39498129, "comment_id": 66313844, "body": "&quot;If it&#39;s truthy...&quot;  Does that mean if the right side of the assignment is truthy?"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 3050, "user_id": 1810434, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/498Wj.png?s=128&g=1", "display_name": "Joe Essey", "link": "https://stackoverflow.com/users/1810434/joe-essey"}, "edited": false, "score": 0, "creation_date": 1473881078, "post_id": 39498129, "comment_id": 66313874, "body": "@JoeEssey you assing <code>@two</code> in both cases. It is the matter of the assigned value - truthy one (<code>2</code>) or falsy (<code>nil</code>)"}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": true, "score": 2, "last_activity_date": 1473881028, "last_edit_date": 1473881028, "creation_date": 1473880951, "answer_id": 39498129, "question_id": 39498065, "link": "https://stackoverflow.com/questions/39498065/conditional-assignment-in-ruby/39498129#39498129", "title": "Conditional assignment in Ruby", "body": "<p>It basically leans on Ruby's <em>falsy</em> objects: <code>nil</code> and <code>false</code>.</p>\n\n<p>Everything except for <code>nil</code> and <code>false</code> is said to be <em>truthy</em> in Ruby.</p>\n\n<p>So in the example it prints the value of <code>@two</code> if it's <em>truthy</em> (2), otherwise (<code>nil</code>) it prints the error message.</p>\n\n<p>I do not think this \"concept\" has a name.</p>\n"}, {"tags": [], "owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "is_accepted": false, "score": 1, "last_activity_date": 1473881076, "creation_date": 1473881076, "answer_id": 39498160, "question_id": 39498065, "link": "https://stackoverflow.com/questions/39498065/conditional-assignment-in-ruby/39498160#39498160", "title": "Conditional assignment in Ruby", "body": "<p>Nothing special here, it's equivalent to:</p>\n\n<pre><code>@two = [nil, 2].sample\n\nif !@two\n  puts 'there was an error'\nelse\n  puts @two\nend\n</code></pre>\n\n<p><code>@two = [nil, 2].sample</code> returns a random element from <code>[nil, 2]</code>, i.e. either <code>nil</code> or <code>2</code>, and assigns it to the instance variable <code>@two</code>.</p>\n\n<p>The conditional should be self-explanatory.</p>\n"}, {"comments": [{"owner": {"reputation": 3050, "user_id": 1810434, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/498Wj.png?s=128&g=1", "display_name": "Joe Essey", "link": "https://stackoverflow.com/users/1810434/joe-essey"}, "edited": false, "score": 0, "creation_date": 1473884199, "post_id": 39498561, "comment_id": 66315419, "body": "This is what I was looking for.  I tested it and it worked, but it seemed just off.  Nice to see the style guide addresses this."}], "tags": [], "owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "is_accepted": false, "score": 1, "last_activity_date": 1473882583, "creation_date": 1473882583, "answer_id": 39498561, "question_id": 39498065, "link": "https://stackoverflow.com/questions/39498065/conditional-assignment-in-ruby/39498561#39498561", "title": "Conditional assignment in Ruby", "body": "<p>The practice of using the value of an assignment expression in a conditional doesn't really have a <em>name</em>, per se, but the practice of wrapping the assignment in parenthesis is called <a href=\"https://github.com/bbatsov/ruby-style-guide#safe-assignment-in-condition\" rel=\"nofollow\">\"Safe assignment in condition\"</a>, which is something you should adopt if you're writing code like this.</p>\n"}], "owner": {"reputation": 3050, "user_id": 1810434, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/498Wj.png?s=128&g=1", "display_name": "Joe Essey", "link": "https://stackoverflow.com/users/1810434/joe-essey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 489, "favorite_count": 0, "accepted_answer_id": 39498129, "answer_count": 3, "score": 1, "last_activity_date": 1473882583, "creation_date": 1473880656, "question_id": 39498065, "link": "https://stackoverflow.com/questions/39498065/conditional-assignment-in-ruby", "title": "Conditional assignment in Ruby", "body": "<p>I'm working on a project with several instances of the following pattern that I am not familiar with.  I don't know what to call it so I can't find any docs on it.  What is the following concept?</p>\n\n<pre><code>if !@two = [nil, 2].sample\n  puts 'there was an error'\nelse\n  puts @two\nend\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["arrays", "ruby", "sorting"], "answers": [{"comments": [{"owner": {"reputation": 4265, "user_id": 4601088, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bN143.jpg?s=128&g=1", "display_name": "Bart\u0142omiej G\u0142adys", "link": "https://stackoverflow.com/users/4601088/bart%c5%82omiej-g%c5%82adys"}, "reply_to_user": {"reputation": 384, "user_id": 3395272, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/jRH8Q.jpg?s=128&g=1", "display_name": "remonses", "link": "https://stackoverflow.com/users/3395272/remonses"}, "edited": false, "score": 1, "creation_date": 1473878724, "post_id": 39497292, "comment_id": 66312624, "body": "Did you try my last update, with <code>values_at</code> method ?"}, {"owner": {"reputation": 384, "user_id": 3395272, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/jRH8Q.jpg?s=128&g=1", "display_name": "remonses", "link": "https://stackoverflow.com/users/3395272/remonses"}, "edited": false, "score": 0, "creation_date": 1473878940, "post_id": 39497292, "comment_id": 66312748, "body": "Was unaware of values_at API. Brilliant and thanks for the prompt reply!"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1473882082, "post_id": 39497292, "comment_id": 66314365, "body": "There may be less to sort if you <code>uniq</code> before <code>sort</code> (and there&#39;s no reason to think <code>uniq</code> will be faster by doing it second)."}, {"owner": {"reputation": 4265, "user_id": 4601088, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bN143.jpg?s=128&g=1", "display_name": "Bart\u0142omiej G\u0142adys", "link": "https://stackoverflow.com/users/4601088/bart%c5%82omiej-g%c5%82adys"}, "edited": false, "score": 0, "creation_date": 1473882266, "post_id": 39497292, "comment_id": 66314447, "body": "What if i use uniq and delete element with more sortOrder ?"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1473882477, "post_id": 39497292, "comment_id": 66314555, "body": "...but my suggestion does affect which elements are selected by <code>uniq</code>, which may be important (don&#39;t know from the question)."}, {"owner": {"reputation": 4265, "user_id": 4601088, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bN143.jpg?s=128&g=1", "display_name": "Bart\u0142omiej G\u0142adys", "link": "https://stackoverflow.com/users/4601088/bart%c5%82omiej-g%c5%82adys"}, "edited": false, "score": 0, "creation_date": 1473883588, "post_id": 39497292, "comment_id": 66315116, "body": "About performance you are definitely right, but i think, he want keep object with smallest <code>:sortOrder</code>"}, {"owner": {"reputation": 384, "user_id": 3395272, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/jRH8Q.jpg?s=128&g=1", "display_name": "remonses", "link": "https://stackoverflow.com/users/3395272/remonses"}, "edited": false, "score": 0, "creation_date": 1473963192, "post_id": 39497292, "comment_id": 66351203, "body": "&#39;hashForAnimals.uniq{ |k| [k[:animalCd], k[:animalType]] }.sort_by{ |a| a[:sortOrder] }&#39; is more simpler and faster. For objects, we would require dot notations and for that sort and uniq separately."}], "tags": [], "owner": {"reputation": 4265, "user_id": 4601088, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bN143.jpg?s=128&g=1", "display_name": "Bart\u0142omiej G\u0142adys", "link": "https://stackoverflow.com/users/4601088/bart%c5%82omiej-g%c5%82adys"}, "is_accepted": true, "score": 3, "last_activity_date": 1473878286, "last_edit_date": 1473878286, "creation_date": 1473877740, "answer_id": 39497292, "question_id": 39497251, "link": "https://stackoverflow.com/questions/39497251/sort-an-array-and-make-it-unique-on-multiple-conditions-ruby/39497292#39497292", "title": "Sort an array and make it unique on multiple conditions - Ruby", "body": "<p>you can use <code>sort_by</code> method and <code>uniq</code> and <code>values_at</code></p>\n\n<pre><code>hashForAnimals.sort_by{ |a| a[:sortOrder] }.uniq{ |k| k.values_at(:animalCd, :animalType) }\n\n\n# =&gt; [{:animalCd=&gt;\"Cow\", :animalType=&gt;\"Carnivore\", :sortOrder=&gt;1}, {:animalCd=&gt;\"Rabbit\", :animalType=&gt;\"Herbivore\", :sortOrder=&gt;2}, {:animalCd=&gt;\"Tiger\", :animalType=&gt;\"Carnivore\", :sortOrder=&gt;3}, {:animalCd=&gt;\"Shark\", :animalType=&gt;\"Carnivore\", :sortOrder=&gt;4}, {:animalCd=&gt;\"Cow\", :animalType=&gt;\"Herbivore\", :sortOrder=&gt;5}, {:animalCd=&gt;\"Bear\", :animalType=&gt;\"Omnivore\", :sortOrder=&gt;7}]\n</code></pre>\n"}], "owner": {"reputation": 384, "user_id": 3395272, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/jRH8Q.jpg?s=128&g=1", "display_name": "remonses", "link": "https://stackoverflow.com/users/3395272/remonses"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 666, "favorite_count": 0, "accepted_answer_id": 39497292, "answer_count": 1, "score": 2, "last_activity_date": 1473878286, "creation_date": 1473877609, "question_id": 39497251, "link": "https://stackoverflow.com/questions/39497251/sort-an-array-and-make-it-unique-on-multiple-conditions-ruby", "title": "Sort an array and make it unique on multiple conditions - Ruby", "body": "<p>This is a sample array example as Input :</p>\n\n<pre><code>hashForAnimals = [{ \n    :animalCd=&gt;\"Tiger\",:animalType=&gt;\"Carnivore\", :sortOrder =&gt;3},\n    {:animalCd=&gt;\"Cow\",:animalType=&gt;\"Herbivore\", :sortOrder =&gt;5},\n    {:animalCd=&gt;\"Rabbit\", :animalType=&gt;\"Herbivore\", :sortOrder =&gt;2}, \n    {:animalCd=&gt;\"Shark\",:animalType=&gt;\"Carnivore\", :sortOrder =&gt;4}, \n    {:animalCd=&gt;\"Cow\",:animalType=&gt;\"Carnivore\", :sortOrder =&gt;1},\n    {:animalCd=&gt;\"Bear\", :animalType=&gt;\"Omnivore\", :sortOrder =&gt;7},\n    {:animalCd=&gt;\"Tiger\",:animalType=&gt;\"Carnivore\", :sortOrder =&gt;6}]\n</code></pre>\n\n<p>Expected Output:</p>\n\n<pre><code>hashForAnimals = [{\n  :animalCd=&gt;\"Cow\", :animalType=&gt;\"Carnivore\",  :sortOrder =&gt;1},\n  {:animalCd=&gt;\"Rabbit\", :animalType=&gt;\"Herbivore\", :sortOrder =&gt;2},\n  {:animalCd=&gt;\"Tiger\",:animalType=&gt;\"Carnivore\", :sortOrder =&gt;3},\n  {:animalCd=&gt;\"Shark\",:animalType=&gt;\"Carnivore\", :sortOrder =&gt;4},\n  :animalCd=&gt;\"Cow\", :animalType=&gt;\"Herbivore\",  :sortOrder =&gt;5}\n  {:animalCd=&gt;\"Bear\", :animalType=&gt;\"Omnivore\", :sortOrder =&gt;7}]\n</code></pre>\n\n<p>I need to sort the array on the basis of sort order and then I need to make the array unique with respect to animalCd falling under the same group i.e. animalType.</p>\n\n<p>Tiger has appeared once with the minimum sort order, however Cow is appearing twice in the array but with different animalType.</p>\n\n<p>It can be done by collecting the array into multiple animalType arrays and sorting and making them unique and merge back to a single array. However, I need an elegant solution for this.</p>\n\n<p>Sample code that I'm trying:</p>\n\n<pre><code>hashForAnimals.sort!{|x,y| x[:sortOrder].to_i&lt;=&gt;y[:sortOrder].to_i}.group_by { |a| a[:animalType]}\n</code></pre>\n\n<p>I can group them into seperate hashes but then I need to make the individual hashes unique and then merge into the array.</p>\n\n<p>Is this even possible in the way by which I'm approaching it?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 25272, "user_id": 1695163, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/85ffb58dc3ed0067128804ef843245a6?s=128&d=identicon&r=PG", "display_name": "ddavison", "link": "https://stackoverflow.com/users/1695163/ddavison"}, "edited": false, "score": 0, "creation_date": 1473877351, "post_id": 39497143, "comment_id": 66311891, "body": "the java equivalent is &quot;this&quot; as it is in many other languages"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1473879175, "post_id": 39497143, "comment_id": 66312880, "body": "<code>self</code> refers to the current context which is always an object but might be a class or instance depending on where the code is defined."}], "owner": {"reputation": 43, "user_id": 5739718, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T5aEJIQnyfk/AAAAAAAAAAI/AAAAAAAAABg/P_Z18q3Js5s/photo.jpg?sz=128", "display_name": "ashan priyadarshana", "link": "https://stackoverflow.com/users/5739718/ashan-priyadarshana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "closed_date": 1473877911, "answer_count": 0, "score": 0, "last_activity_date": 1473877244, "creation_date": 1473877244, "question_id": 39497143, "link": "https://stackoverflow.com/questions/39497143/meaning-of-self-keyword-in-ruby", "closed_reason": "Duplicate", "title": "Meaning of self keyword in ruby", "body": "<p>Is the keyword self in ruby is some thing like this keyword in java. If yes, could any one help me to grab the concept of it. Is it calling the current object? What's the point of calling an object?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "security", "devise", "token"], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 5998449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50dcd3ce27bb6428f5e052a47710be4b?s=128&d=identicon&r=PG", "display_name": "Steffen", "link": "https://stackoverflow.com/users/5998449/steffen"}, "edited": false, "score": 0, "creation_date": 1474127087, "post_id": 39515512, "comment_id": 66409470, "body": "Thanks a lot for your opinions on this! And yeah you are absolutely right about using context with each GlobalID with the &quot;for: &#39;...&#39;&quot; option, e.g. I differ between <code>account_confirmation</code> and <code>reset_password</code>. When storing digest in the DB (not the token) it is also not possible to &quot;see&quot; the token - but your point about revoking is a good point ... I therefore use the <code>expire_in</code> to ensure links a are not valid to long - but complete revoking would not be possible."}], "tags": [], "owner": {"reputation": 28574, "user_id": 413180, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0cdd5f87ab5befb4da47ebf6d77854e0?s=128&d=identicon&r=PG", "display_name": "SilverlightFox", "link": "https://stackoverflow.com/users/413180/silverlightfox"}, "is_accepted": false, "score": 1, "last_activity_date": 1473954988, "creation_date": 1473954988, "answer_id": 39515512, "question_id": 39496190, "link": "https://stackoverflow.com/questions/39496190/signed-global-ids-for-authentication-tokens-secure-or-vulnerable/39515512#39515512", "title": "Signed Global IDs for Authentication Tokens - secure or vulnerable?", "body": "<blockquote>\n  <p>is the Signed Global ID token secure or vulnerable against specific attacks?</p>\n</blockquote>\n\n<p>The Signed Global ID appears to use <a href=\"http://api.rubyonrails.org/classes/ActiveSupport/MessageVerifier.html\" rel=\"nofollow\"><code>MessageVerifier</code></a>:</p>\n\n<blockquote>\n  <p>MessageVerifier creates HMAC signatures using SHA1 hash algorithm </p>\n</blockquote>\n\n<p><a href=\"http://api.rubyonrails.org/classes/ActiveSupport/MessageVerifier.html\" rel=\"nofollow\">HMAC over SHA1 is still considered secure</a>.</p>\n\n<blockquote>\n  <p>any disadvantage of not saving tokens/digest + sent_at into DB?</p>\n</blockquote>\n\n<p>The main disadvantage in general is there is no way for you to revoke these server-side. For example, if a user logs out or if you wish to expire all sessions for a particular user.</p>\n\n<p>Also make sure there is some context saved within each Global ID. That is, a user with a forgotten password Signed ID should not be able to use it for an authentication token.</p>\n\n<blockquote>\n  <p>sgid_tokens get up to around 200+ chars, so links get quite long, any\n  problems about this?</p>\n</blockquote>\n\n<p>Not in particular, no.</p>\n\n<blockquote>\n  <p>other reasons why not using Signed Global ID but therefore\n  tokens/digests?</p>\n</blockquote>\n\n<p>Mainly the fact you can't see them or revoke them server-side as mentioned above. You should also ensure you are using a strong key (>= 128 bits) and this key remains private. Any leakage of the key compromises all tokens and allows an attacker to generate their own.</p>\n"}], "owner": {"reputation": 81, "user_id": 5998449, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50dcd3ce27bb6428f5e052a47710be4b?s=128&d=identicon&r=PG", "display_name": "Steffen", "link": "https://stackoverflow.com/users/5998449/steffen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 295, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1473954988, "creation_date": 1473873305, "question_id": 39496190, "link": "https://stackoverflow.com/questions/39496190/signed-global-ids-for-authentication-tokens-secure-or-vulnerable", "title": "Signed Global IDs for Authentication Tokens - secure or vulnerable?", "body": "<p>I found that <em>Signed Global IDs</em> are awesome for token based stuff like <strong>reset password</strong> and <strong>account confirmation</strong> functions and would love to get opinions about its security and usability.</p>\n\n<p>Common ways besides using the Devise gem (module Confirmable + Recoverable) is </p>\n\n<p>A) generate tokens (e.g. <code>d3f64ce7c125410498b5393b33e7cf3c</code>), save them in the DB and send links to <code>/account_confirmation/#token#</code></p>\n\n<p>B) saving digests of these tokens in the DB and only sending the tokens in mails - than compare them with <code>BCrypt::Password.new(digest).is_password?(token)</code>. This more secure approach is what <a href=\"https://www.railstutorial.org/book/account_activation\" rel=\"nofollow\">Michael Hartl</a> is using in his Rails Tutorial.   </p>\n\n<hr>\n\n<p><strong>C. But what about Signed Global IDs?!</strong></p>\n\n<p>Since Rails 4.2 the <a href=\"https://github.com/rails/globalid\" rel=\"nofollow\">Global ID Gem</a> is included in Rails, manly used for ActiveJobs. That is how I now use them for e.g. account confirmation stuff:</p>\n\n<p>Include <code>GlobalID::Identification</code> in your User Model, than:</p>\n\n<pre><code>&gt;&gt; user_sgid = User.last.to_sgid(expires_in: 2.hours, for: 'confirmation')\n=&gt; #&lt;SignedGlobalID:0x008fde45df8937\n\n&gt;&gt; sgid_token = user_sgid.to_s\n=&gt; \"BAhJIh5naWQ6Ly9pZGluYWlkaS9Vc2VyLzM5NTk5BjoGRVQ=--81d73[...]20e\"\n</code></pre>\n\n<p>This token you can send via email with a account confirmation link to your users, <code>/account_confirmation/##sgid_token##</code>.</p>\n\n<p>There is no need saving <code>account_confirmation_token</code> or a digest of it in the DB. Also you do not need to save <code>account_confirmation_sent_at</code> Timestamp to check if the link is still valid - all is included in the sgid_token:</p>\n\n<pre><code>&gt;&gt; GlobalID::Locator.locate_signed(sgid_token, for: 'confirmation')\n=&gt; #&lt;User:0x007fae94bf6298 @id=\"1\"&gt;\n# use the User model to activate the account, login, and so on\n\n# 2 hours later if link expired:\n&gt;&gt; GlobalID::Locator.locate_signed(sgid_token, for: 'confirmation')\n=&gt; nil\n</code></pre>\n\n<p>You can send multiple links with different tokens, different expiration times and use cases. I love this approach.</p>\n\n<p>More information in the gem description on github.</p>\n\n<hr>\n\n<p><strong>My questions:</strong></p>\n\n<ul>\n<li>is the Signed Global ID token secure or vulnerable against specific attacks?</li>\n<li>any disadvantage of not saving tokens/digest + sent_at into DB?</li>\n<li>sgid_tokens get up to around 200+ chars, so links get quite long, any problems about this? </li>\n<li>other reasons why not using Signed Global ID but therefore tokens/digests?</li>\n</ul>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 6436551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf1af838a86ef07ebaf80d6f675a8e0e?s=128&d=identicon&r=PG&f=1", "display_name": "a.p", "link": "https://stackoverflow.com/users/6436551/a-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1473962091, "last_edit_date": 1473962091, "creation_date": 1473961703, "answer_id": 39517323, "question_id": 39496188, "link": "https://stackoverflow.com/questions/39496188/how-to-set-instance-name-database-in-ruby-configuration/39517323#39517323", "title": "How to set instance name database in ruby configuration", "body": "<p>I found a solution:</p>\n\n<p>install:\nunixodbc\nunixodbc-bin\nunixodbc-dev</p>\n\n<pre><code>  sudo apt-get install unixodbc unixodbc-bin unixodbc-dev\n</code></pre>\n\n<p>uninstall\nfreetds-bin<br>\nfreetds-dev<br>\nfreetds-common</p>\n\n<pre><code>sudo apt-get purge freetds-bin freetds-dev freetds-common\n</code></pre>\n\n<p>download freetds current and install:</p>\n\n<pre><code>tar -xzf freetds-patched.tar.gz\ncd freetds-1.00.15/\n./configure\nmake\nsudo make install\n</code></pre>\n\n<p>I discovered the dinamic port of my db instance trough this query:</p>\n\n<pre><code>SELECT local_tcp_port\nFROM   sys.dm_exec_connections\nWHERE  session_id = @@SPID\n</code></pre>\n\n<p>and change database.yml config adding this port instead default 1433</p>\n\n<pre><code>development:\n  &lt;&lt;: *default\n  host: 10.10.10.10\n  username: myuser\n  password: mypwd\n  port: 58891\n</code></pre>\n\n<p>after that I run:</p>\n\n<pre><code>rake db:migrate\n</code></pre>\n\n<p>Everything worked fine</p>\n"}], "owner": {"reputation": 11, "user_id": 6436551, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf1af838a86ef07ebaf80d6f675a8e0e?s=128&d=identicon&r=PG&f=1", "display_name": "a.p", "link": "https://stackoverflow.com/users/6436551/a-p"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 441, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1473962091, "creation_date": 1473873298, "last_edit_date": 1473875817, "question_id": 39496188, "link": "https://stackoverflow.com/questions/39496188/how-to-set-instance-name-database-in-ruby-configuration", "title": "How to set instance name database in ruby configuration", "body": "<p>My app (ruby on rails) is in linux and I need connect in a Sql Server database. </p>\n\n<p>Testing in command line I get:</p>\n\n<pre><code>$tsql -LH 10.10.10.10\n\n  ServerName MYCOMPSRV10\nInstanceName SQL2008R2\n IsClustered No\n     Version 10.50.4000.0\n         tcp 58891\n</code></pre>\n\n<p>And I can access database in command line using:</p>\n\n<pre><code> $tsql -S 10.10.10.10\\\\SQL2008R2 -U username\n</code></pre>\n\n<p>So, in my Ruby on Rails app I have database.yml with this code:</p>\n\n<pre><code>development:\n  adapter: sqlserver\n  host: 10.10.10.10\n  database: MyDatabase\n  username: username\n  password: password\n  port: 1433 \n  pool: 5\n  timeout: 5000 \n</code></pre>\n\n<p>But when I try run the app I get:</p>\n\n<pre><code>TinyTds::Error: Unable to connect: Adaptive Server is unavailable or does not exist\n</code></pre>\n\n<p>If I change config an try to add Database Instance Name:</p>\n\n<pre><code>development:\n  adapter: sqlserver\n  host: '10.10.10.10\\SQL2008R2'\n  database: MyDatabase\n  username: username\n  password: password\n  port: 1433 \n  pool: 5\n  timeout: 5000 \n</code></pre>\n\n<p>And try run the App:</p>\n\n<pre><code>TinyTds::Error: Server name not found in configuration files\n</code></pre>\n\n<p>I did a research and don't found how to solve this problem. I even don't found how to set the instance name of database.\nCan someone help me ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "whitespace", "strip"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1473871880, "post_id": 39495795, "comment_id": 66309062, "body": "Are you able to provide the source or an example from it?"}, {"owner": {"reputation": 24966, "user_id": 2001031, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bd4f0d39f82be9c22f6f01c80d7ad800?s=128&d=identicon&r=PG", "display_name": "Neil Slater", "link": "https://stackoverflow.com/users/2001031/neil-slater"}, "edited": false, "score": 1, "creation_date": 1473872763, "post_id": 39495795, "comment_id": 66309524, "body": "Not replicating your fault when I try, so whatever kind of space character is in there has not been copied to your question. Could you add the results of <code>test.bytes</code> and <code>test.encoding</code> to the question?"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1473874286, "post_id": 39495795, "comment_id": 66310339, "body": "The &quot;space&quot; is a non-breaking space, AKA <code>&quot;\\xa021&quot;</code>."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 3, "creation_date": 1473874972, "post_id": 39495795, "comment_id": 66310723, "body": "When asking about invisible characters it&#39;s important to provide a way for people to easily replicate the problem. We <i>can</i> edit the question and select the text from there but that&#39;s tribal knowledge and a lot of people don&#39;t think of that. Instead, provide a string assignment that will recreate the actual string. This is all part of creating a question that fits &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 2, "creation_date": 1473872871, "post_id": 39496071, "comment_id": 66309580, "body": "But <code>\\s</code> is still only ASCII-aware and <code>String#strip</code> will take care of any ASCII whitespace."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1473874397, "post_id": 39496071, "comment_id": 66310403, "body": "<code>\\s</code> and <code>\\S</code> are not sufficient to catch unicode characters. They&#39;re defined in <a href=\"http://ruby-doc.org/core-2.3.1/Regexp.html#class-Regexp-label-Character+Classes\" rel=\"nofollow noreferrer\">ruby-doc.org/core-2.3.1/&hellip;</a>"}], "tags": [], "owner": {"reputation": 13378, "user_id": 1430810, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v669u.jpg?s=128&g=1", "display_name": "arieljuod", "link": "https://stackoverflow.com/users/1430810/arieljuod"}, "is_accepted": false, "score": -2, "last_activity_date": 1473872750, "creation_date": 1473872750, "answer_id": 39496071, "question_id": 39495795, "link": "https://stackoverflow.com/questions/39495795/foolproof-way-to-strip-whitespace-from-a-ruby-variable/39496071#39496071", "title": "Foolproof way to strip whitespace from a Ruby variable?", "body": "<p>Try with a regexp</p>\n\n<pre><code>test.gsub(/\\A\\s*(\\S(.*\\S)?)?\\s*\\z/,'\\1')\n</code></pre>\n\n<p>The weird (\\S(.<em>\\S)?)? part at the middle catches the text between \\A\\s</em> &lt;- white spaces at the beginning and \\s*\\z &lt;- white spaces at the end</p>\n"}, {"tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": true, "score": 5, "last_activity_date": 1552600647, "last_edit_date": 1552600647, "creation_date": 1473872787, "answer_id": 39496081, "question_id": 39495795, "link": "https://stackoverflow.com/questions/39495795/foolproof-way-to-strip-whitespace-from-a-ruby-variable/39496081#39496081", "title": "Foolproof way to strip whitespace from a Ruby variable?", "body": "<p>You probably have a non-ASCII Unicode whitespace character, most likely 0x00A0:</p>\n\n<pre><code>&gt; test = \"\\u00A021\"\n =&gt; \"\u00a021\" \n&gt; test.strip\n =&gt; \"\u00a021\" \n</code></pre>\n\n<p>and <a href=\"https://ruby-doc.org/core/String.html#method-i-strip\" rel=\"nofollow noreferrer\"><code>String#strip</code></a> only (currently) knows about ASCII whitespace:</p>\n\n<blockquote>\n  <p><strong>strip \u2192 new_str</strong><br>\n  [...]</p>\n  \n  <p>Whitespace is defined as any of the following characters: null, horizontal tab, line feed, vertical tab, form feed, carriage return, space.</p>\n</blockquote>\n\n<p>You can do it by hand with <a href=\"https://ruby-doc.org/core/String.html#method-i-gsub\" rel=\"nofollow noreferrer\"><code>String#gsub</code></a> and the <a href=\"https://ruby-doc.org/core/Regexp.html#class-Regexp-label-Character+Properties\" rel=\"nofollow noreferrer\"><code>Space</code> character property</a>:</p>\n\n<pre><code>&gt; test = \"\\u00A0 21 \\t\\u00a0\"\n =&gt; \"\u00a0 21 \\t\u00a0\" \n&gt; test.gsub(/\\A\\p{Space}+|\\p{Space}+\\z/, '')\n =&gt; \"21\" \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": false, "score": 2, "last_activity_date": 1473875513, "last_edit_date": 1473875513, "creation_date": 1473874679, "answer_id": 39496529, "question_id": 39495795, "link": "https://stackoverflow.com/questions/39495795/foolproof-way-to-strip-whitespace-from-a-ruby-variable/39496529#39496529", "title": "Foolproof way to strip whitespace from a Ruby variable?", "body": "<p>You can't use the normal <code>\\s</code> or <code>\\S</code> to handle extended characters in UTF-8 or Unicode. Instead I'd do something like this:</p>\n\n<pre><code>\" 21\".gsub(/[[:space:]]+/, '') # =&gt; \"21\"\n</code></pre>\n\n<p>or maybe:</p>\n\n<pre><code>\" 21\".gsub(/[[:blank:]]+/, '')\n</code></pre>\n\n<p>See \"<a href=\"http://ruby-doc.org/core-2.3.1/Regexp.html#class-Regexp-label-Character+Classes\" rel=\"nofollow\">Character Classes</a>\" in the Regexp documentation.</p>\n\n<p>You can figure out what a character is by using <code>ord.to_s(16)</code> on it:</p>\n\n<pre><code>&gt;&gt; test = \"\u00a021\"\n\"\u00a021\"\n&gt;&gt; test.ord\n160\n&gt;&gt; test.ord.to_s(16)\n\"a0\"\n&gt;&gt; test[0].ord.to_s(16)\n\"a0\"\n</code></pre>\n\n<p>Or by looking at it in an editor that can show the actual ordinal value, such as Vim.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6447029"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1005, "favorite_count": 0, "accepted_answer_id": 39496081, "answer_count": 3, "score": 2, "last_activity_date": 1552600647, "creation_date": 1473871742, "last_edit_date": 1473872165, "question_id": 39495795, "link": "https://stackoverflow.com/questions/39495795/foolproof-way-to-strip-whitespace-from-a-ruby-variable", "title": "Foolproof way to strip whitespace from a Ruby variable?", "body": "<p>I'm using Ruby on Rails 4.2.7.  I'm having trouble stripping off white space from a variable. I can't tell what kind of white space it is. Is there a foolproof strip method?  When I cut and paste from a certain variable I\u2019m unable to strip the white space but, when I type the space, then everything is okay. See my console below:</p>\n\n<pre><code>2.3.0 :004 &gt;   test = \"\u00a021\"\n =&gt; \"\u00a021\" \n2.3.0 :005 &gt; test.strip\n =&gt; \"\u00a021\" \n</code></pre>\n\n<p>I have cut and paste from another source and the white space isn\u2019t being stripped off.  Is there a way I can have some kind of foolproof strip method for my variables?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "postgresql", "heroku"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 6773248, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/776b43c71d13c7e1e2440dde8568cff7?s=128&d=identicon&r=PG&f=1", "display_name": "Tellimi", "link": "https://stackoverflow.com/users/6773248/tellimi"}, "edited": false, "score": 0, "creation_date": 1473872270, "post_id": 39495630, "comment_id": 66309261, "body": "this ? the following line come from my database.yaml  :   database: DATABASE_URL. and i have a password on Heroku postgres settings, i tried to put it into the password &quot;field&quot;. nothing happend still &quot;no password supplied&quot;"}], "tags": [], "owner": {"reputation": 876, "user_id": 1178968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d574942e2627e5a01262657dda8a299?s=128&d=identicon&r=PG", "display_name": "acrogenesis", "link": "https://stackoverflow.com/users/1178968/acrogenesis"}, "is_accepted": false, "score": 0, "last_activity_date": 1473871096, "creation_date": 1473871096, "answer_id": 39495630, "question_id": 39495558, "link": "https://stackoverflow.com/questions/39495558/rails-heroku-no-password-supplied/39495630#39495630", "title": "rails - heroku no password supplied", "body": "<p>When using Heroku you should set an ENV variable called <code>DATABASE_URL</code> that will take precedence over whatever you add on the database.yml</p>\n"}], "owner": {"reputation": 79, "user_id": 6773248, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/776b43c71d13c7e1e2440dde8568cff7?s=128&d=identicon&r=PG&f=1", "display_name": "Tellimi", "link": "https://stackoverflow.com/users/6773248/tellimi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 238, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473871096, "creation_date": 1473870830, "question_id": 39495558, "link": "https://stackoverflow.com/questions/39495558/rails-heroku-no-password-supplied", "title": "rails - heroku no password supplied", "body": "<p>I check on internet but every answer to this problem failed on my case.\nI'm using ruby on rail and Heroku on Cloud 9 IDE. everything is up to date. </p>\n\n<p>I try to link the Ruby project to Heroku postgres (Postgresql). i followed postgres guide to first understand how it work but when i try to access my localhost, i get this message : <code>fe_sendauth: no password supplied</code> </p>\n\n<p>I modified pg_hba.conf but it failed so I remove changes</p>\n\n<pre><code>local   all             postgres                                peer\nlocal   all             all                                     peer\nhost    all             all             127.0.0.1/32            md5\nhost    all             all             ::1/128                 md5\n</code></pre>\n\n<p>in the postgresql.conf I replace Localhost by *</p>\n\n<pre><code>listen_addresses = '*'\n</code></pre>\n\n<p>on database.yaml i tried to let password empty. currentrly, in production and developpement i let it with \"\" empty</p>\n\n<pre><code>password: \"\"\n</code></pre>\n\n<p>I tried <code>sudo service postgresql restart</code> but still nothing, the issue is still here</p>\n\n<p>I don't know what can i do after that </p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 3612, "user_id": 2865270, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/1198391393/picture?type=large", "display_name": "Fred Willmore", "link": "https://stackoverflow.com/users/2865270/fred-willmore"}, "reply_to_user": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1473871860, "post_id": 39495447, "comment_id": 66309053, "body": "I&#39;m not creating the class in the initializer, I&#39;m trying to reopen it and add a method. Its my understanding that Ruby allows this"}, {"owner": {"reputation": 3612, "user_id": 2865270, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/1198391393/picture?type=large", "display_name": "Fred Willmore", "link": "https://stackoverflow.com/users/2865270/fred-willmore"}, "reply_to_user": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1473872391, "post_id": 39495447, "comment_id": 66309331, "body": "The initializer is not executed first. The class already exists when the initializer runs."}, {"owner": {"reputation": 3612, "user_id": 2865270, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/1198391393/picture?type=large", "display_name": "Fred Willmore", "link": "https://stackoverflow.com/users/2865270/fred-willmore"}, "reply_to_user": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1473873247, "post_id": 39495447, "comment_id": 66309763, "body": "I put a debugger statement at the top of the file. In the debugger I can query <code>Thing.superclass</code> and I get ActiveRecord::Base. I can create an instance of Thing and call test_field on it."}], "answers": [{"comments": [{"owner": {"reputation": 3612, "user_id": 2865270, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/1198391393/picture?type=large", "display_name": "Fred Willmore", "link": "https://stackoverflow.com/users/2865270/fred-willmore"}, "edited": false, "score": 0, "creation_date": 1473871769, "post_id": 39495624, "comment_id": 66308999, "body": "I get the same result if I use <code>class Thing &lt; ActiveRecord::Base</code>"}], "tags": [], "owner": {"reputation": 4265, "user_id": 4601088, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bN143.jpg?s=128&g=1", "display_name": "Bart\u0142omiej G\u0142adys", "link": "https://stackoverflow.com/users/4601088/bart%c5%82omiej-g%c5%82adys"}, "is_accepted": false, "score": 0, "last_activity_date": 1473871075, "creation_date": 1473871075, "answer_id": 39495624, "question_id": 39495447, "link": "https://stackoverflow.com/questions/39495447/reopening-class-in-initializer-breaks-attribute-accessors/39495624#39495624", "title": "reopening class in initializer breaks attribute accessors", "body": "<p>I think it's happend because you declared method without inheritance. Your default accessors come from <code>ActiveRecord::Base</code>. So when you declared new method, you override everything from inheritor.</p>\n"}, {"tags": [], "owner": {"reputation": 79161, "user_id": 1064226, "user_type": "registered", "profile_image": "https://graph.facebook.com/36912842/picture?type=large", "display_name": "Frederick Cheung", "link": "https://stackoverflow.com/users/1064226/frederick-cheung"}, "is_accepted": true, "score": 1, "last_activity_date": 1473923977, "creation_date": 1473923977, "answer_id": 39505143, "question_id": 39495447, "link": "https://stackoverflow.com/questions/39495447/reopening-class-in-initializer-breaks-attribute-accessors/39505143#39505143", "title": "reopening class in initializer breaks attribute accessors", "body": "<p>The key thing is that you're not reopening the class: you're defining  a new one. In development and in tests your classes are loaded when they are first used. By defining <code>Thing</code> in your initializer you prevent your thing.rb file from ever being loaded.</p>\n\n<p>When you use <code>Thing.class_eval</code> you're not defining a new class so rails loads <code>Thing</code> from thing.rb: at this point your are adding to <code>Thing</code> rather than replacing it.</p>\n"}, {"comments": [{"owner": {"reputation": 3612, "user_id": 2865270, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/1198391393/picture?type=large", "display_name": "Fred Willmore", "link": "https://stackoverflow.com/users/2865270/fred-willmore"}, "edited": false, "score": 0, "creation_date": 1473932251, "post_id": 39505255, "comment_id": 66331862, "body": "Thanks for the explanation - that is not a conclusion I would have reached on my own!"}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 2, "last_activity_date": 1473924319, "creation_date": 1473924319, "answer_id": 39505255, "question_id": 39495447, "link": "https://stackoverflow.com/questions/39495447/reopening-class-in-initializer-breaks-attribute-accessors/39505255#39505255", "title": "reopening class in initializer breaks attribute accessors", "body": "<blockquote>\n  <p>I put a debugger statement at the top of the file. In the debugger I can query Thing.superclass and I get ActiveRecord::Base. I can create an instance of Thing and call test_field on it.</p>\n</blockquote>\n\n<p>The mere act of observing the experiment alters its results. The class <strong>does not</strong> exist when you stop at debugger statement there. But it is <strong>autoloaded</strong> the moment you evaluate <code>Thing</code> in the debugger console.</p>\n\n<p>What you could do in your real initializer is to trigger loading of the model, one way or another.</p>\n\n<pre><code># initializers/thing.rb\nThing # trigger autoloading\nclass Thing\n  ...\nend\n\n\n# or\nrequire 'app/models/thing.rb' # load explicitly\nclass Thing\n  ...\nend\n</code></pre>\n"}], "owner": {"reputation": 3612, "user_id": 2865270, "user_type": "registered", "accept_rate": 29, "profile_image": "https://graph.facebook.com/1198391393/picture?type=large", "display_name": "Fred Willmore", "link": "https://stackoverflow.com/users/2865270/fred-willmore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 39505143, "answer_count": 3, "score": 0, "last_activity_date": 1473924319, "creation_date": 1473870508, "question_id": 39495447, "link": "https://stackoverflow.com/questions/39495447/reopening-class-in-initializer-breaks-attribute-accessors", "title": "reopening class in initializer breaks attribute accessors", "body": "<p>I'm trying to use an initializer in Rails 4.2 to add a method to an ActiveRecord model. However, simply reopening the class in the initializer breaks the existing attribute accessors.</p>\n\n<p>model app/models/thing.rb:</p>\n\n<pre><code>class Thing &lt; ActiveRecord::Base\nend\n</code></pre>\n\n<p>migration db/migrate/20160914144414_create_things.rb:</p>\n\n<pre><code>class CreateThings &lt; ActiveRecord::Migration\n  def change\n    create_table :things do |t|\n      t.integer :test_field\n      t.timestamps null: false\n    end\n  end\nend\n</code></pre>\n\n<p>initializer config/initializers/thing.rb:</p>\n\n<pre><code>class Thing\n  def self.new_method\n    \"hello\"\n  end\nend\n</code></pre>\n\n<p>test file test/models/thing_test.rb:</p>\n\n<pre><code>require File.expand_path(\"../../test_helper\", __FILE__)\n\nclass ThingTest &lt; ActiveSupport::TestCase\n  test \"the truth\" do\n    thing = Thing.new\n    thing.test_field = 1\n    puts thing.new_method\n  end\nend\n</code></pre>\n\n<p>When I run my test here's what I get:</p>\n\n<pre><code>\u276f\u276f\u276f rtest test/models/thing_test.rb\n  1) Error:\nThingTest#test_the_truth:\nNoMethodError: undefined method `test_field=' for #&lt;Thing:0x00000101464658&gt;\n    test/models/thing_test.rb:6:in `block in &lt;class:ThingTest&gt;'\n</code></pre>\n\n<p>If I use this alternate syntax to add the method to the class, it works:</p>\n\n<pre><code>Thing.class_eval do\n  def self.new_method\n    \"hello\"\n  end\nend\n</code></pre>\n\n<p>I guess I'm happy to do it this way, but I would like to know why it doesn't work just reopening the class.</p>\n"}, {"tags": ["ruby", "bash", "shell"], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 6283294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-VfVMrI2Fhr0/AAAAAAAAAAI/AAAAAAAANss/PwjHZBb7Jrc/photo.jpg?sz=128", "display_name": "sudhir kumar", "link": "https://stackoverflow.com/users/6283294/sudhir-kumar"}, "edited": false, "score": 0, "creation_date": 1473876631, "post_id": 39495722, "comment_id": 66311534, "body": "Can I also pass parameters to this shell script?"}], "tags": [], "owner": {"reputation": 104, "user_id": 4777806, "user_type": "registered", "accept_rate": 14, "profile_image": "https://i.stack.imgur.com/ur5gc.jpg?s=128&g=1", "display_name": "pyro_lemur", "link": "https://stackoverflow.com/users/4777806/pyro-lemur"}, "is_accepted": true, "score": 0, "last_activity_date": 1473902660, "last_edit_date": 1473902660, "creation_date": 1473871435, "answer_id": 39495722, "question_id": 39495333, "link": "https://stackoverflow.com/questions/39495333/shell-script-for-ruby-scripts-execution/39495722#39495722", "title": "Shell script for ruby scripts execution", "body": "<p>A shell script like this should work:</p>\n\n<pre><code># Execute Ruby script multiple times with different parameters.\n\nruby ./analysis.rb -d parameter1 -p parameter2 parameter3\nruby ./analysis.rb -d parameter4 -p parameter5 parameter6\nruby ./analysis.rb -d parameter7 -p parameter8 parameter9\n</code></pre>\n\n<p>To pass the variables to the Ruby script via the Bash script arguments:</p>\n\n<pre><code># Include 9 arguments when calling the Bash script. Ruby script will be executed 3 times, with 3 of the arguments each time.\nruby ./analysis.rb $1 $2 $3\nruby ./analysis.rb $4 $5 $6\nruby ./analysis.rb $7 $8 $9\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 105, "user_id": 6283294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-VfVMrI2Fhr0/AAAAAAAAAAI/AAAAAAAANss/PwjHZBb7Jrc/photo.jpg?sz=128", "display_name": "sudhir kumar", "link": "https://stackoverflow.com/users/6283294/sudhir-kumar"}, "edited": false, "score": 1, "creation_date": 1473961106, "post_id": 39502195, "comment_id": 66350061, "body": "Thanks for the answer. Worked for me. In my case there are no spaces for parameters."}], "tags": [], "owner": {"reputation": 13254, "user_id": 78351, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0d6a337105bd3a30f7c3ceec12097c09?s=128&d=identicon&r=PG", "display_name": "euphoria83", "link": "https://stackoverflow.com/users/78351/euphoria83"}, "is_accepted": false, "score": 0, "last_activity_date": 1473905342, "creation_date": 1473905342, "answer_id": 39502195, "question_id": 39495333, "link": "https://stackoverflow.com/questions/39495333/shell-script-for-ruby-scripts-execution/39502195#39502195", "title": "Shell script for ruby scripts execution", "body": "<p>For each invocation of your script, you can add 1 line, with all 3 parameters, to a file, say, <code>params.txt</code>. For e.g.,</p>\n\n<pre><code>run1-param1 run1-param2 run1-param3\nrun2-param1 run2-param2 run2-param3\nrun3-param1 run3-param2 run3-param3\n...\n</code></pre>\n\n<p>Then you can create another bash script, say, <code>repeat-analysis.sh</code> that reads 1 line every time and runs <code>analysis.rb</code> with the parameters on that line. Example script below:</p>\n\n<pre><code>#!/bin/bash\n\nwhile read p1 p2 p3; do\n    ./analysis.rb -d \"$p1\" -p \"$p2\" \"$p3\"\ndone\n</code></pre>\n\n<p>You can run this script as follows:</p>\n\n<pre><code>$ ./repeat-analysis.sh &lt; params.txt\n</code></pre>\n\n<p>An important caveat here is that this will only work if your parameters don't have spaces within them. Let me know if that is not true for you and I can try to improve the script above to handle that.</p>\n"}], "owner": {"reputation": 105, "user_id": 6283294, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-VfVMrI2Fhr0/AAAAAAAAAAI/AAAAAAAANss/PwjHZBb7Jrc/photo.jpg?sz=128", "display_name": "sudhir kumar", "link": "https://stackoverflow.com/users/6283294/sudhir-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 704, "favorite_count": 0, "accepted_answer_id": 39495722, "answer_count": 2, "score": 0, "last_activity_date": 1473905342, "creation_date": 1473870114, "last_edit_date": 1473870307, "question_id": 39495333, "link": "https://stackoverflow.com/questions/39495333/shell-script-for-ruby-scripts-execution", "title": "Shell script for ruby scripts execution", "body": "<p>I have a ruby script name analysis and I am executing from bash by passing parameters</p>\n\n<pre><code>#!/usr/bin/env ruby\nscript here\n</code></pre>\n\n<p>execution:</p>\n\n<pre><code>./analysis -d parameter1 -p parameter2 parameter3\n</code></pre>\n\n<p>I execute this script multiple times by passing different parameters each time.\nIs there is a way to execute these multiple ruby scripts from shell script?</p>\n"}, {"tags": ["ruby", "database", "crud"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 3, "creation_date": 1473875689, "post_id": 39495093, "comment_id": 66311045, "body": "I&#39;d strongly suggest you indent your code correctly. It&#39;ll save your future self a lot of anguish."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 3602045, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4d2cd86b8277216f1ba358300b097389?s=128&d=identicon&r=PG&f=1", "display_name": "user3602045", "link": "https://stackoverflow.com/users/3602045/user3602045"}, "edited": false, "score": 0, "creation_date": 1473869975, "post_id": 39495224, "comment_id": 66307967, "body": "Just tried that, still getting the same exact error."}, {"owner": {"reputation": 29, "user_id": 3602045, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4d2cd86b8277216f1ba358300b097389?s=128&d=identicon&r=PG&f=1", "display_name": "user3602045", "link": "https://stackoverflow.com/users/3602045/user3602045"}, "edited": false, "score": 0, "creation_date": 1473870043, "post_id": 39495224, "comment_id": 66308003, "body": "<code>add&#39;: undefined local variable or method </code>people&#39; for main:Object (NameError)"}, {"owner": {"reputation": 5292, "user_id": 246534, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ukMU2.jpg?s=128&g=1", "display_name": "kfb", "link": "https://stackoverflow.com/users/246534/kfb"}, "reply_to_user": {"reputation": 29, "user_id": 3602045, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4d2cd86b8277216f1ba358300b097389?s=128&d=identicon&r=PG&f=1", "display_name": "user3602045", "link": "https://stackoverflow.com/users/3602045/user3602045"}, "edited": false, "score": 0, "creation_date": 1473870071, "post_id": 39495224, "comment_id": 66308019, "body": "Did you replace every instance of <code>people</code> with <code>$people</code>?"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 2, "creation_date": 1473875827, "post_id": 39495224, "comment_id": 66311118, "body": "Using global variables isn&#39;t the solution to the problem, it&#39;s only a bandaid. Understand how variable scoping works instead. Using a global should be very, very, rare and only done when you understand why you shouldn&#39;t use them and how it&#39;s safe to use them."}, {"owner": {"reputation": 5292, "user_id": 246534, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ukMU2.jpg?s=128&g=1", "display_name": "kfb", "link": "https://stackoverflow.com/users/246534/kfb"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1473931697, "post_id": 39495224, "comment_id": 66331418, "body": "@theTinMan yes, you are correct, and I&#39;ve edited my answer to mention this. But global variables are a part of the language and deserve to be understood and used correctly too."}], "tags": [], "owner": {"reputation": 5292, "user_id": 246534, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ukMU2.jpg?s=128&g=1", "display_name": "kfb", "link": "https://stackoverflow.com/users/246534/kfb"}, "is_accepted": true, "score": -1, "last_activity_date": 1473931830, "last_edit_date": 1473931830, "creation_date": 1473869720, "answer_id": 39495224, "question_id": 39495093, "link": "https://stackoverflow.com/questions/39495093/how-do-i-call-a-variable-to-a-method-in-ruby-not-rails/39495224#39495224", "title": "How do I call a variable to a method in Ruby (NOT Rails)", "body": "<p>Global variables should be prefixed by <code>$</code> in Ruby, so you need <code>$people</code> in place of <code>people</code>. Alternatively, you can pass in <code>people</code> to your <code>add</code> function.</p>\n\n<p>As pointed out by theTinMan, the correct solution is to refactor your code in a way to avoid the use of global variables in the first place, by passing in the <code>people</code> to your function:</p>\n\n<pre><code>def add(people)\n    ...\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 3602045, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4d2cd86b8277216f1ba358300b097389?s=128&d=identicon&r=PG&f=1", "display_name": "user3602045", "link": "https://stackoverflow.com/users/3602045/user3602045"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 39495224, "answer_count": 1, "score": -1, "last_activity_date": 1473931830, "creation_date": 1473869295, "last_edit_date": 1473869820, "question_id": 39495093, "link": "https://stackoverflow.com/questions/39495093/how-do-i-call-a-variable-to-a-method-in-ruby-not-rails", "title": "How do I call a variable to a method in Ruby (NOT Rails)", "body": "<pre><code>people = {}\n\ndef add\n\n    puts \"Enter the name of the person you would like to add in the database.\"\n    name = gets.chomp.to_s\n\n    if people[name].nil?\n\n        puts \"What is #{name}'s age?\"\n        age = gets.chomp.to_i\n\n        people[name] = age.to_i\nend\n\nputs \"Would you like to add?\"\nchoice = gets.chomp\n\nif choice == \"yes\"\n      add\nend\n\nend\n</code></pre>\n\n<p>So Ive got people outside my method \"add\", I get an error \"undefined local variable or method `people' for main: Object (NameError)\"</p>\n\n<p>I am getting an error ass soon as people[name].nil? line comes.</p>\n\n<p>I have to create a database, I have more methods like update and delete, how do I use / call \"people\" inside these methods?</p>\n"}, {"tags": ["ruby", "selenium", "cucumber", "watir-webdriver", "page-object-gem"], "comments": [{"owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 1, "creation_date": 1473873004, "post_id": 39494823, "comment_id": 66309652, "body": "The answer really depends on how the tables are organized (eg are there identifiable attributes) and what you are trying to do with them. Without a specific example/question, it is hard to give a useful answer."}, {"owner": {"reputation": 109, "user_id": 3960856, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/52db70f6bc38d48626195d53ff017323?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Corbett", "link": "https://stackoverflow.com/users/3960856/jason-corbett"}, "reply_to_user": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "edited": false, "score": 0, "creation_date": 1473873357, "post_id": 39494823, "comment_id": 66309825, "body": "I will revise to show you what I am talking about"}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 3960856, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/52db70f6bc38d48626195d53ff017323?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Corbett", "link": "https://stackoverflow.com/users/3960856/jason-corbett"}, "edited": false, "score": 0, "creation_date": 1473906246, "post_id": 39497792, "comment_id": 66321857, "body": "Thanks Justin. Didn&#39;t realize I can actually use that methods link_element. Works for me!"}], "tags": [], "owner": {"reputation": 44680, "user_id": 1200545, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbbfea5f6583c16f96fc11ef821cfeee?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Ko", "link": "https://stackoverflow.com/users/1200545/justin-ko"}, "is_accepted": false, "score": 1, "last_activity_date": 1473879610, "creation_date": 1473879610, "answer_id": 39497792, "question_id": 39494823, "link": "https://stackoverflow.com/questions/39494823/pageobject-gems-handling-of-nested-tables-vs-iframe/39497792#39497792", "title": "PageObject gem&#39;s handling of nested tables vs iframe", "body": "<p>Since the parent cell of the link has an ID, you can easily find that cell. From there, you simply get the first link in the cell.</p>\n\n<pre><code>page.cell_element(id: 'desired_item').link_element\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 3960856, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/52db70f6bc38d48626195d53ff017323?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Corbett", "link": "https://stackoverflow.com/users/3960856/jason-corbett"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473879610, "creation_date": 1473868360, "last_edit_date": 1473874937, "question_id": 39494823, "link": "https://stackoverflow.com/questions/39494823/pageobject-gems-handling-of-nested-tables-vs-iframe", "title": "PageObject gem&#39;s handling of nested tables vs iframe", "body": "<p>I am using the PageObject gems to test Salesforce which is chock full of tables within tables. I wanted to know if anyone has used a specific technique to access cells within nested tables (see example below). </p>\n\n<p>I want to access THE LINK inside the cell with the cell labeled id=\"desired_item\"</p>\n\n<p>Thanks in advance.</p>\n\n<pre><code>&lt;table id=\"bodyTable\" class=\"outer\"&gt;\n    &lt;tbody&gt;\n        &lt;tr&gt;\n          &lt;td id=\"blah\"&gt;\n            &lt;div&gt;\n               &lt;table class=\"detailList\"&gt;\n                 &lt;tbody&gt;\n                   &lt;td&gt;\n                    &lt;tr&gt;\n                      &lt;td id=\"desired_item\"&gt;\n                        &lt;a&gt;Click_Me_Link&lt;/a&gt;\n                      &lt;/td&gt;\n                    &lt;/tr&gt;\n                   &lt;/td&gt;\n                 &lt;/tbody&gt;\n               &lt;/table&gt;\n            &lt;/div&gt;\n          &lt;/td&gt;\n       &lt;/tr&gt;\n     &lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>\n"}, {"tags": ["ruby", "selenium-webdriver", "automated-tests", "performance-testing", "ui-automation"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1473869032, "post_id": 39494761, "comment_id": 66307427, "body": "Could you be more specific? What kind of element is that? Why is it not ready / accessible at first? Is JavaScript involved?"}, {"owner": {"reputation": 90, "user_id": 1688911, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/100001306892454/picture?type=large", "display_name": "esakiraja", "link": "https://stackoverflow.com/users/1688911/esakiraja"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1473869490, "post_id": 39494761, "comment_id": 66307698, "body": "I&#39;m not fighting to access the element. I want to know the time it takes to get loaded. Lets say I&#39;ve a script for login, When I execute it, the script passes username and pwd and clicks Login. That&#39;s all fine, but what i want to know is that, I want the time it took to load the elements login and pwd."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1473870246, "post_id": 39494761, "comment_id": 66308110, "body": "So you can adjust the <code>sleep</code> amount in your script, right? Chances are the time it takes for the element(s) to become available is not constant."}, {"owner": {"reputation": 17982, "user_id": 3689450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SXuSR.png?s=128&g=1", "display_name": "VLAZ", "link": "https://stackoverflow.com/users/3689450/vlaz"}, "edited": false, "score": 1, "creation_date": 1473886888, "post_id": 39494761, "comment_id": 66316740, "body": "Erm, I&#39;ve only used Selenium in Java but I imagine the functionality should still be present in ruby - there is a <code>wait</code> element you can use and wait <i>for</i> something using <code>wait.until</code>. It supports stuff like waiting until an element is loaded, or waiting until it&#39;s visible or waiting until it&#39;s <i>not</i> visible. Essentially, you pass a predicate and Selenium will do the sleep-check-sleep cycle for you."}], "answers": [{"tags": [], "owner": {"reputation": 12542, "user_id": 156746, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8TsPx.jpg?s=128&g=1", "display_name": "DiegoSalazar", "link": "https://stackoverflow.com/users/156746/diegosalazar"}, "is_accepted": false, "score": 0, "last_activity_date": 1473869104, "creation_date": 1473869104, "answer_id": 39495029, "question_id": 39494761, "link": "https://stackoverflow.com/questions/39494761/is-there-anyway-that-i-could-find-the-time-that-an-element-takes-to-load-using-s/39495029#39495029", "title": "Is there anyway that I could find the time that an element takes to load using selenium webdriver?", "body": "<p>Try setting an Implicit Wait so that the webdriver polls the dom until the element appears. </p>\n\n<pre><code>driver = Selenium::WebDriver.for :firefox\ndriver.manage.timeouts.implicit_wait = 10 # seconds\n</code></pre>\n\n<p><a href=\"http://www.seleniumhq.org/docs/04_webdriver_advanced.jsp\" rel=\"nofollow\">http://www.seleniumhq.org/docs/04_webdriver_advanced.jsp</a></p>\n"}], "owner": {"reputation": 90, "user_id": 1688911, "user_type": "registered", "accept_rate": 14, "profile_image": "https://graph.facebook.com/100001306892454/picture?type=large", "display_name": "esakiraja", "link": "https://stackoverflow.com/users/1688911/esakiraja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1473869104, "creation_date": 1473868166, "question_id": 39494761, "link": "https://stackoverflow.com/questions/39494761/is-there-anyway-that-i-could-find-the-time-that-an-element-takes-to-load-using-s", "title": "Is there anyway that I could find the time that an element takes to load using selenium webdriver?", "body": "<p>I need to find the time that an element takes to load and it's ready to be accessible. As I've so many explicit 'sleep' in my script, I'm trying to reduce it by using the metric.</p>\n"}, {"tags": ["ruby", "macos", "imagemagick", "macos-sierra", "rmagick"], "comments": [{"owner": {"reputation": 47588, "user_id": 88597, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/46c5b07a7107ef8cfd16d9cbf7d05b08?s=128&d=identicon&r=PG", "display_name": "ohho", "link": "https://stackoverflow.com/users/88597/ohho"}, "edited": false, "score": 0, "creation_date": 1491547185, "post_id": 39494672, "comment_id": 73610838, "body": "<a href=\"http://stackoverflow.com/questions/41647979/imagemagick-7-with-rmagick-2-16-on-macos-sierra-cant-find-magickwand-h\" title=\"imagemagick 7 with rmagick 2 16 on macos sierra cant find magickwand h\">stackoverflow.com/questions/41647979/&hellip;</a>"}, {"owner": {"reputation": 6020, "user_id": 200985, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/0a07a11efd94fa8a87043f7ef91cd08d?s=128&d=identicon&r=PG", "display_name": "lmat - Reinstate Monica", "link": "https://stackoverflow.com/users/200985/lmat-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1591628878, "post_id": 39494672, "comment_id": 110121109, "body": "What is this, a Harry Potter game?"}, {"owner": {"reputation": 24150, "user_id": 771581, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/swQMb.jpg?s=128&g=1", "display_name": "0x4a6f4672", "link": "https://stackoverflow.com/users/771581/0x4a6f4672"}, "reply_to_user": {"reputation": 6020, "user_id": 200985, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/0a07a11efd94fa8a87043f7ef91cd08d?s=128&d=identicon&r=PG", "display_name": "lmat - Reinstate Monica", "link": "https://stackoverflow.com/users/200985/lmat-reinstate-monica"}, "edited": false, "score": 1, "creation_date": 1595411126, "post_id": 39494672, "comment_id": 111462407, "body": "@LimitedAtonement apparently yes :-)"}], "answers": [{"comments": [{"owner": {"reputation": 24150, "user_id": 771581, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/swQMb.jpg?s=128&g=1", "display_name": "0x4a6f4672", "link": "https://stackoverflow.com/users/771581/0x4a6f4672"}, "edited": false, "score": 0, "creation_date": 1473870043, "post_id": 39494980, "comment_id": 66308002, "body": "thanks for the tips and suggestions, unfortunately it did not help :-("}, {"owner": {"reputation": 15010, "user_id": 536890, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/85530c6eefdc35e70ff1e2119eaad7b4?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Kim", "link": "https://stackoverflow.com/users/536890/jason-kim"}, "edited": false, "score": 1, "creation_date": 1498688886, "post_id": 39494980, "comment_id": 76607684, "body": "This answer was the only one that mentioned <code>pkg-config</code> and it worked."}, {"owner": {"reputation": 356, "user_id": 2244272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02645027c4a2a299ae53daf1e4249555?s=128&d=identicon&r=PG", "display_name": "Michael Johann", "link": "https://stackoverflow.com/users/2244272/michael-johann"}, "edited": false, "score": 0, "creation_date": 1504079765, "post_id": 39494980, "comment_id": 78867668, "body": "pkg-config ist the key to success. Thank you so much."}], "tags": [], "owner": {"reputation": 3805, "user_id": 2075801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f845c96122bd745f0614185a840d850b?s=128&d=identicon&r=PG", "display_name": "Yury Lebedev", "link": "https://stackoverflow.com/users/2075801/yury-lebedev"}, "is_accepted": false, "score": 5, "last_activity_date": 1473868892, "creation_date": 1473868892, "answer_id": 39494980, "question_id": 39494672, "link": "https://stackoverflow.com/questions/39494672/rmagick-installation-cant-find-magickwand-h/39494980#39494980", "title": "RMagick installation: Can&#39;t find MagickWand.h", "body": "<pre><code>$ brew remove imagemagick &amp;&amp; brew install imagemagick\n\n$ brew uninstall pkg-config &amp;&amp; brew install pkg-config\n$ brew unlink pkg-config &amp;&amp; brew link pkg-config\n\n$ gem install rmagick\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24150, "user_id": 771581, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/swQMb.jpg?s=128&g=1", "display_name": "0x4a6f4672", "link": "https://stackoverflow.com/users/771581/0x4a6f4672"}, "is_accepted": true, "score": 0, "last_activity_date": 1477644942, "last_edit_date": 1495540051, "creation_date": 1476794779, "answer_id": 40108689, "question_id": 39494672, "link": "https://stackoverflow.com/questions/39494672/rmagick-installation-cant-find-magickwand-h/40108689#40108689", "title": "RMagick installation: Can&#39;t find MagickWand.h", "body": "<p>Something was severely wrong on my system, so badly that it was completely f*d up, but I was finally to able to install RMagick for Ruby 1.8.7 again after I installed </p>\n\n<ul>\n<li>an <a href=\"https://stackoverflow.com/questions/11343617/installing-older-version-of-imagemagick-with-homebrew\">older version of ImageMagick with Homebrew</a></li>\n<li>a new Ruby version of 1.8.7</li>\n<li>a new version of GCC</li>\n</ul>\n\n<p>The installation of a new Ruby version with RVM <code>rvm install 1.8.7</code> also installed a new GCC compiler: it removed an older GCC version 4.6 and installed GCC version 4.9. Apparently GCC was not able to find the right headers despite pkg-config.</p>\n"}, {"comments": [{"owner": {"reputation": 136, "user_id": 1113525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K61rm.jpg?s=128&g=1", "display_name": "Kemal Akkoyun", "link": "https://stackoverflow.com/users/1113525/kemal-akkoyun"}, "edited": false, "score": 0, "creation_date": 1484574519, "post_id": 41674363, "comment_id": 70552810, "body": "Could you find any solutions? I&#39;m experiencing same issues with you."}, {"owner": {"reputation": 1618, "user_id": 299781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52d380305288301a38f4bac69132e19d?s=128&d=identicon&r=PG", "display_name": "Holger Frohloff", "link": "https://stackoverflow.com/users/299781/holger-frohloff"}, "reply_to_user": {"reputation": 136, "user_id": 1113525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K61rm.jpg?s=128&g=1", "display_name": "Kemal Akkoyun", "link": "https://stackoverflow.com/users/1113525/kemal-akkoyun"}, "edited": false, "score": 0, "creation_date": 1484602063, "post_id": 41674363, "comment_id": 70567624, "body": "as I said. switching back to imagemagick 6.9 fixes it for me."}, {"owner": {"reputation": 136, "user_id": 1113525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K61rm.jpg?s=128&g=1", "display_name": "Kemal Akkoyun", "link": "https://stackoverflow.com/users/1113525/kemal-akkoyun"}, "edited": false, "score": 1, "creation_date": 1484639799, "post_id": 41674363, "comment_id": 70579539, "body": "Thanks, I got that and fixed it, according to your suggestion. But what I was trying to ask if you have solved it using latest ImageMagick version? Then I found the related issue <a href=\"https://github.com/rmagick/rmagick/issues/256\" rel=\"nofollow noreferrer\">github.com/rmagick/rmagick/issues/256</a> which also suggesting to downgrade ImageMagick as you did. So thanks again."}, {"owner": {"reputation": 1618, "user_id": 299781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52d380305288301a38f4bac69132e19d?s=128&d=identicon&r=PG", "display_name": "Holger Frohloff", "link": "https://stackoverflow.com/users/299781/holger-frohloff"}, "reply_to_user": {"reputation": 136, "user_id": 1113525, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/K61rm.jpg?s=128&g=1", "display_name": "Kemal Akkoyun", "link": "https://stackoverflow.com/users/1113525/kemal-akkoyun"}, "edited": false, "score": 0, "creation_date": 1484641467, "post_id": 41674363, "comment_id": 70580395, "body": "You are very welcome. I did not solve the problem using version 7.x yet. I guess there will be a fix rather soonish. We&#39;ll see. :)"}], "tags": [], "owner": {"reputation": 1618, "user_id": 299781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52d380305288301a38f4bac69132e19d?s=128&d=identicon&r=PG", "display_name": "Holger Frohloff", "link": "https://stackoverflow.com/users/299781/holger-frohloff"}, "is_accepted": false, "score": 12, "last_activity_date": 1484562854, "creation_date": 1484562854, "answer_id": 41674363, "question_id": 39494672, "link": "https://stackoverflow.com/questions/39494672/rmagick-installation-cant-find-magickwand-h/41674363#41674363", "title": "RMagick installation: Can&#39;t find MagickWand.h", "body": "<p>Something changed with <strong>ImageMagick 7.0.4-4</strong> for me. <code>wand/MagickWand.h</code> couldn't be found any more:</p>\n\n<pre><code>% brew unlink imagemagick &amp;&amp; brew link imagemagick\nUnlinking /usr/local/Cellar/imagemagick/7.0.4-4... 71 symlinks removed\nLinking /usr/local/Cellar/imagemagick/7.0.4-4... 71 symlinks created\n% gem install rmagick\nBuilding native extensions.  This could take a while...\nERROR:  Error installing rmagick:\n    ERROR: Failed to build gem native extension.\n\n    /Users/holger/.rbenv/versions/2.2.2/bin/ruby -r ./siteconf20170116-21103-1aikaka.rb extconf.rb\nchecking for clang... yes\nchecking for Magick-config... no\nchecking for pkg-config... yes\nchecking for outdated ImageMagick version (&lt;= 6.4.9)... no\nchecking for presence of MagickWand API (ImageMagick version &gt;= 6.9.0)... no\nchecking for Ruby version &gt;= 1.8.5... yes\nchecking for stdint.h... yes\nchecking for sys/types.h... yes\nchecking for wand/MagickWand.h... no\n\nCan't install RMagick 2.16.0. Can't find MagickWand.h.\n</code></pre>\n\n<p>I still had ImageMagick 6.9.7-3 on my system and changed back with</p>\n\n<pre><code>% brew switch imagemagick 6.9.7-3\nCleaning /usr/local/Cellar/imagemagick/6.9.6-6\nCleaning /usr/local/Cellar/imagemagick/6.9.7-0\nCleaning /usr/local/Cellar/imagemagick/6.9.7-1\nCleaning /usr/local/Cellar/imagemagick/6.9.7-3\nCleaning /usr/local/Cellar/imagemagick/7.0.4-4\n75 links created for /usr/local/Cellar/imagemagick/6.9.7-3\n</code></pre>\n\n<p>Afterwards I could install <code>rmagick</code> without trouble:</p>\n\n<pre><code>% gem install rmagick\nBuilding native extensions.  This could take a while...\nSuccessfully installed rmagick-2.16.0\n1 gem installed\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 16227, "user_id": 906577, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/1342da1f0fd6a63774bff6a34e0e0bdf?s=128&d=identicon&r=PG", "display_name": "hvkale", "link": "https://stackoverflow.com/users/906577/hvkale"}, "edited": false, "score": 0, "creation_date": 1484599753, "post_id": 41678770, "comment_id": 70566601, "body": "WOW! Thank you so much for that link. I was wasted almost half of my work-day trying to fix this."}, {"owner": {"reputation": 1375, "user_id": 958331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bece652de93e07be583b49972a01847c?s=128&d=identicon&r=PG", "display_name": "Darren Cheng", "link": "https://stackoverflow.com/users/958331/darren-cheng"}, "edited": false, "score": 14, "creation_date": 1484812409, "post_id": 41678770, "comment_id": 70666337, "body": "Note that imagemagick@6 is keg-only so you&#39;ll need to force linking. <code>brew install imagemagick@6 &amp;&amp; brew link imagemagick@6 --force</code> solved it for me"}, {"owner": {"reputation": 310, "user_id": 5891095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HNN7Z.jpg?s=128&g=1", "display_name": "Bella", "link": "https://stackoverflow.com/users/5891095/bella"}, "edited": false, "score": 1, "creation_date": 1487039442, "post_id": 41678770, "comment_id": 71594979, "body": "Awesome, cheers! This worked for me: <code>brew install --force imagemagick@6 &amp;&amp; brew link imagemagick@6 --force</code>"}, {"owner": {"reputation": 11231, "user_id": 127511, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/a727af7a2094e5fe644718884deec529?s=128&d=identicon&r=PG", "display_name": "Prakash Raman", "link": "https://stackoverflow.com/users/127511/prakash-raman"}, "edited": false, "score": 1, "creation_date": 1490544273, "post_id": 41678770, "comment_id": 73147682, "body": "Yes, installing the previous version (6x) would definitely fix it. The issue is that the folder structure of the imagemagick files have change in the 7x version. And while installing the gem it is assuming the folder structure that 6x has"}, {"owner": {"reputation": 3798, "user_id": 1255364, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/PnMMU.jpg?s=128&g=1", "display_name": "Will Hitchcock", "link": "https://stackoverflow.com/users/1255364/will-hitchcock"}, "edited": false, "score": 0, "creation_date": 1491584534, "post_id": 41678770, "comment_id": 73635270, "body": "Rolling back to imagemagick@6 doesn&#39;t work for me unfortunately. Even after reinstalling and relinking I still get this message when trying to install rmagick:  <code>Using 6.9.8 Q16 from &#47;usr&#47;local&#47;Cellar&#47;imagemagick@6&#47;6.9.8-3.  checking for outdated ImageMagick version (&lt;= 6.4.9)... yes checking for Ruby version &gt;= 1.8.5... yes checking for stdint.h... no checking for sys&#47;types.h... no checking for wand&#47;MagickWand.h... no  Can&#39;t install RMagick 2.15.0. Can&#39;t find MagickWand.h.</code>"}], "tags": [], "owner": {"reputation": 651, "user_id": 6879423, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-3v_dKFjvTDs/AAAAAAAAAAI/AAAAAAAAA0w/l4NEWEvLFkY/photo.jpg?sz=128", "display_name": "Raymond Cox", "link": "https://stackoverflow.com/users/6879423/raymond-cox"}, "is_accepted": false, "score": 55, "last_activity_date": 1484577641, "last_edit_date": 1484577641, "creation_date": 1484577303, "answer_id": 41678770, "question_id": 39494672, "link": "https://stackoverflow.com/questions/39494672/rmagick-installation-cant-find-magickwand-h/41678770#41678770", "title": "RMagick installation: Can&#39;t find MagickWand.h", "body": "<p>I had this same issue with <strong>ImageMagick 7.0.4-4</strong>. The proper fix is to install <code>imagemagick@6</code>. I found <a href=\"https://github.com/Homebrew/homebrew-core/pull/8756\">https://github.com/Homebrew/homebrew-core/pull/8756</a> useful if you accidentally deleted your <code>imagemagick@6</code> or never had it installed in the first place.</p>\n"}, {"comments": [{"owner": {"reputation": 2347, "user_id": 1625253, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/iBQwX.jpg?s=128&g=1", "display_name": "Simon Franzen", "link": "https://stackoverflow.com/users/1625253/simon-franzen"}, "edited": false, "score": 1, "creation_date": 1491242498, "post_id": 41680186, "comment_id": 73455643, "body": "Worked for me: Mac OS 10.12.X. I installed ImageMagick 7 first and had problems with installing the rails gem rmagick."}], "tags": [], "owner": {"reputation": 764, "user_id": 3941583, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8491782c07722842e31ab6fd3c68c12?s=128&d=identicon&r=PG", "display_name": "Peter Toth - Toma", "link": "https://stackoverflow.com/users/3941583/peter-toth-toma"}, "is_accepted": false, "score": 14, "last_activity_date": 1484581961, "creation_date": 1484581961, "answer_id": 41680186, "question_id": 39494672, "link": "https://stackoverflow.com/questions/39494672/rmagick-installation-cant-find-magickwand-h/41680186#41680186", "title": "RMagick installation: Can&#39;t find MagickWand.h", "body": "<p>Many things have changed in ImageMagick 7 like this path: <code>include/.../wand</code>  , and <code>wand/MagickWand.h</code> is hardwired in the rmagic gem at the moment. In my case it was not possible to update the gem since the project is rather old. So I ended up installing an older version of ImageMagic.</p>\n\n<p>You can install the latest version from 6.x.x:</p>\n\n<p><code>brew install https://raw.githubusercontent.com/Homebrew/homebrew-core/6f014f2b7f1f9e618fd5c0ae9c93befea671f8be/Formula/imagemagick.rb</code></p>\n\n<p>You can also pin it for later usege:\n<code>brew pin imagemagick</code></p>\n"}, {"comments": [{"owner": {"reputation": 13075, "user_id": 776301, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8901ffd42765b657625d4b42e95a5a5f?s=128&d=identicon&r=PG", "display_name": "Haris Krajina", "link": "https://stackoverflow.com/users/776301/haris-krajina"}, "edited": false, "score": 7, "creation_date": 1491408755, "post_id": 43035892, "comment_id": 73543033, "body": "Had to unlink manually <code>brew unlink imagemagick</code> before link - but it worked. Thanks a lot."}, {"owner": {"reputation": 636, "user_id": 3850697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d05f7c5b4418cc632368e55dacd96d25?s=128&d=identicon&r=PG", "display_name": "Fomentia", "link": "https://stackoverflow.com/users/3850697/fomentia"}, "edited": false, "score": 2, "creation_date": 1499803552, "post_id": 43035892, "comment_id": 77061519, "body": "Wow. Super sucks that I can&#39;t have the latest version of ImageMagick, but this works. Thanks!"}, {"owner": {"reputation": 301, "user_id": 3275748, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Jmq8p.jpg?s=128&g=1", "display_name": "violentr", "link": "https://stackoverflow.com/users/3275748/violentr"}, "edited": false, "score": 1, "creation_date": 1512146966, "post_id": 43035892, "comment_id": 82153859, "body": "Works perfectly with Ubuntu Ubuntu 16.04.3 LTS"}, {"owner": {"reputation": 114, "user_id": 12804871, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s3yPd.jpg?s=128&g=1", "display_name": "bad_kotya", "link": "https://stackoverflow.com/users/12804871/bad-kotya"}, "edited": false, "score": 2, "creation_date": 1611092206, "post_id": 43035892, "comment_id": 116338390, "body": "Works with Big Sur!"}], "tags": [], "owner": {"reputation": 31319, "user_id": 981183, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/88dd7155ef7c0e5f43ab8d1a9efdecab?s=128&d=identicon&r=PG&f=1", "display_name": "K M Rakibul Islam", "link": "https://stackoverflow.com/users/981183/k-m-rakibul-islam"}, "is_accepted": false, "score": 482, "last_activity_date": 1611104911, "last_edit_date": 1611104911, "creation_date": 1490571527, "answer_id": 43035892, "question_id": 39494672, "link": "https://stackoverflow.com/questions/39494672/rmagick-installation-cant-find-magickwand-h/43035892#43035892", "title": "RMagick installation: Can&#39;t find MagickWand.h", "body": "<p>To solve the issue in <strong>Mac OSX Sierra, High Sierra, El Capitan, Mojave, Catalina, and Big Sur</strong>, you can do the following:</p>\n<pre><code>brew unlink imagemagick\nbrew install imagemagick@6 &amp;&amp; brew link imagemagick@6 --force\n</code></pre>\n<p><code>imagemagick@6</code> is <code>keg-only</code>, so you'll need to force linking.</p>\n"}, {"comments": [{"owner": {"reputation": 1071, "user_id": 846655, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b16de786debe70f0bb37e9d7832da3cd?s=128&d=identicon&r=PG", "display_name": "mmlac", "link": "https://stackoverflow.com/users/846655/mmlac"}, "edited": false, "score": 2, "creation_date": 1509067410, "post_id": 44632724, "comment_id": 80879806, "body": "-1 because you force link for no reason nor telling anyone why this is a bad idea to begin with. See my answer for doing it &quot;properly&quot; in the sense of Homebrew and not MacPorts."}], "tags": [], "owner": {"reputation": 429, "user_id": 7418896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ac11f629989dccf33feeb9a9703dd60?s=128&d=identicon&r=PG&f=1", "display_name": "Evgeniy28", "link": "https://stackoverflow.com/users/7418896/evgeniy28"}, "is_accepted": false, "score": 32, "last_activity_date": 1503518089, "last_edit_date": 1503518089, "creation_date": 1497881014, "answer_id": 44632724, "question_id": 39494672, "link": "https://stackoverflow.com/questions/39494672/rmagick-installation-cant-find-magickwand-h/44632724#44632724", "title": "RMagick installation: Can&#39;t find MagickWand.h", "body": "<p>macOs Sierra:</p>\n\n<pre><code>brew uninstall imagemagick\nbrew install imagemagick@6\nbrew link imagemagick@6 --force\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 136, "user_id": 1751983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36b62fadbcda7c81ac23ec4c3205a98b?s=128&d=identicon&r=PG", "display_name": "territorial", "link": "https://stackoverflow.com/users/1751983/territorial"}, "is_accepted": false, "score": 3, "last_activity_date": 1611367727, "last_edit_date": 1611367727, "creation_date": 1505355615, "answer_id": 46209489, "question_id": 39494672, "link": "https://stackoverflow.com/questions/39494672/rmagick-installation-cant-find-magickwand-h/46209489#46209489", "title": "RMagick installation: Can&#39;t find MagickWand.h", "body": "<p>With 7.0.7-1 you can create an symbolic link, but it compilation will fail latter.</p>\n<pre><code>cd /usr/local/Cellar/imagemagick/7.0.7-1/include/ImageMagick-7\nln -s MagickWand/ wand\nln -s MagickCore/ magick\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 503, "user_id": 1859408, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/dbda838e9b7bca615829ac151e01f3c0?s=128&d=identicon&r=PG", "display_name": "Ivan Danci", "link": "https://stackoverflow.com/users/1859408/ivan-danci"}, "edited": false, "score": 0, "creation_date": 1507734998, "post_id": 46634305, "comment_id": 80331413, "body": "Worked for me, Sierra 10.12.6"}], "tags": [], "owner": {"reputation": 63, "user_id": 8742035, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-BDAMiYK-lgA/AAAAAAAAAAI/AAAAAAAAANs/0SmkRD-R5qM/photo.jpg?sz=128", "display_name": "Andrew Brown", "link": "https://stackoverflow.com/users/8742035/andrew-brown"}, "is_accepted": false, "score": 5, "last_activity_date": 1507485678, "creation_date": 1507485678, "answer_id": 46634305, "question_id": 39494672, "link": "https://stackoverflow.com/questions/39494672/rmagick-installation-cant-find-magickwand-h/46634305#46634305", "title": "RMagick installation: Can&#39;t find MagickWand.h", "body": "<p>I don't have the reputation yet to leave this as a comment improving another answer, but @Evgeniy28's answer worked for me on Sierra only after also installing pkg-config, which doesn't come installed by default on a fresh Sierra machine.</p>\n\n<p>So:</p>\n\n<pre><code>brew install pkg-config\nbrew uninstall imagemagick\nbrew install imagemagick@6\nbrew link imagemagick@6 --force\n</code></pre>\n\n<p>Success:</p>\n\n<pre><code>$ gem install rmagick\nBuilding native extensions.  This could take a while...\nSuccessfully installed rmagick-2.16.0\nParsing documentation for rmagick-2.16.0\nInstalling ri documentation for rmagick-2.16.0\nDone installing documentation for rmagick after 4 seconds\n1 gem installed\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1071, "user_id": 846655, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b16de786debe70f0bb37e9d7832da3cd?s=128&d=identicon&r=PG", "display_name": "mmlac", "link": "https://stackoverflow.com/users/846655/mmlac"}, "is_accepted": false, "score": 0, "last_activity_date": 1509072068, "last_edit_date": 1509072068, "creation_date": 1509067275, "answer_id": 46966102, "question_id": 39494672, "link": "https://stackoverflow.com/questions/39494672/rmagick-installation-cant-find-magickwand-h/46966102#46966102", "title": "RMagick installation: Can&#39;t find MagickWand.h", "body": "<p>First, you don't need to uninstall imagemagick if it has a 6.x installed, like shown below. You can see the current \"main\" is <code>7.0.7-8</code> but <code>6.9.1-10</code> is still there.</p>\n\n<pre><code>$ brew info imagemagick                                                            \nimagemagick: stable 7.0.7-8 (bottled), HEAD\nTools and libraries to manipulate images in many formats\nhttps://www.imagemagick.org/\n/usr/local/Cellar/imagemagick/6.9.1-10 (1,450 files, 17.5MB)\n  Poured from bottle on 2015-07-26 at 09:10:58\n/usr/local/Cellar/imagemagick/7.0.6-9 (1,522 files, 22.8MB)\n  Poured from bottle on 2017-08-21 at 14:44:16\nFrom: https://github.com/Homebrew/homebrew-core/blob/master/Formula\n</code></pre>\n\n<p>If you don't have an old 6.x version, <em>then</em> install imagemagick@6.</p>\n\n<p>Second, <strong>do not force link</strong> imagemagick, especially not 6. <em>EDIT: See \u00b9</em><br>\nYou need to set PKG_CONFIG_PATH in addition to the --with-opt-* flags.</p>\n\n<p>This works for me on High Sierra with aforementioned brew setup on Ruby 1.9.3-p551:</p>\n\n<pre><code>PKG_CONFIG_PATH=/usr/local/Cellar/imagemagick/6.9.1-10/lib/pkgconfig  \\\n  gem install rmagick -v '2.16.0' -- \\\n  --with-opt-lib=/usr/local/Cellar/imagemagick/6.9.1-10/lib/ \\\n  --with-opt-include=/usr/local/Cellar/imagemagick/6.9.1-10/include/ImageMagick-6/\n</code></pre>\n\n<p>Building ri docs fails, but those are inconsequential.</p>\n\n<p>\u00b9: Building works, the dylib path RMagick is searching is wrong though. Raised <a href=\"https://github.com/rmagick/rmagick/issues/278\" rel=\"nofollow noreferrer\">Issue #278</a> to clarify if this can be fixed. Otherwise manual symlinking of libMagickWand etc is necessary. Might still be safer to manually link the specific libraries than a <code>brew link --force</code> though.</p>\n"}, {"tags": [], "owner": {"reputation": 4957, "user_id": 1637683, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/3nf47.png?s=128&g=1", "display_name": "Lalit Kumar Maurya", "link": "https://stackoverflow.com/users/1637683/lalit-kumar-maurya"}, "is_accepted": false, "score": 5, "last_activity_date": 1512043823, "creation_date": 1512043823, "answer_id": 47573186, "question_id": 39494672, "link": "https://stackoverflow.com/questions/39494672/rmagick-installation-cant-find-magickwand-h/47573186#47573186", "title": "RMagick installation: Can&#39;t find MagickWand.h", "body": "<p>Please follow below and change some part according to your need.   </p>\n\n<pre><code>brew unlink imagemagick\nbrew install imagemagick@6 &amp;&amp; brew link imagemagick@6 --force\nexport PKG_CONFIG_PATH=/usr/local/Cellar/imagemagick@6/6.9.9-24/lib/pkgconfig\ngem install rmagick -v '2.15.4'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 354, "user_id": 5432975, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/X9dH8.jpg?s=128&g=1", "display_name": "Ferhad Konar", "link": "https://stackoverflow.com/users/5432975/ferhad-konar"}, "is_accepted": false, "score": 0, "last_activity_date": 1514893538, "last_edit_date": 1514893538, "creation_date": 1514888964, "answer_id": 48059309, "question_id": 39494672, "link": "https://stackoverflow.com/questions/39494672/rmagick-installation-cant-find-magickwand-h/48059309#48059309", "title": "RMagick installation: Can&#39;t find MagickWand.h", "body": "<p>I fully explain the installation process in <a href=\"https://stackoverflow.com/questions/31933348/imagemagick-install-problems-in-centos/48060341#48060341\">ImageMagick install in centos</a> .\n<br /><br />\nanyway ...\n<br />\nafter install Install Imagick &amp; ImageMagick-devel &amp; ImageMagick PHP library like below:</p>\n\n<pre><code># yum install ImageMagick\n# yum install ImageMagick-devel\n# pecl install Imagick\n</code></pre>\n\n<p>go to /usr/include</p>\n\n<pre><code>cd /usr/include\n</code></pre>\n\n<h1>Important: copy ImageMagick folder from \"/usr/include\" to \"/usr/local/include\" for ImageMagick  find  \"MagickWand.h\"</h1>\n\n<p>I tested this change on imagick-3.4.3(ImageMagick-7) and centos 6.5 and php56 and works perfectly ...</p>\n\n<p>If you have already installed \"ImageMagick\" several times, first remove all of them and find \"ImageMagick\" &amp; \"imagick\" folders and clean all of them and continue the installation process with this change.</p>\n\n<p>Use the following command to find a file or folder:</p>\n\n<pre><code>find / -name 'ImageMagick*'\nfind / -name 'imagick*'\n</code></pre>\n\n<p>and continue your installation\n<br />\nbefore below lines don't forget:\ngo to \"php.ini\" find \"disable_functions\" and clean \"proc_open,popen,proc_close\" becuase make imagick needs these functions,\nafter complete installation you can add this functions to your \"disable_functions\" on \"php.ini\" file.</p>\n\n<pre><code># phpize\n# ./configure --with-php-config=/usr/local/php56/bin/php-config \n...\n</code></pre>\n\n<p>Good luck...</p>\n"}, {"tags": [], "owner": {"reputation": 9663, "user_id": 5239030, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/76JEw.png?s=128&g=1", "display_name": "iGian", "link": "https://stackoverflow.com/users/5239030/igian"}, "is_accepted": false, "score": 3, "last_activity_date": 1520601751, "creation_date": 1520601751, "answer_id": 49194785, "question_id": 39494672, "link": "https://stackoverflow.com/questions/39494672/rmagick-installation-cant-find-magickwand-h/49194785#49194785", "title": "RMagick installation: Can&#39;t find MagickWand.h", "body": "<p>Here is how I solved (after lots of tries and fail) on <strong>macOS High Sierra</strong> 10.13.3 with Homebrew: </p>\n\n<ol>\n<li>it seems that RMagick 2.16.0 is not compatible with the newest version of ImageMagick (Version 7): <a href=\"http://wordsandmagic.com/2017/09/01/RMagick-2-16-0-Error-MagickWand\" rel=\"nofollow noreferrer\">http://wordsandmagic.com/2017/09/01/RMagick-2-16-0-Error-MagickWand</a></li>\n<li>I uninstalled imagemagick: <code>brew uninstall imagemagick</code> </li>\n<li>Then I installed Imagemagick with this formula: <a href=\"https://gist.github.com/JagdeepSingh/4b03cbeab16cc0bc729bbc6d275402d3\" rel=\"nofollow noreferrer\">https://gist.github.com/JagdeepSingh/4b03cbeab16cc0bc729bbc6d275402d3</a></li>\n<li><code>gem install rmagick</code></li>\n</ol>\n\n<p>If you have already installed an old version Imagemagick, this should work: <a href=\"https://stackoverflow.com/a/41674363\">https://stackoverflow.com/a/41674363</a></p>\n"}, {"tags": [], "owner": {"reputation": 508, "user_id": 4470094, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100000857022300/picture?type=large", "display_name": "Ali Hassan Mirza", "link": "https://stackoverflow.com/users/4470094/ali-hassan-mirza"}, "is_accepted": false, "score": 21, "last_activity_date": 1528382605, "last_edit_date": 1528382605, "creation_date": 1526125762, "answer_id": 50305903, "question_id": 39494672, "link": "https://stackoverflow.com/questions/39494672/rmagick-installation-cant-find-magickwand-h/50305903#50305903", "title": "RMagick installation: Can&#39;t find MagickWand.h", "body": "<p>First of all\nunlink your installed imagemagick which was not properly installed in latest mac high sierra by using.</p>\n\n<pre><code>brew unlink imagemagick\n</code></pre>\n\n<p>then install latest imagemagic6 using below command</p>\n\n<pre><code>brew install imagemagick@6 &amp;&amp; brew link imagemagick@6 --force\n</code></pre>\n\n<p>Then install gem rmagick using below command</p>\n\n<pre><code>gem install rmagick \n</code></pre>\n\n<p>It will work perfectly fine.</p>\n"}, {"tags": [], "owner": {"reputation": 384, "user_id": 3395272, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/jRH8Q.jpg?s=128&g=1", "display_name": "remonses", "link": "https://stackoverflow.com/users/3395272/remonses"}, "is_accepted": false, "score": 0, "last_activity_date": 1530017622, "creation_date": 1530017622, "answer_id": 51043457, "question_id": 39494672, "link": "https://stackoverflow.com/questions/39494672/rmagick-installation-cant-find-magickwand-h/51043457#51043457", "title": "RMagick installation: Can&#39;t find MagickWand.h", "body": "<p>For Ubuntu version >  12 and not using homebrew,</p>\n\n<pre><code>wget http://www.imagemagick.org/download/&lt;required_imagemagick_version&gt;\ntar -xvf &lt;path_to_your_downloaded_file&gt;.tar.gz\n</code></pre>\n\n<p>If you are getting '7z' files instead of 'tar.gz' files in the wget link, then</p>\n\n<pre><code>7z x &lt;path_to_your_downloaded_file&gt;.7z\ncd &lt;path_to_your_downloaded_file&gt;/\nmake\n./configure\nsudo make install\nsudo ldconfig /usr/local/lib\n</code></pre>\n\n<p>Then you can resume your bundler for RMagick.</p>\n"}, {"tags": [], "owner": {"reputation": 181, "user_id": 6806793, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DtXi5jhZ104/AAAAAAAAAAI/AAAAAAAAAFQ/DzHd6eIW8rg/photo.jpg?sz=128", "display_name": "BMA88", "link": "https://stackoverflow.com/users/6806793/bma88"}, "is_accepted": false, "score": 16, "last_activity_date": 1537948248, "last_edit_date": 1537948248, "creation_date": 1531189040, "answer_id": 51256379, "question_id": 39494672, "link": "https://stackoverflow.com/questions/39494672/rmagick-installation-cant-find-magickwand-h/51256379#51256379", "title": "RMagick installation: Can&#39;t find MagickWand.h", "body": "<p>yah this one solves my issue:</p>\n\n<p>MacOS X Sierra:</p>\n\n<pre><code>brew uninstall imagemagick\nbrew install imagemagick@6\nbrew link imagemagick@6 --force\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1057, "user_id": 470512, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/1dfadf9eef5a38a5db9ba3a6319d2b0b?s=128&d=identicon&r=PG", "display_name": "januszm", "link": "https://stackoverflow.com/users/470512/januszm"}, "is_accepted": false, "score": 3, "last_activity_date": 1537862435, "creation_date": 1537862435, "answer_id": 52493326, "question_id": 39494672, "link": "https://stackoverflow.com/questions/39494672/rmagick-installation-cant-find-magickwand-h/52493326#52493326", "title": "RMagick installation: Can&#39;t find MagickWand.h", "body": "<p>There's no need to link or unlink anything, following the instructions from the brew install script helps:</p>\n\n<pre><code>brew install imagemagick@6\nLDFLAGS=\"-L/usr/local/opt/imagemagick@6/lib\" CPPFLAGS=\"-I/usr/local/opt/imagemagick@6/include\" PKG_CONFIG_PATH=\"/usr/local/opt/imagemagick@6/lib/pkgconfig\" gem install rmagick\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 347, "user_id": 2063034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c944469aa2f8c3e010d33d77dc1b0cae?s=128&d=identicon&r=PG", "display_name": "wlads", "link": "https://stackoverflow.com/users/2063034/wlads"}, "is_accepted": false, "score": 6, "last_activity_date": 1549423556, "last_edit_date": 1549423556, "creation_date": 1544058789, "answer_id": 53643176, "question_id": 39494672, "link": "https://stackoverflow.com/questions/39494672/rmagick-installation-cant-find-magickwand-h/53643176#53643176", "title": "RMagick installation: Can&#39;t find MagickWand.h", "body": "<p>Install imagemagick version 6 because version 7 is not compatible:</p>\n\n<p><code>$ brew install imagemagick@6</code></p>\n\n<p>Should not <strong>link --force the older version</strong> because this will change the binaries in your path and the good <code>brew doctor</code> will complain.</p>\n\n<p>Reference the headers and libraries from version 6 that was installed when building the native extension of the gem:</p>\n\n<p><code>$ PKG_CONFIG_PATH=/usr/local/Cellar/imagemagick@6/6.9.10-14/lib/pkgconfig/ gem install rmagick -v '2.16.0'</code></p>\n\n<p><em>Note: Worked for me without indicating the lib and include folder because the pkgconfig is responsible for this.</em></p>\n\n<p><em>Note: 6.9.10-14 is the latest version of imagemagick@6, but feel free to change it if you need to use a different version</em></p>\n"}, {"tags": [], "owner": {"reputation": 4897, "user_id": 798224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/106e991aff47a77919601a41770ea734?s=128&d=identicon&r=PG", "display_name": "Phil Calvin", "link": "https://stackoverflow.com/users/798224/phil-calvin"}, "is_accepted": false, "score": 8, "last_activity_date": 1551550436, "creation_date": 1551550436, "answer_id": 54961544, "question_id": 39494672, "link": "https://stackoverflow.com/questions/39494672/rmagick-installation-cant-find-magickwand-h/54961544#54961544", "title": "RMagick installation: Can&#39;t find MagickWand.h", "body": "<p>RMagick depends on an outdated version of imagemagick, version 6.<sup>(see below)</sup> Homebrew offers this as a keg-only package, which you can install with:</p>\n\n<pre><code>brew install imagemagick@6\n</code></pre>\n\n<p>The build output will include a <strong>Caveats</strong> section (also available from <code>brew info imagemagick@6</code> if you cleared the output):</p>\n\n<pre><code>==&gt; Caveats\nimagemagick@6 is keg-only, which means it was not symlinked into /usr/local,\nbecause this is an alternate version of another formula.\n\nIf you need to have imagemagick@6 first in your PATH run:\n  echo 'export PATH=\"/usr/local/opt/imagemagick@6/bin:$PATH\"' &gt;&gt; ~/.zshrc\n\nFor compilers to find imagemagick@6 you may need to set:\n  export LDFLAGS=\"-L/usr/local/opt/imagemagick@6/lib\"\n  export CPPFLAGS=\"-I/usr/local/opt/imagemagick@6/include\"\n\nFor pkg-config to find imagemagick@6 you may need to set:\n  export PKG_CONFIG_PATH=\"/usr/local/opt/imagemagick@6/lib/pkgconfig\"\n</code></pre>\n\n<p>Rather than force-linking, which has the potential to cause problems with other software that <em>does</em> support newer versions of imagemagick, you can use the suggested <code>export</code>s to make the RMagick gem pick up the old version while it builds:</p>\n\n<pre><code>export LDFLAGS=\"-L/usr/local/opt/imagemagick@6/lib\"\nexport CPPFLAGS=\"-I/usr/local/opt/imagemagick@6/include\"\nexport PKG_CONFIG_PATH=\"/usr/local/opt/imagemagick@6/lib/pkgconfig\"\ngem install rmagick\n</code></pre>\n\n<hr>\n\n<ol>\n<li>Go <a href=\"https://github.com/rmagick/rmagick/issues/256\" rel=\"noreferrer\">help contribute to the upgrade effort</a> if you know Ruby and C!</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 3320, "user_id": 4950680, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/C8cEh.jpg?s=128&g=1", "display_name": "Martin Zinovsky", "link": "https://stackoverflow.com/users/4950680/martin-zinovsky"}, "is_accepted": false, "score": 1, "last_activity_date": 1560160191, "last_edit_date": 1560160191, "creation_date": 1557934197, "answer_id": 56152951, "question_id": 39494672, "link": "https://stackoverflow.com/questions/39494672/rmagick-installation-cant-find-magickwand-h/56152951#56152951", "title": "RMagick installation: Can&#39;t find MagickWand.h", "body": "<p>Got same error for alpine 3.9 image build. It comes with <a href=\"https://pkgs.alpinelinux.org/packages?name=imagemagick-dev&amp;branch=v3.9&amp;repo=main\" rel=\"nofollow noreferrer\">ImageMagick 7.0.8.38-r0</a></p>\n\n<p>To fix that you either use alpine 3.5 with <a href=\"https://pkgs.alpinelinux.org/packages?name=imagemagick-dev&amp;branch=v3.9&amp;repo=main\" rel=\"nofollow noreferrer\">ImageMagick 6.9.6.8-r1</a>:</p>\n\n<pre><code>FROM alpine:3.5\n</code></pre>\n\n<p>Or install ImageMagick 6.9.6.8-r1 with package repository for 3.5:</p>\n\n<pre><code>RUN apk add imagemagick-dev=6.9.6.8-r1 --repository http://dl-3.alpinelinux.org/alpine/v3.5/main/\n</code></pre>\n\n<p><a href=\"https://github.com/rmagick/rmagick/issues/256\" rel=\"nofollow noreferrer\">There is an open issue</a> in rmagick repo regarding failed builds for ImageMagick 7.0.x. so hopefully it will be fixed soon.</p>\n"}], "owner": {"reputation": 24150, "user_id": 771581, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/swQMb.jpg?s=128&g=1", "display_name": "0x4a6f4672", "link": "https://stackoverflow.com/users/771581/0x4a6f4672"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45282, "favorite_count": 58, "accepted_answer_id": 40108689, "answer_count": 20, "score": 174, "last_activity_date": 1611367727, "creation_date": 1473867854, "last_edit_date": 1495540051, "question_id": 39494672, "link": "https://stackoverflow.com/questions/39494672/rmagick-installation-cant-find-magickwand-h", "title": "RMagick installation: Can&#39;t find MagickWand.h", "body": "<p>Updating <a href=\"https://github.com/rmagick/rmagick\" rel=\"noreferrer\">RMagick</a> and <a href=\"http://www.imagemagick.org\" rel=\"noreferrer\">Imagemagick</a> is a painful expierence. I have updated the Imagemagick version on my mac (MacOS El Capitan Version 10.11.5) with homebrew for one project in Ruby 2.3 to <code>6.9.5-9</code> </p>\n\n<pre><code>$ convert --version\nVersion: ImageMagick 6.9.5-9 Q16 x86_64 2016-09-09\n</code></pre>\n\n<p>Now an older project in Ruby 1.8.7 refuses to work with the error message \"this installation of RMagick was configured with ImageMagick 6.8.9 but ImageMagick 6.9.5-9 is in use\". Thus I uninstalled \"rmagick\", but it can not be installed again</p>\n\n<pre><code>$ gem install rmagick -v 2.16.0\nBuilding native extensions.  This could take a while...\nERROR:  Error installing rmagick:\nERROR: Failed to build gem native extension.\n\nchecking for /usr/local/opt/gcc46/bin/gcc-4.6... yes\nchecking for Magick-config... yes\nchecking for outdated ImageMagick version (&lt;= 6.4.9)... no\nchecking for presence of MagickWand API (ImageMagick version &gt;= 6.9.0)... no\nchecking for Ruby version &gt;= 1.8.5... yes\nchecking for stdint.h... no\nchecking for sys/types.h... no\nchecking for wand/MagickWand.h... no\n\nCan't install RMagick 2.16.0. Can't find MagickWand.h. \n</code></pre>\n\n<p>And if it can not be installed, the whole application can not be started. I tried all the answers from <a href=\"https://stackoverflow.com/questions/9050419/cant-install-rmagick-2-13-1-cant-find-magickwand-h\">here</a>, and none of them works on MacOS :-( I reinstalled imagemagick and pkg-config with homebrew, and tried various version of RMagick without success. 2.16.0 is the latest version of <a href=\"https://rubygems.org/gems/rmagick\" rel=\"noreferrer\">RMagick</a> currently. </p>\n\n<p>MagicWand seems to be used in ImageMagick version > 6.9, and it can be found on the machine: </p>\n\n<pre><code>find /usr/local -name MagickWand.h\n=&gt; /usr/local/Cellar/imagemagick/6.9.5-9_1/include/ImageMagick-6/wand/MagickWand.h\n\nfind /usr/local -name MagickWand.pc\n=&gt; /usr/local/Cellar/imagemagick/6.9.5-9_1/lib/pkgconfig/MagickCore.pc\n</code></pre>\n\n<p>It does not work even if I specifiy the these paths during the gem install (same error as above) :-(</p>\n\n<pre><code>C_INCLUDE_PATH=/usr/local/Cellar/imagemagick/6.9.5-9_1/include/ImageMagick-6 PKG_CONFIG_PATH=/usr/local/lib/pkgconfig gem install rmagick\n</code></pre>\n\n<p>UPDATE:</p>\n\n<p>The error only occurs for Ruby 1.8.7, it is possible to install RMagick for Ruby 2.0 and Ruby 2.3. Ruby 1.8.7 and ImageMagick 6.9.5 do not seem to be compatible.</p>\n\n<ul>\n<li>Ruby 1.8.7 x</li>\n<li>Ruby 2.0.0 \u2713 </li>\n<li>Ruby 2.3.1 \u2713 </li>\n</ul>\n"}, {"tags": ["javascript", "jquery", "ruby-on-rails", "ruby", "turbolinks"], "answers": [{"comments": [{"owner": {"reputation": 803, "user_id": 4739356, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2840861b630380bb691a2e7b793c22ca?s=128&d=identicon&r=PG&f=1", "display_name": "M.T Davis", "link": "https://stackoverflow.com/users/4739356/m-t-davis"}, "edited": false, "score": 0, "creation_date": 1473868478, "post_id": 39494359, "comment_id": 66307066, "body": "Doesn&#39;t look like this worked for me. <code>var ready; ready = function() { &#47;&#47; My JS code $(document).ready(ready); $(document).on(&#39;turbolinks:reload&#39;, ready);</code>"}, {"owner": {"reputation": 1329, "user_id": 4341902, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/GA0Ju.jpg?s=128&g=1", "display_name": "Billy Ferguson", "link": "https://stackoverflow.com/users/4341902/billy-ferguson"}, "edited": false, "score": 0, "creation_date": 1495126750, "post_id": 39494359, "comment_id": 75132554, "body": "You have <code>reload</code> instead of <code>load</code>"}], "tags": [], "owner": {"reputation": 4265, "user_id": 4601088, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bN143.jpg?s=128&g=1", "display_name": "Bart\u0142omiej G\u0142adys", "link": "https://stackoverflow.com/users/4601088/bart%c5%82omiej-g%c5%82adys"}, "is_accepted": false, "score": 0, "last_activity_date": 1473867028, "creation_date": 1473867028, "answer_id": 39494359, "question_id": 39494229, "link": "https://stackoverflow.com/questions/39494229/loading-javascript-in-rails-app/39494359#39494359", "title": "Loading JavaScript in Rails App", "body": "<p>maybe try this ?</p>\n\n<pre><code>$(document).on('turbolinks:load', ready);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1329, "user_id": 4341902, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/GA0Ju.jpg?s=128&g=1", "display_name": "Billy Ferguson", "link": "https://stackoverflow.com/users/4341902/billy-ferguson"}, "is_accepted": false, "score": 0, "last_activity_date": 1495126667, "creation_date": 1495126667, "answer_id": 44053820, "question_id": 39494229, "link": "https://stackoverflow.com/questions/39494229/loading-javascript-in-rails-app/44053820#44053820", "title": "Loading JavaScript in Rails App", "body": "<pre><code>$(document).on('turbolinks:load', function() {\n  //My JS Code\n}) \n</code></pre>\n\n<p>This should work for you.</p>\n"}], "owner": {"reputation": 803, "user_id": 4739356, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2840861b630380bb691a2e7b793c22ca?s=128&d=identicon&r=PG&f=1", "display_name": "M.T Davis", "link": "https://stackoverflow.com/users/4739356/m-t-davis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 369, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1495126667, "creation_date": 1473866648, "last_edit_date": 1473868360, "question_id": 39494229, "link": "https://stackoverflow.com/questions/39494229/loading-javascript-in-rails-app", "title": "Loading JavaScript in Rails App", "body": "<p>I'm trying to initiate a JS file when clicking on a link \"link_to\" in my rails app.</p>\n\n<p>I ensured the the  asset pipeline is working correctly by testing with</p>\n\n<pre><code>$(document).ready(function() {\n    alert(\"test\");\n});\n</code></pre>\n\n<p>and the alert popups without a problem.</p>\n\n<p>However, the script only loads when I refresh after the page is loaded. I've tried the code below without any luck but as I said, it works once the page is reload.</p>\n\n<pre><code>var ready;\nready = function() {\n\n  //My JS Code\n\n};\n\n$(document).ready(ready);\n$(document).on('page:load', ready);\n</code></pre>\n\n<p>I have the Turbolinks gem file complied Gem file below</p>\n\n<pre><code>//= require jquery\n//= require jquery.turbolinks\n//= require jquery_ujs\n//= require bootstrap-sprockets\n//= require jquery.slimscroll\n//= require app\n//= require zopim\n//= require turbolinks\n</code></pre>\n\n<p>I'm sure it's something small I'm missing. I've seen examples using coffee script but I don't know enough about it to use it at this time.</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>While monitoring Network under Chrome Dev tools, I noticed  that none of the JS load until I hit F5 to reload the page but I don't seem to have problems with the other scripts. This might be a separate issue.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "algorithm", "time-complexity", "permutation"], "comments": [{"owner": {"reputation": 5308, "user_id": 4038191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10ec10e81b5315fe2147c38bf3e15e9e?s=128&d=identicon&r=PG", "display_name": "EvilTak", "link": "https://stackoverflow.com/users/4038191/eviltak"}, "edited": false, "score": 4, "creation_date": 1473867948, "post_id": 39493924, "comment_id": 66306762, "body": "<a href=\"https://github.com/ruby/ruby/blob/trunk/array.c#L5218\" rel=\"nofollow noreferrer\">This for <code>repeated_permutation</code></a> and <a href=\"https://github.com/ruby/ruby/blob/trunk/array.c#L4979\" rel=\"nofollow noreferrer\">this for <code>permutation</code></a> (more context for <code>permutation</code> <a href=\"https://github.com/ruby/ruby/blob/trunk/array.c#L5081\" rel=\"nofollow noreferrer\">here</a>) will help you."}], "answers": [{"comments": [{"owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "edited": false, "score": 0, "creation_date": 1482526426, "post_id": 41089405, "comment_id": 69818428, "body": "Kudos for measuring the time! But you did not answer their second question, which is how the Ruby algorithm works."}, {"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "reply_to_user": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "edited": false, "score": 0, "creation_date": 1482526931, "post_id": 41089405, "comment_id": 69818612, "body": "How nice of you to write &quot;Kudos&quot; but still downvote my answer. Why exactly? Half an answer is still better than none at all. I wrote this answer after 3 months of inactivity, even though it seemed to interest a few people."}], "tags": [], "owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "is_accepted": true, "score": 2, "last_activity_date": 1481479981, "last_edit_date": 1592644375, "creation_date": 1481479981, "answer_id": 41089405, "question_id": 39493924, "link": "https://stackoverflow.com/questions/39493924/what-is-the-time-complexity-of-rubys-built-in-permutation-and-repeated-permut/41089405#41089405", "title": "What is the time complexity of Ruby&#39;s built in #permutation and #repeated_permutation methods?", "body": "<h1>Permutation</h1>\n<p><a href=\"https://ruby-doc.org/core-2.2.0/Array.html#method-i-permutation\" rel=\"nofollow noreferrer\"><code>Array#permutation</code></a> returns an Enumerator with <code>n!</code> Arrays, so the time complexity will be at least <code>O(n!)</code>.</p>\n<p>I wrote this method :</p>\n<pre><code>def slow_method(n)\n  (1..n).to_a.permutation.each do |p|\n    p\n  end\nend\n</code></pre>\n<p>It doesn't do anything with <code>p</code>, expect forcing the generation of all the permutations. Building an Array of all the permutations would use too much memory.</p>\n<p>This method was called 10 times for n between 10 and 13, and the average times in seconds were :</p>\n<pre><code>t10 = 0.618895\nt11 = 6.7815425\nt12 = 82.896605\nt13 = 1073.015602\n</code></pre>\n<p><code>O(n!)</code> looks like a reasonable approximation :</p>\n<pre><code>t13/fact(13)*fact(12)/t12 #=&gt; 0.995694114280165\nt13/fact(13)*fact(11)/t11 #=&gt; 1.0142685297667369\nt13/fact(13)*fact(10)/t10 #=&gt; 1.0103498450722133\n</code></pre>\n<p><code>O(n*n!)</code> doesn't :</p>\n<pre><code>t13/(fact(13)*13)*fact(12)*12/t12 #=&gt; 0.9191022593355369\nt13/(fact(13)*13)*fact(11)*11/t11 #=&gt; 0.8582272174949312\nt13/(fact(13)*13)*fact(10)*10/t10 #=&gt; 0.777192188517087\n</code></pre>\n<p>The generation seems to be <code>O(n!)</code>, but doing anything with the generated Arrays would bring the overall complexity to <code>O(n*n!)</code>.</p>\n<p>Why isn't the generation <code>O(n*n!)</code>? It could come from the fact that when recursively generating <code>[1,2,3,4,5].permutation</code>, the remaining permutations are the same for <code>[1,2]</code> and <code>[2,1]</code>.</p>\n<p><code>O(n!)</code> is already so slow that <code>n</code> will never be much bigger than 10, so <code>O(n*n!)</code> isn't much worse. For <code>n=20</code>, <code>n!</code> is <code>2432902008176640000</code> and <code>n*n!</code> is <code>48658040163532800000</code>.</p>\n<h1>Repeated Permutation</h1>\n<p><code>[1,2,...n].repeated_permutation(k)</code> generates <code>n**k</code> Arrays of k elements.</p>\n<p>The complexity should be either <code>O(n**k)</code> or <code>O(k*n**k)</code>.</p>\n<p>For <code>k=n</code>, it becomes <code>O(n**n)</code> or <code>O(n**(n+1))</code>, which is even (much) worse than for <code>permutation</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 48049, "user_id": 6419007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/CwqtX.jpg?s=128&g=1", "display_name": "Eric Duminil", "link": "https://stackoverflow.com/users/6419007/eric-duminil"}, "edited": false, "score": 0, "creation_date": 1482527200, "post_id": 41307686, "comment_id": 69818705, "body": "Steps 1 and 2 look like <code>O(n)</code>. Could you please explain why every step is O(1)?"}], "tags": [], "owner": {"reputation": 25823, "user_id": 24468, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/PWl6C.png?s=128&g=1", "display_name": "akuhn", "link": "https://stackoverflow.com/users/24468/akuhn"}, "is_accepted": false, "score": 0, "last_activity_date": 1482526148, "creation_date": 1482526148, "answer_id": 41307686, "question_id": 39493924, "link": "https://stackoverflow.com/questions/39493924/what-is-the-time-complexity-of-rubys-built-in-permutation-and-repeated-permut/41307686#41307686", "title": "What is the time complexity of Ruby&#39;s built in #permutation and #repeated_permutation methods?", "body": "<p>There are algorithms to iteratively generate all permutations of a list. </p>\n\n<p>How? The algorithm generates all permutations of <code>[1,2,3,4,...,n]</code> in lexicographic order. Given one permutation the algorithm generates the next lexicographic permutation in <code>O(1)</code> time. </p>\n\n<p>These are the steps</p>\n\n<ul>\n<li>Find the largest index <code>k</code> such that <code>a[k] &lt; a[k + 1]</code>, if no such index exists the permutation is the last permutation</li>\n<li>Find the largest index <code>l</code> greater than <code>k</code> such that <code>a[k] &lt; a[l]</code></li>\n<li>Swap the value of <code>a[k]</code> with that of <code>a[l]</code></li>\n<li>Reverse the sequence from <code>a[k + 1]</code> up to and including the final element <code>a[n]</code></li>\n</ul>\n\n<p>What is the complexity?</p>\n\n<p>Each step is <code>O(1)</code> and there are <code>O(n!)</code> permutations, so the total complexity is <code>O(n!)</code>.</p>\n"}], "owner": {"reputation": 600, "user_id": 5994561, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh5.googleusercontent.com/-VGTzdts3mMw/AAAAAAAAAAI/AAAAAAAAADY/6Qwn_AVjnQI/photo.jpg?sz=128", "display_name": "sammms", "link": "https://stackoverflow.com/users/5994561/sammms"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 752, "favorite_count": 0, "accepted_answer_id": 41089405, "answer_count": 2, "score": 10, "last_activity_date": 1482526148, "creation_date": 1473865669, "question_id": 39493924, "link": "https://stackoverflow.com/questions/39493924/what-is-the-time-complexity-of-rubys-built-in-permutation-and-repeated-permut", "title": "What is the time complexity of Ruby&#39;s built in #permutation and #repeated_permutation methods?", "body": "<p>I've been wondering about the time complexity of some of Ruby's built-in methods, these two in particular.  I think the best I've been able to come up with for a permutation method on my own is \u0398(n \u00b7 n!), does Ruby's built-in perform better?  If so, please help me understand their algorithm. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 91121, "user_id": 179125, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5594142dcc49a24b1902ec8059181f8d?s=128&d=identicon&r=PG&f=1", "display_name": "Jordan Running", "link": "https://stackoverflow.com/users/179125/jordan-running"}, "edited": false, "score": 0, "creation_date": 1473868850, "post_id": 39493940, "comment_id": 66307315, "body": "In Ruby 2.3 you can use the safe navigation operator instead: <code>object.user_performance&amp;.something</code>."}], "tags": [], "owner": {"reputation": 4265, "user_id": 4601088, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bN143.jpg?s=128&g=1", "display_name": "Bart\u0142omiej G\u0142adys", "link": "https://stackoverflow.com/users/4601088/bart%c5%82omiej-g%c5%82adys"}, "is_accepted": true, "score": 0, "last_activity_date": 1473865712, "creation_date": 1473865712, "answer_id": 39493940, "question_id": 39493906, "link": "https://stackoverflow.com/questions/39493906/active-record-object-handle-nil/39493940#39493940", "title": "active record object, handle nil", "body": "<p>You can use <code>try</code> method</p>\n\n<pre><code>object.user_performance.try(:something) \n</code></pre>\n\n<p>if user_performance will be nil it will return nil :)</p>\n\n<p>You can also handle this:</p>\n\n<pre><code>if object.user_performance.nil?\n   #ups error what next?\nelse\n   object.user_performance.something\nend\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 6721436, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/92f391d6f5d1a7c0c2757ea600cb92d1?s=128&d=identicon&r=PG&f=1", "display_name": "Giovani", "link": "https://stackoverflow.com/users/6721436/giovani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 39493940, "answer_count": 1, "score": 0, "last_activity_date": 1473865712, "creation_date": 1473865614, "question_id": 39493906, "link": "https://stackoverflow.com/questions/39493906/active-record-object-handle-nil", "title": "active record object, handle nil", "body": "<p>I have a class as below</p>\n\n<pre><code>class UserPerformance &lt; ActiveRecord::Base\n  belongs_to :user\nend\n</code></pre>\n\n<p>and I'm using <code>object.user_performance.something</code> in my views and specs, but if <code>user_performance</code> is nil it will throw an error. What is the correct way to handle that? </p>\n\n<p>I cannot do in specs: <code>... to eq(something: object.user_performance.something if object.user_performance)</code> etc and I wish to get nil everytime I do <code>object.user_performance.something</code> when <code>user_performance</code> is nil.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "apache", "passenger", "redmine"], "comments": [{"owner": {"reputation": 8946, "user_id": 2398521, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/84bb49c56756a8c7cd54d4876d7a4467?s=128&d=identicon&r=PG", "display_name": "Maxim", "link": "https://stackoverflow.com/users/2398521/maxim"}, "edited": false, "score": 0, "creation_date": 1473869174, "post_id": 39493194, "comment_id": 66307510, "body": "Did you restart Apache to apply changes in configuration file?"}, {"owner": {"reputation": 83, "user_id": 5473243, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-i3aSTMAlwU8/AAAAAAAAAAI/AAAAAAAAAKk/7gBruX-poxA/photo.jpg?sz=128", "display_name": "mohamed tehami", "link": "https://stackoverflow.com/users/5473243/mohamed-tehami"}, "reply_to_user": {"reputation": 8946, "user_id": 2398521, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/84bb49c56756a8c7cd54d4876d7a4467?s=128&d=identicon&r=PG", "display_name": "Maxim", "link": "https://stackoverflow.com/users/2398521/maxim"}, "edited": false, "score": 0, "creation_date": 1473924604, "post_id": 39493194, "comment_id": 66327450, "body": "Yes i did serval times"}, {"owner": {"reputation": 8946, "user_id": 2398521, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/84bb49c56756a8c7cd54d4876d7a4467?s=128&d=identicon&r=PG", "display_name": "Maxim", "link": "https://stackoverflow.com/users/2398521/maxim"}, "edited": false, "score": 0, "creation_date": 1473926133, "post_id": 39493194, "comment_id": 66328224, "body": "Did you check that PID of nginx and passenger processes were change after restart? Sometimes init.d or other the same initialization scripts doesn&#39;t work as expected and don&#39;t notify about problems."}, {"owner": {"reputation": 83, "user_id": 5473243, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-i3aSTMAlwU8/AAAAAAAAAAI/AAAAAAAAAKk/7gBruX-poxA/photo.jpg?sz=128", "display_name": "mohamed tehami", "link": "https://stackoverflow.com/users/5473243/mohamed-tehami"}, "reply_to_user": {"reputation": 8946, "user_id": 2398521, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/84bb49c56756a8c7cd54d4876d7a4467?s=128&d=identicon&r=PG", "display_name": "Maxim", "link": "https://stackoverflow.com/users/2398521/maxim"}, "edited": false, "score": 0, "creation_date": 1473934171, "post_id": 39493194, "comment_id": 66333194, "body": "Yes there is PID changes"}], "answers": [{"tags": [], "owner": {"reputation": 542, "user_id": 1362609, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c19a12f3ba85554a677d20ca6e280c4?s=128&d=identicon&r=PG", "display_name": "Kirill Bezrukov", "link": "https://stackoverflow.com/users/1362609/kirill-bezrukov"}, "is_accepted": true, "score": 2, "last_activity_date": 1473930430, "creation_date": 1473930430, "answer_id": 39507115, "question_id": 39493194, "link": "https://stackoverflow.com/questions/39493194/redmine-apache-passenger-passenger-still-runs-as-nobody/39507115#39507115", "title": "Redmine + apache+ Passenger: Passenger still runs as nobody", "body": "<p>Try to set www-data as owner for /config.ru file. </p>\n"}], "owner": {"reputation": 83, "user_id": 5473243, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh3.googleusercontent.com/-i3aSTMAlwU8/AAAAAAAAAAI/AAAAAAAAAKk/7gBruX-poxA/photo.jpg?sz=128", "display_name": "mohamed tehami", "link": "https://stackoverflow.com/users/5473243/mohamed-tehami"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 656, "favorite_count": 0, "accepted_answer_id": 39507115, "answer_count": 1, "score": 1, "last_activity_date": 1473951191, "creation_date": 1473863755, "last_edit_date": 1473951191, "question_id": 39493194, "link": "https://stackoverflow.com/questions/39493194/redmine-apache-passenger-passenger-still-runs-as-nobody", "title": "Redmine + apache+ Passenger: Passenger still runs as nobody", "body": "<p>I'm installing a new version of Redmine under Debian 8. I followed the steps described here: <a href=\"http://www.redmine.org/projects/redmine/wiki/HowTo_Install_Redmine_on_Debian_8_with_Apache2-Passenger\" rel=\"nofollow\">http://www.redmine.org/projects/redmine/wiki/HowTo_Install_Redmine_on_Debian_8_with_Apache2-Passenger</a></p>\n\n<p>I had some problems with passenger so I installed it using: </p>\n\n<pre><code>gem install passenger\npassenger-install-apache2-module\n</code></pre>\n\n<p>I added</p>\n\n<pre><code>PassengerDefaultUser www-data\n</code></pre>\n\n<p>on the passenger confing file and on the appache config file as well to avoid permission problems</p>\n\n<p>The problem is that passenger is still running as <code>nobody</code>.</p>\n\n<p>result of <code>top | grep \"passenger\"</code> gives 3 process named <code>PassengerAgent</code>, 2 of them runs as <code>root</code> and one runs as <code>nobody</code>. What should I do to have the effect of the configuration i added?</p>\n\n<p>I have :</p>\n\n<ul>\n<li>Redmine version 3.3.0.stable</li>\n<li>Ruby version 2.1.5-p273 (2014-11-13)</li>\n<li>Rails version 4.2.6</li>\n</ul>\n"}, {"tags": ["ruby-on-rails", "ruby", "post", "http-headers", "net-http"], "answers": [{"comments": [{"owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1473866276, "post_id": 39493473, "comment_id": 66305654, "body": "Thanks but  I want to add the headers to the object before it is sent.  How can I add the headers into the POST request object itself or is that impossible?"}, {"owner": {"reputation": 1272, "user_id": 3338159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6132bd030583e478dbc41c369f410ad6?s=128&d=identicon&r=PG&f=1", "display_name": "T J", "link": "https://stackoverflow.com/users/3338159/t-j"}, "reply_to_user": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1473872062, "post_id": 39493473, "comment_id": 66309148, "body": "The request will not be made until the <code>http.post</code> call which in the code above will have your headers correctly attached."}], "tags": [], "owner": {"reputation": 1272, "user_id": 3338159, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6132bd030583e478dbc41c369f410ad6?s=128&d=identicon&r=PG&f=1", "display_name": "T J", "link": "https://stackoverflow.com/users/3338159/t-j"}, "is_accepted": false, "score": 2, "last_activity_date": 1473864474, "creation_date": 1473864474, "answer_id": 39493473, "question_id": 39493047, "link": "https://stackoverflow.com/questions/39493047/how-do-you-add-headers-to-a-nethttppost-request-in-ruby/39493473#39493473", "title": "How do you add headers to a Net::Http::Post request in Ruby?", "body": "<p>You can use the instance to make the post with headers</p>\n\n<pre><code>headers  = {\"Referer\" =&gt; url}\nhttp     = Net::HTTP.new(uri.host)\nresponse = http.post(uri.path, params.to_query, headers)\n</code></pre>\n"}], "owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3785, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474033301, "creation_date": 1473863402, "question_id": 39493047, "link": "https://stackoverflow.com/questions/39493047/how-do-you-add-headers-to-a-nethttppost-request-in-ruby", "title": "How do you add headers to a Net::Http::Post request in Ruby?", "body": "<p>I\u2019m using Rails 4.2.7.  How do I add headers to a Net::HTTP::Post request?  I tried</p>\n\n<pre><code>    params = {\"SubmitButton\" =&gt; \"View\"}\n    \u2026\n      headers = {\"Referer\" =&gt; url}\n      req = Net::HTTP::Post.new(uri, params.to_query, headers)\n</code></pre>\n\n<p>However when I run this code I get the error</p>\n\n<pre><code>Error during processing: wrong number of arguments (given 3, expected 1..2)\n/Users/davea/.rvm/rubies/ruby-2.3.0/lib/ruby/2.3.0/net/http/request.rb:14:in `initialize'\n/Users/davea/Documents/workspace/myproject/app/services/marathon_guide_race_finder_service.rb:97:in `new'\n/Users/davea/Documents/workspace/myproject/app/services/marathon_guide_race_finder_service.rb:97:in `block in process_race_link'\n/Users/davea/.rvm/gems/ruby-2.3.0/gems/nokogiri-1.6.8/lib/nokogiri/xml/node_set.rb:187:in `block in each'\n/Users/davea/.rvm/gems/ruby-2.3.0/gems/nokogiri-1.6.8/lib/nokogiri/xml/node_set.rb:186:in `upto'\n/Users/davea/.rvm/gems/ruby-2.3.0/gems/nokogiri-1.6.8/lib/nokogiri/xml/node_set.rb:186:in `each'\n</code></pre>\n\n<p>Note I want to add the headers to the object before it is sent.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "logging", "output"], "comments": [{"owner": {"reputation": 79161, "user_id": 1064226, "user_type": "registered", "profile_image": "https://graph.facebook.com/36912842/picture?type=large", "display_name": "Frederick Cheung", "link": "https://stackoverflow.com/users/1064226/frederick-cheung"}, "edited": false, "score": 0, "creation_date": 1473865772, "post_id": 39492933, "comment_id": 66305286, "body": "Maybe list the gems in your Gemfile.lock ? (perhaps omitting the ones that are definitely not it). Are you sure it is not something in the app?"}], "answers": [{"comments": [{"owner": {"reputation": 2409, "user_id": 6307730, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/4QkXN.jpg?s=128&g=1", "display_name": "BrunoFacca", "link": "https://stackoverflow.com/users/6307730/brunofacca"}, "edited": false, "score": 0, "creation_date": 1552229843, "post_id": 39493220, "comment_id": 96922632, "body": "This project was abandoned for a while but now it is maintained again and just got a couple of new releases."}], "tags": [], "owner": {"reputation": 9572, "user_id": 2305826, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xRwWw.png?s=128&g=1", "display_name": "MarsAtomic", "link": "https://stackoverflow.com/users/2305826/marsatomic"}, "is_accepted": false, "score": 1, "last_activity_date": 1473863804, "creation_date": 1473863804, "answer_id": 39493220, "question_id": 39492933, "link": "https://stackoverflow.com/questions/39492933/what-gem-produces-this-output-called-from/39493220#39493220", "title": "What gem produces this output &#39;\\_ Called from:&#39;", "body": "<p>Looks like <a href=\"https://github.com/ruckus/active-record-query-trace\" rel=\"nofollow\">Active Record Query Trace</a>:</p>\n\n<blockquote>\n  <p>When enabled every query source will be logged like:</p>\n</blockquote>\n\n<pre><code>  IntuitAccount Load (1.2ms)  SELECT \"intuit_accounts\".* FROM \"intuit_accounts\" WHERE \"intuit_accounts\".\"user_id\" = 20 LIMIT 1\nCalled from:\n  app/views/users/edit.html.haml:78:in `block in _app_views_users_edit_html_haml___1953197429694975654_70177901460360'\n  app/views/users/edit.html.haml:16:in `_app_views_users_edit_html_haml___1953197429694975654_70177901460360'\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 517, "user_id": 1339894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0961c63fc7d8563f8e7358a2b5864158?s=128&d=identicon&r=PG", "display_name": "stef", "link": "https://stackoverflow.com/users/1339894/stef"}, "is_accepted": false, "score": 0, "last_activity_date": 1473924570, "creation_date": 1473924570, "answer_id": 39505324, "question_id": 39492933, "link": "https://stackoverflow.com/questions/39492933/what-gem-produces-this-output-called-from/39505324#39505324", "title": "What gem produces this output &#39;\\_ Called from:&#39;", "body": "<p>I found it in projects lib folder. If anyone is interesed here is a simple code:</p>\n\n<pre><code>module QueryTrace\n  def self.enable!\n    ::ActiveRecord::LogSubscriber.send(:include, self)\n  end\n\n  def self.append_features(klass)\n    super\n    klass.class_eval do\n      unless method_defined?(:log_info_without_trace)\n        alias_method :log_info_without_trace, :sql\n        alias_method :sql, :log_info_with_trace\n      end\n    end\n  end\n\n  def log_info_with_trace(event)\n    begin\n    log_info_without_trace(event)\n    trace_log = Rails.backtrace_cleaner.clean(caller).first\n    if trace_log &amp;&amp; event.payload[:name] != 'SCHEMA'\n      logger.debug(\"   \\\\_ \\e[33mCalled from:\\e[0m \" + trace_log)\n    end\n    rescue\n    end\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 517, "user_id": 1339894, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0961c63fc7d8563f8e7358a2b5864158?s=128&d=identicon&r=PG", "display_name": "stef", "link": "https://stackoverflow.com/users/1339894/stef"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1473924570, "creation_date": 1473863118, "question_id": 39492933, "link": "https://stackoverflow.com/questions/39492933/what-gem-produces-this-output-called-from", "title": "What gem produces this output &#39;\\_ Called from:&#39;", "body": "<p>I started working on a existing rails project and in the rails server output there are these extra lines:</p>\n\n<pre><code>User Load (10.3ms)  SELECT \"users\".* FROM \"users\" WHERE \"users\".\"email\" = 'miles@milestshirts.com' LIMIT 1\n\\_ Called from: app/controllers/application_controller.rb:10:in `block in &lt;class:ApplicationController&gt;'\n</code></pre>\n\n<p>Basically for each SQL query in my rails app it adds a line who called it.\nI can't seem to find it in the Gemfile as it has over a 150 gems.</p>\n\n<p>And it is not <a href=\"https://github.com/ruckus/active-record-query-trace\" rel=\"nofollow\">https://github.com/ruckus/active-record-query-trace</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rails-i18n"], "comments": [{"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1473863129, "post_id": 39492189, "comment_id": 66303372, "body": "Would you consider a solution where the link is to <code>www.exempel.se&#47;denna-bloggpost?locale=es</code>, but upon clicking this it redirects you to <code>es.exempel.com&#47;denna-bloggpost</code>?"}, {"owner": {"reputation": 2103, "user_id": 916691, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/67aa4724f58e7091e24833b24b090264?s=128&d=identicon&r=PG", "display_name": "Christoffer", "link": "https://stackoverflow.com/users/916691/christoffer"}, "reply_to_user": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1473863256, "post_id": 39492189, "comment_id": 66303469, "body": "I really would prefer not (thought about that as well) since it would likely confuse Google."}], "answers": [{"comments": [{"owner": {"reputation": 2103, "user_id": 916691, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/67aa4724f58e7091e24833b24b090264?s=128&d=identicon&r=PG", "display_name": "Christoffer", "link": "https://stackoverflow.com/users/916691/christoffer"}, "edited": false, "score": 0, "creation_date": 1473918898, "post_id": 39493462, "comment_id": 66325019, "body": "Thanks for the help but your solution does not work due to the fact that request.env[&#39;PATH_INFO&#39;] collects the current path like (/denna-bloggpost) and adds it to the base_url to create &quot;es.example.com/denna-bloggpost&quot; instead of es.example.com/este-posto-de-bloggo. I thought there would be a more &#39;elegant&#39; solution to this using :locale =&gt; :es but just tell Rails to, instead of using ?locale=es use my default url-system. Is there no solution like that?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 2103, "user_id": 916691, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/67aa4724f58e7091e24833b24b090264?s=128&d=identicon&r=PG", "display_name": "Christoffer", "link": "https://stackoverflow.com/users/916691/christoffer"}, "edited": false, "score": 0, "creation_date": 1473935691, "post_id": 39493462, "comment_id": 66334051, "body": "Ah right sorry, I forgot that point. So you all need to do is create some function that maps the current route (possibly with the current locale), to the corresponding route for a different locale? E.g. <code>translate_route(&quot;denna-bloggpost&quot;, :en, :fr) == &quot;este-posto-de-bloggo&quot;</code>? What seems like a very application-specific problem, so I&#39;d need to know more about how your routing model currently works -- but I don&#39;t imagine creating such a method would be too hard?"}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "reply_to_user": {"reputation": 2103, "user_id": 916691, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/67aa4724f58e7091e24833b24b090264?s=128&d=identicon&r=PG", "display_name": "Christoffer", "link": "https://stackoverflow.com/users/916691/christoffer"}, "edited": false, "score": 0, "creation_date": 1473935790, "post_id": 39493462, "comment_id": 66334107, "body": "Also, a quick google search found me <a href=\"https://github.com/enriclluelles/route_translator\" rel=\"nofollow noreferrer\">this</a>, which may potentially help..."}, {"owner": {"reputation": 2103, "user_id": 916691, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/67aa4724f58e7091e24833b24b090264?s=128&d=identicon&r=PG", "display_name": "Christoffer", "link": "https://stackoverflow.com/users/916691/christoffer"}, "edited": false, "score": 0, "creation_date": 1474311398, "post_id": 39493462, "comment_id": 66470309, "body": "Thanks again Tom. It seems, however, that this solution is just leading further away from a &quot;real&quot; answer. I am just assuming then that this can be solved more out of the box. I am running translated routes already etc but my real issue is that the link_to with locale does not map up with that translated route."}], "tags": [], "owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "is_accepted": false, "score": 1, "last_activity_date": 1473864420, "creation_date": 1473864420, "answer_id": 39493462, "question_id": 39492189, "link": "https://stackoverflow.com/questions/39492189/link-to-corresponding-path-in-other-locale-rails/39493462#39493462", "title": "Link to corresponding path in other locale (rails)", "body": "<p>In order to create such a dynamic mapping, you must presumably have something like this defined in your application config:</p>\n\n<pre><code>APP_CONFIG = {\n  # ...\n  base_urls: {\n    se: 'exempel.se',\n    en: 'example.com',\n    fr: 'fr.example.com',\n    es: 'es.example.com'\n  }\n  # ...\n}\n</code></pre>\n\n<p>(It wouldn't necessarily need to be in this format, of course; this is just an example.)</p>\n\n<p>In the locale switching menu, you can then define your links like this:</p>\n\n<pre><code>link_to(\"French\", \"#{APP_CONFIG[:base_urls][:fr]}#{request.env['PATH_INFO']}\")\n</code></pre>\n\n<hr>\n\n<p>In order to actually <strong>set</strong> the locale in your application, you could then place something like this in your <code>ApplicationController</code>:</p>\n\n<pre><code>class ApplicationController\n  before_action :set_locale\n\n  def set_locale\n    I18n.locale = APP_CONFIG[:base_urls].key(request.host) || I18n.default_locale\n  end\nend\n</code></pre>\n\n<p>For more information, see here: <a href=\"http://guides.rubyonrails.org/i18n.html#managing-the-locale-across-requests\" rel=\"nofollow\">http://guides.rubyonrails.org/i18n.html#managing-the-locale-across-requests</a></p>\n"}, {"comments": [{"owner": {"reputation": 2103, "user_id": 916691, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/67aa4724f58e7091e24833b24b090264?s=128&d=identicon&r=PG", "display_name": "Christoffer", "link": "https://stackoverflow.com/users/916691/christoffer"}, "edited": false, "score": 0, "creation_date": 1491028198, "post_id": 43112583, "comment_id": 73383550, "body": "Thanks, this probably works fine, but this is still not a generic solution since it requires &quot;posts_&quot;. Thus, I need to define this for every different view and cannot have it in the application.html.erb."}, {"owner": {"reputation": 5382, "user_id": 7671538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3506350bc4dd02281ad7f99e8e84715c?s=128&d=identicon&r=PG&f=1", "display_name": "gwcodes", "link": "https://stackoverflow.com/users/7671538/gwcodes"}, "reply_to_user": {"reputation": 2103, "user_id": 916691, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/67aa4724f58e7091e24833b24b090264?s=128&d=identicon&r=PG", "display_name": "Christoffer", "link": "https://stackoverflow.com/users/916691/christoffer"}, "edited": false, "score": 0, "creation_date": 1491044033, "post_id": 43112583, "comment_id": 73387436, "body": "@Christoffer: for a more generic solution, you can replace <code>&quot;posts&quot;</code> with <code>controller_name</code> e.g. <code>Rails.application.routes.url_helpers.send(&quot;#{controller_name&zwnj;&#8203;}_#{locale}_url&quot;, params[&#39;slug&#39;])</code>"}, {"owner": {"reputation": 2103, "user_id": 916691, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/67aa4724f58e7091e24833b24b090264?s=128&d=identicon&r=PG", "display_name": "Christoffer", "link": "https://stackoverflow.com/users/916691/christoffer"}, "edited": false, "score": 0, "creation_date": 1491132214, "post_id": 43112583, "comment_id": 73409464, "body": "Ah, perfect! That will do it then!"}], "tags": [], "owner": {"reputation": 5382, "user_id": 7671538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3506350bc4dd02281ad7f99e8e84715c?s=128&d=identicon&r=PG&f=1", "display_name": "gwcodes", "link": "https://stackoverflow.com/users/7671538/gwcodes"}, "is_accepted": true, "score": 1, "last_activity_date": 1490863058, "creation_date": 1490863058, "answer_id": 43112583, "question_id": 39492189, "link": "https://stackoverflow.com/questions/39492189/link-to-corresponding-path-in-other-locale-rails/43112583#43112583", "title": "Link to corresponding path in other locale (rails)", "body": "<p>You can use the locale-specific routes that <code>route_translator</code> generates for you. Run <code>rake routes</code> to see what these are. And then:</p>\n\n<pre><code># Create links for every other locale\n&lt;% (I18n.available_locales - I18n.locale).each |locale| do %&gt;\n  # Example URL helper here - replace with your own!\n  &lt;%= Rails.application.routes.url_helpers.send(\"posts_#{locale}_url\",\n 'denna-bloggpost') %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4075, "user_id": 2291357, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/dff442b2192921f04f324948d263e001?s=128&d=identicon&r=PG", "display_name": "Jerome", "link": "https://stackoverflow.com/users/2291357/jerome"}, "is_accepted": false, "score": 0, "last_activity_date": 1558544311, "creation_date": 1558544311, "answer_id": 56261737, "question_id": 39492189, "link": "https://stackoverflow.com/questions/39492189/link-to-corresponding-path-in-other-locale-rails/56261737#56261737", "title": "Link to corresponding path in other locale (rails)", "body": "<p>This question is addressed a number of times and many ways.  Yet the simplest approach in my opinion is</p>\n\n<pre><code>&lt;%= link_to \"\u0440\u0443\", request.params.merge( locale: 'ru' ) %&gt; \n</code></pre>\n"}], "owner": {"reputation": 2103, "user_id": 916691, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/67aa4724f58e7091e24833b24b090264?s=128&d=identicon&r=PG", "display_name": "Christoffer", "link": "https://stackoverflow.com/users/916691/christoffer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 699, "favorite_count": 0, "accepted_answer_id": 43112583, "answer_count": 3, "score": 1, "last_activity_date": 1558544311, "creation_date": 1473860919, "last_edit_date": 1490861230, "question_id": 39492189, "link": "https://stackoverflow.com/questions/39492189/link-to-corresponding-path-in-other-locale-rails", "title": "Link to corresponding path in other locale (rails)", "body": "<p>I have a multi-lingual application in Ruby on Rails 4. For that I use the following  domains:</p>\n\n<ul>\n<li>Swedish: exempel.se</li>\n<li>English: example.com</li>\n<li>French:  fr.example.com</li>\n<li>Spanish: es.example.com</li>\n</ul>\n\n<p>I want to be able to link to the corresponding path in another corresponding locale. For example if I am at www.exempel.se/denna-bloggpost I want to be able to easily link to (English/Spanish/French) to e.g. www.example.com/this-here-blog-post and es.example.com/este-posto-de-bloggo (sorry, can't speak Spanish :)). </p>\n\n<p>I understand this is done with <code>link_to 'Spanish', locale =&gt; :es</code> but this gives me the url <code>www.exempel.se/denna-bloggpost?locale=es</code> which is not what I want. I expect to access <code>es.example.com/esto-posto-de-bloggo</code></p>\n\n<p>It seems like <code>default_url_options</code> has something to do with this but I can't make it work.</p>\n\n<p>How do I solve this?</p>\n\n<p>Edit (2017-03-30): I will also need this solution for hreflang in the  section.</p>\n\n<p>I am using the <code>route_translator</code> gem.</p>\n\n<p>I have seen several solutions for this but they all include solutions with <code>?locale=en</code> or are just to simplified (like, only working for one single controller). What I am hoping for is a solution that would do something like this:</p>\n\n<pre><code>&lt;% I18n.available_locales.each |locale| do %&gt;\n &lt;% I18n.t(this route e.g. /denna-bloggpost) #=&gt; /este-posto-de-bloggo, /this-blog-post, /le-post-du-blog %&gt;\n&lt;% end %&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "web-scraping"], "comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 0, "creation_date": 1473858025, "post_id": 39491006, "comment_id": 66299723, "body": "<code>adding a jsonb column to the table</code> sounds good enough to me"}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 0, "last_activity_date": 1473858571, "creation_date": 1473858571, "answer_id": 39491315, "question_id": 39491006, "link": "https://stackoverflow.com/questions/39491006/dealing-with-incoming-data-with-aliases/39491315#39491315", "title": "Dealing with incoming data with aliases", "body": "<p>I would introduce another model, say, <code>Alias</code>, that references <code>Company</code> and basically has two columns, <code>company_id</code> and <code>alias</code>. Then one might call <code>company.aliases</code> to retrieve a list of aliases.</p>\n\n<p>That way it would be easy/fast to lookup a company when you receive an aliased name from somewhere:</p>\n\n<pre><code>Alias.find_by_alias(value_got_from_3rd_party).try(:company)\n</code></pre>\n\n<p>Obviously, there should be a record with real name in <code>aliases</code> table as well for the lookup to work smoothly.</p>\n"}], "owner": {"reputation": 1925, "user_id": 2386548, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/fb0c86baa20f25404248077f3c01e0b8?s=128&d=identicon&r=PG", "display_name": "Carpela", "link": "https://stackoverflow.com/users/2386548/carpela"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1473858571, "creation_date": 1473857731, "question_id": 39491006, "link": "https://stackoverflow.com/questions/39491006/dealing-with-incoming-data-with-aliases", "title": "Dealing with incoming data with aliases", "body": "<p>Bit of a philosophical question this one: </p>\n\n<p>We deal with lots of data that comes in via different channels. \nWe're parsing that data to try to make sense of it. </p>\n\n<p>e.g.</p>\n\n<pre><code>class Product\nattr_accessible :name, :description, :price\nhas_one :company\nend\n\nclass Company\nattr_accessible :name, :domain, :phone, :email\nvalidates_uniqueness_of :name, :domain\n\nend\n</code></pre>\n\n<p>When the data comes in the company names can vary a bit. </p>\n\n<p>e.g. </p>\n\n<pre><code>\"Acme Limited\"\n\"Acme Ltd\"\n\"Acme Ltd (Birmingham)\"\n\"Acme Ltd (London)\"\n</code></pre>\n\n<p>These are all fundamentally the same company and we'd like to store them as such and automatically assign them (once we've identified an alias).</p>\n\n<p>The variations are down to the way that third parties store the data in their APIs, or on sites which we have no control over. </p>\n\n<p>What's a good way of identifying these aliases and then converting them to the appropriate company as they arrive? </p>\n\n<p>I've thought about adding another class as an association to Company that deals with aliases. \nAlternatively, adding a jsonb column to the table where we can keep an array of aliases, so that if any match we can bring them in. </p>\n\n<p>Just seems like there should be a good solution to this that I'm not finding. </p>\n\n<p>Anyone run into this type of issue and come up with something elegant and beautiful?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1473857394, "post_id": 39490795, "comment_id": 66299266, "body": "Do you really have to post 75 lines of code to illustrate your problem? Try to create a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 1, "user_id": 4279017, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/100006600795570/picture?type=large", "display_name": "Kimberly Wright", "link": "https://stackoverflow.com/users/4279017/kimberly-wright"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1473857564, "post_id": 39490795, "comment_id": 66299371, "body": "I just posted it for complete info. you can edit it if you don&#39;t want to."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 3, "creation_date": 1473857923, "post_id": 39490795, "comment_id": 66299641, "body": "It is up to you to provide a <a href=\"http://stackoverflow.com/help/how-to-ask\">minimal viable example</a>. We already do a favour answering your questions."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 1, "creation_date": 1473858070, "post_id": 39490795, "comment_id": 66299749, "body": "@mudasobwa: I&#39;d even go as far as to say that it&#39;s her <i>responsibility/duty</i>, not just &quot;up to&quot;."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1473858243, "post_id": 39490795, "comment_id": 66299881, "body": "Also, paying attention to proper formatting of the code is far more important than worrying about SRP at this stage of your learning."}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 1, "creation_date": 1473859289, "post_id": 39490795, "comment_id": 66300589, "body": "I think you need more code now, I don&#39;t understand the question being asked :)"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4279017, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/100006600795570/picture?type=large", "display_name": "Kimberly Wright", "link": "https://stackoverflow.com/users/4279017/kimberly-wright"}, "edited": false, "score": 0, "creation_date": 1473858006, "post_id": 39491003, "comment_id": 66299708, "body": "should I add the count variable here? undefined local variable counts."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 1, "user_id": 4279017, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/100006600795570/picture?type=large", "display_name": "Kimberly Wright", "link": "https://stackoverflow.com/users/4279017/kimberly-wright"}, "edited": false, "score": 0, "creation_date": 1473858044, "post_id": 39491003, "comment_id": 66299730, "body": "Indeed, I have updated an answer."}, {"owner": {"reputation": 1, "user_id": 4279017, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/100006600795570/picture?type=large", "display_name": "Kimberly Wright", "link": "https://stackoverflow.com/users/4279017/kimberly-wright"}, "edited": false, "score": 0, "creation_date": 1473858236, "post_id": 39491003, "comment_id": 66299877, "body": "When either the player or the computer won 3x it&#39;s still shows the &quot;You won this round&quot;"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 1, "user_id": 4279017, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/100006600795570/picture?type=large", "display_name": "Kimberly Wright", "link": "https://stackoverflow.com/users/4279017/kimberly-wright"}, "edited": false, "score": 1, "creation_date": 1473858341, "post_id": 39491003, "comment_id": 66299938, "body": "Obviously, you should call <code>count_wins</code> <i>before</i> <code>display_results</code> to update <code>counts</code>."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1473858030, "last_edit_date": 1473858030, "creation_date": 1473857724, "answer_id": 39491003, "question_id": 39490795, "link": "https://stackoverflow.com/questions/39490795/ruby-method-issues/39491003#39491003", "title": "Ruby - Method Issues", "body": "<pre><code>def display_results(player, computer, counts)\n  prompt(\n    case\n    when counts[:player] == 3 then \"You won the game! Congrats!\"\n    when counts[:computer] == 3 then \"Computer won the game. Try again?\"\n    when win?(player, computer) then \"You won this round!\"\n    when win?(computer, player) then \"Computer won this round! You loose!\"\n    else \"It's a tie on this round! No one wins!\"\n    end\n  )\nend\n</code></pre>\n\n<p>One should check for a game result <em>before</em> round results.</p>\n"}], "owner": {"reputation": 1, "user_id": 4279017, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/100006600795570/picture?type=large", "display_name": "Kimberly Wright", "link": "https://stackoverflow.com/users/4279017/kimberly-wright"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 1, "closed_date": 1473858399, "answer_count": 1, "score": -5, "last_activity_date": 1473858756, "creation_date": 1473857090, "last_edit_date": 1473858756, "question_id": 39490795, "link": "https://stackoverflow.com/questions/39490795/ruby-method-issues", "closed_reason": "Not suitable for this site", "title": "Ruby - Method Issues", "body": "<p>I created 3 methods here and I need one more to output the final success message instead of the round success message. </p>\n\n<pre><code>WINNING_COMBO = {\n  'r' =&gt; ['sc', 'l'],\n  'p' =&gt; ['r', 'sp'],\n  'sc' =&gt; ['p', 'l'],\n  'l' =&gt; ['sp', 'p'],\n  'sp' =&gt; ['sc', 'r']\n}\n</code></pre>\n"}, {"tags": ["ruby", "forms", "datetime"], "answers": [{"tags": [], "owner": {"reputation": 1513, "user_id": 1334750, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/0vTHg.png?s=128&g=1", "display_name": "Pawe\u0142 Duda", "link": "https://stackoverflow.com/users/1334750/pawe%c5%82-duda"}, "is_accepted": false, "score": 1, "last_activity_date": 1473857260, "creation_date": 1473857260, "answer_id": 39490854, "question_id": 39490746, "link": "https://stackoverflow.com/questions/39490746/date-select-pass-date-so-that-ruby-can-read-it/39490854#39490854", "title": "date_select pass date so that ruby can read it", "body": "<p>Try this:</p>\n\n<pre><code>date_hash = {\n  \"start_date_attribute(3i)\"=&gt;\"14\", \n  \"start_date_attribute(2i)\"=&gt;\"8\", \n  \"start_date_attribute(1i)\"=&gt;\"2016\"\n}\n\n# will be: '2016-8-14'\ndate_string = date_hash.values.join('-').reverse\n\nDate.parse(date_string)\n</code></pre>\n\n<p><strong>EDIT:</strong></p>\n\n<p>For a stricter validation of the date-format you could use Date#strptime:</p>\n\n<pre><code>Date.strptime(date_string', '%Y-%m-%d')\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7638, "user_id": 1014251, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/1c4500c91af486c885af8bb84eefd063?s=128&d=identicon&r=PG", "display_name": "ReggieB", "link": "https://stackoverflow.com/users/1014251/reggieb"}, "is_accepted": true, "score": 1, "last_activity_date": 1473857626, "creation_date": 1473857626, "answer_id": 39490970, "question_id": 39490746, "link": "https://stackoverflow.com/questions/39490746/date-select-pass-date-so-that-ruby-can-read-it/39490970#39490970", "title": "date_select pass date so that ruby can read it", "body": "<p>You could try this gem <a href=\"https://github.com/reggieb/multiparameter_attributes_handler\" rel=\"nofollow\">multiparameter_attributes_handler</a>.</p>\n"}], "owner": {"reputation": 1626, "user_id": 2911232, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/5cxpd.jpg?s=128&g=1", "display_name": "Stefanos.Ioannou", "link": "https://stackoverflow.com/users/2911232/stefanos-ioannou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 39490970, "answer_count": 2, "score": 1, "last_activity_date": 1473858117, "creation_date": 1473856968, "last_edit_date": 1473858117, "question_id": 39490746, "link": "https://stackoverflow.com/questions/39490746/date-select-pass-date-so-that-ruby-can-read-it", "title": "date_select pass date so that ruby can read it", "body": "<p>I have this date_select:</p>\n\n<pre><code>date_select(\"start_date_variable\", \n            \"start_date_attribute\", \n            :start_year =&gt; 2014, \n            :end_year =&gt; 2016, \n            :order =&gt; [:day, :month, :year], \n            :use_short_month =&gt; true, \n            :add_month_numbers =&gt; true)\n</code></pre>\n\n<p>that returns the date in params as: </p>\n\n<pre><code>\"start_date_variable\" =&gt; {\n                          \"start_date_attribute(3i)\"=&gt;\"14\",\n                          \"start_date_attribute(2i)\"=&gt;\"8\", \n                          \"start_date_attribute(1i)\"=&gt;\"2016\"\n                         }\n</code></pre>\n\n<p>I can get the day, month and year from that but I then want to search the database with something like:</p>\n\n<pre><code>@orders_from = @fulfillable_orders.where('created_at &gt;= :start_date_par,\n                                         :start_date_par =&gt; params[:start_date_variable])\n</code></pre>\n\n<p>However I am not sure how to pass the date in a format that ruby will recognize, read and return the records.</p>\n\n<p>Any clue how this is possible or a different way around?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "amazon-web-services", "elasticsearch", "searchkick"], "comments": [{"owner": {"reputation": 3997, "user_id": 3998420, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55ea542584d3fd2a430c3d409bdafc95?s=128&d=identicon&r=PG&f=1", "display_name": "bkunzi01", "link": "https://stackoverflow.com/users/3998420/bkunzi01"}, "edited": false, "score": 0, "creation_date": 1473856069, "post_id": 39490399, "comment_id": 66298410, "body": "Your credentials don&#39;t match! Do you have the right key?"}, {"owner": {"reputation": 63, "user_id": 5240322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TICCq2Gclbo/AAAAAAAAAAI/AAAAAAAAABM/9_vz1biJ1a4/photo.jpg?sz=128", "display_name": "Theo", "link": "https://stackoverflow.com/users/5240322/theo"}, "reply_to_user": {"reputation": 3997, "user_id": 3998420, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55ea542584d3fd2a430c3d409bdafc95?s=128&d=identicon&r=PG&f=1", "display_name": "bkunzi01", "link": "https://stackoverflow.com/users/3998420/bkunzi01"}, "edited": false, "score": 0, "creation_date": 1473856560, "post_id": 39490399, "comment_id": 66298722, "body": "Thank for response! I checked, It&#39;s correct! Please, help me!"}], "answers": [{"comments": [{"owner": {"reputation": 592, "user_id": 2226842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e23866cc892e67aec756406a481d7010?s=128&d=identicon&r=PG", "display_name": "Sunry", "link": "https://stackoverflow.com/users/2226842/sunry"}, "edited": false, "score": 0, "creation_date": 1498188788, "post_id": 39534066, "comment_id": 76407685, "body": "Oh, God! Waste me lots of time. Finally find the reason."}], "tags": [], "owner": {"reputation": 1338, "user_id": 1083138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/42c8ac0df5dca340ac995c070458c93a?s=128&d=identicon&r=PG", "display_name": "Dmitriy Budnik", "link": "https://stackoverflow.com/users/1083138/dmitriy-budnik"}, "is_accepted": true, "score": 8, "last_activity_date": 1474036373, "creation_date": 1474036373, "answer_id": 39534066, "question_id": 39490399, "link": "https://stackoverflow.com/questions/39490399/elasticsearch-issue-cannot-connect-aws-elasticsearch-service/39534066#39534066", "title": "Elasticsearch issue: Cannot connect AWS elasticsearch service", "body": "<p>You should exclude tailing slash from <code>ELASTICSEARCH_URL</code></p>\n"}], "owner": {"reputation": 63, "user_id": 5240322, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TICCq2Gclbo/AAAAAAAAAAI/AAAAAAAAABM/9_vz1biJ1a4/photo.jpg?sz=128", "display_name": "Theo", "link": "https://stackoverflow.com/users/5240322/theo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1291, "favorite_count": 0, "accepted_answer_id": 39534066, "answer_count": 1, "score": 6, "last_activity_date": 1474129409, "creation_date": 1473855841, "last_edit_date": 1474129409, "question_id": 39490399, "link": "https://stackoverflow.com/questions/39490399/elasticsearch-issue-cannot-connect-aws-elasticsearch-service", "title": "Elasticsearch issue: Cannot connect AWS elasticsearch service", "body": "<p>I have a issue about configure elasticsearch to connect AWS elasticsearch service to run project in production.\nMy Gemfile:</p>\n\n<pre><code>    gem 'searchkick'\n    gem 'faraday_middleware-aws-signers-v4'\n    gem 'aws-sdk', '~&gt; 2'\n    gem \"elasticsearch\", \"&gt;= 1.0.15\"\n</code></pre>\n\n<p>Reference: <a href=\"https://github.com/ankane/searchkick\" rel=\"nofollow\">https://github.com/ankane/searchkick</a></p>\n\n<p>My config/initializers/elasticsearch.rb file:</p>\n\n<pre><code>    require \"faraday_middleware/aws_signers_v4\"\n    ENV[\"ELASTICSEARCH_URL\"] = \"https://search-eaterybot-u3yjm6cdn3ogkmv3bcdl5j7poy.ap-southeast-1.es.amazonaws.com/\"\n\n       Searchkick.client = Elasticsearch::Client.new(\n       url: ENV[\"ELASTICSEARCH_URL\"],\n        transport_options: {request: {timeout: 10}}\n       ) do |f|\n       f.request :aws_signers_v4, {credentials: Aws::Credentials.new(Rails.application.secrets.aws_access_key_id, Rails.application.secrets.aws_secret_access_key),\n       service_name: \"es\",\n       region: \"ap-southeast-1\"\n     }\n   end\n</code></pre>\n\n<p>When I run \"rake searchkick:reindex:all\", it show error:</p>\n\n<blockquote>\n  <p>Elasticsearch::Transport::Transport::Errors::Forbidden: [403]     {\"message\":\"The request signature we calculated does not match the signature you provided. Check your AWS Secret Access Key and signing method. Consult the service documentation for details.\\n\\nThe Canonical String for this request should have been\\n'GET\\n/_aliases\\n\\naccept-encoding:gzip;q=1.0,deflate;q=0.6,identity;q=0.3\\nhost:search-eaterybot-u3yjm6cdn3ogkmv3bcdl5j7poy.ap-southeast-1.es.amazonaws.com\\nx-amz-content-sha256:e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855\\nx-amz-date:20160914T095023Z\\n\\naccept-encoding;host;x-amz-content-sha256;x-amz-date\\ne3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855'\\n\\nThe String-to-Sign should have been\\n'AWS4-HMAC-SHA256\\n20160914T095023Z\\n20160914/ap-southeast-1/es/aws4_request\\n47bc69b4440a13aeac990b8c6c49934f1dcc4693bbbda577bfdeb02e685c507b'\\n\"}\"</p>\n</blockquote>\n\n<p>Anyone can help me! Thanks!</p>\n"}, {"tags": ["arrays", "ruby", "multidimensional-array"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1473855940, "post_id": 39489516, "comment_id": 66298335, "body": "<code>each</code> is deleting elements from <code>s</code>, 4 elements from the original 9 leaving <code>s</code> of length 5."}], "answers": [{"tags": [], "owner": {"reputation": 176, "user_id": 2347723, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f2981c438a27fc16bf2b8edc2b74944?s=128&d=identicon&r=PG", "display_name": "Sam Farmer", "link": "https://stackoverflow.com/users/2347723/sam-farmer"}, "is_accepted": false, "score": 2, "last_activity_date": 1473853766, "creation_date": 1473853766, "answer_id": 39489701, "question_id": 39489516, "link": "https://stackoverflow.com/questions/39489516/ruby-delete-an-entry-from-a-2d-array-if-it-is-not-equal-to-a-specific-1d-array/39489701#39489701", "title": "Ruby: delete an entry from a 2d array if it is not equal to a specific 1d array", "body": "<p>Look into the <a href=\"https://ruby-doc.org/core-2.2.0/Array.html#method-i-select\" rel=\"nofollow\">.select</a> method, which can be used to select values from an array based on the evaluation of a block. For example:</p>\n\n<pre><code>s.select { |arry| arry == solution } \n</code></pre>\n\n<p>This will return an array containing the elements in <code>s</code> that match the <code>solution</code> array, e.g. <code>[[3,1]]</code></p>\n"}, {"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 2, "last_activity_date": 1473856235, "last_edit_date": 1473856235, "creation_date": 1473855666, "answer_id": 39490340, "question_id": 39489516, "link": "https://stackoverflow.com/questions/39489516/ruby-delete-an-entry-from-a-2d-array-if-it-is-not-equal-to-a-specific-1d-array/39490340#39490340", "title": "Ruby: delete an entry from a 2d array if it is not equal to a specific 1d array", "body": "<p>What you are looking for is actually <a href=\"http://ruby-doc.org/core-2.3.1/Enumerable.html#method-i-detect\" rel=\"nofollow\"><code>Enumerable#detect</code></a>:</p>\n\n<pre><code>[[1, 2], [2, 1], [2, 3], [3, 1], [3, 3]].detect { |e| e == [3, 1] }\n#\u21d2\u00a0[3, 1]\n</code></pre>\n\n<p>The reason why your code returns the whole array is that <code>Enumerable#each</code> iterator returns the receiver itself. It\u2019s not recommended to mutate enumerables during the enumerating process, it might lead to unpredicted/unexpected result. <code>each</code> drives crazy when the underlying array is changed.</p>\n"}], "owner": {"reputation": 327, "user_id": 6661235, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh4.googleusercontent.com/-CINW7mm206g/AAAAAAAAAAI/AAAAAAAAelo/t0fKwo1020o/photo.jpg?sz=128", "display_name": "Laurence", "link": "https://stackoverflow.com/users/6661235/laurence"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 39490340, "answer_count": 2, "score": 0, "last_activity_date": 1473856235, "creation_date": 1473853205, "question_id": 39489516, "link": "https://stackoverflow.com/questions/39489516/ruby-delete-an-entry-from-a-2d-array-if-it-is-not-equal-to-a-specific-1d-array", "title": "Ruby: delete an entry from a 2d array if it is not equal to a specific 1d array", "body": "<p>I'm having some trouble understanding the behavior of some code in Ruby. I want to match the contents of my 2d array with a specific 1d array. </p>\n\n<pre><code>s = [1,2,3].repeated_permutation(2).to_a\nsolution = [3,1]\ns.each do |x|\n    if x != solution\n        puts s.length\n        print \"#{x}\\n\"\n        s.delete(x)\n    end\nend\n</code></pre>\n\n<p>what I don't understand is that this code will return this:</p>\n\n<pre><code>s = [[1, 2], [2, 1], [2, 3], [3, 1], [3, 3]]\n</code></pre>\n\n<p>I am a beginner and I must be overlooking something basic. \nI did overcame this issue by circumventing it in a way that is surely not ideal:</p>\n\n<pre><code>s = [1,2,3].repeated_permutation(2).to_a\nsolution = [3,1]\n\ns.each_with_index do |x,idx|\n    if x != solution \n        s[idx] = nil\n    end\nend\n\n=&gt; [nil,nil,nil,nil,nil,nil,nil,[3,1],nil]\n\ns.flatten!.compact!\n\n=&gt; [3,1]\n</code></pre>\n\n<p>Can anyone tell me what would be a good Ruby way to perform this check?\nThanks in advance</p>\n"}, {"tags": ["ruby", "alias"], "comments": [{"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1473851931, "post_id": 39488860, "comment_id": 66295826, "body": "I deleted my answer because I misunderstood the question.   I can reproduce the behavior. Works on 2.2, does not work on 2.3.1"}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1473852026, "post_id": 39488860, "comment_id": 66295879, "body": "And it only happens with included module, not with class."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1473852229, "post_id": 39488860, "comment_id": 66295992, "body": "\u201cit only happens with included module, not with class\u201d\u2014yes, I provided a minimum viable example."}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1473852337, "post_id": 39488860, "comment_id": 66296051, "body": "This was only intended as further hint for others who want to investigate."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 2, "creation_date": 1473852577, "post_id": 39488860, "comment_id": 66296211, "body": "This question belongs on <a href=\"https://bugs.ruby-lang.org\" rel=\"nofollow noreferrer\">bugs.ruby-lang.org</a> ;-)"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1473852644, "post_id": 39488860, "comment_id": 66296240, "body": "@Stefan indeed, I am filling a bug, I just wanted to make sure I am not mistaken / missing smth."}], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 113, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1473853012, "creation_date": 1473851085, "last_edit_date": 1473853012, "question_id": 39488860, "link": "https://stackoverflow.com/questions/39488860/ruby-2-3-1-has-a-bug-in-modulealias-and-modulealias-method", "title": "Ruby 2.3.1 has a bug in `Module#alias` and `Module#alias_method`?", "body": "<p>Consider the following code:</p>\n\n<pre><code>module M\n  def original ; puts __callee__ ; end\n  alias_method :aliased, :original\nend\nclass A\n  include M\nend\n\nA.new.original\n#\u21d2\u00a0original\nA.new.aliased\n#\u21d2 aliased\n</code></pre>\n\n<p>The above code runs perfectly fine in Ruby 2.1 and returns the actual method name, as it is supposed to be done by <a href=\"https://ruby-doc.org/core-2.3.1/Kernel.html#method-i-__callee__\" rel=\"nofollow\"><code>Kernel#__callee__</code></a>. </p>\n\n<p>Surprisingly enough, the code above <em>does not work as expected</em> in Ruby 2.3.1:</p>\n\n<pre><code>A.new.original\n#\u21d2\u00a0original\nA.new.aliased\n#\u21d2\u00a0original\n</code></pre>\n\n<p>Is this a desired behaviour I failed to find in release notes, or is it a bug in MRI for 2.3? The same happens for <code>alias</code>.</p>\n\n<p>PS I have created an issue <a href=\"https://bugs.ruby-lang.org/issues/12761\" rel=\"nofollow\">https://bugs.ruby-lang.org/issues/12761</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "rails-generators"], "answers": [{"tags": [], "owner": {"reputation": 2413, "user_id": 443302, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/7d02069ff600f99c6b597d7c9729ded9?s=128&d=identicon&r=PG", "display_name": "Stewart", "link": "https://stackoverflow.com/users/443302/stewart"}, "is_accepted": false, "score": 2, "last_activity_date": 1473847782, "creation_date": 1473847782, "answer_id": 39487817, "question_id": 39487762, "link": "https://stackoverflow.com/questions/39487762/how-to-test-generators-with-rspec/39487817#39487817", "title": "How to test generators with RSpec", "body": "<p>I would write a file by hand that acts as a test fixture. I would then as part of my test generate the file with the generator. At that point I would diff the two files. Looks like the diffy gem could help you there. If there is no diff then pass the test. Fail if otherwise.</p>\n\n<p><a href=\"https://github.com/samg/diffy\" rel=\"nofollow\">https://github.com/samg/diffy</a></p>\n\n<p>Don't forget to clean up your temp files after the tests. You don't want them hanging around in your repos.</p>\n"}, {"tags": [], "owner": {"reputation": 8946, "user_id": 2398521, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/84bb49c56756a8c7cd54d4876d7a4467?s=128&d=identicon&r=PG", "display_name": "Maxim", "link": "https://stackoverflow.com/users/2398521/maxim"}, "is_accepted": false, "score": 1, "last_activity_date": 1473848631, "creation_date": 1473848631, "answer_id": 39488065, "question_id": 39487762, "link": "https://stackoverflow.com/questions/39487762/how-to-test-generators-with-rspec/39488065#39488065", "title": "How to test generators with RSpec", "body": "<p>I didn't found official recommendations how to test Rails generators too. So, I am just run generator directly on dummy application, compare generated files and delete them at the end of test.</p>\n\n<p><a href=\"https://github.com/Semantic-Org/Semantic-UI-Rails-LESS/blob/master/spec/generators/install_generator_spec.rb\" rel=\"nofollow\">Here</a> is my spec which implement described approach. I had used <code>minispec</code> instead of <code>rspec</code> here but they a very similar.</p>\n"}, {"comments": [{"owner": {"reputation": 19564, "user_id": 5292302, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3b61b00d5bcb378f99eadff312544514?s=128&d=identicon&r=PG", "display_name": "Petter Friberg", "link": "https://stackoverflow.com/users/5292302/petter-friberg"}, "edited": false, "score": 0, "creation_date": 1495095766, "post_id": 44042308, "comment_id": 75110517, "body": "A link to a solution is welcome, but please ensure your answer is useful without it: <a href=\"//meta.stackexchange.com/a/8259\">add context around the link</a> so your fellow users will have some idea what it is and why it\u2019s there, then quote the most relevant part of the page you&#39;re linking to in case the target page is unavailable. <a href=\"//stackoverflow.com/help/deleted-answers\">Answers that are little more than a link may be deleted.</a>"}, {"owner": {"reputation": 1190, "user_id": 1047937, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cc0285786275cb21edfefbc3d527e6de?s=128&d=identicon&r=PG&f=1", "display_name": "dgmora", "link": "https://stackoverflow.com/users/1047937/dgmora"}, "edited": false, "score": 4, "creation_date": 1495114184, "post_id": 44042308, "comment_id": 75123560, "body": "Thanks for the copy paste guys, much appreciated, but the answer is pretty clear and is good as it is. There&#39;s a library doing that, go check it, I am not going to copy from the readme. If the library is ever removed, there won&#39;t be any help anyway in this answer.  I wonder why anyone would anyone downvote a <i>very</i> helpful answer, but hey, your call."}, {"owner": {"reputation": 2215, "user_id": 1996540, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/609b69cbb09257883a4e32d7d5aff098?s=128&d=identicon&r=PG", "display_name": "ZedTuX", "link": "https://stackoverflow.com/users/1996540/zedtux"}, "edited": false, "score": 0, "creation_date": 1605683304, "post_id": 44042308, "comment_id": 114723070, "body": "Thank your for suggesting that gem, it works great!"}], "tags": [], "owner": {"reputation": 1190, "user_id": 1047937, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cc0285786275cb21edfefbc3d527e6de?s=128&d=identicon&r=PG&f=1", "display_name": "dgmora", "link": "https://stackoverflow.com/users/1047937/dgmora"}, "is_accepted": false, "score": 1, "last_activity_date": 1495283089, "last_edit_date": 1495283089, "creation_date": 1495095697, "answer_id": 44042308, "question_id": 39487762, "link": "https://stackoverflow.com/questions/39487762/how-to-test-generators-with-rspec/44042308#44042308", "title": "How to test generators with RSpec", "body": "<p>There's the <a href=\"https://rubygems.org/gems/generator_spec\" rel=\"nofollow noreferrer\">gem</a> \n <a href=\"https://github.com/petergoldstein/generator_spec\" rel=\"nofollow noreferrer\">https://github.com/petergoldstein/generator_spec</a>, which does a decent job, although it is not very actively maintained</p>\n"}], "owner": {"reputation": 1985, "user_id": 1629709, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/ykH7V.png?s=128&g=1", "display_name": "Sebastian", "link": "https://stackoverflow.com/users/1629709/sebastian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1077, "favorite_count": 0, "answer_count": 3, "score": 7, "last_activity_date": 1495283089, "creation_date": 1473847599, "question_id": 39487762, "link": "https://stackoverflow.com/questions/39487762/how-to-test-generators-with-rspec", "title": "How to test generators with RSpec", "body": "<p>Is there a recommended way of testing <a href=\"http://guides.rubyonrails.org/generators.html\" rel=\"noreferrer\">Rails generators</a> with RSpec?\nThe only solution I've found is the <a href=\"https://github.com/stevehodgkiss/generator_spec\" rel=\"noreferrer\">Generator Spec</a> gem, that hasn't been updated in over two years.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 3, "creation_date": 1473847068, "post_id": 39487533, "comment_id": 66293082, "body": "<a href=\"http://stackoverflow.com/questions/29005090/how-to-solve-undefined-method-to-key-for-bookactiverecord-relation0x007fb?rq=1\" title=\"how to solve undefined method to key for bookactiverecord relation0x007fb\">stackoverflow.com/questions/29005090/&hellip;</a>"}, {"owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "edited": false, "score": 1, "creation_date": 1473847135, "post_id": 39487533, "comment_id": 66293124, "body": "your @user seems to be a relation, not a <code>User</code> instance"}, {"owner": {"reputation": 48004, "user_id": 216513, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/30a45c64b2ef288f7ec098c5fb353a22?s=128&d=identicon&r=PG", "display_name": "nathanvda", "link": "https://stackoverflow.com/users/216513/nathanvda"}, "edited": false, "score": 0, "creation_date": 1473856997, "post_id": 39487533, "comment_id": 66298995, "body": "<code>User.where</code> returns an collection (=<code>ActiveRecord::Relation</code>). Call <code>first</code> to get the first one, or more ideomatic: use <code>User.find</code> instead."}], "answers": [{"tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 2, "last_activity_date": 1473856865, "last_edit_date": 1473856865, "creation_date": 1473856559, "answer_id": 39490625, "question_id": 39487533, "link": "https://stackoverflow.com/questions/39487533/undefined-method-to-key-for-useractiverecord-relation0x007f1bf8c2fd60/39490625#39490625", "title": "undefined method `to_key&#39; for #&lt;User::ActiveRecord_Relation:0x007f1bf8c2fd60&gt;", "body": "<p>One should use <a href=\"http://api.rubyonrails.org/classes/ActiveRecord/FinderMethods.html#method-i-find\" rel=\"nofollow\"><code>ActiveRecord::FinderMethods#find</code></a>, not <code>where</code>, to receive a single instance:</p>\n\n<pre><code>def permissions\n    # WRONG: where returns a relation\n    # @user = User.where(id: params[:user_id])\n    @user = User.find(params[:user_id])\n    @permissions = Permission.all\nend\n</code></pre>\n\n<p>It worth to mention, that <code>find</code> raise a <code>RecordNotFound</code> exception on fail, hence you probably want to rescue from it:</p>\n\n<pre><code>def permissions\n    @user = User.find(params[:user_id])\n    @permissions = Permission.all\nrescue RecordNotFound =&gt; rnf\n    # Log or just skip\nend\n</code></pre>\n\n<hr>\n\n<p><code>where</code> might be [ab]used here as well, but in such a case you need to explicitly say that you need the only user:</p>\n\n<pre><code>@user = User.where(id: params[:user_id]).first\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5903878, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/1559031381080049/picture?type=large", "display_name": "Octav", "link": "https://stackoverflow.com/users/5903878/octav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 909, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473856865, "creation_date": 1473846953, "question_id": 39487533, "link": "https://stackoverflow.com/questions/39487533/undefined-method-to-key-for-useractiverecord-relation0x007f1bf8c2fd60", "title": "undefined method `to_key&#39; for #&lt;User::ActiveRecord_Relation:0x007f1bf8c2fd60&gt;", "body": "<p>I am really new at rails so please forgive me if i can't see it. </p>\n\n<p>I am trying to edit the permissions on each individual user and i am getting this error in form_for:</p>\n\n<pre><code>undefined method `to_key' for #&lt;User::ActiveRecord_Relation:0x007f1bf8c2fd60&gt;\n</code></pre>\n\n<p>From what i have seen on other questions on stackoverflow, this usually happens when you try to call a collection in a form but this is not the case?</p>\n\n<p>view:</p>\n\n<pre><code>&lt;div class=\"n-container\"&gt;\n&lt;tr-form data-riot riot-tag=\"tr-form\"&gt;\n&lt;%= form_for(@user) do |f| %&gt;\n\n    &lt;section&gt;\n        &lt;div class=\"w-container\"&gt;\n            &lt;h1&gt;User permissions&lt;/h1&gt;\n            &lt;% @permissions.each do |permission| %&gt;\n                &lt;%= check_box_tag 'permission_ids[]', permission.id %&gt;\n                &lt;div&gt;\n                    &lt;%= permission.description %&gt;\n                &lt;/div&gt;\n            &lt;% end %&gt;\n        &lt;/div&gt;\n    &lt;/section&gt;\n\n    &lt;section&gt;\n\n      &lt;div class=\"f-controls align-right\"&gt;\n        &lt;%= f.submit class: \"btn fill blue\", value: \"Submit\" %&gt;\n      &lt;/div&gt;\n\n    &lt;/section&gt;\n&lt;% end %&gt;\n&lt;/tr-form&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>users_controller:</p>\n\n<pre><code>class UsersController &lt; ApplicationController\n    def user_params\n        params.require('user').permit(\n            permissions: []\n        )\n    end\n\n    def permissions\n        @user = User.where(id: params[:user_id])\n        @permissions = Permission.all\n    end\nend\n</code></pre>\n\n<p>routes:</p>\n\n<pre><code>resources :users do\n  get 'permissions'\n  post 'permissions'\nend\n</code></pre>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "comments": [{"owner": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "edited": false, "score": 0, "creation_date": 1473851362, "post_id": 39487419, "comment_id": 66295505, "body": "Did you try <code>&lt;%= link_to &quot;Edit&quot;, edit_post_path(post.id), :class =&gt; &quot;btn btn-default&quot; %&gt;</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 6830021, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iHDwgo1LwKY/AAAAAAAAAAI/AAAAAAAAABI/i_rq2yxi78o/photo.jpg?sz=128", "display_name": "Dean Foulds", "link": "https://stackoverflow.com/users/6830021/dean-foulds"}, "edited": false, "score": 0, "creation_date": 1473846984, "post_id": 39487455, "comment_id": 66293026, "body": "I did try that. for some reason it appears to go wrong at the controller when I remove the set_post action for edit the error goes and lets me get to the edit form but then when I add data to the form I get the sam error again.  Hope that makes sense"}, {"owner": {"reputation": 33, "user_id": 6830021, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iHDwgo1LwKY/AAAAAAAAAAI/AAAAAAAAABI/i_rq2yxi78o/photo.jpg?sz=128", "display_name": "Dean Foulds", "link": "https://stackoverflow.com/users/6830021/dean-foulds"}, "edited": false, "score": 0, "creation_date": 1473847626, "post_id": 39487455, "comment_id": 66293407, "body": "Yes I did that to no avail.  Is the problem with the index.html.erb when I render the partial?"}, {"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "reply_to_user": {"reputation": 33, "user_id": 6830021, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iHDwgo1LwKY/AAAAAAAAAAI/AAAAAAAAABI/i_rq2yxi78o/photo.jpg?sz=128", "display_name": "Dean Foulds", "link": "https://stackoverflow.com/users/6830021/dean-foulds"}, "edited": false, "score": 0, "creation_date": 1473847983, "post_id": 39487455, "comment_id": 66293613, "body": "ahh.. yes you are passing <code>p</code> as locale and using <code>post</code> so you need to change <code>post</code> to <code>p</code> in your card partial wherever you have used it"}, {"owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "reply_to_user": {"reputation": 33, "user_id": 6830021, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iHDwgo1LwKY/AAAAAAAAAAI/AAAAAAAAABI/i_rq2yxi78o/photo.jpg?sz=128", "display_name": "Dean Foulds", "link": "https://stackoverflow.com/users/6830021/dean-foulds"}, "edited": false, "score": 0, "creation_date": 1473848035, "post_id": 39487455, "comment_id": 66293643, "body": "and I believe you must be getting errors in  <code>post.title</code> as well"}, {"owner": {"reputation": 33, "user_id": 6830021, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iHDwgo1LwKY/AAAAAAAAAAI/AAAAAAAAABI/i_rq2yxi78o/photo.jpg?sz=128", "display_name": "Dean Foulds", "link": "https://stackoverflow.com/users/6830021/dean-foulds"}, "edited": false, "score": 0, "creation_date": 1473848349, "post_id": 39487455, "comment_id": 66293813, "body": "I have no issues with the title and changing post to p edit still has the same error. I think I will try moving the edit link into the show action and use the show params."}], "tags": [], "owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "is_accepted": true, "score": 0, "last_activity_date": 1473846730, "creation_date": 1473846730, "answer_id": 39487455, "question_id": 39487419, "link": "https://stackoverflow.com/questions/39487419/i-get-the-following-error-activerecordrecordnotfound-at-posts-post-edit-could/39487455#39487455", "title": "I get the following error ActiveRecord::RecordNotFound at /posts/post/edit Couldn&#39;t find Post with &#39;id&#39;=post", "body": "<p>Change <code>:post</code> to <code>post</code> in <strong>card partial</strong></p>\n\n<pre><code>&lt;%= link_to \"Edit\", edit_post_path(post), :class =&gt; \"btn btn-default\" %&gt;\n</code></pre>\n\n<p>Rails is sending <code>:post</code> as value of <code>:id</code> like {'id' => ':post'}</p>\n\n<p>And <code>set_params</code> is trying to find it with <code>params[:id]</code> which is ':post'</p>\n\n<pre><code>@post = Post.find(:post)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33, "user_id": 6830021, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iHDwgo1LwKY/AAAAAAAAAAI/AAAAAAAAABI/i_rq2yxi78o/photo.jpg?sz=128", "display_name": "Dean Foulds", "link": "https://stackoverflow.com/users/6830021/dean-foulds"}, "is_accepted": false, "score": 0, "last_activity_date": 1473856332, "creation_date": 1473856332, "answer_id": 39490551, "question_id": 39487419, "link": "https://stackoverflow.com/questions/39487419/i-get-the-following-error-activerecordrecordnotfound-at-posts-post-edit-could/39490551#39490551", "title": "I get the following error ActiveRecord::RecordNotFound at /posts/post/edit Couldn&#39;t find Post with &#39;id&#39;=post", "body": "<p>I have solved this issue with the changes below:</p>\n\n<p><strong>index.html.erb</strong>\n<strong>no change</strong></p>\n\n<p><strong>card partial</strong></p>\n\n<pre><code>&lt;div class=\"container\"&gt;\n &lt;div class=\"row\"&gt;\n  &lt;div class=\"col-xs-12\"&gt;\n   &lt;div class=\"card\" style=\"background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.2)), url('post.photo_url');\"&gt;\n    &lt;div class=\"card-category\"&gt;&lt;%= post.created_at.strftime(\"Posted %a %m %b %Y at %I:%M%p\")  %&gt;&lt;/div&gt;\n      &lt;div class=\"card-description\"&gt;\n        &lt;h2&gt;&lt;%= post.title %&gt;&lt;/h2&gt;\n        &lt;p&gt;&lt;%= post.summary %&gt;&lt;/p&gt;\n      &lt;/div&gt;\n      &lt;%= link_to \"\", post_path(post), class: \"card-link\"%&gt;\n    &lt;/div&gt;\n     &lt;% if current_user %&gt;\n     &lt;%= link_to \"Edit\", edit_post_path(post), :class =&gt; \"btn btn-default\" %&gt;\n   &lt;% end %&gt;\n   &lt;/div&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p><strong>edit.html.erb</strong></p>\n\n<pre><code>&lt;div class=\"container\"&gt;\n &lt;div class=\"row\"&gt;\n  &lt;div class=\"col-md-6 col-md-offset-3\"&gt;\n   &lt;h1&gt;Editing post&lt;/h1&gt;\n       &lt;%= simple_form_for @post do |f| %&gt;\n        &lt;%= f.input :title, placeholder: \"Enter a title\" %&gt;\n        &lt;%= f.input :summary, placeholder: \"Short summary of post\" %&gt;\n        &lt;%= f.input :post_content, as: :text %&gt;\n        &lt;%= f.submit class: \"btn btn-danger\"%&gt;\n       &lt;% end %&gt;\n   &lt;/div&gt;\n &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6830021, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-iHDwgo1LwKY/AAAAAAAAAAI/AAAAAAAAABI/i_rq2yxi78o/photo.jpg?sz=128", "display_name": "Dean Foulds", "link": "https://stackoverflow.com/users/6830021/dean-foulds"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 39487455, "answer_count": 2, "score": 0, "last_activity_date": 1473856332, "creation_date": 1473846624, "question_id": 39487419, "link": "https://stackoverflow.com/questions/39487419/i-get-the-following-error-activerecordrecordnotfound-at-posts-post-edit-could", "title": "I get the following error ActiveRecord::RecordNotFound at /posts/post/edit Couldn&#39;t find Post with &#39;id&#39;=post", "body": "<p>I am building a blog and have implemented an edit post function but get the following error message: ActiveRecord::RecordNotFound at /posts/post/edit\nCouldn't find Post with 'id'=post I am using rails 5</p>\n\n<p>Thank you in advance. </p>\n\n<pre><code>**Index.html.erb**\n&lt;div class=\"banner-container\"&gt;\n &lt;div class=\"container\"&gt;\n    &lt;div class=\"banner-gradient-shadow\"&gt;&lt;/div&gt;\n      &lt;div class=\"banner-content banner-font\"&gt;\n        &lt;h1&gt;\n          Some text\n        &lt;/h1&gt;\n        &lt;p&gt;\n          &lt;strong&gt;More text&lt;/strong&gt;.\n        &lt;/p&gt;\n      &lt;/div&gt;\n    &lt;/div&gt;\n  &lt;/div&gt;\n &lt;/div&gt;\n\n &lt;div class=\"container\"&gt;\n  &lt;div class=\"row\"&gt;\n   &lt;% @posts.each do |p| %&gt;\n   &lt;%= render \"card\", post: p %&gt;\n   &lt;% end %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p><strong>Card partial</strong></p>\n\n<pre><code>&lt;div class=\"container\"&gt;\n &lt;div class=\"row\"&gt;\n  &lt;div class=\"col-xs-12\"&gt;\n   &lt;div class=\"card\" style=\"background-image: linear-gradient(rgba(0,0,0,0.3), rgba(0,0,0,0.2)), url('post.photo_url');\"&gt;\n    &lt;div class=\"card-category\"&gt;&lt;%= post.created_at.strftime(\"Posted %a %m %b %Y at %I:%M%p\")  %&gt;&lt;/div&gt;\n      &lt;div class=\"card-description\"&gt;\n        &lt;h2&gt;&lt;%= post.title %&gt;&lt;/h2&gt;\n        &lt;p&gt;&lt;%= post.summary %&gt;&lt;/p&gt;\n      &lt;/div&gt;\n      &lt;!-- &lt;img class=\"card-user avatar\" src=\"user.jpg\"&gt; --&gt;\n      &lt;%= link_to \"\", post_path(post), class: \"card-link\"%&gt;\n    &lt;/div&gt;\n     &lt;% if current_user %&gt;\n     &lt;%= link_to \"Edit\", edit_post_path(:post), :class =&gt; \"btn btn-    default\" %&gt;\n     &lt;% end %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p></p>\n\n<p><strong>edit.html.erb</strong></p>\n\n<pre><code>&lt;div class=\"container\"&gt;\n &lt;div class=\"row\"&gt;\n  &lt;div class=\"col-md-6 col-md-offset-3\"&gt;\n   &lt;h1&gt;Editing post&lt;/h1&gt;\n   &lt;%= simple_form_for :post do |f| %&gt;\n    &lt;%= f.input :title %&gt;\n    &lt;%= f.input :summary %&gt;\n    &lt;%= f.input :post_content, as: :text %&gt;\n    &lt;%= f.submit class: \"btn btn-danger\"%&gt;\n  &lt;% end %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p></p>\n\n<p><strong>posts_controller.rb</strong> </p>\n\n<pre><code>class PostsController &lt; ApplicationController\nbefore_action :set_post, only: [:show, :edit, :update]\nskip_before_action :authenticate_user!, only: [ :edit]\n\n def index\n @posts = Post.order(\"created_at DESC\").all\n end\n\ndef show\n@comment = Comment.new\nend\n\ndef new\n@post = Post.new\nend\n\ndef edit\n\nend\n\ndef create\n@post = Post.new(post_params)\n if @post.save\n redirect_to post_path(@post)\n else\n render :show\nend\nend\n\ndef update\n  if @post.update(post_params)\n  redirect_to @post\n  else\n  render :show\n  end\n end\n\n\ndef destroy\nend\n\ndef set_post\n@post = Post.find(params[:id])\nend\n\ndef post_params\nparams.require(:post).permit(:title, :post_content, :summary, photo: [], video: [])\nend\nend\n</code></pre>\n\n<p><strong>routes.rb</strong></p>\n\n<pre><code>Rails.application.routes.draw do\ndevise_for :users\nmount Attachinary::Engine =&gt; \"/attachinary\"\nroot to: 'posts#index'\nresources :posts, only: [:index, :show, :new, :create, :edit, :update] do\nresources :comments, only: [:show, :edit, :update, :create, :destroy]\n  end\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "capistrano"], "comments": [{"owner": {"reputation": 2460, "user_id": 3940126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0222b0a3b16a79649265eabba7e05add?s=128&d=identicon&r=PG&f=1", "display_name": "slowjack2k", "link": "https://stackoverflow.com/users/3940126/slowjack2k"}, "edited": false, "score": 2, "creation_date": 1473846183, "post_id": 39487158, "comment_id": 66292479, "body": "It seems like git is not installed or not within <code>PATH</code> on the remote host."}, {"owner": {"reputation": 93, "user_id": 3906755, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/3eecf28ed883e7f3a86b007359796847?s=128&d=identicon&r=PG&f=1", "display_name": "user3906755", "link": "https://stackoverflow.com/users/3906755/user3906755"}, "reply_to_user": {"reputation": 2460, "user_id": 3940126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0222b0a3b16a79649265eabba7e05add?s=128&d=identicon&r=PG&f=1", "display_name": "slowjack2k", "link": "https://stackoverflow.com/users/3940126/slowjack2k"}, "edited": false, "score": 0, "creation_date": 1473846929, "post_id": 39487158, "comment_id": 66292990, "body": "@slowjack2k thank you very much man you save me..!!!"}, {"owner": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "reply_to_user": {"reputation": 2460, "user_id": 3940126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0222b0a3b16a79649265eabba7e05add?s=128&d=identicon&r=PG&f=1", "display_name": "slowjack2k", "link": "https://stackoverflow.com/users/3940126/slowjack2k"}, "edited": false, "score": 0, "creation_date": 1476647716, "post_id": 39487158, "comment_id": 67422715, "body": "@slowjack2k why didn&#39;t you add this as answer rather than a comment? This is a legitimate question."}, {"owner": {"reputation": 2460, "user_id": 3940126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0222b0a3b16a79649265eabba7e05add?s=128&d=identicon&r=PG&f=1", "display_name": "slowjack2k", "link": "https://stackoverflow.com/users/3940126/slowjack2k"}, "reply_to_user": {"reputation": 5850, "user_id": 4501354, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1230cfcc7f68488ad19d0022cf7b1a93?s=128&d=identicon&r=PG&f=1", "display_name": "Donato", "link": "https://stackoverflow.com/users/4501354/donato"}, "edited": false, "score": 0, "creation_date": 1476649104, "post_id": 39487158, "comment_id": 67423167, "body": "@Donato the answer was in my point of view to short for an answer."}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 3906755, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/3eecf28ed883e7f3a86b007359796847?s=128&d=identicon&r=PG&f=1", "display_name": "user3906755", "link": "https://stackoverflow.com/users/3906755/user3906755"}, "edited": false, "score": 0, "creation_date": 1476775205, "post_id": 40075012, "comment_id": 67475699, "body": "Yes you are right actually I have setup a new server and I forgot to install git .. Thanks for your reply"}], "tags": [], "owner": {"reputation": 2460, "user_id": 3940126, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0222b0a3b16a79649265eabba7e05add?s=128&d=identicon&r=PG&f=1", "display_name": "slowjack2k", "link": "https://stackoverflow.com/users/3940126/slowjack2k"}, "is_accepted": true, "score": 0, "last_activity_date": 1476649033, "creation_date": 1476649033, "answer_id": 40075012, "question_id": 39487158, "link": "https://stackoverflow.com/questions/39487158/cap-aborted-error-sshkitrunnerexecuteerror-exception-while-executing-as-use/40075012#40075012", "title": "Cap aborted error SSHKit::Runner::ExecuteError: Exception while executing as user@abc.com: git exit status: 127", "body": "<p>This error occurs  most commonly when git is not installed on your remote host or your <code>PATH</code> environment variable is not setup properly on the remote host.</p>\n"}], "owner": {"reputation": 93, "user_id": 3906755, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/3eecf28ed883e7f3a86b007359796847?s=128&d=identicon&r=PG&f=1", "display_name": "user3906755", "link": "https://stackoverflow.com/users/3906755/user3906755"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1748, "favorite_count": 1, "accepted_answer_id": 40075012, "answer_count": 1, "score": 1, "last_activity_date": 1483454479, "creation_date": 1473845840, "last_edit_date": 1483454479, "question_id": 39487158, "link": "https://stackoverflow.com/questions/39487158/cap-aborted-error-sshkitrunnerexecuteerror-exception-while-executing-as-use", "title": "Cap aborted error SSHKit::Runner::ExecuteError: Exception while executing as user@abc.com: git exit status: 127", "body": "<p>Hello I am getting cap error while deploying project into production server, can anyone guide me what is the exact error. Thanks in advance.!!</p>\n\n<pre><code>DEBUG [3b21fc00]    /usr/bin/env: git\nDEBUG [3b21fc00]    : No such file or directory\n(Backtrace restricted to imported tasks)\ncap aborted!\nSSHKit::Runner::ExecuteError: Exception while executing as user@abc.com: git exit status: 127\ngit stdout: Nothing written\ngit stderr: /usr/bin/env: git: No such file or directory\n\nSSHKit::Command::Failed: git exit status: 127\ngit stdout: Nothing written\ngit stderr: /usr/bin/env: git: No such file or directory\n\nTasks: TOP =&gt; git:check\n(See full trace by running task with --trace)\nThe deploy has failed with an error: Exception while executing as box-admin@s10.r5i.com: git exit status: 127\ngit stdout: Nothing written\ngit stderr: /usr/bin/env: git: No such file or directory\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "public", "robots.txt"], "comments": [{"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1473846045, "post_id": 39487102, "comment_id": 66292403, "body": "There is no need to have a route defined in the <code>config&#47;routes.rb</code> for a <code>public&#47;robots.txt</code>, because all files in the <code>public</code> should be served directly by the webserver. If the file isn&#39;t served by your server than you need to change the servers configuration (not the application). What server do you use? Where do you host your app?"}, {"owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "reply_to_user": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "edited": false, "score": 0, "creation_date": 1473846197, "post_id": 39487102, "comment_id": 66292488, "body": "I host it on heroku @spickermann. I&#39;m using a site to optimize my SEO and it says, &quot;{MISSING:Robots.txt} The robots.txt file does not exist.&quot;"}, {"owner": {"reputation": 2023, "user_id": 979091, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a3480528206a15015e4a3ba9a68037c4?s=128&d=identicon&r=PG", "display_name": "omnikron", "link": "https://stackoverflow.com/users/979091/omnikron"}, "edited": false, "score": 0, "creation_date": 1473846684, "post_id": 39487102, "comment_id": 66292815, "body": "Do you have the <a href=\"https://devcenter.heroku.com/articles/rails-4-asset-pipeline#serve-assets\" rel=\"nofollow noreferrer\"><code>rails_12factor</code></a> gem installed?"}, {"owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "reply_to_user": {"reputation": 2023, "user_id": 979091, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a3480528206a15015e4a3ba9a68037c4?s=128&d=identicon&r=PG", "display_name": "omnikron", "link": "https://stackoverflow.com/users/979091/omnikron"}, "edited": false, "score": 0, "creation_date": 1473846756, "post_id": 39487102, "comment_id": 66292862, "body": "Yes I do sir @omnikron"}, {"owner": {"reputation": 2023, "user_id": 979091, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a3480528206a15015e4a3ba9a68037c4?s=128&d=identicon&r=PG", "display_name": "omnikron", "link": "https://stackoverflow.com/users/979091/omnikron"}, "edited": false, "score": 0, "creation_date": 1473847150, "post_id": 39487102, "comment_id": 66293131, "body": "Are there any other files in your public folder? Do they work?"}, {"owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "reply_to_user": {"reputation": 2023, "user_id": 979091, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a3480528206a15015e4a3ba9a68037c4?s=128&d=identicon&r=PG", "display_name": "omnikron", "link": "https://stackoverflow.com/users/979091/omnikron"}, "edited": false, "score": 0, "creation_date": 1473847481, "post_id": 39487102, "comment_id": 66293308, "body": "Yes there are. But they don&#39;t work either :/ @omnikron"}, {"owner": {"reputation": 2023, "user_id": 979091, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a3480528206a15015e4a3ba9a68037c4?s=128&d=identicon&r=PG", "display_name": "omnikron", "link": "https://stackoverflow.com/users/979091/omnikron"}, "edited": false, "score": 0, "creation_date": 1473847662, "post_id": 39487102, "comment_id": 66293433, "body": "Hmm. While I&#39;m asking obvious questions, does it work locally in development?"}, {"owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "reply_to_user": {"reputation": 2023, "user_id": 979091, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a3480528206a15015e4a3ba9a68037c4?s=128&d=identicon&r=PG", "display_name": "omnikron", "link": "https://stackoverflow.com/users/979091/omnikron"}, "edited": false, "score": 0, "creation_date": 1473847912, "post_id": 39487102, "comment_id": 66293577, "body": "Yes it works locally. They&#39;re good questions :) @omnikron"}], "answers": [{"comments": [{"owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "edited": false, "score": 0, "creation_date": 1473850594, "post_id": 39487167, "comment_id": 66295038, "body": "Thanks spikermann! When I try to push to heroku tho I get this error: <code>NoMethodError: undefined method &#39;public_file_server&#39; for #&lt;Rails::Application::Configuration:0x007f4fcbfee2d8&gt;</code>"}, {"owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "reply_to_user": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "edited": false, "score": 0, "creation_date": 1473852947, "post_id": 39487167, "comment_id": 66296424, "body": "What version of Rails are you using?"}, {"owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "edited": false, "score": 0, "creation_date": 1473859306, "post_id": 39487167, "comment_id": 66300605, "body": "<code>Using rails 4.2.0.rc3</code> sir"}, {"owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "edited": false, "score": 0, "creation_date": 1473868614, "post_id": 39487167, "comment_id": 66307148, "body": "After some intense googling I figured it out. I updated rails then switched <code>config.eager_load = true</code> Thanks for leading me in the right direction :)"}], "tags": [], "owner": {"reputation": 80852, "user_id": 2483313, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rIBTG.jpg?s=128&g=1", "display_name": "spickermann", "link": "https://stackoverflow.com/users/2483313/spickermann"}, "is_accepted": true, "score": 3, "last_activity_date": 1473847872, "last_edit_date": 1473847872, "creation_date": 1473845873, "answer_id": 39487167, "question_id": 39487102, "link": "https://stackoverflow.com/questions/39487102/how-to-route-to-robots-txt/39487167#39487167", "title": "How to route to robots.txt?", "body": "<p>Ensure that there is the following line in your <code>config/environment/production.rb</code>:</p>\n\n<pre><code>config.public_file_server.enabled = ENV['RAILS_SERVE_STATIC_FILES'].present?\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6527, "user_id": 1669634, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xWMOi.jpg?s=128&g=1", "display_name": "Roozbeh Zabihollahi", "link": "https://stackoverflow.com/users/1669634/roozbeh-zabihollahi"}, "is_accepted": false, "score": 0, "last_activity_date": 1527143898, "creation_date": 1527143898, "answer_id": 50502547, "question_id": 39487102, "link": "https://stackoverflow.com/questions/39487102/how-to-route-to-robots-txt/50502547#50502547", "title": "How to route to robots.txt?", "body": "<p>Or just, add the following line to <code>config/environment/production.rb</code>:</p>\n\n<pre><code>config.public_file_server.enabled = true\n</code></pre>\n"}], "owner": {"reputation": 2578, "user_id": 4383667, "user_type": "registered", "accept_rate": 86, "profile_image": "https://lh3.googleusercontent.com/-0D7SldkahZc/AAAAAAAAAAI/AAAAAAAAAFk/V8nUZfLVtyk/photo.jpg?sz=128", "display_name": "AnthonyGalli.com", "link": "https://stackoverflow.com/users/4383667/anthonygalli-com"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 890, "favorite_count": 0, "accepted_answer_id": 39487167, "answer_count": 2, "score": 0, "last_activity_date": 1527143898, "creation_date": 1473845708, "question_id": 39487102, "link": "https://stackoverflow.com/questions/39487102/how-to-route-to-robots-txt", "title": "How to route to robots.txt?", "body": "<p>I'm told by various sources that <a href=\"http://www.anthonygalli.com/robots.txt\" rel=\"nofollow\">http://www.anthonygalli.com/robots.txt</a> does not exist.</p>\n\n<p>I do have a file in public/robots.txt</p>\n\n<pre><code>User-agent: *\nAllow: /\nSitemap: http://www.anthonygalli.com/sitemap.xml.gz\n</code></pre>\n\n<p>How can I make the route work so that the error goes away and google can properly crawl the site?</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1473846138, "post_id": 39486949, "comment_id": 66292454, "body": "Please clarify your requirements. Do you really just <i>&quot;want to check if this array contains these two values&quot;</i>? Is the element order important or the number of elements?"}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 1, "creation_date": 1473846543, "post_id": 39486949, "comment_id": 66292709, "body": "<code>puts</code> usually prints each element on a new line."}, {"owner": {"reputation": 9030, "user_id": 5101476, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JCQrl.jpg?s=128&g=1", "display_name": "ice\u30c4", "link": "https://stackoverflow.com/users/5101476/ice%e3%83%84"}, "edited": false, "score": 0, "creation_date": 1473846743, "post_id": 39486949, "comment_id": 66292853, "body": "How about <code>[&quot;10001&quot;, &quot;10404&quot;] == [&quot;#{mstmplid}&quot;, &quot;#{ostmplid}&quot;]</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3914, "user_id": 4057366, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uZ3e5.jpg?s=128&g=1", "display_name": "Alex Holubenko", "link": "https://stackoverflow.com/users/4057366/alex-holubenko"}, "is_accepted": true, "score": 3, "last_activity_date": 1473846321, "creation_date": 1473846321, "answer_id": 39487321, "question_id": 39486949, "link": "https://stackoverflow.com/questions/39486949/check-if-two-or-more-values-exist-in-an-array/39487321#39487321", "title": "Check if two or more values exist in an array", "body": "<p>If this two arrays always have just 2 elements, you can check it just by:</p>\n\n<pre><code>templateid.sort == [mstmplid, ostmplid].map(&amp;:to_s).sort\n</code></pre>\n\n<p>if you just want to check if <code>mstmplid, ostmplid</code> included in <code>templateid</code> you should write like this: </p>\n\n<pre><code>[mstmplid, ostmplid].map(&amp;:to_s).all? { |x| templateid.include? x }\n</code></pre>\n"}], "owner": {"reputation": 130, "user_id": 5899485, "user_type": "registered", "accept_rate": 84, "profile_image": "https://lh3.googleusercontent.com/-_bdSanOHh2E/AAAAAAAAAAI/AAAAAAAASI8/4U6xp3d_I1Q/photo.jpg?sz=128", "display_name": "Vlad Cenan", "link": "https://stackoverflow.com/users/5899485/vlad-cenan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 39487321, "answer_count": 1, "score": -1, "last_activity_date": 1473846890, "creation_date": 1473845245, "question_id": 39486949, "link": "https://stackoverflow.com/questions/39486949/check-if-two-or-more-values-exist-in-an-array", "title": "Check if two or more values exist in an array", "body": "<p>I get this response in Ruby:</p>\n\n<pre><code> puts templateid --&gt; [\"10001\", \"10404\"]\n</code></pre>\n\n<p>The first one should be #{mstmplid} and the second one should be #{ostmplid}. I want to check if this array contains these two values with the following function:   </p>\n\n<pre><code>if templateid.all? { |x| [\"#{mstmplid}\", \"#{ostmplid}\"].include?(x) }\n  puts \"OK\"\nend\n</code></pre>\n\n<p>Unfortunatelyy templateid.all? is the same with templateid.any? so it will check if any of the specified values are in the array. How can I check if both values are there? </p>\n"}, {"tags": ["ruby", "module"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 1, "creation_date": 1473852341, "post_id": 39486556, "comment_id": 66296056, "body": "<code>Sample::Constant</code> isn&#39;t aware of the instance created via <code>Sample.new</code>. Let&#39;s say you have two instances, <code>s1 = Sample.new</code> and <code>s2 = Sample.new</code>. Which <code>mod1</code> should be invoked via <code>Sample::Constant.call</code>?"}, {"owner": {"reputation": 1214, "user_id": 1945342, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/61c5e224b0e3ae4fac923f513ee532a3?s=128&d=identicon&r=PG", "display_name": "John Doe", "link": "https://stackoverflow.com/users/1945342/john-doe"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1473853755, "post_id": 39486556, "comment_id": 66296931, "body": "In my requirement, I don&#39;t need a specific instance of <code>mod1</code>. It should return the same for every instance, although it has parameters in actual to make the distinction.  Forgive my ignorance but are you suggesting that I should  stay with using module method?"}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1473855933, "post_id": 39486556, "comment_id": 66298330, "body": "I&#39;m not sure. Why do you want to assign a proc / lamda to a constant in the first place? <code>Sample::Constant.call</code> looks odd to me."}, {"owner": {"reputation": 1214, "user_id": 1945342, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/61c5e224b0e3ae4fac923f513ee532a3?s=128&d=identicon&r=PG", "display_name": "John Doe", "link": "https://stackoverflow.com/users/1945342/john-doe"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1473859380, "post_id": 39486556, "comment_id": 66300657, "body": "I placed the actual code.  I needed to make the regex and the function to stay together that is why I made it in to a constant that holds a hash."}], "answers": [{"comments": [{"owner": {"reputation": 1214, "user_id": 1945342, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/61c5e224b0e3ae4fac923f513ee532a3?s=128&d=identicon&r=PG", "display_name": "John Doe", "link": "https://stackoverflow.com/users/1945342/john-doe"}, "edited": false, "score": 0, "creation_date": 1473851418, "post_id": 39487309, "comment_id": 66295537, "body": "The first one would work but then classes that directly include <code>Module1</code> would have to fully qualify to access <code>Module1</code> methods, which is a little similar to the original.  The second one doesn&#39;t work for the same scenario.  Sorry if I did not mention that <code>Module1</code> can be included directly by other classes. I&#39;ll update the question."}, {"owner": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "reply_to_user": {"reputation": 1214, "user_id": 1945342, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/61c5e224b0e3ae4fac923f513ee532a3?s=128&d=identicon&r=PG", "display_name": "John Doe", "link": "https://stackoverflow.com/users/1945342/john-doe"}, "edited": false, "score": 0, "creation_date": 1473859405, "post_id": 39487309, "comment_id": 66300677, "body": "@JohnDoe Why does the second one does not work? <code>Module1</code> can be included and methods can be called from/of it."}, {"owner": {"reputation": 1214, "user_id": 1945342, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/61c5e224b0e3ae4fac923f513ee532a3?s=128&d=identicon&r=PG", "display_name": "John Doe", "link": "https://stackoverflow.com/users/1945342/john-doe"}, "edited": false, "score": 0, "creation_date": 1473859950, "post_id": 39487309, "comment_id": 66301062, "body": "I get this error: <code>undefined local variable or method </code>inmod2&#39; for #&lt;Sample2` Sample2 includes module 1, and calls the <code>mod1()</code> method."}, {"owner": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "reply_to_user": {"reputation": 1214, "user_id": 1945342, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/61c5e224b0e3ae4fac923f513ee532a3?s=128&d=identicon&r=PG", "display_name": "John Doe", "link": "https://stackoverflow.com/users/1945342/john-doe"}, "edited": false, "score": 0, "creation_date": 1473861850, "post_id": 39487309, "comment_id": 66302512, "body": "@JohnDoe Thats because that example should illustrate a case where the module is included and uses data from the including class (namely the inmod2() method). Change the definition of <code>Module1#mod1</code> to be self-contained if you want."}, {"owner": {"reputation": 1214, "user_id": 1945342, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/61c5e224b0e3ae4fac923f513ee532a3?s=128&d=identicon&r=PG", "display_name": "John Doe", "link": "https://stackoverflow.com/users/1945342/john-doe"}, "edited": false, "score": 0, "creation_date": 1473905322, "post_id": 39487309, "comment_id": 66321656, "body": "You are right it works.  However, when I change the definition of <code>NUMBER</code> constant to a <code>def</code>, it will require changes to all client calls.  I have to weigh in, if it&#39;s worth changing everything to method for uniformity, along with the client calls.  Thank you @Felix for giving me an option."}, {"owner": {"reputation": 1214, "user_id": 1945342, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/61c5e224b0e3ae4fac923f513ee532a3?s=128&d=identicon&r=PG", "display_name": "John Doe", "link": "https://stackoverflow.com/users/1945342/john-doe"}, "edited": false, "score": 0, "creation_date": 1473905941, "post_id": 39487309, "comment_id": 66321792, "body": "I remember there are languages that requires constants to be initialized by literals and not with calculated values, that could be the case in in my problem as well."}], "tags": [], "owner": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "is_accepted": false, "score": 1, "last_activity_date": 1473927870, "last_edit_date": 1473927870, "creation_date": 1473846270, "answer_id": 39487309, "question_id": 39486556, "link": "https://stackoverflow.com/questions/39486556/why-cant-i-call-an-instance-method-from-another-module-to-initialize-a-lambda-i/39487309#39487309", "title": "Why can&#39;t I call an instance method from another module to initialize a lambda in ruby?", "body": "<p><strong>Note</strong> Attempt to answer original question (before the actual code was posted).</p>\n\n<p>Well, it depends. If the modules ship everything they need themselves, you could make <code>mod1</code> a module-function and call it explicitely (then no need to include the module). But I fear that you actually need the context.</p>\n\n<pre><code>module Module1\n  def self.mod1() 1; end\nend\n\nmodule Module2\n  def mod2\n    puts Module1.mod1()\n    puts 2\n  end\n  Constant = lambda { puts Module1.mod1() }  \nend\n\nclass Sample\n  include Module2\n  def go\n    mod2\n    Constant.call  \n  end\nend\n\nSample.new.go\n</code></pre>\n\n<p>outputs</p>\n\n<pre><code>#=&gt;\n1\n2\n1\n</code></pre>\n\n<p>Otherwise you could unconstantize the lambda:</p>\n\n<pre><code>module Module1\n  def mod1() inmod2 ; end\nend\n\nmodule Module2\n  include Module1\n\n  def inmod2\n    1\n  end\n\n  def mod2\n    puts mod1()\n    puts 2\n  end\n  def constant\n    lambda { puts self.mod1() }\n  end\nend\n\nclass Sample\n  include Module2\n  def go\n    mod2\n    constant.call\n  end\nend\n\nSample.new.go\n</code></pre>\n\n<p>Which works (same output). Unfortunately, I cannot explain you why. Am happy to read a answer that includes explanation (feel free to copy my code).</p>\n"}], "owner": {"reputation": 1214, "user_id": 1945342, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/61c5e224b0e3ae4fac923f513ee532a3?s=128&d=identicon&r=PG", "display_name": "John Doe", "link": "https://stackoverflow.com/users/1945342/john-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1473927870, "creation_date": 1473844092, "last_edit_date": 1473906107, "question_id": 39486556, "link": "https://stackoverflow.com/questions/39486556/why-cant-i-call-an-instance-method-from-another-module-to-initialize-a-lambda-i", "title": "Why can&#39;t I call an instance method from another module to initialize a lambda in ruby?", "body": "<p>I am trying to refactor an existing code to simplify.  Originally I was calling the module methods like a static utility method in java.</p>\n\n<p>Here is the new code:</p>\n\n<pre><code>module Module1\n  def mod1() 1; end\nend\n\nmodule Module2\n  include Module1\n  def mod2\n    puts mod1()\n    puts 2\n  end\n  Constant = lambda { mod1() }  # This line fails\nend\n\nclass Sample\n  include Module2\n  def go\n    mod2\n    Constant.call  #  &lt;module:Module2&gt;': undefined method `mod1' for Module2:Module (NoMethodError)\n  end\nend\n\nSample.new.go\n</code></pre>\n\n<p>I can make it work if a simply duplicate the code in <code>Module1</code> into <code>Module2</code>.  Is there a better solution?</p>\n\n<p>Edit: Additionally, I should be able to call methods in <code>Module1</code> from classes that directly include it.  For example:</p>\n\n<pre><code>class Sample2\n  include Module1\n  def go\n    puts mod1()\n  end\nend\nSample2.new.go\n</code></pre>\n\n<p><strong>Actual module 1:</strong></p>\n\n<pre><code>module HtmlUtils\n  def wrap(tag = :span, class_names, text)\n    %(&lt;#{ tag } class=\"#{ class_names }\"&gt;#{ text }&lt;/#{ tag }&gt;)\n  end\nend\n</code></pre>\n\n<p><strong>Actual module 2</strong> The problem is the duplicated code in the 3rd from the last code.  It can be replaced by the HtmlUtils#wrap method.</p>\n\n<pre><code>module Markdown\n  include HtmlUtils\n  BOLD = {\n    regexp: /(_{2}|\\*{2})(.*?)\\1/,\n    lambda: -&gt;(token, regexp) { \"&lt;b&gt;#{ token[regexp, 2] }&lt;/b&gt;\" }\n  }\n  NUMBER = {               \n    regexp: /(?&lt;=\\s|\\()[+-]?(?:[1-9]\\d*|0)(?:\\.\\d+)?(?!-|\\.|\\d|,\\d)/,\n    lambda: -&gt;(token, regexp) { %(&lt;span class=\"num\"&gt;#{ token }&lt;/span&gt;) }  # Redundant Code\n  }\nend\n</code></pre>\n\n<p><strong>Client1 includes Markdown, and in effect HtmlUtils.</strong></p>\n\n<pre><code>@parser.regexter('bold', BOLD[:regexp], BOLD[:lambda]);\n@parser.regexter('numbers', NUMBER[:regexp], NUMBER[:lambda])\nputs @parser.parse('some **string** 1')  # =&gt; some &lt;b&gt;string&lt;/b&gt; &lt;span class=\"num\"&gt;1&lt;/span&gt;\n</code></pre>\n\n<p><strong>Client2 includes HtmlUtils</strong></p>\n\n<pre><code>@parser.regexter('quote', /(?&lt;=)(([\"']).*?\\2)/, -&gt;(token, regexp) { wrap(:quote, token));\nputs @parser.parse('s=\"Hello\"')  # =&gt; s=&lt;span class=\"quote\"&gt;\"Hello\"&lt;/span&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1473842782, "post_id": 39486038, "comment_id": 66290403, "body": "Show your views (working and non-working)"}, {"owner": {"reputation": 4416, "user_id": 2552259, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6d74162f339b5acd772d3f5dadaa8ea?s=128&d=identicon&r=PG", "display_name": "Jorge de los Santos", "link": "https://stackoverflow.com/users/2552259/jorge-de-los-santos"}, "edited": false, "score": 0, "creation_date": 1473843236, "post_id": 39486038, "comment_id": 66290706, "body": "You shuld be using render 3 times, you should render only one and pass flash[:error] to them, or use partials. Even rails shows an error when you use render or redirect many times in a single method."}, {"owner": {"reputation": 22436, "user_id": 1954610, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/27d84db27dd0528916e8cd6954bdd328?s=128&d=identicon&r=PG", "display_name": "Tom Lord", "link": "https://stackoverflow.com/users/1954610/tom-lord"}, "edited": false, "score": 0, "creation_date": 1473843528, "post_id": 39486038, "comment_id": 66290895, "body": "<i>&quot;I am not able to access that in both of the error html files&quot;</i> Where is this happening? I don&#39;t see where <code>userexist</code> or <code>passerror</code> are being rendered."}, {"owner": {"reputation": 6463, "user_id": 5063789, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/57dfee355833ddc59127fc6a0584b908?s=128&d=identicon&r=PG&f=1", "display_name": "mohangraj", "link": "https://stackoverflow.com/users/5063789/mohangraj"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1473843767, "post_id": 39486038, "comment_id": 66291022, "body": "@SergioTulentsev. Thanks. I done my mistakes in my views. Instead of specifying &quot;@name&quot;, I specified &quot;@user&quot;. That is the mistake."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 4416, "user_id": 2552259, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6d74162f339b5acd772d3f5dadaa8ea?s=128&d=identicon&r=PG", "display_name": "Jorge de los Santos", "link": "https://stackoverflow.com/users/2552259/jorge-de-los-santos"}, "edited": false, "score": 0, "creation_date": 1473843968, "post_id": 39486038, "comment_id": 66291139, "body": "@JorgedelosSantos: this code will not produce &quot;double render&quot; error."}, {"owner": {"reputation": 4416, "user_id": 2552259, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6d74162f339b5acd772d3f5dadaa8ea?s=128&d=identicon&r=PG", "display_name": "Jorge de los Santos", "link": "https://stackoverflow.com/users/2552259/jorge-de-los-santos"}, "edited": false, "score": 0, "creation_date": 1473844964, "post_id": 39486038, "comment_id": 66291738, "body": "No because you used return everywhere. But it smells. You shouldn&#39;t have 3 renders and returns, that&#39;s untestable. But we aren&#39;t here to learn about code quality anyways."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 4416, "user_id": 2552259, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e6d74162f339b5acd772d3f5dadaa8ea?s=128&d=identicon&r=PG", "display_name": "Jorge de los Santos", "link": "https://stackoverflow.com/users/2552259/jorge-de-los-santos"}, "edited": false, "score": 0, "creation_date": 1473846131, "post_id": 39486038, "comment_id": 66292450, "body": "@JorgedelosSantos: the rendering part is perfectly testable. <code>expect(response).to render_template(&#39;userexist&#39;)</code>. This code has problems, but multiple rendering ain&#39;t one of them."}], "answers": [{"comments": [{"owner": {"reputation": 6463, "user_id": 5063789, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/57dfee355833ddc59127fc6a0584b908?s=128&d=identicon&r=PG&f=1", "display_name": "mohangraj", "link": "https://stackoverflow.com/users/5063789/mohangraj"}, "edited": false, "score": 0, "creation_date": 1473843850, "post_id": 39486232, "comment_id": 66291067, "body": "Is it possible to send local variable instead of instance variable ?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 6463, "user_id": 5063789, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/57dfee355833ddc59127fc6a0584b908?s=128&d=identicon&r=PG&f=1", "display_name": "mohangraj", "link": "https://stackoverflow.com/users/5063789/mohangraj"}, "edited": false, "score": 0, "creation_date": 1473845674, "post_id": 39486232, "comment_id": 66292187, "body": "Sure, the hash will be passed through as is, think about it as about plain ruby. One might put there whatever."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": false, "score": 1, "last_activity_date": 1473843042, "creation_date": 1473843042, "answer_id": 39486232, "question_id": 39486038, "link": "https://stackoverflow.com/questions/39486038/rails-unable-to-access-instance-variables-in-views/39486232#39486232", "title": "Rails - Unable to access Instance variables in views", "body": "<p>You may explicitly pass whatever you want to access as <code>locals</code> hash parameter to call to <code>render</code>:</p>\n\n<pre><code>render \"userexist\", locals: { name: @name }\n</code></pre>\n\n<p>Now <code>name</code> will be passed through to underlying template.</p>\n"}], "owner": {"reputation": 6463, "user_id": 5063789, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/57dfee355833ddc59127fc6a0584b908?s=128&d=identicon&r=PG&f=1", "display_name": "mohangraj", "link": "https://stackoverflow.com/users/5063789/mohangraj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 729, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1473843960, "creation_date": 1473842480, "last_edit_date": 1473843960, "question_id": 39486038, "link": "https://stackoverflow.com/questions/39486038/rails-unable-to-access-instance-variables-in-views", "title": "Rails - Unable to access Instance variables in views", "body": "<p>Controller:</p>\n\n<pre><code>def store\n  if params[:name].present? &amp;&amp; params[:pass].present? &amp;&amp; params[:cpass].present? &amp;&amp; params[:role].present?\n    @name = params[:name].downcase\n\n    if CheckEmpName(@name) == 0     \n      render \"userexist\"\n      return\n    end\n\n    pass = params[:pass]\n    cpass = params[:cpass]\n\n    if pass != cpass                \n      render \"passerror\"\n      return\n    end\n\n    role = params[:role]\n\n    @user = Employee.new(name: @name, password: pass, role: role)\n    @user.save\n\n  end\n  render \"success\"\nend\n</code></pre>\n\n<p>The above action renders the \"success.html.erb\" page when all the user inputs are valid. Instead if the username is already registered\nor both the password and confirm password are not matched then it renders the appropriate error files which is \"userexist.html.erb\" or\n\"passerror.html.erb\".</p>\n\n<p>Problem:</p>\n\n<p>I am able to access @name instance variable in success.html.erb file. But I am not able to access that in both of the error\nhtml files. Why it is only accessible in \"success\" and not in \"userexist\" and \"passerror\". Why it is not accessible. And What I need to\ndo to access those variable in both of the error handling html pages ? </p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 9602, "user_id": 3607136, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/NRFso.jpg?s=128&g=1", "display_name": "Gagan Gami", "link": "https://stackoverflow.com/users/3607136/gagan-gami"}, "edited": false, "score": 0, "creation_date": 1473840249, "post_id": 39485306, "comment_id": 66288969, "body": "you have defined <code>player_count = 0</code> inside <code>increment_winner</code> method so whenever this method call it set zero, set these two variable as instance variable or global variable out of the method"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6796341"}, "edited": false, "score": 0, "creation_date": 1473840584, "post_id": 39485477, "comment_id": 66289165, "body": "how can I do it without the instance or global variable?"}, {"owner": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "edited": false, "score": 0, "creation_date": 1473840680, "post_id": 39485477, "comment_id": 66289219, "body": "You could, I suppose, read and write from a score file? But why don&#39;t you want to use instance or global variables?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6796341"}, "edited": false, "score": 0, "creation_date": 1473840739, "post_id": 39485477, "comment_id": 66289246, "body": "Is it possible to put it inside my loop instead?"}, {"owner": {"reputation": 1128, "user_id": 3973117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f52a78aa4cf83a8372e28a27ce3511c?s=128&d=identicon&r=PG", "display_name": "jan.zikan", "link": "https://stackoverflow.com/users/3973117/jan-zikan"}, "edited": false, "score": 0, "creation_date": 1473840750, "post_id": 39485477, "comment_id": 66289253, "body": "This solution will not work, because you are setting value 0 to the instance variables each time you call the <code>increment_winner</code> method."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6796341"}, "edited": false, "score": 0, "creation_date": 1473840776, "post_id": 39485477, "comment_id": 66289269, "body": "I am working on a procedural assignment. Not yet on the OOP part or advance part."}, {"owner": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "edited": false, "score": 1, "creation_date": 1473840872, "post_id": 39485477, "comment_id": 66289316, "body": "Global variables are anti-OOP! I suppose the other way would be to use <code>def increment_winner(player, computer, player_count, computer_count)</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6796341"}, "edited": false, "score": 0, "creation_date": 1473840930, "post_id": 39485477, "comment_id": 66289349, "body": "Is it possible to insert it inside my loop instead of using global or instance variable?"}, {"owner": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "reply_to_user": {"reputation": 1128, "user_id": 3973117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f52a78aa4cf83a8372e28a27ce3511c?s=128&d=identicon&r=PG", "display_name": "jan.zikan", "link": "https://stackoverflow.com/users/3973117/jan-zikan"}, "edited": false, "score": 0, "creation_date": 1473841028, "post_id": 39485477, "comment_id": 66289406, "body": "@kallax - Oops, fixed!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6796341"}, "edited": false, "score": 0, "creation_date": 1473841294, "post_id": 39485477, "comment_id": 66289566, "body": "how about constants and local variables would that work?"}], "tags": [], "owner": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "is_accepted": false, "score": 0, "last_activity_date": 1473840951, "last_edit_date": 1473840951, "creation_date": 1473840512, "answer_id": 39485477, "question_id": 39485306, "link": "https://stackoverflow.com/questions/39485306/ruby-method-always-reset-the-number/39485477#39485477", "title": "Ruby Method Always reset the number", "body": "<p>You just need to <a href=\"http://www.techotopia.com/index.php/Ruby_Variable_Scope#Ruby_Global_Variables\" rel=\"nofollow\">create global variables</a> by moving the count variables to global scope and prefixing them with a <code>$</code>:</p>\n\n<pre><code>$player_count = 0\n$computer_count = 0\n\ndef increment_winner(player, computer)\n\n    if win?(player, computer)\n      $player_count+=1\n    elsif win?(computer, player)\n      $computer_count+=1\n    end\n\n    prompt(\"Player Count: #{$player_count}\")\n    prompt(\"Computer Count: #{$computer_count}\")\n\nend\n</code></pre>\n\n<p>However, global variables are looked down on, so you can instead make things static locals:</p>\n\n<pre><code>def increment_winner(player, computer)\n\n    @player_count ||= 0\n    @computer_count ||= 0\n\n    if win?(player, computer)\n      @player_count+=1\n    elsif win?(computer, player)\n      @computer_count+=1\n    end\n\n    prompt(\"Player Count: #{@player_count}\")\n    prompt(\"Computer Count: #{@computer_count}\")\n\nend\n</code></pre>\n\n<p>This is probably the more Ruby-like solution, although I see from your edit that you don't want this solution!</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6796341"}, "edited": false, "score": 0, "creation_date": 1473843650, "post_id": 39486127, "comment_id": 66290957, "body": "Hmm...Interesting."}], "tags": [], "owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "is_accepted": true, "score": 0, "last_activity_date": 1473842735, "creation_date": 1473842735, "answer_id": 39486127, "question_id": 39485306, "link": "https://stackoverflow.com/questions/39485306/ruby-method-always-reset-the-number/39486127#39486127", "title": "Ruby Method Always reset the number", "body": "<p>Just pass the initial values to the function:</p>\n\n<pre><code>def increment_winner(player, computer, counts)\n    if win?(player, computer)\n      counts[:player] += 1\n    elsif win?(computer, player)\n      counts[:computer] += 1\n    end\n\n    prompt(\"Player Count: #{counts[:player]}\")\n    prompt(\"Computer Count: #{counts[:computer]}\")\nend\n</code></pre>\n\n<p>and call this function with the hash param:</p>\n\n<pre><code>counts = {player: 0, computer: 0}\nloop do # main loop\n  ......\n  increment_winner(choice, computer_choice, counts)\n  ......\nend\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6796341"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 39486127, "answer_count": 2, "score": 1, "last_activity_date": 1473842735, "creation_date": 1473839941, "last_edit_date": 1473840534, "question_id": 39485306, "link": "https://stackoverflow.com/questions/39485306/ruby-method-always-reset-the-number", "title": "Ruby Method Always reset the number", "body": "<p>I have this method here that basically counts player wins and computer wins.</p>\n\n<pre><code>def increment_winner(player, computer)\n\n    player_count = 0\n    computer_count = 0\n\n    if win?(player, computer)\n      player_count+=1\n    elsif win?(computer, player)\n      computer_count+=1\n    end\n\n    prompt(\"Player Count: #{player_count}\")\n    prompt(\"Computer Count: #{computer_count}\")\n\nend\n</code></pre>\n\n<p>I tried to use to call it via:</p>\n\n<pre><code>increment_winner(choice, computer_choice)\n</code></pre>\n\n<p>But each time I call the game it always reset the number of counts to zero.</p>\n\n<p>Here's my whole code:</p>\n\n<pre><code>WINNING_COMBO = {\n  'r' =&gt; ['sc', 'l'],\n  'p' =&gt; ['r', 'sp'],\n  'sc' =&gt; ['p', 'l'],\n  'l' =&gt; ['sp', 'p'],\n  'sp' =&gt; ['sc', 'r']\n}\n\ndef win?(first, second)\n  WINNING_COMBO[first].include?(second)\nend\n\n\ndef display_results(player, computer)\n  if win?(player, computer)\n    prompt(\"You won this round!\")\n  elsif win?(computer, player)\n    prompt(\"Computer won this round! You loose!\")\n  else\n    prompt(\"It's a tie on this round! No one wins!\")\n  end\nend\n\ndef increment_winner(player, computer)\n\n    player_count = 0\n    computer_count = 0\n\n    if win?(player, computer)\n      player_count+=1\n    elsif win?(computer, player)\n      computer_count+=1\n    end\n\n    prompt(\"Player Count: #{player_count}\")\n    prompt(\"Computer Count: #{computer_count}\")\n\nend\n\n  loop do # main loop\n    choice = ''\n    loop do\n      prompt(\"Choose a key:\")\n      VALID_CHOICES.each do |short_name, complete_name|\n        prompt(\"'#{short_name}' for #{complete_name}\")\n      end\n      choice = Kernel.gets().chomp().downcase()\n\n      if VALID_CHOICES.include?(choice)\n        break\n      else\n        prompt(\"That's not a valid choice.\")\n      end\n    end\n\n    computer_choice = VALID_CHOICES.keys.sample\n    display_results(choice, computer_choice)\n    increment_winner(choice, computer_choice)\n    prompt(\"Do you want to play again? ('yes' or 'no')\")\n\n  loop do  \n    answer = Kernel.gets().chomp()\n    if answer.casecmp('yes').zero?\n      break\n    elsif answer.casecmp('no').zero?\n      prompt(\"Thank you for playing!\\n  Have a nice day! Good bye!\")\n      exit\n    else\n      prompt(\"Please enter either 'yes' or 'no'.\")\n    end\n\n  end\n\n  end\n</code></pre>\n\n<p>Any idea how can I improve the method so it will not reset the count? If it's not possible, how can I use it within the loop? How can I know w/c variable to use to know which is the winner?</p>\n\n<p>NOTE: I don't want to use instance or global variable here as it is for object oriented. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "nested-forms", "collection-select"], "answers": [{"tags": [], "owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "is_accepted": true, "score": 4, "last_activity_date": 1473838080, "creation_date": 1473838080, "answer_id": 39484763, "question_id": 39484537, "link": "https://stackoverflow.com/questions/39484537/collection-select-not-displaying-the-selected-value-in-edit-form-for-rails-4/39484763#39484763", "title": "Collection Select not displaying the selected value in edit form for rails 4", "body": "<p>This is the issue with <code>nested_attributes</code> and <code>dropdown</code></p>\n\n<p>You can make use of form object <code>\"f\"</code> to get <code>:product_id</code> using <code>f.object.product_id</code> and pass it as <code>selected</code> value</p>\n\n<pre><code>&lt;%= f.select :product_id,\n              options_from_collection_for_select(Product.all, \"id\", \"product_name\", f.object.product_id), \n              prompt: \"Select something\" %&gt;\n</code></pre>\n\n<p>Refer <a href=\"http://apidock.com/rails/v4.2.1/ActionView/Helpers/FormOptionsHelper/options_from_collection_for_select\" rel=\"nofollow\"><code>options_from_collection_for_select</code></a></p>\n"}, {"tags": [], "owner": {"reputation": 7720, "user_id": 349659, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/3db4a8e9aa5e19682c0a65fe31cf6702?s=128&d=identicon&r=PG", "display_name": "CTS_AE", "link": "https://stackoverflow.com/users/349659/cts-ae"}, "is_accepted": false, "score": 0, "last_activity_date": 1580268816, "creation_date": 1580268816, "answer_id": 59960159, "question_id": 39484537, "link": "https://stackoverflow.com/questions/39484537/collection-select-not-displaying-the-selected-value-in-edit-form-for-rails-4/59960159#59960159", "title": "Collection Select not displaying the selected value in edit form for rails 4", "body": "<p>I would recommend going with the way Deepak Mahakale mentioned using <code>options_from_collection_for_select</code></p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>&lt;=% f.select :produt_id,\n  options_from_collection_for_select(\n    Product.all, :id, :product_name, f.object.product_id)\n%&gt;\n</code></pre>\n\n<p>Here's another way I was playing with, but doesn't seem to be the \"Rails standard\".</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>&lt;=% f.select :produt_id,\n  Product.pluck(:product_name, :id),\n  { selected: f.object.product_id }\n%&gt;\n</code></pre>\n\n<p>I suffered through this madness so that I could have a dropdown for a <code>belongs_to</code> relationship.</p>\n"}], "owner": {"reputation": 663, "user_id": 5110480, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/210fea696d0260204d18a7a7d54bf2dd?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Mesta", "link": "https://stackoverflow.com/users/5110480/mahesh-mesta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2777, "favorite_count": 1, "accepted_answer_id": 39484763, "answer_count": 2, "score": 1, "last_activity_date": 1580268816, "creation_date": 1473837326, "last_edit_date": 1473841763, "question_id": 39484537, "link": "https://stackoverflow.com/questions/39484537/collection-select-not-displaying-the-selected-value-in-edit-form-for-rails-4", "title": "Collection Select not displaying the selected value in edit form for rails 4", "body": "<p>I have a Vendor model, a Product model and a VendorProduct model with the following association</p>\n\n<pre><code>class Vendor &lt; ActiveRecord::Base\n  has_many :vendor_products\n  has_many :products, through: :vendor_products\nend\n\nclass Product &lt; ActiveRecord::Base\n  has_many :vendor_products\n  has_many :vendors, through: :vendor_products\nend\n\nclass VendorProduct &lt; ActiveRecord::Base\n  belongs_to :vendor\n  belongs_to :product\nend\n</code></pre>\n\n<p>I am using nested_form gem to display a dropdown collection select option for products on my vendor _form.html.erb page</p>\n\n<pre><code>&lt;%= nested_form_for(@vendor) do |f| %&gt;\n  &lt;% if @vendor.errors.any? %&gt;\n      :\n      :\n      :\n    &lt;%= f.fields_for :vendor_products do |vproducts| %&gt;\n      &lt;%=  render 'product_fields', :f =&gt; vproducts %&gt; \n      &lt;%= vproducts.link_to_remove \"Remove this Product\"  %&gt;\n    &lt;% end %&gt; &amp;nbsp\n    &lt;%= f.link_to_add \"Add product\", :vendor_products %&gt;\n\n    &lt;div class=\"actions\"&gt;\n      &lt;%= f.submit %&gt;\n    &lt;/div&gt;\n&lt;% end %&gt;  \n</code></pre>\n\n<p>My _product_fields.html.erb is</p>\n\n<pre><code>&lt;div class= \"vendor_products\"&gt;\n  &lt;div class=\"field\"&gt;\n    &lt;%= f.label :product_id %&gt;&lt;br&gt;\n    &lt;%= f.select :product_id, \n    options_from_collection_for_select(Product.all, \"id\", \n       \"product_name\"), prompt: \"Select something\", %&gt;\n      &amp;nbsp\n    &lt;%= f.label :copies %&gt;\n    &lt;%= f.number_field :copies %&gt;\n  &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>My Vendor model has the following accepted_nested_attributes for vendor_products</p>\n\n<pre><code>class Vendor &lt; ActiveRecord::Base\n  accepts_nested_attributes_for :vendor_products, :allow_destroy =&gt; \n   true, :reject_if =&gt; :all_blank\nend\n</code></pre>\n\n<p>My vendor controller is here</p>\n\n<pre><code>def new \n  @vendor = Vendor.new\n  @vendor.vendor_products.build\nend\n\ndef edit\n  @vendor.vendor_products.build\nend\n</code></pre>\n\n<p>The vendor and the <code>VendorProduct</code> which contains <code>Product_id</code> and <code>Vendor_id</code> gets populated correctly. All works well, the only problem is that in the vendors edit page, the product select option does not displays the selected value but rather the first option in the drop down list. However when I check my value for the row, the correct product has been added to the table.Only the edit page drop down does not shows the actually selected value.</p>\n\n<p>How can I fix this? Please help.</p>\n"}, {"tags": ["json", "ruby", "memory-leaks", "sidekiq"], "comments": [{"owner": {"reputation": 12542, "user_id": 156746, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8TsPx.jpg?s=128&g=1", "display_name": "DiegoSalazar", "link": "https://stackoverflow.com/users/156746/diegosalazar"}, "edited": false, "score": 0, "creation_date": 1473865890, "post_id": 39484065, "comment_id": 66305372, "body": "How long did you profile for? If only for a short time <code>reactions_purged</code> will grow if your loop doesn&#39;t break frequently enough."}, {"owner": {"reputation": 5190, "user_id": 261052, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4f2985a2ae86674700c7afa0aef657db?s=128&d=identicon&r=PG", "display_name": "Himberjack", "link": "https://stackoverflow.com/users/261052/himberjack"}, "reply_to_user": {"reputation": 12542, "user_id": 156746, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8TsPx.jpg?s=128&g=1", "display_name": "DiegoSalazar", "link": "https://stackoverflow.com/users/156746/diegosalazar"}, "edited": false, "score": 0, "creation_date": 1473919902, "post_id": 39484065, "comment_id": 66325360, "body": "@diego.greyrobot I do break. it may do ~1000 loops or more. but eventually it finishes"}], "owner": {"reputation": 5190, "user_id": 261052, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4f2985a2ae86674700c7afa0aef657db?s=128&d=identicon&r=PG", "display_name": "Himberjack", "link": "https://stackoverflow.com/users/261052/himberjack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 201, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1473835550, "creation_date": 1473835550, "question_id": 39484065, "link": "https://stackoverflow.com/questions/39484065/httparty-and-json-memory-leak", "title": "HTTParty and JSON memory leak?", "body": "<p>I've been having a hard time debugging the memory leak.\nI have paging using HTTParty inside Sidekiq, and the memory is keep growing and growing. I profiled the sidekiq and this is what I found:</p>\n\n<pre><code> 540 /home/user/.rvm/gems/ruby-2.2.3/gems/aws-sdk-core-2.4.2/lib/seahorse/client/configuration.rb:157:DATA\n 540 /home/user/.rvm/gems/ruby-2.2.3/gems/aws-sdk-core-2.4.2/lib/seahorse/client/configuration.rb:157:NODE\n 609 /home/user/.rvm/gems/ruby-2.2.3/gems/activesupport-4.1.14/lib/active_support/core_ext/class/attribute.rb:86:DATA\n1376 /home/user/.rvm/gems/ruby-2.2.3/gems/activerecord-4.1.14/lib/active_record/connection_adapters/postgresql/database_statements.rb:148:STRING\n1712 /home/user/.rvm/gems/ruby-2.2.3/gems/activesupport-4.1.14/lib/active_support/dependencies.rb:247:ARRAY\n1713 /home/user/.rvm/rubies/ruby-2.2.3/lib/ruby/2.2.0/set.rb:290:STRING\n1964 /home/user/.rvm/gems/ruby-2.2.3/gems/mime-types-3.1/lib/mime/types/_columnar.rb:29:OBJECT\n1964 /home/user/.rvm/rubies/ruby-2.2.3/lib/ruby/2.2.0/set.rb:72:OBJECT\n2572 /home/user/.rvm/gems/ruby-2.2.3/gems/mime-types-3.1/lib/mime/types/_columnar.rb:24:STRING\n2987 /home/user/.rvm/gems/ruby-2.2.3/gems/activesupport-4.1.14/lib/active_support/dependencies.rb:247:NODE\n3126 /home/user/.rvm/gems/ruby-2.2.3/gems/mime-types-3.1/lib/mime/types/container.rb:10:OBJECT\n3506 /home/user/.rvm/gems/ruby-2.2.3/gems/activesupport-4.1.14/lib/active_support/dependencies.rb:247:DATA\n3928 /home/user/.rvm/gems/ruby-2.2.3/gems/mime-types-3.1/lib/mime/type.rb:532:STRING\n3928 /home/user/.rvm/gems/ruby-2.2.3/gems/mime-types-3.1/lib/mime/type.rb:543:STRING\n5175 /home/user/.rvm/rubies/ruby-2.2.3/lib/ruby/2.2.0/set.rb:81:HASH\n5234 /home/user/.rvm/gems/ruby-2.2.3/gems/activesupport-4.1.14/lib/active_support/dependencies.rb:247:STRING\n5892 /home/user/.rvm/gems/ruby-2.2.3/gems/mime-types-3.1/lib/mime/type.rb:546:STRING\n8120 /home/user/.rvm/gems/ruby-2.2.3/gems/json-1.8.3/lib/json/common.rb:155:ARRAY\n87403 /home/user/.rvm/gems/ruby-2.2.3/gems/json-1.8.3/lib/json/common.rb:155:HASH\n541817 /home/user/.rvm/gems/ruby-2.2.3/gems/json-1.8.3/lib/json/common.rb:155:STRING\n</code></pre>\n\n<p>Notice the json STRING and HASH. These bottom 2 just keeps growing as the sidekiq keeps on running more and more jobs.</p>\n\n<p>The code is this:</p>\n\n<pre><code>...\nbegin\n      reactions = HTTParty.get(\"https://graph.facebook.com/v2.7/#{vid.external_id}/reactions?summary=true&amp;limit=#{PAGE_SIZE}&amp;access_token=#{ENV['at']}\")\n    rescue Exception =&gt; ex\n\n\n      return\n    end\n\n    r_last_id = \"vl/programs/#{vid.program_id}/vids/#{vid.id}/reactions/last_id\"\n    r_last_entry_idx = \"vl/programs/#{vid.program_id}/vids/#{vid.id}/reactions/last_entry_idx\"\n    reactions_purged = []\n    abort = false\n    total_records = reactions['summary']['total_count'] || 0\n    last_total_count = $redis.get(r_last_entry_idx).to_i\n\n    need_to_run = total_records - last_total_count\n    need_to_run = 0 if need_to_run &lt; 0\n\n    last_id = nil\n    loop do\n\n      break if reactions['data'].nil? || reactions['data'].empty?\n\n      reactions['data'].each do |r|\n\n        last_id = $redis.get(r_last_id)\n\n        abort = true and break if !last_id.nil? &amp;&amp; need_to_run &lt;= 0\n\n        need_to_run -= 1\n        reactions_purged &lt;&lt; r\n      end\n\n      GC.start # &lt;----- Even this didnt solve it\n\n      break if abort\n      break if reactions['paging']['next'].nil?\n      reactions = HTTParty.get(reactions['paging']['next'])\n\n    end\n...\n</code></pre>\n\n<p>Even the GC.start I added as you see, didn't solve it.\nWhat causes this JSON leakage? this is coming from HTTParty...</p>\n\n<p>Thanks</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "mongodb", "csv"], "comments": [{"owner": {"reputation": 447, "user_id": 2628557, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ChwLa.jpg?s=128&g=1", "display_name": "ronnie bermejo", "link": "https://stackoverflow.com/users/2628557/ronnie-bermejo"}, "edited": false, "score": 0, "creation_date": 1539313466, "post_id": 39483314, "comment_id": 92465418, "body": "See here for some insights: <a href=\"https://dalibornasevic.com/posts/68-processing-large-csv-files-with-ruby\" rel=\"nofollow noreferrer\">dalibornasevic.com/posts/&hellip;</a>"}], "owner": {"reputation": 537, "user_id": 4907105, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/YbVDe.jpg?s=128&g=1", "display_name": "Sumeet Masih", "link": "https://stackoverflow.com/users/4907105/sumeet-masih"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 94, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1473832308, "creation_date": 1473832308, "question_id": 39483314, "link": "https://stackoverflow.com/questions/39483314/rails-app-taking-longer-than-30-seconds-for-mongo-query", "title": "Rails app taking longer than 30 seconds for mongo query", "body": "<p>I have a mongo db on remote, having a collection named <em>con_v</em>, here is the preview of one object.</p>\n\n<pre><code>{\n    \"_id\" : ObjectId(\"xxxxxxx\"),\n    \"complete\" : false,\n    \"far\" : \"something\",\n    \"input\" : {\n        \"number_of_apples\" : 2,\n        \"type_of_apple\" : \"red\"\n    },\n    \"created_at\" : ISODate(\"xxxxx\"),\n    \"error\" : false,\n    \"version_id\" : ObjectId(\"someID\"),\n    \"transcript\" : \"\\nUser: \\nScript: hello this is a placeholder script.\\nScript: how many apples do you want?\\n\",\n    \"account_id\" : null,\n    \"channel_id\" : ObjectId(\"some channel ID\"),\n    \"channel_mode_id\" : ObjectId(\"some channel mode ID\"),\n    \"units\" : 45,\n    \"updated_at\" : ISODate(\"xxxx\")\n}\n</code></pre>\n\n<p>I am using rails app to make queries from the remote mongo db, If I am fetching 20-50 records its responding but I need more than 1000 records at a time, I have a function creating csv file from that record, before it was working fine but now its taking longer than usual and freezing the server (total # of records are around 30K). Directly through mongo shell or using rails console the query is taking no time. Same thing if I am doing with cloned db at local machine app works fine.. </p>\n\n<p><em>here is the code in model file which queries and generates csv file</em> </p>\n\n<pre><code>  def self.to_csv(con_v)\n    version = con_v.first.version\n    CSV.generate do |csv|\n      fields = version.input_set_field_names\n      extra_fields = ['Collected At', 'Far', 'Name', 'Version','Completed']\n\n      csv &lt;&lt; fields + extra_fields\n      con_v.each do |con|\n        values = con.input.values_at(*fields)\n        extra_values = [\n          con.created_at,\n          con.units,\n          con.far,\n          version.name,\n          con.complete\n        ]\n        csv &lt;&lt; values + extra_values\n      end\n    end    \n</code></pre>\n\n<p><strong>nutshell is app is taking longer on remote db, very slow mongo query but works fine wit local db, Debugged using pry, controller code is fine its getting the records as well just the respond time is slow on remote</strong></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "answers": [{"comments": [{"owner": {"reputation": 266, "user_id": 451451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YQw7J.jpg?s=128&g=1", "display_name": "David Battersby", "link": "https://stackoverflow.com/users/451451/david-battersby"}, "edited": false, "score": 0, "creation_date": 1473838514, "post_id": 39484379, "comment_id": 66288014, "body": "This would catch pre / post words but not those in between the long tail keywords. Needs to work for &quot;boutique hotel <i>in</i> London&quot; while the keyword is &quot;boutique hotel London&quot;"}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "reply_to_user": {"reputation": 266, "user_id": 451451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YQw7J.jpg?s=128&g=1", "display_name": "David Battersby", "link": "https://stackoverflow.com/users/451451/david-battersby"}, "edited": false, "score": 0, "creation_date": 1473838566, "post_id": 39484379, "comment_id": 66288036, "body": "so it should only work for prepositions in between keywords?"}, {"owner": {"reputation": 266, "user_id": 451451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YQw7J.jpg?s=128&g=1", "display_name": "David Battersby", "link": "https://stackoverflow.com/users/451451/david-battersby"}, "edited": false, "score": 0, "creation_date": 1473838655, "post_id": 39484379, "comment_id": 66288097, "body": "Yes for those in between keywords (a &#39;keyword&#39; can be several words long in this case) but also for direct matches when no preposition is required."}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "reply_to_user": {"reputation": 266, "user_id": 451451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YQw7J.jpg?s=128&g=1", "display_name": "David Battersby", "link": "https://stackoverflow.com/users/451451/david-battersby"}, "edited": false, "score": 0, "creation_date": 1473839740, "post_id": 39484379, "comment_id": 66288690, "body": "So just create the combinations as required? If you don&#39;t know how, then add some desired inputs and outputs to the question."}], "tags": [], "owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "is_accepted": false, "score": 0, "last_activity_date": 1473836771, "creation_date": 1473836771, "answer_id": 39484379, "question_id": 39483240, "link": "https://stackoverflow.com/questions/39483240/highlighting-keywords-in-string-allowing-at-in-on/39484379#39484379", "title": "Highlighting keywords in string, allowing &quot;at&quot;, &quot;in&quot;, &quot;on&quot;", "body": "<p>Would it be enough to just create a list of keywords with prepositions concatenated?</p>\n\n<pre><code>keywords_with_prepositions = prepositions.flat_map do |preposition|\n  keywords.map do |keyword|\n    [keyword, \"#{keyword} #{preposition}\", \"#{preposition} #{keyword}\", \"something other in combinatation with your #{keyword}\"]\n  end\nend\n</code></pre>\n\n<p>My suggestion is to move this out of the model and into a decorator or helper. Also the <code>require</code> in the method should be moved some levels up.</p>\n"}], "owner": {"reputation": 266, "user_id": 451451, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YQw7J.jpg?s=128&g=1", "display_name": "David Battersby", "link": "https://stackoverflow.com/users/451451/david-battersby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473839428, "creation_date": 1473832005, "last_edit_date": 1473839428, "question_id": 39483240, "link": "https://stackoverflow.com/questions/39483240/highlighting-keywords-in-string-allowing-at-in-on", "title": "Highlighting keywords in string, allowing &quot;at&quot;, &quot;in&quot;, &quot;on&quot;", "body": "<p>For each Article there is a list of keywords which are currently highlighted (wrapped in span with class). However, I need to allow for certain prepositions within the keyword (\"at\", \"in\", \"on\"). Each article belongs to an Order which contains the keywords as a comma separated string.</p>\n\n<p>For example, if I have a long tail keyword like \"boutique hotels london\" and the article contains the words \"boutique hotels <strong>in</strong> london\" I need to highlight that as a keyword.</p>\n\n<pre><code>class Article &lt; ActiveRecord::Base\n  def format_content\n    words = self.content\n\n    # map comma separated keywords into array and remove any whitespace\n    keywords = self.order.keywords.downcase.split(',').map{ |k| k.strip }\n\n    # replace words with keywords wrapped in span\n    keywords.each do |word|\n      words = words.gsub(/(#{word})/i, \"&lt;span class=\\\"text-primary\\\"&gt;\\\\1&lt;/span&gt;\")\n    end\n\n    words\n  end\nend\n</code></pre>\n\n<p>The format_content method is used in a partial from the show view after an article is created, like so:</p>\n\n<pre><code>&lt;%= simple_format article.format_content, { class: \"content\" }, wrapper_tag: \"p\" %&gt;\n</code></pre>\n"}, {"tags": ["ruby", "regex"], "comments": [{"owner": {"reputation": 68253, "user_id": 20938, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CuXSm.jpg?s=128&g=1", "display_name": "Alan Moore", "link": "https://stackoverflow.com/users/20938/alan-moore"}, "edited": false, "score": 1, "creation_date": 1473832414, "post_id": 39482904, "comment_id": 66285128, "body": "You mean this? <code>&#47;\\s+(?![^&lt;]*&gt;)&#47;</code>"}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 0, "creation_date": 1473832828, "post_id": 39482904, "comment_id": 66285301, "body": "I think you need non-greedy match, <code>[^&lt;]*?&gt;</code>."}, {"owner": {"reputation": 4766, "user_id": 353130, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/6b71251b5261e1fe3142bf620e573724?s=128&d=identicon&r=PG", "display_name": "Giuseppe", "link": "https://stackoverflow.com/users/353130/giuseppe"}, "reply_to_user": {"reputation": 68253, "user_id": 20938, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CuXSm.jpg?s=128&g=1", "display_name": "Alan Moore", "link": "https://stackoverflow.com/users/20938/alan-moore"}, "edited": false, "score": 0, "creation_date": 1473833821, "post_id": 39482904, "comment_id": 66285736, "body": "@Alan, you are correct, can you post your solution as the answer?"}, {"owner": {"reputation": 68253, "user_id": 20938, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CuXSm.jpg?s=128&g=1", "display_name": "Alan Moore", "link": "https://stackoverflow.com/users/20938/alan-moore"}, "reply_to_user": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "edited": false, "score": 0, "creation_date": 1473840733, "post_id": 39482904, "comment_id": 66289242, "body": "@user1934428: The greedy version is correct, but a non-greedy one would be more efficient.  Even better is what I used in my answer: <code>[&lt;&gt;]*&gt;</code>."}, {"owner": {"reputation": 11741, "user_id": 1934428, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/072774c5d4204a1c2385560e6114a887?s=128&d=identicon&r=PG", "display_name": "user1934428", "link": "https://stackoverflow.com/users/1934428/user1934428"}, "reply_to_user": {"reputation": 68253, "user_id": 20938, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CuXSm.jpg?s=128&g=1", "display_name": "Alan Moore", "link": "https://stackoverflow.com/users/20938/alan-moore"}, "edited": false, "score": 0, "creation_date": 1473859565, "post_id": 39482904, "comment_id": 66300781, "body": "@AlanMoore: Given your greedy form, if we have a text of the form <code>A&lt;B&gt;C&lt;D&gt;E</code>,  wouldn&#39;t it ignore the C part? If C contains spaces, they would be ignored, because after the opening &#39;&lt;&#39; right after A, everything until the closing &#39;&gt;&#39; right after D would be covered by your regexp."}, {"owner": {"reputation": 68253, "user_id": 20938, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CuXSm.jpg?s=128&g=1", "display_name": "Alan Moore", "link": "https://stackoverflow.com/users/20938/alan-moore"}, "edited": false, "score": 0, "creation_date": 1473860852, "post_id": 39482904, "comment_id": 66301746, "body": "Sorry, I omitted the <code>^</code> in the comment.  It&#39;s correct in the answer."}], "answers": [{"tags": [], "owner": {"reputation": 4265, "user_id": 4601088, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bN143.jpg?s=128&g=1", "display_name": "Bart\u0142omiej G\u0142adys", "link": "https://stackoverflow.com/users/4601088/bart%c5%82omiej-g%c5%82adys"}, "is_accepted": false, "score": 0, "last_activity_date": 1473832788, "last_edit_date": 1473832788, "creation_date": 1473830494, "answer_id": 39482963, "question_id": 39482904, "link": "https://stackoverflow.com/questions/39482904/regex-match-something-except-within-arbitrary-delimiters/39482963#39482963", "title": "Regex: match something except within arbitrary delimiters", "body": "<p>I think, it works:</p>\n\n<pre><code>a = \"Please match spaces here &lt;but not here&gt;. Again match here &lt;while ignoring these&gt;\"\n\npattern = /&lt;(?:(?!&lt;).)*&gt;/\n\na.gsub(pattern, '')\n# =&gt; \"Please match spaces here . Again match here \"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4766, "user_id": 353130, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/6b71251b5261e1fe3142bf620e573724?s=128&d=identicon&r=PG", "display_name": "Giuseppe", "link": "https://stackoverflow.com/users/353130/giuseppe"}, "edited": false, "score": 0, "creation_date": 1473843920, "post_id": 39485458, "comment_id": 66291107, "body": "let me understand: are you saying that the pattern would be simpler if a different delimiter (other than angle brackets) were to be used?"}, {"owner": {"reputation": 68253, "user_id": 20938, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CuXSm.jpg?s=128&g=1", "display_name": "Alan Moore", "link": "https://stackoverflow.com/users/20938/alan-moore"}, "reply_to_user": {"reputation": 4766, "user_id": 353130, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/6b71251b5261e1fe3142bf620e573724?s=128&d=identicon&r=PG", "display_name": "Giuseppe", "link": "https://stackoverflow.com/users/353130/giuseppe"}, "edited": false, "score": 0, "creation_date": 1473861428, "post_id": 39485458, "comment_id": 66302180, "body": "No, I&#39;m just trying to cover all the bases.  This is actually the simplest scenario.  Parentheses or square brackets would have to be escaped, and non-bracketing delimiters like quotes would require a much more complicated regex."}], "tags": [], "owner": {"reputation": 68253, "user_id": 20938, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CuXSm.jpg?s=128&g=1", "display_name": "Alan Moore", "link": "https://stackoverflow.com/users/20938/alan-moore"}, "is_accepted": true, "score": 2, "last_activity_date": 1473840446, "creation_date": 1473840446, "answer_id": 39485458, "question_id": 39482904, "link": "https://stackoverflow.com/questions/39482904/regex-match-something-except-within-arbitrary-delimiters/39485458#39485458", "title": "Regex: match something except within arbitrary delimiters", "body": "<p>This should do it:</p>\n\n<pre><code>result = subject.gsub(/\\s+(?![^&lt;&gt;]*&gt;)/, '_')\n</code></pre>\n\n<p>This regex assumes there's nothing tricky like escaped angle brackets.  Also be aware that <code>\\s</code> matches newlines, TABs and other whitespace characters as well as spaces.  That's probably what you want, but you have the option of matching only spaces:</p>\n\n<pre><code>/ +(?![^&lt;&gt;]*&gt;)/\n</code></pre>\n"}], "owner": {"reputation": 4766, "user_id": 353130, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/6b71251b5261e1fe3142bf620e573724?s=128&d=identicon&r=PG", "display_name": "Giuseppe", "link": "https://stackoverflow.com/users/353130/giuseppe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 1, "accepted_answer_id": 39485458, "answer_count": 2, "score": 0, "last_activity_date": 1473840446, "creation_date": 1473830072, "last_edit_date": 1473833778, "question_id": 39482904, "link": "https://stackoverflow.com/questions/39482904/regex-match-something-except-within-arbitrary-delimiters", "title": "Regex: match something except within arbitrary delimiters", "body": "<p>My string:</p>\n\n<pre><code>a = \"Please match spaces here &lt;but not here&gt;. Again match here &lt;while ignoring these&gt;\"\n</code></pre>\n\n<p>Using Ruby's regex flavor, I would like to do something like:</p>\n\n<pre><code>a.gsub /regex_pattern/, '_'\n</code></pre>\n\n<p>And obtain:</p>\n\n<pre><code>\"Please_match_spaces_here_&lt;but not here&gt;._Again_match_here_&lt;while ignoring these&gt;\"\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "routing", "routes"], "comments": [{"owner": {"reputation": 4265, "user_id": 4601088, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bN143.jpg?s=128&g=1", "display_name": "Bart\u0142omiej G\u0142adys", "link": "https://stackoverflow.com/users/4601088/bart%c5%82omiej-g%c5%82adys"}, "edited": false, "score": 0, "creation_date": 1473830007, "post_id": 39482759, "comment_id": 66284385, "body": "Show your <code>form.html.erb</code>"}, {"owner": {"reputation": 674, "user_id": 1441143, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bc0f204c0f4bb8a87c0294c397ce0a08?s=128&d=identicon&r=PG&f=1", "display_name": "Jakxna360", "link": "https://stackoverflow.com/users/1441143/jakxna360"}, "reply_to_user": {"reputation": 4265, "user_id": 4601088, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bN143.jpg?s=128&g=1", "display_name": "Bart\u0142omiej G\u0142adys", "link": "https://stackoverflow.com/users/4601088/bart%c5%82omiej-g%c5%82adys"}, "edited": false, "score": 0, "creation_date": 1473830198, "post_id": 39482759, "comment_id": 66284447, "body": "Added the form partial"}], "answers": [{"comments": [{"owner": {"reputation": 674, "user_id": 1441143, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bc0f204c0f4bb8a87c0294c397ce0a08?s=128&d=identicon&r=PG&f=1", "display_name": "Jakxna360", "link": "https://stackoverflow.com/users/1441143/jakxna360"}, "edited": false, "score": 0, "creation_date": 1473830944, "post_id": 39482943, "comment_id": 66284655, "body": "The problem I am having is when I click update it&#39;s taking it to /static_pages/page_site. It&#39;s supposed to go and find it at /page_site like the show does. How do I point it to this site. Likewise is there a way of making @static_page = StaticPage.find_by_slug(params[:slug]) find the object at /item instead of staticpage/item?"}, {"owner": {"reputation": 23312, "user_id": 560215, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bb365e8477053edcc55b40c3d27781d8?s=128&d=identicon&r=PG", "display_name": "sevenseacat", "link": "https://stackoverflow.com/users/560215/sevenseacat"}, "reply_to_user": {"reputation": 674, "user_id": 1441143, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bc0f204c0f4bb8a87c0294c397ce0a08?s=128&d=identicon&r=PG&f=1", "display_name": "Jakxna360", "link": "https://stackoverflow.com/users/1441143/jakxna360"}, "edited": false, "score": 1, "creation_date": 1473838719, "post_id": 39482943, "comment_id": 66288117, "body": "This is the part where you would normally go back to the tutorial you&#39;re following, and work with that :)"}, {"owner": {"reputation": 674, "user_id": 1441143, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bc0f204c0f4bb8a87c0294c397ce0a08?s=128&d=identicon&r=PG&f=1", "display_name": "Jakxna360", "link": "https://stackoverflow.com/users/1441143/jakxna360"}, "edited": false, "score": 0, "creation_date": 1474048982, "post_id": 39482943, "comment_id": 66389141, "body": "Thank you for your help. I redid the tutorial and using find_by_slug! worked when using friendly_ID."}], "tags": [], "owner": {"reputation": 23312, "user_id": 560215, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bb365e8477053edcc55b40c3d27781d8?s=128&d=identicon&r=PG", "display_name": "sevenseacat", "link": "https://stackoverflow.com/users/560215/sevenseacat"}, "is_accepted": true, "score": 1, "last_activity_date": 1473830348, "creation_date": 1473830348, "answer_id": 39482943, "question_id": 39482759, "link": "https://stackoverflow.com/questions/39482759/undefined-method-update-for-nilnilclass-friendly-id-and-scaffolded-controlle/39482943#39482943", "title": "undefined method `update&#39; for nil:NilClass. Friendly_id and Scaffolded controller", "body": "<p>You're calling <code>@static_page.update(static_page_params)</code>, but in this case, <code>@static_page</code> is nil.</p>\n\n<p>You've defined <code>@static_page</code> as <code>@static_page = StaticPage.find_by_slug(params[:slug])</code>,  but this will return <code>nil</code> if no page with that slug is found.</p>\n\n<p>There are two ways you can handle this:</p>\n\n<ul>\n<li>Use <code>find_by_slug!</code> instead, which will raise an exception if no record is found, or:</li>\n<li>Check for the presence of <code>nil</code> yourself, and decide how you want to handle it.</li>\n</ul>\n"}], "owner": {"reputation": 674, "user_id": 1441143, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bc0f204c0f4bb8a87c0294c397ce0a08?s=128&d=identicon&r=PG&f=1", "display_name": "Jakxna360", "link": "https://stackoverflow.com/users/1441143/jakxna360"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 551, "favorite_count": 0, "accepted_answer_id": 39482943, "answer_count": 1, "score": 1, "last_activity_date": 1473830348, "creation_date": 1473829093, "last_edit_date": 1473830181, "question_id": 39482759, "link": "https://stackoverflow.com/questions/39482759/undefined-method-update-for-nilnilclass-friendly-id-and-scaffolded-controlle", "title": "undefined method `update&#39; for nil:NilClass. Friendly_id and Scaffolded controller", "body": "<p>I am getting this error saying undefined method update. The show and Edit buttons work well. It's just the update that isn't working. I am using friendly_id and the controller is scaffolded with better routing.</p>\n\n<p>Here is my routes:</p>\n\n<pre><code>Rails.application.routes.draw do\n\n  resources :static_pages, except: [:show, :edit]\n\n  devise_for :users\n\n  mount Bootsy::Engine =&gt; '/bootsy', as: 'bootsy'\n\n  get 'profile' =&gt; \"users#profile\"\n\n  root 'indexes#index'\n\n  get ':slug', to: 'static_pages#show'\n\n  get ':slug/edit', to: 'static_pages#edit'\n\n  # The priority is based upon order of creation: first created -&gt; highest priority.\n  # See how all your routes lay out with \"rake routes\".\n\n  # You can have the root of your site routed with \"root\"\n  # root 'welcome#index'\n\n  # Example of regular route:\n  #   get 'products/:id' =&gt; 'catalog#view'\n\n  # Example of named route that can be invoked with purchase_url(id: product.id)\n  #   get 'products/:id/purchase' =&gt; 'catalog#purchase', as: :purchase\n\n  # Example resource route (maps HTTP verbs to controller actions automatically):\n  #   resources :products\n\n  # Example resource route with options:\n  #   resources :products do\n  #     member do\n  #       get 'short'\n  #       post 'toggle'\n  #     end\n  #\n  #     collection do\n  #       get 'sold'\n  #     end\n  #   end\n\n  # Example resource route with sub-resources:\n  #   resources :products do\n  #     resources :comments, :sales\n  #     resource :seller\n  #   end\n\n  # Example resource route with more complex sub-resources:\n  #   resources :products do\n  #     resources :comments\n  #     resources :sales do\n  #       get 'recent', on: :collection\n  #     end\n  #   end\n\n  # Example resource route with concerns:\n  #   concern :toggleable do\n  #     post 'toggle'\n  #   end\n  #   resources :posts, concerns: :toggleable\n  #   resources :photos, concerns: :toggleable\n\n  # Example resource route within a namespace:\n  #   namespace :admin do\n  #     # Directs /admin/products/* to Admin::ProductsController\n  #     # (app/controllers/admin/products_controller.rb)\n  #     resources :products\n  #   end\nend\n</code></pre>\n\n<p>Here is the static page controller for the update method:</p>\n\n<pre><code>class StaticPagesController &lt; ApplicationController\n  before_action :set_static_page, only: [:show, :edit, :update]\n  before_action :static_page_params, only: [:update, :create]\n  before_action :destroy_static_page, only: :destroy\n  before_filter :except =&gt; [:show] do \n    redirect_to :new_user_session unless current_user &amp;&amp; current_user.role == 5\n  end\n\n  # GET /static_pages\n  # GET /static_pages.json\n  def index\n    @static_pages = StaticPage.all\n  end\n\n  # GET /static_pages/1\n  # GET /static_pages/1.json\n  def show\n  end\n\n  # GET /static_pages/new\n  def new\n    @static_page = StaticPage.new\n  end\n\n  # GET /static_pages/1/edit\n  def edit\n  end\n\n  # POST /static_pages\n  # POST /static_pages.json\n  def create\n    @static_page = StaticPage.new(static_page_params)\n\n    respond_to do |format|\n      if @static_page.save\n        format.html { redirect_to @static_page, notice: 'Static page was successfully created.' }\n        format.json { render :show, status: :created, location: @static_page }\n      else\n        format.html { render :new }\n        format.json { render json: @static_page.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # PATCH/PUT /static_pages/1\n  # PATCH/PUT /static_pages/1.json\n  def update\n    respond_to do |format|\n      if @static_page.update(static_page_params)\n        format.html { redirect_to @static_page, notice: 'Static page was successfully updated.' }\n        format.json { render :show, status: :ok, location: @static_page }\n      else\n        format.html { render :edit }\n        format.json { render json: @static_page.errors, status: :unprocessable_entity }\n      end\n    end\n  end\n\n  # DELETE /static_pages/1\n  # DELETE /static_pages/1.json\n  def destroy\n    @static_page.destroy\n    respond_to do |format|\n      format.html { redirect_to static_pages_url, notice: 'Static page was successfully destroyed.' }\n      format.json { head :no_content }\n    end\n  end\n\n  private\n    # Use callbacks to share common setup or constraints between actions.\n    def set_static_page\n      @static_page = StaticPage.find_by_slug(params[:slug])\n    end\n\n    def destroy_static_page\n      @static_page = StaticPage.find_by_slug(params[:slug])\n    end\n\n    # Never trust parameters from the scary internet, only allow the white list through.\n    def static_page_params\n      params.require(:static_page).permit(:title, :video_id, :content, :tags, :author, :date, :slug)\n    end\nend\n</code></pre>\n\n<p>Here are the views that have been scaffolded for the edit page:</p>\n\n<pre><code>%h1 Editing static_page\n\n= render 'form'\n\n= link_to 'Show', @static_page\n\\|\n= link_to 'Back', static_pages_path\n</code></pre>\n\n<p>Edit: It has to do with my routes. I can't get the show button to work on the fourm bellow. I try @static_page.slug but that takes me to /page_name/page_name. When I just do @static_page it takes me to /static_page/page_name. What I need it to do is take me to /page_name.</p>\n\n<p>Edit 2: Here is the form partial:</p>\n\n<pre><code>= simple_form_for(@static_page) do |f|\n  = f.error_notification\n\n  .form-inputs\n    = f.input :title\n    = f.input :video_id\n    .bootsy_text_area\n      = f.bootsy_area :content, :class =&gt; 'form-control', rows: 12\n    = f.input :tags\n    = f.input :author\n    = f.input :date\n\n  .form-actions\n    = f.button :submit\n</code></pre>\n"}, {"tags": ["javascript", "jquery", "ruby", "ajax"], "comments": [{"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 1, "creation_date": 1473826870, "post_id": 39482369, "comment_id": 66283577, "body": "Hint: Study some beginning ajax tutorials and try to find one where the syntax <code>&lt;%= post.votes.count %&gt;</code> is introduced."}, {"owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "reply_to_user": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 0, "creation_date": 1473827135, "post_id": 39482369, "comment_id": 66283655, "body": "<code>remote: true</code> is a Rails convenience thing that does Ajax for you. Sinatra does not have anything comparable. You are mostly doing okay, with minor errors (some of them conceptual). <code>500</code> means error in your server code - and you didn&#39;t post your Sinatra routes, so we can&#39;t say anything about them. As @7stud says, your <code>$(this).html</code> should likely pass something that was in Ajax response, and not something pre-rendered (or even worse, unrendered)."}, {"owner": {"reputation": 41846, "user_id": 926143, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/3396173c3d22988be1a0732d184902aa?s=128&d=identicon&r=PG", "display_name": "7stud", "link": "https://stackoverflow.com/users/926143/7stud"}, "edited": false, "score": 0, "creation_date": 1473827627, "post_id": 39482369, "comment_id": 66283762, "body": "<i>Can I accomplish this without having a form for each button?</i> Yes.  A button doesn&#39;t need a form to exist on an html page.  And a button can be clicked without there being a form on the page.  But, you have to be able to use code to identify which button was clicked, e.g. checking its id, so that you can tell the server what to do in your ajax request."}], "answers": [{"comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1473843169, "post_id": 39483456, "comment_id": 66290659, "body": "He&#39;s not using rails, so <code>like_post_path</code> won&#39;t be accessible. As well as <code>remote: true</code>"}, {"owner": {"reputation": 9, "user_id": 5944996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e4c1bed1715188f3b8bb229944f4a6?s=128&d=identicon&r=PG&f=1", "display_name": "Bhumi", "link": "https://stackoverflow.com/users/5944996/bhumi"}, "reply_to_user": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1473847668, "post_id": 39483456, "comment_id": 66293440, "body": "oh sorry, i dint see"}], "tags": [], "owner": {"reputation": 9, "user_id": 5944996, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c4e4c1bed1715188f3b8bb229944f4a6?s=128&d=identicon&r=PG&f=1", "display_name": "Bhumi", "link": "https://stackoverflow.com/users/5944996/bhumi"}, "is_accepted": false, "score": -1, "last_activity_date": 1473832962, "creation_date": 1473832962, "answer_id": 39483456, "question_id": 39482369, "link": "https://stackoverflow.com/questions/39482369/using-ajax-with-ruby/39483456#39483456", "title": "Using Ajax with Ruby", "body": "<p>I had worked on same thing, its easy if u ajax call like this</p>\n\n<pre><code>&lt;%= link_to image_tag(likepic), like_post_path(post,status: true),  class: 'vote', method: :put, remote: true %&gt; \n</code></pre>\n\n<p>like_user_path goes to \"like\" method in post controller and posts status:true means \"liked\"</p>\n\n<p>hope it works, because it worked for me</p>\n\n<p>and the model is</p>\n\n<pre><code>class Like &lt; ActiveRecord::Base\n  belongs_to :user\n  belongs_to :post\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": false, "score": 0, "last_activity_date": 1473843279, "creation_date": 1473843279, "answer_id": 39486311, "question_id": 39482369, "link": "https://stackoverflow.com/questions/39482369/using-ajax-with-ruby/39486311#39486311", "title": "Using Ajax with Ruby", "body": "<p>I think the error is here:</p>\n\n<pre><code>validates :post, uniqueness: { scope: :user }\n</code></pre>\n\n<p>and here</p>\n\n<pre><code>$.ajax({\n    url: '/votes',\n    method: 'post',\n    success: function() {\n      console.log('vote up');\n      $(this).html(\"&lt;%= post.votes.count %&gt;\");\n    }\n  })\n</code></pre>\n\n<p>Your vote requires a post id, but you don't send one in your ajax request.</p>\n"}], "owner": {"reputation": 119, "user_id": 1795856, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/8582282497f1d4ff326b49d54cd36a64?s=128&d=identicon&r=PG", "display_name": "lockykeaney", "link": "https://stackoverflow.com/users/1795856/lockykeaney"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 47, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1473843279, "creation_date": 1473826369, "last_edit_date": 1473842845, "question_id": 39482369, "link": "https://stackoverflow.com/questions/39482369/using-ajax-with-ruby", "title": "Using Ajax with Ruby", "body": "<p>I am trying to get back into Ruby, and creating a simple vote up and down system (like reddit).</p>\n\n<p>I can get the votes to work, but the page reloads each time. I am trying to implement an ajax call to change the values dynamically, but the only guides I can find are for Rails. I am just using Ruby with a Sinatra server.</p>\n\n<p>the html.erb</p>\n\n<pre><code>&lt;form action=\"/votes\" method=\"post\"&gt;\n    &lt;input type=\"hidden\" name=\"post_id\" value=\"&lt;%= post.id %&gt;\"&gt;\n    &lt;button id=\"thumb-up\"&gt;&lt;img src=\"/images/thumbs-up.gif\" /&gt;&lt;/button&gt;\n  &lt;/form&gt;\n    &lt;p&gt; &lt;%= post.votes.count %&gt; &lt;/p&gt;\n  &lt;form action=\"/votes\" method=\"post\"&gt;\n    &lt;input type=\"hidden\" name=\"_method\" value=\"delete\"&gt;\n    &lt;input type=\"hidden\" name=\"post_id\" value=\"&lt;%= post.id %&gt;\"&gt;\n    &lt;button id=\"thumb-down\"&gt;&lt;img src=\"/images/thumbs-down.gif\" /&gt;&lt;/button&gt;\n  &lt;/form&gt;\n</code></pre>\n\n<p>jquery</p>\n\n<pre><code>$('#thumb-up').on('click', function(e) {\n  e.preventDefault();\n\n$.ajax({\n    url: '/votes',\n    method: 'post',\n    success: function() {\n      console.log('vote up');\n      $(this).html(\"&lt;%= post.votes.count %&gt;\");\n    }\n  })\n});\n</code></pre>\n\n<p>and the model</p>\n\n<pre><code>class Vote &lt; ActiveRecord::Base\n  belongs_to :user\n  belongs_to :post\n\n  validates :post, uniqueness: { scope: :user }\n  validates :user, uniqueness: { scope: :post }\n\nend\n</code></pre>\n\n<p>The routes (sorry, added later)</p>\n\n<pre><code>post '/votes' do\n  if logged_in?\n    vote = Vote.new\n    vote.user_id = current_user.id\n    vote.post_id = params[:post_id]\n    vote.save\n    redirect to '/'\n  else\n    redirect to '/session/new'\n  end\nend\n\ndelete '/votes' do\n  if logged_in?\n    votes = Vote.where(user_id: current_user.id, post_id: params[:post_id])\n\n    votes.each do |vote|\n      vote.delete\n    end\n    redirect to '/'\n  else\n    redirect to '/session/new'\n  end\nend\n</code></pre>\n\n<p>Now I'm guessing this is a super simple thing, and I know that remote: true has something to do with it. </p>\n\n<p>At the moment I get a 500 error with the thumb-up button, but not with the thumb-down, which has <code>url: 'delete'</code> instead of post.</p>\n\n<p>Can I accomplish this without having a form for each button?</p>\n"}, {"tags": ["ruby-on-rails", "json", "ruby", "ruby-on-rails-3", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 2673, "user_id": 4172728, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/FQpL7.jpg?s=128&g=1", "display_name": "Gokul", "link": "https://stackoverflow.com/users/4172728/gokul"}, "edited": false, "score": 2, "creation_date": 1473826271, "post_id": 39482208, "comment_id": 66283450, "body": "You code will work and its correct."}, {"owner": {"reputation": 2673, "user_id": 4172728, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/FQpL7.jpg?s=128&g=1", "display_name": "Gokul", "link": "https://stackoverflow.com/users/4172728/gokul"}, "edited": false, "score": 0, "creation_date": 1473826525, "post_id": 39482208, "comment_id": 66283501, "body": "Is this typo? <code>&quot;#{custome_key}&quot;: 1,</code> it should be as <code>&quot;#{custom_key}&quot;: 1,</code>."}, {"owner": {"reputation": 1289, "user_id": 6583381, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IoEUj.jpg?s=128&g=1", "display_name": "oj5th", "link": "https://stackoverflow.com/users/6583381/oj5th"}, "reply_to_user": {"reputation": 2673, "user_id": 4172728, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/FQpL7.jpg?s=128&g=1", "display_name": "Gokul", "link": "https://stackoverflow.com/users/4172728/gokul"}, "edited": false, "score": 0, "creation_date": 1473829887, "post_id": 39482208, "comment_id": 66284341, "body": "Hi @GokulM, thanks for pointing the typo. But it is not what I meant. When I run the method it throws an error <code>syntax error, unexpected &#39;:&#39;, expecting =&gt;       &quot;#{custome_key}&quot;: 1,</code> because it should not be constructed like that. The question is, can I do a parameterized key naming? :)"}], "answers": [{"comments": [{"owner": {"reputation": 1289, "user_id": 6583381, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IoEUj.jpg?s=128&g=1", "display_name": "oj5th", "link": "https://stackoverflow.com/users/6583381/oj5th"}, "edited": false, "score": 0, "creation_date": 1473839261, "post_id": 39483164, "comment_id": 66288416, "body": "Thanks! This is right but I have to chose the answer to accept. So I will just vote up your answer."}], "tags": [], "owner": {"reputation": 1344, "user_id": 3849063, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003547133097/picture?type=large", "display_name": "Vladimir Chervanev", "link": "https://stackoverflow.com/users/3849063/vladimir-chervanev"}, "is_accepted": false, "score": 1, "last_activity_date": 1473831630, "creation_date": 1473831630, "answer_id": 39483164, "question_id": 39482208, "link": "https://stackoverflow.com/questions/39482208/parameterized-json-key-naming/39483164#39483164", "title": "Parameterized JSON key naming", "body": "<p>You can use \":\" to separate symbolic keys and values, use \"=>\" in your example:</p>\n\n<pre><code>def jsonize(custom_key=\"id\")\n{\n    my_json: {\n      \"#{custom_key}\" =&gt; 1,\n      name: \"John\"\n    }\n  }\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "is_accepted": true, "score": 0, "last_activity_date": 1473833723, "creation_date": 1473833723, "answer_id": 39483620, "question_id": 39482208, "link": "https://stackoverflow.com/questions/39482208/parameterized-json-key-naming/39483620#39483620", "title": "Parameterized JSON key naming", "body": "<p>You can just convert it to <code>symbol</code> and use <code>hash_rocket</code> syntax you will get the expected result</p>\n\n<pre><code>def jsonize(custom_key = \"id\")\n  {\n    my_json: {\n      custom_key.to_sym =&gt; 1,\n      name: \"John\"\n    }\n  }\nend\n\n#=&gt; jsonize('foo')\n#=&gt; {\n#=&gt;     :my_json =&gt; {\n#=&gt;          :foo =&gt; 1,\n#=&gt;         :name =&gt; \"John\"\n#=&gt;     }\n#=&gt; }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 167912, "user_id": 240443, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/495d675e3bc42ed1dee469e2ce701f1b?s=128&d=identicon&r=PG", "display_name": "Amadan", "link": "https://stackoverflow.com/users/240443/amadan"}, "is_accepted": false, "score": 1, "last_activity_date": 1473837569, "last_edit_date": 1473837569, "creation_date": 1473836876, "answer_id": 39484405, "question_id": 39482208, "link": "https://stackoverflow.com/questions/39482208/parameterized-json-key-naming/39484405#39484405", "title": "Parameterized JSON key naming", "body": "<p>The hash-rocket syntax has been in Ruby since ancient times:</p>\n\n<pre><code>{ :foo =&gt; 1, \"bar\" =&gt; 2 }\n</code></pre>\n\n<p>Ruby 1.9 (I think) introduced a new colon shortcut syntax just for symbols (while keeping the hash-rocket general for any key type):</p>\n\n<pre><code>{ foo: 1, \"bar\" =&gt; 2 }\n</code></pre>\n\n<p>Ruby 2.2 (I think) introduced the possibility of symbolizing a string in this syntax:</p>\n\n<pre><code>{ \"foo\": 1, \"bar\" =&gt; 2 }\n</code></pre>\n\n<p>All of these do the same thing. What you are doing is perfectly grammatical Ruby code -- in a sufficiently new Ruby. In older Rubies, you will need to use the old reliable hash-rocket syntax:</p>\n\n<pre><code>{ \"foo\".to_sym =&gt; 1, \"bar\" =&gt; 2 }\n</code></pre>\n\n<p>Now that you actually have a string, you can do normal interpolation:</p>\n\n<pre><code>{ \"f#{'o' * 2}\".to_sym =&gt; 1, \"bar\" =&gt; 2 }\n</code></pre>\n\n<p>In your case, you <em>could</em> write</p>\n\n<pre><code>{ \"#{custom_key}\".to_sym =&gt; 1 }\n</code></pre>\n\n<p><em>However,</em> all of this is completely unnecessary, since you can just write simply this, in <em>any</em> Ruby:</p>\n\n<pre><code>{ custom_key.to_sym =&gt; 1 }\n</code></pre>\n\n<p>Even better, since you're just turning everything into JSON immediately after, you don't even need symbolised keys; so these two expressions will have identical results:</p>\n\n<pre><code>{ custom_key.to_sym =&gt; 1 }.to_json\n{ custom_key =&gt; 1 }.to_json\n</code></pre>\n\n<p>(Also note that what you state as examples of JSON -- both input and output -- are, in fact, <em>not JSON</em>, nor would <code>.to_json</code> output such. In JSON, as opposed to plain JavaScript object literal, keys <em>must</em> be double-quoted, and that is how <code>to_json</code> would produce it. Your input is a Ruby valid Ruby hash, though.)</p>\n"}], "owner": {"reputation": 1289, "user_id": 6583381, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/IoEUj.jpg?s=128&g=1", "display_name": "oj5th", "link": "https://stackoverflow.com/users/6583381/oj5th"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "accepted_answer_id": 39483620, "answer_count": 3, "score": 2, "last_activity_date": 1473838769, "creation_date": 1473824938, "last_edit_date": 1473838769, "question_id": 39482208, "link": "https://stackoverflow.com/questions/39482208/parameterized-json-key-naming", "title": "Parameterized JSON key naming", "body": "<p>I have the following JSON:</p>\n\n<pre><code>{\n  my_json: {\n    id: 1,\n    name: \"John\"\n  }\n}\n</code></pre>\n\n<p>How can I customize key name via parameterized like:</p>\n\n<pre><code>def jsonize(custom_key=\"id\")\n{\n    my_json: {\n      \"#{custom_key}\": 1,\n      name: \"John\"\n    }\n  }\nend\n</code></pre>\n\n<p>To be output with:</p>\n\n<p>Scenario 1:</p>\n\n<pre><code>=&gt; jsonize\n</code></pre>\n\n<p>OUTPUT:</p>\n\n<pre><code>{\n  my_json: {\n    id: 1,\n    name: \"John\"\n  }\n}\n</code></pre>\n\n<p>Scenario 2:</p>\n\n<pre><code>=&gt; jsonize(\"value\")\n</code></pre>\n\n<p>OUTPUT:</p>\n\n<pre><code>{\n  my_json: {\n    value: 1,\n    name: \"John\"\n  }\n}\n</code></pre>\n"}, {"tags": ["ruby", "watir"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6828754"}, "edited": false, "score": 0, "creation_date": 1473823398, "post_id": 39481417, "comment_id": 66282844, "body": "Yeah, I use watir instead of watir-webdriver because firefox doesn&#39;t want to cooperate with me. Btw, I think this is what I&#39;ve been looking for, but haven&#39;t yet had a chance to test it out. Thanks!"}, {"owner": {"reputation": 1113, "user_id": 1250190, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/42209a6704f712d1eadbc28a4f024c9e?s=128&d=identicon&r=PG", "display_name": "pjd", "link": "https://stackoverflow.com/users/1250190/pjd"}, "edited": false, "score": 0, "creation_date": 1473859897, "post_id": 39481417, "comment_id": 66301020, "body": "Yes, from Firefox 48 onward you won&#39;t be able to use <code>watir-webdriver</code>. See <a href=\"http://stackoverflow.com/questions/39185507/watir-webdriver-doesnt-do-anything-after-opening-browser-firefox/39185569#39185569\" title=\"watir webdriver doesnt do anything after opening browser firefox\">stackoverflow.com/questions/39185507/&hellip;</a>. I hope my method works for you!"}, {"owner": {"reputation": 3480, "user_id": 4072371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/112e615d8c60908294e30848d9556186?s=128&d=identicon&r=PG", "display_name": "titusfortner", "link": "https://stackoverflow.com/users/4072371/titusfortner"}, "edited": false, "score": 0, "creation_date": 1473869276, "post_id": 39481417, "comment_id": 66307565, "body": "48+ requires geckodriver. You can use it with <code>watir-webdriver</code> by setting <code>marionette: true</code> on initialization. Or you can use it with <code>watir</code> &gt; v6.0 where it is set to true by default."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6828754"}, "edited": false, "score": 0, "creation_date": 1473905690, "post_id": 39481417, "comment_id": 66321747, "body": "One little problem though. It seems like the until block doesn&#39;t want to execute what I actually have written in it. It just doesn&#39;t do anything."}, {"owner": {"reputation": 1113, "user_id": 1250190, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/42209a6704f712d1eadbc28a4f024c9e?s=128&d=identicon&r=PG", "display_name": "pjd", "link": "https://stackoverflow.com/users/1250190/pjd"}, "edited": false, "score": 0, "creation_date": 1473906030, "post_id": 39481417, "comment_id": 66321803, "body": "You&#39;re saying the page doesn&#39;t reload every five seconds? Maybe add in a <code>puts</code> statement for debugging to see that something is actually happening?"}], "tags": [], "owner": {"reputation": 1113, "user_id": 1250190, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/42209a6704f712d1eadbc28a4f024c9e?s=128&d=identicon&r=PG", "display_name": "pjd", "link": "https://stackoverflow.com/users/1250190/pjd"}, "is_accepted": false, "score": 1, "last_activity_date": 1473818799, "last_edit_date": 1473818799, "creation_date": 1473818367, "answer_id": 39481417, "question_id": 39481032, "link": "https://stackoverflow.com/questions/39481032/watir-trouble-with-if-statements/39481417#39481417", "title": "Watir: Trouble with if statements", "body": "<p>I'm not completely sure I understand the question, so let me know if this isn't what you are asking for:</p>\n\n<pre><code>def Replies()\n  until $browser.div(:text =&gt; ':HexBot/Summon').present?\n    sleep(5)\n    $browser.goto &lt;insert link here&gt;\n  end\n  $browser.div(:text =&gt; ':HexBot/Summon').click\nend\n</code></pre>\n\n<p>That should reload the page every 5 seconds (forever) until the desired text appears, at which point the text will be clicked. You could also use <code>$browser.refresh</code> instead of the <code>$browser.goto</code> statement (assuming you start on the correct page).</p>\n\n<p>Lastly, you tagged this question <code>watir</code>. I use <code>watir-webdriver</code>, and there are some differences, but hopefully what I have offered here works for you.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6828754"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1473869099, "creation_date": 1473814862, "last_edit_date": 1473869099, "question_id": 39481032, "link": "https://stackoverflow.com/questions/39481032/watir-trouble-with-if-statements", "title": "Watir: Trouble with if statements", "body": "<p>I spent a while looking but didn't find anything that helped much, so I decided to ask myself.</p>\n\n<p>Anyways, I'm trying to make a <strong>non-malicious</strong> bot to respond to certain forum threads on a forum. However, I'm stuck on making an if statement that will detect if a thread has a certain name, and click on that thread if it does. This is what the closest I've come:</p>\n\n<pre><code>def Replies()\n  while true\n    $browser.div(:text =&gt; ':HexBot/Summon')\n    sleep(5)\n    $browser.goto &lt;insert link here. i didn't include it for privacy reasons&gt;\n  end\nend\n</code></pre>\n\n<p>What this <em>should</em> do is refresh the page every 5 seconds. If it sees a thread saying ':HexBot/Summon' then it would click on that thread. However. I just get an error. I tried doing this entirely without if statements, but that also gave me an error.</p>\n"}, {"tags": ["ruby", "puppet"], "comments": [{"owner": {"reputation": 12661, "user_id": 5343387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/15a14cec3014822297a08ed6dfae2563?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Schuchard", "link": "https://stackoverflow.com/users/5343387/matt-schuchard"}, "edited": false, "score": 1, "creation_date": 1473811923, "post_id": 39480662, "comment_id": 66280422, "body": "This isn&#39;t the way to do this. You want to associate a provider with a type and then you can use the attributes assigned to its parameters as variables in your provider."}, {"owner": {"reputation": 26880, "user_id": 53771, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/XQaPS.jpg?s=128&g=1", "display_name": "Spence", "link": "https://stackoverflow.com/users/53771/spence"}, "reply_to_user": {"reputation": 12661, "user_id": 5343387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/15a14cec3014822297a08ed6dfae2563?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Schuchard", "link": "https://stackoverflow.com/users/5343387/matt-schuchard"}, "edited": false, "score": 0, "creation_date": 1473812287, "post_id": 39480662, "comment_id": 66280504, "body": "the issue is I have about 20 types that are all applicable to this resource.  They need the username and password to query the resource, so I was trying to see if I could avoid copy pasting the username, password and ip address into every type, particularly if they will all be called in a context where it&#39;s available"}, {"owner": {"reputation": 12661, "user_id": 5343387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/15a14cec3014822297a08ed6dfae2563?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Schuchard", "link": "https://stackoverflow.com/users/5343387/matt-schuchard"}, "edited": false, "score": 0, "creation_date": 1473815833, "post_id": 39480662, "comment_id": 66281287, "body": "Twenty types that all require a username and password sounds kind of suspicious, but you should be able to do some ruby tricks in the types source code to make the username and password reusable from a base type."}, {"owner": {"reputation": 26880, "user_id": 53771, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/XQaPS.jpg?s=128&g=1", "display_name": "Spence", "link": "https://stackoverflow.com/users/53771/spence"}, "reply_to_user": {"reputation": 12661, "user_id": 5343387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/15a14cec3014822297a08ed6dfae2563?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Schuchard", "link": "https://stackoverflow.com/users/5343387/matt-schuchard"}, "edited": false, "score": 0, "creation_date": 1473825538, "post_id": 39480662, "comment_id": 66283287, "body": "puppet doco was pretty clear that you can&#39;t have types derive from a base type.  FYI it&#39;s a rest interface with a large number of grouped settings.  So it&#39;s the same credentials to the server but each group of settings will be separate.  Just before I used brute force and added them manually to every setting I was just trying to check if it was possible to get to the in scope parameters."}, {"owner": {"reputation": 12661, "user_id": 5343387, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/15a14cec3014822297a08ed6dfae2563?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Schuchard", "link": "https://stackoverflow.com/users/5343387/matt-schuchard"}, "edited": false, "score": 0, "creation_date": 1473856881, "post_id": 39480662, "comment_id": 66298926, "body": "Oh right, I was thinking base providers and base properties."}], "answers": [{"tags": [], "owner": {"reputation": 7902, "user_id": 3356612, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/085070b2074edcce07bc4381c7b5d635?s=128&d=identicon&r=PG", "display_name": "Felix Frank", "link": "https://stackoverflow.com/users/3356612/felix-frank"}, "is_accepted": false, "score": 0, "last_activity_date": 1474847680, "creation_date": 1474847680, "answer_id": 39692971, "question_id": 39480662, "link": "https://stackoverflow.com/questions/39480662/access-puppet-module-variables-from-custom-provider/39692971#39692971", "title": "Access Puppet Module variables from custom provider", "body": "<p>The variables are only meaningful in the context of evaluating the manifest code and creating a catalog. They don't become <em>part</em> of the catalog. This is why your type/provider code cannot work with them directly.</p>\n\n<p>To avoid passing redundant info to lots of resources that share it, you can use some \"clever\" tricks. In <a href=\"https://github.com/puppetlabs/puppet/pull/3953/files\" rel=\"nofollow\">a patch</a> I wrote some time ago, I added this kind of meta-information to Puppet's <code>resources</code> type. You cannot do this in a module, but you <em>can</em> add your own meta-type to carry such hints.</p>\n"}], "owner": {"reputation": 26880, "user_id": 53771, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/XQaPS.jpg?s=128&g=1", "display_name": "Spence", "link": "https://stackoverflow.com/users/53771/spence"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 415, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474847680, "creation_date": 1473811572, "last_edit_date": 1473812446, "question_id": 39480662, "link": "https://stackoverflow.com/questions/39480662/access-puppet-module-variables-from-custom-provider", "title": "Access Puppet Module variables from custom provider", "body": "<p>I'm writing a custom provider and I'm only going to use it in the context of the module it's attached to.  The module will already define things for the resource which I need to act on (e.g. username, password, IP Address).  What I'm trying to do is access a variable in scope in the puppet manifest from the custom provider.</p>\n\n<p>Is this possible?</p>\n\n<p>init.pp:</p>\n\n<pre><code>class mymodule(\n   $username  = 'admin',\n   --  snip --\n}\n</code></pre>\n\n<p>provider.rb:</p>\n\n<pre><code>class Puppet::Provider::MyProvider &lt; Puppet::Provider\n   def self.configure\n      #can I get to $mymodule::username here?\n</code></pre>\n\n<p>Some context:</p>\n\n<p>I'm writing a set of types that will configure a server via an API.  I want to have a type like:</p>\n\n<pre><code>mymodule_mail_settings { 'current':\n    server =&gt; 'mail.server.com'\n    mailuser =&gt; 'mail'\n}\n</code></pre>\n\n<p>What I'm trying to avoid is having to pass the username/password/ip to access the server's API passed into all of these different types.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "bundle"], "comments": [{"owner": {"reputation": 9572, "user_id": 2305826, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xRwWw.png?s=128&g=1", "display_name": "MarsAtomic", "link": "https://stackoverflow.com/users/2305826/marsatomic"}, "edited": false, "score": 3, "creation_date": 1473810521, "post_id": 39480544, "comment_id": 66280158, "body": "Tell us what gems you&#39;re dealing with and the <i>exact</i> steps you&#39;re using in an attempt to resolve your issue?"}, {"owner": {"reputation": 1323, "user_id": 382008, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09db29608de5326685e20cb2e864351a?s=128&d=identicon&r=PG", "display_name": "raskhadafi", "link": "https://stackoverflow.com/users/382008/raskhadafi"}, "edited": false, "score": 0, "creation_date": 1568898415, "post_id": 39480544, "comment_id": 102427621, "body": "In my case I made an error in a git merge. So bundle update solved it for me."}], "answers": [{"tags": [], "owner": {"reputation": 1717, "user_id": 1034924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecedc78563223e4f7742bbfc66992905?s=128&d=identicon&r=PG", "display_name": "nzajt", "link": "https://stackoverflow.com/users/1034924/nzajt"}, "is_accepted": false, "score": 3, "last_activity_date": 1473813301, "last_edit_date": 1473813301, "creation_date": 1473812913, "answer_id": 39480822, "question_id": 39480544, "link": "https://stackoverflow.com/questions/39480544/your-bundle-requires-gems-that-depend-on-each-other-creating-an-infinite-loop/39480822#39480822", "title": "Your bundle requires gems that depend on each other, creating an infinite loop. Please remove gem", "body": "<p>Your best bet is to remove your Gemfile.lock, then run <code>bundle update</code>.</p>\n\n<p>Why this would work? Sometimes you are forcing old versions of gems to be loaded, and you need the new version of that gem to loaded.</p>\n\n<p>So removing the Gemfile.lock will let bundle download the correct version of the gems.</p>\n\n<p>If that doesn't work, you might be forcing a version of a gem to load, like <code>gem \"paperclip\", \"~&gt; 4.2\"</code> which has a conflict with another gem, this isn't very common but it can happen. You will have to find the gem with the issue and either remove the version, like so <code>gem \"paperclip\"</code> or find the other gem that has the conflict and get the correct version of that gem. If you use git you can go back through your old Gemfile.lock and see what version of the conflicting gems you have and force that version for those gems. Let's hope the removing your Gemfile.lock works. </p>\n"}, {"tags": [], "owner": {"reputation": 65, "user_id": 6466745, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dtEUN.png?s=128&g=1", "display_name": "H.B", "link": "https://stackoverflow.com/users/6466745/h-b"}, "is_accepted": false, "score": 1, "last_activity_date": 1520443054, "last_edit_date": 1520443054, "creation_date": 1520442718, "answer_id": 49157625, "question_id": 39480544, "link": "https://stackoverflow.com/questions/39480544/your-bundle-requires-gems-that-depend-on-each-other-creating-an-infinite-loop/49157625#49157625", "title": "Your bundle requires gems that depend on each other, creating an infinite loop. Please remove gem", "body": "<p>Note: before you continue reading this, you need a copy of your <code>Gemfile.lock</code> file for this to work, in case you deleted it already!</p>\n\n<p>This might be late now but worth giving this a try for people who did the above and still are faced with the same problem.</p>\n\n<p>My solution was:</p>\n\n<ol>\n<li>Use the <code>Gemfile.lock</code> file you have (maybe get that from a previous build) and delete the chunk belongs to one of the gems that are dependent on each other.</li>\n<li>run <code>bundle install</code></li>\n<li>if the above steps didn't work, repeat (steps 1 and 2) but now with deleting the chunk in the <code>Gemfile.lock</code> that belongs to the other gem.</li>\n<li>if the above didn't work completely, then try (step 1) but without deleting anything. Then update both gems by <code>bundle update --source gem_name_here</code>. Now, give the app a run before <code>bundle install</code>, if this didn't work, then try to <code>bundle install</code> before running the app.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 12465599, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h4ibg.jpg?s=128&g=1", "display_name": "Kenney G", "link": "https://stackoverflow.com/users/12465599/kenney-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1584134453, "creation_date": 1584134453, "answer_id": 60677361, "question_id": 39480544, "link": "https://stackoverflow.com/questions/39480544/your-bundle-requires-gems-that-depend-on-each-other-creating-an-infinite-loop/60677361#60677361", "title": "Your bundle requires gems that depend on each other, creating an infinite loop. Please remove gem", "body": "<p>For anyone else looking for the answer to this issue, open your Gemfile in a text editor and ensure that you don't:</p>\n\n<p>A) Have the same gem listed twice or</p>\n\n<p>B) Have multiple sources listed for a gem.</p>\n\n<p>In my case, the Gemfile had not been updated since the gem was added to rubygems.org, and so was attempting to pull the gem from both rubygems and the listed git source. Deleting the git source solved the issue.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6826287"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1387, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1584134453, "creation_date": 1473810429, "last_edit_date": 1473812779, "question_id": 39480544, "link": "https://stackoverflow.com/questions/39480544/your-bundle-requires-gems-that-depend-on-each-other-creating-an-infinite-loop", "title": "Your bundle requires gems that depend on each other, creating an infinite loop. Please remove gem", "body": "<p>I'm upgrading some gems. When I calll <code>bundle</code> I have this:</p>\n\n<pre><code>Your bundle requires gems that depend on each other, creating an \ninfinite loop. Please remove gem 'abc' and try again.\n</code></pre>\n\n<p>I've removed but this error persists.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1473810853, "post_id": 39480512, "comment_id": 66280225, "body": "What does &quot;<code>I tried Regexp.escape but it did not output the correct one.</code>&quot; mean? We have no idea what you tried, but <code>escape</code> will do what you tell it to. <code>Regexp.union</code> is also very useful for what you&#39;re trying to do. Read &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;. We need more information to be able to help you."}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1473811108, "post_id": 39480512, "comment_id": 66280274, "body": "What makes you think that <code>Regexp.escape</code> is doubling the backslashes? Keep in mind that <code>&quot;\\\\&quot;&#39;</code> is one backslash, not two. If you <code>puts Regexp.escape(str)</code> I think you&#39;ll find that you&#39;re getting a properly escaped string."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1473811328, "post_id": 39480512, "comment_id": 66280314, "body": "It&#39;s properly escaped except the &quot;or&quot; are being escaped too."}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1473813548, "post_id": 39480630, "comment_id": 66280771, "body": "Sn-man, I meant to post that on the question. I&#39;m not sure your answer was up when I started. In any event, good answer."}, {"owner": {"reputation": 1161, "user_id": 1520956, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e1de66cb040b2256a6de3625fb4735ba?s=128&d=identicon&r=PG&f=1", "display_name": "rukia_kuchiki_21", "link": "https://stackoverflow.com/users/1520956/rukia-kuchiki-21"}, "edited": false, "score": 0, "creation_date": 1473814453, "post_id": 39480630, "comment_id": 66281011, "body": "Thanks a lot. I&#39;m amazed with <code>union</code> then. This is new to me."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 1, "creation_date": 1473814619, "post_id": 39480630, "comment_id": 66281048, "body": "If you think <code>union</code> is interesting then you should look at Perl&#39;s <a href=\"http://search.cpan.org/~rsavage/Regexp-Assemble-0.37/lib/Regexp/Assemble.pm\" rel=\"nofollow noreferrer\">Regexp::Assemble</a>. THAT is interesting."}], "tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": true, "score": 1, "last_activity_date": 1473811232, "creation_date": 1473811232, "answer_id": 39480630, "question_id": 39480512, "link": "https://stackoverflow.com/questions/39480512/regexp-escape-is-not-escaping-substring-separated-by/39480630#39480630", "title": "Regexp escape is not escaping substring separated by |", "body": "<p>It's not possible to tell what you're doing from the little you told us, but it sounds like you're not using <code>Regexp.escape</code> correctly.</p>\n\n<p>Meditate on this:</p>\n\n<pre><code>str = \"bookworms|actuarial-consultants|uninterruptible-power-supply-(ups)-experts|c++programming-developers\"\nRegexp.escape(str) \n# =&gt; \"bookworms\\\\|actuarial\\\\-consultants\\\\|uninterruptible\\\\-power\\\\-supply\\\\-\\\\(ups\\\\)\\\\-experts\\\\|c\\\\+\\\\+programming\\\\-developers\"\n</code></pre>\n\n<p>Notice that the \"OR\" (<code>|</code>) are being escaped which isn't desirable. </p>\n\n<p>If you pass an array of the strings, then <code>union</code> will escape when necessary and concatenate each resulting escaped pattern into one large pattern:</p>\n\n<pre><code>Regexp.union(str.split('|')) \n# =&gt; /bookworms|actuarial\\-consultants|uninterruptible\\-power\\-supply\\-\\(ups\\)\\-experts|c\\+\\+programming\\-developers/\n</code></pre>\n\n<p>Using that in code:</p>\n\n<pre><code>regex = Regexp.union(str.split('|')) # =&gt; /bookworms|actuarial\\-consultants|uninterruptible\\-power\\-supply\\-\\(ups\\)\\-experts|c\\+\\+programming\\-developers/\n\n'uninterruptible-power-supply-(ups)-experts'[regex] # =&gt; \"uninterruptible-power-supply-(ups)-experts\"\n'c++programming-developers'[regex] # =&gt; \"c++programming-developers\"\n</code></pre>\n\n<p>shows the patterns are matching.</p>\n\n<p>There are things to watch out for, but that's the basics.</p>\n"}], "owner": {"reputation": 1161, "user_id": 1520956, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/e1de66cb040b2256a6de3625fb4735ba?s=128&d=identicon&r=PG&f=1", "display_name": "rukia_kuchiki_21", "link": "https://stackoverflow.com/users/1520956/rukia-kuchiki-21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 39480630, "answer_count": 1, "score": -1, "last_activity_date": 1473811232, "creation_date": 1473810101, "question_id": 39480512, "link": "https://stackoverflow.com/questions/39480512/regexp-escape-is-not-escaping-substring-separated-by", "title": "Regexp escape is not escaping substring separated by |", "body": "<p>I have a string...</p>\n\n<pre><code>str = \"bookworms|actuarial-consultants|uninterruptible-power-supply-(ups)-experts|c++programming-developers\"\n</code></pre>\n\n<p>with special characters such as parentheses and <code>+</code> symbol.</p>\n\n<p>can't match <code>uninterruptible-power-supply-(ups)-experts</code> and <code>c++programming-developers</code> unless I escape them manually like</p>\n\n<pre><code>bookworms|actuarial-consultants|uninterruptible-power-supply-\\(ups\\)-experts|c\\+\\+programming-developers\n</code></pre>\n\n<p><a href=\"https://gyazo.com/d545ab1a8d7d178a6079f4b9cb125cce\" rel=\"nofollow\">https://gyazo.com/d545ab1a8d7d178a6079f4b9cb125cce</a></p>\n\n<p>My string can accomodate numerous substrings separated by <code>|</code> so I can't escape manually. And because, the string is generated thru a query method.</p>\n\n<p>I tried <code>Regexp.escape</code> but it did not output the correct one. I can't still match <code>uninterruptible-power-supply-(ups)-experts</code> and <code>c++programming-developers</code>, even the normal substring like <code>bookworms</code></p>\n\n<p><a href=\"https://gyazo.com/ae0bb43a1dc84f40deb18e3ed76d490e\" rel=\"nofollow\">https://gyazo.com/ae0bb43a1dc84f40deb18e3ed76d490e</a></p>\n\n<p>the <code>escape</code> method is adding double <code>\\\\</code> to my string.</p>\n\n<pre><code>bookworms\\\\|actuarial\\\\-consultants\\\\|uninterruptible\\\\-power\\\\-supply\\\\-\\\\(ups\\\\)\\\\-experts\\\\|c\\\\+\\\\+programming\\\\-developers\n</code></pre>\n"}, {"tags": ["ruby", "multithreading", "macos", "fork"], "answers": [{"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": true, "score": 1, "last_activity_date": 1473808066, "creation_date": 1473808066, "answer_id": 39480256, "question_id": 39480240, "link": "https://stackoverflow.com/questions/39480240/how-do-get-exit-code-from-rubys-process-fork/39480256#39480256", "title": "How do get exit code from Ruby&#39;s Process.fork()?", "body": "<p>From the manual for <a href=\"https://ruby-doc.org/core-2.1.2/Process.html#method-c-fork\" rel=\"nofollow\"><code>fork</code></a>:</p>\n\n<p>The parent process should use <a href=\"https://ruby-doc.org/core-2.1.2/Process.html#method-c-wait\" rel=\"nofollow\"><code>Process.wait</code></a> to collect the termination statuses of its children or use <code>Process.detach</code> to register disinterest in their status; otherwise, the operating system may accumulate zombie processes.</p>\n\n<p>So in your case:</p>\n\n<pre><code>status = Process.wait(pid)\n</code></pre>\n\n<p>Threads are a completely different thing than a multi-process model. If you're writing parallel code you'll need to determine what your best approach is.</p>\n"}], "owner": {"reputation": 4981, "user_id": 705725, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/3oNDr.jpg?s=128&g=1", "display_name": "dsp_099", "link": "https://stackoverflow.com/users/705725/dsp-099"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 813, "favorite_count": 0, "accepted_answer_id": 39480256, "answer_count": 1, "score": 0, "last_activity_date": 1563808899, "creation_date": 1473807868, "question_id": 39480240, "link": "https://stackoverflow.com/questions/39480240/how-do-get-exit-code-from-rubys-process-fork", "title": "How do get exit code from Ruby&#39;s Process.fork()?", "body": "<p>As it says on the tin</p>\n\n<pre><code>pid = Process.fork do\n  exit 25\nend\n</code></pre>\n\n<p><code>pid</code> seems positively useless besides telling me what actual system process number the fork ran under. Will <code>Thread</code> be more useful?</p>\n"}, {"tags": ["html", "ruby-on-rails", "ruby", "capybara"], "answers": [{"comments": [{"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1473805224, "post_id": 39479649, "comment_id": 66278753, "body": "This won&#39;t work because there is no element with a class of &quot;name_#{user.id}&quot;"}, {"owner": {"reputation": 2210, "user_id": 4811651, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ozvMA.jpg?s=128&g=1", "display_name": "Sean Magyar", "link": "https://stackoverflow.com/users/4811651/sean-magyar"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1473835518, "post_id": 39479649, "comment_id": 66286494, "body": "I know, but you could put it there like <code>td class=&quot;name_&lt;%= user.id %&gt;&quot;</code>, or you could do it without the within as well, if there is just one user instance."}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1473871730, "post_id": 39479649, "comment_id": 66308977, "body": "Adding the user id to the class just makes styling more complicated, if adding to the html it should be a data attribute to the row."}, {"owner": {"reputation": 2210, "user_id": 4811651, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ozvMA.jpg?s=128&g=1", "display_name": "Sean Magyar", "link": "https://stackoverflow.com/users/4811651/sean-magyar"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1473878920, "post_id": 39479649, "comment_id": 66312734, "body": "Why would it make complicated? U could just call it <code>&lt;td class=&quot;name name_&lt;%= user.id %&gt;&quot;&gt;</code>"}, {"owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1473879355, "post_id": 39479649, "comment_id": 66312980, "body": "Great - and then you would have to add another class to the id, email, and username tds too. You&#39;d be adding tons of classnames that are only ever used once (bad code smell).  You&#39;re trying to misuse classes for exactly why data attributes were added to html"}, {"owner": {"reputation": 2210, "user_id": 4811651, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ozvMA.jpg?s=128&g=1", "display_name": "Sean Magyar", "link": "https://stackoverflow.com/users/4811651/sean-magyar"}, "reply_to_user": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "edited": false, "score": 0, "creation_date": 1473884351, "post_id": 39479649, "comment_id": 66315475, "body": "You could also use data attributes. There are countless options."}], "tags": [], "owner": {"reputation": 2210, "user_id": 4811651, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ozvMA.jpg?s=128&g=1", "display_name": "Sean Magyar", "link": "https://stackoverflow.com/users/4811651/sean-magyar"}, "is_accepted": false, "score": 0, "last_activity_date": 1473804095, "creation_date": 1473804095, "answer_id": 39479649, "question_id": 39479485, "link": "https://stackoverflow.com/questions/39479485/finding-a-specific-row-in-a-table-using-capybara/39479649#39479649", "title": "Finding a specific row in a table using capybara", "body": "<p>Why not just do like this?:</p>\n\n<pre><code>feature \"index users\" do\n  let!(:user) { create(:user, name: \"John Smith\") }\n\n  it \"shows users\" do\n    visit users_path\n    within \".name_#{user.id}\" do\n      expect(page).to have_content(\"John Smith\")\n    end\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 42014, "user_id": 2709090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/238c2b7cde2c817fc9a5a2b8eaa2ffad?s=128&d=identicon&r=PG&f=1", "display_name": "Thomas Walpole", "link": "https://stackoverflow.com/users/2709090/thomas-walpole"}, "is_accepted": true, "score": 7, "last_activity_date": 1473805961, "last_edit_date": 1473805961, "creation_date": 1473805182, "answer_id": 39479811, "question_id": 39479485, "link": "https://stackoverflow.com/questions/39479485/finding-a-specific-row-in-a-table-using-capybara/39479811#39479811", "title": "Finding a specific row in a table using capybara", "body": "<p>A nice clean approach would be to add a \"data-user-id\" attribute to each tr element and then find the row you want with <code>tr = find('tr[data-user-id=\"22\"]')</code>, but if that's not an option there are a number of ways to do this.  Either of</p>\n\n<pre><code>td = page.find(:css, 'td.id', text: /^22$/) # find the id td with text of exactly 22\ntr = td.find(:xpath, './parent::tr') # get the parent tr of the td\nexpect(tr).to have_css('td.name', text: 'John Smith')\n</code></pre>\n\n<p>or finding the row using just an xpath like</p>\n\n<pre><code>tr = page.find(:xpath, \".//tr[./td[@class='id'][text()='22']]\")\nexpect(tr).to have_css('td.name', text: 'John Smith')\n</code></pre>\n\n<p>should do what you want.  If you want to stick with the looping approach (not recommended because it will be slow - and the way your loop is structured it could just not verify anything) it would be</p>\n\n<pre><code>page.all('tr').each do |tr|\n  next unless tr.has_css?('td.id', text: /^22$/)\n  expect(tr).to have_css('td.name', text: \"John Smith\")\n  #other expects here...\nend \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2886, "user_id": 344720, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/06dbda6ccadbb1ca30943526c3ef22df?s=128&d=identicon&r=PG", "display_name": "Jon Kern", "link": "https://stackoverflow.com/users/344720/jon-kern"}, "is_accepted": false, "score": 0, "last_activity_date": 1523141239, "last_edit_date": 1523141239, "creation_date": 1523137297, "answer_id": 49712231, "question_id": 39479485, "link": "https://stackoverflow.com/questions/39479485/finding-a-specific-row-in-a-table-using-capybara/49712231#49712231", "title": "Finding a specific row in a table using capybara", "body": "<p>This is not so much a technical answer as it is an alternative approach to avoid the need to write what could be brittle, and overly-complicated tests.</p>\n\n<p>Often times, I am just verifying that some object appeared on the page by looking for some clever text. Maybe it is in a table, or maybe it is in a responsive grid... If I make my test care about the UI implementation, it could break when something changes in the UI.</p>\n\n<p>My \"trick\" is to use some really unusual text for the test. While \"John Smith\" should work, you can use \"John Zebra\" and you will definitely not accidentally have that text appearing on the page.</p>\n\n<p>But when I do need to care about data appearing in a table, I use dom_id for each row. In this example of a list of orgs for the super admin, the reseller org name appears in two rows -- the first being the reseller org's row, and he seond being in the reseller column for a referral org:</p>\n\n<p>The table view code snippet...</p>\n\n<pre><code>%table.orgs-list.stripe\n  %thead\n    %tr\n      %th Created\n      %th Name\n      %th Reseller\n      ...\n  %tbody\n    - organizations.each do |org|\n      %tr{id: dom_id(org)}\n        %td= org.created_at....\n        %td= link_to org.name, org\n        %td= org.reseller.try(:name)\n        ...\n</code></pre>\n\n<p>And the cucumber test code snippet:</p>\n\n<pre><code>Then(/^I should see \"([^\"]*)\" showing \"([^\"]*)\" as the reseller$/) do |org_name, reseller_name|\n  org = Organization.where( name: org_name).first\n  reseller = Organization.where( name: reseller_name).first\n  dom_id = \"organization_#{org._id}\"\n  within(\"tr##{dom_id}\") do\n    expect(page).to have_text(reseller.name)\n  end\nend\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1574, "user_id": 1388302, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/27ca9066ad05bd8aa9ec366115f3cd38?s=128&d=identicon&r=PG", "display_name": "kwerle", "link": "https://stackoverflow.com/users/1388302/kwerle"}, "is_accepted": false, "score": -1, "last_activity_date": 1583522441, "creation_date": 1583522441, "answer_id": 60570346, "question_id": 39479485, "link": "https://stackoverflow.com/questions/39479485/finding-a-specific-row-in-a-table-using-capybara/60570346#60570346", "title": "Finding a specific row in a table using capybara", "body": "<pre><code>def row_containing_cell_with_text(text, exact = false)\n  find('td,th', text: text, exact: exact).ancestor('tr')\nend\n</code></pre>\n"}], "owner": {"reputation": 2096, "user_id": 2108990, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/886481640b3ab8f05cdf3be8c0efdad6?s=128&d=identicon&r=PG", "display_name": "Zack", "link": "https://stackoverflow.com/users/2108990/zack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8348, "favorite_count": 1, "accepted_answer_id": 39479811, "answer_count": 4, "score": 6, "last_activity_date": 1583522441, "creation_date": 1473803179, "question_id": 39479485, "link": "https://stackoverflow.com/questions/39479485/finding-a-specific-row-in-a-table-using-capybara", "title": "Finding a specific row in a table using capybara", "body": "<p>I have a users table that list out the users' ID, name, email and username. What I am attempting to do is verify that a specific entry is in that table. </p>\n\n<p>So essentially what I would like to do is find the row that has ID = 22, then verify that <code>name = John Smith</code>, <code>email = john@smith.com</code> and <code>username = jsmith</code>. The able is setup as show below. What I don't understand is a couple of things...</p>\n\n<ol>\n<li>How do I get a row with specific text, I.E. that as user.id = 22. </li>\n<li>Once I have that row, how do I use it get each of the elements. </li>\n</ol>\n\n<p>I thought I could do a sort of for loop but can't figure out how to set the <code>has_selector?</code> condition. (below is pseudocode)</p>\n\n<pre><code>page.all('tr').each do |tr|\n  next unless tr.has_selector?('td.id = 22') #psuedocode\n\n  expect(tr.get('td.name').to eq(\"John Smith\")\n  #other expects here...\nend \n</code></pre>\n\n<p><strong>Table code</strong> </p>\n\n<pre><code>&lt;table class=\"table table-striped table-condensed\"&gt;\n  &lt;thead&gt;\n    &lt;tr&gt;\n      &lt;th&gt;ID&lt;/th&gt;\n      &lt;th&gt;Name&lt;/th&gt;\n      &lt;th&gt;Email&lt;/th&gt;\n      &lt;th&gt;Username&lt;/th&gt;\n    &lt;/tr&gt;\n  &lt;/thead&gt;\n  &lt;tbody&gt;\n    &lt;% @users.each do |user| %&gt;\n      &lt;tr&gt;\n        &lt;td class=\"id\"&gt;&lt;%= user.id %&gt;&lt;/td&gt;\n        &lt;td class=\"name\"&gt;&lt;%= link_to user.name, user %&gt;&lt;/td&gt;\n        &lt;td class=\"email\"&gt;&lt;%= user.base_name %&gt;&lt;/td&gt;\n        &lt;td class=\"username\"&gt;&lt;%= user.username %&gt;&lt;/td&gt;\n      &lt;/tr&gt;\n    &lt;% end %&gt;\n  &lt;/tbody&gt;\n&lt;/table&gt;\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord"], "answers": [{"tags": [], "owner": {"reputation": 2549, "user_id": 3284936, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/TDrZU.jpg?s=128&g=1", "display_name": "dimitry_n", "link": "https://stackoverflow.com/users/3284936/dimitry-n"}, "is_accepted": false, "score": 1, "last_activity_date": 1473800747, "creation_date": 1473800747, "answer_id": 39478981, "question_id": 39478771, "link": "https://stackoverflow.com/questions/39478771/setting-table-name-in-a-dynamically-defined-class-rails-4/39478981#39478981", "title": "Setting table name in a dynamically-defined class - Rails 4", "body": "<p>Turned out to be the way I am defining the dynamic class. Methods should be defined in a lambda, inside the <code>Object.const_set(...)</code> call:</p>\n\n<pre><code>Object.const_set('Foo', Class.new(MyRemoteDB){\n  ...\n  self.table_name = ENV['TABLE_NAME']\n  ...\n})\n</code></pre>\n"}], "owner": {"reputation": 2549, "user_id": 3284936, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/TDrZU.jpg?s=128&g=1", "display_name": "dimitry_n", "link": "https://stackoverflow.com/users/3284936/dimitry-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1474229167, "creation_date": 1473799808, "last_edit_date": 1474229167, "question_id": 39478771, "link": "https://stackoverflow.com/questions/39478771/setting-table-name-in-a-dynamically-defined-class-rails-4", "title": "Setting table name in a dynamically-defined class - Rails 4", "body": "<p>I am working with a remote database (SQL Server 2008), and have a dynamic class definition, in which I am pointing to a specific table name like so:</p>\n\n<pre><code>  Object.const_set('Foo', Class.new(MyRemoteDB)) do\n    self.table_name = ENV['TABLE_NAME']\n    def self.go_wild\n      ...\n    end\n  end\n</code></pre>\n\n<p>but when I try to access any methods defined in my dynamically-generated classes, Rails returns <em>Table doesn't exist</em>. </p>\n\n<p>If I log the table name with <code>self.table_name</code>, I get the conventional plural version of the class name (e.g. <code>foos</code> for class name <code>Foo</code>, or <code>foo_bars</code> for <code>FooBar</code>) instead of the val I set with <code>self.table_name</code>. </p>\n"}, {"tags": ["ruby-on-rails", "ruby", "regex", "nokogiri"], "comments": [{"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1473799656, "post_id": 39478722, "comment_id": 66276654, "body": "And if you use <code>a.attr(&quot;href&quot;)[&#47;\\?code=(\\d+)&#47;, 1]</code>? Or just <code>a.attr(&quot;href&quot;)[&#47;\\d+&#47;]</code> (if there is only 1 sequence of one or more digits)?"}, {"owner": {"reputation": 481662, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1473800459, "post_id": 39478722, "comment_id": 66276980, "body": "Also, try <code>a[&quot;href&quot;][&#47;\\d+&#47;]</code>"}, {"owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "edited": false, "score": 0, "creation_date": 1473803546, "post_id": 39478722, "comment_id": 66278210, "body": "Can you show the input and the output? Are you really accessing <code>[1]</code> of the match?"}, {"owner": {"reputation": 1717, "user_id": 1034924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ecedc78563223e4f7742bbfc66992905?s=128&d=identicon&r=PG", "display_name": "nzajt", "link": "https://stackoverflow.com/users/1034924/nzajt"}, "edited": false, "score": 0, "creation_date": 1473807423, "post_id": 39478722, "comment_id": 66279406, "body": "It does work? <a href=\"http://rubular.com/r/ED3hgfEzuF\" rel=\"nofollow noreferrer\">rubular.com/r/ED3hgfEzuF</a>. I also tried it on ruby 2.3.1."}, {"owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1473817600, "post_id": 39478722, "comment_id": 66281641, "body": "THe only reason &quot;[/\\d+/]&quot; doesn&#39;t work is there may be multiple sequences of numbers.  The only one I care about is the one following &quot;code=&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1473817250, "post_id": 39480682, "comment_id": 66281577, "body": "THe URL is a relative one (e.g. &quot;../results?code=abcde&quot;).  Will this still work with a relative URL?"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "reply_to_user": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1473871933, "post_id": 39480682, "comment_id": 66309094, "body": "What did you try? &quot;<a href=\"http://meta.stackoverflow.com/a/261593/128421\">How much research effort is expected of Stack Overflow users?</a>&quot; is important."}], "tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": true, "score": 4, "last_activity_date": 1473812354, "last_edit_date": 1473812354, "creation_date": 1473811742, "answer_id": 39480682, "question_id": 39478722, "link": "https://stackoverflow.com/questions/39478722/how-to-extract-a-parameter-from-a-url-using-a-regex-pattern/39480682#39480682", "title": "How to extract a parameter from a URL using a regex pattern", "body": "<p>Don't use regular expressions, use a well-tested wheel.</p>\n\n<p>Ruby's <a href=\"http://ruby-doc.org/stdlib-2.3.1/libdoc/uri/rdoc/URI.html\" rel=\"nofollow\">URI</a> class is your friend, in particular <a href=\"http://ruby-doc.org/stdlib-2.3.1/libdoc/uri/rdoc/URI.html#method-c-decode_www_form\" rel=\"nofollow\"><code>decode_www_form</code></a>:</p>\n\n<pre><code>require 'uri'\n\nuri = URI.parse('http://foo.com?code=768140119')\nuri.query # =&gt; \"code=768140119\"\nURI.decode_www_form(uri.query) # =&gt; [[\"code\", \"768140119\"]]\nURI.decode_www_form(uri.query).to_h # =&gt; {\"code\"=&gt;\"768140119\"}\n</code></pre>\n\n<p>As for extracting the value of a parameter of a tag, Nokogiri makes it easy, just treat the Node like a hash:</p>\n\n<pre><code>require 'nokogiri'\n\ndoc = Nokogiri::HTML(\"\n&lt;html&gt;\n  &lt;body&gt;\n    &lt;a href='path/to/foo'&gt;bar&lt;/a&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n\")\n\ndoc.at('a')['href'] # =&gt; \"path/to/foo\"\n</code></pre>\n\n<p>You don't need to waste time typing <code>attr(...)</code>.</p>\n"}], "owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 876, "favorite_count": 0, "accepted_answer_id": 39480682, "answer_count": 1, "score": 1, "last_activity_date": 1473812354, "creation_date": 1473799576, "last_edit_date": 1473812160, "question_id": 39478722, "link": "https://stackoverflow.com/questions/39478722/how-to-extract-a-parameter-from-a-url-using-a-regex-pattern", "title": "How to extract a parameter from a URL using a regex pattern", "body": "<p>I\u2019m having trouble with a matching expression.  I want to extract the \"code\" parameter from  a link I extracted using Nokogiri,  so I tried:</p>\n\n<pre><code>event_id = a.attr(\"href\").match(/\\?code=(\\d+)/)[1]\n</code></pre>\n\n<p>Unfortunately what is extracted is the entire query string:</p>\n\n<pre><code>?code=768140119\n</code></pre>\n\n<p>What is the proper way to just get the value of the parameter and nothing else?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "nokogiri", "element"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1473812639, "post_id": 39478351, "comment_id": 66280585, "body": "Welcome to Stack Overflow. Please read &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;. You don&#39;t have a minimal example of the input HTML which would help us help you. Making us cobble up same HTML wastes our time which could go toward helping others. Are you actually trying to parse XML as HTML?"}], "answers": [{"comments": [{"owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1473817440, "post_id": 39480813, "comment_id": 66281619, "body": "When I say &quot;element with the name of &#39;range&#39;&quot;, I mean an element that has an attribute called &quot;name&quot; that is equal to &quot;range&quot;.  Does that make sense?"}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "reply_to_user": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "edited": false, "score": 0, "creation_date": 1473872095, "post_id": 39480813, "comment_id": 66309171, "body": "That information needs to be added to your question as if you&#39;d written it there initially. Don&#39;t use &quot;Edit&quot; or &quot;Update&quot; tags in the text as we can tell what changed when if we want to know. A minimal HTML sample demonstrating what you&#39;re talking about makes a lot more sense than a description of it; A picture is worth a thousand words."}], "tags": [], "owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "is_accepted": false, "score": 0, "last_activity_date": 1473812846, "creation_date": 1473812846, "answer_id": 39480813, "question_id": 39478351, "link": "https://stackoverflow.com/questions/39478351/getting-invlaid-expression-when-trying-to-find-elements-within-a-named-element/39480813#39480813", "title": "Getting &quot;Invlaid expression&quot; when trying to find elements within a named element in Nokogiri", "body": "<p>It's not exactly clear what you want, but this might help. </p>\n\n<p>Meditate on this:</p>\n\n<pre><code>require 'nokogiri'\n\ndoc = Nokogiri::XML('&lt;root&gt;&lt;range&gt;&lt;option&gt;1&lt;/option&gt;&lt;option&gt;2&lt;/option&gt;&lt;/range&gt;&lt;/root&gt;')\n\ndoc.search('range option') # =&gt; [#&lt;Nokogiri::XML::Element:0x3ffc64544e1c name=\"option\" children=[#&lt;Nokogiri::XML::Text:0x3ffc64544c3c \"1\"&gt;]&gt;, #&lt;Nokogiri::XML::Element:0x3ffc64544a5c name=\"option\" children=[#&lt;Nokogiri::XML::Text:0x3ffc6454487c \"2\"&gt;]&gt;]\ndoc.search('range option').map(&amp;:to_xml) # =&gt; [\"&lt;option&gt;1&lt;/option&gt;\", \"&lt;option&gt;2&lt;/option&gt;\"]\n</code></pre>\n\n<p><code>search</code> will walk the document and return all matching elements for the selector. The CSS <code>range option</code> looks for all <code>&lt;range&gt;</code> containing <code>&lt;option&gt;</code> tags and returns the <code>&lt;option&gt;</code> nodes in a NodeSet. From that point you can fold, spindle or mutilate to your heart's content.</p>\n"}], "owner": {"reputation": 16802, "user_id": 1235929, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9f460ae7deb6fa19034c810a53b9fbac?s=128&d=identicon&r=PG", "display_name": "Dave", "link": "https://stackoverflow.com/users/1235929/dave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473812952, "creation_date": 1473797892, "last_edit_date": 1473812952, "question_id": 39478351, "link": "https://stackoverflow.com/questions/39478351/getting-invlaid-expression-when-trying-to-find-elements-within-a-named-element", "title": "Getting &quot;Invlaid expression&quot; when trying to find elements within a named element in Nokogiri", "body": "<p>I\u2019m using Nokogiri with Ruby on Rails 4.2.7.  How do I say that I want to find all \u201coption\u201d elements within another element with the name of \u201crange\u201d?  I tried</p>\n\n<pre><code>response = http.request(req)\n  doc = Nokogiri::HTML(response.body)\n\u2026\noptions = doc.xpath(\u201c//range option\")\n</code></pre>\n\n<p>but it is giving me the error</p>\n\n<pre><code>Error during processing: Invalid expression: //range option\n/Users/davea/.rvm/gems/ruby-2.3.0/gems/nokogiri-1.6.8/lib/nokogiri/xml/searchable.rb:165:in `evaluate'\n/Users/davea/.rvm/gems/ruby-2.3.0/gems/nokogiri-1.6.8/lib/nokogiri/xml/searchable.rb:165:in `block in xpath'\n/Users/davea/.rvm/gems/ruby-2.3.0/gems/nokogiri-1.6.8/lib/nokogiri/xml/searchable.rb:156:in `map'\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby"], "answers": [{"tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": false, "score": 1, "last_activity_date": 1473797777, "creation_date": 1473797777, "answer_id": 39478320, "question_id": 39478245, "link": "https://stackoverflow.com/questions/39478245/how-to-show-the-name-of-category-instead-of-its-id/39478320#39478320", "title": "How to show the name of category instead of its ID?", "body": "<p>You should access <code>@post</code>'s category's name:</p>\n\n<pre><code>@post.category.name\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1128, "user_id": 3973117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f52a78aa4cf83a8372e28a27ce3511c?s=128&d=identicon&r=PG", "display_name": "jan.zikan", "link": "https://stackoverflow.com/users/3973117/jan-zikan"}, "is_accepted": true, "score": 0, "last_activity_date": 1473797793, "creation_date": 1473797793, "answer_id": 39478327, "question_id": 39478245, "link": "https://stackoverflow.com/questions/39478245/how-to-show-the-name-of-category-instead-of-its-id/39478327#39478327", "title": "How to show the name of category instead of its ID?", "body": "<p>Because you are using association belongs_to in Post model, you can get the category name in your view this way:</p>\n\n<pre><code>&lt;%= @post.category.name %&gt;\n</code></pre>\n"}], "owner": {"reputation": 1428, "user_id": 2730725, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1a694df4d71660fc4d84ccbb92469e38?s=128&d=identicon&r=PG&f=1", "display_name": "user273072545345", "link": "https://stackoverflow.com/users/2730725/user273072545345"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "accepted_answer_id": 39478327, "answer_count": 2, "score": 0, "last_activity_date": 1473812525, "creation_date": 1473797500, "last_edit_date": 1473812525, "question_id": 39478245, "link": "https://stackoverflow.com/questions/39478245/how-to-show-the-name-of-category-instead-of-its-id", "title": "How to show the name of category instead of its ID?", "body": "<p>I am trying to have the category name show up in the Post's show.html.erb.</p>\n\n<p>This is the current code for it: </p>\n\n<pre><code>&lt;p&gt;\n  &lt;strong&gt;Title:&lt;/strong&gt;\n  &lt;%= @post.title %&gt;\n&lt;/p&gt;\n\n&lt;p&gt;\n  &lt;strong&gt;Text:&lt;/strong&gt;\n  &lt;%= @post.text %&gt;\n&lt;/p&gt;\n\n&lt;p&gt;\n  &lt;strong&gt;Category:&lt;/strong&gt;\n  &lt;%= @post.category_id %&gt;\n&lt;/p&gt;\n\n&lt;h2&gt;Comments&lt;/h2&gt;\n&lt;%= render @post.comments %&gt;\n\n&lt;h2&gt;Add a comment&lt;/h2&gt;\n&lt;%= render 'comments/form' %&gt;\n\n&lt;%= link_to 'Back', posts_path %&gt;\n</code></pre>\n\n<p>How do I deal with this part: <code>&lt;%= @post.category_id %&gt;</code> so it can show the name of the category instead? </p>\n\n<p>The current schema is: </p>\n\n<pre><code>  create_table \"categories\", force: :cascade do |t|\n    t.string   \"name\"\n    t.text     \"description\"\n    t.datetime \"created_at\",  null: false\n    t.datetime \"updated_at\",  null: false\n  end\n\n  create_table \"comments\", force: :cascade do |t|\n    t.string   \"name\"\n    t.text     \"body\"\n    t.integer  \"post_id\"\n    t.datetime \"created_at\", null: false\n    t.datetime \"updated_at\", null: false\n    t.index [\"post_id\"], name: \"index_comments_on_post_id\", using: :btree\n  end\n\n  create_table \"posts\", force: :cascade do |t|\n    t.string   \"title\"\n    t.text     \"text\"\n    t.datetime \"created_at\",  null: false\n    t.datetime \"updated_at\",  null: false\n    t.integer  \"category_id\"\n    t.index [\"category_id\"], name: \"index_posts_on_category_id\", using: :btree\n  end\n\n  add_foreign_key \"comments\", \"posts\"\n  add_foreign_key \"posts\", \"categories\"\nend\n</code></pre>\n\n<p>Current models are: </p>\n\n<p>Post:</p>\n\n<pre><code>class Post &lt; ApplicationRecord\n  has_many :comments\n  belongs_to :category\n\n  validates :title, presence: true\n  validates :text, presence: true\nend\n</code></pre>\n\n<p>Categories:</p>\n\n<pre><code>class Category &lt; ApplicationRecord\n  has_many :posts\nend\n</code></pre>\n\n<p>Comment:</p>\n\n<pre><code>class Comment &lt; ApplicationRecord\n  belongs_to :post\nend\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4"], "comments": [{"owner": {"reputation": 7668, "user_id": 29680, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/isyUF.jpg?s=128&g=1", "display_name": "John Naegle", "link": "https://stackoverflow.com/users/29680/john-naegle"}, "edited": false, "score": 1, "creation_date": 1473796292, "post_id": 39477719, "comment_id": 66275177, "body": "You should probably use the session, which is browser specific, instead of the cache."}, {"owner": {"reputation": 5828, "user_id": 5203069, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cf5b1613b2287cd6b8bf05baa2842b5?s=128&d=identicon&r=PG&f=1", "display_name": "skwidbreth", "link": "https://stackoverflow.com/users/5203069/skwidbreth"}, "reply_to_user": {"reputation": 7668, "user_id": 29680, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/isyUF.jpg?s=128&g=1", "display_name": "John Naegle", "link": "https://stackoverflow.com/users/29680/john-naegle"}, "edited": false, "score": 0, "creation_date": 1473810829, "post_id": 39477719, "comment_id": 66280218, "body": "@JohnNaegle Thank you!  You and Wade73 have given me good things to think about."}, {"owner": {"reputation": 5828, "user_id": 5203069, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cf5b1613b2287cd6b8bf05baa2842b5?s=128&d=identicon&r=PG&f=1", "display_name": "skwidbreth", "link": "https://stackoverflow.com/users/5203069/skwidbreth"}, "reply_to_user": {"reputation": 7668, "user_id": 29680, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/isyUF.jpg?s=128&g=1", "display_name": "John Naegle", "link": "https://stackoverflow.com/users/29680/john-naegle"}, "edited": false, "score": 0, "creation_date": 1473876981, "post_id": 39477719, "comment_id": 66311688, "body": "@JohnNaegle Awesome, thank you for your suggestion.  I had to rework the logic a bit, but using session variables totally fixed my problem."}], "answers": [{"comments": [{"owner": {"reputation": 5828, "user_id": 5203069, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cf5b1613b2287cd6b8bf05baa2842b5?s=128&d=identicon&r=PG&f=1", "display_name": "skwidbreth", "link": "https://stackoverflow.com/users/5203069/skwidbreth"}, "edited": false, "score": 0, "creation_date": 1473801994, "post_id": 39478784, "comment_id": 66277633, "body": "that&#39;s funny, as I was walking down the street after posting this, I thought to myself &#39;why don&#39;t you just record the data on submission and then retain or delete it on successful/unsuccessful log in?&#39;.  I have to think about this a bit, but I believe that you&#39;ve set me on the right track - if I can get it to work, will for sure accept your answer."}, {"owner": {"reputation": 5828, "user_id": 5203069, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cf5b1613b2287cd6b8bf05baa2842b5?s=128&d=identicon&r=PG&f=1", "display_name": "skwidbreth", "link": "https://stackoverflow.com/users/5203069/skwidbreth"}, "edited": false, "score": 0, "creation_date": 1473876927, "post_id": 39478784, "comment_id": 66311662, "body": "Yes! I had to reconfigure the controllers and the logic a bit, but simply saving as a session variable worked. Thank you so much for your help! Editing my question to show solution..."}, {"owner": {"reputation": 4205, "user_id": 159370, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ppN64.jpg?s=128&g=1", "display_name": "Wade73", "link": "https://stackoverflow.com/users/159370/wade73"}, "reply_to_user": {"reputation": 5828, "user_id": 5203069, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cf5b1613b2287cd6b8bf05baa2842b5?s=128&d=identicon&r=PG&f=1", "display_name": "skwidbreth", "link": "https://stackoverflow.com/users/5203069/skwidbreth"}, "edited": false, "score": 0, "creation_date": 1473878602, "post_id": 39478784, "comment_id": 66312556, "body": "No problem, enjoy your day!"}, {"owner": {"reputation": 5828, "user_id": 5203069, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cf5b1613b2287cd6b8bf05baa2842b5?s=128&d=identicon&r=PG&f=1", "display_name": "skwidbreth", "link": "https://stackoverflow.com/users/5203069/skwidbreth"}, "edited": false, "score": 0, "creation_date": 1473903714, "post_id": 39478784, "comment_id": 66321313, "body": "actually, I misunderstood the problem, figured out a better way to ask - <a href=\"http://stackoverflow.com/questions/39501992/rails-devise-updating-session-variables-between-controller-actions\" title=\"rails devise updating session variables between controller actions\">stackoverflow.com/questions/39501992/&hellip;</a>"}, {"owner": {"reputation": 4205, "user_id": 159370, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ppN64.jpg?s=128&g=1", "display_name": "Wade73", "link": "https://stackoverflow.com/users/159370/wade73"}, "reply_to_user": {"reputation": 5828, "user_id": 5203069, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cf5b1613b2287cd6b8bf05baa2842b5?s=128&d=identicon&r=PG&f=1", "display_name": "skwidbreth", "link": "https://stackoverflow.com/users/5203069/skwidbreth"}, "edited": false, "score": 0, "creation_date": 1473949550, "post_id": 39478784, "comment_id": 66343070, "body": "To be honest I am new to Ruby on Rails, though I have been a web developer for a few years on ASP.Net.  Not sure I am going to be much help beyond what I provided."}, {"owner": {"reputation": 5828, "user_id": 5203069, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cf5b1613b2287cd6b8bf05baa2842b5?s=128&d=identicon&r=PG&f=1", "display_name": "skwidbreth", "link": "https://stackoverflow.com/users/5203069/skwidbreth"}, "edited": false, "score": 0, "creation_date": 1473957351, "post_id": 39478784, "comment_id": 66348114, "body": "@Wade23 - thanks man, it turned out to be a fairly messy problem having to do with the Devise gem and its various limitations.  I ended up solving my problem using AJAX to get data around the hurdles."}, {"owner": {"reputation": 4205, "user_id": 159370, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ppN64.jpg?s=128&g=1", "display_name": "Wade73", "link": "https://stackoverflow.com/users/159370/wade73"}, "reply_to_user": {"reputation": 5828, "user_id": 5203069, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cf5b1613b2287cd6b8bf05baa2842b5?s=128&d=identicon&r=PG&f=1", "display_name": "skwidbreth", "link": "https://stackoverflow.com/users/5203069/skwidbreth"}, "edited": false, "score": 0, "creation_date": 1473966086, "post_id": 39478784, "comment_id": 66352718, "body": "Good to hear, sorry I wasn&#39;t more helpful."}], "tags": [], "owner": {"reputation": 4205, "user_id": 159370, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ppN64.jpg?s=128&g=1", "display_name": "Wade73", "link": "https://stackoverflow.com/users/159370/wade73"}, "is_accepted": true, "score": 1, "last_activity_date": 1473799868, "creation_date": 1473799868, "answer_id": 39478784, "question_id": 39477719, "link": "https://stackoverflow.com/questions/39477719/rails-controller-actions-cache-handling-simultaneous-overlapping-requests/39478784#39478784", "title": "Rails controller actions &amp; cache - handling simultaneous/overlapping requests", "body": "<p>I would suggest that you store the initial information into the database.  From there I would either save the id in a cookie or session variable.  You would then be able to retrieve the information from the database in the approval controller.  Another option I would consider would be to generate a guid as an id and pass that along to the sign in page as a query string parameter.  Store the guid in a hidden input tag, under the form tag.  Then when the user submits their credentials, you can also pass the guid.  At that point you log them in.  If successful, pull the guid from the posted data and then retrieve the database information with the guid.  </p>\n\n<p>Wade  </p>\n"}], "owner": {"reputation": 5828, "user_id": 5203069, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/3cf5b1613b2287cd6b8bf05baa2842b5?s=128&d=identicon&r=PG&f=1", "display_name": "skwidbreth", "link": "https://stackoverflow.com/users/5203069/skwidbreth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "accepted_answer_id": 39478784, "answer_count": 1, "score": 0, "last_activity_date": 1473903755, "creation_date": 1473795314, "last_edit_date": 1495541302, "question_id": 39477719, "link": "https://stackoverflow.com/questions/39477719/rails-controller-actions-cache-handling-simultaneous-overlapping-requests", "title": "Rails controller actions &amp; cache - handling simultaneous/overlapping requests", "body": "<p>My Rails app depends on the Rails cache to temporarily hold user input and pass it between controller actions during the user log in process.  However, I realized that I have made a pretty serious error (since I am super-new to Rails and MVC, in general) and could use some help/advice/wisdom - basically, if two users are simultaneously (or nearly simultaneously) submitting data and going through the controller steps below, there's going to be some trouble - lost data, one user's data being entered as another, etc.  When I was building this, I did not understand the nature of controllers, though I for sure have a better idea now....</p>\n\n<p>In short, here's how the code below is intended to work: a non-logged-in user fills out a form and submits that data which is passed to the <code>submission</code> action and held in a Rails cache object called <code>incoming_report</code>; the user is then prompted to log in (via Devise), and a successful log in triggers the <code>approval</code> controller action which reads the <code>incoming_report</code> cache object, saves that data to the database, and then creates a new cache object called <code>ids</code> to hang on to the id #'s of the user's entries; this redirects to the <code>summary</code> action which gathers up those ids and shows the corresponding data to the user as a summary of their entry.</p>\n\n<p><code>report_controller.rb</code></p>\n\n<pre><code>#ON SUBMITTING THE FORM...\ndef submission\n    @incomingReport = ActiveSupport::JSON.decode(params[:report])\n\n    #SUBMITTED DATA IS HELD IN THE CACHE AS 'incoming_report' TO PASS TO approval CONTROLLER ACTION ON SUCCESSFUL LOGIN\n    Rails.cache.write(\"incoming_report\",@incomingReport)\nend\n\n#ON SUCCESSFUL LOG IN...\ndef approval\n    @incomingReport = Rails.cache.read(\"incoming_report\")\n    @newReportIDArray = Array.new\n\n    @incomingReport.each do |x|\n        #DATA PROCESSING STUFF HERE...\n    end\n\n    #DELETE 'incoming_report' FROM CACHE\n    Rails.cache.delete(\"incoming_report\")\n\n    #ID NUMBERS OF ENTRIES ARE HELD TO PASS TO summary CONTROLLER ACTION\n    Rails.cache.write(\"ids\",@newReportIDArray)\n\n    redirect_to report_summary_path\nend\n\n#AFTER DATA IS ENTERED...\ndef summary\n    @newReportIDs = Rails.cache.read(\"ids\")\n    #DELETE 'ids' FROM CACHE\n    Rails.cache.delete(\"ids\")\nend\n</code></pre>\n\n<p>For the most part, this works very well, but if users cross each other during any of these actions, it's disastrous.  For instance, if one user hits the <code>submission</code> action while another user is busy logging in, the <code>incoming_report</code> object of the second user will overwrite that of the first user... and so on and so forth.</p>\n\n<p>The main source of this problem is the fact that users log in after they have clicked the form submit button - the app must be structured that way - and the data can't be held in local/session storage objects because it includes base64 strings and is too long to employ those methods in certain browsers.  Holding this data on the server seemed like the best course of action until I noticed this issue...</p>\n\n<p>Is there any way that I can prevent users from getting in each other's way in the controllers?  Or have I made a pretty fatal error?</p>\n\n<p><strong>Editing to show solution</strong></p>\n\n<p>Ultimately, using session variables instead of the Rails cache saved the day. Here's the reconfigured controller to show the solution...</p>\n\n<pre><code>def submission\n    @incomingReport = ActiveSupport::JSON.decode(params[:report])\n\n    @newReportIDArray = Array.new\n\n    @incomingReport.each do |x|\n        #DATA PROCESSING STUFF HERE\n        @newReportIDArray.push(@new_report.id)\n    end\n\n    session[:ids] = @newReportIDArray\n\n    respond_to do |format|\n      format.json do\n        render json: {\n          success: 200\n        }.to_json\n      end\n    end\nend\n\ndef approval\n    @reportIDs = session[:ids]\n\n    @reportIDs.each do |x|\n        @new_report = Report.find(x)\n        @new_report.user_id = current_user.id\n        @new_report.save\n    end\n\n    redirect_to report_summary_path\nend\n\n\ndef summary\n    @reportIDs = session[:ids]\nend\n</code></pre>\n\n<p>Many thanks to the two folks who helped me on this and showed me the ways of the session variable.</p>\n\n<p>I ran into a problem with the session variable being 'lost' between controller actions - <a href=\"https://stackoverflow.com/questions/39501992/rails-devise-updating-session-variables-between-controller-actions\">Rails / Devise - updating session variables between controller actions</a></p>\n"}, {"tags": ["ruby-on-rails", "ruby", "rspec", "ruby-on-rails-5"], "answers": [{"tags": [], "owner": {"reputation": 12542, "user_id": 156746, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8TsPx.jpg?s=128&g=1", "display_name": "DiegoSalazar", "link": "https://stackoverflow.com/users/156746/diegosalazar"}, "is_accepted": false, "score": 0, "last_activity_date": 1473879999, "creation_date": 1473879999, "answer_id": 39497903, "question_id": 39477111, "link": "https://stackoverflow.com/questions/39477111/rspec-stub-super-call-in-a-moduleprepend-monkeypatch/39497903#39497903", "title": "RSpec - stub #super call in a Module#prepend monkeypatch", "body": "<p>Just playing around with your code, I rewrote the <code>call</code> method on <code>Client</code> after the override and it overrode the original <code>Client#call</code> which should help in stubbing the method to raise a <code>TimeoutError</code>.</p>\n\n<p>Given:</p>\n\n<pre><code>class Client\n  def call\n    puts \"super\"\n  end\n\n  module MethodOverrides\n    def call\n      begin\n        puts \"override\"\n        super\n      rescue =&gt; ex\n        puts \"reconnect\"\n        super\n      end\n    end\n  end\n  prepend MethodOverrides\nend\n</code></pre>\n\n<p>I ran:</p>\n\n<pre><code>Client.new.call\n# override\n# super\n# =&gt; nil\n</code></pre>\n\n<p>Then I manually monkey patched the <code>Client#call</code> method:</p>\n\n<pre><code>class Client\n  def call\n    raise \"a timeout happened\"\n  end\nend\n</code></pre>\n\n<p>And I got:</p>\n\n<pre><code>Client.new.call\n# override\n# reconnect\n# =&gt; RuntimeError: a timeout happened\n</code></pre>\n\n<p>It's not exactly what you had before but with a little restructuring of your specs you can put this approach to use i.e. causing a Timeout and seeing if the <code>reconnect</code> method gets called. Or better yet, that <code>Client#call</code> has the expected side effects when it is called with and without a Timeout. In other words, test for the correct behavior of the class.</p>\n"}], "owner": {"reputation": 292, "user_id": 421313, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9641056639707d9e4be49fc79d5e8183?s=128&d=identicon&r=PG", "display_name": "Xuor", "link": "https://stackoverflow.com/users/421313/xuor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 466, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1473879999, "creation_date": 1473792839, "last_edit_date": 1473854823, "question_id": 39477111, "link": "https://stackoverflow.com/questions/39477111/rspec-stub-super-call-in-a-moduleprepend-monkeypatch", "title": "RSpec - stub #super call in a Module#prepend monkeypatch", "body": "<p>I am converting monkeypatches which use <code>alias_method_chain</code> to <code>Module#prepend</code>. (Mostly because <code>active_support</code> v5.0 deprecates <code>alias_method_chain</code>.) But doing so makes <code>rspec</code> tests harder.</p>\n\n<p>My old <code>alias_method_chain</code> code looks like:</p>\n\n<pre><code>class Client\n  def call_with_reconnect\n    begin\n      call_without_reconnect\n    rescue =&gt; ex\n      reconnect\n      call_without_reconnect\n    end\n  end\n  alias_method_chain :call, :reconnect\nend\n</code></pre>\n\n<p>I can test this with <code>rspec</code> like:</p>\n\n<pre><code>it \"should silently reconnect when the original request expires\" do\n  allow(subject).to receive(:call_without_reconnect).and_raise(TimeoutError)\n  expect{ subject.call }.to_not raise_error(TimeoutError)\nend\n</code></pre>\n\n<p>My new <code>Module#prepend</code> code looks like:</p>\n\n<pre><code>class Client\n  module MethodOverrides\n    def call\n      begin\n        super\n      rescue =&gt; ex\n        reconnect\n        super\n      end\n    end\n  end\n  prepend MethodOverrides\nend\n</code></pre>\n\n<p>This code works, but I don't know how to test it. I want to force a timeout error when the old method is called, but I can't stub the <code>super</code> call. And I can't stub the call to <code>call</code>, because that's also the name of my monkeypatch method.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "ember.js"], "comments": [{"owner": {"reputation": 763, "user_id": 3746396, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/1486200055/picture?type=large", "display_name": "FutoRicky", "link": "https://stackoverflow.com/users/3746396/futoricky"}, "edited": false, "score": 0, "creation_date": 1478024889, "post_id": 39476701, "comment_id": 67985932, "body": "Did you solve this issue? I&#39;m having the same problem"}], "answers": [{"tags": [], "owner": {"reputation": 763, "user_id": 3746396, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/1486200055/picture?type=large", "display_name": "FutoRicky", "link": "https://stackoverflow.com/users/3746396/futoricky"}, "is_accepted": false, "score": 0, "last_activity_date": 1478026186, "creation_date": 1478026186, "answer_id": 40366660, "question_id": 39476701, "link": "https://stackoverflow.com/questions/39476701/ember-2-8-rails-4-2-4-rails-is-not-receiving-payload-sent-by-ember/40366660#40366660", "title": "Ember 2.8 Rails 4.2.4: Rails is not receiving payload sent by ember", "body": "<p>Had the same issue, created a file <code>mime_type.rb</code> in <code>config/initializers</code> with the following:</p>\n\n<pre><code>api_mime_type = %W(\n  application/vnd.api+json\n  text/x-json\n  application/json\n)\n\nMime::Type.unregister :json\nMime::Type.register 'application/json', :json, api_mime_type\n</code></pre>\n\n<p>This worked for me. Remember to restart the server.</p>\n"}], "owner": {"reputation": 691, "user_id": 4761914, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/xyiAo.jpg?s=128&g=1", "display_name": "Antonio", "link": "https://stackoverflow.com/users/4761914/antonio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1478026186, "creation_date": 1473791082, "last_edit_date": 1473954818, "question_id": 39476701, "link": "https://stackoverflow.com/questions/39476701/ember-2-8-rails-4-2-4-rails-is-not-receiving-payload-sent-by-ember", "title": "Ember 2.8 Rails 4.2.4: Rails is not receiving payload sent by ember", "body": "<p>Simple Rails api back end, ember front end app. I'm trying to create a new record and Ember seems to be formatting the <code>POST</code> request correctly:</p>\n\n<p><a href=\"https://i.stack.imgur.com/LEysQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/LEysQ.png\" alt=\"enter image description here\"></a></p>\n\n<p>It's hitting my controller in the <code>create</code> action but there are no <code>params</code> getting through. It's simply:</p>\n\n<p><code>{\"format\"=&gt;\"json\", \"controller\"=&gt;\"api/v1/vehicles\", \"action\"=&gt;\"create\"}</code></p>\n\n<p><code>request.headers</code> does not show any of the vehicle information I'm trying to create.</p>\n\n<p>I've whitelisted everything needed in the controller:</p>\n\n<pre><code>def vehicle_params\n  params.require(:vehicle).permit(:plate_num, :vehicle_type, :state)\nend\n</code></pre>\n\n<p>I have no idea if relevant but I've set up CORS to accept everything:</p>\n\n<pre><code>  config.middleware.insert_before 0, \"Rack::Cors\" do\n    allow do\n      origins '*'\n      resource '*', :headers =&gt; :any, :methods =&gt; :any\n    end\n  end\n</code></pre>\n\n<p>What else do I need to check?</p>\n"}, {"tags": ["arrays", "ruby", "hash"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1473793298, "post_id": 39476656, "comment_id": 66273689, "body": "Please read &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot; including the linked pages. We&#39;d like to know what you tried. It&#39;s better for us to correct your code, than to write code for you, which isn&#39;t what SO is for. &quot;<a href=\"http://meta.stackoverflow.com/a/261593/128421\">How much research effort is expected of Stack Overflow users?</a>&quot; is a good read also."}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1473795375, "post_id": 39476656, "comment_id": 66274693, "body": "Why the rush to select an answer? More may be coming, you know."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6827709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32e46d31d61bfb64d989d949fd9c16e3?s=128&d=identicon&r=PG&f=1", "display_name": "coyote_rey", "link": "https://stackoverflow.com/users/6827709/coyote-rey"}, "edited": false, "score": 0, "creation_date": 1473791414, "post_id": 39476735, "comment_id": 66272733, "body": "Unfortunately this doesn&#39;t work because this is an array of hash rather than a straight hash. This doesn&#39;t access the hash within the array element."}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 31, "user_id": 6827709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32e46d31d61bfb64d989d949fd9c16e3?s=128&d=identicon&r=PG&f=1", "display_name": "coyote_rey", "link": "https://stackoverflow.com/users/6827709/coyote-rey"}, "edited": false, "score": 0, "creation_date": 1473791583, "post_id": 39476735, "comment_id": 66272819, "body": "@coyote_rey I do not understand your comment. Run the code and see, that it returns what you described in the OP"}, {"owner": {"reputation": 31, "user_id": 6827709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32e46d31d61bfb64d989d949fd9c16e3?s=128&d=identicon&r=PG&f=1", "display_name": "coyote_rey", "link": "https://stackoverflow.com/users/6827709/coyote-rey"}, "edited": false, "score": 0, "creation_date": 1473791839, "post_id": 39476735, "comment_id": 66272965, "body": "I&#39;ve ran this code and I&#39;m not seeing it affecting the firstname value. I see it saying just Anne in the output of that line, but displaying arrayHash[0] after the fact, I am still seeing &#39;Anne Marie&#39;"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 31, "user_id": 6827709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32e46d31d61bfb64d989d949fd9c16e3?s=128&d=identicon&r=PG&f=1", "display_name": "coyote_rey", "link": "https://stackoverflow.com/users/6827709/coyote-rey"}, "edited": false, "score": 0, "creation_date": 1473791897, "post_id": 39476735, "comment_id": 66272998, "body": "@coyote_rey you did not say you wanted to modify the original hashes.Let me update the answer"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 31, "user_id": 6827709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32e46d31d61bfb64d989d949fd9c16e3?s=128&d=identicon&r=PG&f=1", "display_name": "coyote_rey", "link": "https://stackoverflow.com/users/6827709/coyote-rey"}, "edited": false, "score": 0, "creation_date": 1473791943, "post_id": 39476735, "comment_id": 66273023, "body": "@coyote_rey check it now (notice the bang in <code>map!</code>)"}, {"owner": {"reputation": 31, "user_id": 6827709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32e46d31d61bfb64d989d949fd9c16e3?s=128&d=identicon&r=PG&f=1", "display_name": "coyote_rey", "link": "https://stackoverflow.com/users/6827709/coyote-rey"}, "edited": false, "score": 0, "creation_date": 1473792157, "post_id": 39476735, "comment_id": 66273134, "body": "Ah thank you. Yeah sorry about the poor wording. That fixes it for me."}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1473795779, "post_id": 39476735, "comment_id": 66274922, "body": "If you&#39;re testing that it&#39;s a String, then <code>to_s</code> is redundant. You already know it&#39;s a string."}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1473795840, "post_id": 39476735, "comment_id": 66274951, "body": "@tadman correct, <code>to_s</code> is left after my initial attempt. will edit, thanks for noticing!"}, {"owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "edited": false, "score": 0, "creation_date": 1473795908, "post_id": 39476735, "comment_id": 66274987, "body": "It&#39;s a tidy solution, just observing how it could be even more concise."}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": true, "score": 3, "last_activity_date": 1473795850, "last_edit_date": 1473795850, "creation_date": 1473791235, "answer_id": 39476735, "question_id": 39476656, "link": "https://stackoverflow.com/questions/39476656/remove-everything-after-first-whitespace-in-array/39476735#39476735", "title": "Remove everything after first whitespace in array", "body": "<pre><code>arrayHash.map! do |hash|\n  hash.each_with_object({}) do |(k, v), h|\n    h[k] = v.is_a?(String) ? v.split(' ').first : v\n  end\nend\n#=&gt;[{:firstname=&gt;\"Anne\", :lastname=&gt;\"Hook\", :email=&gt;\"test@test.com\", :id=&gt;1}, {:firstname=&gt;\"Michael\", :lastname=&gt;\"Rodriguez\", :email=&gt;\"test2@test.com\", :id=&gt;2}]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 3, "last_activity_date": 1473797450, "last_edit_date": 1473797450, "creation_date": 1473795306, "answer_id": 39477717, "question_id": 39476656, "link": "https://stackoverflow.com/questions/39476656/remove-everything-after-first-whitespace-in-array/39477717#39477717", "title": "Remove everything after first whitespace in array", "body": "<p>If you wish to mutate <code>arrayHash</code>, you could do the following:</p>\n\n<pre><code>arrayHash.each { |h| h.each { |k,v| h[k] = v.is_a?(String) ? v[/\\A\\S*/] : v } }\n  #=&gt; [{:firstname=&gt;\"Anne\", :lastname=&gt;\"Hook\", :email=&gt;\"test@test.com\", :id=&gt;1},\n  #    {:firstname=&gt;\"Michael\", :lastname=&gt;\"Rodriguez\", :email=&gt;\"test2@test.com\", :id=&gt;2}] \n</code></pre>\n\n<p><code>arrayHash</code> is mutated:</p>\n\n<pre><code>arrayHash\n  #=&gt; [{:firstname=&gt;\"Anne\", :lastname=&gt;\"Hook\", :email=&gt;\"test@test.com\", :id=&gt;1},\n  #    {:firstname=&gt;\"Michael\", :lastname=&gt;\"Rodriguez\", :email=&gt;\"test2@test.com\", :id=&gt;2}] \n</code></pre>\n\n<p>The regex <code>/\\A\\S*/</code> matches the beginning of the string followed by zero or more characters other than whitespace. For the string <code>v</code>, <code>v[/\\A\\S*/]</code> returns the match. (See the method <a href=\"http://ruby-doc.org/core-2.3.0/String.html#method-i-5B-5D\" rel=\"nofollow\">String#[]</a>).</p>\n\n<p>If you do not wish to mutate <code>arrayHash</code>, this is one way:</p>\n\n<pre><code>arrayHash.map { |h| h.merge(h) { |_,v,_| v.is_a?(String) ? v[/\\A\\S*/] : v } }\n  #=&gt; [{:firstname=&gt;\"Anne\", :lastname=&gt;\"Hook\", :email=&gt;\"test@test.com\", :id=&gt;1},\n  #    {:firstname=&gt;\"Michael\", :lastname=&gt;\"Rodriguez\", :email=&gt;\"test2@test.com\", :id=&gt;2}] \n</code></pre>\n\n<p><code>arrayHash</code> is unchanged:</p>\n\n<pre><code>arrayHash\n  #=&gt; [{:firstname=&gt;\"Anne Marie\", :lastname=&gt;\"Hook\", :email=&gt;\"test@test.com\", :id=&gt;1},\n  #    {:firstname=&gt;\"Michael\", :lastname=&gt;\"Rodriguez\", :email=&gt;\"test2@test.com\", :id=&gt;2}] \n</code></pre>\n\n<p>In the second case I've used the form of the method <a href=\"http://ruby-doc.org/core-2.3.0/Hash.html#method-i-merge\" rel=\"nofollow\">Hash#merge</a> which employs a block to determine the values of keys that are present in both hashes being merged, which here is all the keys. See the doc for an explanation of the values of the three block variables (the first and third of which I've represented with an underscore to signify that they are not used in the block calculation).</p>\n"}], "owner": {"reputation": 31, "user_id": 6827709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32e46d31d61bfb64d989d949fd9c16e3?s=128&d=identicon&r=PG&f=1", "display_name": "coyote_rey", "link": "https://stackoverflow.com/users/6827709/coyote-rey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 39476735, "answer_count": 2, "score": 2, "last_activity_date": 1473797450, "creation_date": 1473790939, "question_id": 39476656, "link": "https://stackoverflow.com/questions/39476656/remove-everything-after-first-whitespace-in-array", "title": "Remove everything after first whitespace in array", "body": "<p>I have an array of hashes with some values inside the hashes containing spaces. I would like to run through every array element and every value within the hashes to remove any spaces and the following characters past the space. An example of my data would be</p>\n\n<pre><code>arrayHash = [{:firstname=&gt;'Anne Marie', :lastname=&gt;'Hook', :email=&gt;'test@test.com', :id=&gt;1}, \n           {:firstname=&gt;'Michael', :lastname=&gt;'Rodriguez', :email=&gt;'test2@test.com', :id=&gt;2}]\n</code></pre>\n\n<p>So for example on the firstname key, I would like to take 'Anne Marie' and reduce it to just 'Anne', and do the same for every element in this array.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "logging", "logstash"], "answers": [{"comments": [{"owner": {"reputation": 21578, "user_id": 115478, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/df66f5ffbf986ef9ff5a990f26dbd1f1?s=128&d=identicon&r=PG", "display_name": "leedm777", "link": "https://stackoverflow.com/users/115478/leedm777"}, "edited": false, "score": 0, "creation_date": 1474315797, "post_id": 39518986, "comment_id": 66472549, "body": "I tried this, but the <code>payload</code> hash has no uuid field. I only get <code>&quot;uuid&quot;: null</code> in my logs."}, {"owner": {"reputation": 21578, "user_id": 115478, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/df66f5ffbf986ef9ff5a990f26dbd1f1?s=128&d=identicon&r=PG", "display_name": "leedm777", "link": "https://stackoverflow.com/users/115478/leedm777"}, "edited": false, "score": 0, "creation_date": 1474317684, "post_id": 39518986, "comment_id": 66473479, "body": "I found that you need <code>append_info_to_payload</code> defined in the <code>ApplicationController</code> for this to work (see <a href=\"https://github.com/roidrage/lograge/blob/master/README.md\" rel=\"nofollow noreferrer\">github.com/roidrage/lograge/blob/master/README.md</a>). But this only adds the custom fields to the access logs. For the UUID to be useful, it needs to be in all the logs associated with that request (in the same way that Rails puts the tags on every log entry)."}], "tags": [], "owner": {"reputation": 18643, "user_id": 1737909, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/058573b71875bc70b5a4e30140c94040?s=128&d=identicon&r=PG", "display_name": "Ven", "link": "https://stackoverflow.com/users/1737909/ven"}, "is_accepted": false, "score": 1, "last_activity_date": 1473968014, "creation_date": 1473968014, "answer_id": 39518986, "question_id": 39476637, "link": "https://stackoverflow.com/questions/39476637/with-rails-4-and-structured-logging-how-can-i-add-the-request-id-field-to-logs/39518986#39518986", "title": "With Rails 4 and structured logging, how can I add the request id field to logs?", "body": "<p>There are several ways to do this. From Lograge, you can use the <code>custom_options</code>:</p>\n\n<pre><code>  # all your lograge stuff...\n  config.lograge.enabled = true\n\n  config.lograge.custom_options = lambda do |event|\n    # use the `event.payload`\n    {uuid: event.payload[:uuid]}\n  end\n</code></pre>\n\n<p>You can overload any option in here - they'll take over the lib's ones.</p>\n\n<p>The code responsible for this is <a href=\"https://github.com/roidrage/lograge/blob/0cb40f017c67f19ca6aade1981cfd3273fcf286f/lib/lograge/log_subscriber.rb#L40\" rel=\"nofollow\">here</a>. The test that shows it work is <a href=\"https://github.com/roidrage/lograge/blob/c0f4315d71b6f2b3a2dab298e2fb80202569fbb4/spec/lograge_logsubscriber_spec.rb#L48-L53\" rel=\"nofollow\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 376, "user_id": 2720307, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xGoEL.jpg?s=128&g=1", "display_name": "Ianlet", "link": "https://stackoverflow.com/users/2720307/ianlet"}, "is_accepted": false, "score": 0, "last_activity_date": 1575738707, "creation_date": 1575738707, "answer_id": 59228403, "question_id": 39476637, "link": "https://stackoverflow.com/questions/39476637/with-rails-4-and-structured-logging-how-can-i-add-the-request-id-field-to-logs/59228403#59228403", "title": "With Rails 4 and structured logging, how can I add the request id field to logs?", "body": "<p>Old question but maybe it will help someone like me who struggled to find a simple way to do this.</p>\n\n<p>Using the <code>custom_payload</code> (instead of <code>custom_options</code>), you can directly access the request received by the controller and get its id to add it to the logs:</p>\n\n<pre class=\"lang-rb prettyprint-override\"><code>config.lograge.custom_payload do |controller|\n  {\n    request_id: controller.request.request_id\n  }\nend\n</code></pre>\n\n<p>No need to configure the <code>log_tags</code> for this to work.</p>\n"}], "owner": {"reputation": 21578, "user_id": 115478, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/df66f5ffbf986ef9ff5a990f26dbd1f1?s=128&d=identicon&r=PG", "display_name": "leedm777", "link": "https://stackoverflow.com/users/115478/leedm777"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1224, "favorite_count": 0, "answer_count": 2, "score": 10, "last_activity_date": 1575738707, "creation_date": 1473790881, "question_id": 39476637, "link": "https://stackoverflow.com/questions/39476637/with-rails-4-and-structured-logging-how-can-i-add-the-request-id-field-to-logs", "title": "With Rails 4 and structured logging, how can I add the request id field to logs?", "body": "<p>I am adding structured logging to a Rails 4 app. Using <a href=\"https://github.com/roidrage/lograge\">lograge</a> and <a href=\"https://github.com/dwbutler/logstash-logger\">logstash-logger</a> as describe in <a href=\"https://kartar.net/2015/12/structured-logging/\">this article</a>, I've got things mostly working.</p>\n\n<p>I'm having trouble adding request id to the logs. The closest I've found is to add this to <code>config/${ENV}.rb</code>:</p>\n\n<pre><code>config.log_tags = [:uuid]\n</code></pre>\n\n<p>But this adds the request id to the tags list, instead of adding it as a named field.</p>\n\n<pre><code>{\n  \"tags\": [\n    \"da76b4be-01ae-4cc4-8d3c-87062ea02cfe\"\n  ],\n  \"host\": \"services\",\n  \"severity\": \"DEBUG\",\n  \"@version\": \"1\",\n  \"@timestamp\": \"2016-09-13T17:24:34.883+00:00\",\n  \"message\": \"...\"\n}\n</code></pre>\n\n<p>This is problematic. It makes it more awkward and less obvious on how to search for a particular request id. Plus, parsing the message in logstash it overwrites any other tags that are already associated with the log message.</p>\n\n<p>Is there any way that I can add the request id to the log as a named field?</p>\n\n<pre><code>{\n  \"request_id\", \"da76b4be-01ae-4cc4-8d3c-87062ea02cfe\",\n  \"host\": \"services\",\n  \"severity\": \"DEBUG\",\n  \"@version\": \"1\",\n  \"@timestamp\": \"2016-09-13T17:24:34.883+00:00\",\n  \"message\": \"...\"\n}\n</code></pre>\n"}, {"tags": ["ruby", "telnet", "ansi", "vt100"], "comments": [{"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1473793408, "post_id": 39476478, "comment_id": 66273743, "body": "Please read &quot;<a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>&quot;, the linked pages, and &quot;<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>&quot;. Please show us what you tried so we can help fix it, instead of having to write a tutorial along with sample code."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1473793644, "post_id": 39476478, "comment_id": 66273846, "body": "When talking to a device like that, you probably want to change its idea of what sort of device it&#39;s talking to. Tell it your session is a TTY and the control characters should go away. You probably also want to tell it to use the longest line-width possible, or to turn off automatic line-wraps if possible, as those will make it more difficult. <a href=\"https://superuser.com\">Super User</a> would probably be a good source of information."}, {"owner": {"reputation": 879, "user_id": 406470, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/07ac9d851e863e74ee0b8cee1af4ae2a?s=128&d=identicon&r=PG", "display_name": "redcodefinal", "link": "https://stackoverflow.com/users/406470/redcodefinal"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1473794953, "post_id": 39476478, "comment_id": 66274513, "body": "@theTinMan Is there a way to do this in ruby&#39;s Net::Telnet? I didn&#39;t see an option to change to a TTY, and the device/devices I&#39;m connecting to don&#39;t seem to have a way to turn the control chars off. This is also a Net::Telnet specific question, Super User probably would not have the answer I&#39;m looking for."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1473800705, "post_id": 39476478, "comment_id": 66277090, "body": "This is usually done by issuing a command on the device, not in Net::Telnet. Telnet isn&#39;t a secure protocol so you probably should use the SSH version, but you&#39;ll tell need to change the terminal type from VT-something or XTerm or Linux or ... to TTY."}, {"owner": {"reputation": 879, "user_id": 406470, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/07ac9d851e863e74ee0b8cee1af4ae2a?s=128&d=identicon&r=PG", "display_name": "redcodefinal", "link": "https://stackoverflow.com/users/406470/redcodefinal"}, "reply_to_user": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1473801990, "post_id": 39476478, "comment_id": 66277632, "body": "@theTinMan Yeah I was just hoping to not have to issue that command &quot;blind&quot;, I manage a lot of devices and they all have different setting and levels of privileges (some need to be enabled, some need to have &quot;configure&quot;, some require usernames and passes, some do not) and its really really frustrating to do all this blindly. There is a command I found after much digging to turn it off but the issue is that I already have to login and initiate everything without knowing exactly what&#39;s going on."}, {"owner": {"reputation": 150540, "user_id": 128421, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/71770d043c0f7e3c7bc5f74190015c26?s=128&d=identicon&r=PG", "display_name": "the Tin Man", "link": "https://stackoverflow.com/users/128421/the-tin-man"}, "edited": false, "score": 0, "creation_date": 1473810669, "post_id": 39476478, "comment_id": 66280185, "body": "That&#39;s a two-fold problem. Your networking people need to standardize on configurations is the first and bigger problem because automation doesn&#39;t work well with non-standardized environments. I work with a huge number of networking devices and it took about five years to get the networking people to understand why standards are so important. It&#39;s possible to make the code resilient and able to sense an environment but you shouldn&#39;t have to do that too much."}], "owner": {"reputation": 879, "user_id": 406470, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/07ac9d851e863e74ee0b8cee1af4ae2a?s=128&d=identicon&r=PG", "display_name": "redcodefinal", "link": "https://stackoverflow.com/users/406470/redcodefinal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 190, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1473795066, "creation_date": 1473790262, "last_edit_date": 1473795066, "question_id": 39476478, "link": "https://stackoverflow.com/questions/39476478/how-to-scrub-vt100-ansi-control-chars-in-nettelnet", "title": "How to scrub VT100/ANSI control chars in Net::Telnet", "body": "<p>I am using <code>Net::Telnet</code> to connect to a HP ProCurve Switch to login and backup the config. However I ran into issues where <code>waitfor</code> returns VT100/ANSI control chars:</p>\n\n<pre><code>&lt; 0x00000: ff fd 18 ff  fd 1f ff fb  01 1b 5b 32  4a 1b 5b 3f  ..........[2J.[?\n&lt; 0x00010: 37 6c 1b 5b  33 3b 32 33  72 1b 5b 3f  36 6c 1b 5b  7l.[3;23r.[?6l.[\n&lt; 0x00020: 31 3b 31 48  1b 5b 3f 32  35 6c 1b 5b  31 3b 31 48  1;1H.[?25l.[1;1H\n&lt; 0x00030: 48 50 20 4a  39 37 32 38  41 20 32 39  32 30 2d 34  HP J9728A 2920-4\n&lt; 0x00040: 38 47 20 53  77 69 74 63  68 0d 0d 0a  53 6f 66 74  8G Switch...Soft\n&lt; 0x00050: 77 61 72 65  20 72 65 76  69 73 69 6f  6e 20 57 42  ware revision WB\n&lt; 0x00060: 2e 31 35 2e  31 32 2e 30  30 31 35 0d  0d 0a 0d 0d  .15.12.0015.....\n&lt; 0x00070: 0a 43 6f 70  79 72 69 67  68 74 20 28  43 29 20 31  .Copyright (C) 1\n&lt; 0x00080: 39 39 31 2d  32 30 31 34  20 48 65 77  6c 65 74 74  991-2014 Hewlett\n&lt; 0x00090: 2d 50 61 63  6b 61 72 64  20 44 65 76  65 6c 6f 70  -Packard Develop\n&lt; 0x000a0: 6d 65 6e 74  20 43 6f 6d  70 61 6e 79  2c 20 4c 2e  ment Company, L.\n&lt; 0x000b0: 50 2e 0d 0a  0d 0a 20 20  20 20 20 20  20 20 20 20  P.....\n</code></pre>\n\n<p>Unfortunately, this screws up <code>waitfor</code> because if I try to <code>waitfor(/^password:/i)</code> it will return a string with those control chars in it, or wait forever since the regex is never matched. </p>\n\n<p>Is there any way to have <code>Net::Telnet</code> automatically remove those control characters? Is there any way to have <code>waitfor</code> only care about ASCII printable characters?</p>\n"}, {"tags": ["ruby", "amazon-web-services", "amazon-ec2", "aws-sdk"], "comments": [{"owner": {"reputation": 1713, "user_id": 2545197, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/zIDXo.jpg?s=128&g=1", "display_name": "Abhinay", "link": "https://stackoverflow.com/users/2545197/abhinay"}, "edited": false, "score": 0, "creation_date": 1473793038, "post_id": 39476332, "comment_id": 66273568, "body": "it says <code>events</code> invalid."}], "answers": [{"tags": [], "owner": {"reputation": 44774, "user_id": 4296747, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-muYS9LV5AoA/AAAAAAAAAAI/AAAAAAAACG4/KcTmlFyGWRI/photo.jpg?sz=128", "display_name": "Frederic Henri", "link": "https://stackoverflow.com/users/4296747/frederic-henri"}, "is_accepted": true, "score": 1, "last_activity_date": 1473793821, "creation_date": 1473793821, "answer_id": 39477346, "question_id": 39476332, "link": "https://stackoverflow.com/questions/39476332/ruby-aws-sdk-describe-instance-status-only-for-instances-with-events/39477346#39477346", "title": "Ruby aws-sdk describe-instance-status only for instances with events", "body": "<p>You have confused <code>Name</code> and <code>Values</code> in your code - it should be read as</p>\n\n<pre><code>ec2_events = ec2.describe_instance_status({\n  dry_run: false,\n  filters: [\n    {\n      name: \"event.description\",\n      values: [\"events\"],\n    },\n  ],\n})\n</code></pre>\n\n<p>You can check the full documentation <a href=\"http://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeInstanceStatus.html\" rel=\"nofollow\">http://docs.aws.amazon.com/AWSEC2/latest/APIReference/API_DescribeInstanceStatus.html</a></p>\n\n<p>Filter (<code>Name</code>) possible values are</p>\n\n<ul>\n<li><code>availability-zone</code> - The Availability Zone of the instance.</li>\n<li><code>event.code</code> - The code for the scheduled event (instance-reboot | system-reboot | system-maintenance | instance-retirement | instance-stop).</li>\n<li><code>event.description</code> - A description of the event.</li>\n<li><code>event.not-after</code> - The latest end time for the scheduled event (for example, 2014-09-15T17:15:20.000Z).</li>\n<li><code>event.not-before</code> - The earliest start time for the scheduled event (for example, 2014-09-15T17:15:20.000Z).</li>\n<li><code>instance-state-code</code> - The code for the instance state, as a 16-bit unsigned integer. The high byte is an opaque internal value and should be ignored. The low byte is set based on the state represented. The valid values are 0 (pending), 16 (running), 32 (shutting-down), 48 (terminated), 64 (stopping), and 80 (stopped).</li>\n<li><code>instance-state-name</code> - The state of the instance (pending | running | shutting-down | terminated | stopping | stopped).</li>\n<li><code>instance-status.reachability</code> - Filters on instance status where the name is reachability (passed | failed | initializing | insufficient-data).</li>\n<li><code>instance-status.status</code> - The status of the instance (ok | impaired | initializing | insufficient-data | not-applicable).</li>\n<li><code>system-status.reachability</code> - Filters on system status where the name is reachability (passed | failed | initializing | insufficient-data).</li>\n<li><code>system-status.status</code> - The system status of the instance (ok | impaired | initializing | insufficient-data | not-applicable).</li>\n</ul>\n"}], "owner": {"reputation": 3536, "user_id": 5314903, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/63b7f28e96e254a2618902d079e06dba?s=128&d=identicon&r=PG&f=1", "display_name": "Alex Cohen", "link": "https://stackoverflow.com/users/5314903/alex-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 539, "favorite_count": 0, "accepted_answer_id": 39477346, "answer_count": 1, "score": 0, "last_activity_date": 1473793821, "creation_date": 1473789674, "last_edit_date": 1495540304, "question_id": 39476332, "link": "https://stackoverflow.com/questions/39476332/ruby-aws-sdk-describe-instance-status-only-for-instances-with-events", "title": "Ruby aws-sdk describe-instance-status only for instances with events", "body": "<p>I would like to use the <a href=\"http://docs.aws.amazon.com/sdkforruby/api/Aws/EC2/Client.html\" rel=\"nofollow noreferrer\">ruby aws-sdk client</a> function <a href=\"http://docs.aws.amazon.com/sdkforruby/api/Aws/EC2/Client.html#describe_instance_status-instance_method\" rel=\"nofollow noreferrer\"><code>Aws::EC2::Client.describe-instance-status</code></a> to only return a list of instances with <a href=\"http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/monitoring-instances-status-check_sched.html\" rel=\"nofollow noreferrer\">Scheduled Events</a>.  Here is my current attempt at this:</p>\n\n<pre><code>ec2 = Aws::EC2::Client.new(\n  region: ENV['REGION'],\n  access_key_id: ENV['AWS_ACCESS_KEY_ID'],\n  secret_access_key: ENV['AWS_SECRET_ACCESS_KEY'],\n)\n\nec2_events = ec2.describe_instance_status({\n  dry_run: false,\n  filters: [\n    {\n      name: \"events\",\n      values: [\"event.description\"],\n    },\n  ],\n})\n</code></pre>\n\n<p>Here is my resulting error message:</p>\n\n<pre><code>/Users/myusername/.gems/gems/aws-sdk-core-2.5.11/lib/seahorse/client/plugins/raise_response_errors.rb:15:in `call': The filter 'events' is invalid (Aws::EC2::Errors::InvalidParameterValue)\n    from /Users/myusername/.gems/gems/aws-sdk-core-2.5.11/lib/aws-sdk-core/plugins/param_converter.rb:20:in `call'\n    from /Users/myusername/.gems/gems/aws-sdk-core-2.5.11/lib/aws-sdk-core/plugins/response_paging.rb:26:in `call'\n    from /Users/myusername/.gems/gems/aws-sdk-core-2.5.11/lib/seahorse/client/plugins/response_target.rb:21:in `call'\n    from /Users/myusername/.gems/gems/aws-sdk-core-2.5.11/lib/seahorse/client/request.rb:70:in `send_request'\n    from /Users/myusername/.gems/gems/aws-sdk-core-2.5.11/lib/seahorse/client/base.rb:207:in `block (2 levels) in define_operation_methods'\n    from test.rb:30:in `&lt;main&gt;'    \n</code></pre>\n\n<p>Is there a simple way to have aws-sdk praise out only the instances with Scheduled Events?  I know that the regular aws cli tool has this <a href=\"https://stackoverflow.com/questions/39300976/aws-ec2-describe-instance-status-only-for-instances-with-events\">option</a>, but I really want to use the aws-sdk gem instead.</p>\n"}, {"tags": ["ruby", "google-calendar-api", "gmail-api"], "comments": [{"owner": {"reputation": 19244, "user_id": 1978251, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/73f7dd539ad8ec8372af0d06e4f76939?s=128&d=identicon&r=PG", "display_name": "engineersmnky", "link": "https://stackoverflow.com/users/1978251/engineersmnky"}, "edited": false, "score": 0, "creation_date": 1473791075, "post_id": 39476276, "comment_id": 66272548, "body": "I don&#39;t believe they have an expiry as I believe they are just a pointer to an index. This means that if page 1 returns results 1-30 and then 10 items are added the <code>nextPageToken</code> will return results 21-50 of the original set.(31-60 of the new set)"}], "answers": [{"comments": [{"owner": {"reputation": 149, "user_id": 6806302, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Xb-IjD37XkM/AAAAAAAAAAI/AAAAAAAAAAk/jaWiPbF5KTo/photo.jpg?sz=128", "display_name": "Cory Boyd", "link": "https://stackoverflow.com/users/6806302/cory-boyd"}, "edited": false, "score": 0, "creation_date": 1473881553, "post_id": 39488332, "comment_id": 66314120, "body": "Is this officially documented somewhere?"}], "tags": [], "owner": {"reputation": 608, "user_id": 4823789, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/16701fdace0347de7dbf1c356d295e76?s=128&d=identicon&r=PG&f=1", "display_name": "ND003", "link": "https://stackoverflow.com/users/4823789/nd003"}, "is_accepted": true, "score": 0, "last_activity_date": 1473849462, "creation_date": 1473849462, "answer_id": 39488332, "question_id": 39476276, "link": "https://stackoverflow.com/questions/39476276/how-long-are-nextpagetokens-remembered-for-gmail-and-calendar-apis/39488332#39488332", "title": "How long are nextPageTokens remembered for Gmail and Calendar APIs?", "body": "<p><code>nextPageToken</code> does not expire. It is just like an Index position. However if new items are added/deleted, you might not see the same result as you expect.</p>\n"}, {"tags": [], "owner": {"reputation": 25, "user_id": 10110782, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8968fc699f465f64fa16aad946c71684?s=128&d=identicon&r=PG&f=1", "display_name": "Mujtaba", "link": "https://stackoverflow.com/users/10110782/mujtaba"}, "is_accepted": false, "score": 0, "last_activity_date": 1611123913, "creation_date": 1611123913, "answer_id": 65804118, "question_id": 39476276, "link": "https://stackoverflow.com/questions/39476276/how-long-are-nextpagetokens-remembered-for-gmail-and-calendar-apis/65804118#65804118", "title": "How long are nextPageTokens remembered for Gmail and Calendar APIs?", "body": "<p>The token expires after 1 Hour. I came to know about that while working with Google Directory API. <a href=\"https://stackoverflow.com/questions/64661575/nextpagetoken-gives-invalid-input-error-400-google-directory-api-chomedevices\">Link</a> to the problem I faced.</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 5858563, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-f2FJYvNQhk8/AAAAAAAAAAI/AAAAAAAAADY/WTwIVJDwlxA/photo.jpg?sz=128", "display_name": "Rahul Sambyal", "link": "https://stackoverflow.com/users/5858563/rahul-sambyal"}, "is_accepted": false, "score": 0, "last_activity_date": 1616439054, "creation_date": 1616439054, "answer_id": 66752151, "question_id": 39476276, "link": "https://stackoverflow.com/questions/39476276/how-long-are-nextpagetokens-remembered-for-gmail-and-calendar-apis/66752151#66752151", "title": "How long are nextPageTokens remembered for Gmail and Calendar APIs?", "body": "<p>Pagination tokens expire after a certain amount of time. The time duration varies with respect to servers. Some might expire in minutes whereas some might last 24 hours. Couldn't find exact validity for Google's token but as <a href=\"https://stackoverflow.com/users/10110782/mujtaba\">Mujtaba</a> experienced, it might be set to 1 hour. You could try setting yours to less than that as a precaution.</p>\n"}], "owner": {"reputation": 149, "user_id": 6806302, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Xb-IjD37XkM/AAAAAAAAAAI/AAAAAAAAAAk/jaWiPbF5KTo/photo.jpg?sz=128", "display_name": "Cory Boyd", "link": "https://stackoverflow.com/users/6806302/cory-boyd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 336, "favorite_count": 0, "accepted_answer_id": 39488332, "answer_count": 3, "score": 4, "last_activity_date": 1616439054, "creation_date": 1473789511, "question_id": 39476276, "link": "https://stackoverflow.com/questions/39476276/how-long-are-nextpagetokens-remembered-for-gmail-and-calendar-apis", "title": "How long are nextPageTokens remembered for Gmail and Calendar APIs?", "body": "<p>The Gmail and Calendar APIs return a <code>nextPageToken</code> value in the response from the <code>users.messages.list</code> and <code>events.list</code> endpoints when pagination is required. If the value of the <code>nextPageToken</code> is provided in the next request to these endpoints, the next page of results is returned.</p>\n\n<p><strong>My question</strong>: How long are these <code>nextPageToken</code>s persisted behind the Gmail and Calendar APIs?</p>\n\n<p><strong>Context</strong>: I am building an abstraction on top of both the Gmail and Calendar APIs to return a list of Activities, and this endpoint has its own pagination. My pagination works by storing the <code>nextPageToken</code> values returned by the Gmail and Calendar APIs in a cache and returning a UUID the client can specify in the next request to pop and use those Gmail and Calendar <code>nextPageToken</code>s (just like the Google APIs themselves).</p>\n\n<p><strong>Goal</strong>: Configure my pagination cache TTL to, at most, be equal to the TTL (if there is one) of the Google APIs so that it always works as intended.</p>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 3, "creation_date": 1473789212, "post_id": 39476169, "comment_id": 66271601, "body": "You can pass a block to <i>any</i> method. It&#39;s up to the method to invoke it or check for its presence."}, {"owner": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1473789260, "post_id": 39476169, "comment_id": 66271632, "body": "BTW, I pretty sure this has been ask before. Can anyone find the duplicate?"}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 95812, "user_id": 477037, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/dde78fe4cdc16eb855d68ff7a8cd017d?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/477037/stefan"}, "edited": false, "score": 0, "creation_date": 1473789326, "post_id": 39476169, "comment_id": 66271667, "body": "@Stefan: yeah, should&#39;ve been asked and answered a number of times. Tried several queries, failed to produce a match. :/"}], "answers": [{"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 1, "creation_date": 1473791680, "post_id": 39476207, "comment_id": 66272870, "body": "And why does Ruby simply disregard the block? Because she does not know whether the method will yield to the block, which, for example, may depend on the result of conditional expressions. Moreover, there&#39;s no point for her to examine the built-in method <a href=\"http://ruby-doc.org/core-2.3.0/Array.html#method-i-first\" rel=\"nofollow noreferrer\">Array#first</a>, as any method may be modified at runtime."}, {"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1473836892, "post_id": 39476207, "comment_id": 66287122, "body": "@CarySwoveland: you think it&#39;s a she? :)"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1473864496, "post_id": 39476207, "comment_id": 66304389, "body": "I guess if there&#39;s a <a href=\"https://www.youtube.com/watch?v=ZR5XGTpophI\" rel=\"nofollow noreferrer\">Boy Named &quot;Sue&quot;</a> there might be another named &quot;Ruby&quot;, but..."}], "tags": [], "owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "is_accepted": true, "score": 7, "last_activity_date": 1473789220, "creation_date": 1473789220, "answer_id": 39476207, "question_id": 39476169, "link": "https://stackoverflow.com/questions/39476169/what-does-the-block-argument-to-arrayfirst-do/39476207#39476207", "title": "What does the block argument to Array#first do?", "body": "<p>You can pass blocks to any method, absolutely any. If it doesn't need the block, it simply won't use it. It is not an error (because block is not one of the arguments. It's a separate input for a method)</p>\n"}, {"tags": [], "owner": {"reputation": 193600, "user_id": 87189, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/98e7d6edce863e7a1bf8199b082eb25e?s=128&d=identicon&r=PG", "display_name": "tadman", "link": "https://stackoverflow.com/users/87189/tadman"}, "is_accepted": false, "score": 2, "last_activity_date": 1473790123, "creation_date": 1473790123, "answer_id": 39476444, "question_id": 39476169, "link": "https://stackoverflow.com/questions/39476169/what-does-the-block-argument-to-arrayfirst-do/39476444#39476444", "title": "What does the block argument to Array#first do?", "body": "<p>There's some simple rules about Ruby and blocks.</p>\n\n<ol>\n<li><p>You can pass a block to any method.</p></li>\n<li><p>That method may choose to run your block <em>zero or more times</em> at any point in time from the present to the distant future.</p></li>\n<li><p>You must read the documentation or method implementation to understand if, how and when a block will be exercised. There is no other way of knowing.</p></li>\n</ol>\n\n<p>Your example here of passing a block to a method that's not expecting one is consistent with these rules. Effectively it's being run zero times and has no bearing on the outcome of the <code>first</code> call.</p>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 5739718, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T5aEJIQnyfk/AAAAAAAAAAI/AAAAAAAAABg/P_Z18q3Js5s/photo.jpg?sz=128", "display_name": "ashan priyadarshana", "link": "https://stackoverflow.com/users/5739718/ashan-priyadarshana"}, "is_accepted": false, "score": 0, "last_activity_date": 1473795536, "creation_date": 1473795536, "answer_id": 39477781, "question_id": 39476169, "link": "https://stackoverflow.com/questions/39476169/what-does-the-block-argument-to-arrayfirst-do/39477781#39477781", "title": "What does the block argument to Array#first do?", "body": "<p>you can get the result by doing some thing like below.</p>\n\n<pre><code>def get_first_even(arr)\nif arr.first % 2 == 0\n    first_even_num = arr.first\n    puts first_even_num\nelse\n    arr.delete_at 0\n    get_first_even arr\nend\nend\n\nget_first_even [1,3,5,7,9,23,13,14,11,12]   \n</code></pre>\n"}], "owner": {"reputation": 23016, "user_id": 2981429, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/ZcCXx.jpg?s=128&g=1", "display_name": "max pleaner", "link": "https://stackoverflow.com/users/2981429/max-pleaner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 39476207, "answer_count": 3, "score": 3, "last_activity_date": 1473795536, "creation_date": 1473789079, "question_id": 39476169, "link": "https://stackoverflow.com/questions/39476169/what-does-the-block-argument-to-arrayfirst-do", "title": "What does the block argument to Array#first do?", "body": "<p>My memory got the worst of me and I forgot about <code>Array#find</code>.</p>\n\n<p>So I wrote some code which used <code>Array#first</code> to get the first item matching a condition:</p>\n\n<pre><code>first_even_num = [1,2,3].first { |x| x % 2 == 0 }\n</code></pre>\n\n<p>This does not work, it just returns the first element of the array no matter what the condition is. The block is not being called at all:</p>\n\n<pre><code>[1,2,3].first { |x| exit }\nputs \"the program did not exit\"\n</code></pre>\n\n<p>I've accepted that <code>Array#first</code> does not do what imagined it to, but I'm curious why the aforementioned examples don't raise errors.</p>\n\n<p>Looking at the <a href=\"https://ruby-doc.org/core-2.3.0/Array.html#method-i-first\" rel=\"nofollow\">2.3.1</a> source, the only documented argument is an integer representing the number of returned results. </p>\n\n<p>I don't really know C but this is what the underlying <code>Array#first</code> method has as a parameter signature:</p>\n\n<pre><code>rb_ary_first(int argc, VALUE *argv, VALUE ary)\n</code></pre>\n\n<p>I'm just wondering why the block provided to <code>Array#first</code> does not raise an error if it does nothing. </p>\n"}, {"tags": ["ruby", "multithreading", "rubinius"], "answers": [{"tags": [], "owner": {"reputation": 90, "user_id": 2682818, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/c4ee39b98ec3f9b759d4d22d1da04844?s=128&d=identicon&r=PG&f=1", "display_name": "Chuck Remes", "link": "https://stackoverflow.com/users/2682818/chuck-remes"}, "is_accepted": false, "score": 0, "last_activity_date": 1474305873, "creation_date": 1474305873, "answer_id": 39578789, "question_id": 39475025, "link": "https://stackoverflow.com/questions/39475025/how-can-i-do-a-thread-dump-in-rubinius/39578789#39578789", "title": "How can I do a thread dump in rubinius?", "body": "<p>You should take a look at the Rubinius Book which documents some of the new tools.  Specifically, check this out:  <a href=\"https://book.rubinius.com/manuscript/inspectability.html\" rel=\"nofollow\">https://book.rubinius.com/manuscript/inspectability.html</a></p>\n\n<p>I generally run my code using the example given at the bottom of that page:</p>\n\n<pre><code>rbx -Xsystem.diagnostics.target='./diagnostics-$PID.json' -Xsystem.profiler.target=diagnostics some_script.rb\n</code></pre>\n\n<p>This will write statistics, including a thread profile, to the json file.</p>\n\n<p>If that isn't enough information, stop on by the <a href=\"https://gitter.im/rubinius/rubinius\" rel=\"nofollow\">Gitter</a> room where many Rubinius users hang out and ask for help. </p>\n"}], "owner": {"reputation": 136, "user_id": 2660471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad0c5610aa6a1331549e6431b645e801?s=128&d=identicon&r=PG", "display_name": "Joe Douglas", "link": "https://stackoverflow.com/users/2660471/joe-douglas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474305873, "creation_date": 1473784692, "question_id": 39475025, "link": "https://stackoverflow.com/questions/39475025/how-can-i-do-a-thread-dump-in-rubinius", "title": "How can I do a thread dump in rubinius?", "body": "<p>I want to do a thread dump of my rubinius app to help investigate an apparent deadlock issue. My app is using rbx-3.21, and I'd prefer not to change that if possible.</p>\n\n<p>I've tried doing a pure ruby solution like the one described <a href=\"http://www.mikeperham.com/2012/06/02/debugging-with-thread-dumps/\" rel=\"nofollow\">here</a>, but the thread backtraces don't work properly - they all appear the same as the thread performing the stack dump. The result looks something like this:</p>\n\n<pre><code>Thread-1uvk\ncommon/service.rb:192:in `dump_threads'\n  common/service.rb:190:in `dump_threads'\n  common/service.rb:90:in `prepare_status'\n\nThread-1uvs\ncommon/service.rb:192:in `dump_threads'\n  common/service.rb:190:in `dump_threads'\n  common/service.rb:90:in `prepare_status'\n\n....etc\n</code></pre>\n"}, {"tags": ["ruby"], "comments": [{"owner": {"reputation": 1850, "user_id": 5281047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/R6JZs.png?s=128&g=1", "display_name": "Gabriel", "link": "https://stackoverflow.com/users/5281047/gabriel"}, "edited": false, "score": 0, "creation_date": 1473785105, "post_id": 39475011, "comment_id": 66269461, "body": "Do you want a deep copy of a variable?"}, {"owner": {"reputation": 16672, "user_id": 22237, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/hkobD.png?s=128&g=1", "display_name": "Kris", "link": "https://stackoverflow.com/users/22237/kris"}, "edited": false, "score": 0, "creation_date": 1473789529, "post_id": 39475011, "comment_id": 66271794, "body": "duplicate? <a href=\"http://stackoverflow.com/questions/8710642/ruby-dup-clone-recursively\" title=\"ruby dup clone recursively\">stackoverflow.com/questions/8710642/ruby-dup-clone-recursive&zwnj;&#8203;ly</a>"}], "answers": [{"comments": [{"owner": {"reputation": 880, "user_id": 5279080, "user_type": "registered", "accept_rate": 68, "profile_image": "https://lh5.googleusercontent.com/-LoDm6XYbQug/AAAAAAAAAAI/AAAAAAAAABE/t33anFH2T3I/photo.jpg?sz=128", "display_name": "alilland", "link": "https://stackoverflow.com/users/5279080/alilland"}, "edited": false, "score": 0, "creation_date": 1473785843, "post_id": 39475103, "comment_id": 66269817, "body": "thanks, for my own knowledge can I ask what the difference is between a shallow copy and a deep copy?"}, {"owner": {"reputation": 1513, "user_id": 1334750, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/0vTHg.png?s=128&g=1", "display_name": "Pawe\u0142 Duda", "link": "https://stackoverflow.com/users/1334750/pawe%c5%82-duda"}, "reply_to_user": {"reputation": 880, "user_id": 5279080, "user_type": "registered", "accept_rate": 68, "profile_image": "https://lh5.googleusercontent.com/-LoDm6XYbQug/AAAAAAAAAAI/AAAAAAAAABE/t33anFH2T3I/photo.jpg?sz=128", "display_name": "alilland", "link": "https://stackoverflow.com/users/5279080/alilland"}, "edited": false, "score": 0, "creation_date": 1473787178, "post_id": 39475103, "comment_id": 66270478, "body": "@alilland Unlike shallow copy, deep copy will also copy any referenced objects in your data structure."}], "tags": [], "owner": {"reputation": 1513, "user_id": 1334750, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/0vTHg.png?s=128&g=1", "display_name": "Pawe\u0142 Duda", "link": "https://stackoverflow.com/users/1334750/pawe%c5%82-duda"}, "is_accepted": true, "score": 1, "last_activity_date": 1473784935, "creation_date": 1473784935, "answer_id": 39475103, "question_id": 39475011, "link": "https://stackoverflow.com/questions/39475011/how-can-i-duplicate-a-record-with-ruby-outside-of-rails/39475103#39475103", "title": "How can i duplicate a record with ruby (outside of rails)?", "body": "<p>This will do a shallow copy of an object:</p>\n\n<pre><code> obj2 = obj.clone\n</code></pre>\n\n<p>This will do a deep copy of an object:</p>\n\n<pre><code>  obj2 = Marshal.load(Marshal.dump(obj))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 39282, "user_id": 336920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6e2dbeb23d3fc6552a6e26800ed63289?s=128&d=identicon&r=PG", "display_name": "B Seven", "link": "https://stackoverflow.com/users/336920/b-seven"}, "is_accepted": false, "score": 0, "last_activity_date": 1473786569, "creation_date": 1473786569, "answer_id": 39475496, "question_id": 39475011, "link": "https://stackoverflow.com/questions/39475011/how-can-i-duplicate-a-record-with-ruby-outside-of-rails/39475496#39475496", "title": "How can i duplicate a record with ruby (outside of rails)?", "body": "<p>You can use <code>dup</code>.</p>\n\n<pre><code>h = {a:1}\nh2 = h.dup\nh[:a] = 2\nh2\n=&gt; {:a=&gt;1}\n</code></pre>\n\n<p><code>h</code> and <code>h2</code> have different object_id's.</p>\n\n<p>From <a href=\"https://ruby-doc.org/core-2.3.1/Object.html#method-i-dup\" rel=\"nofollow\">dup reference</a>:</p>\n\n<blockquote>\n  <p>Produces a shallow copy of obj\u2014the instance variables of obj are copied, but not the objects they reference.</p>\n</blockquote>\n"}], "owner": {"reputation": 880, "user_id": 5279080, "user_type": "registered", "accept_rate": 68, "profile_image": "https://lh5.googleusercontent.com/-LoDm6XYbQug/AAAAAAAAAAI/AAAAAAAAABE/t33anFH2T3I/photo.jpg?sz=128", "display_name": "alilland", "link": "https://stackoverflow.com/users/5279080/alilland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 39475103, "answer_count": 2, "score": 0, "last_activity_date": 1473786569, "creation_date": 1473784648, "question_id": 39475011, "link": "https://stackoverflow.com/questions/39475011/how-can-i-duplicate-a-record-with-ruby-outside-of-rails", "title": "How can i duplicate a record with ruby (outside of rails)?", "body": "<p>I have a hash with an object id of 19475160, I need to clone my hash, how would I go about doing this? Every google search and article I have found points me to rails solutions but I cant find anything that is a regular ruby solution.</p>\n"}, {"tags": ["python", "ruby", "heroku", "buildpack"], "comments": [{"owner": {"reputation": 12542, "user_id": 156746, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8TsPx.jpg?s=128&g=1", "display_name": "DiegoSalazar", "link": "https://stackoverflow.com/users/156746/diegosalazar"}, "edited": false, "score": 0, "creation_date": 1473789853, "post_id": 39474881, "comment_id": 66271970, "body": "Have you tried running it?"}, {"owner": {"reputation": 1, "user_id": 4883676, "user_type": "registered", "profile_image": "https://graph.facebook.com/1066429860037019/picture?type=large", "display_name": "wen94319", "link": "https://stackoverflow.com/users/4883676/wen94319"}, "reply_to_user": {"reputation": 12542, "user_id": 156746, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8TsPx.jpg?s=128&g=1", "display_name": "DiegoSalazar", "link": "https://stackoverflow.com/users/156746/diegosalazar"}, "edited": false, "score": 0, "creation_date": 1473819516, "post_id": 39474881, "comment_id": 66282042, "body": "It works well in my local terminal, but when I put it on heroku , it just crashes (I think it&#39;s because there contains python script but I only choose Ruby for this app in the begining)."}, {"owner": {"reputation": 12542, "user_id": 156746, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/8TsPx.jpg?s=128&g=1", "display_name": "DiegoSalazar", "link": "https://stackoverflow.com/users/156746/diegosalazar"}, "edited": false, "score": 0, "creation_date": 1473865373, "post_id": 39474881, "comment_id": 66305013, "body": "On my free tier Heroku dyno I am able to run Python:  <code>Running rails console on \u2b22 free-tier-dyno... up, run.9094 Loading production environment (Rails 4.2.7.1) [1] pry(main)&gt; `python --version` Python 2.7.6 =&gt; &quot;&quot; [2] pry(main)&gt; `python -c &#39;print &quot;hello&quot;&#39;` =&gt; &quot;hello\\n&quot;</code> Maybe your python scripts don&#39;t support python 2? Do you get an error in the heroku log?"}], "owner": {"reputation": 1, "user_id": 4883676, "user_type": "registered", "profile_image": "https://graph.facebook.com/1066429860037019/picture?type=large", "display_name": "wen94319", "link": "https://stackoverflow.com/users/4883676/wen94319"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 98, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1473815026, "creation_date": 1473784145, "last_edit_date": 1473815026, "question_id": 39474881, "link": "https://stackoverflow.com/questions/39474881/how-to-run-a-ruby-app-which-contains-some-python-scripts23-on-heroku", "title": "How to run a ruby app which contains some python scripts(2&amp;3) on heroku", "body": "<p>I have a Ruby app which I want to run it on Heroku.\nBut it contains some python code, and its structure is as below</p>\n\n<pre><code>|\n|__ config\n| \n|__ controllers\n|\n|__ helpers\n|      |\n|      |__task1.py\n|      |__task2.py\n| \n|\n|__ models\n|\n|__ services\n    |__callpython1.rb\n    |__callpython2.rb\n    |__   ....\n    |__   ....\n    |__   ....\n</code></pre>\n\n<p>In services directory, callpython1.rb will call task1.py ,</p>\n\n<p>(use ruby code : ` python helpers/task1.py \"#{Argument}\" `)</p>\n\n<p>And callpython2.rb will call task2.py</p>\n\n<p>(use ruby code : `python3 helpers/task2.py \"#{Argument}\" `)</p>\n\n<p>So how should I do to run such app like this which is mainly in Ruby but sometimes it\nneeds to call some python script on heroku?</p>\n"}, {"tags": ["ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1473783962, "post_id": 39474771, "comment_id": 66268878, "body": "Either install ruby 2.1.4 and use it. Or update your gemfile to use ruby 2.3.1 (something might not work here, if not all of your code is compatible with 2.3.1)"}, {"owner": {"reputation": 9572, "user_id": 2305826, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xRwWw.png?s=128&g=1", "display_name": "MarsAtomic", "link": "https://stackoverflow.com/users/2305826/marsatomic"}, "edited": false, "score": 0, "creation_date": 1473784991, "post_id": 39474771, "comment_id": 66269406, "body": "Are you using RVM or something like that to support different versions of Ruby on your machine?"}, {"owner": {"reputation": 39282, "user_id": 336920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6e2dbeb23d3fc6552a6e26800ed63289?s=128&d=identicon&r=PG", "display_name": "B Seven", "link": "https://stackoverflow.com/users/336920/b-seven"}, "reply_to_user": {"reputation": 9572, "user_id": 2305826, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/xRwWw.png?s=128&g=1", "display_name": "MarsAtomic", "link": "https://stackoverflow.com/users/2305826/marsatomic"}, "edited": false, "score": 0, "creation_date": 1473786074, "post_id": 39474771, "comment_id": 66269922, "body": "@MarsAtomic - He is using rbenv."}, {"owner": {"reputation": 361, "user_id": 5513918, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/RAhi6.png?s=128&g=1", "display_name": "Ryuuks", "link": "https://stackoverflow.com/users/5513918/ryuuks"}, "edited": false, "score": 0, "creation_date": 1473786231, "post_id": 39474771, "comment_id": 66270010, "body": "I tried to install 2.1.4 but it didn&#39;t work for some reason, probably cause I&#39;m doing it wrong. I can&#39;t update the gemfile, has to be 2.1.4"}], "answers": [{"comments": [{"owner": {"reputation": 361, "user_id": 5513918, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/RAhi6.png?s=128&g=1", "display_name": "Ryuuks", "link": "https://stackoverflow.com/users/5513918/ryuuks"}, "edited": false, "score": 0, "creation_date": 1473788479, "post_id": 39475428, "comment_id": 66271157, "body": "<code># rbenv install 2.1.4 rbenv: &#47;home&#47;ricardo&#47;.rbenv&#47;versions&#47;2.1.4 already exists continue with installation? (y&#47;N) y Downloading ruby-2.1.4.tar.bz2... -&gt; https:&#47;&#47;cache.ruby-lang.org&#47;pub&#47;ruby&#47;2.1&#47;ruby-2.1.4.tar.bz2 Installing ruby-2.1.4...  WARNING: ruby-2.1.4 is nearing its end of life. It only receives critical security updates, no bug fixes.  Installed ruby-2.1.4 to &#47;home&#47;ricardo&#47;.rbenv&#47;versions&#47;2.1.4</code>"}, {"owner": {"reputation": 361, "user_id": 5513918, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/RAhi6.png?s=128&g=1", "display_name": "Ryuuks", "link": "https://stackoverflow.com/users/5513918/ryuuks"}, "edited": false, "score": 0, "creation_date": 1473850175, "post_id": 39475428, "comment_id": 66294808, "body": "It worked, but now I have loop issue: when I set it to 2.1.4 it says The `rails&#39; command exists in these Ruby versions: 2.3.1, but if I set it to 2.3.1 it says Your Ruby version is 2.3.1, but your Gemfile specified 2.1.4 ... And I know it worked on this laptop with the same gemfile before"}, {"owner": {"reputation": 39282, "user_id": 336920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6e2dbeb23d3fc6552a6e26800ed63289?s=128&d=identicon&r=PG", "display_name": "B Seven", "link": "https://stackoverflow.com/users/336920/b-seven"}, "reply_to_user": {"reputation": 361, "user_id": 5513918, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/RAhi6.png?s=128&g=1", "display_name": "Ryuuks", "link": "https://stackoverflow.com/users/5513918/ryuuks"}, "edited": false, "score": 0, "creation_date": 1473876244, "post_id": 39475428, "comment_id": 66311331, "body": "<code>gem install bundler; bundle</code>"}], "tags": [], "owner": {"reputation": 39282, "user_id": 336920, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6e2dbeb23d3fc6552a6e26800ed63289?s=128&d=identicon&r=PG", "display_name": "B Seven", "link": "https://stackoverflow.com/users/336920/b-seven"}, "is_accepted": false, "score": 2, "last_activity_date": 1473803966, "last_edit_date": 1473803966, "creation_date": 1473786275, "answer_id": 39475428, "question_id": 39474771, "link": "https://stackoverflow.com/questions/39474771/your-ruby-version-is-2-3-1-but-your-gemfile-specified-2-1-4/39475428#39475428", "title": "Your Ruby version is 2.3.1, but your Gemfile specified 2.1.4", "body": "<p>As Sergio pointed you, you need to update your Ruby or your Gemfile.</p>\n\n<p>In my experience, there are not a lot of major changes between Ruby 2.1 and 2.3, so I suggest updating your Gemfile.</p>\n\n<p>If you don't want to do that, then here is how to install Ruby 2.1.4:</p>\n\n<pre><code>rbenv install 2.1.4\n</code></pre>\n\n<p>Also, be sure to set the version:</p>\n\n<pre><code>rbenv local 2.1.4\n\nruby -v\n</code></pre>\n\n<p>Should return 2.1.4</p>\n\n<p><a href=\"https://github.com/rbenv/rbenv#installing-ruby-versions\" rel=\"nofollow\">rbenv reference</a></p>\n"}, {"tags": [], "owner": {"reputation": 17, "user_id": 6877595, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fdc70c04df32cd1c94dbd0095713fb74?s=128&d=identicon&r=PG&f=1", "display_name": "jay.pepper", "link": "https://stackoverflow.com/users/6877595/jay-pepper"}, "is_accepted": false, "score": 0, "last_activity_date": 1481907596, "creation_date": 1481907596, "answer_id": 41189103, "question_id": 39474771, "link": "https://stackoverflow.com/questions/39474771/your-ruby-version-is-2-3-1-but-your-gemfile-specified-2-1-4/41189103#41189103", "title": "Your Ruby version is 2.3.1, but your Gemfile specified 2.1.4", "body": "<pre><code>rvm --default use 2.1.4\n\nrvm use 2.1.4@\"folder name\" --create\n</code></pre>\n"}], "owner": {"reputation": 361, "user_id": 5513918, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/RAhi6.png?s=128&g=1", "display_name": "Ryuuks", "link": "https://stackoverflow.com/users/5513918/ryuuks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1486, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1481907596, "creation_date": 1473783722, "question_id": 39474771, "link": "https://stackoverflow.com/questions/39474771/your-ruby-version-is-2-3-1-but-your-gemfile-specified-2-1-4", "title": "Your Ruby version is 2.3.1, but your Gemfile specified 2.1.4", "body": "<p>I'm sure this is a very common question, but I can't make it work even after following several tutorials about it.\nI'm using Ubuntu 16.04 lts and I just installed Ruby on Rails with Rbenv, but then, after running <code>rails server</code> I get the <code>Your Ruby version is 2.3.1, but your Gemfile specified 2.1.4</code> message. \nHow can I make it work?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ubuntu", "rubygems"], "comments": [{"owner": {"reputation": 794, "user_id": 1839692, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/3pZBl.jpg?s=128&g=1", "display_name": "Raphael Pr", "link": "https://stackoverflow.com/users/1839692/raphael-pr"}, "edited": false, "score": 2, "creation_date": 1473785875, "post_id": 39474633, "comment_id": 66269833, "body": "I guess you are using the ruby system. You have to be sudo to install gems. Have you tried to use rvm / rbenv to install ruby. Gems are stored in your user folder (therefore no sudo right needed)."}, {"owner": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "edited": false, "score": 0, "creation_date": 1473790146, "post_id": 39474633, "comment_id": 66272121, "body": "I recommend using rvm too (see my answer) and btw stay on LTS versions of ubuntu (14.04, 16.04, 18.04, ...)."}], "answers": [{"tags": [], "owner": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "is_accepted": false, "score": 0, "last_activity_date": 1473790017, "creation_date": 1473790017, "answer_id": 39476422, "question_id": 39474633, "link": "https://stackoverflow.com/questions/39474633/cant-install-ruby-on-rails-in-ubuntu-gnome-15-10/39476422#39476422", "title": "Can&#39;t install ruby on rails in ubuntu gnome 15.10", "body": "<p><code>gem install</code> tries to put files in \"system-wide\" directories. These are protected, such that only the <code>root</code> user can write into.</p>\n\n<p>You have at least three possibilities:</p>\n\n<ul>\n<li><code>sudo gem install ...</code>, this will write the gem files into /usr/local/lib/ruby/gems/2.3.0</li>\n<li><code>gem install --user-install</code>, this will install the gem \"locally\" in your users home directory</li>\n<li><code>apt-get install ruby-rails</code> (not sure about the package name), which will install the ruby on rails version maintained by your distributions maintainers (Canonical).</li>\n<li><em>install and use <code>rvm</code></em> or <code>rbenv</code> (and there might be other options). Afterwards <code>gem install</code> will usually just work and install the gems <strong>for your user only</strong></li>\n</ul>\n\n<p>While the <code>rvm</code> setup might be a tiny bit confusing for newbies, I recommend using that approach. It will make updating and installing ruby, gems and different versions of it really easy.</p>\n"}], "owner": {"reputation": 1, "user_id": 6827270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab7bf135433cac38e66519dbbc6e45a0?s=128&d=identicon&r=PG&f=1", "display_name": "ihavenoidea", "link": "https://stackoverflow.com/users/6827270/ihavenoidea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473790017, "creation_date": 1473783177, "last_edit_date": 1473783558, "question_id": 39474633, "link": "https://stackoverflow.com/questions/39474633/cant-install-ruby-on-rails-in-ubuntu-gnome-15-10", "title": "Can&#39;t install ruby on rails in ubuntu gnome 15.10", "body": "<p>I am trying to install ruby on rails. I'm at version 2.3.0 for <code>ruby</code> and <code>gem</code> version of 2.5.1. </p>\n\n<p>When I run the command <code>gem install rails</code> I get an error that says:</p>\n\n<blockquote>\n  <p>ERROR:  While executing gem ... (Gem::FilePermissionError)     You don't have write permissions for the /usr/local/lib/ruby/gems/2.3.0 directory.</p>\n</blockquote>\n\n<p>How can I fix this?</p>\n"}, {"tags": ["ruby-on-rails", "arrays", "json", "ruby", "hash"], "answers": [{"comments": [{"owner": {"reputation": 1217, "user_id": 1180008, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/FdMdK.jpg?s=128&g=1", "display_name": "Nubtacular", "link": "https://stackoverflow.com/users/1180008/nubtacular"}, "edited": false, "score": 0, "creation_date": 1473783601, "post_id": 39474666, "comment_id": 66268684, "body": "So that works just fine in Rails console, but when I run it in the browser I&#39;m getting <code>undefined method &#39;merge!&#39; for #&lt;Customer &gt;</code>. Why would that be?"}], "tags": [], "owner": {"reputation": 4265, "user_id": 4601088, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bN143.jpg?s=128&g=1", "display_name": "Bart\u0142omiej G\u0142adys", "link": "https://stackoverflow.com/users/4601088/bart%c5%82omiej-g%c5%82adys"}, "is_accepted": false, "score": 1, "last_activity_date": 1473783342, "creation_date": 1473783342, "answer_id": 39474666, "question_id": 39474536, "link": "https://stackoverflow.com/questions/39474536/rails-4-and-returning-json-response-how-to-correctly-append-extra-data/39474666#39474666", "title": "Rails 4 and returning JSON response: how to correctly append extra data?", "body": "<p>maybe combine <code>each</code> and <code>merge</code> </p>\n\n<pre><code>base = [\n    {\n        \"AccountCode\": \"111123456\",\n        \"AccountID\": 123456,\n        \"BalanceCurrent\": \"-8.0\",\n        \"Phone\": \"123456888\",\n    }\n]\n\ndata = {:match_found=&gt;true, :transfer_flag=&gt;false, :confirm_id=&gt;2}\n\nbase.each { |el| el.merge!(data) }\n#=&gt; [{:AccountCode=&gt;\"111123456\", :AccountID=&gt;123456, :BalanceCurrent=&gt;\"-8.0\", :Phone=&gt;\"123456888\", :match_found=&gt;true, :transfer_flag=&gt;false, :confirm_id=&gt;2}]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 64, "user_id": 6823814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1MmQW.jpg?s=128&g=1", "display_name": "Gustavo Fe", "link": "https://stackoverflow.com/users/6823814/gustavo-fe"}, "is_accepted": false, "score": 1, "last_activity_date": 1473789369, "creation_date": 1473789369, "answer_id": 39476241, "question_id": 39474536, "link": "https://stackoverflow.com/questions/39474536/rails-4-and-returning-json-response-how-to-correctly-append-extra-data/39476241#39476241", "title": "Rails 4 and returning JSON response: how to correctly append extra data?", "body": "<p>You can add <code>attr_accessor</code> to your Customer model like this</p>\n\n<pre><code>class Customer\n    attr_accessor :data\nend\n</code></pre>\n\n<p>With your data array:</p>\n\n<pre><code>data_array = [\n    :match_found =&gt; true, \n    :transfer_flag =&gt; false,\n    :confirm_id =&gt; 2\n]\n</code></pre>\n\n<p>Then, you can execute the query combined with <code>each function</code>:</p>\n\n<pre><code>customer_phone = Customer.lookup_phone(params[:Phone]).each {|e| e.data = data_array}\n</code></pre>\n\n<p>Access it:</p>\n\n<pre><code>customer_phone.first.data\n</code></pre>\n\n<p>To render json:</p>\n\n<pre><code>render json: customer_phone, methods: [:data]\n</code></pre>\n"}], "owner": {"reputation": 1217, "user_id": 1180008, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/FdMdK.jpg?s=128&g=1", "display_name": "Nubtacular", "link": "https://stackoverflow.com/users/1180008/nubtacular"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 327, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1473789369, "creation_date": 1473782863, "question_id": 39474536, "link": "https://stackoverflow.com/questions/39474536/rails-4-and-returning-json-response-how-to-correctly-append-extra-data", "title": "Rails 4 and returning JSON response: how to correctly append extra data?", "body": "<p>I have a SQL query returns some data, here is some sample output:</p>\n\n<pre><code>[\n    {\n        \"AccountCode\": \"111123456\",\n        \"AccountID\": 123456,\n        \"BalanceCurrent\": \"-8.0\",\n        \"Phone\": \"123456888\",\n    }\n]\n</code></pre>\n\n<p>This is a Hash with an array. There are times when there will be multiple hashes within the array. Just one in this example though.</p>\n\n<p>As stated, this data comes directly from the database. </p>\n\n<p>I have a <code>lookup_phone</code> method in my Customer model that runs the SQL query and then executed in the customer_controller.rb file like so:</p>\n\n<p><code>customer_phone = Customer.lookup_phone(params[:Phone])</code></p>\n\n<p>Now, I need to append some extra data to these hash(es) <strong>that do not</strong> come from the database, like so: </p>\n\n<pre><code>data = [\n    :match_found =&gt; true, \n    :transfer_flag =&gt; false,\n    :confirm_id =&gt; 2\n]\n</code></pre>\n\n<p>This <code>data</code> variable needs to be WITHIN each hash object, not a separate hash object on its own. </p>\n\n<p>Using a simple array <code>concat</code> or <code>+</code> always makes the data a separate hash object. I've come across some good posts saying to use <code>reduce</code> along with <code>merge</code>, but those are <code>Hash</code> methods, not <code>Array</code> methods.</p>\n\n<p>If I try to set <code>data</code> as a Hash instead of an array, I get </p>\n\n<p><code>no implicit conversion of Hash into Array</code> when I try to do</p>\n\n<p><code>customer_phone.reduce({}, :merge)</code></p>\n\n<p>after running <code>customer_phone += data</code></p>\n\n<p>What is the proper way to append <code>data</code> to an existing Hash object? </p>\n"}, {"tags": ["mysql", "ruby-on-rails", "ruby", "postgresql", "activerecord"], "answers": [{"tags": [], "owner": {"reputation": 8117, "user_id": 1207687, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/cOUI4.jpg?s=128&g=1", "display_name": "Wes Foster", "link": "https://stackoverflow.com/users/1207687/wes-foster"}, "is_accepted": true, "score": 1, "last_activity_date": 1473783092, "creation_date": 1473783092, "answer_id": 39474614, "question_id": 39474505, "link": "https://stackoverflow.com/questions/39474505/restructuring-a-filled-sql-database-in-rails/39474614#39474614", "title": "Restructuring a filled SQL database in Rails", "body": "<p>This is a pretty broad question, so my answer will focus on procedure rather than specific code.</p>\n\n<ol>\n<li>Create a new table for the <code>MODEL_B</code> data. Name it <code>MODEL_B_TABLE</code> (for example)</li>\n<li>Rename the original table (if necessary) since it will now be used for only <code>MODEL_A</code> data</li>\n<li>Run a query to pull all <code>MODEL_B</code> data from the original table and place it into the new <code>MODEL_B_TABLE</code></li>\n<li>Update your application to pull from the correct database tables</li>\n<li>Remove the unneeded data from the original table (since that specific data now exists in the <code>MODEL_B_TABLE</code>)</li>\n<li>Test, test, test!</li>\n<li>Upload the changes to a staging server and run the migrations.</li>\n<li>If all looks well on the staging server, push it to production. If not, start over from step 6.</li>\n</ol>\n\n<p>That would be an appropriate procedure to avoid data loss for a production server. Proper testing is paramount! Ensure you make backups of all your data before pushing into production.</p>\n"}], "owner": {"reputation": 155, "user_id": 1372361, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e767c6eba4ba018437306c7866166e1a?s=128&d=identicon&r=PG&f=1", "display_name": "think", "link": "https://stackoverflow.com/users/1372361/think"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 39474614, "answer_count": 1, "score": 0, "last_activity_date": 1473783092, "creation_date": 1473782741, "question_id": 39474505, "link": "https://stackoverflow.com/questions/39474505/restructuring-a-filled-sql-database-in-rails", "title": "Restructuring a filled SQL database in Rails", "body": "<ul>\n<li>Due to bad design, I have a database that contains data in one table, that really should be split up into two tables.</li>\n<li>The table provides data for two different models. I distinguish between those models using a table field called <code>type</code>.</li>\n<li>I use this to say <code>if type == MODEL_A ... do foo</code>, or <code>if type == MODEL_B ... do bar</code>.</li>\n<li>Depending on the type of the concrete table (type: <code>MODEL_A</code> or <code>MODEL_B</code>), I only use a subset of the columns in the table for <code>MODEL_A</code>, and the remaining subset of the columns for <code>MODEL_B</code>. Therefore, many columns always contain <code>NULL</code></li>\n<li>I believe they should be split up into a <code>MODEL_A</code> table and a <code>MODEL_B</code> table.</li>\n</ul>\n\n<p><strong>How should I go about this in Rails/ActiveRecord, without dropping the existing data?</strong></p>\n"}, {"tags": ["ruby", "parsing"], "comments": [{"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "reply_to_user": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "edited": false, "score": 0, "creation_date": 1473782029, "post_id": 39473849, "comment_id": 66267781, "body": "@Felix awesome, I will close this question as duplicate when I go home. Not sure how I missed that. Thanks a lot!"}], "answers": [{"comments": [{"owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1473781634, "post_id": 39474072, "comment_id": 66267536, "body": "That is a possible workaround. However, I would prefer if I could stay in ruby. Piping is better than reading/writing files, but still has its issues. Ideally, I don&#39;t want to call external commands at all."}, {"owner": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "reply_to_user": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "edited": false, "score": 0, "creation_date": 1473781909, "post_id": 39474072, "comment_id": 66267713, "body": "I think your question is a duplicate, then :)"}], "tags": [], "owner": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "is_accepted": false, "score": 1, "last_activity_date": 1473781364, "creation_date": 1473781364, "answer_id": 39474072, "question_id": 39473849, "link": "https://stackoverflow.com/questions/39473849/check-ruby-syntax-programmatically/39474072#39474072", "title": "Check Ruby syntax programmatically", "body": "<p><code>ruby -c</code> can read from standard input, like in <code>cat code.rb | ruby -c</code>.</p>\n\n<p>Interactively you can <code>ruby -c</code>, type in text and press Ctrl+D to signalize end-of-file.</p>\n\n<p>Examples are for Linux/Unix, no idea how this would work in Windows.</p>\n"}], "owner": {"reputation": 33085, "user_id": 2423164, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/Nxbnp.jpg?s=128&g=1", "display_name": "ndnenkov", "link": "https://stackoverflow.com/users/2423164/ndnenkov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "closed_date": 1473782604, "answer_count": 1, "score": 1, "last_activity_date": 1525272168, "creation_date": 1473780686, "last_edit_date": 1525272168, "question_id": 39473849, "link": "https://stackoverflow.com/questions/39473849/check-ruby-syntax-programmatically", "closed_reason": "Duplicate", "title": "Check Ruby syntax programmatically", "body": "<p>How can I check if Ruby code is parsable, without executing it?</p>\n\n<p>Basically, I want the functionality of <code>ruby -c code.rb</code>, without actually writing to a temporary file. Note that there is the problem of properly escaping the code if one is to use <code>ruby -ce 'some_ruby_code'</code>.</p>\n\n<p>Ideally, there should be something in the standard lib, but I couldn't find it.</p>\n"}, {"tags": ["ruby", "rspec"], "answers": [{"tags": [], "owner": {"reputation": 21613, "user_id": 580346, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/ba17945a06aac247b06548d5afe341e8?s=128&d=identicon&r=PG", "display_name": "mrzasa", "link": "https://stackoverflow.com/users/580346/mrzasa"}, "is_accepted": false, "score": 0, "last_activity_date": 1473838519, "creation_date": 1473838519, "answer_id": 39484892, "question_id": 39473778, "link": "https://stackoverflow.com/questions/39473778/how-to-raise-exceptions-in-rspec-for-only-some-method-calls/39484892#39484892", "title": "how to raise exceptions in rspec for only some method calls", "body": "<p>It is a good idea to have deterministic tests, so that a test pass or always fail consistently. </p>\n\n<p>You can stub this method and use a counter inside:</p>\n\n<pre><code>#assuming that obj has the method collect_money\nallow(obj).to receive(:collect_money) do\n  @counter ||= 0\n  @counter += 1\n  fail NoMoney if counter &gt; 3 # raise exception in 4th call\n  # ... return something useful in other cases\nend\n</code></pre>\n"}], "owner": {"reputation": 475, "user_id": 347996, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/7a246b765b7627eaae0d1f523dc45d6c?s=128&d=identicon&r=PG", "display_name": "CaseyJones", "link": "https://stackoverflow.com/users/347996/caseyjones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1473838519, "creation_date": 1473780449, "question_id": 39473778, "link": "https://stackoverflow.com/questions/39473778/how-to-raise-exceptions-in-rspec-for-only-some-method-calls", "title": "how to raise exceptions in rspec for only some method calls", "body": "<p>I have some code that calls method <code>collect_money</code> at startup. Periodically, the method <code>collect_money</code> gets called asynchronously (event based, etc). I'd like to make collect_money raise an exception, e.g <code>NoMoney</code> on occasion, but not every time and definitely not the first time it gets executed. Is this possible? If not, what would be the alternative/recommended way to approach this?</p>\n"}, {"tags": ["ruby", "methods"], "comments": [{"owner": {"reputation": 2386, "user_id": 2933305, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/223ba397b1fef4a7bec7bfc59ca74f11?s=128&d=identicon&r=PG", "display_name": "maicher", "link": "https://stackoverflow.com/users/2933305/maicher"}, "edited": false, "score": 0, "creation_date": 1473781062, "post_id": 39473638, "comment_id": 66267180, "body": "In <code>until i = students.length</code> line, didn&#39;t you mean <code>until i == students.length</code>?"}, {"owner": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "edited": false, "score": 0, "creation_date": 1473781596, "post_id": 39473638, "comment_id": 66267514, "body": "I believe the problem lies outside of the code you posted. More ruby-ish would be to iterate over the students like this: <code>students.each_with_index do |student, idx| ....</code>."}, {"owner": {"reputation": 3580, "user_id": 1680728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/844cd73e8700d810d7cc207cba7da3bd?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/1680728/felix"}, "edited": false, "score": 0, "creation_date": 1473781734, "post_id": 39473638, "comment_id": 66267590, "body": "Oh, you enter an inifinite loop when neither &quot;y&quot; nor &quot;n&quot; is entered in the sort_by? method. Put a <code>input = gets.chomp.downcase</code> inside the loop (another <code>else</code>?) in order to re-read from the user."}, {"owner": {"reputation": 463, "user_id": 3527552, "user_type": "registered", "accept_rate": 60, "profile_image": "https://graph.facebook.com/100001213035230/picture?type=large", "display_name": "Tushar Pal", "link": "https://stackoverflow.com/users/3527552/tushar-pal"}, "edited": false, "score": 0, "creation_date": 1473853582, "post_id": 39473638, "comment_id": 66296831, "body": "agreed with felix"}], "owner": {"reputation": 81, "user_id": 6513027, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/ec277bb373975eea2c0037fd5f8fabfe?s=128&d=identicon&r=PG&f=1", "display_name": "antonyCas", "link": "https://stackoverflow.com/users/6513027/antonycas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1473780046, "creation_date": 1473780046, "question_id": 39473638, "link": "https://stackoverflow.com/questions/39473638/ruby-method-looping-without-loop", "title": "ruby method looping without loop", "body": "<p>hi I am having a problem with a method i have written.  When the method has finished executing it runs its first 2 lines again even though there is no loop. can anyone tell me why?</p>\n\n<p>here is the code</p>\n\n<pre><code>def print(students)\n  if sort_by?(\"letter\") then students = letter_sort(students) end\n  if sort_by?(\"cohort\") then students = cohort_sort(students) end\n  print_header\n  i = 0\n  until i = students.length do \n    student_name = get_student_name(students[i][:name])\n    puts \"#{i+1}. #{student_name} (#{students[i][:cohort]} cohort)\"\n    i = i + 1\n  end\nend\n</code></pre>\n\n<p>The two if statements at the top are the ones being executed. Here is the sort_by? method I've written as well.</p>\n\n<pre><code>def sort_by?(string)\n  puts \"would you like to sort by #{string}?\"\n  puts \"Enter y/n:\"\n  input = gets.chomp.downcase\n  while input != \"n\" or input != \"y\"\n      if input == \"n\"\n          return false\n      elsif input == \"y\"\n          return true\n      end       \n  end\nend \n</code></pre>\n\n<p>Any help at all would be appreciated. </p>\n"}, {"tags": ["arrays", "ruby", "count", "scripting"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6827114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deb8d4c2ed6604ea161a776f257b0852?s=128&d=identicon&r=PG&f=1", "display_name": "Suidt", "link": "https://stackoverflow.com/users/6827114/suidt"}, "edited": false, "score": 0, "creation_date": 1473817730, "post_id": 39473429, "comment_id": 66281662, "body": "Thank you for your help. I ended up writing this which solved my problem.  quota = 35 homeDir.each |x| puts x} homeDir.each do |y|     if y &gt; quota        counter = counter + 1   end end"}], "tags": [], "owner": {"reputation": 4265, "user_id": 4601088, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/bN143.jpg?s=128&g=1", "display_name": "Bart\u0142omiej G\u0142adys", "link": "https://stackoverflow.com/users/4601088/bart%c5%82omiej-g%c5%82adys"}, "is_accepted": false, "score": 0, "last_activity_date": 1473779466, "creation_date": 1473779466, "answer_id": 39473429, "question_id": 39473319, "link": "https://stackoverflow.com/questions/39473319/counting-amount-of-times-element-appears-in-array/39473429#39473429", "title": "Counting amount of times element appears in array", "body": "<p>you can use method <code>count</code></p>\n\n<pre><code>homeDir.count{|el| el &gt;= 35 }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 0, "last_activity_date": 1473973454, "last_edit_date": 1473973454, "creation_date": 1473780094, "answer_id": 39473656, "question_id": 39473319, "link": "https://stackoverflow.com/questions/39473319/counting-amount-of-times-element-appears-in-array/39473656#39473656", "title": "Counting amount of times element appears in array", "body": "<p>Since <code>homeDir</code> is sorted largest to smallest, it would generally be more efficient to use <a href=\"http://ruby-doc.org/core-2.3.0/Array.html#method-i-take_while\" rel=\"nofollow\">Array#take_while</a> (and then <code>Array#size</code>) than <a href=\"http://ruby-doc.org/core-2.3.0/Array.html#method-i-count\" rel=\"nofollow\">Array#count</a>, as <code>count</code> must traverse the entire array.</p>\n\n<pre><code>def count_biggest(arr, num)\n  arr.take_while { |n| n &gt;= num }.size\nend\n\narr = [5,4,3,2,1]\n\ncount_biggest(arr, 3) #=&gt; 3\ncount_biggest(arr, 6) #=&gt; 0\ncount_biggest(arr, 0) #=&gt; 5\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1473835885, "post_id": 39481365, "comment_id": 66286675, "body": "1. Line 2 needs a left brace (<code>{</code>) after <code>each</code>. 2. You need to initialize <code>counter</code> to zero. 3. <code>if</code> must be paired with an <code>end</code> (or write <code>counter = counter + 1 if y &gt; quota</code>. 4. It is inefficient because it does not make use of the fact that <code>homeDir</code> is sorted. Always test your code before posting. This is not Ruby-like code, but instead reflects a procedural approach."}, {"owner": {"reputation": 1, "user_id": 6827114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deb8d4c2ed6604ea161a776f257b0852?s=128&d=identicon&r=PG&f=1", "display_name": "Suidt", "link": "https://stackoverflow.com/users/6827114/suidt"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1473881172, "post_id": 39481365, "comment_id": 66313929, "body": "I am sorry, this is my first semester taking ruby. When I answered my own question I was unable to copy and paste the code from my VM so I typed it out. Thanks for catching it, i will edit the post above."}], "tags": [], "owner": {"reputation": 1, "user_id": 6827114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deb8d4c2ed6604ea161a776f257b0852?s=128&d=identicon&r=PG&f=1", "display_name": "Suidt", "link": "https://stackoverflow.com/users/6827114/suidt"}, "is_accepted": false, "score": 0, "last_activity_date": 1473881292, "last_edit_date": 1473881292, "creation_date": 1473817923, "answer_id": 39481365, "question_id": 39473319, "link": "https://stackoverflow.com/questions/39473319/counting-amount-of-times-element-appears-in-array/39481365#39481365", "title": "Counting amount of times element appears in array", "body": "<p>This is my question solved. </p>\n\n<pre><code>print  \"Enter a number between 10 and 25 to represent the number of users: \"\nnum = gets.chomp.to_i \nwhile num &gt; 25 or num &lt; 10\n  print \"I said between 10 and 25. Try again: \" \n    num = gets.to_i \nend\nhomeDir = Array.new(num) { rand(20..50)} \nhomeDir.sort!{|x,y| y&lt;=&gt;x} \n\nquota = 35\ncounter = 0\nputs\"\\n\"\nputs \"Directory Sizes (in MB)\"\nputs \"======================\"\n\nhomeDir.each{|x| puts x} \nhomeDir.each do |y| \n  if y &gt; quota\n    counter = counter + 1\n  end\nend\nputs \"\\n\"\nputs \"There are #{counter} users whos directories are over 35MB\"\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6827114, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/deb8d4c2ed6604ea161a776f257b0852?s=128&d=identicon&r=PG&f=1", "display_name": "Suidt", "link": "https://stackoverflow.com/users/6827114/suidt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1473973454, "creation_date": 1473779164, "question_id": 39473319, "link": "https://stackoverflow.com/questions/39473319/counting-amount-of-times-element-appears-in-array", "title": "Counting amount of times element appears in array", "body": "<p>I am new to post on Stackoverflow but I am having lots of trouble figuring something out. I am new to the ruby language. </p>\n\n<p>I would like to count the amount of times an element in the array is greater than a specific constant. The array length is between 10 and 25, this is chosen by the user. I then have the array sorted from largest to smallest. I would like to count the amount of times a value in the array is larger or equal to 35. This will be defined as the constant \"Quota\"</p>\n\n<pre><code> puts \"Enter a number between 10 and 25 to represent the number of users: \"\nnum = gets.to_i\nif num &gt; 25 or num &lt; 10\n  puts \"I said between 10 and 25. Try again\"\n    num = gets.to_i\nend\nhomeDir = Array.new(num) { rand(20..50)}\nhomeDir.sort!{|x,y| y&lt;=&gt;x}\nputs  homeDir\nquota = 35\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "elasticsearch", "elasticsearch-ruby"], "answers": [{"tags": [], "owner": {"reputation": 506, "user_id": 1658182, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/0b57ea0ad429c2fb50dff41efbf918ec?s=128&d=identicon&r=PG", "display_name": "Aayush Kothari", "link": "https://stackoverflow.com/users/1658182/aayush-kothari"}, "is_accepted": true, "score": 1, "last_activity_date": 1473783834, "creation_date": 1473783834, "answer_id": 39474800, "question_id": 39473243, "link": "https://stackoverflow.com/questions/39473243/where-to-specify-cluster-details-when-using-elastic-search-gem-in-ruby/39474800#39474800", "title": "where to specify cluster details when using elastic search gem in Ruby", "body": "<p>As the documentation specifics, the elasticsearch gem wraps <a href=\"https://github.com/elastic/elasticsearch-ruby/tree/master/elasticsearch-transport\" rel=\"nofollow\">elasticsearch-transport</a> for connecting to a cluster and <a href=\"https://github.com/elastic/elasticsearch-ruby/tree/master/elasticsearch-api\" rel=\"nofollow\">elasticsearch-api</a> for accessing the elasticsearch API. From the documentation of elasticsearch-transport, </p>\n\n<p><em>In the simplest form, connect to Elasticsearch running on <a href=\"http://localhost:9200\" rel=\"nofollow\">http://localhost:9200</a> without any configuration:</em></p>\n\n<p>So basically, <code>client = Elasticsearch::Client.new log: true</code> will by default connect to the cluster running at localhost:9200 (the same machine as your Rails app).</p>\n\n<p>Go ahead and try executing <code>client.cluster.health</code> after establishing the connection and you'll get to know if it succeeded or not. </p>\n\n<p>Moreover, if your cluster runs on a different server, you can use the following to connect to it: </p>\n\n<pre><code>es = Elasticsearch::Client.new host: http(s)://&lt;path-to-cluster-server&gt;\n</code></pre>\n"}], "owner": {"reputation": 3642, "user_id": 4593743, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/0212ffc5054bff1695ffa1e46f357746?s=128&d=identicon&r=PG&f=1", "display_name": "python", "link": "https://stackoverflow.com/users/4593743/python"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 526, "favorite_count": 0, "accepted_answer_id": 39474800, "answer_count": 1, "score": 0, "last_activity_date": 1473783834, "creation_date": 1473778914, "question_id": 39473243, "link": "https://stackoverflow.com/questions/39473243/where-to-specify-cluster-details-when-using-elastic-search-gem-in-ruby", "title": "where to specify cluster details when using elastic search gem in Ruby", "body": "<p>I want to access the data in <code>Elastic Search Cluster</code> from my <code>rails</code> application. Lets say server is running at <code>http://localhost:9200</code> and I want to access the end point <code>http://localhost:9200/location/type</code>. </p>\n\n<p>The following this <a href=\"https://www.elastic.co/guide/en/elasticsearch/client/ruby-api/current/_the_ruby_client.html\" rel=\"nofollow\">documentation</a> and came across this example:</p>\n\n<pre><code>require 'elasticsearch'\n\nclient = Elasticsearch::Client.new log: true\n\nclient.cluster.health\n\nclient.index index: 'my-index', type: 'my-document', id: 1, body: { title: 'Test' }\n\nclient.indices.refresh index: 'my-index'\n\nclient.search index: 'my-index', body: { query: { match: { title: 'test' } } }\n</code></pre>\n\n<p><strong>Questions:</strong></p>\n\n<ul>\n<li>where I will define the details of my <code>elasticsearch cluster</code> in the code? the cluster is running at <code>http://localhost:9200/</code></li>\n</ul>\n"}, {"tags": ["ruby"], "answers": [{"comments": [{"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "edited": false, "score": 2, "creation_date": 1473779169, "post_id": 39473098, "comment_id": 66265899, "body": "this is not an explanation/answer to the question &quot;why?&quot;"}], "tags": [], "owner": {"reputation": 5730, "user_id": 667987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c00249587cb5aa0ceb5765dc811faa7?s=128&d=identicon&r=PG", "display_name": "seph", "link": "https://stackoverflow.com/users/667987/seph"}, "is_accepted": false, "score": 1, "last_activity_date": 1473778962, "last_edit_date": 1473778962, "creation_date": 1473778562, "answer_id": 39473098, "question_id": 39473027, "link": "https://stackoverflow.com/questions/39473027/ruby-class-variable-initial-value/39473098#39473098", "title": "Ruby class variable initial value", "body": "<p>Try this instead:</p>\n\n<pre><code>class Test\n  attr_accessor :a\n\n  def initialize\n    @a = 100\n  end\nend\n\na = Test.new\nputs a.a\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 55, "user_id": 4188910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbc2a97cfffd0ebe27e67534b2a696ad?s=128&d=identicon&r=PG&f=1", "display_name": "emj", "link": "https://stackoverflow.com/users/4188910/emj"}, "edited": false, "score": 0, "creation_date": 1473779483, "post_id": 39473264, "comment_id": 66266119, "body": "Thank you for your explanation. So, can I say that <code>a</code> in inherited classes will be accessible with <code>100</code> value?"}, {"owner": {"reputation": 1983, "user_id": 2830652, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/99L9k.png?s=128&g=1", "display_name": "sokkyoku", "link": "https://stackoverflow.com/users/2830652/sokkyoku"}, "edited": false, "score": 2, "creation_date": 1473779562, "post_id": 39473264, "comment_id": 66266176, "body": "<code>cattr_accessor</code> is part of rails and inappropriate for this question (no <code>rails</code> tag)"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 1983, "user_id": 2830652, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/99L9k.png?s=128&g=1", "display_name": "sokkyoku", "link": "https://stackoverflow.com/users/2830652/sokkyoku"}, "edited": false, "score": 0, "creation_date": 1473779732, "post_id": 39473264, "comment_id": 66266287, "body": "@sokkyoku thx, edited"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 55, "user_id": 4188910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbc2a97cfffd0ebe27e67534b2a696ad?s=128&d=identicon&r=PG&f=1", "display_name": "emj", "link": "https://stackoverflow.com/users/4188910/emj"}, "edited": false, "score": 1, "creation_date": 1473779781, "post_id": 39473264, "comment_id": 66266319, "body": "@emj, right. You can test it with <code>class B &lt; A; end</code> and <code>B.a</code>"}, {"owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1473785797, "post_id": 39473264, "comment_id": 66269794, "body": "You should clarify, &quot;Class instances DO NOT have access to their class&#39; instance variables.&quot; If <code>@a</code> is a class instance variable with value &quot;dog&quot; and <code>@b</code> is an instance variable, <code>@b.class.a #=&gt; &quot;dog&quot;</code> if <code>@a</code> has a read accessor, else <code>@b.class.instance_variable_get(&quot;@a&quot;) #=&gt; &quot;dog&quot;</code>"}, {"owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "reply_to_user": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "edited": false, "score": 0, "creation_date": 1473785941, "post_id": 39473264, "comment_id": 66269855, "body": "@CarySwoveland I was not around my laptop since answered and was sure someone would stumble upon this sentence of mine :) Really there&#39;s nothing &quot;inaccessible&quot; in Ruby, but I&#39;ll update the answer once I am near laptop"}], "tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": true, "score": 3, "last_activity_date": 1473787639, "last_edit_date": 1473787639, "creation_date": 1473778977, "answer_id": 39473264, "question_id": 39473027, "link": "https://stackoverflow.com/questions/39473027/ruby-class-variable-initial-value/39473264#39473264", "title": "Ruby class variable initial value", "body": "<p>You're mixing things a bit.</p>\n\n<p>What you've defined with <code>@a = 100</code> is a <em>class instance variable</em>.</p>\n\n<p>What you're going to have access to with <code>attr_accessor :a</code> is an <em>instance variable</em> <code>@a</code>.</p>\n\n<p>Example of instance variable usage:</p>\n\n<pre><code>class A\n  def initialize a\n    @a = a\n  end\n  attr_accessor :a\nend\n\ninstance = A.new(2)\n#=&gt; 2\ninstance.instance_variables\n#=&gt; [:@a]\ninstance.a\n#=&gt; 2\n</code></pre>\n\n<p>Example of class instance variable usage:</p>\n\n<pre><code>class A\n  @a = 1\n  class &lt;&lt; self\n    attr_accessor :a\n  end\nend\n\nA.a\n#=&gt; nil\nA.a = 2\n#=&gt; 2\nA.a\n#=&gt; 2\ninstance = A.new\ninstance.class.a # access instance's class instance variable\n#=&gt; 2\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 1, "creation_date": 1473782785, "post_id": 39473309, "comment_id": 66268216, "body": "It would be more precise (and ultimately more helpful) to say that that line <i>is</i> assigning an instance variable. After, all, it is an assignment (<code>=</code>), and it is an instance variable (<code>@</code>). It&#39;s just that the instance isn&#39;t the one the OP thinks it is. It <i>is</i> an instance variable, but for the <i>wrong</i> instance."}, {"owner": {"reputation": 1983, "user_id": 2830652, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/99L9k.png?s=128&g=1", "display_name": "sokkyoku", "link": "https://stackoverflow.com/users/2830652/sokkyoku"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1473783134, "post_id": 39473309, "comment_id": 66268423, "body": "Good point, amended my answer"}], "tags": [], "owner": {"reputation": 1983, "user_id": 2830652, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/99L9k.png?s=128&g=1", "display_name": "sokkyoku", "link": "https://stackoverflow.com/users/2830652/sokkyoku"}, "is_accepted": false, "score": 1, "last_activity_date": 1473783012, "last_edit_date": 1473783012, "creation_date": 1473779123, "answer_id": 39473309, "question_id": 39473027, "link": "https://stackoverflow.com/questions/39473027/ruby-class-variable-initial-value/39473309#39473309", "title": "Ruby class variable initial value", "body": "<p>The reason this is happening is that this line:</p>\n\n<pre><code>@a = 100\n</code></pre>\n\n<p>is assigning to an instance variable but not the one you think. It is being assigned to <code>Test.a</code>, (Test being an instance of <code>Class</code>) rather than to an instance variable <code>a</code> belonging to each instance of <code>Test</code></p>\n\n<p>In turn, this line:</p>\n\n<pre><code>attr_accessor :a\n</code></pre>\n\n<p>is declaring an accessor to an instance variable called <code>a</code> (accessible through any instance of <code>Test</code>)</p>\n\n<p>Thus you should either have </p>\n\n<pre><code>class Test\n    @a = 100\n    class &lt;&lt; self\n        attr_accessor :a\n    end\nend\nputs Test.a #=&gt; will print 100\n</code></pre>\n\n<p>or</p>\n\n<pre><code>class Test\n    def initialize\n        @a = 100\n    end\n    attr_accessor :a\nend\na = Test.new\nputs a.a #=&gt; will print 100\n</code></pre>\n\n<p>It depends if you just want a class constant or if you want an attribute with a default value on each instance. The latter is a direct translation of your PHP code.</p>\n"}, {"tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 2, "last_activity_date": 1473783063, "creation_date": 1473783063, "answer_id": 39474600, "question_id": 39473027, "link": "https://stackoverflow.com/questions/39473027/ruby-class-variable-initial-value/39474600#39474600", "title": "Ruby class variable initial value", "body": "<p>Instances variables belong to objects (aka instances), that's why they are called \"instance variables\" after all.</p>\n\n<p>There are two objects here: <code>Test</code>, which is an instance of <code>Class</code>, and <code>a</code>, which is an instance of <code>Test</code>. Both are objects just like any other object. Both can have instance variables just like any other object.</p>\n\n<p>Both have an instance variable called <code>@a</code>. <code>Foo</code>'s <code>@a</code> has been initialized to <code>100</code>. <code>a</code>'s <code>@a</code> hasn't been initialized at all, and unitialized instance variables evaluate to <code>nil</code>.</p>\n\n<p>So, your problem is that you are confusing which instance you are looking at. Instance variables are always looked up in <code>self</code>, and inside a class definition body, <code>self</code> is the class being defined.</p>\n\n<p>This may sound pedantic, but I find that understanding that Ruby is actually <em>much simpler</em> than people sometimes want you to believe, will ultimately help you.</p>\n"}], "owner": {"reputation": 55, "user_id": 4188910, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbc2a97cfffd0ebe27e67534b2a696ad?s=128&d=identicon&r=PG&f=1", "display_name": "emj", "link": "https://stackoverflow.com/users/4188910/emj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 201, "favorite_count": 0, "closed_date": 1518167047, "accepted_answer_id": 39473264, "answer_count": 4, "score": 3, "last_activity_date": 1473787639, "creation_date": 1473778368, "question_id": 39473027, "link": "https://stackoverflow.com/questions/39473027/ruby-class-variable-initial-value", "closed_reason": "Duplicate", "title": "Ruby class variable initial value", "body": "<p>In <code>PHP</code> I write:</p>\n\n<pre><code>Class Test{\n  public $a=100;\n}\n\n$a=new Test();\necho $a-&gt;a; //prints 100\n</code></pre>\n\n<p>It prints <code>100</code>, but In ruby when I write:</p>\n\n<pre><code>class Test\n  @a=100\n  attr_accessor :a\nend\n\na=Test.new\nputs a.a #=&gt; prints nil\n</code></pre>\n\n<p><code>a</code> is nil and it prints <code>nil</code>. Why?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "nested-attributes"], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 5459054, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-OCgS_oxlX3o/AAAAAAAAAAI/AAAAAAAAADA/fgV3d3k1Loo/photo.jpg?sz=128", "display_name": "Leeder", "link": "https://stackoverflow.com/users/5459054/leeder"}, "edited": false, "score": 0, "creation_date": 1473778482, "post_id": 39472992, "comment_id": 66265453, "body": "That... was...ugh, thank you. So I need not iterate through f.object.attr4characters manually..."}], "tags": [], "owner": {"reputation": 79161, "user_id": 1064226, "user_type": "registered", "profile_image": "https://graph.facebook.com/36912842/picture?type=large", "display_name": "Frederick Cheung", "link": "https://stackoverflow.com/users/1064226/frederick-cheung"}, "is_accepted": true, "score": 1, "last_activity_date": 1473778270, "creation_date": 1473778270, "answer_id": 39472992, "question_id": 39472794, "link": "https://stackoverflow.com/questions/39472794/rails-doesnt-update-nested-attributes/39472992#39472992", "title": "Rails doesn&#39;t update nested attributes", "body": "<p>The warning is telling you that it is ignoring all the <code>attr4character</code> attributes. Your <code>permit</code> code is correct as is your model, but your view doesn't match them. You should be doing</p>\n\n<pre><code>f.fields_for :attr4characters do |attr_f|\n  ...\nend\n</code></pre>\n\n<p>And let rails handle iterating over the association. This will also ensure that attributes are named correctly (so they will be allowed through by your whitelist)</p>\n"}], "owner": {"reputation": 57, "user_id": 5459054, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-OCgS_oxlX3o/AAAAAAAAAAI/AAAAAAAAADA/fgV3d3k1Loo/photo.jpg?sz=128", "display_name": "Leeder", "link": "https://stackoverflow.com/users/5459054/leeder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 863, "favorite_count": 0, "accepted_answer_id": 39472992, "answer_count": 1, "score": 0, "last_activity_date": 1473778270, "creation_date": 1473777724, "question_id": 39472794, "link": "https://stackoverflow.com/questions/39472794/rails-doesnt-update-nested-attributes", "title": "Rails doesn&#39;t update nested attributes", "body": "<p>I create an application, which is basically a character creator for an RPG with interactive and dynamic forms. I use Rails 5.0.0.1, and I cannot update my form properly. The base model updates well, but all nested don't.</p>\n\n<p>So, I have </p>\n\n<pre><code>class Character &lt; ApplicationRecord\n  has_many :attr4characters, autosave: true\n  accepts_nested_attributes_for :attr4characters, allow_destroy: true\nend\n</code></pre>\n\n<p>and </p>\n\n<pre><code>class Attr4character &lt; ApplicationRecord\n  belongs_to :character\nend\n</code></pre>\n\n<p>which represent a character and a set of his attributes. Each record in Attr4character is a different attribute.</p>\n\n<p>The Show view is simple:</p>\n\n<pre><code>...\n&lt;div class=\"field\"&gt;\n  &lt;%= f.label :description %&gt;\n  &lt;%= f.text_area :description %&gt;\n&lt;/div&gt;\n\n&lt;div class=\"field\"&gt;\n  &lt;%= f.label :character_type %&gt;\n  &lt;%= f.select(:character_type, options_for_select([\"Zhong Lung\", \"Shih\", \"Hsien\", \"Garou\", \"Technocrat\"])) %&gt;\n&lt;/div&gt;\n\n  &lt;% f.object.attr4characters.each do |attr| %&gt;\n    &lt;%= f.fields_for attr do |attr_f| %&gt;\n      &lt;div class=\"field\"&gt;  \n        &lt;%= attr_f.label \"Field name\" %&gt;\n        &lt;%= attr_f.text_field :field_name %&gt;\n      &lt;/div&gt;\n      &lt;div class=\"field\"&gt;  \n        &lt;%= attr_f.label \"Field value\" %&gt;\n        &lt;%= attr_f.text_field :field_value %&gt;\n      &lt;/div&gt;\n    &lt;% end %&gt;\n  &lt;% end %&gt;\n\n  &lt;div class=\"actions\"&gt;\n    &lt;%= f.submit %&gt;\n  &lt;/div&gt;\n...\n</code></pre>\n\n<p>And finally my characters_controller:</p>\n\n<pre><code>  def update\n    respond_to do |format|\n      if @character.update(character_params)\n        format.html { redirect_to @character, notice: 'Character was successfully updated.' }\n        format.json { render :show, status: :ok, location: @character }\n      else\n        format.html { render :edit }\n        format.json { render json: @character.errors, status:  :unprocessable_entity }\n      end\n    end\n  end\n\n  private\n    def set_character\n      @character = Character.find(params[:id])\n    end\n\n    def character_params\n      params.require(:character).permit(:id, :name, :player, :description, :character_type, attr4characters_attributes: [:id, :character_id, :field_name, :field_value])\n    end\n</code></pre>\n\n<p>So, I have a form, which correctly display a character and all set of his attributes. When I update a character field (like :description), it is normally updated. When I update any nested field, Rails says that character is successfully updated and nothing changes! I searched with Google, and I found a lot of problems with nested attributes in Rails forms, but none of the recipes worked for me. I even encountered opinions that it is a bug in Rails 4, but I use 5th version...</p>\n\n<p>Please, advice on the topic. Is it a bug really? Or am I doing something wrong? I'm new on Rails, so I don't exclude that possibility. :) </p>\n\n<p>By the way, in the server's log I found that there is warning about attr4characters. </p>\n\n<pre><code>Processing by CharactersController#update as HTML\n  Parameters: {\"utf8\"=&gt;\"\\u2713\", \"authenticity_token\"=&gt;\"xeYyIRc13YiOk29v18rFM6Oh5OHRRuPpSKEQuIHE/U4uhANEF7TwMp8mb6hv6L7mUAm5MngAuyFayHcWV/Vvbw==\", \"character\"=&gt;{\"name\"=&gt;\"Ray\", \"player\"=&gt;\"111\", \"description\"=&gt;\"A Zhong Lung suicider\", \"character_type\"=&gt;\"Hsien\", \"attr4character\"=&gt;{\"field_name\"=&gt;\"Gift1\", \"field_value\"=&gt;\"Sense Wyrm\"}}, \"commit\"=&gt;\"Update Character\", \"id\"=&gt;\"3\"}\n  Character Load (0.2ms)  SELECT  \"characters\".* FROM \"characters\" WHERE \"characters\".\"id\" = ? LIMIT ?  [[\"id\", 3], [\"LIMIT\", 1]]\nUnpermitted parameter: attr4character\n   (0.1ms)  begin transaction\n  SQL (0.9ms)  UPDATE \"characters\" SET \"character_type\" = ?, \"updated_at\" = ? WHERE \"characters\".\"id\" = ?  [[\"character_type\", \"Hsien\"], [\"updated_at\", 2016-09-13 14:39:10 UTC], [\"id\", 3]]\n   (24.3ms)  commit transaction\n</code></pre>\n\n<p>But attr4characters are permitted in the characters_controller...</p>\n"}, {"tags": ["ruby", "rubygems", "bundler", "jruby", "warbler"], "answers": [{"tags": [], "owner": {"reputation": 103, "user_id": 5899078, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-ZsmB-x2wGuw/AAAAAAAAAAI/AAAAAAAAAE8/CPLOtyeqICA/photo.jpg?sz=128", "display_name": "Gugja Sputnik", "link": "https://stackoverflow.com/users/5899078/gugja-sputnik"}, "is_accepted": true, "score": 0, "last_activity_date": 1473797938, "creation_date": 1473797938, "answer_id": 39478362, "question_id": 39472697, "link": "https://stackoverflow.com/questions/39472697/jruby-warbler-how-to-compile-gems-also/39478362#39478362", "title": "JRuby Warbler - How to compile gems also", "body": "<ol>\n<li>Create 'config' folder in your project folder</li>\n<li>Run <code>warble config</code>, and 'config/warble.rb' is created</li>\n<li>Edit the warble.rb file -- <code>config.compile_gems = true</code></li>\n<li>Run <code>warble compiled jar</code>, and you will see your <code>*.jar</code> result file.</li>\n</ol>\n"}], "owner": {"reputation": 103, "user_id": 5899078, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-ZsmB-x2wGuw/AAAAAAAAAAI/AAAAAAAAAE8/CPLOtyeqICA/photo.jpg?sz=128", "display_name": "Gugja Sputnik", "link": "https://stackoverflow.com/users/5899078/gugja-sputnik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "accepted_answer_id": 39478362, "answer_count": 1, "score": 0, "last_activity_date": 1473797938, "creation_date": 1473777421, "question_id": 39472697, "link": "https://stackoverflow.com/questions/39472697/jruby-warbler-how-to-compile-gems-also", "title": "JRuby Warbler - How to compile gems also", "body": "<p>I know <code>warble compiled</code>, but this command compiles only the source of a project.<br>\nI want that warbler compiles gems together. How to do it?</p>\n"}, {"tags": ["ruby", "active-model-serializers", "json-api"], "answers": [{"tags": [], "owner": {"reputation": 172, "user_id": 4503232, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/z2jpl.png?s=128&g=1", "display_name": "FredyK", "link": "https://stackoverflow.com/users/4503232/fredyk"}, "is_accepted": false, "score": 0, "last_activity_date": 1473862165, "creation_date": 1473862165, "answer_id": 39492589, "question_id": 39472669, "link": "https://stackoverflow.com/questions/39472669/ruby-active-model-serializer-with-jsonapi-how-to-characterise-links/39492589#39492589", "title": "Ruby Active model serializer with jsonapi , how to characterise links", "body": "<p>After looking what is available in ruby for JSONAPI without rails, I ended using the gem <a href=\"https://github.com/fotinakis/jsonapi-serializers\" rel=\"nofollow\">JSONAPI-serializers</a>, It is much easier to set and lighter to load (less dependencies). This fit better with PORO </p>\n\n<p>My serializer becomes</p>\n\n<p><code>require_relative ./common_serializer\n   module JsonSerializer\n    class SearchSerializer &lt; CommonSerializer\n     attributes  :foo, include_links: true\n     def relationship_related_link(attribute_name)\n        nil\n     end\n   end\n  end\n</code>\nThis gem is much easier to use as the methods which create the json can be changed in the serializer (or in a commonClass)</p>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 8793006, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9DSKU.jpg?s=128&g=1", "display_name": "Lucas", "link": "https://stackoverflow.com/users/8793006/lucas"}, "is_accepted": false, "score": 1, "last_activity_date": 1557546128, "creation_date": 1557546128, "answer_id": 56086984, "question_id": 39472669, "link": "https://stackoverflow.com/questions/39472669/ruby-active-model-serializer-with-jsonapi-how-to-characterise-links/56086984#56086984", "title": "Ruby Active model serializer with jsonapi , how to characterise links", "body": "<p>Sorry to answer now, but if it is still of anyone interests...</p>\n\n<p>It is quite simple really. First of all it's important to notice that <a href=\"https://jsonapi.org/\" rel=\"nofollow noreferrer\">JSON:API</a> specification tell us that the related link should be their URL extension and it's better to show that path through the <code>Search</code>(for that case specific) path, for example: <a href=\"http://localhost:3000/searches/:search_id/foo\" rel=\"nofollow noreferrer\">http://localhost:3000/searches/:search_id/foo</a>.</p>\n\n<p>So our <code>SearchSerializer</code> should be something like:</p>\n\n<pre><code>class SearchSerializer &lt; ActiveModel::Serializer\n  # The attributes\n  attributes :id, :whatever, :something, :another_one\n\n  has_one :foo do\n    link(:related) { contact_foo_url(object.id) }\n  end\nend\n</code></pre>\n\n<p>Note also that at this point you should include the routes and the controller show method, as similiar to the bellow:</p>\n\n<p>For the <strong>routes.rb</strong>:</p>\n\n<pre><code>Rails.application.routes.draw do\n  resources :searches do\n    resource :foo, only: [:show]\n    # Also a best practice to dispose a 'relationships' path for this kinda example\n    resource :foo, only: [:show], path: 'relationships/foo'\n  end\nend\n</code></pre>\n\n<p>And for the <code>FoosController.rb</code>:</p>\n\n<pre><code>class FoosController &lt; ApplicationController\n  before_action :set_search\n\n  # GET /searches/1/foo\n  def show\n    render json: @search.foo\n  end\n\n  private\n    # Use callbacks to share common setup or constraints between actions.\n    def set_search\n      @search = Search.find(params[:search_id])\n    end\nend\n\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 9, "user_id": 14294408, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AOh14Gh478JLMGMCnZwmv0e44iXaB-aeeSa3_N3UAm_lZw=k-s128", "display_name": "Joshua DeMoss", "link": "https://stackoverflow.com/users/14294408/joshua-demoss"}, "is_accepted": false, "score": 1, "last_activity_date": 1616734295, "creation_date": 1616734295, "answer_id": 66811229, "question_id": 39472669, "link": "https://stackoverflow.com/questions/39472669/ruby-active-model-serializer-with-jsonapi-how-to-characterise-links/66811229#66811229", "title": "Ruby Active model serializer with jsonapi , how to characterise links", "body": "<p>Going off of FredyK's answer, <a href=\"https://github.com/jsonapi-serializer/jsonapi-serializer\" rel=\"nofollow noreferrer\">JSONAPI-SERIALIZER</a>, is a lightweight no-rails serializer for your ruby objects (even though it does have rails integration if desired) which could be a much simpler solution than using Active Record.</p>\n<p>Also if you are not using rails, <a href=\"https://github.com/jsonapi-serializer/jsonapi-serializer\" rel=\"nofollow noreferrer\">JSONAPI-SERIALIZER</a> pairs really well with the new gem <a href=\"https://github.com/easy-jsonapi\" rel=\"nofollow noreferrer\">EASY-JSONAPI</a>, which is a middleware, parser, and response validator for JSON:API requests and responses.</p>\n"}], "owner": {"reputation": 172, "user_id": 4503232, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/z2jpl.png?s=128&g=1", "display_name": "FredyK", "link": "https://stackoverflow.com/users/4503232/fredyk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 941, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1616734295, "creation_date": 1473777363, "question_id": 39472669, "link": "https://stackoverflow.com/questions/39472669/ruby-active-model-serializer-with-jsonapi-how-to-characterise-links", "title": "Ruby Active model serializer with jsonapi , how to characterise links", "body": "<p>I am using active model serializer and jsonapi format</p>\n\n<p>I need to get :</p>\n\n<pre><code>{\n  \"data\": {\n    \"id\": \"1234\",\n    \"type\": \"search\",\n    \"relationships\": {\n      \"foo\": {\n        \"data\": [\n          {\n            \"id\": \"12\",\n            \"type\": \"foo\"\n          }\n        ],\n       \"links\": \"/foo/12\"\n      },        \n    }\n  },\n</code></pre>\n\n<p>I have tried several configuration for links but it does not display as above</p>\n\n<pre><code>require 'active_model_serializers'\nmodule test\n class SearchSerializer &lt; ActiveModel::Serializer\n   has_one :foo,  data: true, links: {self: true, related: true}\n  type 'search'\n end\nend\n</code></pre>\n\n<p>I want to respect the jsonapi format \nIs anybody with a good example of active model serializer and json_api showing \"links\" as shwon on above json?</p>\n\n<p>At the moment only the following is displayed</p>\n\n<pre><code> {\"data\": {\n\"id\": \"1234\",\n\"type\": \"search\",\n\"relationships\": {\n  \"foo\": {\n    \"data\": [\n      {\n        \"id\": \"12\",\n        \"type\": \"foo\"\n      }\n    ]\n}\n</code></pre>\n\n<p>},</p>\n\n<p>Note also that I am trying to do that outside the rails framework.\nThanks</p>\n"}, {"tags": ["ruby", "inheritance", "methods", "scope", "namespaces"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 0, "creation_date": 1473777764, "post_id": 39472648, "comment_id": 66264966, "body": "using classes instead of modules won&#39;t improve the situation with duplicated methods. Something else is needed. It&#39;s hard to say what exactly, though, as we don&#39;t know this app."}, {"owner": {"reputation": 41082, "user_id": 82592, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e1b105626dd9cfd15e543af82e470fd7?s=128&d=identicon&r=PG", "display_name": "Mladen Jablanovi\u0107", "link": "https://stackoverflow.com/users/82592/mladen-jablanovi%c4%87"}, "edited": false, "score": 0, "creation_date": 1473777784, "post_id": 39472648, "comment_id": 66264976, "body": "Perhaps giving an actual example of the two classes that you plan to combine would help others give the best solution."}, {"owner": {"reputation": 1344, "user_id": 3849063, "user_type": "registered", "profile_image": "https://graph.facebook.com/100003547133097/picture?type=large", "display_name": "Vladimir Chervanev", "link": "https://stackoverflow.com/users/3849063/vladimir-chervanev"}, "edited": false, "score": 0, "creation_date": 1473832705, "post_id": 39472648, "comment_id": 66285245, "body": "From your description it&#39;s not obvious why you&#39;re using methods - looks like some DSL or data files (text, json, etc) and their handlers bring the same results in a more pleasant way."}, {"owner": {"reputation": 1799, "user_id": 1786393, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/656a424090d82cf108c754be9e07d5b0?s=128&d=identicon&r=PG", "display_name": "Giorgio Robino", "link": "https://stackoverflow.com/users/1786393/giorgio-robino"}, "edited": false, "score": 0, "creation_date": 1473846902, "post_id": 39472648, "comment_id": 66292965, "body": "yes, you are right Vladimir, all.  I claimed to use def in modules, avoiding creation of new instances of classes in run time (for performances reason), but in facts in Ruby is more pleasant / correct to use classes inheritance and instances with a maybe lack of performnaces; I&#39;m rengineering in this way"}], "owner": {"reputation": 1799, "user_id": 1786393, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/656a424090d82cf108c754be9e07d5b0?s=128&d=identicon&r=PG", "display_name": "Giorgio Robino", "link": "https://stackoverflow.com/users/1786393/giorgio-robino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 19, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1473777280, "creation_date": 1473777280, "question_id": 39472648, "link": "https://stackoverflow.com/questions/39472648/classes-vs-modules-in-ruby-ho-to-manage-a-lot-of-instance-methods", "title": "classes vs modules in Ruby: ho to manage a lot of instance methods ?", "body": "<p>I'm working on a chatbot dialog manager, where a dialog is kindof an aggregation of many dialogs (where a dialog is a set of methods). </p>\n\n<p>The first approach is to have a Dialog class that include methods \"encapsulated\" in modules:</p>\n\n<pre><code># file dialog1.rb\nmodule Dialog1\n  def method1_1\n    puts 'method1_1'\n  end\n  def method1_2\n    puts 'method1_2'\n  end\n  def method_common\n    puts 'method_common_1'\n  end\n  def method1_N\n    # ...\n  end\nend\n\n# file dialog2.rb\nmodule Dialog2\n  def method2_1\n    puts 'method2_1'\n  end\n  def method_common\n    puts 'method_common_2'\n  end\n  def method2_M\n    # ...\n  end\nend\n\nrequire 'file1'\nrequire 'file2'\n# ...\n\nclass Dialog   \n  include Dialog1\n  include Dialog2\n  # ... \nend\n</code></pre>\n\n<p>I'm perplex and I do not like too much this solution; in this way I have possible duplicate methods side effects ( In Ruby duplicated methods are allowed :( ); by example in case of <code>method_common</code> method:</p>\n\n<pre><code>dialog = Dialog.new.method_common\n# method_common_2\n</code></pre>\n\n<p>Maybe a reenigineering with classes could be better. \nWhat I'd prefer is to have the Dialog instance as a full join (\"aggregation\") of methods of all dialogs, but I don't know how to implement it. Any idea ?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "actionviewhelper"], "answers": [{"tags": [], "owner": {"reputation": 41, "user_id": 3162350, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FP3gU.jpg?s=128&g=1", "display_name": "tlemens", "link": "https://stackoverflow.com/users/3162350/tlemens"}, "is_accepted": false, "score": 1, "last_activity_date": 1482137899, "creation_date": 1482137899, "answer_id": 41218931, "question_id": 39472591, "link": "https://stackoverflow.com/questions/39472591/how-to-use-helper-methods-to-access-elements-from-options-from-collection-for-se/41218931#41218931", "title": "How to use helper methods to access elements from options_from_collection_for_select", "body": "<pre><code>options_from_collection_for_select(collection, value_method, -&gt;(element) { I18n.interpolate(\"car.mileage\",mileage: element[:mileage]) })\n</code></pre>\n\n<p>The :value_method and :text_method parameters are methods to be called on each member of collection. The return values are used as the value attribute and contents of each check box tag, respectively. They can also be any object that responds to call, such as a proc, that will be called for each member of the collection to retrieve the value/text.</p>\n"}], "owner": {"reputation": 951, "user_id": 717216, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/24825a1dc9410edc67f68c38bfb1ccf5?s=128&d=identicon&r=PG", "display_name": "absessive", "link": "https://stackoverflow.com/users/717216/absessive"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1482137899, "creation_date": 1473777119, "question_id": 39472591, "link": "https://stackoverflow.com/questions/39472591/how-to-use-helper-methods-to-access-elements-from-options-from-collection-for-se", "title": "How to use helper methods to access elements from options_from_collection_for_select", "body": "<p>The docs state \n<code>options_from_collection_for_select(collection, value_method, text_method, selected = nil)</code> has to have elements that <code>respond_to?</code> the <code>value_method</code> and the <code>text_method</code>.</p>\n\n<p>What if my <code>collection</code> is an array of hashes and I need to use some helper methods for <code>value_method</code> and <code>text_method</code>?</p>\n\n<p>For example,</p>\n\n<pre><code>collection = [{\n                model: \"LaF\"\n                year: 2016,\n                mileage: 1230\n             },\n             {\n                model: \"P1\",\n                year: 2015,\n                mileage: 1311\n             },\n             {\n                model: \"918\",\n                year: 2015,\n                mileage: 2448\n             }\n</code></pre>\n\n<p>]</p>\n\n<p>For example: I want to be able to use the <code>I18n.interpolate(\"car.mileage\",mileage: element[:mileage])</code>, method on the <code>model</code> key of each element.</p>\n\n<p>TL;DR: How to call hash key methods or other helper methods on <code>options_from_collection_for_select</code> elements?</p>\n"}, {"tags": ["ruby", "sinatra"], "answers": [{"tags": [], "owner": {"reputation": 47232, "user_id": 1772830, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Qtoqg.jpg?s=128&g=1", "display_name": "Andrey Deineko", "link": "https://stackoverflow.com/users/1772830/andrey-deineko"}, "is_accepted": true, "score": 1, "last_activity_date": 1473776745, "creation_date": 1473776745, "answer_id": 39472463, "question_id": 39472110, "link": "https://stackoverflow.com/questions/39472110/undefined-method-authenticated-form-mainobject/39472463#39472463", "title": "Undefined method authenticated? form main::Object", "body": "<p>According to <a href=\"http://www.sinatrarb.com/extensions.html\" rel=\"nofollow\">docs</a> you'd use your <code>authenticated?</code> method as follows:</p>\n\n<pre><code>get '/' do\n  if authenticated?\n    # something\n  else\n    # something else\n  end\nend\n</code></pre>\n"}], "owner": {"reputation": 1035, "user_id": 5846366, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/ALAtx.jpg?s=128&g=1", "display_name": "AlexNikolaev94", "link": "https://stackoverflow.com/users/5846366/alexnikolaev94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 36, "favorite_count": 0, "accepted_answer_id": 39472463, "answer_count": 1, "score": 1, "last_activity_date": 1473776745, "creation_date": 1473775628, "question_id": 39472110, "link": "https://stackoverflow.com/questions/39472110/undefined-method-authenticated-form-mainobject", "title": "Undefined method authenticated? form main::Object", "body": "<p>I'm learning Sinatra now and I'm building a tiny blog. I've got a little problem with an <code>authenticated?</code> method. I've set up authentication, and now I want the rest of my app to be loaded only when the user is authenticated. So, in my <code>app.rb</code> I have the following:</p>\n\n<pre><code>helpers do\n  def current_user\n    @current_user ||= User.find(session[:user_id]) if session[:user_id]\n  end\n\n  def authenticated?\n    redirect '/login' unless current_user\n  end\nend\n\nif authenticated?\n  # get '/' { ... }\n  # get '/new' { ... }\n  # post '/new' { ... }\n  # the rest of an app (creating, updating and deleting posts go here)\nend\n</code></pre>\n\n<p>When I run the app, it returns me the following error</p>\n\n<pre><code>undefined method authenticated? form main::Object\n</code></pre>\n\n<p>What have I done wrong?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "assets"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6574649"}, "edited": false, "score": 0, "creation_date": 1473847722, "post_id": 39472097, "comment_id": 66293479, "body": "what do you recommend for mobile assets? a separate folder  &quot;my_rails_project/app/mobile_assets&quot; with the same structure as the normal &quot;assets&quot; one?"}], "tags": [], "owner": {"reputation": 208794, "user_id": 229044, "user_type": "moderator", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/591426cbbacd4025d920467bad356911?s=128&d=identicon&r=PG&f=1", "display_name": "meagar", "link": "https://stackoverflow.com/users/229044/meagar"}, "is_accepted": false, "score": 2, "last_activity_date": 1473775586, "creation_date": 1473775586, "answer_id": 39472097, "question_id": 39471528, "link": "https://stackoverflow.com/questions/39471528/trying-to-add-a-custom-folder-to-assets-path/39472097#39472097", "title": "Trying to add a custom folder to assets path", "body": "<p>That isn't how you access the asset pipeline. All of your URLs should begin with <code>/assets/</code>, and the path is the path to the file <em>minus</em> the leading subdirectory.</p>\n\n<p>For example: <code>app/assets/javascripts/test.js</code> is accessed publicly at</p>\n\n<pre><code>http://example.com/assets/test.js\n</code></pre>\n\n<p>In your case, you should be looking at</p>\n\n<pre><code>http://example.com/assets/my_font1.ttf\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6574649"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 881, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1473775586, "creation_date": 1473773882, "question_id": 39471528, "link": "https://stackoverflow.com/questions/39471528/trying-to-add-a-custom-folder-to-assets-path", "title": "Trying to add a custom folder to assets path", "body": "<p>I'm trying to add a custome folder to the assets path:</p>\n\n<pre><code>module MyApp\n  class Application &lt; Rails::Application\n    config.assets.paths &lt;&lt; Rails.root.join(\"something....\")\n    # ....\n    config.assets.paths &lt;&lt; Rails.root.join(\"app\", \"my_folder1\", \"fonts\")\n</code></pre>\n\n<p>I've restarted my app and when go directly to <code>http://localhost:3000/my_folder1/fonts/my_font1.ttf</code> or <code>http://localhost:3000/my_folder1/my_font1.ttf</code> in a browser, I get the <code>error 404</code>. Why? How to fix it? Note, \nit's in the folder \"my_folder1\" on purpose.</p>\n"}, {"tags": ["ruby", "variable-assignment"], "answers": [{"tags": [], "owner": {"reputation": 7224, "user_id": 448934, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TXtux.jpg?s=128&g=1", "display_name": "Pascal", "link": "https://stackoverflow.com/users/448934/pascal"}, "is_accepted": true, "score": 2, "last_activity_date": 1473776046, "creation_date": 1473776046, "answer_id": 39472248, "question_id": 39471424, "link": "https://stackoverflow.com/questions/39471424/ruby-assignment-to-elements-of-an-array/39472248#39472248", "title": "Ruby: assignment to elements of an array", "body": "<p>The way you construct the array does not cretae new arrays for each row but <strong>references</strong> the same array for all rows:</p>\n\n<pre><code>t.each do |row|\n  p row.object_id\nend\n\n# 70325094342320\n# 70325094342320\n# 70325094342320\n</code></pre>\n\n<p>It is the same as:</p>\n\n<pre><code>a = [1, 1, 1]\nt = [a, a, a]\n</code></pre>\n\n<p>Try this to see the difference:</p>\n\n<pre><code>t = [[1] * 3, [1] * 3, [1] * 3]\n</code></pre>\n"}], "owner": {"reputation": 903, "user_id": 5356755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570f3672a55a694a790e5231623f434e?s=128&d=identicon&r=PG", "display_name": "Nex", "link": "https://stackoverflow.com/users/5356755/nex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "accepted_answer_id": 39472248, "answer_count": 1, "score": 2, "last_activity_date": 1473776046, "creation_date": 1473773556, "last_edit_date": 1473773814, "question_id": 39471424, "link": "https://stackoverflow.com/questions/39471424/ruby-assignment-to-elements-of-an-array", "title": "Ruby: assignment to elements of an array", "body": "<p>I'm a  beginner and I want to create a matrix. For example:</p>\n\n<p>0 1 1<br>\n1 1 1<br>\n1 1 2</p>\n\n<pre><code>irb(main):001:0&gt; t = [[1]*3]*3\n=&gt; [[1, 1, 1], [1, 1, 1], [1, 1, 1]]\nirb(main):002:0&gt; (0...3).each do |x| t[x][x]=x end\n=&gt; 0...3\nirb(main):003:0&gt; t\n=&gt; [[0, 1, 2], [0, 1, 2], [0, 1, 2]] # why all values changed?\n</code></pre>\n\n<p>What's wrong?</p>\n"}, {"tags": ["arrays", "ruby", "hash"], "answers": [{"tags": [], "owner": {"reputation": 1128, "user_id": 3973117, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f52a78aa4cf83a8372e28a27ce3511c?s=128&d=identicon&r=PG", "display_name": "jan.zikan", "link": "https://stackoverflow.com/users/3973117/jan-zikan"}, "is_accepted": true, "score": 1, "last_activity_date": 1473773562, "creation_date": 1473773562, "answer_id": 39471428, "question_id": 39471348, "link": "https://stackoverflow.com/questions/39471348/creating-hash-from-array-adding-new-keys/39471428#39471428", "title": "Creating hash from array adding new keys", "body": "<pre><code>data.map { |arr| { 'name' =&gt; arr[0], 'rep' =&gt; arr[1] } }\n</code></pre>\n\n<p>i would rather use symbols as hash keys</p>\n\n<pre><code>data.map { |arr| { name: arr[0], rep: arr[1] } }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5175, "user_id": 4370109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UcQgO.jpg?s=128&g=1", "display_name": "Brian Tompsett - \u6c64\u83b1\u6069", "link": "https://stackoverflow.com/users/4370109/brian-tompsett-%e6%b1%a4%e8%8e%b1%e6%81%a9"}, "edited": false, "score": 0, "creation_date": 1473854147, "post_id": 39471467, "comment_id": 66297182, "body": "Please edit with more information. Code-only and &quot;try this&quot; answers are discouraged, because they contain no searchable content, and don&#39;t explain why someone should &quot;try this&quot;. We make an effort here to be a resource for knowledge."}], "tags": [], "owner": {"reputation": 3381, "user_id": 220679, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a5c165ffc801b46ddff8851d5b49bf3e?s=128&d=identicon&r=PG", "display_name": "Ginty", "link": "https://stackoverflow.com/users/220679/ginty"}, "is_accepted": false, "score": 0, "last_activity_date": 1473773675, "creation_date": 1473773675, "answer_id": 39471467, "question_id": 39471348, "link": "https://stackoverflow.com/questions/39471348/creating-hash-from-array-adding-new-keys/39471467#39471467", "title": "Creating hash from array adding new keys", "body": "<pre><code>data.map { |name, rep| { 'name' =&gt; name.to_s, 'rep' =&gt; rep.to_s } }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93653, "user_id": 256970, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/87b71ecb90417c88f7873a2f0f9492e9?s=128&d=identicon&r=PG", "display_name": "Cary Swoveland", "link": "https://stackoverflow.com/users/256970/cary-swoveland"}, "is_accepted": false, "score": 1, "last_activity_date": 1473781309, "creation_date": 1473781309, "answer_id": 39474053, "question_id": 39471348, "link": "https://stackoverflow.com/questions/39471348/creating-hash-from-array-adding-new-keys/39474053#39474053", "title": "Creating hash from array adding new keys", "body": "<p>If you wish to create an array of two hashes, each having the same two keys, the other answers are fine. The following handles the case where there are an arbitrary number of keys and <code>data</code> may contain an arbitrary number of elements.</p>\n\n<pre><code>def hashify(keys, arr_of_vals)\n  [keys].product(arr_of_vals).map { |ak,av| Hash[ak.zip(av)] }\nend\n\nkeys = %w| name rep |\n  #=&gt; [\"name\", \"rep\"] \narr_of_vals = [[\"01\", \"777\"], [\"02\", \"888\"]]\nhashify(keys, arr_of_vals)\n  #=&gt; [{\"name\"=&gt;\"01\", \"rep\"=&gt;\"777\"}, {\"name\"=&gt;\"02\", \"rep\"=&gt;\"888\"}]\n</code></pre>\n\n<p>In your problem <code>arr_of_vals</code> must first be derived from <code>[[1, 777], [02, 888]]</code>, but that is a secondary (rather mundane) problem that I will not address.</p>\n\n<p>Another example:</p>\n\n<pre><code>keys = %w| name rep group |\n  #=&gt; [\"name\", \"rep\", \"group\"] \narr_of_vals = [[1, 777, 51], [2, 888, 52], [1, 2, 53], [3, 4, 54]]\nhashify(keys, arr_of_vals)\n  #=&gt; [{\"name\"=&gt;1, \"rep\"=&gt;777, \"group\"=&gt;51}, {\"name\"=&gt;2, \"rep\"=&gt;888, \"group\"=&gt;52},\n  #    {\"name\"=&gt;1, \"rep\"=&gt;2, \"group\"=&gt;53}, {\"name\"=&gt;3, \"rep\"=&gt;4, \"group\"=&gt;54}] \n</code></pre>\n"}], "owner": {"reputation": 193, "user_id": 6500563, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/79d8d08238533616559c33c5650255b1?s=128&d=identicon&r=PG&f=1", "display_name": "mila002", "link": "https://stackoverflow.com/users/6500563/mila002"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 39471428, "answer_count": 3, "score": 3, "last_activity_date": 1473781309, "creation_date": 1473773344, "last_edit_date": 1473773680, "question_id": 39471348, "link": "https://stackoverflow.com/questions/39471348/creating-hash-from-array-adding-new-keys", "title": "Creating hash from array adding new keys", "body": "<p>I have an array looking like this:</p>\n\n<pre><code>data =[[01, 777], [02, 888]]\n</code></pre>\n\n<p>Now I want to create a hash from it like below:</p>\n\n<pre><code>n_clip = [{\"name\"=&gt;\"01\", \"rep\"=&gt;\"777\"},{\"name\"=&gt;\"02\", rep=&gt;\"888\"}]\n</code></pre>\n\n<p>I tried to do this in that way:</p>\n\n<pre><code>n_clip = []\ndata.each do |a|\nn_clip &lt;&lt; Array[Hash[a.map {|| [\"name\", a.first]}], Hash[a.map {|| [\"rep\", a.last]}]]\nend\n</code></pre>\n\n<p>but it doesn't work because I get:</p>\n\n<pre><code>n_clip = [[{\"name\"=&gt;\"01\"},{\"rep\"=\"777\"}], [{\"name\"=&gt;\"01\"},{\"rep\"=\"777\"}]]\n</code></pre>\n\n<p>and definitively it isn't what I expected.</p>\n"}, {"tags": ["javascript", "ruby-on-rails", "ruby", "ruby-on-rails-3", "asset-pipeline"], "answers": [{"comments": [{"owner": {"reputation": 2901, "user_id": 1187022, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/BKkbA.jpg?s=128&g=1", "display_name": "Lev", "link": "https://stackoverflow.com/users/1187022/lev"}, "edited": false, "score": 0, "creation_date": 1473790091, "post_id": 39472266, "comment_id": 66272100, "body": "Can you please provide an example of directory structure which contains third party javascript? Do you mean sth like this: public/angular/angular.js, angular-messages.js etc.? (let&#39;s say we don&#39;t use angularjs gem and include .js files directly)."}], "tags": [], "owner": {"reputation": 3997, "user_id": 3998420, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55ea542584d3fd2a430c3d409bdafc95?s=128&d=identicon&r=PG&f=1", "display_name": "bkunzi01", "link": "https://stackoverflow.com/users/3998420/bkunzi01"}, "is_accepted": true, "score": 2, "last_activity_date": 1473818970, "last_edit_date": 1473818970, "creation_date": 1473776101, "answer_id": 39472266, "question_id": 39471313, "link": "https://stackoverflow.com/questions/39471313/rails-asset-pipeline-require-from-public-folder/39472266#39472266", "title": "Rails asset pipeline require from public folder?", "body": "<p>Thirdparty js files should be in your vendor folder.  Once you precompile them for production they will be then moved into your public folder automagically.  To call certain files on specific pages you need to remove the require_tree directive and also pay attention to which files are called in your application.js asset file.  At the bottom of every view page (html.erb) you can add the following to run only page specific js:</p>\n\n<pre><code>&lt;%= content_for :javascript do %&gt;\n  &lt;script type='text/javascript'&gt;\n    YOUR FUNCTIONS HERE\n  &lt;/script&gt;\n&lt;% end %&gt;\n</code></pre>\n\n<p>Then in your application/layout view at the bottom before the closing body tag you should add:</p>\n\n<pre><code>&lt;%= javascript_include_tag params[:controller] if Rails.application.assets_manifest.assets[\"#{params[:controller]}.js\"] %&gt;\n&lt;%=yield :javascript %&gt;\n</code></pre>\n\n<p>This will then run any js on a page by page view basis and include any require statements for any files in the corresponding controller's js asset file.  </p>\n\n<p>UPDATE to address comment:  If you have a gem you installed and then need to require certain js files, these should be required from your app/assets/javascripts folder in either the application.js file (if you want that gem to be usable throughout your application) or in the controller specific js file if you only need that functionality on a few pages.  For example, the angular gem is probably used throughout your application so you would add the //=require statement to the application.js file in your app/assets/javascripts folder.  If you manually download some js libraries you should put them in the vendor/javascripts folder however you still require them in your app/assets/javascripts folder files wherever needed.</p>\n"}], "owner": {"reputation": 2901, "user_id": 1187022, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/BKkbA.jpg?s=128&g=1", "display_name": "Lev", "link": "https://stackoverflow.com/users/1187022/lev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 839, "favorite_count": 0, "accepted_answer_id": 39472266, "answer_count": 1, "score": 0, "last_activity_date": 1473818970, "creation_date": 1473773213, "question_id": 39471313, "link": "https://stackoverflow.com/questions/39471313/rails-asset-pipeline-require-from-public-folder", "title": "Rails asset pipeline require from public folder?", "body": "<p>Is this a good practice to require assets located under public folder? e.g. I have lots of javascript under public/mythirdparyjs folder and I want to make these javascript files available for only specific page, what will be the best way to do this?</p>\n"}, {"tags": ["javascript", "jquery", "ruby-on-rails", "ruby"], "comments": [{"owner": {"reputation": 1506, "user_id": 4265308, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/GOuYQ.jpg?s=128&g=1", "display_name": "Pooja Mokariya", "link": "https://stackoverflow.com/users/4265308/pooja-mokariya"}, "edited": false, "score": 0, "creation_date": 1473773302, "post_id": 39471250, "comment_id": 66261884, "body": "try with this #{@record.id.present? ? _(&#39;Save&#39;) : _(&#39;Create&#39;)}"}, {"owner": {"reputation": 1506, "user_id": 4265308, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/GOuYQ.jpg?s=128&g=1", "display_name": "Pooja Mokariya", "link": "https://stackoverflow.com/users/4265308/pooja-mokariya"}, "edited": false, "score": 0, "creation_date": 1473773338, "post_id": 39471250, "comment_id": 66261910, "body": "and why you have put _(&#39;Save&#39;) like this ?"}], "answers": [{"tags": [], "owner": {"reputation": 1506, "user_id": 4265308, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/GOuYQ.jpg?s=128&g=1", "display_name": "Pooja Mokariya", "link": "https://stackoverflow.com/users/4265308/pooja-mokariya"}, "is_accepted": false, "score": 1, "last_activity_date": 1473773453, "creation_date": 1473773453, "answer_id": 39471387, "question_id": 39471250, "link": "https://stackoverflow.com/questions/39471250/ruby-on-rails-confirm-on-submit-tag-with-condition/39471387#39471387", "title": "Ruby on rails confirm on submit tag with condition", "body": "<p>Try this hope it will work </p>\n\n<pre><code>@record_id = @record.id\n\n&lt;%=submit_tag \"#{ @record_id.present? ? 'Save' : 'Create'}\", :class=&gt;\"btn primary med\", data: {:confirm =&gt; \"Are you sure?\"} %&gt;\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5198598"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 945, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1473773453, "creation_date": 1473773036, "question_id": 39471250, "link": "https://stackoverflow.com/questions/39471250/ruby-on-rails-confirm-on-submit-tag-with-condition", "title": "Ruby on rails confirm on submit tag with condition", "body": "<p>On my edit page I will need to make a confirm box pop up if you try to set the end date before the start date.</p>\n\n<p>I have a submit button, but need to get a confirm box coming up when the button is pressed but only if you have moved the end date before the start date. If you have not moved the end date before the start date it will not pop up.</p>\n\n<p>I have so far used </p>\n\n<pre><code>&lt;%=submit_tag \"#{@record.id ? _('Save') : _('Create')}\", :class=&gt;\"btn primary med\", data: {:confirm =&gt; \"Are you sure?\"} %&gt;\n</code></pre>\n\n<p>but that doesn't do anything at all.</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "activerecord", "rails-activerecord"], "answers": [{"tags": [], "owner": {"reputation": 19261, "user_id": 4758119, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/F4dJY.jpg?s=128&g=1", "display_name": "Deepak Mahakale", "link": "https://stackoverflow.com/users/4758119/deepak-mahakale"}, "is_accepted": true, "score": 2, "last_activity_date": 1473771562, "creation_date": 1473771562, "answer_id": 39470733, "question_id": 39470547, "link": "https://stackoverflow.com/questions/39470547/get-specific-user-from-many-to-many-associations/39470733#39470733", "title": "Get specific user from many to many associations", "body": "<p>You can get it using</p>\n\n<pre><code>User.joins(:user_tasks).where(user_tasks: { user_type: 0 })\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 6412010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3f5057043b6c35d36a6069bfa548b5c?s=128&d=identicon&r=PG&f=1", "display_name": "Taras Shpachenko", "link": "https://stackoverflow.com/users/6412010/taras-shpachenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 39470733, "answer_count": 1, "score": 0, "last_activity_date": 1473771562, "creation_date": 1473770995, "question_id": 39470547, "link": "https://stackoverflow.com/questions/39470547/get-specific-user-from-many-to-many-associations", "title": "Get specific user from many to many associations", "body": "<p>I have many to many association through UserTask table. I need to get user with type creator from task (task.creator). It should be like task.user_tasks.where(user_type: 0) but with rails associations. Is it possible?</p>\n\n<p>Here is my User model</p>\n\n<pre><code>class User &lt; ApplicationRecord\n  has_many :user_tasks, foreign_key: 'user_email', primary_key: 'email'\n  has_many :tasks, through: :user_tasks\nend\n</code></pre>\n\n<p>Here is my Task model</p>\n\n<pre><code>class Task &lt; ApplicationRecord\n  has_many :user_tasks, dependent: :destroy\n  has_many :users, through: :user_tasks\nend\n</code></pre>\n\n<p>Here is my UserTask model</p>\n\n<pre><code>class UserTask &lt; ApplicationRecord\n  belongs_to :user, foreign_key: 'user_email', primary_key: 'email'\n  belongs_to :task\n  enum user_type: [:creator, :allowed]\nend\n</code></pre>\n"}, {"tags": ["ruby", "reddit"], "answers": [{"tags": [], "owner": {"reputation": 7073, "user_id": 1279844, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d04dbd9bc38b19a88ae7cc28ed70a0d6?s=128&d=identicon&r=PG", "display_name": "bevanb", "link": "https://stackoverflow.com/users/1279844/bevanb"}, "is_accepted": false, "score": 0, "last_activity_date": 1558875440, "creation_date": 1558875440, "answer_id": 56313712, "question_id": 39469670, "link": "https://stackoverflow.com/questions/39469670/how-to-get-reddit-submission-by-fullname-using-redd-gem/56313712#56313712", "title": "How to get Reddit submission by fullname using Redd gem?", "body": "<p>You need to call <code>r.authorize!</code> before <code>r.from_fullname</code></p>\n"}], "owner": {"reputation": 3339, "user_id": 1654940, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/88c65dba018958bb6462c0530016ec3b?s=128&d=identicon&r=PG", "display_name": "Marcin Doliwa", "link": "https://stackoverflow.com/users/1654940/marcin-doliwa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 112, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1558875440, "creation_date": 1473768387, "question_id": 39469670, "link": "https://stackoverflow.com/questions/39469670/how-to-get-reddit-submission-by-fullname-using-redd-gem", "title": "How to get Reddit submission by fullname using Redd gem?", "body": "<p>I'm trying to get submission by fullname using Redd gem (<a href=\"https://github.com/avinashbot/redd\" rel=\"nofollow\">https://github.com/avinashbot/redd</a>):</p>\n\n<pre><code>r = Redd.it(:userless, 'client_id', 'secret_id', user_agent: 'comment streamer')\nr.from_fullname('t3_52jtld')\n</code></pre>\n\n<p>But get error:</p>\n\n<p><code>NameError: uninitialized constant Redd::Response::ParseJson::JSONError</code></p>\n\n<p>How should I do this?</p>\n"}, {"tags": ["ruby-on-rails", "ruby", "delayed-job"], "answers": [{"tags": [], "owner": {"reputation": 1061, "user_id": 1651458, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/DQZz9.jpg?s=128&g=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/1651458/sam"}, "is_accepted": true, "score": 0, "last_activity_date": 1473782358, "creation_date": 1473782358, "answer_id": 39474379, "question_id": 39469206, "link": "https://stackoverflow.com/questions/39469206/how-to-allow-delayed-function-to-be-delayed-in-rails-test-environment/39474379#39474379", "title": "How to allow delayed function to be delayed in Rails test environment", "body": "<p>This is so simple, I'm surprised and embarrassed I didn't find it before writing this up. I guess the default is <code>false</code> in the test environment?</p>\n\n<pre><code>2.3.1 :003 &gt; Delayed::Worker.delay_jobs = true\n2.3.1 :004 &gt; x = MyClass.new\n2.3.1 :005 &gt; x.save!\n2.3.1 :006 &gt; x.fn_with_dj_delay\n   (0.2ms)  BEGIN\n  SQL (0.4ms)  INSERT INTO `delayed_jobs` (`handler`, `run_at`, # ...\n   (0.5ms)  COMMIT\n =&gt; true\n2.3.1 :007 &gt; Delayed::Job.last\n    Delayed::Backend::ActiveRecord::Job Load (2.2ms)  SELECT  `delayed_jobs`.* # ...\n =&gt; #&lt;Delayed::Backend::ActiveRecord::Job id: 1, priority: 0, attempts: 0 # ..\n</code></pre>\n\n<p><a href=\"https://www.sitepoint.com/delayed-jobs-best-practices/\" rel=\"nofollow\">As seen (in reverse) here.</a></p>\n"}], "owner": {"reputation": 1061, "user_id": 1651458, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/DQZz9.jpg?s=128&g=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/1651458/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "accepted_answer_id": 39474379, "answer_count": 1, "score": 0, "last_activity_date": 1473782358, "creation_date": 1473767023, "question_id": 39469206, "link": "https://stackoverflow.com/questions/39469206/how-to-allow-delayed-function-to-be-delayed-in-rails-test-environment", "title": "How to allow delayed function to be delayed in Rails test environment", "body": "<p>I have a Rails model class with a function to be executed at a later time, which is managed by <code>Delayed::Job</code>. Here is the function (simplified):</p>\n\n<pre><code>def fn_with_dj_delay\n  puts \"puts output here\"\n  do_somethting_else  \nend\nhandle_asynchronously :fn_with_dj_delay, :run_at =&gt; Proc.new { 24.hours.from_now }, :queue =&gt; 'my_queue'\n</code></pre>\n\n<p>When the function is called in my Rails test environment however, the delaying is being skipped. Is it possible for this to perform the same in both environments?</p>\n\n<p>In <code>rails c test</code> the function fires immediately. Here is a slightly simplified and truncated console log:</p>\n\n<pre><code>2.3.1 :004 &gt; x = MyClass.new\n2.3.1 :005 &gt; x.save!\n2.3.1 :006 &gt; x.fn_with_dj_delay\nputs output here\n =&gt; #&lt;Delayed::Backend::ActiveRecord::Job id: nil, priority: 0, attempts: 0 # ...\n2.3.1 :007 &gt; Delayed::Job.last\n  Delayed::Backend::ActiveRecord::Job Load (0.3ms)  SELECT  `delayed_jobs`.*  # ...\n =&gt; nil\n</code></pre>\n\n<p>In <code>rails c</code> the function is automatically delayed as instructed. Again, a slightly simplified and truncated console log:</p>\n\n<pre><code>2.3.1 :004 &gt; x = MyClass.new\n2.3.1 :005 &gt; x.save!\n2.3.1 :006 &gt; x.fn_with_dj_delay\n   (0.2ms)  BEGIN\n  SQL (0.4ms)  INSERT INTO `delayed_jobs` (`handler`, `run_at`, # ...\n   (0.5ms)  COMMIT\n =&gt; true\n2.3.1 :007 &gt; Delayed::Job.last\n    Delayed::Backend::ActiveRecord::Job Load (2.2ms)  SELECT  `delayed_jobs`.* # ...\n =&gt; #&lt;Delayed::Backend::ActiveRecord::Job id: 1, priority: 0, attempts: 0 # ...\n</code></pre>\n\n<p>The only clue I can see is the returned, uninstantiated  <code>Delayed::Backend::ActiveRecord::Job</code> object in the test console when the function finishes. If there is something invalid about the object, I could understand this failure, though I would expect an error to be raised. Regardless, this is not at issue:</p>\n\n<pre><code>2.3.1 :004 &gt; res = p.check_for_similar_web_data\nputs output here\n =&gt; #&lt;Delayed::Backend::ActiveRecord::Job id: nil, priority: 0, attempts: 0 # ...\n2.3.1 :005 &gt; res.valid?\n =&gt; true\n2.3.1 :006 &gt; res.save!\n   (0.1ms)  BEGIN\n  SQL (0.4ms)  INSERT INTO `delayed_jobs` (`handler`, `run_at` # ...\n   (0.5ms)  COMMIT\n =&gt; true\n</code></pre>\n"}, {"tags": ["ruby-on-rails", "ruby", "ruby-on-rails-4", "url", "rubygems"], "comments": [{"owner": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1473765694, "post_id": 39468549, "comment_id": 66257311, "body": "by default/convention, you will always find ids in rails like that <code>subscriberjobs&#47;id</code>, and then you just access it like <code>params[:id]</code>. In this case, you&#39;re also including <code>job_id</code> in your form, the thing here is that <code>simple_form_for</code> wraps the content from the form inside a <code>job</code> key in your <code>params</code>, so, you need to access it like <code>params[:job][:job_id]</code>."}, {"owner": {"reputation": 159, "user_id": 6789165, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2390e9333ab37c397ce2b94840de5864?s=128&d=identicon&r=PG&f=1", "display_name": "Gugubaight", "link": "https://stackoverflow.com/users/6789165/gugubaight"}, "reply_to_user": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1473767508, "post_id": 39468549, "comment_id": 66258335, "body": "I am not quite sure if that&#39;s what you meant: <code>@job = Job.find_by(id: params[:job][:job_id])</code>, but that creates this error: <code>NoMethodError in SubscriberjobsController#update undefined method &#39;[]&#39; for nil:NilClass</code>"}, {"owner": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1473772970, "post_id": 39468549, "comment_id": 66261678, "body": "your <code>simple_form_for</code> form is the one that fires the <code>update</code> that doesn&#39;t work, right ?. If so, would you mind pasting what you have in the rails log when that action gets triggered ?."}, {"owner": {"reputation": 159, "user_id": 6789165, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2390e9333ab37c397ce2b94840de5864?s=128&d=identicon&r=PG&f=1", "display_name": "Gugubaight", "link": "https://stackoverflow.com/users/6789165/gugubaight"}, "reply_to_user": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1473781018, "post_id": 39468549, "comment_id": 66267145, "body": "That&#39;s right. Here are the logs: <a href=\"https://www.dropbox.com/sh/kjgaih91ye7lr6p/AAA96hj7_-q7ZK3EemGt6tj9a?dl=0\" rel=\"nofollow noreferrer\">dropbox.com/sh/kjgaih91ye7lr6p/AAA96hj7_-q7ZK3EemGt6tj9a?dl=&zwnj;&#8203;0</a> - from loading the Form to the error after paying via Stripe :) Hope that helps"}, {"owner": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1473781696, "post_id": 39468549, "comment_id": 66267565, "body": "I see, there are some requests being made and at some point the update <code>&#47;subscriberjobs&#47;1</code> happens, just use <code>@job = Job.find_by(id: params[:id])</code> instead of <code>@job = Job.find_by(id: params[:job_id])</code>"}, {"owner": {"reputation": 159, "user_id": 6789165, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2390e9333ab37c397ce2b94840de5864?s=128&d=identicon&r=PG&f=1", "display_name": "Gugubaight", "link": "https://stackoverflow.com/users/6789165/gugubaight"}, "reply_to_user": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1473782661, "post_id": 39468549, "comment_id": 66268139, "body": "Hmm.. that fixes the error but the main problem which is that the values aren&#39;t getting updated is still there. I remember that I already did what you suggest."}, {"owner": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1473785668, "post_id": 39468549, "comment_id": 66269729, "body": "I can see in the response that you do get <code>stripeToken</code>, perhaps the <code>@job.save</code> is failing, put a <code>binding.pry</code> or <code>byebug</code>(whatever you use) after that line and check if there are any validation errors with <code>@job.errors</code>."}, {"owner": {"reputation": 159, "user_id": 6789165, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2390e9333ab37c397ce2b94840de5864?s=128&d=identicon&r=PG&f=1", "display_name": "Gugubaight", "link": "https://stackoverflow.com/users/6789165/gugubaight"}, "reply_to_user": {"reputation": 1479, "user_id": 2506819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b60435154915157dfd7ebfc04164930?s=128&d=identicon&r=PG", "display_name": "fanta", "link": "https://stackoverflow.com/users/2506819/fanta"}, "edited": false, "score": 0, "creation_date": 1473789409, "post_id": 39468549, "comment_id": 66271725, "body": "I figured something out! The <code>@job.save</code> works perfectly. Instead it just always updates the Job with <code>id == 1</code>. I don&#39;t know why but that should help. I made a full <code>db:reset</code>  and if I create a new Job and pay for it, the values change as intended - just only for the first one"}], "owner": {"reputation": 159, "user_id": 6789165, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/2390e9333ab37c397ce2b94840de5864?s=128&d=identicon&r=PG&f=1", "display_name": "Gugubaight", "link": "https://stackoverflow.com/users/6789165/gugubaight"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1473782947, "creation_date": 1473764937, "last_edit_date": 1473782947, "question_id": 39468549, "link": "https://stackoverflow.com/questions/39468549/rails-4-error-getting-parameters-from-url", "title": "Rails 4 Error: Getting Parameters from URL", "body": "<p>I am fairly new to rails and I am struggling getting the id param out of this url:</p>\n\n<pre><code>http://localhost:3000/subscriberjobs/new?job_id=13\n</code></pre>\n\n<p>Userflow:</p>\n\n<ol>\n<li><p>Form to setup their Job (below / Job Model) => </p>\n\n<pre><code>redirect_to \"/subscriberjobs/new?job_id=#{@job.id}\"\n</code></pre></li>\n<li>(Job Controller) => Getting Payment via Stripe </li>\n<li>(Subscriberjobs Controller) => Update the values of this Job.</li>\n</ol>\n\n<p>The last step does not work. On the one hand it always redirects to <code>/subscriberjobs/1</code> and on the other hand it does not update the Values (neither for Job 1 nor Job 13)</p>\n\n<p>Currently I am using this code to get it: (Subscriberjobs Controller)</p>\n\n<pre><code>def update\n  @job = Job.find_by(id: params[:id])\n\n  @job.is_active = true\n  @job.is_featured = false\n  @job.stripe_id = customer.id\n  @job.save\n\n  token = params[:stripeToken]\n\n  customer = Stripe::Customer.create(\n      card: token,\n      plan: 1004,\n      email: current_user.email\n      )\n  redirect_to root_path\nend\n</code></pre>\n\n<p>The Form:</p>\n\n<pre><code>= simple_form_for @job do |f|\n  = f.input :company, required: true\n  = f.input :title, required: true\n  = f.input :job_filename\n  = f.input :location, required: true\n  = f.input :sort\n  = f.input :tag_list, required: true\n  = f.input :content_one\n  = f.input :content_two\n  = f.input :content_three\n  = f.hidden_field :job_id, value: params[:id]\n  = f.button :submit\n</code></pre>\n\n<p>Any help on how to achieve what I am trying to do is much appreciated!</p>\n"}]