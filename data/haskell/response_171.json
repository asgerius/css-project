[{"tags": ["haskell", "io"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 3, "creation_date": 1524081799, "post_id": 49907975, "comment_id": 86832099, "body": "Add <code>deriving (Show)</code> to your data declaration. Do not overwrite <code>Show</code>. Write another function <code>versionNumber :: Version -&gt; String</code> for nonstandard <code>show</code>ing."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1524081875, "post_id": 49907975, "comment_id": 86832137, "body": "<code>print $ Version $ VersionNumber [ Just 1, Just 2, Nothing]</code> should work if you add <code>deriving Show</code> to the <code>Version</code> type, as you did for the others."}, {"owner": {"reputation": 5242, "user_id": 50962, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e39b7acdae85aedee02487bed17ff5f6?s=128&d=identicon&r=PG", "display_name": "altern", "link": "https://stackoverflow.com/users/50962/altern"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1524081989, "post_id": 49907975, "comment_id": 86832203, "body": "@chi: in this case it complains about <code>Duplicate instance declarations</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1524082459, "post_id": 49907975, "comment_id": 86832459, "body": "Oops I did not see the last <code>Show Version</code> instance. Is there any reason why you want to keep that instance instead of the default one?"}, {"owner": {"reputation": 5242, "user_id": 50962, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e39b7acdae85aedee02487bed17ff5f6?s=128&d=identicon&r=PG", "display_name": "altern", "link": "https://stackoverflow.com/users/50962/altern"}, "edited": false, "score": 0, "creation_date": 1524083098, "post_id": 49907975, "comment_id": 86832770, "body": "I just figured that I don&#39;t need to keep <code>Show Version</code> instance indeed. And that solves my problem of &#39;exporting&#39; object into Haskell representation."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1524082564, "creation_date": 1524082564, "answer_id": 49908322, "question_id": 49907975, "link": "https://stackoverflow.com/questions/49907975/output-haskell-object-omitting-show-declarations/49908322#49908322", "title": "Output haskell object omitting &#39;show&#39; declarations", "body": "<p>You can define your own function:</p>\n\n<pre><code>showIntact :: Version -&gt; String\nshowIntact (Version v) = \"Version \" ++ show v\nshowIntact (MaturityVersion ml vn) = \"MaturityVersion \" ++ show ml ++ \" \" ++ show vn\n</code></pre>\n\n<p>You can then use <code>putStrLn $ showIntact $ ....</code>.</p>\n"}], "owner": {"reputation": 5242, "user_id": 50962, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e39b7acdae85aedee02487bed17ff5f6?s=128&d=identicon&r=PG", "display_name": "altern", "link": "https://stackoverflow.com/users/50962/altern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 49908322, "answer_count": 1, "score": 0, "last_activity_date": 1524082564, "creation_date": 1524081250, "question_id": 49907975, "link": "https://stackoverflow.com/questions/49907975/output-haskell-object-omitting-show-declarations", "title": "Output haskell object omitting &#39;show&#39; declarations", "body": "<p>How could I output Haskell object as a string that is valid Haskell code to the output omitting existing <code>show</code> declarations?</p>\n\n<p>For example, I have following types declarations and corresponding <code>show</code> declarations (<a href=\"https://ideone.com/PSAPKY\" rel=\"nofollow noreferrer\">check the code out in an online IDE</a>):</p>\n\n<pre><code>{-# LANGUAGE TypeSynonymInstances, FlexibleInstances #-}\n\nimport Data.Maybe\n\ntype VersionCompound = Maybe Int\n\ndata VersionNumber = VersionNumber [VersionCompound] deriving (Show)\n\ndata MaturityLevel = Dev\n                   | Test\n                   | User\n                   | ReleaseCandidate\n                   | Prod\n                   deriving (Show)\n\ndata Version = MaturityVersion MaturityLevel VersionNumber  \n     | Version VersionNumber\n\nclass ToString a where\n    toString :: a -&gt; String\n\ninstance ToString VersionCompound where\n    toString (Just n) = (show n)\n    toString Nothing = \"x\"\n\ninstance ToString [VersionCompound] where\n    toString [] = \"\" \n    toString (x:[]) = (toString x)\n    toString (x:xs) = (toString x) ++ \".\" ++ (toString xs) \n\ninstance ToString VersionNumber where\n    toString (VersionNumber []) = \"\" \n    toString (VersionNumber (x:[])) = (toString x) \n    toString (VersionNumber (x:xs)) = (toString x) ++ \".\" ++ (toString xs)\n\ninstance ToString Version where\n    toString (MaturityVersion maturityLevel versionNumber) = (show maturityLevel) ++ \"/\" ++ (toString versionNumber)\n    toString (Version versionNumber) = (toString versionNumber)\n\ninstance Show Version where\n    show version = toString version\n\nmain = putStrLn $ show (Version $ VersionNumber [ Just 1, Just 2, Nothing])\n</code></pre>\n\n<p>Output of this program is:</p>\n\n<pre><code>1.2.x\n</code></pre>\n\n<p>But is there any way to output object as is in a form of valid Haskell code? For example, for the code above <code>showIntact $ Version $ VersionNumber [ Just 1, Just 2, Nothing]</code> would output something like:</p>\n\n<pre><code>Version ( VersionNumber [ Just 1, Just 2, Nothing] )\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 5, "creation_date": 1524075953, "post_id": 49906392, "comment_id": 86828962, "body": "That&#39;s not how you call a function in Haskell. <code>bsearch [1,2,3,4] 3 0 4</code> is what you want. You are passing a tuple as the first argument to <code>search</code>."}, {"owner": {"reputation": 310, "user_id": 7111260, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/4396b30cd1f9478a74c83da8bc2819dc?s=128&d=identicon&r=PG&f=1", "display_name": "oren revenge", "link": "https://stackoverflow.com/users/7111260/oren-revenge"}, "edited": false, "score": 0, "creation_date": 1524076057, "post_id": 49906392, "comment_id": 86829040, "body": "now it works thanks"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1524076136, "post_id": 49906392, "comment_id": 86829080, "body": "Why is <code>bsearch</code> returning an <code>Int</code> instead of <code>Bool</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 2, "last_activity_date": 1524076119, "creation_date": 1524076119, "answer_id": 49906644, "question_id": 49906392, "link": "https://stackoverflow.com/questions/49906392/haskell-passing-list-as-a-argument-doesnt-work/49906644#49906644", "title": "Haskell passing list as a argument doesn&#39;t work", "body": "<p>When calling Haskell functions, don't use the usual bracket-comma notation:</p>\n\n<pre><code>-- Correct:\nfunction arg1 arg2 arg3\n\n-- Incorrect:\nfunction(arg1, arg2, arg3)\n</code></pre>\n\n<p>The incorrect form is interpreted as passing a tuple (a set of values, like <code>(1,5,True)</code>) as one argument to the function.</p>\n"}], "owner": {"reputation": 310, "user_id": 7111260, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/4396b30cd1f9478a74c83da8bc2819dc?s=128&d=identicon&r=PG&f=1", "display_name": "oren revenge", "link": "https://stackoverflow.com/users/7111260/oren-revenge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "closed_date": 1524080270, "accepted_answer_id": 49906644, "answer_count": 1, "score": 0, "last_activity_date": 1524076119, "creation_date": 1524075166, "question_id": 49906392, "link": "https://stackoverflow.com/questions/49906392/haskell-passing-list-as-a-argument-doesnt-work", "closed_reason": "Not suitable for this site", "title": "Haskell passing list as a argument doesn&#39;t work", "body": "<p>I'm trying to pass a list with ordonable elements to a function</p>\n\n<pre><code>bsearch :: (Ord a) =&gt; [a] -&gt; a -&gt; Int -&gt; Int -&gt; Int\nbsearch xs nr l h = if (nr &lt; (xs !! ((l + h) `quot` 2) ))\n                      then 0\n                      else 1\n</code></pre>\n\n<p>But I get the following problem for when I call bsearch([1,2,3,4], 3 , 0::Int , 4::Int) from GHCi</p>\n\n<pre><code>&lt;interactive&gt;:280:8: error:\n    * Couldn't match expected type `[a]'\n                  with actual type `([Integer], Integer, Int, Int)'\n    * In the first argument of `bsearch', namely\n        `([1, 2, 3, 4], 3, 0 :: Int, 4 :: Int)'\n      In the expression: bsearch ([1, 2, 3, 4], 3, 0 :: Int, 4 :: Int)\n      In an equation for `it':\n          it = bsearch ([1, 2, 3, ....], 3, 0 :: Int, 4 :: Int)\n    * Relevant bindings include\n        it :: a -&gt; Int -&gt; Int -&gt; Int (bound at &lt;interactive&gt;:280:1)\n</code></pre>\n\n<p>I'm losing my mind here I dont understand why I did wrong.</p>\n"}, {"tags": ["haskell", "store", "conways-game-of-life", "comonad"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524074002, "post_id": 49906032, "comment_id": 86827936, "body": "Is there a reason why you use <code>Float</code>s here, and not <code>Int</code>s? I agree that this is an implementation <i>detail</i>, but usually calculations are safer in integer land than in floating point land."}, {"owner": {"reputation": 31, "user_id": 9513178, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-acGOqrKbnBs/AAAAAAAAAAI/AAAAAAAAF6E/Fyll4IAOnA0/photo.jpg?sz=128", "display_name": "Thobro", "link": "https://stackoverflow.com/users/9513178/thobro"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524074281, "post_id": 49906032, "comment_id": 86828069, "body": "Yes later on in the program I visualize my grid using Gloss, and that requires <code>Float</code>s as positions. I agree with you and I was using <code>Int</code> before Gloss."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 2, "creation_date": 1524075207, "post_id": 49906032, "comment_id": 86828568, "body": "@Thobro There&#39;s no reason to use <code>Float</code> for the <i>logical</i> model just because the <i>visual</i> model uses it. You can always convert to <code>Float</code> from <code>Int</code> using <code>fromIntegral</code> later on."}, {"owner": {"reputation": 31, "user_id": 9513178, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-acGOqrKbnBs/AAAAAAAAAAI/AAAAAAAAF6E/Fyll4IAOnA0/photo.jpg?sz=128", "display_name": "Thobro", "link": "https://stackoverflow.com/users/9513178/thobro"}, "edited": false, "score": 0, "creation_date": 1524075588, "post_id": 49906032, "comment_id": 86828745, "body": "Ah yes that is a smart idea :)"}, {"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 0, "creation_date": 1524081317, "post_id": 49906032, "comment_id": 86831865, "body": "Why wouldn&#39;t a combination of <code>pos</code> and <code>seek</code> work to move in any direction for you?"}], "owner": {"reputation": 31, "user_id": 9513178, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-acGOqrKbnBs/AAAAAAAAAAI/AAAAAAAAF6E/Fyll4IAOnA0/photo.jpg?sz=128", "display_name": "Thobro", "link": "https://stackoverflow.com/users/9513178/thobro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 147, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1524093499, "creation_date": 1524073874, "last_edit_date": 1524093499, "question_id": 49906032, "link": "https://stackoverflow.com/questions/49906032/how-to-change-focus-of-a-haskell-store-comonad-on-a-2d-list", "title": "How to change focus of a Haskell Store Comonad on a 2D list", "body": "<p>I am strugling with the following problem. I am trying to make Game of Life using store comonads in Haskell. I have the following relevant code:</p>\n\n<pre><code>type Cel = ((Float, Float), Bool)\ntype Field2D = [[Cel]]\n</code></pre>\n\n<p>I have then created an initial field:</p>\n\n<pre><code>initialField2D = [[((0.0, 0.0), True), ((0.0, 1.0), True)], \n                  [((1.0, 0.0), True), ((1.0, 1.0), True)]]\n</code></pre>\n\n<p>The initial field is a small example where I want to test my program on. Now here comes the tricky part.</p>\n\n<pre><code>initialStore2D :: Store Field Cel\ninitialStore2D = Store (head.head) initialField2D\n\nf :: (Store Field2D Cel) -&gt; Cel\nf (Store f s) = cellUpdate (f s)\n\ncellUpdate :: Cel -&gt; Cel --Simple trivial cell update function that just moves one spot.\ncellUpdate ((x, y), a) = ((x+1, y+1), True)\n\nnewStore = extend f initialStore2D -- Apply the update function to every cell.\nextract newStore --Correctly returns ((1.0, 1.0), True)\n</code></pre>\n\n<p>Now my question is, what is a good way to change the focus onto the updated store? Moving down is simple:</p>\n\n<pre><code>goDown :: Store Field Cel\ngoDown (Store f s) = Store (f.tail) s\n</code></pre>\n\n<p>My question is, what would be a good way to move right or left for example? Did I chose a bad index function (head.head)?</p>\n\n<p>Thank you for your time!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 5, "creation_date": 1524071105, "post_id": 49905248, "comment_id": 86826374, "body": "No, since <code>voxel</code> itself is a &quot;postponed&quot; computation. Once evaluated, it will store the outcome in the voxel &quot;node&quot;. Note that this is <i>not</i> stored at the <code>f</code> function level (also known as <i>momoization</i>), it is only because you reference the same <i>variable</i>."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524071168, "post_id": 49905248, "comment_id": 86826411, "body": "Thanks @WillemVanOnsem. That&#39;s good news."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524071214, "post_id": 49905248, "comment_id": 86826437, "body": "@WillemVanOnsem although that answers the specific question, would it be possible to write a more in-depth answer about this generally?"}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524071611, "post_id": 49905248, "comment_id": 86826657, "body": "@WillemVanOnsem &quot;momoization&quot;? :p"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 3, "creation_date": 1524071814, "post_id": 49905248, "comment_id": 86826764, "body": "@Jubobs: memoization of course... :("}], "answers": [{"comments": [{"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1524071666, "post_id": 49905335, "comment_id": 86826685, "body": "Thanks for the answer and the &quot;<code>printf</code>&quot; trick. (note: &quot;class-polymorphic bindings&quot; is Chinese for me.)"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1524072179, "post_id": 49905335, "comment_id": 86826964, "body": "Sorry I have another question. If <code>voxel :: Int -&gt; MyType</code>, and ` function2` calls <code>voxel 1</code>, is there a re-evaluation at a second call of <code>function2</code>, if it still calls <code>voxel 1</code>, or is there no re-evaluation because there is a <code>voxel 1</code> &quot;node&quot;, as says @WillemVanOnsem ?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1524072737, "post_id": 49905335, "comment_id": 86827268, "body": "Compiler optimizations <i>could</i> result in <code>voxel 1</code> being evaluated once (ex. using <code>-O1</code> and a trivial test w/ <code>trace</code>)... but! There is no guarantee and in practice it will often be re-evaluated (I expect, checking how often would be an interesting exploration)."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1524073006, "post_id": 49905335, "comment_id": 86827400, "body": "Ok @ThomasM.DuBuisson, thanks. I will try with <code>trace</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1524073075, "post_id": 49905335, "comment_id": 86827450, "body": "@St&#233;phaneLaurent If you want to be sure it is done only once, you can write it this way: <code>function2 = let expensive = voxel 1 in \\arg -&gt; {- do something with arg and expensive -}</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 2, "creation_date": 1524073235, "post_id": 49905335, "comment_id": 86827534, "body": "@St&#233;phaneLaurent &quot;Class-polymorphic binding&quot; means a value whose type has a class constraint. e.g. <code>x :: Num a =&gt; a; x = 0</code> is class-polymorphic and may be reevaluated at each use, while <code>id :: a -&gt; a; id x = x</code> is polymorphic but not class-polymorphic and <code>x2 :: Int; x2 = 0</code> is monomorphic."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 12, "last_activity_date": 1524071267, "creation_date": 1524071267, "answer_id": 49905335, "question_id": 49905248, "link": "https://stackoverflow.com/questions/49905248/does-haskell-re-evaluate-a-value-when-recalling-a-function-depending-on-this-val/49905335#49905335", "title": "Does Haskell re-evaluate a value when recalling a function depending on this value?", "body": "<p>Haskell doesn't say what happens.</p>\n\n<p>GHC does not re-evaluate <code>voxel</code>; generally, <code>let</code>- and <code>where</code>-bound values are evaluated at most once. (Though keep in mind that class-polymorphic values behave like functions, where choosing an instance is function application, and these function calls are not memoized, so apparently benign class-polymorphic bindings will probably lead to many reevaluations.)</p>\n\n<p>You can put a \"<code>printf</code>\" with <code>Debug.Trace.trace</code>, but this should be used for educational and debugging purposes only.</p>\n\n<pre><code>import Debug.Trace\nvoxel = trace \"evaluated voxel\" $ f 2\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1341, "user_id": 1036044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PzcQL.jpg?s=128&g=1", "display_name": "Probie", "link": "https://stackoverflow.com/users/1036044/probie"}, "is_accepted": false, "score": 1, "last_activity_date": 1524071620, "creation_date": 1524071620, "answer_id": 49905429, "question_id": 49905248, "link": "https://stackoverflow.com/questions/49905248/does-haskell-re-evaluate-a-value-when-recalling-a-function-depending-on-this-val/49905429#49905429", "title": "Does Haskell re-evaluate a value when recalling a function depending on this value?", "body": "<p>It might, it might not, it depends on usage. Once it's evaluated, it'll stay evaluated until it gets garbage collected. As long as you have a reference to it somewhere, it can't be garbage collected.</p>\n\n<p>Why would GHC allow a top level \"constant\" to be garbage collected? For a contrived example, imagine I have something like</p>\n\n<pre><code>nats :: [Integer]\nnats = [0..]\n</code></pre>\n\n<p>and then another function which indexed into <code>nats</code>. If GHC couldn't collect <code>nats</code>, it'd have to store the list <code>[1..n]</code> (where <code>n</code> was the value that was indexed) even though I'm not using most of the list.</p>\n"}], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 49905335, "answer_count": 2, "score": 4, "last_activity_date": 1524071620, "creation_date": 1524070989, "last_edit_date": 1524071430, "question_id": 49905248, "link": "https://stackoverflow.com/questions/49905248/does-haskell-re-evaluate-a-value-when-recalling-a-function-depending-on-this-val", "title": "Does Haskell re-evaluate a value when recalling a function depending on this value?", "body": "<p>Assume I have</p>\n\n<pre><code>f :: Int -&gt; MyType\nf i = ......\n\nvoxel :: MyType\nvoxel = f 2\n\nfunction1 :: Double -&gt; MyType -&gt; MyOtherType\nfunction1 x w = ......\n\nfunction2 :: Double -&gt; MyOtherType\nfunction2 y = function1 y voxel \n</code></pre>\n\n<p>Now, assume I call <code>function2</code> twice, for example <code>function2 1.0</code> then <code>function2 2.0</code> (I am in the context of <code>OpenGL</code> and <code>MyOtherType</code> is a graphical element to be plotted, and the user can change <code>y</code> with the keyboard).</p>\n\n<p>Then, at the second call of <code>function2</code>, does Haskell re-evaluate <code>voxel</code>?</p>\n\n<p>If I had such a situation in, say for example the C language, I would put a <code>printf</code> in <code>voxel</code> to know the answer, but I can't do such a thing with a pure Haskell function (can I?).</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 2, "creation_date": 1524065642, "post_id": 49903624, "comment_id": 86823069, "body": "Voting to close as primarily opinion based as the question seems to invite a discussion about what should and shouldn&#39;t be part of the core language and why, which doesn&#39;t have an objective answer.  Note that the argument &quot;doesn&#39;t break any code when turned on&quot; traditionally isn&#39;t an argument for inclusion into the core language. This is true for <i>many</i> GHC language extensions. The fact that it doesn&#39;t break anything isn&#39;t sufficient reason to expand the standard."}, {"owner": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1524065782, "post_id": 49903624, "comment_id": 86823145, "body": "@Cubic : maybe the title gives the feeling of opinion based question, but the content  clearly ask a non opinion base question. I will update the title to stick to it then"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1524065849, "post_id": 49903624, "comment_id": 86823185, "body": "No, it&#39;s not the title that&#39;s the problem. I don&#39;t think this question is salvageable as an SO question."}, {"owner": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1524065941, "post_id": 49903624, "comment_id": 86823250, "body": "Edited, removing all &quot;my opinion&quot; based stuff."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1524082365, "post_id": 49903624, "comment_id": 86832415, "body": "I think the current question (after the edit) is fine, and should admit an objective answer. (It is possible, though, that the answer is &quot;nothing would break&quot;, which is hard to justify.)"}], "answers": [{"comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 2, "creation_date": 1524066200, "post_id": 49903810, "comment_id": 86823410, "body": "Put another way: backwards compatibility is not the criterion used to determine whether an extension is enabled in GHC (in other languages the compiler implementation is also the de facto language standard, but that&#39;s not the relationship that GHC and haskell have)"}, {"owner": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "edited": false, "score": 0, "creation_date": 1524119205, "post_id": 49903810, "comment_id": 86843636, "body": "This is definitely not an answer to the question."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8174234"}, "reply_to_user": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "edited": false, "score": 0, "creation_date": 1524150668, "post_id": 49903810, "comment_id": 86864826, "body": "@sandwood the original title was different."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8174234"}, "is_accepted": false, "score": 3, "last_activity_date": 1524150594, "last_edit_date": 1524150594, "creation_date": 1524066057, "answer_id": 49903810, "question_id": 49903624, "link": "https://stackoverflow.com/questions/49903624/is-code-without-usage-of-duplicaterecordfields-extension-compatible-if-extension/49903810#49903810", "title": "Is code without usage of DuplicateRecordFields extension compatible if extension is enabled?", "body": "<p>Because it's not in the Haskell2010 standard. </p>\n"}], "owner": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1524150594, "creation_date": 1524065449, "last_edit_date": 1524065859, "question_id": 49903624, "link": "https://stackoverflow.com/questions/49903624/is-code-without-usage-of-duplicaterecordfields-extension-compatible-if-extension", "title": "Is code without usage of DuplicateRecordFields extension compatible if extension is enabled?", "body": "<p>More exactly : is there case of code that would compile WITHOUT this extension enabled but would not compile anymore WITH the extension ? </p>\n\n<p>In other words, does it break  Haskell code upward compatibility ?  </p>\n"}, {"tags": ["haskell", "type-level-computation", "hlist"], "comments": [{"owner": {"reputation": 1341, "user_id": 1036044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PzcQL.jpg?s=128&g=1", "display_name": "Probie", "link": "https://stackoverflow.com/users/1036044/probie"}, "edited": false, "score": 0, "creation_date": 1524065399, "post_id": 49903372, "comment_id": 86822892, "body": "What happens if you enable ambiguous types?"}, {"owner": {"reputation": 20350, "user_id": 411944, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7bf057b98d0652db34842d1817234853?s=128&d=identicon&r=PG", "display_name": "Reactormonk", "link": "https://stackoverflow.com/users/411944/reactormonk"}, "reply_to_user": {"reputation": 1341, "user_id": 1036044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PzcQL.jpg?s=128&g=1", "display_name": "Probie", "link": "https://stackoverflow.com/users/1036044/probie"}, "edited": false, "score": 0, "creation_date": 1524066148, "post_id": 49903372, "comment_id": 86823376, "body": "Same error, but at the caller site."}, {"owner": {"reputation": 1341, "user_id": 1036044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PzcQL.jpg?s=128&g=1", "display_name": "Probie", "link": "https://stackoverflow.com/users/1036044/probie"}, "edited": false, "score": 0, "creation_date": 1524067048, "post_id": 49903372, "comment_id": 86824000, "body": "shouldn&#39;t <code>SubSelect</code> have some instances? Otherwise it&#39;s not constraining anything."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1524067588, "post_id": 49903372, "comment_id": 86824325, "body": "I can&#39;t even try to run this example: there&#39;s no package <code>hlist</code> in <code>lts-11.4</code>. What dependencies are you using? <code>multistate</code> has <code>Data.HList.HList</code> and is in <code>lts-11.4</code>, for instance. Are you using that one?"}, {"owner": {"reputation": 20350, "user_id": 411944, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7bf057b98d0652db34842d1817234853?s=128&d=identicon&r=PG", "display_name": "Reactormonk", "link": "https://stackoverflow.com/users/411944/reactormonk"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1524068540, "post_id": 49903372, "comment_id": 86824942, "body": "@chi sorry, worked here because I did it as a project and exported it as a stack script :-/ . It should be <code>HList-0.5.0.0</code>"}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1524068884, "post_id": 49903372, "comment_id": 86825131, "body": "Unless there&#39;s some part of the code you haven&#39;t shown, <code>DefaultRecipe</code> is useless because <code>def</code> can never be implemented."}, {"owner": {"reputation": 20350, "user_id": 411944, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7bf057b98d0652db34842d1817234853?s=128&d=identicon&r=PG", "display_name": "Reactormonk", "link": "https://stackoverflow.com/users/411944/reactormonk"}, "edited": false, "score": 0, "creation_date": 1524072457, "post_id": 49903372, "comment_id": 86827118, "body": "The script is now without external dependencies and produces the mentioned error. Sorry for the trouble."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1524225506, "creation_date": 1524225506, "answer_id": 49941137, "question_id": 49903372, "link": "https://stackoverflow.com/questions/49903372/type-variables-in-context-not-fixed/49941137#49941137", "title": "Type variables in context not fixed?", "body": "<p>You can't have an instance like this</p>\n\n<pre><code>instance (HasRecipe target pot effect deps, SubSelect pot deps)\n       =&gt; CanCook target pot effect where\n</code></pre>\n\n<p>The tyvar <code>deps</code> appears in the context, but not in the head, making the instance ambiguous.</p>\n\n<p>Concretely, it could be possible to have four instances</p>\n\n<pre><code>instance HasRecipe target pot effect A\ninstance SubSelect pot A\ninstance HasRecipe target pot effect B\ninstance SubSelect pot B\n</code></pre>\n\n<p>and GHC has no way to select which one you want. You have to choose <code>deps</code> either at instance definition, or (enabling ambiguous types) at the <code>cook</code> call site.</p>\n\n<p>If there were a fundep such as <code>target pot effect -&gt; deps</code> this would remove the ambiguity, but it is hard for me to understand the intent.</p>\n"}], "owner": {"reputation": 20350, "user_id": 411944, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7bf057b98d0652db34842d1817234853?s=128&d=identicon&r=PG", "display_name": "Reactormonk", "link": "https://stackoverflow.com/users/411944/reactormonk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1524225506, "creation_date": 1524064650, "last_edit_date": 1524072307, "question_id": 49903372, "link": "https://stackoverflow.com/questions/49903372/type-variables-in-context-not-fixed", "title": "Type variables in context not fixed?", "body": "<p>I'm currently experimenting with typelevel code. I've got one instance with a type variable that only occurs in the context, and not in the instance itself. Somehow the compiler doesn't like that, but I can't figure out why not. Adding a functional dependency to <code>HasRecipe</code> <code>effect pot target -&gt; deps</code> works for that error, but then the incorrect <code>deps</code> are inferred at the test in the last line of the code.</p>\n\n<p>Error:</p>\n\n<pre><code>\u2022 Could not deduce (HasRecipe target pot effect deps0)\n  from the context: (HasRecipe target pot effect deps,\n                     SubSelect pot deps)\n    bound by an instance declaration:\n               forall target (pot :: [*]) (effect :: * -&gt; *) (deps :: [*]).\n               (HasRecipe target pot effect deps, SubSelect pot deps) =&gt;\n               CanCook target pot effect\n    at Lib.hs:15:10-92\n  The type variable \u2018deps0\u2019 is ambiguous\n\u2022 In the ambiguity check for an instance declaration\n  To defer the ambiguity check to use sites, enable AllowAmbiguousTypes\n  In the instance declaration for \u2018CanCook target pot effect\u2019\n</code></pre>\n\n<p>Source:</p>\n\n<pre><code>#!/usr/bin/env stack\n-- stack --resolver lts-11.4 --install-ghc runghc\n{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE FunctionalDependencies #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE UndecidableInstances #-}\n{-# LANGUAGE StandaloneDeriving #-}\n{-# LANGUAGE PolyKinds #-}\n\nimport Data.Proxy\n\nclass HEq (x :: k) (y :: k) (b :: Bool) | x y -&gt; b\n\ndata family HList (l::[*])\n\ndata instance HList '[] = HNil\ndata instance HList (x ': xs) = x `HCons` HList xs\n\nderiving instance Eq (HList '[])\nderiving instance (Eq x, Eq (HList xs)) =&gt; Eq (HList (x ': xs))\n\nderiving instance Ord (HList '[])\nderiving instance (Ord x, Ord (HList xs)) =&gt; Ord (HList (x ': xs))\n\nderiving instance Bounded (HList '[])\nderiving instance (Bounded x, Bounded (HList xs)) =&gt; Bounded (HList (x ': xs))\n\nclass HExtend e l where\n  type HExtendR e l\n  (.*.) :: e -&gt; l -&gt; HExtendR e l\n\ninfixr 2 .*.\n\ninstance HExtend e (HList l) where\n  type HExtendR e (HList l) = HList (e ': l)\n  (.*.) = HCons\n\n\nmain = pure ()\n\nnewtype Recipe effect target (deps :: [*]) = Recipe { runRecipe :: HList deps -&gt; effect target }\n\nclass CanCook target (pot :: [*]) effect | pot -&gt; effect where\n  cook :: HList pot -&gt; effect target\n\ninstance (HasRecipe target pot effect deps, SubSelect pot deps) =&gt; CanCook target pot effect where\n  cook pot =\n    let\n      deps :: HList deps\n      deps = subselect pot\n      r :: Recipe effect target deps\n      r = recipe pot\n    in\n      runRecipe r $ deps\n\ntype family PotEffect (pot :: [*]) where\n  PotEffect (Recipe effect _ _ ': '[]) = effect\n  PotEffect (Recipe effect _ _ ': tail) = effect\n\nclass HasRecipe target (pot :: [*]) effect deps | pot -&gt; effect where\n  recipe :: HList pot -&gt; Recipe effect target deps\n\nclass SubSelect (pot :: [*]) (deps :: [*]) where\n  subselect :: HList pot -&gt; HList deps\n\ninstance SubSelect t f where\n  subselect = undefined\n\nclass HasRecipeCase (b :: Bool) (target :: *) (pot :: [*]) effect (deps :: [*]) | pot -&gt; effect where\n  recipeCase :: Proxy b -&gt; Proxy target -&gt; HList pot -&gt; Recipe effect target deps\n\ninstance HasRecipeCase True target ((Recipe effect target deps) ': leftoverPot) effect deps where\n  recipeCase _ _ (HCons head _) = head\n\ninstance (HasRecipe target leftoverPot effect deps) =&gt;\n  HasRecipeCase False target ((Recipe effect target1 deps) ': leftoverPot) effect deps where\n  recipeCase _ _ (HCons _ tail) = recipe tail\n\ninstance (HEq target t bool, HasRecipeCase bool target pot effect deps, pot ~ ((Recipe effect t deps) ': leftoverPot)) =&gt;\n  HasRecipe target ((Recipe effect t deps) ': leftoverPot) effect deps where\n  recipe = undefined\n\nnewtype M1 = M1 ()\nnewtype M2 = M2 ()\nnewtype M3 = M3 ()\nnewtype M4 = M4 ()\n\nr1 :: Recipe IO M1 '[M2, M3]\nr1 = undefined\n\nr2 :: Recipe IO M2 '[]\nr2 = undefined\n\nr3 :: Recipe IO M3 '[M4]\nr3 = undefined\n\nr4 :: Recipe IO M4 '[]\nr4 = undefined\n\ncookbook1 = r1 .*. r2 .*. r3 .*. r4 .*. HNil\n\ncookbook2 = r3 .*. r4 .*. r2 .*. r1 .*. HNil\n\nc1 = cook cookbook1 :: IO M4\n-- c2 = cook cookbook2 :: IO M4\n</code></pre>\n"}, {"tags": ["function", "haskell", "function-composition"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 6, "creation_date": 1524047403, "post_id": 49897341, "comment_id": 86810059, "body": "I don&#39;t get why you need the <code>where</code> clauses here, you can write it as <code>h par = f par . g par</code>, or even better <code>h = liftM2 (.) f g</code>"}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1524048259, "post_id": 49897341, "comment_id": 86810666, "body": "@WillemVanOnsem How about <code>h = (.) &lt;$&gt; f &lt;*&gt; g</code>?"}, {"owner": {"reputation": 1096, "user_id": 5021447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-gwPYP717ZyU/AAAAAAAAAAI/AAAAAAAAAP8/WoyhftM4PuU/photo.jpg?sz=128", "display_name": "Jordan Mackie", "link": "https://stackoverflow.com/users/5021447/jordan-mackie"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 1, "creation_date": 1524048698, "post_id": 49897341, "comment_id": 86810962, "body": "@MarkSeemann&#39;s answer is the pattern I often reach for when I think &quot;I&#39;ve got this thing I need to pass out to lots of functions and then combine their results&quot;. A bit like a fork-join.  E.g. <code>(&amp;&amp;) &lt;$&gt; p1 &lt;*&gt; p2</code> is one I use a lot."}, {"owner": {"reputation": 255, "user_id": 9437806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3139b8238c9efc59a980c2a114701c9f?s=128&d=identicon&r=PG", "display_name": "Stefan Witzel", "link": "https://stackoverflow.com/users/9437806/stefan-witzel"}, "edited": false, "score": 0, "creation_date": 1524051794, "post_id": 49897341, "comment_id": 86813115, "body": "This is a minimal example. In the actual code naming the partially evaluated functions increases readability (IMO), but it would be nice to do this somehow generically: evaluate all of the following 10 functions x at par and call the outcome myx."}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 1, "creation_date": 1524052583, "post_id": 49897341, "comment_id": 86813626, "body": "@StefanWitzel: Another option for you, if you&#39;ve got working code and you&#39;re looking for better abstractions, you can submit a piece of code on <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a> ."}, {"owner": {"reputation": 255, "user_id": 9437806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3139b8238c9efc59a980c2a114701c9f?s=128&d=identicon&r=PG", "display_name": "Stefan Witzel", "link": "https://stackoverflow.com/users/9437806/stefan-witzel"}, "reply_to_user": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 0, "creation_date": 1524052906, "post_id": 49897341, "comment_id": 86813839, "body": "@SimonShine: Thank you! I may try that. I thought I had a very clear-cut problem that would have a well-known syntactic sugar answer. But it transpires that this is not the case."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524056565, "post_id": 49897341, "comment_id": 86816247, "body": "I think if you need access to 10 &quot;properties&quot; of a data object, then something is really wrong with the design. It could in that case be helpful to (a) encapsulate groups of properties that belong together in a new <code>data</code> type, and (b) introduce helper functions that each operate on a subset."}, {"owner": {"reputation": 255, "user_id": 9437806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3139b8238c9efc59a980c2a114701c9f?s=128&d=identicon&r=PG", "display_name": "Stefan Witzel", "link": "https://stackoverflow.com/users/9437806/stefan-witzel"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524060131, "post_id": 49897341, "comment_id": 86818805, "body": "@WillemVanOnsem: I do not (but am trying to) understand why this means that something is wrong with the design. Essentially I do the usual thing of building up increasingly complex functions out of preexisting ones. Just that everything depends on a parameter (a quadruple of integers) and so I need to carry this parameter through in some form."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524060353, "post_id": 49897341, "comment_id": 86818976, "body": "@StefanWitzel: then perhaps pattern matching is your friend."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1524086561, "post_id": 49897341, "comment_id": 86834306, "body": "Terminological note: this is partial application, not partial evaluation. Partial evaluation is an optimization technique that runs code to some degree at compile time, in order to reduce the required work at run time. It&#39;s related to supercompilation."}], "answers": [{"comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1529229475, "post_id": 49898225, "comment_id": 88791081, "body": "@WillNess Thank you :)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1529229538, "post_id": 49898225, "comment_id": 88791091, "body": "just looking out for the next confused newbie. :)"}], "tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": false, "score": 6, "last_activity_date": 1529229394, "last_edit_date": 1529229394, "creation_date": 1524049832, "answer_id": 49898225, "question_id": 49897341, "link": "https://stackoverflow.com/questions/49897341/partially-apply-several-functions-in-haskell/49898225#49898225", "title": "Partially apply several functions in Haskell", "body": "<p>In Haskell, all functions take one input argument. Sometimes, though, the return value of applying a function is a new function. As a first step, then, you can make that more explicit by putting brackets around the return value of your functions <code>f</code> and <code>g</code>:</p>\n\n<pre><code>f :: Par -&gt; (a -&gt; b)\ng :: Par -&gt; (b -&gt; c)\n</code></pre>\n\n<p>Functions are types as well, so we could arbitrarily decide to alias <code>a -&gt; b</code> to <code>\u03c6</code> (<em>phi</em> instead of <em>f</em>) and <code>b -&gt; c</code> to <code>\u03b3</code> (<em>gamma</em> instead of <em>g</em>). (Yes, when you run out of letters, you reach for the Greek alphabet!)</p>\n\n<p>This means that you can view your functions as having the types</p>\n\n<pre><code>f :: Par -&gt; \u03c6\ng :: Par -&gt; \u03b3\n</code></pre>\n\n<p>These are both automatically instances of the so-called <em>reader monad</em>, which is also an (applicative) functor. Particularly, <code>(-&gt;) Par</code>, or, if it helps, <code>Par -&gt;</code>, is an <code>Applicative</code> instance. This means that you can use <code>pure</code> and <code>&lt;*&gt;</code> with it.</p>\n\n<p>As a first attempt, you can write something like</p>\n\n<pre><code>pure (\\x y -&gt; (x, y)) &lt;*&gt; f &lt;*&gt; g\n</code></pre>\n\n<p>in order to simply understand how that composition works. That expression has the type <code>Par -&gt; (\u03c6, \u03b3)</code>, so to speak. That lambda expression simply takes <code>x</code> from the <code>f</code> 'container', and <code>y</code> from the <code>g</code> 'container', and combines them in a tuple. The first element of the tuple has the type <code>\u03c6</code>, and the second element has the type <code>\u03b3</code>.</p>\n\n<p>Plugging in the definitions of <code>\u03c6</code> and <code>\u03b3</code>, you get the type <code>Par -&gt; (a -&gt; b, b -&gt; c)</code>.</p>\n\n<p>Instead of a return value as a tuple of functions, you want to compose these functions. You can use the function composition operator <code>.</code> for that:</p>\n\n<pre><code>h = pure (\\x y -&gt; y . x) &lt;*&gt; f &lt;*&gt; g\n</code></pre>\n\n<p>Notice that the functions compose from right to left, so <code>x</code> (<code>a -&gt; b</code>) comes first, followed by <code>y</code> (<code>b -&gt; c</code>).</p>\n\n<p>You can, however, flip <code>f</code> and <code>g</code> around:</p>\n\n<pre><code>h = pure (\\y x -&gt; y . x) &lt;*&gt; g &lt;*&gt; f\n</code></pre>\n\n<p>That explicit lambda expression can then be eta-reduced to:</p>\n\n<pre><code>h = pure (.) &lt;*&gt; g &lt;*&gt; f\n</code></pre>\n\n<p>Finally, instead of writing <code>pure (.) &lt;*&gt;</code> you can use the infix <code>&lt;$&gt;</code> operator:</p>\n\n<pre><code>h = (.) &lt;$&gt; g &lt;*&gt; f\n</code></pre>\n\n<p>This function has the type <code>Par -&gt; a -&gt; c</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 255, "user_id": 9437806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3139b8238c9efc59a980c2a114701c9f?s=128&d=identicon&r=PG", "display_name": "Stefan Witzel", "link": "https://stackoverflow.com/users/9437806/stefan-witzel"}, "edited": false, "score": 0, "creation_date": 1529347381, "post_id": 49898858, "comment_id": 88831250, "body": "Thank you! I didn&#39;t fully appreciate your answer until I reconstructed the monad structure of &quot;-&gt;&quot;. It helped me to think of the type &quot;p -&gt; a&quot; as &quot;a parametrized by p&quot;."}], "tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": true, "score": 3, "last_activity_date": 1524060255, "last_edit_date": 1524060255, "creation_date": 1524051768, "answer_id": 49898858, "question_id": 49897341, "link": "https://stackoverflow.com/questions/49897341/partially-apply-several-functions-in-haskell/49898858#49898858", "title": "Partially apply several functions in Haskell", "body": "<p>You're doing <code>h par = f par . g par</code> a lot, and the <code>par</code> stuff starts to clutter.</p>\n\n<p>You can't do <code>h = f . g</code>, since the <code>par</code> argument must be passed along, too.</p>\n\n<p>So you come up with a high-powered composition operator that will do this for you:</p>\n\n<pre><code>-- (.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n(\u00a7) :: (par -&gt; b -&gt; c) -&gt; (par -&gt; a -&gt; b) -&gt; par -&gt; a -&gt; c\n(\u00a7) f g par = f par . g par\n</code></pre>\n\n<p>Now you can do <code>h = f \u00a7 g</code>. This operator was probably invented before.</p>\n\n<p>Incidentally, partially applied functions are <a href=\"http://hackage.haskell.org/package/base-4.11.0.0/docs/src/GHC.Base.html#line-803\" rel=\"nofollow noreferrer\">instances of Monad</a>. This means you can do:</p>\n\n<pre><code>(\u00a7) f g par = (do { fpar &lt;- f; gpar &lt;- g; return (fpar . gpar) }) par\n</code></pre>\n\n<p>Or just:</p>\n\n<pre><code>(\u00a7) f g = do { fpar &lt;- f; gpar &lt;- g; return (fpar . gpar) }\n</code></pre>\n\n<p><em>(Here, <code>fpar</code> is <code>f</code> to which an implicit <code>par</code> has been applied. The monad instance makes <code>par</code> implicit.)</em></p>\n\n<p>If we were to parameterize this do-block:</p>\n\n<pre><code>(\u00a7) f g = ( \\f m1 m2 -&gt; do { x1 &lt;- m1; x2 &lt;- m2; return (f x1 x2) } ) (.) f g\n</code></pre>\n\n<p>And eta-reduce the parameters:</p>\n\n<pre><code>(\u00a7) = ( \\f m1 m2 -&gt; do { x1 &lt;- m1; x2 &lt;- m2; return (f x1 x2) } ) (.)\n</code></pre>\n\n<p>And look on Hoogle for something that looks like this do-block, you'd find <code>liftM2</code>:</p>\n\n<pre><code>(\u00a7) = liftM2 (.)\n</code></pre>\n\n<p>At which point we don't really need to give it a special name, since <code>liftM2 (.)</code> is already pretty short.</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 5, "last_activity_date": 1524053159, "last_edit_date": 1524053159, "creation_date": 1524052058, "answer_id": 49898948, "question_id": 49897341, "link": "https://stackoverflow.com/questions/49897341/partially-apply-several-functions-in-haskell/49898948#49898948", "title": "Partially apply several functions in Haskell", "body": "<p>You've discovered the use case for the <code>Reader</code> monad, if you can adjust your signatures slightly. If you have</p>\n\n<pre><code>f :: a -&gt; Par -&gt; b\ng :: b -&gt; Par -&gt; c\n</code></pre>\n\n<p>you can redefine them as </p>\n\n<pre><code>import Control.Monad.Trans.Reader\n\nf :: a -&gt; Reader Par b\ng :: b -&gt; Reader Par c\n</code></pre>\n\n<p>Then you can define <code>h</code> using the normal Kleisli composition operator.</p>\n\n<pre><code>import Control.Monad\n\nh :: a -&gt; Reader Par c\nh = f &gt;=&gt; g\n</code></pre>\n\n<p>(Even without changing the signatures, I think you can write <code>h = flip (flip f &gt;=&gt; flip g)</code>.)</p>\n"}, {"tags": [], "owner": {"reputation": 255, "user_id": 9437806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3139b8238c9efc59a980c2a114701c9f?s=128&d=identicon&r=PG", "display_name": "Stefan Witzel", "link": "https://stackoverflow.com/users/9437806/stefan-witzel"}, "is_accepted": false, "score": 1, "last_activity_date": 1529154242, "creation_date": 1529154242, "answer_id": 50888169, "question_id": 49897341, "link": "https://stackoverflow.com/questions/49897341/partially-apply-several-functions-in-haskell/50888169#50888169", "title": "Partially apply several functions in Haskell", "body": "<p>This can be done using implicit parameters (which are not pure Haskell but a ghc language extension, see <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#implicit-parameters\" rel=\"nofollow noreferrer\">https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#implicit-parameters</a>).</p>\n\n<p>The code above just becomes</p>\n\n<pre><code>f :: (?p :: Par) =&gt; a -&gt; b\n\ng :: (?p :: Par) =&gt; b -&gt; c\n\nh :: (?p :: Par) =&gt; a -&gt; c\nh = g . f\n</code></pre>\n"}], "owner": {"reputation": 255, "user_id": 9437806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3139b8238c9efc59a980c2a114701c9f?s=128&d=identicon&r=PG", "display_name": "Stefan Witzel", "link": "https://stackoverflow.com/users/9437806/stefan-witzel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "accepted_answer_id": 49898858, "answer_count": 4, "score": 3, "last_activity_date": 1529229394, "creation_date": 1524047143, "last_edit_date": 1529227439, "question_id": 49897341, "link": "https://stackoverflow.com/questions/49897341/partially-apply-several-functions-in-haskell", "title": "Partially apply several functions in Haskell", "body": "<p>Suppose, in Haskell, I have a bunch of functions that all depend on the same parameter type:</p>\n\n<pre><code>f :: Par -&gt; a -&gt; b\ng :: Par -&gt; b -&gt; c\n</code></pre>\n\n<p>As I'm writing more of these functions that still depend on this parameter type, I can do something like</p>\n\n<pre><code>h :: Par -&gt; a -&gt; c\nh par = myg . myf\n    where myf = f par\n          myg = g par\n</code></pre>\n\n<p>However I keep having to write these <code>where</code> lines. The question is: can this be avoided?</p>\n\n<p>[Edit: I tried to provide a minimal example to illustrate the problem but apparently the example is too minimal to illustrate what I want. In the actual problem h is of course not just the composition of f and g. So here is some actual code:</p>\n\n<p>There are functions</p>\n\n<pre><code>apply :: ChamberLattice -&gt; ChLatword -&gt; ChLatWord\nreduce :: ChamberLattice -&gt; ChLatWord -&gt; ChLatWord\n</code></pre>\n\n<p>and I am defining a function</p>\n\n<pre><code>chaseTurn :: ChamberLattice -&gt; Turn -&gt; Parity -&gt; ChLatWord -&gt; ChLatWord\nchaseTurn cl Straight _ xs = xs\nchaseTurn cl t parity xs = if ((turn parity xs) == t)\n                           then case myApply xs of\n                               (y1:y2:ys) -&gt; (y1:y2:(myChaseTurn t parity ys))\n                               ys -&gt; ys\n                           else myReduce xs\nwhere myApply = apply cl\n      myChaseTurn = chaseTurn cl\n      myReduce = reduce cl\n</code></pre>\n\n<p>]</p>\n\n<p>(This question is essentially the same as\n<a href=\"https://stackoverflow.com/questions/49894738/grouping-functions-in-haskell\">Grouping functions in Haskell</a>\nbut there I used some unfortunate words that distracted people.)</p>\n"}, {"tags": ["haskell", "ascii"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1524046350, "post_id": 49897032, "comment_id": 86809357, "body": "What do you mean with &quot;convert it to ASCII&quot;? Furthermore by adding no separators, there is no direct way back. How would you for example convert <code>12122</code>? As <code>12 122</code>? Or like <code>121 22</code>?"}, {"owner": {"reputation": 95, "user_id": 2346696, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e9cead76576cff1d41f1be4ba1a780fa?s=128&d=identicon&r=PG", "display_name": "Simas", "link": "https://stackoverflow.com/users/2346696/simas"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524046515, "post_id": 49897032, "comment_id": 86809446, "body": "in ASCII table a is 97, b is 98 and z is 122, then abz(input) should be 9798122(output) after converting it."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 3, "creation_date": 1524047038, "post_id": 49897032, "comment_id": 86809800, "body": "@Simas Willem is talking about the other way round. If you have &quot;9798122&quot; how would you get &#39;abz&#39; back from that? Sure, you could treat it as &quot;97 98 122&quot;, but you could equally treat it as &quot;9 79 81 22&quot;"}, {"owner": {"reputation": 472, "user_id": 1992776, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/564eaaa89de37dbcc59c5f95f46f3f36?s=128&d=identicon&r=PG", "display_name": "army007", "link": "https://stackoverflow.com/users/1992776/army007"}, "edited": false, "score": 0, "creation_date": 1524052170, "post_id": 49897032, "comment_id": 86813357, "body": "Do you need ascii values of characters as a string? If not then you can just output a list of <code>Int</code>. Changed signature will <code>asciiWords :: String -&gt; [Int]</code>."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 3, "last_activity_date": 1524054483, "creation_date": 1524054483, "answer_id": 49899729, "question_id": 49897032, "link": "https://stackoverflow.com/questions/49897032/converto-whole-text-to-ascii-using-haskell/49899729#49899729", "title": "Converto whole text to ascii using haskell", "body": "<p>The <code>Data.Char</code> module offers <code>ord</code> and <code>chr</code> for converting from a Unicode character to its codepoint and back.</p>\n\n<pre><code>ord :: Char -&gt; Int\nchr :: Int -&gt; Char -- beware! partial function\n</code></pre>\n\n<p>The less mnemonic names <code>fromEnum</code> and <code>toEnum</code> are also available without any imports.</p>\n\n<p>You will want to spend a little time thinking about what should happen to characters which are not in the ASCII range.</p>\n"}], "owner": {"reputation": 95, "user_id": 2346696, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/e9cead76576cff1d41f1be4ba1a780fa?s=128&d=identicon&r=PG", "display_name": "Simas", "link": "https://stackoverflow.com/users/2346696/simas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 49899729, "answer_count": 1, "score": -1, "last_activity_date": 1524054483, "creation_date": 1524046294, "question_id": 49897032, "link": "https://stackoverflow.com/questions/49897032/converto-whole-text-to-ascii-using-haskell", "title": "Converto whole text to ascii using haskell", "body": "<p>I have text file with inputs, how I can convert it to ascii and vice versa?</p>\n\n<pre><code>abz\nz?\n9798122\n</code></pre>\n\n<p>these inputs would give this output:</p>\n\n<pre><code>9798122\n12263\nabz\n</code></pre>\n\n<p>First I read inputs from text file and have all lines, but I do not know how to convert whole line to ascii. Here is what I have so far:</p>\n\n<pre><code>asciiWords :: String -&gt; String \nasciiWords = words\n\nconvertLines :: [String] -&gt; IO ()\nconvertLines = mapM_ (putStrLn . asciiWords)\n\nmain = do \n  content &lt;- readFile \"input.txt\" \n  let linesList = lines content\n  convertLines linesList\n</code></pre>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524044077, "post_id": 49896040, "comment_id": 86807620, "body": "I am not really convinced this is a good idea in the first place. What will you do in case a <code>data</code> type has two properties, both having the same type? Change one of them (which one?), or both?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524044208, "post_id": 49896040, "comment_id": 86807710, "body": "You can, if you want define type classes with two or more parameters (by enabling a certain pragma)."}, {"owner": {"reputation": 131, "user_id": 9663052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c5e77edc1e34cdb3eb39ca0b5a8854a?s=128&d=identicon&r=PG&f=1", "display_name": "notBob", "link": "https://stackoverflow.com/users/9663052/notbob"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524045024, "post_id": 49896040, "comment_id": 86808347, "body": "I am unsure what you mean by one data type having two properties. To clarify each Property data type contains all the information required for each A and B respectively. The reason I want a separate type for the properties is that they represent rather different things, and I want to be able to have several constructors for each of them."}], "answers": [{"tags": [], "owner": {"reputation": 131, "user_id": 9663052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c5e77edc1e34cdb3eb39ca0b5a8854a?s=128&d=identicon&r=PG&f=1", "display_name": "notBob", "link": "https://stackoverflow.com/users/9663052/notbob"}, "is_accepted": false, "score": 1, "last_activity_date": 1524051851, "creation_date": 1524051851, "answer_id": 49898883, "question_id": 49896040, "link": "https://stackoverflow.com/questions/49896040/handling-different-argument-types-for-different-instances-of-typeclass/49898883#49898883", "title": "handling different argument types for different instances of typeclass", "body": "<p>As Willem Van Onsem mentioned, it is possible to use a multi-parameter type class. </p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses #-}\nclass C a ap where\n    changeProperty :: a -&gt; ap -&gt; a\n\ndata X = X\ndata Y = Y\n\ndata AProperty = AProperty\ndata BProperty = BProperty\n\ndata A = A AProperty X\ndata B = B BProperty Y\ninstance C A AProperty where\n    changeProperty (A _ x) ap = A ap x\ninstance C B BProperty where\n    changeProperty (B _ y) bp = B bp y\n</code></pre>\n\n<p>As for if it is the best solution I don't know.</p>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1524054769, "post_id": 49899030, "comment_id": 86815006, "body": "Leaving off the <code>ap -&gt; a</code> dependency might be a closer analog to the type family version. Or, going the other way, adding a type family <code>CContainer a</code> and a constraint like <code>class CContainer (CProperty a) ~ a =&gt; C a where ...</code> might be a closer analog to the functional dependency version."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 3, "last_activity_date": 1524052314, "creation_date": 1524052314, "answer_id": 49899030, "question_id": 49896040, "link": "https://stackoverflow.com/questions/49896040/handling-different-argument-types-for-different-instances-of-typeclass/49899030#49899030", "title": "handling different argument types for different instances of typeclass", "body": "<p>I reckon you want this:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\nclass C a where\n  type CProperty a :: *\n  changeProperty :: a -&gt; CProperty a -&gt; a\n\ndata A = A AProperty X\ndata B = B BProperty Y\ninstance C A where\n   type CProperty A = AProperty\n   changeProperty (A _ x) ap = A ap x\ninstance C B where\n   type CProperty B = BProperty\n   changeProperty (B _ y) bp = B bp y\n</code></pre>\n\n<p>...or, if indeed <code>AProperty</code> only applies to <code>A</code>, a MPTC solution with <em>functional dependencies</em>:</p>\n\n<pre><code>{-# LANGUAGE FunctionalDependencies #-}\n\nclass C a ap | ap -&gt; a, a -&gt; ap where\n    changeProperty :: a -&gt; ap -&gt; a\n\ndata X = X\ndata Y = Y\n\ndata AProperty = AProperty\ndata BProperty = BProperty\n\ndata A = A AProperty X\ndata B = B BProperty Y\n\ninstance C A AProperty where\n    changeProperty (A _ x) ap = A ap x\ninstance C B BProperty where\n    changeProperty (B _ y) bp = B bp y\n</code></pre>\n\n<p>As you've noticed, this also compiles without the functional dependencies, however that is often cumbersome to use in practice because then for all the compiler knows, <code>A</code> could have any other property and <code>AProperty</code> could apply to any other type, so you end up having to type lots of explicits constraints for the type checker.</p>\n"}, {"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1524055202, "post_id": 49899952, "comment_id": 86815295, "body": "I agree, classes that just aren&#39;t needed should be avoided."}, {"owner": {"reputation": 131, "user_id": 9663052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c5e77edc1e34cdb3eb39ca0b5a8854a?s=128&d=identicon&r=PG&f=1", "display_name": "notBob", "link": "https://stackoverflow.com/users/9663052/notbob"}, "edited": false, "score": 0, "creation_date": 1524065336, "post_id": 49899952, "comment_id": 86822840, "body": "Thanks! This is indeed a lot cleaner in many ways. I am rather new to Haskell and functional languages in general so this was very helpful."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 4, "last_activity_date": 1524055150, "creation_date": 1524055150, "answer_id": 49899952, "question_id": 49896040, "link": "https://stackoverflow.com/questions/49896040/handling-different-argument-types-for-different-instances-of-typeclass/49899952#49899952", "title": "handling different argument types for different instances of typeclass", "body": "<p>I like the other solutions for their generality. But in this particular case, I'd like to propose a classless solution.</p>\n\n<pre><code>data Meta properties parameters = Meta properties parameters\n\nchangeProperty :: Meta props params -&gt; props -&gt; Meta props params\nchangeProperty (Meta props params) props' = Meta props' params\n\ntype A = Meta AProperty X\ntype B = Meta BProperty Y\n</code></pre>\n\n<p>This kind of thing is a very common need; see also <a href=\"https://stackoverflow.com/q/7365425/791604\">this question</a> for a brief overview of the record accessor way of achieving this and the libraries folks have built up for reducing the pains associated with record accessors.</p>\n"}], "owner": {"reputation": 131, "user_id": 9663052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c5e77edc1e34cdb3eb39ca0b5a8854a?s=128&d=identicon&r=PG&f=1", "display_name": "notBob", "link": "https://stackoverflow.com/users/9663052/notbob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 1, "accepted_answer_id": 49899952, "answer_count": 3, "score": 0, "last_activity_date": 1524055150, "creation_date": 1524043649, "last_edit_date": 1524045871, "question_id": 49896040, "link": "https://stackoverflow.com/questions/49896040/handling-different-argument-types-for-different-instances-of-typeclass", "title": "handling different argument types for different instances of typeclass", "body": "<p>I have a typeclass C.</p>\n\n<pre><code>class C a where\n  changeProperty :: a -&gt; ??? -&gt; a\n</code></pre>\n\n<p>C has two (or more) instances</p>\n\n<pre><code>data A = A AProperty X\ndata B = B BProperty Y\ninstance C A where\n   changeProperty (A _ x) ap = A ap x\ninstance C B where\n   changeProperty (B _ y) bp = B bp y\n</code></pre>\n\n<p>bp and ap are of different types. AProperty is only compatible with A and BProperty is only compatible with B. Is it possible to make some for of type signature, or other solution that allows the method changeProperty to accept only these combinations? The only options I have been able to think of either completely separate the methods (in this case into changeAProperty and changeBProperty), or require me to make AProperty and BProperty the same type, which allows for invalid combinations like an A with a BProperty. Ideally I would like to have a Property class of which AProperty and BProperty are instances, but I don't know how to do this and avoid the invalid combinations.</p>\n\n<p>edit: The context of this problem is a script for building molecules for MD simulation. A, B and so on are connections between atoms. For example A would be a bond, containing the parameters for this bond in AProperty and the Atoms that are involved in X. B Would be an angle and BP would contain the parameters related to that angle, Y the Atoms and so on.</p>\n"}, {"tags": ["oop", "haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1524040415, "post_id": 49894738, "comment_id": 86805089, "body": "each &quot;regular expression&quot;?"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 6, "creation_date": 1524040434, "post_id": 49894738, "comment_id": 86805111, "body": "The natural way to &quot;group&quot; functions and their data together in Haskell is <i>modules</i>."}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 1, "creation_date": 1524040454, "post_id": 49894738, "comment_id": 86805118, "body": "What&#39;s the purpose exactly? Some kind of inheritance? Perhaps you would be interested in <a href=\"https://softwareengineering.stackexchange.com/questions/134097/why-should-i-prefer-composition-over-inheritance\">Why should I prefer composition over inheritance?</a>? Maybe you could supply a use-case for when you&#39;d like to use this pattern. Doing OOP-like things in Haskell can have several purposes; are you doing your own research in programming patterns, or trying to re-use patterns already under your belt instead of learning new ones?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524040594, "post_id": 49894738, "comment_id": 86805186, "body": "Although <i>object oriented</i> programming <i>can</i> be achieved in Haskell (in the sense that you can do something rather similar), usually it is not really a good idea to change the paradigm."}, {"owner": {"reputation": 255, "user_id": 9437806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3139b8238c9efc59a980c2a114701c9f?s=128&d=identicon&r=PG", "display_name": "Stefan Witzel", "link": "https://stackoverflow.com/users/9437806/stefan-witzel"}, "edited": false, "score": 0, "creation_date": 1524043152, "post_id": 49894738, "comment_id": 86806928, "body": "The use case is this: depending on a set of parameters I have two basic rewriting functions on words. Using these I can define derived rewriting functions and eventually obtain a function that computes a normal form. Now the type is supposed to represent the two basic rewriting rules (or equivalently the parameters) and then the derived rules all belong to the same parameters."}, {"owner": {"reputation": 255, "user_id": 9437806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3139b8238c9efc59a980c2a114701c9f?s=128&d=identicon&r=PG", "display_name": "Stefan Witzel", "link": "https://stackoverflow.com/users/9437806/stefan-witzel"}, "edited": false, "score": 0, "creation_date": 1524043499, "post_id": 49894738, "comment_id": 86807177, "body": "Perhaps I shouldn&#39;t have mentioned object orientation because now all the alarm bells go off before anyone reads what I&#39;m actually asking."}, {"owner": {"reputation": 255, "user_id": 9437806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3139b8238c9efc59a980c2a114701c9f?s=128&d=identicon&r=PG", "display_name": "Stefan Witzel", "link": "https://stackoverflow.com/users/9437806/stefan-witzel"}, "edited": false, "score": 0, "creation_date": 1524047304, "post_id": 49894738, "comment_id": 86809980, "body": "Here is the same question without mention of object orientation: <a href=\"https://stackoverflow.com/questions/49897341/partially-evaluate-several-functions-in-haskell\" title=\"partially evaluate several functions in haskell\">stackoverflow.com/questions/49897341/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 255, "user_id": 9437806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3139b8238c9efc59a980c2a114701c9f?s=128&d=identicon&r=PG", "display_name": "Stefan Witzel", "link": "https://stackoverflow.com/users/9437806/stefan-witzel"}, "edited": false, "score": 0, "creation_date": 1524047261, "post_id": 49896990, "comment_id": 86809949, "body": "Thank you! That does address the question but only for the functions a and b. Can I also get rid of the &quot;where myb = b obj&quot;?"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "reply_to_user": {"reputation": 255, "user_id": 9437806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3139b8238c9efc59a980c2a114701c9f?s=128&d=identicon&r=PG", "display_name": "Stefan Witzel", "link": "https://stackoverflow.com/users/9437806/stefan-witzel"}, "edited": false, "score": 0, "creation_date": 1524047611, "post_id": 49896990, "comment_id": 86810202, "body": "@StefanWitzel I don&#39;t understand what you mean? You don&#39;t need <code>myb = b obj</code> here."}, {"owner": {"reputation": 255, "user_id": 9437806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3139b8238c9efc59a980c2a114701c9f?s=128&d=identicon&r=PG", "display_name": "Stefan Witzel", "link": "https://stackoverflow.com/users/9437806/stefan-witzel"}, "edited": false, "score": 0, "creation_date": 1524051564, "post_id": 49896990, "comment_id": 86812945, "body": "In defining the function d above, I used the function c. Your solution to not having to write out mya and myb is specific to the fact that those are fields of Class, so it won&#39;t work to avoid writing out myc."}], "tags": [], "owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "is_accepted": false, "score": 1, "last_activity_date": 1524046186, "creation_date": 1524046186, "answer_id": 49896990, "question_id": 49894738, "link": "https://stackoverflow.com/questions/49894738/grouping-functions-in-haskell/49896990#49896990", "title": "Grouping functions in Haskell", "body": "<p>If your goal is just to avoid typing too much, you can use the <code>RecordWildCards</code> extension:</p>\n\n<pre><code>{-# LANGUAGE RecordWildCards #-}\n\ndata Class = Obj { a :: Int -&gt; Int, b :: Int -&gt; Int }\n\nf :: Class -&gt; Int -&gt; Int\nf Obj{..} x = a x + b x\n</code></pre>\n\n<p>Then you can use it like this: <code>f (Obj id id) 10 == 20</code></p>\n\n<p>Note that this shadows the actual \"field accessors\", so this doesn't work if you still want to use those in the same function for some reason.</p>\n\n<p>Without extensions, you can also always just write</p>\n\n<pre><code>f (Obj a b) x = a x + b x\n</code></pre>\n\n<p>(Record types can still be pattern matched using the regular constructor syntax).</p>\n"}], "owner": {"reputation": 255, "user_id": 9437806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3139b8238c9efc59a980c2a114701c9f?s=128&d=identicon&r=PG", "display_name": "Stefan Witzel", "link": "https://stackoverflow.com/users/9437806/stefan-witzel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "closed_date": 1524053958, "answer_count": 1, "score": 0, "last_activity_date": 1524046186, "creation_date": 1524039926, "last_edit_date": 1524042713, "question_id": 49894738, "link": "https://stackoverflow.com/questions/49894738/grouping-functions-in-haskell", "closed_reason": "Duplicate", "title": "Grouping functions in Haskell", "body": "<p>Using Haskell I would like to group functions together as I would using object orientation in other languages. Concretely following the reply to this question</p>\n\n<p><a href=\"https://stackoverflow.com/questions/5414323/does-haskell-support-object-oriented-programming\">Does Haskell support object oriented programming</a></p>\n\n<p>let's assume I have a type</p>\n\n<pre><code>data Class = Obj { a :: Int -&gt; Int, b :: Int -&gt; Int }\n</code></pre>\n\n<p>and now I want to define several other functions (methods as it were) that are derived from a and b. One way to do this is to define something like</p>\n\n<pre><code>c :: Class -&gt; Int -&gt; Int\nc obj x = myb (mya x)\n    where mya = a obj\n          myb = b obj\n\nd :: Class -&gt; Int -&gt; Int\nd obj x = myb (myc x)\n    where myb = b obj\n          myc = c obj\n</code></pre>\n\n<p>However this means that in each <s>regular expression</s> pattern I need to list explicitly (in the ``where'' clause) which other functions I am using. My question is: is there a shorter way to achieve this?</p>\n"}, {"tags": ["haskell", "unicode", "syntax-error"], "comments": [{"owner": {"reputation": 4614, "user_id": 1378868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84a42920594ee2a0cc33012c407fd9d5?s=128&d=identicon&r=PG", "display_name": "snak", "link": "https://stackoverflow.com/users/1378868/snak"}, "edited": false, "score": 5, "creation_date": 1524030575, "post_id": 49891713, "comment_id": 86799626, "body": "Rename <code>Ord</code> to <code>ord</code>. A function name must not start with a capital letter."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1524038166, "post_id": 49891713, "comment_id": 86803728, "body": "There already is a predefined <code>ord</code> function, which does what you need. (Further, if you are using Hugs, you should know that it is ancient. Consider using GHC instead)"}], "answers": [{"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": true, "score": 2, "last_activity_date": 1524040599, "creation_date": 1524040599, "answer_id": 49894949, "question_id": 49891713, "link": "https://stackoverflow.com/questions/49891713/error-in-conversion-from-character-to-its-unicode-number/49894949#49894949", "title": "Error in conversion from Character to its Unicode number", "body": "<p>In Haskell, function names must start with a lowercase letter. This is not merely a coding convention; it is part of the actual language syntax. If you try to use an uppercase letter for a function name, you'll get some very perplexing error messages.</p>\n"}], "owner": {"reputation": 37, "user_id": 9320274, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-y2XXwLLa_4A/AAAAAAAAAAI/AAAAAAAAACM/ZDabh3cNQOo/photo.jpg?sz=128", "display_name": "AMINA ARSHAD", "link": "https://stackoverflow.com/users/9320274/amina-arshad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 49894949, "answer_count": 1, "score": 0, "last_activity_date": 1524040599, "creation_date": 1524028808, "last_edit_date": 1524030632, "question_id": 49891713, "link": "https://stackoverflow.com/questions/49891713/error-in-conversion-from-character-to-its-unicode-number", "title": "Error in conversion from Character to its Unicode number", "body": "<p>I am trying to code in Haskell. I want to construct a code in which user inputs the character and computer tells its Unicode number.My code is below.But it does not generates output and display the error message.How can i remove error from my code. Please help me to solve this problem.</p>\n\n<p>Code:</p>\n\n<pre><code>module Code where\n\nOrd :: Char -&gt; Int\n\nOrd c = ...\n</code></pre>\n\n<p>Error Message:</p>\n\n<pre><code>ERROR file:.\\amina.hs:2 - Syntax error in declaration (unexpected `::')\n</code></pre>\n"}, {"tags": ["haskell", "data-kinds"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8174234"}, "edited": false, "score": 1, "creation_date": 1524066173, "post_id": 49890963, "comment_id": 86823393, "body": "Haskell doesn&#39;t yet have dependent types. Have you tried building with a branch of GHC that does?"}, {"owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "edited": false, "score": 0, "creation_date": 1524128211, "post_id": 49890963, "comment_id": 86848925, "body": "Have you seen the approach outlined here: <a href=\"https://gmalecha.github.io/reflections/2017/pattern-matching-on-data-kinds\" rel=\"nofollow noreferrer\">gmalecha.github.io/reflections/2017/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 136287, "user_id": 65696, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/d8da959b2a586b4a147604e6f534a9fe?s=128&d=identicon&r=PG", "display_name": "SingleNegationElimination", "link": "https://stackoverflow.com/users/65696/singlenegationelimination"}, "edited": false, "score": 0, "creation_date": 1524054109, "post_id": 49897249, "comment_id": 86814540, "body": "This has certainly gotten me a lot farther, but i still don&#39;t have a <code>Category</code>"}, {"owner": {"reputation": 1341, "user_id": 1036044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PzcQL.jpg?s=128&g=1", "display_name": "Probie", "link": "https://stackoverflow.com/users/1036044/probie"}, "edited": false, "score": 0, "creation_date": 1524055383, "post_id": 49897249, "comment_id": 86815423, "body": "This probably isn&#39;t the answer you&#39;re hoping for, but it&#39;s not really a <code>Category</code> in Haskell. What would <code>id :: Vec Any Double</code> look like? (<code>Any</code> is from <code>GHC.Prim</code>)"}, {"owner": {"reputation": 136287, "user_id": 65696, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/d8da959b2a586b4a147604e6f534a9fe?s=128&d=identicon&r=PG", "display_name": "SingleNegationElimination", "link": "https://stackoverflow.com/users/65696/singlenegationelimination"}, "edited": false, "score": 0, "creation_date": 1524086921, "post_id": 49897249, "comment_id": 86834464, "body": "@Probie if there&#39;s a precise reason why that is so, and <code>Semigroupoid</code> is the best anyone can do, even by willfully ignoring corner cases, then please add that to you answer so that I can accept it."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1524102107, "post_id": 49897249, "comment_id": 86838737, "body": "<code>Finite</code> is pretty standard, though I&#39;ve never seen that name. <code>proxy</code> arguments are useful for compatibility, but we may as well bite the bullet and use <code>AllowAmbiguousTypes</code>+<code>TypeApplication</code>. <code>Vect</code> should not have a <code>Finite</code> constraint. If anything, it&#39;s the other way around: we can write <code>len :: Vect n a -&gt; SNat n</code> and then we can use a hacky trick that is probably only safe if there is no <code>proxy</code> argument: <code>withFinite :: SNat n -&gt; (Finite n =&gt; r) -&gt; r; withFinite n f = (unsafeCoerce f :: SNat n -&gt; r) n</code>. This works since <code>Finite</code> is just a newtyped <code>SNat</code> without the proxy."}, {"owner": {"reputation": 136287, "user_id": 65696, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/d8da959b2a586b4a147604e6f534a9fe?s=128&d=identicon&r=PG", "display_name": "SingleNegationElimination", "link": "https://stackoverflow.com/users/65696/singlenegationelimination"}, "edited": false, "score": 0, "creation_date": 1524111298, "post_id": 49897249, "comment_id": 86840893, "body": "I&#39;ve found an intellectually satisfying solution, posted below.  Since your answer got me enough momentum, I&#39;ve accepted it, even if (or rather, especially because) you think it is impossible."}, {"owner": {"reputation": 1341, "user_id": 1036044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PzcQL.jpg?s=128&g=1", "display_name": "Probie", "link": "https://stackoverflow.com/users/1036044/probie"}, "edited": false, "score": 0, "creation_date": 1524112139, "post_id": 49897249, "comment_id": 86841102, "body": "I&#39;m always happy to be wrong :) It&#39;d never have occurred to me to add a new constructor just to allow a definition of <code>id</code>."}], "tags": [], "owner": {"reputation": 1341, "user_id": 1036044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PzcQL.jpg?s=128&g=1", "display_name": "Probie", "link": "https://stackoverflow.com/users/1036044/probie"}, "is_accepted": true, "score": 2, "last_activity_date": 1524112306, "last_edit_date": 1524112306, "creation_date": 1524046890, "answer_id": 49897249, "question_id": 49890963, "link": "https://stackoverflow.com/questions/49890963/making-use-of-inductively-defined-applicative-instances-on-type-safe-vectors/49897249#49897249", "title": "making use of inductively defined Applicative instances on type safe vectors", "body": "<p>I haven't played around too much with dependent types in Haskell, but this like something that should be possible. I've managed to get something which compiles, but I think there's a better way though...</p>\n\n<p>The trick is to be able to produce something you can recurse over which carries sufficient type information without actually needing to already have a <code>Vector</code>. This allows us to collapse both Applicative instances into a single Applicative instance (unfortunately adding a constraint, <code>Finite</code> which hopefully won't cause an issue later)</p>\n\n<pre><code>{-# LANGUAGE DataKinds, PolyKinds, MultiParamTypeClasses, FunctionalDependencies, FlexibleInstances, FlexibleContexts, GADTs, DeriveTraversable, StandaloneDeriving, ScopedTypeVariables #-}\n\nmodule Vector where\nimport Control.Category\nimport Data.Proxy\n\ndata Natural = Z | S Natural\n\ndata SNat n where\n  SZ :: SNat Z\n  SS :: Finite n =&gt; SNat n -&gt; SNat (S n)\n\nclass Finite (a :: Natural) where\n  toSNat :: proxy a -&gt; SNat a\n\ninstance Finite Z where\n  toSNat _ = SZ\ninstance (Finite a) =&gt; Finite (S a) where\n  toSNat _ = SS (toSNat (Proxy :: Proxy a))\n\ndata Vec (n :: Natural) a where\n  VNil :: Vec Z a\n  VCons :: (Finite n) =&gt; a -&gt; Vec n a -&gt; Vec (S n) a\n\nderiving instance Functor (Vec n)\nderiving instance Foldable (Vec n)\nderiving instance Traversable (Vec n)\n\ninstance (Finite n) =&gt; Applicative (Vec n) where\n  pure (a :: a) = go (toSNat (Proxy :: Proxy n))\n    where go :: forall (x :: Natural) . SNat x -&gt; Vec x a\n          go SZ = VNil\n          go (SS m) = VCons a (go m)\n  (fv :: Vec n (a -&gt; b)) &lt;*&gt; (xv :: Vec n a) = go (toSNat (Proxy :: Proxy n)) fv xv\n    where go :: forall (x :: Natural) . SNat x -&gt; Vec x (a -&gt; b) -&gt; Vec x a -&gt; Vec x b\n          go SZ VNil VNil = VNil\n          go (SS m) (VCons f fs) (VCons x xs) = VCons (f x) (go m fs xs)\n\nvmult :: Num a =&gt; Vec i (Vec k a) -&gt; Vec j (Vec k a) -&gt; Vec j (Vec i a)\nvmult _ VNil = VNil\nvmult xs (VCons y ys) = VCons (dotProduct y &lt;$&gt; xs) $ vmult xs ys\n\ndotProduct :: Num a =&gt; Vec n a -&gt; Vec n a -&gt; a\ndotProduct VNil VNil = 0\ndotProduct (VCons x xs) (VCons y ys) = x * y + dotProduct xs ys\n\ndata Matrix a i j where\n  Matrix :: (Finite i, Finite j) =&gt; Vec i (Vec j a) -&gt; Matrix a i j\n\ninstance Num a =&gt; Category (Matrix a) where\n  Matrix x . Matrix y = Matrix $ (vmult (sequenceA x) y)\n</code></pre>\n\n<p>Edit:\n<s><code>Matrix</code> isn't a category. There is no identity - we require <code>forall (n :: Natural) . Matrix a n n</code> </p>\n\n<p>Unfortunately, all kinds in Haskell are inhabited by <code>Any</code>, so we'd need to be able to have a <code>Matrix a Any Any</code>, but we can only have matrices where the dimensions are \"true\" <code>Natural</code>s, so the best we can ever do is <code>forall (n :: Natural) . Finite n =&gt; Matrix a n n</code> </s>  It turns out I'm wrong here and it can actually be done</p>\n"}, {"tags": [], "owner": {"reputation": 136287, "user_id": 65696, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/d8da959b2a586b4a147604e6f534a9fe?s=128&d=identicon&r=PG", "display_name": "SingleNegationElimination", "link": "https://stackoverflow.com/users/65696/singlenegationelimination"}, "is_accepted": false, "score": 1, "last_activity_date": 1524111199, "creation_date": 1524111199, "answer_id": 49912605, "question_id": 49890963, "link": "https://stackoverflow.com/questions/49890963/making-use-of-inductively-defined-applicative-instances-on-type-safe-vectors/49912605#49912605", "title": "making use of inductively defined Applicative instances on type safe vectors", "body": "<p>After a bit of proof by intimidation (and several hours on the train), I came up with this. </p>\n\n<p>If you defer the proof of <code>Finite</code>ness to the very end, you can multiply anything... the terms we want to write are straitforward.</p>\n\n<pre><code>vdiag :: forall a i j. a -&gt; a -&gt; a -&gt; KNat i -&gt; KNat j -&gt; Vec i (Vec j a)\nvdiag u d l = go\n  where\n    go :: forall i' j'. KNat i' -&gt; KNat j' -&gt; Vec i' (Vec j' a)\n    go (KS i) (KS j) =\n      VCons (VCons d  $  vpure u j)\n            (VCons l &lt;$&gt; go i j)\n    go KZ _ = VNil\n    go (KS i) KZ = vpure VNil (KS i)\n\nvpure :: a -&gt; KNat m -&gt; Vec m a\nvpure x KZ = VNil\nvpure x (KS n) = VCons x $ vpure x n\n</code></pre>\n\n<p>But we don't know what <code>i</code> and <code>j</code> will be when we actually need to use them for <code>Category.id</code> (other than that they are equal).  We CPS them!  An extra constructor to <code>Matrix a</code> is given, with a Rank 2 constraint.</p>\n\n<pre><code>data Matrix a i j where\n  DiagonalMatrix :: (Finite i =&gt; KNat i -&gt; Vec i (Vec i a)) -&gt; Matrix a i i\n--                  ^^^^^^^^^                             ^\n  Matrix :: (Finite i, Finite j) =&gt; Vec i (Vec j a) -&gt; Matrix a i j\n</code></pre>\n\n<p>Any time We happen to need to multiply such things, we can use the fact that we know the inner index <code>k</code> from the other term being multiplied:</p>\n\n<pre><code>instance Num a =&gt; Semigroupoid (Matrix a) where\n  o :: forall a i j k. Num a =&gt; Matrix a k j -&gt; Matrix a i k -&gt; Matrix a i j\n  Matrix x          `o` Matrix y          =\n      Matrix (vmult (sequenceA   x                             )   y)\n  DiagonalMatrix fx `o` Matrix y          =\n      Matrix (vmult (sequenceA (fx (toFNat (Proxy :: Proxy k))))   y)\n  Matrix x          `o` DiagonalMatrix fy = \n      Matrix (vmult (sequenceA   x                             ) (fy (toFNat (Proxy :: Proxy k))))\n</code></pre>\n\n<p>that is, unless they're <em>both</em> diagonal.  In any case, they're all the same, so we can use the index we get later for all three now:</p>\n\n<pre><code>  DiagonalMatrix fx `o` DiagonalMatrix fy = DiagonalMatrix $ \n      \\i -&gt; vmult (sequenceA (fx i)) (fy i)\n</code></pre>\n\n<p>It's because of this step that It's neccessary to restrict the CPS'ed <code>Matrix</code> to only square ones.  At first I tried just CPSing all the time, but that requires the end user remember all of the intermediate indices and prove them, too, instead of only the indices of the result.  Though I'm sure that could be made to work, at least for just a category, it's unnecessary and draconian.</p>\n\n<p>Anyways, We're done now, <code>id</code> is a CPS'd <code>vdiag</code>.</p>\n\n<pre><code>instance Num a =&gt; Category (Matrix a) where\n  (.) = o\n  id = DiagonalMatrix $ \\i -&gt; vdiag 0 1 0 i i\n</code></pre>\n\n<p>of course, extracting rows and columns from a <code>Matrix a</code> requires that you know how big a matrix you've asked for is.</p>\n\n<pre><code>unMatrix :: (Finite i, Finite j) =&gt; Matrix a i j -&gt; Vec i (Vec j a)\nunMatrix (Matrix x) = x\nunMatrix (DiagonalMatrix fx) = fx (toFNat (Proxy))\n\ntype Zero = Z\ntype One = S Z\ntype Two = S One\ntype Three = S Two\ntype Four = S Three\n\nf :: Vec Two (Vec Three Int)\nf = VCons (VCons 1 $ VCons 2 $ VCons 3 VNil)\n  $ VCons (VCons 4 $ VCons 5 $ VCons 6 VNil)\n  $ VNil\n\ng :: Vec Four (Vec Two Int)\ng = VCons (VCons 1 $ VCons 2 VNil)\n  $ VCons (VCons 3 $ VCons 4 VNil)\n  $ VCons (VCons 5 $ VCons 6 VNil)\n  $ VCons (VCons 7 $ VCons 8 VNil)\n  $ VNil\n\nfg = unMatrix $ Matrix f . id . Matrix g\n--                         ^^\n</code></pre>\n\n<p>but that doesn't seen to be too big an obligation.</p>\n\n<pre><code>&gt; fg\nVCons (VCons 9 (VCons 12 (VCons 15 VNil))) (VCons (VCons 19 (VCons 26 (VCons 33 VNil))) (VCons (VCons 29 (VCons 40 (VCons 51 VNil))) (VCons (VCons 39 (VCons 54 (VCons 69 VNil))) VNil)))\n</code></pre>\n\n<p>for completeness, here's the whole thing: <a href=\"https://gist.github.com/danbornside/f44907fe0afef17d5b1ce93dd36ce84d\" rel=\"nofollow noreferrer\">https://gist.github.com/danbornside/f44907fe0afef17d5b1ce93dd36ce84d</a></p>\n"}], "owner": {"reputation": 136287, "user_id": 65696, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/d8da959b2a586b4a147604e6f534a9fe?s=128&d=identicon&r=PG", "display_name": "SingleNegationElimination", "link": "https://stackoverflow.com/users/65696/singlenegationelimination"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 2, "accepted_answer_id": 49897249, "answer_count": 2, "score": 5, "last_activity_date": 1524112306, "creation_date": 1524023993, "last_edit_date": 1524055263, "question_id": 49890963, "link": "https://stackoverflow.com/questions/49890963/making-use-of-inductively-defined-applicative-instances-on-type-safe-vectors", "title": "making use of inductively defined Applicative instances on type safe vectors", "body": "<p>I'm trying to write down the <code>Category</code> of <sup>(finite-dimensional free)</sup>vector spaces, but I can't seem to convince GHC that any given length indexed vector is <code>Applicative</code>.  </p>\n\n<p>here's what I have:</p>\n\n<pre><code>{-# LANGUAGE DataKinds, PolyKinds, MultiParamTypeClasses, FunctionalDependencies, FlexibleInstances, FlexibleContexts, GADTs, DeriveTraversable, StandaloneDeriving #-}\n\n-- | Quick(slow) and dirty typesafe vectors\nmodule Vector where\nimport Control.Category\n</code></pre>\n\n<p>Vectors are lists with a length parameter</p>\n\n<pre><code>data Natural = Z | S Natural\ndata Vec (n :: Natural) a where\n  VNil :: Vec Z a\n  VCons :: a -&gt; Vec n a -&gt; Vec (S n) a\nderiving instance Functor (Vec n)\nderiving instance Foldable (Vec n)\nderiving instance Traversable (Vec n)\n</code></pre>\n\n<p>To get the category, we need matrix multiplication. The obvious implementation makes the indices come out a little backwards from what we normally want.</p>\n\n<pre><code>vmult :: Num a =&gt; Vec i (Vec k a) -&gt; Vec j (Vec k a) -&gt; Vec j (Vec i a)\n--                    ^      ^           ^      ^           ^      ^\nvmult _ VNil = VNil\nvmult xs (VCons y ys) = VCons (dotProduct y &lt;$&gt; xs) $ vmult xs ys\n\ndotProduct :: Num a =&gt; Vec n a -&gt; Vec n a -&gt; a\ndotProduct VNil VNil = 0\ndotProduct (VCons x xs) (VCons y ys) = x * y + dotProduct xs ys\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>with @Probie's <a href=\"https://stackoverflow.com/a/49897249/65696\">help</a>, I've managed to solve the earlier problem, which is sufficient to define an instance for <code>Semigroupoid</code>s</p>\n\n<pre><code>data KNat n where\n  KZ :: KNat Z\n  KS :: Finite n =&gt; KNat n -&gt; KNat (S n)\n\nclass Finite (a :: Natural) where toFNat :: proxy a -&gt; KNat a\ninstance Finite Z where toFNat _ = KZ\ninstance Finite n =&gt; Finite (S n) where toFNat _= KS (toFNat (Proxy :: Proxy n))\n\ninstance Finite n =&gt; Applicative (Vec n) where\n  pure :: forall a. a -&gt; Vec n a\n  pure x = go (toFNat (Proxy :: Proxy n))\n    where\n      go :: forall (m :: Natural). KNat m -&gt; Vec m a\n      go KZ = VNil\n      go (KS n) = VCons x $ go n\n\n  (&lt;*&gt;) :: forall a b. Vec n (a -&gt; b) -&gt; Vec n a -&gt; Vec n b\n  nfs &lt;*&gt; nxs = go (toFNat (Proxy :: Proxy n)) nfs nxs\n    where\n      go :: forall (m :: Natural). KNat m -&gt; Vec m (a -&gt; b) -&gt; Vec m a -&gt; Vec m b\n      go KZ VNil VNil = VNil\n      go (KS n) (VCons f fs) (VCons x xs) = VCons (f x) (go n fs xs)\n\ndata Matrix a i j where\n  Matrix :: (Finite i, Finite j) =&gt; Vec i (Vec j a) -&gt; Matrix a i j\n\ninstance Num a =&gt; Semigroupoid (Matrix a) where\n  Matrix x `o` Matrix y = Matrix (vmult (sequenceA x) y)\n</code></pre>\n\n<p>but I run into a similar problem as before when defining <code>Category.id</code>:</p>\n\n<pre><code>instance Num a =&gt; Category (Matrix a) where\n  (.) = o\n  id :: forall (n :: Natural). Matrix a n n\n  id = Matrix (go (toFNat (Proxy :: Proxy n)))\n    where\n      go :: forall (m :: Natural). (KNat m) -&gt; Vec m (Vec m a)\n      go KZ = VNil\n      go (KS n) = VCons (VCons 1 (pure 0)) (VCons 0 &lt;$&gt; go n)\n</code></pre>\n\n<p>Instead of needing to summon an <code>Applicative (Vec n)</code> from thin air, I now need a <code>Finite n</code>.  </p>\n\n<pre><code>src/Vector.hs:59:8: error:\n    \u2022 Could not deduce (Finite n) arising from a use of \u2018Matrix\u2019\n      from the context: Num a\n        bound by the instance declaration at src/Vector.hs:56:10-37\n      Possible fix:\n        add (Finite n) to the context of\n          the type signature for:\n            Control.Category.id :: forall (n :: Natural). Matrix a n n\n    \u2022 In the expression: Matrix (go (toFNat (Proxy :: Proxy n)))\n      In an equation for \u2018Control.Category.id\u2019:\n          Control.Category.id\n            = Matrix (go (toFNat (Proxy :: Proxy n)))\n            where\n                go :: forall (m :: Natural). (KNat m) -&gt; Vec m (Vec m a)\n                go KZ = VNil\n                go (KS n) = VCons (VCons 1 (pure 0)) (VCons 0 &lt;$&gt; go n)\n      In the instance declaration for \u2018Category (Matrix a)\u2019\n   |\n59 |   id = Matrix (go (toFNat (Proxy :: Proxy n)))\n   |        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>There seems to be no way out of needing a side condition for this.</p>\n\n<p><em>end edits</em></p>\n\n<hr>\n\n<p>For context, This is what I had before, <code>Vec n</code> is inductively <code>Applicative</code></p>\n\n<pre><code>instance Applicative (Vec Z) where\n  pure _ = VNil\n  _ &lt;*&gt; _ = VNil\ninstance Applicative (Vec n) =&gt; Applicative (Vec (S n)) where\n  pure a = VCons a $ pure a\n  VCons f fs &lt;*&gt; VCons x xs = VCons (f x) (fs &lt;*&gt; xs)\n</code></pre>\n\n<p>to get a category instance, we need to rearrange the <code>a</code> behind the indices...</p>\n\n<pre><code>data Matrix a i j where\n  Matrix :: Vec i (Vec j a) -&gt; Matrix a i j\n</code></pre>\n\n<p>But there's no way to rearrange the indices themselves without rearranging one of the terms, too...</p>\n\n<pre><code>instance Num a =&gt; Category (Matrix a) where\n  Matrix x . Matrix y = Matrix $ (vmult (sequenceA x) y)\n--                                       ^^^^^^^^^\n</code></pre>\n\n<p>However:</p>\n\n<pre><code>src/Vector.hs:36:42: error:\n    \u2022 Could not deduce (Applicative (Vec c))\n        arising from a use of \u2018sequenceA\u2019\n      from the context: Num a\n        bound by the instance declaration at src/Vector.hs:35:10-37\n    \u2022 In the first argument of \u2018vmult\u2019, namely \u2018(sequenceA x)\u2019\n      In the second argument of \u2018($)\u2019, namely \u2018(vmult (sequenceA x) y)\u2019\n      In the expression: Matrix $ (vmult (sequenceA x) y)\n   |\n36 |   Matrix x . Matrix y = Matrix $ (vmult (sequenceA x) y)\n   |                                          ^^^^^^^^^^^\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1524014673, "post_id": 49889625, "comment_id": 86795477, "body": "You could define a second helper function <code>go&#39;</code> that mimics <code>go</code>, so that you can call <code>go i s [] = go&#39; i s [0]</code>, but I think that would get more complicated than what you have now. What you have now looks fine."}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1524016219, "post_id": 49889625, "comment_id": 86795827, "body": "@chepner having a part in a function that adds a whole extra walk through of the list seems painful (doubling the number of passes just for one extra step)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1524019230, "post_id": 49889625, "comment_id": 86796391, "body": "It&#39;s not an extra walk; <code>++</code> is lazy, so each time you try to get an element from the list, <code>h:hs</code> just gets matched against <code>x : xs ++ [0]</code> instead of <code>x:xs</code>. <code>++</code> is only bad if you try to build up a list by appending to it one item at a time; here, you are only appending one single item."}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1524049525, "post_id": 49889625, "comment_id": 86811534, "body": "@chepner I actually totally forgot about the lazy evaluation... thanks"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1524053606, "post_id": 49889625, "comment_id": 86814246, "body": "@chepner It is an extra walk. Each time you try to get an element from the list, <code>h:hs</code> gets matched against <code>xs ++ [0]</code>; to evaluate <code>xs ++ [0]</code>, the <code>y:ys</code> pattern in the implementation of <code>++</code> gets matched against <code>xs</code>. This is one extra match compared to not having called <code>++</code> -- in other words, over the course of touching the whole list, you have done one extra walk."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1524053991, "post_id": 49889625, "comment_id": 86814469, "body": "Oh, right. I was thinking of the quadratic blow-up you get, for example, when you try to reverse a string with <code>reverse (x:xs) == xs ++ [0]</code>."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1524039126, "post_id": 49889820, "comment_id": 86804300, "body": "Is this really equivalent? The original code, on <code>[0]</code> could recurse as <code>[0]</code> or <code>[]</code>, depending on <code>0&lt;tH</code>. Here we always recurse as <code>[]</code>, which however is handled as <code>[0]</code>. It&#39;s not completely obvious to me."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1524053420, "post_id": 49889820, "comment_id": 86814146, "body": "@chi I will answer in two ways: with an argument that it&#39;s correct, and with evidence. 1. It is correct: this code, when encountering <code>[]</code> (which really represents <code>[0]</code>) also dispatches on <code>0&lt;tH</code>. In one case it recurses like the original; in the other it doesn&#39;t, but if you look carefully at the original code you&#39;ll see that the &quot;recursive&quot; step it would do in that case always returns <code>[]</code>, so recursion isn&#39;t actually needed. 2. QuickCheck does not find any examples where these two functions differ, even if you take the call to <code>maximum</code> out of both to make it easier to find counterexamples."}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1524056495, "post_id": 49889820, "comment_id": 86816210, "body": "the code duplication was something I was hoping to avoid. I guess my implementation of the the algorithm is the problem. Do you have any suggestions of what I should i have done in the first place to avoid this problem?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1524057220, "post_id": 49889820, "comment_id": 86816696, "body": "@matthias Could you describe what you&#39;re trying to compute a bit more? I don&#39;t really understand your description or your code -- I arrived at this answer through purely mechanical transformations of your code, without being guided by intuition or insight."}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1524057737, "post_id": 49889820, "comment_id": 86817078, "body": "Its a solution to finding the biggest rectangle in a histogram. (this problem <a href=\"https://www.geeksforgeeks.org/largest-rectangle-under-histogram/\" rel=\"nofollow noreferrer\">geeksforgeeks.org/largest-rectangle-under-histogram</a>).  The algorithm is described there. It would be too much to write as a comment but basically  &quot;We traverse all bars from left to right, maintain a stack of bars. Every bar is pushed to stack once. A bar is popped from stack when a bar of smaller height is seen. When a bar is popped, we calculate the area with the popped bar as smallest bar&quot;."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 3, "last_activity_date": 1524017367, "last_edit_date": 1524017367, "creation_date": 1524015431, "answer_id": 49889820, "question_id": 49889625, "link": "https://stackoverflow.com/questions/49889625/haskell-continuing-recursion-for-extra-step/49889820#49889820", "title": "Haskell : continuing recursion for extra step", "body": "<p>Modify your base case and unroll the loop one step. It leads to a bit of code duplication, but it doesn't look too terrible.</p>\n\n<pre><code>rect' xs = maximum $ go 0 [] xs where\n  go i ((_, tH):r@((t,_):_)) []     | 0 &lt; tH = tH * (i - t - 1) : go i r []\n  go i s                     []     = []\n  go i ((_, tH):r@((t,_):_)) (h:hs) | h &lt; tH = tH * (i - t - 1) : go i r (h:hs)\n  go i s                     (h:hs) = go (i + 1) ((i,h):s)  hs\n</code></pre>\n"}], "owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1524017367, "creation_date": 1524013854, "last_edit_date": 1524016049, "question_id": 49889625, "link": "https://stackoverflow.com/questions/49889625/haskell-continuing-recursion-for-extra-step", "title": "Haskell : continuing recursion for extra step", "body": "<p>If I have a recursive function that does comparisons on every element on a list; what is the best way to have it do an extra step at then end as if the list had an extra 0 on the end, without actually appending 0 to the list in the first place.</p>\n\n<pre><code>rect xs = maximum $ go 0 [] (xs ++ [0]) where\n  go i s                     []     = []\n  go i ((_, tH):r@((t,_):_)) (h:hs) | h &lt; tH = tH * (i - t - 1) : go i r (h:hs)\n  go i s                     (h:hs) = go (i + 1) ((i,h):s)  hs\n</code></pre>\n\n<p>I am think that there must be a better way than doing the <code>xs ++ [0]</code> but I can't come up with it.</p>\n\n<p>Note: The function is to find the largest rectangle in a histogram</p>\n"}, {"tags": ["c", "linux", "haskell", "x11", "xlib"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1524003527, "post_id": 49887999, "comment_id": 86792712, "body": "I&#39;d guess that <code>w</code> is the input focus window, which is typically a sub-sub-sub...window of the one you want, e.g. it is a single text entry widget. Perhaps you could try to access the parent, then the grandparent, and so on until you find a window having a title."}, {"owner": {"reputation": 20326, "user_id": 750216, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/974fb481d985024715a6816dfbb9cebf?s=128&d=identicon&r=PG", "display_name": "R\u0103zvan Flavius Panda", "link": "https://stackoverflow.com/users/750216/r%c4%83zvan-flavius-panda"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1524004143, "post_id": 49887999, "comment_id": 86792910, "body": "@chi You are most probably right about that. The irony is that all the programs I was testing against did not have a title."}], "answers": [{"tags": [], "owner": {"reputation": 41648, "user_id": 108359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8a34d29224f05cd8bd1f480c89cf112?s=128&d=identicon&r=PG", "display_name": "Brian McKenna", "link": "https://stackoverflow.com/users/108359/brian-mckenna"}, "is_accepted": true, "score": 5, "last_activity_date": 1524003871, "creation_date": 1524003871, "answer_id": 49888373, "question_id": 49887999, "link": "https://stackoverflow.com/questions/49887999/haskell-fetchname-from-x11-library-does-not-return-the-name-of-the-window/49888373#49888373", "title": "Haskell fetchName from X11 library does not return the name of the window", "body": "<p>It looks like <code>fetchName</code> isn't always filled in. Instead you need to use the <code>_NET_WM_NAME</code> property:</p>\n\n<pre><code>import           Control.Concurrent\nimport           Data.Time.Clock\nimport           Debug.Trace\nimport           Graphics.X11\nimport           Graphics.X11.Xlib.Extras\n\nmain :: IO ()\nmain = do\n  d &lt;- openDisplay \"\"\n  loop d\n\nloop :: Display -&gt; IO ()\nloop d = do\n  time &lt;- getCurrentTime\n  (w, _) &lt;- getInputFocus d\n  a &lt;- internAtom d \"_NET_WM_NAME\" False\n  p &lt;- getTextProperty d w a\n  ps &lt;- wcTextPropertyToTextList d p\n  windowAttrs &lt;- getWindowAttributes d w\n  print $ show time ++ \" Name: \" ++ show ps ++ \" Width: \" ++ show (wa_width windowAttrs)\n  threadDelay 1000000\n  loop d\n</code></pre>\n\n<p>This is what XMonad does:</p>\n\n<p><a href=\"https://github.com/xmonad/xmonad/blob/8b055621e92e7ade127043e968f50713c15a00a0/src/XMonad/ManageHook.hs#L71-L80\" rel=\"noreferrer\">https://github.com/xmonad/xmonad/blob/8b055621e92e7ade127043e968f50713c15a00a0/src/XMonad/ManageHook.hs#L71-L80</a></p>\n"}, {"tags": [], "owner": {"reputation": 20326, "user_id": 750216, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/974fb481d985024715a6816dfbb9cebf?s=128&d=identicon&r=PG", "display_name": "R\u0103zvan Flavius Panda", "link": "https://stackoverflow.com/users/750216/r%c4%83zvan-flavius-panda"}, "is_accepted": false, "score": 1, "last_activity_date": 1524261455, "creation_date": 1524261455, "answer_id": 49950256, "question_id": 49887999, "link": "https://stackoverflow.com/questions/49887999/haskell-fetchname-from-x11-library-does-not-return-the-name-of-the-window/49950256#49950256", "title": "Haskell fetchName from X11 library does not return the name of the window", "body": "<p>In the end I had to adapt Brian's answer to the more complete definition from XMonad (because of exceptions being thrown by some windows):</p>\n\n<pre><code>import           Control.Exception.Extensible          (SomeException (..),\n                                                        bracket)\nimport qualified Control.Exception.Extensible          as E\nimport           Graphics.X11\nimport           Graphics.X11.Xlib.Extras\n\ngetWindowTitle :: Display -&gt; IO String\ngetWindowTitle d = do\n  (w, _) &lt;- getInputFocus d\n  let getProp =\n          (internAtom d \"_NET_WM_NAME\" False &gt;&gt;= getTextProperty d w)\n              `E.catch` \\(SomeException _) -&gt; getTextProperty d w wM_NAME\n      extract prop = do l &lt;- wcTextPropertyToTextList d prop\n                        return $ if null l then \"\" else head l\n  bracket getProp (xFree . tp_value) extract `E.catch` \\(SomeException _) -&gt; return \"\"\n</code></pre>\n"}], "owner": {"reputation": 20326, "user_id": 750216, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/974fb481d985024715a6816dfbb9cebf?s=128&d=identicon&r=PG", "display_name": "R\u0103zvan Flavius Panda", "link": "https://stackoverflow.com/users/750216/r%c4%83zvan-flavius-panda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "accepted_answer_id": 49888373, "answer_count": 2, "score": 1, "last_activity_date": 1524261455, "creation_date": 1524001684, "question_id": 49887999, "link": "https://stackoverflow.com/questions/49887999/haskell-fetchname-from-x11-library-does-not-return-the-name-of-the-window", "title": "Haskell fetchName from X11 library does not return the name of the window", "body": "<p>Having the following Haskell code:</p>\n\n<pre><code>import           Control.Concurrent\nimport           Data.Time.Clock\nimport           Debug.Trace\nimport           Graphics.X11\nimport           Graphics.X11.Xlib.Extras\n\nmain :: IO ()\nmain = do\n  d &lt;- openDisplay \"\"\n  loop d\n\nloop :: Display -&gt; IO ()\nloop d = do\n  time &lt;- getCurrentTime\n  (w, _) &lt;- getInputFocus d\n  maybeName &lt;- fetchName d w\n  windowAttrs &lt;- getWindowAttributes d w\n  print $ show time ++ \" Name: \" ++ show maybeName ++ \" Width: \" ++ show (wa_width windowAttrs)\n  threadDelay 1000000\n  loop d\n</code></pre>\n\n<p>The window title returned by <a href=\"http://hackage.haskell.org/package/X11-1.8/docs/Graphics-X11-Xlib-Extras.html#v:fetchName\" rel=\"nofollow noreferrer\">fetchName</a> is always <code>Nothing</code>.</p>\n\n<p>Haskell <a href=\"http://hackage.haskell.org/package/X11-1.8\" rel=\"nofollow noreferrer\">X11</a> library is a wrapper around <a href=\"https://tronche.com/gui/x/xlib/\" rel=\"nofollow noreferrer\">Xlib</a></p>\n\n<p>Possibly related issues:</p>\n\n<ul>\n<li>The width of the window is either correct or it has the value <code>1</code>.</li>\n<li><a href=\"https://stackoverflow.com/q/8825661/750216\">XFetchName always returns 0</a></li>\n</ul>\n"}, {"tags": ["haskell", "animation"], "answers": [{"tags": [], "owner": {"reputation": 4185, "user_id": 15467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89c04ada36efa853c7f5be0a96b6dd9?s=128&d=identicon&r=PG", "display_name": "ja.", "link": "https://stackoverflow.com/users/15467/ja"}, "is_accepted": false, "score": 0, "last_activity_date": 1524629348, "last_edit_date": 1524629348, "creation_date": 1524626837, "answer_id": 50013609, "question_id": 49887830, "link": "https://stackoverflow.com/questions/49887830/strange-behavior-in-fal-haskell-library/50013609#50013609", "title": "Strange behavior in Fal (Haskell library)", "body": "<p>the <code>sample</code> event might be useful:</p>\n\n<pre><code>module Ex1 where\nimport Fal\n\nex = test (paint color2h circl)\ncircl = Fal.translate pt (Fal.ell 0.2 0.2)\npt = (xpos, 0)\nxpos = 0.0 `untilB` lbp -&gt;&gt; (0.0 `stepAccum` sample -&gt;&gt; (+0.01))\n</code></pre>\n"}], "owner": {"reputation": 239, "user_id": 2882340, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/d1f73d60b88e9dff05bdb5d8bfb30f23?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/2882340/florian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1524629348, "creation_date": 1524000844, "question_id": 49887830, "link": "https://stackoverflow.com/questions/49887830/strange-behavior-in-fal-haskell-library", "title": "Strange behavior in Fal (Haskell library)", "body": "<p>I have difficulties with some code. I follow the excellent Haskell School of Expression by Paul Hudak and cannot debug a program. It is an exercise where I must do a Paddleball (exercise 15.1). I am trying to make the ball remain in the center of the screen before a left press. But it breaks the program which works fine if I remove the part <code>0 'untilB' lbp -&gt;&gt;</code> in both xnormalSpeed and ynormalSpeed . The ball will not bounce following the x axis (even though the boolean xbounce becomes true). The value of xnormalSpeed always stays equal to 2.</p>\n\n<pre><code>xpos, ypos :: Behavior Float\nxpos = integral xnormalSpeed\nypos = integral ynormalSpeed\n\nxnormalSpeed, ynormalSpeed :: Behavior Float\nxnormalSpeed = 0 `untilB` lbp -&gt;&gt; (vel `stepAccum` when xbounce -&gt;&gt; negate)\nynormalSpeed = 0 `untilB` lbp -&gt;&gt; (vel `stepAccum` when ybounce -&gt;&gt; negate)\n\nxbounce, ybounce :: Behavior Bool\n\nvel :: Behavior Float\nvel = 2\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1523995757, "post_id": 49886606, "comment_id": 86789350, "body": "By the way, the third line of your <code>myAnd</code> function could (and should) just be <code>myAnd _ _ = True</code> instead of <code>myAnd a b = (&amp;&amp;) a b</code>."}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1523996275, "post_id": 49886606, "comment_id": 86789628, "body": "in <code>tesK</code>, the &quot;leftmost outermost&quot; is your function <code>myAnd</code> which pattern matches against the second argument first. This forces evaluation of that term to check if it is false, causing your program to die."}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "edited": false, "score": 0, "creation_date": 1523996330, "post_id": 49886606, "comment_id": 86789648, "body": "Also, what exactly is your question here? You kind of say a lot of things, but I&#39;m not 100% sure what the exact question you want answered is."}, {"owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "edited": false, "score": 1, "creation_date": 1523997682, "post_id": 49886606, "comment_id": 86790319, "body": "Just a side note, <code>&amp;&amp;</code> in C++ was always guaranteed-lazy; <code>testF</code> would be perfectly defined."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1523998121, "post_id": 49886606, "comment_id": 86790518, "body": "Re: commutativity, check out <a href=\"http://hackage.haskell.org/package/unamb-0.2.7/docs/Data-Unamb.html#v:pand\" rel=\"nofollow noreferrer\"><code>pand</code></a>. In particular we have <code>pand False undefined = pand undefined False = False</code> and <code>pand True undefined = pand undefined True = undefined</code>."}], "answers": [{"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 11, "last_activity_date": 1523996444, "creation_date": 1523996444, "answer_id": 49886821, "question_id": 49886606, "link": "https://stackoverflow.com/questions/49886606/order-of-function-evaluation-and-laziness/49886821#49886821", "title": "Order of function evaluation and laziness", "body": "<p>Haskell doesn't evaluate the leftmost first for all cases. As you saw, this is due to your definitions. Take the definition of <code>&amp;&amp;</code>: </p>\n\n<pre><code>(&amp;&amp;) :: Bool -&gt; Bool -&gt; Bool\n(&amp;&amp;) False _ = False\n(&amp;&amp;) _ False = False\n(&amp;&amp;) _ _     = True\n</code></pre>\n\n<p>Notice that it requires a pattern from the left argument first. This forces the left argument to be evaluated first, and could leave the second argument unevaluated. In your <code>myAnd</code> function, you switch the order of evaluation due to your pattern matching. If you swapped the 2nd and 3rd lines (which you did) the order of evaluation would also swap.</p>\n\n<p>There is absolutely no undefined behaviour occuring here. Don't get your head stuck in C!</p>\n\n<p>However, if a function pattern matches on two (or more) arguments, then it does evaluate the leftmost first. So, for example:</p>\n\n<pre><code>func1 True False = True -- Both arguments evaluated\nfunc1 _ _        = False\n\ntest1 = func1 (error \"leftmost\") (error \"rightmost\")\n-- Running test1 results in the error \"leftmost\"\n</code></pre>\n\n<p>Your point about commutativity is sharp. Technically, this does indeed not allow for the commutativity law. However, when reasoning about Haskell code we usually ignore bottom (<code>error</code> and <code>undefined</code> to non-mathematicians) for two reasons. One, it makes things nicer, and two, you shouldn't be encountering <code>error</code> anyway: that means that you've gone wrong. So in practice, no: <code>&amp;&amp;</code> is functionally commutative. <code>error</code>s should not be happening in your Haskell code, and there's no way to catch them for this reason; it breaks the nice algebraic properties as you pointed out. Use them only for events that should not occur, as in the implementation of <code>head</code>.</p>\n\n<p>There are many other languages similar to Haskell, in particular Agda and Idris, which do away with <code>error</code> and <code>undefined</code> entirely for this reason, mostly because they have a specific goal of logical consistency, in order to be able to quite literally <em>prove</em> that your code is correct. However, Haskell (likely in a bid to stay more mainstream) does not do so.</p>\n"}, {"tags": [], "owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "is_accepted": false, "score": 9, "last_activity_date": 1524003146, "last_edit_date": 1524003146, "creation_date": 1523996842, "answer_id": 49886923, "question_id": 49886606, "link": "https://stackoverflow.com/questions/49886606/order-of-function-evaluation-and-laziness/49886923#49886923", "title": "Order of function evaluation and laziness", "body": "<p>This behavior is guaranteed.</p>\n\n<p><code>||</code> and <code>&amp;&amp;</code> from Prelude <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch9.html#x16-1710009\" rel=\"nofollow noreferrer\">are defined to behave like this</a> in Haskell 2010 section 9:</p>\n\n<pre><code>-- Boolean functions\n(&amp;&amp;), (||) :: Bool -&gt; Bool -&gt; Bool\nTrue &amp;&amp; x = x\nFalse &amp;&amp; _ = False\nTrue || _ = True\nFalse || x = x\n</code></pre>\n\n<p>Pattern matching is also <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-580003.17\" rel=\"nofollow noreferrer\">defined to work left-to-right</a> (3.17.2) with _ matching \u22a5:</p>\n\n<blockquote>\n  <p>Pattern\n      matching proceeds from left to right, and outside to inside, according to the following rules: [...] Matching the wildcard pattern _ against any value always succeeds, and no binding is done.</p>\n</blockquote>\n\n<p>The same is true in the older Haskell 98 specification.</p>\n"}], "owner": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 49886821, "answer_count": 2, "score": 2, "last_activity_date": 1524003146, "creation_date": 1523995558, "question_id": 49886606, "link": "https://stackoverflow.com/questions/49886606/order-of-function-evaluation-and-laziness", "title": "Order of function evaluation and laziness", "body": "<p>A bit of thinking about how \"Laziness\" and order of evaluation of a function</p>\n\n<p>Consider this code : </p>\n\n<pre><code>testF x =  ((length x) &gt;= 1) &amp;&amp; ((head x) == \"foo\")\n\ntestG x =  ((head x) == \"foo\") &amp;&amp; ((length x) &gt;= 1)\n\ntestH x = False &amp;&amp; ((head x) == \"foo\") \n\ntestI x = ((head x) == \"foo\") &amp;&amp; False\n</code></pre>\n\n<p>and the result of execution with an empty list</p>\n\n<pre><code>*Main&gt; testF []\nFalse\n*Main&gt; testG []\n*** Exception: Prelude.head: empty list\n*Main&gt; testH []\nFalse\n*Main&gt; testI []\n*** Exception: Prelude.head: empty list\n</code></pre>\n\n<p>Question concerning testF and testG : I read that Haskell evaluate leftmost outermost which would garantee the result; is it really a requirement of the language or is this testF [] evaluation is actually undefined behaviour ( for example in C++ it was the case until C++11).</p>\n\n<p>Question concerning testH and testI : what seems obvious at first glance does not appear so obvious: even if it evaluates leftmost outermost, which garantee do we have than implementation does not perform some kind of reverse ordering evaluation:</p>\n\n<p>Consider that: </p>\n\n<pre><code>myAnd _ False = False\nmyAnd False _ = False\nmyAnd a b = (&amp;&amp;) a b\n\ntestJ x =  myAnd ((head x) == \"foo\") False \ntestK x =  myAnd False ((head x) == \"foo\")  \n</code></pre>\n\n<p>gives reverted behaviour</p>\n\n<pre><code>*Main&gt; testJ []\nFalse\n*Main&gt; testK []\n*** Exception: Prelude.head: empty list\n</code></pre>\n\n<p>Finally, all the examples above make the (&amp;&amp;) operator failing regarding the commutativity law ( a&amp;&amp;b  == b&amp;&amp;a ), so I end up thinking that all those calls , ideally, should evaluate both arguments and raise an exception. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1523995162, "post_id": 49886424, "comment_id": 86789064, "body": "You need to add more details. At present it is not at all clear what you are asking. How do you describe the movement? Which direction? How many squares? What if it goes off the board?"}, {"owner": {"reputation": 11, "user_id": 9658775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae5429f12434833b0a12aad552c3a264?s=128&d=identicon&r=PG&f=1", "display_name": "Demiss", "link": "https://stackoverflow.com/users/9658775/demiss"}, "reply_to_user": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1523995750, "post_id": 49886424, "comment_id": 86789347, "body": "@PaulJohnson i did edit it now. hope it&#39;s clearer. and there is no off board choice i just need to write it as simple as possble if the movement is diagonal (True) and everything else doesnt matter as it is &quot; false&quot;"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523995785, "post_id": 49886424, "comment_id": 86789362, "body": "And more effort. Usually you better first define the <i>signature</i> of the function, then you can think what patterns can arise, then which cases those patterns have to cover, and finally assign output to each of those cases."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523995825, "post_id": 49886424, "comment_id": 86789384, "body": "Furthermore why do you all of a sudden delete your previous no-attempt question and change your username?"}, {"owner": {"reputation": 11, "user_id": 9658775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae5429f12434833b0a12aad552c3a264?s=128&d=identicon&r=PG&f=1", "display_name": "Demiss", "link": "https://stackoverflow.com/users/9658775/demiss"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523995981, "post_id": 49886424, "comment_id": 86789469, "body": "@WillemVanOnsem somehow i feel stupid for asking all those questions at once Sorry again. it&#39;s just my first week on it and really trying to learn thi stuff"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1523996085, "post_id": 49886424, "comment_id": 86789525, "body": "@Demiss: well there is no problem with <i>being new</i> to something, but somehow, the question(s) do not show much effort. Even if you do not manage to get the Haskell syntax (perfectly) right, then you can still invest effort in it. For example come up with a signature, explain in your own words (or pseudocode) how you would tackle the problem in general."}, {"owner": {"reputation": 11, "user_id": 9658775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae5429f12434833b0a12aad552c3a264?s=128&d=identicon&r=PG&f=1", "display_name": "Demiss", "link": "https://stackoverflow.com/users/9658775/demiss"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523996424, "post_id": 49886424, "comment_id": 86789700, "body": "@WillemVanOnsem sorry if ii seems i am not giving effort. based on your advice i managed to solve the problem. i first defind the Function isDiagonal :: (Int, Int) -&gt; (Int,Int) -&gt; Bool isDiagonal (x,y) (x&#39;,y&#39;)  = if x == 1 &amp;&amp; y == 1 &amp;&amp;  x&#39; == 2 &amp;&amp; y&#39; == 2 then True else False."}, {"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 0, "creation_date": 1523996513, "post_id": 49886424, "comment_id": 86789748, "body": "Try <code>isDiagonal (x,y) (x&#39;,y&#39;) = abs (x - x&#39;) == abs (y - y&#39;)</code> consider inputs like <code>(3,4) (4,5)</code> or <code>(3,5) (4,4)</code> or <code>(0,0) (20,20)</code>. But also note <code>(0,0) (0,0)</code>."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1523996984, "post_id": 49886424, "comment_id": 86789983, "body": "@Demiss notice that the statement <code>if x then True else False</code> is just equivalent to <code>x</code>."}], "owner": {"reputation": 11, "user_id": 9658775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae5429f12434833b0a12aad552c3a264?s=128&d=identicon&r=PG&f=1", "display_name": "Demiss", "link": "https://stackoverflow.com/users/9658775/demiss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 42, "favorite_count": 0, "closed_date": 1523997786, "answer_count": 0, "score": 0, "last_activity_date": 1523995922, "creation_date": 1523994869, "last_edit_date": 1523995922, "question_id": 49886424, "link": "https://stackoverflow.com/questions/49886424/haskell-check-if-object-is-moving-diagaonal-or-not", "closed_reason": "Duplicate", "title": "Haskell check if object is moving diagaonal or not", "body": "<p>If on a 4x5 chessboard i have a soldier with (x,y) coordinates and i need it to move to another (x',y') coordinate which is a diagonal movement how would i argument it on Haskell?.i need to implement a function isDiagonal. its a 4x5 board so there are 20 squares in total. for example if soldier one is on coordniate (1,1) and i want it to move to (2,2) which is a diagonal movement to then give me a \" True return\" how would i write it ? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523994651, "post_id": 49886344, "comment_id": 86788824, "body": "Well even if you manage to boost the algorithm to calculate the minimum, that will not do much better. The bottleneck here looks like the fact that you use a <i>generate and test</i> approach. Constraint programming (and integer linear programming) try to boost efficiency by restricting the domains of the variables."}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 1, "creation_date": 1523995249, "post_id": 49886344, "comment_id": 86789112, "body": "Take a look at <a href=\"http://travis.athougies.net/posts/2018-04-23-combinatorial-optimization.html\" rel=\"nofollow noreferrer\">travis.athougies.net/posts/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 6589573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1d523f5b8ffb2394cda6f2cc88074c8?s=128&d=identicon&r=PG&f=1", "display_name": "uglyoldbob", "link": "https://stackoverflow.com/users/6589573/uglyoldbob"}, "edited": false, "score": 0, "creation_date": 1524061638, "post_id": 49886540, "comment_id": 86819961, "body": "I found the second recommendation interesting. I dug a little deeper into it and found that for GHCI, this definitely is true for total memory usage. I found no difference when compiled with ghc. I suspect this is because of the way ghci keeps named data."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 77, "user_id": 6589573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1d523f5b8ffb2394cda6f2cc88074c8?s=128&d=identicon&r=PG&f=1", "display_name": "uglyoldbob", "link": "https://stackoverflow.com/users/6589573/uglyoldbob"}, "edited": false, "score": 0, "creation_date": 1524061838, "post_id": 49886540, "comment_id": 86820095, "body": "@uglyoldbob: well if you name it, usually Haskell will keep a reference to the <i>start</i> of the list. Since you iterate over it, because the start of the list is alive, all the rest of the elements already calculated remain alive as well, and thus are not garbage collected. If you however do <i>not</i> name the list comprehension, then there is no reason to keep the entire list alive at all. So each time a node of the list is processed, we can immediately forget about that. Haskell has some optimizations in place where there are no nodes generated at all. Do you compile with the <code>-O2</code> flag?"}, {"owner": {"reputation": 77, "user_id": 6589573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1d523f5b8ffb2394cda6f2cc88074c8?s=128&d=identicon&r=PG&f=1", "display_name": "uglyoldbob", "link": "https://stackoverflow.com/users/6589573/uglyoldbob"}, "edited": false, "score": 0, "creation_date": 1524075533, "post_id": 49886540, "comment_id": 86828722, "body": "Indeed I am using the -02 flag for compiling. That makes a lot of sense. Thank you"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 1, "last_activity_date": 1524043415, "last_edit_date": 1524043415, "creation_date": 1523995296, "answer_id": 49886540, "question_id": 49886344, "link": "https://stackoverflow.com/questions/49886344/finding-inputs-to-a-calculation-to-optimize-a-particular-output/49886540#49886540", "title": "finding inputs to a calculation to optimize a particular output", "body": "<p>You can boost the efficiency of your proposed <code>minimum'</code> with:</p>\n\n<pre><code>minimum' :: Ord a =&gt; [(t, a)] -&gt; (t, a)\nminimum' [] = error \"minimum of empty list\"\nminimum' (x:xs) = minTail x xs\n    where minTail m@(xm, fm) (xf@(x, f): xs) | f &lt; fm = minTail xf xs\n                                             | otherwise = minTail m xs\n          minTail cm [] = cm\n</code></pre>\n\n<p>with some extra techniques, we can definitely boost it a but further, but in general this will not boost performance significantly.</p>\n\n<p>A second optimization that <em>will</em> have a huge impact on the use of memory, is <em>not</em> to construct such function with <code>allPairs</code>, but to pass the list immediately into the function. Now Haskell can garbage collect the list elements that are already evaluated. So we can call it with:</p>\n\n<pre><code>minimum' [([a,b,c,d,e,f,g], longCalc a b c d e f g) | a&lt;-[1..40],b&lt;-[1..40],c&lt;-[1..40],d&lt;-[1..40],e&lt;-[1..40],f&lt;-[1..40],g&lt;-[1..40]]\n</code></pre>\n\n<p>But still we will not boost the algorithm to the levels that constraint programming and integer linear programming can. Usually those mechanisms aim to exploit relations in the function, and thus restrict the domains of the variables from the moment a first value is calculated. For <em>integer linear programming (ILP)</em> this is usually done with an optimization technique called <em>cutting plane</em>.</p>\n\n<p>As for your second question, again we can not boost this in terms of time complexity, but we can boost performance with:</p>\n\n<pre><code>onlyLessFunc f y = go (f y)\n    where go _ [] = []\n          go fy (x:xs) | fx &lt; fy = x : go fx xs\n                       | otherwise = go fy xs\n              where fx = f x\n</code></pre>\n\n<p>But again, as said, you are actually trying to optimize the wrong part of the algorithm. Usually it is more beneficial to prevent generating all those values in the first place.</p>\n"}], "owner": {"reputation": 77, "user_id": 6589573, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1d523f5b8ffb2394cda6f2cc88074c8?s=128&d=identicon&r=PG&f=1", "display_name": "uglyoldbob", "link": "https://stackoverflow.com/users/6589573/uglyoldbob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 49886540, "answer_count": 1, "score": 0, "last_activity_date": 1524043415, "creation_date": 1523994505, "question_id": 49886344, "link": "https://stackoverflow.com/questions/49886344/finding-inputs-to-a-calculation-to-optimize-a-particular-output", "title": "finding inputs to a calculation to optimize a particular output", "body": "<p>I'm trying to write some haskell code that calculates a property given some inputs to it. I'll be generic since I have a few different applications I'd like to do with this style of program.</p>\n\n<pre><code>--some random calculation\nlongCalc a b c d e f g = a*b+c-d/e*f+g\n</code></pre>\n\n<p>I want to find the combination of inputs that gives the lowest result. So I generate a list of pairs.</p>\n\n<pre><code>allPairs = [(show [a,b,c,d,e,f,g], longCalc a b c d e f g) | a&lt;-[1..40],b&lt;-[1..40],c&lt;-[1..40],d&lt;-[1..40],e&lt;-[1..40],f&lt;-[1..40],g&lt;-[1..40]]\n\nminimum' :: Ord a =&gt; [(t, a)] -&gt; (t, a)\nminimum' []     = error \"minimum of empty list\"\nminimum' (x:xs) = minTail x xs\n  where minTail currentMin [] = currentMin\n        minTail (m, n) (p:ps)\n          | n &gt; (snd p) = minTail p ps\n          | otherwise   = minTail (m, n) ps\n</code></pre>\n\n<p>Now I have a list with a descriptor of what the inputs were along with the answer.</p>\n\n<p>bestAnswer = minimum' allPairs</p>\n\n<p>I'm not so sure this is the most efficient way of doing this calculation.</p>\n\n<p>In addition I would like to see a progressive calculation of the best answer.</p>\n\n<pre><code>onlyLessFunc f _ [] = []\nonlyLessFunc f y (x:xs)\n | f(x) &lt; f(y) = [x] ++ onlyLessFunc f x xs\n | otherwise = onlyLessFunc f x xs\n</code></pre>\n\n<p>This function should produce a list where only better results get added to the end.</p>\n\n<p>How might I go about making this more efficient? I am currently seeing that my approach uses tons of memory (all of it to be specific).</p>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5775230"}, "edited": false, "score": 0, "creation_date": 1523996514, "post_id": 49885832, "comment_id": 86789749, "body": "This is a more general duplicate of <a href=\"https://stackoverflow.com/questions/12584884/how-do-i-enable-language-extensions-from-within-ghci\" title=\"how do i enable language extensions from within ghci\">stackoverflow.com/questions/12584884/&hellip;</a> although it is worded quite differently"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 5, "last_activity_date": 1523992559, "creation_date": 1523992559, "answer_id": 49885877, "question_id": 49885832, "link": "https://stackoverflow.com/questions/49885832/how-to-properly-define-a-datatype-in-ghci-with-pragma-dependency/49885877#49885877", "title": "How to properly define a datatype in ghci with Pragma dependency?", "body": "<p>In GHCi you <strong>set the pragma <a href=\"https://wiki.haskell.org/Language_Pragmas\" rel=\"noreferrer\">with <code>:set</code></a></strong>:</p>\n\n<pre><code>Prelude&gt; :set -XDeriveFunctor\n</code></pre>\n\n<p>Since the <code>data</code> clause spans over multiple lines, you can declare it between <code>:{</code> and <code>:}</code>:</p>\n\n<pre><code>Prelude&gt; :{\nPrelude| data Tree a = Leaf a | Node (Tree a) (Tree a)\nPrelude|     deriving (Functor, Show)\nPrelude| :}\n</code></pre>\n\n<p>now it should work (tested it locally). We can for instance perform an <code>fmap</code>:</p>\n\n<pre><code>Prelude&gt; fmap (+1) (Node (Leaf 12) (Leaf 25))\nNode (Leaf 13) (Leaf 26)\n</code></pre>\n\n<p><strong>Explanation of failed attempts</strong>:</p>\n\n<ol>\n<li>the first one fails because your <code>data</code> clause spans over multiple lines, so you should put in on one line, or use some sort of grouping. Nevertheless, you did not enable the pragma, so there are two errors here;</li>\n<li>now there is no problem with the <code>data</code> clause, but you can not enable a pragma like this; and</li>\n<li>again the pragma is the problem.</li>\n</ol>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5775230"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 49885877, "answer_count": 1, "score": 3, "last_activity_date": 1523993965, "creation_date": 1523992395, "last_edit_date": 1523993965, "question_id": 49885832, "link": "https://stackoverflow.com/questions/49885832/how-to-properly-define-a-datatype-in-ghci-with-pragma-dependency", "title": "How to properly define a datatype in ghci with Pragma dependency?", "body": "<p>I'm trying to define fmap over a Tree type from hammar's answer in <a href=\"https://stackoverflow.com/questions/7624774/haskell-map-for-trees\">Haskell Map for Trees</a></p>\n\n<p>His definition derives functor, which uses a pragma, which I'm only vaguely familiar with.  His definition is</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor #-}\ndata Tree a = Leaf a | Node (Tree a) (Tree a)\n    deriving (Functor, Show)\n</code></pre>\n\n<p>I can't get the pragma and definition to work in GHCI.  Below are my three mistaken attempts, and I would appreciate any feedback!</p>\n\n<p>First attempt:</p>\n\n<pre><code>Prelude&gt; {-# LANGUAGE DeriveFunctor #-}\nPrelude&gt; data Tree a = Leaf a | Node (Tree a) (Tree a)\nPrelude&gt;     deriving (Functor, Show)\n&lt;interactive&gt;:30:5: parse error on input \u2018deriving\u2019\n</code></pre>\n\n<p>Second try:</p>\n\n<pre><code>Prelude&gt; {-# LANGUAGE DeriveFunctor #-}\nPrelude&gt; data Tree a = Leaf a | Node (Tree a) (Tree a) deriving (Functor, Show)\n&lt;interactive&gt;:32:57:\n    Can't make a derived instance of \u2018Functor Tree\u2019:\n  You need DeriveFunctor to derive an instance for this class\nIn the data declaration for \u2018Tree\u2019\n</code></pre>\n\n<p>Third Try:</p>\n\n<pre><code>Prelude&gt; :{\nPrelude| {-# LANGUAGE DeriveFunctor #-}\nPrelude| data Tree a = Leaf a | Node (Tree a) (Tree a)\nPrelude|     deriving (Functor, Show)\nPrelude| :}\n&lt;interactive&gt;:35:1: parse error on input \u2018data\u2019\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "logic", "case"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 4, "creation_date": 1523987056, "post_id": 49884145, "comment_id": 86784782, "body": "You appear to be trying to update the value of <code>aline</code> and <code>bline</code>. Generally, that&#39;s not possible in Haskell."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1523988119, "post_id": 49884145, "comment_id": 86785399, "body": "&quot;<i>so i can keep typing the commands to edit the line of text.</i>&quot; - you probably just want to call your function that does the reading and matching again - with the new values for <code>aline</code> and <code>bline</code> as arguments."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 0, "last_activity_date": 1523988898, "creation_date": 1523988898, "answer_id": 49884870, "question_id": 49884145, "link": "https://stackoverflow.com/questions/49884145/haskell-case-statement-issue/49884870#49884870", "title": "Haskell: Case statement issue", "body": "<p>Option 1: add a <code>do</code> </p>\n\n<pre><code>case ... of\n  ...\n  (\"DelCharRight\":_) -&gt; do\n     let bLine = delCharRight aLine\n         aLine = bLine\n     putStrLn (...)\n</code></pre>\n\n<p>Option 2: use <code>let .. in ..</code> </p>\n\n<pre><code>case ... of\n  ...\n  (\"DelCharRight\":_) -&gt;\n     let bLine = delCharRight aLine\n         aLine = bLine\n     in putStrLn (...)\n</code></pre>\n\n<p>Option 2 is more general, since it works even when we are not working inside some monad (here we are inside <code>IO</code>, so <code>do</code> is also a possibility).</p>\n"}, {"tags": [], "owner": {"reputation": 1341, "user_id": 1036044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PzcQL.jpg?s=128&g=1", "display_name": "Probie", "link": "https://stackoverflow.com/users/1036044/probie"}, "is_accepted": true, "score": 1, "last_activity_date": 1523989477, "creation_date": 1523989477, "answer_id": 49885026, "question_id": 49884145, "link": "https://stackoverflow.com/questions/49884145/haskell-case-statement-issue/49885026#49885026", "title": "Haskell: Case statement issue", "body": "<p>To answer your exact question, you can just add <code>do</code> after the <code>-&gt;</code></p>\n\n<pre><code>(\"DelCharRight\":_) -&gt; do\n    putStrLn (\"Delete Char Right           |              \" ++ show (delCharRight aLine) \n    let bLine = delCharRight aLine \n    let aLine = bLine\n</code></pre>\n\n<p>But it won't help - a <code>let</code> statement in Haskell can't do what you want. As a general rule, you can't mutate data in Haskell. <code>aLine</code> will only ever have one value. If you have a background in imperative programming, you might look at the following code and (incorrectly) deduce that some sort of mutation is going on, with <code>x</code> changing it's value. But all that's going on is shadowing (try <code>let x = x + x</code>) and see what that does.</p>\n\n<pre><code>someFunc :: IO ()\nsomeFunc = do\n    let x = 3\n    let x = 5\n    print x\n</code></pre>\n\n<p>That said, because you are in <code>IO</code> you do have access to mutation. IORefs (found in <a href=\"https://hackage.haskell.org/package/base-4.11.0.0/docs/Data-IORef.html\" rel=\"nofollow noreferrer\">Data.IORef</a>) are mutable references that you could make use of.</p>\n\n<pre><code>someFunc' :: IO ()\nsomeFunc' = do\n    x &lt;- newIORef 3\n    writeIORef x 5\n    readIORef x &gt;&gt;= print\n</code></pre>\n\n<p>But I'd recommend against using an <code>IORef</code>. It's much more idiomatic Haskell to write a separate function which returns the changed value, and then feed the result back in as an input on the next call. Here's an example of that technique for a simple \"Counter\".</p>\n\n<pre><code>main :: IO ()\nmain = do\n    commandLine &lt;- getLine\n    let commands = words commandLine\n    counter &lt;- runCounter commands 0\n    print counter\n\n-- There is a higher-order functions (foldM) that we \n-- could use instead of this function\n-- but we'll avoid it for the sake of clarity\nrunCounter :: [String] -&gt; Int -&gt; IO Int\nrunCounter [] counter = return counter\nrunCounter (cmd:cmds) counter = do\n    newCounter &lt;- updateCounter cmd counter\n    runCounter cmds counter\n\nupdateCounter :: String -&gt; Int -&gt; IO Int\nupdateCounter command counter = case command of\n    \"UP\" -&gt; do\n        putStrLn \"Incrementing counter\"\n        return (counter + 1)\n    \"DOWN\" -&gt; do\n        putStrLn \"Decrementing counter\"\n        return (counter - 1)\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9660108, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jack Evans", "link": "https://stackoverflow.com/users/9660108/jack-evans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 49885026, "answer_count": 2, "score": 1, "last_activity_date": 1523989477, "creation_date": 1523986167, "question_id": 49884145, "link": "https://stackoverflow.com/questions/49884145/haskell-case-statement-issue", "title": "Haskell: Case statement issue", "body": "<p>I'm new to Haskell and i have to do a project for university. I'm having trouble using a case statement.</p>\n\n<pre><code>case words command of\n        (\"Highlight\":_) -&gt; putStrLn (\"Highlight                   |              \\x1b[32m\\x1b[107m\" ++ show (aLine) ++ \"\\x1b[0m\")\n        (\"InsertChar\":_) -&gt; putStrLn (\"Insert Char                 |              \" ++ show (insertChar aLine))\n        (\"DelCharRight\":_) -&gt; putStrLn (\"Delete Char Right           |              \" ++ show (delCharRight aLine))\n        (\"DelCharLeft\":_) -&gt; putStrLn (\"Delete Char Left            |              \" ++ show (delCharLeft aLine)) \n        (\"CharRight\":_) -&gt; putStrLn (\"Move Char Right             |              \" ++ show (charRight aLine))\n        (\"CharLeft\":_) -&gt; putStrLn (\"Move Char Left              |              \" ++ show (charLeft aLine))\n        (\"WordRight\":_) -&gt; putStrLn (\"Move Word Right             |              \" ++ show (wordRight aLine))\n        (\"WordLeft\":_) -&gt; putStrLn (\"Move Word Left              |              \" ++ show (wordLeft aLine))\n        (\"EndLineRight\":_) -&gt; putStrLn (\"End Line Right              |              \" ++ show (endLineRight aLine))\n        (\"EndLineLeft\":_) -&gt; putStrLn (\"End Line Left               |              \" ++ show (endLineLeft aLine))\n        (\"HighlightRight\":_) -&gt; putStrLn (\"Highlight Right             |              \" ++ show (highlightRight aLine))\n        (\"HighlightLeft\":_) -&gt; putStrLn (\"Highlight Left              |              \" ++ show (highlightLeft aLine))\n        (\"HighlightWordRight\":_) -&gt; putStrLn (\"Highlight Word Right        |              \" ++ show (highlightWordRight aLine))\n        (\"HighlightWordLeft\":_) -&gt; putStrLn (\"Highlight Word Left         |              \" ++ show (highlightWordLeft aLine))\n        (\"Copy\":_) -&gt; putStrLn (\"Copy                        |              \" ++ show (copy aLine))\n        (\"Cut\":_) -&gt; putStrLn (\"Cut                         |              \" ++ show (cut aLine))\n        (\"Paste\":_) -&gt; putStrLn (\"Paste                       |              \" ++ show (paste aLine))\n        (\"Destroy\":_) -&gt; putStrLn (\"Destroy                     |              \" ++ show (destroy aLine))\n        (\"ClearScreen\":_) -&gt; clearScreen\n        (\"Save\":_) -&gt; writeFile savePath (command ++ \"           |              \" ++ show (save aLine))\n        _ -&gt; putStrLn \"Error: Incorrect Command\"\n    return command\n</code></pre>\n\n<p>How would i add more code to the same line of command? I want something like this:</p>\n\n<pre><code>(\"DelCharRight\":_) -&gt; putStrLn (\"Delete Char Right           |              \" ++ show (delCharRight aLine) let bLine = delCharRight aLine let aLine = bLine\n</code></pre>\n\n<p>This basically allows me to overwrite a Line after each command so i can keep typing the commands to edit the line of text.</p>\n\n<p>Trouble is the case statement won't let me use 'Let'.</p>\n\n<p>I apologise for the terrible code and explanation!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1523978106, "post_id": 49881247, "comment_id": 86779400, "body": "This is  unclear. The code above is meaningless, and I can&#39;t understand the description of the task. I&#39;d suggest you start to write the <i>type</i> for your function. What is the input type? (Only one argument <code>x</code>? what about <code>y</code>?) What is the return type ? (<code>Bool</code> ?) Saying a &quot;simple true false Bool function&quot; does not tell much. Perhaps you want <code>isDiagonal x y = x==y</code> but it&#39;s hard to tell. Again: don&#39;t write anything until you have decided its type."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1523978905, "post_id": 49881247, "comment_id": 86779945, "body": "For what it&#39;s worth, I disagree with @chi: it&#39;s very clear to me what function you want to write. But the rest of the question sucks anyway: StackOverflow is neither a code-writing service nor a tutorial recommendation service (so I voted to close as &quot;too broad&quot;). Google can find you a tutorial; and a bit of pencil-and-paper work can help you cook up an algorithm. Once you have those things you&#39;ll be able to make an attempt at writing some code, and <i>then</i> if your code does not work the way you want it to you may have a more targeted, on-topic question for this site."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1523980022, "post_id": 49881247, "comment_id": 86780703, "body": "@DanielWagner I did not vote to close (even if I considered that), since I thought this could be a small task. Now, seeing the answer below, and rereading the question, I can finally see what it was about."}], "answers": [{"tags": [], "owner": {"reputation": 1341, "user_id": 1036044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PzcQL.jpg?s=128&g=1", "display_name": "Probie", "link": "https://stackoverflow.com/users/1036044/probie"}, "is_accepted": true, "score": 1, "last_activity_date": 1523978931, "creation_date": 1523978931, "answer_id": 49882096, "question_id": 49881247, "link": "https://stackoverflow.com/questions/49881247/haskell-check-if-chess-board-diagonal-movement-is-true-or-false/49882096#49882096", "title": "Haskell check if chess board diagonal movement is True or False", "body": "<p>If you want to check if a point <code>(x,y)</code>  is on the same diagonal as a point <code>(x',y')</code> in Haskell, a good place to start is with a type.</p>\n\n<pre><code>isDiagonal :: (Int, Int) -&gt; (Int, Int) -&gt; Bool\n</code></pre>\n\n<p>Whilst technically optional, it's good practice to give every top level function an explicit type.</p>\n\n<p>Now, we need a body for this function.</p>\n\n<pre><code>isDiagonal (x, y) (x', y') = ...\n</code></pre>\n\n<p>If they're on the same diagonal, then <code>x</code> and <code>x'</code> must be as far apart from each other as <code>y</code> and <code>y'</code> are. So we can just check if the differences are equal. i.e </p>\n\n<pre><code>abs (x - x') == abs (y - y')\n</code></pre>\n\n<p>Putting it all together, we (hopefully) arrive at the desired function</p>\n\n<pre><code>isDiagonal :: (Int, Int) -&gt; (Int, Int) -&gt; Bool\nisDiagonal (x, y) (x', y') = abs (x - x') == abs (y - y')\n</code></pre>\n\n<p>There's no need for <code>&amp;&amp;</code> here, at all. But we could use it, if for example we wanted to impose an extra condition, like the new points must be on the 4x5 board (assuming 1-indexing)</p>\n\n<pre><code>isDiagonal :: (Int, Int) -&gt; (Int, Int) -&gt; Bool\nisDiagonal (x, y) (x', y') = x' &gt;= 1 &amp;&amp; x' &lt;= 4 &amp;&amp; \n                             y' &gt;= 1 &amp;&amp; y' &lt;= 5 &amp;&amp;\n                             abs (x - x') == abs (y - y')\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9658775, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae5429f12434833b0a12aad552c3a264?s=128&d=identicon&r=PG&f=1", "display_name": "Demiss", "link": "https://stackoverflow.com/users/9658775/demiss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 302, "favorite_count": 0, "closed_date": 1523981607, "accepted_answer_id": 49882096, "answer_count": 1, "score": 0, "last_activity_date": 1523978931, "creation_date": 1523976557, "last_edit_date": 1523977957, "question_id": 49881247, "link": "https://stackoverflow.com/questions/49881247/haskell-check-if-chess-board-diagonal-movement-is-true-or-false", "closed_reason": "Needs details or clarity", "title": "Haskell check if chess board diagonal movement is True or False", "body": "<p>I am trying to write a board game function of 4x5 board and I want to do a simple true false Bool function stating if the movement based on x,y coordinates is diagonal or not. I want to put 4 coordinates 2 x and 2 y. should I use the &amp;&amp; function if for example I want to put (1,1) and (2,2)?</p>\n\n<pre><code> isDiagonal x  \n if x == 1 &amp;&amp; y == 1 then True\n else False\n isDiagonal x\n if x == 2 &amp;&amp; y == 2 then True \n else False\n</code></pre>\n"}, {"tags": ["haskell", "data-structures", "immutability", "key-value"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1523971026, "post_id": 49879057, "comment_id": 86773973, "body": "You can&#39;t, you construct a new map that contains the new key."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1523973506, "post_id": 49879207, "comment_id": 86775859, "body": "Indeed, in a balanced BST-based implementation, <code>insert</code> only needs to copy O(log N) nodes of the tree, and reuse much of the old (immutable) tree."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1523979225, "post_id": 49879207, "comment_id": 86780158, "body": "Compilers are <i>allowed</i> to modify a value in-place if it can determine that no references are held to the old value, but as far as I know none of them <i>does</i>. But not all is lost: <code>Map</code> is implemented as a tree, and unchanged subtrees can be (and are) shared between the old <code>Map</code> and the new one. This is permissible whether something else is using the input <code>Map</code> or not (because immutability guarantees that the sharing won&#39;t cause aliasing problems)."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 6, "last_activity_date": 1523971079, "creation_date": 1523971079, "answer_id": 49879207, "question_id": 49879057, "link": "https://stackoverflow.com/questions/49879057/haskell-immutable-data-structure-the-map-data-type/49879207#49879207", "title": "Haskell Immutable data structure - the Map data type", "body": "<p><code>insert</code> doesn't actually modify the input <code>Map</code>. It returns a <em>new</em> <code>Map</code> that contains the same entries as the original <code>Map</code>, plus the one you are inserting.</p>\n\n<p>Underneath the hood, the compiler may not actually have to copy all the old entries to a new <code>Map</code>, though; it can reuse the original if it determines that nothing else is using the input <code>Map</code>. Immutability is a property of the <em>language</em>, not necessarily the <em>implementation</em> of the language.</p>\n"}, {"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 0, "last_activity_date": 1524041884, "creation_date": 1524041884, "answer_id": 49895382, "question_id": 49879057, "link": "https://stackoverflow.com/questions/49879057/haskell-immutable-data-structure-the-map-data-type/49895382#49895382", "title": "Haskell Immutable data structure - the Map data type", "body": "<p>Perhaps an example will make this clearer.</p>\n\n<pre><code>Prelude&gt; let map1 = empty\nPrelude&gt; map1\nfromList []\n\nPrelude&gt; let map2 = insert \"Lemon\" 6 map1\nPrelude&gt; map2\nfromList [(\"Lemon\", 6)]\n\nPrelude&gt; map1\nfromList []\n\nPrelude&gt; let map3 = insert \"Lime\" 7 map2\nPrelude&gt; map3\nfromList [(\"Lime\", 7), (\"Lemon\", 6)]\n\nPrelude&gt; map2\nfromList [(\"Lemon\", 6)]\n\nPrelude&gt; map1\nfromList []\n</code></pre>\n\n<p>Each time we define a new variable (<code>map1</code>, <code>map2</code>, <code>map3</code>), the previous version of the <code>Map</code> remains completely unchanged. Once we have defined that (for example) <code>map1</code> contains the key <code>\"Lemon\"</code>, nothing can ever change that definition. We can create a new map that contains additional keys (or fewer keys, indeed), but we cannot change <code>map1</code> itself.</p>\n"}], "owner": {"reputation": 550, "user_id": 2665006, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/f5fc5207efb9ca551f6c5f3e4804beca?s=128&d=identicon&r=PG", "display_name": "phage", "link": "https://stackoverflow.com/users/2665006/phage"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 459, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1524041884, "creation_date": 1523970658, "last_edit_date": 1523971383, "question_id": 49879057, "link": "https://stackoverflow.com/questions/49879057/haskell-immutable-data-structure-the-map-data-type", "title": "Haskell Immutable data structure - the Map data type", "body": "<p>I am confused about the this data type in Haskell - Map.  In particular, there is a function call insert (from the Data.Map module) which allows you to append new values to the Map data structure.  So, here is my confusion.  If haskell data structure is <strong>immutable</strong>, how can you insert new data into an existing Map data structure?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1523964979, "post_id": 49877023, "comment_id": 86769518, "body": "<code>accum - accum + ...</code>?"}, {"owner": {"reputation": 87, "user_id": 6707205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a70e703a11beee76037c69d43ceca7f2?s=128&d=identicon&r=PG&f=1", "display_name": "hdizzle", "link": "https://stackoverflow.com/users/6707205/hdizzle"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523965350, "post_id": 49877023, "comment_id": 86769785, "body": "@WillemVanOnsem sorry, I don&#39;t quite get your comment (or question) I should be more clear, I am trying to get the last element of the list by using foldl"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 4, "creation_date": 1523965384, "post_id": 49877023, "comment_id": 86769804, "body": "@hdizzle <code>accum - accum</code> seems like a very awkward way of writing <code>0</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1523965401, "post_id": 49877023, "comment_id": 86769822, "body": "@hdizzle: why do you subtract a number from itself, and not just drop the <code>accum</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 6707205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a70e703a11beee76037c69d43ceca7f2?s=128&d=identicon&r=PG&f=1", "display_name": "hdizzle", "link": "https://stackoverflow.com/users/6707205/hdizzle"}, "edited": false, "score": 0, "creation_date": 1523965866, "post_id": 49877158, "comment_id": 86770163, "body": "Thanks! but then shouldn&#39;t final&#39; :: [a] -&gt; a work without the restriction if I take out the &quot;accum - accum&quot;? so basically --- foldl(\\accum x -&gt; x)?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 87, "user_id": 6707205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a70e703a11beee76037c69d43ceca7f2?s=128&d=identicon&r=PG&f=1", "display_name": "hdizzle", "link": "https://stackoverflow.com/users/6707205/hdizzle"}, "edited": false, "score": 0, "creation_date": 1523965959, "post_id": 49877158, "comment_id": 86770232, "body": "@hdizzle: no, since - as is written at the end of the answer - you still have <code>0</code> as initial accumulator. If the list turns out to be empty, then it will return the initial accumulator, so <code>0</code>, and <code>0</code> has a type that is an instance of <code>Num</code>."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1523965369, "creation_date": 1523965369, "answer_id": 49877158, "question_id": 49877023, "link": "https://stackoverflow.com/questions/49877023/no-instance-for-num-a-arising-from-a-use-of-haskell/49877158#49877158", "title": "No instance for (Num a) arising from a use of \u2018+\u2019 Haskell", "body": "<p>The problem has nothing to do with the function itself, but with the <em>signature</em> you attach to it yourself:</p>\n\n<pre><code>final' :: [a] -&gt; a\n</code></pre>\n\n<p>Here you basically say that your <code>final'</code> function will work for <em>any</em> <code>a</code>. So I could - if I wanted - add <code>String</code>s together, as well as <code>IO ()</code> instances, or anything else. But now Haskell inspects your function, and notices that you perform an addition <code>(+) :: Num a =&gt; a -&gt; a -&gt; a</code>, with as right operand <code>x</code>, which has type <code>a</code>. Like the signature for <code>(+)</code> already says, both operands should have the <em>same</em> type, and that type should be an instance of <code>Num</code>.</p>\n\n<p>You can solve the problem by making the signature more restrictive:</p>\n\n<pre><code>final' :: <b>Num a =&gt;</b> [a] -&gt; a\nfinal' lst = foldl(\\accum x -&gt; accum - accum + x) 0 lst</code></pre>\n\n<p>In fact we can also generalize a part of the signature, and let it work for any <code>Foldable</code>:</p>\n\n<pre><code>final' :: <b>(</b>Num a<b>, Foldable f)</b> =&gt; <b>f</b> a -&gt; a\nfinal' lst = foldl(\\accum x -&gt; accum - accum + x) 0 lst</code></pre>\n\n<p>We can however get rid of the <code>accum</code>, since subtracting a number from itself, will usually result in zero (except for rounding issues, etc.):</p>\n\n<pre><code>final' :: (Num a, Foldable f) =&gt; f a -&gt; a\nfinal' = foldl <b>(const id)</b> 0</code></pre>\n\n<p>Now we got rid of <code>(+)</code> (and <code>(-)</code>), but still need to use <code>Num</code>. The reason is that you use <code>0</code> as initial accumulator, and in case of an empty list, we thus will return <code>0</code>, and <code>0 :: Num n =&gt; n</code>.</p>\n"}], "owner": {"reputation": 87, "user_id": 6707205, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a70e703a11beee76037c69d43ceca7f2?s=128&d=identicon&r=PG&f=1", "display_name": "hdizzle", "link": "https://stackoverflow.com/users/6707205/hdizzle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1336, "favorite_count": 0, "accepted_answer_id": 49877158, "answer_count": 1, "score": 1, "last_activity_date": 1523965369, "creation_date": 1523964939, "last_edit_date": 1523964999, "question_id": 49877023, "link": "https://stackoverflow.com/questions/49877023/no-instance-for-num-a-arising-from-a-use-of-haskell", "title": "No instance for (Num a) arising from a use of \u2018+\u2019 Haskell", "body": "<p>I can't figure out why this won't work:</p>\n\n<pre><code>final' :: [a] -&gt; a\nfinal' lst = foldl(\\accum x -&gt; accum - accum + x) 0 lst\n</code></pre>\n\n<p>I always get the error No instance for (Num a) arising from a use of \u2018+\u2019</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1523963234, "post_id": 49876407, "comment_id": 86768345, "body": "This seems to be strictly related, if not a duplicate, to <a href=\"https://stackoverflow.com/questions/49433716/why-cant-we-define-closed-data-families\" title=\"why cant we define closed data families\">stackoverflow.com/questions/49433716/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 798, "user_id": 9223023, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RTmMa.png?s=128&g=1", "display_name": "Petras Purlys", "link": "https://stackoverflow.com/users/9223023/petras-purlys"}, "edited": false, "score": 0, "creation_date": 1523968920, "post_id": 49876490, "comment_id": 86772437, "body": "Thanks, just a small remark: Foo Int = IntFoo should be Foo&#39; Int = IntFoo. Same with bar. SO does not allow me to fix this as it&#39;s less than 6 symbols.. :)"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 6, "last_activity_date": 1523970060, "last_edit_date": 1523970060, "creation_date": 1523963269, "answer_id": 49876490, "question_id": 49876407, "link": "https://stackoverflow.com/questions/49876407/polymorphic-data-families-in-haskell/49876490#49876490", "title": "Polymorphic Data Families in Haskell", "body": "<p>Use a closed type family. <a href=\"https://stackoverflow.com/a/49436255/745903\">Unfortunately</a>, this requires an extra newtype wrapper:</p>\n\n<pre><code>newtype Foo a = CreateFoo {getFoo :: Foo' a}\n\ntype family Foo' a where\n  Foo' Int = IntFoo\n  Foo' bar = Barbar bar\n\ndata IntFoo = CreateInt Int Int String\ndata Barbar bar = CreateBar bar\n</code></pre>\n"}], "owner": {"reputation": 798, "user_id": 9223023, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/RTmMa.png?s=128&g=1", "display_name": "Petras Purlys", "link": "https://stackoverflow.com/users/9223023/petras-purlys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 49876490, "answer_count": 1, "score": 2, "last_activity_date": 1523970060, "creation_date": 1523962992, "question_id": 49876407, "link": "https://stackoverflow.com/questions/49876407/polymorphic-data-families-in-haskell", "title": "Polymorphic Data Families in Haskell", "body": "<p>I would like to define a data family that supports polymorphism for explicitly uninstantiated cases:</p>\n\n<pre><code>data family Foo a\n\n-- handles some specific case\ndata instance Foo Int = CreateInt Int Int String\n\n-- handles all other cases\ndata instance Foo bar = CreateBar bar\n</code></pre>\n\n<p>Is this possible?</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1523956067, "post_id": 49873976, "comment_id": 86763251, "body": "Well <code>do</code> notation is actually syntactical sugar for the notation with bind (<code>&gt;&gt;=</code>), etc. So as some sort of first step, Haskell rewrites your <code>do</code> notation to something like the previous sample (although here you actually used a <code>return</code> too much)."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1523956590, "post_id": 49873976, "comment_id": 86763634, "body": "The desugaring is specified in Chapter 14 of &quot;<i>Real World Haskell</i>&quot;: <a href=\"http://book.realworldhaskell.org/read/monads.html#monads.do\" rel=\"nofollow noreferrer\">book.realworldhaskell.org/read/monads.html#monads.do</a>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1523977805, "post_id": 49873976, "comment_id": 86779186, "body": "The <a href=\"https://www.haskell.org/onlinereport/haskell2010/\" rel=\"nofollow noreferrer\">Haskell Report</a> also does a good job of explaining just how <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-470003.14\" rel=\"nofollow noreferrer\"><code>do</code> expressions</a> desugar."}], "answers": [{"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 3, "last_activity_date": 1523958088, "creation_date": 1523958088, "answer_id": 49874757, "question_id": 49873976, "link": "https://stackoverflow.com/questions/49873976/how-to-pass-from-a-do-notation-to-a-operator-notation/49874757#49874757", "title": "How to pass from a do notation to a (&gt;&gt;=) operator notation?", "body": "<p>Q1: Every line of a do-block must be \"in\" <em>the same</em> monad. (That's why <code>maybeRequest</code> doesn't work; you can't mix the <code>Maybe</code> monad with the <code>IO</code> monad.)</p>\n\n<p>Q2: Close, but not quite.</p>\n\n<p><code>ioRequest</code> is an I/O action, so you need to use <code>&gt;&gt;=</code> to fetch the request out of it:</p>\n\n<pre><code>test = ioRequest &gt;&gt;= httpBS &gt;&gt;= B8.putStrLn . getResponseBody\n</code></pre>\n\n<hr>\n\n<p>While I'm here, I'll also point out that</p>\n\n<pre><code>request &lt;- return \"http://example.com/\"\n</code></pre>\n\n<p>is exactly equivalent to</p>\n\n<pre><code>let request = \"http://example.com/\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": true, "score": 5, "last_activity_date": 1523973146, "last_edit_date": 1523973146, "creation_date": 1523964305, "answer_id": 49876814, "question_id": 49873976, "link": "https://stackoverflow.com/questions/49873976/how-to-pass-from-a-do-notation-to-a-operator-notation/49876814#49876814", "title": "How to pass from a do notation to a (&gt;&gt;=) operator notation?", "body": "<blockquote>\n  <p>I cannot figure out what is the type of <code>return \"http://example.com\"</code></p>\n</blockquote>\n\n<p>Fortunately, GHCi can:</p>\n\n<pre><code>&gt; :t return \"http://example.com\"\nreturn \"http://example.com\" :: Monad m =&gt; m [Char]\n</code></pre>\n\n<p>So it's a valid monad action for any monad that returns a String.</p>\n\n<p>Since <code>return</code> is part of the Monad type class definition, this should not be a surprise.</p>\n\n<blockquote>\n  <p>Q1 : How the compiler manage to find which Monad I want to use ?</p>\n</blockquote>\n\n<p>It uses type inference. Being inside a do-block constrains this to a monad by default and so does <code>return \"...\"</code>. (<a href=\"https://ocharles.org.uk/blog/guest-posts/2014-12-06-rebindable-syntax.html\" rel=\"nofollow noreferrer\"><code>RebindableSyntax</code></a> lets you overload the implicit <code>(&gt;&gt;=)</code> of do-blocks to any operator, but that's not something you see often.)</p>\n\n<p>The action <code>httpBS :: MonadIO m =&gt; Request -&gt; m (Response ByteString)</code> further constrains this to something called <a href=\"https://hackage.haskell.org/package/transformers-0.3.0.0/docs/Control-Monad-IO-Class.html\" rel=\"nofollow noreferrer\"><code>MonadIO m</code></a>, which is apparently a special kind of Monad that has <code>liftIO :: Monad m =&gt; IO a -&gt; m a</code>. The simplest example of a <code>MonadIO m</code> is <code>IO</code>, but the compiler hasn't concretized this yet.</p>\n\n<p>Finally, <a href=\"https://hackage.haskell.org/package/bytestring-0.10.8.2/docs/Data-ByteString-Char8.html#v:putStrLn\" rel=\"nofollow noreferrer\"><code>B8.putStrLn :: ByteString -&gt; IO ()</code></a> constrains <code>test :: IO ()</code>.</p>\n\n<blockquote>\n  <p>Q2 : how to use the Request and httpBS with the (>>=) operator if the Request is to be build previously ? <strong>How to have it working with a one-liner and  the >>= notation ?</strong></p>\n</blockquote>\n\n<p>Both do-blocks and point-free one-liners can be convenient and slightly magical. You can bridge these two notations by de-sugaring a do-block and then perform <a href=\"https://wiki.haskell.org/Eta_conversion\" rel=\"nofollow noreferrer\">\u03b7-reduction</a>. A good read for understanding do-notation is still Philip Wadler's <a href=\"http://homepages.inf.ed.ac.uk/wadler/papers/marktoberdorf/baastad.pdf\" rel=\"nofollow noreferrer\">Monads for functional programming</a>.</p>\n\n<p>The following:</p>\n\n<pre><code>test = do\n  request &lt;- ioRequest\n  response &lt;- httpBS request\n  B8.putStrLn (getResponseBody response)\n</code></pre>\n\n<p>de-sugars into:</p>\n\n<pre><code>test =\n  ioRequest &gt;&gt;= \\request -&gt;\n  httpBS request &gt;&gt;= \\response -&gt;\n  B8.putStrLn (getResponseBody response)\n</code></pre>\n\n<p>But <code>B8.putStrLn (getResponseBody response)</code><br>\nis <code>(B8.putStrLn . getResponseBody) response</code>.</p>\n\n<p><em>(The point of this transformation is to have both lambdas expressed as <a href=\"https://wiki.haskell.org/Eta_conversion\" rel=\"nofollow noreferrer\"><code>\\x -&gt; f x</code></a>.)</em></p>\n\n<p>So this becomes:</p>\n\n<pre><code>test =\n  (ioRequest &gt;&gt;= \\request -&gt; httpBS request)\n    &gt;&gt;= \\response -&gt; (B8.putStrLn . getResponseBody) response\n</code></pre>\n\n<ul>\n<li><p>But <code>\\request -&gt; httpBS request</code> is just <code>httpBS</code>.</p></li>\n<li><p>And <code>\\response -&gt; (B8.putStrLn . getResponseBody) response</code><br>\nis just <code>B8.putStrLn . getResponseBody</code>.</p></li>\n</ul>\n\n<p>So this becomes:</p>\n\n<pre><code>test =\n  (ioRequest &gt;&gt;= httpBS)\n    &gt;&gt;= B8.putStrLn . getResponseBody\n</code></pre>\n\n<p>Reformatting this to fit one line:</p>\n\n<pre><code>test = ioRequest &gt;&gt;= httpBS &gt;&gt;= B8.putStrLn . getResponseBody\n</code></pre>\n"}], "owner": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 49876814, "answer_count": 2, "score": 1, "last_activity_date": 1523973146, "creation_date": 1523955857, "last_edit_date": 1523972766, "question_id": 49873976, "link": "https://stackoverflow.com/questions/49873976/how-to-pass-from-a-do-notation-to-a-operator-notation", "title": "How to pass from a do notation to a (&gt;&gt;=) operator notation?", "body": "<p>I can not really understand why such line of code actually work : </p>\n\n<p>From  <a href=\"https://hackage.haskell.org/package/http-conduit-2.3.1/docs/Network-HTTP-Simple.html\" rel=\"nofollow noreferrer\">Network.HTTP.Simple</a></p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nimport Network.HTTP.Simple\nimport qualified Data.ByteString.Char8 as B8\n\nmain :: IO ()\nmain = httpBS \"http://example.com\" &gt;&gt;= B8.putStrLn . getResponseBody\n</code></pre>\n\n<p>I am able to rewrite the stuff with do notation : </p>\n\n<pre><code>test = do\n          request &lt;- return \"http://example.com\"\n          result &lt;- httpBS request\n          let body = getResponseBody result\n          B8.putStrLn body\n</code></pre>\n\n<p>This works, even If I cannot figure out what is the type of <code>return \"http://example.com\"</code>. </p>\n\n<p>Q1 : How the compiler manage to find which Monad I want to use ?</p>\n\n<p>My guess is : it is coming up from the fact that return of the do block is an IO() and so it would be an IO (Request) ? </p>\n\n<p>Now, When trying to use httpBS in more complex code, I have some difficulties</p>\n\n<p>test.hs file  :</p>\n\n<pre><code>{-# LANGUAGE DuplicateRecordFields #-}\n{-# LANGUAGE OverloadedStrings #-}\n\nimport Network.HTTP.Simple\nimport qualified Data.ByteString.Char8 as B8\n\n\nrequest = parseRequest \"http://example.com\" \n</code></pre>\n\n<p>this gives the error : </p>\n\n<pre><code>Prelude&gt; :load test.hs\n[1 of 1] Compiling Main             ( test.hs, interpreted )\n\ntest.hs:8:11: error:\n    * Ambiguous type variable `m0' arising from a use of `parseRequest'\n      prevents the constraint `(Control.Monad.Catch.MonadThrow\n                                  m0)' from being solved.\n      Relevant bindings include\n        request :: m0 Request (bound at test.hs:8:1)\n      Probable fix: use a type annotation to specify what `m0' should be.\n      These potential instances exist:\n        instance e ~ GHC.Exception.SomeException =&gt;\n                 Control.Monad.Catch.MonadThrow (Either e)\n          -- Defined in `Control.Monad.Catch'\n        instance Control.Monad.Catch.MonadThrow IO\n          -- Defined in `Control.Monad.Catch'\n        instance Control.Monad.Catch.MonadThrow Maybe\n          -- Defined in `Control.Monad.Catch'\n        ...plus one other\n        ...plus 15 instances involving out-of-scope types\n        (use -fprint-potential-instances to see them all)\n    * In the expression: parseRequest \"http://example.com\"\n      In an equation for `request':\n          request = parseRequest \"http://example.com\"\n  |\n8 | request = parseRequest \"http://example.com\"\n  |           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nFailed, no modules loaded. \n</code></pre>\n\n<p>Ok. Entering same stuff in the interpreter works  : </p>\n\n<pre><code>*Main Network.HTTP.Simple&gt; import Network.HTTP.Simple\n*Main Network.HTTP.Simple&gt; req = parseRequest \"http://example.com\"\n*Main Network.HTTP.Simple&gt; :t req\nreq :: Control.Monad.Catch.MonadThrow m =&gt; m Request\n*Main Network.HTTP.Simple&gt; req\nRequest {\n  host                 = \"example.com\"\n  port                 = 80\n  secure               = False\n  requestHeaders       = []\n  path                 = \"/\"\n  queryString          = \"\"\n  method               = \"GET\"\n  proxy                = Nothing\n  rawBody              = False\n  redirectCount        = 10\n  responseTimeout      = ResponseTimeoutDefault\n  requestVersion       = HTTP/1.1\n}\n</code></pre>\n\n<p>It looks like the dreaded monomorphic restriction stuff that I already stumble accross  <a href=\"https://stackoverflow.com/questions/49693687/why-is-ghci-accepting-something-at-the-prompt-that-wont-compile\">c.f this question</a></p>\n\n<p>So I understand I have to give the type.It's ok but then I can not figure out how to use it with the >>= notation , I can only manage to have it working with the do notation :</p>\n\n<pre><code>-# LANGUAGE DuplicateRecordFields #-}\n{-# LANGUAGE OverloadedStrings #-}\n\nimport Network.HTTP.Simple\nimport qualified Data.ByteString.Char8 as B8\n\nurl  = \"http://example.com\"\nmaybeRequest :: Maybe Request\nmaybeRequest = parseRequest url \n\nioRequest :: IO Request\nioRequest = parseRequest url\n\n--no. wrong type ioRequest.\n--testKO = httpBS ioRequest &gt;&gt;= B8.putStrLn . getResponseBody\n\n--How to have it working with a one-liner and  the &gt;&gt;= notation ? \n\n--do notation ok\ntest = do \n        request &lt;- ioRequest\n        response &lt;- httpBS request\n        let body = getResponseBody response\n        B8.putStrLn body\n</code></pre>\n\n<p>Q2 : how to use the Request and httpBS  with the (>>=) operator  if the Request is to be build previously ? </p>\n"}, {"tags": ["variables", "haskell", "immutability", "mutable"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1523955202, "post_id": 49873735, "comment_id": 86762653, "body": "No you are not: you introduce a new variable with the same name in a tighter scope. That is something different, since you can (well not really in ghci directly, since here you basically construct a monad online), construct a monad that escapes this scope, and then it will take the outher variable back as value."}, {"owner": {"reputation": 181, "user_id": 6613732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fZHDf.png?s=128&g=1", "display_name": "saketh", "link": "https://stackoverflow.com/users/6613732/saketh"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523955323, "post_id": 49873735, "comment_id": 86762739, "body": "ok thank you Willem Van Onsem"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1523978097, "post_id": 49873735, "comment_id": 86779391, "body": "Please don&#39;t post text, such as console output, as images  -- just copy and paste the text directly. It is easier for everyone."}], "answers": [{"comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1523955465, "post_id": 49873811, "comment_id": 86762839, "body": "Although that is strictly speaking correct, I think you should extend this answer, and give a more rigorous explanation what is happening here."}], "tags": [], "owner": {"reputation": 1096, "user_id": 5021447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-gwPYP717ZyU/AAAAAAAAAAI/AAAAAAAAAP8/WoyhftM4PuU/photo.jpg?sz=128", "display_name": "Jordan Mackie", "link": "https://stackoverflow.com/users/5021447/jordan-mackie"}, "is_accepted": false, "score": 2, "last_activity_date": 1523955397, "creation_date": 1523955397, "answer_id": 49873811, "question_id": 49873735, "link": "https://stackoverflow.com/questions/49873735/i-heard-that-haskell-variables-are-immutable-but-i-am-able-to-reassign-and-updat/49873811#49873811", "title": "I heard that Haskell variables are immutable but i am able to reassign and update variable values", "body": "<p>You're shadowing, not mutating.</p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 9, "last_activity_date": 1523957104, "last_edit_date": 1523957104, "creation_date": 1523956635, "answer_id": 49874238, "question_id": 49873735, "link": "https://stackoverflow.com/questions/49873735/i-heard-that-haskell-variables-are-immutable-but-i-am-able-to-reassign-and-updat/49874238#49874238", "title": "I heard that Haskell variables are immutable but i am able to reassign and update variable values", "body": "<p>First, note that GHCi syntax is not quite the same as Haskell source-file syntax. In particular, <code>x = 3</code> actually used to be illegal as such:</p>\n\n<pre><code>GHCi, version 7.10.2: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; x = 3\n\n&lt;interactive&gt;:2:3: parse error on input \u2018=\u2019\n</code></pre>\n\n<p>Newer versions have made this possible by simply rewriting any such expression to <code>let x = 3</code>, which has always been ok:</p>\n\n<pre><code>GHCi, version 7.10.2: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; let x = 3\nPrelude&gt; x\n3\n</code></pre>\n\n<p>By contrast, in a Haskell source file, <code>let x = 3</code> has never been legal by itself. This only works in a particular environment, namely a <em>monadic <code>do</code> block</em>.</p>\n\n<pre><code>main :: IO ()\nmain = do\n   let x = 3\n   print x\n</code></pre>\n\n<pre>3</pre>\n\n<p>And the GHCi prompt by design actually works like the lines in a <code>do</code> block, so let's in the following discuss that. Note that I can also write</p>\n\n<pre><code>main = do\n   let x = 1\n   let x = 3\n   print x\n</code></pre>\n\n<pre>3</pre>\n\n<p>And that's basically what's also going on in your GHCi session. However, as the others have remarked, this is <em>not</em> mutation but <em>shadowing</em>. To understand how this works, note that the above is essentially a shorthand way of writing</p>\n\n<pre><code>main =\n   let x = 1\n   in let x = 3\n      in print x\n</code></pre>\n\n<p>So, you have <em>two nested scopes</em>. When you look up a variable in some expression, Haskell always picks the \u201cnearest one\u201d, i.e. in the inner scope:</p>\n\n<pre><code>main =\n   let x = 1\n     \u250c\u2500\u2500\n   in\u2502let x = 3\n     \u2502in print x\n     \u2514\u2500\n</code></pre>\n\n<p>The outer <code>x</code> isn't touched at all, it's basically unrelated to anything going on in the inner scope. The compiler will actually warn you about this, if asked if there's anything fishy in your file:</p>\n\n<pre><code>$ ghc -Wall wtmpf-file16485.hs \n[1 of 1] Compiling Main             ( wtmpf-file16485.hs, wtmpf-file16485.o )\n\nwtmpf-file16485.hs:3:8: warning: [-Wunused-local-binds]\n    <b>Defined but not used: \u2018x\u2019</b>\n  |\n3 |    let x = 1\n  |        ^\n\nwtmpf-file16485.hs:3:12: warning: [-Wtype-defaults]\n    \u2022 Defaulting the following constraint to type \u2018Integer\u2019\n        Num p0 arising from the literal \u20183\u2019\n    \u2022 In the expression: 3\n      In an equation for \u2018x\u2019: x = 3\n      In the expression:\n        do let x = 1\n           let x = 3\n           print x\n  |\n3 |    let x = 1\n  |            ^\n\nwtmpf-file16485.hs:4:8: warning: [-Wname-shadowing]\n    <b>This binding for \u2018x\u2019 shadows the existing binding</b>\n      bound at wtmpf-file16485.hs:3:8\n  |\n4 |    let x = 3\n  |        ^\n\n</code></pre>\n\n<p>There: the second definition simply introduces a <em>new</em>, more local variable which also happens to be called <code>x</code>, but is unrelated to the outer variable. I.e. we might as well rename them:</p>\n\n<pre><code>main = do\n   let xOuter = 1\n   let xInner = 3\n   print xInner\n</code></pre>\n\n<p>A consequence of all this is that a variable that's \u201cmutated\u201d in this way has no influence on other functions which use the original variable. Example:</p>\n\n<pre><code>GHCi, version 8.2.1: http://www.haskell.org/ghc/  :? for help\nLoaded GHCi configuration from /home/sagemuej/.ghci\nLoaded GHCi configuration from /home/sagemuej/.ghc/ghci.conf\nPrelude&gt; let x = 1\nPrelude&gt; let info = putStrLn (\"x is =\"++show x++\" right now\")\nPrelude&gt; x = 3\nPrelude&gt; info\nx is =1 right now\n</code></pre>\n\n<p>Another consequence is that \u201cupdates\u201d which try to use the old value behave in a funny way:</p>\n\n<pre><code>Prelude&gt; let s = \"World\"\nPrelude&gt; s = \"Hello\"++s\nPrelude&gt; s\n\"HelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHelloHell^C\n</code></pre>\n\n<p>Here, the new binding does <em>not</em> just prepend <code>\"Hello\"</code> to the old <code>s=\"World\"</code>. Instead, it prepends <code>\"Hello\"</code> to <em>its own result value</em>, which is in turn defined by <code>\"Hello\"</code> prepended to... and so on, recursively.</p>\n"}], "owner": {"reputation": 181, "user_id": 6613732, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fZHDf.png?s=128&g=1", "display_name": "saketh", "link": "https://stackoverflow.com/users/6613732/saketh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 232, "favorite_count": 0, "closed_date": 1523980412, "accepted_answer_id": 49874238, "answer_count": 2, "score": -2, "last_activity_date": 1523957104, "creation_date": 1523955169, "last_edit_date": 1523955303, "question_id": 49873735, "link": "https://stackoverflow.com/questions/49873735/i-heard-that-haskell-variables-are-immutable-but-i-am-able-to-reassign-and-updat", "closed_reason": "Duplicate", "title": "I heard that Haskell variables are immutable but i am able to reassign and update variable values", "body": "<p>I heard that Haskell variables are immutable but i am able to reassign and update variable values</p>\n\n<p><img src=\"https://i.stack.imgur.com/7OUi5.png\" alt=\"Reassigning variables\"></p>\n"}, {"tags": ["haskell", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 5276, "user_id": 1060159, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d7890a5cb5605356754da0bc842a4426?s=128&d=identicon&r=PG", "display_name": "marmistrz", "link": "https://stackoverflow.com/users/1060159/marmistrz"}, "edited": false, "score": 0, "creation_date": 1523990782, "post_id": 49872657, "comment_id": 86786796, "body": "Does my application benefit from the threading runtime if I don&#39;t do explicit multithreading (e.g. maybe it gets some parallelism in GC) and I do a console application. What are the rtsopts? The answer completely omits the rtstopts options. (maybe I was not clear enough that I don&#39;t understand those either, updated the OP to be more clear about it)"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 6, "last_activity_date": 1523951647, "creation_date": 1523951647, "answer_id": 49872657, "question_id": 49871957, "link": "https://stackoverflow.com/questions/49871957/what-are-the-default-build-option-of-stacks-package-yaml-needed-for/49872657#49872657", "title": "What are the default build option of Stack&#39;s package.yaml needed for?", "body": "<p>It refers to the runtime of the resulting executable. These options allow the final program to run multithreaded, i.e. to exploit parallel or concurrent execution on a multicore machine. This is mostly benefitial for performance, and particularly for responsiveness of interactive applications (some are virtually or literally unusable when not run with the threaded runtime).</p>\n\n<p>The runtime is always only linked to an executable; you may think of it as similar to the Java virtual machine that executes a bytecode program, except the Haskell runtime is much more stripped down and doesn't need to do actually do much code interpreting, it mostly just handles the memory requirements and assigns Haskell threads to OS threads.</p>\n\n<p>It is thus <em>not</em> linked to libraries, except at the very end when you use the library in an executable. That's why the option doesn't appear in the <code>library</code> section. (Although, it <em>would</em> actually be quite handy if libraries had a way to indicate \u201cwhen you use this in an exectuable, it should be linked with the threaded runtime\u201d, but this would have ramifications and I don't think there is anything that allows something like this.)</p>\n"}], "owner": {"reputation": 5276, "user_id": 1060159, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d7890a5cb5605356754da0bc842a4426?s=128&d=identicon&r=PG", "display_name": "marmistrz", "link": "https://stackoverflow.com/users/1060159/marmistrz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1523990808, "creation_date": 1523949121, "last_edit_date": 1523990808, "question_id": 49871957, "link": "https://stackoverflow.com/questions/49871957/what-are-the-default-build-option-of-stacks-package-yaml-needed-for", "title": "What are the default build option of Stack&#39;s package.yaml needed for?", "body": "<p>When creating a new Stack project, the executable gets the following <code>ghc-options</code></p>\n\n<pre><code>- -threaded\n- -rtsopts\n- -with-rtsopts=-N\n</code></pre>\n\n<p>Looking at the <code>man ghc</code>, I found the following:</p>\n\n<pre><code>   -threaded\n          Use the threaded runtime\n   -rtsopts[=\u27e8none|some|all\u27e9]\n          Control whether the RTS behaviour can be tweaked via command-lineflags and the GHCRTS environment variable. Using none means no RTS\n          flags  can  be  given;  some means only a minimum of safe options can be given (the default), and all (or no argument at all) means\n          that all RTS flags are permitted.\n\n   -with-rtsopts=\u27e8opts\u27e9\n          Set the default RTS options to \u27e8opts\u27e9.\n</code></pre>\n\n<p>This hardly tells me anything. Does the threaded runtime refer to the runtime of the compiler or a runtime of the resulting executable? What are these rtsopts for? Are these options somehow beneficial? If yes, why are they not the default? Why does the executable get them and the library code not:</p>\n\n<pre><code>library:\n  source-dirs: src\n  # notice no ghc-options field here!\n</code></pre>\n"}, {"tags": ["haskell", "recursion", "probability", "category-theory", "recursion-schemes"], "answers": [{"tags": [], "owner": {"reputation": 829, "user_id": 640078, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/01e5b91ad42c7d309b09d6ae8991a32c?s=128&d=identicon&r=PG", "display_name": "rprospero", "link": "https://stackoverflow.com/users/640078/rprospero"}, "is_accepted": true, "score": 4, "last_activity_date": 1523967773, "last_edit_date": 1523967773, "creation_date": 1523965964, "answer_id": 49877385, "question_id": 49869899, "link": "https://stackoverflow.com/questions/49869899/how-can-i-use-a-recursion-scheme-to-express-this-probability-distribution-in-has/49877385#49877385", "title": "How can I use a recursion scheme to express this probability distribution in Haskell", "body": "<p>I'm not smart enough to thread monads through the recursion schemes, so I relied on recursion-schemes-ext, which has the anaM function for running anamorphisms with monadic actions attached.</p>\n\n<p>I did a (really ugly) proof of concept here:</p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts #-}\nimport Data.Functor.Foldable (ListF(..), Base, Corecursive)\nimport Data.Functor.Foldable.Exotic (anaM)\nimport System.Random\n\ns :: String -&gt; IO (Maybe Char)\ns st = do\n  continue &lt;- getStdRandom $ randomR (0, 2000 :: Int)\n  if continue /= 0\n    then do\n    getStdRandom (randomR (0, length st - 1)) &gt;&gt;= return . Just . (st !!)\n    else return Nothing\n\n\nresult :: (Corecursive t, Traversable (Base t), Monad m) =&gt; (String -&gt; m (Base t String)) -&gt; String -&gt; m t\nresult f = anaM f\n\nexample :: String -&gt; IO (Base String String)\nexample st = maybe Nil (\\c -&gt; Cons c $ c:st) &lt;$&gt; s st\n\nfinal :: IO String\nfinal = result example \"asdf\"\n\nmain = final &gt;&gt;= print\n</code></pre>\n\n<p>A couple of notes</p>\n\n<ol>\n<li>I mocked out your <code>s</code> function, since I'm not familiar with <code>monad-bayes</code></li>\n<li>Since our final list is inside a monad, we have to construct it strictly.  This forces us to make a finite list (I allowed my <code>s</code> function to randomly stop at around 2000 characters).</li>\n</ol>\n\n<p>EDIT:</p>\n\n<p>Below is a modified version that confirms that other recursive structures (in this case, a binary tree) can be spawned by the result function.  Note the type of <code>final</code> and the value of <code>example</code> are the only two bits of the previous code that have changed.</p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts, TypeFamilies #-}\nimport Data.Functor.Foldable (ListF(..), Base, Corecursive(..))\nimport Data.Functor.Foldable.Exotic (anaM)\nimport Data.Monoid\nimport System.Random\n\ndata Tree a = Branch a (Tree a) (Tree a) | Leaf\n  deriving (Show, Eq)\ndata TreeF a b = BranchF a b b | LeafF\n\ntype instance Base (Tree a) = TreeF a\ninstance Functor Tree where\n  fmap f (Branch a left right) = Branch (f a) (f &lt;$&gt; left) (f &lt;$&gt; right)\n  fmap f Leaf = Leaf\ninstance Functor (TreeF a) where\n  fmap f (BranchF a left right) = BranchF a (f left) (f right)\n  fmap f LeafF = LeafF\ninstance Corecursive (Tree a) where\n  embed LeafF = Leaf\n  embed (BranchF a left right) = Branch a left right\ninstance Foldable (TreeF a) where\n  foldMap f LeafF = mempty\n  foldMap f (BranchF a left right) = (f left) &lt;&gt; (f right)\ninstance Traversable (TreeF a) where\n  traverse f LeafF = pure LeafF\n  traverse f (BranchF a left right) = BranchF a &lt;$&gt; f left &lt;*&gt; f right\n\ns :: String -&gt; IO (Maybe Char)\ns st = do\n  continue &lt;- getStdRandom $ randomR (0, 1 :: Int)\n  if continue /= 0\n    then getStdRandom (randomR (0, length st - 1)) &gt;&gt;= return . Just . (st !!)\n    else return Nothing\n\n\nresult :: (Corecursive t, Traversable (Base t), Monad m) =&gt; (String -&gt; m (Base t String)) -&gt; String -&gt; m t\nresult f = anaM f\n\nexample :: String -&gt; IO (Base (Tree Char) String)\nexample st = maybe LeafF (\\c -&gt; BranchF c (c:st) (c:st)) &lt;$&gt; s st\n\nfinal :: IO (Tree Char)\nfinal = result example \"asdf\"\n\nmain = final &gt;&gt;= print\n</code></pre>\n"}], "owner": {"reputation": 569, "user_id": 4430994, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d692c01775d04391f9377575d05f2e9f?s=128&d=identicon&r=PG&f=1", "display_name": "Reuben", "link": "https://stackoverflow.com/users/4430994/reuben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 1, "accepted_answer_id": 49877385, "answer_count": 1, "score": 6, "last_activity_date": 1523967773, "creation_date": 1523938968, "last_edit_date": 1523950060, "question_id": 49869899, "link": "https://stackoverflow.com/questions/49869899/how-can-i-use-a-recursion-scheme-to-express-this-probability-distribution-in-has", "title": "How can I use a recursion scheme to express this probability distribution in Haskell", "body": "<p>This question is part theory / part implementation. Background assumption: I'm using the <a href=\"https://github.com/adscib/monad-bayes\" rel=\"nofollow noreferrer\">monad-bayes</a> library to represent probability distributions as monads. A distribution p(a|b) can be represented as a function <code>MonadDist m =&gt; b -&gt; m a</code>.</p>\n\n<p>Suppose I have a conditional probability distribution <code>s :: MonadDist m =&gt; [Char] -&gt; m Char</code>. I want to get a new probability distribution <code>sUnrolled :: [Char] -&gt; m [Char]</code>, defined mathematically (I think) as:</p>\n\n<pre><code>sUnrolled(chars|st) = \n              | len(chars)==1 -&gt; s st\n              | otherwise -&gt; s(chars[-1]|st++chars[:-1]) * sUnrolled(chars[:-1]|st)\n</code></pre>\n\n<p>Intuitively it's the distribution you get by taking <code>st :: [Char]</code>, sampling a new char <code>c</code> from <code>s st</code>, feeding <code>st++[c]</code> back into <code>s</code>, and so on. I believe <code>iterateM s</code> is more or less what I want. To make it a distribution we could actually look at, let's say that if we hit a certain character, we stop. Then <code>iterateMaybeM</code> works.</p>\n\n<p>Theory Question: For various reasons, it would be really useful if I could express this distribution in more general terms, for instance in a way that generalized to the stochastic construction of a tree given a stochastic coalgebra. It looks like I have some sort of anamorphism here (I realize that the mathematical definition looks like a catamorphism, but in code I want to build up strings, not deconstruct them into probabilities) but I can't quite work out the details, not least because of the presence of the probability monad.</p>\n\n<p>Practical Question: it would also be useful to implement this in Haskell in a way that used the recursion schemes library, for instance.</p>\n"}, {"tags": ["string", "parsing", "haskell"], "comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1523943799, "post_id": 49869451, "comment_id": 86756532, "body": "What&#39;s your input string? I&#39;d like to take a look at this but though you give your expected output (<code>[&quot;F12&quot;, &quot;F12&quot;, &quot;F1(a)&quot;, &quot;F2a&quot;, &quot;F5-A&quot;, &quot;F34-5&quot;]</code>) but not the input"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1523944162, "post_id": 49869451, "comment_id": 86756671, "body": "@AdamSmith apparently the problem statement itself is the input: &quot;I want to choose <b>F12</b> or <b>F 12</b> from <b>F1(a)</b>\u2026&quot;"}, {"owner": {"reputation": 1270, "user_id": 2383766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc13aeb9c9f89e097f48d815b81541d5?s=128&d=identicon&r=PG", "display_name": "Z-Y.L", "link": "https://stackoverflow.com/users/2383766/z-y-l"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1523945486, "post_id": 49869451, "comment_id": 86757233, "body": "@AdamSmith As Zeta said, the problem description is the input."}, {"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 0, "creation_date": 1524019242, "post_id": 49869451, "comment_id": 86796395, "body": "With <code>[m| m&lt;- subsequences &quot;F1(a)F2aF5-AF34-5&quot;, elem m [&quot;F12&quot;,&quot;F 12&quot;]]</code> I got one [&quot;F12&quot;] and that is probably right. <code>subsequence</code> sequences by character so meaningless characters can be removes. I took out only space and comma."}], "answers": [{"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 2, "creation_date": 1523946665, "post_id": 49871217, "comment_id": 86757746, "body": "This doesn\u2019t address the main question of how to extract all of these from the input. You could do that with something like <code>catMaybes &lt;$&gt; many (try (Just &lt;$&gt; parseF) &lt;|&gt; (Nothing &lt;$ anyChar))</code> (untested)"}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "reply_to_user": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1523947806, "post_id": 49871217, "comment_id": 86758330, "body": "@JonPurdy: Thanks; that does make the parser a lot more useful."}, {"owner": {"reputation": 1270, "user_id": 2383766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc13aeb9c9f89e097f48d815b81541d5?s=128&d=identicon&r=PG", "display_name": "Z-Y.L", "link": "https://stackoverflow.com/users/2383766/z-y-l"}, "edited": false, "score": 2, "creation_date": 1523952758, "post_id": 49871217, "comment_id": 86761163, "body": "@SimonShine &amp; Jon Purdy Thank both of you! The suggestions are really helpful for me, esp. the usage of <code>many</code> and <code>try</code>, and it is the key to handle the unwanted character with <code>&lt;$</code>, with which I can solve my real problem."}], "tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": true, "score": 1, "last_activity_date": 1523951398, "last_edit_date": 1523951398, "creation_date": 1523946246, "answer_id": 49871217, "question_id": 49869451, "link": "https://stackoverflow.com/questions/49869451/how-to-use-parsec-to-get-sub-strings-of-specific-pattern-in-a-string/49871217#49871217", "title": "How to use parsec to get sub-strings of specific pattern in a string", "body": "<blockquote>\n  <p><code>F12</code>, <code>F 12</code>, <code>F1(a)</code>, <code>F2a</code>, <code>F5-A</code>, <code>F34-5</code></p>\n</blockquote>\n\n<p>This is an incomplete description, so I'll make some guesses.</p>\n\n<ol>\n<li><p>I would start by defining a type that can contain the logical parts of these expressions. E.g.</p>\n\n<pre><code>newtype F = F (Int, Maybe String) deriving Show\n</code></pre>\n\n<p>That is, \"F\" followed by a number and an optional part that is either letters, parenthesised letters, or a dash followed by letters/digits. Since the number after \"F\" can have multiple digits, I assume that the optional letters/digits may be multiple, too.</p>\n\n<p>Since the examples are limited, I assume that the following aren't valid: <code>F1a(b)</code>, <code>F1(a)b</code>, <code>F1a-5</code>, <code>F1(a)-A</code>, <code>F1a(a)-5</code>, <code>F1a1</code>, <code>F1-(a)</code>, etc. and that the following are valid: <code>F1A</code>, <code>F1abc</code>, <code>F1(abc)</code>, <code>F1-abc</code>, <code>F1-a1b2</code>. This is probably not true. [1]</p></li>\n<li><p>I would then proceed to write parsers for each of these sub-parts and compose them:</p>\n\n<pre><code>module Main where\n\nimport Text.Parsec\nimport Data.Maybe (catMaybes)\n\nsymbol :: String -&gt; Parser String\nsymbol s = string s &lt;* spaces\n\nparens :: Parser a -&gt; Parser a\nparens = between (string \"(\") (string \")\")\n\ndigits :: Parser Int\ndigits = read &lt;$&gt; many1 digit\n\nparseF :: Parser F\nparseF = curry F &lt;$&gt; firstPart &lt;*&gt; secondPart\n  where\n    firstPart :: Parser Int\n    firstPart = symbol \"F\" &gt;&gt; digits\n\n    secondPart :: Parser (Maybe String)\n    secondPart = optionMaybe $ choice\n      [ many1 letter\n      , parens (many1 letter)\n      , string \"-\" &gt;&gt; many1 alphaNum\n      ]\n</code></pre></li>\n<li><p><em>(As Jon Purdy writes in a comment,)</em> using this parser on a string to get multiple matches,</p>\n\n<pre><code>extract :: Parser a -&gt; Parser [a]\nextract p = do (:) &lt;$&gt; try p &lt;*&gt; extract p\n        &lt;|&gt; do anyChar &gt;&gt; extract p\n        &lt;|&gt; do eof &gt;&gt; return []\n\nreadFs :: String -&gt; Either ParseError [F]\nreadFs s = parse (extract parseF) \"\" s\n\nmain :: IO ()\nmain = print (readFs \"F12, F 12, F1(a), F2a, F5-A, F34-5\")\n</code></pre>\n\n<p>This prints:</p>\n\n<pre><code>Right [F (12,Nothing),F (12,Nothing),F (1,Just \"a\"),F (2,Just \"a\"),F (5,Just \"A\"),F (34,Just \"5\")]\n</code></pre></li>\n</ol>\n\n<p>Takeaways:</p>\n\n<ul>\n<li><p>You can parse optional whitespace using token parsing (<code>symbol</code>).</p></li>\n<li><p>You can parse optional parts with <a href=\"http://hackage.haskell.org/package/parsec-3.1.13.0/docs/Text-Parsec-Combinator.html#v:option\" rel=\"nofollow noreferrer\"><code>option</code>, <code>optionMaybe</code> or <code>optional</code></a>.</p></li>\n<li><p>You can alternate between combinators using <code>a &lt;|&gt; b &lt;|&gt; c</code> or <code>choice [a, b, c]</code>.</p></li>\n<li><p>When alternating between choices, make sure they don't have overlapping FIRST sets. Otherwise you need to <a href=\"http://hackage.haskell.org/package/parsec-3.1.13.0/docs/Text-Parsec.html#v:try\" rel=\"nofollow noreferrer\"><code>try</code></a>; this is nasty but sometimes unavoidable. (In  this case, FIRST sets for the three choices are <code>letter</code>, <code>string \"(\"</code> and <code>string \"-\"</code>, i.e. not overlapping.)</p></li>\n</ul>\n\n<p>[1]: For the sake of restriction, I kept to the assumptions above, but I felt that I could also have assumed that <code>F1a-B</code>, <code>F1(a)-5</code> and <code>F1(a)-5A</code> are valid, in which case I might change the model to:</p>\n\n<pre><code>newtype F = F (Int, Maybe String, Maybe String)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2824, "user_id": 187223, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9ab705e8ee51d24c8e52192f7fde8d76?s=128&d=identicon&r=PG", "display_name": "James Brock", "link": "https://stackoverflow.com/users/187223/james-brock"}, "is_accepted": false, "score": 0, "last_activity_date": 1567224890, "creation_date": 1567224890, "answer_id": 57735123, "question_id": 49869451, "link": "https://stackoverflow.com/questions/49869451/how-to-use-parsec-to-get-sub-strings-of-specific-pattern-in-a-string/57735123#57735123", "title": "How to use parsec to get sub-strings of specific pattern in a string", "body": "<p>We can get sub-strings of specific pattern in a string with the\n<a href=\"https://hackage.haskell.org/package/replace-megaparsec/docs/Replace-Megaparsec.html#v:findAll\" rel=\"nofollow noreferrer\"><code>findAll</code></a>\ncombinator from\n<a href=\"https://hackage.haskell.org/package/replace-megaparsec/\" rel=\"nofollow noreferrer\">replace-megaparsec</a>.</p>\n\n<p>Notice that this <code>tuhao</code> parser doesn't actually return anything. The <code>findAll</code> combinator just checks for success of the parser to find sub-strings which match the pattern.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Replace.Megaparsec\nimport Text.Megaparsec\nimport Text.Megaparsec.Char\nimport Data.Maybe\nimport Data.Either\n\nlet tuhao :: Parsec Void String ()\n    tuhao = do\n        void $ single 'F'\n        void $ space\n        void $ digitChar\n        void $ many $ oneOf \"abcdefghijklmnopqrstuvwxyz1234567890ABCDEFGHIJKLMNOPQRSTUVWXYZ()-\"\n\ninput = \"I want to choose F12 or F 12 from F1(a), F2a, F5-A, F34-5 and so on, but F alone should not be chosen, that is, choose those which start with F followed by a digit (before the digit there could be zero or more than one space) and then by any character from ['a'..'z'] ++ ['A'..'Z'] ++ ['0'..'9'] ++ ['(',')',\\\"-\\\"].\"\n\nrights $ fromJust $ parseMaybe (findAll tuhao) input\n</code></pre>\n\n<pre class=\"lang-hs prettyprint-override\"><code>[\"F12\",\"F 12\",\"F1(a)\",\"F2a\",\"F5-A\",\"F34-5\"]\n</code></pre>\n"}], "owner": {"reputation": 1270, "user_id": 2383766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc13aeb9c9f89e097f48d815b81541d5?s=128&d=identicon&r=PG", "display_name": "Z-Y.L", "link": "https://stackoverflow.com/users/2383766/z-y-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 2, "accepted_answer_id": 49871217, "answer_count": 2, "score": 4, "last_activity_date": 1567224890, "creation_date": 1523935988, "last_edit_date": 1523946274, "question_id": 49869451, "link": "https://stackoverflow.com/questions/49869451/how-to-use-parsec-to-get-sub-strings-of-specific-pattern-in-a-string", "title": "How to use parsec to get sub-strings of specific pattern in a string", "body": "<p>I'm a newbie to Haskell, and now I'm learning to use parsec. I get stuck in one problem, that is, I want to get all the sub-strings which satisfies some specific pattern in a string. For example, from the following string,</p>\n\n<blockquote>\n  <p>\"I want to choose F12 or F 12 from F1(a), F2a, F5-A, F34-5 and so on,\n  but F alone should not be chosen, that is, choose those which start with F\n  followed by a digit (before the digit there could be zero or more than one space) and then by any character from ['a'..'z'] ++\n  ['A'..'Z'] ++ ['0'..'9'] ++ ['(',')',\"-\"].\"</p>\n</blockquote>\n\n<p>the result should be [F12, F12, F1(a), F2a, F5-A, F34-5], where the space between the F and the digit should be deleted.</p>\n\n<p>With the parsec, I have succeeded in getting one sub-string, such as F12, F2a. The code is as follows:</p>\n\n<pre><code>hao :: Parser Char\nhao = oneOf \"abcdefghijklmnopqrstuvwxyz1234567890ABCDEFGHIJKLMNOPQRSTUVWXYZ()-\"\ntuhao :: Parser String\ntuhao = do { c &lt;- char 'F'\n           ; many space\n           ; c1 &lt;- digit\n           ; cs &lt;- many hao\n           ; return (c:c1:cs)\n           }\nparse tuhao \"\" str -- can parse the str and get one sub-string.\n</code></pre>\n\n<p>However, I am stuck at how to parse the example string above and get all the sub-strings of the specific pattern. I have an idea that if F is found, then begin parsing, else skip parsing or if parsing fails then skip parsing. But I don't know how to implement the plan. I have another idea that uses <code>State</code> to record the remaining string that is not parsed, and use recursion, but still fail to carry it out.</p>\n\n<p>So I appreciate any tip! ^_^</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "edited": false, "score": 0, "creation_date": 1523934936, "post_id": 49869246, "comment_id": 86753911, "body": "Do you get any error messages? If so, please include them in the question."}, {"owner": {"reputation": 1, "user_id": 4750305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd63f9d3c37fa3895f5b95c9b291f6f7?s=128&d=identicon&r=PG&f=1", "display_name": "GozarD", "link": "https://stackoverflow.com/users/4750305/gozard"}, "reply_to_user": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "edited": false, "score": 0, "creation_date": 1523935596, "post_id": 49869246, "comment_id": 86754045, "body": "Of course, sorry."}, {"owner": {"reputation": 1, "user_id": 4750305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd63f9d3c37fa3895f5b95c9b291f6f7?s=128&d=identicon&r=PG&f=1", "display_name": "GozarD", "link": "https://stackoverflow.com/users/4750305/gozard"}, "reply_to_user": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "edited": false, "score": 0, "creation_date": 1523935677, "post_id": 49869246, "comment_id": 86754073, "body": "[1 of 1] Compiling Main ( Pilas.hs, Pilas.o ) Pilas.hs:14:19:     Couldn&#39;t match expected type \u2018Pila x\u2019                 with actual type \u2018IORef (Pila x0)\u2019     Relevant bindings include       x :: Pila x (bound at Pilas.hs:14:6)       pila :: IORef (Pila x0) (bound at Pilas.hs:12:2)     In the second argument of \u2018apilar\u2019, namely \u2018pila\u2019     In the expression: apilar 1 pila  Pilas.hs:15:11:     Couldn&#39;t match type \u2018Pila x1\u2019 with \u2018[Char]\u2019     Expected type: String       Actual type: Pila x1     In the first argument of \u2018putStrLn\u2019, namely \u2018x\u2019     In a stmt of a &#39;do&#39; block: putStrLn x"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4750305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd63f9d3c37fa3895f5b95c9b291f6f7?s=128&d=identicon&r=PG&f=1", "display_name": "GozarD", "link": "https://stackoverflow.com/users/4750305/gozard"}, "edited": false, "score": 0, "creation_date": 1523936815, "post_id": 49869514, "comment_id": 86754345, "body": "Seems im given a &#39;Pila Integer&#39; instead String Pilas.hs:16:11:     Couldn&#39;t match type \u2018Pila Integer\u2019 with \u2018[Char]\u2019     Expected type: String       Actual type: Pila Integer     In the first argument of \u2018putStrLn\u2019, namely \u2018x\u2019     In a stmt of a &#39;do&#39; block: putStrLn x"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 1, "user_id": 4750305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd63f9d3c37fa3895f5b95c9b291f6f7?s=128&d=identicon&r=PG&f=1", "display_name": "GozarD", "link": "https://stackoverflow.com/users/4750305/gozard"}, "edited": false, "score": 1, "creation_date": 1523938885, "post_id": 49869514, "comment_id": 86754928, "body": "@GozarD: You want <code>print x</code>, which is equivalent to <code>putStrLn (show x)</code>. The <code>Show</code> instance for <code>Pila</code> is created for you by the <code>deriving (Show)</code> on <code>data Pila</code>. Also, you can use <code>modifyIORef&#39; pila (apilar 1)</code> instead of <code>readIORef</code> followed by <code>writeIORef</code>. (<code>modifyIORef</code> without a prime <code>&#39;</code> is lazy, so it may cause performance problems if you\u2019re repeatedly modifying the <code>IORef</code>, so I suggest <code>modifyIORef&#39;</code> until you have a solid understanding of laziness.)"}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": true, "score": 4, "last_activity_date": 1524001129, "last_edit_date": 1524001129, "creation_date": 1523936357, "answer_id": 49869514, "question_id": 49869246, "link": "https://stackoverflow.com/questions/49869246/how-to-use-haskell-data-type-created/49869514#49869514", "title": "How to use Haskell data type created?", "body": "<p>The problem is that <code>pila</code> is not of type <code>Pila x</code>, as you apparently expect, but of type <code>IORef (Pila x)</code>. That's what <a href=\"https://www.stackage.org/haddock/lts-11.5/base-4.10.1.0/Data-IORef.html#v:newIORef\" rel=\"nofollow noreferrer\">the function <code>newIORef</code></a> does - it creates a new <code>IORef</code>.</p>\n\n<p>In order to get the <code>Pila</code> value out of the <code>IORef</code>, use <a href=\"https://www.stackage.org/haddock/lts-11.5/base-4.10.1.0/Data-IORef.html#v:readIORef\" rel=\"nofollow noreferrer\">the <code>readIORef</code> function</a>, like this:</p>\n\n<pre><code>main = do \n    pilaRef &lt;- newIORef (Pila[]) \n\n    pila &lt;- readIORef pilaRef\n    let x = apilar 1 pila \n    ...\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4750305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dd63f9d3c37fa3895f5b95c9b291f6f7?s=128&d=identicon&r=PG&f=1", "display_name": "GozarD", "link": "https://stackoverflow.com/users/4750305/gozard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 49869514, "answer_count": 1, "score": -3, "last_activity_date": 1524001129, "creation_date": 1523934465, "last_edit_date": 1523935824, "question_id": 49869246, "link": "https://stackoverflow.com/questions/49869246/how-to-use-haskell-data-type-created", "title": "How to use Haskell data type created?", "body": "<p>I am new programming in Haskell. I'm trying to print my new data type but doesn't work. Im doing this in Geany, making a main.</p>\n\n<pre><code>module Main (\nmain\n) where\n\nimport Graphics.UI.Gtk\n--import Control.Monad.ST\nimport Data.IORef\n\n\n--main::IO ()\nmain = do\n pila &lt;- newIORef (Pila[])\n\n let x = apilar 1 pila\n putStrLn x\n\n mainGUI\n\n\n-------------------------\n\n\ndata Pila x = Pila[x] deriving (Show)\n\npila_vacia :: Pila x\npila_vacia = Pila[]\n\napilar :: x -&gt; Pila x -&gt; Pila x\napilar e (Pila lista) = Pila([e] ++ lista)\n</code></pre>\n\n<p>Error from terminal: Maybe something wrong with arguments</p>\n\n<pre><code>[1 of 1] Compiling Main( Pilas.hs, Pilas.o )\n\nPilas.hs:14:19:\n    Couldn't match expected type \u2018Pila x\u2019\n                with actual type \u2018IORef (Pila x0)\u2019\n    Relevant bindings include\n      x :: Pila x (bound at Pilas.hs:14:6)\n      pila :: IORef (Pila x0) (bound at Pilas.hs:12:2)\n    In the second argument of \u2018apilar\u2019, namely \u2018pila\u2019\n    In the expression: apilar 1 pila\n\nPilas.hs:15:11:\n    Couldn't match type \u2018Pila x1\u2019 with \u2018[Char]\u2019\n    Expected type: String\n      Actual type: Pila x1\n    In the first argument of \u2018putStrLn\u2019, namely \u2018x\u2019\n    In a stmt of a 'do' block: putStrLn x\n</code></pre>\n\n<p>Sorry my bad english</p>\n"}, {"tags": ["linux", "haskell", "window", "foreground"], "answers": [{"tags": [], "owner": {"reputation": 41648, "user_id": 108359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8a34d29224f05cd8bd1f480c89cf112?s=128&d=identicon&r=PG", "display_name": "Brian McKenna", "link": "https://stackoverflow.com/users/108359/brian-mckenna"}, "is_accepted": true, "score": 3, "last_activity_date": 1523944337, "last_edit_date": 1523944337, "creation_date": 1523938292, "answer_id": 49869791, "question_id": 49869233, "link": "https://stackoverflow.com/questions/49869233/get-foreground-window-title-using-haskell-on-linux/49869791#49869791", "title": "Get foreground window title using Haskell on Linux", "body": "<p>Using the <a href=\"https://hackage.haskell.org/package/X11\" rel=\"nofollow noreferrer\">X11</a> library:</p>\n\n<pre><code>import Graphics.X11\nimport Graphics.X11.Xlib.Extras\n\nmain = do\n  d &lt;- openDisplay \"\"\n  (w, _) &lt;- getInputFocus d\n  s &lt;- fetchName d w\n  print s\n</code></pre>\n"}], "owner": {"reputation": 20326, "user_id": 750216, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/974fb481d985024715a6816dfbb9cebf?s=128&d=identicon&r=PG", "display_name": "R\u0103zvan Flavius Panda", "link": "https://stackoverflow.com/users/750216/r%c4%83zvan-flavius-panda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 1, "accepted_answer_id": 49869791, "answer_count": 1, "score": 2, "last_activity_date": 1523944337, "creation_date": 1523934373, "question_id": 49869233, "link": "https://stackoverflow.com/questions/49869233/get-foreground-window-title-using-haskell-on-linux", "title": "Get foreground window title using Haskell on Linux", "body": "<p>Under Windows, it is possible to get the foreground window title using: <a href=\"https://hackage.haskell.org/package/Win32-2.6.2.0/docs/Graphics-Win32-Window-ForegroundWindow.html#v:getForegroundWindow\" rel=\"nofollow noreferrer\">getForegroundWindow</a></p>\n\n<p>Is there an equivalent way to get foreground window title using Haskell on Linux? (preferably without using FFI)</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 9656078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d15f7db84c3cf1b3f6507a24631283?s=128&d=identicon&r=PG&f=1", "display_name": "Car", "link": "https://stackoverflow.com/users/9656078/car"}, "edited": false, "score": 0, "creation_date": 1523952410, "post_id": 49869244, "comment_id": 86760967, "body": "this code gives an error \u2022 Occurs check: cannot construct the infinite type: a ~ [a]       Expected type: [a] -&gt; [a]         Actual type: [a] -&gt; a"}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 17, "user_id": 9656078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d15f7db84c3cf1b3f6507a24631283?s=128&d=identicon&r=PG&f=1", "display_name": "Car", "link": "https://stackoverflow.com/users/9656078/car"}, "edited": false, "score": 0, "creation_date": 1523967526, "post_id": 49869244, "comment_id": 86771372, "body": "@Car Well, I do not see your type signatures, but yes, <code>double&#39;</code> has a type similar to <code>[a] -&gt; a</code>, unlike <code>double</code>. This is what one would expect, since a <code>sum</code> takes many numbers but gives only one."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524037542, "post_id": 49869244, "comment_id": 86803358, "body": "@IgnatInsarov: no, unfortunately there is a mismatch, since you make a recursive call with <code>++ double&#39; xs</code>, the compiler expects <code>double&#39;</code> to return an <code>[a]</code>, but that will not happen, hence the infinite type <code>a ~ [a]</code>."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524122743, "post_id": 49869244, "comment_id": 86845719, "body": "@WillemVanOnsem Whoops. My brain must have been on vacation."}], "tags": [], "owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "is_accepted": false, "score": 1, "last_activity_date": 1524123028, "last_edit_date": 1524123028, "creation_date": 1523934450, "answer_id": 49869244, "question_id": 49868650, "link": "https://stackoverflow.com/questions/49868650/a-function-which-takes-value-from-previous-output/49869244#49869244", "title": "A function which takes value from previous output", "body": "<p>I am not sure how would <code>double [1,2,3,4,5]</code> ever be <code>[2,2,6,4,1]</code>. When I run your code, I get <code>[2,4,6,8,1]</code>.</p>\n\n<p>Also, is it 7 that you want to multiply by or 9? (I will assume 7 for the rest of the post.)</p>\n\n<hr>\n\n<p>You can use <code>$</code> like this:</p>\n\n<pre><code>anotherFunction xs = sum xs * 7\n\ndouble' x = anotherFunction $ double x\n</code></pre>\n\n<p>But it would be even better if you use <code>.</code> to <em>compose</em> your functions:</p>\n\n<pre><code>double'' = anotherFunction . double\n</code></pre>\n\n<p>Try it out and let me know if it does what you want!</p>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 9656078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d15f7db84c3cf1b3f6507a24631283?s=128&d=identicon&r=PG&f=1", "display_name": "Car", "link": "https://stackoverflow.com/users/9656078/car"}, "edited": false, "score": 0, "creation_date": 1523955125, "post_id": 49873662, "comment_id": 86762606, "body": "sorry but for this particular task I have been given instructions on not to use map"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 17, "user_id": 9656078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d15f7db84c3cf1b3f6507a24631283?s=128&d=identicon&r=PG&f=1", "display_name": "Car", "link": "https://stackoverflow.com/users/9656078/car"}, "edited": false, "score": 0, "creation_date": 1523955411, "post_id": 49873662, "comment_id": 86762799, "body": "@Car: then I propose you construct your own <code>map</code>. The limitations of homework are not really part of the StackOverflow questions I think, since the aim is that other people can benefit from the questions and answers as well :)."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 0, "last_activity_date": 1523954901, "creation_date": 1523954901, "answer_id": 49873662, "question_id": 49868650, "link": "https://stackoverflow.com/questions/49868650/a-function-which-takes-value-from-previous-output/49873662#49873662", "title": "A function which takes value from previous output", "body": "<p>First of all, I would suggest that you use a <code>map</code> here, instead of writing a recursive function yourself. It is clear that - for a list of elements - you generate a list of the same length where you map every element to another element. Here the \"mapping function\" is structured like:</p>\n\n<pre><code>f x | tx &gt;= 10 = mod tx 10 + div tx 10\n    | otherwise = tx\n    where tx = 2*x\n</code></pre>\n\n<p>or even more compact:</p>\n\n<pre><code>f x = let tx = 2*x in min tx (mod tx 10 + div tx 10)\n</code></pre>\n\n<p>Now your <code>double</code> function can be expressed as:</p>\n\n<pre><code>double :: Integral i =&gt; [i] -&gt; i\ndouble = map f\n    where f x = let tx = 2*x in min tx (mod tx 10 + div tx 10)\n</code></pre>\n\n<p>Now it produces:</p>\n\n<pre><code>Prelude&gt; double [1..5]\n[2,4,6,8,1]\n</code></pre>\n\n<p>Which is correct, based on your specifications. The only reasonable way to come up with the proposed list in the question, is by only processing values with an <em>odd</em> index (so the first, third, fifth, etc.).</p>\n\n<p>Nevertheless, the core of the question is about post-processing. We can do this by using the <a href=\"http://hackage.haskell.org/package/base-4.11.0.0/docs/Prelude.html#v:-46-\" rel=\"nofollow noreferrer\"><strong><code>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c</code></strong></a> function:</p>\n\n<pre><code>sum7 :: Integral i =&gt; [i] -&gt; i\nsum7 = (7*) . sum . double\n</code></pre>\n\n<p>So for your given input, this produces:</p>\n\n<pre><code>Prelude&gt; sum7 [1,2,3,4,5]\n147\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9656078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d15f7db84c3cf1b3f6507a24631283?s=128&d=identicon&r=PG&f=1", "display_name": "Car", "link": "https://stackoverflow.com/users/9656078/car"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1524123028, "creation_date": 1523929826, "question_id": 49868650, "link": "https://stackoverflow.com/questions/49868650/a-function-which-takes-value-from-previous-output", "title": "A function which takes value from previous output", "body": "<p>Hi I am new to haskell and I have a program</p>\n\n<pre><code>double x = case x of\n []   -&gt; []\n x:xs -&gt; (if (x*2 &lt; 10) then [x*2] else [x*2 `div` 10 + x*2 `mod` 10]) ++ double xs\n</code></pre>\n\n<p>the problem I am having is I want to sum the answer given by this function and multiply the number by 7.</p>\n\n<p>so lets say if i inputed double [1,2,3,4,5]</p>\n\n<p>I would get [2,2,6,4,1] now i want to recall this into another function and add this together and multiply by 9. I am aware you can use <strong>$</strong> to attach functions but I am not sure how I would go about doing it. Thanks</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 2, "creation_date": 1523911127, "post_id": 49865836, "comment_id": 86747043, "body": "Your definition of <code>natPlus</code> looks a bit buggy - have you tried computing eg. <code>natPlus (S Z) Z</code>?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523911136, "post_id": 49865836, "comment_id": 86747048, "body": "You forgot the <code>natPlus (S a) Z</code> case."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1523912154, "post_id": 49865836, "comment_id": 86747553, "body": "I strongly recommend to turn on warnings, which would help you sport the issue immediately."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 5, "last_activity_date": 1523912100, "last_edit_date": 1523912100, "creation_date": 1523911329, "answer_id": 49865905, "question_id": 49865836, "link": "https://stackoverflow.com/questions/49865836/how-to-define-multiplication-of-natural-numbers-in-haskell-commutatively/49865905#49865905", "title": "How to define multiplication of Natural Numbers in Haskell commutatively?", "body": "<p>In case of the <code>Non-exhaustive patterns in function natPlus</code> error, it is useful to <strong>compile with the <a href=\"http://downloads.haskell.org/~ghc/latest/docs/html/users_guide/flags.html#ghc-flag--Wincomplete-patterns\" rel=\"nofollow noreferrer\"><code>-Wincomplete-patterns</code></a> flag</strong>. If we compile the program with this flag we obtain:</p>\n\n<pre><code>$ ghci -Wincomplete-patterns \nGHCi, version 8.0.2: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; data Nat = Z | S Nat deriving (Show)\nPrelude&gt; :{\nPrelude| natPlus :: Nat -&gt; Nat -&gt; Nat\nPrelude| natPlus Z a = a\nPrelude| natPlus (S a) (S b) = natPlus a (S (S b))\nPrelude| :}\n\n&lt;interactive&gt;:4:1: warning: [-Wincomplete-patterns]\n    Pattern match(es) are non-exhaustive\n    In an equation for \u2018natPlus\u2019: Patterns not matched: (S _) Z\n</code></pre>\n\n<p>So the compiler warns us that for <code>natPlus</code>, the case <code>natPlus (S _) Z</code> is <em>not</em> covered. Since this is an exercise, I suggest that you define this case. So your code should look like:</p>\n\n<pre><code>natPlus :: Nat -&gt; Nat -&gt; Nat\nnatPlus Z a = a\nnatPlus (S a) (S b) = natPlus a (S (S b))\nnatPlus (S a) Z = -- ... your code here ...\n</code></pre>\n\n<p>Note that you can solve this by implementing a more generic pattern (for example <code>natPlus a Z</code>, You can try to define it in two clauses, for example <code>natPlus Z a = -- ...</code>, and <code>natPlus (S a) b = -- ...</code></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5775230"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 458, "favorite_count": 0, "closed_date": 1523916315, "answer_count": 1, "score": 1, "last_activity_date": 1523912400, "creation_date": 1523911015, "last_edit_date": 1523912400, "question_id": 49865836, "link": "https://stackoverflow.com/questions/49865836/how-to-define-multiplication-of-natural-numbers-in-haskell-commutatively", "closed_reason": "Duplicate", "title": "How to define multiplication of Natural Numbers in Haskell commutatively?", "body": "<p>I was trying to define natural number multiplication in Haskell, and kept getting the error below (corresponds to the second natMult definition below).</p>\n\n<pre><code>Prelude&gt; natMult (S (S Z)) (S (S Z))\n*** Exception: &lt;interactive&gt;:(4,5)-(5,45): Non-exhaustive patterns in function natPlus\n</code></pre>\n\n<p>Here's my code:</p>\n\n<pre><code>data Nat = Z | S Nat deriving (Show)\n\nnatPlus :: Nat -&gt; Nat -&gt; Nat\nnatPlus Z a = a\nnatPlus (S a) (S b) = natPlus a (S (S b))\n</code></pre>\n\n<p>After a bit of tinkering, I realized this definition works fine, whereas the second one below is broken.  The only difference is the order of the input parameters for natPlus.</p>\n\n<pre><code>-- works fine\nnatMult :: Nat -&gt; Nat -&gt; Nat\nnatMult Z a = Z\nnatMult (S a) b = natPlus (natMult a b) b\n\n-- gives gives the error above\nnatMult :: Nat -&gt; Nat -&gt; Nat\nnatMult Z a = Z\nnatMult (S a) b = natPlus b (natMult a b)\n</code></pre>\n\n<p>Can anyone explain why this error arises?</p>\n\n<p>---Edit---\nThe below definition is complete and solves the problem.  Thanks for the suggestions</p>\n\n<pre><code>natPlus Z a = a\nnatPlus (S a) b = natPlus a (S b)\n</code></pre>\n"}, {"tags": ["debugging", "haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1523903093, "post_id": 49863872, "comment_id": 86743121, "body": "Why do you use a <code>case</code> here, but only use guards?"}, {"owner": {"reputation": 263, "user_id": 9654804, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "HaskellPlease", "link": "https://stackoverflow.com/users/9654804/haskellplease"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523903262, "post_id": 49863872, "comment_id": 86743227, "body": "hahahah I DONT KNOW when I remove case it doesnt work at all"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1523903358, "post_id": 49863872, "comment_id": 86743284, "body": "And unfortunately, this error shows up a lot. <code>return</code> is not a <i>keyword</i> in Haskell: it is a function that is used for monads. Therefore I advice you <i>not</i> to use it, unless you know what you are doing."}, {"owner": {"reputation": 263, "user_id": 9654804, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "HaskellPlease", "link": "https://stackoverflow.com/users/9654804/haskellplease"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523903658, "post_id": 49863872, "comment_id": 86743446, "body": "anything I can use instead of return to print out a string without causing this error?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1523904082, "post_id": 49863872, "comment_id": 86743665, "body": "You should start writing these functions starting from their type. If the return type is, say, <code>Double</code>, you can not return a string (and you surely can not return a string inside a monad like <code>return &quot;abc&quot;</code>). If you want to error out you can use <code>if ... then 2.71 else error &quot;message&quot;</code>, but understand that this error will crash the program when evaluated, and the the caller won&#39;t be able to catch the error and handle it. Sometimes this is enough. The expression <code>error &quot;..&quot;</code> fits any type."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523904499, "post_id": 49863872, "comment_id": 86743877, "body": "@HaskellPlease: none of the functions you use actually print something, these only return something (no not <code>return</code>, just return), it is only the interpreter that notices that there is output, and thus prints it in the console."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1523957129, "last_edit_date": 1523957129, "creation_date": 1523904200, "answer_id": 49864218, "question_id": 49863872, "link": "https://stackoverflow.com/questions/49863872/haskell-type-error-ambiguous-type-variable-arising-from-use-of-print/49864218#49864218", "title": "Haskell Type Error - Ambiguous Type Variable Arising from Use of `Print`", "body": "<p>Frequently, people that start with Haskell, use the <a href=\"http://hackage.haskell.org/package/base-4.11.0.0/docs/Prelude.html#v:return\" rel=\"nofollow noreferrer\"><strong><code>return :: Monad m =&gt; a -&gt; m a</code></strong></a> function, since in the imperative world, nearly all [imperative] programming languages assign an almost equal semantic to the <code>return</code> <em>keyword</em>. In Haskell however, <code>return</code> is a <em>function</em> (not a keyword), and it is used in the context of <em>monads</em>. Although monads are quite powerful, I would advice to first take a look at how this structure works <em>before</em> using <code>return</code> at all. One hint: it does not really work like it works in the imperative world.</p>\n\n<p>We can remove the <code>return</code> function, like:</p>\n\n<pre><code>note a b c d = \n    if d &gt; 100 || c &gt; 20\n        then \"Wrong input\"\n        else if a == False || b == False \n            then printGrade d\n            else printGrade (c + d)</code></pre>\n\n<p>But then we get a new error:</p>\n\n<pre><code>&lt;interactive&gt;:20:18: error:\n    \u2022 Could not deduce (Fractional [Char])\n        arising from a use of \u2018printGrade\u2019\n      from the context: (Num a, Ord a)\n        bound by the inferred type of\n                 note :: (Num a, Ord a) =&gt; Bool -&gt; Bool -&gt; a -&gt; a -&gt; [Char]\n        at &lt;interactive&gt;:(16,1)-(21,35)\n    \u2022 In the expression: printGrade d\n      In the expression:\n        if a == False || b == False then\n            printGrade d\n        else\n            printGrade (c + d)\n      In the expression:\n        if d &gt; 100 || c &gt; 20 then\n            \"Wrong input\"\n        else\n            if a == False || b == False then\n                printGrade d\n            else\n                printGrade (c + d)\n</code></pre>\n\n<p>Now Haskell is having problem with the return type. Indeed <code>printGrade</code> returns values like <code>1.0</code>, which is a <code>Fractional</code> type (what type exactly can be specified later, but the literal suggest that it should be a <code>Fractional</code> type). And it says that you return a string as well (<code>\"Wrong input\"</code>), and since a <code>String</code> is not a <code>Fractional</code> type, there is a mismatch. We can solve this by calling <code>show</code> on the result of <code>printGrade</code> (I suggest you rename that function, since the function does <em>not</em> print anything), such that we convert the <code>Fractional</code> type into a <code>String</code>, so now we got:</p>\n\n<pre><code>note a b c d = \n    if d &gt; 100 || c &gt; 20\n        then \"Wrong input\"\n        else if a == False || b == False \n            then <b>show (</b>printGrade d<b>)</b>\n            else <b>show (</b>printGrade (c + d)<b>)</b></code></pre>\n\n<p>Now the program will compile, but it is rather inelegant. For example you use a <code>case</code> in the <code>printGrade</code> function, but you do not really perform any pattern matching. We can use <em>guards</em> instead, like:</p>\n\n<pre><code>grade :: (Num a, Ord a, Fractional b) =&gt; a -&gt; b\ngrade points | points &lt; 0 = error \"too small\"\n             | points &lt; 50 = 5.0\n             | points &lt; 54 = 4.0\n             | points &lt; 58 = 3.7      \n             | points &lt; 62 = 3.3\n             | points &lt; 66 = 3.0\n             | points &lt; 70 = 2.7\n             | points &lt; 74 = 2.3\n             | points &lt; 78 = 2.0\n             | points &lt; 82 = 1.7\n             | points &lt; 86 = 1.3\n             | points &lt; 100 = 1.0\n             | otherwise = error \"too large\"</code></pre>\n\n<p>Here we thus use one guard per case, furthermore there is no need to check if the value is for example less than <code>0</code>, since in that case the previous guard would have fired.</p>\n\n<p>We can use the same technique for the <code>note</code> function: use patterns and guards to match the values:</p>\n\n<pre><code>note :: (Ord a, Num a) =&gt; Bool -&gt; Bool -&gt; a -&gt; a -&gt; String\nnote _ _ c d | d > 100 || c > 20 = \"Wrong input\"\nnote False False _ d = show (printGrade d)\nnote _ _ c d = show (printGrade (c + d))</code></pre>\n"}], "owner": {"reputation": 263, "user_id": 9654804, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "HaskellPlease", "link": "https://stackoverflow.com/users/9654804/haskellplease"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 438, "favorite_count": 0, "accepted_answer_id": 49864218, "answer_count": 1, "score": 1, "last_activity_date": 1523957129, "creation_date": 1523902841, "last_edit_date": 1523903094, "question_id": 49863872, "link": "https://stackoverflow.com/questions/49863872/haskell-type-error-ambiguous-type-variable-arising-from-use-of-print", "title": "Haskell Type Error - Ambiguous Type Variable Arising from Use of `Print`", "body": "<p>So I am trying to write a bit of Haskell and I've come to this problem that makes me wanna smash my head against a wall.</p>\n\n<pre><code>printGrade points = case points of            \n    points | 0 &lt;= points &amp;&amp; points &lt; 50 -&gt; 5.0\n    points | 50 &lt;= points &amp;&amp; points &lt; 54 -&gt; 4.0\n    points | 54 &lt;= points &amp;&amp; points &lt; 58 -&gt; 3.7      \n    points | 58 &lt;= points &amp;&amp; points &lt; 62 -&gt; 3.3\n    points | 62 &lt;= points &amp;&amp; points &lt; 66 -&gt; 3.0\n    points | 66 &lt;= points &amp;&amp; points &lt; 70 -&gt; 2.7\n    points | 70 &lt;= points &amp;&amp; points &lt; 74 -&gt; 2.3\n    points | 74 &lt;= points &amp;&amp; points &lt; 78 -&gt; 2.0\n    points | 78 &lt;= points &amp;&amp; points &lt; 82 -&gt; 1.7\n    points | 82 &lt;= points &amp;&amp; points &lt; 86 -&gt; 1.3\n    points | 86 &lt;= points &amp;&amp; points &lt; 100 -&gt; 1.0\n\nnote a b c d = \n            if d &gt; 100 || c &gt; 20\n            then return \"Wrong input\"\n            else if a == False || b == False \n            then printGrade d\n            else printGrade (c + d) \n</code></pre>\n\n<p>When I try to run the code it compiles without problems but actually calling the function brings this error</p>\n\n<pre><code>&lt;interactive&gt;:91:1: error:\n\u2022 Ambiguous type variable \u2018m0\u2019 arising from a use of \u2018print\u2019\n  prevents the constraint \u2018(Show (m0 [Char]))\u2019 from being solved.\n  Probable fix: use a type annotation to specify what \u2018m0\u2019 should be.\n  These potential instances exist:\n    instance Show a =&gt; Show (Maybe a) -- Defined in \u2018GHC.Show\u2019\n    instance (Show a, Show b) =&gt; Show (a, b) -- Defined in \u2018GHC.Show\u2019\n    instance (Show a, Show b, Show c) =&gt; Show (a, b, c)\n      -- Defined in \u2018GHC.Show\u2019\n    ...plus 13 others\n    ...plus two instances involving out-of-scope types\n    (use -fprint-potential-instances to see them all)\n\u2022 In a stmt of an interactive GHCi command: print it\n</code></pre>\n\n<p>I know that it has something to do with then return \"Wrong Input\" but I don't know a way to fix this since I have to print out a string at some point. (I've tried show/print/putStrLn which leads to another error)</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523896618, "post_id": 49862187, "comment_id": 86739527, "body": "Well you explicitly &quot;memoize&quot; it here. Since you declare a variable <code>lx = length x</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1523896662, "post_id": 49862187, "comment_id": 86739549, "body": "<code>test</code> is not a function; it&#39;s an <code>IO Int</code> value. You can <i>execute</i> that action multiple times, but <code>myRandom</code> (which calls <code>debug</code>) itself is only called once."}, {"owner": {"reputation": 31724, "user_id": 6264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbb17eeeecd3d9d06f4db310ab630a12?s=128&d=identicon&r=PG", "display_name": "Michiel Borkent", "link": "https://stackoverflow.com/users/6264/michiel-borkent"}, "edited": false, "score": 0, "creation_date": 1523896668, "post_id": 49862187, "comment_id": 86739552, "body": "I know, within the function body. But for multiple runs of <code>test</code> I can&#39;t see how Haskell does it?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1523896958, "post_id": 49862187, "comment_id": 86739709, "body": "AFAICS the &quot;memoization&quot; is in the binding of <code>test</code>. Computing the <code>IO Int</code> action itself produces the <code>trace</code> output. The action is only computed once (the first time it&#39;s used), then reused."}], "answers": [{"comments": [{"owner": {"reputation": 31724, "user_id": 6264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbb17eeeecd3d9d06f4db310ab630a12?s=128&d=identicon&r=PG", "display_name": "Michiel Borkent", "link": "https://stackoverflow.com/users/6264/michiel-borkent"}, "edited": false, "score": 0, "creation_date": 1523900596, "post_id": 49862656, "comment_id": 86741711, "body": "typo: randomIO should be randomrIO"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 31724, "user_id": 6264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbb17eeeecd3d9d06f4db310ab630a12?s=128&d=identicon&r=PG", "display_name": "Michiel Borkent", "link": "https://stackoverflow.com/users/6264/michiel-borkent"}, "edited": false, "score": 0, "creation_date": 1523905381, "post_id": 49862656, "comment_id": 86744334, "body": "That&#39;s what I meant to type, I swear :) Thanks, fixed."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 3, "last_activity_date": 1523905367, "last_edit_date": 1523905367, "creation_date": 1523898056, "answer_id": 49862656, "question_id": 49862187, "link": "https://stackoverflow.com/questions/49862187/haskell-evaluation-of-functions-calls-on-function-arguments/49862656#49862656", "title": "Haskell evaluation of functions calls on function arguments", "body": "<p><code>test</code> is not a function that you call; it is an <code>IO</code> action that you execute. <code>debug</code> is called by <code>myRandom</code>, which is only called once to produce the <code>IO</code> action bound to <code>test</code>.</p>\n\n<p>To get debug output for every execution of the action, you need to embed the call to <code>debug</code> in the action itself.</p>\n\n<pre><code>myRandom :: [a] -&gt; IO Int\nmyRandom x = let lx = Prelude.length x `debug` \"Getting length\"\n                 rnd = randomRIO (0, lx) `debug` \"Getting generator\"\n             in debug &lt;$&gt; rnd &lt;*&gt; pure (show lx)\n</code></pre>\n\n<p>Now, when you evaluate <code>test</code>, you'll get 3 lines of output the first time (indicating that <code>length</code> and <code>randomRIO</code> are only evaluated once), but only one line of output each subsequent time (indicating that the <code>IO</code> action <code>rnd</code> is indeed executed anew each time).</p>\n"}], "owner": {"reputation": 31724, "user_id": 6264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbb17eeeecd3d9d06f4db310ab630a12?s=128&d=identicon&r=PG", "display_name": "Michiel Borkent", "link": "https://stackoverflow.com/users/6264/michiel-borkent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 49862656, "answer_count": 1, "score": 0, "last_activity_date": 1523905367, "creation_date": 1523896481, "question_id": 49862187, "link": "https://stackoverflow.com/questions/49862187/haskell-evaluation-of-functions-calls-on-function-arguments", "title": "Haskell evaluation of functions calls on function arguments", "body": "<p>Given the following:</p>\n\n<pre><code>debug = flip Debug.Trace.trace\n\nfoo = [1,2,3]\n\nmyRandom :: [a] -&gt; IO Int\nmyRandom x =\n  let lx = Prelude.length x\n  in System.Random.randomRIO (0, lx) `debug` show lx\n\ntest = myRandom foo\n</code></pre>\n\n<p>multiple runs of <code>test</code> will produce a random number every time, but only the first call will print the length of the function argument. I assume it's only calculated once. Does Haskell memoize every function by default (in this case <code>length</code>)? How does this work in detail?</p>\n"}, {"tags": ["haskell", "emacs", "cabal", "intero"], "answers": [{"tags": [], "owner": {"reputation": 862, "user_id": 1386599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9cefe8e0d6764e68c425c1c3062ba78?s=128&d=identicon&r=PG", "display_name": "plc", "link": "https://stackoverflow.com/users/1386599/plc"}, "is_accepted": false, "score": 1, "last_activity_date": 1524065127, "creation_date": 1524065127, "answer_id": 49903528, "question_id": 49862177, "link": "https://stackoverflow.com/questions/49862177/intero-doesnt-find-paths-module-when-using-cabal-data-files/49903528#49903528", "title": "Intero doesn&#39;t find Paths-module when using cabal data files", "body": "<p>I was only building my project using cabal and nix. It turns out that because Intero is stack-centric, building the project with <code>stack build</code> does indeed put a <code>Paths_..</code> module in a place where Intero searches.</p>\n"}], "owner": {"reputation": 862, "user_id": 1386599, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9cefe8e0d6764e68c425c1c3062ba78?s=128&d=identicon&r=PG", "display_name": "plc", "link": "https://stackoverflow.com/users/1386599/plc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1524065127, "creation_date": 1523896411, "last_edit_date": 1523974777, "question_id": 49862177, "link": "https://stackoverflow.com/questions/49862177/intero-doesnt-find-paths-module-when-using-cabal-data-files", "title": "Intero doesn&#39;t find Paths-module when using cabal data files", "body": "<p>When I use the data-files feature of cabal, it generates a <code>Paths_pkgname.hs</code> module that lives in the <code>dist/</code> folder.</p>\n\n<p>However, intero is unable to find this file (or generate it on its own), and I can't find any means to pass an option to hint at its position.</p>\n\n<p>Note: Somewhere else (on SO?) I picked up the trick when using ghci to make a dummy <code>only-for-ghci/Paths_.hs</code> that is only brought into scope through <code>:set -ionly-for-ghci</code> being set in <code>.ghci</code>. This won't apply for intero though, as its invocation in <code>intero.el</code> specificcally instructs it to ignore the <code>.ghci</code> file.</p>\n"}, {"tags": ["haskell", "parsec", "megaparsec"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1523893777, "post_id": 49861020, "comment_id": 86737902, "body": "I think this is meant to achieve the effect of reporting all errors iff none of the attempted parsers succeeded; but if at least one succeeded, the errors from all unsuccessful parsers ought to be swallowed."}, {"owner": {"reputation": 629, "user_id": 4727280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38762034473fd7e48dcce03fc091e343?s=128&d=identicon&r=PG&f=1", "display_name": "fmg", "link": "https://stackoverflow.com/users/4727280/fmg"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1523894001, "post_id": 49861020, "comment_id": 86738025, "body": "@FyodorSoikin Then why does <code>cok</code> even take a <code>ParseError</code> argument?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1523896439, "post_id": 49861020, "comment_id": 86739444, "body": "<a href=\"https://stackoverflow.com/questions/39057940/why-doesnt-parsec-backtrack-when-one-part-of-the-parser-succeeds-and-the-rest-f\" title=\"why doesnt parsec backtrack when one part of the parser succeeds and the rest f\">stackoverflow.com/questions/39057940/&hellip;</a>"}, {"owner": {"reputation": 629, "user_id": 4727280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38762034473fd7e48dcce03fc091e343?s=128&d=identicon&r=PG&f=1", "display_name": "fmg", "link": "https://stackoverflow.com/users/4727280/fmg"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1523898261, "post_id": 49861020, "comment_id": 86740431, "body": "@leftaroundabout Would you be able to guide me a little? What part of the referenced post is addressing what?"}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1523899136, "post_id": 49861020, "comment_id": 86740921, "body": "@fmg it takes that argument, because its signature is dictated by the <code>ParsecT</code> constructor."}, {"owner": {"reputation": 629, "user_id": 4727280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38762034473fd7e48dcce03fc091e343?s=128&d=identicon&r=PG&f=1", "display_name": "fmg", "link": "https://stackoverflow.com/users/4727280/fmg"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1523899535, "post_id": 49861020, "comment_id": 86741126, "body": "@FyodorSoikin I meant, why is the ParsecT type defined in this way, i.e., with cok taking a ParseError argument that never seems to be used nontrivially."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1523904318, "post_id": 49861020, "comment_id": 86743793, "body": "Because it&#39;s not in every case that you want up swallow these errors."}, {"owner": {"reputation": 629, "user_id": 4727280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38762034473fd7e48dcce03fc091e343?s=128&d=identicon&r=PG&f=1", "display_name": "fmg", "link": "https://stackoverflow.com/users/4727280/fmg"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1523908958, "post_id": 49861020, "comment_id": 86746029, "body": "@FyodorSoikin Would you mind suggesting an example where you don&#39;t want these elements swallowed when passing through <code>cok</code>? Are there any such in the <code>Parsec</code> codebase, that you know of?"}], "owner": {"reputation": 629, "user_id": 4727280, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/38762034473fd7e48dcce03fc091e343?s=128&d=identicon&r=PG&f=1", "display_name": "fmg", "link": "https://stackoverflow.com/users/4727280/fmg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1523892482, "creation_date": 1523892482, "question_id": 49861020, "link": "https://stackoverflow.com/questions/49861020/propagation-of-megaparsec-errors-through-continuations", "title": "Propagation of (Mega)Parsec errors through continuations", "body": "<p>I have a somewhat techinical question about the inner workings of (Mega)Parsec, the informal context of which is:</p>\n\n<blockquote>\n  <p>What is the idea governing the accumulation/propagation of error messages through continuations in <code>Parsec</code>?</p>\n</blockquote>\n\n<p>Specifically:\nConsider the <code>mplus</code> operation making <code>ParsecT</code> an instance of <code>MonadPlus</code>.\n(<a href=\"https://hackage.haskell.org/package/parsec-3.1.13.0/docs/src/Text.Parsec.Prim.html#line-362\" rel=\"nofollow noreferrer\">source</a>)\n<code>mplus m n</code> takes, as input, a string <code>s</code> to parse and continuations <code>cok</code>, <code>cerr</code>, <code>eok</code>, and <code>eerr</code> to follow based on the result of the parse.</p>\n\n<p>First parse <code>s</code> with <code>m</code>:</p>\n\n<ul>\n<li>If the parse succeeds and consumes (respectively, does not consume) part of <code>s</code>, follow the <code>cok</code> (respectively, <code>eok</code>) continuation.</li>\n<li>If the parse of <code>s</code> with <code>m</code> fails while consuming part of <code>s</code>, follow the <code>cerr</code> continuation.</li>\n<li>Suppose the parse of <code>s</code> with <code>m</code> fails without consuming anything; let <code>err</code> be the parse error associated with this failure. We then try parsing <code>s</code> with <code>n</code>, and choose a continuation accordingly:\n\n<ul>\n<li>If the parse of <code>s</code> with <code>n</code> succeeds while consuming input, follow the <code>cok</code> continuation.</li>\n<li>If the parse of <code>s</code> with <code>n</code> fails while consuming input, follow the <code>cerr</code> continuation.</li>\n<li>If the parse of <code>s</code> with <code>n</code> succeeds without consuming input, follow a continuation <code>neok</code> derived from <code>eok</code>: <code>neok y s' err' = eok y s' (mergeError err err')</code></li>\n<li>If the parse of <code>s</code> with <code>n</code> fails without consuming input, follow a continuation <code>neerr</code> derived from <code>eerr</code>: <code>neerr y s' err' = eerr (mergeError err err')</code></li>\n</ul></li>\n</ul>\n\n<p>My question is:</p>\n\n<blockquote>\n  <p>Why do we merge errors when following an 'empty' continuation and not when following a 'consumed' continuation, thereby forgetting about all previous errors?</p>\n</blockquote>\n\n<p>This must be a design decision, but I can't figure out the reasoning behind it. Is there, perhaps, a simple example that would clarify this?</p>\n"}, {"tags": ["haskell", "functional-programming", "monads"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523881789, "post_id": 49857378, "comment_id": 86729170, "body": "There is not much advanced Haskell involved in most articles about monads anyway. You can see it as an abstraction of continuations."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523881966, "post_id": 49857378, "comment_id": 86729290, "body": "A monad basically comes down to the fact that you have a higher oder type <code>m</code>, such that you can do <code>(a -&gt; m b) -&gt; m a -&gt; m b</code>, so you have a function that takes as input <code>a</code>s, and returns an <code>m b</code> for that, then you have an <code>m a</code>, and that returns an <code>m b</code>. You can for instance define a list monad, or a <code>Maybe</code> monad, etc."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 10, "creation_date": 1523882079, "post_id": 49857378, "comment_id": 86729363, "body": "The thing is, most programming languages don&#39;t have a sufficiently powerful type system to really express the idea of monads, namely, they don&#39;t support higher-kinded polymorphism. So, for explaining monads, a quick intro to Haskell syntax is the easiest way. The alternative is to introduce it without any programming language at all, using only math syntax \u2013 but that doesn&#39;t make it easier for most non-Haskell programmers either. \u2014 Mind, you can certainly translate <i>any given monad</i> to, say, C++, but that obscures the fundamental idea behind the concept."}, {"owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 6, "creation_date": 1523882636, "post_id": 49857378, "comment_id": 86729795, "body": "The problem, as leftroundabout pointed out, is that for a long time, Haskell was the &quot;most mainstream&quot; language that was actually capable of expressing what a monad is. Neither Java&#39;s nor C++&#39;s type system can actually express monads, so it is impossible to explain them using those language. Only recently has Scala come into existence, which is actually powerful enough to express monads, however, its syntax for doing so is much less elegant than Haskell&#39;s. (And honestly: the tricky part to understand are the semantics of monads, the syntax needed to explain that is tiny.)"}, {"owner": {"reputation": 839, "user_id": 5090093, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/wU3YG.jpg?s=128&g=1", "display_name": "nappyfalcon", "link": "https://stackoverflow.com/users/5090093/nappyfalcon"}, "reply_to_user": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "edited": false, "score": 0, "creation_date": 1523882802, "post_id": 49857378, "comment_id": 86729914, "body": "@J&#246;rgWMittag You said &quot; the tricky part to understand are the semantics of monads, the syntax needed to explain that is tiny&quot;. Brilliant! So can someone explain the semantics without using incomprehensible Haskell syntax? For example, I can explain the concept of a class without writing code in any particular language. Or I might use an invented, simplified language or pseudocode. I don&#39;t need to write a C++ header and implementation to explain it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6445533"}, "edited": false, "score": 1, "creation_date": 1523883440, "post_id": 49857378, "comment_id": 86730366, "body": "I found the blog post <a href=\"https://blog.osteele.com/2007/12/overloading-semicolon/\" rel=\"nofollow noreferrer\">Overloading Semicolon, or, monads from 10,000 Feet</a> very helpful. Anyway, monads are such an extremely generalized concept that it will take you a while to understand all its applications. There are no shortcuts."}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 1, "creation_date": 1523883786, "post_id": 49857378, "comment_id": 86730614, "body": "The problem in explaining what a monad is, is similar to the problem of explaining something simple but completely new to someone. If you once tried to explain to a child what are numbers, then you understand this. It seems to you that the numbers are very simple and the obvious thing. But the child needs time, so that his brain can understand this abstraction. The same with monads. In fact, they are not more complicated than numbers, but their idea for you is new. Therefore, explain that it is so hard."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 2, "creation_date": 1523883930, "post_id": 49857378, "comment_id": 86730725, "body": "I think this is the wrong question to ask. You&#39;re not going to be happy with any answer you get, because the form of the question sets up monads as a big, complicated, scary topic. When people come back with incredibly simple answers you&#39;re going to reject them because they don&#39;t fit your preconceptions."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1523884219, "post_id": 49857378, "comment_id": 86730935, "body": "Wikipedia has one: <a href=\"https://en.wikipedia.org/wiki/Monad_(category_theory)#Formal_definition\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Monad_(category_theory)#Formal_definit&zwnj;&#8203;ion</a>"}, {"owner": {"reputation": 14830, "user_id": 3757232, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/kLzML.jpg?s=128&g=1", "display_name": "Jared Smith", "link": "https://stackoverflow.com/users/3757232/jared-smith"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1523884260, "post_id": 49857378, "comment_id": 86730962, "body": "@dfeuer the wikipedia article is pretty.... inaccessible. I think <a href=\"http://adit.io/posts/2013-04-17-functors,_applicatives,_and_monads_in_pictures.html\" rel=\"nofollow noreferrer\">this</a> is a pretty good explanation in pictures."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 14830, "user_id": 3757232, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/kLzML.jpg?s=128&g=1", "display_name": "Jared Smith", "link": "https://stackoverflow.com/users/3757232/jared-smith"}, "edited": false, "score": 0, "creation_date": 1523884455, "post_id": 49857378, "comment_id": 86731100, "body": "@JaredSmith, I wasn&#39;t being very serious. For a good category-theoretic explanation, you&#39;d be much better off with the Catsters video lectures or an explanation by Bartosz Milewski."}, {"owner": {"reputation": 14830, "user_id": 3757232, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/kLzML.jpg?s=128&g=1", "display_name": "Jared Smith", "link": "https://stackoverflow.com/users/3757232/jared-smith"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1523884520, "post_id": 49857378, "comment_id": 86731152, "body": "@dfeuer sorry missed the sarcasm, perhaps because my brain was preoccupied with how this obvious dupe got upvotes and an answer..."}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 1, "creation_date": 1523884878, "post_id": 49857378, "comment_id": 86731396, "body": "As I understand it, you think that not the knowledge of Haskell does not let you understand what a monad is. But I assure you that if you knew the syntax and semantics of Haskell, this does not mean that you would immediately understand this concept. The problem with monads is wider."}], "answers": [{"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1523932972, "post_id": 49858063, "comment_id": 86753481, "body": "You could write a generic <code>replicateM</code> with higher-kinded polymorphism (a template template parameter): <code>template&lt;template&lt;typename&gt; class M, typename A&gt; M&lt;array&lt;A&gt;&gt; replicateM(int n, M&lt;A&gt; m)</code>, but you\u2019d need to reorganise a few things\u2014for example, <code>pure</code> would need to be a static member function on each monad so you could refer to <code>M::pure</code> generically, otherwise the overloads of <code>template&lt;typename A&gt; writer&lt;A&gt; pure(A)</code> and <code>template&lt;typename A&gt; array&lt;A&gt; pure(A)</code> are ambiguous because they differ only by return type. It\u2019s much easier to express this concept in languages that were made for it!"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 4, "last_activity_date": 1523888597, "last_edit_date": 1523888597, "creation_date": 1523883870, "answer_id": 49858063, "question_id": 49857378, "link": "https://stackoverflow.com/questions/49857378/what-is-a-monad-for-someone-who-doesnt-want-to-learn-haskell-in-order-to-unders/49858063#49858063", "title": "What is a monad for someone who doesn&#39;t want to learn Haskell in order to understand it?", "body": "\n\n<p>To take it to C++ (prior to <a href=\"https://herbsutter.com/2017/07/26/metaclasses-thoughts-on-generative-c/\" rel=\"nofollow noreferrer\">metaclasses</a>, which will eventually give a way to express this properly), the best description of a monad is this:</p>\n\n<ul>\n<li><p>A <em>parameterised class</em> (like the STL container types), i.e. a class of the form</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template &lt;typename a&gt;\nclass M;\n</code></pre></li>\n<li><p>which supports at least the following functions:</p>\n\n<ul>\n<li><p>\u201cTrivial injection\u201d</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template &lt;typename a, typename b&gt;\nM&lt;a&gt; pure (a x);\n</code></pre>\n\n<p><sup>Mathematicians call this <em>\u03b7</em>, Haskell has traditionally called it <code>return</code>, other languages often <code>unit</code>.</sup></p></li>\n<li><p>Functor<sup>\u2020</sup> mapping</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template &lt;typename a, typename b&gt;\nM&lt;b&gt; fmap (std::function&lt;b(a)&gt; f, M&lt;a&gt; m);\n</code></pre></li>\n<li><p>A flattening operation</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template &lt;typename a, typename b&gt;\nM&lt;a&gt; join (M&lt; M&lt;a&gt; &gt; mm);\n</code></pre>\n\n<p><sup>Which mathematicians call <em>\u03bc</em>. Many programming languages (including Haskell) don't implemented this by itself but combined with <code>fmap</code>, as such it is then called <code>flatMap</code> or <code>&gt;&gt;=</code>. But <code>join</code> is the simplest form.</sup></p></li>\n</ul></li>\n<li><p>such that the <a href=\"https://en.wikipedia.org/wiki/Monad_(category_theory)#Formal_definition\" rel=\"nofollow noreferrer\">monad laws</a> are fulfilled.</p></li>\n</ul>\n\n<p>Example for an array type:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template &lt;typename a&gt;\nstruct array {\n  std::vector&lt;a&gt; contents;\n};\n\ntemplate &lt;typename a&gt;\narray&lt;a&gt; pure(a x) {\n  return array&lt;a&gt;{{std::vector&lt;a&gt;({x})}};   // array with only a single element.\n}\n\ntemplate &lt;typename a, typename b&gt;\narray&lt;b&gt; fmap(std::function&lt;b(a)&gt; f, array&lt;a&gt; m) {\n  std::vector&lt;b&gt; resultv;\n  for(auto&amp; x: m) {\n    resultv.push_back(f(x));\n  }\n  return array&lt;b&gt;{{resultv}};   // array with the elements transformed by the given function\n}\n\ntemplate &lt;typename a&gt;\narray&lt;a&gt; join(array&lt; array&lt;a&gt; &gt; mm) {\n  std::vector&lt;a&gt; resultv;\n\n  for(auto&amp; row: mm.contents) {\n    for(auto&amp; x: row.contents) {\n      resultv.push_back(x);\n    }\n  }\n  return array&lt;a&gt;{{resultv}};   // array with all the rows concatenated.\n}\n</code></pre>\n\n<p>So, what's the use of this? Well, <code>fmap</code> is pretty useful on its own right, when you quickly want to map a lambda over all the elements of an array (allowing for changing type), without having to fiddle with any iterators (unlike <code>std::transform</code>). But <code>fmap</code> doesn't really require a monad.</p>\n\n<p>What monads really shine at is <em>generically sequencing actions</em>. That won't become very clear with that array example, so let me introduce another monad:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template &lt;typename a&gt;\nstruct writer {\n  std::string logbook;\n  a result;\n};\n\ntemplate &lt;typename a, typename b&gt;\nwriter&lt;a&gt; pure (a x) {\n  return writer&lt;a&gt;{{\"\", x}};  // nothing to log yet\n}\n\ntemplate &lt;typename a, typename b&gt;\nwriter&lt;b&gt; fmap (std::function&lt;b(a)&gt; f, writer&lt;a&gt; m){\n  return writer&lt;b&gt;{{m.logbook, f(m.result)}};\n                      // simply keep the log as-is\n}\n\ntemplate &lt;typename a, typename b&gt;\nwriter&lt;a&gt; join (writer&lt; writer&lt;a&gt; &gt; mm) {\n  return writer&lt;a&gt;{{mm.logbook + mm.result.logbook, m.result.result}};\n      // Concatenate the two logs, and keep the inner value\n}\n</code></pre>\n\n<p><code>writer</code> more resembles the most [in]famous Haskell monad, <code>IO</code>. The <code>writer</code> type allows you to compose arbitrary log-writing functions together, and without ever having to worry about it, gather all the logbook information.</p>\n\n<p>You may wonder at this point: what <em>is</em> there to log? None of the operations above actually produce any logbook entries! Indeed they don't \u2013 in fact the monad laws would be violated if they did! Monads are not about particular actions, pre-built values. Rather, they just give you an extremely generic <em>framework</em> for \u201cglueing together\u201d such actions.</p>\n\n<p>A simple example of such a glueing-compositor is <code>replicateM</code>, which takes a single monadic action and executes it <em>n</em> times in sequence, gathering all the results. Unfortunately, this can't be properly typed in C++ in full generality, but here's a specialized version that only works for the writer monad. First, let's quickly implement that combined fmap-join I mentioned earlier, because it's much more handy than <code>join</code> in practice:</p>\n\n<pre class=\"lang-cpp prettyprint-override\"><code>template&lt;typename a, typename b&gt;\nwriter&lt;b&gt; flatMap(std::function&lt;writer&lt;b&gt;(a)&gt; f, writer&lt;a&gt; xs) {\n  return join(fmap(f,xs));\n}\n\ntemplate &lt;typename a&gt;\nwriter&lt;array&lt;a&gt;&gt; replicateM (int n, writer&lt;a&gt; m) {\n  if (n&gt;0) {\n    writer&lt;array&lt;a&gt;&gt; resultv = fmap(pure, m);\n    for (int i=1; i&lt;n; ++i) {\n      resultv = flatMap( [&amp;](array&lt;a&gt; xs){\n                           return fmap( [&amp;](a x){\n                                           return xs.push_back(x);}\n                                      , m );}\n                       , resultv);\n    }\n  } else {\n    return pure(std::vector&lt;a&gt;());\n  }\n}\n</code></pre>\n\n<p>Notice that none of the code above actually uses anything specific to <code>writer</code>, so I could copy&amp;paste it and use it for any other monad. (Or, use a language with higher-kinded polymorphism and just write it once and for all.)</p>\n\n<p>What <code>replicateM</code> does in case of <code>writer</code> is frankly quite dumb \u2013 it just repeats the same log message <code>n</code> times, and replicates the result value <code>n</code> times as well. However, that's just the simplest example: monads can also have much more functionality, for example, in the IO monad, each invocation might yield a different result (e.g. because it reads from standard input). A generic monad interface allows you to abstract over all kinds of different side-effects, but still keeps clear track of what side-effects can possibly happen in a given context.</p>\n\n<hr>\n\n<p><sup>\u2020</sup><sub>Unfortunately, the C++ community misuses the word \u201cfunctor\u201d simply to describe <em>function objects</em>. Although this is a related concept, a <a href=\"https://en.wikipedia.org/wiki/Functor\" rel=\"nofollow noreferrer\">functor</a> is actually more than that.</sub></p>\n"}, {"comments": [{"owner": {"reputation": 14830, "user_id": 3757232, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/kLzML.jpg?s=128&g=1", "display_name": "Jared Smith", "link": "https://stackoverflow.com/users/3757232/jared-smith"}, "edited": false, "score": 0, "creation_date": 1523885599, "post_id": 49858556, "comment_id": 86731923, "body": "I&#39;m upvoting this, almost against my better judgement. It does a great job of explaining <i>why it&#39;s hard to explain monads</i>, but should really be an answer on the linked dupe."}], "tags": [], "owner": {"reputation": 335867, "user_id": 2988, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed181f8c80df53d2b67a4f4fff088ed4?s=128&d=identicon&r=PG", "display_name": "J&#246;rg W Mittag", "link": "https://stackoverflow.com/users/2988/j%c3%b6rg-w-mittag"}, "is_accepted": false, "score": 6, "last_activity_date": 1523885448, "creation_date": 1523885448, "answer_id": 49858556, "question_id": 49857378, "link": "https://stackoverflow.com/questions/49857378/what-is-a-monad-for-someone-who-doesnt-want-to-learn-haskell-in-order-to-unders/49858556#49858556", "title": "What is a monad for someone who doesn&#39;t want to learn Haskell in order to understand it?", "body": "<p>I am going to try and give the simplest possible explanation using Scala syntax and semantics.</p>\n\n<p>A Monad is <em>any</em> type that has the following signature:</p>\n\n<pre><code>trait Monad[A] {\n  def flatMap[B](f: A \u21d2 Monad[B]): Monad[B]\n}\n\ndef unit[A](x: A): Monad[A]\n</code></pre>\n\n<p>and satisfies the following laws:</p>\n\n<ul>\n<li><p><em>Left Identity</em>:</p>\n\n<pre><code>unit(x).flatMap(f) == f(x)\n</code></pre></li>\n<li><p><em>Right Identity</em>:</p>\n\n<pre><code>m.flatMap(unit _) == m\n</code></pre></li>\n<li><p><em>Associativity</em>:</p>\n\n<pre><code>m.flatMap(f).flatMap(g) == m.flatMap(f(_).flatMap(g))\n</code></pre></li>\n</ul>\n\n<p><em>And that's it</em>. That is the beauty of monads. <em>Anything</em> that satisfies those constraints is a monad. And there are lots of things that satisfy those constraints: Lists, Sets, Dictionaries, Maps, Options, Database Queries, Continuations, Errors, Side Effects, Interpreters, Compilers, \u2026</p>\n\n<p>The power of monads comes from the combination of <em>just enough</em> structure that you can write lots of operations that operate on monads, and at the same time <em>so little</em> structure that lots of things are monads. The combination of those two properties means that you can write lots of operations <em>once</em> that then apply to lots of different types of objects.</p>\n\n<p>And that's one of the problems with monads: their generality. A monad is a very general abstraction, that makes it not immediately obvious what it is. I mean, what do sets, lists, database queries, side effects, continuations, and compilers have in common?</p>\n"}], "owner": {"reputation": 839, "user_id": 5090093, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/wU3YG.jpg?s=128&g=1", "display_name": "nappyfalcon", "link": "https://stackoverflow.com/users/5090093/nappyfalcon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1999, "favorite_count": 0, "closed_date": 1523885608, "answer_count": 2, "score": 1, "last_activity_date": 1523892286, "creation_date": 1523881686, "last_edit_date": 1523892286, "question_id": 49857378, "link": "https://stackoverflow.com/questions/49857378/what-is-a-monad-for-someone-who-doesnt-want-to-learn-haskell-in-order-to-unders", "closed_reason": "Duplicate", "title": "What is a monad for someone who doesn&#39;t want to learn Haskell in order to understand it?", "body": "<p>What is a monad in programming, and can it be explained such that:</p>\n\n<ol>\n<li>You don't need any prior knowledge of Haskell to understand.</li>\n<li>You can go ahead and use or build the concept in more mainstream programming languages such as C++/Java/Scala.</li>\n</ol>\n\n<p>Basically, I've been coming across this term in my online learning. As an example, this Java 8 Stream tutorial mentions monads (<a href=\"http://winterbe.com/posts/2014/07/31/java8-stream-tutorial-examples/\" rel=\"nofollow noreferrer\">http://winterbe.com/posts/2014/07/31/java8-stream-tutorial-examples/</a>). So I would like to understand the fundamental concept in a useful way. (As opposed to a stupid way like \"Imagine programming as an orange, then monads would be grapefruit ...\" sort of thing.)</p>\n\n<p>However, each monad tutorial seems to require prior knowledge of (or tries to teach you on-the-fly) Haskell or Haskell syntax.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "edited": false, "score": 4, "creation_date": 1523871296, "post_id": 49853838, "comment_id": 86722416, "body": "Could you please create a test case, that is a Minimal, Complete, and Verifiable example <a href=\"https://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1523871895, "post_id": 49853838, "comment_id": 86722822, "body": "Memoizing a function taking an argument of type <code>[[Int]]</code> is unusual, and the array-based approach you are trying to use probably won&#39;t work. The error message is telling you that you can&#39;t use a <code>[[Int]]</code> as an index of the array. Perhaps you could use a <code>Data.Map</code> instead, but I don&#39;t know what to recommend in this case."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1523872184, "post_id": 49853838, "comment_id": 86723018, "body": "Making use of <code>(!!)</code> will probably result in a lot of overhead: <code>!! k</code>, works in <i>O(k)</i>, so for large <code>k</code>, this will take significant time."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1523880398, "post_id": 49853838, "comment_id": 86728198, "body": "Please explain what this code is supposed to do (pseudocode, specifications, examples...). I doublt you actually want to memoise on keys of type <code>[[Int]]</code> there."}, {"owner": {"reputation": 81, "user_id": 9648495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/608fda19c26bcb394b457200434bd69f?s=128&d=identicon&r=PG&f=1", "display_name": "WhiteW", "link": "https://stackoverflow.com/users/9648495/whitew"}, "edited": false, "score": 0, "creation_date": 1523894844, "post_id": 49853838, "comment_id": 86738535, "body": "Basically, the code is :         inner (i, 0) g = g !! (i-1) !! (0)     inner (i, k) g = maximum [inner ((i, k-1), g)                              ,                               inner((i-1, k), g)                              ]                                                                                        , without memoization. I would like to store the result of :  inner((i-1, k), g / [inner ((i, k-1), g in an array, using memoization."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 9648495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/608fda19c26bcb394b457200434bd69f?s=128&d=identicon&r=PG&f=1", "display_name": "WhiteW", "link": "https://stackoverflow.com/users/9648495/whitew"}, "edited": false, "score": 0, "creation_date": 1524060591, "post_id": 49887658, "comment_id": 86819149, "body": "Thank you. Fortunately, I solved the problem without this package."}], "tags": [], "owner": {"reputation": 309, "user_id": 6222757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48fdecaf00efb53f6ed0ee200fa9ba2b?s=128&d=identicon&r=PG&f=1", "display_name": "evzh", "link": "https://stackoverflow.com/users/6222757/evzh"}, "is_accepted": true, "score": 0, "last_activity_date": 1523999978, "creation_date": 1523999978, "answer_id": 49887658, "question_id": 49853838, "link": "https://stackoverflow.com/questions/49853838/function-call-to-memoization-with-multiple-parameters/49887658#49887658", "title": "Function call to memoization (with multiple parameters)", "body": "<p>I happen to know that there's an <a href=\"https://hackage.haskell.org/package/memoize-0.8.1/docs/Data-Function-Memoize.html#t:Memoizable\" rel=\"nofollow noreferrer\">Data.Function.Memoize</a> package that will definitely make this whole thing easier.</p>\n\n<p>In your case, I would use the <code>memoize2</code> function in this package with type signature</p>\n\n<pre><code>memoize2 :: (Memoizable a, Memoizable b) =&gt; (a -&gt; b -&gt; v) -&gt; a -&gt; b -&gt; v\n</code></pre>\n\n<p>with <code>a = (Int, Int), b = [[Int]]</code>. The following instances would convince you that the type constraint is satisfied:</p>\n\n<pre><code>Memoizable Int\nMemoizable a =&gt; Memoizable [a]\n(Memoizable a, Memoizable b) =&gt; Memoizable (a, b)\n</code></pre>\n\n<p>Caveat note: though I have some good impression with this package, it does not seem very portable or reliable (if you're to build real things with it). The following statement can be found on its Hackage page:</p>\n\n<blockquote>\n  <p>Note that most memoization in this style relies on assumptions about the implementation of non-strictness (as laziness) that are not guaranteed by the semantics. However, it <em>appears</em> to work.</p>\n</blockquote>\n"}], "owner": {"reputation": 81, "user_id": 9648495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/608fda19c26bcb394b457200434bd69f?s=128&d=identicon&r=PG&f=1", "display_name": "WhiteW", "link": "https://stackoverflow.com/users/9648495/whitew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "accepted_answer_id": 49887658, "answer_count": 1, "score": 0, "last_activity_date": 1523999978, "creation_date": 1523870727, "last_edit_date": 1523936376, "question_id": 49853838, "link": "https://stackoverflow.com/questions/49853838/function-call-to-memoization-with-multiple-parameters", "title": "Function call to memoization (with multiple parameters)", "body": "<p>I would like to use memoization on a function with multiple different parameters</p>\n\n<pre><code>function :: (Int, Int) -&gt; [[Int]] -&gt; Int\n</code></pre>\n\n<p>What I tried so far:</p>\n\n<pre><code>function :: (Int, Int) -&gt; [[Int]] -&gt; Int\nfunction (s, d) matrix = inner (s, d) matrix \n  where  \n    inner (i, 0) g = g !! (i-1) !! (0)\n    inner (i, k) g = maximum [memo ! ((i, k-1), g)\n                             ,\n                              memo ! ((i-1, k), g)\n                             ]\n    memo = listArray bounds\n                [inner (i,k) g | ((i,k), g) &lt;- Data.Array.range bounds]\n    bounds = ( ((1,1), [[1,1]]), ((n,n), [[n,n]]) )\n</code></pre>\n\n<p>Still, it is not working as expected - the message I receive is:</p>\n\n<blockquote>\n  <p>No instance for (Data.Array.Ix [[Int]]) arising from a use of \u2018!\u2019</p>\n</blockquote>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 6008, "user_id": 1983772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2f429722c8167802b89cbe4d324aa1e?s=128&d=identicon&r=PG", "display_name": "Norrius", "link": "https://stackoverflow.com/users/1983772/norrius"}, "edited": false, "score": 7, "creation_date": 1523837558, "post_id": 49848004, "comment_id": 86710913, "body": "What have you tried? If you were able to write length in terms of recursion, can you extend that approach to sum?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523868836, "post_id": 49848004, "comment_id": 86720835, "body": "It is not really clear to me why you write <code>List (a,a)</code> as recursive part, instead of <code>List (a,a)</code>, it makes not much sense in my opinion."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 6008, "user_id": 1983772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2f429722c8167802b89cbe4d324aa1e?s=128&d=identicon&r=PG", "display_name": "Norrius", "link": "https://stackoverflow.com/users/1983772/norrius"}, "edited": false, "score": 0, "creation_date": 1523873978, "post_id": 49848004, "comment_id": 86724189, "body": "@Norrius It is not that simple, since the <code>List</code> type is not a regular list. It recurs as <code>List (a,a)</code>, exploiting polymorphic recursion."}, {"owner": {"reputation": 549, "user_id": 1524453, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ed2un.png?s=128&g=1", "display_name": "Federico Sawady", "link": "https://stackoverflow.com/users/1524453/federico-sawady"}, "edited": false, "score": 0, "creation_date": 1523975880, "post_id": 49848004, "comment_id": 86777724, "body": "Of course it is not a regular list, I&#39;m trying to understand nested datatypes."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1523874241, "post_id": 49850045, "comment_id": 86724338, "body": "Interestingly, we can also use <code>deriving Functor</code> to derive <code>nest</code> as <code>fmap</code> (I was a bit surprised that the autoderiving engine coped with the polymorphic recursion!)."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1523874522, "post_id": 49850045, "comment_id": 86724509, "body": "@chi (Haven&#39;t tried but) I think you can even derive <code>Foldable</code> and get <code>sum</code> for free"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1523874677, "post_id": 49850045, "comment_id": 86724601, "body": "@BenjaminHodgson Indeed you can! I just tried it, and it works."}, {"owner": {"reputation": 549, "user_id": 1524453, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ed2un.png?s=128&g=1", "display_name": "Federico Sawady", "link": "https://stackoverflow.com/users/1524453/federico-sawady"}, "edited": false, "score": 0, "creation_date": 1523975400, "post_id": 49850045, "comment_id": 86777351, "body": "That&#39;s what I want!! I thought that this was going to be much difficult."}, {"owner": {"reputation": 549, "user_id": 1524453, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ed2un.png?s=128&g=1", "display_name": "Federico Sawady", "link": "https://stackoverflow.com/users/1524453/federico-sawady"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1523976050, "post_id": 49850045, "comment_id": 86777849, "body": "@chi I know I can derive Foldable, but how can I give a definition for fold of a nested datatype like this?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 549, "user_id": 1524453, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ed2un.png?s=128&g=1", "display_name": "Federico Sawady", "link": "https://stackoverflow.com/users/1524453/federico-sawady"}, "edited": false, "score": 1, "creation_date": 1523976549, "post_id": 49850045, "comment_id": 86778265, "body": "@FedericoSawady Foldable is essentially <code>toList</code>, and the answer below gives a possible implementation. You might want to put the elements in the list in a different order."}, {"owner": {"reputation": 18055, "user_id": 936310, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/302ec54987694b9746abf8e2e0ad8caf?s=128&d=identicon&r=PG&f=1", "display_name": "alias", "link": "https://stackoverflow.com/users/936310/alias"}, "reply_to_user": {"reputation": 549, "user_id": 1524453, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ed2un.png?s=128&g=1", "display_name": "Federico Sawady", "link": "https://stackoverflow.com/users/1524453/federico-sawady"}, "edited": false, "score": 0, "creation_date": 1523977770, "post_id": 49850045, "comment_id": 86779157, "body": "@FedericoSawady The paper I cited in the answer has the definition of fold you&#39;re looking for."}, {"owner": {"reputation": 549, "user_id": 1524453, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ed2un.png?s=128&g=1", "display_name": "Federico Sawady", "link": "https://stackoverflow.com/users/1524453/federico-sawady"}, "edited": false, "score": 0, "creation_date": 1523977946, "post_id": 49850045, "comment_id": 86779277, "body": "I read this paper: <a href=\"http://www.cs.ox.ac.uk/richard.bird/online/BirdMeertens98Nested.pdf\" rel=\"nofollow noreferrer\">cs.ox.ac.uk/richard.bird/online/BirdMeertens98Nested.pdf</a>. It says &quot;but one still cannot define important generic functions, such as fold, over nested types&quot;. Why?"}, {"owner": {"reputation": 549, "user_id": 1524453, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ed2un.png?s=128&g=1", "display_name": "Federico Sawady", "link": "https://stackoverflow.com/users/1524453/federico-sawady"}, "edited": false, "score": 0, "creation_date": 1523978071, "post_id": 49850045, "comment_id": 86779372, "body": "Sorry, It is impossible without Rank-2 types. Thank you."}, {"owner": {"reputation": 18055, "user_id": 936310, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/302ec54987694b9746abf8e2e0ad8caf?s=128&d=identicon&r=PG&f=1", "display_name": "alias", "link": "https://stackoverflow.com/users/936310/alias"}, "reply_to_user": {"reputation": 549, "user_id": 1524453, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ed2un.png?s=128&g=1", "display_name": "Federico Sawady", "link": "https://stackoverflow.com/users/1524453/federico-sawady"}, "edited": false, "score": 0, "creation_date": 1523979044, "post_id": 49850045, "comment_id": 86780039, "body": "@FedericoSawady That is not true; see my edited answer. No extensions are required."}, {"owner": {"reputation": 549, "user_id": 1524453, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ed2un.png?s=128&g=1", "display_name": "Federico Sawady", "link": "https://stackoverflow.com/users/1524453/federico-sawady"}, "edited": false, "score": 0, "creation_date": 1523979295, "post_id": 49850045, "comment_id": 86780209, "body": "That&#39;s true, I do not understand Bird&#39;s paper then."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1524065826, "post_id": 49850045, "comment_id": 86823169, "body": "What about a version in terms of the &quot;efficient fold&quot; in the paper?"}], "tags": [], "owner": {"reputation": 18055, "user_id": 936310, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/302ec54987694b9746abf8e2e0ad8caf?s=128&d=identicon&r=PG&f=1", "display_name": "alias", "link": "https://stackoverflow.com/users/936310/alias"}, "is_accepted": false, "score": 9, "last_activity_date": 1523978992, "last_edit_date": 1523978992, "creation_date": 1523855777, "answer_id": 49850045, "question_id": 49848004, "link": "https://stackoverflow.com/questions/49848004/list-nested-data-type-sum/49850045#49850045", "title": "List Nested Data Type Sum", "body": "<p>Sure:</p>\n\n<pre><code>data List a = EmptyL | ConsL a (List (a,a))\n\npair f (x, y) = (f x, f y)\n\nnest :: (a -&gt; b) -&gt; List a -&gt; List b\nnest f EmptyL       = EmptyL\nnest f (ConsL x xs) = ConsL (f x) (nest (pair f) xs)\n\nsumL :: List Int -&gt; Int\nsumL EmptyL       = 0\nsumL (ConsL x xs) = x + sumL (nest (uncurry (+)) xs)\n</code></pre>\n\n<p>We have:</p>\n\n<pre><code>*Main&gt; sumL EmptyL\n0\n*Main&gt; sumL (ConsL 1 EmptyL)\n1\n*Main&gt; sumL (ConsL 1 (ConsL (2, 3) EmptyL))\n6\n</code></pre>\n\n<p>The \"magic\" is explained in: <a href=\"http://www.cs.ox.ac.uk/jeremy.gibbons/publications/efolds.pdf\" rel=\"nofollow noreferrer\">http://www.cs.ox.ac.uk/jeremy.gibbons/publications/efolds.pdf</a></p>\n\n<p>For completeness, here's a full definition in terms of the generalized <code>fold</code> as described in the paper:</p>\n\n<pre><code>import Prelude hiding (sum, fold)\n\ndata List a = EmptyL | ConsL (a, List (a, a))\n\nnest :: (a -&gt; b) -&gt; List a -&gt; List b\nnest f EmptyL          = EmptyL\nnest f (ConsL (x, xs)) = ConsL (f x, nest (pair f) xs)\n\npair :: (a -&gt; b) -&gt; (a, a) -&gt; (b, b)\npair f (x, y) = (f x, f y)\n\nfold :: a -&gt; ((b, a) -&gt; a) -&gt; ((b, b) -&gt; b) -&gt; List b -&gt; a\nfold e f g EmptyL          = e\nfold e f g (ConsL (x, xs)) = f (x, fold e f g (nest g xs))\n\nsum :: List Int -&gt; Int\nsum = fold 0 (uncurry (+)) (uncurry (+))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 947, "user_id": 934323, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed728497754b4892f67b5fa8b20b9ec2?s=128&d=identicon&r=PG", "display_name": "Jonas Dureg&#229;rd", "link": "https://stackoverflow.com/users/934323/jonas-dureg%c3%a5rd"}, "is_accepted": false, "score": 3, "last_activity_date": 1523871617, "creation_date": 1523871617, "answer_id": 49854132, "question_id": 49848004, "link": "https://stackoverflow.com/questions/49848004/list-nested-data-type-sum/49854132#49854132", "title": "List Nested Data Type Sum", "body": "<p>The data type you have is not really for lists, more like complete binary trees. You can convert the trees you have to ordinary lists like this:</p>\n\n<pre><code>toList :: List a -&gt; [a]\ntoList EmptyL = []\ntoList (ConsL x xs) = x:uncurry (++) (unzip (toList xs))\n</code></pre>\n\n<p>Not the most efficient code and the ordering is a bit arbitrary, but it should work. If you want the sum or anything else you can just use <code>sum . toList</code>.</p>\n\n<p>Note that your <code>lenL</code> function does not compute the length of the resulting list, but rather the depth of the original tree. If you want the number of elements in the tree you can use <code>length . toList</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1523993381, "creation_date": 1523993381, "answer_id": 49886092, "question_id": 49848004, "link": "https://stackoverflow.com/questions/49848004/list-nested-data-type-sum/49886092#49886092", "title": "List Nested Data Type Sum", "body": "<p>Since <code>sum</code> is a method of <code>Foldable</code>, let's see how we'd implement <code>foldMap</code>:</p>\n\n<pre><code>data List a = EmptyL | ConsL a (List (a,a))\n\ninstance Foldable List where\n  foldMap _ EmptyL = mempty\n  foldMap f (ConsL a as) = f a &lt;&gt; foldMap (\\(x,y) -&gt; f x &lt;&gt; f y) as\n</code></pre>\n\n<p>We can write <code>sumL = getSum . foldMap Sum</code>.</p>\n"}], "owner": {"reputation": 37, "user_id": 8933876, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec807e4dc281d20319651550085cfc9a?s=128&d=identicon&r=PG&f=1", "display_name": "Yahatma Amid", "link": "https://stackoverflow.com/users/8933876/yahatma-amid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1523993381, "creation_date": 1523837260, "question_id": 49848004, "link": "https://stackoverflow.com/questions/49848004/list-nested-data-type-sum", "title": "List Nested Data Type Sum", "body": "<p>I have this type</p>\n\n<pre><code>data List a = EmptyL | ConsL a (List (a,a))\n</code></pre>\n\n<p>and I wrote this function</p>\n\n<pre><code>lenL :: List a -&gt; Int\nlenL EmptyL = 0\nlenL (ConsL x xs) = 1 + lenL xs\n</code></pre>\n\n<p>Can I write a function like this?</p>\n\n<pre><code>sumL :: List Int -&gt; Int\n</code></pre>\n\n<p>How?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1523852718, "post_id": 49847342, "comment_id": 86713834, "body": "An alternative: <code>or [ x &gt; length xs | x &lt;- xs ]</code>"}], "tags": [], "owner": {"reputation": 165, "user_id": 2630395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b5f0f742c249caa0f3d03554e9a1675?s=128&d=identicon&r=PG", "display_name": "Somebody", "link": "https://stackoverflow.com/users/2630395/somebody"}, "is_accepted": true, "score": 3, "last_activity_date": 1523830804, "creation_date": 1523830804, "answer_id": 49847342, "question_id": 49847078, "link": "https://stackoverflow.com/questions/49847078/how-to-check-if-any-item-in-a-list-of-integers-has-a-value-greater-than-the-leng/49847342#49847342", "title": "How to check if any item in a list of integers has a value greater than the length of the list", "body": "<p>You can use the <code>any</code> function for this which will return <code>True</code> if at least one element in the list satisfies a given predicate (<code>Int -&gt; Bool</code> function in this case).</p>\n\n<pre><code>queens xs = any (\\x -&gt; x &gt; length xs) xs\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9006139, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/627ab506038ae37d1f6b4c3a45d56c01?s=128&d=identicon&r=PG&f=1", "display_name": "Charles Hildreth", "link": "https://stackoverflow.com/users/9006139/charles-hildreth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 49847342, "answer_count": 1, "score": 0, "last_activity_date": 1523863802, "creation_date": 1523828515, "last_edit_date": 1523863802, "question_id": 49847078, "link": "https://stackoverflow.com/questions/49847078/how-to-check-if-any-item-in-a-list-of-integers-has-a-value-greater-than-the-leng", "title": "How to check if any item in a list of integers has a value greater than the length of the list", "body": "<p>I am working on the n queens problem, my type signature is</p>\n\n<pre><code>queens :: [Int] -&gt; Bool\n</code></pre>\n\n<p>The input is a list of row numbers of the queens. I am at a loss as to how to iterate through the list and compare each value to length xs.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 6, "creation_date": 1523822629, "post_id": 49846233, "comment_id": 86707401, "body": "You probably better would use fractions for this, and <i>not</i> floating points."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1523824134, "post_id": 49846233, "comment_id": 86707862, "body": "I suspect you&#39;ll want to use an integer logarithm to get a sense of the order of magnitude of <code>200!</code> and then go from there, but I can&#39;t get into the full details right now."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1523826053, "post_id": 49846233, "comment_id": 86708384, "body": "Completely unrelated, but this reminds me of a fun programming puzzle: write a function which takes <code>n</code> and computes the number of trailing zeros in <code>n!</code>. It can be done very efficiently indeed and doesn&#39;t require bignum computations until seriously large <code>n</code>."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1523825620, "post_id": 49846473, "comment_id": 86708249, "body": "I like your <code>CReal</code> answer. I don&#39;t understand your answer about <code>Double</code>s. What are you doing there? What&#39;s it mean in the end? Can it be fixed up by counting?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1523825900, "post_id": 49846473, "comment_id": 86708339, "body": "@dfeuer At the end, it&#39;s off by a factor of 10^400 (=100^200) exactly (plus rounding errors, I guess), so you just need to read the <code>e25</code> as <code>e-375</code> instead."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 5, "last_activity_date": 1523824246, "creation_date": 1523824246, "answer_id": 49846473, "question_id": 49846233, "link": "https://stackoverflow.com/questions/49846233/dividing-by-huge-numbers-in-haskell/49846473#49846473", "title": "Dividing by huge numbers in haskell", "body": "<p>You could use <a href=\"http://hackage.haskell.org/package/numbers-3000.2.0.1/docs/Data-Number-CReal.html\" rel=\"noreferrer\">CReal</a>:</p>\n\n<pre><code>Data.Number.CReal&gt; showCReal 400 (1/product [1..200])\n\"0.0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000012679769534809624217530164\"\nData.Number.CReal&gt; showCReal 30 (1e375/product [1..200])\n\"1.267976953480962421753016371075\"\n</code></pre>\n\n<p>The <code>400</code>/<code>30</code> there is how many digits to show.</p>\n\n<p>If you like the speed of <code>Double</code>, you could consider scaling each number before computing the product.</p>\n\n<pre><code>&gt;  product (map (100/) [1..200])\n1.2679769534809638e25\n</code></pre>\n\n<p>That requires a bit of reinterpretation of the output, though.</p>\n"}], "owner": {"reputation": 43, "user_id": 8093080, "user_type": "registered", "profile_image": "https://graph.facebook.com/1425806460819752/picture?type=large", "display_name": "Reshav Abraham", "link": "https://stackoverflow.com/users/8093080/reshav-abraham"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1523824246, "creation_date": 1523822541, "question_id": 49846233, "link": "https://stackoverflow.com/questions/49846233/dividing-by-huge-numbers-in-haskell", "title": "Dividing by huge numbers in haskell", "body": "<p>How do I get a number in decimal format when performing 1/200!</p>\n\n<pre><code>Prelude&gt;factorial x = product([1..x])\nPrelude&gt;x = factorial 200\nPrelude&gt;1/x\n0.0\n</code></pre>\n"}, {"tags": ["haskell", "newtype", "pattern-synonyms"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 6, "creation_date": 1523819202, "post_id": 49845591, "comment_id": 86706340, "body": "Well a pattern can not contain references to functions, since a pattern contains patterns: a pattern is a composition of variables and constructors."}, {"owner": {"reputation": 123, "user_id": 7542147, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0neeSd5aw-A/AAAAAAAAAAI/AAAAAAAAAPY/NgdRvKzwCB8/photo.jpg?sz=128", "display_name": "Tien Ho", "link": "https://stackoverflow.com/users/7542147/tien-ho"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523819424, "post_id": 49845591, "comment_id": 86706413, "body": "Haskell has this pattern feature where you can alias a data value, just like you would alias a type.<a href=\"https://stackoverflow.com/a/49517076/7542147\">stackoverflow.com/a/49517076/7542147</a>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1523819528, "post_id": 49845591, "comment_id": 86706444, "body": "@TienHo I am confident that Willem knows about that feature, and encourage you to read his comment again carefully. Also generalize &quot;references to functions&quot; -- it also applies to non-function values."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 1, "creation_date": 1523820762, "post_id": 49845591, "comment_id": 86706838, "body": "&quot;this pattern feature where you can alias a data value&quot; No, you can alias <i>patterns</i>. <code>StoreEnv Map.empty</code> is not a pattern."}, {"owner": {"reputation": 123, "user_id": 7542147, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0neeSd5aw-A/AAAAAAAAAAI/AAAAAAAAAPY/NgdRvKzwCB8/photo.jpg?sz=128", "display_name": "Tien Ho", "link": "https://stackoverflow.com/users/7542147/tien-ho"}, "edited": false, "score": 0, "creation_date": 1523824811, "post_id": 49845591, "comment_id": 86708025, "body": "Ok, that makes sense. Thanks for that clarification about pattern synonym. So you cannot pattern match against maps like you would do with list then. Is there a way to alias an empty map?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 8, "creation_date": 1523826960, "post_id": 49845591, "comment_id": 86708642, "body": "@TienHo (I suggest you ask that in a separate question but) you can use a <i>view pattern</i> along with <code>PatternSynonyms</code>&#39;s ability to give separate definitions for the pattern and the value constructor: <code>pattern EmptyStore &lt;- StoreEnv (null -&gt; True) where EmptyStore = StoreEnv Map.empty</code>."}, {"owner": {"reputation": 123, "user_id": 7542147, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0neeSd5aw-A/AAAAAAAAAAI/AAAAAAAAAPY/NgdRvKzwCB8/photo.jpg?sz=128", "display_name": "Tien Ho", "link": "https://stackoverflow.com/users/7542147/tien-ho"}, "edited": false, "score": 0, "creation_date": 1523828073, "post_id": 49845591, "comment_id": 86708916, "body": "Thank you so much. That works perfectly!"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523840914, "post_id": 49845591, "comment_id": 86711515, "body": "@WillemVanOnsem, actually, this error suggests a theoretically possible extension to the pattern language. A <i>qualified</i> name in a pattern could be taken to mean a <i>value</i> that needs to be matched with <code>==</code>. That would generalize the special rule for numeric literals."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1523881009, "post_id": 49845591, "comment_id": 86728604, "body": "@BenjaminHodgson The question has now been edited. (Personally, I&#39;m OK with the edit -- before that, the question was too vague.) Now, your comment could be an answer."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1523887966, "post_id": 49845591, "comment_id": 86733739, "body": "@chi cool, thanks for the heads up. I&#39;ll write something up"}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1523890743, "post_id": 49860014, "comment_id": 86735800, "body": "The last idea, patterns with input and output arguments, is similar to some tricks that can be played with Scala&#39;s extractor object / classes. It is indeed a bit weird :)"}, {"owner": {"reputation": 123, "user_id": 7542147, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0neeSd5aw-A/AAAAAAAAAAI/AAAAAAAAAPY/NgdRvKzwCB8/photo.jpg?sz=128", "display_name": "Tien Ho", "link": "https://stackoverflow.com/users/7542147/tien-ho"}, "edited": false, "score": 0, "creation_date": 1523993258, "post_id": 49860014, "comment_id": 86788123, "body": "Thank you for this thorough answer! What I&#39;m doing right now is just to create a wrapper function for Map.empty for my data type"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 123, "user_id": 7542147, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0neeSd5aw-A/AAAAAAAAAAI/AAAAAAAAAPY/NgdRvKzwCB8/photo.jpg?sz=128", "display_name": "Tien Ho", "link": "https://stackoverflow.com/users/7542147/tien-ho"}, "edited": false, "score": 1, "creation_date": 1523993317, "post_id": 49860014, "comment_id": 86788154, "body": "@TienHo So just use a function, not a pattern synonym: <code>empty = StoreEnv Map.empty</code>"}, {"owner": {"reputation": 123, "user_id": 7542147, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0neeSd5aw-A/AAAAAAAAAAI/AAAAAAAAAPY/NgdRvKzwCB8/photo.jpg?sz=128", "display_name": "Tien Ho", "link": "https://stackoverflow.com/users/7542147/tien-ho"}, "edited": false, "score": 0, "creation_date": 1523994025, "post_id": 49860014, "comment_id": 86788524, "body": "I have one more question. As you mentioned in your post, pattern synonyms are useful for pattern matching on the left of an equation. Then what would be the standard approach to alias a value used on the right hand side? This value is more like a result than a matching pattern I guess. For instance, <code>get _ = Foo 0</code>, and I want to provide a convenient name for <code>Foo 0</code> such as <code>Empty</code>."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 123, "user_id": 7542147, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0neeSd5aw-A/AAAAAAAAAAI/AAAAAAAAAPY/NgdRvKzwCB8/photo.jpg?sz=128", "display_name": "Tien Ho", "link": "https://stackoverflow.com/users/7542147/tien-ho"}, "edited": false, "score": 1, "creation_date": 1523994124, "post_id": 49860014, "comment_id": 86788577, "body": "@TienHo The way to do that is as I suggested above. Define a top level constant <code>fooZero = Foo 0</code>."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 4, "last_activity_date": 1523891175, "last_edit_date": 1523891175, "creation_date": 1523889589, "answer_id": 49860014, "question_id": 49845591, "link": "https://stackoverflow.com/questions/49845591/haskell-qualified-name-in-binding-position-error-with-map-empty/49860014#49860014", "title": "Haskell: &quot;Qualified name in binding position&quot; error with Map.empty", "body": "<h2>Background</h2>\n\n<blockquote>\n  <p>So you cannot pattern match against maps like you would do with list then.</p>\n</blockquote>\n\n<p>That's right. <code>Data.Map.Map</code> is an <a href=\"http://hackage.haskell.org/package/containers-0.5.11.0/docs/Data-Map-Lazy.html#t:Map\" rel=\"nofollow noreferrer\"><em>abstract data type</em></a>, meaning that its representation is hidden. In Haskell that means its constructors aren't exported. You can't write code which inspects the <a href=\"http://hackage.haskell.org/package/containers-0.5.11.0/docs/src/Data.Map.Internal.html#Map\" rel=\"nofollow noreferrer\">balanced binary search tree</a> inside the <code>Map</code> (and you wouldn't want to anyway) - you have to go through its public interface, using the module's exported functions to create, query and manipulate <code>Map</code>s.</p>\n\n<p>Pattern synonyms exist to bridge the gap between ADT programming and the convenient syntax of pattern matching on the left of an equation. You can define some smart patterns as part of your module's API without necessarily coupling the implementation of your ADT to those patterns.</p>\n\n<h2>Your problem</h2>\n\n<p>You're getting that error because syntactically the right-hand side of a pattern synonym has to be a pattern, not an expression. A pattern is (usually) the name of a value constructor applied to some <em>variable binders</em> - that is, in a definition like</p>\n\n<pre><code>getBar (Foo bar baz) = bar\n</code></pre>\n\n<p>the <code>bar</code> and <code>baz</code> on the left-hand side define variables which will be in scope on the right. They are fresh bindings, not references to any <code>bar</code> or <code>baz</code> variables which may exist in some outer scope.</p>\n\n<p>So I think that as well as the syntactic mistake (<code>Map.empty</code> is not a valid name for a local variable, which is why you're getting that error) you've also made a logical one - you wouldn't have been able to refer to <code>Map.empty</code> in that position anyway.</p>\n\n<h2>The fix</h2>\n\n<p>As I suggested in <a href=\"https://stackoverflow.com/questions/49845591/haskell-qualified-name-in-binding-position-error-with-map-empty?noredirect=1#comment86708642_49845591\">my comment</a>, you can patch up your code by using an <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#pattern-synonyms\" rel=\"nofollow noreferrer\"><em>explicitly bidirectional pattern synonym</em></a>. This is a neat feature which lets you give a pattern synonym a different meaning depending on whether it's being used as a pattern (ie in pattern context) or as a value constructor (ie in expression context).</p>\n\n<pre><code>pattern EmptyStore &lt;- StoreEnv (Map.null -&gt; True)\n    where EmptyStore = StoreEnv Map.empty\n</code></pre>\n\n<p>In the first line I'm defining what <code>EmptyStore</code> means when used as a pattern. The <code>Map.null -&gt; True</code> syntax is called a <em>view pattern</em> - it means \"apply the function <a href=\"http://hackage.haskell.org/package/containers-0.5.11.0/docs/Data-Map-Lazy.html#v:null\" rel=\"nofollow noreferrer\"><code>Map.null</code></a> to this piece of the pattern, and match its result with <code>True</code>\". So <code>EmptyStore</code> matches a <code>StoreEnv</code> when the <code>Map</code> inside the <code>StoreEnv</code> is empty.</p>\n\n<p>The second line defines what <code>EmptyStore</code> does when used as an expression. It says that the expression <code>EmptyStore</code> is a synonym for the expression <code>StoreEnv Map.empty</code> - \"create an empty <code>Map</code> and wrap it in a <code>StoreEnv</code>\".</p>\n\n<h2>The un-fix</h2>\n\n<p>However I submit that a pattern synonym API for <code>Map</code> doesn't really make sense. To be usable you should really define a <em>complete</em> set of patterns, so that users have a way to deconstruct any type of <code>Map</code>. The empty case is easy to handle, because there's only one empty <code>Map</code>, but what does it mean to pattern match on a non-empty <code>Map</code>? <code>Map</code>s aren't meant to be ordered containers - there's no \"first-and-rest\" like there is with <code>[]</code>, so this doesn't make sense:</p>\n\n<pre><code>pattern Cons k v rest &lt;- {- what goes here? -}\n    where Cons k v rest = insert k v rest\n</code></pre>\n\n<p>You might instead try to define a pattern which matches when a particular key is present in the map:</p>\n\n<pre><code>pattern Contains k v &lt;- (lookup k -&gt; Just v)\n</code></pre>\n\n<p>but this is not valid Haskell (<code>k</code> is being <em>referred to</em>, when it should be being <em>bound</em>). Even if you could come up with a clever way to express it, such a set of patterns would necessarily be incomplete because you can't write clauses for every possible key.</p>\n\n<p>In other words, I don't think you should be trying to define pattern synonyms for this datatype. Stick with ordinary functions!</p>\n"}], "owner": {"reputation": 123, "user_id": 7542147, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-0neeSd5aw-A/AAAAAAAAAAI/AAAAAAAAAPY/NgdRvKzwCB8/photo.jpg?sz=128", "display_name": "Tien Ho", "link": "https://stackoverflow.com/users/7542147/tien-ho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 742, "favorite_count": 1, "accepted_answer_id": 49860014, "answer_count": 1, "score": 11, "last_activity_date": 1523891175, "creation_date": 1523818135, "last_edit_date": 1523828250, "question_id": 49845591, "link": "https://stackoverflow.com/questions/49845591/haskell-qualified-name-in-binding-position-error-with-map-empty", "title": "Haskell: &quot;Qualified name in binding position&quot; error with Map.empty", "body": "<p>I'm trying to create a pattern synonym for a newtype with an empty map.</p>\n\n<pre><code>{-# Language PatternSynonyms #-}\n\nimport qualified Data.Map as Map\n\nnewtype StoreEnv = StoreEnv (Map.Map Int String)\n   deriving (Eq, Show)\n\npattern EmptyStore :: StoreEnv\npattern EmptyStore = StoreEnv Map.empty\n</code></pre>\n\n<p>I got an error saying \"Qualified name in binding position: Map.empty\" when compiling this. I believe that \"Map.empty\" should belong to the type \"Map.Map Int String\" that I declare in the newtype.</p>\n\n<p>My question is whether there is a way to alias an empty map correctly.</p>\n\n<p>I would appreciate any feedback. </p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 37, "user_id": 9637493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S4fHb.jpg?s=128&g=1", "display_name": "CB17", "link": "https://stackoverflow.com/users/9637493/cb17"}, "edited": false, "score": 0, "creation_date": 1523808632, "post_id": 49843891, "comment_id": 86702647, "body": "Thanks, I&#39;ve been smacking my head off this problem for about an hour trying to understand what the error message wanted me to change"}, {"owner": {"reputation": 37, "user_id": 9637493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S4fHb.jpg?s=128&g=1", "display_name": "CB17", "link": "https://stackoverflow.com/users/9637493/cb17"}, "edited": false, "score": 1, "creation_date": 1523808826, "post_id": 49843891, "comment_id": 86702717, "body": "This is the type sig that gchi gave me flips :: (Eq a) =&gt; [(a,a)] -&gt; [(a,a)]"}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "reply_to_user": {"reputation": 37, "user_id": 9637493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S4fHb.jpg?s=128&g=1", "display_name": "CB17", "link": "https://stackoverflow.com/users/9637493/cb17"}, "edited": false, "score": 2, "creation_date": 1523808922, "post_id": 49843891, "comment_id": 86702754, "body": "@CB17 Haskell&#39;s error messages seem intimidating, but they always tell you exactly what&#39;s wrong. Note how the error is basically telling you that you have any extra layer of list nesting (<code>Couldn&#39;t match expected type `(a, a)&#39; with actual type `[(a, a)]` </code>). At that point, you just need to find where you added an extra list wrapping."}, {"owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "reply_to_user": {"reputation": 37, "user_id": 9637493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S4fHb.jpg?s=128&g=1", "display_name": "CB17", "link": "https://stackoverflow.com/users/9637493/cb17"}, "edited": false, "score": 0, "creation_date": 1523809455, "post_id": 49843891, "comment_id": 86702958, "body": "@CB17 you&#39;re right, I&#39;ve edited for clarity. I hope this is useful to you."}], "tags": [], "owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "is_accepted": true, "score": 2, "last_activity_date": 1523809433, "last_edit_date": 1523809433, "creation_date": 1523807733, "answer_id": 49843891, "question_id": 49843805, "link": "https://stackoverflow.com/questions/49843805/funct-symclosure-issue/49843891#49843891", "title": "Funct symClosure issue", "body": "<p>I think your <code>flips</code> does not do what its signature says it does:</p>\n\n<pre><code>heads :: (Eq a) =&gt; [(a,a)] -&gt; [a]\ntails :: (Eq a) =&gt; [(a,a)] -&gt; [a]\n(++) :: [a] -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>in other words, with your definition this signature is correct:</p>\n\n<pre><code>flips :: [(a, a)] -&gt; [a]\nflips xs = tails xs ++ heads xs\n</code></pre>\n\n<p>Note that you can only call <code>tails</code> and <code>heads</code> on lists of pairs. Also note you can leave out the <code>Eq</code> constraint from all the signatures above.</p>\n\n<p>If you meant to reverse the tuples, you can use zip instead</p>\n\n<pre><code>flips :: [(a, a)] -&gt; [(a, a)]\nflips xs = tails xs `zip` heads xs\n</code></pre>\n\n<p>As for <code>symClosure</code>, taking the definition of <code>flips</code> above, the expression</p>\n\n<pre><code>symClosure xs = [xs ++ (flips xs)]\n</code></pre>\n\n<p>would produce a list with a single element, itself a list of pairs. That explains why it is saying that the <code>(a, a)</code> in your signature does not match the <code>[(a, a)]</code> it infers from the expression. You probably need to leave the brackets out.</p>\n\n<pre><code>symClosure xs = xs ++ flips xs\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 9637493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S4fHb.jpg?s=128&g=1", "display_name": "CB17", "link": "https://stackoverflow.com/users/9637493/cb17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 49843891, "answer_count": 1, "score": 0, "last_activity_date": 1523817860, "creation_date": 1523807202, "last_edit_date": 1523817860, "question_id": 49843805, "link": "https://stackoverflow.com/questions/49843805/funct-symclosure-issue", "title": "Funct symClosure issue", "body": "<p>I'm not sure what this error message wants me to change as I can't see the issue with my code but clearly there's something wrong otherwise it would compile.</p>\n\n<p>Error message:</p>\n\n<pre><code>* Couldn't match expected type `(a, a)' with actual type `[(a, a)]'\n* In the expression: xs ++ (flips xs)\n  In the expression: [xs ++ (flips xs)]\n  In an equation for `symClosure': symClosure xs = [xs ++ (flips xs)]\n* Relevant bindings include\n    xs :: [(a, a)]\nsymClosure :: [(a, a)] -&gt; [(a, a)]\nsymClosure xs = [xs ++ (flips xs)]\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>heads :: (Eq a) =&gt; [(a,a)] -&gt; [a]\nheads xs = [x | (x, _) &lt;- xs]\n\ntails :: (Eq a) =&gt; [(a,a)] -&gt; [a]\ntails xs = [x | (_,x) &lt;- xs]\n\nflips :: [a] -&gt; [(a,a)]\nflips xs = tails xs ++ heads xs\n\nsymClosure :: (Eq a) =&gt; [(a,a)] -&gt; [(a,a)]\nsymClosure xs = [xs ++ (flips xs)]\n</code></pre>\n\n<p>Side note: I can't import anything and I can't change signatures. </p>\n\n<p>Again, any info to help me understand is very much appreciated :)</p>\n"}, {"tags": ["haskell", "recursion", "functional-programming", "mutual-recursion"], "comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 2, "creation_date": 1523806795, "post_id": 49843681, "comment_id": 86702047, "body": "Have you tried evaluating simple expressions, like <code>evens (&#39;a&#39;:&#39;b&#39;:&#39;c&#39;:[])</code>, by hand? At what point does your understanding fail?"}, {"owner": {"reputation": 107, "user_id": 8279634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbe840a45ef3c6753353c2e29c316817?s=128&d=identicon&r=PG&f=1", "display_name": "ArshSoni", "link": "https://stackoverflow.com/users/8279634/arshsoni"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1523806959, "post_id": 49843681, "comment_id": 86702096, "body": "@Bergi It&#39;s more that I don&#39;t understand how the list is moving forward and evaluating all elements. How does it check for even positions even though there is no explicit index checking"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1523807167, "post_id": 49843681, "comment_id": 86702168, "body": "In <code>evens</code>, <code>x</code> is the element at the zero-th position, and <code>xs</code> are the elements from the first position onwards. In the call to <code>odds xs</code>, we moved one element forward through that. Instead of two functions, you could also write a single function with a &quot;boolean index&quot; - a toggle whether you currently are at an odd or an even position in the original array."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1523807241, "post_id": 49843681, "comment_id": 86702192, "body": "Have you seen other examples of recursion over lists (like <code>length</code> or <code>sum</code> or <code>take</code>)?"}, {"owner": {"reputation": 107, "user_id": 8279634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbe840a45ef3c6753353c2e29c316817?s=128&d=identicon&r=PG&f=1", "display_name": "ArshSoni", "link": "https://stackoverflow.com/users/8279634/arshsoni"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1523807612, "post_id": 49843681, "comment_id": 86702332, "body": "@Bergi I haven&#39;t no, I have only recently started looking into Haskell but I found this example very intriguing"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 2, "creation_date": 1523807846, "post_id": 49843681, "comment_id": 86702411, "body": "I see, maybe you should start with something simpler than (I&#39;d recommend <code>length</code>, <code>take</code>, and functions that return the 0th, 1st or 2nd element: <code>head</code>, <code>first</code>, <code>second</code>). You probably need to learn more about pattern matching."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1523828847, "post_id": 49843681, "comment_id": 86709118, "body": "In Haskell, it is very idiomatic to avoid indexing, when possible. In many cases, you do not need it, when you have pattern matching and recursion. (Mutual recursion like this is quite rare, though.) Even in real life, if I had to take the even-indexed cards in a deck, I&#39;d use a &quot;take,discard,take,discard,...&quot; method, I surely would not count the cards to know their index. The Haskell code above roughly does the same thing."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1524801183, "post_id": 49843681, "comment_id": 87126352, "body": "@chi, I&#39;ve not noticed mutual recursion being particularly rare, although it&#39;s not exactly ubiquitous either. Certainly it shows up a lot in <code>Data.Tree</code>, and several key places in <code>Streaming</code>, and in the default definitions of <code>some</code> and <code>many</code>. I wouldn&#39;t be at all surprised to see it elsewhere in parsing-land either, since automaton states can be represented as functions pretty naturally."}], "answers": [{"tags": [], "owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "is_accepted": false, "score": 6, "last_activity_date": 1523810007, "last_edit_date": 1523810007, "creation_date": 1523808446, "answer_id": 49844021, "question_id": 49843681, "link": "https://stackoverflow.com/questions/49843681/getting-even-and-odd-position-of-elements-in-list-haskell-mutual-recursion/49844021#49844021", "title": "Getting even and odd position of elements in list - Haskell Mutual Recursion", "body": "<p>First, let's agree on something: we use 0-based indices most of the time, right? So, if I were to ask you what the element in position 2 is in the list</p>\n\n<pre><code>a : b : c : d : []\n</code></pre>\n\n<p>you would answer <code>c</code>. <strong>EDIT</strong>: if you're not familiar with Haskell notation, <code>:</code> is the list constructor and <code>a : b</code> denotes the list made by prepending <code>a</code> in front of list <code>b</code>.</p>\n\n<p>Moving on to elements in even position, <code>a</code> and <code>c</code> would be the obvious answer, whereas <code>b</code> and <code>d</code> would be in odd position. Let's look at the definition of <code>even</code>. </p>\n\n<pre><code>evens (x:xs) = x:odds xs\nevens [] = []\n</code></pre>\n\n<ul>\n<li><p>The base case is trivial: there is no element in even position in the empty list</p></li>\n<li><p>the inductive case says that the element in position 0 (<code>x</code>) is in even position -- which it is -- and it also says that all the other elements in even position in the list <code>(x:xs)</code> are in odd position in the list <code>xs</code>. Indeed, element in position 2 in list <code>(x:xs)</code> is in position 1 in list <code>xs</code>, the one in position 4 in position 3, and so on and so forth; does that make sense?</p></li>\n</ul>\n\n<p>Using the same reasoning, it follows that elements in odd position in the list <code>(x:xs)</code> are elements in even position in the list <code>xs</code>, which is exactly the definition of <code>odds</code> here above.</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1523828872, "creation_date": 1523828872, "answer_id": 49847123, "question_id": 49843681, "link": "https://stackoverflow.com/questions/49843681/getting-even-and-odd-position-of-elements-in-list-haskell-mutual-recursion/49847123#49847123", "title": "Getting even and odd position of elements in list - Haskell Mutual Recursion", "body": "<p>Use <code>Debug.Trace</code> to see how the indices change with each recursive call. The <code>trace</code> function prints its first argument to standard error before returning its second argument.</p>\n\n<pre><code>import Debug.Trace\n\nevens (x:xs) = x : odds (trace (show (zip [0..] xs)) xs)\nevens [] = []\nodds (_:xs) = evens (trace (show (zip [0..] xs)) xs)\nodds [] = []\n\nmain = print (evens \"abcdefg\")\n</code></pre>\n\n<p>Standard error will show</p>\n\n<pre><code>[(0,'b'),(1,'c'),(2,'d'),(3,'e'),(4,'f'),(5,'g')]\n[(0,'c'),(1,'d'),(2,'e'),(3,'f'),(4,'g')]\n[(0,'d'),(1,'e'),(2,'f'),(3,'g')]\n[(0,'e'),(1,'f'),(2,'g')]\n[(0,'f'),(1,'g')]\n[(0,'g')]\n[]\n</code></pre>\n\n<p>Each time you make a recursive call, the positions of each original item \"shifts\" by one place. <code>g</code>, for instance, is in an even position in the original list, but alternates from even to odd positions in each recursive call.</p>\n"}, {"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 0, "last_activity_date": 1523936387, "last_edit_date": 1523936387, "creation_date": 1523935599, "answer_id": 49869393, "question_id": 49843681, "link": "https://stackoverflow.com/questions/49843681/getting-even-and-odd-position-of-elements-in-list-haskell-mutual-recursion/49869393#49869393", "title": "Getting even and odd position of elements in list - Haskell Mutual Recursion", "body": "<p>Let\u2019s look at a sample evaluation of <code>evens</code> on an input list. I\u2019ll use <code>\"abcde\"</code>\u2014recall that <code>String</code> is an alias for a list of characters <code>[Char]</code>, so this is equivalent to <code>['a', 'b', 'c', 'd', 'e']</code> or <code>'a' : 'b' : 'c' : 'd' : 'e' : []</code>.</p>\n\n<p>We start with the initial input:</p>\n\n<pre><code>evens \"abcde\"\n</code></pre>\n\n<p>Match the first pattern of <code>evens</code>, adding <code>'a'</code> to the beginning of the result and proceeding on the remainder of the list:</p>\n\n<pre><code>evens \"abcde\"\n-------------\n\n-- evens (x : xs) = x : odds xs\n-- x = 'a'\n-- xs = \"bcde\"\n-- evens \"abcde\" = 'a' : odds \"bcde\"\n\n'a' : odds \"bcde\"\n-----------------\n</code></pre>\n\n<p>Match the first pattern of <code>odds</code>, ignoring <code>'b'</code> and proceeding:</p>\n\n<pre><code>'a' : odds \"bcde\"\n      -----------\n\n-- odds (_ : xs) = evens xs\n-- xs = \"cde\"\n-- odds \"bcde\" = evens \"cde\"\n\n'a' : evens \"cde\"\n      -----------\n</code></pre>\n\n<p>First pattern of <code>evens</code>, adding <code>'c'</code>:</p>\n\n<pre><code>'a' : evens \"cde\"\n      -----------\n\n-- evens (x : xs) = x : odds xs\n-- x = 'c'\n-- xs = \"de\"\n-- evens \"cde\" = 'c' : odds \"de\"\n\n'a' : 'c' : odds \"de\"\n      ---------------\n</code></pre>\n\n<p>First pattern of <code>odds</code>, ignoring <code>'d'</code>:</p>\n\n<pre><code>'a' : 'c' : odds \"de\"\n            ---------\n\n-- odds (_ : xs) = evens xs\n-- xs = \"e\"\n-- odds \"de\" = evens \"e\"\n\n'a' : 'c' : evens \"e\"\n            ---------\n</code></pre>\n\n<p>First pattern of <code>evens</code>, adding <code>'e'</code>:</p>\n\n<pre><code>'a' : 'c' : evens \"e\"\n            ---------\n\n-- evens (x : xs) = x : odds xs\n-- x = 'e'\n-- xs = \"\" = []\n-- evens \"e\" = 'e' : odds \"\"\n\n'a' : 'c' : 'e' : odds \"\"\n            -------------\n</code></pre>\n\n<p>Now, finally, the first pattern of <code>odds</code> doesn\u2019t match, because an empty list <code>[]</code> doesn\u2019t match the list constructor <code>_ : _</code>, so we fall through to the second (default) pattern:</p>\n\n<pre><code>'a' : 'c' : 'e' : odds \"\"\n                  -------\n\n-- odds _ = []\n-- odds \"\" = []\n\n'a' : 'c' : 'e' : []\n                  --\n</code></pre>\n\n<p>Giving the final result:</p>\n\n<pre><code>\"ace\"\n</code></pre>\n\n<p>Basically these functions are treating the input as a \u201cstream\u201d of values and producing a stream as a result: <code>evens</code> consumes one element and outputs it to the result, proceeding to take the <code>odds</code> of the remainder; while <code>odds</code> consumes one element and discards it, taking the <code>evens</code> of the remainder.</p>\n\n<p>This doesn\u2019t do any calculation on the indices because it doesn\u2019t have to\u2014it\u2019s just following the structure of the list. By definition, the first value in a list is at an <em>even</em> index (when counting from 0), so <code>evens</code> keeps it and takes the <em>odd</em> indices of the remainder, while <code>odds</code> discards it and takes the <em>even</em> indices of the remainder. Removing each element shifts all the indices down by one\u2014that is, the element that was at index <code>1</code> in the input list is at index <code>0</code> in the tail of the input:</p>\n\n<pre><code>zip [0..] \"abcde\" == [(0, 'a'), (1, 'b'), (2, 'c'), (3, 'd'), (4, 'e')]\n\n'a' 'b' 'c' 'd' 'e'\n 0   1   2   3   4\n |   |   |   |   |\n x   /   /   /   /\n    /   /   /   /\n   /   /   /   /\n  /   /   /   /\n |   |   |   |\n'b' 'c' 'd' 'e'\n 0   1   2   3\n\nzip [0..] \"bcde\" == [(0, 'b'), (1, 'c'), (2, 'd'), (3, 'e')]\n</code></pre>\n\n<p>You could also implement these functions explicitly using indices instead of mutual recursion. With list comprehensions:</p>\n\n<pre><code>evens xs = [x | (i, x) &lt;- zip [0..] xs, even i]\n\nodds xs = [x | (i, x) &lt;- zip [0..] xs, odd i]\n</code></pre>\n\n<p>Or with explicit <code>map</code> and <code>filter</code>:</p>\n\n<pre><code>evens = map snd . filter (even . fst) . zip [0..]\n\nodds = map snd . filter (odd . fst) . zip [0..]\n</code></pre>\n\n<p>Then you could even turn the predicate on the indices into a parameter:</p>\n\n<pre><code>indices f = map snd . filter (f . fst) . zip [0..]\n\nevens = indices even\n\nodds = indices odd\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "is_accepted": false, "score": 0, "last_activity_date": 1524795834, "creation_date": 1524795834, "answer_id": 50054319, "question_id": 49843681, "link": "https://stackoverflow.com/questions/49843681/getting-even-and-odd-position-of-elements-in-list-haskell-mutual-recursion/50054319#50054319", "title": "Getting even and odd position of elements in list - Haskell Mutual Recursion", "body": "<p>Our own language is quite powerful. I was having difficulty with limits when teaching myself calculus until I read one sentence in one paragraph of Newton. It was, of course, in English.</p>\n\n<p>First off, you are correct about the indexing not being used or needed.</p>\n\n<p>Secondly, the code does not know the difference between even or odd and you are again right to question it.</p>\n\n<p>Finally, I modified these slightly to work properly on my implementation.</p>\n\n<pre><code> evens [x] = [x];    evens (x:xs) = x:odds xs\n odds  [x] = [];      odds (_:xs) =  evens xs\n</code></pre>\n\n<p>How they work is evens does the work. It builds the output list. It takes the first item of a list fed it and makes it the first or next item of the output list. It calls odds with the remainder of the list. odds simply returns the tail of what it received back to evens.</p>\n\n<p>Like tail, it discards the first item of what it receives.</p>\n\n<p>evens produces a list with about half of the items discarded. odds produces nothing but does the critical discarding.</p>\n\n<p>If you give evens the list <code>[0,1,2,3,4]</code> it returns every other item starting with <code>0</code>, that is, <code>[0,2,4]</code>. If you give evens the list <code>[1,2,3,4]</code> it returns <code>[1,3]</code> because the list started with and odd number. Wherever evens starts, that's what it produces.</p>\n\n<p>Try either with [1,1,1,1,1] or \"bcdefg\"</p>\n\n<p>The modifications made to the functions reflect what each does respectively with the remaining element. odds discards it, evens attaches it to the end of the output list.</p>\n\n<p>Both functions only work properly if given a list starting with an even number. If given a list with an odd number they work in reverse.</p>\n\n<p>Here is a function that will produce an even or odd list depending on a specified starting number and ending in the specified ending number.</p>\n\n<pre><code>eo s e = [s,s+2..e]\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 8279634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cbe840a45ef3c6753353c2e29c316817?s=128&d=identicon&r=PG&f=1", "display_name": "ArshSoni", "link": "https://stackoverflow.com/users/8279634/arshsoni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4366, "favorite_count": 1, "answer_count": 4, "score": 7, "last_activity_date": 1524795834, "creation_date": 1523806508, "last_edit_date": 1523807816, "question_id": 49843681, "link": "https://stackoverflow.com/questions/49843681/getting-even-and-odd-position-of-elements-in-list-haskell-mutual-recursion", "title": "Getting even and odd position of elements in list - Haskell Mutual Recursion", "body": "<p>I recently started learning Haskell. </p>\n\n<p>I found this code online which returns the elements at all even/odd positions of a list.</p>\n\n<p>It makes use of mutual recursion, but I cannot seem to understand how it works internally.</p>\n\n<pre><code>evens (x:xs) = x:odds xs\nevens _ = []\n\nodds (_:xs) = evens xs\nodds _ = []\n</code></pre>\n\n<p><strong>In particular, I don't understand how the list is moving forward and evaluating all elements. How does it check for even positions even though there is no explicit index checking</strong></p>\n\n<p>Would someone be able to provide insight?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1523799498, "post_id": 49842512, "comment_id": 86699642, "body": "Use a lambda <b><i>.</i></b>"}, {"owner": {"reputation": 121, "user_id": 4994693, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf135adf371897e4c60586e96dabdd11?s=128&d=identicon&r=PG&f=1", "display_name": "Luca9984", "link": "https://stackoverflow.com/users/4994693/luca9984"}, "reply_to_user": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1523799844, "post_id": 49842512, "comment_id": 86699772, "body": "Can you provide a link what (==) does. Google doesn&#39;t provide anything useful."}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1523799881, "post_id": 49842512, "comment_id": 86699783, "body": "Then use <a href=\"https://www.haskell.org/hoogle/?hoogle=%3D%3D\" rel=\"nofollow noreferrer\"><b>H</b>oogle</a>."}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1523799926, "post_id": 49842512, "comment_id": 86699808, "body": "Wait a minute, not <code>==</code> here. What about if-else?"}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1523800025, "post_id": 49842512, "comment_id": 86699835, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/27595064/returning-a-function-in-haskell\">Returning a function in Haskell</a>"}, {"owner": {"reputation": 121, "user_id": 4994693, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf135adf371897e4c60586e96dabdd11?s=128&d=identicon&r=PG&f=1", "display_name": "Luca9984", "link": "https://stackoverflow.com/users/4994693/luca9984"}, "reply_to_user": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 1, "creation_date": 1523800213, "post_id": 49842512, "comment_id": 86699907, "body": "How to return a function is not the question. Its how you can use the parameters of a function to create a new function inside the first."}], "answers": [{"tags": [], "owner": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "is_accepted": false, "score": 1, "last_activity_date": 1523800135, "creation_date": 1523800135, "answer_id": 49842682, "question_id": 49842512, "link": "https://stackoverflow.com/questions/49842512/creating-a-new-function-inside-a-function-based-on-the-parameters-of-the-first/49842682#49842682", "title": "Creating a new function inside a function based on the parameters of the first", "body": "<p>Pattern-matching \"f <em>X</em>\" compares argument with <em>X</em> only if <em>X</em> is a literal or data constructor (like \"True\"). When <em>X</em> is a variable it binds a new variable - in this case another \"x\" which shadows the outer one. You have to use good old comparison. For example, with guards:</p>\n\n<pre><code>f y | x == y = ...\nf _ = ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "is_accepted": true, "score": 3, "last_activity_date": 1523800882, "last_edit_date": 1523800882, "creation_date": 1523800171, "answer_id": 49842688, "question_id": 49842512, "link": "https://stackoverflow.com/questions/49842512/creating-a-new-function-inside-a-function-based-on-the-parameters-of-the-first/49842688#49842688", "title": "Creating a new function inside a function based on the parameters of the first", "body": "<p>Your approach seems to be trying to use <a href=\"http://learnyouahaskell.com/syntax-in-functions\" rel=\"nofollow noreferrer\">pattern matching</a> like it's <a href=\"https://en.wikipedia.org/wiki/Unification_(computer_science)\" rel=\"nofollow noreferrer\">unification</a> - Haskell doesn't perform unification, and pattern matching only works for things like data constructors (eg. <code>Just</code>), not for values.</p>\n\n<hr>\n\n<p>The name <code>x</code> you're using in the inner definition <a href=\"https://stackoverflow.com/questions/2902716/in-haskell-what-does-it-mean-if-a-binding-shadows-an-existing-binding\">shadows</a> the name <code>x</code> used in the outer definition - so your inner function is equivalent to:</p>\n\n<pre><code>f x = 10\n</code></pre>\n\n<p>You should use a different variable name, and make your inner function compare its argument to the outer function's argument:</p>\n\n<pre><code>g x = let f y = if x == y then 10 else 0\n      in f\n</code></pre>\n\n<p>Or using <a href=\"https://stackoverflow.com/questions/6652234/how-does-currying-work\">currying</a>, which is arguably better style:</p>\n\n<pre><code>g x y = if x == y then 10 else 0\n</code></pre>\n\n<p>This is semantically equivalent to the above version, and is also semantically equivalent to a function returning a lambda. We can partially apply <code>g</code> to a value to produce a function taking one parameter, eg:</p>\n\n<pre><code>&gt; (g 3) 4\n0\n&gt; (g \"hi\") \"hi\"\n10\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 767, "user_id": 814796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ZQemO.jpg?s=128&g=1", "display_name": "madgen", "link": "https://stackoverflow.com/users/814796/madgen"}, "is_accepted": false, "score": 1, "last_activity_date": 1523800241, "creation_date": 1523800241, "answer_id": 49842700, "question_id": 49842512, "link": "https://stackoverflow.com/questions/49842512/creating-a-new-function-inside-a-function-based-on-the-parameters-of-the-first/49842700#49842700", "title": "Creating a new function inside a function based on the parameters of the first", "body": "<p>Haskell does not allow unification of variables that share the same name.</p>\n\n<p>For example, <code>f x x = ...</code> is a syntax error rather than to say \"match this case when the first and the second arguments are equal\".</p>\n\n<p>In your case, you have the same conceptual problem but no syntax error because Haskell simply shadows <code>x</code> from <code>g</code> once you try to match it using an argument in <code>f</code>. As matching a variable <code>x</code> without a constructor is unconditional it always succeeds and returns 10.</p>\n\n<p>You want a function like this:</p>\n\n<pre><code>g x = \\y -&gt; if x == y then 10 else 0\n</code></pre>\n\n<p>which uses the <code>(==)</code> operator explicitly.</p>\n"}], "owner": {"reputation": 121, "user_id": 4994693, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf135adf371897e4c60586e96dabdd11?s=128&d=identicon&r=PG&f=1", "display_name": "Luca9984", "link": "https://stackoverflow.com/users/4994693/luca9984"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "accepted_answer_id": 49842688, "answer_count": 3, "score": 1, "last_activity_date": 1523800882, "creation_date": 1523799165, "question_id": 49842512, "link": "https://stackoverflow.com/questions/49842512/creating-a-new-function-inside-a-function-based-on-the-parameters-of-the-first", "title": "Creating a new function inside a function based on the parameters of the first", "body": "<p>So I have a function that returns a function. The returned function <strong>is supposed to return 0 for all inputs except x</strong>. For x it should return 10.</p>\n\n<pre><code>g x = do\n        let \n            f x = 10\n            f _ = 0  \n        f\n</code></pre>\n\n<p>But instead the function always returns 10:</p>\n\n<pre><code>(g 3) 4 \n10\n</code></pre>\n\n<p>It seems that the parameter x is no the same x that gets used to create the function f. So how can I achieve that?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1523790250, "post_id": 49841178, "comment_id": 86696943, "body": "Welcome to StackOverflow. Please have a look at <a href=\"https://stackoverflow.com/help/formatting\">out formatting help</a> to format your future posts."}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1523791464, "post_id": 49841178, "comment_id": 86697277, "body": "You want a fold (i.e. use &quot;foldr&quot;) rather than a map. You want an initial array (e.g. one containing all zeros) and then you have to write a function which takes an array and an entry triple and returns the updated array. Take a look at the type of foldr and see how these plug in to it."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1523820411, "post_id": 49841289, "comment_id": 86706726, "body": "I don&#39;t think there&#39;s any way to get \ud835\udcde(n&#178;) if the input list can contain duplicates. I also don&#39;t understand where you get an <code>n log n</code> term. I&#39;d expect something <code>Map</code>-like to get you 2n&#178; log n extra, and I&#39;d expect an array to get you n&#178; extra. Am I missing something?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1523820576, "post_id": 49841289, "comment_id": 86706784, "body": "@dfeuer Should be k log k +n^2. Sort the tuples (k log k), traverse them as you build the matrix(n^2 since no lookup cost). Duplicates can be handled during the initial sort."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1523822813, "post_id": 49841289, "comment_id": 86707456, "body": "@Zeta, I think I fixed it. My numbers came from the assumption that <code>k = n^2</code>. If there are many duplicates, then sorting is wasteful, and it would be better to use a map to dispose of duplicates along the way. As I mentioned, though, an array seems more appropriate. <code>accumArray</code> should do the trick."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 1, "last_activity_date": 1523822637, "last_edit_date": 1523822637, "creation_date": 1523790947, "answer_id": 49841289, "question_id": 49841178, "link": "https://stackoverflow.com/questions/49841178/list-of-tuples-to-2d-array/49841289#49841289", "title": "List of tuples to 2D array", "body": "<p>The simplest way to achieve this is to change entry to check whether <em>any</em> tuple <code>(x,y,v)</code> exists in a given list:</p>\n\n<pre><code>buildMatrix :: Int -&gt; [(Int, Int, Int)] -&gt; [[Int]]\nbuildMatrix n xs = [ [ entry row column | column &lt;- [1..n] ] | row &lt;- [1..n] ]\n  where\n    entry x y = maybe 0 id (findValue x y xs)\n    findValue x y [] = Nothing\n    findValue x y ((i,j,v):xs')\n       | x == i &amp;&amp; y == j = Just v\n       | otherwise        = findValue x y xs'\n</code></pre>\n\n<p>However that's a little bit of a hassle. There is already <code>lookup :: Eq a =&gt; a -&gt; [(a,b)] -&gt; Maybe b</code>, and our <code>findValue</code> looks almost the same. So let's use that one instead:</p>\n\n<pre><code>buildMatrix :: Int -&gt; [(Int, Int, Int)] -&gt; [[Int]]\nbuildMatrix n xs = [ [ entry row column | column &lt;- [1..n] ] | row &lt;- [1..n] ]\n  where\n    entry x y = maybe 0 id (lookup (x,y) (indexed xs))\n    indexed   = map (\\(x,y,v) -&gt; ((x,y),v))\n</code></pre>\n\n<p>That's one way to achive your goal. Unfortunately, this algorithm has a worst-case time-complexity of \ud835\udcde(n\u00b2k), where <code>n</code> is your matrix size and <code>k</code> is the number of elements in <code>xs</code>. One can choose another algorithm to improve it to \ud835\udcde(n\u00b2+k log k)=\ud835\udcde(n\u00b2), but that's left as an exercise.</p>\n"}], "owner": {"reputation": 81, "user_id": 9648495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/608fda19c26bcb394b457200434bd69f?s=128&d=identicon&r=PG&f=1", "display_name": "WhiteW", "link": "https://stackoverflow.com/users/9648495/whitew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 593, "favorite_count": 0, "accepted_answer_id": 49841289, "answer_count": 1, "score": 1, "last_activity_date": 1523822637, "creation_date": 1523790043, "last_edit_date": 1523797786, "question_id": 49841178, "link": "https://stackoverflow.com/questions/49841178/list-of-tuples-to-2d-array", "title": "List of tuples to 2D array", "body": "<p>I would like to create a matrix from a given list of tuples.\nA tuple has <code>(row, column, value)</code> and I want to create <code>matrix[row][column] = value</code> with:</p>\n\n<pre><code>buildMatrix :: Int-&gt; [(Int, Int, Int)] -&gt; [[Int]]\n</code></pre>\n\n<p>For example, given:</p>\n\n<pre><code>n = 3 (size of matrix)\nlist = [(1,2,1), (1,3,-1), (2,3,1)],\n</code></pre>\n\n<p>I would like to get</p>\n\n<pre><code>matrix = [[0,1,-1], [0,0,1], [0,0,0]]\n</code></pre>\n\n<p>What I tried so far: </p>\n\n<pre><code>buildMatrix n (i, j, v) = [ [ entry row column | column &lt;- [1..n] ] | row &lt;- [1..n] ]\n    where\n    entry x y\n       | x == i &amp;&amp; y == j = v\n       | otherwise = 0\n</code></pre>\n\n<p>I am stuck at applying the function for each tuple, I was thinking about using map.</p>\n"}, {"tags": ["haskell", "ghc"], "answers": [{"comments": [{"owner": {"reputation": 5189, "user_id": 5223757, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FdOvO.png?s=128&g=1", "display_name": "wizzwizz4", "link": "https://stackoverflow.com/users/5223757/wizzwizz4"}, "edited": false, "score": 3, "creation_date": 1523805359, "post_id": 49839469, "comment_id": 86701567, "body": "You say &quot;almost a coincidence&quot;; why &quot;almost&quot;?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 5189, "user_id": 5223757, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FdOvO.png?s=128&g=1", "display_name": "wizzwizz4", "link": "https://stackoverflow.com/users/5223757/wizzwizz4"}, "edited": false, "score": 3, "creation_date": 1523805940, "post_id": 49839469, "comment_id": 86701762, "body": "@wizzwizz4 Just hedging so I don&#39;t get a comment like well <i>actually</i>, since + is commutative and asso..."}, {"owner": {"reputation": 5189, "user_id": 5223757, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/FdOvO.png?s=128&g=1", "display_name": "wizzwizz4", "link": "https://stackoverflow.com/users/5223757/wizzwizz4"}, "edited": false, "score": 0, "creation_date": 1523806584, "post_id": 49839469, "comment_id": 86701987, "body": "But that comment would be informative. Could you provide it please? \ud83e\udd7a"}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 26, "last_activity_date": 1523974745, "last_edit_date": 1523974745, "creation_date": 1523777147, "answer_id": 49839469, "question_id": 49839049, "link": "https://stackoverflow.com/questions/49839049/defining-strict-application-myself-does-not-result-in-the-same-performance/49839469#49839469", "title": "Defining strict application ($!) myself does not result in the same performance", "body": "<p><em>Aha!</em>  It's a precedence issue.  You forgot to paste the line:</p>\n\n<pre><code>infixr 0  $!\n</code></pre>\n\n<p>and so when you use your own version, it gets parsed as</p>\n\n<pre><code>go (x:xs) total = (go xs $! total) + x\n</code></pre>\n\n<p>which obviously has terrible performance.  It's almost a coincidence that it even gives you the right answer.</p>\n"}], "owner": {"reputation": 383, "user_id": 5181829, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LQG85.jpg?s=128&g=1", "display_name": "Marronnier", "link": "https://stackoverflow.com/users/5181829/marronnier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 585, "favorite_count": 0, "answer_count": 1, "score": 19, "last_activity_date": 1523974745, "creation_date": 1523773027, "last_edit_date": 1523803713, "question_id": 49839049, "link": "https://stackoverflow.com/questions/49839049/defining-strict-application-myself-does-not-result-in-the-same-performance", "title": "Defining strict application ($!) myself does not result in the same performance", "body": "<p>I'm reading <a href=\"https://www.fpcomplete.com/blog/2017/09/all-about-strictness\" rel=\"noreferrer\">this blog post by Michael Snoyman</a> recently. In an exercise suggested there, I tried to define <code>$!</code> operator by myself:</p>\n\n<pre><code>import Prelude hiding ( ($!) )\n\n($!) :: (a -&gt; b) -&gt; a -&gt; b\n($!) f x = x `seq` f x\n\nmysum :: [Int] -&gt; Int\nmysum list0 =\n  go list0 0\n  where\n    go [] total = total\n    go (x:xs) total = go xs $! total + x\n\nmain = print $ mysum [1..1000000]\n</code></pre>\n\n<p>I thought this works well, though the usage of memory was terrible. My first question is this. Why didn't this work well?</p>\n\n<p>Then, I checked its definition in Prelude. It reads:</p>\n\n<pre><code>($!)                    :: (a -&gt; b) -&gt; a -&gt; b\nf $! x                  = let !vx = x in f vx  -- see #2273\n</code></pre>\n\n<p>So, I copied it into my code:</p>\n\n<pre><code>{-# LANGUAGE BangPatterns #-}\n\nimport Prelude hiding ( ($!) )\n\n($!) :: (a -&gt; b) -&gt; a -&gt; b\n($!) f x =\n  let !vx = x\n   in f vx\n\nmysum :: [Int] -&gt; Int\nmysum list0 =\n  go list0 0\n  where\n    go [] total = total\n    go (x:xs) total = go xs $! total + x\n\nmain = print $ mysum [1..1000000]\n</code></pre>\n\n<p>and the result was:</p>\n\n<pre><code>Linking mysum4 ...\n500000500000\n     209,344,064 bytes allocated in the heap\n     130,602,696 bytes copied during GC\n      54,339,936 bytes maximum residency (8 sample(s))\n          66,624 bytes maximum slop\n              80 MB total memory in use (0 MB lost due to fragmentation)\n</code></pre>\n\n<p>You can see how terrible this is compared to the result of using Prelude's <code>$!</code> operator:</p>\n\n<pre><code>Linking mysum4 ...\n500000500000\n     152,051,776 bytes allocated in the heap\n          41,752 bytes copied during GC\n          44,384 bytes maximum residency (2 sample(s))\n          21,152 bytes maximum slop\n               1 MB total memory in use (0 MB lost due to fragmentation)\n</code></pre>\n\n<p>My second question is where did this difference come from?</p>\n\n<p>Furthermore, I think it can be re-written like this:</p>\n\n<pre><code>($!) :: (a -&gt; b) -&gt; a -&gt; b\nf $! !x = f x\n</code></pre>\n\n<p>Is there any reason not to do this? This is my third question.</p>\n"}, {"tags": ["haskell", "nix", "nixpkgs"], "answers": [{"tags": [], "owner": {"reputation": 12964, "user_id": 704015, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/rpCnn.png?s=128&g=1", "display_name": "Jezen Thomas", "link": "https://stackoverflow.com/users/704015/jezen-thomas"}, "is_accepted": false, "score": 0, "last_activity_date": 1523774574, "creation_date": 1523774574, "answer_id": 49839195, "question_id": 49838941, "link": "https://stackoverflow.com/questions/49838941/overriding-nixpkgs-with-a-forked-haskell-package/49839195#49839195", "title": "Overriding nixpkgs with a forked Haskell package", "body": "<p>I had this answered on IRC.</p>\n\n<p>I am overriding haskellPackages, but then because I set the compiler to <code>ghc822</code>, I don't actually use the overridden packages, because of this conditional:</p>\n\n<pre><code>haskellPackages = if compiler == \"default\"\n                       then pkgs.haskellPackages\n                       else pkgs.haskell.packages.${compiler};\n</code></pre>\n"}], "owner": {"reputation": 12964, "user_id": 704015, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/rpCnn.png?s=128&g=1", "display_name": "Jezen Thomas", "link": "https://stackoverflow.com/users/704015/jezen-thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 380, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1523850639, "creation_date": 1523771887, "last_edit_date": 1523850639, "question_id": 49838941, "link": "https://stackoverflow.com/questions/49838941/overriding-nixpkgs-with-a-forked-haskell-package", "title": "Overriding nixpkgs with a forked Haskell package", "body": "<p>I am trying to override a Haskell package in nixpkgs with my own fork. The code I have seems to work; I can see the new fork building. However, when I open a <code>nix-shell</code>, I don't have the right package version.</p>\n\n<p>Here is my <code>shell.nix</code> file.</p>\n\n<pre><code>{\n  nixpkgs ? import &lt;nixpkgs&gt; {\n    config = {\n      packageOverrides = super: let self = super.pkgs; in {\n        haskellPackages = super.haskellPackages.override {\n          overrides = self: super: {\n            persistent = self.callPackage ../persistent/persistent/persistent.nix {};\n          };\n        };\n      };\n    };\n  }\n  , compiler ? \"ghc822\"\n  , doBenchmark ? false\n  , withHoogle ? true\n}:\n\nlet\n\n  inherit (nixpkgs) pkgs;\n\n  f = { mkDerivation, aeson, base, base16-bytestring\n      , base64-bytestring, blaze-html, bytestring, case-insensitive\n      , classy-prelude, classy-prelude-conduit, classy-prelude-yesod\n      , clientsession, conduit, containers, cryptohash, curl\n      , data-default, directory, email-validate, errors, fast-logger\n      , file-embed, foreign-store, hjsmin, hspec, http-client\n      , http-client-tls, http-conduit, lens, mime-mail, mime-mail-ses\n      , monad-control, monad-logger, persistent, persistent-postgresql\n      , persistent-template, pwstore-fast, random, rollbar, safe\n      , shakespeare, stdenv, template-haskell, text, time\n      , unordered-containers, utf8-string, uuid, vector, wai, wai-extra\n      , wai-logger, warp, yaml, yesod, yesod-auth, yesod-core, yesod-form\n      , yesod-static, yesod-test\n      }:\n      mkDerivation {\n        pname = \"app\";\n        version = \"0.0.0\";\n        src = ./.;\n        isLibrary = true;\n        isExecutable = true;\n        enableSeparateDataOutput = true;\n        buildDepends = [ pkgs.postgresql ];\n        libraryHaskellDepends = [\n          aeson base base16-bytestring base64-bytestring blaze-html\n          bytestring case-insensitive classy-prelude classy-prelude-conduit\n          classy-prelude-yesod clientsession conduit containers cryptohash\n          curl data-default directory email-validate errors fast-logger\n          file-embed foreign-store hjsmin http-client http-client-tls\n          http-conduit lens mime-mail mime-mail-ses monad-control\n          monad-logger persistent persistent-postgresql persistent-template\n          pwstore-fast random rollbar safe shakespeare template-haskell text\n          time unordered-containers utf8-string uuid vector wai wai-extra\n          wai-logger warp yaml yesod yesod-auth yesod-core yesod-form\n          yesod-static\n        ];\n        executableHaskellDepends = [\n          aeson base bytestring case-insensitive classy-prelude\n          classy-prelude-conduit classy-prelude-yesod conduit containers\n          data-default directory fast-logger file-embed foreign-store hjsmin\n          http-conduit monad-control monad-logger persistent\n          persistent-postgresql persistent-template safe shakespeare\n          template-haskell text time unordered-containers vector wai\n          wai-extra wai-logger warp yaml yesod yesod-auth yesod-core\n          yesod-form yesod-static\n        ];\n        testHaskellDepends = [\n          aeson base bytestring case-insensitive classy-prelude\n          classy-prelude-conduit classy-prelude-yesod conduit containers\n          data-default directory fast-logger file-embed foreign-store hjsmin\n          hspec http-conduit monad-control monad-logger persistent\n          persistent-postgresql persistent-template safe shakespeare\n          template-haskell text time unordered-containers uuid vector wai\n          wai-extra wai-logger warp yaml yesod yesod-auth yesod-core\n          yesod-form yesod-static yesod-test\n        ];\n        license = stdenv.lib.licenses.gpl3;\n      };\n\n  haskellPackages = if compiler == \"default\"\n                       then pkgs.haskellPackages\n                       else pkgs.haskell.packages.${compiler};\n\n  variant = if doBenchmark then pkgs.haskell.lib.doBenchmark else pkgs.lib.id;\n\n  drv = variant (haskellPackages.callPackage f {});\n\nin\n\n  if pkgs.lib.inNixShell then drv.env else drv\n</code></pre>\n\n<p>The version number in my fork of <em>persistent</em> is <code>2.8.2</code>, but when I run <code>ghc-pkg list</code> in the <code>nix-shell</code>, I see <code>persistent-2.7.1</code>. Why is that?</p>\n\n<p>The nix expression in my fork looks like this:</p>\n\n<pre><code>{ mkDerivation, aeson, attoparsec, base, base64-bytestring\n, blaze-html, blaze-markup, bytestring, conduit, containers\n, fast-logger, haskell-src-meta, hspec, http-api-data\n, monad-control, monad-logger, mtl, old-locale, path-pieces\n, resource-pool, resourcet, scientific, silently, stdenv, tagged\n, template-haskell, text, time, transformers, unliftio-core\n, unordered-containers, vector, void\n}:\nmkDerivation {\n  pname = \"persistent\";\n  version = \"2.8.2\";\n  src = ./.;\n  libraryHaskellDepends = [\n    aeson attoparsec base base64-bytestring blaze-html blaze-markup\n    bytestring conduit containers fast-logger haskell-src-meta\n    http-api-data monad-logger mtl old-locale path-pieces resource-pool\n    resourcet scientific silently tagged template-haskell text time\n    transformers unliftio-core unordered-containers vector void\n  ];\n  testHaskellDepends = [\n    aeson attoparsec base base64-bytestring blaze-html bytestring\n    conduit containers fast-logger hspec http-api-data monad-control\n    monad-logger mtl old-locale path-pieces resource-pool resourcet\n    scientific tagged template-haskell text time transformers\n    unordered-containers vector\n  ];\n  homepage = \"http://www.yesodweb.com/book/persistent\";\n  description = \"Type-safe, multi-backend data serialization\";\n  license = stdenv.lib.licenses.mit;\n}\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1523743832, "post_id": 49836454, "comment_id": 86688477, "body": "Which result do you get with <code>getCurrentDirectory &gt;&gt;= getDirectoryContents &gt;&gt;= filterM doesFileExist</code>?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 2, "creation_date": 1523744684, "post_id": 49836454, "comment_id": 86688684, "body": "What&#39;s your code exactly? I&#39;m finding your question a little hard to follow."}, {"owner": {"reputation": 129, "user_id": 9422370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8dc0cbca85c313f2bba8a7519e41cb6?s=128&d=identicon&r=PG&f=1", "display_name": "Arii", "link": "https://stackoverflow.com/users/9422370/arii"}, "edited": false, "score": 1, "creation_date": 1523745727, "post_id": 49836454, "comment_id": 86688939, "body": "directory x = do ---     dir &lt;- getDirectoryContents x ---       xs &lt;- filterM doesFileExist dir ---     out &lt;- stream xs ---     return out  ---    (Sorry, I don&#39;t know how to linebreak comments and have a remarkably poor grasp of pointfree style)"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1523747072, "post_id": 49836454, "comment_id": 86689204, "body": "@Arii it would be better just to edit your post, but here it&#39;s OK."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1523748366, "post_id": 49836454, "comment_id": 86689450, "body": "@Arii The pointful do-block equivalent of the code in my comment would be <code>do { dir &lt;- getCurrentDirectory; entries &lt;- getDirectoryContents; filterM doesFileExist entries }</code>"}], "answers": [{"comments": [{"owner": {"reputation": 129, "user_id": 9422370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8dc0cbca85c313f2bba8a7519e41cb6?s=128&d=identicon&r=PG&f=1", "display_name": "Arii", "link": "https://stackoverflow.com/users/9422370/arii"}, "edited": false, "score": 0, "creation_date": 1523745556, "post_id": 49836535, "comment_id": 86688893, "body": "... What? <code>getDirectoryContents</code> returns <code>[FilePath]</code> and both <code>readFile</code> and <code>doesFileExist</code> takes a <code>FilePath</code>... I have no idea what you&#39;re trying to say."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 129, "user_id": 9422370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8dc0cbca85c313f2bba8a7519e41cb6?s=128&d=identicon&r=PG&f=1", "display_name": "Arii", "link": "https://stackoverflow.com/users/9422370/arii"}, "edited": false, "score": 1, "creation_date": 1523746319, "post_id": 49836535, "comment_id": 86689043, "body": "@Arii <code>getDirectoryContents foo</code> returns <code>FilePath</code>s that are relative to <code>foo</code>, but <code>doesFileExist</code> treats relative filepaths as being relative to the current directory (which may be different from <code>foo</code>)."}, {"owner": {"reputation": 129, "user_id": 9422370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8dc0cbca85c313f2bba8a7519e41cb6?s=128&d=identicon&r=PG&f=1", "display_name": "Arii", "link": "https://stackoverflow.com/users/9422370/arii"}, "edited": false, "score": 0, "creation_date": 1523746707, "post_id": 49836535, "comment_id": 86689125, "body": "Ah, okay, that makes much more sense. I suppose the follow up would be, how do I go about solving that?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 129, "user_id": 9422370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8dc0cbca85c313f2bba8a7519e41cb6?s=128&d=identicon&r=PG&f=1", "display_name": "Arii", "link": "https://stackoverflow.com/users/9422370/arii"}, "edited": false, "score": 2, "creation_date": 1523747226, "post_id": 49836535, "comment_id": 86689231, "body": "@Arii If <code>bar</code> is a list element returned from <code>getDirectoryContents foo</code>, then <code>foo &lt;&#47;&gt; bar</code> will be an absolute path to <code>bar</code>."}, {"owner": {"reputation": 129, "user_id": 9422370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8dc0cbca85c313f2bba8a7519e41cb6?s=128&d=identicon&r=PG&f=1", "display_name": "Arii", "link": "https://stackoverflow.com/users/9422370/arii"}, "edited": false, "score": 0, "creation_date": 1523747392, "post_id": 49836535, "comment_id": 86689263, "body": "Got it, <code>withCurrentDirectory</code>. Everything&#39;s good. Now, I&#39;m a bit of a noob here, should I mark this as the answer if the answer was in the comments? EDIT: Oh, yeah, that works too."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8174234"}, "is_accepted": true, "score": 4, "last_activity_date": 1523744007, "last_edit_date": 1523744007, "creation_date": 1523742783, "answer_id": 49836535, "question_id": 49836454, "link": "https://stackoverflow.com/questions/49836454/doesfileexist-not-finding-files-that-exist/49836535#49836535", "title": "doesFileExist not finding files that exist", "body": "<blockquote>\n  <p>Why does the function say they don't?</p>\n</blockquote>\n\n<p>Because <code>getDirectoryContents</code> returns the file and directory names, not the full filepath. To see that, try something like:</p>\n\n<pre><code>\u03bb:&gt; getDirectoryContents \"test\"\n[\"data\",\"..\",\"test.dats\",\".\"]\n</code></pre>\n"}], "owner": {"reputation": 129, "user_id": 9422370, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8dc0cbca85c313f2bba8a7519e41cb6?s=128&d=identicon&r=PG&f=1", "display_name": "Arii", "link": "https://stackoverflow.com/users/9422370/arii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 0, "accepted_answer_id": 49836535, "answer_count": 1, "score": 2, "last_activity_date": 1523744007, "creation_date": 1523742073, "question_id": 49836454, "link": "https://stackoverflow.com/questions/49836454/doesfileexist-not-finding-files-that-exist", "title": "doesFileExist not finding files that exist", "body": "<p>So I have a directory, /test, and in it are the following files:  </p>\n\n<pre><code>test.txt  \nBasicLoop.vm  \nFibonacciSeries.vm  \nStackTest.vm  \ntest.vm\n</code></pre>\n\n<p>I'm trying to read all the .vm files into one massive string, and in order to do so I thought to use <code>filterM doesFileExist dir</code> where <code>dir</code> is the result of <code>getDirectoryContents</code>, to remove directories and symlinks and whatever, but when I test it, the result of that filter is just BasicLoop.vm and test.vm. None of them are empty, and they show up when I peek at the contents of <code>dir</code>, so they clearly do exist. Why does the function say they don't?</p>\n"}, {"tags": ["haskell", "types", "ghc"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1523718552, "post_id": 49832804, "comment_id": 86680997, "body": "The answer to this good question is not all that interesting: that happens merely due to a technicality called the <i>monomorphism restriction</i>. For a detailed explanation of the reason why the behaviour is different, go to the &quot;When does it happen?&quot; section of the answer to the linked question. You can tell GHC to use the more general type in all cases by adding the corresponding type signature -- e.g. <code>f2&#39; :: Num a =&gt; a -&gt; a</code>"}, {"owner": {"reputation": 1165, "user_id": 9185760, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7b89b6d9460740a1425bcc9efb89b9c3?s=128&d=identicon&r=PG&f=1", "display_name": "DonJoe", "link": "https://stackoverflow.com/users/9185760/donjoe"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1523718584, "post_id": 49832804, "comment_id": 86681006, "body": "I understand this is a duplicate question, but you know how it is when you don&#39;t know something good enough in order to make a good question."}, {"owner": {"reputation": 1165, "user_id": 9185760, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7b89b6d9460740a1425bcc9efb89b9c3?s=128&d=identicon&r=PG&f=1", "display_name": "DonJoe", "link": "https://stackoverflow.com/users/9185760/donjoe"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1523718623, "post_id": 49832804, "comment_id": 86681017, "body": "I understand now. Thanks for your help."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 8, "creation_date": 1523719200, "post_id": 49832804, "comment_id": 86681187, "body": "You&#39;re welcome. (By the way, don&#39;t worry about having posted a duplicate question. Non-obvious duplicates are useful as a signpost for people who land in them; furthermore, the answer here is arcane enough that it would be unreasonable to expect you to have guessed what to look for.)"}], "owner": {"reputation": 1165, "user_id": 9185760, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7b89b6d9460740a1425bcc9efb89b9c3?s=128&d=identicon&r=PG&f=1", "display_name": "DonJoe", "link": "https://stackoverflow.com/users/9185760/donjoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "closed_date": 1523718359, "answer_count": 0, "score": 6, "last_activity_date": 1523718717, "creation_date": 1523717919, "last_edit_date": 1523718717, "question_id": 49832804, "link": "https://stackoverflow.com/questions/49832804/lambda-expression-in-haskell-has-different-type", "closed_reason": "Duplicate", "title": "Lambda expression in haskell has different type", "body": "<p>I am trying to learn Haskell.</p>\n\n<p>We have very simple functions. As I understood all the following are equivalent.</p>\n\n<p>But I don't understand why <code>f2</code> and <code>f2'</code> have different types, and why exactly <code>Integer</code>.</p>\n\n<p>Also, if I specify the type of <code>f2'</code> manually, it accepts it and works same as <code>f2</code>.</p>\n\n<pre><code>f x = x + 1\n-- f :: Num a =&gt; a -&gt; a\n\nf' = \\x -&gt; x + 1\n-- f' :: Num a =&gt; a -&gt; a\n\nf2 a b = a + b\n-- f2 :: Num a =&gt; a -&gt; a -&gt; a\n\nf2' = \\a b -&gt; a + b\n-- f2 :: Integer -&gt; Integer -&gt; Integer\n\nf2'' = \\a -&gt; \\b -&gt; a + b\n-- f2 :: Integer -&gt; Integer -&gt; Integer\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1523713719, "post_id": 49832101, "comment_id": 86679520, "body": "Your <code>cartInf2</code> is equivalent to <code>cartInf2&#39; (x:xs) ys = map (\\y-&gt;[x,y]) ys</code>. Some pairs are never listed. <a href=\"https://tio.run/##y0gszk7Nyfn/PzmxqMQzL81IoaJYobJYwRZE29nZKmjEVCjo2nEpoINKmHQlUFohOrpCpzI2VlOTiwtmkLqCRoVVRbEmxLTcxAKQWl07sEKQIBdXbmJmHlAqJR9oekFRZl6JgopCSWJ2qoKRAZAFd5BCtJGeXqxCtDGQxKtSHVnl//8A\" title=\"Haskell \u2013 Try It Online\" rel=\"nofollow noreferrer\">Try it online!</a>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1523713904, "post_id": 49832101, "comment_id": 86679570, "body": "I&#39;d start <a href=\"https://en.wikipedia.org/wiki/Cartesian_product#Infinite_Cartesian_products\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 3, "creation_date": 1523714005, "post_id": 49832101, "comment_id": 86679605, "body": "There are uncountably many elements. It&#39;s guaranteed that some element will not be listed."}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 2, "creation_date": 1523715455, "post_id": 49832101, "comment_id": 86680021, "body": "How do you plan to use such data structure, given that it&#39;d be uncoutable? Maybe the problem you&#39;re trying to solve with this Cartesian product has a different, simpler/better solution."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523716757, "post_id": 49832101, "comment_id": 86680403, "body": "Since the number of lists is infinite as well, this set is uncountable, hence there are elements that will <i>never</i> be emitted."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1523721152, "post_id": 49832101, "comment_id": 86681783, "body": "You might be looking for <a href=\"http://hackage.haskell.org/package/control-monad-omega-0.3.1/docs/Control-Monad-Omega.html\" rel=\"nofollow noreferrer\"><code>Control.Monad.Omega</code></a> or <a href=\"http://hackage.haskell.org/package/weighted-search-0.1.0.1\" rel=\"nofollow noreferrer\"><code>Control.Monad.WeightedSearch</code></a>, if you want a sort of fair interleaving between infinitely many cases."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1523771768, "post_id": 49832101, "comment_id": 86692795, "body": "Can you show 5-6 initial elements of the desired cartesian product? Assume all input lists are <code>[1..]</code>."}], "answers": [{"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 1, "last_activity_date": 1523769358, "creation_date": 1523769358, "answer_id": 49838719, "question_id": 49832101, "link": "https://stackoverflow.com/questions/49832101/haskell-cartesian-product-of-infinite-amount-of-infinite-lists/49838719#49838719", "title": "Haskell Cartesian product of infinite amount of infinite lists", "body": "<p>First of all, <code>cartInf</code> does not actually work.</p>\n\n<pre><code>ghci&gt; take 100 $ cartInf2 [1..] [1..]\n[[1,1],[1,2],[1,3],[1,4],[1,5],[1,6],[1,7],[1,8],[1,9],[1,10],[1,11],[1,12], \n[1,13],[1,14],[1,15],[1,16],[1,17],[1,18],[1,19],[1,20],[1,21],[1,22],[1,23], \n[1,24],[1,25],[1,26],[1,27],[1,28],[1,29],[1,30],[1,31],[1,32],[1,33],[1,34], \n...\n</code></pre>\n\n<p>We will never reach a point where the first element is anything but <code>1</code>.  As @chi recommends you can use <a href=\"http://hackage.haskell.org/package/control-monad-omega-0.3.1/docs/Control-Monad-Omega.html\" rel=\"nofollow noreferrer\"><code>Control.Monad.Omega</code></a> or <a href=\"http://hackage.haskell.org/package/weighted-search-0.1.0.1\" rel=\"nofollow noreferrer\"><code>Control.Monad.WeightedSearch</code></a> if you want every pair to appear in the result eventually.</p>\n\n<p>Secondly, the cartesian product of infinitely many lists is not countable (as long as they have at least two elements), as <a href=\"https://en.wikipedia.org/wiki/Cantor%27s_diagonal_argument\" rel=\"nofollow noreferrer\">proved by Cantor in 1891</a>.  Suppose we had</p>\n\n<pre><code>allBoolLists :: [[Bool]]\nallBoolLists = cartesianProduct (repeat [True,False])\n</code></pre>\n\n<p>which would be the list of \"all infinite lists of booleans\".  No such list can exist, because we can construct</p>\n\n<pre><code>bad :: [Bool]\nbad = zipWith negateNth [0..] allBoolLists\n    where\n    -- negates the nth element of a list\n    negateNth n xs = take n xs ++ not (xs !! n) ++ drop (n+1) xs\n</code></pre>\n\n<p>which differs from every element of <code>allBoolLists</code> -- it differs from the 0th element at position 0, the 1st element at position 1, and so on.</p>\n"}], "owner": {"reputation": 99, "user_id": 5143570, "user_type": "registered", "profile_image": "https://graph.facebook.com/10203335308343372/picture?type=large", "display_name": "Laci Feldsam", "link": "https://stackoverflow.com/users/5143570/laci-feldsam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1523769358, "creation_date": 1523713469, "question_id": 49832101, "link": "https://stackoverflow.com/questions/49832101/haskell-cartesian-product-of-infinite-amount-of-infinite-lists", "title": "Haskell Cartesian product of infinite amount of infinite lists", "body": "<p>Hi I want to ask if it is possible to create a Cartesian product of Infinite amount of infinite lists.</p>\n\n<p>Sequence is a good function as example what I want. But I want it to work on Infinites.</p>\n\n<p>I know how to do Cartesian of two infinite lists. </p>\n\n<pre><code>cartInf2 xs ys = xs &gt;&gt;= (\\x -&gt;\n                 ys &gt;&gt;= (\\y -&gt; [[x,y]]))\n</code></pre>\n\n<p>Also I cant figure out how to do Cartesian of any amount of infinite list</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1523713575, "post_id": 49832067, "comment_id": 86679482, "body": "You have used the constructors <code>Node</code> and <code>Null</code> of the type <code>Tree</code>, but there is a third one."}, {"owner": {"reputation": 2287, "user_id": 5267751, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd62e8fd8fbb37abc7e2a39d23828047?s=128&d=identicon&r=PG&f=1", "display_name": "user202729", "link": "https://stackoverflow.com/users/5267751/user202729"}, "edited": false, "score": 0, "creation_date": 1523713928, "post_id": 49832067, "comment_id": 86679581, "body": "What you write there depends on what you want. Why asking us?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1523757269, "post_id": 49832067, "comment_id": 86690797, "body": "@epsilonhalbe, I actually think the hints look very badly structured, going in all sorts of different directions. I personally hint from left to right, which is also how I code. Show the patterns and let the learner figure out what&#39;s supposed to happen with them."}], "answers": [{"tags": [], "owner": {"reputation": 165, "user_id": 2630395, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b5f0f742c249caa0f3d03554e9a1675?s=128&d=identicon&r=PG", "display_name": "Somebody", "link": "https://stackoverflow.com/users/2630395/somebody"}, "is_accepted": true, "score": 1, "last_activity_date": 1523742724, "creation_date": 1523742724, "answer_id": 49836527, "question_id": 49832067, "link": "https://stackoverflow.com/questions/49832067/haskell-equation-binary-tree-mirror/49836527#49836527", "title": "Haskell Equation Binary Tree (Mirror)", "body": "<p>The line:</p>\n\n<pre><code>equal a (Leaf b) = a == b\n</code></pre>\n\n<p>will cause a type mismatch and should be replaced with this:</p>\n\n<pre><code>equal (Leaf a) (Leaf b) = a == b\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7133859, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-UsiVUi3dg6A/AAAAAAAAAAI/AAAAAAAABcI/ajfPuNYT8FY/photo.jpg?sz=128", "display_name": "Residenttt", "link": "https://stackoverflow.com/users/7133859/residenttt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 225, "favorite_count": 0, "accepted_answer_id": 49836527, "answer_count": 1, "score": -3, "last_activity_date": 1523742724, "creation_date": 1523713242, "last_edit_date": 1523722275, "question_id": 49832067, "link": "https://stackoverflow.com/questions/49832067/haskell-equation-binary-tree-mirror", "title": "Haskell Equation Binary Tree (Mirror)", "body": "<p>Hello I have an some homework about Haskell.</p>\n\n<pre><code>The definition of a binary tree has the form:\n\ndata Tree a = Leaf a\n             | Node a (Tree a) (Tree a)\n             | null\nEnter the implementation of the equal function checking whether the two binary trees are identical.\n\nTip\nequal :: Eq a =&gt; Tree a -&gt; Tree a -&gt; Bool\nequal Null Null = {- ... -}\nequal {- ... -} = a == b\nequal (Node a1 left1 right1) {- ... -} = a1 == a2 &amp;&amp; {- ... -}\nequal _ _ = False\nIn the above outline of implementation, replace comments {- ... -} into the appropriate code.\n</code></pre>\n\n<p>This is my homework and I have found something but i can not figure out one thing.</p>\n\n<pre><code>equal :: Eq a =&gt; Tree a -&gt; Tree a -&gt; Bool\nequal Null Null = True\nequal a (Leaf b) = a == b\nequal (Node a1 left1 right1) (Node a2 left2 right2) = a1 == a2 &amp;&amp; equal left1 right2 &amp;&amp; equal right1 left2\nequal _ _ = False\n</code></pre>\n\n<p>This is my code and <code>equal a (Leaf b) = a == b</code> this part is not working. I didn't find what should i put there.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1523716345, "post_id": 49831324, "comment_id": 86680288, "body": "This is a good complement to <a href=\"https://stackoverflow.com/q/48884276/2751851\"><i>Why doesn&#39;t this function work if I use \u201c&#91;xs&#93;\u201d instead of \u201cxs\u201d?</i></a>, which I have been using as a dupl*cate target for questions about this issue."}], "answers": [{"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 5, "last_activity_date": 1523708698, "creation_date": 1523708698, "answer_id": 49831422, "question_id": 49831324, "link": "https://stackoverflow.com/questions/49831324/pattern-matching-expects-round-braces-for-non-empty-list-and-not-square-brackets/49831422#49831422", "title": "Pattern matching expects round braces for non empty list and not square brackets", "body": "<p>The list pattern <code>[p1, ..., pn]</code> matches an n-element list where each element matches the patterns <code>p1</code> through <code>pn</code> respectively. The pattern <code>[p]</code> is a list pattern with only one element, so it matches a list with exactly one element that matches the pattern <code>p</code>. So <code>[_:_:x:_]</code> matches a list containing exactly one element and that element must be a list matching the pattern <code>_:_:x:_</code>.</p>\n\n<p>So why doesn't the same logic apply to <code>(p)</code> and tuples? That is, why doesn't <code>(_:_:x:_)</code> match a one-element tuple that contains a list? Because there's no such thing as a one-element tuple. Parentheses in Haskell are overloaded in a way: When they contain a comma, they denote a tuple; if they contain nothing (<code>()</code>), they denote the unit value; otherwise they're just used for grouping.</p>\n\n<p>So the pattern <code>(_:_:x:_)</code> just matches the pattern <code>_:_:x:_</code>. The parentheses are usually just used to avoid ambiguity (<code>f x:y = ...</code> would be interpreted as <code>(f x):y = ...</code>, not <code>f (x:y) =...</code>), but in this case they're actually redundant. You could just write:</p>\n\n<pre><code>third xs = case xs of \n                      [] -&gt; 0\n                      _:_:x:_ -&gt; x\n                      otherwise -&gt; 0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "is_accepted": true, "score": 6, "last_activity_date": 1523715514, "creation_date": 1523715514, "answer_id": 49832395, "question_id": 49831324, "link": "https://stackoverflow.com/questions/49831324/pattern-matching-expects-round-braces-for-non-empty-list-and-not-square-brackets/49832395#49832395", "title": "Pattern matching expects round braces for non empty list and not square brackets", "body": "<p>There is actually to way to write a list</p>\n\n<pre><code>[1, 2, 3]\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>1:2:3:[]\n</code></pre>\n\n<p>(Note the <code>:[]</code> at the end). The first one is the traditional way of writing a list but is actually just a shortcut to write the second one. <code>:</code> denotes the cons operator and <code>[]</code> denotes an empty list (which appears to be the same as []<code>in the first version).</code>3:[]<code>means , take 3 and prepend it to the  empty list (which is then equivalent to [3]).</code>2:3:[]<code>means : prepend 2 to the previous list (which is also equivalent to 2:[3]</code>. And finally <code>1:2:3:[]</code> is equivalent to <code>1:[2,3]</code>. So </p>\n\n<pre><code>[1, 2, 3]\n1:[2,3]\n1:2:[3]\n1:2:3:[]\n</code></pre>\n\n<p>are equivalent. However  <code>[1:2:3:[]]</code> is equivalent to <code>[[1,2,3]]</code> not <code>[1,2,3]</code>.</p>\n\n<p>So, when you pattern match on <code>(x:_)</code>, you are saying : I want a list starting with <code>x</code> and I don't care of it's tail (therefore it can be ANY length). When you write <code>[x:_]</code>, you are actually writting <code>[(x:_)]</code>, which means, I want a list of ONE elements, this element start with <code>x</code>. This could be correct, but the list you are pattern matching on is not a list of a but a list of list of a (<code>[[a]]</code>) which doesn't match your type signature.</p>\n"}], "owner": {"reputation": 4965, "user_id": 339167, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/34tLX.jpg?s=128&g=1", "display_name": "Rohit Sharma", "link": "https://stackoverflow.com/users/339167/rohit-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 0, "accepted_answer_id": 49832395, "answer_count": 2, "score": 1, "last_activity_date": 1523715514, "creation_date": 1523708089, "question_id": 49831324, "link": "https://stackoverflow.com/questions/49831324/pattern-matching-expects-round-braces-for-non-empty-list-and-not-square-brackets", "title": "Pattern matching expects round braces for non empty list and not square brackets", "body": "<p>In Haskell why pattern matching expects list to have round braces but not square braces when it is not empty? Why does it not follow the same convention when it tries to pattern match with empty list [] (square braces). Shouldn't the round braces reserved exclusively for tuples?</p>\n\n<p>For example - below does not work</p>\n\n<pre><code>third :: Integral a =&gt; [a] -&gt; a\nthird xs = case xs of \n                      [] -&gt; 0\n                      [_:_:x:_] -&gt; x\n                      otherwise -&gt; 0\n</code></pre>\n\n<p>But this works</p>\n\n<pre><code>third :: Integral a =&gt; [a] -&gt; a\nthird xs = case xs of \n                      [] -&gt; 0\n                      (_:_:x:_) -&gt; x\n                      otherwise -&gt; 0\n</code></pre>\n"}, {"tags": ["haskell", "haskell-lens"], "answers": [{"comments": [{"owner": {"reputation": 2244, "user_id": 29408, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f7af9c8034d5070fb2e8565c79c604b7?s=128&d=identicon&r=PG", "display_name": "Julian Birch", "link": "https://stackoverflow.com/users/29408/julian-birch"}, "edited": false, "score": 0, "creation_date": 1523717833, "post_id": 49832191, "comment_id": 86680783, "body": "Hi, thanks for this, it definitely works, but is there a way to modify the expression so that it works with <code>review</code> as well as <code>preview</code>?"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 2244, "user_id": 29408, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f7af9c8034d5070fb2e8565c79c604b7?s=128&d=identicon&r=PG", "display_name": "Julian Birch", "link": "https://stackoverflow.com/users/29408/julian-birch"}, "edited": false, "score": 1, "creation_date": 1523720747, "post_id": 49832191, "comment_id": 86681641, "body": "@JulianBirch Using <code>bimapping</code> instead of <code>alongside</code> and <code>Control.Lens.from</code> instead of <code>re</code> seems to do the trick: <code>internal . _Cons . bimapping id (Control.Lens.from internal) :: Prism&#39; StackExample (String,StackExample)</code>. Unlike <code>alongside</code>, <code>bimapping</code> can return an isomorphism from two other isos, and this allows us to preserve the &quot;prismaticness&quot; of <code>_Cons</code>."}, {"owner": {"reputation": 2244, "user_id": 29408, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f7af9c8034d5070fb2e8565c79c604b7?s=128&d=identicon&r=PG", "display_name": "Julian Birch", "link": "https://stackoverflow.com/users/29408/julian-birch"}, "edited": false, "score": 0, "creation_date": 1523740814, "post_id": 49832191, "comment_id": 86687696, "body": "Is it possible to have an expression that satisfies both? (I&#39;m not sure I&#39;ve got the background to understand why not.)"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 2244, "user_id": 29408, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f7af9c8034d5070fb2e8565c79c604b7?s=128&d=identicon&r=PG", "display_name": "Julian Birch", "link": "https://stackoverflow.com/users/29408/julian-birch"}, "edited": false, "score": 1, "creation_date": 1523744946, "post_id": 49832191, "comment_id": 86688746, "body": "@JulianBirch The expression with <code>bimapping</code> is a valid <code>Prism</code>, so you can use it with both <code>preview</code> and <code>review</code> just fine. The idea is that a  <code>Prism</code> might match or not, but when it matches, it must not lose information about the original value, otherwise that value can&#39;t be reconstructed when going in the opposite direction. When we compose <code>_Cons</code> with a mere lens, the lens might focus on some part of the result and discard the rest. But when we compose with an <code>Iso</code>, we preserve all information, so we still end up with a valid <code>Prism</code>."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 2244, "user_id": 29408, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f7af9c8034d5070fb2e8565c79c604b7?s=128&d=identicon&r=PG", "display_name": "Julian Birch", "link": "https://stackoverflow.com/users/29408/julian-birch"}, "edited": false, "score": 1, "creation_date": 1523801102, "post_id": 49832191, "comment_id": 86700212, "body": "I&#39;ve been tinkering, trying to extend this trick to record types with more than one field, here: <a href=\"https://gist.github.com/danidiaz/ff76231a4d666415c10e7504784ff128\" rel=\"nofollow noreferrer\">gist.github.com/danidiaz/ff76231a4d666415c10e7504784ff128</a>"}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": true, "score": 2, "last_activity_date": 1523714102, "creation_date": 1523714102, "answer_id": 49832191, "question_id": 49831254, "link": "https://stackoverflow.com/questions/49831254/how-to-compose-using-the-cons-prism/49832191#49832191", "title": "How to compose using the _Cons prism", "body": "<p>One possible solution would be:</p>\n\n<pre><code>popWithPrism :: StackExample -&gt; Maybe (String, StackExample)\npopWithPrism = preview $ internal . _Cons . alongside id (re internal)\n</code></pre>\n\n<p>The idea is to target the inner list, split it with <code>_Cons</code>, and map each part of the resulting tuple with <a href=\"http://hackage.haskell.org/package/lens-4.16.1/docs/Control-Lens-Lens.html#v:alongside\" rel=\"nofollow noreferrer\"><code>alongside</code></a>\u2014in particular the second element, in order to re-apply the <code>StackExample</code> constructor.</p>\n"}], "owner": {"reputation": 2244, "user_id": 29408, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/f7af9c8034d5070fb2e8565c79c604b7?s=128&d=identicon&r=PG", "display_name": "Julian Birch", "link": "https://stackoverflow.com/users/29408/julian-birch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 49832191, "answer_count": 1, "score": 1, "last_activity_date": 1523717291, "creation_date": 1523707591, "last_edit_date": 1523717291, "question_id": 49831254, "link": "https://stackoverflow.com/questions/49831254/how-to-compose-using-the-cons-prism", "title": "How to compose using the _Cons prism", "body": "<p>I'm trying to implement a fairly simple piece of code using lenses. However, I've hit a point where I want to be able to add and remove from a list. I've simplified it down to the following:</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell, FlexibleContexts, ScopedTypeVariables #-}\n\nmodule LensExample where\n\nimport qualified Control.Lens.TH as LensTH\nimport Control.Lens.Cons (_Cons)\nimport qualified Control.Lens.Fold\n\ndata StackExample = StackExample {\n    _internal :: [String]\n} deriving (Show)\n\nstart = StackExample { _internal = [\"Hello\", \"World\"]}\n\nLensTH.makeLenses 'StackExample\n\npopString :: [String] -&gt; Maybe (String, [String])\npopString ss = Control.Lens.Fold.preview _Cons ss\n\npopWithPrism :: StackExample -&gt; Maybe (String, StackExample)\npopWithPrism s = Control.Lens.Fold.preview _xxx s\n</code></pre>\n\n<p>How I combine <code>internal</code> and <code>_Cons</code> to produce <code>_xxx</code>?</p>\n"}, {"tags": ["haskell", "ghc"], "answers": [{"tags": [], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "is_accepted": true, "score": 0, "last_activity_date": 1523708004, "creation_date": 1523708004, "answer_id": 49831314, "question_id": 49831227, "link": "https://stackoverflow.com/questions/49831227/ghc-could-not-find-module-but-ghci-can/49831314#49831314", "title": "GHC could not find module but GHCi can", "body": "<p>I read through this: <a href=\"https://ghc.haskell.org/trac/ghc/wiki/DynamicLinkingDebate\" rel=\"nofollow noreferrer\">https://ghc.haskell.org/trac/ghc/wiki/DynamicLinkingDebate</a></p>\n\n<p>Running it with the <code>-dynamic</code> flag appears to fix it: <code>ghc -dynamic Tidal.hs</code>. </p>\n"}], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 849, "favorite_count": 0, "accepted_answer_id": 49831314, "answer_count": 1, "score": 1, "last_activity_date": 1523708004, "creation_date": 1523707383, "question_id": 49831227, "link": "https://stackoverflow.com/questions/49831227/ghc-could-not-find-module-but-ghci-can", "title": "GHC could not find module but GHCi can", "body": "<p>I have previously installed the <code>tidal</code> package with <code>cabl install tidal</code></p>\n\n<p>When running <code>ghc Tidal.hs</code>: </p>\n\n<pre><code>Tidal.hs:4:1: error:\n    Could not find module \u2018Sound.Tidal.Context\u2019\n    There are files missing in the \u2018tidal-0.9.6\u2019 package,\n    try running 'ghc-pkg check'.\n    Locations searched:\n      Sound/Tidal/Context.hs\n      Sound/Tidal/Context.lhs\n      Sound/Tidal/Context.hsig\n      Sound/Tidal/Context.lhsig\n      /home/chris/.cabal/lib/x86_64-linux-ghc-8.2.2/tidal-0.9.6-HlQOMGZHP8JDJBhFqbDzA/Sound/Tidal/Context.hi\n  |\n4 | import Sound.Tidal.Context\n</code></pre>\n\n<p>Within the last filepath that file indeed does not exist but there are files named that end in <code>.dyn_hi</code>. So the full path to the file that does exist is:\n<code>/home/chris/.cabal/lib/x86_64-linux-ghc-8.2.2/tidal-0.9.6-HlQOMGZHP8JDJBhFqbDzA/Sound/Tidal/Context.dyn_hi</code></p>\n\n<p>What may be the cause of the error? I am able to import the module successfully within <code>ghci</code>.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1523696592, "post_id": 49829666, "comment_id": 86674569, "body": "Because <code>(+)</code> is just a function, and it is part of the <code>Num</code> typeclass. A string is <i>not</i> a number."}, {"owner": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "edited": false, "score": 3, "creation_date": 1523696800, "post_id": 49829666, "comment_id": 86674640, "body": "My guess on why <code>(+)</code> is defined in the <code>Num</code> typeclass and not as part of the <code>Monoid</code> typeclass (and have <code>Num</code> as a subclass of <code>Monoid</code>) is probably historic, since <code>Monoid</code> was introduced after <code>Num</code>, and also because there&#39;s 2 <code>Monoid</code> instances for numeric types."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1523712455, "post_id": 49829666, "comment_id": 86679105, "body": "Even then, why should <code>(+)</code> be the <i>monoid</i> operator, as opposed to the operator for some other group-like structure? <code>Num</code> is far from being part of a mathematically rigourous hierarchy, and in the end <code>(+)</code> is used for the things most likely to be similar to integer addition. List concatenation (being a familiar operation but lacking commutativity or an inverse) is far enough from that definition to warrant its own operator."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1523713558, "post_id": 49829666, "comment_id": 86679476, "body": "You might also look at <a href=\"https://en.wikipedia.org/wiki/Magma_(algebra)#Classification_by_properties\" rel=\"nofollow noreferrer\">this chart</a> and ask yourself which object has the best claim on using <code>(+)</code> for its operation. (<code>Num</code> isn&#39;t so much one of those objects as it is &quot;a bunch of stuff that is pretty much the same for integers, rationals, reals, and complex numbers&quot;.)"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1523716761, "post_id": 49829666, "comment_id": 86680405, "body": "Closely related: <a href=\"https://stackoverflow.com/q/23794894/2751851\"><i>Why is the `mappend` infix alias `&lt;&gt;` instead of `+`?</i></a>"}, {"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 3, "creation_date": 1523780182, "post_id": 49829666, "comment_id": 86694422, "body": "Haskell predates the ridiculous popularity of <code>+</code> for string concatenation.  Concatenating strings is nothing like addition, so using different operators is sensible."}, {"owner": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "edited": false, "score": 2, "creation_date": 1524064273, "post_id": 49829666, "comment_id": 86821998, "body": "I do not have the feeling that this is a primary opinion base question (or at least the answers are really technically justified) , and so I do not thing this question shoud be put on hold"}], "answers": [{"comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1523696713, "post_id": 49829726, "comment_id": 86674604, "body": "That last argument is not per se correct. We could make a <code>Class (Plussable a, Timesable a) =&gt; Num a where ...</code>, to group typeclasses together."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523696771, "post_id": 49829726, "comment_id": 86674627, "body": "That&#39;s true, but we would have to write the type explicitly rather than having it inferred as it currently is. Or compiler magic."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523696774, "post_id": 49829726, "comment_id": 86674629, "body": "@WillemVanOnsem You could declare it with that type, but it wouldn&#39;t be inferred anymore"}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 2, "creation_date": 1523697801, "post_id": 49829726, "comment_id": 86674926, "body": "You can, in fact, express <code>1 + 2*(2-1)</code> using a single type class, but it does, indeed, require much verbosity: <code>Sum 1 &lt;&gt; (Sum $ getProduct $ Product 2 &lt;&gt; (Product $ getSum $ Sum 2 &lt;&gt; Sum (-1)))</code>. The type class in question is <code>Monoid</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 1, "creation_date": 1523706323, "post_id": 49829726, "comment_id": 86677305, "body": "@MarkSeemann A single class, <i>maybe</i>... but not a single constraint."}, {"owner": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 2, "creation_date": 1523709611, "post_id": 49829726, "comment_id": 86678236, "body": "@MarkSeemann actually, since <code>Sum a</code> and <code>Product a</code> are both instances of <code>Num</code>, we can reduce your expression to <code>getSum $ 1 &lt;&gt; (getProduct $ 2 &lt;&gt; (getSum $ 2 &lt;&gt; (-1)))</code>. This however relies on the fact that integral numerals are polymorphic with type <code>Num a =&gt; a</code>."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "reply_to_user": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "edited": false, "score": 0, "creation_date": 1523710317, "post_id": 49829726, "comment_id": 86678476, "body": "@M.Aroosi Ooh, I didn&#39;t know that! Very cool! Thank you for the tip."}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 3, "last_activity_date": 1523696610, "creation_date": 1523696610, "answer_id": 49829726, "question_id": 49829666, "link": "https://stackoverflow.com/questions/49829666/why-has-haskell-decided-against-using-for-string-list-concatenation/49829726#49829726", "title": "Why has Haskell decided against using `+` for string (list) concatenation?", "body": "<p>Long story short, it would cause type troubles.</p>\n\n<p><code>(+)</code> is part of the <code>Num</code> typeclass: </p>\n\n<pre><code>class  Num a  where\n    (+), (-), (*)       :: a -&gt; a -&gt; a\n    negate              :: a -&gt; a\n    abs                 :: a -&gt; a\n    signum              :: a -&gt; a\n    fromInteger         :: Integer -&gt; a\n\n    x - y               = x + negate y\n    negate x            = 0 - x\n</code></pre>\n\n<p>And <code>(++) :: [a] -&gt; [a] -&gt; [a]</code>.</p>\n\n<p>It's easy to see the first problem: if we wanted <code>(+)</code> to work on list, we would have to implement <code>(*)</code>, <code>negate</code>, <code>abs</code>, <code>signum</code>, and <code>fromInteger</code> for lists as well. Which is spurious.</p>\n\n<p>If we decided to seperate <code>(+)</code> from the typeclass, and make a new typeclass, maybe called <code>Plussable</code> for <code>(+)</code>, there would be too many typeclasses to keep track of, and simple expressions like <code>1 + 2*(2-1)</code> would no longer be of type <code>Num a =&gt; a</code>, it would be of type <code>(Plussable a, Timesable a, Minusable a) =&gt; a</code>, and so on for each operation. It would be far too complicated.</p>\n"}, {"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1524079410, "post_id": 49829828, "comment_id": 86830830, "body": "Although it&#39;s true that there are infinitely many monoids, sum and product are that only natural ones for numbers."}], "tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": false, "score": 16, "last_activity_date": 1523697304, "creation_date": 1523697304, "answer_id": 49829828, "question_id": 49829666, "link": "https://stackoverflow.com/questions/49829666/why-has-haskell-decided-against-using-for-string-list-concatenation/49829828#49829828", "title": "Why has Haskell decided against using `+` for string (list) concatenation?", "body": "<blockquote>\n  <p>typeclass for strings that concatenates two strings</p>\n</blockquote>\n\n<p>Such a typeclass exists, although the operator isn't <code>+</code>, but <code>&lt;&gt;</code>:</p>\n\n<pre><code>Prelude&gt; :m +Data.Monoid\nPrelude Data.Monoid&gt; \"foo\" &lt;&gt; \"bar\"\n\"foobar\"\n</code></pre>\n\n<p>While <code>++</code> concatenates lists, the <code>&lt;&gt;</code> operator is more general, since it combines any two values of a given <code>Monoid</code> instance.</p>\n\n<p>As other people have pointed out, <code>+</code> is reserved for <code>Num</code> instances. Why isn't the <code>Monoid</code> binary operator called <code>+</code>, then? Because addition is only one of infinitely many monoids; multiplication is another:</p>\n\n<pre><code>Prelude Data.Monoid&gt; Sum 2 &lt;&gt; Sum 3\nSum {getSum = 5}\nPrelude Data.Monoid&gt; Product 2 &lt;&gt; Product 3\nProduct {getProduct = 6}\n</code></pre>\n\n<p>Choosing something like <code>&lt;&gt;</code> as 'the' monoidal operator is preferred exactly because it carries little semantic baggage.</p>\n"}], "owner": {"reputation": 2090, "user_id": 1499066, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a35bb8eaa9c809c52774aef01d19afa3?s=128&d=identicon&r=PG", "display_name": "John Smith", "link": "https://stackoverflow.com/users/1499066/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "accepted_answer_id": 49829726, "answer_count": 2, "score": 4, "last_activity_date": 1524078913, "creation_date": 1523696194, "last_edit_date": 1524078718, "question_id": 49829666, "link": "https://stackoverflow.com/questions/49829666/why-has-haskell-decided-against-using-for-string-list-concatenation", "title": "Why has Haskell decided against using `+` for string (list) concatenation?", "body": "<p>Since I had trouble googling this question I thought I'd post it here. </p>\n\n<p>I'm just interested in the logic behind it or wether it's just the creators' preference to use <code>++</code> instead. I mean, using a typeclass for strings that concatenates two strings (or rather lists) with <code>+</code> does not seem too hard to imagine.</p>\n\n<p><strong>Edit:</strong> I should add, that in Haskell one has to suspect reasons behind it, because <code>+</code> and <code>++</code> are functions defined in typeclasses, whereas in java the usage of <code>+</code> for string concatenation is just part of the language's syntax and therefor subject only to the creators preference/opinion. (The answers so far suggest that I was right about my suspicion.) </p>\n\n<p>Also haskell comes from a mathematical background and is deeply influenced by mathematical syntax, so there might be deeper reasons than just preference/opinion.</p>\n"}, {"tags": ["haskell", "haskell-lens"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 2, "creation_date": 1523692926, "post_id": 49829104, "comment_id": 86673770, "body": "Interesting idea! I did a little Googling and I found <a href=\"https://www.reddit.com/r/haskell/comments/2ckwho/comment/cjgx9af\" rel=\"nofollow noreferrer\">this post from Ed Kmett himself</a> who says that you can\u2019t write to a mutable location without breaking the lens laws"}], "answers": [{"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": true, "score": 3, "last_activity_date": 1523701129, "creation_date": 1523701129, "answer_id": 49830351, "question_id": 49829104, "link": "https://stackoverflow.com/questions/49829104/using-lenses-for-accessing-data-inside-functors/49830351#49830351", "title": "Using lenses for accessing data inside functors", "body": "<p>There is a library (formerly part of <a href=\"http://hackage.haskell.org/package/lens\" rel=\"nofollow noreferrer\">lens</a> proper) called <a href=\"http://hackage.haskell.org/package/lens-action\" rel=\"nofollow noreferrer\">lens-action</a> that helps mixing getters and folds with monading actions without yanking you too much out of the lensy world.</p>\n\n<p>For example, for the type</p>\n\n<pre><code>data App = App { _state :: TVar AppState }\n</code></pre>\n\n<p>We could write</p>\n\n<pre><code>ghci&gt; :t \\v -&gt; v^!state.act readTVar.a.b\n\\v -&gt; v^!state.act readTVar.a.b :: App -&gt; STM Int\n</code></pre>\n\n<p>The idea is that instead of using the typical view function <code>(^.)</code> we use its monadic counterpart <a href=\"http://hackage.haskell.org/package/lens-action-0.2.3/docs/Control-Lens-Action.html#v:-94--33-\" rel=\"nofollow noreferrer\"><code>(^!)</code></a>. And we insert monadic actions using functions like <a href=\"http://hackage.haskell.org/package/lens-action-0.2.3/docs/Control-Lens-Action.html#v:act\" rel=\"nofollow noreferrer\"><code>act</code></a> or <a href=\"http://hackage.haskell.org/package/lens-action-0.2.3/docs/Control-Lens-Action.html#v:acts\" rel=\"nofollow noreferrer\"><code>acts</code></a>. Normal getters and folds don't need to be lifted and composition is still done with plain <code>(.)</code>.</p>\n"}], "owner": {"reputation": 117, "user_id": 9644760, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9cFg0.png?s=128&g=1", "display_name": "xal", "link": "https://stackoverflow.com/users/9644760/xal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 3, "accepted_answer_id": 49830351, "answer_count": 1, "score": 3, "last_activity_date": 1523701129, "creation_date": 1523692004, "question_id": 49829104, "link": "https://stackoverflow.com/questions/49829104/using-lenses-for-accessing-data-inside-functors", "title": "Using lenses for accessing data inside functors", "body": "<p>I find lenses very useful for accessing deeply nested data, but frequently \"containers\" like <code>MVar</code> or <code>TVar</code>s throw off some of the nice properties of lenses.</p>\n\n<p>For example:</p>\n\n<pre><code>data SomeStruct = SomeStruct { _b :: Int\n                             }\nmakeLenses ''SomeStruct\n\ndata AppState = AppState { _a :: SomeStruct\n                         }\nmakeLenses ''AppState\n\ndata App = App { _state :: AppState\n               }\nmakeLenses ''App\n</code></pre>\n\n<p>I can make new lenses using very nice left-to-right composition:</p>\n\n<pre><code>let v = App (AppState (SomeStruct 3))\nin v^.state.a.b\n</code></pre>\n\n<p>However, if <code>_state</code> were of type TVar, the left-to-right composition breaks down, and lenses feel a lot clunkier to use:</p>\n\n<pre><code>t &lt;- newTVarIO $ AppState (SomeStruct 3)\nlet v = App t\natomically $ (^.a.b) &lt;$&gt; readTVar (v^.state)\n</code></pre>\n\n<p><code>^.a.b</code> gets pushed to the left hand side despite <code>^.state</code> being the innermost lens.  Is there some way I could deal with these sorts of \"container\" types and lenses in a more ergonomic way?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 3, "creation_date": 1523690783, "post_id": 49828678, "comment_id": 86673282, "body": "It would be better if you posted the exact error you are getting alongside the code."}, {"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 0, "creation_date": 1523721814, "post_id": 49828678, "comment_id": 86682021, "body": "Don&#39;t mark as answers as resolved by editing them - I&#39;ve rolled back the change."}, {"owner": {"reputation": 11, "user_id": 9644617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1bda6ad1b590525840d10de01193c4d?s=128&d=identicon&r=PG&f=1", "display_name": "Ftuvida", "link": "https://stackoverflow.com/users/9644617/ftuvida"}, "edited": false, "score": 0, "creation_date": 1523722194, "post_id": 49828678, "comment_id": 86682145, "body": "Sorry first time posting here, thanks for the tip"}], "answers": [{"tags": [], "owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "is_accepted": false, "score": 1, "last_activity_date": 1523694772, "last_edit_date": 1523694772, "creation_date": 1523691341, "answer_id": 49829017, "question_id": 49828678, "link": "https://stackoverflow.com/questions/49828678/parse-error-on-input-f/49829017#49829017", "title": "Parse error on input f", "body": "<p>I have 3 errors with your code, neither of which is a parse error. Error messages differ between compiler versions, so it is hard for me to know exactly what you see.</p>\n\n<p>These are the errors I had to fix to have your code compile:</p>\n\n<ol>\n<li>Add the line <code>import Control.Monad (forever)</code>.</li>\n<li>Fix the identifier case in the expression <code>case M.lookup (sort str) anagrams of ...</code>.</li>\n<li>Fix the identifier case in the line <code>Just xs -&gt; xs</code>.</li>\n</ol>\n\n<p><em>(Overall, you could also replace that <code>case</code> with a <code>fromMaybe</code>. It would be idiomatic and concise.)</em></p>\n\n<p>In Haskell you distinguish the sort of an identifier by the case of the first character. If the identifier starts with a capital letter, it would mean it is either a data constructor, a type constructor or a module name. For ordinary values <em>(and type variables)</em>, you always start with lower case.</p>\n\n<p>I hope this helps you. Let me know if the problem persists.</p>\n"}, {"comments": [{"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1523704702, "post_id": 49829717, "comment_id": 86676841, "body": "How did you find out? I passed the code through <code>xxd</code> and see no occurences of a <code>0x09</code> character."}, {"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "reply_to_user": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1523704884, "post_id": 49829717, "comment_id": 86676908, "body": "@IgnatInsarov It&#39;s not shown in the code in the post, but if you hit <a href=\"https://stackoverflow.com/posts/49828678/edit\">edit</a> and skip your cursor along the whitespace before that line, it&#39;ll jump 2 spaces instead of one. The &quot;ask question&quot; dialog doesn&#39;t easily allow tabs to be entered directly, so it&#39;s extremely likely the OP pasted the tab in from their code - and it matches the error message they get. I used to have this issue a lot, so I&#39;m uncomfortably aware of the possibility."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1523705388, "post_id": 49829717, "comment_id": 86677066, "body": "Oh. I see. Thanks!"}], "tags": [], "owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "is_accepted": false, "score": 1, "last_activity_date": 1523696547, "creation_date": 1523696547, "answer_id": 49829717, "question_id": 49828678, "link": "https://stackoverflow.com/questions/49828678/parse-error-on-input-f/49829717#49829717", "title": "Parse error on input f", "body": "<p>You have a tab character forming part of the whitespace on the line that you indicated the parse error is on. Precisely, in the code in your post above, you have this line (<code>\u00bb</code> is tab, <code>\u00b7</code> is space):</p>\n\n<pre><code>\u00b7\u00b7\u00bb\u00b7\u00b7\u00b7\u00b7\u00b7f :: ...\n</code></pre>\n\n<p>Haskell is a <a href=\"https://en.wikibooks.org/wiki/Haskell/Indentation\" rel=\"nofollow noreferrer\">whitespace sensitive language</a> - in particular, it's a lot easier and less error-prone to just <a href=\"https://stackoverflow.com/questions/35855170/why-shouldnt-i-mix-tabs-and-spaces\">use spaces instead of tabs, and mixing them rarely works</a>.</p>\n\n<p>Replacing any tabs with spaces should fix your parse error - if your editor has a \"tabs to spaces\" conversion option, that's a good thing to enable. To fix the other errors present in your code, Ignat Insarov has already given a good answer.</p>\n"}], "owner": {"reputation": 11, "user_id": 9644617, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1bda6ad1b590525840d10de01193c4d?s=128&d=identicon&r=PG&f=1", "display_name": "Ftuvida", "link": "https://stackoverflow.com/users/9644617/ftuvida"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 287, "favorite_count": 0, "closed_date": 1523715722, "answer_count": 2, "score": 1, "last_activity_date": 1523721784, "creation_date": 1523687885, "last_edit_date": 1523721784, "question_id": 49828678, "link": "https://stackoverflow.com/questions/49828678/parse-error-on-input-f", "closed_reason": "Duplicate", "title": "Parse error on input f", "body": "<p>I am trying to create an anagram lookup in haskell, I am getting a parse error on input \"f\" </p>\n\n<p>Here is my code</p>\n\n<pre><code>import Data.Map (Map)\nimport Data.List (sort)\nimport qualified Data.Map as M\n\ntype Anagrams = Map String [String]\n\nmain :: IO()\nmain = buildAnagrams \"dictionary.txt\" &gt;&gt;= loop\n  where\n    loop :: Anagrams -&gt; IO ()\n    loop anagrams = forever $ do\n         putStrLn \"Anagrams of...\"\n         getLine &gt;&gt;=  print . lookupAnagrams anagrams\n\n\nbuildAnagrams :: FilePath -&gt; IO Anagrams\nbuildAnagrams = fmap (foldr f M.empty . lines ) . readFile\n  where \n     f :: String -&gt; Anagrams -&gt; Anagrams\n     f s = M.insertWith (++) (sort s) [s]\n\nlookupAnagrams :: Anagrams -&gt; String -&gt; [String]\nlookupAnagrams anagrams str =   \n    case M.Lookup(sort str) anagrams of\n        Nothing -&gt; []\n        Just XS -&gt; XS\n</code></pre>\n\n<p>the error is on the line f s = M.insertWith</p>\n"}, {"tags": ["haskell", "types", "dependent-type", "singleton-type"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 2, "creation_date": 1523706194, "post_id": 49828236, "comment_id": 86677263, "body": "All this complicated stuff is a result of <code>singletons</code>&#39;s <i>defunctionalisation</i>-based encoding of type functions. The author of <code>singletons</code> has written about it <a href=\"https://typesandkinds.wordpress.com/2013/04/01/defunctionalization-for-the-win/\" rel=\"nofollow noreferrer\">on his blog</a>"}], "answers": [{"comments": [{"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1523710824, "post_id": 49831297, "comment_id": 86678615, "body": "I think you&#39;ve used <code>TyCon</code> when you need to use <code>TyCon2</code> a few times?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1523713099, "post_id": 49831297, "comment_id": 86679342, "body": "@HTNW I also thought that, but my code compiled anyway. Now I see that <code>TyCon</code> is a <code>data family</code> which automatically handles the arity. Its doc on github states &quot;Workhorse for the &#39;TyCon1&#39;, etc., types. This can be used directly in place of any of the @TyConN@ types, but it will work only with /monomorphic/ types. When GHC#14645 is fixed, this should fully supersede the @TyConN@ types.&quot;"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1523708518, "last_edit_date": 1523708518, "creation_date": 1523707866, "answer_id": 49831297, "question_id": 49828236, "link": "https://stackoverflow.com/questions/49828236/how-to-use-the-dependent-pair-type-sigma-from-the-singletons-library/49831297#49831297", "title": "How to use the dependent pair type Sigma from the singletons library?", "body": "<p>In this specific case, we want to compute the type-level lambda</p>\n\n<pre><code>\\n -&gt; Vect n String\n</code></pre>\n\n<p>Unfortunately, we do not have lambdas at the type level. At most, we can define type families, as the OP did. However, we can rewrite the lambda in pointfree style:</p>\n\n<pre><code>\\n -&gt; flip Vect String n    -- pseudocode\nflip Vect String\n</code></pre>\n\n<p>and we can turn this idea into an actual type, using the <code>singletons</code> type-level <code>Flip</code> type function. Here, we want to partially apply <code>Flip</code> with two arguments (it takes three, in a saturated call), so we use the \"defunctionalized\" <code>FlipSym2</code> variant instead.</p>\n\n<p>This compiles:</p>\n\n<pre><code>replicateVecSigma :: Natural -&gt; Sigma Nat (FlipSym2 (TyCon Vect) String)\nreplicateVecSigma i =\n  case toSing i of\n    SomeSing snat -&gt; snat :&amp;: replicateVec snat \"hello\"\n</code></pre>\n\n<p>If we had the <code>n</code> argument in the last position from the beginning, we could have avoided the <code>Flip</code>.</p>\n\n<pre><code>data Vect2 :: Type -&gt; Nat -&gt; Type where\n  VNil2 :: Vect2 a 0\n  VCons2 :: a -&gt; Vect2 a n -&gt; Vect2 a (n + 1)\n\nreplicateVec2 :: forall n a. Sing n -&gt; a -&gt; Vect2 a n\nreplicateVec2 = undefined\n\nreplicateVecSigma2 :: Natural -&gt; Sigma Nat (TyCon (Vect2 String))\nreplicateVecSigma2 i =\n  case toSing i of\n    SomeSing snat -&gt; snat :&amp;: replicateVec2 snat \"hello\"\n</code></pre>\n\n<p>( <code>TyCon Vect2 @@ String</code> also works here, using the explicit application <code>@@</code> at the defunctionalized level, instead of the actuall type applciation.)</p>\n\n<p>Very roughly put, you can think of the defunctionalized variants like <code>FlipSym0, FlipSym1, FlipSym2</code> as basic tags (not functions!), with no intrinsic meaning, except for the fact that <code>Apply</code> lets you work with them <em>pretending</em> they were functions. In this way we can work with non-functions (\"tags\") as if they were functions. This is needed since, in Haskell, we do not have functions at the type level, so we have to work with these \"pretend\" versions.</p>\n\n<p>The approach is general, but it does require more work from the programmer than one would like.</p>\n\n<p>I am not aware of any Template Haskell utility that can automatically turn type-level lambdas into pointfree form, and then defunctionalize them. That would be quite useful.</p>\n"}, {"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": false, "score": 3, "last_activity_date": 1523708017, "creation_date": 1523708017, "answer_id": 49831315, "question_id": 49828236, "link": "https://stackoverflow.com/questions/49828236/how-to-use-the-dependent-pair-type-sigma-from-the-singletons-library/49831315#49831315", "title": "How to use the dependent pair type Sigma from the singletons library?", "body": "<p><em>Defunctionalization</em> is a general way to work around the lack of first-class functions (in fact, it was originally discovered as a compilation technique to get rid of those), encoding them as <em>symbols</em> that get interpreted by a single first-order <code>Apply</code> function.</p>\n\n<p>For example, your <code>Foo a b</code> is a symbol that encodes the function <code>\\n -&gt; a n b</code>.</p>\n\n<hr>\n\n<p>Another way of obtaining an equivalent symbol is to follow the intuition that <code>(\\n -&gt; a n b) = flip a b</code>.</p>\n\n<p>Note that type constructors like <code>Vec</code> are not themselves symbols that can be passed to <code>Apply</code>, but must be wrapped in \"symbol constructors\": <code>TyCon2 Vec</code> is the symbol for <code>\\n -&gt; \\b -&gt; Vec n b</code>.</p>\n\n<p><em>singletons</em> has a symbol for <code>flip</code>, <code>FlipSym0</code> (symbols can stand for higher-order functions by taking other symbols as arguments).</p>\n\n<pre><code>Foo a b = Apply (Apply FlipSym0 (TyCon2 a)) b\n</code></pre>\n\n<p>Note that partial applications reduce to other symbols:</p>\n\n<pre><code>        = Apply (FlipSym1 (TyCon2 a)) b\n        = FlipSym2 (TyCon2 a) b\n</code></pre>\n\n<hr>\n\n<p>The <code>TyFun</code> type is a way to give types to defunctionalized symbols. The main benefit I see is type inference; without it, type families might get stuck in confusing ways.</p>\n\n<p>See also this blogpost by Richard Eisenberg on defunctionalization for Haskell types: <a href=\"https://typesandkinds.wordpress.com/2013/04/01/defunctionalization-for-the-win/\" rel=\"nofollow noreferrer\">https://typesandkinds.wordpress.com/2013/04/01/defunctionalization-for-the-win/</a></p>\n"}], "owner": {"reputation": 3128, "user_id": 3040129, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TcwLC.png?s=128&g=1", "display_name": "illabout", "link": "https://stackoverflow.com/users/3040129/illabout"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 4, "accepted_answer_id": 49831297, "answer_count": 2, "score": 10, "last_activity_date": 1523708518, "creation_date": 1523683415, "last_edit_date": 1523689940, "question_id": 49828236, "link": "https://stackoverflow.com/questions/49828236/how-to-use-the-dependent-pair-type-sigma-from-the-singletons-library", "title": "How to use the dependent pair type Sigma from the singletons library?", "body": "<p>How can the dependent pair type <a href=\"https://www.stackage.org/haddock/nightly-2018-04-14/singletons-2.4.1/Data-Singletons-Sigma.html#t:Sigma\" rel=\"noreferrer\">Sigma</a> from the <a href=\"https://www.stackage.org/nightly-2018-04-14/package/singletons-2.4.1\" rel=\"noreferrer\">singletons</a> library be used?</p>\n\n<p>Let's assume the following type-indexed list and replicate function exist:</p>\n\n<pre><code>data Vect :: Nat -&gt; Type -&gt; Type where\n  VNil :: Vect 0 a\n  VCons :: a -&gt; Vect n a -&gt; Vect (n + 1) a\n\nreplicateVec :: forall n a. Sing n -&gt; a -&gt; Vect n a\n</code></pre>\n\n<p>(You can find a couple different implementations of <code>replicateVec</code> in <a href=\"https://stackoverflow.com/questions/49709113/replicate-function-for-a-length-indexed-list-using-ghc-typelits-and-singletons\">this question</a>).</p>\n\n<p>I'd like to create a function <code>replicateVecSigma</code> that returns a <code>Vect</code> in a dependent pair.  Ideally it would be like the following:</p>\n\n<pre><code>replicateVecSigma :: Natural -&gt; Sigma Nat (\\n -&gt; Vect n String)\n</code></pre>\n\n<p>How can <code>Sigma</code> be used to write this function?  And how can the type of the function be written?</p>\n\n<hr>\n\n<p>Actually, I am able to implement <code>replicateVecSigma</code> as follows but it doesn't seem very clean:</p>\n\n<pre><code>data Foo a b (m :: TyFun Nat Type)\n\ntype instance Apply (Foo a b) (n :: Nat) = a n b\n\nreplicateVecSigma :: Natural -&gt; Sigma Nat (Foo Vect String)\nreplicateVecSigma i =\n  case toSing i of\n    SomeSing snat -&gt; snat :&amp;: replicateVec snat \"hello\"\n</code></pre>\n\n<p>It seems unfortunate that I have to declare this <code>Foo</code> type and <code>Apply</code> instance just to use <code>Sigma</code>.  Does the <code>singletons</code> library provide any way to make working with <code>Sigma</code> easier?</p>\n\n<p>You can find my full code <a href=\"https://gist.github.com/cdepillabout/3540e1313dd17b16a703508624a6aee0\" rel=\"noreferrer\">here</a>.</p>\n\n<hr>\n\n<p>For completeness, here is the definition of <code>Sigma</code>:</p>\n\n<pre><code>data Sigma (s :: Type) :: (s ~&gt; Type) -&gt; Type where\n  (:&amp;:) :: forall s t fst. Sing (fst :: s) -&gt; t @@ fst -&gt; Sigma s t\n</code></pre>\n\n<p>Here is <a href=\"https://www.stackage.org/haddock/nightly-2018-04-14/singletons-2.4.1/Data-Singletons.html#t:-126--62-\" rel=\"noreferrer\"><code>~&gt;</code></a>:</p>\n\n<pre><code>type a ~&gt; b = TyFun a b -&gt; *\n\ndata TyFun :: * -&gt; * -&gt; *\n\ninstance (SingKind k1, SingKind k2) =&gt; SingKind (k1 ~&gt; k2)\n\ntype instance Demote (k1 ~&gt; k2) = Demote k1 -&gt; Demote k2\n\nclass SingKind k where\n  type family Demote k :: * = r | r -&gt; k\n  fromSing :: forall (a :: k). Sing a -&gt; Demote k\n  toSing :: Demote k -&gt; SomeSing k\n</code></pre>\n\n<p>Here is <a href=\"https://www.stackage.org/haddock/nightly-2018-04-14/singletons-2.4.1/Data-Singletons.html#t:-64--64-\" rel=\"noreferrer\"><code>@@</code></a>:</p>\n\n<pre><code>type a @@ b = Apply a b\n\ntype family Apply (f :: k1 ~&gt; k2) (x :: k1) :: k2\n</code></pre>\n\n<p><code>singletons</code> defines a bunch of instances for <code>Apply</code>.</p>\n\n<p>How do <a href=\"https://www.stackage.org/haddock/nightly-2018-04-14/singletons-2.4.1/Data-Singletons.html#t:TyFun\" rel=\"noreferrer\"><code>TyFun</code></a> and <a href=\"https://www.stackage.org/haddock/nightly-2018-04-14/singletons-2.4.1/Data-Singletons.html#t:Apply\" rel=\"noreferrer\"><code>Apply</code></a> work?</p>\n\n<hr>\n\n<p>Here are the three questions from above:</p>\n\n<ol>\n<li>How can I use <code>Sigma</code> to write a function like <code>replicateVecSigma :: Natural -&gt; Sigma Nat (\\n -&gt; Vect n String)</code>?</li>\n<li>I am able to write <code>replicateVecSigma</code> using the <code>Foo</code> type above, but it seems like too much extra work.  Is there an easier way?</li>\n<li>How do <code>TyFun</code> and <code>Apply</code> work?</li>\n</ol>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1523671981, "post_id": 49827055, "comment_id": 86670000, "body": "Please <a href=\"https://stackoverflow.com/posts/49827055/edit\">edit</a> your post to add the error messages as text, and not as an image -- it makes things easier for everyone."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1523677068, "post_id": 49827055, "comment_id": 86670743, "body": "This function is a good example of a fold! <code>numOccurrences n xs = foldr (\\x i -&gt; if x==n then 1+i else i) 0 xs</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1523698496, "post_id": 49827055, "comment_id": 86675114, "body": "Taking a list argument as <code>[xs]</code> is one of the most frequent mistakes I see here on SO. I have no idea what course / book / tutorial is prodding beginners towards it. It is not an habit inherited from other programming languages. Yet, somehow beginners assume that they must name their list parameters as <code>[xs]</code>, as if <code>xs</code> were too simple to be correct (&quot;it is a list, not a single argument&quot; or some similar bogus argument?). Whatever is teaching this, it is causing a lot of harm."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 9644055, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alexandria Brelsford", "link": "https://stackoverflow.com/users/9644055/alexandria-brelsford"}, "edited": false, "score": 0, "creation_date": 1523672272, "post_id": 49827228, "comment_id": 86670039, "body": "so the =&gt; does what?  and thank you so much! you helped me so much! simple errors from staring at it for to long haha :)"}, {"owner": {"reputation": 4414, "user_id": 5241032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/056c678e99e8253ad280b230ba30a7fb?s=128&d=identicon&r=PG&f=1", "display_name": "cmaher", "link": "https://stackoverflow.com/users/5241032/cmaher"}, "reply_to_user": {"reputation": 13, "user_id": 9644055, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alexandria Brelsford", "link": "https://stackoverflow.com/users/9644055/alexandria-brelsford"}, "edited": false, "score": 0, "creation_date": 1523672644, "post_id": 49827228, "comment_id": 86670082, "body": "The <code>=&gt;</code> symbol allows us to make our type variable <code>a</code> an instance of the <code>Eq</code> typeclass. Members of the <code>Eq</code> type class can be equated (e.g. <code>&#39;a&#39; == &#39;a&#39;</code>, <code>2 &#47;= 3</code>)."}], "tags": [], "owner": {"reputation": 4414, "user_id": 5241032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/056c678e99e8253ad280b230ba30a7fb?s=128&d=identicon&r=PG&f=1", "display_name": "cmaher", "link": "https://stackoverflow.com/users/5241032/cmaher"}, "is_accepted": true, "score": 2, "last_activity_date": 1523720311, "last_edit_date": 1523720311, "creation_date": 1523672101, "answer_id": 49827228, "question_id": 49827055, "link": "https://stackoverflow.com/questions/49827055/haskell-programming-assignment-couldnt-match-expected-type-int-with-actual/49827228#49827228", "title": "Haskell Programming Assignment, &quot;Couldn&#39;t match expected type \u2018Int\u2019 with actual type \u2018[a0] -&gt; Int\u2019 &quot;and a few more Errors", "body": "<p>A few pointers:</p>\n\n<p>First, in your type signature, using different type variables (i.e. <code>b</code> and <code>a</code>) creates the possibility that you could look for occurrences of a value of one type, in a list with another type, which in this case is not what you want. So instead of two type variables, you just want to use one.</p>\n\n<p>Second, whatever the concrete type of your list is, whether it's <code>[Char]</code>, <code>[Int]</code>, etc., it needs to be equatable (i.e. it needs to derive the <code>Eq</code> typeclass), so it makes sense to use the class constraint <code>(Eq a) =&gt;</code> in your type signature.</p>\n\n<p>Third, since we're traversing a list, let's use <a href=\"https://en.wikibooks.org/wiki/Haskell/Pattern_matching\" rel=\"nofollow noreferrer\">pattern matching</a> to safely break off the first element of the list for comparison, and let's also add a base case (i.e. what we do with an empty list), since we're using recursion, and we only want the recursive pattern to match as long as there are elements in our list.</p>\n\n<p>Lastly, try to avoid using indexing (i.e. <code>!!</code>), where you can avoid it, and use pattern matching instead, as it's safer and easier to reason about.</p>\n\n<p>Here's how your modified function might look, based on the above pointers:</p>\n\n<pre><code>numOccurences :: (Eq a) =&gt; a -&gt; [a] -&gt; Int\nnumOccurences _ [] = 0\nnumOccurences n (x:xs)\n  | n == x    = 1 + numOccurences n xs\n  | otherwise = numOccurences n xs\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9644055, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Alexandria Brelsford", "link": "https://stackoverflow.com/users/9644055/alexandria-brelsford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 49827228, "answer_count": 1, "score": 1, "last_activity_date": 1523720311, "creation_date": 1523669784, "last_edit_date": 1523669934, "question_id": 49827055, "link": "https://stackoverflow.com/questions/49827055/haskell-programming-assignment-couldnt-match-expected-type-int-with-actual", "title": "Haskell Programming Assignment, &quot;Couldn&#39;t match expected type \u2018Int\u2019 with actual type \u2018[a0] -&gt; Int\u2019 &quot;and a few more Errors", "body": "<p>The assignment I have: A function numOccurences that takes a value and a list, returning the number of times that value appears in the list. I am learning haskell and am getting frustrated, this is my code for this:</p>\n\n<pre><code>numOccurences:: b -&gt; [a] -&gt; Int\nnumOccurences n [ls]\n  |([ls] !! n==True) =  (numOccurences(n (tail [ls])))+1\n  |otherwise = 0\n</code></pre>\n\n<p>The errors I am getting are as follows:\n<a href=\"https://imgur.com/a/0lTBn\" rel=\"nofollow noreferrer\">https://imgur.com/a/0lTBn</a></p>\n"}, {"tags": ["haskell", "opengl"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1523670199, "post_id": 49827020, "comment_id": 86669756, "body": "We&#39;ll need at least a little code, to see the structure of the function calling <code>triangulize</code> and the code close to <code>triangulize</code>. The interaction with the rotation code is important too."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1523670567, "post_id": 49827020, "comment_id": 86669806, "body": "Ok @dfeuer I will post some code. Maybe not today cause it is 4H a.m. here."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1523702591, "post_id": 49827020, "comment_id": 86676217, "body": "@dfeuer Done :-)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1523757071, "post_id": 49827020, "comment_id": 86690764, "body": "I think it&#39;s better to write your answer as an answer rather than editing it into the question."}], "answers": [{"comments": [{"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1523739517, "post_id": 49834902, "comment_id": 86687328, "body": "So far I have understood the first part. And it works ! Very clever. My bretzel rotates without pain now ! Thank you. I will accept the answer once I will be able to apply the more complicated case."}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "reply_to_user": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1523739670, "post_id": 49834902, "comment_id": 86687370, "body": "@St&#233;phaneLaurent Let me know what might be unclear, I&#39;ll try to expand."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1523743060, "post_id": 49834902, "comment_id": 86688266, "body": "I thought I almost got it but now I&#39;m lost. Where should I put <code>setLevel</code> and <code>setRotation</code> ?"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1523744499, "post_id": 49834902, "comment_id": 86688649, "body": "That&#39;s ok, I&#39;ve managed !! I&#39;m using a slightly different way but this is because you are not familiar with OpenGL I think. Thanks a lot !!"}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "reply_to_user": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1523746828, "post_id": 49834902, "comment_id": 86689150, "body": "@St&#233;phaneLaurent The point is that instead of exposing parameters as data <code>IORef Float</code>, we expose them as setter functions that accept <code>Float</code>: <code>setSomething :: Context -&gt; Float -&gt; IO ()</code>. This allows us to act (or not) when a parameter changes at will."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1523747802, "post_id": 49834902, "comment_id": 86689327, "body": "Please take a look at my edit. I give the code I finally use, in the context of <code>OpenGL</code>. Everything works very well."}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "reply_to_user": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1523750500, "post_id": 49834902, "comment_id": 86689851, "body": "@St&#233;phaneLaurent I&#39;d suggest just a minor change; To include the <code>IORef</code> for level in the context as well, and pass <code>Context</code> to <code>keyboard</code>, instead of exposing the <code>IORef</code>s. As an additional level of decoupling, the internals of` <code>Context</code> could be hidden from` keyboard` and instead have functions to modify the parameters (as I see you need to update them, not just set them), along the lines of: <code>updateRotation :: Context -&gt; (Float -&gt; Float) -&gt; IO ()</code>. This modifies rotation in the context by a given modification function, doing any recomputations necessary. I can expand this if needed."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1523750875, "post_id": 49834902, "comment_id": 86689924, "body": "Thanks. I will see that tomorrow. It&#39;s 2 o&#39;clock in the morning here."}], "tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": true, "score": 1, "last_activity_date": 1523731121, "creation_date": 1523731121, "answer_id": 49834902, "question_id": 49827020, "link": "https://stackoverflow.com/questions/49827020/how-to-rotate-an-opengl-graphics-in-haskell-without-uselessly-re-evaluating-the/49834902#49834902", "title": "How to rotate an OpenGL graphics in Haskell without uselessly re-evaluating the graphical objects?", "body": "<p>I'm not very familiar with OpenGL, so I have some difficulty understanding the code in detail - please correct me if I misunderstood something.</p>\n\n<p>I'd try to abstain from using unsafe functions or relying on <code>INLINE</code> as much as possible. This usually makes code brittle and obscures more natural solutions.</p>\n\n<p>In the simplest case, if you don't need to re-evaluate <code>triangularize</code>, we could just replace it with its output. So we'd have</p>\n\n<pre><code>data Context = Context\n    { contextRotation :: IORef Float,\n    , contextTriangles :: [Triangle]\n    }\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>display :: Context -&gt; DisplayCallback\n</code></pre>\n\n<p>which won't reevaluate triangles at all, they'll be computed only once when <code>Context</code> is created.</p>\n\n<p>Now if there are two parameters, rotation and level, and triangles depend on the level, but not on rotation: The trick here would be to manage dependencies properly. Now we expose the storage for parameters explicitly (<code>IORef Float</code>), and as a consequence, we can't monitor when the value inside changes. But the caller doesn't need to know the representation of how the parameters are stored. It just needs to store them somehow. So instead, let's have</p>\n\n<pre><code>data Context = Context\n    { contextRotation :: IORef Float,\n    , contextTriangles :: IORef [Triangle]\n    }\n</code></pre>\n\n<p>and </p>\n\n<pre><code>setLevel :: Context -&gt; Float -&gt; IO ()\n</code></pre>\n\n<p>That is, we expose a function to store the parameter, but we hide the internals. Now we can implement it as:</p>\n\n<pre><code>setLevel (Context _ trianglesRef) level = do\n    let newTriangles = ... -- compute the new triangles\n    writeIORef trianglesRef newTriangles\n</code></pre>\n\n<p>And as triangles don't depend on the rotation parameter, we can have just:</p>\n\n<pre><code>setRotation :: Context -&gt; Float -&gt; IO ()\nsetRoration (Context rotationRef _) = writeIORef rotationRef\n</code></pre>\n\n<p>Now the dependencies are hidden for callers. They can set the level or the rotation, without knowing what depends on them. At the same time, triangles are updated when needed (level changes), and only then. And Haskell's lazy evaluation gives a nice bonus: If the level changes multiple times before the triangles are needed, they are not evaluated. The <code>[Triangle]</code> thunk inside the <code>IORef</code> will be only evaluated when requested by <code>display</code>.</p>\n"}], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 49834902, "answer_count": 1, "score": 3, "last_activity_date": 1523747697, "creation_date": 1523669363, "last_edit_date": 1523747697, "question_id": 49827020, "link": "https://stackoverflow.com/questions/49827020/how-to-rotate-an-opengl-graphics-in-haskell-without-uselessly-re-evaluating-the", "title": "How to rotate an OpenGL graphics in Haskell without uselessly re-evaluating the graphical objects?", "body": "<p>Simplifying the reality, my OpenGL program has the following structure:</p>\n\n<ul>\n<li><p>At the beginning, there's a function <code>f : (Double,Double,Double) -&gt; Double</code>.  </p></li>\n<li><p>Then there is a function <code>triangulize :: ((Double,Double,Double) -&gt; Double) -&gt; [Triangle]</code> such that <code>triangulize f</code> calculates a triangular mesh of the surface <code>f(x,y,z)=0</code>. </p></li>\n<li><p>Then there is the <code>displayCallback</code>, a function <code>display :: IORef Float -&gt; DisplayCallBack</code> which displays the graphics (that is to say it displays the triangular mesh). The first argument <code>IORef Float</code> is here to rotate the graphics, and its value (the angle of the rotation) changes when the user presses a key on the keyboard, thanks to the <code>keyboardCallback</code> defined later. Don't forget that the <code>display</code> function calls <code>triangulize f</code>. </p></li>\n<li><p>Then the problem is the following one. When the user presses the key to rotate the graphic, the <code>display</code> function is triggered. And then <code>triangulize f</code> is re-evaluated, whereas it doesn't need to be re-evaluated: rotating the graphics does not change the triangular mesh (i.e. the result of <code>triangulize f</code> is the same as before).</p></li>\n</ul>\n\n<p>So, is there a way to rotate the graphics by pressing a key without triggering <code>triangulize f</code> ?  In other words, to \"freeze\" <code>triangulize f</code> so that it is evaluated only once and is never re-evaluated, which is time-consuming but useless since anyway the result is always the same.</p>\n\n<p>I believe this is a standard way to rotate a graphics in Haskell OpenGL (I viewed that way in some tutos), so I don't think it is necessary to post my code. But of course I can post it if needed.</p>\n\n<p>The reality is more complicated since there are other <code>IORef</code>'s to control some parameters of the surface. But I would like to firstly know some solutions for this simplified situation.</p>\n\n<h1>EDIT: more details and some code</h1>\n\n<h2>Simplified code</h2>\n\n<p>So, if I follow the simplified description above, my program looks like</p>\n\n<pre><code>fBretzel5 :: (Double,Double,Double) -&gt; Double\nfBretzel5 (x,y,z) = ((x*x+y*y/4-1)*(x*x/4+y*y-1))^2 + z*z\n\ntriangles :: [Triangle] -- Triangle: triplet of 3 vertices\ntriangles =\n  triangulize fBretzel5 ((-2.5,2.5),(-2.5,2.5),(-0.5,0.5))\n-- \"triangulize f (xbounds, ybounds, zbounds)\"\n--   calculates a triangular mesh of the surface f(x,y,z)=0\n\ndisplay :: IORef Float -&gt; DisplayCallback\ndisplay rot = do\n  clear [ColorBuffer, DepthBuffer]\n  rot' &lt;- get rot\n  loadIdentity\n  rotate rot $ Vector3 1 0 0\n  renderPrimitive Triangles $ do\n    materialDiffuse FrontAndBack $= red\n    mapM_ drawTriangle triangles\n  swapBuffers\n  where\n    drawTriangle (v1,v2,v3) = do\n      triangleNormal (v1,v2,v3) -- the normal of the triangle\n      vertex v1\n      vertex v2\n      vertex v3\n\nkeyboard :: IORef Float -- rotation angle\n         -&gt; KeyboardCallback\nkeyboard rot c _ = do\n  case c of\n    'e' -&gt; rot $~! subtract 2\n    'r' -&gt; rot $~! (+ 2)\n    'q' -&gt; leaveMainLoop\n    _   -&gt; return ()\n  postRedisplay Nothing\n</code></pre>\n\n<p>This causes the issue described above. Each time the key <code>'e'</code> or <code>'r'</code> is pressed, the <code>triangulize</code> function runs while its output remains the same.</p>\n\n<h2>True code (almost)</h2>\n\n<p>Now, here is a version of my program closest to the reality. In fact, it calculates a triangular mesh for a surface <code>f(x,y,z)=l</code>, where the \"isolevel\" <code>l</code> can be changed with the keyboard.</p>\n\n<pre><code>voxel :: IO Voxel\nvoxel = makeVoxel fBretzel5 ((-2.5,2.5),(-2.5,2.5),(-0.5,0.5))\n-- the voxel is a 3D-array of points; each entry of the array is\n--   the value of the function at this point\n-- !! the voxel should never changes throughout the program !!\n\ntrianglesBretz :: Double -&gt; IO [Triangle]\ntrianglesBretz level = do\n  vxl &lt;- voxel\n  computeContour3d vxl level\n-- \"computeContour3d vxl level\" calculates a triangular mesh\n--   of the surface f(x,y,z)=level\n\ndisplay :: IORef Float -&gt; IORef Float -&gt; DisplayCallback\ndisplay rot level = do\n  clear [ColorBuffer, DepthBuffer]\n  rot' &lt;- get rot\n  level' &lt;- get level\n  triangles &lt;- trianglesBretz level'\n  loadIdentity\n  rotate rot $ Vector3 1 0 0\n  renderPrimitive Triangles $ do\n    materialDiffuse FrontAndBack $= red\n    mapM_ drawTriangle triangles\n  swapBuffers\n  where\n    drawTriangle (v1,v2,v3) = do\n      triangleNormal (v1,v2,v3) -- the normal of the triangle\n      vertex v1\n      vertex v2\n      vertex v3\n\nkeyboard :: IORef Float  -- rotation angle\n         -&gt; IORef Double -- isolevel\n         -&gt; KeyboardCallback\nkeyboard rot level c _ = do\n  case c of\n    'e' -&gt; rot $~! subtract 2\n    'r' -&gt; rot $~! (+ 2)\n    'h' -&gt; level $~! (+ 0.1)\n    'n' -&gt; level $~! subtract 0.1\n    'q' -&gt; leaveMainLoop\n    _   -&gt; return ()\n  postRedisplay Nothing\n</code></pre>\n\n<h3>A part of a solution</h3>\n\n<p>In fact, I have found a solution in order to \"freeze\" the voxel:</p>\n\n<pre><code>voxel :: Voxel\n{-# NOINLINE voxel #-}\nvoxel = unsafePerformIO $ makeVoxel fBretzel5 ((-2.5,2.5),(-2.5,2.5),(-0.5,0.5))\n\ntrianglesBretz :: Double -&gt; IO [Triangle]\ntrianglesBretz level =\n  computeContour3d voxel level\n</code></pre>\n\n<p>In this way, I think the <code>voxel</code> is never re-evaluated.</p>\n\n<p>But there is still a problem. When the <code>IORef</code> <code>rot</code> changes, to rotate the graphics, then there's no reason to re-evaluate <code>trianglesBretz</code>: the triangular mesh of <code>f(x,y,z)=level</code> is always the same whatever the rotation.</p>\n\n<p>So, how can I say to the <code>display</code> function: <em>\"hey! when <code>rot</code> changes, do not re-evaluate <code>trianglesBretz</code>, since you will find the same result\"</em> ?</p>\n\n<p>I don't know how to use <code>NOINLINE</code> for <code>trianglesBretz</code>, as I did for <code>voxel</code>. Something which would \"freezes\" <code>trianglesBretz level</code> unless <code>level</code> changes.</p>\n\n<p>And here is the 5-holes bretzel:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Tg2N8.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Tg2N8.png\" alt=\"enter image description here\"></a></p>\n\n<h1>EDIT: solution based on @Petr Pudl\u00e1k's answer.</h1>\n\n<p>After @Petr Pudl\u00e1k's very good answer I came to the following code. I give this solution here in order to place the answer more in the context of <code>OpenGL</code>.</p>\n\n<pre><code>data Context = Context\n    {\n      contextRotation  :: IORef Float\n    , contextTriangles :: IORef [Triangle]\n    }\n\nred :: Color4 GLfloat\nred = Color4 1 0 0 1\n\nfBretz :: XYZ -&gt; Double\nfBretz (x,y,z) = ((x2+y2/4-1)*(x2/4+y2-1))^2 + z*z\n  where\n  x2 = x*x\n  y2 = y*y\n\nvoxel :: Voxel\n{-# NOINLINE voxel #-}\nvoxel = unsafePerformIO $ makeVoxel fBretz ((-2.5,2.5),(-2.5,2.5),(-1,1))\n\ntrianglesBretz :: Double -&gt; IO [Triangle]\ntrianglesBretz level = computeContour3d voxel level\n\ndisplay :: Context -&gt; DisplayCallback\ndisplay context = do\n  clear [ColorBuffer, DepthBuffer]\n  rot &lt;- get (contextRotation context)\n  triangles &lt;- get (contextTriangles context)\n  loadIdentity\n  rotate rot $ Vector3 1 0 0\n  renderPrimitive Triangles $ do\n    materialDiffuse FrontAndBack $= red\n    mapM_ drawTriangle triangles\n  swapBuffers\n  where\n    drawTriangle (v1,v2,v3) = do\n      triangleNormal (v1,v2,v3) -- the normal of the triangle\n      vertex v1\n      vertex v2\n      vertex v3\n\nkeyboard :: IORef Float      -- rotation angle\n         -&gt; IORef Double     -- isolevel\n         -&gt; IORef [Triangle] -- triangular mesh\n         -&gt; KeyboardCallback\nkeyboard rot level trianglesRef c _ = do\n  case c of\n    'e' -&gt; rot $~! subtract 2\n    'r' -&gt; rot $~! (+ 2)\n    'h' -&gt; do\n             l $~! (+ 0.1)\n             l' &lt;- get l\n             triangles &lt;- trianglesBretz l'\n             writeIORef trianglesRef triangles\n    'n' -&gt; do\n             l $~! (- 0.1)\n             l' &lt;- get l\n             triangles &lt;- trianglesBretz l'\n             writeIORef trianglesRef triangles\n    'q' -&gt; leaveMainLoop\n    _   -&gt; return ()\n  postRedisplay Nothing\n\nmain :: IO ()\nmain = do\n  _ &lt;- getArgsAndInitialize\n  _ &lt;- createWindow \"Bretzel\"\n  windowSize $= Size 500 500\n  initialDisplayMode $= [RGBAMode, DoubleBuffered, WithDepthBuffer]\n  clearColor $= white\n  materialAmbient FrontAndBack $= black\n  lighting $= Enabled\n  lightModelTwoSide $= Enabled\n  light (Light 0) $= Enabled\n  position (Light 0) $= Vertex4 0 0 (-100) 1\n  ambient (Light 0) $= black\n  diffuse (Light 0) $= white\n  specular (Light 0) $= white\n  depthFunc $= Just Less\n  shadeModel $= Smooth\n  rot &lt;- newIORef 0.0\n  level &lt;- newIORef 0.1\n  triangles &lt;- trianglesBretz 0.1\n  trianglesRef &lt;- newIORef triangles\n  displayCallback $= display Context {contextRotation = rot,\n                                      contextTriangles = trianglesRef}\n  reshapeCallback $= Just yourReshapeCallback\n  keyboardCallback $= Just (keyboard rot level trianglesRef)\n  idleCallback $= Nothing\n  putStrLn \"*** Bretzel ***\\n\\\n        \\    To quit, press q.\\n\\\n        \\    Scene rotation:\\n\\\n        \\        e, r, t, y, u, i\\n\\\n        \\    Increase/Decrease level: h, n\\n\\\n        \\\"\n  mainLoop\n</code></pre>\n\n<p>And now my bretzel can be rotated without performing useless calculations. </p>\n\n<p><a href=\"https://i.stack.imgur.com/ZLTmG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZLTmG.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1523653334, "post_id": 49824934, "comment_id": 86665996, "body": "This is it exactly, thanks! I&#39;m having an issue with a further test case, but if I can&#39;t figure it out on my own I&#39;ll post a new question (no time to dig into it now -- lunch break is over!)"}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 6, "last_activity_date": 1523652548, "creation_date": 1523652548, "answer_id": 49824934, "question_id": 49824802, "link": "https://stackoverflow.com/questions/49824802/parsec-for-balanced-brackets/49824934#49824934", "title": "Parsec for balanced brackets", "body": "<p>Using <code>many</code> is the right solution, but you need to get rid of the <code>optional</code> first.</p>\n\n<p>The problem is that, as the error message says, <code>optional</code> can match the empty string and the problem with that is that <code>many</code> repeats the match for as long as the given parser can still find a match. If a parser matches the empty string, it'll always find a match (the empty string), so it'll never stop looping. So this is disallowed to prevent infinite loops.</p>\n\n<p>Since <code>many</code> can already match zero occurrences, the <code>optional</code> isn't needed and you can just get rid of it.</p>\n"}], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 426, "favorite_count": 0, "accepted_answer_id": 49824934, "answer_count": 1, "score": 2, "last_activity_date": 1523652548, "creation_date": 1523651950, "question_id": 49824802, "link": "https://stackoverflow.com/questions/49824802/parsec-for-balanced-brackets", "title": "Parsec for balanced brackets", "body": "<p>As an exercise in learning to use Parsec, I'm writing a parser that validates balanced brackets. I'm only worried about the pairs <code>()</code>, <code>[]</code>, and <code>{}</code>, but can't get my parser to handle multiple bracket groups inside the first.</p>\n\n<p>I'm testing against a number of test cases pulled from <a href=\"https://github.com/exercism/haskell/tree/master/exercises/bracket-push\" rel=\"nofollow noreferrer\">the bracket-push exercise</a> from exercism.io, but notable edge cases are:</p>\n\n<pre><code>isBalanced \"\" = True\nisBalanced \"(some[nonsense]with)brackets\" = True\nisBalanced \"}{\" = False   -- reversed brackets no good.\nisBalanced \"{}}\" = False  -- extra ending brackets no good either.\n</code></pre>\n\n<p>and my parser looks like:</p>\n\n<pre><code>import Text.Parsec\nimport Text.Parsec.Char\n\nhasMatchingBrackets = go &gt;&gt; eof\n  where\n  go = skipMany (noneOf \"[{()}]\")\n        &gt;&gt; optional (\n           between (char '(') (char ')') go\n       &lt;|&gt; between (char '{') (char '}') go\n       &lt;|&gt; between (char '[') (char ']') go )\n        &gt;&gt; skipMany (noneOf \"[{()}]\")\n\nisBalanced :: String -&gt; Bool\nisBalanced xs = case parse hasMatchingBrackets \"isBalanced\" xs of\n                  Right _ -&gt; True\n                  Left  _ -&gt; False\n</code></pre>\n\n<p>My parser as-is works for all the above cases, but the following test case that should pass does not</p>\n\n<pre><code>isBalanced \"([{}({}[])])\" = True  -- Fails with the parser above!\n</code></pre>\n\n<p>I've identified the problem as my alternation of <code>between</code>s only allowing one occurrence of <code>go</code> between a pair of brackets, and the open paren in <code>[{}(...</code> makes two, but I'm not sure how to fix it. I tried slapping <code>skipMany1</code> in front of <code>go</code>, to read</p>\n\n<pre><code>    between (char '(') (char ')') (skipMany1 go)\n&lt;|&gt; ...etc\n</code></pre>\n\n<p>but I get the error:</p>\n\n<blockquote>\n  <p>*** Exception: Text.ParserCombinators.Parsec.Prim.many: combinator 'many' is applied to a parser that accepts an empty string.</p>\n</blockquote>\n"}, {"tags": ["haskell", "autocomplete"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1523650581, "post_id": 49823709, "comment_id": 86664879, "body": "I&#39;d recommend using <a href=\"https://hackage.haskell.org/package/haskeline\" rel=\"nofollow noreferrer\"><code>haskeline</code></a> for this. If you really want to do it by hand, <a href=\"https://en.wikipedia.org/wiki/ANSI_escape_code#CSI_sequences\" rel=\"nofollow noreferrer\">ANSI escape sequences</a> are what you&#39;re looking for, but good luck."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1523708988, "post_id": 49823709, "comment_id": 86678026, "body": "@AJFarmar Isn&#39;t that already using <i>haskeline</i>"}], "answers": [{"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 1, "last_activity_date": 1523716436, "last_edit_date": 1523716436, "creation_date": 1523714218, "answer_id": 49832206, "question_id": 49823709, "link": "https://stackoverflow.com/questions/49823709/command-line-autocompletion-based-on-context/49832206#49832206", "title": "Command line autocompletion based on context", "body": "<p>We can extend the state so that <code>searchFunc</code> can behave differently inside a select.</p>\n\n<pre><code>data WholeState = WholeState MyDataState MyCmdlineState\n\ndata MyCmdlineState = TopLevel | Select   -- etc.\n\nsearchFunc (WholeState mydatastate TopLevel) str = (...)  -- what the current searchFunc does\nsearchFunc (WholeState mydatastate Select  ) str = (...)  -- special completion in a select\n</code></pre>\n\n<p>Then use a \"bracket function\" to set the command-line state in a fixed scope.</p>\n\n<pre><code>localCmdlineState :: MonadState WholeState m =&gt; MyCmdlineState -&gt; m a -&gt; m a\nlocalCmdlineState mcstate run = do\n  WholeState mydatastate s0 &lt;- get\n  put (WholeState mydatastate mcstate)\n  run\n  WholeState mydatastate' _ &lt;- get\n  put (WholeState mydatastate' s0)\n</code></pre>\n\n<p>This can be used in <code>parseInput</code>, in the <code>\":select\"</code> case, the <code>getInputLine</code> becomes</p>\n\n<pre><code>inputData &lt;- localCmdlineState Select $ getInputLine \"\\tSelect one of the data elements to be current: \"\n</code></pre>\n\n<hr>\n\n<p>Arguably, <code>localCmdlineState</code> is a bit complex. You have to pay attention to where each bit of the state goes. Another issue is that the <code>MyCmdlineState</code> introduces some indirection that makes the code a bit hard to follow.</p>\n\n<p>One way to alleviate this is to use lenses, so only the relevant parts of <code>WholeState</code> appear in the code when we access them.</p>\n\n<p>An even better approach is to use a different abstraction than <code>MonadState</code> to carry the current state of command-line completion (<code>MyCmdlineState</code>). In particular, I'm thinking of <code>MonadReader</code>, whose <code>local</code> function is exactly what we need.</p>\n\n<p>Instead of a new enumeration type, why not just carry the <code>searchFunc</code> itself:</p>\n\n<pre><code>type SearchFunc = MyDataState -&gt; String -&gt; [Completion]\n</code></pre>\n\n<p>And instead of pattern-matching, we just make more definitions. It's also possible to create and pass <code>SearchFunc</code> on the fly. </p>\n\n<pre><code>topLevelSearchFunc :: SearchFunc\nselectSearchFunc :: SearchFunc\n</code></pre>\n\n<p>We make the stack a bit longer:</p>\n\n<pre><code>type M = ReaderT SearchFunc (StateT MyDataState IO)\n</code></pre>\n\n<p>Implementing <code>MonadReader</code> for <code>InputT</code> is a bit tricky. <code>lift</code>-ing is not sufficient. Hopefully there is <code>mapInputT</code>.</p>\n\n<pre><code>instance MonadReader s m =&gt; MonadReader s (InputT m) where\n    reader = lift . reader\n    local f = mapInputT (local f)\n</code></pre>\n\n<p>Another bit that needs to change is <code>mySettings</code>, which thus gets <code>searchFunc</code> from its environment instead of a constant.</p>\n\n<pre><code>mySettings :: Settings M\nmySettings = Settings { historyFile = Just \"myhist\"\n                      , complete = completeWord Nothing \" \\t\" $ \\str -&gt; do \n                          _data &lt;- get\n                          searchFunc &lt;- ask\n                          return $ searchFunc _data str \n                      , autoAddHistory = True\n                      }\n</code></pre>\n\n<p>In <code>main</code>, we start with <code>topLevelSearchFunc</code></p>\n\n<pre><code>main = do\n    greet\n    runStateT (runReaderT (runInputT mySettings mainLoop) topLevelSearchFunc) MyDataState {mydata = [] , selectedElement = defaultSelectedElement, showEven = defaultFlagValue}\n</code></pre>\n\n<p>In <code>parseInput</code>, we set the <code>SearchFunc</code> locally, with syntax very similar to my previous solution:</p>\n\n<pre><code>inputData &lt;- local (\\_ -&gt; selectSearchFunc) $ getInputLine \"\\tSelect one of the data elements to be current: \"\n</code></pre>\n\n<hr>\n\n<p><a href=\"https://gist.github.com/Lysxia/2e834c48f05b6040576b058694132528\" rel=\"nofollow noreferrer\">Full gist</a></p>\n\n<hr>\n\n<p>The advantage of this is that making <code>SearchFunc</code> only available via a <code>MonadReader</code> effect makes it clear that it can only be modified locally (using <code>local</code>).</p>\n\n<p>The hope is that thus compartmentalizing the various components of the application state prevents them from interfering with each other and reduces the potential for mistakes.</p>\n"}], "owner": {"reputation": 5242, "user_id": 50962, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e39b7acdae85aedee02487bed17ff5f6?s=128&d=identicon&r=PG", "display_name": "altern", "link": "https://stackoverflow.com/users/50962/altern"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 49832206, "answer_count": 1, "score": 0, "last_activity_date": 1523716436, "creation_date": 1523646644, "question_id": 49823709, "link": "https://stackoverflow.com/questions/49823709/command-line-autocompletion-based-on-context", "title": "Command line autocompletion based on context", "body": "<p>I have a following program (and here is the <a href=\"https://ideone.com/sFcL2N\" rel=\"nofollow noreferrer\">link to the program in an online IDE</a>), purpose of which is to explore Haskell command line autocompletion capabilities: </p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances, MultiParamTypeClasses, UndecidableInstances #-}\n\nimport System.Console.Haskeline\nimport System.IO\nimport System.IO.Unsafe\nimport Control.Monad.State.Strict\nimport qualified Data.ByteString.Char8 as B\nimport Data.Maybe\nimport Data.List \nimport qualified Data.Map as M\n\ndata MyDataState = MyDataState {\n  mydata :: [Int],\n  selectedElement :: Int,\n  showEven :: Bool\n} deriving (Show)\n\ninstance MonadState s m =&gt; MonadState s (InputT m) where\n    get = lift get\n    put = lift . put\n    state = lift . state\n\nmyfile :: FilePath\nmyfile = \"data.txt\"\n\ndefaultFlagValue :: Bool\ndefaultFlagValue = False\n\ndefaultSelectedElement :: Int\ndefaultSelectedElement = 0\n\nsaveDataToFile :: [Int] -&gt; IO ()\nsaveDataToFile _data = withFile myfile WriteMode $ \\h -&gt; hPutStr h (unwords $ map show _data)\n\n{-# NOINLINE loadDataFromFile #-} \nloadDataFromFile :: [Int]\nloadDataFromFile = map read . words $ B.unpack $ unsafePerformIO $ B.readFile myfile\n\ngeneralSetOfCommands = M.fromList [\n    (\":help\", \"outputs this help\"), \n    (\":q\", \"quits the program\"), \n    (\":commands\", \"list of all commands applicable to the current selection\"), \n    (\":show\", \"show current set of data\"), \n    (\":save\", \"saves data to file\"), \n    (\":load\", \"loads data from file\"), \n    (\":select\", \"selects one of the data set elements to be current\"), \n    (\":new\", \"adds element to the data set\"), \n    (\":toggleShowEven\", \"toggles the flag that controls output of even data set elements\")\n  ]\nfirstSetOfCommands = M.fromList [\n    (\":command1_1\", \"description of :command1_1\"), \n    (\":command1_2\", \"description of :command1_2\"), \n    (\":command1_3\", \"description of :command1_3\"), \n    (\":command1_4\", \"description of :command1_4\")\n  ]\nsecondSetOfCommands = M.fromList [\n    (\":command2_1\", \"description of :command2_1\"), \n    (\":command2_2\", \"description of :command2_2\"), \n    (\":command2_3\", \"description of :command2_3\"), \n    (\":command2_4\", \"description of :command2_4\")\n  ]\nthirdSetOfCommands = M.fromList [\n    (\":command3_1\", \"description of :command3_1\"), \n    (\":command3_2\", \"description of :command3_2\"), \n    (\":command3_3\", \"description of :command3_3\"), \n    (\":command3_4\", \"description of :command3_4\")\n  ]\n\nsearchFunc :: MyDataState -&gt; String -&gt; [Completion]\nsearchFunc (MyDataState mydata selectedElement showEven) str = \n    map simpleCompletion $ filter (str `isPrefixOf`) (M.keys generalSetOfCommands ++ \n        case selectedElement of \n          1 -&gt; M.keys firstSetOfCommands\n          2 -&gt; M.keys secondSetOfCommands\n          3 -&gt; M.keys thirdSetOfCommands\n          otherwise -&gt; []\n    )\n\nmySettings :: Settings (StateT MyDataState IO)\nmySettings = Settings { historyFile = Just \"myhist\"\n                      , complete = completeWord Nothing \" \\t\" $ \\str -&gt; do \n                          _data &lt;- get\n                          return $ searchFunc _data str \n                      , autoAddHistory = True\n                      }\n\nhelp :: InputT (StateT MyDataState IO) ()\nhelp = commands\n\ncommands :: InputT (StateT MyDataState IO) ()\ncommands = do\n        (MyDataState mydata selectedElement flag) &lt;- get\n        liftIO $ mapM_ putStrLn $ case selectedElement of \n          1 -&gt; M.elems $ M.mapWithKey (\\k v -&gt; k ++ \"\\t - \" ++ v) $ M.unionWith (++) generalSetOfCommands firstSetOfCommands\n          2 -&gt; M.elems $ M.mapWithKey (\\k v -&gt; k ++ \"\\t - \" ++ v) $ M.unionWith (++) generalSetOfCommands secondSetOfCommands\n          3 -&gt; M.elems $ M.mapWithKey (\\k v -&gt; k ++ \"\\t - \" ++ v) $ M.unionWith (++) generalSetOfCommands thirdSetOfCommands\n          otherwise -&gt; M.elems $ M.mapWithKey (\\k v -&gt; k ++ \"\\t - \" ++ v) generalSetOfCommands\n\ntoggleFlag :: InputT (StateT MyDataState IO) ()\ntoggleFlag = do\n  MyDataState mydata selectedElement flag &lt;- get\n  put $ MyDataState mydata selectedElement (not flag)\n\nparseInput :: String -&gt; InputT (StateT MyDataState IO) () \nparseInput inp\n  | \":q\" == inp = return ()\n\n  | \":help\" == inp = help &gt;&gt; mainLoop\n\n  | \":commands\" == inp = (commands &gt;&gt; mainLoop)\n\n  | \":toggleShowEven\" == inp = do \n      toggleFlag \n      MyDataState mydata selectedElement flag &lt;- get\n      liftIO $ putStrLn $ \"Flag has been set to \" ++ (show flag)\n      mainLoop\n\n  | \":select\" == inp = do\n      MyDataState mydata selectedElement showEven &lt;- get\n      inputData &lt;- getInputLine \"\\tSelect one of the data elements to be current: \"\n      case inputData of\n        Nothing -&gt; put (MyDataState mydata selectedElement showEven)\n        Just inputD -&gt;\n          let inputInt = read inputD \n          in if elem inputInt mydata\n            then put (MyDataState mydata inputInt showEven)\n            else do \n              liftIO $ putStrLn $ \"The element you entered (\" ++ (show inputInt) ++ \") has not been found in the data set\"\n              put (MyDataState mydata selectedElement showEven)\n      mainLoop  \n\n  | \":show\" == inp = do\n      MyDataState mydata selectedElement showEven &lt;- get\n      liftIO $ putStrLn $ unwords $ if showEven \n        then map (\\x -&gt; if x == selectedElement then \"[\" ++ show x ++ \"]\" else show x) mydata\n        else map (\\x -&gt; if x == selectedElement then \"[\" ++ show x ++ \"]\" else show x) $ filter odd mydata\n      mainLoop \n\n  | \":save\" == inp = do\n      MyDataState mydata selectedElement _ &lt;- get \n      liftIO $ saveDataToFile mydata\n      mainLoop\n\n  | \":load\" == inp = do\n      put (MyDataState loadDataFromFile defaultSelectedElement defaultFlagValue)\n      mainLoop\n\n  | \":new\" == inp = do\n      MyDataState mydata selectedElement showEven &lt;- get                     -- reads the state\n      inputData &lt;- getInputLine \"\\tEnter data: \"\n      case inputData of \n        Nothing -&gt; \n          put $ if null mydata\n            then ( MyDataState [0] selectedElement showEven )\n            else ( MyDataState mydata selectedElement showEven )\n        Just inputD -&gt; \n          put $ if null mydata \n            then MyDataState [read inputD] selectedElement showEven\n            else MyDataState (mydata ++ [read inputD]) selectedElement showEven -- updates the state\n      mainLoop\n\n  | \":\" == inp = do\n    outputStrLn $ \"\\nNo command \\\"\" ++ inp ++ \"\\\"\\n\"\n    mainLoop\n\n  | otherwise = handleInput inp\n\nhandleInput :: String -&gt; InputT (StateT MyDataState IO) ()\nhandleInput inp = mainLoop\n\nmainLoop :: InputT (StateT MyDataState IO ) ()\nmainLoop = do\n  inp &lt;- getInputLine \"% \"\n  maybe (return ()) parseInput inp\n\ngreet :: IO ()\ngreet = mapM_ putStrLn\n        [ \"\"\n        , \"          MyProgram\"\n        , \"==============================\"\n        , \"For help type \\\":help\\\"\"\n        , \"\"\n        ]\n\nmain :: IO ((), MyDataState)\nmain = do \n    greet \n    runStateT (runInputT mySettings mainLoop) MyDataState {mydata = [] , selectedElement = defaultSelectedElement, showEven = defaultFlagValue}\n</code></pre>\n\n<p>In my <a href=\"https://stackoverflow.com/questions/49617675/extending-the-list-of-static-autocompletion-commands-with-dynamic-values\">previous question</a> I was struggling with adding possibility to take into account program state and form autocompletion list based on that. Now that I have overcome this problem, another question arises - how could I take into account current context of the command line command?</p>\n\n<p>For instance, here is a short example of interaction with my program:</p>\n\n<pre><code>*Main&gt; main\n\n          MyProgram\n==============================\nFor help type \":help\"\n\n% :show\n\n% :new\n    Enter data: 1\n% :new\n    Enter data: 2\n% :new\n    Enter data: 3\n% :select\n    Select one of the data elements to be current: 2\n% :show\n1 3\n% :toggleShowEven\nFlag has been set to True\n% :show\n1 [2] 3\n% :\n:commands        :load            :q               :select          :toggleShowEven  :command2_2      :command2_4\n:help            :new             :save            :show            :command2_1      :command2_3\n% \n</code></pre>\n\n<p>As you can see, it autocompletes list of currently available commands based on current selection (in this example it is value <code>2</code>). But what if I want to generate new set of commands for existing command, <code>:select</code> for example?</p>\n\n<p>In this case, on input </p>\n\n<pre><code>% :select\n    Select one of the data elements to be current: \n</code></pre>\n\n<p>when pressing <kbd>Tab</kbd>, I want to get list of available values for autocompletion <strong><code>1 2 3</code></strong> and only those values. Is it possible to somehow take into account the place where I am calling autocompletion function?</p>\n\n<p>What I expect it to be is different versions of <code>searchFunc</code> function for different context. For example, for <code>:select</code> command it would be <code>selectSearchFunc</code>. But I don't know how could I make it be applied only when <code>:select</code> command is called. It seems that <code>mySettings</code> somehow should be redefined to be applied not on global scope, but on local scope, but it is not really obvious how to do that. I would appreciate any suggestion that would help to resolve this issue.</p>\n"}, {"tags": ["haskell", "syntax-error"], "comments": [{"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 4, "creation_date": 1523640719, "post_id": 49822341, "comment_id": 86660168, "body": "You need the &quot;backtick&quot; (grave accent, `), not the &#39; character."}], "answers": [{"comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1523642743, "post_id": 49822384, "comment_id": 86661186, "body": "Off-topic a bit, but calculating a mean was the example that made arrows &quot;click&quot; for me. <code>average = sum &amp;&amp;&amp; length &gt;&gt;&gt; uncurry div</code>"}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": false, "score": 4, "last_activity_date": 1523640808, "creation_date": 1523640808, "answer_id": 49822384, "question_id": 49822341, "link": "https://stackoverflow.com/questions/49822341/improperly-terminted-character-error-in-haskell/49822384#49822384", "title": "improperly terminted character error in haskell", "body": "<p>Use backticks  to make a function into an infix operator</p>\n\n<pre><code>average xs = sum xs `div` length xs\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9642775, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Rahat Batool", "link": "https://stackoverflow.com/users/9642775/rahat-batool"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1523644849, "creation_date": 1523640608, "last_edit_date": 1523644849, "question_id": 49822341, "link": "https://stackoverflow.com/questions/49822341/improperly-terminted-character-error-in-haskell", "title": "improperly terminted character error in haskell", "body": "<p>I am writing a small piece of code for the average of a list, but it is not working properly and generating an error: \"Improperly terminated character constant\" </p>\n\n<p>I am not able to solve this error. My code is:</p>\n\n<pre><code>average xs = sum xs 'div' length xs\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/29aU2.png\" rel=\"nofollow noreferrer\">This is my small code and error message</a></p>\n"}, {"tags": ["scala", "haskell", "generics", "monads"], "comments": [{"owner": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "edited": false, "score": 0, "creation_date": 1523640285, "post_id": 49821460, "comment_id": 86659928, "body": "<a href=\"https://stackoverflow.com/q/1992532/2303202\">stackoverflow.com/q/1992532/2303202</a> ?"}, {"owner": {"reputation": 325758, "user_id": 415784, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2WX9Z.jpg?s=128&g=1", "display_name": "Nawaz", "link": "https://stackoverflow.com/users/415784/nawaz"}, "reply_to_user": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "edited": false, "score": 1, "creation_date": 1523640371, "post_id": 49821460, "comment_id": 86659967, "body": "@max630: Does that help here, in any way? Could you post an answer if it does so?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1523641298, "post_id": 49821460, "comment_id": 86660471, "body": "@Nawaz, when we think of <code>f</code> as an applicative functor (all monads are applicative functors), it&#39;s common to call values of type <code>f a</code> &quot;actions&quot;, whether or not they actually &quot;do something&quot;. Your <code>combine</code> function can be made to work for <i>all</i> applicative functors: <code>combine :: Applicative f =&gt; f a -&gt; f b -&gt; f (a, b); combine = liftA2 (,)</code>. Indeed, even <code>Applicative</code> is slightly more than you need. You could get away with <code>combine :: Apply f =&gt; f a -&gt; f b -&gt; f (a, b); combine xs ys = (,) &lt;$&gt; xs &lt;.&gt; ys</code>. But <code>Apply</code> isn&#39;t a superclass of <code>Applicative</code>, so in practice that may not be wise."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1523641611, "post_id": 49821460, "comment_id": 86660632, "body": "@dfeuer Could you provide a link to <code>Apply</code>? The closest thing I can find is PureScript&#39;s <code>Apply</code> class, but that doesn&#39;t define <code>&lt;.&gt;</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1523641866, "post_id": 49821460, "comment_id": 86660776, "body": "@chepner, it&#39;s <a href=\"https://hackage.haskell.org/package/semigroupoids-5.2.2/docs/Data-Functor-Bind.html#t:Apply\" rel=\"nofollow noreferrer\">in <code>Data.Functor.Bind</code></a> in <code>semigroupoids</code>. PureScript makes it a superclass of <code>Applicative</code>, so it doesn&#39;t need that oddly-named operator. I forgot about <code>liftF2</code>, which is obviously the better method to use here."}, {"owner": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "edited": false, "score": 0, "creation_date": 1523642528, "post_id": 49821460, "comment_id": 86661093, "body": "I don&#39;t know scala, but you aren&#39;t you basicaly asking can you call monadic method generically? If you could, your <code>compose(x, y)</code> would be written as someting like <code>bind(x, a =&gt; bind (y, b =&gt; pure((a, b))))</code>"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1523643155, "post_id": 49821460, "comment_id": 86661390, "body": "@dfeuer Thanks; odd that Hoogle doesn&#39;t show anything for <code>Apply</code> or <code>&lt;.&gt;</code>, but you can search for <code>semigroupoids</code> itself."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1523668717, "post_id": 49821460, "comment_id": 86669526, "body": "@chepner The haskell.org Hoogle only searches in packages bundled with GHC, unless you specify the extra package(s) (eg. <code>liftF2 +semigroupoids</code>). Stackage Hoogle and Hayoo tend to be more helpful when you don&#39;t know where to look for."}], "answers": [{"comments": [{"owner": {"reputation": 325758, "user_id": 415784, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2WX9Z.jpg?s=128&g=1", "display_name": "Nawaz", "link": "https://stackoverflow.com/users/415784/nawaz"}, "edited": false, "score": 0, "creation_date": 1523641422, "post_id": 49822433, "comment_id": 86660537, "body": "<i>&quot;And the compiler will complain that flatMap is not a member of M[A] and map is not a member of M[B].&quot;</i>... So, what you&#39;ve written will not actually compile and run?"}, {"owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "reply_to_user": {"reputation": 325758, "user_id": 415784, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2WX9Z.jpg?s=128&g=1", "display_name": "Nawaz", "link": "https://stackoverflow.com/users/415784/nawaz"}, "edited": false, "score": 1, "creation_date": 1523641995, "post_id": 49822433, "comment_id": 86660841, "body": "The first line is fine (just the <code>for</code> comprehension on its own). The definition of the function <code>combine</code> as written here will not work."}, {"owner": {"reputation": 38158, "user_id": 2707792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hjDjB.png?s=128&g=1", "display_name": "Andrey Tyukin", "link": "https://stackoverflow.com/users/2707792/andrey-tyukin"}, "edited": false, "score": 1, "creation_date": 1523644399, "post_id": 49822433, "comment_id": 86662027, "body": "If you would compare this to the implementation of Haskell&#39;s runtime environment that supports all those monadic <code>do</code>-comprehensions with type inference, it would&#39;nt look that &quot;insane&quot;. The difference is that in Scala, you can write both the library defining all the <code>Monad</code>-traits, <i>and</i> implement the &quot;runtime system&quot; that is needed to support it in the same library, without any tweaks to the compiler, the runtime system (hidden from the user), or any compiler plugins. Scala Cats is somewhat of an FP-DSL built on top on Scala, with interpreters written in Scala. That&#39;s a different approach."}, {"owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "reply_to_user": {"reputation": 38158, "user_id": 2707792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hjDjB.png?s=128&g=1", "display_name": "Andrey Tyukin", "link": "https://stackoverflow.com/users/2707792/andrey-tyukin"}, "edited": false, "score": 0, "creation_date": 1523645278, "post_id": 49822433, "comment_id": 86662465, "body": "@AndreyTyukin I agree that Scala&#39;s implicits are strictly more powerful than Haskell&#39;s typeclasses. However, there is no runtime support for <code>do</code> notation in Haskell. It&#39;s a syntactic transformation just like Scala&#39;s <code>for</code> that happens at compile time. The different is just that <code>do</code> transforms your syntax using functions that belong to a particular interface which is part of the standard library."}, {"owner": {"reputation": 38158, "user_id": 2707792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hjDjB.png?s=128&g=1", "display_name": "Andrey Tyukin", "link": "https://stackoverflow.com/users/2707792/andrey-tyukin"}, "edited": false, "score": 0, "creation_date": 1523645533, "post_id": 49822433, "comment_id": 86662586, "body": "@user2297560 Yes, <code>Monad</code> is embedded much deeper in Haskell&#39;s standard library. What I meant by the runtime system support: if Haskell&#39;s runtime system didn&#39;t provide special support for all those &quot;interact-with-the-world-IO-monads&quot;, then you couldn&#39;t do anything with it. On the other hand, even though Scala does not mention any monads anywhere in the spec, and does not treat any IO-monads specially, you can still build the whole monadic-applicative zoo from scratch, because Scala has access to all the lower level IO and multithreading and what not."}, {"owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "reply_to_user": {"reputation": 38158, "user_id": 2707792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hjDjB.png?s=128&g=1", "display_name": "Andrey Tyukin", "link": "https://stackoverflow.com/users/2707792/andrey-tyukin"}, "edited": false, "score": 1, "creation_date": 1523646339, "post_id": 49822433, "comment_id": 86662995, "body": "@AndreyTyukin Haskell has full type erasure, so there is no IO type at runtime; it&#39;s a feature of the type system to separate pure computations from those that interact with the world. And I&#39;d argue this is a good thing: you can&#39;t add purity to Scala with a library."}, {"owner": {"reputation": 38158, "user_id": 2707792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hjDjB.png?s=128&g=1", "display_name": "Andrey Tyukin", "link": "https://stackoverflow.com/users/2707792/andrey-tyukin"}, "edited": false, "score": 0, "creation_date": 1523646930, "post_id": 49822433, "comment_id": 86663292, "body": "@user2297560 I&#39;m not talking about type erasure. I&#39;m saying that the interactions with <code>stdin</code> and <code>stdout</code> for the instances of IO that must be implemented somewhere in the runtime system, because they fundamentally cannot be implemented as a pure function from the Haskell itself: there must be something in the runtime system that interprets instances of IO, and does some <i>actual</i> IO, instead of just composing pure plans. Haskell&#39;s monads rely on runtime system support. Scala&#39;s monads rely on nothing, they can implement their interactions with <code>stdin</code> and <code>stdout</code> themselves."}, {"owner": {"reputation": 38158, "user_id": 2707792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hjDjB.png?s=128&g=1", "display_name": "Andrey Tyukin", "link": "https://stackoverflow.com/users/2707792/andrey-tyukin"}, "edited": false, "score": 0, "creation_date": 1523647075, "post_id": 49822433, "comment_id": 86663373, "body": "@user2297560 But yeah, you cannot add purity as a library. You instead have to define each time what is &quot;pure enough&quot; for a particular application, and then stick to conventions and self-discipline, with some support from type system. Again, I can&#39;t say whether it&#39;s &quot;good&quot; or &quot;bad&quot;, it&#39;s different."}, {"owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "reply_to_user": {"reputation": 38158, "user_id": 2707792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hjDjB.png?s=128&g=1", "display_name": "Andrey Tyukin", "link": "https://stackoverflow.com/users/2707792/andrey-tyukin"}, "edited": false, "score": 0, "creation_date": 1523647236, "post_id": 49822433, "comment_id": 86663454, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/168951/discussion-between-user2297560-and-andrey-tyukin\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "is_accepted": false, "score": 3, "last_activity_date": 1523664721, "last_edit_date": 1523664721, "creation_date": 1523641026, "answer_id": 49822433, "question_id": 49821460, "link": "https://stackoverflow.com/questions/49821460/generic-function-that-accepts-two-monadic-values-and-returns-a-single-monadic-va/49822433#49822433", "title": "Generic function that accepts two monadic values and returns a single monadic value", "body": "<p>Your <code>combine</code> function is equivalent to the Scala code</p>\n\n<pre><code>for { a &lt;- x; b &lt;- y } yield (a,b)\n</code></pre>\n\n<p>So you might try defining a function:</p>\n\n<pre><code>def combine[M[_],A,B](x: M[A], y: M[B]): M[(A,B)] = \n    for { a &lt;- x; b &lt;- y } yield (a,b)\n</code></pre>\n\n<p>And the compiler will complain that <code>flatMap</code> is not a member of <code>M[A]</code> and <code>map</code> is not a member of <code>M[B]</code>. </p>\n\n<p>The thing with <code>for</code> is that it is a bit of compiler magic that will accept any type that implements functions called <code>map</code>, <code>flatMap</code>, and <code>withFilter</code>. This is in contrast to Haskell in which we can add (or let the compiler infer) a <code>Monad</code> constraint to let <code>do</code> notation work.</p>\n\n<p>To expand on the answer @JoePallas gave, it is possible to make this work. In fact, the following implementation is essentially how GHC implements typeclasses. The <code>cats</code> and <code>scalaz</code> libraries provide all this stuff for you, but this is how the sausage is made:</p>\n\n<p>First define the interface we need:</p>\n\n<pre><code>trait For[M[_]] {\n    def map[A,B](ma: M[A], f: A =&gt; B): M[B]\n    def flatMap[A,B](ma: M[A],f: A =&gt; M[B]): M[B]\n    def withFilter[A](ma: M[A],q: A =&gt; Boolean): M[A]\n}\n</code></pre>\n\n<p>(I'm using the name <code>For</code> and using a slightly different interface than <code>Monad</code>.)</p>\n\n<p>Then we provide an implicit implementation of this trait <em>for every data type we want to support</em>. Here's an example for <code>Option</code>:</p>\n\n<pre><code>implicit val optionFor = new For[Option] {\n  def map[A,B](ma: Option[A], f: A =&gt; B): Option[B] = ma.map(f)\n  def flatMap[A,B](ma: Option[A],f: A =&gt; Option[B]): Option[B] = ma.flatMap(f)\n  def withFilter[A](ma: Option[A],q: A =&gt; Boolean): Option[A] = ma.withFilter(q).map(a =&gt; a)\n}\n</code></pre>\n\n<p>Then we provide an implicit conversion to a type that can apply these operations:</p>\n\n<pre><code>implicit class ForOps[M[_], A](val ma: M[A]) extends AnyVal {\n  def map[B](f: A =&gt; B)(implicit m: For[M]): M[B] = m.map(ma,f)\n  def flatMap[B](f: A =&gt; M[B])(implicit m: For[M]): M[B] = m.flatMap(ma, f)\n  def withFilter(q: A =&gt; Boolean)(implicit m: For[M]): M[A] = m.withFilter(ma,q)\n}\n</code></pre>\n\n<p>And finally, we can define <code>combine</code>:</p>\n\n<pre><code>def combine[M[_]: For, A, B](ma: M[A], mb: M[B]): M[(A, B)] =\n  for { a &lt;- ma; b &lt;- mb } yield (a, b)\n</code></pre>\n\n<hr>\n\n<p>The syntax</p>\n\n<pre><code>def f[T: TC] = ???\n</code></pre>\n\n<p>is sugar for</p>\n\n<pre><code>def f[T](implicit unutterableName: TC[T]) = ???\n</code></pre>\n\n<p>An <code>implicit</code> argument list, if not given explicitly at the call site, will be automatically filled in by searching for values/functions with the correct types, as long as those are themselves <code>implicit</code>. In this case, we look for a proof that <code>M</code> is a monad. In the body, this value is <code>implicit</code>, and it has no name to access it. Implicit search can still find it. <code>ForOps</code> allows the 3 <code>for</code> operations to automagically appear on the values by using that <code>Monad</code>.</p>\n\n<hr>\n\n<p>This is really an explicit version of how GHC implements typeclasses. In the simplest case of no optimization:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>class Applicative m =&gt; Monad m where\n  return :: a -&gt; m a\n  (&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b\n</code></pre>\n\n<p>compiles to</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Monad m = Monad {\n  monadSubApplicative :: Applicative m\n  return :: forall a. a -&gt; m a\n  (&gt;&gt;=) :: forall a. m a -&gt; (a -&gt; m b) -&gt; m b\n}\n</code></pre>\n\n<p>and</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>instance Monad [] where\n  return = _\n  (&gt;&gt;=) = _\n</code></pre>\n\n<p>becomes</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>monadList :: Monad []\nmonadList = Monad {\n    monadSubApplicative = applicativeList\n  , return = _\n  , (&gt;&gt;=) = _\n}\n</code></pre>\n\n<p>You will often hear the word \"dictionary\" be used to describe the underlying data type and values. And <code>combine</code> is</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>combine :: Monad m -&gt; m a -&gt; m b -&gt; m (a, b)\ncombine (Monad _ return (&gt;&gt;=)) ma mb = ma &gt;&gt;= \\a -&gt; mb &gt;&gt;= \\b -&gt; return (a, b)\n</code></pre>\n\n<p>However, GHC applies a bunch of restrictions to the system that makes it more predictable and performs more optimization. Scala sacrifices this to allow the programmer to perform more interesting acrobatics.</p>\n\n<p>For good measure, an instance like this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>newtype Compose f g a = Compose { unCompose :: f (g a) }\ninstance (Functor f, Functor g) =&gt; Functor (Compose f g) where\n  fmap f (Compose fga) = Compose $ fmap (fmap f) fga\n</code></pre>\n\n<p>would be done like this in Scala (using an <code>implicit def</code>, not a <code>val</code>):</p>\n\n<pre class=\"lang-scala prettyprint-override\"><code>trait Functor[F[_]] { def map[A, B](fa: F[A])(f: A =&gt; B): F[B] }\nfinal case class Compose[F[_], G[_], A](val get: F[G[A]]) extends AnyVal\nobject Compose {\n  // you usually put these implicits in the associated companions\n  // because implicit search is picky about where it looks\n  implicit def functor[F[_], G[_]](implicit\n    functorF: Functor[F],\n    functorG: Functor[G]\n    // type lambda: use a type projection on a refinement type\n    // to create an anonymous type-level function\n    // it's universally accepted as a horrendous abuse of syntax\n    // you can use the kind-projector plugin to avoid writing them (directly)\n  ) : Functor[({type L[X] = Compose[F, G, X]})#L]\n    = new Functor[({type L[X] = Compose[F, G, X]})#L] {\n      override def map[A, B](cfga: Compose[F, G, A])(f: A =&gt; B): Compose[F, G, B] =\n        Compose(functorF.map(cfga.get) { ga =&gt; functorG.map(ga)(f) })\n    }\n}\n</code></pre>\n\n<p>Making all this stuff explicit is a bit ugly, but it works quite well.</p>\n"}, {"comments": [{"owner": {"reputation": 325758, "user_id": 415784, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2WX9Z.jpg?s=128&g=1", "display_name": "Nawaz", "link": "https://stackoverflow.com/users/415784/nawaz"}, "edited": false, "score": 0, "creation_date": 1523641587, "post_id": 49822503, "comment_id": 86660619, "body": "That <a href=\"https://scastie.scala-lang.org/KQAz7HTQSlaRxLCzY8sL6A\" rel=\"nofollow noreferrer\">does not seem to compile</a>, saying <code>map</code> and <code>flatMap</code> not a member of type parameter <code>F[T]</code>. :|"}, {"owner": {"reputation": 7577, "user_id": 5638835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fba9e7db4baba416a82c4277758d886?s=128&d=identicon&r=PG&f=1", "display_name": "puhlen", "link": "https://stackoverflow.com/users/5638835/puhlen"}, "reply_to_user": {"reputation": 325758, "user_id": 415784, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2WX9Z.jpg?s=128&g=1", "display_name": "Nawaz", "link": "https://stackoverflow.com/users/415784/nawaz"}, "edited": false, "score": 0, "creation_date": 1523641960, "post_id": 49822503, "comment_id": 86660823, "body": "@Nawaz you need to include the cats library (or another one that provides a monad typeclass).  Monad is not a concept from the standard scala library."}, {"owner": {"reputation": 2015, "user_id": 3851755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54a860b5b31d0c0ab56ceb2d7e1e819b?s=128&d=identicon&r=PG", "display_name": "Joe Pallas", "link": "https://stackoverflow.com/users/3851755/joe-pallas"}, "edited": false, "score": 0, "creation_date": 1523641996, "post_id": 49822503, "comment_id": 86660845, "body": "Added the imports for cats."}], "tags": [], "owner": {"reputation": 2015, "user_id": 3851755, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/54a860b5b31d0c0ab56ceb2d7e1e819b?s=128&d=identicon&r=PG", "display_name": "Joe Pallas", "link": "https://stackoverflow.com/users/3851755/joe-pallas"}, "is_accepted": false, "score": 7, "last_activity_date": 1523643174, "last_edit_date": 1523643174, "creation_date": 1523641344, "answer_id": 49822503, "question_id": 49821460, "link": "https://stackoverflow.com/questions/49821460/generic-function-that-accepts-two-monadic-values-and-returns-a-single-monadic-va/49822503#49822503", "title": "Generic function that accepts two monadic values and returns a single monadic value", "body": "<p>I think this is the equivalent:</p>\n\n<pre><code>import cats._\nimport cats.implicits._\n\ndef combine[T, F[_]: Monad](fa: F[T], fb: F[T]) = for {\n    a &lt;- fa\n    b &lt;- fb\n  } yield (a, b)\n</code></pre>\n\n<p>Where <code>Monad</code> is from a library (cats or scalaz).</p>\n\n<p><code>combine(Option(10), Option(20))</code> produces <code>Some((10,20))</code> and <code>combine(List(100), List(10, 20))</code> produces <code>List((100,10), (100,20))</code>.</p>\n\n<p>EDIT: The above version is over-constrained, since it requires the two argument types to be the same.  <code>def combine[A, B, F[_]: Monad](fa: F[A], fb: F[B])</code> fixes that.</p>\n"}, {"comments": [{"owner": {"reputation": 325758, "user_id": 415784, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2WX9Z.jpg?s=128&g=1", "display_name": "Nawaz", "link": "https://stackoverflow.com/users/415784/nawaz"}, "edited": false, "score": 0, "creation_date": 1523646984, "post_id": 49823628, "comment_id": 86663323, "body": "Does your scala example work for other monadic values? Can we wrap that in a function to reuse it with other monadic values?"}, {"owner": {"reputation": 1, "user_id": 2013538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H0s5m.jpg?s=128&g=1", "display_name": "jaaptw", "link": "https://stackoverflow.com/users/2013538/jaaptw"}, "reply_to_user": {"reputation": 325758, "user_id": 415784, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2WX9Z.jpg?s=128&g=1", "display_name": "Nawaz", "link": "https://stackoverflow.com/users/415784/nawaz"}, "edited": false, "score": 0, "creation_date": 1523647139, "post_id": 49823628, "comment_id": 86663408, "body": "This example works for each type which has an Applicative instance."}, {"owner": {"reputation": 38158, "user_id": 2707792, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/hjDjB.png?s=128&g=1", "display_name": "Andrey Tyukin", "link": "https://stackoverflow.com/users/2707792/andrey-tyukin"}, "reply_to_user": {"reputation": 325758, "user_id": 415784, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2WX9Z.jpg?s=128&g=1", "display_name": "Nawaz", "link": "https://stackoverflow.com/users/415784/nawaz"}, "edited": false, "score": 0, "creation_date": 1523652420, "post_id": 49823628, "comment_id": 86665642, "body": "@Nawaz My scalaz is somewhat rusty, but I guess it should be something like <code>def foo[A, B, F[_] : Applicative](a: F[A], b: F[B]): F[(A, B)] = (a |@| b)(Tuple2.apply)</code>, so, yes, of course, you can pack it in a function. Again, you would have to write out the <code>Applicative</code> explicitly."}], "tags": [], "owner": {"reputation": 1, "user_id": 2013538, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/H0s5m.jpg?s=128&g=1", "display_name": "jaaptw", "link": "https://stackoverflow.com/users/2013538/jaaptw"}, "is_accepted": false, "score": 0, "last_activity_date": 1523646283, "creation_date": 1523646283, "answer_id": 49823628, "question_id": 49821460, "link": "https://stackoverflow.com/questions/49821460/generic-function-that-accepts-two-monadic-values-and-returns-a-single-monadic-va/49823628#49823628", "title": "Generic function that accepts two monadic values and returns a single monadic value", "body": "<p>In functional programming (and programming in general) it is good practice to use the least powerful abstraction you can find. In the example you gave, you actually don't need the power of a monad. The combine function is liftA2 from the applicative type class. Example:</p>\n\n<pre><code>import Data.Maybe\nimport Control.Applicative\nz= Just 1\ny= Just 2\nliftA2 (,) z y\n&gt; Just (1,2)\n</code></pre>\n\n<p>In Scala you have something similar. An example from the Scalaz library which uses the same abstraction:</p>\n\n<pre><code>import scalaz._, Scalaz._\n(Option(1) |@| Option(2))(Tuple2.apply)\n&gt; res3: Option[(Int, Int)] = Some((1, 2))\n</code></pre>\n\n<p>The reason you don't need the monad abstraction is that the values are independent of each other.</p>\n"}], "owner": {"reputation": 325758, "user_id": 415784, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2WX9Z.jpg?s=128&g=1", "display_name": "Nawaz", "link": "https://stackoverflow.com/users/415784/nawaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 591, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1523672638, "creation_date": 1523636847, "last_edit_date": 1523672638, "question_id": 49821460, "link": "https://stackoverflow.com/questions/49821460/generic-function-that-accepts-two-monadic-values-and-returns-a-single-monadic-va", "title": "Generic function that accepts two monadic values and returns a single monadic value", "body": "\n\n<p>I've the written the following Haskell function which accepts two monadic values and combine them into a single monadic value (it's just to illustrate the degree of genericity (or generic-ness) that Haskell type-system could support).</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>combine x y = do\n  a &lt;- x\n  b &lt;- y\n  return (a, b)\n</code></pre>\n\n<p>and I tested it with three different monads:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>main = do\n  putStrLn $ show $ combine (Just 10) (Just 20)  -- Maybe a\n  putStrLn $ show $ combine [100] [10, 20]       -- [] a\n  a &lt;- combine getLine getLine                   -- IO a\n  putStrLn $ show a\n</code></pre>\n\n<p>And it <a href=\"http://rextester.com/UIOI66432\" rel=\"nofollow noreferrer\">works great</a> as expected. Now, I want to know if Scala's type-system could allow me to write the above function without compromising the genericity. But I don't know Scala enough (though I wish to explore it). So could anyone help me convert this code into Scala?</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "edited": false, "score": 0, "creation_date": 1523633693, "post_id": 49820033, "comment_id": 86656145, "body": "What is the underlying monad in your <code>pp</code> function? Maybe you should add type signatures to it."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1523633812, "post_id": 49820033, "comment_id": 86656218, "body": "BTW, stay the heck away from <code>-fno-warn-tabs</code>..."}], "answers": [{"comments": [{"owner": {"reputation": 755, "user_id": 2961429, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a1b2faedb431e761d235ebb033f60328?s=128&d=identicon&r=PG&f=1", "display_name": "du369", "link": "https://stackoverflow.com/users/2961429/du369"}, "edited": false, "score": 0, "creation_date": 1523634001, "post_id": 49820459, "comment_id": 86656342, "body": "I&#39;m quite new to fp. It will take some time to grasp the concepts in the answer. Thanks!"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 3, "last_activity_date": 1523634686, "last_edit_date": 1523634686, "creation_date": 1523633276, "answer_id": 49820459, "question_id": 49820033, "link": "https://stackoverflow.com/questions/49820033/haskell-parser-sequencing-not-working/49820459#49820459", "title": "Haskell Parser sequencing not working", "body": "<p>To the compiler, your <code>Parser</code> type looks like this (not actual Haskell syntax):</p>\n\n<pre><code>type Parser a = ((-&gt;) String) \u03b1\n where \u03b1 = [(a, String)]\n</code></pre>\n\n<p>So when you use <code>&gt;&gt;=</code> (which is under the hood invoked by the <code>do</code> syntax) with actions of this type, it takes on the signature</p>\n\n<pre><code>(&gt;&gt;=) :: ______m______ \u03b1 -&gt; (\u03b1 -&gt; ______m______ \u03b2) -&gt; ______m______ \u03b2\n(&gt;&gt;=) :: ((-&gt;) String) \u03b1 -&gt; (\u03b1 -&gt; ((-&gt;) String) \u03b2) -&gt; ((-&gt;) String) \u03b2\n</code></pre>\n\n<p>i.e.</p>\n\n<pre><code>(&gt;&gt;=) :: Parser a -&gt; ([(a,String)] -&gt; Parser b) -&gt; Parser b\n</code></pre>\n\n<p>which is not the same signature as <code>(+&gt;&gt;=)</code> \u2013 what you actually want is simply</p>\n\n<pre><code>(&gt;&gt;=)  :: __m___ a -&gt; (a -&gt; __m___ b) -&gt; __m___ b\n(+&gt;&gt;=) :: Parser a -&gt; (a -&gt; Parser b) -&gt; Parser b\n</code></pre>\n\n<p>IOW, with <code>&gt;&gt;=</code> you don't actually use <code>Parser</code> as a monad, rather, <code>Parser</code> redirects you to another monad (the function aka Reader monad).</p>\n\n<p>To actually get <code>Parser</code> to behave as a monad itself, with <code>+&gt;&gt;=</code>'s semantics, you must make the compiler recognise it as an actual undecomposable entity. That means, you need <code>newtype</code> instead of <code>type</code>:</p>\n\n<pre><code>newtype Parser a = Parser (String -&gt; [(a, String)])\n\nitem :: Parser Char\nitem = Parser $ \\inp -&gt; case inp of\n        [] -&gt; []\n        (x:xs) -&gt; [(x, xs)]\n\n\nparse :: Parser a -&gt; String -&gt; [ (a, String) ]\nparse (Parser p) inp = p inp\n\n\nreturn' :: a -&gt; Parser a\nreturn' v = Parser $ \\inp -&gt; [(v,inp)]\n\n\n(+&gt;&gt;=) :: Parser a -&gt; (a -&gt; Parser b) -&gt; Parser b\nParser p +&gt;&gt;= f = Parser $ \\inp -&gt; case parse p inp of\n                    [] -&gt; []\n                    [(v, out)] -&gt; parse (f v) out\n\n\np :: Parser (Char, Char)\np = item +&gt;&gt;= \\x -&gt; \n    item +&gt;&gt;= \\_ -&gt;\n    item +&gt;&gt;= \\y -&gt;\n    return' (x,y)\n\n\npp = do  x &lt;- item\n         item\n         y &lt;- item\n         return' (x,y)\n</code></pre>\n\n<p>Here, <code>pp</code> will now give a clear compile error <code>Could not deduce Monad Parser from a use of do notation...</code>. That shows the compiler is actually trying to do the right thing, but for it to actually work you still need to write out the instance declaration. It's easy since the operators are already there:</p>\n\n<pre><code>instance Functor Parser where\n  fmap = liftM  -- makes use of the `Monad` instance below\ninstance Applicative Parser where\n  pure = return'\n  (&lt;*&gt;) = ap\ninstance Monad Parser where\n  return = return'\n  (&gt;&gt;=) = (+&gt;&gt;=)\n</code></pre>\n\n<p>That's a bit of a backwards definition though \u2013 you're using the strongest and most special interface (monad) for defining the more fundamental operation of the functor type classes. The preferred instantiation path is top-down:</p>\n\n<pre><code>newtype Parser a = Parser (String -&gt; [(a,String)]\n  deriving (Functor)\n\ninstance Applicative Parser where\n  pure v = Parser $ \\inp -&gt; [(v,inp)]\n  Parser pf &lt;*&gt; Parser px = Parser $\n     \\inp -&gt; case pf inp of\n        [] -&gt; []\n        [(f,out)] -&gt; f &lt;$&gt; px out\n\ninstance Monad Parser where\n  return = pure\n  Parser p &gt;&gt;= f = ...\n</code></pre>\n"}], "owner": {"reputation": 755, "user_id": 2961429, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a1b2faedb431e761d235ebb033f60328?s=128&d=identicon&r=PG&f=1", "display_name": "du369", "link": "https://stackoverflow.com/users/2961429/du369"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 49820459, "answer_count": 1, "score": 2, "last_activity_date": 1523634686, "creation_date": 1523631871, "last_edit_date": 1523632474, "question_id": 49820033, "link": "https://stackoverflow.com/questions/49820033/haskell-parser-sequencing-not-working", "title": "Haskell Parser sequencing not working", "body": "<p>I've been <a href=\"https://www.goodreads.com/book/show/912217.Programming_in_Haskell\" rel=\"nofollow noreferrer\">learning Haskell</a> recently. I tried the code below in the book. But it does not work as expected.</p>\n\n<blockquote>\n<pre><code>p :: Parser (Char, Char)\n    p = do x \u2190 item\n           item\n           y \u2190 item\n           return (x , y)\n</code></pre>\n</blockquote>\n\n<p>the books says that:</p>\n\n<blockquote>\n  <p>>parse p \"abcdef\"<br>\n   [ ((\u2019a\u2019, \u2019c\u2019), \"def\") ]</p>\n</blockquote>\n\n<p>But when I tried it, it was like:</p>\n\n<pre><code>*Main&gt; pp \"abcde\"\n[(([('a',\"bcde\")],[('a',\"bcde\")]),\"abcde\")]\n</code></pre>\n\n<hr>\n\n<p>The sequencing operator (+>>=) works but not the <code>do</code> notation. Why?</p>\n\n<p>Here is the complete code. GHCi 8.2.2</p>\n\n<pre><code>{-# OPTIONS_GHC -fno-warn-tabs #-}\ntype Parser a = String -&gt; [(a, String)]\n\nitem :: Parser Char\nitem = \\inp -&gt; case inp of\n        [] -&gt; []\n        (x:xs) -&gt; [(x, xs)]\n\n\nparse :: Parser a -&gt; String -&gt; [ (a, String) ]\nparse p inp = p inp\n\n\nreturn' :: a -&gt; Parser a\nreturn' v = \\inp -&gt; [(v,inp)]\n\n\n(+&gt;&gt;=) :: Parser a -&gt; (a -&gt; Parser b) -&gt; Parser b\np +&gt;&gt;= f = \\inp -&gt; case parse p inp of\n                    [] -&gt; []\n                    [(v, out)] -&gt; parse (f v) out\n\n\np :: Parser (Char, Char)\np = item +&gt;&gt;= \\x -&gt; \n    item +&gt;&gt;= \\_ -&gt;\n    item +&gt;&gt;= \\y -&gt;\n    return' (x,y)\n\n\npp = do  x &lt;- item\n         item\n         y &lt;- item\n         return' (x,y)  --return (x,y) this won't work either\n</code></pre>\n\n<hr>\n\n<p>The output:</p>\n\n<pre><code>*Main&gt; p \"abcde\"\n[(('a','c'),\"de\")]\n*Main&gt; pp \"abcde\"\n[(([('a',\"bcde\")],[('a',\"bcde\")]),\"abcde\")]\n</code></pre>\n\n<p>Where did I go wrong? How do I write function p with do notation?</p>\n"}, {"tags": ["haskell", "reflex-dom"], "answers": [{"tags": [], "owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "is_accepted": false, "score": 1, "last_activity_date": 1524667870, "last_edit_date": 1524667870, "creation_date": 1524124118, "answer_id": 49915510, "question_id": 49819259, "link": "https://stackoverflow.com/questions/49819259/how-can-i-obtain-a-dynamic-bool-that-corresponds-to-the-mouse-being-over-a-certa/49915510#49915510", "title": "How can I obtain a Dynamic Bool that corresponds to the mouse being over a certain element?", "body": "<p>The stuff you need is all found in <a href=\"https://hackage.haskell.org/package/reflex-dom-0.3/docs/Reflex-Dom-Widget-Basic.html\" rel=\"nofollow noreferrer\"><code>Reflex.Dom.Widget.Basic</code></a>. If you create a widget with a function that has a prime in its name, such as <code>el'</code>, you can get a hold of an object of type <code>El</code>, which is a member of <code>HasDomEvent</code>. <code>domEvent</code>, the only method of this class, lets you extract an event stream corresponding to one of a selection of event names. Mixing the events together and converting them to an appropriate <code>Dynamic</code> is then done with some usual Reflex tooling found in <a href=\"https://hackage.haskell.org/package/reflex-0.4.0.1/docs/Reflex-Class.html\" rel=\"nofollow noreferrer\"><code>Reflex.Class</code></a> and <a href=\"https://hackage.haskell.org/package/reflex-0.4.0.1/docs/Reflex-Dynamic.html\" rel=\"nofollow noreferrer\"><code>Reflex.Dynamic</code></a>. You do need to familiarize yourself with these interfaces, but there is a helpful <a href=\"https://github.com/reflex-frp/reflex/blob/0.4/Quickref.md\" rel=\"nofollow noreferrer\">quick reference</a>.</p>\n\n<p><em>(Make sure to use the documentation matching the version of Reflex you build against, as there are significant changes between versions.)</em></p>\n\n<p>One way to encode your case is as follows:</p>\n\n<pre><code>main = mainWidget $ do\n    y &lt;- greenBox\n    z &lt;- mapDyn style y\n    elDynAttr \"div\" z blank\n\nstyle :: Bool -&gt; Map String String\nstyle ...  -- Abridged for brevity.\n\ngreenBox :: MonadWidget t m =&gt; m (Dynamic t Bool)\ngreenBox = do\n    (e, _) &lt;- elAttr' \"div\" (\"style\" =: \"height: 10ex; width: 10ex; background-color: #0c0;\") blank\n    let\n        eEnter = domEvent Mouseenter e\n        eLeave = domEvent Mouseleave e\n    holdDyn False . leftmost $ [True &lt;$ eEnter, False &lt;$ eLeave]\n</code></pre>\n\n<p>What we do here is create a widget for the green box that returns a Dynamic indicating whether it is \"activated\". Everything else is just as it were in your initial example.</p>\n\n<p>Thanks to <a href=\"https://www.reddit.com/user/dalaing\" rel=\"nofollow noreferrer\">/u/dalaing</a> for <a href=\"https://www.reddit.com/r/reflexfrp/comments/8cfkjv/how_can_i_obtain_a_dynamic_bool_that_corresponds/dxfdff5/\" rel=\"nofollow noreferrer\">advising me</a> on this.</p>\n"}], "owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 170, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1524667870, "creation_date": 1523629589, "question_id": 49819259, "link": "https://stackoverflow.com/questions/49819259/how-can-i-obtain-a-dynamic-bool-that-corresponds-to-the-mouse-being-over-a-certa", "title": "How can I obtain a Dynamic Bool that corresponds to the mouse being over a certain element?", "body": "<p>Suppose I have a button and a square, like this:</p>\n\n<pre><code>main = mainWidget $ do\n    x &lt;- button \"Change color.\"\n    y &lt;- toggle False x\n    z &lt;- mapDyn style y\n    elDynAttr \"div\" z blank\n\nstyle :: Bool -&gt; Map String String\nstyle b | b         = \"style\" =: \"height: 10ex; width: 10ex; background-color: #f00;\"\n        | otherwise = \"style\" =: \"height: 10ex; width: 10ex; background-color: #900;\"\n</code></pre>\n\n<p>The colour of the square will alternate between bright and dark red when the button is pressed.</p>\n\n<p>I want to replace the button with a green rectangle in such a way that, when mouse pointer is over it, the red square is bright, otherwise dark. For bonus points, I would like the green rectangle to be a <code>div tabindex=0</code> and to make sure the red square is bright when it has focus, but, once I understand the general approach, I will likely be able to figure that out by myself.</p>\n\n<p>My guess is that there is some API that allows adding event handlers to <code>el</code>, but I did not find one so far. And maybe there is a different approch altogether, that I could not know?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1523626701, "post_id": 49818171, "comment_id": 86651202, "body": "Is <code>v</code> always uniquely defined by <code>k</code> and <code>m</code>? If so, <a href=\"https://wiki.haskell.org/Functional_dependencies\" rel=\"nofollow noreferrer\"><code>FunctionalDependencies</code></a> is what you want. Otherwise, it&#39;s not possible."}, {"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1523626996, "post_id": 49818171, "comment_id": 86651412, "body": "No, in my case I might have <code>(MapsTo String Bool, MapsTo String Int)</code>."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1523627739, "post_id": 49818171, "comment_id": 86651985, "body": "Then it is not possible, sorry."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1523628044, "post_id": 49818171, "comment_id": 86652218, "body": "Sure it is, if you don&#39;t like an extra <code>Proxy v</code> parameter then you can still pass a <code>v</code> parameter... It just isn&#39;t very elegant."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1523628178, "post_id": 49818171, "comment_id": 86652314, "body": "@ThomasM.DuBuisson, that seems rather old-fashioned these days, and makes it hard to see that everything is okay."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1523630435, "post_id": 49818171, "comment_id": 86653942, "body": "@DamianNadales Just to push back a bit: the evidence you give (&quot;I have <code>MapsTo String Bool</code> and <code>MapsTo String Int</code>&quot;, N.B. these do not even have kind <code>Constraint</code>, but <code>* -&gt; Constraint</code>) does not support the conclusion you draw (&quot;<code>k</code> and <code>m</code> do not uniquely define <code>v</code>&quot;). Are you <i>sure</i> that functional dependencies will not help?"}, {"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1523632791, "post_id": 49818171, "comment_id": 86655539, "body": "Thanks for pushing back :) Sorry, I meant <code>MapsTo String Bool mm</code> and <code>MapsTo String Bool Int mm</code> for the same <code>mm</code>. So in this case <code>k</code> and <code>m</code> do not determine <code>v</code>, do they?"}], "answers": [{"comments": [{"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1523629737, "post_id": 49818806, "comment_id": 86653450, "body": "I found the last option (<code>AllowAmbiguousTypes</code> + <code>TypeApplications</code> + <code>ScopedTypeVariables</code>) to be the more elegant one."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 2, "last_activity_date": 1523630241, "last_edit_date": 1523630241, "creation_date": 1523628120, "answer_id": 49818806, "question_id": 49818171, "link": "https://stackoverflow.com/questions/49818171/solving-this-ambiguous-type-issue-without-resorting-to-proxy/49818806#49818806", "title": "Solving this ambiguous type issue without resorting to Proxy", "body": "<p>When you really need to pass a type as an argument, you basically have four options, two standard and two GHC-specific:</p>\n\n<h3>Standard options</h3>\n\n<p>As you've recognized, you can use <code>proxy</code> arguments, typically instantiated to <code>Proxy</code>:</p>\n\n<pre><code>keys :: MapsTo k v m =&gt; proxy v -&gt; m -&gt; [k]\n</code></pre>\n\n<p>The caller may (but need not) call this with a <code>Proxy</code> value; if they have another type on hand with the right structure, that will do as well.</p>\n\n<p>The other standard option is to use either <code>Const</code> or its flipped cousin <code>Tagged</code>, which was designed for this purpose:</p>\n\n<pre><code>import Data.Tagged\n\n-- Either\nkeys :: MapsTo k v m =&gt; Tagged v (m -&gt; [k])\n-- or\nkeys :: MapsTo k v m =&gt; m -&gt; Tagged v [k]\n</code></pre>\n\n<h3>GHC-specific options</h3>\n\n<p>You're unlikely to want it, but <code>GHC.Exts</code> offers a type <code>Proxy#</code>, which is a sort of proxy that's never actually passed at runtime, so it shouldn't have any performance cost.</p>\n\n<pre><code>keys :: MapsTo k v m =&gt; Proxy# v -&gt; m -&gt; [k]\n-- called like this:\nkeys (proxy# :: Proxy# Int) m\n</code></pre>\n\n<p>Whereas it was once mostly useless, <code>AllowAmbiguousTypes</code> is now valuable in combination with <code>TypeApplications</code> and <code>ScopedTypeVariables</code>. You can write</p>\n\n<pre><code>keys :: forall v m k. MapsTo k v m =&gt; m -&gt; [k]\n\n:t keys @Int\nkeys @Int :: MapsTo k Int m =&gt; m -&gt; [k]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": false, "score": 2, "last_activity_date": 1523628549, "creation_date": 1523628549, "answer_id": 49818964, "question_id": 49818171, "link": "https://stackoverflow.com/questions/49818171/solving-this-ambiguous-type-issue-without-resorting-to-proxy/49818964#49818964", "title": "Solving this ambiguous type issue without resorting to Proxy", "body": "<p>The dependency between <code>k</code>, <code>v</code>, <code>m</code> might be described functionally by an additional parameter. For example, let's call it <code>f</code> for \"field\", and assume that <code>f</code> and <code>k</code> determine <code>v</code>:</p>\n\n<pre><code>class MapsTo f k v m | f k -&gt; v where\n  innerMap :: m -&gt; Map k v\n\nkeys :: forall f k v m. MapsTo f k v m =&gt; m -&gt; [k]\n</code></pre>\n\n<p>Then you can apply <code>keys</code> to <code>f</code> instead of <code>v</code>, which can sometimes be more elegant, e.g., when <code>f</code> is just a symbol and <code>v</code> is a complex type that you'd rather not spell out.</p>\n\n<pre><code>keys @f :: m -&gt; [k]  -- v determined by f and k\n</code></pre>\n"}], "owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 49818806, "answer_count": 2, "score": 1, "last_activity_date": 1523630241, "creation_date": 1523626032, "last_edit_date": 1523627103, "question_id": 49818171, "link": "https://stackoverflow.com/questions/49818171/solving-this-ambiguous-type-issue-without-resorting-to-proxy", "title": "Solving this ambiguous type issue without resorting to Proxy", "body": "<p>I have the following type-class:</p>\n\n<pre><code>class MapsTo k v m where\n    innerMap :: m -&gt; Map k v\n</code></pre>\n\n<p>If I declare the following function signature:</p>\n\n<pre><code>keys :: MapsTo k v m =&gt; m -&gt; [k]\n</code></pre>\n\n<p>I get the following error:</p>\n\n<pre><code>Could not deduce (MapsTo k v0 m)\n  from the context: MapsTo k v m\n    bound by the type signature for:\n               keys :: forall k v m. MapsTo k v m =&gt; m -&gt; [k]\n</code></pre>\n\n<p>Which makes sense since <code>v</code> is not used anywhere as type parameter.</p>\n\n<p>Since I think using <code>AllowAmbiguousTypes</code> is not a good idea, I resorted to <code>Data.Proxy</code>:</p>\n\n<pre><code>keys :: MapsTo k v m =&gt; Proxy v -&gt; m -&gt; [k]\n</code></pre>\n\n<p>This works, but I'm wondering if there's a way to solve this without resorting to <code>Proxy</code>.</p>\n\n<p>Note that for my problem at hand, any two combination of <code>k</code>, <code>v</code>, or <code>m</code> does not uniquely determine the remaining type. So sadly, using functional dependencies won't help in my case.</p>\n"}, {"tags": ["haskell", "function-composition"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1523624118, "post_id": 49817540, "comment_id": 86649512, "body": "What dou you mean with &quot;<i>Why is it in such a type</i>&quot;?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1523625560, "post_id": 49817540, "comment_id": 86650438, "body": "Remember that <code>(-&gt;) a</code> is an <code>Applicative</code>."}, {"owner": {"reputation": 11, "user_id": 9641515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17cb11ab48adb7ecccad55ee4b95ba21?s=128&d=identicon&r=PG&f=1", "display_name": "CLQ0728", "link": "https://stackoverflow.com/users/9641515/clq0728"}, "edited": false, "score": 0, "creation_date": 1523625802, "post_id": 49817540, "comment_id": 86650594, "body": "Thanks for the comment, I know it&#39;s an Applicative, what can it help to evolve the composition?"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 9641515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17cb11ab48adb7ecccad55ee4b95ba21?s=128&d=identicon&r=PG&f=1", "display_name": "CLQ0728", "link": "https://stackoverflow.com/users/9641515/clq0728"}, "edited": false, "score": 0, "creation_date": 1523625860, "post_id": 49817958, "comment_id": 86650624, "body": "thanks for the help, so how can we do after that, do you have any suggestions?"}, {"owner": {"reputation": 11, "user_id": 9641515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17cb11ab48adb7ecccad55ee4b95ba21?s=128&d=identicon&r=PG&f=1", "display_name": "CLQ0728", "link": "https://stackoverflow.com/users/9641515/clq0728"}, "edited": false, "score": 0, "creation_date": 1523626233, "post_id": 49817958, "comment_id": 86650859, "body": "I guess there should be some theorem from mathematical side(lambda calculus) to deal with the f(a-&gt;b) and f a -&gt; f b stuff. something like structure distributive law. I&#39;m not sure... :-("}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 11, "user_id": 9641515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17cb11ab48adb7ecccad55ee4b95ba21?s=128&d=identicon&r=PG&f=1", "display_name": "CLQ0728", "link": "https://stackoverflow.com/users/9641515/clq0728"}, "edited": false, "score": 0, "creation_date": 1523646221, "post_id": 49817958, "comment_id": 86662938, "body": "@CLQ0728 You just need to substitute everything. See the edit above."}, {"owner": {"reputation": 11, "user_id": 9641515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17cb11ab48adb7ecccad55ee4b95ba21?s=128&d=identicon&r=PG&f=1", "display_name": "CLQ0728", "link": "https://stackoverflow.com/users/9641515/clq0728"}, "edited": false, "score": 0, "creation_date": 1523701797, "post_id": 49817958, "comment_id": 86676015, "body": "Thanks a lot \ud83d\udc4c\ud83d\udc4d"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1523646129, "last_edit_date": 1523646129, "creation_date": 1523625339, "answer_id": 49817958, "question_id": 49817540, "link": "https://stackoverflow.com/questions/49817540/haskell-function-composition/49817958#49817958", "title": "Haskell-function composition ((&lt;*&gt;) . (&lt;*&gt;))", "body": "<p>Your reasoning is correct, as far as I can see.</p>\n\n<p>The next step, as you wrote, is solving</p>\n\n<pre><code>f2 a2 -&gt; f2 b2 = f1 (a1 -&gt; b1)\n</code></pre>\n\n<p>which is, in prefix notation,</p>\n\n<pre><code>(-&gt;) (f2 a2) (f2 b2) = f1 (a1 -&gt; b1)\n</code></pre>\n\n<p>this means that</p>\n\n<pre><code>(-&gt;) (f2 a2) = f1\nf2 b2 = a1 -&gt; b1 = (-&gt;) a1 b1\n</code></pre>\n\n<p>so,</p>\n\n<pre><code>(-&gt;) (f2 a2) = f1\nf2 = (-&gt;) a1\nb2 = b1\n</code></pre>\n\n<p>I think you can continue from here. Just remember to interpret <code>x -&gt; y</code> as <code>(-&gt;) x y</code>.</p>\n\n<hr>\n\n<p>Exploiting the above, plus your own findings for <code>a</code> and <code>c</code>, we get:</p>\n\n<pre><code>a = f2 (a2 -&gt; b2) \n  = (-&gt;) a1 (a2 -&gt; b2)\n  = a1 -&gt; a2 -&gt; b2\n  = a1 -&gt; a2 -&gt; b1\n\nc = f1 a1 -&gt; f1 b1\n  = (-&gt;) (f2 a2) a1 -&gt; (-&gt;) (f2 a2) b1\n  = (f2 a2 -&gt; a1) -&gt; (f2 a2 -&gt; b1)\n  = ((-&gt;) a1 a2 -&gt; a1) -&gt; ((-&gt;) a1 a2 -&gt; b1)\n  = ((a1 -&gt; a2) -&gt; a1) -&gt; (a1 -&gt; a2) -&gt; b1\n\na -&gt; c =\n  = (a1 -&gt; a2 -&gt; b1) -&gt; ((a1 -&gt; a2) -&gt; a1) -&gt; (a1 -&gt; a2) -&gt; b1\n</code></pre>\n\n<p>which is the original type (with <code>b</code> renamed as <code>b1</code> here).</p>\n"}], "owner": {"reputation": 11, "user_id": 9641515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17cb11ab48adb7ecccad55ee4b95ba21?s=128&d=identicon&r=PG&f=1", "display_name": "CLQ0728", "link": "https://stackoverflow.com/users/9641515/clq0728"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1523998124, "creation_date": 1523624080, "last_edit_date": 1523998124, "question_id": 49817540, "link": "https://stackoverflow.com/questions/49817540/haskell-function-composition", "title": "Haskell-function composition ((&lt;*&gt;) . (&lt;*&gt;))", "body": "<pre><code>    ((&lt;*&gt;) . (&lt;*&gt;))\n    --In GHCi\n    :: (a1 -&gt; a2 -&gt; b) -&gt; ((a1 -&gt; a2) -&gt; a1) -&gt; (a1 -&gt; a2) -&gt; b\n</code></pre>\n\n<p>Why is it in such type? how can it evolve to such type?</p>\n\n<pre><code>    :t ((&lt;*&gt;) .)\n\n    ((&lt;*&gt;) .)\n      :: Applicative f =&gt; (a1 -&gt; f (a2 -&gt; b)) -&gt; a1 -&gt; f a2 -&gt; f b\n\n    :t (. (&lt;*&gt;))\n    (. (&lt;*&gt;))\n      :: Applicative f =&gt; ((f a -&gt; f b) -&gt; c) -&gt; f (a -&gt; b) -&gt; c\n\n    ((&lt;*&gt;) . (&lt;*&gt;))\n    --from left to right\n</code></pre>\n\n<ol>\n<li><code>(&lt;*&gt;) :: Applicative f1 =&gt; f1 (a1 -&gt; b1) -&gt; f1 a1 -&gt; f1 b1</code>;</li>\n<li><code>(.) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c</code>;</li>\n<li><code>(&lt;*&gt;) :: Applicative f2 =&gt; f2 (a2 -&gt; b2) -&gt; f2 a2 -&gt; f2 b2</code>;</li>\n</ol>\n\n<p>In <strong>2.</strong>, <code>(a -&gt; b)</code>, let <strong>3.</strong> <code>f2 (a2 -&gt; b2) = a</code>;  therefore, <code>b</code> should be <code>f2 a2 -&gt; f2 b2</code>, <code>(b -&gt; c)</code>, replaced by <strong>1.</strong>, <code>b</code> is <code>f1 (a1 -&gt; b1)</code>, <code>c</code> should be <code>f1 a1 -&gt; f1 b1</code> <p>\nHowever, <code>b</code> should be equal to each other, <code>f2 a2 -&gt; f2 b2 = f1 (a1 -&gt; b1)</code>  ?     how to fit both to each other\nIn GHCi, it seems it replaces <code>f (a -&gt; b)</code> with <code>a1</code> or <code>a2</code>, then how it goes forward?</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523622292, "post_id": 49816908, "comment_id": 86648231, "body": "It&#39;s a <i>monad</i>, not a <i>nomad</i>..."}, {"owner": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1523622410, "post_id": 49816908, "comment_id": 86648324, "body": "edited , thanks I will invent the Nomad story about the Monads :-)"}], "answers": [{"tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": false, "score": 8, "last_activity_date": 1523625229, "last_edit_date": 1523625229, "creation_date": 1523623007, "answer_id": 49817168, "question_id": 49816908, "link": "https://stackoverflow.com/questions/49816908/mixing-either-and-maybe-monads/49817168#49817168", "title": "Mixing Either and Maybe Monads", "body": "<p>Use a function to convert <code>Maybe</code> to <code>Either</code></p>\n\n<pre><code>note :: Maybe a -&gt; e -&gt; Either e a\nnote Nothing e = Left e\nnote (Just a) _ = Right a\n\nhello l = do\n  v &lt;- validateContainsJoAndAppendBob l `note` \"Does not contain \\\"Jo\\\"\"\n  r &lt;- validateLengthFunction v\n  return $ \"Hello \" ++ r\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1523634445, "post_id": 49820429, "comment_id": 86656631, "body": "I like your first option."}, {"owner": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "edited": false, "score": 0, "creation_date": 1523650002, "post_id": 49820429, "comment_id": 86664656, "body": "that is really a first class answer. Thanks a lot."}], "tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 6, "last_activity_date": 1523633159, "creation_date": 1523633159, "answer_id": 49820429, "question_id": 49816908, "link": "https://stackoverflow.com/questions/49816908/mixing-either-and-maybe-monads/49820429#49820429", "title": "Mixing Either and Maybe Monads", "body": "<p>In addition to the practical answer given by Li-yao Xia, there's other alternatives. Here's two.</p>\n\n<h1>Maybe-Either isomorphism</h1>\n\n<p><code>Maybe a</code> is isomorphic to <code>Either () a</code>, which means that there's a lossless translation between the two:</p>\n\n<pre><code>eitherFromMaybe :: Maybe a -&gt; Either () a\neitherFromMaybe (Just x) = Right x\neitherFromMaybe  Nothing = Left ()\n\nmaybeFromEither :: Either () a -&gt; Maybe a\nmaybeFromEither (Right x) = Just x\nmaybeFromEither (Left ()) = Nothing\n</code></pre>\n\n<p>You can use one of these to translate to the other. Since <code>validateLengthFunction</code> returns an error text on failure, it would be a lossy translation to turn its return value into a <code>Maybe String</code> value, so it's better to use <code>eitherFromMaybe</code>.</p>\n\n<p>The problem with that, though, is that this will only give you an <code>Either () String</code> value, and you need an <code>Either String String</code>. You can solve this by taking advantage of <code>Either</code> being a <code>Bifunctor</code> instance. First,</p>\n\n<pre><code>import Data.Bifunctor\n</code></pre>\n\n<p>and then you can write <code>hello</code> as:</p>\n\n<pre><code>hello :: String -&gt; Either String String\nhello l = do\n  v &lt;-\n    first (const \"Doesn't contain 'Jo'.\") $\n    eitherFromMaybe $\n    validateContainsJoAndAppendBob l\n  r &lt;- validateLengthFunction v\n  return $ \"Hello \" ++ r \n</code></pre>\n\n<p>This essentially does the same as Li-yao Xia's answer - a little less practical, but also a little less ad-hoc.</p>\n\n<p>The <code>first</code> function maps the first (left-most) case of an <code>Either</code> value. In this case, if the return value from <code>validateContainsJoAndAppendBob</code> is a <code>Left</code> value, it's always going to be <code>Left ()</code>, so you can use <code>const</code> to ignore the <code>()</code> input and return a <code>String</code> value.</p>\n\n<p>This gets the job done:</p>\n\n<pre><code>*Q49816908&gt; hello \"Job, \"\nLeft \"to short\"\n*Q49816908&gt; hello \"Cool job, \"\nLeft \"Doesn't contain 'Jo'.\"\n*Q49816908&gt; hello \"Cool Job, \"\nRight \"Hello Cool Job, Bob\"\n</code></pre>\n\n<p>This alternative I prefer to the next one, but just for completeness' sake:</p>\n\n<h1>Monad transformers</h1>\n\n<p>Another option is using Monad transformers. You can either wrap the <code>Maybe</code> in an <code>EitherT</code>, or conversely wrap an <code>Either</code> in <code>MaybeT</code>. The following example does the latter.</p>\n\n<pre><code>import Control.Monad.Trans (lift)\nimport Control.Monad.Trans.Maybe (MaybeT(..))\n\nhelloT :: String -&gt; MaybeT (Either String) String\nhelloT l = do\n  v &lt;- MaybeT $ return $ validateContainsJoAndAppendBob l\n  r &lt;- lift $ validateLengthFunction v\n  return $ \"Hello \" ++ r\n</code></pre>\n\n<p>This also works, but here you still have to deal with the various combinations of <code>Just</code>, <code>Nothing</code>, <code>Left</code>, and <code>Right</code>:</p>\n\n<pre><code>*Q49816908&gt; helloT \"Job, \"\nMaybeT (Left \"to short\")\n*Q49816908&gt; helloT \"Cool job, \"\nMaybeT (Right Nothing)\n*Q49816908&gt; helloT \"Cool Job, \"\nMaybeT (Right (Just \"Hello Cool Job, Bob\"))\n</code></pre>\n\n<p>If you want to peel off the <code>MaybeT</code> wrapper, you can use <code>runMaybeT</code>:</p>\n\n<pre><code>*Q49816908&gt; runMaybeT $ helloT \"Cool Job, \"\nRight (Just \"Hello Cool Job, Bob\")\n</code></pre>\n\n<p>In most cases, I'd probably go with the first option...</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 5, "last_activity_date": 1523636176, "last_edit_date": 1523636176, "creation_date": 1523634258, "answer_id": 49820750, "question_id": 49816908, "link": "https://stackoverflow.com/questions/49816908/mixing-either-and-maybe-monads/49820750#49820750", "title": "Mixing Either and Maybe Monads", "body": "<p>What you want is (in the categorical sense) a natural transformation from <code>Maybe</code> to <code>Either String</code>, which the <code>maybe</code> function can provide.</p>\n\n<pre><code>maybeToEither :: e -&gt; Maybe a -&gt; Either e a\nmaybeToEither e = maybe (Left e) Right\n\n\nhello l = do\n  v &lt;- maybeToEither \"No Jo\" (validateContainsJoAndAppendBob l)\n  r &lt;- validateLengthFunction v\n  return $ \"Hello \" ++ r\n</code></pre>\n\n<p>You can use <code>&lt;=&lt;</code> from <code>Control.Monad</code> to compose the two validators.</p>\n\n<pre><code>hello l = do\n    r &lt;- validateLengthFunction &lt;=&lt; maybeToEither \"No Jo\" . validateContainsJoAndAppendBob $ l\n    return $ \"Hello \" ++ r\n</code></pre>\n\n<p>You can also use  <code>&gt;=&gt;</code> and <code>return</code> to turn the whole thing into a single monstrous point-free definition.</p>\n\n<pre><code>hello =      maybeToEither \"No Jo\" . validateContainsJoAndAppendBob\n         &gt;=&gt; validateLengthFunction\n         &gt;=&gt; return . (\"Hello \" ++)\n</code></pre>\n"}], "owner": {"reputation": 1758, "user_id": 8724882, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d88f8198fb4ae68267aced911e3533f9?s=128&d=identicon&r=PG&f=1", "display_name": "sandwood", "link": "https://stackoverflow.com/users/8724882/sandwood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1198, "favorite_count": 2, "accepted_answer_id": 49820429, "answer_count": 3, "score": 3, "last_activity_date": 1523636176, "creation_date": 1523622173, "last_edit_date": 1523633253, "question_id": 49816908, "link": "https://stackoverflow.com/questions/49816908/mixing-either-and-maybe-monads", "title": "Mixing Either and Maybe Monads", "body": "<p>I think I understand how to cascade Monad of the same type. I would like to combine two Monads together to perform an operation based on them : </p>\n\n<p>I think the code below resume the problem :  suppose we have a function that validates that a String contains \"Jo\" and append \"Bob\" to it if it's the case, and another one that validates that the String length is > 8</p>\n\n<p>The hello function would apply the first , then the second on the result of the first and return \"Hello\" to all that in case of success or 'Nothing' (I don't know what is this 'Nothing' btw , Left or Nothing)  in case of error.</p>\n\n<p>I believe that it's around Monad transformer what I need but I could not find a concise example that would help me to start.</p>\n\n<p>I precise that this is nothing theoratical as there is around Haskell package that works with Either and others that works with Maybe</p>\n\n<pre><code>validateContainsJoAndAppendBob :: String -&gt; Maybe String\nvalidateContainsJoAndAppendBob l =\n  case isInfixOf \"Jo\" l of\n    False -&gt; Nothing\n    True  -&gt; Just $ l ++ \"Bob\"\n\nvalidateLengthFunction :: Foldable t =&gt; t a -&gt; Either String (t a)\nvalidateLengthFunction l =\n  case (length l &gt; 8)  of\n    False -&gt; Left \"to short\"\n    True  -&gt; Right l\n\n-- hello l = do\n  -- v &lt;- validateContainsJoAndAppendBob l\n  -- r &lt;- validateLengthFunction v\n  -- return $ \"Hello \" ++ r \n</code></pre>\n"}, {"tags": ["haskell", "tuples"], "comments": [{"owner": {"reputation": 4295, "user_id": 1916893, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/XTlc8.png?s=128&g=1", "display_name": "TobiMcNamobi", "link": "https://stackoverflow.com/users/1916893/tobimcnamobi"}, "edited": false, "score": 4, "creation_date": 1523616141, "post_id": 49814883, "comment_id": 86644353, "body": "Are you searching for something like <code>f (x, y, u, v) = (x, u, y, v)</code>? Or is there something I am missing?"}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 9640985, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Simon West", "link": "https://stackoverflow.com/users/9640985/simon-west"}, "edited": false, "score": 0, "creation_date": 1523952027, "post_id": 49815306, "comment_id": 86760744, "body": "Perfect!! Thanks a lot :)"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1523617841, "last_edit_date": 1523617841, "creation_date": 1523616686, "answer_id": 49815306, "question_id": 49814883, "link": "https://stackoverflow.com/questions/49814883/change-order-of-tuple-in-haskell/49815306#49815306", "title": "Change order of tuple in Haskell", "body": "<p>You can use pattern matching here, and then construct a <em>new</em> tuple with the desired order. For example:</p>\n\n<pre><code>changeorder :: (a, b, c, d) -&gt; (a, c, b, d)\nchangeorder (lef, rig, high, copy) = (lef, high, rig, copy)\n</code></pre>\n\n<p>Note that this function has a more generic signature (here <code>lef</code>, <code>rig</code>, etc. can have different types). As a result we can possibly reuse the function for other problems, or in case you for instance change your mind about the type of one of the parameters for this specific problem.</p>\n"}], "owner": {"reputation": 15, "user_id": 9640985, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Simon West", "link": "https://stackoverflow.com/users/9640985/simon-west"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "accepted_answer_id": 49815306, "answer_count": 1, "score": 1, "last_activity_date": 1523617841, "creation_date": 1523615330, "last_edit_date": 1523616465, "question_id": 49814883, "link": "https://stackoverflow.com/questions/49814883/change-order-of-tuple-in-haskell", "title": "Change order of tuple in Haskell", "body": "<p>I am working in Haskell for an assignment and I can't seem to figure out something which I think should be easy. It is for a line editor.</p>\n\n<p>It is a college assignment and I am not asking for a full editor thanks, just the answer to a question.</p>\n\n<p>I have a tuple <code>([Char],[Char],[Char],[Char])</code> which basically converts to <code>(left, right, highlight, copybuffer)</code>. I want to print it on screen so it displays as <code>(left, highlight, right, copybuffer)</code>.</p>\n\n<p>Can anyone help?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 354, "user_id": 3343425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b9956c6595bd2f3d27bed1383f46b60?s=128&d=identicon&r=PG&f=1", "display_name": "fghibellini", "link": "https://stackoverflow.com/users/3343425/fghibellini"}, "edited": false, "score": 2, "creation_date": 1523613008, "post_id": 49813962, "comment_id": 86642387, "body": "In cases like this try to use <a href=\"//www.haskell.org/hoogle\" rel=\"nofollow noreferrer\">hoogle</a>. You can specify a type and it will show you a list of values that match it or are close to it. <a href=\"https://www.haskell.org/hoogle/?hoogle=String+-%3E+Int\" rel=\"nofollow noreferrer\">haskell.org/hoogle/?hoogle=String+-%3E+Int</a>"}, {"owner": {"reputation": 354, "user_id": 3343425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b9956c6595bd2f3d27bed1383f46b60?s=128&d=identicon&r=PG&f=1", "display_name": "fghibellini", "link": "https://stackoverflow.com/users/3343425/fghibellini"}, "edited": false, "score": 1, "creation_date": 1523613274, "post_id": 49813962, "comment_id": 86642573, "body": "Although I must admit that given that it doesn&#39;t show anywhere that <code>String</code> is just a type synonym for <code>[Char]</code> it&#39;s not really clear to a beginner that you can use the function <code>length</code> of type <code>[a] -&gt; Int</code>."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 354, "user_id": 3343425, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b9956c6595bd2f3d27bed1383f46b60?s=128&d=identicon&r=PG&f=1", "display_name": "fghibellini", "link": "https://stackoverflow.com/users/3343425/fghibellini"}, "edited": false, "score": 1, "creation_date": 1523613846, "post_id": 49813962, "comment_id": 86642955, "body": "@fghibellini: One thing that helps exploration, which I often recommend to beginners: the <code>:info</code>/<code>:i</code> command in GHCi. <code>:info String</code> gives <code>type String = [Char] -- Defined in \u2018GHC.Base\u2019</code>, a useful starting point. It\u2019s handy for finding out where things are defined, what methods a typeclass has, and what the precedence of an operator is; although the output can be large/overwhelming if, say, there are a lot of instances of a class, or beginner-unfriendly implementation details (see: <code>:info $</code>)."}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 1, "creation_date": 1523615356, "post_id": 49813962, "comment_id": 86643876, "body": "Are all characters in a string <i>letters</i>?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523618312, "post_id": 49813962, "comment_id": 86645696, "body": "Your function suggests that you want the <i>length</i> of the string, but the title suggests you want to count the letters of a word (?). The two are not completely equivalent."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9640754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a0f9a91ba193aa6a1c7902e503d2870?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Zhang", "link": "https://stackoverflow.com/users/9640754/eric-zhang"}, "edited": false, "score": 0, "creation_date": 1523613499, "post_id": 49814023, "comment_id": 86642695, "body": "holy shit thank you man, just a first year cs student struggling with life"}, {"owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "reply_to_user": {"reputation": 3, "user_id": 9640754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a0f9a91ba193aa6a1c7902e503d2870?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Zhang", "link": "https://stackoverflow.com/users/9640754/eric-zhang"}, "edited": false, "score": 0, "creation_date": 1523613793, "post_id": 49814023, "comment_id": 86642906, "body": "Can&#39;t help you with life, I&#39;m afraid. If you&#39;re literally struggling with it, I would recommend to go talk to a professional! If it was just hyperbole along the lines of &quot;struggling with programming, programming is life&quot;, I understand, and that&#39;s fine too :)"}, {"owner": {"reputation": 3, "user_id": 9640754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a0f9a91ba193aa6a1c7902e503d2870?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Zhang", "link": "https://stackoverflow.com/users/9640754/eric-zhang"}, "edited": false, "score": 0, "creation_date": 1523707842, "post_id": 49814023, "comment_id": 86677697, "body": "Hi additional question, what does the type Event in haskell mean?"}, {"owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "reply_to_user": {"reputation": 3, "user_id": 9640754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a0f9a91ba193aa6a1c7902e503d2870?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Zhang", "link": "https://stackoverflow.com/users/9640754/eric-zhang"}, "edited": false, "score": 0, "creation_date": 1523796999, "post_id": 49814023, "comment_id": 86698883, "body": "Additional questions are best posted as new questions, rather than comments on unrelated questions! (Also, I don&#39;t know :))"}], "tags": [], "owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "is_accepted": true, "score": 3, "last_activity_date": 1523612845, "creation_date": 1523612845, "answer_id": 49814023, "question_id": 49813962, "link": "https://stackoverflow.com/questions/49813962/how-to-create-function-which-will-count-the-number-of-letters-in-a-word/49814023#49814023", "title": "How to create function which will count the number of letters in a word", "body": "<p>A <code>String</code> is just an alias for <code>[Char]</code>, which is a list of characters. So the <code>length</code> function already does what you need:</p>\n\n<pre><code>Prelude&gt; length \"hello\"\n5\n</code></pre>\n\n<p>You can write your own wrapper like this:</p>\n\n<pre><code>stringLength :: String -&gt; Int\nstringLength s = length s\n</code></pre>\n\n<p>But in this case, point-free style might be nicer:</p>\n\n<pre><code>stringLength :: String -&gt; Int\nstringLength = length\n</code></pre>\n\n<p>And that raises the question: why have such a function at all?</p>\n"}], "owner": {"reputation": 3, "user_id": 9640754, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a0f9a91ba193aa6a1c7902e503d2870?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Zhang", "link": "https://stackoverflow.com/users/9640754/eric-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 49814023, "answer_count": 1, "score": -2, "last_activity_date": 1523613263, "creation_date": 1523612672, "last_edit_date": 1523613263, "question_id": 49813962, "link": "https://stackoverflow.com/questions/49813962/how-to-create-function-which-will-count-the-number-of-letters-in-a-word", "title": "How to create function which will count the number of letters in a word", "body": "<pre><code>stringLength :: String -&gt; Int\nstringLength = undefined\n</code></pre>\n\n<p>That's the function above</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1523612357, "post_id": 49813749, "comment_id": 86641986, "body": "<b>Always write out type signatures</b>. (That probably won&#39;t fix your problem, but it will certainly do a great deal to make the error messages less cryptic.)"}, {"owner": {"reputation": 159, "user_id": 3076623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe8c1f3209f74b4c5e35d2fc3022e8b?s=128&d=identicon&r=PG&f=1", "display_name": "user3076623", "link": "https://stackoverflow.com/users/3076623/user3076623"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1523612569, "post_id": 49813749, "comment_id": 86642102, "body": "I probably not suppose to ask this here, but what exactly are type signatures? Is that that one line with &quot;:: &quot;?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1523612619, "post_id": 49813749, "comment_id": 86642128, "body": "@user3076623 Yes, exactly."}, {"owner": {"reputation": 159, "user_id": 3076623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe8c1f3209f74b4c5e35d2fc3022e8b?s=128&d=identicon&r=PG&f=1", "display_name": "user3076623", "link": "https://stackoverflow.com/users/3076623/user3076623"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1523613250, "post_id": 49813749, "comment_id": 86642559, "body": "@leftaroundabout, It did became less cryptic but now it&#39;s searching for &quot;Fractional Integer&quot;."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1523613730, "post_id": 49813749, "comment_id": 86642856, "body": "You wrote a couple type signatures, but you need to write all of them."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1523614214, "post_id": 49813749, "comment_id": 86643195, "body": "The second error is with <code>foldl</code> and not with numeric types. Look up <code>foldl</code> again, pay attention to what kind of arguments it expects."}, {"owner": {"reputation": 159, "user_id": 3076623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe8c1f3209f74b4c5e35d2fc3022e8b?s=128&d=identicon&r=PG&f=1", "display_name": "user3076623", "link": "https://stackoverflow.com/users/3076623/user3076623"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1523614264, "post_id": 49813749, "comment_id": 86643231, "body": "@n.m. Could you enlighten me about what to write, I think trying to write all types as Integer wouldn&#39;t work."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1523614329, "post_id": 49813749, "comment_id": 86643274, "body": "Of course it doesn&#39;t, it makes little sense to take a sine of an integer argument and expect an integer result. You need to have a <code>Double</code> in there at some point."}, {"owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "edited": false, "score": 1, "creation_date": 1523615096, "post_id": 49813749, "comment_id": 86643721, "body": "Not relevant but <code>alterl = iterate negate 1</code> feels more concise"}, {"owner": {"reputation": 189, "user_id": 8179137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46b43fe26a1b6191280614f56683525d?s=128&d=identicon&r=PG&f=1", "display_name": "Potato44", "link": "https://stackoverflow.com/users/8179137/potato44"}, "reply_to_user": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "edited": false, "score": 1, "creation_date": 1523631689, "post_id": 49813749, "comment_id": 86654830, "body": "@RegisKuckaertz I think <code>alterl = cycle [1,-1]</code> is even clearer."}], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 3076623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe8c1f3209f74b4c5e35d2fc3022e8b?s=128&d=identicon&r=PG&f=1", "display_name": "user3076623", "link": "https://stackoverflow.com/users/3076623/user3076623"}, "edited": false, "score": 0, "creation_date": 1523615184, "post_id": 49814392, "comment_id": 86643762, "body": "But fromIntegral only applies to a single value, right?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 159, "user_id": 3076623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe8c1f3209f74b4c5e35d2fc3022e8b?s=128&d=identicon&r=PG&f=1", "display_name": "user3076623", "link": "https://stackoverflow.com/users/3076623/user3076623"}, "edited": false, "score": 0, "creation_date": 1523615236, "post_id": 49814392, "comment_id": 86643790, "body": "@user3076623, yeah, but it&#39;s a regular function, so you can <code>map</code> it.  I&#39;d probably rather make a little helper though <code>divInts x y = fromIntegral x &#47; fromIntegral y</code> to do your zipping with."}, {"owner": {"reputation": 159, "user_id": 3076623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe8c1f3209f74b4c5e35d2fc3022e8b?s=128&d=identicon&r=PG&f=1", "display_name": "user3076623", "link": "https://stackoverflow.com/users/3076623/user3076623"}, "edited": false, "score": 0, "creation_date": 1523615322, "post_id": 49814392, "comment_id": 86643845, "body": "So it&#39;s like &quot;sined x = map (fromIntegral) (zipWith (*) (powerl x) alterl)&quot;?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 159, "user_id": 3076623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe8c1f3209f74b4c5e35d2fc3022e8b?s=128&d=identicon&r=PG&f=1", "display_name": "user3076623", "link": "https://stackoverflow.com/users/3076623/user3076623"}, "edited": false, "score": 0, "creation_date": 1523615452, "post_id": 49814392, "comment_id": 86643930, "body": "@user3076623, looks right to me  <i>(modulo superfluous parens around <code>fromIntegral</code>)</i>"}, {"owner": {"reputation": 159, "user_id": 3076623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe8c1f3209f74b4c5e35d2fc3022e8b?s=128&d=identicon&r=PG&f=1", "display_name": "user3076623", "link": "https://stackoverflow.com/users/3076623/user3076623"}, "edited": false, "score": 0, "creation_date": 1523615511, "post_id": 49814392, "comment_id": 86643963, "body": "actually, your suggestion works! The first one, I mean."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 3, "last_activity_date": 1523615041, "last_edit_date": 1523615041, "creation_date": 1523613860, "answer_id": 49814392, "question_id": 49813749, "link": "https://stackoverflow.com/questions/49813749/trying-to-multiply-lists-together-in-haskell/49814392#49814392", "title": "Trying to multiply lists together in haskell", "body": "<p>Numerics in Haskell have a lot to do with types and type inference, so they can be tricky for beginners. You're not allowed to divide integers at all with the <code>/</code> operator (there is <code>`div`</code> for truncating integer division).  What makes a constant an integer can also be rather tricky, as it depends on how it is used (later!)<sup>1</sup>.  But the main thing you need to know about is the <code>fromIntegral</code> function, which casts from an integer into any other numeric type.  </p>\n\n<pre><code>ghci&gt; let x = 10 :: Integer\nghci&gt; x / 5\n&lt;interactive&gt;:6:1: error:\n    \u2022 No instance for (Fractional Integer) arising from a use of \u2018/\u2019\n    \u2022 In the expression: x / 5\n      In an equation for \u2018it\u2019: it = x / 5\nghci&gt; fromIntegral x / 5\n2.0\n</code></pre>\n\n<p>And <em>@leftroundabout</em>'s comment is absolutely right!  Type inference is lovely but if you let it run wild it can be very confusing; rein it in with type signatures.</p>\n\n<hr>\n\n<p><sup>1</sup>Here's one thing that went wrong, if you are interested. Maybe it will help with understanding how types and numbers interact.</p>\n\n<p><code>(^)</code> takes an integer (technically any \"<code>Integral</code>\" type, which defaults to <code>Integer</code> if there is nothing else to make the decision) as its right argument, so we know from</p>\n\n<pre><code>powerl x = map (x^) oddl\n</code></pre>\n\n<p>that <code>oddl</code> must be a list of integers.  <code>(*)</code> returns the same type as its arguments (which must be the same type), so we know from</p>\n\n<pre><code>factorial x = factorial (x - 1) * x\n</code></pre>\n\n<p>that <code>factorial</code> returns the same type as its argument, and thus</p>\n\n<pre><code>factl = map factorial oddl\n</code></pre>\n\n<p>must also be a list of integers.  Then we have</p>\n\n<pre><code>sinex x = zipWith (/) sined factl\n</code></pre>\n\n<p>which is now giving integers as an argument to <code>(/)</code>, which is not legal.  </p>\n"}, {"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 2, "last_activity_date": 1523615582, "creation_date": 1523615582, "answer_id": 49814963, "question_id": 49813749, "link": "https://stackoverflow.com/questions/49813749/trying-to-multiply-lists-together-in-haskell/49814963#49814963", "title": "Trying to multiply lists together in haskell", "body": "<p>After your edits, looking at the first error:</p>\n\n<pre><code>No instance for (Fractional Integer) arising from a use of \u2018/\u2019\n</code></pre>\n\n<p>The type of <code>(/)</code> is:</p>\n\n<pre><code>(/) :: Fractional a =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>So it takes two values of type <code>a</code>, which must be <code>Fractional</code>, and returns a result of the same type <code>a</code>. <code>Integer</code> is not <code>Fractional</code>\u2014there are integer division functions <code>div</code> and <code>quot</code> (and their remainder counterparts, <code>mod</code> and <code>rem</code>), but that\u2019s not what you want here, because you want a fractional result. The solution is to convert the integer argument to a fractional type such as <code>Double</code> using <code>fromIntegral</code>:</p>\n\n<pre><code>fromIntegral :: (Num b, Integral a) =&gt; a -&gt; b\n\nfromIntegral (x :: Integer) :: Double  -- or \u2018\u2026 :: Float\u2019\n</code></pre>\n\n<p>So for example you could write <code>sum xs / fromIntegral (length xs)</code> to get the mean of a list of <code>Double</code>.</p>\n\n<p>The second error:</p>\n\n<pre><code>Could not deduce (Num [Integer]) arising from a use of \u2018+\u2019\n</code></pre>\n\n<p>Arises from this expression:</p>\n\n<pre><code>foldl (+) (take 30 (sinex x))\n</code></pre>\n\n<p><code>foldl</code> takes three arguments: the reducing function, the starting value, and the input container; you\u2019re trying to pass the container as the starting value, so <code>foldl</code> tries to call <code>+</code> on a list of integers, which is not defined. You might want <code>foldl (+) 0</code> or <code>sum</code> there.</p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 1, "last_activity_date": 1523619024, "last_edit_date": 1523619024, "creation_date": 1523616904, "answer_id": 49815365, "question_id": 49813749, "link": "https://stackoverflow.com/questions/49813749/trying-to-multiply-lists-together-in-haskell/49815365#49815365", "title": "Trying to multiply lists together in haskell", "body": "<p>Here's a more reasonable way to write it all:</p>\n\n<pre><code>sinf :: Double -&gt; Double\nsinf x = sum $ take 30\n           [ sign * power / fact\n           | (sign, power, fact) &lt;- zip3\n               (iterate negate 1)\n               (oddEntries $ iterate (*x) 1)\n               (oddEntries factorials) ]\n where factorials :: [Double]\n       factorials = scanl (*) 1 [1..]\n\noddEntries :: [a] -&gt; [a]\noddEntries (_:x:xs) = x : oddEntries xs\noddEntries _ = []\n</code></pre>\n\n<p>Note that I didn't need any <code>fromIntegral</code>, because I declared the list of factorials as <code>Double</code>. That's of course not precise, but it doesn't matter in this application (the error is anyway dominated by the truncation of the series) and it's much more efficient for big numbers than converting from <code>Integer</code>.</p>\n\n<p>Also I avoided the <code>^</code> operator, which is quite wasteful in this case: the intermediate results of the multiplication are anyways needed in the Maclaurin series, so better also do this with iterated multiplication!</p>\n\n<p>Incidentally, you can then also omit the local binding and just write it all inline:</p>\n\n<pre><code>sinf :: Double -&gt; Double\nsinf x = sum $ take 30\n           [ sign * power / fact\n           | (sign, power, fact) &lt;- zip3\n               (iterate negate 1)\n               (oddEntries $ iterate (*x) 1)\n               (oddEntries $ scanl (*) 1 [1..]) ]\n</code></pre>\n\n<p>Here the typechecker automatically does the right thing and chooses the type <code>Double</code> for the list of factorials (as well as the list of signs), because the context requires <code>Double</code>. (But it can be a good idea to nevertheless give it a local name and signature, for the sake of readability.)</p>\n\n<hr>\n\n<pre><code>$ ghci wtmpf-file3770.hs \nGHCi, version 8.2.1: http://www.haskell.org/ghc/  :? for help\nLoaded GHCi configuration from /home/sagemuej/.ghc/ghci.conf\nLoaded GHCi configuration from /home/sagemuej/.ghci\n[1 of 1] Compiling Main             ( wtmpf-file3770.hs, interpreted )\nOk, 1 module loaded.\n*Main&gt; :m +Graphics.Dynamic.Plot.R2 \n*Main Graphics.Dynamic.Plot.R2&gt; plotWindow [legendName \"sin\" $ continFnPlot sin, legendName \"sinf\" $ continFnPlot sinf]\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/rzyOq.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rzyOq.png\" alt=\"plot of the truncate-maclaurin sine\"></a></p>\n\n<p>In practice, you'd only use the Maclaurin series in the small range around zero, and exploit the periodicity for defining the function on the remainder of the real axis:</p>\n\n<pre><code>sinf :: Double -&gt; Double\nsinf x = sum $ take 30\n           [ sign * power / fact\n           | (sign, power, fact) &lt;- zip3\n               (iterate negate 1)\n               (oddEntries $ iterate (*x') 1)\n               (oddEntries factorials) ]\n where factorials :: [Double]\n       factorials = scanl (*) 1 [1..]\n       x' = x - 2*pi*fromIntegral (round $ x/(2*pi))\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/jC37r.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/jC37r.png\" alt=\"trunctation error of Maclauring fixed by exploiting periodicity\"></a></p>\n"}], "owner": {"reputation": 159, "user_id": 3076623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbe8c1f3209f74b4c5e35d2fc3022e8b?s=128&d=identicon&r=PG&f=1", "display_name": "user3076623", "link": "https://stackoverflow.com/users/3076623/user3076623"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 0, "accepted_answer_id": 49814392, "answer_count": 3, "score": 3, "last_activity_date": 1523619024, "creation_date": 1523612048, "last_edit_date": 1523613150, "question_id": 49813749, "link": "https://stackoverflow.com/questions/49813749/trying-to-multiply-lists-together-in-haskell", "title": "Trying to multiply lists together in haskell", "body": "<p>I've been studying Haskell, since my teacher forced us to.\nAs an exercise, we'll try writing up a solution to approximate sin(x) function using its Maclaurin series only up to the 30th term.</p>\n\n<p>I thought up of using lists for the alternating series of 1 and -1, the x raised to an odd number, and the factorial of odd numbers. Then, I'll multiply the first two lists and divide the last. Until now I only have written this:</p>\n\n<pre><code>oddl = [1,3..]\npowerl x = map (x^) oddl\nfactorial 0 = 1\nfactorial x = factorial (x - 1) * x\nfactl = map factorial oddl\nalterl = scanl (*) (-1) [-1,-1..]\nsined x = zipWith (*) (powerl x) alterl\nsinex x = zipWith (/) sined factl\nsinf x = foldl (+) (take 30 (sinex x))\n</code></pre>\n\n<p>Then in <code>ghci</code>, I'll enter <code>sinf 3.14</code> but before I can enter it after loading I get this:</p>\n\n<pre><code>exert.hs:31:8:\n    No instance for (Enum t0)\n      arising from the arithmetic sequence \u20181, 3 .. \u2019\n    The type variable \u2018t0\u2019 is ambiguous\n    Relevant bindings include oddl :: [t0] (bound at exert.hs:31:1)\n    Note: there are several potential instances:\n      instance forall (k :: BOX) (s :: k). Enum (Data.Proxy.Proxy s)\n        -- Defined in \u2018Data.Proxy\u2019\n      instance Integral a =&gt; Enum (GHC.Real.Ratio a)\n        -- Defined in \u2018GHC.Real\u2019\n      instance Enum Ordering -- Defined in \u2018GHC.Enum\u2019\n      ...plus 8 others\n    In the expression: [1, 3 .. ]\n    In an equation for \u2018oddl\u2019: oddl = [1, 3 .. ]\n\nexert.hs:31:9:\n    No instance for (Num t0) arising from the literal \u20181\u2019\n    The type variable \u2018t0\u2019 is ambiguous\n    Relevant bindings include oddl :: [t0] (bound at exert.hs:31:1)\n    Note: there are several potential instances:\n      instance Integral a =&gt; Num (GHC.Real.Ratio a)\n        -- Defined in \u2018GHC.Real\u2019\n      instance Num Integer -- Defined in \u2018GHC.Num\u2019\n      instance Num Double -- Defined in \u2018GHC.Float\u2019\n      ...plus three others\n    In the expression: 1\n    In the expression: [1, 3 .. ]\n    In an equation for \u2018oddl\u2019: oddl = [1, 3 .. ]\n\nexert.hs:32:18:\n    Could not deduce (Integral t0) arising from a use of \u2018^\u2019\n    from the context (Num b)\n      bound by the inferred type of powerl :: Num b =&gt; b -&gt; [b]\n      at exert.hs:32:1-24\n    The type variable \u2018t0\u2019 is ambiguous\n    Note: there are several potential instances:\n      instance Integral Integer -- Defined in \u2018GHC.Real\u2019\n      instance Integral Int -- Defined in \u2018GHC.Real\u2019\n      instance Integral Word -- Defined in \u2018GHC.Real\u2019\n    In the first argument of \u2018map\u2019, namely \u2018(x ^)\u2019\n    In the expression: map (x ^) oddl\n    In an equation for \u2018powerl\u2019: powerl x = map (x ^) oddl\n\nexert.hs:35:13:\n    No instance for (Eq t0) arising from a use of \u2018factorial\u2019\n    The type variable \u2018t0\u2019 is ambiguous\n    Relevant bindings include factl :: [t0] (bound at exert.hs:35:1)\n    Note: there are several potential instances:\n      instance (Eq a, Eq b) =&gt; Eq (Either a b)\n        -- Defined in \u2018Data.Either\u2019\n      instance forall (k :: BOX) (s :: k). Eq (Data.Proxy.Proxy s)\n        -- Defined in \u2018Data.Proxy\u2019\n      instance (GHC.Arr.Ix i, Eq e) =&gt; Eq (GHC.Arr.Array i e)\n        -- Defined in \u2018GHC.Arr\u2019\n      ...plus 28 others\n    In the first argument of \u2018map\u2019, namely \u2018factorial\u2019\n    In the expression: map factorial oddl\n    In an equation for \u2018factl\u2019: factl = map factorial oddl\n\nexert.hs:38:23:\n    Couldn't match expected type \u2018[t0]\u2019\n                with actual type \u2018Integer -&gt; [Integer]\u2019\n    Relevant bindings include\n      sinex :: t -&gt; [t0] (bound at exert.hs:38:1)\n    Probable cause: \u2018sined\u2019 is applied to too few arguments\n    In the second argument of \u2018zipWith\u2019, namely \u2018sined\u2019\n    In the expression: zipWith (/) sined factl\n\nexert.hs:39:16:\n    Could not deduce (Num [t0]) arising from a use of \u2018+\u2019\n    from the context (Foldable t)\n      bound by the inferred type of\n               sinf :: Foldable t =&gt; t1 -&gt; t [t0] -&gt; [t0]\n      at exert.hs:39:1-38\n    The type variable \u2018t0\u2019 is ambiguous\n    Relevant bindings include\n      sinf :: t1 -&gt; t [t0] -&gt; [t0] (bound at exert.hs:39:1)\n    In the first argument of \u2018foldl\u2019, namely \u2018(+)\u2019\n    In the expression: foldl (+) (take 30 (sinex x))\n    In an equation for \u2018sinf\u2019: sinf x = foldl (+) (take 30 (sinex x))\nFailed, modules loaded: none.\n</code></pre>\n\n<p>so much messages. wow. \nI don't have any clue on what I have been doing wrong nor even know where to start reading the message.\nMay anyone shed light on this? Actually as a beginner, I am curious on how is it wrong in Haskell and what's preventing it to work.</p>\n\n<p><strong>EDIT: After adding type signatures and a missing argument.</strong></p>\n\n<pre><code>oddl :: [Integer]\noddl = [1,3..]\npowerl :: Integer -&gt; [Integer]\npowerl x = map (x^) oddl\nfactorial 0 = 1\nfactorial x = factorial (x - 1) * x\nfactl :: [Integer]\nfactl = map factorial oddl\nalterl = scanl (*) (-1) [-1,-1..]\nsined x = zipWith (*) (powerl x) alterl\nsinex x = zipWith (/) (sined x) factl\nsinf x = foldl (+) (take 30 (sinex x))\n</code></pre>\n\n<p>Now I get a shorter error:</p>\n\n<pre><code>exert.hs:41:19:\n    No instance for (Fractional Integer) arising from a use of \u2018/\u2019\n    In the first argument of \u2018zipWith\u2019, namely \u2018(/)\u2019\n    In the expression: zipWith (/) (sined x) factl\n    In an equation for \u2018sinex\u2019: sinex x = zipWith (/) (sined x) factl\n\nexert.hs:42:16:\n    Could not deduce (Num [Integer]) arising from a use of \u2018+\u2019\n    from the context (Foldable t)\n      bound by the inferred type of\n               sinf :: Foldable t =&gt; Integer -&gt; t [Integer] -&gt; [Integer]\n      at exert.hs:42:1-38\n    In the first argument of \u2018foldl\u2019, namely \u2018(+)\u2019\n    In the expression: foldl (+) (take 30 (sinex x))\n    In an equation for \u2018sinf\u2019: sinf x = foldl (+) (take 30 (sinex x))\n</code></pre>\n"}, {"tags": ["python", "haskell", "ghc", "ghci"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1523611243, "post_id": 49813434, "comment_id": 86641329, "body": "IIRC <code>ghc -e</code> is pretty restricted. You might be able to just use <code>Data.Char.toUpper</code> fully qualified, or write a whole file and <code>runghc</code> it."}, {"owner": {"reputation": 43, "user_id": 9640574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d0b19818136dcb0ae67f6827dd7555?s=128&d=identicon&r=PG&f=1", "display_name": "CompareTwo", "link": "https://stackoverflow.com/users/9640574/comparetwo"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1523611463, "post_id": 49813434, "comment_id": 86641471, "body": "Using Data.Char.toUpper seems to solve the second problem. However, this would require us using the fully qualified name rather than simply &quot;toUpper&quot;. Would using runghc be as fast, or faster, than ghc -e? Thank you for the quick response!"}], "answers": [{"tags": [], "owner": {"reputation": 5439, "user_id": 854434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i9ZVO.jpg?s=128&g=1", "display_name": "smassey", "link": "https://stackoverflow.com/users/854434/smassey"}, "is_accepted": true, "score": 5, "last_activity_date": 1523614444, "creation_date": 1523614444, "answer_id": 49814606, "question_id": 49813434, "link": "https://stackoverflow.com/questions/49813434/generating-and-running-haskell-code-from-python/49814606#49814606", "title": "Generating and running Haskell code from Python", "body": "<p>This seems like an odd thing to be doing.. but <em>interesting</em> none the less. </p>\n\n<p>Two things come immediately to mind here. First is to use ghci repl instead of spawning a new process for every eval attempt. The idea is to stream your I/O into the ghci process instead of spawning a new ghc process for each attempt. The overhead of starting a new process for every eval seems to be quite performance killer. I'd usually go for <code>expect</code>, but since you want python, I'll call on <code>pexpect</code>:</p>\n\n<pre><code>import pexpect\nimport sys\nfrom subprocess import Popen, PIPE, STDOUT\nimport time\n\n\nREPL_PS = unicode('Prelude&gt; ')\nLOOPS = 100\n\n\ndef time_function(func):\n    def decorator(*args, **kwargs):\n        ts = time.time()\n        func(*args, **kwargs)\n        te = time.time()\n        print \"total time\", (te - ts)\n    return decorator\n\n\n@time_function\ndef repl_loop():\n    repl = pexpect.spawnu('ghci')\n    repl.expect(REPL_PS)\n    for i in range(LOOPS):\n        repl.sendline('''(\\\\x y -&gt; x + y) 1 2''')\n        _, haskell_output = repl.readline(), repl.readline()\n        repl.expect(REPL_PS)\n\n\n@time_function\ndef subproc_loop():\n    for i in range(LOOPS):\n        proc = Popen('''ghc -e \"(\\\\x y -&gt; x + y) 1 2\"''', shell=True, stdout=PIPE, stderr=STDOUT) \n        haskell_output = proc.stdout.read().decode('utf-8').strip('n')\n        # print haskell_output\n\n\nrepl_loop()\nsubproc_loop()\n</code></pre>\n\n<p>This gave me a very consistent <code>&gt;2x</code> speed boost.</p>\n\n<p>See pexpect doc for more info: <a href=\"https://github.com/pexpect/pexpect/\" rel=\"noreferrer\">https://github.com/pexpect/pexpect/</a></p>\n\n<p>The second immediate idea would be to use some distributed computing. I don't have the time to build full blown demo here, but there are many great examples already living in the land of the internet and SO. The idea is to have multiple \"python + ghci\" processes reading <code>eval attempts</code> from a common queue then push the results to a common <code>eval attempt checker</code>. I don't know much about ghc(i) but a quick check shows that ghci is a multithreaded process so this may require multiple machines to pull off, each machine attempting different subsets of the the attempts in parallel.</p>\n\n<p>Some links that may be of interest here:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/11515944/how-to-use-multiprocessing-queue-in-python\">How to use multiprocessing queue in Python?</a></p>\n\n<p><a href=\"https://docs.python.org/2/library/multiprocessing.html\" rel=\"noreferrer\">https://docs.python.org/2/library/multiprocessing.html</a></p>\n\n<p><a href=\"https://eli.thegreenplace.net/2012/01/24/distributed-computing-in-python-with-multiprocessing\" rel=\"noreferrer\">https://eli.thegreenplace.net/2012/01/24/distributed-computing-in-python-with-multiprocessing</a></p>\n"}], "owner": {"reputation": 43, "user_id": 9640574, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44d0b19818136dcb0ae67f6827dd7555?s=128&d=identicon&r=PG&f=1", "display_name": "CompareTwo", "link": "https://stackoverflow.com/users/9640574/comparetwo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 743, "favorite_count": 1, "accepted_answer_id": 49814606, "answer_count": 1, "score": 3, "last_activity_date": 1523614444, "creation_date": 1523611059, "last_edit_date": 1523612564, "question_id": 49813434, "link": "https://stackoverflow.com/questions/49813434/generating-and-running-haskell-code-from-python", "title": "Generating and running Haskell code from Python", "body": "<p>We are writing a python program that attempts to synthesize a (simple) haskell-function given input-output pairs. Throughout the run of the program, we generate haskell code and check its correctness against the user-supplied examples. \nSuppose we get as input \"1 2\" and expected output \"3\". We would (eventually)\ncome up with the plus function. We would then run \n<code>(\\x y -&gt; x + y) 1 2</code> in haskell and check if it evaluates to 3.</p>\n\n<p>The way we currently do things is by running the following python code:</p>\n\n<pre><code>from subprocess import Popen, PIPE, STDOUT\nproccess = Popen(f'ghc -e \"{haskell_code}\"', shell=True, stdout=PIPE, stderr=STDOUT) \nhaskell_output = proc.stdout.read().decode('utf-8').strip('\\n')\n</code></pre>\n\n<p>As neither of us is familiar with ghc, haskell, processes, or really anything to do with any of this, we were hoping someone could help us with preforming this task in a (much) more efficient manner, as this is currently very slow.</p>\n\n<p>Additionally, we would like to be able to perform more than a single statement. For example, we would like to import Data.Char so that our function can use \u201ctoUpper\u201d. However, the way we are currently doing this is by sending a single lambda function and the inputs appended to it, and we aren't sure how to add an import statement above that (adding \"\\n\" did not seem to work).</p>\n\n<p>To summarize, we would like the fastest (runtime) solution that would allow us to test haskell functions from python (where we don\u2019t have the code for all haskell functions in advance or at one point in time, but rather test as we generate the code), while allowing us to use more than a single statement (for example, importing).</p>\n\n<p>Apologies if any of this is trivial or stupid, any help would be highly appreciated. </p>\n"}, {"tags": ["haskell", "haskell-stack", "ghcjs", "reflex", "reflex-dom"], "answers": [{"comments": [{"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1523617644, "post_id": 49815211, "comment_id": 86645320, "body": "Oh. So why did they not fix the Quickref? It&#39;s been 2 years. I guess I should post an issue."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1523619749, "post_id": 49815211, "comment_id": 86646597, "body": "Probably an oversight."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1523625463, "post_id": 49815211, "comment_id": 86650363, "body": "It will be easier for me to accept your answer if you could expand it somewhat. One thing that would be helpful to a future reader is an example of working code. Also, it would be great if you refer to the <a href=\"https://github.com/reflex-frp/reflex/issues/187\" rel=\"nofollow noreferrer\">issue</a> that I created, in case there will be answers from the maintainers, so that the answer stays up to date. I could edit the question myself, but it is questionable practice to significantly expand other people&#39;s answers, and some of the reviewers may vote against the edit."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1523627270, "post_id": 49815211, "comment_id": 86651626, "body": "Okay I added a bit more meat. It turns out the doc question is not an oversight, but that the linked <code>Quickref.md</code> is for a version of <code>reflex</code> under development."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1523627797, "post_id": 49815211, "comment_id": 86652024, "body": "For the record, I don&#39;t mind edits by other people to improve my answers, and otherwise I welcome requests to do so if you don&#39;t feel confident about it."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1523628346, "post_id": 49815211, "comment_id": 86652456, "body": "The problem is that some picky reviewers mind these edits if they are too massive and add substantial content of their own. I will keep your will in mind, but I would rather stick to asking you to expand your posts rather than doing so myself."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1523628664, "post_id": 49815211, "comment_id": 86652702, "body": "I see. That is fine too."}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 2, "last_activity_date": 1523627199, "last_edit_date": 1523627199, "creation_date": 1523616408, "answer_id": 49815211, "question_id": 49813174, "link": "https://stackoverflow.com/questions/49813174/cannot-map-through-dynamic-no-instance-for-functor-dynamic-spider/49815211#49815211", "title": "Cannot map through Dynamic: No instance for (Functor (Dynamic Spider))", "body": "<p>The discussion below explains why <code>Functor</code> for <code>Dynamic</code> turned out to be a bad idea.</p>\n\n<p><a href=\"https://github.com/reflex-frp/reflex/pull/39\" rel=\"nofollow noreferrer\">https://github.com/reflex-frp/reflex/pull/39</a></p>\n\n<blockquote>\n  <p>The problem with this instance is that it will evaluate <code>f</code> twice whenever the input dynamic changes: once to compute the new <code>Event</code> value, and once to compute the new <code>Behavior</code> value. With <code>mapDyn</code>, there is only a single computation, the result of both is shared. This is also why <code>mapDyn</code> is monadic.</p>\n</blockquote>\n\n<hr>\n\n<p>So the code would look like this:</p>\n\n<pre><code>main = mainWidget $ do\n    x &lt;- greenButton\n    y &lt;- toggle False x\n    z &lt;- mapDyn style y      -- monadic mapDyn instead of fmap\n    elDynAttr \"div\" z blank\n</code></pre>\n\n<hr>\n\n<p>On the issue of documentation, <a href=\"https://github.com/reflex-frp/reflex/blob/v0.4.0.1/Quickref.md\" rel=\"nofollow noreferrer\"><code>Quickref.md</code> for version <code>0.4.0.1</code> is here</a> and only references <code>mapDyn</code>.</p>\n\n<p>The <code>Quickref.md</code> you linked to is the one for the future <code>reflex-0.5</code> (the current <code>develop</code> branch), which is reworking <code>Dynamic</code> to have a <code>Functor</code> instance. <a href=\"https://github.com/reflex-frp/reflex/wiki/Reflex-FAQ\" rel=\"nofollow noreferrer\">See their wiki</a>:</p>\n\n<blockquote>\n  <h3>Why doesn't Dynamic have Functor/Applicative/Monad instances</h3>\n  \n  <p>Reflex is scheduled to get these instances in version 0.5. As of this writing the implementation is mostly complete and is undergoing final polish and testing before release and is currently available on github in reflex's develop branch.</p>\n</blockquote>\n"}], "owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 49815211, "answer_count": 1, "score": 0, "last_activity_date": 1523669914, "creation_date": 1523610256, "last_edit_date": 1523669914, "question_id": 49813174, "link": "https://stackoverflow.com/questions/49813174/cannot-map-through-dynamic-no-instance-for-functor-dynamic-spider", "title": "Cannot map through Dynamic: No instance for (Functor (Dynamic Spider))", "body": "<p>My intention is to alternate the colour of a <code>div</code> between bright red and dark\nred as a button gets pressed, starting with dark red.</p>\n\n<p>I have this code:</p>\n\n<pre><code>{-# LANGUAGE\n    OverloadedStrings\n  #-}\n\nmodule Main where\n\nimport Data.Map (Map)\nimport Reflex.Dom\n\nmain = mainWidget $ do\n    x &lt;- greenButton\n    y &lt;- toggle False x\n    let z = fmap style y\n    elDynAttr \"div\" z blank\n\nstyle :: Bool -&gt; Map String String\nstyle b | b         = \"style\" =: \"height: 10ex; width: 10ex; background-color: #f00;\"\n        | otherwise = \"style\" =: \"height: 10ex; width: 10ex; background-color: #900;\"\n\ngreenButton :: MonadWidget t m =&gt; m (Event t ())\ngreenButton = button \"[ ]\"  -- Should be green but whatever.\n</code></pre>\n\n<p>It errors out thus:</p>\n\n<pre><code>\u2022 No instance for (Functor (Dynamic Spider))\n    arising from a use of \u2018fmap\u2019\n\u2022 In the expression: fmap style y\n  In an equation for \u2018z\u2019: z = fmap style y\n  In the second argument of \u2018($)\u2019, namely\n    \u2018do { x &lt;- greenButton;\n          y &lt;- toggle False x;\n          let z = fmap style y;\n          elDynAttr \"div\" z blank }\u2019\n</code></pre>\n\n<p>I certainly see an <code>fmap</code> for <code>Dynamic</code> in the <a href=\"https://github.com/reflex-frp/reflex/blob/develop/Quickref.md\" rel=\"nofollow noreferrer\">quick reference</a>,\nthough I am not sure the version of the reference and the version of the\n<code>reflex</code> package I compile against are consistent.</p>\n\n<p>This is the <code>stack.yaml</code> I use for building:</p>\n\n<pre><code>resolver: lts-7.19\ncompiler: ghcjs-0.2.1.9007019_ghc-8.0.1\ncompiler-check: match-exact\n\nsetup-info:\n  ghcjs:\n    source:\n      ghcjs-0.2.1.9007019_ghc-8.0.1:\n           url: http://ghcjs.tolysz.org/ghc-8.0-2017-02-05-lts-7.19-9007019.tar.gz\n           sha1: d2cfc25f9cda32a25a87d9af68891b2186ee52f9\n\nextra-deps:\n- reflex-dom-0.3\n- ghcjs-dom-0.2.4.0\n- ref-tf-0.4.0.1\n- reflex-0.4.0.1\n\nallow-newer: true\n</code></pre>\n\n<p>What am I doing wrong? And who the hell is this guy Spider?</p>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1523604143, "post_id": 49811055, "comment_id": 86637365, "body": "What have you tried to acheive this? Could you post your code?"}, {"owner": {"reputation": 318, "user_id": 6754285, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/70431543134c84959736ea64a820a11a?s=128&d=identicon&r=PG&f=1", "display_name": "cars", "link": "https://stackoverflow.com/users/6754285/cars"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1523604209, "post_id": 49811055, "comment_id": 86637401, "body": "Thats what I am saying I have done the parts separately but I have no idea on how to move the result obtained into the other function"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1523605020, "post_id": 49811055, "comment_id": 86637796, "body": "Ok, here&#39;s a tip: <a href=\"https://wiki.haskell.org/Let_vs._Where\" rel=\"nofollow noreferrer\"><code>let</code> and <code>where</code></a>."}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 0, "creation_date": 1523609926, "post_id": 49811055, "comment_id": 86640462, "body": "@cars: When so much of your question body overlaps, it seems to me that you have not understood the answer given and repeat the question, rather than ask a new question or ask elaborating questions as comments to the old one."}], "owner": {"reputation": 318, "user_id": 6754285, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/70431543134c84959736ea64a820a11a?s=128&d=identicon&r=PG&f=1", "display_name": "cars", "link": "https://stackoverflow.com/users/6754285/cars"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "closed_date": 1523605674, "answer_count": 0, "score": 1, "last_activity_date": 1523602735, "creation_date": 1523602735, "question_id": 49811055, "link": "https://stackoverflow.com/questions/49811055/how-do-we-move-a-result-obtained-from-one-function-into-another", "closed_reason": "Duplicate", "title": "How do we move a result obtained from one function into another", "body": "<p>Hi I am new to <strong>Haskell</strong> and I  came across a question which I am unsure how I would go about solving it. <strong>Note: I am doing all this in a test.hs file and then loading that file using cmd</strong></p>\n\n<p>The program will first ask the user to input a list of numbers ranging between 8-10 digits. then it will remove the last number from what you entered. <strong>Eg if I typed in 236453110</strong> I will get an output of <strong>23646311.</strong></p>\n\n<p>Then the problem I am having is recalling the output I got to another set of instructions. In which it will take every odd digit of the number <strong>23646311.</strong> and double it. So It should get and output of <strong>4312412321.</strong> Notice how if I double some of the <strong>odd digits not numbers I get values above 12.</strong> Well these values acutally get simiplified. so if i got 12 after I doubled the digit it would become  12 = 1+2= <strong>3</strong></p>\n\n<pre><code>lastdigit :: Integer -&gt; Integer\nlastdigit x = x`div`10\n\ndoubleOdd (x:xs) = (2*x):(doubleEven xs)\ndoubleOdd [] = []\ndoubleEven (x:xs) = x:(doubleOdd xs)\ndoubleEven [] = []\n</code></pre>\n\n<p>I have been able to do the parts separately such as the function last digit will remove the last digit from the number you entered. As well as the double Odd function will double every Odd digit <strong>Not Number</strong>.</p>\n\n<p>So to re summarise what I am asking help for is when I use my last digit function I want it to automatically go the the next function of doubleOdd and Double each of the odd Integers.<strong>Note I do not want to code in prelude just using a text.hs file and loading that file on cmd</strong></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1523599236, "post_id": 49809721, "comment_id": 86634991, "body": "(1) &quot;However, when I write the same functions without <code>Monoid</code> or <code>Foldable</code>, it is reasonably fast&quot; -- I suggest adding this alternative implementation to your question. (2) As a preliminary guess, <code>divide</code> looks like something that could cause trouble: for one, <code>length</code> followed by <code>take</code> and <code>drop</code> likely means the lists are kept in memory for longer than you&#39;d want, as multiple runs through them are necessary. (3) Note that the combination of <code>take n</code> and <code>drop n</code> can be replaced by <code>splitAt n</code>."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1523600116, "post_id": 49809721, "comment_id": 86635353, "body": "A quick note: looks like you&#39;re pulling things out of <code>MergeL</code> only to push it back in a <i>lot</i> (in every call to <code>divide</code>, for instance). This is a good sign that you want to define a <code>Functor</code> instance for <code>MergeL</code> so you can <code>fmap length (xs :: MergeL a)</code>"}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1523600730, "post_id": 49809721, "comment_id": 86635621, "body": "<code>divide</code> then becomes <code>fmap (flip div 2 . length &amp;&amp;&amp; id &gt;&gt;&gt; uncurry splitAt)</code>"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1523600903, "post_id": 49809721, "comment_id": 86635699, "body": "@AdamSmith <code>fmap</code> for <code>MergeL</code> would act on the list elements, not on the list itself."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1523601340, "post_id": 49809721, "comment_id": 86635901, "body": "@duplode oh shoot, right, because <code>newtype &#47;= data</code>. Whoops!"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1523601848, "post_id": 49809721, "comment_id": 86636146, "body": "@AdamSmith It boils down to how the type is parameterised. You&#39;d have your <code>fmap</code> if matthias&#39; type were <code>newtype MergeL a = MergeL a</code> -- but then it wouldn&#39;t be a list in spirit any longer."}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1523617195, "post_id": 49809721, "comment_id": 86645031, "body": "@duplode I have added the <code>mergesort</code> function above. I have also rewritten <code>divide</code> to explicitly use the same <code>leftHalf</code> and <code>rightHalf</code> functions that the non monoidal <code>mergesort</code> uses. Also note that <code>splitAt</code> is defined <code>splitAt n xs =  (take n xs, drop n xs)</code> in source. I know that I am calling <code>length xs</code> twice here, but I have left it like that just to show that that is not the main problem here."}], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 2, "last_activity_date": 1524186220, "creation_date": 1524186220, "answer_id": 49932349, "question_id": 49809721, "link": "https://stackoverflow.com/questions/49809721/haskell-sort-using-monoid-and-foldable/49932349#49932349", "title": "Haskell: Sort using Monoid and Foldable", "body": "<p>The main problem here is quite easy to miss (in fact, I overlooked it until I threw in a <a href=\"https://hackage.haskell.org/package/base-4.11.0.0/docs/Debug-Trace.html\" rel=\"nofollow noreferrer\"><code>trace</code></a> in <code>divide</code>). One of your <code>foldMap</code> cases is:</p>\n\n<pre><code>(MergeL l , MergeL r)  -&gt; foldMap f l &lt;&gt; foldMap f r\n</code></pre>\n\n<p>There, <code>foldMap</code> is being called on <code>l</code> and <code>r</code>, which are plain lists, as opposed to <code>MergeL</code>-wrapped lists. That being so, <code>l</code> and <code>r</code> are not <code>divide</code>d; rather, they are merged element by element. As a consequence, the sorting becomes quadratic.</p>\n\n<p>In addition to using the <code>MergeL</code> <code>foldMap</code> recursively, fixing the instance also requires adding extra cases for single element lists, as dividing them is as problematic as dividing empty lists:</p>\n\n<pre><code>instance Foldable MergeL where\n  foldMap f xs =\n    case divide xs of\n      (MergeL [], MergeL []) -&gt; mempty\n      (ml, MergeL [y]) -&gt; foldMap f ml &lt;&gt; f y\n      (MergeL [x], mr) -&gt; f x &lt;&gt; foldMap f mr\n      (ml, MergeL []) -&gt; foldMap f ml\n      (MergeL [], mr) -&gt; foldMap f mr\n      (ml, mr) -&gt; foldMap f ml &lt;&gt; foldMap f mr\n</code></pre>\n\n<p>This gives acceptable performance -- same complexity and order of magnitude of timings than the plain implementation without optimisations, and about the same performance with optimisations.</p>\n"}], "owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 49932349, "answer_count": 1, "score": 2, "last_activity_date": 1524186364, "creation_date": 1523596378, "last_edit_date": 1524186364, "question_id": 49809721, "link": "https://stackoverflow.com/questions/49809721/haskell-sort-using-monoid-and-foldable", "title": "Haskell: Sort using Monoid and Foldable", "body": "<p>I am trying to implement sorting using <code>Monoid</code> and <code>Foldable</code>. This is what I have so far. It is really slow. However, when I write the same functions without <code>Monoid</code> or <code>Foldable</code>, it is reasonably fast. Any pointers as to what I am doing wrong here would be greatly appreciated.   </p>\n\n<pre><code>newtype MergeL a = MergeL { getMergeL :: [a] } deriving (Eq, Show)\n\ninstance Ord a =&gt; Monoid (MergeL a) where\n  mempty      = MergeL []\n  mappend l r = MergeL $ merge (getMergeL l) (getMergeL r)\n\n\n\ncomp :: a -&gt; MergeL a\ncomp a = MergeL [a]\n\ninstance Foldable MergeL where\n  foldMap f xs =\n    case divide xs of\n      (MergeL [], MergeL []) -&gt; mempty\n      (MergeL l , MergeL []) -&gt; foldMap f l\n      (MergeL [], MergeL r)  -&gt; foldMap f r\n      (MergeL l , MergeL r)  -&gt; foldMap f l &lt;&gt; foldMap f r\n\ndivide :: MergeL a -&gt; (MergeL a, MergeL a)\n-- now uses leftHalf and rightHalf\ndivide xs = (MergeL $ leftHalf ls, MergeL $ rightHalf ls)\n  where\n    ls  = getMergeL  xs\n\nfoldSort :: (Ord a, Foldable t) =&gt; t a -&gt; [a]\nfoldSort = getMergeL . foldMap comp\n\n\nmon :: Integer -&gt; IO ()\nmon n = (print . last . getMergeL  . foldMap comp) $ MergeL [n,n - 1 ..0]\n</code></pre>\n\n<p>Shared helper functions:</p>\n\n<pre><code>leftHalf :: [a] -&gt; [a]\nleftHalf xs = take (length xs `div` 2) xs\n\nrightHalf :: [a] -&gt; [a]\nrightHalf xs = drop (length xs `div` 2) xs\n\nmerge :: Ord a =&gt; [a] -&gt; [a] -&gt; [a]\nmerge xs [] = xs\nmerge [] ys = ys\nmerge (x:xs) (y:ys)\n        | (x &lt;= y)  = x:(merge xs (y:ys))\n        | otherwise = y:(merge (x:xs) ys)\n</code></pre>\n\n<p>Here is the implementation of the the sort function without <code>Monoid</code>. It uses the same <code>leftHalf</code> and <code>rightHalf</code> for  spliting the list and the same <code>merge</code> for merging the lists:</p>\n\n<pre><code>mergesort :: Ord a =&gt; [a] -&gt; [a]\nmergesort [] = []\nmergesort [x] = [x]\nmergesort xs = merge (mergesort (leftHalf xs)) (mergesort (rightHalf xs))\n\nplain :: Integer -&gt; IO ()\nplain n = (print . last . mergesort)  [n,n - 1 ..0]\n</code></pre>\n\n<p>The difference in performance is:</p>\n\n<pre><code> \u03bb&gt; mon 4000\n4000\n(2.20 secs, 1,328,105,368 bytes)\n \u03bb&gt; plain 4000\n4000\n(0.03 secs, 11,130,816 bytes)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523605807, "post_id": 49809031, "comment_id": 86638209, "body": "How would you implement this without recursion? If the number can have an arbitrary number of digits, then you can only do this in linear time of the digits."}, {"owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523639872, "post_id": 49809031, "comment_id": 86659720, "body": "Oh yeah, recursion will be used. My question was if it&#39;s possible to implement by composing functions from Data.List, so that we no need to use recursion."}], "owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "closed_date": 1523591650, "answer_count": 0, "score": 0, "last_activity_date": 1523591410, "creation_date": 1523591410, "question_id": 49809031, "link": "https://stackoverflow.com/questions/49809031/how-to-break-a-number-into-a-list-of-digits", "closed_reason": "Duplicate", "title": "How to break a number into a list of digits?", "body": "<p>How to implement a function to break a number into a list of digits?</p>\n\n<p>For example:</p>\n\n<pre><code>breakNumber 0 == [0]\nbreakNumber 1234 == [1,2,3,4]\nbreakNumber 1000 == [1,0,0,0]\n</code></pre>\n\n<p>And is it possible to implement without using recursion?</p>\n"}, {"tags": ["haskell", "type-inference"], "answers": [{"comments": [{"owner": {"reputation": 760, "user_id": 8009379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c808a3b5c059f2b448f39970d384fd33?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/8009379/alex"}, "edited": false, "score": 0, "creation_date": 1523669699, "post_id": 49810989, "comment_id": 86669689, "body": "I expected that might be the standard thing to do. But any other data declarations that have fields of type <code>Thing&#39;</code> must now have fields of <code>Thing&#39; yType</code>. If I want <code>yType</code> inferred I must <i>also</i> parameterize <i>those</i> declarations.  The compiler&#39;s been so accommodating in other situations that this feels kind of unnatural. Maybe it wouldn&#39;t if I were more versed in type theory."}], "tags": [], "owner": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "is_accepted": true, "score": 2, "last_activity_date": 1523602512, "creation_date": 1523602512, "answer_id": 49810989, "question_id": 49808794, "link": "https://stackoverflow.com/questions/49808794/inferred-type-in-data-declaration/49810989#49810989", "title": "Inferred type in data declaration", "body": "<blockquote>\n  <p>I\u2019m surmising that I must give up a lot of compiler type inference support when I include data of such an inferred type in a user-defined data structure. Is that accurate, or am I missing something? </p>\n</blockquote>\n\n<p>Correct, type inference does not go from usage places to type definitions.</p>\n\n<p>You could parametrise <code>Thing'</code> with <code>y</code>'s type:</p>\n\n<pre><code>data Thing' yType = Thing' { x :: Int, y :: yType }\n</code></pre>\n\n<p>Then compiler would infer <code>t'</code>'s type by its usage.</p>\n"}, {"tags": [], "owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "is_accepted": false, "score": 0, "last_activity_date": 1523603282, "creation_date": 1523603282, "answer_id": 49811223, "question_id": 49808794, "link": "https://stackoverflow.com/questions/49808794/inferred-type-in-data-declaration/49811223#49811223", "title": "Inferred type in data declaration", "body": "<p>This will work</p>\n\n<pre><code>{-# LANGUAGE RankNTypes, ExistentialQuantification #-}\n\ndata Thing' = forall a m. Monad m =&gt; Thing' { x:: Int, y :: m a }\n</code></pre>\n\n<p>But you are correct, enabling these language features will make the compiler weaker in some sense, in that type inference is no longer powerful enough to work out the type of something, you will have to add a type ascription, so that the type checker can fill in. Or at least that is how I understand it.</p>\n"}], "owner": {"reputation": 760, "user_id": 8009379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c808a3b5c059f2b448f39970d384fd33?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/8009379/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 49810989, "answer_count": 2, "score": 0, "last_activity_date": 1523603282, "creation_date": 1523589535, "last_edit_date": 1523589619, "question_id": 49808794, "link": "https://stackoverflow.com/questions/49808794/inferred-type-in-data-declaration", "title": "Inferred type in data declaration", "body": "<p>On several occasions now I have run into trouble when trying to include a monadic action of an inferred type into an existing, explicitly typed data declaration:</p>\n\n<pre><code>data Thing = Thing { x :: Int }\n\nt = Thing { x = 42 }\n\n-- action :: m (Maybe (n ())), for some horrendous,\n-- deeply parameterized monad transformer stacks m, n\n\naction = return Nothing\n\ndata Thing' = Thing' { x :: Int, y :: ? }\n\nt' = Thing' { x = 42, y = action }\n</code></pre>\n\n<p>I don\u2019t want to write down what the complete type of the new field is\u2014in fact, I tried and failed. At most other times I can let the rest of the program inform the type of expressions, and I wish that I could do that here.</p>\n\n<p>I\u2019m surmising that I must give up a lot of compiler type inference support when I include data of such an inferred type in a user-defined data structure. Is that accurate, or am I missing something? </p>\n"}, {"tags": ["haskell", "record"], "comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1523589711, "post_id": 49808707, "comment_id": 86632449, "body": "Adding <code>nbsp;</code>s outside the ordered list made the code blocks work, but they&#39;re still oddly-spaced and I don&#39;t know how to fix that."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1523589923, "post_id": 49808707, "comment_id": 86632499, "body": "To the question: is there a reason you&#39;re using anonymous records? why not <code>type Record = (EmpId Int, EmpName String, EmpPhone String)</code>? This may be trivial, but..."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 1, "creation_date": 1523589982, "post_id": 49808707, "comment_id": 86632516, "body": "@AdamSmith For code blocks inside list items, use eight spaces instead of four (and for additional paragraphs within a list item, add an extra space just before the paragraph)."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1523590041, "post_id": 49808707, "comment_id": 86632527, "body": "@duplode thanks! After all these years, SO formatting is still somewhat arcane to me..."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1523592998, "post_id": 49808707, "comment_id": 86633192, "body": "I have basically no idea what you&#39;re asking. I bet Simon or Richard could understand at a glance (because that&#39;s how their minds work), but most of us here on SO are mortal. Can you try to give some sort of high-level overview of your objective, and expand the explanations of what you do and don&#39;t want out of your concrete examples?"}, {"owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1523603285, "post_id": 49808707, "comment_id": 86636893, "body": "Thanks @dfeuer/all, I&#39;ve editted the q to explain my objective and a possible approach that I don&#39;t want because it doesn&#39;t scale. I&#39;m sure someone&#39;s going to tell me <code>GHC.Generics</code> is the answer."}], "answers": [{"tags": [], "owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "is_accepted": false, "score": 0, "last_activity_date": 1523775927, "creation_date": 1523775927, "answer_id": 49839335, "question_id": 49808707, "link": "https://stackoverflow.com/questions/49808707/anonymous-records-what-ways-to-type-level-tag-in-haskell/49839335#49839335", "title": "Anonymous records: what ways to type-level tag in Haskell?", "body": "<p>Here's a kinda answer or at least explanation for 2., 3.; a partial answer to 1.</p>\n\n\n\n<blockquote>\n  <ol start=\"2\">\n  <li><p>How to express I want each record-alike to follow a consistent type pattern? That is prevent:</p>\n\n<pre><code>notaRec = (EmpId 76543, EmpName)\n</code></pre></li>\n  </ol>\n</blockquote>\n\n<p>On the face of it <code>EmpId 76543</code> matches type pattern <code>(n a)</code>; whereas <code>EmpName :: a -&gt; (n a)</code>. But Hindley-Milner doesn't \"match\" simplistically like that, it uses unifiability. So all of these unify with <code>(n a)</code>:</p>\n\n<pre><code>                  -- as `(   n        a    )`\na -&gt; (n a)        -- as `( ((-&gt;) a)  (n a) )`\n(b, c)            -- as `( (,) b )    c     `\n(b, c, d)         -- as `( (,,) b c ) d     `        -- etc for all larger Haskell tuples\n[ a ], Maybe a    -- as `( []         a    )`, `( Maybe     a )`\nEither b c        -- as `( (Either b) c    )`\nb -&gt; (Either b c) -- as `( ((-&gt;) b)  (Either b c) )` -- for example, bare `Left`\n</code></pre>\n\n<p>To disagree with myself on the abuse of terminology:</p>\n\n<blockquote>\n  <p>I want to say these are ill-Kinded. My field tags are appearing at different 'depths' ...<br>\n  But I know that's abusing terminology. </p>\n</blockquote>\n\n<p>Any type with a <code>-&gt;</code> outermost constructor is at a different <code>Kind</code> vs one without. <code>Either</code> is at a different <code>Kind</code> vs <code>EmpId</code>, because it is different arity. Type unification builds the '<strong>m</strong>ost <strong>g</strong>eneral <strong>u</strong>nifier', and that makes them appear same-<code>Kind</code>ed.</p>\n\n<p>For the purposes here we want the opposite of the mgu -- call it the 'maximally specific <code>Kind</code>', <code>MaSK</code> for short.</p>\n\n<p>We can express it with a closed Type Family and lots of overlapping equations (so the order of them is critical). This can also catch the Prelude's constructors that shouldn't count:</p>\n\n<pre><code>type family MaSK ( a :: * ) where\n      -- presume the result is one from some pre-declared bunch of types\n      -- use that result to verify all 'elements' of a set are same-kinded\n\n  MaSK (_  -&gt; _ _ _)       = No            -- e.g. bare `Left`\n  MaSK (_  -&gt; [ _ ])       = No            -- reject unwanted constructors\n  MaSK (_  -&gt; Maybe _ )    = No            -- ditto\n  MaSK (a' -&gt; n a')        = YesAsBareTag  -- this we want\n  MaSK (_  -&gt; _ _ )        = No            --\n  MaSK (_  -&gt; _ )          = No\n\n  MaSK ( _ , _ , _ , _ )   = YesAsSet      -- etc for greater arities\n  MaSK ( _ , _ , _ )       = YesAsSet\n  MaSK ( _ , _ )           = YesAsSet\n\n  MaSK (_ _ _ )            = No            -- too much arity, e.g. `Either b c`\n  MaSK  [ _ ]              = No            -- reject unwanted constructors\n  MaSK (Maybe _)           = No            -- ditto\n\n  MaSK (n a)               = YesAsTagValue -- this we want providing all the above eliminated\n  MaSK  _                  = No            -- i.e. bare `Int, Bool, Char, ...`\n</code></pre>\n\n<p>Limitations: this approach can't check there's a single data constructor for the type, nor that other constructors for that type match the pattern, nor that the constructor is named same as the type, nor that the constructor might smuggle in existentially-quantified parameters. For that, go full metal <code>generics</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "is_accepted": false, "score": 2, "last_activity_date": 1528439239, "creation_date": 1528439239, "answer_id": 50754595, "question_id": 49808707, "link": "https://stackoverflow.com/questions/49808707/anonymous-records-what-ways-to-type-level-tag-in-haskell/50754595#50754595", "title": "Anonymous records: what ways to type-level tag in Haskell?", "body": "<p>This is crazy enough it might just work. Pattern synonyms to the rescue:</p>\n\n<pre><code>newtype Label (n :: Symbol) (a :: *) = MkLab a             -- newtype yay!\n  deriving (Eq, Ord, Show)\n\npattern EmpPhone x = MkLab x :: Label \"EmpPhone\" a\npattern EmpName x  = MkLab x :: IsString a =&gt; Label \"EmpName\" a\npattern EmpId x    = MkLab x :: Label \"EmpId\" Int\n\nmyRec = (EmpId 54321, EmpName \"Jo\", EmpPhone \"98-7654321\") -- works a treat\n</code></pre>\n\n<p>Then to answer the q's</p>\n\n<ol>\n<li><p>To count as a record, all tuple elements must be of type <code>Label s a</code>.</p></li>\n<li><p>To count as a projection list, all tuple elements must be of type <code>a -&gt; Label s a</code>.\n(That works, by the way.)</p></li>\n<li><p>Those are the only types/kinds allowed in tuples-as-records.\nSo to parse a tuple-of-tuples at type level, I need only despatch on the type of the leftmost element.\nI'm looking for type constructor <code>Label</code>.\nAll the rest I can do with <code>HList</code>-style type matching.</p></li>\n</ol>\n\n<p>For those patterns I did need to switch on a swag of extensions:</p>\n\n<pre><code>{-# LANGUAGE  PatternSynonyms,\nKindSignatures, DataKinds,\nScopedTypeVariables,                                       -- for the signatures on patterns\nRankNTypes                 #-}                             -- for the signatures with contexts\nimport GHC.TypeLits                                        -- for the Symbols\n</code></pre>\n"}], "owner": {"reputation": 1963, "user_id": 2840542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eO77F.jpg?s=128&g=1", "display_name": "AntC", "link": "https://stackoverflow.com/users/2840542/antc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 334, "favorite_count": 2, "answer_count": 2, "score": 3, "last_activity_date": 1528439239, "creation_date": 1523588902, "last_edit_date": 1523602733, "question_id": 49808707, "link": "https://stackoverflow.com/questions/49808707/anonymous-records-what-ways-to-type-level-tag-in-haskell", "title": "Anonymous records: what ways to type-level tag in Haskell?", "body": "<p>I'm playing with lightweight anonymous record-alikes, more to explore the type theory for them than anything 'industrial strength'. I want the fields to be simply type-tagged.</p>\n\n\n\n<pre><code>myRec = (EmpId 54321, EmpName \"Jo\", EmpPhone \"98-7654321\")   -- in which\n\nnewtype EmpPhone a = EmpPhone a                              -- and maybe\ndata EmpName a where EmpName :: IsString a =&gt; a -&gt; EmpName a -- GADT\ndata EmpId   a where EmpId   ::             Int -&gt; EmpId Int -- GADT to same pattern\n</code></pre>\n\n<p>Although I could put <code>newtype EmpId = EmpId Int</code>, I want to follow the same pattern for all tags, so that I can go for example:</p>\n\n<pre><code>project (EmpId, EmpName) myRec           -- use tags as field names\n</code></pre>\n\n<p>I'll also use <code>StandaloneDeriving/DeriveAnyType</code> to <code>derive instance Eq, Show, Num</code> etc.</p>\n\n<p><strong>Other possible designs</strong></p>\n\n<ul>\n<li>For the records, rather than Haskell tuples I could use <code>HList</code> or make my own data types <code>Tuple0, Tuple1, Tuple2, ...</code>. I don't think that would affect the typing issues below.</li>\n<li><p>For the tags/fields I could pair a <code>Symbol</code> (type-level <code>String</code>) as phantom type with the value -- for example <code>CTRex</code> does something like that. Then use <code>TypeApplications</code> to build fields.</p>\n\n<pre><code>data Tag (tag :: Symbol) a = Tag a  \nmyRec = (Tag @\"EmpId\" 54321, ...)\n</code></pre></li>\n</ul>\n\n<p>That makes the field syntax (and projection list) rather 'noisy'; also prevents any validation that <code>EmpId</code>s are <code>Int</code>, etc.</p>\n\n<p>Three related lines of <strong>questions</strong> on typing for these:</p>\n\n<ol>\n<li><p>How best to prevent</p>\n\n<pre><code>sillyRec = (EmpId 65432, Just \"not my tag\", \"or [] as constructor\",  \n            Right \"or even worse\" :: Either Int String)\n</code></pre>\n\n<p>I could declare a class, put my tags only in it (not too bad with <code>DeriveAnyClass</code>), put constraints everywhere. But my tags have a consistent structure: single data constructor named same as the type; single type parameter which is the only parameter to the data constructor.</p></li>\n<li><p>How to express I want each record-alike to follow a consistent type pattern? That is prevent:</p>\n\n<pre><code>notaRec = (EmpId 76543, EmpName)\n</code></pre>\n\n<p>Bare <code>EmpName</code> is OK in a projection list, providing all the other fields are bare constructors. I want to say that <code>notaRec</code> is not well-<code>Kind</code>ed, but bare <code>EmpName</code> is <code>Kind * -&gt; *</code>, which is unifiable with <code>*</code>. So I mean more like: all fields in the record fit the same type pattern.</p></li>\n<li><p>Then when I get to sets-of-records (aka tables/relations)</p>\n\n<pre><code>myTable = ( myRec,                                -- tuple of tuples  \n           (EmpName \"Kaz\", EmpPhone 987654312, EmpId 87654),  \n            EmpId 98765, EmpPhone \"21-4365879\", EmpName \"Bo\")\n</code></pre>\n\n<p>Putting the fields in a different order is OK because we have a tuple-of-tuples. But <code>EmpPhone</code> is at two different types in the two records. And the last line isn't a record at all: it's fields at the 'wrong' pattern. (Same mis-match as with bare <code>EmpName</code> in 2.)</p>\n\n<p>Again I want to say these are ill-<code>Kind</code>ed. My field tags are appearing at different 'depths' or in differing type patterns.</p>\n\n<p>I guess I could get there with a great deal of hard-coding for valid instances/combos of types. Is there a more generic way?</p></li>\n</ol>\n\n<p><strong>EDIT:</strong> In response to comments. (Yes I'm mortal too. Thanks @duplode for figuring out the formatting.)</p>\n\n<blockquote>\n  <p>why not <code>type Record = (EmpId Int, EmpName String, EmpPhone String)</code>?</p>\n</blockquote>\n\n<p>As a type synonym that's fine. But doesn't answer the question because I want it equivalent to any permutation of those tags. (I think I can verify that equivalence at type level using <code>HList</code> techniques.)</p>\n\n<blockquote>\n  <p>some sort of high-level overview of your objective [thank you David]</p>\n</blockquote>\n\n<p>I want to treat the <code>( ... , ... , ... )</code> as a set. Because the Relational Database Model says relations are sets of 'tuples' [not Haskell tuples] and 'tuples' are sets of pairs of tag-value. I also want to treat the <code>project</code> function as having a first-class parameter which is a set of tags. (Contrast that in Codd's Relational Algebra, the <code>&pi;</code> operator has its set of tags subscripted as if part of the operator.)</p>\n\n<p>These couldn't be Haskell <code>Set</code>s because the elements are not the same type. I want to say the elements are the same <code>Kind</code>; and that a Haskell-tuple of same-<code>Kind</code>ed elements represents a set-of that <code>Kind</code>. But I know that's abusing terminology. (The alternative design I considered using <code>Symbol</code> tags perhaps shows better there's a <code>Kind</code>iness aspect.)</p>\n\n<p>If I can treat the Haskell tuples as set-ish, I can use well-known <code>HList</code> techniques to emulate the Relational Operators.</p>\n\n<p>If this helps explain, I could do this with a lot of boilerplate:</p>\n\n<pre><code>class MyTag a                                 -- type/kind-level predicate\n\nderiving instance MyTag (EmpId Int)           -- uses DeriveAnyClass\n                                              -- etc for all my tags\nclass WellKinded tup\ninstance WellKinded ()\n\ninstance {-# OVERLAPPING #-}\n      (MyTag (n1 a1), MyTag (n2 a2), MyTag (n3 a3))\n      =&gt; WellKinded (n1 a1, n2 a2, n3 a3)     -- and so on for every arity of tuple\n\ninstance {-# OVERLAPPABLE #-}\n      (MyTag (n1 a1), MyTag (n2 a2), MyTag (n3 a3))\n      =&gt; WellKinded (a1 -&gt; n1 a1, a2 -&gt; n2 a2, a3 -&gt; n3 a3)\n</code></pre>\n\n<p>All those instances for different arities are rapidly going to get tedious, so I could convert to <code>HList</code>; despatch an instance on the <code>Kind</code> of the first element; iterate down the list verifying all the same <code>Kind</code>.</p>\n\n<p>For tuple-of-tuples, detect the <code>Kind</code> of the first element of the first sub-tuple; iterate both across and down. (Again needs <code>OverlappingInstances</code>: a tuple-of-tuples-of-tuples is still a tuple. This is what I mean by \"a great deal of hard-coding\" above.) It doesn't seem unachievable. But it does feel like going down the wrong rabbit-hole.</p>\n"}, {"tags": ["haskell", "haskell-stack", "hakyll"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1523586900, "post_id": 49808366, "comment_id": 86631802, "body": "This shouldn&#39;t be happening. (1) Is there anything else specified in your <code>stack.yaml</code> other than the resolver? If so, please <a href=\"https://stackoverflow.com/posts/49808366/edit\">edit</a> the file into your question. (2) Just to make sure: only the four packages mentioned in the console output you posted get rebuilt, right?"}, {"owner": {"reputation": 28, "user_id": 9303895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2ca5869316991238779a7d5547e0d06?s=128&d=identicon&r=PG&f=1", "display_name": "kaznak", "link": "https://stackoverflow.com/users/9303895/kaznak"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1523587533, "post_id": 49808366, "comment_id": 86631945, "body": "Thank you duplode. (1) I fixed stack.yaml. This stack.yaml is generated one while I&#39;m doing hakyll tutorial and contains lots of comments. (2) Yes, stack recompile 4 additional packages. I have tried this on completely new hakyll project now. stack is now compiling these 4 additionally."}], "answers": [{"comments": [{"owner": {"reputation": 28, "user_id": 9303895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2ca5869316991238779a7d5547e0d06?s=128&d=identicon&r=PG&f=1", "display_name": "kaznak", "link": "https://stackoverflow.com/users/9303895/kaznak"}, "edited": false, "score": 0, "creation_date": 1523600984, "post_id": 49809159, "comment_id": 86635728, "body": "Thank you. I will wait for their merge."}], "tags": [], "owner": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "is_accepted": true, "score": 4, "last_activity_date": 1523592371, "creation_date": 1523592371, "answer_id": 49809159, "question_id": 49808366, "link": "https://stackoverflow.com/questions/49808366/why-does-stack-rebuild-some-dependencies-on-each-build/49809159#49809159", "title": "Why does Stack rebuild some dependencies on each build?", "body": "<p>There is a discussion of this here <a href=\"https://github.com/commercialhaskell/stack/issues/3899\" rel=\"nofollow noreferrer\">https://github.com/commercialhaskell/stack/issues/3899</a> .  It's a known issue triggered by newer versions of haddock using sub-libraries.  There's a PR open fixing the issue, but it hasn't been merged yet.</p>\n"}], "owner": {"reputation": 28, "user_id": 9303895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f2ca5869316991238779a7d5547e0d06?s=128&d=identicon&r=PG&f=1", "display_name": "kaznak", "link": "https://stackoverflow.com/users/9303895/kaznak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 1, "accepted_answer_id": 49809159, "answer_count": 1, "score": 1, "last_activity_date": 1523592371, "creation_date": 1523586098, "last_edit_date": 1523587925, "question_id": 49808366, "link": "https://stackoverflow.com/questions/49808366/why-does-stack-rebuild-some-dependencies-on-each-build", "title": "Why does Stack rebuild some dependencies on each build?", "body": "<p>I'm now learning hakyll static site generator with stack.</p>\n\n<p>When I execute <code>stack build</code> in the directory of my Hakyll site to rebuild <code>site.hs</code>, stack also rebuilds and copy/register dependencies each time, as shown below:</p>\n\n<pre><code>$ stack --version\nVersion 1.6.5, Git revision 24ab0d6ff07f28276e082c3ce74dfdeb1a2ca9e9 (5514 commits) x86_64 hpack-0.20.0\n$ grep -Ev '^[[:space:]]*#' stack.yaml | uniq\n\nresolver: lts-11.4\n\npackages:\n- .\n\n$ stack build\nhaddock-library-1.4.5: configure\nhaddock-library-1.4.5: build\nhaddock-library-1.4.5: copy/register\npandoc-2.1.2: configure\npandoc-2.1.2: build\npandoc-2.1.2: copy/register\npandoc-citeproc-0.14.3: configure\npandoc-citeproc-0.14.3: build\npandoc-citeproc-0.14.3: copy/register\nhakyll-4.12.1.0: configure\nhakyll-4.12.1.0: build\nhakyll-4.12.1.0: copy/register\n... and site.hs.compilation ...\n</code></pre>\n\n<p>This is odd to me, because I have never changed those packages.\nThe rebuild takes quite long even for very small changes on <code>site.hs</code>.</p>\n\n<p>Why does stack rebuild those packages? And is there any way to reduce this rebuild time?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["haskell", "types"], "answers": [{"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 12, "last_activity_date": 1523568868, "creation_date": 1523568868, "answer_id": 49806226, "question_id": 49806191, "link": "https://stackoverflow.com/questions/49806191/haskell-datatype-range/49806226#49806226", "title": "Haskell datatype range", "body": "<p>There is: Derive <code>Enum</code> and define</p>\n\n<pre><code>range (x, y) = [x .. y]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1523568984, "post_id": 49806240, "comment_id": 86627266, "body": "Shouldn&#39;t that be <code>enumFromTo</code>?"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 11, "last_activity_date": 1523607324, "last_edit_date": 1523607324, "creation_date": 1523568911, "answer_id": 49806240, "question_id": 49806191, "link": "https://stackoverflow.com/questions/49806191/haskell-datatype-range/49806240#49806240", "title": "Haskell datatype range", "body": "<h1>By using the <code>Enum</code> instance</h1>\n\n<p>Yes, you can make <code>Row</code> an <strong>instance of <code>Enum</code></strong>, in fact you do not have to define it yourself:</p>\n\n<pre><code>data Row = A | B | C deriving (Show, Eq, Ord<b>, Enum</b>)</code></pre>\n\n<p>This means that we can now use \"<em>range notation</em>\". For example:</p>\n\n<pre><code>Prelude&gt; [A .. C]\n[A,B,C]\nPrelude&gt; [A .. B]\n[A,B]\nPrelude&gt; [C .. B]\n[]\n</code></pre>\n\n<p>So we can now define our <code>Ix</code> instance as:</p>\n\n<pre><code>instance Ix Row where\n    range (x, z) = [x .. z]\n    index (x, _) y = fromEnum y - fromEnum x\n    inRange (x, z) y = x &lt;= y &amp;&amp; y &lt;= z\n</code></pre>\n\n<p>Or even without parameters:</p>\n\n<pre><code>instance Ix Row where\n    range = uncurry enumFromTo\n    -- ...\n</code></pre>\n\n<h1>By defining a custom \"successor\" function</h1>\n\n<p>In case you do not want to make it an <code>Enum</code> instance (I do not see any reason here not to, but this is of course a rather hypothetical datatype). We can construct a list by using recursion and each time calculating the successor:</p>\n\n<pre><code>instance Ix Row where\n    range (x, z) = go x\n        where go y | y &gt; z = []\n              go A = A : go B\n              go B = B : go C\n              go C = [C]\n</code></pre>\n\n<p>Although the code fragment above is still a large amount of work, it scales <em>linear</em> with the number of data constructors, whereas an exhaustive approach, would scale <em>quadratic</em> with the number of data constructors (<em>not</em> in time complexity, but in the amount of code).</p>\n"}], "owner": {"reputation": 640, "user_id": 8015575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/600de8cfd5d1fbd41152c709122662f0?s=128&d=identicon&r=PG&f=1", "display_name": "Ben373", "link": "https://stackoverflow.com/users/8015575/ben373"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 491, "favorite_count": 0, "accepted_answer_id": 49806226, "answer_count": 2, "score": 5, "last_activity_date": 1523607324, "creation_date": 1523568668, "last_edit_date": 1523570029, "question_id": 49806191, "link": "https://stackoverflow.com/questions/49806191/haskell-datatype-range", "title": "Haskell datatype range", "body": "<p>I define my own datatype.</p>\n\n<pre><code>data Row = A | B | C deriving (Show,Eq,Ord)\n</code></pre>\n\n<p>The question is, if there is a more elegant way to define my range than this?   </p>\n\n<pre><code>instance Ix Row where\n  range (A,A) = [A]\n  range (A,B) = [A,B]\n  range (A,C) = [A,B,C]\n  range (B,B) = [B]\n  range (B,C) = [B,C]\n  range (C,C) = [C]\n  range _     = []\n</code></pre>\n"}, {"tags": ["arrays", "haskell", "vector", "higher-rank-types", "traversable"], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1523740963, "creation_date": 1523740963, "answer_id": 49836335, "question_id": 49805854, "link": "https://stackoverflow.com/questions/49805854/vector-creation-safety/49836335#49836335", "title": "Vector creation safety", "body": "<p>Pushing this idea to the limit has actually helped me understand it better, and I'm now fairly well convinced that <em>all</em> of these functions are safe. Consider</p>\n\n<pre><code>createTOf\n  :: (forall s1 s2.\n       (MVector s1 a -&gt; ST s2 (Vector a))\n       -&gt; t (MVector s1 a) -&gt; ST s2 (u (Vector a)))\n  -&gt; (forall s. ST s (t (MVector s a)))\n  -&gt; u (Vector a)\ncreateTOf trav m = runST $ m &gt;&gt;= trav unsafeFreeze\n</code></pre>\n\n<p>It's certainly quite a mouthful of a type signature! Let's focus in closely on the safety property we care about: that no <code>MVector</code> is mutated after it is frozen. The first thing we do is run <code>m</code> to produce something of type <code>t (MVector s a)</code>.</p>\n\n<p><code>t</code> is very mysterious right now. Is it a container? Is it some sort of action that produces vectors? We can't really say terribly much about what it <em>is</em>, but we <em>can</em> say some things about what <code>trav unsafeFreeze</code> <em>cannot</em> do with it. Let's start by breaking out the type signature of <code>trav</code>:</p>\n\n<pre><code>trav :: forall s1 s2.\n        (MVector s1 a -&gt; ST s2 (Vector a))\n     -&gt; t (MVector s1 a) -&gt; ST s2 (u (Vector a)))\n</code></pre>\n\n<p><code>trav</code> turns <code>t (MVector s1 a)</code> into <code>ST s2 (u (Vector a))</code>. If <code>t</code> has vectors in it, then those vectors live in state thread <code>s1</code>. The result, however, is an action in state thread <code>s2</code>. So <code>trav</code> cannot modify an <code>MVector</code>s it's given using the usual operations. It can only apply the function it takes (which will be <code>unsafeFreeze</code>), and use whatever machinery may ride in on <code>t</code>. What sort of machinery could ride in on <code>t</code>? Well, here's a silly example:</p>\n\n<pre><code>data T :: Type -&gt; Type where\n  T :: [ST s (MVector s a)] -&gt; t (MVector s a)\n</code></pre>\n\n<p>Could <code>trav</code> interleave these <code>ST</code> actions with the freezes? No! Those <code>ST</code> actions match the <code>MVector</code>s, but they <em>don't</em> match the state thread <code>trav</code> operates in. So <code>trav</code> can't do anything with them whatsoever.</p>\n"}], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 1, "answer_count": 1, "score": 14, "last_activity_date": 1523740963, "creation_date": 1523567168, "last_edit_date": 1523732252, "question_id": 49805854, "link": "https://stackoverflow.com/questions/49805854/vector-creation-safety", "title": "Vector creation safety", "body": "<p>This question is actually a small lattice of very closely related questions; I don't think it makes much sense to break it up as yet.</p>\n\n<p>One of the fundamental ways to create a <a href=\"https://www.stackage.org/haddock/lts-11.4/vector-0.12.0.1/Data-Vector.html#t:Vector\" rel=\"nofollow noreferrer\"><code>Vector</code></a> is using <a href=\"https://www.stackage.org/haddock/lts-11.4/vector-0.12.0.1/Data-Vector.html#v:unsafeFreeze\" rel=\"nofollow noreferrer\"><code>unsafeFreeze</code></a>. As its name suggests, <code>unsafeFreeze</code> is truly unsafe. In particular, nothing prevents the <code>MVector</code> passed to <code>unsafeFreeze</code> from being modified after it is frozen. This leads to two different problems:</p>\n\n<ol>\n<li><p>It can make \"immutable\" vectors change in value. This is just the sort of spooky action at a distance Haskell generally shuns.</p></li>\n<li><p>Modifying a frozen vector can (at least potentially) confuse the garbage collector. There is no documented guarantee that the garbage collector will scan frozen arrays to ensure their contents are evacuated. More generally, mutating vectors while they are frozen is absolutely forbidden, and the result of doing so is utterly unspecified.</p></li>\n</ol>\n\n<p>The <a href=\"https://www.stackage.org/package/vector\" rel=\"nofollow noreferrer\"><code>vector</code></a> package[1] offers two efficient, seemingly safe, primitives for creating immutable vectors: <a href=\"https://www.stackage.org/haddock/lts-11.4/vector-0.12.0.1/Data-Vector.html#v:create\" rel=\"nofollow noreferrer\"><code>create</code></a> and <a href=\"https://www.stackage.org/haddock/lts-11.4/vector-0.12.0.1/Data-Vector.html#v:createT\" rel=\"nofollow noreferrer\"><code>createT</code></a>:</p>\n\n<pre><code>create :: (forall s. ST s (MVector s a)) -&gt; Vector a\ncreateT :: Traversable t =&gt; (forall s. ST s (t (MVector s a))) -&gt; t (Vector a)\n</code></pre>\n\n<p>Ignoring vector fusion business, the basic implementations look like</p>\n\n<pre><code>create m = runST $ m &gt;&gt;= unsafeFreeze\ncreateT m = runST $ m &gt;&gt;= traverse unsafeFreeze\n</code></pre>\n\n<p><code>create</code> is pretty clearly safe. It runs the given <code>ST s</code> action, which must create a fresh <code>MVector s</code> (the type of <code>runST</code> ensures it can't use an existing one, and also ensures that <code>fixST</code> can't play any funny tricks), freezes it, and returns the frozen vector.</p>\n\n<p><code>createT</code> is pretty clearly safe when the <code>Traversable</code> instance is lawful. With lists, for example, <code>createT m</code> runs an action producing a list of <code>MVector</code>s, then freezes them all. Parametricity in <code>s</code> then seems sufficient, as for <code>create</code>, to ensure nothing bad happens. Note that the action <em>may</em> create a list with multiple copies of the same <code>MVector</code>. These will be frozen twice, but there shouldn't be any harm in that. Lawful <code>Traversable</code> instances <a href=\"https://stackoverflow.com/a/32821966/1477667\">all look pretty much like decorated lists</a>, so they should behave similarly. Now I finally reach my first question:</p>\n\n<p><strong>Is <code>createT</code> safe when used with an unlawful <code>Traversable</code> instance?</strong></p>\n\n<p>Unlawfully dropping, duplicating or rearranging some elements or changing decorations (violating the identity law) doesn't pose any obvious difficulty. Parametricity prevents any interesting violations of the naturality law, so that's out. I haven't been able to find a way to cause trouble by violating the composition law or totality, but that is no guarantee that there isn't one.</p>\n\n<p>One obvious way to generalize <code>createT</code> is to allow the user to pass their own traversal function:</p>\n\n<pre><code>createTOf\n  :: (forall f x y. Applicative f =&gt; (x -&gt; f y) -&gt; t x -&gt; f (u y))\n  -&gt; (forall s. ST s (t (MVector s a))) -&gt; u (Vector a)\ncreateTOf trav m = runST $ m &gt;&gt;= trav unsafeFreeze\n</code></pre>\n\n<p>Note that I've allowed the traversal to change the container type from <code>t</code> to <code>u</code>. This allows the user to, for example, produce a <code>Vector (MVector s a)</code> but get back a <code>[Vector a]</code>. When <code>t ~ u</code>, this is obviously just as safe as <code>createT</code> with an unlawful <code>Traversable</code> instance. Does the extra flexibility of changing the \"container\" type reduce safety? <strong>Edit:</strong> I just realized I can answer this one: no, it makes no difference. See [2] below for an explanation.</p>\n\n<p>When we use <code>createT</code>, we might not actually want a container of vectors; perhaps we want to traverse that container to get something else. We can write something like</p>\n\n<pre><code>traverse f &lt;$&gt; createT m\n</code></pre>\n\n<p>The extra type flexibility of <code>createTOf</code> means we don't necessarily have a <code>Traversable</code> on our hands, and can't necessarily do this. But using the composition law for <code>Traversable</code>, we can integrate this traversal into the creation function:</p>\n\n<pre><code>createTOfThen\n  :: Applicative g\n  =&gt; (forall f x y. Applicative f =&gt; (x -&gt; f y) -&gt; t x -&gt; f (u y))\n  -&gt; (Vector a -&gt; g b)\n  -&gt; (forall s. ST s (t (MVector s a)))\n  -&gt; g (u b)\ncreateTOfThen trav f m =\n  runST $ m &gt;&gt;= getCompose . trav (Compose . fmap f . unsafeFreeze)\n</code></pre>\n\n<p><strong>Is <code>createTOfThen</code> safe if <code>trav</code> is not a lawful traversal?</strong></p>\n\n<hr>\n\n<p>I did say I'd be talking about a lattice, right? The next question is how much (if at all) we can weaken the polymorphism of the traversal without causing trouble. Everything will typecheck even if the traversal is only required to be polymorphic in <code>s</code>, but that's obviously unsafe, as it can interleave freezing with modification however it likes. \nRevealing to the that the end result holds <code>Vector</code> values seems likely to be harmless enough, but we surely can't let the traversal know <em>both</em> that it is operating in <code>ST s</code> <em>and</em> that it is handling <code>MVector s a</code> values. But could we let it know one of those facts? Fixing the <code>Applicative</code> would certainly be useful:</p>\n\n<pre><code>createTOf'\n  :: (forall s x y. (x -&gt; ST s y) -&gt; t x -&gt; ST s (u y))\n  -&gt; (forall s. ST s (t (MVector s a))) -&gt; u (Vector a)\n\ncreateTOfThen'\n  :: Applicative g\n  =&gt; (forall s x y. (x -&gt; Compose (ST s) g y) -&gt; t x -&gt; Compose (ST s) g (u y))\n  -&gt; (Vector a -&gt; g b)\n  -&gt; (forall s. ST s (t (MVector s a)))\n  -&gt; g (u b)\n</code></pre>\n\n<p>This would offer more efficient creation of things like vectors of vectors, as vectors can be traversed more efficiently in <code>ST</code> than in arbitrary <code>Applicative</code> functors. It would also reduce dependence on inlining, as we'd avoid dealing with the <code>Applicative</code> dictionary.</p>\n\n<p>On the flip side, I suspect we can let the traversal know it's handling <code>MVector</code>s ... as long as we don't let it know what state thread they're associated with. This is sufficient to unbox them, and also (perhaps unfortunately) to get their sizes.</p>\n\n<p><strong>Edit!</strong> If the traversal is allowed to know that it's producing <code>Vector</code>s (which seems like the very least likely thing to be problematic), then <code>createTOfThen</code> can be implemented in terms of <code>createTOf</code>:</p>\n\n<pre><code>createTOfThen trav post m = getConst $\n  createTOf (\\f -&gt;\n    fmap Const . getCompose . (trav (Compose . fmap post . f))) m\n</code></pre>\n\n<hr>\n\n<p>Taking the lattice in a third direction, let's move on to rank-2 traversals. The <code>rank2classes</code> package offers its own <a href=\"https://www.stackage.org/haddock/lts-11.4/rank2classes-1.0.2/Rank2.html#t:Traversable\" rel=\"nofollow noreferrer\"><code>Traversable</code></a> class, which I'll call <code>R2.Traversable</code>:</p>\n\n<pre><code>class (R2.Functor g, R2.Foldable g) =&gt; R2.Traversable g where\n  R2.traverse :: Applicative m\n              =&gt; (forall a. p a -&gt; m (q a))\n              -&gt; g p -&gt; m (g q)\n</code></pre>\n\n<p>We can play <em>exactly</em> the same games with this to produce <em>heterogeneous</em> containers of <code>Vector</code>s:</p>\n\n<pre><code>createTHet\n  :: R2.Traversable t\n  =&gt; (forall s. ST s (t (MVector s)))\n  -&gt; t Vector\ncreateTHet m = runST $ m &gt;&gt;= R2.traverse unsafeFreeze\n\ncreateTHetOf\n  :: (forall h f g.\n       (Applicative h =&gt; (forall x. f x -&gt; h (g x)) -&gt; t f -&gt; h (u g)))\n  -&gt; (forall s. ST s (t (MVector s)))\n  -&gt; u Vector\ncreateTHetOf trav m = runST $ m &gt;&gt;= trav unsafeFreeze\n\ncreateTHetOfThen\n  :: Applicative q\n  =&gt; (forall h f g.\n       (Applicative h =&gt; (forall x. f x -&gt; h (g x)) -&gt; t f -&gt; h (u g)))\n  -&gt; (forall x. Vector x -&gt; q (r x))\n  -&gt; (forall s. ST s (t (MVector s)))\n  -&gt; q (u r)\ncreateTHetOfThen trav post m =\n    runST $ m &gt;&gt;= getCompose . trav (Compose . fmap post . unsafeFreeze)\n</code></pre>\n\n<p>along with similar versions where the traversal is allowed to know it's working in <code>ST s</code>. I would <em>imagine</em> that the safety properties of the rank-2 versions are identical to those of the corresponding rank-1 versions, but I don't have a clue how one might go about proving such.</p>\n\n<p>Just for fun, I think the top of my lattice is the following monstrosity. If any of these ideas are unsafe, this one probably is:</p>\n\n<pre><code>createTHetOfThen'\n  :: (forall s1 s2.\n       ((forall x. MVector s2 x -&gt; Compose (ST s1) q (r x)) -&gt; t (MVector s2) -&gt; Compose (ST s1) q (u r)))\n  -&gt; (forall x. Vector x -&gt; q (r x))\n  -&gt; (forall s. ST s (t (MVector s)))\n  -&gt; q (u r)\ncreateTHetOfThen' trav post m =\n    runST $ m &gt;&gt;= getCompose . trav (Compose . fmap post . unsafeFreeze)\n</code></pre>\n\n<hr>\n\n<p>[1] I've linked to Stackage because Hackage is down today. If I remember and have time, I'll fix up the links later.</p>\n\n<p>[2] The proof comes from <code>Data.Functor.Sum</code>. Given a non-type-changing <code>createTOfSame</code>, we can write</p>\n\n<pre><code>createTOf\n  :: (forall f a b. Applicative f =&gt; (a -&gt; f b) -&gt; t a -&gt; f (u b))\n  -&gt; (forall s. ST s (t (MVector s a)))\n  -&gt; u (Vector a)\ncreateTOf trav m =\n  case createTOfSame (\\f (InL xs) -&gt; InR &lt;$&gt; trav f xs)\n                     (InL &lt;$&gt; m) of\n    InR u -&gt; u\n</code></pre>\n\n<p>This will actually be total, although the \"traversal\" is partial: we always case match on what we will surely find.</p>\n"}, {"tags": ["haskell", "tree"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523565003, "post_id": 49805378, "comment_id": 86625557, "body": "Let us forget about Haskell for a minute. How would you define yourself - in words - a way to find the leftmost value?"}, {"owner": {"reputation": 187, "user_id": 9517321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dc52bd738d15863c94b001d51483099?s=128&d=identicon&r=PG&f=1", "display_name": "Aelin", "link": "https://stackoverflow.com/users/9517321/aelin"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523565379, "post_id": 49805378, "comment_id": 86625722, "body": "Check if the current Node has a left child. If yes, then go to that child. If not, then the current Node is the leftmost."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523565406, "post_id": 49805378, "comment_id": 86625733, "body": "good, can you now transfer that into an inductive definition?"}], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 9517321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dc52bd738d15863c94b001d51483099?s=128&d=identicon&r=PG&f=1", "display_name": "Aelin", "link": "https://stackoverflow.com/users/9517321/aelin"}, "edited": false, "score": 1, "creation_date": 1523566475, "post_id": 49805520, "comment_id": 86626200, "body": "Thank you for such a detailed explanation! Really helps me to understand."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1523565661, "creation_date": 1523565661, "answer_id": 49805520, "question_id": 49805378, "link": "https://stackoverflow.com/questions/49805378/leftmost-value-in-a-tree-haskell/49805520#49805520", "title": "Leftmost value in a tree (Haskell)", "body": "<p>Well <em>before</em> you write a function in Haskell, it is better to first think about an (inductive) definition about the leftmost element in the tree.</p>\n\n<p>You actually already wrote one part of it:</p>\n\n<blockquote>\n<pre><code>leftest (Leaf) = Nothing\n</code></pre>\n</blockquote>\n\n<p>Here you basically state: \"<em>A leaf has no leftmost element</em>\". So now the question is, what is the <em>leftmost</em> value of a <code>Tree a (Tree a) (Tree a)</code>?</p>\n\n<p>We can reason about several cases here. There are basically four cases here: the two subtrees can be <code>Leaf</code>s or <code>Tree ...</code>s, for each of these cases, we can try to come up with a solution:</p>\n\n<ol>\n<li><code>Tree x Leaf Leaf</code>, here we thus have a node without any childs (in fact in most books on data structures, that is a <em>leaf</em>), in that case the leftmost value is the one that is carried by the <code>Tree x Leaf Leaf</code>, so <code>x</code>, so we can return <code>Just x</code>;</li>\n<li><code>Tree x Leaf (Tree _ _ _)</code>, here we have a tree, with only a child on the right. Since that child, and all its descendants are on the right, we thus can again return the element of the node, so <code>Just x</code>;</li>\n<li><code>Tree x (Tree _ _ _) Leaf</code>, here we have only a child on the left. In that case the leftmost of this tree, is the same as the leftmost of the left child, so we recurse on the left child; and</li>\n<li><code>Tree x (Tree _ _ _) (Tree _ _ _)</code>, here the node has two children, but like we already argued, the right child is of no importance, we can again recurse on the left child.</li>\n</ol>\n\n<p>So we can write these as:</p>\n\n<pre><code>leftmost :: Tree a -&gt; Maybe a\nleftmost Leaf = Nothing\nleftmost (Tree x Leaf Leaf) = Just x  -- (1)\nleftmost (Tree x Leaf (Tree _ _ _)) = Just x  -- (2)\nleftmost (Tree x c@(Tree _ _ _) Leaf) = leftmost c  -- (3)\nleftmost (Tree x c@(Tree _ _ _) (Tree _ _ _)) = leftmost c  -- (4)\n</code></pre>\n\n<p>This actually works, but is rather verbose: since the right child is of no importance, why would we consider four cases? We can limit this to two cases:</p>\n\n<pre><code>leftmost :: Tree a -&gt; Maybe a\nleftmost Leaf = Nothing\nleftmost (Tree x Leaf _) = Just x  -- (1+2)\nleftmost (Tree x c@(Tree _ _ _) _) = leftmost c  -- (3+4)\n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 9517321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dc52bd738d15863c94b001d51483099?s=128&d=identicon&r=PG&f=1", "display_name": "Aelin", "link": "https://stackoverflow.com/users/9517321/aelin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 768, "favorite_count": 0, "accepted_answer_id": 49805520, "answer_count": 1, "score": 1, "last_activity_date": 1523565661, "creation_date": 1523564944, "question_id": 49805378, "link": "https://stackoverflow.com/questions/49805378/leftmost-value-in-a-tree-haskell", "title": "Leftmost value in a tree (Haskell)", "body": "<p>How do I find the leftmost value in a tree? Leftmost is the value that is reached by going to the left child of the current Node for as long as possible.</p>\n\n<p>The tree type is defined as:</p>\n\n<pre><code>data Tree a = Leaf | Node a (Tree a) (Tree a) deriving (Show, Eq)\n</code></pre>\n\n<p>I currently have the following:</p>\n\n<pre><code>leftest :: Tree a -&gt; Maybe a\nleftest (Leaf) = Nothing\n</code></pre>\n\n<p>Examples of what <code>leftest</code> should return:</p>\n\n<p>leftest (Node 1 (Node 2 (Node 3 Leaf Leaf) Leaf) Leaf)\n   --> Just 3</p>\n\n<p>leftest (Node 1 (Node 2 Leaf (Node 3 Leaf Leaf)) (Node 4 Leaf Leaf))\n   --> Just 2</p>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523564423, "post_id": 49805219, "comment_id": 86625268, "body": "I am not really sure what you mean with &quot;I applied the <code>&lt;*&gt;</code> that belongs to the built-in list type?&quot;"}, {"owner": {"reputation": 24109, "user_id": 775954, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9f5a87db35489d2958945f35b457f1ee?s=128&d=identicon&r=PG", "display_name": "Matthias Braun", "link": "https://stackoverflow.com/users/775954/matthias-braun"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1523564609, "post_id": 49805219, "comment_id": 86625371, "body": "@WillemVanOnsem: In the line where it says <code>the bug is here</code> the apply method (<code>&lt;*&gt;</code>) of <code>[]</code>&#39;s applicative type class instance is called. With &quot;built-in&quot; I meant the list type from <code>base</code>."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 4, "creation_date": 1523587396, "post_id": 49805219, "comment_id": 86631915, "body": "On a tangential note, <code>pure</code> for <code>ZipList</code> should be <code>repeat</code>, and not <code>(:[])</code> -- to see why, try to verify the applicative laws. (Great question, by the way!)"}], "answers": [{"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 1, "last_activity_date": 1523564887, "creation_date": 1523564887, "answer_id": 49805361, "question_id": 49805219, "link": "https://stackoverflow.com/questions/49805219/prevent-inadvertently-using-different-type-class-instance/49805361#49805361", "title": "Prevent inadvertently using different type class instance", "body": "<p>No, you cannot prevent this in general. You must simply write your instances carefully.</p>\n\n<p>That being said, one quick way to work around this problem would be to redefine your datatype; instead of putting it in terms of lists, make a new list type:</p>\n\n<pre><code>data Ziplist a = Nil | Cons a (Ziplist a)\n-- (Instances etc follow)\n</code></pre>\n\n<p>This avoids the possibility for this kind of error. However, this isn't necessarily the best idea, since this requires function rewrites and so on.</p>\n\n<p>You could just write tests. Which is best. So write tests. <a href=\"https://hspec.github.io/\" rel=\"nofollow noreferrer\">HSpec</a> is the most used test framework as far as I'm aware, so that would be a good place to start.</p>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1523567069, "post_id": 49805742, "comment_id": 86626447, "body": "Ohh, I did not know about <code>COMPLETE</code> ! Very useful, thanks."}], "tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": true, "score": 12, "last_activity_date": 1523588039, "last_edit_date": 1523588039, "creation_date": 1523566641, "answer_id": 49805742, "question_id": 49805219, "link": "https://stackoverflow.com/questions/49805219/prevent-inadvertently-using-different-type-class-instance/49805742#49805742", "title": "Prevent inadvertently using different type class instance", "body": "<p>We can do this:</p>\n\n<pre><code>{-# LANGUAGE PatternSynonyms, ViewPatterns #-}\n-- at very top of file ^\n-- ...\n-- pick whatever names/operators you want\n-- synonym signatures are given in GADT-like syntax\n-- ZCons decomposes a ZipList' a into an a and a ZipList' a\n-- (assuming it succeeds). This is the syntax even for pattern synonyms that\n-- can only be used as patterns\n-- (e.g. pattern Fst :: a -&gt; (a, b); pattern Fst a &lt;- (a, _)).\npattern ZCons :: a -&gt; ZipList' a -&gt; ZipList' a\n-- xs needs to be a ZipList', but it's only a [a], so we uglify this synonym\n-- by using the newtype wrapper as a view\npattern ZCons x xs &lt;- ZipList' (x:(ZipList' -&gt; xs))\n-- views aren't in general invertible, so we cannot make this an automatically\n-- bidirectional synonym (like ZNil is). We can give an explicit version\n  where ZCons x (ZipList' xs) = ZipList' $ x:xs\n-- simple enough that we can use one definition for both pattern and expression\npattern ZNil :: ZipList' a\npattern ZNil = ZipList' []\n{-# COMPLETE ZNil, ZCons #-}\n-- ZNil and ZCons cover all ZipLists\n\ninstance Applicative ZipList' where\n  pure x = ZipList' $ repeat x\n  -- these are bidirectional\n  (ZCons f fs) &lt;*&gt; (ZCons x xs) = ZCons (f x) (fs &lt;*&gt; xs)\n  _ &lt;*&gt; _ = ZNil\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1523567167, "last_edit_date": 1523567167, "creation_date": 1523566781, "answer_id": 49805777, "question_id": 49805219, "link": "https://stackoverflow.com/questions/49805219/prevent-inadvertently-using-different-type-class-instance/49805777#49805777", "title": "Prevent inadvertently using different type class instance", "body": "<p>As a variant of AJFarmar's answer, you can keep your definition of <code>ZipList'</code> exploiting a <code>[a]</code> list inside, and instead declare pattern synonyms to <em>pretend</em> the type was declared as</p>\n\n<pre><code>data ZipList' a = ZipCons a (ZipList' a) | ZipNil\n</code></pre>\n\n<p>In that way, if you limit yourself in using these \"pretend\" constructors when you write your instances, you can not inadvertently involve a list.</p>\n\n<pre><code>{-# LANGUAGE PatternSynonyms, ViewPatterns #-}\n{-# OPTIONS -Wall #-}\nmodule ZipList where\n\nnewtype ZipList' a = ZipList' { unZipList' :: [a] }\n                   deriving (Eq, Show)\n</code></pre>\n\n<p>Here are the pattern synonyms. We need to be a bit careful here since we need to convert lists to zip-lists as needed.</p>\n\n<pre><code>pattern ZipCons :: a -&gt; ZipList' a -&gt; ZipList' a\npattern ZipCons x xs &lt;- ZipList' (x : (ZipList' -&gt; xs))\n  where ZipCons x xs = ZipList' (x : unZipList' xs)\n\npattern ZipNil :: ZipList' a\npattern ZipNil = ZipList' []\n</code></pre>\n\n<p>We can leave the functor instance as it was, exploiting the <code>Functor []</code> instance. Here, we do want to call the list <code>fmap</code>. Otherwise, we could use the \"pretend\" constructors, but we'd have to re-implement it.</p>\n\n<pre><code>instance Functor ZipList' where\n  fmap f (ZipList' xs) = ZipList' $ fmap f xs\n</code></pre>\n\n<p>Finally, the applicative instance can use only the pretend constructors.</p>\n\n<pre><code>instance Applicative ZipList' where\n  pure x = ZipCons x ZipNil\n\n  ZipCons f fs &lt;*&gt; ZipCons x xs = ZipCons (f x) (fs &lt;*&gt; xs)\n  _            &lt;*&gt; _            = ZipNil\n</code></pre>\n\n<p>To me a major downside of using the pattern synonyms is that the exhaustiveness checker gets easily confused, triggering spurious warnings. Above, if we replace the <code>_ &lt;*&gt; _</code> case with the two obvious cases involving <code>ZipNil</code>, we trigger a warning.</p>\n\n<p>(Update: HTNV used a <code>COMPLETE</code> pragma to silence the warning, which looks very nice! I did not know about that.)</p>\n\n<p>Apart from that, pattern synonyms allow to offer a quite elegant interface. I wish they were used more often in the Haskell ecosystem.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1523760778, "creation_date": 1523760778, "answer_id": 49838055, "question_id": 49805219, "link": "https://stackoverflow.com/questions/49805219/prevent-inadvertently-using-different-type-class-instance/49838055#49838055", "title": "Prevent inadvertently using different type class instance", "body": "<p>This isn't really a general answer, but in this particular case I think by far the best and easiest thing is to just use <code>zipWith</code>, which is what the <code>base</code> library does.</p>\n\n<pre><code>instance Applicative ZipList where\n  pure x = ZipList (repeat x)\n  ZipList fs &lt;*&gt; ZipList xs = ZipList (zipWith ($) fs xs)\n</code></pre>\n"}], "owner": {"reputation": 24109, "user_id": 775954, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9f5a87db35489d2958945f35b457f1ee?s=128&d=identicon&r=PG", "display_name": "Matthias Braun", "link": "https://stackoverflow.com/users/775954/matthias-braun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 3, "accepted_answer_id": 49805742, "answer_count": 4, "score": 7, "last_activity_date": 1523760778, "creation_date": 1523564276, "last_edit_date": 1523741707, "question_id": 49805219, "link": "https://stackoverflow.com/questions/49805219/prevent-inadvertently-using-different-type-class-instance", "title": "Prevent inadvertently using different type class instance", "body": "<p>I expect the following behavior from the applicative instance of my <code>ZipList'</code>:</p>\n\n<pre><code>zipListApplyTest = fs &lt;*&gt; xs\n  where fs = ZipList' [negate, id]\n        xs = ZipList' [1..5]\n\n-- Result: ZipList' [-1,2]\n</code></pre>\n\n<p>This was my first attempt:</p>\n\n<pre><code>newtype ZipList' a = ZipList' [a]\n                   deriving (Eq, Show)\n\ninstance Functor ZipList' where\n  fmap f (ZipList' xs) = ZipList' $ fmap f xs\n\ninstance Applicative ZipList' where\n  pure x = ZipList' [x]\n\n  ZipList' (f:fs) &lt;*&gt; ZipList' (x:xs) =\n     ZipList' $ f x : (fs &lt;*&gt; xs) -- &lt;-- the bug is here\n  ZipList' [] &lt;*&gt; _ = ZipList' []\n  _ &lt;*&gt; ZipList' []  = ZipList' []\n\n-- Unexpected result: ZipList' [-1,2,3,4,5]\n</code></pre>\n\n<p>After some head scratching, I realized that inside the applicative instance of <code>ZipList'</code> I accidentally used the wrong <code>&lt;*&gt;</code>:</p>\n\n<p>In the line marked with <code>the bug is here</code>, I applied the <code>&lt;*&gt;</code> that belongs to the built-in list type <code>[]</code> instead of applying <code>&lt;*&gt;</code> of <code>ZipList'</code> recursively.</p>\n\n<p>This is why the second function <code>id</code> was applied to the entire rest of the list, instead of only the second element, <code>2</code>.</p>\n\n<p>This yielded the expected result:</p>\n\n<pre><code>ZipList' fs &lt;*&gt; ZipList' xs = ZipList' $ zipApply fs xs\n  where zipApply :: [(a -&gt; b)] -&gt; [a] -&gt; [b]\n        zipApply (f:fs) (x:xs) = f x : zipApply fs xs\n        zipApply _ _           = []\n</code></pre>\n\n<p>Is there a compiler flag, language idiom, or other technique that would have prevented this bug or would have made it easier to spot?</p>\n\n<p>I'm on GHC 8.2.2.</p>\n"}, {"tags": ["haskell", "gtk", "gtk3", "glade"], "comments": [{"owner": {"reputation": 1896, "user_id": 4226702, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-siukF5ObSUs/AAAAAAAAAAI/AAAAAAAAAEc/Qww5nEqBNDw/photo.jpg?sz=128", "display_name": "Alexander Dmitriev", "link": "https://stackoverflow.com/users/4226702/alexander-dmitriev"}, "edited": false, "score": 0, "creation_date": 1523613504, "post_id": 49803911, "comment_id": 86642699, "body": "I&#39;d recommend you ask at superuser or askubuntu"}, {"owner": {"reputation": 428, "user_id": 1520657, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/599f6ac58a187b4e89ad8cb576304166?s=128&d=identicon&r=PG", "display_name": "MichaelO", "link": "https://stackoverflow.com/users/1520657/michaelo"}, "edited": false, "score": 0, "creation_date": 1523959683, "post_id": 49803911, "comment_id": 86766021, "body": "Did you use the gtk3 Haskell package? The gtk Haskell package is only Gtk2 and will therefore not link or use the Gtk 3 libraries. Also there are 2 versions of Glade (one for Gtk 2, one for Gtk 3), so these all must match up."}], "owner": {"reputation": 106, "user_id": 7523525, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-0ug8Z7LF19A/AAAAAAAAAAI/AAAAAAAABmg/37kPxvZ2aJM/photo.jpg?sz=128", "display_name": "Ahmed Mohamedeen", "link": "https://stackoverflow.com/users/7523525/ahmed-mohamedeen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 137, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1523558992, "creation_date": 1523558992, "question_id": 49803911, "link": "https://stackoverflow.com/questions/49803911/haskell-with-glade-gtk-requiredversion-3-20", "title": "Haskell with glade gtk+ requiredversion 3.20", "body": "<p>I installed glade from ubuntu software on 17.04, gtk and all dependency packages and I found out that the installed version of gtk+ (2.24) isn't compatible with glade Gtkbuilder format but gtk+ (3.20)+  is.\nso I installed it manually from the .tar-gz file and it finished with no errors and when i run </p>\n\n<pre><code>dpkg -l libgtk* | grep -e '^i' | grep -e 'libgtk-*[0-9]'\n</code></pre>\n\n<p>it shows </p>\n\n<pre><code>ii  libgtk-3-0:amd64             3.22.25-0ubuntu0.1 amd64        GTK+ \ngraphical user interface library\nii  libgtk-3-bin                 3.22.25-0ubuntu0.1 amd64        \nprograms for the GTK+ graphical user interface library\nii  libgtk-3-common              3.22.25-0ubuntu0.1 all          \ncommon files for the GTK+ graphical user interface library\nii  libgtk-3-dev:amd64           3.22.25-0ubuntu0.1 amd64        \ndevelopment files for the GTK+ library\nii  libgtk-3-doc                 3.22.25-0ubuntu0.1 all          \ndocumentation for the GTK+ graphical user interface library\nii  libgtk2-perl                 2:1.24992-1build1  amd64        Perl \ninterface to the 2.x series of the Gimp Toolkit library\nii  libgtk2.0-0:amd64            2.24.31-2ubuntu1   amd64        GTK+ \ngraphical user interface library\nii  libgtk2.0-bin                2.24.31-2ubuntu1   amd64        \nprograms for the GTK+ graphical user interface library\nii  libgtk2.0-common             2.24.31-2ubuntu1   all          \ncommon files for the GTK+ graphical user interface library\nii  libgtk2.0-dev                2.24.31-2ubuntu1   amd64        \ndevelopment files for the GTK+ library\n</code></pre>\n\n<p>which i guess means that I've 3.20+ installed (although I installed 3.20.10 idk why it shows 3.22.25) when i compile and run any .hs file using gtkBuilder glade format  ( ./test ) it says</p>\n\n<pre><code>test: test.glade: required gtk+ version 3.20, current version is 2.24\n</code></pre>\n\n<p>Is there any reason that glade isn't reading my install of 3.20.10 ? or any way to uninstall 2.24 </p>\n"}, {"tags": ["haskell", "encode"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523552482, "post_id": 49802212, "comment_id": 86618990, "body": "Is it possible to show the sample input that returns <code>Just 0</code> where it should return <code>Nothing</code>?"}, {"owner": {"reputation": 37, "user_id": 9637493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S4fHb.jpg?s=128&g=1", "display_name": "CB17", "link": "https://stackoverflow.com/users/9637493/cb17"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523552543, "post_id": 49802212, "comment_id": 86619021, "body": "encode 99 18 108 45 returns Just 0, encode 37 17 23 48 returns Nothing"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523552736, "post_id": 49802212, "comment_id": 86619116, "body": "I would guess this has to do with the power. You can not calculate powers modulo a number with <code>Int</code>, those numbers are too large, and will result in overflow."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 3, "creation_date": 1523552754, "post_id": 49802212, "comment_id": 86619121, "body": "Unrelated to the problem you&#39;re having, what&#39;s the type of <code>(== True)</code>? How would you characterize the way it transforms its input? Why do you think I&#39;m asking those questions?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1523552966, "post_id": 49802212, "comment_id": 86619243, "body": "Consider changing all <code>Int</code> values to <code>Integer</code>."}, {"owner": {"reputation": 37, "user_id": 9637493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S4fHb.jpg?s=128&g=1", "display_name": "CB17", "link": "https://stackoverflow.com/users/9637493/cb17"}, "edited": false, "score": 0, "creation_date": 1523553141, "post_id": 49802212, "comment_id": 86619349, "body": "Only problem is that I&#39;m not allowed to changed the signature for encode and I&#39;m not allowed to import anything"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1523553363, "post_id": 49802212, "comment_id": 86619461, "body": "@ThomasM.DuBuisson: this will result in a huge memory (and CPU) burden."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1523555832, "post_id": 49802212, "comment_id": 86620704, "body": "There are smart expmod implementations that could fix the issue."}], "answers": [{"comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 37, "user_id": 9637493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S4fHb.jpg?s=128&g=1", "display_name": "CB17", "link": "https://stackoverflow.com/users/9637493/cb17"}, "edited": false, "score": 0, "creation_date": 1523554988, "post_id": 49802476, "comment_id": 86620272, "body": "@C.Brandani: well you can check it here <a href=\"https://www.cs.drexel.edu/~jpopyack/IntroCS/HW/RSAWorksheet.html\" rel=\"nofollow noreferrer\">cs.drexel.edu/~jpopyack/IntroCS/HW/RSAWorksheet.html</a> (<code>p=99</code>, <code>q=18</code>, <code>m=108</code>, <code>e=45</code>, <code>d=1629</code>)."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1523569499, "post_id": 49802476, "comment_id": 86627494, "body": "Be aware, though, that for large inputs, <code>*</code> itself is susceptible to overflow. You either need to be very careful, or just lift the arguments to <code>Integer</code> until you get the final answer and convert that to an <code>Int</code> to return."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1523569713, "last_edit_date": 1523569713, "creation_date": 1523553333, "answer_id": 49802476, "question_id": 49802212, "link": "https://stackoverflow.com/questions/49802212/stumped-on-just-0-return/49802476#49802476", "title": "Stumped on Just 0 return", "body": "<p>Your problem is that you raise numbers to a <em>large</em> power, which results in <em>very</em> large numbers, and <code>Int</code> usually contains up to 64-bit numbers. As a result, we get overflow, and the CPU will perform a wrap around.</p>\n\n<p>It is usually <em>not</em> a good idea to calcuate <em>a<sup>b</sup></em> mod <em>c</em> by calculating the formula directly. We can use a more clever approach here: since <em>(a&times;b)</em> mod <em>c == ((a</em> mod <em>c) &times; (b</em> mod <em>c))</em> mod <em>c</em>, we can exploit this property by calculating the power in such way that we require a minimal amount of memory:</p>\n\n<pre><code>powmod :: Int -&gt; Int -&gt; Int -&gt; Int\npowmod _ 0 _ = 1\npowmod a b c | even b = ab2\n             | otherwise = mod (a * ab2) c\n    where ab2 = powmod (mod (a * a) c) (div b 2) c\n</code></pre>\n\n<p>So here we calculate in <em>O(log b)</em> (with <em>b</em> the <em>value</em> the power) <em>a<sup>b</sup></em> mod <em>c</em>, where <em>a<sup>b</sup></em> itself can be very large by performing modulo operations at all recursion levels. We here make the assumption that <code>c</code> is smaller than the square root of the maximum value of <code>Int</code>. Since an <code>Int</code> at least has a minimum upper bound of <em>2<sup>29</sup>-1</em>, this means that it works as long as c &le; 23'170. In case you need a function that works with higher values, then you better use <code>Int64</code> (max value for <code>c</code> is 3'037'000'499) or <code>Integer</code> (arbitrary maximum value).</p>\n\n<p>Now we can use this function for the <code>encrypt</code> function:</p>\n\n<pre><code>encrypt :: Int -&gt; Int -&gt; Int -&gt; Int\nencrypt p q m e = powmod m e (p * q)\n</code></pre>\n\n<p>Your <code>encode</code> function can however be improved. You use <code>== True</code>, which is unnecessary, since <code>True == True</code> is <code>True</code>, and <code>False == True</code> is <code>False</code>.</p>\n\n<pre><code>encode :: Int -&gt; Int -&gt; Int -&gt; Int -&gt; Maybe Int\nencode p q m e | coPrime (phi p q) e = Just (encrypt p q m e)\n               |otherwise = Nothing\n</code></pre>\n\n<p>Now we get:</p>\n\n<pre><code>Prelude&gt; encode 99 18 108 45\nJust 1134\nPrelude&gt; encode 37 17 23 48\nNothing\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 9637493, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S4fHb.jpg?s=128&g=1", "display_name": "CB17", "link": "https://stackoverflow.com/users/9637493/cb17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 49802476, "answer_count": 1, "score": 3, "last_activity_date": 1523630248, "creation_date": 1523552369, "last_edit_date": 1523630248, "question_id": 49802212, "link": "https://stackoverflow.com/questions/49802212/stumped-on-just-0-return", "title": "Stumped on Just 0 return", "body": "<p>Ok, slight edit as the example <code>encode 99 18 108 45 = Nothing</code> was actually correct and apparently I can't read questions properly, as 99 and 18 aren't prime, so I added a check funct into the code:</p>\n\n<pre><code>coprime :: Int -&gt; Int -&gt; Bool\ncoprime a b = gcd a b == 1\n\ncheck :: Int -&gt; Int -&gt; Bool\ncheck p q = (isPrime p) &amp;&amp; (isPrime q)\n\nphi :: Int -&gt; Int -&gt; Int\nphi p q = (p - 1) * (q - 1)\n\nencrypt :: Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int\nencrypt p q m e = powmod m e (p * q)\n\nencode :: Int -&gt; Int -&gt; Int -&gt; Int -&gt; Maybe Int\nencode p q m e |check p q &amp;&amp; coprime (phi p q) e = Just (encrypt p q m e)\n           |otherwise = Nothing\n</code></pre>\n\n<p>This time around my problem seems to be <code>encode 53 73 151 90 = Just 133</code> \nbut the example says it should return <code>Just 3869</code> rather than <code>Just 133</code>. </p>\n\n<p>So my question to you guys is: am I just being an idiot and not seeing the fault right in front of me or is my working ok?</p>\n\n<p>I'll put <code>isPrime</code> code up if you want as well, however it just checks whether a no. is prime or not by returning true or false.</p>\n"}, {"tags": ["string", "haskell", "tuples"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523551636, "post_id": 49801940, "comment_id": 86618543, "body": "What if the number is less than zero, or greater than nine?"}, {"owner": {"reputation": 649, "user_id": 2998746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fc15b842026d8a039ffdd1b2a528aec?s=128&d=identicon&r=PG&f=1", "display_name": "Euge", "link": "https://stackoverflow.com/users/2998746/euge"}, "edited": false, "score": 0, "creation_date": 1523551730, "post_id": 49801940, "comment_id": 86618596, "body": "You can use <code>show</code> to convert an Int to a String (any showable type, actually)"}, {"owner": {"reputation": 473, "user_id": 6515530, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/HmvF7.jpg?s=128&g=1", "display_name": "Data", "link": "https://stackoverflow.com/users/6515530/data"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523551753, "post_id": 49801940, "comment_id": 86618611, "body": "@WillemVanOnsem Assume the number is on the closed interval of 0 to 9."}, {"owner": {"reputation": 473, "user_id": 6515530, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/HmvF7.jpg?s=128&g=1", "display_name": "Data", "link": "https://stackoverflow.com/users/6515530/data"}, "reply_to_user": {"reputation": 649, "user_id": 2998746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fc15b842026d8a039ffdd1b2a528aec?s=128&d=identicon&r=PG&f=1", "display_name": "Euge", "link": "https://stackoverflow.com/users/2998746/euge"}, "edited": false, "score": 0, "creation_date": 1523552216, "post_id": 49801940, "comment_id": 86618864, "body": "@Euge using <code>show(snd x)</code> did the trick"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1523557111, "last_edit_date": 1523557111, "creation_date": 1523551934, "answer_id": 49802098, "question_id": 49801940, "link": "https://stackoverflow.com/questions/49801940/converting-a-list-of-tuples-with-type-char-int-to-a-string-in-haskell/49802098#49802098", "title": "Converting a list of tuples with type (Char, Int) to a String in Haskell", "body": "<p>We can use the <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Char.html#v:intToDigit\" rel=\"nofollow noreferrer\"><strong><code>intToDigit :: Int -&gt; Char</code></strong></a> function from <code>Data.Char</code> for that. Furthermore it is more elegant to use pattern matching in the tuple instead of using <code>fst</code> and <code>snd</code>. So we can rewrite it to:</p>\n\n<pre><code>import Data.Char(intToDigit)\n\ntupToStr :: [(Char, Int)] -&gt; String\ntupToStr [] = []\ntupToStr ((c, n):xs) = c : intToDigit n : tupToStr xs\n</code></pre>\n\n<p>Note that this will only work given <code>n</code> is <em>always</em> in the range <code>0..15</code> (<code>intToDigit</code> will use <code>'a'..'f'</code> for values greater than nine). In case you want to process values outside the range, you can use <code>show</code>, but this will of course return a <code>String</code>. With the above code, we get:</p>\n\n<pre><code>Prelude Data.Char&gt; tupToStr [('j',9),('x',1),('f',3)]\n\"j9x1f3\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1523556092, "post_id": 49802210, "comment_id": 86620853, "body": "In that case, it would be more efficient to use <code>a : show b ++ tupToStr xs</code>."}], "tags": [], "owner": {"reputation": 473, "user_id": 6515530, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/HmvF7.jpg?s=128&g=1", "display_name": "Data", "link": "https://stackoverflow.com/users/6515530/data"}, "is_accepted": false, "score": 1, "last_activity_date": 1523557143, "last_edit_date": 1523557143, "creation_date": 1523552365, "answer_id": 49802210, "question_id": 49801940, "link": "https://stackoverflow.com/questions/49801940/converting-a-list-of-tuples-with-type-char-int-to-a-string-in-haskell/49802210#49802210", "title": "Converting a list of tuples with type (Char, Int) to a String in Haskell", "body": "<p>Change the bottom line to:</p>\n\n<pre><code>tupToStr ((a,b):xs) = a : show b ++ tupToStr xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 4, "last_activity_date": 1523557934, "creation_date": 1523557934, "answer_id": 49803671, "question_id": 49801940, "link": "https://stackoverflow.com/questions/49801940/converting-a-list-of-tuples-with-type-char-int-to-a-string-in-haskell/49803671#49803671", "title": "Converting a list of tuples with type (Char, Int) to a String in Haskell", "body": "<pre><code>tupToStr = concatMap (\\(c,i) -&gt; c:show i)\n</code></pre>\n"}], "owner": {"reputation": 473, "user_id": 6515530, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/HmvF7.jpg?s=128&g=1", "display_name": "Data", "link": "https://stackoverflow.com/users/6515530/data"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 947, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1523557934, "creation_date": 1523551487, "last_edit_date": 1523551650, "question_id": 49801940, "link": "https://stackoverflow.com/questions/49801940/converting-a-list-of-tuples-with-type-char-int-to-a-string-in-haskell", "title": "Converting a list of tuples with type (Char, Int) to a String in Haskell", "body": "<p>I'm trying to take a list of tuples, with type <code>[(Char, Int)]</code> and convert it to a string.\nFor example:</p>\n\n<pre><code>tupToStr [('j',9),('x',1),('f',3)]\n\"j9x1f3\"\n</code></pre>\n\n<p>My attempt is below. My problem is the cons operator requires all values to have the same type. So I can't do <code>'j' : 9 : []</code> for example. Therefore you'll see a placeholder function, <code>intToChar</code>, which would ideally convert an <code>Int</code> to a <code>Char</code>. Is there a simple way of doing this conversion, that fits concisely into my existing function? If not, how would you write a function to do the conversion in question?</p>\n\n<pre><code>tupToStr :: [(Char, Int)] -&gt; String\ntupToStr []     = []\ntupToStr (x:xs) = (fst x) : intToChar(snd x) : tupToStr xs \n</code></pre>\n"}, {"tags": ["haskell", "ghc", "ffi", "ghci", "haskell-stack"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1523535271, "post_id": 49796017, "comment_id": 86606755, "body": "Could you post the code that&#39;s causing this problem? I think that would also be helpful."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1523535626, "post_id": 49796017, "comment_id": 86606995, "body": "@AJFarmar I don&#39;t know how to minimize. There are 1000 lines of C code. Maybe the only thing I could do is to summarize the structure of the program ?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1523535983, "post_id": 49796017, "comment_id": 86607284, "body": "I see, this makes finding a specific issue very hard. I&#39;m not sure the general structure would help."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 3, "creation_date": 1523537815, "post_id": 49796017, "comment_id": 86608732, "body": "Try making a &quot;Hello World&quot; type of program using FFI, and see if it works. We don&#39;t need a 1000 line program if the issue is in the compilation process and not the code."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1523538036, "post_id": 49796017, "comment_id": 86608892, "body": "@4castle Ok, I&#39;ll try that. Thanks."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1523540213, "post_id": 49796017, "comment_id": 86610618, "body": "@4castle Done. The helloworld works."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1523540476, "post_id": 49796017, "comment_id": 86610828, "body": "I will try to complicate the helloworld now. My real program passes pointers through the FFI. I will include pointers."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1523541603, "post_id": 49796017, "comment_id": 86611691, "body": "It works too :-("}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1523542685, "post_id": 49796017, "comment_id": 86612405, "body": "@4castle The helloworld works but I have included it in my post nevertheless."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1523544106, "post_id": 49796017, "comment_id": 86613596, "body": "It&#39;s become clear that the problem is not with how you&#39;re compiling your program, but rather with how you&#39;re using the FFI (or perhaps something entirely different in your C or Haskell code). It&#39;s not likely to be possible to answer this without seeing code. You might want to try <code>printf</code>/<code>trace</code> debugging, GDB, etc."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1523548835, "post_id": 49796017, "comment_id": 86616946, "body": "It looks as if you are causing <i>undefined behavior</i> on the C side, e.g. by using some pointer to access unallocated (or freed) memory. In C land, UB does not mean &quot;crash for sure&quot;. The program may or may not crash depending on how much memory is allocated, or where it is allocated, etc. It might be the case that under GHCi the allocation is done in a way that case the program to incidentally work, while under GHC that does not happen. This a common &quot;C pointer hell&quot; problem, since it usually very hard to understand what went wrong and where :-("}, {"owner": {"reputation": 649, "user_id": 2998746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fc15b842026d8a039ffdd1b2a528aec?s=128&d=identicon&r=PG&f=1", "display_name": "Euge", "link": "https://stackoverflow.com/users/2998746/euge"}, "edited": false, "score": 0, "creation_date": 1523550136, "post_id": 49796017, "comment_id": 86617700, "body": "What happened when debugging in gdb?"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 649, "user_id": 2998746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fc15b842026d8a039ffdd1b2a528aec?s=128&d=identicon&r=PG&f=1", "display_name": "Euge", "link": "https://stackoverflow.com/users/2998746/euge"}, "edited": false, "score": 0, "creation_date": 1523550542, "post_id": 49796017, "comment_id": 86617899, "body": "@Euge I get a series of pointer adresses <code>0x000...</code>, I don&#39;t know what to do with that."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1523550841, "post_id": 49796017, "comment_id": 86618059, "body": "@chi Thanks for you comment. I have a C function which generates a pointer and an integer which represents the &quot;length&quot; of the pointer (sorry for the wording if it is unappropriate). The integer is obtained by passing <code>&amp;i</code> to the function, and the function calculates <code>*i</code>. And then, when I run the executable, I get the pointer adress <code>0x00000000000000000</code> and a huge integer (whereas the good integer should be <code>168</code> for this example)."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1523551195, "post_id": 49796017, "comment_id": 86618262, "body": "@chi Also when I run an example in C only (without Haskell), this works fine. And when I run <code>stack ghci</code> (not <code>stack exec ghci</code>), that doesn&#39;t work."}, {"owner": {"reputation": 649, "user_id": 2998746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fc15b842026d8a039ffdd1b2a528aec?s=128&d=identicon&r=PG&f=1", "display_name": "Euge", "link": "https://stackoverflow.com/users/2998746/euge"}, "edited": false, "score": 0, "creation_date": 1523551215, "post_id": 49796017, "comment_id": 86618273, "body": "Are you using malloc to get <code>i</code>? And malloc returns <code>0x00</code>? Can you post that piece of code?"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 649, "user_id": 2998746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fc15b842026d8a039ffdd1b2a528aec?s=128&d=identicon&r=PG&f=1", "display_name": "Euge", "link": "https://stackoverflow.com/users/2998746/euge"}, "edited": false, "score": 0, "creation_date": 1523551513, "post_id": 49796017, "comment_id": 86618473, "body": "@Euge No, this is not the pointer to <code>i</code>. I type <code>int i;</code> then I run a function <code>f(...., &amp;i)</code>. There&#39;s no <code>malloc</code> for <code>i</code>. The pointer is the output of <code>f</code>. My code is <a href=\"https://github.com/stla/opengl-implicit3\" rel=\"nofollow noreferrer\">on github</a> if you want to take a look. The function which causes a problem (<code>f</code>) is <code>computeContour3d</code> in <code>C&#47;marchingcubes.c</code>."}, {"owner": {"reputation": 649, "user_id": 2998746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fc15b842026d8a039ffdd1b2a528aec?s=128&d=identicon&r=PG&f=1", "display_name": "Euge", "link": "https://stackoverflow.com/users/2998746/euge"}, "edited": false, "score": 0, "creation_date": 1523552073, "post_id": 49796017, "comment_id": 86618799, "body": "Ok, I see no error in that piece of code. I would try to call <code>malloc</code> for <code>i</code> (<code>ntriangles</code>) to see what happens, but it should work as it is anyway..."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 649, "user_id": 2998746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fc15b842026d8a039ffdd1b2a528aec?s=128&d=identicon&r=PG&f=1", "display_name": "Euge", "link": "https://stackoverflow.com/users/2998746/euge"}, "edited": false, "score": 1, "creation_date": 1523555723, "post_id": 49796017, "comment_id": 86620663, "body": "@Euge I have half-solved the problem. The code in <code>C&#47;marchingcubes.c</code> does not correctly read the entries of the arrays defined in <code>C&#47;tables.c</code>. So I&#39;ve moved these arrays in <code>C&#47;marchingcubes.c</code>, it&#39;s better but there&#39;s still one issue."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 649, "user_id": 2998746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fc15b842026d8a039ffdd1b2a528aec?s=128&d=identicon&r=PG&f=1", "display_name": "Euge", "link": "https://stackoverflow.com/users/2998746/euge"}, "edited": false, "score": 0, "creation_date": 1523561013, "post_id": 49796017, "comment_id": 86623412, "body": "@Euge it works !!!!!!!!"}, {"owner": {"reputation": 649, "user_id": 2998746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fc15b842026d8a039ffdd1b2a528aec?s=128&d=identicon&r=PG&f=1", "display_name": "Euge", "link": "https://stackoverflow.com/users/2998746/euge"}, "edited": false, "score": 0, "creation_date": 1523562376, "post_id": 49796017, "comment_id": 86624134, "body": "@St&#233;phaneLaurent I&#39;m glad :) You can post the answer if it&#39;s clear enough and you consider it might be helpful for others"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 649, "user_id": 2998746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fc15b842026d8a039ffdd1b2a528aec?s=128&d=identicon&r=PG&f=1", "display_name": "Euge", "link": "https://stackoverflow.com/users/2998746/euge"}, "edited": false, "score": 0, "creation_date": 1523564531, "post_id": 49796017, "comment_id": 86625331, "body": "@Euge I will try to do a minimal example. I&#39;ll post an answer if it reproduces the issue. But not today, it&#39;s late."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 649, "user_id": 2998746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fc15b842026d8a039ffdd1b2a528aec?s=128&d=identicon&r=PG&f=1", "display_name": "Euge", "link": "https://stackoverflow.com/users/2998746/euge"}, "edited": false, "score": 0, "creation_date": 1523652180, "post_id": 49796017, "comment_id": 86665525, "body": "@Euge Problem reproduced with a minimal example. Please take a look at my answer."}], "answers": [{"comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1523653629, "post_id": 49824846, "comment_id": 86666108, "body": "What happens if you replace <code>int array[2][3];</code> in your header file with <code>extern int array[2][3];</code>? I suspect GHC/Stack may be linking/compiling stuff in such an order that the <code>int array[2][3];</code> in the header (which is a tentative definition) ends up being considered as the definition (and not the declaration) of <code>array</code>."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1523654071, "post_id": 49824846, "comment_id": 86666260, "body": "@Alec You are right!! It works if I do that. Thanks!"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1523709603, "post_id": 49824846, "comment_id": 86678231, "body": "@Alec Do you want to write this as an answer ? Otherwise I could include this in my post (giving the credit to you of course)."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1523722634, "post_id": 49824846, "comment_id": 86682291, "body": "Haha, just include it in your post - the problem is the tentative definition of <code>array</code>. That only makes sense based on the stuff you just posted, so it is probably simpler to update your answer. Glad to have helped."}], "tags": [], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "is_accepted": true, "score": 3, "last_activity_date": 1523724537, "last_edit_date": 1523724537, "creation_date": 1523652117, "answer_id": 49824846, "question_id": 49796017, "link": "https://stackoverflow.com/questions/49796017/is-there-a-needed-ghc-option-for-an-executable-using-the-ffi/49824846#49824846", "title": "Is there a needed GHC option for an executable using the FFI?", "body": "<p>Well, this is not really an answer to the question but I have painfully solved the issue and I think it might be helpful for others. It is worth to share. So I post a minimal example showing the problem. A very minimal example.</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>helloffi/\n\u251c\u2500\u2500 C\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 array.c\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 helloffi.c\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 helloffi.h\n\u251c\u2500\u2500 helloffi.cabal\n\u251c\u2500\u2500 Setup.hs\n\u251c\u2500\u2500 src\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 Lib.hs\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 Main.hs\n\u2514\u2500\u2500 stack.yaml\n</code></pre>\n\n<p><em>array.c</em>: define an array in a C file, for example:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int array[2][3] =  \n    {{1, 24, 1},\n     {2, 19, 1}};\n</code></pre>\n\n<p><em>helloffi.c</em>: define a function that uses this array, for example:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#include \"helloffi.h\"\n\nint getCoef(unsigned i, unsigned j){\n    return array[i][j];\n}\n</code></pre>\n\n<p><em>helloffi.h</em>, the header file: </p>\n\n<pre class=\"lang-c prettyprint-override\"><code>int array[2][3];\nint getCoef(unsigned, unsigned);\n</code></pre>\n\n<p>That's all for the C part. Now the Haskell part. Make a library module importing the C function.</p>\n\n<p><em>Lib.hs</em>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE ForeignFunctionInterface #-}\nmodule Lib\n  where\nimport           Foreign.C.Types       \n\nforeign import ccall \"getCoef\" c_getCoef\n    :: CUInt -&gt; CUInt -&gt; IO CInt\n</code></pre>\n\n<p><em>Main.hs</em>, to be compiled to an executable:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>module Main\n  where\nimport           Lib\n\nmain :: IO ()\nmain = do\n    x &lt;- c_getCoef 0 1\n    print x\n</code></pre>\n\n<p>That's all. And now, the mystery. Compile the library (to get the module <code>Lib</code> and the executable generated from <code>Main.hs</code>, let's say this one is called <code>test</code>).</p>\n\n<p><code>stack exec ghci</code>, gives the correct result (<code>24</code>):</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Prelude&gt; :l src/Main.hs \n[1 of 1] Compiling Main             ( src/Main.hs, interpreted )\nOk, one module loaded.\n*Main&gt; main\n24\n</code></pre>\n\n<p><em>run the executable</em>, gives a wrong result (always <code>0</code>):</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>$ .stack-work/install/x86_64-linux/lts-11.4/8.2.2/bin/test \n0\n</code></pre>\n\n<p>The <code>test</code> executable is the compiled <code>Main.hs</code>. However it does not correctly read the entries of the array in <code>array.c</code>, while <code>:l src/Main.hs</code> after <code>stack exec ghci</code> gives the correct result.</p>\n\n<p>Isn't it weird ? Does anyone has an explanation ?</p>\n\n<h1>Solution</h1>\n\n<p>I don't know yet why the behavior differs between <code>stack exec ghci</code> and the executable but now one has a solution thanks to @Alec's comments below: it suffices to replace <code>int array[2][3]</code> in the header file with <code>extern int array[2][3]</code>. It looks like the executable considers <code>int array[2][3]</code> as the definition of <code>array</code>, whose entries are initialized to <code>0</code>, while <code>stack exec ghci</code> considers it as the declaration of <code>array</code>.</p>\n"}], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "accepted_answer_id": 49824846, "answer_count": 1, "score": 2, "last_activity_date": 1523724537, "creation_date": 1523534509, "last_edit_date": 1523652910, "question_id": 49796017, "link": "https://stackoverflow.com/questions/49796017/is-there-a-needed-ghc-option-for-an-executable-using-the-ffi", "title": "Is there a needed GHC option for an executable using the FFI?", "body": "<p>I have a module <code>Main</code> in <code>Main.hs</code>. The program uses the FFI (in particular, <code>FunPtr</code>). </p>\n\n<p>When I run <code>stack exec ghci</code> and I load the module (<code>:l src/Main.hs</code>), it works perfectly.</p>\n\n<p>However when I compile the module to an executable and I run the executable, I get a crash, namely a segmentation fault. </p>\n\n<p>Therefore I'm wondering whether I need to compile with a certain option. Is there a specific option to use when dealing with the FFI ? I tried <code>-O0</code>, <code>-fllvm</code>, no way. Maybe <code>stack exec ghci</code> includes an option that could be used with GHC ?</p>\n\n<p>Also, is there a debug option that one can set to GHC in order to run the executable with <code>gdb</code> ? I tried the <code>-g</code> option but <code>gdb</code> does not find debugging symbols. <strong>EDIT</strong> This point is solved: <code>gdb</code> finds debugging symbols when I compile with <code>stack exec -- ghc -g -rtsopts src/Main.hs</code>.</p>\n\n<p>I'm on Linux Ubuntu and I'm using GHC 8.2.2.</p>\n\n<h1>EDIT</h1>\n\n<p>Here is a minimal program that reflects the structure of my real program. This one works fine (in GHCI or as an executable), but I include it nevertheless.</p>\n\n<p><em>helloffi.c</em>:</p>\n\n<pre><code>#include &lt;stdlib.h&gt;\n\ndouble** evalf(double (*f)(double), double x){\n    double** out = malloc(2 * sizeof(double*));\n    for(unsigned i=0; i&lt;2; i++){\n        out[i] = malloc(2 * sizeof(double));\n        out[i][0] = (*f)(x);\n        out[i][1] = (*f)(x+1);\n    }\n    return out;\n}\n\ndouble sumpointer(double** pptr){\n    double x=0;\n    for(unsigned i=0; i&lt;2; i++){\n        for(unsigned j=0; j&lt;2; j++){\n            x += pptr[i][j];\n        }\n    }\n    return x;\n}\n</code></pre>\n\n<p><em>main module of the library, Lib.hs</em> </p>\n\n<pre><code>{-# LANGUAGE ForeignFunctionInterface #-}\nmodule Lib\n  where\nimport           Foreign.C.Types       \nimport           Foreign.Ptr           (Ptr, FunPtr, freeHaskellFunPtr)\n\ntype CFunction = CDouble -&gt; IO CDouble\n\nforeign import ccall \"wrapper\" functionPtr \n    :: CFunction -&gt; IO (FunPtr CFunction)\n\nforeign import ccall \"evalf\" c_evalf\n    :: FunPtr CFunction\n    -&gt; CDouble\n    -&gt; IO (Ptr (Ptr CDouble))\n\nfun2cfun :: (Double -&gt; Double) -&gt; CFunction\nfun2cfun f x = \n    return $ realToFrac (f (realToFrac x))\n\nevalFun :: (Double -&gt; Double) -&gt; Double -&gt; IO (Ptr (Ptr CDouble))\nevalFun f x = do\n    fPtr &lt;- functionPtr (fun2cfun f)\n    result &lt;- c_evalf fPtr (realToFrac x)\n    freeHaskellFunPtr fPtr\n    return result\n\nforeign import ccall \"sumpointer\" c_sumpointer\n    :: Ptr (Ptr CDouble) -&gt; IO CDouble\n</code></pre>\n\n<p><em>module Main.hs, to be compiled</em></p>\n\n<pre><code>module Main\n  where\nimport           Lib\n\nmain :: IO ()\nmain = do\n    x &lt;- evalFun (\\x -&gt; x*x) 2\n    y &lt;- c_sumpointer x\n    print y\n</code></pre>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1523528670, "post_id": 49794097, "comment_id": 86602445, "body": "It looks like you want the head here."}, {"owner": {"reputation": 77, "user_id": 5495748, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o9tXGmBrd9o/AAAAAAAAAAI/AAAAAAAAAQ4/PWCdokuXRsc/photo.jpg?sz=128", "display_name": "David Suarez", "link": "https://stackoverflow.com/users/5495748/david-suarez"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523528968, "post_id": 49794097, "comment_id": 86602637, "body": "Actually I would like to get even the 4th element, so with an input like [[1,2,3],[4,5,6],[7,8,9]] using a function with &quot;example [x:y:z] = [y]&quot; instead of the one above"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523529051, "post_id": 49794097, "comment_id": 86602683, "body": "well <code>[x:y]</code> is <i>not</i> a list constructor, it is a composition of constructors. But I propose if you want different semantics, then you should update your question, or ask a new one."}], "answers": [{"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1523610574, "post_id": 49794217, "comment_id": 86640886, "body": "<code>safeHead f g = maybe f g . listToMaybe</code>"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1523534048, "last_edit_date": 1523534048, "creation_date": 1523528935, "answer_id": 49794217, "question_id": 49794097, "link": "https://stackoverflow.com/questions/49794097/haskell-lists-in-list/49794217#49794217", "title": "Haskell Lists in List", "body": "<p>You are quite close. In fact what you here want is some sort of \"safe\" head.</p>\n\n<p>A list <code>[a]</code> has two constructors:</p>\n\n<ol>\n<li>the empty list <code>[]</code>, you cover this in the first case; and</li>\n<li>the \"cons\" <code>(x:xs)</code>.</li>\n</ol>\n\n<p>It looks like you cover that in the second case, but in fact you do not: you put the pattern within <em>square</em> brackets. As a result, Haskell interprets your pattern as <code>[(x:xs)]</code>. So it thinks you match a <em>singleton</em> list (a list with one element), and that <code>x</code> is the head of the sublist, and <code>xs</code> the tail of the sublist.</p>\n\n<p>In fact you want to cover <code>(x:xs)</code>. If we use this pattern, there is another problem: <code>x</code> is the head of the list, so it has type <code>[a]</code>. Therefore we should return <code>x</code>, not <code>[x]</code>, since in the latter case, we would wrap the sublist back in a list.</p>\n\n<p>So a correct function is:</p>\n\n<pre><code>example :: [[a]] -&gt; [a]\nexample [] = []\nexample <b>(</b>x:_<b>)</b> = <b>x</b>  -- round brackets, x instead of [x]</code></pre>\n\n<p>Note that since we are not interested in the tail here, we use an underscore <code>_</code>. If you compile with all warnings (<code>-Wall</code>, or more specific <code>-Wunused-matches</code>) Haskell will otherwise complain about the fact that you declare a variable that you do  not use.</p>\n\n<h1>Generalizing to a <code>safeHead</code> function</h1>\n\n<p>We can generalize this to some sort of generic <code>safeHead :: b -&gt; (a -&gt; b) -&gt; [a] -&gt; b</code> function:</p>\n\n<pre><code>safeHead :: b -&gt; (a -&gt; b) -&gt; [a] -&gt; b\nsafeHead d _ [] = d\nsafeHead _ f (x:_) = f x\n</code></pre>\n\n<p>Here we thus pass three arguments to <code>safeHead</code>: a value (of type <code>b</code>) we should return in case the list is empty; a function to post-process the head (type <code>a -&gt; b</code>), and the list to <code>process</code>. In that case the <code>example</code> is equivalent to:</p>\n\n<pre><code>example :: [[a]] -&gt; [a]\nexample = safeHead [] id\n</code></pre>\n\n<p>But we can also return a <code>Maybe [a]</code> here:</p>\n\n<pre><code>example2 :: [a] -&gt; Maybe a\nexample2 = safeHead Nothing Just\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 5495748, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o9tXGmBrd9o/AAAAAAAAAAI/AAAAAAAAAQ4/PWCdokuXRsc/photo.jpg?sz=128", "display_name": "David Suarez", "link": "https://stackoverflow.com/users/5495748/david-suarez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 0, "accepted_answer_id": 49794217, "answer_count": 1, "score": 2, "last_activity_date": 1523556315, "creation_date": 1523528638, "last_edit_date": 1523534421, "question_id": 49794097, "link": "https://stackoverflow.com/questions/49794097/haskell-lists-in-list", "title": "Haskell Lists in List", "body": "<p>I'm very new on Haskell, and I'm trying the following:\nTo obtain <code>[1,2,3]</code> from <code>[[1,2,3],[4,5,6]]</code>?</p>\n\n<pre><code>example :: [[a]] -&gt; [a]\nexample [] = []\nexample [x:xs] = [x]\n</code></pre>\n\n<p>This example is returning <code>[1]</code> when input is <code>[[1,2,3]]</code> and if I add an other element in the main List, like <code>[[1,2,3],[3,4,5]]</code> then I have a Non-exhaustive pattern function.</p>\n"}, {"tags": ["haskell", "monads", "lazy-evaluation", "evaluation", "operator-precedence"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 5, "creation_date": 1523523499, "post_id": 49792220, "comment_id": 86598931, "body": "No not per se, that depends on the monad that is used. In fact for a <code>Maybe</code> monad for example it is very likely that a huge amount is <i>not</i> evaluated. For an I/O monad, there is a guarantee that the I/O <i>actions</i> are done in the order you specify."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523523586, "post_id": 49792220, "comment_id": 86598977, "body": "@WillemVanOnsem <code>somefunction voxel</code> returns an <code>IO (something)</code>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1523523671, "post_id": 49792220, "comment_id": 86599030, "body": "Well then it is guaranteed that the I/O actions are done in the order you define. But that does not per se means that all the calculations that happen around those I/O actions (at the level of Haskell) are done."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1523528473, "post_id": 49792220, "comment_id": 86602305, "body": "Specifically if you are in <code>IO</code>, if you want to lazily perform an action, you can use <a href=\"https://www.haskell.org/hoogle/?hoogle=unsafeInterleaveIO\" rel=\"nofollow noreferrer\"><code>unsafeInterleaveIO</code></a>.  This is not common though -- it&#39;s considered better design to push all the important stuff out of <code>IO</code> into pure code, which is always as lazy as possible."}], "answers": [{"comments": [{"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1523561915, "post_id": 49798761, "comment_id": 86623875, "body": "Ah ok. <code>somefunction</code> returns an <code>IO</code>, I didn&#39;t think to use <code>&lt;-</code> with a <code>return</code> in the other case. Thanks !"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 5, "last_activity_date": 1523542148, "creation_date": 1523542148, "answer_id": 49798761, "question_id": 49792220, "link": "https://stackoverflow.com/questions/49792220/evaluation-of-something-stuff-statements/49798761#49798761", "title": "Evaluation of &quot;something &lt;- stuff&quot; statements", "body": "<p>No, monadic binding is no guarantee that anything gets evaluated. There are lazy monads; e.g. the reader monad would not force the result of <code>somefunction voxel</code> unless <code>voxmax</code> was <code>Nothing</code>.</p>\n\n<p>But there's no reason to rely on such behaviors; it is easy to reliably avoid extra computation:</p>\n\n<pre><code>computeContour3d voxel voxmax level = do\n    max' &lt;- case voxmax of\n        Nothing -&gt; somefunction voxel\n        Just max -&gt; return max\n    -- use max'\n</code></pre>\n\n<p>You could consider using <code>maybe</code>, which is often shorter than an explicit <code>case</code>, as in:</p>\n\n<pre><code>    max' &lt;- maybe (somefunction voxel) return voxmax\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8174234"}, "is_accepted": false, "score": 0, "last_activity_date": 1523558328, "creation_date": 1523558328, "answer_id": 49803769, "question_id": 49792220, "link": "https://stackoverflow.com/questions/49792220/evaluation-of-something-stuff-statements/49803769#49803769", "title": "Evaluation of &quot;something &lt;- stuff&quot; statements", "body": "<blockquote>\n  <p>Is it true that statements like something &lt;- stuff are always evaluated in Haskell, even when something is not called in the rest of the code ?</p>\n</blockquote>\n\n<p>Not in general, no. The <code>IO</code> monad forces such evaluation, but many others do not.</p>\n\n<blockquote>\n  <p>is <code>something &lt;- stuff</code> called an \"action\" ?</p>\n</blockquote>\n\n<p>Usually that line would be called a monadic <em>bind</em>. Some monads (e.g. lists) don't really \"act\" in any meaningful way. </p>\n"}], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 49798761, "answer_count": 2, "score": 0, "last_activity_date": 1523558328, "creation_date": 1523523402, "last_edit_date": 1523532341, "question_id": 49792220, "link": "https://stackoverflow.com/questions/49792220/evaluation-of-something-stuff-statements", "title": "Evaluation of &quot;something &lt;- stuff&quot; statements", "body": "<p>Is it true that statements like <code>something &lt;- stuff</code> are always evaluated in Haskell, even when <code>something</code> is not called in the rest of the code ? (is <code>something &lt;- stuff</code> called an \"action\" ? - I don't know the technical wording).</p>\n\n<p>If this is true, I have another question.</p>\n\n<p>I have some code starting like this:</p>\n\n<pre><code>computeContour3d voxel voxmax level = do\n    voxelmax &lt;- somefunction voxel\n    let max' = fromMaybe voxelmax voxmax\n</code></pre>\n\n<p>That is, if the argument <code>voxmax</code> is not <code>Nothing</code>, then <code>voxelmax</code> is not necessary, since <code>max' = fromJust voxmax</code> in this case. Therefore, if the answer to my first question is \"Yes\", how could I avoid the evaluation of <code>voxelmax</code> when it is not necessary ?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1523519439, "post_id": 49790812, "comment_id": 86596485, "body": "But if the odd digits are greater than or equal to 5, then what happens? Since then than the &quot;new&quot; digit is larger than 10."}, {"owner": {"reputation": 318, "user_id": 6754285, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/70431543134c84959736ea64a820a11a?s=128&d=identicon&r=PG&f=1", "display_name": "cars", "link": "https://stackoverflow.com/users/6754285/cars"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523519699, "post_id": 49790812, "comment_id": 86596622, "body": "That is actually the next part of the problem. In which if you got 10 it would just become a 1  because 10  is 1 + 0  which = 1. if you got something like 14 it would become a 5 because 1 + 4 = 5"}], "answers": [{"comments": [{"owner": {"reputation": 318, "user_id": 6754285, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/70431543134c84959736ea64a820a11a?s=128&d=identicon&r=PG&f=1", "display_name": "cars", "link": "https://stackoverflow.com/users/6754285/cars"}, "edited": false, "score": 0, "creation_date": 1523522149, "post_id": 49791469, "comment_id": 86597989, "body": "Alot of the code you have written has been directly written in the prelude I was looking for an approach more looking towards loading a single text.hs file including the code and then just loading and running it. Thanks"}, {"owner": {"reputation": 1096, "user_id": 5021447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-gwPYP717ZyU/AAAAAAAAAAI/AAAAAAAAAP8/WoyhftM4PuU/photo.jpg?sz=128", "display_name": "Jordan Mackie", "link": "https://stackoverflow.com/users/5021447/jordan-mackie"}, "reply_to_user": {"reputation": 318, "user_id": 6754285, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/70431543134c84959736ea64a820a11a?s=128&d=identicon&r=PG&f=1", "display_name": "cars", "link": "https://stackoverflow.com/users/6754285/cars"}, "edited": false, "score": 0, "creation_date": 1523523992, "post_id": 49791469, "comment_id": 86599251, "body": "In the final solution <code>sumDigits . mapOdd (*2) . init . digits</code> 3/4 functions are not defined in the <code>Prelude</code>. I assume you mean that the answer was presented in the context of a ghci session, rather than a complete module. If you want a module, everything you need is there."}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1523526385, "post_id": 49791469, "comment_id": 86600863, "body": "Shouldn&#39;t <code>digits 0</code> give <code>[0]</code>?"}, {"owner": {"reputation": 1096, "user_id": 5021447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-gwPYP717ZyU/AAAAAAAAAAI/AAAAAAAAAP8/WoyhftM4PuU/photo.jpg?sz=128", "display_name": "Jordan Mackie", "link": "https://stackoverflow.com/users/5021447/jordan-mackie"}, "reply_to_user": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 1, "creation_date": 1523529678, "post_id": 49791469, "comment_id": 86603051, "body": "@Elmex80s I thought it reasonable to ignore this case given the problem, for simplicity. But you&#39;re right. To get around this you&#39;d either need to define a wrapper function to handle that case, or fallback to hacky string splitting solutions :)"}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1523576156, "post_id": 49791469, "comment_id": 86629433, "body": "@JordanMackie if you were looking at handling those edge cases, probably best to implement digits as consing each digit, then reversing the result in the wrapper function (<code>digits&#39; 0 = []; digits&#39; x = let (d, m) = x </code>divMod` 10 in m : digits d` and <code>digits 0 = [&#39;0&#39;]; digits x = reverse . digits&#39; $ x</code>)"}], "tags": [], "owner": {"reputation": 1096, "user_id": 5021447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-gwPYP717ZyU/AAAAAAAAAAI/AAAAAAAAAP8/WoyhftM4PuU/photo.jpg?sz=128", "display_name": "Jordan Mackie", "link": "https://stackoverflow.com/users/5021447/jordan-mackie"}, "is_accepted": false, "score": 2, "last_activity_date": 1523869680, "last_edit_date": 1523869680, "creation_date": 1523521419, "answer_id": 49791469, "question_id": 49790812, "link": "https://stackoverflow.com/questions/49790812/adding-two-functions-together-in-haskell/49791469#49791469", "title": "Adding two functions together in Haskell", "body": "<p>First, you need a way to break some large number into digits.</p>\n\n<pre><code>digits :: Integral x =&gt; x -&gt; [x]\ndigits 0 = []\ndigits x = digits (x `div` 10) ++ [x `mod` 10]\n</code></pre>\n\n<p>Which gives you...</p>\n\n<pre><code>Prelude&gt; digits 12345\n[1,2,3,4,5]\n</code></pre>\n\n<p>You can then drop the last digit with <code>init</code></p>\n\n<pre><code>Prelude&gt; (init . digits) 12345\n[1,2,3,4]\n</code></pre>\n\n<p>The a helper function to <code>map</code> over odd elements in a list.</p>\n\n<pre><code>mapOdd _ [] = []\nmapOdd f (x:[]) = [f x]\nmapOdd f (x:y:rest) = f x : y : mapOdd f rest\n</code></pre>\n\n<p>Giving you...</p>\n\n<pre><code>Prelude&gt; mapOdd (+10) [1..10]\n[11,2,13,4,15,6,17,8,19,10]\n</code></pre>\n\n<p>And a function to get back to a large number...</p>\n\n<pre><code>undigits = sum . zipWith (*) [10^n | n &lt;- [0..]] . reverse\n</code></pre>\n\n<p>Resulting in...</p>\n\n<pre><code>Prelude&gt; undigits [1, 2, 3, 4]\n1234\n</code></pre>\n\n<p>And putting it all together</p>\n\n<pre><code>Prelude&gt; undigits . mapOdd (*2) . init . digits $ 12345\n2264\n</code></pre>\n\n<hr>\n\n<p>In functional languages particularly, always try to solve a problem by composing solutions to smaller problems :)</p>\n"}, {"tags": [], "owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "is_accepted": true, "score": 1, "last_activity_date": 1523609951, "last_edit_date": 1523609951, "creation_date": 1523606792, "answer_id": 49812178, "question_id": 49790812, "link": "https://stackoverflow.com/questions/49790812/adding-two-functions-together-in-haskell/49812178#49812178", "title": "Adding two functions together in Haskell", "body": "<p>The missing component is a way to break down an integer into its digits, and build it back up from there. That's easy:</p>\n\n<pre><code>digits:: Int -&gt; [Int]\ndigits = map (`mod` 10) . takeWhile (/= 0) . iterate (`div` 10)\n\nundigits :: [Int] -&gt; Int\nundigits = foldr f 0 where f i r = 10 * r + i\n</code></pre>\n\n<p>Then it looks like you need to post-process those digits in two different ways, but only if they match a predicate. Let's build a combinator for that:</p>\n\n<pre><code>when :: (a -&gt; Bool) -&gt; (a -&gt; a) -&gt; a -&gt; a\nwhen p f a = if p a then f a else a\n</code></pre>\n\n<p>The first case appears when you want to double digits in odd position (from left to right). Again trivial, with the minor inconvenience that <code>digits</code> breaks down a number by increasing power of ten. Let's prefix each number by its position:</p>\n\n<pre><code>prefix :: [Int] -&gt; [(Int, Int)]\nprefix is = let n = length is in zip [n, n-1..1] is\n</code></pre>\n\n<p><code>doubleOdd</code> can now be expressed as</p>\n\n<pre><code>doubleodd :: [Int] -&gt; [Int]\ndoubleodd = map (snd . when (odd . fst) (id *** double)) . prefix\n</code></pre>\n\n<p>You mentioned in a comment that when the double number overflows, its digits must be added together. This is the second case I was referring to and is again simplicity itself:</p>\n\n<pre><code>double :: Int -&gt; Int\ndouble = when (&gt;= 10) (sum . digits) . (* 2)\n</code></pre>\n\n<p>Here is your final program:</p>\n\n<pre><code>program = undigits . doubleodd . tail . digits\n</code></pre>\n\n<p>... assuming the \"between 13 and 15 digits\" part is verified separately.</p>\n"}, {"tags": [], "owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "is_accepted": false, "score": 0, "last_activity_date": 1524062013, "last_edit_date": 1524062013, "creation_date": 1523723765, "answer_id": 49833713, "question_id": 49790812, "link": "https://stackoverflow.com/questions/49790812/adding-two-functions-together-in-haskell/49833713#49833713", "title": "Adding two functions together in Haskell", "body": "<p>I hope this helps and realize it could be cleaned up a lot. List indices start with 0 which is also an even number and the first element of a list. The list comprehension processes 0,2,4 ... the 1st,2nd and 3rd items.</p>\n\n<pre><code>let f n = [mod n 10] ++ f (div n 10)\nlet r = [if even i then d*2 else d|(i,d)&lt;-zip [0..] (init.reverse.take 14.f$19283828382133)]\nsum [b*(10^a)|(a,b) &lt;- zip [12,11..0] r]\n</code></pre>\n\n<p>2948684868416</p>\n\n<p>If you want it to handle any length number, the easiest way here is <code>length $ show 19283828382133</code> but I do have a function somewhere that does that. Use the length as a value in 3 places, once at full value in the<code>take</code> function in the composition.</p>\n"}], "owner": {"reputation": 318, "user_id": 6754285, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/70431543134c84959736ea64a820a11a?s=128&d=identicon&r=PG&f=1", "display_name": "cars", "link": "https://stackoverflow.com/users/6754285/cars"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 633, "favorite_count": 1, "accepted_answer_id": 49812178, "answer_count": 3, "score": 0, "last_activity_date": 1524062013, "creation_date": 1523519300, "question_id": 49790812, "link": "https://stackoverflow.com/questions/49790812/adding-two-functions-together-in-haskell", "title": "Adding two functions together in Haskell", "body": "<p>Hi I am new in Haskell and I came across an interesting problem but I was not really sure on how I would go about solving it. I am about to show you only two parts of the question as an example.</p>\n\n<p>The question is that we are to input a number between 13 to 15 digits.\nthen from that number we remove the last number. such as 19283828382133 should out put the exact same number just without the final 3, 1928382838213.</p>\n\n<p>Then every odd digit(not number) from these numbers will be doubled. So you will get 2,9,4,8,6 etc </p>\n\n<p>This is my code so far. As you can see from the code I have been able to complete these two parts individually(working) but I am not sure how <strong>I would add them together.</strong></p>\n\n<pre><code>lastdigit :: Integer -&gt; Integer -- This Function removes the last number\nlastdigit x = x`div`10\n\ndoubleOdd (x:xs) = (2*x):(doubleEven xs) -- This function doubles every odd digit not number.\ndoubleOdd [] = []\ndoubleEven (x:xs) = x:(doubleOdd xs)\ndoubleEven [] = []\n</code></pre>\n\n<p>So to further explain the program I am trying to build will first go through the step of taking in the number between 13 to 15 digits. Then it will first remove the last number then automatically go to the  next step of doubling each odd digit(not number). Thanks</p>\n"}, {"tags": ["haskell", "ffi", "gtk2hs", "c2hs"], "answers": [{"tags": [], "owner": {"reputation": 69, "user_id": 2607390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83cda35e876676d9f4fe1ab49749ef50?s=128&d=identicon&r=PG", "display_name": "kilian", "link": "https://stackoverflow.com/users/2607390/kilian"}, "is_accepted": false, "score": 1, "last_activity_date": 1523562022, "creation_date": 1523562022, "answer_id": 49804645, "question_id": 49789724, "link": "https://stackoverflow.com/questions/49789724/c2hs-in-marshaller-vs-gtk2hsc2hs/49804645#49804645", "title": "c2hs in marshaller vs. gtk2hsC2hs", "body": "<p>Ok, the following seems to work:</p>\n\n<pre><code>{#fun cairo_pattern_set_matrix as patternSetMatrix \n        { `Pattern', with* `Matrix'} -&gt; `()'#}\n</code></pre>\n\n<p>So the handling of <code>newtype</code> and in marshalers is different in <code>c2hs</code> and <code>gtk2hsC2hs</code>. I guess, this is because the latter is based on an ancient version.</p>\n"}], "owner": {"reputation": 69, "user_id": 2607390, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83cda35e876676d9f4fe1ab49749ef50?s=128&d=identicon&r=PG", "display_name": "kilian", "link": "https://stackoverflow.com/users/2607390/kilian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1523562022, "creation_date": 1523515453, "last_edit_date": 1523516307, "question_id": 49789724, "link": "https://stackoverflow.com/questions/49789724/c2hs-in-marshaller-vs-gtk2hsc2hs", "title": "c2hs in marshaller vs. gtk2hsC2hs", "body": "<p>i try to understand the difference between <code>c2hs</code> and <code>gtk2hsC2hs</code> (modified version of <code>c2hs</code> for use in <code>gtk2hs</code>). Consider the following coding:</p>\n\n<pre><code>module Matrix where\n\ndata Matrix = Matrix { xx :: !Double, yx :: !Double,\n                       xy :: !Double, yy :: !Double,\n                       x0 :: !Double, y0 :: !Double }\n  deriving (Show, Eq) \n\n{#pointer *cairo_matrix_t as MatrixPtr -&gt; Matrix#}\n\ninstance Storable Matrix where\n    sizeOf _ = {#sizeof cairo_matrix_t#}\n    alignment _ = alignment (undefined :: CDouble)\n    peek p = do\n        xx &lt;- {#get cairo_matrix_t-&gt;xx#} p\n        yx &lt;- {#get cairo_matrix_t-&gt;yx#} p\n        xy &lt;- {#get cairo_matrix_t-&gt;xy#} p\n        yy &lt;- {#get cairo_matrix_t-&gt;yy#} p\n        x0 &lt;- {#get cairo_matrix_t-&gt;x0#} p\n        y0 &lt;- {#get cairo_matrix_t-&gt;y0#} p\n        return $ Matrix (realToFrac xx) (realToFrac yx)\n                (realToFrac xy) (realToFrac yy)\n                (realToFrac x0) (realToFrac y0)\n\n   poke p (Matrix xx yx xy yy x0 y0) = do\n       {#set cairo_matrix_t-&gt;xx#} p (realToFrac xx)\n       {#set cairo_matrix_t-&gt;yx#} p (realToFrac yx)\n       {#set cairo_matrix_t-&gt;xy#} p (realToFrac xy)\n       {#set cairo_matrix_t-&gt;yy#} p (realToFrac yy)\n       {#set cairo_matrix_t-&gt;x0#} p (realToFrac x0)\n       {#set cairo_matrix_t-&gt;y0#} p (realToFrac y0)\n       return () \n\n{#context lib=\"cairo\" #}\n\n{#fun cairo_pattern_set_matrix as patternSetMatrix { unPattern `Pattern', `Matrix'} -&gt; `()'#}\n{#fun cairo_pattern_get_matrix as patternGetMatrix { unPattern `Pattern', alloca- `Matrix' peek*} -&gt; `()'#}       \n</code></pre>\n\n<p>The second <code>fun</code> line (e.g. <code>cairo_pattern_get_matrix</code>) works for both tools (although the generated code is different), while the first (e.g. <code>cairo_pattern_set_matrix</code>) works only for <code>gtk2hsC2hs</code>. </p>\n\n<p>The error message when using <code>c2hs</code> is:</p>\n\n<pre><code>Test.chs:35: (column 75) [ERROR]  &gt;&gt;&gt; Missing \"in\" marshaller!\nThere is no default marshaller for this combination of Haskell and C type:\n  Haskell type: Matrix\n  C type      : (MatrixPtr)\n</code></pre>\n\n<p>I don't understand the problem here clearly, but from my point of view, this should be valid.</p>\n\n<p>I use for <code>c2hs</code>:</p>\n\n<pre><code>C-&gt;Haskell Compiler, version 0.28.3 Switcheroo, 25 November 2017\n  build platform is \"x86_64-linux\" &lt;1, True, True, 1&gt;\n</code></pre>\n\n<p>and <code>gtk2hsC2hs</code>:</p>\n\n<pre><code>C-&gt;Haskell Compiler, version 0.13.13 (gtk2hs branch) \"Bin IO\", 27 May 2012\n</code></pre>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1523508973, "post_id": 49788242, "comment_id": 86591521, "body": "sigh .. for some reason when I tried this earlier, I got an error. I am not sure what I did wrong then. Thanks a lot."}, {"owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 0, "creation_date": 1523509025, "post_id": 49788242, "comment_id": 86591531, "body": "thanks for the extra options. is that <code>for_</code> different to <code>forM_</code>"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "edited": false, "score": 1, "creation_date": 1523509238, "post_id": 49788242, "comment_id": 86591593, "body": "<code>forM_</code> is an artifact of history - it is specialized to Monads.  Now that all Monads are also Applicative you can always use <code>for_</code> and we should some day remove <code>forM_</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1523551431, "post_id": 49788242, "comment_id": 86618406, "body": "If they&#39;re <code>IO ()</code> operations, then <code>mapM_</code> or <code>for_</code> is almost certainly preferable."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 8, "last_activity_date": 1523509375, "last_edit_date": 1523509375, "creation_date": 1523508801, "answer_id": 49788242, "question_id": 49788203, "link": "https://stackoverflow.com/questions/49788203/haskell-running-a-list-of-io-operations-over-a-single-value/49788242#49788242", "title": "Haskell: Running a list of IO operations over a single value", "body": "<p>Just use a map and partial application of function application (<code>$</code>):</p>\n\n<pre><code>mapM ($ str) [op1,op2,op3]\n</code></pre>\n\n<p>Don't want the result? Fine.</p>\n\n<pre><code>mapM_ ($ str) [op1,op2,op3]\n</code></pre>\n\n<p>Or use <code>Data.Foldable</code>:</p>\n\n<pre><code>for_ [op1,op2,op3] ($ str)\n</code></pre>\n\n<p>EDIT:</p>\n\n<p>Expanding on the commentary of <code>for_</code> being a replacement for <code>forM_</code>.</p>\n\n<p>The same can be said about <code>mapM</code>/<code>mapM_</code>.  These are artifacts of history - the operations are specialized to Monads and could, argueably should, be deleted.  The Applicative alternative is <code>traverse</code> and <code>traverse_</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "is_accepted": false, "score": 2, "last_activity_date": 1523550051, "creation_date": 1523550051, "answer_id": 49801508, "question_id": 49788203, "link": "https://stackoverflow.com/questions/49788203/haskell-running-a-list-of-io-operations-over-a-single-value/49801508#49801508", "title": "Haskell: Running a list of IO operations over a single value", "body": "<p>I'd recommend the <code>for_</code> or <code>traverse_</code> approach, but note that these <code>Monoid</code> instances exist:</p>\n\n<pre><code> Monoid b =&gt; Monoid (a -&gt; b)\n Monoid a =&gt; Monoid (IO a)\n Monoid ()\n</code></pre>\n\n<p>So in this particular case, this works:</p>\n\n<pre><code>  mconcat [op1, op2, op3] str\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user8174234"}, "is_accepted": false, "score": 1, "last_activity_date": 1523558806, "creation_date": 1523558806, "answer_id": 49803881, "question_id": 49788203, "link": "https://stackoverflow.com/questions/49788203/haskell-running-a-list-of-io-operations-over-a-single-value/49803881#49803881", "title": "Haskell: Running a list of IO operations over a single value", "body": "<p>I would do</p>\n\n<pre><code>op1, op2, op3 :: String -&gt; IO ()\n\nmain :: IO ()\nmain = do\n    let str = \"test\"\n    mconcat (sequence [op1, op2, op3] str)\n</code></pre>\n\n<p>This is somewhat complicated: <code>sequence</code> here is specialized to type</p>\n\n<pre><code>[String -&gt; IO ()] -&gt; String -&gt; [IO ()]\n</code></pre>\n\n<p>while <code>mconcat</code> simply takes a list of IO actions (type <code>[IO ()]</code>) and returns a single IO action (type <code>IO ()</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 0, "last_activity_date": 1523561925, "creation_date": 1523561925, "answer_id": 49804618, "question_id": 49788203, "link": "https://stackoverflow.com/questions/49788203/haskell-running-a-list-of-io-operations-over-a-single-value/49804618#49804618", "title": "Haskell: Running a list of IO operations over a single value", "body": "<p>Another solution, this one using <code>ZipList</code> from <code>Control.Applicative</code>:</p>\n\n<pre><code>let ZipList ios = ZipList [op1,op2,op3] &lt;*&gt; ZipList (repeat str) \n in sequence ios\n</code></pre>\n"}], "owner": {"reputation": 1376, "user_id": 5200466, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/abb1362cec6e1f0a2416a6d98a93cd6c?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/5200466/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 1, "accepted_answer_id": 49788242, "answer_count": 4, "score": 2, "last_activity_date": 1523561925, "creation_date": 1523508600, "question_id": 49788203, "link": "https://stackoverflow.com/questions/49788203/haskell-running-a-list-of-io-operations-over-a-single-value", "title": "Haskell: Running a list of IO operations over a single value", "body": "<p>if I have a number of functions that are <code>string -&gt; IO ()</code>, is there a tidy way to apply them all to a single value in sequence.</p>\n\n<pre><code>op1, op2, op3 :: String -&gt; IO ()\n\nmain :: IO ()\nmain = do\n  let str = \"test\"\n  op1 str\n  op2 str\n  op3 str\n</code></pre>\n\n<p>with out having to write out str each time?</p>\n"}, {"tags": ["haskell", "warnings"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1523508203, "post_id": 49788056, "comment_id": 86591298, "body": "There is a better way, but apparently not one that you are unaware of. Try comparing the second line of your paste (which probably complains about an unused binding for <code>n</code>) and the third line of your paste (which presumably does not complain about an unused binding for <code>n</code>)."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 2, "creation_date": 1523516971, "post_id": 49788056, "comment_id": 86595107, "body": "There is also a better which the OP is not aware , using <code>_n</code>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1523523443, "post_id": 49788056, "comment_id": 86598888, "body": "Well here Haskell complains that you define parameters that you do not need. You can use underscores for it. So <code>polygonList _ [] = []</code> and <code>polygonList _ [_] = &quot;Too few points remaining&quot;</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8174234"}, "edited": false, "score": 0, "creation_date": 1523557962, "post_id": 49788056, "comment_id": 86621801, "body": "You can simply use <code>_</code> in place of patterns which are not used."}], "answers": [{"tags": [], "owner": {"reputation": 2026, "user_id": 1406083, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1gC8p.jpg?s=128&g=1", "display_name": "Billy Brown", "link": "https://stackoverflow.com/users/1406083/billy-brown"}, "is_accepted": false, "score": 3, "last_activity_date": 1523533599, "creation_date": 1523533599, "answer_id": 49795742, "question_id": 49788056, "link": "https://stackoverflow.com/questions/49788056/warning-defined-but-not-used-haskell/49795742#49795742", "title": "Warning: Defined but not used Haskell", "body": "<p>Did you look at the locations in the code that the warnings point you to? They are giving you exact line and column numbers.</p>\n\n<p>As pointed out in the comments on your question, there are two places in the following code that have a defined but unused variable:</p>\n\n<pre><code>polygonList :: Int -&gt; [Int] -&gt; [Polygon]\npolygonList n [] = []\n--          ^ you define n here but do not use it; use _ instead\npolygonList _ [x] = error \"Too few points remaining\"\n--             ^ you define x here but do not use it; use _ instead\n</code></pre>\n\n<p>With those modifications applied, the beginning of your function becomes:</p>\n\n<pre><code>polygonList :: Int -&gt; [Int] -&gt; [Polygon]\npolygonList _ [] = []\npolygonList _ [_] = error \"Too few points remaining\"\n</code></pre>\n\n<p>The underscore <code>_</code> can be used more than once in a single pattern and signifies that the value at that location should be ignored. It is a useful way of telling the user that your pattern might rely more on the shape of your pattern, or only on certain parts of it.</p>\n\n<p>Note: In the following line, <code>(2v)</code> is an error, do you mean <code>(2 * v)</code>?</p>\n\n<pre><code>list'' = drop (2v) list'\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9628234, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Morgan O&#39;Brien", "link": "https://stackoverflow.com/users/9628234/morgan-obrien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 714, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1523533599, "creation_date": 1523507689, "question_id": 49788056, "link": "https://stackoverflow.com/questions/49788056/warning-defined-but-not-used-haskell", "title": "Warning: Defined but not used Haskell", "body": "<p>I have this function, and am using ghc -Wall -Werror to check for warnings. From this method...</p>\n\n<pre><code>polygonList :: Int -&gt; [Int] -&gt; [Polygon]\npolygonList n [] = []\npolygonList _ [x] = error \"Too few points remaining\"\npolygonList n (v:y:list') =\n    let pointList = take (2*v) list' -- Note: list' may not have 2v points\n        points = getPoints pointList\n        list'' = drop (2v) list'\n\n        -- Calc Perim Here\n        Just (under, over) = calcPerim (fromIntegral y) points :: Maybe (Length, Length)\n        poly = Polygon { verticesNum = v, yVal = y, vertices = points, bottom = under, top = over }\n        nextPolygon = polygonList (n-1) list''\n    in (poly : nextPolygon)\n</code></pre>\n\n<p>... I get two warnings that I need to fix:</p>\n\n<p>polycake.hs:30:11: Warning: Defined but not used: \u2018ln\u2019</p>\n\n<p>polycake.hs:45:13: Warning: Defined but not used: \u2018n\u2019</p>\n\n<p>They are needed for the function's exhaustive patterns, but is there a better way that I'm unaware of?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1523505716, "creation_date": 1523505716, "answer_id": 49787808, "question_id": 49787704, "link": "https://stackoverflow.com/questions/49787704/user-inputs-in-haskell/49787808#49787808", "title": "User Inputs in Haskell", "body": "<p>Use pattern matching.</p>\n\n<pre><code>readStrings = do\n    strings &lt;- readStrings\n    case strings of\n        [john, jack] -&gt; test john jack\n        _ -&gt; -- what should happen if the user types too many or two few things?\n</code></pre>\n"}], "owner": {"reputation": 55, "user_id": 9375647, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "antelemon", "link": "https://stackoverflow.com/users/9375647/antelemon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1523505716, "creation_date": 1523504952, "question_id": 49787704, "link": "https://stackoverflow.com/questions/49787704/user-inputs-in-haskell", "title": "User Inputs in Haskell", "body": "<p>I'm new to Haskell and I was just wondering how would I be able to reference two different things in a user's input on a single line. For example:</p>\n\n<p>User input: <code>test \"John\" \"Jack\"</code></p>\n\n<p>I would just want to individualized John and Jack from each other. Here's something I have written so far but not sure if it is right.</p>\n\n<pre><code>main :: IO ()\n\nreadStrings = do\n    strings &lt;- readStrings \n    test strings \n...\n\nreadStrings :: IO [String]\nreadStrings = fmap (map read.words) getLine\n\ntest :: String -&gt; String -&gt; IO [String]\n...\n</code></pre>\n\n<p>They are both passed on to strings in <code>strings &lt;- readStrings</code>, and I'm not really sure how to get them separate. The two would them be used in the <code>test</code> function</p>\n"}, {"tags": ["haskell", "code-translation"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1523506166, "post_id": 49787169, "comment_id": 86590692, "body": "Can you narrow this down a bit? Ideally you could identify one or two lines of the Java code that are currently blocking your translation efforts and where a bit of expertise would unblock you. If you can&#39;t narrow it down to one thing that&#39;s blocking you, probably a more broad-spectrum tutorial would be a better resource than SO."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1523506278, "post_id": 49787169, "comment_id": 86590726, "body": "...and I know you say something specific (&quot;I am particularly having problems with creating mutable 2D and 3D arrays.&quot;), but it doesn&#39;t appear to be true -- I can see that you have Haskell code that performs that task (though there are some errors that should be easily fixed by following the compiler&#39;s advice). So it&#39;s really unclear what you&#39;re having trouble with."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8174234"}, "edited": false, "score": 1, "creation_date": 1523557836, "post_id": 49787169, "comment_id": 86621729, "body": "Are you sure you want to translate the Java to Haskell? If you could explain what the code actually does, it would be easier for us to help/suggest a solution. In particular, arrays are not really a functional data structure."}], "owner": {"reputation": 1, "user_id": 9626745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca65bfe547bd4289ef48d37049c5f415?s=128&d=identicon&r=PG&f=1", "display_name": "John Roberts", "link": "https://stackoverflow.com/users/9626745/john-roberts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1523501099, "creation_date": 1523501099, "question_id": 49787169, "link": "https://stackoverflow.com/questions/49787169/java-code-to-haskell-problems-with-2d-and-3d-arrays", "title": "Java Code to Haskell (Problems with 2D and 3D arrays)", "body": "<p>I have been asked to translate the following code which finds a maximum non-overlapping increasing sub sequence given a large amount of input. I haven't had much time to learn a lot on Haskell and I am stuck how to actually do it.</p>\n\n<p>Here is the code in Java:</p>\n\n<pre><code>import java.util.*;\npublic class mnois {\n    public static int[][] memo;\n    public static int[][] lis;\n    public static int[] nums;\n    public static int[][][] lmemo;\n    public static int n;\n    public static String input;\n    public static String[] arrIn;\n    public static void main(String[] args) {\n        Scanner br = new Scanner(System.in);\n        int t = br.nextInt();\n        for(int c = 1;c&lt;=t;c++) {\n            n = br.nextInt();\n            input = br.nextLine();\n            arrIn = input.split(\" \");\n            nums = new int[n];\n            for(int i = 0;i&lt;n;i++){\n                nums[i] = Integer.parseInt(arrIn[i]);\n            }\n            memo = new int[n][n+1];\n            for(int i = 0;i&lt;n;i++){\n                Arrays.fill(memo[i], -1);\n            }\n            lmemo = new int[n][n+1][n+1];\n            for(int i = 0;i&lt;n;i++){\n                for(int j = 0;j&lt;n+1;j++){\n                    Arrays.fill(lmemo[i][j], -1);\n                }\n            }\n            lis = new int[n][n];\n            for(int i = 0;i&lt;n;i++){\n                for(int j = i;j&lt;n;j++){\n                    lis[i][j] = lis(i, n, j);\n                }\n            }\n            for(int i = 1;i&lt;=n;i++){\n                System.out.print(go(0, i));\n                if (i != n){\n                    System.out.print(\" \");\n                }\n            }\n            System.out.println();\n        }\n    }\n\n    public static int lis(int pos, int last, int max) {\n        if (pos &gt; max) {\n            return 0;\n        }\n\n        if (lmemo[pos][last][max] != -1){\n            return lmemo[pos][last][max];\n        }\n\n        int best = lis(pos+1, last, max);\n        if (last == n || nums[pos] &gt; nums[last]) {\n            best = Math.max(best, lis(pos+1, pos, max)+1);\n        }\n        return lmemo[pos][last][max] = best;\n    }\n\n    public static int go(int pos , int k){\n        if (pos &gt;= n) {\n            return 0;\n        }\n\n        if (memo[pos][k] != -1){\n            return memo[pos][k];\n        }\n\n        int best = go(pos+1, k);\n        for(int i = pos;i&lt;n;i++){\n            if (lis[pos][i] &gt;= k) {\n                best = Math.max(best, go(i+1, k)+lis[pos][i]);\n            }\n        }\n\n        return memo[pos][k] = best;\n    }\n}\n</code></pre>\n\n<p>I am particularly having problems with creating mutable 2D and 3D arrays. Appreciate any help I can get.</p>\n\n<p>This is what I have so far:</p>\n\n<pre><code>import Data.Array.IO\n\ncase :: Int -&gt; Int -&gt; Bool\ncase index n = \n  if (index &gt;= n)\n    return True\n  else do\n    numElems :: Int &lt;- readLn\n    strElems &lt;- readLn\n    nums &lt;- newArray_ (0, numElems) :: Int\n    addElems nums 0 0 numElems strElems\n    memo &lt;- newArray ((0, 0), (strElems, strElems+1)) -1 :: IO (IOArray (Int, Int) Int)\n    lmemo &lt;- newArray (((0,0),(0,0)), ()) -1 :: IO (IOArray (Int, Int) IO (IOArray (Int, Int) Int))\n    lis &lt;- newArray ((0, 0), (strElems, strElems)) -1 :: IO (IOArray (Int, Int) Int)\n\n\naddElems :: (IOArray s Int Int) -&gt; Int -&gt; Int -&gt; Int -&gt; String -&gt; IO s ()\naddElems arr startArr strIndex finish string =\n  if (start &gt;= finish) then\n    return ()\n  else do\n    num &lt;- digitToInt $ string !! strIndex\n    writeArray arr startArr char\n    addElems arr (startArr+1) (strIndex+2) finish string\n\nlisLoop :: (IOArray s Int Int) -&gt; Int -&gt; Int -&gt; IO s ()\nlistLoop arr start finish = \n  if (start &gt;= finish) then\n    return ()\n  else do\n    next 0 finish\n  where\n    next i currIdx len =\n      if (i &lt; len)\n        writeArray arr (currIdx, i)\n        next (i+1) currIdx len\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1523499083, "post_id": 49786872, "comment_id": 86589096, "body": "Do you understand why you&#39;re getting the warning? This is the sort of problem where understanding how it arises is about 99% of solving it."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 9633019, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0eBNE.png?s=128&g=1", "display_name": "jaMAN", "link": "https://stackoverflow.com/users/9633019/jaman"}, "edited": false, "score": 0, "creation_date": 1523499897, "post_id": 49786950, "comment_id": 86589254, "body": "Thank you! That makes sense"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 7, "last_activity_date": 1523499336, "creation_date": 1523499336, "answer_id": 49786950, "question_id": 49786872, "link": "https://stackoverflow.com/questions/49786872/how-to-fix-defaulting-the-following-constraints-to-type-haskell/49786950#49786950", "title": "How to fix Defaulting the following constraint(s) to type... Haskell", "body": "<p>Annotate each <code>2</code>, as in</p>\n\n<pre><code>(bx-ax)^(2 :: Integer)\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 9633019, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0eBNE.png?s=128&g=1", "display_name": "jaMAN", "link": "https://stackoverflow.com/users/9633019/jaman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 706, "favorite_count": 1, "accepted_answer_id": 49786950, "answer_count": 1, "score": 3, "last_activity_date": 1523499336, "creation_date": 1523498692, "question_id": 49786872, "link": "https://stackoverflow.com/questions/49786872/how-to-fix-defaulting-the-following-constraints-to-type-haskell", "title": "How to fix Defaulting the following constraint(s) to type... Haskell", "body": "<p>I have the following helper method</p>\n\n<pre><code>distance :: Segment -&gt; Length\ndistance ((ax, ay), (bx, by)) = sqrt ((bx-ax)^2 + (by-ay)^2)\n</code></pre>\n\n<p>And I get the warning </p>\n\n<pre><code>polycake.hs:115:46: Warning:\nDefaulting the following constraint(s) to type \u2018Integer\u2019\n  (Integral b0) arising from a use of \u2018^\u2019 at polycake.hs:115:46\n  (Num b0) arising from the literal \u20182\u2019 at polycake.hs:115:47\nIn the first argument of \u2018(+)\u2019, namely \u2018(bx - ax) ^ 2\u2019\nIn the first argument of \u2018sqrt\u2019, namely\n  \u2018((bx - ax) ^ 2 + (by - ay) ^ 2)\u2019\nIn the expression: sqrt ((bx - ax) ^ 2 + (by - ay) ^ 2)\n</code></pre>\n\n<p>I can't suppress the warning either, looking for a way to explicitly cast it to a type.</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 6, "creation_date": 1523496518, "post_id": 49786601, "comment_id": 86588549, "body": "No, there isn&#39;t. You will need to use a smarter algorithm so that you don&#39;t actually use a list."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 5, "creation_date": 1523497529, "post_id": 49786601, "comment_id": 86588775, "body": "Or at least so you don&#39;t need the length. Either way, this seems like an XY Problem and I think you would benefit from asking how to solve your problem rather than how to implement the solution you have in mind."}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 2, "creation_date": 1523498223, "post_id": 49786601, "comment_id": 86588927, "body": "Haskell lists are just linked lists. Just a pile of cons cells (using the <code>:</code> constructor) with (possibly) a terminal <code>[]</code>.  There&#39;s no way to tell how many cons cells there are without counting. If O(n) is too high a cost to pay for length, and you don&#39;t want to store it yourself, chances are you should be using a different data structure.  I agree with @ReinHenrichs tho that you should post the problem you&#39;re trying to use list length to solve, since there may be an alternate approach that would be faster."}, {"owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 0, "creation_date": 1523499281, "post_id": 49786601, "comment_id": 86589139, "body": "Because the list is an arithmetic sequence, you already know the length, which is <code>last list1 - head list1 + 1</code>.  No need to walk the whole linked list to obtain its length."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 1, "creation_date": 1523500914, "post_id": 49786601, "comment_id": 86589507, "body": "@HenriMenke It&#39;s a linked list: you can&#39;t get <code>last list1</code> without walking the entire list."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1523501302, "post_id": 49786601, "comment_id": 86589603, "body": "You may have a function that you expect to produce that many <code>Int</code>s, but I very much doubt you have an actual <i>list</i> of this many <code>Int</code>s. Such a list would require at least 4 <i>petabytes</i> of memory."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1523504650, "creation_date": 1523504650, "answer_id": 49787656, "question_id": 49786601, "link": "https://stackoverflow.com/questions/49786601/haskell-list-length-alternative/49787656#49787656", "title": "Haskell list length alternative", "body": "<p>I've occasionally gotten some value out of lists that carry their length. The poor man's version goes like this:</p>\n\n<pre><code>import Data.Monoid\n\ntype ListLength a = (Sum Integer, [a])\n\nsingletonLL :: a -&gt; ListLength a\nsingletonLL x = (1, [x])\n\nlengthLL :: ListLength a -&gt; Integer\nlengthLL (Sum len, _) = len\n</code></pre>\n\n<p>The <code>Monoid</code> instance that comes for free gives you empty lists, concatenation, and a <code>fromList</code>-alike. Other standard <code>Prelude</code> functions that operate on lists like <code>map</code>, <code>take</code>, <code>drop</code> aren't too hard to mimic, though you'll need to skip the ones like <code>cycle</code> and <code>repeat</code> that produce infinite lists, and <code>filter</code> and the like are a bit expensive. For your question, you would also want analogs of the <code>Enum</code> methods; e.g. perhaps something like:</p>\n\n<pre><code>enumFromToLL :: Integral a =&gt; a -&gt; a -&gt; ListLength a\nenumFromToLL lo hi = (fromIntegral hi-fromIntegral lo+1, [lo..hi])\n</code></pre>\n\n<p>Then, in ghci, your example is instant:</p>\n\n<pre><code>&gt; lengthLL (enumFromToLL 1 1000000000000000)\n1000000000000000\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9633466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/337103e3ac9060c08c296861a39818fe?s=128&d=identicon&r=PG&f=1", "display_name": "J. Chung", "link": "https://stackoverflow.com/users/9633466/j-chung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1523504650, "creation_date": 1523496224, "question_id": 49786601, "link": "https://stackoverflow.com/questions/49786601/haskell-list-length-alternative", "title": "Haskell list length alternative", "body": "<p>Hi I've got a list on Haskell with close to 10^15 Int's in it and I'm trying print the length of the list.</p>\n\n<pre><code>let list1 = [1..1000000000000000]   --  this is just a dummy list I dont\nprint list1 length                  --  know the actual number of elements\n</code></pre>\n\n<p>printing this takes a very long time to do, is there another way to get the number of elements in the list and print that number?</p>\n"}]