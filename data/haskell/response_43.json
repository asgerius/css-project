[{"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1446671257, "post_id": 33531834, "comment_id": 54845625, "body": "<code>nubBy</code> requires an equivalence relation, I think."}, {"owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 2, "creation_date": 1446671397, "post_id": 33531834, "comment_id": 54845699, "body": "That&#39;s what the docs say and the function passed here is not, which would result in undefined behavior. In practice, it could e.g. have been rewritten in such a way that the arguments are applied in the opposite order (safe for equivalence functions, not for arbitrary functions like this)"}, {"owner": {"reputation": 1891, "user_id": 45160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fe6d04c7c6a357a92a2b05efd0d09bc?s=128&d=identicon&r=PG", "display_name": "Vanson Samuel", "link": "https://stackoverflow.com/users/45160/vanson-samuel"}, "edited": false, "score": 0, "creation_date": 1446671461, "post_id": 33531834, "comment_id": 54845733, "body": "It works here just fine: <a href=\"http://rextester.com/LWZCQ71376\" rel=\"nofollow noreferrer\">rextester.com/LWZCQ71376</a>"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 3, "creation_date": 1446673622, "post_id": 33531834, "comment_id": 54846878, "body": "It works in ghc 7.6.3. Maybe <code>nubBy</code> was modified and &quot;optimized&quot; to rely on equivalence relation properties?"}], "answers": [{"comments": [{"owner": {"reputation": 1891, "user_id": 45160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fe6d04c7c6a357a92a2b05efd0d09bc?s=128&d=identicon&r=PG", "display_name": "Vanson Samuel", "link": "https://stackoverflow.com/users/45160/vanson-samuel"}, "edited": false, "score": 0, "creation_date": 1446676367, "post_id": 33533257, "comment_id": 54848302, "body": "The eq function should be commutative, it does seem possible that this change could be the cause of my issue."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 5, "creation_date": 1446682616, "post_id": 33533257, "comment_id": 54850445, "body": "No!! Your <code>eq</code> function is NOT commutative!  <code>rem 4 2 &#47;= rem 2 4</code>.  One will be equal to zero while the other will be two."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 6, "creation_date": 1446686262, "post_id": 33533257, "comment_id": 54851528, "body": "I think a better term to use is <i>symmetric</i>."}, {"owner": {"reputation": 1891, "user_id": 45160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fe6d04c7c6a357a92a2b05efd0d09bc?s=128&d=identicon&r=PG", "display_name": "Vanson Samuel", "link": "https://stackoverflow.com/users/45160/vanson-samuel"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1446686453, "post_id": 33533257, "comment_id": 54851573, "body": "@ThomasM.DuBuisson I am talking about the change in elem_by. This change should not be a problem for me because if <code>x `eq` y</code>, then <code>y `eq` x</code> for all Int.  So this change in elem_by would not be the cause of my issue."}, {"owner": {"reputation": 1891, "user_id": 45160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fe6d04c7c6a357a92a2b05efd0d09bc?s=128&d=identicon&r=PG", "display_name": "Vanson Samuel", "link": "https://stackoverflow.com/users/45160/vanson-samuel"}, "edited": false, "score": 0, "creation_date": 1446686497, "post_id": 33533257, "comment_id": 54851584, "body": "@ErikR a better term for what?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 1891, "user_id": 45160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fe6d04c7c6a357a92a2b05efd0d09bc?s=128&d=identicon&r=PG", "display_name": "Vanson Samuel", "link": "https://stackoverflow.com/users/45160/vanson-samuel"}, "edited": false, "score": 5, "creation_date": 1446691546, "post_id": 33533257, "comment_id": 54852792, "body": "@VansonSamuel Are we talking past each other?  In your use, <code>eq = (\\x y -&gt; x `rem` y == 0)</code>.  The change in <code>elem_by</code> means for your use to not have an issue the property <code>(x `rem` y == 0) == (y `rem` x == 0)</code> must hold.  I await your proof that such a property holds ;-)."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 14, "last_activity_date": 1446675936, "creation_date": 1446675936, "answer_id": 33533257, "question_id": 33531834, "link": "https://stackoverflow.com/questions/33531834/nubby-is-not-working-as-expected/33533257#33533257", "title": "nubBy is not working as expected", "body": "<p>What changed between base-4.7.x and base-4.8.0.0 is the definition of <code>elem_by</code> which is what <code>nubBy</code> is defined in terms of.</p>\n\n<p>In base-4.7 <code>elem_by</code> has this clause:</p>\n\n<pre><code>elem_by eq y (x:xs)     =  y `eq` x || elem_by eq y xs\n</code></pre>\n\n<p>and in base-4.8 it was changed to:</p>\n\n<pre><code>elem_by eq y (x:xs)     =  x `eq` y || elem_by eq y xs\n</code></pre>\n\n<p>The history of this change is documented in these TRAC issues:</p>\n\n<ul>\n<li><a href=\"https://ghc.haskell.org/trac/ghc/ticket/2528\" rel=\"noreferrer\">2528</a></li>\n<li><a href=\"https://ghc.haskell.org/trac/ghc/ticket/3280\" rel=\"noreferrer\">3280</a></li>\n<li><a href=\"https://ghc.haskell.org/trac/ghc/ticket/7913\" rel=\"noreferrer\">7913</a></li>\n</ul>\n\n<p>Note that the Haskell Report Prelude version of <code>nubBy</code> is:</p>\n\n<pre><code>nubBy eq (x:xs)         =  x : nubBy eq (filter (\\ y -&gt; not (eq x y)) xs)\n</code></pre>\n\n<p>which was at odds with the base-4.7 implementation, so that also explains the change.</p>\n"}, {"comments": [{"owner": {"reputation": 1891, "user_id": 45160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fe6d04c7c6a357a92a2b05efd0d09bc?s=128&d=identicon&r=PG", "display_name": "Vanson Samuel", "link": "https://stackoverflow.com/users/45160/vanson-samuel"}, "edited": false, "score": 0, "creation_date": 1446682867, "post_id": 33534533, "comment_id": 54850519, "body": "You&#39;d call this a bug in GHC base?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 1891, "user_id": 45160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fe6d04c7c6a357a92a2b05efd0d09bc?s=128&d=identicon&r=PG", "display_name": "Vanson Samuel", "link": "https://stackoverflow.com/users/45160/vanson-samuel"}, "edited": false, "score": 0, "creation_date": 1446684939, "post_id": 33534533, "comment_id": 54851128, "body": "Certainly. First, define &quot;bug&quot; as behavior contrary to the Haskell Language specification.  Second, notice this behavior was contrary.  Third, shout &quot;bug&quot;."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 3, "creation_date": 1446724527, "post_id": 33534533, "comment_id": 54867638, "body": "<code>(\\x y -&gt; rem (max x y) (min x y) == 0)</code> might be symmetric, but it is still not an equivalency relation."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1446738482, "post_id": 33534533, "comment_id": 54877476, "body": "Yes, I was careful to merely call the behavior &quot;stable&quot;."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 3, "last_activity_date": 1446685259, "last_edit_date": 1446685259, "creation_date": 1446682562, "answer_id": 33534533, "question_id": 33531834, "link": "https://stackoverflow.com/questions/33531834/nubby-is-not-working-as-expected/33534533#33534533", "title": "nubBy is not working as expected", "body": "<p>The order of the arguments have been flipped, it seems, in the new base.  EDIT: I called this a bug, but as another answer points out the old behavior was the incorrect order.</p>\n\n<p>You can see the order has been flipped by observing:</p>\n\n<pre><code>&gt; print . take 5 . nubBy (\\x y -&gt; trace (show (x,y)) $ x `rem` y == 0) $ [2..]\n[2(2,3)\n,3(3,4)\n(2,4)\n,4(4,5)\n(3,5)\n(2,5)\n</code></pre>\n\n<p>Certainly <code>rem 2 4</code> does not equal zero (it equals 2), so it yields <code>4</code>.</p>\n\n<p>Notice you get the result you desire when you flip the argument order in the lambda:</p>\n\n<pre><code>&gt; print . take 5 . nubBy (\\x y -&gt; trace (show (x,y)) $ y `rem` x == 0) $ [2..]\n[2(2,3)\n,3(3,4)\n(2,4)\n(3,5)\n(2,5)\n....\n</code></pre>\n\n<p>EDIT: Since discussion indicates the relation is supposed to be equality and operate regardless of the order (and I'm too lazy to look at the report right now) notice you can compare the arguments first and get stable behavior either way:</p>\n\n<pre><code>print . take 100 . nubBy (\\x y -&gt; rem (max x y) (min x y) == 0) $ [2..]\n</code></pre>\n"}], "owner": {"reputation": 1891, "user_id": 45160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fe6d04c7c6a357a92a2b05efd0d09bc?s=128&d=identicon&r=PG", "display_name": "Vanson Samuel", "link": "https://stackoverflow.com/users/45160/vanson-samuel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 293, "favorite_count": 0, "accepted_answer_id": 33533257, "answer_count": 2, "score": 6, "last_activity_date": 1446685259, "creation_date": 1446670545, "last_edit_date": 1446675280, "question_id": 33531834, "link": "https://stackoverflow.com/questions/33531834/nubby-is-not-working-as-expected", "title": "nubBy is not working as expected", "body": "<p>The function below should generate prime numbers however it does not for GHC 7.10.2.  Is anybody else seeing this?</p>\n\n<pre><code>GHCi, version 7.10.2: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; import Data.List\nPrelude Data.List&gt; print . take 100 . nubBy (\\x y -&gt; x `rem` y == 0) $ [2..]\n[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101]\n</code></pre>\n\n<p>The strange part is that it seems to work fine on this site:</p>\n\n<p><a href=\"http://rextester.com/LWZCQ71376\" rel=\"noreferrer\">rextester.com/LWZCQ71376</a></p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 960, "user_id": 1683935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/35d781e6fc5bbc6c2b825a6b74d3f50e?s=128&d=identicon&r=PG", "display_name": "AmirHossein", "link": "https://stackoverflow.com/users/1683935/amirhossein"}, "edited": false, "score": 0, "creation_date": 1446760432, "post_id": 33531497, "comment_id": 54890779, "body": "Thank you, it was the problem  /opt/ghc/7.8.4/lib/ghc-7.8.4/package.conf.d    transformers-0.3.0.0 /home/bandbaz/.ghc/x86_64-linux-7.8.4/package.conf.d    transformers-0.4.3.0"}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 4, "last_activity_date": 1446669345, "creation_date": 1446669345, "answer_id": 33531497, "question_id": 33531373, "link": "https://stackoverflow.com/questions/33531373/resourcet-monadtrans-instance-not-available/33531497#33531497", "title": "ResourceT, MonadTrans instance not available", "body": "<p>Most likely you have two copies of the transformers package installed (you can test that with <code>ghc-pkg list transformers</code>). I wrote a blog post detailing this at:</p>\n\n<p><a href=\"http://www.yesodweb.com/blog/2014/09/woes-multiple-package-versions\" rel=\"nofollow\">http://www.yesodweb.com/blog/2014/09/woes-multiple-package-versions</a></p>\n\n<p>My recommendation: install your packages with <a href=\"https://github.com/commercialhaskell/stack#readme\" rel=\"nofollow\">Stack</a> and then run your file with <code>stack runghc yourfile.hs</code>, which will ensure a consistent set of packages.</p>\n"}], "owner": {"reputation": 960, "user_id": 1683935, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/35d781e6fc5bbc6c2b825a6b74d3f50e?s=128&d=identicon&r=PG", "display_name": "AmirHossein", "link": "https://stackoverflow.com/users/1683935/amirhossein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "accepted_answer_id": 33531497, "answer_count": 1, "score": 2, "last_activity_date": 1446675120, "creation_date": 1446668878, "last_edit_date": 1446675120, "question_id": 33531373, "link": "https://stackoverflow.com/questions/33531373/resourcet-monadtrans-instance-not-available", "title": "ResourceT, MonadTrans instance not available", "body": "<p>Running <em>Linux Mint 17.2 Rafaela</em> and <em>GHC 7.8.4</em> with <em>ResourceT 1.1.6</em>, I was trying to write a simple \"Hello World\":</p>\n\n<pre><code>import Control.Monad.Trans.Resource\nimport Control.Monad.Trans.Class\n\nmain = runResourceT $ lift (putStrLn \"Hello, World!\")\n</code></pre>\n\n<p>but:</p>\n\n<pre><code>No instance for (Control.Monad.Trans.Class.MonadTrans\n                   Control.Monad.Trans.Resource.Internal.ResourceT)\n  arising from a use of \u2018Control.Monad.Trans.Class.lift\u2019\nIn the second argument of \u2018(GHC.Base.$)\u2019, namely\n  \u2018Control.Monad.Trans.Class.lift\n     (System.IO.putStrLn \"Hello, World!\")\u2019\nIn the expression:\n  Control.Monad.Trans.Resource.runResourceT\n  GHC.Base.$\n    Control.Monad.Trans.Class.lift (System.IO.putStrLn \"Hello, World!\")\nIn an equation for \u2018Main.main\u2019:\n    Main.main\n      = Control.Monad.Trans.Resource.runResourceT\n        GHC.Base.$\n          Control.Monad.Trans.Class.lift (System.IO.putStrLn \"Hello, World!\")\n</code></pre>\n\n<p>As the error message shows, the <code>MonadTrans ResourceT</code> thing is not defined but it is clearly defined in the <a href=\"https://hackage.haskell.org/package/resourcet-1.1.6/docs/Control-Monad-Trans-Resource.html\" rel=\"nofollow\">Control.Monad.Trans.Resource</a> module and it is imported!</p>\n\n<p>A little more strange thing is that inspecting the module in ghci:</p>\n\n<pre><code>Prelude Control.Monad.Trans.Resource Control.Monad.Trans.Class&gt; :i ResourceT \ntype role ResourceT representational nominal\nnewtype ResourceT (m :: * -&gt; *) a\n  = Control.Monad.Trans.Resource.Internal.ResourceT {Control.Monad.Trans.Resource.Internal.unResourceT :: GHC.IORef.IORef\n                                                                                                            Control.Monad.Trans.Resource.Internal.ReleaseMap\n                                                                                                          -&gt; m a}\n    -- Defined in \u2018Control.Monad.Trans.Resource.Internal\u2019\ninstance [safe] Monad m =&gt; Monad (ResourceT m)\n  -- Defined in \u2018Control.Monad.Trans.Resource.Internal\u2019\ninstance [safe] Functor m =&gt; Functor (ResourceT m)\n  -- Defined in \u2018Control.Monad.Trans.Resource.Internal\u2019\ninstance [safe] (MonadThrow m, Control.Monad.Base.MonadBase IO m,\n                 transformers-0.3.0.0:Control.Monad.IO.Class.MonadIO m,\n                 Control.Applicative.Applicative m) =&gt;\n                MonadResource (ResourceT m)\n  -- Defined in \u2018Control.Monad.Trans.Resource.Internal\u2019\ninstance [safe] MonadBaseControl b m =&gt;\n                MonadBaseControl b (ResourceT m)\n  -- Defined in \u2018Control.Monad.Trans.Resource.Internal\u2019\ninstance [safe] MonadThrow m =&gt; MonadThrow (ResourceT m)\n  -- Defined in \u2018Control.Monad.Trans.Resource.Internal\u2019\n</code></pre>\n\n<p>And as it shows there is no <code>MonadTrans ResourceT</code> thing even there.</p>\n"}, {"tags": ["list", "haskell", "list-comprehension"], "answers": [{"comments": [{"owner": {"reputation": 630, "user_id": 4913220, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/NjkLC.jpg?s=128&g=1", "display_name": "Vlad Balanescu", "link": "https://stackoverflow.com/users/4913220/vlad-balanescu"}, "edited": false, "score": 0, "creation_date": 1446662316, "post_id": 33529357, "comment_id": 54840538, "body": "What about finding the predecessor. That one worked!"}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1446662914, "post_id": 33529357, "comment_id": 54840860, "body": "Do the counterpart.  <code>last $ takeWhile (&#47;= crd) pck</code>"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1446661784, "creation_date": 1446661784, "answer_id": 33529357, "question_id": 33529179, "link": "https://stackoverflow.com/questions/33529179/next-element-in-a-list/33529357#33529357", "title": "Next element in a list", "body": "<p>Hint: use <code>dropWhile (/= crd) pck</code> to remove all the cards from the beginning until your card is found. Then, the first card remaining is <code>crd</code>. The one after that is the one you want.</p>\n\n<p>Still, if <code>pck</code> is a deck in a <em>standard order</em>, looping over the whole deck to find the next card seems to be quite inefficient.</p>\n"}, {"tags": [], "owner": {"reputation": 523, "user_id": 1739395, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f6877c2a0e8b24a4b4c9b4700d33846e?s=128&d=identicon&r=PG", "display_name": "the-konapie", "link": "https://stackoverflow.com/users/1739395/the-konapie"}, "is_accepted": false, "score": 3, "last_activity_date": 1446663311, "last_edit_date": 1446663311, "creation_date": 1446662549, "answer_id": 33529592, "question_id": 33529179, "link": "https://stackoverflow.com/questions/33529179/next-element-in-a-list/33529592#33529592", "title": "Next element in a list", "body": "<p>You can make you your <code>Card</code> type instantiate the <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#t:Enum\" rel=\"nofollow\"><code>Enum</code></a> typeclass by <code>deriving Enum</code>, then use the <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#v:succ\" rel=\"nofollow\"><code>succ</code></a> function to get the successor card.\nNote that passing the last card of the deck to <code>succ</code> will result in a runtime error, though it looks like your first <code>pCard</code> function body will account for that.</p>\n\n<p>I just noticed that your <code>Card</code> type appears to be a tuple; I'm guessing you defined <code>Card</code> using the <code>type</code> keyword? In which case the solution I proposed above won't work without using GHC extensions.</p>\n"}], "owner": {"reputation": 630, "user_id": 4913220, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/NjkLC.jpg?s=128&g=1", "display_name": "Vlad Balanescu", "link": "https://stackoverflow.com/users/4913220/vlad-balanescu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 650, "favorite_count": 0, "accepted_answer_id": 33529357, "answer_count": 2, "score": 2, "last_activity_date": 1604900493, "creation_date": 1446661127, "last_edit_date": 1604900493, "question_id": 33529179, "link": "https://stackoverflow.com/questions/33529179/next-element-in-a-list", "title": "Next element in a list", "body": "<p>I have a function in Haskell which returns me the successor of a card. I know how to access the card, using list comprehension, but not quite sure how to get the next card, so pos+1. Here is my code:</p>\n<pre><code>pCard :: Card-&gt;Deck-&gt;Card\npCard (K,C) _ = (A,S) --exception for last card\npCard crd pck = head [p | (pos,p) &lt;- (zip [0..51] pck), crd==p]\n</code></pre>\n"}, {"tags": ["haskell", "types", "typeclass"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1446649709, "post_id": 33525159, "comment_id": 54831693, "body": "&quot;gives the result needed&quot; \u2014 how do you obtain it?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1446649886, "post_id": 33525159, "comment_id": 54831821, "body": "Hint: Integral is not a type, and you don&#39;t have to understand it in order to solve this assignment. Just ignore it for now."}, {"owner": {"reputation": 604, "user_id": 5353712, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3786108965edf49a986898c82ab8bfa?s=128&d=identicon&r=PG&f=1", "display_name": "Banana", "link": "https://stackoverflow.com/users/5353712/banana"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1446650009, "post_id": 33525159, "comment_id": 54831899, "body": "Well i do have to get it according to the signature and i can&#39;t figure out how can i get it. My current :t gives out [a] -&gt; [a]"}, {"owner": {"reputation": 604, "user_id": 5353712, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3786108965edf49a986898c82ab8bfa?s=128&d=identicon&r=PG&f=1", "display_name": "Banana", "link": "https://stackoverflow.com/users/5353712/banana"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1446650084, "post_id": 33525159, "comment_id": 54831960, "body": "@n.m. I called it out to test: myList (take 100 [1,2..])"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 2, "creation_date": 1446650266, "post_id": 33525159, "comment_id": 54832103, "body": "The code you wrote is a <i>function</i> that alters an existing list. The requirement appears to be to produce a list, not modify an existing one."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1446650319, "post_id": 33525159, "comment_id": 54832142, "body": "Good. Do you know what will happen if you call just <code>myList [1,2..]</code>?"}, {"owner": {"reputation": 604, "user_id": 5353712, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3786108965edf49a986898c82ab8bfa?s=128&d=identicon&r=PG&f=1", "display_name": "Banana", "link": "https://stackoverflow.com/users/5353712/banana"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1446650433, "post_id": 33525159, "comment_id": 54832239, "body": "@MathematicalOrchid I understand what you meant however i don&#39;t understand the importance of this thing. Also i do not have any clue how to do it in this manner."}, {"owner": {"reputation": 604, "user_id": 5353712, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3786108965edf49a986898c82ab8bfa?s=128&d=identicon&r=PG&f=1", "display_name": "Banana", "link": "https://stackoverflow.com/users/5353712/banana"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1446650574, "post_id": 33525159, "comment_id": 54832346, "body": "@n.m. Well then it will work for infinite time in the same way. The take 100 is just to see whether it works or not. The question is how should i rewrite it so it would be according to the signature (If we don&#39;t have it by the correct signature we will be graded with 0 points even if we get the right solution)."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1446650861, "post_id": 33525159, "comment_id": 54832533, "body": "Great, you are almost there. You could have tested it this way instead: <code>take 100 (myList [1,2..])</code>. Incidentally, this means that <code>myList</code> could be made simpler, as it only ever needs to see infinite lists. Thus, no need to provide <code>[]</code> and <code>[x]</code> cases. OK?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1446651104, "post_id": 33525159, "comment_id": 54832723, "body": "Your function still has a wrong signature. Let&#39;s rename it to <code>wrongList</code>. Now you have this expression <code>wrongList [1,2..]</code> that is exactly the list you need, which is <code>myList</code>. What you have to do now is write an <i>equation</i> that states just this fact."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1446651324, "post_id": 33525159, "comment_id": 54832909, "body": "<code>myList = [2,5..] &gt;&gt;= \\k -&gt; [k,k+1,k-1]</code>"}, {"owner": {"reputation": 604, "user_id": 5353712, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3786108965edf49a986898c82ab8bfa?s=128&d=identicon&r=PG&f=1", "display_name": "Banana", "link": "https://stackoverflow.com/users/5353712/banana"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1446651522, "post_id": 33525159, "comment_id": 54833074, "body": "Just between these two, wrongList and myList @n.m.? Okay i tested and it gave me an :: Integer as a signature when i did myList = wrongList [1,2..]. I may have misunderstood you.."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1446652818, "post_id": 33525159, "comment_id": 54834034, "body": "<code>myList = wrongList [1,2..]</code> should be exactly what you need. What exact output you are getting from ghci?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1446652864, "post_id": 33525159, "comment_id": 54834079, "body": "@user2407038 Great, now explain <code>&gt;&gt;=</code> like I&#39;m five."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1446686182, "post_id": 33525159, "comment_id": 54851506, "body": "@Banana: off topic, but since you mentioned Haskell &amp; Prolog together, do you know about FLP (Functional Logic Programming)? A prominet example of an FLP language, which I happen to be studying currently, would be <a href=\"http://www-ps.informatik.uni-kiel.de/kics2/\" rel=\"nofollow noreferrer\">Curry</a> (tag: <a href=\"https://stackoverflow.com/questions/tagged/curry\">curry</a>)."}], "answers": [{"comments": [{"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 1, "creation_date": 1446657104, "post_id": 33526625, "comment_id": 54837162, "body": "&quot;If the assignment demands a function of type Integral a =&gt; [a] -&gt; [a],&quot; The assignment asks for <code>Integral a =&gt; [a]</code> though - not a function."}, {"owner": {"reputation": 604, "user_id": 5353712, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3786108965edf49a986898c82ab8bfa?s=128&d=identicon&r=PG&f=1", "display_name": "Banana", "link": "https://stackoverflow.com/users/5353712/banana"}, "edited": false, "score": 0, "creation_date": 1446659183, "post_id": 33526625, "comment_id": 54838555, "body": "Thanks for the explanation and answer :)"}, {"owner": {"reputation": 604, "user_id": 5353712, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3786108965edf49a986898c82ab8bfa?s=128&d=identicon&r=PG&f=1", "display_name": "Banana", "link": "https://stackoverflow.com/users/5353712/banana"}, "edited": false, "score": 0, "creation_date": 1446660295, "post_id": 33526625, "comment_id": 54839333, "body": "Just a stupid follow up question. If i set the type: myList :: Integral a =&gt; [a] -&gt; [a] in a .hs file, I get an error. Is this in there for illustration or have i done something wrong."}, {"owner": {"reputation": 604, "user_id": 5353712, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3786108965edf49a986898c82ab8bfa?s=128&d=identicon&r=PG&f=1", "display_name": "Banana", "link": "https://stackoverflow.com/users/5353712/banana"}, "edited": false, "score": 0, "creation_date": 1446660351, "post_id": 33526625, "comment_id": 54839370, "body": "Ambigious occurrence &#39;null&#39;: It could either refer to &#39;Data.List.null&#39; or &#39;Data.Set.null&#39;"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1446661121, "post_id": 33526625, "comment_id": 54839863, "body": "Don&#39;t import Data.Set"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 604, "user_id": 5353712, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3786108965edf49a986898c82ab8bfa?s=128&d=identicon&r=PG&f=1", "display_name": "Banana", "link": "https://stackoverflow.com/users/5353712/banana"}, "edited": false, "score": 0, "creation_date": 1446675879, "post_id": 33526625, "comment_id": 54848071, "body": "@Banana: we&#39;d have to see the error in full, together with the source code (in case you haven&#39;t nailed it by now). @sepp2k: right you are \u2014 I took a look at the implementation of <code>myList</code> and saw it was a function; that, combined with the rest of the information in the post (except the signature at the very beginning), lead me to assume the OP did indeed mean a function. However, nonetheless, it&#39;s trivial to adapt the answer to get the right solution."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1446687384, "post_id": 33526625, "comment_id": 54851804, "body": "I don&#39;t see how your solution can typecheck. <code>[1..] :: (Num a, Enum a) =&gt; [a]</code>. You probably want to fix <code>a ~ Int</code> and map <code>fromIntegral</code> over the result. Then you can manually restrict it to <code>Integral n</code> from <code>Num n</code> if you like."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1446687607, "post_id": 33526625, "comment_id": 54851848, "body": "<code>:i Integral</code> shows <code>(Real a, Enum a) =&gt; Integral a</code> and of course <code>(Num a, Ord a) =&gt; Real a</code>... so what do you mean? The snippet typechecks and runs exactly as advertised."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1446687859, "post_id": 33526625, "comment_id": 54851909, "body": "I had no idea <code>Enum a =&gt; Integral a</code>. Oops!"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1446687989, "post_id": 33526625, "comment_id": 54851942, "body": "Well it&#39;s kind of obvious if you recall that the <code>succ</code> and <code>pred</code> operations are quite fundamental to integer values, at least considering the Peano representation..."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1446688178, "post_id": 33526625, "comment_id": 54851996, "body": "The <code>Enum</code> class is so badly broken I tend to do my best to pretend it doesn&#39;t even exist."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1446688203, "post_id": 33526625, "comment_id": 54852002, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/94265/discussion-between-erik-allik-and-dfeuer\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": true, "score": 5, "last_activity_date": 1446718073, "last_edit_date": 1446718073, "creation_date": 1446653451, "answer_id": 33526625, "question_id": 33525159, "link": "https://stackoverflow.com/questions/33525159/understand-and-use-the-basic-concept-of-haskells-integral-typeclass/33526625#33526625", "title": "Understand and use the basic concept of Haskell&#39;s Integral typeclass", "body": "<p>The function (the implementation of which you got perfectly right, as a matter of fact)</p>\n\n<pre><code>myList (x:y:z:xs) = y:z:x:(myList xs)\nmyList []         = []\nmyList [x]        = [x]\n</code></pre>\n\n<p>is generic enough not to depend on the type of the elements in the list to be <code>Integral a =&gt; a</code>. So if you let Haskell infer its type, it will infer <code>[a] -&gt; [a]</code>. If you constraint the type to <code>Integral a =&gt; [a] -&gt; [a]</code>, it will still work, but be less generic, which will limit uses to just integral types.</p>\n\n<hr>\n\n<p>Here's a demonstration of the principle:</p>\n\n<pre><code>Prelude&gt; :{\nPrelude| let myList (x:y:z:xs) = y:z:x:(myList(xs))\nPrelude|     myList [] = []\nPrelude|     myList [x] = [x]\nPrelude| :}\nPrelude&gt; :t myList\nmyList :: [a] -&gt; [a]\n\nPrelude&gt; take 15 $ myList ['a'..]\n\"bcaefdhigkljnom\"\nPrelude&gt; take 15 $ myList [1..]\n[2,3,1,5,6,4,8,9,7,11,12,10,14,15,13]\n</code></pre>\n\n<p>but</p>\n\n<pre><code>Prelude&gt; :{\nPrelude| let myList :: Integral a =&gt; [a] -&gt; [a]\nPrelude|     myList (x:y:z:xs) = y:z:x:(myList(xs))\nPrelude|     myList [] = []\nPrelude|     myList [x] = [x]\nPrelude| :}\nPrelude&gt; :t myList\nmyList :: Integral a =&gt; [a] -&gt; [a]\n\nPrelude&gt; take 15 $ myList [1..]\n[2,3,1,5,6,4,8,9,7,11,12,10,14,15,13]\n\nPrelude&gt; take 15 $ myList ['a'..]    \n&lt;interactive&gt;:34:11:\n    No instance for (Integral Char) arising from a use of \u2018myList\u2019\n    In the second argument of \u2018($)\u2019, namely \u2018myList ['a' .. ]\u2019\n    In the expression: take 15 $ myList ['a' .. ]\n    In an equation for \u2018it\u2019: it = take 15 $ myList ['a' .. ]\n</code></pre>\n\n<hr>\n\n<p><strong>So the point is</strong>, both definitions are equivalent and capable of doing the same thing just as well as the other, but the constrained type signature is (and I'd say unjustifiably) less useful than the one with the general type signature.</p>\n\n<p>If the assignment demands a function of type <code>Integral a =&gt; [a] -&gt; [a]</code>, all you really need to do is simply annotate the function you already have with exactly that type signature. There is, however, no (reasonable/rational) way  to somehow guide Haskell to infer that type from the function definition, as that would necessitate somehow indirectly indicating that the list must contain values of a type that support the operations in <code>Integral</code> ... yada yada.</p>\n\n<p><strong>As a final note</strong>: you got the implementation/algorithm perfectly right, but fell short on type signatures and the notion of generality.</p>\n\n<hr>\n\n<p><strong>EDIT:</strong> if what you actually need is not a function but a list (your question is a bit ambiguous in this respect), all you need to do is rename the below definition of <code>myList</code> to e.g. <code>myList'</code> or <code>go</code> (which I think is quite a typical name for nested recursive helpers) or something (which can but doesn't have to be an hidden within the list <code>myList</code>) and then pass <code>[1..]</code> to it, assigning the result to <code>myList</code>:</p>\n\n<pre><code>myList :: Integral a =&gt; [a]\nmyList = go [1..]\n  where go (x:y:z:xs) = y:z:x:(go xs)\n        go []         = []\n        go [x]        = [x]\n</code></pre>\n\n<p>of course looked this way, <code>Integral a =&gt; [a]</code> <em>is</em> indeed quite general a signature for the list (but not the most general, which would be <code>(Enum a, Num a) =&gt; [a]</code> as I was led to realize by dfeuer's comment), because the type <code>a</code> cannot be determined by the type of the input passed to the function, because you're always passing <code>[1..]</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 0, "last_activity_date": 1446666764, "creation_date": 1446666764, "answer_id": 33530812, "question_id": 33525159, "link": "https://stackoverflow.com/questions/33525159/understand-and-use-the-basic-concept-of-haskells-integral-typeclass/33530812#33530812", "title": "Understand and use the basic concept of Haskell&#39;s Integral typeclass", "body": "<p>If we want to give an answer with the right signature <em>without</em> supplying any signatures by hand, we have to look at the Integral class and look which methods it implements. Applying any such method is likely to force the right signature.</p>\n\n<pre><code>Prelude&gt; :i Integral\nclass (Real a, Enum a) =&gt; Integral a where\n  quot :: a -&gt; a -&gt; a\n  rem :: a -&gt; a -&gt; a\n  div :: a -&gt; a -&gt; a\n  mod :: a -&gt; a -&gt; a\n  quotRem :: a -&gt; a -&gt; (a, a)\n  divMod :: a -&gt; a -&gt; (a, a)\n  toInteger :: a -&gt; Integer\n</code></pre>\n\n<p>Since our sequence has something to do with remainders of division by 3, <code>div</code> and <code>mod</code> look promising.</p>\n\n<p>After some fiddling with arithmetic, we arrive at something like</p>\n\n<pre><code>Prelude&gt; let myList = map (\\x -&gt; x - x `mod` 3 + (x+2) `mod` 3 + 1) [0..]\nPrelude&gt; :t myList\nmyList :: Integral b =&gt; [b]\n</code></pre>\n"}], "owner": {"reputation": 604, "user_id": 5353712, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c3786108965edf49a986898c82ab8bfa?s=128&d=identicon&r=PG&f=1", "display_name": "Banana", "link": "https://stackoverflow.com/users/5353712/banana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 1, "accepted_answer_id": 33526625, "answer_count": 2, "score": 1, "last_activity_date": 1446718073, "creation_date": 1446649475, "last_edit_date": 1446686414, "question_id": 33525159, "link": "https://stackoverflow.com/questions/33525159/understand-and-use-the-basic-concept-of-haskells-integral-typeclass", "title": "Understand and use the basic concept of Haskell&#39;s Integral typeclass", "body": "<p>I'm taking a course which focuses on Haskell &amp; Prolog and there's an upcoming test for which i'm studying.</p>\n\n<p>We're given a signature:</p>\n\n<pre><code>myList\n  :: (Integral a)\n  =&gt; [a]\n</code></pre>\n\n<p>And we have to create a variable <code>myList</code> which will return an infinite list which is different from standard positive integer list by changing the position of every third element by moving it two positions to the right, starting from the first one.</p>\n\n<p>So for example, the beginning would look like:\n<code>2,3,1,5,6,4,8,9,7..</code> on a standard list which contains positive elements.</p>\n\n<p>I tried to solve this with a code like this:</p>\n\n<pre><code>myList (x:y:z:xs)\n  = y:z:x:(myList(xs))\nmyList [] = []\nmyList [x] = [x]\n</code></pre>\n\n<p>It gives the result needed but it's not following the signature. Could someone explain how to solve it so it would fit the signature and why it does.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1446662121, "post_id": 33523599, "comment_id": 54840432, "body": "Look at <code>doubleUs2</code> again carefully."}], "answers": [{"tags": [], "owner": {"reputation": 45741, "user_id": 744178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3193139ea494c45e63752504f5ff1f2?s=128&d=identicon&r=PG", "display_name": "jwodder", "link": "https://stackoverflow.com/users/744178/jwodder"}, "is_accepted": false, "score": 5, "last_activity_date": 1446645249, "creation_date": 1446645249, "answer_id": 33523647, "question_id": 33523599, "link": "https://stackoverflow.com/questions/33523599/order-of-function-applications/33523647#33523647", "title": "Order of function applications", "body": "<p>Function application has higher precedence than <code>+</code> and other operators, so <code>doubleMe x+y</code> is parsed as <code>(doubleMe x)+y</code>.  To fix this, write <code>doubleMe (x+y)</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 27, "user_id": 3050565, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8ef3471dcb090d4b1347855aac665855?s=128&d=identicon&r=PG&f=1", "display_name": "user3050565", "link": "https://stackoverflow.com/users/3050565/user3050565"}, "edited": false, "score": 0, "creation_date": 1446645841, "post_id": 33523652, "comment_id": 54828812, "body": "fair enough but when I try to compile this code, i get this: [1 of 1] Compiling Main             ( double.hs, interpreted )  double.hs:8:14:     Illegal type signature: \u2018x y\u2019       Perhaps you intended to use ScopedTypeVariables     In a pattern type-signature  double.hs:8:30: Not in scope: \u2018x\u2019  double.hs:8:32: Not in scope: \u2018y\u2019 Failed, modules loaded: none."}, {"owner": {"reputation": 1953, "user_id": 899723, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f68bcc2d6f5196fa090d578eb8356b9c?s=128&d=identicon&r=PG", "display_name": "mac10688", "link": "https://stackoverflow.com/users/899723/mac10688"}, "edited": false, "score": 0, "creation_date": 1446646119, "post_id": 33523652, "comment_id": 54828988, "body": "Can you edit your original post and append to it, your new code that is causing the new compiling error?"}, {"owner": {"reputation": 10220, "user_id": 2720372, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/olQxk.jpg?s=128&g=1", "display_name": "w.b", "link": "https://stackoverflow.com/users/2720372/w-b"}, "reply_to_user": {"reputation": 27, "user_id": 3050565, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8ef3471dcb090d4b1347855aac665855?s=128&d=identicon&r=PG&f=1", "display_name": "user3050565", "link": "https://stackoverflow.com/users/3050565/user3050565"}, "edited": false, "score": 0, "creation_date": 1446646913, "post_id": 33523652, "comment_id": 54829589, "body": "@user3050565 it works for me, probably there&#39;s a typographical error in your <code>double.hs</code>"}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "reply_to_user": {"reputation": 27, "user_id": 3050565, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8ef3471dcb090d4b1347855aac665855?s=128&d=identicon&r=PG&f=1", "display_name": "user3050565", "link": "https://stackoverflow.com/users/3050565/user3050565"}, "edited": false, "score": 2, "creation_date": 1446647777, "post_id": 33523652, "comment_id": 54830196, "body": "@user3050565 <code>doubleUs2 :: x y = doubleMe (x+y)</code> should read ` <code>doubleUs2 x y = doubleMe (x+y)</code> (notice the lack of <code>::</code>)."}], "tags": [], "owner": {"reputation": 10220, "user_id": 2720372, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/olQxk.jpg?s=128&g=1", "display_name": "w.b", "link": "https://stackoverflow.com/users/2720372/w-b"}, "is_accepted": false, "score": 5, "last_activity_date": 1446645261, "creation_date": 1446645261, "answer_id": 33523652, "question_id": 33523599, "link": "https://stackoverflow.com/questions/33523599/order-of-function-applications/33523652#33523652", "title": "Order of function applications", "body": "<p>Due to function application precedence you should use parentheses, also your <code>doubleUs</code> declaration is wrong as it takes two <code>Int</code>s:</p>\n\n<pre><code>doubleUs :: Int -&gt; Int -&gt; Int\ndoubleUs x y = doubleMe (x+y)\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 3050565, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8ef3471dcb090d4b1347855aac665855?s=128&d=identicon&r=PG&f=1", "display_name": "user3050565", "link": "https://stackoverflow.com/users/3050565/user3050565"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1446727363, "creation_date": 1446645075, "last_edit_date": 1446727363, "question_id": 33523599, "link": "https://stackoverflow.com/questions/33523599/order-of-function-applications", "title": "Order of function applications", "body": "<pre><code>doubleMe :: Int -&gt; Int\ndoubleMe x = x + x\n\ndoubleUs :: Int -&gt; Int\ndoubleUs x y = doubleMe x+y\n</code></pre>\n\n<p>I'm trying to makes use of the function <code>doubleMe</code> to get double of sum of <code>x</code> and <code>y</code>. What am I doing wrong? </p>\n\n<p>new code that doesn't compile:</p>\n\n<pre><code>doubleMe :: Int -&gt; Int\ndoubleMe x = x + x\n\ndoubleUs :: Int -&gt; Int -&gt; Int\ndoubleUs x y = x*2 + y*2\n\ndoubleUs2 :: Int -&gt; Int -&gt; Int\ndoubleUs2 :: x y = doubleMe (x+y)\n</code></pre>\n"}, {"tags": ["haskell", "lazy-evaluation", "trace", "evaluation"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1446641140, "post_id": 33522279, "comment_id": 54825709, "body": "Put your code in the body of the question - it&#39;s not terribly long and the question would be much clearer if everything was in there."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 3, "creation_date": 1446641290, "post_id": 33522279, "comment_id": 54825796, "body": "yes it&#39;s because first you only had to force <code>v</code> to trace but the second one forces <code>a</code> too (remember <code>a</code> here is the rest of your expression ;) ) - and while it will eval this <code>a</code> all the other traces happen ;)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1446641455, "post_id": 33522279, "comment_id": 54825917, "body": "<i>note</i> that the second one is closer to what is happening - you really start with the last one, but as the <code>foldr</code> (or better the structure you return) is lazy this all will end up in a big thunk and will only get evaluated when you start doing your final show (of <code>&quot;1 _ 2 _ 3 _ 4 _ 5 _&quot;</code>)"}, {"owner": {"reputation": 27685, "user_id": 610979, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/ku5ga.png?s=128&g=1", "display_name": "Frank Schmitt", "link": "https://stackoverflow.com/users/610979/frank-schmitt"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1446641774, "post_id": 33522279, "comment_id": 54826134, "body": "@Carsten Sorry, I accidentally overwrote your edit - we edited both at the exact same timestamp. Feel free to roll back to your version; I&#39;ve posted at Meta regarding this, see <a href=\"http://meta.stackoverflow.com/questions/309441/simultaneous-editing-exact-same-timestamp-no-warning-when-overwriting-other\" title=\"simultaneous editing exact same timestamp no warning when overwriting other\">meta.stackoverflow.com/questions/309441/&hellip;</a>"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 27685, "user_id": 610979, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/ku5ga.png?s=128&g=1", "display_name": "Frank Schmitt", "link": "https://stackoverflow.com/users/610979/frank-schmitt"}, "edited": false, "score": 0, "creation_date": 1446642170, "post_id": 33522279, "comment_id": 54826393, "body": "@FrankSchmitt no problem ... it does not really matter where the pasted code is ;)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1446643319, "post_id": 33522279, "comment_id": 54827111, "body": "@Carsten nailed it. After all, you can&#39;t really expect the message &quot;[2] Adding v=1 to 2 _ 3 _ 4 _ 5 _&quot; to be printed before the tree &quot;2 _ 3 _ 4 _ 5 _&quot; is evaluated. So, &quot;2 _ 3 _ 4 _ 5 _&quot; will be evaluated first, but this triggers its own trace. Recursively, we have backward traces."}], "answers": [{"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 1, "last_activity_date": 1446728013, "creation_date": 1446728013, "answer_id": 33545078, "question_id": 33522279, "link": "https://stackoverflow.com/questions/33522279/why-does-printing-affects-order-when-right-folding-in-haskell/33545078#33545078", "title": "Why does printing affects order when right folding in Haskell?", "body": "<p>There's a lot of comments here, but nobody seems to have written an <em>answer</em>...</p>\n\n<p>The answer is of course the <code>show</code> function. When you say <code>x = add 5 myTree</code>, all you are in fact doing is setting <code>x</code> to be an unevaluated expression. <code>y = add 7 x</code> sets <code>y</code> to be yet another unevaluated expression, and so on. But when you try to <code>show y</code>... well, <code>y</code> depends on <code>x</code>, so first we must evaluate <code>x</code>. And <em>that</em> is why <code>trace</code> prints things out in the order that it does.</p>\n"}, {"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 1, "last_activity_date": 1446728538, "creation_date": 1446728538, "answer_id": 33545277, "question_id": 33522279, "link": "https://stackoverflow.com/questions/33522279/why-does-printing-affects-order-when-right-folding-in-haskell/33545277#33545277", "title": "Why does printing affects order when right folding in Haskell?", "body": "<p>Let's expand the <code>foldr</code> in</p>\n\n<pre><code>foldr verboseAdd2 Empty [1, 2, 3, 4, 5]\n</code></pre>\n\n<p>using its definition (abbreviating <code>verboseAdd2</code> as <code>va</code>):</p>\n\n<pre><code>1 `va` (2 `va` (3 `va` (4 `va` (5 `va` Empty))))\n</code></pre>\n\n<p>or, in this case, maybe it's simpler if we use prefix notation:</p>\n\n<pre><code>va 1 $ va 2 $ va 3 $ va 4 $ va 5 Empty\n</code></pre>\n\n<p>By the definition of <code>va</code>, this reduces to</p>\n\n<pre><code>let y1 = va 2 $ va 3 $ va 4 $ va 5 Empty\nin trace (\"Adding v=1 to \" ++ show y1) (add 1 y1)\n</code></pre>\n\n<p>By unrolling more occurrences of <code>va</code>, we get</p>\n\n<pre><code>let y4 = trace (\"Adding v=5 to \" ++ show Empty) (add 5 Empty) in\nlet y3 = trace (\"Adding v=4 to \" ++ show y4) (add 4 y4) in\nlet y2 = trace (\"Adding v=3 to \" ++ show y3) (add 3 y3) in\nlet y1 = trace (\"Adding v=2 to \" ++ show y2) (add 2 y2) in\ntrace (\"Adding v=1 to \" ++ show y1) (add 1 y1)\n</code></pre>\n\n<p>Hopefully you can see from this that to <code>show y1</code> in the outmost <code>trace</code>, we first need to evaluate <code>y1</code>, which causes <code>trace (\"Adding v=2 to \" ++ show y2\")</code> to fire, which forces <code>y3</code>, and so on, until we get to <code>y4</code>. The <code>trace</code> in <code>y4</code> doesn't need to force anything else, so it can finally print its message, then go on to evaluate <code>add 5 Empty</code>, which is then used by the <code>trace</code> in the definition of <code>y3</code>, and so on.</p>\n"}], "owner": {"reputation": 634, "user_id": 5093690, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a3c8f6b503d9ea35c843eda8d891479f?s=128&d=identicon&r=PG&f=1", "display_name": "qwe", "link": "https://stackoverflow.com/users/5093690/qwe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 33545277, "answer_count": 2, "score": 3, "last_activity_date": 1446728538, "creation_date": 1446641003, "last_edit_date": 1446727766, "question_id": 33522279, "link": "https://stackoverflow.com/questions/33522279/why-does-printing-affects-order-when-right-folding-in-haskell", "title": "Why does printing affects order when right folding in Haskell?", "body": "<p>I'm sure it has something to do with lazy evaluation, but still, I just can't give myself an explanation of why it acts this way. Why does evaluating the right hand side in <code>verboseAdd2</code> reverse the debug traces output?</p>\n\n<p>This is the code:</p>\n\n<pre><code>import Debug.Trace\n\ndata BinaryTree = Empty | Node Int BinaryTree BinaryTree\n\ninstance Show BinaryTree where\n  show Empty = \"_\"\n  show (Node x Empty right) = unwords [           show x, show right]\n  show (Node x left  right) = unwords [show left, show x, show right]\n\nadd :: Int -&gt; BinaryTree -&gt; BinaryTree\nadd v Empty = Node v Empty Empty\nadd v a@(Node x left right)\n  | v == x = a\n  | v &lt;  x = Node x (add v left) right\n  | v &gt;  x = Node x left (add v right)\n\nverboseAdd :: Int -&gt; BinaryTree -&gt; BinaryTree\nverboseAdd v a = trace (\"[1] Adding v=\" ++ show v) (add v a)\n\nverboseAdd2 :: Int -&gt; BinaryTree -&gt; BinaryTree\nverboseAdd2 v a = trace (\"[2] Adding v=\" ++ show v ++ \" to \" ++ show a) (add v a)\n\nverbosePlus :: (Num a, Show a) =&gt; a -&gt; a -&gt; a\nverbosePlus left right = trace (show left ++ \" + \" ++ show right)\n                               (left + right)\n\nmain :: IO()\nmain = do\n  let seq = [1,2,3,4,5]\n  in do print $ foldr verbosePlus 0 seq\n        putStrLn \"\"\n        print $ foldr verboseAdd Empty seq\n        putStrLn \"\"\n        print $ foldr verboseAdd2 Empty seq\n</code></pre>\n\n<p>This is the output:</p>\n\n<pre><code>5 + 0\n4 + 5\n3 + 9\n2 + 12\n1 + 14\n15\n\n[1] Adding v=1\n[1] Adding v=2\n[1] Adding v=3\n[1] Adding v=4\n[1] Adding v=5\n1 _ 2 _ 3 _ 4 _ 5 _\n\n[2] Adding v=5 to _\n[2] Adding v=4 to 5 _\n[2] Adding v=3 to 4 _ 5 _\n[2] Adding v=2 to 3 _ 4 _ 5 _\n[2] Adding v=1 to 2 _ 3 _ 4 _ 5 _\n1 _ 2 _ 3 _ 4 _ 5 _\n</code></pre>\n"}, {"tags": ["haskell", "quickcheck"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1446638171, "post_id": 33521124, "comment_id": 54823742, "body": "just try in GHCi and see it yourself: <code>readExpr (show (Num 0.0))</code> and <code>Just (assoc (Num 0.0))</code> ... are those the same/equal? (I cannot tell as I don&#39;t see your <code>Show</code> decl.)"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1446639178, "post_id": 33521124, "comment_id": 54824414, "body": "Also, try <code>===</code> in <code>prop_ShowReadExpr</code> instead (and <code>prop_ShowReadExpr :: Expr -&gt; Property</code>). This will show how both values actually differ. Still without <code>expr</code> and <code>show</code> it&#39;s not clear where the actual error is."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1446640677, "post_id": 33521124, "comment_id": 54825362, "body": "Maybe there&#39;s a <code>showExpr</code> function which you should use instead of <code>show</code>? Just guessing ..."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1446651419, "post_id": 33521124, "comment_id": 54832993, "body": "It seems like your <code>readExpr</code> function is failing for <code>Num 0.0</code>"}], "owner": {"reputation": 21, "user_id": 5524460, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9zccS.png?s=128&g=1", "display_name": "e_phed", "link": "https://stackoverflow.com/users/5524460/e-phed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 189, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1446639098, "creation_date": 1446637822, "last_edit_date": 1446639098, "question_id": 33521124, "link": "https://stackoverflow.com/questions/33521124/haskell-quickcheck-error", "title": "Haskell - Quickcheck error", "body": "<p>As a school project i am going to create a graphic calculator. The following code comes from two files, Expr.hs and ExprQC.hs.</p>\n\n<p>From Expr.hs</p>\n\n<pre><code> readExpr :: String -&gt; Maybe Expr\n readExpr s = \n   case expr modS of\n    Just (a,\"\") -&gt; Just a\n    _           -&gt; Nothing\n   where\n     modS = filter (/= ' ') s\n</code></pre>\n\n<p>From ExprQC.hs</p>\n\n<pre><code>module ExprQC where\nimport Test.QuickCheck\n\nimport Expr\n\nprop_ShowReadExpr :: Expr -&gt; Bool\nprop_ShowReadExpr expr =\n  readExpr (show expr) == Just (assoc expr)\n\nassoc :: Expr -&gt; Expr\nassoc (Add (Add a b) c) = assoc (Add a (Add b c))\nassoc (Add a b)         = Add (assoc a) (assoc b)\nassoc (Mul (Mul a b) c) = assoc (Mul a (Mul b c))\nassoc (Mul a b)         = Mul (assoc a) (assoc b)\nassoc (Sin a)           = Sin (assoc a)\nassoc (Cos a)           = Cos (assoc a)\nassoc a                 = a\n</code></pre>\n\n<p>I get the error on GHCi</p>\n\n<pre><code>Prelude&gt; :l ExprQC.hs\n[1 of 2] Compiling Expr             ( Expr.hs, interpreted )\n[2 of 2] Compiling ExprQC           ( ExprQC.hs, interpreted )\nOk, modules loaded: ExprQC, Expr.\n*ExprQC&gt; quickCheck prop_ShowReadExpr \n *** Failed! Falsifiable (after 1 test):  \nNum 0.0\n</code></pre>\n\n<p>How can I fix this?</p>\n\n<p>Edit: This is what GHCi returns after inputting the respective expression.</p>\n\n<pre><code>*ExprQC&gt; readExpr (show (Num 0.0))\nNothing\n</code></pre>\n\n<p>And</p>\n\n<pre><code>*ExprQC&gt; Just (assoc (Num 0.0))\nJust (Num 0.0)\n</code></pre>\n\n<p>Thank you.</p>\n"}, {"tags": ["haskell", "exception-handling", "ghc"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 1, "creation_date": 1446642030, "post_id": 33519086, "comment_id": 54826312, "body": "You didn&#39;t ask, but it might be worth pointing out that the standard way to deal with parse failures is to use <code>readList</code> rather than calling <code>read</code> and then trying to catch the exception."}, {"owner": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1446642208, "post_id": 33519086, "comment_id": 54826420, "body": "@MathematicalOrchid Thanks! I ended up using readEither and I will check out readList now. But it is not the first time that I hit the wall against relatively hidden exceptions, so chi&#39;s answer is priceless."}], "answers": [{"comments": [{"owner": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "edited": false, "score": 0, "creation_date": 1446633243, "post_id": 33519488, "comment_id": 54820547, "body": "Thanks. A bit dissapointed that there is no magic bullet, but this will do!!"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 4, "last_activity_date": 1446633063, "creation_date": 1446633063, "answer_id": 33519488, "question_id": 33519086, "link": "https://stackoverflow.com/questions/33519086/how-to-capture-the-type-of-prelude-exceptions/33519488#33519488", "title": "How to capture (the type of) prelude exceptions?", "body": "<p>We know <code>read</code> comes from <code>Prelude</code>. So we can look at the <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#v:read\" rel=\"nofollow\"><code>Prelude</code> documentation for <code>read</code> on Hackage</a>, which includes a <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/src/Text.Read.html#read\" rel=\"nofollow\">source link</a>. From there, you can keep clicking on the error-y-looking part to follow the <code>read</code>-<code>error</code>-<code>errorCallException</code>-<code>ErrorCall</code> chain and learn that the appropriate exception to catch is <code>GHC.Exception.ErrorCall</code>. Testing in ghci:</p>\n\n<pre><code>&gt; try (evaluate (read \"A\")) :: IO (Either ErrorCall Int)\nLeft Prelude.read: no parse\n</code></pre>\n\n<p>Seems to work!</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 8, "last_activity_date": 1446638427, "creation_date": 1446638427, "answer_id": 33521366, "question_id": 33519086, "link": "https://stackoverflow.com/questions/33519086/how-to-capture-the-type-of-prelude-exceptions/33521366#33521366", "title": "How to capture (the type of) prelude exceptions?", "body": "<p>Built upon Daniel Wagner's answer:</p>\n\n<pre><code>import Control.Exception\nimport Data.Typeable\n\nwhichException :: IO a -&gt; IO ()\nwhichException act = do\n  e &lt;- try act\n  case e of\n    Left (SomeException ex) -&gt; print $ typeOf ex\n    _                       -&gt; putStrLn \"No exception occurred\"\n\n-- Usage:\n-- &gt; whichException (evaluate (read \"A\"::Int))\n-- ErrorCall\n</code></pre>\n"}], "owner": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 2, "accepted_answer_id": 33521366, "answer_count": 2, "score": 4, "last_activity_date": 1446638427, "creation_date": 1446632004, "question_id": 33519086, "link": "https://stackoverflow.com/questions/33519086/how-to-capture-the-type-of-prelude-exceptions", "title": "How to capture (the type of) prelude exceptions?", "body": "<p>Say I do the following from ghci:</p>\n\n<pre><code>   Prelude Control.Exception Data.Typeable&gt; let a = read \"A\" :: Int\n   Prelude Control.Exception Data.Typeable&gt; a\n   *** Exception: Prelude.read: no parse\n</code></pre>\n\n<p>Great! Now I just need to somehow know the type (and the module) of this exception to write an exception handler. Is there any way to get said type and module?</p>\n"}, {"tags": ["list", "haskell", "recursion", "functional-programming"], "comments": [{"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 2, "creation_date": 1446631363, "post_id": 33517402, "comment_id": 54819294, "body": "why are you not using the <code>[1, 2, 3]</code> notation for lists?"}], "answers": [{"tags": [], "owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "is_accepted": false, "score": 3, "last_activity_date": 1446628111, "last_edit_date": 1446628111, "creation_date": 1446627625, "answer_id": 33517562, "question_id": 33517402, "link": "https://stackoverflow.com/questions/33517402/list-multiplication-with-nested-lists/33517562#33517562", "title": "List multiplication with nested lists", "body": "<p>You could do:</p>\n\n<pre><code>zipWith (\\x -&gt; map (const x)) [1..] thisList\n</code></pre>\n\n<p>Example usage:</p>\n\n<pre><code>Prelude&gt; let thisList = [[1], [1,1], [1,1,1]]\nPrelude&gt; zipWith (\\x -&gt; map (const x)) [1..] thisList\n[[1],[2,2],[3,3,3]]\n</code></pre>\n\n<p>Or simpler:</p>\n\n<pre><code>zipWith (map . const) [1..] thisList\n</code></pre>\n\n<hr>\n\n<p>It's quite easy. <code>zipWith f as bs</code> is equivalent to <code>map (uncurry f) $ zip as bs</code>. So we have:</p>\n\n<pre><code>zip [1..] thisList == [(1, [1]), (2, [1,1,]), (3, [1,1,1])]\n</code></pre>\n\n<p>Then we apply <code>f</code> to each pair and so:</p>\n\n<pre><code>map (const 1) [1]   == [const 1 1] == [1]\nmap (const 2) [1,1] == [const 2 1, const 2 1] == [2,2]\nmap (const 3) [1,1,1] == [const 3 1, const 3 1, const 3 1] == [3,3,3]\n</code></pre>\n\n<hr>\n\n<p><em>If</em> you meant that a sublist of length <code>n</code> should be replaced by <code>[n, n, ..., n]</code> of length <code>n</code>, as in:</p>\n\n<pre><code>thisList = [[1, 1], [1], [1], [1, 1, 1]]\nresult = [[2,2], [1], [1], [3,3,3]]\n</code></pre>\n\n<p>then you have to change approach:</p>\n\n<pre><code>map (\\xs -&gt; let len = length xs in replicate len len) thisList\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>Prelude&gt; let thisList = [[1, 1], [1], [1], [1, 1, 1]]\nPrelude&gt; map (\\xs -&gt; let len = length xs in replicate len len) thisList\n[[2,2],[1],[1],[3,3,3]]\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 2969662, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/zR6q4.jpg?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2969662/aaron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1446689794, "creation_date": 1446627148, "last_edit_date": 1446689794, "question_id": 33517402, "link": "https://stackoverflow.com/questions/33517402/list-multiplication-with-nested-lists", "title": "List multiplication with nested lists", "body": "<p>Consider the list of lists </p>\n\n<pre><code>thisList = [[1], [1, 1], [1, 1, 1]]\n</code></pre>\n\n<p>how could I multiple <code>thisList</code> so that it would produce another list </p>\n\n<pre><code>anotherList = [[1], [2, 2], [3, 3, 3]]\n</code></pre>\n\n<p>I have made the function </p>\n\n<pre><code>reps = [1] : map (\\ns -&gt; head ns:ns) reps\n</code></pre>\n\n<p>which produces <code>thisList</code></p>\n\n<p>Thanks for any help</p>\n"}, {"tags": ["debugging", "haskell"], "comments": [{"owner": {"reputation": 19480, "user_id": 2491900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8FMW.jpg?s=128&g=1", "display_name": "shree.pat18", "link": "https://stackoverflow.com/users/2491900/shree-pat18"}, "edited": false, "score": 1, "creation_date": 1446619447, "post_id": 33515270, "comment_id": 54813039, "body": "Is that all the code? What version of GHC? Can&#39;t seem to be able to reproduce it here: <a href=\"http://rextester.com/YLAV57098\" rel=\"nofollow noreferrer\">rextester.com/YLAV57098</a>"}, {"owner": {"reputation": 766, "user_id": 4894219, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/cRx83.gif?s=128&g=1", "display_name": "jblakeley", "link": "https://stackoverflow.com/users/4894219/jblakeley"}, "reply_to_user": {"reputation": 19480, "user_id": 2491900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8FMW.jpg?s=128&g=1", "display_name": "shree.pat18", "link": "https://stackoverflow.com/users/2491900/shree-pat18"}, "edited": false, "score": 0, "creation_date": 1446619533, "post_id": 33515270, "comment_id": 54813072, "body": "Yes, that is all the code. It is version 7.10.2."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1446620547, "post_id": 33515270, "comment_id": 54813495, "body": "The code works fine for me with 7.10.2. Can you probably paste your entire file ?"}, {"owner": {"reputation": 766, "user_id": 4894219, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/cRx83.gif?s=128&g=1", "display_name": "jblakeley", "link": "https://stackoverflow.com/users/4894219/jblakeley"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1446621018, "post_id": 33515270, "comment_id": 54813674, "body": "@Sibi my entire file is pasted above. It&#39;s... not much."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 6, "creation_date": 1446621193, "post_id": 33515270, "comment_id": 54813755, "body": "The list in your test line should be written as <code>[1, 2, 3, 4]</code> (note the commas)."}, {"owner": {"reputation": 19480, "user_id": 2491900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8FMW.jpg?s=128&g=1", "display_name": "shree.pat18", "link": "https://stackoverflow.com/users/2491900/shree-pat18"}, "edited": false, "score": 0, "creation_date": 1446621457, "post_id": 33515270, "comment_id": 54813865, "body": "Just saw the edit. Deleting my answer since it&#39;s not relevant, but leaving a comment to point to the release notes just in case: <a href=\"https://downloads.haskell.org/~ghc/7.10.1/docs/html/users_guide/release-7-10-1.html\" rel=\"nofollow noreferrer\">downloads.haskell.org/~ghc/7.10.1/docs/html/users_guide/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 322, "user_id": 2575380, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c414a1105813c7f337b7f570c9fe67fe?s=128&d=identicon&r=PG", "display_name": "Ben Kugler", "link": "https://stackoverflow.com/users/2575380/ben-kugler"}, "is_accepted": true, "score": 17, "last_activity_date": 1446621224, "creation_date": 1446621224, "answer_id": 33515787, "question_id": 33515270, "link": "https://stackoverflow.com/questions/33515270/haskell-error-non-type-variable-argument-in-the-constraint-num-a-a-a/33515787#33515787", "title": "Haskell Error: Non type-variable argument in the constraint: Num (a -&gt; a -&gt; a -&gt; a)", "body": "<p>The function is fine, it's your argument that's off. </p>\n\n<p>Try <code>splitAt1 [1,2,3,4]</code> instead of <code>splitAt1 [1 2 3 4]</code> and it should work.</p>\n"}], "owner": {"reputation": 766, "user_id": 4894219, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/cRx83.gif?s=128&g=1", "display_name": "jblakeley", "link": "https://stackoverflow.com/users/4894219/jblakeley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7207, "favorite_count": 1, "accepted_answer_id": 33515787, "answer_count": 1, "score": 8, "last_activity_date": 1446621224, "creation_date": 1446619306, "last_edit_date": 1446621074, "question_id": 33515270, "link": "https://stackoverflow.com/questions/33515270/haskell-error-non-type-variable-argument-in-the-constraint-num-a-a-a", "title": "Haskell Error: Non type-variable argument in the constraint: Num (a -&gt; a -&gt; a -&gt; a)", "body": "<p>I'm new to Haskell and am trying to run the following example code from my book: </p>\n\n<p>entire file: </p>\n\n<pre><code>-- my name\n\nsplitAt1   ::  [a] -&gt; ([a], [a])\nsplitAt1 xs = (take 2 xs, drop 2 xs) \n</code></pre>\n\n<p>I'm testing by running the line:</p>\n\n<pre><code>splitAt1 [1 2 3 4]\n</code></pre>\n\n<p>The idea is that the input array is split into two arrays at the index 2. However, I am getting the following error: </p>\n\n<pre><code>Non type-variable argument\n  in the constraint: Num (a -&gt; a -&gt; a -&gt; a)\n(Use FlexibleContexts to permit this)\nWhen checking that \u2018it\u2019 has the inferred type\n  it :: forall a a1 a2 a3.\n        (Num a1, Num a2, Num a3, Num (a1 -&gt; a2 -&gt; a3 -&gt; a)) =&gt;\n        ([a], [a])\n</code></pre>\n\n<p>Could anyone help me decode the error message and perhaps what is wrong with the code? </p>\n"}, {"tags": ["haskell", "websocket"], "comments": [{"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1446614696, "post_id": 33513709, "comment_id": 54811308, "body": "Cross-posted this question to the <a href=\"https://github.com/jaspervdj/websockets/issues/111\" rel=\"nofollow noreferrer\">websockets</a> issue tracker."}], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 9, "last_activity_date": 1446615094, "last_edit_date": 1446615094, "creation_date": 1446614366, "answer_id": 33514237, "question_id": 33513709, "link": "https://stackoverflow.com/questions/33513709/what-is-a-real-server-for-websockets-in-haskell/33514237#33514237", "title": "What is a &quot;real server&quot; for websockets in Haskell?", "body": "<p>The actual server can be any TCP application. All you need is support of Berkeley socket from your programming language. This is a nice tutorial from <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/WebSockets_API/Writing_WebSocket_servers\">Mozilla</a> on how to write a websocket server.</p>\n\n<p>The real production quality server in Haskell ecosystem is <a href=\"http://www.stackage.org/package/warp\">warp</a>. You can use <a href=\"http://www.stackage.org/package/wai-websockets\">wai-websockets</a> to target it to Warp. In fact <code>wai-websockets</code> uses the package <code>websockets</code> internally.</p>\n"}], "owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 575, "favorite_count": 1, "accepted_answer_id": 33514237, "answer_count": 1, "score": 10, "last_activity_date": 1446615094, "creation_date": 1446611287, "question_id": 33513709, "link": "https://stackoverflow.com/questions/33513709/what-is-a-real-server-for-websockets-in-haskell", "title": "What is a &quot;real server&quot; for websockets in Haskell?", "body": "<p>The documentation for <a href=\"https://hackage.haskell.org/package/websockets-0.9.6.1/docs/Network-WebSockets.html#v:runServer\" rel=\"noreferrer\">Network.WebSockets.runServer</a> says:</p>\n\n<blockquote>\n  <p>Note that this is merely provided for quick-and-dirty standalone applications, for real applications, you should use a real server.</p>\n</blockquote>\n\n<p>Is this \"real server\" a reference to something that I'm supposed to know about (if I were more familiar with the Haskell ecosystem), or something that doesn't exist yet?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 1260, "user_id": 4420129, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Am8Sj.jpg?s=128&g=1", "display_name": "isopach", "link": "https://stackoverflow.com/users/4420129/isopach"}, "edited": false, "score": 0, "creation_date": 1446613924, "post_id": 33513423, "comment_id": 54811085, "body": "Thanks, this worked without having to change the code structure."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 2, "last_activity_date": 1446609549, "creation_date": 1446609549, "answer_id": 33513423, "question_id": 33513338, "link": "https://stackoverflow.com/questions/33513338/simple-way-to-generate-prime-numbers-without-using-set-notation/33513423#33513423", "title": "Simple way to generate Prime numbers without using set notation", "body": "<p>Yeah, just translate the list comprehension notation into its underlying meaning \ud83d\ude1c</p>\n\n<pre><code>sieve (p:px) = p : sieve (filter (\\n -&gt; mod n p /= 0) px)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "reply_to_user": {"reputation": 1891, "user_id": 45160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fe6d04c7c6a357a92a2b05efd0d09bc?s=128&d=identicon&r=PG", "display_name": "Vanson Samuel", "link": "https://stackoverflow.com/users/45160/vanson-samuel"}, "edited": false, "score": 0, "creation_date": 1446667307, "post_id": 33513481, "comment_id": 54843366, "body": "why not! It&#39;s the same as an inefficient Sieve of Eratosthenes."}, {"owner": {"reputation": 1891, "user_id": 45160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fe6d04c7c6a357a92a2b05efd0d09bc?s=128&d=identicon&r=PG", "display_name": "Vanson Samuel", "link": "https://stackoverflow.com/users/45160/vanson-samuel"}, "edited": false, "score": 0, "creation_date": 1446670642, "post_id": 33513481, "comment_id": 54845296, "body": "I wonder if I found a bug in GHC because of your post: <a href=\"http://stackoverflow.com/questions/33531834/nubby-is-not-working-as-expected\" title=\"nubby is not working as expected\">stackoverflow.com/questions/33531834/&hellip;</a>"}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "reply_to_user": {"reputation": 1891, "user_id": 45160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fe6d04c7c6a357a92a2b05efd0d09bc?s=128&d=identicon&r=PG", "display_name": "Vanson Samuel", "link": "https://stackoverflow.com/users/45160/vanson-samuel"}, "edited": false, "score": 0, "creation_date": 1446672663, "post_id": 33513481, "comment_id": 54846389, "body": "possible!  I think there are backward incompatible changes in 7.10, which I haven&#39;t tried yet."}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 1, "last_activity_date": 1446668232, "last_edit_date": 1446668232, "creation_date": 1446610002, "answer_id": 33513481, "question_id": 33513338, "link": "https://stackoverflow.com/questions/33513338/simple-way-to-generate-prime-numbers-without-using-set-notation/33513481#33513481", "title": "Simple way to generate Prime numbers without using set notation", "body": "<p>Another inefficient but simple to state expression is</p>\n\n<pre><code>nubBy (((==0).).rem) [2..]\n</code></pre>\n\n<p>or with points</p>\n\n<pre><code>nubBy (\\x y -&gt; x `rem` y == 0) [2..]\n</code></pre>\n\n<p>ps. nubBy is in Data.List</p>\n\n<pre><code>&gt; take 100 $ nubBy (\\x y -&gt; x `rem` y == 0) [2..]\n[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,\n101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,\n193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,\n293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,\n409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,\n521,523,541]\n</code></pre>\n"}], "owner": {"reputation": 1260, "user_id": 4420129, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/Am8Sj.jpg?s=128&g=1", "display_name": "isopach", "link": "https://stackoverflow.com/users/4420129/isopach"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 3, "accepted_answer_id": 33513423, "answer_count": 2, "score": 1, "last_activity_date": 1446668232, "creation_date": 1446608946, "question_id": 33513338, "link": "https://stackoverflow.com/questions/33513338/simple-way-to-generate-prime-numbers-without-using-set-notation", "title": "Simple way to generate Prime numbers without using set notation", "body": "<p>I have found multiple ways to generate prime numbers via google, such as those from the wiki: <a href=\"https://wiki.haskell.org/Prime_numbers_miscellaneous#One-liners\" rel=\"nofollow\">https://wiki.haskell.org/Prime_numbers_miscellaneous#One-liners</a> , which often appears in some form like this:</p>\n\n<pre><code>sieve (p:px) = p : sieve [n | n &lt;- px, mod n p /= 0]\n</code></pre>\n\n<p>Without using set notation, what is a simple way to generate prime?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1446592886, "post_id": 33510672, "comment_id": 54805492, "body": "Well... have you looked in the specification yourself? It&#39;s quite readable, and, as language specifications go, very short."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 5, "creation_date": 1446593107, "post_id": 33510672, "comment_id": 54805581, "body": "Also, it sounds like you have concerns about being portable to compilers other than GHC. That&#39;s a noble goal; but practically, most people don&#39;t bother to try that unless they have a good reason (e.g. a specific other compiler that they want to target). The result is that most of Hackage is probably not particularly portable to strictly standards-conformant compilers. Not to discourage you from that goal; just as a heads-up of something to watch for as you write your code."}], "answers": [{"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 2, "last_activity_date": 1446631126, "last_edit_date": 1446631126, "creation_date": 1446628646, "answer_id": 33517861, "question_id": 33510672, "link": "https://stackoverflow.com/questions/33510672/portability-and-impure-behavior-of-haskell-programs/33517861#33517861", "title": "Portability and impure behavior of Haskell programs", "body": "<p>The definitive specification of what <em>Haskell</em> guarantees is <a href=\"https://www.haskell.org/onlinereport/haskell2010/\" rel=\"nofollow\">the Haskell 2010 Report</a>. This defines the syntax and meaning of the language itself, and also specifies a tiny, tiny set of standard libraries that a compliant computer or interpreter is supposed to provide.</p>\n\n<p>In particular, <code>System.IO.Error</code> is specified by the Report. It contains the <code>ioError</code> function, which throws a specified I/O exception, and the functions <code>try</code> and <code>catch</code>, which <em>only</em> deal with I/O exceptions. Any other type of exception is completely unaffected.</p>\n\n<p>Now, <em>GHC</em> provides <code>Control.Exception</code>, which defines a whole heap of extra types and functions for dealing with all sorts of exceptions &mdash; arithmetic errors (e.g., divide by zero), out of memory, infinite loop, deadlock, user interrupt (i.e., you pressed Ctrl+C), and so on. This is all GHC-specific and in principle non-portable.</p>\n\n<p>Note that in reality, GHC basically is <em>the only</em> production-grade compiler. Once upon a time there were others, but they all seem to have faded into obscurity. In practice, GHC is the only compiler that anybody bothers targetting (unless they're doing something really special). As Daniel Wagner points out, a sizable chunk of Hackage will only compile with GHC.</p>\n\n<p>If you're interested in knowing more about portability, I'd suggest you ask a more focused question. If GHC exception handling is confusing you, ask a more specific question about that.</p>\n\n<p>If you're asking abort portability across operating systems... GHC implements this stuff identically on all the platforms it supports.</p>\n"}], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 182, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1446631126, "creation_date": 1446591428, "question_id": 33510672, "link": "https://stackoverflow.com/questions/33510672/portability-and-impure-behavior-of-haskell-programs", "title": "Portability and impure behavior of Haskell programs", "body": "<p>My understanding is that unless code evaluates to so called <code>bottom</code> then referential transparency holds in Haskell.</p>\n\n<p>But things happen in real world. Memory is finite, threads may get interrupted, asynchronous exceptions get thrown, spurious interrupts may wake thread, signals, division by zero and so on...</p>\n\n<p>I'm not sure what exceptions mean in Haskell exactly. I understand that programmer and hardware errors are the cause of exceptions. I'll use word 'situation' to describe exceptions and any other observable program behaviour that cannot be handled in pure code (e.g. reasons for my program terminating).</p>\n\n<p>I understand every non-pure situation is to be handled in <code>IO</code> as long runtime continues to execute program. And that includes catching exceptions from pure code. So far I learned that I should use <code>catchAny</code> to prevent having my program terminate if possible. Is it special to <code>GHC</code> in any way? Which runtime situations is it guaranteed to \"catch\" and which not?</p>\n\n<p>In general, for what areas of impure situations Haskell specification guaranteed APIs for programs to detect and handle in portable way? What is left to implementation and architecture?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 185753, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 0, "creation_date": 1446588637, "post_id": 33509984, "comment_id": 54803651, "body": "I can&#39;t answer your question about introspection, but I can point out that <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/src/Data.Foldable.html#line-218\" rel=\"nofollow noreferrer\">this</a> is the reason behind your underlying question :)"}, {"owner": {"reputation": 185753, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 2, "creation_date": 1446588786, "post_id": 33509984, "comment_id": 54803710, "body": "(and in fact the <code>:i</code> output you provided says &quot;Instance Foldable Maybe -- Defined in <code>Data.Foldable</code>&quot;. That plus inspecting <code>Nothing</code> to see that it&#39;s a <code>Maybe</code> (if you didn&#39;t already know that) does the job?)"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1446588929, "post_id": 33509984, "comment_id": 54803794, "body": "Why don&#39;t you just see the type of <code>sum</code> using <code>:t sum</code>. It will indicate that it has to have <code>Foldable</code> instance and all you have figure out is that <code>Maybe</code> instance for <code>Foldable</code>."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1446589144, "post_id": 33509984, "comment_id": 54803908, "body": "You answered your own question. The output of <code>:i</code> says: <code>sum :: Num a =&gt; t a -&gt; a</code> and <code>instance Foldable Maybe</code>. From this it follows that <code>sum Nothing</code> is well-typed since <code>Nothing :: Maybe a</code> for every <code>a</code>, and so it has also type <code>Nothing :: Num a =&gt; Maybe a</code>, which can be passed to <code>sum</code>.  The result of <code>0</code> obviously comes from how <code>sum</code> is defined for empty <code>Foldable</code>s."}, {"owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "edited": false, "score": 0, "creation_date": 1446591843, "post_id": 33509984, "comment_id": 54805117, "body": "I would think that <code>0</code> comes from <code>Monoid Sum</code> in ` sum = getSum #. foldMap Sum` definition."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1446597485, "post_id": 33509984, "comment_id": 54806981, "body": "@sevo And you would be right."}], "answers": [{"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 6, "last_activity_date": 1446588973, "creation_date": 1446588973, "answer_id": 33510136, "question_id": 33509984, "link": "https://stackoverflow.com/questions/33509984/can-ghci-be-used-to-explain-coercions/33510136#33510136", "title": "Can GHCI be used to explain coercions?", "body": "<p>You can use typed holes:</p>\n\n<pre><code>&gt; sum (Nothing :: _)\n&lt;interactive&gt;:4:17:\n    Found hole `_' with type: Maybe a\n    Where: `a' is a rigid type variable bound by\n               the inferred type of it :: Num a =&gt; a at &lt;interactive&gt;:4:1\n    To use the inferred type, enable PartialTypeSignatures\n    Relevant bindings include it :: a (bound at &lt;interactive&gt;:4:1)\n    In an expression type signature: _\n    In the first argument of `sum', namely `(Nothing :: _)'\n    In the expression: sum (Nothing :: _)\n</code></pre>\n\n<p>Which says that <code>a</code> is a rigid type variable bound by the inferred type of <code>it :: Num a =&gt; a</code>, and since <code>Maybe</code> is an instance of <code>Foldable</code> (as you have already posted in the output to <code>:i Foldable</code>, although you can also see in the output to <code>:i Maybe</code>) it compiles presuming that <code>Nothing :: Num a =&gt; Maybe a</code>, since <code>sum</code> places that <code>Num</code> constraint on it.</p>\n\n<p>So the reason why it compiles is that <code>sum</code> accepts a <code>Foldable</code> containing <code>Num a =&gt; a</code> values, and <code>Maybe</code> is a <code>Foldable</code>, <code>Nothing</code> by itself has type <code>Maybe a</code>, and <code>sum</code> places the constraint that <code>a</code> must implement <code>Num</code>.  When in GHCi, this defaults to <code>Integer</code>, so you see the output of <code>0</code>.</p>\n"}], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446588973, "creation_date": 1446588344, "question_id": 33509984, "link": "https://stackoverflow.com/questions/33509984/can-ghci-be-used-to-explain-coercions", "title": "Can GHCI be used to explain coercions?", "body": "<p>How to ask GHCI to explain why the following:</p>\n\n<pre><code>*Lib&gt; sum Nothing\n0\n</code></pre>\n\n<p>Even compiles? Was there <code>Monoid</code> involved somehow? It's not in the signature! </p>\n\n<pre><code>*Lib&gt; :i Foldable\nclass Foldable (t :: * -&gt; *) where\n  ...\n  maximum :: Ord a =&gt; t a -&gt; a\n  minimum :: Ord a =&gt; t a -&gt; a\n  sum :: Num a =&gt; t a -&gt; a\n  product :: Num a =&gt; t a -&gt; a\n        -- Defined in \u2018Data.Foldable\u2019\ninstance Foldable [] -- Defined in \u2018Data.Foldable\u2019\ninstance Foldable Maybe -- Defined in \u2018Data.Foldable\u2019\ninstance Foldable (Either a) -- Defined in \u2018Data.Foldable\u2019\ninstance Foldable ((,) a) -- Defined in \u2018Data.Foldable\u2019\n*Lib&gt; :i Num\nclass Num a where\n  (+) :: a -&gt; a -&gt; a\n  (-) :: a -&gt; a -&gt; a\n  (*) :: a -&gt; a -&gt; a\n  negate :: a -&gt; a\n  abs :: a -&gt; a\n  signum :: a -&gt; a\n  fromInteger :: Integer -&gt; a\n        -- Defined in \u2018GHC.Num\u2019\ninstance Num Word -- Defined in \u2018GHC.Num\u2019\ninstance Num Integer -- Defined in \u2018GHC.Num\u2019\ninstance Num Int -- Defined in \u2018GHC.Num\u2019\ninstance Num Float -- Defined in \u2018GHC.Float\u2019\ninstance Num Double -- Defined in \u2018GHC.Float\u2019\n*Lib&gt; sum Nothing\n0\n</code></pre>\n"}, {"tags": ["haskell", "computer-science"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1446597653, "post_id": 33509936, "comment_id": 54807030, "body": "I guess whether it&#39;s right depends a lot on how <code>makeNewPalindrome</code> is implemented!"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1446621132, "post_id": 33509936, "comment_id": 54813723, "body": "Exactly the same question was asked yesterday (but it probably got deleted). Probably an assignment or homework. You have to provide your attempted solution and explain what it goes wrong. SO isn&#39;t a code writing service."}, {"owner": {"reputation": 1420, "user_id": 693416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b40373fe8f75f5eed0609e695042d528?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/693416/greg"}, "edited": false, "score": 0, "creation_date": 1446626019, "post_id": 33509936, "comment_id": 54816005, "body": "I think your best bet with an effort like this is to start with <code>isPalindrome</code>.  Without that you don&#39;t have a viable base case and it will get you started on parsing text in Haskell."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5522134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a43872819d979b1d8cad207fa0d71f7?s=128&d=identicon&r=PG&f=1", "display_name": "TheProgrammer ", "link": "https://stackoverflow.com/users/5522134/theprogrammer"}, "edited": false, "score": 0, "creation_date": 1446655058, "post_id": 33520835, "comment_id": 54835669, "body": "*Main&gt; formPalindrome &quot;sun&quot;  &lt;interactive&gt;:2:1:     Not in scope: <code>formPalindrome&#39;     Perhaps you meant </code>isPalindrome&#39; (line 28)  I got this !!"}], "tags": [], "owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "is_accepted": true, "score": 1, "last_activity_date": 1446636948, "creation_date": 1446636948, "answer_id": 33520835, "question_id": 33509936, "link": "https://stackoverflow.com/questions/33509936/building-a-palindrome-from-a-base-string-using-haskell/33520835#33520835", "title": "Building a palindrome from a base string using Haskell", "body": "<p>Rather than solving immediately the problem of getting the <em>shortest</em> palindrome extending your base string <code>xs</code> (or, if we view it as a list of characters, <code>x_0, ..., x_n</code>), you may want to proceed by small steps:</p>\n\n<h1>What is a palindrome?</h1>\n\n<p>A palindrome is a string we can read from left to right and right to left without it making any difference. We can express that rather concisely using <code>reverse</code>:</p>\n\n<pre><code>isPalindrome :: String -&gt; Bool\nisPalindrome xs = xs == reverse xs\n</code></pre>\n\n<h1>What are the candidates?</h1>\n\n<p>We are looking for extensions of <code>x_0, ..., x_n</code> that look a bit like palindromes. We can say for sure that:</p>\n\n<ul>\n<li><p>If <code>xs</code> itself is not a palindrome then <code>x_0, ..., x_n, x_0</code> is one step closer to being one: reading it left to right or right to left, they both start with the character <code>x_0</code>.</p></li>\n<li><p>If <code>x_0, ..., x_n, x_0</code> is not a palindrome then <code>x_0, x_1, ..., x_n, x_1, x_0</code> is one step closer to being one: reading it left to right or right to left, they both start with <code>x_0</code> followed by <code>x_1</code>.</p></li>\n<li><p>etc. for <code>x_0, ..., x_n, x_2, x_1, x_0</code> and all the strings that look like <code>x_0, ..., x_n, x_k, x_(k-1), ..., x_0</code></p></li>\n</ul>\n\n<p>We know that <code>xs ++ reverse xs</code> is guaranteed to be a palindrome so we are only interested in generating the list of candidates smaller than that:</p>\n\n<pre><code>[ xs\n, xs ++ reverse (take 1 xs)\n, xs ++ reverse (take 2 xs)\n, xs ++ reverse (take 3 xs)\n, (...)\n, xs ++ reverse xs ]\n</code></pre>\n\n<p>which can be written: <code>map (\\ ys -&gt; xs ++ reverse ys) takeNxs</code> where <code>takeNxs</code> is a list of all the initial segments of <code>xs</code>. Do you know how to generate that list?</p>\n\n<h1>Which candidates are actual palindromes?</h1>\n\n<p>Now that you have your list of candidates and that you know how to detect whether a string is a palindrome, you can remove all the candidates which are not palindromes and only keep the valid ones.</p>\n\n<h1>Where is the minimum palindrome?</h1>\n\n<p>Once you have your list of extensions of <code>xs</code> which are palindromes, you can simply pick the smallest one. And you're done!</p>\n"}], "owner": {"reputation": 1, "user_id": 5522134, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a43872819d979b1d8cad207fa0d71f7?s=128&d=identicon&r=PG&f=1", "display_name": "TheProgrammer ", "link": "https://stackoverflow.com/users/5522134/theprogrammer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 259, "favorite_count": 2, "closed_date": 1446715043, "accepted_answer_id": 33520835, "answer_count": 1, "score": -5, "last_activity_date": 1446636948, "creation_date": 1446588152, "last_edit_date": 1446628572, "question_id": 33509936, "link": "https://stackoverflow.com/questions/33509936/building-a-palindrome-from-a-base-string-using-haskell", "closed_reason": "Needs details or clarity", "title": "Building a palindrome from a base string using Haskell", "body": "<p>In Haskell I would like to create a function, formPalindrome, which takes a string and returns the shortest palindrome possible with the input string as the start of the string.</p>\n\n<p>For example:</p>\n\n<pre><code>formPalindrome \u201csun\u201d \u21d2 \u201csunus\u201d\n\nformPalindrome \u201clevel\u201d \u21d2 \u201clevel\u201d\n</code></pre>\n\n<p>So far, I have the following:</p>\n\n<pre><code>formPalindrome :: String -&gt; String\nformPalindrome x\n | isPalindrome x = x\n | otherwise      = makeNewPalindrome x\n</code></pre>\n\n<p>Is it right?</p>\n"}, {"tags": ["function", "haskell", "if-statement", "conditional-statements"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1446587599, "post_id": 33509676, "comment_id": 54803113, "body": "<code>if &lt;cond1&gt; then if &lt;cond2&gt; then x1 else x2 else x3</code>? Or you may be interested in the <a href=\"https://downloads.haskell.org/~ghc/7.6.1/docs/html/users_guide/syntax-extns.html#multi-way-if\" rel=\"nofollow noreferrer\"><code>MultiWayIf</code></a> extension of GHC."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1446587790, "post_id": 33509676, "comment_id": 54803219, "body": "Anyway the code seems wrong. You have <code>mes == [01, 03, ..]</code> and then <code>mes == 02</code>.  But it&#39;s unlikely that lists are <code>Num</code> instances, so this would probably raise a type error."}, {"owner": {"reputation": 117, "user_id": 5503856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e3514e55cd658ef8683e89154a473d?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/5503856/felix"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1446587937, "post_id": 33509676, "comment_id": 54803304, "body": "I would like the program to first check the condition of lapyear anyo and depending on that go on to the three other conditions"}, {"owner": {"reputation": 1420, "user_id": 693416, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b40373fe8f75f5eed0609e695042d528?s=128&d=identicon&r=PG", "display_name": "Greg", "link": "https://stackoverflow.com/users/693416/greg"}, "edited": false, "score": 0, "creation_date": 1446588349, "post_id": 33509676, "comment_id": 54803494, "body": "To make your ifs a little clearer, consider using the Haskell typing system to define your Mes as a data type instead of an Int:     data Mes = enero | febrero | marzo | ... | noviembre | diciembre  Also consider bounding your Dias data type, as suggested in: <a href=\"http://stackoverflow.com/questions/7302735/how-to-create-a-type-bounded-within-a-certain-range\" title=\"how to create a type bounded within a certain range\">stackoverflow.com/questions/7302735/&hellip;</a>"}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1446637934, "post_id": 33509676, "comment_id": 54823567, "body": "On an unrelated note you may want to rewrite lapyear <a href=\"http://lpaste.net/144566\" rel=\"nofollow noreferrer\">like so</a>"}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 5503856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e3514e55cd658ef8683e89154a473d?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/5503856/felix"}, "edited": false, "score": 0, "creation_date": 1446588744, "post_id": 33509837, "comment_id": 54803692, "body": "Thank you! I think this will work but now an error appears that says &quot;Multi-way if-expressions need MultiWayIf turned on&quot;. How do I import multiwayif ?"}, {"owner": {"reputation": 117, "user_id": 5503856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e3514e55cd658ef8683e89154a473d?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/5503856/felix"}, "edited": false, "score": 0, "creation_date": 1446589632, "post_id": 33509837, "comment_id": 54804146, "body": "It&#39;s working now, I only had to multiwayif via     :set -XMultiWayIf   thank you again"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 117, "user_id": 5503856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e3514e55cd658ef8683e89154a473d?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/5503856/felix"}, "edited": false, "score": 2, "creation_date": 1446593766, "post_id": 33509837, "comment_id": 54805823, "body": "Note the <code>{-# LANGUAGE MultiWayIf #-}</code>.  If you put that at the very top of your file, you don&#39;t need a command-line flag."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 3, "last_activity_date": 1446587772, "creation_date": 1446587772, "answer_id": 33509837, "question_id": 33509676, "link": "https://stackoverflow.com/questions/33509676/haskell-multiple-conditions-combined/33509837#33509837", "title": "Haskell multiple conditions combined", "body": "<p>You might like the <a href=\"https://www.fpcomplete.com/school/to-infinity-and-beyond/pick-of-the-week/guide-to-ghc-extensions/basic-syntax-extensions#multiwayif\" rel=\"nofollow\"><code>MultiWayIf</code></a> extension.</p>\n\n<pre><code>{-# LANGUAGE MultiWayIf #-}\n\nif lapyear anyo then if\n    | or [...] -&gt; 31\n    | mes == 20 -&gt; 29\n    | otherwise -&gt; 30\nelse if\n    | ...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 117, "user_id": 5503856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e3514e55cd658ef8683e89154a473d?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/5503856/felix"}, "edited": false, "score": 0, "creation_date": 1446638910, "post_id": 33517522, "comment_id": 54824257, "body": "Seems like the easiest way to me without having to import anything. Thank you!"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1446640173, "last_edit_date": 1446640173, "creation_date": 1446627496, "answer_id": 33517522, "question_id": 33509676, "link": "https://stackoverflow.com/questions/33509676/haskell-multiple-conditions-combined/33517522#33517522", "title": "Haskell multiple conditions combined", "body": "<p>Some alternatives in plain Haskell (without extensions):</p>\n\n<ul>\n<li><p>chain of <code>if then else</code>:</p>\n\n<pre><code>if lapyear anyo then\n   if or [...] then 31\n   else if mes == 02 then 29\n   else 30\nelse ...\n</code></pre></li>\n<li><p>using <code>let</code>:</p>\n\n<pre><code>if lapyear anyo then\n   let result | or [...]  = 31\n              | mes == 02 = 29\n              | otherwise = 30\n        in result\nelse ...\n</code></pre></li>\n<li><p>using <code>case</code>:</p>\n\n<pre><code>if lapyear anyo then\n   case () of\n   _ | or [...]  -&gt; 31\n     | mes == 02 -&gt; 29\n     | otherwise -&gt; 30\nelse ...\n</code></pre></li>\n</ul>\n\n<p>I believe the last one is the most popular.</p>\n"}], "owner": {"reputation": 117, "user_id": 5503856, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e3514e55cd658ef8683e89154a473d?s=128&d=identicon&r=PG&f=1", "display_name": "Felix", "link": "https://stackoverflow.com/users/5503856/felix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 568, "favorite_count": 0, "accepted_answer_id": 33509837, "answer_count": 2, "score": 2, "last_activity_date": 1446640173, "creation_date": 1446587140, "last_edit_date": 1446588014, "question_id": 33509676, "link": "https://stackoverflow.com/questions/33509676/haskell-multiple-conditions-combined", "title": "Haskell multiple conditions combined", "body": "<p>I've been looking for a while now and didn't find any answers to my question. \nI tried to write a function that returns the days of a specific month depending on whether it is in a lap year or not. I already defined the function \"lapyear\" previously. My question is how can I create an If condition within another If condition ?</p>\n\n<p>Thank you a lot for your answers :)</p>\n\n<pre><code>lapyear:: Int-&gt;Bool\nlapyear a\n    |((rem)a 400)==0 = True\n    |((rem)a 100)==0 = False\n    |((rem)a 4)==0 = True\n    |otherwise = False\n\ntype Mes = Int\ntype Anyo = Int\ntype Dias= Int\ndaysAmonth:: Mes-&gt;Anyo-&gt;Dias\ndaysAmonth mes anyo\nif lapyear anyo then do\n    |or[mes==01,mes==03,mes==05,mes==07,mes==08,mes==10,mes==12] = 31\n    |mes==02 = 29\n    |otherwise = 30\nelse\n    |or[mes==01,mes==03,mes==05,mes==07,mes==08,mes==10,mes==12] = 31\n    |mes==02 = 28\n    |otherwise = 30\n</code></pre>\n"}, {"tags": ["haskell", "hdbc"], "owner": {"reputation": 507, "user_id": 4966887, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2b2d9b78341809c8b9b01ac9ae3f3c72?s=128&d=identicon&r=PG&f=1", "display_name": "Chirs", "link": "https://stackoverflow.com/users/4966887/chirs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 22, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1446583970, "creation_date": 1446583970, "question_id": 33508858, "link": "https://stackoverflow.com/questions/33508858/getting-an-convertible-exception-while-using-database-odbc-describetable", "title": "Getting an convertible exception while using Database.ODBC.describeTable", "body": "<p>First of all, I'm a Haskell novice who took the big leap of using Haskell now on a first real \"Haskell project\". In short it's about gathering schema information from different data sources.</p>\n\n<p>I decided to use HDBC with ODBC but I'm getting this unexpected exception. To reproduce:</p>\n\n<pre><code>import Database.HDBC\nimport Database.HDBC.ODBC\n\nmain :: IO ()\nmain = do\n    ioc &lt;- connectODBC \"Driver={MySQL};Port=3306;Database=northwind;User=root;Host=localhost\"\n    x &lt;- describeTable ioc \"Categories\"\n    putStrLn $ show (x !! 3)\n</code></pre>\n\n<p>When execute this exception occurs:</p>\n\n<pre><code>$ runghc problem-hdbc.hs \nproblem-hdbc.hs: Convertible: error converting source data -1 of type Int32 to type Word64: Input value outside of bounds: (0,18446744073709551615)\n</code></pre>\n\n<p>The relevant database is Microsoft's sample database <a href=\"https://northwinddatabase.codeplex.com/\" rel=\"nofollow\">Northwind</a>. The third column in the table <code>Categories</code> has type <code>longblob</code>.</p>\n\n<p>I can see that <code>show</code> is printing <code>colSize</code>, which is of type <code>Maybe Int</code>.\nWhat I don't understand is why ODBC prefers throwing an exception over returning <code>Nothing</code> for colSize.</p>\n\n<p>This leads me to several questions:</p>\n\n<ul>\n<li>Is this a bug?</li>\n<li>If not, what can I do to get around this?</li>\n<li>What are the best practices when working with <code>Convertible</code>?</li>\n</ul>\n"}, {"tags": ["parsing", "haskell", "happy"], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 36, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1446580502, "creation_date": 1446578091, "last_edit_date": 1446580502, "question_id": 33507223, "link": "https://stackoverflow.com/questions/33507223/define-rule-alias-in-happy", "title": "Define rule alias in Happy", "body": "<p>I'm reading a language specification, and trying to write a parser for it. In places the specification uses multiple names for the same thing. I tried to copy this to the Happy grammar like so:</p>\n\n<pre><code>foo : ...whatever...\nbar : foo { $1 }\nbaz : foo { $1 }\n</code></pre>\n\n<p>Unfortunately, this causes Happy to flip out and start whining about \"reduce/reduce conflicts\". Basically, the problem seems to be that when it sees a <code>foo</code>, it doesn't know whether to reduce it to a <code>bar</code> or a <code>baz</code>. The truth is of course that <em>I don't care</em>, because they're all identical. But it still upsets Happy &mdash; which is linguistically ironic if nothing else.</p>\n\n<p>(I'm also slightly scared that if I have a rule that mentions <code>bar</code> and another that mentions <code>baz</code>, the correct rule may fail to fire if the \"wrong\" reduction is picked. In other words, the parser will have a problem which is 100% impossible to ever debug.)</p>\n\n<p>Is there some way I can tell Happy \"wherever I say <code>bar</code>, just pretend I said <code>foo</code> and move on with your life\"?</p>\n\n<p>Obviously I <em>could</em> just use some external tool to do a textual find-and-replace, but I'd really prefer to not have to add yet <em>another</em> build step&hellip;</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 0, "creation_date": 1446579619, "post_id": 33506639, "comment_id": 54798778, "body": "Regarding your update, should the <code>SomeT Maybe Type2</code>&#39;s be <code>SomeT (Maybe Type2)</code>? And <code>SomeT Identity [Type2]</code> be <code>SomeT [Type2]</code>? If so, could you possibly elaborate on how my answer does not work to resolve this? I think <code>mapMaybeM</code> should indeed do precisely what you&#39;re looking for."}, {"owner": {"reputation": 3638, "user_id": 304645, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2b2cd873fa89bc5016c2b5b6d5b2a9ba?s=128&d=identicon&r=PG", "display_name": "punund", "link": "https://stackoverflow.com/users/304645/punund"}, "reply_to_user": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 0, "creation_date": 1446580587, "post_id": 33506639, "comment_id": 54799351, "body": "No, it should not.  SomeT is a transformer.  Perhaps you can give a code example using generic g1 and g2?"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1446583475, "post_id": 33506639, "comment_id": 54800946, "body": "@punund Why don&#39;t you write down your exact problem here instead of <code>SomeT</code> and <code>Type1</code>."}, {"owner": {"reputation": 3638, "user_id": 304645, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2b2cd873fa89bc5016c2b5b6d5b2a9ba?s=128&d=identicon&r=PG", "display_name": "punund", "link": "https://stackoverflow.com/users/304645/punund"}, "edited": false, "score": 0, "creation_date": 1446584183, "post_id": 33506639, "comment_id": 54801335, "body": "It doesn&#39;t not really matter and will only complicate things.  <code>SomeT</code> is <code>ReaderT (CustomType1, CustomType2)</code> and <code>Type1</code> is <code>Int</code>."}, {"owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 0, "creation_date": 1446584413, "post_id": 33506639, "comment_id": 54801453, "body": "@punund I updated my answer with an implementation working in <code>IdentityT</code>. I&#39;m not sure it can be generalized to any transformer, though. Seeing that you&#39;re using <code>ReaderT</code>, though, there is a <code>mapReaderT</code>."}, {"owner": {"reputation": 3638, "user_id": 304645, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2b2cd873fa89bc5016c2b5b6d5b2a9ba?s=128&d=identicon&r=PG", "display_name": "punund", "link": "https://stackoverflow.com/users/304645/punund"}, "edited": false, "score": 0, "creation_date": 1446584954, "post_id": 33506639, "comment_id": 54801742, "body": "Thank you for your update.  It gives <code>IdentityT (Identity [&quot;4&quot;,&quot;6&quot;,&quot;8&quot;,&quot;10&quot;])</code> instead of <code>IdentityT (Identity &quot;46810&quot;)</code>.  It should work for <code>ReaderT</code> as well, it is essentially identity if we don&#39;t invoke its functions."}, {"owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "edited": false, "score": 0, "creation_date": 1446585208, "post_id": 33506639, "comment_id": 54801892, "body": "@punund Updated. Missed the <code>concat</code>."}], "answers": [{"tags": [], "owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "is_accepted": true, "score": 2, "last_activity_date": 1446585187, "last_edit_date": 1446585187, "creation_date": 1446576937, "answer_id": 33506927, "question_id": 33506639, "link": "https://stackoverflow.com/questions/33506639/mapping-inside-monad/33506927#33506927", "title": "Mapping inside monad", "body": "<p><code>mapMaybeM f1</code> would get you <code>[Int] -&gt; Identity [String]</code>. Then you could use <code>fmap concat</code> for <code>Identity [String] -&gt; Identity String</code> to concatenate the values.</p>\n\n<p>Per your update, in case this is helpful:</p>\n\n<pre><code>f2 :: (Int -&gt; IdentityT Maybe String) -&gt; [Int] -&gt; IdentityT Identity [String]\nf2 f = mapIdentityT (fmap concat) . foldl (liftA2 (++)) (lift (return [])) . map (mapIdentityT (return . maybeToList) . f)\n</code></pre>\n\n<p>This works within <code>IdentityT</code> relying on <code>mapIdentityT</code>. I think the root problem is getting <code>[MT M a] -&gt; MT M [a]</code> and I'm not sure this is possible in general - it may be dependent on properties of the transformer.</p>\n"}], "owner": {"reputation": 3638, "user_id": 304645, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2b2cd873fa89bc5016c2b5b6d5b2a9ba?s=128&d=identicon&r=PG", "display_name": "punund", "link": "https://stackoverflow.com/users/304645/punund"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 33506927, "answer_count": 1, "score": 0, "last_activity_date": 1446585187, "creation_date": 1446575961, "last_edit_date": 1446579336, "question_id": 33506639, "link": "https://stackoverflow.com/questions/33506639/mapping-inside-monad", "title": "Mapping inside monad", "body": "<pre><code>f1 \u2237 Int \u2192 Identity (Maybe String)\nf1 x = Identity $ if even x then Just (show x) else Nothing\n\n-- f1 4 = \"4\", f1 5 = Nothing etc.\n\nf2 \u2237 (Int \u2192 Identity (Maybe String)) \u2192 [Int] \u2192 Identity String\n\n-- f2 [1..10] = \"246810\"\n</code></pre>\n\n<p>Now is it possible to implement f2 using <a href=\"http://hackage.haskell.org/package/monad-extras-0.5.11/docs/Control-Monad-Extra.html#v:mapMaybeM\" rel=\"nofollow\">mapMaybeM</a>?</p>\n\n<p>--- EDIT ----------------------</p>\n\n<p>Let me try and show you the actual problem behind this question.</p>\n\n<pre><code>g1 :: Type1 -&gt; SomeT Maybe Type2\n</code></pre>\n\n<p>g2 needs to map over Just values and get rid of Maybe:</p>\n\n<pre><code>g2 :: (Type1 -&gt; SomeT Maybe Type2) -&gt; [Type1] -&gt; SomeT Identity [Type2]\n</code></pre>\n"}, {"tags": ["c", "haskell", "tail-call-optimization", "multiple-languages", "mutual-recursion"], "answers": [{"tags": [], "owner": {"reputation": 55924, "user_id": 5245033, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/6dbfd37ccb940fd2afcd49e966ad97e4?s=128&d=identicon&r=PG&f=1", "display_name": "SergeyA", "link": "https://stackoverflow.com/users/5245033/sergeya"}, "is_accepted": false, "score": 0, "last_activity_date": 1446576035, "creation_date": 1446576035, "answer_id": 33506667, "question_id": 33506327, "link": "https://stackoverflow.com/questions/33506327/compiling-tail-call-optimization-in-mutual-recursion-across-c-and-haskell/33506667#33506667", "title": "Compiling Tail-Call Optimization In Mutual Recursion Across C and Haskell", "body": "<p>While I am no expert in Haskel-C interop, I do not imagine a call from C to Haskel can be a straight function invocation - it most likely has to go through intermediary to set up environment. As a result, your call to haskel would actually consist of call to this intermediary. This call likely was optimized by gcc. But the call from intermediary to actual Haskel routine was not neccessarily optimized - so I assume, this is what you are dealing with. You can check assembly output to make sure.</p>\n"}, {"comments": [{"owner": {"reputation": 747, "user_id": 1644720, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/56c78e4be01bb6d0fd2ad2c2f99a5f37?s=128&d=identicon&r=PG", "display_name": "Crazycolorz5", "link": "https://stackoverflow.com/users/1644720/crazycolorz5"}, "edited": false, "score": 0, "creation_date": 1446580265, "post_id": 33507630, "comment_id": 54799170, "body": "Is there a way to prevent the double return locations? For example, I wrote an alternate routine using pattern matching (against 0 for the base case), but that didn&#39;t help. Generally, is there a way tel tell GHC to compile in a way to allow for tail recursion across the boundary?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 747, "user_id": 1644720, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/56c78e4be01bb6d0fd2ad2c2f99a5f37?s=128&d=identicon&r=PG", "display_name": "Crazycolorz5", "link": "https://stackoverflow.com/users/1644720/crazycolorz5"}, "edited": false, "score": 0, "creation_date": 1446585059, "post_id": 33507630, "comment_id": 54801811, "body": "@Crazycolorz5 Adapting the runtime is a very hard task. You seem to believe that it is GHC that should adapt its runtime to the C standard one. To figure out how hard that is, think about the other way around: modifying GCC so to allow  for multiple returns, garbage collections, etc. It is next to impossible. What you ask is very, very unlikely to be achieved with current GHC, or even in the far future as far as I can see."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1446594212, "last_edit_date": 1446594212, "creation_date": 1446579580, "answer_id": 33507630, "question_id": 33506327, "link": "https://stackoverflow.com/questions/33506327/compiling-tail-call-optimization-in-mutual-recursion-across-c-and-haskell/33507630#33507630", "title": "Compiling Tail-Call Optimization In Mutual Recursion Across C and Haskell", "body": "<p>I believe cross-language C-Haskell tail calls are very, very hard to achieve.</p>\n\n<p>I do not know the exact details, but the C runtime and the Haskell runtime are <em>vastly</em> different. The main factors for this difference, as far as I can see, are:</p>\n\n<ul>\n<li>different paradigm: purely functional vs imperative</li>\n<li>garbage collection vs manual memory management</li>\n<li>lazy semantics vs strict one</li>\n</ul>\n\n<p>The kinds of optimizations which are likely to survive across language boundaries given such differences are next to zero. Perhaps, in theory, one could invent an ad hoc C runtime together with a Haskell runtime so that some optimizations are feasible, but GHC and GCC were not designed in this way.</p>\n\n<p>Just to show an example of the potential differences, assume we have the following Haskell code</p>\n\n<pre><code>p :: Int -&gt; Bool\np x = x==42\n\nmain = if p 42\n       then putStrLn \"A\"     -- A\n       else putStrLn \"B\"     -- B\n</code></pre>\n\n<p>A possible implementation of the <code>main</code> could be the following:</p>\n\n<ul>\n<li>push the address of <code>A</code> on the stack</li>\n<li>push the address of <code>B</code> on the stack</li>\n<li>push <code>42</code> on the stack</li>\n<li>jump to <code>p</code></li>\n<li><code>A</code>: print \"A\", jump to end</li>\n<li><code>B</code>: print \"B\", jump to end</li>\n</ul>\n\n<p>while <code>p</code> is implemented as follows:</p>\n\n<ul>\n<li>p: pop <code>x</code> from the stack</li>\n<li>pop <code>b</code> from stack</li>\n<li>pop <code>a</code> from stack</li>\n<li>test <code>x</code> against 42</li>\n<li>if equal, jump to <code>a</code></li>\n<li>jump to <code>b</code></li>\n</ul>\n\n<p>Note how <code>p</code> is invoked with <em>two</em> return addresses, one for each possible result. This is different from C, whose standard implementations use only one return address. When crossing boundaries the compiler must account for this difference and compensate.</p>\n\n<p>Above I also did not account for the case when the argument of <code>p</code> is a thunk, to keep it simple. The GHC allocator can also trigger garbage collection.</p>\n\n<p>Note that the above fictional implementation was actually used in the past by GHC (the so called \"push/enter\" STG machine). Even if now it is no longer in use, the \"eval/apply\" STG machine is only marginally closer to the C runtime. I'm not even sure about GHC using the regular C stack: I think it does not, using its own one.</p>\n\n<p>You can check the <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Commentary/Rts/HaskellExecution\" rel=\"nofollow\">GHC developer wiki</a> to see the gory details.</p>\n"}], "owner": {"reputation": 747, "user_id": 1644720, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/56c78e4be01bb6d0fd2ad2c2f99a5f37?s=128&d=identicon&r=PG", "display_name": "Crazycolorz5", "link": "https://stackoverflow.com/users/1644720/crazycolorz5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 296, "favorite_count": 1, "accepted_answer_id": 33507630, "answer_count": 2, "score": 7, "last_activity_date": 1446594212, "creation_date": 1446574763, "last_edit_date": 1446575254, "question_id": 33506327, "link": "https://stackoverflow.com/questions/33506327/compiling-tail-call-optimization-in-mutual-recursion-across-c-and-haskell", "title": "Compiling Tail-Call Optimization In Mutual Recursion Across C and Haskell", "body": "<p>I'm experimenting with the foreign-function interface in Haskell. I wanted to implement a simple test to see if I could do mutual recursion. So, I created the following Haskell code:</p>\n\n<pre><code>module MutualRecursion where\nimport Data.Int\n\nforeign import ccall countdownC::Int32-&gt;IO ()\nforeign export ccall countdownHaskell::Int32-&gt;IO()\n\ncountdownHaskell::Int32-&gt;IO()\ncountdownHaskell n = print n &gt;&gt; if n &gt; 0 then countdownC (pred n) else return ()\n</code></pre>\n\n<p>Note that the recursive case is a call to countdownC, so this should be tail-recursive. </p>\n\n<p>In my C code, I have</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\n#include \"MutualRecursionHaskell_stub.h\"\n\nvoid countdownC(int count)\n{\n    printf(\"%d\\n\", count);\n    if(count &gt; 0)\n        return countdownHaskell(count-1);\n}\n\nint main(int argc, char* argv[])\n{\n    hs_init(&amp;argc, &amp;argv);\n\n    countdownHaskell(10000);\n\n    hs_exit();\n    return 0;\n}\n</code></pre>\n\n<p>Which is likewise tail recursive. So then I make a</p>\n\n<pre><code>MutualRecursion: MutualRecursionHaskell_stub\n    ghc -O2 -no-hs-main MutualRecursionC.c MutualRecursionHaskell.o -o MutualRecursion\nMutualRecursionHaskell_stub:\n    ghc -O2 -c MutualRecursionHaskell.hs\n</code></pre>\n\n<p>and compile with <code>make MutualRecursion</code>.</p>\n\n<p>And... upon running, it segfaults after printing <code>8991</code>.\nJust as a test to make sure gcc itself can handle tco in mutual recursion, I did </p>\n\n<pre><code>void countdownC2(int);\n\nvoid countdownC(int count)\n{\n    printf(\"%d\\n\", count);\n    if(count &gt; 0)\n        return countdownC2(count-1);\n}\n\nvoid countdownC2(int count)\n{\n    printf(\"%d\\n\", count);\n    if(count &gt; 0)\n        return countdownC(count-1);\n}\n</code></pre>\n\n<p>and that worked quite fine. It also works in the single-recursion case of just in C and just in Haskell.</p>\n\n<p>So my question is, is there a way to indicate to GHC that the call to the external C function is tail recursive? I'm assuming that the stack frame does come from the call from Haskell to C and not the other way around, since the C code is very clearly a return of a function call. </p>\n"}, {"tags": ["haskell", "yesod", "organization"], "answers": [{"comments": [{"owner": {"reputation": 226, "user_id": 2936306, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/907ac0b7e1ec4827e6725dcbd2be9703?s=128&d=identicon&r=PG&f=1", "display_name": "user2936306", "link": "https://stackoverflow.com/users/2936306/user2936306"}, "edited": false, "score": 0, "creation_date": 1446567766, "post_id": 33503558, "comment_id": 54791462, "body": "That works, thanks. Another quick question, how can I marshal my type to a database value? I have a <code>PersistField</code> instance but <code>PersistFieldSql</code> seems to be hidden and I need both(I think)."}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "reply_to_user": {"reputation": 226, "user_id": 2936306, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/907ac0b7e1ec4827e6725dcbd2be9703?s=128&d=identicon&r=PG&f=1", "display_name": "user2936306", "link": "https://stackoverflow.com/users/2936306/user2936306"}, "edited": false, "score": 0, "creation_date": 1446570477, "post_id": 33503558, "comment_id": 54793441, "body": "That class is exposed from Database.Persist.Sql. See: <a href=\"http://www.stackage.org/lts-3.12/hoogle?q=PersistFieldSql&amp;exact=on\" rel=\"nofollow noreferrer\">stackage.org/lts-3.12/hoogle?q=PersistFieldSql&amp;exact=on</a>"}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": true, "score": 1, "last_activity_date": 1446566246, "creation_date": 1446566246, "answer_id": 33503558, "question_id": 33501429, "link": "https://stackoverflow.com/questions/33501429/adding-custom-datatype-in-yesod/33503558#33503558", "title": "Adding custom datatype in Yesod", "body": "<p>For your third bullet: why do you need to reference <code>Handler</code>? You can structure your field code the same way as the built in fields in <a href=\"http://haddock.stackage.org/nightly-2015-11-02/yesod-form-1.4.5/Yesod-Form-Fields.html\" rel=\"nofollow\">Yesod.Form.Fields</a>, e.g.:</p>\n\n<pre><code>textField :: Monad m =&gt; RenderMessage (HandlerSite m) FormMessage =&gt; Field m Text\n</code></pre>\n\n<p>With that: I'd say that a <code>Money.hs</code> (or even <code>Data/Money.hs</code>) makes the most sense.</p>\n"}], "owner": {"reputation": 226, "user_id": 2936306, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/907ac0b7e1ec4827e6725dcbd2be9703?s=128&d=identicon&r=PG&f=1", "display_name": "user2936306", "link": "https://stackoverflow.com/users/2936306/user2936306"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 1, "accepted_answer_id": 33503558, "answer_count": 1, "score": 1, "last_activity_date": 1446566246, "creation_date": 1446560380, "question_id": 33501429, "link": "https://stackoverflow.com/questions/33501429/adding-custom-datatype-in-yesod", "title": "Adding custom datatype in Yesod", "body": "<p>I'm using the scaffolded yesod template and want to add a new type for monetary values. Ideally this should be done in one file called Money.hs for example. But this will form cyclic imports:</p>\n\n<ul>\n<li><p>Foundation imports Model.</p></li>\n<li><p>The new Money type will be used in the model to store monetary\nvalues. Therefore Model will have to import Money</p></li>\n<li><p>Money will have to import foundation for a <code>moneyField :: Field\nHandler Money</code> function</p></li>\n</ul>\n\n<p>TL DR: Is there a \"correct\" way to add new types to a scaffolded yesod application including sql db type, shakespeare field widget and <code>ToHtml</code> instance?</p>\n"}, {"tags": ["algorithm", "parsing", "haskell"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 3, "creation_date": 1446555973, "post_id": 33497854, "comment_id": 54783296, "body": "Instead of adding an <code>edit</code> note you should <i>actually</i> perform an edit and remove unnecessary details that aren&#39;t relevant. There&#39;s the edit history if we want to see what, how and when something changed in a post."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1446563599, "post_id": 33497854, "comment_id": 54788489, "body": "@Bakuriu I am sorry, I updated the question now."}], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 4, "last_activity_date": 1446559669, "creation_date": 1446559669, "answer_id": 33501183, "question_id": 33497854, "link": "https://stackoverflow.com/questions/33497854/how-to-correctly-deal-with-optional-spaces-on-readp/33501183#33501183", "title": "How to correctly deal with optional spaces on ReadP?", "body": "<p>The most prevalent technique I've seen to deal with spaces is to have each token consume the white space immediately following it.</p>\n\n<p>A convenience combinator like the following can help out with this:</p>\n\n<pre><code>tok p = p &lt;* spaces\n</code></pre>\n\n<p>For example, this combinator definition:</p>\n\n<pre><code>adt d = Adt &lt;$&gt; between (string \"#(\") (char ')') (sepBySpaced ctor (char '|')) = ...\n</code></pre>\n\n<p>would be written as:</p>\n\n<pre><code>adt d = Adt &lt;$&gt; between (tok $ string \"#(\") (tok $ char ')') (sepBySpaced ctor (tok $ char '|')) = ...\n</code></pre>\n\n<p>The only caveat is that you have to make sure you remove/skip over any white space at the start of your input.</p>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 1, "accepted_answer_id": 33501183, "answer_count": 1, "score": 3, "last_activity_date": 1446563588, "creation_date": 1446549677, "last_edit_date": 1446563588, "question_id": 33497854, "link": "https://stackoverflow.com/questions/33497854/how-to-correctly-deal-with-optional-spaces-on-readp", "title": "How to correctly deal with optional spaces on ReadP?", "body": "<p>When using <code>ReadP</code> to parse a grammar, I notice the parser often gets exponential. Most of the times, I end up identifying the issue is triggered by some bad usage of <code>skipSpaces</code>, although I'm not sure when exactly that happens. What is the right way to deal with optional spaces when parsing with ReadP?</p>\n"}, {"tags": ["haskell", "optimization", "ghc", "asymptotic-complexity"], "comments": [{"owner": {"reputation": 15004, "user_id": 562906, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a15f15ed0023f4177a518b6c15ca4b6?s=128&d=identicon&r=PG", "display_name": "sinelaw", "link": "https://stackoverflow.com/users/562906/sinelaw"}, "edited": false, "score": 0, "creation_date": 1446547798, "post_id": 33497120, "comment_id": 54778100, "body": "Are you interested in the theoretical complexity or specifically compiled output?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1446548394, "post_id": 33497120, "comment_id": 54778498, "body": "Generating a huge list and then filtering out some potentially small parts from it is hardly efficient. There could be a better approach, i.e. a different algorithm, which will prune long subsequences as early as possible."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 3, "creation_date": 1446548590, "post_id": 33497120, "comment_id": 54778635, "body": "@SDmitry: reversing the argument order (i.e. <code>subsequencesOfSize n l</code>) would make for a more idiomatic design, just for the record."}, {"owner": {"reputation": 328, "user_id": 2959388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/933fb33d00fb6d48d1e37fa880a53dce?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2959388/dmitry"}, "edited": false, "score": 0, "creation_date": 1446548689, "post_id": 33497120, "comment_id": 54778708, "body": "It can be ineffitient if we can do it without optimisations. But it is a part of my question. Can GHC make such optimizations here after which this approach can be comparable with the early-filtering? And theoretical complexity interesting too."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 1, "creation_date": 1446548781, "post_id": 33497120, "comment_id": 54778764, "body": "along the lines of dfeuer&#39;s suggestion, you might want to check out this: <a href=\"http://stackoverflow.com/a/33016778/247623\">stackoverflow.com/a/33016778/247623</a> \u2014 basically you should use asomething like <code>lengthIsGt</code> to pre-filter the lists before you call <code>length</code> on them, so as to avoid evaluating very long lists. in fact, your current algorithm will loop forever if any of the lists in <code>l</code> is infinite."}, {"owner": {"reputation": 328, "user_id": 2959388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/933fb33d00fb6d48d1e37fa880a53dce?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2959388/dmitry"}, "edited": false, "score": 0, "creation_date": 1446549383, "post_id": 33497120, "comment_id": 54779161, "body": "I forgot about this &quot;length&quot; characteristic!"}], "answers": [{"tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": false, "score": 1, "last_activity_date": 1446549340, "creation_date": 1446549340, "answer_id": 33497737, "question_id": 33497120, "link": "https://stackoverflow.com/questions/33497120/haskell-asymptotic-difference-between-algorithms/33497737#33497737", "title": "Haskell asymptotic difference between algorithms", "body": "<p>I think your question contains at least 2 distinct questions, but whether (current versions of) GHC can optimize this</p>\n\n<pre><code>subsequencesOfSize l n = [x | x &lt;- subsequences l, length x == n]\n</code></pre>\n\n<p>into something like</p>\n\n<pre><code>subsequencesOfSize l n = [x | x &lt;- subsequences l, lengthIsGt n x, length x == n]\n</code></pre>\n\n<p>is highly doubtable \u2014 I'm nowhere near being an expert on optimization, supercompilation etc, but inferring the need for something like <code>lengthIsGt</code> from the use of <code>length</code> here seems highly non-trivial and is unlikely to be part of a compiler's set of generic optimizations.</p>\n\n<p>P.S. actually the version with <code>lengthIsGt</code> will potentially still try to evaluate infinite lists if the condition containing <code>length</code> is evaluated before the condition containing <code>lengthIsGt</code> (but that was pseudocode anyway)</p>\n"}, {"comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1446558872, "post_id": 33500636, "comment_id": 54785247, "body": "There is a lazier version: compare <a href=\"http://ideone.com/LrpZMh\" rel=\"nofollow noreferrer\">this</a> and <a href=\"http://ideone.com/ZubdHR\" rel=\"nofollow noreferrer\">this</a>."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1446559340, "post_id": 33500636, "comment_id": 54785564, "body": "Also, I think &quot;sharing&quot; is a more accurate term than &quot;memoization&quot;."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1446559878, "post_id": 33500636, "comment_id": 54785920, "body": "@user3237465 - added your version"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 1, "last_activity_date": 1446559840, "last_edit_date": 1495542595, "creation_date": 1446558085, "answer_id": 33500636, "question_id": 33497120, "link": "https://stackoverflow.com/questions/33497120/haskell-asymptotic-difference-between-algorithms/33500636#33500636", "title": "Haskell asymptotic difference between algorithms", "body": "<p>Here is a related SO question which discusses various implementations of <code>subsequencesOfSize</code>:</p>\n\n<p><a href=\"https://stackoverflow.com/q/26727673/866915\">Haskell: comparison of techniques for generating combinations</a></p>\n\n<p>and the best performing one which uses memoization:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/26727673/haskell-comparison-of-techniques-for-generating-combinations/26727936#26727936\">Haskell: comparison of techniques for generating combinations</a></p>\n\n<p><strong>Update</strong></p>\n\n<p>Also consider this version that @user3237465 mentions in the comments:</p>\n\n<pre><code>subsequencesOfSize :: Int -&gt; [a] -&gt; [[a]]\nsubsequencesOfSize n xs | n &gt; length xs = []\nsubsequencesOfSize n xs = subsequencesBySize xs !! n where\n    subsequencesBySize    []  = [[[]]]\n    subsequencesBySize (x:xs) = zipWith (++) ([] : map (map (x:)) next) (next ++ [[]])\n        where next = subsequencesBySize xs\n</code></pre>\n"}], "owner": {"reputation": 328, "user_id": 2959388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/933fb33d00fb6d48d1e37fa880a53dce?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/2959388/dmitry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "accepted_answer_id": 33500636, "answer_count": 2, "score": 0, "last_activity_date": 1446559840, "creation_date": 1446547552, "last_edit_date": 1446548908, "question_id": 33497120, "link": "https://stackoverflow.com/questions/33497120/haskell-asymptotic-difference-between-algorithms", "title": "Haskell asymptotic difference between algorithms", "body": "<p>Here we need to get all subsequences of the given length. How to calculate the asymptotic complexity of the given function?</p>\n\n<pre><code>import Data.List\n\nsubsequencesOfSize l n = [x | x &lt;- subsequences l, length x == n]\n</code></pre>\n\n<p>How many \"iterations\" will it be? Can we speak about \"iterations\". Any optimizations? GHC 7.10.2. How compiler or programmer can improve this?</p>\n"}, {"tags": ["haskell", "functional-programming", "rounding"], "comments": [{"owner": {"reputation": 2179, "user_id": 412549, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a194a155579e30bda0926705aeb9d165?s=128&d=identicon&r=PG&f=1", "display_name": "Franky", "link": "https://stackoverflow.com/users/412549/franky"}, "edited": false, "score": 1, "creation_date": 1446541543, "post_id": 33494859, "comment_id": 54774082, "body": "If you do not tell us what syntax error you have, we cannot help you! I can only guess you mixed tabs and spaces."}, {"owner": {"reputation": 85, "user_id": 4255328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/a7rZY.jpg?s=128&g=1", "display_name": "TimNeutron", "link": "https://stackoverflow.com/users/4255328/timneutron"}, "reply_to_user": {"reputation": 2179, "user_id": 412549, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a194a155579e30bda0926705aeb9d165?s=128&d=identicon&r=PG&f=1", "display_name": "Franky", "link": "https://stackoverflow.com/users/412549/franky"}, "edited": false, "score": 0, "creation_date": 1446542034, "post_id": 33494859, "comment_id": 54774364, "body": "@Franky Sorry I forgot. It compiles but then when you try to execute it... this happens <a href=\"http://prntscr.com/8yh8dd\" rel=\"nofollow noreferrer\">prntscr.com/8yh8dd</a> (A link to the screenshot)"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 3, "creation_date": 1446543605, "post_id": 33494859, "comment_id": 54775361, "body": "I have to admit I giggled when I saw the title. (explanation: <i>(Round to nearest) function</i> versus <i>Round to (nearest function)</i>)."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 2, "creation_date": 1446557075, "post_id": 33494859, "comment_id": 54784043, "body": "<code>round</code> also &quot;rounds to the nearest number&quot;, of course. You presumably mean something else."}, {"owner": {"reputation": 85, "user_id": 4255328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/a7rZY.jpg?s=128&g=1", "display_name": "TimNeutron", "link": "https://stackoverflow.com/users/4255328/timneutron"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1446584816, "post_id": 33494859, "comment_id": 54801672, "body": "@BartekBanachewicz haha I was doing a literal translation from German"}], "answers": [{"comments": [{"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "reply_to_user": {"reputation": 85, "user_id": 4255328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/a7rZY.jpg?s=128&g=1", "display_name": "TimNeutron", "link": "https://stackoverflow.com/users/4255328/timneutron"}, "edited": false, "score": 0, "creation_date": 1446557142, "post_id": 33495426, "comment_id": 54784094, "body": "I completely ignored your implementation and goal, and focused only on resolving the error."}], "tags": [], "owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "is_accepted": true, "score": 2, "last_activity_date": 1446542865, "last_edit_date": 1446542865, "creation_date": 1446542635, "answer_id": 33495426, "question_id": 33494859, "link": "https://stackoverflow.com/questions/33494859/round-to-nearest-function-in-haskell/33495426#33495426", "title": "Round-to-nearest function in Haskell", "body": "<p>You are mixing types where you subtract <code>a</code> from <code>round a</code> (one has type depending on the type of the <code>rounding</code> argument while the other is always <code>Integral</code>). <code>round</code> requires <code>RealFrac</code> so that is the least you should require from the argument. As always, I would also suggest adding type signature to <code>rounding</code>. The following shows the simplest type of fix:</p>\n\n<pre><code>rounding a\n    | (fromIntegral (round a)) - a &gt; (-0.5) = round a\n    | otherwise = round a + 1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 85, "user_id": 4255328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/a7rZY.jpg?s=128&g=1", "display_name": "TimNeutron", "link": "https://stackoverflow.com/users/4255328/timneutron"}, "edited": false, "score": 0, "creation_date": 1446584768, "post_id": 33499972, "comment_id": 54801641, "body": "Thank you, this is a much cleaner/simpler solution. Can&#39;t believe that I didn&#39;t think of that in the first place!"}], "tags": [], "owner": {"reputation": 178, "user_id": 4556658, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/176748782a450651ab1ef750943e5f35?s=128&d=identicon&r=PG&f=1", "display_name": "sdx23", "link": "https://stackoverflow.com/users/4556658/sdx23"}, "is_accepted": false, "score": 3, "last_activity_date": 1446556111, "creation_date": 1446556111, "answer_id": 33499972, "question_id": 33494859, "link": "https://stackoverflow.com/questions/33494859/round-to-nearest-function-in-haskell/33499972#33499972", "title": "Round-to-nearest function in Haskell", "body": "<p>Why not</p>\n\n<pre><code>rounding a = floor (a + 0.5)\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 4255328, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/a7rZY.jpg?s=128&g=1", "display_name": "TimNeutron", "link": "https://stackoverflow.com/users/4255328/timneutron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 1, "accepted_answer_id": 33495426, "answer_count": 2, "score": 2, "last_activity_date": 1446556111, "creation_date": 1446540808, "last_edit_date": 1446546821, "question_id": 33494859, "link": "https://stackoverflow.com/questions/33494859/round-to-nearest-function-in-haskell", "title": "Round-to-nearest function in Haskell", "body": "<p>I need a function that rounds to the nearest number instead of the default one that rounds to even. I wrote one, but the thing is that I am new in Haskell and I think that it is having some syntax errors. Can someone please help me? Thanks.\nHere is the code that I wrote so far:</p>\n\n<pre><code>rounding a\n    | (round a) - a &gt; (-0.5) = round a \n    | otherwise = round a + 1\n</code></pre>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 2152, "user_id": 1103600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7830fb399137c319ff68dca3e3b6f7e2?s=128&d=identicon&r=PG", "display_name": "Arnon", "link": "https://stackoverflow.com/users/1103600/arnon"}, "edited": false, "score": 1, "creation_date": 1446530199, "post_id": 33492284, "comment_id": 54768908, "body": "It should be either in <code>$HOME&#47;.ghc&#47;ghci.conf</code> or <code>$HOME&#47;.ghci</code>. If neither exist, you can create it yourself..."}, {"owner": {"reputation": 945, "user_id": 4610065, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/BTON9.jpg?s=128&g=1", "display_name": "Michael T", "link": "https://stackoverflow.com/users/4610065/michael-t"}, "reply_to_user": {"reputation": 2152, "user_id": 1103600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7830fb399137c319ff68dca3e3b6f7e2?s=128&d=identicon&r=PG", "display_name": "Arnon", "link": "https://stackoverflow.com/users/1103600/arnon"}, "edited": false, "score": 1, "creation_date": 1446531002, "post_id": 33492284, "comment_id": 54769194, "body": "Thanks, the did the job. I made a <code>.ghci</code> file and had to execute <code>chmod 644 &#47;home&#47;myUserName&#47;.ghci</code> for it to work."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 2152, "user_id": 1103600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7830fb399137c319ff68dca3e3b6f7e2?s=128&d=identicon&r=PG", "display_name": "Arnon", "link": "https://stackoverflow.com/users/1103600/arnon"}, "edited": false, "score": 0, "creation_date": 1446570611, "post_id": 33492284, "comment_id": 54793534, "body": "@Arnon Can you post that as an answer ?"}], "answers": [{"tags": [], "owner": {"reputation": 2152, "user_id": 1103600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7830fb399137c319ff68dca3e3b6f7e2?s=128&d=identicon&r=PG", "display_name": "Arnon", "link": "https://stackoverflow.com/users/1103600/arnon"}, "is_accepted": true, "score": 3, "last_activity_date": 1446571112, "creation_date": 1446571112, "answer_id": 33505300, "question_id": 33492284, "link": "https://stackoverflow.com/questions/33492284/editing-the-ghci-file-when-using-stack/33505300#33505300", "title": "Editing the &quot;.ghci&quot; file when using stack", "body": "<p>It should be either in <code>$HOME/.ghc/ghci.conf</code> or <code>$HOME/.ghci</code>. If neither exist, you can create it yourself...</p>\n"}, {"tags": [], "owner": {"reputation": 150, "user_id": 455508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4851595dfbbe4aefd955ebd55cf44961?s=128&d=identicon&r=PG", "display_name": "SongPengpeng", "link": "https://stackoverflow.com/users/455508/songpengpeng"}, "is_accepted": false, "score": 1, "last_activity_date": 1455520419, "last_edit_date": 1592644375, "creation_date": 1455520060, "answer_id": 35403361, "question_id": 33492284, "link": "https://stackoverflow.com/questions/33492284/editing-the-ghci-file-when-using-stack/35403361#35403361", "title": "Editing the &quot;.ghci&quot; file when using stack", "body": "<p>Here's the detail: <a href=\"http://downloads.haskell.org/%7Eghc/master/users-guide/ghci.html#the-ghci-and-haskeline-files\" rel=\"nofollow noreferrer\">GHC User Guide - The .ghci and .haskeline files</a></p>\n<blockquote>\n<p>When it starts, unless the -ignore-dot-ghci flag is given, GHCi reads and executes commands from the following files, in this order, if they exist:</p>\n<ol>\n<li>./.ghci</li>\n<li>appdata/ghc/ghci.conf, where \u27e8appdata\u27e9 depends on your system, but is usually something like C:/Documents and Settings/user/Application Data</li>\n<li>On Unix: $HOME/.ghc/ghci.conf</li>\n<li>$HOME/.ghci</li>\n</ol>\n<p>The ghci.conf file is most useful for turning on favourite options (e.g. :set +s), and defining useful macros.</p>\n</blockquote>\n"}], "owner": {"reputation": 945, "user_id": 4610065, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/BTON9.jpg?s=128&g=1", "display_name": "Michael T", "link": "https://stackoverflow.com/users/4610065/michael-t"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 656, "favorite_count": 1, "accepted_answer_id": 33505300, "answer_count": 2, "score": 3, "last_activity_date": 1455520419, "creation_date": 1446530090, "question_id": 33492284, "link": "https://stackoverflow.com/questions/33492284/editing-the-ghci-file-when-using-stack", "title": "Editing the &quot;.ghci&quot; file when using stack", "body": "<p>I have started using Stack and I can't find a .ghci file to edit (I wish to include <code>:set -XOverloadedStrings</code> and <code>:set prompt \"ghci&gt; \"</code>).</p>\n\n<p>To search for the <code>.ghci</code> file I used-</p>\n\n<pre><code>$ find -name \".ghci\"\n$\n</code></pre>\n\n<p>This did not return any search results. I have looked at the Stack documentation and I couldn't find information regarding editing the a <code>.ghci</code> file. Is it possible to save <code>:set -XOverloadedStrings</code> and <code>:set prompt \"ghci&gt; \"</code> somewhere?</p>\n"}, {"tags": ["haskell", "alex"], "answers": [{"comments": [{"owner": {"reputation": 169, "user_id": 711316, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fa662528f2f8ecddad27a568d037d80f?s=128&d=identicon&r=PG", "display_name": "dfordivam", "link": "https://stackoverflow.com/users/711316/dfordivam"}, "edited": false, "score": 1, "creation_date": 1446537527, "post_id": 33492803, "comment_id": 54772155, "body": "The Alex documentation does not mention any dependence on the wrappers. <a href=\"https://www.haskell.org/alex/doc/html/alex-files.html\" rel=\"nofollow noreferrer\">alex documentation</a>. Anyways thanks for your reply!"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 4, "last_activity_date": 1446532551, "creation_date": 1446532551, "answer_id": 33492803, "question_id": 33491977, "link": "https://stackoverflow.com/questions/33491977/alex-lex-x-compilation-not-in-scope-begin/33492803#33492803", "title": "Alex lex.x compilation : Not in scope &#39;begin&#39;", "body": "<p>Start codes are only available when using any of the <code>monad-...</code> wrappers.</p>\n\n<p>If you read the docs for the monad wrapper -- <a href=\"https://www.haskell.org/alex/doc/html/wrappers.html\" rel=\"nofollow\">Section 5.3.3 - The \"monad\" wrapper</a> -- you see that it is the first wrapper which keeps track of the start code.</p>\n\n<p>You can also verify this by finding the alex wrapper files -- look for the directory containing the files <code>AlexWrapper-basic</code>, <code>AlexWrapper-posn</code>, etc. On OS X when installing the Haskell Platform they are located in a directory like <code>/Library/Haskell/ghc-7.10.2-x86_64/share/alex-3.1.4</code>. The functions <code>begin</code> and <code>andBegin</code> only occur in the monad-related wrappers.</p>\n"}], "owner": {"reputation": 169, "user_id": 711316, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fa662528f2f8ecddad27a568d037d80f?s=128&d=identicon&r=PG", "display_name": "dfordivam", "link": "https://stackoverflow.com/users/711316/dfordivam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 33492803, "answer_count": 1, "score": 2, "last_activity_date": 1446532551, "creation_date": 1446528555, "question_id": 33491977, "link": "https://stackoverflow.com/questions/33491977/alex-lex-x-compilation-not-in-scope-begin", "title": "Alex lex.x compilation : Not in scope &#39;begin&#39;", "body": "<p>I have the below statements in Lex.x to parse block comments.</p>\n\n<pre><code>&lt;0&gt;  \"//\".*                 { tokWValue LTokComment   }            \n&lt;0&gt;  \"/*\"                   { begin blockcomment      }            \n&lt;blockcomment&gt; \"*/\"         { begin 0                 }            \n&lt;blockcomment&gt; .            { tokWValue LTokComment   }  \n</code></pre>\n\n<p>But If I generate Lex.hs using Alex, it does not add the 'begin' function.\nThis results in the below compilation error. </p>\n\n<pre><code>src/Lex.x:367:18: Not in scope: \u2018begin\u2019\nsrc/Lex.x:368:18: Not in scope: \u2018begin\u2019\n</code></pre>\n\n<p>Any idea what might be wrong?</p>\n\n<p>I am using wrapper 'posn'</p>\n"}, {"tags": ["haskell", "type-inference"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1446565530, "post_id": 33491136, "comment_id": 54789906, "body": "I know the answer in the linked question mentions defaulting, but still marking the question as a duplicate of &quot;What is the monomorphism restriction?&quot; is misleading since the monomorphism restriction is not relevant here."}], "answers": [{"tags": [], "owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "is_accepted": true, "score": 4, "last_activity_date": 1446524029, "creation_date": 1446524029, "answer_id": 33491276, "question_id": 33491136, "link": "https://stackoverflow.com/questions/33491136/why-is-integer-inferred-when-the-type-variable-should-be-ambiguous/33491276#33491276", "title": "Why is Integer inferred when the type variable should be ambiguous?", "body": "<p>Haskell has a special case for dealing with the numeric classes (<code>Num</code>, <code>Fractional</code> and a few others) which picks a default type for ambiguous type variables. (See the <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch4.html#x10-790004.3.4\" rel=\"nofollow\">2010 report</a> for more details.)</p>\n\n<p>The way it works is by trying a series of numeric types until one satisfies all of the constraints. By default it first tries <code>Integer</code> and then <code>Double</code>, but you can also control this on a per-module basis:</p>\n\n<pre><code>default (Int, Rational)\n</code></pre>\n\n<p>If you want to turn defaulting off for your module, just don't give it any types:</p>\n\n<pre><code>default ()\n</code></pre>\n\n<p>Honestly, this is a big hack to make Haskell easier to use as a calculator. But it does make life quite a bit easier since we don't have to explicitly annotate the types of literals in programs like yours, which would also be confusing.</p>\n"}], "owner": {"reputation": 376, "user_id": 164967, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/274addee0e883d54fbb00f34ec1427c1?s=128&d=identicon&r=PG", "display_name": "mstone", "link": "https://stackoverflow.com/users/164967/mstone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 2, "closed_date": 1446526666, "accepted_answer_id": 33491276, "answer_count": 1, "score": 3, "last_activity_date": 1446524559, "creation_date": 1446523039, "last_edit_date": 1446524559, "question_id": 33491136, "link": "https://stackoverflow.com/questions/33491136/why-is-integer-inferred-when-the-type-variable-should-be-ambiguous", "closed_reason": "Duplicate", "title": "Why is Integer inferred when the type variable should be ambiguous?", "body": "<p>This tiny Haskell program reads two space-separated numbers from console and prints their sum:</p>\n\n<pre><code>main = do\n  line &lt;- getLine\n  let n1:n2:_ = map read $ words line\n  print $ n1 + n2\n</code></pre>\n\n<p>I'd expect the compilation to fail because of ambiguity: <code>+</code> restricts the type of <code>n1</code> and <code>n2</code> to <code>Num</code> typeclass and not to a specific type. However GHC 7.10 successfully compiles it inferring <code>Integer</code> type (replacing <code>+</code> by <code>/</code> changes the inferred type to <code>Double</code>). What is the explanation for that?</p>\n"}, {"tags": ["haskell", "backtracking"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1446525109, "post_id": 33490647, "comment_id": 54767332, "body": "You should include the definition of your <code>Sudoku</code> type."}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 1, "last_activity_date": 1446537033, "creation_date": 1446537033, "answer_id": 33493907, "question_id": 33490647, "link": "https://stackoverflow.com/questions/33490647/brute-force-sudoku-solving-in-haskell/33493907#33493907", "title": "Brute force sudoku solving in Haskell", "body": "<p>this is really broad but basically for this kind of algorithm the list-monad is your friend ;) - also you don't need the Maybe in there if you just represent the case where you cannot find a solution with []</p>\n\n<p>Here is <em>pseudo-code</em> for it:</p>\n\n<pre><code>solve :: Sudoku -&gt; [Sudoku]\nsolve sud\n    | isSudoku sud &amp;&amp; isSolved sud &amp;&amp; isOkay sud = [sud]\n    | isSudoku sud &amp;&amp; isSolved sud &amp;&amp; not (isOkay sud) = []\n    | isSudoku sud &amp;&amp; not (isSolved sud) = do\n       nr &lt;- [1..9]\n       let sud' = sud `updateNextUnsetCellWith` nr\n       solve sud'\n</code></pre>\n\n<p>of course you have to write the <code>updateNextUnsetCellWith</code> function first - it should just set <code>nr</code> into the first unset cell and return the updated state and of course it assumes that the other two cases will trigger if there are no unset cells.</p>\n\n<p><strong>Please Note</strong> this brute-force variant will drive you insane at it will take <em>a very long time</em> to produce results for reasonable problems.</p>\n"}, {"tags": [], "owner": {"reputation": 4761, "user_id": 2277395, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/09841ca82e49f998ea0b8f159dea87c1?s=128&d=identicon&r=PG", "display_name": "Martin Drautzburg", "link": "https://stackoverflow.com/users/2277395/martin-drautzburg"}, "is_accepted": false, "score": 0, "last_activity_date": 1446537419, "last_edit_date": 1446537419, "creation_date": 1446537119, "answer_id": 33493930, "question_id": 33490647, "link": "https://stackoverflow.com/questions/33490647/brute-force-sudoku-solving-in-haskell/33493930#33493930", "title": "Brute force sudoku solving in Haskell", "body": "<p>I haven't checked your code, but in general you have to act as if there is more than one solution and you try to find them all. This means at any time you iterate over all possible choices, where a choice is <code>(Cell, Integer)</code>.</p>\n\n<p>So you enter the first choice, which gives you a more complete sudoku,  and then try to solve the new sudoku in the same fashion. This results in either a solved sudoku or at some point you run out of choices before the sudoko is complete. So at any point you receive either a solved sudoku or an indication that there is no solution. In the latter case you try the next choice until the sudoku is solved or you run out of choices yourself and you return an indication that there is no solution along this path.</p>\n\n<p>As a side note: When I tried this method, I had to realize that brute foce is too slow. You get acceptable performance when you order your choices such that you first try those cells  with the smallest number of choices.</p>\n\n<p>Another side note: to test this, you can take a solved sudoku and remove one number and see if the solution is found. Then you remove two number etc. </p>\n"}], "owner": {"reputation": 43, "user_id": 4310458, "user_type": "registered", "profile_image": "https://graph.facebook.com/1006394681/picture?type=large", "display_name": "SirBearLag", "link": "https://stackoverflow.com/users/4310458/sirbearlag"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 668, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1446538242, "creation_date": 1446519510, "last_edit_date": 1446538242, "question_id": 33490647, "link": "https://stackoverflow.com/questions/33490647/brute-force-sudoku-solving-in-haskell", "title": "Brute force sudoku solving in Haskell", "body": "<p>So I'm currently writing a Sudoku solver and have to create the solve function.\nGiven:</p>\n\n<pre><code>solve :: Sudoku -&gt; [Maybe Sudoku]\n</code></pre>\n\n<p>where Sudoku's are <code>[[Maybe Int]]</code>.</p>\n\n<p>This is to be solved by brute force, so I recursively check for whether the sudoku can be solved, whether it's full but breaks constraints (such as repeated numbers in a row/column/block) and otherwise, insert 1-9 recursively in first found blank spot until it works or until I know it will never work.</p>\n\n<p>The problem arises when, say the first blank space I find accepts 1 as it's new input, but then later realizes that this won't work, then I have to go back and change that 1 to a 2, or whichever works next and try solving again. How do I go about this? Here's the current code I have for solving:</p>\n\n<pre><code>solve :: Sudoku -&gt; [Maybe Sudoku]\nsolve sud\n    | isSudoku sud &amp;&amp; isSolved sud &amp;&amp; isOkay sud = [Just sud]\n    | isSudoku sud &amp;&amp; isSolved sud &amp;&amp; not (isOkay sud) = [Nothing]\n    | isSudoku sud &amp;&amp; not (isSolved sud) = solve (helper sud (blank sud) False 1)\n\nhelper :: Sudoku -&gt; Pos -&gt; Bool -&gt; Int -&gt; Sudoku\nhelper sud pos check n\n    | n &gt; 9 || n &lt; 1 || check = sud\n    | n &gt; 0 &amp;&amp; n &lt; 10 &amp;&amp; not check = \n        do\n            let newSud = (update sud pos (Just n))\n            helper newSud pos (isOkay newSud) (n+1)\n</code></pre>\n\n<p>Any inputs on how to go about this?</p>\n\n<p>Edit: Sudoku is implemented as:</p>\n\n<pre><code>data Sudoku = Sudoku [[Maybe Int]]\nderiving ( Eq )\n</code></pre>\n\n<p>For the feedback I've gotten so far, the code above already solves sudokus. The issue is for when there are enough blank spots that a certain spot could accept multiple numbers rather than only working with one. Say a blank spot works with the number 5 and 8, but 8 is the right answer and 5 makes it unsolvable. Then I have to go back and change it and try solving all the next blanks again.</p>\n"}, {"tags": ["haskell", "reactive-programming", "arrows"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1446519105, "post_id": 33490143, "comment_id": 54765827, "body": "Lazy evaluation can affect whether a program gets stuck in an infinite loop, but it cannot change a program that successfully does one thing into a program that successfully does another. Is the program stuck, or just wrong?"}, {"owner": {"reputation": 227, "user_id": 3814154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f088a7b1bd081b844b1f28c3a8a186fb?s=128&d=identicon&r=PG&f=1", "display_name": "Lovaz", "link": "https://stackoverflow.com/users/3814154/lovaz"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1446519399, "post_id": 33490143, "comment_id": 54765886, "body": "@dfeuer it&#39;s wrong. Output singal is not fed into the loop."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1446519708, "post_id": 33490143, "comment_id": 54765944, "body": "If it produces wrong output, you can rule out laziness as the cause."}], "answers": [{"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 2, "last_activity_date": 1447228888, "last_edit_date": 1447228888, "creation_date": 1447144842, "answer_id": 33625848, "question_id": 33490143, "link": "https://stackoverflow.com/questions/33490143/recursive-feedback-in-karplus-strong-algo-arrows/33625848#33625848", "title": "Recursive feedback in Karplus-Strong Algo - arrows", "body": "<p>The problem is not lazy evaluation or recursive arrows; rather, it's that <code>filterLowPass</code> doesn't behave nice on <code>burst</code>: it becomes <code>NaN</code> after the burst finishes.</p>\n\n<p>We can see that by running it e.g. in GHCi:</p>\n\n<pre><code>\u03bb\u00bb take 15 $ drop 30870 $ Control.SF.SF.run (strip $ burst &gt;&gt;&gt; arr (,2000) &gt;&gt;&gt; filterLowPass) $ repeat ()\n[0.17166330080286152,0.27722776378398983,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN,NaN]\n</code></pre>\n\n<p>I strongly suspect it is because <code>burst</code> itself behaves strangely near its end:</p>\n\n<pre><code>\u03bb\u00bb take 15 $ drop 30870 $ Control.SF.SF.run (strip $ burst) $ repeat ()\n[0.5998949495013488,NaN,0.0,-0.0,-0.0,0.0,-0.0,-0.0,0.0,-0.0,-0.0,-0.0,0.0,-0.0,0.0]\n</code></pre>\n\n<p>My suggestion is to fix <code>burst</code> so that it doesn't generate a <code>NaN</code> at its end, and then see if that fixes everything. The 0/-0 oscillation is probably harmless.</p>\n\n<p><strong>Attempt at fixing</strong></p>\n\n<p>I have no idea about either Euterpea or sound synthesis; however, by using a very short, but non-0 transition time from 1 to 0 for <code>burstEnv</code>, I was able to get rid of the <code>NaN</code>s. By further reducing the length of the burst and the delay line, I think I got something which is close to the desired \"string-like\" sound:</p>\n\n<pre><code>burst :: AudSF () Double\nburst = proc () -&gt; do\n   burstEnv &lt;- envLineSeg [1,1,0,0] [0.01, 0.000001, 9.3] -&lt; ()\n   noise &lt;- noiseWhite 42 -&lt; ()\n   outA -&lt; burstEnv * noise\n\nkarplus :: AudSF Double Double\nkarplus = proc input -&gt; do\n    rec delayed &lt;- delayLine 0.01 -&lt; filtered + input\n        filtered &lt;- filterLowPass -&lt; (delayed, 2000)\n    outA -&lt; filtered + input\n</code></pre>\n"}], "owner": {"reputation": 227, "user_id": 3814154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f088a7b1bd081b844b1f28c3a8a186fb?s=128&d=identicon&r=PG&f=1", "display_name": "Lovaz", "link": "https://stackoverflow.com/users/3814154/lovaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 1, "accepted_answer_id": 33625848, "answer_count": 1, "score": 5, "last_activity_date": 1447228888, "creation_date": 1446515381, "last_edit_date": 1447144872, "question_id": 33490143, "link": "https://stackoverflow.com/questions/33490143/recursive-feedback-in-karplus-strong-algo-arrows", "title": "Recursive feedback in Karplus-Strong Algo - arrows", "body": "<p>I am trying to implement the simplest version of <a href=\"https://en.wikipedia.org/wiki/Karplus%E2%80%93Strong_string_synthesis\" rel=\"nofollow noreferrer\">Karplus-Strong algorithm</a> using <a href=\"https://hackage.haskell.org/package/Euterpea\" rel=\"nofollow noreferrer\">Euterpea</a>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/fsFW7.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fsFW7.png\" alt=\"schematic of KS algorithm\"></a></p>\n\n<p>My code:\n0.7 seconds of white noise burst</p>\n\n<pre><code>burst :: AudSF () Double\nburst = proc () -&gt; do \n   burstEnv &lt;- envLineSeg [1,1,0,0] [0.7, 0, 9.3] -&lt; ()\n   noise &lt;- noiseWhite 42 -&lt; ()\n   outA -&lt; burstEnv * noise\n</code></pre>\n\n<p>problematic part:</p>\n\n<pre><code>karplus :: AudSF Double Double\nkarplus = proc input -&gt; do \n  rec  filtered &lt;- filterLowPass -&lt; (delayed, 2000)\n       delayed &lt;- delayLine 0.7 -&lt; filtered + input      \n  outA -&lt; filtered + input\n</code></pre>\n\n<p>test1 function should create a file of 10 seconds with a few cycles:</p>\n\n<pre><code>test1 = outFile \"test1.wav\" 10 $ burst &gt;&gt;&gt; karplus\n</code></pre>\n\n<p>As far as I know the feedback loop should run on and on and on. </p>\n\n<p>The problem is the input is only delayed and filtered once. It's not fed to the loop again.</p>\n\n<p>I suspect that the problem lies in my not understanding lazy evaluation or value passing.</p>\n"}, {"tags": ["haskell", "continuations", "continuation-passing"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 5, "creation_date": 1446508498, "post_id": 33489043, "comment_id": 54763100, "body": "I have not seen many uses of straight continuations... anywhere.  There are a lot of derivatives.  I don&#39;t find the derivatives to be any less pure -- almost everything in Haskell is some combination of products, coproducts, and functions (and products and coproducts can be modeled using functions)."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1446509624, "post_id": 33489043, "comment_id": 54763425, "body": "@luqui And type classes (type classes is the one thing I dislike about Haskell. They are done poorly in Haskell.)"}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 2, "creation_date": 1446510046, "post_id": 33489043, "comment_id": 54763569, "body": "This might interest you: <a href=\"http://www.thev.net/PaulLiu/invert-inversion.html\" rel=\"nofollow noreferrer\">thev.net/PaulLiu/invert-inversion.html</a>"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1446511205, "post_id": 33489043, "comment_id": 54763839, "body": "a <i>&quot;very pure functional programming concept, while being very powerful&quot;</i> is also FRP, in case you might be interested; I don&#39;t think continuations are something to be too keen on <i>per se</i>."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 4, "creation_date": 1446515182, "post_id": 33489043, "comment_id": 54764769, "body": "Can you define what you mean by &quot;inversion of control&quot;? I&#39;ve mostly heard that term used disparagingly to describe the soupy quality of callback-heavy code"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 4, "creation_date": 1446519385, "post_id": 33489043, "comment_id": 54765882, "body": "@PyRulez, many of us think Haskell type classes are the only ones done right. See Edward Kmett&#39;s video <a href=\"https://www.google.com/url?q=http://m.youtube.com/watch%3Fv%3DhIZxTQP1ifo&amp;sa=U&amp;ved=0CAsQtwIwAGoVChMIpMewsaDzyAIVQ0AmCh2FggtT&amp;sig2=bcftOWg7Nss7tTVBe9s4lg&amp;usg=AFQjCNEBMR2fT2mxOniLf-UI6dBxz_hnaA\" rel=\"nofollow noreferrer\">Type classes vs. the World</a>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1446519651, "post_id": 33489043, "comment_id": 54765932, "body": "Also, &quot;pure&quot; continuation passing (as with <code>Cont</code>) is much less useful than its &quot;impure&quot; forms (<code>ContT</code>). The same is true in, e.g., Scheme, where continuations are used to implement imperative-style control structures."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1446543754, "post_id": 33489043, "comment_id": 54775451, "body": "@dfeuer I don&#39;t mean pure in the technical sense. <code>ContT</code> is just a specialization of <code>Cont</code>."}, {"owner": {"reputation": 532, "user_id": 660339, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/ba401042a68ed65c16f73c8cf3a15287?s=128&d=identicon&r=PG", "display_name": "Ivan Perez", "link": "https://stackoverflow.com/users/660339/ivan-perez"}, "edited": false, "score": 0, "creation_date": 1446731117, "post_id": 33489043, "comment_id": 54871914, "body": "There&#39;s also a continuation-based FRP implementation (Yampa), and it has been used to do GUI stuff. Signal Functions are just functions with continuations that take the time since the last simulation as argument. Other than that, they are just what you expressed above.  As part of my PhD I&#39;m working on a more general version of Yampa and that might suit your purposes even better. Feel free to drop me a line and give more details, if you want :)  Disclaimer: I am the maintainer of Yampa."}], "owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 232, "favorite_count": 0, "closed_date": 1446924497, "answer_count": 0, "score": 2, "last_activity_date": 1446922826, "creation_date": 1446507762, "last_edit_date": 1446922826, "question_id": 33489043, "link": "https://stackoverflow.com/questions/33489043/haskell-continuations-for-inversion-of-control-in-the-wild", "closed_reason": "Not suitable for this site", "title": "Haskell Continuations for inversion of control in the wild?", "body": "<p>Continuations are interesting. Especially interesting is how they encompass all other monads. Also, I hear they are used a lot for optimizing. One thing I hear they <em>could</em> be used for is inversion of control in things. Like, gui's and stuff. I am wondering if there is an example of a library in Haskell that uses this.</p>\n\n<p>I'm not particularly interested in it being popular or anything. I mainly want it for reading. Factors to consider:</p>\n\n<ul>\n<li>Straight continuations, not continuation derivatives: It should be based on a type similar to <code>newtype Cont r a = Cont ((a -&gt; r) -&gt; r)</code>. (Combinators are okay, but it should be understandable how straight continuations are fitting into it.)</li>\n<li>Used for inversion of control: Continuations are used for many uses, but I'm interested mostly in GUI type things or other places where inversion of control makes things easier</li>\n<li>Prevalence: Continuations should be the prevalent control structure.</li>\n<li>Well written: Code should be easier to read and learn from.</li>\n</ul>\n\n<p>(The reason why I want to do this is I find Continuations, being based only on functions, to be a very pure functional programming concept, while being very powerful. There is this one library I like that is very straight functional programming, and I would love to extend it with continuations.)</p>\n\n<p>Note: Being straight continuations isn't very important. Inversion of Control is what I'm mostly after.</p>\n"}, {"tags": ["haskell", "polymorphism"], "comments": [{"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1446504164, "post_id": 33488322, "comment_id": 54761496, "body": "its a duplicate, sorry.."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 1, "creation_date": 1446507340, "post_id": 33488322, "comment_id": 54762692, "body": "Actually, it is not <i>quite</i> a duplicate. In the original question the only thing that wasn&#39;t working was <code>do</code> notation. But nowadays, GHC&#39;s <code>ImpredicativeTypes</code> extension almost doesn&#39;t work at all, so <i>everything</i> in the code breaks. Even with your <code>demonbind2</code> definition, I think you will find it very hard to <i>use</i> <code>(?&gt;=)</code>."}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1446541498, "post_id": 33488322, "comment_id": 54774057, "body": "true, not really a duplicate. I&#39;ll go on with manual expansion. That&#39;s really a minor harm. what is annoying on the moment is that you&#39;d <i>expect</i> such simple operation to work out of the box."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1454540530, "post_id": 33488322, "comment_id": 58096033, "body": "Nope, I wouldn&#39;t call it a duplicate either. Reopened."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1458696053, "post_id": 36168156, "comment_id": 59973563, "body": "That&#39;s surprising and also, I think, mostly not the case. I remember someone mentioning some new <code>ImpredicativeTypes</code> brokenness. Richard Eisenberg, who&#39;s made some major changes to the type system recently, responded that he&#39;d made no effort whatsoever to avoid further breakage to that already-broken extension."}, {"owner": {"reputation": 589, "user_id": 1486400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b6c720fd6b86fdf2293eefb5188d46b?s=128&d=identicon&r=PG", "display_name": "int_index", "link": "https://stackoverflow.com/users/1486400/int-index"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1458696314, "post_id": 36168156, "comment_id": 59973629, "body": "@dfeuer I didn&#39;t say that <code>ImpredicativeTypes</code> work now. I&#39;ve only said that they <i>seem</i> <i>less broken</i>, and that&#39;s a completely different statement. They surely shouldn&#39;t be used until they get a proper fix."}, {"owner": {"reputation": 589, "user_id": 1486400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b6c720fd6b86fdf2293eefb5188d46b?s=128&d=identicon&r=PG", "display_name": "int_index", "link": "https://stackoverflow.com/users/1486400/int-index"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1458696477, "post_id": 36168156, "comment_id": 59973674, "body": "On a positive note, there appears to be some work happening towards making them work: <a href=\"https://ghc.haskell.org/trac/ghc/raw-attachment/wiki/ImpredicativePolymorphism/Impredicative-2015/impredicativity.pdf\" rel=\"nofollow noreferrer\">ghc.haskell.org/trac/ghc/raw-attachment/wiki/&hellip;</a>"}], "tags": [], "owner": {"reputation": 589, "user_id": 1486400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b6c720fd6b86fdf2293eefb5188d46b?s=128&d=identicon&r=PG", "display_name": "int_index", "link": "https://stackoverflow.com/users/1486400/int-index"}, "is_accepted": false, "score": 2, "last_activity_date": 1458695902, "creation_date": 1458695902, "answer_id": 36168156, "question_id": 33488322, "link": "https://stackoverflow.com/questions/33488322/ranknpolymorphism-and-kleisli-arrows-of-outrageous-fortune/36168156#36168156", "title": "RankNpolymorphism and kleisli arrows of outrageous fortune", "body": "<p>Somewhat surprisingly, <code>ImpredicativeTypes</code> seem less broken than usual on the development snapshot of GHC 8.0! This compiles without errors:</p>\n\n<pre><code>(?&gt;=) :: (IFunctor m, IMonad m) =&gt; m a i -&gt; (a :-&gt; m b) -&gt; m b i\n(?&gt;=) = flip bind\n</code></pre>\n\n<p>I wonder what change fixed the problem.</p>\n"}], "owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1458695902, "creation_date": 1446503901, "question_id": 33488322, "link": "https://stackoverflow.com/questions/33488322/ranknpolymorphism-and-kleisli-arrows-of-outrageous-fortune", "title": "RankNpolymorphism and kleisli arrows of outrageous fortune", "body": "<p>I dont understand why the definition of demonbind1 yields some compiler errors. it looks like a stupid flip but somehow..</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n{-# LANGUAGE RankNTypes, ScopedTypeVariables, TypeOperators, TypeFamilies,ImpredicativeTypes   #-}\n\ntype a :-&gt; b = forall i . a i -&gt; b i\n\nclass IFunctor f where imap :: (a :-&gt; b) -&gt; (f a :-&gt; f b)\n\nclass (IFunctor m) =&gt; IMonad m where\n    skip :: a :-&gt; m a\n    bind :: (a :-&gt; m b) -&gt; (m a :-&gt; m b)\n\n\n-- Conor McBride's \"demonic bind\"\n(?&gt;=) :: forall m a b i. (IFunctor m, IMonad m) =&gt; m a i -&gt; (a :-&gt; m b) -&gt; m b i\n(?&gt;=) =  \n  let\n    -- OK \n    demonbind0 = flip (bind :: forall i. (forall j. a j -&gt; m b j)  -&gt; m a i -&gt; m b i ) \n    -- KO - see error below\n    demonbind1 = flip  bind :: forall i. m a i -&gt; (forall j. a j -&gt; m b j)  -&gt;  m b i\n\n    -- So i have to write this\n    demonbind2 :: forall i. (m a i -&gt;  (a :-&gt; m b)  -&gt;  m b i )\n    demonbind2 mai ti = (bind ti) mai \n  in demonbind2\n</code></pre>\n\n<p>The error is </p>\n\n<pre><code>Couldn't match type \u2018a j0 -&gt; m b j0\u2019 \u2026\n              with \u2018forall i2. a i2 -&gt; m b i2\u2019\n    Expected type: (a j0 -&gt; m b j0) -&gt; m a i1 -&gt; m b i1\n      Actual type: a :-&gt; m b -&gt; m a i1 -&gt; m b i1\n In the first argument of \u2018flip\u2019, namely \u2018bind\u2019\n    In the expression:\n        flip bind :: forall i. m a i -&gt; (forall j. a j -&gt; m b j) -&gt; m b i\n</code></pre>\n"}, {"tags": ["haskell", "monads", "maybe"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 3, "creation_date": 1446484502, "post_id": 33483050, "comment_id": 54751277, "body": "Your question stems from a misunderstanding of <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Maybe.html#v:fromMaybe\" rel=\"nofollow noreferrer\"><code>fromMaybe</code></a> and a confusion about <code>elseZero</code>&#39;s type signature: <code>elseZero</code> is a function that requires one argument (<code>Maybe a</code>). GHCi will complain if you try to evaluate it without supply it a value of type <code>Maybe a</code>. <code>elseZero Nothing</code> returns <code>0</code>, because no value can be extracted from <code>Nothing</code>."}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 4, "creation_date": 1446484632, "post_id": 33483050, "comment_id": 54751347, "body": "<code>Maybe a</code> is not an optional argument, you have to provide a value of type <code>Maybe a</code> e.g. <code>fromMaybe Nothing</code> or <code>fromMaybe (Just 3)</code>."}, {"owner": {"reputation": 113, "user_id": 2874652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/693248dafd99b8b27e3d519bb2c220df?s=128&d=identicon&r=PG&f=1", "display_name": "todkwxrtvwmzonunswam", "link": "https://stackoverflow.com/users/2874652/todkwxrtvwmzonunswam"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1446485371, "post_id": 33483050, "comment_id": 54751741, "body": "Thanks @Jubobs. Looking at the types for the Just (a -&gt; Maybe a) and Nothing data constructors was very helpful. I was hoping to use Maybe as a way of cleaning up some code by making optional function parameters take default values. I now see that this will either require using Just or a helper function."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1446486103, "post_id": 33483050, "comment_id": 54752122, "body": "@todkwxrtvwmzonunswam You may like Brent Yorgey&#39;s post on <a href=\"https://byorgey.wordpress.com/2010/04/03/haskell-anti-pattern-incremental-ad-hoc-parameter-abstraction/\" rel=\"nofollow noreferrer\">incremental ad-hoc parameter abstraction</a>."}], "answers": [{"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": false, "score": 1, "last_activity_date": 1459226879, "creation_date": 1459226879, "answer_id": 36275667, "question_id": 33483050, "link": "https://stackoverflow.com/questions/33483050/can-maybe-be-used-for-optional-arguments/36275667#36275667", "title": "Can Maybe be used for optional arguments?", "body": "<p><code>elseZero</code>'s type is <code>(Num a) =&gt; Maybe a -&gt; a</code>, so that is what GHCi will try to <code>show</code> you. However, functions are not <code>show</code>able, which is what the error message is telling you.</p>\n\n<p>Your fundamental misunderstanding seems to be that you think <code>elseZero</code> and <code>elseZero Nothing</code> are the same. But the former is a function of type <code>(Num a) =&gt; Maybe a -&gt; a</code> that returns either the <code>Just</code>-value or 0, and the latter is 0 of type <code>(Num a) =&gt; a</code>.</p>\n"}], "owner": {"reputation": 113, "user_id": 2874652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/693248dafd99b8b27e3d519bb2c220df?s=128&d=identicon&r=PG&f=1", "display_name": "todkwxrtvwmzonunswam", "link": "https://stackoverflow.com/users/2874652/todkwxrtvwmzonunswam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1459226942, "creation_date": 1446484010, "last_edit_date": 1459226942, "question_id": 33483050, "link": "https://stackoverflow.com/questions/33483050/can-maybe-be-used-for-optional-arguments", "title": "Can Maybe be used for optional arguments?", "body": "<p>I'm having trouble getting the following to work in GHCi. It's a short example that pops up several places online.</p>\n\n<pre><code>import Data.Maybe\n\nelseZero :: (Num a) =&gt; Maybe a -&gt; a\nelseZero n = fromMaybe 0 n\n</code></pre>\n\n<p>My understanding is that when I load this into GHCi and then run with <code>elseZero</code> it should return 0, since no argument is given.</p>\n\n<p>But I receive the error: </p>\n\n<pre><code>Non type-variable argument in the constraint: Num (Maybe a)\n(Use FlexibleContexts to permit this)\nWhen checking that `it' has the inferred type\n  it :: forall a. (Num a, Num (Maybe a)) =&gt; a\n</code></pre>\n\n<p>New to all parts Monadic of Haskell. Thanks for your help!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1446475758, "post_id": 33480140, "comment_id": 54745326, "body": "Your code looks fine. Do you happen to have tabs in your source code?"}, {"owner": {"reputation": 39, "user_id": 5516221, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8f3c35aab4646249dc297792c641b19?s=128&d=identicon&r=PG&f=1", "display_name": "Kent Johnson", "link": "https://stackoverflow.com/users/5516221/kent-johnson"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1446476136, "post_id": 33480140, "comment_id": 54745570, "body": "Thanks,that was the problem"}, {"owner": {"reputation": 1332, "user_id": 7652, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a1b8eee656d49ca6a3ed9ffc665ba5f9?s=128&d=identicon&r=PG", "display_name": "TygerKrash", "link": "https://stackoverflow.com/users/7652/tygerkrash"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1446478939, "post_id": 33480140, "comment_id": 54747553, "body": "@chi  Can you post this as an answer and  Kent mark it as accepted please."}], "owner": {"reputation": 39, "user_id": 5516221, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8f3c35aab4646249dc297792c641b19?s=128&d=identicon&r=PG&f=1", "display_name": "Kent Johnson", "link": "https://stackoverflow.com/users/5516221/kent-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 365, "favorite_count": 1, "closed_date": 1446480989, "answer_count": 0, "score": 1, "last_activity_date": 1446480630, "creation_date": 1446475196, "last_edit_date": 1446480630, "question_id": 33480140, "link": "https://stackoverflow.com/questions/33480140/parse-error-in-pattern-putstrln-possibly-caused-by-a-missing-do", "closed_reason": "Duplicate", "title": "Parse error in pattern: putStrLn Possibly caused by a missing &#39;do&#39;?", "body": "<p>I am new to Hakell and is getting Following error when i am trying to execute the program.</p>\n\n<p>Parse error in pattern: putStrLn<br>\nPossibly caused by a missing 'do'?  </p>\n\n<pre><code>import Data.List  \nimport System.IO  \n\nmain=do  \n    putStrLn\"Enter your name\"  \n    name&lt;-getLine  \n    putStrLn(\"m, \"++name)  \n</code></pre>\n"}, {"tags": ["haskell", "repa"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 1, "creation_date": 1446445676, "post_id": 33470647, "comment_id": 54729251, "body": "Do you have a specific example of what you want to do?"}, {"owner": {"reputation": 1424, "user_id": 756714, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a0c58c5ad07c97f187f3a9241c4d2639?s=128&d=identicon&r=PG", "display_name": "vivian", "link": "https://stackoverflow.com/users/756714/vivian"}, "edited": false, "score": 0, "creation_date": 1446449036, "post_id": 33470647, "comment_id": 54730543, "body": "You could use the <code>hmatrix-repa</code> package to convert to an <code>hmatrix</code> array which is a no-op conversion to a C-type array.  Or you could just copy the code from <code>hmatrix-repa</code> it is that small."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1446472024, "post_id": 33470647, "comment_id": 54742860, "body": "Folding repa arrays only makes sense if the function is associative and the zero value must be the left and right identity, because the functions <code>foldAllP</code> and <code>foldAllS</code> make no guarantee in terms of the order in which elements are associated. In fact, <code>foldAllP</code> could freely pick a <i>different</i> association on each invocation."}, {"owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1446735078, "post_id": 33470647, "comment_id": 54874898, "body": "@ErikR I inferred the reason already. My Repa array has info meant for graphical display, and I would like to fold it into a data structure that I can pass to graphics library. At the moment I&#39;m using gloss."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1446735881, "post_id": 33470647, "comment_id": 54875494, "body": "If you have a specific example we could help you write the most efficient code. List comprehensions are not always the fastest way to iterate through a matrix."}], "answers": [{"tags": [], "owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "is_accepted": false, "score": 0, "last_activity_date": 1457952651, "creation_date": 1457952651, "answer_id": 35985530, "question_id": 33470647, "link": "https://stackoverflow.com/questions/33470647/how-to-fold-a-repa-array-into-an-arbitrary-value/35985530#35985530", "title": "How to fold a Repa array into an arbitrary value?", "body": "<p>Repa does not allow you to fold in any particular direction, because during parallel computation:</p>\n\n<blockquote>\n  <p><code>foldAllP</code>: Applications of the operator are associated arbitrarily.</p>\n</blockquote>\n\n<p>On the other hand, folding sequentially should not impose a restriction on the accumulator to be of the same type as array elements, but unfortunately it is also the case with <code>foldAllS</code>.</p>\n\n<p>There is a very easy workaround through falling back onto underlying vector package, namely convert a repa array to an unboxed vector using <code>toUnboxed</code> and then simply use <a href=\"http://hackage.haskell.org/package/vector\" rel=\"nofollow\">vector</a> package functionality. Which, obviously, means folding will not be done in parallel, but it will still be much faster than using lists. Example:</p>\n\n<pre><code>\u03bb&gt;  import qualified Data.Vector.Unboxed as V\n\u03bb&gt; :t V.foldr\nV.foldr :: Unbox a =&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; Vector a -&gt; b\n\u03bb&gt; :t V.foldl\nV.foldl :: Unbox b =&gt; (a -&gt; b -&gt; a) -&gt; a -&gt; Vector b -&gt; a\n\u03bb&gt; V.foldr ((&amp;&amp;) . (&gt;0.5)) True $ toUnboxed repaArray\n</code></pre>\n"}], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1457952651, "creation_date": 1446437553, "question_id": 33470647, "link": "https://stackoverflow.com/questions/33470647/how-to-fold-a-repa-array-into-an-arbitrary-value", "title": "How to fold a Repa array into an arbitrary value?", "body": "<p>All the reduction functions of <a href=\"https://hackage.haskell.org/package/repa\" rel=\"noreferrer\">Repa</a> fold back into the same types as the array contents. For example:</p>\n\n<pre><code>foldAllP :: (Shape sh, Source r a, Elt a, Unbox a, Monad m) =&gt; (a -&gt; a -&gt; a) -&gt; a -&gt; Array r sh a -&gt; m a\nfoldAllS :: (Shape sh, Source r a, Elt a, Unbox a) =&gt; (a -&gt; a -&gt; a) -&gt; a -&gt; Array r sh a -&gt; a\n</code></pre>\n\n<p>I'd like to fold a repa array into an data structure that I can pass to a GUI library to render, i.e. an arbitrary value, but I cannot find a function in the library to do this. Does this function exist or do I have to iterate over cells using <code>[... | x &lt;- [0..w-1], y &lt;- [0..h-1]]</code> ?</p>\n"}, {"tags": ["haskell", "record"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 3, "creation_date": 1446440395, "post_id": 33470368, "comment_id": 54727547, "body": "You are looking for lens library."}], "answers": [{"tags": [], "owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "is_accepted": false, "score": 1, "last_activity_date": 1446471051, "creation_date": 1446471051, "answer_id": 33478772, "question_id": 33470368, "link": "https://stackoverflow.com/questions/33470368/haskell-records-update/33478772#33478772", "title": "Haskell records update", "body": "<p>Every update is just a function of type <code>MyRec -&gt; MyRec</code>.</p>\n\n<p>Your code becomes:</p>\n\n<pre><code>data MyRec = MyRec {field1 :: String, field2 :: Int, field3 :: Bool} deriving Show\ndefRec = MyRec {field1 = \"\", field2 = 0, field3 = False}\n\nupdate :: [MyRec -&gt; MyRec] -&gt; MyRec -&gt; MyRec\nupdate flds rec = foldl' (flip ($)) rec flds\n\nnameVals = [(\\ r -&gt; r { field1 = \"foo\" }), (\\ r -&gt; r { field3 = True })]\nupdtdRec = update nameVals defRec\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 5405910, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/n6tYN.jpg?s=128&g=1", "display_name": "Yuu Igarashi", "link": "https://stackoverflow.com/users/5405910/yuu-igarashi"}, "is_accepted": true, "score": 2, "last_activity_date": 1446483691, "creation_date": 1446483691, "answer_id": 33482966, "question_id": 33470368, "link": "https://stackoverflow.com/questions/33470368/haskell-records-update/33482966#33482966", "title": "Haskell records update", "body": "<p>As Sibi comments, what you want is lens. It provides a powerful way of manipulating data types.</p>\n\n<p>Example:</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\nimport Control.Lens\n\ndata MyRec = MyRec { _field1 :: String, _field2 :: Int, _field3 :: Bool } \n             deriving(Show)\nmakeLenses ''MyRec\n\nmain :: IO ()\nmain = do\n  let myrec    = MyRec { _field1 = \"\", _field2 = 0, _field3 = False }\n      myrec'   = myrec &amp; field1 .~ \"updated\"\n      myrec''  = myrec' &amp; field2 .~ 1\n      myrec''' = myrec'' &amp; field3 .~ True\n  print myrec    -- MyRec {_field1 = \"\", _field2 = 0, _field3 = False}\n  print myrec'   -- MyRec {_field1 = \"updated\", _field2 = 0, _field3 = False}\n  print myrec''  -- MyRec {_field1 = \"updated\", _field2 = 1, _field3 = False}\n  print myrec''' -- MyRec {_field1 = \"updated\", _field2 = 1, _field3 = True}\n</code></pre>\n\n<p>You can write a function like <code>update field val = MyRec {field = val}</code>.</p>\n\n<pre><code>update :: MyRec -&gt; ASetter MyRec MyRec t t -&gt; t -&gt; MyRec\nupdate record field val = record &amp; field .~ val\n\n&gt; update defRec field1 \"updated\"\nMyRec {_field1 = \"updated\", _field2 = 0, _field3 = False}\n</code></pre>\n\n<p>These are very compact, but tuples of a lense and a corresponding value have different types. For example, <code>(field1, \"updated\")</code> and <code>(field2, 1)</code> have different types, so it is difficult to write a list for updating.</p>\n\n<p>The link below will help you get started with lens.</p>\n\n<p><a href=\"https://hackage.haskell.org/package/lens-tutorial-1.0.0/docs/Control-Lens-Tutorial.html\" rel=\"nofollow\">https://hackage.haskell.org/package/lens-tutorial-1.0.0/docs/Control-Lens-Tutorial.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 1, "last_activity_date": 1446515156, "creation_date": 1446515156, "answer_id": 33490111, "question_id": 33470368, "link": "https://stackoverflow.com/questions/33470368/haskell-records-update/33490111#33490111", "title": "Haskell records update", "body": "<p>You can do it with TemplateHaskell. Here's one way to do it:</p>\n\n<p>File MyTH2.hs:</p>\n\n<pre><code>module MyTH2 where\n\nimport Language.Haskell.TH\nimport Data.List\n\nmkUpdaterForRecordType :: String -&gt; Name -&gt; Q [Dec]\nmkUpdaterForRecordType fname tyname = do\n  i &lt;- reify tyname\n  let cs = case i of\n            TyConI (DataD _ _ _ cs _) -&gt; cs\n            _                         -&gt; []\n      ls = [ l | (RecC _ ls) &lt;- cs, l &lt;- ls ]\n      ns = [ nameBase n  | (n, _, _) &lt;- ls ]\n  mkUpdater fname ns\n\nmkUpdater :: String -&gt; [String] -&gt; Q [Dec]\nmkUpdater fname names = do\n  let clauses = map mkClause names\n      varb = mkName \"b\"\n      clause0 = Clause [ WildP, WildP, (VarP varb) ] (NormalB $ VarE varb) []\n      decl1 = FunD (mkName fname) (clauses ++ [clause0])\n  return [decl1]\n\nmkClause :: String -&gt; Clause\nmkClause fldname = \n  let vara = mkName \"a\"\n      varb = mkName \"b\"\n      varf = mkName fldname\n      pats = [ LitP (StringL fldname) , VarP vara, VarP varb ]\n      body = NormalB $ RecUpdE (VarE varb) [ (varf, AppE (VarE varf) (VarE vara)) ]\n      clause = Clause pats body []\n  in clause\n</code></pre>\n\n<p>File Main.hs:</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\n\nimport MyTH2\n\ndata MyRec = MyRec {field1 :: String, field2 :: Int, field3 :: Bool} deriving Show\n\nold1 = MyRec \"old1\" 1 False\nnew2 = MyRec \"new2\" 2 True\n\n$(mkUpdaterForRecordType \"update\" ''MyRec)\n\ntest1 = update \"field1\" new2 old1\ntest2 = update \"field2\" new2 old1\ntest3 = update \"field3\" new2 old1\ntest4 = update \"other\" new2 old1   -- no update performed\n</code></pre>\n\n<p>Note that the Template Haskell has to be in its own module.</p>\n"}], "owner": {"reputation": 896, "user_id": 2518338, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/a6ab599e92773610e7eed102bd4e2499?s=128&d=identicon&r=PG", "display_name": "Janthelme", "link": "https://stackoverflow.com/users/2518338/janthelme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 922, "favorite_count": 1, "accepted_answer_id": 33482966, "answer_count": 3, "score": 3, "last_activity_date": 1446515156, "creation_date": 1446435610, "last_edit_date": 1446447658, "question_id": 33470368, "link": "https://stackoverflow.com/questions/33470368/haskell-records-update", "title": "Haskell records update", "body": "<p>I would like to update a record with external (streams of) name/value pairs. The record's fields have different types. </p>\n\n<p>That's how I did it, is there a more elegant Haskell way to do this?</p>\n\n<pre><code>data MyRec = MyRec {field1 :: String, field2 :: Int, field3 :: Bool} deriving Show\ndefRec = MyRec {field1 = \"\", field2 = 0, field3 = False}\n\nsingleUpdate :: String -&gt; MyRec -&gt; MyRec  -&gt; MyRec\nsingleUpdate \"field1\" urec rec = rec {field1 = field1 urec}\nsingleUpdate \"field2\" urec rec = rec {field2 = field2 urec}\nsingleUpdate \"field3\" urec rec = rec {field3 = field3 urec}\nsingleUpdate _ _ rec = rec\n\nupdate :: [(String, MyRec)] -&gt; MyRec -&gt; MyRec\nupdate flds rec = foldl (flip (uncurry singleUpdate)) rec flds\n\nnameVals = [(\"field1\",defRec {field1 = \"foo\"}), (\"field3\",defRec {field3 = True})]\nupdtdRec   = update nameVals defRec\n</code></pre>\n\n<p>updtdRec returns <code>MyRec {field1 = \"foo\", field2 = 0, field3 = True}</code></p>\n\n<p>Is there a more compact way, closer to something like this : <code>update field val = MyRec {field = val}</code> (this is just pseudo-code), which works for all fields, without having to specify the function implementation for each field?</p>\n"}, {"tags": ["haskell", "template-haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1446472194, "post_id": 33470266, "comment_id": 54742963, "body": "&quot;So what&#39;s equivalent to Language.Haskell.Exts.Syntax.Module in template haskell?&quot; There is none, it simply doesn&#39;t support it. You cannot splice an entire module (at least yet)."}, {"owner": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1446474589, "post_id": 33470266, "comment_id": 54744517, "body": "Is there a reason for that?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1446475400, "post_id": 33470266, "comment_id": 54745090, "body": "I would assume that it is a majour technical challenge, and there hasn&#39;t been much demand for it. I don&#39;t know how it would even work - you can&#39;t have a module inside a module."}, {"owner": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1446476078, "post_id": 33470266, "comment_id": 54745532, "body": "That makes sense. If you put your first comment as an answer I will accept it."}], "answers": [{"tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": true, "score": 1, "last_activity_date": 1446481235, "creation_date": 1446481235, "answer_id": 33482187, "question_id": 33470266, "link": "https://stackoverflow.com/questions/33470266/language-haskell-exts-syntax-module-to-template-haskell-data-structure/33482187#33482187", "title": "Language.Haskell.Exts.Syntax.Module to Template Haskell data structure", "body": "<p>There is no equivalent to <code>Language.Haskell.Exts.Syntax.Module</code> in Template Haskell, it simply doesn't support it. You cannot splice an entire module (at least yet). </p>\n"}], "owner": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 33482187, "answer_count": 1, "score": 0, "last_activity_date": 1446481235, "creation_date": 1446434632, "question_id": 33470266, "link": "https://stackoverflow.com/questions/33470266/language-haskell-exts-syntax-module-to-template-haskell-data-structure", "title": "Language.Haskell.Exts.Syntax.Module to Template Haskell data structure", "body": "<p>I've got a Module (<a href=\"https://hackage.haskell.org/package/haskell-src-exts-1.16.0.1/docs/Language-Haskell-Exts-Syntax.html#t:Module\" rel=\"nofollow\"><code>Language.Haskell.Exts.Syntax.Module</code></a>) and want to turn it into a template haskell data structure. How can I go about it? My first confusion is that the <code>Module</code> type from <a href=\"https://hackage.haskell.org/package/template-haskell-2.10.0.0/docs/Language-Haskell-TH-Syntax.html#t:Module\" rel=\"nofollow\"><code>Language.Haskell.TH.Syntax</code></a> doesn't look like a representation of a haskell module (it only has a <code>PkgName</code> and a <code>ModName</code>). So what's equivalent to <code>Language.Haskell.Exts.Syntax.Module</code> in template haskell? Is there a way to convert between the two? </p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 1, "creation_date": 1446441505, "post_id": 33471010, "comment_id": 54727891, "body": "I&#39;d rather write <code>splitAts is xs = snd $ mapAccumL (\\xs&#39; i -&gt; swap (splitAt i xs&#39;)) xs is</code>."}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 1, "creation_date": 1446443524, "post_id": 33471010, "comment_id": 54728496, "body": "@user3237465 that&#39;s a very good point - in real code, use an appropriate recursion scheme combinator instead of hand-coding it."}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1446454451, "post_id": 33471010, "comment_id": 54732885, "body": "I&#39;ve changed the implementation somewhat to use <code>splitAt</code> to avoid traversing the first part of the list twice in <code>take</code> and <code>drop</code>."}, {"owner": {"reputation": 869, "user_id": 2029548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f44dcf3e58fcd22cd857cd563402178?s=128&d=identicon&r=PG", "display_name": "obadz", "link": "https://stackoverflow.com/users/2029548/obadz"}, "edited": false, "score": 0, "creation_date": 1446468474, "post_id": 33471010, "comment_id": 54740692, "body": "Can also be written <code>splitAts ns l = map fst . drop 1 . scanl (\\ (_, l&#39;) n -&gt; splitAt n l&#39;) ([], l) $ ns</code>"}], "tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 0, "last_activity_date": 1446459079, "last_edit_date": 1446459079, "creation_date": 1446440100, "answer_id": 33471010, "question_id": 33470221, "link": "https://stackoverflow.com/questions/33470221/how-can-i-nest-a-list-into-sublists-of-sizes-in-a-given-list/33471010#33471010", "title": "How can I nest a list into sublists of sizes in a given list?", "body": "<p>Let's use recursion to implement the following function according to your specification:</p>\n\n<pre><code>splitAts :: [a] -&gt; [Int] -&gt; [[a]]\n</code></pre>\n\n<p>Note that I've flipped the order of arguments, because this way, the partially applied function <code>splitAts n</code> can be thought of as the meaningful operation that, given any list, will split it into sublists of the given length.</p>\n\n<p>The easy case is when there are no (more) sublist lengths specified: </p>\n\n<pre><code>splitAts [] xs = []\n</code></pre>\n\n<p>The recursive case is when there is some first sublist length <code>n</code>: in this case, the first sublist we return will have this length, and the rest will simply be the split of the rest of the list according to the rest of the lengths:</p>\n\n<pre><code>splitAts (n:ns) xs = take n xs : splitAts ns (drop n xs)\n</code></pre>\n\n<p>There already exists a function <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-List.html#v:splitAt\" rel=\"nofollow\"><code>splitAt</code></a> that does the <code>take n</code> / <code>drop n</code> in one sweep, so the above can be rewritten as the better-performing</p>\n\n<pre><code>splitAts (n:ns) xs = here : splitAts ns there\n  where\n    (here, there) = splitAt n xs\n</code></pre>\n\n<p>Example run:</p>\n\n<pre><code>*Main&gt; splitAts [5, 8, 6] [1..20]\n[[1,2,3,4,5],[6,7,8,9,10,11,12,13],[14,15,16,17,18,19]]\n</code></pre>\n\n<p>It is nicely lazy: not just this works:</p>\n\n<pre><code>*Main&gt; splitAts [5, 8, 6] [1..]\n[[1,2,3,4,5],[6,7,8,9,10,11,12,13],[14,15,16,17,18,19]]    \n</code></pre>\n\n<p>but this one as well:</p>\n\n<pre><code>*Main&gt; take 10 (splitAts [3,5..] [1..])\n[[1,2,3],[4,5,6,7,8],[9,10,11,12,13,14,15],[16,17,18,19,20,21,22,23,24],\n[25,26,27,28,29,30,31,32,33,34,35],[36,37,38,39,40,41,42,43,44,45,46,47,48]]\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4933255"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "accepted_answer_id": 33471010, "answer_count": 1, "score": 0, "last_activity_date": 1446459079, "creation_date": 1446434331, "last_edit_date": 1446439636, "question_id": 33470221, "link": "https://stackoverflow.com/questions/33470221/how-can-i-nest-a-list-into-sublists-of-sizes-in-a-given-list", "title": "How can I nest a list into sublists of sizes in a given list?", "body": "<p>I've just started out learning Haskell, and am trying my hand at Project Euler.</p>\n\n<p>I have a list of numbers I'd like to create into a 2-D list split into sublists of lengths defined in another list.</p>\n\n<p>So, I'd like a function which takes a list of Ints and a list of lengths and operates on them like so:</p>\n\n<pre><code>f [1..20] [5,8,6] = [[1,2,3,4,5],[6,7,8,9,10,11,12,13],[14,15,16,17,18,19]]\n</code></pre>\n\n<p>It would be great if the function could take an infinite list of numbers and lengths and just keep sublisting.</p>\n\n<p>I have little idea of how to go about this. Looking around Stack Overflow, I'm seeing (fairly complex to my novice eyes) solutions to packing a list into sublists of equal length, but not much like what I'm interested in.</p>\n"}, {"tags": ["haskell", "trie", "foldable"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1446429119, "post_id": 33469157, "comment_id": 54724630, "body": "<code>instance Foldable Trie where foldr f = foldrTrie $ flip $ foldr f</code>. I see no reason why a &quot;Trie can only store Foldable things&quot;."}, {"owner": {"reputation": 8556, "user_id": 4892417, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NaBTj.jpg?s=128&g=1", "display_name": "oisdk", "link": "https://stackoverflow.com/users/4892417/oisdk"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1446429828, "post_id": 33469157, "comment_id": 54724790, "body": "This Trie is intended as a Data structure to store sequences (or, more generally, <code>Foldable</code>s), of <code>Ord</code> elements. The things stored in the <code>Trie</code> <i>have</i> to be <code>Foldable</code>, because that&#39;s the only way to insert something into the <code>Trie</code>. I&#39;d like to be able to access the things in the <code>Trie</code> again, using <code>foldr</code>, preserving their sequence-like structure."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1446430789, "post_id": 33469157, "comment_id": 54725007, "body": "I&#39;m sure there are many ways to represent a sequence, but I fail to see how <code>Foldable</code> does so. Using only the <code>Foldable</code> interface to <code>Trie</code>, I see no way to write your desired function, because a <code>Foldable</code> simply doesn&#39;t do that. <code>foldrTrie</code> is more general than <code>foldr : (a -&gt; b -&gt; b) -&gt; b -&gt; Trie a -&gt; b</code>."}, {"owner": {"reputation": 8556, "user_id": 4892417, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NaBTj.jpg?s=128&g=1", "display_name": "oisdk", "link": "https://stackoverflow.com/users/4892417/oisdk"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1446431192, "post_id": 33469157, "comment_id": 54725108, "body": "I suppose what I&#39;m asking is, if I had a data structure that could store <i>only</i> (say) lists, could I implement <code>Foldable</code> on that data structure? I can manage the mechanics (I think); but it&#39;s the types that are holding me up. What would the type signature for that structure look like?"}], "answers": [{"comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 1, "creation_date": 1446466324, "post_id": 33470383, "comment_id": 54739528, "body": "In this case, it would also be possible to define <code>Trie</code> as such a GADT directly, at the cost of adding <code>[]</code> around its type parameter everywhere."}, {"owner": {"reputation": 8556, "user_id": 4892417, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NaBTj.jpg?s=128&g=1", "display_name": "oisdk", "link": "https://stackoverflow.com/users/4892417/oisdk"}, "edited": false, "score": 1, "creation_date": 1446469088, "post_id": 33470383, "comment_id": 54741068, "body": "I think this might actually be a really good option. I had intended to generalise the Trie a little bit more anyway (i.e, having it as a mapping structure, by replacing <code>endHere</code> with types other than just <code>Bool</code>) so possibly I could have an <code>STrie</code> GADT (with the <code>[]</code> around its type parameter everywhere), and then another <code>Trie</code> which could implement <code>Foldable</code> in a different way. Thanks!"}], "tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 4, "last_activity_date": 1446435665, "creation_date": 1446435665, "answer_id": 33470383, "question_id": 33469157, "link": "https://stackoverflow.com/questions/33469157/foldable-instance-for-a-trie-set/33470383#33470383", "title": "Foldable instance for a Trie-Set", "body": "<p>This is probably <strong>not</strong> what you want to do, but you could wrap a generic data structure into a GADT that only allows lists to be stored on the leafs. Simple example using trees instead of Tries for simplicity's sake: suppose the generic data structure is <code>Tree</code>, and we want to make <code>LTree</code> which only allows trees of lists:</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n\nimport Prelude hiding (foldr)\nimport Data.Foldable\nimport Data.Tree\n\nfoldrForListTrees :: ([a] -&gt; b -&gt; b) -&gt; b -&gt; Tree [a] -&gt; b\nfoldrForListTrees = error \"This is the one you are supposed to be able to write\"\n\ndata LTree a where\n    MkLTree :: Tree [a] -&gt; LTree [a]\n\ninstance Foldable LTree where\n    foldr f ys0 (MkLTree xs) = foldrForListTrees f ys0 xs\n</code></pre>\n"}], "owner": {"reputation": 8556, "user_id": 4892417, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NaBTj.jpg?s=128&g=1", "display_name": "oisdk", "link": "https://stackoverflow.com/users/4892417/oisdk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 1, "accepted_answer_id": 33470383, "answer_count": 1, "score": 3, "last_activity_date": 1446435665, "creation_date": 1446426141, "last_edit_date": 1446431622, "question_id": 33469157, "link": "https://stackoverflow.com/questions/33469157/foldable-instance-for-a-trie-set", "title": "Foldable instance for a Trie-Set", "body": "<p>I have a Set-like data structure, implemented as a Trie, with a definition like this:</p>\n\n<pre><code>import qualified Data.Map as M\nimport Data.Foldable (Foldable, foldr)\nimport Prelude hiding (foldr)\nimport Data.Maybe (fromMaybe)\n\ndata Trie a = Trie { endHere :: Bool \n                   , getTrie :: M.Map a (Trie a)\n                   } deriving (Eq)\n</code></pre>\n\n<p>And an insert operation that looks like this:</p>\n\n<pre><code>insert :: (Ord a, Foldable f) =&gt; f a -&gt; Trie a -&gt; Trie a\ninsert = foldr f (\\(Trie _ m) -&gt; Trie True m) where\n  f e a = overMap (M.alter (Just . a . fromMaybe (Trie False M.empty)) e)\n\noverMap :: Ord b =&gt; (M.Map a (Trie a) -&gt; M.Map b (Trie b)) -&gt; Trie a -&gt; Trie b\noverMap f (Trie e m) = Trie e (f m)\n</code></pre>\n\n<p>And I can get a <em>kind</em> of <code>foldr</code> that looks like this:</p>\n\n<pre><code>foldrTrie :: ([a] -&gt; b -&gt; b) -&gt; b -&gt; Trie a -&gt; b\nfoldrTrie f i (Trie a m) = M.foldrWithKey ff s m where\n  s    = if a then f [] i else i\n  ff k = flip (foldrTrie $ f . (k :))\n</code></pre>\n\n<p>But I can't figure out the <code>Foldable</code> instance for <code>Trie</code>. The <code>foldrTrie</code> seems to have all of the necessary functionality, but I just can't figure out the types.</p>\n\n<p>Here's an example of the <code>foldr</code> behaviour I'm looking for:</p>\n\n<pre><code>fromList :: (Ord a, Foldable f, Foldable g) =&gt; f (g a) -&gt; Trie a\nfromList = foldr insert (Trie False M.empty)\n\ntoList :: (Ord a) =&gt; Trie a -&gt; [[a]]\ntoList = foldr (:) [] -- replace foldr here with foldrTrie and you'll get the \n                      -- desired behaviour\n\ntoList (fromList [\"abc\", \"def\"]) -- [\"abc\",\"def\"]\n</code></pre>\n\n<p>What I can't manage is the type signature for <code>Foldable</code>:</p>\n\n<pre><code>instance Foldable Trie a where\n</code></pre>\n\n<p>I tried making my <code>Trie</code> have a second type parameter:</p>\n\n<pre><code>data Trie a (f a) = Trie { endHere :: Bool\n                         , getTrie :: M.Map a (Trie a (f a))\n                         } deriving (Eq)\n</code></pre>\n\n<p>So that I might be able to do something like this:</p>\n\n<pre><code>instance Foldable Trie a f where\n  foldr f i (Trie a m) = M.foldrWithKey ff s m where\n    s    = if a then f [] i else i\n    ff k = flip (foldrTrie $ f . (k :))\n</code></pre>\n\n<p>but I couldn't figure out the types.</p>\n\n<p>A more general way to frame the question might be like this: if I had a data structure which could store <em>only</em> lists, would I be able to define <code>foldr</code> on that data structure, so it treated the lists it stored as each element? What would the type for that data structure look like?</p>\n"}, {"tags": ["parsing", "haskell", "happy"], "answers": [{"tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": true, "score": 5, "last_activity_date": 1446414837, "creation_date": 1446414837, "answer_id": 33467656, "question_id": 33467481, "link": "https://stackoverflow.com/questions/33467481/happy-this-is-not-a-keyword/33467656#33467656", "title": "Happy: This is not a keyword", "body": "<p>What GHC does in its <a href=\"https://raw.githubusercontent.com/ghc/ghc/master/compiler/parser/Parser.y\"><code>Parser.y</code></a> is to define a nonterminal token type <code>special_id</code> that lists many of the special non-keywords like <code>as</code>, and then define the <code>tyvarid</code> and <code>varid</code> (nonterminal) tokens to include that as an option besides the terminal <code>VARID</code> (and some others, although most of them look to me like they <em>should</em> have been put in <code>special_id</code> too).</p>\n\n<p>An excerpt:</p>\n\n<pre><code>varid :: { Located RdrName }\n        : VARID            { sL1 $1 $! mkUnqual varName (getVARID $1) }\n        | special_id       { sL1 $1 $! mkUnqual varName (unLoc $1) }\n        | 'unsafe'         { sL1 $1 $! mkUnqual varName (fsLit \"unsafe\") }\n        ...\n\nspecial_id :: { Located FastString }\nspecial_id\n        : 'as'                  { sL1 $1 (fsLit \"as\") }\n        | 'qualified'           { sL1 $1 (fsLit \"qualified\") }\n        | 'hiding'              { sL1 $1 (fsLit \"hiding\") }\n        | 'export'              { sL1 $1 (fsLit \"export\") }\n        ...\n</code></pre>\n"}], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 33467656, "answer_count": 1, "score": 2, "last_activity_date": 1446415841, "creation_date": 1446413520, "last_edit_date": 1446415841, "question_id": 33467481, "link": "https://stackoverflow.com/questions/33467481/happy-this-is-not-a-keyword", "title": "Happy: This is not a keyword", "body": "<p>When you write a Happy description, you have to define all possible types of token that can appear. But you can only match against token <em>types</em>, not individual token <em>values</em>...</p>\n\n<p>This is kind of problematic. Consider, for example, the <code>data</code> keyword. According to the Haskell Report, this token is a \"reservedid\". So my tokeniser recognises it and marks it as such. However, consider the <code>as</code> keyword. Now it turns out that this is <em>not</em> a reservedid; it's an ordinary varid. It's only special in one context. You can totally declare a normal variable named <code>as</code>, and it's fine.</p>\n\n<p>So here's a question: How do I parse <code>as</code> specifically?</p>\n\n<p>Initially I didn't really think about it. I just defined a new token type which represents any varid token who's text happens to be <code>as</code>.</p>\n\n<p>...and then I spent about 2 hours trying to work out <em>why the hell</em> my grammar doesn't actually work. Yeah, it turns out that since this token type overlaps with an existing token type, the declaration order is significant. (!!!) Literally, changing the order of the declarations made the grammar parse perfectly.</p>\n\n<p>But now I'm worried. I fear that <code>as</code> will never be matched as a varid and will only ever match as itself. So all the grammar rules that say varid will reject the <code>as</code> token &mdash; which is completely wrong!</p>\n\n<p>What is the <em>correct</em> way to fix this?</p>\n"}, {"tags": ["haskell", "recursion", "functional-programming", "tail-recursion"], "answers": [{"comments": [{"owner": {"reputation": 1650, "user_id": 1292223, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98458fe74447603906e51a6f74039c4a?s=128&d=identicon&r=PG", "display_name": "kini", "link": "https://stackoverflow.com/users/1292223/kini"}, "edited": false, "score": 1, "creation_date": 1446411439, "post_id": 33467100, "comment_id": 54719848, "body": "I think you mean just <code>map (\\x -&gt; replicate x x) [1..]</code>, no?"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 5, "creation_date": 1446418747, "post_id": 33467100, "comment_id": 54722091, "body": "Just for fun, note that <code>(\\x -&gt; replicate x x)</code> is simply <code>join replicate</code>, so you could write this as <code>map (join replicate) [1..]</code>; or, shorter still, as <code>join replicate &lt;$&gt; [1..]</code>."}, {"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 1, "creation_date": 1446456484, "post_id": 33467100, "comment_id": 54734013, "body": "To use applicative notation, you can also use <code>map (replicate &lt;*&gt; id) [1..]</code>, which emphasises the number of replications."}], "tags": [], "owner": {"reputation": 1189, "user_id": 348201, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1b5c1cb1e1615645078717836ffc3eaf?s=128&d=identicon&r=PG", "display_name": "somesoaccount", "link": "https://stackoverflow.com/users/348201/somesoaccount"}, "is_accepted": false, "score": 3, "last_activity_date": 1446411976, "last_edit_date": 1446411976, "creation_date": 1446411271, "answer_id": 33467100, "question_id": 33466986, "link": "https://stackoverflow.com/questions/33466986/recursive-lists/33467100#33467100", "title": "Recursive Lists", "body": "<p>How about this one:</p>\n\n<pre><code>concatMap (\\x -&gt; replicate x x) [1..]\n</code></pre>\n\n<p>It has no explicit recursion but does what you want.</p>\n\n<p>As Keshav Kini points out you probably want the version without concatenation:</p>\n\n<pre><code>map (\\x -&gt; replicate x x) [1..]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 86, "user_id": 4456770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9939c63a637b6b1d01f386aa28785a42?s=128&d=identicon&r=PG&f=1", "display_name": "isanco", "link": "https://stackoverflow.com/users/4456770/isanco"}, "is_accepted": false, "score": 1, "last_activity_date": 1446485107, "creation_date": 1446485107, "answer_id": 33483383, "question_id": 33466986, "link": "https://stackoverflow.com/questions/33466986/recursive-lists/33483383#33483383", "title": "Recursive Lists", "body": "<p>Here is a proposal for a recursive definition:</p>\n\n<p><code>lss = [1]:map (\\ls -&gt; (1+head ls):(map (+1) ls)) lss</code></p>\n\n<p>(even though the replicate solution is shorter!)</p>\n"}], "owner": {"reputation": 75, "user_id": 2969662, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/zR6q4.jpg?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2969662/aaron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1446485107, "creation_date": 1446410656, "question_id": 33466986, "link": "https://stackoverflow.com/questions/33466986/recursive-lists", "title": "Recursive Lists", "body": "<p>I would like to create an infinite list as follows </p>\n\n<pre><code>(1:[]):(2:2:[]):(3:3:3:[]) ...\n</code></pre>\n\n<p>I have tried a lot and the best I can think of is </p>\n\n<pre><code>function = (1:[]) : map ( \\n -&gt; n ) (  from 2 )\n</code></pre>\n\n<p>I am sure that this need to be done recursively but I cant see it </p>\n\n<p>any tips or help would be great thanks</p>\n"}, {"tags": ["parsing", "haskell", "monads", "spaces"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1446408680, "post_id": 33466497, "comment_id": 54718981, "body": "I think the question is too broad, since it sounds like an answer would need to explain basic syntax, monads, and monadic parsing. There are lots of tutorials that deal with parser combinator libraries you can check out"}, {"owner": {"reputation": 57, "user_id": 4442032, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-fXnHbOHDqNY/AAAAAAAAAAI/AAAAAAAAABE/sgDlzFdQMkY/photo.jpg?sz=128", "display_name": "Ezis", "link": "https://stackoverflow.com/users/4442032/ezis"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1446409256, "post_id": 33466497, "comment_id": 54719174, "body": "I know how to parse, i am just having some trouble with syntax in this one. Everything is working but when i try to parse strings with spaces before operators, they fail...."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1446412451, "post_id": 33466497, "comment_id": 54720172, "body": "have you tried <code>spaces &gt;&gt; string &quot;===&quot; &gt;&gt; return fun6</code>"}], "answers": [{"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 1, "last_activity_date": 1446429094, "creation_date": 1446429094, "answer_id": 33469549, "question_id": 33466497, "link": "https://stackoverflow.com/questions/33466497/how-can-i-skip-spaces-when-parsing-a-haskell-string/33469549#33469549", "title": "How can I skip spaces when parsing a haskell string", "body": "<p><code>ReadP</code> has <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Text-ParserCombinators-ReadP.html#v:skipSpaces\" rel=\"nofollow\"><code>skipSpaces</code></a> for exactly that usecase; your parser then becomes</p>\n\n<pre><code>expr = chainl1 comp (skipSpaces &gt;&gt; string \"===\" &gt;&gt; return fun6) \n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 4442032, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-fXnHbOHDqNY/AAAAAAAAAAI/AAAAAAAAABE/sgDlzFdQMkY/photo.jpg?sz=128", "display_name": "Ezis", "link": "https://stackoverflow.com/users/4442032/ezis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 747, "favorite_count": 0, "closed_date": 1446446456, "accepted_answer_id": 33469549, "answer_count": 1, "score": -1, "last_activity_date": 1446429094, "creation_date": 1446407573, "last_edit_date": 1446429016, "question_id": 33466497, "link": "https://stackoverflow.com/questions/33466497/how-can-i-skip-spaces-when-parsing-a-haskell-string", "closed_reason": "Needs details or clarity", "title": "How can I skip spaces when parsing a haskell string", "body": "<p>I have the following definition in a parser using the Haskell <code>ReadP</code> library:</p>\n\n<pre><code>expr = chainl1 comp (string \"===\" &gt;&gt; return fun6) \n</code></pre>\n\n<p>How can I skip spaces before the <code>===</code> operator? I don't know how to include it in this syntax.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 1, "creation_date": 1446441789, "post_id": 33465745, "comment_id": 54727972, "body": "See <a href=\"http://stackoverflow.com/questions/33016410/is-there-any-way-to-separate-infinite-and-finite-lists\">Is there any way to separate infinite and finite lists?</a>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1446442795, "post_id": 33465745, "comment_id": 54728262, "body": "Use <code>foldr</code>. Fold over the list to produce a function taking the desired strict lower length bound."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1446454698, "post_id": 33465745, "comment_id": 54733012, "body": "What did you try? SO is not a homework solving service. On this kind of questions, the poster is often expected to show some effort."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1446480363, "post_id": 33471480, "comment_id": 54748598, "body": "I recommend using <code>=</code> in the explanation rather than <code>==</code>, since this probably should <i>not</i> be implemented using <code>==</code>."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1446480916, "post_id": 33471480, "comment_id": 54748989, "body": "@dfeuer fair point (indeed <i>I</i> did not expect to be implemented using <code>==</code> as you can see by the missing constraint)"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 2, "creation_date": 1446509138, "post_id": 33471480, "comment_id": 54763304, "body": "If this weren&#39;t a homework question, <code>longEnough n = not . null . drop n</code>."}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 1, "last_activity_date": 1446563880, "last_edit_date": 1446563880, "creation_date": 1446443374, "answer_id": 33471480, "question_id": 33465745, "link": "https://stackoverflow.com/questions/33465745/how-to-solve-longenough-in-haskell/33471480#33471480", "title": "How to solve longEnough?. In Haskell", "body": "<p>I guess this is homework and you are still learning the basics so I'll start by giving you some hints using the recursion instead of <code>foldr</code> (as @dfeuer proposed):</p>\n\n<p>First start by noting some obvious cases:</p>\n\n<ul>\n<li>if <code>xs = []</code> then the result is always <code>False</code> (assuming you don't care about negative <code>n</code> in some strange ways)</li>\n<li>if <code>n = 0</code> and <code>xs</code> is non-empty then it's always <code>True</code></li>\n<li>in all other cases you have\n\n<ul>\n<li><code>n &gt; 0</code> </li>\n<li><code>xs</code> has more than one element </li>\n</ul></li>\n</ul>\n\n<p>Maybe you have some <em>recursive</em> idea to break the last case down?</p>\n\n<p>Here is a skeleton:</p>\n\n<pre><code>longEnough :: Int -&gt; [a] -&gt; Bool\nlongEnough _ []     = False\nlongEnough 0 _      = True\nlongEnough n (_:xs) = let n' = (n-1) in undefined\n</code></pre>\n\n<p>For those cases - if you <em>look closely</em> you'll see that I even added more hints on the solution.</p>\n\n<hr>\n\n<h3>PS</h3>\n\n<ul>\n<li>maybe you want to think about negative <code>n</code> and what should happen to those ... I did <strong>not</strong> here</li>\n<li>if you know what <code>foldr</code> is all about you should probably try to implement this using <code>foldr</code> too</li>\n</ul>\n\n<hr>\n\n<h2>Solution</h2>\n\n<p>Seems there is no more feedback coming from the OP so I guess I can as well post the solution as I would start with:</p>\n\n<pre><code>longEnough :: Int -&gt; [a] -&gt; Bool\nlongEnough _ []     = False\nlongEnough 0 _      = True\nlongEnough n (_:xs) = longEnough (n-1) xs\n</code></pre>\n\n<p>(Not really much left to do...)</p>\n\n<p>Here are the mentioned test-cases:</p>\n\n<pre><code>\u03bb&gt; longEnough 2 [1..5]\nTrue\n\u03bb&gt; longEnough 3 [1,2,3]\nFalse\n\u03bb&gt; longEnough 0 []\nFalse\n\u03bb&gt; longEnough 20 [1..]\nTrue\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5511358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/805e2699d105afd869e81babacafb2a9?s=128&d=identicon&r=PG&f=1", "display_name": "user5511358", "link": "https://stackoverflow.com/users/5511358/user5511358"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 1, "closed_date": 1446493684, "answer_count": 1, "score": -5, "last_activity_date": 1446563880, "creation_date": 1446403075, "last_edit_date": 1446472976, "question_id": 33465745, "link": "https://stackoverflow.com/questions/33465745/how-to-solve-longenough-in-haskell", "closed_reason": "Needs more focus", "title": "How to solve longEnough?. In Haskell", "body": "<p><code>longEnough n xs</code>: checks if a list has more than <code>n</code> elements.</p>\n\n<p>Examples:</p>\n\n<ul>\n<li><code>longEnough 2 [1..5] == True</code></li>\n<li><code>longEnough 3 [1,2,3] == False</code></li>\n<li><code>longEnough 0 [] == False</code></li>\n<li><code>longEnough 20 [1..] == True</code></li>\n</ul>\n"}, {"tags": ["haskell", "compiler-errors", "pointfree"], "comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1446401424, "post_id": 33465376, "comment_id": 54716492, "body": "There&#39;s nothing wrong with <code>f x = map digitToInt $ show x</code>. Are you typing that into <code>ghci</code> without a <code>let</code>? Have you imported <code>digitToInt</code> from <code>Data.Char</code>? What error did you get from <code>f x = map digitToInt $ show x</code>?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1446401640, "post_id": 33465376, "comment_id": 54716547, "body": "This is due to the monomorphism restriction. Your definition is not done through a function binding (but with a simple binding <code>f = ...</code>), so the MR applies. Try adding a type signature to work around that., e.g. <code>f :: Show a =&gt; a -&gt; [Int]</code> before the function definition."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1446402122, "post_id": 33465376, "comment_id": 54716698, "body": "Alternatively, disable the MR for the whole module adding at the top <code>{-# LANGUAGE NoMonomorphismRestriction #-}</code>."}, {"owner": {"reputation": 755, "user_id": 5323311, "user_type": "registered", "accept_rate": 74, "profile_image": "https://lh5.googleusercontent.com/-v8SDvlJNQBU/AAAAAAAAAAI/AAAAAAAAAD4/IT0tDo9PwT4/photo.jpg?sz=128", "display_name": "Tshimanga", "link": "https://stackoverflow.com/users/5323311/tshimanga"}, "edited": false, "score": 0, "creation_date": 1446411520, "post_id": 33465376, "comment_id": 54719878, "body": "Indeed the problem. Thanks for the reference. Very happy with the thorough and well written answer there. Cheers!"}], "owner": {"reputation": 755, "user_id": 5323311, "user_type": "registered", "accept_rate": 74, "profile_image": "https://lh5.googleusercontent.com/-v8SDvlJNQBU/AAAAAAAAAAI/AAAAAAAAAD4/IT0tDo9PwT4/photo.jpg?sz=128", "display_name": "Tshimanga", "link": "https://stackoverflow.com/users/5323311/tshimanga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "closed_date": 1446401321, "answer_count": 0, "score": 0, "last_activity_date": 1446401023, "creation_date": 1446401023, "question_id": 33465376, "link": "https://stackoverflow.com/questions/33465376/trouble-with-a-point-free-representation-in-haskell", "closed_reason": "Duplicate", "title": "Trouble with a Point Free Representation in Haskell", "body": "<p>Trying understand an error message I got from a line of Haskell I wrote. I changed</p>\n\n<pre><code>f x = map digitToInt $ show x\n</code></pre>\n\n<p>to</p>\n\n<pre><code>f = \\x -&gt; map digitToInt (show x)\n  = (map digitToInt).(\\x -&gt; show x)\n  = (map digitToInt).show\n</code></pre>\n\n<p>and got the following error message on compilation.</p>\n\n<pre><code>No instance for (Show a0) arising from a use of \u2018show\u2019\nThe type variable \u2018a0\u2019 is ambiguous\nRelevant bindings include\n  toDigits :: a0 -&gt; [Int] (bound at lab2.hs:14:1)\nNote: there are several potential instances:\n  instance Show Data.Char.GeneralCategory -- Defined in \u2018Data.Char\u2019\n  instance Show a =&gt; Show (Maybe a) -- Defined in \u2018GHC.Show\u2019\n  instance Show Ordering -- Defined in \u2018GHC.Show\u2019\n  ...plus 23 others\nIn the second argument of \u2018(.)\u2019, namely \u2018show\u2019\nIn the expression: (map digitToInt) . show\nIn an equation for \u2018toDigits\u2019: toDigits = (map digitToInt) . show\n</code></pre>\n\n<p>Wondering what the compiler is slapping me on the wrist for. <code>show</code> is of type <code>Show a =&gt; a -&gt; String (=[Char])</code> and <code>(map digitToInt) :: [Char] -&gt; [Int]</code> so composition of these to morphisms should make sense.</p>\n\n<p>Further, when I run it as a line <code>(map digitToInt).show $ &lt;some #&gt;</code> or <code>((map digitToInt).show) &lt;some #&gt;</code> directly in the GHCi it works exactly as i want it to. So the function itself encodes the correct behavior.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2666, "user_id": 382780, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/7e2b7c885cfa6c044bd14500052d2060?s=128&d=identicon&r=PG", "display_name": "31eee384", "link": "https://stackoverflow.com/users/382780/31eee384"}, "edited": false, "score": 3, "creation_date": 1446399836, "post_id": 33465140, "comment_id": 54715907, "body": "What do you want to happen when the key doesn&#39;t exist in the lookup?"}], "answers": [{"tags": [], "owner": {"reputation": 4426, "user_id": 469981, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b116107a07635c7b2015d3ffd8ddbe3a?s=128&d=identicon&r=PG", "display_name": "jazmit", "link": "https://stackoverflow.com/users/469981/jazmit"}, "is_accepted": false, "score": 1, "last_activity_date": 1446400354, "last_edit_date": 1446400354, "creation_date": 1446399934, "answer_id": 33465178, "question_id": 33465140, "link": "https://stackoverflow.com/questions/33465140/how-can-i-find-an-item-in-a-list-then-return-its-pair/33465178#33465178", "title": "How can i find an item in a list then return its pair?", "body": "<p>What would you like it to return if the key isn't in the list?</p>\n\n<p>There is a reason that lookup returns a <code>Maybe Int</code> rather than an Int - to force the programmer to deal with the failure case.</p>\n\n<p>An easy way of dealing with the maybe is with a default value, for example:</p>\n\n<pre><code>withDefaultValue = fromMaybe 0 (lookup key myList)\n</code></pre>\n\n<p>If you are 100% sure that the value is in the list, you can use <code>fromJust</code></p>\n\n<pre><code>result = fromJust (lookup key myList)\n</code></pre>\n\n<p>If the list might not contain the item, but you can't deal with the failure in your code in that function, pass the <code>Maybe</code> out of your function until it reaches the part of the code that can deal with the failure.</p>\n"}, {"tags": [], "owner": {"reputation": 4761, "user_id": 2277395, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/09841ca82e49f998ea0b8f159dea87c1?s=128&d=identicon&r=PG", "display_name": "Martin Drautzburg", "link": "https://stackoverflow.com/users/2277395/martin-drautzburg"}, "is_accepted": true, "score": 0, "last_activity_date": 1446399949, "creation_date": 1446399949, "answer_id": 33465181, "question_id": 33465140, "link": "https://stackoverflow.com/questions/33465140/how-can-i-find-an-item-in-a-list-then-return-its-pair/33465181#33465181", "title": "How can i find an item in a list then return its pair?", "body": "<p>What should the function do in case the key is not in the list?</p>\n\n<p>If you are sure the key is in the list, then</p>\n\n<pre><code>import Data.Maybe\n</code></pre>\n\n<p>and run the result (i.e. the Maybe Int) through <code>fromJust</code>. You'll get a plain Int, and when the key is not in the list you'll get an exception.</p>\n"}], "owner": {"reputation": 483, "user_id": 4398404, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/c0cdf7491cbf76aaf549f406f108ebfb?s=128&d=identicon&r=PG&f=1", "display_name": "Hunrik", "link": "https://stackoverflow.com/users/4398404/hunrik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "closed_date": 1446400727, "accepted_answer_id": 33465181, "answer_count": 2, "score": 0, "last_activity_date": 1446400354, "creation_date": 1446399676, "question_id": 33465140, "link": "https://stackoverflow.com/questions/33465140/how-can-i-find-an-item-in-a-list-then-return-its-pair", "closed_reason": "Duplicate", "title": "How can i find an item in a list then return its pair?", "body": "<p>I have a list, like this [('A',1),('B',2),..]\nI'd like to do a key value search. \nI already found the lookup but it returns a 'Maybe Int'.\nSo are there any function which returns the value for the key, and gives a normal int back?</p>\n"}, {"tags": ["haskell", "template-haskell"], "comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1446408839, "post_id": 33465109, "comment_id": 54719031, "body": "1. You&#39;re missing <code>import GHC.TypeLits</code> in the second file, without that it wouldn&#39;t work even with a non-operator type. 2. After fixing that, this still looks like a bug to me, so I <a href=\"https://ghc.haskell.org/trac/ghc/ticket/11046#ticket\" rel=\"nofollow noreferrer\">reported it</a>."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1446409807, "post_id": 33465109, "comment_id": 54719344, "body": "I <a href=\"https://ghc.haskell.org/trac/ghc/ticket/11046#comment:1\" rel=\"nofollow noreferrer\">just discovered</a> that it works if the type operator starts with <code>:</code>, so my guess is the function wasn&#39;t updated when their syntax was liberalized."}, {"owner": {"reputation": 1117, "user_id": 1641035, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b63d948c23003346549369112f336519?s=128&d=identicon&r=PG", "display_name": "Alexey Vagarenko", "link": "https://stackoverflow.com/users/1641035/alexey-vagarenko"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1446438854, "post_id": 33465109, "comment_id": 54727062, "body": "@&#216;rjan Johansen, I lookup fully qualified &quot;GHC.TypeLits.*&quot;, I don&#39;t think I need import GHC.TypeLits there, but it still doesn&#39;t work even with import as you see."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1446461586, "post_id": 33465109, "comment_id": 54736972, "body": "The <code>*</code> operator doesn&#39;t work with or without import, or with or without qualification. But for e.g. <code>Nat</code>, you need an import, even with a fully qualified name (and it works without qualification too). Testing a bit further, it respects <code>qualified</code> and <code>hiding</code> on the import too."}], "answers": [{"tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": true, "score": 3, "last_activity_date": 1485832018, "last_edit_date": 1485832018, "creation_date": 1446410482, "answer_id": 33466962, "question_id": 33465109, "link": "https://stackoverflow.com/questions/33465109/template-haskell-how-to-lookup-type-operator-name/33466962#33466962", "title": "Template Haskell - How to lookup type operator name?", "body": "<p>I guess I have enough now for a brief answer. Alas I only found the reason for your problem, but not how to solve it.</p>\n\n<p>My testing shows that <code>lookupTypeName</code> <em>does</em> support type operators, but only if they start with <code>:</code>.</p>\n\n<p>Originally this was a requirement, in analogy with infix data constructors, but this was lifted to allow things like the arithmetical type operators in <code>GHC.TypeLits</code>. (The downside is that you can no longer have type operator <em>variables</em>, as were once popular for things like <code>Arrow</code> code.)</p>\n\n<p>Presumably <code>lookupTypeName</code> was not updated to take this into account, and I have <a href=\"https://ghc.haskell.org/trac/ghc/ticket/11046\" rel=\"nofollow noreferrer\">filed a bug report</a> for this.</p>\n\n<p>EDIT: A fix for this has finally been made, and should be in the upcoming GHC 8.2.1.</p>\n"}], "owner": {"reputation": 1117, "user_id": 1641035, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b63d948c23003346549369112f336519?s=128&d=identicon&r=PG", "display_name": "Alexey Vagarenko", "link": "https://stackoverflow.com/users/1641035/alexey-vagarenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 33466962, "answer_count": 1, "score": 2, "last_activity_date": 1485832018, "creation_date": 1446399485, "question_id": 33465109, "link": "https://stackoverflow.com/questions/33465109/template-haskell-how-to-lookup-type-operator-name", "title": "Template Haskell - How to lookup type operator name?", "body": "<p>How do I lookup type operator name? This does not work:</p>\n\n<p>IssueTH.hs:</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\nmodule IssueTH where\nimport Language.Haskell.TH\n\nf :: Q [Dec]\nf = do\n    Just n &lt;- lookupTypeName \"GHC.TypeLits.*\"\n    return []\n</code></pre>\n\n<p>Issue.hs:</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\nmodule Issue where\nimport IssueTH\n\n$f\n</code></pre>\n\n<p><code>ghc Issue.hs</code> fails with message: </p>\n\n<pre><code>Pattern match failure in do expression at IssueTH.hs\n</code></pre>\n\n<p>Replacing <code>\"GHC.TypeLits.*\"</code> with <code>\"GHC.TypeLits.(*)\"</code> or <code>\"*\"</code> doesn't work either.</p>\n"}, {"tags": ["haskell", "haskell-pipes"], "answers": [{"comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1446402000, "post_id": 33464886, "comment_id": 54716652, "body": "You are correct, a downstream proxy can never detect that an upstream proxy <code>return</code>ed. When the upstream proxy <code>return</code>s, the pipes library has no possible value to pass to the downstream proxy&#39;s <code>Request</code> to run it any farther."}, {"owner": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "edited": false, "score": 0, "creation_date": 1446406720, "post_id": 33464886, "comment_id": 54718318, "body": "This is great, thank you so much for the help! I&#39;ll now refactor with <code>foldAllM</code> and especially <code>MaybeT</code> to understand how transformers work."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 3, "last_activity_date": 1446398271, "creation_date": 1446398271, "answer_id": 33464886, "question_id": 33464543, "link": "https://stackoverflow.com/questions/33464543/forking-the-streaming-flow-in-haskell-pipes/33464886#33464886", "title": "Forking the streaming flow in haskell-pipes", "body": "<p>AFAIK a Consumer cannot detect the end of a stream. In order to do that you need to use a Pipes.Parser and invert the control.</p>\n\n<p>Here is a Parser which inserts commas between String elements:</p>\n\n<pre><code>import Pipes\nimport qualified Pipes.Prelude as P\nimport Pipes.Parse (draw, evalStateT)\n\ncommify = do\n  lift $ putStrLn \"[\"\n  m1 &lt;- draw\n  case m1 of\n    Nothing -&gt; lift $ putStrLn \"]\"\n    Just x1 -&gt; do\n      lift $ putStrLn x1\n      let loop = do mx &lt;- draw\n                    case mx of\n                      Nothing -&gt; lift $ putStrLn \"]\"\n                      Just x  -&gt; lift (putStr \",\" &gt;&gt; putStrLn x) &gt;&gt; loop\n      loop\n\ntest1 = evalStateT commify ( mapM_ yield (words \"this is a test\") )\ntest2 = evalStateT commify P.stdinLn\n</code></pre>\n\n<p>To handle the different output formats I would probably make both formats a Parser:</p>\n\n<pre><code>exportParser = do\n  mx &lt;- draw\n  case mx of\n    Nothing -&gt; return ()\n    Just x  -&gt; (lift $ putStrLn $ export x) &gt;&gt; exportParser\n</code></pre>\n\n<p>and then:</p>\n\n<pre><code>let parser = case outputMode of\n               JSON -&gt; commify\n               _    -&gt; exportParser\nevalStateT parser (P.mapM analyze\n                      &gt;-&gt; P.map (filterResults conf)\n                      &gt;-&gt; P.filter filterNulls)\n</code></pre>\n\n<p>There is probably a slicker way to write <code>exportParser</code> in terms of <code>foldAllM</code>. You can also use the <code>MaybeT</code> transformer to more succinctly write the <code>commify</code> parser. I've written both out explicitly to make them easier to understand.</p>\n"}, {"comments": [{"owner": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "edited": false, "score": 0, "creation_date": 1446449075, "post_id": 33466465, "comment_id": 54730565, "body": "Interesting! But is there a way to make <code>intersperse_</code> a Pipe, in order to maintain the pipeline &quot;structure&quot;? Because of the fact that <code>intersperse_</code> accepts a producer as argument, I&#39;m forced to build the first part of the pipeline separately and then passing it as argument. And I&#39;m having trouble to integrate it with my current code as it does not typecheck."}, {"owner": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "edited": false, "score": 0, "creation_date": 1446450468, "post_id": 33466465, "comment_id": 54731106, "body": "Ok, I made it to typecheck, but I&#39;d still prefer a &quot;linear&quot; pipeline structure if possible. Looking at the source code of <code>intercalates</code> it doesn&#39;t seem possible, does it?"}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "reply_to_user": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "edited": false, "score": 0, "creation_date": 1446470262, "post_id": 33466465, "comment_id": 54741773, "body": "The short answer is no. <code>pipes</code> has several ways of manipulating a <code>Producer</code>, piping is just one of them. <code>pipes-parse</code> and <code>pipes-group</code> are about other ways of manipulating a producer. Thus, dividing a producer into chunks of three is not a piping problem, and can&#39;t even be expressed with the other streaming IO libraries, which would force you, e.g. to make a stream of 3 element lists or the like. But <code>Pipes.Group.chunksOf</code> is the native expression of it."}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "reply_to_user": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "edited": false, "score": 0, "creation_date": 1446470597, "post_id": 33466465, "comment_id": 54741998, "body": "Similarly, the very elementary problem of splitting a producer at the 23rd element and reserving the rest for another treatment is not a piping problem; it is expressed natively by <code>Pipes.Parse.splitAt:: Int -&gt; Producer a m r -&gt; Producer a m (Producer a m r)</code> (specializing). In conduit this sort of problem involves the spectacular apparatus of &#39;connect&#39; and &#39;resume&#39;."}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "reply_to_user": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "edited": false, "score": 0, "creation_date": 1446471327, "post_id": 33466465, "comment_id": 54742434, "body": "Similarly, dividing a text or bytestring producer on its lines is not a piping problem; in order to express it as one, conduit and io-streams unstream the lines themselves, concatenating chunks and allowing infinitely long strict bytestrings to be formed in memory (to put it in a paranoid sort of way.)  With <code>pipes</code> this isn&#39;t an issue since it recognizes that there are other things to do with a producer besides <code>pipe</code> it."}, {"owner": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "edited": false, "score": 0, "creation_date": 1446477998, "post_id": 33466465, "comment_id": 54746914, "body": "Great info there, thanks a lot for the insights about haskell-pipes and the streaming problem in general. The context is clearer now."}], "tags": [], "owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "is_accepted": true, "score": 1, "last_activity_date": 1446407373, "creation_date": 1446407373, "answer_id": 33466465, "question_id": 33464543, "link": "https://stackoverflow.com/questions/33464543/forking-the-streaming-flow-in-haskell-pipes/33466465#33466465", "title": "Forking the streaming flow in haskell-pipes", "body": "<p>I think you should 'commify' with pipes-group. It has an <code>intercalates</code>, but not an intersperse, but it's not a big deal to write. You should stay away from the Consumer end, I think, for this sort of problem.</p>\n\n<pre><code>{-#LANGUAGE OverloadedStrings #-}\nimport Pipes\nimport qualified Pipes.Prelude as P\nimport qualified Data.ByteString.Lazy.Char8 as B\nimport Pipes.Group\nimport Lens.Simple  -- or Control.Lens or Lens.Micro or anything with view/^.\nimport System.Environment\n\nintersperse_ :: Monad m =&gt; a -&gt; Producer a m r -&gt; Producer a m r\nintersperse_ a producer = intercalates (yield a) (producer ^. chunksOf 1) \n\nmain = do \n  args &lt;- getArgs\n  let op prod = case args of \n        \"json\":_ -&gt; yield \"[\" *&gt; intersperse_ \",\" prod &lt;* yield \"]\"\n        _        -&gt; intersperse_ \" \" prod\n  runEffect $ op producer &gt;-&gt; P.mapM_ B.putStr\n  putStrLn \"\"\n  where \n    producer = mapM_ yield (B.words \"this is a test\")\n</code></pre>\n\n<p>which give me this</p>\n\n<pre><code>    &gt;&gt;&gt; :main json\n    [this,is,a,test]\n    &gt;&gt;&gt; :main ---\n    this is a test\n</code></pre>\n"}], "owner": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 1, "accepted_answer_id": 33466465, "answer_count": 2, "score": 1, "last_activity_date": 1446407373, "creation_date": 1446396124, "question_id": 33464543, "link": "https://stackoverflow.com/questions/33464543/forking-the-streaming-flow-in-haskell-pipes", "title": "Forking the streaming flow in haskell-pipes", "body": "<p>I'm having trouble directing flow though a pipeline with haskell-pipes. Basically, I analyze a bunch of files and then I have to either</p>\n\n<ol>\n<li>print results to the terminal in a human-friendly way</li>\n<li>encode results to JSON</li>\n</ol>\n\n<p>The chosen path depends upon a command line option.<br>\nIn the second case, I have to output an opening bracket, then every incoming value followed by a comma and then a closing bracket. Currently <code>insertCommas</code> never terminates, so the closing bracket is never outputted.</p>\n\n<pre><code>import Pipes\nimport Data.ByteString.Lazy as B\nimport Data.Aeson (encode)\n\ninsertCommas :: Consumer B.ByteString IO ()\ninsertCommas = do\n    first &lt;- await\n    lift $ B.putStr first\n    for cat $ \\obj -&gt; lift $ do\n        putStr \",\"\n        B.putStr obj\n\njsonExporter :: Consumer (FilePath, AnalysisResult) IO ()\njsonExporter = do\n    lift $ putStr \"[\"\n    P.map encode &gt;-&gt; insertCommas\n    lift $ putStr \"]\"\n\nexportStream :: Config -&gt; Consumer (FilePath, AnalysisResult) IO ()\nexportStream conf =\n    case outputMode conf of\n      JSON -&gt; jsonExporter\n      _    -&gt; P.map (export conf) &gt;-&gt; P.stdoutLn\n\nmain :: IO ()\nmain = do\n    -- The first two lines are Docopt stuff, not relevant\n    args &lt;- parseArgsOrExit patterns =&lt;&lt; getArgs\n    ins  &lt;- allFiles $ args `getAllArgs` argument \"paths\"\n    let conf = readConfig args\n    runEffect $ each ins\n             &gt;-&gt; P.mapM analyze\n             &gt;-&gt; P.map (filterResults conf)\n             &gt;-&gt; P.filter filterNulls\n             &gt;-&gt; exportStream conf\n</code></pre>\n"}, {"tags": ["haskell", "ghci"], "answers": [{"comments": [{"owner": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "edited": false, "score": 0, "creation_date": 1506027445, "post_id": 33464485, "comment_id": 79666206, "body": "Updated link to <a href=\"https://downloads.haskell.org/~ghc/7.8.4/docs/html/users_guide/safe-haskell.html\" rel=\"nofollow noreferrer\">Haskell Users Guide for Safe extension</a>"}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 6, "last_activity_date": 1446402763, "last_edit_date": 1446402763, "creation_date": 1446395787, "answer_id": 33464485, "question_id": 33464076, "link": "https://stackoverflow.com/questions/33464076/what-does-safe-marker-mean-in-ghci/33464485#33464485", "title": "What does [safe] marker mean in ghci?", "body": "<p>It simply means that the datatype is defined in a module which is defined using safe extension. You can find the details of the extension <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/safe-haskell.html\" rel=\"noreferrer\">in the user guide</a>.</p>\n\n<p>In fact, you can test that yourself by defining a module using the <code>Safe</code> extension:</p>\n\n<pre><code>{-#LANGUAGE Safe#-}\n\ndata Test = Test deriving (Eq, Show)\n</code></pre>\n\n<p>And then trying it out in <code>ghci</code>:</p>\n\n<pre><code>\u03bb&gt; :i Test\ndata Test = Test    \ninstance [safe] Eq Test \ninstance [safe] Show Test \n</code></pre>\n\n<p>But note that in the current GHC (7.10.2), the safe extension cannot be relied of the trust guarantee because of <a href=\"https://ghc.haskell.org/trac/ghc/ticket/9562\" rel=\"noreferrer\">this ghc bug</a>.</p>\n"}], "owner": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 1, "accepted_answer_id": 33464485, "answer_count": 1, "score": 7, "last_activity_date": 1446402763, "creation_date": 1446393115, "question_id": 33464076, "link": "https://stackoverflow.com/questions/33464076/what-does-safe-marker-mean-in-ghci", "title": "What does [safe] marker mean in ghci?", "body": "<pre><code>Prelude Data.Void&gt; :info Void\ndata Void       -- Defined in `Data.Void'\ninstance [safe] Eq Void -- Defined in `Data.Void'\ninstance [safe] Ord Void -- Defined in `Data.Void'\ninstance [safe] Read Void -- Defined in `Data.Void'\ninstance [safe] Show Void -- Defined in `Data.Void'\n</code></pre>\n\n<p>What does [safe] mean?</p>\n"}, {"tags": ["haskell", "yaml"], "answers": [{"comments": [{"owner": {"reputation": 34692, "user_id": 356440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d16fc2844c1d9f8f815f318734554266?s=128&d=identicon&r=PG", "display_name": "Stephane Rolland", "link": "https://stackoverflow.com/users/356440/stephane-rolland"}, "edited": false, "score": 0, "creation_date": 1475872712, "post_id": 39922846, "comment_id": 67134592, "body": "i&#39;m going to try this."}], "tags": [], "owner": {"reputation": 978, "user_id": 1902082, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f46590cf12954aeab118e32b10f0ed97?s=128&d=identicon&r=PG", "display_name": "scooter me fecit", "link": "https://stackoverflow.com/users/1902082/scooter-me-fecit"}, "is_accepted": false, "score": 1, "last_activity_date": 1475861125, "creation_date": 1475861125, "answer_id": 39922846, "question_id": 33464036, "link": "https://stackoverflow.com/questions/33464036/parsing-several-yaml-documents-in-one-file-using-data-yaml/39922846#39922846", "title": "Parsing several YAML documents in one file using Data.Yaml", "body": "<p>You need <code>...</code> to separate documents, like so:</p>\n\n<pre><code>---\n-   name: &gt;\n        this is a test task\n    state: finished\n\n-   name: &gt;\n        this is a second test task\n    state: todo\n...\n---\n-   name: noname\n    state: nostate\n</code></pre>\n"}], "owner": {"reputation": 34692, "user_id": 356440, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/d16fc2844c1d9f8f815f318734554266?s=128&d=identicon&r=PG", "display_name": "Stephane Rolland", "link": "https://stackoverflow.com/users/356440/stephane-rolland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1593953959, "creation_date": 1446392825, "last_edit_date": 1593953959, "question_id": 33464036, "link": "https://stackoverflow.com/questions/33464036/parsing-several-yaml-documents-in-one-file-using-data-yaml", "title": "Parsing several YAML documents in one file using Data.Yaml", "body": "<p>Starting from the code <a href=\"https://stackoverflow.com/a/21292429/356440\">in this answer</a>, I got something working quickly which parses a list of todo task items in a YAML file.</p>\n<p>But if I ever add a second document, <code>Data.Yaml.decode</code> no longer decodes anything, and just returns <code>Nothing</code>.</p>\n<p>Like this:</p>\n<pre><code>---\n-   name: &gt;\n        this is a test task\n    state: finished\n\n-   name: &gt;\n        this is a second test task\n    state: todo\n---\n-   name: noname\n    state: nostate\n</code></pre>\n<p>I am wondering if it is possible at all to use the documents feature of YAML, when parsing with Data.Yaml?</p>\n<p>Or I am doing something wrong?</p>\n<p>This is the code:</p>\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nimport Data.Yaml\nimport Control.Applicative -- &lt;$&gt;, &lt;*&gt;\nimport Data.Maybe (fromJust)\n\nimport qualified Data.ByteString.Char8 as BS\n\ndata Task = Task {    name :: String,\n                      state :: String }\n                      deriving (Show)\n\ninstance FromJSON Task where\n    parseJSON (Object v) = Task &lt;$&gt;\n                           v .: &quot;name&quot; &lt;*&gt;\n                           v .: &quot;state&quot;\n    -- A non-Object value is of the wrong type, so fail.\n    parseJSON _ = error &quot;Can't parse Task from YAML/JSON&quot;\n\nmain = do\n         ymlData &lt;- BS.readFile &quot;/tmp/test2.yaml&quot;\n         let users = Data.Yaml.decode ymlData :: Maybe [Task]\n         -- Print it, just for show\n         print $ fromJust users\n</code></pre>\n"}, {"tags": ["parsing", "haskell", "happy"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1446390596, "post_id": 33463580, "comment_id": 54712912, "body": "Why would <code>reverse</code> use the stack? You can reverse a list in constant memory."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1446391310, "post_id": 33463580, "comment_id": 54713128, "body": "You can always use a different data structure like a <a href=\"https://hackage.haskell.org/package/containers-0.5.6.3/docs/Data-Sequence.html\" rel=\"nofollow noreferrer\"><code>Data.Sequence</code></a>."}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1446391338, "post_id": 33463580, "comment_id": 54713138, "body": "shouldn&#39;t the last item be | items &quot;,&quot; item  { $3 : $1 } ? That is what the manual seems to be saying?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1446391342, "post_id": 33463580, "comment_id": 54713142, "body": "btw - I think the example should be ` | items &quot;,&quot; item { ... }`"}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1446391412, "post_id": 33463580, "comment_id": 54713168, "body": "You could always have &quot;items1 : items { reverse $1}&quot;. Then you can use &quot;items1&quot; every time."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1446391418, "post_id": 33463580, "comment_id": 54713171, "body": "@PaulJohnson Thanks. Fixed it."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1446391487, "post_id": 33463580, "comment_id": 54713193, "body": "@melpomene Given that reversing a list works by pushing all the list items onto the call stack and then pulling them off again in reverse order, I&#39;m not sure how you do that in constant memory..."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1446393371, "post_id": 33463580, "comment_id": 54713795, "body": "@MathematicalOrchid Haskell doesn&#39;t have a call stack, and that&#39;s not how reverse works. But I just noticed that my comment doesn&#39;t make sense: You use linear memory (for the reversed list itself)."}, {"owner": {"reputation": 3961, "user_id": 176015, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/398c96f77ec9b99b1e8122214227305d?s=128&d=identicon&r=PG", "display_name": "svenningsson", "link": "https://stackoverflow.com/users/176015/svenningsson"}, "edited": false, "score": 1, "creation_date": 1446394224, "post_id": 33463580, "comment_id": 54714078, "body": "<code>reverse xs = aux xs []</code> <code>aux [] ys = ys</code> <code>aux (x:xs) ys = aux xs (x:ys)</code> Doesn&#39;t use any stack. Only tailcalls."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 3961, "user_id": 176015, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/398c96f77ec9b99b1e8122214227305d?s=128&d=identicon&r=PG", "display_name": "svenningsson", "link": "https://stackoverflow.com/users/176015/svenningsson"}, "edited": false, "score": 0, "creation_date": 1446401160, "post_id": 33463580, "comment_id": 54716395, "body": "@svenningsson Also known as <code>foldl (flip (:)) []</code>."}], "answers": [{"comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1446405923, "post_id": 33465359, "comment_id": 54718024, "body": "I still haven&#39;t wrapped my mind around how reverse manages this task, but it clearly <i>does</i>, and that&#39;s the important bit."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1446406419, "post_id": 33465359, "comment_id": 54718191, "body": "@MathematicalOrchid, it&#39;s all on the heap, not the stack. These days, though, the stack isn&#39;t fixed in size anyway."}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 4, "last_activity_date": 1446400947, "creation_date": 1446400947, "answer_id": 33465359, "question_id": 33463580, "link": "https://stackoverflow.com/questions/33463580/parsing-with-happy-left-recursion-versus-right-recursion/33465359#33465359", "title": "Parsing with Happy: left-recursion versus right-recursion", "body": "<p>If all you want is the entire <code>items</code> to be <code>reverse</code>d every time, you can define</p>\n\n<pre><code>items  : items_           {reverse $1}\n\nitems_ : item             { $1 : [] }\n       | items_ \",\" item  { $3 : $1 }\n</code></pre>\n\n<p><code>reverse</code> won't overflow the stack. If you need to convince yourself of this, try evaluating <code>length $ reverse [1..10000000]</code></p>\n"}], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 705, "favorite_count": 0, "accepted_answer_id": 33465359, "answer_count": 1, "score": 4, "last_activity_date": 1446400947, "creation_date": 1446390183, "last_edit_date": 1446391409, "question_id": 33463580, "link": "https://stackoverflow.com/questions/33463580/parsing-with-happy-left-recursion-versus-right-recursion", "title": "Parsing with Happy: left-recursion versus right-recursion", "body": "<p><a href=\"https://www.haskell.org/happy/doc/html/sec-sequences.html\" rel=\"nofollow\">Section 2.2 of the Happy user manual</a> advises to you use left recursion rather than right recursion, because right recursion is \"inefficient\". Basically they're saying that if you try to parse a long sequence of items, right recursion will overflow the parse stack, whereas left recursion uses constant stack. The canonical example given is</p>\n\n<pre><code>items : item            { $1 : [] }\n      | items \",\" item  { $3 : $1 }\n</code></pre>\n\n<p>Unfortunately, this means that the list of items comes out backwards.</p>\n\n<p>Now it's easy enough to apply <code>reverse</code> at the end (although maddeningly annoying that you have to do this <em>everywhere the parser is called</em>, rather than once where it's <em>defined</em>). However, if the list of items is large, surely <code>reverse</code> is <em>also</em> going to overflow the Haskell stack? No?</p>\n\n<p>Basically, how do I make it so that I can parse arbitrarily-large files and still get the results out in the correct order?</p>\n"}, {"tags": ["haskell", "yesod", "hamlet"], "answers": [{"tags": [], "owner": {"reputation": 226, "user_id": 2936306, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/907ac0b7e1ec4827e6725dcbd2be9703?s=128&d=identicon&r=PG&f=1", "display_name": "user2936306", "link": "https://stackoverflow.com/users/2936306/user2936306"}, "is_accepted": true, "score": 3, "last_activity_date": 1446461202, "last_edit_date": 1446461202, "creation_date": 1446460802, "answer_id": 33475674, "question_id": 33462821, "link": "https://stackoverflow.com/questions/33462821/yesod-accessing-a-persistent-entity-id-from-hamlet/33475674#33475674", "title": "Yesod accessing a persistent entity id from hamlet", "body": "<p>If you want to get the id of a record entity inside a handler do something like:</p>\n\n<pre><code>(Entity key _) &lt;- runDB $ getBy ...\n</code></pre>\n\n<p>a query that does not use the id to get the values(eg: get) will return an entity that contains both the id and the values.</p>\n\n<p>See:\n<a href=\"http://www.yesodweb.com/book/persistent#persistent_fetching_by_unique_constraint\" rel=\"nofollow\">http://www.yesodweb.com/book/persistent#persistent_fetching_by_unique_constraint</a></p>\n\n<p>you can see getBy returns a (Entity personId person) wrapped in a maybe\nthis also works with selectList</p>\n"}], "owner": {"reputation": 149, "user_id": 1557590, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/XNL7p.png?s=128&g=1", "display_name": "Stewart Webb", "link": "https://stackoverflow.com/users/1557590/stewart-webb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 395, "favorite_count": 0, "accepted_answer_id": 33475674, "answer_count": 1, "score": 1, "last_activity_date": 1446461202, "creation_date": 1446385690, "question_id": 33462821, "link": "https://stackoverflow.com/questions/33462821/yesod-accessing-a-persistent-entity-id-from-hamlet", "title": "Yesod accessing a persistent entity id from hamlet", "body": "<p>I currently have persistent pulling a list of products from a database and displaying them on the screen. I would like to use the Id from the database to store some information about these products in a cookie and to link to more detailed information pages. From what I understand the ID is only present in the persistent entity and not in the actual Product type? Does this mean that I should store an additional field with a random string that I can use in the cookie or is there a way to access the id used in the database? I will be adding the cookies using JavaScript.</p>\n\n<p>Up until now I have just used PHP and for that I would use the ID. I'm not sure if this is the same in Yesod because of type safety or if there is a best practice way to do this.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1446380671, "post_id": 33462015, "comment_id": 54709963, "body": "in SQL injection you hijack the server to execute unallowed commands because you did use unchecked user-input so of course you get the same problem if you use user input <i>unchecked</i> ... I just don&#39;t see where the connection here is"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1446381313, "post_id": 33462015, "comment_id": 54710165, "body": "It depends a lot on what kind of malicious actions the data you parsing is capable of representing. SQL is very mighty, and surely you could create a Haskell DSL equivalent of it. So then just dont <code>execSQL $ read arbitraryString</code> and you&#39;re safe."}], "answers": [{"tags": [], "owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "is_accepted": true, "score": 3, "last_activity_date": 1446380781, "creation_date": 1446380781, "answer_id": 33462127, "question_id": 33462015, "link": "https://stackoverflow.com/questions/33462015/haskell-is-it-possible-to-inject-show-and-read/33462127#33462127", "title": "Haskell: Is it possible to inject Show and Read?", "body": "<p>Assuming that the attacker can only provide the textual representation for those values and that for SQL injection you mean executing arbitrary code as a result of parsing the input: <strong>no</strong>.</p>\n\n<p>Assuming you have control over instances of <code>Show</code> and <code>Read</code> and you are careful to keep your code pure, it doesn't matter what input is provided by the attacker, your code is pure and doesn't have side-effects, hence something like \"SQL injection\" is not possible.</p>\n\n<p>Obviously the attacker could provide an input that requires a lot of time/resources to parse but this is a DoS attack, which is different from an SQL injection-like attack.</p>\n"}, {"comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1446385305, "post_id": 33462128, "comment_id": 54711269, "body": "This is only due to the automatically derived instances. You can easily write a safe version of <code>Show</code> and <code>Read</code> that checks the correctness of the <code>length</code>. Also this isn&#39;t really like an SQL injection; this simply creates malformed data but doesn&#39;t execute anything."}, {"owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1446390545, "post_id": 33462128, "comment_id": 54712892, "body": "@Bakuriu I agree, that&#39;s what I mean by &quot;obvious way&quot; in the first sentence. To just not be naive with it. That aside, you may find or may not find resemblance to SQL injection but either way this can lead to security problems. Even if you only consider execution: execution that depends on data is a subset of when this problem would occur, and I&#39;d argue that it&#39;s very frequent as-well."}], "tags": [], "owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "is_accepted": false, "score": 1, "last_activity_date": 1446381484, "last_edit_date": 1446381484, "creation_date": 1446380789, "answer_id": 33462128, "question_id": 33462015, "link": "https://stackoverflow.com/questions/33462015/haskell-is-it-possible-to-inject-show-and-read/33462128#33462128", "title": "Haskell: Is it possible to inject Show and Read?", "body": "<p>On top of my head, when it's unsafe, it's in an obvious way. So basically: don't trust with <code>read</code> any input you get from anyone. It's meant for deserialization, so when you do deserialize, make a function to check the sanity of the data you receive.</p>\n\n<p>Otherwise a user could easily change the input (<code>show</code> yields very simple text), and bypass smart constructors. Another way to deal with this is create custom, safer, instances. E.g. a lot of containers serialize to something like: <code>fromList [1,2,3]</code> instead of <code>show</code>ing the underlying structure. Can't have too many problems with that.</p>\n\n<p>Here's a GHCi session for a datatype that is a list with an <code>Int</code> for it's size:</p>\n\n<pre><code>data LList a = LList [a] Int deriving (Eq, Ord, Show, Read)\nlet mkLList xs = LList xs (length xs)\n-- Module would only expose (LList, mkLList)\nread \"LList [6,4,2] 6548\" :: LList Int\n&gt; LList [6,4,2] 6548\n</code></pre>\n\n<p>Now we have a <code>LList</code> with the length of 6548 elements... but we only have 3.</p>\n"}], "owner": {"reputation": 1332, "user_id": 3262785, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XqvLk.jpg?s=128&g=1", "display_name": "sqd", "link": "https://stackoverflow.com/users/3262785/sqd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 33462127, "answer_count": 2, "score": 1, "last_activity_date": 1446381484, "creation_date": 1446380057, "question_id": 33462015, "link": "https://stackoverflow.com/questions/33462015/haskell-is-it-possible-to-inject-show-and-read", "title": "Haskell: Is it possible to inject Show and Read?", "body": "<p>I read this mail <a href=\"https://mail.haskell.org/pipermail/haskell/2003-August/012372.html\" rel=\"nofollow\">*safe* coerce:four methods compared</a>, in which methods of type conversions are discussed.</p>\n\n<p>In the first approach, <code>String</code> is used as the universal representation and every type which wants to convert to/from other types simply makes itself instances of typeclasses <code>Show</code> and <code>Read</code>.</p>\n\n<p>However, would this raise a security issue? Is there a way for the input to hijack the process, in a way similar to SQL injection?</p>\n"}, {"tags": ["json", "haskell", "aeson", "haskell-pipes"], "answers": [{"comments": [{"owner": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "edited": false, "score": 0, "creation_date": 1446392469, "post_id": 33462902, "comment_id": 54713522, "body": "Great! I&#39;m still getting used to <code>lift</code> and sometimes I find it hard to use it correctly."}, {"owner": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "edited": false, "score": 0, "creation_date": 1446392880, "post_id": 33462902, "comment_id": 54713650, "body": "Since Aeson&#39;s <code>encode</code> returns a ByteString I think I can use the <a href=\"https://hackage.haskell.org/package/pipes-bytestring-2.1.1/docs/Pipes-ByteString.html#v:intersperse\" rel=\"nofollow noreferrer\"><code>intersperse</code></a> function from the pipes-group package somehow? Instead of <code>insertCommas</code> I mean."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "edited": false, "score": 0, "creation_date": 1446393302, "post_id": 33462902, "comment_id": 54713772, "body": "You can try it, but I think that intersperses a character between every pair of characters in the Bytestring."}, {"owner": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "edited": false, "score": 0, "creation_date": 1446394719, "post_id": 33462902, "comment_id": 54714227, "body": "I needed a <code>Consumer</code>, so I modified your code (I put it in the question). But I cannot understand why the closing <code>]</code> is never outputted."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "edited": false, "score": 0, "creation_date": 1446395685, "post_id": 33462902, "comment_id": 54714529, "body": "This should really be a new question. As a pipe segment <code>insertCommas</code> never returns, so that&#39;s why I print the brackets outside of the runEffect."}, {"owner": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "edited": false, "score": 0, "creation_date": 1446396191, "post_id": 33462902, "comment_id": 54714716, "body": "You are right, the issue is a bit more involved. I asked it in the new question here: <a href=\"http://stackoverflow.com/questions/33464543/forking-the-streaming-flow-in-haskell-pipes\" title=\"forking the streaming flow in haskell pipes\">stackoverflow.com/questions/33464543/&hellip;</a>  Thank you for your patience and help."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 1, "last_activity_date": 1446386099, "creation_date": 1446386099, "answer_id": 33462902, "question_id": 33461540, "link": "https://stackoverflow.com/questions/33461540/serializing-values-to-json-array-with-pipes/33462902#33462902", "title": "Serializing values to JSON array with pipes", "body": "<p>This pipe segment:</p>\n\n<pre><code>for cat $ \\x -&gt; lift $ do { putStr \", \"; putStrLn x }\n</code></pre>\n\n<p>will emit a comma before each element in the pipe.</p>\n\n<p>To give the first element special treatment, we just unroll the loop once:</p>\n\n<pre><code>insertCommas = do\n  x1 &lt;- await\n  lift $ putStrLn x1      -- print first element w/o a comma\n  for cat $ \\x -&gt; lift $ do { putStr \", \"; putStrLn x }\n</code></pre>\n\n<p>Now you can write your streaming JSON pipeline as:</p>\n\n<pre><code>putStr \"[\"\nrunEffect $ source &gt;-&gt; P.map encode &gt;-&gt; insertCommas\nputStrLn \"]\"\n</code></pre>\n"}], "owner": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 0, "accepted_answer_id": 33462902, "answer_count": 1, "score": 0, "last_activity_date": 1446394831, "creation_date": 1446376278, "last_edit_date": 1446394831, "question_id": 33461540, "link": "https://stackoverflow.com/questions/33461540/serializing-values-to-json-array-with-pipes", "title": "Serializing values to JSON array with pipes", "body": "<p>I'd like to serialize incoming values to JSON. Every value has a <code>toJSON</code> instance. The end result should be a list. The current code is the following:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Pipes\nimport qualified Pipes.Prelude as P\n\n-- assume a source of elements\nmain :: IO ()\nmain = runEffect $ source &gt;-&gt; P.map encode &gt;-&gt; P.stdoutLn\n</code></pre>\n\n<p>The problem is that in this way every line contains a valid JSON object, but I want the whole result to be parseable. I'd like that before the first object a <code>[</code> character is outputted, then every element followed by a comma, and finally another <code>]</code>. How can I do this with pipes?</p>\n\n<p>Current output:</p>\n\n<pre><code>$ prog\n{\"key\": \"value\"}\n{\"key\": \"value\"}\n</code></pre>\n\n<p>Desired output:</p>\n\n<pre><code>$ prog\n[{\"key\": \"value\"},\n{\"key\": \"value\"}]\n</code></pre>\n\n<p>I found pipes-aeson but I don't understand how should I use the functions it provides.</p>\n\n<p><strong>EDIT</strong>: I modified ErikR's answer to get a <code>Consumer</code>, but it does not output the closing bracket:</p>\n\n<pre><code>jsonExporter :: Consumer (FilePath, AnalysisResult) IO ()\njsonExporter = do\n    lift $ putStr \"[\"\n    P.map encode &gt;-&gt; insertCommas\n    lift $ putStr \"]\"\n</code></pre>\n\n<p>I cannot understand why.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 5392, "user_id": 695787, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/flhSj.jpg?s=128&g=1", "display_name": "Jameson", "link": "https://stackoverflow.com/users/695787/jameson"}, "edited": false, "score": 0, "creation_date": 1446362766, "post_id": 33460097, "comment_id": 54706269, "body": "<a href=\"https://stackoverflow.com/questions/940382/haskell-difference-between-dot-and-dollar-sign\" title=\"haskell difference between dot and dollar sign\">stackoverflow.com/questions/940382/&hellip;</a>"}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1446363440, "post_id": 33460097, "comment_id": 54706374, "body": "I&#39;ve closed this as a duplicate, although I&#39;ll (like last time this happened) point out that the top answer to the duplicate doesn&#39;t contain the reasoning that convinces <i>me</i> (see the answers by sclv and Antal Spector-Zabusky for that)."}, {"owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1446363840, "post_id": 33460097, "comment_id": 54706441, "body": "@&#216;rjanJohansen None of the answers in the &quot;duplicate&quot; say anything about functional or performance differences, which is what I&#39;d like to know. They only talk about the difference in intention and in type. I can I can infer that the two are functionally and performance-wise equivalent."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1446368627, "post_id": 33460097, "comment_id": 54707361, "body": "Oh right. With GHC inlining, they should normally be compiled to the same thing."}], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 50, "favorite_count": 0, "closed_date": 1446362919, "answer_count": 0, "score": 2, "last_activity_date": 1446362626, "creation_date": 1446362626, "question_id": 33460097, "link": "https://stackoverflow.com/questions/33460097/difference-between-using-and-to-chain-functions-in-haskell", "closed_reason": "Duplicate", "title": "Difference between using $ and . to chain functions in Haskell?", "body": "<p>Although I often read that it is advisable to chain functions in the following manner:</p>\n\n<pre><code>f1 . f2 . f3 . f4 $ value\n</code></pre>\n\n<p>I find that I like the following chaining method better:</p>\n\n<pre><code>f1 $ f2 $ f3 $ f4 value\n</code></pre>\n\n<p>Other than the visual difference, is there a functional or performance difference between the two?</p>\n"}, {"tags": ["haskell", "haskell-ivory"], "answers": [{"tags": [], "owner": {"reputation": 26, "user_id": 1726285, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ac4f09f8947a82184e56daacb1bd2fe?s=128&d=identicon&r=PG", "display_name": "user1726285", "link": "https://stackoverflow.com/users/1726285/user1726285"}, "is_accepted": true, "score": 1, "last_activity_date": 1446608621, "creation_date": 1446608621, "answer_id": 33513294, "question_id": 33459506, "link": "https://stackoverflow.com/questions/33459506/ivory-how-to-use-the-ivory-hw-package/33513294#33513294", "title": "Ivory: how to use the ivory-hw package", "body": "<p>The solution is to include <code>hw_moduledef</code> in the package:</p>\n\n<pre><code>main_module :: Module\nmain_module = package \"main\" $\n  incl cmain &gt;&gt; hw_moduledef\n</code></pre>\n\n<p>(The <code>depend</code> function just includes the header.) Including <code>hw_moduledef</code> in the package <code>\"main\"</code> makes its definitions visible to the sanity-checker.</p>\n\n<p>By the way, the Ivory module system may be improved in the future, so that Ivory computes, at compile time, the dependencies, relieving the programmer from having to make explicit includes.</p>\n"}], "owner": {"reputation": 538, "user_id": 500511, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/99duf.png?s=128&g=1", "display_name": "helpwithhaskell", "link": "https://stackoverflow.com/users/500511/helpwithhaskell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 1, "accepted_answer_id": 33513294, "answer_count": 1, "score": 3, "last_activity_date": 1446644380, "creation_date": 1446355678, "last_edit_date": 1446644380, "question_id": 33459506, "link": "https://stackoverflow.com/questions/33459506/ivory-how-to-use-the-ivory-hw-package", "title": "Ivory: how to use the ivory-hw package", "body": "<p>I'm experimenting with <code>Ivory</code> (<a href=\"http://ivorylang.org\" rel=\"nofollow\">http://ivorylang.org</a>, <a href=\"https://github.com/GaloisInc/ivory\" rel=\"nofollow\">https://github.com/GaloisInc/ivory</a>) and using the <code>ivory-hw</code> module to manipulate some registers in a microcontroller.</p>\n\n<pre><code>cmain :: Def ('[] :-&gt; ())\ncmain  = voidProc \"main\" $ body $ do\n  setReg regFoo $ do\n    clearBit foo_bitbar\n    setBit foo_bitbaz\n  forever $ return ()\n\nmain_module :: Module\nmain_module = package \"main\" $ do\n  incl cmain\n\nmain :: IO ()\nmain = runCompiler [ main_module ] [] (initialOpts {constFold = True, \n                                                    outDir = Just \"out\"})\n</code></pre>\n\n<p>Building and running gives:</p>\n\n<pre><code>$ exe\n*** Procedure main\n    ERROR: [ No location available ]:\n             Unbound value: 'ivory_hw_io_write_u32'\nexe: Sanity-check failed!\n</code></pre>\n\n<p>Adding the option <code>scErrors = False</code> to <code>runCompiler</code> turns sanity checks off and the code runs to completion generating sources.</p>\n\n<p>However, <code>main.c</code> contains a call to <code>ivory_hw_io_write_u32</code> but this function is not defined anywhere (perhaps explaining the error). Poking about github, I can find examples that have a file <code>ivory_hw_prim.h</code>.</p>\n\n<p>After some experimentation, I can include this by adding a module for the hw stuff and then adding that as a dependency to my <code>main_module</code>:</p>\n\n<pre><code>hw_module :: Module\nhw_module = package \"ivory_hw_prim\" hw_moduledef\n\nmain_module :: Module\nmain_module = package \"main\" $ do\n  depend hw_module\n  incl cmain\n</code></pre>\n\n<p>and calling the <code>runCompiler</code> with <code>hw_artifacts</code> added to generate the header:</p>\n\n<pre><code>main = runCompiler [ main_module ] hw_artifacts (initialOpts {scErrors = False, \n                                                              constFold = True, \n                                                              outDir = Just \"out\"})\n</code></pre>\n\n<p>This adds <code>ivory_hw_prim.h</code> to the collection of files generated and includes the necessary include in <code>main.h</code>.</p>\n\n<p>However, this only works by retaining the <code>scErrors = False</code> option to <code>runCompiler</code> which suggests that I am still not doing this right.</p>\n\n<p>My question is therefore: What is the correct way to use Ivory's HW package?</p>\n"}, {"tags": ["haskell", "repa"], "answers": [{"tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 1, "last_activity_date": 1446357855, "last_edit_date": 1446357855, "creation_date": 1446357542, "answer_id": 33459666, "question_id": 33459496, "link": "https://stackoverflow.com/questions/33459496/haskell-repa-meaning-of-boundfixed/33459666#33459666", "title": "Haskell Repa meaning of BoundFixed?", "body": "<p>Reading through the source code for <a href=\"http://haddock.stackage.org/lts-3.11/repa-3.4.0.1/src/Data-Array-Repa-Stencil-Dim2.html#mapStencil2\" rel=\"nofollow\"><code>mapStencil2</code></a> and <a href=\"http://haddock.stackage.org/lts-3.11/repa-3.4.0.1/src/Data-Array-Repa-Stencil-Partition.html#partitionForStencil\" rel=\"nofollow\"><code>partitionForStencil</code></a>, it looks like the border region is any cell whose value would be computed using cells outside the input array. <code>BoundConst</code> uses a constant value outside the array as the input to the convolution when sampling cells outside the array. <code>BoundFixed</code> uses a constant value as the result any time the convolution would depend on a value outside the array.</p>\n\n<p>You could easily test this with a 3x3 identity convolution on a small image. <code>BoundConst</code> and <code>BoundClamp</code> shouldn't change the image at all. <code>BoundFixed a</code> would draw one cell <code>a</code> border on the image. <code>BoundFixed</code> with a 2x2 identity convolution should draw the border on only two sides of the image. I can't recommend using <code>BoundFixed</code> for anything other than drawing borders, since the same convolution would produce different results just because of the stencil size.</p>\n"}], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 33459666, "answer_count": 1, "score": 1, "last_activity_date": 1446357855, "creation_date": 1446355572, "question_id": 33459496, "link": "https://stackoverflow.com/questions/33459496/haskell-repa-meaning-of-boundfixed", "title": "Haskell Repa meaning of BoundFixed?", "body": "<p>In the Repa package, there is a <a href=\"http://haddock.stackage.org/lts-3.11/repa-3.4.0.1/Data-Array-Repa-Stencil.html#t:Boundary\" rel=\"nofollow\"><code>Boundary</code></a> datatype:</p>\n\n<pre><code>data Boundary a\n        = BoundFixed !a\n        | BoundConst !a\n        | BoundClamp\n        deriving (Show)\n</code></pre>\n\n<p>I understand what is meant by <code>BoundConst</code> (cells outside of the array are treated as single value), and I understand what is meant by <code>BoundClamp</code> (cells outside of the array are the same values as the closest array cell). </p>\n\n<p>What is meant by <code>BoundFixed</code>? The description is <em>Use a fixed value for border regions</em>. What is the \"border region\"? Are these all the edge cells? </p>\n"}, {"tags": ["haskell", "boolean-logic"], "comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 4, "creation_date": 1446346560, "post_id": 33458706, "comment_id": 54703986, "body": "Are you sure NAND distributes over NOR? It doesn&#39;t look like it does to me: <code>let (a, b, c) = (True, True, False) in a `nand` (b `nor` c)</code> gives <code>True</code> while <code>let (a, b, c) = (True, True, False) in (a `nand` b) `nor` (a `nand` c)</code> gives <code>False</code>."}], "answers": [{"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 5, "last_activity_date": 1446346608, "creation_date": 1446346608, "answer_id": 33458774, "question_id": 33458706, "link": "https://stackoverflow.com/questions/33458706/nand-over-nor-in-haskell/33458774#33458774", "title": "NAND over NOR in Haskell", "body": "<p>Trying to prove the impossible, it's almost always not true (except all a=b=c=True)</p>\n"}], "owner": {"reputation": 31, "user_id": 5439031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35ad94b396b650488007bb9de5766ac7?s=128&d=identicon&r=PG&f=1", "display_name": "ntb457", "link": "https://stackoverflow.com/users/5439031/ntb457"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 730, "favorite_count": 0, "closed_date": 1446451643, "answer_count": 1, "score": -2, "last_activity_date": 1446346608, "creation_date": 1446345772, "question_id": 33458706, "link": "https://stackoverflow.com/questions/33458706/nand-over-nor-in-haskell", "closed_reason": "Not suitable for this site", "title": "NAND over NOR in Haskell", "body": "<p>Haskell beginner here. I want to show that NAND distributes over NOR in haskell. This should give me back \"True\", but I keep getting false. I'm not even sure if I'm approaching it correctly, but this is what I've tried:</p>\n\n<pre><code>nand_distributes_nor :: Bool\nnand_distributes_nor = and [(a `nand` (b `nor` c)) == ((a `nand` b) `nor` (a `nand` c)) | a&lt;-bools, b&lt;-bools, c&lt;-bools]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1446336588, "post_id": 33457916, "comment_id": 54702442, "body": "Well, you could write <code>any [ arg1 + arg2 &lt;= arg3 | [arg1, arg2, arg3] &lt;- permutations [a, b, c] ]</code> but that actually does more work than your original code (it doesn&#39;t assume <code>+</code> commutes)."}, {"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 7, "creation_date": 1446336692, "post_id": 33457916, "comment_id": 54702455, "body": "your 3 conditions are equivalent to <code>a + b + c &lt;= 2 * maximum [a, b, c]</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 0, "creation_date": 1446366607, "post_id": 33457916, "comment_id": 54706992, "body": "@behzad.nouri You could post an answer with that."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1446370996, "post_id": 33457916, "comment_id": 54707883, "body": "On the risk of being obvious: what&#39;s wrong with <code>triangleArea a b c</code>        <code>| (a+b)&lt;=c || (a+c)&lt;=b || (b+c)&lt;=a  = error &quot;Not a triangle!&quot;</code>   <code>|otherwise  = ...</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 5, "last_activity_date": 1446337152, "creation_date": 1446337152, "answer_id": 33457991, "question_id": 33457916, "link": "https://stackoverflow.com/questions/33457916/is-it-possible-to-generalise-equations-in-haskell/33457991#33457991", "title": "Is it possible to generalise equations in Haskell?", "body": "<p>I think @behzad.nouri's comment is the best.  Sometimes doing a little math is the best way to program.  Here's a somewhat overdone expansion on @melpomene's solution, which I thought would be fun to share.  Let's write a function similar to <code>permutations</code> but that computes combinations:</p>\n\n<pre><code>import Control.Arrow (first, second)\n\n-- choose n xs returns a list of tuples, the first component of each having\n-- n elements and the second component having the rest, in all combinations\n-- (ignoring order within the lists). N.B. this would be faster if implemented\n-- using a DList.\nchoose :: Int -&gt; [a] -&gt; [([a],[a])]\nchoose 0 xs = [([], xs)]\nchoose _ [] = []\nchoose n (x:xs) =\n  map (first (x:)) (choose (n-1) xs) ++\n  map (second (x:)) (choose n xs)\n</code></pre>\n\n<p>So..</p>\n\n<pre><code>ghci&gt; choose 2 [1,2,3]\n[([1,2],[3]),([1,3],[2]),([2,3],[1])]\n</code></pre>\n\n<p>Now you can write</p>\n\n<pre><code>triangleArea a b c\n  | or [ x + y &lt;= z | ([x,y], [z]) &lt;- choose 2 [a,b,c] ] = error ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1446337209, "creation_date": 1446337209, "answer_id": 33457997, "question_id": 33457916, "link": "https://stackoverflow.com/questions/33457916/is-it-possible-to-generalise-equations-in-haskell/33457997#33457997", "title": "Is it possible to generalise equations in Haskell?", "body": "<p>Here are two ideas.</p>\n\n<ol>\n<li><p>Using existing tools, you can generate all the permutations of the arguments and check that they all satisfy a condition. Thus:</p>\n\n<pre><code>import Data.List\ntriangleArea a b c\n    | any (\\[x, y, z] -&gt; x + y &lt;= z) (permutations [a,b,c])\n                = error \"Not a triangle!\"\n    | otherwise = {- ... -}\n</code></pre>\n\n<p>This doesn't require writing very much additional code; however, it will search some permutations you don't care about.</p></li>\n<li><p>Use the usual trick for choosing an element from a list and the left-overs. The <code>zippers</code> function is one I use frequently:</p>\n\n<pre><code>zippers :: [a] -&gt; [([a], a, [a])]\nzippers = go [] where\n    go b [] = []\n    go b (v:e) = (b, v, e) : go (v:b) e\n</code></pre>\n\n<p>We can use it to build a function which chooses only appropriate triples of elements:</p>\n\n<pre><code>triples :: [a] -&gt; [(a, a, a)]\ntriples xs = do\n    (b1, v1, e1) &lt;- zippers xs\n    (b2, v2, e2) &lt;- zippers e1\n    v3 &lt;- b1 ++ b2 ++ e2\n    return (v1, v2, v3)\n</code></pre>\n\n<p>Now we can write our guard like in part (1), but it will only consider unique pairings for the addition.</p>\n\n<pre><code>triangleArea a b c\n    | any (\\(x, y, z) -&gt; x + y &lt;= z) (triples [a,b,c])\n                = error \"Not a triangle!\"\n    | otherwise = {- ... -}\n</code></pre></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 3, "last_activity_date": 1446359160, "creation_date": 1446359160, "answer_id": 33459797, "question_id": 33457916, "link": "https://stackoverflow.com/questions/33457916/is-it-possible-to-generalise-equations-in-haskell/33459797#33459797", "title": "Is it possible to generalise equations in Haskell?", "body": "<p>This doesn't address the question of how to shorten your error checking code, but you may be able to limit how often you repeat it by defining some new types with invariants. This function needs error checking because you can't trust the user to supply <code>Float</code> triples that make a reasonable triangle, and if you continue to define functions this way then every triangle-related function you write would need similar error checks.</p>\n\n<p>However, if you define a Triangle type, you can check your invariants only once, when a triangle is created, and then all other functions will be guaranteed to receive valid triangles:</p>\n\n<pre><code>module Triangle (Triangle(), mkTriangle, area) where\n\ndata Triangle a = Triangle a a a deriving Show\n\nmkTriangle :: (Num a, Ord a) =&gt; a -&gt; a -&gt; a -&gt; Either String (Triangle a)\nmkTriangle a b c\n  | a + b &lt;= c = wrong\n  | a + c &lt;= b = wrong\n  | b + c &lt;= a = wrong\n  | otherwise  = Right $ Triangle a b c\n  where wrong  = Left \"Not a triangle!\"\n\narea :: Floating a =&gt; Triangle a -&gt; a\narea (Triangle a b c) = sqrt (s * (s - a) * (s - b) * (s - c))\n  where s = (a + b + c) / 2\n</code></pre>\n\n<p>Here we export the Triangle type, but not its constructor, so that the client must use <code>mkTriangle</code> instead, which can do the required error checking. Then <code>area</code>, and any other triangle functions you write, can omit the checks that they are receiving a valid triangle. This general pattern is called \"smart constructors\".</p>\n"}], "owner": {"reputation": 31, "user_id": 5511448, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea4bc8b48f84b1e63446bfecba9e510e?s=128&d=identicon&r=PG&f=1", "display_name": "okeefj22", "link": "https://stackoverflow.com/users/5511448/okeefj22"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1446359160, "creation_date": 1446336342, "question_id": 33457916, "link": "https://stackoverflow.com/questions/33457916/is-it-possible-to-generalise-equations-in-haskell", "title": "Is it possible to generalise equations in Haskell?", "body": "<p>Apologies for my poor wording of the question. I've tried searching for an answer but not knowing what to search is making it very difficult to find one.</p>\n\n<p>Here is a simple function which calculates the area of a triangle.</p>\n\n<pre><code>triangleArea        :: Float -&gt; Float -&gt; Float -&gt; Float\ntriangleArea a b c \n    | (a + b) &lt;= c  = error \"Not a triangle!\"\n    | (a + c) &lt;= b  = error \"Not a triangle!\"\n    | (b + c) &lt;= a  = error \"Not a triangle!\"\n    | otherwise     = sqrt (s * (s - a) * (s - b) * (s - c))\n        where s     = (a + b + c) / 2\n</code></pre>\n\n<p>Three lines of the function have been taken up for the purposes of error checking. I was wondering if these three lines could be condensed into one generic line.</p>\n\n<p>I was wondering if something similar to the following would be possible</p>\n\n<pre><code>(arg1 + arg2) == arg3\n</code></pre>\n\n<p>where Haskell knows to check each possible combination of the three arguments.</p>\n"}, {"tags": ["haskell", "tuples"], "comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1446333759, "post_id": 33457356, "comment_id": 54701859, "body": "You&#39;re looking for <code>Data.List.splitAt</code>."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1446472802, "post_id": 33457356, "comment_id": 54743352, "body": "why do you vandalize your own question here?"}], "answers": [{"tags": [], "owner": {"reputation": 239, "user_id": 5484133, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pMc6m.png?s=128&g=1", "display_name": "zuko32", "link": "https://stackoverflow.com/users/5484133/zuko32"}, "is_accepted": false, "score": 2, "last_activity_date": 1446332751, "creation_date": 1446332751, "answer_id": 33457548, "question_id": 33457356, "link": "https://stackoverflow.com/questions/33457356/in-haskell-how-to-solve-splitlist-into-a-tuple/33457548#33457548", "title": "In haskell. how to solve splitList into a tuple", "body": "<p>This is one possible solution:</p>\n\n<pre><code>splitList :: Int -&gt; [a] -&gt; ([a], [a])\nsplitList _ [] = ([], [])\nsplitList n xs = (take n xs, drop n xs)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121, "user_id": 2924117, "user_type": "registered", "profile_image": "https://graph.facebook.com/821112709/picture?type=large", "display_name": "Arthur Welf", "link": "https://stackoverflow.com/users/2924117/arthur-welf"}, "is_accepted": false, "score": 0, "last_activity_date": 1446428026, "creation_date": 1446428026, "answer_id": 33469393, "question_id": 33457356, "link": "https://stackoverflow.com/questions/33457356/in-haskell-how-to-solve-splitlist-into-a-tuple/33469393#33469393", "title": "In haskell. how to solve splitList into a tuple", "body": "<pre><code>splitAt :: Int -&gt; [a] -&gt; ([a], [a])\n\n\u03bb&gt; splitAt 3 [1..5]\n([1,2,3],[4,5])\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 5511358, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/805e2699d105afd869e81babacafb2a9?s=128&d=identicon&r=PG&f=1", "display_name": "user5511358", "link": "https://stackoverflow.com/users/5511358/user5511358"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1446483109, "creation_date": 1446330952, "last_edit_date": 1446483109, "question_id": 33457356, "link": "https://stackoverflow.com/questions/33457356/in-haskell-how-to-solve-splitlist-into-a-tuple", "title": "In haskell. how to solve splitList into a tuple", "body": "<p><code>splitList n xs</code>: splits a list <code>xs</code> in to a tuple of two lists based on the provided index <code>n</code>. </p>\n\n<p>Examples: </p>\n\n<pre><code>splitList 3 [1..5] \u21d2 ([1,2,3], [4,5])\nsplitList 3 [1..] \u21d2 ([1,2,3], [4..])\nsplitList 9 [] \u21d2 ([], [])\n</code></pre>\n\n<p>How do I solve it ?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 657, "user_id": 1440894, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5cd84e40bb321eb1d75a9b7aa94fec42?s=128&d=identicon&r=PG", "display_name": "MadMonty", "link": "https://stackoverflow.com/users/1440894/madmonty"}, "edited": false, "score": 0, "creation_date": 1446330088, "post_id": 33457199, "comment_id": 54700952, "body": "That&#39;s a much cleaner way of writing it, thanks. Also, I hadn&#39;t heard of Boolean blindness before! Do you know why my version doesn&#39;t work though?"}], "tags": [], "owner": {"reputation": 3961, "user_id": 176015, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/398c96f77ec9b99b1e8122214227305d?s=128&d=identicon&r=PG", "display_name": "svenningsson", "link": "https://stackoverflow.com/users/176015/svenningsson"}, "is_accepted": false, "score": 3, "last_activity_date": 1446329681, "creation_date": 1446329681, "answer_id": 33457199, "question_id": 33457163, "link": "https://stackoverflow.com/questions/33457163/let-clause-nested-in-if-clause-nested-in-do-clause/33457199#33457199", "title": "Let clause nested in if clause nested in do clause", "body": "<p>My suggestion is to not use <code>if</code> in the first place, use <code>case</code>. By using <code>case</code> you get to test the value and bind the result to a variable all in one go. Like this:</p>\n\n<pre><code>main = do\n    (command:args) &lt;- getArgs\n    case lookup command dispatch of\n      Nothing -&gt; errorExit\n      Just action -&gt; action args\n</code></pre>\n\n<p>For a more in-depth discussion on why we should prefer <code>case</code> over <code>if</code> see <a href=\"https://existentialtype.wordpress.com/2011/03/15/boolean-blindness/\" rel=\"nofollow\">boolean blindness</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1446348921, "post_id": 33457371, "comment_id": 54704333, "body": "Um, I think you&#39;ve miscalculated <code>result</code>&#39;s type, it&#39;s a <code>Maybe</code>."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1446360420, "post_id": 33457371, "comment_id": 54705885, "body": "@&#216;rjanJohansen Ah yeah, fixed it."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1446361906, "post_id": 33457371, "comment_id": 54706135, "body": "Oh, I misunderstood what you meant, too. Although I don&#39;t think the OP&#39;s original code got to the type checking stage. Also, I don&#39;t think <code>print $ fmap ...</code> will do what they meant. You need at least something like <code>traverse_</code>."}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": false, "score": 1, "last_activity_date": 1446360408, "last_edit_date": 1446360408, "creation_date": 1446331049, "answer_id": 33457371, "question_id": 33457163, "link": "https://stackoverflow.com/questions/33457163/let-clause-nested-in-if-clause-nested-in-do-clause/33457371#33457371", "title": "Let clause nested in if clause nested in do clause", "body": "<p>You are getting an error because you are trying to compare values of function type. When you perform the check <code>if result == Nothing</code>, it tries to check the equality of <code>Nothing</code> with the value of <code>result</code> which is a type of <code>Maybe ([String] -&gt; IO ())</code>. </p>\n\n<p>So, if you want it to properly typecheck, you have to define <code>Eq</code> instances for <code>-&gt;</code> and that wouldn't make any sense as you are trying to compare two functions for equality.</p>\n\n<p>You can also use <code>fmap</code> to write your code:</p>\n\n<pre><code>main = do\n    (command:args) &lt;- getArgs\n    let result = lookup command dispatch\n    print $ fmap (const args) result\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": true, "score": 1, "last_activity_date": 1446362375, "last_edit_date": 1446362375, "creation_date": 1446352221, "answer_id": 33459221, "question_id": 33457163, "link": "https://stackoverflow.com/questions/33457163/let-clause-nested-in-if-clause-nested-in-do-clause/33459221#33459221", "title": "Let clause nested in if clause nested in do clause", "body": "<p>@svenningsson suggested the right fix.  The reason your original fails is because <code>let</code> <em>clauses</em> can only appear at the top level of a <code>do</code> block - they're simple syntactic sugar that doesn't look into inner expressions:</p>\n\n<pre><code>do let x = 1\n   y\n</code></pre>\n\n<p>desugars to the <code>let</code> <em>expression</em></p>\n\n<pre><code>let x = 1 in y\n</code></pre>\n\n<p>Alas, in a <code>do</code> block, an <em>expression</em> clause like <code>if ... then ... else ...</code> has no way to declare variables in the rest of the <code>do</code> block at all.</p>\n\n<p>There are at least two possible ways to get around this.</p>\n\n<ol>\n<li><p>Absorb the remainder of the <code>do</code> block <em>into</em> the expression:</p>\n\n<pre><code>main = do\n    (command:args) &lt;- getArgs\n    let result = lookup command dispatch\n    if result == Nothing\n        then\n            errorExit \n        else do\n            let (Just action) = result\n            action args\n</code></pre>\n\n<p>(This is essentially the method @svenningsson uses in his better <code>case</code> version too.)</p>\n\n<p>This can however get a bit awkward if the remainder of the <code>do</code> expression needs to be duplicated into more than one branch.</p>\n\n<p>(\"Secret\" trick: GHC (unlike standard Haskell) doesn't actually require a final, inner <code>do</code> block to be indented more than the outer one, which can help if the amount of indentation starts getting annoying.)</p></li>\n<li><p>Pull the variable declaration <em>outside</em> the expression:</p>\n\n<pre><code>main = do\n    (command:args) &lt;- getArgs\n    let result = lookup command dispatch\n    action &lt;- if result == Nothing\n        then\n            errorExit \n        else do\n            let (Just action') = result\n            return action'\n    action args\n</code></pre>\n\n<p>Here that requires making up a new variable name, since the pattern in the <code>let</code> clause isn't just a simple variable.</p></li>\n</ol>\n\n<p>Finally, <code>action</code> was <em>always</em> out of scope in the last line of your code, but GHC works in several stages, and if it aborts in the parsing stage, it won't check for scope errors. (For some reason it does the <code>The last statement in a 'do' block must be an expression</code> check at a later stage than parsing.)</p>\n\n<p>Addendum: After I understood what @Sibi meant, I see that <code>result == Nothing</code> isn't going to work, so you cannot use <code>if ... then ... else ...</code> with that even with the above workarounds.</p>\n"}], "owner": {"reputation": 657, "user_id": 1440894, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5cd84e40bb321eb1d75a9b7aa94fec42?s=128&d=identicon&r=PG", "display_name": "MadMonty", "link": "https://stackoverflow.com/users/1440894/madmonty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 33459221, "answer_count": 3, "score": 1, "last_activity_date": 1446362375, "creation_date": 1446329360, "question_id": 33457163, "link": "https://stackoverflow.com/questions/33457163/let-clause-nested-in-if-clause-nested-in-do-clause", "title": "Let clause nested in if clause nested in do clause", "body": "<p>I'm currently working my way through Learn You a Haskell for Great Good, and I'm trying to modify one of the code snippets in chapter nine, \"Input and Output\" to handle errors correctly:</p>\n\n<pre><code>main = do\n    (command:args) &lt;- getArgs\n    let result = lookup command dispatch\n    if result == Nothing\n        then\n            errorExit \n        else\n            let (Just action) = result\n    action args\n</code></pre>\n\n<p>where</p>\n\n<pre><code>dispatch :: [(String, [String] -&gt; IO ())]\n</code></pre>\n\n<p>is an association list</p>\n\n<p>and </p>\n\n<pre><code>errorExit :: IO ()\n</code></pre>\n\n<p>is some function that prints an error message.</p>\n\n<p>Compiling this with GHC gives the error message</p>\n\n<pre><code>todo.hs:20:13: parse error in let binding: missing required 'in'\n</code></pre>\n\n<p>which (to my understanding), seems to be saying that the \"let\" here doesn't realise it's in a \"do\" block.</p>\n\n<p>Adding \"do\" on lines five and seven (after \"then\" and \"else\" respectively), changes the error message to </p>\n\n<pre><code>todo.hs:20:13:\nThe last statement in a 'do' block must be an expression\n  let (Just action) = result\n\ntodo.hs:21:5: Not in scope: `action'.\n</code></pre>\n\n<p>and now, whilst I agree with the first error message, I also have that one of my variables has jumped out of scope? I've double checked my alignment, and nothing seems to be out of place.</p>\n\n<p>What is the appropriate way to assign a varaible within an if clause that is within a do block?</p>\n"}, {"tags": ["haskell", "type-mismatch"], "comments": [{"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 2, "creation_date": 1446328623, "post_id": 33457055, "comment_id": 54700525, "body": "You need to <code>print $ [1,2,3] +++ [4,5,6]</code>."}], "answers": [{"tags": [], "owner": {"reputation": 239, "user_id": 5484133, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pMc6m.png?s=128&g=1", "display_name": "zuko32", "link": "https://stackoverflow.com/users/5484133/zuko32"}, "is_accepted": true, "score": 1, "last_activity_date": 1446330786, "creation_date": 1446330786, "answer_id": 33457333, "question_id": 33457055, "link": "https://stackoverflow.com/questions/33457055/cant-debug-haskell-type-mismatch-error/33457333#33457333", "title": "Can&#39;t debug haskell type mismatch error", "body": "<p>To work off the mismatch error you can simply use the 'print' function. Like that:</p>\n\n<pre><code>(+++) :: [a] -&gt; [a] -&gt; [a]\nlst1 +++ lst2 = if null lst1\n            then []\n            else (head lst1) : (tail lst1 +++ lst2)\n\nmain :: IO ()\nmain = do\n   putStrLn \"start\"                                                                                                          \n   print ([1,2,3] +++ [4,5,6])\n   putStrLn \"end\"\n</code></pre>\n\n<p>Now, I don't know what you want to achieve with the '+++' function, but at least now you don't worry for type errors.</p>\n\n<p>Hope it helped!</p>\n"}], "owner": {"reputation": 653, "user_id": 4134398, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/nP0zN.png?s=128&g=1", "display_name": "Draif Kroneg", "link": "https://stackoverflow.com/users/4134398/draif-kroneg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 33457333, "answer_count": 1, "score": 0, "last_activity_date": 1446330786, "creation_date": 1446328383, "question_id": 33457055, "link": "https://stackoverflow.com/questions/33457055/cant-debug-haskell-type-mismatch-error", "title": "Can&#39;t debug haskell type mismatch error", "body": "<p>Compiling the code gives</p>\n\n<pre><code>(+++) :: [a] -&gt; [a] -&gt; [a]\nlst1 +++ lst2 = if null lst1\n                then []\n                else (head lst1) : (tail lst1 +++ lst2)\n\n\nmain :: IO ()\nmain = do\n  putStrLn \"start\"                                                                                                          \n  [1,2,3] +++ [4,5,6]\n  putStrLn \"end\"\n</code></pre>\n\n<p>Couldn't match expected type \u2018IO a0\u2019 with actual type \u2018[Integer]\u2019\n    In a stmt of a 'do' block: [1, 2, 3] +++ [4, 5, 6]\n    In the expression:\n      do { putStrLn \"start\";\n           [1, 2, ....] +++ [4, 5, ....];\n           putStrLn \"end\" }\n    In an equation for \u2018main\u2019:\n        main\n          = do { putStrLn \"start\";\n                 [1, ....] +++ [4, ....];\n                 putStrLn \"end\" }</p>\n\n<p>What I failed to do anything about - it looks fine to me. </p>\n"}, {"tags": ["haskell", "types", "data-kinds"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1446323103, "post_id": 33456040, "comment_id": 54698885, "body": "have you had a look at the <a href=\"http://www.andres-loeh.de/Servant/servant-wgp.pdf\" rel=\"nofollow noreferrer\">paper</a>? ... Don&#39;t know if we can get a better explanation than that ... maybe you read it and come back with detail questions you don&#39;t understand - the question here is at least as broad as the paper is long ;)"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1446327136, "post_id": 33456040, "comment_id": 54700082, "body": "The class <code>GHC.TypeLits.KnownSymbol</code> and associated functions are used to convert type level strings (<code>Symbol</code>) to value level strings. The mechanism is essentially the same for any other type: use a type class. For generating types from other types, you can use a type class or a type family. The question of &quot;how&quot; is quite broad but this is the short version."}, {"owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1446331110, "post_id": 33456040, "comment_id": 54701230, "body": "@Carsten Oh. I didn&#39;t know there was a paper. Thanks :)"}, {"owner": {"reputation": 1044, "user_id": 193424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/11ba6dfa8271fb1cd0c475a2c0626853?s=128&d=identicon&r=PG", "display_name": "Alp Mestanogullari", "link": "https://stackoverflow.com/users/193424/alp-mestanogullari"}, "edited": false, "score": 1, "creation_date": 1446405125, "post_id": 33456040, "comment_id": 54717721, "body": "Hi, I&#39;m one of the authors. The papers was written precisely to answer &quot;how does it all work?&quot; -- let me know if you have more precise questions and I&#39;ll do my best to answer them."}, {"owner": {"reputation": 7579, "user_id": 453261, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/PfNvQ.jpg?s=128&g=1", "display_name": "The Internet", "link": "https://stackoverflow.com/users/453261/the-internet"}, "edited": false, "score": 0, "creation_date": 1446650940, "post_id": 33456040, "comment_id": 54832605, "body": "This is a good video on servant: <a href=\"https://www.youtube.com/watch?v=gMDiKOuwLXw\" rel=\"nofollow noreferrer\">youtube.com/watch?v=gMDiKOuwLXw</a>"}], "answers": [{"tags": [], "owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "is_accepted": false, "score": 42, "last_activity_date": 1446413677, "last_edit_date": 1446413677, "creation_date": 1446410775, "answer_id": 33467010, "question_id": 33456040, "link": "https://stackoverflow.com/questions/33456040/what-are-all-the-mechanisms-used-to-enable-servants-type-based-api/33467010#33467010", "title": "What are all the mechanisms used to enable Servant&#39;s type-based API?", "body": "<p>Looking at the <a href=\"http://www.andres-loeh.de/Servant/\" rel=\"noreferrer\">Servant paper</a> for a full explanation may\nbe the best option. Nevertheless, I'll try to illustrate the approach\ntaken by Servant here, by implementing \"TinyServant\", a version of\nServant reduced to the bare minimum.</p>\n\n<p>Sorry that this answer is so long. However, it's still a bit shorter\nthan the paper, and the code discussed here is \"only\" 81 lines,\navailable also as a Haskell file <a href=\"https://gist.github.com/kosmikus/03b6ec4a66bceb49b85d\" rel=\"noreferrer\">here</a>.</p>\n\n<h1>Preparations</h1>\n\n<p>To start, here are the language extensions we'll need:</p>\n\n<pre><code>{-# LANGUAGE DataKinds, PolyKinds, TypeOperators #-}\n{-# LANGUAGE TypeFamilies, FlexibleInstances, ScopedTypeVariables #-}\n{-# LANGUAGE InstanceSigs #-}\n</code></pre>\n\n<p>The first three are needed for the definition of the type-level DSL\nitself. The DSL makes use of type-level strings (<code>DataKinds</code>) and also\nuses kind polymorphism (<code>PolyKinds</code>).  The use of the type-level infix\noperators such as <code>:&lt;|&gt;</code> and <code>:&gt;</code> requires the <code>TypeOperators</code>\nextension.</p>\n\n<p>The second three are needed for the definition of the interpretation\n(we'll define something reminiscent of what a web server does, but\nwithout the whole web part). For this, we need type-level functions\n(<code>TypeFamilies</code>), some type class programming which will require\n(<code>FlexibleInstances</code>), and some type annotations to guide the type\nchecker which require <code>ScopedTypeVariables</code>.</p>\n\n<p>Purely for documentation purposes, we also use <code>InstanceSigs</code>.</p>\n\n<p>Here's our module header:</p>\n\n<pre><code>module TinyServant where\n\nimport Control.Applicative\nimport GHC.TypeLits\nimport Text.Read\nimport Data.Time\n</code></pre>\n\n<p>After these preliminaries, we're ready to get going.</p>\n\n<h1>API specifications</h1>\n\n<p>The first ingredient is to define the datatypes that are\nbeing used for the API specifications.</p>\n\n<pre><code>data Get (a :: *)\n\ndata a :&lt;|&gt; b = a :&lt;|&gt; b\ninfixr 8 :&lt;|&gt;\n\ndata (a :: k) :&gt; (b :: *)\ninfixr 9 :&gt;\n\ndata Capture (a :: *)\n</code></pre>\n\n<p>We define only four constructs in our simplified language:</p>\n\n<ol>\n<li><p>A <code>Get a</code> represents and endpoint of type <code>a</code> (of kind <code>*</code>).  In\ncomparison with full Servant, we ignore content types here. We need\nthe datatype only for the API specifications. There are now directly\ncorresponding values, and hence there is no constructor for <code>Get</code>.</p></li>\n<li><p>With <code>a :&lt;|&gt; b</code>, we represent the choice between two routes.\nAgain, we wouldn't need a constructor, but it turns out that\nwe'll use a pair of handlers to represent the handler of an\nAPI using <code>:&lt;|&gt;</code>. For nested applications of <code>:&lt;|&gt;</code>, we'd get\nnested pairs of handlers, which look somewhat ugly using the\nstandard notation in Haskell, so we define the <code>:&lt;|&gt;</code>\nconstructor to be equivalent to a pair.</p></li>\n<li><p>With <code>item :&gt; rest</code>, we represent nested routes, where <code>item</code>\nis the first component and <code>rest</code> are the remaining components.\nIn our simplified DSL, there are just two possibilities for\n<code>item</code>: a type-level string, or a <code>Capture</code>. Because type-level\nstrings are of kind <code>Symbol</code>, but a <code>Capture</code>, defined below\nis of kind <code>*</code>, we make the first argument of <code>:&gt;</code>\n<em>kind-polymorphic</em>, so that both options are accepted by\nthe Haskell kind system.</p></li>\n<li><p>A <code>Capture a</code> represents a route component that is captured,\nparsed and then exposed to the handler as a parameter of type <code>a</code>.\nIn full Servant, <code>Capture</code> has an additional string as a parameter\nthat is used for documentation generation. We omit the string here.</p></li>\n</ol>\n\n<h1>Example API</h1>\n\n<p>We can now write down a version of the API specification from the\nquestion, adapted to the actual types occuring in <code>Data.Time</code>, and\nto our simplified DSL:</p>\n\n<pre><code>type MyAPI = \"date\" :&gt; Get Day\n        :&lt;|&gt; \"time\" :&gt; Capture TimeZone :&gt; Get ZonedTime\n</code></pre>\n\n<h1>Interpretation as server</h1>\n\n<p>The most interesting aspect is of course what we can do with the\nAPI, and that's also mostly what the question is about.</p>\n\n<p>Servant defines several interpretations, but they all follow a\nsimilar pattern. We'll define one here, which is inspired by the\ninterpretation as a web server.</p>\n\n<p>In Servant, the <code>serve</code> function takes a proxy for the API type\nand a handler matching the API type to a WAI <code>Application</code>, which\nis essentially a function from HTTP requests to responses. We'll\nabstract from the web part here, and define</p>\n\n<pre><code>serve :: HasServer layout\n      =&gt; Proxy layout -&gt; Server layout -&gt; [String] -&gt; IO String\n</code></pre>\n\n<p>instead.</p>\n\n<p>The <code>HasServer</code> class, which we'll define below, has instances\nfor all the different constructs of the type-level DSL and therefore\nencodes what it means for a Haskell type <code>layout</code> to be interpretable\nas an API type of a server.</p>\n\n<p>The <code>Proxy</code> makes a connection between the type and the value level.\nIt's defined as</p>\n\n<pre><code>data Proxy a = Proxy\n</code></pre>\n\n<p>and its only purpose is that by passing in a <code>Proxy</code> constructor\nwith an explicitly specified type, we can make it very explicit\nfor what API type we want to compute the server.</p>\n\n<p>The <code>Server</code> argument is the handler for the <code>API</code>. Here, <code>Server</code>\nitself is a type family, and computes from the API type the type\nthat the handler(s) must have. This is one core ingredient of what\nmakes Servant work correctly.</p>\n\n<p>The list of strings represents the request, reduced to a list of\nURL components. As a result, we always return a <code>String</code> response,\nand we allow the use of <code>IO</code>. Full Servant uses somewhat more\ncomplicated types here, but the idea is the same.</p>\n\n<h1>The <code>Server</code> type family</h1>\n\n<p>We define <code>Server</code> as a type family first.\n(In Servant, the actual type family being used is <code>ServerT</code>, and it\nis defined as part of the <code>HasServer</code> class.)</p>\n\n<pre><code>type family Server layout :: *\n</code></pre>\n\n<p>The handler for a <code>Get a</code> endpoint is simply an <code>IO</code> action\nproducing an <code>a</code>. (Once again, in the full Servant code, we have\nslightly more options, such as producing an error.)</p>\n\n<pre><code>type instance Server (Get a) = IO a\n</code></pre>\n\n<p>The handler for <code>a :&lt;|&gt; b</code> is a pair of handlers, so we could\ndefine</p>\n\n<pre><code>type instance Server (a :&lt;|&gt; b) = (Server a, Server b) -- preliminary\n</code></pre>\n\n<p>But as indicated above, for nested occurrences of <code>:&lt;|&gt;</code> this leads\nto nested pairs, which look somewhat nicer with an infix pair\nconstructor, so Servant instead defines the equivalent</p>\n\n<pre><code>type instance Server (a :&lt;|&gt; b) = Server a :&lt;|&gt; Server b\n</code></pre>\n\n<p>It remains to explain how each of the path components is handled.</p>\n\n<p>Literal strings in the routes do not affect the type of the\nhandler:</p>\n\n<pre><code>type instance Server ((s :: Symbol) :&gt; r) = Server r\n</code></pre>\n\n<p>A capture, however, means that the handler expects an additional argument\nof the type being captured:</p>\n\n<pre><code>type instance Server (Capture a :&gt; r) = a -&gt; Server r\n</code></pre>\n\n<h1>Computing the handler type of the example API</h1>\n\n<p>If we expand <code>Server MyAPI</code>, we obtain</p>\n\n<pre><code>Server MyAPI ~ Server (\"date\" :&gt; Get Day\n                  :&lt;|&gt; \"time\" :&gt; Capture TimeZone :&gt; Get ZonedTime)\n             ~      Server (\"date\" :&gt; Get Day)\n               :&lt;|&gt; Server (\"time\" :&gt; Capture TimeZone :&gt; Get ZonedTime)\n             ~      Server (Get Day)\n               :&lt;|&gt; Server (\"time\" :&gt; Capture TimeZone :&gt; Get ZonedTime)\n             ~      IO Day\n               :&lt;|&gt; Server (\"time\" :&gt; Capture TimeZone :&gt; Get ZonedTime)\n             ~      IO Day\n               :&lt;|&gt; Server (Capture TimeZone :&gt; Get ZonedTime)\n             ~      IO Day\n               :&lt;|&gt; TimeZone -&gt; Server (Get ZonedTime)\n             ~      IO Day\n               :&lt;|&gt; TimeZone -&gt; IO ZonedTime\n</code></pre>\n\n<p>So as intended, the server for our API requires a pair of handlers,\none that provides a date, and one that, given a time zone, provides\na time. We can define these right now:</p>\n\n<pre><code>handleDate :: IO Day\nhandleDate = utctDay &lt;$&gt; getCurrentTime\n\nhandleTime :: TimeZone -&gt; IO ZonedTime\nhandleTime tz = utcToZonedTime tz &lt;$&gt; getCurrentTime\n\nhandleMyAPI :: Server MyAPI\nhandleMyAPI = handleDate :&lt;|&gt; handleTime\n</code></pre>\n\n<h1>The <code>HasServer</code> class</h1>\n\n<p>We still have to implement the <code>HasServer</code> class, which looks as\nfollows:</p>\n\n<pre><code>class HasServer layout where\n  route :: Proxy layout -&gt; Server layout -&gt; [String] -&gt; Maybe (IO String)\n</code></pre>\n\n<p>The task of the function <code>route</code> is almost like <code>serve</code>. Internally,\nwe have to dispatch an incoming request to the right router. In the\ncase of <code>:&lt;|&gt;</code>, this means we have to make a choice between two\nhandlers. How do we make this choice? A simple option is to allow\n<code>route</code> to fail, by returning a <code>Maybe</code>. (Again, full Servant is\nsomewhat more sophisticated here, and version 0.5 will have a much\nimproved routing strategy.)</p>\n\n<p>Once we have <code>route</code> defined, we can easily define <code>serve</code> in terms\nof <code>route</code>:</p>\n\n<pre><code>serve :: HasServer layout\n      =&gt; Proxy layout -&gt; Server layout -&gt; [String] -&gt; IO String\nserve p h xs = case route p h xs of\n  Nothing -&gt; ioError (userError \"404\")\n  Just m  -&gt; m\n</code></pre>\n\n<p>If none of the routes match, we fail with a 404. Otherwise, we\nreturn the result.</p>\n\n<h1>The <code>HasServer</code> instances</h1>\n\n<p>For a <code>Get</code> endpoint, we defined</p>\n\n<pre><code>type instance Server (Get a) = IO a\n</code></pre>\n\n<p>so the handler is an IO action producing an <code>a</code>, which we have\nto turn into a <code>String</code>. We use <code>show</code> for this purpose. In\nthe actual Servant implementation, this conversion is handled\nby the content types machinery, and will typically involve encoding\nto JSON or HTML.</p>\n\n<pre><code>instance Show a =&gt; HasServer (Get a) where\n  route :: Proxy (Get a) -&gt; IO a -&gt; [String] -&gt; Maybe (IO String)\n  route _ handler [] = Just (show &lt;$&gt; handler)\n  route _ _       _  = Nothing\n</code></pre>\n\n<p>Since we're matching an endpoint only, the require the request\nto be empty at this point. If it isn't, this route does not\nmatch and we return <code>Nothing</code>.</p>\n\n<p>Let's look at choice next:</p>\n\n<pre><code>instance (HasServer a, HasServer b) =&gt; HasServer (a :&lt;|&gt; b) where\n  route :: Proxy (a :&lt;|&gt; b) -&gt; (Server a :&lt;|&gt; Server b) -&gt; [String] -&gt; Maybe (IO String)\n  route _ (handlera :&lt;|&gt; handlerb) xs =\n        route (Proxy :: Proxy a) handlera xs\n    &lt;|&gt; route (Proxy :: Proxy b) handlerb xs\n</code></pre>\n\n<p>Here, we get a pair of handlers, and we use <code>&lt;|&gt;</code> for <code>Maybe</code>\nto try both.</p>\n\n<p>What happens for a literal string?</p>\n\n<pre><code>instance (KnownSymbol s, HasServer r) =&gt; HasServer ((s :: Symbol) :&gt; r) where\n  route :: Proxy (s :&gt; r) -&gt; Server r -&gt; [String] -&gt; Maybe (IO String)\n  route _ handler (x : xs)\n    | symbolVal (Proxy :: Proxy s) == x = route (Proxy :: Proxy r) handler xs\n  route _ _       _                     = Nothing\n</code></pre>\n\n<p>The handler for <code>s :&gt; r</code> is of the same type as the handler for <code>r</code>.\nWe require the request to be non-empty and the first component to match\nthe value-level counterpart of the type-level string. We obtain the\nvalue-level string corresponding to the type-level string literal by\napplying <code>symbolVal</code>. For this, we need a <code>KnownSymbol</code> constraint on\nthe type-level string literal. But all concrete literals in GHC are\nautomatically an instance of <code>KnownSymbol</code>.</p>\n\n<p>The final case is for captures:</p>\n\n<pre><code>instance (Read a, HasServer r) =&gt; HasServer (Capture a :&gt; r) where\n  route :: Proxy (Capture a :&gt; r) -&gt; (a -&gt; Server r) -&gt; [String] -&gt; Maybe (IO String)\n  route _ handler (x : xs) = do\n    a &lt;- readMaybe x\n    route (Proxy :: Proxy r) (handler a) xs\n  route _ _       _        = Nothing\n</code></pre>\n\n<p>In this case, we can assume that our handler is actually a function that\nexpects an <code>a</code>. We require the first component of the request to be parseable\nas an <code>a</code>. Here, we use <code>Read</code>, whereas in Servant, we use the content type\nmachinery again. If reading fails, we consider the request not to match.\nOtherwise, we can feed it to the handler and continue.</p>\n\n<h1>Testing everything</h1>\n\n<p>Now we're done.</p>\n\n<p>We can confirm that everything works in GHCi:</p>\n\n<pre><code>GHCi&gt; serve (Proxy :: Proxy MyAPI) handleMyAPI  [\"time\", \"CET\"]\n\"2015-11-01 20:25:04.594003 CET\"\nGHCi&gt; serve (Proxy :: Proxy MyAPI) handleMyAPI  [\"time\", \"12\"]\n*** Exception: user error (404)\nGHCi&gt; serve (Proxy :: Proxy MyAPI) handleMyAPI  [\"date\"]\n\"2015-11-01\"\nGHCi&gt; serve (Proxy :: Proxy MyAPI) handleMyAPI  []\n*** Exception: user error (404)\n</code></pre>\n"}], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1405, "favorite_count": 17, "answer_count": 1, "score": 34, "last_activity_date": 1446413677, "creation_date": 1446322003, "question_id": 33456040, "link": "https://stackoverflow.com/questions/33456040/what-are-all-the-mechanisms-used-to-enable-servants-type-based-api", "title": "What are all the mechanisms used to enable Servant&#39;s type-based API?", "body": "<p>I'm very puzzled by how Servant is able to achieve the magic that it does using typing. The example on the web site already puzzles me greatly:</p>\n\n<pre><code>type MyAPI = \"date\" :&gt; Get '[JSON] Date\n        :&lt;|&gt; \"time\" :&gt; Capture \"tz\" Timezone :&gt; Get '[JSON] Time\n</code></pre>\n\n<p>I get the \"date\", \"time\", <code>[JSON]</code> and \"tz\" are type-level literals. They are values that have \"become\" types. Okay.</p>\n\n<p>I get that <code>:&gt;</code> and <code>:&lt;|&gt;</code> are type operators. Okay.</p>\n\n<p>I don't get how these things, after they've become types, can be extracted back out into values. What's the mechanism to do this?</p>\n\n<p>I also don't get how the first part of this type can get the framework to expect a function of the signature <code>IO Date</code>, or how the second part of this type can get the framework to expect a function of the signature <code>Timezone -&gt; IO Time</code> from me. How does this transformation happen? </p>\n\n<p>And how then can the framework call a function for which it didn't initially know the type?</p>\n\n<p>I'm sure there are a number of GHC extensions and unique features at play here that I'm not familiar with that combine to make this magic happen. </p>\n\n<p>Can someone explain what features are involved here and how they are working together?</p>\n"}, {"tags": ["haskell", "fold", "elm"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1446319678, "post_id": 33455633, "comment_id": 54697879, "body": "I&#39;d start by expanding the definition of <code>foldr</code>."}], "answers": [{"comments": [{"owner": {"reputation": 5531, "user_id": 1086127, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d2f536d7196ab0998c57df6a6203d441?s=128&d=identicon&r=PG", "display_name": "mgold", "link": "https://stackoverflow.com/users/1086127/mgold"}, "edited": false, "score": 0, "creation_date": 1446474824, "post_id": 33455778, "comment_id": 54744672, "body": "<code>a `f` b</code> is valid syntax in Elm, which uses <code>::</code> as list cons rather than Haskell&#39;s <code>:</code>."}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 4, "last_activity_date": 1606838552, "last_edit_date": 1606838552, "creation_date": 1446320169, "answer_id": 33455778, "question_id": 33455633, "link": "https://stackoverflow.com/questions/33455633/using-foldr-in-elm-haskell/33455778#33455778", "title": "using foldr in elm/haskell", "body": "<p><strong>disclaimer:</strong> this is in Haskell and I don't know if the <code>a `f` b</code> syntax is valid in Elm but it will not change the outcome you just had to write <code>f a b</code> instead of <code>a `f` b</code> where ever you find it</p>\n<hr />\n<p>take one component of <code>q2</code> (I'll take the last - because it's the shortest among them):</p>\n<pre><code>foldr findSubsequences 0 [4,3,2,1,2,3,4]\n{ with fSs = findSubsequences - note that [] is replaced with the 0 of the first arg }\n= 4 `fSs` (3 `fSs` (2 `fSs` (1 `fSs`(2 `fSs` (3 `fSs` (4 `fSs` 0))))))\n{ 4 is not 0+1 so 4 `fSs` 0 = 0 }\n= 4 `fSs` (3 `fSs` (2 `fSs` (1 `fSs`(2 `fSs` (3 `fSs` 0)))))\n{ 3 is not 0+1  so 3 `fSs` 0 = 0 }\n= 4 `fSs` (3 `fSs` (2 `fSs` (1 `fSs`(2 `fSs` 0))))\n{ 2 is not 0+1  so 2 `fSs` 0 = 0 }\n= 4 `fSs` (3 `fSs` (2 `fSs` (1 `fSs`0)))\n{ 1 IS 0+1  so 1 `fSs` 0 = 1 }\n= 4 `fSs` (3 `fSs` (2 `fSs` 1))\n{ 2 IS 1+1 so 2 `fSs` 1 = 2 }\n= 4 `fSs` (3 `fSs` 2)\n{ 3 IS 2+1 so 3 `fSs` 2 = 3 }\n= 4 `fSs` 3\n{ 4 IS 3+1 so 4 `fSs` 3 = 4 }\n= 4\n</code></pre>\n<p>where each step is just using your definition</p>\n<p>I hope you are able to do the same for the other cases as well :D</p>\n<hr />\n<p>note that I use the <em>simple trick</em> of replacing:</p>\n<ul>\n<li><code>:</code> with <code>findSubsequences</code></li>\n<li><code>[]</code> with <code>0</code> (the first argument of <code>`findSubsequences`</code>)</li>\n</ul>\n<p>where you represent your input list as <code>a:b:c:...:[]</code></p>\n"}, {"tags": [], "owner": {"reputation": 2313, "user_id": 5276520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dbaa9803983597167dbb65d52c24a3da?s=128&d=identicon&r=PG", "display_name": "dkasak", "link": "https://stackoverflow.com/users/5276520/dkasak"}, "is_accepted": false, "score": 8, "last_activity_date": 1446321880, "last_edit_date": 1446321880, "creation_date": 1446321519, "answer_id": 33455975, "question_id": 33455633, "link": "https://stackoverflow.com/questions/33455633/using-foldr-in-elm-haskell/33455975#33455975", "title": "using foldr in elm/haskell", "body": "<p>The <code>r</code> in <code>foldr</code> signifies that it is a <em>right-associative</em> fold.</p>\n\n<p>In case you're not familiar with the term, associativity is a property of operators that tells us how to interpret ambiguous expressions composed of sequential applications of the operator without parentheses. By specifying the associativity of an operator, we resolve the ambiguity by specifying the end from which the expression should be evaluated (hence the use of <em>right</em> and <em>left</em>).</p>\n\n<p>As an example, how should we interpret the following expression?</p>\n\n<pre><code>1 / 2 / 3 / 4\n</code></pre>\n\n<p>The answer depends on the associativity of the operator <code>/</code>. If the operator is left-associative, the answer is:</p>\n\n<pre><code>((1 / 2) / 3) / 4\n</code></pre>\n\n<p>On the other hand, a right-associative <code>/</code> would evaluate to:</p>\n\n<pre><code>1 / (2 / (3 / 4)))\n</code></pre>\n\n<p>Folds are, in essence, a way of forming such expressions by interspersing an operator between the elements of a sequence. However, because of associativity, there are clearly two equally meaningful ways of doing this, resulting in <code>foldr</code> and <code>foldl</code>.</p>\n\n<p>Applying this to the last element of your tuple (renaming <code>findSubsequence</code> to <code>f</code> for brevity) results in:</p>\n\n<pre><code>foldr f 0 [4,3,2,1,2,3,4] = f 4 (f 3 (f 2 (f 1 (f 2 (f 3 (f 4 0))))))\n                          = f 4 (f 3 (f 2 (f 1 (f 2 (f 3 0)))))\n                          = f 4 (f 3 (f 2 (f 1 (f 2 0))))\n                          = f 4 (f 3 (f 2 (f 1 0)))\n                          = f 4 (f 3 (f 2 1))\n                          = f 4 (f 3 2)\n                          = f 4 3\n                          = 4\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 5510962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ee0c0b9cbf62c19a7812a1031bd233e?s=128&d=identicon&r=PG&f=1", "display_name": "Chloe", "link": "https://stackoverflow.com/users/5510962/chloe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 811, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1606838552, "creation_date": 1446319326, "last_edit_date": 1446319636, "question_id": 33455633, "link": "https://stackoverflow.com/questions/33455633/using-foldr-in-elm-haskell", "title": "using foldr in elm/haskell", "body": "<p>I'm having trouble solving this problem using foldr. I understand foldr for simple problems (like foldr (+) 5 [1,2,3,4]) but this is more complicated:</p>\n\n<p>Question: What is the value of q2?</p>\n\n<pre><code>findSubsequence next highest = case next == highest + 1 of\n  True -&gt; next\n  False -&gt; highest\n\nq2 = (foldr findSubsequence 0 [5,6,8,4,7,3,2,1,0,2,3,1,0]\n     ,foldr findSubsequence 0 [0,1,3,2,0,1,2,3,7,4,8,6,5]\n     ,foldr findSubsequence 0 [1,2,3,4,3,2,1]\n     ,foldr findSubsequence 0 [4,3,2,1,2,3,4]\n     )\n</code></pre>\n\n<p>Using foldr for each list gives you the value and put together the resulting list is [5,3,4,4] but I don't know the process of solving this. Help would be appreciated :)</p>\n"}, {"tags": ["haskell", "functional-programming", "pointfree"], "comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1446314548, "post_id": 33454650, "comment_id": 54696207, "body": "<code>let average = liftM2 ((&#47;) . realToFrac) sum genericLength</code> works."}, {"owner": {"reputation": 3409, "user_id": 3105485, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b4c41125ff9c7b20ca07d0845e7af7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Caridorc", "link": "https://stackoverflow.com/users/3105485/caridorc"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1446314889, "post_id": 33454650, "comment_id": 54696322, "body": "@&#216;rjanJohansen Interesting, could you explain why in an answer?"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1446315141, "post_id": 33454650, "comment_id": 54696410, "body": "Have a look at the <code>ap</code> implementation of the Monad instance for functions"}, {"owner": {"reputation": 571, "user_id": 3429327, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/uPy6Z.jpg?s=128&g=1", "display_name": "awllower", "link": "https://stackoverflow.com/users/3429327/awllower"}, "edited": false, "score": 0, "creation_date": 1520672665, "post_id": 33454650, "comment_id": 85419339, "body": "As a fun exercise, <code>ap</code> can be defined as <code>(. ((. (return .)) . (&gt;&gt;=))) . (&gt;&gt;=)</code>. :-)"}], "answers": [{"comments": [{"owner": {"reputation": 3409, "user_id": 3105485, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b4c41125ff9c7b20ca07d0845e7af7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Caridorc", "link": "https://stackoverflow.com/users/3105485/caridorc"}, "edited": false, "score": 1, "creation_date": 1446315161, "post_id": 33454917, "comment_id": 54696418, "body": "So defining <code>ap&#39; f g = \\x -&gt; f x (g x)</code> will give it a subset of the power that the normal <code>ap</code> has?"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "reply_to_user": {"reputation": 3409, "user_id": 3105485, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b4c41125ff9c7b20ca07d0845e7af7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Caridorc", "link": "https://stackoverflow.com/users/3105485/caridorc"}, "edited": false, "score": 1, "creation_date": 1446315293, "post_id": 33454917, "comment_id": 54696461, "body": "@Caridorc: Yes, normal <code>ap</code> works on all monads, your <code>ap&#39;</code> only on functions"}, {"owner": {"reputation": 3409, "user_id": 3105485, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b4c41125ff9c7b20ca07d0845e7af7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Caridorc", "link": "https://stackoverflow.com/users/3105485/caridorc"}, "edited": false, "score": 0, "creation_date": 1446316014, "post_id": 33454917, "comment_id": 54696700, "body": "Is <code>ap&#39;</code> in a way similar to <code>.</code>? While <code>.</code> composes two functions that both take one argument, <code>ap&#39;</code> composes two functions one taking two arguments and one taking one argument."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 3409, "user_id": 3105485, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b4c41125ff9c7b20ca07d0845e7af7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Caridorc", "link": "https://stackoverflow.com/users/3105485/caridorc"}, "edited": false, "score": 0, "creation_date": 1446318291, "post_id": 33454917, "comment_id": 54697432, "body": "@Caridorc Only vaguely. It is known as &quot;combinator S&quot; in lambda calculus and combinatory logic.<a href=\"https://en.wikipedia.org/wiki/Combinatory_logic#Examples_of_combinators\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Combinatory_logic#Examples_of_co&zwnj;&#8203;mbinators</a>"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1446360113, "post_id": 33454917, "comment_id": 54705841, "body": "@chi Indeed! <code>Applicative</code> can be considered a generalization of the SKI calculus: <code>(&lt;*&gt;)</code> is S, <code>pure</code> is K, and I = S K K."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 8, "last_activity_date": 1446315761, "last_edit_date": 1446315761, "creation_date": 1446315068, "answer_id": 33454917, "question_id": 33454650, "link": "https://stackoverflow.com/questions/33454650/understanding-ap-in-a-point-free-function-in-haskell/33454917#33454917", "title": "Understanding `ap` in a point-free function in Haskell", "body": "<p>When the monad <code>m</code> is <code>(-&gt;) a</code>, as in your case, you can define <code>ap</code> as follows:</p>\n\n<pre><code>ap f g = \\x -&gt; f x (g x)\n</code></pre>\n\n<p>We can see that this indeed \"works\" in your pointfree example.</p>\n\n<pre><code>average = ap ((/) . realToFrac . sum) genericLength\naverage = \\x -&gt; ((/) . realToFrac . sum) x (genericLength x)\naverage = \\x -&gt; (/) (realToFrac (sum x)) (genericLength x)\naverage = \\x -&gt; realToFrac (sum x) / genericLength x\n</code></pre>\n\n<p>We can also derive <code>ap</code> from the general law</p>\n\n<pre><code>ap f g = do ff &lt;- f ; gg &lt;- g ; return (ff gg)\n</code></pre>\n\n<p>that is, desugaring the <code>do</code>-notation</p>\n\n<pre><code>ap f g = f &gt;&gt;= \\ff -&gt; g &gt;&gt;= \\gg -&gt; return (ff gg)\n</code></pre>\n\n<p>If we substitute the definitions of the monad methods</p>\n\n<pre><code>m &gt;&gt;= f = \\x -&gt; f (m x) x\nreturn x = \\_ -&gt; x\n</code></pre>\n\n<p>we get the previous definition of <code>ap</code> back (for our specific monad <code>(-&gt;) a</code>). Indeed:</p>\n\n<pre><code>app f g \n= f &gt;&gt;= \\ff -&gt; g &gt;&gt;= \\gg -&gt; return (ff gg)\n= f &gt;&gt;= \\ff -&gt; g &gt;&gt;= \\gg -&gt; \\_ -&gt; ff gg\n= f &gt;&gt;= \\ff -&gt; g &gt;&gt;= \\gg _ -&gt; ff gg\n= f &gt;&gt;= \\ff -&gt; \\x -&gt; (\\gg _ -&gt; ff gg) (g x) x\n= f &gt;&gt;= \\ff -&gt; \\x -&gt; (\\_ -&gt; ff (g x)) x\n= f &gt;&gt;= \\ff -&gt; \\x -&gt; ff (g x)\n= f &gt;&gt;= \\ff x -&gt; ff (g x)\n= \\y -&gt; (\\ff x -&gt; ff (g x)) (f y) y\n= \\y -&gt; (\\x -&gt; f y (g x)) y\n= \\y -&gt; f y (g y)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 1, "creation_date": 1446354067, "post_id": 33456089, "comment_id": 54705076, "body": "It&#39;s not &quot;built-in&quot;, but <code>lens</code> has the generalized <code>flip</code> as <a href=\"https://hackage.haskell.org/package/lens-4.13/docs/Control-Lens-Lens.html#v:-63--63-\" rel=\"nofollow noreferrer\"><code>(??)</code></a>. I feel it&#39;s a bit of a hole in <code>Data.Functor</code>."}], "tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": false, "score": 9, "last_activity_date": 1446322303, "creation_date": 1446322303, "answer_id": 33456089, "question_id": 33454650, "link": "https://stackoverflow.com/questions/33454650/understanding-ap-in-a-point-free-function-in-haskell/33456089#33456089", "title": "Understanding `ap` in a point-free function in Haskell", "body": "<p>Any lambda term can be rewritten to an equivalent term that uses just a set of suitable <a href=\"https://en.wikipedia.org/wiki/Combinatory_logic\" rel=\"noreferrer\">combinators</a> and no lambda abstractions. This process is called <a href=\"https://en.wikipedia.org/wiki/Combinatory_logic#Completeness_of_the_S-K_basis\" rel=\"noreferrer\">abstraciton elimination</a>. During the process you want to remove lambda abstractions from inside out. So at one step you have <code>\u03bbx.M</code> where <code>M</code> is already free of lambda abstractions, and you want to get rid of <code>x</code>.</p>\n\n<ul>\n<li>If <code>M</code> is <code>x</code>, you replace <code>\u03bbx.x</code> with <code>id</code> (<code>id</code> is usually denoted by <code>I</code> in combinatory logic).</li>\n<li>If <code>M</code> doesn't contain <code>x</code>, you replace the term with <code>const M</code> (<code>const</code> is usually denoted by <code>K</code> in combinatory logic).</li>\n<li><p>If <code>M</code> is <code>PQ</code>, that is the term is <code>\u03bbx.PQ</code>, you want to \"push\" <code>x</code> inside both parts of the function application so that you can recursively process both parts. This is accomplished by using the <code>S</code> combinator defined as <code>\u03bbfgx.(fx)(gx)</code>, that is, it takes two functions and passes <code>x</code> to both of them, and applies the results together. You can easily verify that that <code>\u03bbx.PQ</code> is equivalent to <code>S(\u03bbx.P)(\u03bbx.Q)</code>, and we can recursively process both subterms.</p>\n\n<p>As described in the other answers, the <code>S</code> combinator is available in Haskell as <code>ap</code> (or <code>&lt;*&gt;</code>) specialized to the reader monad.</p></li>\n</ul>\n\n<p>The appearance of the reader monad isn't accidental: When solving the task of replacing <code>\u03bbx.M</code> with an equivalent function is basically lifting <code>M :: a</code> to the reader monad <code>r -&gt; a</code> (actually the reader Applicative part is enough), where <code>r</code> is the type of <code>x</code>. If we revise the process above:</p>\n\n<ul>\n<li>The only case that is actually connected with the reader monad is when <code>M</code> is <code>x</code>. Then we \"lift\" <code>x</code> to <code>id</code>, to get rid of the variable. The other cases below are just mechanical applications of lifting an expression to an applicative functor:</li>\n<li>The other case <code>\u03bbx.M</code> where <code>M</code> doesn't contain <code>x</code>, it's just lifting <code>M</code> to the reader applicative, which is <code>pure M</code>. Indeed, for <code>(-&gt;) r</code>, <code>pure</code> is equivalent to <code>const</code>.</li>\n<li>In the last case, <code>&lt;*&gt; :: f (a -&gt; b) -&gt; f a -&gt; f b</code> is function application lifted to a monad/applicative. And this is exactly what we do: We lift both parts <code>P</code> and <code>Q</code> to the reader applicative and then use <code>&lt;*&gt;</code> to bind them together.</li>\n</ul>\n\n<p>The process can be further improved by adding more combinators, which allows the resulting term to be shorter. Most often, <a href=\"https://en.wikipedia.org/wiki/Combinatory_logic#Combinators_B.2C_C\" rel=\"noreferrer\">combinators <code>B</code> and <code>C</code> are used</a>, which in Haskell correspond to functions <code>(.)</code> and <code>flip</code>. And again, <code>(.)</code> is just <code>fmap</code>/<code>&lt;$&gt;</code> for the reader applicative. (I'm not aware of such a built-in function for expressing <code>flip</code>, but it'd be viewed as a specialization of <code>f (a -&gt; b) -&gt; a -&gt; f b</code> for the reader applicative.)</p>\n\n<p><sub>Some time ago I wrote a short article about this: <a href=\"https://themonadreader.files.wordpress.com/2011/01/issue17.pdf\" rel=\"noreferrer\">The Monad Reader Issue 17</a>, The Reader Monad and Abstraction Elimination.</sub></p>\n"}], "owner": {"reputation": 3409, "user_id": 3105485, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b4c41125ff9c7b20ca07d0845e7af7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Caridorc", "link": "https://stackoverflow.com/users/3105485/caridorc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2860, "favorite_count": 5, "accepted_answer_id": 33454917, "answer_count": 2, "score": 18, "last_activity_date": 1446322303, "creation_date": 1446313609, "question_id": 33454650, "link": "https://stackoverflow.com/questions/33454650/understanding-ap-in-a-point-free-function-in-haskell", "title": "Understanding `ap` in a point-free function in Haskell", "body": "<p>I am able to understand the basics of point-free functions in Haskell:</p>\n\n<pre><code>addOne x = 1 + x\n</code></pre>\n\n<p>As we see x on both sides of the equation, we simplify it:</p>\n\n<pre><code>addOne = (+ 1)\n</code></pre>\n\n<hr>\n\n<p>Incredibly it turns out that functions where the same argument is used twice in different parts can be written point-free!</p>\n\n<p>Let me take as a basic example the <code>average</code> function written as:</p>\n\n<pre><code>average xs = realToFrac (sum xs) / genericLength xs\n</code></pre>\n\n<p>It may seem impossible to simplify <code>xs</code>, but <a href=\"http://pointfree.io/\">http://pointfree.io/</a> comes out with:</p>\n\n<pre><code>average = ap ((/) . realToFrac . sum) genericLength\n</code></pre>\n\n<p>That works.</p>\n\n<p>As far as I understand this states that <code>average</code> is the same as calling <code>ap</code> on two functions, the composition of <code>(/) . realToFrac . sum</code> and <code>genericLength</code></p>\n\n<p>Unfortunately the <code>ap</code> function makes no sense whatsoever to me, the docs <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad.html#v:ap\">http://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Monad.html#v:ap</a> state:</p>\n\n<pre><code>ap :: Monad m =&gt; m (a -&gt; b) -&gt; m a -&gt; m b\n\nIn many situations, the liftM operations can be replaced by uses of ap,\nwhich promotes function application.\n\n      return f `ap` x1 `ap` ... `ap` xn\n\nis equivalent to\n\n      liftMn f x1 x2 ... xn\n</code></pre>\n\n<p>But writing:</p>\n\n<pre><code>let average = liftM2 ((/) . realToFrac . sum) genericLength\n</code></pre>\n\n<p>does not work, (gives a very long type error message, ask and I'll include it), so I do not understand what the docs are trying to say.</p>\n\n<hr>\n\n<p>How does the expression <code>ap ((/) . realToFrac . sum) genericLength</code> work? Could you explain <code>ap</code> in simpler terms than the docs?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1446313029, "post_id": 33454454, "comment_id": 54695667, "body": "The <code>maximoYresto</code> function handles the cases <code>[]</code> and <code>[x]</code>. Can you think of any other cases of input that doesn&#39;t fall into one of these cases?"}, {"owner": {"reputation": 33, "user_id": 4707157, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/10203890572732403/picture?type=large", "display_name": "Javier Bertom&#233;u Mu&#241;oz", "link": "https://stackoverflow.com/users/4707157/javier-bertom%c3%a9u-mu%c3%b1oz"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1446313114, "post_id": 33454454, "comment_id": 54695696, "body": "@MarkSeemann i think has to be the case of a non existing maximum, for example [2,2]. Can u help with that?"}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1446313234, "post_id": 33454454, "comment_id": 54695741, "body": "What does <code>[]</code> mean? What does <code>[x]</code> mean? Can you think of other list values that don&#39;t fall into one of these patterns?"}, {"owner": {"reputation": 33, "user_id": 4707157, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/10203890572732403/picture?type=large", "display_name": "Javier Bertom&#233;u Mu&#241;oz", "link": "https://stackoverflow.com/users/4707157/javier-bertom%c3%a9u-mu%c3%b1oz"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1446313413, "post_id": 33454454, "comment_id": 54695813, "body": "@MarkSeemann i dont know another case..."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1446321856, "post_id": 33454454, "comment_id": 54698527, "body": "<code>[x]</code> matches with a list having exactly one element. If you want to match with any list just use a variable name without brackets, e.g. <code>x</code> or <code>list</code>."}, {"owner": {"reputation": 33, "user_id": 4707157, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/10203890572732403/picture?type=large", "display_name": "Javier Bertom&#233;u Mu&#241;oz", "link": "https://stackoverflow.com/users/4707157/javier-bertom%c3%a9u-mu%c3%b1oz"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1446417091, "post_id": 33454454, "comment_id": 54721613, "body": "@chi so much thanks dude, im newbie in functional programming. Thanks a lot!"}], "owner": {"reputation": 33, "user_id": 4707157, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/10203890572732403/picture?type=large", "display_name": "Javier Bertom&#233;u Mu&#241;oz", "link": "https://stackoverflow.com/users/4707157/javier-bertom%c3%a9u-mu%c3%b1oz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "closed_date": 1446312992, "answer_count": 0, "score": 0, "last_activity_date": 1446312499, "creation_date": 1446312499, "question_id": 33454454, "link": "https://stackoverflow.com/questions/33454454/non-exhaustive-patterns-in-functionlists", "closed_reason": "Duplicate", "title": "Non-exhaustive patterns in function(lists)", "body": "<p>i've write this code, that allows me to find a maximum on a list and return this maximum and the rest of the list. For example:\nmaximoYresto [1,2,3,4,2] = (4,[1,2,3,2]).</p>\n\n<p>The code is this: </p>\n\n<pre><code>maximoYresto :: Ord a =&gt; [a] -&gt; (a,[a])\nmaximoYresto [] = error \"error\"\nmaximoYresto [x] = (maximum [x], filter (\\x -&gt; x &lt; maximum [x]) [x])\n</code></pre>\n\n<p>but i get this error:</p>\n\n<p>Exception: relacion2.hs:(31,1)-(32,68): Non-exhaustive patterns in function maximoYresto.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c++", "haskell", "visual-studio-2015", "ghc", "ffi"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 3042966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e380b349f12967a80094ee42cb47355f?s=128&d=identicon&r=PG&f=1", "display_name": "user3042966", "link": "https://stackoverflow.com/users/3042966/user3042966"}, "edited": false, "score": 0, "creation_date": 1446339732, "post_id": 33454513, "comment_id": 54702995, "body": "Thanks! Hope they fix this in the next release."}, {"owner": {"reputation": 55, "user_id": 3042966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e380b349f12967a80094ee42cb47355f?s=128&d=identicon&r=PG&f=1", "display_name": "user3042966", "link": "https://stackoverflow.com/users/3042966/user3042966"}, "edited": false, "score": 0, "creation_date": 1446344722, "post_id": 33454513, "comment_id": 54703708, "body": "side question: it looks compiling and running works equally well having only the .dll present, without the .lib file, so is it necessary to include a .lib?"}, {"owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "reply_to_user": {"reputation": 55, "user_id": 3042966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e380b349f12967a80094ee42cb47355f?s=128&d=identicon&r=PG&f=1", "display_name": "user3042966", "link": "https://stackoverflow.com/users/3042966/user3042966"}, "edited": false, "score": 0, "creation_date": 1446450654, "post_id": 33454513, "comment_id": 54731166, "body": "@user3042966 basically .dll contains everything linker needs. But some linkers are not able to extract that information from .dll, so .lib exists. I don&#39;t know all the details though."}], "tags": [], "owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "is_accepted": true, "score": 2, "last_activity_date": 1446312804, "creation_date": 1446312804, "answer_id": 33454513, "question_id": 33454394, "link": "https://stackoverflow.com/questions/33454394/haskell-ghc-visual-studio-dll-weird-behaviour/33454513#33454513", "title": "Haskell ghc visual studio DLL weird behaviour", "body": "<p>Seems similar to <a href=\"https://ghc.haskell.org/trac/ghc/ticket/10885\" rel=\"nofollow\">this</a> issue. Basically, <code>ghc-7.8</code> distribution contains buggy binutils, they don't handle Visual Studio .lib files properly. The workaround is to upgrade <code>mingw</code> distribution or regenerate the .lib file. See the ticket (and also <a href=\"https://ghc.haskell.org/trac/ghc/ticket/10726\" rel=\"nofollow\">#10726</a>) for details.</p>\n"}], "owner": {"reputation": 55, "user_id": 3042966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e380b349f12967a80094ee42cb47355f?s=128&d=identicon&r=PG&f=1", "display_name": "user3042966", "link": "https://stackoverflow.com/users/3042966/user3042966"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 33454513, "answer_count": 1, "score": 2, "last_activity_date": 1446339747, "creation_date": 1446312174, "last_edit_date": 1446339747, "question_id": 33454394, "link": "https://stackoverflow.com/questions/33454394/haskell-ghc-visual-studio-dll-weird-behaviour", "title": "Haskell ghc visual studio DLL weird behaviour", "body": "<p>I am trying to call a C DLL built with visual studio (2015 community edition) from GHC (version 7.8.3) on windows.</p>\n\n<p>C code: (myDLL.cpp)</p>\n\n<pre><code>extern \"C\" {\n    __declspec(dllexport) int someFn() {\n        return 42;\n    }\n}\n</code></pre>\n\n<p>Haskell code: (Main.hs)</p>\n\n<pre><code>module Main where\n\nimport Foreign.Ptr\nimport Foreign.C.Types \nimport Data.Int\n\nforeign import ccall unsafe \"someFn\" c_someFn :: CInt\nmySomeFn = c_someFn\n\nmain :: IO ()\nmain = do let z = mySomeFn\n          print z\n</code></pre>\n\n<p>after copying the generated x64 .dll and .lib and .hs file to the same folder, and running </p>\n\n<pre><code> ghci -L. -lmyDLL Main.hs\n ...\n &gt;main\n</code></pre>\n\n<p>It prints '42' as expected.</p>\n\n<p>Running</p>\n\n<pre><code>ghc -L. -lmyDLL Main.hs\n</code></pre>\n\n<p>compiles and links fine, but after executing main.exe, no output is printed. Not even an error message. Why does this happen?</p>\n\n<p>EDIT:\nHere's what I did to fix it. Install latest Haskell Platform, then download and copy the latest copy of binutils to the mingw folder of haskell platform. (D:\\Program Files\\Haskell Platform\\7.10.2-a\\mingw for me). Next, it started complaining about zlib1.dll, so I also downloaded that from MSYS2 and pasted it in the mingw\\bin folder. After that, it worked.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 0, "creation_date": 1446311273, "post_id": 33454145, "comment_id": 54695118, "body": "Have you tried using <code>splitAt</code>? It is a function that splits lists by index, you can then transform an element and merge the result with <code>++</code>."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 4, "creation_date": 1446311851, "post_id": 33454145, "comment_id": 54695285, "body": "if you really want to operate using coordinates/index then lists are the wrong data-structure to begin with - maybe you should have a look at the <a href=\"https://hackage.haskell.org/package/vector\" rel=\"nofollow noreferrer\">vector</a> package instead"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1446311889, "post_id": 33454145, "comment_id": 54695294, "body": "Aside from this the usual question: what have you tried and where are you stuck?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1446327548, "post_id": 33454145, "comment_id": 54700231, "body": "Hint: a String is a list of Char, so if you have a function <code>updateAtPos :: Int -&gt; (a -&gt; a) -&gt; [a] -&gt; [a]</code>, then your desired function is <code>\\i j -&gt; updateAsPos i (updateAtPos j (const &#39;o&#39;))</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1189, "user_id": 348201, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1b5c1cb1e1615645078717836ffc3eaf?s=128&d=identicon&r=PG", "display_name": "somesoaccount", "link": "https://stackoverflow.com/users/348201/somesoaccount"}, "is_accepted": false, "score": 1, "last_activity_date": 1446416078, "creation_date": 1446416078, "answer_id": 33467834, "question_id": 33454145, "link": "https://stackoverflow.com/questions/33454145/how-to-change-an-element-in-string-in-haskell/33467834#33467834", "title": "How to change an element in [String] in Haskell?", "body": "<p>Seems like one of those tasks you might have to solve for online coding games. As others pointed out, lists are not really suited for dealing with coordinates like this. However, if you are not able to use better libraries (like in coding games) you will have to do some more work.</p>\n\n<p>Here is the code from my <code>ghci</code> session (transforming to a proper program is left as an exercise for the reader...):</p>\n\n<pre><code>let input =  [\"#####\", \"#_ ##\", \"#  ##\", \"#   #\", \"#  .#\", \"#####\", \"1 4\"]\nlet reverseInput = reverse input\nlet position = head reverseInput\nlet board = tail reverseInput\nlet posX = read $ takeWhile (/=' ') position :: Int\nlet posY = read $ takeWhile (/=' ') $ reverse position :: Int\nlet (unchangedBoard, changedBoard) = splitAt posY board\nlet (unchangedRow, changedRow) = splitAt posX $ head changedBoard\nlet newRow = unchangedRow ++ \"o\" ++ tail changedRow\nlet newBoard = unchangedBoard ++ [newRow] ++ tail changedBoard\nlet finalOutput = reverse newBoard\nmapM_ putStrLn finalOutput\n</code></pre>\n\n<p>Also note this code is very brittle as it uses partial functions all over the place (<code>tail</code>, <code>head</code>, <code>read</code>). You could try to use pattern matching instead to make the code more robust.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4709293"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1446416078, "creation_date": 1446310565, "question_id": 33454145, "link": "https://stackoverflow.com/questions/33454145/how-to-change-an-element-in-string-in-haskell", "title": "How to change an element in [String] in Haskell?", "body": "<p>I'm working on a program that receives as input a board game as follows:</p>\n\n<pre><code>#####\n#_ ##\n#  ##\n#   #\n#  .#\n#####\n1 4 (player initial position, marked with '_')\n</code></pre>\n\n<p>After receiving the input, the program transforms it to a [String].</p>\n\n<p>This case, it would be:\n[\"#####\", \"#_ ##\", \"#  ##\", \"#   #\", \"#  .#\", \"#####\", \"1 4\"]</p>\n\n<p>How can I access position [1,4] and transform '_' to 'o'?\nFunction must return initial list with that transformation.</p>\n\n<p><strong>Very important note: '_' is never displayed on input, I only used it to make clear where position [1,4] is (therefore, on input we only see a blank space, ' ')</strong> </p>\n"}, {"tags": ["haskell", "monads", "monad-transformers"], "comments": [{"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 3, "creation_date": 1446307916, "post_id": 33453633, "comment_id": 54694013, "body": "You can&#39;t inspect the value without running the reader since the answer depends on the value in the environment."}, {"owner": {"reputation": 3638, "user_id": 304645, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2b2cd873fa89bc5016c2b5b6d5b2a9ba?s=128&d=identicon&r=PG", "display_name": "punund", "link": "https://stackoverflow.com/users/304645/punund"}, "reply_to_user": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1446308761, "post_id": 33453633, "comment_id": 54694319, "body": "Of course not.  I was implying &quot;runReaderT inspect ...&quot; somewhere along the lines."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1446309257, "post_id": 33453633, "comment_id": 54694483, "body": "what Lee means is that you want <code>inspect :: ReaderT Char Maybe String -&gt; ReaderT Char Maybe Bool</code> - the signature you gave can basically only give back a constant (it could feed the <code>Reader</code> with it&#39;s own environment/<code>Char</code> etc.)"}], "answers": [{"tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 2, "last_activity_date": 1446313223, "creation_date": 1446313223, "answer_id": 33454591, "question_id": 33453633, "link": "https://stackoverflow.com/questions/33453633/getting-inside-a-monad-wrapped-in-transformer/33454591#33454591", "title": "Getting inside a monad wrapped in transformer", "body": "<p><a href=\"http://hackage.haskell.org/packages/archive/transformers/latest/doc/html/Control-Monad-Trans-Reader.html#v:ReaderT\" rel=\"nofollow\"><code>ReaderT</code></a> is exactly</p>\n\n<pre><code>newtype ReaderT r m a = ReaderT { runReaderT :: r -&gt; m a }\n        -- a function that reads the environment^    |\n        --                         and returns an m a^\n</code></pre>\n\n<p>For <code>ReaderT r Maybe a</code> it's a function that reads the environment and returns a <code>Maybe a</code>. You can make a function that  reads the environment and checks if the result is <code>Nothing</code> by composing this function with another function that checks whether the result is <code>Nothing</code>. To check whether a <code>Maybe a</code> is nothing, we can use <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-Maybe.html#v:isJust\" rel=\"nofollow\"><code>isJust</code></a>, and to pack the resulting <code>Bool</code> back into a <code>Maybe Bool</code> we'd use <code>return</code>.</p>\n\n<pre><code>inspect :: ReaderT r Maybe a -&gt; ReaderT r Maybe Bool\ninspect (ReaderT f) = ReaderT $ return . isJust . f\n</code></pre>\n\n<p>transformers provides a function, <a href=\"http://hackage.haskell.org/packages/archive/transformers/latest/doc/html/Control-Monad-Trans-Reader.html#v:mapReaderT\" rel=\"nofollow\"><code>mapReaderT</code></a> that lets us manipulate the computation inside a <code>ReaderT</code></p>\n\n<pre><code>mapReaderT :: (m a -&gt; n b) -&gt; ReaderT r m a -&gt; ReaderT r n b\nmapReaderT f m = ReaderT $ f . runReaderT m\n</code></pre>\n\n<p><code>mapReaderT</code> just composes the function provided as its first argument with the function inside the <code>ReaderT</code> (<code>runReaderT</code> unwraps the function inside a <code>ReaderT</code>). You can use <code>mapReaderT</code> to write <code>inspect</code> more elegantly.</p>\n\n<pre><code>inspect :: ReaderT r Maybe a -&gt; ReaderT r Maybe Bool\ninspect = mapReaderT (return . isJust)\n</code></pre>\n"}], "owner": {"reputation": 3638, "user_id": 304645, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/2b2cd873fa89bc5016c2b5b6d5b2a9ba?s=128&d=identicon&r=PG", "display_name": "punund", "link": "https://stackoverflow.com/users/304645/punund"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 1, "accepted_answer_id": 33454591, "answer_count": 1, "score": 0, "last_activity_date": 1446313223, "creation_date": 1446307571, "last_edit_date": 1446309625, "question_id": 33453633, "link": "https://stackoverflow.com/questions/33453633/getting-inside-a-monad-wrapped-in-transformer", "title": "Getting inside a monad wrapped in transformer", "body": "<p>This is a contrieved example using Reader Transformer:</p>\n\n<pre><code>{-# LANGUAGE UnicodeSyntax #-}\n\nimport Control.Monad.Reader\nimport Data.Char\n\nconv \u2237 Int \u2192 ReaderT Char Maybe String\nconv n = do\n   yn \u2190 ask\n   if yn == 'y'\n      then return $ chr n : \" with Yes\"\n      else lift Nothing\n\n-- runReaderT (conv 98) 'y'      Just \"b with Yes\"\n-- runReaderT (conv 98) '@'      Nothing\n\ninspect \u2237 ReaderT Char Maybe String \u2192 Bool\n</code></pre>\n\n<p>-- EDITED: as per suggestions, the correct type is monadic:</p>\n\n<pre><code>inspect \u2237 ReaderT Char Maybe String \u2192 ReaderT Char Maybe Bool\n</code></pre>\n\n<p><code>inspect</code> is supposed to check whether the value inside is Nothing. Can it be done, or I am having \"design issues\"?</p>\n"}, {"tags": ["haskell", "dom", "webkit"], "answers": [{"tags": [], "owner": {"reputation": 201, "user_id": 646971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba927d0a4f46c8b811b3f0e53bcb6ac6?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/646971/dmitry"}, "is_accepted": false, "score": 2, "last_activity_date": 1446412662, "creation_date": 1446412662, "answer_id": 33467326, "question_id": 33452802, "link": "https://stackoverflow.com/questions/33452802/how-to-handle-dom-events-using-haskell-with-webkitgtk3/33467326#33467326", "title": "How to handle DOM events using Haskell with webkitgtk(3)", "body": "<p>OK, here is what I found out myself, maybe this example also helps somebody else.</p>\n\n<p><a href=\"https://gist.github.com/dmgolubovsky/72803f4f9f179bd5b93b\" rel=\"nofollow\">https://gist.github.com/dmgolubovsky/72803f4f9f179bd5b93b</a></p>\n"}], "owner": {"reputation": 201, "user_id": 646971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba927d0a4f46c8b811b3f0e53bcb6ac6?s=128&d=identicon&r=PG", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/646971/dmitry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1446412662, "creation_date": 1446302439, "question_id": 33452802, "link": "https://stackoverflow.com/questions/33452802/how-to-handle-dom-events-using-haskell-with-webkitgtk3", "title": "How to handle DOM events using Haskell with webkitgtk(3)", "body": "<p>Is it possible in principle to handle DOM events (that normally are handled with Javascript) in Haskell using the webkitgtk3? I see examples how to handle Gtk events (using <code>on</code>), but DOM events have different type signatures, and don't work with <code>on</code>.</p>\n\n<p>I see there is a function addEventListener </p>\n\n<p><a href=\"https://hackage.haskell.org/package/webkitgtk3-0.14.1.0/docs/Graphics-UI-Gtk-WebKit-DOM-EventTarget.html#v:addEventListener\" rel=\"nofollow\">addEventListener</a></p>\n\n<p>but I cannot find any examples of its use to call a handler written in Haskell. Ideally it would be to make webkit to translate a DOM event into Gtk event.</p>\n\n<p>Any ideas appreciated.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["haskell", "constructor", "return"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1446302545, "post_id": 33452753, "comment_id": 54692313, "body": "It looks like you need to distinguish <code>Point2D</code>and <code>Point3D</code> at the type level, so you can give them different <code>Num</code> instances."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1446304782, "post_id": 33452753, "comment_id": 54692983, "body": "Hint? No.  Fact? Yes.  You need different types for the two points if you want fromInteger to automatically translate literals to one of two forms.  Another type has more benefits than this - your abuse of <code>Point</code> for both two and three dimensions is really hackish and means that operations like <code>+</code> are partial.  For example <code>Point2D x y + Point3D a b c</code> will fail with an incomplete pattern match."}, {"owner": {"reputation": 93, "user_id": 4933818, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-b6oiPap26WI/AAAAAAAAAAI/AAAAAAAAG_E/ZaiNkiTHCCs/photo.jpg?sz=128", "display_name": "Yann Rolland", "link": "https://stackoverflow.com/users/4933818/yann-rolland"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1446306133, "post_id": 33452753, "comment_id": 54693396, "body": "@user2407038 and M. DuBuisson :  Thank you for your answers, this make sense ! I will post the working version soon."}, {"owner": {"reputation": 20968, "user_id": 2564301, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a6b5734cdcb5ce19598ccf9a7d8cc1ff?s=128&d=identicon&r=PG&f=1", "display_name": "Jongware", "link": "https://stackoverflow.com/users/2564301/jongware"}, "edited": false, "score": 0, "creation_date": 1446398409, "post_id": 33452753, "comment_id": 54715425, "body": "Can you remove the solution out of your question and submit it as a proper answer? (Slightly related to Meta question <a href=\"http://meta.stackoverflow.com/q/309266/2564301\">meta.stackoverflow.com/q/309266/2564301</a>)"}, {"owner": {"reputation": 93, "user_id": 4933818, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-b6oiPap26WI/AAAAAAAAAAI/AAAAAAAAG_E/ZaiNkiTHCCs/photo.jpg?sz=128", "display_name": "Yann Rolland", "link": "https://stackoverflow.com/users/4933818/yann-rolland"}, "edited": false, "score": 0, "creation_date": 1447176904, "post_id": 33452753, "comment_id": 55046061, "body": "Yes, thank you for your &quot;meta-feedback&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 2, "last_activity_date": 1446306017, "creation_date": 1446306017, "answer_id": 33453390, "question_id": 33452753, "link": "https://stackoverflow.com/questions/33452753/haskell-frominteger-with-multiple-data-constructors/33453390#33453390", "title": "haskell fromInteger with multiple data constructors", "body": "<p>You want to make <code>Point2D</code> and <code>Point3D</code> be different types, not different constructors for the same type.</p>\n\n<p>Start with this and fill out the definitions:</p>\n\n<pre><code>data Point2D = Point2D Float Float\ndata Point3D = Point3D Float Float Float\n\ninstance Num Point2D where\n    fromInteger = ...\n    (+) = ...\n\ninstance Num Point3D where\n    fromInteger = ...\n    (+) = ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 93, "user_id": 4933818, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-b6oiPap26WI/AAAAAAAAAAI/AAAAAAAAG_E/ZaiNkiTHCCs/photo.jpg?sz=128", "display_name": "Yann Rolland", "link": "https://stackoverflow.com/users/4933818/yann-rolland"}, "is_accepted": true, "score": 0, "last_activity_date": 1447176952, "creation_date": 1447176952, "answer_id": 33636108, "question_id": 33452753, "link": "https://stackoverflow.com/questions/33452753/haskell-frominteger-with-multiple-data-constructors/33636108#33636108", "title": "haskell fromInteger with multiple data constructors", "body": "<p>Here is one solution :</p>\n\n<pre><code>class Point a where\n    add :: a -&gt; a -&gt; a\n    fromIntegerP :: Integer -&gt; a\n\ndata Point2D = Point2D Float Float deriving Show\ndata Point3D = Point3D Float Float Float deriving Show\n\ninstance Point Point2D where\n    add (Point2D xa ya) (Point2D xb yb) = Point2D (xa+xb) (ya+yb)\n    fromIntegerP v = Point2D (fromIntegral v) 0\n\ninstance Point Point3D where    \n    add (Point3D xa ya za) (Point3D xb yb zb) = Point3D (xa+xb) (ya+yb) (za+zb)\n    fromIntegerP v = Point3D (fromIntegral v) 0 0\n\ninstance Num Point2D where\n    (+) = add\n    fromInteger = fromIntegerP\n\ninstance Num Point3D where\n    (+) = add\n    fromInteger = fromIntegerP\n\np2D1 = Point2D 1.0 2.0\np2D2 = Point2D 4.0 5.0\n\np3D1 = Point3D 1.0 2.0 3.0\np3D2 = Point3D 6.0 6.0 6.0\n\nmain = do\n    putStrLn . show $ sum [p2D1,p2D2]\n    putStrLn . show $ sum [p3D1,p3D2]\n</code></pre>\n\n<p>I am still looking for improvements (<code>instance Num Point2D where</code> and <code>instance Num Point3D where</code>) but it works !</p>\n"}], "owner": {"reputation": 93, "user_id": 4933818, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-b6oiPap26WI/AAAAAAAAAAI/AAAAAAAAG_E/ZaiNkiTHCCs/photo.jpg?sz=128", "display_name": "Yann Rolland", "link": "https://stackoverflow.com/users/4933818/yann-rolland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 33636108, "answer_count": 2, "score": 2, "last_activity_date": 1447176952, "creation_date": 1446302153, "last_edit_date": 1447176933, "question_id": 33452753, "link": "https://stackoverflow.com/questions/33452753/haskell-frominteger-with-multiple-data-constructors", "title": "haskell fromInteger with multiple data constructors", "body": "<p>I am looking for a solution that is quite generic I think. My goal is to find a clean way to do operations on Points (coordinates), either in 2D or 3D. my data Point is an instance of Num that gives functions to do basics maths operations.</p>\n\n<pre><code>data Point = Point2D Float Float\n       |\u00a0Point3D Float Float Float deriving Show\n\nadd :: Point -&gt; Point -&gt; Point\nadd (Point2D xa ya) (Point2D xb yb) = Point2D (xa+xb) (ya+yb)\nadd (Point3D xa ya za) (Point3D xb yb zb) = Point3D (xa+xb) (ya+yb) (za+zb)\n\ndivT (Point2D x y) v = Point2D (x / v) (y / v)\ndivT (Point3D x y z) v = Point3D (x / v) (y / v) (z / v)\n\nfromIntegerP :: Integer -&gt; Point\nfromIntegerP v = Point2D (fromIntegral v) 0\n--fromIntegerP v = Point3D (fromIntegral v) 0 0\n\ninstance Num Point where\n    (+) = add\n    fromInteger = fromIntegerP\n\np2D1 = Point2D 1.0 2.0\np2D2 = Point2D 4.0 5.0\np3D1 = Point3D 1.0 2.0 3.0\np3D2 = Point3D 6.0 6.0 6.0\n\nmain = do\n    putStrLn . show $ sum [p2D1,p2D2]\n    putStrLn . show $ sum [p3D1,p3D2]\n</code></pre>\n\n<p>This code outputs :</p>\n\n<pre><code>Point2D 5.0 7.0\n*** Exception: pointStackoverflow.hs:(5,1)-(6,75): Non-exhaustive patterns in function add\n</code></pre>\n\n<p>... because every Point.fromInteger produces a Point2D, even if we expect a Point3D. I would like to have a way to say in \"instance Num Point\" that if a Point2D is needed then fromInteger is fromIntegerToPoint2D else fromIntegerToPoint3D. But I don't know how to make a choice based on the return type.</p>\n\n<p>Any hint ? Thank you</p>\n"}, {"tags": ["macos", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 638, "user_id": 2157783, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/oNT4Q.jpg?s=128&g=1", "display_name": "MadHatter", "link": "https://stackoverflow.com/users/2157783/madhatter"}, "edited": false, "score": 0, "creation_date": 1446300395, "post_id": 33452478, "comment_id": 54691635, "body": "May I ask what <code>stack</code> is?"}, {"owner": {"reputation": 638, "user_id": 2157783, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/oNT4Q.jpg?s=128&g=1", "display_name": "MadHatter", "link": "https://stackoverflow.com/users/2157783/madhatter"}, "edited": false, "score": 0, "creation_date": 1446300545, "post_id": 33452478, "comment_id": 54691690, "body": "Furthermore, what are the advantages and disadvantages, respectively, of the two distributions?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 638, "user_id": 2157783, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/oNT4Q.jpg?s=128&g=1", "display_name": "MadHatter", "link": "https://stackoverflow.com/users/2157783/madhatter"}, "edited": false, "score": 0, "creation_date": 1446300797, "post_id": 33452478, "comment_id": 54691773, "body": "<code>stack</code> is a tool to help you manage dependencies and generate reproducible builds. More info <a href=\"https://github.com/commercialhaskell/stack/blob/release/doc/GUIDE.md\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://github.com/commercialhaskell/stack\" rel=\"nofollow noreferrer\">here</a>. It serves somewhat the same function as <code>cabal</code>. In place of <code>cabal install ...</code> and <code>ghci</code> you generally can use <code>stack install ... </code> and <code>stack ghci</code>."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 638, "user_id": 2157783, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/oNT4Q.jpg?s=128&g=1", "display_name": "MadHatter", "link": "https://stackoverflow.com/users/2157783/madhatter"}, "edited": false, "score": 0, "creation_date": 1446301082, "post_id": 33452478, "comment_id": 54691866, "body": "It&#39;s not an either-or proposition. You can always download <code>stack</code> after installing the Haskell Platform. If you are a total beginner I think you&#39;ll find starting with the Haskell Platform easier - most tutorials and examples are written with the HP in mind. Once you gain more familiarity with cabal projects or if you start running into dependency issues you can switch over to <code>stack</code>."}, {"owner": {"reputation": 638, "user_id": 2157783, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/oNT4Q.jpg?s=128&g=1", "display_name": "MadHatter", "link": "https://stackoverflow.com/users/2157783/madhatter"}, "edited": false, "score": 0, "creation_date": 1446301097, "post_id": 33452478, "comment_id": 54691868, "body": "Mmhh.. It seems that the official Haskell platform is the safe way.. I&#39;m installing it for a Languages &amp; Compilers university class, so probably I&#39;ll need stuff like <code>happy</code> and <code>alex</code>. Do you see any disadvantage about installing in <code>\\usr\\loca\\bin</code>? May it mess with something?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 638, "user_id": 2157783, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/oNT4Q.jpg?s=128&g=1", "display_name": "MadHatter", "link": "https://stackoverflow.com/users/2157783/madhatter"}, "edited": false, "score": 0, "creation_date": 1446301244, "post_id": 33452478, "comment_id": 54691917, "body": "/usr/local/bin is the standard location for user-installed Unix programs."}, {"owner": {"reputation": 638, "user_id": 2157783, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/oNT4Q.jpg?s=128&g=1", "display_name": "MadHatter", "link": "https://stackoverflow.com/users/2157783/madhatter"}, "edited": false, "score": 0, "creation_date": 1446301994, "post_id": 33452478, "comment_id": 54692140, "body": "Mmhh, it seems all file have been installed in <code>\\Library</code>, and executables just symlinked in <code>\\usr\\bin</code> (not <code>\\usr\\local\\bin</code>). I guess all this is OK, however.."}, {"owner": {"reputation": 638, "user_id": 2157783, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/oNT4Q.jpg?s=128&g=1", "display_name": "MadHatter", "link": "https://stackoverflow.com/users/2157783/madhatter"}, "edited": false, "score": 0, "creation_date": 1446302738, "post_id": 33452478, "comment_id": 54692378, "body": "Something went awry. According to documentation, I should have the <code>ghc</code> command ready (due to symlinks). It is not so.."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 638, "user_id": 2157783, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/oNT4Q.jpg?s=128&g=1", "display_name": "MadHatter", "link": "https://stackoverflow.com/users/2157783/madhatter"}, "edited": false, "score": 0, "creation_date": 1446305266, "post_id": 33452478, "comment_id": 54693113, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/93877/discussion-between-erikr-and-madhatter\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 1, "last_activity_date": 1446300262, "creation_date": 1446300262, "answer_id": 33452478, "question_id": 33452396, "link": "https://stackoverflow.com/questions/33452396/haskell-for-mac-el-capitan/33452478#33452478", "title": "Haskell for Mac (El Capitan)", "body": "<p>The main differences I see are:</p>\n\n<p>Haskell for Mac OSX:</p>\n\n<ul>\n<li>is relocatable</li>\n<li>comes with <code>stack</code> pre-built</li>\n</ul>\n\n<p>Haskell Platform:</p>\n\n<ul>\n<li>installs in /usr/local/bin (requires root access)</li>\n<li>comes with more pre-compiled libraries</li>\n<li>comes with the programs <code>happy</code> and <code>alex</code> pre-built</li>\n</ul>\n\n<p>Neither comes with explicit support for using Xcode as an IDE. Usually one uses Emacs or Atom or Vi to develop Haskell programs.</p>\n"}], "owner": {"reputation": 638, "user_id": 2157783, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/oNT4Q.jpg?s=128&g=1", "display_name": "MadHatter", "link": "https://stackoverflow.com/users/2157783/madhatter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 330, "favorite_count": 0, "accepted_answer_id": 33452478, "answer_count": 1, "score": 0, "last_activity_date": 1446300262, "creation_date": 1446299655, "question_id": 33452396, "link": "https://stackoverflow.com/questions/33452396/haskell-for-mac-el-capitan", "title": "Haskell for Mac (El Capitan)", "body": "<p>I'm trying to decide what haskell installation is more appropriate for a Mac running El Capitan.</p>\n\n<p>It seems there are at least two alternatives:</p>\n\n<ul>\n<li><p>Install the haskell platform as indicated in <a href=\"https://www.haskell.org/platform/\" rel=\"nofollow\">https://www.haskell.org/platform/</a></p></li>\n<li><p>Install the haskell platform as indicated in <a href=\"https://ghcformacosx.github.io/\" rel=\"nofollow\">https://ghcformacosx.github.io/</a></p></li>\n</ul>\n\n<p>What is the difference between the two distributions?</p>\n\n<p>Will I be able to use Xcode as an Haskell IDE?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 3485, "user_id": 1483503, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/652348761699d4193e073409caa287d6?s=128&d=identicon&r=PG", "display_name": "mljrg", "link": "https://stackoverflow.com/users/1483503/mljrg"}, "edited": false, "score": 0, "creation_date": 1446299769, "post_id": 33452378, "comment_id": 54691396, "body": "Isn&#39;t there some obscure GHC API for doing this?"}, {"owner": {"reputation": 3485, "user_id": 1483503, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/652348761699d4193e073409caa287d6?s=128&d=identicon&r=PG", "display_name": "mljrg", "link": "https://stackoverflow.com/users/1483503/mljrg"}, "edited": false, "score": 0, "creation_date": 1446300114, "post_id": 33452378, "comment_id": 54691519, "body": "In this case, GHC could replace <code>f</code> with its new version, if this had the same type signature. I really do not understand why this is so difficult ..."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1446312236, "post_id": 33452378, "comment_id": 54695406, "body": "It should, I think, be possible to do this by actually missing the binding, as long as the module is interpreted and not compiled. The big challenge: any time this is done, the type checker will need to be run to make sure everything is okay. That said, the practical answer is to run <code>stack ghci</code> or <code>cabal repl</code> within an environment like emacs that makes rapid development convenient."}, {"owner": {"reputation": 3485, "user_id": 1483503, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/652348761699d4193e073409caa287d6?s=128&d=identicon&r=PG", "display_name": "mljrg", "link": "https://stackoverflow.com/users/1483503/mljrg"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1446374209, "post_id": 33452378, "comment_id": 54708535, "body": "@dfeuer I am a newbie in Haskell, so right now it is not clear how can I do what you suggest. Do you have time for a comprehensive answer with an example, a newbie friendly? Thank you for your response."}], "tags": [], "owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "is_accepted": true, "score": 2, "last_activity_date": 1446299591, "creation_date": 1446299591, "answer_id": 33452378, "question_id": 33452244, "link": "https://stackoverflow.com/questions/33452244/ghci-load-a-file-and-redefine-one-of-its-functions-in-the-repl/33452378#33452378", "title": "GHCi load a file and redefine one of its functions in the repl", "body": "<p><strong>You can't</strong>.</p>\n\n<p>When loading the file in the repl it's as if the definitions were in a separate module and thus <code>g</code> will not look for the <code>f</code> you define at the repl, even if from your point of view your definition hides the original <code>f</code> function.</p>\n\n<hr>\n\n<p>Haskell uses <em>lexical scoping</em>, while what you suggest is a <em>dynamic scoping</em> feature. See <a href=\"https://en.wikipedia.org/wiki/Scope_%28computer_science%29#Lexical_scope_vs._dynamic_scope\" rel=\"nofollow\">lexical scoping vs dynamic scoping</a>.\nIt's completely impractical to modify the repl to compile code using lexical scoping and then allow people to modify it by using dynamic scoping. Hence it's not done and what you ask is impossible.</p>\n"}], "owner": {"reputation": 3485, "user_id": 1483503, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/652348761699d4193e073409caa287d6?s=128&d=identicon&r=PG", "display_name": "mljrg", "link": "https://stackoverflow.com/users/1483503/mljrg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 33452378, "answer_count": 1, "score": 1, "last_activity_date": 1446299591, "creation_date": 1446298715, "question_id": 33452244, "link": "https://stackoverflow.com/questions/33452244/ghci-load-a-file-and-redefine-one-of-its-functions-in-the-repl", "title": "GHCi load a file and redefine one of its functions in the repl", "body": "<p>Imagine I load a file (not a module) in GHCi like this</p>\n\n<pre><code>:l file.hs\n</code></pre>\n\n<p>and that inside the file there are two functions <code>f</code> and <code>g</code>, and that <code>f</code> has some bug (e.g., bad result) and that <code>g</code> calls <code>f</code>.</p>\n\n<p>How can I redefine <code>f</code> with a correct version at the GHCi REPL, and make <code>g</code> call the new version without having to change or reload the file?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell", "exception", "quickcheck"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1446295699, "post_id": 33451293, "comment_id": 54690168, "body": "I guess you are talking about <code>Control.Exception</code> right? In this case the obvious thing would be to go with <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Exception-Base.html#v:catch\" rel=\"nofollow noreferrer\"><code>catch</code></a> and <a href=\"https://hackage.haskell.org/package/QuickCheck-2.8.1/docs/Test-QuickCheck-Property.html#t:ioProperty\" rel=\"nofollow noreferrer\"><code>ioProperty</code></a> (for quickCheck)"}, {"owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1446298407, "post_id": 33451293, "comment_id": 54690999, "body": "@Carsten, good, <code>catch</code> or <code>try</code> combined with <code>ioProperty</code> should do the trick."}], "answers": [{"tags": [], "owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "is_accepted": true, "score": 1, "last_activity_date": 1446397107, "creation_date": 1446397107, "answer_id": 33464701, "question_id": 33451293, "link": "https://stackoverflow.com/questions/33451293/is-it-possible-to-check-cases-when-exception-is-thrown-with-quickcheck/33464701#33464701", "title": "Is it possible to check cases when exception is thrown with QuickCheck?", "body": "<p>Indeed <a href=\"https://hackage.haskell.org/package/QuickCheck-2.8.1/docs/Test-QuickCheck-Property.html#v:ioProperty\" rel=\"nofollow\"><code>ioProperty</code></a> is the key to this sort of test. You will need to use it in combination with <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Exception-Base.html#v:catch\" rel=\"nofollow\"><code>catch</code></a> or <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Exception-Base.html#v:try\" rel=\"nofollow\"><code>try</code></a>. Here I show the latter:</p>\n\n<pre><code>prop_exceptional :: Int -&gt; Property\nprop_exceptional n = ioProperty $ do\n  result &lt;- try . evaluate $ myDangerousFunction n\n  return $ r === result\n  where r | n == 0    = Left  MyException\n          | otherwise = Right 42\n</code></pre>\n\n<p>Quite obviously, <code>myDangerousFunction</code> should throw <code>MyException</code> whenever it gets <code>0</code> and return <code>42</code> otherwise. Note the useful function <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Exception-Base.html#v:evaluate\" rel=\"nofollow\"><code>evaluate</code></a>, which you need to use to evaluate pure function in <code>IO</code> context to catch exceptions produced there.</p>\n"}], "owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 0, "accepted_answer_id": 33464701, "answer_count": 1, "score": 5, "last_activity_date": 1446397107, "creation_date": 1446292768, "last_edit_date": 1446293430, "question_id": 33451293, "link": "https://stackoverflow.com/questions/33451293/is-it-possible-to-check-cases-when-exception-is-thrown-with-quickcheck", "title": "Is it possible to check cases when exception is thrown with QuickCheck?", "body": "<p>Suppose I have a function that should calculate some value in one case and\nthrow an exception otherwise. I would like to use QuickCheck to ensure my\nfunction behaves correctly, however is not obvious how to perform this sort\nof check. Is it possible and if yes, how to check that exception of certain\ntype is thrown and it contains correct information about its cause?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 6, "creation_date": 1446262162, "post_id": 33447742, "comment_id": 54683454, "body": "Monomorphism restriction? Try <code>{-# LANGUAGE NoMonomorphismRestriciton #-}</code>"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 4, "creation_date": 1446262551, "post_id": 33447742, "comment_id": 54683518, "body": "Could also just add the desired type explicitly.  Always use explicit type signatures on your top level declarations!"}, {"owner": {"reputation": 658, "user_id": 3810038, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gGQN3.png?s=128&g=1", "display_name": "John Red", "link": "https://stackoverflow.com/users/3810038/john-red"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1446265269, "post_id": 33447742, "comment_id": 54683932, "body": "@user2407038 Yes, that solved it. Thanks!"}, {"owner": {"reputation": 658, "user_id": 3810038, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gGQN3.png?s=128&g=1", "display_name": "John Red", "link": "https://stackoverflow.com/users/3810038/john-red"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1446265346, "post_id": 33447742, "comment_id": 54683942, "body": "@ThomasM.DuBuisson What do you mean by &#39;add the desired type explicitly&#39;? I am sorry but I did not get it."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1446265379, "post_id": 33447742, "comment_id": 54683946, "body": "@RedJohn e.g. add <code>string1 :: IsString a =&gt; a</code> (or <code>string1 :: Text</code> or whatever) to your file."}], "answers": [{"tags": [], "owner": {"reputation": 658, "user_id": 3810038, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gGQN3.png?s=128&g=1", "display_name": "John Red", "link": "https://stackoverflow.com/users/3810038/john-red"}, "is_accepted": true, "score": 4, "last_activity_date": 1446265960, "last_edit_date": 1495541038, "creation_date": 1446265960, "answer_id": 33448072, "question_id": 33447742, "link": "https://stackoverflow.com/questions/33447742/why-cant-i-get-overloaded-strings/33448072#33448072", "title": "Why can&#39;t I get overloaded strings?", "body": "<p>This answer in based on <a href=\"https://stackoverflow.com/users/2407038/user2407038\">user2407038</a>'s comment.<br>\nIt turns out that adding <code>{-# LANGUAGE NoMonomorphismRestriciton #-}</code> to the code solves the problem. But I wouldn't recommend it. Read <a href=\"https://wiki.haskell.org/Monomorphism_restriction\" rel=\"nofollow noreferrer\">Monomorphism Restriction</a>.  </p>\n\n<p>But as it turns out, you don't have to do it. GHC does its Monomorphism thing and sets the type of <code>string1</code> to <code>String</code>, but only because it thought that you didn't want it to be anything else. But the <code>OverloadedStrings</code> extension is still in effect! You'll notice that if you do something like  </p>\n\n<p><code>string1 = \"Darth Vader\"::ByteString</code>  </p>\n\n<p>GHC will be more that happy to make your <code>string1</code> variable a <code>ByteString</code>.  </p>\n\n<p>One more thing I noticed in Haskell's Monomorphism Restriction Wiki page, is:  </p>\n\n<blockquote>\n  <p>The restriction is turned on by default in compiled modules, and\n  turned off by default at the GHCi prompt (since GHC 7.8.1).</p>\n</blockquote>\n"}], "owner": {"reputation": 658, "user_id": 3810038, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gGQN3.png?s=128&g=1", "display_name": "John Red", "link": "https://stackoverflow.com/users/3810038/john-red"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 0, "accepted_answer_id": 33448072, "answer_count": 1, "score": 2, "last_activity_date": 1446265960, "creation_date": 1446261981, "question_id": 33447742, "link": "https://stackoverflow.com/questions/33447742/why-cant-i-get-overloaded-strings", "title": "Why can&#39;t I get overloaded strings?", "body": "<p>This is the code I have in my file <code>Temp.hs</code> :</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nmodule Temp where\n\nimport Data.String\n\nstring1 = \"Darth Vader\"\nstring2 = \"Obi-Wan Kenobi\"  \n</code></pre>\n\n<p>The problem is that I want Overloaded Strings. From what I understand, overloaded strings are polymorphic, belonging to the typeclass <code>IsString</code>. So when load the above file in GHC and do  </p>\n\n<p><code>:t string1</code>,  </p>\n\n<p>I should get  </p>\n\n<p><code>string1 :: Data.String.IsString a =&gt; a</code>  </p>\n\n<p>But what I get is:  </p>\n\n<p><code>string1 :: String</code>  </p>\n\n<p>Help!</p>\n"}, {"tags": ["haskell", "yesod"], "answers": [{"comments": [{"owner": {"reputation": 590, "user_id": 3029543, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100004855955180/picture?type=large", "display_name": "ptkato", "link": "https://stackoverflow.com/users/3029543/ptkato"}, "edited": false, "score": 0, "creation_date": 1446750002, "post_id": 33447592, "comment_id": 54884763, "body": "I guess the creation of an instance for <code>PersistFieldSql</code> to <code>FileInfo</code> will be needed. Am I right?"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 4, "last_activity_date": 1446260126, "creation_date": 1446260126, "answer_id": 33447592, "question_id": 33447470, "link": "https://stackoverflow.com/questions/33447470/type-mismatch-between-fileinfo-and-text/33447592#33447592", "title": "Type mismatch between FileInfo and Text", "body": "<p>I'm sure the Yesod API has changed since the example was written.</p>\n\n<p>The problem is that your <code>filename</code> field for the <code>Image</code> type is a <code>Filename</code>, but <code>fileAFormReq</code> now returns a <code>FileInfo</code> <a href=\"http://hackage.haskell.org/package/yesod-form-1.4.5/docs/Yesod-Form-Fields.html#v:fileAFormReq\" rel=\"nofollow\">(docs)</a>.</p>\n\n<p>Try changing the definition of <code>Image</code> to:</p>\n\n<pre><code>Image\n    fileinfo FileInfo\n    description Textarea\n    date UTCTime\n    deriving Show\n</code></pre>\n\n<p>A <code>FileInfo</code> value has this structure <a href=\"http://hackage.haskell.org/package/yesod-core-1.4.15.1/docs/Yesod-Core-Types.html#t:FileInfo\" rel=\"nofollow\">(docs)</a>:</p>\n\n<pre><code>FileInfo     \n  fileName :: !Text\n  fileContentType :: !Text\n  fileSourceRaw :: !(Source (ResourceT IO) ByteString)\n  fileMove :: !(FilePath -&gt; IO ())\n</code></pre>\n\n<p>so use the <code>fileName</code> accessor to get at the file name of a <code>FileInfo</code>.</p>\n"}], "owner": {"reputation": 590, "user_id": 3029543, "user_type": "registered", "accept_rate": 80, "profile_image": "https://graph.facebook.com/100004855955180/picture?type=large", "display_name": "ptkato", "link": "https://stackoverflow.com/users/3029543/ptkato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1446749537, "creation_date": 1446258641, "last_edit_date": 1446749537, "question_id": 33447470, "link": "https://stackoverflow.com/questions/33447470/type-mismatch-between-fileinfo-and-text", "title": "Type mismatch between FileInfo and Text", "body": "<p>I'm following <a href=\"https://github.com/yesodweb/yesod/wiki/Cookbook-file-upload-saving-files-to-server\" rel=\"nofollow\">this tutorial</a> and got a type mismatch error while creating the function who builds the form.</p>\n\n<p>I don't know what import I should post here, so there's all:</p>\n\n<pre><code>import Control.Applicative\nimport Data.Text (Text, unpack)\nimport qualified Data.Text as T\nimport qualified Data.ByteString.Lazy as DBL\nimport Data.Conduit\nimport Data.Conduit.List (consume)\nimport Yesod\nimport Yesod.Static\nimport Yesod.Form.Bootstrap3\nimport Data.Time (UTCTime, getCurrentTime)\nimport Control.Monad.Logger (runStdoutLoggingT)\nimport Database.Persist\nimport Database.Persist.Sqlite\nimport System.FilePath\nimport System.Directory (removeFile, doesFileExist)\n</code></pre>\n\n<p>And the code:</p>\n\n<pre><code>data Page = Page\n\nshare [mkPersist sqlSettings, mkMigrate \"migrateAll\"] [persistLowerCase|\n    Image\n        filename Text\n        description Textarea\n        date UTCTime\n        deriving Show\n|]\n\ninstance Yesod Page where\ntype Form a = Html -&gt; MForm Handler (FormResult a, Widget)\n\nuploadForm :: Form Image\nuploadForm = renderDivs $ Image\n    &lt;$&gt; fileAFormReq (bfs (\"Image\" :: Text)) -- error line\n    &lt;*&gt; areq textareaField (bfs (\"Description\" :: Text)) Nothing\n    &lt;*&gt; lift (liftIO getCurrentTime)\n</code></pre>\n\n<blockquote>\n  <p>Couldn't match type <code>FileInfo</code> with <code>Text</code><br>\n  -- Expected type: AForm Handler Text<br>\n  ------ Actual type: AForm Handler FileInfo \u2026</p>\n</blockquote>\n\n<p>I really don't think there's, actually, an error within the Yesod's wiki on GitHub, I guess it's in the code of mine, but I couldn't figure it out.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 3485, "user_id": 1483503, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/652348761699d4193e073409caa287d6?s=128&d=identicon&r=PG", "display_name": "mljrg", "link": "https://stackoverflow.com/users/1483503/mljrg"}, "edited": false, "score": 0, "creation_date": 1446260734, "post_id": 33447517, "comment_id": 54683248, "body": "That code works, but at the end we need to do <code>waitForProcess ph</code>, otherwise there will be process entries like <code>(ghc)</code> in the <code>$ ps</code> process list. Do you know why is <code>waitForProcess ph</code> needed to cleanup these <code>(ghc)</code> entries? What do they mean?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 3485, "user_id": 1483503, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/652348761699d4193e073409caa287d6?s=128&d=identicon&r=PG", "display_name": "mljrg", "link": "https://stackoverflow.com/users/1483503/mljrg"}, "edited": false, "score": 1, "creation_date": 1446264275, "post_id": 33447517, "comment_id": 54683773, "body": "The operating system keeps track of the process until the parent does a <code>wait</code> call. Look up <a href=\"https://en.wikipedia.org/wiki/Zombie_process\" rel=\"nofollow noreferrer\">zombie processes</a>  for more details."}, {"owner": {"reputation": 3485, "user_id": 1483503, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/652348761699d4193e073409caa287d6?s=128&d=identicon&r=PG", "display_name": "mljrg", "link": "https://stackoverflow.com/users/1483503/mljrg"}, "edited": false, "score": 0, "creation_date": 1446288780, "post_id": 33447517, "comment_id": 54688384, "body": "One more question: do I need to close the input and output handles before killing the process or this is done automatically by the OS?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 3485, "user_id": 1483503, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/652348761699d4193e073409caa287d6?s=128&d=identicon&r=PG", "display_name": "mljrg", "link": "https://stackoverflow.com/users/1483503/mljrg"}, "edited": false, "score": 0, "creation_date": 1446299786, "post_id": 33447517, "comment_id": 54691402, "body": "You&#39;ll need to close your end of any pipes that were created when spawning the process - this is not done automatically."}, {"owner": {"reputation": 3485, "user_id": 1483503, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/652348761699d4193e073409caa287d6?s=128&d=identicon&r=PG", "display_name": "mljrg", "link": "https://stackoverflow.com/users/1483503/mljrg"}, "edited": false, "score": 0, "creation_date": 1446300158, "post_id": 33447517, "comment_id": 54691540, "body": "Thanks again for your answer."}, {"owner": {"reputation": 6152, "user_id": 53974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a676c96a88feb813010e67af012ca0?s=128&d=identicon&r=PG", "display_name": "Blaisorblade", "link": "https://stackoverflow.com/users/53974/blaisorblade"}, "edited": false, "score": 1, "creation_date": 1499352235, "post_id": 33447517, "comment_id": 76879445, "body": "Apparently, this code creates a shell plus a process for <code>asd</code>, kills the shell and hopes that <code>asd</code> dies. That&#39;s not reliable\u2014it relies on job control hence it breaks if the process is not connected to a terminal. Using <code>proc</code> rather than <code>shell</code> is more robust. We&#39;ve run into this in the wild. Details in this issue: <a href=\"https://github.com/commercialhaskell/stack/issues/3250#issuecomment-313340444\" rel=\"nofollow noreferrer\">github.com/commercialhaskell/stack/issues/&hellip;</a>"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 2, "last_activity_date": 1446259226, "creation_date": 1446259226, "answer_id": 33447517, "question_id": 33446996, "link": "https://stackoverflow.com/questions/33446996/guaranteed-termination-of-external-process-in-haskell/33447517#33447517", "title": "Guaranteed termination of external process in Haskell", "body": "<p>On Posix systems <code>terminateProcess</code> just sends a SIGTERM signal.</p>\n\n<p>Here is some code which demonstrates how to send a SIGKILL signal to a Posix process which was created using <code>System.Process</code>:</p>\n\n<pre><code>import System.Process\nimport System.Process.Internals\nimport System.Posix.Signals\n\nmain = do\n  (_, _, _, ph) &lt;- createProcess (shell \"asd\")\n  -- ...\n  withProcessHandle ph $ \\ph_ -&gt;\n    case ph_ of\n      OpenHandle pid -&gt; signalProcess sigKILL pid\n      ClosedHandle _ -&gt; return ()                   -- shouldn't happen\n</code></pre>\n"}], "owner": {"reputation": 3485, "user_id": 1483503, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/652348761699d4193e073409caa287d6?s=128&d=identicon&r=PG", "display_name": "mljrg", "link": "https://stackoverflow.com/users/1483503/mljrg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 737, "favorite_count": 1, "accepted_answer_id": 33447517, "answer_count": 1, "score": 3, "last_activity_date": 1446259226, "creation_date": 1446253662, "question_id": 33446996, "link": "https://stackoverflow.com/questions/33446996/guaranteed-termination-of-external-process-in-haskell", "title": "Guaranteed termination of external process in Haskell", "body": "<p>I have launched a GHCi external process like this</p>\n\n<pre><code>(Just hin, Just hout, _, pid) &lt;- createProcess (proc \"ghci\" [\"-fdefer-type-errors\"])\n    { std_in = CreatePipe, std_out = CreatePipe, std_err = UseHandle stdout } \n</code></pre>\n\n<p>which I control by writing to <code>hin</code> and reading from <code>hout</code>. This is used to load an Haskell file into the external GHCi process, call one of its functions, and read its results, all this problematic.</p>\n\n<p>My problem is that sometimes there is some function that runs indefinetely when called, like <code>f n = sum [n..]</code>, and when this happens I want to terminate the external GHCi process. </p>\n\n<p>To do so, I have tried calling the function <code>terminateProcess pid</code> but it does not kill the process reliably; in general, the external process stops working, yet it still appears when I type <code>$ ps</code> at the console. For example, this is an example of top's output when the ghc external process is eating the processor:</p>\n\n<pre><code>PID    COMMAND      %CPU  TIME      ...\n38312  top          3.3   00:00.89 \n38309  ghc          99.9  00:21.46 \n38306  ghc          0.0   00:00.82 \n</code></pre>\n\n<p>and when I try to end it using <code>terminateProcess pid</code> it usually brings down the process to 0% CPU, but is still there:</p>\n\n<pre><code>PID    COMMAND      %CPU     TIME      ...\n38312  top          3.3   00:00.89\n38309  ghc          0.0   00:21.46 \n38306  ghc          0.0   00:00.82 \n</code></pre>\n\n<p>Sometimes, I need to call <code>terminateProcess pid</code> several times to make the external ghc stop, yet it is sill always there. Even then, after it stopped, when I try <code>waitForProcess pid</code> this one blocks.</p>\n\n<p>Is there a reliable way in Haskell to completely terminate an external process for sure? Like the Unix <code>kill -9 38309</code> always does?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 2, "creation_date": 1446274816, "post_id": 33446759, "comment_id": 54685459, "body": "Think of the body of the function as:  <code>(f (1 :: Int), f (1.0 :: Double))</code>. You cannot use the latter type signature for this. In <code>Num n =&gt; n -&gt; n -&gt; (Int, Double)</code> you&#39;d have that <code>n</code> must be both <code>Int</code> and <code>Double</code> <i>at the same time</i>. Using <code>(forall n . Num n =&gt; n -&gt; n) -&gt; (Int, Double)</code> you have that the function <code>f</code> can be applied to different types and thus it is well typed."}], "answers": [{"comments": [{"owner": {"reputation": 3483, "user_id": 62029, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/678af400241c37d1492f8e2e992f1d73?s=128&d=identicon&r=PG", "display_name": "AgentLiquid", "link": "https://stackoverflow.com/users/62029/agentliquid"}, "edited": false, "score": 0, "creation_date": 1610352482, "post_id": 33446848, "comment_id": 116095322, "body": "More than a half-decade late, but I want to tell you that this explanation is one of the best intuition-pumps for Rank2Types."}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 5, "last_activity_date": 1446252168, "creation_date": 1446252168, "answer_id": 33446848, "question_id": 33446759, "link": "https://stackoverflow.com/questions/33446759/understanding-haskells-rankntypes/33446848#33446848", "title": "Understanding Haskell&#39;s RankNTypes", "body": "<blockquote>\n  <p>How do you \"read\" this former signature so that it sounds like what it means?</p>\n</blockquote>\n\n<p>You can read</p>\n\n<pre><code>rankN :: (forall n. Num n =&gt; n -&gt; n) -&gt; (Int, Double)\n</code></pre>\n\n<p>as \"rankN takes a parameter <code>f :: Num n =&gt; n -&gt; n</code>\" and returns <code>(Int, Double)</code>, where <code>f :: Num n =&gt; n -&gt; n</code> can be read as \"for any numeric type <code>n</code>, <code>f</code> can take an <code>n</code> and return an <code>n</code>\".</p>\n\n<p>The rank one definition</p>\n\n<pre><code>rank1 :: forall n. Num n =&gt; (n -&gt; n) -&gt; (Int, Double)\n</code></pre>\n\n<p>would then be read as \"For any numeric type <code>n</code>, <code>rank1</code> takes an argument <code>f :: n -&gt; n</code> and returns an <code>(Int, Double)</code>\".</p>\n\n<blockquote>\n  <p>Is the latter signature the same as simply <code>Num n =&gt; (n -&gt; n) -&gt; (Int, Double)</code> without the need for <code>forall</code>?</p>\n</blockquote>\n\n<p>Yes, by default all <code>forall</code>s are implicitly placed at the outer-most position (resulting in a rank-1 type).</p>\n"}, {"comments": [{"owner": {"reputation": 538, "user_id": 500511, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/99duf.png?s=128&g=1", "display_name": "helpwithhaskell", "link": "https://stackoverflow.com/users/500511/helpwithhaskell"}, "edited": false, "score": 0, "creation_date": 1446270447, "post_id": 33446964, "comment_id": 54684705, "body": "Why would one want the rankN case? What advantage does requiring the polymorphic parameter offer?"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 5, "last_activity_date": 1446271991, "last_edit_date": 1446271991, "creation_date": 1446253387, "answer_id": 33446964, "question_id": 33446759, "link": "https://stackoverflow.com/questions/33446759/understanding-haskells-rankntypes/33446964#33446964", "title": "Understanding Haskell&#39;s RankNTypes", "body": "<p>In the <code>rankN</code> case <code>f</code> has to be a polymorphic function which is valid for all numeric types <code>n</code>.</p>\n\n<p>In the <code>rank1</code> case <code>f</code> only has to be defined for a single numeric type.</p>\n\n<p>Here is some code which illustrates this:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\n\nrankN :: (forall n. Num n =&gt; n -&gt; n) -&gt; (Int, Double)\nrankN = undefined\n\nrank1 :: forall n. Num n =&gt; (n -&gt; n) -&gt; (Int, Double)\nrank1 = undefined\n\nfoo :: Int -&gt; Int  -- monomorphic\nfoo n = n + 1\n\ntest1 = rank1 foo -- OK\n\ntest2 = rankN foo -- does not type check\n\ntest3 = rankN (+1) -- OK since (+1) is polymorphic\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>In response to @helpwithhaskell's question in the comments...</p>\n\n<p>Consider this function:</p>\n\n<pre><code>bar :: (forall n. Num n =&gt; n -&gt; n) -&gt; (Int, Double) -&gt; (Int, Double)\nbar f (i,d) = (f i, f d)\n</code></pre>\n\n<p>That is, we apply <code>f</code> to both an Int and a Double. Without using RankNTypes it won't type check:</p>\n\n<pre><code>-- doesn't work\nbar' :: ??? -&gt; (Int, Double) -&gt; (Int, Double)\nbar' f (i,d) = (f i, f d)\n</code></pre>\n\n<p>None of the following signatures work for ???:</p>\n\n<pre><code>Num n =&gt; (n -&gt; n)\nInt -&gt; Int\nDouble -&gt; Double\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "edited": false, "score": 1, "creation_date": 1446254619, "post_id": 33447037, "comment_id": 54682282, "body": "Thank you. In &quot;Rank N&quot;, what does rank mean and what does the N refer to?"}, {"owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "reply_to_user": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "edited": false, "score": 3, "creation_date": 1446255960, "post_id": 33447037, "comment_id": 54682499, "body": "The <code>N</code> refers to how deeply you can nest <code>forall</code> inside functions (<code>-&gt;</code>). In this case, it&#39;s nested inside a single function, so it would be rank 2. Haskell used to <i>only</i> support Rank2 polymorphism but since it now supports arbitrary ranks, this is more of a historical note."}], "tags": [], "owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "is_accepted": true, "score": 13, "last_activity_date": 1446254086, "creation_date": 1446254086, "answer_id": 33447037, "question_id": 33446759, "link": "https://stackoverflow.com/questions/33446759/understanding-haskells-rankntypes/33447037#33447037", "title": "Understanding Haskell&#39;s RankNTypes", "body": "<p>In the normal case (<code>forall n. Num n =&gt; (n -&gt; n) -&gt; (Int, Double)</code>), we choose an <code>n</code> <em>first</em> and then provide a function. So we could pass in a function of type <code>Int -&gt; Int</code>, <code>Double -&gt; Double</code>, <code>Rational -&gt; Rational</code> and so on.</p>\n\n<p>In the Rank 2 case (<code>(forall n. Num n =&gt; n -&gt; n)  -&gt; (Int, Double)</code>) we have to provide the function <em>before</em> we know <code>n</code>. This means that the function has to work for <em>any</em> <code>n</code>; none of the examples I listed for the previous example would work.</p>\n\n<p>We need this for the example code given because the function <code>f</code> that's passed in is applied to two different types: an <code>Int</code> and a <code>Double</code>. So it has to work for both of them.</p>\n\n<p>The first case is normal because that's how type variables work by default. If you don't have a <code>forall</code> at all, your type signature is equivalent to having it at the very beginning. (This is called prenex form.) So <code>Num n =&gt; (n -&gt; n) -&gt; (Int, Double)</code> is implicitly the same as <code>forall n. Num n =&gt; (n -&gt; n) -&gt; (Int, Double)</code>.</p>\n\n<p>What's the type of a function that works for <em>any</em> <code>n</code>? It's exactly <code>forall n. Num n =&gt; n -&gt; n</code>.</p>\n"}], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1538, "favorite_count": 8, "accepted_answer_id": 33447037, "answer_count": 3, "score": 13, "last_activity_date": 1612780169, "creation_date": 1446251296, "last_edit_date": 1612780169, "question_id": 33446759, "link": "https://stackoverflow.com/questions/33446759/understanding-haskells-rankntypes", "title": "Understanding Haskell&#39;s RankNTypes", "body": "<p>While working my way through GHC extensions, I came across <a href=\"https://www.fpcomplete.com/school/to-infinity-and-beyond/pick-of-the-week/guide-to-ghc-extensions/explicit-forall#rankntypes--rank2types--and-polymorphiccomponents\" rel=\"nofollow noreferrer\"><code>RankNTypes</code> at the School of Haskell</a>, which had the following example:</p>\n<pre><code>main = print $ rankN (+1)\n\nrankN :: (forall n. Num n =&gt; n -&gt; n) -&gt; (Int, Double)\nrankN f = (f 1, f 1.0)\n</code></pre>\n<p>The article offered an alternative type for <code>rankN</code>:</p>\n<pre><code>rankN :: forall n. Num n =&gt; (n -&gt; n) -&gt; (Int, Double) \n</code></pre>\n<p>The explanation of the difference is that</p>\n<blockquote>\n<p>The latter signature requires a function from n to n for some Num n; the former signature requires a function from n to n for every Num n.</p>\n</blockquote>\n<p>I can understand that the former type requires a signature to be what's in the parentheses or more general. I do not understand the explanation that the latter signature simply requires a function <code>n -&gt; n</code> for &quot;some <code>Num n</code>&quot;. Can someone elaborate and clarify? How do you &quot;read&quot; this former signature so that it sounds like what it means? Is the latter signature the same as simply <code>Num n =&gt; (n -&gt; n) -&gt; (Int, Double)</code> without the need for <code>forall</code>?</p>\n"}, {"tags": ["haskell", "functional-programming", "ghci"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1446251216, "post_id": 33446637, "comment_id": 54681647, "body": "Please don&#39;t use screenshots for code -- just paste it in your question and add code formatting."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 5495763, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8cf1c15207081427bf0986f40230cc5f?s=128&d=identicon&r=PG&f=1", "display_name": "Andalib Ali", "link": "https://stackoverflow.com/users/5495763/andalib-ali"}, "edited": false, "score": 0, "creation_date": 1446251979, "post_id": 33446791, "comment_id": 54681808, "body": "I&#39;m sorry, i&#39;m still a bit confused. How would i redirect those card values into the second round of war?"}, {"owner": {"reputation": 59, "user_id": 5495763, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8cf1c15207081427bf0986f40230cc5f?s=128&d=identicon&r=PG&f=1", "display_name": "Andalib Ali", "link": "https://stackoverflow.com/users/5495763/andalib-ali"}, "edited": false, "score": 0, "creation_date": 1446253211, "post_id": 33446791, "comment_id": 54682033, "body": "Can this done, as a single single parameter? The whole program was written treating player 1 and player 2 as one tuple."}, {"owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "reply_to_user": {"reputation": 59, "user_id": 5495763, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8cf1c15207081427bf0986f40230cc5f?s=128&d=identicon&r=PG&f=1", "display_name": "Andalib Ali", "link": "https://stackoverflow.com/users/5495763/andalib-ali"}, "edited": false, "score": 0, "creation_date": 1446255298, "post_id": 33446791, "comment_id": 54682385, "body": "You can structure the parameters however you want, as long as they include all this information: the cards in player 1&#39;s hand, the cards in player 2&#39;s hand, the cards on the table from player 1, and the cards on the table from player 2. Your original function was just missing all the cards on the table."}], "tags": [], "owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "is_accepted": false, "score": 1, "last_activity_date": 1446252856, "last_edit_date": 1446252856, "creation_date": 1446251653, "answer_id": 33446791, "question_id": 33446637, "link": "https://stackoverflow.com/questions/33446637/haskell-war-card-game/33446791#33446791", "title": "Haskell- War card Game", "body": "<p>Add another parameter to the <code>war</code> function.</p>\n\n<pre><code>war :: ([Int],[Int]) -&gt; ([Int],[Int]) -&gt; ([Int],[Int])\nwar (px,py) (x,y) = let\n  [(xp',(xc:xr)),(yp',(yc:yr))] = map (splitAt 3) [x,y]\n  in case xc `compare` yc of\n    GT -&gt; (xr ++ px ++ xp' ++ [xc] ++ py ++ yp' ++ [yc], yr)\n    LT -&gt; (xr, yr ++ py ++ yp' ++ [yc] ++ px ++ xp' ++ [xc])\n    EQ -&gt; war (px ++ xp' ++ [xc], py ++ yp' ++ [yc]) (xr,yr)\n</code></pre>\n\n<p>In the call from the <code>standardRound</code> function: the first parameter should be <code>([],[])</code>, in the recursive calls it should be the list of cards.</p>\n"}, {"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 1, "last_activity_date": 1446268830, "creation_date": 1446268830, "answer_id": 33448347, "question_id": 33446637, "link": "https://stackoverflow.com/questions/33446637/haskell-war-card-game/33448347#33448347", "title": "Haskell- War card Game", "body": "<p>You can use <code>let ... in</code> to extract the values of a tuple</p>\n\n<pre><code>| otherwise = let (newxs,newys) = war (drop 4 xs, drop 4 ys) in\n              (take 3 xs ++ newxs, take 3 ys ++ newys)\n</code></pre>\n\n<p>so that you can returned a modified version.  Add the dropped cards before or after, however you like.</p>\n"}], "owner": {"reputation": 59, "user_id": 5495763, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8cf1c15207081427bf0986f40230cc5f?s=128&d=identicon&r=PG&f=1", "display_name": "Andalib Ali", "link": "https://stackoverflow.com/users/5495763/andalib-ali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "accepted_answer_id": 33448347, "answer_count": 2, "score": -4, "last_activity_date": 1446268830, "creation_date": 1446250270, "last_edit_date": 1446251759, "question_id": 33446637, "link": "https://stackoverflow.com/questions/33446637/haskell-war-card-game", "title": "Haskell- War card Game", "body": "<p>One of the rules that i'm trying to program is: </p>\n\n<blockquote>\n  <p>When the two players play cards of equal rank, this triggers a \u201cwar\u201d.\n  Each player sets down three cards, and then flips one more card.\n  Whoever wins between these last two flipped cards gets to take all the\n  cards in the round, including the 3 cards that were set down by each\n  player. If those flipped cards match again, another war is triggered,\n  which is resolved in the same way.</p>\n</blockquote>\n\n<p>I can implement the first round of war inside my code, however the part that i am stuck with is when the second round of war is initiated when the two players get the same card again. The trouble i am having is when the second round of war is initiated, the two players put aside the cards from the first war and whoever whens the second war gets all the cards from the second war and the first war. \nI don't know understand how to make my war function store the first round of cards, as you can see in my otherwise i just dropped the cards from the first round. </p>\n\n<pre><code>war :: ([Int], [Int]) -&gt; ([Int], [Int])\nwar (x:xs,y:ys)\n | head(drop 3 xs) &gt; head(drop 3 (ys))  = (drop 4 (xs) ++ player1Pot (x:xs) ++ player2Pot (y:ys), drop 4 (ys))\n | head(drop 3 xs) &lt; head(drop 3 (ys))  = (drop 4 (xs), drop 4 (ys) ++ player2Pot (y:ys) ++ player1Pot (x:xs))\n | otherwise  = war (drop 4 (xs),drop 4 (ys))\n\nstandardRound :: ([Int], [Int]) -&gt; ([Int], [Int])\nstandardRound ([],y:ys) = ([],y:ys)\nstandardRound (x:xs,[]) = (x:xs,[])\nstandardRound (x:xs,y:ys)\n | x &gt; y            = (xs ++ [y] ++ [x], ys)\n | y &gt; x            = (xs, ys ++ [x] ++ [y])\n | otherwise        = war (x:xs,y:ys)\n</code></pre>\n"}, {"tags": ["haskell", "haskell-stack"], "answers": [{"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 29, "last_activity_date": 1446265809, "last_edit_date": 1446265809, "creation_date": 1446258192, "answer_id": 33447434, "question_id": 33446558, "link": "https://stackoverflow.com/questions/33446558/understanding-haskells-stack-program-and-the-resolver-and-lts-version/33447434#33447434", "title": "Understanding Haskell&#39;s stack program and the resolver and LTS version", "body": "<blockquote>\n  <p>Does this mean that the project has been set up to use only the packages and versions that were verified under LTS-3.8?</p>\n</blockquote>\n\n<p>Exactly. (And if you ever need packages not included in the LTS 3.8 set you can specify them through the <code>extra-deps</code> section of <code>stack.yaml</code>. stack will grab them from Hackage and install them separately for your project, without affecting the LTS snapshot or your other projects.)</p>\n\n<blockquote>\n  <p>If I now want to start a new project and want to use the latest LTS version with the new project, how do I tell stack to do that by default?</p>\n</blockquote>\n\n<p>Use e.g. <code>stack new projectname --resolver=lts-3.11</code> to set the resolver for a new project. stack defaults to the most recent LTS snapshot you are already using, and so once you have a project with the latest LTS future new projects will follow suit.</p>\n\n<blockquote>\n  <p>What about if I want to \"upgrade\" an older project to use a new LTS version?</p>\n</blockquote>\n\n<p>Change the <code>resolver</code> field in the <code>stack.yaml</code> file. The change will take effect the next time you build the project.</p>\n"}], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5576, "favorite_count": 5, "accepted_answer_id": 33447434, "answer_count": 1, "score": 27, "last_activity_date": 1446265809, "creation_date": 1446249646, "last_edit_date": 1446250257, "question_id": 33446558, "link": "https://stackoverflow.com/questions/33446558/understanding-haskells-stack-program-and-the-resolver-and-lts-version", "title": "Understanding Haskell&#39;s stack program and the resolver and LTS version", "body": "<p>I am trying to understand how to use <a href=\"http://www.stackage.org/\">stack and stackage.org</a>. When I first installed it and used it, stackage.org was at LTS-3.8 (the \"resolver\"). Since then, stackage.org now has LTS-3.11.</p>\n\n<p>First, I'd like to confirm what this means. Stackage is a repository of packages in which, for a specific LTS version (say 3.8), the packages have been verified to work together. So the packages of LTS-3.8 work together, and the packages of LTS-3.11 also work together. Moving on ...</p>\n\n<p>When I run <code>stack new projectname</code>, stack tells me:</p>\n\n<pre><code>Checking against build plan lts-3.8\nSelected resolver: lts-3.8\n</code></pre>\n\n<p>Does this mean that the project has been set up to use only the packages and versions that were verified under LTS-3.8?</p>\n\n<p>If I now want to start a new project and want to use the latest LTS version with the new project, how do I tell stack to do that by default?</p>\n\n<p>What about if I want to \"upgrade\" an older project to use a new LTS version?</p>\n"}, {"tags": ["macos", "haskell", "osx-elcapitan"], "comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 1, "creation_date": 1446248870, "post_id": 33445898, "comment_id": 54681132, "body": "I&#39;d suggest two things: a) drop haskell platform and just install via <code>brew</code>. b)  Use stack(age)."}], "answers": [{"tags": [], "owner": {"reputation": 1003, "user_id": 218307, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/71349c1b606c549215197f7ec55e2276?s=128&d=identicon&r=PG", "display_name": "jhickner", "link": "https://stackoverflow.com/users/218307/jhickner"}, "is_accepted": true, "score": 1, "last_activity_date": 1446249358, "creation_date": 1446249358, "answer_id": 33446521, "question_id": 33445898, "link": "https://stackoverflow.com/questions/33445898/haskell-cabal-issue-with-mac-os-x-10-11-cannot-satisfy-package-id/33446521#33446521", "title": "Haskell cabal issue with Mac OS X 10.11? (cannot satisfy -package-id)", "body": "<p>This might be controversial, but imho the haskell platform and cabal (when used directly) are both essentially deprecated now with the advent of <a href=\"https://www.stackage.org/\" rel=\"nofollow\">stack</a>.</p>\n\n<p>Stack will:</p>\n\n<ol>\n<li>Automatically install haskell for you (<code>stack setup</code>)</li>\n<li>Automatically sandbox (and intelligently share sandboxes between projects)</li>\n<li>Completely avoid cabal hell (in my experience)</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 1407, "user_id": 4930992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/108ce448671bef8443fcd64efb3012fa?s=128&d=identicon&r=PG&f=1", "display_name": "Christopher Armstrong", "link": "https://stackoverflow.com/users/4930992/christopher-armstrong"}, "edited": false, "score": 0, "creation_date": 1446271716, "post_id": 33446803, "comment_id": 54684914, "body": "You&#39;re conflating Stackage with Stack in your answer. They are different but related things."}], "tags": [], "owner": {"reputation": 154069, "user_id": 260127, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/74758c702067a3490094451e475e28c5?s=128&d=identicon&r=PG", "display_name": "prosseek", "link": "https://stackoverflow.com/users/260127/prosseek"}, "is_accepted": false, "score": 1, "last_activity_date": 1446255169, "last_edit_date": 1495541453, "creation_date": 1446251729, "answer_id": 33446803, "question_id": 33445898, "link": "https://stackoverflow.com/questions/33445898/haskell-cabal-issue-with-mac-os-x-10-11-cannot-satisfy-package-id/33446803#33446803", "title": "Haskell cabal issue with Mac OS X 10.11? (cannot satisfy -package-id)", "body": "<p>I could install yesod from brew.</p>\n\n<h3>Uninstall haskell-plaftorm</h3>\n\n<ul>\n<li><code>/Library/Haskell/bin/uninstall-hs thru 7.10.2</code></li>\n</ul>\n\n<h3>Install ghc</h3>\n\n<ul>\n<li><code>brew install ghc</code>\n\n<ul>\n<li><code>brew link ghc</code></li>\n</ul></li>\n</ul>\n\n<h3>Install stackage</h3>\n\n<ul>\n<li><code>brew install haskell-stack</code></li>\n</ul>\n\n<h3>Install Yesod</h3>\n\n<ul>\n<li><code>stack install yesod</code></li>\n<li><code>stack install yesod-bin</code></li>\n</ul>\n\n<h3>Use Yesod</h3>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/32200773/getting-could-not-find-module-yesod-when-i-try-to-run-first-example-from-yes\">Getting &quot;Could not find module `Yesod&#39;&quot; when I try to run first example from Yesod book</a>\n\n<ul>\n<li><code>stack runghc hello-world.hs</code></li>\n</ul></li>\n</ul>\n\n<h3>Use Yesod for development</h3>\n\n<ul>\n<li>I'm not sure, but I had to run <code>stack exec yesod build</code> first.</li>\n<li><code>stack exec yesod devel</code>. </li>\n</ul>\n\n<h3>Yesod deployment with keter</h3>\n\n<ul>\n<li>Remove the first line in config/keter.yaml</li>\n<li><code>stack exec yesod keter</code>, and you will get one binary in dist/bin that contains most of the necessary files to run.</li>\n<li>Execute the binary as a standalone server. </li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 1178, "user_id": 1667161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233658d12fabd9d72b04d0a6916f6389?s=128&d=identicon&r=PG", "display_name": "liminalisht", "link": "https://stackoverflow.com/users/1667161/liminalisht"}, "is_accepted": false, "score": 3, "last_activity_date": 1446571480, "last_edit_date": 1495535644, "creation_date": 1446571480, "answer_id": 33505417, "question_id": 33445898, "link": "https://stackoverflow.com/questions/33445898/haskell-cabal-issue-with-mac-os-x-10-11-cannot-satisfy-package-id/33505417#33505417", "title": "Haskell cabal issue with Mac OS X 10.11? (cannot satisfy -package-id)", "body": "<p>As suggested <a href=\"https://stackoverflow.com/questions/7139263/cabal-install-failing-osx-many-unsatisfied-packages\">here</a>, the <code>cannot satisfy -package-id</code> error you're seeing might be due to an out of date cache. </p>\n\n<p>If running <code>ghc-pkg check</code> warns you that your cache is out of date, then running <code>ghc-pkg recache</code> might resolve your issues.</p>\n\n<p>I've been running into the <code>cannot satisfy -package-id</code> problem all morning (not with yesod, but with various other packages). <code>ghc-pkg recache</code> resolved my issues. Hope this helps.</p>\n"}], "owner": {"reputation": 154069, "user_id": 260127, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/74758c702067a3490094451e475e28c5?s=128&d=identicon&r=PG", "display_name": "prosseek", "link": "https://stackoverflow.com/users/260127/prosseek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 617, "favorite_count": 1, "accepted_answer_id": 33446521, "answer_count": 3, "score": 1, "last_activity_date": 1446571480, "creation_date": 1446244813, "question_id": 33445898, "link": "https://stackoverflow.com/questions/33445898/haskell-cabal-issue-with-mac-os-x-10-11-cannot-satisfy-package-id", "title": "Haskell cabal issue with Mac OS X 10.11? (cannot satisfy -package-id)", "body": "<p>I used the latest Haskell Platform 7.10.2-a (<a href=\"https://www.haskell.org/platform/mac.html\" rel=\"nofollow\">https://www.haskell.org/platform/mac.html</a>) on Mac OS X 10.11 for El-capitan. </p>\n\n<p>When I tried to install <code>yesod</code> with <code>cabal install yesod</code>, I have multiple error messages such as:</p>\n\n<pre><code>Building email-validate-2.1.3...\nBuilding http-api-data-0.2.1...\nBuilding fast-logger-2.4.1...\nBuilding http-date-0.0.6.1...\nFailed to install crypto-random-0.0.9\nBuild log ( /Users/smcho/.cabal/logs/crypto-random-0.0.9.log ):\nConfiguring crypto-random-0.0.9...\nBuilding crypto-random-0.0.9...\nPreprocessing library crypto-random-0.0.9...\n&lt;command line&gt;: cannot satisfy -package-id vector-0.11.0.0-730f99979d41c11c3a1ef069844b5f57\n    (use -v for more information)\nFailed to install email-validate-2.1.3\nBuild log ( /Users/smcho/.cabal/logs/email-validate-2.1.3.log ):\nConfiguring email-validate-2.1.3...\n</code></pre>\n\n<p>The error pattern is pretty much the same: <code>cannot satisfy -package-id</code>.</p>\n\n<p>For example, <code>cabal install aeson</code> gives <code>cannot satisfy -package-id attoparse...</code> error. </p>\n\n<pre><code>Resolving dependencies...\nConfiguring aeson-0.10.0.0...\nBuilding aeson-0.10.0.0...\nFailed to install aeson-0.10.0.0\nBuild log ( /Users/smcho/.cabal/logs/aeson-0.10.0.0.log ):\nConfiguring aeson-0.10.0.0...\nBuilding aeson-0.10.0.0...\nPreprocessing library aeson-0.10.0.0...\n&lt;command line&gt;: cannot satisfy -package-id attoparsec-0.13.0.1-99b4df28644e63383f308c810764a8bb\n    (use -v for more information)\ncabal: Error: some packages failed to install:\naeson-0.10.0.0 failed during the building phase. The exception was:\nExitFailure 1\n</code></pre>\n\n<p>However, attoparsec library seems to be installed without problem. </p>\n\n<pre><code>smcho@macho ~&gt; cabal install attoparsec\nResolving dependencies...\nAll the requested packages are already installed:\nattoparsec-0.13.0.1\nUse --reinstall if you want to reinstall anyway.\n</code></pre>\n\n<p>What might be wrong? </p>\n"}, {"tags": ["haskell", "utf-8"], "answers": [{"tags": [], "owner": {"reputation": 4426, "user_id": 469981, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/b116107a07635c7b2015d3ffd8ddbe3a?s=128&d=identicon&r=PG", "display_name": "jazmit", "link": "https://stackoverflow.com/users/469981/jazmit"}, "is_accepted": false, "score": 3, "last_activity_date": 1520852052, "last_edit_date": 1520852052, "creation_date": 1446241123, "answer_id": 33445296, "question_id": 33444796, "link": "https://stackoverflow.com/questions/33444796/read-file-with-utf-8-in-haskell-as-io-string/33445296#33445296", "title": "Read file with UTF-8 in Haskell as IO String", "body": "<p>Use <a href=\"https://hackage.haskell.org/package/encoding-0.8/docs/System-IO-Encoding.html\" rel=\"nofollow noreferrer\">System.IO.Encoding</a>.</p>\n\n<p>The lack of unicode support is a well known problem with with the standard Haskell IO library.</p>\n\n<pre><code>module Main where\n\nimport Prelude hiding (readFile, getLine, writeFile)\nimport System.IO.Encoding\nimport Data.Encoding.UTF8\n\nmain = do\n    let ?enc = UTF8\n    text &lt;- getLine\n    theInput &lt;- readFile text\n    writeFile (\"a\" ++ text) (unlist . proc . lines $ theInput)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4328, "user_id": 1473927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AO6Ui.jpg?s=128&g=1", "display_name": "Jonathan Cast", "link": "https://stackoverflow.com/users/1473927/jonathan-cast"}, "edited": false, "score": 0, "creation_date": 1567549191, "post_id": 33445350, "comment_id": 101993516, "body": "The <code>hClose</code> is necessary to force GHC to flush the output buffer, by the way (doesn&#39;t automatically happen on program exit)"}], "tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": false, "score": 5, "last_activity_date": 1446241723, "last_edit_date": 1446241723, "creation_date": 1446241422, "answer_id": 33445350, "question_id": 33444796, "link": "https://stackoverflow.com/questions/33444796/read-file-with-utf-8-in-haskell-as-io-string/33445350#33445350", "title": "Read file with UTF-8 in Haskell as IO String", "body": "<p>This can be done with just GHC's basic (but extended from the standard) <code>System.IO</code> module, although you'll then have to use more functions:</p>\n\n<pre><code>module Main where\n\nimport Ref\nimport System.IO\n\nmain = do\n    text &lt;- getLine\n    inputHandle &lt;- openFile text ReadMode \n    hSetEncoding inputHandle utf8\n    theInput &lt;- hGetContents inputHandle\n    outputHandle &lt;- openFile (\"a\"++text) WriteMode\n    hSetEncoding outputHandle utf8\n    hPutStr outputHandle (unlist . proc . lines $ theInput)\n    hClose outputHandle -- I guess this one is optional in this case.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 233, "user_id": 5508262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LvfKR.png?s=128&g=1", "display_name": "George Peppa", "link": "https://stackoverflow.com/users/5508262/george-peppa"}, "is_accepted": true, "score": 3, "last_activity_date": 1446346328, "creation_date": 1446346328, "answer_id": 33458750, "question_id": 33444796, "link": "https://stackoverflow.com/questions/33444796/read-file-with-utf-8-in-haskell-as-io-string/33458750#33458750", "title": "Read file with UTF-8 in Haskell as IO String", "body": "<p>Thanks for the answers, but I found the solution by myself.\nActually the file I was working with has this codification:</p>\n\n<pre><code>ISO-8859 text, with CR line terminators\n</code></pre>\n\n<p>So to work with that file with my haskell code It should have this codification instead:</p>\n\n<pre><code>UTF-8 Unicode text, with CR line terminators\n</code></pre>\n\n<p>You can check the file codification with the utility <code>file</code> like this:</p>\n\n<pre><code>$ file filename\n</code></pre>\n\n<p>To change the file codification follow the instructions from this <a href=\"http://ask.xmodulo.com/change-character-encoding-text-file-linux.html\" rel=\"nofollow\">link</a>!</p>\n"}], "owner": {"reputation": 233, "user_id": 5508262, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/LvfKR.png?s=128&g=1", "display_name": "George Peppa", "link": "https://stackoverflow.com/users/5508262/george-peppa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2206, "favorite_count": 1, "accepted_answer_id": 33458750, "answer_count": 3, "score": 9, "last_activity_date": 1520852052, "creation_date": 1446238584, "question_id": 33444796, "link": "https://stackoverflow.com/questions/33444796/read-file-with-utf-8-in-haskell-as-io-string", "title": "Read file with UTF-8 in Haskell as IO String", "body": "<p>I have the following code which works fine unless the file has <code>utf-8</code> characteres :</p>\n\n<pre><code>module Main where\nimport Ref\nmain = do\n    text &lt;- getLine\n    theInput &lt;- readFile text\n    writeFile (\"a\"++text) (unlist . proc . lines $ theInput)\n</code></pre>\n\n<p>With utf-8 characteres I get this:\n<code>hGetContents: invalid argument (invalid byte sequence)</code></p>\n\n<p>Since the file I'm working with has <code>UTF-8</code> characters, I would like to handle this exception in order to reuse the functions imported from <code>Ref</code> if possible.</p>\n\n<p>Is there a way to read a <code>UTF-8</code> file as <code>IO String</code> so I can reuse my <code>Ref</code>'s functions?. What modifications should I make to my code?. Thanks in Advance.</p>\n\n<p>I attach the functions declarations from my <code>Ref</code> module:</p>\n\n<pre><code>unlist :: [String] -&gt; String\nproc :: [String] -&gt; [String]\n</code></pre>\n\n<p>from prelude:</p>\n\n<pre><code>lines :: String -&gt; [String]\n</code></pre>\n"}, {"tags": ["regex", "haskell", "recursion", "idris", "lightyear"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1446230028, "post_id": 33441830, "comment_id": 54673615, "body": "Well, you can get rid of the left recursion. Given <code>A ::= Aa | b</code> you can use the equivalent grammar: <code>A&#39; ::= bA&#39;&#39;   A&#39;&#39; ::= aA&#39;&#39; | &quot;&quot;</code> (you can do this even with more productions and if the recursion is indirect, although it becomes too long for a comment."}, {"owner": {"reputation": 2970, "user_id": 2928766, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c5d36ca80eccb125ee34991165d481e?s=128&d=identicon&r=PG", "display_name": "Rodrigo Ribeiro", "link": "https://stackoverflow.com/users/2928766/rodrigo-ribeiro"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1446230457, "post_id": 33441830, "comment_id": 54673850, "body": "Hi Bakuriu. I&#39;ve tried to remove left recursion from the grammar, but it still stuck, the parser loops and causes a segmentation fault. Later, I&#39;ll post the grammar, but I believe that I removed it correctly."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 2, "creation_date": 1446232844, "post_id": 33441830, "comment_id": 54675057, "body": "The standard Parsec solution is to factor left recursion into <a href=\"https://hackage.haskell.org/package/parsec-3.1.9/docs/src/Text-Parsec-Combinator.html#chainl\" rel=\"nofollow noreferrer\"><code>chainl</code></a>."}, {"owner": {"reputation": 2970, "user_id": 2928766, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c5d36ca80eccb125ee34991165d481e?s=128&d=identicon&r=PG", "display_name": "Rodrigo Ribeiro", "link": "https://stackoverflow.com/users/2928766/rodrigo-ribeiro"}, "edited": false, "score": 0, "creation_date": 1446233045, "post_id": 33441830, "comment_id": 54675152, "body": "I know it. My problem is that if it is possible to write a chainl combinator in Idris using already implemented lightyear library combinators."}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1446549047, "post_id": 33441830, "comment_id": 54778926, "body": "On an unrelated note, you might be interested in my <a href=\"https://github.com/gallais/aGdaREP\" rel=\"nofollow noreferrer\">aGdaREP</a> project. The core algorithm is adapted from Alexandre Agular and Bassel Mannaa&#39;s 2009 technical report (<a href=\"http://www.cse.chalmers.se/~bassel/regex_agda/report.pdf\" rel=\"nofollow noreferrer\">pdf</a>). My parser is awful though so it won&#39;t be much help there."}], "answers": [{"comments": [{"owner": {"reputation": 2970, "user_id": 2928766, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c5d36ca80eccb125ee34991165d481e?s=128&d=identicon&r=PG", "display_name": "Rodrigo Ribeiro", "link": "https://stackoverflow.com/users/2928766/rodrigo-ribeiro"}, "edited": false, "score": 2, "creation_date": 1446307885, "post_id": 33448261, "comment_id": 54694002, "body": "Thanks for your points. The Lightyear library has a &quot;lazy&quot; choice combinator in which the second parser is lazy. This solved my problem."}], "tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 4, "last_activity_date": 1446268022, "creation_date": 1446268022, "answer_id": 33448261, "question_id": 33441830, "link": "https://stackoverflow.com/questions/33441830/is-there-a-way-to-code-a-chainl-function-in-idris-lightyear-library/33448261#33448261", "title": "Is there a way to code a chainl function in idris lightyear library?", "body": "<p>I don't know Lightyear, but I had some success porting Parsec to Idris:</p>\n\n<pre><code>module Parser\n\ndata Parser : Type -&gt; Type where\n     P : (String -&gt; List (a, String)) -&gt; Parser a\n\nunP : Parser a -&gt; String -&gt; List (a, String)\nunP (P f) = f\n\ntotal stripPrefix : (Eq a) =&gt; List a -&gt; List a -&gt; Maybe (List a)\nstripPrefix [] ys = Just ys\nstripPrefix (x::xs) (y::ys) = if (x == y) then stripPrefix xs ys else Nothing\nstripPrefix _ _  = Nothing\n\ntotal token : String -&gt; Parser ()\ntoken tk = P $ \\s =&gt; case stripPrefix (unpack tk) (unpack s) of\n      Just s' =&gt; [((), pack s')]\n      Nothing =&gt; []\n\ntotal skip : Parser ()\nskip = P $ \\s =&gt; case unpack s of\n     [] =&gt; []\n     (_::s') =&gt; [((), pack s')]\n\ninstance Functor Parser where\n  map f p = P $ \\s =&gt; map (\\(x, s') =&gt; (f x, s')) (unP p s)\n\ninstance Applicative Parser where\n  pure x = P $ \\s =&gt; [(x, s)]\n  (P pf) &lt;*&gt; (P px) = P $ \\s =&gt; concat (map (\\(f, s') =&gt; map (\\(x, s'') =&gt; (f x, s'')) (px s')) (pf s))\n\ninstance Alternative Parser where\n  empty = P $ \\s =&gt; []\n  (P p1) &lt;|&gt; (P p2) = P $ \\s =&gt; case p1 s of\n     [] =&gt; p2 s\n     results =&gt; results\n\ninstance Monad Parser where\n  px &gt;&gt;= f = P $ \\s =&gt; concat (map (\\(x, s') =&gt; unP (f x) s') (unP px s))\n\ntotal runParser : Parser a -&gt; String -&gt; Maybe a\nrunParser (P p) s = case p s of\n  [(x, \"\")] =&gt; Just x\n  _         =&gt; Nothing\n</code></pre>\n\n<p>This allows a straight copy-paste implementation of <code>chainl</code>:</p>\n\n<pre><code>chainl1 : Parser a -&gt; Parser (a -&gt; a -&gt; a) -&gt; Parser a\nchainl1 p op = p &gt;&gt;= rest\n  where\n    rest x = do { f &lt;- op; y &lt;- p; rest $ f x y } &lt;|&gt; return x\n\nchainl : Parser a -&gt; Parser (a -&gt; a -&gt; a) -&gt; a -&gt; Parser a\nchainl p op x = chainl1 p op &lt;|&gt; return x\n</code></pre>\n\n<p>We can then take a straight transliteration of the expression parser from the <code>chainl</code> docs (I'm too lazy to implement a proper <code>integer</code> parser so we'll just use unary):</p>\n\n<pre><code>parens : Parser a -&gt; Parser a\nparens p = token \"(\" *&gt; p &lt;* token \")\"\n\nsymbol : String -&gt; Parser ()\nsymbol = token\n\ninteger : Parser Nat\ninteger = P $ \\s =&gt; case unpack s of\n     ('Z'::s') =&gt; [(Z, pack s')]\n     ('S'::s') =&gt; map (\\(n, s'') =&gt; (S n, s'')) $ unP integer (pack s')\n     _ =&gt; []\n\nmutual\n    expr : Parser Nat\n    expr = term   `chainl1` addop\n\n    term : Parser Nat\n    term = factor `chainl1` mulop\n\n    factor : Parser Nat\n    factor  = parens expr &lt;|&gt; integer\n\n    mulop : Parser (Nat -&gt; Nat -&gt; Nat)\n    mulop = (symbol \"*\" *&gt; pure (*)) &lt;|&gt;\n            (symbol \"/\" *&gt; pure div)\n\n    addop : Parser (Nat -&gt; Nat -&gt; Nat)\n    addop = (symbol \"+\" *&gt; pure (+)) &lt;|&gt;\n            (symbol \"-\" *&gt; pure (-))\n</code></pre>\n\n<p>Now, if you try this:</p>\n\n<pre><code>main : IO ()\nmain = do\n  s &lt;- getLine\n  printLn $ runParser expr s\n</code></pre>\n\n<p>then it will have the same divergant behaviour that you've observed. However, we can make two small changes:</p>\n\n<ol>\n<li><p>Introduce a lazy alternative combinator:</p>\n\n<pre><code>orElse : Parser a -&gt; Lazy (Parser a) -&gt; Parser a\norElse p1 p2 = P $ \\s =&gt; case unP p1 s of\n   [] =&gt; unP p2 s\n   results =&gt; results\n</code></pre></li>\n<li><p>Make sure the recursive part of <code>factor</code>, i.e. the <code>parens expr</code> part, is in this lazy position, by flipping the two alternatives:</p>\n\n<pre><code>factor = integer `orElse`  parens expr\n</code></pre></li>\n</ol>\n\n<p>This then works as expected:</p>\n\n<pre><code>13:06:07 [cactus@galaxy brainfuck]$ idris Expr.idr -o Expr\n13:06:27 [cactus@galaxy brainfuck]$ echo \"SZ+(SSZ*SSSZ)\" | ./Expr\nJust 7\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5428, "user_id": 482382, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9fe6eecd0900f0e779711f091fec8b3b?s=128&d=identicon&r=PG", "display_name": "Steven Shaw", "link": "https://stackoverflow.com/users/482382/steven-shaw"}, "is_accepted": false, "score": 0, "last_activity_date": 1466144153, "creation_date": 1466144153, "answer_id": 37874403, "question_id": 33441830, "link": "https://stackoverflow.com/questions/33441830/is-there-a-way-to-code-a-chainl-function-in-idris-lightyear-library/37874403#37874403", "title": "Is there a way to code a chainl function in idris lightyear library?", "body": "<p>The <code>chainl</code> and <code>chainl1</code> combinators can be used with the Lightyear package. However, they are provided by default. I've added the combinators to my own modules where I've needed them:</p>\n\n<pre><code>chainl1 : Parser a -&gt; Parser (a -&gt; a -&gt; a) -&gt; Parser a\nchainl1 p op = p &gt;&gt;= rest\n  where rest a1 = (do f &lt;- op\n                      a2 &lt;- p\n                      rest (f a1 a2)) &lt;|&gt; pure a1\n\nchainl : Parser a -&gt; Parser (a -&gt; a -&gt; a) -&gt; a -&gt; Parser a\nchainl p op a = (p `chainl1` op) &lt;|&gt; pure a\n</code></pre>\n\n<p>Seems to work fine. Hope that helps.</p>\n"}], "owner": {"reputation": 2970, "user_id": 2928766, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/3c5d36ca80eccb125ee34991165d481e?s=128&d=identicon&r=PG", "display_name": "Rodrigo Ribeiro", "link": "https://stackoverflow.com/users/2928766/rodrigo-ribeiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 1, "accepted_answer_id": 33448261, "answer_count": 2, "score": 4, "last_activity_date": 1533708070, "creation_date": 1446226684, "last_edit_date": 1533708070, "question_id": 33441830, "link": "https://stackoverflow.com/questions/33441830/is-there-a-way-to-code-a-chainl-function-in-idris-lightyear-library", "title": "Is there a way to code a chainl function in idris lightyear library?", "body": "<p>I'm trying to formalise a regular expression based string search tool in Idris \n(current status <a href=\"https://github.com/rodrigogribeiro/idrisregexp\" rel=\"nofollow\">here</a>). But I'm fighting with the problem of parsing regular expressions. I've tried to build a small parsing library but gave up on this in favor to use <a href=\"https://github.com/ziman/lightyear\" rel=\"nofollow\">Lightyear</a>, a parsing combinator library for Idris.</p>\n\n<p>Since I'm used to Haskell, I've tried to use a similar strategy that I would do using Parsec. My main problem is how to handle left recursion on Lightyear parsers? I've tried several encodings but pretty much all parsers end up looping and causing segmentation faults in generated code.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1446226629, "post_id": 33441599, "comment_id": 54671835, "body": "In the expression <code>do { e &lt;- emails; _ &lt;- deleteEmail e; return e }</code>, the <code>Left &quot;..&quot;</code> part is never used; the IO action producing the result in <code>deleteEmail</code> is run, which is just <code>return</code>, but the value isn&#39;t used so it won&#39;t be evaluated. It is the same as <code>do { e &lt;- emails; _ &lt;- return undefined; return e }</code> This seems like a misunderstanding of how monads &quot;compose&quot;."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 1, "creation_date": 1446242125, "post_id": 33441599, "comment_id": 54679188, "body": "Another thing is that <code>e</code> doesn&#39;t actually refer to a single email, but to the whole list of them. (Only in the list monad do lists get &quot;split&quot; automatically when using <code>&lt;-</code>.) So if you&#39;d given <code>deleteEmail</code> the intended type signature you&#39;d have got a type error from both do expressions."}], "answers": [{"comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 4, "creation_date": 1446227762, "post_id": 33441688, "comment_id": 54672449, "body": "You can use <code>ExceptT</code> in transformers (which is more likely to be a dependency already) instead of <code>EitherT</code>."}, {"owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 0, "creation_date": 1446229822, "post_id": 33441688, "comment_id": 54673515, "body": "Hi Bartek - could you please supplement your answers with some code examples? I&#39;m not familiar with monad transformers. Thanks <b>edit</b> - the third option, <code>throw an exception</code> is not idiomatic, is it?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 1, "creation_date": 1446230095, "post_id": 33441688, "comment_id": 54673651, "body": "@KevinMeredith I certainly prefer <code>ExceptT</code> to <code>throwIO</code> (don&#39;t use <code>throw</code> inside <code>IO</code>!); however there are times when exceptions are just what the doctor ordered, so I don&#39;t think I would endorse &quot;<code>throwIO</code> is not idiomatic&quot;. I might be convinced to endorse &quot;<code>throw</code> is not idiomatic&quot;."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1446230210, "post_id": 33441688, "comment_id": 54673699, "body": "Last time I&#39;ve checked there were at least 7 ways to handle errors in Haskell and I don&#39;t know if any of them was considered &quot;non-idiomatic&quot;"}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1446242520, "post_id": 33441688, "comment_id": 54679348, "body": "<code>fail</code> in the <code>IO</code> monad also ends up throwing an exception, and is somewhat deprecated for other reasons."}], "tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": false, "score": 3, "last_activity_date": 1446226104, "creation_date": 1446226104, "answer_id": 33441688, "question_id": 33441599, "link": "https://stackoverflow.com/questions/33441599/failing-fast-on-io-string/33441688#33441688", "title": "Failing Fast on IO [String]", "body": "<p>There's quite a number of options, but I'd look at three of them, in my order of preference here.</p>\n\n<ul>\n<li>Use <code>EitherT</code> transformer over <code>IO</code> instead of <code>IO (Either a)</code> (you'll need to install <code>either</code> package)</li>\n<li>Use <code>fail</code> from <code>Monad</code> instance of <code>IO</code>.</li>\n<li><code>throw</code> an exception.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 0, "creation_date": 1446257109, "post_id": 33444065, "comment_id": 54682686, "body": "my only reason for using <code>Either ... ()</code> is that <code>...</code> can be an ADT. Using <code>Maybe String</code>&#39;s <code>Nothing</code> case may possibly not provide the amount of meaning as <code>Either</code> (unless <code>Either</code> is used with it). Note - I know that I used <code>String</code>, which isn&#39;t an ADT, though."}], "tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": false, "score": 2, "last_activity_date": 1446235518, "creation_date": 1446235518, "answer_id": 33444065, "question_id": 33441599, "link": "https://stackoverflow.com/questions/33441599/failing-fast-on-io-string/33444065#33444065", "title": "Failing Fast on IO [String]", "body": "<p>As the other answer indicates you can use the <code>ExceptT</code> or <code>EitherT</code> monad transformers. <code>ExceptT</code> represents an <code>Either</code> along with an underlying monad (IO in this case) in which you can evaluate actions using <code>lift</code>. Since <code>EihterT</code> forms a monad (and therefore applicative) you can use <code>sequence_</code> to combine the deletions of all emails and fail on the first failure e.g.</p>\n\n<pre><code>import Control.Monad.Trans.Except\nimport Control.Monad.IO.Class (liftIO)\nimport Data.Foldable (sequence_)\n\ngetEmails :: IO [String]\ngetEmails = return [\"foo@bar.com\", \"bip@bap.net\", \"something@example.com\"]\n\ndeleteEmail :: String -&gt; ExceptT String IO ()\ndeleteEmail email = do\n  liftIO $ putStrLn (\"Deleting \" ++ email)\n  if (isPrefixOf \"bip\" email)\n     then throwE email\n     else return ()\n\ndeleteAllEmails :: [String] -&gt; ExceptT String IO ()\ndeleteAllEmails = sequence_ . map deleteEmail \n\ndoDelete :: [String] -&gt; IO ()\ndoDelete emails = do\n  e &lt;- runExceptT $ deleteAllEmails emails\n  case e of\n    Left err -&gt; putStrLn $ \"Failed: \" ++ err\n    Right _ -&gt; putStrLn \"success!\"\n</code></pre>\n\n<p>You might also want to consider using <code>Maybe String</code> instead of <code>Either String ()</code> and the corresponding <code>MaybeT</code> transformer.</p>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 2, "answer_count": 2, "score": 3, "last_activity_date": 1446235518, "creation_date": 1446225817, "question_id": 33441599, "link": "https://stackoverflow.com/questions/33441599/failing-fast-on-io-string", "title": "Failing Fast on IO [String]", "body": "<p>Given an <code>IO [String]</code> representing a list of emails:</p>\n\n<pre><code>\u03bb: let emails = return [\"foo@bar.com\", \"bip@bap.net\"] :: IO [String]\n</code></pre>\n\n<p>And a function that automatically fails to delete an email:</p>\n\n<pre><code>\u03bb: let deleteEmail email = return $ Left \"failed\" :: IO (Either String ())\n</code></pre>\n\n<p>I then looked at how to, for each email in the list, attempt to delete each email. However, when a single email fails to delete, I'd like to stop, i.e. similar to <code>sequence</code>'s behavior.</p>\n\n<pre><code>\u03bb: do { e &lt;- emails; _ &lt;- deleteEmail e; return e }\n[\"foo@bar.com\",\"bip@bap.net\"]\n\n\u03bb: do { e &lt;- emails; result &lt;- deleteEmail e; return result }\nLeft \"failed\"\n</code></pre>\n\n<p>However, from looking at the first <code>do</code>'s output, when failing to delete <code>foo@bar.com</code>, the <code>do</code> continues to try to delete <code>bip@bap.net</code>.</p>\n\n<p>How can I modify the above code to fail on the first email deletion failure?</p>\n"}, {"tags": ["list", "haskell", "recursion", "functional-programming", "where"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1446224936, "post_id": 33441306, "comment_id": 54670876, "body": "The <code>(:)</code> operator adds <i>one item</i> to the beginning of a list. That&#39;s why <code>1:[2,3,4]</code> is fine, but <code>[1,2]:[3,4]</code> isn&#39;t; you&#39;re trying to add a <i>list</i> to the front."}, {"owner": {"reputation": 383, "user_id": 4847170, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/dffff1120ce7fce426c128efc46bb125?s=128&d=identicon&r=PG&f=1", "display_name": "EasternDude", "link": "https://stackoverflow.com/users/4847170/easterndude"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1446225053, "post_id": 33441306, "comment_id": 54670936, "body": "yes, exactly, my question was about the function i provided. It DOES work, I don&#39;t understand why because it should not."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 3, "creation_date": 1446225230, "post_id": 33441306, "comment_id": 54671047, "body": "If you&#39;re constructing a list <i>of lists</i>, then a list <i>is</i> &quot;one item&quot;. If that makes sense..."}, {"owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 0, "creation_date": 1446226770, "post_id": 33441306, "comment_id": 54671904, "body": "Note you can use <code>1:2:[3, 4, 5]</code> because of right-associativity."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1446229167, "post_id": 33441306, "comment_id": 54673165, "body": "<code>[1,2]:[1,2]:[]</code> should work fine in ghci."}], "answers": [{"comments": [{"owner": {"reputation": 383, "user_id": 4847170, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/dffff1120ce7fce426c128efc46bb125?s=128&d=identicon&r=PG&f=1", "display_name": "EasternDude", "link": "https://stackoverflow.com/users/4847170/easterndude"}, "edited": false, "score": 0, "creation_date": 1446227089, "post_id": 33441444, "comment_id": 54672091, "body": "Alright, a bit clearer now, but still. in a function replicate2 i don&#39;t define anywhere im building a list of lists. if try something like 5:6 in a CHCI it dosen&#39;t automaticaly build a list [5,6] it throws an error. same if i try [1,2]:[3,4] it dosent automaticaly bulild [[1,2],[3,4]]. However in this function im essentially doing this: [1,2]:[1,2]:[] and it returns [[1,2],[1,2]]. Do you undestand what i mean? if you look at replicate2 function it is adding a list to a list   but  not  a list to a list of lists. How does this magic happen?"}, {"owner": {"reputation": 383, "user_id": 4847170, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/dffff1120ce7fce426c128efc46bb125?s=128&d=identicon&r=PG&f=1", "display_name": "EasternDude", "link": "https://stackoverflow.com/users/4847170/easterndude"}, "edited": false, "score": 0, "creation_date": 1446227239, "post_id": 33441444, "comment_id": 54672173, "body": "oh no.. wait, if i check functions type definition with :t it says: replicate2 :: (Num i, Ord i) =&gt; i -&gt; a -&gt; [a] . so its defined to return a list and since im adding lists to THAT list it returns a list of lists? i think i got it."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 383, "user_id": 4847170, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/dffff1120ce7fce426c128efc46bb125?s=128&d=identicon&r=PG&f=1", "display_name": "EasternDude", "link": "https://stackoverflow.com/users/4847170/easterndude"}, "edited": false, "score": 4, "creation_date": 1446230993, "post_id": 33441444, "comment_id": 54674121, "body": "@EasternDude You say: &quot;if I try [1,2]:[3,4] it doesn&#39;t work, but this function is essentially doing [1,2]:[1,2]:[]&quot;. Well, that extra <code>:[]</code> at the end makes all the difference! With <code>[1,2]:[3,4]</code>, you are trying to add the element <code>[1,2]</code> to the list with elements <code>3</code> and <code>4</code>, and <code>[1,2]</code> and <code>3</code> have different types. But with <code>[1,2]:[1,2]:[]</code>, you are first adding the element <code>[1,2]</code> to the list with no elements (hence no type mismatch yet), then adding the element <code>[1,2]</code> to the list with one element, <code>[1,2]</code>. Those have the same type, so there&#39;s no type mismatch."}], "tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": false, "score": 4, "last_activity_date": 1446225267, "creation_date": 1446225267, "answer_id": 33441444, "question_id": 33441306, "link": "https://stackoverflow.com/questions/33441306/adding-something-to-the-beginning-of-a-list-with-operator-in-haskell/33441444#33441444", "title": "Adding something to the beginning of a list with &#39;:&#39; operator in Haskell", "body": "<blockquote>\n  <p>My Question: How does this work? I don't understand why because it should not.</p>\n</blockquote>\n\n<p>You're wrong in that it should not, and you're wrong because you forgot that <code>a</code> might as well mean <code>[a]</code>.</p>\n\n<p>Let's look at some type equations:</p>\n\n<pre><code>[]          :: [a]\n(:)         :: a -&gt; [a] -&gt; [a]\n[1,2,3]     :: [Int]\n0 : [1,2,3] :: [Int]\n</code></pre>\n\n<p>Now with a twist:</p>\n\n<pre><code>[]                 :: [[a]]\n(:)                :: [a] -&gt; [[a]] -&gt; [[a]]\n[[1,2], [3]]       :: [[Int]]\n[0] : [[1,2], [3]] :: [[Int]]\n</code></pre>\n\n<p>A list of lists is <strong>still a list</strong>, of which an element appended by <code>:</code> is... a list.</p>\n"}, {"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 5, "last_activity_date": 1446229223, "last_edit_date": 1446229223, "creation_date": 1446228744, "answer_id": 33442418, "question_id": 33441306, "link": "https://stackoverflow.com/questions/33441306/adding-something-to-the-beginning-of-a-list-with-operator-in-haskell/33442418#33442418", "title": "Adding something to the beginning of a list with &#39;:&#39; operator in Haskell", "body": "<p>Well, let's review some things.  the <strong>principal</strong> (= most general) type of the <code>:</code> operator is this:</p>\n\n<pre><code>(:) :: a -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p><code>a</code> is a type variable.  What this whole thing means is that every time the operator is actually used, the context of its usage determines what type <code>a</code> will stand for in that particular use.  So if you're doing this:</p>\n\n<pre><code>example1 :: [Integer]\nexample1 = 5 : [1, 2]\n</code></pre>\n\n<p>...in that context <code>a</code> is <code>Integer</code>, and if you're doing this:</p>\n\n<pre><code>example2 :: [[Integer]]\nexample2 = [1,2] : [[1,2]]\n</code></pre>\n\n<p>...then in that context <code>a</code> is <code>[Integer]</code>.  So what the type means:</p>\n\n<pre><code>(:) :: a -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>...is that the type <code>a</code> of the value you're putting at the head of the list must be the same as the type of the values that go into that list.  If it's a list whose elements are <code>Integer</code>s then the value must be an <code>Integer</code> as well.  And in the example that's confusing you, we have a <em>list of lists of <code>Integer</code>s</em>, so the first argument of <code>:</code> in that context is a list of <code>Integer</code>.</p>\n\n<p>Haskell is very precise about this, so we could keep going with other examples illustrating the same principle.  Here for example we put a list of lists in front of a list of lists of lists:</p>\n\n<pre><code>example3 :: [[[Integer]]]\nexample3 = [[1, 2], [3, 4]] : [[[1, 2]]]\n-- Value: [[[1, 2], [3, 4]], [[1, 2]]] \n</code></pre>\n\n<p>So going again to the principal type of <code>:</code>:</p>\n\n<pre><code>(:) :: a -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>Another way of looking at it is as a <em>pattern</em> that all of the uses of <code>:</code> must obey: the type of the first argument must have one pair of square brackets fewer than the types of the second argument and the result.  Another thing it tells us is that <code>:</code> doesn't care about what type <code>a</code> may be\u2014it could be a simple value like <code>Integer</code>, or it could be some complex thing like <code>[[[[Integer]]]]</code>, and this function just can't tell the difference.</p>\n"}], "owner": {"reputation": 383, "user_id": 4847170, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/dffff1120ce7fce426c128efc46bb125?s=128&d=identicon&r=PG&f=1", "display_name": "EasternDude", "link": "https://stackoverflow.com/users/4847170/easterndude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3361, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1446238364, "creation_date": 1446224817, "last_edit_date": 1446238364, "question_id": 33441306, "link": "https://stackoverflow.com/questions/33441306/adding-something-to-the-beginning-of-a-list-with-operator-in-haskell", "title": "Adding something to the beginning of a list with &#39;:&#39; operator in Haskell", "body": "<p>I started studying Haskell few days ago, went through the basics and there's a few things left that I can't make sense of. </p>\n\n<p>First of all, \nwhen I try to add something to the beginning of a list with the ':' operator in a GHCi console, it works only if I try to add single literals, but not lists. (<code>5:[1,2,3,4]</code>) would work but (<code>[1,2]:[3,4,5]</code>) would not. However there's this function:</p>\n\n<pre><code>replicate2 n x\n| n &lt;= 0    = []\n| otherwise = x:replicate2 (n-1) x\n</code></pre>\n\n<p>As i understand this how it works recursively, let's call <code>replicate2 2 [1,2]</code>:\nit will slip through the first guard and hence:</p>\n\n<pre><code>= [1,2]:replicate (2-1) [1,2]\n\n= [1,2]:[1,2]:replicate (1-1) [1,2] \n\n -- since n is now 0 it's an edge condition and first guard returns [], so recursion ends and we get:\n\n= [1,2]:[1,2]:[]\n</code></pre>\n\n<p>and the function returns <code>[[1,2],[1,2]]</code></p>\n\n<p>My question: How does this work? Shouldn't Haskell be mad and spit out errors? It does when I try to do that in GHCi.</p>\n"}, {"tags": ["haskell", "functor", "category-theory"], "comments": [{"owner": {"reputation": 1489, "user_id": 2925659, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ifwgn.jpg?s=128&g=1", "display_name": "ruben.moor", "link": "https://stackoverflow.com/users/2925659/ruben-moor"}, "edited": false, "score": 0, "creation_date": 1446228405, "post_id": 33441140, "comment_id": 54672826, "body": "Thanks for all the helpful answers. I selected the most detailed one to be &quot;correct&quot;."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1446231344, "post_id": 33441140, "comment_id": 54674298, "body": "One simple <code>Functor</code> that does not admit <code>pure</code> is <code>data Void a</code>. The instance looks like <code>instance Functor Void where { fmap f x = case x of {} }</code>. (I&#39;m not making this an answer because I don&#39;t think this example is particularly enlightening, even though it answers the only question you actually ask in the body.)"}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1446243429, "post_id": 33441140, "comment_id": 54679650, "body": "@DanielWagner I think that&#39;s up to isomorphism the <i>only</i> <code>Functor</code> that doesn&#39;t admit <code>pure</code>: if you have <i>any</i> value <code>v</code> in the <code>Functor</code> you can define <code>pure x = x &lt;$ v</code>. And I think every choice for <code>pure</code> is of this form, too. Of course this is not usually very unique."}, {"owner": {"reputation": 9111, "user_id": 90088, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c018f213204496b4bbf481e7c8e6c15c?s=128&d=identicon&r=PG", "display_name": "Bartosz Milewski", "link": "https://stackoverflow.com/users/90088/bartosz-milewski"}, "edited": false, "score": 2, "creation_date": 1446315378, "post_id": 33441140, "comment_id": 54696492, "body": "&quot;<i>takes objects in Hask to objects in another category (that of Maybe types and functions defined on Maybe types)</i>&quot; I think you are confusing the codomain and the image. The codomain here is the same as the domain, it&#39;s Hask, so we are talking about an endofunctor. The <i>image</i> of Hask under Maybe is a <i>subset</i> of the codomain -- all the Maybe types. You can easily convince yourself that Maybe doesn&#39;t take you out of Hask because you can apply Maybe multiple times -- Maybe (Mabe a), etc. -- the inner Maybe is still in the domain of Maybe."}, {"owner": {"reputation": 1489, "user_id": 2925659, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ifwgn.jpg?s=128&g=1", "display_name": "ruben.moor", "link": "https://stackoverflow.com/users/2925659/ruben-moor"}, "reply_to_user": {"reputation": 9111, "user_id": 90088, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c018f213204496b4bbf481e7c8e6c15c?s=128&d=identicon&r=PG", "display_name": "Bartosz Milewski", "link": "https://stackoverflow.com/users/90088/bartosz-milewski"}, "edited": false, "score": 0, "creation_date": 1446465177, "post_id": 33441140, "comment_id": 54738897, "body": "@BartoszMilewski You are right, that was my confusion. And it has been clarified by the answers below. Am I supposed to correct my question (does not seem necessary to me)?"}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1475087616, "post_id": 33441140, "comment_id": 66806408, "body": "@&#216;rjanJohansen I disagree with that statement, there are plenty of functors that don&#39;t admit a <code>pure</code>. Here are a couple examples: <code>instance Functor ((,) a)</code> has <code>fmap f (a, b) = (a, f b)</code>, but how would you implement <code>pure</code>? <code>pure x = (error &quot;shit&quot;, x)</code>. If you managed to implement <code>pure</code> you could obtain <code>magic = fst . pure ()</code> <code>magic :: a</code> which is a sort of &quot;proof&quot; that such a <code>pure</code> would inherently involve <code>_|_</code>. (I realize <code>Monoid a =&gt; (,) a</code> admits a <code>pure</code>, but <code>(,) a</code> does not. Another example is <code>instance Functor (Map k)</code>, and yet another is <code>instance Functor (Const m)</code>."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1475258885, "post_id": 33441140, "comment_id": 66887949, "body": "@semicolon I think you have to pick one <code>a</code>: I am making no claim about polymorphic type constructors. If <code>a</code> has a value without bottoms then clearly you have a <code>pure</code> without bottoms too. And if <code>a</code> has no value, then it&#39;s isomorphic to <code>Void</code>. But I see now that laziness complicates matters, since <code>(error &quot;shit&quot;, x)</code> isn&#39;t itself bottom in Haskell. I think for these kinds of questions it is typical to ignore all bottoms (otherwise you could just say <code>pure x = undefined</code> and be done with it), and then I think my claim is still true for any monomorphic example."}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1475266209, "post_id": 33441140, "comment_id": 66891433, "body": "@&#216;rjanJohansen Cool, sure it might be true for any monomorphic example. Too bad that doesn&#39;t matter because a huge amount of functors are not defined in a monomorphic way, and this question is talking about why <code>pure</code> is not in <code>Functor</code>, which it very much SHOULD NOT be. And even examples that are monomorphic don&#39;t necessarily have a &quot;best&quot; default. For example with lists <code>pure 5 :: ZipList Int</code> and <code>pure 5 :: [Int]</code> are very very different, but both crucial for their respective <code>Applicative</code> instances."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "reply_to_user": {"reputation": 9111, "user_id": 90088, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c018f213204496b4bbf481e7c8e6c15c?s=128&d=identicon&r=PG", "display_name": "Bartosz Milewski", "link": "https://stackoverflow.com/users/90088/bartosz-milewski"}, "edited": false, "score": 0, "creation_date": 1480805687, "post_id": 33441140, "comment_id": 69116550, "body": "@Bartosz Is it reasonable to talk about types under <code>Maybe</code> as their own category (a subcategory of Hask, to be sure)? If so the quote is perfectly correct. That&#39;s always how I&#39;ve viewed Haskell Functors, rather than as endofunctors. They <i>can</i> be viewed as endofunctors of course, but because a type constructor always creates new types most endofunctors on Hask are not expressible as Haskell Functors."}], "answers": [{"comments": [{"owner": {"reputation": 1489, "user_id": 2925659, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ifwgn.jpg?s=128&g=1", "display_name": "ruben.moor", "link": "https://stackoverflow.com/users/2925659/ruben-moor"}, "edited": false, "score": 0, "creation_date": 1446225331, "post_id": 33441242, "comment_id": 54671110, "body": "Makes sense ... the arbitrariness in connection with implementing pure is deferred until someone implements Applicative (and at that point a choice must be made)."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "reply_to_user": {"reputation": 1489, "user_id": 2925659, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ifwgn.jpg?s=128&g=1", "display_name": "ruben.moor", "link": "https://stackoverflow.com/users/2925659/ruben-moor"}, "edited": false, "score": 1, "creation_date": 1480800764, "post_id": 33441242, "comment_id": 69115206, "body": "@ruben.moor When you&#39;ve decided how you want to implement <code>&lt;*&gt;</code> in your Applicative, <code>pure</code> isn&#39;t arbitrary anymore: it&#39;s constrained by the applicative laws. Implementing a totally arbitrary <code>pure</code> as part of Functor, where you wouldn&#39;t really have to think about how pure interacts with anything else, could make it easy to accidentally write a <code>pure</code> that doesn&#39;t work for Applicative (or Monad)."}], "tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": false, "score": 3, "last_activity_date": 1446225615, "last_edit_date": 1446225615, "creation_date": 1446224625, "answer_id": 33441242, "question_id": 33441140, "link": "https://stackoverflow.com/questions/33441140/why-is-pure-only-required-for-applicative-and-not-already-for-functor/33441242#33441242", "title": "Why is `pure` only required for Applicative and not already for Functor?", "body": "<p>I'd say that <code>Applicative</code> instance kind of becomes a stretch for <code>Either</code> (which I'd be perfectly fine with just having an instance for <code>Bifunctor</code>, but on the other hand using it as a Monad is convenient), and would (IMHO) be inappropriate for something like:</p>\n\n<pre><code>data ABC a = A a | B a | C a\n</code></pre>\n\n<p>Where all of A,B,C are \"equally OK\". Since there's no obvious choice for which should be used for <code>pure</code>, it shouldn't be provided at all. Having <code>fmap</code> is still perfectly fine, though.</p>\n"}, {"comments": [{"owner": {"reputation": 1489, "user_id": 2925659, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ifwgn.jpg?s=128&g=1", "display_name": "ruben.moor", "link": "https://stackoverflow.com/users/2925659/ruben-moor"}, "edited": false, "score": 0, "creation_date": 1446225389, "post_id": 33441384, "comment_id": 54671136, "body": "Would you agree that the Wikibook article confuses the category morphism with pure, where it says: maps any object A in C to F(A), in D ?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1446226331, "post_id": 33441384, "comment_id": 54671670, "body": "The wikibook article is correct. The <code>f</code> in <code>Functor f</code> maps objects in the category <code>Hask</code> to objects in the category <code>Hask</code>. Note that a Haskell <code>Functor</code> is strictly an endofunctor - its domain and codomain must both be <code>Hask</code>. Then, the function <code>fmap</code> maps morphism in Hask (functions of type <code>a -&gt; b</code>) to morphisms in Hask, specifically to the morphism <code>f a -&gt; f b</code>. In the article, the functor is given type <code>Hask ~&gt; Hask</code>. But note that this arrow isn&#39;t the function arrow - the function arrow takes <i>types</i> to <i>types</i>, not categories to categories."}, {"owner": {"reputation": 1489, "user_id": 2925659, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ifwgn.jpg?s=128&g=1", "display_name": "ruben.moor", "link": "https://stackoverflow.com/users/2925659/ruben-moor"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1446228110, "post_id": 33441384, "comment_id": 54672655, "body": "@user2407038 indeed, now I get it."}], "tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": false, "score": 2, "last_activity_date": 1446227817, "last_edit_date": 1446227817, "creation_date": 1446225091, "answer_id": 33441384, "question_id": 33441140, "link": "https://stackoverflow.com/questions/33441140/why-is-pure-only-required-for-applicative-and-not-already-for-functor/33441384#33441384", "title": "Why is `pure` only required for Applicative and not already for Functor?", "body": "<p>The category Hask has types as objects and functions as arrows, so the object mapping provided by the Functor instance must map types to types.</p>\n\n<p><code>fmap</code> maps the arrows i.e. maps functions <code>a -&gt; b</code> to functions <code>f a -&gt; f b</code> for the functor f. The Functor type constructor is the mapping for objects i.e. between types.</p>\n\n<p>For example the <code>Maybe</code> type constructor maps a type <code>t</code> to the type <code>Maybe t</code> e.g. <code>String</code> to <code>Maybe String</code>.</p>\n\n<p>In contrast, <code>pure</code> maps values of some underlying type to a value of the corresponding applicative type e.g. \"abc\" and (Just \"abc\") are both values of <code>String</code> and <code>Maybe String</code> respectively.</p>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 4, "last_activity_date": 1480798392, "last_edit_date": 1495540049, "creation_date": 1446227447, "answer_id": 33442040, "question_id": 33441140, "link": "https://stackoverflow.com/questions/33441140/why-is-pure-only-required-for-applicative-and-not-already-for-functor/33442040#33442040", "title": "Why is `pure` only required for Applicative and not already for Functor?", "body": "<blockquote>\n  <p>If I get it right, <code>Maybe</code> rather maps <code>C</code> to <code>D</code>. (Thus being a morphism on category level, which might be a requirement for a Functor)</p>\n</blockquote>\n\n<p>Not really, as <code>C</code> and <code>D</code> there are categories, and not Haskell types. A <code>Functor</code> (that is, an instance of the type class, as opposed to a functor in general) is a mapping from the <strong>Hask</strong> category (the category of Haskell types and functions) to <strong>Hask</strong> itself; that is, <code>C</code> and <code>D</code> are both <strong>Hask</strong> in that case. The Wikibook chapter mentions that in the section <em>Functors on Hask</em>. In your example, the <code>Maybe</code> type constructor provides the first part of the mapping by taking some type <code>a</code> (an object in <strong>Hask</strong>) to the type <code>Maybe a</code> (another object in <strong>Hask</strong>).</p>\n\n<blockquote>\n  <p>I guess you could rephrase my question like this: Is there a <code>Functor</code> that does not have an obvious implementation of <code>pure</code>?</p>\n</blockquote>\n\n<p>One example is the pair <code>Functor</code>, <code>(,) a</code>. <code>fmap</code> is easy to write -- <code>\\f (x, y) -&gt; (x, f y)</code> -- but <code>pure</code> and <code>(&lt;*&gt;)</code> require a <code>Monoid</code> constraint on <code>a</code>, as there would be no way of dealing with the extra <code>a</code> values otherwise. For more discussion and other examples, see <a href=\"https://stackoverflow.com/q/7220436/2751851\"><em>Good examples of Not a Functor/Functor/Applicative/Monad?</em></a></p>\n"}, {"tags": [], "owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "is_accepted": true, "score": 15, "last_activity_date": 1446230618, "last_edit_date": 1592644375, "creation_date": 1446227771, "answer_id": 33442135, "question_id": 33441140, "link": "https://stackoverflow.com/questions/33441140/why-is-pure-only-required-for-applicative-and-not-already-for-functor/33442135#33442135", "title": "Why is `pure` only required for Applicative and not already for Functor?", "body": "<p>I think you're getting confused between types and values. Here's the definition of a functor:</p>\n<blockquote>\n<p>Let <em>C</em> and <em>D</em> be <a href=\"https://en.wikipedia.org/wiki/Category_(mathematics)\" rel=\"noreferrer\">categories</a>. A <strong>functor</strong> <em>F</em> from <em>C</em> to <em>D</em> is a mapping that:</p>\n<ul>\n<li><p>associates to each object <em>X \u2208 C</em> an object <em>F(X) \u2208 D</em>.</p>\n</li>\n<li><p>associates to each morphism <em>f : X \u2192 Y \u2208 C</em> a morphism <em>F(f) : F(X) \u2192 F(Y) \u2208 D</em> such that the following conditions hold:</p>\n<ul>\n<li><em>F(id : X \u2192 X) = id : F(X) \u2192 F(X)</em> for every object <em>X \u2208 C</em>.</li>\n<li><em>F(g \u2218 f) = F(g) \u2218 F(f)</em> for all morphisms <em>f : X \u2192 Y</em> and <em>g : Y \u2192 Z</em>.</li>\n</ul>\n</li>\n</ul>\n</blockquote>\n<p>A category consists of objects and morphisms between objects.</p>\n<p>All code in Haskell is a part of <a href=\"https://en.wikibooks.org/wiki/Haskell/Category_theory#Hask.2C_the_Haskell_category\" rel=\"noreferrer\"><em>Hask</em></a>, the Haskell category. In <em>Hask</em>:</p>\n<ol>\n<li>Types are objects.</li>\n<li>Functions are morphisms between types.</li>\n</ol>\n<p>Hence, all <code>Functor</code> instances in Haskell are functors from Hask to Hask (i.e. they are endofunctors).</p>\n<p>To put it more rigorously, for all instances of <code>Functor</code> in Haskell:</p>\n<ol>\n<li><code>C = Hask</code>.</li>\n<li><code>D = Hask</code>.</li>\n</ol>\n<p>Now, each functor <em>F</em> is a mapping that associates to each object <em>X \u2208 C</em> an object <em>F(X) \u2208 D</em>.</p>\n<ol>\n<li>Note that <em>X</em> and <em>F(X)</em> are objects of <em>C</em> and <em>D</em> respectively.</li>\n<li>Since both <em>C</em> and <em>D</em> are <em>Hask</em>, both <em>X</em> and <em>F(X)</em> are types and not values.</li>\n<li>Thus, <em>F : Type \u2192 Type</em> or in Haskell <code>f : * -&gt; *</code>.</li>\n</ol>\n<p>Indeed, this is precisely how the <code>Functor</code> type class is defined in Haskell:</p>\n<pre class=\"lang-hs prettyprint-override\"><code>class Functor (f : * -&gt; *) where\n    fmap :: (x -&gt; y) -&gt; (f x -&gt; f y)\n</code></pre>\n<p>Here, <code>fmap</code> is the second part of the functor. It's a function from values to values. However, the <code>Functor</code> itself is a type constructor (i.e. a mapping from types to types). This is the reason <code>Maybe</code> is a functor and <code>[]</code> is a functor but <code>Maybe Int</code> and <code>[Int]</code> are not functors.</p>\n<p>Note that <code>pure</code> does not form the first part of the functor definition because it's a mapping from an instance of <em>X</em> to an instance of <em>F(X)</em> (i.e. it's a function from values to values). However, we need a mapping from <em>X</em> to <em>F(X)</em> (i.e. a mapping from types to types).</p>\n"}], "owner": {"reputation": 1489, "user_id": 2925659, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/Ifwgn.jpg?s=128&g=1", "display_name": "ruben.moor", "link": "https://stackoverflow.com/users/2925659/ruben-moor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1424, "favorite_count": 6, "closed_date": 1563659879, "accepted_answer_id": 33442135, "answer_count": 4, "score": 12, "last_activity_date": 1480798392, "creation_date": 1446224237, "question_id": 33441140, "link": "https://stackoverflow.com/questions/33441140/why-is-pure-only-required-for-applicative-and-not-already-for-functor", "closed_reason": "Duplicate", "title": "Why is `pure` only required for Applicative and not already for Functor?", "body": "<p>Reading <a href=\"https://en.wikibooks.org/wiki/Haskell/Category_theory\" rel=\"noreferrer\">this Wikibook about Haskell and Category Theory basics</a>, I learn about Functors:</p>\n\n<blockquote>\n  <p>A functor is essentially a transformation between categories, so given\n  categories C and D, a functor F : C -> D</p>\n  \n  <p>maps any object A in C to F(A), in D.</p>\n  \n  <p>maps morphisms f : A -> B in C to F(f) : F(A) -> F(B) in D.</p>\n</blockquote>\n\n<p>... which sounds all nice. Later an example is provided:</p>\n\n<blockquote>\n  <p>Let's have a sample instance, too:</p>\n</blockquote>\n\n<pre><code>instance Functor Maybe where\n  fmap f (Just x) = Just (f x)\n  fmap _ Nothing  = Nothing\n</code></pre>\n\n<blockquote>\n  <p>Here's the key part: the type constructor Maybe takes any type T to a\n  new type, Maybe T. Also, fmap restricted to Maybe types takes a\n  function a -> b to a function Maybe a -> Maybe b. But that's it! We've\n  defined two parts, something that takes objects in Hask to objects in\n  another category (that of Maybe types and functions defined on Maybe\n  types), and something that takes morphisms in Hask to morphisms in\n  this category. So Maybe is a functor.</p>\n</blockquote>\n\n<p>I understand how the definition of <code>fmap</code> is key. I am confused about how the \"type constructor Maybe\" provides the first part. I would have rather expected something like <code>pure</code>.</p>\n\n<p>If I get it right, <code>Maybe</code> rather maps <code>C</code> to <code>D</code>. (Thus being a morphism on category level, which might be a requirement for a Functor)</p>\n\n<p>I guess you could rephrase my question like this: Is there a Functor that does not have an obvious implementation of <code>pure</code>?</p>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 2, "creation_date": 1446220697, "post_id": 33439960, "comment_id": 54668182, "body": "If your function does not return a score how do you expect it to reset the score? If you want to refactor then I suggest you use a State monad.  If, instead, you want to progress incrementally from your current code then consider making <code>updateEnemies :: Score -&gt; [Point] -&gt; (Score, [Point])</code>.  And in the case of a hit you return <code>(0, updateEnemies xs)</code>."}, {"owner": {"reputation": 33, "user_id": 1523869, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fc087f24350b84094f79d1c79a23c8a5?s=128&d=identicon&r=PG", "display_name": "AwesomeUnicorn", "link": "https://stackoverflow.com/users/1523869/awesomeunicorn"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1446220792, "post_id": 33439960, "comment_id": 54668245, "body": "So, what I&#39;m trying to do does not work? I feared as much. Thanks anyways, I&#39;m gonna try something else!"}], "answers": [{"tags": [], "owner": {"reputation": 45741, "user_id": 744178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3193139ea494c45e63752504f5ff1f2?s=128&d=identicon&r=PG", "display_name": "jwodder", "link": "https://stackoverflow.com/users/744178/jwodder"}, "is_accepted": false, "score": 1, "last_activity_date": 1446220720, "creation_date": 1446220720, "answer_id": 33440114, "question_id": 33439960, "link": "https://stackoverflow.com/questions/33439960/changing-variables-inside-a-recursive-function/33440114#33440114", "title": "Changing variables inside a recursive function", "body": "<p>All <code>updateEnemies</code> is really doing is applying <code>nextLocation</code> to each element of the input list and then discarding the ones that <code>hitPlayer</code>.  The main body can thus be reduced to:</p>\n\n<pre><code>updateEnemies xs = filter (not . hitPlayer) $ map nextLocation xs\n</code></pre>\n\n<p>or, if you prefer something more points-free:</p>\n\n<pre><code>updateEnemies = filter (not . hitPlayer) . map nextLocation\n</code></pre>\n\n<p>In addition, defining <code>hitPlayer</code> by using a guard to decide whether to return <code>True</code> or <code>False</code> is just wrong; the equivalent mistake in other languages would be writing <code>if (condition) return true; else return false;</code>.  Just return the result of the test directly!</p>\n\n<pre><code>hitPlayer (x, y) = abs (fst newPosition - x) &lt; 10 &amp;&amp; abs (snd newPosition - y) &lt; 10\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 1523869, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fc087f24350b84094f79d1c79a23c8a5?s=128&d=identicon&r=PG", "display_name": "AwesomeUnicorn", "link": "https://stackoverflow.com/users/1523869/awesomeunicorn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1446220720, "creation_date": 1446220284, "question_id": 33439960, "link": "https://stackoverflow.com/questions/33439960/changing-variables-inside-a-recursive-function", "title": "Changing variables inside a recursive function", "body": "<p>I'm trying to make a game in Haskell. Right now, I'm working on enemy collision: that is, if an enemy collides with the player, the score gets reset to 0 and the enemy dies. However, I just can't quite work out <em>how</em>.</p>\n\n<p>I've already considered a <code>do</code> block but that's not right (I don't want to return IO). I can't find anything to point me in the right direction, leaving me to wonder if it's even possible...</p>\n\n<p>The (kind of ugly) piece of code I have is this:</p>\n\n<pre><code>newEnemies = updateEnemies enemies\n    updateEnemies :: [Point] -&gt; [Point]\n    updateEnemies [] = []\n    updateEnemies (x:xs) | hitPlayer (nextLocation x) = -- TODO: Reset multipliers\n                                                        updateEnemies xs\n                         | otherwise = nextLocation x : updateEnemies xs\n        where\n        hitPlayer :: Point -&gt; Bool\n        hitPlayer (x, y) | abs (fst newPosition - x) &lt; 10 &amp;&amp; abs (snd newPosition - y) &lt; 10\n                            = True\n                         | otherwise = False\n        nextLocation loc = (loc + ((dirToPlayer loc) * (100, 100) * (timeStep, timeStep)))\n        dirToPlayer loc = normalizeV (playerPosition - loc)\n</code></pre>\n\n<p>Can one of you point me in the right direction, or am I just too used to imperative languages?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell", "oz"], "answers": [{"comments": [{"owner": {"reputation": 25370, "user_id": 107158, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/05243b2e0495d108111d1bb6711b1377?s=128&d=identicon&r=PG", "display_name": "Derek Mahar", "link": "https://stackoverflow.com/users/107158/derek-mahar"}, "edited": false, "score": 0, "creation_date": 1446226397, "post_id": 33439693, "comment_id": 54671714, "body": "Can a Haskell program bind an <code>MVar</code> to a value (assign a value to the variable) after it the program declares the variable?  I call this <i>lazy binding</i> or <i>lazy assignment</i> (or <i>deferred</i> binding or assignment)."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 25370, "user_id": 107158, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/05243b2e0495d108111d1bb6711b1377?s=128&d=identicon&r=PG", "display_name": "Derek Mahar", "link": "https://stackoverflow.com/users/107158/derek-mahar"}, "edited": false, "score": 1, "creation_date": 1446226549, "post_id": 33439693, "comment_id": 54671799, "body": "@DerekMahar This is kind of the point of MVars, but i am not sure if that was a good example"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 25370, "user_id": 107158, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/05243b2e0495d108111d1bb6711b1377?s=128&d=identicon&r=PG", "display_name": "Derek Mahar", "link": "https://stackoverflow.com/users/107158/derek-mahar"}, "edited": false, "score": 1, "creation_date": 1446228328, "post_id": 33439693, "comment_id": 54672781, "body": "@DerekMahar No. There is no way to initialize/declare a variable without defining it."}, {"owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "edited": false, "score": 0, "creation_date": 1446255153, "post_id": 33439693, "comment_id": 54682360, "body": "The code example given here does not actually use <code>MVar</code>s (although if you&#39;re only using one thread I guess it&#39;s equivalent)"}], "tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": false, "score": 4, "last_activity_date": 1446219418, "creation_date": 1446219418, "answer_id": 33439693, "question_id": 33439603, "link": "https://stackoverflow.com/questions/33439603/does-haskell-support-unbound-variables/33439693#33439693", "title": "Does Haskell support unbound variables?", "body": "<p>Haskell only supports <em>variables</em> in terms of values in (monadic) contexts. Once you look at those,  there are certain ones like <code>MVar</code> which can indeed be empty.</p>\n\n<p>If you want to represent simple nullability of a value, though, <code>Maybe a</code> is a perfect way to do that, separate from the actual value being a reference to something mutable or just an immutable something.</p>\n\n<hr>\n\n<p>To expand and illustrate:</p>\n\n<pre><code>newIORef :: a -&gt; IO (IORef a)\n</code></pre>\n\n<p>But we can easily write <code>newEmptyIORef</code> as such:</p>\n\n<pre><code>newEmptyIORef :: IO (IORef (Maybe a))\nnewEmptyIORef = newIORef Nothing\n</code></pre>\n\n<p>Take note that <code>Maybe (IORef a) \u2260 IORef (Maybe a)</code>.</p>\n"}], "owner": {"reputation": 25370, "user_id": 107158, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/05243b2e0495d108111d1bb6711b1377?s=128&d=identicon&r=PG", "display_name": "Derek Mahar", "link": "https://stackoverflow.com/users/107158/derek-mahar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1446219418, "creation_date": 1446219094, "question_id": 33439603, "link": "https://stackoverflow.com/questions/33439603/does-haskell-support-unbound-variables", "title": "Does Haskell support unbound variables?", "body": "<p>Does <a href=\"https://www.haskell.org/\" rel=\"nofollow\">Haskell</a> support the concept of <a href=\"http://strasheela.sourceforge.net/strasheela/doc/01-Basics.html#sec20\" rel=\"nofollow\"><em>unbound variables</em></a> as in the <a href=\"https://en.wikipedia.org/wiki/Oz_%28programming_language%29\" rel=\"nofollow\">Oz programming language</a>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1446216783, "post_id": 33438747, "comment_id": 54665603, "body": "<code>(+)</code> and <code>(*)</code> both have type <code>Num a =&gt; a -&gt; a -&gt; a</code> so they have to return the same type. You can&#39;t convert from <code>a</code> to any numeric type."}], "answers": [{"tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": true, "score": 5, "last_activity_date": 1446217991, "last_edit_date": 1446217991, "creation_date": 1446217636, "answer_id": 33439095, "question_id": 33438747, "link": "https://stackoverflow.com/questions/33438747/ghc-is-complaining-type-mismatch-when-using-typeclass/33439095#33439095", "title": "GHC is complaining type mismatch when using typeclass.", "body": "<p>The problem is that the type signature</p>\n\n<pre><code>dot :: Num b =&gt; a -&gt; a -&gt; b\n</code></pre>\n\n<p>means that <code>dot</code> needs to be able to return <em>any</em> numeric type, regardless what the vector type is, while the expression <code>x1*x2 + y1*y2</code> will only return the type that was put into the vectors.</p>\n\n<p>To fix that you can use a type family to connect a single scalar type to each vector type:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n\nclass Vector a where\n    type ScalarOf a\n    add, minus, cross :: a -&gt; a -&gt; a\n    dot :: a -&gt; a -&gt; ScalarOf a\n\ndata Vector2D a = Vector2D a a deriving (Read)\n\ninstance Num a =&gt; Vector (Vector2D a) where\n    type ScalarOf (Vector2D a) = a\n    add (Vector2D x1 y1) (Vector2D x2 y2) = Vector2D (x1 + x2) (y1 + y2)\n    minus (Vector2D x1 y1) (Vector2D x2 y2) = Vector2D (x1 - x2) (y1 - y2)\n    dot (Vector2D x1 y1) (Vector2D x2 y2) = x1*x2 + y1*y2\n</code></pre>\n\n<p>An alternative method is to use a multiparameter type class, probably with a functional dependency.</p>\n\n<p>I also want to mention that <code>cross</code> products essentially only make sense for 3-dimensional vectors. (I've heard that you <em>can</em> make them work for 7 dimensions, or trivially for 1.)</p>\n"}], "owner": {"reputation": 33, "user_id": 5507168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fd11bb06603a4aa671db1ba115af5fb?s=128&d=identicon&r=PG&f=1", "display_name": "Jazzon", "link": "https://stackoverflow.com/users/5507168/jazzon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 33439095, "answer_count": 1, "score": 3, "last_activity_date": 1446217991, "creation_date": 1446216552, "question_id": 33438747, "link": "https://stackoverflow.com/questions/33438747/ghc-is-complaining-type-mismatch-when-using-typeclass", "title": "GHC is complaining type mismatch when using typeclass.", "body": "<p>I don't see why 'dot' part will not work.</p>\n\n<pre><code>class Vector a where\n    add, minus, cross :: a -&gt; a -&gt; a\n    dot :: Num b =&gt; a -&gt; a -&gt; b\n\ndata Vector2D a = Vector2D a a deriving (Read)\n\ninstance Num a =&gt; Vector (Vector2D a) where\n    add (Vector2D x1 y1) (Vector2D x2 y2) = Vector2D (x1 + x2) (y1 + y2)\n    minus (Vector2D x1 y1) (Vector2D x2 y2) = Vector2D (x1 - x2) (y1 - y2)\n    dot (Vector2D x1 y1) (Vector2D x2 y2) = x1*x2 + y1*y2\n</code></pre>\n\n<p>The error message is:</p>\n\n<pre><code>Couldn't match expected type \u2018b\u2019 with actual type \u2018a\u2019\n  \u2018a\u2019 is a rigid type variable bound by\n      the instance declaration at example.hs:9:10\n  \u2018b\u2019 is a rigid type variable bound by\n      the type signature for\n        dot :: Num b =&gt; Vector2D a -&gt; Vector2D a -&gt; b\n      at example.hs:12:3\nRelevant bindings include\n  y2 :: a (bound at example.hs:12:37)\n  x2 :: a (bound at example.hs:12:34)\n  y1 :: a (bound at example.hs:12:20)\n  x1 :: a (bound at example.hs:12:17)\n  dot :: Vector2D a -&gt; Vector2D a -&gt; b (bound at example.hs:12:3)\nIn the first argument of \u2018(*)\u2019, namely \u2018x1\u2019\nIn the first argument of \u2018(+)\u2019, namely \u2018x1 * x2\u2019\n</code></pre>\n\n<p>I look at the type of dot and it is <code>dot :: (Num b, Vector a) =&gt; a -&gt; a -&gt; b</code>. How can I make it right?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 6160, "user_id": 576843, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb18ee7a61b1c6e5bc4d18445377f333?s=128&d=identicon&r=PG", "display_name": "farnoy", "link": "https://stackoverflow.com/users/576843/farnoy"}, "edited": false, "score": 0, "creation_date": 1446731775, "post_id": 33439111, "comment_id": 54872378, "body": "For some reason I thought it worked by substitution, thanks for clearing this up!"}], "tags": [], "owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "is_accepted": true, "score": 4, "last_activity_date": 1446219247, "last_edit_date": 1446219247, "creation_date": 1446217688, "answer_id": 33439111, "question_id": 33435903, "link": "https://stackoverflow.com/questions/33435903/evaluating-free-monads-with-except-transformer/33439111#33439111", "title": "Evaluating Free Monads with Except transformer", "body": "<p>When building an <code>FT TestFunctor (Except Int)</code>, the <code>catchError</code> happens before you can even start interpreting it with <code>runTest</code>. If we temporarily switch to <code>FreeT</code> we can see what's going on. We are going to evaluate all of the following:</p>\n\n<pre><code>            throwError 0                      :: FreeT TestFunctor (Except Int) ()\ncatchError (throwError 0) (const $ pure ())   :: FreeT TestFunctor (Except Int) ()\n            liftF $ Test ()                   :: FreeT TestFunctor (Except Int) ())\ncatchError (liftF $ Test ()) (const $ pure () :: FreeT TestFunctor (Except Int) ())\n</code></pre>\n\n<p>When we throw an error we get the error wrapped in <code>FreeT</code>.</p>\n\n<pre><code>&gt;             throwError 0                      :: FreeT TestFunctor (Except Int) ()\nFreeT (ExceptT (Identity (Left 0)))\n</code></pre>\n\n<p>Catching the error replaces it in the free tree</p>\n\n<pre><code>&gt; catchError (throwError 0) (const $ pure ())   :: FreeT TestFunctor (Except Int) ()\nFreeT (ExceptT (Identity (Right (Pure ()))))\n</code></pre>\n\n<p>On the other hand, when we <code>liftF</code> <code>Test ()</code> it is returned to the <code>Right</code> in <code>ExceptT</code>, as is the <code>()</code> it holds.</p>\n\n<pre><code>&gt;             liftF $ Test ()                   :: FreeT TestFunctor (Except Int) ())\nFreeT (ExceptT (Identity (Right (Free (Test (FreeT (ExceptT (Identity (Right (Pure ()))))))))))\n                          | The one above is a return, the one below is a throw\nFreeT (ExceptT (Identity (Left 0)))\n</code></pre>\n\n<p>When you <code>catchError</code>s on this, it doesn't do anything, it was already successful.</p>\n\n<pre><code>&gt; catchError (liftF $ Test ()) (const $ pure () :: FreeT TestFunctor (Except Int) ())\nFreeT (ExceptT (Identity (Right (Free (Test (FreeT (ExceptT (Identity (Right (Pure ()))))))))))\n</code></pre>\n\n<h3>Add the operations to the tree</h3>\n\n<p>If you want to throw and catch errors in the evaluation of the free tree, add the throw and catch operations to what your functor can represent.</p>\n\n<pre><code>data ExceptOp e a\n  = Throw e\n  | Catch a (e -&gt; a)\n  deriving (Functor)\n</code></pre>\n\n<p>To interpret an operation that supports throwing and catching exceptions, we replace <code>Throw</code> with <code>throwError</code> and <code>Catch</code> with <code>catchError</code></p>\n\n<pre><code>runTest :: FT (ExceptOp Int) Identity a -&gt; Either Int a\nrunTest = runIdentity . runExceptT . iterTM evalExcept\n\nevalExcept :: (Monad m) =&gt; ExceptOp e (ExceptT e m a) -&gt; ExceptT e m a\nevalExcept (Throw e) = throwError e\nevalExcept (Catch next f) = catchError next f\n</code></pre>\n\n<p>This catches the exception when we evaluate it</p>\n\n<pre><code>&gt; runTest (wrap $ Catch (liftF $ Throw 0) (const $ pure ()))\nRight ()\n</code></pre>\n"}], "owner": {"reputation": 6160, "user_id": 576843, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb18ee7a61b1c6e5bc4d18445377f333?s=128&d=identicon&r=PG", "display_name": "farnoy", "link": "https://stackoverflow.com/users/576843/farnoy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 2, "accepted_answer_id": 33439111, "answer_count": 1, "score": 2, "last_activity_date": 1446219247, "creation_date": 1446207798, "question_id": 33435903, "link": "https://stackoverflow.com/questions/33435903/evaluating-free-monads-with-except-transformer", "title": "Evaluating Free Monads with Except transformer", "body": "<p>I'm trying to add exception handling to my free monad, but I can't catch anything that's thrown from the evaluator. So far, I added Except the same way I have other transformers:</p>\n\n<pre><code>data TestFunctor a = Test a deriving(Functor)\n\nrunTest :: FT TestFunctor (Except Int) a -&gt; Either Int a\nrunTest = runIdentity . runExceptT . iterT evalTest\n\nevalTest :: TestFunctor (Except Int a) -&gt; Except Int a\nevalTest (Test next) = throwError 2 *&gt; next\n</code></pre>\n\n<p>But when running it:</p>\n\n<pre><code>&gt; runTest (catchError (throwError 0) (const $ pure ()))\nRight ()\n&gt; runTest (catchError (liftF $ Test ()) (const $ pure ()))\nLeft 2\n</code></pre>\n\n<p>Is there a way to allow expressions in the free monad catch errors from the evaluator?</p>\n\n<p>I'm using the <code>Control.Monad.Trans.Free.Church</code> module.</p>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 3, "creation_date": 1446184860, "post_id": 33429568, "comment_id": 54647625, "body": "it will not break the code but it will break the laws: you can try yourself with <code>State (fromList [&quot;A&quot;]) (fromList [&quot;B&quot;])</code> and <code>State (fromList [&quot;B&quot;]) (fromList [&quot;A&quot;])</code> - I think those are now <code>==</code> and <code>&lt;</code> ..."}, {"owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "edited": false, "score": 0, "creation_date": 1446255541, "post_id": 33429568, "comment_id": 54682424, "body": "If you have an <code>Ord</code> instance, you need an <code>Eq</code> instance. But you can have <code>Eq</code> instances without any <code>Ord</code> instance. Also: if you end up using this data type together with the <code>State</code> monad you will have to either import one of them qualified or rename your one."}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 9, "last_activity_date": 1446185279, "creation_date": 1446185279, "answer_id": 33429708, "question_id": 33429568, "link": "https://stackoverflow.com/questions/33429568/do-i-need-custom-ord-instance-if-i-have-custom-eq/33429708#33429708", "title": "do I need custom Ord instance if I have custom Eq?", "body": "<p>as I said in my comment you break the <code>Ord</code> laws here:</p>\n\n<pre><code>a :: State\na = State (Set.fromList [\"A\"]) (Set.fromList [\"B\"])\n\nb :: State\nb = State (Set.fromList [\"B\"]) (Set.fromList [\"A\"])     \n</code></pre>\n\n<p>as now <code>a == b</code> and also <code>a &lt; b</code>:</p>\n\n<pre><code>\u03bb&gt; a == b\nTrue\n\u03bb&gt; a &lt; b\nTrue\n\u03bb&gt; b &lt; a\nFalse\n</code></pre>\n\n<p>see: <code>Ord</code> is supposed to be a <a href=\"https://en.wikipedia.org/wiki/Total_order\">total order</a> and one law for those is</p>\n\n<blockquote>\n  <p>a &lt; b if and only if a \u2264 b and a \u2260 b</p>\n</blockquote>\n\n<p>so of course you should fix it with the obvious choice for your own instance:</p>\n\n<pre><code>instance Ord State where\n  (State s0 s1) &lt;= (State s0' s1') =\n    Set.union s0 s1 &lt;= Set.union s0' s1'\n\n\u03bb&gt; a == b\nTrue\n\u03bb&gt; b &lt; a\nFalse\n\u03bb&gt; a &lt; b\nFalse\n</code></pre>\n"}], "owner": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 1, "accepted_answer_id": 33429708, "answer_count": 1, "score": 4, "last_activity_date": 1446190013, "creation_date": 1446184623, "last_edit_date": 1446190013, "question_id": 33429568, "link": "https://stackoverflow.com/questions/33429568/do-i-need-custom-ord-instance-if-i-have-custom-eq", "title": "do I need custom Ord instance if I have custom Eq?", "body": "<p>I had a data type that used to derive generic <code>Eq</code> and <code>Ord</code>:</p>\n\n<pre><code>data State = State (Set String) (Set String) deriving (Eq, Ord)\n</code></pre>\n\n<p>Then I created my own instance of <code>Eq</code>:</p>\n\n<pre><code>data State = State (Set String) (Set String) deriving Ord\n\ninstance Eq State where\n    (State s0 s1) == (State s0' s1') =\n        Set.union s0 s1 == Set.union s0' s1'\n</code></pre>\n\n<p>I am not sure if this breaks the <code>Ord</code> behavior and whether I need to create an instance of <code>Ord</code> too. Could someone please clarify?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1446164471, "post_id": 33426865, "comment_id": 54642826, "body": "What did you try and what problems are you facing ?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 2, "creation_date": 1446165448, "post_id": 33426865, "comment_id": 54643092, "body": "How about: <code>partialSum xs = scanl (+) 0 xs</code>? or maybe drop the first element (which will always be 0)"}, {"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 0, "creation_date": 1446169047, "post_id": 33426865, "comment_id": 54643975, "body": "You last case seems strange..."}], "answers": [{"comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 7, "creation_date": 1446181415, "post_id": 33427203, "comment_id": 54646577, "body": "You don&#39;t need the <code>drop</code>, use <code>scanl1 (+)</code>."}, {"owner": {"reputation": 79, "user_id": 4664868, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HHivQ.jpg?s=128&g=1", "display_name": "Alice", "link": "https://stackoverflow.com/users/4664868/alice"}, "edited": false, "score": 0, "creation_date": 1446213084, "post_id": 33427203, "comment_id": 54663211, "body": "What if I can&#39;t use scanl? I need a method without scanl"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1447185302, "post_id": 33427203, "comment_id": 55050870, "body": "<code>parts [] = []; parts (x:xs) = x:g x xs where { g x [] = []; g x (y:ys) = let z=x+y in z:g z ys }</code>. Also, <code>parts xs = snd $ Data.List.mapAccumL (\\a x-&gt; (a+x,a+x)) 0 xs</code>."}], "tags": [], "owner": {"reputation": 869, "user_id": 2029548, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f44dcf3e58fcd22cd857cd563402178?s=128&d=identicon&r=PG", "display_name": "obadz", "link": "https://stackoverflow.com/users/2029548/obadz"}, "is_accepted": true, "score": 7, "last_activity_date": 1446227399, "last_edit_date": 1446227399, "creation_date": 1446166198, "answer_id": 33427203, "question_id": 33426865, "link": "https://stackoverflow.com/questions/33426865/partialsum-in-haskell/33427203#33427203", "title": "partialSum in haskell", "body": "<pre><code>partialSum :: Num a =&gt; [a] -&gt; [a]\npartialSum = drop 1 . scanl (+) 0\n\n\u03bb&gt; take 10 $ partialSum [1..]\n[1,3,6,10,15,21,28,36,45,55]\n</code></pre>\n\n<p><strong>EDIT:</strong> OP requested a version without <code>scanl</code>:</p>\n\n<pre><code>partialSum :: Num a =&gt; [a] -&gt; [a]\npartialSum (x:xs) = x : map (+ x) (partialSum xs)\npartialSum []     = []\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 4664868, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/HHivQ.jpg?s=128&g=1", "display_name": "Alice", "link": "https://stackoverflow.com/users/4664868/alice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 354, "favorite_count": 0, "accepted_answer_id": 33427203, "answer_count": 1, "score": 1, "last_activity_date": 1446227399, "creation_date": 1446163757, "last_edit_date": 1446205640, "question_id": 33426865, "link": "https://stackoverflow.com/questions/33426865/partialsum-in-haskell", "title": "partialSum in haskell", "body": "<p>I need to compute the partial sums of a list in haskell. Any ideas of how can I do that?</p>\n\n<p>if I have</p>\n\n<pre><code>partialSum (1:3:5:[]) =&gt; (1:4:9:[])\npartialSum [] =&gt; []\npartialSum (from 1) =&gt; 1:3:6:10:...\n</code></pre>\n"}, {"tags": ["haskell", "compatibility", "ghc", "bytecode", "software-distribution"], "comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 2, "creation_date": 1446181764, "post_id": 33425538, "comment_id": 54646671, "body": "As I recall, GHC doesn&#39;t have any way to read those intermediate languages back in from a file. And they aren&#39;t entirely stable either, e.g. Core is set to change big in 8.0."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 1, "creation_date": 1446188419, "post_id": 33425538, "comment_id": 54649091, "body": "aha; but &quot;not entirely stable&quot; seems much better that &quot;entirely not stable&quot; :)"}], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1446160872, "creation_date": 1446156806, "last_edit_date": 1495542230, "question_id": 33425538, "link": "https://stackoverflow.com/questions/33425538/distribute-proprietary-closed-source-haskell-lib-using-stg", "title": "Distribute proprietary/closed source Haskell lib using STG", "body": "<p>Having read questions such as <a href=\"https://stackoverflow.com/questions/26454451/proprietary-haskell-library\">Proprietary Haskell Library</a> and considering GHC completely lacks binary compatibility between even minor versions, I'm wondering would it be possible to use STG (or Core or similar) as a means to distribute obfuscated (i.e. \"almost binary\") proprietary libraries that can then be compiled to machine code at the final stage?</p>\n\n<p>I'm aware STG was not designed for this, but the idea seems neat in a way. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1446155483, "post_id": 33425020, "comment_id": 54639554, "body": "What are <code>Expr</code>, <code>Env</code>, and <code>Val</code>?"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1446190144, "post_id": 33425020, "comment_id": 54649796, "body": "you are using a lot of refundant parentheses."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1446156947, "creation_date": 1446156947, "answer_id": 33425575, "question_id": 33425020, "link": "https://stackoverflow.com/questions/33425020/check-the-type-of-a-variable-in-haskell-script/33425575#33425575", "title": "Check the type of a variable in Haskell script", "body": "<p>I don't have the definition of <code>Val</code>, so I have to guess here:</p>\n\n<pre><code>case (valLhs, valRhs) of\n     (IntVal i1, IntVal i2)       -&gt; IntVal $ i1 + i2\n     (StringVal s1, StringVar s2) -&gt; ...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4742, "user_id": 955926, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/5313fc53e1b61d0e45bf11c5bd3608a4?s=128&d=identicon&r=PG", "display_name": "Gary Fixler", "link": "https://stackoverflow.com/users/955926/gary-fixler"}, "is_accepted": false, "score": 1, "last_activity_date": 1446158190, "last_edit_date": 1446158190, "creation_date": 1446157203, "answer_id": 33425637, "question_id": 33425020, "link": "https://stackoverflow.com/questions/33425020/check-the-type-of-a-variable-in-haskell-script/33425637#33425637", "title": "Check the type of a variable in Haskell script", "body": "<p>Here's an example of mixed types being evaluated using simple pattern-matching. It's not an exact answer to your question, but maybe it'll help you.</p>\n\n<pre><code>data Expr a = I Int\n            | S String\n            | V a\n            | Plus (Expr a) (Expr a)\n            deriving (Show)\n\ntype Env a = a -&gt; Maybe (Expr a)\n\neval :: Env a -&gt; Expr a -&gt; Expr a\neval _ (I x) = I x\neval _ (S s) = S s\neval _ (Plus (I x) (I y)) = I (x + y)\neval _ (Plus (S x) (S y)) = S (x ++ y)\neval e (Plus (V v) y) = eval e (Plus (eval e (V v)) y)\neval e (Plus x (V v)) = eval e (Plus x (eval e (V v)))\neval _ (Plus _ _) = undefined\neval e (V v) = case e v of Just x -&gt; x\n                           Nothing -&gt; undefined\n\nenv :: Char -&gt; Maybe (Expr Char)\nenv 'a' = Just (I 7)\nenv 'b' = Just (I 5)\nenv 'c' = Just (S \"foo\")\nenv 'd' = Just (S \"bar\")\nenv _   = Nothing\n</code></pre>\n"}], "owner": {"reputation": 27, "user_id": 5504978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d688ce440c42c788e46ede420b7ab9?s=128&d=identicon&r=PG&f=1", "display_name": "NoName", "link": "https://stackoverflow.com/users/5504978/noname"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 322, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1446158190, "creation_date": 1446154450, "question_id": 33425020, "link": "https://stackoverflow.com/questions/33425020/check-the-type-of-a-variable-in-haskell-script", "title": "Check the type of a variable in Haskell script", "body": "<p>I'm writing a basic Haskell interpreter and there is the following usecase:\nthere are 2 variables, var1 and var2.</p>\n\n<pre><code>if( (typeOf var1 is Integer) and (typeOf var2 is Integer) ) then var1 + var2;\n\nif( (typeOf var1 is String) and (typeOf var2 is String) ) then concatenate var1 to var2;\n</code></pre>\n\n<p>How can I write it in Haskell? </p>\n\n<p>There's a part of the code:</p>\n\n<pre><code>evaluate:: Expr -&gt; Env -&gt; Val\nevaluate expr env = \n  trace(\"expr= \" ++ (show expr) ++ \"\\n env= \" ++ (show env)) $\n  case expr of\n  Const v -&gt; v\n  lhs :+: rhs -&gt; \n    let valLhs = evaluate lhs env\n        valRhs = evaluate rhs env\n    in case () of\n     _ | &lt;both are Integer&gt; -&gt;(IntVal $ (valToInteger valLhs) + (valToInteger valRhs))\n       | &lt;both are String&gt;  -&gt; (StringVal $ (valToString valLhs) ++ (valToString valRhs))\n       | otherwise....\n</code></pre>\n"}, {"tags": ["haskell", "lazy-evaluation"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1446150538, "post_id": 33423827, "comment_id": 54637197, "body": "<code>seq</code> will not introduce segfaults unless there were <i>already</i> segfaults there. Are you sure the problem is <i>actually</i> a segfault, or are you using that term to mean something other than the usual meaning? Is it possible that it is <code>freeFile</code> that is segfaulting? (I note that the two you claim don&#39;t segfault also don&#39;t execute <code>freeFile</code> -- despite how it may look to the untrained eye!) Also, unless you&#39;re using the badly-named lazy IO somewhere (e.g. <code>readFile</code> or <code>unsafeInterleaveIO</code>), there&#39;s no need to force <code>x</code> at all."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1446150768, "post_id": 33423827, "comment_id": 54637326, "body": "Also, I suspect that you may have misunderstood the note on <code>seq</code>. Do note carefully the distinction between <i>evaluating</i> an <code>IO</code> action -- that is, figuring out what IO to do, specifically -- and <i>executing</i> the action -- that is, performing the actual IO. The comment is talking about evaluation only; you may want to read it again carefully with this distinction in mind!"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 4, "creation_date": 1446150875, "post_id": 33423827, "comment_id": 54637384, "body": "I believe that <code>x `seq` freeFile fid `seq` return x</code> does not free the file, <code>seq</code>ing an IO action does not run it - this expression says &quot;evaluate <code>x</code> and <code>freeFile fid</code> to WHNF before returning <code>return x</code>&quot; - but, evaluating an IO action does not &#39;execute&#39; it."}, {"owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1446151041, "post_id": 33423827, "comment_id": 54637462, "body": "@DanielWagner, it&#39;s segmentation fault in every case (except for the last one). If I run it in GHCi without <code>freeFile</code> in <code>execGetter</code> I can get the data in REPL, then manually call <code>freeFile</code> and everything works correctly. My idea now is that functions that <code>runGetter</code> uses internally should not be pure because they depend on existing <code>fid</code> which can in principle be the same for different objects during the same program run (it&#39;s kinda void pointer internally)."}, {"owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1446151214, "post_id": 33423827, "comment_id": 54637556, "body": "@DanielWagner, user2407038, good point."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1446152472, "post_id": 33423827, "comment_id": 54638181, "body": "What is the code for <code>newFile</code> and <code>freeFile</code> / where does it come from?"}], "answers": [{"comments": [{"owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "edited": false, "score": 4, "creation_date": 1446152673, "post_id": 33424248, "comment_id": 54638280, "body": "Thinking about it I come to conclusion that everything that can be broken by order of <i>execution</i> should never leave <code>IO</code>, so my approach to lower level functions was wrong (that&#39;s my first bindings project). I&#39;ll try to correct my mistakes and then report here and probably accept your answer (I&#39;m sure the second case you&#39;re describing is what actually happening.)"}, {"owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "edited": false, "score": 4, "creation_date": 1446153536, "post_id": 33424248, "comment_id": 54638690, "body": "Yeah, elimination of <code>unsafePerformIO</code> solves it. I have to say that this doesn&#39;t affect high-level API at all."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "reply_to_user": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "edited": false, "score": 1, "creation_date": 1446350973, "post_id": 33424248, "comment_id": 54704630, "body": "@Mark Such is the way of haskell. The correct answer is often natural."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 9, "last_activity_date": 1446151462, "creation_date": 1446151462, "answer_id": 33424248, "question_id": 33423827, "link": "https://stackoverflow.com/questions/33423827/how-to-properly-force-evaluation-of-pure-value-in-io-monad/33424248#33424248", "title": "How to properly force evaluation of pure value in IO monad?", "body": "<p>One possible problem is that <code>newFile</code> is doing some lazy IO, and that <code>runGetter</code> is a sufficiently lazy consumer that running <code>seq</code> on its output does not force all of <code>newFile</code>'s IO to actually happen. This can be fixed by using <code>deepseq</code> instead of <code>seq</code>:</p>\n\n<pre><code>execGetter :: NFData a =&gt; FilePath -&gt; TagGetter a -&gt; IO a\nexecGetter path g = do\n  fid &lt;- newFile path\n  let x = runGetter g fid\n  x `deepseq` freeFile fid\n  return x\n</code></pre>\n\n<p>Another possibility that this will address is that <code>runGetter</code> is claiming to be pure, but actually isn't (and is a lazy producer). However, if that's the case, the correct fix is not to use <code>deepseq</code> here, but to eliminate the uses of <code>unsafePerformIO</code> from <code>runGetter</code>, then use:</p>\n\n<pre><code>execGetter :: FilePath -&gt; TagGetter a -&gt; IO a\nexecGetter path g = do\n  fid &lt;- newFile path\n  x &lt;- runGetter g fid\n  freeFile fid\n  return x\n</code></pre>\n\n<p>which should then work without further fiddling with forcing.</p>\n"}, {"comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1446529291, "post_id": 33447267, "comment_id": 54768595, "body": "Or shortly <code>evalList = foldl const ()</code>."}], "tags": [], "owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "is_accepted": false, "score": 0, "last_activity_date": 1446529200, "last_edit_date": 1446529200, "creation_date": 1446256119, "answer_id": 33447267, "question_id": 33423827, "link": "https://stackoverflow.com/questions/33423827/how-to-properly-force-evaluation-of-pure-value-in-io-monad/33447267#33447267", "title": "How to properly force evaluation of pure value in IO monad?", "body": "<p>Daniel Wagner's answer is fine for this use-case, but sometimes it's also beneficial to just evaluate the spine of a list and leave the list elements unevaluated (and sometimes the list items have no sensible <code>NFData</code> instance). You can't use <code>deepseq</code> for this because it evaluates everything. However, you can combine <code>seq</code> with this function:</p>\n\n<pre><code>evalList :: [a] -&gt; ()\nevalList [] = ()\nevalList (_:r) = evalList r\n</code></pre>\n"}], "owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 688, "favorite_count": 1, "accepted_answer_id": 33424248, "answer_count": 2, "score": 8, "last_activity_date": 1446529200, "creation_date": 1446149970, "last_edit_date": 1495541819, "question_id": 33423827, "link": "https://stackoverflow.com/questions/33423827/how-to-properly-force-evaluation-of-pure-value-in-io-monad", "title": "How to properly force evaluation of pure value in IO monad?", "body": "<p>I need to force evaluation of pure value in <code>IO</code> monad. I'm writing\nhigher-level interface to C bindings. On lower level I have, say <code>newFile</code>\nfunction and <code>freeFile</code> function. <code>newFile</code> returns some id, opaque object\nI've defined on lower level. You cannot basically do anything with that but\nto use it to free the file <em>and</em> purely calculate something associated with\nthat file.</p>\n\n<p>So, I have (simplified):</p>\n\n<pre><code>execGetter :: FilePath -&gt; TagGetter a -&gt; IO a\nexecGetter path g = do\n  fid &lt;- newFile path -- \u2018fid\u2019 stands for \u201cfile id\u201d\n  let x = runGetter g fid\n  freeFile fid\n  return x\n</code></pre>\n\n<p>This is initial version of the function. We need to calculate <code>x</code> before\n<code>freeFile</code> is called. (The code works, if I remove <code>freeFile</code> it's all fine,\nbut I want to free the resource, you know.)</p>\n\n<p>First attempt (we will use <code>seq</code> to \u201cforce\u201d evaluation):</p>\n\n<pre><code>execGetter :: FilePath -&gt; TagGetter a -&gt; IO a\nexecGetter path g = do\n  fid &lt;- newFile path\n  let x = runGetter g fid\n  x `seq` freeFile fid\n  return x\n</code></pre>\n\n<p>Segmentation fault. Go straight to documentation of\n<a href=\"http://haddock.stackage.org/lts-3.11/base-4.8.1.0/Prelude.html#v:seq\" rel=\"nofollow noreferrer\"><code>seq</code></a>:</p>\n\n<blockquote>\n  <p>The value of <code>seq a b</code> is bottom if <code>a</code> is bottom, and otherwise equal to\n  <code>b</code>. <code>seq</code> is usually introduced to improve performance by avoiding\n  unneeded laziness.</p>\n  \n  <p>A note on evaluation order: the expression <code>seq a b</code> does not guarantee\n  that <code>a</code> will be evaluated before <code>b</code>. The only guarantee given by <code>seq</code>\n  is that the both <code>a</code> and <code>b</code> will be evaluated before <code>seq</code> returns a\n  value. In particular, this means that <code>b</code> may be evaluated before <code>a</code>. If\n  you need to guarantee a specific order of evaluation, you must use the\n  function <code>pseq</code> from the \"parallel\" package.</p>\n</blockquote>\n\n<p>A good note, indeed, I've seen people claiming different things about order\nof evaluation in this case. What about <code>pseq</code>? Do I need to depend on\n<code>parallel</code> just because of <code>pseq</code>, hmm\u2026 may be there is another way.</p>\n\n<pre><code>{-# LANGUAGE BangPatterns #-}\n\nexecGetter :: FilePath -&gt; TagGetter a -&gt; IO a\nexecGetter path g = do\n  fid &lt;- newFile path\n  let !x = runGetter g fid\n  freeFile fid\n  return x\n</code></pre>\n\n<p>Segmentation fault. Well,\n<a href=\"https://stackoverflow.com/a/4913552/3687048\">that answer</a> doesn't work in my\ncase. But it suggests <code>evaluate</code>, let's try it Too:</p>\n\n<pre><code>Control.Exception (evaluate)\nControl.Monad (void)\n\nexecGetter :: FilePath -&gt; TagGetter a -&gt; IO a\nexecGetter path g = do\n  fid &lt;- newFile path\n  let x = runGetter g fid\n  void $ evaluate x\n  freeFile fid\n  return x\n</code></pre>\n\n<p>Segmentation fault. Maybe we should use value returned by <code>evaluate</code>?</p>\n\n<pre><code>Control.Exception (evaluate)\nControl.Monad (void)\n\nexecGetter :: FilePath -&gt; TagGetter a -&gt; IO a\nexecGetter path g = do\n  fid &lt;- newFile path\n  let x = runGetter g fid\n  x' &lt;- evaluate x\n  freeFile fid\n  return x'\n</code></pre>\n\n<p>No, bad idea. Maybe we could chain <code>seq</code>:</p>\n\n<pre><code>execGetter :: FilePath -&gt; TagGetter a -&gt; IO a\nexecGetter path g = do\n  fid &lt;- newFile path\n  let x = runGetter g fid\n  x `seq` freeFile fid `seq` return x\n</code></pre>\n\n<p>This works. But is this the right way to do it? Maybe it only works due to\nsome volatile optimization logic? I don't know. If <code>seq</code> associates to the\nleft in this case then according to that description both <code>x</code> and <code>freeFile</code>\nare evaluated when <code>return x</code> returns its value. But again, which of them,\n<code>x</code> or <code>freeFile</code> is evaluated first? Since I don't get seg fault, it must\nbe <code>x</code>, but is this result reliable? Do you know how to force evaluation of\n<code>x</code> before <code>freeFile</code> <em>properly</em>?</p>\n"}, {"tags": ["haskell", "types", "type-kinds"], "answers": [{"comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1446182383, "post_id": 33423794, "comment_id": 54646858, "body": "Some of this is set to change in GHC 8.0, where types and kinds will be merged internally."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 11, "last_activity_date": 1446149847, "creation_date": 1446149847, "answer_id": 33423794, "question_id": 33423709, "link": "https://stackoverflow.com/questions/33423709/haskells-datakinds-and-relation-of-values-types-and-kinds/33423794#33423794", "title": "Haskell&#39;s DataKinds and relation of values, types and kinds", "body": "<p>Nope. You can only get the kinds of types. What <code>-XDataKinds</code> does is take data declarations and give them <em>two</em> meanings: first, it declares a new type and some corresponding value constructors; and second, it declares a new <em>kind</em> and some corresponding type constructors. So with <code>DataKinds</code> on, the following declaration:</p>\n\n<pre><code>data Animal = Dog | Cat\n</code></pre>\n\n<p>creates <em>all</em> of the following:</p>\n\n<ul>\n<li>type <code>Animal</code></li>\n<li>value <code>Dog</code> of type <code>Animal</code></li>\n<li>value <code>Cat</code> of type <code>Animal</code></li>\n<li>kind <code>Animal</code></li>\n<li>type <code>Dog</code> of kind <code>Animal</code></li>\n<li>type <code>Cat</code> of kind <code>Animal</code></li>\n</ul>\n\n<p>The three namespaces -- term-level, type-level, and kind-level -- are completely disjoint. In case <code>DataKinds</code> would define a new type in two different ways, you can use a prefix <code>'</code> to indicate that you want the lifted version. Thus:</p>\n\n<pre><code>&gt; :set -XDataKinds\n&gt; data Animal = Animal\n&gt; :k Animal\nAnimal :: *\n&gt; :k 'Animal\n'Animal :: Animal\n</code></pre>\n"}], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 675, "favorite_count": 2, "accepted_answer_id": 33423794, "answer_count": 1, "score": 3, "last_activity_date": 1446255749, "creation_date": 1446149497, "last_edit_date": 1446255749, "question_id": 33423709, "link": "https://stackoverflow.com/questions/33423709/haskells-datakinds-and-relation-of-values-types-and-kinds", "title": "Haskell&#39;s DataKinds and relation of values, types and kinds", "body": "<p>Say I have this:</p>\n\n<pre><code>data Animal = Dog | Cat\n:t Dog\nDog :: Animal\n</code></pre>\n\n<p>Fair enough.</p>\n\n<pre><code>:k Dog\n\n&lt;interactive&gt;:1:1:\n    Not in scope: type constructor or class \u2018Dog\u2019\n    A data constructor of that name is in scope; did you mean DataKinds?\n</code></pre>\n\n<p>Wasn't expecting that to work since Dog is a value, not a type. You cannot get a kind of a value, only a kind of a type, right?</p>\n\n<p>But, if I do this:</p>\n\n<pre><code>:set -XDataKinds\ndata Animal = Dog | Cat\n:k Dog\nDog :: Animal\n</code></pre>\n\n<p>What does this mean that you can get a kind of a value?</p>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1446148164, "post_id": 33423297, "comment_id": 54635934, "body": "Hint: what would <code>x</code> and <code>y</code> be if you evaluated <code>Pair 1 2 == Pair 1 2</code>?"}, {"owner": {"reputation": 181, "user_id": 5504664, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-uS2B2l7Eep8/AAAAAAAAAAI/AAAAAAAAAGA/IotCrHH3PYE/photo.jpg?sz=128", "display_name": "Hassan Shahin", "link": "https://stackoverflow.com/users/5504664/hassan-shahin"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1446148520, "post_id": 33423297, "comment_id": 54636133, "body": "Hmmm! Is it possible to have Pair 1 2 in the first place. Maybe my mistake is thinking that the 2 as in the data constructor have the same value."}, {"owner": {"reputation": 181, "user_id": 5504664, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-uS2B2l7Eep8/AAAAAAAAAAI/AAAAAAAAAGA/IotCrHH3PYE/photo.jpg?sz=128", "display_name": "Hassan Shahin", "link": "https://stackoverflow.com/users/5504664/hassan-shahin"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1446148858, "post_id": 33423297, "comment_id": 54636326, "body": "I re-implemented the last line of my code as:         (==) (Pair x y) (Pair z m) = (x == z &amp;&amp; y == m) Now there is no error.  Thanks leftaroundabout."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1446149066, "post_id": 33423297, "comment_id": 54636438, "body": "Exactly. They have the same <i>type</i>, that&#39;s what <code>data Pair a = Pair a a</code> says; but clearly most types permit more than a single value!"}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 5504664, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-uS2B2l7Eep8/AAAAAAAAAAI/AAAAAAAAAGA/IotCrHH3PYE/photo.jpg?sz=128", "display_name": "Hassan Shahin", "link": "https://stackoverflow.com/users/5504664/hassan-shahin"}, "edited": false, "score": 0, "creation_date": 1446155618, "post_id": 33425009, "comment_id": 54639620, "body": "I agree. While my re-implementation or what @vanson-samuel suggests makes the compiler happy (no mistake), I am still not clear about the error message itself: Where is the re-definition happening in my first code?"}, {"owner": {"reputation": 181, "user_id": 5504664, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-uS2B2l7Eep8/AAAAAAAAAAI/AAAAAAAAAGA/IotCrHH3PYE/photo.jpg?sz=128", "display_name": "Hassan Shahin", "link": "https://stackoverflow.com/users/5504664/hassan-shahin"}, "edited": false, "score": 0, "creation_date": 1446156938, "post_id": 33425009, "comment_id": 54640238, "body": "Yes, thanks @vanson-samuel. With the example you are citing it is more clear now where the re-definition is occurring."}], "tags": [], "owner": {"reputation": 1891, "user_id": 45160, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9fe6d04c7c6a357a92a2b05efd0d09bc?s=128&d=identicon&r=PG", "display_name": "Vanson Samuel", "link": "https://stackoverflow.com/users/45160/vanson-samuel"}, "is_accepted": true, "score": 3, "last_activity_date": 1446156060, "last_edit_date": 1446156060, "creation_date": 1446154380, "answer_id": 33425009, "question_id": 33423297, "link": "https://stackoverflow.com/questions/33423297/conflict-in-defining-a-variable-ina-typeclass-implementation/33425009#33425009", "title": "Conflict in defining a variable ina typeclass implementation", "body": "<p>Say the following call is being made:</p>\n\n<pre><code>(Pair 1 2) == (Pair 3 4)\n</code></pre>\n\n<p>The value 1 will be assigned to x at this point:</p>\n\n<pre><code>(==) (Pair x...\n</code></pre>\n\n<p>At this point x is being reassign to the value 2 which is not allowed:</p>\n\n<pre><code>(==) (Pair x x...\n</code></pre>\n\n<p>Hence the error</p>\n\n<p>As for the answer to your second question, you should have gotten an error for both x, and y, like so:</p>\n\n<pre><code>Test.hs:6:16:\n    Conflicting definitions for `x'\n    Bound at: Test.hs:6:16\n              Test.hs:6:18\n    In an equation for `=='\n\nTest.hs:6:27:\n    Conflicting definitions for `y'\n    Bound at: Test.hs:6:27\n              Test.hs:6:29\n    In an equation for `=='\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 5504664, "user_type": "registered", "accept_rate": 62, "profile_image": "https://lh3.googleusercontent.com/-uS2B2l7Eep8/AAAAAAAAAAI/AAAAAAAAAGA/IotCrHH3PYE/photo.jpg?sz=128", "display_name": "Hassan Shahin", "link": "https://stackoverflow.com/users/5504664/hassan-shahin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 33425009, "answer_count": 1, "score": 1, "last_activity_date": 1446156060, "creation_date": 1446147923, "last_edit_date": 1446153290, "question_id": 33423297, "link": "https://stackoverflow.com/questions/33423297/conflict-in-defining-a-variable-ina-typeclass-implementation", "title": "Conflict in defining a variable ina typeclass implementation", "body": "<p>I am trying to implement Eq class type for the following data:</p>\n\n<pre><code>data Pair a = Pair a a\ninstance Eq a =&gt; Eq (Pair a) where\n    (==) (Pair x x) (Pair y y) = (x == y)\n</code></pre>\n\n<p>I am getting the following error message:</p>\n\n<blockquote>\n  <p>Conflicting definitions for \u2018y\u2019 in ....</p>\n</blockquote>\n\n<p>My questions:</p>\n\n<ol>\n<li>I think I am doing things \"By the book\", so why I am getting this error?</li>\n<li>If I am re-defining <code>y</code>, why there isn't a similar error for <code>x</code>?</li>\n<li>Where is this \"re-definition\" in the above code?</li>\n</ol>\n"}, {"tags": ["list", "haskell", "fold"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1446147910, "post_id": 33423243, "comment_id": 54635802, "body": "it says you right there: you need an additional argument ... try whatever you want to get if you do <code>group []</code> ;) (but beware there will be other issues ...)"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1446157424, "post_id": 33423405, "comment_id": 54640467, "body": "This is too strict, in my opinion."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1446181260, "post_id": 33423405, "comment_id": 54646531, "body": "@dfeuer probably yes - but IMO it&#39;s the idea I thought to see in James attempt brought to <i>life</i> ;) - I don&#39;t pretend to give <i>best</i> answers ^^"}, {"owner": {"reputation": 94, "user_id": 5504651, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/36f9632b5e73c225475a644e029ead84?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/5504651/james"}, "edited": false, "score": 0, "creation_date": 1446225771, "post_id": 33423405, "comment_id": 54671352, "body": "Thanks for your response, your answer makes sense and is in fact almost identical to the answer model answer on a website that zuko32 posted:      pack :: (Eq a) =&gt; [a] -&gt; [[a]]     pack = foldr func []         where func x []     = [[x]]               func x (y:xs) =                   if x == (head y) then ((x:y):xs) else ([x]:y:xs)"}, {"owner": {"reputation": 94, "user_id": 5504651, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/36f9632b5e73c225475a644e029ead84?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/5504651/james"}, "edited": false, "score": 0, "creation_date": 1446225808, "post_id": 33423405, "comment_id": 54671372, "body": "I have written my own code out in the same form so I am better able to compare the differences between my code and this model answer. I believe my big mistake was reading in two variables x and xs rather than x and a list: (y:xs). I also did not set the base case properly where f x [] == [[]], and I was wasting time appending x onto the empty set when I could have just written [x]. Thanks for your help."}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 3, "last_activity_date": 1446154431, "last_edit_date": 1446154431, "creation_date": 1446148362, "answer_id": 33423405, "question_id": 33423243, "link": "https://stackoverflow.com/questions/33423243/haskell-group-list-elements-with-foldr-function/33423405#33423405", "title": "Haskell - Group list elements with foldr function", "body": "<p>I think you are on  the right track so I'll try to write your idea a bit nicer. What I want to say is this: you should pull out the first argument of <code>foldr</code> into an function and do pattern-matching again:</p>\n\n<pre><code>group :: Eq a =&gt; [a] -&gt; [[a]]\ngroup = foldr f undefined\n  where f x []        = undefined\n        f x (ys@(y:_):yss)\n          | x == y    = undefined\n          | otherwise = undefined\n</code></pre>\n\n<p>this should do - now you <em>only</em> have to put in the right stuff where I put <code>undefined</code> :)</p>\n\n<p>I'll come back later and finish it</p>\n\n<hr>\n\n<p>well I guess you gave up or something - anyway here is one solution:</p>\n\n<pre><code>group :: Eq a =&gt; [a] -&gt; [[a]]\ngroup = foldr f []\n  where f x []        = [[x]]\n        f x (ys@(y:_):yss)\n          | x == y     = (x:ys):yss\n          | otherwise = [x]:ys:yss\n</code></pre>\n\n<p>and a few examples:</p>\n\n<pre><code>\u03bb&gt; group []\n[]\n\u03bb&gt; group [1]\n[[1]]\n\u03bb&gt; group [1,1]\n[[1,1]]\n\u03bb&gt; group [1,2,1]\n[[1],[2],[1]]\n\u03bb&gt; group [1,2,2,3,4,4,4,5]\n[[1],[2,2],[3],[4,4,4],[5]]\n</code></pre>\n\n<p>note that <code>f</code>s patterns are not exhaustive (which is no problem - think about why) - of course you can extent it if you want (and if you don't agree with <code>group [] = []</code> than you have to.</p>\n"}, {"comments": [{"owner": {"reputation": 94, "user_id": 5504651, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/36f9632b5e73c225475a644e029ead84?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/5504651/james"}, "edited": false, "score": 0, "creation_date": 1446226046, "post_id": 33425576, "comment_id": 54671497, "body": "You are correct it is the same problem, thanks for directing me to this."}, {"owner": {"reputation": 239, "user_id": 5484133, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pMc6m.png?s=128&g=1", "display_name": "zuko32", "link": "https://stackoverflow.com/users/5484133/zuko32"}, "reply_to_user": {"reputation": 94, "user_id": 5504651, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/36f9632b5e73c225475a644e029ead84?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/5504651/james"}, "edited": false, "score": 0, "creation_date": 1446238451, "post_id": 33425576, "comment_id": 54677734, "body": "@James Nothing man. I think it is a very good practice for Haskell programmers, so you migh be interested in trying more of these problems. :)"}], "tags": [], "owner": {"reputation": 239, "user_id": 5484133, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pMc6m.png?s=128&g=1", "display_name": "zuko32", "link": "https://stackoverflow.com/users/5484133/zuko32"}, "is_accepted": false, "score": 1, "last_activity_date": 1446156949, "creation_date": 1446156949, "answer_id": 33425576, "question_id": 33423243, "link": "https://stackoverflow.com/questions/33423243/haskell-group-list-elements-with-foldr-function/33425576#33425576", "title": "Haskell - Group list elements with foldr function", "body": "<p>Just to mention that if I am not wrong, this is the problem 9 from the 99 haskell problems that can be found here: <a href=\"https://wiki.haskell.org/99_questions/\" rel=\"nofollow\">https://wiki.haskell.org/99_questions/</a> <br />\nFor every problem, it has a bunch of solutions(usually) and since Carsten presented a great solution, you can go there and see other solutions so you can get different ideas on how the same thing can be achieved in various ways!</p>\n"}], "owner": {"reputation": 94, "user_id": 5504651, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/36f9632b5e73c225475a644e029ead84?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/5504651/james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2461, "favorite_count": 0, "accepted_answer_id": 33423405, "answer_count": 2, "score": 3, "last_activity_date": 1446156949, "creation_date": 1446147704, "question_id": 33423243, "link": "https://stackoverflow.com/questions/33423243/haskell-group-list-elements-with-foldr-function", "title": "Haskell - Group list elements with foldr function", "body": "<p>This is for an assignment in Haskell.\nWe have been tasked with defining various functions using the foldr function.</p>\n\n<p>We have been given a type:</p>\n\n<pre><code>group :: Eq a =&gt; [a] -&gt; [[a]]\n</code></pre>\n\n<p>and been asked to define it such that:</p>\n\n<pre><code>group [1,2,2,3,4,4,4,5] = [[1], [2,2], [3], [4,4,4], [5]]\ngroup [1,2,2,3,4,4,4,5,1,1,1] = [[1], [2,2], [3], [4,4,4], [5], [1,1,1]]\n</code></pre>\n\n<p>This is what I have so far:</p>\n\n<pre><code>group = foldr (\\x xs -&gt; if x == head (head xs) then (x : head xs) : xs else (x : []) : (head xs) : xs )\n</code></pre>\n\n<p>But when I try to load this into ghci interpreter I get the following error message:</p>\n\n<pre><code>Couldn't match type `[a0] -&gt; [a]' with `[[a]]'\nExpected type: [a] -&gt; [[a]]\n  Actual type: [a] -&gt; [a0] -&gt; [a]\nIn the return type of a call of `foldr'\nProbable cause: `foldr' is applied to too few arguments\nIn the expression:\n  foldr\n    (\\ x xs\n       -&gt; if x == head (head xs) then\n              (x : head xs) : xs\n          else\n              (x : []) : (head xs) : xs)\nIn an equation for `group':\n    group\n      = foldr\n          (\\ x xs\n             -&gt; if x == head (head xs) then\n                    (x : head xs) : xs\n                else\n                    (x : []) : (head xs) : xs)\n</code></pre>\n\n<p>If anyone could explain any reasons why my code isn't working as I expect it to, that would be greatly appreciated. \nThanks.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "edited": false, "score": 0, "creation_date": 1446147848, "post_id": 33423235, "comment_id": 54635767, "body": "thanks. I thought that <code>const</code> returns its first argument."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "edited": false, "score": 0, "creation_date": 1446147906, "post_id": 33423235, "comment_id": 54635798, "body": "It returns a function which then returns its first argument. The function that immediately returns its first argument is <code>id</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "edited": false, "score": 2, "creation_date": 1446152864, "post_id": 33423235, "comment_id": 54638371, "body": "@akonsu <code>const</code> takes two arguments and returns the first. This is, by currying, equivalent to taking one argument <code>a</code> and returning the constant function <code>\\x -&gt; a</code>."}, {"owner": {"reputation": 1351, "user_id": 2514354, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/PiwJY.png?s=128&g=1", "display_name": "loxaxs", "link": "https://stackoverflow.com/users/2514354/loxaxs"}, "edited": false, "score": 0, "creation_date": 1512247933, "post_id": 33423235, "comment_id": 82183121, "body": "<code>const = \\x y -&gt; x</code>"}, {"owner": {"reputation": 1351, "user_id": 2514354, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/PiwJY.png?s=128&g=1", "display_name": "loxaxs", "link": "https://stackoverflow.com/users/2514354/loxaxs"}, "edited": false, "score": 0, "creation_date": 1512247972, "post_id": 33423235, "comment_id": 82183131, "body": "<code>const</code> was what I was looking for. <code>flip const</code> might happen to be handy as well. (<code>flip f x y = f y x</code>)"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 5, "last_activity_date": 1446147660, "creation_date": 1446147660, "answer_id": 33423235, "question_id": 33423159, "link": "https://stackoverflow.com/questions/33423159/ignore-second-argument-of-a-function/33423235#33423235", "title": "ignore second argument of a function", "body": "<pre><code>  \\k _ -&gt; Set.member k s\n\u2261 \\k -&gt; \\_ -&gt; Set.member k s\n\u2261 \\k -&gt; const $ Set.member k s\n\u2261 \\k -&gt; const $ flip Set.member s k\n\u2261 const . flip Set.member s\n\u2261 const . (`Set.member`s)\n</code></pre>\n\n<p>I'm not sure what made you think the composition should be the other way around, but it wouldn't really make much sense &ndash; after all, <code>const</code> <em>returns a</em> (constant) <em>function</em>, but <code>Set.member</code> can't use a function in any of its arguments.</p>\n"}], "owner": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1309, "favorite_count": 0, "accepted_answer_id": 33423235, "answer_count": 1, "score": 4, "last_activity_date": 1446147660, "creation_date": 1446147393, "question_id": 33423159, "link": "https://stackoverflow.com/questions/33423159/ignore-second-argument-of-a-function", "title": "ignore second argument of a function", "body": "<p>Say I have this code:</p>\n\n<pre><code>import qualified Data.Map as Map\nimport qualified Data.Set as Set\n\nlet s = Set.fromList [0,1,2]\n    m = Map.fromList [(1,\"a\"),(2,\"b\"),(3,\"c\")]\nin Map.filterWithKey (\\k _ -&gt; Set.member k s) m\n</code></pre>\n\n<p>I wanted to get rid of the lambda expression:</p>\n\n<pre><code>Map.filterWithKey (flip Set.member s . const) m\n</code></pre>\n\n<p>but this does not compile. and I cannot figure why.. Please help.</p>\n\n<pre><code>Couldn't match type \u2018Bool\u2019 with \u2018[Char] -&gt; Bool\u2019\nExpected type: (b0 -&gt; a) -&gt; Set.Set (b0 -&gt; a) -&gt; [Char] -&gt; Bool\n  Actual type: (b0 -&gt; a) -&gt; Set.Set (b0 -&gt; a) -&gt; Bool\nIn the first argument of \u2018flip\u2019, namely \u2018Set.member\u2019\nIn the first argument of \u2018(.)\u2019, namely \u2018flip Set.member s\u2019\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 1, "creation_date": 1446145405, "post_id": 33422530, "comment_id": 54634429, "body": "check the <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/src/Data.Either.html#Either\" rel=\"nofollow noreferrer\">functor instance for <code>Either a</code></a>"}], "answers": [{"tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": false, "score": 2, "last_activity_date": 1446145387, "creation_date": 1446145387, "answer_id": 33422570, "question_id": 33422530, "link": "https://stackoverflow.com/questions/33422530/make-data-type-with-kind-a-functor/33422570#33422570", "title": "make data type with kind *-&gt;*-&gt;* a functor", "body": "<p>In short: you can't. <code>Functor</code> is only parametrized on one type.</p>\n\n<p>Thus, you can only make it an instance of <code>Functor</code> over the 2nd type, partially applied:</p>\n\n<pre><code>instance Functor (Move a) where\n</code></pre>\n\n<p>You can swap the type variables to make it parametrized over the other one in your defition.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1446145765, "post_id": 33422575, "comment_id": 54634631, "body": "Sorry; I didn&#39;t read carefully enough. But I am not buying this talk of &quot;syntax&quot; either."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1446145910, "post_id": 33422575, "comment_id": 54634696, "body": "@dfeuer Is there syntax similar to <code>instance Functor (\\a -&gt; Move a t) where ...</code> that I&#39;m not aware of?  Haskell doesn&#39;t support type level lambdas AFAIK, so this definition is enforced by syntax."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1446146126, "post_id": 33422575, "comment_id": 54634802, "body": "You&#39;re right that the syntax enforces the restriction, but that leads naturally to the question of why such syntax isn&#39;t added. The basic reason is that the class system doesn&#39;t support such a thing at all."}, {"owner": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "edited": false, "score": 0, "creation_date": 1446146603, "post_id": 33422575, "comment_id": 54635066, "body": "thanks. ideally, I was looking for <code>flip</code> for types."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "edited": false, "score": 1, "creation_date": 1446147250, "post_id": 33422575, "comment_id": 54635445, "body": "@akonsu, you can write <code>newtype Flip f x y = Flip {unflip :: f y x}</code>, but it may be annoying to use."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 3, "last_activity_date": 1446145618, "last_edit_date": 1446145618, "creation_date": 1446145409, "answer_id": 33422575, "question_id": 33422530, "link": "https://stackoverflow.com/questions/33422530/make-data-type-with-kind-a-functor/33422575#33422575", "title": "make data type with kind *-&gt;*-&gt;* a functor", "body": "<p>It would work better if you swapped the order of the type variables to <code>Move</code>:</p>\n\n<pre><code>data Move t a = Emove a a | Move a t a\n</code></pre>\n\n<p>Then you can define the functor as</p>\n\n<pre><code>instance Functor (Move t) where\n    fmap f (Emove x y) = Emove (f x) (f y)\n    fmap f (Move x c y) = Move (f x) c (f y)\n</code></pre>\n\n<p>Any type that is a functor must have kind <code>* -&gt; *</code>, that's just how it's defined.  Since you have a type that is <code>* -&gt; * -&gt; *</code>, you must make one of the type variables invariant under the functor (or else use a bifunctor, where the explicit purpose is to have a functor over both type variables).  Since you want the <code>a</code> to change and not the <code>t</code>, Haskell requires that the <code>a</code> type variable come last, it's just how the syntax works.  It's like with the <code>Either</code> type, the functor instance is <code>Functor (Either a)</code>, but that's a pretty arbitrary definition, it only changes values with the <code>Right</code> constructor, whereas it could have equivalently been defined for values with the <code>Left</code> constructor.  The meaning would be the same mathematically, but for consistency Haskell has enforced through syntax that the type variable that can change through the functor is the last type variable.</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 3, "last_activity_date": 1446166240, "creation_date": 1446166240, "answer_id": 33427210, "question_id": 33422530, "link": "https://stackoverflow.com/questions/33422530/make-data-type-with-kind-a-functor/33427210#33427210", "title": "make data type with kind *-&gt;*-&gt;* a functor", "body": "<p>You might consider making it a <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Bifunctor.html\" rel=\"nofollow\"><code>Bifunctor</code></a> instead:</p>\n\n<pre><code>instance Bifunctor Move where\n    bimap f g (EMove a a') = EMove (f a) (f a')\n    bimap f g (Move a t a') = Move (f a) (g t) (f a')\n</code></pre>\n\n<p>The operation <code>first f</code> would then do what you wanted <code>fmap f</code> to do.</p>\n"}], "owner": {"reputation": 26022, "user_id": 410102, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/a70b7da5a3a712e800100e61ef8d8917?s=128&d=identicon&r=PG", "display_name": "akonsu", "link": "https://stackoverflow.com/users/410102/akonsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 33422575, "answer_count": 3, "score": 3, "last_activity_date": 1446166240, "creation_date": 1446145227, "question_id": 33422530, "link": "https://stackoverflow.com/questions/33422530/make-data-type-with-kind-a-functor", "title": "make data type with kind *-&gt;*-&gt;* a functor", "body": "<p>I have this type:</p>\n\n<pre><code>data Move a t = Emove a a\n              | Move a t a\n</code></pre>\n\n<p>and I wanted to make it a functor:</p>\n\n<pre><code>instance Functor Move where\n    fmap f (Emove x y)  = Emove (f x) (f y)\n    fmap f (Move x c y) = Move (f x) c (f y)\n</code></pre>\n\n<p>but this does not compile because of the wrong kind of this type. Could someone please help me resolve this? How to supply the type <code>t</code> to this instance?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "is_accepted": true, "score": 6, "last_activity_date": 1446149625, "last_edit_date": 1495541339, "creation_date": 1446148608, "answer_id": 33423466, "question_id": 33422437, "link": "https://stackoverflow.com/questions/33422437/recover-the-do-notation-syntax/33423466#33423466", "title": "Recover the do notation syntax", "body": "<blockquote>\n<pre><code>{-# LANGUAGE Rank2Types, RebindableSyntax #-}\n\nimport qualified Prelude\nimport qualified System.IO\nimport Prelude (String, ($), (++))\nimport System.IO (IO)\n</code></pre>\n</blockquote>\n\n<p>With Gabriel Gonzales' suggestion</p>\n\n<blockquote>\n<pre><code>data MonadI f = MonadI {\n    _return :: forall a . a -&gt; f a,\n    _bind :: forall a b . f a -&gt; (a -&gt; f b) -&gt; f b\n}\n</code></pre>\n</blockquote>\n\n<p>you could implement the necessary functions <code>return</code> and <code>(&gt;&gt;=)</code> as follows, with the types as suggested by Paul Chiusano:</p>\n\n<blockquote>\n<pre><code>return :: a -&gt; (MonadI f -&gt; f a)\nreturn x = \\dict -&gt; (_return dict) x\n\n(&gt;&gt;=) :: (MonadI f -&gt; f a) -&gt; (a -&gt; (MonadI f -&gt; f b)) -&gt; (MonadI f -&gt; f b)\nma &gt;&gt;= f = \\dict -&gt; (_bind dict) (ma dict) (\\x -&gt; f x dict)\n</code></pre>\n</blockquote>\n\n<p>This is not enough to recover do-notation, because you'll also need <code>(&gt;&gt;)</code> and (<a href=\"https://stackoverflow.com/questions/18761302/why-were-haskell-98s-standard-classes-made-inferior-to-haskell-1-3s\">sadly</a>) <code>fail</code>. You can implement them as follows:</p>\n\n<blockquote>\n<pre><code>(&gt;&gt;) :: (MonadI f -&gt; f a) -&gt; (MonadI f -&gt; f b) -&gt; (MonadI f -&gt; f b)\nma &gt;&gt; mb = ma &gt;&gt;= (\\_ -&gt; mb)\n\nfail :: String -&gt; MonadI f -&gt; f a\nfail str = \\_ -&gt; Prelude.error str -- Because let's not further entertain that idea.\n</code></pre>\n</blockquote>\n\n<p>And now we have the required facilities to write simple programs:</p>\n\n<blockquote>\n<pre><code>main :: IO ()\nmain = (\\m -&gt; m monad'IO) $ do\n    putStrLn \"What is your name?\"\n    name &lt;- getLine\n    putStrLn $ \"Hello, \" ++ name\n</code></pre>\n</blockquote>\n\n<p>Of course, we're going to have to borrow some things from <code>System.IO</code> for that:</p>\n\n<blockquote>\n<pre><code>getLine :: MonadI IO -&gt; IO String\ngetLine = \\_ -&gt; System.IO.getLine\n\nputStrLn :: String -&gt; (MonadI IO -&gt; IO ())\nputStrLn str = \\_ -&gt; System.IO.putStrLn str\n\nmonad'IO :: MonadI IO\nmonad'IO = MonadI {\n    _return = (Prelude.return :: a -&gt; IO a),\n    _bind = ((Prelude.&gt;&gt;=) :: IO a -&gt; (a -&gt; IO b) -&gt; IO b)\n}\n</code></pre>\n</blockquote>\n"}], "owner": {"reputation": 1056, "user_id": 1268085, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/ff2b99da4e49f13c53b2f718649fc6a9?s=128&d=identicon&r=PG&f=1", "display_name": "Yogesh Sajanikar", "link": "https://stackoverflow.com/users/1268085/yogesh-sajanikar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 1, "accepted_answer_id": 33423466, "answer_count": 1, "score": 9, "last_activity_date": 1446149625, "creation_date": 1446144845, "question_id": 33422437, "link": "https://stackoverflow.com/questions/33422437/recover-the-do-notation-syntax", "title": "Recover the do notation syntax", "body": "<p>I was reading through <a href=\"http://www.haskellforall.com/2012/05/scrap-your-type-classes.html\">Scrap your type classes</a>. This provides an alternatives for type classes. However, I was stuck with a comment by <a href=\"http://www.haskellforall.com/2012/05/scrap-your-type-classes.html?showComment=1338305803531#c5117471807774445845\">Paul Chiusano</a> which talked about recovering the <em>do notation</em> syntax. </p>\n\n<p>Frankly I could not understand how </p>\n\n<pre><code>return :: a -&gt; (Monad f -&gt; f a) \n(&gt;&gt;=) :: (Monad f -&gt; f a) -&gt; (a -&gt; (Monad f -&gt; f b)) -&gt; (Monad f -&gt; f b)\n</code></pre>\n\n<p>would help recover <em>do notation</em></p>\n\n<blockquote>\n  <p>You can implement all the monadic combinators like this, and desugar\n  do notation to them. The do block evaluates to a function that accepts\n  the monad dictionary, so you can even conveniently write code that's\n  polymorphic in the choice of monad, without having to thread the\n  dictionary around manually.</p>\n</blockquote>\n\n<p>And especially, how it would fit int he context of GADT style approach mentioned in the above article?</p>\n"}, {"tags": ["haskell", "integer", "int", "type-conversion"], "comments": [{"owner": {"reputation": 818, "user_id": 1542000, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lK7QR.jpg?s=128&g=1", "display_name": "cronburg", "link": "https://stackoverflow.com/users/1542000/cronburg"}, "edited": false, "score": 0, "creation_date": 1446143756, "post_id": 33422062, "comment_id": 54633573, "body": "You can force <code>Int</code> as the type by putting inline types like <code>30 :: Int</code>, or give <code>firma</code> a type signature so that it uses <code>Int</code> instead of <code>Integer</code> (<code>Integer</code> is the default)"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1446143759, "post_id": 33422062, "comment_id": 54633577, "body": "Try putting <code>firma :: [(String, Int, String, Int, Int)]</code> before the declaration for <code>firma</code>.  If you&#39;re defining this in GHCi, then put it in a file instead."}, {"owner": {"reputation": 606, "user_id": 3497258, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/35f880339f03352b8e66231498e25779?s=128&d=identicon&r=PG&f=1", "display_name": "eXistanCe", "link": "https://stackoverflow.com/users/3497258/existance"}, "edited": false, "score": 0, "creation_date": 1446143823, "post_id": 33422062, "comment_id": 54633600, "body": "I&#39;m not allowed to give any signature to <b>firma</b> , more specifically i&#39;m not allowed to alter anything about <b>firma</b>"}, {"owner": {"reputation": 818, "user_id": 1542000, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lK7QR.jpg?s=128&g=1", "display_name": "cronburg", "link": "https://stackoverflow.com/users/1542000/cronburg"}, "edited": false, "score": 0, "creation_date": 1446143933, "post_id": 33422062, "comment_id": 54633658, "body": "Then wherever you <i>use</i> <code>firma</code> in your code, reference it like this: <code>(firma :: [(String, Int, String, Int, Int)])</code>"}, {"owner": {"reputation": 606, "user_id": 3497258, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/35f880339f03352b8e66231498e25779?s=128&d=identicon&r=PG&f=1", "display_name": "eXistanCe", "link": "https://stackoverflow.com/users/3497258/existance"}, "edited": false, "score": 0, "creation_date": 1446144054, "post_id": 33422062, "comment_id": 54633721, "body": "So i should add this line to my code:"}, {"owner": {"reputation": 818, "user_id": 1542000, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lK7QR.jpg?s=128&g=1", "display_name": "cronburg", "link": "https://stackoverflow.com/users/1542000/cronburg"}, "edited": false, "score": 0, "creation_date": 1446144227, "post_id": 33422062, "comment_id": 54633819, "body": "You have to put the type signature somewhere, but if you can&#39;t change <code>firma</code> you can just call <code>listaOrdenado</code> in <code>ghci</code> like this: <code>\u03bb&gt; listaOrdenado (firma :: [(String, Int, String, Int, Int)])</code>"}, {"owner": {"reputation": 606, "user_id": 3497258, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/35f880339f03352b8e66231498e25779?s=128&d=identicon&r=PG&f=1", "display_name": "eXistanCe", "link": "https://stackoverflow.com/users/3497258/existance"}, "edited": false, "score": 0, "creation_date": 1446144628, "post_id": 33422062, "comment_id": 54634017, "body": "Firma is not defined in my .hs file since its and hypothetical list to test the functions,  if I simply add that firma signature to my .hs file won&#39;t ghci complain?"}], "answers": [{"comments": [{"owner": {"reputation": 606, "user_id": 3497258, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/35f880339f03352b8e66231498e25779?s=128&d=identicon&r=PG&f=1", "display_name": "eXistanCe", "link": "https://stackoverflow.com/users/3497258/existance"}, "edited": false, "score": 0, "creation_date": 1446146345, "post_id": 33422474, "comment_id": 54634928, "body": "The thing is firma is a list that&#39;s going to be used to test my code,  firma may have more tuples than the ones I was provided with,  the only firm thing are the types of the variables inside the tuples.                           So I can&#39;t like put a version of firma in my . Hs file  nor can I add the specification when calling it for the ghci since I will not be the one calling her when avaluating the functions.                                                   and I do belive firma doesn&#39;t have a signature or at least I am not provided with it"}, {"owner": {"reputation": 818, "user_id": 1542000, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lK7QR.jpg?s=128&g=1", "display_name": "cronburg", "link": "https://stackoverflow.com/users/1542000/cronburg"}, "reply_to_user": {"reputation": 606, "user_id": 3497258, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/35f880339f03352b8e66231498e25779?s=128&d=identicon&r=PG&f=1", "display_name": "eXistanCe", "link": "https://stackoverflow.com/users/3497258/existance"}, "edited": false, "score": 0, "creation_date": 1446218932, "post_id": 33422474, "comment_id": 54667002, "body": "If you&#39;re not the one calling <code>listaOrdenado</code> and you&#39;re not allowed to use <code>Integer</code> or <code>Num</code> in the type signature, then you can just assume whoever uses your code will pass in the right type because the onus is on the caller to provide the correct types because Haskell is strongly typed."}], "tags": [], "owner": {"reputation": 818, "user_id": 1542000, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lK7QR.jpg?s=128&g=1", "display_name": "cronburg", "link": "https://stackoverflow.com/users/1542000/cronburg"}, "is_accepted": false, "score": 3, "last_activity_date": 1446145037, "creation_date": 1446145037, "answer_id": 33422474, "question_id": 33422062, "link": "https://stackoverflow.com/questions/33422062/haskell-integer-to-int-with-int-signature/33422474#33422474", "title": "Haskell : Integer to Int with int signature", "body": "<p>If you can change the signature of <code>firma</code>, just add the appropriate type signature to it:</p>\n\n<pre><code>firma :: [(String, Int, String, Int, Int)]\nfirma = [(\"Ana\", 30, \"RH\", 1500, 3), (\"Rui\", 40, \"Vendas\", 1000, 2),\n        (\"Luis\", 45, \"RH\", 3333, 5), (\"Maria\", 55, \"Admin\", 2000, 4)]\n</code></pre>\n\n<p>If not allowed to change <code>firma</code>, you can call <code>listaOrdenado</code> by giving <code>firma</code> a specific type signature on the <code>ghci</code> prompt:</p>\n\n<pre><code>$ ghci firma.hs\n\u03bb&gt; listaOrdenado (firma :: [(String, Int, String, Int, Int)])\n</code></pre>\n\n<p>If <code>firma</code> actually has a type signature with <code>Integer</code> used, then you need to cast from <code>Integer</code> to <code>Int</code> using <code>fromIntegral</code> in some manner like this:</p>\n\n<pre><code>fI = fromIntegral\nintegerToInt [] = []\nintegerToInt ((a,b,c,d,e):xs) = (a, fI b, c, fI d, fI e) : (integerToInt xs)\n</code></pre>\n\n<p>and then invoke <code>listaOrdenado</code> like this in <code>ghci</code>:</p>\n\n<pre><code>$ ghci firma.hs\n\u03bb&gt; listaOrdenado (integerToInt firma)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1446147041, "post_id": 33422818, "comment_id": 54635311, "body": "Annotating at the use site will only move the type error."}, {"owner": {"reputation": 606, "user_id": 3497258, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/35f880339f03352b8e66231498e25779?s=128&d=identicon&r=PG&f=1", "display_name": "eXistanCe", "link": "https://stackoverflow.com/users/3497258/existance"}, "edited": false, "score": 0, "creation_date": 1446148290, "post_id": 33422818, "comment_id": 54635999, "body": "After adding this line to my code:      firma :: Num a, Num b, Num c =&gt; [(String, a, String, b, c)] i get the following error when trying to load my .hs file onto ghci:      .hs:1:15: parse error on input `,&#39;  caracter 15 being the first , after <b>a</b>"}, {"owner": {"reputation": 868, "user_id": 1767808, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/KfCkc.jpg?s=128&g=1", "display_name": "Christoph W.", "link": "https://stackoverflow.com/users/1767808/christoph-w"}, "edited": false, "score": 0, "creation_date": 1446148526, "post_id": 33422818, "comment_id": 54636137, "body": "sorry this was a copy paste error, I updated my answer."}, {"owner": {"reputation": 606, "user_id": 3497258, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/35f880339f03352b8e66231498e25779?s=128&d=identicon&r=PG&f=1", "display_name": "eXistanCe", "link": "https://stackoverflow.com/users/3497258/existance"}, "edited": false, "score": 0, "creation_date": 1446158614, "post_id": 33422818, "comment_id": 54640944, "body": "The parse error is gone but now it gives another error regarding the lack of an accompanying binding:    The type signature for `firma&#39; lacks an accompanying binding"}, {"owner": {"reputation": 868, "user_id": 1767808, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/KfCkc.jpg?s=128&g=1", "display_name": "Christoph W.", "link": "https://stackoverflow.com/users/1767808/christoph-w"}, "edited": false, "score": 0, "creation_date": 1446199338, "post_id": 33422818, "comment_id": 54654547, "body": "Can you explain how you use firma? Did you try to manually cast it and then you get this error?"}], "tags": [], "owner": {"reputation": 868, "user_id": 1767808, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/KfCkc.jpg?s=128&g=1", "display_name": "Christoph W.", "link": "https://stackoverflow.com/users/1767808/christoph-w"}, "is_accepted": true, "score": 5, "last_activity_date": 1446199258, "last_edit_date": 1446199258, "creation_date": 1446146301, "answer_id": 33422818, "question_id": 33422062, "link": "https://stackoverflow.com/questions/33422062/haskell-integer-to-int-with-int-signature/33422818#33422818", "title": "Haskell : Integer to Int with int signature", "body": "<p>Since the problem is not solved yet, I edited my answer to be more precise:</p>\n\n<p>If you have top level definitions in your Haskell module, Haskell will infer a <strong>monomorphic</strong> type and not a polymorphic. The reason is very simple. Haskell assumes that a top level definition is used quite often and if an expression has a monomorphic type, it has to be evaluated just ones. In your case, Haskell tries to find the best fitting <strong>monomorphic</strong> type for the numbers in your tuple. By specification/implementation Haskell tries first the type <code>Integer</code> and then the type <code>Float</code>. This is the reason why you have the type error in your code.</p>\n\n<p>Now you have several options to solve this problem:</p>\n\n<p>1.Add the type of firma in your module (preferred solution):</p>\n\n<pre><code>module Test where\n\ngetOrdenado :: (String,Int,String,Int,Int) -&gt; Int\ngetOrdenado (_,_,_,a,_) = a \n\nlistaOrdenado :: [(String,Int,String,Int,Int)] -&gt; [Int]\nlistaOrdenado xs = map getOrdenado xs\n\nfirma :: Num a =&gt; [(String,a,String,a,a)]\nfirma = [(\"Ana\", 30, \"RH\", 1500, 3), (\"Rui\", 40, \"Vendas\", 1000, 2),\n        (\"Luis\", 45, \"RH\", 3333, 5), (\"Maria\", 55, \"Admin\", 2000, 4)]\n</code></pre>\n\n<p>If you call <code>listaOrdenado firma</code>, it works just fine for me.</p>\n\n<p>2.The second possibility is to turn off monomorphic type inference by overwriting the used defaults. How this is done is explained in this wiki entry: <a href=\"https://wiki.haskell.org/Monomorphism_restriction\" rel=\"nofollow\">https://wiki.haskell.org/Monomorphism_restriction</a></p>\n\n<p>3.The last, but quite expensive, solution in my mind is to manually cast the elements of your list to the preferred type.</p>\n"}], "owner": {"reputation": 606, "user_id": 3497258, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/35f880339f03352b8e66231498e25779?s=128&d=identicon&r=PG&f=1", "display_name": "eXistanCe", "link": "https://stackoverflow.com/users/3497258/existance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 872, "favorite_count": 0, "accepted_answer_id": 33422818, "answer_count": 2, "score": 3, "last_activity_date": 1446199258, "creation_date": 1446143555, "question_id": 33422062, "link": "https://stackoverflow.com/questions/33422062/haskell-integer-to-int-with-int-signature", "title": "Haskell : Integer to Int with int signature", "body": "<p>So i'm having problems with some variable types.</p>\n\n<pre><code>getOrdenado :: (String,Int,String,Int,Int) -&gt; Int\ngetOrdenado (_,_,_,a,_) = a \n\nlistaOrdenado :: [(String,Int,String,Int,Int)] -&gt; [Int]\nlistaOrdenado xs = map getOrdenado xs\n</code></pre>\n\n<p><strong>getOrdenado</strong> takes a certain <strong>Int</strong> value from a tuple contained in a list of tuples and <strong>listaOrdenado</strong> makes a list of all of thoose specific <strong>Int</strong>'s.</p>\n\n<p>This function is supposed to work on the following list:</p>\n\n<pre><code>firma = [(\"Ana\", 30, \"RH\", 1500, 3), (\"Rui\", 40, \"Vendas\", 1000, 2),\n        (\"Luis\", 45, \"RH\", 3333, 5), (\"Maria\", 55, \"Admin\", 2000, 4)]\n</code></pre>\n\n<p>But whenever i try running <strong>listaOrdenado</strong> with this list i get the following error </p>\n\n<pre><code>Couldn't match type `Integer' with `Int'\nExpected type: [(String, Int, String, Int, Int)]\n  Actual type: [([Char], Integer, [Char], Integer, Integer)]\nIn the first argument of `listaOrdenado', namely `firma'\nIn the expression: listaOrdenado firma\nIn an equation for `it': it = listaOrdenado firma\n</code></pre>\n\n<p>I am not allowed to use <strong>Integer</strong> in the class signature, only <strong>Int</strong> so i have no clue on how to solve this, nor do i have any clue why it says that those values in <strong>firma</strong> are <strong>Integer</strong>'s</p>\n"}]