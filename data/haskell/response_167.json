[{"tags": ["list", "haskell", "binary-tree", "branch"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1521662095, "post_id": 49415310, "comment_id": 85832557, "body": "What error occurs? Please write your attempt or we cannot help you."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1521662299, "post_id": 49415310, "comment_id": 85832668, "body": "But currently you do not show much effort yourself..."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1521670946, "post_id": 49415558, "comment_id": 85836776, "body": "@user2407038 Thanks. I noticed that when I was working up a complete solution, but forgot to fix it here."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 3, "last_activity_date": 1521670883, "last_edit_date": 1521670883, "creation_date": 1521662520, "answer_id": 49415558, "question_id": 49415310, "link": "https://stackoverflow.com/questions/49415310/using-binary-trees-in-haskell-trying-to-use-paths/49415558#49415558", "title": "Using binary trees in Haskell - Trying to use paths", "body": "<p>It might help you get started to look at which cases you need to handle. You have two arguments, each of which has a small number of constructors:</p>\n\n<ol>\n<li>The <code>Path</code> argument can be empty (<code>[]</code>) or not (<code>_:_</code>).</li>\n<li>The <code>Btree a</code> argument can be empty (<code>ND</code>), have data (<code>Data _</code>), or be an interior node (<code>Branch _ _</code>).</li>\n</ol>\n\n<p>Further, the return value isn't <em>always</em> an error; it could be a value of type <code>a</code>! The return value you probably have in mind is something like <code>Either e a</code> (where <code>e</code> is your error type, usually <code>String</code> but it could be an enumerated type like your <code>Dir</code> type) or even <code>Maybe a</code> if you just want to signal \"no data found\" with <code>Nothing</code>.</p>\n\n<p>With that in mind, you have 6 cases for which your function should be defined:</p>\n\n<pre><code>extract :: Path -&gt; Btree a -&gt; Maybe a\nextract [] ND = ...\nextract [] (Data d) = ...\nextract [] (Branch left right) = ...\nextract (d:ds) ND = ...\nextract (d:ds) (Data dat) = ...\nextract (d:ds) (Branch left right) = ...\n</code></pre>\n\n<p>Now you have six simpler functions to define. Some are easy, some are less so, but this should give you somewhere to start, or at least refine what you are asking about.</p>\n"}], "owner": {"reputation": 3, "user_id": 7600869, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b01afec8b17ee735ffa4b2007c9be280?s=128&d=identicon&r=PG&f=1", "display_name": "ron evans", "link": "https://stackoverflow.com/users/7600869/ron-evans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "closed_date": 1521709134, "answer_count": 1, "score": -2, "last_activity_date": 1521835307, "creation_date": 1521661595, "last_edit_date": 1521835307, "question_id": 49415310, "link": "https://stackoverflow.com/questions/49415310/using-binary-trees-in-haskell-trying-to-use-paths", "closed_reason": "Not suitable for this site", "title": "Using binary trees in Haskell - Trying to use paths", "body": "<p>I'm struggling to go about this, so basically binary tree can be used as a database. Here, the leaves of a tree are either ND indicating no data, or Data d where d is a data item.</p>\n\n<pre><code>data Btree a = ND | Data a | Branch (Btree a) (Btree a)\n\ndata Dir = L | R\n\ntype Path = [Dir]\n</code></pre>\n\n<p>So one can give a path to a leaf by giving a list such as [L,R,L] which\nindicates the leaf one arrives at by moving left, right, left from the root of the tree (there may be no such leaf). </p>\n\n<p>What I'm trying to do is for example define something called e.g. extract where</p>\n\n<pre><code>extract :: Path  -&gt; Btree a -&gt; Error a\n</code></pre>\n\n<p>which given a path and a binary tree, outputs the data at the end of the path, and gives an error value when the path does not match any data. Any help would be appreciated</p>\n"}, {"tags": ["haskell", "functional-programming", "combinators"], "answers": [{"comments": [{"owner": {"reputation": 2684, "user_id": 784519, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8ed38b4892e7d5f106d8dfde7a4df4fe?s=128&d=identicon&r=PG", "display_name": "davidkomer", "link": "https://stackoverflow.com/users/784519/davidkomer"}, "edited": false, "score": 0, "creation_date": 1521655500, "post_id": 49413069, "comment_id": 85828866, "body": "Thanks! I had just <i>applied</i> cardinal and starling without composing them - that fixed it :)"}, {"owner": {"reputation": 2684, "user_id": 784519, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8ed38b4892e7d5f106d8dfde7a4df4fe?s=128&d=identicon&r=PG", "display_name": "davidkomer", "link": "https://stackoverflow.com/users/784519/davidkomer"}, "edited": false, "score": 0, "creation_date": 1521662507, "post_id": 49413069, "comment_id": 85832788, "body": "Btw not sure if I am just mixing something up in the order between Haskell &lt;-&gt; Javascript but I ended up with Bluebird Starling Cardinal ... proof of concept: <a href=\"https://repl.it/@DavidKomer/SetFromLens\" rel=\"nofollow noreferrer\">repl.it/@DavidKomer/SetFromLens</a>"}, {"owner": {"reputation": 431, "user_id": 3042847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20812bf59589551344aeae214de49f6a?s=128&d=identicon&r=PG&f=1", "display_name": "xgrommx", "link": "https://stackoverflow.com/users/3042847/xgrommx"}, "reply_to_user": {"reputation": 2684, "user_id": 784519, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8ed38b4892e7d5f106d8dfde7a4df4fe?s=128&d=identicon&r=PG", "display_name": "davidkomer", "link": "https://stackoverflow.com/users/784519/davidkomer"}, "edited": false, "score": 1, "creation_date": 1521668659, "post_id": 49413069, "comment_id": 85835844, "body": "@davidkomer also two old my tweets :) <a href=\"https://twitter.com/xgrommx/status/788346309287809025\" rel=\"nofollow noreferrer\">twitter.com/xgrommx/status/788346309287809025</a> <a href=\"https://twitter.com/xgrommx/status/823648079828185088\" rel=\"nofollow noreferrer\">twitter.com/xgrommx/status/823648079828185088</a>"}, {"owner": {"reputation": 431, "user_id": 3042847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20812bf59589551344aeae214de49f6a?s=128&d=identicon&r=PG&f=1", "display_name": "xgrommx", "link": "https://stackoverflow.com/users/3042847/xgrommx"}, "reply_to_user": {"reputation": 2684, "user_id": 784519, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8ed38b4892e7d5f106d8dfde7a4df4fe?s=128&d=identicon&r=PG", "display_name": "davidkomer", "link": "https://stackoverflow.com/users/784519/davidkomer"}, "edited": false, "score": 1, "creation_date": 1521669032, "post_id": 49413069, "comment_id": 85836001, "body": "@davidkomer and interesting stuff with X combinator <a href=\"https://twitter.com/xgrommx/status/756801731846103040\" rel=\"nofollow noreferrer\">twitter.com/xgrommx/status/756801731846103040</a>"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 2684, "user_id": 784519, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8ed38b4892e7d5f106d8dfde7a4df4fe?s=128&d=identicon&r=PG", "display_name": "davidkomer", "link": "https://stackoverflow.com/users/784519/davidkomer"}, "edited": false, "score": 1, "creation_date": 1521681479, "post_id": 49413069, "comment_id": 85839557, "body": "(1) @davidkomer <code>bluebird starling cardinal</code> it is indeed (or, in another dialect, <code>(&lt;*&gt;) . flip</code>). (2) This definition (and also, possibly, the fact that <code>(=&lt;&lt;)</code> isn&#39;t regarded as a distinct species of bird) reflects how <code>(&lt;*&gt;)</code> and <code>(=&lt;&lt;)</code> for functions (the reader functor) <a href=\"https://stackoverflow.com/a/40136614/2751851\">are essentially the same thing</a>."}], "tags": [], "owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "is_accepted": true, "score": 4, "last_activity_date": 1522046145, "last_edit_date": 1522046145, "creation_date": 1521653646, "answer_id": 49413069, "question_id": 49412721, "link": "https://stackoverflow.com/questions/49412721/bird-name-for-the-combinator/49413069#49413069", "title": "Bird name for the (=&lt;&lt;) combinator?", "body": "<blockquote>\n  <p>Is there an official bird-name for this?</p>\n</blockquote>\n\n<p>I can't find it in <a href=\"http://hackage.haskell.org/package/data-aviary-0.4.0/docs/Data-Aviary-Birds.html\" rel=\"nofollow noreferrer\">Data.Aviary.Birds</a>, so I suppose there's not. If there was, it probably would've been referenced in the list you linked.</p>\n\n<blockquote>\n  <p>Or can it be derived via the pre-existing ones?</p>\n</blockquote>\n\n<p>Surely. The easiest might be to start with the <a href=\"http://hackage.haskell.org/package/data-aviary-0.4.0/docs/Data-Aviary-Birds.html#v:starling\" rel=\"nofollow noreferrer\"><code>starling</code></a> whose signature is similar, and just compose it with <code>flip</code>, i.e.</p>\n\n<pre><code>(=&lt;&lt;) = bluebird starling cardinal\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2684, "user_id": 784519, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8ed38b4892e7d5f106d8dfde7a4df4fe?s=128&d=identicon&r=PG", "display_name": "davidkomer", "link": "https://stackoverflow.com/users/784519/davidkomer"}, "edited": false, "score": 0, "creation_date": 1521729385, "post_id": 49413975, "comment_id": 85864458, "body": "Btw do you have any advice on how to combine combinators to get a specific signature? I feel like I&#39;m missing some trick (my current technique of staring at a list and doing mental gymnastics doesn&#39;t scale too well!)"}, {"owner": {"reputation": 431, "user_id": 3042847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20812bf59589551344aeae214de49f6a?s=128&d=identicon&r=PG&f=1", "display_name": "xgrommx", "link": "https://stackoverflow.com/users/3042847/xgrommx"}, "reply_to_user": {"reputation": 2684, "user_id": 784519, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8ed38b4892e7d5f106d8dfde7a4df4fe?s=128&d=identicon&r=PG", "display_name": "davidkomer", "link": "https://stackoverflow.com/users/784519/davidkomer"}, "edited": false, "score": 1, "creation_date": 1521740627, "post_id": 49413975, "comment_id": 85872263, "body": "This is like LEGO :)"}], "tags": [], "owner": {"reputation": 431, "user_id": 3042847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20812bf59589551344aeae214de49f6a?s=128&d=identicon&r=PG&f=1", "display_name": "xgrommx", "link": "https://stackoverflow.com/users/3042847/xgrommx"}, "is_accepted": false, "score": 3, "last_activity_date": 1521656619, "creation_date": 1521656619, "answer_id": 49413975, "question_id": 49412721, "link": "https://stackoverflow.com/questions/49412721/bird-name-for-the-combinator/49413975#49413975", "title": "Bird name for the (=&lt;&lt;) combinator?", "body": "<p>maybe will be correctly like: <code>blackbird warbler bluebird</code>\nthis is like</p>\n\n<pre><code>(...) = (.) . (.) -- blackbird\n(.) -- bluebird\njoin -- warbler\n-- and your function will be \nf = join ... (.)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 1, "last_activity_date": 1522136575, "last_edit_date": 1522136575, "creation_date": 1522048709, "answer_id": 49485875, "question_id": 49412721, "link": "https://stackoverflow.com/questions/49412721/bird-name-for-the-combinator/49485875#49485875", "title": "Bird name for the (=&lt;&lt;) combinator?", "body": "<p>Quoting a comment:</p>\n\n<blockquote>\n  <p>Btw do you have any advice on how to combine combinators to get a specific signature? I feel like I'm missing some trick (my current technique of staring at a list and doing mental gymnastics doesn't scale too well!)</p>\n</blockquote>\n\n<p>Let the types guide you. You are looking for:</p>\n\n<pre><code>-- This name is totally made-up.\nmino :: (b -&gt; a -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n</code></pre>\n\n<p>While you won't find it in <a href=\"http://hackage.haskell.org/package/data-aviary-0.4.0/docs/Data-Aviary-Birds.html\" rel=\"nofollow noreferrer\">the list</a>, there is something quite similar:</p>\n\n<pre><code>starling :: (a -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n</code></pre>\n\n<p>If only we had a way to somehow twist <code>starling</code> into what we want...</p>\n\n<pre><code>mino :: (b -&gt; a -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\nmino = f starling\n-- f :: ((a -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c) -&gt; (b -&gt; a -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n</code></pre>\n\n<p>This mysterious <code>f</code> has a rather unwieldy type, so let's abbreviate it for a moment:  with <code>x ~ b -&gt; a -&gt; c</code>, <code>y ~ a -&gt; b -&gt; c</code> and <code>z -&gt; (a -&gt; b) -&gt; a -&gt; c</code>, we have</p>\n\n<pre><code>f :: (y -&gt; z) -&gt; x -&gt; z\n</code></pre>\n\n<p>Another look at the list shows this fits the result type of <code>queer</code>:</p>\n\n<pre><code>queer :: (a -&gt; b) -&gt; (b -&gt; c) -&gt; a -&gt; c\n</code></pre>\n\n<p>Progress!</p>\n\n<pre><code>mino :: (b -&gt; a -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\nmino = queer g starling\n-- g :: x -&gt; y\n-- g :: (b -&gt; a -&gt; c) -&gt; a -&gt; b -&gt; c\n</code></pre>\n\n<p>As for <code>g</code>, there is a great candidate near the top of the list:</p>\n\n<pre><code>cardinal :: (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c\n</code></pre>\n\n<p>And there it is:</p>\n\n<pre><code>mino :: (b -&gt; a -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\nmino = queer cardinal starling\n</code></pre>\n\n<p><code>queer</code>, of course, is <code>cardinal bluebird</code> (i.e. reverse function composition), which leads us back to <a href=\"https://stackoverflow.com/a/49413069/2751851\">Bergi's <code>bluebird starling cardinal</code></a>.</p>\n\n<hr>\n\n<p>GHC can actually assist you with this kind of derivation:</p>\n\n<pre><code>import Data.Aviary.Birds\n\nmino :: (b -&gt; a -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\nmino = _f starling\n</code></pre>\n\n\n\n<pre><code>GHCi&gt; :l Mino.hs\n[1 of 1] Compiling Main             ( Mino.hs, interpreted )\n\nMino.hs:4:8: error:\n    * Found hole:\n        _f\n          :: ((a0 -&gt; b0 -&gt; c0) -&gt; (a0 -&gt; b0) -&gt; a0 -&gt; c0)\n             -&gt; (b -&gt; a -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n      Where: `b0' is an ambiguous type variable\n             `a0' is an ambiguous type variable\n             `c0' is an ambiguous type variable\n             `b' is a rigid type variable bound by\n               the type signature for:\n                 mino :: forall b a c. (b -&gt; a -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n               at Mino.hs:3:1-43\n             `a' is a rigid type variable bound by\n               the type signature for:\n                 mino :: forall b a c. (b -&gt; a -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n               at Mino.hs:3:1-43\n             `c' is a rigid type variable bound by\n               the type signature for:\n                 mino :: forall b a c. (b -&gt; a -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n               at Mino.hs:3:1-43\n      Or perhaps `_f' is mis-spelled, or not in scope\n    * In the expression: _f\n      In the expression: _f starling\n      In an equation for `mino': mino = _f starling\n    * Relevant bindings include\n        mino :: (b -&gt; a -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c (bound at Mino.hs:4:1)\n  |\n4 | mino = _f starling\n  |        ^^\nFailed, no modules loaded.\n</code></pre>\n\n<p>If you want a clean output, though, you have to ask gently:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE PartialTypeSignatures #-}\n\nimport Data.Aviary.Birds\n\nmino :: forall b a c. (b -&gt; a -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\nmino =\n    let s :: (a -&gt; b -&gt; c) -&gt; _\n        s = starling\n    in _f s\n</code></pre>\n\n<p>(A type annotation to <code>starling</code> would make defining <code>s</code> unnecessary; that style, however, would get ugly very quickly with more complicated expressions.)</p>\n\n<pre><code>GHCi&gt; :l Mino.hs\n[1 of 1] Compiling Main             ( Mino.hs, interpreted )\n\nMino.hs:10:8: error:\n    * Found hole:\n        _f\n          :: ((a -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c)\n             -&gt; (b -&gt; a -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n      Where: `b' is a rigid type variable bound by\n               the type signature for:\n                 mino :: forall b a c. (b -&gt; a -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n               at Mino.hs:6:1-57\n             `a' is a rigid type variable bound by\n               the type signature for:\n                 mino :: forall b a c. (b -&gt; a -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n               at Mino.hs:6:1-57\n             `c' is a rigid type variable bound by\n               the type signature for:\n                 mino :: forall b a c. (b -&gt; a -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n               at Mino.hs:6:1-57\n      Or perhaps `_f' is mis-spelled, or not in scope\n    * In the expression: _f\n      In the expression: _f s\n      In the expression:\n        let\n          s :: (a -&gt; b -&gt; c) -&gt; _\n          s = starling\n        in _f s\n    * Relevant bindings include\n        s :: (a -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c (bound at Mino.hs:9:9)\n        mino :: (b -&gt; a -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c (bound at Mino.hs:7:1)\n   |\n10 |     in _f s\n   |        ^^\nFailed, no modules loaded.\n</code></pre>\n\n<hr>\n\n<p>The process described above still involves quite a bit of staring at the list, as we are working it out using nothing but the birds in their pointfree majesty. Without such constraints, though, we would likely proceed in a different manner:</p>\n\n<pre><code>mino :: (b -&gt; a -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\nmino g f = _\n</code></pre>\n\n<p>The hole has type <code>a -&gt; c</code>, so we know it is a function that takes an <code>a</code>:</p>\n\n<pre><code>mino :: (b -&gt; a -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\nmino g f = \\x -&gt; _\n-- x :: a\n</code></pre>\n\n<p>The only other thing that takes an <code>a</code> here is <code>g</code>:</p>\n\n<pre><code>mino :: (b -&gt; a -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\nmino g f = \\x -&gt; g _ x\n</code></pre>\n\n<p>The type of the hole is now <code>b</code>, and the only thing that gives out a <code>b</code> is <code>f</code>:</p>\n\n<pre><code>mino :: (b -&gt; a -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\nmino g f = \\x -&gt; g (f x) x\n</code></pre>\n\n<p>This, of course, is the usual definition of the reader <code>(=&lt;&lt;)</code>. If we flip <code>g</code>, though...</p>\n\n<pre><code>mino :: (b -&gt; a -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\nmino g f = \\x -&gt; flip g x (f x)\n</code></pre>\n\n<p>... the reader <code>(&lt;*&gt;)</code> (i.e. the S combinator) becomes recogniseable:</p>\n\n<pre><code>mino :: (b -&gt; a -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\nmino g f = \\x -&gt; (&lt;*&gt;) (flip g) f x\n</code></pre>\n\n<p>We can then write it pointfree...</p>\n\n<pre><code>mino :: (b -&gt; a -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\nmino = (&lt;*&gt;) . flip\n</code></pre>\n\n<p>... and translate to birdspeak:</p>\n\n<pre><code>mino :: (b -&gt; a -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\nmino = bluebird starling cardinal\n</code></pre>\n"}], "owner": {"reputation": 2684, "user_id": 784519, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/8ed38b4892e7d5f106d8dfde7a4df4fe?s=128&d=identicon&r=PG", "display_name": "davidkomer", "link": "https://stackoverflow.com/users/784519/davidkomer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 441, "favorite_count": 0, "accepted_answer_id": 49413069, "answer_count": 3, "score": 3, "last_activity_date": 1522136575, "creation_date": 1521652587, "question_id": 49412721, "link": "https://stackoverflow.com/questions/49412721/bird-name-for-the-combinator", "title": "Bird name for the (=&lt;&lt;) combinator?", "body": "<p>The Haskell aviary combinators lists <a href=\"http://hackage.haskell.org/package/data-aviary-0.4.0/docs/Data-Aviary-Functional.html#v:-61--60--60-\" rel=\"nofollow noreferrer\">(=&lt;&lt;)</a> as:</p>\n\n<pre><code>(a -&gt; r -&gt; b) -&gt; (r -&gt; a) -&gt; r -&gt; b\n</code></pre>\n\n<p>Is there an official bird-name for this? Or can it be derived via the pre-existing ones?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1521634867, "post_id": 49406019, "comment_id": 85813329, "body": "That <code>ParseError</code> is just a shortname for <code>Text.Parsec.Error.ParseError</code>. But your question is about the error, I presume? What does it say?"}, {"owner": {"reputation": 29, "user_id": 9434305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30e65c4c1fa6d6422aac37117ef3c678?s=128&d=identicon&r=PG&f=1", "display_name": "zoff", "link": "https://stackoverflow.com/users/9434305/zoff"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1521635782, "post_id": 49406019, "comment_id": 85814001, "body": "Couldn&#39;t match expected type \u2018Either a0 CSV\u2019                   with actual type \u2018String                                     -&gt; Either Text.Parsec.Error.ParseError CSV\u2019"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1521636077, "post_id": 49406019, "comment_id": 85814218, "body": "The type of <code>parseCSV</code> is <code>FilePath -&gt; String -&gt; Either ParseError CSV</code>, so the type of <code>data</code> (which isn&#39;t a valid identifier, so this code can&#39;t possibly compile) is <code>String -&gt; Either ParseError CSV</code>, whereas the first argument of <code>readIndex</code> should have type <code>Either a CSV</code>."}, {"owner": {"reputation": 29, "user_id": 9434305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30e65c4c1fa6d6422aac37117ef3c678?s=128&d=identicon&r=PG&f=1", "display_name": "zoff", "link": "https://stackoverflow.com/users/9434305/zoff"}, "edited": false, "score": 0, "creation_date": 1521639515, "post_id": 49406019, "comment_id": 85816875, "body": "I am new to Haskell, so what would be a final solution? Should I use a function parseCSVFromFile or how to rewrite the existing one? tnx"}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1521640778, "post_id": 49408120, "comment_id": 85817928, "body": "I&#39;d rename one of the two <code>csv</code> variables, to avoid shadowing which might confuse a human reader."}, {"owner": {"reputation": 29, "user_id": 9434305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30e65c4c1fa6d6422aac37117ef3c678?s=128&d=identicon&r=PG&f=1", "display_name": "zoff", "link": "https://stackoverflow.com/users/9434305/zoff"}, "edited": false, "score": 0, "creation_date": 1521644438, "post_id": 49408120, "comment_id": 85820939, "body": "Thank you for Your help, I have only one more question, how can I save that output (IO) from main to let&#39;s say Integer and then apply sum function on that list?"}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "reply_to_user": {"reputation": 29, "user_id": 9434305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30e65c4c1fa6d6422aac37117ef3c678?s=128&d=identicon&r=PG&f=1", "display_name": "zoff", "link": "https://stackoverflow.com/users/9434305/zoff"}, "edited": false, "score": 0, "creation_date": 1521714059, "post_id": 49408120, "comment_id": 85852975, "body": "@zoff Not quite sure, but it sounds like you need to understand more about the IO monad. Try reading up on it here: <a href=\"http://book.realworldhaskell.org/read/io.html\" rel=\"nofollow noreferrer\">book.realworldhaskell.org/read/io.html</a>"}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "reply_to_user": {"reputation": 29, "user_id": 9434305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30e65c4c1fa6d6422aac37117ef3c678?s=128&d=identicon&r=PG&f=1", "display_name": "zoff", "link": "https://stackoverflow.com/users/9434305/zoff"}, "edited": false, "score": 0, "creation_date": 1521714378, "post_id": 49408120, "comment_id": 85853226, "body": "@zoff: I&#39;ve already separated <code>extractColumn</code> from the IO layer. You can similarly extend this function with e.g. <code>sum (extractColumn ...)</code> or any other calculation that assumes pure integer list input."}, {"owner": {"reputation": 29, "user_id": 9434305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30e65c4c1fa6d6422aac37117ef3c678?s=128&d=identicon&r=PG&f=1", "display_name": "zoff", "link": "https://stackoverflow.com/users/9434305/zoff"}, "edited": false, "score": 0, "creation_date": 1521796561, "post_id": 49408120, "comment_id": 85893756, "body": "@SimonShine why do I get an error  ( Couldn&#39;t match type \u2018Either Text.Parsec.Error.ParseError CSV\u2019                    with \u2018[Record]\u2019     Expected type: CSV       Actual type: Either Text.Parsec.Error.ParseError CSV ) when I run a command extractColumn csv&#39; 2 :: [Integer] (I have saved csv&#39; &lt;- parseCSVFromFile &quot;test.csv&quot;)"}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "reply_to_user": {"reputation": 29, "user_id": 9434305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30e65c4c1fa6d6422aac37117ef3c678?s=128&d=identicon&r=PG&f=1", "display_name": "zoff", "link": "https://stackoverflow.com/users/9434305/zoff"}, "edited": false, "score": 0, "creation_date": 1521796789, "post_id": 49408120, "comment_id": 85893881, "body": "@zoff: StackOverflow is not a good platform for forth-and-back debugging. I suggest you put your code in a pastebin and go to the <a href=\"https://webchat.freenode.net/?channels=%23haskell\" rel=\"nofollow noreferrer\">freenode IRC #haskell channel</a> and ask. But basically: You&#39;re mixing up the variables <code>csv</code> and <code>csv&#39;</code> just like @chi feared you might. Try <code>extractColumn csv 2</code> like the code says. The variable <code>test_csv</code> (was <code>csv&#39;</code>) is <i>not</i> a <i>CSV</i> but an <i>Either ParseError CSV</i>. You first have to unwrap it."}], "tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": false, "score": 1, "last_activity_date": 1521796658, "last_edit_date": 1521796658, "creation_date": 1521640224, "answer_id": 49408120, "question_id": 49406019, "link": "https://stackoverflow.com/questions/49406019/haskell-text-csv-module/49408120#49408120", "title": "Haskell Text.CSV module", "body": "<p>The question you really seem to be asking is <em>How do I use Text.CSV?</em></p>\n\n<p>Given the file test.csv:</p>\n\n<pre><code>1,Banana,17\n2,Apple,14\n3,Pear,21\n</code></pre>\n\n<p>and this line in GHCi:</p>\n\n<pre><code>Prelude&gt; Text.CSV.parseCSVFromFile \"test.csv\"\nRight [[\"1\",\"Banana\",\"17\"],[\"2\",\"Apple\",\"14\"],[\"3\",\"Pear\",\"21\"],[\"\"]]\n</code></pre>\n\n<p>If you want to extract a column, then build a function for that:</p>\n\n<pre><code>main :: IO ()\nmain = do\n  test_csv &lt;- parseCSVFromFile \"test.csv\"\n  case test_csv of\n    Right csv -&gt; print (extractColumn csv 2 :: [Int])\n    Left err -&gt; print err\n\nextractColumn :: Read t =&gt; CSV -&gt; Int -&gt; [t]\nextractColumn csv n =\n  [ read (record !! n) | record &lt;- csv\n                       , length record &gt; n\n                       , record /= [\"\"] ]\n</code></pre>\n\n<p>This should produce the output <code>[17,14,21]</code>.</p>\n\n<p>Since there is ample room for failure here (a line could contain fewer fields than <code>n</code>, or the string in field <code>n</code> on a given line could fail to read as type <em>t</em>), you may want to handle or report if errors occur. The code above just throws away the line if it contains too few fields and throws a <code>Prelude.read: no parse</code> if the field isn't an <em>Int</em>. Consider <a href=\"https://hackage.haskell.org/package/base-4.11.0.0/docs/Text-Read.html#v:readEither\" rel=\"nofollow noreferrer\"><code>readEither</code></a> or <a href=\"https://hackage.haskell.org/package/base-4.11.0.0/docs/Text-Read.html#v:readMaybe\" rel=\"nofollow noreferrer\"><code>readMaybe</code></a>.</p>\n"}], "owner": {"reputation": 29, "user_id": 9434305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30e65c4c1fa6d6422aac37117ef3c678?s=128&d=identicon&r=PG&f=1", "display_name": "zoff", "link": "https://stackoverflow.com/users/9434305/zoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 823, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521796658, "creation_date": 1521634216, "last_edit_date": 1521637303, "question_id": 49406019, "link": "https://stackoverflow.com/questions/49406019/haskell-text-csv-module", "title": "Haskell Text.CSV module", "body": "<p>Why do I get type <em>Either Text.Parsec.Error.ParseError CSV</em> for the <code>parseCSV</code> function although in the documentation it says that output is <em>Either ParseError CSV</em>? I want to import a CSV file into Haskell and then export specific column from it and then compute statistics for that column.</p>\n\n<p>I import a CSV file like:</p>\n\n<pre><code>data = parseCSV \"/home/user/Haskell/data/data.csv\"\n\nnoEmpRows = either (const []) (filter (\\row -&gt; 2 &lt;= length row))\n\nreadIndex :: Read cell =&gt; Either a CSV -&gt; Int -&gt; [cell]\n\nreadIndex csv index = map (read . (!!index)) (noEmpRows csv)\n</code></pre>\n\n<p>and then I get an error when I want to <code>readIndex data 9 :: [Integer]</code>. </p>\n\n<p>I've tried also a function <code>parseCSVFromFile</code>.</p>\n\n<p><a href=\"https://hackage.haskell.org/package/csv-0.1.2/docs/Text-CSV.html#t:CSV\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/csv-0.1.2/docs/Text-CSV.html#t:CSV</a></p>\n\n<p>Thanks in advance for your help.</p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 1, "creation_date": 1521634116, "post_id": 49401279, "comment_id": 85812792, "body": "Maybe I&#39;m misunderstanding this, but why are you stopping the thread that&#39;s writing data if you don&#39;t want the connection to close? You could just produce a message saying there won&#39;t be any more data at the end of <code>produceData</code>, wait indefinitely and make the client always send a stop message when they&#39;ve read that there&#39;s no data right (at least I&#39;m thinking that the problem is that you want to make sure the client had the chance to read all data before the connection is killed, if that&#39;s not it please elaborate)."}, {"owner": {"reputation": 58948, "user_id": 857807, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/297e4dba223f5103614030100eab78ca?s=128&d=identicon&r=PG", "display_name": "dcastro", "link": "https://stackoverflow.com/users/857807/dcastro"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1521639894, "post_id": 49401279, "comment_id": 85817161, "body": "@Cubic &quot;why are you stopping the thread that&#39;s writing data if you don&#39;t want the connection to close?&quot; -- The producer may stop producing, in which case it goes back to the main <code>forever</code> loop and waits for a new <code>Start</code> message to be sent, and start producing again. I don&#39;t want the connection to ever be killed (unless the user navigates away, of course)."}, {"owner": {"reputation": 58948, "user_id": 857807, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/297e4dba223f5103614030100eab78ca?s=128&d=identicon&r=PG", "display_name": "dcastro", "link": "https://stackoverflow.com/users/857807/dcastro"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1521640340, "post_id": 49401279, "comment_id": 85817548, "body": "@Cubic I&#39;ve edited the question, I hope it&#39;s more clear now."}], "answers": [{"tags": [], "owner": {"reputation": 58948, "user_id": 857807, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/297e4dba223f5103614030100eab78ca?s=128&d=identicon&r=PG", "display_name": "dcastro", "link": "https://stackoverflow.com/users/857807/dcastro"}, "is_accepted": true, "score": 0, "last_activity_date": 1523970171, "creation_date": 1523970171, "answer_id": 49878909, "question_id": 49401279, "link": "https://stackoverflow.com/questions/49401279/how-to-stop-listening-for-a-message-without-killing-a-yesod-websocket-connection/49878909#49878909", "title": "How to stop listening for a message without killing a yesod-websocket connection?", "body": "<p>Since I couldn't find a more graceful solution, I ended up using an <code>IORef Bool</code> to synchronize the websockets thread and the producer thread.</p>\n\n<pre><code>wsApp :: WebSocketsT Handler ()\nwsApp = do\n  producing &lt;- newIORef False\n  forever $ do\n    msg &lt;- receiveMsg\n    case msg of\n      StartMsg -&gt; do\n        whenM (not &lt;$&gt; readIORef producing) $ do\n          atomicWriteIORef producing True\n          void . async $ produceData producing\n      StopMsg -&gt; atomicWriteIORef producing False\n\nproduceData :: IORef Bool -&gt; WebSocketsT Handler ()\nproduceData producing =\n  whenM (readIORef producing) $\n    case produce of\n      Nothing -&gt; atomicWriteIORef producing False\n      Just x  -&gt; sendMsg x &gt;&gt; produceData producing\n</code></pre>\n"}], "owner": {"reputation": 58948, "user_id": 857807, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/297e4dba223f5103614030100eab78ca?s=128&d=identicon&r=PG", "display_name": "dcastro", "link": "https://stackoverflow.com/users/857807/dcastro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 0, "accepted_answer_id": 49878909, "answer_count": 1, "score": 0, "last_activity_date": 1523970171, "creation_date": 1521620545, "last_edit_date": 1521640304, "question_id": 49401279, "link": "https://stackoverflow.com/questions/49401279/how-to-stop-listening-for-a-message-without-killing-a-yesod-websocket-connection", "title": "How to stop listening for a message without killing a yesod-websocket connection?", "body": "<p>I'm writing an app using <code>yesod-websockets</code>, and whenever I receive a \"Start\" message, I need to run a thread that continuously produces data and sends it to the client, until the client tells it to stop. The producer may also stop producing data on its own.</p>\n\n<p>When the producer stops (regardless of whether it stopped producing on its own, or the client told it to stop), it goes back to the main loop and waits for another \"Start\" message to be received.</p>\n\n<p>The code looks something like this (runnable minimal repro below):</p>\n\n<pre><code>wsApp :: WebSocketsT Handler ()\nwsApp = \n  forever $ do\n    msg &lt;- receiveMsg\n    case msg of\n      StartMsg -&gt; do\n        race_\n          (produceData)\n          (whileM ((/= StopMsg) &lt;$&gt; receiveMsg))\n</code></pre>\n\n<p>The problem is that if <code>produceData</code> stops on its own, then the thread running <code>receiveMsg</code> will be cancelled, and this causes the websocket connection to be closed.</p>\n\n<blockquote>\n  <p>21/Mar/2018:08:21:06 +0000 [Error#yesod] Exception from Warp: ConnectionClosed @(app-0.0.0-5bzI9Onrk2fFepGGsdocDz:Application src/Application.hs:122:15)</p>\n</blockquote>\n\n<p>Is there a way to cancel a thread that's listening on the connection, without killing the connection?</p>\n\n<p>Here's a minimal repro:</p>\n\n<pre><code>wsApp :: WebSocketsT Handler ()\nwsApp = forever $ do\n  race_\n    (receiveData :: WebSocketsT Handler Text)\n    (pure ())\n  $logDebug \"Trying again\"\n</code></pre>\n\n<p>The second thread will finish, and the first one will be cancelled, causing the connection to be killed.</p>\n"}, {"tags": ["haskell", "maybe"], "comments": [{"owner": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "edited": false, "score": 0, "creation_date": 1521613349, "post_id": 49399176, "comment_id": 85800169, "body": "&quot; Couldn&#39;t match expected type \u2018a\u2019 with actual type \u2018Maybe a\u2019&quot;, &quot;In the second argument of \u2018(&gt;)\u2019, namely \u2018max_elem xs\u2019&quot;. seems clear to me"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1521613920, "post_id": 49399176, "comment_id": 85800425, "body": "You could try <code>import Data.List (findIndex)</code> and <code>findIndex (== maximum x) x</code>, but it would be better to find your error."}, {"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 0, "creation_date": 1522357009, "post_id": 49399176, "comment_id": 86138008, "body": "I really prefer to divide specific operations into specific functions. There is the calculation and there is the error checking and input validation. Each, it seems to me, in a separate function is cleaner."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1521625451, "post_id": 49400694, "comment_id": 85806740, "body": "I&#39;d use <code>else Just y</code>, otherwise we recompute the maximum, causing an exponential blow up!"}, {"owner": {"reputation": 824, "user_id": 6914498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/025023af1858a74ebe1cb8c9b21f47ab?s=128&d=identicon&r=PG", "display_name": "wisn", "link": "https://stackoverflow.com/users/6914498/wisn"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1521628426, "post_id": 49400694, "comment_id": 85808880, "body": "@chi Thanks! Edited."}, {"owner": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "edited": false, "score": 1, "creation_date": 1521630006, "post_id": 49400694, "comment_id": 85809941, "body": "&quot;max_elem [x]    = Just x&quot; could be skipped"}, {"owner": {"reputation": 824, "user_id": 6914498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/025023af1858a74ebe1cb8c9b21f47ab?s=128&d=identicon&r=PG", "display_name": "wisn", "link": "https://stackoverflow.com/users/6914498/wisn"}, "reply_to_user": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "edited": false, "score": 0, "creation_date": 1521631065, "post_id": 49400694, "comment_id": 85810673, "body": "@max630 Thanks! Edited."}], "tags": [], "owner": {"reputation": 824, "user_id": 6914498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/025023af1858a74ebe1cb8c9b21f47ab?s=128&d=identicon&r=PG", "display_name": "wisn", "link": "https://stackoverflow.com/users/6914498/wisn"}, "is_accepted": false, "score": 2, "last_activity_date": 1521631045, "last_edit_date": 1521631045, "creation_date": 1521618144, "answer_id": 49400694, "question_id": 49399176, "link": "https://stackoverflow.com/questions/49399176/how-to-find-maximum-element-in-list-with-maybe-output/49400694#49400694", "title": "How to find Maximum element in List with maybe output", "body": "<p>The error message was clear enough to solve your problem.</p>\n\n<pre><code>|x &gt;  max_elem xs = Just x\n</code></pre>\n\n<p>The problem is that you compare <code>x</code> which is <code>a</code> with <code>max_elem</code> which is <code>Maybe a</code>. That's why you got such error message. You can solve the problem with this code below.</p>\n\n<pre><code>max_elem :: (Ord a) =&gt; [a] -&gt; Maybe a \nmax_elem []     = Nothing\nmax_elem (x:xs) = case (max_elem xs) of\n  Nothing -&gt; Just x\n  Just y  -&gt; if x &gt; y then Just x else Just y\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1521637531, "post_id": 49400756, "comment_id": 85815245, "body": "<code>fmap maximum (if null x then Nothing else Just x)</code> is probably simpler. No need to wrap each element of the list in <code>Just</code>, just a non-empty list itself."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1521800021, "post_id": 49400756, "comment_id": 85895960, "body": "Well, in real world I wouldn&#39;t use <code>maximum</code> function for list at first place anyways. The cost of wrapping every element into <code>Maybe</code> is nothing compared to inefficiency of  <code>maximum</code> function, which most likely contains space leaks."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1521806950, "post_id": 49400756, "comment_id": 85900460, "body": "<code>maximum</code> isn&#39;t much more than a wrapper around <code>foldMap</code> using a <code>Max</code> monoid; it&#39;s not that much different than what you wrote above."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1521833911, "post_id": 49400756, "comment_id": 85917322, "body": "Yeah, as as I said in my anwer, my implementation also not perfect. It has the same problem. But I guess it&#39;s okay for Haskell beginner not to dive into such things for now."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1521834537, "post_id": 49400756, "comment_id": 85917594, "body": "Sorry, I meant to come back and note the my suggestion could also be simplified to <code>if null x then Nothing else maximum x</code>, since <code>maximum</code> basically just assumes that the fold won&#39;t return <code>Nothing</code> (it&#39;s literally a composition of <code>fromJust</code> and <code>foldr</code>.)"}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1521851636, "post_id": 49400756, "comment_id": 85922966, "body": "@chepner This solution is much nicer, you&#39;re right :)"}], "tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": false, "score": 2, "last_activity_date": 1521618448, "creation_date": 1521618448, "answer_id": 49400756, "question_id": 49399176, "link": "https://stackoverflow.com/questions/49399176/how-to-find-maximum-element-in-list-with-maybe-output/49400756#49400756", "title": "How to find Maximum element in List with maybe output", "body": "<p>You get your error because of this line: <code>x &gt;  max_elem xs</code>. <code>max_elem xs</code> has type <code>Maybe a</code> where <code>a</code> is an element of a list. It has type <code>a</code>. You can't compare values of different types. <code>a</code> and <code>Maybe a</code> are different types. See Haskell equality table:</p>\n\n<ul>\n<li><a href=\"https://htmlpreview.github.io/?https://github.com/quchen/articles/blob/master/haskell-equality-table.html\" rel=\"nofollow noreferrer\">https://htmlpreview.github.io/?https://github.com/quchen/articles/blob/master/haskell-equality-table.html</a></li>\n</ul>\n\n<p>Replace <code>==</code> operator with <code>&gt;</code> and you will get the same table.</p>\n\n<p>You can solve problem in your code by replacing <code>x &gt;  max_elem xs</code> with <code>Just x &gt; max_elem xs</code>. Does it make sense to you?</p>\n\n<p>As you can see, <code>Maybe a</code> data type has <code>Ord a =&gt; Ord (Maybe a)</code> instance which is actually really handy! So you can implement your function in even more concise way to utilize this <code>Ord</code> instance:</p>\n\n<pre><code>max_elem :: Ord a =&gt; [a] -&gt; Maybe a \nmax_elem = foldr max Nothing . map Just\n</code></pre>\n\n<p>Though, this probably won't be the most efficient solution if you care about performance.</p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 1, "last_activity_date": 1521634672, "last_edit_date": 1521634672, "creation_date": 1521620368, "answer_id": 49401236, "question_id": 49399176, "link": "https://stackoverflow.com/questions/49399176/how-to-find-maximum-element-in-list-with-maybe-output/49401236#49401236", "title": "How to find Maximum element in List with maybe output", "body": "<p>We can generalize this task and work with all <code>Foldable</code>s. Here we thus use the <a href=\"http://hackage.haskell.org/package/base-4.11.0.0/docs/Prelude.html#v:foldr\" rel=\"nofollow noreferrer\"><strong><code>foldr :: Foldable t =&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b</code></strong></a> function that folds a certain <code>Foldable</code> structure. We can do this with the function <code>max . Just</code>, and as initial element <code>Nothing</code>:</p>\n\n<pre><code>max_elem :: (Ord a, Foldable f) =&gt; f a -&gt; Maybe a \nmax_elem = foldr (max . Just) Nothing\n</code></pre>\n\n<p>Note that this works since Haskell defines <code>Maybe a</code> to be an instance of <code>Ord</code>, given <code>a</code> is an instance of <code>Ord</code>, and it implements it in a way that <code>Nothing</code> is smaller than any <code>Just</code> element.</p>\n\n<p>This makes the above definition perhaps a bit \"unsafe\" (in the sense that we here rely on the fact that from the moment we have a <code>Just x</code>, the <code>max</code> will select such <code>Just x</code> over a <code>Nothing</code>). When we would use <code>min</code>, this would not work (not without using some tricks).</p>\n\n<p>We can also use pattern guards and thus solve the case where the list is empty in a different way, like:</p>\n\n<pre><code>max_elem :: Ord a =&gt; [a] -&gt; Maybe a \nmax_elem [] = Nothing\nmax_elem l = Just (maximum l)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1521670540, "last_edit_date": 1521670540, "creation_date": 1521670209, "answer_id": 49417350, "question_id": 49399176, "link": "https://stackoverflow.com/questions/49399176/how-to-find-maximum-element-in-list-with-maybe-output/49417350#49417350", "title": "How to find Maximum element in List with maybe output", "body": "<p>The problem is <code>x &gt; max_elem xs</code>; <code>max_elem xs</code> is <code>Maybe a</code>, not <code>a</code>, meaning that it might return <code>Nothing</code>.   However, you do know that it will only return <code>Nothing</code> if <code>xs</code> is empty, but you know <code>xs</code> won't be empty because you matched the case where it would <code>using [x]</code>.  You can take advantage of this fact by writing a \"non-empty\" maximum:</p>\n\n<pre><code>max_elem_ne :: Ord a =&gt; a -&gt; [a] -&gt; a\nmax_elem_ne m []     = m\nmax_elem_ne m (x:xs)\n  | m &gt; x     = max_elem m xs\n  | otherwise = max_elem x xs\n</code></pre>\n\n<p>Or, alternatively, using <code>max</code>:</p>\n\n<pre><code>max_elem_ne :: Ord a =&gt; a -&gt; [a] -&gt; a\nmax_elem_ne m []     = m\nmax_elem_ne m (x:xs) = max_elem (max m x) xs\n</code></pre>\n\n<p>You can think of the first argument as the maximum value seen \"so far\", and the second list argument as the list of other candidates.</p>\n\n<p>In this last form, you might have noticed that <code>max_elem_ne</code> is actually a just left fold, so you could even just write:</p>\n\n<pre><code>max_elem_ne :: Ord a =&gt; a -&gt; [a] -&gt; a\nmax_elem_ne = foldl' max\n</code></pre>\n\n<p>Now, with <code>max_elem_ne</code>, you can write your original <code>max_elem</code>:</p>\n\n<p>Then you can write:</p>\n\n<pre><code>max_elem :: Ord a =&gt; [a] -&gt; Maybe a\nmax_elem []     = Nothing\nmax_elem (x:xs) = Just (max_elem_ne x xs)\n</code></pre>\n\n<p>So you don't have to do any extraneous checks (like you would if you redundantly pattern matched on results), and the whole thing is type-safe.</p>\n\n<p>You can also use the <code>uncons :: [a] -&gt; Maybe (a,[a])</code> utility function with <code>fmap</code> and <code>uncurry</code> to write:</p>\n\n<pre><code>max_elem :: Ord a =&gt; [a] -&gt; Maybe a\nmax_elem = fmap (uncurry max_elem_ne) . uncons\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 7888923, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8d5e00d3fdb902cd98979b65909a6188?s=128&d=identicon&r=PG&f=1", "display_name": "adsbb pppp", "link": "https://stackoverflow.com/users/7888923/adsbb-pppp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1628, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1521670540, "creation_date": 1521611846, "question_id": 49399176, "link": "https://stackoverflow.com/questions/49399176/how-to-find-maximum-element-in-list-with-maybe-output", "title": "How to find Maximum element in List with maybe output", "body": "<p>This code works</p>\n\n<pre><code>max_elem :: (Ord a) =&gt; [a] -&gt; a \nmax_elem [x] = x \nmax_elem [] = error \"No elements\" \nmax_elem (x:xs)  \n    |x &gt; max_elem xs = x \n    |otherwise = max_elem xs\n</code></pre>\n\n<p>I want to have it so it returns Nothing if their are no elements and Just x for the maximum element\nI tried the following</p>\n\n<pre><code>max_elem :: (Ord a) =&gt; [a] -&gt; Maybe a \nmax_elem [x] = Just x \nmax_elem [] = Nothing\nmax_elem (x:xs) \n    |x &gt;  max_elem xs = Just x\n    |otherwise = max_elem xs \n</code></pre>\n\n<p>I got the following error. Recommendations to fix this please.</p>\n\n<pre><code> \u2022 Couldn't match expected type \u2018a\u2019 with actual type \u2018Maybe a\u2019\n      \u2018a\u2019 is a rigid type variable bound by\n        the type signature for:\n          max_elem :: forall a. Ord a =&gt; [a] -&gt; Maybe a\n        at &lt;interactive&gt;:208:13\n    \u2022 In the second argument of \u2018(&gt;)\u2019, namely \u2018max_elem xs\u2019\n      In the expression: x &gt; max_elem xs\n      In a stmt of a pattern guard for\n                     an equation for \u2018max_elem\u2019:\n        x &gt; max_elem xs\n    \u2022 Relevant bindings include\n        xs :: [a] (bound at &lt;interactive&gt;:211:13)\n        x :: a (bound at &lt;interactive&gt;:211:11)\n        max_elem :: [a] -&gt; Maybe a (bound at &lt;interactive&gt;:209:1)\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5775230"}, "edited": false, "score": 0, "creation_date": 1521612754, "post_id": 49399088, "comment_id": 85799914, "body": "Another pedantic point..is there any way to substitute d into myQuot without the extra where? apologies as I don&#39;t know if there&#39;s a way to do a multiline comment here     <code>myQuot :: Int -&gt; Int -&gt; Int     myQuot x y = go x 0       where         go x n            | d &lt; 0 = n            | otherwise = go d (n + 1)            where d = x - y</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1521636428, "post_id": 49399088, "comment_id": 85814456, "body": "@WarrickMacmillan, you can do it using <code>fix</code> from <code>Data.Function</code>, but it doesn&#39;t tend to improve clarity."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1521636607, "post_id": 49399088, "comment_id": 85814585, "body": "@WarrickMacmillan By the way, there is no way to do multiline comments. To post such things in comments as valid Haskell, you might use explicit braces and semicolons: <code>myQuot :: Int -&gt; Int -&gt; Int; myQuot x y = go x 0 where { go x n | d &lt; 0 = n | otherwise = go d (n + 1) where { d = x - y } }</code>"}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 4, "last_activity_date": 1521611455, "creation_date": 1521611455, "answer_id": 49399088, "question_id": 49398664, "link": "https://stackoverflow.com/questions/49398664/how-does-one-properly-define-quot-as-a-single-function/49399088#49399088", "title": "How does one properly define &quot;quot&quot; as a single function?", "body": "<p>You use a local binding, either with <code>where</code></p>\n\n<pre><code>myQuot :: Int -&gt; Int -&gt; Int\nmyQuot x y = go x 0\n  where\n    go x n \n       | x &lt; y     = n\n       | otherwise = go (x - y) (n + 1)\n</code></pre>\n\n<p>or <code>let \u2026 in \u2026</code>:</p>\n\n<pre><code>myQuot2 :: Int -&gt; Int -&gt; Int\nmyQuot2 x y = \n  let \n    go x n \n       | x &lt; y     = n\n       | otherwise = go (x - y) (n + 1)\n  in go x y 0\n</code></pre>\n\n<p>Alternatively, you provide both functions but write an easy to use wrapper for your users:</p>\n\n<pre><code>myQuotImp x y n = if x &lt; y then n else myQuout (x - y) y (n + 1)\n\nmyQout3 :: Int -&gt; Int -&gt; Int\nmyQout3 x y = myQuotImp x y 0\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 4, "last_activity_date": 1521614721, "creation_date": 1521614721, "answer_id": 49399877, "question_id": 49398664, "link": "https://stackoverflow.com/questions/49398664/how-does-one-properly-define-quot-as-a-single-function/49399877#49399877", "title": "How does one properly define &quot;quot&quot; as a single function?", "body": "<pre><code>quot x y | x &lt; y = 0\n         | otherwise = 1 + quot (x-y) y\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5775230"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1521614721, "creation_date": 1521609341, "last_edit_date": 1521610100, "question_id": 49398664, "link": "https://stackoverflow.com/questions/49398664/how-does-one-properly-define-quot-as-a-single-function", "title": "How does one properly define &quot;quot&quot; as a single function?", "body": "<p>As an example, I'm trying to define quot in a single function.  I'm struggling to see how to do so without appending an extra parameter (in this case, a counter).  </p>\n\n<pre><code>quot x y n\n  | x &lt; y = n\n  | otherwise = quot (x-y) y (n+1)\n\nquot0 x y = x y 0\n</code></pre>\n\n<p>I've run into this problem multiple times and continue to use this ad hoc solution, while I know there must be an easy way to incorporate the n implicitly.  </p>\n"}, {"tags": ["regex", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 3, "creation_date": 1521609300, "post_id": 49398452, "comment_id": 85798596, "body": "Thanks. Very clear. One can replace <code>intercalate &quot; &quot;</code> with <code>unwords</code> (according to Hlint)."}], "tags": [], "owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "is_accepted": true, "score": 3, "last_activity_date": 1521608063, "creation_date": 1521608063, "answer_id": 49398452, "question_id": 49398374, "link": "https://stackoverflow.com/questions/49398374/extract-numbers-as-strings-from-list-of-numbers/49398452#49398452", "title": "Extract numbers as strings from list of numbers", "body": "<p><code>map</code> will take a function and apply it to each element of a list, and <a href=\"https://hackage.haskell.org/package/base-4.10.1.0/docs/Data-List.html#v:intercalate\" rel=\"nofollow noreferrer\"><code>intercalate</code></a> will position something between every element of a list.</p>\n\n<pre><code>import Data.List\n\nstringify :: Show a =&gt; [a] -&gt; String\nstringify = intercalate \" \" . map show\n</code></pre>\n\n<p>Sample use:</p>\n\n<pre><code>&gt; stringify [1, 2, 3.5]\n\"1.0 2.0 3.5\"\n</code></pre>\n\n<p>The idea is to keep the data in a computer-friendly form for as long as possible. Your approach immediately stringifies the whole thing, then tries to manipulate something that should really be treated as a list of integer as a string, which leads to some messy workarounds, as you've already seen.</p>\n\n<p>It may also be a good exercise to do this by hand. <code>map</code> and <code>intercalate</code> are both fairly easy to implement with just recursion in Haskell, and doing so can be useful practice.</p>\n"}, {"tags": [], "owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "is_accepted": false, "score": 0, "last_activity_date": 1521856066, "last_edit_date": 1521856066, "creation_date": 1521665309, "answer_id": 49416228, "question_id": 49398374, "link": "https://stackoverflow.com/questions/49398374/extract-numbers-as-strings-from-list-of-numbers/49416228#49416228", "title": "Extract numbers as strings from list of numbers", "body": "<p>This did just not seem too obvious but, goodness, I finally thought to try 'show' for the floating point numbers which were very easy to generate. In fact, Haskell converts all numbers of an ostensibly mixed type list to the highest common type. In the case of let [1,2,3,4.5] produces [1.0,2.0,3.0,4.5] just by itself. I should have guessed.\nI found two quick ways to generate the floating point strings.</p>\n\n<pre><code>concat [show fl ++ \" \"| fl &lt;- [1,2,3,4.5]]\n</code></pre>\n\n<p>or</p>\n\n<pre><code>concat $ map (\\st -&gt; show st + \" \") [1,2,3,4.5]\n</code></pre>\n\n<p>These, of course, can easily be parameterized. I do love concat. It is so very versatile.\nThere is a trailing space which is easily removed with an \"init $ ' before concat.</p>\n\n<p>Then, of course, after a few minutes after posting this, I tried</p>\n\n<pre><code>tail . init $ show [1,2,3,4.5]\n</code></pre>\n\n<p>and it worked. haskell is just too cool. But, also of course, my bad.\nThis last bit produces a string but the numbers do not have space between them. There are commas between them :(</p>\n"}], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 49398452, "answer_count": 2, "score": 1, "last_activity_date": 1521856066, "creation_date": 1521607648, "question_id": 49398374, "link": "https://stackoverflow.com/questions/49398374/extract-numbers-as-strings-from-list-of-numbers", "title": "Extract numbers as strings from list of numbers", "body": "<p>I'm really not a star with regular expressions, especially with Haskell and even after reading some tutos.</p>\n\n<p>I have a list of numbers like this:</p>\n\n<pre><code>let x = [1, 2, 3.5]\n</code></pre>\n\n<p>My goal is to have the string <code>\"1.0 2.0 3.5\"</code> from this input.</p>\n\n<p>My idea was to use regular expressions. But the way I use is tedious. First, I do</p>\n\n<pre><code>let xstr = show x\n</code></pre>\n\n<p>Then I remove the first bracket like this:</p>\n\n<pre><code>import           Text.Regex\nlet regex1 = mkRegex \"\\\\[\"\nlet sub1 = subRegex regex1 xstr \"\"\n-- this gives \"1.0,2.0,3.5]\"\n</code></pre>\n\n<p>Then I remove the second bracket similarly: </p>\n\n<pre><code>  let regex2 = mkRegex \"\\\\]\"\n  let sub2 = subRegex regex2 sub1 \"\"\n</code></pre>\n\n<p>Finally I remove the commas and replace them with white spaces: </p>\n\n<pre><code>  let regex3 = mkRegex \",\"\n  let sub3 = subRegex regex3 sub2 \" \"\n</code></pre>\n\n<p>This gives <code>\"1.0 2.0 3.5\"</code>, as desired. </p>\n\n<p>Please do you have a better way ?</p>\n\n<p>I always have lists with 3 elements, so this approach is not irrealistic, but it is tedious and not elegant. I even don't know how to delete the two brackets in one shot.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1521585345, "post_id": 49395184, "comment_id": 85792226, "body": "<i>&quot;Is there any way I can implement these...&quot;</i> Yes. Now what is your question?"}, {"owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 0, "creation_date": 1521585924, "post_id": 49395184, "comment_id": 85792494, "body": "Your <code>Instruction</code> looks weird to me.  Why does the instruction store the data it is operating on?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 1, "creation_date": 1521586264, "post_id": 49395184, "comment_id": 85792638, "body": "@HenriMenke It doesn&#39;t, it contains the box number, like a pointer. It really should be a <code>Word</code> rather than an <code>Int</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1521586770, "post_id": 49395184, "comment_id": 85792820, "body": "This is a nice exercise, but SO is not a &quot;solve this for me&quot; service. Further, are you sure you can&#39;t change the values in any other box? Using a &quot;tmp&quot; auxiliary (scratch) box could be quite useful here."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1521586992, "post_id": 49395184, "comment_id": 85792888, "body": "@chi box 0 is &quot;set aside for calculation purposes&quot;"}, {"owner": {"reputation": 3, "user_id": 8826421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d25b14c9263e05e9ca34b2faf8475e2?s=128&d=identicon&r=PG&f=1", "display_name": "vincentko37", "link": "https://stackoverflow.com/users/8826421/vincentko37"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1521589106, "post_id": 49395184, "comment_id": 85793550, "body": "@AJFarmar what would be an ideal algorithm for this?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1521590260, "post_id": 49395184, "comment_id": 85793851, "body": "Note that, if you have a box X, you can loop X times by resetting box 0, then incrementing box 0 as many times as needed to make it equal to X. In this loop you can perform (X times) any other operation."}], "answers": [{"tags": [], "owner": {"reputation": 2570, "user_id": 4142266, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/rMCN5.png?s=128&g=1", "display_name": "mschmidt", "link": "https://stackoverflow.com/users/4142266/mschmidt"}, "is_accepted": true, "score": 0, "last_activity_date": 1521662101, "creation_date": 1521662101, "answer_id": 49415445, "question_id": 49395184, "link": "https://stackoverflow.com/questions/49395184/simple-adder-and-copy-program-in-haskell/49415445#49415445", "title": "Simple adder and copy program in haskell", "body": "<blockquote>\n  <p>Is there any way I can implement these without changing the values in any other boxes</p>\n</blockquote>\n\n<p>The copy routine is straight forward. You can use box 0 as a counter and copy the value by creating a loop that increments the destination box <code>x</code> times after resetting it to zero. One problem arises while implementing the loop: you need either an unconditional jump instruction or a conditional jump with a negated condition.</p>\n\n<p>Example 1: you can emulate an unconditional jump by comparing the counter and the destination box, which have always the same value within the loop:</p>\n\n<pre><code>copyBox :: Int -&gt; Int -&gt; Program\ncopyBox x y = [ DEL 0      -- 0: clear box 0, we use it as a counter\n              , DEL y      -- 1: clear destination box\n              , JEQ 0 x 6  -- 2: counter reaches value in x =&gt; copying is finished\n              , ADD 0      -- 3: increment counter\n              , ADD y      -- 4: increment destination\n              , JEQ 0 y 2  -- 5: always true, hence jump back to beginning of loop\n              , DEL 0      -- 6: clear box 0 to clean up\n              ]\n</code></pre>\n\n<p>Example 2: Here is a variant, that uses a hypothetical <code>JNEQ</code> instruction:</p>\n\n<pre><code>copyBox :: Int -&gt; Int -&gt; Program\ncopyBox x y = [ DEL 0      -- 0: clear box 0, we use it as a counter\n              , DEL y      -- 1: clear destination box\n              , JEQ 0 x 6  -- 2: x is zero =&gt; skip the copy loop\n              , ADD 0      -- 3: increment counter\n              , ADD y      -- 4: increment destination\n              , JNEQ 0 x 3 -- 5: counter not equal x =&gt; one more iteration\n              , DEL 0      -- 6: clear box 0 to clean up\n              ]\n</code></pre>\n\n<p>For the <code>addXY</code> routine you either need this <code>JNEQ</code> instruction or - if you use the emulation trick of the first example - a further temporary working cell. I currently see no possibility to implement <code>addXY</code> with the provided three instructions and the condition that no box except 0 (temporary) and 1 (result) are modified.</p>\n"}], "owner": {"reputation": 3, "user_id": 8826421, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d25b14c9263e05e9ca34b2faf8475e2?s=128&d=identicon&r=PG&f=1", "display_name": "vincentko37", "link": "https://stackoverflow.com/users/8826421/vincentko37"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "accepted_answer_id": 49415445, "answer_count": 1, "score": 0, "last_activity_date": 1521662101, "creation_date": 1521585046, "last_edit_date": 1521587193, "question_id": 49395184, "link": "https://stackoverflow.com/questions/49395184/simple-adder-and-copy-program-in-haskell", "title": "Simple adder and copy program in haskell", "body": "<p>I am trying to write a program that is just based on 3 instructions</p>\n\n<p>In haskell, they will look like this.</p>\n\n<pre><code>-- DEL b        == empty box b\n\n-- ADD b        == increment box b by 1\n\n-- JEQ b1 b2 j  == if boxes b1 and b2 contain the same value, jump to instruction n\n\ndata Instruction\n  = DEL {box :: Int} \n  | ADD {box :: Int}\n  | JEQ {box1   :: Int, \n         box2   :: Int,\n         jumpTo :: Int}\n  deriving (Eq, Show)\n\ntype Program = [Instruction]\n</code></pre>\n\n<p>Users will input a starting list of values that represent the boxes starting from box1, with box0 being set aside for calculation purposes.</p>\n\n<pre><code>e.g. \nboxes = [0, 4, 6, 5, 12, 20]\n</code></pre>\n\n<p>I already have written the code on how the boxes will change when a program is executed, for example:</p>\n\n<pre><code>pgrm = [ADD 1, DEL 3, ADD 1, JEQ 1 2 4, CLR 4, ADD 4]\n</code></pre>\n\n<p>when pgrm is executed on boxes, the result would be</p>\n\n<pre><code>[0, 6, 6, 0, 13, 20] \n</code></pre>\n\n<p>But i am now trying to implement an adder and copy program using just the 3 instructions given.</p>\n\n<pre><code>-- Adds contents of box x and box y and puts it into box 1\naddXY :: Int -&gt; Int -&gt; Program\n\n-- copy the contents of box x to box y (leave box x unchanged)\ncopyBox :: Int -&gt; Int -&gt; Program\n</code></pre>\n\n<p>Is there any way I can implement these without changing the values in any other boxes, and only using the 3 instructions with an empty box0 to use for calculations? and how would that be done?</p>\n\n<p>PS. I know this is more of a mathematical theory question rather than a coding question. Would appreciate if any math geniuses out there could help me out!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1521579403, "post_id": 49393897, "comment_id": 85789605, "body": "It is in the <code>Data.Function</code> module, and not reimported in the <code>Prelude</code>, so you need to import it yourself."}], "answers": [{"tags": [], "owner": {"reputation": 7033, "user_id": 288201, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b4b21f0f66f55fe614e7eeac6807f7f4?s=128&d=identicon&r=PG", "display_name": "Koterpillar", "link": "https://stackoverflow.com/users/288201/koterpillar"}, "is_accepted": true, "score": 7, "last_activity_date": 1521579352, "creation_date": 1521579352, "answer_id": 49393963, "question_id": 49393897, "link": "https://stackoverflow.com/questions/49393897/haskell-reverse-function-application-operator-not-working/49393963#49393963", "title": "Haskell reverse function application operator not working", "body": "<p>Looks like it's not in scope. <a href=\"https://www.stackage.org/lts/hoogle?q=%26\" rel=\"noreferrer\">Asking Hoogle</a> tells me that you need to import it from, for example, <code>Data.Function</code>:</p>\n\n<pre><code>Prelude&gt; import Data.Function\nPrelude Data.Function&gt; \"hello\" &amp; length\n5\n</code></pre>\n"}], "owner": {"reputation": 460, "user_id": 5879759, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/06d960499e952f8462074dd56a20edaf?s=128&d=identicon&r=PG&f=1", "display_name": "a544jh", "link": "https://stackoverflow.com/users/5879759/a544jh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "accepted_answer_id": 49393963, "answer_count": 1, "score": 2, "last_activity_date": 1521579589, "creation_date": 1521579129, "last_edit_date": 1521579589, "question_id": 49393897, "link": "https://stackoverflow.com/questions/49393897/haskell-reverse-function-application-operator-not-working", "title": "Haskell reverse function application operator not working", "body": "<p>I'm playing around with Haskell, but I can't figure out why the reverse function application operator (&amp;) is not working.</p>\n\n<p>For example in ghci I get: </p>\n\n<pre><code>Prelude&gt; \"hello\" &amp; length\n\n&lt;interactive&gt;:1:9: error:\n    Variable not in scope: (&amp;) :: [Char] -&gt; ([a0] -&gt; Int) -&gt; t\n</code></pre>\n\n<p>When I expect it to return 5</p>\n\n<p>Why is it not working?</p>\n"}, {"tags": ["haskell", "typeclass", "gadt"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1521570093, "post_id": 49391488, "comment_id": 85784630, "body": "<code>class ShowAllNats f where showNat :: f (n :: Nat) -&gt; String</code>?"}, {"owner": {"reputation": 8049, "user_id": 2718064, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/jEp0E.jpg?s=128&g=1", "display_name": "marcosh", "link": "https://stackoverflow.com/users/2718064/marcosh"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1521570421, "post_id": 49391488, "comment_id": 85784815, "body": "thanks @DanielWagner! That seems to work! I&#39;m wondering if there is a more natural way to do that, where I don&#39;t have to define a new class"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1521571088, "post_id": 49391488, "comment_id": 85785228, "body": "Okay, I&#39;ve fleshed that out into an answer -- along with another approach that uses an extra data type rather than an extra class."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 3, "last_activity_date": 1521570966, "creation_date": 1521570966, "answer_id": 49391827, "question_id": 49391488, "link": "https://stackoverflow.com/questions/49391488/defining-type-class-instance-on-gadt/49391827#49391827", "title": "defining type class instance on GADT", "body": "<p>I think this would be a natural way:</p>\n\n<pre><code>class ShowAllNats f where showNat :: f (n :: Nat) -&gt; String\ninstance ShowAllNats foo =&gt; Show (Test foo n) where\n    show Final = \"final\"\n    show (Step bar step) = showNat bar ++ show step\n</code></pre>\n\n<p>One can avoid an additional type class by existentially quantifying:</p>\n\n<pre><code>data Some f where Some :: f (n :: Nat) -&gt; Some f\ninstance Show (Some foo) =&gt; Show (Test foo n) where\n    show Final = \"final\"\n    show (Step bar step) = show (Some bar) ++ show step\n</code></pre>\n"}], "owner": {"reputation": 8049, "user_id": 2718064, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/jEp0E.jpg?s=128&g=1", "display_name": "marcosh", "link": "https://stackoverflow.com/users/2718064/marcosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 49391827, "answer_count": 1, "score": 0, "last_activity_date": 1521570966, "creation_date": 1521569804, "question_id": 49391488, "link": "https://stackoverflow.com/questions/49391488/defining-type-class-instance-on-gadt", "title": "defining type class instance on GADT", "body": "<p>Consider the following code</p>\n\n<pre><code>{-# LANGUAGE DataKinds             #-}\n{-# LANGUAGE FlexibleContexts      #-}\n{-# LANGUAGE GADTs                 #-}\n{-# LANGUAGE KindSignatures        #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n\nmodule Test where\n\ndata Nat\n    = Z\n    | S Nat\n    deriving Show\n\ndata Test foo (n :: Nat) where\n    Final :: Test foo n\n    Step :: foo n -&gt; Test foo (S n) -&gt; Test foo n\n\ninstance Show (foo n) =&gt; Show (Test foo n) where\n    show Final           = \"final\"\n    show (Step bar step) = show bar ++ show step\n</code></pre>\n\n<p>where <code>Test</code> is a GADT depending on a type parameter <code>foo</code>, which has kind <code>Nat -&gt; *</code>.</p>\n\n<p>The code above does not compile and I have the following error</p>\n\n<pre><code>\u2022 Could not deduce (Show (foo ('S n))) arising from a use of \u2018show\u2019\n  from the context: Show (foo n)\n    bound by the instance declaration at src/Test.hs:18:10-42\n\u2022 In the second argument of \u2018(++)\u2019, namely \u2018show step\u2019\n  In the expression: show bar ++ show step\n  In an equation for \u2018show\u2019:\n         show (Step bar step) = show bar ++ show step\n   |\n20 |     show (Step bar step) = show bar ++ show step\n   |                                        ^^^^^^^^^\n</code></pre>\n\n<p>How can I state that <code>Show (foo n)</code> holds for every <code>n</code>, so that the compiler accepts it when it looks for <code>Show (foo (S n))</code>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 368, "user_id": 2492166, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/54b4fd0a3406e65b532e27dfd9b3ad0d?s=128&d=identicon&r=PG", "display_name": "Iron Gremlin", "link": "https://stackoverflow.com/users/2492166/iron-gremlin"}, "edited": false, "score": 1, "creation_date": 1521568301, "post_id": 49390435, "comment_id": 85783563, "body": "Helpful to note on this topic:  <code>[x,y,z]</code> is just sugar for <code>(x:y:z:[])</code>  <code>(x,y)</code> is just sugar for <code>((,) x y)</code>  <code>(x,y,z)</code> is just sugar for <code>((,,) x y z)</code>  Parentheses are used in pattern matching because usually they are necessary to make sure that, in the case of <code>(x :xs)</code>, that this is one pattern for one argument and not a pattern matching three separate args, <code>x</code>, <code>(:)</code>, and <code>(xs)</code>, or some combination, as those could be completely valid arguments to a haskell function by themselves."}], "answers": [{"comments": [{"owner": {"reputation": 221, "user_id": 6442349, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SZrZB.jpg?s=128&g=1", "display_name": "Andres Mejia", "link": "https://stackoverflow.com/users/6442349/andres-mejia"}, "edited": false, "score": 0, "creation_date": 1521566593, "post_id": 49390523, "comment_id": 85782420, "body": "oh, I see. So in general, does Haskell just recognize that on the right side of a colon, some list belongs there?"}, {"owner": {"reputation": 45741, "user_id": 744178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3193139ea494c45e63752504f5ff1f2?s=128&d=identicon&r=PG", "display_name": "jwodder", "link": "https://stackoverflow.com/users/744178/jwodder"}, "reply_to_user": {"reputation": 221, "user_id": 6442349, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SZrZB.jpg?s=128&g=1", "display_name": "Andres Mejia", "link": "https://stackoverflow.com/users/6442349/andres-mejia"}, "edited": false, "score": 0, "creation_date": 1521566651, "post_id": 49390523, "comment_id": 85782456, "body": "@AndresMejia: Yes; <code>:</code> is a constructor for lists whose right-hand side is a list."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1521567839, "post_id": 49390523, "comment_id": 85783242, "body": "<code>:t (:)</code> reports <code>(:) :: a -&gt; [a] -&gt; [a]</code>."}], "tags": [], "owner": {"reputation": 45741, "user_id": 744178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3193139ea494c45e63752504f5ff1f2?s=128&d=identicon&r=PG", "display_name": "jwodder", "link": "https://stackoverflow.com/users/744178/jwodder"}, "is_accepted": true, "score": 3, "last_activity_date": 1521566503, "creation_date": 1521566503, "answer_id": 49390523, "question_id": 49390435, "link": "https://stackoverflow.com/questions/49390435/distinguishing-parentheses-from-brackets/49390523#49390523", "title": "Distinguishing parentheses from brackets", "body": "<p>The parentheses in <code>head' (x:_)</code> are just being used for grouping; you can tell no tuples are involved because there are no commas inside.  Without the parentheses, <code>head' x:_</code> would be parsed as <code>(head' x):_</code>, which doesn't work on the left-hand side of an assignment.</p>\n\n<p>We can't use brackets here because they would require knowing how many elements are in the list passed to <code>head'</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 4, "last_activity_date": 1521566578, "creation_date": 1521566578, "answer_id": 49390540, "question_id": 49390435, "link": "https://stackoverflow.com/questions/49390435/distinguishing-parentheses-from-brackets/49390540#49390540", "title": "Distinguishing parentheses from brackets", "body": "<p>Parentheses denote tuples when they contain commas. Parentheses without commas are used for grouping, e.g. to distinguish between <code>x - (y - z)</code> and <code>(x - y) - z</code> or, in this case, between <code>head' (x:_) = x</code> and <code>(head' x) : _ = x</code>. In other words, all that the parentheses do here is to denote that <code>:</code> is being applied to <code>x</code> and <code>_</code> rather than <code>head' x</code> and <code>_</code>.</p>\n\n<p>If you used <code>[]</code> here, that would be a list pattern. Generally the pattern <code>[p]</code> matches if the given value is a list with one element and that element matches the pattern <code>p</code>. So <code>[x:_]</code> matches a list that contains one element and that element is itself a list matching the pattern <code>x:_</code>. Since that's not what you want, you need to use the version without the list pattern.</p>\n"}], "owner": {"reputation": 221, "user_id": 6442349, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SZrZB.jpg?s=128&g=1", "display_name": "Andres Mejia", "link": "https://stackoverflow.com/users/6442349/andres-mejia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 1, "accepted_answer_id": 49390523, "answer_count": 2, "score": 0, "last_activity_date": 1521566586, "creation_date": 1521566251, "last_edit_date": 1521566586, "question_id": 49390435, "link": "https://stackoverflow.com/questions/49390435/distinguishing-parentheses-from-brackets", "title": "Distinguishing parentheses from brackets", "body": "<p>In Haskell, I know that there are tuples <code>(x1,x2,x3)</code> and also lists <code>[x1,x2,x3]</code> and that tuples are not homogeneous and have a fixed length.</p>\n\n<p>On the other hand, lists can be rewritten for example in the form <code>x1:x2:x3:[]</code>, which I guess is a function <code>a -&gt;[a]-&gt;[a]</code>, which makes some sense to me, but in the following code:</p>\n\n<pre><code>head' :: [a] -&gt; a  \nhead' [] = error   \nhead' (x:_) = x  \n</code></pre>\n\n<p>it is unclear to me why we use parentheses, which is to my understanding tuple notation.  It looks more like we should have something like an uncurry function on the colon operator, and take the first input, or something like that.</p>\n\n<p>How are the parentheses behaving here, and why can we not use brackets in some way or another?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1521561333, "post_id": 49388744, "comment_id": 85779032, "body": "What did you try?"}, {"owner": {"reputation": 21, "user_id": 9041749, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HcfXAE-KNJo/AAAAAAAAAAI/AAAAAAAAFfc/g-Adiwjr4DA/photo.jpg?sz=128", "display_name": "Hamza Halabi", "link": "https://stackoverflow.com/users/9041749/hamza-halabi"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1521561442, "post_id": 49388744, "comment_id": 85779113, "body": "I had already defined a function that does the opposite of that:       flatten :: [(Char, Int)] -&gt; String     flatten [] = []     flatten ((ca,cb):cs) = ca:(show cb ++ flatten cs)  I am trying to figure out how to do an inverse of it to create &quot;expand&quot;"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1521562563, "post_id": 49388744, "comment_id": 85779884, "body": "Something close: <code>import Data.List.Split</code> -- <code>import Data.List</code> --  <code>mystring = &quot;a5b2c3&quot;</code> -- <code>map (\\[x,y] -&gt; (x,y)) $ splitPlaces (replicate (length x </code>div` 2) 2) $ wordsBy (==&#39;,&#39;) $ intersperse &#39;,&#39; mystring` -- <b>[(&quot;a&quot;,&quot;5&quot;),(&quot;b&quot;,&quot;2&quot;),(&quot;c&quot;,&quot;3&quot;)]</b>"}, {"owner": {"reputation": 3603, "user_id": 5156054, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/AXyaZ.jpg?s=128&g=1", "display_name": "Mozahler", "link": "https://stackoverflow.com/users/5156054/mozahler"}, "edited": false, "score": 0, "creation_date": 1521564186, "post_id": 49388744, "comment_id": 85781026, "body": "Please update your question with the information you put in the comment. Many people don&#39;t read comments."}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1521569241, "post_id": 49388744, "comment_id": 85784132, "body": "Can <code>&quot;a123b456c8d9&quot;</code> be valid input as well?"}], "answers": [{"comments": [{"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1521563543, "post_id": 49389277, "comment_id": 85780594, "body": "<code>splitEvery 2</code> would be shorter"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1521563595, "post_id": 49389277, "comment_id": 85780637, "body": "@4castle I didn&#39;t know. Let me look and I edit. Feel free to edit too if you&#39;re sure of you."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1521563721, "post_id": 49389277, "comment_id": 85780721, "body": "@4castle <code>splitEvery</code> is deprecated, I put <code>chunksOf</code> instead"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 1, "creation_date": 1521564077, "post_id": 49389277, "comment_id": 85780964, "body": "The <code>intersperse</code> and <code>wordsBy</code> are also unnecessary. <code>map (\\[x,y] -&gt; (x, read [y] :: Int)) $ chunksOf 2 mystring</code>"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1521564403, "post_id": 49389277, "comment_id": 85781149, "body": "You&#39;re right  once again @4castle. I edit. I often do more complicated as needed &gt;-&lt;"}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1521568716, "post_id": 49389277, "comment_id": 85783832, "body": "Your last solution is definitely the easiest one. Written in list comprehension it might even look easier."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1521571367, "post_id": 49389277, "comment_id": 85785369, "body": "@Elmex80s The credit to the last solution is highly shared with 4castle. If you have a simpler solution, feel free to post it or to edit my post."}], "tags": [], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "is_accepted": false, "score": 2, "last_activity_date": 1521564478, "last_edit_date": 1521564478, "creation_date": 1521562722, "answer_id": 49389277, "question_id": 49388744, "link": "https://stackoverflow.com/questions/49388744/haskell-convert-string-of-char-and-int-to-a-paired-list/49389277#49389277", "title": "Haskell convert string of char and int to a paired list", "body": "<p>Is it ok like this?</p>\n\n<pre><code>import Data.List (intersperse)\nimport Data.List.Split (splitPlaces, wordsBy)\nmystring = \"a5b2c3'\n\n&gt;&gt;&gt; map (\\[x,y] -&gt; (head x, read y :: Int)) $ splitPlaces (replicate (length mystring `div` 2) 2) $ wordsBy (==',') $ intersperse ',' mystring\n[('a',5),('b',2),('c',3)]\n</code></pre>\n\n<p>Simpler, thanks to @4castle:</p>\n\n<pre><code>import Data.List (intersperse)\nimport Data.List.Split (chunksOf, wordsBy)\nmap (\\[x,y] -&gt; (head x, read y :: Int)) $ chunksOf 2 $ wordsBy (==',') $ intersperse ',' mystring\n</code></pre>\n\n<p>Even simpler, still thanks to @4castle:</p>\n\n<pre><code>import Data.List.Split (chunksOf)\nmap (\\[x,y] -&gt; (x, read [y] :: Int)) $ chunksOf 2 mystring\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 2, "last_activity_date": 1521573687, "last_edit_date": 1521573687, "creation_date": 1521572617, "answer_id": 49392293, "question_id": 49388744, "link": "https://stackoverflow.com/questions/49388744/haskell-convert-string-of-char-and-int-to-a-paired-list/49392293#49392293", "title": "Haskell convert string of char and int to a paired list", "body": "<p>Use a parsing library like <code>Parsec</code>. The learning curve is a little steep (I'm not even sure this is a good example), but you can describe parsers like this is very little code.</p>\n\n<pre><code>import qualified Text.Parsec as T\n\nparseDigit :: T.Parsec String () Int\nparseDigit = fmap (read . pure) T.digit\n\nmyParser = T.many ((,) &lt;$&gt; T.letter &lt;*&gt; parseDigit)\n</code></pre>\n\n<p>Then</p>\n\n<pre><code>&gt; T.parse myParser \"\" \"a5b4c2\"\nRight [('a', 5),('b',4),('c',2)]\n</code></pre>\n\n<p>So, your <code>expand</code> could be defined as</p>\n\n<pre><code>import Data.Either\nexpand :: String -&gt; [(Char, Int)]\nexpand s = fromRight [] (T.parse myParser \"\" s)\n</code></pre>\n\n<p>to return an empty list in the event the parser fails on the input string.</p>\n"}, {"tags": [], "owner": {"reputation": 2179, "user_id": 412549, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a194a155579e30bda0926705aeb9d165?s=128&d=identicon&r=PG&f=1", "display_name": "Franky", "link": "https://stackoverflow.com/users/412549/franky"}, "is_accepted": false, "score": 0, "last_activity_date": 1521575757, "creation_date": 1521575757, "answer_id": 49393064, "question_id": 49388744, "link": "https://stackoverflow.com/questions/49388744/haskell-convert-string-of-char-and-int-to-a-paired-list/49393064#49393064", "title": "Haskell convert string of char and int to a paired list", "body": "<p>Without any complicated imports, assuming alternating chars and (single) digits, you can use a simple recursion:</p>\n\n<pre><code>f :: [(Char, Int)] -&gt; String\nf (c:d:xs) = (c,read [d]):f xs\nf x        = x\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1209, "user_id": 2738025, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/LSnV8.png?s=128&g=1", "display_name": "castle-bravo", "link": "https://stackoverflow.com/users/2738025/castle-bravo"}, "is_accepted": false, "score": 0, "last_activity_date": 1521576086, "creation_date": 1521576086, "answer_id": 49393141, "question_id": 49388744, "link": "https://stackoverflow.com/questions/49388744/haskell-convert-string-of-char-and-int-to-a-paired-list/49393141#49393141", "title": "Haskell convert string of char and int to a paired list", "body": "<p>A relatively simple solution:</p>\n\n<pre><code>import Data.Char (digitToInt)\n\nexpand :: String -&gt; [(Char, Int)]\nexpand (x:x':xs) = (x, digitToInt x'):expand xs\nexpand _        = []\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "is_accepted": false, "score": 0, "last_activity_date": 1523719006, "last_edit_date": 1523719006, "creation_date": 1521662711, "answer_id": 49415603, "question_id": 49388744, "link": "https://stackoverflow.com/questions/49388744/haskell-convert-string-of-char-and-int-to-a-paired-list/49415603#49415603", "title": "Haskell convert string of char and int to a paired list", "body": "<p>Again, I prefer list comprehensions and/or tail recursion functions. If a function is not a fold then it returns a list. List comprehensions return lists.</p>\n\n<pre><code>let l = \"a5b3c2\"\n[ (a,(read [b] :: Int)) | (a,b) &lt;- zip l (tail l), elem b \"1234567890\"]\n</code></pre>\n\n<p>[('a',5),('b',3),('c',2)]</p>\n\n<p>I didn't know about the <code>chunksOf</code> function when I posted this. <code>chunksOf</code> is a very handy function and I'm already using it a lot. Also I think I like the <code>ord</code> function over the <code>read</code> function. When you have pairs, you know where things are at and can process accordingly.</p>\n\n<pre><code>[ (a,(ord b)-48) | (a:b:c) &lt;- chunksOf 2 \"a5b4c3\"]\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 9041749, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-HcfXAE-KNJo/AAAAAAAAAAI/AAAAAAAAFfc/g-Adiwjr4DA/photo.jpg?sz=128", "display_name": "Hamza Halabi", "link": "https://stackoverflow.com/users/9041749/hamza-halabi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1437, "favorite_count": 0, "answer_count": 5, "score": 1, "last_activity_date": 1523719006, "creation_date": 1521561261, "last_edit_date": 1521561741, "question_id": 49388744, "link": "https://stackoverflow.com/questions/49388744/haskell-convert-string-of-char-and-int-to-a-paired-list", "title": "Haskell convert string of char and int to a paired list", "body": "<p>Hi guys I am looking for a function</p>\n\n<pre><code>expand :: String -&gt; [(Char,Int)]\n</code></pre>\n\n<p>that takes a string of character and numbers like <code>\"a5b3c2\"</code> and change it to a paired list of the string like <code>\"[('a',5),('b',3),('c',2)]\"</code> in that same form.</p>\n\n<p>Example:</p>\n\n<pre><code>expand \"a5b4c2\"\n[('a',5),('b',4),('c',2)]\n\nexpand \"d9d3\"\n[('d',9),('d',3)]\n</code></pre>\n\n<p>I had already made a function that does the opposite of the above, all I am trying to do is figure out how to do the inverse of that. Example:</p>\n\n<pre><code>flatten :: [(Char, Int)] -&gt; String\nflatten [] = []\nflatten ((ca,cb):cs) = ca:(show cb ++ flatten cs)\n</code></pre>\n"}, {"tags": ["haskell", "types", "functional-programming"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 2, "creation_date": 1521562275, "post_id": 49388717, "comment_id": 85779680, "body": "It really helps to be precise. <code>(Num a) =&gt; (a -&gt; a) -&gt; a</code> is a very different type than <code>(num -&gt; num) -&gt; num</code>. Classes are not types. Instances are not subtypes. And very importantly, the former type has a lot of total implementations, while the latter has only partial implementations."}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 1, "creation_date": 1521562364, "post_id": 49388717, "comment_id": 85779743, "body": "<code>fix f = let x = f x in x</code> has type <code>(a -&gt; a) -&gt; a</code> <a href=\"https://www.stackage.org/haddock/lts-10.5/base-4.10.1.0/Data-Function.html#v:fix\" rel=\"nofollow noreferrer\">fix</a>"}, {"owner": {"reputation": 53, "user_id": 5723164, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eDrEOqomCKU/AAAAAAAAAAI/AAAAAAAAAC4/h7u8i1zXNAU/photo.jpg?sz=128", "display_name": "samlu1999", "link": "https://stackoverflow.com/users/5723164/samlu1999"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1521563443, "post_id": 49388717, "comment_id": 85780527, "body": "@Carl The book uses the exact wording (num -&gt; num) -&gt; num. I guess the question is can I define a function of type Num a =&gt; (a -&gt; a) -&gt; a"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "reply_to_user": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1521564046, "post_id": 49388717, "comment_id": 85780945, "body": "@freestyle and that&#39;s a partial function. Sometimes useful, but there are total inputs for which it never returns."}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1521564418, "post_id": 49388717, "comment_id": 85781155, "body": "@Carl Thanks, I know."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1521564931, "post_id": 49388717, "comment_id": 85781465, "body": "@samlu1999 well, then, it&#39;s important to know exactly what was meant. Naming a type variable <code>num</code> is very leading. Is Bird using a non-standard Haskell-like language, or does he mean <code>(a -&gt; a) -&gt; a</code>? Bird is fully capable of meaning either, and I don&#39;t know what that book does."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1521566167, "post_id": 49388717, "comment_id": 85782184, "body": "@Carl I only know a book by Bird and Wadler and it definitely uses a non-Haskell."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1521566950, "post_id": 49388717, "comment_id": 85782661, "body": "It looks like you are using some version of <a href=\"https://usi-pl.github.io/lc/sp-2015/doc/Bird_Wadler.%20Introduction%20to%20Functional%20Programming.1ed.pdf\" rel=\"nofollow noreferrer\">this book</a> by Bird and Wadler. It doesn&#39;t use Haskell but some ad-hoc notation. In this book, <code>num</code> is a built-in type which would correspond to e.g. <code>Integer</code> of Haskell (not <code>Num</code> and not <code>num</code>)."}, {"owner": {"reputation": 53, "user_id": 5723164, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eDrEOqomCKU/AAAAAAAAAAI/AAAAAAAAAC4/h7u8i1zXNAU/photo.jpg?sz=128", "display_name": "samlu1999", "link": "https://stackoverflow.com/users/5723164/samlu1999"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1521569554, "post_id": 49388717, "comment_id": 85784326, "body": "@Carl Apologies for the confusion, the essence of the question wasn&#39;t clear. It is trivial to create a function of type (a -&gt; a) -&gt; a as I have done but the question specifically substitutes a for num suggesting that a polymorphic type will not do. What num represents does not matter, just that it is a defined type and not &quot;any type a&quot;. num could be Integer, Boolean, or any other self-defined type."}], "answers": [{"comments": [{"owner": {"reputation": 24443, "user_id": 100020, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/7b137a205dff52b6471dfd17158c8b8f?s=128&d=identicon&r=PG", "display_name": "sdcvvc", "link": "https://stackoverflow.com/users/100020/sdcvvc"}, "edited": false, "score": 2, "creation_date": 1521652348, "post_id": 49390259, "comment_id": 85826980, "body": "Another idea: <code>\\f -&gt; f (f 1)</code>"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 3, "last_activity_date": 1521565984, "last_edit_date": 1521565984, "creation_date": 1521565675, "answer_id": 49390259, "question_id": 49388717, "link": "https://stackoverflow.com/questions/49388717/haskell-function-with-type-num-num-num/49390259#49390259", "title": "Haskell function with type (num -&gt; num) -&gt; num", "body": "<p>If it is enough to give a function which <em>can be assigned that type</em>, then yours is already enough. That is, the following type-checks just fine:</p>\n\n<pre><code>func1 :: Num a =&gt; (a -&gt; a) -&gt; a\nfunc1 f = f 3\n</code></pre>\n\n<p>If, on the other hand, you want a function which <em>is inferred to have that type</em>, then you need to do some trickery. What we want to do here is to specify that the result of <code>f 3</code> and the <code>3</code> that we fed in have the same type. The standard way to force two terms to have the same type is to use <code>asTypeOf</code>, which is implemented this way:</p>\n\n<pre><code>asTypeOf :: a -&gt; a -&gt; a\nasTypeOf x _ = x\n</code></pre>\n\n<p>So let's try:</p>\n\n<pre><code>&gt; :t \\f -&gt; f 3 `asTypeOf` 3\n(Num a, Num t) =&gt; (t -&gt; a) -&gt; a\n</code></pre>\n\n<p>Unfortunately for us, this doesn't work, because the <code>3</code> in <code>f 3</code> and the standalone <code>3</code> are inferred to be using <em>potentially different</em> instances of <code>Num</code>. Still, it is a bit closer than <code>\\f -&gt; f 3</code> was -- note the new <code>Num a</code> constraint on the output that we didn't have before. An obvious next idea is to <code>let</code>-bind a variable to <code>3</code> and reuse that variable as the argument to both <code>f</code> and <code>asTypeOf</code>; surely then GHC will get the picture that <code>f</code>'s argument and result have the same type, right?</p>\n\n<pre><code>&gt; :t \\f -&gt; let x = 3 in f x `asTypeOf` x\n(Num a, Num t) =&gt; (t -&gt; a) -&gt; a\n</code></pre>\n\n<p>Drat. Turns out that <code>let</code>s do what's called \"let generalization\"; the <code>x</code> will be just as polymorphic as the <code>3</code> was, and can be specialized to different types at different use sites. Usually this is a nice feature, but because we're doing an unnatural exercise we need to do unnatural things...</p>\n\n<p>Okay, next idea: some lambda calculi do not include a <code>let</code>, and when you need one, instead of writing <code>let a = b in c</code>, you write <code>(\\a -&gt; c) b</code>. This is especially interesting for us because Haskell uses a specially-restricted kind of polymorphism that means that inside <code>c</code>, the type of <code>a</code> is <em>monomorphic</em>. So:</p>\n\n<pre><code>&gt; :t \\f -&gt; (\\x -&gt; f x `asTypeOf` x) 3\nNum a =&gt; (a -&gt; a) -&gt; a\n</code></pre>\n\n<p>And now you complain that <code>asTypeOf</code> is cheating, because it uses a type declaration that doesn't match its inferred type, and the whole point of the exercise was to get the right type through inference alone. (If we were okay with using type declarations that don't match the inferred type, we could have stopped at <code>func1 :: Num a =&gt; (a -&gt; a) -&gt; a; func1 f = f 3</code> from way back at the beginning!) Okay, no problem: there's another standardish way to force the types of two expressions to unify, namely, by putting them in a list together. So:</p>\n\n<pre><code>&gt; :t \\f -&gt; (\\x -&gt; head [f x, x]) 3\nNum a =&gt; (a -&gt; a) -&gt; a\n</code></pre>\n\n<p>Phew, now we're finally at a place where we could in principle build, from the ground up, all the tools needed to get a term of the right type without any type declarations.</p>\n"}, {"comments": [{"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 0, "creation_date": 1521684375, "post_id": 49390284, "comment_id": 85840204, "body": "That is the fix point function. It has the structure of what is being asked but it is not (num -&gt; num) -&gt; num it is identified in GHCi as (t -&gt; t) -&gt; t"}], "tags": [], "owner": {"reputation": 21, "user_id": 9523471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ed6eb1bfe75937904bcab6be567fb0f?s=128&d=identicon&r=PG&f=1", "display_name": "ColMath", "link": "https://stackoverflow.com/users/9523471/colmath"}, "is_accepted": false, "score": 0, "last_activity_date": 1521565720, "creation_date": 1521565720, "answer_id": 49390284, "question_id": 49388717, "link": "https://stackoverflow.com/questions/49388717/haskell-function-with-type-num-num-num/49390284#49390284", "title": "Haskell function with type (num -&gt; num) -&gt; num", "body": "<p><code>func1 f = let x = f x in x</code> This is a partial function, it technically has the type you want and you should be aware of what they are and how they work in haskell.</p>\n"}], "owner": {"reputation": 53, "user_id": 5723164, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-eDrEOqomCKU/AAAAAAAAAAI/AAAAAAAAAC4/h7u8i1zXNAU/photo.jpg?sz=128", "display_name": "samlu1999", "link": "https://stackoverflow.com/users/5723164/samlu1999"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "accepted_answer_id": 49390259, "answer_count": 2, "score": 0, "last_activity_date": 1521565984, "creation_date": 1521561188, "question_id": 49388717, "link": "https://stackoverflow.com/questions/49388717/haskell-function-with-type-num-num-num", "title": "Haskell function with type (num -&gt; num) -&gt; num", "body": "<p>I am struggling with an exercise in R. Bird's functional programming book that asks for an example of a function with type (num -> num) -> num</p>\n\n<p>The best I can come up with is a polymorphic type</p>\n\n<pre><code>func1 f = f 3\n:t func1\nfunc1 :: Num t1 =&gt; (t1 -&gt; t2) -&gt; t2\n</code></pre>\n\n<p>The problem I am having is that I can't specify the return type of f, so the type remains (num -> t2) -> t2.</p>\n\n<p>My attempt to force the return type of f is as follows:</p>\n\n<pre><code>square x = x * x\n:t func1 square\nfunc1 square :: Num t2 =&gt; t2 -&gt; t2\n</code></pre>\n\n<p>Because of course if I try to find the type of func1 \u2218 square it will just be num -> num</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1521555217, "post_id": 49386033, "comment_id": 85774169, "body": "At the very least, bundle the other parameters up into something like <code>data ExecutionEnvironment = EE SubprogramDIr Memory ComputerStack Input Output</code>, so you can define <code>run :: Program -&gt; ExecutionEnvironment -&gt; Output</code>. Record syntax will make it easier to deal with the <code>ExecutionEnvironment</code> argument when it isn&#39;t simply passed through as-is."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1521555559, "post_id": 49386033, "comment_id": 85774411, "body": "We might need some more context, though, to best refactor, and this might be more suited for codereview.stackexchange.com."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 31724, "user_id": 6264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbb17eeeecd3d9d06f4db310ab630a12?s=128&d=identicon&r=PG", "display_name": "Michiel Borkent", "link": "https://stackoverflow.com/users/6264/michiel-borkent"}, "edited": false, "score": 0, "creation_date": 1521573670, "post_id": 49386033, "comment_id": 85786610, "body": "@MichielBorkent, that&#39;s great advice, but the link is not really appropriate to the context. Generally speaking, the GHC Trac wiki is for people delving into the development or internals of the GHC compiler, not people trying to learn Haskell!"}, {"owner": {"reputation": 31724, "user_id": 6264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbb17eeeecd3d9d06f4db310ab630a12?s=128&d=identicon&r=PG", "display_name": "Michiel Borkent", "link": "https://stackoverflow.com/users/6264/michiel-borkent"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1521580082, "post_id": 49386033, "comment_id": 85789950, "body": "@dfeuer Ah, good point... I cannot edit the link anymore. I deleted my comment."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1521557909, "last_edit_date": 1521557909, "creation_date": 1521557580, "answer_id": 49387446, "question_id": 49386033, "link": "https://stackoverflow.com/questions/49386033/haskell-name-multiple-arguments-in-a-nice-way/49387446#49387446", "title": "Haskell: Name multiple arguments in a nice way", "body": "<p>You could define an helper <code>call</code> function</p>\n\n<pre><code>run (ins `Then` prg) dir mem stack inp out =\n  let call k = k prg dir mem stack inp out\n  in case ins of\n    TA addr -&gt; (run prg dir mem (Stack.push (Left addr) stack) inp out) \n    TV val -&gt; (run prg dir mem (Stack.push (Right val) stack) inp out)\n    DR -&gt; call dr\n    ST -&gt; call st\n    WR -&gt; call wr\n    RD -&gt; call rd\n    AD -&gt; call $ mathAction (+)\n    SB -&gt; call $ mathAction (-)\n    MT -&gt; call $ mathAction (*)\n    DI -&gt; call $ mathAction (div)\n    JU lbl -&gt; call $ ju lbl\n    JZ lbl -&gt; call $ jz lbl\n</code></pre>\n\n<p>Encapsulating all the common state variables in a data type seems more appropriate, though. Often, this execution state is called a \"configuration\" for your abstract machine. For instance,</p>\n\n<pre><code>data Config = Config SubprogramDir Memory ComputerStack Input Output\n</code></pre>\n\n<p>One can also turn this into a record.</p>\n"}], "owner": {"reputation": 77, "user_id": 9523084, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "magnus", "link": "https://stackoverflow.com/users/9523084/magnus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 49387446, "answer_count": 1, "score": 3, "last_activity_date": 1521557909, "creation_date": 1521553749, "last_edit_date": 1521555428, "question_id": 49386033, "link": "https://stackoverflow.com/questions/49386033/haskell-name-multiple-arguments-in-a-nice-way", "title": "Haskell: Name multiple arguments in a nice way", "body": "<p>I am working on a virtual stack machine for my school project. Everything works fine, but this is what I have as the control function of the program run:</p>\n\n<pre><code>run :: Program -&gt; SubprogramDir -&gt; Memory -&gt; ComputerStack -&gt; Input -&gt; Output -&gt; Output\nrun EOP _ _ _ _ out = out\nrun (lbl `Marks` prg) dir mem stack inp out = run prg dir mem stack inp out\nrun (ins `Then` prg) dir mem stack inp out =\n  case ins of\n    (TA addr) -&gt; (run prg dir mem (Stack.push (Left addr) stack) inp out) \n    (TV val) -&gt; (run prg dir mem (Stack.push (Right val) stack) inp out)\n    DR -&gt; (dr prg dir mem stack inp out)\n    ST -&gt; (st prg dir mem stack inp out)\n    WR -&gt; (wr prg dir mem stack inp out)\n    RD -&gt; (rd prg dir mem stack inp out)\n    AD -&gt; (mathAction (+) prg dir mem stack inp out)\n    SB -&gt; (mathAction (-) prg dir mem stack inp out)\n    MT -&gt; (mathAction (*) prg dir mem stack inp out)\n    DI -&gt; (mathAction (div) prg dir mem stack inp out)\n    (JU lbl) -&gt; (ju lbl prg dir mem stack inp out)\n    (JZ lbl) -&gt; (jz lbl prg dir mem stack inp out)\n</code></pre>\n\n<p>This <code>dir mem stack inp out</code> keeps repeating everywhere and it looks terrible. Is there a way to lump it into one, let's say, tuple, and pass it to other functions? Or any other nicer way to write it?</p>\n"}, {"tags": ["haskell", "haskell-stack"], "answers": [{"tags": [], "owner": {"reputation": 31724, "user_id": 6264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbb17eeeecd3d9d06f4db310ab630a12?s=128&d=identicon&r=PG", "display_name": "Michiel Borkent", "link": "https://stackoverflow.com/users/6264/michiel-borkent"}, "is_accepted": true, "score": 3, "last_activity_date": 1521555529, "last_edit_date": 1521555529, "creation_date": 1521554399, "answer_id": 49386289, "question_id": 49385992, "link": "https://stackoverflow.com/questions/49385992/search-for-a-symbol-in-a-multi-package-stack-project/49386289#49386289", "title": "Search for a symbol in a multi-package stack project", "body": "<p>My suggestion would be</p>\n\n<pre class=\"lang-bsh prettyprint-override\"><code>ag --haskell \"someSymbol\" sys/*/src\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "is_accepted": false, "score": 1, "last_activity_date": 1521554744, "creation_date": 1521554744, "answer_id": 49386426, "question_id": 49385992, "link": "https://stackoverflow.com/questions/49385992/search-for-a-symbol-in-a-multi-package-stack-project/49386426#49386426", "title": "Search for a symbol in a multi-package stack project", "body": "<p>If you're looking for IDE-like experience, check out <a href=\"https://github.com/haskell/haskell-ide-engine\" rel=\"nofollow noreferrer\">Haskell IDE engine</a> that integrates with editors which <a href=\"http://langserver.org/#implementations-client\" rel=\"nofollow noreferrer\">support Language Server Protocol</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1521564117, "creation_date": 1521564117, "answer_id": 49389764, "question_id": 49385992, "link": "https://stackoverflow.com/questions/49385992/search-for-a-symbol-in-a-multi-package-stack-project/49389764#49389764", "title": "Search for a symbol in a multi-package stack project", "body": "<p><a href=\"http://hackage.haskell.org/package/hoogle\" rel=\"nofollow noreferrer\">Hoogle</a> can be locally installed and its database populated with all of the information from the packages in your project.</p>\n\n<p>Additionally, <a href=\"http://hackage.haskell.org/package/haddock\" rel=\"nofollow noreferrer\">haddock</a> can generate documentation, and part of the documentation it generates is an index of all symbols, in alphabetical order, together with information about which module(s) define that symbol. It also has generally good tool support, so I expect a single <code>stack</code> command would be able to build all the haddocks for your project.</p>\n"}], "owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 1, "accepted_answer_id": 49386289, "answer_count": 3, "score": 2, "last_activity_date": 1521564117, "creation_date": 1521553655, "question_id": 49385992, "link": "https://stackoverflow.com/questions/49385992/search-for-a-symbol-in-a-multi-package-stack-project", "title": "Search for a symbol in a multi-package stack project", "body": "<p>Is there any tool that can be used to search for the location in which a symbol (e.g. function) is defined within a Haskell project built with stack, which contains multiple packages?</p>\n\n<p>I'm not looking for any IDE integration, anything better than:</p>\n\n<pre class=\"lang-bsh prettyprint-override\"><code>egrep --color -R --include=\"*.hs\"  \"someSymbol\" sys/*/src\n</code></pre>\n\n<p>will do.</p>\n\n<p>If, additionally, this tool can provide other information such as uses of a symbol, that'd be even better.</p>\n"}, {"tags": ["list", "haskell", "recursion", "fold"], "comments": [{"owner": {"reputation": 104, "user_id": 826753, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d32bda212d90f3d131b7f7781f8ac0b?s=128&d=identicon&r=PG&f=1", "display_name": "Jens Petersen", "link": "https://stackoverflow.com/users/826753/jens-petersen"}, "edited": false, "score": 0, "creation_date": 1579807971, "post_id": 49385950, "comment_id": 105900494, "body": "Wouldn&#39;t something similar to Unix <code>uniq</code> be more common?"}], "answers": [{"comments": [{"owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "edited": false, "score": 0, "creation_date": 1521563214, "post_id": 49386171, "comment_id": 85780362, "body": "This doesn&#39;t seem correct. If you pass <code>&quot;vacvvca&quot;</code>, the <code>v</code> in head position should be elided too."}, {"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "reply_to_user": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "edited": false, "score": 0, "creation_date": 1521563314, "post_id": 49386171, "comment_id": 85780437, "body": "How exactly? Can you give a definition of &#39;adjacent duplicates&#39; that would allow such interpretation?"}, {"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "reply_to_user": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "edited": false, "score": 0, "creation_date": 1521563375, "post_id": 49386171, "comment_id": 85780485, "body": "What do you mean by &#39;elided&#39; by the way?"}, {"owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "edited": false, "score": 0, "creation_date": 1521563409, "post_id": 49386171, "comment_id": 85780508, "body": "perhaps I misunderstood, but by the same token that <code>ac</code> and <code>ca</code> are adjacent dupes in the <code>acvvca</code> string."}, {"owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "edited": false, "score": 0, "creation_date": 1521563461, "post_id": 49386171, "comment_id": 85780539, "body": "agh, I meant removed."}, {"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "reply_to_user": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "edited": false, "score": 0, "creation_date": 1521563541, "post_id": 49386171, "comment_id": 85780592, "body": "So, can you define those duplicates you&#39;re speaking of?"}, {"owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "edited": false, "score": 0, "creation_date": 1521563759, "post_id": 49386171, "comment_id": 85780741, "body": "I understood &#39;adjacent duplicates&#39; as &#39;next to each other&#39;, but looking at the examples above it looks like it means &#39;a contiguous list of characters repeated in any order&#39;; in which case your definition is exactly that. ha! I should have read twice."}], "tags": [], "owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "is_accepted": true, "score": 3, "last_activity_date": 1521554124, "creation_date": 1521554124, "answer_id": 49386171, "question_id": 49385950, "link": "https://stackoverflow.com/questions/49385950/haskell-removing-adjacent-duplicates-from-a-list/49386171#49386171", "title": "Haskell - Removing adjacent duplicates from a list", "body": "<p>Start in last-first order: first remove duplicates from the tail, then check if head of the input equals to head of the tail result (which, by this moment, won't have any duplicates, so the only possible pair is head of the input vs. head of the tail result):</p>\n\n<pre><code>main = mapM_ (print . squeeze) [\"acvvca\", \"1456776541\", \"abbac\", \"aabaabckllm\"]\n\nsqueeze :: Eq a =&gt; [a] -&gt; [a]\nsqueeze (x:xs) = let ys = squeeze xs in case ys of\n                                            (y:ys') | x == y -&gt; ys'\n                                            _ -&gt; x:ys\nsqueeze _ = []\n</code></pre>\n\n<p>Outputs</p>\n\n<pre><code>\"\"\n\"\"\n\"c\"\n\"ckm\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 2, "last_activity_date": 1521554590, "creation_date": 1521554590, "answer_id": 49386367, "question_id": 49385950, "link": "https://stackoverflow.com/questions/49385950/haskell-removing-adjacent-duplicates-from-a-list/49386367#49386367", "title": "Haskell - Removing adjacent duplicates from a list", "body": "<p>I don't see how <code>foldl</code> could be used for this. (Generally, <code>foldl</code> pretty much combines the disadvantages of <code>foldr</code> and <code>foldl'</code>... those, or <code>foldMap</code>, are the folds you should normally be using, not <code>foldl</code>.)</p>\n\n<p>What you seem to intend is: <em>repeating</em> the <code>removeAdjDups</code>, until no duplicates are found anymore. The repetition is a job for</p>\n\n<pre><code>iterate :: (a -&gt; a) -&gt; a -&gt; [a]\n</code></pre>\n\n<p>like</p>\n\n<pre><code>Prelude&gt; iterate removeAdjDups \"1233213443\"\n[\"1233213443\",\"122133\",\"11\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\",\"\"...\n</code></pre>\n\n<p>This is an infinite list of ever reduced lists. Generally, it will <em>not</em> converge to the empty list; you'll want to add some termination condition. If you want to remove as many dups as necessary, that's the <em>fixpoint</em>; it can be found in a very similar way to how you implemented <code>removeAdjDups</code>: compare neighbor elements, just this time in the list of <em>reductions</em>.</p>\n\n<p><a href=\"https://stackoverflow.com/a/49386171/745903\">bipll's suggestion</a> to handle recursive duplicates is much better though, it avoids unnecessary comparisons and traversing the start of the list over and over.</p>\n"}, {"tags": [], "owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "is_accepted": false, "score": 1, "last_activity_date": 1521637148, "creation_date": 1521637148, "answer_id": 49406986, "question_id": 49385950, "link": "https://stackoverflow.com/questions/49385950/haskell-removing-adjacent-duplicates-from-a-list/49406986#49406986", "title": "Haskell - Removing adjacent duplicates from a list", "body": "<p>List comprehensions are often overlooked. They are, of course syntactic sugar but some, like me are addicted. First off, strings are lists as they are. This functions could handle any list, too as well as singletons and empty lists. You can us map to process many lists in a list.</p>\n\n<pre><code>(\\l -&gt; [ x  | (x,y) &lt;- zip l $ (tail l) ++ \" \", x /= y]) \"abcddeeffa\"\n</code></pre>\n\n<p>\"abcdefa\"</p>\n"}, {"tags": [], "owner": {"reputation": 6367, "user_id": 6914441, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bbc12c764b93fa915b8e5384f521fe12?s=128&d=identicon&r=PG&f=1", "display_name": "jferard", "link": "https://stackoverflow.com/users/6914441/jferard"}, "is_accepted": false, "score": 0, "last_activity_date": 1522856629, "creation_date": 1522856629, "answer_id": 49655267, "question_id": 49385950, "link": "https://stackoverflow.com/questions/49385950/haskell-removing-adjacent-duplicates-from-a-list/49655267#49655267", "title": "Haskell - Removing adjacent duplicates from a list", "body": "<p>I don't see either how to use <code>foldl</code>. It's maybe because, if you want to fold something here, you have to use <code>foldr</code>. </p>\n\n<pre><code>main = mapM_ (print . squeeze) [\"acvvca\", \"1456776541\", \"abbac\", \"aabaabckllm\"]\n\n-- I like the name in @bipll answer\nsqueeze = foldr (\\ x xs -&gt; if xs /= \"\" &amp;&amp; x == head(xs) then tail(xs) else x:xs) \"\"\n</code></pre>\n\n<p>Let's analyze this. The idea is taken from @bipll answer: go from right to left. If <code>f</code> is the lambda function, then by definition of <code>foldr</code>:</p>\n\n<pre><code>squeeze \"abbac\" = f('a' f('b' f('b' f('a' f('c' \"\")))\n</code></pre>\n\n<p>By definition of <code>f</code>, <code>f('c' \"\") = 'c':\"\" = \"c\"</code> since <code>xs == \"\"</code>. Next char from the right: <code>f('a' \"c\") = 'a':\"c\" = \"ac\"</code> since <code>'a' != head(\"c\") = 'c'</code>.  <code>f('b' \"ac\") = \"bac\"</code> for the same reason. But <code>f('b' \"bac\") = tail(\"bac\") = \"ac\"</code> because <code>'b' == head(\"bac\")</code>. And  so forth...</p>\n\n<p>Bonus: by replacing <code>foldr</code> with <code>scanr</code>, you can see the whole process:</p>\n\n<pre><code>Prelude&gt; squeeze' = scanr (\\ x xs -&gt; if xs /= \"\" &amp;&amp; x == head(xs) then tail(xs) else x:xs) \"\"\nPrelude&gt; zip \"abbac\" (squeeze' \"abbac\")\n[('a',\"c\"),('b',\"ac\"),('b',\"bac\"),('a',\"ac\"),('c',\"c\")]\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6306428"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1356, "favorite_count": 0, "accepted_answer_id": 49386171, "answer_count": 4, "score": 1, "last_activity_date": 1522856629, "creation_date": 1521553540, "question_id": 49385950, "link": "https://stackoverflow.com/questions/49385950/haskell-removing-adjacent-duplicates-from-a-list", "title": "Haskell - Removing adjacent duplicates from a list", "body": "<p>I'm trying to learn haskell by solving some online problems and training exercises.</p>\n\n<p>Right now I'm trying to make a function that'd remove adjacent duplicates from a list.</p>\n\n<blockquote>\n  <p>Sample Input</p>\n  \n  <p>\"acvvca\"</p>\n  \n  <p>\"1456776541\"</p>\n  \n  <p>\"abbac\"</p>\n  \n  <p>\"aabaabckllm\"</p>\n  \n  <hr>\n  \n  <p>Expected Output</p>\n  \n  <p>\"\"</p>\n  \n  <p>\"\"</p>\n  \n  <p>\"c\"</p>\n  \n  <p>\"ckm\"</p>\n</blockquote>\n\n<p>My first though was to make a function that'd simply remove first instance of adjacent duplicates and restore the list.</p>\n\n<pre><code>module Test where\n\nremoveAdjDups :: (Eq a) =&gt; [a] -&gt; [a]\nremoveAdjDups []           =  []\nremoveAdjDups [x]          =  [x]\nremoveAdjDups (x : y : ys)\n  | x == y = removeAdjDups ys\n  | otherwise = x : removeAdjDups (y : ys)\n</code></pre>\n\n<hr>\n\n<pre><code>*Test&gt; removeAdjDups \"1233213443\"\n\"122133\"\n</code></pre>\n\n<hr>\n\n<p>This func works for first found pairs.</p>\n\n<p>So now I need to apply same function over the result of the function.</p>\n\n<p>Something I think foldl can help with but I don't know how I'd go about implementing it.</p>\n\n<p>Something along the line of</p>\n\n<pre><code>removeAdjDups' xs = foldl (\\acc x -&gt; removeAdjDups x acc) xs\n</code></pre>\n\n<hr>\n\n<p>Also is this approach the best way to implement the solution or is there a better way I should be thinking of? </p>\n"}, {"tags": ["haskell", "recursion", "functional-programming", "tree", "multiway-tree"], "answers": [{"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1521566085, "post_id": 49385325, "comment_id": 85782131, "body": "Two details: (1) You need an extra <code>concat</code> on the outside, or to change the comprehension to <code>[addN cs {- etc. -} cs &lt;- coords tree {- etc. -}]</code> (2) Given the usage example in the OP, the indexing should start from <code>0</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1521571091, "post_id": 49385325, "comment_id": 85785232, "body": "@duplode (1) Right! I chose your second solution, and inlined <code>addN</code>. (2) I am unsure about starting from 0 since the OP used <code>zip (...) [1..]</code>."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1521571723, "post_id": 49385325, "comment_id": 85785566, "body": "On (2), indeed -- the question is inconsistent on that point, so there isn&#39;t much we can do about it."}, {"owner": {"reputation": 21, "user_id": 9522735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbae0bef64457194bdcb9add43531dd8?s=128&d=identicon&r=PG&f=1", "display_name": "D.Dog", "link": "https://stackoverflow.com/users/9522735/d-dog"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1521663241, "post_id": 49385325, "comment_id": 85833200, "body": "@duplode  yes, It should really be [0..]. That was poorly thought out."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1521570993, "last_edit_date": 1521570993, "creation_date": 1521551888, "answer_id": 49385325, "question_id": 49384900, "link": "https://stackoverflow.com/questions/49384900/enumerate-all-paths-through-a-rose-tree-haskell/49385325#49385325", "title": "Enumerate all paths through a rose tree Haskell", "body": "<p>A possible solution could be:</p>\n\n<pre><code>coords (Split _ xs) = [ (event, n:path)\n      | (n,(_,tree)) &lt;- zip [1..] xs \n      , (event, path) &lt;- coords tree  ]\n</code></pre>\n\n<p>This starts by enumerating the trees in <code>xs</code>, using <code>zip [1..]</code> as done in the OP. We get a list of kind-of triples <code>(n,(string,tree))</code>, and we do not need the <code>string</code>. For any such \"triple\", we recurse with <code>coords tree</code>: this produces a list of the form <code>[(event1, path1), (event2, path2), ...]</code> where the paths are relative to <code>tree</code>, not to <code>Split str xs</code>. We need to add <code>n</code> in front of every path, so we finally generate <code>(event, n:path)</code>.</p>\n"}], "owner": {"reputation": 21, "user_id": 9522735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fbae0bef64457194bdcb9add43531dd8?s=128&d=identicon&r=PG&f=1", "display_name": "D.Dog", "link": "https://stackoverflow.com/users/9522735/d-dog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521916005, "creation_date": 1521550813, "last_edit_date": 1521916005, "question_id": 49384900, "link": "https://stackoverflow.com/questions/49384900/enumerate-all-paths-through-a-rose-tree-haskell", "title": "Enumerate all paths through a rose tree Haskell", "body": "<p>I'm working with a version of a Tree of the type:</p>\n\n<pre><code>Tree = Empty | Leaf Event | Split String [(String, Tree)]\n</code></pre>\n\n<p>My aim is to get a function that returns a list of pairs <code>[(Event,[Int])]</code> with <code>[Int]</code> being the coordinates (the path taken in the tree to reach it) of each Event, i.e if the tree was:</p>\n\n<pre><code>Split str [(str2, Leaf event), (str3, Empty)]\n</code></pre>\n\n<p>Then I would want it to return <code>[event,[0]]</code>. I want to ignore any empty ends to the tree.</p>\n\n<p>so my function looks like </p>\n\n<pre><code>coords :: Tree -&gt; [(Event,[Int])]\ncoords Empty = []\ncoords (Leaf event) = [event, []]\n</code></pre>\n\n<p>Then for Split it needs to recursively apply the function on each subtree. I thought of doing:</p>\n\n<pre><code>coords Split str xs = zip (coords trees) [1..] where\n    trees = [snd(str,tree) | (str,tree) &lt;-xs]\n</code></pre>\n\n<p>But this would give me nested lists of arbitrary length, among a couple of other problems. Any ideas?</p>\n"}, {"tags": ["haskell", "opengl", "3d"], "comments": [{"owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "edited": false, "score": 4, "creation_date": 1521535815, "post_id": 49379693, "comment_id": 85760079, "body": "There&#39;s no such thing as an &quot;OpenGL scene&quot;. OpenGL is a rendering API, not a scene storage format. So it all depends on where your actual scene is coming from, and how it&#39;s stored."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "edited": false, "score": 0, "creation_date": 1521535888, "post_id": 49379693, "comment_id": 85760121, "body": "@Thomas Sorry for the wording, I simply mean a graphic made with Haskell OpenGL."}, {"owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "edited": false, "score": 2, "creation_date": 1521536058, "post_id": 49379693, "comment_id": 85760229, "body": "So you have made a 2D image and want to create a 3D description of it to send to a 3D printer? That&#39;s going to be impossible. I&#39;m not just nitpicking here; OpenGL has nothing to do with all this. OpenGL is just for turning a series of draw commands into a 2D image. What you need is something to take the geometry as it is <i>before</i> you feed it to OpenGL, and export that as STL instead."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "edited": false, "score": 0, "creation_date": 1521536184, "post_id": 49379693, "comment_id": 85760309, "body": "@Thomas It&#39;s possible with the R package <code>rgl</code>, which is also a wrapper of OpenGL. I will take a look at the code to see how it works. Looks like everything must be &quot;converted&quot; to triangles."}, {"owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "edited": false, "score": 0, "creation_date": 1521536365, "post_id": 49379693, "comment_id": 85760433, "body": "Looks like RGL is not just a rendering library; it also has representations of 3D geometry and ways to manipulate it."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "edited": false, "score": 0, "creation_date": 1521536449, "post_id": 49379693, "comment_id": 85760485, "body": "Yes, rgl is a &quot;high-level&quot; library. Very easier to use than Haskell OpenGL (at least for a R user). But less options I think."}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1521546994, "post_id": 49379693, "comment_id": 85767832, "body": "if you can process your geometry than you can save STL on your own (it is just a simple text file or binary if you want). the problem is meeting the STL mesh properties. So you need to convert your scene to triangles that is easy but the connectivity is that each triangle shares each side completely with neighboring triangle so no subdivisions are present. Not all 3D meshes are done this way and may need re-triangulation. So can you access/iterate through every primitive (triangle/polygon) face of your geometry mesh? Is your mesh complete volume surface without holes? Do you meet conectivity?"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1521547094, "post_id": 49379693, "comment_id": 85767923, "body": "@Spektre Thanks for your comment. I have no idea about these technical details, unfortunately. Indeed, re-triangulation is needed."}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1521547344, "post_id": 49379693, "comment_id": 85768111, "body": "@St&#233;phaneLaurent than look for things like <a href=\"https://fr.wikipedia.org/wiki/Triangulation_de_Delaunay\" rel=\"nofollow noreferrer\">Triangulation de Delaunay</a>. There must be tons of <b>STL</b> and geometry libs out there as <b>STL</b> is used commonly but I am afraid they are more for <b>C/C++/C#/Python</b> instead of <b>Haskell</b>. I prefer to use my own code for such things... saving <b>STL</b> is just few lines of code the real problem is extract data from your current geometry which we have no info about ..."}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1521547892, "post_id": 49379693, "comment_id": 85768532, "body": "@St&#233;phaneLaurent btw the STL restrictions are there for a reason so slicers do not need to use expensive computing to achieve slices and head positioning info as they often run in RT on lowend MCUs with almost no memory to speak of in comparison to PC..."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1521547986, "post_id": 49379693, "comment_id": 85768605, "body": "@Spektre By the way and FYI I&#39;ve done a Haskell library for Delaunay triangulations, based on the qhull C library: <a href=\"https://github.com/stla/qhull\" rel=\"nofollow noreferrer\">github.com/stla/qhull</a>. It works quite nice."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1521548043, "post_id": 49379693, "comment_id": 85768635, "body": "@Spektre There&#39;s a Voronoi tesselation in InkScape, so maybe there&#39;s a Delaunay triangulation as well."}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1521548156, "post_id": 49379693, "comment_id": 85768718, "body": "@St&#233;phaneLaurent IIRC InkScape is for 2D SVG you need 3D surface instead. The best you can do is use current mesh topology detect conflicts with STL and re-triangulate just those parts by subdividing triangles to match the edge connection. Most faces are low vertex polygons with defined winding rule so you can even use ear clipping ... confronting to local plane normal"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1521548226, "post_id": 49379693, "comment_id": 85768768, "body": "Ok @Spektre. I start to be convinced this is not possible like that. I gonna abandon. Thanks for the conversation and your advice."}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1521548272, "post_id": 49379693, "comment_id": 85768803, "body": "@St&#233;phaneLaurent it is possible but you would need to code it ..."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1521548437, "post_id": 49379693, "comment_id": 85768905, "body": "@Spektre Sure, everything is possible if we code :) Anyway I&#39;m an advanced R user and I can use the <code>rgl</code> library to achieve my goal."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1521635865, "post_id": 49379693, "comment_id": 85814056, "body": "@Spektre I&#39;ve coded it today for my Haskell library <code>qhull</code> for the convex hulls. It works nice. Would you know a way to convert from STL ascii to STL binary ?"}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1521648649, "post_id": 49379693, "comment_id": 85824351, "body": "they are almost the same you just save the float binary representation instead of text. IIRC The only difference is in that the header is constant size and you need to include triangle count, also no comments are allowed. see <a href=\"https://en.wikipedia.org/wiki/STL_(file_format)\" rel=\"nofollow noreferrer\">Wiki: STL (file format)</a>"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1521650874, "post_id": 49379693, "comment_id": 85825993, "body": "@Spektre Thanks. Yes I saw that but I don&#39;t master the wording (I don&#39;t know what is an endian byte integer, etc)."}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1521657323, "post_id": 49379693, "comment_id": 85829875, "body": "@St&#233;phaneLaurent 32bit IEEE <code>float</code> (real32) has 4 bytes the 32 bit integer (uint32) too ...  the little/big endianess is just in which order the 4 bytes are stored (if LSB or MSB firs)t. Some CPU&#39;s use one some the other and some are configurable. You would need binary file access in order to do this... then you simply convert your float variable address to BYTE pointer and save 4 bytes from that address if endianness match if not you would need to reverse the order first (or save byte by byte) ... even better is to have struct matching triangle and save/load that at once ..."}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1521657704, "post_id": 49379693, "comment_id": 85830073, "body": "IIRC the attributes are a bit tricky and can be used to add more info like colors texturing etc, I remember i reverse it from binarry STL files until the mesh loads properly but would need to dig into source code to confirm ..."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1521707601, "post_id": 49379693, "comment_id": 85848567, "body": "Thanks @Spektre. But this is still too unclear to me for the moment. Anyway I could open my ASCII STL file in a software and set some attributes like color. Though I&#39;m lost in these softwares lol (like Meshlab)."}, {"owner": {"reputation": 41485, "user_id": 2521214, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/nd58V.jpg?s=128&g=1", "display_name": "Spektre", "link": "https://stackoverflow.com/users/2521214/spektre"}, "edited": false, "score": 0, "creation_date": 1522333961, "post_id": 49379693, "comment_id": 86125287, "body": "@St&#233;phaneLaurent if it helps here <a href=\"https://stackoverflow.com/a/49555506/2521214\">Generating outside supporters into mesh for 3D printing</a> is mine STL loader in C++ (it loads both ASCII and binary STL&#39;s  the save is just reverse of it (writing instead of reading ...)"}], "answers": [{"comments": [{"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1521755746, "post_id": 49438701, "comment_id": 85880162, "body": "Yes, but to export an OpenGL graphic to STL we need all triangles and their normals of the graphic.  As I understood from the comments, this is not possible with the final rendering of the graphic."}, {"owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "reply_to_user": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1521768897, "post_id": 49438701, "comment_id": 85884072, "body": "Yes, if by &quot;OpenGL graphic&quot; you mean a raster image, that&#39;s not really feasible."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1521786596, "post_id": 49438701, "comment_id": 85888859, "body": "I don&#39;t know the wording in this domain and my English is not terrible. That&#39;s why I have difficulties to explain. The Haskell OpenGL library only opens a window in which it displays the graphic. This graphic is interactive: you can rotate it, etc. So I find strange that there&#39;s nothing to export it in a 3D format at this stage. There only exists a library to export an image to <code>ppm</code> (a &quot;raster image&quot; as you say), to take a screenshot in other words."}], "tags": [], "owner": {"reputation": 3016, "user_id": 3190654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c321c5241605255cae9ecf3fb2dffc0b?s=128&d=identicon&r=PG", "display_name": "bergey", "link": "https://stackoverflow.com/users/3190654/bergey"}, "is_accepted": false, "score": 0, "last_activity_date": 1521753729, "creation_date": 1521753729, "answer_id": 49438701, "question_id": 49379693, "link": "https://stackoverflow.com/questions/49379693/export-haskell-opengl-to-stl-for-3d-printing/49438701#49438701", "title": "Export Haskell OpenGL to STL for 3D printing", "body": "<p>The STL package you link can save STL files in the text format using <code>textSTL</code>, or in the binary format using <a href=\"https://hackage.haskell.org/package/cereal-0.5.1.0/docs/Data-Serialize.html#v:encode\" rel=\"nofollow noreferrer\">encode</a> . The latter uses the <code>Serialize</code> instance, so is easy to miss in the STL docs.</p>\n\n<p>The library does not handle any attributes (color and so forth).  PRs welcome!</p>\n"}], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 481, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1521753729, "creation_date": 1521535606, "last_edit_date": 1521546970, "question_id": 49379693, "link": "https://stackoverflow.com/questions/49379693/export-haskell-opengl-to-stl-for-3d-printing", "title": "Export Haskell OpenGL to STL for 3D printing", "body": "<p>I've found <a href=\"https://stackoverflow.com/a/49110613/1100107\">how to export a 3D OpenGL scene to <code>ppm</code></a>. But is it possible to export to the <code>STL</code> format ? This is the format required for 3D printing. </p>\n\n<p>There's <a href=\"https://hackage.haskell.org/package/STL\" rel=\"nofollow noreferrer\">a package for STL parsing</a> but I don't know whether it is possible to use it with OpenGL.</p>\n\n<p>Someone proposes to close this question for unclearness. I just want to know whether it is possible to export a 3D Haskell OpenGL graphic to a file appropriate for 3D printing (not necessarily STL, but as far as I know this is the only way - I may be wrong.) Sorry if it's still unclear, it may be due to my wording and my English. I do the best I can.</p>\n\n<p>Just for info, here is an example with the R package <code>rgl</code>: \n<a href=\"https://i.stack.imgur.com/n1kZA.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n1kZA.png\" alt=\"enter image description here\"></a></p>\n\n<p>And here is how the <code>STL</code> file looks like in ASCII representation (it takes 3.7 MB):</p>\n\n<pre><code>solid  testSTL.stl  produced by RGL\nfacet normal  -0.9965197 -0.05894169 -0.05894333 \nouter loop\nvertex  0.8633249 0 0 \nvertex  0.8656725 0 -0.03968928 \nvertex  0.8642709 0.0237557 -0.03974825 \nendloop\nendfacet\nfacet normal  -0.9965196 -0.05894321 -0.05894424 \nouter loop\nvertex  0.8633249 0 0 \nvertex  0.8642709 0.0237557 -0.03974825 \nvertex  0.8619304 0.0235772 0 \nendloop\nendfacet\nfacet normal  -0.9827041 -0.05841724 -0.1757272 \nouter loop\nvertex  0.8656725 0 -0.03968928 \nvertex  0.8726366 0 -0.07863396 \nvertex  0.8712143 0.02428522 -0.0787534 \nendloop\nendfacet\n...\n</code></pre>\n\n<p>So that does not sound impossible to have a STL converter for Haskell...</p>\n\n<h1>EDIT</h1>\n\n<p>There's a possible way but I didn't manage on Windows (that's frustrating)</p>\n\n<ul>\n<li><p>convert the OpenGL graphic to <code>ppm</code> using the <code>gl-capture</code> library; convert the <code>ppm</code> to <code>svg</code> using ImageMagick (or perhaps don't necessarily convert - the <code>ppm</code> can be opened in InkScape, see next steps)</p></li>\n<li><p>install OpenSCAD and InkScape (there exist portable versions)</p></li>\n<li><p>install <a href=\"https://www.thingiverse.com/thing:24808\" rel=\"nofollow noreferrer\">this InkScape extension</a> and follow the instructions</p></li>\n</ul>\n\n<h1>EDIT</h1>\n\n<p>Another possible way <a href=\"https://www.thingiverse.com/thing:1594579\" rel=\"nofollow noreferrer\">here</a>. Similarly, I've failed.</p>\n"}, {"tags": ["haskell", "vim", "nixos"], "comments": [{"owner": {"reputation": 156267, "user_id": 546861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SIhsx.png?s=128&g=1", "display_name": "romainl", "link": "https://stackoverflow.com/users/546861/romainl"}, "edited": false, "score": 1, "creation_date": 1521527578, "post_id": 49377241, "comment_id": 85755935, "body": "You run the install script with <code>bash</code> but the install script seems to use <code>sh</code> which probably doesn&#39;t know where to look for <code>stack</code>."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 4163848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e18ce2a69eb2d67a99470ef88941dc57?s=128&d=identicon&r=PG&f=1", "display_name": "tort", "link": "https://stackoverflow.com/users/4163848/tort"}, "is_accepted": false, "score": 0, "last_activity_date": 1521928227, "creation_date": 1521928227, "answer_id": 49470310, "question_id": 49377241, "link": "https://stackoverflow.com/questions/49377241/haskell-vim-now-fail-to-install-in-nixos/49470310#49470310", "title": "haskell-vim-now fail to install in nixos", "body": "<p>Another way of installing haskell-vim-now in nixos works for me:</p>\n\n<pre><code>bash &lt;(curl -sL https://git.io/haskell-vim-now) --basic\nexport PATH=$HOME/.local/bin:$PATH\nstack install codex hscope ghc-mod hasktags hoogle --nix\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4163848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e18ce2a69eb2d67a99470ef88941dc57?s=128&d=identicon&r=PG&f=1", "display_name": "tort", "link": "https://stackoverflow.com/users/4163848/tort"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1521928227, "creation_date": 1521525574, "question_id": 49377241, "link": "https://stackoverflow.com/questions/49377241/haskell-vim-now-fail-to-install-in-nixos", "title": "haskell-vim-now fail to install in nixos", "body": "<p>nixos 17.09</p>\n\n<p>Installing haskell-vim-now as suggested <a href=\"https://github.com/begriffs/haskell-vim-now/blob/master/README.md\" rel=\"nofollow noreferrer\">here</a></p>\n\n<blockquote>\n  <p>bash &lt;(curl -sL <a href=\"https://git.io/haskell-vim-now\" rel=\"nofollow noreferrer\">https://git.io/haskell-vim-now</a>) --nix</p>\n</blockquote>\n\n<p>Output puzzles me:</p>\n\n<pre><code>--- Creating vim config symlinks\n        ~/.vimrc -&gt; /home/tort/.config/haskell-vim-now/.vimrc\n        ~/.vim   -&gt; /home/tort/.config/haskell-vim-now/.vim\n--- Installing plugins using vim-plug... \nHvnArgs {hvnArgsNoHoogleDb = False, hvnArgsNoHelperBinaries = False}\n Setting up GHC if needed... \n/bin/sh: stack: command not found \nStack setup failed with error 127\n*** setup_haskell.hs failed with error 1.\n*** Aborting...\n</code></pre>\n\n<p>Why script doesn't see stack?</p>\n\n<pre><code>[host@host:~]$ which stack\n/home/tort/.nix-profile/bin/stack\n\n[host@host:~]$ nix-env -q '.*stack.*'\nstack-1.5.1\nstack2nix-0.1.3.0\n</code></pre>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["haskell", "pattern-matching", "algebraic-data-types"], "answers": [{"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 7, "last_activity_date": 1521525458, "creation_date": 1521525458, "answer_id": 49377212, "question_id": 49376903, "link": "https://stackoverflow.com/questions/49376903/pattern-matching-over-a-nested-data-constructor/49377212#49377212", "title": "Pattern matching Over A Nested Data Constructor", "body": "<pre><code>data List a = Cons a (List a) | Empty\n</code></pre>\n\n<p>This defines a <em>type constructor</em> <code>List</code> with two <em>data constructors</em> <code>Cons</code> and <code>Empty</code>. <code>Cons</code> has two fields, one of type <code>a</code>, and one of type <code>List a</code>\u2014which may, in turn, be either <code>Empty</code> or a <code>Cons</code>, and so on.</p>\n\n<p>So when you write:</p>\n\n<pre><code>Cons x (List _) &gt;&gt;= f = f x\n</code></pre>\n\n<p>The compiler is looking for a <em>data</em> constructor called <code>List</code> to pattern-match on, and there isn\u2019t one\u2014hence the error. If you just want to ignore the field, write:</p>\n\n<pre><code>Cons x _ &gt;&gt;= f = f x\n</code></pre>\n\n<p>Now of course this isn\u2019t a proper <code>Monad</code> instance for <code>List</code>\u2014it\u2019s more like the one for <code>Maybe</code>\u2014but I\u2019ll leave you to work through that on your own.</p>\n"}], "owner": {"reputation": 341, "user_id": 9194266, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/755e310581ee39e1dadbcbcc2c8e78aa?s=128&d=identicon&r=PG&f=1", "display_name": "barskyn", "link": "https://stackoverflow.com/users/9194266/barskyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1531835169, "creation_date": 1521523721, "last_edit_date": 1531835169, "question_id": 49376903, "link": "https://stackoverflow.com/questions/49376903/pattern-matching-over-a-nested-data-constructor", "title": "Pattern matching Over A Nested Data Constructor", "body": "<p>For the following code I keep on getting a compiler error because I am writing (List _) and it is trying to pattern match over the list. How can I fix tihs?</p>\n\n<pre><code>data List a = Cons a (List a) | Empty\n\ninstance Monad List where\n    Empty &gt;&gt;= _ = Empty \n    Cons x (List _) &gt;&gt;= f = f x\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 0, "creation_date": 1521520261, "post_id": 49374993, "comment_id": 85753676, "body": "What is your intention with the reported error?  Do you want to abort the program or do you want to handle the error gracefully and recover execution?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1521530367, "post_id": 49374993, "comment_id": 85757304, "body": "Usually if the function is not total, you make the result <code>Maybe a</code>, or <code>Either String a</code>, where you return <code>Left &quot;some error message&quot;, or </code>Right answer`."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1521534388, "post_id": 49375066, "comment_id": 85759253, "body": "Usually, instead of <code>print string</code> it is better to use <code>putStrLn string</code>, since the former will add quoting/escaping to the string. Instead, <code>print elm</code> is fine."}, {"owner": {"reputation": 824, "user_id": 6914498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/025023af1858a74ebe1cb8c9b21f47ab?s=128&d=identicon&r=PG", "display_name": "wisn", "link": "https://stackoverflow.com/users/6914498/wisn"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1521536944, "post_id": 49375066, "comment_id": 85760821, "body": "@chi Okay, I&#39;m with you. Editted~"}], "tags": [], "owner": {"reputation": 824, "user_id": 6914498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/025023af1858a74ebe1cb8c9b21f47ab?s=128&d=identicon&r=PG", "display_name": "wisn", "link": "https://stackoverflow.com/users/6914498/wisn"}, "is_accepted": false, "score": 6, "last_activity_date": 1521536901, "last_edit_date": 1521536901, "creation_date": 1521509840, "answer_id": 49375066, "question_id": 49374993, "link": "https://stackoverflow.com/questions/49374993/how-to-report-an-error-in-haskell-code/49375066#49375066", "title": "How to report an error in Haskell code", "body": "<p>You could use <code>Maybe</code> or <code>Either</code> in this case.</p>\n\n<p>This is how <code>Maybe</code> looks. <code>Nothing</code> will be our \"error\".</p>\n\n<pre><code>rthElem :: Int -&gt; [a] -&gt; Maybe [a]\nrthElem _ [] = Just []\nrthElem 0 (x:xs) = Nothing\nrthElem n (x:xs) = Just (rthElem' n 1 (x:xs)) where\n    rthElem' n i (x:xs)  = (if (n `divides` i) then\n        [x] else\n        [])\n        ++ (rthElem' n (i+1) xs)\n    rthElem' _ _ [] = []\n    divides x y = y `mod` x == 0\n\nmain :: IO ()\nmain = case (rthElem 0 [1..5]) of\n  Nothing  -&gt; putStrLn \"Error\"\n  Just elm -&gt; print elm\n</code></pre>\n\n<p>Another way is using <code>Either</code>. <code>Either</code> will return <code>Left</code> or <code>Right</code>. <code>Left</code> will be our \"error\".</p>\n\n<pre><code>rthElem :: Int -&gt; [a] -&gt; Either String [a]\nrthElem _ [] = Right []\nrthElem 0 (x:xs) = Left \"Error\"\nrthElem n (x:xs) = Right (rthElem' n 1 (x:xs)) where\n    rthElem' n i (x:xs)  = (if (n `divides` i) then\n        [x] else\n        [])\n        ++ (rthElem' n (i+1) xs)\n    rthElem' _ _ [] = []\n    divides x y = y `mod` x == 0\n\nmain :: IO ()\nmain = case (rthElem 0 [1..5]) of\n  Left err  -&gt; putStrLn err\n  Right elm -&gt; print elm\n</code></pre>\n\n<p>The best way is using <code>Either</code>. Read more about error handling <a href=\"https://www.schoolofhaskell.com/school/starting-with-haskell/basics-of-haskell/10_Error_Handling\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "is_accepted": false, "score": 4, "last_activity_date": 1521510238, "last_edit_date": 1521510238, "creation_date": 1521509942, "answer_id": 49375074, "question_id": 49374993, "link": "https://stackoverflow.com/questions/49374993/how-to-report-an-error-in-haskell-code/49375074#49375074", "title": "How to report an error in Haskell code", "body": "<p>If you really want to print an error and show it you could use the error function, <code>error :: String -&gt; a</code></p>\n\n<pre><code>rthElem 0 (x:xs) = error \"Error msg here\"\n</code></pre>\n\n<p>But there is a plenty better ways to do this , and you should figure out which one fits in your case , you can use Maybe, Either even monads , here is an interesting link with examples <a href=\"http://www.randomhacks.net/2007/03/10/haskell-8-ways-to-report-errors/\" rel=\"nofollow noreferrer\">http://www.randomhacks.net/2007/03/10/haskell-8-ways-to-report-errors/</a></p>\n"}, {"comments": [{"owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "edited": false, "score": 2, "creation_date": 1521527347, "post_id": 49376610, "comment_id": 85755840, "body": "Please do not turn otherwise pure functions into having IO results just because you want to report an error."}, {"owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "reply_to_user": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "edited": false, "score": 2, "creation_date": 1521529222, "post_id": 49376610, "comment_id": 85756739, "body": "@kosmikus I&#39;m not saying that this is a good idea.  Clearly the <code>Maybe</code> solution is the preferred one.  I just wanted to show what is available."}], "tags": [], "owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "is_accepted": false, "score": 0, "last_activity_date": 1521554546, "last_edit_date": 1521554546, "creation_date": 1521521884, "answer_id": 49376610, "question_id": 49374993, "link": "https://stackoverflow.com/questions/49374993/how-to-report-an-error-in-haskell-code/49376610#49376610", "title": "How to report an error in Haskell code", "body": "<p>You could use exceptions but you'd also have to transform your function into an IO action.</p>\n\n<pre><code>rthElem :: Int -&gt; [a] -&gt; IO [a]\nrthElem _ [] = return []\nrthElem 0 _ = ioError $ userError \"Error\"\nrthElem n l = return $ rthElem' n 1 l where\n    rthElem' n i (x:xs)  = (if (n `divides` i) then\n        [x] else\n        [])\n        ++ (rthElem' n (i+1) xs)\n    rthElem' _ _ [] = []\n    divides x y = y `mod` x == 0  \n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 9483263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6b32a3928438fb127d3fda119065bff?s=128&d=identicon&r=PG&f=1", "display_name": "R.N", "link": "https://stackoverflow.com/users/9483263/r-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1521554546, "creation_date": 1521509254, "question_id": 49374993, "link": "https://stackoverflow.com/questions/49374993/how-to-report-an-error-in-haskell-code", "title": "How to report an error in Haskell code", "body": "<p>I am writing a program that returns every rth element from a list. The list can be any type. I want to report an error when r is zero but my code isn't working (it is working fine when I comment out the error line). Can anyone tell me how to report an error in this situation</p>\n\n<pre><code>rthElem :: Int -&gt; [a] -&gt; [a]\nrthElem _ [] = []\nrthElem 0 (x:xs) = \"Error\"\nrthElem n (x:xs) = rthElem' n 1 (x:xs) where\n    rthElem' n i (x:xs)  = (if (n `divides` i) then\n        [x] else\n        [])\n        ++ (rthElem' n (i+1) xs)\n    rthElem' _ _ [] = []\n    divides x y = y `mod` x == 0  \n</code></pre>\n"}, {"tags": ["haskell", "haskell-lens", "category-theory", "lenses"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1521507523, "post_id": 49373949, "comment_id": 85750693, "body": "I probably haven&#39;t fully understood your question, but I believe the dual of <code>Strong</code> is <code>Choice</code> and correspondingly the dual of <code>Lens</code> is <code>Prism</code>. (<a href=\"https://hackage.haskell.org/package/lens-4.15.4/docs/Control-Lens-Prism.html#t:Prism\" rel=\"nofollow noreferrer\">Source</a>.) That makes the dual of <code>AffineTraversal</code>... <code>AffineTraversal</code>."}, {"owner": {"reputation": 1122, "user_id": 560450, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9628de0c171049af37bdd404e8f55d9e?s=128&d=identicon&r=PG", "display_name": "Krist&#243;f Marussy", "link": "https://stackoverflow.com/users/560450/krist%c3%b3f-marussy"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1521507612, "post_id": 49373949, "comment_id": 85750721, "body": "&quot;dual&quot;  was probably an unfortunate choice of wording from ne, then"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1521507622, "post_id": 49373949, "comment_id": 85750726, "body": "You can &quot;turn optics around&quot; with <code>Re</code> to turn <code>Prisms a b s t</code> into the profunctor optic equivalent of <code>(s -&gt; a, b -&gt; Maybe t)</code>, see this blogpost <a href=\"http://oleg.fi/gists/posts/2017-04-18-glassery.html\" rel=\"nofollow noreferrer\">oleg.fi/gists/posts/2017-04-18-glassery.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1122, "user_id": 560450, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9628de0c171049af37bdd404e8f55d9e?s=128&d=identicon&r=PG", "display_name": "Krist&#243;f Marussy", "link": "https://stackoverflow.com/users/560450/krist%c3%b3f-marussy"}, "edited": false, "score": 0, "creation_date": 1521583965, "post_id": 49375173, "comment_id": 85791600, "body": "It is somewhat unsatisfying that a type-chainging version of <code>toCoprism</code> is not possible. based on <a href=\"http://oleg.fi/gists/posts/2017-04-18-glassery.html\" rel=\"nofollow noreferrer\">oleg.fi/gists/posts/2017-04-18-glassery.html</a> , the solution is to define <code>P</code> in terms of <code>reviewE</code> instead of <code>review</code> by replacing <code>Maybe</code> with <code>Either a</code>"}, {"owner": {"reputation": 1122, "user_id": 560450, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9628de0c171049af37bdd404e8f55d9e?s=128&d=identicon&r=PG", "display_name": "Krist&#243;f Marussy", "link": "https://stackoverflow.com/users/560450/krist%c3%b3f-marussy"}, "edited": false, "score": 0, "creation_date": 1521584050, "post_id": 49375173, "comment_id": 85791640, "body": "I also tried to implement concrete and profunctor representations for some interesting lenses: <a href=\"https://gist.github.com/kris7t/b29519bee925b070d657e5f7c6a5650a\" rel=\"nofollow noreferrer\">gist.github.com/kris7t/b29519bee925b070d657e5f7c6a5650a</a> , although I haven&#39;t checked yet whether the <code>from*</code>/<code>to*</code> pairs are indeed isomorphism. It seems that the &quot;partial setter&quot; (<code>Foo</code> in my gist) is obtained by a <code>(Strong p, Cochoice p)</code> constraint"}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 3, "last_activity_date": 1521510792, "creation_date": 1521510792, "answer_id": 49375173, "question_id": 49373949, "link": "https://stackoverflow.com/questions/49373949/what-is-the-dual-of-a-prism-or-an-affine-traversal/49375173#49375173", "title": "What is the dual of a prism or an affine traversal?", "body": "<p>Here's half an answer, showing the correspondence between the <code>Cochoice</code> optic and <code>(s -&gt; a, b -&gt; Maybe t)</code>.</p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\n\nmodule P where\n\nimport Data.Profunctor\nimport Control.Monad\n\ndata P a b s t = P (s -&gt; a) (b -&gt; Maybe t)\n\ninstance Profunctor (P a b) where\n  dimap f g (P u v) = P (u . f) (fmap g . v)\n\ninstance Cochoice (P a b) where\n  unleft (P u v) = P (u . Left) (v &gt;=&gt; v') where\n    v' (Left t) = Just t\n    v' (Right _) = Nothing\n\ntype Coprism s t a b = forall p. Cochoice p =&gt; p a b -&gt; p s t\n\ntype ACoprism s t a b = P a b a b -&gt; P a b s t\n\nfromCoprism :: ACoprism s t a b -&gt; P a b s t\nfromCoprism p = p (P id Just)\n\ntoCoprism :: P a a s t -&gt; Coprism s t a a\ntoCoprism (P u v) = unleft . dimap f g where\n  f (Left s) = u s\n  f (Right a) = a\n  g b = case v b of\n    Nothing -&gt; Right b\n    Just t -&gt; Left t\n</code></pre>\n"}], "owner": {"reputation": 1122, "user_id": 560450, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9628de0c171049af37bdd404e8f55d9e?s=128&d=identicon&r=PG", "display_name": "Krist&#243;f Marussy", "link": "https://stackoverflow.com/users/560450/krist%c3%b3f-marussy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 342, "favorite_count": 1, "accepted_answer_id": 49375173, "answer_count": 1, "score": 8, "last_activity_date": 1521510792, "creation_date": 1521501586, "question_id": 49373949, "link": "https://stackoverflow.com/questions/49373949/what-is-the-dual-of-a-prism-or-an-affine-traversal", "title": "What is the dual of a prism or an affine traversal?", "body": "<p>A <em>prism</em> is an optic for focusing into coproduct types, while <a href=\"http://oleg.fi/gists/posts/2017-03-20-affine-traversal.html\" rel=\"noreferrer\"><em>affine traversal</em></a> is a kind of optic which can focus at 0 of 1 element, i.e. <code>AffineTraversal s t a b</code> is isomorphic to <code>(s -&gt; Maybe a, (s, b) -&gt; t)</code>. As far as I know, we get an affine traversal when a lens is composed with a prism, provided an appropriate encoding of prisms is used.</p>\n\n<p>I am interested in moving the <code>Maybe</code> in that (naive) formulation to the setter side as opposed to the getter side, so that I can have an optic that always extracts exactly one element, but may fail to put it back.</p>\n\n<p>My use case is related to refinement types. Imagine that we have a type <code>A</code> and its refinement <code>B</code> (<code>B \u2286 A</code>). Then there is a prism <code>refined :: Prism' A B</code>: an <code>A</code> may or may not be a valid <code>B</code>, but each <code>B</code> can be <code>re</code> get into an <code>A</code>. Combining a <code>Lens' C A</code> with <code>refined</code>, we have an affine traversal. In the other direction, one may imagine an optic <code>unrefined</code> which is a little bit smarter than <code>re refined</code>: an <code>A</code> can be turned into <code>Just b</code>, if it is a valid <code>B</code>, or <code>Nothing</code>, if it is not. Now if we combine a <code>Lens' C B</code> with <code>unrefined</code>, we have our dual affine traversal: it can always obtain <code>A</code> from <code>C</code>, but putting back any old <code>A</code> may violate <code>C</code>'s invariant and yield <code>Nothing</code> instead of <code>Just c</code>. More complicated invariants may be ensured in a similar manner.</p>\n\n<p>Interestingly, the <a href=\"https://github.com/julien-truffaut/Monocle/blob/cdd129b7ac900c4226a610ed0b82937505713350/refined/shared/src/main/scala/monocle/refined/package.scala#L23\" rel=\"noreferrer\">monocle</a> library for Scala offers prisms for refinement types, but nothing for the reverse direction.</p>\n\n<p>I have hard times coming up with laws for these <code>(s -&gt; a, b -&gt; Maybe t)</code> and <code>(s -&gt; a, (s, b) -&gt; Maybe t)</code> gizmos, and I was wondering whether a more abstract formulation of optics is helpful.</p>\n\n<p>I know that with profunctor lens, we have</p>\n\n<pre><code>type Lens s t a b = forall p. Strong p =&gt; p a b -&gt; p s t\ntype Prism s t a b = forall p. Choice p =&gt; p a b -&gt; p s t\ntype AffineTraversal s t a b = forall p. (Strong p, Choice p) =&gt; p a b -&gt; p s t\n</code></pre>\n\n<p>which makes it really clear that a lens zooms into a product type, a prism zooms into a coproduct type, and an affine traversal has the ability to zoom into algebraic data type (products or coproducts, no less).</p>\n\n<p>Is the answer connected to something like <code>Cochoice</code> or even <code>Costrong</code> (remove a product / coproduct from the profunctor instead of introducing it)? I wasn't able to restore the naive formulation from them, however...</p>\n"}, {"tags": ["haskell", "conditional", "expression"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1521492891, "post_id": 49372168, "comment_id": 85745453, "body": "How about pattern matching, is that allowed?  My first guess is that&#39;s the solution the professor is trying to nudge you towards."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1521493025, "post_id": 49372168, "comment_id": 85745519, "body": "In what world is AND defined as <code>xnor</code>?  Notice that&#39;s what you appear to be implementing.  Also notice <code>if expr then True else False</code> is just <code>expr</code> and <code>val == True</code> is a long way to spell <code>val</code>."}, {"owner": {"reputation": 3, "user_id": 9519169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05255244db02d38a22b03633a68eeed2?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel_H", "link": "https://stackoverflow.com/users/9519169/daniel-h"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1521493243, "post_id": 49372168, "comment_id": 85745631, "body": "The two-argument function iff returns True exactly when both Boolean operands have the same value. Otherwise it returns False. Construct a design recipe for the iff function and implement it using  a) Conditional expressions (iffC).  b) Guarded equations (iffG). c) Pattern matching (iffP).  I already did Pattern without == and /=   <code>iffP True True = True iffP False False = True iffP _ _ = False</code>"}, {"owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 2, "creation_date": 1521493764, "post_id": 49372168, "comment_id": 85745870, "body": "@Daniel_H So you solved the problem yourself?"}, {"owner": {"reputation": 3, "user_id": 9519169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05255244db02d38a22b03633a68eeed2?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel_H", "link": "https://stackoverflow.com/users/9519169/daniel-h"}, "reply_to_user": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 0, "creation_date": 1521494109, "post_id": 49372168, "comment_id": 85746048, "body": "@HenriMenke No, I still have to solve it using Guarded and Conditional without == and /=. I noticed my mistake with XNOR instead of AND and have fixed that. I tried <code>iffC x y =   if True True then True       else False</code> but that doesnt work"}, {"owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 0, "creation_date": 1521494256, "post_id": 49372168, "comment_id": 85746112, "body": "@Daniel_H You are looking for <code>iffC x y = if x &amp;&amp; y then True else False</code> which is equivalent to <code>iffC x y = x &amp;&amp; y</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1521494303, "post_id": 49372168, "comment_id": 85746134, "body": "Note that you can write <code>x &amp;&amp; y</code> as <code>if x then ... else ...</code> (find what to write in the dots)."}, {"owner": {"reputation": 3, "user_id": 9519169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05255244db02d38a22b03633a68eeed2?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel_H", "link": "https://stackoverflow.com/users/9519169/daniel-h"}, "reply_to_user": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "edited": false, "score": 0, "creation_date": 1521494778, "post_id": 49372168, "comment_id": 85746374, "body": "@HenriMenke Thank you so much, everything is perfect now <code>iffC x y = if x &amp;&amp; y then True   else False  iffG x y   | x &amp;&amp; y = True   | otherwise = False  iffP True True = True iffP _ _ = False  iffB x y = x &amp;&amp; y</code> I feel so stupid for not realising this"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 4, "creation_date": 1521495286, "post_id": 49372168, "comment_id": 85746589, "body": "It will always be a miracle to me why people think it makes sense to write redundant expressions like <code>y = if x==True then True else False</code>."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1521496836, "post_id": 49372168, "comment_id": 85747333, "body": "@leftaroundabout I think it&#39;s a natural consequence of imperative habits. You know you need to make a decision based some set of booleans, so you start by writing <code>if</code>. Then you figure out what condition to put there, and what goes in the <code>then</code> and <code>else</code> clauses, and once it works you don&#39;t go back and realize that what you did is just silly, because <i>of course</i> <code>if</code> is how you work with booleans! What else would you use?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1521500955, "post_id": 49372168, "comment_id": 85748931, "body": "@leftaroundabout Most imperative tutorials focus only on integer variables and expressions. When dealing with <code>if (guard) ...</code> they never make you think about the guard being an <i>expression</i> as well, only having a boolean type. They just show examples where integer variables are compared with <code>&lt;,==,&gt;=,...</code>. Complex guards use <code>&amp;&amp;</code> as if it were a special &quot;guard&quot; syntax than an operator between boolean expressions. That&#39;s why you commonly see <code>if (x==0 &amp;&amp; y&lt;4) flag=true; else flag=false;</code>: there is no such a thing as a boolean expression, only &quot;guard syntax&quot;, to be used only inside <code>if&#47;while</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1521551503, "post_id": 49372168, "comment_id": 85771070, "body": "<code>if x == True then True else False</code> is just as redundant in imperative code as it is in functional code. As best as I can tell, people just don&#39;t recognize that the condition is itself an expression that evaluates to a Boolean value, rather than somehow &quot;part&quot; of the <code>if</code> statement itself.  (Related to the shell mistake of thinking that <code>[ ... ]</code> is part of the <code>if</code> statement rather than a command whose exit status is used by the <code>if</code> statement.)"}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1521510354, "post_id": 49372455, "comment_id": 85751319, "body": "<code>... | foo = True | otherwise = False</code> can be shorted to just <code>... = foo</code>. Doing this rewrite in <code>iffG</code> leads us back to the same implementation as for <code>iffC</code>; therefore I suspect the question about &quot;use a guard&quot; was aiming at something like <code>iffG x y | x = y | otherwise = False</code> as the implementation."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1521534062, "post_id": 49372455, "comment_id": 85759100, "body": "The first two are antipatterns, so I think this is not the intended solution. Also, this implements <code>&amp;&amp;</code> instead of iff."}, {"owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1521539345, "post_id": 49372455, "comment_id": 85762500, "body": "@chi Well, I don&#39;t know the original exercise, but this is what OP presented.  These examples are antipatterns in this case but I guess the exercise was intended to apply all of them without further consideration.  Of course I could be completely wrong."}], "tags": [], "owner": {"reputation": 9980, "user_id": 1944004, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/60f3cc97f94fa3690ba406f8c1a7fc4f?s=128&d=identicon&r=PG", "display_name": "Henri Menke", "link": "https://stackoverflow.com/users/1944004/henri-menke"}, "is_accepted": true, "score": 0, "last_activity_date": 1521519903, "last_edit_date": 1521519903, "creation_date": 1521494084, "answer_id": 49372455, "question_id": 49372168, "link": "https://stackoverflow.com/questions/49372168/haskell-and-gate-without-using-or/49372455#49372455", "title": "Haskell AND gate without using == or /=", "body": "<p>You could rewrite you existing solutions like this, which I think is what the exercise was aimed at.</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>iffC :: Bool -&gt; Bool -&gt; Bool\niffC x y = if x &amp;&amp; y\n           then True\n           else False\n\niffG :: Bool -&gt; Bool -&gt; Bool\niffG x y | x &amp;&amp; y = True\n         | otherwise = False\n\niffP :: Bool -&gt; Bool -&gt; Bool\niffP True True = True\niffP _ _ = False\n</code></pre>\n\n<p>I don't really see how this exercise is instructive because all those implementations are a complicated way of saying <code>&amp;&amp;</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1521551929, "last_edit_date": 1521551929, "creation_date": 1521541447, "answer_id": 49381681, "question_id": 49372168, "link": "https://stackoverflow.com/questions/49372168/haskell-and-gate-without-using-or/49381681#49381681", "title": "Haskell AND gate without using == or /=", "body": "<p>Any binary boolean operator can be defined using the pattern</p>\n\n<pre><code>op :: Bool -&gt; Bool -&gt; Bool\nop x y =\n   if x\n   then if y then ... else ...\n   else if y then ... else ...\n</code></pre>\n\n<p>where the four <code>...</code> are, essentially, the truth table for <code>op</code>.</p>\n\n<p>Often this leads to antipatterns like</p>\n\n<pre><code>if z then True else False\n</code></pre>\n\n<p>which should be rewritten as</p>\n\n<pre><code>z\n</code></pre>\n\n<p>or</p>\n\n<pre><code>if z then False else True\n</code></pre>\n\n<p>which should be rewritten as</p>\n\n<pre><code>not z\n</code></pre>\n\n<p>or</p>\n\n<pre><code>if z then True else True\n</code></pre>\n\n<p>which should be rewritten as</p>\n\n<pre><code>True\n</code></pre>\n\n<p>or the analogous case for <code>False</code>. Essentially, such <code>if</code>s can always be rewritten as one of <code>z, not z, True, False</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 291, "user_id": 9529580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e826697f12ac7b6de2a502cd1e7e0b5?s=128&d=identicon&r=PG", "display_name": "Vora", "link": "https://stackoverflow.com/users/9529580/vora"}, "is_accepted": false, "score": 0, "last_activity_date": 1521645538, "creation_date": 1521645538, "answer_id": 49410175, "question_id": 49372168, "link": "https://stackoverflow.com/questions/49372168/haskell-and-gate-without-using-or/49410175#49410175", "title": "Haskell AND gate without using == or /=", "body": "<p>Pattern matching seems like it would work like a charm for this.</p>\n\n<pre><code>iffC :: Bool -&gt; Bool -&gt; Bool\niffC True True = True\niffC False False = True\niffC _ _ = False\n</code></pre>\n\n<p>You get the free bonus of having your truth table visible.</p>\n"}], "owner": {"reputation": 3, "user_id": 9519169, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/05255244db02d38a22b03633a68eeed2?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel_H", "link": "https://stackoverflow.com/users/9519169/daniel-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 553, "favorite_count": 0, "accepted_answer_id": 49372455, "answer_count": 3, "score": 0, "last_activity_date": 1521645538, "creation_date": 1521492612, "last_edit_date": 1521535708, "question_id": 49372168, "link": "https://stackoverflow.com/questions/49372168/haskell-and-gate-without-using-or", "title": "Haskell AND gate without using == or /=", "body": "<p>I am not allowed to use == or /=, but I have no idea how I can rewrite it without them.</p>\n\n<pre><code>iffC x y = \nif x == True &amp;&amp; y == True then True\n  else if x == False &amp;&amp; y == False then True\n    else False\n\niffG x y\n  | y == True &amp;&amp; x == True = True\n  | y == False &amp;&amp; x == False = True\n  | otherwise = False\n</code></pre>\n"}, {"tags": ["list", "haskell", "filter"], "comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1521504682, "post_id": 49371601, "comment_id": 85750014, "body": "<code>length [likes]</code> is always 1 because you\u2019re passing it a list of one element, being the list <code>likes</code>. Presumably you want <code>length likes</code> there."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 2, "last_activity_date": 1521490952, "creation_date": 1521490952, "answer_id": 49371761, "question_id": 49371601, "link": "https://stackoverflow.com/questions/49371601/how-do-i-filter-a-list-in-haskell-based-on-a-particular-elements-value/49371761#49371761", "title": "How do I filter a list in Haskell based on a particular elements value?", "body": "<p>I think you use <code>filter</code> the wrong way. <code>filter</code> is a function that takes two parameters, the first one a predicate <code>a -&gt; Bool</code> and the second one a list of <code>a</code>s.</p>\n\n<p>Now the parameter that is passed to <code>listRating</code> is that list, so <code>listRating l</code>, and you thus call the <code>filter</code> with <code>filter filterFilm l</code>, so:</p>\n\n<pre><code>listRating :: Database -&gt; Database\nlistRating l = filter filterFilm l\n</code></pre>\n\n<p>We can also remove the <code>l</code> parameter both in the head and body of the function, like:</p>\n\n<pre><code>listRating :: Database -&gt; Database\nlistRating = filter filterFilm\n</code></pre>\n\n<p>Note that you can simplify your <code>filterFilm</code> function to:</p>\n\n<pre><code>filterFilm :: Film -&gt; Bool\nfilterFilm (Film t d y likes dislikes) = rating likes dislikes &gt; 74\n</code></pre>\n"}], "owner": {"reputation": 400, "user_id": 4443260, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/eWZcs.png?s=128&g=1", "display_name": "Kris Rice", "link": "https://stackoverflow.com/users/4443260/kris-rice"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 514, "favorite_count": 0, "accepted_answer_id": 49371761, "answer_count": 1, "score": 1, "last_activity_date": 1521490952, "creation_date": 1521490327, "question_id": 49371601, "link": "https://stackoverflow.com/questions/49371601/how-do-i-filter-a-list-in-haskell-based-on-a-particular-elements-value", "title": "How do I filter a list in Haskell based on a particular elements value?", "body": "<p>I have a list of type Film, where Film(Director Title Year Likes Dislikes), which corresponds to Film -> String -> String -> Int -> [String] -> [String].\nI also have a function that takes in the likes and dislikes lists and returns a percentage rating, as such that:</p>\n\n<pre><code>rating :: Likes -&gt; Dislikes -&gt; Int\nrating likes dislikes = (((length [likes]) / ((length [dislikes]) + (length [likes]))) * 100)\n</code></pre>\n\n<p>My problem:\nI cannot work out how to use <code>filter</code> to sort this list, to determine whether or not each film's rating is 75% or over.</p>\n\n<p>This is my current attempt:</p>\n\n<pre><code>filterFilm :: Film -&gt; Bool\nfilterFilm (Film t d y likes dislikes)\n            | (rating likes dislikes) &gt; 74  = True\n            | otherwise                     = False\n\n-- List film rating with and over 75%\nlistRating :: Database -&gt; Database\nlistRating (x:xs) = filter (filterFilm x) (x:xs)\n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code>Cw 2018.hs:87:29: error:\n    \u2022 Couldn't match expected type \u2018Film -&gt; Bool\u2019\n                  with actual type \u2018Bool\u2019\n    \u2022 Possible cause: \u2018filterFilm\u2019 is applied to too many arguments\n      In the first argument of \u2018filter\u2019, namely \u2018(filterFilm x)\u2019\n      In the expression: filter (filterFilm x) (x : xs)\n      In an equation for \u2018listRating\u2019:\n          listRating (x : xs) = filter (filterFilm x) (x : xs)\n   |\n87 | listRating (x:xs) = filter (filterFilm x) (x:xs)    |        \n</code></pre>\n\n<p>Any suggestions? Thanks in advance!   </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 0, "creation_date": 1521489004, "post_id": 49370984, "comment_id": 85743488, "body": "<a href=\"https://stackoverflow.com/questions/33225837/non-blocking-read-from-subprocess-in-haskell\" title=\"non blocking read from subprocess in haskell\">stackoverflow.com/questions/33225837/&hellip;</a> I think I&#39;ve found a solution at the above."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1521489128, "post_id": 49370984, "comment_id": 85743555, "body": "<a href=\"https://stackoverflow.com/questions/11744527/how-can-i-watch-multiple-files-socket-to-become-readable-writable-in-haskell\">You fork a thread, then go ahead and block.</a>"}], "answers": [{"tags": [], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "is_accepted": true, "score": 0, "last_activity_date": 1521667869, "last_edit_date": 1521667869, "creation_date": 1521495440, "answer_id": 49372745, "question_id": 49370984, "link": "https://stackoverflow.com/questions/49370984/how-can-i-poll-a-process-for-its-stdout-stderrr-output-blocked-by-iseof/49372745#49372745", "title": "How can I poll a process for it&#39;s stdout / stderrr output? Blocked by isEOF", "body": "<p>I had to use additional threads, MVars, as well as timeouts:</p>\n\n<pre><code>runGhci :: Text -&gt; IO Text\nrunGhci _ =  do\n  let expr = \"123 &lt;$&gt; 123\"\n  let inputLines = filter (/= \"\") (T.lines expr)\n  print inputLines\n  createProcess ((proc \"ghci\" [\"-v0\", \"-ignore-dot-ghci\"]) {std_in=CreatePipe, std_out=CreatePipe, std_err=CreatePipe}) &gt;&gt;= \\case\n    (Just pin, Just pout, Just perr, ph) -&gt; do\n      output &lt;- do\n        forM inputLines\n          (\\i -&gt; do\n              let script = \"putStrLn \" ++ show magic ++ \"\\n\"\n                            ++ cs i ++ \"\\n\"\n                            ++ \"putStrLn \" ++ show magic ++ \"\\n\"\n              do\n                stdoutMVar &lt;- newEmptyMVar\n                stderrMVar &lt;- newMVar \"\"\n                hPutStr pin script\n                hFlush pin\n                tOutId &lt;- forkIO $ extract' pout &gt;&gt;= putMVar stdoutMVar\n                tErrId &lt;- forkIO $ do\n                  let f' = hGetLine perr &gt;&gt;= (\\l -&gt; modifyMVar_ stderrMVar (return . (++ (l ++ \"\\n\"))))\n                  forever f'\n                x &lt;- timeout (1 * (10^6)) (takeMVar stdoutMVar) &gt;&gt;= return . fromMaybe \"***ghci timed out\"\n                y &lt;- timeout (1 * (10^6)) (takeMVar stderrMVar) &gt;&gt;= return . fromMaybe \"***ghci timed out\"\n                killThread tOutId\n                killThread tErrId\n                return $ trace \"OUTPUT\" $ cs $! x ++ y\n          )\n      let final = T.concat ( zipWith f (inputLines :: [Text]) (output :: [Text]) :: [Text])\n      print final\n      terminateProcess ph\n      pure $ T.strip $ cs $ final\n    _ -&gt; error \"Invaild GHCI process\"\n</code></pre>\n"}], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 49372745, "answer_count": 1, "score": 0, "last_activity_date": 1521667869, "creation_date": 1521487950, "last_edit_date": 1521488469, "question_id": 49370984, "link": "https://stackoverflow.com/questions/49370984/how-can-i-poll-a-process-for-its-stdout-stderrr-output-blocked-by-iseof", "title": "How can I poll a process for it&#39;s stdout / stderrr output? Blocked by isEOF", "body": "<p>The following example requires the packages of:</p>\n\n<pre><code>- text\n- string-conversions\n- process\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE LambdaCase #-}\n\nmodule Example where\n\nimport qualified Data.Text as T\nimport Data.Text (Text)\nimport Data.Monoid\nimport Control.Monad.Identity\nimport System.Process\nimport GHC.IO.Handle\nimport Debug.Trace\nimport Data.String.Conversions\n\nrunGhci :: Text -&gt; IO Text\nrunGhci _ =  do\n  let expr = \"print \\\"test\\\"\"\n  let inputLines = (&lt;&gt; \"\\n\") &lt;$&gt; T.lines expr :: [Text]\n  print inputLines\n  createProcess ((proc \"ghci\" [\"-v0\", \"-ignore-dot-ghci\"]) {std_in=CreatePipe, std_out=CreatePipe, std_err=CreatePipe}) &gt;&gt;= \\case\n    (Just pin, Just pout, Just perr, ph) -&gt; do\n      output &lt;-\n        forM inputLines (\\i -&gt; do\n          let script = i &lt;&gt; \"\\n\"\n          do\n            hPutStr pin $ cs $ script\n            hFlush pin\n            x &lt;- hIsEOF pout &gt;&gt;= \\case\n              True -&gt; return \"\"\n              False -&gt; hGetLine pout\n            y &lt;- hIsEOF perr &gt;&gt;= \\case\n              True -&gt; return \"\"\n              False -&gt; hGetLine perr\n            let output = cs $! x ++ y\n            return $ trace \"OUTPUT\" $ output\n        )\n      let f i o = \"ghci&gt;\" &lt;&gt; i &lt;&gt; o\n      let final = T.concat ( zipWith f (inputLines :: [Text]) (output :: [Text]) :: [Text])\n      print final\n      terminateProcess ph\n      pure $ T.strip $  final\n    _ -&gt; error \"Invaild GHCI process\"\n</code></pre>\n\n<p>If I attempt to run the above:</p>\n\n<pre><code>stack ghci src/Example.hs\nghci&gt; :set -XOverloadedStrings\nghci&gt; runGhci \"\"\n[\"print \\\"test\\\"\\n\"]\n</code></pre>\n\n<p>It appears to be blocking on <code>hIsEOF perr</code>, according to <a href=\"https://stackoverflow.com/a/26510673/1663462\">https://stackoverflow.com/a/26510673/1663462</a> it sounds like I shouldn't call this function unless there is 'some output' ready to be flushed / read... However how do I handle the case where it does not have any output at that stage? I don't mind periodically 'checking' or having a timeout. </p>\n\n<p>How can I prevent the above from hanging? I've tried various approaches involving <code>hGetContents</code>, <code>hGetLine</code> however they all seem to end up blocking (or closing the handle) in this situation... </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 649, "user_id": 2998746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fc15b842026d8a039ffdd1b2a528aec?s=128&d=identicon&r=PG&f=1", "display_name": "Euge", "link": "https://stackoverflow.com/users/2998746/euge"}, "edited": false, "score": 0, "creation_date": 1521477680, "post_id": 49368020, "comment_id": 85737011, "body": "You will need GADTS. Check out this <a href=\"https://wiki.haskell.org/GADTs_for_dummies\" rel=\"nofollow noreferrer\">wiki.haskell.org/GADTs_for_dummies</a>"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1521477751, "post_id": 49368020, "comment_id": 85737051, "body": "It would be good if you could explain a bit more detailed what you would like to impose at the type level. Give some examples of what should and what shouldn&#39;t compile."}, {"owner": {"reputation": 8049, "user_id": 2718064, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/jEp0E.jpg?s=128&g=1", "display_name": "marcosh", "link": "https://stackoverflow.com/users/2718064/marcosh"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1521477925, "post_id": 49368020, "comment_id": 85737179, "body": "@leftaroundabout I edited the question providing some examples"}, {"owner": {"reputation": 8049, "user_id": 2718064, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/jEp0E.jpg?s=128&g=1", "display_name": "marcosh", "link": "https://stackoverflow.com/users/2718064/marcosh"}, "reply_to_user": {"reputation": 649, "user_id": 2998746, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2fc15b842026d8a039ffdd1b2a528aec?s=128&d=identicon&r=PG&f=1", "display_name": "Euge", "link": "https://stackoverflow.com/users/2998746/euge"}, "edited": false, "score": 0, "creation_date": 1521477956, "post_id": 49368020, "comment_id": 85737204, "body": "@Euge could you please provide an example on how I could use GADTs in this case?"}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1521487440, "post_id": 49368745, "comment_id": 85742658, "body": "I think you got the OP direction wrong: &quot;a node must contain only <code>Tree</code>s with a higher level&quot; requires <code>&#39;Succ</code> on the other side. I&#39;d be temped to add a constructor <code>Higher :: Tree (&#39;Succ lvl) -&gt; Tree lvl</code> so to be able to represent &quot;higher&quot; instead of &quot;+1&quot; (at some cost, though). (Otherwise, we could also model the &quot;higher&quot; relation with another GADT...)"}], "tags": [], "owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "is_accepted": false, "score": 10, "last_activity_date": 1521479685, "creation_date": 1521479685, "answer_id": 49368745, "question_id": 49368020, "link": "https://stackoverflow.com/questions/49368020/impose-nesting-limits-on-recursive-data-structure/49368745#49368745", "title": "Impose nesting limits on recursive data structure", "body": "<p>Here's the basic idea. The easiest way to encode recursion limits like this is to use <a href=\"https://en.wikipedia.org/wiki/Peano_axioms\" rel=\"noreferrer\">Peano numbers</a>. Let's define such a type.</p>\n\n<pre><code>data Number = Zero | Succ Number\n</code></pre>\n\n<p>A number is either zero or the successor of another number. This is a nice way to define numbers here, as it will get along nicely with our tree recursion. Now, we want the <code>Level</code> to be a type, not a value. If it's a value, we can't limit its value at the type level. So we use GADTs to restrict the way we can initialize things.</p>\n\n<pre><code>data Tree (lvl :: Number) where\n    Leaf :: String -&gt; Tree lvl\n    Node :: [Tree lvl] -&gt; Tree ('Succ lvl)\n</code></pre>\n\n<p><code>lvl</code> is the depth. A <code>Leaf</code> node can have any depth, but a <code>Node</code> node is restricted in its depth and must be strictly greater than that of its children (here, strictly one greater, which works in most simple cases. Allowing it to be strictly greater in general would require some more complicated type-level tricks, possibly with <code>-XTypeInType</code>). Notice that we use <code>'Succ</code> at the type level. This is a <em>promoted type</em>, enabled with <code>-XDataKinds</code>. We also need <code>-XKindSignatures</code> to enable the <code>:: Number</code> constraint.</p>\n\n<p>Now let's write a function.</p>\n\n<pre><code>f :: Tree ('Succ 'Zero) -&gt; String\nf _ = \"It works!\"\n</code></pre>\n\n<p>This function only takes trees that go at most one level deep. We can try to call it.</p>\n\n<pre><code>f (Leaf \"A\") -- It works!\nf (Node [Leaf \"A\"]) -- It works!\nf (Node [Node [Leaf \"A\"]]) -- Type error\n</code></pre>\n\n<p>So it will fail at compile-time if the depth is too much.</p>\n\n<p>Complete example (including compiler extensions):</p>\n\n<pre><code>{-# LANGUAGE GADTs, KindSignatures, DataKinds #-}\n\ndata Number = Zero | Succ Number\n\ndata Tree (lvl :: Number) where\n    Leaf :: String -&gt; Tree lvl\n    Node :: [Tree lvl] -&gt; Tree ('Succ lvl)\n\nf :: Tree ('Succ 'Zero) -&gt; String\nf _ = \"It works!\"\n</code></pre>\n\n<p>This isn't everything you can do with this. There's certainly expansions to be made, but it gets the point across and will hopefully point you in the right direction.</p>\n"}, {"comments": [{"owner": {"reputation": 8049, "user_id": 2718064, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/jEp0E.jpg?s=128&g=1", "display_name": "marcosh", "link": "https://stackoverflow.com/users/2718064/marcosh"}, "edited": false, "score": 0, "creation_date": 1521542619, "post_id": 49373746, "comment_id": 85764873, "body": "Thanks a lot, very nice answer. I had to modify it slightly to ensure that a level could not be contained in itself using <code>Node :: Plus n m z =&gt; Level z -&gt; [Tree (&#39;S z)] -&gt; Tree n</code>"}], "tags": [], "owner": {"reputation": 8556, "user_id": 4892417, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NaBTj.jpg?s=128&g=1", "display_name": "oisdk", "link": "https://stackoverflow.com/users/4892417/oisdk"}, "is_accepted": true, "score": 9, "last_activity_date": 1535573444, "last_edit_date": 1592644375, "creation_date": 1521500282, "answer_id": 49373746, "question_id": 49368020, "link": "https://stackoverflow.com/questions/49368020/impose-nesting-limits-on-recursive-data-structure/49373746#49373746", "title": "Impose nesting limits on recursive data structure", "body": "<p>So there are a number of difficulties with this question. Peano numbers are a good place to start, though:</p>\n<pre><code>{-# LANGUAGE DataKinds                 #-}\n{-# LANGUAGE GADTs                     #-}\n{-# LANGUAGE KindSignatures            #-}\n{-# LANGUAGE MultiParamTypeClasses     #-}\n{-# LANGUAGE FlexibleInstances         #-}\n{-# LANGUAGE TypeOperators             #-}\n{-# LANGUAGE FlexibleContexts          #-}\n{-# LANGUAGE ConstraintKinds           #-}\n\ndata Nat = Z | S Nat\n</code></pre>\n<p>Next, we'll need some way of saying one number is &quot;bigger&quot; than another. We can do so by first defining an inductive class for &quot;n is less than or equal to m&quot;</p>\n<pre><code>class (n :: Nat) &lt;= (m :: Nat)\ninstance Z &lt;= n\ninstance n &lt;= m =&gt; (S n &lt;= S m)\n</code></pre>\n<p>We can then define &quot;less than&quot; in terms of this:</p>\n<pre><code>type n &lt; m = S n &lt;= m\n</code></pre>\n<p>Finally, here's the Tree and Levels:</p>\n<pre><code>data Tree n where\n  Leaf :: String -&gt; Tree n\n  Node :: n &lt; z =&gt; Level z -&gt; [Tree z] -&gt; Tree n\n\ndata Level n where\n  Level0 :: Level Z\n  Level1 :: Level (S Z)\n  Level2 :: Level (S (S Z))\n  Level3 :: Level (S (S (S Z)))\n  Level4 :: Level (S (S (S (S Z))))\n</code></pre>\n<p>And, as desired, the first example compiles:</p>\n<pre><code>tree = Node Level1\n    [ Node Level2 []\n    , Node Level3 []   \n    ]\n</code></pre>\n<p>While the second does not:</p>\n<pre><code>tree = Node Level2\n    [ Node Level1 []\n    ]\n</code></pre>\n<p>Just for extra fun, we can now add a &quot;custom type error&quot; (this will need <code>UndecidableInstances</code>:</p>\n<pre><code>import GHC.TypeLits (TypeError, ErrorMessage(Text))\n\ninstance TypeError (Text &quot;Nodes must contain trees of a higher level&quot;) =&gt; S n &lt; Z\n</code></pre>\n<p>So when you write:</p>\n<pre><code>tree = Node Level2\n    [ Node Level1 []\n    ]\n</code></pre>\n<p>You get the following:</p>\n<blockquote>\n<p>\u2022 Nodes must contain trees of a higher level</p>\n<p>\u2022 In the expression: Node Level1 []</p>\n<p>In the second argument of \u2018Node\u2019, namely \u2018[Node Level1 []]\u2019</p>\n<p>In the expression: Node Level2 [Node Level1 []]</p>\n</blockquote>\n<p>If you want to make &quot;level&quot; more generic, you'll need a couple more extensions:</p>\n<pre><code>{-# LANGUAGE TypeApplications, RankNTypes, AllowAmbiguousTypes, TypeFamilies #-}\nimport qualified GHC.TypeLits as Lits\n\ndata Level n where\n  Level0 :: Level Z\n  LevelS :: !(Level n) -&gt; Level (S n)\n    \nclass HasLevel n where level :: Level n\ninstance HasLevel Z where level = Level0\ninstance HasLevel n =&gt; HasLevel (S n) where level = LevelS level\n    \ntype family ToPeano (n :: Lits.Nat) :: Nat where\n  ToPeano 0 = Z\n  ToPeano n = S (ToPeano (n Lits.- 1))\n    \nnode :: forall q z n m. (ToPeano q ~ z, HasLevel z, n &lt; z) =&gt; [Tree z] -&gt; Tree n\nnode = Node level\n    \ntree =\n    node @1\n      [ node @2 []\n      , node @3 []   \n      ]\n    \n</code></pre>\n"}], "owner": {"reputation": 8049, "user_id": 2718064, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/jEp0E.jpg?s=128&g=1", "display_name": "marcosh", "link": "https://stackoverflow.com/users/2718064/marcosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 361, "favorite_count": 2, "accepted_answer_id": 49373746, "answer_count": 2, "score": 10, "last_activity_date": 1535573444, "creation_date": 1521477427, "last_edit_date": 1521478107, "question_id": 49368020, "link": "https://stackoverflow.com/questions/49368020/impose-nesting-limits-on-recursive-data-structure", "title": "Impose nesting limits on recursive data structure", "body": "<p>Consider a recursive data structure like the following:</p>\n\n<pre><code>data Tree level\n    = Leaf String\n    | Node level [ Tree level ]\n</code></pre>\n\n<p>Now, if <code>level</code> is an instance of <code>Ord</code>, I would like to impose at the type level the following limitation on the data structure: a node must contain only <code>Tree</code>s with a higher <code>level</code>.</p>\n\n<p>You can safely assume that <code>level</code> is a simple sum type like</p>\n\n<pre><code>Level\n= Level1\n| Level2\n...\n| LevelN\n</code></pre>\n\n<p>but where <code>N</code> is not known a priori. In this case I would be able to have that all the subnodes of a node have a higher level.</p>\n\n<p>For example</p>\n\n<pre><code>tree = Node Level1\n    [ Node Level2 []\n    , Node Level3 []   \n    ]\n</code></pre>\n\n<p>should compile, while</p>\n\n<pre><code>tree = Node Level2\n    [ Node Level1 []\n    ]\n</code></pre>\n\n<p>should not.</p>\n\n<p>Is it possible to model such a thing in Haskell?</p>\n"}, {"tags": ["validation", "haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1521475567, "post_id": 49367072, "comment_id": 85735573, "body": "You shouldn&#39;t be using <code>==</code> here at all; although <code>Maybe a</code> has an <code>Eq</code> instance, you don&#39;t <i>need</i> to use it here. Pattern matching is sufficient."}], "answers": [{"tags": [], "owner": {"reputation": 31724, "user_id": 6264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbb17eeeecd3d9d06f4db310ab630a12?s=128&d=identicon&r=PG", "display_name": "Michiel Borkent", "link": "https://stackoverflow.com/users/6264/michiel-borkent"}, "is_accepted": false, "score": 2, "last_activity_date": 1521475188, "creation_date": 1521475188, "answer_id": 49367301, "question_id": 49367072, "link": "https://stackoverflow.com/questions/49367072/haskell-validate-integer-input-from-string-using-readmaybe/49367301#49367301", "title": "Haskell - Validate integer input from string using readMaybe", "body": "<p>You could rewrite this as</p>\n\n<pre><code>import Data.Char\nimport Data.List\nimport Text.Read\n\ncheckValidInt :: String -&gt; Bool\ncheckValidInt strInt =\n  case (readMaybe strInt :: Maybe Int) of\n    Nothing -&gt; False\n    Just _  -&gt; True\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17, "user_id": 3339668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f7d9d6f526a2b6d2ff4945dc804e189?s=128&d=identicon&r=PG&f=1", "display_name": "woofdinos", "link": "https://stackoverflow.com/users/3339668/woofdinos"}, "edited": false, "score": 0, "creation_date": 1521475666, "post_id": 49367307, "comment_id": 85735641, "body": "Thank you, detailed and concise."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1521475848, "last_edit_date": 1521475848, "creation_date": 1521475198, "answer_id": 49367307, "question_id": 49367072, "link": "https://stackoverflow.com/questions/49367072/haskell-validate-integer-input-from-string-using-readmaybe/49367307#49367307", "title": "Haskell - Validate integer input from string using readMaybe", "body": "<p>This is due to the fact that Haskell interprets your</p>\n\n<pre><code>readMaybe strInt :: (Maybe Int == Nothing = False)\n</code></pre>\n\n<p>as:</p>\n\n<pre><code>readMaybe strInt :: (Maybe Int == Nothing = False)\n</code></pre>\n\n<p>It can make no sense out of this. So you can help Haskell by using some brackets:</p>\n\n<pre><code>(readMaybe strInt :: Maybe Int) == Nothing = False\n</code></pre>\n\n<p>You also better do not repeat the condition, but use <code>otherwise</code>, since if you repeat it, the program will - unless optimized - do the parsing twice, so:</p>\n\n<pre><code>checkValidInt :: String -&gt; Bool\ncheckValidInt strInt\n | (readMaybe strInt :: Maybe Int) == Nothing = False\n | otherwise = True\n</code></pre>\n\n<p>Since you check for a condition such that the result is <code>True</code> if the condition is <code>False</code>, and vice versa, it is no use to use guards, we can write it as:</p>\n\n<pre><code>checkValidInt :: String -&gt; Bool\ncheckValidInt strInt = Nothing /= (readMaybe strInt :: Maybe Int)\n</code></pre>\n\n<p>Or we can use a <em>pattern guard</em>, this can be used in case we can not perform equality checks on the type of value that is wrapped in the <code>Maybe</code>, so:</p>\n\n<pre><code>checkValidInt :: String -&gt; Bool\ncheckValidInt strInt | Just _ &lt;- (readMaybe strInt :: Maybe Int) = True\n                     | otherwise = False\n</code></pre>\n\n<p>Or we can use the <a href=\"https://www.haskell.org/hoogle/?hoogle=isJust\" rel=\"nofollow noreferrer\"><strong><code>isJust :: Maybe a -&gt; Bool</code></strong></a> function:</p>\n\n<pre><code>checkValidInt :: String -&gt; Bool\ncheckValidInt strInt = isJust (readMaybe strInt :: Maybe Int)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1521478684, "post_id": 49367464, "comment_id": 85737725, "body": "I completely agree. This is likely to be a case of &quot;boolean blindness&quot;, where all the information is reduced to a boolean, since the programmer can only understand <code>if</code> but not <code>case</code>. As a net result the code is less efficient (the string is parsed twice), less readable (longer), and less safe (partial functions are used)."}], "tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": false, "score": 4, "last_activity_date": 1521476145, "last_edit_date": 1521476145, "creation_date": 1521475651, "answer_id": 49367464, "question_id": 49367072, "link": "https://stackoverflow.com/questions/49367072/haskell-validate-integer-input-from-string-using-readmaybe/49367464#49367464", "title": "Haskell - Validate integer input from string using readMaybe", "body": "<blockquote>\n  <p>I just need a boolean result</p>\n</blockquote>\n\n<p>Probably not. You need a <code>Maybe Int</code> to pattern match on, and <code>readMaybe</code> already gives you that without any further processing.</p>\n\n<p>Instead of this</p>\n\n<pre><code>if checkValidInt s                -- try reading an Int, but throw it away\n   then foo (read s)              -- now really read an Int and use it\n   else bar                       -- fall back\n</code></pre>\n\n<p>you do this</p>\n\n<pre><code>case readMaybe s of               -- try reading an Int\n   Just i   -&gt; foo i              -- use it\n   Nothing  -&gt; bar                -- fall back\n</code></pre>\n\n<p>Normally an explicit type annotation should not be needed, if <code>foo</code> is of the right type; but see below.</p>\n\n<p>If you, for some unfathomable reason, really need <code>checkValidInt</code>, you base it on the above pattern</p>\n\n<pre><code>case (readMaybe s) :: Maybe Int of \n   Just _   -&gt; True\n   Nothing  -&gt; False\n</code></pre>\n\n<p>As noted in another answer, the <code>maybe</code> function abstracts this pattern match away, but I would recommend using explicit pattern matches whenever you can as an exercise, to get the hang of it. </p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1521477175, "last_edit_date": 1521477175, "creation_date": 1521475891, "answer_id": 49367543, "question_id": 49367072, "link": "https://stackoverflow.com/questions/49367072/haskell-validate-integer-input-from-string-using-readmaybe/49367543#49367543", "title": "Haskell - Validate integer input from string using readMaybe", "body": "<p>The algorithm you need here has already been abstracted behind the <code>maybe</code> function:</p>\n\n<pre><code>checkValidInt :: String -&gt; Bool\ncheckValidInt = maybe False (const True) . (readMaybe :: String -&gt; Maybe Int)\n</code></pre>\n\n<p>If <code>readMaybe</code> returns <code>Nothing</code>, then <code>maybe</code> returns <code>False</code>. Otherwise, it just applies <code>const True</code> to the resulting <code>Just</code> value, which returns <code>True</code> without caring about just what is wrapped by <code>Just</code>. Note that you are specializing the type of <code>readMaybe</code> <em>itself</em>, not the type of its return value.</p>\n\n<p>Or, even simpler with an import,</p>\n\n<pre><code>import Data.Maybe\ncheckValidInt :: String -&gt; Bool\ncheckValidInt = isJust . (readMaybe :: String -&gt; Maybe Int)\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 3339668, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f7d9d6f526a2b6d2ff4945dc804e189?s=128&d=identicon&r=PG&f=1", "display_name": "woofdinos", "link": "https://stackoverflow.com/users/3339668/woofdinos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1340, "favorite_count": 0, "accepted_answer_id": 49367307, "answer_count": 4, "score": 0, "last_activity_date": 1521477175, "creation_date": 1521474427, "last_edit_date": 1521475094, "question_id": 49367072, "link": "https://stackoverflow.com/questions/49367072/haskell-validate-integer-input-from-string-using-readmaybe", "title": "Haskell - Validate integer input from string using readMaybe", "body": "<p>I am trying to validate integer input from a string, I just need a boolean result if the input string correctly changes types to an integer. I tried this method from another question:</p>\n\n<p><a href=\"https://stackoverflow.com/a/30030649/3339668\">https://stackoverflow.com/a/30030649/3339668</a></p>\n\n<p>This is the relevant code along with my imports:</p>\n\n<pre><code>import Data.Char\nimport Data.List\nimport Text.Read\n\ncheckValidInt :: String -&gt; Bool\ncheckValidInt strInt\n | readMaybe strInt :: Maybe Int == Nothing = False\n | readMaybe strInt :: Maybe Int /= Nothing = True\n</code></pre>\n\n<p>However, I receive the following errors on loading the script:</p>\n\n<pre><code>Illegal operator \u2018==\u2019 in type \u2018Maybe Int == Nothing\u2019\nUse TypeOperators to allow operators in types\n\nmain.hs:350:38:\nNot in scope: type constructor or class \u2018Nothing\u2019\nA data constructor of that name is in scope; did you mean DataKinds?\n\nmain.hs:351:35:\nIllegal operator \u2018/=\u2019 in type \u2018Maybe Int /= Nothing\u2019\n  Use TypeOperators to allow operators in types\n\nmain.hs:351:38:\nNot in scope: type constructor or class \u2018Nothing\u2019\nA data constructor of that name is in scope; did you mean DataKinds?\n</code></pre>\n\n<p>So what kind of data type is Nothing? How do I check if Nothing is the result of readMaybe properly?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["string", "haskell", "recursion", "numbers"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1521472744, "post_id": 49365698, "comment_id": 85733434, "body": "I find it rather weird to use strings instead of lists of integers in the first place. By using strings you basically &quot;lose information&quot;."}, {"owner": {"reputation": 187, "user_id": 9517321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dc52bd738d15863c94b001d51483099?s=128&d=identicon&r=PG&f=1", "display_name": "Aelin", "link": "https://stackoverflow.com/users/9517321/aelin"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1521473653, "post_id": 49365698, "comment_id": 85734156, "body": "@WillemVanOnsem This is an exercise and I&#39;m learning lists later, so that&#39;s why I have to use strings. :)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1521474336, "post_id": 49365698, "comment_id": 85734669, "body": "Strings <i>are</i> lists, which is why you can use <code>(++) :: [a] -&gt; [a] -&gt; [a]</code> on them. <code>&quot;0,1,0&quot;</code> is just syntactic sugar for <code>[&#39;0&#39;, &#39;,&#39;, &#39;1&#39;, &#39;,&#39;, &#39;0&#39;]</code>."}, {"owner": {"reputation": 187, "user_id": 9517321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dc52bd738d15863c94b001d51483099?s=128&d=identicon&r=PG&f=1", "display_name": "Aelin", "link": "https://stackoverflow.com/users/9517321/aelin"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1521475044, "post_id": 49365698, "comment_id": 85735186, "body": "@chepner Okay, thanks that helps a lot! :)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1521488551, "post_id": 49365698, "comment_id": 85743214, "body": "You aren&#39;t calling <code>read</code> anywhere, so it&#39;s hard to see how you could get an error message from it."}], "answers": [{"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 1, "last_activity_date": 1521471693, "creation_date": 1521471693, "answer_id": 49366035, "question_id": 49365698, "link": "https://stackoverflow.com/questions/49365698/haskell-recursive-function-that-returns-number-strings-prelude-read-no-parse/49366035#49366035", "title": "Haskell recursive function that returns number strings, Prelude.read: no parse", "body": "<p>this can get you started...</p>\n\n<pre><code>pyramidNumbers n = [0..n] ++ [(n-1),(n-2)..0]\n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 9517321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dc52bd738d15863c94b001d51483099?s=128&d=identicon&r=PG&f=1", "display_name": "Aelin", "link": "https://stackoverflow.com/users/9517321/aelin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1521481798, "creation_date": 1521470748, "last_edit_date": 1521481798, "question_id": 49365698, "link": "https://stackoverflow.com/questions/49365698/haskell-recursive-function-that-returns-number-strings-prelude-read-no-parse", "title": "Haskell recursive function that returns number strings, Prelude.read: no parse", "body": "<p>I'm new at Haskell programming and I'm trying to make a recursive function \"pyramid\" that returns string like this:</p>\n\n<p>pyramid 0 ==> \"0\"</p>\n\n<p>pyramid 1 ==> \"0,1,0\"</p>\n\n<p>pyramid 2 ==> \"0,1,2,1,0\"</p>\n\n<p>pyramid 3 ==> \"0,1,2,3,2,1,0\"</p>\n\n<p>--<strong>update</strong>--</p>\n\n<pre><code>pyramidHelper :: Integer -&gt; String\npyramidHelper n | n == 0 = ['0']\n                | otherwise = pyramidHelper (n-1) ++ [','] ++ ['n'] ++ [','] ++ pyramidHelper (n-1)\n\n\npyramid :: Integer -&gt; String\npyramid n   | n == 0    = show 0\n            | otherwise = pyramidHelper n\n</code></pre>\n\n<p>I'm getting <em>Exception: 'Prelude.read: no parse'</em>. I read <a href=\"https://stackoverflow.com/questions/27947925/haskell-prelude-read-no-parse-string\">Haskell Prelude.read: no parse String</a> and tried to change the code, but wasn't successful.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1521471034, "post_id": 49365581, "comment_id": 85732121, "body": "What about <code>map f $ map g $ map h x</code>? I do not see how the <code>negate ...</code> part is relevant here?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1521471290, "post_id": 49365581, "comment_id": 85732336, "body": "One can also define a custom application operator, say <code>$$</code> with the right infix level, and left-associativity, so that <code>f $$ x $$ y $$ z</code> means <code>((f x) y) z</code>. I would however avoid that, and prefer parentheses."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 2, "creation_date": 1521472008, "post_id": 49365581, "comment_id": 85732861, "body": "<code>flip map x $ f . g . h</code> but that&#39;s ugly."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1521472073, "post_id": 49365581, "comment_id": 85732906, "body": "<code>x &gt;&gt;= return . f . g . h</code>? Then you don&#39;t need <code>($)</code> either :)"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1521513644, "post_id": 49365581, "comment_id": 85752173, "body": "Related: <a href=\"https://stackoverflow.com/q/42357394/2751851\"><i>How would I re-write this expression using the function composition (.) /application ($) operators?</i></a>."}], "answers": [{"comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1521473258, "post_id": 49365896, "comment_id": 85733846, "body": "&gt; that is used as a trick to let Haskell write brackets implicitly  I really don&#39;t like this formulation. <code>$</code> is just the function application function (+ hacks which aren&#39;t relevant here), no need to bring brackets into this."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 5, "last_activity_date": 1521473510, "last_edit_date": 1521473510, "creation_date": 1521471306, "answer_id": 49365896, "question_id": 49365581, "link": "https://stackoverflow.com/questions/49365581/rewrite-map-f-g-h-x-with-without-parentheses/49365896#49365896", "title": "Rewrite `map (f.g.h) x` with $ without parentheses?", "body": "<p>If you define the function</p>\n\n<pre><code>map (f.g.h) x\n</code></pre>\n\n<p>You thus process <em>each</em> element of <code>x</code> with <code>f . g . h</code>, this means that we first apply <code>h</code> on it, then <code>g</code> on the result, and finally <code>f</code> on that result.</p>\n\n<p>But we can also work with three separate <code>map</code>s, like:</p>\n\n<pre><code>map f $ map g $ map h x\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 8, "last_activity_date": 1521473023, "creation_date": 1521473023, "answer_id": 49366535, "question_id": 49365581, "link": "https://stackoverflow.com/questions/49365581/rewrite-map-f-g-h-x-with-without-parentheses/49366535#49366535", "title": "Rewrite `map (f.g.h) x` with $ without parentheses?", "body": "<p>how about?</p>\n\n<pre><code>let u = f.g.h in map u x\n</code></pre>\n\n<p>no parenthesis, no <code>$</code></p>\n"}], "owner": {"reputation": 101, "user_id": 9472767, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Yw-8Kvw0uFQ/AAAAAAAAAAI/AAAAAAAAAHc/OjJ3Y_xR650/photo.jpg?sz=128", "display_name": "\u0160ef\u010d&#237;kov&#225; Jana", "link": "https://stackoverflow.com/users/9472767/%c5%a0ef%c4%8d%c3%adkov%c3%a1-jana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1521473510, "creation_date": 1521470359, "question_id": 49365581, "link": "https://stackoverflow.com/questions/49365581/rewrite-map-f-g-h-x-with-without-parentheses", "title": "Rewrite `map (f.g.h) x` with $ without parentheses?", "body": "<p>I would like check whether we can't rewrite <code>map (f.g.h) x</code> with <code>$</code> without parentheses as I didn't find a way.</p>\n\n<p>Here are my trials: </p>\n\n<pre><code>map (f.g.h) x\n-&gt; map (f.g.h) $ x  -- OK, no benefit\n-&gt; map $ f.g.h $ x  -- wrong as map doesn't take one parameter\n-&gt; (map $ f.g.h) x  -- Ok, no benefit, ugly :-)\n</code></pre>\n\n<p>Only elegant option I found was to use </p>\n\n<pre><code>negate . sum . tail &lt;$&gt; [[1..5], [3..6]]]\n</code></pre>\n\n<p>but I would like to be sure that I didn't skip some options above.\nThank you</p>\n"}, {"tags": ["haskell", "cryptography"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1521467402, "post_id": 49364594, "comment_id": 85729492, "body": "In your ghci, the spacing is different"}, {"owner": {"reputation": 489, "user_id": 4445913, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/943fb55bd9a761c56c17d124d1cc3c61?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Uligade", "link": "https://stackoverflow.com/users/4445913/mahesh-uligade"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1521467443, "post_id": 49364594, "comment_id": 85729521, "body": "spacing is different  means? are you talking about indentation?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1521468333, "post_id": 49364594, "comment_id": 85730179, "body": "Likely, <code>c0</code> is ambiguous: in your code there is nothing which allows GHC to choose a specific cipher, so that it can concretely generate the null IV. In GHCi, relaxed rules make <code>iv0</code> polymorphic, deferring the choice of <code>c</code>. Try writing your full code, so that <code>iv0</code> is actually used by some function, or assign it a specific cipher using a type annotation."}], "owner": {"reputation": 489, "user_id": 4445913, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/943fb55bd9a761c56c17d124d1cc3c61?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Uligade", "link": "https://stackoverflow.com/users/4445913/mahesh-uligade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1521467350, "creation_date": 1521467350, "question_id": 49364594, "link": "https://stackoverflow.com/questions/49364594/nulliv-in-crypto-cipher-types", "title": "nullIV in Crypto.Cipher.Types", "body": "<p>When I run this code using <code>runhaskell</code> command </p>\n\n<pre><code>import Crypto.Cipher.Types\n\nmain::IO()\nmain = do\n\n    let iv0 = nullIV\n\n    print \"\"\n</code></pre>\n\n<p>it throws an error </p>\n\n<pre><code>\u2022 No instance for (BlockCipher c0) arising from a use of \u2018nullIV\u2019\n\u2022 In the expression: nullIV\n  In an equation for \u2018iv0\u2019: iv0 = nullIV\n  In the expression:\n    do let iv0 = nullIV\n       print \"\"\n   |\n14 |     let iv0 = nullIV\n</code></pre>\n\n<p>but when I try in ghci it works</p>\n\n<pre><code>Prelude&gt; import Crypto.Cipher.Types\nPrelude Crypto.Cipher.Types&gt;     let iv0 = nullIV\nPrelude Crypto.Cipher.Types&gt; :t iv0\n       iv0 :: BlockCipher c =&gt; IV c\nPrelude Crypto.Cipher.Types&gt; \n</code></pre>\n\n<p>why it doen't work using <code>runhaskell</code> command</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1521463926, "post_id": 49363198, "comment_id": 85726983, "body": "Closely related: <a href=\"https://stackoverflow.com/q/19259114/2751851\"><i>Why are (constant) expressions not evaluated at compile time in Haskell?</i></a>; <a href=\"https://stackoverflow.com/q/9243794/2751851\"><i>Evaluating a function at compile time with Template Haskell</i></a>; <a href=\"https://stackoverflow.com/q/6122287/2751851\"><i>Force pre-computation of a constant</i></a>. For a simple example of why that doesn&#39;t happen automatically, consider <code>(+) &lt;$&gt; Just (length [1..]) &lt;*&gt; Just 2</code>."}, {"owner": {"reputation": 31724, "user_id": 6264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbb17eeeecd3d9d06f4db310ab630a12?s=128&d=identicon&r=PG", "display_name": "Michiel Borkent", "link": "https://stackoverflow.com/users/6264/michiel-borkent"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1521464301, "post_id": 49363198, "comment_id": 85727272, "body": "Thank you! Is this basically the halting problem as in the compiler cannot analyze if an expression will terminate during compile time?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1521464912, "post_id": 49363198, "comment_id": 85727742, "body": "Yup, that&#39;s the basic idea -- though terminating after a very long time would be bad as well. Also, as Daniel Wagner points out, GHC does what you describe in some very specific cases."}], "answers": [{"comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1521474052, "post_id": 49363685, "comment_id": 85734448, "body": "I just tried the same thing with <code>main = print ((++) &lt;$&gt; Just [1,2] &lt;*&gt; Just [3,4])</code>, and it did compile to basically <code>Just [1,2,3,4]</code>"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 8, "last_activity_date": 1521464594, "creation_date": 1521464594, "answer_id": 49363685, "question_id": 49363198, "link": "https://stackoverflow.com/questions/49363198/does-ghc-reduce-expressions-that-do-not-depend-on-io-at-compile-time/49363685#49363685", "title": "Does GHC reduce expressions that do not depend on IO at compile time?", "body": "<p>Let's ask GHC!</p>\n\n<pre><code>% echo 'main = print ((+) &lt;$&gt; Just 1 &lt;*&gt; Just 2)' &gt; test.hs\n% ghc -O2 -ddump-simpl test.hs\n[1 of 1] Compiling Main             ( test.hs, test.o )\n\n==================== Tidy Core ====================\nResult size of Tidy Core\n  = {terms: 42, types: 47, coercions: 9, joins: 0/0}\n\n-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}\nMain.main4 :: Integer\n[GblId,\n Caf=NoCafRefs,\n Unf=Unf{Src=&lt;vanilla&gt;, TopLvl=True, Value=True, ConLike=True,\n         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 100 0}]\nMain.main4 = 3\n\n-- RHS size: {terms: 9, types: 11, coercions: 0, joins: 0/0}\nMain.main3 :: [Char]\n[GblId,\n Unf=Unf{Src=&lt;vanilla&gt;, TopLvl=True, Value=False, ConLike=False,\n         WorkFree=False, Expandable=False, Guidance=IF_ARGS [] 60 30}]\nMain.main3\n  = case GHC.Show.$w$cshowsPrec4 11# Main.main4 (GHC.Types.[] @ Char)\n    of\n    { (# ww3_a23H, ww4_a23I #) -&gt;\n    GHC.Types.: @ Char ww3_a23H ww4_a23I\n    }\n\n-- RHS size: {terms: 3, types: 1, coercions: 0, joins: 0/0}\nMain.main2 :: [Char]\n[GblId,\n Unf=Unf{Src=&lt;vanilla&gt;, TopLvl=True, Value=False, ConLike=False,\n         WorkFree=False, Expandable=False, Guidance=IF_ARGS [] 30 0}]\nMain.main2 = ++ @ Char GHC.Show.$fShowMaybe1 Main.main3\n\n-- RHS size: {terms: 4, types: 0, coercions: 0, joins: 0/0}\nMain.main1\n  :: GHC.Prim.State# GHC.Prim.RealWorld\n     -&gt; (# GHC.Prim.State# GHC.Prim.RealWorld, () #)\n[GblId,\n Arity=1,\n Unf=Unf{Src=&lt;vanilla&gt;, TopLvl=True, Value=True, ConLike=True,\n         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 40 60}]\nMain.main1\n  = GHC.IO.Handle.Text.hPutStr2\n      GHC.IO.Handle.FD.stdout Main.main2 GHC.Types.True\n\n-- RHS size: {terms: 1, types: 0, coercions: 3, joins: 0/0}\nmain :: IO ()\n[GblId,\n Arity=1,\n Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,\n         WorkFree=True, Expandable=True,\n         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)\n         Tmpl= Main.main1\n               `cast` (Sym (GHC.Types.N:IO[0] &lt;()&gt;_R)\n                       :: ((GHC.Prim.State# GHC.Prim.RealWorld\n                            -&gt; (# GHC.Prim.State# GHC.Prim.RealWorld, () #)) :: *)\n                          ~R#\n                          (IO () :: *))}]\nmain\n  = Main.main1\n    `cast` (Sym (GHC.Types.N:IO[0] &lt;()&gt;_R)\n            :: ((GHC.Prim.State# GHC.Prim.RealWorld\n                 -&gt; (# GHC.Prim.State# GHC.Prim.RealWorld, () #)) :: *)\n               ~R#\n               (IO () :: *))\n\n-- RHS size: {terms: 2, types: 1, coercions: 3, joins: 0/0}\nMain.main5\n  :: GHC.Prim.State# GHC.Prim.RealWorld\n     -&gt; (# GHC.Prim.State# GHC.Prim.RealWorld, () #)\n[GblId,\n Arity=1,\n Unf=Unf{Src=&lt;vanilla&gt;, TopLvl=True, Value=True, ConLike=True,\n         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 20 60}]\nMain.main5\n  = GHC.TopHandler.runMainIO1\n      @ ()\n      (Main.main1\n       `cast` (Sym (GHC.Types.N:IO[0] &lt;()&gt;_R)\n               :: ((GHC.Prim.State# GHC.Prim.RealWorld\n                    -&gt; (# GHC.Prim.State# GHC.Prim.RealWorld, () #)) :: *)\n                  ~R#\n                  (IO () :: *)))\n\n-- RHS size: {terms: 1, types: 0, coercions: 3, joins: 0/0}\n:Main.main :: IO ()\n[GblId,\n Arity=1,\n Unf=Unf{Src=InlineStable, TopLvl=True, Value=True, ConLike=True,\n         WorkFree=True, Expandable=True,\n         Guidance=ALWAYS_IF(arity=0,unsat_ok=True,boring_ok=True)\n         Tmpl= Main.main5\n               `cast` (Sym (GHC.Types.N:IO[0] &lt;()&gt;_R)\n                       :: ((GHC.Prim.State# GHC.Prim.RealWorld\n                            -&gt; (# GHC.Prim.State# GHC.Prim.RealWorld, () #)) :: *)\n                          ~R#\n                          (IO () :: *))}]\n:Main.main\n  = Main.main5\n    `cast` (Sym (GHC.Types.N:IO[0] &lt;()&gt;_R)\n            :: ((GHC.Prim.State# GHC.Prim.RealWorld\n                 -&gt; (# GHC.Prim.State# GHC.Prim.RealWorld, () #)) :: *)\n               ~R#\n               (IO () :: *))\n\n-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}\nMain.$trModule4 :: GHC.Prim.Addr#\n[GblId,\n Caf=NoCafRefs,\n Unf=Unf{Src=&lt;vanilla&gt;, TopLvl=True, Value=True, ConLike=True,\n         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 20 0}]\nMain.$trModule4 = \"main\"#\n\n-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}\nMain.$trModule3 :: GHC.Types.TrName\n[GblId,\n Caf=NoCafRefs,\n Str=m1,\n Unf=Unf{Src=&lt;vanilla&gt;, TopLvl=True, Value=True, ConLike=True,\n         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 10 20}]\nMain.$trModule3 = GHC.Types.TrNameS Main.$trModule4\n\n-- RHS size: {terms: 1, types: 0, coercions: 0, joins: 0/0}\nMain.$trModule2 :: GHC.Prim.Addr#\n[GblId,\n Caf=NoCafRefs,\n Unf=Unf{Src=&lt;vanilla&gt;, TopLvl=True, Value=True, ConLike=True,\n         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 20 0}]\nMain.$trModule2 = \"Main\"#\n\n-- RHS size: {terms: 2, types: 0, coercions: 0, joins: 0/0}\nMain.$trModule1 :: GHC.Types.TrName\n[GblId,\n Caf=NoCafRefs,\n Str=m1,\n Unf=Unf{Src=&lt;vanilla&gt;, TopLvl=True, Value=True, ConLike=True,\n         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 10 20}]\nMain.$trModule1 = GHC.Types.TrNameS Main.$trModule2\n\n-- RHS size: {terms: 3, types: 0, coercions: 0, joins: 0/0}\nMain.$trModule :: GHC.Types.Module\n[GblId,\n Caf=NoCafRefs,\n Str=m,\n Unf=Unf{Src=&lt;vanilla&gt;, TopLvl=True, Value=True, ConLike=True,\n         WorkFree=True, Expandable=True, Guidance=IF_ARGS [] 10 30}]\nMain.$trModule = GHC.Types.Module Main.$trModule3 Main.$trModule1\n\n\n\nLinking test ...\n</code></pre>\n\n<p>As always, the core is a bit verbose. Let me show you a bit of eye-tracking as I tried to read it.</p>\n\n<pre><code>:Main.main\n  = Main.main5\n    `cast` ...\n\nMain.main5\n  = ...runMainIO1 ... (Main.main1 `cast` ...)\n\nMain.main1\n  = ...hPutStr2 ...stdout Main.main2 ...\n\nMain.main2 = ++ ...fShowMaybe1 Main.main3\n\nMain.main3\n  = case ...showsPrec4 11# Main.main4 ...\n    of\n    {- after a bit of squinting... -}\n    x -&gt; x\n\nMain.main4 = 3\n</code></pre>\n\n<p>To me, that <code>3</code> looks suspiciously like <code>1+2</code>. For paranoia, I tried replacing <code>1</code> and <code>2</code> with <code>10</code> and <code>20</code>, and indeed saw a similar structure with <code>30</code> at the bottom. So that looks like pretty convincing evidence that it does this computation at compile-time.</p>\n\n<p>That said, I expect this is probably pretty specific to numeric computations on simple numeric types. Compile-time computation of more exciting types has a strange and confusing time-space tradeoff, and the <em>usual</em> way to handle that situation is to give the programmer control of it as much as possible.</p>\n"}], "owner": {"reputation": 31724, "user_id": 6264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbb17eeeecd3d9d06f4db310ab630a12?s=128&d=identicon&r=PG", "display_name": "Michiel Borkent", "link": "https://stackoverflow.com/users/6264/michiel-borkent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 49363685, "answer_count": 1, "score": 2, "last_activity_date": 1521464594, "creation_date": 1521463121, "question_id": 49363198, "link": "https://stackoverflow.com/questions/49363198/does-ghc-reduce-expressions-that-do-not-depend-on-io-at-compile-time", "title": "Does GHC reduce expressions that do not depend on IO at compile time?", "body": "<p>If I have a program like</p>\n\n<p><code>main = print ( (+) &lt;$&gt; Just 1 &lt;*&gt; Just 2 )</code></p>\n\n<p>will the compiler decide to reduce the parts of my program that do not depend on <code>IO</code> like</p>\n\n<p><code>( (+) &lt;$&gt; Just 1 &lt;*&gt; Just 2 ) =&gt; (Just 3)</code>? </p>\n\n<p>Or does the program still create a new function from <code>(+) &lt;$&gt; Just 1</code> and then apply that to <code>Just 2</code> at run-time?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 1, "creation_date": 1521458906, "post_id": 49361285, "comment_id": 85723688, "body": "The data definition for side is invalid, are you sure that&#39;s what it looks like?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1521460956, "post_id": 49361285, "comment_id": 85724971, "body": "@MauriceWillis Please double-check that other .hs file. Preferably, just copy and paste rather than re-typing from memory."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1521468560, "post_id": 49361285, "comment_id": 85730323, "body": "You should use <code>shapeToPic (Rectangle side1 side2) = ...</code> using <code>size1</code>, <code>side2</code> as needed. Similarly for other cases."}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 1, "last_activity_date": 1521469959, "creation_date": 1521469959, "answer_id": 49365440, "question_id": 49361285, "link": "https://stackoverflow.com/questions/49361285/unsure-of-how-to-apply-arguments-to-a-constructor-haskell-codeworld-api/49365440#49365440", "title": "Unsure of how to apply arguments to a constructor [Haskell &amp; CodeWorld API]", "body": "<p>You can't match <em>just</em> the constructor; you need to match its arguments as well:</p>\n\n<pre><code>shapeToPic (Rectangle x y) = (translated (-3) 6  (solidRectangle 4 4))\n</code></pre>\n\n<p>If you don't care about the actual <code>x</code> and <code>y</code> values, you can replace them with <code>_</code>:</p>\n\n<pre><code>shapeToPic (Rectangle _ _) = (translated (-3) 6  (solidRectangle 4 4))\n</code></pre>\n\n<p>The two values are (likely) intended to be the length and width of the value, and you probably want to preserve them, assuming <code>solidRectangle</code> is a function that returns a new <code>Rectangle</code> value.</p>\n\n<pre><code>    shapeToPic (Rectangle x y) = (translated (-3) 6  (solidRectangle x y))\n</code></pre>\n\n<p>Or, you might just want to reuse the original value:</p>\n\n<pre><code>shapeToPic (Rectangle x y) = translated (-3) 6 (Rectangle x y)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>shapeToPic r@(Rectangle _ _) = translated (-3) 6 r\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 9516081, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "toothbrush21", "link": "https://stackoverflow.com/users/9516081/toothbrush21"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 598, "favorite_count": 0, "accepted_answer_id": 49365440, "answer_count": 1, "score": -2, "last_activity_date": 1521965190, "creation_date": 1521457041, "last_edit_date": 1521965190, "question_id": 49361285, "link": "https://stackoverflow.com/questions/49361285/unsure-of-how-to-apply-arguments-to-a-constructor-haskell-codeworld-api", "title": "Unsure of how to apply arguments to a constructor [Haskell &amp; CodeWorld API]", "body": "<p><strong>Preface:</strong> </p>\n\n<p>I have this function in Haskell within the CodeWorld API.</p>\n\n<pre><code>shapeToPic :: Shape -&gt; Picture\n</code></pre>\n\n<p>.hs file containing the data type definitions:</p>\n\n<pre><code>module Shape where\n\nimport CodeWorld (Point)\n\ndata Shape = Rectangle Side Side\n           | Ellipse   Side Side\n           | Polygon   [Point]\n           | Line      Point Point\n  deriving (Show)\n\ndata Tool = RectangleTool (Maybe Point)\n          | EllipseTool   (Maybe Point)\n          | LineTool      (Maybe Point)\n          | PolygonTool   [Point]\n  deriving (Show)\n\ntoolKeyMap :: [(String, Tool)]\ntoolKeyMap = [\n  (\"R\", RectangleTool Nothing),\n  (\"E\", EllipseTool Nothing),\n  (\"P\", PolygonTool []),\n  (\"L\", LineTool Nothing)\n  ]\n\ntype Side = Double\n</code></pre>\n\n<p><strong>Main:</strong></p>\n\n<p>I want to define each of those patterns (Rectangle, Ellipse etc.) which are required to define the data type \"Shape\".</p>\n\n<p>Now my current code consists of this</p>\n\n<pre><code>shapeToPic :: Shape -&gt; Picture\nshapeToPic Rectangle = (translated (-3) 6  (solidRectangle 4 4))\nshapeToPic Ellipse = colored red (translated 0 (-1.5) (solidCircle 8))\nshapeToPic Polygon = colored blue (translated 0 (-1.5) (solidPolygon [4,2]))\nshapeToPic Line = c\n</code></pre>\n\n<p>And I get an error saying that:</p>\n\n<pre><code>The constructor Rectangle' should have 2 arguments, but has been given none\n      In the pattern: Rectangle\n      In an equation for shapeToPic':\n          shapeToPic Rectangle = (translated (- 3) 6 (solidRectangle 4 4))\n</code></pre>\n\n<p>Now I am not sure how to give the constructor <strong>Rectangle</strong> two arguments and I'm not sure what is meant by \"Side Side\" in the Rectangle data type definition. By applying \"solidRectangle 4 4\" I would have thought it would fulfill the 2 sides requirement. Now I am confused.</p>\n\n<p>Would appreciate the help.</p>\n"}, {"tags": ["haskell", "purescript"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1521463288, "post_id": 49360890, "comment_id": 85726532, "body": "<code>fromMaybe empty (tail list)</code> (which might be spelled in Haskell as <code>maybe [] snd (uncons list)</code>) is equivalent to <code>drop 1 list</code>."}, {"owner": {"reputation": 191, "user_id": 1379553, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d66f898a8ff1ae83b02e582cebc580d8?s=128&d=identicon&r=PG", "display_name": "Anatol", "link": "https://stackoverflow.com/users/1379553/anatol"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1521471495, "post_id": 49360890, "comment_id": 85732493, "body": "Yes, obviously true, once one thinks about it. Also more readable, thanks!"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1521472543, "post_id": 49360890, "comment_id": 85733282, "body": "By the way, l suggest you move your solution to an answer."}], "answers": [{"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1521459545, "post_id": 49361017, "comment_id": 85724071, "body": "This can also be written point-free as <code>adjacent = zip &lt;*&gt; tail</code> using the <code>Applicative</code> instance for <code>(-&gt;)</code>\u2014<code>f &lt;*&gt; g</code> = <code>\\x -&gt; f x (g x)</code>."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 3, "creation_date": 1521462961, "post_id": 49361017, "comment_id": 85726309, "body": "<code>tail</code> crashes on empty lists. <code>a `zip` drop 1 a</code> is one way of avoiding that."}, {"owner": {"reputation": 3969, "user_id": 187261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/994de0373c6a35a5f7108b274d0b1cb9?s=128&d=identicon&r=PG", "display_name": "Nazarii Bardiuk", "link": "https://stackoverflow.com/users/187261/nazarii-bardiuk"}, "edited": false, "score": 1, "creation_date": 1521463395, "post_id": 49361017, "comment_id": 85726618, "body": "yes, and whole expression works because lazy haskell doesn&#39;t evaluate second argument of zip when first list is empty"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1521472893, "post_id": 49361017, "comment_id": 85733554, "body": "@NazariiBardiuk Indeed. (I sometimes fail to notice such things due to an inclination to pretend <code>head</code> and <code>tail</code> don&#39;t exist.)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1521479679, "post_id": 49361017, "comment_id": 85738335, "body": "@duplode, I wish <code>tail</code> were just shorthand for <code>drop 1</code>. Is there a reason for it not to be?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1521515579, "post_id": 49361017, "comment_id": 85752647, "body": "@dfeuer If <code>tail</code> were ever made safe, relegating the &quot;historical reasons&quot; to history, I guess it would become <code>[a] -&gt; Maybe [a]</code>, as in Purescript, for the sake of symmetry with <code>listToMaybe</code>. (<code>drop 1</code> would remain useful, though... I wonder if there is a nice, short name that we might give it.)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1521522034, "post_id": 49361017, "comment_id": 85754080, "body": "@duplode, there&#39;s also a long history of saturating subtraction, so I don&#39;t see an inherent problem with <code>tail [] = []</code>, which is almost backwards compatible. <code>head</code> is another story."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1521558868, "post_id": 49361017, "comment_id": 85777110, "body": "@dfeuer You have a point in that being almost backwards compatible makes the change more plausible. On another note, I now almost feel like suggesting <code>tailSat</code> as a name -- to my ears, it sounds less ad hoc than e.g. <i>safe</i>&#39;s <code>tailSafe</code>. I guess it wouldn&#39;t become a popular suggestion, though."}], "tags": [], "owner": {"reputation": 3969, "user_id": 187261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/994de0373c6a35a5f7108b274d0b1cb9?s=128&d=identicon&r=PG", "display_name": "Nazarii Bardiuk", "link": "https://stackoverflow.com/users/187261/nazarii-bardiuk"}, "is_accepted": true, "score": 7, "last_activity_date": 1521517254, "last_edit_date": 1521517254, "creation_date": 1521456285, "answer_id": 49361017, "question_id": 49360890, "link": "https://stackoverflow.com/questions/49360890/put-adjacent-elements-in-list-into-tuples/49361017#49361017", "title": "Put adjacent elements in List into Tuples", "body": "<p>In Haskell, without explicit recursion, you can zip a list with its tail.</p>\n\n<pre><code>   let a = [1,2,3,4,5,6,7,8,9,0]\n\n   a `zip` tail a\n\n   =&gt; [(1,2),(2,3),(3,4),(4,5),(5,6),(6,7),(7,8),(8,9),(9,0)]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 191, "user_id": 1379553, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d66f898a8ff1ae83b02e582cebc580d8?s=128&d=identicon&r=PG", "display_name": "Anatol", "link": "https://stackoverflow.com/users/1379553/anatol"}, "is_accepted": false, "score": 2, "last_activity_date": 1521478634, "creation_date": 1521478634, "answer_id": 49368436, "question_id": 49360890, "link": "https://stackoverflow.com/questions/49360890/put-adjacent-elements-in-list-into-tuples/49368436#49368436", "title": "Put adjacent elements in List into Tuples", "body": "<p>Purescript solution for completeness sake:</p>\n\n<pre><code>adjacent :: forall n. List n -&gt; List (Tuple n n)\nadjacent list = zip list $ fromMaybe empty $ tail list\n</code></pre>\n\n<p>can be expressed more elegantly as:</p>\n\n<pre><code>adjacent :: forall n. List n -&gt; List (Tuple n n)\nadjacent list = zip list $ drop 1 list\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 0, "last_activity_date": 1521517644, "creation_date": 1521517644, "answer_id": 49376040, "question_id": 49360890, "link": "https://stackoverflow.com/questions/49360890/put-adjacent-elements-in-list-into-tuples/49376040#49376040", "title": "Put adjacent elements in List into Tuples", "body": "<p>For the sake of illustration (the <code>zip</code>-based solutions are definitely nicer), here is your explicitly recursive Haskell solution written as an unfold. I have golfed it into an one-liner for no particular reason.</p>\n\n<pre><code>{-# LANGUAGE LambdaCase #-}\n\nimport Data.List (unfoldr)\n\nadjacent :: [a] -&gt; [(a, a)]\nadjacent = unfoldr (\\case { x:y:ys -&gt; Just ((x, y), ys); _ -&gt; Nothing })\n</code></pre>\n\n<p>(Note that the pattern matches here handle lists with an odd number of elements without crashing.)</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 0, "last_activity_date": 1521527529, "creation_date": 1521527529, "answer_id": 49377650, "question_id": 49360890, "link": "https://stackoverflow.com/questions/49360890/put-adjacent-elements-in-list-into-tuples/49377650#49377650", "title": "Put adjacent elements in List into Tuples", "body": "<p>Since we've seen <code>zip</code> and <code>unfoldr</code>, we should have one using <code>foldr</code>:</p>\n\n<pre><code>adjacent :: [a] -&gt; [(a,a)]\nadjacent xs = foldr go (const []) xs Nothing\n  where\n    go a r Nothing = r (Just a)\n    go a r (Just prev) = (prev, a) : r (Just a)\n</code></pre>\n\n<p>And now, because every toy problem deserves an over-engineered solution, here's what you could use to get double-sided list fusion:</p>\n\n<pre><code>import GHC.Exts (build)\n\nadjacent :: [a] -&gt; [(a,a)]\nadjacent xs = build $ \\c nil -&gt;\n  let\n    go a r Nothing = r (Just a)\n    go a r (Just prev) = (prev, a) `c` r (Just a)\n  in foldr go (const nil) xs Nothing\n{-# INLINE adjacent #-}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6460, "user_id": 1178265, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Sgir6.jpg?s=128&g=1", "display_name": "Gabriel Riba", "link": "https://stackoverflow.com/users/1178265/gabriel-riba"}, "is_accepted": false, "score": 0, "last_activity_date": 1523877010, "last_edit_date": 1523877010, "creation_date": 1523876683, "answer_id": 49855765, "question_id": 49360890, "link": "https://stackoverflow.com/questions/49360890/put-adjacent-elements-in-list-into-tuples/49855765#49855765", "title": "Put adjacent elements in List into Tuples", "body": "<p>folding with state, where the state is the last paired item:</p>\n\n<p>in Haskell:</p>\n\n<pre><code>import Data.List (mapAccumL)\n\nadjacents :: [a] -&gt; [(a, a)]\nadjacents [] = []\nadjacents (x:xs) = snd $ mapAccumL op x xs\n    where\n        op x y = (y, (x,y))\n</code></pre>\n"}], "owner": {"reputation": 191, "user_id": 1379553, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d66f898a8ff1ae83b02e582cebc580d8?s=128&d=identicon&r=PG", "display_name": "Anatol", "link": "https://stackoverflow.com/users/1379553/anatol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 374, "favorite_count": 1, "accepted_answer_id": 49361017, "answer_count": 5, "score": 0, "last_activity_date": 1523877010, "creation_date": 1521455917, "last_edit_date": 1521478606, "question_id": 49360890, "link": "https://stackoverflow.com/questions/49360890/put-adjacent-elements-in-list-into-tuples", "title": "Put adjacent elements in List into Tuples", "body": "<p>Given a List of elements:</p>\n\n<pre><code>xs = [a, b, c, d, ... z]\n</code></pre>\n\n<p>where <code>a, b, c</code> etc are placeholders for arbitrary values.\nI want to implement a function <code>adjacents :: [a] -&gt; [(a, a)]</code> that produces</p>\n\n<pre><code>adjacentValues = [(a, b), (b, c), (c, d), ... (y, z)]\n</code></pre>\n\n<hr>\n\n<p>In Haskell, a recursive definition is reasonably concise:</p>\n\n<pre><code>adjacents :: [a] -&gt; [(a, a)]\nadjacents (x:xs) = (x, head xs) : adjacents xs\nadjacents [] = []\n</code></pre>\n\n<p>Purescript is a little more verbose:</p>\n\n<pre><code>adjacents :: forall a. List a -&gt; List (Tuple a a)\nadjacents list = case uncons list of \n    Nothing -&gt; []\n    Just {head: x, tail: xs} -&gt; case head xs of\n                                     Just next -&gt; Tuple x next : adjacents xs\n                                     Nothing -&gt; []\n</code></pre>\n\n<p>Is there a way to express <code>adjacents</code> without explicit recursion (using a fold)?</p>\n\n<hr>\n\n<p>Disclaimer: This question has both Purescript and Haskell tags because I want to open it to a broader audience. I reckon an answer not to depend on haskells lazy-evaluation semantics, and therefore to be valid in both languages. </p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": true, "score": 6, "last_activity_date": 1521454193, "last_edit_date": 1521454193, "creation_date": 1521453777, "answer_id": 49360192, "question_id": 49360071, "link": "https://stackoverflow.com/questions/49360071/haskell-list-comprehension-via-list-monad-understanding/49360192#49360192", "title": "haskell list comprehension via list monad understanding", "body": "<p>This is a common source of confusion. The scope of the lambdas extends <em>as far as possible</em>, so this:</p>\n\n<pre><code>[1,2,3] &gt;&gt;= \\x -&gt;\n[4,5,6] &gt;&gt;= \\y -&gt;\nreturn (x,y)\n</code></pre>\n\n<p>Is equivalent to this:</p>\n\n<pre><code>[1,2,3] &gt;&gt;= (\\x -&gt;\n  [4,5,6] &gt;&gt;= (\\y -&gt;\n    return (x,y)))\n</code></pre>\n\n<p>So the inner lambda <code>\\y -&gt; \u2026</code> is inside the scope of the outer lambda, <code>\\x -&gt; \u2026</code>, meaning <code>x</code> and <code>y</code> are both in scope. You can then inline the definitions of <code>&gt;&gt;=</code> and <code>return</code> for the <code>[]</code> monad instance and step through the evaluation:</p>\n\n<pre><code>concatMap (\\x -&gt;\n  concatMap (\\y -&gt;\n    [(x,y)]) [4,5,6]) [1,2,3]\n\nconcat\n  [ concatMap (\\y -&gt; [(1,y)]) [4,5,6]\n  , concatMap (\\y -&gt; [(2,y)]) [4,5,6]\n  , concatMap (\\y -&gt; [(3,y)]) [4,5,6]\n  ]\n\nconcat\n  [ concat [[(1,4)], [(1,5)], [(1,6)]]\n  , concat [[(2,4)], [(2,5)], [(2,6)]]\n  , concat [[(3,4)], [(3,5)], [(3,6)]]\n  ]\n\nconcat\n  [ [(1,4), (1,5), (1,6)]\n  , [(2,4), (2,5), (2,6)]\n  , [(3,4), (3,5), (3,6)]\n  ]\n\n[ (1,4), (1,5), (1,6)\n, (2,4), (2,5), (2,6)\n, (3,4), (3,5), (3,6)\n]\n</code></pre>\n\n<p>A common and more succinct way of expressing this is with the <code>Applicative</code> instance instead of the <code>Monad</code> instance, using the <code>&lt;$&gt;</code> (<code>fmap</code>) and <code>&lt;*&gt;</code> (<code>ap</code>) operators or <code>liftA2</code>:</p>\n\n<pre><code>(,) &lt;$&gt; [1,2,3] &lt;*&gt; [4,5,6]\n\nliftA2 (,) [1,2,3] [4,5,6]\n</code></pre>\n"}], "owner": {"reputation": 2526, "user_id": 304423, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/91eabf76806c620ce010941423bd1d13?s=128&d=identicon&r=PG", "display_name": "Evg", "link": "https://stackoverflow.com/users/304423/evg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 1, "accepted_answer_id": 49360192, "answer_count": 1, "score": 2, "last_activity_date": 1521454193, "creation_date": 1521453421, "question_id": 49360071, "link": "https://stackoverflow.com/questions/49360071/haskell-list-comprehension-via-list-monad-understanding", "title": "haskell list comprehension via list monad understanding", "body": "<p>I am from python world, but try to use functional as much as possible, and change my imperative thinking.</p>\n\n<p>Now i study haskell and found that </p>\n\n<pre><code>list = [(x,y) | x&lt;-[1,2,3], y&lt;-[4,5,6]]\n</code></pre>\n\n<p>are translated to </p>\n\n<pre><code>list' = \n    [1,2,3] &gt;&gt;= \\x -&gt;\n    [4,5,6] &gt;&gt;= \\y -&gt;\n    return (x,y)\n</code></pre>\n\n<p>I try to understand step by step processing of list monad binds chain:</p>\n\n<p>bind defind as: </p>\n\n<pre><code>xs &gt;&gt;= f = concat (map f xs)\n</code></pre>\n\n<p>and bind is left associative</p>\n\n<p>So as I understend, at start first bind ([1,2,3] >>= \\x -> [4,5,6]) executed with result [4,5,6,4,5,6,4,5,6] </p>\n\n<p>And then next bind \n[4,5,6,4,5,6,4,5,6] >>= \\y -> return (x,y) executed</p>\n\n<p>But how it can see x inside lambda if it's allready calculated ?? x is just argument that has no concrete value at all (lambda can be call with varios arguments at any time, how can we se it outside and fixed??). If it somehow can see it how can it know about that x call history was changed with 1,2,3 ? in my understanding onces first bind calculation done, only result [4,5,6,4,5,6,4,5,6] avaible and it goes next, to first argument of next bind.</p>\n\n<p>So I can't understand how can i read this construction, and how it step by step logicaly produce correct result?</p>\n"}, {"tags": ["haskell", "tuples", "list-comprehension"], "comments": [{"owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "edited": false, "score": 1, "creation_date": 1521449860, "post_id": 49357856, "comment_id": 85717948, "body": "Are you sure you want this to be tail-recursive? Why? Also, the code you&#39;ve tried is not tail-recursive."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1521451831, "post_id": 49357856, "comment_id": 85719226, "body": "<code>&#47;&#47; Comment</code> isn&#39;t a Haskell comment. Use <code>-- Comment</code>."}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1521452711, "post_id": 49357856, "comment_id": 85719785, "body": "I am trying to  solve the problem using guards and tail-recursion.Is there any way  i can generate the empty tuple and the empty lists and populate them using recursion"}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 1, "creation_date": 1521467683, "post_id": 49357856, "comment_id": 85729713, "body": "<code>even</code> and <code>odd</code> are functions in the Prelude. <code>even 4</code> will return <code>True</code>."}], "answers": [{"comments": [{"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1521452856, "post_id": 49359874, "comment_id": 85719868, "body": "Ok so in order to do this i must provide the initial value of the tuple  ([],[]).I thought that i could somehow first create the lists and them pack them up at the end in a tuple.Something like -&gt; Iterate over initial list , take 1 element at a time insert in one of the two local list variables and then put them in a tuple."}, {"owner": {"reputation": 406, "user_id": 1738086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44ffd4d27d01bce9b3425f88d83975a3?s=128&d=identicon&r=PG", "display_name": "Simon Courtenage", "link": "https://stackoverflow.com/users/1738086/simon-courtenage"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1521454790, "post_id": 49359874, "comment_id": 85721157, "body": "@BercoviciAdrian yes you need the initial value of the accumulator.  As you proceed through each tail recursive call, you accumulate by adding a new value to the accumulator.  In cases like this, where the initial value is what is called the &#39;unit&#39; value (i.e., it acts as the identity for a particular operation) and where that operation is monoidal (binary and associative), you can replace the initial value with <code>mempty</code>.  So the call to <code>go xs ([],[])</code> in the code above can be replace by <code>go xs mempty</code>.  It&#39;s really worth reading about and undertanding monoids in Haskell, btw."}, {"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1521455307, "post_id": 49359874, "comment_id": 85721483, "body": "Could you refer a source for further reading?Until now i was dabbling in Haskell using my intuition but i know there is concrete set-theory math in how the things work,and for greater understanding."}, {"owner": {"reputation": 406, "user_id": 1738086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44ffd4d27d01bce9b3425f88d83975a3?s=128&d=identicon&r=PG", "display_name": "Simon Courtenage", "link": "https://stackoverflow.com/users/1738086/simon-courtenage"}, "reply_to_user": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 1, "creation_date": 1521475409, "post_id": 49359874, "comment_id": 85735448, "body": "@BercoviciAdrian there are a lot of good online resources.  <a href=\"http://learnyouahaskell.com\" rel=\"nofollow noreferrer\">LYAH</a> (Learn You A Haskell) is a great resource.  There is also <a href=\"http://book.realworldhaskell.org/read/\" rel=\"nofollow noreferrer\">Real World Haskell</a>, which has the benefit of embedded comments from readers, but is a little old now and some of the code in later chapters is a little out of date (in which case, reading the comments help because suggestions for updated code are posted).  If you want to spend money, then <a href=\"http://haskellbook.com\" rel=\"nofollow noreferrer\">Programming Haskell from First Principles</a> is my absolute favourite."}], "tags": [], "owner": {"reputation": 406, "user_id": 1738086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/44ffd4d27d01bce9b3425f88d83975a3?s=128&d=identicon&r=PG", "display_name": "Simon Courtenage", "link": "https://stackoverflow.com/users/1738086/simon-courtenage"}, "is_accepted": false, "score": 3, "last_activity_date": 1521452701, "creation_date": 1521452701, "answer_id": 49359874, "question_id": 49357856, "link": "https://stackoverflow.com/questions/49357856/how-to-use-a-tail-recursion-with-guards-for-splitting-a-list-into-two-ones/49359874#49359874", "title": "How to use a tail-recursion with guards for splitting a list into two ones?", "body": "<p>Tail recursive functions are ones in which the final result of a function is a call back to the same function.  In Haskell, this means that the right-hand side of an equation must be a call to the function.  So, for example,\n   f (x:xs) n = f xs (n+1)\nis tail recursive, while\n   f' (x:xs) = 1 + f' xs\nis not - because while there is a recursive call, it is not the result of the function.  Instead, the evaluation of (+) is the result.</p>\n\n<p>In the case of your code, this means you need something like this:</p>\n\n<pre><code>sumt_tr :: [Int] -&gt; ([Int],[Int])\nsumt_tr xs = go xs ([],[])\n    where\n    go [] (os,es) = (reverse os,reverse es)\n    go (x:xs) (os,es) | x `mod` 2 == 0 = go xs (os,x:es)\n                      | otherwise      = go xs (x:os,es)\n</code></pre>\n\n<p>Here, the function <code>go</code> (local to sumt_tr) is tail recursive, because each equation for <code>go</code> directly calls <code>go</code> again.  Notice that, in order to write <code>go</code> as tail recursive, I needed to accumulate the result by passing it as a second argument, to be returned when the end of the list is reached.</p>\n"}, {"comments": [{"owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "edited": false, "score": 0, "creation_date": 1521453408, "post_id": 49359878, "comment_id": 85720240, "body": "Thank you for your answer sir !"}], "tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": true, "score": 5, "last_activity_date": 1521453466, "last_edit_date": 1521453466, "creation_date": 1521452714, "answer_id": 49359878, "question_id": 49357856, "link": "https://stackoverflow.com/questions/49357856/how-to-use-a-tail-recursion-with-guards-for-splitting-a-list-into-two-ones/49359878#49359878", "title": "How to use a tail-recursion with guards for splitting a list into two ones?", "body": "<p>The most straightforward way to do it with explicit recursion is to use a tail-recursive helper function with two accumulators for the result lists:</p>\n\n<pre><code>sumt :: [Int] -&gt; ([Int], [Int])\nsumt = go [] []\n  where\n\n    -- Each recursive call is directly to \u2018go\u2019,\n    -- so it\u2019s tail-recursive.\n    go os es (x:xs)\n      | x `mod` 2 == 0 = go os (x:es) xs\n      | otherwise = go (x:os) es xs\n\n    -- In the base case, it returns a tuple with\n    -- the accumulated results in the proper order.\n    go os es [] = (reverse os, reverse es)\n</code></pre>\n\n<p>A much simpler way to do this is with the <code>partition</code> function from <code>Data.List</code>:</p>\n\n<pre><code>sumt :: (Integral a) =&gt; [a] -&gt; ([a], [a])\nsumt = partition odd\n</code></pre>\n\n<p>If you look at the definition of <code>partition</code>, it\u2019s not implemented with explicit recursion, but with <code>foldr</code>. Here it is with <code>odd</code> inlined:</p>\n\n<pre><code>sumt = foldr select ([], [])\n  where\n    select x ~(os, es)\n      | odd x = (x:os, es)\n      | otherwise = (os, x:es)\n</code></pre>\n\n<p>This has the advantage of being <em>streaming</em>: it doesn\u2019t include the O(n) step of reversing the accumulated lists at the end, it just builds the results incrementally.</p>\n"}], "owner": {"reputation": 6267, "user_id": 1913744, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5bAQS.jpg?s=128&g=1", "display_name": "Bercovici Adrian", "link": "https://stackoverflow.com/users/1913744/bercovici-adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 328, "favorite_count": 0, "accepted_answer_id": 49359878, "answer_count": 2, "score": 2, "last_activity_date": 1582375444, "creation_date": 1521445065, "last_edit_date": 1582375444, "question_id": 49357856, "link": "https://stackoverflow.com/questions/49357856/how-to-use-a-tail-recursion-with-guards-for-splitting-a-list-into-two-ones", "title": "How to use a tail-recursion with guards for splitting a list into two ones?", "body": "<p>If I have a list lets say <code>[1,2,3,4]</code>, how can I create a tuple of two lists so that the first list contains the odd elements and the second one - the even elements. How can I do this with a tail-recursion?</p>\n\n<p><em>For example:</em> </p>\n\n<pre><code>    Input  : [1,2,3,4]\n    Output : ([1,3],[2,4]) with tail recursion and not ranges. [|x&lt;-...]\n</code></pre>\n\n<p>So far I have tried something like:</p>\n\n<pre><code>sumt::[Int]-&gt;([Int],[Int])\nsumt []=([],[])\nsumt (x:xs)\n    | x `mod` 2==0 = x: (fst $ tupl xs)\n    | otherwise    = x: (snd $ tupl xs) where \n    tupl []=([],[])\n    tupl (y:ys)=y:(tupl ys)   //how can I put the condition here ? I need it \n                            //to be aware of both guard cases at each iteration\n</code></pre>\n\n<p>I basically need two local lists that are formed by each guard case and at the end they are placed in a tuple.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2424, "user_id": 3206471, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/fdc1f4bd9f3118fff33a160e9efdb61e?s=128&d=identicon&r=PG", "display_name": "gigabytes", "link": "https://stackoverflow.com/users/3206471/gigabytes"}, "edited": false, "score": 0, "creation_date": 1521443243, "post_id": 49357344, "comment_id": 85714816, "body": "[123. 346, 789] is not a list of strings. Do you mean [\u201c123\u201d, \u201c346\u201d, \u201c789\u201d]? Or do you want to split the numbers into figures?"}, {"owner": {"reputation": 11, "user_id": 9514801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ada0f49062accebb33ff96e4c1d2abf?s=128&d=identicon&r=PG&f=1", "display_name": "Larry Jones", "link": "https://stackoverflow.com/users/9514801/larry-jones"}, "reply_to_user": {"reputation": 2424, "user_id": 3206471, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/fdc1f4bd9f3118fff33a160e9efdb61e?s=128&d=identicon&r=PG", "display_name": "gigabytes", "link": "https://stackoverflow.com/users/3206471/gigabytes"}, "edited": false, "score": 0, "creation_date": 1521443383, "post_id": 49357344, "comment_id": 85714868, "body": "yes that&#39;s what I mean sorry"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1521443470, "post_id": 49357344, "comment_id": 85714910, "body": "What do you want the function to return if I pass in <code>[&quot;1xt3&quot;]</code>?"}, {"owner": {"reputation": 11, "user_id": 9514801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ada0f49062accebb33ff96e4c1d2abf?s=128&d=identicon&r=PG&f=1", "display_name": "Larry Jones", "link": "https://stackoverflow.com/users/9514801/larry-jones"}, "edited": false, "score": 0, "creation_date": 1521443570, "post_id": 49357344, "comment_id": 85714944, "body": "I just want to assume that all strings will be valid ints once converted"}, {"owner": {"reputation": 2424, "user_id": 3206471, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/fdc1f4bd9f3118fff33a160e9efdb61e?s=128&d=identicon&r=PG", "display_name": "gigabytes", "link": "https://stackoverflow.com/users/3206471/gigabytes"}, "edited": false, "score": 2, "creation_date": 1521443712, "post_id": 49357344, "comment_id": 85714998, "body": "Since this sounds like homework, I\u2019ll give you only an hint which applies if this is not the case. Since strings can also contain things that are not numbers, any function of type [String] -&gt; [[Int]] has to be partial, so I would suggest you to implement instead a function of type [String] -&gt; Maybe [[Int]] or [String] -&gt; [Maybe [Int]] or [String] -&gt; [[Maybe Int]], depending on what\u2019s the intended usage."}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1521464613, "post_id": 49357344, "comment_id": 85727498, "body": "<code>map (map digitToInt)</code> using <code>Data.Char</code>"}, {"owner": {"reputation": 824, "user_id": 6914498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/025023af1858a74ebe1cb8c9b21f47ab?s=128&d=identicon&r=PG", "display_name": "wisn", "link": "https://stackoverflow.com/users/6914498/wisn"}, "edited": false, "score": 0, "creation_date": 1521469684, "post_id": 49357344, "comment_id": 85731093, "body": "Show us your attempt so we could help you."}, {"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 0, "creation_date": 1551131954, "post_id": 49357344, "comment_id": 96520698, "body": "<code>[ [ (fromEnum d) - 48 | d &lt;- e] | e &lt;- [&quot;123&quot;,&quot;346&quot;,&quot;789&quot;]]</code>"}], "answers": [{"comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1521474306, "post_id": 49366988, "comment_id": 85734647, "body": "Note that <code>digitToInt</code> isn&#39;t a great function here because it is not <i>total</i>, as alluded to in the comments on your question, and also when I wrote &quot;There&#39;s a reasonably small number of defined inputs for that operation.&quot; Any time the domain for a type is larger than the number of inputs you can define your function for, you&#39;re probably not writing the most idiomatic Haskell code. In this case, it would be better if you wrote <code>digitToMaybeInt :: Char -&gt; Maybe Int</code> and made <code>result :: [[Maybe Int]]</code> (or even <code>[Maybe [Int]]</code> or <code>Maybe [[Int]]</code> depending on your strictness.)"}], "tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": false, "score": 1, "last_activity_date": 1521474174, "creation_date": 1521474174, "answer_id": 49366988, "question_id": 49357344, "link": "https://stackoverflow.com/questions/49357344/haskell-string-list-to-int-list/49366988#49366988", "title": "Haskell String list to Int list", "body": "<p>One of the pillars of functional programming is <code>map</code>, which has the following signature:</p>\n\n<pre><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]\n</code></pre>\n\n<p>In other words, it takes a function that expects a value of type <code>a</code> and returns a value of type <code>b</code> (N.B. these could be the same type, but don't have to be) along with a list of <code>a</code> values, and kicks you back a list of <code>b</code> values. Take this example:</p>\n\n<pre><code>double :: Int -&gt; Int\ndouble = (*2)\n{- equivalently written as:\n   double x = x * 2 -}\n\nas = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\nbs = map double as\n</code></pre>\n\n<p>In this example, map is specialized where <code>a ~ Int</code> and <code>b ~ Int</code>, resolving to</p>\n\n<pre><code>map :: (Int -&gt; Int) -&gt; [Int] -&gt; [Int]\n</code></pre>\n\n<p>and <code>bs</code> is then <code>[2, 4, 6, 8, 10, 12, 14, 16, 18, 20]</code>.</p>\n\n<hr>\n\n<p>Why this long primer on <code>map</code>? Because it's the framework to so many answers in functional programming, including your question. Remember that <code>String</code> is just a type synonym for <code>[Char]</code>, so you're trying to go from <code>[[Char]] -&gt; [[Int]]</code>. Gee, that sure looks like the last two terms of the type signature for map, doesn't it? Let's specialize <code>map</code> to operate in these terms.</p>\n\n<pre><code>map :: ([Char] -&gt; [Int]) -&gt; [[Char]] -&gt; [[Int]]\n</code></pre>\n\n<p>But wait, the function that <code>map</code> is expecting <em>also</em> looks like the result of a mapping. Let's write that, too.</p>\n\n<pre><code>map :: (Char -&gt; Int) -&gt; [Char] -&gt; [Int]\n</code></pre>\n\n<p>So what we want is a <em>double</em> map, applied to some function <code>f</code> such that:</p>\n\n<pre><code>map (map f) :: [[Char]] -&gt; [[Int]]\n{- more idiomatically written as\n   (map . map) f :: [[Char]] -&gt; [[Int]] -}\n</code></pre>\n\n<p>This means we need an <code>f :: Char -&gt; Int</code> -- some function that goes from single characters to integers. There's a reasonably small number of defined inputs for that operation, so I'd just write it.</p>\n\n<pre><code>digitToInt :: Char -&gt; Int\ndigitToInt '0' = 0\ndigitToInt '1' = 1\ndigitToInt '2' = 2\ndigitToInt '3' = 3\ndigitToInt '4' = 4\ndigitToInt '5' = 5\ndigitToInt '6' = 6\ndigitToInt '7' = 7\ndigitToInt '8' = 8\ndigitToInt '9' = 9\ndigitToInt 'a' = 10\ndigitToInt 'A' = 10\ndigitToInt 'b' = 11\ndigitToInt 'B' = 11\ndigitToInt 'c' = 12\ndigitToInt 'C' = 12\ndigitToInt 'd' = 13\ndigitToInt 'D' = 13\ndigitToInt 'e' = 14\ndigitToInt 'E' = 14\ndigitToInt 'f' = 15\ndigitToInt 'F' = 15\ndigitToInt _   = error \"Invalid digit\"\n</code></pre>\n\n<p>but N.B. that this function comes standard in <code>Data.Char</code></p>\n\n<pre><code>import Data.Char (digitToInt)\n</code></pre>\n\n<p>Your result then is:</p>\n\n<pre><code>result = (map.map) digitToInt [\"123\",\"346\",\"789\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "is_accepted": false, "score": 1, "last_activity_date": 1521509296, "creation_date": 1521509296, "answer_id": 49374997, "question_id": 49357344, "link": "https://stackoverflow.com/questions/49357344/haskell-string-list-to-int-list/49374997#49374997", "title": "Haskell String list to Int list", "body": "<pre><code>import Data.List (intersperse)\n\nf :: String :: [Int]\nf stringnum = read $ \"[\" ++ intersperse  ',' stringnum ++ \"]\" :: [Int]\n\n&gt;&gt;&gt; map f [\"123\", \"456\"]\n[[1,2,3],[4,5,6]]\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 9514801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ada0f49062accebb33ff96e4c1d2abf?s=128&d=identicon&r=PG&f=1", "display_name": "Larry Jones", "link": "https://stackoverflow.com/users/9514801/larry-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1274, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1521509296, "creation_date": 1521442729, "last_edit_date": 1521443358, "question_id": 49357344, "link": "https://stackoverflow.com/questions/49357344/haskell-string-list-to-int-list", "title": "Haskell String list to Int list", "body": "<p>I have a list of strings and I want to read the strings one by one and convert it into a list of ints, is there a way to convert each character into a new list?  </p>\n\n<pre><code>[\"123\",\"346\",\"789\"] to [[1,2,3],[4,5,6],[7,8,9]]\n\nstringToInt :: [String] -&gt; [[Int]]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "edited": false, "score": 0, "creation_date": 1521539993, "post_id": 49356123, "comment_id": 85762943, "body": "It should be noted that not any <code>ST</code> extractor can be matched by signature <code>(forall s . ST s a) -&gt; b</code>. For example <a href=\"https://www.stackage.org/haddock/lts-10.4/array-0.5.2.0/Data-Array-ST.html#v:runSTUArray\" rel=\"nofollow noreferrer\"><code>runSTUArray :: (forall s. ST s (STUArray s i e)) -&gt; UArray i e</code></a> does not match it, because <code>a</code> is a complex type which has <code>s</code> in its parameters. Applying the requested <code>addC</code> to it would not typecheck with error &quot;type variable \u2018s\u2019 would escape its scope&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "edited": false, "score": 0, "creation_date": 1521439377, "post_id": 49356530, "comment_id": 85713287, "body": "it was ispired by <a href=\"https://stackoverflow.com/q/49350572/2303202\">stackoverflow.com/q/49350572/2303202</a> Thanks. It&#39;s unexpected appoach, I need to think more about it."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 3, "last_activity_date": 1521440937, "last_edit_date": 1521440937, "creation_date": 1521438372, "answer_id": 49356530, "question_id": 49356123, "link": "https://stackoverflow.com/questions/49356123/safely-generalize-st-return-value/49356530#49356530", "title": "Safely generalize ST return value", "body": "<p>I'm not really sure I understand what you're trying to accomplish, but this has the right type:</p>\n\n<pre><code>addC :: ((forall s . ST s a) -&gt; b)\n     -&gt; (forall s1 . ST s1 (a,c)) -&gt; (b,c)\naddC f m = runST $ (\\(a,c) -&gt; (f (pure a), c)) &lt;$&gt; m\n</code></pre>\n\n<p>Note that <code>(forall s. ST s a)</code> is isomorphic to <code>a</code> (as witnessed by <code>pure</code> and <code>runST</code>), so maybe you should just take a function <code>a -&gt; b</code> and a value <code>(a, c)</code>.</p>\n"}], "owner": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 49356530, "answer_count": 1, "score": 0, "last_activity_date": 1521440937, "creation_date": 1521436021, "question_id": 49356123, "link": "https://stackoverflow.com/questions/49356123/safely-generalize-st-return-value", "title": "Safely generalize ST return value", "body": "<p>I have an ST extractor <code>foo :: (forall s . ST s a) -&gt; b</code> for some concrete <code>a</code> and <code>b</code>. Could I safely make another function <code>fooC :: (forall s . ST s (a, c)) -&gt; (b, c)</code>, which would allow me to return some additional value out of the ST computation? Can there be a generic transformation <code>addC :: ((forall s . ST s a) -&gt; b) -&gt; (forall s1 . ST s1 (a,c)) -&gt; (b,c)</code> which would be safe to use?</p>\n"}, {"tags": ["list", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1522085039, "post_id": 49353736, "comment_id": 85998271, "body": "@WillNess Thanks for finding that, I&#39;ve marked this question as a duplicate."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1522085401, "post_id": 49353736, "comment_id": 85998461, "body": "@WillNess Nothing embarrassing there, that&#39;s how 95% of my dupehammers happen too. And yes, I expect the <code>foldr (zipWith (:))</code> version is preferable."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 6, "last_activity_date": 1521414611, "last_edit_date": 1521414611, "creation_date": 1521414357, "answer_id": 49353736, "question_id": 49353643, "link": "https://stackoverflow.com/questions/49353643/group-adjacent-values-in-a-list-in-haskell/49353736#49353736", "title": "Group adjacent values in a list in Haskell", "body": "<pre><code>Data.List&gt; f n xs = zipWith const (take n &lt;$&gt; tails xs) (drop (n-1) xs)\nData.List&gt; f 3 [1..7]\n[[1,2,3],[2,3,4],[3,4,5],[4,5,6],[5,6,7]]\n</code></pre>\n\n<p>Some brief explanations: <code>tails</code> gives us the lists that start at each position in the original. We only want the first few elements of each of these, so we run <code>take n</code> on each. This gets us most of the way there, but leaves a few extra dangling lists at the end; in your example they would be the ones starting from <code>6</code>, <code>7</code>, and beyond, so <code>[[6,7],[7],[]]</code>. We could do this by computing the length of the input list and taking only that many final lists, but this doesn't work well for infinite input lists or partially defined input lists. Instead, since the output should always be <code>n</code> elements shorter than the input, we use a standard-ish <code>zipWith</code> trick to cut off the extra elements.</p>\n"}, {"comments": [{"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 1, "creation_date": 1521420444, "post_id": 49354264, "comment_id": 85708995, "body": "In addition to being slower, this will outright fail to terminate on infinite lists, while the other answer will produce a correct infinite list result."}, {"owner": {"reputation": 3502, "user_id": 2558108, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DUiG3.jpg?s=128&g=1", "display_name": "Qwertie", "link": "https://stackoverflow.com/users/2558108/qwertie"}, "edited": false, "score": 0, "creation_date": 1521420919, "post_id": 49354264, "comment_id": 85709086, "body": "Even if it isn&#39;t as useful as the other example it&#39;s still nice to see other solutions for learning purposes."}, {"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 0, "creation_date": 1522272492, "post_id": 49354264, "comment_id": 86096648, "body": "Indeed and I was also gong to suggest [ [x-2,x-1, x] | x &lt;- [3..n] ]. Within your comprehension the result can be in square brackets as, I&#39;m sure you well know. Thank you."}], "tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": false, "score": 0, "last_activity_date": 1521419739, "creation_date": 1521419739, "answer_id": 49354264, "question_id": 49353643, "link": "https://stackoverflow.com/questions/49353643/group-adjacent-values-in-a-list-in-haskell/49354264#49354264", "title": "Group adjacent values in a list in Haskell", "body": "<p>Alternative to Daniel's <a href=\"https://stackoverflow.com/a/49353736/3058609\">very clever answer</a>, you can use <code>take</code> and explicit recursion.</p>\n\n<pre><code>f n (x:xs) | length xs &lt; (n-1) = []\n           | otherwise         = (x : take (n-1) xs) : f n xs\n</code></pre>\n\n<p>However this will end up being substantially slower since it's necessary to force <code>length xs</code> so many times.</p>\n"}, {"comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1521426874, "post_id": 49354698, "comment_id": 85710365, "body": "I suspect your <code>$!</code>s won&#39;t actually do anything because <code>fmap</code> and <code>safeTake</code> are already strict in those arguments. I experimented with a version of <code>safeTake</code> which returned <code>(success, result) :: (Bool, [a])</code> (and a wrapper function which inspected <code>success</code> and returned the appropriate <code>Maybe</code>), and the generated Core looks better - the tuples got unboxed so there&#39;s less wrapping and unwrapping of heap objects than the <code>Maybe</code> version. Didn&#39;t benchmark it though because it&#39;s late. Might also be fun to try a tail recursive version..."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1522084742, "post_id": 49354698, "comment_id": 85998128, "body": "@BenjaminHodgson <a href=\"https://stackoverflow.com/a/24609264/849891\"><code>foldr (zipWith (:)) (repeat []) . take n . tails</code></a> does it all by itself. I don&#39;t know if it fuses or not, though..."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1522114182, "post_id": 49354698, "comment_id": 86010245, "body": "@HTNW interesting. another way to write <code>maybeToList . safeTake n</code> is <code>map fst . maybeToList . runStateT (sequence $ StateT uncons &lt;$ [1..n])</code>. Still it&#39;ll work through the leftovers, failing safely for each; <code>foldr (zipWith (:)...</code> mentioned above just ignores them. Also, this, as does <code>safeTake</code>, effectively checks the success of each <code>uncons</code>, while <code>zipWith</code> approach just works. (and of course the repeated <code>take n</code>s traverse over same elements multiple times...)"}], "tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": false, "score": 2, "last_activity_date": 1532735955, "last_edit_date": 1592644375, "creation_date": 1521424096, "answer_id": 49354698, "question_id": 49353643, "link": "https://stackoverflow.com/questions/49353643/group-adjacent-values-in-a-list-in-haskell/49354698#49354698", "title": "Group adjacent values in a list in Haskell", "body": "<p>An alternative explanation of @DanielWagner's solution from a slightly higher level of abstraction:</p>\n<blockquote>\n<p>Original solution:</p>\n<pre><code>f n xs = zipWith const (take n &lt;$&gt; tails xs) (drop (n-1) xs)\n</code></pre>\n<hr />\n<p><code>take n &lt;$&gt; tails xs</code> uses the nondeterminism monad:</p>\n<pre><code>type NonDet a = [a]\n-- instance Monad NonDet\ntails :: [a] -&gt; NonDet [a]\n</code></pre>\n<p><code>tails</code> nondeterministically &quot;chooses&quot; where the sublist begins, and then the pure function</p>\n<pre><code>take n :: [a] -&gt; [a]\n</code></pre>\n<p>is <code>fmap</code>'d under the <code>NonDet</code>erminism layer to chop the tail off. This leaves some flab at the result's end, so we go into the plumbing of <code>NonDet</code>/<code>[]</code> with <code>zipWith</code> fix it.</p>\n</blockquote>\n<p>This new explanation also opens up an optimization. The <code>[]</code> monad has a concept of failure, which is the empty list. If we had a version of <code>take</code> that would fail monadically when it had a too-short argument, we could use it and not worry about removing the short sublists at the end of the result. So:</p>\n<pre><code>import Control.Monad((&lt;=&lt;))\nimport Data.Maybe(maybeToList)\n\n-- Maybe is the simplest failure monad.\n-- Doesn't return [[a]] because this could conceivably be used in other\n-- contexts and Maybe [a] is &quot;smaller&quot; and clearer than [[a]].\n-- &quot;safe&quot; because, in the context of (do xs &lt;- safeTake n ys),\n-- length xs == n, definitely.\nsafeTake :: Int -&gt; [a] -&gt; Maybe [a]\nsafeTake 0 _ = return []\nsafeTake n [] = Nothing\nsafeTake n (x:xs) = (x:) &lt;$&gt; (safeTake $ n - 1) xs\n\n-- maybeToList :: Maybe a -&gt; [a]\n-- maybeToList (return x) = return x / maybeToList (Just x) = [x]\n-- maybeToList empty      = empty    / maybeToList Nothing  = [ ]\n-- (.)   ::            (b -&gt;   c) -&gt; (a -&gt;   b) -&gt; (a -&gt;   c)\n-- (&lt;=&lt;) :: Monad m =&gt; (b -&gt; m c) -&gt; (a -&gt; m b) -&gt; (a -&gt; m c)\nf n = maybeToList . safeTake n &lt;=&lt; tails\n</code></pre>\n<p><code>f</code> no longer digs through the nondeterminism abstraction with something that is outside the monad. It can also be written in terms of Kliesli composition, which certainly gives it points in the beauty category. A <code>criterion</code> benchmark also shows a 15-20% speedup (under <code>-O2</code>). Personally, I think it's cool that seeing something more abstractly and making the code &quot;prettier&quot; can also confer performance.</p>\n"}, {"comments": [{"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 1, "creation_date": 1522258077, "post_id": 49364400, "comment_id": 86088693, "body": "I was so impressed with the use of pattern matching in a let function. Also zip3 is the perfect tool. I would prefer, however . . . . . . . . . . . . z3 n=[[ x,y,z] | (x,y,z)&lt;-zip3 [1..n] [2..n] [3..n]] . . . . . . . .  . .which also produces the triples in  lists."}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "reply_to_user": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 1, "creation_date": 1522269471, "post_id": 49364400, "comment_id": 86095123, "body": "@fpmora yes nice solution, however I assumed he wants a general solution, otherwise this <code>[(i, i + 1, i + 2) | i &lt;- [1 .. (n - 2)]]</code> would have done the job as well."}], "tags": [], "owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "is_accepted": false, "score": 2, "last_activity_date": 1521467169, "last_edit_date": 1521467169, "creation_date": 1521466792, "answer_id": 49364400, "question_id": 49353643, "link": "https://stackoverflow.com/questions/49353643/group-adjacent-values-in-a-list-in-haskell/49364400#49364400", "title": "Group adjacent values in a list in Haskell", "body": "<pre><code>let x:y:ls = [1,2,3,4,5,6,7] in zip3 (x:y:ls) (y:ls) ls\n</code></pre>\n\n<p>Will give</p>\n\n<pre><code>[(1,2,3),(2,3,4),(3,4,5),(4,5,6),(5,6,7)]\n</code></pre>\n\n<p>Tuples instead of lists. If you want lists then apply <code>\\(a, b, c) -&gt; [a, b, c]</code>. Or do</p>\n\n<pre><code>let x:y:ls = [1,2,3,4,5,6,7] in [[a, b, c] | (a, b, c) &lt;- zip3 (x:y:ls) (y:ls) ls]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1521595942, "post_id": 49367733, "comment_id": 85795277, "body": "What&#39;s wrong with a recursive function? You should also look at the <code>splitAt</code> function."}, {"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1521663032, "post_id": 49367733, "comment_id": 85833089, "body": "Read some of the comments here and others in Stack Overflow. In fact the term stack overflow is from recursive functions not able to handle a large data set. Some recursive functions chock too easily with a very long list and infinite lists are impossible. That said, the sheer beauty of recursive functions is what is most attractive."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1521664573, "post_id": 49367733, "comment_id": 85833904, "body": "Recursive functions don&#39;t have to lead to stack growth. Read the classic  &quot;Debunking the expensive procedure call myth&quot; at <a href=\"http://library.readscheme.org/page1.html\" rel=\"nofollow noreferrer\">readscheme</a> to start. Haskell&#39;s evaluation model is a bit different, being based on graph reduction. Recursion is the <i>only</i> primitive looping construct in Haskell. All other iterative forms are implemented by recursion. The compiler&#39;s job is to make that work efficiently, and it&#39;s very good at that job."}, {"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1521667493, "post_id": 49367733, "comment_id": 85835296, "body": "Well, thank you. I take your words to heart. I was under the impression that Haskell converted primitive recursion to iteration not the other way around. I do talk from experience, I&#39;ve had stack overflow errors with recursion in Haskell. It leaves a very bad taste in one&#39;s mouth. The odd thing is I much prefer recursive functions and mutually recursive functions. The more declarative the function, the more correct and so the better. They make for the easiest to maintain and change also."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1521692275, "post_id": 49367733, "comment_id": 85842054, "body": "The distinction between &quot;recursion&quot; and &quot;iteration&quot; is a slippery one. Once it gets down to assembly code, it&#39;s all about putting things in registers and jumping. You <i>do</i> have to be careful about how you write your Haskell code to prevent things from blowing up, but the rules for doing so are not the same as the ones in C. For example, the definition <code>length [] = 0; length (_ : xs) = 1 + length xs</code> will blow up. But the definition <code>length = go 0 where go acc [] = acc; go !acc (_ : xs) = go (acc + 1) xs</code> will work just fine. You&#39;ll learn...."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1522086011, "post_id": 49367733, "comment_id": 85998815, "body": "it is customary to put each guard in its own line, while aligning the bars <code>|</code> to line up vertically. there&#39;s alternative ways to write <code>if</code>, e.g. <code>if | 1==0 -&gt; 0 | 1==1 -&gt; 1 | 1==2 -&gt; 2</code> with <a href=\"http://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#multi-way-if-expressions\" rel=\"nofollow noreferrer\">MultiWayIf</a>. there&#39;s also the <a href=\"https://hackage.haskell.org/package/base-4.11.0.0/docs/Data-Bool.html#v:bool\" rel=\"nofollow noreferrer\">bool</a> function, equivalent to &quot;if&quot;, but with it the selection is positional, so, not evident in the code."}, {"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 0, "creation_date": 1522102264, "post_id": 49367733, "comment_id": 86006944, "body": "Indeed and when I create a file the guards are aligned. If I create a file, it is because the logic is much more involved. The layout is essential for reflecting the logic of the code. Some things are even more important such as the specification of the result being correctly understood."}], "tags": [], "owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "is_accepted": false, "score": 0, "last_activity_date": 1525748133, "last_edit_date": 1525748133, "creation_date": 1521476509, "answer_id": 49367733, "question_id": 49353643, "link": "https://stackoverflow.com/questions/49353643/group-adjacent-values-in-a-list-in-haskell/49367733#49367733", "title": "Group adjacent values in a list in Haskell", "body": "<p>It doesn't appear Haskell will iterate over a list 3 at a time. list comprehensions won't either. Without iteration, it seems, there is no way to handle infinite lists. IDK, I'm too new to Haskell. All I could come up with is a recursive function. ugh. A feature of the function is that it can be parameterized, it can produce arbitrary size sub-lists. Using Haskell pattern matching requires specifying the number of elements in each sub list, like for 3, (x:y:z:xs) and Haskell will reduce xs by 3 on each iteration. Four at a time would be (w:x:y:z:xs). This introduced bad hard coding into the function. So this function has to reduce xs using drop 3 but 3 can be parameter as take 3 can also. A helper function to take the size of each sub-list and to pass the constant [] (null list) to the primary function as the first parmeter would be helpful.</p>\n\n<pre><code>fl2 (ys) (xs) = if null xs then ys else (fl2 (ys ++ [take 3 xs]) (drop 3 xs))\n</code></pre>\n\n<p>fl2 [] [1..12] ......... [[1,2,3],[4,5,6],[7,8,9],[10,11,12]]</p>\n\n<p>What is interesting is the function pair [take 3 l, drop 3 l] when used in a function is good for one [[1,2,3],[4,5,6,7,8,9,10,11,12]]. This is basically what the fl2 function uses but the sub-lists must accumulate.</p>\n\n<p>Edit 3/19/18\nMessing around with this I found, to my surprise, that this works. I could probable clean it up a lot but, for now ...</p>\n\n<pre><code>f7 ls = (take 3 ls, drop 3 ls)\nf8 (a,b) = if null b then [a] else a : (f8 (f7 b))\n</code></pre>\n\n<p>How this is run is not pretty, but...</p>\n\n<pre><code>f8 $ f7 [1..12]\n</code></pre>\n\n<p>produces [[1,2,3],[4,5,6],[7,8,9],[10,11,12]]\nThis IMO is still better that passing a [] as a parameter.</p>\n\n<p>This last function and probably the previous handles [] with [], [1] with [1] and odd numbered lists, truncating the very last list accordingly. None of this were a consideration of writing of the function but is is a result.</p>\n\n<p><strong>Edit 3/23/2018</strong></p>\n\n<p>Well thanks to dfeuer, I tried splitAt instead of (\\xs -> (take 3 xs, drop 3 xs). I also changed the syntax of the single line function to not use if-then-else. Calling the function is still the same. A third wrapper function might well be in order.</p>\n\n<pre><code>f7 = (splitAt 3)\nf8 (a,b) | null b = [a] | True = a : (f8 $ f7 b)\n</code></pre>\n\n<p>I am smitten by the use of pattern matching guards in single line functions. If-then-else is so ugly. I agree that 'if' should be a function like it is in lisp-like languages.</p>\n\n<p><strong>Edit 3/26/2018</strong></p>\n\n<p>Errrr. I don't know how I got the specification wrong. The result list is [1,2,3],[2,3,4],[3,4,5] not [1,2,3],[4,5,6],[7,8,9]\nI feel dumber than normal.\nHere are two revised function to produce the correct result list.\nThe first function generates all possible triples in range because the sub-lists of the result are triples.</p>\n\n<pre><code>lt = [[a,b,c] | a &lt;- [1..10], b &lt;- [2..11], c &lt;- [3..12]]\n</code></pre>\n\n<p>The second function picks out the correct elements of 'lt' by a calculated index value. For the 12 element input list the index values are 1,111,222,...999 so are multiples of 111. So here for an input list of [1..12]</p>\n\n<pre><code>[lt!!(x*111) | x &lt;- [0..9]]\n</code></pre>\n\n<p>Produces </p>\n\n<pre><code>[[1,2,3],[2,3,4],[3,4,5],[4,5,6],[5,6,7],[6,7,8],[7,8,9],[8,9,10],[9,10,11],[10,11,12]]\n</code></pre>\n\n<p><strong>Edit 3/27/2018</strong>\nWell, the list generated to pick values from had as the last value of a set the next needed in any list. I was recently taught to look closely and together at the lists generated. I generated a few lists from the lt generating function above. The last element of each list were the exact values for any size list. lt is no longer needed. This single line does everything.</p>\n\n<pre><code>grp3 n = map (\\x -&gt; [(x-2),(x-1),x]) [3..n]\n</code></pre>\n\n<p>The following is most general. It will group by any amount and it will include sublists of groups less than the group size specified for completeness.</p>\n\n<pre><code>grp n ls = [take n.drop x $ ls)|x&lt;-[0,n..]]\n</code></pre>\n\n<p><strong>5/7/2018</strong>\nI do this too often. I find relatively quickly that some of my functions can change character with only minor changes in the code. I am careless about versions. This last version generates the wrong type list.</p>\n\n<pre><code>take 6 $ grp 3 [1..]\n</code></pre>\n\n<p>[[1,2,3],[4,5,6],[7,8,9],[10,11,12],[13,14,15],[16,17,18]]</p>\n\n<p>Take the <code>n</code> out of the enumeration</p>\n\n<pre><code>grp n ls = [(take n.drop i$ls)| (i,x) &lt;- zip [0..] ls]\n</code></pre>\n\n<p>and</p>\n\n<pre><code>take 6 $ grp 3 [1..]\n</code></pre>\n\n<p>[[1,2,3],[2,3,4],[3,4,5],[4,5,6],[5,6,7],[6,7,8]]</p>\n\n<p>I added the zip to both now to limit the output.</p>\n\n<pre><code>grp 3 [1..10]\n</code></pre>\n\n<p>[[1,2,3],[2,3,4],[3,4,5],[4,5,6],[5,6,7],[6,7,8],[7,8,9],[8,9,10],[9,10],[10]]</p>\n"}], "owner": {"reputation": 3502, "user_id": 2558108, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DUiG3.jpg?s=128&g=1", "display_name": "Qwertie", "link": "https://stackoverflow.com/users/2558108/qwertie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 920, "favorite_count": 0, "closed_date": 1522085005, "accepted_answer_id": 49353736, "answer_count": 5, "score": 1, "last_activity_date": 1532735955, "creation_date": 1521413633, "question_id": 49353643, "link": "https://stackoverflow.com/questions/49353643/group-adjacent-values-in-a-list-in-haskell", "closed_reason": "Duplicate", "title": "Group adjacent values in a list in Haskell", "body": "<p>If I have the list <code>[1,2,3,4,5,6,7]</code> and I want to group 3 (or any other number) adjacent values so I end up with the list: <code>[[1,2,3],[2,3,4],[3,4,5],[4,5,6],[5,6,7]]</code> </p>\n\n<p>How would I go about doing this in Haskell?</p>\n"}, {"tags": ["haskell", "applicative"], "comments": [{"owner": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "edited": false, "score": 0, "creation_date": 1521412560, "post_id": 49353309, "comment_id": 85707272, "body": "I&#39;m pretty certain the first example doesn&#39;t do what you think it does. <code>*&gt;</code> and <code>&lt;*</code> discard the value of the left/right argument, so right off the bat you discarded the value of <code>fmap (+) ws</code> which is a function(and not the function you think it is)."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 9281634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adc1cfe52e2acaf21b746374509aadef?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Browning", "link": "https://stackoverflow.com/users/9281634/michael-browning"}, "edited": false, "score": 0, "creation_date": 1521437703, "post_id": 49353481, "comment_id": 85712771, "body": "Perfect, exactly what I was looking for. I don&#39;t really get the distinction between <code>&lt;*</code> and <code>*&gt;</code> though, are the just saying that the result of the &#39;next&#39; or &#39;previous&#39; ones are ignored respectively?"}, {"owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "reply_to_user": {"reputation": 23, "user_id": 9281634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adc1cfe52e2acaf21b746374509aadef?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Browning", "link": "https://stackoverflow.com/users/9281634/michael-browning"}, "edited": false, "score": 0, "creation_date": 1521442380, "post_id": 49353481, "comment_id": 85714453, "body": "Yes. Just look at the types: <code>(*&gt;) :: Applicative f =&gt; f a -&gt; f b -&gt; f b</code>. The <code>a</code> is not mentioned in the result, so it is ignored. <code>(&lt;*) :: Applicative f =&gt; f a -&gt; f b -&gt; f a</code>. The <code>b</code> is not mentioned in the result, so it is ignored. Both operators associate to the left, though, so if you mix them, strange things happen. For example <code>x &lt;* y *&gt; z</code> is to be read as <code>(x &lt;* y) *&gt; z</code> and ignores all results except the one of <code>z</code>."}], "tags": [], "owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "is_accepted": true, "score": 4, "last_activity_date": 1521412161, "creation_date": 1521412161, "answer_id": 49353481, "question_id": 49353309, "link": "https://stackoverflow.com/questions/49353309/haskell-applicative-usage-of-and/49353481#49353481", "title": "Haskell Applicative usage of &lt;* and *&gt;", "body": "<p>In my experience, it's getting quite confusing except in the simplest of cases to mix <code>(*&gt;)</code> and <code>(&lt;*)</code>. I tend to use only the <code>(&lt;*)</code> (and the <code>(&lt;$)</code>) variants. Then I can go from left to right and only ever decide whether I want to use the result of the \"next\" item or not.</p>\n\n<p>In your example, this would mean:</p>\n\n<pre><code>ps = (+) &lt;$ ws &lt;* p1 &lt;*&gt; val &lt;* ws &lt;* p2 &lt;* pw &lt;*&gt; val &lt;* ws &lt;* p3\n</code></pre>\n\n<p>(Furthermore, assuming <code>ws</code> might be short for whitespace: you should probably not mix whitespace parsers into everything, but write abstractions that parse the whitespace more or less automatically. The common techniques are to either define parser combinators that themselves parse and discard whitespace in the end, or to first do a lexing pass and let the parser combinators operate on the resulting list/stream of tokens.)</p>\n"}], "owner": {"reputation": 23, "user_id": 9281634, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/adc1cfe52e2acaf21b746374509aadef?s=128&d=identicon&r=PG&f=1", "display_name": "Michael Browning", "link": "https://stackoverflow.com/users/9281634/michael-browning"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 49353481, "answer_count": 1, "score": 1, "last_activity_date": 1521412161, "creation_date": 1521410871, "question_id": 49353309, "link": "https://stackoverflow.com/questions/49353309/haskell-applicative-usage-of-and", "title": "Haskell Applicative usage of &lt;* and *&gt;", "body": "<p>So I'm creating a basic parser in Haskell, and I recently learned that instead of something like this:</p>\n\n<pre><code>sumParser = fmap (\\_ a _ b _ -&gt; a + b) ws &lt;*&gt; val &lt;*&gt; plus &lt;*&gt; val &lt;*&gt; eof\n</code></pre>\n\n<p>I could make it cleaner using something like </p>\n\n<pre><code>sumParser = fmap (+) ws *&gt; val &lt;* plus *&gt; val &lt;* eof\n</code></pre>\n\n<p>Obviously, I'm not actually doing this, but it's an example. My question is, I can 'skip' the 'return' value of certain parsers(?) like <code>ws</code> and <code>val</code> using the <code>&lt;*</code> and <code>*&gt;</code>. However, I'm really new to Haskell, and I'm not sure if this even makes sense or how to look it up (I don't really get it from Hoogle and looking around), but I want to be able to skip multiple of them together.</p>\n\n<p>What I mean is I would like to change something like this:</p>\n\n<pre><code>ps = fmap (\\_ _ a _ _ _ b _ _ -&gt; a+b) ws &lt;*&gt; p1 &lt;*&gt; val &lt;*&gt; ws &lt;*&gt; p2 &lt;*&gt; ws &lt;*&gt; val &lt;*&gt; ws &lt;*&gt; p3\n</code></pre>\n\n<p>to something like </p>\n\n<pre><code>ps = fmap (\\a b -&gt; a+b) ws *&gt; p1 *&gt; val &lt;* ws * p2 * ws *&gt; val &lt;* ws &lt;* p3\n</code></pre>\n\n<p>Now that doesn't compile, and I'm not sure how to look up if this is even possible to do?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 2, "creation_date": 1521400607, "post_id": 49351794, "comment_id": 85703655, "body": "I don&#39;t recommend this, but you could always have something like <code>instance (Typeable a, Typeable b) =&gt; Show (a -&gt; b) where { show = show . typeOf }</code>. That is likely to be a bit more effective - especially since <code>Typeable</code> is derivable."}, {"owner": {"reputation": 31724, "user_id": 6264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbb17eeeecd3d9d06f4db310ab630a12?s=128&d=identicon&r=PG", "display_name": "Michiel Borkent", "link": "https://stackoverflow.com/users/6264/michiel-borkent"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1521400795, "post_id": 49351794, "comment_id": 85703735, "body": "This works. Can you explain why you don&#39;t recommend it? Performance because type tags have to be maintained in the runtime?"}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1521400845, "post_id": 49351794, "comment_id": 85703763, "body": "@Alec Beat me to it, and your solution is far simpler. I don&#39;t know why I didn&#39;t think of that."}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 1, "creation_date": 1521400937, "post_id": 49351794, "comment_id": 85703806, "body": "AFAIK there aren&#39;t any performance penalties from doing this, as the type can be determined at compile-time and the <code>TypeRep</code> more or less optimized out. It&#39;s mainly a style thing, because if you&#39;re printing functions to the screen (for reasons other than debugging) you&#39;re probably doing something wrong, and it&#39;s nice that the compiler lets you know that."}, {"owner": {"reputation": 31724, "user_id": 6264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbb17eeeecd3d9d06f4db310ab630a12?s=128&d=identicon&r=PG", "display_name": "Michiel Borkent", "link": "https://stackoverflow.com/users/6264/michiel-borkent"}, "edited": false, "score": 0, "creation_date": 1521401064, "post_id": 49351794, "comment_id": 85703866, "body": "If Alec want to paste his comment as an answer I&#39;d be happy to accept that, because he was first and Silvio credits him as well."}, {"owner": {"reputation": 31724, "user_id": 6264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbb17eeeecd3d9d06f4db310ab630a12?s=128&d=identicon&r=PG", "display_name": "Michiel Borkent", "link": "https://stackoverflow.com/users/6264/michiel-borkent"}, "edited": false, "score": 0, "creation_date": 1521401180, "post_id": 49351794, "comment_id": 85703921, "body": "This is funny:  let f a b c = a + b + c. Now show will return &quot;Integer -&gt; Integer -&gt; Integer -&gt; Integer&quot;. Why is that?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1521401348, "post_id": 49351794, "comment_id": 85703990, "body": "I agree with Alec that this is just not a good idea \u2013 showing only the type is pretty useless; <code>show</code> is supposed to actually represent <i>values</i> which for functions is just not really doable. Though, one can use specialised function types <a href=\"http://hackage.haskell.org/package/QuickCheck-2.11.3/docs/Test-QuickCheck-Function.html\" rel=\"nofollow noreferrer\">that actually make it possible for specific applications</a>."}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1521401485, "post_id": 49351794, "comment_id": 85704058, "body": "@MichielBorkent Why does that surprise you? <code>f</code> is a function of three arguments."}, {"owner": {"reputation": 31724, "user_id": 6264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbb17eeeecd3d9d06f4db310ab630a12?s=128&d=identicon&r=PG", "display_name": "Michiel Borkent", "link": "https://stackoverflow.com/users/6264/michiel-borkent"}, "edited": false, "score": 0, "creation_date": 1521401661, "post_id": 49351794, "comment_id": 85704110, "body": "I&#39;m not surprised about the amount of arguments, but about the default <code>Integer</code> for <code>Num</code>."}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1521402256, "post_id": 49351794, "comment_id": 85704295, "body": "That&#39;s a good question actually. <code>Typeable</code> only works for monomorphic instances, so <code>Num a =&gt; a</code> won&#39;t work as a <code>Typeable</code> instance. However, <code>Num</code> has <a href=\"https://www.haskell.org/onlinereport/decls.html#sect4.3.4\" rel=\"nofollow noreferrer\">defaulting behavior</a> and will default to <code>Integer</code> if it has to be used monomorphically."}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 0, "creation_date": 1521402283, "post_id": 49351794, "comment_id": 85704304, "body": "If you print <code>show</code> (without any type signature), you&#39;ll get <code>() -&gt; [Char]</code>, because the <code>a</code> in <code>Show a =&gt; a -&gt; String</code> defaults to <code>()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 2, "creation_date": 1521409184, "post_id": 49351924, "comment_id": 85706325, "body": "I object to such a <code>Show</code> instance on grounds that the output is not something I can feed back into GHCi to get back the original value. If this is just for debugging, the error message <code>Cannot find &#39;Show&#39; instance for Int -&gt; Bool</code> is just as descriptive."}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1521418023, "post_id": 49351924, "comment_id": 85708531, "body": "I concur entirely, and I also do not recommend doing this. However, it is an answer to the question that was asked, even if said question was asked based on a pretense that we disagree with."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1521426006, "post_id": 49351924, "comment_id": 85710166, "body": "I understand - I&#39;m explaining why I won&#39;t post such an answer. Also, your original instance code is buggy: <code>show (undefined :: (Int -&gt; Int) -&gt; Int)</code> will incorrectly output <code>Int -&gt; Int -&gt; Int</code>."}], "tags": [], "owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "is_accepted": true, "score": 4, "last_activity_date": 1521400813, "creation_date": 1521400813, "answer_id": 49351924, "question_id": 49351794, "link": "https://stackoverflow.com/questions/49351794/writing-a-show-instance-for/49351924#49351924", "title": "Writing a Show instance for (-&gt;)", "body": "<p>Yes, if <code>a</code> and <code>b</code> are <a href=\"https://hackage.haskell.org/package/base-4.10.1.0/docs/Data-Typeable.html\" rel=\"nofollow noreferrer\"><code>Typeable</code></a> instances.</p>\n\n<pre><code>import Data.Typeable\nimport Data.Proxy\n\ninstance (Typeable a, Typeable b) =&gt; Show (a -&gt; b) where\n    show f = show (typeRep $ a f) ++ \" -&gt; \" ++ show (typeRep $ b f)\n        where a :: (a' -&gt; b') -&gt; Proxy a'\n              a _ = Proxy\n              b :: (a' -&gt; b') -&gt; Proxy b'\n              b _ = Proxy\n</code></pre>\n\n<p>With <code>-XScopedTypeVariables</code>, this becomes a bit simpler.</p>\n\n<pre><code>import Data.Typeable\nimport Data.Proxy\n\ninstance forall a b. (Typeable a, Typeable b) =&gt; Show (a -&gt; b) where\n    show f = show (typeRep $ a) ++ \" -&gt; \" ++ show (typeRep $ b)\n        where a :: Proxy a\n              a = Proxy\n              b :: Proxy b\n              b = Proxy\n</code></pre>\n\n<p>Or, as Alec pointed out in the comments, you can do it in this much simpler way.</p>\n\n<pre><code>import Data.Typeable\nimport Data.Proxy\n\ninstance (Typeable a, Typeable b) =&gt; Show (a -&gt; b) where\n    show = show . typeOf\n</code></pre>\n"}], "owner": {"reputation": 31724, "user_id": 6264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbb17eeeecd3d9d06f4db310ab630a12?s=128&d=identicon&r=PG", "display_name": "Michiel Borkent", "link": "https://stackoverflow.com/users/6264/michiel-borkent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 49351924, "answer_count": 1, "score": 0, "last_activity_date": 1521400813, "creation_date": 1521400146, "question_id": 49351794, "link": "https://stackoverflow.com/questions/49351794/writing-a-show-instance-for", "title": "Writing a Show instance for (-&gt;)", "body": "<p>Is it possible to write a generic Show instance for <code>(-&gt;) a b</code> which includes the types of <code>a</code> <code>b</code> when <code>(-&gt;)</code> is saturated? E.g.</p>\n\n<pre><code>*Main&gt; :set -XFlexibleInstances\n*Main&gt; instance Show ((-&gt;) Int Int) where show f = \"Int -&gt; Int\"\n*Main&gt; f = id :: Int -&gt; Int\n*Main&gt; f\n-- output: Int -&gt; Int\n</code></pre>\n\n<p>It would be a lot of work to encode every possible combination. Is there a better way?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31724, "user_id": 6264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbb17eeeecd3d9d06f4db310ab630a12?s=128&d=identicon&r=PG", "display_name": "Michiel Borkent", "link": "https://stackoverflow.com/users/6264/michiel-borkent"}, "edited": false, "score": 3, "creation_date": 1521398248, "post_id": 49351459, "comment_id": 85702826, "body": "Please provide the full code, including the Film type."}, {"owner": {"reputation": 17, "user_id": 9469859, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "sam786", "link": "https://stackoverflow.com/users/9469859/sam786"}, "reply_to_user": {"reputation": 31724, "user_id": 6264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbb17eeeecd3d9d06f4db310ab630a12?s=128&d=identicon&r=PG", "display_name": "Michiel Borkent", "link": "https://stackoverflow.com/users/6264/michiel-borkent"}, "edited": false, "score": 0, "creation_date": 1521398968, "post_id": 49351459, "comment_id": 85703057, "body": "Film = (Title , Director , Year, Likes , Dislikes) - where Title, Director = String, Year = Int, Likes,Dislikes = [User] , User = String"}, {"owner": {"reputation": 17, "user_id": 9469859, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "sam786", "link": "https://stackoverflow.com/users/9469859/sam786"}, "reply_to_user": {"reputation": 31724, "user_id": 6264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbb17eeeecd3d9d06f4db310ab630a12?s=128&d=identicon&r=PG", "display_name": "Michiel Borkent", "link": "https://stackoverflow.com/users/6264/michiel-borkent"}, "edited": false, "score": 0, "creation_date": 1521399026, "post_id": 49351459, "comment_id": 85703077, "body": "And I want to display the information of (Film, Float)"}], "answers": [{"comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 1, "creation_date": 1521400414, "post_id": 49351770, "comment_id": 85703580, "body": "Note that you&#39;re not using <code>number</code> for anything -- why include it?"}, {"owner": {"reputation": 17, "user_id": 9469859, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "sam786", "link": "https://stackoverflow.com/users/9469859/sam786"}, "edited": false, "score": 0, "creation_date": 1521464183, "post_id": 49351770, "comment_id": 85727184, "body": "I was supposed to add the number but forgot , Thanks for your help"}], "tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": true, "score": 0, "last_activity_date": 1521401701, "last_edit_date": 1521401701, "creation_date": 1521399959, "answer_id": 49351770, "question_id": 49351459, "link": "https://stackoverflow.com/questions/49351459/i-am-trying-to-list-the-details-of-a-tuple-with-two-data-type-how-would-i-do-thi/49351770#49351770", "title": "I am trying to list the details of a tuple with two data type how would I do this?", "body": "<p>Seems like a good use of <a href=\"https://hackage.haskell.org/package/base-4.10.1.0/docs/Text-Printf.html#v:printf\" rel=\"nofollow noreferrer\"><code>Text.Printf</code></a>, but you could use your code if you pattern match appropriately.</p>\n\n<pre><code>formFilmAsStringInt :: (Film, Float) -&gt; String\nformFilmAsStringInt ((Film title director year likes dislikes), number) =\n  -- what you wrote above\n</code></pre>\n\n<p>With <code>printf</code>, I'd write:</p>\n\n<pre><code>import Text.Printf (printf)\n\nformFilmAsStringInt :: (Film, Float) -&gt; String\nformFilmAsStringInt ((Film title director year likes dislikes), number) =\n  let template = \"Title: %s\\n\\\n                 \\Director: %s\\n\\\n                 \\Year: %d\\n\\\n                 \\Likes: %s\\n\\\n                 \\Dislikes: %s\\n\\n\"\n  in  printf template title director year likes dislikes\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9469859, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "sam786", "link": "https://stackoverflow.com/users/9469859/sam786"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 49351770, "answer_count": 1, "score": -4, "last_activity_date": 1521401701, "creation_date": 1521397795, "question_id": 49351459, "link": "https://stackoverflow.com/questions/49351459/i-am-trying-to-list-the-details-of-a-tuple-with-two-data-type-how-would-i-do-thi", "title": "I am trying to list the details of a tuple with two data type how would I do this?", "body": "<pre><code>formFilmAsStringInt:: (Film,Float) -&gt; String\nformFilmAsStringInt title,director,year,likes,dislikes,number  = \"Title: \" ++ \ntitle ++ \"\\nDirector: \" ++ director ++  \"\\nYear:\" ++ show year ++ \"\\nLikes:\" \n++ unwords likes ++ \" \\nDislikes: \" ++ unwords dislikes ++\"\\n\\n\"\n</code></pre>\n\n<p>I am trying to display the the data in the tuples how do I do this? \nMy film consists of (String, String , Int, [], []) and a float </p>\n\n<pre><code>formFilmAsStringInt title,director,year,likes,dislikes,number \n</code></pre>\n"}, {"tags": ["list", "haskell", "functional-programming"], "answers": [{"tags": [], "owner": {"reputation": 31724, "user_id": 6264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbb17eeeecd3d9d06f4db310ab630a12?s=128&d=identicon&r=PG", "display_name": "Michiel Borkent", "link": "https://stackoverflow.com/users/6264/michiel-borkent"}, "is_accepted": true, "score": 8, "last_activity_date": 1521398326, "last_edit_date": 1521398326, "creation_date": 1521397671, "answer_id": 49351438, "question_id": 49351423, "link": "https://stackoverflow.com/questions/49351423/haskell-convert-string-to-nested-lists/49351438#49351438", "title": "Haskell Convert String to nested lists", "body": "<p>Yes, that function is <code>read</code>. If you specify what it should read in a type annotation, you will get the desired result, provided there is an instance of <code>Read</code> for that type.</p>\n\n<pre><code>read \"[ [1,1] , [2,2] ]\" :: [[Int]]\n-- [[1,1],[2,2]]\n\nread \"[ [ [1,1], [1,1] ], [ [2,2] , [2,2] ] , [ [1,1] ,[1,1] ] ]\" :: [[[Int]]]\n-- [[[1,1],[1,1]],[[2,2],[2,2]],[[1,1],[1,1]]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20427, "user_id": 2570261, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e71068b09fc539447a0cee3e99fc419d?s=128&d=identicon&r=PG&f=1", "display_name": "Haleemur Ali", "link": "https://stackoverflow.com/users/2570261/haleemur-ali"}, "is_accepted": false, "score": 1, "last_activity_date": 1521398596, "creation_date": 1521398596, "answer_id": 49351585, "question_id": 49351423, "link": "https://stackoverflow.com/questions/49351423/haskell-convert-string-to-nested-lists/49351585#49351585", "title": "Haskell Convert String to nested lists", "body": "<p>One option could be to use the Aeson package and treat the text as json data.</p>\n\n<pre><code>Prelude&gt; :set -XOverloadedStings\nPrelude&gt; import Data.Aeson\nPrelude Data.Aeson&gt; jsString = \"[ [ [1,1], [1,1] ], [ [2,2] , [2,2] ] , [ [1,1] ,[1,1] ] ]\"\nPrelude Data.Aeson&gt; decode jsString :: Maybe [[[Int]]]\nJust [[[1,1],[1,1]],[[2,2],[2,2]],[[1,1],[1,1]]]\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 7848110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/762c17b0876ef8d501434079e75b23df?s=128&d=identicon&r=PG&f=1", "display_name": "Julio CMC", "link": "https://stackoverflow.com/users/7848110/julio-cmc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 49351438, "answer_count": 2, "score": 2, "last_activity_date": 1521398596, "creation_date": 1521397588, "last_edit_date": 1521397640, "question_id": 49351423, "link": "https://stackoverflow.com/questions/49351423/haskell-convert-string-to-nested-lists", "title": "Haskell Convert String to nested lists", "body": "<p>I have a doubt, is there a function in haskell that can help me solve this? I'm trying to receive as an input a String with the form of a list and the convert it into an actual list in haskell</p>\n\n<p>for example:</p>\n\n<p>convert <code>\"[ [1,1] , [2,2] ]\"</code> into <code>[ [1,1] , [2,2] ]</code></p>\n\n<p>Example 2:</p>\n\n<p>convert <code>\"[ [ [1,1], [1,1] ], [ [2,2] , [2,2] ] , [ [1,1] ,[1,1] ] ]\"</code></p>\n\n<p>into <code>[ [ [1,1], [1,1] ], [ [2,2] , [2,2] ] , [ [1,1] ,[1,1] ] ]</code></p>\n\n<p>thanks in advance!</p>\n"}, {"tags": ["haskell", "compiler-errors", "monads", "type-mismatch", "do-notation"], "comments": [{"owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "edited": false, "score": 1, "creation_date": 1521394514, "post_id": 49350898, "comment_id": 85701560, "body": "Why are you trying to use <code>do</code> notation here in the first place?"}, {"owner": {"reputation": 109, "user_id": 5208741, "user_type": "registered", "profile_image": "https://graph.facebook.com/1614679458814956/picture?type=large", "display_name": "Tomasz Garbus", "link": "https://stackoverflow.com/users/5208741/tomasz-garbus"}, "reply_to_user": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "edited": false, "score": 0, "creation_date": 1521394674, "post_id": 49350898, "comment_id": 85701626, "body": "To learn how to use the <code>do</code> notation, even if it is not the best solution here."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1521394764, "post_id": 49350898, "comment_id": 85701653, "body": "@TomaszGarbus <code>do</code>-notation is completely irrelevant to what you&#39;re trying to do here. I recommend reading <a href=\"http://learnyouahaskell.com/a-fistful-of-monads\" rel=\"nofollow noreferrer\">the relevant LYAH chapter</a>, since a full explanation of Monads and <code>do</code>-notation is too broad for one question."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1521402392, "post_id": 49350898, "comment_id": 85704338, "body": "It&#39;s not completely irrelevant; it&#39;s just incorrectly mixing monadic operations and <code>map</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1521410637, "post_id": 49350898, "comment_id": 85706767, "body": "Potentially relevant: <a href=\"https://stackoverflow.com/questions/28624408/equal-vs-left-arrow-symbols-in-haskell\" title=\"equal vs left arrow symbols in haskell\">stackoverflow.com/questions/28624408/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 5, "last_activity_date": 1521403669, "last_edit_date": 1521403669, "creation_date": 1521394975, "answer_id": 49351024, "question_id": 49350898, "link": "https://stackoverflow.com/questions/49350898/what-is-the-difference-between-let-in-do-and-notation-in-haskell-monad/49351024#49351024", "title": "What is the difference between `let .. in do` and `&lt;-` notation in Haskell Monads?", "body": "<p><code>ws &lt;- words s</code>, in the list monad, nondeterministically assigns <em>one</em> word from <code>words s</code> to <code>ws</code>; the remaining code simply works with that one word, and the <code>return</code> function \"magically\" combines the results of working on <em>all</em> the words into the result list.</p>\n\n<pre><code>readInts s = do\n   ws &lt;- words s  -- ws represents *each* word in words s\n   return (readMaybe ws)\n</code></pre>\n\n<p>The <code>do</code> notation is just syntactic sugar for using monadic <code>bind</code>:</p>\n\n<pre><code>readInts s = words s &gt;&gt;= (\\ws -&gt; return (readMaybe ws))\n</code></pre>\n\n<p>Without using the <code>Monad</code> instance for lists, you can use <code>map</code> to apply the same function to each word.</p>\n\n<pre><code>readInts s = map readMaybe (words s)\n</code></pre>\n\n<hr>\n\n<p><code>let</code>, on the other hand, simply provides a name for a more complicated expression to be used in another expression. It can be considered syntactic sugar for defining and immediately applying an anonymous function. That is,</p>\n\n<pre><code>let x = y + z in f x\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>(\\x -&gt; f x) (y + z)\n  ^     ^      ^\n  |     |      |\n  |     |      RHS of let binding\n  |     part after \"in\"\n  LHS of let binding\n</code></pre>\n\n<p>A <code>let</code> statement with multiple bindings is equivalent to nested <code>let</code> statements:</p>\n\n<pre><code>let x = y + z\n    a = b + c\nin x + a\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>let x = y + z\nin let a = b + c\n   in x + a\n</code></pre>\n\n<p>which desugars to</p>\n\n<pre><code>(\\x -&gt; (\\a -&gt; x + a)(b + c))(y + z)\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 5208741, "user_type": "registered", "profile_image": "https://graph.facebook.com/1614679458814956/picture?type=large", "display_name": "Tomasz Garbus", "link": "https://stackoverflow.com/users/5208741/tomasz-garbus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "accepted_answer_id": 49351024, "answer_count": 1, "score": 1, "last_activity_date": 1521403669, "creation_date": 1521394361, "last_edit_date": 1521397756, "question_id": 49350898, "link": "https://stackoverflow.com/questions/49350898/what-is-the-difference-between-let-in-do-and-notation-in-haskell-monad", "title": "What is the difference between `let .. in do` and `&lt;-` notation in Haskell Monads?", "body": "<p>I'm trying to implement a function which converts a string to a list of Maybe Ints, e.g. <code>readInts \"1 2 42 foo\" = [Just 1,Just 2,Just 42,Nothing]</code>.</p>\n\n<p>My first aproach was:</p>\n\n<pre><code>readInts (s::String) = do {\n    ws &lt;- words s;\n    return (map (readMaybe::(String -&gt; Maybe Int)) ws)\n}\n</code></pre>\n\n<p>This resulted in the following error:</p>\n\n<pre><code>lab_monad.hs:20:52:\n    Couldn't match type \u2018Char\u2019 with \u2018[Char]\u2019\n    Expected type: [String]\n      Actual type: String\n    In the second argument of \u2018map\u2019, namely \u2018ws\u2019\n    In the first argument of \u2018return\u2019, namely\n      \u2018(map (readMaybe :: String -&gt; Maybe Int) ws)\u2019\nFailed, modules loaded: none.\n</code></pre>\n\n<p>What I tried next (and worked), was:</p>\n\n<pre><code>readInts (s::String) = do {\n    let ws = (words s) in do\n        return (map (readMaybe::(String -&gt; Maybe Int)) ws)\n} \n</code></pre>\n\n<p>My question here is, <code>words s</code> obviously is of type <code>[String]</code>. Why does the interpreter say it is a <code>String</code>? What am I not understanding about <code>&lt;-</code> operator?</p>\n"}, {"tags": ["haskell", "state-monad", "lifting"], "comments": [{"owner": {"reputation": 29052, "user_id": 96233, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/85735330505ef1c84896fcb86491bd0b?s=128&d=identicon&r=PG", "display_name": "Ralph", "link": "https://stackoverflow.com/users/96233/ralph"}, "edited": false, "score": 0, "creation_date": 1521393641, "post_id": 49350572, "comment_id": 85701239, "body": "I think I see my own problem, but have no idea how to solve it. The <code>ST</code> monad is not embedded in a <code>StateT</code> transformer, so the <code>put</code> operation cannot be lifted."}], "answers": [{"comments": [{"owner": {"reputation": 29052, "user_id": 96233, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/85735330505ef1c84896fcb86491bd0b?s=128&d=identicon&r=PG", "display_name": "Ralph", "link": "https://stackoverflow.com/users/96233/ralph"}, "edited": false, "score": 0, "creation_date": 1521392934, "post_id": 49350601, "comment_id": 85700969, "body": "If I move the <code>put 42</code> to the line above the <code>return $ runSTUArray $ do</code>, it compiles and runs properly. I&#39;m just trying to figure out how set the state in the outer <code>State</code> monad from inside the <code>ST</code> monad."}], "tags": [], "owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "is_accepted": false, "score": 0, "last_activity_date": 1521392681, "creation_date": 1521392681, "answer_id": 49350601, "question_id": 49350572, "link": "https://stackoverflow.com/questions/49350572/lifting-a-value-in-the-state-monad-in-haskell/49350601#49350601", "title": "Lifting a value in the State monad in Haskell", "body": "<p><code>solve grid</code> has form <code>return $ ...</code>. This means that <code>State Int (UArray (Int, Int) Cell)</code> is just specialized <code>Monad m =&gt; m (UArray (Int, Int) Cell)</code> - the <code>...</code> does not have access to the features of this specific monad, it's just a <code>UArray (Int, Int) Cell</code> value that you return.</p>\n"}, {"comments": [{"owner": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "edited": false, "score": 0, "creation_date": 1521441763, "post_id": 49355613, "comment_id": 85714193, "body": "FYI <a href=\"https://stackoverflow.com/a/49356530/2303202\">stackoverflow.com/a/49356530/2303202</a> looks possible with arrays"}, {"owner": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "edited": false, "score": 0, "creation_date": 1521497357, "post_id": 49355613, "comment_id": 85747556, "body": "No, signature <code>((forall s . ST s a) -&gt; b)</code> does not match the case of <code>runSTUArray</code>, because <code>a</code> has <code>s</code> in its parameters. So the linked trick would not help - if you try to pass mutable array to another ST extractor it would not compile because of &quot;type variable \u2018s\u2019 would escape its scope&quot;"}], "tags": [], "owner": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "is_accepted": false, "score": 1, "last_activity_date": 1521432054, "creation_date": 1521432054, "answer_id": 49355613, "question_id": 49350572, "link": "https://stackoverflow.com/questions/49350572/lifting-a-value-in-the-state-monad-in-haskell/49355613#49355613", "title": "Lifting a value in the State monad in Haskell", "body": "<p><code>runSTUArray ...</code> is a pure value, it does not know anything about \"outer monad\". And <code>State</code> cares about how you use it, you cannot pass it opaquely into ST.</p>\n\n<p>What you could do:</p>\n\n<p><strong>Option1</strong>: change the whole program to move more logic to ST side. Instead of State you'd use STRef then:</p>\n\n<pre><code>solve :: ST s (STRef Int) -&gt; ST s (UArray (Int, Int) Cell) -&gt; ST s ()\n...\n</code></pre>\n\n<p><strong>Option2</strong>: manually extract it and pass it to ST, then get back and put explicitly. But there is complication. <code>runSTUArray</code> does not allow getting another value together with the array. I don't know how it can be done safely with current array functions. Unsafely you could re-implement better <code>runSTUArray</code> which can pass another value. You could also add fake cells and encode the new state there.</p>\n\n<p>The way to export another value exists in the vector package, there is (in new versions) <code>createT</code> function which can take not bare vector but a structure containing it (or even several vectors). So, overall, your example would be like:</p>\n\n<pre><code>import Control.Monad.State (State, put, get)\nimport Data.Word (Word16)\n\nimport qualified Data.Vector.Unboxed as DVU\n\ntype Cell = Word16\n\nsolve :: DVU.Vector Cell -&gt; State Int (DVU.Vector Cell)\nsolve grid = do\n  oldState &lt;- get\n  let (newState, newGrid) = DVU.createT (do\n          arr &lt;- DVU.thaw grid\n          pure (oldState + 42, arr))\n  put newState\n  pure newGrid\n</code></pre>\n\n<p>vectors are one-dimensional only, unfortunately</p>\n"}, {"tags": [], "owner": {"reputation": 29052, "user_id": 96233, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/85735330505ef1c84896fcb86491bd0b?s=128&d=identicon&r=PG", "display_name": "Ralph", "link": "https://stackoverflow.com/users/96233/ralph"}, "is_accepted": true, "score": 0, "last_activity_date": 1527860008, "creation_date": 1527860008, "answer_id": 50644650, "question_id": 49350572, "link": "https://stackoverflow.com/questions/49350572/lifting-a-value-in-the-state-monad-in-haskell/50644650#50644650", "title": "Lifting a value in the State monad in Haskell", "body": "<p>I was able to get a slight variation to compile and run after changing the <code>State</code> monad to a tuple <code>(Int, Grid)</code>:</p>\n\n<pre><code>import Control.Monad.ST    (ST, runST)\nimport Data.Array.MArray   (freeze, thaw, writeArray)\nimport Data.Array.ST       (STUArray)\nimport Data.Array.Unboxed  (UArray)\nimport Data.Word (Word16)\n\ntype Cell = Word16\ntype Grid = UArray (Int, Int) Cell\n\nsolve :: Grid -&gt; (Int, Grid)\nsolve grid =\n  runST $ do\n    mut &lt;- thaw grid :: ST s (STUArray s (Int, Int) Cell)\n    writeArray mut (0, 0) 0 -- test that I can actually write\n    frozen &lt;- freeze mut\n    return (42, frozen)\n</code></pre>\n\n<p>This works fine for my application.</p>\n"}], "owner": {"reputation": 29052, "user_id": 96233, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/85735330505ef1c84896fcb86491bd0b?s=128&d=identicon&r=PG", "display_name": "Ralph", "link": "https://stackoverflow.com/users/96233/ralph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 471, "favorite_count": 0, "accepted_answer_id": 50644650, "answer_count": 3, "score": 3, "last_activity_date": 1527860008, "creation_date": 1521392500, "question_id": 49350572, "link": "https://stackoverflow.com/questions/49350572/lifting-a-value-in-the-state-monad-in-haskell", "title": "Lifting a value in the State monad in Haskell", "body": "<p>I am writing a Sudoku generator/solver in Haskell as a learning exercise.</p>\n\n<p>My <code>solve</code> function takes in a <code>UArray</code> but returns a <code>State Int (UArray ...)</code> so that it can also return the maximum difficulty level that it found while solving.</p>\n\n<p>This is my function so far (still in the very experimental early stage):</p>\n\n<pre><code>import Control.Monad.State       (State, put)\nimport Control.Monad.Trans.Class (lift)\nimport Data.Array.MArray         (thaw)\nimport Data.Array.ST             (runSTUArray)\nimport Data.Array.Unboxed        (UArray)\n\n-- ...\n\ntype Cell = Word16\n\nsolve :: UArray (Int, Int) Cell -&gt; State Int (UArray (Int, Int) Cell)\nsolve grid = do\n  return $ runSTUArray $ do\n    arr &lt;- thaw grid\n    lift $ put 42\n    return arr\n</code></pre>\n\n<p>It does not really do anything with the mutable array yet. I am simply trying to get it to type check with the <code>put 42</code>, but currently get the following error:</p>\n\n<pre><code>  \u2022 Couldn't match kind \u2018*\u2019 with \u2018* -&gt; *\u2019\n    When matching the kind of \u2018ST\u2019\n  \u2022 In a stmt of a 'do' block: lift $ put 42\n    In the second argument of \u2018($)\u2019, namely\n      \u2018do arr &lt;- thaw grid\n          lift $ put 42\n          return arr\u2019\n    In the second argument of \u2018($)\u2019, namely\n      \u2018runSTUArray\n         $ do arr &lt;- thaw grid\n              lift $ put 42\n              return arr\u2019\n     |\n 128 |     lift $ put 42\n     |     ^^^^^^^^^^^^^\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2031, "user_id": 670339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942f0170639d3fd6d2bd3a2ce057e3e7?s=128&d=identicon&r=PG", "display_name": "Marc Talbot", "link": "https://stackoverflow.com/users/670339/marc-talbot"}, "edited": false, "score": 0, "creation_date": 1521385016, "post_id": 49348586, "comment_id": 85698301, "body": "How are you displaying the other things that are related to each film?  You have a function that gets the rating of a film, and you have a function that displays the attributes of a film that you care about.  Use the first in conjunction with the second?"}, {"owner": {"reputation": 17, "user_id": 9469859, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "sam786", "link": "https://stackoverflow.com/users/9469859/sam786"}, "reply_to_user": {"reputation": 2031, "user_id": 670339, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/942f0170639d3fd6d2bd3a2ce057e3e7?s=128&d=identicon&r=PG", "display_name": "Marc Talbot", "link": "https://stackoverflow.com/users/670339/marc-talbot"}, "edited": false, "score": 0, "creation_date": 1521391086, "post_id": 49348586, "comment_id": 85700295, "body": "in my Film type I have (String,String,Int,[Likes],[Dislikes]) . How do I add a function at the end of my tuple"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 0, "last_activity_date": 1521394214, "creation_date": 1521394214, "answer_id": 49350879, "question_id": 49348586, "link": "https://stackoverflow.com/questions/49348586/i-want-to-the-website-rating-to-the-list-how-do-i-do-this/49350879#49350879", "title": "I want to the website rating to the list, how do I do this?", "body": "<p>Perhaps you are looking for something like this, whole result is a set of pairs comprising the film and the rating.</p>\n\n<pre><code>rating:: [Film] -&gt; [(Film, Int)]\nrating films = [ (film, rating) \n   | film &lt;- films , let rating = websiteRating film, rating &gt;=75 ]\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9469859, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "sam786", "link": "https://stackoverflow.com/users/9469859/sam786"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 49350879, "answer_count": 1, "score": -1, "last_activity_date": 1521394214, "creation_date": 1521380819, "question_id": 49348586, "link": "https://stackoverflow.com/questions/49348586/i-want-to-the-website-rating-to-the-list-how-do-i-do-this", "title": "I want to the website rating to the list, how do I do this?", "body": "<pre><code>userRate :: Film -&gt; Float\nuserRate (_,_,_,[],[]) = 0\nuserRate (_,_,_,likes,dislikes) = fromIntegral(length likes)/fromIntegral(length likes + length dislikes)* 100\n</code></pre>\n\n<p>--- function that rounds user ratings </p>\n\n<pre><code>websiteRating :: Film -&gt; Int\nwebsiteRating film = round(userRate (film)) \n</code></pre>\n\n<p>-- function uses list comprehensions to filter films with website ratings 75 and above </p>\n\n<pre><code>rating:: [Film] -&gt; [Film]\nrating films = [ film | film &lt;-films , websiteRating film &gt;=75] \n</code></pre>\n\n<p>I have created a function that is giving me a list of films and only those films that are displayed with a website rating above 75, but I want to add the website rating next to the films</p>\n\n<p>for example this is what is displayed</p>\n\n<pre><code>Title: Silence\nDirector: Martin Scorsese\nYear:2016\nWebsite Rating : 76\n\n\n\nTitle: The Terminal\nDirector: Steven Spielberg\nYear:2004\nWebsite Rating : 76%\n</code></pre>\n\n<p>I want to display the website rating in the list to how do I do this?\nThanks</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 4235, "user_id": 1518183, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/822d321afa518348af0f484e24eef47c?s=128&d=identicon&r=PG", "display_name": "user1518183", "link": "https://stackoverflow.com/users/1518183/user1518183"}, "edited": false, "score": 0, "creation_date": 1521378219, "post_id": 49348124, "comment_id": 85695960, "body": "Thank you, I forgot them (edited my answer). However, it still takes two calls to fully simplify the expression."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 4235, "user_id": 1518183, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/822d321afa518348af0f484e24eef47c?s=128&d=identicon&r=PG", "display_name": "user1518183", "link": "https://stackoverflow.com/users/1518183/user1518183"}, "edited": false, "score": 0, "creation_date": 1521378375, "post_id": 49348124, "comment_id": 85696009, "body": "Ah, yes, apologies, I see the problem. You need to simplify the children <i>before</i> you look for the pattern. I&#39;ll update the answer, bear with me..."}, {"owner": {"reputation": 4235, "user_id": 1518183, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/822d321afa518348af0f484e24eef47c?s=128&d=identicon&r=PG", "display_name": "user1518183", "link": "https://stackoverflow.com/users/1518183/user1518183"}, "edited": false, "score": 0, "creation_date": 1521379443, "post_id": 49348124, "comment_id": 85696364, "body": "It&#39;s working, thank you very much for your time! This answer is perfect."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 4235, "user_id": 1518183, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/822d321afa518348af0f484e24eef47c?s=128&d=identicon&r=PG", "display_name": "user1518183", "link": "https://stackoverflow.com/users/1518183/user1518183"}, "edited": false, "score": 0, "creation_date": 1521379534, "post_id": 49348124, "comment_id": 85696404, "body": "Happy to help \ud83d\ude09"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1521443754, "post_id": 49348124, "comment_id": 85715029, "body": "This looks like it might be a good application of recursion schemes (specifically <code>cata</code>). I&#39;m not sure the full power of <code>Plated</code> is necessary or helpful here."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1521463381, "post_id": 49348124, "comment_id": 85726608, "body": "@dfeuer Genuine question: what makes you say that? I personally find <code>Plated</code> (and especially its progenitor <code>uniplate</code>, which doesn\u2019t have all the <code>lens</code>y vocabulary) significantly simpler than <code>recursion-schemes</code> because it doesn\u2019t have all the <code>Fix</code>/corecusrion/<code>Comonad</code>/distributive law stuff, nor does it require you to write your datatype in a particular way (though I believe <code>recursion-schemes</code> has some TH helpers these days?). Also I believe <code>recursion-schemes</code>\u2019s way of looking at the world is strictly more powerful than <code>uniplate</code>\u2019s (eg you can\u2019t write <code>cata</code> using <code>uniplate</code>)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1521478313, "post_id": 49348124, "comment_id": 85737455, "body": "@BenjaminHodgson, <code>Data</code> always confuses me."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 5, "last_activity_date": 1521478143, "last_edit_date": 1521478143, "creation_date": 1521377829, "answer_id": 49348124, "question_id": 49348103, "link": "https://stackoverflow.com/questions/49348103/haskell-recursion-from-leafs-to-root/49348124#49348124", "title": "Haskell: recursion from leafs to root", "body": "<p>Firstly, you're missing a couple of recursive calls. In these lines:</p>\n\n<pre><code>simplify (Multiply (Constant 1) e) = e\nsimplify (Multiply e (Constant 1)) = e\n</code></pre>\n\n<p>You should replace the right-hand side with <code>simplify e</code>.</p>\n\n<pre><code>simplify (Multiply (Constant 1) e) = simplify e\nsimplify (Multiply e (Constant 1)) = simplify e\n</code></pre>\n\n<p>Now to rewrite the expression from the bottom up. The problem is that you're looking for simplification patterns on the left-hand side of your equation, ie, before you simplify the children. You need to simplify the children first, and then look for the pattern.</p>\n\n<pre><code>simplify :: Expr -&gt; Expr\nsimplify (Add x y) =\n    case (simplify x, simplify y) of\n        (Constant 0, e) -&gt; e\n        (e, Constant 0) -&gt; e\n        (Constant a, Constant b) -&gt; Constant (a + b)\n        (x1, y1) -&gt; Add x1 y1\nsimplify (Multiply x y) =\n    case (simplify x, simplify y) of\n        (Constant 0, _) -&gt; Constant 0\n        (_, Constant 0) -&gt; Constant 0\n        (Constant 1, e) -&gt; e\n        (e, Constant 1) -&gt; e\n        (Constant a, Constant b) -&gt; Constant (a * b)\n        (x1, y1) -&gt; Multiply x1 y1\nsimplify e = e\n</code></pre>\n\n<p>On the left-hand side of the equation, we find the children of the current node. On the right, we look for patterns in the simplified children. One way of improving this code is to separate the two responsibilities of finding-and-replacing children and of matching simplification patterns. Here's a general function to recursively replace every subtree of an <code>Expr</code>:</p>\n\n<pre><code>transform :: (Expr -&gt; Expr) -&gt; Expr -&gt; Expr\ntransform f (Add x y) = f $ Add (transform f x) (transform f y)\ntransform f (Multiply x y) = f $ Multiply (transform f x) (transform f y)\ntransform f e = f e\n</code></pre>\n\n<p><code>transform</code> takes a (non-recursive) transformation function which calculates a replacement for a single-node pattern, and recursively applies it to every node in the tree in a bottom-up manner. To write a transformation function, you just look for the interesting patterns and forget about recursively rewriting the children.</p>\n\n<pre><code>simplify = transform f\n    where\n        f (Add (Constant 0) e) = e\n        f (Add e (Constant 0)) = e\n        f (Add (Constant a) (Constant b)) = Constant (a + b)\n        f (Multiply (Constant 0) _) = Constant 0\n        f (Multiply _ (Constant 0)) = Constant 0\n        f (Multiply (Constant 1) e) = e\n        f (Multiply e (Constant 1)) = e\n        f (Multiply (Constant a) (Constant b)) = Constant (a * b)\n        f e = e\n</code></pre>\n\n<p>Since <code>f</code>'s argument has already had its children rewritten by <code>transform</code>, we don't need to exhaustively match every possible pattern or explicitly recurse through the value. We look for the ones we care about, and nodes which don't need transforming fall through to the catch-all <code>f e = e</code> case.</p>\n\n<p>Generic programming libraries like <a href=\"https://hackage.haskell.org/package/lens\" rel=\"nofollow noreferrer\"><code>lens</code></a>'s <a href=\"https://hackage.haskell.org/package/lens-4.15.4/docs/Control-Lens-Plated.html\" rel=\"nofollow noreferrer\"><code>Plated</code> module</a> take programming patterns like <code>transform</code> and make them universal. You (or the compiler) write a small amount of code characterising the shape of your datatype, and the library implements recursive higher-order functions like <code>transform</code> once and for all.</p>\n"}, {"comments": [{"owner": {"reputation": 4235, "user_id": 1518183, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/822d321afa518348af0f484e24eef47c?s=128&d=identicon&r=PG", "display_name": "user1518183", "link": "https://stackoverflow.com/users/1518183/user1518183"}, "edited": false, "score": 0, "creation_date": 1521549728, "post_id": 49382084, "comment_id": 85769777, "body": "Thank you. This answer was really helpful. Also, I finally have a clue what the heck is a catamorphism."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1521552427, "post_id": 49382084, "comment_id": 85771825, "body": "Worth noting that <code>transform</code> from <a href=\"https://stackoverflow.com/a/49348124/1523776\">my answer</a> is a special case of <code>cata</code> (since <code>ExprF Expr ~~ Expr</code>). Exercise: implement <code>transform</code> in terms of <code>cata</code>"}], "tags": [], "owner": {"reputation": 1496, "user_id": 7350814, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bd7e1bdad619c54ab51e05ff9cfaa199?s=128&d=identicon&r=PG&f=1", "display_name": "Jogger", "link": "https://stackoverflow.com/users/7350814/jogger"}, "is_accepted": false, "score": 1, "last_activity_date": 1521543120, "last_edit_date": 1521543120, "creation_date": 1521542563, "answer_id": 49382084, "question_id": 49348103, "link": "https://stackoverflow.com/questions/49348103/haskell-recursion-from-leafs-to-root/49382084#49382084", "title": "Haskell: recursion from leafs to root", "body": "<p>Simplifying expression ASTs is a typical application for the recursion scheme called <em>catamorphism</em>. Here is an example with the <a href=\"http://hackage.haskell.org/package/recursion-schemes\" rel=\"nofollow noreferrer\">recursion-schemes</a> library from Edwald Kmett:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE DeriveFunctor #-} \n{-# LANGUAGE DeriveFoldable #-} \n{-# LANGUAGE DeriveTraversable #-}\n{-# LANGUAGE TemplateHaskell #-}\n\nmodule CataExprSimplify where\n\nimport Data.Functor.Foldable\nimport Data.Functor.Foldable.TH\n\ndata Expr = Constant Int\n          | Variable String\n          | Add Expr Expr\n          | Multiply Expr Expr\n          deriving (Show)\n\n-- | Generate the base functor\nmakeBaseFunctor ''Expr \n\nsimplify :: Expr -&gt; Expr \nsimplify = cata $ algSimplAdd . project . algSimplMult\n\n-- | Simplify Addition\nsimplZero :: Expr -&gt; Expr \nsimplZero = cata algSimplAdd\n\nalgSimplAdd :: ExprF Expr -&gt; Expr \nalgSimplAdd (AddF (Constant 0) r) = r \nalgSimplAdd (AddF l (Constant 0)) = l \nalgSimplAdd (AddF (Constant l) (Constant r)) = Constant (l + r)\nalgSimplAdd x  = embed x\n\n-- | Simplify Multiplication\nsimplMult :: Expr -&gt; Expr \nsimplMult = cata algSimplMult\n\nalgSimplMult :: ExprF Expr -&gt; Expr \nalgSimplMult (MultiplyF (Constant 1) r) = r\nalgSimplMult (MultiplyF l (Constant 1)) = l \nalgSimplMult (MultiplyF (Constant 0) _) = Constant 0\nalgSimplMult (MultiplyF _ (Constant 0)) = Constant 0 \nalgSimplMult (MultiplyF (Constant l) (Constant r)) = Constant (l * r)\nalgSimplMult x = embed x\n</code></pre>\n\n<p>It has the following advantages over code that uses direct recursion calls: </p>\n\n<ul>\n<li>Recursion is abstracted out to the cata function and not intertwinned with your simplification logic.</li>\n<li>You will not forget to call simplify on subexpressions.</li>\n<li>Catamorphisms work from bottom to top.</li>\n<li>Simplification of Addition and Multiplication can be written in separate functions.</li>\n<li>it's much easier to maintain your code if you have to extend your AST (eg adding new constructors)</li>\n</ul>\n\n<p>If you want to read more about recursion schemes read this <a href=\"http://blog.sumtypeofway.com/an-introduction-to-recursion-schemes/\" rel=\"nofollow noreferrer\">blog post series</a></p>\n"}], "owner": {"reputation": 4235, "user_id": 1518183, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/822d321afa518348af0f484e24eef47c?s=128&d=identicon&r=PG", "display_name": "user1518183", "link": "https://stackoverflow.com/users/1518183/user1518183"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 1, "accepted_answer_id": 49348124, "answer_count": 2, "score": 3, "last_activity_date": 1521543120, "creation_date": 1521377623, "last_edit_date": 1521379637, "question_id": 49348103, "link": "https://stackoverflow.com/questions/49348103/haskell-recursion-from-leafs-to-root", "title": "Haskell: recursion from leafs to root", "body": "<p>I have a AST of elementary math arithmetic expressions:</p>\n\n<pre><code>data Expr = Constant Int\n          | Variable String\n          | Add Expr Expr\n          | Multiply Expr Expr\n          deriving (Show)\n</code></pre>\n\n<p>I also have a really simple function which simplify given expression:</p>\n\n<pre><code>simplify :: Expr -&gt; Expr\nsimplify (Add (Constant 0) e) = simplify e\nsimplify (Add e (Constant 0)) = simplify e\nsimplify (Add (Constant a) (Constant b)) = Constant (a + b)\nsimplify (Add e1 e2) = Add (simplify e1) (simplify e2)\nsimplify (Multiply (Constant 0) _) = Constant 0\nsimplify (Multiply _ (Constant 0)) = Constant 0\nsimplify (Multiply (Constant 1) e) = e\nsimplify (Multiply e (Constant 1)) = e\nsimplify (Multiply (Constant a) (Constant b)) = Constant (a * b)\nsimplify (Multiply e1 e2) = Multiply (simplify e1) (simplify e2)\nsimplify e = e\n</code></pre>\n\n<p>Unfortunately, this function is not very effective, because it simplify expression from root to leafs (from top to bottom). Consider this expression:</p>\n\n<pre><code>exampleExpr :: Expr\nexampleExpr = Add\n                (Multiply (Constant 1) (Variable \"redrum\"))\n                (Multiply (Constant 0) (Constant 451))\n</code></pre>\n\n<p>It cost two function calls (<code>simplify (simplify exampleExpr)</code>) to reduce this expression into <code>Variable \"redrum\"</code>. With bottom up approach, it should cost only one function call.</p>\n\n<p>I'm not experienced enough yet to be able to write this code effectively. So my question is: <strong>how to rewrite this function to simplify given expression from leafs to root (bottom to top)?</strong></p>\n"}, {"tags": ["haskell", "cabal", "haskell-stack"], "comments": [{"owner": {"reputation": 7576, "user_id": 480398, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3468d23f15a9f631136b508b967b0fbe?s=128&d=identicon&r=PG", "display_name": "hvr", "link": "https://stackoverflow.com/users/480398/hvr"}, "edited": false, "score": 0, "creation_date": 1521383867, "post_id": 49347790, "comment_id": 85697861, "body": "Is there a specific reason you&#39;re using Stack rather than the standard <code>cabal</code> tooling? Note also that you don&#39;t need to set <code>cabal-version: 2.2</code> unless you need features (such as e.g. &quot;<code>common</code> Stanzas&quot; or the new <code>elif</code> keyword) for your package specification that are only available with that cabal spec-version. C.f. <a href=\"http://cabal.readthedocs.io/en/latest/cabal-projectindex.html\" rel=\"nofollow noreferrer\">cabal.readthedocs.io/en/latest/cabal-projectindex.html</a>"}, {"owner": {"reputation": 24109, "user_id": 775954, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9f5a87db35489d2958945f35b457f1ee?s=128&d=identicon&r=PG", "display_name": "Matthias Braun", "link": "https://stackoverflow.com/users/775954/matthias-braun"}, "reply_to_user": {"reputation": 7576, "user_id": 480398, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3468d23f15a9f631136b508b967b0fbe?s=128&d=identicon&r=PG", "display_name": "hvr", "link": "https://stackoverflow.com/users/480398/hvr"}, "edited": false, "score": 0, "creation_date": 1521385000, "post_id": 49347790, "comment_id": 85698293, "body": "The <code>common</code> stanzas are the very motivation I&#39;d like to upgrade to <code>2.2</code>. I have no reason to use Stack, apart from the <a href=\"http://haskellbook.com/\" rel=\"nofollow noreferrer\">Haskell book</a> recommending it."}], "answers": [{"comments": [{"owner": {"reputation": 24109, "user_id": 775954, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9f5a87db35489d2958945f35b457f1ee?s=128&d=identicon&r=PG", "display_name": "Matthias Braun", "link": "https://stackoverflow.com/users/775954/matthias-braun"}, "edited": false, "score": 0, "creation_date": 1521385269, "post_id": 49348506, "comment_id": 85698396, "body": "Thanks for your answer! I don&#39;t have a pressing need to upgrade Cabal to <code>2.2</code>; I was merely interested in simplifying my Cabal file using the <code>common</code> stanzas introduced in <code>2.2</code>. For now I&#39;ll postpone upgrading Cabal (or abandoning Stack)."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 3, "last_activity_date": 1521385200, "last_edit_date": 1521385200, "creation_date": 1521380361, "answer_id": 49348506, "question_id": 49347790, "link": "https://stackoverflow.com/questions/49347790/stack-setup-upgrade-cabal-fails-cant-find-text-parsec/49348506#49348506", "title": "&quot;stack setup --upgrade-cabal&quot; fails, can&#39;t find Text.Parsec", "body": "<p>The problem you describe happens because:</p>\n\n<ol>\n<li><p><em>Cabal</em> 2.2.0.0, unlike the earlier versions, has <em>parsec</em> as a dependency. To account for that, <a href=\"https://downloads.haskell.org/%7Eghc/8.4.1/docs/html/users_guide/8.4.1-notes.html#included-libraries\" rel=\"nofollow noreferrer\"><em>parsec</em> is one of the core packages bundled with GHC from GHC 8.4.1 onwards</a>.</p></li>\n<li><p><code>stack setup --upgrade-cabal</code> installs <em>Cabal</em> at a \"global\" level, which is cross-snapshot but tied to the GHC version. As a consequence, it only uses packages bundled with GHC (as opposed to packages in any snapshot). See <a href=\"https://github.com/commercialhaskell/stack/issues/3049\" rel=\"nofollow noreferrer\">Stack issue #3049</a> and the other issues linked therein for discussion of this point.</p></li>\n</ol>\n\n<p>That being so, I believe there is no solution to this issue, unless you are willing to change your project to a resolver/snapshot that uses GHC 8.4.1.</p>\n\n<p>P.S.: Unless you need a specific <em>Cabal</em> feature or bugfix included in 2.2.0.0, you may want to reconsider whether you actually want to upgrade <em>Cabal</em>. Quoting the <a href=\"https://docs.haskellstack.org/en/stable/GUIDE/#power-user-commands\" rel=\"nofollow noreferrer\">Stack user guide</a>:</p>\n\n<blockquote>\n  <p><code>stack setup --upgrade-cabal</code> can install a newer version of the Cabal library, used for performing actual builds. You shouldn't generally do this, since new Cabal versions may introduce incompatibilities with package sets, but it can be useful if you're trying to test a specific bugfix.</p>\n</blockquote>\n"}], "owner": {"reputation": 24109, "user_id": 775954, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9f5a87db35489d2958945f35b457f1ee?s=128&d=identicon&r=PG", "display_name": "Matthias Braun", "link": "https://stackoverflow.com/users/775954/matthias-braun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 49348506, "answer_count": 1, "score": 3, "last_activity_date": 1521385200, "creation_date": 1521375537, "last_edit_date": 1521376171, "question_id": 49347790, "link": "https://stackoverflow.com/questions/49347790/stack-setup-upgrade-cabal-fails-cant-find-text-parsec", "title": "&quot;stack setup --upgrade-cabal&quot; fails, can&#39;t find Text.Parsec", "body": "<p>After creating a new project using <code>stack new testProject</code>, I have edited <code>testProject.cabal</code> to use the latest version of Cabal:</p>\n\n<pre><code>cabal-version:  2.2.0.0\n</code></pre>\n\n<p>Running <code>stack setup --upgrade-cabal</code> afterwards produces an error:</p>\n\n<pre><code>[ 12 of 216] Compiling Distribution.Compat.Parsing ( Distribution/Compat/Parsing.hs, Distribution/Compat/Parsing.o )\n\nDistribution/Compat/Parsing.hs:61:1: error:\n    Could not find module \u2018Text.Parsec\u2019\n    Use -v to see a list of the files searched for.\n   |\n61 | import qualified Text.Parsec as Parsec\n   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nExit code ExitFailure 1 while running [\"ghc\",\"Setup.hs\"] in /tmp/stack-cabal-upgrade30389/Cabal-2.2.0.0/\n</code></pre>\n\n<p>I'm on Arch Linux 4.15.3, <code>stack --version</code> gives</p>\n\n<pre><code>Version 1.6.3, Git revision b27e629b8c4ce369e3b8273f04db193b060000db (5454 commits) x86_64 hpack-0.20.0\n</code></pre>\n\n<p><code>stack ghc -- --version</code>:</p>\n\n<pre><code>The Glorious Glasgow Haskell Compilation System, version 8.2.2\n</code></pre>\n\n<p>How can I get around this error and upgrade Cabal using Stack?</p>\n"}, {"tags": ["haskell", "quickcheck"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 3105565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f06b9237fcd210145f87d9db855c3e25?s=128&d=identicon&r=PG&f=1", "display_name": "schmauss", "link": "https://stackoverflow.com/users/3105565/schmauss"}, "edited": false, "score": 0, "creation_date": 1521508428, "post_id": 49347801, "comment_id": 85750912, "body": "Thanks for your answer! I can see how I can change this to use polymorphic types and create a ContextArbitrary typeclass out of this"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 2, "last_activity_date": 1521375595, "creation_date": 1521375595, "answer_id": 49347801, "question_id": 49343774, "link": "https://stackoverflow.com/questions/49343774/context-sensitive-generation-using-quick-check/49347801#49347801", "title": "context-sensitive generation using quick check", "body": "<p>It's possible, though not really sane, to do this from within <code>arbitrary</code>. But if you step out of <code>arbitrary</code>, you can <em>literally</em> just pass an extra parameter around.</p>\n\n<pre><code>-- do whatever you want inside the implementation of these two\nchooseIntRange :: Context -&gt; Int\nupdateContext :: Int -&gt; Context -&gt; Context\n\narbitraryIntWithContext :: Context -&gt; Gen (Context, Int)\narbitraryIntWithContext ctx = do\n    n &lt;- choose (0, chooseIntRange ctx)\n    return (n, updateContext n ctx)\n</code></pre>\n\n<p>The plumbing of the context can be relieved somewhat with <code>StateT</code>, e.g.</p>\n\n<pre><code>-- do whatever you want inside the implementation of this\nchooseIntRangeAndUpdate :: MonadState Context m =&gt; m Int\n\narbitraryIntStateT :: StateT Context Gen Int\narbitraryIntStateT = do\n    hi &lt;- chooseIntRangeAndUpdate\n    lift (choose (0, hi))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": false, "score": 1, "last_activity_date": 1523730052, "last_edit_date": 1523730052, "creation_date": 1523726489, "answer_id": 49834168, "question_id": 49343774, "link": "https://stackoverflow.com/questions/49343774/context-sensitive-generation-using-quick-check/49834168#49834168", "title": "context-sensitive generation using quick check", "body": "<p>While Daniel Wagner has supplied a fine answer for QuickCheck (+1), it also highlights one of QuickCheck's weaknesses. In QuickCheck, one writes properties using instances of <code>Arbitrary</code>, but due to its design, <code>Arbitrary</code> isn't monadic.</p>\n\n<p>The workaround that Daniel Wagner shares is that <code>Gen</code>, on the other hand, <em>is</em> monadic, so that you can write context-dependent code using <code>do</code> notation. The disadvantage is that while you can convert a <code>Gen a</code> to an <code>Arbitrary a</code>, you'll either have to provide a custom <code>shrink</code> implementation, or forgo shrinking.</p>\n\n<p>An alternative library for property-based testing, <a href=\"https://hackage.haskell.org/package/hedgehog\" rel=\"nofollow noreferrer\">Hedgehog</a>, is designed in such a way that properties themselves are monadic, which means you'd be able to write an entire property and simply embed ad-hoc context-specific value generation (including shrinking) in the test code itself:</p>\n\n<pre><code>propWithContext :: Property\npropWithContext = property $ do\n  ctx &lt;- forAll genContext\n  n &lt;- forAll $ Gen.integral $ Range.linear 0 $ chooseIntRange ctx\n  let ctx' = updateContext n ctx\n\n  -- Exercise SUT and verify result here...\n</code></pre>\n\n<p>Here, <code>genContext</code> is a custom generator for the <code>Context</code> type, with the type</p>\n\n<pre><code>genContext :: MonadGen m =&gt; m Context\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 3105565, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f06b9237fcd210145f87d9db855c3e25?s=128&d=identicon&r=PG&f=1", "display_name": "schmauss", "link": "https://stackoverflow.com/users/3105565/schmauss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 49347801, "answer_count": 2, "score": 1, "last_activity_date": 1523730052, "creation_date": 1521337834, "question_id": 49343774, "link": "https://stackoverflow.com/questions/49343774/context-sensitive-generation-using-quick-check", "title": "context-sensitive generation using quick check", "body": "<p>I would like to generate random terms based on some sort of \"context\" and I was wondering if this is possible using quickcheck. Basically I would like to have an additional data type passed around so that the arbitrary function can generate terms based on the additional parameter... Is this possible with quickcheck or should I just write my own definition of Gen?</p>\n"}, {"tags": ["http", "haskell", "exception", "type-safety", "haskell-pipes"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1521338651, "post_id": 49343090, "comment_id": 85687931, "body": "You can make basically any function throw an exception when it evaluates one of the inputs which makes the whole task hazier.    The inability to get a perfect tool doesn&#39;t mean a useful tool couldn&#39;t be created that could warn about many exceptions, but I don&#39;t know of any such tool.  Liquid Haskell&#39;s totality checker does this in part but bundled with so much else that I&#39;m not sure you can leverage it efficiently."}, {"owner": {"reputation": 245, "user_id": 2876621, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/650ba306ddafcfe1455b475dec402c3d?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/2876621/craig"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1521341834, "post_id": 49343090, "comment_id": 85688358, "body": "Thanks for the ideas -- if no one else is doing it, I might do it myself. Do you know of any reason why this isn&#39;t in the type system like it is in Java?"}, {"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1521342244, "post_id": 49343090, "comment_id": 85688419, "body": "It is just like Java - If you have a value of type <code>ExceptT e IO a</code>, then the <code>e</code> corresponds to the Java checked exceptions, and any other exceptions correspond to the Java unchecked exceptions."}, {"owner": {"reputation": 245, "user_id": 2876621, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/650ba306ddafcfe1455b475dec402c3d?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/2876621/craig"}, "edited": false, "score": 0, "creation_date": 1521346229, "post_id": 49343090, "comment_id": 85688963, "body": "Not quite. <a href=\"https://hackage.haskell.org/package/http-conduit-2.3.0/docs/Network-HTTP-Conduit.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/http-conduit-2.3.0/docs/&hellip;</a> simpleHttp can throw exceptions, but it&#39;s not documented anywhere on the type"}, {"owner": {"reputation": 831, "user_id": 3371760, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/09370cd5d499c9f0f75b54aa1b4daa17?s=128&d=identicon&r=PG", "display_name": "Fried Brice", "link": "https://stackoverflow.com/users/3371760/fried-brice"}, "edited": false, "score": 1, "creation_date": 1521358560, "post_id": 49343090, "comment_id": 85690897, "body": "And in Java, anything can throw a <code>RuntimeException</code>, and that&#39;s not documented in the types. It comes down to community standards. My recommendation on finding libraries that violate the community standards (which in Haskell would be &quot;don&#39;t throw when you can simply pass back structured data&quot;) would be to avoid using them."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 831, "user_id": 3371760, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/09370cd5d499c9f0f75b54aa1b4daa17?s=128&d=identicon&r=PG", "display_name": "Fried Brice", "link": "https://stackoverflow.com/users/3371760/fried-brice"}, "edited": false, "score": 2, "creation_date": 1521390268, "post_id": 49343090, "comment_id": 85700023, "body": "@FriedBrice I&#39;ve argued that before with library authors without success.  It turns out people prize easy of development over pure APIs.  Using exceptions instead of sum types is the norm for major libraries such as cryptonite as well as low level libraries like network."}, {"owner": {"reputation": 831, "user_id": 3371760, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/09370cd5d499c9f0f75b54aa1b4daa17?s=128&d=identicon&r=PG", "display_name": "Fried Brice", "link": "https://stackoverflow.com/users/3371760/fried-brice"}, "edited": false, "score": 1, "creation_date": 1521391575, "post_id": 49343090, "comment_id": 85700504, "body": "@ThomasMDuBuisson This is truely a sad state of affairs. Whose &quot;ease of development&quot; does it support? Certainly not the library consumers."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1521416382, "post_id": 49343090, "comment_id": 85708165, "body": "The author is talking about functions in <code>IO</code>. It&#39;s not accurate to say that APIs with <code>... -&gt; IO (Either SomeErrorType a)</code> align to an accepted &quot;community standard&quot;. Some people prefer that, while  some consider it an anti-pattern. Personally I think both can be useful."}], "answers": [{"tags": [], "owner": {"reputation": 245, "user_id": 2876621, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/650ba306ddafcfe1455b475dec402c3d?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/2876621/craig"}, "is_accepted": false, "score": 0, "last_activity_date": 1521509629, "creation_date": 1521509629, "answer_id": 49375042, "question_id": 49343090, "link": "https://stackoverflow.com/questions/49343090/how-do-i-know-where-in-my-haskell-program-an-exception-can-be-thrown/49375042#49375042", "title": "How do I know where in my Haskell Program an Exception can be Thrown?", "body": "<p>Just answering my own question as it stands in 2018. Hopefully this will improve over time.</p>\n\n<p>At compile-time, there is no way to know which parts of your Haskell program can throw exceptions. Some libraries choose to return Either/Maybe monads to deal with edge cases safely and others choose to throw exceptions.</p>\n\n<p>Personally, I believe this makes Haskell a lot less attractive to run in production, especially since these exceptions will rarely have stack traces.</p>\n"}], "owner": {"reputation": 245, "user_id": 2876621, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/650ba306ddafcfe1455b475dec402c3d?s=128&d=identicon&r=PG&f=1", "display_name": "Craig", "link": "https://stackoverflow.com/users/2876621/craig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 159, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1521509629, "creation_date": 1521330495, "question_id": 49343090, "link": "https://stackoverflow.com/questions/49343090/how-do-i-know-where-in-my-haskell-program-an-exception-can-be-thrown", "title": "How do I know where in my Haskell Program an Exception can be Thrown?", "body": "<p>I'm working on a 1-10k line personal Haskell project, and I'm using various IO-libraries such as Network.HTTP.Conduit inside workers spawned with Pipes.Concurrent.</p>\n\n<p>I just realized that some of these IO libraries are throwing exceptions in edge cases. </p>\n\n<p>Is there any way for GHC to give me compile-time warnings about uncaught exceptions? What is the best way to find out the exceptions a library can throw?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["parsing", "haskell", "pattern-matching", "abstract-syntax-tree", "happy"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 2, "creation_date": 1521334917, "post_id": 49343035, "comment_id": 85687245, "body": "My advice is to learn how to write these functions using explicit recursion and pattern matching before you graduate to advanced techniques like generics."}], "owner": {"reputation": 11, "user_id": 7891692, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b416ffe05b5f3ab5d6322e91a87614d2?s=128&d=identicon&r=PG&f=1", "display_name": "Sheldor", "link": "https://stackoverflow.com/users/7891692/sheldor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 292, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1521329985, "creation_date": 1521329985, "question_id": 49343035, "link": "https://stackoverflow.com/questions/49343035/traversing-and-pattern-matching-an-abstract-syntax-tree", "title": "Traversing and Pattern Matching an Abstract Syntax Tree", "body": "<p>I've built a parser and lexer with Alex and Happy which produces and abstract syntax tree of the language I'm parsing (Solidity). My problem now is how I properly traverse and match certain aspects of the language. The aim is to \ncreate a rule engine which will perform code analysis on the resulting AST, checking for specific issues like improper uses of functions, dangerous calls or the lacking of certain elements. </p>\n\n<p>This is the layout of my data, which happy outputs as the AST. <em>(This isn't the full AST but just a snapshot</em>)</p>\n\n<pre><code> data SourceUnit = SourceUnit PragmaDirective\n                  | ImportUnit ImportDirective \n                  | ContractDef ContractDefinition\n                  deriving (Show, Eq, Data, Typeable, Ord)\n\n  -- Version Information\n  data PragmaDirective = PragmaDirective PragmaName Version Int\n                        deriving(Show, Eq, Data, Typeable, Ord)\n\n  data Version = Version String \n                deriving (Show, Eq, Data, Typeable, Ord)\n\n  data PragmaName = PragmaName Ident\n                    deriving(Show, Eq, Typeable, Data, Ord)\n\n  data PragmaValue = PragmaValue Dnum\n                    deriving(Show, Eq, Data, Typeable, Ord)\n  -- File imports/Contract Imports\n  data ImportDirective = ImportDir String\n                      | ImportMulti Identifier Identifier Identifier String \n                        deriving (Show, Eq, Data, Typeable, Ord)\n\n  -- The definition of an actual Contract Code Block\n  data ContractDefinition = Contract Identifier [InheritanceSpec] [ContractConts]\n                            deriving (Show, Eq, Data, Typeable, Ord)\n\n  data ContractConts = StateVarDec StateVarDeclaration\n               | FunctionDefinition FunctionDef\n               | UsingFor UsingForDec\n               deriving (Show, Eq, Data, Typeable, Ord)\n</code></pre>\n\n<p>My current train of thought is to use pattern matching by passing in the <code>[SourceUnit]</code> to a function and matching for specific cases. For instance the following function matches the code and returns the data type for a state variable declaration. </p>\n\n<pre><code>  getStateVar :: [SourceUnit] -&gt; Maybe StateVarDeclaration\n  getStateVar [SourceUnit _ , ContractDef (Contract _ _ [StateVarDec x]) ] = Just x\n  getStateVar _ = Nothing\n</code></pre>\n\n<p>This outputs the following, which is in part what I need. Unfortunately the language could contain multiple contract declarations, with multiple state variable declarations so I don't think it's entirely possible to match it in this fashion. </p>\n\n<pre><code> Main&gt; getStateVar $ runTest \"pragma solidity ^0.5.0; contract test { address owner = msg.send;}\"\n  Just (StateVariableDeclaration (ElementaryTypeName (AddrType \"address\")) [] (Identifier \"owner\") [MemberAccess (IdentExpression \"msg\") \".\" (Identifier \"send\")])\n</code></pre>\n\n<p>I've read somewhat on generic programming and \"scrap your boilerplate\" but I don't understand exactly how it works or the best method to implement it would be.</p>\n\n<p>The question is, am I on the right track in terms of pattern matching this way or is there a better alternative?</p>\n"}, {"tags": ["database", "haskell", "recursion"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1521327322, "post_id": 49342641, "comment_id": 85685631, "body": "What attempts have you made to write a function that does this? Please write them in your question."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 1, "creation_date": 1521327350, "post_id": 49342641, "comment_id": 85685639, "body": "This looks like a duplicate of <a href=\"https://stackoverflow.com/q/49336125/126014\">stackoverflow.com/q/49336125/126014</a> The names are different, but the data types and the problem statement are equivalent."}, {"owner": {"reputation": 64, "user_id": 7262684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d18b5dfb439ee7dd813365aae85cb343?s=128&d=identicon&r=PG&f=1", "display_name": "somebodyhelpme", "link": "https://stackoverflow.com/users/7262684/somebodyhelpme"}, "edited": false, "score": 0, "creation_date": 1521374338, "post_id": 49342641, "comment_id": 85694846, "body": "That&#39;s interesting but I would really like to know a solution to my recursion problem. Understanding recursion completely would be really beneficial for me."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1521385283, "post_id": 49342641, "comment_id": 85698402, "body": "Adding a student to an empty database should produce a non-empty database, no (or at least acknowledge the attempt to update a non-existent student)? Check your base case."}, {"owner": {"reputation": 64, "user_id": 7262684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d18b5dfb439ee7dd813365aae85cb343?s=128&d=identicon&r=PG&f=1", "display_name": "somebodyhelpme", "link": "https://stackoverflow.com/users/7262684/somebodyhelpme"}, "edited": false, "score": 0, "creation_date": 1521390423, "post_id": 49342641, "comment_id": 85700071, "body": "Hello chepner thanks for replying, I don&#39;t understand what you mean. If I run the function I would use <code>likedNewSubject &quot;PE&quot; &quot;JenDavis&quot; db</code> which would then work perfectly because JenDavis is the first piece of data in db. If I did <code>likedNewSubject &quot;Geography&quot; &quot;JaydenBrimes&quot;</code> db, it will only put his data in the database, nobody else&#39;s. My base case is there so if an empty database is given it will just return it as empty, but it should never be returning an empty database as I am always giving it db."}, {"owner": {"reputation": 64, "user_id": 7262684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d18b5dfb439ee7dd813365aae85cb343?s=128&d=identicon&r=PG&f=1", "display_name": "somebodyhelpme", "link": "https://stackoverflow.com/users/7262684/somebodyhelpme"}, "edited": false, "score": 0, "creation_date": 1521395220, "post_id": 49342641, "comment_id": 85701842, "body": "I would ask my lecturer but it&#39;s the weekend so I feel bad emailing him about it. I&#39;m just going to see them tomorrow anyway, but if anyone does know the answer I can quickly move on from this point. I&#39;m just really stuck at the moment."}], "owner": {"reputation": 64, "user_id": 7262684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d18b5dfb439ee7dd813365aae85cb343?s=128&d=identicon&r=PG&f=1", "display_name": "somebodyhelpme", "link": "https://stackoverflow.com/users/7262684/somebodyhelpme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1521394817, "creation_date": 1521326547, "last_edit_date": 1521394817, "question_id": 49342641, "link": "https://stackoverflow.com/questions/49342641/haskell-recursive-function-that-puts-only-part-of-the-students-in-a-list", "title": "Haskell: Recursive function that puts only part of the students in a list", "body": "<p>This is the data type:</p>\n\n<pre><code>data Student = Student String Int [String] [String]\n   deriving (Show,Read)\n</code></pre>\n\n<p>This is my database:</p>\n\n<pre><code>db :: [Student]\ndb = [  \n       Student \"JenDavis\" 54 [\"Physics\", \"Maths\"] [\"Biology\", \"English\"],\n       Student \"BenBlue\" 62 [\"Art\", \"English\"] [\"Maths\", \"PE\"]          ,\n       Student \"JaydenBrimes\" 56 [\"Chemistry\", \"PE\"] [\"Music\", \"Maths\"]\n     ]\n</code></pre>\n\n<p>Currently, the function will add the inputted subject into the liked subjects list, if the studentname is matched in the student data, and if the liked subject is not already in the list. Then it returns the database from there to the end, not any of the data pieces before.</p>\n\n<p>Function that only puts part of the students in a list:</p>\n\n<pre><code>likedNewSubject :: String -&gt; String -&gt; [Student] -&gt; [Student]\nlikedNewSubject newSubject studName [] = []\nlikedNewSubject newSubject studName ((Student n g lk dl):students)\n     | (n == studName) &amp;&amp; (newSubject `notElem` lk) = (Student n g liked dl):students ++ likedNewSubject newSubject studName students\n     | otherwise = likedNewSubject newSubject studName students\n     where liked = newSubject:lk\n</code></pre>\n\n<p>How do I make the function add all students to the database without duplicates?</p>\n\n<p>At the moment it only works if I use the student <code>\"JenDavis\"</code>.\nIf \"BenBlue\" likes a subject it will only return the student data of <code>\"BenBlue\"</code> and <code>\"JaydenBrimes\"</code>, not <code>\"JenDavis\"</code>. Thank you</p>\n\n<p>I've tried this:</p>\n\n<pre><code>likedNewSubjectt :: String -&gt; String -&gt; [Student] -&gt; [Student]\nlikedNewSubjectt newSubject studName [] = []\nlikedNewSubjectt newSubject studName ((Student n g lk dl):students)\n    | (n == studName) &amp;&amp; (newSubject `elem` lk) = (Student n g lk dl):students ++ likedNewSubjectt newSubject studName students\n    | (n == studName) &amp;&amp; (newSubject `notElem` lk) = (Student n g lk dl):students ++ likedNewSubjectt newSubject studName students\n    | otherwise = likedNewSubjectt newSubject studName students\n    where liked = newSubject:lk\n</code></pre>\n\n<p>which does the same thing</p>\n\n<p>I've tried this:</p>\n\n<pre><code>likedNewSubjectt :: String -&gt; String -&gt; [Student] -&gt; [Student]\nlikedNewSubjectt newSubject studName [] = []\nlikedNewSubjectt newSubject studName ((Student n g lk dl):students)\n    | (n /= studName) = (Student n g lk dl):students ++ likedNewSubjectt newSubject studName students\ndl):students ++ likedNewSubjectt newSubject studName students\n    | (n == studName) &amp;&amp; (newSubject `notElem` lk) = (Student n g lk dl):students ++ likedNewSubjectt newSubject studName students\n    | otherwise = likedNewSubjectt newSubject studName students\n    where liked = newSubject:lk\n</code></pre>\n\n<p>which does put everything in a list but has duplicates, and doesn't add the liked subject to the list.</p>\n\n<p>I feel like it's supposed to be a really easy solution but I haven't seen it before, therefore I don't know what it looks like! I've also tried using</p>\n\n<p><code>| (Student n g lk dl) `notElem` students = (Student n g lk dl):students</code></p>\n\n<p>but it gives out an Eq error. I appreciate it.</p>\n\n<p><code>likedNewSubject :: String -&gt; String -&gt; [Student] -&gt; [Student]\nlikedNewSubject newSubject studName [] = []\nlikedNewSubject newSubject studName ((Student n g lk dl):students)\n     | (n == studName) &amp;&amp; (newSubject</code>notElem<code>lk) = (Student n g liked dl):students ++ likedNewSubject newSubject studName students\n     | ((Student n g lk dl)</code>notElem<code>students) = (Student n g liked dl):students\n     | otherwise = likedNewSubject newSubject studName students\n     where liked = newSubject:lk</code></p>\n\n<p>This is the eq error given from the function above.</p>\n\n<p><a href=\"https://i.stack.imgur.com/8lBaz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8lBaz.png\" alt=\"eq error given after inputting code above\"></a></p>\n"}, {"tags": ["haskell", "monads", "mutable"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1521324381, "post_id": 49342277, "comment_id": 85684844, "body": "What does it mean to have an immutable representation of something mutable?  What is the &quot;this&quot; you are asking for help fixing?"}, {"owner": {"reputation": 831, "user_id": 3371760, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/09370cd5d499c9f0f75b54aa1b4daa17?s=128&d=identicon&r=PG", "display_name": "Fried Brice", "link": "https://stackoverflow.com/users/3371760/fried-brice"}, "edited": false, "score": 0, "creation_date": 1521359748, "post_id": 49342277, "comment_id": 85691129, "body": "Are you sure you need a mutable 9 x 9 grid?"}], "answers": [{"comments": [{"owner": {"reputation": 29052, "user_id": 96233, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/85735330505ef1c84896fcb86491bd0b?s=128&d=identicon&r=PG", "display_name": "Ralph", "link": "https://stackoverflow.com/users/96233/ralph"}, "edited": false, "score": 0, "creation_date": 1521373938, "post_id": 49343004, "comment_id": 85694709, "body": "Thanks. That is very helpful."}], "tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": true, "score": 1, "last_activity_date": 1521329711, "creation_date": 1521329711, "answer_id": 49343004, "question_id": 49342277, "link": "https://stackoverflow.com/questions/49342277/haskell-mutable-array-for-sudoku-grid/49343004#49343004", "title": "Haskell mutable array for sudoku grid", "body": "<p>You are using <code>runSTUArray</code>, which implies the intent to have a <code>UArray (Int, Int) Cell</code>. You can't have this: <code>UArray</code> is meant only for a select few element types. You can use a normal <code>Array</code>. Or, you can have <code>type Cell = Word16</code> and just cram the <code>Bool</code> into it. In any case, there is no reason to use <code>ST</code>. The <code>listArray</code> function will do:</p>\n\n<pre><code>import Data.Array\n-- listArray :: Ix i =&gt; (i, i) -&gt; [e] -&gt; Array i e\n\nparse :: String -&gt; Array (Int, Int) Cell\nparse = listArray ((0, 0), (8, 8)) . map chr2cell\n  where chr2cell c | isDigit c &amp;&amp; c /= '0' = Cell (bit $ intToDigit c) True\n                   | otherwise = Cell (2^11 - 2) False\n</code></pre>\n\n<p>If you choose to use <code>UArray _ Word16</code>, you simply need to modify <code>chr2cell</code> a bit. If you are on recent GHC, you can even opt to have:</p>\n\n<pre><code>{-# LANGUAGE PatternSynonyms, ViewPatterns #-}\ntype Cell = Word16\npattern Cell :: Word16 -&gt; Bool -&gt; Word16\npattern Cell { values, original } &lt;- (_ -&gt; (values, original))\n  where Cell values original = _\n</code></pre>\n\n<p>where you can fill the first and second <code>_</code>s with functions that deconstruct and construct cells to/from a <code>Word16</code> and a <code>Bool</code>, respectively, to create a record pattern synonym that works just like a normal record constructor but doesn't actually create a new type.</p>\n"}], "owner": {"reputation": 29052, "user_id": 96233, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/85735330505ef1c84896fcb86491bd0b?s=128&d=identicon&r=PG", "display_name": "Ralph", "link": "https://stackoverflow.com/users/96233/ralph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 49343004, "answer_count": 1, "score": 0, "last_activity_date": 1521329711, "creation_date": 1521323626, "question_id": 49342277, "link": "https://stackoverflow.com/questions/49342277/haskell-mutable-array-for-sudoku-grid", "title": "Haskell mutable array for sudoku grid", "body": "<p>I'm trying to write a sudoku generator/solver in Haskell as a learning exercise, but I'm running into difficulty producing a mutable array in the <code>ST</code> monad.</p>\n\n<p>The input to my <code>parse</code> function will be a <code>String</code> of 81 characters containing the digits <code>1</code> through <code>9</code> and placeholders (<code>.</code>, <code>-</code>, or <code>0</code>).</p>\n\n<p>This is the function that I wrote, but it will not compile and I can't figure out what types I need:</p>\n\n<pre><code>import           Control.Monad\nimport           Control.Monad.ST\nimport           Data.Array.ST\nimport qualified Data.Array.Unboxed as U\nimport           Data.Char          (digitToInt, isDigit)\nimport           Data.List          (zip)\n\ndata Cell = Cell\n  { values   :: Word16\n  , original :: Bool\n  } deriving (Show)\n\nparse input =\n  runSTUArray $\n  U.array ((0, 0), (8, 8)) $\n  map\n    (\\(i, d) -&gt;\n       ( (quot i 9, mod i 9)\n       , if isDigit d &amp;&amp; d /= '0'\n           then Cell {values = bit $ digitToInt d, original = True}\n           else Cell {values = 2 ^ 11 - 2, original = False})) $\n  zip [0 ..] input\n</code></pre>\n\n<p>The output of the function should be an immutable representation of a mutable 9 x 9 grid containing cells.</p>\n\n<p>How can I fix this?</p>\n"}, {"tags": ["haskell", "typeclass", "monoids", "semigroup"], "comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1521329377, "post_id": 49342152, "comment_id": 85686124, "body": "I think the <code>semigroups</code> package automatically takes care of both cases. You can see this near the &quot;<code>-- legacy configuration</code>&quot; comment <a href=\"http://hackage.haskell.org/package/semigroups-0.18.4/src/semigroups.cabal\" rel=\"nofollow noreferrer\">here</a>"}], "owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 185, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1521322601, "creation_date": 1521322601, "question_id": 49342152, "link": "https://stackoverflow.com/questions/49342152/compatible-code-for-semigroup-monoid-proposal", "title": "Compatible code for Semigroup Monoid Proposal", "body": "<p><a href=\"https://prime.haskell.org/wiki/Libraries/Proposals/SemigroupMonoid\" rel=\"nofollow noreferrer\"><code>Semigroup</code> is becoming a superclass of <code>Monoid</code></a>. I did read the recommendations on that page for writing compatible code, but I neither like to conditionally depend on the <code>semigroups</code> package nor to put my <code>mappend</code> code in a top-level declaration.</p>\n\n<p>My attempt now is</p>\n\n<pre><code>#if MIN_VERSION_base(4,9,0)\nimport Data.Semigroup\n#endif\n\n#if MIN_VERSION_base(4,9,0)\ninstance Semigroup Foo\n#endif\n\ninstance Monoid Foo where\n    mempty = \u2026\n    mappend a b = \u2026\n</code></pre>\n\n<p>The <code>Semigroup</code> class seems to have a default <code>&lt;&gt; = mappend</code> so I don't need to implement anything there, but I guess I could also write that out.</p>\n\n<p><strong>Will this code continue to work in the future?</strong></p>\n\n<p>It currently works in my setup, but I cannot test with every possible compiler and base package, especially future ones. What exactly is planned further down the road with <code>Monoid</code> escapes my grasp. Can you spot any problems with my approach?</p>\n"}, {"tags": ["haskell", "yesod"], "comments": [{"owner": {"reputation": 8576, "user_id": 327074, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/785321440230453d4a2a721f753bd538?s=128&d=identicon&r=PG", "display_name": "icc97", "link": "https://stackoverflow.com/users/327074/icc97"}, "edited": false, "score": 0, "creation_date": 1529873122, "post_id": 49341626, "comment_id": 89020266, "body": "I&#39;ve hit this problem too on Fedora 28 - did you manage to solve the problem?"}, {"owner": {"reputation": 8576, "user_id": 327074, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/785321440230453d4a2a721f753bd538?s=128&d=identicon&r=PG", "display_name": "icc97", "link": "https://stackoverflow.com/users/327074/icc97"}, "edited": false, "score": 0, "creation_date": 1529874771, "post_id": 49341626, "comment_id": 89020692, "body": "I have raised Issue <a href=\"https://github.com/yesodweb/yesod/issues/1531\" rel=\"nofollow noreferrer\">#1531</a> in the Yesod GitHub about this."}, {"owner": {"reputation": 8576, "user_id": 327074, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/785321440230453d4a2a721f753bd538?s=128&d=identicon&r=PG", "display_name": "icc97", "link": "https://stackoverflow.com/users/327074/icc97"}, "edited": false, "score": 0, "creation_date": 1529874891, "post_id": 49341626, "comment_id": 89020725, "body": "Could you say what version of Yesod that you were using?"}, {"owner": {"reputation": 11, "user_id": 9509751, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "user9509751", "link": "https://stackoverflow.com/users/9509751/user9509751"}, "reply_to_user": {"reputation": 8576, "user_id": 327074, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/785321440230453d4a2a721f753bd538?s=128&d=identicon&r=PG", "display_name": "icc97", "link": "https://stackoverflow.com/users/327074/icc97"}, "edited": false, "score": 1, "creation_date": 1530130698, "post_id": 49341626, "comment_id": 89131328, "body": "I tried updating Yesod versions and still encountered the problem up to 1.4.5 and I&#39;ve not managed to solve it myself yet."}, {"owner": {"reputation": 11, "user_id": 9509751, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "user9509751", "link": "https://stackoverflow.com/users/9509751/user9509751"}, "reply_to_user": {"reputation": 8576, "user_id": 327074, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/785321440230453d4a2a721f753bd538?s=128&d=identicon&r=PG", "display_name": "icc97", "link": "https://stackoverflow.com/users/327074/icc97"}, "edited": false, "score": 1, "creation_date": 1550433963, "post_id": 49341626, "comment_id": 96256832, "body": "I&#39;ve recently found a work-round for this by switching from persistent-mysql to persistent-mysql-haskell which removes the underlying dependancy on the mysql library where I suspect the issue lies.  There are helpful notes on the swap in the yesod context see: &lt;<a href=\"https://hackage.haskell.org/package/persistent-mysql-haskell\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/persistent-mysql-haskell</a>&gt;."}], "owner": {"reputation": 11, "user_id": 9509751, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "user9509751", "link": "https://stackoverflow.com/users/9509751/user9509751"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 82, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1521318663, "creation_date": 1521318663, "question_id": 49341626, "link": "https://stackoverflow.com/questions/49341626/persistent-mysql-crashes-on-database-migration-on-fedora-27", "title": "Persistent-mysql crashes on database migration on Fedora 27", "body": "<p>I am trying to move build my yesod application on a new development machine. Although the build proceeds without error when I try to run the application using either $ stack exec -- yesod devel or $ stack exec app I get the messages:</p>\n\n<blockquote>\n  <p>Starting devel application<br>\n  Unexpected: child process exited with ExitFailure (-11)<br>\n  Trying again</p>\n</blockquote>\n\n<p>and on in an endless loop until I interrupt.</p>\n\n<p>Looking at the mysql query log suggests that the application is going directly to querying the database with no migration step and the mariadb.log reports \"[Warning] Aborted connection\" and \"(Got an error reading communication packets)\"</p>\n\n<p>The problem is reproducible for me with a new yesod-mysql scaffold site:</p>\n\n<pre><code>$ stack new testDB yesod-mysql\n$ stack install yesod-bin --install-ghc\n$ stack build\n</code></pre>\n\n<p>then in mysql:</p>\n\n<pre><code>&gt; create database testDB;\n&gt; grant all privileges on testDB.* to 'testDB'@'localhost' identified by 'testDB';\n</code></pre>\n\n<p>and finally:</p>\n\n<pre><code>$ stack exec -- yesod devel\n</code></pre>\n\n<p>Any pointers to where I may be going wrong would be appreciated.</p>\n"}, {"tags": ["list", "haskell", "functional-programming", "nested-lists"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1521318601, "post_id": 49341613, "comment_id": 85683278, "body": "Why do this at the permutation level already."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 9495311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bca00ba06a46d581c6097d1fa4052b5?s=128&d=identicon&r=PG&f=1", "display_name": "UofAStudent", "link": "https://stackoverflow.com/users/9495311/uofastudent"}, "edited": false, "score": 0, "creation_date": 1521319494, "post_id": 49341632, "comment_id": 85683535, "body": "That&#39;s actually much more simpler than expected. Thanks!"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 2, "last_activity_date": 1521318719, "creation_date": 1521318719, "answer_id": 49341632, "question_id": 49341613, "link": "https://stackoverflow.com/questions/49341613/adding-an-element-to-each-permutation-of-a-nested-list-in-haskell/49341632#49341632", "title": "Adding an element to each permutation of a nested list in Haskell", "body": "<p>Although it might be more efficient to do this at the permutation level, we can simply first do all the permutations, and then <em>post process</em> this, with a <code>map</code>, so:</p>\n\n<pre><code>import Data.List(permutations)\n\nour_perm :: Num a =&gt; [a] -&gt; [[a]]\nour_perm = map (++[0]) . permutations\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9495311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bca00ba06a46d581c6097d1fa4052b5?s=128&d=identicon&r=PG&f=1", "display_name": "UofAStudent", "link": "https://stackoverflow.com/users/9495311/uofastudent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 49341632, "answer_count": 1, "score": 0, "last_activity_date": 1521318719, "creation_date": 1521318563, "question_id": 49341613, "link": "https://stackoverflow.com/questions/49341613/adding-an-element-to-each-permutation-of-a-nested-list-in-haskell", "title": "Adding an element to each permutation of a nested list in Haskell", "body": "<p>Let's say I have a nested list </p>\n\n<pre><code>[1,2,3]\n</code></pre>\n\n<p>When I use the Data.List module to permutate this list, the result is the following:</p>\n\n<pre><code>&gt; permutations [1,2,3]\n=&gt; [[1,2,3],[2,1,3],[3,2,1],[2,3,1],[3,1,2],[1,3,2]]\n</code></pre>\n\n<p>But I want it such that, I'm concatenating a 0 at the end of each tail. Example:</p>\n\n<pre><code>=&gt; [[1,2,3,0],[2,1,3,0],[3,2,1,0],[2,3,1,0],[3,1,2,0],[1,3,2,0]]\n</code></pre>\n\n<p>I'm thinking that the only way of doing this is modifying the source code of permutations as a different function but I'm not sure how to incorporate the concatenation into it. This would be the source:</p>\n\n<pre><code>import Data.List\n\npermutations            :: [a] -&gt; [[a]]\npermutations xs0        =  xs0 : perms xs0 []\n  where\n    perms []     _  = []\n    perms (t:ts) is = foldr interleave (perms ts (t:is)) (permutations is)\n      where interleave    xs     r = let (_,zs) = interleave' id xs r in zs\n            interleave' _ []     r = (ts, r)\n            interleave' f (y:ys) r = let (us,zs) = interleave' (f . (y:)) ys r\n                                     in  (y:us, f (t:y:us) : zs)\n</code></pre>\n\n<p>If there's a better way to approach this by using the permutation function without permutating the zero, it would be much appreciated. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1521315268, "post_id": 49340504, "comment_id": 85682296, "body": "N.B.: You don&#39;t actually want to add a string to a float. What you want is to make a float out of the string, and then add it to another float."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1521316260, "post_id": 49340504, "comment_id": 85682571, "body": "<code>String</code> is a type, not a type class. I don&#39;t see how you got to the point where you can even <i>try</i> to run <code>addFloat</code>."}], "answers": [{"comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1521314585, "post_id": 49340699, "comment_id": 85682081, "body": "His original function is <code>String -&gt; Float -&gt; String</code>, so maybe <code>show $ read x + y</code> is more appropriate?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 1, "creation_date": 1521315513, "post_id": 49340699, "comment_id": 85682370, "body": "@AdamSmith I think you are right -- edited. It&#39;s an even worse idea for a function, though :)"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1521315431, "last_edit_date": 1521315431, "creation_date": 1521312818, "answer_id": 49340699, "question_id": 49340504, "link": "https://stackoverflow.com/questions/49340504/how-to-create-your-own-function-that-adds-a-string-and-a-float-in-haskell/49340699#49340699", "title": "how to create your own function that adds a string and a float in Haskell?", "body": "<p>Haskell never performs type conversions automatically. If you want to convert a string into a float, you need to use <code>read</code> explicitly.</p>\n\n<pre><code>addFloat :: String -&gt; Float -&gt; Float\naddFloat x y = read x + y\n</code></pre>\n\n<p>(I'm not sure this is a good idea for a function though.)</p>\n\n<p>If you need a string as output, convert the resulting float to string</p>\n\n<pre><code>addFloat :: String -&gt; Float -&gt; String\naddFloat x y = show (read x + y)\n</code></pre>\n\n<p>Further, <code>String</code> is a type, not a type class, so you can not write <code>(String a) =&gt; ...</code>.</p>\n"}], "owner": {"reputation": 83, "user_id": 9393795, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5977557daaa97f72c19523c8c97dc4f6?s=128&d=identicon&r=PG&f=1", "display_name": "Squanchy", "link": "https://stackoverflow.com/users/9393795/squanchy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521315431, "creation_date": 1521311739, "last_edit_date": 1521315144, "question_id": 49340504, "link": "https://stackoverflow.com/questions/49340504/how-to-create-your-own-function-that-adds-a-string-and-a-float-in-haskell", "title": "how to create your own function that adds a string and a float in Haskell?", "body": "<p>Lear ingredientes Haskell and I am trying to add a string and an a float using a type declaration. I think this is built into Haskell, but I wanted to challenge myself so that I would understand how things work deeper, below is what I have but I get and error saying.</p>\n\n<pre><code>Prelude&gt; addFloat \"3.14\" 1.6\n\n&lt;interactive&gt;:7:1: error:\n* No instance for (Num [Char]) arising from a use of `addFloat'\n* In the expression: addFloat \"3.14\" 1.6\n  In an equation for `it': it = addFloat \"3.14\" 1.6\n\n&lt;interactive&gt;:7:17: error:\n* No instance for (Fractional [Char])\n    arising from the literal `1.6'\n* In the second argument of `addFloat', namely `1.6'\n  In the expression: addFloat \"3.14\" 1.6\n  In an equation for `it': it = addFloat \"3.14\" 1.6\nPrelude&gt;\n</code></pre>\n\n<p>Here is my code:</p>\n\n<pre><code>addFloat :: (String a) =&gt; a -&gt; Float -&gt; a\naddFloat x y = x + y\n</code></pre>\n\n<p>Not quite understanding what I am doing wrong?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1521308865, "post_id": 49339973, "comment_id": 85680167, "body": "What if you pass it a singleton-list, like <code>[4]</code>. You call <code>tail</code> on <code>xs</code>."}, {"owner": {"reputation": 639, "user_id": 6708910, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/B5pvi.jpg?s=128&g=1", "display_name": "Our", "link": "https://stackoverflow.com/users/6708910/our"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1521308933, "post_id": 49339973, "comment_id": 85680192, "body": "@WillemVanOnsem I get simply an empty list."}, {"owner": {"reputation": 639, "user_id": 6708910, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/B5pvi.jpg?s=128&g=1", "display_name": "Our", "link": "https://stackoverflow.com/users/6708910/our"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1521308958, "post_id": 49339973, "comment_id": 85680202, "body": "@WillemVanOnsem And it does now throw any error when I try it on ghci."}, {"owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "edited": false, "score": 2, "creation_date": 1521308973, "post_id": 49339973, "comment_id": 85680211, "body": "The immediate problem is in <code>checkRepetition</code>, so you should test if that function does what it&#39;s supposed to. More generally, though, the problem is that you should not use <code>head</code> and <code>tail</code> at all. Just use pattern matching. Furthermore, <code>foo == True</code> is the same as <code>foo</code>."}, {"owner": {"reputation": 639, "user_id": 6708910, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/B5pvi.jpg?s=128&g=1", "display_name": "Our", "link": "https://stackoverflow.com/users/6708910/our"}, "reply_to_user": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "edited": false, "score": 0, "creation_date": 1521309114, "post_id": 49339973, "comment_id": 85680257, "body": "@kosmikus Thanks for your comment; however, what you said has been said in the linked answer, and as I have stated, what is the reason for that ? I mean those function does not throw any error when they are tested on ghci manually, so why should they give any error inside to code ?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1521309150, "post_id": 49339973, "comment_id": 85680266, "body": "@onurcanbektas: I mean the <code>checkrepition</code> function, so <code>checkrepititon [2]</code>."}, {"owner": {"reputation": 19084, "user_id": 1482749, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ff9982206dde8c2bbb151a7305c00f3?s=128&d=identicon&r=PG", "display_name": "kosmikus", "link": "https://stackoverflow.com/users/1482749/kosmikus"}, "edited": false, "score": 0, "creation_date": 1521309263, "post_id": 49339973, "comment_id": 85680307, "body": "@onurcanbektas Of course it&#39;s <i>possible</i> to use <code>head</code> and <code>tail</code> in such a way that the program does what you want. The question is whether you <i>should</i>. The point is that you&#39;ll easily miss a case if you start using them, as you did in <code>checkRepetition</code>. If you use pattern matching, testing for non-empty list and accessing head and tail are combined in such a way that you <i>cannot</i> make a mistake, which is much better."}, {"owner": {"reputation": 639, "user_id": 6708910, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/B5pvi.jpg?s=128&g=1", "display_name": "Our", "link": "https://stackoverflow.com/users/6708910/our"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1521309361, "post_id": 49339973, "comment_id": 85680340, "body": "@WillemVanOnsem What exactly are you referring to by <code>[2]</code> ?"}, {"owner": {"reputation": 54864, "user_id": 404970, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o6X94.jpg?s=128&g=1", "display_name": "molbdnilo", "link": "https://stackoverflow.com/users/404970/molbdnilo"}, "edited": false, "score": 6, "creation_date": 1521310306, "post_id": 49339973, "comment_id": 85680676, "body": "@onurcanbektas Willem is referring to the list <code>[2]</code>. <code>checkRepetition [2]</code> will lead to the evaluation of <code>2 == head []</code>, which is where the error comes from. Use pattern matching instead of <code>head</code> and <code>tail</code>. (Patterns can be arbitrarily complex \u2013 <code>x:y:xs</code> matches a list with at least two elements, for instance.)"}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1521326065, "post_id": 49342088, "comment_id": 85685272, "body": "Your &quot;fixed&quot; <code>checkRepetition</code> still doesn&#39;t work on singleton lists..."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1521326664, "post_id": 49342088, "comment_id": 85685441, "body": "@DanielWagner whoops, oversight. Fixed."}, {"owner": {"reputation": 639, "user_id": 6708910, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/B5pvi.jpg?s=128&g=1", "display_name": "Our", "link": "https://stackoverflow.com/users/6708910/our"}, "edited": false, "score": 0, "creation_date": 1521346428, "post_id": 49342088, "comment_id": 85688992, "body": "Thanks for your answer @AdamSmith;however, even though I appreciate the sentiment, posting solution to the main problem that I&#39;m trying solve in order to learn prevents me from reading your answer :)"}, {"owner": {"reputation": 639, "user_id": 6708910, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/B5pvi.jpg?s=128&g=1", "display_name": "Our", "link": "https://stackoverflow.com/users/6708910/our"}, "edited": false, "score": 0, "creation_date": 1521346571, "post_id": 49342088, "comment_id": 85689012, "body": "FYI, apparently I misunderstood the problem, so after realising this, I arrived at the almost exactly the same answer as you."}], "tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": true, "score": 1, "last_activity_date": 1521326651, "last_edit_date": 1521326651, "creation_date": 1521322048, "answer_id": 49342088, "question_id": 49339973, "link": "https://stackoverflow.com/questions/49339973/function-containing-head-and-tail-functions-throws-empty-list-error/49342088#49342088", "title": "Function containing head and tail functions throws empty list error", "body": "<p>As was pointed out in the comments, the issue is here:</p>\n\n<pre><code>checkRepetition (x:xs)\n | x == ( head xs ) = True\n</code></pre>\n\n<p><code>xs</code> is not guaranteed to be a non-empty list (a one-element list is written as <code>x:[]</code>, so that <code>(x:xs)</code> pattern matches that <code>xs = []</code>) and calling <code>head</code> on an empty list is a runtime error.</p>\n\n<p>You can deal with this by changing your pattern to only match on a 2+ element list.</p>\n\n<pre><code>checkRepetition []        = False\ncheckRepetition [_]       = False\ncheckRepetition (x1:x2:_) = x1 == x2\n-- No need for the alternations on this function, by the way.\n</code></pre>\n\n<hr>\n\n<p>That said, your algorithm seems needlessly complex. All you have to do is check if the <em>next</em> value is equal, and if so then add the current value to the total. Assuming you can get your <code>String -&gt; [Int]</code> on your own, consider something like:</p>\n\n<pre><code>filteredSum :: [Int] -&gt; Int\nfilteredSum []            = 0  -- by definition, zero- and one-element lists\nfilteredSum [_]           = 0  -- cannot produce a sum, so special case them here\nfilteredSum xss@(first:_) = go xss\n  where\n  -- handle all recursive cases\n  go (x1:xs@(x2:_)) | x1 == x2   = x1 + go xs\n                    | otherwise  =      go xs\n  -- base case\n  go [x]            | x == first = x  -- handles last character wrapping\n                    | otherwise  = 0  -- and if it doesn't wrap\n  -- this should be unreachable\n  go []             = 0\n</code></pre>\n\n<p>For what it's worth, I think it's better to work in the Maybe monad and operate over <code>Maybe [Int] -&gt; Maybe Int</code>, but luckily that's easy since Maybe is a functor.</p>\n\n<pre><code>digitToMaybeInt :: Char -&gt; Maybe Int\ndigitToMaybeInt '0' = Just 0\ndigitToMaybeInt '1' = Just 1\ndigitToMaybeInt '2' = Just 2\ndigitToMaybeInt '3' = Just 3\ndigitToMaybeInt '4' = Just 4\ndigitToMaybeInt '5' = Just 5\ndigitToMaybeInt '6' = Just 6\ndigitToMaybeInt '7' = Just 7\ndigitToMaybeInt '8' = Just 8\ndigitToMaybeInt '9' = Just 9\ndigitToMaybeInt _   = Nothing\n\nmaybeResult :: Maybe Int\nmaybeResult = fmap filteredSum . traverse digitToMaybeInt $ input\n\nresult :: Int\nresult = case maybeResult of\n         Just x  -&gt; x\n         Nothing -&gt; 0\n-- this is equivalent to `maybe 0 id maybeResult`\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 0, "creation_date": 1521397091, "post_id": 49350889, "comment_id": 85702516, "body": "This handles the singleton input.  &gt; nl &quot;1&quot; ... 1 &#39; &#39; &#39; &#39; &#39; &#39; &quot;invcap [2]  .... 2 &#39; &#39; &#39; &#39; &#39; &#39; invcap [] ...... 0 -- this function makes any input list into two lists so continues to work given thoughtless inputs."}], "tags": [], "owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "is_accepted": false, "score": 0, "last_activity_date": 1521395760, "last_edit_date": 1521395760, "creation_date": 1521394261, "answer_id": 49350889, "question_id": 49339973, "link": "https://stackoverflow.com/questions/49339973/function-containing-head-and-tail-functions-throws-empty-list-error/49350889#49350889", "title": "Function containing head and tail functions throws empty list error", "body": "<p>Thank you for the link. I went there first to glean the purpose.\nI assume the input will be a string. The helper function below constructs a numeric list to be used to sum if predicate is True, that is, the zipped values are equal, that is, each number compared to each successive number (the pair).</p>\n\n<p>The helper function 'nl' invokes the primary function 'invcap' Inverse Captcha with a list of numbers.</p>\n\n<p>The nl function is a list comprehension. The invcap function is a list comprehension. Perhaps the logic in this question is at fault. Overly complicated logic is more likely to introduce errors. Proofs are very much easier when logic is not cumbersome.</p>\n\n<p>The primary function \"invcap\"</p>\n\n<pre><code>invcap l = sum [ x | (x,y) &lt;- zip l $ (tail l) ++ [head l], x == y]\n</code></pre>\n\n<p>The helper function that converts a string to a list of digits and invokes invcap with a list of numeric digits.</p>\n\n<pre><code>nl cs = invcap [ read [t] :: Int | t &lt;- cs]\n</code></pre>\n\n<p>Invocation examples\nPrelude> nl \"91212129\" ......\n9 ' ' ' ' ' ' ' ' ' ' ' ' ' \nPrelude> nl \"1122\" ......\n3</p>\n"}], "owner": {"reputation": 639, "user_id": 6708910, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/B5pvi.jpg?s=128&g=1", "display_name": "Our", "link": "https://stackoverflow.com/users/6708910/our"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "accepted_answer_id": 49342088, "answer_count": 2, "score": 0, "last_activity_date": 1521395760, "creation_date": 1521308693, "question_id": 49339973, "link": "https://stackoverflow.com/questions/49339973/function-containing-head-and-tail-functions-throws-empty-list-error", "title": "Function containing head and tail functions throws empty list error", "body": "<p>I'm trying the solve the first question in <a href=\"http://adventofcode.com/2017/day/1\" rel=\"nofollow noreferrer\">Advent of Code 2017</a>, and come up with the following solution to calculate the needed value:</p>\n\n<pre><code>checkRepetition :: [Int] -&gt; Bool\ncheckRepetition [] = False\ncheckRepetition (x:xs)\n | x == ( head xs ) = True\n | otherwise = False\n\ntest :: [Int] -&gt; Int\ntest [] = 0\ntest [x] = 0\ntest xs\n | checkRepetition xs == True = ((head xs)*a) + (test (drop a xs))\n |\u00a0otherwise = test (tail xs)\n  where\n   a = (go (tail xs)) + 1\n   go :: [Int] -&gt; Int\n   go [] = 0\n   go xs\n    | checkRepetition xs == True = 1 + ( go (tail xs) )\n    | otherwise = 0\n</code></pre>\n\n<p>However, when I give an input that contains repetitive numbers such as <code>[1,3,3]</code>, it gives the error</p>\n\n<blockquote>\n  <p>*** Exception: Prelude.head: empty list</p>\n</blockquote>\n\n<p>However, for 1.5 hours, I couldn't figure out exactly where this error is generated. I mean any function that is used in <code>test</code> function have a definition for <code>[]</code>, but still it throws this error, so what is the problem ?</p>\n\n<p>Note that, I have checked out <a href=\"https://stackoverflow.com/questions/15285439/haskell-prelude-head-error-empty-list\">this</a> question, and in the given answer, it is advised not to use <code>head</code> and <code>tail</code> functions, but I have tested those function for various inputs, and they do not throw any error, so what exactly is the problem ?</p>\n\n<p>I would appreciate any help or hint.</p>\n"}, {"tags": ["haskell", "cookies", "servant"], "answers": [{"tags": [], "owner": {"reputation": 11487, "user_id": 1308058, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/2be2ab74793559ea1c1dbdf55ccdf90b?s=128&d=identicon&r=PG", "display_name": "phadej", "link": "https://stackoverflow.com/users/1308058/phadej"}, "is_accepted": true, "score": 4, "last_activity_date": 1551201653, "creation_date": 1551201653, "answer_id": 54890919, "question_id": 49339259, "link": "https://stackoverflow.com/questions/49339259/servant-cookie-minimal-example/54890919#54890919", "title": "Servant cookie minimal example", "body": "<p>To write cookies:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>Get '[JSON] (Headers '[Header \"Set-Cookie\" SetCookie] ...)\n</code></pre>\n\n<p><code>SetCookie</code> has <code>ToHttpApiData</code> instance in recent <code>http-api-data</code>, so this just works.</p>\n\n<p>And to read cookies I make own <code>newtype</code>, as <a href=\"http://hackage.haskell.org/package/cookie-0.4.4/docs/Web-Cookie.html#t:Cookies\" rel=\"nofollow noreferrer\"><code>Cookies</code> is a type alias in <code>cookie</code></a> so we cannot write instance for it directly.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>newtype Cookies' = Cookies' Cookies -- type Cookies = [(BS.ByteString, BS.ByteString)]\n\ninstance FromHttpApiData Cookies' where\n  parseHeader = return . Cookies' . parseCookies\n  parseQueryParam = return . Cookies' . parseCookies . TE.encodeUtf8\n</code></pre>\n"}], "owner": {"reputation": 410, "user_id": 3927886, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/689a75ec29af93dcc938fdbd5f039b54?s=128&d=identicon&r=PG&f=1", "display_name": "RamiroPastor", "link": "https://stackoverflow.com/users/3927886/ramiropastor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 429, "favorite_count": 0, "accepted_answer_id": 54890919, "answer_count": 1, "score": 4, "last_activity_date": 1551201653, "creation_date": 1521304411, "question_id": 49339259, "link": "https://stackoverflow.com/questions/49339259/servant-cookie-minimal-example", "title": "Servant cookie minimal example", "body": "<p>Can anyone please provide me with a minimal example of cookies with servant-server, wai, warp, etc.?</p>\n\n<p>For example, a cookie with a single field \"language\" with value \"en\"</p>\n\n<p>Is there an easy way like happstack-lite <code>addCookies</code> and <code>lookCookieValue</code>?</p>\n"}, {"tags": ["haskell", "empty-list"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1521316834, "post_id": 49339042, "comment_id": 85682744, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/26467291/ambiguous-type-variable-but-not-in-ghci\">Ambiguous type variable but not in ghci?</a>"}, {"owner": {"reputation": 734, "user_id": 3484761, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wgEzO.png?s=128&g=1", "display_name": "AlQuemist", "link": "https://stackoverflow.com/users/3484761/alquemist"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1521317491, "post_id": 49339042, "comment_id": 85682936, "body": "@WillNess: Thanks. Yet, as you can see this &quot;test&quot; is meaningless because it is already in the definition of the function. I need only to understand why that error occurs."}], "answers": [{"comments": [{"owner": {"reputation": 734, "user_id": 3484761, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wgEzO.png?s=128&g=1", "display_name": "AlQuemist", "link": "https://stackoverflow.com/users/3484761/alquemist"}, "edited": false, "score": 0, "creation_date": 1521305724, "post_id": 49339153, "comment_id": 85679041, "body": "but why should the type of the list matter for <code>null</code>? and it is clear that <code>foo</code> produces a list of type <code>Ord a =&gt; [a]</code>; isn&#39;t that enough for the compiler?"}, {"owner": {"reputation": 734, "user_id": 3484761, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wgEzO.png?s=128&g=1", "display_name": "AlQuemist", "link": "https://stackoverflow.com/users/3484761/alquemist"}, "edited": false, "score": 0, "creation_date": 1521305791, "post_id": 49339153, "comment_id": 85679071, "body": "strangely, if one enters <code>null $ foo []</code> in the <i>interactive</i> mode (after loading the definition of <code>foo</code>), it works without any problem."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 734, "user_id": 3484761, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wgEzO.png?s=128&g=1", "display_name": "AlQuemist", "link": "https://stackoverflow.com/users/3484761/alquemist"}, "edited": false, "score": 0, "creation_date": 1521319587, "post_id": 49339153, "comment_id": 85683570, "body": "@AlQuemist, it doesn&#39;t matter for <code>null</code>, it matters for <code>foo</code>.  And <code>foo</code> <i>consumes</i> the <code>Ord a</code> dictionary, that is the problem (we don&#39;t have one)."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 734, "user_id": 3484761, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wgEzO.png?s=128&g=1", "display_name": "AlQuemist", "link": "https://stackoverflow.com/users/3484761/alquemist"}, "edited": false, "score": 1, "creation_date": 1521319683, "post_id": 49339153, "comment_id": 85683591, "body": "The fact that it works in <code>ghci</code> is due to <code>ghci</code>&#39;s <a href=\"https://downloads.haskell.org/~ghc/7.8.4/docs/html/users_guide/interactive-evaluation.html#extended-default-rules\" rel=\"nofollow noreferrer\">extended defaulting rules</a>.  It might be worth reading about <a href=\"https://kseo.github.io/posts/2017-01-04-type-defaulting-in-haskell.html\" rel=\"nofollow noreferrer\">type defaulting</a> in general, which is surely not the prettiest part of Haskell, but it&#39;s going to come up a lot in the kinds of corner cases you are asking about."}, {"owner": {"reputation": 734, "user_id": 3484761, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wgEzO.png?s=128&g=1", "display_name": "AlQuemist", "link": "https://stackoverflow.com/users/3484761/alquemist"}, "edited": false, "score": 0, "creation_date": 1521378228, "post_id": 49339153, "comment_id": 85695964, "body": "why can&#39;t the compiler infer the type of <code>[]</code> in the test expression? shouldn&#39;t that be obvious from the definition of <code>foo</code>; namely, <code>foo :: Ord a =&gt; [a] -&gt; [a]; foo [] = []</code> ? I think the type is obvious; no need for further ado."}, {"owner": {"reputation": 734, "user_id": 3484761, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wgEzO.png?s=128&g=1", "display_name": "AlQuemist", "link": "https://stackoverflow.com/users/3484761/alquemist"}, "edited": false, "score": 0, "creation_date": 1521386606, "post_id": 49339153, "comment_id": 85698845, "body": "to pass a &quot;dictionary&quot; along with the empty list, could we use <code>foo ([] :: Ord a =&gt; [a])</code> to remove ambiguity?"}, {"owner": {"reputation": 734, "user_id": 3484761, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wgEzO.png?s=128&g=1", "display_name": "AlQuemist", "link": "https://stackoverflow.com/users/3484761/alquemist"}, "edited": false, "score": 0, "creation_date": 1521387683, "post_id": 49339153, "comment_id": 85699226, "body": "I found that something list <code>test3 = null $ foo ([] :: (Num a, Ord a) =&gt; [a])</code> solves the issue."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 734, "user_id": 3484761, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wgEzO.png?s=128&g=1", "display_name": "AlQuemist", "link": "https://stackoverflow.com/users/3484761/alquemist"}, "edited": false, "score": 0, "creation_date": 1521490431, "post_id": 49339153, "comment_id": 85744192, "body": "@AlQuemist that&#39;s also because of defaulting.  That type will just end up defaulting to <code>[Integer]</code> because it includes <code>Num</code>.  It&#39;s a bit roundabout; I&#39;d just use a concrete type like <code>[Integer]</code> directly, though it doesn&#39;t really matter what type you use, you could use something crazy like <code>null $ foo ([] :: [Either Integer String])</code>.  To me the most elegant choice is <code>null $ foo ([] :: [</code><a href=\"https://hackage.haskell.org/package/void-0.7.1/docs/Data-Void.html\" rel=\"nofollow noreferrer\"><code>Void</code></a><code>])</code>, because it says very directly that the list must empty (modulo <code>undefined</code>)."}, {"owner": {"reputation": 734, "user_id": 3484761, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wgEzO.png?s=128&g=1", "display_name": "AlQuemist", "link": "https://stackoverflow.com/users/3484761/alquemist"}, "edited": false, "score": 0, "creation_date": 1521539914, "post_id": 49339153, "comment_id": 85762893, "body": "could you explain what the defining relation, <code>foo :: Ord a =&gt; [a] -&gt; [a]; foo [] = []</code> mean to the <i>compiler</i>? I imagine that this would be enough for the compiler to correctly interpret the type of <code>[]</code>, in an expression like <code>res = foo []</code>. Why doesn&#39;t the compiler reduce the polymorphic type of <code>[]</code> to the correct type (e.g., <code>[Void]</code>)? Such a reduction happens, for instance, when one calls a function <code>bar :: Float -&gt; Float</code> on a \u201cpolymorphic constant\u201d like <code>2</code> (the deduced type will be <code>Float</code>, rather than <code>Integer</code>)."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 734, "user_id": 3484761, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wgEzO.png?s=128&g=1", "display_name": "AlQuemist", "link": "https://stackoverflow.com/users/3484761/alquemist"}, "edited": false, "score": 1, "creation_date": 1521565546, "post_id": 49339153, "comment_id": 85781809, "body": "@AlQuemist did you read about <a href=\"https://kseo.github.io/posts/2017-01-04-type-defaulting-in-haskell.html\" rel=\"nofollow noreferrer\">defaulting</a> yet?"}, {"owner": {"reputation": 734, "user_id": 3484761, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wgEzO.png?s=128&g=1", "display_name": "AlQuemist", "link": "https://stackoverflow.com/users/3484761/alquemist"}, "edited": false, "score": 0, "creation_date": 1522223611, "post_id": 49339153, "comment_id": 86063547, "body": "could you please explain why <code>foo ([] :: Ord a =&gt; [a])</code> does <i>not</i> eliminate the ambiguity, while passing the required \u201cdictionary\u201d?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 734, "user_id": 3484761, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wgEzO.png?s=128&g=1", "display_name": "AlQuemist", "link": "https://stackoverflow.com/users/3484761/alquemist"}, "edited": false, "score": 1, "creation_date": 1522225735, "post_id": 49339153, "comment_id": 86064833, "body": "@AlQuemist because it is not known which specific <code>Ord</code> dictionary you want to pass.  Is it <code>Ord Int</code> or <code>Ord (Maybe String)</code> or what?  There is no generic <code>Ord</code> dictionary, only for specific <code>a</code>s, so we have to choose, and there is no rule for what type to choose in this case.   Whereas whn you say <code>(Ord a, Num a) =&gt; [a]</code>, then defaulting specifies a way to choose, and we pick <code>Integer</code>.  It&#39;s a special case of the <code>Num</code> class."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 6, "last_activity_date": 1522351002, "last_edit_date": 1522351002, "creation_date": 1521303823, "answer_id": 49339153, "question_id": 49339042, "link": "https://stackoverflow.com/questions/49339042/ambiguous-type-variable-in-a-test-for-empty-list/49339153#49339153", "title": "Ambiguous type variable in a test for empty list", "body": "<p>I like thinking of typeclasses in \"dictionary-passing style\".  The signature</p>\n\n<pre><code>foo :: Ord a =&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>says that <code>foo</code> takes a dictionary of methods for <code>Ord a</code>, essentially as a parameter, and a list of <code>a</code>s, and gives back a list of <code>a</code>s.  The dictionary has things in it like <code>(&lt;) :: a -&gt; a -&gt; Bool</code> and its cousins.  When we call <code>foo</code>, we need to supply such a dictionary.  This is done implicitly by the compiler. So</p>\n\n<pre><code>foo [1,2,3]\n</code></pre>\n\n<p>will use the <code>Ord Integer</code> dictionary, because we know that <code>a</code> is <code>Integer</code>.</p>\n\n<p>However, in <code>foo []</code>, the list could be a list of anything -- there is no information to determine the type.  But we still need to find the <code>Ord</code> dictionary to pass to <code>foo</code> (although your <code>foo</code> doesn't use it at all, the signature says that it could, and that's all that matters).  That's why there is an ambiguous type error.  You can specify the type manually, which will give enough information to fill in the dictionary, like this</p>\n\n<pre><code>null (foo ([] :: [Integer]))\n</code></pre>\n\n<p>or with the new <code>TypeApplications</code> extension</p>\n\n<pre><code>null (foo @Integer [])\n</code></pre>\n\n<p>If you remove the <code>Ord</code> constraint, it works, as you have observed, and this is just because we no longer need to supply a dictionary.  We don't need to know what specific type <code>a</code> is to call <code>foo</code> anymore (this feels a little magical to me :-).</p>\n\n<p>Note that <code>foo ([] :: Ord a =&gt; [a])</code> does <em>not</em> eliminate the ambiguity, because it is not known which specific <code>Ord</code> dictionary you want to pass; is it <code>Ord Int</code> or <code>Ord (Maybe String)</code>, etc.? There is <em>no</em> generic <code>Ord</code> dictionary, so we have to choose, and there is <em>no</em> rule for what type to choose in this case. Whereas when you say <code>(Ord a, Num a) =&gt; [a]</code>, then defaulting specifies a way to choose, and we pick <code>Integer</code>, since it is a special case of the <code>Num</code> class.</p>\n\n<p>The fact that <code>foo []</code> works in <code>ghci</code> is due to <code>ghci</code>\u2019s <a href=\"https://downloads.haskell.org/~ghc/7.8.4/docs/html/users_guide/interactive-evaluation.html#extended-default-rules\" rel=\"nofollow noreferrer\">extended defaulting</a> rules. It might be worth reading about <a href=\"https://kseo.github.io/posts/2017-01-04-type-defaulting-in-haskell.html\" rel=\"nofollow noreferrer\">type defaulting</a> in general, which is surely not the prettiest part of Haskell, but it is going to come up a lot in the kinds of corner cases you are asking about. </p>\n"}], "owner": {"reputation": 734, "user_id": 3484761, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wgEzO.png?s=128&g=1", "display_name": "AlQuemist", "link": "https://stackoverflow.com/users/3484761/alquemist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 583, "favorite_count": 0, "accepted_answer_id": 49339153, "answer_count": 1, "score": 3, "last_activity_date": 1522351002, "creation_date": 1521303147, "last_edit_date": 1521317656, "question_id": 49339042, "link": "https://stackoverflow.com/questions/49339042/ambiguous-type-variable-in-a-test-for-empty-list", "title": "Ambiguous type variable in a test for empty list", "body": "<p>Consider the following snippet which defines a function <code>foo</code> which takes in a list and performs some operation on the list (like sorting).\nI tried to load the snippet in <code>ghci</code>:</p>\n\n<pre><code>-- a function which consumes lists and produces lists\nfoo :: Ord a =&gt; [a] -&gt; [a]\nfoo [] = []\nfoo (x:xs) = xs\n\ntest1 = foo [1, 2, 3] == [2, 3]\ntest2 = null $ foo []\n</code></pre>\n\n<p>yet the following error occurs:</p>\n\n<pre><code>No instance for (Ord a0) arising from a use of \u2018foo\u2019\n    The type variable \u2018a0\u2019 is ambiguous\n    Note: there are several potential instances:\n      instance (Ord a, Ord b) =&gt; Ord (Either a b)\n        -- Defined in \u2018Data.Either\u2019\n      instance forall (k :: BOX) (s :: k). Ord (Data.Proxy.Proxy s)\n        -- Defined in \u2018Data.Proxy\u2019\n      instance (GHC.Arr.Ix i, Ord e) =&gt; Ord (GHC.Arr.Array i e)\n        -- Defined in \u2018GHC.Arr\u2019\n      ...plus 26 others\n    In the second argument of \u2018($)\u2019, namely \u2018foo []\u2019\n    In the expression: null $ foo []\n    In an equation for \u2018test2\u2019: test2 = null $ foo []\n</code></pre>\n\n<p>The problem is in the expression <code>test2 = null $ foo []</code>. Furthermore, removing <code>Ord a</code> constraint from the type definition of <code>foo</code> will solve the problem. Strangely, typing <code>null $ foo []</code> in the <em>interactive</em> mode (after loading the definition for <code>foo</code>) works correctly and produces the expected <code>true</code>. </p>\n\n<p>I need a clear explanation for this behaviour.</p>\n"}, {"tags": ["haskell", "amazon-s3"], "answers": [{"tags": [], "owner": {"reputation": 5215, "user_id": 133235, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/64798a399a79ed8d34fa83ba0e61c1ac?s=128&d=identicon&r=PG", "display_name": "iElectric", "link": "https://stackoverflow.com/users/133235/ielectric"}, "is_accepted": true, "score": 1, "last_activity_date": 1521829438, "creation_date": 1521829438, "answer_id": 49456165, "question_id": 49338771, "link": "https://stackoverflow.com/questions/49338771/streaming-from-s3-bucket-using-amazonka-with-servant/49456165#49456165", "title": "Streaming from S3 bucket using Amazonka with Servant", "body": "<p>Solved with</p>\n\n<pre><code>server :: Server API\nserver =  do\n  env &lt;- newEnv Discover\n  res &lt;- runInternalState (runAWS env conduits) st\n  return (res &gt;&gt; liftIO (closeInternalState st))\n</code></pre>\n\n<p><a href=\"https://github.com/domenkozar/servant-streaming-amazonka/commit/c5fad78dd7bf733cecb8790035105c819d5f5ae9\" rel=\"nofollow noreferrer\">https://github.com/domenkozar/servant-streaming-amazonka/commit/c5fad78dd7bf733cecb8790035105c819d5f5ae9</a></p>\n"}], "owner": {"reputation": 5215, "user_id": 133235, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/64798a399a79ed8d34fa83ba0e61c1ac?s=128&d=identicon&r=PG", "display_name": "iElectric", "link": "https://stackoverflow.com/users/133235/ielectric"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 298, "favorite_count": 1, "accepted_answer_id": 49456165, "answer_count": 1, "score": 5, "last_activity_date": 1521829438, "creation_date": 1521301745, "last_edit_date": 1521320275, "question_id": 49338771, "link": "https://stackoverflow.com/questions/49338771/streaming-from-s3-bucket-using-amazonka-with-servant", "title": "Streaming from S3 bucket using Amazonka with Servant", "body": "<p>I'd like to be able to stream S3 bucket object contents via Servant as the response body.</p>\n\n<p>I'm having issues getting MonadResource instance missing for Handler:</p>\n\n<pre><code>src/Servant/Streaming/Example.hs:29:3: error:\n    * No instance for (MonadResource Handler)\n        arising from a use of `runAWS'\n    * In a stmt of a 'do' block: runAWS env conduits\n      In the expression:\n        do env &lt;- newEnv Discover\n           runAWS env conduits\n      In an equation for `server':\n          server\n            = do env &lt;- newEnv Discover\n                 runAWS env conduits\n   |\n29 |   runAWS env conduits\n   |   ^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>I have made a repository to reproduce: <a href=\"https://github.com/domenkozar/servant-streaming-amazonka\" rel=\"nofollow noreferrer\">https://github.com/domenkozar/servant-streaming-amazonka</a></p>\n\n<p><code>servant-streaming-server</code> handles <code>ResourceT</code> for <code>Stream (Of BS.ByteString) (ResourceT IO) ()</code>  <a href=\"https://github.com/plow-technologies/servant-streaming/blob/master/servant-streaming-server/src/Servant/Streaming/Server/Internal.hs#L77-L79\" rel=\"nofollow noreferrer\">https://github.com/plow-technologies/servant-streaming/blob/master/servant-streaming-server/src/Servant/Streaming/Server/Internal.hs#L77-L79</a></p>\n\n<p>but since I'm using Amazonka I also need to make sure MonadResource for Handler is taken take in that bracket. It's not clear to me how to do that.</p>\n\n<p>My understanding is that using <code>enter</code>/<code>hoistServer</code> this won't work since resources would be cleaned up too soon (before streaming).</p>\n\n<p>Notes:</p>\n\n<ul>\n<li>This builds upon question asked in 2016: <a href=\"https://stackoverflow.com/questions/34974257/haskell-servant-and-streaming\">Haskell Servant and streaming</a></li>\n<li>Servant part is implemented via <a href=\"https://github.com/plow-technologies/servant-streaming/pull/2/files\" rel=\"nofollow noreferrer\">https://github.com/plow-technologies/servant-streaming/pull/2/files</a></li>\n</ul>\n\n<h1>Edits</h1>\n\n<ol>\n<li><strong>EDIT: I've since replaced <code>$$</code> with <code>$$+-</code></strong></li>\n<li><strong>EDIT2: I've resolved Conduit specific errors, now fighting with MonadResource</strong></li>\n</ol>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1521293624, "post_id": 49336583, "comment_id": 85674482, "body": "What&#39;s your command line?"}, {"owner": {"reputation": 153, "user_id": 7452686, "user_type": "registered", "profile_image": "https://graph.facebook.com/1404472329603931/picture?type=large", "display_name": "Jake McLaughlin", "link": "https://stackoverflow.com/users/7452686/jake-mclaughlin"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1521293823, "post_id": 49336583, "comment_id": 85674549, "body": "just default, bash shell in mac os x"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1521293851, "post_id": 49336583, "comment_id": 85674554, "body": "No, I mean what is the exact command you&#39;re using to get that error?"}, {"owner": {"reputation": 153, "user_id": 7452686, "user_type": "registered", "profile_image": "https://graph.facebook.com/1404472329603931/picture?type=large", "display_name": "Jake McLaughlin", "link": "https://stackoverflow.com/users/7452686/jake-mclaughlin"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1521293899, "post_id": 49336583, "comment_id": 85674571, "body": "ghc -o -Wall polycake polycake.hs"}], "answers": [{"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 8, "last_activity_date": 1521294872, "creation_date": 1521294872, "answer_id": 49337712, "question_id": 49336583, "link": "https://stackoverflow.com/questions/49336583/module-is-defined-in-multiple-files-error-from-haskell-compilation/49337712#49337712", "title": "&quot;module [...] is defined in multiple files&quot; error from Haskell compilation", "body": "<p>The <code>-o</code> option expects the output file name as the next argument - it does not care whether that argument starts with a dash or not. So <code>-o -Wall</code> sets the output file name to <code>-Wall</code> (and does not actually enable warnings).</p>\n\n<p>So the two left over arguments are <code>polycake</code> and <code>polycake.hs</code>, which <code>ghc</code> interprets as input file names. When an input file name does not exist and does not already end with the <code>.hs</code> extension, <code>ghc</code> will try to add that extension. So <code>ghc polycake polycake.hs</code> will try to compile <code>polycake.hs</code> twice. This leads to your error.</p>\n\n<p>PS: The output file name defaults to the input file name without the extension, so you don't need the <code>-o</code> option at all in this case.</p>\n"}], "owner": {"reputation": 153, "user_id": 7452686, "user_type": "registered", "profile_image": "https://graph.facebook.com/1404472329603931/picture?type=large", "display_name": "Jake McLaughlin", "link": "https://stackoverflow.com/users/7452686/jake-mclaughlin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1664, "favorite_count": 0, "accepted_answer_id": 49337712, "answer_count": 1, "score": 3, "last_activity_date": 1521294872, "creation_date": 1521293506, "last_edit_date": 1521293937, "question_id": 49336583, "link": "https://stackoverflow.com/questions/49336583/module-is-defined-in-multiple-files-error-from-haskell-compilation", "title": "&quot;module [...] is defined in multiple files&quot; error from Haskell compilation", "body": "<p>I am getting the following error when i compile with the -Wall option.</p>\n\n<pre><code>ghc -o -Wall polycake polycake.hs\n</code></pre>\n\n<p>When I don't use the option my code compiles fine and runs as expected. What does this mean?</p>\n\n<pre><code>&lt;no location info&gt;: error:\n    module \u2018main:Polycake\u2019 is defined in multiple files: polycake.hs\n                                                         polycake.hs\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 4234, "user_id": 4942760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f322d06b4f3e34278f29a954e0f38cb1?s=128&d=identicon&r=PG&f=1", "display_name": "Dan Robertson", "link": "https://stackoverflow.com/users/4942760/dan-robertson"}, "edited": false, "score": 2, "creation_date": 1521290607, "post_id": 49336125, "comment_id": 85673641, "body": "Try <code>not foo</code> instead of <code>foo == False</code>. What is <code>[1,2,3] &#47;&#47;[3,4]</code>? What is <code>filter (&#47;=5) [4,5,6,8]</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": true, "score": 0, "last_activity_date": 1521309162, "creation_date": 1521309162, "answer_id": 49340062, "question_id": 49336125, "link": "https://stackoverflow.com/questions/49336125/i-want-to-add-another-condition-which-removes-a-user-that-has-already-liked-a-fi/49340062#49340062", "title": "I want to add another condition which removes a user that has already liked a film", "body": "<p>Trying to accomplish this in a list comprehension is hardly the easiest, or more readable approach. Instead, consider defining a function that handles a single <code>Film</code>. If you have such a function, the overall function becomes a simple map:</p>\n\n<pre><code>addUserDislikes :: Title -&gt; User -&gt; [Film] -&gt; [Film]\naddUserDislikes title user = fmap $ dislikeFilm title user\n</code></pre>\n\n<p>You can define <code>dislikeFilm</code> as a stand-alone function, if you will, or alternatively define it using <code>let</code> or <code>where</code> in <code>addUserDislikes</code>. If you write the function as a stand-alone function, you could write it like this:</p>\n\n<pre><code>dislikeFilm title user film@(ti, di, yr, likes, dislikes) =\n  if ti == title\n    then (ti, di, yr, delete user likes, user : dislikes)\n    else film\n</code></pre>\n\n<p>Notice that this function returns <code>film</code> unmodified if <code>title</code> doesn't match. If, on the other hand, the title matches, it <em>cons</em> <code>user</code> onto <code>dislikes</code>, and simultaneously removes if from <code>likes</code>. For that, it uses <code>delete</code> from <code>Data.List</code>.</p>\n\n<p>Here's some examples:</p>\n\n<pre><code>*Q49336125&gt; addUserDislikes \"2010\" \"foo\" []\n[]\n\n*Q49336125&gt; addUserDislikes \"2010\" \"foo\" [(\"2010\", \"Peter Hyams\", 1984, [], [])]\n[(\"2010\",\"Peter Hyams\",1984,[],[\"foo\"])]\n\n*Q49336125&gt; addUserDislikes \"2010\" \"foo\" [(\"2010\", \"Peter Hyams\", 1984, [\"foo\"], [])]\n[(\"2010\",\"Peter Hyams\",1984,[],[\"foo\"])]\n\n*Q49336125&gt; addUserDislikes \"2010\" \"foo\" [\n    (\"2010\", \"Peter Hyams\", 1984, [\"foo\"], [\"bar\"]),\n    (\"2001\", \"Stanley Kubrick\", 1968, [\"baz\", \"qux\"], [])]\n[(\"2010\",\"Peter Hyams\",1984,[],[\"foo\",\"bar\"]),\n (\"2001\",\"Stanley Kubrick\",1968,[\"baz\",\"qux\"],[])]\n</code></pre>\n\n<p>(Last evaluation hand-edited by me to make it more readable.)</p>\n\n<p>(P.S. I liked both <em>2001</em> and <em>2010</em>, but I wanted to use some short film titles.)</p>\n"}], "owner": {"reputation": 17, "user_id": 9469859, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "sam786", "link": "https://stackoverflow.com/users/9469859/sam786"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 49340062, "answer_count": 1, "score": 1, "last_activity_date": 1521309218, "creation_date": 1521290406, "last_edit_date": 1521309218, "question_id": 49336125, "link": "https://stackoverflow.com/questions/49336125/i-want-to-add-another-condition-which-removes-a-user-that-has-already-liked-a-fi", "title": "I want to add another condition which removes a user that has already liked a film", "body": "<p>I am trying to create a function which allows a user to dislike a film. However the user can only exist in the list of likes/dislikes but not both</p>\n\n<pre><code> addUserDislikes :: Title -&gt; User -&gt; [Film] -&gt; [Film] \n addUserDislikes title user db = [ if ti == title &amp;&amp; elem user dislike == False then (ti, di, yr,like,dislike++ [user])else (ti, di, yr, like, dislike) | (ti, di, yr, like, dislike) &lt;- db] \n</code></pre>\n\n<p>This function only adds the user to the list of Dislikes but does not remove it from list of likes how do I do this?</p>\n\n<p>other info - The <code>Title</code> &amp; <code>User</code> are <code>Strings</code>. <code>Like</code> and <code>Dislikes</code> are lists in the tuple <code>Film</code>.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1521299365, "post_id": 49335783, "comment_id": 85676994, "body": "Functions don&#39;t have names <i>per se</i>; you can <i>bind</i> one or more names to a single function, but the function itself has no notion of which names are bound to it."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1521299862, "post_id": 49335819, "comment_id": 85677159, "body": "It might go without saying, but now <code>fs</code> has a type like <code>[Named (a -&gt; b)]</code>, not <code>[(a -&gt; b)]</code>. Subsequent code using <code>fs</code> would need to adapt."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 3, "last_activity_date": 1521288523, "creation_date": 1521288523, "answer_id": 49335819, "question_id": 49335783, "link": "https://stackoverflow.com/questions/49335783/haskell-print-function-name/49335819#49335819", "title": "Haskell print function name", "body": "<p>No, it is not possible. If you want named functions, you will have to whip them up yourself; e.g.</p>\n\n<pre><code>data Named a = Named { name :: String, val :: a }\ninstance Show (Named a) where show = name\nfs = [Named \"f1\" f1, Named \"f2\" f2, Named \"f3\" f3]\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 5143570, "user_type": "registered", "profile_image": "https://graph.facebook.com/10203335308343372/picture?type=large", "display_name": "Laci Feldsam", "link": "https://stackoverflow.com/users/5143570/laci-feldsam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 49335819, "answer_count": 1, "score": 0, "last_activity_date": 1521288523, "creation_date": 1521288310, "question_id": 49335783, "link": "https://stackoverflow.com/questions/49335783/haskell-print-function-name", "title": "Haskell print function name", "body": "<p>Hello i would like to print the names of functions in a list. Is it somehow possible to do so?</p>\n\n<p>my example:</p>\n\n<pre><code>import Text.Show.Functions\nf1 x = if x == 1 then 1 else 0\nf2 x = if x == 2 then 1 else 0\nf3 x = if x == 1 then 2 else 0\nfs = [f1,f2,f3]\nfs\n</code></pre>\n\n<p>writes out <code>[&lt;function&gt;,&lt;function&gt;,&lt;function&gt;]</code> but I want <code>[f1,f2,f3]</code></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1521283569, "post_id": 49335008, "comment_id": 85671651, "body": "Is there any reason for using lists instead of trees, where a depth function would be much more natural, and require no type classes at all?"}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1521284417, "post_id": 49335008, "comment_id": 85671906, "body": "@chi I am investigating various ways to approach the cartesian product problem from <a href=\"https://stackoverflow.com/q/48743657\">another question of mine</a>. A nested list would be preferable, for one, because it forces all branches to be of same depth. It is also related to the (not yet posed) question of making a type safe input of type-indexed vectors of variable length, as defined in <a href=\"https://stackoverflow.com/q/49118438\">other question here</a> and on <a href=\"https://codereview.stackexchange.com/q/188982\">Code Review</a>. I&#39;m looking for general understanding as well as a specific solution."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1521285519, "post_id": 49335008, "comment_id": 85672207, "body": "But your definition above does not make all branches to have the same depth, e.g. <code>[[], [[[[1]]]]]</code>. Are you sure you don&#39;t want to have <code>g ([] :: [[Int]]) = 2</code>, for instance?"}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1521286211, "post_id": 49335008, "comment_id": 85672433, "body": "@chi (1) There are branches to make up for the seemingly uneven depth, they&#39;re just invisible because they have zero elements. Hovewer humorous, this is the best answer I can give at the moment. (2) Maybe I should want this. It is logically more correct. It&#39;s definitely a valid objection to the current code. (3) Once I enforce that lists are never empty, both problems will go away."}], "answers": [{"comments": [{"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1521879416, "post_id": 49335746, "comment_id": 85928145, "body": "I appreciate your sharing with me of that trick. It is awesome. I will be keeping it in my sleeve. But it does not add to my understanding of things I am confused about, as related to the question."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 3, "last_activity_date": 1521288052, "creation_date": 1521288052, "answer_id": 49335746, "question_id": 49335008, "link": "https://stackoverflow.com/questions/49335008/is-it-safe-to-use-an-overlappable-catch-all-instance-in-a-method-that-counts-nes/49335746#49335746", "title": "Is it safe to use an overlappable catch-all instance in a method that counts nesting depth?", "body": "<p>I propose that you use data rather than classes. So:</p>\n\n<pre><code>data FixedDepthTree a = Zero a | Succ (FixedDepthTree [a])\n\ndepth :: FixedDepthTree a -&gt; Integer\ndepth (Zero _) = 0\ndepth (Succ t) = succ (depth t)\n</code></pre>\n"}], "owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1521288052, "creation_date": 1521283085, "last_edit_date": 1521284854, "question_id": 49335008, "link": "https://stackoverflow.com/questions/49335008/is-it-safe-to-use-an-overlappable-catch-all-instance-in-a-method-that-counts-nes", "title": "Is it safe to use an overlappable catch-all instance in a method that counts nesting depth?", "body": "<p>Consider method <code>g</code>:</p>\n\n<pre><code>class G a where\n    g :: a -&gt; Int\n\ninstance G a =&gt; G [a] where\n    g [ ] = 1\n    g xs = maximum (g &lt;$&gt; xs) + 1\n\ninstance G Void where\n    g = absurd\n</code></pre>\n\n<p>&nbsp;</p>\n\n<pre><code>\u03bb g [[[]:: [Void]],[]]\n3\n</code></pre>\n\n<p>It can be translated to work on nested lists of any fixed type, but I am having trouble making it polymorphic.</p>\n\n<p>If I define a catch-all instance like this:</p>\n\n<pre><code>instance G a where\n    g _ = 0\n</code></pre>\n\n<p>\u2212 It will overlap with <code>G a =&gt; G [a]</code>. I can allow this with \"overlapping\" and \"overlappable\" pragmas:</p>\n\n<pre><code>class G a where\n    g :: a -&gt; Int\n\ninstance {-# OVERLAPPABLE #-} G a =&gt; G [a] where\n    g [ ] = 1\n    g xs = maximum (g &lt;$&gt; xs) + 1\n\ninstance {-# OVERLAPPABLE #-} G a where\n    g _ = 0\n</code></pre>\n\n<p>I tried a similar thing once and <a href=\"https://stackoverflow.com/questions/46124490/is-there-a-way-to-set-one-of-these-two-incoherent-instances-as-preferred\">got burned</a>, but I still did not learn the lesson.</p>\n\n<p>My questions:</p>\n\n<ol>\n<li>How can I determine whether this code is safe?</li>\n<li>Is there a more likeable way to count nesting depth?</li>\n</ol>\n\n<p><strong>P.S.</strong> I just noticed that I accidentally specified \"overlappable\" to both instances of <code>G</code>. I did not notice at first because it actually seems to work this way. Which, if anything, makes the case even more alarming. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1521283022, "post_id": 49334964, "comment_id": 85671505, "body": "Well Haskell says that it can not per se call <code>show a</code>, you should add <code>Show a</code> as type constraint."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1521300212, "post_id": 49334964, "comment_id": 85677290, "body": "You don&#39;t need to use <code>show</code> in the result of <code>&quot;&lt;&quot; ++ ... ++ &quot;&gt;&quot;</code>; it&#39;s already a <code>String</code>."}], "answers": [{"tags": [], "owner": {"reputation": 31724, "user_id": 6264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbb17eeeecd3d9d06f4db310ab630a12?s=128&d=identicon&r=PG", "display_name": "Michiel Borkent", "link": "https://stackoverflow.com/users/6264/michiel-borkent"}, "is_accepted": false, "score": 3, "last_activity_date": 1521283031, "creation_date": 1521283031, "answer_id": 49334998, "question_id": 49334964, "link": "https://stackoverflow.com/questions/49334964/writing-an-implementation-of-show/49334998#49334998", "title": "Writing an implementation of Show", "body": "<p>You need to explicitly state that there exists a <code>Show</code> instance for the type variable <code>a</code>:</p>\n\n<pre><code>instance (Show a) =&gt; Show (Tree a) where\n  show (Branch a b) = show $ \"&lt;\" ++ show a ++ \",\" ++ show b ++ \"&gt;\"\n  show (Leaf a) = show a\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 1, "last_activity_date": 1521283130, "creation_date": 1521283130, "answer_id": 49335014, "question_id": 49334964, "link": "https://stackoverflow.com/questions/49334964/writing-an-implementation-of-show/49335014#49335014", "title": "Writing an implementation of Show", "body": "<p>In your implementation, you write:</p>\n\n<pre><code>instance Show (Tree a) where\n    show (Branch a b) = show $ \"&lt;\" ++ show a ++ \",\" ++ show b ++ \"&gt;\"\n    show (Leaf a) = <b>show a</b></code></pre>\n\n<p>That thus means that you call <code>show</code> on an <code>a</code> object. But Haskell has no guarantees that it can call <code>show</code> on <code>a</code>. So you need to add a type constraint <code>Show a</code>:</p>\n\n<pre><code>instance <b>Show a =&gt;</b> Show (Tree a) where\n    show (Branch a b) = show $ \"&lt;\" ++ show a ++ \",\" ++ show b ++ \"&gt;\"\n    show (Leaf a) = show a</code></pre>\n"}], "owner": {"reputation": 241, "user_id": 304290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acafbf9af6f9a7c31c335eb43337ed07?s=128&d=identicon&r=PG", "display_name": "Marreman", "link": "https://stackoverflow.com/users/304290/marreman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1521283130, "creation_date": 1521282793, "question_id": 49334964, "link": "https://stackoverflow.com/questions/49334964/writing-an-implementation-of-show", "title": "Writing an implementation of Show", "body": "<p>I'm trying to write my own implementation of show for my Tree type. But the following code:</p>\n\n<pre><code>data Tree a = Leaf a | Branch (Tree a) (Tree a)\n\ninstance Show (Tree a) where\n    show (Branch a b) = show $ \"&lt;\" ++ show a ++ \",\" ++ show b ++ \"&gt;\"\n    show (Leaf a) = show a\n</code></pre>\n\n<p>is yielding:</p>\n\n<pre><code>main.hs:11:21: error:\n    \u2022 No instance for (Show a) arising from a use of \u2018show\u2019\n      Possible fix:\n        add (Show a) to the context of the instance declaration\n    \u2022 In the expression: show a\n      In an equation for \u2018show\u2019: show (Leaf a) = show a\n      In the instance declaration for \u2018Show (Tree a)\u2019\n   |\n11 |     show (Leaf a) = show a\n   |                     ^^^^^^\n</code></pre>\n\n<p>I don't really understand what the compiler is telling me.</p>\n\n<p>What would be the correct implementation and why?</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 3, "creation_date": 1521251361, "post_id": 49331439, "comment_id": 85665488, "body": "Can you simplify your example and state more clearly what the issue is: Does <code>outList</code> throw some sort of runtime error? Does it fail to type check? (post the error messages) Or does it simply not work correctly (what is it supposed to do)?"}, {"owner": {"reputation": 153, "user_id": 7452686, "user_type": "registered", "profile_image": "https://graph.facebook.com/1404472329603931/picture?type=large", "display_name": "Jake McLaughlin", "link": "https://stackoverflow.com/users/7452686/jake-mclaughlin"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1521251817, "post_id": 49331439, "comment_id": 85665573, "body": "it simply returns back an empty list, so I&#39;m assuming its just jumping into the else right away"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1521252572, "post_id": 49331439, "comment_id": 85665699, "body": "No need to assume. If <code>outList</code> returns <code>[]</code> then what can you say for certain about its arguments? It sounds like you need to think more carefully about the site you call <code>outList</code> in <code>main</code>."}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 7452686, "user_type": "registered", "profile_image": "https://graph.facebook.com/1404472329603931/picture?type=large", "display_name": "Jake McLaughlin", "link": "https://stackoverflow.com/users/7452686/jake-mclaughlin"}, "edited": false, "score": 0, "creation_date": 1521250067, "post_id": 49331556, "comment_id": 85665256, "body": "could you explain the \\poly -&gt; part? should the (yline polygon) be (yline poly)? is poly the current polygon in the list?"}, {"owner": {"reputation": 153, "user_id": 7452686, "user_type": "registered", "profile_image": "https://graph.facebook.com/1404472329603931/picture?type=large", "display_name": "Jake McLaughlin", "link": "https://stackoverflow.com/users/7452686/jake-mclaughlin"}, "edited": false, "score": 0, "creation_date": 1521251382, "post_id": 49331556, "comment_id": 85665494, "body": "I get an error: Couldn&#39;t match expected type \u2018[String]\u2019                   with actual type \u2018[Polygon] -&gt; [String]\u2019"}, {"owner": {"reputation": 347, "user_id": 7552087, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/012e376f941c38969adccc532ec3be94?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew P.", "link": "https://stackoverflow.com/users/7552087/andrew-p"}, "reply_to_user": {"reputation": 153, "user_id": 7452686, "user_type": "registered", "profile_image": "https://graph.facebook.com/1404472329603931/picture?type=large", "display_name": "Jake McLaughlin", "link": "https://stackoverflow.com/users/7452686/jake-mclaughlin"}, "edited": false, "score": 0, "creation_date": 1521375714, "post_id": 49331556, "comment_id": 85695276, "body": "Sorry, I wrote that code, on mobile, so I couldn&#39;t compile it. You&#39;re right about the naming issue. Also, I forgot to apply the map to the <code>polygons</code> list. The code should work now, I think."}], "tags": [], "owner": {"reputation": 347, "user_id": 7552087, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/012e376f941c38969adccc532ec3be94?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew P.", "link": "https://stackoverflow.com/users/7552087/andrew-p"}, "is_accepted": false, "score": 1, "last_activity_date": 1521375648, "last_edit_date": 1521375648, "creation_date": 1521249255, "answer_id": 49331556, "question_id": 49331439, "link": "https://stackoverflow.com/questions/49331439/trying-to-create-list-of-strings-from-a-list-of-data-types-in-haskell/49331556#49331556", "title": "Trying to create list of strings from a list of data types in Haskell", "body": "<p>First of all, your current approach is not the best way to write Haskell. It's quite easy to mess something up. Let's try backing up a bit.\nYou said you want \"perform an operation on each polygon\". This is what the  <a href=\"https://hackage.haskell.org/package/base-4.10.1.0/docs/Prelude.html#v:map\" rel=\"nofollow noreferrer\"><code>map</code></a> function is for.</p>\n\n<p>Take a look at the type signature:</p>\n\n<pre><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]\n</code></pre>\n\n<p>In your case, <code>a</code> will be a <code>Polygon</code>, and <code>b</code> will be a <code>String</code>. So the map function would take a function, and a list of Polygons, and return a list of strings, which is what you want.</p>\n\n<p>However, you'll need to use some function composition, as well as a lambda, to create a single function that takes a <code>Polygon</code> and outputs a <code>String</code>.\nHere is a possible example of what you could do: </p>\n\n<pre><code>outList :: [Polygon] -&gt; [String]\noutList polygons = map (\\poly -&gt; lengthsToString . fromJust $\n                                 calcPerim (yline poly) (points poly)) polygons\n</code></pre>\n\n<p>In general, you should try to avoid explicit recursion in Haskell, and rather use the Prelude's functions that will do what you need for you. It also gives cleaner, more clear, and shorter code than if you tried to do it manually.</p>\n"}], "owner": {"reputation": 153, "user_id": 7452686, "user_type": "registered", "profile_image": "https://graph.facebook.com/1404472329603931/picture?type=large", "display_name": "Jake McLaughlin", "link": "https://stackoverflow.com/users/7452686/jake-mclaughlin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 453, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1521375648, "creation_date": 1521248129, "last_edit_date": 1521248955, "question_id": 49331439, "link": "https://stackoverflow.com/questions/49331439/trying-to-create-list-of-strings-from-a-list-of-data-types-in-haskell", "title": "Trying to create list of strings from a list of data types in Haskell", "body": "<p>I am trying to take in a list of data types (Polygon), perform an operation on each polygon (calcPerim) which returns a (Double, Double). In which i then convert into a string (lengthsToString). I would like to have a list with all of these said strings.   </p>\n\n<pre><code>import System.IO\nimport Data.List\nimport Text.Printf\n\ntype Point = (Double, Double)\ntype Segment = (Point, Point)\ntype Length = Double\n\ndata Polygon = Polygon { vertices :: Int\n                       , yline :: Double\n                       , points :: [Point]\n                       } deriving (Show)\n\nmain = do  \n    let list = []\n    handle &lt;- openFile \"polycake.in\" ReadMode\n    contents &lt;- hGetContents handle\n    let singlewords = words contents\n        list = fileToList singlewords\n        n = list!!0\n        list' = drop 1 list\n        polygons = polyList n list'  \n        output = outList polygons n\n    print (output)\n    hClose handle \n\n\noutList :: [Polygon] -&gt; Int -&gt; [String]\noutList polygons i =\n    if i &lt; length polygons\n        then\n            let polygon = polygons!!i\n                perim = calcPerim (yline polygon) (points polygon)\n                perim' = fromJust perim\n                lenString = lengthsToString perim'\n                nextString = outList polygons (i+1)\n            in (lenString:nextString)\n    else []\n\n\nshow3Decimals :: Double -&gt; String\nshow3Decimals x = printf \"%.3f\" x\n\nlengthsToString :: (Double, Double) -&gt; String\nlengthsToString (min, max) = show3Decimals min ++ \" \" ++ show3Decimals max\n\nmaxLength :: (Length, Length) -&gt; Length\nmaxLength (a, b) =\n    if a &gt; b\n        then a\n        else b\n\nminLength :: (Length, Length) -&gt; Length\nminLength (a, b) =\n    if a &lt; b\n        then a\n        else b\n\n--unwraps value from Just\nfromJust :: Maybe a -&gt; a\nfromJust Nothing  = error \"Maybe.fromJust: Nothing\"\nfromJust (Just x) = x\n\n--function to convert file to a list of Ints\n--In: list of strings\n--Out: list of Ints\nfileToList :: [String] -&gt; [Int]\nfileToList = map read\n\n--function to create a list of Polygon data types\n--In: # of test cases, list containing test case data\n--Out: list of Polygons\npolyList :: Int -&gt; [Int] -&gt; [Polygon]\npolyList n [] = []\npolyList _ [x] = error \"Too few points remaining\"\npolyList n (v:y:list') =\n    let pointList = take (2*v) list' -- Note: list' may not *have* 2*v points\n        points = getPoints pointList\n        list'' = drop (2*v) list'\n        poly = Polygon { vertices = v, yline = fromIntegral y, points = points}\n        nextPoly = polyList (n-1) list''\n    in (poly:nextPoly)\n\n--function to convert a list of ints, into a list of tuples containing 2 Doubles\n--In: list of ints\n--Out: list of Points\ngetPoints :: [Int] -&gt; [Point]\ngetPoints [] = []\ngetPoints (k:v:t) = (fromIntegral k, fromIntegral v) : getPoints t\n\n\n\n-- Check whether a segment is over, under or on the line given by y\nsegmentCompare :: Double -&gt; Segment -&gt; Ordering\nsegmentCompare y (p,q) =                                                                          \n    case () of                                                                                        \n        _ | all (`isUnder` y) [p,q] -&gt; LT\n        _ | all (`isOver` y)  [p,q] -&gt; GT\n        _ -&gt; EQ\n\n\n\n-- Partition a list into (lt, eq, gt) based on f\npartition3 :: (Segment -&gt; Ordering) -&gt; [Segment] -&gt; ([Segment], [Segment], [Segment])\npartition3 f = p' ([], [], [])\n  where\n    p' (lt, eq, gt) (x:xs) =\n        case f x of\n            LT -&gt; p' (x:lt, eq, gt) xs\n            EQ -&gt; p' (lt, x:eq, gt) xs\n            GT -&gt; p' (lt, eq, x:gt) xs\n    p' result [] = result\n\n\n\n-- Split a crossing segment into an under part and over part, and return middle\ndivvy :: Double -&gt; Segment -&gt; (Segment, Segment, Point)\ndivvy y (start, end) =\n    if start `isUnder` y\n    then ((start, middle), (middle, end), middle)\n    else ((middle, end), (start, middle), middle)\n  where\n    middle = intersectPoint y (start, end)\n\n\n\n-- Split a polygon in two, or Nothing if it's not convex enough\nsplitPolygon :: Double -&gt; [Point] -&gt; Maybe ([Segment], [Segment])\nsplitPolygon y list = do\n    let (under, crossing, over) = partition3 (segmentCompare y) pairs\n    case crossing of\n        -- No lines cross. Simple.\n        [] -&gt; return (under, over)\n        -- Two segments cross. Divide them up.\n        [(p1,p2),(q1,q2)] -&gt;\n            let (u1, o1, mid1) = divvy y (p1,p2)\n                (u2, o2, mid2) = divvy y (q1, q2)\n                split = (mid1, mid2) :: Segment\n            in return (split:u1:u2:under, split:o1:o2:over)\n        -- More segments cross. Algorithm doesn't work.\n        rest -&gt; fail \"Can't split polygons concave at y\"\n  where\n    pairs = zip list (drop 1 $ cycle list) :: [Segment]\n\n\n\n-- \ncalcPerim :: Double -&gt; [Point] -&gt; Maybe (Length, Length)\ncalcPerim y list = do\n    (under, over) &lt;- (splitPolygon y list :: Maybe ([Segment], [Segment]))\n    return (sumSegments under, sumSegments over)\n\n\n\n-- Self explanatory helpers\ndistance :: Segment -&gt; Length\ndistance ((ax, ay), (bx, by)) = sqrt $ (bx-ax)^2 + (by-ay)^2\n\nintersectPoint :: Double -&gt; Segment -&gt; Point\nintersectPoint y ((px, py), (qx, qy)) =\n    let t = (y-py)/(qy-py)\n        x = px + t * (qx - px)\n    in\n        (x,y)\n\n\nsumSegments :: [Segment] -&gt; Length\nsumSegments = sum . map distance\n\nisUnder :: Point -&gt; Double -&gt; Bool\nisUnder (_, py) y = py &lt; y\nisOver (_, py) y = py &gt; y\n</code></pre>\n\n<p>Some sample input:</p>\n\n<pre><code>3\n4 2\n0 0\n4 0\n4 4\n0 4\n6 10\n3 15\n10 1\n12 5\n11 19\n9 23\n6 20\n3 5\n0 0\n10 0\n0 10\n</code></pre>\n\n<p>Sample output:</p>\n\n<pre><code>12.000 12.000\n25.690 35.302\n17.071 27.071\n</code></pre>\n\n<p>The main issue is in the outList function, as I have tested everything else, now I would just like to get the output into a list so I can print it out in a very certain way. As I need to pass the test cases by doing a \"diff\" between the output of my program and one given.</p>\n"}, {"tags": ["haskell", "types", "monads"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1521243923, "post_id": 49330826, "comment_id": 85663938, "body": "&quot;However, it does not compile if the (non-top-level) type declaration for the value write&#39; is removed&quot; -- I can&#39;t reproduce this with GHC 8.2.2 and the latest version of the <a href=\"https://hackage.haskell.org/package/list-t-1.0.0.1/docs/ListT.html\" rel=\"nofollow noreferrer\"><i>list-t</i> package</a>. Are you using something different? What the compiler error you get is?"}, {"owner": {"reputation": 161, "user_id": 9261858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6df1d12f9e960a7d9227643a8570fbdd?s=128&d=identicon&r=PG&f=1", "display_name": "Retired Writing Code for Fun", "link": "https://stackoverflow.com/users/9261858/retired-writing-code-for-fun"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1521244290, "post_id": 49330826, "comment_id": 85664008, "body": "duplode --- you are correct, this version DOES compile without the declaration for write&#39;. I had made a last-minute simplification to my code, replacing Writer [String] by Writer String. I shall edit my question back to the Writer [String] version, in which the problem occurs. I shall also answer your other questions. Thanks in advance!"}], "answers": [{"tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": false, "score": 3, "last_activity_date": 1521248664, "last_edit_date": 1521248664, "creation_date": 1521248029, "answer_id": 49331425, "question_id": 49330826, "link": "https://stackoverflow.com/questions/49330826/can-the-type-of-this-function-be-declared-in-standard-haskell/49331425#49331425", "title": "Can the type of this function be declared in standard Haskell", "body": "<p>Using GHCi (remember to put this into a separate file and load it on GHCi's command line lest you get confused by GHCi's altered typing rules):</p>\n\n<pre><code>&gt; :t write\nwrite :: (Applicative (m (Writer [String])), MonadTrans m) =&gt; \n         String -&gt; m (Writer [String]) ()\n</code></pre>\n\n<p>Why? Well,</p>\n\n<pre><code>write' :: MonadTrans m =&gt; m (Writer [String]) ()\nwhen :: Applicative f =&gt; Bool -&gt; f () -&gt; f ()\nwhen logging :: Applicative f =&gt; f () -&gt; f ()\n</code></pre>\n\n<p>so, <code>when logging write'</code> must unify <code>write'</code>'s <code>m (Writer [String])</code> with <code>when loggings</code>'s <code>f</code>, causing the combined constraint <code>(Applicative (m (Writer [String])), MonadTrans m)</code>. But wait, let's remove the type signatures and see what the most general type is:</p>\n\n<pre><code>-- equivalent but slightly easier to talk about\nwrite = when logging . lift . tell . (:[])\n\n(:[]) :: a -&gt; [a]\ntell :: MonadWriter w m -&gt; w -&gt; m ()\nlift :: (Monad m, MonadTrans t) =&gt; m a -&gt; t m a\ntell . (:[]) :: MonadWriter [a] m =&gt; a -&gt; m ()\nlift . tell . (:[]) :: (MonadWriter [a] m, MonadTrans t) =&gt; a -&gt; t m ()\nwhen logging . lift . tell . (:[]) = write\n  :: (Applicative (t m), MonadWriter [a] m, MonadTrans t) =&gt; a -&gt; t m ()\n-- GHCi agrees\n</code></pre>\n\n<p>Per se, there's nothing wrong with this type. However, standard Haskell does not allow this. In standard Haskell, a constraint must be of the form <code>C v</code> or <code>C (v t1 t2 ...)</code> where <code>v</code> is a type variable. In the compiling case, this holds: the <code>Applicative</code> constraint has the type variable <code>m</code> on the outside, and the <code>MonadTrans</code> is just <code>m</code>. This is true in the non-compiling version, too, but we also have the constraint <code>MonadWriter ([] a) m</code>. <code>[]</code> is no type variable, so the type here is rejected. This constraint arises in the compiling version, too, but the type signatures nail the variables down to produce <code>MonadWriter [String] (Writer [String])</code>, which is immediately satisfied and does not need to appear in the context of <code>write</code>.</p>\n\n<p>The restriction is lifted by enabling <code>FlexibleContexts</code> (preferably via a <code>{-# LANGUAGE FlexibleContexts #-}</code> pragma, but also maybe by <code>-XFlexibleContexts</code>). It originally existed to prevent things such as the following:</p>\n\n<pre><code>class C a where c :: a -&gt; a\n-- no instance C Int\n\nfoo :: C Int =&gt; Int\nfoo = c (5 :: Int)\n-- with NoFlexibleContexts: foo's definition is in error\n-- with FlexibleContexts: foo is fine; all usages of foo are in error for\n-- not providing C Int. This might obscure the source of the problem.\n\n-- slightly more insiduous\ndata Odd a = Odd a\n-- no Eq (Odd a)\n\noddly (Odd 0) (Odd 0) = False\noddly l r = l == r\n-- oddly :: (Num a, Eq (Odd a), Eq a) =&gt; Odd a -&gt; Odd a -&gt; Bool\n-- Now the weird type is inferred! With FlexibleContexts,\n-- the weird constraint can propagate quite far, causing errors in distant\n-- places. This is confusing. NoFlexibleContexts places oddly in the spotlight.\n</code></pre>\n\n<p>But it happens to get in the way a lot when you have <code>MultiParamTypeClasses</code> on.</p>\n"}], "owner": {"reputation": 161, "user_id": 9261858, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6df1d12f9e960a7d9227643a8570fbdd?s=128&d=identicon&r=PG&f=1", "display_name": "Retired Writing Code for Fun", "link": "https://stackoverflow.com/users/9261858/retired-writing-code-for-fun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1521248664, "creation_date": 1521242847, "last_edit_date": 1521244369, "question_id": 49330826, "link": "https://stackoverflow.com/questions/49330826/can-the-type-of-this-function-be-declared-in-standard-haskell", "title": "Can the type of this function be declared in standard Haskell", "body": "<p>The following program compiles under GHC 8.0.2 with no language extensions, and produces the expected two lines of output.</p>\n\n<p>However, it does not compile if the (non-top-level) type declaration for the value write' is removed.</p>\n\n<p>Also, I cannot find any (top-level) type declaration for the function write.</p>\n\n<p>I find this rather odd. If this is acceptable standard Haskell, surely it should be possible to create a type declaration for the function write.</p>\n\n<p>So my question is: is there such a type declaration?</p>\n\n<pre><code>import Control.Monad.Trans.Maybe (MaybeT, runMaybeT)\nimport Control.Monad.Writer (MonadTrans, Writer, lift, runWriter, tell, when)\nimport ListT (ListT, toList) -- Volkov's list-t package\n\nlogging = True\n\nwrite x = when logging write' where\n    write' :: MonadTrans m =&gt; m (Writer [String]) ()\n    write' = lift $ tell [x]\n\nf :: ListT (Writer [String]) String\nf = do\n    write \"Hello from f\"\n    return \"ABC\"\n\ng :: MaybeT (Writer [String]) Int\ng = do\n    write \"Hello from g\"\n    return 123\n\nmain :: IO ()\nmain = do\n    print $ runWriter $ toList f\n    print $ runWriter $ runMaybeT g\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "palindrome"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1521243549, "post_id": 49330790, "comment_id": 85663856, "body": "Can you tell us your exact problem statement? &quot;[Making] my function palindrome work with any type of list (simple and nested)&quot; sounds like a rather odd requirement. There are ways to achieve something like that, but they won&#39;t be as pretty or as convenient as you&#39;d like."}, {"owner": {"reputation": 33, "user_id": 7848110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/762c17b0876ef8d501434079e75b23df?s=128&d=identicon&r=PG&f=1", "display_name": "Julio CMC", "link": "https://stackoverflow.com/users/7848110/julio-cmc"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1521244300, "post_id": 49330790, "comment_id": 85664010, "body": "the statment says that given that input: &gt; palindrome [[1,2,2,1], [3,7,9,9],[3,7,9,9], [1,2,2,1]], the output should be something like this: &gt; The list is palindrome horizontally and vertically. I have to code the function palindome, which is: palindrome :: [a] -&gt; (Here a String of Bool to tell that the list is palindrome) taking into account that the function should work with single and nested lists,"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1521278735, "post_id": 49330790, "comment_id": 85670420, "body": "Writing <code>if left_right xs &amp;&amp; up_down xs then True else False</code> is a more complex way of writing <code>left_right xs &amp;&amp; up_down xs</code>. Also, writing <code>if x then y else False</code> is a complex way of writing <code>x &amp;&amp; y</code>."}], "answers": [{"tags": [], "owner": {"reputation": 831, "user_id": 3371760, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/09370cd5d499c9f0f75b54aa1b4daa17?s=128&d=identicon&r=PG", "display_name": "Fried Brice", "link": "https://stackoverflow.com/users/3371760/fried-brice"}, "is_accepted": false, "score": 0, "last_activity_date": 1521247244, "last_edit_date": 1521247244, "creation_date": 1521246129, "answer_id": 49331206, "question_id": 49330790, "link": "https://stackoverflow.com/questions/49330790/haskell-polymorphic-function-that-checks-if-a-list-is-palindrome/49331206#49331206", "title": "Haskell polymorphic function that checks if a list is palindrome", "body": "<blockquote>\n  <p>My question is: How can I make my function palindrome, work with any type of list (simple and nested) taking into account the error I mentioned before. Thanks in advance!</p>\n</blockquote>\n\n<p>Let's think about this hypothetical <code>palindrome</code> function and try to figure out what type signature it would need. (Thinking about a function in terms of its type signature always helps me.)</p>\n\n<p>Suppose <code>palindrome</code> has a signature <code>palindrome :: [x] -&gt; Bool</code></p>\n\n<p>We what the following statements to be true:</p>\n\n<pre><code>palindrome [1, 2, 1] === True\npalindrome [1, 2, 2] === False\npalindrome [[1, 2, 1], [3, 4, 3], [1, 2, 1]] === True\npalindrome [[1, 2, 2], [3, 4, 3], [1, 2, 2]] === False\n</code></pre>\n\n<p>In the first two assertions, <code>palindrome</code> specializes to <code>[Integer] -&gt; Bool</code>, so <code>x</code> is <code>Integer</code> in those cases. The only sensible implementation with <code>x === Integer</code> is simply to check if the supplied list of integers is a palindrome, i.e., check that the first element equals the last, pop those off and repeat (or, equivalently, check that <code>xs</code> equals <code>reverse xs</code> as you have). We can use this algorithm whenever <code>x</code> is an instance of <code>Eq</code>.</p>\n\n<p>In the last two properties, <code>palindrome</code> specializes to <code>[[Integer]] -&gt; Bool</code>, so <code>x</code> is <code>[Integer]</code> there. It seems like we should be able to detect that <code>x</code> is itself a list of integers, and then know that we need to recursively apply palindrome to each inner list. However, Haskell polymorphism doesn't work that way. In order for a function to be polymorphic over a type parameter <code>x</code>, we need to define a single implementation of that function that works the same way <em>no matter what type <code>x</code> happens to be</em>.</p>\n\n<p>In other words, to define a polymorphic function <code>palindrome :: [x] -&gt; Bool</code>, our implementation cannot know anything about the type parameter <code>x</code>. This forces us to use the same implementation when <code>x === [Integer]</code> as we used when <code>x === Integer</code>, which would evaluate to <code>True</code> instead of <code>False</code> for the final test case.</p>\n\n<p>You won't be able to make your <code>palindrome</code> function work the way you want it to for nested lists in Haskell if you insist on the input being standard <code>[]</code> types.</p>\n\n<p>One thing you might do is have your <code>palindrome</code> function take an extra parameter of type <code>Int</code> that tells the function how deeply to check. In that case, you'd need to know ahead of time how deeply nested your input is. Another thing you might do is write your <code>palindrome</code> function to take input in some other data structure besides <code>[]</code>, like a <code>Tree</code>, or something with arbitrary nesting. Maybe you can write your function to accept a <code>Value</code>, a type that represents arbitrary JSON values from the popular library <a href=\"https://hackage.haskell.org/package/aeson-1.3.0.0/docs/Data-Aeson-Types.html\" rel=\"nofollow noreferrer\">Aeson</a>.</p>\n\n<p><em>Note:</em> It's probably a good idea for <code>palindrome []</code> to be <code>True</code>, no?</p>\n"}, {"tags": [], "owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "is_accepted": false, "score": 0, "last_activity_date": 1524095921, "creation_date": 1524095921, "answer_id": 49910684, "question_id": 49330790, "link": "https://stackoverflow.com/questions/49330790/haskell-polymorphic-function-that-checks-if-a-list-is-palindrome/49910684#49910684", "title": "Haskell polymorphic function that checks if a list is palindrome", "body": "<p>You could use a typeclass.</p>\n\n<pre><code>class Palindrome a where\n  palindrome :: a -&gt; Bool\n\ninstance Palindrome Integer where\n  palindrome _ = True\n\ninstance (Eq a, Palindrome a) =&gt; Palindrome [a] where\n  palindrome xs = xs == reverse xs &amp;&amp; all palindrome xs\n</code></pre>\n\n<p>For a two-dimensional list, you are checking if the list is a palindrome, \"both horizontally and vertically\". This can be done without the <code>transpose</code> function: the list is a palindrome \"vertically\" if the list is a palindrome, and the list is a palindrome \"horizontally\" if every sublist is a palindrome. The second <code>instance</code> checks both.</p>\n\n<p>For a one-dimensional list, the second <code>instance</code> simply checks if the list is a palindrome. In this case, the <code>&amp;&amp; all palindrome xs</code> might as well not be there: since the first <code>instance</code> specifies that <code>Integer</code>s are always palindromes, <code>all palindrome xs</code> always evaluates to <code>True</code>. This can be seen as the \"base case\" for this recursive algorithm.</p>\n\n<p>This will work for any depth of nested lists. You can also instantiate the class for other base data types, or (I'm pretty sure) even for ALL types of class <code>Eq</code> (although this leads to overlapping instances which is its own can of worms).</p>\n"}], "owner": {"reputation": 33, "user_id": 7848110, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/762c17b0876ef8d501434079e75b23df?s=128&d=identicon&r=PG&f=1", "display_name": "Julio CMC", "link": "https://stackoverflow.com/users/7848110/julio-cmc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 523, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1524095921, "creation_date": 1521242540, "question_id": 49330790, "link": "https://stackoverflow.com/questions/49330790/haskell-polymorphic-function-that-checks-if-a-list-is-palindrome", "title": "Haskell polymorphic function that checks if a list is palindrome", "body": "<p>I'm trying to solve this excercise but I can't think of a solution.\nI need to check if a list is palindrome, taking these considerations:<br/>\nIf the list is simple I just need to check if it's palindrome horizontally, but if it's a nested list I need to check both, vertical and horizontal.<br/> I also need to keep in mind that each element inside the list has to be palindrome by itself, for example:</p>\n\n<p><strong>A = [1,2,3,3,2,1]</strong>  is palindrome<br/>\n<br/>\nfor this case I just created a single function that uses <strong>reverse</strong> : </p>\n\n<pre><code>unidimensional:: (Eq a) =&gt; [a] -&gt; Bool\nunidimensional [] = error\"List is empty.\"\nunidimensional xs = xs == reverse xs\n</code></pre>\n\n<p>also this case, for example:<br/>\n<br/>\n<strong>B = [[1,2,1],[1,2,1]]</strong> horizontally palindrome and to check if it's palindrome vertically I just transpose it, <strong>[[1,1],[2,2],[1,1]]</strong> and the result is, yes, it is palindrome both ways.\n<br/>\n<br/>\nI solved this by using the function transpose to evaluate vertically if it is palindrome and then, using the function unidimensional that I used before I check if it's palindrome horizontally, everything fine:</p>\n\n<pre><code>--Checks if it's palindrome horizontally and vertically \nbidimensional:: (Eq a) =&gt; [[a]] -&gt; Bool\nbidimensional [[]] = error\"Empty List.\"\nbidimensional (xs) = if left_right xs &amp;&amp; up_down xs then True else False\n--Checks if it's palindrome horizontally:\nleft_right (x:xs) = if x == reverse x then\nif xs /= [] then bidimensional xs else True \nelse False\n--Checks if it's palindrome vertically:\nup_down:: (Eq a) =&gt; [[a]] -&gt; Bool\nup_down (xs) = left_right ys where ys = transpose xs\ntranspose:: [[a]]-&gt;[[a]]\ntranspose ([]:_) = []\ntranspose x = (map head x) : transpose (map tail x)\n</code></pre>\n\n<p><br/><br/>\nthe problem is here:\n<br/><br/>\nThe input my program needs to receive has to be something like this: \n<br/><br/></p>\n\n<pre><code>&gt; palindrome [[1,2,2,1], [3,7,9,9],[3,7,9,9], [1,2,2,1]]\n</code></pre>\n\n<p>My problem is: my function palindrome should receive as a parameter a list <strong>[a]</strong>, but palindrome should work for nested lists, like <strong>[[[a]]]</strong> or <strong>[[a]]</strong><br/><br/>\npalindrome is the function that takes the input. \n<br/><br/>\nThe thing is that when I get a simple list, my head, which is <strong>x</strong> is a number, and <strong>xs</strong> which is the tail, would be the rest of the numbers, and that's ok, but when palindrome receives a nested list, for example <strong>[[[2,2],[2,2]],[[1,1],[1,1]]]</strong>\nthe head, <strong>x</strong> is now <strong>[[2,2],[2,2]]</strong>, so I can't use my function like, bidimensional because <strong>[[2,2],[2,2]]</strong> is not a list anymore, when I try to call bidimensional with <strong>xs</strong> which is  <strong>[[2,2],[2,2]]</strong>  I get an error: <strong>xs</strong> is now type <strong>a</strong> and not <strong>[[a]]</strong> \n<br/><br/>\n<strong>My question is</strong>: How can I make my function palindrome, work with any type of list (simple and nested) taking into account the error I mentioned before. Thanks in advance!</p>\n"}, {"tags": ["haskell", "agda"], "comments": [{"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 1, "creation_date": 1521257791, "post_id": 49330226, "comment_id": 85666450, "body": "FYI: you don&#39;t need <code>unlines</code> for a multiline string. The compiler will elide whitespace between two <code>\\</code>s in a string literal. You can have <code>&quot;module Hello where \\n\\&lt;ACTUAL NEWLINE&gt;&lt;INDENT&gt;\\data Bool : Set where\\n&quot;</code> etc."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 2, "creation_date": 1521288187, "post_id": 49330226, "comment_id": 85672946, "body": "@HTNW not sure which one is ugliest, to be honest... JavaScript&#39;s back-ticks are missed here."}], "answers": [{"comments": [{"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1523029854, "post_id": 49331242, "comment_id": 86406000, "body": "Is there a tutorial or something explaining how to use Agda as a library? I fear those examples won&#39;t suffice."}], "tags": [], "owner": {"reputation": 1066, "user_id": 1709190, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/312687fd46a3b2a21bb469c2244c0668?s=128&d=identicon&r=PG", "display_name": "asr", "link": "https://stackoverflow.com/users/1709190/asr"}, "is_accepted": false, "score": 6, "last_activity_date": 1521246425, "creation_date": 1521246425, "answer_id": 49331242, "question_id": 49330226, "link": "https://stackoverflow.com/questions/49330226/is-it-possible-to-use-agda-as-a-library/49331242#49331242", "title": "Is it possible to use Agda as a library?", "body": "<p>Yes, it is possible. Agda was designed as a Haskell library plus a main module.</p>\n\n<p>You can see a couple of small examples <a href=\"https://github.com/agda/agda/tree/master/test/api\" rel=\"noreferrer\">here</a>. As a bigger example, I wrote <a href=\"https://github.com/asr/apia\" rel=\"noreferrer\">Apia</a> (shameless plug), which uses Agda as a library.</p>\n\n<p>Please keep in mind that the <em>current</em> Agda <a href=\"https://hackage.haskell.org/package/Agda-2.5.3\" rel=\"noreferrer\">description</a> says: </p>\n\n<blockquote>\n  <p>Note that the Agda package does not follow the package versioning\n  policy, because it is not intended to be used by third-party packages.</p>\n</blockquote>\n\n<p>Of course, it could change.</p>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1521246425, "creation_date": 1521238520, "question_id": 49330226, "link": "https://stackoverflow.com/questions/49330226/is-it-possible-to-use-agda-as-a-library", "title": "Is it possible to use Agda as a library?", "body": "<p>Instead of using Agda on a filesystem (with EMACS, terminal, etc.), is it possible to use it directly from Haskell, as a library? For example:</p>\n\n<pre><code>-- UsingAgda.hs\nimport Agda\n\n-- Prints the type of a term on some Agda code\nmain :: IO ()\nmain = typeOf \"true\" agdaCode where\n\n  agdaCode :: String\n  agdaCode = unlines\n    [\"module Hello where   \"\n    ,\"                     \"\n    ,\"data Bool : Set where\"\n    ,\"  true  : Bool       \"\n    ,\"  false : Bool       \"]\n</code></pre>\n\n<p>The code above would output <code>Bool</code>, because <code>true : Bool</code> on that Agda code.</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1521223439, "post_id": 49326671, "comment_id": 85655637, "body": "Can you post a sample <code>polycake.in</code> file?"}], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 7452686, "user_type": "registered", "profile_image": "https://graph.facebook.com/1404472329603931/picture?type=large", "display_name": "Jake McLaughlin", "link": "https://stackoverflow.com/users/7452686/jake-mclaughlin"}, "edited": false, "score": 0, "creation_date": 1521227381, "post_id": 49327484, "comment_id": 85657645, "body": "Ahhh, ok that makes sense. Thanks so much!"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": true, "score": 2, "last_activity_date": 1521225256, "creation_date": 1521225256, "answer_id": 49327484, "question_id": 49326671, "link": "https://stackoverflow.com/questions/49326671/creating-list-of-polygons-from-a-text-file-in-haskell/49327484#49327484", "title": "Creating list of Polygons from a text file in Haskell", "body": "<p>You are misusing <code>do</code> notation and the <code>return</code> function. <code>return</code> is not just a keyword to specify the return value of a function; it is used to \"wrap\" a value inside the value of a monadic type. While <code>[]</code> is a monad, you aren't using it as such in your function.</p>\n\n<pre><code>polyList :: Int -&gt; [Int] -&gt; [Polygon]\npolyList n [] = []\npolyList _ [x] = error \"Too few points remaining\"\npolyList n (v:y:list') =\n    let pointList = take (2*v) list' -- Note: list' may not *have* 2*v points\n        points = getPoints pointList\n        list'' = drop (2*v) list'\n        poly = Polygon { v = v, y = y, points = points}\n        nextPoly = polyList (n-1) list''\n    in (poly:nextPoly)\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 7452686, "user_type": "registered", "profile_image": "https://graph.facebook.com/1404472329603931/picture?type=large", "display_name": "Jake McLaughlin", "link": "https://stackoverflow.com/users/7452686/jake-mclaughlin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 49327484, "answer_count": 1, "score": 0, "last_activity_date": 1521225256, "creation_date": 1521222246, "last_edit_date": 1521223890, "question_id": 49326671, "link": "https://stackoverflow.com/questions/49326671/creating-list-of-polygons-from-a-text-file-in-haskell", "title": "Creating list of Polygons from a text file in Haskell", "body": "<p>I have read a file of numbers and created a list of numbers from it, now I would like to create a list of Polygons based on the numbers in the list as they have a specific layout/pattern. </p>\n\n<pre><code>type Point = (Double, Double)\n\ndata Polygon = Polygon { v :: Int\n                       , y :: Int\n                       , points :: [Point]  \n                       }\n\nmain = do  \n    let list = []\n    handle &lt;- openFile \"polycake.in\" ReadMode\n    contents &lt;- hGetContents handle\n    let singlewords = words contents\n        list = fileToList singlewords\n        n = list!!0\n        list' = drop 1 list\n        polygons = polyList n list'  \n    hClose handle \n\nfileToList :: [String] -&gt; [Int]\nfileToList = map read\n\npolyList :: Int -&gt; [Int] -&gt; [Polygon]\npolyList n [] = return []\npolyList n list = do\n    let v = list!!0\n        y = list!!1\n        list' = drop 2 list\n        pointList = take (2*v) list'\n        points = getPoints pointList\n        list'' = drop (2*v) list'\n        poly = Polygon { v = v, y = y, points = points}\n        nextPoly = polyList (n-1) list''\n    return (poly:nextPoly)\n\ngetPoints :: [Int] -&gt; [Point]\ngetPoints (k:v:t) = (fromIntegral k, fromIntegral v) : getPoints t\n</code></pre>\n\n<p>However I am getting the errors:</p>\n\n<pre><code>polycake.hs:27:17: error:\n     \u2022 Couldn't match type \u2018[a0]\u2019 with \u2018Polygon\u2019\n      Expected type: [Polygon]\n        Actual type: [[a0]]\n     \u2022 In the expression: return []\n      In an equation for \u2018polyList\u2019: polyList n [] = return []\n   |\n27 | polyList n [] = return []\n   |                 ^^^^^^^^^\n\npolycake.hs:37:5: error:\n    \u2022 Couldn't match type \u2018[Polygon]\u2019 with \u2018Polygon\u2019\n      Expected type: [Polygon]\n        Actual type: [[Polygon]]\n    \u2022 In a stmt of a 'do' block: return (poly : nextPoly)\n      In the expression:\n        do let v = list !! 0\n               y = list !! 1\n               ....\n           return (poly : nextPoly)\n      In an equation for \u2018polyList\u2019:\n          polyList n list\n            = do let v = ...\n                     ....\n                 return (poly : nextPoly)\n   |\n37 |     return (poly:nextPoly)\n   |     ^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n\n<p>I am unsure why I am getting these errors.</p>\n\n<p>Sample polycake.in:</p>\n\n<pre><code>2\n4 2\n0 0\n4 0\n4 4\n0 4\n6 10\n3 15\n10 1\n12 5\n11 19\n9 23\n6 20\n</code></pre>\n\n<p>So the first line is the # of test cases, for each test case starts with 2 numbers, the first being the number of vertices and the second being a y value that is used for a later calculation. Then the following v pairs are the vertices or Points.</p>\n"}, {"tags": ["haskell", "attoparsec"], "answers": [{"comments": [{"owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "edited": false, "score": 0, "creation_date": 1521380572, "post_id": 49327145, "comment_id": 85696727, "body": "Thanks, the note about how it actually works was really useful!"}], "tags": [], "owner": {"reputation": 1349, "user_id": 7655081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b23af7029d2ec53c15d8d9d2cccb0bb?s=128&d=identicon&r=PG&f=1", "display_name": "0xd34df00d", "link": "https://stackoverflow.com/users/7655081/0xd34df00d"}, "is_accepted": true, "score": 3, "last_activity_date": 1521223956, "creation_date": 1521223956, "answer_id": 49327145, "question_id": 49325848, "link": "https://stackoverflow.com/questions/49325848/matching-values-that-carry-onto-multiple-following-lines-with-attoparsec/49327145#49327145", "title": "Matching values that carry onto multiple following lines with attoparsec", "body": "<p>The approach I find really useful when working with parser combinators is to break down the whole problem into smaller pieces. So, I'd just compose the parser bottom-up: a <code>keyValuePair</code> first, and then the whole parser consisting just of <code>many keyValuePair</code>s. The <code>keyValuePair</code> consumes the part before <code>:</code>  and then just eats as many lines without <code>:</code> as it can.</p>\n\n<p>In code:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nimport qualified Data.ByteString.Char8 as BS\nimport qualified Data.Attoparsec.ByteString.Char8 as AT\nimport Control.Applicative\nimport Data.Functor\n\nvaluePart :: AT.Parser BS.ByteString\nvaluePart = AT.takeTill (`BS.elem` \":\\n\") &lt;* AT.endOfLine\n\nkeyValuePair :: AT.Parser (BS.ByteString, BS.ByteString)\nkeyValuePair = do\n    key &lt;- AT.takeTill (== ':')\n    void \": \"\n    valLines &lt;- AT.many1 valuePart\n    pure (key, BS.intercalate \"\\n\" valLines)\n\nparser :: AT.Parser [(BS.ByteString, BS.ByteString)]\nparser = many keyValuePair\n</code></pre>\n\n<p>Running on your input data produces</p>\n\n<pre><code>*Main&gt; AT.parseOnly parser test\nRight [(\"message\",\"123 test\\nabc xys\"),(\"messageA\",\"hmm\"),(\"messageA\",\"testing\"),(\"messageB\",\"aueo\")]\n</code></pre>\n\n<p>Note there is no lookahead, as there is no need for it: as soon as <code>valuePart</code> encounters a <code>:</code>, it just fails, which causes <code>keyValuePair</code> to stop and the next <code>keyValuePair</code> to get run by the top-level <code>many</code> in <code>parser</code>.</p>\n\n<p>BTW you can use <code>trace</code> and <code>traceShow</code> from <code>Debug.Trace</code> instead of <code>unsafePerformIO</code> to produce debugging output.</p>\n"}], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 49327145, "answer_count": 1, "score": 2, "last_activity_date": 1521223956, "creation_date": 1521218946, "last_edit_date": 1521221698, "question_id": 49325848, "link": "https://stackoverflow.com/questions/49325848/matching-values-that-carry-onto-multiple-following-lines-with-attoparsec", "title": "Matching values that carry onto multiple following lines with attoparsec", "body": "<p>I'm trying to parse the following:</p>\n\n<pre><code>message: 123 test\nabc xys\nmessageA: hmm\nmessageA: testing\nmessageB: aueo\nqkhwueoaz\n</code></pre>\n\n<p>Into something like:</p>\n\n<pre><code>[\n  (\"message\", \"123 test\\nabcxyz\"),\n, (\"messageA\", \"hmm\")\n, (\"messageA\",\"testing\")\n, (\"messageB\",\"aueo\\nqkhwueoaz\")\n]\n</code></pre>\n\n<p>However I just can't seem to figure this out, I'm finding some difficulty in that I'm not 100% familiar with attoparsecs functionality (and I can't really see each function being documented as to whether it moves the cursor forward...).</p>\n\n<p>I've read through: <a href=\"https://stackoverflow.com/questions/35358797/multi-line-non-match-with-attoparsec\">Multi-line *non* match with attoparsec</a> and I've got the following code:</p>\n\n<pre><code>isChrisNext :: Parser ()\nisChrisNext = lookAhead (parseChris) *&gt; pure()\n\nnotFollowedBy :: Monad m =&gt; m a -&gt; m b\nnotFollowedBy p = p &gt;&gt; fail \"not followed by\"\n\nrestOfLine :: Parser Text\nrestOfLine = do\n    rest &lt;- takeTill (== '\\n')\n    isEOF &lt;- atEnd\n    if isEOF then\n        return rest\n    else\n        (char '\\n') &gt;&gt; return rest\n\nparseChris :: Parser [Text]\nparseChris = do\n  x &lt;- takeWhile1 (notInClass \":\")\n  _ &lt;- string \":\"\n  x' &lt;- manyTill restOfLine (endOfInput &lt;|&gt; isChrisNext)\n  () &lt;- return $ unsafePerformIO $! do\n    print \"?????????????\"\n    print x\n    print x'\n  return $ x : x'\n</code></pre>\n\n<p>However trying to parse the data with <code>parseChris</code> just returns:\n<code>[ \"message\" ]</code> while I'm expecting <code>(\"message\", \"123 test\\nabcxyz\")</code>.</p>\n\n<p>If I change the lookahead function to:</p>\n\n<pre><code>isChrisNext :: Parser ()\nisChrisNext = lookAhead (string \"message:\") *&gt; pure()\n</code></pre>\n\n<p>I get a more intended output of:</p>\n\n<pre><code>[ \"message\"\n, \"123 test\"\n, \"abc xys\"         \n] \n</code></pre>\n\n<hr>\n\n<p>In addition, the question mentioned earlier also has a comment suggesting an approach of: </p>\n\n<blockquote>\n  <p>Just parse the log times apart by matching on time stamps, and only\n  within each time-entry parse the sub-entries.</p>\n</blockquote>\n\n<p><strong>I'm also aware of a potential issue where a second line could contain a <code>:</code>, but this is not something I need to take into consideration thankfully...</strong></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1521214907, "post_id": 49324630, "comment_id": 85650562, "body": "Please post the full error/code fragment. What is <code>sortFilm</code> doing?"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 6, "creation_date": 1521215549, "post_id": 49324630, "comment_id": 85650978, "body": "function names can not start with an uppercase letter in Haskell, rename your function to <code>filmsSorted</code> and <i>this</i> error will go away"}], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 1, "last_activity_date": 1521217290, "creation_date": 1521217290, "answer_id": 49325382, "question_id": 49324630, "link": "https://stackoverflow.com/questions/49324630/haskell-invalid-type-signature/49325382#49325382", "title": "Haskell &#39;invalid type signature&#39;", "body": "<p>Please post a full example, such as:</p>\n\n<pre><code>import Data.List (reverse, sortBy)\ntype Film = ()\n\nFilmsSorted :: [Film] -&gt; [Film]\nFilmsSorted = reverse . sortBy sortFilm\n\nsortFilm :: Film -&gt; Film -&gt; Bool\nsortFilm = undefined\n</code></pre>\n\n<p>And a full, formatted, error:</p>\n\n<pre><code>GHCi, version 8.4.1: http://www.haskell.org/ghc/  :? for help\nLoaded GHCi configuration from /Users/tommd/.ghci\n[1 of 1] Compiling Main             ( x.hs, interpreted )\n\nx.hs:4:1: error:\n    Invalid type signature: FilmsSorted :: ...\n    Should be of form &lt;variable&gt; :: &lt;type&gt;\n  |\n4 | FilmsSorted :: [Film] -&gt; [Film]\n  | ^^^^^^^^^^^\nFailed, no modules loaded.\n</code></pre>\n\n<p>At this point the error indicates your variable, <code>FilmsSorted</code>, is somehow incorrect.  The error, as @Cubic said, is that variables must start with lower case letters.  So try:</p>\n\n<pre><code>filmsSorted :: ...\nfilmsSorted  = ...\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 9504021, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Sami Rahman", "link": "https://stackoverflow.com/users/9504021/sami-rahman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 0, "closed_date": 1521231700, "answer_count": 1, "score": -5, "last_activity_date": 1521217290, "creation_date": 1521214857, "last_edit_date": 1521214877, "question_id": 49324630, "link": "https://stackoverflow.com/questions/49324630/haskell-invalid-type-signature", "closed_reason": "Not suitable for this site", "title": "Haskell &#39;invalid type signature&#39;", "body": "<pre><code>FilmsSorted :: [Film] -&gt; [Film]  \nFilmsSorted = reverse.sortBy sortFilm \n</code></pre>\n\n<p>i get this error, not sure on how to fix it? (below)</p>\n\n<p>******.hs:89:1: error:\n    Invalid type signature: FilmsSorted ::<br>\n    Should be of form  :: </p>\n\n<p>invalid type signature?</p>\n"}, {"tags": ["windows", "haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1521216405, "post_id": 49324314, "comment_id": 85651559, "body": "Stack issues <a href=\"https://github.com/commercialhaskell/stack/issues/3452\" rel=\"nofollow noreferrer\">#3452</a> and <a href=\"https://github.com/commercialhaskell/stack/issues/3510\" rel=\"nofollow noreferrer\">#3510</a> might be relevant."}], "answers": [{"tags": [], "owner": {"reputation": 126, "user_id": 1579430, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRYYQ.png?s=128&g=1", "display_name": "rmrfhome", "link": "https://stackoverflow.com/users/1579430/rmrfhome"}, "is_accepted": true, "score": 0, "last_activity_date": 1522248125, "creation_date": 1522248125, "answer_id": 49537529, "question_id": 49324314, "link": "https://stackoverflow.com/questions/49324314/any-haskell-stack-command-fails-on-windows-with-this-hostcannotconnect-127-0-0/49537529#49537529", "title": "Any haskell stack command fails on windows with this: HostCannotConnect &quot;127.0.0.1&quot;", "body": "<p>Setting this <strong>registry key</strong> to <strong>0</strong> helped:</p>\n\n<pre><code>HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Internet Settings\\ProxyEnable\n</code></pre>\n"}], "owner": {"reputation": 126, "user_id": 1579430, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/QRYYQ.png?s=128&g=1", "display_name": "rmrfhome", "link": "https://stackoverflow.com/users/1579430/rmrfhome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 49537529, "answer_count": 1, "score": 1, "last_activity_date": 1522248125, "creation_date": 1521213978, "question_id": 49324314, "link": "https://stackoverflow.com/questions/49324314/any-haskell-stack-command-fails-on-windows-with-this-hostcannotconnect-127-0-0", "title": "Any haskell stack command fails on windows with this: HostCannotConnect &quot;127.0.0.1&quot;", "body": "<p>For example:</p>\n\n<pre><code>&gt; stack ghci\nWriting implicit global project config file to: C:\\sr\\global-project\\stack.yaml\nNote: You can change the snapshot via the resolver field there.\nHttpExceptionRequest Request {\nhost                 = \"s3.amazonaws.com\"\nport                 = 443\nsecure               = True\nrequestHeaders       = [(\"Accept\",\"application/json\")]\npath                 = \"/haddock.stackage.org/snapshots.json\"\nqueryString          = \"\"\nmethod               = \"GET\"\nproxy                = Nothing\nrawBody              = False\nredirectCount        = 10\nresponseTimeout      = ResponseTimeoutDefault\nrequestVersion       = HTTP/1.1\n}\n(InternalException (HostCannotConnect \"127.0.0.1\" [Network.Socket.connect: &lt;socket: 508&gt;: failed (Connection refused (WSAECONNREFUSED))]))\n</code></pre>\n\n<p>The curl command form the same console have no problems with resolving the url</p>\n\n<pre><code>&gt; curl https://s3.amazonaws.com/haddock.stackage.org/snapshots.json\n\n\nStatusCode        : 200\nStatusDescription : OK\nContent           : {\"lts-2\":\"lts-2.22\",\"lts-10\":\"lts-10.9\",\"lts-9\":\"lts-9.21\",\"lts-4\":\"lts-4.2\",\"lts-3\":\"lts-3.22\",\"lts-5\":\"lts-5.18\",\"lts\":\"lts-11.0\",\"lts-0\":\"lts-0.7\",\"nightly\":\"nightly-2018-03-16\",\"lts-1\":\"lts-1.15\",\n....\n</code></pre>\n\n<p>Tried to install the same version on the other PC - no such problem.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1521213494, "post_id": 49323990, "comment_id": 85649665, "body": "But function application binds tighter than operators."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1521214126, "post_id": 49324063, "comment_id": 85650080, "body": "Or <code>d . d . d $ 2</code>."}], "tags": [], "owner": {"reputation": 1349, "user_id": 7655081, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b23af7029d2ec53c15d8d9d2cccb0bb?s=128&d=identicon&r=PG&f=1", "display_name": "0xd34df00d", "link": "https://stackoverflow.com/users/7655081/0xd34df00d"}, "is_accepted": false, "score": 4, "last_activity_date": 1521213207, "creation_date": 1521213207, "answer_id": 49324063, "question_id": 49323990, "link": "https://stackoverflow.com/questions/49323990/function-composition-issues/49324063#49324063", "title": "Function Composition issues", "body": "<p>Nope, function application is of higher precedence than <code>.</code> so it gets parsed as <code>d . d . (d 2)</code>. You'll need to put your function composition in parens like this: <code>(d . d . d) 2</code>.</p>\n"}], "owner": {"reputation": 37, "user_id": 9181581, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/81524f81f40f222f0294f539bbcfa436?s=128&d=identicon&r=PG&f=1", "display_name": "GermanNab", "link": "https://stackoverflow.com/users/9181581/germannab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1521213207, "creation_date": 1521212983, "question_id": 49323990, "link": "https://stackoverflow.com/questions/49323990/function-composition-issues", "title": "Function Composition issues", "body": "<p>i want to use the function composition in both ways with brackets and without.\ni try this : </p>\n\n<pre><code>let d = (+5) \n Prelude&gt; d ( d ( d 2))\n 17\n</code></pre>\n\n<p>but if try this : </p>\n\n<pre><code>Prelude&gt; d . d . d 2\n\n&lt;interactive&gt;:12:1: error:\n    * Non type-variable argument in the constraint: Num (a -&gt; c)\n      (Use FlexibleContexts to permit this)\n</code></pre>\n\n<p>why is this happening ? it should be semantic equivalent or not ?</p>\n\n<pre><code> d . a x &lt;=&gt; d (a x) ? \n</code></pre>\n"}, {"tags": ["haskell", "erlang"], "answers": [{"tags": [], "owner": {"reputation": 854, "user_id": 4202532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nwoqalcVgfk/AAAAAAAAAAI/AAAAAAAAAEM/fFK7c7T2Dx8/photo.jpg?sz=128", "display_name": "Elvis Oric", "link": "https://stackoverflow.com/users/4202532/elvis-oric"}, "is_accepted": true, "score": 1, "last_activity_date": 1521213896, "creation_date": 1521213896, "answer_id": 49324278, "question_id": 49323026, "link": "https://stackoverflow.com/questions/49323026/a-way-to-instantly-run-erlang-source-code-files/49324278#49324278", "title": "A way to instantly run ERLANG source code files?", "body": "<blockquote>\n  <p>escript provides support for running short Erlang programs without having to compile them first, and an easy way to retrieve the command-line arguments.</p>\n</blockquote>\n\n<p><a href=\"http://erlang.org/doc/man/escript.html\" rel=\"nofollow noreferrer\">http://erlang.org/doc/man/escript.html</a></p>\n"}], "owner": {"reputation": 327, "user_id": 8052539, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ff2b0f87a3312c4f0295d2bca8c5cbf5?s=128&d=identicon&r=PG&f=1", "display_name": "Ignas", "link": "https://stackoverflow.com/users/8052539/ignas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 49324278, "answer_count": 1, "score": 0, "last_activity_date": 1524557886, "creation_date": 1521210194, "last_edit_date": 1524557886, "question_id": 49323026, "link": "https://stackoverflow.com/questions/49323026/a-way-to-instantly-run-erlang-source-code-files", "title": "A way to instantly run ERLANG source code files?", "body": "<p>Is there any way to run Erlang source file instantly, without the need to compile and then run it?\nFor example in Haskell platform there is runhaskell(.exe?) command.\nI thought maybe there is something similar in Erlang?</p>\n"}, {"tags": ["haskell", "monads", "monad-transformers", "state-monad"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1521268766, "post_id": 49322276, "comment_id": 85668176, "body": "N.B.: Your <code>(&gt;&gt;=)</code> implementation can be simplified to <code>m &gt;&gt;= f = Three $ fmap (&gt;&gt;= counit . fmap (getThree . f)) (getThree m)</code>"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1561315958, "post_id": 49322276, "comment_id": 100013663, "body": "I have written <a href=\"https://stackoverflow.com/q/56726854/2751851\">a follow-up</a> to this question, which was originally planned as an answer here but grew too much in scope. Thanks for drawing my attention to this topic!"}], "answers": [{"comments": [{"owner": {"reputation": 596, "user_id": 2684007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0dc231525b77cbf9b18251173353c74f?s=128&d=identicon&r=PG&f=1", "display_name": "Simon C", "link": "https://stackoverflow.com/users/2684007/simon-c"}, "edited": false, "score": 0, "creation_date": 1521219179, "post_id": 49325487, "comment_id": 85653264, "body": "Thanks, I had gotten as far as the needing-to-distribute step, but I know less about <code>Distributive</code> things than <code>Traversables</code>, and so had gotten stuck there. In re: &quot;What makes you think this is possible?&quot; Well, if the only interesting right adjoints in Hask are isomorphic to Reader, and <code>Monad m =&gt; g a -&gt; Three g f m a</code> is straightforward to characterize with a Reader-y <code>g</code>, you might expect this to be possible. Or have I gotten confused?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 596, "user_id": 2684007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0dc231525b77cbf9b18251173353c74f?s=128&d=identicon&r=PG&f=1", "display_name": "Simon C", "link": "https://stackoverflow.com/users/2684007/simon-c"}, "edited": false, "score": 0, "creation_date": 1521219233, "post_id": 49325487, "comment_id": 85653292, "body": "@SimonC Yes I think you&#39;re right actually, I was actually in the process of removing that sentence while you posted that comment :). I expect it to be straightforward to implement once you&#39;re tooled up with <code>tabulateAdjunction</code> and <code>indexAdjunction</code>."}, {"owner": {"reputation": 596, "user_id": 2684007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0dc231525b77cbf9b18251173353c74f?s=128&d=identicon&r=PG&f=1", "display_name": "Simon C", "link": "https://stackoverflow.com/users/2684007/simon-c"}, "edited": false, "score": 0, "creation_date": 1521219841, "post_id": 49325487, "comment_id": 85653653, "body": "Thanks. This makes my second SO question in which you&#39;ve kindly pointed me towards <code>Distributive</code>! :) To be clear: do you expect the <code>lift</code> recipe to work for all adjunctions or just ones on Hask?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 596, "user_id": 2684007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0dc231525b77cbf9b18251173353c74f?s=128&d=identicon&r=PG&f=1", "display_name": "Simon C", "link": "https://stackoverflow.com/users/2684007/simon-c"}, "edited": false, "score": 0, "creation_date": 1521220105, "post_id": 49325487, "comment_id": 85653795, "body": "Someone like Ed Kmett would be much better positioned to answer that authoritatively than I am. My intuition goes something like this: given that every monad is generated by an adjunction (just not necessarily an adjunction on Hask), it wouldn&#39;t surprise me in the slightest if every monad <i>transformer</i> was also generated by an adjunction."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 596, "user_id": 2684007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0dc231525b77cbf9b18251173353c74f?s=128&d=identicon&r=PG&f=1", "display_name": "Simon C", "link": "https://stackoverflow.com/users/2684007/simon-c"}, "edited": false, "score": 0, "creation_date": 1521220115, "post_id": 49325487, "comment_id": 85653800, "body": "In fact that does appear to be true, see <a href=\"https://stackoverflow.com/questions/24515876/is-there-a-monad-that-doesnt-have-a-corresponding-monad-transformer-except-io\" title=\"is there a monad that doesnt have a corresponding monad transformer except io\">stackoverflow.com/questions/24515876/&hellip;</a>"}, {"owner": {"reputation": 596, "user_id": 2684007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0dc231525b77cbf9b18251173353c74f?s=128&d=identicon&r=PG&f=1", "display_name": "Simon C", "link": "https://stackoverflow.com/users/2684007/simon-c"}, "edited": false, "score": 0, "creation_date": 1521220910, "post_id": 49325487, "comment_id": 85654265, "body": "I agree it seems true. It isn&#39;t exactly a proof, but the fact that <code>return</code> and <code>&gt;&gt;=</code> for <code>Three g f m</code> are constructed using only <code>fmap</code>s, <code>unit</code>, <code>counit</code>, and <code>return</code>/<code>join</code> (none of which is in principle Hask-specific) made me think the transformer construction was totally general. It was less clear to me that the existence of a <code>lift</code> recipe should be, since it was not obvious to me that the ability to transform a monadic <code>m</code> to a monadic <code>t m</code> absolutely implied the existence of a <code>lift</code> recipe when the adjoint functors don&#39;t live entirely in Hask."}, {"owner": {"reputation": 2845, "user_id": 593934, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/nPK3i.jpg?s=128&g=1", "display_name": "winitzki", "link": "https://stackoverflow.com/users/593934/winitzki"}, "edited": false, "score": 0, "creation_date": 1548144317, "post_id": 49325487, "comment_id": 95427169, "body": "For me, the main question is - how do I find the monad transformer for a given base monad. I think the construction with <code>Adjoint f g</code> will not work in general, because we won&#39;t be able to find any adjoint <code>Hask</code> endofunctors <code>f</code>, <code>g</code> such that their composition is equal to a given monad. An example monad for which this monad transformer is (I believe) unavailable: <code>type L z a = Either a (z -&gt; a)</code>, where <code>z</code> is a fixed type. <code>return= Left</code> and <code>bind</code> can be defined, laws hold, but a monad transformer for L (I believe) can&#39;t be found with the adjoint recipe."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 2845, "user_id": 593934, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/nPK3i.jpg?s=128&g=1", "display_name": "winitzki", "link": "https://stackoverflow.com/users/593934/winitzki"}, "edited": false, "score": 0, "creation_date": 1561315743, "post_id": 49325487, "comment_id": 100013606, "body": "@winitzki I have written <a href=\"https://stackoverflow.com/q/56726854/2751851\">a follow-up to this question</a> that attempts to tackle the more general problem. As for your type, in a way it depends on what you want for the transformer. On the one hand, bolting on effects to both sides of the <code>Either</code> does look hard-to-impossible; on the other hand. <code>newtype LM z a = Ready a | Waiting (r -&gt; m a)</code> is a perfectly good transformer on its own."}, {"owner": {"reputation": 2845, "user_id": 593934, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/nPK3i.jpg?s=128&g=1", "display_name": "winitzki", "link": "https://stackoverflow.com/users/593934/winitzki"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1561415725, "post_id": 49325487, "comment_id": 100048212, "body": "@duplode Thank you for an interesting follow-up. I&#39;ve been busy finding the monad transformer for the construction of &quot;free pointed&quot; monad over a given monad <code>g</code>:  I define <code>type L g a = Either a (g a)</code>, and I checked that <code>L g</code> is a lawful monad if <code>g</code> is one. If <code>t m</code> is a monad transformer for <code>g</code> (with foreign monad <code>m</code>) then I think that <code>g (Either a (t m a))</code> is the monad transformer for <code>L</code>. I have not finished the calculations, but this seems promising. Your <code>LM</code> corresponds to <code>Either a (t m a)</code>, but this violates transformer laws (<code>m a -&gt; Either a (t m a)</code> is not monad-preserving)."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 2845, "user_id": 593934, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/nPK3i.jpg?s=128&g=1", "display_name": "winitzki", "link": "https://stackoverflow.com/users/593934/winitzki"}, "edited": false, "score": 0, "creation_date": 1561416932, "post_id": 49325487, "comment_id": 100048505, "body": "@winitzki Good catch about the <code>return</code> transformer law for <code>LM</code>! Interestingly, there was <a href=\"https://github.com/Gabriel439/Haskell-Pipes-Library/issues/179\" rel=\"nofollow noreferrer\">a discussion about an analogous situation in the <i>pipes</i> issue tracker</a> a while ago."}, {"owner": {"reputation": 2845, "user_id": 593934, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/nPK3i.jpg?s=128&g=1", "display_name": "winitzki", "link": "https://stackoverflow.com/users/593934/winitzki"}, "edited": false, "score": 0, "creation_date": 1561421774, "post_id": 49325487, "comment_id": 100049384, "body": "Note that <code>g (Either a (t m a))</code> wraps your <code>LM</code> in an additional layer of <code>g</code>. Very similarly, the &quot;correct&quot; ListT and FreeT transformers must add an additional monad layer on the outside. I would be interested to know whether this somehow follows from any construction with adjunctions."}, {"owner": {"reputation": 2845, "user_id": 593934, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/nPK3i.jpg?s=128&g=1", "display_name": "winitzki", "link": "https://stackoverflow.com/users/593934/winitzki"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1561510118, "post_id": 49325487, "comment_id": 100084283, "body": "@duplode I have been looking systematically for monads whose transformer composes outside of the foreign monad. The <code>Reader</code> monad is one example, but I have found a wider class of monads with this property, which I call &quot;rigid&quot; monads. They are not <code>Distributive</code>, in general. For example, if <code>p</code> is a fixed type and <code>R</code> is defined by <code>type R a = (a -&gt; p) -&gt; a</code> then <code>R</code> is a rigid monad whose transformer works on a foreign monad <code>m</code> as <code>t m a = (m a -&gt; p) -&gt; m a</code>. See <a href=\"https://stackoverflow.com/questions/39649497/is-this-property-of-a-functor-stronger-than-a-monad\" title=\"is this property of a functor stronger than a monad\">stackoverflow.com/questions/39649497/&hellip;</a> for my post on rigid functors."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 2845, "user_id": 593934, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/nPK3i.jpg?s=128&g=1", "display_name": "winitzki", "link": "https://stackoverflow.com/users/593934/winitzki"}, "edited": false, "score": 0, "creation_date": 1561547322, "post_id": 49325487, "comment_id": 100098170, "body": "@winitzki Ooh, nice! While I had read that post three years ago (as the upvote markers tell me), I didn&#39;t understand the problem well enough back then to fully appreciate the implications. This notion of rigidity plays right into some experiments I have been doing lately with <code>Distributive</code>, though I hadn&#39;t succeeded in identifying anything like another step in the class hierarchy. I will think a bit more about this and then comment on your question later."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 3, "last_activity_date": 1521283984, "last_edit_date": 1521283984, "creation_date": 1521217656, "answer_id": 49325487, "question_id": 49322276, "link": "https://stackoverflow.com/questions/49322276/adjoint-functors-determine-monad-transformers-but-wheres-lift/49325487#49325487", "title": "Adjoint functors determine monad transformers, but where&#39;s lift?", "body": "<blockquote>\n  <p>How can we upgrade a monadic <code>m a</code> into a monadic <code>Three g f m a</code>? </p>\n</blockquote>\n\n<p>Good question. Time for a game of type tennis!</p>\n\n<pre><code>-- i'm using Adjuction from the adjunctions package because I'll need the fundeps soon\nlift :: Adjunction f g =&gt; m a -&gt; Three g f m a\nlift mx = Three _\n</code></pre>\n\n<p>The hole is typed <code>g (m (f a))</code>. We have <code>mx :: m a</code> in scope, and of course <code>unit :: a -&gt; g (f a)</code> and <code>fmap :: (a -&gt; b) -&gt; m a -&gt; m b</code>.</p>\n\n<pre><code>lift mx = let mgfx = fmap unit mx\n          in Three $ _ mgfx\n</code></pre>\n\n<p>Now it's <code>_ :: m (g (f a)) -&gt; g (m (f a))</code>. This is <a href=\"https://hackage.haskell.org/package/distributive-0.5.3/docs/Data-Distributive.html#v:distribute\" rel=\"nofollow noreferrer\"><code>distribute</code></a> if <code>g</code> is <a href=\"https://hackage.haskell.org/package/distributive-0.5.3/docs/Data-Distributive.html#t:Distributive\" rel=\"nofollow noreferrer\"><code>Distributive</code></a>.</p>\n\n<pre><code>lift mx = let mgfx = fmap unit mx\n              gmfx = distributeR mgfx\n          in Three gmfx\n-- or\nlift = Three . distributeR . fmap unit\n</code></pre>\n\n<p>So now we just need to prove that the right hand side of an adjunction is always <code>Distributive</code>:</p>\n\n<pre><code>distributeR :: (Functor m, Adjunction f g) =&gt; m (g x) -&gt; g (m x)\ndistributeR mgx = _\n</code></pre>\n\n<p>Since we need to return a <code>g</code>, the clear choice of methods from <code>Adjunction</code> is <a href=\"https://hackage.haskell.org/package/adjunctions-4.4/docs/Data-Functor-Adjunction.html#v:leftAdjunct\" rel=\"nofollow noreferrer\"><code>leftAdjunct :: Adjunction f g =&gt; (f a -&gt; b) -&gt; a -&gt; g b</code></a>, which uses <code>unit</code> to create a <code>g (f a)</code> and then tears down the inner <code>f a</code> by <code>fmap</code>ping a function.</p>\n\n<pre><code>distributeR mgx = leftAdjunct (\\fa -&gt; _) _\n</code></pre>\n\n<p>I'm going to attack the first hole first, with the expectation that filling it in might tell me something about the second one. The first hole has a type of <code>m a</code>. The only way we can get hold of an <code>m</code> of any type is by <code>fmap</code>ping something over <code>mgx</code>.</p>\n\n<pre><code>distributeR mgx = leftAdjunct (\\fa -&gt; fmap (\\gx -&gt; _) mgx) _\n</code></pre>\n\n<p>Now the first hole has a type of <code>a</code>, and we have <code>gx :: g a</code> in scope. If we had an <code>f (g a)</code> we could use <code>counit</code>. But we do have an <code>f x</code> (where <code>x</code> is currently an ambiguous type variable) and a <code>g a</code> in scope.</p>\n\n<pre><code>distributeR mgx = leftAdjunct (\\fa -&gt; fmap (\\gx -&gt; counit (fa $&gt; gx)) mgx) _\n</code></pre>\n\n<p>It turns out that the remaining hole has an ambiguous type, so we can use anything we want. (It'll be ignored by <code>$&gt;</code>.)</p>\n\n<pre><code>distributeR mgx = leftAdjunct (\\fa -&gt; fmap (\\gx -&gt; counit (fa $&gt; gx)) mgx) ()\n</code></pre>\n\n<hr>\n\n<p>That derivation may have looked like a magic trick but really you just get better at type tennis with practice. The skill of the game is being able to look at the types and apply intuitions and facts about the objects you're working with. From looking at the types I could tell that I was going to need to exchange <code>m</code> and <code>g</code>, and traversing <code>m</code> was not an option (because <code>m</code> is not necessarily <code>Traversable</code>), so something like <code>distribute</code> was going to be necessary.</p>\n\n<p>Besides guessing I was going to need to implement <code>distribute</code>, I was guided by some general knowledge about how adjunctions work.</p>\n\n<p>Specifically, when you're talking about <code>* -&gt; *</code>, the only interesting adjunctions are (uniquely isomorphic to) the <code>Reader</code>/<code>Writer</code> adjunction. In particular, that means any right adjoint on <code>Hask</code> is always <a href=\"https://hackage.haskell.org/package/adjunctions-4.4/docs/Data-Functor-Rep.html#t:Representable\" rel=\"nofollow noreferrer\"><code>Representable</code></a>, as witnessed by <a href=\"https://hackage.haskell.org/package/adjunctions-4.4/docs/Data-Functor-Adjunction.html#v:tabulateAdjunction\" rel=\"nofollow noreferrer\"><code>tabulateAdjunction</code></a> and <a href=\"https://hackage.haskell.org/package/adjunctions-4.4/docs/Data-Functor-Adjunction.html#v:indexAdjunction\" rel=\"nofollow noreferrer\"><code>indexAdjunction</code></a>. I also know that all <code>Representable</code> functors are <code>Distributive</code> (in fact logically the converse is also true, as described in <a href=\"https://hackage.haskell.org/package/distributive-0.5.3/docs/Data-Distributive.html#t:Distributive\" rel=\"nofollow noreferrer\"><code>Distributive</code>'s docs</a>, even though the classes aren't equivalent in power), per <a href=\"https://hackage.haskell.org/package/adjunctions-4.4/docs/Data-Functor-Rep.html#v:distributeRep\" rel=\"nofollow noreferrer\"><code>distributeRep</code></a>.</p>\n\n<hr>\n\n<blockquote>\n  <p>For that matter, how can we upgrade <code>g a</code> into a <code>Three g f m a</code> (provided <code>Adjoint f g</code>)?</p>\n</blockquote>\n\n<p>I'll leave that as an exercise. I suspect you'll need to lean on the <code>g ~ ((-&gt;) s)</code> isomorphism again. I actually don't expect this one to be true of all adjunctions, just the ones on <code>Hask</code>, of which there is only one.</p>\n"}, {"comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1521283922, "post_id": 49333675, "comment_id": 85671753, "body": "Nice answer! Hadn&#39;t thought of doing it like that"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1521344275, "post_id": 49333675, "comment_id": 85688692, "body": "@BenjaminHodgson Incidentally, I don&#39;t think I would have recognised the shape-and-contents decomposition here if I hadn&#39;t read the topic you wrote about it on SO Documentation -- it motivated me to spend some time mulling about the matter back then."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1521368984, "post_id": 49333675, "comment_id": 85693347, "body": "So Docs wasn\u2019t <i>entirely</i> useless, then \ud83d\ude09"}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 3, "last_activity_date": 1522478400, "last_edit_date": 1522478400, "creation_date": 1521272463, "answer_id": 49333675, "question_id": 49322276, "link": "https://stackoverflow.com/questions/49322276/adjoint-functors-determine-monad-transformers-but-wheres-lift/49333675#49333675", "title": "Adjoint functors determine monad transformers, but where&#39;s lift?", "body": "<p><code>lift</code>, in <a href=\"https://stackoverflow.com/a/49325487/2751851\">Benjamin Hodgson's answer</a>, is set up as:</p>\n\n<blockquote>\n<pre><code>lift mx = let mgfx = fmap unit mx\n              gmfx = distributeR mgfx\n          in Three gmfx\n-- or\nlift = Three . distributeR . fmap unit\n</code></pre>\n</blockquote>\n\n<p>As you know, that is not the only plausible strategy we might use there:</p>\n\n<pre><code>lift mx = let gfmx = unit mx\n              gmfx = fmap sequenceL gfmx\n          in Three gmfx\n-- or\nlift = Three . fmap sequenceL . unit\n</code></pre>\n\n<p>Whence the <code>Traversable</code> requirement for <a href=\"https://hackage.haskell.org/package/adjunctions-4.4/docs/Control-Monad-Trans-Adjoint.html#t:AdjointT\" rel=\"nofollow noreferrer\">Edward Kmett's corresponding <code>MonadTrans</code> instance</a> originates. The question, then, becomes whether relying on that is, as you put it, \"cheating\". I am going to argue it is not.</p>\n\n<p>We can adapt Benjamin's game plan concerning <code>Distributive</code> and right adjoints and try to find whether left adjoints are <code>Traversable</code>. A look at <a href=\"https://hackage.haskell.org/package/adjunctions-4.4/docs/Data-Functor-Adjunction.html\" rel=\"nofollow noreferrer\"><code>Data.Functor.Adjunction</code></a> shows we have a quite good toolbox to work with:</p>\n\n<pre><code>unabsurdL :: Adjunction f u =&gt; f Void -&gt; Void\ncozipL :: Adjunction f u =&gt; f (Either a b) -&gt; Either (f a) (f b)\nsplitL :: Adjunction f u =&gt; f a -&gt; (a, f ())\nunsplitL :: Functor f =&gt; a -&gt; f () -&gt; f a\n</code></pre>\n\n<p>Edward helpfully tells us that <code>unabsurdL</code> and <code>cozipL</code> witness that \"[a] left adjoint must be inhabited, [and that] a left adjoint must be inhabited by exactly one element\", respectively. That, however, means <code>splitL</code> corresponds precisely to the shape-and-contents decomposition that characterises <code>Traversable</code> functors. If we add to that the fact that <code>splitL</code> and <code>unsplitL</code> are inverses, an implementation of <code>sequence</code> follows immediately:</p>\n\n<pre><code>sequenceL :: (Adjunction f u, Functor m) =&gt; f (m a) -&gt; m (f a)\nsequenceL = (\\(mx, fu) -&gt; fmap (\\x -&gt; unsplitL x fu) mx) . splitL\n</code></pre>\n\n<p>(Note that no more than <code>Functor</code> is demanded of <code>m</code>, as expected for traversable containers that hold exactly one value.)</p>\n\n<p>All that is missing at this point is verifying that both implementations of <code>lift</code> are equivalent. That is not difficult, only a bit laborious. In a nutshell, the <code>distributeR</code> and <code>sequenceR</code> definitions here can be simplified to:</p>\n\n<pre><code>distributeR = \\mgx -&gt;\n    leftAdjunct (\\fa -&gt; fmap (\\gx -&gt; rightAdjunct (const gx) fa) mgx) ()   \nsequenceL =\n    rightAdjunct (\\mx -&gt; leftAdjunct (\\fu -&gt; fmap (\\x -&gt; fmap (const x) fu) mx) ())\n</code></pre>\n\n<p>We want to show that <code>distributeR . fmap unit = fmap sequenceL . unit</code>. After a few more rounds of simplification, we get:</p>\n\n<pre><code>distributeR . fmap unit = \\mgx -&gt;\n    leftAdjunct (\\fa -&gt; fmap (\\gx -&gt; rightAdjunct (const (unit gx)) fa) mgx) ()\nfmap sequenceL . unit = \\mx -&gt;\n    leftAdjunct (\\fu -&gt; fmap (\\x -&gt; fmap (const x) fu) mx) ()\n</code></pre>\n\n<p>We can show those are really the same thing by picking <code>\\fu -&gt; fmap (\\x -&gt; fmap (const x) fu) mx</code> -- the argument to <code>leftAdjunct</code> in the second right-hand side -- and slipping <code>rightAdjunct unit = counit . fmap unit = id</code> into it:</p>\n\n<pre><code>\\fu -&gt; fmap (\\x -&gt; fmap (const x) fu) mx\n\\fu -&gt; fmap (\\x -&gt; fmap (const x) fu) mx\n\\fu -&gt; fmap (\\x -&gt; (counit . fmap unit . fmap (const x)) fu) mx\n\\fu -&gt; fmap (\\x -&gt; rightAdjunct (unit . const x) fu) mx\n\\fu -&gt; fmap (\\x -&gt; rightAdjunct (const (unit x)) fu) mx\n-- Sans variable renaming, the same as\n-- \\fa -&gt; fmap (\\gx -&gt; rightAdjunct (const (unit gx)) fa) mgx\n</code></pre>\n\n<p>The takeaway is that the <code>Traversable</code> route towards your <code>MonadTrans</code> is just as secure as the <code>Distributive</code> one, and concerns about it -- including the ones mentioned by the <code>Control.Monad.Trans.Adjoint</code> documentation -- should no longer trouble anyone.</p>\n\n<p>P.S.: It is worth noting that the definition of <code>lift</code> put forward here can be spelled as:</p>\n\n<pre><code>lift = Three . leftAdjunct sequenceL\n</code></pre>\n\n<p>That is, <code>lift</code> is <code>sequenceL</code> sent through the adjunction isomorphism. Additionally, from...</p>\n\n<pre><code>leftAdjunct sequenceL = distributeR . fmap unit\n</code></pre>\n\n<p>... if we apply <code>rightAdjunct</code> on both sides, we get...</p>\n\n<pre><code>sequenceL = rightAdjunct (distributeR . fmap unit)\n</code></pre>\n\n<p>... and if we compose <code>fmap (fmap counit)</code> on the left of both sides, we eventually end up with:</p>\n\n<pre><code>distributeR = leftAdjunct (fmap counit . sequenceL)\n</code></pre>\n\n<p>So <code>distributeR</code> and <code>sequenceL</code> are interdefinable.</p>\n"}], "owner": {"reputation": 596, "user_id": 2684007, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0dc231525b77cbf9b18251173353c74f?s=128&d=identicon&r=PG&f=1", "display_name": "Simon C", "link": "https://stackoverflow.com/users/2684007/simon-c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 449, "favorite_count": 2, "accepted_answer_id": 49333675, "answer_count": 2, "score": 7, "last_activity_date": 1522478400, "creation_date": 1521207935, "last_edit_date": 1521282396, "question_id": 49322276, "link": "https://stackoverflow.com/questions/49322276/adjoint-functors-determine-monad-transformers-but-wheres-lift", "title": "Adjoint functors determine monad transformers, but where&#39;s lift?", "body": "<p>I'm intrigued by the construction described <a href=\"https://stackoverflow.com/a/24844388/2684007\">here</a> for determining a monad transformer from adjoint functors. Here's some code that summarizes the basic idea:</p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses #-}\n\nimport           Control.Monad\n\nnewtype Three g f m a = Three { getThree :: g (m (f a)) }\n\nclass (Functor f, Functor g) =&gt; Adjoint f g where\n  counit :: f (g a) -&gt; a\n  unit   :: a -&gt; g (f a)\n\ninstance (Adjoint f g, Monad m) =&gt; Monad (Three g f m) where\n  return  = Three . fmap return . unit\n  m &gt;&gt;= f = Three $ fmap (&gt;&gt;= counit . fmap (getThree . f)) (getThree m)\n\ninstance (Adjoint f g, Monad m) =&gt; Applicative (Three g f m) where\n  pure  = return\n  (&lt;*&gt;) = ap\n\ninstance (Adjoint f g, Monad m) =&gt; Functor (Three g f m) where\n  fmap = (&lt;*&gt;) . pure\n</code></pre>\n\n<p>Given that <code>Adjoint ((,) s) ((-&gt;) s)</code>, <code>Three ((-&gt;) s) ((,) s)</code> appears equivalent to <code>StateT s</code>.</p>\n\n<p>Very cool, but I am puzzled by a couple things:</p>\n\n<ul>\n<li><p>How can we upgrade a monadic <code>m a</code> into a monadic <code>Three g f m a</code>? For the specific case of <code>Three ((-&gt;) s) ((,) s)</code>, it's of course obvious how to do this, but it seems desirable to have a recipe that works for any <code>Three g f</code> provided that <code>Adjoint f g</code>. In other words, it seems like there should be an analog of <code>lift</code> whose definition only requires <code>unit</code>, <code>counit</code>, and the <code>return</code> and <code>&gt;&gt;=</code> of the input monad. But I cannot seem to find one (I have seen <a href=\"https://github.com/ekmett/adjunctions/blob/master/src/Control/Monad/Trans/Adjoint.hs\" rel=\"nofollow noreferrer\">a definition using <code>sequence</code></a>, but this seems a bit like cheating since it requires <code>f</code> to be <code>Traversable</code>).</p></li>\n<li><p>For that matter, how can we upgrade <code>g a</code> into a <code>Three g f m a</code> (provided <code>Adjoint f g</code>)? Again, for the specific case of <code>Three ((-&gt;) s) ((,) s)</code> it's obvious how to do this, but I'm wondering if there's an analog of <code>gets</code> that only requires <code>unit</code>, <code>counit</code>, and the <code>return</code> and <code>&gt;&gt;=</code> of the input monad.</p></li>\n</ul>\n"}, {"tags": ["haskell", "3d", "set"], "answers": [{"comments": [{"owner": {"reputation": 926, "user_id": 1486968, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WvBqy.png?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/1486968/joe"}, "edited": false, "score": 0, "creation_date": 1521203877, "post_id": 49320850, "comment_id": 85642831, "body": "The type in question isn&#39;t a container per say, as it&#39;s not possible to add discreet points to it. I&#39;ll also argue that there is value to having a typeclass here, as the same operations are possible on regions of 2d (or N dimensional) space."}, {"owner": {"reputation": 926, "user_id": 1486968, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WvBqy.png?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/1486968/joe"}, "edited": false, "score": 0, "creation_date": 1521388088, "post_id": 49320850, "comment_id": 85699360, "body": "I&#39;m accepting this, since it&#39;s good advise, and nothing more specific seems to be forthcoming"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 2, "last_activity_date": 1521203494, "creation_date": 1521203494, "answer_id": 49320850, "question_id": 49320784, "link": "https://stackoverflow.com/questions/49320784/does-a-typeclass-exist-for-types-that-support-the-binary-operators-of-sets/49320850#49320850", "title": "Does a typeclass exist for types that support the binary operators of sets", "body": "<p>Many people have tried making unifying typeclasses for container types, and none of them has ever caught on, each for its own reasons. I recommend not bothering; the current standard idiom is to just define the operations for your new type with some standardish names, not worrying about name clashes, with whatever type makes the most sense for your new container. Expect users to import your module qualified and aliased to avoid name clashes (and aid readers as a nice side effect).</p>\n"}], "owner": {"reputation": 926, "user_id": 1486968, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/WvBqy.png?s=128&g=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/1486968/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 49320850, "answer_count": 1, "score": 1, "last_activity_date": 1521204580, "creation_date": 1521203248, "last_edit_date": 1521204580, "question_id": 49320784, "link": "https://stackoverflow.com/questions/49320784/does-a-typeclass-exist-for-types-that-support-the-binary-operators-of-sets", "title": "Does a typeclass exist for types that support the binary operators of sets", "body": "<p>For background, I'm working on a <a href=\"https://en.wikipedia.org/wiki/Constructive_solid_geometry\" rel=\"nofollow noreferrer\" title=\"CSG &#40;Constructive Solid Geometry&#41;\">CSG (Constructive Solid Geometry)</a> library. </p>\n\n<p>Given polygon meshes that enclose regions of space, this library will allow those meshes to be treated as sets of the points that they enclose. And also allow the calculation of the binary operations, <code>union</code>, <code>intersection</code> and <code>difference</code>, on pairs of meshes. </p>\n\n<p>The library will also support set negation. </p>\n\n<p>If required I could also define an <code>elem</code> like function, with type <code>Point -&gt; Mesh -&gt; Bool</code>, it would not be possible to define an <code>add</code> function, as there exists no meaningful way to add a single point to a mesh.</p>\n\n<p>Does a typeclass exist for types that support these operations? \nAnd if not, what would a good implementation of a suitable typeclass look like?</p>\n"}, {"tags": ["haskell", "parallel-processing"], "comments": [{"owner": {"reputation": 891, "user_id": 99978, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/784837d98d18ff99681f612a62dddbcc?s=128&d=identicon&r=PG", "display_name": "j.p.", "link": "https://stackoverflow.com/users/99978/j-p"}, "edited": false, "score": 0, "creation_date": 1521204058, "post_id": 49320693, "comment_id": 85642952, "body": "Are you sure you use more than 1 thread? ghc has an option &quot;-threaded&quot; for compiling with more than 1 thread. The compiled program takes then the option &quot;+RTS -N2&quot; to run it on two cores. Not sure how about doing this with runhaskell."}], "answers": [{"comments": [{"owner": {"reputation": 327, "user_id": 8052539, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ff2b0f87a3312c4f0295d2bca8c5cbf5?s=128&d=identicon&r=PG&f=1", "display_name": "Ignas", "link": "https://stackoverflow.com/users/8052539/ignas"}, "edited": false, "score": 0, "creation_date": 1524558071, "post_id": 49321312, "comment_id": 87009770, "body": "Is there any thorough guide on how to compile Haskell? What arguments to use and what they do?"}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "reply_to_user": {"reputation": 327, "user_id": 8052539, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ff2b0f87a3312c4f0295d2bca8c5cbf5?s=128&d=identicon&r=PG&f=1", "display_name": "Ignas", "link": "https://stackoverflow.com/users/8052539/ignas"}, "edited": false, "score": 0, "creation_date": 1524566458, "post_id": 49321312, "comment_id": 87015111, "body": "<a href=\"https://wiki.haskell.org/Haskell_in_5_steps\" rel=\"nofollow noreferrer\">Here&#39;s a very short introduction</a> to get started.  For all options, check out the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/index.html\" rel=\"nofollow noreferrer\">GHC User&#39;s guide</a>."}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 0, "last_activity_date": 1521204935, "creation_date": 1521204935, "answer_id": 49321312, "question_id": 49320693, "link": "https://stackoverflow.com/questions/49320693/haskell-parallelisation-and-strict-evaluation-in-thread/49321312#49321312", "title": "Haskell parallelisation and strict evaluation in thread..?", "body": "<p>For speed (which is the point of parallelism), Haskell programs should be compiled (with <code>ghc</code>) rather than interpreted (with <code>runghc</code>). I don't know how to actually use <code>runghc</code> for multithreading, if that's possible at all.</p>\n\n<pre><code>ghc W7T5 -threaded -with-rts -N2\n./W7T5\n</code></pre>\n\n<hr>\n\n<p>The <code>parMap</code> implementation isn't correct: the computation <code>(r : parMap f xs)</code> returns immediately and just thunks the tail, which will only be sparked when it will be demanded (but by then it will be too late). The one below sparks both the head and tail before consing them, so by the time the caller see the constructor, the rest of the list is being evaluated in the background.</p>\n\n<pre><code>parMap :: (a -&gt; b) -&gt; [a] -&gt; [b]\nparMap f [] = []\nparMap f (x : xs) = rs `par` r `par` (r : rs)\n  where\n    r = f x\n    rs = parMap f xs\n</code></pre>\n\n<hr>\n\n<p>When you compile your program, you'll probably not see the same buffering behavior as with an interpreter, because executables use line buffering by default. Buffering can be turned off using <code>System.IO.hSetBuffering</code></p>\n\n<pre><code>import System.IO\n\nmain = do\n  hSetBuffering stdout NoBuffering\n  ...\n</code></pre>\n"}], "owner": {"reputation": 327, "user_id": 8052539, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ff2b0f87a3312c4f0295d2bca8c5cbf5?s=128&d=identicon&r=PG&f=1", "display_name": "Ignas", "link": "https://stackoverflow.com/users/8052539/ignas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 49321312, "answer_count": 1, "score": 0, "last_activity_date": 1521204935, "creation_date": 1521203000, "question_id": 49320693, "link": "https://stackoverflow.com/questions/49320693/haskell-parallelisation-and-strict-evaluation-in-thread", "title": "Haskell parallelisation and strict evaluation in thread..?", "body": "<p>I was trying to find prime numbers from a given list of numbers.\nSo far I have piece of code that works, but if I uncomment some lines and comment some others, I don't see any difference in speed.\nI am almost sure that I have to force evaluation in separate thread, as I think I start thread but code is not evaluated there due to laziness. But I couldn't find a way to force that evaluation. I was working based on examples <a href=\"http://book.realworldhaskell.org/read/concurrent-and-multicore-programming.html\" rel=\"nofollow noreferrer\">here</a>. So I made functions <code>parMap</code> and <code>strMap</code> which are parallel map and strict [parallel] map. In <code>parMap</code> there are 2 lines commented, so if you uncomment them, and comment out other 4 lines that are currently not commented, well, you cant notice any difference in speed, although it should be non-parallel and slower then. I also ignore program args for now in <code>main</code> function.</p>\n\n<p>So basically my question is - is it possible to achieve, that for each number in list that is given to <code>parMap</code>, a new thread is spawned and so everything works faster?</p>\n\n<p>here goes the code:</p>\n\n<pre><code>module W7T5\n(\n  main\n) where\n\nimport Control.Concurrent\nimport Control.Parallel (par, pseq)\nimport System.Environment\n\nmain = do\n  args' &lt;- getArgs\n  let\n--    args = map (\\x -&gt; read x :: Int) args'\n    args = [2000000..2000200]\n    tfPrime = parMap isPrime' args\n--    tfPrime = strMap isPrime' args\n    argsNtf = zip args tfPrime\n    primes' = filter (\\(num, tfPrime) -&gt; tfPrime) argsNtf\n    primes = map fst primes'\n  putStrLn (\"Init list: \" ++ show args)\n  putStrLn (\"Primes   : \" ++ show primes)\n\n-- Map in parallel\nparMap :: NFData a =&gt; (a -&gt; b) -&gt; [a] -&gt; [b]\nparMap _ [] =\n  []\n--parMap f (x:xs) = -- sadly without any parallelisation it's not slower\n--  (f x) :parMap f xs\nparMap f (x:xs) =\n  par r (r:parMap f xs)\n  where\n    r = f x\n\n-- Map in parallel strictly\nstrMap :: (a -&gt; b) -&gt; [a] -&gt; [b]\nstrMap f xs =\n  forceList xs `seq` map f xs\n\nforceList :: [a] -&gt; ()\nforceList (x:xs) =\n  xs `pseq` forceList xs\nforceList _ =\n  ()\n\nisPrime' :: Int -&gt; Bool\nisPrime' 0 = True\nisPrime' 1 = True\nisPrime' 2 = True\nisPrime' num =\n  all (/=0) [mod num x | x &lt;- [2..(num-1)]]\n</code></pre>\n\n<p>You can run the program with</p>\n\n<pre><code>runhaskell W7T5.hs 1 2 3 4\n</code></pre>\n"}, {"tags": ["haskell", "ghci"], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 11, "last_activity_date": 1521202535, "last_edit_date": 1521202535, "creation_date": 1521202177, "answer_id": 49320435, "question_id": 49319970, "link": "https://stackoverflow.com/questions/49319970/how-to-search-for-the-types-of-many-functions-in-one-go/49320435#49320435", "title": "How to search for the types of many functions in one go", "body": "<p>ghci includes a <code>:def</code> command. The command has the form <code>:def &lt;name&gt; &lt;function&gt;</code>, where <code>&lt;name&gt;</code> is the new command to define, and <code>&lt;function&gt;</code> is a Haskell function of type <code>String -&gt; IO String</code> saying how to convert arguments to the new command into an existing chain of commands. We can use this to our advantage: we'll make a new command, <code>:manyt</code>, which takes a list of names and runs <code>:t</code> on each. For simplicity, I'll split on spaces; but if you want to ask for the types of many <em>expressions</em> rather than just names you may want to do some more complicated delimiting/parsing. So, in <code>~/.ghci</code>, add a line like this:</p>\n\n<pre><code>:def manyt (\\s -&gt; Prelude.return (Prelude.unlines [\":t \" Prelude.++ n | n &lt;- Prelude.words s]))\n</code></pre>\n\n<p>(The excessive <code>Prelude</code> qualification is so that this works even when <code>-XNoImplicitPrelude</code> is enabled.) Try it out:</p>\n\n<pre><code>&gt; :manyt length take drop splitAt (!!) replicate\nlength :: Foldable t =&gt; t a -&gt; Int\ntake :: Int -&gt; [a] -&gt; [a]\ndrop :: Int -&gt; [a] -&gt; [a]\nsplitAt :: Int -&gt; [a] -&gt; ([a], [a])\n(!!) :: [a] -&gt; Int -&gt; a\nreplicate :: Int -&gt; a -&gt; [a]\n</code></pre>\n"}], "owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 7, "last_activity_date": 1521211656, "creation_date": 1521200553, "last_edit_date": 1521211656, "question_id": 49319970, "link": "https://stackoverflow.com/questions/49319970/how-to-search-for-the-types-of-many-functions-in-one-go", "title": "How to search for the types of many functions in one go", "body": "<p>How can I search for the types of <code>length, take, drop, splitAt, !!</code> and <code>replicate</code> all in one go, without entering in <code>:t length</code>, <code>:t take</code>, <code>:t drop</code>, etc, for all of these functions?</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1521251606, "post_id": 49319307, "comment_id": 85665532, "body": "I think this may be too broad, although it would be great to have a comprehensive answer."}, {"owner": {"reputation": 687, "user_id": 1663294, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1f1f15839995e207042345b821855528?s=128&d=identicon&r=PG", "display_name": "RichardW", "link": "https://stackoverflow.com/users/1663294/richardw"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 3, "creation_date": 1521253897, "post_id": 49319307, "comment_id": 85665881, "body": "@jberryman I don&#39;t see how I can make the question narrower; in order to ask how to make X faster (where X is a specific task that is running slowly), I first need to figure out what X is.  Surely this is a common need..?"}], "answers": [{"tags": [], "owner": {"reputation": 63, "user_id": 572866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d567d587d5444181119f1972f2df8bd3?s=128&d=identicon&r=PG", "display_name": "dchagniot", "link": "https://stackoverflow.com/users/572866/dchagniot"}, "is_accepted": false, "score": 0, "last_activity_date": 1523620624, "creation_date": 1523620624, "answer_id": 49816454, "question_id": 49319307, "link": "https://stackoverflow.com/questions/49319307/how-to-profile-haskell-after-compiler-optimizations/49816454#49816454", "title": "How to profile Haskell after compiler optimizations?", "body": "<p>This is a very general question, but do you have searched for space leaks ?</p>\n\n<p>One nice package is <a href=\"https://hackage.haskell.org/package/weigh\" rel=\"nofollow noreferrer\">weigh</a>.</p>\n\n<p>The author has written a very good <a href=\"https://www.fpcomplete.com/blog/2016/05/weigh-package\" rel=\"nofollow noreferrer\">article</a> about it.</p>\n"}], "owner": {"reputation": 687, "user_id": 1663294, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/1f1f15839995e207042345b821855528?s=128&d=identicon&r=PG", "display_name": "RichardW", "link": "https://stackoverflow.com/users/1663294/richardw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 258, "favorite_count": 3, "answer_count": 1, "score": 13, "last_activity_date": 1523620624, "creation_date": 1521198485, "last_edit_date": 1521421449, "question_id": 49319307, "link": "https://stackoverflow.com/questions/49319307/how-to-profile-haskell-after-compiler-optimizations", "title": "How to profile Haskell after compiler optimizations?", "body": "<p>I have a fairly complex and performance-critical Haskell program. I have used cost center profiling to optimize to the point where there are no major remaining hot spots. Furthermore, the program runs about 15x faster with <code>-O2</code> (and no profiling) than it does with <code>stack build --profile</code>, so I have doubts as to whether the cost center profiler is helping much at all with finding bottlenecks that remain post-optimization.</p>\n\n<p>What are my options for finding hot spots that remain after optimization? I am aware of ticky-ticky profiling, but it is described in the docs as not for \"mere mortals\", and I am a mere mortal. </p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1521194487, "post_id": 49317844, "comment_id": 85636807, "body": "Well your first parameter is a <i>list</i>, but this does not make much sense, if you want to replicate a <i>single</i> element in a list."}], "answers": [{"tags": [], "owner": {"reputation": 662, "user_id": 668354, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Yn84u.jpg?s=128&g=1", "display_name": "Mikkel", "link": "https://stackoverflow.com/users/668354/mikkel"}, "is_accepted": false, "score": 1, "last_activity_date": 1521201131, "creation_date": 1521201131, "answer_id": 49320143, "question_id": 49317844, "link": "https://stackoverflow.com/questions/49317844/replicating-through-a-list-in-haskell/49320143#49320143", "title": "Replicating through a list in Haskell", "body": "<p>I might have misunderstood your intention, but maybe you meant something like this:</p>\n\n<pre><code>replicatee :: a -&gt; Int -&gt; [a]\nreplicatee _ 0 = []\nreplicatee x n = x:replicatee x (n-1)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 0, "last_activity_date": 1521209656, "creation_date": 1521209656, "answer_id": 49322841, "question_id": 49317844, "link": "https://stackoverflow.com/questions/49317844/replicating-through-a-list-in-haskell/49322841#49322841", "title": "Replicating through a list in Haskell", "body": "<pre><code>replicatee :: [a] -&gt; Int -&gt; [a]\nreplicatee [] _ = []\nreplicatee xs 0 = []\nreplicatee (x:xs) n = x:replicatee (x:xs) (n-1): replicatee xs n\n</code></pre>\n\n<p>The problem is that <code>replicatee</code> returns a value of type <code>[a]</code>, but you try to add that to <em>another</em> list of type <code>[a]</code> using <code>(:) :: a -&gt; [a] -&gt; [a]</code>. From a type-checking perspective, you need to use <code>(++)</code>, not <code>(:)</code>:</p>\n\n<pre><code>replicatee xs'@(x:xs) n = x : (replicatee xs' (n-1) ++ replicatee xs n)\n</code></pre>\n\n<p>Whether it <em>does</em> what you intended is another matter. Based on your description, <a href=\"https://stackoverflow.com/a/49320143/1126841\">Mikkel provides the right answer</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 9502299, "user_type": "registered", "profile_image": "https://graph.facebook.com/430085373846125/picture?type=large", "display_name": "Randall Lionel Kharkrang", "link": "https://stackoverflow.com/users/9502299/randall-lionel-kharkrang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1521284155, "creation_date": 1521194396, "last_edit_date": 1521284155, "question_id": 49317844, "link": "https://stackoverflow.com/questions/49317844/replicating-through-a-list-in-haskell", "title": "Replicating through a list in Haskell", "body": "<pre><code>replicatee :: [a] -&gt; Int -&gt; [a]\nreplicatee [] _ = []\nreplicatee xs 0 = []\nreplicatee (x:xs) n = x:replicatee (x:xs) (n-1): replicatee xs n\n</code></pre>\n\n<p>So this is my code for replicating a an element in a list n times, the compler keeps showing an error :</p>\n\n<pre><code>Couldnt match type 'a'with [a], I'm seriously confused, please help out.\n</code></pre>\n\n<p>Edit : what i want my function to do is this:\nreplicatee [1,2,3,4]  2</p>\n\n<p>[1,1,2,2,3,3,4,4]</p>\n"}, {"tags": ["haskell", "attoparsec"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1521198035, "post_id": 49317826, "comment_id": 85639179, "body": "Can parameter types include a <code>:</code>? Can parameter names start with a <code>:</code>? If no to both, write your parameter parser in a way that expresses those facts and <code>sepBy</code> should Just Work. (This is how I would do it in Parsec, too.)"}, {"owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1521199122, "post_id": 49317826, "comment_id": 85639910, "body": "Thanks that seemed to have solved it. I had to replace <code>t &lt;- takeWhile1 (const True)</code> with <code>t &lt;- takeWhile1 (notInClass &quot;:&quot;)</code>. I&#39;m not too sure why I expected that to produce an error. I don&#39;t actually know why it works but it does!"}], "answers": [{"tags": [], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "is_accepted": true, "score": 0, "last_activity_date": 1521378040, "creation_date": 1521378040, "answer_id": 49348160, "question_id": 49317826, "link": "https://stackoverflow.com/questions/49317826/how-can-i-use-sepby-with-an-ending-character-in-attoparsec/49348160#49348160", "title": "How can I use sepBy with an ending character in attoparsec?", "body": "<p>I think I have a better understanding as to how <code>sepBy</code> operates. Essentially you don't have to take the 'remaining' text into consideration, as with attoparsec you don't have to consume all the output until the end (unlike Parsec).</p>\n\n<p>For example given <code>1+2+3=6</code> as input and the following: </p>\n\n<pre><code>parseExample :: Parser ([Text], Text)\nparseExample = do\n  numbers &lt;- takeWhile1 (notInClass \"=+\") `sepBy` char '+'\n  skip (== '=')\n  total &lt;- takeWhile1 (const True)\n  return $ (numbers, total)\n</code></pre>\n\n<p>Will return: <code>( [ \"1\" , \"2\" , \"3\" ] , \"6\")</code> </p>\n\n<p>After the <code>skip (== '=')</code> you are free to parse the remaining input in whichever way you choose.</p>\n"}], "owner": {"reputation": 19307, "user_id": 1663462, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c30e0fa0f3a065c038c633a95066d299?s=128&d=identicon&r=PG", "display_name": "Chris Stryczynski", "link": "https://stackoverflow.com/users/1663462/chris-stryczynski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 49348160, "answer_count": 1, "score": 0, "last_activity_date": 1521378040, "creation_date": 1521194340, "last_edit_date": 1521197881, "question_id": 49317826, "link": "https://stackoverflow.com/questions/49317826/how-can-i-use-sepby-with-an-ending-character-in-attoparsec", "title": "How can I use sepBy with an ending character in attoparsec?", "body": "<p>I'm trying to parse the following line:</p>\n\n<pre><code>ItemCount count@Int: You have purchased #{showInt count} #{plural count \"item\" \"items\"}\n</code></pre>\n\n<p>Essentially I'm trying to get:</p>\n\n<pre><code>  Message {\n      key = \"ItemCount\",\n      value = \"You have purchased #{showInt count} #{plural count \\\"item\\\" \\\"items\\\"}.\",\n      parameters = [Parameter {name = \"count\", paramType = \"Int\"}]\n      }\n</code></pre>\n\n<p>The first bit <code>ItemCount count@Int:</code> could be:</p>\n\n<p><code>ItemCount:</code></p>\n\n<p>or</p>\n\n<p><code>ItemCount count@Int count2@Int:</code></p>\n\n<p>So the <em>parameter</em>s could be zero or more occurrances. I'm not sure how to detect the <code>:</code> when using <code>sepBy</code>. If I were using Parsec I would look to use <code>sepEndBy</code> <a href=\"https://hackage.haskell.org/package/parsec-3.1.13.0/docs/Text-ParserCombinators-Parsec-Combinator.html#v:sepEndBy\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/parsec-3.1.13.0/docs/Text-ParserCombinators-Parsec-Combinator.html#v:sepEndBy</a>.</p>\n\n<p>I'm sort of looking for <code>sepBy</code> untill it sees a char of <code>:</code>. I suppose I could first consume everything untill <code>:</code> and then run an 'inner' <code>parse</code> onn that consumed string, however it seems tedious to handle all the failure cases (Partial etc), and I'm thinking there must be a better way.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>import Control.Applicative\nimport Data.Attoparsec.Text\nimport Data.Text (Text)\n\ndata Parameter = Parameter { name :: Text, paramType :: Text } deriving (Eq, Show)\ndata Message = Message { key :: Text, value :: Text, parameters :: [Parameter] } deriving (Eq, Show)\ndata KeyAndParameters = KeyAndParameters Text [Parameter]\n\nparseParameter :: Parser Parameter\nparseParameter = do\n  n &lt;- takeWhile1 (notInClass \"@\")\n  _ &lt;- char '@'\n  t &lt;- takeWhile1 (const True)\n  return $ Parameter { name = n, paramType = t }\n\nparseKeyAndParameters :: Parser KeyAndParameters\nparseKeyAndParameters = do\n  keyV &lt;- takeWhile1 (notInClass \" :\")\n  params &lt;- parseParameter `sepBy` (char ' ')\n  return $ KeyAndParameters keyV params\n</code></pre>\n"}, {"tags": ["haskell", "discrete-mathematics", "number-theory"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1521173260, "post_id": 49312746, "comment_id": 85627684, "body": "Which version of GHC you are using? I&#39;m asking because I get slightly different errors from yours. The <code>let</code>s in the GHCi input that were in the original version of the question (and that I have edited away...) might suggest you aren&#39;t using GHC 8."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5775230"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1521181262, "post_id": 49312746, "comment_id": 85630084, "body": "7.10.3, I will upgrade"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1521181502, "post_id": 49312746, "comment_id": 85630191, "body": "While it is a good idea to upgrade if you can, note you&#39;ll still have the same problem, as explained by Fried Brice, only with a different error message. (I only asked about the GHC version to make sure I wouldn&#39;t be missing any details that might be relevant when writing an answer.)"}, {"owner": {"reputation": 891, "user_id": 99978, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/784837d98d18ff99681f612a62dddbcc?s=128&d=identicon&r=PG", "display_name": "j.p.", "link": "https://stackoverflow.com/users/99978/j-p"}, "edited": false, "score": 1, "creation_date": 1521186603, "post_id": 49312746, "comment_id": 85632415, "body": "For efficiency you might better avoid switching between integers and floating point by replacing the condition $n&lt;=sqrt(x)$ by $n^2&lt;=x$ in oneToRndRoot. There is a function called takeWhile that can help you to select the integers from [1..] fulfilling this condition."}], "answers": [{"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 6, "creation_date": 1521180972, "post_id": 49314146, "comment_id": 85629967, "body": "Your diagnostic is spot on, but there is a better solution: <code>rndRoot = round . sqrt . fromIntegral</code>. With that, the OP won&#39;t need to change the types of the other functions, nor to switch from integer arithmetic to floating point arithimetic (with all the convenience and correctness issues that might bring -- in particular, a Haskell-specific complication is that <a href=\"https://stackoverflow.com/q/7290438/2751851\">floating-point ranges are generally a bad idea</a>)."}, {"owner": {"reputation": 831, "user_id": 3371760, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/09370cd5d499c9f0f75b54aa1b4daa17?s=128&d=identicon&r=PG", "display_name": "Fried Brice", "link": "https://stackoverflow.com/users/3371760/fried-brice"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1521182747, "post_id": 49314146, "comment_id": 85630693, "body": "@duplode nice catch! Edited."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5775230"}, "edited": false, "score": 1, "creation_date": 1521237541, "post_id": 49314146, "comment_id": 85662230, "body": "I had just let it infer the types orignally and then added it to my code, so I will be sure specify this from now on. For anyone else, the type signature for oneToRndRoot should also reflect this change     <code>oneToRndRoot :: (Integral a) =&gt; a -&gt; [a]</code>         <code>oneToRndRoot x = [1..rndRoot(x)]</code>"}, {"owner": {"reputation": 831, "user_id": 3371760, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/09370cd5d499c9f0f75b54aa1b4daa17?s=128&d=identicon&r=PG", "display_name": "Fried Brice", "link": "https://stackoverflow.com/users/3371760/fried-brice"}, "edited": false, "score": 0, "creation_date": 1521238519, "post_id": 49314146, "comment_id": 85662565, "body": "@WarrickMacmillan thanks for that. I&#39;ll edit my answer."}], "tags": [], "owner": {"reputation": 831, "user_id": 3371760, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/09370cd5d499c9f0f75b54aa1b4daa17?s=128&d=identicon&r=PG", "display_name": "Fried Brice", "link": "https://stackoverflow.com/users/3371760/fried-brice"}, "is_accepted": false, "score": 4, "last_activity_date": 1521239149, "last_edit_date": 1521239149, "creation_date": 1521180132, "answer_id": 49314146, "question_id": 49312746, "link": "https://stackoverflow.com/questions/49312746/how-to-properly-define-an-haskell-function-isprime/49314146#49314146", "title": "How to properly define an Haskell function isPrime?", "body": "<p>Inspecting the type of <code>mapModToRndRoot</code> give the following:</p>\n\n<pre><code>mapModToRndRoot :: (Floating a, Integral a, RealFrac a) =&gt; a -&gt; [a]\n</code></pre>\n\n<p>So, to call <code>mapModToRndRoot 39</code>, we'd need to assign a numeric type to the literal <code>39</code> that is an instance of <code>RealFrac</code>, <code>Integral</code>, and <code>Floating</code>. However, none of the Prelude numeric types satisfy all three of those constraints, so we get a compile error.</p>\n\n<p>On the other hand, <code>mapMod 49 (oneToRndRoot 49)</code> works just fine. Notice the type of the below lambda:</p>\n\n<pre><code>\\x y -&gt; mapMod x (oneToRndRoot y)\n  :: (RealFrac a, Integral b, Floating a) =&gt; b -&gt; a -&gt; [b]\n</code></pre>\n\n<p>By using two literals, GHC is able to assign different types to each of them in order to satisfy the type class constrains.</p>\n\n<p><em>Edit:</em> Here is a solution suggested by @duplode:</p>\n\n<pre><code>rndRoot :: (Integral a) =&gt; a -&gt; a\nrndRoot = round . sqrt . fromIntegral\n</code></pre>\n\n<p>My original suggestion <code>fromIntegral . round . sqrt</code> is susceptible to all the usual wonkiness that comes with using floating point arithmetic.</p>\n\n<p><em>Edit:</em> As @WarrickMacmillan points out, the signature of <code>oneToRndRoot</code> must also be changed. Below is the entire working program fully annotated.</p>\n\n<pre><code>rndRoot :: Integral a =&gt; a -&gt; a\nrndRoot = round . sqrt . fromIntegral\n\noneToRndRoot :: Integral a =&gt; a -&gt; [a]\noneToRndRoot x = [1..rndRoot(x)]\n\nmodulo :: (Ord p, Num p) =&gt; p -&gt; p -&gt; p\nmodulo x y\n  | n &lt; 0 = x\n  | otherwise = modulo n y\n  where n = x - y\n\nmapMod :: (Num b, Ord b) =&gt; b -&gt; [b] -&gt; [b]\nmapMod x = map (modulo x)\n\nmapModToRndRoot :: Integral a =&gt; a -&gt; [a]\nmapModToRndRoot n = mapMod n (oneToRndRoot n)\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5775230"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1521239149, "creation_date": 1521171208, "last_edit_date": 1521190415, "question_id": 49312746, "link": "https://stackoverflow.com/questions/49312746/how-to-properly-define-an-haskell-function-isprime", "title": "How to properly define an Haskell function isPrime?", "body": "<p>I'm trying to create a basic function to test primality of an integer in Haskell.  I have code which will work in an ad hoc sense, but continue to get an error message when I try to pass it to a function. Note that I'm writing the definitions directly in GHCi, using <code>:{</code> and <code>:}</code>.</p>\n\n<p>The idea is to create a list of N modulo {all integers up to a rounded sqrt (N)}, and then test the resulting list for a zero other than the initial index.  The following four functions all work:</p>\n\n<pre><code>rndRoot :: (Floating a, Integral c, RealFrac a) =&gt; a -&gt; c\nrndRoot = round . sqrt\n\noneToRndRoot :: (Floating a, Integral t, RealFrac a) =&gt; a -&gt; [t]\noneToRndRoot x = [1..rndRoot(x)]\n\nmodulo x y\n  | n &lt; 0 = x\n  | otherwise = modulo n y\n  where n = x - y\n\nmapMod x = map (modulo x)\n</code></pre>\n\n<p>This also works:</p>\n\n<pre><code>mapMod 49 (oneToRndRoot 49)\n</code></pre>\n\n<p>However, while the repl accepts this definition without complaint...</p>\n\n<pre><code>mapModToRndRoot x = mapMod x $ oneToRndRoot x\n</code></pre>\n\n<p>...  it spits out the following error message when I try to use it:</p>\n\n<pre><code>Prelude&gt; mapModToRndRoot 39\n\n&lt;interactive&gt;:475:1:\n    No instance for (Floating a0) arising from a use of \u2018it\u2019\n    The type variable \u2018a0\u2019 is ambiguous\n    Note: there are several potential instances:\n      instance Floating Double -- Defined in \u2018GHC.Float\u2019\n      instance Floating Float -- Defined in \u2018GHC.Float\u2019\n    In the first argument of \u2018print\u2019, namely \u2018it\u2019\n    In a stmt of an interactive GHCi command: print it\n</code></pre>\n\n<p>The ad hoc solution which seems to work fine is just to use two arguments rather than repeat the same one</p>\n\n<pre><code>mapModToRndRoot2 x y = map (modulo x) (oneToRndRoot y)\n</code></pre>\n\n\n\n<pre><code>Prelude&gt; mapModToRndRoot2 33 33\n[0,1,0,1,3,3]\n</code></pre>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1521230149, "post_id": 49312731, "comment_id": 85659023, "body": "Also see <a href=\"https://stackoverflow.com/questions/28191103/iterate-over-all-pair-combinations-without-repetition-in-haskell\" title=\"iterate over all pair combinations without repetition in haskell\">stackoverflow.com/questions/28191103/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 7746145, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/36849e1fe2fad11b5d1072fc04297ed9?s=128&d=identicon&r=PG&f=1", "display_name": "megabowser56", "link": "https://stackoverflow.com/users/7746145/megabowser56"}, "edited": false, "score": 0, "creation_date": 1521173090, "post_id": 49312885, "comment_id": 85627656, "body": "awesome possum! And the reason for not using list comprehension is because I am challenging myself to learn algorithms and what goes through them internally. What if one day list comprehension breaks and we need to use normal algorithms haha i dont know im tired"}], "tags": [], "owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "is_accepted": true, "score": 0, "last_activity_date": 1521172115, "creation_date": 1521172115, "answer_id": 49312885, "question_id": 49312731, "link": "https://stackoverflow.com/questions/49312731/getting-combination-pairs-of-list-elements/49312885#49312885", "title": "Getting combination pairs of list elements", "body": "<p>I don't know why you're opposed to list comprehensions; with them, the solution is trivial:</p>\n\n<pre><code>pairwise :: [a] -&gt; [(a, a)]\npairwise [] = []\npairwise (x:xs) = [(x, y) | y &lt;- xs] ++ pairwise xs\n</code></pre>\n\n<p>You can factor out the comprehension into a separate function with explicit tail recursion if you want.</p>\n\n<p>(The whole thing can be made tail-recursive, too, by keeping parameters for both sides of the <code>++</code> and having an accumulator parameter.)</p>\n"}, {"tags": [], "owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "is_accepted": false, "score": 2, "last_activity_date": 1521172520, "creation_date": 1521172520, "answer_id": 49312952, "question_id": 49312731, "link": "https://stackoverflow.com/questions/49312731/getting-combination-pairs-of-list-elements/49312952#49312952", "title": "Getting combination pairs of list elements", "body": "<p>The list comprehension mentioned in 9000's answer can be trivially factored into a <code>map</code> call.</p>\n\n<pre><code>pairwise :: [a] -&gt; [(a, a)]\npairwise [] = []\npairwise (x:xs) = map (\\y -&gt; (x, y)) xs ++ pairwise xs\n</code></pre>\n\n<p>Every list comprehension can be factored into some combination of <code>map</code>, <code>filter</code>, and <code>concatMap</code>, possibly with some <code>let</code> bindings interspersed. Doing so is a good exercise for learning how to manipulate functions.</p>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 1, "last_activity_date": 1521180085, "last_edit_date": 1521180085, "creation_date": 1521176414, "answer_id": 49313507, "question_id": 49312731, "link": "https://stackoverflow.com/questions/49312731/getting-combination-pairs-of-list-elements/49313507#49313507", "title": "Getting combination pairs of list elements", "body": "<p>Here is one implementation using <code>tails</code> from <code>Data.List</code>:</p>\n\n<pre><code>import Data.List\n\npairings :: [a] -&gt; [(a, a)]\npairings = concatMap makePairs . tails\n    where\n    makePairs [] = []\n    makePairs (x:xs) = fmap ((,) x) xs\n</code></pre>\n\n<p>Notes:</p>\n\n<ul>\n<li><p>I don't know whether <code>tails</code> counts as a \"special import\" for you -- though it is not in the Prelude, it can be found in the <em>base</em> library, which is always available.</p></li>\n<li><p>To see what <code>tails</code> does, try <code>tails [1..3]</code>.</p></li>\n<li><p><code>((,) x)</code> is just a compact way of writing <code>(\\y -&gt; (x, y))</code>. If you find it ugly, you can write the longer version instead, or enable the <code>TupleSections</code> extension and spell it as <code>(x,)</code>.</p></li>\n<li><p><code>makePairs</code> might be written without explicit recursion as...</p>\n\n<pre><code>makePairs = maybe [] (\\(x, xs) -&gt; fmap ((,) x) xs) . uncons\n</code></pre>\n\n<p>... with <code>uncons</code> also being found in <code>Data.List</code>.</p></li>\n<li><p>All the implementations in the answers here have a not insignificant problem: they retain consumed list segments in memory. To see what I'm talking about, watch the memory usage as you run <code>head . drop 8000000 $ pairings [1..]</code> in GHCi. I'm not confident about there being a workaround for that -- a simple <code>concat . tails</code>, for instance, appears to run into the same issue, while <code>fmap makePairs . tails</code> doesn't (even <code>head . drop (10^9) . head . drop (10^9) . fmap makePairs . tails $ [1..]</code> won't eat up all your memory).</p></li>\n</ul>\n"}], "owner": {"reputation": 43, "user_id": 7746145, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/36849e1fe2fad11b5d1072fc04297ed9?s=128&d=identicon&r=PG&f=1", "display_name": "megabowser56", "link": "https://stackoverflow.com/users/7746145/megabowser56"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 49312885, "answer_count": 3, "score": 1, "last_activity_date": 1560644402, "creation_date": 1521171081, "last_edit_date": 1560644402, "question_id": 49312731, "link": "https://stackoverflow.com/questions/49312731/getting-combination-pairs-of-list-elements", "title": "Getting combination pairs of list elements", "body": "<p>I am trying to get all combinations of a list. The result for <code>[1,2,3]</code> should be <code>[(1,2),(1,3),(2,3)]</code>. My implementation below, however, gives <code>[(1,2),(2,3)]</code>.</p>\n\n<pre><code>parings [d] = []\nparings (y:ys) = (y, head ys): parings ys\n</code></pre>\n"}, {"tags": ["xml", "haskell", "rdf"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1521153316, "post_id": 49310194, "comment_id": 85622641, "body": "I&#39;m way too tired for this, but why didn&#39;t anything &quot;get [..] to work&quot;? Did you get a type error?"}, {"owner": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1521153805, "post_id": 49310194, "comment_id": 85622821, "body": "It&#39;s useless to debug what I&#39;ve tried writing, since I have no idea what I&#39;m doing. Really I&#39;m just looking for ideas about how to query RDF data in Haskell. Updated my question to make that more explicit."}], "answers": [{"comments": [{"owner": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "edited": false, "score": 0, "creation_date": 1521770366, "post_id": 49312198, "comment_id": 85884437, "body": "So I tried <code>parsed &lt;- parseURL (XmlParser Nothing Nothing) testText</code>, but it says <code>Ambiguous type variable \u2018a0\u2019 arising from a use of \u2018parseURL\u2019 prevents the constraint \u2018(Rdf a0)\u2019 from being solved. Probable fix: use a type annotation to specify what \u2018a0\u2019 should be.</code> So I tried <code>parsed::TList &lt;- ...</code> and more exotic things like <code>Right (parsed::(RDF TList)) &lt;- ... </code> but so far, nothing&#39;s working."}, {"owner": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "edited": false, "score": 0, "creation_date": 1521770419, "post_id": 49312198, "comment_id": 85884449, "body": "I&#39;m basically just hoping to find a working example of how to do this. There doesn&#39;t seem to be one in the documentation anywhere."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "edited": false, "score": 0, "creation_date": 1521812162, "post_id": 49312198, "comment_id": 85904052, "body": "@Jono I have added an extra section to the answer."}, {"owner": {"reputation": 1722, "user_id": 1526266, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/1HT7M.jpg?s=128&g=1", "display_name": "Rob Stewart", "link": "https://stackoverflow.com/users/1526266/rob-stewart"}, "edited": false, "score": 0, "creation_date": 1526892009, "post_id": 49312198, "comment_id": 87903528, "body": "Thanks both for the feedback on the haddock documentation for XmlParser. I have incorporated your suggestions: <a href=\"https://hackage.haskell.org/package/rdf4h-3.0.4/docs/Text-RDF-RDF4H-XmlParser.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/rdf4h-3.0.4/docs/&hellip;</a>"}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 4, "last_activity_date": 1521812148, "last_edit_date": 1521812148, "creation_date": 1521166576, "answer_id": 49312198, "question_id": 49310194, "link": "https://stackoverflow.com/questions/49310194/how-can-i-query-rdf-data-using-haskell/49312198#49312198", "title": "How can I query RDF data using Haskell?", "body": "<blockquote>\n  <p>I notice that there's <a href=\"https://hackage.haskell.org/package/rdf4h-3.0.1\" rel=\"nofollow noreferrer\">an RDF library in Haskell, rdh4h</a> and that it has an XML parser. But I can't make heads or tails of the documentation, and there doesn't seem to be a tutorial around anywhere.</p>\n</blockquote>\n\n<p>Here is my attempt to make heads or tails of the documentation. (Take it with a grain of salt, as I know nothing about RDF and didn't actually try to use the library.)</p>\n\n<p>If we open <a href=\"https://hackage.haskell.org/package/rdf4h-3.0.1/docs/Data-RDF.html\" rel=\"nofollow noreferrer\">the docs for <code>Data.RDF</code></a>, the top level module, we find a trio of seemingly relevant functions: <code>parseString</code>, <code>parseFile</code> and <code>parseURL</code>. <a href=\"https://hackage.haskell.org/package/rdf4h-3.0.1/docs/Data-RDF.html#v:parseString\" rel=\"nofollow noreferrer\">The documentation for <code>parseString</code></a>, for instance, is:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>parseString :: Rdf a =&gt; p -&gt; Text -&gt; Either ParseFailure (RDF a)\n</code></pre>\n\n<blockquote>\n  <p>Parse RDF from the given text, yielding a failure with error message or the resultant RDF.</p>\n</blockquote>\n\n<p>To call it, then, we need to supply a <code>p</code> and a <code>Text</code> (the string to be parsed). But what is <code>p</code>? If we scroll upwards a bit, we'll note <code>parseString</code> is a method of the <code>RdfParser</code> class. The instances list -- which helps a lot to make sense of type classes -- shows that <code>XmlParser</code> is an instance of <code>RdfParser</code>. That looks useful!</p>\n\n<p>If we now follow the link to <a href=\"https://hackage.haskell.org/package/rdf4h-3.0.1/docs/Text-RDF-RDF4H-XmlParser.html#t:XmlParser\" rel=\"nofollow noreferrer\">the <code>XmlParser</code> documentation entry</a>, we learn it has an exposed (or \"public\", if you will) constructor:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>XmlParser (Maybe BaseUrl) (Maybe Text)\n</code></pre>\n\n<p>We can further follow the links to learn that <code>BaseUrl</code> is just a newtype around <code>Text</code>. There seems to be no useful documentation about what the arguments to the constructor are supposed to be, though. Little else remains but to appeal to <a href=\"https://hackage.haskell.org/package/rdf4h-3.0.1/docs/src/Text-RDF-RDF4H-XmlParser.html\" rel=\"nofollow noreferrer\">the source code of the module</a>, also reachable through links. Surprisingly enough, that reveals useful documentation, associated to the functions there. This is the relevant instance of <code>RdfParser</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- |'XmlParser' is an instance of 'RdfParser'.\ninstance RdfParser XmlParser where\n  parseString (XmlParser bUrl dUrl)  = parseXmlRDF bUrl dUrl\n  parseFile   (XmlParser bUrl dUrl)  = parseFile' bUrl dUrl\n  parseURL    (XmlParser bUrl dUrl)  = parseURL'  bUrl dUrl\n</code></pre>\n\n<p>The Haddock comment here is redundant; however, there is useful information in the Haddock comments to <code>parseURL'</code>...</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- |Parse the document at the given location URL as an XML document, using an optional @BaseUrl@\n-- as the base URI, and using the given document URL as the URI of the XML document itself.\n--\n-- The @BaseUrl@ is used as the base URI within the document for resolving any relative URI references.\n-- It may be changed within the document using the @\\@base@ directive. At any given point, the current\n-- base URI is the most recent @\\@base@ directive, or if none, the @BaseUrl@ given to @parseURL@, or\n-- if none given, the document URL given to @parseURL@. For example, if the @BaseUrl@ were\n-- @http:\\/\\/example.org\\/@ and a relative URI of @\\&lt;b&gt;@ were encountered (with no preceding @\\@base@\n-- directive), then the relative URI would expand to @http:\\/\\/example.org\\/b@.\n--\n-- The document URL is for the purpose of resolving references to 'this document' within the document,\n-- and may be different than the actual location URL from which the document is retrieved. Any reference\n-- to @\\&lt;&gt;@ within the document is expanded to the value given here. Additionally, if no @BaseUrl@ is\n-- given and no @\\@base@ directive has appeared before a relative URI occurs, this value is used as the\n-- base URI against which the relative URI is resolved.\n--p\n-- Returns either a @ParseFailure@ or a new RDF containing the parsed triples.\nparseURL' :: (Rdf a) =&gt;\n                 Maybe BaseUrl       -- ^ The optional base URI of the document.\n                 -&gt; Maybe T.Text -- ^ The document URI (i.e., the URI of the document itself); if Nothing, use location URI.\n                 -&gt; String           -- ^ The location URI from which to retrieve the XML document.\n                 -&gt; IO (Either ParseFailure (RDF a))\n                                     -- ^ The parse result, which is either a @ParseFailure@ or the RDF\n                                     --   corresponding to the XML document.\nparseURL' bUrl docUrl = _parseURL (parseXmlRDF bUrl docUrl)\n</code></pre>\n\n<p>... and <code>parseXmlRDF</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- |Parse a xml T.Text to an RDF representation\nparseXmlRDF :: (Rdf a)\n            =&gt; Maybe BaseUrl           -- ^ The base URL for the RDF if required\n            -&gt; Maybe T.Text        -- ^ DocUrl: The request URL for the RDF if available\n            -&gt; T.Text              -- ^ The contents to parse\n            -&gt; Either ParseFailure (RDF a) -- ^ The RDF representation of the triples or ParseFailure\nparseXmlRDF bUrl dUrl xmlStr = case runParseArrow of\n                                (_,r:_) -&gt; Right r\n                                _ -&gt; Left (ParseFailure \"XML parsing failed\")\n  where runParseArrow = runSLA (xreadDoc &gt;&gt;&gt; isElem &gt;&gt;&gt; addMetaData bUrl dUrl &gt;&gt;&gt; getRDF) initState (T.unpack xmlStr)\n        initState = GParseState { stateGenId = 0 }\n</code></pre>\n\n<p>These Haddock comments don't show up in the actual documentation because the functions they belong to aren't exported.</p>\n\n<p>All in all, I'd say the documentation of this library could be improved. In such cases, though, knowing your way around Hackage docs can soften the blow.</p>\n\n<hr>\n\n<blockquote>\n  <p>So I tried <code>parsed &lt;- parseURL (XmlParser Nothing Nothing) testText</code>, but it says <code>Ambiguous type variable \u2018a0\u2019 arising from a use of \u2018parseURL\u2019 prevents the constraint \u2018(Rdf a0)\u2019 from being solved. Probable fix: use a type annotation to specify what \u2018a0\u2019 should be</code>.</p>\n</blockquote>\n\n<p>The error is telling you that you have to specify what <code>a</code> is in...</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>parseURL :: Rdf a =&gt; p -&gt; String -&gt; IO (Either ParseFailure (RDF a))\n</code></pre>\n\n<p>... either by using it somewhere that demands a concrete type or by adding a type annotation.</p>\n\n<p>Further following links in the documentation shows that <a href=\"https://hackage.haskell.org/package/rdf4h-3.0.1/docs/Data-RDF.html#t:Rdf\" rel=\"nofollow noreferrer\"><code>Rdf</code> is a class with two instances</a> (<code>TList</code> and <code>AdjHashMap</code>) and that <a href=\"https://hackage.haskell.org/package/rdf4h-3.0.1/docs/Data-RDF-Types.html#t:RDF\" rel=\"nofollow noreferrer\"><code>RDF</code> is a data family</a>. That being so, you want something like:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>parsed &lt;- parseURL (XmlParser Nothing Nothing) testText :: IO (Either ParseFailure (RDF TList))\n</code></pre>\n\n<p>(Note how the type annotation matches the result type specified by the signature of <code>parseURL</code>.)</p>\n\n<p>Alternatively, enabling <code>ScopedTypeVariables</code> makes it possible to write:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>parsed :: Either ParseFailure (RDF TList) &lt;- parseURL (XmlParser Nothing Nothing) testText\n</code></pre>\n"}], "owner": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 49312198, "answer_count": 1, "score": 2, "last_activity_date": 1521812148, "creation_date": 1521152587, "last_edit_date": 1521153727, "question_id": 49310194, "link": "https://stackoverflow.com/questions/49310194/how-can-i-query-rdf-data-using-haskell", "title": "How can I query RDF data using Haskell?", "body": "<p>I'm a Haskell beginner. I have RDF XML from Project Gutenberg that looks like this: </p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;rdf:RDF xml:base=\"http://www.gutenberg.org/\"\n  xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\"\n  xmlns:dcterms=\"http://purl.org/dc/terms/\"\n  xmlns:cc=\"http://web.resource.org/cc/\"\n  xmlns:dcam=\"http://purl.org/dc/dcam/\"\n  xmlns:rdfs=\"http://www.w3.org/2000/01/rdf-schema#\"\n  xmlns:pgterms=\"http://www.gutenberg.org/2009/pgterms/\"\n&gt;\n  &lt;cc:Work rdf:about=\"\"&gt;\n    &lt;rdfs:comment&gt;Archives containing the RDF files for *all* our books can be downloaded at\n            http://www.gutenberg.org/wiki/Gutenberg:Feeds#The_Complete_Project_Gutenberg_Catalog&lt;/rdfs:comment&gt;\n    &lt;cc:license rdf:resource=\"https://creativecommons.org/publicdomain/zero/1.0/\"/&gt;\n  &lt;/cc:Work&gt;\n  &lt;pgterms:ebook rdf:about=\"ebooks/20\"&gt;\n    &lt;pgterms:bookshelf&gt;\n      &lt;rdf:Description rdf:nodeID=\"N3f8445072d8e4499b2646626f94866e0\"&gt;\n        &lt;rdf:value&gt;Poetry&lt;/rdf:value&gt;\n        &lt;dcam:memberOf rdf:resource=\"2009/pgterms/Bookshelf\"/&gt;\n      &lt;/rdf:Description&gt;\n    &lt;/pgterms:bookshelf&gt;\n    &lt;dcterms:hasFormat&gt;\n      &lt;pgterms:file rdf:about=\"http://www.gutenberg.org/ebooks/20.rdf\"&gt;\n        &lt;dcterms:modified rdf:datatype=\"http://www.w3.org/2001/XMLSchema#dateTime\"&gt;2017-03-16T05:01:13.615047&lt;/dcterms:modified&gt;\n        &lt;dcterms:extent rdf:datatype=\"http://www.w3.org/2001/XMLSchema#integer\"&gt;12133&lt;/dcterms:extent&gt;\n        &lt;dcterms:isFormatOf rdf:resource=\"ebooks/20\"/&gt;\n        &lt;dcterms:format&gt;\n          &lt;rdf:Description rdf:nodeID=\"N735ba077c8424051b6470a92682aaa5e\"&gt;\n            &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/IMT\"/&gt;\n            &lt;rdf:value rdf:datatype=\"http://purl.org/dc/terms/IMT\"&gt;application/rdf+xml&lt;/rdf:value&gt;\n          &lt;/rdf:Description&gt;\n        &lt;/dcterms:format&gt;\n      &lt;/pgterms:file&gt;\n    &lt;/dcterms:hasFormat&gt;\n    &lt;dcterms:issued rdf:datatype=\"http://www.w3.org/2001/XMLSchema#date\"&gt;1991-10-01&lt;/dcterms:issued&gt;\n    &lt;dcterms:title&gt;Paradise Lost&lt;/dcterms:title&gt;\n    &lt;dcterms:subject&gt;\n      &lt;rdf:Description rdf:nodeID=\"Ne259525c666c4886a996acbdddca0682\"&gt;\n        &lt;rdf:value&gt;PR&lt;/rdf:value&gt;\n        &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/LCC\"/&gt;\n      &lt;/rdf:Description&gt;\n    &lt;/dcterms:subject&gt;\n    &lt;dcterms:hasFormat&gt;\n      &lt;pgterms:file rdf:about=\"http://www.gutenberg.org/files/20/20.txt\"&gt;\n        &lt;dcterms:extent rdf:datatype=\"http://www.w3.org/2001/XMLSchema#integer\"&gt;507133&lt;/dcterms:extent&gt;\n        &lt;dcterms:isFormatOf rdf:resource=\"ebooks/20\"/&gt;\n        &lt;dcterms:modified rdf:datatype=\"http://www.w3.org/2001/XMLSchema#dateTime\"&gt;2011-03-02T06:33:54&lt;/dcterms:modified&gt;\n        &lt;dcterms:format&gt;\n          &lt;rdf:Description rdf:nodeID=\"Nbd1740a2927845058b0fe43326dcc48b\"&gt;\n            &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/IMT\"/&gt;\n            &lt;rdf:value rdf:datatype=\"http://purl.org/dc/terms/IMT\"&gt;text/plain; charset=us-ascii&lt;/rdf:value&gt;\n          &lt;/rdf:Description&gt;\n        &lt;/dcterms:format&gt;\n      &lt;/pgterms:file&gt;\n    &lt;/dcterms:hasFormat&gt;\n    &lt;dcterms:hasFormat&gt;\n      &lt;pgterms:file rdf:about=\"http://www.gutenberg.org/ebooks/20.epub.images\"&gt;\n        &lt;dcterms:isFormatOf rdf:resource=\"ebooks/20\"/&gt;\n        &lt;dcterms:format&gt;\n          &lt;rdf:Description rdf:nodeID=\"Nb08f3d2980e64e91a402eb5b205c10bc\"&gt;\n            &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/IMT\"/&gt;\n            &lt;rdf:value rdf:datatype=\"http://purl.org/dc/terms/IMT\"&gt;application/epub+zip&lt;/rdf:value&gt;\n          &lt;/rdf:Description&gt;\n        &lt;/dcterms:format&gt;\n        &lt;dcterms:extent rdf:datatype=\"http://www.w3.org/2001/XMLSchema#integer\"&gt;232622&lt;/dcterms:extent&gt;\n        &lt;dcterms:modified rdf:datatype=\"http://www.w3.org/2001/XMLSchema#dateTime\"&gt;2017-03-01T01:04:17.425321&lt;/dcterms:modified&gt;\n      &lt;/pgterms:file&gt;\n    &lt;/dcterms:hasFormat&gt;\n    &lt;dcterms:hasFormat&gt;\n      &lt;pgterms:file rdf:about=\"http://www.gutenberg.org/ebooks/20.kindle.images\"&gt;\n        &lt;dcterms:isFormatOf rdf:resource=\"ebooks/20\"/&gt;\n        &lt;dcterms:extent rdf:datatype=\"http://www.w3.org/2001/XMLSchema#integer\"&gt;933970&lt;/dcterms:extent&gt;\n        &lt;dcterms:format&gt;\n          &lt;rdf:Description rdf:nodeID=\"Nff1df57b9552466d96b114f20424b5a2\"&gt;\n            &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/IMT\"/&gt;\n            &lt;rdf:value rdf:datatype=\"http://purl.org/dc/terms/IMT\"&gt;application/x-mobipocket-ebook&lt;/rdf:value&gt;\n          &lt;/rdf:Description&gt;\n        &lt;/dcterms:format&gt;\n        &lt;dcterms:modified rdf:datatype=\"http://www.w3.org/2001/XMLSchema#dateTime\"&gt;2017-03-01T01:04:21.321235&lt;/dcterms:modified&gt;\n      &lt;/pgterms:file&gt;\n    &lt;/dcterms:hasFormat&gt;\n    &lt;dcterms:language&gt;\n      &lt;rdf:Description rdf:nodeID=\"N91273d0bffc74be393cda307d2b05137\"&gt;\n        &lt;rdf:value rdf:datatype=\"http://purl.org/dc/terms/RFC4646\"&gt;en&lt;/rdf:value&gt;\n      &lt;/rdf:Description&gt;\n    &lt;/dcterms:language&gt;\n    &lt;dcterms:subject&gt;\n      &lt;rdf:Description rdf:nodeID=\"N5e35fb378b37483ca6ef7a08f27cf936\"&gt;\n        &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/LCSH\"/&gt;\n        &lt;rdf:value&gt;Eve (Biblical figure) -- Poetry&lt;/rdf:value&gt;\n      &lt;/rdf:Description&gt;\n    &lt;/dcterms:subject&gt;\n    &lt;dcterms:license rdf:resource=\"license\"/&gt;\n    &lt;dcterms:hasFormat&gt;\n      &lt;pgterms:file rdf:about=\"http://www.gutenberg.org/ebooks/20.html.images\"&gt;\n        &lt;dcterms:extent rdf:datatype=\"http://www.w3.org/2001/XMLSchema#integer\"&gt;614618&lt;/dcterms:extent&gt;\n        &lt;dcterms:modified rdf:datatype=\"http://www.w3.org/2001/XMLSchema#dateTime\"&gt;2017-03-01T01:04:16.685338&lt;/dcterms:modified&gt;\n        &lt;dcterms:isFormatOf rdf:resource=\"ebooks/20\"/&gt;\n        &lt;dcterms:format&gt;\n          &lt;rdf:Description rdf:nodeID=\"N7567260ec2fd48c0be3d2858e08ac35d\"&gt;\n            &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/IMT\"/&gt;\n            &lt;rdf:value rdf:datatype=\"http://purl.org/dc/terms/IMT\"&gt;text/html&lt;/rdf:value&gt;\n          &lt;/rdf:Description&gt;\n        &lt;/dcterms:format&gt;\n      &lt;/pgterms:file&gt;\n    &lt;/dcterms:hasFormat&gt;\n    &lt;dcterms:hasFormat&gt;\n      &lt;pgterms:file rdf:about=\"http://www.gutenberg.org/ebooks/20.epub.noimages\"&gt;\n        &lt;dcterms:isFormatOf rdf:resource=\"ebooks/20\"/&gt;\n        &lt;dcterms:modified rdf:datatype=\"http://www.w3.org/2001/XMLSchema#dateTime\"&gt;2017-03-01T01:04:17.695324&lt;/dcterms:modified&gt;\n        &lt;dcterms:extent rdf:datatype=\"http://www.w3.org/2001/XMLSchema#integer\"&gt;232623&lt;/dcterms:extent&gt;\n        &lt;dcterms:format&gt;\n          &lt;rdf:Description rdf:nodeID=\"Nb640302bc2a84a31b0e154318df817d1\"&gt;\n            &lt;rdf:value rdf:datatype=\"http://purl.org/dc/terms/IMT\"&gt;application/epub+zip&lt;/rdf:value&gt;\n            &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/IMT\"/&gt;\n          &lt;/rdf:Description&gt;\n        &lt;/dcterms:format&gt;\n      &lt;/pgterms:file&gt;\n    &lt;/dcterms:hasFormat&gt;\n    &lt;dcterms:hasFormat&gt;\n      &lt;pgterms:file rdf:about=\"http://www.gutenberg.org/ebooks/20.kindle.noimages\"&gt;\n        &lt;dcterms:isFormatOf rdf:resource=\"ebooks/20\"/&gt;\n        &lt;dcterms:extent rdf:datatype=\"http://www.w3.org/2001/XMLSchema#integer\"&gt;933967&lt;/dcterms:extent&gt;\n        &lt;dcterms:modified rdf:datatype=\"http://www.w3.org/2001/XMLSchema#dateTime\"&gt;2017-03-01T01:04:24.846165&lt;/dcterms:modified&gt;\n        &lt;dcterms:format&gt;\n          &lt;rdf:Description rdf:nodeID=\"N1857bba1f5484e3d84846e1a554ec593\"&gt;\n            &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/IMT\"/&gt;\n            &lt;rdf:value rdf:datatype=\"http://purl.org/dc/terms/IMT\"&gt;application/x-mobipocket-ebook&lt;/rdf:value&gt;\n          &lt;/rdf:Description&gt;\n        &lt;/dcterms:format&gt;\n      &lt;/pgterms:file&gt;\n    &lt;/dcterms:hasFormat&gt;\n    &lt;dcterms:publisher&gt;Project Gutenberg&lt;/dcterms:publisher&gt;\n    &lt;dcterms:rights&gt;Public domain in the USA.&lt;/dcterms:rights&gt;\n    &lt;dcterms:creator&gt;\n      &lt;pgterms:agent rdf:about=\"2009/agents/17\"&gt;\n        &lt;pgterms:deathdate rdf:datatype=\"http://www.w3.org/2001/XMLSchema#integer\"&gt;1674&lt;/pgterms:deathdate&gt;\n        &lt;pgterms:webpage rdf:resource=\"http://en.wikipedia.org/wiki/John_Milton\"/&gt;\n        &lt;pgterms:name&gt;Milton, John&lt;/pgterms:name&gt;\n        &lt;pgterms:birthdate rdf:datatype=\"http://www.w3.org/2001/XMLSchema#integer\"&gt;1608&lt;/pgterms:birthdate&gt;\n      &lt;/pgterms:agent&gt;\n    &lt;/dcterms:creator&gt;\n    &lt;dcterms:type&gt;\n      &lt;rdf:Description rdf:nodeID=\"N0f6e6d76b1ff4ea9a2c5c37949efe82b\"&gt;\n        &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/DCMIType\"/&gt;\n        &lt;rdf:value&gt;Text&lt;/rdf:value&gt;\n      &lt;/rdf:Description&gt;\n    &lt;/dcterms:type&gt;\n    &lt;dcterms:subject&gt;\n      &lt;rdf:Description rdf:nodeID=\"N202624c4b5994d39a3ab8bf0a2a31d95\"&gt;\n        &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/LCSH\"/&gt;\n        &lt;rdf:value&gt;Adam (Biblical figure) -- Poetry&lt;/rdf:value&gt;\n      &lt;/rdf:Description&gt;\n    &lt;/dcterms:subject&gt;\n    &lt;dcterms:hasFormat&gt;\n      &lt;pgterms:file rdf:about=\"http://www.gutenberg.org/ebooks/20.html.noimages\"&gt;\n        &lt;dcterms:extent rdf:datatype=\"http://www.w3.org/2001/XMLSchema#integer\"&gt;614618&lt;/dcterms:extent&gt;\n        &lt;dcterms:format&gt;\n          &lt;rdf:Description rdf:nodeID=\"N79f919d14da448e19eb05c444322ddd2\"&gt;\n            &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/IMT\"/&gt;\n            &lt;rdf:value rdf:datatype=\"http://purl.org/dc/terms/IMT\"&gt;text/html&lt;/rdf:value&gt;\n          &lt;/rdf:Description&gt;\n        &lt;/dcterms:format&gt;\n        &lt;dcterms:isFormatOf rdf:resource=\"ebooks/20\"/&gt;\n        &lt;dcterms:modified rdf:datatype=\"http://www.w3.org/2001/XMLSchema#dateTime\"&gt;2017-03-01T01:04:16.955332&lt;/dcterms:modified&gt;\n      &lt;/pgterms:file&gt;\n    &lt;/dcterms:hasFormat&gt;\n    &lt;pgterms:bookshelf&gt;\n      &lt;rdf:Description rdf:nodeID=\"Nec598f664c934ed49ba3c0168ef09615\"&gt;\n        &lt;rdf:value&gt;Banned Books from Anne Haight's list&lt;/rdf:value&gt;\n        &lt;dcam:memberOf rdf:resource=\"2009/pgterms/Bookshelf\"/&gt;\n      &lt;/rdf:Description&gt;\n    &lt;/pgterms:bookshelf&gt;\n    &lt;dcterms:hasFormat&gt;\n      &lt;pgterms:file rdf:about=\"http://www.gutenberg.org/ebooks/20.txt.utf-8\"&gt;\n        &lt;dcterms:extent rdf:datatype=\"http://www.w3.org/2001/XMLSchema#integer\"&gt;507105&lt;/dcterms:extent&gt;\n        &lt;dcterms:format&gt;\n          &lt;rdf:Description rdf:nodeID=\"N069b84f8b10844e9a6c713f4c163880b\"&gt;\n            &lt;rdf:value rdf:datatype=\"http://purl.org/dc/terms/IMT\"&gt;text/plain&lt;/rdf:value&gt;\n            &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/IMT\"/&gt;\n          &lt;/rdf:Description&gt;\n        &lt;/dcterms:format&gt;\n        &lt;dcterms:isFormatOf rdf:resource=\"ebooks/20\"/&gt;\n        &lt;dcterms:modified rdf:datatype=\"http://www.w3.org/2001/XMLSchema#dateTime\"&gt;2017-03-01T01:04:15.953358&lt;/dcterms:modified&gt;\n      &lt;/pgterms:file&gt;\n    &lt;/dcterms:hasFormat&gt;\n    &lt;dcterms:subject&gt;\n      &lt;rdf:Description rdf:nodeID=\"Nb489692851fa496d96b1a7fdf7a71b21\"&gt;\n        &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/LCSH\"/&gt;\n        &lt;rdf:value&gt;Fall of man -- Poetry&lt;/rdf:value&gt;\n      &lt;/rdf:Description&gt;\n    &lt;/dcterms:subject&gt;\n    &lt;pgterms:downloads rdf:datatype=\"http://www.w3.org/2001/XMLSchema#integer\"&gt;2088&lt;/pgterms:downloads&gt;\n    &lt;dcterms:subject&gt;\n      &lt;rdf:Description rdf:nodeID=\"Naa6849a7660b4039baadec8af58f0c58\"&gt;\n        &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/LCSH\"/&gt;\n        &lt;rdf:value&gt;Bible. Genesis -- History of Biblical events -- Poetry&lt;/rdf:value&gt;\n      &lt;/rdf:Description&gt;\n    &lt;/dcterms:subject&gt;\n    &lt;dcterms:hasFormat&gt;\n      &lt;pgterms:file rdf:about=\"http://www.gutenberg.org/files/20/20.zip\"&gt;\n        &lt;dcterms:extent rdf:datatype=\"http://www.w3.org/2001/XMLSchema#integer\"&gt;205748&lt;/dcterms:extent&gt;\n        &lt;dcterms:format&gt;\n          &lt;rdf:Description rdf:nodeID=\"N19cf968278bc4922bd87b17209c20d94\"&gt;\n            &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/IMT\"/&gt;\n            &lt;rdf:value rdf:datatype=\"http://purl.org/dc/terms/IMT\"&gt;text/plain; charset=us-ascii&lt;/rdf:value&gt;\n          &lt;/rdf:Description&gt;\n        &lt;/dcterms:format&gt;\n        &lt;dcterms:isFormatOf rdf:resource=\"ebooks/20\"/&gt;\n        &lt;dcterms:modified rdf:datatype=\"http://www.w3.org/2001/XMLSchema#dateTime\"&gt;2011-03-02T06:34:42&lt;/dcterms:modified&gt;\n        &lt;dcterms:format&gt;\n          &lt;rdf:Description rdf:nodeID=\"N94c2881f340a49c18246b69af3abcf12\"&gt;\n            &lt;rdf:value rdf:datatype=\"http://purl.org/dc/terms/IMT\"&gt;application/zip&lt;/rdf:value&gt;\n            &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/IMT\"/&gt;\n          &lt;/rdf:Description&gt;\n        &lt;/dcterms:format&gt;\n      &lt;/pgterms:file&gt;\n    &lt;/dcterms:hasFormat&gt;\n  &lt;/pgterms:ebook&gt;\n  &lt;rdf:Description rdf:about=\"http://en.wikipedia.org/wiki/John_Milton\"&gt;\n    &lt;dcterms:description&gt;Wikipedia&lt;/dcterms:description&gt;\n  &lt;/rdf:Description&gt;\n&lt;/rdf:RDF&gt;\n</code></pre>\n\n<p>And I want to turn this information into a regular Haskell data structure that I can query and manipulate. For example, I might want to query the title of this work, or get all of its Wikipedia URLs. </p>\n\n<p>I notice that there's <a href=\"https://hackage.haskell.org/package/rdf4h-3.0.1\" rel=\"nofollow noreferrer\">an RDF library in Haskell, rdh4h</a> and that it has an XML parser. But I can't make heads or tails of the documentation, and there doesn't seem to be a tutorial around anywhere. </p>\n\n<p>Another thing I've thought about doing is just importing all these RDF/XML files into a database of some sort, and then querying that database somehow using Haskell. But I'm not sure what database is appropriate, or whether that's even possible. </p>\n\n<p>Of course, I could just treat this as XML data, ignoring the RDF aspect, but that seems like a ton of work, and I'd have to write some really long data structure for every thing in this XML file I wanted to get out. </p>\n\n<p>Does anyone have any ideas about how to query data like this using Haskell? </p>\n"}, {"tags": ["haskell", "yesod", "yesod-julius"], "comments": [{"owner": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "edited": false, "score": 0, "creation_date": 1521154203, "post_id": 49309687, "comment_id": 85622951, "body": "What are the exact errors you are getting? How is dashboardMain defined? If the errors are related to javascript global variables clashing/overriding one another(which sounds like the case), consider using javascript constructs such as self executing functions(thus creating a local scope for each script) or using newIdent to give unique identifiers to the variables."}], "owner": {"reputation": 3418, "user_id": 738762, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/0ef9a1ef193431ba6a0e2fc5c71ab22d?s=128&d=identicon&r=PG", "display_name": "nomen", "link": "https://stackoverflow.com/users/738762/nomen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 100, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1523559981, "creation_date": 1521149976, "last_edit_date": 1521162248, "question_id": 49309687, "link": "https://stackoverflow.com/questions/49309687/yesod-using-widget-twice-in-widget-duplicates-julius", "title": "Yesod: using widget twice in widget duplicates Julius", "body": "<p>I have a Yesod widget which loads a widget twice.  The \"main\" widget looks like:</p>\n\n<pre><code>&lt;div .container-fluid .hidden-xs&gt;\n  &lt;div .row .no-gutter&gt;\n    &lt;div .col-sm-3&gt;\n      &lt;!-- sidebar content --&gt;\n    &lt;div .col-sm-9&gt;\n      &lt;!-- the widget i'm loading twice --&gt;\n      ^{dashboardMain}\n&lt;nav .visible-xs&gt;\n  &lt;!-- sidebar content, also loaded twice, but this widget isn't causing problems (yet) --&gt;\n&lt;div .container .visible-xs&gt;\n  &lt;div .row .no-gutter&gt;\n    ^{dashboardMain}\n</code></pre>\n\n<p>I am running into problems because the Julius file for my <code>dashboardMain</code> argument is getting loaded and compiled twice.  Yesod is concatenating two copies of my Julius file together.  This is breaking things elsewhere.</p>\n\n<p>My Haskell code looks like:</p>\n\n<pre><code>crmSidebar :: Widget\ncrmSidebar = defaultSidebarItems -- Using Knockout and a convention based \"api\"\n\ncrmApp :: Widget\ncrmApp = $(widgetFile \"app/crm\")\n\ngetCRMDashboardR :: Handler TypedContent\ngetCRMDashboardR = selectRep . provideRep . defaultLayout $ dashboardLayout crmSidebarItems crmApp\n</code></pre>\n\n<p>The Haskell compiles fine, but like I said, I am getting a runtime Javascript error because of how Yesod/Julius is processing my widget.  What should I do?</p>\n\n<hr />\n\n<p>Edit 1:</p>\n\n<p>I'm using KnockoutJS, which requires <code>ko.applyBindings(viewModel)</code> to be applied exactly once.  Changing that isn't an option.</p>\n\n<p><code>dashboardLayout</code> is defined by</p>\n\n<pre><code>dashboardLayout :: String -&gt; Widget -&gt; Widget -&gt; Widget\ndashboardLayout sidebarHeader dashboardSidebarItems dashboardMain = $(widgetFile \"layouts/dashboard\")\n</code></pre>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1521138852, "post_id": 49306302, "comment_id": 85615829, "body": "Which package are you building? If it is in Hackage and/or Stackage, what its version is? If not, can you post its .cabal file (or its <code>package.yaml</code>) and <code>stack.yaml</code>?"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 2, "creation_date": 1521139097, "post_id": 49306302, "comment_id": 85615954, "body": "It&#39;s being worked upon: <a href=\"https://github.com/commercialhaskell/stack/issues/3923\" rel=\"nofollow noreferrer\">github.com/commercialhaskell/stack/issues/3923</a>"}, {"owner": {"reputation": 1998, "user_id": 79475, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a7d29c825581e5a220b2ae0c27e4cdce?s=128&d=identicon&r=PG", "display_name": "The_Ghost", "link": "https://stackoverflow.com/users/79475/the-ghost"}, "edited": false, "score": 0, "creation_date": 1521140807, "post_id": 49306302, "comment_id": 85616874, "body": "Thanks! I found another one - <a href=\"https://github.com/fpco/stackage/issues/3375\" rel=\"nofollow noreferrer\">github.com/fpco/stackage/issues/3375</a>"}], "owner": {"reputation": 1998, "user_id": 79475, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a7d29c825581e5a220b2ae0c27e4cdce?s=128&d=identicon&r=PG", "display_name": "The_Ghost", "link": "https://stackoverflow.com/users/79475/the-ghost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1521137949, "creation_date": 1521136797, "last_edit_date": 1521137949, "question_id": 49306302, "link": "https://stackoverflow.com/questions/49306302/after-change-of-resolver-to-latest-nightly-i-got-strange-message", "title": "After change of resolver to latest nightly I got strange message", "body": "<p>What this does mean:</p>\n\n<blockquote>\n  <p>The following packages specified by flags or options are not found:\n  persistent-sqlite</p>\n</blockquote>\n\n<p>This is on the latest nightly nightly-2018-03-15 (GHC 8.4.1)</p>\n\n<p>Note that the package I'm building doesn't depend on <code>persistent-sqlite</code>.</p>\n"}, {"tags": ["xml", "haskell", "rdf"], "comments": [{"owner": {"reputation": 1909, "user_id": 258738, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/64980b61abd5be8de69dcdc8d4bc6501?s=128&d=identicon&r=PG", "display_name": "Marcelo Zabani", "link": "https://stackoverflow.com/users/258738/marcelo-zabani"}, "edited": false, "score": 1, "creation_date": 1521131445, "post_id": 49303761, "comment_id": 85611355, "body": "Have you looked at xml-conduit? It doesn&#39;t require knowledge of any complicated abstractions or advanced type system features."}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 2, "creation_date": 1521131695, "post_id": 49303761, "comment_id": 85611538, "body": "<code>rdf4h</code> doesn&#39;t look that complex too. You just need to call <code>parseString</code>/<code>parseFile</code> with <code>XmlParser</code> argument."}, {"owner": {"reputation": 9995, "user_id": 7879193, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bVdcN0nQCio/AAAAAAAAAAI/AAAAAAAACfs/jPa4Dr_Nzbk/photo.jpg?sz=128", "display_name": "Stanislav Kralin", "link": "https://stackoverflow.com/users/7879193/stanislav-kralin"}, "edited": false, "score": 0, "creation_date": 1521133278, "post_id": 49303761, "comment_id": 85612629, "body": "Please avoid XML parsing."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 9995, "user_id": 7879193, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bVdcN0nQCio/AAAAAAAAAAI/AAAAAAAACfs/jPa4Dr_Nzbk/photo.jpg?sz=128", "display_name": "Stanislav Kralin", "link": "https://stackoverflow.com/users/7879193/stanislav-kralin"}, "edited": false, "score": 0, "creation_date": 1521133985, "post_id": 49303761, "comment_id": 85613051, "body": "@StanislavKralin I presume you mean XML parsers aren&#39;t good and/or convenient tools to correctly parse RDF metadata? (I&#39;m asking because I&#39;m not at all familiar with the RDF format.)"}, {"owner": {"reputation": 9995, "user_id": 7879193, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bVdcN0nQCio/AAAAAAAAAAI/AAAAAAAACfs/jPa4Dr_Nzbk/photo.jpg?sz=128", "display_name": "Stanislav Kralin", "link": "https://stackoverflow.com/users/7879193/stanislav-kralin"}, "edited": false, "score": 1, "creation_date": 1521134733, "post_id": 49303761, "comment_id": 85613528, "body": "<a href=\"https://stackoverflow.com/questions/45203061/how-to-limit-the-scope-of-element-extraction-between-the-start-and-end-tag-of-a#comment78478172_45203061\">Your Python fellow opinion</a>. Try to find an RDF library for Haskell. Also, RDF can be serialized in RDF in different ways (respectively, different serializations can be equivalent in abstract RDF syntax)."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1521135170, "post_id": 49303761, "comment_id": 85613784, "body": "For the sake of completeness, links to documentation for <a href=\"https://www.stackage.org/lts-11.0/package/xml-conduit-1.8.0\" rel=\"nofollow noreferrer\"><i>xml-conduit</i></a> and <a href=\"https://hackage.haskell.org/package/hxt-9.3.1.16\" rel=\"nofollow noreferrer\"><i>hxt</i></a> (the latter presumably being the XML library with an arrow-based interface you allude to)."}, {"owner": {"reputation": 9995, "user_id": 7879193, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bVdcN0nQCio/AAAAAAAAAAI/AAAAAAAACfs/jPa4Dr_Nzbk/photo.jpg?sz=128", "display_name": "Stanislav Kralin", "link": "https://stackoverflow.com/users/7879193/stanislav-kralin"}, "edited": false, "score": 1, "creation_date": 1521135521, "post_id": 49303761, "comment_id": 85614009, "body": "Or better load RDF into local SPARQL endpoint and then query RDF with SPARQL (using endpoint GUI or <code>hsparql</code>). Unfortunately, it seems that <code>rdf4h</code> can&#39;t perform SPARQL queries."}, {"owner": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1521150146, "post_id": 49303761, "comment_id": 85621435, "body": "@arrowd, How would I go about parsing XML like the above using rdf4h? And what kinds of data structures would that produce? I can&#39;t seem to find any good tutorials around."}, {"owner": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "reply_to_user": {"reputation": 9995, "user_id": 7879193, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bVdcN0nQCio/AAAAAAAAAAI/AAAAAAAACfs/jPa4Dr_Nzbk/photo.jpg?sz=128", "display_name": "Stanislav Kralin", "link": "https://stackoverflow.com/users/7879193/stanislav-kralin"}, "edited": false, "score": 0, "creation_date": 1521152635, "post_id": 49303761, "comment_id": 85622377, "body": "@StanislavKralin, how would I go about doing that?"}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1521181557, "post_id": 49303761, "comment_id": 85630206, "body": "@Jono Into a triples list for instance: <a href=\"https://github.com/robstewart57/rdf4h/blob/master/examples/ParseURLs.hs\" rel=\"nofollow noreferrer\">github.com/robstewart57/rdf4h/blob/master/examples/ParseURLs&zwnj;&#8203;.hs</a>"}, {"owner": {"reputation": 9995, "user_id": 7879193, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bVdcN0nQCio/AAAAAAAAAAI/AAAAAAAACfs/jPa4Dr_Nzbk/photo.jpg?sz=128", "display_name": "Stanislav Kralin", "link": "https://stackoverflow.com/users/7879193/stanislav-kralin"}, "edited": false, "score": 0, "creation_date": 1521182262, "post_id": 49303761, "comment_id": 85630470, "body": "@Jono, possibly <a href=\"https://stackoverflow.com/questions/tagged/fuseki\">fuseki</a> is the best SPARQL endpoint to start with. Unfortunately, there is no SPARQL endpoints or triplestores with SPARQL support written in Haskell."}, {"owner": {"reputation": 8018, "user_id": 4744359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7794bbbd8bab9c8e1f739918c29914cf?s=128&d=identicon&r=PG&f=1", "display_name": "UninformedUser", "link": "https://stackoverflow.com/users/4744359/uninformeduser"}, "reply_to_user": {"reputation": 9995, "user_id": 7879193, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bVdcN0nQCio/AAAAAAAAAAI/AAAAAAAACfs/jPa4Dr_Nzbk/photo.jpg?sz=128", "display_name": "Stanislav Kralin", "link": "https://stackoverflow.com/users/7879193/stanislav-kralin"}, "edited": false, "score": 1, "creation_date": 1521184314, "post_id": 49303761, "comment_id": 85631380, "body": "@StanislavKralin Why not simply use an HTTP GET request and parse e.g. JSON resultset? Shouldn&#39;t be that difficult, though, indeed some more lines of code."}, {"owner": {"reputation": 9995, "user_id": 7879193, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bVdcN0nQCio/AAAAAAAAAAI/AAAAAAAACfs/jPa4Dr_Nzbk/photo.jpg?sz=128", "display_name": "Stanislav Kralin", "link": "https://stackoverflow.com/users/7879193/stanislav-kralin"}, "reply_to_user": {"reputation": 8018, "user_id": 4744359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7794bbbd8bab9c8e1f739918c29914cf?s=128&d=identicon&r=PG&f=1", "display_name": "UninformedUser", "link": "https://stackoverflow.com/users/4744359/uninformeduser"}, "edited": false, "score": 0, "creation_date": 1521185579, "post_id": 49303761, "comment_id": 85631958, "body": "@AKSW, <a href=\"http://wifo5-03.informatik.uni-mannheim.de/gutendata/sparql\" rel=\"nofollow noreferrer\">their endpoint</a> is not available (there is a dump only), or I can&#39;t understand you."}, {"owner": {"reputation": 8018, "user_id": 4744359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7794bbbd8bab9c8e1f739918c29914cf?s=128&d=identicon&r=PG&f=1", "display_name": "UninformedUser", "link": "https://stackoverflow.com/users/4744359/uninformeduser"}, "edited": false, "score": 1, "creation_date": 1521186026, "post_id": 49303761, "comment_id": 85632144, "body": "Well, I meant just what you said. Load the dump into a triple store, e.g. Fuseki and query via HTTP. Better than parsing XML data which encodes RDF..."}, {"owner": {"reputation": 9995, "user_id": 7879193, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bVdcN0nQCio/AAAAAAAAAAI/AAAAAAAACfs/jPa4Dr_Nzbk/photo.jpg?sz=128", "display_name": "Stanislav Kralin", "link": "https://stackoverflow.com/users/7879193/stanislav-kralin"}, "reply_to_user": {"reputation": 8018, "user_id": 4744359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7794bbbd8bab9c8e1f739918c29914cf?s=128&d=identicon&r=PG&f=1", "display_name": "UninformedUser", "link": "https://stackoverflow.com/users/4744359/uninformeduser"}, "edited": false, "score": 0, "creation_date": 1521187274, "post_id": 49303761, "comment_id": 85632713, "body": "@AKSW, OK. Haskellers also have the <code>hsparql</code> package, in which SPARQL queries look similar to SPARQL algebra :-)."}, {"owner": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1521769197, "post_id": 49303761, "comment_id": 85884161, "body": "@arrowd, <code>TriplesList</code> doesn&#39;t seem to exist in Data.RDF. Either I just can&#39;t find it or that example is out of date."}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1521785045, "post_id": 49303761, "comment_id": 85888253, "body": "@Jono Then use example provided y the package itself: <a href=\"https://hackage.haskell.org/package/rdf4h-3.0.1/src/examples/ParseURLs.hs\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/rdf4h-3.0.1/src/examples/&hellip;</a>"}], "owner": {"reputation": 8964, "user_id": 584121, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/3c7af62d226bc7420d49128d03a5b139?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/584121/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 277, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1521150158, "creation_date": 1521128736, "last_edit_date": 1521150158, "question_id": 49303761, "link": "https://stackoverflow.com/questions/49303761/what-is-an-easy-way-to-parse-project-gutenberg-rdf-metadata-using-haskell", "title": "What is an easy way to parse Project Gutenberg RDF metadata using Haskell?", "body": "<p>I'm a Haskell beginner. I'd like to be able to parse Project Gutenberg RDF metadata in Haskell, but I don't really know where to start. It's RDF XML, so it's basically XML with some funky namespace stuff thrown in. I saw that there's the <a href=\"https://hackage.haskell.org/package/rdf4h\" rel=\"nofollow noreferrer\">rdf4h</a> library, but it looks complicated. For parsing XML, there are a bunch of libraries, but most use arrows and things that I don't understand, and look needlessly complicated. There are other libraries like <a href=\"https://hackage.haskell.org/package/xml\" rel=\"nofollow noreferrer\">xml</a>, but I can't find any tutorials, and the documentation seems to only be code comments. I just wanted to know if anyone had thought about a problem like this, and whether there wasn't a solution that I hadn't considered. Thanks in advance!</p>\n\n<p>Edit: here's an example: </p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;rdf:RDF xml:base=\"http://www.gutenberg.org/\"\n  xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\"\n  xmlns:dcterms=\"http://purl.org/dc/terms/\"\n  xmlns:cc=\"http://web.resource.org/cc/\"\n  xmlns:dcam=\"http://purl.org/dc/dcam/\"\n  xmlns:rdfs=\"http://www.w3.org/2000/01/rdf-schema#\"\n  xmlns:pgterms=\"http://www.gutenberg.org/2009/pgterms/\"\n&gt;\n  &lt;cc:Work rdf:about=\"\"&gt;\n    &lt;rdfs:comment&gt;Archives containing the RDF files for *all* our books can be downloaded at\n            http://www.gutenberg.org/wiki/Gutenberg:Feeds#The_Complete_Project_Gutenberg_Catalog&lt;/rdfs:comment&gt;\n    &lt;cc:license rdf:resource=\"https://creativecommons.org/publicdomain/zero/1.0/\"/&gt;\n  &lt;/cc:Work&gt;\n  &lt;pgterms:ebook rdf:about=\"ebooks/20\"&gt;\n    &lt;pgterms:bookshelf&gt;\n      &lt;rdf:Description rdf:nodeID=\"N3f8445072d8e4499b2646626f94866e0\"&gt;\n        &lt;rdf:value&gt;Poetry&lt;/rdf:value&gt;\n        &lt;dcam:memberOf rdf:resource=\"2009/pgterms/Bookshelf\"/&gt;\n      &lt;/rdf:Description&gt;\n    &lt;/pgterms:bookshelf&gt;\n    &lt;dcterms:hasFormat&gt;\n      &lt;pgterms:file rdf:about=\"http://www.gutenberg.org/ebooks/20.rdf\"&gt;\n        &lt;dcterms:modified rdf:datatype=\"http://www.w3.org/2001/XMLSchema#dateTime\"&gt;2017-03-16T05:01:13.615047&lt;/dcterms:modified&gt;\n        &lt;dcterms:extent rdf:datatype=\"http://www.w3.org/2001/XMLSchema#integer\"&gt;12133&lt;/dcterms:extent&gt;\n        &lt;dcterms:isFormatOf rdf:resource=\"ebooks/20\"/&gt;\n        &lt;dcterms:format&gt;\n          &lt;rdf:Description rdf:nodeID=\"N735ba077c8424051b6470a92682aaa5e\"&gt;\n            &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/IMT\"/&gt;\n            &lt;rdf:value rdf:datatype=\"http://purl.org/dc/terms/IMT\"&gt;application/rdf+xml&lt;/rdf:value&gt;\n          &lt;/rdf:Description&gt;\n        &lt;/dcterms:format&gt;\n      &lt;/pgterms:file&gt;\n    &lt;/dcterms:hasFormat&gt;\n    &lt;dcterms:issued rdf:datatype=\"http://www.w3.org/2001/XMLSchema#date\"&gt;1991-10-01&lt;/dcterms:issued&gt;\n    &lt;dcterms:title&gt;Paradise Lost&lt;/dcterms:title&gt;\n    &lt;dcterms:subject&gt;\n      &lt;rdf:Description rdf:nodeID=\"Ne259525c666c4886a996acbdddca0682\"&gt;\n        &lt;rdf:value&gt;PR&lt;/rdf:value&gt;\n        &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/LCC\"/&gt;\n      &lt;/rdf:Description&gt;\n    &lt;/dcterms:subject&gt;\n    &lt;dcterms:hasFormat&gt;\n      &lt;pgterms:file rdf:about=\"http://www.gutenberg.org/files/20/20.txt\"&gt;\n        &lt;dcterms:extent rdf:datatype=\"http://www.w3.org/2001/XMLSchema#integer\"&gt;507133&lt;/dcterms:extent&gt;\n        &lt;dcterms:isFormatOf rdf:resource=\"ebooks/20\"/&gt;\n        &lt;dcterms:modified rdf:datatype=\"http://www.w3.org/2001/XMLSchema#dateTime\"&gt;2011-03-02T06:33:54&lt;/dcterms:modified&gt;\n        &lt;dcterms:format&gt;\n          &lt;rdf:Description rdf:nodeID=\"Nbd1740a2927845058b0fe43326dcc48b\"&gt;\n            &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/IMT\"/&gt;\n            &lt;rdf:value rdf:datatype=\"http://purl.org/dc/terms/IMT\"&gt;text/plain; charset=us-ascii&lt;/rdf:value&gt;\n          &lt;/rdf:Description&gt;\n        &lt;/dcterms:format&gt;\n      &lt;/pgterms:file&gt;\n    &lt;/dcterms:hasFormat&gt;\n    &lt;dcterms:hasFormat&gt;\n      &lt;pgterms:file rdf:about=\"http://www.gutenberg.org/ebooks/20.epub.images\"&gt;\n        &lt;dcterms:isFormatOf rdf:resource=\"ebooks/20\"/&gt;\n        &lt;dcterms:format&gt;\n          &lt;rdf:Description rdf:nodeID=\"Nb08f3d2980e64e91a402eb5b205c10bc\"&gt;\n            &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/IMT\"/&gt;\n            &lt;rdf:value rdf:datatype=\"http://purl.org/dc/terms/IMT\"&gt;application/epub+zip&lt;/rdf:value&gt;\n          &lt;/rdf:Description&gt;\n        &lt;/dcterms:format&gt;\n        &lt;dcterms:extent rdf:datatype=\"http://www.w3.org/2001/XMLSchema#integer\"&gt;232622&lt;/dcterms:extent&gt;\n        &lt;dcterms:modified rdf:datatype=\"http://www.w3.org/2001/XMLSchema#dateTime\"&gt;2017-03-01T01:04:17.425321&lt;/dcterms:modified&gt;\n      &lt;/pgterms:file&gt;\n    &lt;/dcterms:hasFormat&gt;\n    &lt;dcterms:hasFormat&gt;\n      &lt;pgterms:file rdf:about=\"http://www.gutenberg.org/ebooks/20.kindle.images\"&gt;\n        &lt;dcterms:isFormatOf rdf:resource=\"ebooks/20\"/&gt;\n        &lt;dcterms:extent rdf:datatype=\"http://www.w3.org/2001/XMLSchema#integer\"&gt;933970&lt;/dcterms:extent&gt;\n        &lt;dcterms:format&gt;\n          &lt;rdf:Description rdf:nodeID=\"Nff1df57b9552466d96b114f20424b5a2\"&gt;\n            &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/IMT\"/&gt;\n            &lt;rdf:value rdf:datatype=\"http://purl.org/dc/terms/IMT\"&gt;application/x-mobipocket-ebook&lt;/rdf:value&gt;\n          &lt;/rdf:Description&gt;\n        &lt;/dcterms:format&gt;\n        &lt;dcterms:modified rdf:datatype=\"http://www.w3.org/2001/XMLSchema#dateTime\"&gt;2017-03-01T01:04:21.321235&lt;/dcterms:modified&gt;\n      &lt;/pgterms:file&gt;\n    &lt;/dcterms:hasFormat&gt;\n    &lt;dcterms:language&gt;\n      &lt;rdf:Description rdf:nodeID=\"N91273d0bffc74be393cda307d2b05137\"&gt;\n        &lt;rdf:value rdf:datatype=\"http://purl.org/dc/terms/RFC4646\"&gt;en&lt;/rdf:value&gt;\n      &lt;/rdf:Description&gt;\n    &lt;/dcterms:language&gt;\n    &lt;dcterms:subject&gt;\n      &lt;rdf:Description rdf:nodeID=\"N5e35fb378b37483ca6ef7a08f27cf936\"&gt;\n        &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/LCSH\"/&gt;\n        &lt;rdf:value&gt;Eve (Biblical figure) -- Poetry&lt;/rdf:value&gt;\n      &lt;/rdf:Description&gt;\n    &lt;/dcterms:subject&gt;\n    &lt;dcterms:license rdf:resource=\"license\"/&gt;\n    &lt;dcterms:hasFormat&gt;\n      &lt;pgterms:file rdf:about=\"http://www.gutenberg.org/ebooks/20.html.images\"&gt;\n        &lt;dcterms:extent rdf:datatype=\"http://www.w3.org/2001/XMLSchema#integer\"&gt;614618&lt;/dcterms:extent&gt;\n        &lt;dcterms:modified rdf:datatype=\"http://www.w3.org/2001/XMLSchema#dateTime\"&gt;2017-03-01T01:04:16.685338&lt;/dcterms:modified&gt;\n        &lt;dcterms:isFormatOf rdf:resource=\"ebooks/20\"/&gt;\n        &lt;dcterms:format&gt;\n          &lt;rdf:Description rdf:nodeID=\"N7567260ec2fd48c0be3d2858e08ac35d\"&gt;\n            &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/IMT\"/&gt;\n            &lt;rdf:value rdf:datatype=\"http://purl.org/dc/terms/IMT\"&gt;text/html&lt;/rdf:value&gt;\n          &lt;/rdf:Description&gt;\n        &lt;/dcterms:format&gt;\n      &lt;/pgterms:file&gt;\n    &lt;/dcterms:hasFormat&gt;\n    &lt;dcterms:hasFormat&gt;\n      &lt;pgterms:file rdf:about=\"http://www.gutenberg.org/ebooks/20.epub.noimages\"&gt;\n        &lt;dcterms:isFormatOf rdf:resource=\"ebooks/20\"/&gt;\n        &lt;dcterms:modified rdf:datatype=\"http://www.w3.org/2001/XMLSchema#dateTime\"&gt;2017-03-01T01:04:17.695324&lt;/dcterms:modified&gt;\n        &lt;dcterms:extent rdf:datatype=\"http://www.w3.org/2001/XMLSchema#integer\"&gt;232623&lt;/dcterms:extent&gt;\n        &lt;dcterms:format&gt;\n          &lt;rdf:Description rdf:nodeID=\"Nb640302bc2a84a31b0e154318df817d1\"&gt;\n            &lt;rdf:value rdf:datatype=\"http://purl.org/dc/terms/IMT\"&gt;application/epub+zip&lt;/rdf:value&gt;\n            &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/IMT\"/&gt;\n          &lt;/rdf:Description&gt;\n        &lt;/dcterms:format&gt;\n      &lt;/pgterms:file&gt;\n    &lt;/dcterms:hasFormat&gt;\n    &lt;dcterms:hasFormat&gt;\n      &lt;pgterms:file rdf:about=\"http://www.gutenberg.org/ebooks/20.kindle.noimages\"&gt;\n        &lt;dcterms:isFormatOf rdf:resource=\"ebooks/20\"/&gt;\n        &lt;dcterms:extent rdf:datatype=\"http://www.w3.org/2001/XMLSchema#integer\"&gt;933967&lt;/dcterms:extent&gt;\n        &lt;dcterms:modified rdf:datatype=\"http://www.w3.org/2001/XMLSchema#dateTime\"&gt;2017-03-01T01:04:24.846165&lt;/dcterms:modified&gt;\n        &lt;dcterms:format&gt;\n          &lt;rdf:Description rdf:nodeID=\"N1857bba1f5484e3d84846e1a554ec593\"&gt;\n            &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/IMT\"/&gt;\n            &lt;rdf:value rdf:datatype=\"http://purl.org/dc/terms/IMT\"&gt;application/x-mobipocket-ebook&lt;/rdf:value&gt;\n          &lt;/rdf:Description&gt;\n        &lt;/dcterms:format&gt;\n      &lt;/pgterms:file&gt;\n    &lt;/dcterms:hasFormat&gt;\n    &lt;dcterms:publisher&gt;Project Gutenberg&lt;/dcterms:publisher&gt;\n    &lt;dcterms:rights&gt;Public domain in the USA.&lt;/dcterms:rights&gt;\n    &lt;dcterms:creator&gt;\n      &lt;pgterms:agent rdf:about=\"2009/agents/17\"&gt;\n        &lt;pgterms:deathdate rdf:datatype=\"http://www.w3.org/2001/XMLSchema#integer\"&gt;1674&lt;/pgterms:deathdate&gt;\n        &lt;pgterms:webpage rdf:resource=\"http://en.wikipedia.org/wiki/John_Milton\"/&gt;\n        &lt;pgterms:name&gt;Milton, John&lt;/pgterms:name&gt;\n        &lt;pgterms:birthdate rdf:datatype=\"http://www.w3.org/2001/XMLSchema#integer\"&gt;1608&lt;/pgterms:birthdate&gt;\n      &lt;/pgterms:agent&gt;\n    &lt;/dcterms:creator&gt;\n    &lt;dcterms:type&gt;\n      &lt;rdf:Description rdf:nodeID=\"N0f6e6d76b1ff4ea9a2c5c37949efe82b\"&gt;\n        &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/DCMIType\"/&gt;\n        &lt;rdf:value&gt;Text&lt;/rdf:value&gt;\n      &lt;/rdf:Description&gt;\n    &lt;/dcterms:type&gt;\n    &lt;dcterms:subject&gt;\n      &lt;rdf:Description rdf:nodeID=\"N202624c4b5994d39a3ab8bf0a2a31d95\"&gt;\n        &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/LCSH\"/&gt;\n        &lt;rdf:value&gt;Adam (Biblical figure) -- Poetry&lt;/rdf:value&gt;\n      &lt;/rdf:Description&gt;\n    &lt;/dcterms:subject&gt;\n    &lt;dcterms:hasFormat&gt;\n      &lt;pgterms:file rdf:about=\"http://www.gutenberg.org/ebooks/20.html.noimages\"&gt;\n        &lt;dcterms:extent rdf:datatype=\"http://www.w3.org/2001/XMLSchema#integer\"&gt;614618&lt;/dcterms:extent&gt;\n        &lt;dcterms:format&gt;\n          &lt;rdf:Description rdf:nodeID=\"N79f919d14da448e19eb05c444322ddd2\"&gt;\n            &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/IMT\"/&gt;\n            &lt;rdf:value rdf:datatype=\"http://purl.org/dc/terms/IMT\"&gt;text/html&lt;/rdf:value&gt;\n          &lt;/rdf:Description&gt;\n        &lt;/dcterms:format&gt;\n        &lt;dcterms:isFormatOf rdf:resource=\"ebooks/20\"/&gt;\n        &lt;dcterms:modified rdf:datatype=\"http://www.w3.org/2001/XMLSchema#dateTime\"&gt;2017-03-01T01:04:16.955332&lt;/dcterms:modified&gt;\n      &lt;/pgterms:file&gt;\n    &lt;/dcterms:hasFormat&gt;\n    &lt;pgterms:bookshelf&gt;\n      &lt;rdf:Description rdf:nodeID=\"Nec598f664c934ed49ba3c0168ef09615\"&gt;\n        &lt;rdf:value&gt;Banned Books from Anne Haight's list&lt;/rdf:value&gt;\n        &lt;dcam:memberOf rdf:resource=\"2009/pgterms/Bookshelf\"/&gt;\n      &lt;/rdf:Description&gt;\n    &lt;/pgterms:bookshelf&gt;\n    &lt;dcterms:hasFormat&gt;\n      &lt;pgterms:file rdf:about=\"http://www.gutenberg.org/ebooks/20.txt.utf-8\"&gt;\n        &lt;dcterms:extent rdf:datatype=\"http://www.w3.org/2001/XMLSchema#integer\"&gt;507105&lt;/dcterms:extent&gt;\n        &lt;dcterms:format&gt;\n          &lt;rdf:Description rdf:nodeID=\"N069b84f8b10844e9a6c713f4c163880b\"&gt;\n            &lt;rdf:value rdf:datatype=\"http://purl.org/dc/terms/IMT\"&gt;text/plain&lt;/rdf:value&gt;\n            &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/IMT\"/&gt;\n          &lt;/rdf:Description&gt;\n        &lt;/dcterms:format&gt;\n        &lt;dcterms:isFormatOf rdf:resource=\"ebooks/20\"/&gt;\n        &lt;dcterms:modified rdf:datatype=\"http://www.w3.org/2001/XMLSchema#dateTime\"&gt;2017-03-01T01:04:15.953358&lt;/dcterms:modified&gt;\n      &lt;/pgterms:file&gt;\n    &lt;/dcterms:hasFormat&gt;\n    &lt;dcterms:subject&gt;\n      &lt;rdf:Description rdf:nodeID=\"Nb489692851fa496d96b1a7fdf7a71b21\"&gt;\n        &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/LCSH\"/&gt;\n        &lt;rdf:value&gt;Fall of man -- Poetry&lt;/rdf:value&gt;\n      &lt;/rdf:Description&gt;\n    &lt;/dcterms:subject&gt;\n    &lt;pgterms:downloads rdf:datatype=\"http://www.w3.org/2001/XMLSchema#integer\"&gt;2088&lt;/pgterms:downloads&gt;\n    &lt;dcterms:subject&gt;\n      &lt;rdf:Description rdf:nodeID=\"Naa6849a7660b4039baadec8af58f0c58\"&gt;\n        &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/LCSH\"/&gt;\n        &lt;rdf:value&gt;Bible. Genesis -- History of Biblical events -- Poetry&lt;/rdf:value&gt;\n      &lt;/rdf:Description&gt;\n    &lt;/dcterms:subject&gt;\n    &lt;dcterms:hasFormat&gt;\n      &lt;pgterms:file rdf:about=\"http://www.gutenberg.org/files/20/20.zip\"&gt;\n        &lt;dcterms:extent rdf:datatype=\"http://www.w3.org/2001/XMLSchema#integer\"&gt;205748&lt;/dcterms:extent&gt;\n        &lt;dcterms:format&gt;\n          &lt;rdf:Description rdf:nodeID=\"N19cf968278bc4922bd87b17209c20d94\"&gt;\n            &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/IMT\"/&gt;\n            &lt;rdf:value rdf:datatype=\"http://purl.org/dc/terms/IMT\"&gt;text/plain; charset=us-ascii&lt;/rdf:value&gt;\n          &lt;/rdf:Description&gt;\n        &lt;/dcterms:format&gt;\n        &lt;dcterms:isFormatOf rdf:resource=\"ebooks/20\"/&gt;\n        &lt;dcterms:modified rdf:datatype=\"http://www.w3.org/2001/XMLSchema#dateTime\"&gt;2011-03-02T06:34:42&lt;/dcterms:modified&gt;\n        &lt;dcterms:format&gt;\n          &lt;rdf:Description rdf:nodeID=\"N94c2881f340a49c18246b69af3abcf12\"&gt;\n            &lt;rdf:value rdf:datatype=\"http://purl.org/dc/terms/IMT\"&gt;application/zip&lt;/rdf:value&gt;\n            &lt;dcam:memberOf rdf:resource=\"http://purl.org/dc/terms/IMT\"/&gt;\n          &lt;/rdf:Description&gt;\n        &lt;/dcterms:format&gt;\n      &lt;/pgterms:file&gt;\n    &lt;/dcterms:hasFormat&gt;\n  &lt;/pgterms:ebook&gt;\n  &lt;rdf:Description rdf:about=\"http://en.wikipedia.org/wiki/John_Milton\"&gt;\n    &lt;dcterms:description&gt;Wikipedia&lt;/dcterms:description&gt;\n  &lt;/rdf:Description&gt;\n&lt;/rdf:RDF&gt;\n</code></pre>\n"}, {"tags": ["parsing", "haskell", "parsec"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1521126378, "post_id": 49302654, "comment_id": 85607701, "body": "It&#39;s not a bad idea, it just may not be <i>necessary</i>. The two states are logically separate; one initializes the parser itself, the other initializes the <code>State</code> <i>produced</i> by the parser."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1521128670, "post_id": 49303061, "comment_id": 85609459, "body": "Unless maybe you want to collect statistics on backtracking or something."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1521137755, "post_id": 49303061, "comment_id": 85615293, "body": "@dfeuer Neat idea! Seems pretty niche for a production parser, but I could totally imagine using that during development."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 6, "last_activity_date": 1521126776, "creation_date": 1521126776, "answer_id": 49303061, "question_id": 49302654, "link": "https://stackoverflow.com/questions/49302654/why-does-runparsect-requires-the-initial-user-state-twice/49303061#49303061", "title": "Why does runParsecT requires the initial user state twice?", "body": "<p>Correct: mixing <code>ParsecT</code> and <code>StateT</code> is not a good idea. The <code>ParsecT</code> monad carefully restores its state when it backtracks, an action that an enclosing (or enclosed) <code>StateT</code> transformer doesn't and can't know about or handle correctly.</p>\n"}, {"tags": [], "owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "is_accepted": true, "score": 6, "last_activity_date": 1521127399, "creation_date": 1521127399, "answer_id": 49303273, "question_id": 49302654, "link": "https://stackoverflow.com/questions/49302654/why-does-runparsect-requires-the-initial-user-state-twice/49303273#49303273", "title": "Why does runParsecT requires the initial user state twice?", "body": "<p>ParsecT provides state. State provides state. Using both together gives you two independent states.</p>\n\n<p>You have to initialize both, which is why you see it twice. </p>\n\n<p>There's nothing wrong with using them together if you want two separate sources of state  (e.g. one that backtracks and one that doesn't), but if you only wanted one, this is clearly not what you'd do.</p>\n"}], "owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "closed_date": 1521246822, "accepted_answer_id": 49303273, "answer_count": 2, "score": 0, "last_activity_date": 1521127399, "creation_date": 1521125566, "question_id": 49302654, "link": "https://stackoverflow.com/questions/49302654/why-does-runparsect-requires-the-initial-user-state-twice", "closed_reason": "Duplicate", "title": "Why does runParsecT requires the initial user state twice?", "body": "<p>I've defined the following custom parser:</p>\n\n<pre><code>newtype St = St Int\ntype TxsParser = ParsecT String St (State St)\n</code></pre>\n\n<p>Now to be able to run this parser, I have to use the <a href=\"https://hackage.haskell.org/package/parsec-3.1.13.0/docs/Text-Parsec.html#v:runParserT\" rel=\"nofollow noreferrer\"><code>runParserT</code></a> function.</p>\n\n<pre><code>runParserT :: Stream s m t \n           =&gt; ParsecT s u m a \n           -&gt; u \n           -&gt; SourceName\n           -&gt; s \n           -&gt; m (Either ParseError a) \n</code></pre>\n\n<p>Which instantiated to my custom parser reads:</p>\n\n<pre><code>runParserT :: ParsecT String St (State St) a \n           -&gt; St \n           -&gt; SourceName \n           -&gt; String \n           -&gt; State St (Either ParseError a)\n</code></pre>\n\n<p>But this means that if I want to evaluate the result of <code>runParserT</code> (which is a state monad) I have to supply another initial state (of type <code>St</code> in this case). For instance:</p>\n\n<pre><code> evalState (runParserT myParser (St 0) fp input) (St 0)\n</code></pre>\n\n<p>While this works, it seems wrong that I have to repeat the state twice. Does this mean that mixing <code>ParsecT</code> and the <code>State</code> monads is not a good idea?</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1521125100, "post_id": 49301663, "comment_id": 85606657, "body": "From where do those comment come? They&#39;re not in <a href=\"http://www.seas.upenn.edu/~cis194/fall16/hw/08-functor-applicative.html\" rel=\"nofollow noreferrer\">the source you linked to</a>"}, {"owner": {"reputation": 297, "user_id": 2935375, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CYLMN.jpg?s=128&g=1", "display_name": "Shaurya Gupta", "link": "https://stackoverflow.com/users/2935375/shaurya-gupta"}, "reply_to_user": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1521125246, "post_id": 49301663, "comment_id": 85606764, "body": "@MarkSeemann I&#39;ve added the link to solution."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1521126656, "post_id": 49301663, "comment_id": 85607915, "body": "<code>func7</code> is just <code>func6</code> implemented with <code>&gt;&gt;=</code> instead of <code>fmap</code>, and the solution provides an example input where the two give different results."}, {"owner": {"reputation": 297, "user_id": 2935375, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CYLMN.jpg?s=128&g=1", "display_name": "Shaurya Gupta", "link": "https://stackoverflow.com/users/2935375/shaurya-gupta"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1521128515, "post_id": 49301663, "comment_id": 85609345, "body": "@chepner I understand that example but I was looking for a more concrete explanation. And <code>func6</code> has <code>return</code> followed by the conditions on <code>x</code> while <code>func7</code> has conditions followed by <code>return</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1521128754, "post_id": 49301663, "comment_id": 85609526, "body": "Sorry, I was looking at <code>func6&#39;</code>, which is the <code>Functor</code> version. But your question would be clearer if you had included the provided counterexample and asked why it <i>was</i> a counterexample."}, {"owner": {"reputation": 297, "user_id": 2935375, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CYLMN.jpg?s=128&g=1", "display_name": "Shaurya Gupta", "link": "https://stackoverflow.com/users/2935375/shaurya-gupta"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1521129683, "post_id": 49301663, "comment_id": 85610185, "body": "@chepner I understand why it is a counterexample. I&#39;m rather looking for a deeper explanation of the reasoning provided in solution."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1521129749, "post_id": 49301663, "comment_id": 85610234, "body": "Omitting that counterexample here changes your question considerably."}, {"owner": {"reputation": 297, "user_id": 2935375, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CYLMN.jpg?s=128&g=1", "display_name": "Shaurya Gupta", "link": "https://stackoverflow.com/users/2935375/shaurya-gupta"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1521131978, "post_id": 49301663, "comment_id": 85611728, "body": "@chepner I&#39;ve added the counterexample."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1521140738, "post_id": 49301663, "comment_id": 85616845, "body": "On a tangential note, with respect to the comment to <code>func6&#39;</code>, I don&#39;t see what is &quot;unorthodox&quot; about it -- if anything, I find that spelling more natural than the one in <code>func6</code>, not to mention that it allows relaxing a possibly unnecessary <code>Monad</code> constraint."}], "answers": [{"tags": [], "owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "is_accepted": false, "score": 4, "last_activity_date": 1521138006, "last_edit_date": 1521138006, "creation_date": 1521136981, "answer_id": 49306344, "question_id": 49301663, "link": "https://stackoverflow.com/questions/49301663/why-cant-i-implement-these-functions-with-a-functor-applicative-constraint-only/49306344#49306344", "title": "Why can&#39;t I implement these functions with a Functor/Applicative constraint only?", "body": "<p>I don't think typeclass laws are what you need to be worrying about here; in fact, I think the typeclasses unnnecessarily complicate the exercise, if your purpose is to understand nonstrictness.</p>\n\n<p>Here's a simpler example where everything is monomorphic, and rather than give examples using bottom, we're going to use <code>:sprint</code> in GHCi to watch the extent of the evaluation.</p>\n\n<h3>func6</h3>\n\n<p>My <code>x6</code> example here corresponds to <code>func6</code> in the question.</p>\n\n<pre><code>\u03bb&gt; x6 = Just . bool 'a' 'b' =&lt;&lt; Just True\n</code></pre>\n\n<p>Initially, nothing has been evaluated.</p>\n\n<pre><code>\u03bb&gt; :sprint x6\nx6 = _\n</code></pre>\n\n<p>Now we evaluate 'isJust x6'.</p>\n\n<pre><code>\u03bb&gt; isJust x6\nTrue\n</code></pre>\n\n<p>And now we can see that <code>x6</code> has been partially evaluated. Only to its head, though.</p>\n\n<pre><code>\u03bb&gt; :sprint x6\ny = Just _\n</code></pre>\n\n<p>Why? Because there was no need to know the result of the <code>bool 'a' 'b'</code> part just to determine whether the <code>Maybe</code> was going to be a <code>Just</code>. So it remains an unevaluated thunk.</p>\n\n<h3>func7</h3>\n\n<p>My <code>x7</code> example here corresponds to <code>func7</code> in the question.</p>\n\n<pre><code>\u03bb&gt; x7 = bool (Just 'a') (Just 'b') =&lt;&lt; Just True\nx :: Maybe Char\n</code></pre>\n\n<p>Again, initially nothing is evaluated.</p>\n\n<pre><code>\u03bb&gt; :sprint x7\nx = _\n</code></pre>\n\n<p>And again we'll apply <code>isJust</code>.</p>\n\n<pre><code>\u03bb&gt; isJust x7\nTrue\n</code></pre>\n\n<p>In this case, the content of the <code>Just</code> did get evaluated (so we say this definition was \"more strict\" or \"not as lazy\").</p>\n\n<pre><code>\u03bb&gt; :sprint x7\nx = Just 'b'\n</code></pre>\n\n<p>Why? Because we had to evaluate the <code>bool</code> application before we could tell whether it was going to produce a <code>Just</code> result.</p>\n"}, {"comments": [{"owner": {"reputation": 297, "user_id": 2935375, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CYLMN.jpg?s=128&g=1", "display_name": "Shaurya Gupta", "link": "https://stackoverflow.com/users/2935375/shaurya-gupta"}, "edited": false, "score": 0, "creation_date": 1521151838, "post_id": 49309496, "comment_id": 85622083, "body": "Enlightening. I was thinking about it in terms of code instead effects."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 297, "user_id": 2935375, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CYLMN.jpg?s=128&g=1", "display_name": "Shaurya Gupta", "link": "https://stackoverflow.com/users/2935375/shaurya-gupta"}, "edited": false, "score": 1, "creation_date": 1521157031, "post_id": 49309496, "comment_id": 85623863, "body": "@shauryagupta &quot;I was thinking about it in terms of code instead effects&quot; -- I&#39;m not sure if what follows reflects what you have in mind; in any case, looking at code from a, so to say, higher ground, using e.g. types and laws often helps to make sense of things. Do note that &quot;effect&quot;, in the way I&#39;m using it here, has a rather broad meaning -- the fact that <code>[8,6,7]</code> has three elements, for instance, can be considered an effect. See <a href=\"https://stackoverflow.com/q/33386622/2751851\"><i>What exactly does \u201ceffectful\u201d mean</i></a> for discussion of this point."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 297, "user_id": 2935375, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CYLMN.jpg?s=128&g=1", "display_name": "Shaurya Gupta", "link": "https://stackoverflow.com/users/2935375/shaurya-gupta"}, "edited": false, "score": 1, "creation_date": 1521157807, "post_id": 49309496, "comment_id": 85624053, "body": "@shauryagupta &quot;Which answer should I accept by the way?&quot; -- There is no right answer to this one :) Ideally, the accepted answer would cover all aspects of the question in sufficient depth. Doubts about which answer to accept often arise when multiple questions are rolled into one, or when each answerer focuses on different parts of the question. It&#39;s not a big deal, though it&#39;s one of the reasons why it&#39;s best not to ask multiple questions at once. (I don&#39;t think you did wrong here, though -- given the context, you might have reasonably expected the answers would be related when you posted.)"}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 1, "last_activity_date": 1521156018, "last_edit_date": 1521156018, "creation_date": 1521149077, "answer_id": 49309496, "question_id": 49301663, "link": "https://stackoverflow.com/questions/49301663/why-cant-i-implement-these-functions-with-a-functor-applicative-constraint-only/49309496#49309496", "title": "Why can&#39;t I implement these functions with a Functor/Applicative constraint only?", "body": "<p><a href=\"https://stackoverflow.com/a/49306344/2751851\">Chris Martin's answer</a> covers <code>func6</code> versus <code>func7</code> very well. (In short, the difference is that, thanks to laziness, <code>func6 @Maybe</code> can decide whether the constructor used for the result should be <code>Just</code> or <code>Nothing</code> without actually having to look at any value within its argument.)</p>\n\n<p>As for <code>func9</code>, what makes <code>Monad</code> necessary is that the function involves using values found in <code>xs</code> to decide on the functorial context of the result. (Synonyms for \"functorial context\" in this setting include \"effects\" and, as the solution you quote puts it, \"structure of the computation\".) For the sake of illustration, consider:</p>\n\n<pre><code>func9 (fmap read getLine) (putStrLn \"Even!\") (putStrLn \"Odd!\")\n</code></pre>\n\n<p>It is useful to compare the types of <code>fmap</code>, <code>(&lt;*&gt;)</code> and <code>(&gt;&gt;=)</code>:</p>\n\n<pre><code>(&lt;$&gt;) :: Functor f     =&gt;   (a -&gt;   b) -&gt; (f a -&gt; f b) -- (&lt;$&gt;) = fmap\n(&lt;*&gt;) :: Applicative f =&gt; f (a -&gt;   b) -&gt; (f a -&gt; f b)\n(=&lt;&lt;) :: Monad f       =&gt;   (a -&gt; f b) -&gt; (f a -&gt; f b) -- (=&lt;&lt;) = filp (&gt;&gt;=)\n</code></pre>\n\n<p>The <code>a -&gt; b</code> function passed to <code>fmap</code> has no information about <code>f</code>, the involved <code>Functor</code>, and so <code>fmap</code> cannot change the effects at all. <code>(&lt;*&gt;)</code> can change the effects, but only by combining the effects of its two arguments -- the <code>a -&gt; b</code> functions that might be found in the <code>f (a -&gt; b)</code> argument have no bearing on that whatsoever. With <code>(&gt;&gt;=)</code>, though, the <code>a -&gt; f b</code> function is used precisely to generate effects from values found in the <code>f a</code> argument.</p>\n\n<p>I suggest <a href=\"https://stackoverflow.com/q/23342184/2751851\"><em>Difference between Monad and Applicative in Haskell</em></a> as further reading on what you gain (and lose) when moving between <code>Functor</code>, <code>Applicative</code> and <code>Monad</code>.</p>\n"}], "owner": {"reputation": 297, "user_id": 2935375, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CYLMN.jpg?s=128&g=1", "display_name": "Shaurya Gupta", "link": "https://stackoverflow.com/users/2935375/shaurya-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 49309496, "answer_count": 2, "score": 4, "last_activity_date": 1521156018, "creation_date": 1521122947, "last_edit_date": 1521135423, "question_id": 49301663, "link": "https://stackoverflow.com/questions/49301663/why-cant-i-implement-these-functions-with-a-functor-applicative-constraint-only", "title": "Why can&#39;t I implement these functions with a Functor/Applicative constraint only?", "body": "<p>Consider the following functions, taken from <a href=\"http://www.seas.upenn.edu/~cis194/fall16/sols/08-functor-applicative.hs\" rel=\"nofollow noreferrer\">the answers</a> to this <a href=\"http://www.seas.upenn.edu/~cis194/fall16/hw/08-functor-applicative.html\" rel=\"nofollow noreferrer\">problem set</a>:</p>\n\n<pre><code>func6 :: Monad f =&gt; f Integer -&gt; f (Integer,Integer)\nfunc6 xs = do\n    x &lt;- xs\n    return $ if x &gt; 0 then (x, 0)\n                      else (0, x)\n\nfunc6' :: Functor f =&gt; f Integer -&gt; f (Integer,Integer)\n-- slightly unorthodox idiom, with an partially applied fmap\nfunc6' = fmap $ \\x -&gt; if x &gt; 0 then (x,0) else (0,x)\n\n-- func7 cannot be implemented without Monad if we care about the precise\n-- evaluation and layzness behaviour:\n-- &gt; isJust (func7 (Just undefined))\n-- *** Exception: Prelude.undefined\n--\n-- If we care not, then it is equivalent to func6, and there we can. Note that\n-- &gt; isJust (func6 (Just undefined))\n-- True    \nfunc7 :: Monad f =&gt; f Integer -&gt; f (Integer,Integer)\nfunc7 xs = do\n    x &lt;- xs\n    if x &gt; 0 then return (x, 0)\n             else return (0, x)\n\n-- func9 cannot be implemented without Monad: The structure of the computation\n-- depends on the result of the first argument.\nfunc9 :: Monad f =&gt; f Integer -&gt; f Integer -&gt; f Integer -&gt; f Integer\nfunc9 xs ys zs = xs &gt;&gt;= \\x -&gt; if even x then ys else zs\n</code></pre>\n\n<p>Although I understand the counterexample for <code>func7</code>, I don't understand the given reasoning for why we can implement <code>func7</code> and <code>func9</code> using monads only. How do monad/applicative/functor laws fit with the above reasoning?</p>\n"}, {"tags": ["haskell", "hlint"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1521117886, "post_id": 49299721, "comment_id": 85601282, "body": "More readability I guess: if you know what <code>uncurry</code> does, there is less that people have to think about what is going on. I also think that <code>hlint</code> suggests <code>map (uncurry (flatTorus n)) gridUV</code> (with an extra pair of brackets)."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1521117970, "post_id": 49299721, "comment_id": 85601329, "body": "Yes sorry, I forgot the brackets. I edit."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 5, "creation_date": 1521119061, "post_id": 49299721, "comment_id": 85602043, "body": "I think <code>hlint</code> suggestions are guided by both shortness and readability. Some of them probably would find a strong agreement in the community. Others, like this one, not so much. Personally, I find the second code not much better than the first one; I&#39;d say they are nearly equivalent. Maybe <code>hlint</code> should also provide a weight to its suggestions."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1521119451, "post_id": 49299721, "comment_id": 85602315, "body": "Yes. One suggestion I really don&#39;t like is use <code>head x</code> instead of <code>x!!0</code>. I have not been able to disable this suggestion in VScode."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1521119648, "post_id": 49299721, "comment_id": 85602435, "body": "@St&#233;phaneLaurent: well using <code>x!!0</code> and <code>head x</code> are both not very elegant. You better use pattern matching for that, since it is not guaranteed that a list has an element. In fact <code>head</code>, <code>tail</code>, <code>(!!)</code>, and <code>length</code> are functions that should be avoided."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1521119836, "post_id": 49299721, "comment_id": 85602583, "body": "@WillemVanOnsem Yes but for example sometimes I do <code>Vertex3 (x!!0) (x!!1) (x!!2)</code>. It would be silly to use <code>head x</code> here."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 6, "creation_date": 1521120056, "post_id": 49299721, "comment_id": 85602752, "body": "@St&#233;phaneLaurent I would write <code>let [a,b,c] = x in Vertex3 a b c</code>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 5, "creation_date": 1521120393, "post_id": 49299721, "comment_id": 85603017, "body": "@Li-yaoXia: well I think you have to keep a (possibly empty tail). But you can it like:  <code>f (x0:x1:x2:_) = Vertex x0 x1 x2; f _ = &lt;something else&gt;</code>"}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1521124489, "post_id": 49299721, "comment_id": 85606182, "body": "Why not write <code>[ flatTorus n u v | (u, v) &lt;- gridUV ]</code>?"}, {"owner": {"reputation": 8563, "user_id": 160673, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/7BSPT.jpg?s=128&g=1", "display_name": "Neil Mitchell", "link": "https://stackoverflow.com/users/160673/neil-mitchell"}, "edited": false, "score": 0, "creation_date": 1521913687, "post_id": 49299721, "comment_id": 85938217, "body": "<code>hlint</code> does provide weights to its suggestions - this one is merely a suggestion rather than a warning. I regularly trim old suggestions based on feedback to try and follow the preferences of the community."}, {"owner": {"reputation": 8563, "user_id": 160673, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/7BSPT.jpg?s=128&g=1", "display_name": "Neil Mitchell", "link": "https://stackoverflow.com/users/160673/neil-mitchell"}, "edited": false, "score": 0, "creation_date": 1521913741, "post_id": 49299721, "comment_id": 85938246, "body": "@St&#233;phaneLaurent you can disable extensions with a <code>.hlint.yaml</code> in the root directory. See <a href=\"https://github.com/ndmitchell/hlint/blob/master/.hlint.yaml#L59\" rel=\"nofollow noreferrer\">github.com/ndmitchell/hlint/blob/master/.hlint.yaml#L59</a>"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 8563, "user_id": 160673, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/7BSPT.jpg?s=128&g=1", "display_name": "Neil Mitchell", "link": "https://stackoverflow.com/users/160673/neil-mitchell"}, "edited": false, "score": 0, "creation_date": 1521914395, "post_id": 49299721, "comment_id": 85938514, "body": "@NeilMitchell Thanks! I will check that. Previously I used Atom and I was able to configure. But my Atom does not work anymore :-("}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 8563, "user_id": 160673, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/7BSPT.jpg?s=128&g=1", "display_name": "Neil Mitchell", "link": "https://stackoverflow.com/users/160673/neil-mitchell"}, "edited": false, "score": 0, "creation_date": 1521915158, "post_id": 49299721, "comment_id": 85938775, "body": "@NeilMitchell <code>- ignore: {name: Use head, within: HLint}</code> does not work. I put <code>.hlint.yaml</code> in the root directory of my stack project. Is it the right place to put it?"}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "reply_to_user": {"reputation": 8563, "user_id": 160673, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/7BSPT.jpg?s=128&g=1", "display_name": "Neil Mitchell", "link": "https://stackoverflow.com/users/160673/neil-mitchell"}, "edited": false, "score": 1, "creation_date": 1521915537, "post_id": 49299721, "comment_id": 85938931, "body": "@NeilMitchell Ah ok, it works like this: <code>- ignore: {name: Use head}</code>. Fantastic!"}], "answers": [{"tags": [], "owner": {"reputation": 831, "user_id": 3371760, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/09370cd5d499c9f0f75b54aa1b4daa17?s=128&d=identicon&r=PG", "display_name": "Fried Brice", "link": "https://stackoverflow.com/users/3371760/fried-brice"}, "is_accepted": false, "score": 2, "last_activity_date": 1521182127, "creation_date": 1521182127, "answer_id": 49314565, "question_id": 49299721, "link": "https://stackoverflow.com/questions/49299721/hlint-suggestion-use-uncurry/49314565#49314565", "title": "Hlint suggestion: use uncurry", "body": "<p>I think Hlint prefers using <code>uncurry</code> because it gives you an invariant representation of the callback. Lambda expressions are inherently sensitive to representation, since</p>\n\n<pre><code>\\(u, v) -&gt; flatTorus n u v\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>\\(x, y) -&gt; flatTorus n x y\n</code></pre>\n\n<p>even though they are textually different.</p>\n\n<p>Using <code>uncurry</code> frees readers of the cognitive load of doing alpha equivalence in their head (e.g., recognizing that the above two expressions are the same), but then saddles them with the cognitive load of having to remember a vocabulary of combinators. Ultimately, it's a matter of taste.</p>\n"}, {"comments": [{"owner": {"reputation": 8563, "user_id": 160673, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/7BSPT.jpg?s=128&g=1", "display_name": "Neil Mitchell", "link": "https://stackoverflow.com/users/160673/neil-mitchell"}, "edited": false, "score": 1, "creation_date": 1521913793, "post_id": 49315597, "comment_id": 85938266, "body": "The output from HLint actually includes &quot;Note: increases laziness&quot; in the above example."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1521186799, "creation_date": 1521186799, "answer_id": 49315597, "question_id": 49299721, "link": "https://stackoverflow.com/questions/49299721/hlint-suggestion-use-uncurry/49315597#49315597", "title": "Hlint suggestion: use uncurry", "body": "<p>These are not actually quite equivalent.</p>\n\n<pre><code>(\\(x, y) -&gt; (,) x y) undefined = undefined\nuncurry (,) undefined = (undefined, undefined)\n</code></pre>\n\n<p>Do you should take any suggestion to use <code>uncurry</code> with a grain of salt. Think about whether that extra laziness will help, hurt, or make no difference.</p>\n"}], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1521186799, "creation_date": 1521117615, "last_edit_date": 1521117992, "question_id": 49299721, "link": "https://stackoverflow.com/questions/49299721/hlint-suggestion-use-uncurry", "title": "Hlint suggestion: use uncurry", "body": "<p>I have this line of code: </p>\n\n<pre><code>map (\\(u,v) -&gt; flatTorus n u v) gridUV\n</code></pre>\n\n<p><code>Hlint</code> suggests me to replace it with </p>\n\n<pre><code>map (uncurry (flatTorus n)) gridUV\n</code></pre>\n\n<p>What is the motivation of this suggestion ? Is it for shortness only, or something else (performance) ? Because though it is longer, I find the first code more easy to read.</p>\n\n<p>In fact my question is more general,, because this is just an example among others: does <code>Hlint</code> suggestions are generally based on a shortness motivation only or are there other improvements behind the suggestions ?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1521117425, "post_id": 49298811, "comment_id": 85600965, "body": "<code>tail</code> is unsafe, but <code>zip xs (tail xs)</code> is safe. If you want it to be even locally safe (no cross-procedural correctness argument needed), you can replace <code>tail</code> with <code>drop 1</code>."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1521117513, "post_id": 49298811, "comment_id": 85601035, "body": "@DanielWagner Indeed it is! I hadn&#39;t even realised that. Thank you for pointing that out :)"}], "tags": [], "owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "is_accepted": false, "score": 4, "last_activity_date": 1521114864, "creation_date": 1521114864, "answer_id": 49298811, "question_id": 49298586, "link": "https://stackoverflow.com/questions/49298586/expanding-a-list-to-a-path/49298811#49298811", "title": "Expanding a list to a path", "body": "<p>You can <code>zip</code> <code>input</code> with its tail in order to get a list of tuples:</p>\n\n<pre><code>Prelude&gt; zip input $ tail input\n[([1,1],[3,3]),([3,3],[5,5]),([5,5],[7,7])]\n</code></pre>\n\n<p>From there, if you need it, you can write a function that makes a list out of each tuple, e.g.</p>\n\n<pre><code>tupleToList :: (t, t) -&gt; [t]\ntupleToList (x, y) = [x, y]\n</code></pre>\n\n<p>This enables you to map over the zipped list:</p>\n\n<pre><code>Prelude&gt; fmap tupleToList $ zip input $ tail input\n[[[1,1],[3,3]],[[3,3],[5,5]],[[5,5],[7,7]]]\n</code></pre>\n\n<p>Be aware that <code>tail</code> is unsafe, in that it throws an exception if the original list is empty.</p>\n"}, {"comments": [{"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1521117901, "post_id": 49298820, "comment_id": 85601286, "body": "I always forget that <code>zip x y</code> does not require <code>length x == length y</code>."}], "tags": [], "owner": {"reputation": 31724, "user_id": 6264, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/bbb17eeeecd3d9d06f4db310ab630a12?s=128&d=identicon&r=PG", "display_name": "Michiel Borkent", "link": "https://stackoverflow.com/users/6264/michiel-borkent"}, "is_accepted": true, "score": 3, "last_activity_date": 1521114889, "creation_date": 1521114889, "answer_id": 49298820, "question_id": 49298586, "link": "https://stackoverflow.com/questions/49298586/expanding-a-list-to-a-path/49298820#49298820", "title": "Expanding a list to a path", "body": "<pre><code>let xs = [[1,1], [3,3], [5,5], [7,7]] in zipWith (\\a b -&gt; [a,b]) xs (tail xs)\n-- [[[1,1],[3,3]],[[3,3],[5,5]],[[5,5],[7,7]]]\n</code></pre>\n"}], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 49298820, "answer_count": 2, "score": 2, "last_activity_date": 1521115483, "creation_date": 1521114256, "last_edit_date": 1521115483, "question_id": 49298586, "link": "https://stackoverflow.com/questions/49298586/expanding-a-list-to-a-path", "title": "Expanding a list to a path", "body": "<p>I have a list like this:</p>\n\n<pre><code> input = [[1,1], [3,3], [5,5], [7,7]]\n</code></pre>\n\n<p>I want this output:</p>\n\n<pre><code>[[[1,1],[3,3]],[[3,3],[5,5]],[[5,5],[7,7]]]\n</code></pre>\n\n<p>(The goal is to have the path made of edges <code>[1,1]-[3,3], [3,3]-[5,5], [5,5]-[7,7]</code>... I would not be surprised that this question is a duplicate by the way.)</p>\n\n<p>I'am able to get this output like this:</p>\n\n<pre><code>&gt; map (\\i -&gt; [input!!i, input!!(i+1)]) [0 .. length input-2]\n[[[1,1],[3,3]],[[3,3],[5,5]],[[5,5],[7,7]]]\n</code></pre>\n\n<p>Do you have a cleaner solution? There's surely something cleaner.</p>\n"}, {"tags": ["string", "haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1521111775, "post_id": 49297746, "comment_id": 85597246, "body": "You only need to <i>escape</i> the quotations, so <code>&quot;The statement \\&quot;&#39;yields falsehood when preceded by its quotation&#39; yields falsehood when preceded by its quotation\\&quot; is false&quot;</code>"}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1521111957, "post_id": 49297746, "comment_id": 85597356, "body": "What is the \\ operator doing in this case?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1521112238, "post_id": 49297746, "comment_id": 85597513, "body": "it is not an operator. I think you interpret strings a bit too much like ordinary Haskell code. This is a string literal. String literals have escaping for some characters that can not be added straight away: like quotation marks, but also new lines, tabs, unicode, etc."}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1521112283, "post_id": 49297746, "comment_id": 85597554, "body": "In any case, I don&#39;t find this very convincing: if we are interested in sentences such as (3) we are interested in them as they are, and thus it would be preferable to present them as they are. Perhaps you could claim (3) IS really to be analysed as <code>&quot;The statement \\&quot;&#39;yields falsehood when preceded by its quotation&#39; yields falsehood when preceded by its quotation\\&quot; is false&quot;</code>. But I&#39;m not so sure about this. I have edited my question to take into account my worry here."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1521112662, "post_id": 49297746, "comment_id": 85597814, "body": "no, since that would make it hard or perhaps even impossible to write a unambiguous lexer and parser, and even if we can, then it could result in a computationally very expensive compiler: it could mean that we would have to backtrack over all possible interpretations. Furthermore a good programming language denotes things that are different in a different way. Now the quotation marks (<code>&quot;</code>) are <i>not</i> part of the string. Escaped ones on the other hand are. So for a programmer it is clear where the string starts and where it ends. Most people get used to escaping quite fast."}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1521112778, "post_id": 49297746, "comment_id": 85597887, "body": "Thanks. :) Do you mean it would be strictly speaking impossible, or just a pain in the neck? Mathematically, there are many examples of languages which allow self reference and quotation within quotation, so I can&#39;t see it should be impossible. Perhaps if implemented on a small scale it wouldn&#39;t be such a pain. Interested to know what you think."}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1521112986, "post_id": 49297746, "comment_id": 85598040, "body": "We couldn&#39;t, for example have an operator which applies to the result of <code>putStrLn (show &quot;I said \\&quot;hello\\&quot;.&quot;)</code>, taking out the two occurrences of \\ ?"}, {"owner": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "edited": false, "score": 0, "creation_date": 1521113244, "post_id": 49297746, "comment_id": 85598222, "body": "Probably you are looking for <a href=\"https://en.wikipedia.org/wiki/String_literal#Raw_strings\" rel=\"nofollow noreferrer\">raw string literals</a>. They do not exist in Haskell"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1521113407, "post_id": 49297746, "comment_id": 85598322, "body": "@user65526: you are probably confusing <i>strings</i> at the <i>representation</i> of strings. In fact if we write <code>&quot;foo \\&quot;bar\\&quot; qux&quot;</code>. We wrote a string that <i>contains</i> no backslashes, it does not contain the outer quotes. If you print that string, you get <code>foo &quot;bar&quot; qux</code>. The point is that the <i>representation</i> of a string literal is something different then what the string contains."}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1521113600, "post_id": 49297746, "comment_id": 85598473, "body": "Hang on a second. Couldn&#39;t you just declare/create a new type, which is the type of <code>&quot;The statement &quot;&#39;yields falsehood when preceded by its quotation&#39; yields falsehood when preceded by its quotation&quot; is false&quot;)</code> and more generally the type of any quotation that includes a quotation? Would that be literally impossible? Btw, when I print <code>&quot;foo \\&quot;bar\\&quot; qux&quot;</code> (that is, when I put in <code>print &quot;foo \\&quot;bar\\&quot; qux&quot;</code>), I get <code>&quot;foo \\&quot;bar\\&quot; qux&quot;</code>"}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1521113734, "post_id": 49297746, "comment_id": 85598562, "body": "The bottom line is this: I want to be able to have <code>&quot;The statement &quot;&#39;yields falsehood when preceded by its quotation&#39; yields falsehood when preceded by its quotation&quot; is false&quot;</code>, exactly as you would see it in a book. It&#39;s still unclear to me whether this is strictly impossible, or just a real pain to implement."}, {"owner": {"reputation": 43029, "user_id": 7505395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4t4nq.jpg?s=128&g=1", "display_name": "Patrick Artner", "link": "https://stackoverflow.com/users/7505395/patrick-artner"}, "edited": false, "score": 3, "creation_date": 1521114829, "post_id": 49297746, "comment_id": 85599231, "body": "@user65526   <a href=\"https://stackoverflow.com/questions/19288652/difference-between-print-and-putstrln-in-haskell\" title=\"difference between print and putstrln in haskell\">stackoverflow.com/questions/19288652/&hellip;</a>   - dont use print for strings :) then you dont get leading/trailing &quot;"}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1521115164, "post_id": 49297746, "comment_id": 85599441, "body": "When I don&#39;t use <code>print</code> (i.e, when I just put in <code>&quot;foo \\&quot;bar\\&quot; qux&quot;</code> to GHCi, I still get <code>&quot;foo \\&quot;bar\\&quot; qux&quot;</code> and not, as was suggested above <code>foo &quot;bar&quot; qux</code>. In any case, this does not answer my question."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 2, "creation_date": 1521116642, "post_id": 49297746, "comment_id": 85600391, "body": "@user65526 Try <code>putStrLn &quot;foo \\&quot;bar\\&quot; qux&quot;</code>; that renders to the terminal the characters actually contained in the string. Just typing <code>&quot;foo \\&quot;bar\\&quot; qux&quot;</code> at the GHCI prompt uses <code>show</code> to render it, which is for showing you the representation of the string as Haskell syntax (so it has to use backslashes to escape the quotes). <code>print</code> also uses <code>show</code> internally."}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1521116729, "post_id": 49297746, "comment_id": 85600450, "body": "That works, thanks.Ah, and I see it solves my problem. So the solution is to use escape brackets as suggested, and put <code>putStrLn </code> before the result. Due to being a Haskell novice, I didn&#39;t realise that this is what was being suggested above. Thanks for all the help :)"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1521117380, "post_id": 49297746, "comment_id": 85600923, "body": "The title is overly ambitious. I suggest &quot;representing strings with embedded quotes in Haskell&quot;."}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1521117456, "post_id": 49297746, "comment_id": 85600986, "body": "Thanks, I&#39;ll change it :). Feel really sad that it was downvoted: I&#39;d like to know why (I don&#39;t know whether that is possible). I just didn&#39;t understand and needed help :)"}, {"owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "edited": false, "score": 0, "creation_date": 1521124108, "post_id": 49297746, "comment_id": 85605927, "body": "Is it possible to be supplied with a reason why my question was downvoted, and whether the question, as it currently stands, is worthy of a downvote?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1521185660, "post_id": 49297746, "comment_id": 85631983, "body": "Though I didn&#39;t downvote, my guess would be that the downvoters felt that you should have found the answer by searching. A search for <code>quote in string haskell</code> brings quite a few relevant results, though few of the questions found in this way state the problem directly like yours does (most are some variation of &quot;<code>show</code> for strings is broken, what to do?&quot;). By the way, while downvotes can be useful food for thought, don&#39;t let them discourage you -- after all, sometimes it&#39;s just that <a href=\"https://meta.stackexchange.com/a/215397/242059\">someone has lost their keys</a> :)"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1521185771, "post_id": 49297746, "comment_id": 85632030, "body": "(Ironically, I have just violated the Manual of Style by using code formatting for a quote, as if I had written <code>&quot;quote in string haskell&quot;</code> instead it wouldn&#39;t be entirely clear whether the quotes should be included in the search engine input or not...)"}], "answers": [{"tags": [], "owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "is_accepted": false, "score": 1, "last_activity_date": 1521117393, "creation_date": 1521117393, "answer_id": 49299662, "question_id": 49297746, "link": "https://stackoverflow.com/questions/49297746/representing-strings-with-embedded-quotes-in-haskell/49299662#49299662", "title": "Representing strings with embedded quotes in Haskell", "body": "<p>As had been initially hinted in a comment below the question, but which was not clear to me at the time (although it may have been utterly obvious to others), there is a simple way of representing (1)-(3) above using \\ and <code>putStrLn</code>. We just have to use the following code:</p>\n\n<pre><code>putStrLn \"This sentence is not a \\\"sentence\\\" \"\nThis sentence is not a \"sentence\" \n\nputStrLn \"\\\"S\\\" is true in language L iff S\"\n\"S\" is true in language L iff S\n\nputStrLn \"The statement \\\"'yields falsehood when preceded by its quotation' \nyields falsehood when preceded by its quotation\\\" is false\"\nThe statement \"'yields falsehood when preceded by its quotation' yields \nfalsehood when preceded by its quotation\" is false\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 3, "last_activity_date": 1521192532, "last_edit_date": 1521192532, "creation_date": 1521191434, "answer_id": 49316859, "question_id": 49297746, "link": "https://stackoverflow.com/questions/49297746/representing-strings-with-embedded-quotes-in-haskell/49316859#49316859", "title": "Representing strings with embedded quotes in Haskell", "body": "<p>This answer will mostly repeat what is said in the comments (and in your own answer), but with some elaboration that might be useful.</p>\n\n<p>In what follows, I will abuse keyboard input formatting, as in <kbd>case</kbd>, when I want to talk about a string as it really is. You may take \"as it really is\" to mean a certain sequence of bytes in memory or something more Platonic -- feel free to pick your favourite ontology. What matters is that, if I want to refer to <kbd>case</kbd> in a Haskell program, I need some way to specify I'm really talking about a string, as Haskell source code is literally a string of characters which is interpreted in a certain manner -- and, in particular, in that interpretation <code>case</code> would be taken as a keyword introducing a case-statement. The solution adopted by Haskell syntax is using double quotes to introduce string literals, so that <code>\"case\"</code> represents <kbd>case</kbd>.</p>\n\n<p>That's all well and good, but what about <kbd>This sentence is not a \"sentence\"</kbd>? The problem is that Haskell syntax confiscates, among others, the character <kbd>\"</kbd>, giving it special meaning, which means <code>\"This sentence is not a \"sentence\"\"</code> doesn't actually represent <kbd>This sentence is not a \"sentence\"</kbd> (rather, it represents <kbd>This sentence is not a </kbd> applied, like a function, to a variable called <code>sentence</code> and the empty string -- which is approximately always nonsense). The solution to this problem is confiscating <kbd>\\</kbd> in order to use it as an <em>escape character</em> which, when used within a string literal, indicates the following character should be taken literally, and not according to its usual role in Haskell syntax (that is not the only way <kbd>\\</kbd> is used as an escape character, but let's not get bogged down in detail). That being so, <kbd>This sentence is not a \"sentence\"</kbd> is represented by <code>\"This sentence is not a \\\"sentence\\\"\"</code>, and all is well in the World.</p>\n\n<p>All of the above probably is, after the long discussion in the comments, very obvious. There are a few interesting things to add, though, about <code>putStrLn</code>, <code>show</code> and <code>print</code>. Starting with <code>putStrLn</code>, its role can be abstractly described as <em>drawing in your screen</em> something that looks sufficiently like how you would represent a string if you weren't concerned about the mundane constraints of Haskell syntax. There is no fundamental difference between <code>putStrLn</code> and an hypothetical <code>cartoonifyStrLn</code>, which would draw a pink Comic Sans string all over your desktop, or even a <code>seeStrLn</code>, which would plant a visual impression of the string directly in your retina. The point is that <code>putStrLn \"This sentence is not a \\\"sentence\\\"\"</code> represents <kbd>This sentence is not a \"sentence\"</kbd> in a way that is <em>completely external to Haskell</em>. This fact is, fortunately enough, expressed by the type system:</p>\n\n<pre><code>GHCi&gt; -- Actually a string.\nGHCi&gt; :t \"This sentence is not a \\\"sentence\\\"\"\n\"This sentence is not a \\\"sentence\\\"\" :: [Char]\nGHCi&gt; -- Note how there won't be any mention of String (or [Char]).\nGHCi&gt; :t putStrLn \"This sentence is not a \\\"sentence\\\"\"\nputStrLn \"This sentence is not a \\\"sentence\\\"\" :: IO ()\n</code></pre>\n\n<p>Values with <code>IO</code> in their types stand in for things that are, in part or wholly, external to Haskell. <code>IO</code> makes it possible to refer to and make use of such things without losing track of this crucial fact about them.</p>\n\n<p>The <code>show</code> function produces string -- or, more precisely, <code>String</code> -- representations of Haskell values</p>\n\n<pre><code>GHCi&gt; show 99\n\"99\"\nGHCi&gt; show (Just 99)\n\"Just 99\"\n</code></pre>\n\n<p>That however, is an incomplete description  of what <code>show</code> does. The <code>String</code> it produces is supposed to represent, as a string literal, a valid representation of the value it is given according to Haskell syntax. That is why <code>show</code>ing a <code>String</code> produces a string with extra quotes tacked on...</p>\n\n<pre><code>GHCi&gt; show \"case\"\n\"\\\"case\\\"\"\n</code></pre>\n\n<p>... not to mention all the extra backslashes:</p>\n\n<pre><code>GHCi&gt; show \"This sentence is not a \\\"sentence\\\"\"\n\"\\\"This sentence is not a \\\\\\\"sentence\\\\\\\"\\\"\"\n</code></pre>\n\n<p>As for <code>print</code>, it is just <code>show</code> followed by <code>putStrLn</code>, so it tends to do what you expect for most types...</p>\n\n<pre><code>GHCi&gt; print 99\n99\nGHCi&gt; print (Just 99)\nJust 99\n</code></pre>\n\n<p>... but not for <code>String</code>s -- in their case, you should just use <code>putStrLn</code> instead:</p>\n\n<pre><code>GHCi&gt; print \"This sentence is not a \\\"sentence\\\"\"\n\"This sentence is not a \\\"sentence\\\"\"\n</code></pre>\n\n<p>P.S.: Possibly interesting extra reading about technicalities: <a href=\"https://stackoverflow.com/q/24953125/2751851\"><em>How to convert Unicode Escape Sequence to Unicode String in Haskell</em></a> and <a href=\"https://stackoverflow.com/q/48846437/2751851\"><em>Semantics of show w.r.t. escape characters</em></a>.</p>\n\n<p>P.P.S.: I welcome criticism of my usage of quotation in this answer.</p>\n"}], "owner": {"reputation": 565, "user_id": 9485986, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/d8c32271af227c9b61727271791a17de?s=128&d=identicon&r=PG", "display_name": "user65526", "link": "https://stackoverflow.com/users/9485986/user65526"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1328, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1521192532, "creation_date": 1521111655, "last_edit_date": 1521192406, "question_id": 49297746, "link": "https://stackoverflow.com/questions/49297746/representing-strings-with-embedded-quotes-in-haskell", "title": "Representing strings with embedded quotes in Haskell", "body": "<p>In natural language it is quite common to have quotation marks within quotation marks, as in, for example:</p>\n\n<p>(1) \"This sentence is not a \"sentence\" \"</p>\n\n<p>(2) \"\u2018S\u2019 is true in language L iff S\"</p>\n\n<p>(2) is in fact important for any Tarskian truth-definition (Tarski argued the truth of every instance of (2) was necessary for the material adequacy of a truth definition). </p>\n\n<p>Other examples arise in the study of paradoxes; famously, in <a href=\"https://en.wikipedia.org/wiki/Quine%27s_paradox\" rel=\"nofollow noreferrer\">Quine's paradox</a> we are led to consider (3):</p>\n\n<p>(3) \"The statement \"'yields falsehood when preceded by its quotation' yields falsehood when preceded by its quotation\" is false\"</p>\n\n<p>I am interested in how quotations within quotations can be implemented in Haskell. What I want to know is how, in Haskell, with appropriate technical trickery, we can represent (1)-(3) as they are written above and as they would appear in a book (i.e, not modified orthographically in any way), without receiving an error message. </p>\n\n<p>A simple type search for (3), <code>:t (\"The statement \"'yields falsehood when preceded by its quotation' yields falsehood when preceded by its quotation\" is false\")</code> yields (no pun intended!) </p>\n\n<pre><code>&lt;interactive&gt;:1:18: error:\n\u2022 Syntax error on 'yields\n  Perhaps you intended to use TemplateHaskell or TemplateHaskellQuotes\n\u2022 In the Template Haskell quotation 'yields\n</code></pre>\n"}, {"tags": ["haskell", "encryption", "cryptography"], "comments": [{"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 1, "creation_date": 1521109830, "post_id": 49296968, "comment_id": 85595932, "body": "Take a look at <code>nullIV</code> and <code>ivAdd</code> from <a href=\"https://hackage.haskell.org/package/cryptocipher-0.6.2/docs/Crypto-Cipher.html#g:3\" rel=\"nofollow noreferrer\">here</a> - it looks like you could just do something like <code>ivAdd ivNull x</code>, although whether that&#39;d have the effect you&#39;re after I don&#39;t know."}], "answers": [{"comments": [{"owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "edited": false, "score": 0, "creation_date": 1521139124, "post_id": 49306355, "comment_id": 85615977, "body": "Except the OP should be aware that using a non random IV is a security flaw and whatever reason they have to build it from integers is definitely not a good enough reason."}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "reply_to_user": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "edited": false, "score": 1, "creation_date": 1521475750, "post_id": 49306355, "comment_id": 85735696, "body": "@LukeJoshuaPark That&#39;s only true for CBC mode (and a few obscure related ones), not for most other cipher modes (you can also mess up CTR counter mode construction, of course)."}, {"owner": {"reputation": 79299, "user_id": 589259, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/vJbKg.jpg?s=128&g=1", "display_name": "Maarten Bodewes", "link": "https://stackoverflow.com/users/589259/maarten-bodewes"}, "edited": false, "score": 0, "creation_date": 1521477337, "post_id": 49306355, "comment_id": 85736799, "body": "Thomas, could you indicate the counter block that is generated with your code? It seems that the library requires the full 16 bytes as IV..."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1521479677, "post_id": 49306355, "comment_id": 85738333, "body": "I&#39;m not quite clear on what you&#39;re asking but I did clumsily not cast my input integer as I should have - see the <code>fromIntegral</code> edit.  Once I get a moment I&#39;ll edit with a full (runnable) example."}, {"owner": {"reputation": 489, "user_id": 4445913, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/943fb55bd9a761c56c17d124d1cc3c61?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Uligade", "link": "https://stackoverflow.com/users/4445913/mahesh-uligade"}, "edited": false, "score": 0, "creation_date": 1521532188, "post_id": 49306355, "comment_id": 85758224, "body": "is it fine to use predictable (increment by 1 each time) IV in AES256 CTR mode?, If we use random how can we guarantee that will be not repeat after certain messages?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 489, "user_id": 4445913, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/943fb55bd9a761c56c17d124d1cc3c61?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Uligade", "link": "https://stackoverflow.com/users/4445913/mahesh-uligade"}, "edited": false, "score": 1, "creation_date": 1521821844, "post_id": 49306355, "comment_id": 85911173, "body": "@MaheshUligade No it is not fine.  If you are developing for a production system I strongly suggest you find a crypto engineer.  In short, AES256 CTR will internally use all IVs from the one provided upwards as needed (so, up to iv + plaintext / blockSize).  You&#39;d need to increment your IV by at least that much to maintain confidentiality."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 489, "user_id": 4445913, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/943fb55bd9a761c56c17d124d1cc3c61?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Uligade", "link": "https://stackoverflow.com/users/4445913/mahesh-uligade"}, "edited": false, "score": 0, "creation_date": 1521821990, "post_id": 49306355, "comment_id": 85911253, "body": "@MaheshUligade If you use random IVs there is never a guarantee no IV will repeat.  You can model the issue as a statistical &quot;balls and bins&quot; problem to determine the probability.  I suggest you put conservative limits on how much data and how many encryptions are allowed to occur any time you use random IVs.  I believe IETF RFCs on IPSec have useful/reasonable limits if you are looking for motivation."}, {"owner": {"reputation": 489, "user_id": 4445913, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/943fb55bd9a761c56c17d124d1cc3c61?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Uligade", "link": "https://stackoverflow.com/users/4445913/mahesh-uligade"}, "edited": false, "score": 0, "creation_date": 1521823414, "post_id": 49306355, "comment_id": 85912080, "body": "@ThomasM.DuBuisson  How much should be the min size of random IV, so it won&#39;t repeat soon"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1521825020, "post_id": 49306355, "comment_id": 85912932, "body": "You don&#39;t get to choose the size of the IV - that is dictated by the cipher and the mode."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 1, "last_activity_date": 1521482618, "last_edit_date": 1521482618, "creation_date": 1521137025, "answer_id": 49306355, "question_id": 49296968, "link": "https://stackoverflow.com/questions/49296968/integer-to-iv-type-conversion/49306355#49306355", "title": "Integer to IV type conversion", "body": "<p><code>makeIV</code> doesn't generate a random IV as you implied. It is exactly the function you want. Just serialize your integer to a bytestring of sufficient length then call makeIV on that bytestring:</p>\n\n<pre><code>makeIV $ runPut (putWord64be (fromIntegral i) &gt;&gt;putWord64be (fromIntegral (i `shiftR` 64)))\n</code></pre>\n\n<p>where the put operations are from the <code>cereal</code> package.  You could use <code>binary</code> instead of <code>cereal</code> but then you'd have to make sure you get a strict bytestring.</p>\n\n<p>EDIT: A more complete example:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.Binary.Put\nimport Crypto.Cipher.Types\nimport Crypto.Cipher.AES (AES256)\nimport Data.ByteArray (unpack)\nimport qualified Data.ByteString.Lazy as LBS\nimport Data.Bits (shiftR)\n\nexample :: Integer -&gt; IV AES256\nexample i =\n  maybe (error \"foo\") id $\n  -- ^^ makeIV returns a `Maybe` (Nothing for IVs of incorrect size\n  makeIV $ LBS.toStrict $\n  --      ^^ makeIV requires strict bytestrings\n     runPut (putWord64be (fromIntegral i) &gt;&gt;\n             putWord64be (fromIntegral (i `shiftR` 64)))\n  -- ^^ Construct your IV bytestring however you'd like\n\nmain = do print $ unpack (example 0)\n          print $ unpack (example 1)\n          print $ unpack (example (2^63))\n          print $ unpack (example (2^65))\n          print $ unpack (example (2^112))\n          print $ unpack (example (2^120))\n</code></pre>\n\n<p>Notice that this DOES NOT use crypto-cipher-types since that is sort of parallel to and separate from cryptonite.  You should use the IV type from cryptonite instead (see Cryptonite's <code>Crypto.Cipher.Types</code> modules).</p>\n"}], "owner": {"reputation": 489, "user_id": 4445913, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/943fb55bd9a761c56c17d124d1cc3c61?s=128&d=identicon&r=PG&f=1", "display_name": "Mahesh Uligade", "link": "https://stackoverflow.com/users/4445913/mahesh-uligade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537633285, "creation_date": 1521109467, "last_edit_date": 1537633285, "question_id": 49296968, "link": "https://stackoverflow.com/questions/49296968/integer-to-iv-type-conversion", "title": "Integer to IV type conversion", "body": "<p>I am using AES256 from <a href=\"https://hackage.haskell.org/package/cryptonite-0.25/docs/src/Crypto-Cipher-AES.html\" rel=\"nofollow noreferrer\">this</a> library and types from <a href=\"https://hackage.haskell.org/package/crypto-cipher-types-0.0.9/docs/src/Crypto-Cipher-Types.html\" rel=\"nofollow noreferrer\">this</a> library. here <code>ctrCombine</code> function takes <code>IV</code> (Initialisation Vector) in <code>IV cipher</code> type. </p>\n\n<p>Instead of generating random <code>IV</code> from <code>makeIV</code> function, I want to generate it from some Integers that I already have. </p>\n\n<ol>\n<li><p>Is it possible to convert any Integer to  'IV cipher' type?</p></li>\n<li><p>If it is possible how can I do it?</p></li>\n</ol>\n"}]