[{"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447891971, "post_id": 33792847, "comment_id": 55352810, "body": "Try Hoogling for the type of the function you want: <a href=\"https://www.haskell.org/hoogle/?hoogle=a+-%3E+%5B%28a%2C+b%29%5D+-%3E+b\" rel=\"nofollow noreferrer\"><code>a -&gt; [(a, b)] -&gt; b</code></a>. Even when you get the type wrong (as I did here) you get useful results. (I also tried searching for the monomorphic type <code>Int -&gt; [(Int, Char)] -&gt; Char</code> and still got the useful answer at the top. So this search, at least, is very forgiving.)"}], "answers": [{"tags": [], "owner": {"reputation": 176, "user_id": 5578949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6a975cfad7f312d43857b42ccbe4e7f?s=128&d=identicon&r=PG", "display_name": "aghitza", "link": "https://stackoverflow.com/users/5578949/aghitza"}, "is_accepted": false, "score": 1, "last_activity_date": 1447898101, "creation_date": 1447898101, "answer_id": 33793919, "question_id": 33792847, "link": "https://stackoverflow.com/questions/33792847/comparing-indexes-of-a-list-of-tuples-to-a-list-of-integers/33793919#33793919", "title": "Comparing indexes of a list of tuples to a list of integers", "body": "<p>Here is a possible definition, using a list comprehension:</p>\n\n<pre><code>f :: [Int] -&gt; [(Int,Char)] -&gt; String\nf is ts = [c | (i,c) &lt;- ts, i `elem` is]\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>f [1,3,5] listOfCharTuples\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12267, "user_id": 1672128, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af16e4ed7ae250d86a69218fdb2176a3?s=128&d=identicon&r=PG", "display_name": "YS-L", "link": "https://stackoverflow.com/users/1672128/ys-l"}, "is_accepted": false, "score": 0, "last_activity_date": 1447911793, "creation_date": 1447911793, "answer_id": 33796109, "question_id": 33792847, "link": "https://stackoverflow.com/questions/33792847/comparing-indexes-of-a-list-of-tuples-to-a-list-of-integers/33796109#33796109", "title": "Comparing indexes of a list of tuples to a list of integers", "body": "<p>As hinted in the comment, a possible solution that is more general (does not require orderedness of the input) can make use of the <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#v:lookup\" rel=\"nofollow\"><code>lookup</code></a> function:</p>\n\n<pre><code>import Data.Maybe (fromMaybe)\n\nlookupAll :: [(Int,Char)] -&gt; [Int] -&gt; String\nlookupAll tuples = map (\\x -&gt; fromMaybe '?' $ lookup x tuples)\n</code></pre>\n\n<p>Examples:</p>\n\n<pre><code>putStrLn $ lookupAll listOfCharTuples [1,3,5] -- Hse\nputStrLn $ lookupAll listOfCharTuples [5,3,1] -- esH\n</code></pre>\n"}], "owner": {"reputation": 91, "user_id": 4386925, "user_type": "registered", "accept_rate": 54, "profile_image": "https://graph.facebook.com/100001597118230/picture?type=large", "display_name": "Meeran", "link": "https://stackoverflow.com/users/4386925/meeran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1447911793, "creation_date": 1447891089, "question_id": 33792847, "link": "https://stackoverflow.com/questions/33792847/comparing-indexes-of-a-list-of-tuples-to-a-list-of-integers", "title": "Comparing indexes of a list of tuples to a list of integers", "body": "<p>I am very new to functional programming and haskell.</p>\n\n<p>Basically, I have formed a list of tuples where they are ordered and indexed, like so</p>\n\n<pre><code>listOfCharTuples = [(1,H),(2,a),(3,s),(4,k),(5,e),(6,l),(7,l)\n</code></pre>\n\n<p>and as an input I will be given a list of ordered integers that will be at maximum, the number of tuples in this list.</p>\n\n<p>I want a way to make a function that prints out the respective characters given the input of the list of integers, so if the list given was, for example [1,3,5], I would want the function to print \"Hse\".</p>\n\n<p>I may be given any list of input characters, the only progress I've made so far is to make them into a list of indexed tuples, and I am really struggling to solve this</p>\n"}, {"tags": ["haskell", "bytestring"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 3, "creation_date": 1447885713, "post_id": 33791634, "comment_id": 55350442, "body": "Depends on what your end goal is. If you really want to read a file in, modify one byte, and write it out again, this approach seems reasonable. If what you&#39;re actually trying to do is modify every single byte, but one byte at a time, you probably want <code>map</code>. Can you explain a bit more about what you&#39;re ultimately after?"}, {"owner": {"reputation": 427, "user_id": 4585063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10205618035027960/picture?type=large", "display_name": "Daniel Lovasko", "link": "https://stackoverflow.com/users/4585063/daniel-lovasko"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1447888577, "post_id": 33791634, "comment_id": 55351602, "body": "@MathematicalOrchid I get your point. I am trying to build a <i>very</i> small virtual machine and I am using <code>ByteString</code> as the backing memory storage. The size in question is in order of tens of bytes. An instruction comes in and executing it modifies a specific memory byte, e.g. <code>mov 4, mem7</code> (and that is where our <code>updateValue</code> function comes in). Therefore, <code>map</code>ping is not an option here. What might be an important addition is that performance is a valid concern in this case."}], "answers": [{"comments": [{"owner": {"reputation": 427, "user_id": 4585063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10205618035027960/picture?type=large", "display_name": "Daniel Lovasko", "link": "https://stackoverflow.com/users/4585063/daniel-lovasko"}, "edited": false, "score": 0, "creation_date": 1447892182, "post_id": 33792170, "comment_id": 55352878, "body": "If I understand it correctly, this uses 4 separate functions, two of which are just the conversion. Do you think that <code>Data.Vector</code> could be a feasible replacement for <code>Data.ByteString</code> in this case? (In order to get rid of the two conversions)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 427, "user_id": 4585063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10205618035027960/picture?type=large", "display_name": "Daniel Lovasko", "link": "https://stackoverflow.com/users/4585063/daniel-lovasko"}, "edited": false, "score": 2, "creation_date": 1447892309, "post_id": 33792170, "comment_id": 55352925, "body": "@DanielLovasko I absolutely think replacing <code>ByteString</code> with a mutable structure is appropriate here. I would go even farther than using <code>Vector</code> to use e.g. <code>STArray</code> and lift your virtual machine stepping operation into <code>ST</code>. Moving from repeated O(n) update to O(1) is a no-brainer when performance matters."}, {"owner": {"reputation": 427, "user_id": 4585063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10205618035027960/picture?type=large", "display_name": "Daniel Lovasko", "link": "https://stackoverflow.com/users/4585063/daniel-lovasko"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447899645, "post_id": 33792170, "comment_id": 55355050, "body": "@DanielWagner I never heard of the <code>ST</code> monad before, but it totally makes sense to use it here. For anyone reading this, I highly recommend the IRC logs in the beginning of <a href=\"https://wiki.haskell.org/Monad/ST\" rel=\"nofollow noreferrer\">this page</a>."}], "tags": [], "owner": {"reputation": 11412, "user_id": 617159, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fc43cf2d76ce0981a21c0e5a817f96f5?s=128&d=identicon&r=PG", "display_name": "Lambda Fairy", "link": "https://stackoverflow.com/users/617159/lambda-fairy"}, "is_accepted": false, "score": 3, "last_activity_date": 1447887718, "creation_date": 1447887718, "answer_id": 33792170, "question_id": 33791634, "link": "https://stackoverflow.com/questions/33791634/updating-a-value-in-data-bytestring/33792170#33792170", "title": "Updating a value in Data.ByteString", "body": "<p>One solution is to convert the <code>ByteString</code> to a <code>Storable</code> <code>Vector</code>, then modify that:</p>\n\n<pre><code>import Data.ByteString (ByteString)\nimport Data.Vector.Storable (modify)\nimport Data.Vector.Storable.ByteString  -- provided by the \"spool\" package\nimport Data.Vector.Storable.Mutable (write)\nimport Data.Word (Word8)\n\nupdateAt :: Int -&gt; Word8 -&gt; ByteString -&gt; ByteString\nupdateAt n x s = vectorToByteString . modify inner . byteStringToVector\n  where\n    inner v = write v n x\n</code></pre>\n\n<p>See the documentation for <a href=\"https://hackage.haskell.org/package/spool-0.1/docs/Data-Vector-Storable-ByteString.html\" rel=\"nofollow\"><code>spool</code></a> and <a href=\"https://hackage.haskell.org/package/vector-0.11.0.0/docs/Data-Vector-Storable.html#g:18\" rel=\"nofollow\"><code>vector</code></a>.</p>\n"}], "owner": {"reputation": 427, "user_id": 4585063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://graph.facebook.com/10205618035027960/picture?type=large", "display_name": "Daniel Lovasko", "link": "https://stackoverflow.com/users/4585063/daniel-lovasko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 265, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1447903933, "creation_date": 1447885516, "last_edit_date": 1447903933, "question_id": 33791634, "link": "https://stackoverflow.com/questions/33791634/updating-a-value-in-data-bytestring", "title": "Updating a value in Data.ByteString", "body": "<p>The C language provides a very handy way of updating the <code>nth</code> element of an array: <code>array[n] = new_value</code>. My understanding of the <code>Data.ByteString</code> type is that it provides a very similar functionality to a C array of <code>uint8_t</code> - access via <code>index :: ByteString -&gt; Int -&gt; Word8</code>. It appears that the opposite operation - updating a value - is not that easy.</p>\n\n<p>My initial approach was to use the <code>take</code>, <code>drop</code> and <code>singleton</code> functions, <code>concat</code>etaned in the following way:</p>\n\n<pre><code>updateValue :: ByteString -&gt; Int -&gt; Word8 -&gt; ByteString\nupdateValue bs n value = concat [take (n-1) bs, singleton value, drop (n+1) bs] \n</code></pre>\n\n<p>(this is a very naive implementation as it does not handle edge cases)</p>\n\n<p>Coming with a C background, it feels a <em>bit</em> too heavyweight to call 4 functions to update one value. Theoretically, the operation complexity is not that bad:</p>\n\n<ul>\n<li><code>take</code> is O(1)</li>\n<li><code>drop</code> is O(1)</li>\n<li><code>singleton</code> is O(1)</li>\n<li><code>concat</code> is O(n), but here I am not sure if the <em>n</em> is the length of the concatenated list altogether or if its just, in our case, 3.</li>\n</ul>\n\n<p>My second approach was to ask Hoogle for a function with a similar type signature: <code>ByteString -&gt; Int -&gt; a -&gt; ByteString</code>, but nothing appropriate appeared.</p>\n\n<p>Am I missing something very obvious, or is really that complex to update the value?</p>\n\n<p>I would like to note that I understand the fact that the <code>ByteString</code> is immutable and that changing any of its elements will result into a new <code>ByteString</code> instance.</p>\n\n<p>EDIT:\nA possible solution that I found while reading about the <code>Control.Lens</code> library uses the <code>set</code> lens. The following is an outtake from GHCi with omitted module names:</p>\n\n<pre><code>&gt; import Data.ByteString\n&gt; import Control.Lens\n&gt; let clock = pack [116, 105, 99, 107]\n&gt; clock\n\"tick\"\n&gt; let clock2 = clock &amp; ix 1 .~ 111\n&gt; clock2\n\"tock\"\n</code></pre>\n"}, {"tags": ["haskell", "types", "agda", "dependent-type", "type-theory"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1447875027, "post_id": 33788639, "comment_id": 55344351, "body": "I can&#39;t parse <code>(cont -&gt; x)</code>. Is there a <code>\\ </code> as well?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1447875316, "post_id": 33788639, "comment_id": 55344518, "body": "I have no clear idea here, but I think church numerals as having a <i>polytype</i> <code>CN = forall a. (a-&gt;a)-&gt;a-&gt;a</code>. Since polytypes can&#39;t be inferred, I&#39;d start by annotating numeral-valued variables with <code>CN</code> -- there&#39;s a chance you are using them at different types."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1447875474, "post_id": 33788639, "comment_id": 55344621, "body": "@chi Actually there shouldn&#39;t be a `` on the other lambda. I had no idea how it got there. &quot;There is a chance I&#39;m using them at different types&quot;?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1447876134, "post_id": 33788639, "comment_id": 55345027, "body": "In the untyped lambda calculus, you can apply a church numeral to any function. In a typed language with no polytypes, you can have a numeral for every type <code>T</code> (which can be applied to functions <code>T-&gt;T</code>, only) -- this limitation is however very inconvenient. In a polytyped language, you can assign type <code>CN</code> to numerals, so that they can work with any function of type <code>T-&gt;T</code>, whatever type <code>T</code> is."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1447877187, "post_id": 33788639, "comment_id": 55345713, "body": "After some experiment, I feel that the subterm <code>a (\\ p c -&gt; c  p)</code> can not be typed in SystemF (even after adding some type parameters). Its type seems to depend on the actual value of <code>a</code>. In CoC, I guess that it could be typed, but only after adding not merely type variables/type arguments, but other terms which encode how the resulting type depends on <code>a</code>."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1447877582, "post_id": 33788639, "comment_id": 55345945, "body": "This seems to work the similarly as the <a href=\"http://stackoverflow.com/questions/29885983/infinite-type-error-when-defining-zip-with-foldr-only-can-it-be-fixed\">coroutining zip</a> in the prior question, so I think it can be similarly typed in Agda. However, it would also use dependent elimination, this time on natural numbers, and there&#39;s no way to get that purely from Church encodings. We&#39;d need to add the elimination rule to the base language."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1447878457, "post_id": 33788639, "comment_id": 55346469, "body": "That&#39;s what I&#39;m asking actually. Your solution uses dependent eliminators, which CoC (thus, Morte) doesn&#39;t have. So you&#39;re saying it isn&#39;t typeable on CoC, right?"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1447879211, "post_id": 33788639, "comment_id": 55346853, "body": "Right. It&#39;s somewhat bad news for those wanting minimal core languages. You could look into type theories with closed (&quot;generic&quot;) type universes though, since they can be much more powerful than vanilla CoC but still have quite simple specification (and they also doesn&#39;t need any user-defined data types)."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1447879678, "post_id": 33788639, "comment_id": 55347127, "body": "The way you said is hard to Google it. Could you give me some pointers, @Andr&#225;sKov&#225;cs?"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 2, "creation_date": 1447881843, "post_id": 33788639, "comment_id": 55348383, "body": "Unfortunately the material I read about this is scattered around many non-self-contained papers, and I don&#39;t remember anything from the top of my head that would be nice specifically for your purposes. The idea is to encode all types using a small set of constructions, for accessible basics you can look at <code>GHC.Generics</code> and its uses. For more advanced generic universes you can look at <a href=\"http://www.andres-loeh.de/IndexedFunctors/\" rel=\"nofollow noreferrer\">this</a> or <a href=\"http://sneezy.cs.nott.ac.uk/darcs/Pig09/papers/icfp-2010-desc/icfp23l-dagand.pdf\" rel=\"nofollow noreferrer\">this</a>."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 2, "creation_date": 1447882024, "post_id": 33788639, "comment_id": 55348479, "body": "In general I learned lots from Conor McBride&#39;s papers (pigworker on SO and reddit) and on generics specifically from Anders L&#246;h&#39;s papers (kosmikus on SO and reddit). Search on Google Scholar for their stuff. I guess you would need to take a deep type theory dive to get a good grasp on this. I recommend the experience wholeheartedly, though."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1447883717, "post_id": 33788639, "comment_id": 55349444, "body": "&quot;I guess you would need to take a deep type theory dive to get a good grasp on this.&quot; - and how can I do that efficiently? When I consider doing that, what stops me is that I think I&#39;d spend more time uncharting the field and figuring what I should read, than on reading itself."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1447883856, "post_id": 33788639, "comment_id": 55349512, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/95494/discussion-between-andras-kovacs-and-viclib\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 3, "creation_date": 1447935733, "post_id": 33801642, "comment_id": 55373010, "body": "See <a href=\"http://arxiv.org/pdf/1309.5135.pdf\" rel=\"nofollow noreferrer\">this</a> for discussion on <code>min</code>-like constructions."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1447938947, "post_id": 33801642, "comment_id": 55375269, "body": "@Andr&#225;s Kov&#225;cs, thanks, that&#39;s unusually readable paper that contains continuations. So we do need to solve <code>t2 = (t2 -&gt; t1) -&gt; t1</code> and thus do need recursive types."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1448111016, "post_id": 33801642, "comment_id": 55451712, "body": "@Andr&#225;sKov&#225;cs, what do you think about <a href=\"http://cs.stackexchange.com/questions/49638/do-self-types-make-the-calculus-of-inductive-constructions-obsolete\">Self Types</a>? Do it solve the problem without other issues?"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1448214446, "post_id": 33801642, "comment_id": 55480533, "body": "@Viclib I think <code>min</code> could be typed in it after we do some extension to the system in the paper, specifically we need to compute types from <code>Nat</code>-s, which requires induction motive <code>Nat -&gt; \u2610</code>, but the paper only has <code>Nat -&gt; *</code>. This shouldn&#39;t be too hard though, we could use a hierarchy of universes like in Agda/Coq, or <code>* : *</code> if we&#39;re lazy. The paper&#39;s a great find."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1448216388, "post_id": 33801642, "comment_id": 55481199, "body": "@Andr&#225;s Kov&#225;cs, the system already has <code>* : *</code>. But then we can just use Scott-encoded data. I don&#39;t think it&#39;s possible to typify <code>self k = k self</code> (which is the most basic thing that we can do with hyperfunctions) in any sound type system: <code>self self</code> is an immediate loop."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1448217199, "post_id": 33801642, "comment_id": 55481499, "body": "@user3237465: I only see <code>* : \u2610</code> in <a href=\"http://homepage.cs.uiowa.edu/~astump/papers/fu-stump-rta-tlca-14.pdf\" rel=\"nofollow noreferrer\">the paper</a>. As to typing <code>min</code>, we just need to supply extra proof that the types of the coroutining folds always line up. <a href=\"http://lpaste.net/145786\" rel=\"nofollow noreferrer\">See Agda code</a>. On first look it seems to be feasible with &quot;self types&quot; too, if we add large elimination."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1448220864, "post_id": 33801642, "comment_id": 55482831, "body": "@Andr&#225;s Kov&#225;cs, I guess there is <code>* : \u2610</code> in the paper only because of the erasion to System F-omega stuff. <a href=\"http://staff.computing.dundee.ac.uk/pengfu/document/talks/mvd-2012.pdf\" rel=\"nofollow noreferrer\">The slides</a> contain <code>* : *</code>. The code is enlightening, thanks. It&#39;s impossible to define <code>self k = k self</code>, but not <code>self : \u2200 n -&gt; Min \u22a4 n -&gt; \u2115; self  0      k = k _; self (suc n) k = k (self n)</code>."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 1, "creation_date": 1448228054, "post_id": 33801642, "comment_id": 55485367, "body": "@Viclib, Andr&#225;s Kov&#225;cs, I wrote a more or less direct <a href=\"http://lpaste.net/145793\" rel=\"nofollow noreferrer\">translation</a> of coroutining folds to Agda."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1448375932, "post_id": 33801642, "comment_id": 55555357, "body": "@user3237465, I&#39;m not sure I understand what you guys are talking about. What exactly is the conclusion? For <code>min</code> to be typed in a sound system, all we need is <code>self</code> and an infinite hierarchy of universes - is that what you said? I (very) superficially understand what your code is doing, but I don&#39;t see any self referential type there, so I&#39;m not sure what this has to do."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1448376709, "post_id": 33801642, "comment_id": 55555968, "body": "@Viclib, <code>self</code>-types give you the induction principle, which is needed to define <code>foldK</code>. But with the induction principle you can write <code>min</code> using direct pattern matching. So yes, <code>self</code>-types give you the ability to make <code>min</code> typed, but they also give you the ability to write the usual three-lines definition of <code>min</code>. But I don&#39;t know whether self-types are really unproblematic."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1448376953, "post_id": 33801642, "comment_id": 55556135, "body": "@user3237465 you mean the usual recursive function? <code>min (S a) (S b) = min a b; min Z b = b; min a Z = a</code>? That doesn&#39;t make sense, because those need the Y-Combinator (even on the untyped lambda calculus), which can&#39;t be typed, right?"}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1448378316, "post_id": 33801642, "comment_id": 55557171, "body": "@Viclib, if <code>a</code> is Church-encoded and <code>b</code> is Scott-encoded, then you don&#39;t need the Y-combinator. Eliminators give you both like Parigot encoding. (We discussed this and I agreed that <code>min</code> defined this way is too strict, but that was wrong: <a href=\"http://lpaste.net/145886\" rel=\"nofollow noreferrer\">here</a> is the program that terminates immediately. With Church encoding you&#39;re stuck with <code>tail</code>, but not with <code>head</code>). <a href=\"https://github.com/effectfully/random-stuff/blob/master/Lists/zipWith-via-elim.agda\" rel=\"nofollow noreferrer\">Here</a> is <code>zipWith</code> defined in terms of eliminators."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1448446443, "post_id": 33801642, "comment_id": 55589071, "body": "Ah, I see. Well, I&#39;ll try to extend Morte with <code>self</code> and write your <code>foldK</code> there, that might be a great exercise. But what is going on on line 7, after the <code>=</code> sign? Why interleave uses <code>{}</code> instead of <code>()</code> on the arguments? Also, I&#39;m not sure where <code>self</code> is used TBH, <code>foldK</code>&#39;s type doesn&#39;t refer to itself, it refer&#39;s to <code>FoldK</code>..."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1448451873, "post_id": 33801642, "comment_id": 55592571, "body": "@Viclib, I&#39;d become convenient with dependent types before trying to implement a typechecker, especially with a non-well-known non-syntax-directed rules. <code>FoldK</code> makes a type of a continuation from a number. Implicit arguments are enclosed in <code>{}</code> \u2014 it&#39;s just a convenience, you can make everything explicit. The point about <code>foldK</code> is that its type depends on <code>n</code>. With Church-encoded nats there is no way to express this dependency \u2014 they give you the power of predicative System F (modulo large elimination). <code>self</code> gives you eliminators, which are the cornerstone of dependent type theories."}], "tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": false, "score": 4, "last_activity_date": 1447939011, "last_edit_date": 1447939011, "creation_date": 1447929877, "answer_id": 33801642, "question_id": 33788639, "link": "https://stackoverflow.com/questions/33788639/is-it-possible-to-type-min-in-a-normalizing-theory-such-as-system-f-or-the-cal/33801642#33801642", "title": "Is it possible to type `min` in a normalizing theory such as System-F or the Calculus of Constructions?", "body": "<p>The function (is it well-known? it looks really clever) is typeable, it just doesn't work with Church-encoded nats.</p>\n\n<p>Here is the type that GHC infers:</p>\n\n<pre><code>(((t3 -&gt; t2) -&gt; t3 -&gt; t2) -&gt; (b0 -&gt; a0) -&gt; t1 -&gt; t0)\n                        -&gt; (((t6 -&gt; t5) -&gt; t6 -&gt; t4) -&gt; (b1 -&gt; a0) -&gt; t1)\n                        -&gt; (t5 -&gt; t4)\n                        -&gt; a0\n                        -&gt; t0))\n</code></pre>\n\n<p>Here is the closest to the desired type I could get:</p>\n\n<pre><code>postulate t1 t2 : Set\n\nA = ((t2 -&gt; t1) -&gt; t1) -&gt; (((t2 -&gt; t1) -&gt; t1) -&gt; t1) -&gt; t1\nB = (t2 -&gt; t1) -&gt; ((t2 -&gt; t1) -&gt; t1) -&gt; t1\nC = t1 -&gt; t1\n\nmin : (A -&gt; A) -&gt; (B -&gt; B) -&gt; (C -&gt; C)\nmin a b = \\ f x -&gt; a (\\ p c -&gt; c p) (\\ c -&gt; x) (b (\\ p c -&gt; f (c p)) (\\ c -&gt; x))\n</code></pre>\n\n<p>To work with Church-encoded nats <code>min</code> must accept two arguments of type <code>(a -&gt; a) -&gt; a -&gt; a</code>, i.e. <code>A</code> must be of type <code>a -&gt; a</code>, i.e.</p>\n\n<pre><code>a ~ (t2                 -&gt; t1) -&gt; t1\na ~ (((t2 -&gt; t1) -&gt; t1) -&gt; t1) -&gt; t1\n</code></pre>\n\n<p>i.e. <code>t2 ~ (t2 -&gt; t1) -&gt; t1</code>, which is a loop. There is no recursive types in System F or CoC and hence the term is not typeable as is.</p>\n\n<p>However I ignored the <code>Rank2Types</code> stuff. Anyway,</p>\n\n<pre><code>newtype Church = Church { runChurch :: forall a. (a -&gt; a) -&gt; a -&gt; a }\n\nmin' a b = Church $ \\f x -&gt; runChurch a (\\p c -&gt; c p) (\\c -&gt; x) (runChurch b (\\p c -&gt; f (c p)) (\\c -&gt; x))\n</code></pre>\n\n<p>is an infinite type error as well.</p>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 3, "answer_count": 1, "score": 10, "last_activity_date": 1447939011, "creation_date": 1447874766, "last_edit_date": 1447935828, "question_id": 33788639, "link": "https://stackoverflow.com/questions/33788639/is-it-possible-to-type-min-in-a-normalizing-theory-such-as-system-f-or-the-cal", "title": "Is it possible to type `min` in a normalizing theory such as System-F or the Calculus of Constructions?", "body": "<p>This <code>min</code> definition below works on two church numbers and returns the least big. Each number becomes a continuation that sends its pred to the other, zig and zag, until zero is reached. Moreover, one of the numbers appends f to the result each time it is called, so, in the end, you'll have <code>(\\ f x -&gt; f (... (f (f x)) ...))</code> where the number of 'f's on the right is the number of times the first continuation was called.</p>\n\n<pre><code>min a b f x = (a_continuator b_continuator)\n    a_continuator = (a (\\ pred cont -&gt; (cont pred)) (\\ cont -&gt; x))\n    b_continuator = (b (\\ pred cont -&gt; (f (cont pred))) (\\ cont -&gt; x))\n</code></pre>\n\n<p>It seems like <code>min</code> can't be typed on System-F. For example, in order to run it on GHC, I had to use <code>unsafeCoerce</code> twice:</p>\n\n<pre><code>import Unsafe.Coerce\n\n(#)   = unsafeCoerce\nmin'  = (\\ a b f x -&gt; (a (\\ p c -&gt; (c # p)) (\\ c -&gt; x) (b (\\ p c -&gt; (f (c # p))) (\\ c -&gt; x))))\ntoInt = (\\ n -&gt; (n (+ 1) 0))\nmain  = print (toInt (min'\n    (\\ f x -&gt; (f (f (f (f (f x))))))               -- 5\n    (\\ f x -&gt; (f (f (f (f (f (f (f (f x))))))))))  -- 8\n    :: Int)\n</code></pre>\n\n<p>Is it possible to type <code>min</code> on System-F (or the Calculus of Constructions)?</p>\n"}, {"tags": ["json", "parsing", "haskell", "aeson"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1447868893, "post_id": 33786836, "comment_id": 55340639, "body": "first the obvious question: where your files big enough to make the parsing <i>observable</i> ?"}, {"owner": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1447869067, "post_id": 33786836, "comment_id": 55340742, "body": "@Carsten I tried json file of size ~20M, is that big enough?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1447882812, "post_id": 33786836, "comment_id": 55348947, "body": "<code>json&#39;</code> does no interesting computation (just applies constructors), so there is no(t enough) computation for laziness to delay. Do something more interesting, like parsing a number and returning <code>last [n..maxBound]</code> as the value of the parse, and you will see the difference. (Didn&#39;t turn this into an answer because every time I touch aeson I get lost in a maze of twisty little <code>Parser</code> types and <code>parse</code> functions, all alike.)"}, {"owner": {"reputation": 7714, "user_id": 149901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d1a6db7a9fb5385fde6ba426e27d5ac6?s=128&d=identicon&r=PG", "display_name": "ondra", "link": "https://stackoverflow.com/users/149901/ondra"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1448557056, "post_id": 33786836, "comment_id": 55646634, "body": "@DanielWagner Are you sure? The <code>Value</code> construction in aeson is strict. The aeson parsing function reports error; in order to do that, it has to go  check, that the element is correct and build the aeson <code>Value</code>, then go  through the <code>parseJSON</code> and custom parsing. It seems to me there is no residual laziness there."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 7714, "user_id": 149901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d1a6db7a9fb5385fde6ba426e27d5ac6?s=128&d=identicon&r=PG", "display_name": "ondra", "link": "https://stackoverflow.com/users/149901/ondra"}, "edited": false, "score": 0, "creation_date": 1448562767, "post_id": 33786836, "comment_id": 55649199, "body": "@ondra I think we are in agreement! You say &quot;there is no residual laziness&quot;, I say &quot;there is not enough computation for laziness to delay&quot;. What are you asking if I&#39;m sure about?"}, {"owner": {"reputation": 7714, "user_id": 149901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d1a6db7a9fb5385fde6ba426e27d5ac6?s=128&d=identicon&r=PG", "display_name": "ondra", "link": "https://stackoverflow.com/users/149901/ondra"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1448584632, "post_id": 33786836, "comment_id": 55656558, "body": "@DanielWagner I might got confused here; it&#39;s that it seems to me that <code>json&#39;</code> and <code>json</code> are completely identical as all the <code>Value</code> parameters are strict anyway and the difference in the source code doesn&#39;t matter. Is that what you are saying or am I wrong?"}, {"owner": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "reply_to_user": {"reputation": 7714, "user_id": 149901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d1a6db7a9fb5385fde6ba426e27d5ac6?s=128&d=identicon&r=PG", "display_name": "ondra", "link": "https://stackoverflow.com/users/149901/ondra"}, "edited": false, "score": 0, "creation_date": 1448645556, "post_id": 33786836, "comment_id": 55682040, "body": "@ondra I was wondering the same, and none of my experiments show difference between them. I opened an issue and will report what they reply."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 7714, "user_id": 149901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d1a6db7a9fb5385fde6ba426e27d5ac6?s=128&d=identicon&r=PG", "display_name": "ondra", "link": "https://stackoverflow.com/users/149901/ondra"}, "edited": false, "score": 0, "creation_date": 1448647417, "post_id": 33786836, "comment_id": 55682855, "body": "@ondra Aha, it seems I may have misunderstood the question somewhat. Is the question here specifically about <code>json</code> vs <code>json&#39;</code>, or is it about lazy parsers vs strict parsers in general?"}, {"owner": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1448648511, "post_id": 33786836, "comment_id": 55683320, "body": "@DanielWagner It seems to me that <code>json</code> and <code>json&#39;</code> are the only place the library has an option of being lazy or strict."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1448648906, "post_id": 33786836, "comment_id": 55683467, "body": "@rem Not so -- the whole <code>FromJSON</code> business of converting a JSON <code>Value</code> into your semantic value offers a whole host of opportunities for inserting strictness bugs. ;-)"}, {"owner": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1448855304, "post_id": 33786836, "comment_id": 55738156, "body": "@DanielWagner Do you have an example? A <a href=\"https://github.com/bos/aeson/issues/37\" rel=\"nofollow noreferrer\">discussion</a> on their repo doesn&#39;t mention anything about <code>FromJSON</code>, yet it looks like that&#39;s when they introduced the 2 different parsers. I also updated the question with a recent experiment."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1448860477, "post_id": 33786836, "comment_id": 55739490, "body": "@rem Yes, sure: <code>foo x = loop &lt;$ fromJSON x</code>"}, {"owner": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1448896491, "post_id": 33786836, "comment_id": 55759281, "body": "@DanielWagner Which <code>loop</code> do you mean? Thank you for your patience!"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1448900204, "post_id": 33786836, "comment_id": 55761757, "body": "@rem Pick any non-terminating (or even merely long-running) loop you like. <code>loop = go 0 where go x = go (x+1)</code> would do."}], "owner": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 163, "favorite_count": 2, "answer_count": 0, "score": 2, "last_activity_date": 1448855092, "creation_date": 1447868773, "last_edit_date": 1448855092, "question_id": 33786836, "link": "https://stackoverflow.com/questions/33786836/aeson-lazy-parser", "title": "Aeson lazy parser", "body": "<p>The Aeson library offers two flavors of json parser: a strict one and a lazy one. The lazy one claims to save time but creat thunks, whereas the strict one saves space and takes more time (both if the data isn't accessed frequently). I have the following toy program to see the difference between them, but the profiles are identical: </p>\n\n<pre><code>import Data.Aeson\nimport Data.ByteString as B\nimport Data.Attoparsec.ByteString as P\nimport System.Environment\n\nmain = do\n    [fn] &lt;- getArgs\n    fc &lt;- B.readFile fn\n    let r = P.parse json' fc\n    case r\n      of Done _ _ -&gt; print \":)\"\n         _   -&gt; print \":(\"\n</code></pre>\n\n<p>Two parsers also have identical performance when the program access the data fully: </p>\n\n<pre><code>    ...\n    case r\n      of Done _ j -&gt; print j\n         _   -&gt; print \":(\"\n</code></pre>\n\n<p>Why doesn't the lazy version save time in the first program and waste space in the second? Is there an example where one of the parsers clearly wins? </p>\n\n<p>Update: Following is my recent experiment with <code>FromJSON</code>, which also failed to differentiate <code>decode</code> from <code>decode'</code></p>\n\n<pre><code>Data Weirder = Weirder\n\ninstance FromJSON Weirder where\n    parseJSON (Number n) = return $! undefined -- $! trace \"weirdercalled\" Weirder -- `seq` Weirder\n\nmain = do\n    [fn] &lt;- getArgs\n    fc &lt;- B.readFile fn\n    let Just rs = decode fc :: Maybe [Weirder]\n    print $ length rs\n</code></pre>\n\n<p>I've tried printing <code>head</code>, <code>last</code>, flipping bangs and inserting <code>seq</code>, yet all the same...</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1447868370, "post_id": 33786643, "comment_id": 55340334, "body": "What\u2019s the \u201cimpure\u201d part of this? If <code>print $ take 1000 $ zip [1..] $ map f [1..]</code> works, there isn\u2019t really one\u2026"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1447868498, "post_id": 33786643, "comment_id": 55340412, "body": "I guess <code>print</code> is ;) - btw: you should make this into an answer minitech"}], "answers": [{"comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 3, "creation_date": 1447871395, "post_id": 33786806, "comment_id": 55342071, "body": "Can&#39;t resist: <code>main = print $ map ((,) &lt;*&gt; f) [1..1000]</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 2, "creation_date": 1447871917, "post_id": 33786806, "comment_id": 55342385, "body": "@user3237465 Cool, the rare &quot;reversed&quot; applicative <code>((,) &lt;*&gt; f) &lt;$&gt; [1..1000]</code> (the operators being reversed from the usual <code>f &lt;$&gt; g &lt;*&gt; h</code> pattern)!"}, {"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "edited": false, "score": 0, "creation_date": 1447942349, "post_id": 33786806, "comment_id": 55377758, "body": "@Daniel Wagner : ok, but how to get the following behaviour : print (n,f(n)) as soon as it is computed : the behaviour is : compute (1,f(1)), then print (1,f(1)), compute (2,f(2)) and print (2,f(2)) ...etc"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "edited": false, "score": 1, "creation_date": 1447943859, "post_id": 33786806, "comment_id": 55378923, "body": "@lolveley That is the default behavior. Ain&#39;t laziness great?"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 12, "last_activity_date": 1447868631, "creation_date": 1447868631, "answer_id": 33786806, "question_id": 33786643, "link": "https://stackoverflow.com/questions/33786643/how-to-mix-pure-and-impure-data-in-main/33786806#33786806", "title": "How to mix pure and impure data in main?", "body": "<p>It's pretty succinct (and, in my obviously biased opinion, quite readable) in Haskell:</p>\n\n<pre><code>main = print [(x, f x) | x &lt;- [1..1000]]\n</code></pre>\n"}], "owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 33786806, "answer_count": 1, "score": 1, "last_activity_date": 1448034126, "creation_date": 1447868067, "last_edit_date": 1448034126, "question_id": 33786643, "link": "https://stackoverflow.com/questions/33786643/how-to-mix-pure-and-impure-data-in-main", "title": "How to mix pure and impure data in main?", "body": "<p>Say I wrote a pure function, <code>f</code>, whose signature is</p>\n\n<pre><code>f :: Int -&gt; Int\n</code></pre>\n\n<p>How can I write the main function in order to display the 1000 first values like this:</p>\n\n<pre><code>(1,f(1)), (2,f(2)), ..., (1000,f(1000))?\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 1929, "user_id": 5181199, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204393995596520/picture?type=large", "display_name": "Oly", "link": "https://stackoverflow.com/users/5181199/oly"}, "edited": false, "score": 0, "creation_date": 1447891404, "post_id": 33786500, "comment_id": 55352588, "body": "Carsten&#39;s answer below is perfect. For thinking about where your ideas went wrong, it might be worth also wondering how you&#39;d do it with direct recursion. The reason I say this is because I suspect you almost had the right idea, so it probably pays to see how it might have been right. :) You could try, instead of the bottom line, <code>smaller [x] = []</code> and <code>smaller (x:y:xs) = if (y &lt; x) then y:(smaller (x:xs)) else smaller (x:xs)</code>"}, {"owner": {"reputation": 1929, "user_id": 5181199, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204393995596520/picture?type=large", "display_name": "Oly", "link": "https://stackoverflow.com/users/5181199/oly"}, "edited": false, "score": 0, "creation_date": 1447891606, "post_id": 33786500, "comment_id": 55352673, "body": "A neater way could be to have a helper method (maybe <code>smaller&#39;</code>) which, given an <code>x</code> and a list returns a sublist of the elements less than <code>x</code>. The recursion for such a method will look a little neater, and then <code>smaller (x:xs) = smaller&#39; x xs</code> will be sufficient."}], "answers": [{"comments": [{"owner": {"reputation": 57, "user_id": 3553559, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/255985d98f3840fd3f15d3117f8a62c1?s=128&d=identicon&r=PG&f=1", "display_name": "duyCuong", "link": "https://stackoverflow.com/users/3553559/duycuong"}, "edited": false, "score": 0, "creation_date": 1447868565, "post_id": 33786548, "comment_id": 55340460, "body": "My error in syntax &amp; in my thinking i used recursive to compare first number with remaining numbers......may be something wrong about list comprehension. i&#39;m a newbie.. Thanks for your help! ---Resolved"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 57, "user_id": 3553559, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/255985d98f3840fd3f15d3117f8a62c1?s=128&d=identicon&r=PG&f=1", "display_name": "duyCuong", "link": "https://stackoverflow.com/users/3553559/duycuong"}, "edited": false, "score": 1, "creation_date": 1447868651, "post_id": 33786548, "comment_id": 55340502, "body": "hey no problem - btw: if it does what you want you should probably accept this - the <i>--Resolved--</i> comment sadly won&#39;t show (AFAIK)"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 3, "last_activity_date": 1447868772, "last_edit_date": 1447868772, "creation_date": 1447867804, "answer_id": 33786548, "question_id": 33786500, "link": "https://stackoverflow.com/questions/33786500/how-to-find-the-numbers-in-the-list-with-a-value-smaller-than-first-number-head/33786548#33786548", "title": "How to find the numbers in the list with a value smaller than first number (head)?", "body": "<p>hey you basically had it - just change the last <code>)</code> to <code>]</code> and remove the <code>smaller</code> (why do you want to make the list ever smaller?)</p>\n\n<pre><code>smaller :: (Ord a) =&gt; [a] -&gt; [a]\nsmaller [] = []\nsmaller (x:xs) = [a | a &lt;- xs, a &lt; x]\n</code></pre>\n\n<p>to make this more clear - the way you had it was that you got:</p>\n\n<ul>\n<li><code>[1,2,3]</code> from <code>[5,7,1,2,3]</code> in the first step</li>\n<li>then reapplied <code>smaller</code> to get <code>[]</code> from <code>[1,2,3]</code> in the second</li>\n<li>applied <code>smaller</code> again to <code>[]</code> to get your final <code>[]</code> ;)</li>\n</ul>\n\n<hr>\n\n<p>also if you want only elements smaller than <code>x</code> then it should be <code>a &lt; x</code> instead of <code>x &lt;= a</code> - your example is not clear on that but the topic want's <code>&lt;</code></p>\n\n<hr>\n\n<p>in case you don't like <em>list-comprehensions</em> here is the same using <code>filter</code>:</p>\n\n<pre><code>smaller :: (Ord a) =&gt; [a] -&gt; [a]\nsmaller [] = []\nsmaller (x:xs) = filter (&lt; x) xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 0, "last_activity_date": 1447897730, "creation_date": 1447897730, "answer_id": 33793858, "question_id": 33786500, "link": "https://stackoverflow.com/questions/33786500/how-to-find-the-numbers-in-the-list-with-a-value-smaller-than-first-number-head/33793858#33793858", "title": "How to find the numbers in the list with a value smaller than first number (head)?", "body": "<p>Carsten's answer is just right, but it's worth noting that a more idiomatic solution is this, using the <code>filter</code> function instead of a comprehension:</p>\n\n<pre><code>smaller :: Ord a =&gt; [a] -&gt; [a]\nsmaller [] = []\nsmaller (a:as) = filter (&lt;=a) as\n</code></pre>\n\n<p>Exercise: write your own version of the <code>filter</code> function.  Don't use comprehensions.  Signature:</p>\n\n<pre><code>-- | Return a list of the elements that satisfy the condition \n-- specified by the first argument, in the same order as they\n-- appear in the original.\n--\n-- Some test cases to check whether you're doing it right:\n--\n-- &gt; filter (\\_ -&gt; True) [1..10] == [1..10]\n-- &gt; filter (\\_ -&gt; False) [1..10] == []\n-- &gt; filter even [1..10] == [2,4,6,8,10]\n--\nfilter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 3553559, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/255985d98f3840fd3f15d3117f8a62c1?s=128&d=identicon&r=PG&f=1", "display_name": "duyCuong", "link": "https://stackoverflow.com/users/3553559/duycuong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 708, "favorite_count": 0, "accepted_answer_id": 33786548, "answer_count": 2, "score": 1, "last_activity_date": 1447897730, "creation_date": 1447867666, "last_edit_date": 1447876856, "question_id": 33786500, "link": "https://stackoverflow.com/questions/33786500/how-to-find-the-numbers-in-the-list-with-a-value-smaller-than-first-number-head", "title": "How to find the numbers in the list with a value smaller than first number (head)?", "body": "<p>I want to define a function <code>smaller</code> which finds all the numbers in\na list which are smaller than the first number in the same list.</p>\n\n<p>For example, <code>smaller [5, 7, 1, 2, 3]</code> should return <code>[1, 2, 3]</code>.</p>\n\n<p>This is my code:</p>\n\n<pre><code>smaller :: (Ord a) =&gt; [a] -&gt; [a]\nsmaller [] = []\nsmaller (x:xs) = smaller [a | a &lt;- xs, a &lt;= x)\n</code></pre>\n\n<p>Anyone can help/guide me ?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 2, "creation_date": 1447864876, "post_id": 33785138, "comment_id": 55337969, "body": "hint use <code>(fromEnum $ maxBound Ace)*(fromEnum suit) + (fromEnum pip)</code> to calculate the enumeration"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 2, "creation_date": 1447865524, "post_id": 33785138, "comment_id": 55338436, "body": "@epsilonhalbe you probably meant <code>(maxBound :: Pip)</code> or <code>King</code> right? (for the first you need <code>deriving (..., Bounded)</code>"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1447865884, "post_id": 33785138, "comment_id": 55338697, "body": "ya I always get it wrong - I should have consulted the docs for that"}, {"owner": {"reputation": 105, "user_id": 5577531, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/486fa1ecf90369f0e46fc979261b0125?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5577531/joe"}, "edited": false, "score": 0, "creation_date": 1447866339, "post_id": 33785138, "comment_id": 55339020, "body": "But suit and pip are in the Card, how can it work if suit and pip were separated   by maxBound? Should maxBound be Card {suit = Diamond, pip = King}"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1447866674, "post_id": 33785138, "comment_id": 55339260, "body": "@Joe see my answer and play with it - basically the idea is how to enumerate say the pixels in an image - by doing the rows from top to bottom and the pixels in the rows left to right ((0,0) -&gt; (1,0) -&gt; ... (0,1) -&gt; (1,1) -&gt; ...) - if you want to go from (x,y) -&gt; index you can calculate y*image-width+x (and back with division with remainder) - here it&#39;s the same only that <code>x = Pip</code> and <code>y = Suit</code>"}, {"owner": {"reputation": 105, "user_id": 5577531, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/486fa1ecf90369f0e46fc979261b0125?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5577531/joe"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1447866991, "post_id": 33785138, "comment_id": 55339459, "body": "@Carsten, but there are only 5 cards being enumerated, how about 52 cards ?  Err: ** Exception: toEnum{Suit}: tag (4) is outside of enumeration&#39;s range (0,3)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1447867245, "post_id": 33785138, "comment_id": 55339615, "body": "you are right - sorry gonna fix one moment"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1447867469, "post_id": 33785138, "comment_id": 55339762, "body": "ok now you should get all - btw: I only picked 5 because all 52 (or the 49 I messed up before) seemed to be overkill - if you want to get all just try <code>[minBound .. maxBound] :: [Card]</code> - I double-checked and there are 52 there including the missing Kings ;)"}, {"owner": {"reputation": 105, "user_id": 5577531, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/486fa1ecf90369f0e46fc979261b0125?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5577531/joe"}, "edited": false, "score": 0, "creation_date": 1447868338, "post_id": 33785138, "comment_id": 55340314, "body": "@ Carsten Yes I got it Right now, Thanks1"}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 6, "last_activity_date": 1447867423, "last_edit_date": 1447867423, "creation_date": 1447866200, "answer_id": 33786042, "question_id": 33785138, "link": "https://stackoverflow.com/questions/33785138/fromenum-toenum-instance/33786042#33786042", "title": "fromEnum toEnum Instance?", "body": "<p>here is how I would do it (basically the @epsilonhalbe's idea):</p>\n\n<pre><code>data Suit\n   = Spade | Heart | Club | Diamond\n   deriving (Eq, Ord, Enum, Show, Bounded)\n\ndata Pip\n   = Ace | Two | Three | Four | Five | Six | Seven | Eight | Nine\n   | Ten | Jack | Queen | King\n   deriving (Eq, Ord, Enum, Show, Bounded)\n\ndata Card = Card\n     { suit :: Suit\n     , pip :: Pip\n     } deriving (Eq,Ord, Show, Bounded)\n\ninstance Enum Card where\n  toEnum i =\n    let (d,m) = i `divMod` (fromEnum (maxBound :: Pip) + 1)\n    in Card (toEnum d) (toEnum m)\n  fromEnum (Card s p) = fromEnum s * (fromEnum (maxBound :: Pip) + 1) + fromEnum p\n</code></pre>\n\n<p>this gives you:</p>\n\n<pre><code>\u03bb&gt; take 5 $ [minBound .. maxBound] :: [Card]\n[Card {suit = Spade, pip = Ace},Card {suit = Spade, pip = Two},Card {suit = Spade, pip = Three},Card {suit = Spade, pip = Four},Card {suit = Spade, pip = Five}]\n</code></pre>\n\n<hr>\n\n<p>PS: now you should get all - sorry I messed up the <code>maxBound</code> forgetting the one extra</p>\n"}], "owner": {"reputation": 105, "user_id": 5577531, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/486fa1ecf90369f0e46fc979261b0125?s=128&d=identicon&r=PG&f=1", "display_name": "Joe", "link": "https://stackoverflow.com/users/5577531/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1569, "favorite_count": 3, "accepted_answer_id": 33786042, "answer_count": 1, "score": 6, "last_activity_date": 1447876831, "creation_date": 1447863619, "last_edit_date": 1447876831, "question_id": 33785138, "link": "https://stackoverflow.com/questions/33785138/fromenum-toenum-instance", "title": "fromEnum toEnum Instance?", "body": "<pre><code>data Suit = Spade | Heart | Club | Diamond deriving (Eq, Ord, Enum, Show)\n\ndata Pip = Ace | Two | Three | Four | Five | Six | Seven | Eight | Nine    | Ten | Jack | Queen | King deriving (Eq, Ord, Enum, Show)\n\ndata Card = Card\n       {suit :: Suit\n       ,pip :: Pip\n       } deriving (Eq,Ord, Show)\n\ntype Deck = [Card]\n\ndata EOBoard = EOBoard\n         {foundations :: [Deck]\n         ,columns     :: [Deck]\n         ,reserve    :: [Deck]\n         } deriving (Eq, Ord, Show)\n\ninstance Enum Card where\n</code></pre>\n\n<p>This is a solitaire data structure \nHow can I make <code>Card</code> enumerable, with <code>Enum</code> instances from \n<code>Card{suit = Spade, pip = Ace}</code>, <code>Card{suit = Spade, pip = Two}</code> .. <code>Card{suit = Heart, pip = Ace}</code>.. <code>Card{suit = Club, pip = Ace}</code> .. <code>Card{suit = Diamond, pip = Ace} ..Card{suit = Diamond, pip = King}</code>.</p>\n"}, {"tags": ["haskell", "typeclass", "hugs", "deriving"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 6, "creation_date": 1447863245, "post_id": 33784541, "comment_id": 55336826, "body": "If that&#39;s really all code you have, then it might be a bug in Hugs. Also, please note that Hugs is no longer in development."}, {"owner": {"reputation": 477, "user_id": 4254033, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/bf1ada35cd0755b213121663b1140f91?s=128&d=identicon&r=PG&f=1", "display_name": "skulpt", "link": "https://stackoverflow.com/users/4254033/skulpt"}, "edited": false, "score": 0, "creation_date": 1447863552, "post_id": 33784541, "comment_id": 55337035, "body": "Yeah, but I have to use it, unfortunately."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1447863733, "post_id": 33784541, "comment_id": 55337149, "body": "are you sure you have not redefined <code>class Eq</code> somewhere in your file (or the grader ... oh wait it&#39;s FP101x right? So it probably has no grader)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1447863844, "post_id": 33784541, "comment_id": 55337214, "body": "btw: there is probably an <code>Eq</code> instance for 2-tuples already so you could make this a bit shorter ... something like <code>Combo c == Combo c&#39; = c == c&#39;</code> ;)"}], "answers": [{"tags": [], "owner": {"reputation": 477, "user_id": 4254033, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/bf1ada35cd0755b213121663b1140f91?s=128&d=identicon&r=PG&f=1", "display_name": "skulpt", "link": "https://stackoverflow.com/users/4254033/skulpt"}, "is_accepted": false, "score": 3, "last_activity_date": 1447863620, "creation_date": 1447863620, "answer_id": 33785139, "question_id": 33784541, "link": "https://stackoverflow.com/questions/33784541/make-a-newtype-instance-of-eq/33785139#33785139", "title": "Make a newtype instance of Eq", "body": "<p>Changing </p>\n\n<pre><code>instance Eq Combo where\nCombo ((a1, a2),(x1,x2)) == Combo ((b1, b2),(y1, y2)) = (a1 == b1) &amp;&amp; (a2 == b2) &amp;&amp; (x1 == y1) &amp;&amp; (x2 == y2)\n</code></pre>\n\n<p>to</p>\n\n<pre><code>instance Main.Eq Combo where\nCombo ((a1, a2),(x1,x2)) == Combo ((b1, b2),(y1, y2)) = (a1 == b1) &amp;&amp; (a2 == b2) &amp;&amp; (x1 == y1) &amp;&amp; (x2 == y2)\n</code></pre>\n\n<p>apparently fixed that error.</p>\n"}], "owner": {"reputation": 477, "user_id": 4254033, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/bf1ada35cd0755b213121663b1140f91?s=128&d=identicon&r=PG&f=1", "display_name": "skulpt", "link": "https://stackoverflow.com/users/4254033/skulpt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 534, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1447876634, "creation_date": 1447861912, "last_edit_date": 1447876634, "question_id": 33784541, "link": "https://stackoverflow.com/questions/33784541/make-a-newtype-instance-of-eq", "title": "Make a newtype instance of Eq", "body": "<p>I'm learning Haskell and I've been given following assignment - I have a newtype consisting of two mixed data types, and I have to make it an instance of Eq without using deriving. Here's what I have:</p>\n\n<pre><code>data Number = One | Two | Three deriving Eq\ndata Character = A | B | C deriving Eq\nnewtype Combo = Combo ((Character, Character),(Number, Number))\n\ninstance Eq Combo where\n    Combo ((a1, a2),(x1,x2)) == Combo ((b1, b2),(y1, y2)) = (a1 == b1) &amp;&amp; (a2 == b2) &amp;&amp; (x1 == y1) &amp;&amp; (x2 == y2)\n</code></pre>\n\n<p>However, Hugs goes all</p>\n\n<pre><code>ERROR \"testing.hs\":5 - Ambiguous class occurrence \"Eq\"\n*** Could refer to: Hugs.Prelude.Eq Main.Eq Main.Eq Main.Eq Main.Eq Main.Eq \n</code></pre>\n\n<p>How do I fix this? I can't really import Eq hiding something either since I need it to check if a given member of Number or Character is equal.</p>\n"}, {"tags": ["algorithm", "haskell"], "comments": [{"owner": {"reputation": 46273, "user_id": 574479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/79f682361ccbe900f8846a1098d13921?s=128&d=identicon&r=PG", "display_name": "biziclop", "link": "https://stackoverflow.com/users/574479/biziclop"}, "edited": false, "score": 4, "creation_date": 1447852863, "post_id": 33781107, "comment_id": 55328628, "body": "I don&#39;t speak Haskell but the algorithm normally goes like this: <code>take the input, divide it by 60, the remainder is the minute part, the result is then divided by 24, the remainder is the hours part, the result is the days part</code>. So you&#39;d need to chain the calculations rather than execute them in isolation."}, {"owner": {"reputation": 157, "user_id": 5521983, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fbfb4ad966e1ab171a9027954d47d428?s=128&d=identicon&r=PG&f=1", "display_name": "James Powell", "link": "https://stackoverflow.com/users/5521983/james-powell"}, "reply_to_user": {"reputation": 46273, "user_id": 574479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/79f682361ccbe900f8846a1098d13921?s=128&d=identicon&r=PG", "display_name": "biziclop", "link": "https://stackoverflow.com/users/574479/biziclop"}, "edited": false, "score": 0, "creation_date": 1447853004, "post_id": 33781107, "comment_id": 55328734, "body": "Yes, however, in Haskell, you cannot set variables, hence I am unsure how to achieve this."}, {"owner": {"reputation": 46273, "user_id": 574479, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/79f682361ccbe900f8846a1098d13921?s=128&d=identicon&r=PG", "display_name": "biziclop", "link": "https://stackoverflow.com/users/574479/biziclop"}, "edited": false, "score": 1, "creation_date": 1447853126, "post_id": 33781107, "comment_id": 55328839, "body": "You don&#39;t need to set variables, just feed the result into the next step straight away. I&#39;m unsure about the syntax though."}], "answers": [{"tags": [], "owner": {"reputation": 88499, "user_id": 650405, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5cdee2abea51e91756076032f0053081?s=128&d=identicon&r=PG", "display_name": "Karoly Horvath", "link": "https://stackoverflow.com/users/650405/karoly-horvath"}, "is_accepted": false, "score": 3, "last_activity_date": 1447853156, "creation_date": 1447853156, "answer_id": 33781293, "question_id": 33781107, "link": "https://stackoverflow.com/questions/33781107/haskell-more-efficient-way-to-complete-algorithm/33781293#33781293", "title": "Haskell - More efficient way to complete algorithm?", "body": "<p>You can use </p>\n\n<pre><code>a `mod` b\n</code></pre>\n\n<p>to directly get the remainder.</p>\n\n<p>And you can use <a href=\"https://wiki.haskell.org/Let_vs._Where\" rel=\"nofollow\"><code>let</code> or <code>where</code></a> to calculate a sub-expression.</p>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447863911, "post_id": 33781409, "comment_id": 55337257, "body": "Big +1 from me -- this is the right way. I was even going to make the usual quibble about <code>quotRem</code> vs <code>divMod</code>, but I think in this case <code>quotRem</code> actually does what I expect on negative numbers!"}, {"owner": {"reputation": 157, "user_id": 5521983, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fbfb4ad966e1ab171a9027954d47d428?s=128&d=identicon&r=PG&f=1", "display_name": "James Powell", "link": "https://stackoverflow.com/users/5521983/james-powell"}, "edited": false, "score": 0, "creation_date": 1447871378, "post_id": 33781409, "comment_id": 55342063, "body": "As a begginer in Haskell, I was not aware of <code>quotRem</code>. This is great, much simpler, thanks."}, {"owner": {"reputation": 9721, "user_id": 131057, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4d84023d355c712ca3a393881e862679?s=128&d=identicon&r=PG", "display_name": "Luka Rahne", "link": "https://stackoverflow.com/users/131057/luka-rahne"}, "edited": false, "score": 1, "creation_date": 1447872266, "post_id": 33781409, "comment_id": 55342594, "body": "I used <a href=\"https://www.haskell.org/hoogle/\" rel=\"nofollow noreferrer\">hoogle</a> to find div. Similar functions are usually listed together and <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#v:div\" rel=\"nofollow noreferrer\">prelude</a> lists <code>quotRem</code> in same section."}], "tags": [], "owner": {"reputation": 9721, "user_id": 131057, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4d84023d355c712ca3a393881e862679?s=128&d=identicon&r=PG", "display_name": "Luka Rahne", "link": "https://stackoverflow.com/users/131057/luka-rahne"}, "is_accepted": true, "score": 12, "last_activity_date": 1447853431, "creation_date": 1447853431, "answer_id": 33781409, "question_id": 33781107, "link": "https://stackoverflow.com/questions/33781107/haskell-more-efficient-way-to-complete-algorithm/33781409#33781409", "title": "Haskell - More efficient way to complete algorithm?", "body": "<p>I think somethink like this  </p>\n\n<pre><code>dayshoursmins x = (d,hr,mr) where\n (h,mr) = quotRem x 60\n (d,hr) = quotRem h 24\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 5521983, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fbfb4ad966e1ab171a9027954d47d428?s=128&d=identicon&r=PG&f=1", "display_name": "James Powell", "link": "https://stackoverflow.com/users/5521983/james-powell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 1, "accepted_answer_id": 33781409, "answer_count": 2, "score": 6, "last_activity_date": 1447872364, "creation_date": 1447852550, "last_edit_date": 1447872364, "question_id": 33781107, "link": "https://stackoverflow.com/questions/33781107/haskell-more-efficient-way-to-complete-algorithm", "title": "Haskell - More efficient way to complete algorithm?", "body": "<p>I have created an algorithm which takes a non-negative Int value, representing a total number of minutes, and returns a triple that gives (days, hours, minutes) that this corresponds to. </p>\n\n<p>Here is my code:</p>\n\n<pre><code>calcdays :: Int -&gt; Int\ncalcdays x = x `div` (24*60)\n\ncalchours :: Int -&gt; Int\ncalchours x = (x - ((calcdays x)*24*60)) `div` 60\n\ncalcmins :: Int -&gt; Int\ncalcmins x = (x - ((calcdays x)*24*60) - ((calchours x)*60))\n\ndayshoursmins :: Int -&gt; (Int,Int,Int)\ndayshoursmins x = (calcdays x, calchours x, calcmins x)\n</code></pre>\n\n<p>Using only basic Haskell operations (guards, divs, mods etc.), is there a more simple way of programming this function?</p>\n\n<p>EDIT:</p>\n\n<p>I have used a suggestion below to make this code simpler, while not as simple as the qoutRem solution, I thought I might post it:</p>\n\n<pre><code>calcdays :: Int -&gt; Int\ncalcdays x = x `div` (24*60)\n\ncalchours :: Int -&gt; Int\ncalchours x = (x `mod` (24*60)) `div` 60\n\ncalcmins :: Int -&gt; Int\ncalcmins x = (x `mod` (24*60)) `mod` 60\n\ndayshoursmins :: Int -&gt; (Int,Int,Int)\ndayshoursmins x = (calcdays x, calchours x, calcmins x)\n</code></pre>\n"}, {"tags": ["haskell", "memory-leaks", "sdl-2"], "comments": [{"owner": {"reputation": 865, "user_id": 664470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53821b46f4e74cdc9a01ef4263af98aa?s=128&d=identicon&r=PG", "display_name": "J&#233;r&#244;me Mahuet", "link": "https://stackoverflow.com/users/664470/j%c3%a9r%c3%b4me-mahuet"}, "edited": false, "score": 1, "creation_date": 1447857007, "post_id": 33780970, "comment_id": 55331936, "body": "I&#39;m not sure, but I think you don&#39;t deallocate surface, textures you create. For instance in Output/Renderer.hs you might try after the SDL.copy to SDL.freeSurface and SDL.destroyTexture"}, {"owner": {"reputation": 9, "user_id": 2050217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd5b33f697b61c96f8ccf66fa9c2f919?s=128&d=identicon&r=PG", "display_name": "flomerz", "link": "https://stackoverflow.com/users/2050217/flomerz"}, "reply_to_user": {"reputation": 865, "user_id": 664470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53821b46f4e74cdc9a01ef4263af98aa?s=128&d=identicon&r=PG", "display_name": "J&#233;r&#244;me Mahuet", "link": "https://stackoverflow.com/users/664470/j%c3%a9r%c3%b4me-mahuet"}, "edited": false, "score": 0, "creation_date": 1447858210, "post_id": 33780970, "comment_id": 55332927, "body": "Thanks :D This was really the problem. You are my hero :)"}, {"owner": {"reputation": 865, "user_id": 664470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53821b46f4e74cdc9a01ef4263af98aa?s=128&d=identicon&r=PG", "display_name": "J&#233;r&#244;me Mahuet", "link": "https://stackoverflow.com/users/664470/j%c3%a9r%c3%b4me-mahuet"}, "edited": false, "score": 1, "creation_date": 1447859762, "post_id": 33780970, "comment_id": 55334084, "body": "glad to help! Another improvement you can try: move the loading of textures at startup and store them in a datatype. So you only have to use SDL.copy and deallocate them when the game finish. Because right now you are recreating/destroying them all the time."}, {"owner": {"reputation": 9, "user_id": 2050217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd5b33f697b61c96f8ccf66fa9c2f919?s=128&d=identicon&r=PG", "display_name": "flomerz", "link": "https://stackoverflow.com/users/2050217/flomerz"}, "reply_to_user": {"reputation": 865, "user_id": 664470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/53821b46f4e74cdc9a01ef4263af98aa?s=128&d=identicon&r=PG", "display_name": "J&#233;r&#244;me Mahuet", "link": "https://stackoverflow.com/users/664470/j%c3%a9r%c3%b4me-mahuet"}, "edited": false, "score": 0, "creation_date": 1447860756, "post_id": 33780970, "comment_id": 55334855, "body": "Thanks for the tip. I&#39;m already working on it. I&#39;m open to all improvements :)"}], "owner": {"reputation": 9, "user_id": 2050217, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd5b33f697b61c96f8ccf66fa9c2f919?s=128&d=identicon&r=PG", "display_name": "flomerz", "link": "https://stackoverflow.com/users/2050217/flomerz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 194, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1447853961, "creation_date": 1447852185, "last_edit_date": 1447853961, "question_id": 33780970, "link": "https://stackoverflow.com/questions/33780970/haskell-sdl2-game-memory-leak", "title": "Haskell SDL2 Game - Memory Leak", "body": "<p>I want to make a small game in haskell with SDL2 and FRP Yampa.\nWhen I start the game the heap will constantly increase until the game freezes.</p>\n\n<p>I made some profile analysis with ghc, but I can't get any hints where the leak happens.</p>\n\n<p>The source is on github: <a href=\"https://github.com/flomerz/SchaffschNie\" rel=\"nofollow\">https://github.com/flomerz/SchaffschNie</a></p>\n\n<p>I am on Ubuntu 14.10 with GHC 7.10.</p>\n\n<pre><code>Running SchaffschNie-Prof...\n 106,883,930,776 bytes allocated in the heap\n     380,257,040 bytes copied during GC\n         301,240 bytes maximum residency (968 sample(s))\n          31,584 bytes maximum slop\n               2 MB total memory in use (0 MB lost due to fragmentation)\n\n                                     Tot time (elapsed)  Avg pause  Max pause\n  Gen  0     206180 colls,     0 par    1.152s   1.075s     0.0000s    0.0022s\n  Gen  1       968 colls,     0 par    0.508s   0.736s     0.0008s    0.1118s\n\n  TASKS: 4 (1 bound, 3 peak workers (3 total), using -N1)\n\n  SPARKS: 0 (0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)\n\n  INIT    time    0.000s  (  0.001s elapsed)\n  MUT     time   84.876s  (108.001s elapsed)\n  GC      time    1.476s  (  1.440s elapsed)\n  RP      time    0.000s  (  0.000s elapsed)\n  PROF    time    0.184s  (  0.371s elapsed)\n  EXIT    time    0.000s  (  0.002s elapsed)\n  Total   time   86.536s  (109.445s elapsed)\n\n  Alloc rate    1,259,295,098 bytes per MUT second\n\n  Productivity  98.1% of total user, 77.6% of total elapsed\n</code></pre>\n\n<p>Here are some graphs:\n<a href=\"http://i.stack.imgur.com/1DBvp.png\" rel=\"nofollow\">System Monitor &amp; GHC Profile</a></p>\n\n<p>Thanks for any suggestions.</p>\n"}, {"tags": ["haskell", "enums"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1447861999, "post_id": 33779653, "comment_id": 55335866, "body": "Pretty much any <i>exported</i> <code>Enum</code> should also derive <code>Eq</code>, <code>Ord</code>, <code>Show</code>, and <code>Read</code>. At some point, you may want to add <code>Generic</code> to that list."}], "answers": [{"tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": true, "score": 8, "last_activity_date": 1447848545, "creation_date": 1447848545, "answer_id": 33779685, "question_id": 33779653, "link": "https://stackoverflow.com/questions/33779653/haskell-enum-comparison/33779685#33779685", "title": "Haskell Enum Comparison", "body": "<p>This is as simple as it gets: add the <code>Eq</code> instance to the derived instances list:</p>\n\n<pre><code>data Direction = Clockwise | CounterClockwise deriving (Enum, Eq)\n</code></pre>\n"}], "owner": {"reputation": 592, "user_id": 3316743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1a08a39cba22c52c9509de7052e95ac6?s=128&d=identicon&r=PG", "display_name": "JamesFrost", "link": "https://stackoverflow.com/users/3316743/jamesfrost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 853, "favorite_count": 0, "accepted_answer_id": 33779685, "answer_count": 1, "score": 5, "last_activity_date": 1447848545, "creation_date": 1447848447, "question_id": 33779653, "link": "https://stackoverflow.com/questions/33779653/haskell-enum-comparison", "title": "Haskell Enum Comparison", "body": "<p>I've defined an enum:</p>\n\n<pre><code>data Direction = Clockwise | CounterClockwise deriving (Enum)\n</code></pre>\n\n<p>Variable 'direction' has type 'Direction'. When doing the following comparison:</p>\n\n<pre><code>direction == Clockwise\n</code></pre>\n\n<p>I'm getting this error:</p>\n\n<pre><code>  No instance for (Eq OrbitDirection) arising from a use of `=='\n  In the expression: direction == Clockwise\n</code></pre>\n"}, {"tags": ["haskell", "ghc", "ghc-api"], "answers": [{"tags": [], "owner": {"reputation": 15, "user_id": 1245646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36582a8c3e22dbedb88af80d956140c8?s=128&d=identicon&r=PG", "display_name": "Stephen Adams", "link": "https://stackoverflow.com/users/1245646/stephen-adams"}, "is_accepted": false, "score": 1, "last_activity_date": 1453833425, "creation_date": 1453833425, "answer_id": 35021284, "question_id": 33779403, "link": "https://stackoverflow.com/questions/33779403/get-the-renamed-with-fully-qualified-import-haskell-ast-using-ghc-api/35021284#35021284", "title": "get the renamed (with fully qualified import) haskell AST using ghc api", "body": "<p>From: <a href=\"https://wiki.haskell.org/GHC/As_a_library#Another_example\" rel=\"nofollow\">https://wiki.haskell.org/GHC/As_a_library#Another_example</a></p>\n\n<p><code>ghcmake = defaultErrorHandler defaultFatalMessager defaultFlushOut $ do\n  runGhc (Just GP.libdir) $ do\n    dflags &lt;- getSessionDynFlags\n    setSessionDynFlags dflags\n    target &lt;- guessTarget targetFile Nothing\n    setTargets [target]\n    load LoadAllTargets\n    modSum &lt;- getModSummary $ mkModuleName \"&lt;Your module name here&gt;\" \n    p &lt;- parseModule modSum\n    t &lt;- typecheckModule p\n    let (Just renamedSource) = tm_renamed_source t</code></p>\n\n<p>After your example code you need to get the module summary for the module you want to parse. Then you need to actually run the parser and the typechecker. Finally you can retrieve the renamed AST from the typechecked result.</p>\n"}], "owner": {"reputation": 478, "user_id": 4079111, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e4775c2984de42fca587c03065107de1?s=128&d=identicon&r=PG&f=1", "display_name": "doofin", "link": "https://stackoverflow.com/users/4079111/doofin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1453833425, "creation_date": 1447847675, "last_edit_date": 1447850972, "question_id": 33779403, "link": "https://stackoverflow.com/questions/33779403/get-the-renamed-with-fully-qualified-import-haskell-ast-using-ghc-api", "title": "get the renamed (with fully qualified import) haskell AST using ghc api", "body": "<p>I can get the following ghc compiler working using ghc api to compile a single file.I would like to get the renamed AST of haskell source (AST with all function calls fully qualified)</p>\n\n<pre><code>ghcmake = defaultErrorHandler defaultFatalMessager defaultFlushOut $ do\n  runGhc (Just GP.libdir) $ do\n    dflags &lt;- getSessionDynFlags\n    setSessionDynFlags dflags\n    target &lt;- guessTarget targetFile Nothing\n    setTargets [target]\n    load LoadAllTargets\n</code></pre>\n\n<p>From this simple demo,the renaming process ought be done in \"load\" function.</p>\n\n<p>the source is here</p>\n\n<p>(file:///usr/local/haskell/ghc-7.10.2-x86_64/share/doc/ghc/html/libraries/ghc-7.10.2/src/GhcMake.html#load)</p>\n\n<pre><code>load :: GhcMonad m =&gt; LoadHowMuch -&gt; m SuccessFlag Source\n</code></pre>\n\n<blockquote>\n  <p>This function implements the core of GHC's --make mode. It\n  preprocesses, compiles and loads the specified modules, avoiding\n  re-compilation wherever possible. Depending on the target (see\n  hscTarget) compilating and loading may result in files being created\n  on disk.</p>\n</blockquote>\n\n<pre><code>load :: GhcMonad m =&gt; LoadHowMuch -&gt; m SuccessFlag\nload how_much = do\n    mod_graph &lt;- depanal [] False\n    guessOutputFile\n    hsc_env &lt;- getSession\n\n    let hpt1   = hsc_HPT hsc_env\n    let dflags = hsc_dflags hsc_env\n\n    -- The \"bad\" boot modules are the ones for which we have\n    -- B.hs-boot in the module graph, but no B.hs\n    -- The downsweep should have ensured this does not happen\n    -- (see msDeps)\n    let all_home_mods = [ms_mod_name s\n                        | s &lt;- mod_graph, not (isBootSummary s)]\n        bad_boot_mods = [s        | s &lt;- mod_graph, isBootSummary s,\n                                    not (ms_mod_name s `elem` all_home_mods)]\n    ASSERT( null bad_boot_mods ) return ()\n\n    -- check that the module given in HowMuch actually exists, otherwise\n    -- topSortModuleGraph will bomb later.\n    let checkHowMuch (LoadUpTo m)           = checkMod m\n        checkHowMuch (LoadDependenciesOf m) = checkMod m\n        checkHowMuch _ = id\n\n        checkMod m and_then\n            | m `elem` all_home_mods = and_then\n            | otherwise = do\n                    liftIO $ errorMsg dflags (text \"no such module:\" &lt;+&gt;\n                                     quotes (ppr m))\n                    return Failed\n\n    checkHowMuch how_much $ do\n\n    -- mg2_with_srcimps drops the hi-boot nodes, returning a\n    -- graph with cycles.  Among other things, it is used for\n    -- backing out partially complete cycles following a failed\n    -- upsweep, and for removing from hpt all the modules\n    -- not in strict downwards closure, during calls to compile.\n    let mg2_with_srcimps :: [SCC ModSummary]\n        mg2_with_srcimps = topSortModuleGraph True mod_graph Nothing\n\n    -- If we can determine that any of the {-# SOURCE #-} imports\n    -- are definitely unnecessary, then emit a warning.\n    warnUnnecessarySourceImports mg2_with_srcimps\n\n    let\n        -- check the stability property for each module.\n        stable_mods@(stable_obj,stable_bco)\n            = checkStability hpt1 mg2_with_srcimps all_home_mods\n\n        -- prune bits of the HPT which are definitely redundant now,\n        -- to save space.\n        pruned_hpt = pruneHomePackageTable hpt1\n                            (flattenSCCs mg2_with_srcimps)\n                            stable_mods\n\n    _ &lt;- liftIO $ evaluate pruned_hpt\n\n    -- before we unload anything, make sure we don't leave an old\n    -- interactive context around pointing to dead bindings.  Also,\n    -- write the pruned HPT to allow the old HPT to be GC'd.\n    modifySession $ \\_ -&gt; discardIC $ hsc_env { hsc_HPT = pruned_hpt }\n\n    liftIO $ debugTraceMsg dflags 2 (text \"Stable obj:\" &lt;+&gt; ppr stable_obj $$\n                            text \"Stable BCO:\" &lt;+&gt; ppr stable_bco)\n\n    -- Unload any modules which are going to be re-linked this time around.\n    let stable_linkables = [ linkable\n                           | m &lt;- stable_obj++stable_bco,\n                             Just hmi &lt;- [lookupUFM pruned_hpt m],\n                             Just linkable &lt;- [hm_linkable hmi] ]\n    liftIO $ unload hsc_env stable_linkables\n\n    -- We could at this point detect cycles which aren't broken by\n    -- a source-import, and complain immediately, but it seems better\n    -- to let upsweep_mods do this, so at least some useful work gets\n    -- done before the upsweep is abandoned.\n    --hPutStrLn stderr \"after tsort:\\n\"\n    --hPutStrLn stderr (showSDoc (vcat (map ppr mg2)))\n\n    -- Now do the upsweep, calling compile for each module in\n    -- turn.  Final result is version 3 of everything.\n\n    -- Topologically sort the module graph, this time including hi-boot\n    -- nodes, and possibly just including the portion of the graph\n    -- reachable from the module specified in the 2nd argument to load.\n    -- This graph should be cycle-free.\n    -- If we're restricting the upsweep to a portion of the graph, we\n    -- also want to retain everything that is still stable.\n    let full_mg :: [SCC ModSummary]\n        full_mg    = topSortModuleGraph False mod_graph Nothing\n\n        maybe_top_mod = case how_much of\n                            LoadUpTo m           -&gt; Just m\n                            LoadDependenciesOf m -&gt; Just m\n                            _                    -&gt; Nothing\n\n        partial_mg0 :: [SCC ModSummary]\n        partial_mg0 = topSortModuleGraph False mod_graph maybe_top_mod\n\n        -- LoadDependenciesOf m: we want the upsweep to stop just\n        -- short of the specified module (unless the specified module\n        -- is stable).\n        partial_mg\n            | LoadDependenciesOf _mod &lt;- how_much\n            = ASSERT( case last partial_mg0 of\n                        AcyclicSCC ms -&gt; ms_mod_name ms == _mod; _ -&gt; False )\n              List.init partial_mg0\n            | otherwise\n            = partial_mg0\n\n        stable_mg =\n            [ AcyclicSCC ms\n            | AcyclicSCC ms &lt;- full_mg,\n              ms_mod_name ms `elem` stable_obj++stable_bco ]\n\n        -- the modules from partial_mg that are not also stable\n        -- NB. also keep cycles, we need to emit an error message later\n        unstable_mg = filter not_stable partial_mg\n          where not_stable (CyclicSCC _) = True\n                not_stable (AcyclicSCC ms)\n                   = ms_mod_name ms `notElem` stable_obj++stable_bco\n\n        -- Load all the stable modules first, before attempting to load\n        -- an unstable module (#7231).\n        mg = stable_mg ++ unstable_mg\n\n    -- clean up between compilations\n    let cleanup hsc_env = intermediateCleanTempFiles (hsc_dflags hsc_env)\n                              (flattenSCCs mg2_with_srcimps)\n                              hsc_env\n\n    liftIO $ debugTraceMsg dflags 2 (hang (text \"Ready for upsweep\")\n                               2 (ppr mg))\n\n    n_jobs &lt;- case parMakeCount dflags of\n                    Nothing -&gt; liftIO getNumProcessors\n                    Just n  -&gt; return n\n    let upsweep_fn | n_jobs &gt; 1 = parUpsweep n_jobs\n                   | otherwise  = upsweep\n\n    setSession hsc_env{ hsc_HPT = emptyHomePackageTable }\n    (upsweep_ok, modsUpswept)\n       &lt;- upsweep_fn pruned_hpt stable_mods cleanup mg\n\n    -- Make modsDone be the summaries for each home module now\n    -- available; this should equal the domain of hpt3.\n    -- Get in in a roughly top .. bottom order (hence reverse).\n\n    let modsDone = reverse modsUpswept\n\n    -- Try and do linking in some form, depending on whether the\n    -- upsweep was completely or only partially successful.\n\n    if succeeded upsweep_ok\n\n     then\n       -- Easy; just relink it all.\n       do liftIO $ debugTraceMsg dflags 2 (text \"Upsweep completely successful.\")\n\n          -- Clean up after ourselves\n          hsc_env1 &lt;- getSession\n          liftIO $ intermediateCleanTempFiles dflags modsDone hsc_env1\n\n          -- Issue a warning for the confusing case where the user\n          -- said '-o foo' but we're not going to do any linking.\n          -- We attempt linking if either (a) one of the modules is\n          -- called Main, or (b) the user said -no-hs-main, indicating\n          -- that main() is going to come from somewhere else.\n          --\n          let ofile = outputFile dflags\n          let no_hs_main = gopt Opt_NoHsMain dflags\n          let\n            main_mod = mainModIs dflags\n            a_root_is_Main = any ((==main_mod).ms_mod) mod_graph\n            do_linking = a_root_is_Main || no_hs_main || ghcLink dflags == LinkDynLib || ghcLink dflags == LinkStaticLib\n\n          when (ghcLink dflags == LinkBinary\n                &amp;&amp; isJust ofile &amp;&amp; not do_linking) $\n            liftIO $ debugTraceMsg dflags 1 $\n                text (\"Warning: output was redirected with -o, \" ++\n                      \"but no output will be generated\\n\" ++\n                      \"because there is no \" ++\n                      moduleNameString (moduleName main_mod) ++ \" module.\")\n\n          -- link everything together\n          linkresult &lt;- liftIO $ link (ghcLink dflags) dflags do_linking (hsc_HPT hsc_env1)\n\n          loadFinish Succeeded linkresult\n</code></pre>\n\n<p>The code snippet above checks that the module dependency is ok,but after that  it seems to jump directly to linking?? and i can not find where the <strong>link</strong> function is.</p>\n\n<pre><code>linkresult &lt;- liftIO $ link (ghcLink dflags) dflags do_linking (hsc_HPT hsc_env1)\n\n  loadFinish Succeeded linkresult\n</code></pre>\n\n<p>relevant posts:</p>\n\n<p><a href=\"https://mistuke.wordpress.com/category/vsx/\" rel=\"nofollow\">https://mistuke.wordpress.com/category/vsx/</a></p>\n"}, {"tags": ["loops", "haskell", "sequential", "feedback", "circuit"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1447834042, "post_id": 33774433, "comment_id": 55315985, "body": "on first glance this seems to do the trick: <code>circuit switch input t = if switch then input t else input (t-1)</code> ... it has 2 inputs, and it should obey your laws (of course I assume that the last part <code>output (t) = output (t-1)</code> is a typo)"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1447834214, "post_id": 33774433, "comment_id": 55316061, "body": "@Carsten, oh, of course, very elegant!"}, {"owner": {"reputation": 304, "user_id": 4801494, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/w61dU.jpg?s=128&g=1", "display_name": "fayong lin", "link": "https://stackoverflow.com/users/4801494/fayong-lin"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1447834719, "post_id": 33774433, "comment_id": 55316320, "body": "@Carsten, it is not a typo, I want my circuit to return at a given time it&#39;s previous output if the switch is off, and the current input (which then will become it&#39;s new stored value) when the switch is on. The difficulty comes from the need of a feedback loop and for a way to store a state."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1447837403, "post_id": 33774433, "comment_id": 55317905, "body": "Sorry I misunderstood your <code>t</code> (which obviously stand for time) - but alas you have an great answer already :D"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1447885782, "post_id": 33774433, "comment_id": 55350469, "body": "I&#39;m not sure what you mean by  &quot;on  the fly&quot;.  You mean you have some real time input?  Fwiw this is what FRP was invented for."}, {"owner": {"reputation": 304, "user_id": 4801494, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/w61dU.jpg?s=128&g=1", "display_name": "fayong lin", "link": "https://stackoverflow.com/users/4801494/fayong-lin"}, "edited": false, "score": 0, "creation_date": 1447900843, "post_id": 33774433, "comment_id": 55355378, "body": "Actually  it&#39;s looking into Yampa that gave me the idea for this. The interface it provides is very nice and indeed seems well suited for this sort of thing, but to me the implementation is a black box. I wanted to get an intuition about how to build this kind of thing. For now I think the model I built below using the State monad gives me the degree of flexibility I want (the state is available to look at, and different &quot;circuits&quot; can be combined together into a stateful computation), while staying at a level of abstraction simple enough that I can understand the underlying plumbing."}, {"owner": {"reputation": 304, "user_id": 4801494, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/w61dU.jpg?s=128&g=1", "display_name": "fayong lin", "link": "https://stackoverflow.com/users/4801494/fayong-lin"}, "edited": false, "score": 0, "creation_date": 1447900850, "post_id": 33774433, "comment_id": 55355382, "body": "I will definetely keep looking into FRP though."}], "answers": [{"comments": [{"owner": {"reputation": 304, "user_id": 4801494, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/w61dU.jpg?s=128&g=1", "display_name": "fayong lin", "link": "https://stackoverflow.com/users/4801494/fayong-lin"}, "edited": false, "score": 0, "creation_date": 1447837093, "post_id": 33774682, "comment_id": 55317711, "body": "I think this models the behaviour I was trying to achieve"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 304, "user_id": 4801494, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/w61dU.jpg?s=128&g=1", "display_name": "fayong lin", "link": "https://stackoverflow.com/users/4801494/fayong-lin"}, "edited": false, "score": 0, "creation_date": 1447837543, "post_id": 33774682, "comment_id": 55317999, "body": "@fayonglin it&#39;s really difficult to read that way - maybe you could edit your question instead?"}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 7, "last_activity_date": 1447834154, "creation_date": 1447834154, "answer_id": 33774682, "question_id": 33774433, "link": "https://stackoverflow.com/questions/33774433/sequential-circuit-with-feedack-loop-in-haskell/33774682#33774682", "title": "Sequential circuit with feedack loop in Haskell", "body": "<p>For what it's worth: this problem is a very good fit for some of Haskell's unique and powerful abstractions such as <code>Monad</code> and <code>Arrow</code>.  But those take time and experience to learn, and I'm guessing by your wording that you aren't very familiar with them.  If you stay with Haskell, I suggest revisiting this problem again in the future for an enlightenment.  I will not spend more time on such things.</p>\n\n<p>You can model a discrete time-varying signal simply by an infinite list:</p>\n\n<pre><code>type Signal a = [a]\n\nzeroS, oneS :: Signal Bool\nzeroS = repeat False\noneS  = repeat True\n</code></pre>\n\n<p>You can combine signals pointwise using <code>zipWith</code>.  For example:</p>\n\n<pre><code>andS :: Signal Bool -&gt; Signal Bool -&gt; Signal Bool\nandS = zipWith (&amp;&amp;)\n\nghci&gt; andS zeroS oneS\n[False,False,False,False,False,False,False,False,...\n</code></pre>\n\n<p>You can delay a signal by 1 unit of time by consing on the beginning of the list. This requires an initial value for the signal to take.</p>\n\n<pre><code>delay :: a -&gt; Signal a -&gt; Signal a\ndelay x s = x : s\n-- or just\n-- delay = (:)\n</code></pre>\n\n<p>In your problem you describe a function with this type:</p>\n\n<pre><code>circuit :: Signal Bool -&gt; Signal Bool -&gt; Signal Bool\ncircuit switch input = ...\n</code></pre>\n\n<p>which you can build using these concepts and recursion.  Good luck!</p>\n"}, {"tags": [], "owner": {"reputation": 304, "user_id": 4801494, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/w61dU.jpg?s=128&g=1", "display_name": "fayong lin", "link": "https://stackoverflow.com/users/4801494/fayong-lin"}, "is_accepted": true, "score": 0, "last_activity_date": 1447842072, "creation_date": 1447842072, "answer_id": 33777412, "question_id": 33774433, "link": "https://stackoverflow.com/questions/33774433/sequential-circuit-with-feedack-loop-in-haskell/33777412#33777412", "title": "Sequential circuit with feedack loop in Haskell", "body": "<p>Ok I think I finally got how to use the State Monad for this.</p>\n\n<pre><code>Import Control.Monad.State\n\ntype Stored a = a\ntype Input a = a\ntype Output a = a\ntype Switch = Bool\n\ncircuit :: Input a -&gt; Switch -&gt; State (Output a) (Stored a)\ncircuit input switch = \n    do store &lt;- get\n       if switch\n       then put input &gt;&gt; return input\n       else return store\n\nexample1 = do circuit 0 False\n              circuit 2 False\n              circuit 3 False\n\nres1 = runState example1 $ 4\n\nloopCircuit :: [(Input a, Switch)] -&gt; State (Output a) [(Stored a)]\nloopCircuit [] = return []\nloopCircuit ((i,s):xs) = \n    do v  &lt;- circuit i s \n       vs &lt;- loopCircuit xs\n       return (v:vs)\n\nexample2 = runState (loopCircuit [(0,True),(2,False),(3,True)]) 4\n</code></pre>\n\n<p>The <code>circuit</code> function can work on discrete inputs, while <code>loopCircuit</code> can work on a stream of inputs.</p>\n\n<pre><code>res1 = (4,4)\nexample2 = ([0,0,3],3)\n</code></pre>\n"}], "owner": {"reputation": 304, "user_id": 4801494, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/w61dU.jpg?s=128&g=1", "display_name": "fayong lin", "link": "https://stackoverflow.com/users/4801494/fayong-lin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 33777412, "answer_count": 2, "score": 1, "last_activity_date": 1447842072, "creation_date": 1447833158, "last_edit_date": 1447837851, "question_id": 33774433, "link": "https://stackoverflow.com/questions/33774433/sequential-circuit-with-feedack-loop-in-haskell", "title": "Sequential circuit with feedack loop in Haskell", "body": "<p>I would like to represent a circuit with the following behaviour in Haskell:</p>\n\n<p>The circuit has two inputs :</p>\n\n<ul>\n<li>a data input</li>\n<li>and a switch input </li>\n</ul>\n\n<p>and one output.</p>\n\n<ul>\n<li>When the switch = <code>True</code> then output <sub>t</sub> = input <sub>t</sub></li>\n<li>when switch = <code>False</code>, output <sub>t</sub> = output <sub>t-1</sub></li>\n</ul>\n\n<p>I need a way to represent the feedback loop, and the state. </p>\n\n<p>I know there is several libraries providing abstractions for this sort of thing, but they look like magic to me.</p>\n\n<p>Is there a simple way to model this?</p>\n\n<p>Edit: </p>\n\n<pre><code>type Signal a = [a]\n\ntype Input   = Signal Int\ntype Output  = Signal Int\ntype State   = Int\ntype Switch = Signal Bool\n\ndelay :: a -&gt; Signal a -&gt; Signal a\ndelay = (:)\n\ncircuit :: State -&gt; Input -&gt; Switch -&gt; Output\ncircuit s (i:is) (True:bs) =  i : circuit i is bs\ncircuit s (i:is) (False:bs) = s : circuit s is bs\n</code></pre>\n\n<p>I used streams to represent the signals, and I carry the state around explicitly in s. But what if I wanted to extract (look at) the elements in the output stream on the fly? </p>\n\n<p>It looks like a problem that the State Monad would solve but I can't find a way to represent it.</p>\n"}, {"tags": ["haskell", "types", "maybe"], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 9, "creation_date": 1447835204, "post_id": 33773218, "comment_id": 55316575, "body": "This is a very dangerous tool for such a task, since it crashes the whole program if it happens to find <code>Nothing</code>. Code such as <code>if isJust ... then fromJust ... else ....</code> is not idiomatic in Haskell, and should be not suggested since safe alternatives do exist."}, {"owner": {"reputation": 8858, "user_id": 186026, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/q1xfe.png?s=128&g=1", "display_name": "fjarri", "link": "https://stackoverflow.com/users/186026/fjarri"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1447836663, "post_id": 33773218, "comment_id": 55317430, "body": "I did not suggest this code. What I suggested was 1) a function with the signature OP wanted; 2) a way to find functions by signature in future. I know nothing of what OP wants to do with it; it&#39;s perfectly fine to use it e.g. on a hardcoded map where you know the key you requested exists, and if it doesn&#39;t it should be filled in."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1447881615, "post_id": 33773218, "comment_id": 55348241, "body": "Hoogle is always a good suggestion, yet as already said in this case its result is more harm- than helpful, so it should only be a comment with big caveat."}, {"owner": {"reputation": 8858, "user_id": 186026, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/q1xfe.png?s=128&g=1", "display_name": "fjarri", "link": "https://stackoverflow.com/users/186026/fjarri"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1447882048, "post_id": 33773218, "comment_id": 55348495, "body": "@leftaroundabout: no, it shouldn&#39;t be a comment, because it answers the question. If you don&#39;t like it, don&#39;t upvote/accept it. There is no caveat, the error-throwing behavior is clearly documented. I honestly don&#39;t understand all this hate for <code>fromJust</code>, there are plenty of cases where throwing an error is an acceptable and logical thing to do."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1447883096, "post_id": 33773218, "comment_id": 55349105, "body": "@fjarri: throwing an error is seldom a good idea, except when you&#39;re already in the <code>IO</code> monad (only there can errors properly be caught), or if you just want to add an \u201cidiot proof\u201d assertion that really should never fire unless triggered by some bug. Even so: for exceptions that aren&#39;t really all that exceptional, a proper <code>Either</code>/<code>ErrorT</code> type is the way to go. And assertions should also give some useful debug information, which <code>fromJust</code> scarcely does. A non-exhaustive pattern match will give a much more helpful error message."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1447883146, "post_id": 33773218, "comment_id": 55349133, "body": "And finally: using partial functions is just completely unnecessary here! A proper exhaustive pattern match, as shown by Danial Wagner, is better <i>in every regard</i>."}], "tags": [], "owner": {"reputation": 8858, "user_id": 186026, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/q1xfe.png?s=128&g=1", "display_name": "fjarri", "link": "https://stackoverflow.com/users/186026/fjarri"}, "is_accepted": true, "score": 2, "last_activity_date": 1447828197, "creation_date": 1447828197, "answer_id": 33773218, "question_id": 33773155, "link": "https://stackoverflow.com/questions/33773155/extracting-x-from-just-x-in-a-maybe/33773218#33773218", "title": "Extracting x from (Just x) in a Maybe", "body": "<p>There is a standard function with this signature, <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Maybe.html#v:fromJust\" rel=\"nofollow\"><code>fromJust</code></a>.</p>\n\n<p>Use Hoogle for searches like this one, <a href=\"https://www.haskell.org/hoogle/?hoogle=Maybe+a+-%3E+a\" rel=\"nofollow\">it's a wonderful tool</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 8858, "user_id": 186026, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/q1xfe.png?s=128&g=1", "display_name": "fjarri", "link": "https://stackoverflow.com/users/186026/fjarri"}, "edited": false, "score": 0, "creation_date": 1447828440, "post_id": 33773246, "comment_id": 55313476, "body": "Wouldn&#39;t it be more idiomatic if you had two instances for different constructors, like <code>seeMyVal Nothing = ...</code> and <code>seeMyVal (Just val) = ...</code>?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 8858, "user_id": 186026, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/q1xfe.png?s=128&g=1", "display_name": "fjarri", "link": "https://stackoverflow.com/users/186026/fjarri"}, "edited": false, "score": 1, "creation_date": 1447829174, "post_id": 33773246, "comment_id": 55313776, "body": "@fjarri Not more idiomatic, I think, just different: that would define a function, whereas this defines a plain old <code>IO ()</code> action."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 20, "last_activity_date": 1447828329, "creation_date": 1447828329, "answer_id": 33773246, "question_id": 33773155, "link": "https://stackoverflow.com/questions/33773155/extracting-x-from-just-x-in-a-maybe/33773246#33773246", "title": "Extracting x from (Just x) in a Maybe", "body": "<p>The idiomatic way is to pattern match.</p>\n\n<pre><code>seeMyVal = case getVal of\n    Nothing  -&gt; putStrLn \"Nothing to see here\"\n    Just val -&gt; putStrLn val\n</code></pre>\n\n<p>If you like, you can factor the <code>putStrLn</code> out:</p>\n\n<pre><code>seeMyVal = putStrLn $ case getVal of\n    Nothing  -&gt; \"Nothing to see here\"\n    Just val -&gt; val\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 121, "user_id": 863770, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6c3088844ddd026b3caffc2d2728d32b?s=128&d=identicon&r=PG", "display_name": "robertjflong", "link": "https://stackoverflow.com/users/863770/robertjflong"}, "is_accepted": false, "score": 10, "last_activity_date": 1447829200, "creation_date": 1447829200, "answer_id": 33773463, "question_id": 33773155, "link": "https://stackoverflow.com/questions/33773155/extracting-x-from-just-x-in-a-maybe/33773463#33773463", "title": "Extracting x from (Just x) in a Maybe", "body": "<p>You can also use <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Maybe.html#v:fromMaybe\">fromMaybe</a>, which takes a default.</p>\n\n<p><code>fromMaybe \"Nothing to see here...\" (Just \"I'm real!\")\n</code></p>\n"}], "owner": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1039, "favorite_count": 0, "closed_date": 1447906886, "accepted_answer_id": 33773218, "answer_count": 3, "score": 4, "last_activity_date": 1447878623, "creation_date": 1447827945, "last_edit_date": 1447878623, "question_id": 33773155, "link": "https://stackoverflow.com/questions/33773155/extracting-x-from-just-x-in-a-maybe", "closed_reason": "Duplicate", "title": "Extracting x from (Just x) in a Maybe", "body": "<p>Super simple I'm sure, but I can't seem to find the answer.  I call a function that returns <code>Maybe x</code> and I want to see <code>x</code>.  How to I extract <code>x</code> from my <code>Just x</code> response?</p>\n\n<pre><code>seeMyVal :: IO ()\nseeMyVal = do\n   if getVal == Nothing \n   then do\n       putStrLn \"Nothing to see here\"\n   else do\n       putStrLn getVal -- what do I have to change in this line?\n\ngetVal :: (Maybe String)\ngetVal = Just \"Yes, I'm real!\"\n</code></pre>\n\n<p>This throws the error:</p>\n\n<pre><code>Couldn't match type \u2018Maybe String\u2019 with \u2018[Char]\u2019\nExpected type: String\n  Actual type: Maybe String\nIn the first argument of \u2018putStrLn\u2019, namely \u2018getVal\u2019\nIn a stmt of a 'do' block: putStrLn getVal\n</code></pre>\n"}, {"tags": ["algorithm", "haskell"], "answers": [{"tags": [], "owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "is_accepted": false, "score": 10, "last_activity_date": 1447817360, "creation_date": 1447817360, "answer_id": 33771325, "question_id": 33771218, "link": "https://stackoverflow.com/questions/33771218/haskell-c-stack-overflow/33771325#33771325", "title": "Haskell - C stack overflow", "body": "<p>Its an operator precedence problem. In Haskell, function application has the highest possible precedence. Thus when you write <code>sumint x - 2</code>, even though you are interpreting it as <code>sumint (x-2)</code>, Haskell is interpreting it as <code>(sumint x) - 2</code>. Thus -- you are trying to define <code>sumint x</code> directly in terms of <code>sumint x</code> -- which just piles up recursive function calls until the stack overflows. You need to add explicit parentheses if you want the subtraction evaluated before the function application. </p>\n"}, {"comments": [{"owner": {"reputation": 1178, "user_id": 1667161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233658d12fabd9d72b04d0a6916f6389?s=128&d=identicon&r=PG", "display_name": "liminalisht", "link": "https://stackoverflow.com/users/1667161/liminalisht"}, "edited": false, "score": 0, "creation_date": 1447871807, "post_id": 33771429, "comment_id": 55342306, "body": "Tiny detail: <code>go</code> should be replaced with <code>(+)</code> in the definition of <code>sumint</code> that uses <code>foldl&#39;</code>. I would make this edit but the change is fewer than 6 characters."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 12, "last_activity_date": 1447871893, "last_edit_date": 1447871893, "creation_date": 1447818076, "answer_id": 33771429, "question_id": 33771218, "link": "https://stackoverflow.com/questions/33771218/haskell-c-stack-overflow/33771429#33771429", "title": "Haskell - C stack overflow", "body": "<p><strong>Initial Error: Infinite Recursion</strong></p>\n\n<p>Stepping through your code:</p>\n\n<pre><code>sumint :: Int -&gt; Int\n</code></pre>\n\n<p>Hey, a type signature.  You rock.</p>\n\n<pre><code>sumint x\n  | x==0 = 0\n</code></pre>\n\n<p>A base case, cool.</p>\n\n<pre><code>  | x==1 = 1\n</code></pre>\n\n<p>A totally unnecessary case.  OK, sure... except.  1 is not even so why are we including it in the sum?  It should be zero (or removed completely).</p>\n\n<pre><code>  | (x `mod` 2 == 0) &amp;&amp; (x &gt;= 2) = x + (sumint x-2)\n</code></pre>\n\n<p>The meat of the issue is here.  1. X is even - great.  2. X is positive, yep. The  result is <code>x + (sumint x) - 2</code>  No!</p>\n\n<ul>\n<li>Error 1: Notice function application binds tigher than operators so this should be <code>x + sumint (x-2)</code>.</li>\n</ul>\n\n<p>This is the reason for your stack overflow.  <code>sumint 2 == 2 + (sumint 2) - 2 + (sumint 2) -2 + (sumint 2) -2 + ...</code>, yay infinite recursion.</p>\n\n<pre><code>  | (x `mod` 2 /= 0) &amp;&amp; (x &gt;= 1) = x + (sumint x-1)\n</code></pre>\n\n<p>Another case... odds... positive... but why are we adding in x?  You want to add evens, not odds.  So fixing the above issue at the same time we get:</p>\n\n<ul>\n<li>Error 2: If you determine <code>x</code> is odd, don't add in <code>x</code>.  Just use <code>sumint (x-1)</code>.</li>\n</ul>\n\n<p>Then you are out of cases. What happens if x is not positive?  You need (another) case.</p>\n\n<pre><code>| otherwise = 0\n</code></pre>\n\n<p><strong>Next Issue: No Accumulation</strong></p>\n\n<p>The problem now is you are building up a large thunk (unevaluated computation) instead of operating in constant space by accumulating the result as you progress.  Notice if we expand your computation for, say, 6 we get:</p>\n\n<pre><code>sumint 6 = 6 + sumint (6-2) \n      = 6 + 4 + sumint (4-2)\n      = 6 + 4 + 2 + sumint (2-2)\n      = 6 + 4 + 2 + 0\n</code></pre>\n\n<p>You really don't want to keep all those additions separate, it would be good to pass in an accumulator such as:</p>\n\n<pre><code>sumint x = go x 0\n where\n  go n accumulator\n         | n &lt;= 0    = accumulator\n         | odd n     = go (n-1) accumulator\n         | otherwise = go (n-2) (accumulator + n)\n</code></pre>\n\n<p>Side note: Other stackoverflow citizens might mention making the accumulator strict, which is good form.  I don't want to distract the current asker with that discussion here.  Notice using optimization, <code>-O2</code>, does suffice.</p>\n\n<p><strong>Idiomatic Solutions</strong></p>\n\n<p>All the above solutions are rather verbose.  The general operation, iterating over a list with a function and accumulator, is a type of <code>fold</code>.  Fold's are one of the many highly optimized structure traversals common in functional programming.  In this case a \"strict left fold\" is the typical candidate (from <code>Data.List</code>).  That is <code>foldl'</code>' the prime (<code>'</code>) by convention means it is strict  while the <code>l</code> means left.</p>\n\n<pre><code>sumint n = foldl' (+) 0 [val | val &lt;- [0..n], even val]\n</code></pre>\n\n<p>Here we folded over the list to get our sum.  To create the list of interest we used list comprehension - first enumerating the values from <code>0..n</code> and skipping any value that does not meet the predicate <code>even</code>.</p>\n\n<p>We can further clean this up and improve it by using the <code>sum</code> function and list comprehension that steps by 2, thus giving us only the evens you desire:</p>\n\n<pre><code>sumint n = sum [0,2..n]\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 5521983, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/fbfb4ad966e1ab171a9027954d47d428?s=128&d=identicon&r=PG&f=1", "display_name": "James Powell", "link": "https://stackoverflow.com/users/5521983/james-powell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 275, "favorite_count": 0, "accepted_answer_id": 33771429, "answer_count": 2, "score": 5, "last_activity_date": 1447871893, "creation_date": 1447816633, "question_id": 33771218, "link": "https://stackoverflow.com/questions/33771218/haskell-c-stack-overflow", "title": "Haskell - C stack overflow", "body": "<p>I've just been introduced to Haskell, so I'm not very practiced at how to code in the language, and hence, sorry if this is a duplicate, however I do not understand the other code written in the language.</p>\n\n<p>I am trying to write an algorithm that will take the sum of the positive even integers not exceeding the value given. I have attempted to write the code however I have been getting the C stack overflow error.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>sumint :: Int -&gt; Int\nsumint x\n  | x==0 = 0  \n  | x==1 = 1\n  | (x `mod` 2 == 0) &amp;&amp; (x &gt;= 2) = x + (sumint x-2)\n  | (x `mod` 2 /= 0) &amp;&amp; (x &gt;= 1) = x + (sumint x-1)\n</code></pre>\n\n<p>Where am I going wrong to get this error?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 8, "creation_date": 1447807714, "post_id": 33769838, "comment_id": 55307411, "body": "<code>Char</code> is an instance of <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#t:Enum\" rel=\"nofollow noreferrer\"><code>Enum</code></a> which means you may simply call <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#v:succ\" rel=\"nofollow noreferrer\"><code>succ</code></a> instead of redefining it"}, {"owner": {"reputation": 605, "user_id": 1793740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45a57f612171efd0a50c8a99f99cdd2e?s=128&d=identicon&r=PG", "display_name": "Mario", "link": "https://stackoverflow.com/users/1793740/mario"}, "reply_to_user": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 1, "creation_date": 1447822038, "post_id": 33769838, "comment_id": 55311228, "body": "Agree with @behzad.nouri here. If you want to see how that works, check out <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/src/GHC.Enum.html#succ\" rel=\"nofollow noreferrer\">the source</a>. <code>toEnum . (+ 1)  . fromEnum</code> :)"}], "tags": [], "owner": {"reputation": 605, "user_id": 1793740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45a57f612171efd0a50c8a99f99cdd2e?s=128&d=identicon&r=PG", "display_name": "Mario", "link": "https://stackoverflow.com/users/1793740/mario"}, "is_accepted": false, "score": -2, "last_activity_date": 1447807304, "creation_date": 1447807304, "answer_id": 33769838, "question_id": 33769663, "link": "https://stackoverflow.com/questions/33769663/add-one-to-a-character-in-haskell/33769838#33769838", "title": "Add one to a character in haskell", "body": "<p>Take a look at <a href=\"https://downloads.haskell.org/~ghc/7.10.2/docs/html/libraries/base-4.8.1.0/Data-Char.html\" rel=\"nofollow\"><code>Data.Char</code></a>. The <code>ord</code> and <code>chr</code> functions are what you're after. Perhaps something like:</p>\n\n<pre><code>nextChar :: Char -&gt; Char\nnextChar x = chr $ ord x + 1\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1722, "user_id": 697188, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b0927ded7bba64ba28a6ec4279a754a6?s=128&d=identicon&r=PG", "display_name": "Michael Welch", "link": "https://stackoverflow.com/users/697188/michael-welch"}, "is_accepted": true, "score": 6, "last_activity_date": 1447821868, "creation_date": 1447821868, "answer_id": 33772024, "question_id": 33769663, "link": "https://stackoverflow.com/questions/33769663/add-one-to-a-character-in-haskell/33772024#33772024", "title": "Add one to a character in haskell", "body": "<p>Using the suggestion by @behzad.nouri, you could do something like this:</p>\n\n<pre><code>myfunc :: (Char, Char, Char) -&gt; (Char, Char, Char)\nmyfunc (x,y,z) = (x,y,succ z)\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 5523735, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c0cd51b33a60dbf810b491c9bf0cb064?s=128&d=identicon&r=PG&f=1", "display_name": "craaaft", "link": "https://stackoverflow.com/users/5523735/craaaft"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1051, "favorite_count": 0, "accepted_answer_id": 33772024, "answer_count": 2, "score": 2, "last_activity_date": 1447821953, "creation_date": 1447806196, "last_edit_date": 1447821953, "question_id": 33769663, "link": "https://stackoverflow.com/questions/33769663/add-one-to-a-character-in-haskell", "title": "Add one to a character in haskell", "body": "<p>How could I add a number to a character. For example if I say A+1 I want to get B and so on. Especially I would like to write a function to get the successor of a tuple <code>(char,char,char)</code>. For example <code>myfunc (A,B,C)</code> would be <code>(A,B,D)</code> and so on.</p>\n\n<p>Any standard way to do this in haskell?</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1447805678, "post_id": 33769552, "comment_id": 55306738, "body": "Note that you can be selective: for every source file, you can enable different extensions..."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1447805703, "post_id": 33769552, "comment_id": 55306749, "body": "Furthermore: do you make use of a <code>Makefile</code>?"}, {"owner": {"reputation": 51, "user_id": 5574365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/421bf6a20822a65cf509111ad9a9b00c?s=128&d=identicon&r=PG&f=1", "display_name": "Jakob Bager", "link": "https://stackoverflow.com/users/5574365/jakob-bager"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1447805860, "post_id": 33769552, "comment_id": 55306795, "body": "Agreed @CommuSoft, but if I use the extension in all files, the compiler flag seems to reduce duplication. I&#39;m wondering if the compiler flag is some kind of bad practice though."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1447805974, "post_id": 33769552, "comment_id": 55306830, "body": "I don&#39;t see why given you include the flags in some <code>Makefile</code> or shell script, otherwise it will be hard for other programmers to &quot;guess&quot; the correct flags. Note that a potential advantage can be that an analysis program (like <code>fish</code> that can parse the <code>man</code> pages), could already warn if the flag is not available."}, {"owner": {"reputation": 51, "user_id": 5574365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/421bf6a20822a65cf509111ad9a9b00c?s=128&d=identicon&r=PG&f=1", "display_name": "Jakob Bager", "link": "https://stackoverflow.com/users/5574365/jakob-bager"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1447806240, "post_id": 33769552, "comment_id": 55306914, "body": "Since <code>my.cabal</code> contains: <code>ghc-options: &#171;some options&#187;</code> it does sound ghc-specific and not portable, as opposed to the pragma."}, {"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1447823952, "post_id": 33769552, "comment_id": 55311846, "body": "I personally use &quot;extensions&quot; (although I believe it&#39;s now been renamed to &quot;default-extensions&quot; in later cabals) in all my projects. stack definitely understands it, as does ghc-mod and haskell-mode and friends."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1447861812, "post_id": 33780440, "comment_id": 55335710, "body": "It would be nice to have a <code>required-extensions</code> section for cabal to make it fail/warn if a module requests an unlisted extension, and to warn if the build completes and a listed extension has never been requested."}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 5, "last_activity_date": 1447850645, "creation_date": 1447850645, "answer_id": 33780440, "question_id": 33769552, "link": "https://stackoverflow.com/questions/33769552/haskell-language-extensions-pragma-vs-compiler-flag/33780440#33780440", "title": "Haskell language extensions: pragma vs. compiler flag?", "body": "<p>Personally, I always list all the language extensions in each file that uses them. Then you can tell exactly what extensions a particular piece of code is using, just by looking at the code. That means I can instantly tell, for example, is this code doing something with Template Haskell or not. And I don't have to look at any related files to figure that out. It also means I can compile just that module, manually from the command line, without having to memorise which extensions I need.</p>\n\n<p>I suppose there is something to be said for being able to glance at the Cabal spec to see which extensions a particular package uses.</p>\n"}], "owner": {"reputation": 51, "user_id": 5574365, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/421bf6a20822a65cf509111ad9a9b00c?s=128&d=identicon&r=PG&f=1", "display_name": "Jakob Bager", "link": "https://stackoverflow.com/users/5574365/jakob-bager"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 315, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1447850645, "creation_date": 1447805577, "last_edit_date": 1447806873, "question_id": 33769552, "link": "https://stackoverflow.com/questions/33769552/haskell-language-extensions-pragma-vs-compiler-flag", "title": "Haskell language extensions: pragma vs. compiler flag?", "body": "<p>To use a language extension such as <code>UnicodeSyntax</code> in all files of a project, 2 options are:</p>\n\n<ul>\n<li>A pragma in every source file:\n<code>{-# LANGUAGE UnicodeSyntax #-}</code></li>\n<li>Adding <code>extensions: UnicodeSyntax</code> in every section (library, executable, test) of the <code>.cabal</code> file.</li>\n</ul>\n\n<p>Are there any reasons or best practices to choose one over the other?</p>\n\n<p>I'm using <code>stack</code> and their standard <code>new-template</code> for simple packages.</p>\n"}, {"tags": ["haskell", "recursion", "primes", "lazy-evaluation"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447805270, "post_id": 33769339, "comment_id": 55306602, "body": "See also: <a href=\"http://stackoverflow.com/q/22270004/791604\">1</a> <a href=\"http://stackoverflow.com/q/16524528/791604\">2</a>"}], "answers": [{"comments": [{"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 0, "creation_date": 1447805446, "post_id": 33769516, "comment_id": 55306659, "body": "<a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#v:takeWhile\" rel=\"nofollow noreferrer\"><code>takeWhile</code></a> would fit better than <code>fst $ break</code>"}], "tags": [], "owner": {"reputation": 8858, "user_id": 186026, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/q1xfe.png?s=128&g=1", "display_name": "fjarri", "link": "https://stackoverflow.com/users/186026/fjarri"}, "is_accepted": true, "score": 2, "last_activity_date": 1447805503, "last_edit_date": 1447805503, "creation_date": 1447805347, "answer_id": 33769516, "question_id": 33769339, "link": "https://stackoverflow.com/questions/33769339/haskell-primes-number-sequence-recursion/33769516#33769516", "title": "Haskell primes number sequence recursion", "body": "<p>Some points: technically, your program does not print anything. Second, it does not even compile \u2014 notice a typo in the last line.</p>\n\n<p>As for your question: in your function you call <code>all</code> on the infinite list <code>primes</code>, and <code>all</code> tries to traverse all of it \u2014 that's why the program hangs. You need to take only the elements you need from <code>primes</code> and only then apply <code>all</code>. For example:</p>\n\n<pre><code>isqrt = floor . sqrt . fromIntegral\nprimes = 2:3:(primes' 4)\nprimes' n =\n        if (all (\\y-&gt; (n `mod` y) /= 0) (takeWhile (&lt;= isqrt n) primes))\n        then\n           n:primes' (n+1)\n        else\n           primes' (n+1)\n\nmain = print (take 5 primes)\n</code></pre>\n\n<p><em>Edit:</em> using <code>takeWhile</code> as @behzad.nouri suggests.</p>\n"}], "owner": {"reputation": 25, "user_id": 3717833, "user_type": "registered", "profile_image": "https://graph.facebook.com/1379568105/picture?type=large", "display_name": "user3717833", "link": "https://stackoverflow.com/users/3717833/user3717833"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 0, "accepted_answer_id": 33769516, "answer_count": 1, "score": 0, "last_activity_date": 1447805503, "creation_date": 1447804329, "question_id": 33769339, "link": "https://stackoverflow.com/questions/33769339/haskell-primes-number-sequence-recursion", "title": "Haskell primes number sequence recursion", "body": "<p>I need to make a function primes which is not taking any parameter and returns me the list of all the prime numbers.\nThis is the code I came up with:</p>\n\n<pre><code>isqrt = floor . sqrt . fromIntegral\nprimes = 2:3:(primes' 4)\nprimes' n = \n        if (all(\\y-&gt; (y &lt; isqrt n) &amp;&amp; ((n `mod` y) /= 0)) primes) \n        then\n           n:primes' (n+1)\n        else\n           primes` (n+1)\n</code></pre>\n\n<p>The program prints only 2:3: and then it stops. \nShouldn't this work because of the lazy evaluation? (by taking primes as the list constructed until now and be able to see if my current number is divisible by any of the numbers in that list and then if yes append it and continue the recursion, if not keep going).</p>\n\n<p>Can anyone please point me towards my mistake? </p>\n"}, {"tags": ["haskell", "state", "main", "chess"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1447807601, "post_id": 33769015, "comment_id": 55307372, "body": "<code>foldr (uncurry makeMove) :: [ (Position, Position) ] -&gt; Board -&gt; Board</code> is a function which takes a list of moves and an initial board &quot;makes&quot; these moves starting at the initial state, returning the final state. Essentially it runs your game to completion. There is no IO required."}], "answers": [{"comments": [{"owner": {"reputation": 31108, "user_id": 350351, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b1a41bbf4677c8961237c4d147e764d6?s=128&d=identicon&r=PG", "display_name": "Daenyth", "link": "https://stackoverflow.com/users/350351/daenyth"}, "edited": false, "score": 1, "creation_date": 1447851034, "post_id": 33771282, "comment_id": 55327353, "body": "This is already an excellent answer but I think it might be useful to talk about the state monad as well"}], "tags": [], "owner": {"reputation": 1929, "user_id": 5181199, "user_type": "registered", "profile_image": "https://graph.facebook.com/10204393995596520/picture?type=large", "display_name": "Oly", "link": "https://stackoverflow.com/users/5181199/oly"}, "is_accepted": true, "score": 2, "last_activity_date": 1447817063, "creation_date": 1447817063, "answer_id": 33771282, "question_id": 33769015, "link": "https://stackoverflow.com/questions/33769015/repeatedly-applying-function-to-game-board-in-haskell/33771282#33771282", "title": "Repeatedly applying function to game board in Haskell", "body": "<p>I'm assuming you want your game to be relatively dynamic and to respond to input, hence the IO question.</p>\n\n<p>I'll give a bit of background theory on imperative style commands and IO interpreted as functions, then look at this in Haskell and finally talk about your case from this point of view.</p>\n\n<h2>Some background on imperative commands</h2>\n\n<p>If this is stuff you know, apologies, but it might help anyway, or it might help others.</p>\n\n<p>In Haskell, we obviously have no direct mutation of variables. But we can consider a (closely) related idea of 'functions on states' - commands which would, in an imperative paradigm, be seen as mutating variables, can be seen as a 'state transformer': a function which, given one state (of the program, world, whatever) outputs another one.</p>\n\n<p>An example:</p>\n\n<p>Suppose we have a state consisting of a single integer variable <code>a</code>. Use the notation <code>x := y</code> meaning 'assign the value of expression y to the variable x'. (In many modern imperative languages this is written <code>x = y</code>, but to disambiguate with the equality relation <code>=</code> we can use a slightly different symbol.) Then the command (call it <code>C</code>)</p>\n\n<pre><code>a := 0\n</code></pre>\n\n<p>can be seen as something which modifies the variable a. But if we have an abstract idea of a type of '<code>states</code>', we can see the 'meaning' of <code>C</code> as a function from <code>states</code> to <code>states</code>. This is sometimes written <code>\u301aC\u301b</code>.\nSo <code>\u301aC\u301b: states -&gt; states</code>, and for any state s, <code>\u301aC\u301bs = &lt;the state where a = 0&gt;</code>. There are much more complicated state transformers that act on much more complicated kinds of state, but the principle is not more complicated than this!</p>\n\n<p>An important way to make new state transformers from old ones is notated by the familiar semicolon. So if we have state transformers <code>C1</code> and <code>C2</code>, we can write a new state transformer which 'does <code>C1</code> and then <code>C2</code>' as <code>C1;C2</code>. This is familiar from many imperative programming languages. In fact, the meaning as a state transformer of this 'concatenation' of commands is</p>\n\n<pre><code>\u301aC1;C2\u301b: states -&gt; states\n\u301aC1;C2\u301bs = \u301aC2\u301b(\u301aC1\u301bs)\n</code></pre>\n\n<p>i.e. the composition of the commands. So in a sense, in Haskell-like notation</p>\n\n<pre><code>(;) : (states -&gt; states) -&gt; (states -&gt; states) -&gt; states -&gt; states\nc1 ; c2 = c2 . c1\n</code></pre>\n\n<p>i.e. <code>(;)</code> is an operator on state-transformers which composes them.</p>\n\n<h2>Haskell's approach</h2>\n\n<p>Now, Haskell has some neat ways of bringing these concepts directly into the language. Instead of having a distinct type for commands (state modifiers without a type, per se) and expressions (which, depending on the imperative context, may also be allowed to modify the state as well as resulting in a value), Haskell somewhat combines these into one. <code>IO ()</code> entities represent pure state modifying actions which don't have a meaning as an expression, and <code>IO a</code> entities (where <code>a</code> is not <code>()</code>) represent (potential) state modifying actions whose meaning as an expression (like a 'return type') is of type <code>a</code>.</p>\n\n<p>Now, since <code>IO ()</code> is like a command, we want something like <code>(;)</code>, and indeed, in Haskell, we have the <code>(&gt;&gt;)</code> and <code>(&gt;&gt;=)</code> ('bind operators') which act just like it. We have <code>(&gt;&gt;) :: IO a -&gt; IO b -&gt; IO b</code> and <code>(&gt;&gt;=) :: IO a -&gt; (a -&gt; IO b) -&gt; IO b</code>. For a command (<code>IO ()</code>) or command-expression (<code>IO a</code>), the <code>(&gt;&gt;)</code> operator simply ignores the return if there is one, and gives you the operation of doing the two commands in sequence. The <code>(&gt;&gt;=)</code> on the other hand is for if we care about the result of the expression. The second argument is a function which, when applied to the result of the command-expression, gives another command/command-expression which is the 'next step'.</p>\n\n<p>Now, since Haskell has no 'mutable variables', an <a href=\"https://downloads.haskell.org/~ghc/7.0-latest/docs/html/libraries/base-4.3.1.0/Data-IORef.html\" rel=\"nofollow\"><code>IORef a</code></a>-type variable represents a mutable reference variable, to an <code>a</code>-type variable. If <code>ioA</code> is an <code>IORef a</code>-type entity, we can do <code>readIORef ioA</code> which returns an <code>IO a</code>, the expression which is the result of reading the variable. If <code>x :: a</code> we can do <code>writeIORef ioA x</code> which returns an <code>IO ()</code>, the command which is the result of writing the value <code>x</code> to the variable. To create a new <code>IORef a</code>, with value <code>x</code> we use <code>newIORef x</code> which gives an <code>IO (IORef a)</code> where the <code>IORef a</code> initially contains the value <code>x</code>.</p>\n\n<p>Haskell also has <code>do</code> notation which you alluded to, which is a nice syntactic sugar for the above. Simply,</p>\n\n<pre><code>do a; b            =        a &gt;&gt; b\ndo v &lt;- e; c       =        e &gt;&gt;= \\v -&gt; c\n</code></pre>\n\n<h2>Your case</h2>\n\n<p>If we have some IO entity <code>getAMove :: IO (Position, Position)</code> (which might be a simple parser on some user input, or whatever suits your case), we can define </p>\n\n<pre><code>moveIO :: IORef Board -&gt; IO ()\nmoveIO board =\n    readIORef board &gt;&gt;= \\currentState -&gt; -- read current state of the board\n    getAMove &gt;&gt;= \\(pos1, pos2) -&gt; -- obtain move instructions\n    writeIORef board (makeMove pos1 pos2 currentState) -- update the board per makeMove\n</code></pre>\n\n<p>This can also be written using <code>do</code> notation:</p>\n\n<pre><code>moveIO board = do\n    currentState &lt;- readIORef board; -- read current state of the board\n    (pos1, pos2) &lt;- getAMove; -- obtain move instructions\n    writeIORef board (makeMove pos1 pos2 currentState) -- update the board per makeMove\n</code></pre>\n\n<p>Then, whenever you need a command which updates an <code>IORef Board</code> based on a call to <code>getAMove</code> you can use this <code>moveIO</code>.</p>\n\n<p>Now, if you make appropriate functions with the following signatures, a simple main IO loop can be devised:</p>\n\n<pre><code>-- represents a test of the board as to whether the game should continue\ncheckForContinue :: Board -&gt; Bool\ncheckForContinue state = ...\n\n-- represents some kind of display action of the board.\n-- could be a simple line by line print.\ndisplayBoardState :: Board -&gt; IO ()\ndisplayBoardState state = ...\n\n-- represents the starting state of the board.\nstartState :: Board\n\n-- a simple main loop\nmainLoop :: IORef Board -&gt; IO ()\nmainLoop board = do\n    currentState &lt;- readIORef board;\n    displayState currentState;\n    if checkForContinue currentState then\n        do moveIO board; mainLoop board\n    else return ()\n\nmain :: IO ()\nmain = do\n    board &lt;- newIORef startState;\n    mainLoop board\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 0, "last_activity_date": 1447849203, "creation_date": 1447849203, "answer_id": 33779915, "question_id": 33769015, "link": "https://stackoverflow.com/questions/33769015/repeatedly-applying-function-to-game-board-in-haskell/33779915#33779915", "title": "Repeatedly applying function to game board in Haskell", "body": "<p>You could use recursion to model state as follows:</p>\n\n<pre><code>main :: IO ()\nmain = do\n   let initialBoard = ...\n   gameLoop initialBoard\n\ngameLoop :: Board -&gt; IO ()\ngameLoop board | gameOver board = putStrLn \"Game over.\"\n               | otherwise = do\n   print board\n   move &lt;- askUserToMove\n   let newBoard = applyMove move board\n   gameLoop newBoard\n</code></pre>\n\n<p>Here <code>board</code> is \"changed\" by computing a new one and recursively calling the game loop.</p>\n"}], "owner": {"reputation": 247, "user_id": 4572619, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh4.googleusercontent.com/-j-KVFCZUYuE/AAAAAAAAAAI/AAAAAAAAAXw/76TrGwYjMpw/photo.jpg?sz=128", "display_name": "Nicol&#225;s Siplis", "link": "https://stackoverflow.com/users/4572619/nicol%c3%a1s-siplis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 0, "accepted_answer_id": 33771282, "answer_count": 2, "score": 1, "last_activity_date": 1447850784, "creation_date": 1447802750, "last_edit_date": 1447850784, "question_id": 33769015, "link": "https://stackoverflow.com/questions/33769015/repeatedly-applying-function-to-game-board-in-haskell", "title": "Repeatedly applying function to game board in Haskell", "body": "<p>I've created a chess game with Haskell and everything seems to be working. However, I'm trying to define the main function of the program so that each time a move is made (which takes two positions and a board as arguments) the resulting board is kept somewhere, so that it can then be used as an argument for the next move. The code looks something like this.</p>\n\n<pre><code>makeMove :: Position -&gt; Position -&gt; Board -&gt; Board\nmakeMove pos1 pos2 board = ...\n</code></pre>\n\n<p>I'm aware of the <code>do</code> notation and have a basic understanding of IO in Haskell, but I'm still unsure on how to proceed.</p>\n"}, {"tags": ["haskell", "functional-programming", "arrows", "free-monad"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447806102, "post_id": 33768431, "comment_id": 55306875, "body": "So far, your only actual complaint about <code>Free</code> is that you can&#39;t implement <code>MonadFix</code> or <code>ArrowLoop</code>. Do you need to?"}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1447815936, "post_id": 33768431, "comment_id": 55309690, "body": "Related: <a href=\"http://stackoverflow.com/q/29161923/414413\">stackoverflow.com/q/29161923/414413</a>"}, {"owner": {"reputation": 175, "user_id": 4914903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15ac7fcfbb9192989cd71ccfb042dc6b?s=128&d=identicon&r=PG&f=1", "display_name": "starper", "link": "https://stackoverflow.com/users/4914903/starper"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447844686, "post_id": 33768431, "comment_id": 55323151, "body": "@DanielWagner Actually I don&#39;t know for sure will I need it or not, but I have some thoughts about how it can be useful. And I don&#39;t want to discover one day that I really need it, but can&#39;t have it :) @Cirdec Thanks, I&#39;ll take a look. Btw can something not exactly the same, but similar (I mean purification part) be implemented without <code>Free</code>, for example only with <code>Arrow</code>?"}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1447868068, "post_id": 33768431, "comment_id": 55340146, "body": "<code>Auto</code> is itself a form of fixpoint. Why not use <code>ProgramF</code> rather than <code>Program</code> with it?"}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 1, "creation_date": 1447890948, "post_id": 33768431, "comment_id": 55352424, "body": "The <a href=\"https://hackage.haskell.org/package/machines\" rel=\"nofollow noreferrer\">machines</a> library builds <code>Process</code>es from the base functor of state transducers <a href=\"http://stackoverflow.com/q/27997155/414413\">stackoverflow.com/q/27997155/414413</a>"}, {"owner": {"reputation": 175, "user_id": 4914903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15ac7fcfbb9192989cd71ccfb042dc6b?s=128&d=identicon&r=PG&f=1", "display_name": "starper", "link": "https://stackoverflow.com/users/4914903/starper"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1447898752, "post_id": 33768431, "comment_id": 55354797, "body": "@Cirdec Thanks for this links, I&#39;ll certainly take a look. It looks like a lot of info to wrap my head around."}, {"owner": {"reputation": 175, "user_id": 4914903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15ac7fcfbb9192989cd71ccfb042dc6b?s=128&d=identicon&r=PG&f=1", "display_name": "starper", "link": "https://stackoverflow.com/users/4914903/starper"}, "reply_to_user": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1447898812, "post_id": 33768431, "comment_id": 55354812, "body": "@gallais Can you please give an example of how to do it? Or maybe give links to such examples?"}], "owner": {"reputation": 175, "user_id": 4914903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15ac7fcfbb9192989cd71ccfb042dc6b?s=128&d=identicon&r=PG&f=1", "display_name": "starper", "link": "https://stackoverflow.com/users/4914903/starper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 258, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1448389658, "creation_date": 1447799868, "last_edit_date": 1448389658, "question_id": 33768431, "link": "https://stackoverflow.com/questions/33768431/autos-arrows-and-free-monads", "title": "Autos, Arrows and Free Monads", "body": "<p>I've read two great series of articles about <a href=\"http://blog.jle.im/entry/intro-to-machines-arrows-part-1-stream-and\" rel=\"nofollow\">Autos</a> and <a href=\"http://www.haskellforall.com/2012/06/you-could-have-invented-free-monads.html\" rel=\"nofollow\">Free Monads</a> and I'd like to combine this two techniques somehow.</p>\n\n<p>I'd like to have something like:</p>\n\n<pre><code>data ProgramF a = Get (String -&gt; a) | Set String a\ninstance Functor ProgramF where ...\ntype Program = Free ProgramF\n\nget' :: Program String\nget' = liftF $ Get id\n\nset' :: String -&gt; Program ()\nset' s = liftF $ Set s ()\n\nauto1 :: AutoM Program () String\nauto1 = arrM \\_ -&gt; get'\n\nauto2 :: AutoM Program String ()\nauto2 = arrM \\s -&gt; set' s\n\nauto3 :: AutoM Program () ()\nauto3 = auto1 &gt;&gt;&gt; auto2\n\n...\n</code></pre>\n\n<p>But there are some problems, for example <code>ArrowLoop</code> requires <code>Program</code> to be an instance of <code>MonadFix</code> which is not possible as far as I understand.</p>\n\n<p>So my questions are:</p>\n\n<ul>\n<li>Are there ways to make <code>Auto</code> and <code>Free</code> work together?</li>\n<li>And if not, maybe there are other ways to achieve the goal?</li>\n</ul>\n\n<p>Note: I'm pretty new to functional programming, so I understand from little to nothing in theory.</p>\n\n<p><strong>Update:</strong></p>\n\n<p>In one of the comments it was mentioned that <code>Auto</code> is itself a form of fixpoint and I can use <code>ProgramF</code> directly with it. So I guess that the type of <code>Auto</code> should look something like this:</p>\n\n<pre><code>newtype Auto f a b = Auto (a -&gt; f (b, (Auto f a b)))\n</code></pre>\n\n<p>But the problem now is that I can't figure out how to compose two <code>Auto</code>s without <code>f</code> being a <code>Monad</code>.</p>\n\n<p><em>My end goal is to have some composable pieces of code with internal state and a way to purify my code hiding all <code>IO</code> effects (like <code>log</code> or <code>getLine</code>) in some kind of interpreter.</em></p>\n\n<p>So I guess my real question is: <strong>how can I implement something described above?</strong></p>\n\n<p>Maybe I'm doing it all wrong and there is a better way. Can someone please give a simple example or provide some links to something similar?</p>\n"}, {"tags": ["haskell", "dependencies", "cabal"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1447799556, "post_id": 33767830, "comment_id": 55304442, "body": "could you please list <code>ghc --version</code>,  <code>cabal --version</code>, <code>ghc-pkg list</code>"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1447799706, "post_id": 33767830, "comment_id": 55304501, "body": "could you also give us the error that happens when you do a <code>cabal install lens</code>"}, {"owner": {"reputation": 11, "user_id": 5574080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b40556c88b4d41b121a1604c11fa4714?s=128&d=identicon&r=PG&f=1", "display_name": "George Birchoff", "link": "https://stackoverflow.com/users/5574080/george-birchoff"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1447801217, "post_id": 33767830, "comment_id": 55305148, "body": "@epsilonhalbe I have added the information requested"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1447802020, "post_id": 33767830, "comment_id": 55305475, "body": "easiest thing probably would be to upgrade cabal/ghc to a recent version (ghc-7.10.2/cabal &gt; 1.18) and use <code>cabal sandboxes</code> i guess"}, {"owner": {"reputation": 3191, "user_id": 304690, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2d5eb296eb64a1b8ed121b12a4b32817?s=128&d=identicon&r=PG", "display_name": "gliptak", "link": "https://stackoverflow.com/users/304690/gliptak"}, "edited": false, "score": 0, "creation_date": 1447978923, "post_id": 33767830, "comment_id": 55399491, "body": "with ``` $ ghc --version The Glorious Glasgow Haskell Compilation System, version 7.8.4 ```I got no errors building: Building lens-4.13... Installed lens-4.13 Configuring equ-0.2.1... Building equ-0.2.1... Installed equ-0.2.1"}], "owner": {"reputation": 11, "user_id": 5574080, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b40556c88b4d41b121a1604c11fa4714?s=128&d=identicon&r=PG&f=1", "display_name": "George Birchoff", "link": "https://stackoverflow.com/users/5574080/george-birchoff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 246, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1447801036, "creation_date": 1447797573, "last_edit_date": 1447801036, "question_id": 33767830, "link": "https://stackoverflow.com/questions/33767830/error-installing-a-simple-haskell-program", "title": "Error installing a simple haskell program", "body": "<p>I'm trying to install a simple haskell program:</p>\n\n<p><a href=\"https://github.com/manugunther/hal-gui\" rel=\"nofollow\">https://github.com/manugunther/hal-gui</a></p>\n\n<p>The installation instructions are:</p>\n\n<pre><code>$&gt; sudo apt-get install ghc \n$&gt; sudo apt-get install cabal-install \n$&gt; sudo apt-get install git\n\n$&gt; git clone https://github.com/manugunther/hal-gui\n$&gt; git submodule update --init --recursive\n\n$&gt; cd hal-gui\n$&gt; cabal install Cabal \n$&gt; cabal install fun/equ/equ.cabal\n$&gt; sudo apt-get install --force-yes -y alex happy\n$&gt; cabal install gtk2hs-buildtools\n$&gt; sudo apt-get install --force-yes -y libgtksourceview2.0-dev ;\n$&gt; cabal install fun/fun.cabal\n$&gt; cabal install hal/hal.cabal\n$&gt; cabal install --only-dependencies\n\n$&gt; ghci\nPrelude&gt; :l HGUI/Main.hs\nPrelude&gt; main\n</code></pre>\n\n<p>But i get an error in this step:</p>\n\n<pre><code>$&gt; cabal install fun/equ/equ.cabal\n\ncabal: Error: some packages failed to install:\nequ-0.2.1 depends on lens-4.13 which failed to install.\nlens-4.13 failed during the building phase. The exception was:\nExitFailure 1\n</code></pre>\n\n<p>Version information:</p>\n\n<pre><code>$ghc --version\nThe Glorious Glasgow Haskell Compilation System, version 7.4.1\n\n$ cabal --version\ncabal-install version 0.14.0\nusing version 1.14.0 of the Cabal library \n\n$ ghc-pkg list\n    /var/lib/ghc/package.conf.d\n   Cabal-1.14.0\n   GLUT-2.1.2.2\n   HTTP-4000.2.3\n   HUnit-1.2.4.2\n   MonadCatchIO-mtl-0.3.0.4\n   OpenGL-2.2.3.1\n   QuickCheck-2.4.2\n   array-0.4.0.0\n   base-4.5.0.0\n   bin-package-db-0.0.0.0\n   binary-0.5.1.0\n   bytestring-0.9.2.1\n   cgi-3001.1.8.2\n   containers-0.4.2.1\n   deepseq-1.3.0.0\n   directory-1.1.0.2\n   extensible-exceptions-0.1.1.4\n   fgl-5.4.2.4\n   filepath-1.3.0.0\n   ghc-7.4.1\n   ghc-prim-0.2.0.0\n   haskell-src-1.0.1.5\n   haskell2010-1.1.0.1\n   haskell98-2.0.0.1\n   hoopl-3.8.7.3\n   hpc-0.5.1.1\n   html-1.0.1.2\n   integer-gmp-0.4.0.0\n   mtl-2.1.1\n   network-2.3.0.13\n   old-locale-1.0.0.4\n   old-time-1.1.0.0\n   parallel-3.2.0.2\n   parsec-3.1.2\n   pretty-1.1.1.0\n   process-1.1.0.1\n   random-1.0.1.1\n   regex-base-0.93.2\n   regex-compat-0.95.1\n   regex-posix-0.95.1\n   rts-1.0\n   stm-2.3\n   syb-0.3.6.1\n   template-haskell-2.7.0.0\n   text-0.11.2.0\n   time-1.4\n   transformers-0.3.0.0\n   unix-2.5.1.0\n   xhtml-3000.2.1\n   zlib-0.5.3.3\n/home/gonzalo/.ghc/i386-linux-7.4.1/package.conf.d\n   Cabal-1.22.4.0\n   MissingH-1.3.0.1\n   MonadRandom-0.4\n   StateVar-1.1.0.1\n   adjunctions-4.2.1\n   base-orphans-0.4.2\n   bifunctors-5\n   binary-0.7.6.1\n   cereal-0.4.1.1\n   comonad-4.2.7.2\n   contravariant-1.3.2\n   distributive-0.4.4\n   either-4.4.1\n   equ-0.2.1\n   exceptions-0.8.0.2\n   fgl-5.5.2.1\n   free-4.12.1\n   fun-0.2\n   hal-0.0.1\n   hashable-1.2.3.3\n   hslogger-1.2.9\n   kan-extensions-4.2.2\n   lens-4.12.3\n   lens-4.13\n   mmorph-1.0.4\n   monad-control-1.0.0.4\n   mtl-2.2.1\n   nats-1\n   network-2.6.2.1\n   parsec-3.1.9\n   prelude-extras-0.4\n   primitive-0.6\n   profunctors-5.1.1\n   reference-0.1\n   reflection-2\n   reflection-2.1\n   regex-base-0.93.2\n   regex-compat-0.95.1\n   regex-posix-0.95.2\n   semigroupoids-5.0.0.2\n   semigroups-0.16.2.2\n   strict-0.3.2\n   tagged-0.8.1\n   transformers-0.4.3.0\n   transformers-base-0.4.4\n   transformers-compat-0.4.0.4\n   unordered-containers-0.2.5.1\n   utf8-string-0.3.8\n   vector-0.11.0.0\n   void-0.7\n</code></pre>\n\n<p>error information:</p>\n\n<p>I get no error when I execute \"$> cabal install lens\"</p>\n\n<p>But i get this when i execute \"$> cabal install fun/equ/equ.cabal\"</p>\n\n<pre><code>Resolving dependencies...\n[1 of 1] Compiling Main             ( /tmp/lens-4.13-14792/lens-4.13/Setup.lhs, /tmp/lens-4.13-14792/lens-4.13/dist/setup/Main.o )\nLinking /tmp/lens-4.13-14792/lens-4.13/dist/setup/setup ...\nConfiguring lens-4.13...\nBuilding lens-4.13...\nPreprocessing library lens-4.13...\n[ 1 of 81] Compiling Data.Map.Lens    ( src/Data/Map/Lens.hs, dist/build/Data/Map/Lens.o )\n[ 2 of 81] Compiling Paths_lens       ( dist/build/autogen/Paths_lens.hs, dist/build/Paths_lens.o )\n[ 3 of 81] Compiling Control.Lens.Internal.List ( src/Control/Lens/Internal/List.hs, dist/build/Control/Lens/Internal/List.o )\nLoading package ghc-prim ... linking ... done.\nLoading package integer-gmp ... linking ... done.\nLoading package base ... linking ... done.\nLoading package array-0.4.0.0 ... linking ... done.\nLoading package deepseq-1.3.0.0 ... linking ... done.\nLoading package transformers-0.4.3.0 ... linking ... done.\nLoading package primitive-0.6.1.0 ... linking ... done.\nLoading package vector-0.11.0.0 ... linking ... done.\nLoading package tagged-0.8.2 ... linking ... done.\nLoading package containers-0.4.2.1 ... linking ... done.\nLoading package pretty-1.1.1.0 ... linking ... done.\nLoading package template-haskell ... linking ... done.\nLoading package reflection-2.1 ... linking ... done.\nLoading package parallel-3.2.0.6 ... linking ... done.\nLoading package stm-2.4.4 ... linking ... done.\nLoading package StateVar-1.1.0.1 ... linking ... done.\nLoading package bytestring-0.9.2.1 ... linking ... done.\nLoading package binary-0.7.6.1 ... linking ... done.\nLoading package text-1.2.1.3 ... linking ... done.\nLoading package hashable-1.2.3.3 ... linking ... done.\nLoading package nats-1.1 ... linking ... done.\nLoading package unordered-containers-0.2.5.1 ... linking ... done.\nLoading package semigroups-0.18.0.1 ... linking ... done.\nLoading package transformers-compat-0.4.0.4 ... linking ... done.\nLoading package void-0.7.1 ... linking ... done.\nLoading package contravariant-1.3.3 ... linking ... done.\nLoading package distributive-0.4.4 ... linking ... done.\nLoading package comonad-4.2.7.2 ... linking ... done.\nLoading package bifunctors-5.1 ... linking ... done.\nLoading package mtl-2.2.1 ... linking ... done.\nLoading package exceptions-0.8.0.2 ... linking ... done.\nLoading package prelude-extras-0.4.0.2 ... linking ... done.\nLoading package profunctors-5.1.1 ... linking ... done.\nLoading package base-orphans-0.4.4 ... linking ... done.\nLoading package semigroupoids-5.0.0.4 ... linking ... done.\nLoading package free-4.12.1 ... linking ... done.\nLoading package adjunctions-4.2.2 ... linking ... done.\nLoading package kan-extensions-4.2.3 ... linking ... done.\nLoading package filepath-1.3.0.0 ... linking ... done.\n[ 4 of 81] Compiling Control.Lens.Internal.TH ( src/Control/Lens/Internal/TH.hs, dist/build/Control/Lens/Internal/TH.o )\n[ 5 of 81] Compiling Control.Lens.Internal.Coerce ( src/Control/Lens/Internal/Coerce.hs, dist/build/Control/Lens/Internal/Coerce.o )\n[ 6 of 81] Compiling Control.Lens.Internal.Instances ( src/Control/Lens/Internal/Instances.hs, dist/build/Control/Lens/Internal/Instances.o )\n[ 7 of 81] Compiling Control.Lens.Internal.Zoom ( src/Control/Lens/Internal/Zoom.hs, dist/build/Control/Lens/Internal/Zoom.o )\n\nsrc/Control/Lens/Internal/Zoom.hs:50:1:\n    semigroupoids-5.0.0.4:Data.Functor.Bind can't be safely imported! The module itself isn't safe.\ncabal: Error: some packages failed to install:\nequ-0.2.1 depends on lens-4.13 which failed to install.\nlens-4.13 failed during the building phase. The exception was:\nExitFailure 1\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "lazy-evaluation"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 2, "creation_date": 1447793640, "post_id": 33766559, "comment_id": 55301291, "body": "It sounds like you&#39;re using the word &quot;functional&quot; to mean &quot;has functions as first-class values&quot;. Most haskell programmers take &quot;functional&quot; to mean &quot;pure&quot; or &quot;functions as in math functions&quot;. If you mean the latter then I <b>think</b> the answer is: programs which work in a strict language will have the same semantics when moved to a lazy language, but the inverse is absolutely not true."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1447794773, "post_id": 33766559, "comment_id": 55301938, "body": "to your last remark - depending of what you would call <i>next version</i> (I think I saw this talk too - but I took it as: if we would start from scratch again it would probably be strict by default) this might interest you: <a href=\"https://github.com/ghc/ghc/commit/46a03fbec6a02761db079d1746532565f34c340f\" rel=\"nofollow noreferrer\">github.com/ghc/ghc/commit/&hellip;</a>"}, {"owner": {"reputation": 4707, "user_id": 3980115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0346113c8f43a8036d8989fa0ba3ae55?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad274", "link": "https://stackoverflow.com/users/3980115/vlad274"}, "edited": false, "score": 1, "creation_date": 1449665411, "post_id": 33766559, "comment_id": 56104702, "body": "This might be a better question for <a href=\"http://programmers.stackexchange.com/\">programmers.stackexchange.com</a>"}, {"owner": {"reputation": 6198, "user_id": 839601, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6db99aa846a8217f7e2aba6fa198e7c?s=128&d=identicon&r=PG", "display_name": "gnat", "link": "https://stackoverflow.com/users/839601/gnat"}, "reply_to_user": {"reputation": 4707, "user_id": 3980115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0346113c8f43a8036d8989fa0ba3ae55?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad274", "link": "https://stackoverflow.com/users/3980115/vlad274"}, "edited": false, "score": 1, "creation_date": 1449671961, "post_id": 33766559, "comment_id": 56109158, "body": "@Vlad274 when referring other sites, it is often helpful to point that <a href=\"http://meta.stackexchange.com/tags/cross-posting/info\">cross-posting is frowned upon</a>"}], "answers": [{"tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": false, "score": 1, "last_activity_date": 1447873516, "last_edit_date": 1447873516, "creation_date": 1447797680, "answer_id": 33767858, "question_id": 33766559, "link": "https://stackoverflow.com/questions/33766559/can-every-functional-language-be-lazy/33767858#33767858", "title": "Can every functional language be lazy?", "body": "<p>What you propose will work. The details for doing this in Scheme can be <a href=\"https://mitpress.mit.edu/sicp/full-text/book/book-Z-H-27.html#%25_sec_4.2\" rel=\"nofollow\">found in SICP</a>. One could envisage a strict version of Haskell in which there is a \"lazy\" function which does the opposite of what \"seq\" does in Haskell. However adding this to a strict Haskell-like language would require compiler magic because otherwise the thunk gets forced before being passed to \"lazy\".</p>\n\n<p>However if your language has uncontrolled effects then this can get hairy, because an effect happens whenever its enclosing function gets evaluated, and figuring out when figuring out when that is going to happen in a lazy langauge is difficult. Thats why Haskell has the IO monad.</p>\n"}, {"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 8, "last_activity_date": 1449361396, "last_edit_date": 1449361396, "creation_date": 1447801073, "answer_id": 33768694, "question_id": 33766559, "link": "https://stackoverflow.com/questions/33766559/can-every-functional-language-be-lazy/33768694#33768694", "title": "Can every functional language be lazy?", "body": "<p>Lazy evaluation, at the low level, is implemented by a concept called a <strong>thunk</strong>, which comprises two things:</p>\n\n<ol>\n<li>A closure that computes the value of the deferred computation</li>\n<li>A set-once mutable storage cell for memoizing the result.</li>\n</ol>\n\n<p>The first part, the closure, can be modeled in an even simpler way than your tuple with the function and its arguments.  You can just use a function that accepts  unit or no arguments (depending on how your language works), and in its body you apply the function to the arguments.  To compute the result, you just invoke the function.</p>\n\n<p>Paul Johnson mentions Scheme, which is a perfect language to demonstrate this.  As a Scheme macro (pseudocode, untested):</p>\n\n<pre><code>(define-syntax delay\n  (syntax-rules ()\n    ((delay expr ...)\n     ;; `(delay expr)` evaluates to a lambda that closes over\n     ;; two variables\u2014one to store the result, one to record\n     ;; whether the thunk has been forced.\n     (let ((value #f)\n           (done? #f))\n       (lambda ()\n         (unless done?\n           (set! value (begin expr ...))\n           (set! done? #t))\n         value)))))\n\n(define (force thunk)\n  ;; Thunks are procedures, so to force them you just invoke them.\n  (thunk))\n</code></pre>\n\n<p>But to get this back to the title of the question: does this mean that every functional language can be lazy?  The answer is <strong>no</strong>.  Eager languages can implement thunking and use it to provide opt-in delayed evaluation <em>at user-selected spots</em>, but this isn't the same as having pervasive lazy evaluation like Haskell implementations provide.</p>\n"}, {"tags": [], "owner": {"reputation": 91978, "user_id": 387076, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/cFyP6.jpg?s=128&g=1", "display_name": "Gilles &#39;SO- stop being evil&#39;", "link": "https://stackoverflow.com/users/387076/gilles-so-stop-being-evil"}, "is_accepted": true, "score": 4, "last_activity_date": 1447895521, "creation_date": 1447895521, "answer_id": 33793559, "question_id": 33766559, "link": "https://stackoverflow.com/questions/33766559/can-every-functional-language-be-lazy/33793559#33793559", "title": "Can every functional language be lazy?", "body": "<p>The answer is a qualified yes. Your intuition that laziness can be implemented in a strict language where functions are first-class objects is correct. But going into the details reveals a number of subtleties.</p>\n\n<p>Let's take a functional language (by which I mean a language where functions can be constructed and manipulated as first-class objects, like in the lambda calculus), where function application is strict (i.e. the function\u00b9 and its argument(s) are fully evaluated before the function is applied). I'll use the syntax of Standard ML, since this is a popular and historically important strict functional language. A strict application <code><em>F</em> <em>A</em></code> (where <code><em>F</em></code> and <code><em>A</em></code> are two expressions) can be delayed by encoding it as</p>\n\n<pre>Thunk (<em>F</em>, <em>A</em>)</pre>\n\n<p>This object contains a function and an argument is called a <em>thunk</em>. We can define a type of thunks:</p>\n\n<pre><code>datatype ('a, 'b) thunk = Thunk of ('a -&gt; 'b) * 'a;\n</code></pre>\n\n<p>and a function to evaluate a thunk:</p>\n\n<pre><code> fun evaluate (Thunk (f, x)) = f x;\n</code></pre>\n\n<p>Nice and easy so far. But we have not, in fact, implemented lazy evaluation! What we've implemented is normal-order evaluation, also known as <a href=\"https://en.wikipedia.org/wiki/Call-by-name\" rel=\"nofollow\">call-by-name</a>. The difference is that if the value of the thunk is used more than once, it is calculated every time. Lazy evaluation (also known as <a href=\"https://en.wikipedia.org/wiki/Lazy_evaluation\" rel=\"nofollow\">call-by-need</a>) requires evaluating the expression at most once.</p>\n\n<p>In a pure, strict language, lazy evaluation is in fact impossible to implement. The reason is that evaluating a thunk modifies the state of the system: it goes from unevaluated to evaluated. Implementing lazy evaluation requires a way to change the state of the system.</p>\n\n<p>There's a subtlety here: if the semantics of the language is defined purely in terms of the termination status of expressions and the value of terminating expressions, then, in a pure language, call-by-need and call-by-name are indistinguishable. Call-by-value (i.e. strict evaluation) is distinguishable because fewer expressions terminate \u2014 call-by-need and call-by-name hide any non-termination that happens in a thunk that is never evaluated. The equivalence of call-by-need and call-by-name allows lazy evaluation to be considered as an optimization of normal-order evaluation (which has nice theoretical properties). But in many programs, using call-by-name instead of call-by-value would blow up the running time by computing the value of the same expressions over and over again.</p>\n\n<p>In a language with mutable state, lazy evaluation can be expressed by storing the value into the thunk when it is calculated.</p>\n\n<pre><code>datatype ('a, 'b) lazy_state = Lazy of ('a -&gt; 'b) * 'a | Value of 'a;\ntype ('a, 'b) lazy_state = ('a, 'b) lazy_state ref;\nlet lazy (f, x) = ref (Lazy (f, x));\nfun force r =\n  case !r of Value y =&gt; y\n           | Lazy (f, x) =&gt; let val y = f x in r := Value y; y end;\n</code></pre>\n\n<p>This code is not very complicated, so even in ML dialects that provide lazy evaluation as a library feature (possibly with syntactic sugar), it isn't used all that often in practice \u2014\u00a0often, the point at which the value will be needed is a known location in the programs, and programmers just use a function and pass it its argument at that location.</p>\n\n<p>While this is getting into subjective territory, I would say that it's much easier to implement lazy evaluation like this, than to implement strict evaluation in a language like Haskell. Forcing strict evaluation in Haskell is basically impossible (except by wrapping everything into a state monad and essentially writing ML code in Haskell syntax). Of course, strict evaluation doesn't change the values calculated by the program, but it can have a significant impact on performance (and, in particular, it is sometimes much appreciated because it makes performance a lot more predictable \u2014 predicting the performance of a Haskell program can be very hard).</p>\n\n<p>This evaluate-and-store mechanism is effectively the core of what a Haskell compiler does under the hood. Haskell is pure\u00b2, so you cannot implemente this in the language itself! However, it's sound for the compiler to do it under the hood, because this particular use of side effects does not break the purity of the language, so it does not invalidate any program transformation. The reason storing the value of a thunk is sound is that it turns call-by-name evaluation into call-by-need, and as we saw above, this neither changes the values of terminating expressions, nor changes which expressions terminate.</p>\n\n<p>This approach can be somewhat problematic in a language that combines purely functional local evaluation with a multithreaded environment and message passing between threads. (This is notably the model of <a href=\"https://en.wikipedia.org/wiki/Erlang_(programming_language)\" rel=\"nofollow\">Erlang</a>.) If one thread starts evaluating a thunk, and another thread needs its value just then, what is going to happen? If no precautions are taken, then both threads will calculate the value and store it. In a pure language, this is harmless in the sense that both threads will calculate the same value anyway\u00b3. However this can hurt performance. To ensure that a thunk is evaluated only once, the calculation of the value must be wrapped in a lock; this helps with long calculations that are performed many times but hurts short calculations that are performed only once, as taking and releasing a lock takes some time.</p>\n\n<p>\u00b9 <sub> The function, not the function body of course. </sub><br>\n\u00b2 <sub> Or rather, the fragment of Haskell that doesn't use a side effect monad is pure. </sub><br>\n\u00b3 <sub> It is necessary for the transition between a delayed thunk and a computed value to be atomic \u2014\u00a0concurrent threads must be able to read a lazy value and get either a valid delayed thunk or a valid computed value, not some mixture of the two that isn't a valid object. At the processor level, the transition from delayed thunk to computed value is usually a pointer assignment, which on most architectures is atomic, fortunately. </sub>  </p>\n"}], "owner": {"reputation": 4761, "user_id": 2277395, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/09841ca82e49f998ea0b8f159dea87c1?s=128&d=identicon&r=PG", "display_name": "Martin Drautzburg", "link": "https://stackoverflow.com/users/2277395/martin-drautzburg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 740, "favorite_count": 1, "accepted_answer_id": 33793559, "answer_count": 3, "score": 9, "last_activity_date": 1449361396, "creation_date": 1447792863, "question_id": 33766559, "link": "https://stackoverflow.com/questions/33766559/can-every-functional-language-be-lazy", "title": "Can every functional language be lazy?", "body": "<p>In a functional language, functions are first class citizens and thus <em>calling</em> them is not the only thing I can do. I can also store them away. </p>\n\n<p>Now when I have a language, which is strict by default, then I am still not forced to evaluate a function call. I have the option to store the function and its parameters e.g. in a tuple for later evaluation. </p>\n\n<p>So instead of</p>\n\n<pre><code>x = f a b c\n</code></pre>\n\n<p>I do something like</p>\n\n<pre><code>x = (f,a,b,c)\n</code></pre>\n\n<p>And later, I can evaluate this thing with something like</p>\n\n<pre><code>eval (f,a,b,c) = f a b c\n</code></pre>\n\n<p>Well, there is probably more to it, because I want to evaluate each unevaluated function call only once, but it seems to me, that this can also be solved with a data structure which is a bit fancier than just a tuple.</p>\n\n<p>The inverse also seems to be the case, because e.g. in Haskell, which is lazy be default I can enforce evaluation with <code>seq</code> or <code>BangPatterns</code>.</p>\n\n<p>So is it correct to say, that every functional language has the potential of being lazy, but most of them are just not lazy <em>by default</em> and thus require additional programming effort to call a function lazily, whereas haskell <em>is</em> lazy by default and requires additional programming effort to call a function in a strict way?</p>\n\n<p>Should that be the case, what is more difficult for the programmer: writing lazy function calls in a strict language or writing strict function calls in a lazy language?</p>\n\n<p>As a side note: was Simon P. Jone serious when he said: \"the next version of haskell will be strict\". I first thought that this was a joke. But now I think <em>strict by default</em> isn't all that bad as long as you can be lazy if required.</p>\n"}, {"tags": ["haskell", "memory-management", "monitoring", "cpu-usage"], "comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 1, "creation_date": 1447834559, "post_id": 33766543, "comment_id": 55316242, "body": "Have you looked in <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/GHC-Stats.html\" rel=\"nofollow noreferrer\">GHC.Stats</a>?"}, {"owner": {"reputation": 480, "user_id": 4688042, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/07539504725306ff45b0e9c09e3e2699?s=128&d=identicon&r=PG", "display_name": "QuietJoon", "link": "https://stackoverflow.com/users/4688042/quietjoon"}, "reply_to_user": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1447848499, "post_id": 33766543, "comment_id": 55325671, "body": "@danidiaz Thanks, I didn&#39;t see that. <code>currentBytesUsed</code> seems memory usage. It works."}], "answers": [{"comments": [{"owner": {"reputation": 480, "user_id": 4688042, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/07539504725306ff45b0e9c09e3e2699?s=128&d=identicon&r=PG", "display_name": "QuietJoon", "link": "https://stackoverflow.com/users/4688042/quietjoon"}, "edited": false, "score": 0, "creation_date": 1447866238, "post_id": 33780191, "comment_id": 55338945, "body": "I have done many profiling with GHC and something other with <code>criterion</code>.   However, What I want is that monitoring a program&#39;s CPU usage in live."}, {"owner": {"reputation": 480, "user_id": 4688042, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/07539504725306ff45b0e9c09e3e2699?s=128&d=identicon&r=PG", "display_name": "QuietJoon", "link": "https://stackoverflow.com/users/4688042/quietjoon"}, "edited": false, "score": 0, "creation_date": 1447866675, "post_id": 33780191, "comment_id": 55339261, "body": "My purpose is not tuning program, but <b>find the moments that usage of CPU is low by itself</b> during running it."}, {"owner": {"reputation": 480, "user_id": 4688042, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/07539504725306ff45b0e9c09e3e2699?s=128&d=identicon&r=PG", "display_name": "QuietJoon", "link": "https://stackoverflow.com/users/4688042/quietjoon"}, "edited": false, "score": 0, "creation_date": 1448031891, "post_id": 33780191, "comment_id": 55424611, "body": "<code>ekg</code> may help monitoring and reporting something. However, it seems that does not help CPU usage by itself. To utilize <code>ekg</code>, I need a method to get CPU usage first."}], "tags": [], "owner": {"reputation": 3946, "user_id": 1261166, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/vL1Ud.jpg?s=128&g=1", "display_name": "Viktor Mellgren", "link": "https://stackoverflow.com/users/1261166/viktor-mellgren"}, "is_accepted": false, "score": 1, "last_activity_date": 1447927761, "last_edit_date": 1447927761, "creation_date": 1447849957, "answer_id": 33780191, "question_id": 33766543, "link": "https://stackoverflow.com/questions/33766543/how-to-monitor-cpu-and-memory-usage-itself-in-haskell-program/33780191#33780191", "title": "How to monitor cpu and memory usage itself in Haskell program", "body": "<p>I don't know if profiling is enough for you, or if you need live monitoring, but there is a lot of profiling possibilities described in the haskell docs <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/profiling.html\" rel=\"nofollow\">https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/profiling.html</a></p>\n\n<p>There is also remote monitoring</p>\n\n<p><a href=\"https://hackage.haskell.org/package/ekg\" rel=\"nofollow\">https://hackage.haskell.org/package/ekg</a></p>\n"}], "owner": {"reputation": 480, "user_id": 4688042, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/07539504725306ff45b0e9c09e3e2699?s=128&d=identicon&r=PG", "display_name": "QuietJoon", "link": "https://stackoverflow.com/users/4688042/quietjoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 912, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1447927761, "creation_date": 1447792836, "last_edit_date": 1447897286, "question_id": 33766543, "link": "https://stackoverflow.com/questions/33766543/how-to-monitor-cpu-and-memory-usage-itself-in-haskell-program", "title": "How to monitor cpu and memory usage itself in Haskell program", "body": "<p>In <strong>Haskell</strong> program, <strong>how to monitor CPU and memory usage by the program itself?</strong>  </p>\n\n<p>In my program, there could be idle time because of user does not make any request.<br>\nAt that time, I want to <code>evaluate</code> statistics to trigger GC.<br>\nHowever, I want to <em>record</em> statistics not by <em>static</em> methods but <em>lazy</em> method.<br>\nSo, I want to design the program could monitor itself to find the relative idle timing to <code>evaluate</code>.</p>\n\n<p>I've searched web and Hackage about {monitoring,cpu,memory} libraries, but I could find only total CPU and memory usages, not a program itself.</p>\n\n<p>Are there any monitoring libraries exist that I skipped?\nOr do I have to make something myself?<br>\nIf I have to make it myself, what should I study for? It should works with Windows, Linux and OS X.</p>\n\n<h1>Update</h1>\n\n<p><code>currentBytesUsed</code> in <code>GHC.Stats</code> gives memory usages. Thanks danidiaz.\nI'm still finding that monitoring CPU usages.</p>\n\n<p>P.S. I do not want to profile it. I have done it many times already....</p>\n"}, {"tags": ["haskell", "haskell-lens"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1447794834, "post_id": 33765507, "comment_id": 55301972, "body": "There&#39;s really no need for lenses for <code>isPrefixOf</code> or <code>isSuffixOf</code>. Just use <code>splitAt</code> followed by <code>==</code>. Or use the package danidiaz suggested, which does exactly this."}, {"owner": {"reputation": 949, "user_id": 1017252, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/90e3d67b15c2573bfc3821746de04dc0?s=128&d=identicon&r=PG", "display_name": "Omari Norman", "link": "https://stackoverflow.com/users/1017252/omari-norman"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1447810199, "post_id": 33765507, "comment_id": 55308076, "body": "@dfeuer - I presume you mean Data.Sequence.splitAt.  That&#39;s not polymorphic, which is part of the point of <code>lens</code>.  Even if it were, it&#39;s no direct substitute for <code>isSuffixOf</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1447816280, "post_id": 33765507, "comment_id": 55309759, "body": "For <code>isPrefixOf</code>, you could certainly use a <code>Getter</code> (or maybe a <code>Fold</code>?) to convert to lists and then use <code>isPrefixOf</code> directly. But for <code>isSuffixOf</code>, that will carry a potentially serious penalty."}], "answers": [{"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 4, "last_activity_date": 1447789942, "creation_date": 1447789942, "answer_id": 33765784, "question_id": 33765507, "link": "https://stackoverflow.com/questions/33765507/using-lens-for-access-to-a-data-sequence-seq/33765784#33765784", "title": "Using lens for access to a Data.Sequence.Seq", "body": "<p>This is not a lens-based answer, but the <a href=\"http://hackage.haskell.org/package/monoid-subclasses-0.4.1.2/docs/Data-Monoid-Cancellative.html\" rel=\"nofollow\">monoid-subclasses</a> package has the <a href=\"http://hackage.haskell.org/package/monoid-subclasses-0.4.1.2/docs/Data-Monoid-Cancellative.html#t:RightReductiveMonoid\" rel=\"nofollow\">RightReductiveMonoid</a> typeclass that offers <code>isSuffixOf</code>, and <a href=\"http://hackage.haskell.org/package/monoid-subclasses-0.4.1.2/docs/Data-Monoid-Cancellative.html#t:LeftReductiveMonoid\" rel=\"nofollow\">LeftReductiveMonoid</a> that offers <code>isPrefixOf</code>.</p>\n\n<p>List and Seq (along with many other containers) are instances of those typeclasses.</p>\n"}], "owner": {"reputation": 949, "user_id": 1017252, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/90e3d67b15c2573bfc3821746de04dc0?s=128&d=identicon&r=PG", "display_name": "Omari Norman", "link": "https://stackoverflow.com/users/1017252/omari-norman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1447789942, "creation_date": 1447788844, "question_id": 33765507, "link": "https://stackoverflow.com/questions/33765507/using-lens-for-access-to-a-data-sequence-seq", "title": "Using lens for access to a Data.Sequence.Seq", "body": "<p>Is there any way to use <code>lens</code> to get functionality similar to the functions in <code>Data.List</code>?  For instance I am thinking of something like</p>\n\n<pre><code>isPrefixOf :: Eq a =&gt; Seq a -&gt; Seq a -&gt; Bool\nisSuffixOf :: Eq a =&gt; Seq a -&gt; Seq a -&gt; Bool\n</code></pre>\n\n<p>And of course these functions would work on a list, vector, etc.  I would think <code>lens</code> could do this sort of thing but from the Haddocks it's not apparent to me.</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1447789270, "post_id": 33765355, "comment_id": 55298843, "body": "How is <code>a =&gt; b</code> a function type?"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 2, "creation_date": 1447789322, "post_id": 33765355, "comment_id": 55298874, "body": "@ReinHenrichs: it actually is. <code>=&gt;</code> is desugared to <code>-&gt;</code> in GHC Core."}, {"owner": {"reputation": 7421, "user_id": 626288, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0c9a3cd677038dce58433d8d48ab602a?s=128&d=identicon&r=PG", "display_name": "glaebhoerl", "link": "https://stackoverflow.com/users/626288/glaebhoerl"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1447789484, "post_id": 33765355, "comment_id": 55298965, "body": "@ReinHenrichs (A.K.A. dictionary passing.)"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1447790078, "post_id": 33765355, "comment_id": 55299322, "body": "I realize that typeclasses are implemented using dictionary passing, but it is just that: an implementation detail that the design of typeclasses is intended to hide. I wouldn&#39;t consider a value of type <code>a =&gt; b</code> to be a function <i>in Haskell</i>. It would be strange if a hypothetical <code>isFunction#</code> predicate returned <code>True</code> for such a type."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 2, "creation_date": 1447790225, "post_id": 33765355, "comment_id": 55299395, "body": "@ReinHenrichs: the issue is that we can&#39;t possibly distinguish <code>=&gt;</code> from <code>-&gt;</code> once we try to look at runtime objects."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1447790311, "post_id": 33765355, "comment_id": 55299450, "body": "@Andr&#225;sKov&#225;cs Ah, good point. That would make such a function impossible if you want it to give what I would consider to be correct results."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1447790799, "post_id": 33765355, "comment_id": 55299698, "body": "My (mildly educated) guess is that this is not possible in general. Is <code>mempty</code> a function? What about <code>mempty @()</code>? <code>mempty @(Endo ())</code>? In GHC, the latter two are both closures over identical code blocks; how are you planning to distinguish them?"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1447791121, "post_id": 33765355, "comment_id": 55299880, "body": "For example, the <code>a =&gt; b</code> case would imply that <code>1</code> is a function. I think this would be an unexpected result."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1447862248, "post_id": 33766086, "comment_id": 55336058, "body": "<code>seq</code> itself breaks parametricity."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1447862357, "post_id": 33766086, "comment_id": 55336140, "body": "Well, words are fuzzy. It doesn&#39;t break the same feature that <code>myseq</code> would."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1447867284, "post_id": 33766086, "comment_id": 55339637, "body": "More specifically, I think it&#39;s consistent with the idea of parametricity that all the types you can quantify over support some common operations. Then you will get correspondingly weaker guarantees from parametricity. But if you can write expressions of type <code>forall a. Int</code> whose value depends on the choice of the type <code>a</code>, then you have no form of parametricity at all."}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": true, "score": 4, "last_activity_date": 1447791090, "creation_date": 1447791090, "answer_id": 33766086, "question_id": 33765355, "link": "https://stackoverflow.com/questions/33765355/is-there-a-way-to-determine-at-runtime-in-ghc-whether-an-abstract-value-is-a-f/33766086#33766086", "title": "Is there a way to determine at runtime, in GHC, whether an abstract value is a function?", "body": "<p>No, surely not. How could it know without evaluating the argument?</p>\n\n<p>But to address your question X directly, your proposed <code>myseq</code> is worse than the real <code>seq</code> since it breaks parametricity. Is <code>myseq undefined :: b -&gt; b</code> bottom, or the identity? It depends on whether the type variable <code>a</code> (<code>undefined :: a</code>) was instantiated with a function type or not.</p>\n\n<p>In Haskell you are always allowed to drop a <code>forall a.</code> when <code>a</code> does not appear in the type at all, thanks to parametricity: the choice of <code>a</code> cannot matter. Your <code>myseq</code> would lose that property.</p>\n\n<p>This is also why you could not implement <code>isFunction#</code> without annotating values at runtime with their intended types (<code>isFunction# undefined</code> is similarly meaningless).</p>\n"}], "owner": {"reputation": 7421, "user_id": 626288, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0c9a3cd677038dce58433d8d48ab602a?s=128&d=identicon&r=PG", "display_name": "glaebhoerl", "link": "https://stackoverflow.com/users/626288/glaebhoerl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 1, "accepted_answer_id": 33766086, "answer_count": 1, "score": 6, "last_activity_date": 1447791223, "creation_date": 1447788310, "last_edit_date": 1490005771, "question_id": 33765355, "link": "https://stackoverflow.com/questions/33765355/is-there-a-way-to-determine-at-runtime-in-ghc-whether-an-abstract-value-is-a-f", "title": "Is there a way to determine at runtime, in GHC, whether an abstract value is a function?", "body": "<p>I wonder if it's possible to have a function (somewhat similar to <a href=\"https://hackage.haskell.org/package/ghc-prim-0.4.0.0/docs/GHC-Prim.html#v:dataToTag-35-\" rel=\"nofollow noreferrer\"><code>dataToTag#</code></a>) like:</p>\n\n<pre><code>isFunction# :: a -&gt; Bool\n</code></pre>\n\n<p>or likely equivalently:</p>\n\n<pre><code>isFunction# :: Any -&gt; Bool\n</code></pre>\n\n<p>which returns <code>True</code> iff the value passed in as an argument is of a type <code>a -&gt; b</code> (or, for that matter, <code>a =&gt; b</code>) at runtime for some types <code>a</code> and <code>b</code>, or a <code>newtype</code> whose underlying type is (so it \"sees through\" <code>newtype</code>s, but of course not <code>data</code>), without forcing its argument. I didn't see anything like this in <a href=\"https://hackage.haskell.org/package/ghc-prim-0.4.0.0/docs/GHC-Prim.html\" rel=\"nofollow noreferrer\">GHC.Prim</a> myself, but I may have missed something, or maybe it's possible with a manual CMM primop or something.</p>\n\n<p>Now that the question has occurred to me I'm curious about the answer for its own sake (<a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">question Y</a>), but the original reason it occurred to me (question X) is that the complaint usually levelled against <code>seq</code> is that it breaks eta equivalence by making it possible to observe the difference between <code>undefined</code> and <code>\\_ -&gt; undefined</code>, and I was wondering if it would be possible to make a version of <code>seq</code> (<code>myseq a = if isFunction# a then flip const a else seq a</code>) that's still \"magically polymorphic\" (works <code>forall a</code>), but simply leaves functions alone.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 0, "creation_date": 1447785617, "post_id": 33764456, "comment_id": 55296783, "body": "<code>dealWithIt = foldl f &quot;&quot;</code> already specifies the behavior for all possible arguments.  How would it make sense to define it again with another argument?"}, {"owner": {"reputation": 634, "user_id": 5093690, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a3c8f6b503d9ea35c843eda8d891479f?s=128&d=identicon&r=PG&f=1", "display_name": "qwe", "link": "https://stackoverflow.com/users/5093690/qwe"}, "reply_to_user": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 0, "creation_date": 1447786082, "post_id": 33764456, "comment_id": 55297040, "body": "Adding a special case has nothing to do with handling all possible arguments."}, {"owner": {"reputation": 633, "user_id": 5107759, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/33e659c0770221780a6fd21960909b6d?s=128&d=identicon&r=PG", "display_name": "joanbm", "link": "https://stackoverflow.com/users/5107759/joanbm"}, "edited": false, "score": 1, "creation_date": 1447786531, "post_id": 33764456, "comment_id": 55297271, "body": "The error message thrown out by compiler says that clear. These are different functions. Compare their signatures. If you need handle <i>special</i> arguments, you may use arguments pattern matching but keep same types. Or use guards, or if/case conditions."}, {"owner": {"reputation": 634, "user_id": 5093690, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a3c8f6b503d9ea35c843eda8d891479f?s=128&d=identicon&r=PG&f=1", "display_name": "qwe", "link": "https://stackoverflow.com/users/5093690/qwe"}, "edited": false, "score": 1, "creation_date": 1447786828, "post_id": 33764456, "comment_id": 55297451, "body": "But that&#39;s exactly what confuses me as both variants of my function have the same signature and accept a single argument of the same type. So where comes the error from?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1447789457, "post_id": 33764456, "comment_id": 55298947, "body": "This is a very reasonable question. The compiler could certainly expand the equations with fewer parameters. I believe it was simply a design choice to forbid that, so to provide a better error message when a parameter is accidentally forgotten instead of a cryptic type error. This design can be argued against, of course - it&#39;s a matter of preference."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 0, "creation_date": 1447788046, "post_id": 33765232, "comment_id": 55298151, "body": "Even <code>f x y = somethingWith x y</code> is syntactic sugar for <code>f = \\x y -&gt; somethingWith x y</code>, itself sugar for <code>f = \\x -&gt; (\\y -&gt; somethingWith x y)</code>, etc. It&#39;s always important to realise that, in a way, Haskell only exists of functions, applications, (saturated) constructor calls, and data deconstruction."}], "tags": [], "owner": {"reputation": 4328, "user_id": 1473927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AO6Ui.jpg?s=128&g=1", "display_name": "Jonathan Cast", "link": "https://stackoverflow.com/users/1473927/jonathan-cast"}, "is_accepted": true, "score": 4, "last_activity_date": 1447787806, "creation_date": 1447787806, "answer_id": 33765232, "question_id": 33764456, "link": "https://stackoverflow.com/questions/33764456/why-is-haskell-unable-to-resolve-the-number-of-arguments-automatically/33765232#33765232", "title": "Why is Haskell unable to resolve the number of arguments automatically?", "body": "<p>It's just a rule.  A definition of a function by cases:</p>\n\n<pre><code>f p0 p1 = e0\nf p2 p3 = e1\n</code></pre>\n\n<p>has to have the same number of patterns in the function arguments on the left-hand side for all equations.</p>\n\n<p>It's partly to simplify the definition of the language; the Haskell standard defines that function definition in terms of a <em>single</em> <code>case</code> expression:</p>\n\n<pre><code>f x0 x1 = case (x0, x1) of\n    (p0, p1) -&gt; e0\n    (p2, p3) -&gt; e1\n</code></pre>\n\n<p>Now consider what would happen if you could say</p>\n\n<pre><code>f p0 p1 = e0\nf p2 = e1 -- `e1` is a function\n</code></pre>\n\n<p>The language standard would have to handle that case specially, and define it as something like</p>\n\n<pre><code>f x0 x1 = case (x0, x1) of\n    (p0, p1) -&gt; e0\n    (p2, _) -&gt; e1 x1 -- Note that the argument to `e1` has to be supplied explicitly\n</code></pre>\n\n<p>That's an un-necessary complication for something that it's not normally sensible to do.</p>\n\n<p>Furthermore, consider the definition of <code>foldr</code>:</p>\n\n<pre><code>foldr f z [] = z\nfoldr f z (x:xn) = f x (foldr f z xn)\n</code></pre>\n\n<p>Suppose you were typing it in and you forgot the <code>f</code> on the first equation:</p>\n\n<pre><code>foldr z [] = z\nfoldr f z (x:xn) = f x (foldr f z xn)\n</code></pre>\n\n<p>The current rule allows typos like this to be caught: the compiler can complain that you have a different number of arguments in different equations.  Otherwise you would get some confusing type error, which would probably be difficult to debug.  (Probably you would get an error because <code>z</code> in the first equation has to have the same type as <code>f</code> in the second equation, and <code>z</code> in the first equation has to have the same type as <code>f x (foldr f z xn)</code> in the second equation, so the first argument to <code>foldr</code> has to have an infinite type.  Infinite type errors are typically not fun to debug.)</p>\n"}], "owner": {"reputation": 634, "user_id": 5093690, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a3c8f6b503d9ea35c843eda8d891479f?s=128&d=identicon&r=PG&f=1", "display_name": "qwe", "link": "https://stackoverflow.com/users/5093690/qwe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 398, "favorite_count": 1, "closed_date": 1447788188, "accepted_answer_id": 33765232, "answer_count": 1, "score": 4, "last_activity_date": 1447787806, "creation_date": 1447785187, "question_id": 33764456, "link": "https://stackoverflow.com/questions/33764456/why-is-haskell-unable-to-resolve-the-number-of-arguments-automatically", "closed_reason": "Duplicate", "title": "Why is Haskell unable to resolve the number of arguments automatically?", "body": "<p>I'm new to Haskell and I got confused by the following behavior:</p>\n\n<p>I have a function, called dealWithIt.  It looks like this:</p>\n\n<pre><code>dealWithIt :: (Show a) =&gt; [a] -&gt; String\ndealWithIt = foldl f \"\"\n  where f memo x = memo ++ (show x)\n</code></pre>\n\n<p>All good, it's working as expected, it gets a list of showables and concatenates them into a single string.</p>\n\n<p>As much as I understand, it doesn't matter if I explicitly specify the argument received as long as it can be passed to the underlying chain of functions.  That means the following two definitions should be equivalent:</p>\n\n<pre><code>dealWithIt xs = foldl f \"\" xs\ndealWithIt = foldl f \"\"\n</code></pre>\n\n<p>So far so good. Let's say I want to add now a special case scenario by pattern matching:</p>\n\n<pre><code>dealWithIt [] = \"Empty list :(\"\n</code></pre>\n\n<p>This is where things get weird. If I don't explicitly specify the xs argument, I get the following error:</p>\n\n<pre><code>Equations for \u2018dealWithIt\u2019 have different numbers of arguments\n</code></pre>\n\n<p>I can live with it, but it's really interesting to me why is Haskell unable to detect what's going on and reports an error even when both variants take a single argument?</p>\n"}, {"tags": ["list", "haskell", "set"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1447780472, "post_id": 33762930, "comment_id": 55293668, "body": "Do they still make compilers that say &quot;hi there, you have a syntax error, bye&quot;? Upgrade to GHC, you will have at least a line number and an offending token."}, {"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 0, "creation_date": 1447780539, "post_id": 33762930, "comment_id": 55293723, "body": "I wonder if it may be just the lack of indentation of <code>unions</code> under <code>fun (Branche 0 \u2026</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1447780540, "post_id": 33762930, "comment_id": 55293726, "body": "Note that the <code>unions ...</code>  lines <i>must</i> be indented more than the <code>fun (Branche ...</code> line. Otherwise, <code>unions ...</code> seems to start a definition of a new function named <code>union</code>, and the parser gets confused."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1447780711, "post_id": 33762930, "comment_id": 55293831, "body": "By the way, there&#39;s no need to use <code>\\liste -&gt; sort liste</code>. Thanks to the eta law, you can simply use <code>sort</code> instead -- e.g. <code>map sort listWithDoubles</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1447780876, "post_id": 33762930, "comment_id": 55293946, "body": "@n.m. In the lolcode programming language, &quot;kthxbye&quot; is a language construct IIRC, so that error style would be completely idiomatic, I guess ;-)"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1447781901, "post_id": 33762930, "comment_id": 55294625, "body": "@chi: &quot;U haz syntax error, fix plz, kthxbye!&quot;"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1447791437, "post_id": 33762930, "comment_id": 55300076, "body": "I will summarily vote to close all questions about compiler errors that do not include the compiler error message."}], "owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1447783040, "creation_date": 1447780022, "last_edit_date": 1447783040, "question_id": 33762930, "link": "https://stackoverflow.com/questions/33762930/haskell-parse-error-on-set-int", "title": "haskell : parse error on Set [Int]", "body": "<p>I am trying to create a set of lists of int : </p>\n\n<pre><code>r\u00e9colte :: Arbre -&gt; Set [Int]\n</code></pre>\n\n<p>but I get a parser error while trying to implement the function r\u00e9colte.\nThe line where the error consist of taking the \"unions\" of 3 lists; each list contains one set of [Int].</p>\n\n<p>here is the code:</p>\n\n<pre><code>r\u00e9colte :: Arbre -&gt; Set [Int]\nr\u00e9colte a =\n  let fun :: Arbre -&gt; [Int] -&gt; Set [Int]\n      --retourner essai res+2 enf\n      fun (Feuille 1 [])  _ =  singleton [1]\n      --les branches 0 sont des partitions en 2  =&gt; que 2 enfants\n      fun (Branche 0 ys@(y1:y2:[])) acc =\n---&gt;  unions ( [singleton ([valeur y  | y &lt;- ys] ++ acc) ++\n---&gt;    [fun y1 (acc ++ [valeur y2] )] ++\n---&gt;    [fun y2 (acc ++ [valeur y1] )])\n      fun (Branche _ ys) acc = unions [fun y acc  | y &lt;- ys]  --branche i ys\n      listWithDoubles = fun a [] -- enlever doublons\n  in map (\\liste -&gt; sort liste ) listWithDoubles\n</code></pre>\n\n<p>do you see a parser error? I don't think it is necessary to understand the meaning of this function to debug it, althought I know it's meaning but can't see the error!</p>\n\n<p>I thought the re is maybe something to add : the set of lists of int should know how to order lists of ints (with compare) but I'm not sure about it, and it should not produce a parser error... </p>\n\n<p>maybe you will be able to help me!</p>\n\n<p>EDIT : </p>\n\n<p>resolved! there were 2 errors : one of indentation unions was at the same column as the declaration of fun, and after \"acc\" there must be a closing bracket. \nthanks anyway, it is not easy to solve an error without knowing what it does!</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 4, "creation_date": 1447775549, "post_id": 33761263, "comment_id": 55290085, "body": "<code>type IntL = [Int,Int,Int,Int]</code> shouldn&#39;t work at all."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1447780466, "post_id": 33761263, "comment_id": 55293666, "body": "@BartekBanachewicz In GHC 7.10 it suggests enabling <code>DataKinds</code> so to exploit the type-to-kinds lifting. If one does so then one gets <code>IntL :: [*]</code>, i.e. <code>IntL</code> is a list of types. Unfortunately, this is not what the OP is asking for."}], "answers": [{"comments": [{"owner": {"reputation": 1704, "user_id": 72790, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/76abb2c4a277e364a018a9958c7b63c6?s=128&d=identicon&r=PG", "display_name": "Cristiano Paris", "link": "https://stackoverflow.com/users/72790/cristiano-paris"}, "edited": false, "score": 6, "creation_date": 1447777211, "post_id": 33761359, "comment_id": 55291278, "body": "It depends. There is a lot of difference between a list of 4 elements and a list of MAXIMUM 4 elements."}], "tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": true, "score": 6, "last_activity_date": 1447775673, "creation_date": 1447775673, "answer_id": 33761359, "question_id": 33761263, "link": "https://stackoverflow.com/questions/33761263/defining-how-long-a-list-can-be-in-haskell/33761359#33761359", "title": "Defining how long a list can be in Haskell", "body": "<p>This is problematic in Haskell because phantom types encoding sizes need proper compiler support (otherwise it's pretty annoying to use), and type nats in GHC appeared somewhat recently.</p>\n\n<p>That being said <a href=\"https://hackage.haskell.org/package/fixed-vector-0.6.3.1/docs/Data-Vector-Fixed.html\">libraries</a> <a href=\"https://hackage.haskell.org/package/fixed-list\">exist</a>, just to give you an idea.</p>\n\n<p>Alternatively, just use a tuple.</p>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1447783561, "post_id": 33761894, "comment_id": 55295570, "body": "I&#39;ve downvoted. The answer appears to be incorrect (e.g. <code>Maybe (a, Maybe (a, Maybe (a, Maybe a)))</code> is a pretty basic Haskell type, and looks a lot like a list with a maximum length), and the comment redirecting the user to monads and <code>IO</code> looks off-target to me."}, {"owner": {"reputation": 1704, "user_id": 72790, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/76abb2c4a277e364a018a9958c7b63c6?s=128&d=identicon&r=PG", "display_name": "Cristiano Paris", "link": "https://stackoverflow.com/users/72790/cristiano-paris"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447800343, "post_id": 33761894, "comment_id": 55304782, "body": "Fair. My answer was actually a non-answer which may not be the perfect fit for Stackoverflow yet I find it a one more suitable for a newbie."}], "tags": [], "owner": {"reputation": 1704, "user_id": 72790, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/76abb2c4a277e364a018a9958c7b63c6?s=128&d=identicon&r=PG", "display_name": "Cristiano Paris", "link": "https://stackoverflow.com/users/72790/cristiano-paris"}, "is_accepted": false, "score": -1, "last_activity_date": 1447777085, "creation_date": 1447777085, "answer_id": 33761894, "question_id": 33761263, "link": "https://stackoverflow.com/questions/33761263/defining-how-long-a-list-can-be-in-haskell/33761894#33761894", "title": "Defining how long a list can be in Haskell", "body": "<p>Basic Haskell Types are not so powerful as to encode the maximum length of a list. In order to do that, you must rely on extensions such as GADTs and Phantom Types and yet it is not straightforward as well.</p>\n\n<p>If you are really a newbie, I advice you to learn other basic concepts like Monads, IO and other idioms.</p>\n\n<p>This site is a very good reading for an initial approach to Haskell:</p>\n\n<p><a href=\"http://learnyouahaskell.com\" rel=\"nofollow\">http://learnyouahaskell.com</a></p>\n"}, {"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 5, "last_activity_date": 1447777369, "creation_date": 1447777369, "answer_id": 33761996, "question_id": 33761263, "link": "https://stackoverflow.com/questions/33761263/defining-how-long-a-list-can-be-in-haskell/33761996#33761996", "title": "Defining how long a list can be in Haskell", "body": "<p>it might look stupid and it certainly does not scale but what about</p>\n\n<pre><code>data Max4 a\n   = Empty\n   | One a\n   | Two a a\n   | Three a a a\n   | Four a a a a\n</code></pre>\n\n<p>with <code>type IntL = Max4 Int</code>? It's basic, you should be able to understand it and you can learn a lot by implementing operations on it.</p>\n"}], "owner": {"reputation": 505, "user_id": 5449377, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/5c1b0852a7e9e7a953ae50583dcd09e1?s=128&d=identicon&r=PG&f=1", "display_name": "Neo Streets", "link": "https://stackoverflow.com/users/5449377/neo-streets"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 33761359, "answer_count": 3, "score": 1, "last_activity_date": 1447777369, "creation_date": 1447775457, "question_id": 33761263, "link": "https://stackoverflow.com/questions/33761263/defining-how-long-a-list-can-be-in-haskell", "title": "Defining how long a list can be in Haskell", "body": "<p>So I'm new to Haskell and i'm trying to define a list which is a Max of 4 elements long.\nso far I have <code>type IntL = [Int,Int,Int,Int]</code>\nbut I was thinking there must be a better/proper way of doing this.\nIs there?</p>\n"}, {"tags": ["haskell", "alex"], "comments": [{"owner": {"reputation": 169, "user_id": 711316, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fa662528f2f8ecddad27a568d037d80f?s=128&d=identicon&r=PG", "display_name": "dfordivam", "link": "https://stackoverflow.com/users/711316/dfordivam"}, "edited": false, "score": 2, "creation_date": 1447771043, "post_id": 33758728, "comment_id": 55286670, "body": "This looks like an issue with building alex with cabal/stack. If I build the alex from its latest github source, then its wrapper looks fine. Opened the issue here for tracking <a href=\"https://github.com/simonmar/alex/issues/73\" rel=\"nofollow noreferrer\">github.com/simonmar/alex/issues/73</a>."}], "answers": [{"tags": [], "owner": {"reputation": 169, "user_id": 711316, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fa662528f2f8ecddad27a568d037d80f?s=128&d=identicon&r=PG", "display_name": "dfordivam", "link": "https://stackoverflow.com/users/711316/dfordivam"}, "is_accepted": false, "score": 1, "last_activity_date": 1447848811, "creation_date": 1447848811, "answer_id": 33779771, "question_id": 33758728, "link": "https://stackoverflow.com/questions/33758728/alex-wrappers-hs-no-instance-of-applicative/33779771#33779771", "title": "Alex wrappers.hs no instance of Applicative", "body": "<p>This is a workaround for this problem. Basically this involves building the alex from latest source code and modifying the local wrapper. Though this worked for me, but it can have some unknown issues also.</p>\n\n<pre><code>mkdir tmp; cd tmp;\ngit clone https://github.com/simonmar/alex.git\ncd alex;\ngit checkout 3b7e8e4; \ncabal build;\n</code></pre>\n\n<p>Then copy the 'AlexWrapper-monad-bytestring' generated in this directory to the one in your local alex installation.\nFor example</p>\n\n<pre><code>cp AlexWrapper-monad-bytestring ~/.stack/snapshots/x86_64-linux/lts-3.14/7.10.2/share/x86_64-linux-ghc-7.10.2/alex-3.1.4/AlexWrapper-monad-bytestring\n</code></pre>\n\n<p>The reason behind building from '3b7e8e4' is that the commit '447bbb8' breaks the  compilation of wrapper due to introduction of an extra feature.</p>\n"}], "owner": {"reputation": 169, "user_id": 711316, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fa662528f2f8ecddad27a568d037d80f?s=128&d=identicon&r=PG", "display_name": "dfordivam", "link": "https://stackoverflow.com/users/711316/dfordivam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1447848811, "creation_date": 1447768491, "question_id": 33758728, "link": "https://stackoverflow.com/questions/33758728/alex-wrappers-hs-no-instance-of-applicative", "title": "Alex wrappers.hs no instance of Applicative", "body": "<p>I am trying to compile a lex.x with ghc 7.10.2 and alex 3.1.4, but it is giving the below error.\nI checked Lex.hs and indeed there is no applicative instance for 'Alex' there.</p>\n\n<p>Note: This error started coming after I moved from wrapper 'monad' to 'monad-bytestring'</p>\n\n<pre><code>templates/wrappers.hs:287:10:\n    No instance for (Applicative Alex)\n      arising from the superclasses of an instance declaration\n    In the instance declaration for \u2018Monad Alex\u2019\n</code></pre>\n\n<p>I saw that in alex 3.1.4 this was fixed <a href=\"http://hackage.haskell.org/package/alex\" rel=\"nofollow\">http://hackage.haskell.org/package/alex</a></p>\n\n<pre><code>Changes in 3.1.4:\n\n    Add Applicative/Functor instances for GHC 7.10\n</code></pre>\n\n<p>Below commit introduced the applicative instance, but it is not present in my generated Lex.hs. Can I manually use the below wrapper to be used for generating Lex.hs?</p>\n\n<p><a href=\"https://github.com/simonmar/alex/commit/b1472bfbb7b95bcd6c66558197e2603997d9ce0b\" rel=\"nofollow\">https://github.com/simonmar/alex/commit/b1472bfbb7b95bcd6c66558197e2603997d9ce0b</a></p>\n"}, {"tags": ["file", "haskell", "binary", "reverse"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1447768694, "post_id": 33758150, "comment_id": 55284998, "body": "Well, you could use the <code>Handle</code> with <code>hSeek</code>, jump repeatedly back from the end of the file and read the file in chunks. Getting those chunks right will be the hard part."}, {"owner": {"reputation": 4377, "user_id": 363777, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1EIja.jpg?s=128&g=1", "display_name": "Tobi Nary", "link": "https://stackoverflow.com/users/363777/tobi-nary"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1447778342, "post_id": 33758150, "comment_id": 55292118, "body": "In terms of efficiency, there is no difference in expected run time for all possible inputs; a function as proposed by @Zeta would probably be slower for inputs that have their last matched word fairly at the beginning. If you have no other knowledge over the input, your approach seems fine. Other than that, you could use seeking backwards. But this might cause problems depending on the hard drive (as consecutive reading is faster because there is no seeking needed for the hard drive.)"}, {"owner": {"reputation": 2561, "user_id": 674108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ab092f16c59df8ba1ba1e113e1d322?s=128&d=identicon&r=PG", "display_name": "Jeff Burka", "link": "https://stackoverflow.com/users/674108/jeff-burka"}, "edited": false, "score": 0, "creation_date": 1447793865, "post_id": 33758150, "comment_id": 55301423, "body": "This would not be as small a change as you&#39;re looking for, but consider using the <a href=\"http://hackage.haskell.org/package/mmap-0.5.9/docs/System-IO-MMap.html\" rel=\"nofollow noreferrer\">MMap package</a> to only load the part of the file you need."}], "answers": [{"comments": [{"owner": {"reputation": 1339, "user_id": 3903368, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/877a8ca04b687363623f8e28b255b2e9?s=128&d=identicon&r=PG&f=1", "display_name": "Gilly", "link": "https://stackoverflow.com/users/3903368/gilly"}, "edited": false, "score": 0, "creation_date": 1448186703, "post_id": 33770414, "comment_id": 55471451, "body": "Thanks. I really like solution 3 here: seeking through data chunks which can be reversed. It is flexible enough to still be used within the framework I have."}, {"owner": {"reputation": 1339, "user_id": 3903368, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/877a8ca04b687363623f8e28b255b2e9?s=128&d=identicon&r=PG&f=1", "display_name": "Gilly", "link": "https://stackoverflow.com/users/3903368/gilly"}, "edited": false, "score": 0, "creation_date": 1448186806, "post_id": 33770414, "comment_id": 55471476, "body": "Very comprehensive answer too, thanks for your time :)"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 1, "last_activity_date": 1447811195, "creation_date": 1447811195, "answer_id": 33770414, "question_id": 33758150, "link": "https://stackoverflow.com/questions/33758150/haskell-read-a-binary-file-backwards/33770414#33770414", "title": "Haskell: Read a binary file backwards", "body": "<p>Some comments on your code:</p>\n\n<ol>\n<li><p>You are using <code>last</code> which could throw an exception. You should use <code>lastMay</code> fromthe <a href=\"https://hackage.haskell.org/package/safe\" rel=\"nofollow\"><strong>safe</strong></a> package which returns a Maybe.</p></li>\n<li><p>Since you are just treating the file as a vector of Word32s, I don't think it's worth using Data.Binary.Get and the associated overhead and complexity that it entails. Just treat the file as a (perhaps lazy) ByteString and access every 4th byte or break it up into 4-byte substrings.</p></li>\n</ol>\n\n<p>You can have a look at code which uses ByteStrings <a href=\"https://github.com/erantapaa/read-word32\" rel=\"nofollow\">here</a>. It implements the following approaches to the problem:</p>\n\n<ul>\n<li><p>Read in the entire file as a lazy ByteString and produce a (lazy) list of 4-byte substrings. Return the last substring which satisifies the criteria.</p>\n\n<pre><code>intoWords :: BL.ByteString -&gt; [ BL.ByteString ]\nintoWords bs\n  | BL.null a = []\n  | otherwise = a : intoWords b\n  where (a,b) = BL.splitAt 4 bs\n\n-- find by breaking the file into 4-byte words\nfind_C0_v1 :: FilePath -&gt; IO (Maybe BL.ByteString)\nfind_C0_v1 path = do\n  contents &lt;- BL.readFile path\n  return $ lastMay . filter (\\bs -&gt; BL.index bs 0 == 0xC0) . intoWords $ contents\n</code></pre></li>\n<li><p>Read in the entire file as a lazy ByteString and access every 4-th byte looking for a 0xC0. Return the last occurrence.</p>\n\n<pre><code>-- find by looking at every 4th byte\nfind_C0_v2 :: FilePath -&gt; IO (Maybe BL.ByteString)\nfind_C0_v2 path = do\n  contents &lt;- BL.readFile path\n  size &lt;- fmap fromIntegral $ withFile path ReadMode hFileSize\n  let wordAt i = BL.take 4 . BL.drop i $ contents\n  return $ fmap wordAt $ lastMay $ filter (\\i -&gt; BL.index contents i == 0xC0) [0,4..size-1]\n</code></pre></li>\n<li><p>Read the file in backwards in chunks of 64K. Within each chunk (which is a strict ByteString) access every 4th byte looking for a 0xC0 starting from the end of the chunk. Return the first occurrence.</p>\n\n<pre><code>-- read a file backwords until a predicate returns a Just value\nloopBlocks :: Int -&gt; Handle -&gt; Integer -&gt; (BS.ByteString -&gt; Integer -&gt; Maybe a) -&gt; IO (Maybe a)\nloopBlocks blksize h top pred\n  | top &lt;= 0 = return Nothing\n  | otherwise   = do\n        let offset = top - fromIntegral blksize\n        hSeek h AbsoluteSeek offset\n        blk &lt;- BS.hGet h blksize\n        case pred blk offset of\n          Nothing -&gt; loopBlocks blksize h offset pred\n          x       -&gt; return x\n\n-- find by reading backwords lookint at every 4th byte\nfind_C0_v3 :: FilePath -&gt; IO (Maybe Integer)\nfind_C0_v3 path = do\n  withFile path ReadMode $ \\h -&gt; do\n    size &lt;- hFileSize h\n    let top = size - (mod size 4)\n        blksize = 64*1024 :: Int\n    loopBlocks blksize h top $ \\blk offset -&gt;\n          fmap ( (+offset) . fromIntegral ) $ headMay $ filter (\\i -&gt; BS.index blk i == 0xC0) [blksize-4,blksize-8..0]\n</code></pre></li>\n</ul>\n\n<p>The third method is the fastest even if it has to read in the entire file. The first method actually works pretty well. I wouldn't recommend the second at all - its performance degrades precipitously as the file size grows.</p>\n"}, {"comments": [{"owner": {"reputation": 336, "user_id": 1652363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d83756ee9bde34906be8d986391450f?s=128&d=identicon&r=PG", "display_name": "npouillard", "link": "https://stackoverflow.com/users/1652363/npouillard"}, "edited": false, "score": 0, "creation_date": 1465218289, "post_id": 33853796, "comment_id": 62795137, "body": "The function <code>makeReverseChunks</code> is currently quite strict. The use of lazy bytestrings is not helping. In order to achieve lazy reading one must use <code>unsafeInterleaveIO</code>. Here is a solution using strict bytestrings, lazy IO, and tail recursion."}], "tags": [], "owner": {"reputation": 1339, "user_id": 3903368, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/877a8ca04b687363623f8e28b255b2e9?s=128&d=identicon&r=PG&f=1", "display_name": "Gilly", "link": "https://stackoverflow.com/users/3903368/gilly"}, "is_accepted": false, "score": 0, "last_activity_date": 1448190185, "last_edit_date": 1448190185, "creation_date": 1448188267, "answer_id": 33853796, "question_id": 33758150, "link": "https://stackoverflow.com/questions/33758150/haskell-read-a-binary-file-backwards/33853796#33853796", "title": "Haskell: Read a binary file backwards", "body": "<p>For any others who may be interested, I have adapted @ErikR's answer. This solution follows his proposed solution 3, but makes use of my existing code, by stepping through blocks in reverse lazily.</p>\n\n<p>This requires a few extra imports:</p>\n\n<pre><code>import System.IO\nimport Safe\nimport Data.Maybe\n</code></pre>\n\n<p><code>main</code> becomes:</p>\n\n<pre><code>main = do\n  args &lt;- getArgs\n  let file = args!!0\n  putStrLn $ \"Find last 0xCXXXXXXX in \" ++ file\n\n  -- forward\n  withFile file ReadMode $ \\h -&gt; do\n    content &lt;- BL.hGetContents h\n    let packets = getPackets content\n    putStrLn . show . getValue . last . filterTimes $ packets\n\n  -- reverse\n  withFile file ReadMode $ \\h -&gt; do\n    size &lt;- hFileSize h\n    let blksize = 64*1024 :: Int\n    chunks &lt;- makeReverseChunks blksize h (fromIntegral size)\n    putStrLn . show . getValue . (fromMaybe 0) . headMay . catMaybes . (map $ lastMay . filterTimes . getPackets) $ chunks\n</code></pre>\n\n<p>With an added helper function:</p>\n\n<pre><code>-- create list of data chunks, backwards in order through the file\nmakeReverseChunks :: Int -&gt; Handle -&gt; Int -&gt; IO [BL.ByteString]\nmakeReverseChunks blksize h top\n  | top == 0 = return []\n  | top &lt; 0  = error \"negative file index\"\n  | otherwise   = do\n        let offset = max (top - fromIntegral blksize) 0\n        hSeek h AbsoluteSeek (fromIntegral offset)\n        blk &lt;- BL.hGet h blksize\n        rest &lt;- makeReverseChunks blksize h offset\n        return $ blk : rest\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 336, "user_id": 1652363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d83756ee9bde34906be8d986391450f?s=128&d=identicon&r=PG", "display_name": "npouillard", "link": "https://stackoverflow.com/users/1652363/npouillard"}, "is_accepted": false, "score": 0, "last_activity_date": 1465219095, "creation_date": 1465219095, "answer_id": 37658562, "question_id": 33758150, "link": "https://stackoverflow.com/questions/33758150/haskell-read-a-binary-file-backwards/37658562#37658562", "title": "Haskell: Read a binary file backwards", "body": "<p>Here is a variation of the function <code>makeReverseChunks</code>. It was currently quite strict. Moreover the use of lazy bytestrings is not helping if one keep the blksize low enough. In order to achieve lazy reading one must use <code>unsafeInterleaveIO</code>. Here is a solution using strict bytestrings and lazy IO:</p>\n\n<pre><code>-- create list of data chunks, backwards in order through the file\nmakeReverseChunks :: Int -&gt; Handle -&gt; Int -&gt; IO [SBS.ByteString]\nmakeReverseChunks blksize h top\n  | top == 0 = return []\n  | top &lt; 0  = error \"negative file index\"\n  | otherwise   = do\n    let offset = max (top - fromIntegral blksize) 0\n    hSeek h AbsoluteSeek (fromIntegral offset)\n    blk &lt;- SBS.hGet h blksize\n    rest &lt;- unsafeInterleaveIO $ makeReverseChunks blksize h offset\n    return $ blk : rest\n</code></pre>\n"}], "owner": {"reputation": 1339, "user_id": 3903368, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/877a8ca04b687363623f8e28b255b2e9?s=128&d=identicon&r=PG&f=1", "display_name": "Gilly", "link": "https://stackoverflow.com/users/3903368/gilly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 433, "favorite_count": 0, "accepted_answer_id": 33770414, "answer_count": 3, "score": 0, "last_activity_date": 1465219095, "creation_date": 1447766828, "last_edit_date": 1447793355, "question_id": 33758150, "link": "https://stackoverflow.com/questions/33758150/haskell-read-a-binary-file-backwards", "title": "Haskell: Read a binary file backwards", "body": "<p>I'm looking to find the last 32bit word in an uInt32 binary dump matching a particular pattern using Haskell. I am able to complete the task using <code>last</code>, however the code must trawl through the entire file so it is rather inefficient.</p>\n\n<p>Is there a simple way to make <code>readfile</code> operate through the file in reverse? I believe this would solve the issue with the smallest change to the current code.</p>\n\n<p>Here is my current code, for reference. I only began with Haskell this weekend so I am sure it is quite ugly. It looks for the last 32 bit word beginning with 0b10 at the MSB.</p>\n\n<pre><code>import System.Environment(getArgs)\nimport qualified Data.ByteString.Lazy as BL\nimport qualified Data.ByteString.Lazy.Internal as BL\nimport qualified Data.ByteString as BS\nimport Data.Binary.Get\nimport Data.Word\nimport Data.Bits\nimport Text.Printf(printf)\n\nmain = do\n  args &lt;- getArgs\n  let file = args!!0\n  putStrLn $ \"Find last 0xCXXXXXXX in \" ++ file\n\n  content &lt;- BL.readFile file\n\n  let packets = getPackets content\n  putStrLn . show . getValue . last . filterTimes $ packets\n\n-- Data\n\ntype Packet = Word32\n\n-- filter where first 2 bits are 10\nfilterTimes :: [Packet] -&gt; [Packet]\nfilterTimes = filter ((== 0x2) . tag)\n\n-- get the first 2 bits\ntag :: Packet -&gt; Packet\ntag rp =\n  let tagSize = 2\n  in  shiftR rp (finiteBitSize rp - tagSize)\n\n-- remove the tag bits\ngetValue :: Packet -&gt; Packet\ngetValue =\n  let tagSize = 2\n      mask    = complement $ rotateR (2^tagSize - 1) tagSize\n  in (.&amp;.) mask\n\n-- Input\n-- Based on https://hackage.haskell.org/package/binary/docs/Data-Binary-Get.html\n\ngetPacket :: Get Packet\ngetPacket = do\n  packet &lt;- getWord32le\n  return $! packet\n\ngetPackets :: BL.ByteString -&gt; [Packet]\ngetPackets input0 = go decoder input0\n  where\n    decoder = runGetIncremental getPacket\n    go :: Decoder Packet -&gt; BL.ByteString -&gt; [Packet]\n    go (Done leftover _consumed packet) input =\n      packet : go decoder (BL.chunk leftover input)\n    go (Partial k) input                     =\n      go (k . takeHeadChunk $ input) (dropHeadChunk input)\n    go (Fail _leftover _consumed msg) _input =\n      []\n\ntakeHeadChunk :: BL.ByteString -&gt; Maybe BS.ByteString\ntakeHeadChunk lbs =\n  case lbs of\n    (BL.Chunk bs _) -&gt; Just bs\n    _ -&gt; Nothing\n\ndropHeadChunk :: BL.ByteString -&gt; BL.ByteString\ndropHeadChunk lbs =\n  case lbs of\n    (BL.Chunk _ lbs') -&gt; lbs'\n    _ -&gt; BL.Empty\n</code></pre>\n"}, {"tags": ["haskell", "cabal", "hunit"], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": false, "score": 0, "last_activity_date": 1456525408, "creation_date": 1456525408, "answer_id": 35662859, "question_id": 33758125, "link": "https://stackoverflow.com/questions/33758125/cabal-and-hunit-interaction/35662859#35662859", "title": "Cabal and HUnit interaction", "body": "<p>The problem is that <code>AG.gamma</code> is of type <code>Test</code>, since <code>TestCase :: Assertion -&gt; Test</code>.</p>\n\n<p>So HUnit has one way of creating trees of tests, and <code>test-framework</code> has another way of creating trees of tests, using the function <code>testCase :: TestName -&gt; Assertion -&gt; Test</code>.</p>\n\n<p>Hence You can't take an <code>HUnit.Test</code> and pass it to <code>testCase</code>. But it turns out you <em>can</em> take an <code>HUnit.Test</code> and <em>convert</em> it to a <code>test-framework</code> test (or rather a list of them). </p>\n\n<p>Use the other function from the <code>test-framework</code> module:</p>\n\n<pre><code>hUnitTestToTests :: HUnit.Test -&gt; [TestFramework.Test]\n</code></pre>\n\n<p>(signature augmented to show where modules come from).</p>\n\n<p>See here for more details:</p>\n\n<p><a href=\"https://hackage.haskell.org/package/test-framework-hunit-0.3.0.2/docs/Test-Framework-Providers-HUnit.html\" rel=\"nofollow\">https://hackage.haskell.org/package/test-framework-hunit-0.3.0.2/docs/Test-Framework-Providers-HUnit.html</a></p>\n"}], "owner": {"reputation": 2641, "user_id": 1225786, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/7f0251000ccaade065dde90c38e9525e?s=128&d=identicon&r=PG", "display_name": "Christophe De Troyer", "link": "https://stackoverflow.com/users/1225786/christophe-de-troyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 252, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1456525408, "creation_date": 1447766765, "question_id": 33758125, "link": "https://stackoverflow.com/questions/33758125/cabal-and-hunit-interaction", "title": "Cabal and HUnit interaction", "body": "<p>I am trying to get a simple unit test to work, written in HUnit.</p>\n\n<p>The module I have put the test in is named \"MyTests\".</p>\n\n<pre><code>module MyTests where\nimport qualified Test.HUnit    as H\ngamma = H.TestCase (H.assertEqual \"foo\" 1 1)\n-- Run the tests from the REPL\nrunTestTT $ H.TestList [H.TestLabel \"foo\" gamma]\n</code></pre>\n\n<p>I can run this module perfectly fine from the cabal repl:</p>\n\n<pre><code>\u03bb&gt; run\nCases: 1  Tried: 1  Errors: 0  Failures: 0\nCounts {cases = 1, tried = 1, errors = 0, failures = 0}\n</code></pre>\n\n<p>I want to integrate these tests with Cabal such that I can run <code>cabal test</code>.</p>\n\n<p>From a few hours of googling I found that I should be able to test my application using the following seqeuence:</p>\n\n<pre><code>cabal configure --enable-tests &amp;&amp; cabal build tests &amp;&amp; cabal test\n</code></pre>\n\n<p>I have inserted the following in my .cabal file:</p>\n\n<pre><code>Test-Suite tests\n    type:           exitcode-stdio-1.0\n    main-is:        Main.hs\n    hs-source-dirs: test src\n    test-module:    YourTestModule\n    build-depends:  base\n                  , HUnit\n                  , Cabal\n                  , QuickCheck\n                  , test-framework\n                  , test-framework-hunit\n                  , test-framework-quickcheck2\n</code></pre>\n\n<p>In the <code>Main.hs</code> file under the <code>test/</code> folder I have the following:</p>\n\n<pre><code>module Main where\n\nimport Test.Framework (defaultMain, testGroup)\nimport Test.Framework.Providers.HUnit\nimport Test.Framework.Providers.QuickCheck2 (testProperty)\n\nimport Test.QuickCheck\nimport Test.HUnit\n\nimport Data.List\n\nimport qualified MyTests as AG\n\n\nmain = defaultMain tests\n\ntests = [\n        testGroup \"Some group\" [\n                testCase \"foo\" AG.gamma        \n            ]\n    ]\n</code></pre>\n\n<p>This obviously returns an error:</p>\n\n<pre><code>test/Main.hs:19:32:\n    Couldn't match type \u2018Test\u2019 with \u2018IO ()\u2019\n    Expected type: Assertion\n      Actual type: Test\n    In the second argument of \u2018testCase\u2019, namely \u2018AG.gamma\u2019\n    In the expression: testCase \"foo\" AG.gamma\n</code></pre>\n\n<p>I really like the HUnit tests I have written so far (this is a MWE) and I wonder hw I can integrate these tests with eachother?</p>\n"}, {"tags": ["list", "haskell", "types", "functional-programming"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 3, "creation_date": 1447766151, "post_id": 33757836, "comment_id": 55283317, "body": "1. <code>data</code> is a keyword. You cannot use it as a name for a variable. 2. <code>intList</code> has type <code>MyData -&gt; IntList</code>."}, {"owner": {"reputation": 505, "user_id": 5449377, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/5c1b0852a7e9e7a953ae50583dcd09e1?s=128&d=identicon&r=PG&f=1", "display_name": "Neo Streets", "link": "https://stackoverflow.com/users/5449377/neo-streets"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1447766812, "post_id": 33757836, "comment_id": 55283731, "body": "@chi that is incredibly unhelpful"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1447769355, "post_id": 33757836, "comment_id": 55285473, "body": "@NeoStreets It will be in long term."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1447769764, "post_id": 33757836, "comment_id": 55285760, "body": "@NeoStreets chi&#39;s pretty much on target, but have some code anyway: <code>putInts is d = d { intList = intList d ++ is }</code>."}], "answers": [{"comments": [{"owner": {"reputation": 505, "user_id": 5449377, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/5c1b0852a7e9e7a953ae50583dcd09e1?s=128&d=identicon&r=PG&f=1", "display_name": "Neo Streets", "link": "https://stackoverflow.com/users/5449377/neo-streets"}, "edited": false, "score": 0, "creation_date": 1447770601, "post_id": 33759175, "comment_id": 55286368, "body": "Thanks I get what he was saying, but I understand the basics of this it was taking the last step that was making life hard"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 2, "last_activity_date": 1447769784, "creation_date": 1447769784, "answer_id": 33759175, "question_id": 33757836, "link": "https://stackoverflow.com/questions/33757836/want-to-add-to-a-data-type-in-haskell/33759175#33759175", "title": "Want to add to a data type in Haskell", "body": "<p>Just to end this with some constructive aid (or so I hope) here is a version that should do what you expect:</p>\n\n<pre><code>type IntList = [Int]\ntype StrList = [String]\n\ndata MyIntStr = MyIntStr { intList :: IntList, strList :: StrList }\n              deriving Show\n\nempty :: MyIntStr\nempty = MyIntStr [] []\n\nputInts :: [Int] -&gt; MyIntStr -&gt; MyIntStr\nputInts is (MyIntStr is' ss) = MyIntStr (is'++is) ss\n</code></pre>\n\n<p>here is an example:</p>\n\n<pre><code>\u03bb&gt; putInts [1,2,3] empty\nMyIntStr {intList = [1,2,3], strList = []}\n</code></pre>\n\n<hr>\n\n<p>what I did:</p>\n\n<ul>\n<li>added <code>deriving Show</code> so I can see my example ;)</li>\n<li>changed <code>StrInt</code> into <code>StrList</code> because you obviously meant it</li>\n<li>added <code>empty</code> so I could test</li>\n<li>rewrote <code>putInts</code> using pattern matching and <code>++</code> to concatenate your <code>[Int]</code> lists</li>\n</ul>\n"}], "owner": {"reputation": 505, "user_id": 5449377, "user_type": "registered", "accept_rate": 35, "profile_image": "https://www.gravatar.com/avatar/5c1b0852a7e9e7a953ae50583dcd09e1?s=128&d=identicon&r=PG&f=1", "display_name": "Neo Streets", "link": "https://stackoverflow.com/users/5449377/neo-streets"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 33759175, "answer_count": 1, "score": 0, "last_activity_date": 1447773348, "creation_date": 1447765927, "last_edit_date": 1447773348, "question_id": 33757836, "link": "https://stackoverflow.com/questions/33757836/want-to-add-to-a-data-type-in-haskell", "title": "Want to add to a data type in Haskell", "body": "<p>Hi I have a data type which is </p>\n\n<pre><code>data MyIntStr = MyIntStr { intList :: IntList, strList :: StrInt}\ntype IntList = [[Int]]\ntype StrList = [[String]]\n</code></pre>\n\n<p>and I want to add things to the <code>intList</code> and <code>strList</code> in <code>MyData</code>. So I'm passing a default data which is just empty and then trying to add Ints to the <code>Intlist</code>:</p>\n\n<pre><code>putInts :: [Int] -&gt; MyIntStr -&gt; MyIntStr\nputInts (h:t) d\n    |length t /= 0 = putInts t (intList:h)\n    |otherwise intList:h\n</code></pre>\n\n<p>this gives errors any ideas how to do this?</p>\n"}, {"tags": ["haskell", "typechecking", "hindley-milner"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1447765420, "post_id": 33757257, "comment_id": 55282854, "body": "no it&#39;s the same - you can see the tuple as an value of type <code>(a,b,c)</code> here and use the same algorithm - just observe that two tuples have the same type IFF they have the same number of components and if the corresponding types of the components are equal"}, {"owner": {"reputation": 860, "user_id": 1078730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114275b1f78cddd07b1e481382193d20?s=128&d=identicon&r=PG", "display_name": "Ganesh Bhambarkar", "link": "https://stackoverflow.com/users/1078730/ganesh-bhambarkar"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1447768861, "post_id": 33757257, "comment_id": 55285102, "body": "So you mean that it doesn&#39;t fail while type-checking the right side? I mean when it finishes type-checking <code>\\y1 -&gt; (y1, y1)</code>, does it immediately refine <code>x1</code>&#39;s type to <code>x1 :: t -&gt; (t, t)</code> or does it use <code>x1 :: a</code> to typecheck <code>\\y2 -&gt; x1 (x1 y2)</code> ?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1447769207, "post_id": 33757257, "comment_id": 55285365, "body": "are you talking about the (implementation-)details of the used algorithm? (this I don&#39;t know) - but from a practical perspective it should be an equivalence relation so that in your example <code>x1</code>, <code>a</code> and <code>t -&gt; (t-&gt;t)</code> all fall in the same class of types to be identified."}, {"owner": {"reputation": 860, "user_id": 1078730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114275b1f78cddd07b1e481382193d20?s=128&d=identicon&r=PG", "display_name": "Ganesh Bhambarkar", "link": "https://stackoverflow.com/users/1078730/ganesh-bhambarkar"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1447771118, "post_id": 33757257, "comment_id": 55286725, "body": "Yes, I needed the implementation details. Mainly, I want to know whether it fails on the right side only or it fails in unification on the left side."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1447771642, "post_id": 33757257, "comment_id": 55287167, "body": "Pattern matching in the left hand side is equivalent to writing a mutually recursive &#39;let&#39;, provided the pattern always succeeds of course. Or you could replace <code>(x1,x2,x3)</code> with <code>x</code> and write <code>fst x</code>, <code>snd x</code>, <code>trd 3</code>, this would be exactly equivalent from the type checkers perspective. I&#39;m not sure what this question is really about - it is pretty clear that the type checker has decided to fail particularly on the application of <code>x1</code> to <code>(x1 y2)</code> because this yields an infinite type."}], "owner": {"reputation": 860, "user_id": 1078730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114275b1f78cddd07b1e481382193d20?s=128&d=identicon&r=PG", "display_name": "Ganesh Bhambarkar", "link": "https://stackoverflow.com/users/1078730/ganesh-bhambarkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1447764162, "creation_date": 1447764162, "question_id": 33757257, "link": "https://stackoverflow.com/questions/33757257/type-checking-algorithm-for-tuple-in-let-expression", "title": "Type checking algorithm for tuple in let expression", "body": "<p>This block gives</p>\n\n<pre><code>f = let (x1, x2, x3) = (\\y1 -&gt; (y1, y1), \\y2 -&gt; x1 (x1 y2), \\y3 -&gt; x2 (x2 y3))\n    in x1\n</code></pre>\n\n<p>error:</p>\n\n<pre><code>Occurs check: cannot construct the infinite type: t1 ~ (t1, t1)\nRelevant bindings include\n  y2 :: t1 (bound at test.hs:1:43)\n  x1 :: t1 -&gt; (t1, t1) (bound at test.hs:1:10)\n  x2 :: t1 -&gt; (t1, t1) (bound at test.hs:1:14)\n  x3 :: t1 -&gt; (t1, t1) (bound at test.hs:1:18)\nIn the first argument of \u2018x1\u2019, namely \u2018(x1 y2)\u2019\nIn the expression: x1 (x1 y2)\n</code></pre>\n\n<p>I want to know the algorithm behind type checking in tuples in <code>let</code> expression. I know the Hindley-Milney type checking algorithm when there is one variable on the left side. I want to know if there is any special algorithm in case of tuples/lists etc.</p>\n"}, {"tags": ["haskell", "xmonad"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1447765463, "post_id": 33756787, "comment_id": 55282871, "body": "You can use pattern matching e.g. <code>f &quot;&quot; = ... ; f (x:xs) = ... </code> so that you can access the head <code>x</code>. The <code>foldr1</code> approach looks much better, though."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 4313189, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Z2WHD9wYb10/AAAAAAAAAAI/AAAAAAAAAsE/viV6GBMfS1E/photo.jpg?sz=128", "display_name": "CarloDePieri", "link": "https://stackoverflow.com/users/4313189/carlodepieri"}, "edited": false, "score": 0, "creation_date": 1447764520, "post_id": 33757058, "comment_id": 55282252, "body": "Thank you for your answer, this is <i>almost</i> what I need! :) I was looking for a more direct way (also, I DO want to learn how to use list heads), but combining two functions I can indeed obtain the desired result; I&#39;ll update my question and wait some more time for other answers."}, {"owner": {"reputation": 45, "user_id": 4313189, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Z2WHD9wYb10/AAAAAAAAAAI/AAAAAAAAAsE/viV6GBMfS1E/photo.jpg?sz=128", "display_name": "CarloDePieri", "link": "https://stackoverflow.com/users/4313189/carlodepieri"}, "edited": false, "score": 0, "creation_date": 1447767506, "post_id": 33757058, "comment_id": 55284208, "body": "I <i>do</i> like the lambda, I will go for that to inline the function :) Thank you again"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 1, "last_activity_date": 1447766795, "last_edit_date": 1447766795, "creation_date": 1447763605, "answer_id": 33757058, "question_id": 33756787, "link": "https://stackoverflow.com/questions/33756787/select-head-of-a-list-in-haskell/33757058#33757058", "title": "Select head of a list in Haskell", "body": "<p>If you already have a list, you don't need to parse it &ndash; you can simply <em>deconstruct</em> it.</p>\n\n<pre><code>isThisStuff :: [String] -&gt; Query Bool\nisThisStuff [c,d] = doesNameBeginWith c &lt;||&gt; doesNameBeginWith d\n</code></pre>\n\n<p>Then</p>\n\n<pre><code>isMusic = isThisStuff [\"MPD:\", \"ncmpcpp\"]\n</code></pre>\n\n<p>Note that this fails if the supplied list doesn't have exactly two elements.</p>\n\n<p>Arguably, a fold-based solution <em>is</em> better. As you've noted, this can be written</p>\n\n<pre><code>foldr1 (&lt;||&gt;) . map doesNameBeginWith\n</code></pre>\n\n<p>Now, all you need to do to get rid of <code>doesNameBeginWith</code> in there is to <em>inline</em> it. Note that</p>\n\n<pre><code>doesNameBeginWith = \\str -&gt; fmap ( str `isPrefixOf`) (stringProperty \"WM_NAME\")\n</code></pre>\n\n<p>So you can use</p>\n\n<pre><code>foldr1 (&lt;||&gt;) . map (\\str -&gt; fmap ( str `isPrefixOf`) (stringProperty \"WM_NAME\"))\n</code></pre>\n\n<p>If you don't like the lambda, you can formulate this as a list comprehension:</p>\n\n<pre><code>doesNameBeginWithAny strs = foldr1 (&lt;||&gt;)\n     [fmap ( str `isPrefixOf`) (stringProperty \"WM_NAME\") | str &lt;- strs]\n</code></pre>\n\n<p>Alternatively, you can make <code>doesNameBeginWith</code> point-free</p>\n\n<pre><code>doesNameBeginWith = \\str -&gt; fmap (isPrefixOf str) (stringProperty \"WM_NAME\")            \n                  = \\str -&gt; flip fmap (stringProperty \"WM_NAME\") (isPrefixOf str)\n                  = \\str -&gt; flip fmap (stringProperty \"WM_NAME\") . isPrefixOf $ str\n                  = flip fmap (stringProperty \"WM_NAME\") . isPrefixOf\n                  = (stringProperty \"WM_NAME\" `fmap`) . isPrefixOf\n</code></pre>\n\n<p>so</p>\n\n<pre><code>doesNameBeginWithAny = foldr1 (&lt;||&gt;)\n                     . map ((stringProperty \"WM_NAME\" `fmap`) . isPrefixOf)\n</code></pre>\n\n<h1>However</h1>\n\n<p>all of this is overly complicated. It gets much simpler when you split up the problem:</p>\n\n<ol>\n<li>Retrieve <code>stringProperty \"WM_NAME\"</code> in the <code>Query</code> monad.</li>\n<li><p>Match any of the supplied strings with it.</p>\n\n<pre><code>doesNameBeginWithAny :: String -&gt; Query Bool\ndoesNameBeginWithAny prefs = do\n   wmName &lt;- stringProperty \"WM_NAME\"\n   return $ any (`isPrefixOf`wmName) prefs\n</code></pre></li>\n</ol>\n\n<p>This can also written with <code>fmap</code>, as Freerich Raabe showed.</p>\n"}, {"tags": [], "owner": {"reputation": 13169, "user_id": 967945, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/47244a17f72cee237f57f4c4b9613ea1?s=128&d=identicon&r=PG", "display_name": "Dan Hulme", "link": "https://stackoverflow.com/users/967945/dan-hulme"}, "is_accepted": false, "score": 1, "last_activity_date": 1447765881, "creation_date": 1447765881, "answer_id": 33757813, "question_id": 33756787, "link": "https://stackoverflow.com/questions/33756787/select-head-of-a-list-in-haskell/33757813#33757813", "title": "Select head of a list in Haskell", "body": "<p>As you realised, <code>head</code> is how you can get the first element of the list, but the solution I'd teach to newbies is to use <em>pattern-matching</em> and recursion to access list elements. Using your first definition of <code>doesNameBeginWith</code>:</p>\n\n<pre><code>doesNameBeginAny :: [String] -&gt; Query Bool\ndoesNameBeginAny (x:xs) = doesNameBeginWith x &lt;||&gt; doesNameBeginAny xs\ndoesNameBeginAny [] = return False\n</code></pre>\n\n<p>After the type declaration, there are two cases. One case takes a list with at least one item (<code>x</code>), and calls your first function on that one item, combining the result with a recursive call on the rest of the list (<code>xs</code>, which may be empty). The pattern matching is responsible for taking apart the list to get at the first item each time, so you don't need to call <code>head</code>. The second case handles the empty list.</p>\n\n<p>As you've already found, the function <code>foldr1</code> (as well as the other folds) abstracts away this structure of the function. You can use a map to transform the list into a list of <code>Query Bool</code>, and then a fold to reduce the list to a single item by or'ing the elements together.</p>\n\n<pre><code>doesNameBeginAny xs = foldr (&lt;||&gt;) False queries\n    where queries = map doesNameBeginWith xs\n</code></pre>\n\n<p>I've used <code>where</code> to define an intermediate to make the code easier to follow. I've also used <code>foldr</code> rather than <code>foldr1</code> so the function also works on empty lists. Again, you don't need to call <code>head</code> because <code>map</code> and <code>fold</code> are responsible for taking apart the list.</p>\n\n<p>If you're looking for an answer that pulls apart the list explicitly, more like a for-each loop in Python or Java or some other imperative language, that's just not how you write Haskell.</p>\n"}, {"tags": [], "owner": {"reputation": 81337, "user_id": 91757, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/afaf752cb41c3968dbd570c6f6fa0dc3?s=128&d=identicon&r=PG", "display_name": "Frerich Raabe", "link": "https://stackoverflow.com/users/91757/frerich-raabe"}, "is_accepted": false, "score": 2, "last_activity_date": 1447766696, "last_edit_date": 1447766696, "creation_date": 1447766298, "answer_id": 33757949, "question_id": 33756787, "link": "https://stackoverflow.com/questions/33756787/select-head-of-a-list-in-haskell/33757949#33757949", "title": "Select head of a list in Haskell", "body": "<p>You just need to change the function you're mapping over the the string property a bit; the <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#v:any\" rel=\"nofollow\"><code>any</code></a> function comes in handy. Instead of</p>\n\n<pre><code>doesNameBeginWith str = fmap ( str `isPrefixOf`) (stringProperty \"WM_NAME\")  \n</code></pre>\n\n<p>try</p>\n\n<pre><code>doesNameBeginWith xs  = fmap (\\x -&gt; any (`isPrefixOf` x) xs) (stringProperty \"WM_NAME\") \n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 4313189, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Z2WHD9wYb10/AAAAAAAAAAI/AAAAAAAAAsE/viV6GBMfS1E/photo.jpg?sz=128", "display_name": "CarloDePieri", "link": "https://stackoverflow.com/users/4313189/carlodepieri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 905, "favorite_count": 0, "accepted_answer_id": 33757058, "answer_count": 3, "score": 0, "last_activity_date": 1447767567, "creation_date": 1447762842, "last_edit_date": 1495540742, "question_id": 33756787, "link": "https://stackoverflow.com/questions/33756787/select-head-of-a-list-in-haskell", "title": "Select head of a list in Haskell", "body": "<p>Now, I'm still learning haskell (to configure my xmonad wm), so bear with me.</p>\n\n<p>I've written this function:</p>\n\n<pre><code>doesNameBeginWith :: String -&gt; Query Bool\ndoesNameBeginWith str = fmap ( str `isPrefixOf`) (stringProperty \"WM_NAME\")  \n</code></pre>\n\n<p>Which will check the start of the WM_NAME X property against my str. I can compose it like this:</p>\n\n<pre><code>isMusic = doesNameBeginWith \"MPD:\" &lt;||&gt; doesNameBeginWith \"ncmpcpp\"\n</code></pre>\n\n<p>It works. Now I want to write a functions with this signature:</p>\n\n<pre><code>[String] -&gt; Query Bool\n</code></pre>\n\n<p>so that I can call it like this:</p>\n\n<pre><code>isMusic = doesNameBeginWith [\"MPD:\", \"ncmpcpp\"]\n</code></pre>\n\n<p>The idea was to use foldr1 to parse the string list, but I can't figure out the sintax to get the head of the list... something like this:</p>\n\n<pre><code>doesNameBeginWith :: [String] -&gt; Query Bool\ndoesNameBeginWith str = foldr1 (&lt;||&gt;) . fmap ( (head str) `isPrefixOf`) (stringProperty \"WM_NAME\") \n</code></pre>\n\n<p>EDIT 1: as <a href=\"https://stackoverflow.com/users/745903/leftaroundabout\">leftaroundabout</a> suggested, I can combine two functions to get what I want:</p>\n\n<pre><code>doesNameBeginWithL :: [String] -&gt; Query Bool\ndoesNameBeginWithL = foldr1 (&lt;||&gt;) . map doesNameBeginWith\n</code></pre>\n\n<p>But I'm still hoping for a more direct way and to understand how list heads could be used in this situation!</p>\n\n<p>EDIT 2: Thank you all again for your answers, all of them have been quite informative! :)</p>\n"}, {"tags": ["haskell", "wxhaskell"], "comments": [{"owner": {"reputation": 77, "user_id": 3781700, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bc10b25735b55e980649ca1abd6bc261?s=128&d=identicon&r=PG&f=1", "display_name": "Obrazi", "link": "https://stackoverflow.com/users/3781700/obrazi"}, "edited": false, "score": 0, "creation_date": 1447782556, "post_id": 33756422, "comment_id": 55294982, "body": "I found the wx refresh function, but it doesn&#39;t seem to work inside this function."}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 3781700, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bc10b25735b55e980649ca1abd6bc261?s=128&d=identicon&r=PG&f=1", "display_name": "Obrazi", "link": "https://stackoverflow.com/users/3781700/obrazi"}, "edited": false, "score": 0, "creation_date": 1448297647, "post_id": 33860228, "comment_id": 55516295, "body": "I set the timer to update the log, but it doesn&#39;t seem to do anything."}], "tags": [], "owner": {"reputation": 109, "user_id": 5573696, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AoIOc.png?s=128&g=1", "display_name": "HJvT", "link": "https://stackoverflow.com/users/5573696/hjvt"}, "is_accepted": false, "score": 1, "last_activity_date": 1448226614, "creation_date": 1448226614, "answer_id": 33860228, "question_id": 33756422, "link": "https://stackoverflow.com/questions/33756422/update-widget-text-with-wx-haskell/33860228#33860228", "title": "Update widget text with wx haskell", "body": "<p>You could try refreshing with a timer, like it is done in <a href=\"http://dready.org/papers/wxHaskell/Watch.hs\" rel=\"nofollow\">http://dready.org/papers/wxHaskell/Watch.hs</a></p>\n\n<p>See the line</p>\n\n<pre><code>    timerClk &lt;- timer f [ on command := do { t &lt;- getTimeString; set timeStatic [text := t]; windowRefresh timeStatic False} ]\n</code></pre>\n\n<p>Note, that Watch.hs is bitrotten, the import statements must be updated; it should work if you replace the imports with: </p>\n\n<pre><code>    import Graphics.UI.WX\n    import Graphics.UI.WXCore hiding (Timer)\n    import Data.Time          hiding (parseTime)\n    import Control.Monad\n    import System.Time\n    import System.Environment\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 3781700, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bc10b25735b55e980649ca1abd6bc261?s=128&d=identicon&r=PG&f=1", "display_name": "Obrazi", "link": "https://stackoverflow.com/users/3781700/obrazi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1448449870, "creation_date": 1447761708, "last_edit_date": 1448449870, "question_id": 33756422, "link": "https://stackoverflow.com/questions/33756422/update-widget-text-with-wx-haskell", "title": "Update widget text with wx haskell", "body": "<p>I'm making a simple image downloader to learn some basic gui things in haskell. I have a staticText box that displays the file names while it's downloading them.</p>\n\n<p>The problem I'm having is with this little recursive function.</p>\n\n<pre><code>saveImgs :: [String] -&gt; IO ()\nsaveImgs [] = return ()\nsaveImgs (x:xs) = do\n    let filename = tail $ x =~ \"/[^/]*$\"\n    logMessage x\n    maybeWrite filename =&lt;&lt; (simpleHttp x) `X.catch` statusExceptionHandler\n    saveImgs xs\n        where maybeWrite f b | b == L.empty = return ()\n                             | otherwise    = L.writeFile f b\n</code></pre>\n\n<p>It takes the list of urls of images to save, and updates a textCtrl widget. Except, it only ever updates the text once, after the entire thing is done. Is there some way to update the text of a textbox manually?</p>\n\n<p>Update: I tried adding a timer and starting it, but it doesn't do anything. </p>\n\n<pre><code>timerClk &lt;- timer f [on command := windowRefresh logBox False]\n</code></pre>\n"}, {"tags": ["haskell", "io", "monads"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4760486, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L5A9G.jpg?s=128&g=1", "display_name": "Jakub K", "link": "https://stackoverflow.com/users/4760486/jakub-k"}, "edited": false, "score": 0, "creation_date": 1447759624, "post_id": 33755542, "comment_id": 55279001, "body": "Thanks a lot! I&#39;ve included the final code in the original post :)"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 0, "last_activity_date": 1447759299, "last_edit_date": 1447759299, "creation_date": 1447758979, "answer_id": 33755542, "question_id": 33755416, "link": "https://stackoverflow.com/questions/33755416/reading-lines-until-empty-string-then-multiplying-them/33755542#33755542", "title": "Reading lines until empty string, then multiplying them", "body": "<p>Your first problem is that you just need to say <code>... then return n else ...</code></p>\n\n<p>Your second problem is here:</p>\n\n<pre><code>print (mulnum 1)\n</code></pre>\n\n<p>which should be:</p>\n\n<pre><code>do n &lt;- mulnum 1\n   print n\n</code></pre>\n\n<p>or:</p>\n\n<pre><code>mulnum 1 &gt;&gt;= print\n</code></pre>\n\n<p>Explanation:</p>\n\n<p>Since you are in the IO monad, both clauses of the if-then-else must be IO computations. The else part is since it is a recursive call to <code>mulnum</code>, but <code>n</code> by itself is a pure value. By writing <code>return n</code> you make it monadic.</p>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 4760486, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L5A9G.jpg?s=128&g=1", "display_name": "Jakub K", "link": "https://stackoverflow.com/users/4760486/jakub-k"}, "edited": false, "score": 0, "creation_date": 1447759862, "post_id": 33755776, "comment_id": 55279166, "body": "Nice, thanks! This seems like a different approach to these things, I&#39;ll keep all of this in mind"}], "tags": [], "owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "is_accepted": false, "score": 2, "last_activity_date": 1447759656, "creation_date": 1447759656, "answer_id": 33755776, "question_id": 33755416, "link": "https://stackoverflow.com/questions/33755416/reading-lines-until-empty-string-then-multiplying-them/33755776#33755776", "title": "Reading lines until empty string, then multiplying them", "body": "<p>In Haskell, you generally want to exploit laziness and separate the impure (I/O) and pure (computation) parts.</p>\n\n<p>Reading in all lines until you hit an empty one is I/O. Everything else is computation.</p>\n\n<p>So you want a function that gives you lines of input until you reach an empty one. You probably want to return the result as a list of strings; that's already lazy.</p>\n\n<p>One way to do this is this:</p>\n\n<pre><code>getLines :: IO [String]\ngetLines = lines &lt;$&gt; getContents\n</code></pre>\n\n<p>Which roughly means \"call <code>getContents</code> and then apply <code>lines</code> to the result\". <code>getContents</code> reads the entire standard input, but it does so lazily. <code>lines</code> splits a string into lines; again, lazily.</p>\n\n<p>(Note: Lazy I/O has its share of problems, which lead to the development of pipeline libraries like pipes and conduit, but for this simple example, the problems don't matter.)</p>\n\n<p>Now, you just have to cut that at the first empty line:</p>\n\n<pre><code>main = do\n  lines &lt;- getLines\n  let leadingLines = takeWhile (not . null) lines\n</code></pre>\n\n<p>Now that you have the leading lines, all that remains is to parse each line (which is a <code>map</code>) and multiply them (which is a <code>fold</code>, but there's the specialized <code>product</code> which does exactly that).</p>\n\n<p>Here we omit checking that the numbers parse correctly.</p>\n\n<pre><code>  let p = (product $ map read leadingLines) :: Int\n</code></pre>\n\n<p>I've added an explicit type annotation, because otherwise Haskell can't decide what numeric type you want.</p>\n\n<p>Finally, you can print out the result.</p>\n\n<pre><code>  print p\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 4760486, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L5A9G.jpg?s=128&g=1", "display_name": "Jakub K", "link": "https://stackoverflow.com/users/4760486/jakub-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 588, "favorite_count": 0, "accepted_answer_id": 33755542, "answer_count": 2, "score": 1, "last_activity_date": 1447759656, "creation_date": 1447758597, "last_edit_date": 1447759536, "question_id": 33755416, "link": "https://stackoverflow.com/questions/33755416/reading-lines-until-empty-string-then-multiplying-them", "title": "Reading lines until empty string, then multiplying them", "body": "<p>I have a little question here about the Haskell IO. I have been programming in haskell for some time now, but for the love of me I can't seem to wrap my head around I/O.</p>\n\n<p>The assignment is simple - read integers from the standard input and multiply them. Here's what I've got so far:</p>\n\n<pre><code>mulnum n = do a &lt;- getLine\n           if a == \"\" then n else mulnum (n * (read a :: Int))\n\nmulInput :: IO ()\nmulInput = print (mulnum 1)\n</code></pre>\n\n<p>The error:</p>\n\n<pre><code>Couldn't match expected type `IO b' with actual type `Int'\nRelevant bindings include\n  n :: IO b (bound at dayx.hs:8:8)\n  mulnum :: IO b -&gt; IO b (bound at dayx.hs:8:1)\nIn the second argument of `(*)', namely `(read a :: Int)'\nIn the first argument of `mulnum', namely `(n * (read a :: Int))'\nIn the expression: mulnum (n * (read a :: Int))\n</code></pre>\n\n<p>I have a strong suspicion that I'm looking at it from the wrong perspective, so if anyone could at least point me in the right direction, I'd be extremely happy.</p>\n\n<p>Thanks and have a nice day!</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Thanks a lot for the help! This is what it looks like now:</p>\n\n<pre><code>mulnum :: Int -&gt; IO Int\nmulnum n = do a &lt;- getLine\n              let a1 = (read a :: Int) in if a == \"\" then return n else mulnum (n * a1)\n\nmulInput :: IO ()\nmulInput = mulnum 1 &gt;&gt;= print\n</code></pre>\n"}, {"tags": ["haskell", "types", "morte"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 4, "last_activity_date": 1448044075, "last_edit_date": 1448044075, "creation_date": 1447756918, "answer_id": 33754874, "question_id": 33754669, "link": "https://stackoverflow.com/questions/33754669/why-wont-this-simple-morte-program-typecheck/33754874#33754874", "title": "Why won&#39;t this simple Morte program typecheck?", "body": "<p>Your</p>\n\n<pre><code>T = (\u03bb (idType : *) \u2192\n     \u03bb (id : idType) \u2192 \n    (id idType))\n</code></pre>\n\n<p>is ill-typed. Otherwise <code>T nat 4</code> would also type check (pretending we have naturals to help intuition).</p>\n\n<hr>\n\n<p>If you want to write an application function (like Haskell's <code>$</code>) you can use</p>\n\n<pre><code>apply = \n    (\u03bb (a b : *) \u2192\n     \u03bb (f : a -&gt; b) \u2192 \n     \u03bb (x : a) \u2192 \n     f x)\n</code></pre>\n\n<p>Note that the above only applies to non-dependent <code>f</code>s. In the dependent case, <code>b</code> can depend on the actual value of type <code>a</code>, making things quite more complex, since now <code>b</code> is a function.</p>\n\n<pre><code>applyDep = \n    (\u03bb (a : *) \u2192\n     \u03bb (b : a -&gt; *) \u2192\n     \u03bb (f : \u2200(x : a) -&gt; b x) \u2192 \n     \u03bb (x : a) \u2192 \n     f x)\n</code></pre>\n\n<p>An example (simplified syntax):</p>\n\n<pre><code>applyDep \n  Bool\n  (\u03bb (x : Bool) -&gt; if x then Int else Char)\n  (\u03bb (x : Bool) -&gt; if x then 4 else 'd')\n  True\n</code></pre>\n\n<p>Above I am quite sloppy on the dependent function (the last lambda), since the <code>if</code> is ill-typed (different types for the branches), but you might get the rough idea. To write it more precisely, I would need something like the dependent match/case Coq has (or to rely to a dependent eliminator for <code>Bool</code>):</p>\n\n<pre class=\"lang-ml prettyprint-override\"><code>fun x: Bool =&gt;\n  match x as y return (if y then Int else Char) with\n  | True  =&gt; 3\n  | False =&gt; 'a'\n  end\n</code></pre>\n\n<p>In the above \"if\", I had to make it clear that the type of the two branches is different (<code>Int</code> vs <code>Char</code>), yet it can be typed if we take that as the result of <code>g x</code>, where <code>g = fun y =&gt; if y then Int else Char</code>. Basically, the result type is now dependent the <code>x</code> value.</p>\n"}, {"comments": [{"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1447759954, "post_id": 33755679, "comment_id": 55279223, "body": "You both tell me it is not well-typed but neither explains exactly why it is not well-typed, nor how it should be done."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1447760320, "post_id": 33755679, "comment_id": 55279455, "body": "@Viclib, Morte and me told you that <code>id : idType</code> doesn&#39;t have a functional type and hence you can&#39;t apply it to <code>idType</code> \u2014 this is the precise reason, why the term is ill-typed. What should be done? Do you want a function application operator such that you can write <code>apply id (\u2200(t : *) \u2192 \u2200(x : t) \u2192 t)</code>?"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1447760489, "post_id": 33755679, "comment_id": 55279562, "body": "But I don&#39;t understand why doesn&#39;t it have a functional type. <code>idType == (\u2200(t : *) \u2192 \u2200(x : t) \u2192 t)</code> after applying the first lambda, so it is a functional type, isn&#39;t it?"}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 2, "creation_date": 1447761038, "post_id": 33755679, "comment_id": 55279940, "body": "@Viclib, because every subexpression must be (with Church-style typing) well-typed before any reductions at the value level. You&#39;re trying to apply <code>\u03bb (idType : *) \u2192 \u03bb (id : idType) \u2192 (id idType)</code> to two arguments, but this function is ill-typed, and it doesn&#39;t matter what the arguments are \u2014 you have an error anyway."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1447761144, "post_id": 33755679, "comment_id": 55280021, "body": "Okay it makes sense this way."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1447762196, "post_id": 33755679, "comment_id": 55280710, "body": "@Viclib Compare it with Haskell <code>let f :: forall a::*. a -&gt; Int ; f x = x in f 4</code> (with explicit type arg: <code>... in f Int 4</code>). This is &quot;dynamically well typed&quot; since we only apply it to <code>Int</code>, but statically it is rejected."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 1, "creation_date": 1447762398, "post_id": 33755679, "comment_id": 55280849, "body": "@Viclib, <a href=\"http://lpaste.net/145437\" rel=\"nofollow noreferrer\">this</a> should typecheck. We ensure that <code>id</code> is a function that receives <code>*</code>. <code>idType</code> becomes a function that returns a type (rather than just a type) to reflect the fact that the type signature for <code>id</code> is partially defined as <code>\u2200(t : *) \u2192 ...</code>. I&#39;d suggest to use Agda instead of Morte: basic syntax of Agda is almost the same, but everything is easier, when you have the opportunity to name terms."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1447762811, "post_id": 33755679, "comment_id": 55281130, "body": "But isn&#39;t Agda overly featured? If it has way too many shortcuts, I&#39;m afraid it might compromise my ability to actually understand the underlying system. Moreover, isn&#39;t Agda&#39;s system different (I&#39;m aware of 2, Martin Lof and CoC). Also, why particularly Agda instead of Idris?"}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 2, "creation_date": 1447763420, "post_id": 33755679, "comment_id": 55281520, "body": "@Viclib, I guess, basic Idris is indistinguishable from basic Agda (except that Agda treats universes more explicitly, which is good for learning), so it fits too. Yes, there are implicit arguments in both Idris and Agda, which simplify things a lot, but you can just not use them. I don&#39;t know whether Morte has the <code>* : *</code> rule, but if so, you can write at the top of an Agda file <code>{-# OPTIONS --type-in-type #-}</code> to enable this rule. Other basic rules should be the same."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1447764030, "post_id": 33755679, "comment_id": 55281932, "body": "Okay, I want to ask some questions about your suggestion, but I&#39;m not sure how to proceed. I shouldn&#39;t post it here on comments (may be off-topic / chatty), nor create a new question (possibly off-topic for SO itself)."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1447764670, "post_id": 33755679, "comment_id": 55282357, "body": "@Viclib, you can write me at effectfully@gmail.com. But I&#39;ll be busy for the next two hours."}], "tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": true, "score": 3, "last_activity_date": 1447759923, "last_edit_date": 1447759923, "creation_date": 1447759367, "answer_id": 33755679, "question_id": 33754669, "link": "https://stackoverflow.com/questions/33754669/why-wont-this-simple-morte-program-typecheck/33755679#33755679", "title": "Why won&#39;t this simple Morte program typecheck?", "body": "<p>The problem here is that with Church-style typing (here is a nice <a href=\"http://jozefg.bitbucket.org/posts/2015-09-27-flavors.html\" rel=\"nofollow\">blogpost</a> and some <a href=\"https://www.reddit.com/r/dependent_types/comments/3moqoo/two_flavours_of_type_theory/\" rel=\"nofollow\">discussion</a>) everything must be well-typed from the beginning: if you have a well-typed <code>f</code> and a well-typed <code>x</code>, then you can apply <code>f</code> to <code>x</code> (if types match). If <code>f</code> is not well-typed, then it's not a legal term and you have an error, even if it is possible to assign <code>f x</code> a type.</p>\n\n<p>Your <code>\u03bb (idType : *) \u2192 \u03bb (id : idType) \u2192 (id idType)</code> is not well-typed: <code>id</code> is a term of type <code>idType</code> and it's not a function that receives <code>*</code>, so you can't apply it to <code>idType</code>.</p>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 33755679, "answer_count": 2, "score": 0, "last_activity_date": 1448044075, "creation_date": 1447756322, "question_id": 33754669, "link": "https://stackoverflow.com/questions/33754669/why-wont-this-simple-morte-program-typecheck", "title": "Why won&#39;t this simple Morte program typecheck?", "body": "<p>I'm trying to better understand the Calculus of Constructions through Morte. My first attempt was to call the identity function itself. However,</p>\n\n<pre><code>(\n\u03bb (idType : *) \u2192\n\u03bb (id : idType) \u2192 \n(id idType))\n\n(\u2200(t : *) \u2192 \u2200(x : t) \u2192 t)\n(\u03bb(a : *) \u2192 \u03bb(x : a) \u2192 x)\n</code></pre>\n\n<p>That program fails to compile with the error:</p>\n\n<pre><code>Context:\nidType : *\nid : idType\n\nExpression: id idType\n\nError: Only functions may be applied to values\n</code></pre>\n\n<p>That doesn't make sense to me, since <code>id</code> is the function <code>(\u03bb(a : *) \u2192 \u03bb(x : a) \u2192 x)</code>, of type <code>idType == (\u2200(t : *) \u2192 t \u2192 t)</code>. Why I'm getting this error?</p>\n"}, {"tags": ["haskell", "type-families", "newtype"], "answers": [{"comments": [{"owner": {"reputation": 1117, "user_id": 1641035, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b63d948c23003346549369112f336519?s=128&d=identicon&r=PG", "display_name": "Alexey Vagarenko", "link": "https://stackoverflow.com/users/1641035/alexey-vagarenko"}, "edited": false, "score": 1, "creation_date": 1447758461, "post_id": 33753800, "comment_id": 55278244, "body": "Oh, it should&#39;ve been my 3rd question: why can&#39;t you define class over  unboxed types like this: <code>class C (u :: # ) where ...</code> ?"}, {"owner": {"reputation": 1117, "user_id": 1641035, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b63d948c23003346549369112f336519?s=128&d=identicon&r=PG", "display_name": "Alexey Vagarenko", "link": "https://stackoverflow.com/users/1641035/alexey-vagarenko"}, "edited": false, "score": 0, "creation_date": 1447758579, "post_id": 33753800, "comment_id": 55278314, "body": "&quot;Vec would not be a boxed type&quot; Why it has to be that way? Type synonim   <code>type Vec = (# Float#, Float# #)</code> has kind <code>#</code> why <code>newtype</code> hasn&#39;t?"}, {"owner": {"reputation": 1117, "user_id": 1641035, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b63d948c23003346549369112f336519?s=128&d=identicon&r=PG", "display_name": "Alexey Vagarenko", "link": "https://stackoverflow.com/users/1641035/alexey-vagarenko"}, "edited": false, "score": 0, "creation_date": 1447758876, "post_id": 33753800, "comment_id": 55278507, "body": "&quot;The compiler should keep track of &quot;regular&quot; newtypes and &quot;unboxed&quot; newtypes in some way.&quot; Is regular kind-checking not enough?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1117, "user_id": 1641035, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b63d948c23003346549369112f336519?s=128&d=identicon&r=PG", "display_name": "Alexey Vagarenko", "link": "https://stackoverflow.com/users/1641035/alexey-vagarenko"}, "edited": false, "score": 0, "creation_date": 1447763930, "post_id": 33753800, "comment_id": 55281858, "body": "@AlexeyVagarenko I guess this strongly depends on the Haskell runtime. Andr&#225;s below describes it better than I can."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 4, "last_activity_date": 1447753936, "creation_date": 1447753936, "answer_id": 33753800, "question_id": 33753397, "link": "https://stackoverflow.com/questions/33753397/restrictions-of-unboxed-types/33753800#33753800", "title": "Restrictions of unboxed types", "body": "<p>A <code>newtype</code> would allow one to define class instances</p>\n\n<pre><code>instance C Vec where ...\n</code></pre>\n\n<p>which can not be defined for unboxed tuples. Type synonyms instead do not offer such functionality.</p>\n\n<p>Also, <code>Vec</code> would not be a boxed type. This means that you can no longer instantiate type variables with <code>Vec</code> in general, unless their kind allows it. For instance <code>[Vec]</code> should be disallowed. The compiler should keep track of \"regular\" newtypes and \"unboxed\" newtypes in some way. This will have, I think, the only benefit of allowing the data constructor <code>Vec</code> to wrap unboxed values at compile time (since it is removed at runtime). This would probably be not enough useful to justify making the necessary changes to the type inference engine, I guess.</p>\n"}, {"comments": [{"owner": {"reputation": 1117, "user_id": 1641035, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b63d948c23003346549369112f336519?s=128&d=identicon&r=PG", "display_name": "Alexey Vagarenko", "link": "https://stackoverflow.com/users/1641035/alexey-vagarenko"}, "edited": false, "score": 1, "creation_date": 1447758298, "post_id": 33754132, "comment_id": 55278152, "body": "&quot;problem with <code>newtype Vec = Vec (# Float#, Float# #)</code> is that even though <code>Vec</code> has kind <code>*</code>&quot; But why? Why it has to have kind <code>*</code> ? When i write <code>type Vec = (# Float#, Float# #)</code> Vec has kind <code>#</code>, so I expect newtype to have kind <code>#</code> too."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 1117, "user_id": 1641035, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b63d948c23003346549369112f336519?s=128&d=identicon&r=PG", "display_name": "Alexey Vagarenko", "link": "https://stackoverflow.com/users/1641035/alexey-vagarenko"}, "edited": false, "score": 2, "creation_date": 1447758570, "post_id": 33754132, "comment_id": 55278305, "body": "<code>type Vec = ...</code> is just a synonym. <code>newtype</code> defines, well, a new type that&#39;s different from the type of the wrapped value. It happens so that all Haskell constructs for defining new types return in kind <code>*</code>. <code>newtype</code>-s for unboxed types would require a large chunk of the infrastructure I mentioned above for enabling polymorphism over differently sized objects, or else it would be only usable monomorphically, which would render them not particularly better compared to just using the wrapped type."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1447764511, "post_id": 33754132, "comment_id": 55282246, "body": "@Andr&#225;sKov&#225;cs It could be made of kind <code>#</code>, but then e.g. <code>id :: a -&gt; a</code> can&#39;t be specialized for <code>a ~ Vec</code> since <code>a::*</code>.  This limitation is related to the fact that the runtime handles boxed data uniformly (with pointers) when you want to pass raw unboxed data around, so you need a custom <code>id</code> for each unboxed type. Not too different to Java&#39;s inability to have generics such as <code>T&lt;int&gt;</code> since <code>int</code> is not a reference type."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1447826118, "post_id": 33754132, "comment_id": 55312569, "body": "There are in fact <a href=\"https://ghc.haskell.org/trac/ghc/wiki/UnliftedDataTypes\" rel=\"nofollow noreferrer\">plans</a> to split up <code>#</code> to separate out the <i>boxed</i> unlifted types (like <code>Array#</code>) from it. Those <i>do</i> have uniform representations and could allow parametric polymorphism, and one of the proposals is to allow <code>newtype</code> for them."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 10, "last_activity_date": 1447755251, "last_edit_date": 1447755251, "creation_date": 1447754847, "answer_id": 33754132, "question_id": 33753397, "link": "https://stackoverflow.com/questions/33753397/restrictions-of-unboxed-types/33754132#33754132", "title": "Restrictions of unboxed types", "body": "<p>Parametric polymorphism in Haskell relies on the fact that all values of <code>t :: *</code> types are uniformly represented as a pointer to a runtime object. Thus, the same machine code works for all instantiations of polymorphic values.</p>\n\n<p>Contrast polymorphic functions in Rust or C++. For example, the identity function there still has type analoguous to <code>forall a. a -&gt; a</code>, but since values of different <code>a</code> types may have different sizes, the compilers have to generate different code for each instatiation. This also means that we can't pass polymorphic functions around in runtime boxes:</p>\n\n<pre><code>data Id = Id (forall a. a -&gt; a)\n</code></pre>\n\n<p>since such a function would have to work correctly for arbitrary-sized objects. It requires some additional infrastructure to allow this feature, for example we could require that a runtime <code>forall a. a -&gt; a</code> function takes extra implicit arguments that carry information about the size and constructors/destructors of <code>a</code> values. </p>\n\n<p>Now, the problem with <code>newtype Vec = Vec (# Float#, Float# #)</code> is that even though <code>Vec</code> has kind <code>*</code>, runtime code that expects values of some <code>t :: *</code> can't handle it. It's a stack-allocated pair of floats, not a pointer to a Haskell object, and passing it to code expecting Haskell objects would result in segfaults or errors. </p>\n\n<p>In general <code>(# a, b #)</code> isn't necessarily pointer-sized, so we can't copy it into pointer-sized data fields. </p>\n\n<p>Type families returning <code>#</code> types are disallowed for related reasons. Consider the following:</p>\n\n<pre><code>type family Foo (a :: *) :: # where\n  Foo Int = Int#\n  Foo a   = (# Int#, Int# #)\n\ndata Box = forall (a :: *). Box (Foo a)\n</code></pre>\n\n<p>Our <code>Box</code> is not representable runtime, since <code>Foo a</code> has different sizes for different <code>a</code>-s. Generally, polymorphism over <code>#</code> would require generating different code for different instantiations, like in Rust, but this interacts badly with regular parametric polymorphism and makes runtime representation of polymorphic values difficult, so GHC doesn't bother with any of this.  </p>\n\n<p>(Not saying though that a usable implementation couldn't possibly be devised)</p>\n"}], "owner": {"reputation": 1117, "user_id": 1641035, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/b63d948c23003346549369112f336519?s=128&d=identicon&r=PG", "display_name": "Alexey Vagarenko", "link": "https://stackoverflow.com/users/1641035/alexey-vagarenko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 316, "favorite_count": 3, "accepted_answer_id": 33754132, "answer_count": 2, "score": 10, "last_activity_date": 1447755251, "creation_date": 1447752810, "question_id": 33753397, "link": "https://stackoverflow.com/questions/33753397/restrictions-of-unboxed-types", "title": "Restrictions of unboxed types", "body": "<p>I wonder why unboxed types in Haskell have these restrictions:</p>\n\n<ol>\n<li><p>You cannot define a newtype for unboxed type:</p>\n\n<pre><code>newtype Vec = Vec (# Float#, Float# #)\n</code></pre>\n\n<p>but you can define type synonim:</p>\n\n<pre><code>type Vec = (# Float#, Float# #)\n</code></pre></li>\n<li><p>Type families can't return unboxed type:</p>\n\n<pre><code>type family Unbox (a :: *) :: # where\n    Unbox Int    = Int#\n    Unbox Word   = Word#\n    Unbox Float  = Float#\n    Unbox Double = Double#\n    Unbox Char   = Char#\n</code></pre></li>\n</ol>\n\n<p>Are there some fundamental reasons behind this, or it's just because no one asked for this features?</p>\n"}, {"tags": ["string", "haskell", "ghc"], "answers": [{"tags": [], "owner": {"reputation": 1008, "user_id": 1470114, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/0c64f5404b8787a038e8f6fa9522224d?s=128&d=identicon&r=PG", "display_name": "katychuang", "link": "https://stackoverflow.com/users/1470114/katychuang"}, "is_accepted": false, "score": 4, "last_activity_date": 1447740648, "creation_date": 1447740648, "answer_id": 33750268, "question_id": 33750267, "link": "https://stackoverflow.com/questions/33750267/convert-string-to-number-and-print-to-command-line/33750268#33750268", "title": "Convert String to Number and print to command line", "body": "<p>There are a couple of things wrong here. </p>\n\n<p>First, to save variables in this function, you need to use the <code>let variable = \"something\"</code> type of statement rather than the <code>&lt;-</code> binding operator. Here, <code>let myNum = read (args !! 0)</code> that takes the first command line argument. </p>\n\n<p>Next, we use <code>read</code> to convert <code>myNum</code> to an anything type, but we need to also explicitly define the type (I chose <em>Float</em> for this example) to print the output back to the command line. Otherwise you'll get an error message like, <code>\"Prelude.read: no parse\"</code></p>\n\n<p>The code to convert from String to Number back to String looks like the following...</p>\n\n<pre><code>main = do\n    -- get command line arguments\n    args &lt;- getArgs\n\n    -- get the first indexed element; convert it from string to float\n    let myNum = read (args !! 0) :: Float\n\n    -- print this number to the command line (as a string)\n    putStrLn (show myNum)\n</code></pre>\n"}], "owner": {"reputation": 1008, "user_id": 1470114, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/0c64f5404b8787a038e8f6fa9522224d?s=128&d=identicon&r=PG", "display_name": "katychuang", "link": "https://stackoverflow.com/users/1470114/katychuang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1447740648, "creation_date": 1447740648, "question_id": 33750267, "link": "https://stackoverflow.com/questions/33750267/convert-string-to-number-and-print-to-command-line", "title": "Convert String to Number and print to command line", "body": "<p>I am working through Chapter 1 exercises of <a href=\"https://en.wikibooks.org/wiki/Write_Yourself_a_Scheme_in_48_Hours/First_Steps\" rel=\"nofollow\">Scheme in 48 hours</a>. For question number 2, I'd like to convert a string to a number using the <code>read</code> function, but the code below doesn't work.</p>\n\n<pre><code>main = do\n    args &lt;- getArgs\n    myNum &lt;- read $ args !! 0\n    putStrLn myNum\n</code></pre>\n\n<p>Here's the error message from ghc:</p>\n\n<pre><code>ex2.hs:7:12:\n    No instance for (Read (IO t0)) arising from a use of \u2018read\u2019\n    In the expression: read\n    In a stmt of a 'do' block: one &lt;- read $ (args !! 0)\n    In the expression:\n      do { args &lt;- getArgs;\n           myNum &lt;- read $ (args !! 0);\n           putStrLn myNum }\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 9267, "user_id": 2284221, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/120d229a55c7a6ce3037e6932c190616?s=128&d=identicon&r=PG", "display_name": "Patrick Collins", "link": "https://stackoverflow.com/users/2284221/patrick-collins"}, "edited": false, "score": 1, "creation_date": 1447735460, "post_id": 33749291, "comment_id": 55266588, "body": "Sounds like homework."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 4, "creation_date": 1447735775, "post_id": 33749291, "comment_id": 55266693, "body": "Notice <code>fold</code> is not some universal function in Haskell so your question is actually incomplete.  Please put in some effort next time."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 9267, "user_id": 2284221, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/120d229a55c7a6ce3037e6932c190616?s=128&d=identicon&r=PG", "display_name": "Patrick Collins", "link": "https://stackoverflow.com/users/2284221/patrick-collins"}, "edited": false, "score": 1, "creation_date": 1447737401, "post_id": 33749291, "comment_id": 55267278, "body": "@PatrickCollins which is no problem at all here..."}, {"owner": {"reputation": 9267, "user_id": 2284221, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/120d229a55c7a6ce3037e6932c190616?s=128&d=identicon&r=PG", "display_name": "Patrick Collins", "link": "https://stackoverflow.com/users/2284221/patrick-collins"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1447739047, "post_id": 33749291, "comment_id": 55267819, "body": "@Carsten no problem if OP puts in some significant work."}, {"owner": {"reputation": 83, "user_id": 3274335, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bac8ee2a6bf10438449a38f7ecdfaf64?s=128&d=identicon&r=PG&f=1", "display_name": "user3274335", "link": "https://stackoverflow.com/users/3274335/user3274335"}, "edited": false, "score": 0, "creation_date": 1447763922, "post_id": 33749291, "comment_id": 55281851, "body": "i had rephrased the question"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1447765989, "post_id": 33749291, "comment_id": 55283204, "body": "if you modify <code>fold</code> the way you hinted you will end up with <code>foldr</code> - on GHC(i) your <code>rev</code> definition is fine and works as expected - so either you ran in yet another Hugs bug or you missed something - please consider using GHC instead of Hugs even if you do the FP101x course - if you have trouble use Hugs for the &quot;<i>copy&amp;past into your REPL to get the type</i>&quot; questions - for the rest GHC is just the <i>saner</i> option"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1447766615, "post_id": 33749291, "comment_id": 55283581, "body": "...oops now I get it ... of course you <b>should not</b> use the <b>all</b> <code>t</code> version of <code>foldr</code> for <code>rev</code> (how did you even get this to compile?) - in the <code>(t -&gt; t -&gt; t) -&gt; [t] -&gt; t</code>: just look at <code>stick</code> - if you want to <i>stick</i> <code>stick</code> into your <code>fold</code> then <code>t</code> needs to be both <code>t</code> and <code>[t]</code> just from it&#39;s type"}], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 3274335, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bac8ee2a6bf10438449a38f7ecdfaf64?s=128&d=identicon&r=PG&f=1", "display_name": "user3274335", "link": "https://stackoverflow.com/users/3274335/user3274335"}, "edited": false, "score": 0, "creation_date": 1447898688, "post_id": 33758424, "comment_id": 55354781, "body": "i am not a student of FP 101x.I picked up this book from the library and trying to learn haskell."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 83, "user_id": 3274335, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bac8ee2a6bf10438449a38f7ecdfaf64?s=128&d=identicon&r=PG&f=1", "display_name": "user3274335", "link": "https://stackoverflow.com/users/3274335/user3274335"}, "edited": false, "score": 1, "creation_date": 1447910115, "post_id": 33758424, "comment_id": 55358045, "body": "@user3274335 oh sorry - it&#39;s just that almost all (you are the first exception I see) people using Hugs in the last days came from there - just move to GHC then"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 2, "last_activity_date": 1447768144, "last_edit_date": 1447768144, "creation_date": 1447767654, "answer_id": 33758424, "question_id": 33749291, "link": "https://stackoverflow.com/questions/33749291/haskell-polymorphic-definition/33758424#33758424", "title": "Haskell Polymorphic definition", "body": "<p>I'll start at the end:</p>\n\n<pre><code>rev :: [t] -&gt; [t]\nrev list = foldr stick [] list\n\nstick :: t -&gt; [t] -&gt; [t]\nstick a x = x ++ [a]\n</code></pre>\n\n<p>will work just fine if you use the definition of <code>foldr</code> you gave:</p>\n\n<pre><code>foldr :: (t-&gt;u-&gt;u) -&gt; u -&gt; [t] -&gt; u\nfoldr f s []    = s\nfoldr f s (a:x) = f a (foldr f s x)\n</code></pre>\n\n<p>as you can see here:</p>\n\n<pre><code>\u03bb&gt; rev [1..5]\n[5,4,3,2,1]\n</code></pre>\n\n<p>what will not work is if you replace it with your definition of <code>fold</code>:</p>\n\n<pre><code>fold :: (t-&gt;t-&gt;t) -&gt; [t] -&gt; t\n</code></pre>\n\n<p>no matter how you name it because the trouble start with the signature.</p>\n\n<p>See - when you do <code>rev list = fold stick [] list</code> then you say that</p>\n\n<pre><code>t -&gt; t -&gt; t\n</code></pre>\n\n<p>should somehow be equal to</p>\n\n<pre><code>t' -&gt; [t'] -&gt; [t']\n</code></pre>\n\n<p>as the first one is the type <code>fold</code> expects for it's first <em>argument</em> and the second is the signature given by <code>stick</code> (renamed <code>t</code> to <code>t'</code> here to indicate that the types should could be different).</p>\n\n<p>Now this would mean that both <code>t ~ t'</code> and <code>t ~ [t']</code> or <code>t ~ [t]</code> which is most likely the error you get (btw: <code>a ~ b</code> here is me saying <em>two types <code>a</code> and <code>b</code>  should be equal</em> - think <code>=</code> if you like)</p>\n\n<p>This should shed some light on your <strong>doubt2</strong> I hope</p>\n\n<hr>\n\n<p>now to the first part: To be honest I have no clue what I should tell you.</p>\n\n<p>The reason to make <code>fold</code> more general is that then it's <em>more general</em> - indeed <code>foldr</code> is a very special function for lists - it is <a href=\"https://wiki.haskell.org/Catamorphisms\" rel=\"nofollow\">the list catamorphism</a> (see also <a href=\"https://en.wikipedia.org/wiki/Catamorphism#List_fold\" rel=\"nofollow\">wikipedia</a>)</p>\n\n<p>But that's just <em>complicated</em> for <em>general function to operate on lists</em></p>\n\n<p>Indeed you can rewrite a huge number of functions on list (basically the recursive ones using patter-matching in the <em>empty or cons</em> style) with just <code>foldr</code> - and this will very likely be a big part of your course (I think you are a student of FP101x right?) and of your book - as it's <strong>the example</strong> for higher-order-functions <em>to rule them all</em> ;)</p>\n"}], "owner": {"reputation": 83, "user_id": 3274335, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/bac8ee2a6bf10438449a38f7ecdfaf64?s=128&d=identicon&r=PG&f=1", "display_name": "user3274335", "link": "https://stackoverflow.com/users/3274335/user3274335"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1447768144, "creation_date": 1447735156, "last_edit_date": 1447766491, "question_id": 33749291, "link": "https://stackoverflow.com/questions/33749291/haskell-polymorphic-definition", "title": "Haskell Polymorphic definition", "body": "<p>I am unable to understand the difference between <code>fold</code> and <code>foldr</code>.\nThe definition of <code>fold</code> is:</p>\n\n<pre><code>fold :: (t-&gt;t-&gt;t) -&gt; [t] -&gt; t\nfold f [a]    = a\nfold f (a:b:x)= f a (fold f (b:x))\n</code></pre>\n\n<p>where there is only one type-parameter <code>t</code>   </p>\n\n<p><code>foldr</code> is defined as</p>\n\n<pre><code>foldr :: (t-&gt;u-&gt;u) -&gt; u -&gt; [t] -&gt; u\nfoldr f s []    = s\nfoldr f s (a:x) = f a (foldr f s x)\n</code></pre>\n\n<p>I am reading \"The craft of functional programming\" and it says the <code>fold</code> function is modified by adding an extra argument for the purpose of checking for empty list. This doesn't make sense why there was a need for <code>foldr</code> when the <code>fold</code> function itself could have been modified to serve all the purposes.</p>\n\n<p>Secondly,when I tried the following example from the book:</p>\n\n<pre><code>rev :: [t] -&gt; [t]\nrev list = foldr stick [] list\n\nstick :: t -&gt; [t] -&gt; [t]\nstick a x = x++[a]\n</code></pre>\n\n<p>and modified the definition of <code>foldr</code> to <code>foldr::(t-&gt;t-&gt;t)-&gt;[t]-&gt;t</code>. Hugs threw an error of inifinite unification type. I tried googling but could not find a satisfactory answer.</p>\n\n<p>so to sum up my doubts are as follows:</p>\n\n<ul>\n<li>doubt1: The reason for making the <code>foldr</code> types to be more general than fold.</li>\n<li>doubt2: why do i get an error namely infinitely unification type.</li>\n</ul>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1447732537, "post_id": 33747923, "comment_id": 55265820, "body": "An observation: I can think of at least eight variants of this function off the top of my head. Perhaps it makes sense from a library design point of view to include all the pieces you need to make the variant that does just what you need -- as the current design does -- instead of trying to figure out all the variants anybody might ever need and including them all -- as you seem to be proposing."}], "answers": [{"comments": [{"owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "edited": false, "score": 0, "creation_date": 1447731836, "post_id": 33748115, "comment_id": 55265609, "body": "Thanks for the answer. Do you think it&#39;s a conscious choice that this function is not included in the package? Because I think it&#39;s both useful and natural to the abstraction."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "edited": false, "score": 0, "creation_date": 1447749396, "post_id": 33748115, "comment_id": 55272280, "body": "@trVoldemort Ask to the package mainteiners. They are the only ones that can answer your question and their email should be found in the documentation of the package."}], "tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": false, "score": 3, "last_activity_date": 1447774795, "last_edit_date": 1447774795, "creation_date": 1447727121, "answer_id": 33748115, "question_id": 33747923, "link": "https://stackoverflow.com/questions/33747923/what-is-a-succinct-way-to-extract-a-range-of-elements-in-a-set-or-a-map-in-log/33748115#33748115", "title": "What is a succinct way to extract a range of elements in a Set (or a Map) in log n time?", "body": "<p>Instead of <code>S.union (S.singleton lower)</code> you may just use <a href=\"https://hackage.haskell.org/package/containers-0.5.6.3/docs/Data-Set.html#v:insert\" rel=\"nofollow\"><code>insert</code></a>. </p>\n\n<p>Also, note that your code is buggy when <code>upper &lt;= lower</code> because, when upper bound is exclusive, such intervals are empty and the out-put should be empty regardless, however your code returns <code>S.singleton lower</code> if <code>lower</code> is in the input set.</p>\n\n<pre><code>range' :: Ord a =&gt; (a, a) -&gt; S.Set a -&gt; S.Set a\nrange' (lower, upper) s\n    | lower &lt; upper = if inc then S.insert lower out else out\n    | otherwise     = S.empty\n    where (_, inc, out) = S.splitMember lower . fst $ S.split upper s\n</code></pre>\n"}], "owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1447774795, "creation_date": 1447725680, "last_edit_date": 1447732017, "question_id": 33747923, "link": "https://stackoverflow.com/questions/33747923/what-is-a-succinct-way-to-extract-a-range-of-elements-in-a-set-or-a-map-in-log", "title": "What is a succinct way to extract a range of elements in a Set (or a Map) in log n time?", "body": "<p>I know that there's <code>split</code>, but it's really a mouthful to get a range using this function:</p>\n\n<pre><code>import qualified Data.Set as S\n\n-- The lower bound is inclusive and the upper bound is exclusive.\nrange' :: Ord a =&gt; (a, a) -&gt; S.Set a -&gt; S.Set a\nrange' (lower, upper) s = \n    let (_, e, right) = S.splitMember lower s\n        (left, _)     = S.split upper right\n    in  if e\n          then S.union (S.singleton lower) left\n          else left\n\nmain :: IO ()\nmain = do\n    print $ range' (0, 3) (S.fromList [-1,2,0,1,5,6,3,7])\n    return ()\n\n-- output:\n--   fromList [0,1,2]\n</code></pre>\n\n<p>Is there a better way?</p>\n\n<hr>\n\n<p><strong>Edit:</strong> I guess what I'm really asking is, how come this function is not included in the package? I think it's both useful and natural to the abstraction. It's strange to me that I couldn't find such function in the package.</p>\n"}, {"tags": ["haskell", "types", "try-catch"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1447710365, "post_id": 33745099, "comment_id": 55258880, "body": "When asking such questions, always <b>post the error</b>, pointing at the line."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1447711152, "creation_date": 1447711152, "answer_id": 33745410, "question_id": 33745099, "link": "https://stackoverflow.com/questions/33745099/expected-type-mismatch-haskell/33745410#33745410", "title": "Expected type mismatch haskell", "body": "<p>There may be other errors, but the following jumps out to me:</p>\n\n<pre><code>showError :: SomeException -&gt; IO ()\n\nmyFunc ... = do\n    ...\n    if ... then showError else ...\n</code></pre>\n\n<p>Since <code>showError</code> is a function, you probably ought to give it an argument here.</p>\n"}], "owner": {"reputation": 7, "user_id": 5560842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7de38389eece0985c89085bdb6f3e666?s=128&d=identicon&r=PG&f=1", "display_name": "bitu", "link": "https://stackoverflow.com/users/5560842/bitu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "closed_date": 1447721024, "answer_count": 1, "score": -1, "last_activity_date": 1447711929, "creation_date": 1447709742, "last_edit_date": 1447711929, "question_id": 33745099, "link": "https://stackoverflow.com/questions/33745099/expected-type-mismatch-haskell", "closed_reason": "Not suitable for this site", "title": "Expected type mismatch haskell", "body": "<p>I'm using the following haskell code to catch error while 'read' in int using getLine. I'm having a type mismatch error when CheckInt function is called. Please let me know where should I modify the type.</p>\n\n<pre><code>import System.Exit \nimport Control.Exception\nfunSeq n = do\n     if (n&lt;4) then 1 else  floor $ (fromIntegral (funSeq (n-1) + funSeq (n-2))) * ((fromIntegral.funSeq) (n-3) / (fromIntegral.funSeq) (n-4))\n\n\nmyFunc ('N':'T':'H':' ': restOfString) = do\n   checkInt restOfString\n   let num = (read restOfString :: Int)\n   if (num &lt; 0) then showError else print (funSeq (num))\n\nmain = do\n putStrLn \"Enter the code: \"\n code &lt;- getLine\n myFunc code\n main \n\n\ncheckInt :: String -&gt; IO ()\ncheckInt str =  catch (seq (read str :: Int) $ return ()) showError\n\nshowError :: SomeException -&gt; IO ()\nshowError _ =  do\n    putStrLn(\"ERR\")\n    exitSuccess\n</code></pre>\n"}, {"tags": ["haskell", "ghc", "cabal"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1447709308, "post_id": 33744898, "comment_id": 55258332, "body": "Honest question: why are you using my crappy hack solution instead of the accepted solution on the linked question?"}, {"owner": {"reputation": 818, "user_id": 1542000, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lK7QR.jpg?s=128&g=1", "display_name": "cronburg", "link": "https://stackoverflow.com/users/1542000/cronburg"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447709459, "post_id": 33744898, "comment_id": 55258413, "body": "Because I hacked it up on my own a couple days ago, and then while writing this question I found your post and was like &quot;hey that&#39;s basically what I did!&quot;"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447709528, "post_id": 33744898, "comment_id": 55258457, "body": "And what goes wrong when you use the correct solution...?"}, {"owner": {"reputation": 818, "user_id": 1542000, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lK7QR.jpg?s=128&g=1", "display_name": "cronburg", "link": "https://stackoverflow.com/users/1542000/cronburg"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447710869, "post_id": 33744898, "comment_id": 55259127, "body": "Haven&#39;t tried with $arch yet. Will try that now. So it&#39;s all just a configuration issue of pointing to the right bin directory? I wasn&#39;t sure if there was something deeper to the problem of supporting multiple architectures / why the cabal developers handled package separation but didn&#39;t also add $arch at the same time (or did they?)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447711242, "post_id": 33744898, "comment_id": 55259332, "body": "Okay, I don&#39;t know the answer to the &quot;why&quot; question. I agree it is annoying, though."}], "owner": {"reputation": 818, "user_id": 1542000, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/lK7QR.jpg?s=128&g=1", "display_name": "cronburg", "link": "https://stackoverflow.com/users/1542000/cronburg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 52, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1447708997, "creation_date": 1447708997, "last_edit_date": 1495540763, "question_id": 33744898, "link": "https://stackoverflow.com/questions/33744898/why-do-cabal-sandboxes-not-have-separate-bin-directories-for-different-architect", "title": "Why do cabal sandboxes not have separate bin directories for different architectures?", "body": "<p>I've been working with multiple versions of <code>ghc</code> as well as targeting multiple architectures (<code>x86_64</code> and <code>ia32</code> for now) all being built on the same <code>x86</code> machine.</p>\n\n<p>So I followed the \"using 32 GHC on 64 bit\" instructions at <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Building/Compiling32on64\" rel=\"nofollow noreferrer\">https://ghc.haskell.org/trac/ghc/wiki/Building/Compiling32on64</a> a while back, but didn't think to isolate my sandboxes. So naturally I wound up with some weird linking errors after extending my cabal package in a way that required some of the executables in the <code>.cabal-sandbox/bin</code> directory (still not totally sure what I changed, but at one point I was able to build two different architectures using the same sandbox). My current solution is basically this: <a href=\"https://stackoverflow.com/a/12394249/1542000\">https://stackoverflow.com/a/12394249/1542000</a></p>\n\n<p>So what considerations go into handling multiple architectures in the cabal build system? I see that packages in a sandbox are separated by architecture, but why wasn't separating the <code>bin</code> directory by architecture a simple extension of package separation?</p>\n"}, {"tags": ["haskell", "integer", "try-catch"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1447704821, "post_id": 33743664, "comment_id": 55256085, "body": "Exceptions are <i>not</i> really idiomatic in Haskell. While you&#39;re still learning the language, better avoid them entirely. Exceptions generally aren&#39;t necessary, because Haskell has very nice support for \u201cpartial types\u201d \u2013 instead of writing a function that returns a <code>Result</code> but might raise an exception, write a function that returns a <code>Maybe Result</code>. \u2014 To answer your question, it would be helpful to know what you&#39;re actually trying to achieve... what is your program supposed to do, for some example inputs?"}], "answers": [{"comments": [{"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1447723228, "post_id": 33743815, "comment_id": 55263409, "body": "Also there are functions in the base to deal with this: <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Text-Read.html#v:readMaybe\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.8.1.0/docs/&hellip;</a>"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 2, "last_activity_date": 1447705742, "last_edit_date": 1447705742, "creation_date": 1447704841, "answer_id": 33743815, "question_id": 33743664, "link": "https://stackoverflow.com/questions/33743664/haskell-catch-handling/33743815#33743815", "title": "Haskell catch handling", "body": "<p>of course @leftaroundabout is right but I think it might be interesting to see how you can get it working anyways.</p>\n\n<p>you don't have to print it - you just have to enforce evaluation (which you can do here using <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#v:seq\" rel=\"nofollow\"><code>seq</code></a>:</p>\n\n<pre><code>checkInt :: String -&gt; IO ()\ncheckInt str =\n  catch (seq (read str :: Int) $ return ()) showError\n\nshowError :: SomeException -&gt; IO ()\nshowError _ =\n   putStrLn(\"ERR\")\n</code></pre>\n\n<p>example:</p>\n\n<pre><code>\u03bb&gt; checkInt \"33\"\n\u03bb&gt; checkInt \"ad\"\nERR\n</code></pre>\n\n<hr>\n\n<p>of course it might be better to not only check but also return the <code>Int</code>:</p>\n\n<pre><code>checkInt :: String -&gt; IO Int\ncheckInt str =\n  catch (let i = read str in seq i $ return i) showError\n\nshowError :: SomeException -&gt; IO Int\nshowError _ = do \n   putStrLn(\"ERR\")\n   return (-1)\n</code></pre>\n\n<p>example:</p>\n\n<pre><code>\u03bb&gt; checkInt \"33\"\n33\n\u03bb&gt; checkInt \"a3\"\nERR\n-1\n\u03bb&gt; i &lt;- checkInt \"a3\"\nERR\n</code></pre>\n\n<hr>\n\n<h2>making the function pure</h2>\n\n<p>anyways you should heed @leftaroundabouts advice and one possibility would be using <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#v:reads\" rel=\"nofollow\"><code>reads</code></a> which allows for more flexibility then <code>read</code>:</p>\n\n<pre><code>checkInt :: String -&gt; Maybe Int\ncheckInt str =\n  case reads str of\n     ((i, _):_) -&gt; Just i\n     _          -&gt; Nothing\n</code></pre>\n\n<p>example:</p>\n\n<pre><code>\u03bb&gt; checkInt \"33\"\nJust 33\n\u03bb&gt; checkInt \"ab\"\nNothing\n\u03bb&gt; checkInt \"33a77\"\nJust 33\n</code></pre>\n\n<p>if you don't like the behavior shown in the last example you can change the function to:</p>\n\n<pre><code>checkInt :: String -&gt; Maybe Int\ncheckInt str =\n  case reads str of\n     [(i, [])] -&gt; Just i\n     _         -&gt; Nothing\n</code></pre>\n\n<p>and it should only parse inputs where the complete string can be parsed as an integer:</p>\n\n<pre><code>\u03bb&gt; checkInt \"33\"\nJust 33\n\u03bb&gt; checkInt \"ab\"\nNothing\n\u03bb&gt; checkInt \"33a77\"\nNothing\n\u03bb&gt; checkInt \"33 77\"\nNothing\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 5560842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7de38389eece0985c89085bdb6f3e666?s=128&d=identicon&r=PG&f=1", "display_name": "bitu", "link": "https://stackoverflow.com/users/5560842/bitu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 510, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1447708032, "creation_date": 1447704310, "last_edit_date": 1447704480, "question_id": 33743664, "link": "https://stackoverflow.com/questions/33743664/haskell-catch-handling", "title": "Haskell catch handling", "body": "<p>I used the code below to catch a read error, while inputting an <code>Integer</code> using <code>getLine</code>.\nThe problem is I have to print the integer unnecessarily to match the expected output of function.  As shown in the <em>catch</em> statement below in the <code>checkInt</code> function. Please let me know what modifications I have to make to avoid <code>print</code> ing the integer in the catch block.</p>\n\n<pre><code>showError= do \n   putStrLn(\"ERR\")\n   exitSuccess\n\n\ncheckInt str = do\n  catch (print(read str :: Int)) handler\n     where\n       handler :: SomeException -&gt; IO ()\n    handler ex = showError\n</code></pre>\n"}, {"tags": ["haskell", "llvm", "windows-10", "ghc", "cabal"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1447707893, "post_id": 33743442, "comment_id": 55257586, "body": "Did you read the entire issue? It&#39;s a <a href=\"https://github.com/haskell/cabal/issues/2887\" rel=\"nofollow noreferrer\">cabal bug</a>."}, {"owner": {"reputation": 1041, "user_id": 1241288, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/88059e59d053af2263f66f2ae459017d?s=128&d=identicon&r=PG", "display_name": "xan", "link": "https://stackoverflow.com/users/1241288/xan"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1447708717, "post_id": 33743442, "comment_id": 55258033, "body": "@Zeta, I didn&#39;t think it is considered a bug officially. There is no single reply in that thread. Are you saying that nothing can be done until this bug is fixed by cabal authors, and I can&#39;t install this package?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1447746164, "post_id": 33743442, "comment_id": 55270713, "body": "Since you&#39;re able to reproduce the error, a reply on the thread would raise some awareness. That being said, I don&#39;t know how many cabal devs use Windows 10. I&#39;m currently on Linux, but I&#39;ll try to reproduce it on Win8 later."}, {"owner": {"reputation": 1041, "user_id": 1241288, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/88059e59d053af2263f66f2ae459017d?s=128&d=identicon&r=PG", "display_name": "xan", "link": "https://stackoverflow.com/users/1241288/xan"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1447782261, "post_id": 33743442, "comment_id": 55294822, "body": "Thank you @Zeta, that would be awesome."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1447840423, "post_id": 33743442, "comment_id": 55320030, "body": "Sorry, I had several problems with LLVM yesterday and wasn&#39;t able to get things working. Apparently, LLVM doesn&#39;t like my MinGW configuration."}], "answers": [{"comments": [{"owner": {"reputation": 1041, "user_id": 1241288, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/88059e59d053af2263f66f2ae459017d?s=128&d=identicon&r=PG", "display_name": "xan", "link": "https://stackoverflow.com/users/1241288/xan"}, "edited": false, "score": 0, "creation_date": 1448058108, "post_id": 33833856, "comment_id": 55439476, "body": "Thank you! Today I noticed discrepancies between versions of gcc that I&#39;m actually using and that is in Haskell Platform&#39;s directory. They were 4.8 and 4.6 respectively. And the latter was used for installing packages so obviously it couldn&#39;t work with llvm-general. I didn&#39;t know how to solve it and I followed you steps. And it installed this package! However, can you use it? I wrote simple hello world in Haskell with one additional import: &#39;import LLVM.General.Analysis&#39;."}, {"owner": {"reputation": 1041, "user_id": 1241288, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/88059e59d053af2263f66f2ae459017d?s=128&d=identicon&r=PG", "display_name": "xan", "link": "https://stackoverflow.com/users/1241288/xan"}, "edited": false, "score": 0, "creation_date": 1448058238, "post_id": 33833856, "comment_id": 55439529, "body": "And it gave a lot of errors like: &#39;C:\\LLVM\\llvm-3.5.2/lib/libLLVMDebugInfo.a(DWARFDebugLine.o)&zwnj;&#8203;:(.text+0x74c): undefined reference to `operator new(unsigned int)&#39;&#39; during compilation. So it ended with:  &#39;collect2.exe: error: ld returned 1 exit status&#39;. Am I missing something obvious, or there must be done some additional work to compile it?"}, {"owner": {"reputation": 1041, "user_id": 1241288, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/88059e59d053af2263f66f2ae459017d?s=128&d=identicon&r=PG", "display_name": "xan", "link": "https://stackoverflow.com/users/1241288/xan"}, "edited": false, "score": 0, "creation_date": 1448058506, "post_id": 33833856, "comment_id": 55439637, "body": "I tried to compile with: &#39;ghc Main.hs --make&#39;. Maybe I should add something to this command? Or rather there is still something not OK with this package?"}, {"owner": {"reputation": 1041, "user_id": 1241288, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/88059e59d053af2263f66f2ae459017d?s=128&d=identicon&r=PG", "display_name": "xan", "link": "https://stackoverflow.com/users/1241288/xan"}, "edited": false, "score": 0, "creation_date": 1448059525, "post_id": 33833856, "comment_id": 55440040, "body": "This command with this program works on Ubuntu. So there must be still some problem with compilers that prevents me from using llvm-general package."}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "reply_to_user": {"reputation": 1041, "user_id": 1241288, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/88059e59d053af2263f66f2ae459017d?s=128&d=identicon&r=PG", "display_name": "xan", "link": "https://stackoverflow.com/users/1241288/xan"}, "edited": false, "score": 0, "creation_date": 1448088563, "post_id": 33833856, "comment_id": 55446062, "body": "Yup, it works for me both with <code>ghc --make</code> or creating a whole new package that depends on llvm-general and <code>cabal build</code>ing it. You didn&#39;t delete MinGW directory when copying it over MinGHC by any chance?"}, {"owner": {"reputation": 1041, "user_id": 1241288, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/88059e59d053af2263f66f2ae459017d?s=128&d=identicon&r=PG", "display_name": "xan", "link": "https://stackoverflow.com/users/1241288/xan"}, "edited": false, "score": 0, "creation_date": 1448095966, "post_id": 33833856, "comment_id": 55447588, "body": "What do you mean by deleting? I performed 4th step, so I overwrote those conflicting files in MinGHC dir. So now when I type &#39;gcc --version&#39; in cmd I get &#39;4.8&#39; as desired. And this gcc is the only one in PATH variable. Should work. But doesn&#39;t this error &#39;C:\\LLVM\\llvm-3.5.2/lib/libLLVMSupport.a(raw_ostream.o):(.te&zwnj;&#8203;xt+0x1c20): undefined reference to `__cxa_guard_release&#39;&#39; look like it is still using the old gcc or something? If it works for you then it must be some easy detail I forgot."}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "reply_to_user": {"reputation": 1041, "user_id": 1241288, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/88059e59d053af2263f66f2ae459017d?s=128&d=identicon&r=PG", "display_name": "xan", "link": "https://stackoverflow.com/users/1241288/xan"}, "edited": false, "score": 0, "creation_date": 1448096706, "post_id": 33833856, "comment_id": 55447762, "body": "I was talking about source MinGW dir, the one where you were copying from. You should&#39;ve used this MinGW to compile LLVM, too. Also, make sure you have <code>extra-libraries: stdc++</code> in llvm-general.cabal."}, {"owner": {"reputation": 1041, "user_id": 1241288, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/88059e59d053af2263f66f2ae459017d?s=128&d=identicon&r=PG", "display_name": "xan", "link": "https://stackoverflow.com/users/1241288/xan"}, "edited": false, "score": 0, "creation_date": 1448099527, "post_id": 33833856, "comment_id": 55448507, "body": "Nope, I left this original MinGW untouched. And I built LLVM with it. But now ghc uses this from MinGHC which is upgraded by copying from the original one. stdc++ was by default, I added -std=gnu++11 instead of -std=c++11."}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "reply_to_user": {"reputation": 1041, "user_id": 1241288, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/88059e59d053af2263f66f2ae459017d?s=128&d=identicon&r=PG", "display_name": "xan", "link": "https://stackoverflow.com/users/1241288/xan"}, "edited": false, "score": 0, "creation_date": 1448101640, "post_id": 33833856, "comment_id": 55449020, "body": "I&#39;m talking about <code>extra-libraries: stdc++</code> field, not <code>cc-options: -std=c++11</code>. Do you have it in <code>library</code> section of .cabal file?"}, {"owner": {"reputation": 1041, "user_id": 1241288, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/88059e59d053af2263f66f2ae459017d?s=128&d=identicon&r=PG", "display_name": "xan", "link": "https://stackoverflow.com/users/1241288/xan"}, "edited": false, "score": 0, "creation_date": 1448102500, "post_id": 33833856, "comment_id": 55449244, "body": "Yes, it was by default. But maybe I just installed this package in a wrong way. I typed &quot;cabal install llvm-general.cabal&quot; in a folder with downloaded package. Should I try something else? But in my opinion sth is still not right with the compilers, something I missed. This link error looks like it is using gcc 4.6."}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "reply_to_user": {"reputation": 1041, "user_id": 1241288, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/88059e59d053af2263f66f2ae459017d?s=128&d=identicon&r=PG", "display_name": "xan", "link": "https://stackoverflow.com/users/1241288/xan"}, "edited": false, "score": 0, "creation_date": 1448102565, "post_id": 33833856, "comment_id": 55449262, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/95785/discussion-between-arrowd-and-xan\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": true, "score": 6, "last_activity_date": 1448045012, "creation_date": 1448045012, "answer_id": 33833856, "question_id": 33743442, "link": "https://stackoverflow.com/questions/33743442/cabal-cant-find-foreign-libraries/33833856#33833856", "title": "Cabal can&#39;t find foreign libraries", "body": "<p>Ok, i've managed to build it and, i think, found the root of the issue.</p>\n\n<p>First, steps to build:</p>\n\n<ol>\n<li><p>Get the MinGW. My installation of MinGW has gcc 4.8.</p></li>\n<li><p>Get 32-bit MinGHC.</p></li>\n<li><p>Compile LLVM 3.5 with MinGW's gcc and install it somewhere.</p></li>\n<li><p>Copy contents of MinGW installation directory into <code>MinGHC Install\nDir\\ghc-7.10.2\\mingw</code>, replacing conflict files.</p></li>\n<li><p>In the command line set your PATH so it has haskell toolset from\nMinGHC (i recommend using switch .bat scripts) and llvm-config.exe.</p></li>\n<li><p>Get the <code>llvm-general</code> package source either using <code>cabal fetch</code> or\ndownloading via browser from hackage.</p></li>\n<li><p>Replace <code>cc-options: -std=c++11</code> line of <code>llvm-general.cabal</code> with\n<code>cc-options: -std=gnu++11</code>.</p></li>\n<li><p>Finally, <code>cabal configure</code> and <code>cabal build</code> should work.</p></li>\n</ol>\n\n<p>I have been changing my build environment many times, so if this doesn't work for you let me know, i probably forgot something.</p>\n\n<hr>\n\n<p>Now let's go into details.</p>\n\n<p>What we thought is a bug of cabal is not, actually. The problem is that both <code>stack</code> and <code>MinGHC</code> (and <code>Haskell Platform</code>, i guess) use quite old <code>gcc</code> - 4.6. This gcc has even two defects:</p>\n\n<ul>\n<li>It doesn't support <code>-std=c++11</code> and LLVM 3.5 can't be built using it.\nAs a consequence, this gcc can't be used by ghc when compiling\nllvm-general, because it can't parse LLVM headers properly.</li>\n<li><p>Even if it could, its linker can't link against LLVM libs compiled by\nMinGW using gcc 4.8. <strong>This</strong> is why cabal was telling you it\ncouldn't find LLVM libs. I've hacked <code>Setup.hs</code> so that it wouldn't\nlook for these libs, but pass <code>-lLLVMSomething</code> to linker via <code>-pgml</code>\nghc option. This lead to clear error message:</p>\n\n<pre><code>ld.exe: ignoring libLLVMSupport.a ...\nld.exe: can't find -lLLVMSupport\n</code></pre></li>\n</ul>\n\n<p>So, the <code>cabal</code> <strong>was</strong> actually finding these libs, but was dropping them because they couldn't be linked to.</p>\n\n<p>Ideally, the solution would be to update mingw distribution used by stack/MinGHC. But as a workaround you can just replace old gcc with new one.</p>\n\n<p>Finally, <code>-std=gnu++11</code> is used because current MinGW release is <a href=\"http://sourceforge.net/p/mingw/bugs/2250/\" rel=\"noreferrer\">affected by this bug</a>, which prevents compilation of c++ bits of the package. Whew, that was a long way.</p>\n"}], "owner": {"reputation": 1041, "user_id": 1241288, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/88059e59d053af2263f66f2ae459017d?s=128&d=identicon&r=PG", "display_name": "xan", "link": "https://stackoverflow.com/users/1241288/xan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1145, "favorite_count": 0, "accepted_answer_id": 33833856, "answer_count": 1, "score": 0, "last_activity_date": 1448045012, "creation_date": 1447703480, "question_id": 33743442, "link": "https://stackoverflow.com/questions/33743442/cabal-cant-find-foreign-libraries", "title": "Cabal can&#39;t find foreign libraries", "body": "<p>Recently I was trying to install <a href=\"http://hackage.haskell.org/package/llvm-general\" rel=\"nofollow\">llvm-general-3.5.1.0</a> package.. for about a week. Basically I am getting this error: <a href=\"https://github.com/bscarlet/llvm-general/issues/156\" rel=\"nofollow\">link</a>. My situation is identical. Windows 10, ghc 7.10.2, cabal 1.22.4.0. I installed llvm 3.5.2 from sources with cmake and everything went fine. In llvm/lib directory I have *.lib files (eg. LLVMAnalysis.lib). </p>\n\n<p>But somehow cabal can't see those libraries and gives this frustrating error: </p>\n\n<blockquote>\n  <p>Configuring llvm-general-3.5.1.0...\n  setup.exe: Missing dependencies on foreign libraries:\n  * Missing C libraries: LLVMLTO, LLVMObjCARCOpts, LLVMLinker, LLVMipo,\n  LLVMVectorize, LLVMBitWriter, LLVMCppBackendCodeGen, LLVMCppBackendInfo,\n  LLVMTableGen, LLVMDebugInfo, LLVMOption, LLVMX86Disassembler,\n  LLVMX86AsmParser, LLVMX86CodeGen, LLVMSelectionDAG, LLVMAsmPrinter,\n  LLVMX86Desc, LLVMX86Info, LLVMX86AsmPrinter, LLVMX86Utils, LLVMJIT,\n  LLVMIRReader, LLVMAsmParser, LLVMLineEditor, LLVMMCAnalysis,\n  LLVMMCDisassembler, LLVMInstrumentation, LLVMInterpreter, LLVMCodeGen,\n  LLVMScalarOpts, LLVMInstCombine, LLVMTransformUtils, LLVMipa, LLVMAnalysis,\n  LLVMProfileData, LLVMMCJIT, LLVMTarget, LLVMRuntimeDyld, LLVMObject,\n  LLVMMCParser, LLVMBitReader, LLVMExecutionEngine, LLVMMC, LLVMCore,\n  LLVMSupport\n  This problem can usually be solved by installing the system packages that\n  provide these libraries (you may need the \"-dev\" versions). If the libraries\n  are already installed but in a non-standard location then you can use the\n  flags --extra-include-dirs= and --extra-lib-dirs= to specify where they are.</p>\n</blockquote>\n\n<p>I really want to use this package on my Windows, but nothing seems to work (I tried everything like --extra-lib-dirs and compiled also with MinGW and VS - the same problem).</p>\n\n<p>I can't accept the fact that it won't install. I mean, there must be some way to fix Setup.hs from this cabal package or something. Does anyone have an idea what can be wrong with cabal in this case and how can I try to workaround this? I don't know how exactly cabal works, maybe someone with this knowledge will have an idea? Or maybe there is a way to do this without cabal?</p>\n"}, {"tags": ["haskell", "tree", "functional-programming", "semantics", "algebraic-data-types"], "comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1447700169, "post_id": 33741937, "comment_id": 55253495, "body": "Just do it recursively. How do you want to render the tree, text, latex, something else?"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1447700205, "post_id": 33741937, "comment_id": 55253515, "body": "What&#39;s <code>Config</code> and <code>State</code>?"}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1447700315, "post_id": 33741937, "comment_id": 55253564, "body": "What have you tried and what problems did you encounter? Do <code>Aexpr</code>, <code>Bexpr</code>, and <code>Stm</code> really have anything to do with your problem of displaying <code>DerivTree</code>s?"}, {"owner": {"reputation": 354, "user_id": 4856526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c98e9b00d02d7d17a78b6c6a69f1ac05?s=128&d=identicon&r=PG&f=1", "display_name": "eduardogr", "link": "https://stackoverflow.com/users/4856526/eduardogr"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1447700676, "post_id": 33741937, "comment_id": 55253771, "body": "@Bergi latex would be nice! The point is that i don&#39;t know exactly how to implement the recursive function to render this"}, {"owner": {"reputation": 354, "user_id": 4856526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c98e9b00d02d7d17a78b6c6a69f1ac05?s=128&d=identicon&r=PG&f=1", "display_name": "eduardogr", "link": "https://stackoverflow.com/users/4856526/eduardogr"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1447700891, "post_id": 33741937, "comment_id": 55253885, "body": "@Cirdec <code>Aexp</code>, <code>Bexp</code> and <code>Stm</code> haven&#39;t anything to do, i wrote it to let you know what are these expressions in the tree. My problem is how to print the tree in a proper way to get a friendly visualization ..the kind of derivative tree of the image is a good target ..."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1447701147, "post_id": 33741937, "comment_id": 55254044, "body": "If you&#39;re going for latex, it should be easy, as latex is just a syntax tree as well. Just transform each node into the appropriate latex command. Call the function recursively for child nodes. No, you don&#39;t have to start printing at the deepest node, it&#39;s just simple structural recursion."}, {"owner": {"reputation": 354, "user_id": 4856526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c98e9b00d02d7d17a78b6c6a69f1ac05?s=128&d=identicon&r=PG&f=1", "display_name": "eduardogr", "link": "https://stackoverflow.com/users/4856526/eduardogr"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1447701261, "post_id": 33741937, "comment_id": 55254105, "body": "Ok, i understand @Bergi can you show me the way to do it in haskell?"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1447701410, "post_id": 33741937, "comment_id": 55254192, "body": "Can you tell us what the expected latex output is for each of those constructors?"}, {"owner": {"reputation": 354, "user_id": 4856526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c98e9b00d02d7d17a78b6c6a69f1ac05?s=128&d=identicon&r=PG&f=1", "display_name": "eduardogr", "link": "https://stackoverflow.com/users/4856526/eduardogr"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1447701877, "post_id": 33741937, "comment_id": 55254450, "body": "Yes, i have edited the post @Bergi"}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1447701955, "post_id": 33741937, "comment_id": 55254499, "body": "That&#39;s still an image. Latex is text, isn&#39;t it?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1447702062, "post_id": 33741937, "comment_id": 55254556, "body": "I see a potential issue here: your states are <i>semantic</i> (functions), so it&#39;s hard to print those. For a formal derivation, you want those to be syntactic (e.g. &quot;s&quot;), or at least with a syntactic counterpart."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1447702153, "post_id": 33741937, "comment_id": 55254605, "body": "Unrelated: why <code>Config</code> has two forms? In big-step semantics, only the first one is used. Do you really need the second as well? If you need it for the small-step semantics, consider using a different type for the two kinds of configurations."}, {"owner": {"reputation": 354, "user_id": 4856526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c98e9b00d02d7d17a78b6c6a69f1ac05?s=128&d=identicon&r=PG&f=1", "display_name": "eduardogr", "link": "https://stackoverflow.com/users/4856526/eduardogr"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1447702389, "post_id": 33741937, "comment_id": 55254736, "body": "@Bergi i know that latex is text, i didn&#39;t understand you. But i don&#39;t know the latext text to show the constructs ..."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1447702487, "post_id": 33741937, "comment_id": 55254790, "body": "@EduGR: If your question is what latex syntax to use to create those images, it&#39;s off-topic here. You may rather ask at <a href=\"https://tex.stackexchange.com\">TeX - LaTeX</a>. Then come back if you&#39;ve still got haskell problems."}, {"owner": {"reputation": 354, "user_id": 4856526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c98e9b00d02d7d17a78b6c6a69f1ac05?s=128&d=identicon&r=PG&f=1", "display_name": "eduardogr", "link": "https://stackoverflow.com/users/4856526/eduardogr"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1447702883, "post_id": 33741937, "comment_id": 55255029, "body": "@Bergi , i posted it  here beacuse i need a way to do it in haskell , it doesn&#39;t mind if it&#39;s using latex or printing a string in the console."}, {"owner": {"reputation": 354, "user_id": 4856526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c98e9b00d02d7d17a78b6c6a69f1ac05?s=128&d=identicon&r=PG&f=1", "display_name": "eduardogr", "link": "https://stackoverflow.com/users/4856526/eduardogr"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1447703046, "post_id": 33741937, "comment_id": 55255135, "body": "@chi: you&#39;re right In big step semantic we don&#39;t need an intermediate config. It&#39;s just for a expressive implementation, in the semantic functions implemented only final configurations are returned ."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1447703470, "post_id": 33741937, "comment_id": 55255397, "body": "@EduGR: Regardless, it&#39;s not a suitable question for SO if you cannot tell us what the output should look. Please show us what latex markup or multiline string you would like to have produced, and we can help you with the haskell implementation."}, {"owner": {"reputation": 354, "user_id": 4856526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c98e9b00d02d7d17a78b6c6a69f1ac05?s=128&d=identicon&r=PG&f=1", "display_name": "eduardogr", "link": "https://stackoverflow.com/users/4856526/eduardogr"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1447704144, "post_id": 33741937, "comment_id": 55255769, "body": "@Bergi i replace one image for the multiline string that i would like to produce."}], "answers": [{"comments": [{"owner": {"reputation": 354, "user_id": 4856526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c98e9b00d02d7d17a78b6c6a69f1ac05?s=128&d=identicon&r=PG&f=1", "display_name": "eduardogr", "link": "https://stackoverflow.com/users/4856526/eduardogr"}, "edited": false, "score": 0, "creation_date": 1447715092, "post_id": 33745643, "comment_id": 55260935, "body": "Thanks you!! That&#39;s nice!"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 3, "last_activity_date": 1447712150, "creation_date": 1447712150, "answer_id": 33745643, "question_id": 33741937, "link": "https://stackoverflow.com/questions/33741937/how-can-i-show-a-derivation-tree-in-haskell/33745643#33745643", "title": "how can i show a derivation tree in haskell?", "body": "<p>Here is a simple example of using the <a href=\"http://hackage.haskell.org/package/boxes-0.1.4/docs/Text-PrettyPrint-Boxes.html\" rel=\"nofollow\"><code>boxes</code></a> package to produce something derivation-tree-like. You should be able to adapt it to your needs without too much trouble -- either by producing a <code>Tree String</code>, or by using the ideas inside <code>pp</code> to produce a <code>Box</code> directly from your derivation trees. (I chose to use <code>Tree String</code> here rather than your type mainly to avoid having to figure out all the pretty-printing details of a data type with lots of constructors.)</p>\n\n<pre><code>import Data.Tree\nimport Text.PrettyPrint.Boxes\n\npp :: Tree String -&gt; Box\npp (Node here []      ) = text here\npp (Node here children) = vcat center1 [premises, separator, conclusion]\n    where\n    premises   = hsep 4 bottom (map pp children)\n    conclusion = text here\n    width      = max (cols premises) (cols conclusion)\n    separator  = text (replicate width '-')\n\nsampleTree :: Tree String\nsampleTree = Node \"&lt;z:=x; x:=y; y:=z, s&gt; -&gt; s'''\"\n    [Node \"&lt;z:=x; x:=y,s&gt; -&gt; s''\"\n        [Node \"&lt;z:=x, s&gt; -&gt; s'\" []\n        ,Node \"&lt;x:=,s1&gt; -&gt; s''\" []\n        ]\n    ,Node \"&lt;y:=z, s''&gt; -&gt; s'''\" []\n    ]\n</code></pre>\n\n<p>Here's a sample run in ghci:</p>\n\n<pre><code>*Main&gt; printBox (pp sampleTree)\n&lt;z:=x, s&gt; -&gt; s'    &lt;x:=,s1&gt; -&gt; s''                       \n----------------------------------                       \n      &lt;z:=x; x:=y,s&gt; -&gt; s''           &lt;y:=z, s''&gt; -&gt; s'''\n---------------------------------------------------------\n              &lt;z:=x; x:=y; y:=z, s&gt; -&gt; s'''              \n</code></pre>\n"}], "owner": {"reputation": 354, "user_id": 4856526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c98e9b00d02d7d17a78b6c6a69f1ac05?s=128&d=identicon&r=PG&f=1", "display_name": "eduardogr", "link": "https://stackoverflow.com/users/4856526/eduardogr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 364, "favorite_count": 0, "accepted_answer_id": 33745643, "answer_count": 1, "score": 2, "last_activity_date": 1447712150, "creation_date": 1447697654, "last_edit_date": 1447704076, "question_id": 33741937, "link": "https://stackoverflow.com/questions/33741937/how-can-i-show-a-derivation-tree-in-haskell", "title": "how can i show a derivation tree in haskell?", "body": "<p>I'm working in a exercise that build a derivation tree of a while language. My implementation of while language is composed by algebraic data types like \"Aexp\"(Arithmetic expressions) \"Bexp\"(boolean expressions) and \"Stm\" (statements) :</p>\n\n<pre><code>type  Var   =  String\ndata  Aexp  =  N Integer\n        |  V Var\n        |  Add Aexp Aexp\n        |  Mult Aexp Aexp\n        |  Sub Aexp Aexp\n        deriving (Show, Eq)\n\ndata  Bexp  =  TRUE\n        |  FALSE\n        |  Eq Aexp Aexp\n        |  Le Aexp Aexp\n        |  Neg Bexp\n        |  And Bexp Bexp\n        deriving (Show, Eq)\n\ndata  Stm   =  Ass Var Aexp\n        |  Skip\n        |  Comp Stm Stm\n        |  If Bexp Stm Stm\n        |  While Bexp Stm\n        |  Repeat Stm Bexp\n        deriving Show\n</code></pre>\n\n<p>After these algebraic data types, i created more algebraic data types to represent derivation trees of programs of while language </p>\n\n<pre><code>type  State  =  Var -&gt; Z\n\ndata Config = Inter Stm State  -- &lt;S, s&gt;\n        | Final State      -- s\n\ndata Transition = Config :--&gt;:  State\n\ndata DerivTree = AssNS     Transition\n           | SkipNS    Transition\n           | CompNS    Transition DerivTree DerivTree\n           | IfTTNS    Transition DerivTree\n           | IfFFNS    Transition DerivTree\n           | WhileTTNS Transition DerivTree DerivTree\n           | WhileFFNS Transition\n           | RepeatTTNS Transition \n           | RepeatFFNS Transition DerivTree DerivTree\n</code></pre>\n\n<p>How can i show this kind of derivation tree??</p>\n\n<pre><code>&lt;z:=x, s&gt; -&gt; s'    &lt;x:=,s1&gt; -&gt; s''\n----------------------------------\n    &lt;z:=x; x:=y,s&gt; -&gt; s''             &lt;y:=z,s''&gt; -&gt; s'''\n    ------------------------------------------------------\n            &lt;z:=x; x:=y; y:=z, s&gt; -&gt; s'''\n</code></pre>\n\n<p>The expected value for each constructor looks like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/NR5xY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NR5xY.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1447695592, "post_id": 33741334, "comment_id": 55250954, "body": "The <code>ImpredicativeTypes</code> extension doesn&#39;t really work. It&#39;s not really worth digging into any more details, I don&#39;t think."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1447695809, "post_id": 33741334, "comment_id": 55251068, "body": "@dfeuer I am partially aware of that; in fact <a href=\"https://www.reddit.com/r/haskell/comments/3sotab/what_are_the_predominant_experimental_programming/cwza63a\" rel=\"nofollow noreferrer\">this reddit comment</a> prompted me to write this question. I still believe it can be answered <i>in principle</i>, that is, what would happen if we had a perfect GHC?"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1447695974, "post_id": 33741334, "comment_id": 55251157, "body": "<a href=\"http://stackoverflow.com/a/10170083/752976\">Possibly related</a>"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 4, "creation_date": 1447696774, "post_id": 33741334, "comment_id": 55251612, "body": "<code>forall a. Show a =&gt; a</code> is also emphatically <i>not</i> an instance of <code>Show</code>. In fact, its only value is <code>undefined</code>. You&#39;re probably mixing it up with <code>exists a. Show a</code> (which isn&#39;t valid Haskell, of course)."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1447697884, "post_id": 33741334, "comment_id": 55252244, "body": "What @Andr&#225;sKov&#225;cs said. <code>1 :: Int</code> does not even have type <code>forall a. Show a =&gt; a</code>, so why would you expect <code>[1 :: Int, &quot;str&quot;, Just 5]</code> to be able to have type <code>[forall a. Show a =&gt; a]</code> if the latter type were allowed?"}], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "closed_date": 1447696019, "answer_count": 0, "score": 1, "last_activity_date": 1447695377, "creation_date": 1447695377, "question_id": 33741334, "link": "https://stackoverflow.com/questions/33741334/why-dont-impredicative-types-allow-for-heterogenous-lists", "closed_reason": "Duplicate", "title": "Why don&#39;t impredicative types allow for heterogenous lists?", "body": "<p>I've a short example:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\n{-# LANGUAGE ImpredicativeTypes #-}\n\nmain = mapM_ print ([1 :: Int, \"str\", Just 5] :: [forall a. Show a =&gt; a])\n</code></pre>\n\n<p>This fails for two reasons (produces 4 errors, but 3 of them are the same for each element):</p>\n\n<pre><code>No instance for (Show (forall a. Show a =&gt; a))\n  arising from a use of `print'\n</code></pre>\n\n<p>Which is very puzzling (and I don't understand it either), and the other one:</p>\n\n<pre><code>Could not deduce (a ~ Int)\nfrom the context (Show a)\n  bound by a type expected by the context: Show a =&gt; a\n  at main.cpp:5:18-42\n  `a' is a rigid type variable bound by\n      a type expected by the context: Show a =&gt; a at main.cpp:5:18\nIn the expression: 1 :: Int\n</code></pre>\n\n<p>Which seems to rigidize the context to <code>Show a =&gt; a</code>. Why doesn't it work? Aren't impredicative types basically a gateway to this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 45741, "user_id": 744178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3193139ea494c45e63752504f5ff1f2?s=128&d=identicon&r=PG", "display_name": "jwodder", "link": "https://stackoverflow.com/users/744178/jwodder"}, "edited": false, "score": 4, "creation_date": 1447690152, "post_id": 33739714, "comment_id": 55247792, "body": "What&#39;s wrong with <code>x ** (1.0&#47;3.0)</code>?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 45741, "user_id": 744178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3193139ea494c45e63752504f5ff1f2?s=128&d=identicon&r=PG", "display_name": "jwodder", "link": "https://stackoverflow.com/users/744178/jwodder"}, "edited": false, "score": 3, "creation_date": 1447690968, "post_id": 33739714, "comment_id": 55248303, "body": "@jwodder: make that <code>x ** (1&#47;3)</code>, there&#39;s no good reason to add decimal zeroes in Haskell. Even better: <code>x**recip 3</code>, for that matter."}, {"owner": {"reputation": 62902, "user_id": 90511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nmOPo.png?s=128&g=1", "display_name": "hugomg", "link": "https://stackoverflow.com/users/90511/hugomg"}, "edited": false, "score": 0, "creation_date": 1447691860, "post_id": 33739714, "comment_id": 55248822, "body": "I like using decimal zeros for clarity. But that is subjective, of course."}, {"owner": {"reputation": 810, "user_id": 370611, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b5d487d6cd2acd4046500efbf7021139?s=128&d=identicon&r=PG", "display_name": "JohnL4", "link": "https://stackoverflow.com/users/370611/johnl4"}, "edited": false, "score": 0, "creation_date": 1447694118, "post_id": 33739714, "comment_id": 55250149, "body": "Ah. Beautiful. I was using (^) and failing. Didn&#39;t realize there are TWO exponentiation operators. Thanks!"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1447696356, "post_id": 33739714, "comment_id": 55251380, "body": "@JohnL4 Well, you didn&#39;t realize there were two operators for good reason: there are actually <i>three</i>! Add the smily <code>(^^)</code> to your mix. =)"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 62902, "user_id": 90511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nmOPo.png?s=128&g=1", "display_name": "hugomg", "link": "https://stackoverflow.com/users/90511/hugomg"}, "edited": false, "score": 0, "creation_date": 1447704282, "post_id": 33739714, "comment_id": 55255830, "body": "@hugomg The &quot;problem&quot; with adding the zeros is that you are adding an implicit <code>Fractional</code> constraint which may not be required."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1447708370, "post_id": 33739714, "comment_id": 55257840, "body": "@Bakuriu: the <code>Fractional</code> constraint <i>is</i> certainly required if you use <code>&#47;</code> to generate the fractional exponents... and it&#39;s also superclass of <code>Floating</code>, which you need for <code>**</code>. \u2014 The reason I don&#39;t like writing <code>1.0</code> is that it kinda suggests the literal is \u201cprecise to one significant digit after the decimal point\u201d, which doesn&#39;t make any sense here."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1447709050, "post_id": 33739714, "comment_id": 55258195, "body": "@leftaroundabout Yes, but what if you have <code>x.0&#47;y</code> and after some time change it to <code>x.0*y</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 62902, "user_id": 90511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nmOPo.png?s=128&g=1", "display_name": "hugomg", "link": "https://stackoverflow.com/users/90511/hugomg"}, "is_accepted": false, "score": 6, "last_activity_date": 1447692841, "last_edit_date": 1447692841, "creation_date": 1447690546, "answer_id": 33739866, "question_id": 33739714, "link": "https://stackoverflow.com/questions/33739714/in-haskell-what-is-the-most-straightforward-way-to-take-roots-of-real-numbers/33739866#33739866", "title": "In Haskell, what is the most straightforward way to take roots of real numbers?", "body": "<p>AFAIK, there is no function to compute nth-roots in the standard library. However you could just use the same pow method from Java</p>\n\n<pre><code>nroot :: Floating a =&gt; Int -&gt; a -&gt; a\nnroot n x = x ** (1.0 / fromIntegral n)\n</code></pre>\n\n<p>Or even more idiomatically:</p>\n\n<pre><code>nroot n x = x ** recip n\n</code></pre>\n\n<p>example:</p>\n\n<pre><code>nroot 4 81.0  -- returns 3.0\n</code></pre>\n\n<p>The <code>**</code> operator is the equivalent of Java's <code>Math.pow</code>and the <code>fromIntegral</code> is required to cast n from an int to a floating point value</p>\n"}], "owner": {"reputation": 810, "user_id": 370611, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/b5d487d6cd2acd4046500efbf7021139?s=128&d=identicon&r=PG", "display_name": "JohnL4", "link": "https://stackoverflow.com/users/370611/johnl4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1447692841, "creation_date": 1447690090, "question_id": 33739714, "link": "https://stackoverflow.com/questions/33739714/in-haskell-what-is-the-most-straightforward-way-to-take-roots-of-real-numbers", "title": "In Haskell, what is the most straightforward way to take roots of real numbers?", "body": "<p>I'd like to take the cube root of a number in Haskell (GHCi, actually). In something like Java, I'd just do <code>Math.Pow( x, 1.0/3.0)</code> and move on, but I don't see a way to do that so easily in Haskell.</p>\n\n<p>So, is there some simple idiom for taking arbitrary roots of arbitrary real numbers?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1447691878, "post_id": 33739436, "comment_id": 55248836, "body": "Not specific to this question: I see a lot of questions involving guards lately, leading to the use of partial functions and avoiding pattern matching. I wonder if some course/tutorial/book is focusing too much on guards, and prods programmers towards bad code. To instructors: consider banning the usage of partial functions (or just pretend they don&#39;t exist in the course -- when learning Haskell they do more harm than good, IMHO)."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1447692352, "post_id": 33739436, "comment_id": 55249138, "body": "@chi maybe it&#39;s connected to the Hugs questions ... ^^"}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 5523735, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c0cd51b33a60dbf810b491c9bf0cb064?s=128&d=identicon&r=PG&f=1", "display_name": "craaaft", "link": "https://stackoverflow.com/users/5523735/craaaft"}, "edited": false, "score": 0, "creation_date": 1447691512, "post_id": 33739769, "comment_id": 55248621, "body": "Yeah it should defintly keep the original positions. Just erase all the strings that are n-times in the list. I tried your second solution, but now it doesnt terminate since I have to check if the all the strings were already processed by the function."}, {"owner": {"reputation": 1909, "user_id": 258738, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/64980b61abd5be8de69dcdc8d4bc6501?s=128&d=identicon&r=PG", "display_name": "Marcelo Zabani", "link": "https://stackoverflow.com/users/258738/marcelo-zabani"}, "reply_to_user": {"reputation": 155, "user_id": 5523735, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c0cd51b33a60dbf810b491c9bf0cb064?s=128&d=identicon&r=PG&f=1", "display_name": "craaaft", "link": "https://stackoverflow.com/users/5523735/craaaft"}, "edited": false, "score": 0, "creation_date": 1447692142, "post_id": 33739769, "comment_id": 55249008, "body": "All right, let&#39;s work this out, for I&#39;m a beginner too. Is this a very long list and is the number of distinct strings very large? If so, the algorithm <i>will</i> perform very badly. In that case, perhaps you should build a <code>Data.Map</code> with the counts per string, and then filter out the ones by looking up the Map."}, {"owner": {"reputation": 155, "user_id": 5523735, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c0cd51b33a60dbf810b491c9bf0cb064?s=128&d=identicon&r=PG&f=1", "display_name": "craaaft", "link": "https://stackoverflow.com/users/5523735/craaaft"}, "edited": false, "score": 0, "creation_date": 1447692671, "post_id": 33739769, "comment_id": 55249353, "body": "No the list is normally not big and the algorithm also doesnt have to perform good. It just has to work. Maybe your 3rd solution does work, I didnt check it yet."}, {"owner": {"reputation": 1909, "user_id": 258738, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/64980b61abd5be8de69dcdc8d4bc6501?s=128&d=identicon&r=PG", "display_name": "Marcelo Zabani", "link": "https://stackoverflow.com/users/258738/marcelo-zabani"}, "reply_to_user": {"reputation": 155, "user_id": 5523735, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c0cd51b33a60dbf810b491c9bf0cb064?s=128&d=identicon&r=PG&f=1", "display_name": "craaaft", "link": "https://stackoverflow.com/users/5523735/craaaft"}, "edited": false, "score": 0, "creation_date": 1447692898, "post_id": 33739769, "comment_id": 55249470, "body": "Indeed, I didn&#39;t check for the empty list first thing. It will never finish executing."}], "tags": [], "owner": {"reputation": 1909, "user_id": 258738, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/64980b61abd5be8de69dcdc8d4bc6501?s=128&d=identicon&r=PG", "display_name": "Marcelo Zabani", "link": "https://stackoverflow.com/users/258738/marcelo-zabani"}, "is_accepted": true, "score": 0, "last_activity_date": 1447693336, "last_edit_date": 1447693336, "creation_date": 1447690240, "answer_id": 33739769, "question_id": 33739436, "link": "https://stackoverflow.com/questions/33739436/filter-out-strings-that-are-n-times-in-list/33739769#33739769", "title": "Filter out strings that are n-times in list", "body": "<p>If it is ok for the elements in the returned list to be in different relative positions than they were in the original list, then you can easily (and with better performance) solve this with a combination of <em>sorting</em>, <em>grouping</em> and <em>concat</em>'ing:    </p>\n\n<pre><code>testfunc list c = concat $ filter (\\p -&gt; length p /= c) $ group (sort list)\n</code></pre>\n\n<p>If you want to do it your way, you could use <code>drop</code> to skip the first element in the list (<strong>this is wrong, see edit</strong>):</p>\n\n<pre><code>testfunc list c\n   | list == [] = []              \n   | (length(filter (==(head list)) list) == c) = testfunc (filter (/=(head list)) list) c\n   | otherwise = testfunc (drop 1 list) c\n</code></pre>\n\n<p>I'm note quite sure I understood your problem, so is this what you needed?</p>\n\n<p>EDIT: Now I understand your issue, your function doesn't work correctly after taking the first element. If keeping order is important, you could try something like:</p>\n\n<pre><code>testfunc list c = filter (\\s -&gt; s `elem` validStrings) list\n          where validStrings = map head $ filter (\\p -&gt; length p /= c) $ group (sort list)\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 5523735, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/c0cd51b33a60dbf810b491c9bf0cb064?s=128&d=identicon&r=PG&f=1", "display_name": "craaaft", "link": "https://stackoverflow.com/users/5523735/craaaft"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 33739769, "answer_count": 1, "score": -2, "last_activity_date": 1447693336, "creation_date": 1447689288, "question_id": 33739436, "link": "https://stackoverflow.com/questions/33739436/filter-out-strings-that-are-n-times-in-list", "title": "Filter out strings that are n-times in list", "body": "<p>Given a list of strings and an integer c I want to filter out the strings that are c-times in the list. The problem is that I don't know how to take the next element in my function since I can't just take the first one, because then the function wouldn't work correct.</p>\n\n<pre><code>testfunc :: [String] -&gt; Int -&gt; [String]\n\ntestfunc list c              \n       | (length(filter (==(head list)) list) == c) = testfunc (filter (/=(head list)) list) c\n</code></pre>\n"}, {"tags": ["haskell", "polygon"], "answers": [{"tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": true, "score": 4, "last_activity_date": 1447685879, "last_edit_date": 1447685879, "creation_date": 1447685538, "answer_id": 33738198, "question_id": 33736975, "link": "https://stackoverflow.com/questions/33736975/how-to-define-an-n-sided-polygon-function-in-haskell/33738198#33738198", "title": "How to define an n-sided polygon function in haskell", "body": "<p>The angle between the vertices is given by the formula <code>360/n</code>. So every time turn by that and move, repeated <code>n</code> times:</p>\n\n<pre><code>polygon n = foldl1 (:&gt;) . replicate n (Fd 1 :&gt; Rt (360.0 / fromIntegral n))\n</code></pre>\n\n<p>Broken up:</p>\n\n<pre><code>polygon n = foldl1 (:&gt;) sides\n  where\n    sides = replicate n side\n    side = Fd 1 :&gt; Rt angle\n    angle = 360.0 / fromIntegral n\n</code></pre>\n\n<p><a href=\"http://melpon.org/wandbox/permlink/g5Arac1LHJqysTHs\" rel=\"nofollow\"><kbd><strong>Working example online</strong></kbd></a></p>\n\n<p>As a side note, I'd define <code>CommandList = [Command]</code> and get rid of that infix type constructor. It sure looks funny, but is much less convenient.</p>\n\n<hr>\n\n<p>I've just noticed the weird</p>\n\n<blockquote>\n  <p>I need to do it without importing any functions that already exist.</p>\n</blockquote>\n\n<p>in your question. Since I consider this constraint absurd, I'm not going to adhere to it. If you want to, copy the implementations of <code>foldl1</code> and <code>replicate</code> from Prelude yourself. Although strictly speaking you don't have to <em>manually</em> import them in order to use them.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5388697"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 740, "favorite_count": 0, "accepted_answer_id": 33738198, "answer_count": 1, "score": 1, "last_activity_date": 1447685879, "creation_date": 1447681791, "last_edit_date": 1447682599, "question_id": 33736975, "link": "https://stackoverflow.com/questions/33736975/how-to-define-an-n-sided-polygon-function-in-haskell", "title": "How to define an n-sided polygon function in haskell", "body": "<p>I need to define a function that moves the \"pen\", which starts at (0,0) in the bottom left, around to draw the correct polygon depending on the input, with every side of the shape having length of 1. I need to do it without importing any functions that already exist. I am using OpenGL to draw the shape. Command is defined as:</p>\n\n<pre><code>data Command\n= Fd Double\n| Bk Double\n| Lt Double\n| Rt Double\n| Go Command\n| Command :&gt; Command\n</code></pre>\n\n<p>I have done a triangle which works but now want to be able to just say how many sides the shape has instead of defining every shape. Triangle:</p>\n\n<pre><code>triangle :: Command\ntriangle = Fd 1 :&gt; Rt 120\n    :&gt; Fd 1 :&gt; Rt 120\n    :&gt; Fd 1 :&gt; Rt 120\n\ncabal run polygon 6\n</code></pre>\n\n<p>should create a hexagon etc</p>\n\n<p>so far all I've got is:</p>\n\n<pre><code>polygon :: Int -&gt; Command\npolygon n = \n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1447691196, "post_id": 33736518, "comment_id": 55248433, "body": "See <a href=\"http://stackoverflow.com/questions/32812400/are-there-non-trivial-foldable-or-traversable-instances-that-dont-look-like-con\">Are there non-trivial Foldable or Traversable instances that don&#39;t look like containers</a>, and in particular pigworker&#39;s answer."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447695271, "post_id": 33736518, "comment_id": 55250762, "body": "I&#39;m tempted to mark this is a duplicate of dfeuer&#39;s suggested link, since answer there discuss this exact thing. Guillaume, do you have any objection?"}, {"owner": {"reputation": 1354, "user_id": 589192, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e8f99f185a95f016a4a8ac4eaa708167?s=128&d=identicon&r=PG", "display_name": "Guillaume Ch&#233;rel", "link": "https://stackoverflow.com/users/589192/guillaume-ch%c3%a9rel"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447768153, "post_id": 33736518, "comment_id": 55284638, "body": "@DanielWagner: It&#39;s a good idea to link the two questions, but I wouldn&#39;t mark this one as a duplicate of the other. This one is more specifically about the state monad (and perhaps because of it, is more accessible to me at least). Also the answers below and your&#39;s to the link question go in opposite directions (if I understand them well). The answers below explain why traversing a state monad is impossible, while in your answer to the linked question you propose a way to do it."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1447693525, "post_id": 33737900, "comment_id": 55249837, "body": "It can be made <code>Foldable</code> in a trivial way; anything of kind <code>* -&gt; *</code> can. <code>instance Foldable (StateT s m) where foldMap _ _ = mempty</code>. But <code>Traversable</code> is much more demanding."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447694529, "post_id": 33737900, "comment_id": 55250358, "body": "I show how to implement <code>Foldable</code> and <code>Traversable</code> for <code>State</code> <a href=\"http://stackoverflow.com/a/32812758/791604\">here</a>."}], "tags": [], "owner": {"reputation": 607, "user_id": 2436412, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07531356cc096dc9551e1ac5983f651d?s=128&d=identicon&r=PG", "display_name": "Heimdell", "link": "https://stackoverflow.com/users/2436412/heimdell"}, "is_accepted": false, "score": 5, "last_activity_date": 1447684650, "creation_date": 1447684650, "answer_id": 33737900, "question_id": 33736518, "link": "https://stackoverflow.com/questions/33736518/why-isnt-the-state-monad-traversable/33737900#33737900", "title": "Why isn&#39;t the state monad traversable?", "body": "<p>Being <code>Traversable</code> requires being <code>Foldable</code>; but <code>State</code> monad is not - you cannot <code>foldMap</code> it, because its value is simple not here.</p>\n\n<pre><code>type State s = StateT s Indentity\nnewtype StateT s m a = State { runState :: s -&gt; m (s, a) }\n</code></pre>\n\n<p>As you can see, there is no immediate <code>a</code> to fold over here, its only result of the function.</p>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447694768, "post_id": 33737998, "comment_id": 55250489, "body": "I don&#39;t think &quot;<code>extract</code> cannot be defined&quot; implies &quot;<code>foldMap</code> cannot be defined&quot;. For example, I can&#39;t write <code>extract :: Unit a -&gt; a</code> where <code>data Unit a = Unit</code>, but I can write <code>foldMap f _ = mempty</code>."}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447715528, "post_id": 33737998, "comment_id": 55261116, "body": "@DanielWagner We are talking about the state monad. I never said that <code>foldMap</code> can&#39;t be defined for <b>any</b> data type if <code>extract</code> cannot be defined for that data type."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447720789, "post_id": 33737998, "comment_id": 55262739, "body": "What is special about <code>State</code> that means I <i>must</i> be able to define <code>extract</code> in order to define <code>foldMap</code>? In other words, if there are types where I can define <code>foldMap</code> without <code>extract</code>, why should I believe that I can&#39;t do it for <code>State</code>?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447720898, "post_id": 33737998, "comment_id": 55262780, "body": "Or, more to the point: <code>State Void a</code> is morally the same thing as <code>Unit a</code>. So why should I believe I can&#39;t define <code>foldMap</code> for <code>State Void a</code>, even though I can&#39;t define <code>extract</code> for <code>State Void a</code>?"}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447730329, "post_id": 33737998, "comment_id": 55265213, "body": "So, you want to define <code>foldMap f (State g) = mempty</code>? You could do that, and I see what you are getting at (in my answer I said that <code>foldMap</code> can <b>only</b> be defined in terms of <code>extract</code> which is indeed false). In fact, you could trivially make any data type an instance of <code>Foldable</code> by defining <code>foldMap = const (const mempty)</code>. However, that&#39;s not very useful. You aren&#39;t &quot;folding&quot; over any data structure when you define <code>foldMap</code> as <code>const (const mempty)</code>. Hence, I would say that not only is that definition trivial but also wrong. Nevertheless, thank you for pointing that out. I&#39;ll update."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447732191, "post_id": 33737998, "comment_id": 55265733, "body": "I absolutely don&#39;t want to define <code>foldMap f (State g) = mempty</code>. And I don&#39;t agree that the proposed list of instances covers all the possibilities, either. I agree that &quot;if we could <code>extract</code> the value <code>a</code> from <code>State s a</code> then we could apply <code>f</code> to that value&quot;, but I don&#39;t agree that the implication goes the other way, that is, that <code>foldMap</code> <i>must</i> use <code>extract</code> to get something to apply <code>f</code> to. Your argument needs a lot of work to be made convincing!"}], "tags": [], "owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "is_accepted": false, "score": 2, "last_activity_date": 1447731779, "last_edit_date": 1447731779, "creation_date": 1447684932, "answer_id": 33737998, "question_id": 33736518, "link": "https://stackoverflow.com/questions/33736518/why-isnt-the-state-monad-traversable/33737998#33737998", "title": "Why isn&#39;t the state monad traversable?", "body": "<p>Yes, it is indeed impossible. Consider the following definition of <code>State</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>newtype State s a = State { runState :: s -&gt; (a, s) }\n</code></pre>\n\n<p>To <a href=\"http://hackage.haskell.org/package/comonad-4.2.7.2/docs/Control-Comonad.html#v:extract\" rel=\"nofollow\"><code>extract</code></a> the value this data type we would first need to supply some state.</p>\n\n<p>We can create a specialized <code>extract</code> function if we know the type of the state. For example:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>extract' :: State () a -&gt; a\nextract' (State f) = f ()\n\nextractT :: State Bool a -&gt; a\nextractT (State f) = f True\n\nextractF :: State Bool a -&gt; a\nextractF (State f) = f False\n</code></pre>\n\n<p>However, we can't create a generic extract function. For example:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>extract :: State s a -&gt; a\nextract (State f) = f undefined\n</code></pre>\n\n<p>The above <code>extract</code> function is generic. The only state we can supply is &bottom; which is incorrect. It is only safe if the function <code>f :: s -&gt; (a, s)</code> passes along its input transparently (i.e. <code>f = (,) a</code> for some value <code>a</code>). However, <code>f</code> may take some state and use it to generate some value and a new state. Hence, <code>f</code> may use its input non-transparently and if the input is &bottom; then we get an error.</p>\n\n<p>Thus, we cannot create a generic <code>extract</code> function for the <code>State</code> data type.</p>\n\n<p>Now, for a data type to be an instance of <code>Traversable</code> it first needs to be an instance of <code>Foldable</code>. Hence, to make <code>State</code> an instance of <code>Traversable</code> we first need to define the following instance:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>instance Foldable (State s) where\n    foldMap f (State g) = mempty\n    -- or\n    foldMap f (State g) = let x = f (extract g) in mconcat [x]\n    -- or\n    foldMap f (State g) = let x = f (extract g) in mconcat [x,x]\n    -- or\n    foldMap f (State g) = let x = f (extract g) in mconcat [x,x,x]\n    -- ad infinitum\n</code></pre>\n\n<p>Note that <code>foldMap</code> has the type <code>Monoid m =&gt; (a -&gt; m) -&gt; State s a -&gt; m</code>. Hence, the expression <code>foldMap f (State g)</code> must return a value of the type <code>Monoid m =&gt; m</code>. Trivially, we can always return <code>mempty</code> by defining <code>foldMap = const (const mempty)</code>. However, in my humble opinion this is incorrect because:</p>\n\n<ol>\n<li>We aren't really folding anything by always returning <code>mempty</code>.</li>\n<li>Every data type can be trivially made an instance of <code>Foldable</code> by always returning <code>mempty</code>.</li>\n</ol>\n\n<p>The only other way to produce a value of the type <code>Monoid m =&gt; m</code> is to apply <code>f</code> to some value <code>x</code> of the type <code>a</code>. However, we don't have any value of the type <code>a</code>. If we could <code>extract</code> the value <code>a</code> from <code>State s a</code> then we could apply <code>f</code> to that value, but we already proved that it's not possibly to define a generic <code>extract</code> function for <code>State s a</code> that never crashes.</p>\n\n<p>Thus, <code>State s</code> cannot be made an instance of <code>Foldable</code> and consequently it cannot be an instance of <code>Traversable</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1447686269, "post_id": 33738196, "comment_id": 55245140, "body": "You say that the function <code>trav</code> can&#39;t exist and then you ask the reader to try to evaluate <code>trav f (\\s -&gt; (s, s))</code>. Your answer started out well but you just hand waved your conclusion."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1447687985, "post_id": 33738196, "comment_id": 55246286, "body": "I&#39;m asking the OP to tell me what the result should be to demonstrate that the concept of what <code>trav</code> should do is ill-defined. Do you have any suggestions of how to improve my answer?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447695068, "post_id": 33738196, "comment_id": 55250655, "body": "I take your challenge. I declare that <code>trav f (\\s -&gt; (s, s))</code> has length <code>0</code>. Now what?"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 1, "last_activity_date": 1447685533, "creation_date": 1447685533, "answer_id": 33738196, "question_id": 33736518, "link": "https://stackoverflow.com/questions/33736518/why-isnt-the-state-monad-traversable/33738196#33738196", "title": "Why isn&#39;t the state monad traversable?", "body": "<p>Such a function can't exist.</p>\n\n<p>You are asking for a function with this signature:</p>\n\n<pre><code>trav :: (a -&gt; [a]) -&gt; (s -&gt; (a,s)) -&gt; [ s -&gt; (a,s) ]\n</code></pre>\n\n<p>That is, given a function <code>f :: a -&gt; [a]</code> and a state computation, <code>trav</code> returns a list. In particular, if I give you <code>f</code> and a state computation, you should be able tell me if the result list is null or not.</p>\n\n<p>Now consider this <code>f</code>:</p>\n\n<pre><code>f :: Int -&gt; [Int]\nf 0 = []\nf a = [a]\n</code></pre>\n\n<p>And try to evaluate <code>trav f (\\s -&gt; (s,s))</code> or even try to determine if it is the empty list.</p>\n\n<p>You can write this function:</p>\n\n<pre><code>trav' :: [ a -&gt; a ] -&gt; (s -&gt; (a,s)) -&gt; [ s -&gt; (a,s) ]\n</code></pre>\n\n<p>because the resulting list will always have the same length.</p>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1447694545, "post_id": 33739265, "comment_id": 55250372, "body": "Are you sure there&#39;s no <a href=\"http://stackoverflow.com/a/32812758/791604\">interesting instances</a>?"}], "tags": [], "owner": {"reputation": 33569, "user_id": 3434, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5a484dc0812eb4542ee718d969513f66?s=128&d=identicon&r=PG", "display_name": "Apocalisp", "link": "https://stackoverflow.com/users/3434/apocalisp"}, "is_accepted": true, "score": 9, "last_activity_date": 1447709241, "last_edit_date": 1495540982, "creation_date": 1447688756, "answer_id": 33739265, "question_id": 33736518, "link": "https://stackoverflow.com/questions/33736518/why-isnt-the-state-monad-traversable/33739265#33739265", "title": "Why isn&#39;t the state monad traversable?", "body": "<p>To implement <code>Traversable t</code>, you need to implement a function of this type:</p>\n\n<pre><code>sequenceA :: forall f a. Applicative f =&gt; t (f a) -&gt; f (t a)\n</code></pre>\n\n<p>When <code>t</code> is <code>State s</code>, this becomes:</p>\n\n<pre><code>sequenceA :: forall f a. Applicative f =&gt; State s (f a) -&gt; f (State s a)\n</code></pre>\n\n<p>Obviously we can't write an implementation <em>for all <code>s</code></em>, since we'd have to know either how to create an <code>s</code> or an <code>f a</code> out of nothing in order to proceed. That would be a contradiction.</p>\n\n<p>But it's possible to write an instance that satisfies the type <em>for certain classes of <code>s</code></em>. If we assume that <code>s</code> is a <code>Monoid</code>, we could do this:</p>\n\n<pre><code>instance (Monoid m) =&gt; Traversable (State m) where\n  sequenceA (State run) = fmap (\\a -&gt; State (\\s' -&gt; (mappend s s', a)) fa \n    where (s, fa) = run mempty\n</code></pre>\n\n<p>But this does <em>not</em> satisfy the <code>Traversable</code> laws. One of the laws is:</p>\n\n<pre><code>traverse Identity = Identity\n</code></pre>\n\n<p>(recall that <code>traverse f = sequence . fmap f</code>)</p>\n\n<p>This law clearly doesn't hold because the output action <code>mappend</code>s whereas the input action did not. OK, how about we just don't <code>mappend</code>:</p>\n\n<pre><code>instance (Monoid m) =&gt; Traversable (State m) where\n  sequenceA (State run) = fmap (\\a -&gt; State (\\_ -&gt; (s, a)) fa \n    where (s, fa) = run mempty\n</code></pre>\n\n<p>That doesn't help, since now the output action ignores its input and subsitutes <code>mempty</code> whereas the input action did not.</p>\n\n<p>This doesn't mean that there aren't types <code>s</code> for which we couldn't construct a lawful <code>Traverse (State s)</code> instance. For example, <code>State ()</code> reduces to <code>Identity</code>, which absolutely is traversable.</p>\n\n<p>And if we can do <code>State ()</code>, why not <code>State Bool</code>? We can just <code>runState</code> the original action at <em>both</em> <code>True</code> and <code>False</code>, store the result in a map, and then have the resulting state action perform a lookup in that map. This works for any <em>finitely enumerable</em> state domain. See <a href=\"https://stackoverflow.com/a/32812758/791604\">this answer</a> for details.</p>\n"}], "owner": {"reputation": 1354, "user_id": 589192, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/e8f99f185a95f016a4a8ac4eaa708167?s=128&d=identicon&r=PG", "display_name": "Guillaume Ch&#233;rel", "link": "https://stackoverflow.com/users/589192/guillaume-ch%c3%a9rel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 717, "favorite_count": 0, "accepted_answer_id": 33739265, "answer_count": 4, "score": 7, "last_activity_date": 1447731779, "creation_date": 1447680314, "last_edit_date": 1447682772, "question_id": 33736518, "link": "https://stackoverflow.com/questions/33736518/why-isnt-the-state-monad-traversable", "title": "Why isn&#39;t the state monad traversable?", "body": "<p>Intuitively, it seems to me that one could use traverse with a state monad, for example:</p>\n\n<pre><code>traverse (\\a -&gt; [a, a+1]) (state (\\s -&gt; (1, s + 1))) \n  = [state (\\s -&gt; (1, s + 1), state (\\s -&gt; (2, s + 1)]\n</code></pre>\n\n<p>But the state monad doesn't implement the Traversable typeclass. Why is that? I've tried to figure out a way to implement traverse for the state monad, and it seems that the difficulty is to extract the result of the state monad in order to pass it to the function given as first argument of traverse. Is it impossible?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1447675741, "post_id": 33734868, "comment_id": 55238456, "body": "The result of a function, in pure functional programming, can only depend on the function arguments. You need to either take <code>conteudo</code> as an additional parameter (and access the file elsewhere) or return <code>IO [String]</code> and actually access the file in this function."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1447675824, "post_id": 33734868, "comment_id": 55238498, "body": "By the way, the question is poorly written: you seem to perfectly <i>know</i> why using <code>conteudo</code> triggers the not in scope error. Namely, you did not define it as the result of reading your file."}, {"owner": {"reputation": 3, "user_id": 5560588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb5a9bed40bdf7c51e829c3a98074180?s=128&d=identicon&r=PG&f=1", "display_name": "Andr&#233;", "link": "https://stackoverflow.com/users/5560588/andr%c3%a9"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1447675838, "post_id": 33734868, "comment_id": 55238508, "body": "i cant do the IO String. and when i take conteudo as an additional paramater it gives me an error like &#39;=&#39; or &#39;&lt;-&#39; not in scope."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1447708503, "post_id": 33734868, "comment_id": 55257912, "body": "maybe we should close this here? Seems @Andr&#233; lost interest and Yuris answer seems good enough IMO"}], "answers": [{"tags": [], "owner": {"reputation": 1858, "user_id": 1352240, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5650ebc3479d59a5266767a26b0e6649?s=128&d=identicon&r=PG", "display_name": "YuriAlbuquerque", "link": "https://stackoverflow.com/users/1352240/yurialbuquerque"}, "is_accepted": true, "score": 1, "last_activity_date": 1447707424, "creation_date": 1447707424, "answer_id": 33744482, "question_id": 33734868, "link": "https://stackoverflow.com/questions/33734868/defining-a-function-in-haskell/33744482#33744482", "title": "Defining a function in haskell", "body": "<p>This is not really a good question, since this should be covered by basic Haskell knowledge, and it's clearly homework for those of us who can speak Portuguese. You shouldn't be afraid to ask your teacher for some help, and I'm sure he would be glad to give you that.</p>\n\n<p>Nevertheless, since it is <em>possible</em> to answer the question, I will:</p>\n\n<p>Input and Output in Haskell is only possible inside functions that evaluate an IO action (that is, a value of the <code>IO</code> type).</p>\n\n<p>Of course, since <code>main</code> has type <code>IO ()</code>, you can execute IO actions inside of it.</p>\n\n<p>The simplest way to read a file is with the <code>readFile</code> function. It accepts a <code>FilePath</code> and evaluates to a <code>IO String</code> (which has the full contents of the file). I'll give you an example and I hope you can follow from it.</p>\n\n<pre><code>main :: IO ()\nmain = do\n  contents &lt;- readFile \"yourfilename.txt\" -- because I used \"&lt;-\", contents has type String\n  let fileLines = lines contents -- here I have a [String] with each line of the file\n  someFunction fileLines\n  return ()\n</code></pre>\n\n<p><code>someFunction</code> should also evaluate an IO action, in this example. You can \"put things inside\" <code>IO</code> using <code>return</code>, in case you don't know.</p>\n"}], "owner": {"reputation": 3, "user_id": 5560588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb5a9bed40bdf7c51e829c3a98074180?s=128&d=identicon&r=PG&f=1", "display_name": "Andr&#233;", "link": "https://stackoverflow.com/users/5560588/andr%c3%a9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 33744482, "answer_count": 1, "score": -2, "last_activity_date": 1447707424, "creation_date": 1447675177, "last_edit_date": 1447675322, "question_id": 33734868, "link": "https://stackoverflow.com/questions/33734868/defining-a-function-in-haskell", "title": "Defining a function in haskell", "body": "<p>Why does my function give me an out of scope error?</p>\n\n<pre><code>tarefa1 :: [String] -&gt; [String]\ntarefa1 linhas = if res == ok then [\"OK\"] else [show res]\n  where\n    (tab,coords) = parteMapa conteudo\n    erro1 = validaTabuleiro 1 tab\n    erro2 = validaCoords (length tab + 1) tab coords\n    res = juntaErro erro1 erro2\n</code></pre>\n\n<p>The error:</p>\n\n<pre><code>Not in scope: `conteudo'. \n</code></pre>\n\n<p><code>conteudo</code> is supposed to be a .txt document that I have in a different file, but I don't know how to make it to load it in this function. </p>\n"}, {"tags": ["haskell", "operator-precedence", "currying"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1447674570, "post_id": 33734429, "comment_id": 55237713, "body": "For information, <code>$</code> is right-associative. <code>Info $ FileInfo filename 1 $ Dimentions [dimX, dimY, dimZ] $ Variables  [var1, var2]</code> is equivalent to <code>Info (FileInfo filename 1 (Dimentions [dimX, dimY, dimZ] ( Variables  [var1, var2])))</code>, which is not what you want."}], "answers": [{"comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1447674880, "post_id": 33734695, "comment_id": 55237907, "body": "Is such a left-associative operator defined anywhere in the standard library?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1447675074, "post_id": 33734695, "comment_id": 55238048, "body": "@Jubobs: <a href=\"https://www.haskell.org/hoogle/?hoogle=%28a%20-%3E%20b%29%20-%3E%20a%20-%3E%20b\" rel=\"nofollow noreferrer\">Doesn&#39;t seem like it</a>."}, {"owner": {"reputation": 2471, "user_id": 1447225, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8daac16747c58e2c892e1a398919295c?s=128&d=identicon&r=PG", "display_name": "firegurafiku", "link": "https://stackoverflow.com/users/1447225/firegurafiku"}, "reply_to_user": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1447675517, "post_id": 33734695, "comment_id": 55238328, "body": "@Jubobs: I didn&#39;t manage to find it too. But if it is, it probably should be named <code>\u20ac</code> or <code>&#165;</code>."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 2471, "user_id": 1447225, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8daac16747c58e2c892e1a398919295c?s=128&d=identicon&r=PG", "display_name": "firegurafiku", "link": "https://stackoverflow.com/users/1447225/firegurafiku"}, "edited": false, "score": 0, "creation_date": 1447675735, "post_id": 33734695, "comment_id": 55238451, "body": "@firegurafiku: Huh. Didn&#39;t think of that. Might be hard on US keyboards, though. But that&#39;s just my 2 &#162;."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 4, "last_activity_date": 1447674633, "creation_date": 1447674633, "answer_id": 33734695, "question_id": 33734429, "link": "https://stackoverflow.com/questions/33734429/chaining-parameters-without-parentheses-in-haskell/33734695#33734695", "title": "Chaining parameters without parentheses in Haskell", "body": "<p>Sure. The problem of <code>$</code> in this case is that it's right associative:</p>\n\n<pre><code>let info = Info $ FileInfo filename 1\n                $ Dimentions [dimX, dimY, dimZ]\n                $ Variables  [var1, var2]\n         = Info ( FileInfo filename 1\n                  ( Dimentions [dimX, dimY, dimZ]\n                    ( Variables  [var1, var2])\n                  )\n                )\n</code></pre>\n\n<p>So all you need is an operator that's left associative:</p>\n\n<pre><code>($&lt;) :: (a -&gt; b) -&gt; a -&gt; b\n($&lt;) = ($)\n\ninfixl 0 $&lt; -- left associative\n</code></pre>\n\n<p>Now the parentheses are correct:</p>\n\n<pre><code>let info = Info $&lt; FileInfo filename 1\n                $&lt; Dimentions [dimX, dimY, dimZ]\n                $&lt; Variables  [var1, var2]\n         = (\n            (\n             (Info \n               (FileInfo filename 1)\n             )\n             (Dimentions [dimX, dimY, dimZ])\n            )\n            (Variables  [var1, var2])\n           )\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4426, "user_id": 450609, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6708bd9ccabfcb1cf6863fb32f32d1de?s=128&d=identicon&r=PG", "display_name": "dave", "link": "https://stackoverflow.com/users/450609/dave"}, "is_accepted": false, "score": 0, "last_activity_date": 1447674706, "creation_date": 1447674706, "answer_id": 33734729, "question_id": 33734429, "link": "https://stackoverflow.com/questions/33734429/chaining-parameters-without-parentheses-in-haskell/33734729#33734729", "title": "Chaining parameters without parentheses in Haskell", "body": "<p>Both <code>let</code> and <code>where</code> clauses are calculated recursively so you could have something like:</p>\n\n<pre><code>where\n    info = Info f dim vars\n    f = FileInfo filename 1\n    dim = Dimentions [dimX, dimY, dimZ]\n    vars = Variables [var1, var2]\n</code></pre>\n\n<p>The <code>$</code> operator and the <code>.</code> operator are used to create a new function.  Thus the expression below:</p>\n\n<pre><code>info = Info $ FileInfo filename 1\n            $ Dimentions [dimX, dimY, dimZ]\n            $ Variables  [var1, var2]\n</code></pre>\n\n<p>says that Info is a Type Constructor that takes <em>one</em> argument, a type that is returned by the FileInfo type which is expected to take three agruments (<code>filename</code>, <code>1</code> and whatever is returned by this next function called <code>Dimentions</code>) and so on.  This isn't at all what you want.</p>\n\n<p>The <code>.</code> operator joins two functions together in the mathematics way of <code>(f . g)(x)</code> is equivalent to <code>f(g(x))</code>.  And again, this is in no way similar to what you are trying to create here.</p>\n"}], "owner": {"reputation": 2471, "user_id": 1447225, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8daac16747c58e2c892e1a398919295c?s=128&d=identicon&r=PG", "display_name": "firegurafiku", "link": "https://stackoverflow.com/users/1447225/firegurafiku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 1, "accepted_answer_id": 33734695, "answer_count": 2, "score": 1, "last_activity_date": 1447674706, "creation_date": 1447673773, "question_id": 33734429, "link": "https://stackoverflow.com/questions/33734429/chaining-parameters-without-parentheses-in-haskell", "title": "Chaining parameters without parentheses in Haskell", "body": "<p>I'm trying to write a convenience wrapper for <a href=\"https://hackage.haskell.org/package/hnetcdf\" rel=\"nofollow\"><code>hnetcdf</code></a> library. Instead of dealing with its low-level interface, I want to be able to describe NetCDF file structure in a simple declarative manner. To achieve this I've created a bunch of ADTs:</p>\n\n<pre><code>data Info = Info FileInfo Dimentions Variables\ndata FileInfo   = FileInfo String Int\ndata Dimentions = Dimentions [Dimention]\ndata Variables  = Variables [Variable]\ndata Dimention  = BoundedDimention String Int | UnboundedDimention String\ndata Variable   = Variable String Int NC.NcType [Dimention]\n</code></pre>\n\n<p>They work if I use them like in the following example:</p>\n\n<pre><code>writeNetCDF :: FilePath -&gt; IO ()\nwriteNetCDF filename = do\n    let dimX, dimY, dimZ = ...\n    let var1, var2       = ...\n    let info = Info (FileInfo filename 1)\n                    (Dimentions [dimX, dimY, dimZ])\n                    (Variables  [var1, var2])\n    ...\n</code></pre>\n\n<p>but I really dislike extra parenthesis. I tried to use <code>($)</code> and <code>(.)</code>, but with no luck:</p>\n\n<pre><code>    -- No way.\n    let info = Info $ FileInfo filename 1\n                    $ Dimentions [dimX, dimY, dimZ]\n                    $ Variables  [var1, var2]\n</code></pre>\n\n<p>Is there another way to chain curried parameters?</p>\n"}, {"tags": ["haskell", "vector", "existential-type", "gadt", "data-kinds"], "comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 1, "creation_date": 1447673735, "post_id": 33734129, "comment_id": 55237169, "body": "Well the problem that I see is that you quantified the Vector, not the inside of it; consider <code>forall a. [a]</code> vs <code>[forall a. a]</code>. That being said, the obvious change produces <code>Illegal polymorphic or qualified type: ... GHC doesn&#39;t yet support impredicative polymorphism</code> which I have no idea how to tackle, tbh. But then again, your <code>MenuItemReference</code> type seems a bit weird - <code>a</code> looks like a phantom type but I&#39;ve no idea what it&#39;s supposed to do."}, {"owner": {"reputation": 550, "user_id": 3809223, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a86c2d7227577450956bbbe1ea6662d8?s=128&d=identicon&r=PG&f=1", "display_name": "ksaveljev", "link": "https://stackoverflow.com/users/3809223/ksaveljev"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1447674112, "post_id": 33734129, "comment_id": 55237410, "body": "This is a stripped down example just to show the problem. The <code>MenuItemReference</code> should be used to grab the correct item from other collections in my state. So <code>MenuItemReference ListS Int</code> will grab something from <code>menuListItems</code>, <code>MenuItemReferences ActionS Int</code> will grab something from <code>menuActionItems</code> and so on (<code>menuListItems</code> and <code>menuActionItems</code> are in <code>MyState</code> and they are <i>Vectors</i> of different data types)"}, {"owner": {"reputation": 550, "user_id": 3809223, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a86c2d7227577450956bbbe1ea6662d8?s=128&d=identicon&r=PG&f=1", "display_name": "ksaveljev", "link": "https://stackoverflow.com/users/3809223/ksaveljev"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1447674302, "post_id": 33734129, "comment_id": 55237540, "body": "Oh... my... god... Thank you Bartek! I actually didn&#39;t see that (I mean duplication). You are correct, this is a useless duplication and the constructors themselves give enough information for me. Thank you very much for pointing that out!"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1447674386, "post_id": 33734129, "comment_id": 55237587, "body": "Yeah this isn&#39;t very straighforward, I backed out of that comment because I thought you meant something else."}], "answers": [{"tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": true, "score": 1, "last_activity_date": 1447675123, "last_edit_date": 1447675123, "creation_date": 1447674349, "answer_id": 33734604, "question_id": 33734129, "link": "https://stackoverflow.com/questions/33734129/vector-containing-gadt/33734604#33734604", "title": "Vector containing GADT", "body": "<p>Why not just</p>\n\n<pre><code>data MenuItemReference = \n    MenuListSReference Int | \n    MenuActionSReference Int | \n    MenuSliderSReference Int\n</code></pre>\n\n<p>then?</p>\n\n<p>The constructor used already annotates the value. You don't need to inject the phantom type, because the information is already there.</p>\n\n<p>Besides, doing so would require enabling GHC (<a href=\"https://wiki.haskell.org/Impredicative_types\" rel=\"nofollow\"><code>{-# LANGUAGE ImpredicativeTypes #-}</code></a>) to actually support <a href=\"https://en.wikipedia.org/wiki/Parametric_polymorphism#Impredicative_polymorphism\" rel=\"nofollow\"><em>impredicative polymorphism</em></a> to construct <code>Vector [forall a. MenuItemReference a Int]</code> and use it polymorphically. While it does support that, the support has been described as \"fragile at best and broken at worst\".</p>\n\n<p>As a side note <a href=\"http://jozefg.bitbucket.org/posts/2014-12-23-impredicative.html\" rel=\"nofollow\">this nice blog post</a> explains how we can get rid of impredicative types, using <code>newtype</code>s and <code>RankNTypes</code> instead. This does require you to introduce a layer of <code>newtype</code>, however.</p>\n"}], "owner": {"reputation": 550, "user_id": 3809223, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a86c2d7227577450956bbbe1ea6662d8?s=128&d=identicon&r=PG&f=1", "display_name": "ksaveljev", "link": "https://stackoverflow.com/users/3809223/ksaveljev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 33734604, "answer_count": 1, "score": 1, "last_activity_date": 1447675123, "creation_date": 1447672804, "question_id": 33734129, "link": "https://stackoverflow.com/questions/33734129/vector-containing-gadt", "title": "Vector containing GADT", "body": "<p>I'm just learning everything I can about ExistentialQuantification and GADTs and KindSignatures, etc. And to do that I try to come up with some small programs which help me to understand everything better. </p>\n\n<p>Now I have this small snippet (which actually compiles, so you can try it on your own, requires <em>vector</em> and <em>mtl</em> packages) and would like to know whether it is at all possible to do what I am trying to accomplish or guide me to how to make it work</p>\n\n<pre><code>{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE ExistentialQuantification #-}\n{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE GADTs #-}\n{-# LANGUAGE Rank2Types #-}\nimport Control.Monad.State.Lazy\nimport qualified Data.Vector as V\n\ndata MenuItem = ListS | ActionS | SliderS\n\ndata MenuItemReference (a :: MenuItem) (n :: *) where\n       MenuListSReference :: Int -&gt; MenuItemReference ListS Int\n       MenuActionSReference :: Int -&gt; MenuItemReference ActionS Int\n       MenuSliderSReference :: Int -&gt; MenuItemReference SliderS Int\n\ndata MyState = MyState { vec :: forall a. V.Vector (MenuItemReference a Int) }\n\nnewMyState :: MyState\nnewMyState = MyState { vec = V.empty }\n\nlistRef :: MenuItemReference ListS Int\nlistRef = MenuListSReference 5\n\nactionRef :: MenuItemReference ActionS Int\nactionRef = MenuActionSReference 3\n\nmyComputation :: State MyState ()\nmyComputation = do\n    addItem listRef\n    addItem actionRef\n    return ()\n\naddItem :: forall a. MenuItemReference a Int -&gt; State MyState ()\naddItem menuItemRef = do\n    s &lt;- get\n    put (s { vec = (vec s) `V.snoc` menuItemRef })\n\nmain :: IO ()\nmain = do\n    print $ evalState myComputation newMyState\n</code></pre>\n\n<p>As you can see I'm trying to get a Vector of MenuItemReferences in it... What is it that I'm doing wrong because with what I have at the moment I get the error:</p>\n\n<pre><code>Couldn't match type \u2018a\u2019 with \u2018a1\u2019\n  \u2018a\u2019 is a rigid type variable bound by\n      the type signature for\n        addItem :: MenuItemReference a Int -&gt; State MyState ()\n      at Main.hs:34:19\n  \u2018a1\u2019 is a rigid type variable bound by\n       a type expected by the context: V.Vector (MenuItemReference a1 Int)\n       at Main.hs:37:10\nExpected type: MenuItemReference a1 Int\n  Actual type: MenuItemReference a Int\nRelevant bindings include\n  menuItemRef :: MenuItemReference a Int (bound at Main.hs:35:9)\n  addItem :: MenuItemReference a Int -&gt; State MyState ()\n    (bound at Main.hs:35:1)\nIn the second argument of \u2018V.snoc\u2019, namely \u2018menuItemRef\u2019\nIn the \u2018vec\u2019 field of a record\n</code></pre>\n\n<p>Could someone explain what is the reason behind the error and how I could approach (if at all possible) the thing I am trying to accomplish.</p>\n"}, {"tags": ["haskell", "haskell-persistent"], "answers": [{"tags": [], "owner": {"reputation": 2878, "user_id": 655862, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/bad65d3d7319025d73e065d7a29ee22a?s=128&d=identicon&r=PG", "display_name": "Greg Weber", "link": "https://stackoverflow.com/users/655862/greg-weber"}, "is_accepted": false, "score": 1, "last_activity_date": 1447700881, "creation_date": 1447700881, "answer_id": 33742724, "question_id": 33733853, "link": "https://stackoverflow.com/questions/33733853/inner-join-in-persistent-or-should-i-use-esqueleto/33742724#33742724", "title": "Inner join in persistent or should I use esqueleto?", "body": "<p>Yes Esqueleto if you want to do joins. Persistent works well with <em>embedding</em> data if your DB and your data modelling support that.</p>\n"}, {"comments": [{"owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "edited": false, "score": 0, "creation_date": 1447744254, "post_id": 33742914, "comment_id": 55269843, "body": "So, this means that I should use Esquelto interface for everything instead of Persistent interface?"}, {"owner": {"reputation": 148, "user_id": 606463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ed4c86260f44586c938ccdd56ff6590?s=128&d=identicon&r=PG", "display_name": "Felipe Lessa", "link": "https://stackoverflow.com/users/606463/felipe-lessa"}, "reply_to_user": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "edited": false, "score": 0, "creation_date": 1447754911, "post_id": 33742914, "comment_id": 55275725, "body": "Not necessarily. You can use both interfaces at the same time. The only small issue is that there are identifier clashes between, so one of them needs to be qualified."}, {"owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "edited": false, "score": 0, "creation_date": 1447760443, "post_id": 33742914, "comment_id": 55279527, "body": "Just tried this. It doesn&#39;t type-check: couldn&#39;t match <code>Value (Key Notification)</code> with <code>ValueList (Key Notification)</code>. Expected type: <code>SqlExpr (ValueList (Key Notification))</code>, actual type <code>(Value (Key Notification))</code>. <code>sub_select</code> is highlighted."}, {"owner": {"reputation": 148, "user_id": 606463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ed4c86260f44586c938ccdd56ff6590?s=128&d=identicon&r=PG", "display_name": "Felipe Lessa", "link": "https://stackoverflow.com/users/606463/felipe-lessa"}, "reply_to_user": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "edited": false, "score": 0, "creation_date": 1447760911, "post_id": 33742914, "comment_id": 55279855, "body": "Oh, of course, it should have been <code>subList_select</code>."}, {"owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "edited": false, "score": 0, "creation_date": 1447761066, "post_id": 33742914, "comment_id": 55279962, "body": "Perfect, thank you for your answer and your work on the library. I&#39;ll spend some time learning the library&#39;s API before moving on."}], "tags": [], "owner": {"reputation": 148, "user_id": 606463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ed4c86260f44586c938ccdd56ff6590?s=128&d=identicon&r=PG", "display_name": "Felipe Lessa", "link": "https://stackoverflow.com/users/606463/felipe-lessa"}, "is_accepted": true, "score": 1, "last_activity_date": 1447760927, "last_edit_date": 1447760927, "creation_date": 1447701536, "answer_id": 33742914, "question_id": 33733853, "link": "https://stackoverflow.com/questions/33733853/inner-join-in-persistent-or-should-i-use-esqueleto/33742914#33742914", "title": "Inner join in persistent or should I use esqueleto?", "body": "<p>As Greg mentioned, Esqueleto is the way to go.  You can try reading <a href=\"http://hackage.haskell.org/package/esqueleto-2.4.1/docs/Database-Esqueleto.html\" rel=\"nofollow\">its main module documentation</a>.</p>\n\n<p>Currently Esqueleto doesn't support joins on <code>UPDATE</code>s.  However, you can use subqueries to the same effect.  </p>\n\n<p>Untested code to get you started:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- | Mark specified notification as already seen by specific user. Note that\n-- we use 'ReleaseId' to select notification, so this may result in several\n-- notifications marked as \u201cread\u201d if they happen to be about the same\n-- release. This is generally what you want.\nmarkAsRead\n  :: ReleaseId         -- ^ Release in question\n  -&gt; UserId            -- ^ User who has seen mentioned release\n  -&gt; SqlPersistM ()\nmarkAsRead release user = \n  update $ \\n -&gt; do\n  set n [ NotifiedUnread =. val False ]\n  where_ $\n    n ^. NotifiedUnread  ==. val True &amp;&amp;.\n    n ^. NotifiedUser    ==. val user &amp;&amp;.\n    n ^. NotifiedAboutWhat `in_` \n      (subList_select $\n       from $ \\t -&gt; do\n       where_ $ t ^. NotificationRelease ==. val release\n       return $ t ^. NotificationId)\n</code></pre>\n"}], "owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 3, "accepted_answer_id": 33742914, "answer_count": 2, "score": 2, "last_activity_date": 1447760927, "creation_date": 1447671956, "question_id": 33733853, "link": "https://stackoverflow.com/questions/33733853/inner-join-in-persistent-or-should-i-use-esqueleto", "title": "Inner join in persistent or should I use esqueleto?", "body": "<p>I have this fragment describing <code>Notification</code> and <code>Notified</code> entities:</p>\n\n<pre><code>Notification\n  type          NotiType\n  release       ReleaseId\n  date          UTCTime\nNotified\n  aboutWhat     NotificationId\n  unread        Bool\n  user          UserId\n</code></pre>\n\n<p>Now I want to write this:</p>\n\n<pre><code>-- | Mark specified notification as already seen by specific user. Note that\n-- we use 'ReleaseId' to select notification, so this may result in several\n-- notifications marked as \u201cread\u201d if they happen to be about the same\n-- release. This is generally what you want.\n\nmarkAsRead\n  :: ReleaseId         -- ^ Release in question\n  -&gt; UserId            -- ^ User who has seen mentioned release\n  -&gt; SqlPersistM ()\nmarkAsRead release user = do\n  ns &lt;- selectKeysList [ NotificationRelease ==. release ] []\n  updateWhere [ NotifiedAboutWhat &lt;-. ns\n              , NotifiedUnread    ==. True\n              , NotifiedUser      ==. user ]\n              [ NotifiedUnread    =.  False ]\n</code></pre>\n\n<p>This works, but extracting list of notifications as <em>list</em> and then using it to select things in another table\u2026 well that's not exactly right. Obviously I need a join here and then I will be able to update everything efficiently.</p>\n\n<p>How to do it in pure <code>persistent</code>? Is it possible and is it a good idea in this case to stay with <code>persistent</code> for this sort of task? Should I use <code>esqueleto</code> instead? It looks like I'll need to learn different DSL to work with it, so I'm not sure whether to switch or not.</p>\n\n<p>How to write <code>markAsRead</code> properly with <code>persistent</code> (if possible)?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 23600, "user_id": 1695172, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/6319d7eafca7852cf04c88598ca31e75?s=128&d=identicon&r=PG", "display_name": "Netwave", "link": "https://stackoverflow.com/users/1695172/netwave"}, "is_accepted": false, "score": 2, "last_activity_date": 1447667927, "creation_date": 1447667927, "answer_id": 33732581, "question_id": 33732513, "link": "https://stackoverflow.com/questions/33732513/why-does-product-return-1/33732581#33732581", "title": "Why does product [] return 1?", "body": "<p>Product is a fold with initial value of 1 so when folding an empty list it just returns the init value, wich is 1.</p>\n\n<p>An example of product implementation to ilustrate it:</p>\n\n<pre><code>product :: [Int] -&gt; Int\nproduct lst = foldr (\\x y -&gt; x*y) 1 lst\n</code></pre>\n\n<p>Take a look to <a href=\"https://wiki.haskell.org/Fold\" rel=\"nofollow\">fold</a> to understand properly.</p>\n"}, {"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 7, "last_activity_date": 1447667934, "creation_date": 1447667934, "answer_id": 33732584, "question_id": 33732513, "link": "https://stackoverflow.com/questions/33732513/why-does-product-return-1/33732584#33732584", "title": "Why does product [] return 1?", "body": "<p>It's a math thing - you usually define a empty sum to be <code>0</code> and an empty product to be <code>1</code> because this will fit your usual laws nicely</p>\n\n<p>for example this way you can justify the inductive definition of a product - <a href=\"https://en.wikipedia.org/wiki/Empty_product\">see Wikipedia</a></p>\n"}, {"comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 2, "creation_date": 1447668086, "post_id": 33732587, "comment_id": 55234001, "body": "@developerbmw you&#39;ll find that wearing your maths hat in Haskell is often beneficial."}], "tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": false, "score": 8, "last_activity_date": 1531206841, "last_edit_date": 1531206841, "creation_date": 1447667952, "answer_id": 33732587, "question_id": 33732513, "link": "https://stackoverflow.com/questions/33732513/why-does-product-return-1/33732587#33732587", "title": "Why does product [] return 1?", "body": "<p>Because that's the identity in the category of multiplication.</p>\n\n<p>To be more practical:</p>\n\n<pre><code>product [1,2,3] == 1 * product 2:3:[]\n                == 1 * 2 * product 3:[]\n                == 1 * 2 * 3 * product []\n</code></pre>\n\n<p>Which in turn allows you to implement it with a simple recursion:</p>\n\n<pre><code>product [] = 1\nproduct (x:xs) = x * product xs\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1579455855, "post_id": 33732724, "comment_id": 105763888, "body": "i.e. <code>product xs = product (xs ++ []) = product xs * product []</code> thus it must be <code>product [] = 1</code>."}], "tags": [], "owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "is_accepted": true, "score": 22, "last_activity_date": 1447668390, "creation_date": 1447668390, "answer_id": 33732724, "question_id": 33732513, "link": "https://stackoverflow.com/questions/33732513/why-does-product-return-1/33732724#33732724", "title": "Why does product [] return 1?", "body": "<p>Lists form a <em>monoid</em> structure, with associative binary operation <code>++</code> and neutral element <code>[]</code>. That is, we have</p>\n\n<pre><code>[] ++ xs = xs = xs ++ []    (xs ++ ys) ++ zs = xs ++ (ys ++ zs)\n</code></pre>\n\n<p>Meanwhile, numbers have lots of monoid structure, but the relevant one here is that where the operation is <code>*</code> and the neutral element is <code>1</code>.</p>\n\n<pre><code>1 * x = x = x * 1           (x * y) * z = x * (y * z)\n</code></pre>\n\n<p>The <code>product</code> function is not only a map from lists of numbers to numbers: it's a <em>monoid homomorphism</em>, reflecting the list monoid structure in the numerical monoid. Crucially,</p>\n\n<pre><code>product (xs ++ ys) = product xs * product ys\n</code></pre>\n\n<p>and</p>\n\n<pre><code>product [] = 1\n</code></pre>\n\n<p>In fact, to get the former, we pretty much have the latter forced upon us.</p>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 0, "last_activity_date": 1579457039, "last_edit_date": 1579457039, "creation_date": 1579452528, "answer_id": 59812242, "question_id": 33732513, "link": "https://stackoverflow.com/questions/33732513/why-does-product-return-1/59812242#59812242", "title": "Why does product [] return 1?", "body": "<p>I think this is best explained in <a href=\"https://stackoverflow.com/a/33732587/4543207\">@Bartek Banachewicz's answer</a> but i just would like add the fact that this all boils down to one famous question in math;</p>\n\n<blockquote>\n  <p>Why is <code>0!</code> equal to <code>1</code>?</p>\n</blockquote>\n\n<p>The <code>Empty</code> element should not break the recursion, in other words it should behave like an identity element. All in all, in math the recursive definition of factorial is;</p>\n\n<blockquote>\n<pre><code>n! = (n+1)! / (n+1)\n</code></pre>\n</blockquote>\n\n<p>Accordingly, a Haskell beauty</p>\n\n<pre><code>factorial :: Int -&gt; Integer\nfactorial n = product [1..n]\n</code></pre>\n\n<p>works just fine as it is. I mean without a test for <code>n</code> being <code>0</code> i.e. <code>[1..0]</code> yielding <code>[]</code>. This might possibly be another question topic.</p>\n"}], "owner": {"reputation": 3784, "user_id": 2593738, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/EO83B.png?s=128&g=1", "display_name": "developerbmw", "link": "https://stackoverflow.com/users/2593738/developerbmw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 604, "favorite_count": 1, "accepted_answer_id": 33732724, "answer_count": 5, "score": 8, "last_activity_date": 1579457039, "creation_date": 1447667706, "last_edit_date": 1447895990, "question_id": 33732513, "link": "https://stackoverflow.com/questions/33732513/why-does-product-return-1", "title": "Why does product [] return 1?", "body": "<p>Why does the function <code>product</code> in Haskell return <code>1</code> if it is given an empty list?</p>\n"}, {"tags": ["haskell", "lazy-evaluation", "evaluation"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1447666519, "post_id": 33731706, "comment_id": 55233018, "body": "I think this will be highly opinionated - in this case it would mean that we would need some strict_base as well - IMO Haskell should stick to it&#39;s lazy roots - if you have to much trouble with you can always choose another language (most are strict) - for me it&#39;s one of the great points of Haskell that I can play/try with a lazy-by-default language"}, {"owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 0, "creation_date": 1447674177, "post_id": 33731706, "comment_id": 55237463, "body": "&quot;in the future version of Haskell&quot; - what version, exactly? (Of GHC, not of Haskell)"}], "answers": [{"comments": [{"owner": {"reputation": 2216, "user_id": 2260919, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6732557387dfa9107c693e19b95b292e?s=128&d=identicon&r=PG", "display_name": "ais", "link": "https://stackoverflow.com/users/2260919/ais"}, "edited": false, "score": 0, "creation_date": 1447666387, "post_id": 33731864, "comment_id": 55232937, "body": "But, is it more about data structures rather than strictness? You can create lazy or infinity list in any language."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 2216, "user_id": 2260919, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6732557387dfa9107c693e19b95b292e?s=128&d=identicon&r=PG", "display_name": "ais", "link": "https://stackoverflow.com/users/2260919/ais"}, "edited": false, "score": 2, "creation_date": 1447666648, "post_id": 33731864, "comment_id": 55233083, "body": "@ais try to redefine <code>foldl&#39;</code> in a strict-language where you just use a lazy-data structure ... you will soon find that the abstraction leaks and that you have to change your <code>foldl&#39;</code>s signature as well"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 5, "last_activity_date": 1447666321, "last_edit_date": 1447666321, "creation_date": 1447665481, "answer_id": 33731864, "question_id": 33731706, "link": "https://stackoverflow.com/questions/33731706/is-there-any-reason-not-to-use-strictpragma-most-of-the-time/33731864#33731864", "title": "Is there any reason not to use StrictPragma most of the time?", "body": "<p>It really depends on the data type at hand. On lists it would be quite harmful.</p>\n\n<pre><code>f n = foldl' (+) 0 [1..n]\n</code></pre>\n\n<p>can be run in constant space (even without deforestation). If the list type were strict, it would require linear space.</p>\n\n<p>Infinite lists idioms become impossible</p>\n\n<pre><code>head $ filter p [1..]\nzip xs [1..]\nfibs = 0:1:zipWith (+) fibs (tail fibs)\n</code></pre>\n\n<p>In high-performance numeric code, strictness does often lead to better performance.</p>\n"}], "owner": {"reputation": 2216, "user_id": 2260919, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6732557387dfa9107c693e19b95b292e?s=128&d=identicon&r=PG", "display_name": "ais", "link": "https://stackoverflow.com/users/2260919/ais"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 2, "accepted_answer_id": 33731864, "answer_count": 1, "score": 3, "last_activity_date": 1447674518, "creation_date": 1447664912, "last_edit_date": 1447674518, "question_id": 33731706, "link": "https://stackoverflow.com/questions/33731706/is-there-any-reason-not-to-use-strictpragma-most-of-the-time", "title": "Is there any reason not to use StrictPragma most of the time?", "body": "<p>There will be support of <a href=\"https://ghc.haskell.org/trac/ghc/wiki/StrictPragma\" rel=\"nofollow\">https://ghc.haskell.org/trac/ghc/wiki/StrictPragma</a> in the future version of GHC.</p>\n\n<p>So evaluation could be similar to other languages like C, JavaScript, etc. </p>\n\n<p>Strict evaluation looks better for performance and understanding of code execution.</p>\n\n<p>Yes, there are functions like (&amp;&amp;) where you need to use lazy parameters, but it should be so often and you can use <code>~</code>. </p>\n\n<p>So, is there any reason not to use StrictPragma most of the time?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 4377, "user_id": 363777, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1EIja.jpg?s=128&g=1", "display_name": "Tobi Nary", "link": "https://stackoverflow.com/users/363777/tobi-nary"}, "edited": false, "score": 0, "creation_date": 1447777916, "post_id": 33754293, "comment_id": 55291818, "body": "What exactly are you trying to do? As your sender function does not loop, it will not actually be like telnet. And why wouldn&#39;t you use sockets? Did you have a look at <a href=\"https://wiki.haskell.org/Implement_a_chat_server\" rel=\"nofollow noreferrer\">the chat server example</a> on the haskell wiki? Oh, and by the way, it&#39;s considered bad ettiquette just blindly using some server for testing."}, {"owner": {"reputation": 1316, "user_id": 2304212, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/217cbdae046a33da5633c7982463104c?s=128&d=identicon&r=PG", "display_name": "PepeHands", "link": "https://stackoverflow.com/users/2304212/pepehands"}, "reply_to_user": {"reputation": 4377, "user_id": 363777, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1EIja.jpg?s=128&g=1", "display_name": "Tobi Nary", "link": "https://stackoverflow.com/users/363777/tobi-nary"}, "edited": false, "score": 0, "creation_date": 1447782474, "post_id": 33754293, "comment_id": 55294945, "body": "@JanGreve you can try it. It will be exactly like telnet. No need of loop here. Every time you press enter <code>getContents</code> will work. And in <code>receive</code> I have <code>forever</code>"}, {"owner": {"reputation": 4377, "user_id": 363777, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1EIja.jpg?s=128&g=1", "display_name": "Tobi Nary", "link": "https://stackoverflow.com/users/363777/tobi-nary"}, "edited": false, "score": 0, "creation_date": 1447841137, "post_id": 33754293, "comment_id": 55320574, "body": "I see. I did somewhat oversee the suble lazy IO that is implied here. Not quite as verbose as I expected is to be from the rest of your code. My bad."}], "tags": [], "owner": {"reputation": 1316, "user_id": 2304212, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/217cbdae046a33da5633c7982463104c?s=128&d=identicon&r=PG", "display_name": "PepeHands", "link": "https://stackoverflow.com/users/2304212/pepehands"}, "is_accepted": true, "score": 0, "last_activity_date": 1447755255, "creation_date": 1447755255, "answer_id": 33754293, "question_id": 33731004, "link": "https://stackoverflow.com/questions/33731004/connecting-to-server-with-haskell/33754293#33754293", "title": "connecting to server with haskell", "body": "<p>As I understood, this code works quite well. The main problem was with port I used. <code>haskell.org</code>'s port 40 is not open (found out using <code>nmap</code>). So the connection just freezed. Only few changes I did in sender and receiver:</p>\n\n<pre><code>sender :: Handle -&gt; IO ()\nsender h = getContents &gt;&gt;= hPutStrLn h\n\nreceiver :: Handle -&gt; IO ()\nreceiver h = hGetContents h &gt;&gt;= putStrLn\n</code></pre>\n\n<p>So the final code is </p>\n\n<pre><code>import Network\nimport Control.Concurrent(forkIO)\nimport System.IO\nimport System.Environment\nimport Control.Monad\n\nsender :: Handle -&gt; IO ()\nsender h = getContents &gt;&gt;= hPutStrLn h\n\nreceiver :: Handle -&gt; IO ()\nreceiver h = forever $ hGetLine h &gt;&gt;= putStrLn \n\nmain :: IO ()\nmain = do\n    [host, port] &lt;- getArgs\n    h &lt;- connectTo host (Service port)\n    forkIO $ receiver h\n    sender h\n    return ()\n</code></pre>\n"}], "owner": {"reputation": 1316, "user_id": 2304212, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/217cbdae046a33da5633c7982463104c?s=128&d=identicon&r=PG", "display_name": "PepeHands", "link": "https://stackoverflow.com/users/2304212/pepehands"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 2, "accepted_answer_id": 33754293, "answer_count": 1, "score": 1, "last_activity_date": 1447755255, "creation_date": 1447662261, "last_edit_date": 1447674195, "question_id": 33731004, "link": "https://stackoverflow.com/questions/33731004/connecting-to-server-with-haskell", "title": "connecting to server with haskell", "body": "<p>Suppose in my program I need to connect to the server (using only <code>Network</code>, not <code>Network.Socket</code>!) and <code>post</code>, <code>get</code> some data (think about it as <code>telnet</code> analog). I need to receive messages from server in separate  thread (because I can send something on server and get something seperatly). So the question is how to receive messages and and send it in two separate threads? I dont know how to use <code>forkIO</code> and how to use <code>Handle</code></p>\n\n<p>For now I wrote something like this:</p>\n\n<pre><code>sender :: Handle -&gt; IO ()\nsender h = do\n    toSend &lt;- getContents\n    hPutStr h toSend\n    sender h\n\nreceiver :: Handle -&gt; IO ()\nreceiver h = do\n    response &lt;- hGetContents h\n    putStrLn $ \"the response is: \" ++ response\n    receiver h\n\nmain :: IO ()\nmain = do\n    let host = \"haskell.org\"\n    let port = 40\n    h &lt;- connectTo host (PortNumber $ fromIntegral i)\n    forkIO $ receiver h\n    sender h\n    return ()\n</code></pre>\n"}, {"tags": ["haskell", "types", "custom-data-type"], "comments": [{"owner": {"reputation": 848, "user_id": 5263547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5765579c508aa191ce2c5aa64d478073?s=128&d=identicon&r=PG&f=1", "display_name": "JHobern", "link": "https://stackoverflow.com/users/5263547/jhobern"}, "edited": false, "score": 9, "creation_date": 1447641974, "post_id": 33727727, "comment_id": 55224796, "body": "You are trying to use show on an X or an O, which is something that you haven&#39;t defined. Is there a reason that you don&#39;t just use <code>deriving Show</code> for your Square?"}, {"owner": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "reply_to_user": {"reputation": 848, "user_id": 5263547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5765579c508aa191ce2c5aa64d478073?s=128&d=identicon&r=PG&f=1", "display_name": "JHobern", "link": "https://stackoverflow.com/users/5263547/jhobern"}, "edited": false, "score": 0, "creation_date": 1447644977, "post_id": 33727727, "comment_id": 55225471, "body": "That did the trick, thanks!  I didn&#39;t realize that X was being shown."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1447662559, "post_id": 33727727, "comment_id": 55230924, "body": "Enabling warnings would have found this bug at compile time."}, {"owner": {"reputation": 4377, "user_id": 363777, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1EIja.jpg?s=128&g=1", "display_name": "Tobi Nary", "link": "https://stackoverflow.com/users/363777/tobi-nary"}, "reply_to_user": {"reputation": 848, "user_id": 5263547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5765579c508aa191ce2c5aa64d478073?s=128&d=identicon&r=PG&f=1", "display_name": "JHobern", "link": "https://stackoverflow.com/users/5263547/jhobern"}, "edited": false, "score": 0, "creation_date": 1447775739, "post_id": 33727727, "comment_id": 55290242, "body": "@JHobern, can you make your comment an answer, so OP can accept? Also, OP, why are you using == on String, not on Square, simply deriving Eq?"}], "answers": [{"tags": [], "owner": {"reputation": 848, "user_id": 5263547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5765579c508aa191ce2c5aa64d478073?s=128&d=identicon&r=PG&f=1", "display_name": "JHobern", "link": "https://stackoverflow.com/users/5263547/jhobern"}, "is_accepted": false, "score": 1, "last_activity_date": 1447788709, "creation_date": 1447788709, "answer_id": 33765469, "question_id": 33727727, "link": "https://stackoverflow.com/questions/33727727/data-type-conversion-in-list-comprehension-haskell/33765469#33765469", "title": "Data type conversion in list comprehension (Haskell)", "body": "<p>The error <code>Non-exhaustive patterns in function</code> means that you have tried to use a function with an argument for which it wasn't defined. In this case, you have tried to use <code>show</code> on either an <code>X</code> or an <code>O</code>, whereas you have only defined it for <code>A</code> through <code>I</code>.</p>\n\n<p>You could fix this by adding:</p>\n\n<pre><code>show X = \"X\"\nshow O = \"O\"\n</code></pre>\n\n<p>However, since your <code>show</code> function doesn't do anything special at all, you would be better off just using <code>deriving Show</code>, and letting Haskell create the function for you.</p>\n"}], "owner": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 533, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1447788709, "creation_date": 1447641632, "question_id": 33727727, "link": "https://stackoverflow.com/questions/33727727/data-type-conversion-in-list-comprehension-haskell", "title": "Data type conversion in list comprehension (Haskell)", "body": "<p>I'm making a simple Tic-Tac-Toe game to learn Haskell.  Each cell in the board has either a player value (X or O) or a positional value if the square is empty (letters A-I, such that:</p>\n\n<pre><code>A|B|C\nD|E|F\nG|H|I\n</code></pre>\n\n<p>)</p>\n\n<p>To start, I've created a simple function that takes an empty board (which looks like the one above) and a String (a letter \"A\" through \"I\"), and returns a board where the letter entered is replaced with an \"X\".  So if I were to call <code>newBoard blankBoard \"C\"</code>, I would expect this to return:</p>\n\n<pre><code>A|B|X\nD|E|F\nG|H|I\n</code></pre>\n\n<p>If I want to keep the <code>Square</code> data type as it is, how could I make this code work:</p>\n\n<pre><code>data Square = A | B | C | D | E | F | G | H | I | X | O deriving (Read)\ninstance Show Square where\n  show A = \"A\"\n  show B = \"B\"\n  show C = \"C\"\n  show D = \"D\"\n  show E = \"E\"\n  show F = \"F\"\n  show G = \"G\"\n  show H = \"H\"\n  show I = \"I\"\ntype Board = [[Square]]\n\nblankBoard :: Board\nblankBoard = [[A,B,C],[D,E,F],[G,H,I]]\n\nnewBoard :: Board -&gt; String -&gt; Board\nnewBoard board letter = [[ if show sq == letter then X else sq | sq &lt;- row ]| row &lt;- board]\n</code></pre>\n\n<p>I'm getting this error, and not sure why:</p>\n\n<pre><code>[[*** Exception: myfunctions.hs:(386,3)-(394,14): Non-exhaustive patterns in function show\n</code></pre>\n"}, {"tags": ["haskell", "type-conversion", "typing"], "answers": [{"comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 1, "creation_date": 1447636590, "post_id": 33727008, "comment_id": 55223470, "body": "See also the simpler <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Text-Read.html#v:readMaybe\" rel=\"nofollow noreferrer\"><code>Text.Read.readMaybe</code></a>."}], "tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": true, "score": 3, "last_activity_date": 1447635168, "creation_date": 1447635168, "answer_id": 33727008, "question_id": 33726932, "link": "https://stackoverflow.com/questions/33726932/comparing-across-data-types-in-haskell/33727008#33727008", "title": "Comparing across data types in Haskell", "body": "<p>For your specific example, you may simply try to parse the string using <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#v:reads\" rel=\"nofollow\"><code>reads</code></a>:</p>\n\n<pre><code>case reads myLetter :: [(Letter, String)] of\n    [(_, \"\")] -&gt; putStrLn \"yes\"\n    otherwise -&gt; putStrLn \"no\"\n</code></pre>\n"}], "owner": {"reputation": 2512, "user_id": 2325380, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SvFan.jpg?s=128&g=1", "display_name": "Mark Karavan", "link": "https://stackoverflow.com/users/2325380/mark-karavan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 33727008, "answer_count": 1, "score": 2, "last_activity_date": 1447635168, "creation_date": 1447634591, "question_id": 33726932, "link": "https://stackoverflow.com/questions/33726932/comparing-across-data-types-in-haskell", "title": "Comparing across data types in Haskell", "body": "<p>Trying to figure out the best way to compare two elements that have similar values, but different types.</p>\n\n<p>For example, this function should print \"Yes\" if the user enters \"A\", \"B\" or \"C,\" and \"No\" for anything else.</p>\n\n<pre><code>data Letter = A | B | C deriving (Read, Show)\ntype LetterList = [Letter]\n\nmain = do\n   putStrLn \"Enter a capital letter, and we'll see if it's in the Letter type!\"\n   myLetter &lt;- getLine\n   if myLetter `elem` myLetters -- here's the rub\n       then do\n           print \"Yes\"\n       else do\n           print \"No\" \n   where\n      myLetters :: LetterList\n      myLetters = [A,B,C]\n</code></pre>\n"}, {"tags": ["algorithm", "haskell"], "comments": [{"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1447631360, "post_id": 33726357, "comment_id": 55222298, "body": "Being new to the language has nothing to do with this problem -- yet. First write down the steps you would take to achieve what you want if you had to do it by hand. Then try to translate each step into code. If you get stuck, you can ask us a specific question about one of the steps."}, {"owner": {"reputation": 63, "user_id": 5382823, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/892a3e47898e9d458a625f99213027be?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/5382823/tyler"}, "reply_to_user": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1447631703, "post_id": 33726357, "comment_id": 55222379, "body": "@Eric          what do you recommend I do as far as getting a kick start to learning the language? It&#39;s confusing to me coming from an imperative language programmer."}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 1, "creation_date": 1447639362, "post_id": 33726357, "comment_id": 55224184, "body": "There are many good Haskell tutorials, like <a href=\"http://learnyouahaskell.com/\" rel=\"nofollow noreferrer\">Learn You A Haskell</a> or <a href=\"http://book.realworldhaskell.org/\" rel=\"nofollow noreferrer\">Real World Haskell</a>. But the algorithm design process is identical in imperative and functional languages. You have to figure out what the algorithm is before you start implementing it."}, {"owner": {"reputation": 63, "user_id": 5382823, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/892a3e47898e9d458a625f99213027be?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/5382823/tyler"}, "reply_to_user": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1447640986, "post_id": 33726357, "comment_id": 55224558, "body": "@Eric        I have edited the problem done to a more specific example of what I am trying to accomplish. Thanks for you help!"}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1447645142, "post_id": 33726357, "comment_id": 55225522, "body": "It&#39;s a much better question now!"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 5382823, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/892a3e47898e9d458a625f99213027be?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/5382823/tyler"}, "edited": false, "score": 0, "creation_date": 1447642618, "post_id": 33727788, "comment_id": 55224938, "body": "wow thank you so much I appreciate the help and this reference will continue to help me in my future implementation of code! Thank you for the heads up!"}, {"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 3, "creation_date": 1447645072, "post_id": 33727788, "comment_id": 55225497, "body": "The functional solution to this problem is <code>getRow3 = map fst</code>"}, {"owner": {"reputation": 19480, "user_id": 2491900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8FMW.jpg?s=128&g=1", "display_name": "shree.pat18", "link": "https://stackoverflow.com/users/2491900/shree-pat18"}, "edited": false, "score": 0, "creation_date": 1447645154, "post_id": 33727788, "comment_id": 55225526, "body": "Yes, I realised it after posting. Monday I guess :P"}], "tags": [], "owner": {"reputation": 19480, "user_id": 2491900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8FMW.jpg?s=128&g=1", "display_name": "shree.pat18", "link": "https://stackoverflow.com/users/2491900/shree-pat18"}, "is_accepted": true, "score": 1, "last_activity_date": 1447642197, "creation_date": 1447642197, "answer_id": 33727788, "question_id": 33726357, "link": "https://stackoverflow.com/questions/33726357/getting-the-first-tuple-of-list-of-tuples-in-haskell/33727788#33727788", "title": "Getting the first tuple of list of tuples in Haskell", "body": "<p>Based on your description, your expected output should be a list of elements, not a list of tuples. Therefore, the first step is to change the signature to:</p>\n\n<pre><code>getRow :: [(Integer,Integer)] -&gt; [Integer]\n</code></pre>\n\n<p>But why restrict to <code>Integer</code>, when the method can work for any type? Let's make it more general by doing this:</p>\n\n<pre><code>getRow :: [(a,b)] -&gt; [a]\n</code></pre>\n\n<p>Now the algorithm itself. You have the right idea about using <code>fst</code> to get the first element. We will use this function, together with a list comprehension to do the job as follows:</p>\n\n<pre><code>getRow lst = [fst x | x &lt;- lst]\n</code></pre>\n\n<p>This will go through the list, extract the first element from each tuple and return a list of the extracted elements. Putting it all together, we get this:</p>\n\n<pre><code>getRow :: [(a,b)] -&gt; [a]\ngetRow lst = [fst x | x &lt;- lst] \n</code></pre>\n\n<p><a href=\"http://rextester.com/OZEZ23522\" rel=\"nofollow\">Demo</a></p>\n\n<p>Of course, this is one of many possible ways to go about the problem. Another solution would be to use a <code>foldr</code> function to do the same thing, like so:</p>\n\n<pre><code>getRow2 :: [(a,b)] -&gt; [a]\ngetRow2 lst = foldr (\\x acc -&gt; (fst x):acc) [] lst\n</code></pre>\n\n<p>You can start off with a good tutorial to learn about the basics of Haskell, and use <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/doc-index.html\" rel=\"nofollow\">Hackage</a> for reference. However, @Eric is absolutely correct to say that in any paradigm, you need to figure out the steps first before you start to write the code.</p>\n"}], "owner": {"reputation": 63, "user_id": 5382823, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/892a3e47898e9d458a625f99213027be?s=128&d=identicon&r=PG&f=1", "display_name": "Tyler", "link": "https://stackoverflow.com/users/5382823/tyler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1851, "favorite_count": 2, "accepted_answer_id": 33727788, "answer_count": 1, "score": 0, "last_activity_date": 1447642197, "creation_date": 1447629963, "last_edit_date": 1447640945, "question_id": 33726357, "link": "https://stackoverflow.com/questions/33726357/getting-the-first-tuple-of-list-of-tuples-in-haskell", "title": "Getting the first tuple of list of tuples in Haskell", "body": "<p>I am trying to get the first element of a tuple for every tuple in a list using the following:</p>\n\n<pre><code>getRow :: [(Integer,Integer)] -&gt; [(Integer,Integer)]\ngetRow (row:rows) = do\n    (fst(head (row)))\n</code></pre>\n\n<p>I thought if I could get the first element of every head of the list of tuples that it would return just the first element, but that wasnt the case. </p>\n"}, {"tags": ["haskell", "error-handling", "exception-handling", "quickcheck"], "answers": [{"comments": [{"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447625629, "post_id": 33724894, "comment_id": 55220739, "body": "Since <code>read</code> should fail completely, and since want to inform, rather than <code>undefined</code> or <code>[]</code>, what about <code>error (show err)</code>? Also in the case of <code>Arbitrary</code>, since I&#39;m generating only valid values for the arguments, I want it to fail immediately rather than quietly try another; so <code>error (show err)</code> rather than <code>arbitrary</code>?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 1, "creation_date": 1447629233, "post_id": 33724894, "comment_id": 55221701, "body": "@raxacoricofallapatorius If you want to write a parser with informative errors, you are free to; you just can&#39;t (shouldn&#39;t) call it <code>read</code>."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447680649, "post_id": 33724894, "comment_id": 55241453, "body": "Ah, I see. I missed that in the docs for <code>Read</code>: no matter what the cause, <code>read</code> should fail with &quot;no parse&quot; (and <code>readsPrec</code> should return <code>[]</code>, as you say: <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#v:readsPrec\" rel=\"nofollow noreferrer\">&quot;If there is no successful parse, the returned list is empty.&quot;</a>). That&#39;s too bad for the user, imv, (since information is lost); but those are the rules I guess."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447680743, "post_id": 33724894, "comment_id": 55241500, "body": "For <code>Arbitrary EnigmaConfig </code> though, if I&#39;m generating arguments that all out to be valid, I certainly don&#39;t want to do rejection sampling (as cool as that is): I just want to fail (I think): it would be a true coding error."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447681293, "post_id": 33724894, "comment_id": 55241861, "body": "(Note that the loss of info in <code>readsPrec</code>, and potentially other cases , can be avoided if the constructer fails with <code>error</code> \u2013 see my recent comment to the <a href=\"http://stackoverflow.com/a/33713265/656912\">related answer</a>.)"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 2, "last_activity_date": 1447620691, "creation_date": 1447620691, "answer_id": 33724894, "question_id": 33724378, "link": "https://stackoverflow.com/questions/33724378/how-do-i-call-a-constructor-that-may-fail-especially-when-implementing-read-a/33724894#33724894", "title": "How do I call a constructor that may fail, especially when implementing &#39;Read&#39; and &#39;Arbitrary&#39;?", "body": "<p>The <code>Read</code> typeclass represents parses as lists of successes (with failures being the same as no successes); so rather than <code>undefined</code> you should return <code>[]</code>. As for losing information about what went wrong: that's true, and the type of <code>readsPrec</code> means you can't do much about that. If you really, really wanted to [note: I don't think you should want this] you could define a newtype wrapper around <code>Except EnigmaError EnigmaConfig</code> and give that a <code>Read</code> instance that had successful parses of configuration errors.</p>\n\n<p>For <code>Arbitrary</code> you have a couple choices. One choice is so-called rejection sampling; e.g.</p>\n\n<pre><code>arbitrary = do\n    -- ...\n    case configEnigma ... of\n        Left err -&gt; arbitrary -- try again\n        Right v  -&gt; return v\n</code></pre>\n\n<p>You might also consider an <code>Arbitrary</code> instance to be part of your internal API, and use unsafe, internal calls rather than using the safe, public API for constructing your configuration. Other options include calling <code>error</code> or <code>fail</code>. (I consider these four options to be in roughly preference order -- rejection sampling, then unsafe internal calls, then <code>error</code>, then <code>fail</code> -- though your judgement may differ.)</p>\n"}], "owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 33724894, "answer_count": 1, "score": 1, "last_activity_date": 1447620691, "creation_date": 1447617802, "question_id": 33724378, "link": "https://stackoverflow.com/questions/33724378/how-do-i-call-a-constructor-that-may-fail-especially-when-implementing-read-a", "title": "How do I call a constructor that may fail, especially when implementing &#39;Read&#39; and &#39;Arbitrary&#39;?", "body": "<p>I have a \"public safe\" that may fail with a (potentially informative) errors:</p>\n\n<pre><code>data EnigmaError = BadRotors\n                 | BadWindows\n                 | MiscError String\n\ninstance Show EnigmaError where\n  show BadRotors = \"Bad rotors\"\n  show BadWindows = \"Bad windows\"\n  show (MiscError str) = str\n\nconfigEnigma :: String -&gt; String -&gt; String -&gt; String -&gt; Except EnigmaError EnigmaConfig\nconfigEnigma rots winds plug rngs = do\n        unless (and $ [(&gt;=1),(&lt;=26)] &lt;*&gt; rngs') (throwError BadRotors)\n        unless (and $ (`elem` letters) &lt;$&gt; winds') (throwError BadWindows)\n        -- ...\n        return EnigmaConfig {\n                components = components',\n                positions = zipWith (\\w r -&gt; (mod (numA0 w - r + 1) 26) + 1) winds' rngs',\n                rings = rngs'\n        }\n    where\n        rngs' = reverse $ (read &lt;$&gt; (splitOn \".\" $ \"01.\" ++ rngs ++ \".01\") :: [Int])\n        winds' = \"A\" ++ reverse winds ++ \"A\"\n        components' = reverse $ splitOn \"-\" $ rots ++ \"-\" ++ plug\n</code></pre>\n\n<p>but it is unclear how I should call this, particularly (and specifically) in implementing <code>Read</code> and <code>Arbitrary</code> (for QuickCheck).</p>\n\n<p>For the former, I can get as far as</p>\n\n<pre><code>instance Read EnigmaConfig where\n        readsPrec _ i = case runExcept (configEnigma c w s r) of\n            Right cfg  -&gt; [(cfg, \"\")]\n            Left err -&gt; undefined\n          where [c, w, s, r] = words i\n</code></pre>\n\n<p>but this seems to end up hiding error information available in <code>err</code>; while for the latter, I'm stuck at</p>\n\n<pre><code>instance Arbitrary EnigmaConfig where\n        arbitrary = do\n                nc &lt;- choose (3,4)  -- This could cover a wider range\n                ws &lt;- replicateM nc capitals\n                cs &lt;- replicateM nc (elements rotors)\n                uk &lt;- elements reflectors\n                rs &lt;- replicateM nc (choose (1,26))\n                return $ configEnigma (intercalate \"-\" (uk:cs))\n                                      ws\n                                      \"UX.MO.KZ.AY.EF.PL\"  -- TBD - Generate plugboard and test &lt;&lt;&lt;\n                                      (intercalate \".\" $ (printf \"%02d\") &lt;$&gt; (rs :: [Int]))\n</code></pre>\n\n<p>which fails with a mismatch between the expected and actual types:</p>\n\n<blockquote>\n  <p>Expected type: Gen EnigmaConfig\n  Actual type: Gen (transformers-0.4.2.0:Control.Monad.Trans.Except.Except Crypto.Enigma.EnigmaError EnigmaConfig)</p>\n</blockquote>\n\n<p>How do I call a (\"public safe\") constructor when it may fail, particularly when using it in implementing <code>Read</code> and <code>Arbitrary</code> for my class?</p>\n"}, {"tags": ["haskell", "documentation", "haddock"], "comments": [{"owner": {"reputation": 7297, "user_id": 1176156, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/89604545aa57aa3d14306af60126e193?s=128&d=identicon&r=PG", "display_name": "MaxGabriel", "link": "https://stackoverflow.com/users/1176156/maxgabriel"}, "edited": false, "score": 0, "creation_date": 1447622338, "post_id": 33724361, "comment_id": 55219705, "body": "I wrote these Haddocks, which have multiple examples: <a href=\"https://github.com/yesodweb/yesod/blob/5e2fa9af821ab3eb1e26c2942897ebda496146af/yesod-form/Yesod/Form/Bootstrap3.hs#L8-L12\" rel=\"nofollow noreferrer\">github.com/yesodweb/yesod/blob/&hellip;</a> Maybe try deleting one of the <code>--</code> lines, or seeing if adding a title before the code sample fixes it?"}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 1, "creation_date": 1447634630, "post_id": 33724361, "comment_id": 55223075, "body": "Unrelated: The singular of &quot;series&quot; is still &quot;series&quot;."}], "owner": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1447617705, "creation_date": 1447617705, "question_id": 33724361, "link": "https://stackoverflow.com/questions/33724361/named-documentation-chunk-with-haddock", "title": "Named documentation chunk with Haddock", "body": "<p>I'm trying to document my sources and I have a problem with named chunk.</p>\n\n<p>I would like to document a large amount of patterns (more than 50), I would like to keep each explanation near the code and gather all the explanations in the header</p>\n\n<p>I tried the following : </p>\n\n<pre><code>module Haddock\n  (\n  -- A test for Haddock named chunk\n  --\n  -- $doc1\n  --\n  -- $doc2\n  --\n  -- $doc3\n  )\n  where\n\n-- $doc1 \n-- First serie of explanations\nmyFunction 0 = 1\nmyFunction 1 = 1\n\n-- $doc2 \n-- Second serie of explanations  \nmyFunction 2 = 3\n\n-- $doc3 \n-- Some examples\n--\n-- &gt; myFunction a \n--\nmyFunction a = a * a \n</code></pre>\n\n<p>but only the first chunk is shown : </p>\n\n<p><a href=\"https://i.stack.imgur.com/HCQO6.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/HCQO6.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Is there something wrong with my Haddock markup or is it a bug ?</strong></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1447617612, "post_id": 33724233, "comment_id": 55218065, "body": "I&#39;m not sure if it would be an improvement, but you could try <code>V.replicate</code> to allocate a large vector upfront, and then update it later on."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1447618208, "post_id": 33724233, "comment_id": 55218267, "body": "&quot;using only newBox&quot; and &quot;without snocing once for each box&quot; are contradictory requirements - newBox hard codes a snoc for each box, if you are not allowed to use any other function other than newBox, you are stuck with one snoc per box. Or perhaps I&#39;ve interpreted the requirement &quot;using only newBox&quot; too strictly?"}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1447618534, "post_id": 33724233, "comment_id": 55218393, "body": "I mean I can rewrite newbox but I would like to keep the same signature (if possible)"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1447620740, "post_id": 33724233, "comment_id": 55219178, "body": "@mb14: what&#39;s the context, why do you want to keep the operation or the signature? The current <code>newBox</code> is a performance bug for vector building, and its type doesn&#39;t support any sensible avenue for correction."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1447621079, "post_id": 33724233, "comment_id": 55219274, "body": "I like the idea of a having a smart constructor which forbid to create a box outside of a warehouse or let the user assign an incorrect id. I have also different methods of loading boxes from different file format I would like as less refactoring as possible."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447624451, "post_id": 33724233, "comment_id": 55220373, "body": "I would guess <code>constructN</code> does what you want, but you&#39;ll have to restructure the surrounding code somewhat. I can write a bit more about how if you show a bit more of the surrounding code."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447626305, "post_id": 33724233, "comment_id": 55220915, "body": "@DanielWagner See my update"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447633791, "post_id": 33724233, "comment_id": 55222894, "body": "@mb14 Your updated example is too simple to show why you need the <code>State</code> machinery: use <code>data Box = Box String</code> and later in the case statement use <code>Right rows -&gt; Vec.concatMap (\\(style,qty) -&gt; Vec.replicate qty (Box style)) rows</code>."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1447653810, "post_id": 33724233, "comment_id": 55227784, "body": "&quot;Preallocating&quot; an immutable vector doesn&#39;t really make sense, even if you allocate a vector with empty values (ie, <code>Vector.replicate 1000 undefined</code>), then &quot;fill&quot; it by writing the vector, you still create a copy of the entire old vector when you &quot;write&quot; to that vector. You should simply create a new primitive operation for creating multiple boxes efficiently. Or, just use a data structure which supports this operation (snoc) efficiently, like a list - this choice will depend on what other operations you need. Also, perhaps you need to include the entire specification of the &quot;warehouse&quot; model"}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447665253, "post_id": 33724233, "comment_id": 55232253, "body": "@DanielWagner This is not a XY problem. The fact that I need to use State or not is irrelevant and shouldn&#39;t affect the answer. A good reason to keep this state is, the whole application is written that way, and I&#39;m not planning to change it (just to clarify, I&#39;m not at the design state, the program works, and has been there for 6 months. It&#39;s just a bit slow (2 or 3 secondes to load 5000 boxes) nothing serious. I was just wondering how I could improve the loading time."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1447665424, "post_id": 33724233, "comment_id": 55232346, "body": "@user2407038 fair comment. I&#39;m ready to use mutable vector if someone tell me how to to it ;-)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447685203, "post_id": 33724233, "comment_id": 55244437, "body": "@mb14 If you are not planning to change anything, you also aren&#39;t going to be changing the performance."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447703182, "post_id": 33724233, "comment_id": 55255225, "body": "@DanielWagner I&#39;m not not planing to change anything, I&#39;m just planing to change everything. My point is how can you create a vector efficiency by creating element one by one. All the question about context are irrelevant here."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447705125, "post_id": 33724233, "comment_id": 55256245, "body": "@mb14 If you do not know the solution, how can you know what is relevant and irrelevant to the solution?"}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447705309, "post_id": 33724233, "comment_id": 55256330, "body": "@DanielWagner because loading/creating data and using them are orthogonal."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447709017, "post_id": 33724233, "comment_id": 55258176, "body": "@mb14 I guess what you&#39;re implying is that you are asking a question about loading data, and objecting to us asking questions about data use. But my questions, at least, are about the context of the loading process -- not the context of the use."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447709292, "post_id": 33724233, "comment_id": 55258317, "body": "@DanielWagner I misunderstood then. I provide the code of the load function, what context is missing ?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447709464, "post_id": 33724233, "comment_id": 55258416, "body": "@mb14 As I said in my previous comment: you should provide enough so that we can see why you need to use <code>State</code>. I gave a simple solution for the existing loading code that does not need <code>State</code> in the same comment."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447710153, "post_id": 33724233, "comment_id": 55258776, "body": "@DanielWagner The reason why I use State is in the &quot;context of use&quot;. The main reason is boxes need and Id to be referenced by shelves, which why I put them in a vector. I use a state so that it&#39;s impossible to create a box outside a <i>warehouse</i> (ie can&#39;t create a box which doesn&#39;t exist in vector). Anyway, my question is about using State, and why do I need it is irrelevant."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447710416, "post_id": 33724233, "comment_id": 55258909, "body": "@mb14 Again, you can&#39;t know what is relevant, because you don&#39;t know an answer to your question. I don&#39;t understand the connection between &quot;using the data requires <code>State</code>&quot; and &quot;loading the data requires <code>State</code>&quot;; presumably the state can be initialized after loading. I don&#39;t understand the connection between &quot;boxes need an ID&quot; and &quot;I must use <code>State</code>&quot;; the boxes have an index in the resulting <code>Vector</code>, which is an ID, whether that <code>Vector</code> is constructed using <code>State</code> or not. I don&#39;t understand the comment about warehouses at all."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447710595, "post_id": 33724233, "comment_id": 55258992, "body": "@DanielWagner. Ok forget about the State. However I still need Box to hold a boxId which is it&#39;s position within the Vector. Your solution with <code>replicate</code> and <code>concatMap</code> doesn&#39;t provide that."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447710669, "post_id": 33724233, "comment_id": 55259026, "body": "@mb14 It is easy to achieve using <code>Vec.indexed</code> or <code>Vec.imap</code>."}], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1447626300, "creation_date": 1447617060, "last_edit_date": 1447626300, "question_id": 33724233, "link": "https://stackoverflow.com/questions/33724233/how-to-preallocate-vector-in-haskell", "title": "How to preallocate Vector in Haskell", "body": "<p>I made an application which involves mutable graph (I need to be able to modify object referencing each other). For that, I use and id and store each object in a <code>Vector</code> (the id of an object being it's position within the vector). The vector is kept in a state and creating a new object is done using a state transformer.\nEverything is working fine, however, the creation of each object involves a <code>snoc</code>. This lead to bad performance when I load all the objects from a file. Is there a way to allocate the vector with the correct size ? My problem is, I can't use <code>fromList</code> because I can only create objects using a smart constructor using a state monad.</p>\n\n<p>The code I have (simplified) is the following</p>\n\n<pre><code>data Box = { boxId :: Int , boxName :: String }\ndata Warehouse = { whBoxes :: Vector Box }\n\ntype WH = State Warehouse\n\nnewBox :: String -&gt; WH Box\nnewBox name = do\n     warehouse &lt;- get\n     let boxes = whBoxes warehouse \n     boxId = Vector.length boxes warehouse\n     box = Box boxId name\n\n     put warehouse { whBoxes = boxes `V.snoc` box }\n     return box\n</code></pre>\n\n<p>How can read a file and populate the warehouse with boxes using only <code>newBox</code> without <em>snocing</em> once for each new box ?</p>\n\n<h1>Update</h1>\n\n<p>My current function reads a csv containing then name of the box and the number of identical box (I'm using cassava)</p>\n\n<pre><code>import qualified Data.Csv as Csv\nimport qualified Data.ByteString.Lazzy as BL\nimport qualified Data.Vector as Vec\n\nreadBoxes :: String -&gt; IO (WH ())\nreadBoxes filename = do\n    csvData &lt;- BL.readFile filename\n\n    case Csv.decode  Csv.HasHeader csvData of\n         Left err -&gt;  do putStrLn err; return (return ())\n         Right (rows) -&gt; do\n                Vec.forM_ rows $ \\(style, qty) -&gt;\n                       let types = qty :: Int\n                       in forM [1..qty] $   \\i -&gt; newBox style\n</code></pre>\n\n<p>(As I said earlier, I simplified the code so it might not compile).</p>\n"}, {"tags": ["json", "haskell", "memory-leaks", "aeson"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1447628195, "post_id": 33723999, "comment_id": 55221417, "body": "What are the other json datasets of comparable size?"}, {"owner": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1447631468, "post_id": 33723999, "comment_id": 55222316, "body": "I truncated citylots to ~ 20MB and compared with files from <a href=\"http://jsonstudio.com/resources/\" rel=\"nofollow noreferrer\">jsonstudio.com/resources</a>"}], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 1, "last_activity_date": 1447633441, "creation_date": 1447633441, "answer_id": 33726801, "question_id": 33723999, "link": "https://stackoverflow.com/questions/33723999/aeson-benchmark-space-leak-on-citylots-json/33726801#33726801", "title": "aeson benchmark space leak (?) on citylots.json", "body": "<p>From what I can tell this is should be expected.</p>\n\n<p>The file citylots.json is a 167 MB file consisting of a single Object. The AesonParse program is building the entire object in memory, and that explains the memory ramp in the profile.</p>\n\n<p>By contrast, the files companies.json and enron.json at <a href=\"http://jsonstudio.com/resources/\" rel=\"nofollow\">http://jsonstudio.com/resources/</a>  are \"line-oriented\" JSON files - each line is a JSON object and there are no commas between the objects. When you run AesonParse on either of these files it is only reading the first line.</p>\n"}], "owner": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "accepted_answer_id": 33726801, "answer_count": 1, "score": 1, "last_activity_date": 1447633441, "creation_date": 1447615762, "question_id": 33723999, "link": "https://stackoverflow.com/questions/33723999/aeson-benchmark-space-leak-on-citylots-json", "title": "aeson benchmark space leak (?) on citylots.json", "body": "<p>I've been playing around with the <a href=\"https://github.com/bos/aeson\" rel=\"nofollow noreferrer\">Aeson</a> parser's benchmark suite and got some surprising results comparing their strict parser and the lazy one: </p>\n\n<ul>\n<li>On all datasets that come with the <a href=\"https://github.com/bos/aeson/tree/master/benchmarks\" rel=\"nofollow noreferrer\">benchmark</a>, the strict parser always takes more time (this is expected) but never saves any space. </li>\n<li>Running the <a href=\"https://github.com/bos/aeson/blob/master/benchmarks/AesonParse.hs\" rel=\"nofollow noreferrer\"><code>AesonParse</code></a> benchmark on <a href=\"https://github.com/zeMirco/sf-city-lots-json\" rel=\"nofollow noreferrer\"><code>citylots.json</code></a> takes dramatically more time and space than other datasets of comparable size. </li>\n</ul>\n\n<p>To get the benchmark running: </p>\n\n<pre><code>cd aeson; cabal install\ncd benchmark; make\n./AesonParse_p [blksz] [runs] [path-to-json] +RTS -p -hc\n</code></pre>\n\n<p>Here are some profiles I got with <code>+RTS</code> turned on: </p>\n\n<p>From the profiles the leak traced back to <code>jstring_</code> in <code>Data.Aeson.Parser.Internal</code> Anyone knows what's going on? </p>\n\n<pre><code>    Sun Nov 15 13:56 2015 Time and Allocation Profiling Report  (Final)\n\n       AesonParse_p +RTS -p -hc -RTS 105532 700 json-data/jp100.json\n\n    total time  =        3.42 secs   (3417 ticks @ 1000 us, 1 processor)\n    total alloc = 4,191,614,072 bytes  (excludes profiling overheads)\n\nCOST CENTRE          MODULE                     %time %alloc\n\njstringbang_         Data.Aeson.Parser.Internal  96.4   93.1\narrayValues          Data.Aeson.Parser.Internal   1.7    1.9\nobject_'             Data.Aeson.Parser.Internal   1.1    1.9\nmain.\\.\\.loop.refill Main                         0.7    3.2\n\n\n                                                                         individual     inherited\nCOST CENTRE               MODULE                       no.     entries  %time %alloc   %time %alloc\n\nMAIN                      MAIN                         116           0    0.0    0.0   100.0  100.0\n main                     Main                         233           0    0.0    0.0   100.0  100.0\n  main.blkSize            Main                         242           1    0.0    0.0     0.0    0.0\n  main.count              Main                         239           1    0.0    0.0     0.0    0.0\n  main.\\                  Main                         234           1    0.0    0.0   100.0  100.0\n   main.\\.\\               Main                         235           1    0.0    0.0   100.0  100.0\n    main.\\.\\.rate         Main                         252           1    0.0    0.0     0.0    0.0\n    main.\\.\\.loop         Main                         238         701    0.1    0.0   100.0  100.0\n     object_'             Data.Aeson.Parser.Internal   245           0    1.1    1.9    99.2   96.8\n      jstring_        Data.Aeson.Parser.Internal   247           0   96.4   93.1    98.1   94.9\n       array_'            Data.Aeson.Parser.Internal   249           0    0.0    0.0     1.7    1.9\n        arrayValues       Data.Aeson.Parser.Internal   251           0    1.7    1.9     1.7    1.9\n     main.\\.\\.loop.refill Main                         241           1    0.7    3.2     0.7    3.2\n CAF                      GHC.IO.FD                    217           0    0.0    0.0     0.0    0.0\n CAF                      GHC.IO.Encoding.Iconv        215           0    0.0    0.0     0.0    0.0\n CAF                      Text.Read.Lex                209           0    0.0    0.0     0.0    0.0\n CAF                      GHC.IO.Handle.FD             202           0    0.0    0.0     0.0    0.0\n CAF                      GHC.Conc.Signal              198           0    0.0    0.0     0.0    0.0\n CAF                      GHC.IO.Handle.Text           191           0    0.0    0.0     0.0    0.0\n CAF                      GHC.IO.Encoding              188           0    0.0    0.0     0.0    0.0\n CAF                      Data.Time.Clock.UTC          129           0    0.0    0.0     0.0    0.0\n CAF                      Data.Aeson.Parser.Internal   124           0    0.0    0.0     0.0    0.0\n  array_'                 Data.Aeson.Parser.Internal   248           1    0.0    0.0     0.0    0.0\n   arrayValues            Data.Aeson.Parser.Internal   250           1    0.0    0.0     0.0    0.0\n  jstringbang_            Data.Aeson.Parser.Internal   246           1    0.0    0.0     0.0    0.0\n  object_'                Data.Aeson.Parser.Internal   244           1    0.0    0.0     0.0    0.0\n CAF                      Main                         123           0    0.0    0.0     0.0    0.0\n  main                    Main                         232           1    0.0    0.0     0.0    0.0\n   main.blkSize           Main                         243           0    0.0    0.0     0.0    0.0\n   main.count             Main                         240           0    0.0    0.0     0.0    0.0\n   main.\\                 Main                         236           0    0.0    0.0     0.0    0.0\n    main.\\.\\              Main                         237           0    0.0    0.0     0.0    0.0\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Vxky5.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Vxky5.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["haskell", "memory", "crash", "ghc"], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 6, "last_activity_date": 1447612684, "creation_date": 1447612684, "answer_id": 33723436, "question_id": 33723285, "link": "https://stackoverflow.com/questions/33723285/haskell-ghc-memory-usage/33723436#33723436", "title": "Haskell/GHC memory usage", "body": "<p>Compile instead of running from within ghci. On my machine this took virt usage from 5GB to 140MB; res never went above about 15MB for the compiled version. In general (with a very few exceptions), the performance characteristics of ghci are much, much worse than that of a compiled program.</p>\n"}], "owner": {"reputation": 93, "user_id": 4933818, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-b6oiPap26WI/AAAAAAAAAAI/AAAAAAAAG_E/ZaiNkiTHCCs/photo.jpg?sz=128", "display_name": "Yann Rolland", "link": "https://stackoverflow.com/users/4933818/yann-rolland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 601, "favorite_count": 0, "accepted_answer_id": 33723436, "answer_count": 1, "score": 2, "last_activity_date": 1447612684, "creation_date": 1447611804, "question_id": 33723285, "link": "https://stackoverflow.com/questions/33723285/haskell-ghc-memory-usage", "title": "Haskell/GHC memory usage", "body": "<p>I'm playing around with Haskell and writing files.\nHere is a little piece of code that for every \"blue\" in [0..255]\u00a0creates an image in PPM with \"red\" and \"green\" in [0..255]. It produces within a folder all images.</p>\n\n<p>This little program makes my computer crash buy using more than 5 gB of memory and I don't know why. What I asked him to do seems pretty simple for me and the total space taken by generated images is - 200 mB ... and don't understand why memory explodes.</p>\n\n<p>Here is the code :</p>\n\n<pre><code>import System.Directory\nimport Data.Colour.SRGB\nimport Data.List.Split\n\ngridColours         = [[RGB 255 0 0, RGB 0 255 0], [RGB 0 0 255, RGB 0 0 0]]\ngridColours2 b      = chunksOf 256 [RGB r g b| r &lt;- [0..255], g &lt;- [0..255]]\n\ndimensions l        = (length . head $ l, length l)\ncoupleToList (a,b)  = [a,b]\ngenDataLines list   = unwords . (map showColour) . concat $ list\ngenDims list        = unwords . (map show) . coupleToList . dimensions $ list\nwritePPM list path  = writeFile path $ unwords $ [\"P3\", genDims list, \"255\", genDataLines list]\nshowColour c        = unwords . (map show) $ [channelRed c, channelGreen c, channelBlue c]\n\nmain = do\n    createDirectoryIfMissing True \"/tmp/PPM-out/\"\n    mapM_ (\\x -&gt; writePPM (gridColours2 x) (\"/tmp/PPM-out/image\"++(show x)++\".ppm\")) [0..255]\n</code></pre>\n\n<p>A perfect answer would explain me what I did wrong and give me advices about how to solve this problem of memory to my system from crashing.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1447612976, "post_id": 33723186, "comment_id": 55216419, "body": "What do you mean by not good for performance ? It&#39;s O(n), but that&#39;s the inevitable."}, {"owner": {"reputation": 4733, "user_id": 728407, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26b3f058ce75a05fd2ccc561f1cfa501?s=128&d=identicon&r=PG", "display_name": "Ashish Negi", "link": "https://stackoverflow.com/users/728407/ashish-negi"}, "reply_to_user": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 2, "creation_date": 1447613448, "post_id": 33723186, "comment_id": 55216578, "body": "my X &lt;&lt; n, so i think that it should be doable in O(X) and not O(n)"}], "answers": [{"comments": [{"owner": {"reputation": 4733, "user_id": 728407, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26b3f058ce75a05fd2ccc561f1cfa501?s=128&d=identicon&r=PG", "display_name": "Ashish Negi", "link": "https://stackoverflow.com/users/728407/ashish-negi"}, "edited": false, "score": 0, "creation_date": 1447613867, "post_id": 33723540, "comment_id": 55216725, "body": "I am a haskell newbie.. chapter &quot;input-output&quot; in LYAH.. so not familiar with Monoid.. but is it like storing length with the list itself.?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 4733, "user_id": 728407, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26b3f058ce75a05fd2ccc561f1cfa501?s=128&d=identicon&r=PG", "display_name": "Ashish Negi", "link": "https://stackoverflow.com/users/728407/ashish-negi"}, "edited": false, "score": 1, "creation_date": 1447614041, "post_id": 33723540, "comment_id": 55216787, "body": "@AshishNegi That&#39;s it exactly."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 7, "last_activity_date": 1447613701, "last_edit_date": 1447613701, "creation_date": 1447613342, "answer_id": 33723540, "question_id": 33723186, "link": "https://stackoverflow.com/questions/33723186/performance-of-predicate-on-the-length-of-a-list/33723540#33723540", "title": "Performance of predicate on the length of a list", "body": "<p>On vanilla lists, you can check this using <code>drop</code>:</p>\n\n<pre><code>cmpLen :: Int -&gt; [a] -&gt; Ordering\ncmpLen n xs\n    | n &lt; 0     = GT\n    | otherwise = case drop (n-1) xs of\n        []  -&gt; GT\n        [_] -&gt; EQ\n        _   -&gt; LT\n</code></pre>\n\n<p>However, this still takes as long as the <em>value</em> (not size, as is typical of asymptotic analysis!) of <code>n</code>. If you intend to do this often, you can take a cue from Okasaki and build a new structure that caches the operation you want to be efficient. I have wanted this a few times before, and found the following sort of interface convenient in those cases:</p>\n\n<pre><code>type LenList a = (Sum Word, [a])\nsingleton x = (1, [x])\ncons x = (singleton x&lt;&gt;)\nlength = getSum . fst\nelems  = snd\n</code></pre>\n\n<p>Note that, since <code>LenList a</code> is already a <code>Monoid</code>, you get some of the usual operations for free, e.g. there is an empty <code>LenList a</code> named <code>mempty</code>, and concatenation is given by <code>(&lt;&gt;)</code>. Some operations (notably the ones that produce infinite lists) will not be implementable for this type. However, you pay an O(1) price on each construction operation to make asking for the length of one of these O(1), which can be a nice tradeoff in many situations.</p>\n"}], "owner": {"reputation": 4733, "user_id": 728407, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26b3f058ce75a05fd2ccc561f1cfa501?s=128&d=identicon&r=PG", "display_name": "Ashish Negi", "link": "https://stackoverflow.com/users/728407/ashish-negi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 33723540, "answer_count": 1, "score": 2, "last_activity_date": 1447613701, "creation_date": 1447611271, "question_id": 33723186, "link": "https://stackoverflow.com/questions/33723186/performance-of-predicate-on-the-length-of-a-list", "title": "Performance of predicate on the length of a list", "body": "<p>I have read (and also reasoned) that calculating the length of a list is not good for performance in Haskell. However, i have long lists in my program and my requirement is to find that if length is greater than or less than some number X.</p>\n\n<p>Is their already something in build in Haskell for these kind of predicates ? or i have to resort to manual looping.</p>\n"}, {"tags": ["haskell", "random", "numbers"], "answers": [{"comments": [{"owner": {"reputation": 383, "user_id": 4847170, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/dffff1120ce7fce426c128efc46bb125?s=128&d=identicon&r=PG&f=1", "display_name": "EasternDude", "link": "https://stackoverflow.com/users/4847170/easterndude"}, "edited": false, "score": 1, "creation_date": 1447612148, "post_id": 33723128, "comment_id": 55216167, "body": "This doesnt help. It returns type: \u2018IO ()\u2019 so i can&#39;t do something like:  let l1 = main :: [Int]  i need to work with lists of basic types... [String] , [Int] . Im not yet familiar with all this IO stuff, Monads, etc"}], "tags": [], "owner": {"reputation": 10726, "user_id": 889902, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/ops76.png?s=128&g=1", "display_name": "Wojciech Danilo", "link": "https://stackoverflow.com/users/889902/wojciech-danilo"}, "is_accepted": false, "score": -1, "last_activity_date": 1447611003, "creation_date": 1447611003, "answer_id": 33723128, "question_id": 33723097, "link": "https://stackoverflow.com/questions/33723097/random-numbers-in-haskell-and-shuffling-a-list/33723128#33723128", "title": "Random numbers in haskell. And shuffling a list", "body": "<p>Use <code>mapM</code> here. Try:</p>\n\n<pre><code>main = do \n    lst &lt;- mapM getRandom [1..100]\n    print lst\n</code></pre>\n\n<p><code>mapM</code> is like map but for monadic operations (like <code>IO</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 383, "user_id": 4847170, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/dffff1120ce7fce426c128efc46bb125?s=128&d=identicon&r=PG&f=1", "display_name": "EasternDude", "link": "https://stackoverflow.com/users/4847170/easterndude"}, "edited": false, "score": 0, "creation_date": 1447621140, "post_id": 33724321, "comment_id": 55219295, "body": "It kinda is disappointing if youre making a function to shuffle a deck of cards and evry time you shuffle a deck it returns exact same shuffled deck.... Anyway, i got it working, thanks"}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 1, "creation_date": 1447636059, "post_id": 33724321, "comment_id": 55223352, "body": "The seed type <code>System.Random</code> provides is <code>StdGen</code>, not <code>Int</code>."}], "tags": [], "owner": {"reputation": 4761, "user_id": 2277395, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/09841ca82e49f998ea0b8f159dea87c1?s=128&d=identicon&r=PG", "display_name": "Martin Drautzburg", "link": "https://stackoverflow.com/users/2277395/martin-drautzburg"}, "is_accepted": false, "score": 3, "last_activity_date": 1447617813, "last_edit_date": 1447617813, "creation_date": 1447617478, "answer_id": 33724321, "question_id": 33723097, "link": "https://stackoverflow.com/questions/33723097/random-numbers-in-haskell-and-shuffling-a-list/33724321#33724321", "title": "Random numbers in haskell. And shuffling a list", "body": "<p>In haskell you cannot create a random number out of thin air. You can create it from a seed, but then you get the excat same sequence of random numbers each time you use the same seed. </p>\n\n<p>Or you take the seed from the outside world. Then you can \"enter\" a different seed each time you run the program, or you let a library pick one from the system time or however it does it - either way you are in IO-land. If you go this route, then you pick your random number inside an IO-operation and shuffle the list with it. The shuffling itself will be a pure operation. You can then print the shuffled list to IO, but you cannot escape IO-land.</p>\n\n<p>If the focus of this task is to learn how to shuffle lists, then it probably doesn't matter much how you get your random number, as long as you get the shuffling right (which is tricky enough).</p>\n\n<p>So write a function</p>\n\n<pre><code>shuffle :: Int-&gt;[a]-&gt;[a]\n</code></pre>\n\n<p>where the first parameter is a random seed. You can then stay in pure-land and use the System.Random functions you create more random numbers if you need any. Don't be disappointed if your program shuffles the list in the exact same way whenever you call it. </p>\n"}, {"comments": [{"owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "edited": false, "score": 0, "creation_date": 1558609971, "post_id": 56203759, "comment_id": 99162469, "body": "In fact, you can get rid of the associative integer array by importing the official module System.Random.Shuffle. Its &quot;shuffle&quot; function is very close to applySwapList, and uses an ad hoc tree internally. Details with reference here: <a href=\"http://hackage.haskell.org/package/random-shuffle-0.0.4/docs/src/System-Random-Shuffle.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/random-shuffle-0.0.4/docs/src/&hellip;</a>"}], "tags": [], "owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "is_accepted": false, "score": 1, "last_activity_date": 1558223985, "creation_date": 1558223985, "answer_id": 56203759, "question_id": 33723097, "link": "https://stackoverflow.com/questions/33723097/random-numbers-in-haskell-and-shuffling-a-list/56203759#56203759", "title": "Random numbers in haskell. And shuffling a list", "body": "<p>You don\u2019t really need the IO monad to generate random numbers, as you can create a random number generator by supplying a seed to function mkStdGen which is part of the System.Random module. And that way, your computation is reproducible, just by providing the same seed.</p>\n\n<pre><code>Import System.Random\nlet rg1     = mkStdGen seed\nlet randils = randoms rg1 :: [Double] -- infinite list of random values\n</code></pre>\n\n<p>According to the Rosetta web site, the core of the Knuth algorithm goes like this, with N permutable items numbered from 0 to N-1:\n<a href=\"https://www.rosettacode.org/wiki/Knuth_shuffle\" rel=\"nofollow noreferrer\">https://www.rosettacode.org/wiki/Knuth_shuffle</a></p>\n\n<pre><code>for i from (N-1) down to 1  do:\n    let j = random integer in range 0 &lt;=j &lt;=i\n    swap items[i] with items[j]\n</code></pre>\n\n<p>So this being Functional Programming, we have a slight problem with the mutable array.\nThere are two Haskell sample codes on Rosetta. The first one just uses random access into ordinary Haskell lists, thus accepting poor efficiency. The second one uses monadic stuff with the Data.Sequence module.</p>\n\n<p>A possible compromise is the code below, which generates a random list of swap operations prior to applying them, using a fold, to a regular Data.Map asssociative array.</p>\n\n<p>The critical function is randomPerm which takes a list of random Double values as its main parameter.</p>\n\n<p>The simplistic main function generates just one sample. On my system, the output is \u00ab\u00a0[5,2,8,3,0,4,6,1,7]\u00a0\u00bb. You can generalize and get an unlimited supply of random permutations with an expression such as\u00a0: \n\u00ab\u00a0L.map  (randomPerm itemCount)  (chunksOf (itemCount-1)\u00a0 randils)\u00bb</p>\n\n<pre><code>    -- Haskell code to generate random permutations of N items,\n    -- using language-provided random numbers generation facilities.\n\n    -- Knuth's shuffle  algorithm  for a zero-based array of size N:\n    -- https://www.rosettacode.org/wiki/Knuth_shuffle\n\n\nimport  Data.List as L\nimport  Data.Map  as M\nimport  System.Random\ntype MI = M.Map Int Int  -- auxiliary associative array type\n\n\n-- main loop of Knuth's algorithm:\nmakeSwapPairList :: Int -&gt; [Double] -&gt; [(Int,Int)]\nmakeSwapPairList itemCount rands = \n    let ls = reverse $ enumFromTo 1 (itemCount-1)\n    in  L.map makeSwapPair (zip ls rands)\n\nmakeSwapPair :: (Int,Double) -&gt; (Int,Int)\nmakeSwapPair (p, randX) = (p, floor ((fromIntegral (p+1))*randX))\n\n-- generates a map where integers below itemCount are identically mapped\nmakeTrivialMap :: Int -&gt; MI\nmakeTrivialMap itemCount = \n  let  ls1 = enumFromTo 0 (itemCount-1)\n  in   M.fromList (zip ls1 ls1)\n\n-- apply just one swap operation to an MI map:\napplySwap :: MI -&gt; (Int,Int) -&gt; MI\napplySwap ma p =\n    let (i,j)=p ; mi = ma ! i ; mj = ma ! j\n    in  M.insert i mj  (M.insert j mi ma)\n\n-- apply a list of swap operations to an MI map:\napplySwapList :: MI -&gt; [(Int,Int)] -&gt; MI\napplySwapList ma pl = L.foldl' applySwap ma pl\n\n-- returns a random permutation as a list of Int values:\nrandomPerm :: Int -&gt; [Double] -&gt; [Int]\nrandomPerm itemCount rands =\n    let ma0 = makeTrivialMap itemCount\n        ma1 = applySwapList ma0 (makeSwapPairList itemCount rands)\n        pls1 = M.toAscList ma1\n    in L.map snd pls1\n\n\n-- simplified main program, for just one random permutation \nmain =\n  do\n    let seed = 4242\n    let itemCount = 9  -- should become 52\n\n    -- random number generation in the [0,1( interval:\n    let rg1     = mkStdGen seed\n    let randils = randoms rg1 :: [Double] -- infinite list of random values\n    let rands1  = L.take (itemCount-1) randils -- just enough for one sample\n\n    let myRandomPerm = randomPerm itemCount -- function currying\n    let perm1 = myRandomPerm rands1\n    putStrLn (show perm1)\n</code></pre>\n"}], "owner": {"reputation": 383, "user_id": 4847170, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/dffff1120ce7fce426c128efc46bb125?s=128&d=identicon&r=PG&f=1", "display_name": "EasternDude", "link": "https://stackoverflow.com/users/4847170/easterndude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1256, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1558223985, "creation_date": 1447610824, "question_id": 33723097, "link": "https://stackoverflow.com/questions/33723097/random-numbers-in-haskell-and-shuffling-a-list", "title": "Random numbers in haskell. And shuffling a list", "body": "<p>i am trying to write a function that when given a list would return a lsit in random order. </p>\n\n<p>this is how i thought of doing it(the list is of length 52):\ngenerate random number between 1 and 52 take that element of the list. </p>\n\n<pre><code>a = [1,2,3..] !! getRandom 52\n</code></pre>\n\n<p>then recursively call same function.. generate random number between 1 and 51 and call on list with first element we picked removed. </p>\n\n<p><code>(delete a [1,2,3..]) !! getRandom 51</code></p>\n\n<p>And so on..after puting all elements picked in a list we get same list but shuffled. This is my random number function:</p>\n\n<pre><code>getRandom :: Int -&gt; IO Int\ngetRandom x = getStdRandom (randomR (1,x))\n</code></pre>\n\n<p>But because this function returns IO Int not Int I can't use it to take random element from a list. What can i do here? </p>\n\n<p>on a university task i need to shuffle a deck of 52 cards. We didn't trough Monads and advanced stuff yet. So, is there an easy way to take a list of 52 cards and shuffle it?</p>\n"}, {"tags": ["haskell", "testing"], "comments": [{"owner": {"reputation": 10140, "user_id": 763029, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/TVwEa.jpg?s=128&g=1", "display_name": "Caffeinated", "link": "https://stackoverflow.com/users/763029/caffeinated"}, "edited": false, "score": 0, "creation_date": 1447609155, "post_id": 33722740, "comment_id": 55215154, "body": "can u show the error ?"}, {"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 0, "creation_date": 1447613404, "post_id": 33722740, "comment_id": 55216560, "body": "I highly recommend starting with e.g. <a href=\"http://learnyouahaskell.com\" rel=\"nofollow noreferrer\">learnyouahaskell.com</a>"}, {"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "edited": false, "score": 0, "creation_date": 1447617468, "post_id": 33722740, "comment_id": 55218017, "body": "yes, I know that putStrLn is of type string -&gt; IO() and is hence not compatible with a return type &quot;arbre&quot;; but I&#39; m wondering why the last expression in the code is not the only which matters for tyhe return value of a block of code. but maybe this information is also in the book you told me about... maybe I will have a look. thanks"}, {"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "edited": false, "score": 0, "creation_date": 1447726290, "post_id": 33722740, "comment_id": 55264259, "body": "Nobody has an answer ? The lack of an efficient graphical debugger should make people  turn to manually print values yet..."}, {"owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "edited": false, "score": 0, "creation_date": 1447868288, "post_id": 33722740, "comment_id": 55340283, "body": "@lolveley For debugging purposes, you can use <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Debug-Trace.html#v:trace\" rel=\"nofollow noreferrer\"><code>trace</code></a> from the <code>Debug.Trace</code> module."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 0, "last_activity_date": 1447609479, "creation_date": 1447609479, "answer_id": 33722853, "question_id": 33722740, "link": "https://stackoverflow.com/questions/33722740/how-to-insert-test-code/33722853#33722853", "title": "How to insert test code", "body": "<pre><code>peuple i =\n  do putStrLn $ \"entering peuple \" ++ i\n  let parcours = ...\n</code></pre>\n\n<p>should be</p>\n\n<pre><code>peuple i =\n  do putStrLn $ \"entering peuple \" ++ i\n     let parcours = ...\n</code></pre>\n\n<p>since indentation matters.</p>\n"}, {"comments": [{"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "edited": false, "score": 0, "creation_date": 1447861176, "post_id": 33773178, "comment_id": 55335177, "body": "Thanks, it&#39;s clear now. I learned a bit of scala before and was hence confused, scala being very permissive for side effects."}], "tags": [], "owner": {"reputation": 1178, "user_id": 1667161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233658d12fabd9d72b04d0a6916f6389?s=128&d=identicon&r=PG", "display_name": "liminalisht", "link": "https://stackoverflow.com/users/1667161/liminalisht"}, "is_accepted": true, "score": 1, "last_activity_date": 1447828041, "creation_date": 1447828041, "answer_id": 33773178, "question_id": 33722740, "link": "https://stackoverflow.com/questions/33722740/how-to-insert-test-code/33773178#33773178", "title": "How to insert test code", "body": "<p>Haskell is a pure language in the sense that functions in Haskell are referentially transparent. Look at the type of <code>peuple</code>:</p>\n\n<pre><code>peuple :: Int -&gt; Arbre\n</code></pre>\n\n<p>A user (or other code) invoking this function should expect to give the function an <code>Int</code>, and get back an <code>Arbre</code>. We don't expect it to do anything else. Now what you seem to want is for an effect (or effects) to occur in this function: you want to print values to the console. Where in the type signature would you be able to tell that this function performs some sort of effect? You wouldn't. That's a no-no in Haskell. </p>\n\n<p>Haskell allows us to perform effects as long as referential transparency is preserved. Printing something to the console will involve the use of the <code>IO</code> monad. But the <code>IO</code> monad is \"one way\": once you have an <code>IO a</code>, you can't just extract the <code>a</code> and ditch the <code>IO</code> container, so that the type of the function mentions nothing of the <code>IO</code> monad. If you could, then you'd have written a function that performs effects but doesn't let on that it does so. So you'll have to write a function that returns an <code>IO Arbre</code> if you want the function to represent a computation that returns an <code>Arbre</code>, but that performs some effects like printing to the console.</p>\n\n<p>I second <code>mb21</code>'s suggestion to check out LYAH or another intro book that explains monads, and the <code>IO</code> monad in particular.</p>\n\n<p>More to the point, referential transparency is the main reason that throwing <code>print ...</code> into your code is not an option in Haskell. If you want to debug code, you could use the GHCI debugger. If you want to test code, maybe use a tool like QuickCheck. Or look for other tools for debugging and testing code. But spending time learning about monads is the key here.</p>\n"}], "owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 33773178, "answer_count": 2, "score": 0, "last_activity_date": 1475634782, "creation_date": 1447608950, "last_edit_date": 1475634782, "question_id": 33722740, "link": "https://stackoverflow.com/questions/33722740/how-to-insert-test-code", "title": "How to insert test code", "body": "<p>How can I add some testing code inside my functions?</p>\n\n<p>e.g. I tried to change:</p>\n\n<pre><code>peuple i =\n  let parcours = ...\n</code></pre>\n\n<p>by:</p>\n\n<pre><code>peuple i =\n  do putStrLn $ \"entering peuple \" ++ i\n  let parcours = ...\n</code></pre>\n\n<p>but I get a parse error.</p>\n\n<p>EDIT</p>\n\n<p>I tried with this code :</p>\n\n<pre><code>peuple :: Int -&gt; Arbre\npeuple 1 = Feuille\npeuple i =\n  do\n    print (\"entering peuple \" ++ show i)\n    ...\n</code></pre>\n\n<p>but ghc complains the method should return a \"Arbre\" and not an \"IO\" sth.</p>\n\n<p>And more generally it is possible, e.g. in scala, to replace a code by a block {..;a} and in this case, the block will be evaluated as \"a\". Is it possible in Haskell?</p>\n"}, {"tags": ["haskell", "algebraic-data-types", "pattern-synonyms"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 4, "last_activity_date": 1447608996, "last_edit_date": 1447608996, "creation_date": 1447608564, "answer_id": 33722653, "question_id": 33722381, "link": "https://stackoverflow.com/questions/33722381/pattern-matching-on-a-private-data-constructor/33722653#33722653", "title": "Pattern matching on a private data constructor", "body": "<p>This looks as a use case for <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/syntax-extns.html#pattern-synonyms\" rel=\"nofollow\">pattern synonyms</a>.</p>\n\n<p>Basically you don't export the real constructor, but only a \"smart\" one</p>\n\n<pre><code>{-# LANGUAGE PatternSynonyms #-}\nmodule M(T(), SmartCons, smartCons) where\n\ndata T = RealCons Int\n\n-- the users will construct T using this\nsmartCons :: Int -&gt; T\nsmartCons n = if even n then RealCons n else error \"wrong!\"\n\n-- ... and destruct T using this\npattern SmartCons n &lt;- RealCons n\n</code></pre>\n\n<p>Another module importing <code>M</code> can then use</p>\n\n<pre><code>case someTvalue of\n   SmartCons n -&gt; use n\n</code></pre>\n\n<p>and e.g.</p>\n\n<pre><code>let value = smartCons 23 in ...\n</code></pre>\n\n<p>but can not use the <code>RealCons</code> directly.</p>\n\n<hr>\n\n<p>If you prefer to stay in basic Haskell, without extensions, you can use a \"view type\"</p>\n\n<pre><code>module M(T(), smartCons, Tview(..), toView) where\ndata T = RealCons Int\n-- the users will construct T using this\nsmartCons :: Int -&gt; T\nsmartCons n = if even n then RealCons n else error \"wrong!\"\n\n-- ... and destruct T using this\ndata Tview = Tview Int\ntoView :: T -&gt; Tview\ntoView (RealCons n) = Tview n\n</code></pre>\n\n<p>Here, users have full access to the view type, which can be constructed/destructed freely, but have only a restricted start constructor for the actual type <code>T</code>. Destructing the actual type <code>T</code> is possible by moving to the view type</p>\n\n<pre><code>case toView someTvalue of\n  Tview n -&gt; use n\n</code></pre>\n\n<p>For nested patterns, things become more cumbersome, unless you enable other extensions such as <code>ViewPatterns</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 11, "last_activity_date": 1447609047, "last_edit_date": 1447609047, "creation_date": 1447608679, "answer_id": 33722679, "question_id": 33722381, "link": "https://stackoverflow.com/questions/33722381/pattern-matching-on-a-private-data-constructor/33722679#33722679", "title": "Pattern matching on a private data constructor", "body": "<p>You can define constructor pattern synonyms. This lets you use the same name for smart construction and \"dumb\" pattern matching.</p>\n\n<pre><code>{-# LANGUAGE PatternSynonyms #-}\n\nmodule GridAxis (GridAxis, pattern RegularAxis, pattern IrregularAxis) where\nimport Data.List\n\ndata GridAxis = RegularAxis_ (Float, Float) Float -- (min, max) delta\n              | IrregularAxis_ [Float]            -- [xs]\n\n-- The line with \"&lt;-\" defines the matching behavior\n-- The line with \"=\" defines the constructor behavior\npattern RegularAxis minmax delta &lt;- RegularAxis_ minmax delta where\n  RegularAxis (a, b) dx = RegularAxis_ (min a b, max a b) (abs dx)\n\npattern IrregularAxis xs &lt;- IrregularAxis_ xs where\n  IrregularAxis xs = IrregularAxis_ (sort xs)\n</code></pre>\n\n<p>Now you can do:</p>\n\n<pre><code>module Foo\nimport GridAxis\n\nfoo :: GridAxis -&gt; a\nfoo (RegularAxis (a, b) d) = ...\nfoo (IrregularAxis xs) = ...\n</code></pre>\n\n<p>And also use <code>RegularAxis</code> and <code>IrregularAxis</code> as smart constructors. </p>\n"}], "owner": {"reputation": 2471, "user_id": 1447225, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/8daac16747c58e2c892e1a398919295c?s=128&d=identicon&r=PG", "display_name": "firegurafiku", "link": "https://stackoverflow.com/users/1447225/firegurafiku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 513, "favorite_count": 3, "accepted_answer_id": 33722679, "answer_count": 2, "score": 8, "last_activity_date": 1452954630, "creation_date": 1447607175, "last_edit_date": 1452954630, "question_id": 33722381, "link": "https://stackoverflow.com/questions/33722381/pattern-matching-on-a-private-data-constructor", "title": "Pattern matching on a private data constructor", "body": "<p>I'm writing a simple ADT for grid axis. In my application grid may be either regular (with constant step between coordinates), or irregular (otherwise). Of course, the regular grid is just a special case of irregular one, but it may worth to differentiate between them in some situations (for example, to perform some optimizations). So, I declare my ADT as the following:</p>\n\n<pre><code>data GridAxis = RegularAxis (Float, Float) Float -- (min, max) delta\n              | IrregularAxis [Float]            -- [xs]\n</code></pre>\n\n<p>But I don't want user to create malformed axes with <code>max &lt; min</code> or with unordered <code>xs</code> list. So, I add <a href=\"https://wiki.haskell.org/Smart_constructors#Smart.28er.29_constructors\" rel=\"noreferrer\">\"smarter\" construction functions</a> which perform some basic checks:</p>\n\n<pre><code>regularAxis :: (Float, Float) -&gt; Float -&gt; GridAxis\nregularAxis (a, b) dx = RegularAxis (min a b, max a b) (abs dx)\n\nirregularAxis :: [Float] -&gt; GridAxis\nirregularAxis xs = IrregularAxis (sort xs)\n</code></pre>\n\n<p>I don't want user to create grids directly, so I don't add <code>GridAxis</code> data constructors into module export list:</p>\n\n<pre><code>module GridAxis (\n    GridAxis,\n    regularAxis,\n    irregularAxis,\n    ) where\n</code></pre>\n\n<p>But it turned out that after having this done I cannot use pattern matching on <code>GridAxis</code> anymore. Trying to use it</p>\n\n<pre><code>import qualified GridAxis as GA\n\ntest :: GA.GridAxis -&gt; Bool\ntest axis = case axis of\n              GA.RegularAxis -&gt; True\n              GA.IrregularAxis -&gt; False  \n</code></pre>\n\n<p>gives the following compiler error:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>src/Physics/ImplicitEMC.hs:7:15:\n    Not in scope: data constructor `GA.RegularAxis'\n\nsrc/Physics/ImplicitEMC.hs:8:15:\n    Not in scope: data constructor `GA.IrregularAxis'\n</code></pre>\n\n<p>Is there something to work this around?</p>\n"}, {"tags": ["haskell", "time-complexity"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1447607811, "post_id": 33722292, "comment_id": 55214613, "body": "Yes, those operations are constant time (in a model that ignores caching effects, GC costs, etc.) I don&#39;t understand what you are seeing in your benchmarks."}, {"owner": {"reputation": 6788, "user_id": 1748754, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jjk7p.jpg?s=128&g=1", "display_name": "erewok", "link": "https://stackoverflow.com/users/1748754/erewok"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1447609499, "post_id": 33722292, "comment_id": 55215290, "body": "Ah. Thanks for the comment. I actually ran the microbenchmark a numbe of times using both <code>nfIO</code> and <code>whnfIO</code> (because I couldn&#39;t figure out which one to use) and in each case the difference remained. One interesting thing, though, as the input size increased, the &quot;outlying measurements&quot; had a greater effect, to a point where it was like 70% when input size was 1 million."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1447630361, "post_id": 33722292, "comment_id": 55222029, "body": "I realized my second sentence will probably be misinterpreted. What I meant was: what do you see in your results, that you are trying to explain? Is it that <code>conduit</code> is 1% slower than <code>conduitV</code> for 10000 elements, but 2% slower for 100000 elements? That hardly seems to suggest, well, anything, but could easily be explained by extra GC work when there are more elements."}, {"owner": {"reputation": 6788, "user_id": 1748754, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jjk7p.jpg?s=128&g=1", "display_name": "erewok", "link": "https://stackoverflow.com/users/1748754/erewok"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1447632435, "post_id": 33722292, "comment_id": 55222564, "body": "Well, it did appear that multiplying the input size by ten also multiplied the run-time difference by ten, which seemed to confirm the difference existed, which confused me because I thought they should be the same. (Not included are other inputs with different input sizes)"}], "answers": [{"comments": [{"owner": {"reputation": 6788, "user_id": 1748754, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jjk7p.jpg?s=128&g=1", "display_name": "erewok", "link": "https://stackoverflow.com/users/1748754/erewok"}, "edited": false, "score": 0, "creation_date": 1447609766, "post_id": 33722549, "comment_id": 55215375, "body": "That may explain the difference, actually. I also realize now that I ran the benchmark in a &quot;not-so-clean&quot; state on my machine (things possibly happening in the background). I wonder if that could also color the results somehow? Strange that the difference was consistent across multiple runs. I appreciate the feedback, though, because I was doubting my math and it really seemed very simple to calculate in this case, so I was going a little crazy."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1447609654, "last_edit_date": 1447609654, "creation_date": 1447608029, "answer_id": 33722549, "question_id": 33722292, "link": "https://stackoverflow.com/questions/33722292/time-complexity-for-index-and-drop-of-first-item-in-data-sequence/33722549#33722549", "title": "Time Complexity for index and drop of first item in Data.Sequence", "body": "<p>What you suggest looks correct to me.</p>\n\n<p>As a minor caveat remember that these are <em>amortized</em> complexity bounds, so a single operation could require more than constant time, but a long chain of operations will only require a constant times the number of the chain.</p>\n\n<p>If you use criterion to benchmark and \"reset\" the state at every computation, you might see non-constant time costs, because the \"reset\" is preventing the amortization. It really depends on how you perform the test. If you start from a sequence an perform a long chain of operations on that, it should be OK. If you repeat many times a single operation using the same operands, then it could be not OK.</p>\n\n<p>Further, I guess bounds such as <code>O(log(...))</code> should actually be read as <code>O(log(1 + ...))</code> -- you can't realistically have <code>O(log(1)) = O(0)</code> or, worse <code>O(log(0))= O(-inf)</code> as a complexity bound.</p>\n"}], "owner": {"reputation": 6788, "user_id": 1748754, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jjk7p.jpg?s=128&g=1", "display_name": "erewok", "link": "https://stackoverflow.com/users/1748754/erewok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 33722549, "answer_count": 1, "score": 1, "last_activity_date": 1447609654, "creation_date": 1447606732, "last_edit_date": 1592644375, "question_id": 33722292, "link": "https://stackoverflow.com/questions/33722292/time-complexity-for-index-and-drop-of-first-item-in-data-sequence", "title": "Time Complexity for index and drop of first item in Data.Sequence", "body": "<p>I was recently working on an implementation of <a href=\"https://gist.github.com/pellagic-puffbomb/9239cb57834789886f5c\" rel=\"nofollow noreferrer\">calculating moving average from a stream of input</a>, using <code>Data.Sequence</code>. I figured I could get the whole operation to be O(n) by using a deque.</p>\n<p>My first attempt was (in my opinion) a bit more straightforward to read, but not a true a deque. It looked like:</p>\n<pre><code>  let newsequence = (|&gt;) sequence n\n  ...\n  let dropFrontTotal = fromIntegral (newtotal - index newsequence 0)\n  let newsequence' = drop 1 newsequence. \n  ...\n</code></pre>\n<p>According to the <a href=\"https://hackage.haskell.org/package/containers-0.5.6.3/docs/Data-Sequence.html#g:11\" rel=\"nofollow noreferrer\">hackage docs</a> for <code>Data.Sequence</code>, <code>index</code> should take <em>O(log(min(i,n-i)))</em> while <code>drop</code> should also take <em>O(log(min(i,n-i)))</em>.</p>\n<p><strong>Here's my question:</strong></p>\n<p>If I do <code>drop 1 someSequence</code>, doesn't this mean a time complexity of <em>O(log(min(1, (length someSequence))))</em>, which in this case means: <em>O(log(1))</em>?</p>\n<p>If so, isn't <em>O(log(1))</em> <em>effectively</em> constant?</p>\n<p>I had the same question for <code>index someSequence 0</code>: shouldn't that operation end up being <em>O(log(0))</em>?</p>\n<p>Ultimately, I had enough doubts about my understanding that I resorted to using <code>Criterion</code> to benchmark the two implementations to prove that the <code>index/drop</code> version is slower (and the amount it's slower by grows with the input). The informal results on my machine can be seen at the linked gist.</p>\n<p>I still don't really understand how to calculate time complexity for these operations, though, and I would appreciate any clarification anyone can provide.</p>\n"}, {"tags": ["algorithm", "haskell", "data-structures", "parallel-processing", "addition"], "comments": [{"owner": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "edited": false, "score": 1, "creation_date": 1447607190, "post_id": 33722100, "comment_id": 55214375, "body": "&quot;binary&quot; IS a representation, and it has the problem you mention -- the carry for each bit depends on all the lower-order bits.  So it&#39;s difficult to figure out what you want.  A way to add binary numbers with more parallelism (like carry-lookahead adder), or a non-binary representation (like CRT representation) that lets you do addition (and multiplication) in parallel"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 36328, "user_id": 5483526, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec50563f80bacd2a7fed69bd31d0c810?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Timmermans", "link": "https://stackoverflow.com/users/5483526/matt-timmermans"}, "edited": false, "score": 0, "creation_date": 1447607317, "post_id": 33722100, "comment_id": 55214429, "body": "@MattTimmermans that is a valid objection, I have edited the question. I hope it make more sense now."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1447607691, "post_id": 33722100, "comment_id": 55214575, "body": "I second carry-lookahead adders as a way to improve parallelism. There&#39;s also a related probabilistic approach: if you sum two bit strings with an initial carry <code>a+b+carry1 = result + carry2</code> you can compute <code>carry2</code> without looking at <code>carry1</code> in the vast majority of cases, i.e. in all cases where <code>map not a &#47;= b</code>. So you can produce the output carry in advance and start adding the next bit block without waiting for the previous carry (in most cases)."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1447609075, "post_id": 33722100, "comment_id": 55215123, "body": "&quot;can be done in parallel&quot; is pretty vague, do you have a specific notion in mind?"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1447610878, "post_id": 33722100, "comment_id": 55215766, "body": "I&#39;m thinking in some kind of tree representation like <code>data Nat = Bin Nat Nat |  Zero | One</code>, with a mapping to natural numbers, and on which <code>add : Nat \u2192 Nat \u2192 Nat</code> can be implemented in parallel because two branches can be added independently. <code>add (Bin l r) = _ l _ r _; add Zero = _; add One = _;</code>... something on those lines is what I have in mind."}], "answers": [{"comments": [{"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1447610356, "post_id": 33722815, "comment_id": 55215575, "body": "Great answer. That shows it is possible. Now all is left is translating the technique to ADTs. My naive <code>Bin</code> definition can&#39;t be parallelized with this strategy since you can&#39;t read the <code>nth</code> bit of <code>Bin</code> in parallel (like you can with a machine bit-vector). I believe some kind of clever binary tree representation could make it work."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1447610439, "post_id": 33722815, "comment_id": 55215607, "body": "(Why did you remove <a href=\"http://www.cs.umd.edu/class/sum2003/cmsc311/Notes/Comb/lookahead.html\" rel=\"nofollow noreferrer\">this link</a>?)"}, {"owner": {"reputation": 17971, "user_id": 171006, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/unCkx.jpg?s=128&g=1", "display_name": "Lior Kogan", "link": "https://stackoverflow.com/users/171006/lior-kogan"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1447610748, "post_id": 33722815, "comment_id": 55215728, "body": "@Viclib: Simply because there are so many excellent links and this is just one of them."}], "tags": [], "owner": {"reputation": 17971, "user_id": 171006, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/unCkx.jpg?s=128&g=1", "display_name": "Lior Kogan", "link": "https://stackoverflow.com/users/171006/lior-kogan"}, "is_accepted": false, "score": 4, "last_activity_date": 1447609796, "last_edit_date": 1447609796, "creation_date": 1447609305, "answer_id": 33722815, "question_id": 33722100, "link": "https://stackoverflow.com/questions/33722100/is-there-any-algebraic-representation-of-natural-numbers-that-allow-for-parallel/33722815#33722815", "title": "Is there any algebraic representation of natural numbers that allow for parallel addition?", "body": "<p>There are many parallel adder architectures. An excellent review is given in <a href=\"https://repositories.lib.utexas.edu/handle/2152/13960\" rel=\"nofollow\">Thomas Walker Lynch's master's thesis at the university of Texas at Austin, 1996</a>. See section 9.1, where he summarizes the worst case path length. </p>\n\n<p>The <em>Lynch and Swartzlander adder (L&amp;S)</em> has a worst case path length of 2*ceil(log4(N))+2, where N is that number of bits. The architecture is presented in their paper <em><a href=\"http://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=156535\" rel=\"nofollow\">A Spanning Tree Carry Lookahead Adder</a></em>.</p>\n\n<p>You can find excellent explanations about many simple architectures by googling \"fast adder\".</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1447630512, "post_id": 33726336, "comment_id": 55222079, "body": "These might just be called redundant binary numbers. I&#39;m not sure."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1447630566, "post_id": 33726336, "comment_id": 55222099, "body": "Yes, that&#39;s it! Thanks."}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": false, "score": 1, "last_activity_date": 1447629854, "creation_date": 1447629854, "answer_id": 33726336, "question_id": 33722100, "link": "https://stackoverflow.com/questions/33722100/is-there-any-algebraic-representation-of-natural-numbers-that-allow-for-parallel/33726336#33726336", "title": "Is there any algebraic representation of natural numbers that allow for parallel addition?", "body": "<p>You didn't say that each natural number has to have a unique representation. So, here is another option. (I didn't invent it, but I can't remember what it's called, so I had to reconstruct how it works.)</p>\n\n<p>Represent numbers as strings of digits in base 2 like in binary, except that rather than being restricted to the digits 0 and 1, we are additionally allowed to use the digit 2. So for example, the number 2 has two representations, 10 and 2.</p>\n\n<p>To add two numbers represented in this way, just add them digitwise without carrying. Clearly we can do this efficiently in parallel (with a linear size, constant depth circuit). Well, now we have a problem: the resulting number has the right base-2 value, but its digits won't necessarily be 0, 1 or 2, but might be as large as 4.</p>\n\n<p>So let's fix that with the following carry propagation pass: Write each digit of the result as a two-digit binary number where the second digit is 0 or 1, and the first digit can be 0, 1 or 2. (So 0 -> 00, 1 -> 01, 2 -> 10, 3 -> 11, 4 -> 20.) Now \"carry\" the first digit of each these two-digit numbers to the left, leaving behind the second digit, but without performing any other carrying on the result. For example, if we started with the number</p>\n\n<pre><code> 314102    (perhaps from the original problem of computing 212001 + 102101)\n</code></pre>\n\n<p>we perform the sum</p>\n\n<pre><code>11       = 3\n 01      = 1\n  20     = 4\n   01    = 1\n    00   = 0\n     10  = 2\n-------\n1130110\n</code></pre>\n\n<p>The new number has the same base-2 value, and its digits are now in the range 0 to 3, since they are formed from the sum of a digit that was 0, 1 or 2 and a digit that was 0 or 1. Moreover each digit of the result only depends on the corresponding digit and the digit to its right in the number from the step, so this is implementable by another linear size, constant depth circuit.</p>\n\n<p>This isn't quite good enough, so let's do the same carry propagation pass one more time. Now, 4 is no longer a possible input digit, so the digit that we carry can never be 2, only 0 or 1. So this time the procedure will result in a base 2 representation that uses only the digits 0, 1 and 2, which was what we wanted. In the example from above, the result will be <code>1210110</code>. (Of course, any other representation with the same base-2 value would be correct as well.)</p>\n\n<p>(For other combinations of base and maximum digit, you might only need one carry propagation pass. For example if you represent numbers in base 3 using the digits 0, 1, 2, 3 and 4, the largest digit appearing in a sum is 8, so both digits involved in the carry propagation pass will be in the range 0, 1, 2 and their sum will already be at most 4.)</p>\n\n<hr>\n\n<p>Now if you want to do other operations on this representation, such as comparing two numbers for equality, one option is to convert to binary, either serially in linear time, or in parallel by using a fast adder as described in Lior Kogan's answer. In fact, converting this representation to binary is essentially equivalent to the problem of adding numbers in binary, since we can consider a representation like <code>212001</code> as a \"formal addition\" <code>101000 + 111001</code>. However, you probably cannot test for equality in this representation in constant depth like you can for binary. I imagine that the \"hardness\" in this sense of either addition or equality testing is essential given your other constraints, though I don't know for sure.</p>\n"}, {"tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": false, "score": 0, "last_activity_date": 1448203919, "creation_date": 1448203919, "answer_id": 33856096, "question_id": 33722100, "link": "https://stackoverflow.com/questions/33722100/is-there-any-algebraic-representation-of-natural-numbers-that-allow-for-parallel/33856096#33856096", "title": "Is there any algebraic representation of natural numbers that allow for parallel addition?", "body": "<p>One simple way how to describe parallel addition of natural numbers is this: If you look at the <a href=\"https://en.wikipedia.org/wiki/Adder_(electronics)#Full_adder\" rel=\"nofollow\">full adder circuit</a>, it has 3 input bits and it outputs a 2-bit number saying how many of the input bits were 1.\nThis is also why it's sometimes called <a href=\"https://en.wikipedia.org/wiki/Adder_(electronics)#3:2_compressors\" rel=\"nofollow\">3:2 compressor</a>. From them we can create a circuit that adds 3 binary numbers in parallel to produce 2 binary numbers. This is also called a <a href=\"https://en.wikipedia.org/wiki/Carry-save_adder\" rel=\"nofollow\">carry-save adder</a> circuit, because instead of propagating the carry bits, we keep them as another, separate number. Each number is then (redundantly) represented as a pair of binary numbers. And when adding <em>k</em> natural numbers, at each step we can reduce triplets to tuples, requiring only <em>O(log k)</em> time steps.</p>\n\n<p>But the problem is that if we're only restricted to ADTs, we have a fixed set of constructors, each constructor having a finite number of records. So no matter what, the depth of such a structure will be <em>O(log n)</em>. And we have to perform <em>O(log n)</em> steps just to traverse the structure.</p>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 1, "answer_count": 3, "score": 5, "last_activity_date": 1448203919, "creation_date": 1447605469, "last_edit_date": 1495542619, "question_id": 33722100, "link": "https://stackoverflow.com/questions/33722100/is-there-any-algebraic-representation-of-natural-numbers-that-allow-for-parallel", "title": "Is there any algebraic representation of natural numbers that allow for parallel addition?", "body": "<p>Natural numbers can be represented in <strong>logarithmic space</strong> using a binary representation (here, in little-endian):</p>\n\n<pre><code>-- The type of binary numbers; little-endian; O = Zero, I = One\ndata Bin = O Bin | I Bin | End\n</code></pre>\n\n<p>Addition of <code>a</code> and <code>b</code> can then be implemented, for example, by calling the <code>successor</code> function (<a href=\"https://stackoverflow.com/questions/33257360/is-there-any-efficient-way-to-convert-an-unary-number-to-a-binary-number\"><code>O(log(N))</code></a>) <code>a</code> times on <code>b</code>. The problem with this implementation is that it is inherently sequential. In order to add 2 numbers, <code>suc</code> calls are chained in sequence. Other implementations of <code>add</code> (such as using carry) suffer from the same issue. It is easy to see that addition couldn't be implemented in parallel with that representation. <strong>Is there any representation of natural numbers, using algebraic datatypes, which takes logarithm space, and on which addition can be done in parallel?</strong></p>\n\n<p><em>Code for illustration:</em></p>\n\n<pre><code>-- The usual fold  \nfold :: Bin -&gt; (t -&gt; t) -&gt; (t -&gt; t) -&gt; t -&gt; t\nfold (O bin) zero one end = zero (fold bin zero one end)\nfold (I bin) zero one end = one (fold bin zero one end)\nfold E zero one end       = end\n\n-- Successor of `Bin` - `O(log(N))`\nsuc :: Bin -&gt; Bin\nsuc (O bin) = I bin\nsuc (I bin) = O (suc bin)\nsuc E       = E\n\n-- Calls a function `a` times\ntimes :: Bin -&gt; (t -&gt; t) -&gt; t -&gt; t\ntimes a f x     = fold a zero one end f where \n    one bin fs  = fs (bin (fs . fs))\n    zero bin fs = bin (fs . fs)\n    end fs      = x\n\n-- Adds 2 binary numbers\nadd :: Bin -&gt; Bin -&gt; Bin\nadd a b = (a `times` suc) b\n\n-- 1001 + 1000 = 0101\nmain = print $ add (I (O (O (I E)))) (I (O (O (O E))))\n</code></pre>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1447602423, "post_id": 33721533, "comment_id": 55212865, "body": "What do you mean by list generator?"}], "answers": [{"comments": [{"owner": {"reputation": 331, "user_id": 5231990, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/563abcb48f1195c34619244e9b662bc3?s=128&d=identicon&r=PG&f=1", "display_name": "Swift", "link": "https://stackoverflow.com/users/5231990/swift"}, "edited": false, "score": 0, "creation_date": 1447612107, "post_id": 33721593, "comment_id": 55216156, "body": "That is amazing &lt;3 . But don&#39;t you have to write <code>b (x:xs)</code> instead of <code>b xs</code>?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 331, "user_id": 5231990, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/563abcb48f1195c34619244e9b662bc3?s=128&d=identicon&r=PG&f=1", "display_name": "Swift", "link": "https://stackoverflow.com/users/5231990/swift"}, "edited": false, "score": 0, "creation_date": 1447613396, "post_id": 33721593, "comment_id": 55216556, "body": "no - if I&#39;d do this it would not work for empty lists (as this pattern would not match those) and I don&#39;t need to deconstruct the list here anyways (the list-comprehension does this for you)"}, {"owner": {"reputation": 331, "user_id": 5231990, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/563abcb48f1195c34619244e9b662bc3?s=128&d=identicon&r=PG&f=1", "display_name": "Swift", "link": "https://stackoverflow.com/users/5231990/swift"}, "edited": false, "score": 0, "creation_date": 1447633792, "post_id": 33721593, "comment_id": 55222895, "body": "Thank you! That helped a lot"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 5, "last_activity_date": 1447602517, "creation_date": 1447602517, "answer_id": 33721593, "question_id": 33721533, "link": "https://stackoverflow.com/questions/33721533/return-all-positions-of-a-certain-element-in-a-list-without-recursion-but-with/33721593#33721593", "title": "Return all positions of a certain element in a list without recursion, but with list generators", "body": "<p>I think you want something like that right?</p>\n\n<pre><code>allPositionsOf :: Eq a =&gt; a -&gt; [a] -&gt; [Int]\nallPositionsOf b xs = [ i | (i,x) &lt;- zip [0..] xs, x == b]\n\n\u03bb&gt; allPositionsOf 'b' \"dfbhjbd\"\n[2,5]\n</code></pre>\n\n<p>you almost got it already - the only I just added one further <em>trick</em>:</p>\n\n<p>I <code>zip</code> the list up with <code>[0,1,2,...]</code> to get indizes and elements side by side, pull out a <code>(index,element)</code> pair (here <code>(i,x)</code>), filter out everything where <code>x == b</code> and then finally return the indizes from the pairs</p>\n"}], "owner": {"reputation": 331, "user_id": 5231990, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/563abcb48f1195c34619244e9b662bc3?s=128&d=identicon&r=PG&f=1", "display_name": "Swift", "link": "https://stackoverflow.com/users/5231990/swift"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 412, "favorite_count": 0, "accepted_answer_id": 33721593, "answer_count": 1, "score": 2, "last_activity_date": 1447602517, "creation_date": 1447602195, "question_id": 33721533, "link": "https://stackoverflow.com/questions/33721533/return-all-positions-of-a-certain-element-in-a-list-without-recursion-but-with", "title": "Return all positions of a certain element in a list without recursion, but with list generators", "body": "<p>we are asked to write a function ourselves in Haskell that, when given a list and a certain element returns a new list, containing the ordered positions of that element in that list. </p>\n\n<p>I already tried that for a long time now, but the one I currently have still uses recursion, which the task says we are not supposed to use.</p>\n\n<pre><code>allPositionsOf :: (Eq a) =&gt; a -&gt; [a] -&gt; [Int]\nallPositionsOf e es = [i | i &lt;- [0 .. (length es - 1)], IsAtPos e es i]\n    where\n         isAtPos :: (Eq a) =&gt; a -&gt; [a] -&gt; Int -&gt; Bool\n         isAtPos e (x:xs) 0 \n                          |x == e    = True\n                          |otherwise = False\n         isAtPos e (x:xs) i   = findAtPosition xs e (i - 1)\n</code></pre>\n\n<p>I know there is the !! and other functions similar, but is it possible to just use list generators and keep it simpler ?</p>\n"}, {"tags": ["haskell", "build", "haskell-platform", "haskell-stack"], "comments": [{"owner": {"reputation": 1048, "user_id": 3038345, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7aa612bee94641b19649908ea1654a1b?s=128&d=identicon&r=PG&f=1", "display_name": "ximet", "link": "https://stackoverflow.com/users/3038345/ximet"}, "edited": false, "score": 0, "creation_date": 1447599799, "post_id": 33721143, "comment_id": 55212034, "body": "in .cabal using only space (not tab)"}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": true, "score": 4, "last_activity_date": 1457153206, "creation_date": 1457153206, "answer_id": 35810140, "question_id": 33721143, "link": "https://stackoverflow.com/questions/33721143/process-exited-with-code-exitfailure-1-after-build-project-haskell/35810140#35810140", "title": "Process exited with code: ExitFailure 1&quot; after build project Haskell", "body": "<p>Such errors may be due to an out of date package cache. <code>ghc-pkg recache</code> run at the command line may help. </p>\n\n<p>Failing that, executing <code>stack --no-system-ghc --install-ghc build</code> instead of the usual stack command line will just tell stack to not use the installed libs at all, which may also help.</p>\n"}], "owner": {"reputation": 1048, "user_id": 3038345, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/7aa612bee94641b19649908ea1654a1b?s=128&d=identicon&r=PG&f=1", "display_name": "ximet", "link": "https://stackoverflow.com/users/3038345/ximet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2666, "favorite_count": 0, "accepted_answer_id": 35810140, "answer_count": 1, "score": 4, "last_activity_date": 1457153206, "creation_date": 1447599757, "question_id": 33721143, "link": "https://stackoverflow.com/questions/33721143/process-exited-with-code-exitfailure-1-after-build-project-haskell", "title": "Process exited with code: ExitFailure 1&quot; after build project Haskell", "body": "<p>After connect to .cabal file some package(for example <code>text</code>) and after build project throw Exception: <code>Process exited with code: ExitFailure 1\"</code>.</p>\n\n<p>For building project, I'm using haskell-stack, command: <code>stack build</code> in terminal. (I'm using MacOS  Capitan)</p>\n\n<p>Some line .cabal file:</p>\n\n<pre><code>executable Real-exe\nhs-source-dirs:      app\nmain-is:             Main.hs\nghc-options:         -threaded -rtsopts -with-rtsopts=-N\nbuild-depends:       base\n                 , Real\n                 , text\ndefault-language:    Haskell2010\n</code></pre>\n\n<p>Without(text package) all working.</p>\n\n<p>Full Error:</p>\n\n<pre><code>\"Real-0.1.0.0: unregistering (dependencies changed)\n\nReal-0.1.0.0: configure\n\nConfiguring Real-0.1.0.0...\n\nReal-0.1.0.0: build\n\nPreprocessing library Real-0.1.0.0...\n\n[1 of 1] Compiling Lib ( src/Lib.hs, .stack-work/dist/x86_64-    osx/Cabal-1.22.4.0/build/Lib.o )\n\nIn-place registering Real-0.1.0.0...\n\nPreprocessing executable 'Real-exe' for Real-0.1.0.0...\n\n&lt;command line=\"\"&gt;: cannot satisfy -package-id text-1.2.1.3-  3718968f98d5614ccdc45c27d4e8b0a1\n\n(use -v for more information)\n\n-- While building package Real-0.1.0.0 using:\n\n/Users/ximet/.stack/setup-exe-cache/setup-Simple-Cabal-1.22.4.0-x86_64-osx-ghc-7.10.2 --builddir=.stack-work/dist/x86_64-osx/Cabal-1.22.4.0/ build lib:Real exe:Real-exe --ghc-options \" -ddump-hi -ddump-to-file\"\n\nProcess exited with code: ExitFailure 1\"\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 5476702, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/839932238d6b8b6e3f7f5f97cdb65b52?s=128&d=identicon&r=PG&f=1", "display_name": "letter", "link": "https://stackoverflow.com/users/5476702/letter"}, "edited": false, "score": 0, "creation_date": 1447605850, "post_id": 33720931, "comment_id": 55213951, "body": "Thank you. i do not quite understand how the filter is working. why do i get just the numbers and not e.g (1,g)?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 89, "user_id": 5476702, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/839932238d6b8b6e3f7f5f97cdb65b52?s=128&d=identicon&r=PG&f=1", "display_name": "letter", "link": "https://stackoverflow.com/users/5476702/letter"}, "edited": false, "score": 0, "creation_date": 1447610761, "post_id": 33720931, "comment_id": 55215735, "body": "this is not the filter - it&#39;s the very first function <code>map fst</code> - <code>fst</code> (for <i>first</i>) will give you the first part of a 2-tuple: <code>fst (x,y) = x</code> and <code>map</code> applies this function to all elements in the filtered list"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 89, "user_id": 5476702, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/839932238d6b8b6e3f7f5f97cdb65b52?s=128&d=identicon&r=PG&f=1", "display_name": "letter", "link": "https://stackoverflow.com/users/5476702/letter"}, "edited": false, "score": 0, "creation_date": 1447613333, "post_id": 33720931, "comment_id": 55216534, "body": "no need - it&#39;s not easy to see if you are not used to this style of writing down your stuff"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 0, "last_activity_date": 1447598885, "last_edit_date": 1447598885, "creation_date": 1447598469, "answer_id": 33720931, "question_id": 33720858, "link": "https://stackoverflow.com/questions/33720858/position-of-elements/33720931#33720931", "title": "Position of elements", "body": "<p>you've already seen the problem with <code>takeWhile</code> - I can understand why you tried this (after all you want to use <code>length</code>) but maybe you should try to find a solution where you don't have to use <code>length</code> in the first place.</p>\n\n<p>A good approach might be to keep track of the indizes while you traverse the input list and then look out for the elements equal to `b</p>\n\n<hr>\n\n<p>if you want to use recursion then you can go all the way:</p>\n\n<pre><code>index :: (Eq a, Num t) =&gt; a -&gt; [a] -&gt; [t]\nindex b xs = index' 1 xs\n  where\n    index' _ [] = []\n    index' i (x:xs)\n      | b == x = i : index' (i+1) xs\n      | otherwise = index' (i+1) xs\n</code></pre>\n\n<p>example</p>\n\n<pre><code>\u03bb&gt; index 'b' \"dfbhjbd\"\n[3,6]\n</code></pre>\n\n<p>as you can see I'm using a inner function here that takes care of the indizes and the recursion</p>\n\n<hr>\n\n<p>another approach would be to use <code>zip</code> to get pairs of indizes and elements and then use <code>filter</code> and <code>map</code> to get the results out:</p>\n\n<p>this corresponds to what you tried earlier</p>\n\n<pre><code>index :: (Eq a, Num t, Enum t) =&gt; a -&gt; [a] -&gt; [t]\nindex b xs =\n  map fst . filter ((== b) . snd) $ zip [1..] xs\n</code></pre>\n"}], "owner": {"reputation": 89, "user_id": 5476702, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/839932238d6b8b6e3f7f5f97cdb65b52?s=128&d=identicon&r=PG&f=1", "display_name": "letter", "link": "https://stackoverflow.com/users/5476702/letter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 33720931, "answer_count": 1, "score": 0, "last_activity_date": 1447598885, "creation_date": 1447598012, "question_id": 33720858, "link": "https://stackoverflow.com/questions/33720858/position-of-elements", "title": "Position of elements", "body": "<p>the function should give me the position of the searched elements. </p>\n\n<p>e. : index 'b' \"dfbhjbd\" -> [3,6]</p>\n\n<p>I've got so far:</p>\n\n<p>index b (x:xs) = length ( takeWhile ( /= b)  xs )</p>\n\n<p>but takeWhile will immediately stop after finding the matching elements. so following elements  will be left out.</p>\n\n<p>i tried something like this:</p>\n\n<pre><code>index b (x:xs) = length ( tak b  xs )\n where \n  tak b [] = []\n  tak b xs \n        | b /= x == x:tak b xs\n        | otherwise = [], tak b xs\n</code></pre>\n\n<p>Beside being unable to run the code because of parse error, it would not show the right results.\nany suggestions?</p>\n"}, {"tags": ["haskell", "hugs"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1447598225, "post_id": 33720732, "comment_id": 55211514, "body": "Which <code>ghc</code> are you using ? In 7.10.2, it doesn&#39;t give me stackoverflow. Also never used <code>foldl</code>, always use the strict version <code>foldl&#39;</code>"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 3, "creation_date": 1447598466, "post_id": 33720732, "comment_id": 55211603, "body": "@Sibi, &quot;ERROR - C stack overflow&quot; is an error message from hugs. That said I don&#39;t know why this question has the ghc tag, heh."}, {"owner": {"reputation": 2789, "user_id": 1101776, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/gM3dK.jpg?s=128&g=1", "display_name": "Balraj Singh", "link": "https://stackoverflow.com/users/1101776/balraj-singh"}, "edited": false, "score": 0, "creation_date": 1447598492, "post_id": 33720732, "comment_id": 55211613, "body": "Yes sorry I am using Hugs. This error is from that."}, {"owner": {"reputation": 2789, "user_id": 1101776, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/gM3dK.jpg?s=128&g=1", "display_name": "Balraj Singh", "link": "https://stackoverflow.com/users/1101776/balraj-singh"}, "edited": false, "score": 0, "creation_date": 1447598682, "post_id": 33720732, "comment_id": 55211661, "body": "Yes now i also observed that foldl and foldr are not giving error on using ghci from command prompt but the same is given in WinHugs. Is it very specific to WinHugs?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 5, "creation_date": 1447599108, "post_id": 33720732, "comment_id": 55211802, "body": "if you don&#39;t happen to be a student of FP101x (and probably even then) then my best advice would be to drop Hugs and use GHC instead (sorry)"}, {"owner": {"reputation": 2789, "user_id": 1101776, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/gM3dK.jpg?s=128&g=1", "display_name": "Balraj Singh", "link": "https://stackoverflow.com/users/1101776/balraj-singh"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1447608240, "post_id": 33720732, "comment_id": 55214792, "body": "Sure I will take your advice @Carsten. But could help which is the best book or tutorial to go through for Haskell and functional programming beginner? I am looking forward to take it as full time language and also I am currently into C# and XAML application development."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1447610907, "post_id": 33720732, "comment_id": 55215779, "body": "I really liked <a href=\"http://learnyouahaskell.com/\" rel=\"nofollow noreferrer\">LYAH</a> to begin with - although it sadly has no exercises - and if you are working with C# you might be interested in F# too (as you can make use of your .net knowledge while you can get used to functional thinking using a similar syntax to Haskell - although F# is not quite as powerful)"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1447621809, "post_id": 33720732, "comment_id": 55219536, "body": "@BalrajSingh be sure to check out the <a href=\"http://stackoverflow.com/tags/haskell/info\">info page for the <code>haskell</code> tag</a>"}], "owner": {"reputation": 2789, "user_id": 1101776, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/gM3dK.jpg?s=128&g=1", "display_name": "Balraj Singh", "link": "https://stackoverflow.com/users/1101776/balraj-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 504, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1447601754, "creation_date": 1447597326, "last_edit_date": 1447601754, "question_id": 33720732, "link": "https://stackoverflow.com/questions/33720732/factorial-program-using-foldr-and-foldl-gives-stackoverflow-and-not-with-product", "title": "factorial program using foldr and foldl gives stackoverflow and not with product function", "body": "<p>I created Factorial program using foldl and foldr as shown below. But when i try to find factorial of large number like 100000 it gives: <strong>ERROR - C stack overflow</strong></p>\n\n<p>Where as, if i use <strong>product</strong> function it gives me the result after long time.</p>\n\n<pre><code>foldl (*) 1 [1..100000] \nproduct [1..100000]\n</code></pre>\n\n<p>Why am i getting different behavior? I am new to Haskell hence trying to understand different concepts by writing program like these. </p>\n"}, {"tags": ["haskell", "keyboard", "read-eval-print-loop", "ghci", "haskeline"], "answers": [{"comments": [{"owner": {"reputation": 1622, "user_id": 1926094, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LFTLH.jpg?s=128&g=1", "display_name": "TorosFanny", "link": "https://stackoverflow.com/users/1926094/torosfanny"}, "edited": false, "score": 0, "creation_date": 1447653168, "post_id": 33727632, "comment_id": 55227582, "body": "Thank you for your reply."}], "tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": true, "score": 2, "last_activity_date": 1447640837, "creation_date": 1447640837, "answer_id": 33727632, "question_id": 33720430, "link": "https://stackoverflow.com/questions/33720430/how-to-write-haskeline-so-that-ghci-or-haskeline-can-behave-properly-on-home/33727632#33727632", "title": "How to write ~/.haskeline so that ghci or haskeline can behave properly on `home` and `end`", "body": "<p>This <em>should</em> work by default. Most likely Haskeline isn't recognizing whatever your keyboard sends as the <code>home</code> and <code>end</code> keys. This depends on your OS and terminal setup.</p>\n\n<p>You might want to adjust your <code>$TERM</code> setting to something that supports those keys, after which <code>Haskeline</code> <em>should</em> pick them up automatically.</p>\n\n<p>Otherwise, the <a href=\"http://trac.haskell.org/haskeline/wiki/CustomKeyBindings#Control-leftright\" rel=\"nofollow\">Haskeline trac wiki</a> has a recipe for getting it to recognize unknown key sequences, which should work on POSIX systems (not on Windows, where <code>home</code> and <code>end</code> should also already be working by default). Adapting this to the current case:</p>\n\n<pre><code>$ ghc -e getLine\n&lt;press home, then return&gt;...some noise here...\n\"...haskell string for home...\"\n$ ghc -e getLine\n&lt;press end, then return&gt;...some other noise...\n\"...haskell string for end...\"\n</code></pre>\n\n<p>Add the corresponding lines to <code>~/.haskeline</code>:</p>\n\n<pre><code>keyseq: your-terminal \"...haskell string for home...\" home\nkeyseq: your-terminal \"...haskell string for end...\" end\n</code></pre>\n\n<p>where <code>your-terminal</code> is whatever's in your <code>$TERM</code> variable.</p>\n"}, {"tags": [], "owner": {"reputation": 1622, "user_id": 1926094, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LFTLH.jpg?s=128&g=1", "display_name": "TorosFanny", "link": "https://stackoverflow.com/users/1926094/torosfanny"}, "is_accepted": false, "score": 0, "last_activity_date": 1447653136, "creation_date": 1447653136, "answer_id": 33729249, "question_id": 33720430, "link": "https://stackoverflow.com/questions/33720430/how-to-write-haskeline-so-that-ghci-or-haskeline-can-behave-properly-on-home/33729249#33729249", "title": "How to write ~/.haskeline so that ghci or haskeline can behave properly on `home` and `end`", "body": "<p>I currently don't know much about <code>Most likely Haskeline isn't recognizing whatever your keyboard sends as the home and end keys. This depends on your OS and terminal setup.</code> I learned that for the first time today.</p>\n\n<p>But I successfully wrote a <code>~/.haskeline</code> adapted to my laptop(Ubuntu 14.04, ghc-7.10.2).</p>\n\n<pre><code>keyseq: \"\\ESCOH\" home\nkeyseq: \"\\ESCOF\" end\n</code></pre>\n"}], "owner": {"reputation": 1622, "user_id": 1926094, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/LFTLH.jpg?s=128&g=1", "display_name": "TorosFanny", "link": "https://stackoverflow.com/users/1926094/torosfanny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 310, "favorite_count": 1, "accepted_answer_id": 33727632, "answer_count": 2, "score": 1, "last_activity_date": 1447653136, "creation_date": 1447595361, "question_id": 33720430, "link": "https://stackoverflow.com/questions/33720430/how-to-write-haskeline-so-that-ghci-or-haskeline-can-behave-properly-on-home", "title": "How to write ~/.haskeline so that ghci or haskeline can behave properly on `home` and `end`", "body": "<p>My question is how to make my <code>ghci</code> react properly on my <code>home</code> and <code>end</code> press.</p>\n\n<p>I learned that <code>ghci</code> use <code>haskeline</code> to react to user input, and <code>haskeline</code>'s behavior is partially defined in <code>~/.haskeline</code> to some extent.</p>\n\n<p>I have being suffering from the lack of support for <code>end</code> key and <code>home</code> key of <code>ghci</code> for a long time. So I tried to define my own <code>~/.haskeline</code> file.</p>\n\n<p>Firstly:</p>\n\n<pre><code>bind: a home\nbind: b end\n\nkeyseq: \"a\" home\nkeyseq: \"b\" end\n\nbind: left home\nbind: right end\n</code></pre>\n\n<p>Both behave as when I press <code>a</code> then the cursor to the most left and similarly to others.</p>\n\n<p>Secondly:</p>\n\n<pre><code>bind: home a\nbind: end b\n</code></pre>\n\n<p>It shows that my <code>ghci</code> seems to ignore my <code>home</code> and <code>end</code> press absolutely.</p>\n\n<p>So how could I send <code>home</code> and <code>end</code> key to <code>ghci</code> and <code>haskline</code>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1189, "user_id": 348201, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/1b5c1cb1e1615645078717836ffc3eaf?s=128&d=identicon&r=PG", "display_name": "somesoaccount", "link": "https://stackoverflow.com/users/348201/somesoaccount"}, "edited": false, "score": 0, "creation_date": 1447592157, "post_id": 33719726, "comment_id": 55209771, "body": "I think you might solve the error with using <code>fromIntegral (abs (n2-n))</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1447592322, "post_id": 33719726, "comment_id": 55209828, "body": "You should add type annotations to your functions. In that way you&#39;ll see that <code>squareRoot</code> produces some type in the <code>Rational</code> typeclass, while later on you expect an <code>Int</code>. If you want to keep it simple, make <code>squareRoot</code> return a <code>Double</code>, and use <code>fromIntegral</code> and <code>floor</code> to convert ints to doubles and back, as needed."}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 2, "last_activity_date": 1447593480, "last_edit_date": 1447593480, "creation_date": 1447593134, "answer_id": 33720058, "question_id": 33719726, "link": "https://stackoverflow.com/questions/33719726/unresolved-instance-declaration/33720058#33720058", "title": "Unresolved Instance Declaration", "body": "<p>aside from the things already mentioned in the comments I think that you want to use your <code>squareRoot</code> to got only to <code>sqrt p</code> while checking for divisors for your <code>isPrime</code> predicate right?</p>\n\n<p>if so, then instead of using conversion and <code>sqrt</code> and stuff you can just make use of</p>\n\n<pre><code>m &lt;= sqrt n &lt;=&gt; m^2 &lt;= n\n</code></pre>\n\n<p>like this:</p>\n\n<pre><code>isPrime :: Integer -&gt; Bool\nisPrime 1 = False\nisPrime p = null [ d | d &lt;- takeWhile (\\ m -&gt; m^2 &lt;= p) [2..], p `mod` d == 0 ]\n</code></pre>\n\n<p>and get:</p>\n\n<pre><code>\u03bb&gt; take 20 primes\n[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71]\n</code></pre>\n\n<p>as well ;)</p>\n\n<hr>\n\n<p>in case you are looking for a way to get <code>floor (sqrt p)</code> for (I assume <code>approx</code> is some kind of algorithm to get you a series of numbers to calculate roots), than using the same observation this would just be</p>\n\n<pre><code>sqrtn :: Integer -&gt; Integer\nsqrtn n = head [ m | m &lt;- [n,n-1..1], m^2 &lt;= n ]\n</code></pre>\n"}], "owner": {"reputation": 75, "user_id": 2969662, "user_type": "registered", "accept_rate": 41, "profile_image": "https://i.stack.imgur.com/zR6q4.jpg?s=128&g=1", "display_name": "Aaron", "link": "https://stackoverflow.com/users/2969662/aaron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 33720058, "answer_count": 1, "score": 1, "last_activity_date": 1447609365, "creation_date": 1447590984, "last_edit_date": 1447609365, "question_id": 33719726, "link": "https://stackoverflow.com/questions/33719726/unresolved-instance-declaration", "title": "Unresolved Instance Declaration", "body": "<p>I have two functions , one to get the squareRoot of a number which differs from the previous item by <code>&lt; 0.0001</code> , <strong>approx is fine</strong>.</p>\n\n<pre><code>squareRoot n = squareRoot' (approx n)\n\nsquareRoot' ( n : n2 : ns ) | abs (n2 - n) &lt; 0.0001 = n2\n                            | otherwise = squareRoot' ( n2 : ns )\n</code></pre>\n\n<p>And another which uses it to list the infinite list of primes</p>\n\n<pre><code>primes = [ n | n &lt;- [ 2 .. ], isPrime n ]\n\nisPrime 2 = True\nisPrime 3 = True\n\nisPrime n = isPrime' n (squareRoot n) primes\n\nisPrime' n squareRoot (h : t)   \n   | h &lt; squareRoot &amp;&amp; mod n ( h :: Int ) /= 0 = False\n   | otherwise = isPrime' n squareRoot t\n</code></pre>\n\n<p>I simple cannot see the instance declaration that I must make that results in </p>\n\n<pre><code>No instance for (Fractional Int) arising from a use of `squareRoot'\nPossible fix: add an instance declaration for (Fractional Int)\nIn the second argument of isPrime', namely `(squareRoot n)'\nIn the expression: isPrime' n (squareRoot n) primes\nIn an equation for `isPrime':\n    isPrime n = isPrime' n (squareRoot n) primes\n</code></pre>\n\n<p>Could someone help me out ? Thanks</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1447589686, "post_id": 33719292, "comment_id": 55209082, "body": "Small remark: <code>toDigits :: Integer -&gt; [Int]</code> is probably more appropriate."}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 5, "last_activity_date": 1447588100, "creation_date": 1447588100, "answer_id": 33719325, "question_id": 33719292, "link": "https://stackoverflow.com/questions/33719292/iterate-over-the-result-of-a-function-in-a-list-comprehension/33719325#33719325", "title": "Iterate over the result of a function in a list comprehension", "body": "<p>well your idea is really good - let's first give you a working example:</p>\n\n<pre><code>toDigits :: Integer -&gt; [Integer]\ntoDigits n = [read [c] | c &lt;- show n]\n</code></pre>\n\n<p>now where is the difference? - Well if you do <code>[show n]</code></p>\n\n<p>you produce a list with one string:</p>\n\n<pre><code>\u03bb&gt; [show 333]\n[\"333\"]\n</code></pre>\n\n<p>and then <code>read \"333\"</code> will just give you back <code>333</code> and since it's the only element in the list you get your result</p>\n\n<p>so the obvious solution is to remove the <code>[..]</code> from <code>[show n]</code> but now you get characters out and <code>read</code> wants strings - that's why I re-wrap each character (using <code>[c]</code>) before reading</p>\n\n<p>and that is exactly what you wanted (or so I think)</p>\n"}], "owner": {"reputation": 7179, "user_id": 222163, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ldCVf.jpg?s=128&g=1", "display_name": "Paul D&#39;Ambra", "link": "https://stackoverflow.com/users/222163/paul-dambra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 33719325, "answer_count": 1, "score": 1, "last_activity_date": 1447588100, "creation_date": 1447587815, "question_id": 33719292, "link": "https://stackoverflow.com/questions/33719292/iterate-over-the-result-of-a-function-in-a-list-comprehension", "title": "Iterate over the result of a function in a list comprehension", "body": "<p>I'm learning Haskell and have got myself confused.</p>\n\n<p>I want to define a function </p>\n\n<pre><code>toDigits :: Integer -&gt; [Integer]\n</code></pre>\n\n<p>it should take a number (e.g. 234) and return the constituent digits (e.g. [2,3,4])</p>\n\n<p>I thought that this...</p>\n\n<pre><code>toDigits n = [read c | c &lt;- [show n]]\n</code></pre>\n\n<p>meant</p>\n\n<ul>\n<li><code>show n</code> i.e. convert 234 to \"234\"</li>\n<li>use \"234\" to generate the sequence [\"2\",\"3\",\"4\"]</li>\n<li>and then apply <code>read</code> to each element giving [2,3,4]</li>\n</ul>\n\n<p>but instead I get \"234\" back out so it must mean</p>\n\n<ul>\n<li><code>show n</code> i.e. convert 234 to \"234\"</li>\n<li>use \"234\" to generate the sequence [\"234\"]</li>\n<li>and then apply <code>read</code> to each element giving [234]</li>\n</ul>\n\n<p>Am I missing a tiny bit of syntax or doing something crazy?</p>\n"}, {"tags": ["haskell", "matrix"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1447585735, "post_id": 33718975, "comment_id": 55208069, "body": "Without the definition of <code>multStd2</code> and <code>Matrix</code>? No clue."}, {"owner": {"reputation": 129, "user_id": 834108, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bedf8b7464b132ea229ff4ebd3fb2ba?s=128&d=identicon&r=PG", "display_name": "meownoid", "link": "https://stackoverflow.com/users/834108/meownoid"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1447585815, "post_id": 33718975, "comment_id": 55208098, "body": "It&#39;s a standard haskell module. <a href=\"https://hackage.haskell.org/package/matrix\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/matrix</a>"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 6, "creation_date": 1447586159, "post_id": 33718975, "comment_id": 55208191, "body": "That&#39;s not a &quot;standard module&quot;. It&#39;s not a part of the haskell-platform, nor <a href=\"http://packdeps.haskellers.com/reverse/matrix\" rel=\"nofollow noreferrer\">widely used</a>. It&#39;s just a package called &quot;matrix&quot;. There&#39;s no &quot;standard&quot; package for matrix manipulation."}, {"owner": {"reputation": 129, "user_id": 834108, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bedf8b7464b132ea229ff4ebd3fb2ba?s=128&d=identicon&r=PG", "display_name": "meownoid", "link": "https://stackoverflow.com/users/834108/meownoid"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1447586375, "post_id": 33718975, "comment_id": 55208247, "body": "Ok, thanks. Can you recommend any better packages, please?"}, {"owner": {"reputation": 16267, "user_id": 1346276, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Tu8Re.jpg?s=128&g=1", "display_name": "phipsgabler", "link": "https://stackoverflow.com/users/1346276/phipsgabler"}, "edited": false, "score": 2, "creation_date": 1447586645, "post_id": 33718975, "comment_id": 55208322, "body": "To quote from the package description: &quot;If you want to use GSL, BLAS and LAPACK, hmatrix (<a href=\"http://hackage.haskell.org/package/hmatrix\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/hmatrix</a>) is the way to go.&quot;"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1447592794, "post_id": 33718975, "comment_id": 55209963, "body": "Also note that the <code>hmatrix</code> package can optionally link with the C library OpenBLAS. Compiling hmatrix enabling such optional flag may be beneficial (or detrimental -- but still worth trying if performance is a concern)."}], "answers": [{"tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": false, "score": 5, "last_activity_date": 1447598315, "creation_date": 1447598315, "answer_id": 33720906, "question_id": 33718975, "link": "https://stackoverflow.com/questions/33718975/why-haskells-matrix-multiplication-costs-so-many-memory/33720906#33720906", "title": "Why haskell&#39;s matrix multiplication costs so many memory?", "body": "<p>Two points.</p>\n\n<ul>\n<li><p>You are looking for \"unboxed\" arrays (or vectors or matrices or whatever), not \"boxed\" ones. Unboxed arrays have the same flat representation as C, while boxed arrays are arrays of pointers to heap objects that are stored outside the array. In exchange for the additional space usage, boxed arrays can store any type of element and can also store unevaluated values, making them non-strict in their contents. For a type the same size as a machine word (assuming a 64-bit system) like <code>Double</code>, a boxed array will normally use three times as much space as an unboxed array.</p></li>\n<li><p>The number \"1,991,404,304 bytes\" does not mean what you seem to think it means. It is quite literally the total amount of memory allocated during the computation. This does not say anything about the maximum amount of space used at any one time (except that it is less than 2GB). For peak space usage values, run with <code>+RTS -s</code> and look at the \"maximum residency\" value in the output when the program finishes.</p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1447627421, "post_id": 33720980, "comment_id": 55221213, "body": "It&#39;s not nearly as bad as you suggest. An evaluated <code>Double</code> on the heap is just 16 bytes. 8 for the info pointer, and 8 for the actual double (which is not a pointer, the C definition of <code>StgClosure_</code> notwithstanding). All evaluated <code>Double</code>s share the same info table."}], "tags": [], "owner": {"reputation": 6262, "user_id": 691032, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/04fa8b0cca5a7dfef2d281be67a2b7a2?s=128&d=identicon&r=PG", "display_name": "sinan", "link": "https://stackoverflow.com/users/691032/sinan"}, "is_accepted": true, "score": 3, "last_activity_date": 1447598855, "creation_date": 1447598855, "answer_id": 33720980, "question_id": 33718975, "link": "https://stackoverflow.com/questions/33718975/why-haskells-matrix-multiplication-costs-so-many-memory/33720980#33720980", "title": "Why haskell&#39;s matrix multiplication costs so many memory?", "body": "<blockquote>\n  <p>Why so bad and what should I do except using C++.</p>\n</blockquote>\n\n<ol>\n<li><p>Make sure you're using <code>-O2</code>. In my tests it reduced the maximum memory\nresidence from 1095M to 544M. Runtime also reduces down to 2.65s from 3.48s.</p></li>\n<li><p>Try to use a more efficient library, as also mentioned in the comments. Try\n<code>hmatrix</code>, for example.</p></li>\n</ol>\n\n<p>Now, as for the \"why\". Here's how <code>Matrix</code> type is implemented in <code>matrix</code>\nlibrary:</p>\n\n<pre><code>data Matrix a = M {\n   nrows     :: {-# UNPACK #-} !Int -- ^ Number of rows.\n , ncols     :: {-# UNPACK #-} !Int -- ^ Number of columns.\n , rowOffset :: {-# UNPACK #-} !Int\n , colOffset :: {-# UNPACK #-} !Int\n , vcols     :: {-# UNPACK #-} !Int -- ^ Number of columns of the matrix without offset\n , mvect     :: V.Vector a          -- ^ Content of the matrix as a plain vector.\n   }\n</code></pre>\n\n<p>(Assuming we're on a 64bit system)</p>\n\n<p>We have 5 unpacked integers, which makes <code>5 x 8 bytes = 40 bytes</code>. For the\nactual vector data we have a <code>Vector</code>. It's not an <a href=\"http://hackage.haskell.org/package/vector-0.11.0.0/docs/Data-Vector-Unboxed.html\" rel=\"nofollow\">unboxed\nvector</a>,\nwhich means every element of the vector will be a pointer to a heap allocated\nobject. In our case, we have these functions:</p>\n\n<pre><code>m :: Int -&gt; Matrix Double\nm n =\n  matrix (2^n) (2^n) ( \\(i, j) -&gt; (fromIntegral i) * (fromIntegral j) )\n\np :: Int -&gt; Double\np n = let r = m n in multStd2 r r ! (n,n)\n</code></pre>\n\n<p>(types are added to make it clear)</p>\n\n<p>So we have a <code>Matrix Double</code> of size <code>2^12 * 2^12 = 16777216</code> doubles.</p>\n\n<p>Now to estimate how much memory it'll take to store that many doubles in the\nheap, let's look at GHC's heap object representation.</p>\n\n<p>A heap object is represented as this:</p>\n\n<pre><code>typedef struct StgClosure_ {\n    StgHeader   header;\n    struct StgClosure_ *payload[FLEXIBLE_ARRAY];\n} *StgClosurePtr;\n\ntypedef struct {\n    const StgInfoTable* info;\n} StgHeader;\n\ntypedef struct StgInfoTable_ {\n    StgClosureInfo  layout;     /* closure layout info (one word) */\n    StgHalfWord     type;       /* closure type */\n    StgHalfWord     srt_bitmap;\n    StgCode         code[FLEXIBLE_ARRAY];\n} *StgInfoTablePtr;\n\ntypedef union {\n    struct {                    /* Heap closure payload layout: */\n        StgHalfWord ptrs;       /* number of pointers */\n        StgHalfWord nptrs;      /* number of non-pointers */\n    } payload;\n\n    StgWord bitmap;               /* word-sized bit pattern describing */\n                                  /*  a stack frame: see below */\n    OFFSET_FIELD(large_bitmap_offset);  /* offset from info table to large bitmap structure */\n    StgWord selector_offset;      /* used in THUNK_SELECTORs */\n\n} StgClosureInfo;\n</code></pre>\n\n<p>We have quite a lot of bookkeeping here. To make things simpler, let's assume\nthe <code>matrix</code> library is efficient enough to avoid thunking here(i.e. <code>matrix</code>\nfunction is strict in it's return value). In this case we can say that our\n<code>payload</code> will only have the actual double. So here's the math:</p>\n\n<p>16777216 doubles.\n- 16777216 <code>struct StgClosure_ *</code> for Double type = 16777216 * 8 bytes.\n  - Our payload will only have doubles = 16777216 * 8 bytes.</p>\n\n<ul>\n<li>16777216 StgHeader for Double type.\n\n<ul>\n<li>16777216 <code>StgInfoTable*</code> = 16777216 * 8 bytes.</li>\n<li>A <code>StgInfoTable</code> consist of:\n\n<ul>\n<li>1 <code>StgClosureInfo</code> = at least 3 words = 24 bytes.</li>\n<li>2 half words = 8 bytes.</li>\n<li>An array of bytes. In our case this will be 0 bytes I think. So just a\npointer = 8 bytes.</li>\n</ul></li>\n</ul></li>\n</ul>\n\n<p>When we add up these it makes 1073M.</p>\n\n<hr>\n\n<p>Now, the match was pretty hand-wavy but hopefully it's clear that for every heap\nobject there's a lot of bookkeeping going on. To be more precise we'd need to\ntake things like shared info tables(e.g. as far as I know same closures would\nhave same info tables?) into account, I think.</p>\n"}], "owner": {"reputation": 129, "user_id": 834108, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0bedf8b7464b132ea229ff4ebd3fb2ba?s=128&d=identicon&r=PG", "display_name": "meownoid", "link": "https://stackoverflow.com/users/834108/meownoid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 312, "favorite_count": 0, "accepted_answer_id": 33720980, "answer_count": 2, "score": 0, "last_activity_date": 1447598855, "creation_date": 1447585569, "last_edit_date": 1447586002, "question_id": 33718975, "link": "https://stackoverflow.com/questions/33718975/why-haskells-matrix-multiplication-costs-so-many-memory", "title": "Why haskell&#39;s matrix multiplication costs so many memory?", "body": "<p>I need to multiply [2^14 x 2^14] matrices. But first, let's talk just about [2^12 x 2^12] matrices. How many memory do I need? Assuming it's double matrices, so I need 8 bytes for one element.</p>\n\n<p>((2^12 * 2^12 * 8) / 2^20) * 3 = 384 MiB</p>\n\n<p>It's the worst case, when I need to store all three matrices in memory.</p>\n\n<p>How many memory does haskell need? Let's see.</p>\n\n<pre><code>-&gt; let m n = matrix (2^n) (2^n) ( \\(i, j) -&gt; (fromIntegral i) * (fromIntegral j) ) :: Matrix Double\n-&gt; let p n = let r = m n in multStd2 r r ! (n,n)\n-&gt; p 12\n3.299742941184e12\n(4.84 secs, 1,991,404,304 bytes)\n</code></pre>\n\n<p>It's ~2 GiB. Why so bad and what should I do except using C++?</p>\n\n<p>UPD:</p>\n\n<p>I'm using standard haskell's Data.Matrix module.</p>\n\n<p><a href=\"https://hackage.haskell.org/package/matrix\" rel=\"nofollow\">https://hackage.haskell.org/package/matrix</a></p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1447581775, "post_id": 33718431, "comment_id": 55207123, "body": "well you cannot do <code>:</code> or <code>++</code> on tuples (those are for lists) - and you have no <i>list of tuples</i> you have a <b>tuple of lists</b> - can you please post an example of what you want to do (what is the expected outcome here?)"}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1447583105, "post_id": 33718554, "comment_id": 55207445, "body": "I think the OP wants this to work when lists are non empty, which is more tricky to achieve since they no longer share the same type <code>a</code>. Indeed, in the most general case I think it&#39;s impossible without e.g. intersection types <code>map2 :: (a1 -&gt; b1 -&gt; c1 &amp;&amp; a2 -&gt; b2 -&gt; c2) -&gt; (a1, a2) -&gt; (b1, b2) -&gt; (c1, c2)</code> which of course we do not have in Haskell. We need to settle with something simpler, but it&#39;s not completely clear what that should be."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1447583363, "post_id": 33718554, "comment_id": 55207515, "body": "it just seems so strange to only use <code>[]</code> and I thought maybe it&#39;s some attempt at naturals using empty-sets or something"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1447583412, "post_id": 33718554, "comment_id": 55207531, "body": "as soon as OP gives some details I&#39;ll probably delete the answer but I want to wait if this is ok with you"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1447583791, "post_id": 33718554, "comment_id": 55207609, "body": "I would not delete this -- it could help the OP to formulate the question more precisely. After all, this does answer the question as stated, even if probably not as intended. (If SO were a genie, I&#39;d recommend &quot;be careful about what you wish for...&quot; ;-) )"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1447586910, "post_id": 33718554, "comment_id": 55208387, "body": "@user3237465 In the most general case they are not e.g. <code>mapPair succ (3::Int, &#39;a&#39;)</code>. What you propose it&#39;s probably more than enough for most practical uses, though."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1447593425, "post_id": 33718554, "comment_id": 55210163, "body": "@chi, I meant &quot;enough in this case&quot;. With intersection types it&#39;s even possible to express self-application, which is clearly not possible with just higher rank ones. But we can define <a href=\"http://ideone.com/sxGepU\" rel=\"nofollow noreferrer\">another</a> ad hoc <code>mapPair</code>."}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 2, "last_activity_date": 1447582539, "creation_date": 1447582539, "answer_id": 33718554, "question_id": 33718431, "link": "https://stackoverflow.com/questions/33718431/attaching-list-of-tuples-together/33718554#33718554", "title": "Attaching list of tuples together", "body": "<p>your main problem here is that you have an <em>tuple of lists</em>  instead of a <em>list of tuples</em> as you claimed - so of course neither <code>:</code> nor <code>++</code> will work.</p>\n\n<p>Maybe you want to use those operations component-wise, which can be done by something like:</p>\n\n<pre><code>map3 :: (a -&gt; b -&gt; c) -&gt; (a, a, a) -&gt; (b, b, b) -&gt; (c, c, c)\nmap3 op (xs,ys,zs) (xs',ys',zs') = (xs `op` xs',ys `op` ys',zs `op` zs') \n</code></pre>\n\n<p>using this you get:</p>\n\n<pre><code>\u03bb&gt; map3 (++) ([],[[]],[]) ([],[[]],[])\n([],[[],[]],[])\n\u03bb&gt; map3 (:) ([],[[]],[]) ([],[[]],[])\n([[]],[[[]],[]],[[]])\n</code></pre>\n\n<p>if this is not what you expected / wanted then please add an example on what you want</p>\n"}], "owner": {"reputation": 630, "user_id": 4913220, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/NjkLC.jpg?s=128&g=1", "display_name": "Vlad Balanescu", "link": "https://stackoverflow.com/users/4913220/vlad-balanescu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 33718554, "answer_count": 1, "score": 0, "last_activity_date": 1447609614, "creation_date": 1447581512, "last_edit_date": 1447609614, "question_id": 33718431, "link": "https://stackoverflow.com/questions/33718431/attaching-list-of-tuples-together", "title": "Attaching list of tuples together", "body": "<p>I have a list of tuples which looks like this in Haskell:</p>\n\n<pre><code>([],[[]],[])\n</code></pre>\n\n<p>And I want to perform some operations on these lists and return all possible changes of state onto them. I want to return a list of this tuple and I am not quite sure how to bind them together. When I tried cons or ++ I get some errors.</p>\n\n<pre><code>([],[[]],[]):([],[[]],[])\n([],[[]],[])++([],[[]],[])\n\n&lt;interactive&gt;:81:1:\nCouldn't match expected type \u2018[a]\u2019\n            with actual type \u2018([t0], [t1], [t2])\u2019\nRelevant bindings include it :: [a] (bound at &lt;interactive&gt;:81:1)\nIn the first argument of \u2018(++)\u2019, namely \u2018([], [], [])\u2019\nIn the expression: ([], [], []) ++ ([], [], [])\nIn an equation for \u2018it\u2019: it = ([], [], []) ++ ([], [], [])\n</code></pre>\n"}, {"tags": ["haskell", "logical-operators"], "comments": [{"owner": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 0, "creation_date": 1447575453, "post_id": 33717712, "comment_id": 55205825, "body": "Well, <code>otherwise</code> of <code>False</code> is <code>True</code>, right?"}, {"owner": {"reputation": 602, "user_id": 2695711, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/338ff7a9bfed60daa1a76f6de97bebd9?s=128&d=identicon&r=PG&f=1", "display_name": "Apeiron", "link": "https://stackoverflow.com/users/2695711/apeiron"}, "reply_to_user": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 0, "creation_date": 1447575498, "post_id": 33717712, "comment_id": 55205838, "body": "Yeah, sure enough. It&#39;s just I never told it to &#39;put out True&#39; explicitly, like I did with the &#39;x == False&#39;  case. Maybe its just a stupid question hehe"}, {"owner": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 1, "creation_date": 1447575700, "post_id": 33717712, "comment_id": 55205888, "body": "Oh wait... Where is the definition for an empty list?"}, {"owner": {"reputation": 602, "user_id": 2695711, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/338ff7a9bfed60daa1a76f6de97bebd9?s=128&d=identicon&r=PG&f=1", "display_name": "Apeiron", "link": "https://stackoverflow.com/users/2695711/apeiron"}, "reply_to_user": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 0, "creation_date": 1447575832, "post_id": 33717712, "comment_id": 55205918, "body": "Yeah, that will fail, mind you I was just sketching up at this stage"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1447575879, "post_id": 33717712, "comment_id": 55205928, "body": "and that is why your sketch will not work (and will not produce <code>True</code> ever) - try it with <code>[]</code> or <code>[True]</code>, ... how did your run this code to produce <code>True</code>?"}, {"owner": {"reputation": 602, "user_id": 2695711, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/338ff7a9bfed60daa1a76f6de97bebd9?s=128&d=identicon&r=PG&f=1", "display_name": "Apeiron", "link": "https://stackoverflow.com/users/2695711/apeiron"}, "edited": false, "score": 0, "creation_date": 1447575913, "post_id": 33717712, "comment_id": 55205939, "body": "It does produce true (at least in Hugs)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1447575927, "post_id": 33717712, "comment_id": 55205942, "body": "with what input? (the first version has not even a correct syntax as a <code>=</code> is missing - so you probably did not give us the version you tested against)"}, {"owner": {"reputation": 602, "user_id": 2695711, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/338ff7a9bfed60daa1a76f6de97bebd9?s=128&d=identicon&r=PG&f=1", "display_name": "Apeiron", "link": "https://stackoverflow.com/users/2695711/apeiron"}, "edited": false, "score": 0, "creation_date": 1447576012, "post_id": 33717712, "comment_id": 55205968, "body": "Main&gt; listand [True, True, True] True"}, {"owner": {"reputation": 602, "user_id": 2695711, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/338ff7a9bfed60daa1a76f6de97bebd9?s=128&d=identicon&r=PG&f=1", "display_name": "Apeiron", "link": "https://stackoverflow.com/users/2695711/apeiron"}, "edited": false, "score": 0, "creation_date": 1447576118, "post_id": 33717712, "comment_id": 55205987, "body": "I found the error... auch recursive call to &#39;and&#39; /cry"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1447576124, "post_id": 33717712, "comment_id": 55205988, "body": "well I have no hugs around to try this but this would be really suprising - are you sure you gave us the right version? Because i GHC(i) it will produce a &quot;Non-exhaustive patterns&quot; exception - which is to be expected ... well ok"}, {"owner": {"reputation": 602, "user_id": 2695711, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/338ff7a9bfed60daa1a76f6de97bebd9?s=128&d=identicon&r=PG&f=1", "display_name": "Apeiron", "link": "https://stackoverflow.com/users/2695711/apeiron"}, "edited": false, "score": 0, "creation_date": 1447576177, "post_id": 33717712, "comment_id": 55206000, "body": "Yeah, I&#39;m so sorry, a stupid error on my part :&#39;("}, {"owner": {"reputation": 3644, "user_id": 1465116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1987d0ba73cb23a47a25dbfe0b36106e?s=128&d=identicon&r=PG", "display_name": "Athan Clark", "link": "https://stackoverflow.com/users/1465116/athan-clark"}, "edited": false, "score": 0, "creation_date": 1447577053, "post_id": 33717712, "comment_id": 55206168, "body": "I hate to let you cheat on learning, but the <code>all</code> and <code>any</code> functions accomplish this too :)  If you&#39;re interested in folds, try implementing them with <code>foldr</code>!"}, {"owner": {"reputation": 602, "user_id": 2695711, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/338ff7a9bfed60daa1a76f6de97bebd9?s=128&d=identicon&r=PG&f=1", "display_name": "Apeiron", "link": "https://stackoverflow.com/users/2695711/apeiron"}, "edited": false, "score": 0, "creation_date": 1447577219, "post_id": 33717712, "comment_id": 55206197, "body": "Yeah sure, but these are just exercises given by the author. I know I could use &#39;foldr (&amp;&amp;) True xs &#39; as well"}], "answers": [{"tags": [], "owner": {"reputation": 779, "user_id": 1102945, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/578c55f38095f9be8b773b30f2d82a9c?s=128&d=identicon&r=PG", "display_name": "stephenwade", "link": "https://stackoverflow.com/users/1102945/stephenwade"}, "is_accepted": false, "score": 0, "last_activity_date": 1518392394, "last_edit_date": 1518392394, "creation_date": 1518391730, "answer_id": 48737580, "question_id": 33717712, "link": "https://stackoverflow.com/questions/33717712/check-if-all-items-in-a-list-are-true/48737580#48737580", "title": "Check if all items in a list are true", "body": "<p>To answer your last question, yes, your code works because of the guard clause. This is because of how lists work in Haskell.</p>\n\n<p>Internally, Haskell lists are linked lists. In short, this means that a list item is either the empty list, or a pair of a thing and another list.</p>\n\n<p>To make this concrete, here's an example.</p>\n\n<p>The list <code>[5,10,15]</code> is a pair of <code>5</code> and the list <code>[10,15]</code>.</p>\n\n<p>The list <code>[10,15]</code> is a pair of <code>10</code> and the list <code>[15]</code>.</p>\n\n<p>The list <code>[15]</code> is a pair of <code>15</code> and the empty list <code>[]</code>.</p>\n\n<p>This list can also be written as <code>5:10:15:[]</code>, and this is where the pattern <code>(x:xs)</code> comes from.</p>\n\n<p>This should make it clear how your function works. A list with some items will match the <code>(x:xs)</code> pattern. If none of the list items are <code>False</code>, the function keeps executing on the rest of the list, until the rest of the list is just the empty list, at which point it matches the <code>[]</code> pattern and you get your final answer.</p>\n"}], "owner": {"reputation": 602, "user_id": 2695711, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/338ff7a9bfed60daa1a76f6de97bebd9?s=128&d=identicon&r=PG&f=1", "display_name": "Apeiron", "link": "https://stackoverflow.com/users/2695711/apeiron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2383, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1518405014, "creation_date": 1447575299, "last_edit_date": 1518405014, "question_id": 33717712, "link": "https://stackoverflow.com/questions/33717712/check-if-all-items-in-a-list-are-true", "title": "Check if all items in a list are true", "body": "<p>I'm working through <a href=\"https://rads.stackoverflow.com/amzn/click/com/0521692695\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\" title=\"Programming in Haskell\">Programming in Haskell</a> and was asked the following: </p>\n\n<blockquote>\n  <p>Decide if all logical values in a list are true.</p>\n</blockquote>\n\n<p>I sketched some things on paper and wound up with:</p>\n\n<pre><code>listand     ::  [Bool] -&gt; Bool\nlistand []              = True\nlistand (x:xs)  \n    | x == False        = False\n    | otherwise         = listand xs\n</code></pre>\n\n<p>All the while thinking, okay I know I'm traversing the list correctly, but how do I keep track of the True values (yeah, I'm probably thinking too much like an imperative mind in a functional world).</p>\n\n<p>Anyway, I ran the code and it was correct. But I've never told it how to behave when it found a true value. </p>\n\n<p>So I made the same thing for OR:</p>\n\n<pre><code>listor      ::  [Bool] -&gt; Bool\nlistor []               = False\nlistor (x:xs)\n    | x == True         = True\n    | otherwise         = listor xs\n</code></pre>\n\n<p>And sure enough this works as well.</p>\n\n<p>Now my question is, why does it work? Since I've never told it to use True in case of the listand function, how does this work exactly? Is this because of the guard clause?</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1447547199, "post_id": 33715010, "comment_id": 55200928, "body": "hidding =&gt; hiding but this is a feature and used"}, {"owner": {"reputation": 3485, "user_id": 1483503, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/652348761699d4193e073409caa287d6?s=128&d=identicon&r=PG", "display_name": "mljrg", "link": "https://stackoverflow.com/users/1483503/mljrg"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1447547676, "post_id": 33715010, "comment_id": 55201025, "body": "Fixed the typo. Thanks for your answer."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1447553388, "post_id": 33715010, "comment_id": 55202119, "body": "&quot;Is this a feature or a bug?&quot; Mu! This is the way <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch5.html#x11-1010005.3\" rel=\"nofollow noreferrer\">the spec says to behave</a>, so it is not appropriate to call it either a bug (which would imply it&#39;s not intended) or a feature (which would imply going above and beyond the expected behavior)."}], "answers": [{"tags": [], "owner": {"reputation": 6262, "user_id": 691032, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/04fa8b0cca5a7dfef2d281be67a2b7a2?s=128&d=identicon&r=PG", "display_name": "sinan", "link": "https://stackoverflow.com/users/691032/sinan"}, "is_accepted": false, "score": 3, "last_activity_date": 1447548574, "creation_date": 1447548574, "answer_id": 33715168, "question_id": 33715010, "link": "https://stackoverflow.com/questions/33715010/ghc-import-feature-or-bug/33715168#33715168", "title": "GHC import feature or bug", "body": "<p>This is a feature and if you search in Github for example you can see this used a lot in the wild.</p>\n\n<p>A widely used idiom is this:</p>\n\n<pre><code>import Data.Text (Text)\nimport qualified Data.Text as T\n</code></pre>\n\n<p>This way you don't have to qualify <code>Text</code> in your types and you don't get functions that are conflicting with <code>Prelude</code> functions(like <code>Data.Text.filter</code>, <code>Data.Text.zip</code> etc.).</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1447550422, "creation_date": 1447550422, "answer_id": 33715357, "question_id": 33715010, "link": "https://stackoverflow.com/questions/33715010/ghc-import-feature-or-bug/33715357#33715357", "title": "GHC import feature or bug", "body": "<p>This is allowed. The import mechanism is very flexible, sometimes surprisingly so. </p>\n\n<p>You can for instance import a module under different names:</p>\n\n<pre><code>import qualified M as A\nimport qualified M as B\n</code></pre>\n\n<p>After this, both <code>A.x</code> and <code>B.x</code> will refer to <code>M.x</code>.</p>\n\n<p>Perhaps more surprisingly, you can also import two modules under the same name.</p>\n\n<pre><code>import qualified M as A\nimport qualified N as A\n</code></pre>\n\n<p>After this, <code>A.x</code> will refer to either <code>M.x</code> or <code>N.x</code>. If both are defined, an ambiguity error is triggered.</p>\n\n<p>This last feature might seem strange, but after all such ambiguities are already present when importing modules without qualification, so this flexibility does not require any more machinery than the plain import does.</p>\n"}], "owner": {"reputation": 3485, "user_id": 1483503, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/652348761699d4193e073409caa287d6?s=128&d=identicon&r=PG", "display_name": "mljrg", "link": "https://stackoverflow.com/users/1483503/mljrg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 33715357, "answer_count": 2, "score": 4, "last_activity_date": 1447550422, "creation_date": 1447547086, "last_edit_date": 1447547598, "question_id": 33715010, "link": "https://stackoverflow.com/questions/33715010/ghc-import-feature-or-bug", "title": "GHC import feature or bug", "body": "<p>I found that the following code is accepted by GHC:</p>\n\n<pre><code>import Prelude hiding (filter)\nimport qualified Prelude as P\n</code></pre>\n\n<p>The idea of these two imports is to make all Prelude functions available as usual, but to require <code>filter</code> to be qualified as <code>P.filter</code>.</p>\n\n<p>I never saw a similar example anywhere, hence my question: is this a feature or a bug in GHC?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 5, "creation_date": 1447543013, "post_id": 33714435, "comment_id": 55199918, "body": "This code is wrong in so many ways - please start  reading on some basic haskell syntax - like <a href=\"http://learnyouahaskell.com/\" rel=\"nofollow noreferrer\">learnyouahaskell.com</a>"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 5, "creation_date": 1447543166, "post_id": 33714435, "comment_id": 55199962, "body": "<code>[Int,Int]</code> cannot exist - maybe you meant <code>(Int,Int)</code> also <code>putStr</code> expects a <code>String</code> as input"}, {"owner": {"reputation": 55, "user_id": 5258299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ff3362f3b3faebc287ee1acb61c676f?s=128&d=identicon&r=PG&f=1", "display_name": "baitillus", "link": "https://stackoverflow.com/users/5258299/baitillus"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1447543329, "post_id": 33714435, "comment_id": 55200007, "body": "I&#39;ve tried a tuple (Int, Int) and I get the same type of compiling error."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 3, "creation_date": 1447543342, "post_id": 33714435, "comment_id": 55200010, "body": "a) please be mannered, b) if you write in a forum try to write a meaningful question - your post contains no information what you have already researched or worked on"}, {"owner": {"reputation": 55, "user_id": 5258299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ff3362f3b3faebc287ee1acb61c676f?s=128&d=identicon&r=PG&f=1", "display_name": "baitillus", "link": "https://stackoverflow.com/users/5258299/baitillus"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1447543404, "post_id": 33714435, "comment_id": 55200027, "body": "And if the code is so wrong tell me what is wrong with it!!!! Pure semantics? Logical structure?"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 55, "user_id": 5258299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ff3362f3b3faebc287ee1acb61c676f?s=128&d=identicon&r=PG&f=1", "display_name": "baitillus", "link": "https://stackoverflow.com/users/5258299/baitillus"}, "edited": false, "score": 0, "creation_date": 1447543421, "post_id": 33714435, "comment_id": 55200036, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/95149/discussion-between-epsilonhalbe-and-baitillus\">continue this discussion in chat</a>."}, {"owner": {"reputation": 55, "user_id": 5258299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ff3362f3b3faebc287ee1acb61c676f?s=128&d=identicon&r=PG&f=1", "display_name": "baitillus", "link": "https://stackoverflow.com/users/5258299/baitillus"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1447543603, "post_id": 33714435, "comment_id": 55200088, "body": "I&#39;ve researched the Haskell documentation, the wikipedia, a wiki specific to haskell, this forum and many other pages. Nothing seems to be explicit or even implicit on this type of compiling error. If my question is not meaning full then I don&#39;t know what a question is."}, {"owner": {"reputation": 55, "user_id": 5258299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ff3362f3b3faebc287ee1acb61c676f?s=128&d=identicon&r=PG&f=1", "display_name": "baitillus", "link": "https://stackoverflow.com/users/5258299/baitillus"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1447547313, "post_id": 33714435, "comment_id": 55200962, "body": "I cant write on the chat. It says i dont have level to do that. sorry epsilonhalbe. I have learned a lot from you. Organization of ideas and concepts manly. I owe you one. Thank you very much!"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 1, "creation_date": 1447552313, "post_id": 33714435, "comment_id": 55201931, "body": "@baitillus: your code (<i>and</i> attitude) is wrong on so many levels, I literally don&#39;t know where to start... but in any case: it says <code>[Int, Int]</code> is an illegal type, and that&#39;s all there is to the compilation error \u2014 the type <code>[Int, Int]</code> is nonsensical; and of course you provided no insight whatosever to what this code is intended to do, nor what you might think this error means, which would have shed some light into how you think and your level of experience, etc, aiding others in helping you."}], "answers": [{"comments": [{"owner": {"reputation": 163, "user_id": 3955068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14cfb6b0b97806521aba8fe3fcc8e133?s=128&d=identicon&r=PG&f=1", "display_name": "Theodore Lief Gannon", "link": "https://stackoverflow.com/users/3955068/theodore-lief-gannon"}, "edited": false, "score": 0, "creation_date": 1447550526, "post_id": 33714935, "comment_id": 55201609, "body": "<code>mov = putStr . motion</code> would also make sense."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 163, "user_id": 3955068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14cfb6b0b97806521aba8fe3fcc8e133?s=128&d=identicon&r=PG&f=1", "display_name": "Theodore Lief Gannon", "link": "https://stackoverflow.com/users/3955068/theodore-lief-gannon"}, "edited": false, "score": 0, "creation_date": 1447550677, "post_id": 33714935, "comment_id": 55201629, "body": "@TheodoreLiefGannon unfortunately <code>motion</code> takes two arguments, so it does not work :-("}, {"owner": {"reputation": 163, "user_id": 3955068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14cfb6b0b97806521aba8fe3fcc8e133?s=128&d=identicon&r=PG&f=1", "display_name": "Theodore Lief Gannon", "link": "https://stackoverflow.com/users/3955068/theodore-lief-gannon"}, "edited": false, "score": 1, "creation_date": 1447551222, "post_id": 33714935, "comment_id": 55201731, "body": "Ah, missed that. Would still work with just one argument supplied, though: <code>mov xs = putStr . motion xs</code>. Of course there&#39;s always <code>mov = (putStr .) . motion</code> but... yeah, ew. ;)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1447562423, "post_id": 33714935, "comment_id": 55203573, "body": "All those nested ifs really cry out for guards."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1447563157, "post_id": 33714935, "comment_id": 55203665, "body": "@dfeuer, or rather for a list of actions: <code>lookup (toUpper c) ...</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 1, "creation_date": 1447563387, "post_id": 33714935, "comment_id": 55203701, "body": "@user3237465, I missed the fact that the alternatives were different cases of the same letters. I&#39;d smash case and use pattern matching."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1447569127, "post_id": 33714935, "comment_id": 55204638, "body": "In GHC, <code>[Int, Int]</code> (better <code>&#39;[Int, Int]</code>) is a type of kind <code>[*]</code>. Not what the OP wants, but a type."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1447546414, "creation_date": 1447546414, "answer_id": 33714935, "question_id": 33714435, "link": "https://stackoverflow.com/questions/33714435/haskell-again-illegal-types/33714935#33714935", "title": "Haskell, again. Illegal types?", "body": "<p>I have no idea about what this code is supposed to achieve, so it's hard to correct it in the right direction. In the question you should have stated your goal so to provide some context.</p>\n\n<p>I'll just point out a few errors in the code as it is.</p>\n\n<pre><code>motion :: [Char] -&gt; [Int, Int] -&gt; [Int, Int]\n</code></pre>\n\n<p><code>[Int, Int]</code> is not a type. If you want a list of integers, just use <code>[Int]</code>; if a pair of exactly two integers, use <code>(Int, Int)</code>.</p>\n\n<pre><code>motion [] c \u2243 c\n</code></pre>\n\n<p>The <code>\u2243</code> should be <code>=</code>. (How did <code>\u2243</code> end up there?)</p>\n\n<pre><code>motion (i : it) c = if i == 'L' || i == 'l' then putStr ((head c) +1, tail c) : motion it\nelse if i == 'U' || i == 'u' then putStr (head c, ((tail c) + 1)) : motion \nelse if i == 'R' || i == 'r' then putStr (((head c) + 1), tail c) : motion \nelse if i == 'D' || i == 'd' then putStr ((head c), ((tail c) - 1)) : motion it\n else \"instru\u00e7\u00e3o invalida\" putStr c\n</code></pre>\n\n<p>First, indentation matters. The <code>else</code>s should be indented more than <code>motion ...</code>.</p>\n\n<p>Second, you can't <code>putStr</code> in a pure function -- no side effects are allowed unless you return an <code>IO</code> type.</p>\n\n<p>Third <code>tail c + 1</code> makes no sense: the tail of a list is a list, and not a number, so you can't <code>+1</code> that.</p>\n\n<p>Fourth, the the error case I'd use <code>error \"instru\u00e7\u00e3o invalida\"</code>.</p>\n\n<p>Fifth, sometimes you recursively call <code>motion</code> without an argument.</p>\n\n<p>Moreover, in</p>\n\n<pre><code>mov = do putStr motion\n</code></pre>\n\n<p>you can't print a function: provide some arguments for that.</p>\n"}], "owner": {"reputation": 55, "user_id": 5258299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ff3362f3b3faebc287ee1acb61c676f?s=128&d=identicon&r=PG&f=1", "display_name": "baitillus", "link": "https://stackoverflow.com/users/5258299/baitillus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2387, "favorite_count": 1, "closed_date": 1447554094, "answer_count": 1, "score": -9, "last_activity_date": 1447552445, "creation_date": 1447542391, "last_edit_date": 1447552445, "question_id": 33714435, "link": "https://stackoverflow.com/questions/33714435/haskell-again-illegal-types", "closed_reason": "Not suitable for this site", "title": "Haskell, again. Illegal types?", "body": "<p>I'll just post the code and the compiling error.</p>\n\n<pre><code>module Mov where\nimport Data.List\nimport System.IO\n\nmov = do putStr motion\n\nmotion :: [Char] -&gt; [Int, Int] -&gt; [Int, Int]\nmotion [] c \u2243 c\nmotion (i : it) c = if i == 'L' || i == 'l' then putStr ((head c) +1, tail c) : motion it\nelse if i == 'U' || i == 'u' then putStr (head c, ((tail c) + 1)) : motion \nelse if i == 'R' || i == 'r' then putStr (((head c) + 1), tail c) : motion \nelse if i == 'D' || i == 'd' then putStr ((head c), ((tail c) - 1)) : motion it\n else \"instru\u00e7\u00e3o invalida\" putStr c\n</code></pre>\n\n<p>And the compiling errors:</p>\n\n<pre><code>mov.hs:10:19:\nIllegal type: \u2018'[Int, Int]\u2019 Perhaps you intended to use DataKinds\n\nmov.hs:10:33:\nIllegal type: \u2018'[Int, Int]\u2019 Perhaps you intended to use DataKinds\n</code></pre>\n"}, {"tags": ["python-2.7", "validation", "haskell", "assertions"], "answers": [{"comments": [{"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447534805, "post_id": 33713265, "comment_id": 55197609, "body": "Can you say a bit more about <code>Except Error</code>? I&#39;m not familiar with that."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447535076, "post_id": 33713265, "comment_id": 55197701, "body": "@raxacoricofallapatorius <code>Except</code> is available from the transformers package (<a href=\"http://hackage.haskell.org/package/transformers-0.4.3.0/docs/Control-Monad-Trans-Except.html\" rel=\"nofollow noreferrer\">documentation</a>). If you can say more about what you want to know about it, I&#39;ll be happy to expand further."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447535325, "post_id": 33713265, "comment_id": 55197783, "body": "Seeing how <code>configEnigma</code> would look if it used <code>Except</code> (and perhaps how a caller would use it differently) will get me going."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447535436, "post_id": 33713265, "comment_id": 55197809, "body": "@raxacoricofallapatorius As discussed in the answer, the only thing that would change about how <code>configEnigma</code> looks with <code>Except</code> is that <code>guard</code> would be replaced with <code>unless</code> + <code>throwError</code>. I will add a comment on the difference in caller behavior."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447541160, "post_id": 33713265, "comment_id": 55199463, "body": "Instead of <code>case runExcept (configEnigma ...)</code> can I just <code>configEnigma ...</code>, crashing if an exception is thrown from <code>configEnigma</code> (as in Python)? I&#39;d like to avoid checking every time I call it (every check is really just going to do the same thing: grind to a halt)."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447541393, "post_id": 33713265, "comment_id": 55199510, "body": "@raxacoricofallapatorius Of course you can. We have a variety of fancy bottoms, including <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#v:error\" rel=\"nofollow noreferrer\"><code>error</code></a> and <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Exception.html#v:throw\" rel=\"nofollow noreferrer\"><code>throw</code></a>. These are handy shortcuts for one-off scripts; but I strongly recommend that you avoid them in production code and get in the habit <i>now</i> of avoiding them even in your one-offs. <code>Except</code> is a powerful tool for ensuring that you give a little thought to error-handling at just the right moment!"}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447542057, "post_id": 33713265, "comment_id": 55199673, "body": "Yes, agreed. But it seems a bit silly (coming from Python) in ever case where my code calls <code>configEnigma</code>, if <code>configEnigma</code> has thrown an error, I want to do the same thing: just crash immediately. It makes sense to just have <code>configEnigma</code> do that itself (with a message, I suppose)."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 1, "creation_date": 1447546121, "post_id": 33713265, "comment_id": 55200663, "body": "@raxacoricofallapatorius Haskell is not Python, and many things that are idiomatic to check or do at runtime in Python are idiomatically done at compile time in Haskell. Verifying that errors are handled is one such point where Python and Haskell differ (and in Haskell&#39;s favor, in my opinion)."}, {"owner": {"reputation": 163, "user_id": 3955068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14cfb6b0b97806521aba8fe3fcc8e133?s=128&d=identicon&r=PG&f=1", "display_name": "Theodore Lief Gannon", "link": "https://stackoverflow.com/users/3955068/theodore-lief-gannon"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447552491, "post_id": 33713265, "comment_id": 55201964, "body": "@raxacoricofallapatorius To really drive home Daniel Wagner&#39;s point: one step of the GHC compile process <i>eliminates types</i>. Pretty much anything involving the type system has zero performance impact! And if you use an error-aware return type (even as simple as Maybe), then Haskell can prevent many runtime-unsafe situations from ever arising in the first place."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447596412, "post_id": 33713265, "comment_id": 55210999, "body": "I&#39;ll take that to heart. What should the type signature of my function then be? <code>configEnigma :: String -&gt; String -&gt; String -&gt; String -&gt; Either CustomError EnigmaConfig</code> doesn&#39;t work? Could you show me what <code>configEnigma</code> should look like using <code>throwError</code>?"}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447596630, "post_id": 33713265, "comment_id": 55211064, "body": "And: I assume I should be using <code>Control.Monad.Except</code>?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 1, "creation_date": 1447606707, "post_id": 33713265, "comment_id": 55214228, "body": "@raxacoricofallapatorius Yes, import <code>Control.Monad.Except</code>. The type signature would look like <code>configEnigma :: ... -&gt; Except CustomError EnigmaConfig</code>."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 163, "user_id": 3955068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14cfb6b0b97806521aba8fe3fcc8e133?s=128&d=identicon&r=PG&f=1", "display_name": "Theodore Lief Gannon", "link": "https://stackoverflow.com/users/3955068/theodore-lief-gannon"}, "edited": false, "score": 0, "creation_date": 1447617901, "post_id": 33713265, "comment_id": 55218146, "body": "@TheodoreLiefGannon: OK, I&#39;m converted (or at least on the way) but I have <a href=\"http://stackoverflow.com/q/33724378/656912\">a follow-up</a> about how to incorporate this into my <a href=\"https://hackage.haskell.org/package/crypto-enigma\" rel=\"nofollow noreferrer\">existing code</a>."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447618131, "post_id": 33713265, "comment_id": 55218239, "body": "I&#39;m new to this, but catching on (I think). However in addition to <a href=\"http://stackoverflow.com/q/33724378/656912\">my follow-up question</a>, I&#39;m confused about what the &quot;best&quot; way to handle errors like this (failures of user input that wreck everything and need to be reported) is. The <a href=\"http://blog.ezyang.com/2011/08/8-ways-to-report-errors-in-haskell-revisited/\" rel=\"nofollow noreferrer\">guides I&#39;ve found</a> on the Web are old, and it&#39;s not clear to me that I&#39;m even using a &quot;current&quot; approach (clearly there have been changes over time)."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447681207, "post_id": 33713265, "comment_id": 55241798, "body": "One (final I hope) clarification. From the user&#39;s point of view, (and maybe my thinking is still to &quot;Pythonesque&quot;), in the case of a &quot;smart&quot; constructor like this one, isn&#39;t immediate failure with <code>error</code> (and signature of <code>... -&gt; EnigmaConfig</code>) the better approach? That avoids hiding errors, makes the API much easier to use; and it&#39;s the <a href=\"https://wiki.haskell.org/Smart_constructors#Smart.28er.29_constructors\" rel=\"nofollow noreferrer\">suggested approach in some discussions</a>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447685091, "post_id": 33713265, "comment_id": 55244367, "body": "@raxacoricofallapatorius The problem with <code>error</code> is exactly that it hides the error, in the following sense: it is not (semantically) possible to catch errors that result from <code>error</code> in pure code. So by using <code>error</code> instead of <code>throwError</code> you remove the caller&#39;s option to notice that something went wrong; callers are of course still free to ignore problems themselves if they prefer using something like <code>either (error . show) id</code>, but in at least some cases they will want to know that something went wrong and take corrective action. Why prevent that?"}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447685730, "post_id": 33713265, "comment_id": 55244794, "body": "There are really two questions here (since I&#39;m learning Haskell): (1) what makes sense from the design perspective, and (2) what is idiomatic Haskell. For (1) it&#39;s pretty clear that there are really two distinct scenarios, so perhaps I need <i>two</i> constrictors: (a) one for cases in which the arguments to the constructer are programmatically supplied and (b) and one for more interactive use like IHaskell or GHCi in which the user enters the arguments. For (a) I agree with what you say; but for (b) I think I need a simpler constructor that just <code>error</code>s when the arguments given are bad."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447686101, "post_id": 33713265, "comment_id": 55245023, "body": "For (2) I don&#39;t know: <a href=\"https://wiki.haskell.org/Smart_constructors#Smart.28er.29_constructors\" rel=\"nofollow noreferrer\">that link</a> suggests <code>error</code>; but I have no idea whether that&#39;s a fair conclusion to draw. So: what do experienced Haskell users expect from a &quot;smart&quot; constructor, that may not be able to make a instance from supplied arguments \u2014 <code>... -&gt; CustomType</code> with potential <code>error</code>; or <code>.. -&gt; Except CustomError CustomType</code>?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447687221, "post_id": 33713265, "comment_id": 55245771, "body": "@raxacoricofallapatorius I sat and puzzled a bit over this question. I came up with two conclusions. (1) In the vast majority of cases, experienced Haskellers expect the <i>input</i> types to be sufficiently restricted that the constructor can always succeed -- e.g. make a type representing only the numbers 1-26 if you can only accept numbers 1-26, or generalize your function to work on larger numbers."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1447687227, "post_id": 33713265, "comment_id": 55245776, "body": "(2) The unusual cases are things like needing dependent types or having to match an existing spec that talks about failures. The canonical example of the latter is character decoding, and there it is very normal to offer both an unsafe version (which calls <code>error</code>) and a safe version (which calls <code>throwError</code>). See for example <a href=\"http://hackage.haskell.org/package/text-1.2.1.3/docs/Data-Text-Encoding.html\" rel=\"nofollow noreferrer\">1</a>, <a href=\"http://hackage.haskell.org/package/encoding-0.8/docs/Data-Encoding.html\" rel=\"nofollow noreferrer\">2</a>"}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447688070, "post_id": 33713265, "comment_id": 55246345, "body": "I&#39;ll give that a try, but restricting input types is fine in theory, but in practice it feels cumbersome; for example the last argument would have to change from <code>&quot;01.22.15&quot;</code>, say, to <code>(makeRingString &quot;01.22.15&quot;)</code> \u2014 and worse, thanks to the issue with <code>read</code> discussed above, if the user alternatively did  <code>(read &quot;01.22.15&quot; :: RingString )</code> he&#39;d learn nothing about what went wrong. Moreover,<code>makeRingString</code> is just going to have to either <code>error</code> (which just shifts the issue) or have be <code>... -&gt; Except Error makeRingString</code> and the latter just makes the call even more complicated."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447690598, "post_id": 33713265, "comment_id": 55248072, "body": "@raxacoricofallapatorius Like IO, if there&#39;s a chance of having an error, you can&#39;t get away from that chance just by wishing. You just have to face up to the possibility of errors and be as graceful as you can."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447691309, "post_id": 33713265, "comment_id": 55248497, "body": "Yes, so clearly the two scenarios are so different that two constructors are needed. Also, any thoughts on why <a href=\"https://wiki.haskell.org/Smart_constructors#Smart.28er.29_constructors\" rel=\"nofollow noreferrer\">that article</a> gives <code>error</code> as the way to do this?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1447693730, "post_id": 33713265, "comment_id": 55249957, "body": "@raxacoricofallapatorius <i>shrug</i> Ask the authors."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 5, "last_activity_date": 1447535646, "last_edit_date": 1447535646, "creation_date": 1447534478, "answer_id": 33713265, "question_id": 33713212, "link": "https://stackoverflow.com/questions/33713212/how-do-i-validate-arguments-to-a-haskell-public-safe-constructor/33713265#33713265", "title": "How do I validate arguments to a Haskell &quot;public safe&quot; constructor?", "body": "<p>The normal thing is to express failure explicitly. For example, one might write</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>configEnigma :: ... -&gt; Maybe ...\nconfigEnigma ... = do\n    guard (all (((==) `on` length) components') [winds', rngs'])\n    guard (all (inRange (1,26)) rngs')\n    guard (all (`elem` letters) winds')\n    guard (all (`M.member` comps) (tail components'))\n    return ...\n    where\n    ...\n</code></pre>\n\n<p>You might even consider upgrading from <code>Maybe</code> to <code>Except Error</code> for some custom-defined type <code>Error</code>, to communicate to the caller what it was that went wrong during construction. Then instead of <code>guard</code>, you could use a construction like:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>    unless (all (inRange (1,26)) rngs') (throwError OutOfRange)\n</code></pre>\n\n<p>The caller to <code>configEnigma</code> will have to express how to handle failures. For <code>Maybe</code>, this looks like</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>case configEnigma ... of\n    Just v  -&gt; -- use the configured enigma machine v\n    Nothing -&gt; -- failure case; perhaps print a message to the user and quit\n</code></pre>\n\n<p>while with <code>Except</code> you get information about what went wrong:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>case runExcept (configEnigma ...) of\n    Right v  -&gt; -- use the configured enigma machine v\n    Left err -&gt; -- failure case; tell the user exactly what went wrong based on err and then quit\n</code></pre>\n"}], "owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 2, "accepted_answer_id": 33713265, "answer_count": 1, "score": 1, "last_activity_date": 1447537740, "creation_date": 1447534209, "last_edit_date": 1447537740, "question_id": 33713212, "link": "https://stackoverflow.com/questions/33713212/how-do-i-validate-arguments-to-a-haskell-public-safe-constructor", "title": "How do I validate arguments to a Haskell &quot;public safe&quot; constructor?", "body": "<p>In my <a href=\"https://pypi.python.org/pypi/crypto-enigma\" rel=\"nofollow\">Python package</a> I have a function I use to create validated instances of my class, with something like </p>\n\n<pre><code>@staticmethod\ndef config_enigma(rotor_names, window_letters, plugs, rings):\n\n    comps = (rotor_names + '-' + plugs).split('-')[::-1]\n    winds = [num_A0(c) for c in 'A' + window_letters + 'A'][::-1]\n    rngs = [int(x) for x in ('01.' + rings + '.01').split('.')][::-1]\n\n    assert all(name in rotors for name in comps[1:-1])\n    assert comps[-1] in reflectors\n    assert len(rngs) == len(winds) == len(comps)\n    assert all(1 &lt;= rng &lt;= 26 for rng in rngs)\n    assert all(chr_A0(wind) in LETTERS for wind in winds)\n\n    #...\n</code></pre>\n\n<p>and I would like to enforce the same behavior in Haskell. But doing so in the same way \u2014\u00a0with assertions \u2014\u00a0does not work, because Haskell assertions are disabled in general (<a href=\"https://downloads.haskell.org/~ghc/7.8.3/docs/html/users_guide/assertions.html\" rel=\"nofollow\">unless certain compiler flags are set</a>). For example, in <a href=\"https://hackage.haskell.org/package/crypto-enigma-0.0.2.5/docs/src/Crypto-Enigma.html#configEnigma\" rel=\"nofollow\">something like</a></p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>configEnigma rots winds plug rngs =\n    assert ((and $ (==(length components')) &lt;$&gt; [length winds', length rngs']) &amp;&amp;\n            (and $ [(&gt;=1),(&lt;=26)] &lt;*&gt; rngs') &amp;&amp;\n            (and $ (`elem` letters) &lt;$&gt; winds') &amp;&amp;\n            (and $ (`M.member` comps) &lt;$&gt; tail components'))\n    -- ...\n    where\n        rngs' = reverse $ (read &lt;$&gt; (splitOn \".\" $ \"01.\" ++ rngs ++ \".01\") :: [Int])\n        winds' = \"A\" ++ reverse winds ++ \"A\"\n        components' = reverse $ splitOn \"-\" $ rots ++ \"-\" ++ plug\n</code></pre>\n\n<p>can't be relied on to work because the assertions will be removed in most contexts.</p>\n\n<p>What is an idiomatic and reliable way to force all my instances to be validated in Haskell (using a \"public safe\" constructor)?</p>\n"}, {"tags": ["haskell", "lifting"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1447538485, "post_id": 33712956, "comment_id": 55198662, "body": "The <code>null</code> check <i>may</i> be done using something like <code>Foldable</code>&#39;s <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Foldable.html#v:null\" rel=\"nofollow noreferrer\"><code>null</code></a> method. But then the problem is how to return the correct value in the empty case..."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1447539356, "post_id": 33712956, "comment_id": 55198974, "body": "<code>Text</code> is not a <code>Foldable</code> - as it is no container how would you write <code>foldMap</code>, except for <code>fold = foldl</code> and <code>foldMap = undefined</code>, which is a bad idea"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1447540030, "post_id": 33712956, "comment_id": 55199169, "body": "@epsilonhalbe, it&#39;s true that <code>Text</code> cannot be <code>Foldable</code>, but not for the reasons you give. The real problem is that only types of kind <code>* -&gt; *</code> can be <code>Foldable</code>, and <code>Text</code> has kind <code>*</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1447540158, "post_id": 33712956, "comment_id": 55199201, "body": "@epsilonhalb, consider <code>data T :: * -&gt; * where T :: Text -&gt; T Char</code>. You can write a perfectly legitimate and sensible <code>Foldable</code> instance for <code>T</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1447540388, "post_id": 33712956, "comment_id": 55199264, "body": "the-konapie, why do you want such a function? It seems rather strange."}, {"owner": {"reputation": 523, "user_id": 1739395, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f6877c2a0e8b24a4b4c9b4700d33846e?s=128&d=identicon&r=PG", "display_name": "the-konapie", "link": "https://stackoverflow.com/users/1739395/the-konapie"}, "edited": false, "score": 0, "creation_date": 1447542579, "post_id": 33712956, "comment_id": 55199814, "body": "@dfeur, I want to use these functions to generate text that will be shown to the user of my game. I have use cases for both functions and was wondering if I could somehow write a single function that can be used in both cases."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1447542584, "post_id": 33712956, "comment_id": 55199815, "body": "@dfeuer that was what I was trying to say with container, I am still not precise enough, sometimes - but the kind `* -&gt; * was what I had in mind"}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1447541158, "post_id": 33713847, "comment_id": 55199462, "body": "What&#39;s the <code>&lt;&gt; mempty</code> for?"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1447542382, "post_id": 33713847, "comment_id": 55199764, "body": "it is from the time when I didn&#39;t think correctly of the <code>isString</code> method"}, {"owner": {"reputation": 523, "user_id": 1739395, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f6877c2a0e8b24a4b4c9b4700d33846e?s=128&d=identicon&r=PG", "display_name": "the-konapie", "link": "https://stackoverflow.com/users/1739395/the-konapie"}, "edited": false, "score": 0, "creation_date": 1447543564, "post_id": 33713847, "comment_id": 55200076, "body": "What does the <code>IsString a =&gt; IsString [a]</code> instance get you? Why not just: <code>instance Nullable [a] where isNull = null</code>?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 523, "user_id": 1739395, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f6877c2a0e8b24a4b4c9b4700d33846e?s=128&d=identicon&r=PG", "display_name": "the-konapie", "link": "https://stackoverflow.com/users/1739395/the-konapie"}, "edited": false, "score": 1, "creation_date": 1447546032, "post_id": 33713847, "comment_id": 55200646, "body": "@the-konapie The extra <code>IsString</code> instance is so that <code>&quot;None&quot;</code> can be given the type <code>[Text]</code>."}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 2, "last_activity_date": 1447542462, "last_edit_date": 1447542462, "creation_date": 1447538092, "answer_id": 33713847, "question_id": 33712956, "link": "https://stackoverflow.com/questions/33712956/haskell-writing-a-function-such-that-it-can-be-lifted-to-work-on-lists/33713847#33713847", "title": "Haskell: writing a function such that it can be lifted to work on lists", "body": "<p>one thing you could do is introduce a typeclass <code>Nullable</code></p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nmodule Stackoverflow where\n\nimport           Data.Text (Text)\nimport qualified Data.Text as T\nimport           Data.Monoid\nimport           Data.String\n\nclass Nullable a where\n    isNull :: a -&gt; Bool\n\ninstance Nullable Text where\n    isNull = T.null\n\ninstance IsString a =&gt; IsString [a] where\n    fromString str = [fromString str]\n</code></pre>\n\n<p>then you can write your function</p>\n\n<pre><code>noneOnEmpty :: (Nullable a, IsString a, Monoid a) =&gt; a -&gt; a\nnoneOnEmpty a | isNull a = \"None\" &lt;&gt; mempty\n              | otherwise = a\n</code></pre>\n\n<h2>Update</h2>\n\n<p>As @DanielWagner points out - the <code>Monoid</code>/<code>mempty</code>/<code>&lt;&gt;</code> part is not necessary</p>\n\n<pre><code>noneOnEmpty :: (Nullable a, IsString a) =&gt; a -&gt; a\nnoneOnEmpty a | isNull a = \"None\"\n              | otherwise = a\n</code></pre>\n"}], "owner": {"reputation": 523, "user_id": 1739395, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/f6877c2a0e8b24a4b4c9b4700d33846e?s=128&d=identicon&r=PG", "display_name": "the-konapie", "link": "https://stackoverflow.com/users/1739395/the-konapie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 33713847, "answer_count": 1, "score": 0, "last_activity_date": 1447542462, "creation_date": 1447532694, "question_id": 33712956, "link": "https://stackoverflow.com/questions/33712956/haskell-writing-a-function-such-that-it-can-be-lifted-to-work-on-lists", "title": "Haskell: writing a function such that it can be lifted to work on lists", "body": "<p>I have the following 2 functions:</p>\n\n<pre><code>import qualified Data.Text as T\n\nnoneOnEmptyA :: T.Text -&gt; T.Text\nnoneOnEmptyA txt | T.null txt = \"None.\"\n                 | otherwise  = txt\n\n\nnoneOnEmptyB :: [T.Text] -&gt; [T.Text]\nnoneOnEmptyB txts | null txts = [\"None.\"]\n                  | otherwise = txts\n</code></pre>\n\n<p>Is it possible to write a single function that 1) accomplishes what <code>noneOnEmptyA</code> does, and 2) can be lifted such that it accomplishes what <code>noneOnEmptyB</code> does? The crux of the problem seems to be that <code>noneOnEmptyA</code> checks for empty text, while <code>noneOnEmptyB</code> checks for an empty list; however, <code>noneOnEmptyA</code> lifted so as to operate on lists (as in <code>fmap noneOnEmptyA</code> returning type <code>[T.Text]</code>) checks for empty text inside the list, rather than checking whether or not the list itself is empty.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 1, "creation_date": 1447531992, "post_id": 33712782, "comment_id": 55196831, "body": "<a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/src/Control.Monad.html#%3E%3D%3E\" rel=\"nofollow noreferrer\"><code>&gt;=&gt;</code>  is implemented in terms of <code>&gt;&gt;=</code></a> so there is nothing more than convenience"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1447535257, "post_id": 33712782, "comment_id": 55197765, "body": "One reason you might like <code>&gt;=&gt;</code> over <code>&gt;&gt;=</code> is how beautiful the monad laws are: <code>(f &gt;=&gt; g) &gt;=&gt; h = f &gt;=&gt; (g &gt;=&gt; h)</code> and <code>return &gt;=&gt; f = f &gt;=&gt; return = f</code>. Compare with the laws written in terms of <code>&gt;&gt;=</code> and you will see a stark difference."}], "answers": [{"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1447535418, "post_id": 33712889, "comment_id": 55197807, "body": "the parallel is clearer seen with <code>x |&gt; f = f x</code>: the associativity law of Monad <code>(m &gt;&gt;= a) &gt;&gt;= b === m &gt;&gt;= (a &gt;=&gt; b)</code> becomes <code>(x |&gt; f) |&gt; g === x |&gt; (f &gt;&gt;&gt; g)</code> where of course <code>f &gt;&gt;&gt; g === g . f</code>. IOW <code>b =&lt;&lt; (a =&lt;&lt; m) === (b &lt;=&lt; a) =&lt;&lt; m</code> becomes <code>g $ (f $ x) === (g . f) x</code>, just as you wrote. Indeed, Kleisli composition forms a category, as <a href=\"https://wiki.haskell.org/Monad_laws\" rel=\"nofollow noreferrer\">the haiku</a> says."}], "tags": [], "owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "is_accepted": false, "score": 3, "last_activity_date": 1447532862, "last_edit_date": 1447532862, "creation_date": 1447532266, "answer_id": 33712889, "question_id": 33712782, "link": "https://stackoverflow.com/questions/33712782/understanding-kleisli-vis-a-vis-bind/33712889#33712889", "title": "Understanding Kleisli vis-a-vis `bind`", "body": "<p>It's similar more or less to the difference between <code>(.)</code> and <code>($)</code> (or function application).</p>\n\n<p>For example, if I wanted to count the number of even numbers in a list, I could do:</p>\n\n<pre><code>countEven = length . filter even\n</code></pre>\n\n<p>Or I could do</p>\n\n<pre><code>countEven xs = length $ filter even $ xs\n</code></pre>\n\n<p>Which really are the same thing, and compile/inline to the same thing in the end, but the two \"mean\" different things.</p>\n\n<p>The first one says, \"<code>countEven</code> is the length of an even-filtered list\".  The second one says, \"to get the number of evens in this list, filter it with <code>filter even</code>, and then apply <code>length</code> to the result\".</p>\n\n<p>Different ways of saying the same thing.  And you could definitely implement one each in terms of the other:</p>\n\n<pre><code>f . g = \\x -&gt; f $ g $ x\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "is_accepted": false, "score": 0, "last_activity_date": 1447538007, "creation_date": 1447538007, "answer_id": 33713828, "question_id": 33712782, "link": "https://stackoverflow.com/questions/33712782/understanding-kleisli-vis-a-vis-bind/33713828#33713828", "title": "Understanding Kleisli vis-a-vis `bind`", "body": "<p>As Justin said it's like <code>.</code>. You can rewrite your example as <code>(&gt;=&gt;) plus10 minus5 5</code> as <code>return 5 &gt;&gt;= (plus10 &gt;=&gt; plus5)</code>, you can compare easily the two version </p>\n\n<pre><code>\u03bb: return 5 &gt;&gt;= plus10 &gt;&gt;= minus5\n10\n\u03bb: return 5 &gt;&gt;= (plus10 &gt;=&gt; minus5)\n10\n</code></pre>\n\n<p>In other word, if you want to write a a point-free version, you can't just write <code>plus10 &gt;&gt;= minus5</code>, you need to use <code>&gt;=&gt;</code> instead.</p>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 324, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1447538007, "creation_date": 1447531639, "question_id": 33712782, "link": "https://stackoverflow.com/questions/33712782/understanding-kleisli-vis-a-vis-bind", "title": "Understanding Kleisli vis-a-vis `bind`", "body": "<p>I'm trying to understand what Kleisli, i.e. <code>&gt;=&gt;</code>, provides over <code>bind</code> (<code>&gt;&gt;=</code>).</p>\n\n<p>Looking at their signatures of <code>bind</code> and <code>Klesli</code>, respectively:</p>\n\n<pre><code>\u03bb: :t (&gt;&gt;=)\n(&gt;&gt;=) :: Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b\n\n\u03bb: :t (&gt;=&gt;)\n(&gt;=&gt;) :: Monad m =&gt; (a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c\n</code></pre>\n\n<p>And then this example:</p>\n\n<pre><code>\u03bb: let plus10 = \\x -&gt; return (x + 10)\n\u03bb: let minus5 = \\x -&gt; return (x - 5)\n</code></pre>\n\n<p>I can use either function call:</p>\n\n<pre><code>\u03bb: return 5 &gt;&gt;= plus10 &gt;&gt;= minus5\n10\n\n\u03bb: (&gt;=&gt;) plus10 minus5 5\n10\n</code></pre>\n\n<p>Of course this is a single, simple example. However, what is the importance of <code>Kleisli</code> over <code>bind</code>? From looking at their function definitions, I wonder if every <code>Kleisli</code> function usage can be re-written using <code>bind</code>.</p>\n"}, {"tags": ["haskell", "recursion"], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 5562597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82e37c10d85d485b4c9da07fdaf6eff8?s=128&d=identicon&r=PG&f=1", "display_name": "user65652", "link": "https://stackoverflow.com/users/5562597/user65652"}, "edited": false, "score": 0, "creation_date": 1447533923, "post_id": 33712472, "comment_id": 55197340, "body": "its is just a function which takes in Int and returns Int."}, {"owner": {"reputation": 13, "user_id": 5562597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82e37c10d85d485b4c9da07fdaf6eff8?s=128&d=identicon&r=PG&f=1", "display_name": "user65652", "link": "https://stackoverflow.com/users/5562597/user65652"}, "edited": false, "score": 0, "creation_date": 1447534625, "post_id": 33712472, "comment_id": 55197549, "body": "i&#39;m having some indentation problem i guess. its showing parse error on |"}, {"owner": {"reputation": 13, "user_id": 5562597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82e37c10d85d485b4c9da07fdaf6eff8?s=128&d=identicon&r=PG&f=1", "display_name": "user65652", "link": "https://stackoverflow.com/users/5562597/user65652"}, "edited": false, "score": 0, "creation_date": 1447535359, "post_id": 33712472, "comment_id": 55197790, "body": "did it compile for you ?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 13, "user_id": 5562597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82e37c10d85d485b4c9da07fdaf6eff8?s=128&d=identicon&r=PG&f=1", "display_name": "user65652", "link": "https://stackoverflow.com/users/5562597/user65652"}, "edited": false, "score": 0, "creation_date": 1447537655, "post_id": 33712472, "comment_id": 55198403, "body": "sorry for the delay - aside from a compiler warning (the <code>&#47;</code>) - both versions are correct for me (and return <code>78</code>)"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 1, "last_activity_date": 1447529649, "creation_date": 1447529649, "answer_id": 33712472, "question_id": 33712177, "link": "https://stackoverflow.com/questions/33712177/recursive-sequence-generation-haskell-function/33712472#33712472", "title": "recursive sequence generation (haskell function)", "body": "<p>one easy solution is to put a few <code>fromIntegral</code>s in there:</p>\n\n<pre><code>main :: IO ()\nmain = do\n    print( funSeq 9)\n\nfunSeq :: Int -&gt; Int\nfunSeq n = do \n    if (n&lt;4)\n        then 1\n        else floor (fromIntegral (funSeq (n-1) + funSeq (n-2)) * (fromIntegral (funSeq (n-3)) / fromIntegral (funSeq(n-4))))\n</code></pre>\n\n<p>which gives</p>\n\n<pre><code>\u03bb&gt; :main\n78\n</code></pre>\n\n<hr>\n\n<p>trying to tidy this up a bit:</p>\n\n<pre><code>funSeq :: Int -&gt; Int\nfunSeq n\n  | n &lt; 4 = 1\n  | otherwise = floor $\n      (fromIntegral $ funSeq (n-1) + funSeq (n-2))\n      * (fromIntegral . funSeq $ n-3) / (fromIntegral . funSeq $ n-4)\n</code></pre>\n\n<p>but it's a bit hard to see what you are trying to - what is the expected type for your <code>funSeq</code> (which is no sequence ;) )? </p>\n"}], "owner": {"reputation": 13, "user_id": 5562597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82e37c10d85d485b4c9da07fdaf6eff8?s=128&d=identicon&r=PG&f=1", "display_name": "user65652", "link": "https://stackoverflow.com/users/5562597/user65652"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 0, "accepted_answer_id": 33712472, "answer_count": 1, "score": 1, "last_activity_date": 1447529649, "creation_date": 1447527716, "last_edit_date": 1447527900, "question_id": 33712177, "link": "https://stackoverflow.com/questions/33712177/recursive-sequence-generation-haskell-function", "title": "recursive sequence generation (haskell function)", "body": "<p>Given below is a small haskell function used to generate a recursive sequence. I'm getting a type error while using floor function. floor function is expecting RealFrac, I suppose. The code and error are given below.</p>\n\n<pre><code>main = do\n    print( funSeq 9)\n\nfunSeq n = do \n    if (n&lt;4)\n        then 1\n        else floor ((funSeq (n-1) + funSeq (n-2)) * (funSeq (n-3)/ funSeq(n-4)))\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>No instance for (RealFrac a0) arising from a use of 'funSeq'\n</code></pre>\n"}, {"tags": ["haskell", "template-haskell"], "comments": [{"owner": {"reputation": 6262, "user_id": 691032, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/04fa8b0cca5a7dfef2d281be67a2b7a2?s=128&d=identicon&r=PG", "display_name": "sinan", "link": "https://stackoverflow.com/users/691032/sinan"}, "edited": false, "score": 0, "creation_date": 1447550856, "post_id": 33711784, "comment_id": 55201663, "body": "Could you post an example program? I couldn&#39;t reproduce. (in fact, I couldn&#39;t make <code>reifyInstances</code> working at all)"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1447620494, "post_id": 33711784, "comment_id": 55219102, "body": "TH is not going to do constraint unification. You should not try to check complex constraints like this yourself - just insert constraints for a fixed set of types which you know are monoids (or allow the user to specify which monoids to use, indicating they must submit valid <code>Monoid</code>s)."}], "owner": {"reputation": 555, "user_id": 1505475, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bc72887d0b9f71cdbc2eeb5f9899d8f?s=128&d=identicon&r=PG", "display_name": "simon1505475", "link": "https://stackoverflow.com/users/1505475/simon1505475"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1447605563, "creation_date": 1447525542, "last_edit_date": 1447605563, "question_id": 33711784, "link": "https://stackoverflow.com/questions/33711784/in-templatehaskell-is-there-a-way-to-get-more-accurate-information-about-instan", "title": "In TemplateHaskell, is there a way to get more accurate information about instances than what reifyInstance provides?", "body": "<p>I'm currently writing a QuickCheck style library and relying on Template Haskell for generating a large number of test cases.</p>\n\n<p>I want to generate code like:</p>\n\n<pre><code>quickCheck (prop_Num_plus_is_associative :: Integer -&gt; Integer -&gt; Integer -&gt; Property)\n</code></pre>\n\n<p>The property \"prop_Monoid_plus_is_associative\" has the following type:</p>\n\n<pre><code>prop_Num_plus_is_associative :: (Eq a, Monoid a, Show a) =&gt; a -&gt; a -&gt; a -&gt; Property\n</code></pre>\n\n<p>so that I can check it with any appropriate instance of <code>Monoid</code>. However, sometimes, the types that my program chooses to fill in for \"a\" does not satisfy the context. I would like to filter out those cases by checking whether a certain instance exists.</p>\n\n<p>However, when I call <code>reifyInstance</code> on <code>Monoid (Max Integer)</code>, it only gives me the list of instances that it could possibly match, namely <code>(Bounded a, Ord a) =&gt; Monoid (Max a)</code>, it does not do the rest of the work of checking whether <code>Integer</code> is <code>Bounded</code> and <code>Ord</code>. Is there a function similar to <code>reifyInstance</code> that does?</p>\n\n<p>Edit:</p>\n\n<p>Here the program that I was hinting at:</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell, QuasiQuotes #-}\n\nimport Data.Semigroup\n\nimport Language.Haskell.TH\n\nmain :: IO ()\nmain = do\n    $(do\n        tMaxInt &lt;- [t| Max Integer |]\n        runIO . putStrLn . pprint =&lt;&lt; reifyInstances ''Monoid [ tMaxInt ]\n        [e| return () |] )\n</code></pre>\n\n<p>It outputs</p>\n\n<pre><code>instance (GHC.Classes.Ord a_0,\n          GHC.Enum.Bounded a_0) =&gt; GHC.Base.Monoid (Data.Semigroup.Max a_0)\n</code></pre>\n\n<p>despite the fact that <code>Max Integer</code> is not a <code>Monoid</code>.</p>\n"}, {"tags": ["haskell", "floating-point"], "comments": [{"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 1, "creation_date": 1447524248, "post_id": 33711546, "comment_id": 55194468, "body": "<a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#v:isInfinite\" rel=\"nofollow noreferrer\"><code>isInfinite</code></a>"}], "answers": [{"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 4, "last_activity_date": 1447524347, "creation_date": 1447524347, "answer_id": 33711610, "question_id": 33711546, "link": "https://stackoverflow.com/questions/33711546/haskell-infinity-check-for-double-data-type/33711610#33711610", "title": "Haskell Infinity check for Double data type", "body": "<p>The <code>RealFloat</code> class, of which both <code>Float</code> and <code>Double</code> are instances, has an <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Prelude.html#v:isInfinite\" rel=\"nofollow\">isInfinite</a> method.</p>\n"}], "owner": {"reputation": 3321, "user_id": 468820, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d53b228cd79135e41556fdf16b98729a?s=128&d=identicon&r=PG", "display_name": "Andrei Bozantan", "link": "https://stackoverflow.com/users/468820/andrei-bozantan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 349, "favorite_count": 0, "accepted_answer_id": 33711610, "answer_count": 1, "score": 1, "last_activity_date": 1447524347, "creation_date": 1447524006, "last_edit_date": 1447524073, "question_id": 33711546, "link": "https://stackoverflow.com/questions/33711546/haskell-infinity-check-for-double-data-type", "title": "Haskell Infinity check for Double data type", "body": "<p>How do you check if a <code>Double</code> value is <code>Infinity</code> in Haskell?</p>\n"}, {"tags": ["haskell", "reflex"], "answers": [{"tags": [], "owner": {"reputation": 7714, "user_id": 149901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d1a6db7a9fb5385fde6ba426e27d5ac6?s=128&d=identicon&r=PG", "display_name": "ondra", "link": "https://stackoverflow.com/users/149901/ondra"}, "is_accepted": true, "score": 4, "last_activity_date": 1451469540, "last_edit_date": 1451469540, "creation_date": 1447630631, "answer_id": 33726453, "question_id": 33711392, "link": "https://stackoverflow.com/questions/33711392/what-is-the-proper-way-in-reflex-dom-to-handle-a-modal-dialog/33726453#33726453", "title": "What is the proper way in reflex-dom to handle a modal dialog?", "body": "<p>Ultimately I found it quite easy:</p>\n\n<p>First, get the <code>body</code> element:</p>\n\n<pre><code>getBody = do\n  root &lt;- askDocument\n  Just nodelist &lt;- getElementsByTagName root (\"body\" :: String)\n  Just body &lt;- nodelist `item` 0\n  return body\n</code></pre>\n\n<p>Then, assuming <code>trigger</code> is the <code>Event</code> that triggers opening the dialog and <code>visible</code> is a <code>Dynamic t Bool</code> that holds the current state, we can create a backdrop and move it to the back of body:</p>\n\n<pre><code>backdropAttr &lt;- forDyn visible (\\vis -&gt; if vis then (\"class\" =: \"modal-backdrop fade in\")\n                                          else (\"style\" =: \"display:none\"))\n(backdrop, _) &lt;- elDynAttr' \"div\" backdropAttr blank\nbody &lt;- getBody\nlet moveBackdrop = (const $ (appendChild body (Just $ _el_element backdrop))) `fmap` trigger\nperformEvent_ $ void `fmap` moveBackdrop\n</code></pre>\n"}], "owner": {"reputation": 7714, "user_id": 149901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d1a6db7a9fb5385fde6ba426e27d5ac6?s=128&d=identicon&r=PG", "display_name": "ondra", "link": "https://stackoverflow.com/users/149901/ondra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 478, "favorite_count": 2, "accepted_answer_id": 33726453, "answer_count": 1, "score": 5, "last_activity_date": 1451469540, "creation_date": 1447523137, "question_id": 33711392, "link": "https://stackoverflow.com/questions/33711392/what-is-the-proper-way-in-reflex-dom-to-handle-a-modal-dialog", "title": "What is the proper way in reflex-dom to handle a modal dialog?", "body": "<p>I am just starting with the <a href=\"https://hackage.haskell.org/package/reflex-dom\" rel=\"noreferrer\">reflex-dom</a> library and I cannot quite figure out the proper and convenient way to work with dialogs.</p>\n\n<p>Showing a dialog generally means adding a few elements to the end of <code>&lt;body&gt;</code> and removing it when the user clicks on some button, backdrop or presses e.g. escape. However doing this from some nested widget means somehow bubbling up the event ('show the dialog') to the top, which could be quite clumsy. Is there any other way to do it nicely? I just had a look at <a href=\"http://markup.rocks\" rel=\"noreferrer\">markup.rocks</a> and that seems to use some JS/jQuery hacks.</p>\n\n<p>I <em>can</em> decide not to use modal dialogs (it may not be a bad option after all), but for some things I may really need it. </p>\n"}, {"tags": ["list", "sorting", "haskell", "primes", "infinite"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1447520771, "post_id": 33710914, "comment_id": 55193384, "body": "The trick would probably be to generate the pairs for <code>2</code>, for <code>3</code> in ascending order and <i>merge</i> them."}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 3, "last_activity_date": 1447521333, "creation_date": 1447521333, "answer_id": 33711084, "question_id": 33710914, "link": "https://stackoverflow.com/questions/33710914/generating-sorted-list-of-all-possible-coprimes/33711084#33711084", "title": "Generating sorted list of all possible coprimes", "body": "<p>While probably not the most optimal way it should works if you first generate all possible pairs and then filter them.</p>\n\n<p>So using your criteria:</p>\n\n<pre><code>pairs :: [(Integer,Integer)]\npairs = [ (i,l-i) | l &lt;- [1..], i &lt;- [1..l-1] ]\n\ncoprimes :: [(Integer,Integer)]\ncoprimes = [ (i,j) | (i,j) &lt;- pairs, 1 &lt; i, i &lt; j,gcd i j == 1]\n</code></pre>\n\n<p>produces </p>\n\n<pre><code>\u03bb&gt; take 10 coprimes\n[(2,3),(2,5),(3,4),(3,5),(2,7),(4,5),(3,7),(2,9),(3,8),(4,7)]\n</code></pre>\n\n<p>now of course you can put some of the stuff <code>1 &lt; i</code> and <code>i &lt; j</code> comes to mind into the <code>pairs</code> definition or even join them but I think here it's more obvious what's going on</p>\n"}, {"comments": [{"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 0, "creation_date": 1615344065, "post_id": 33711133, "comment_id": 117659967, "body": "@daniel-wagner is the author of universe-base. His answer is right before yours (this)."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 1, "last_activity_date": 1447522273, "last_edit_date": 1447522273, "creation_date": 1447521608, "answer_id": 33711133, "question_id": 33710914, "link": "https://stackoverflow.com/questions/33710914/generating-sorted-list-of-all-possible-coprimes/33711133#33711133", "title": "Generating sorted list of all possible coprimes", "body": "<p>As @Bakuriu suggests, merging an infinite list of infinite lists is a solution, but the devil is in the details.</p>\n\n<p>The <a href=\"https://hackage.haskell.org/package/universe-base-1.0.2.1/docs/Data-Universe-Helpers.html#v:diagonal\" rel=\"nofollow\"><strong>diagonal</strong></a> function from the <a href=\"https://hackage.haskell.org/package/universe-base-1.0.2.1\" rel=\"nofollow\">universe-base</a> package can do this, so you could write:</p>\n\n<pre><code>import Data.Universe.Helpers\n\ncoprimes = diagonal [ go n | n &lt;- [2..] ]\n  where go n = [ (n,k) | k &lt;- [n+1..], gcd n k == 1 ]\n</code></pre>\n\n<p>Note - this doesn't satisfy your sorted criteria, but I mention it because the functions in that package are useful to know about, and implementing a function like <code>diagonal</code> correctly is not easy.</p>\n\n<p>If you want to write your own, consider decomposing the infinite grid N x N (where N is the natural numbers) into diagonals:</p>\n\n<pre><code>[ (1,1) ] ++ [ (1,2), (2,1) ] ++ [ (1,3), (2,2), (3,1) ] ++ ...\n</code></pre>\n\n<p>and filtering this list.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1596208678, "post_id": 33711144, "comment_id": 111747783, "body": "instead of <code>foldr1 xmerge</code>, you could use <a href=\"https://hackage.haskell.org/package/data-ordlist-0.4.7.0/docs/Data-List-Ordered.html#v:mergeAllBy\" rel=\"nofollow noreferrer\"><code>Data.List.Ordered.mergeAllBy (comparing (uncurry (+)))</code></a> from <code>data-ordlist</code>. it uses a tree-like structure for the folding, so should bring significant algorithmic (I mean, complexity-wise) advantage (and hence, speed-up). the comparison returns <code>EQ</code> on equal sums, but all functions in that package are left-biased, so that&#39;s OK."}], "tags": [], "owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "is_accepted": false, "score": 2, "last_activity_date": 1447528997, "last_edit_date": 1447528997, "creation_date": 1447521682, "answer_id": 33711144, "question_id": 33710914, "link": "https://stackoverflow.com/questions/33710914/generating-sorted-list-of-all-possible-coprimes/33711144#33711144", "title": "Generating sorted list of all possible coprimes", "body": "<p>Here's a possible solution following Chapter 9 of Richard Bird's <em>Thinking Functionally in Haskell</em>:</p>\n\n<pre><code>coprimes = mergeAll $ map coprimes' [2..]\n\ncoprimes' n = [(n, m) | m &lt;- [n+1..], gcd m n == 1]\n\nmerge (x:xs) (y:ys)\n    | s x &lt; s y =  x:merge xs (y:ys)\n    | s x == s y = x:y:merge xs ys\n    | otherwise = y:merge (x:xs) ys\n    where s (x, y) = x+y\n\nxmerge (x:xs) ys = x:merge xs ys\n\nmergeAll = foldr1 xmerge\n</code></pre>\n\n<p>And the result is:</p>\n\n<pre><code>&gt; take 10 $ coprimes\n[(2,3),(2,5),(3,4),(3,5),(2,7),(4,5),(3,7),(2,9),(3,8),(4,7)]\n</code></pre>\n\n<p>Note that the natural definition of <code>mergeAll</code> would be <code>foldr1 merge</code>, but this doesn't work because it will try to find the minimum of the first elements of all the list before returning the first element, and hence you end up in an infinite loop. However, since we know that the lists are in ascending order and the minimum is the first element of the first list <code>xmerge</code> does the trick.</p>\n\n<hr>\n\n<p>Note: this solution appears to be <em>significantly</em> (like 2 order of magnitudes) slower than Carsten \"naive\" answer. So I advise to avoid this if you are interested in performance. Yet it still is an interesting approach that might be effective in other situations.</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 1, "last_activity_date": 1447522784, "creation_date": 1447522784, "answer_id": 33711334, "question_id": 33710914, "link": "https://stackoverflow.com/questions/33710914/generating-sorted-list-of-all-possible-coprimes/33711334#33711334", "title": "Generating sorted list of all possible coprimes", "body": "<blockquote>\n  <p>I need to generate infinite sorted list of all coprimes. The first element in each pair must be less than the second. The sorting must be done in ascending order -- by the sum of pair's elements; and if two sums are equal, then by the pair's first element.</p>\n</blockquote>\n\n<p>So, we generate ascending pairs of sum and first element, and keep only the coprimes. Easy cheesy!</p>\n\n<pre><code>[ (first, second)\n| sum &lt;- [3..]\n, first &lt;- [2..sum `div` 2]\n, let second = sum-first\n, gcd first second == 1\n]\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 4913894, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-SD-bAFwnIqA/AAAAAAAAAAI/AAAAAAAAA4w/4AP4mcxH4jQ/photo.jpg?sz=128", "display_name": "tsmbl", "link": "https://stackoverflow.com/users/4913894/tsmbl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 339, "favorite_count": 0, "accepted_answer_id": 33711084, "answer_count": 4, "score": 2, "last_activity_date": 1596208052, "creation_date": 1447520238, "last_edit_date": 1596208052, "question_id": 33710914, "link": "https://stackoverflow.com/questions/33710914/generating-sorted-list-of-all-possible-coprimes", "title": "Generating sorted list of all possible coprimes", "body": "<p>I need to generate infinite sorted list of all coprimes.\nThe first element in each pair must be less than the second.\nThe sorting must be done in ascending order -- by the sum of pair's elements; and if two sums are equal, then by the pair's first element.</p>\n\n<p>So, the resulting list must be </p>\n\n<pre><code>[(2,3),(2,5),(3,4),(3,5),(2,7),(4,5),(3,7),(2,9),(3,8),(4,7)...`\n</code></pre>\n\n<p>Here's my solution.</p>\n\n<pre><code>coprimes :: [(Int, Int)]\ncoprimes = sortBy (\\t1 t2 -&gt; if uncurry (+) t1 &lt;= uncurry (+) t2 then LT else GT) $ helper [2..]\n    where helper xs = [(x,y) | x &lt;- xs, y &lt;- xs, x &lt; y, gcd x y == 1]\n</code></pre>\n\n<p>The problem is that I can't take <code>n</code> first pairs. I realize that sorting can't be done on infinite lists.</p>\n\n<p>But how can I generate the same sequence in a lazy way?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1447515890, "post_id": 33710015, "comment_id": 55191757, "body": "<a href=\"https://hackage.haskell.org/package/text-1.2.1.3/docs/Data-Text-Lazy-Builder.html\" rel=\"nofollow noreferrer\">Data.Text.Lazy.Builder</a>: &quot;Efficient construction of lazy Text values&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 3, "last_activity_date": 1447516032, "last_edit_date": 1592644375, "creation_date": 1447516032, "answer_id": 33710195, "question_id": 33710015, "link": "https://stackoverflow.com/questions/33710015/why-is-building-a-haskell-string-from-data-text-so-slow/33710195#33710195", "title": "Why is building a Haskell String from Data.Text so slow", "body": "<p>You can't make it as fast, but you can speed it up some.</p>\n<h3>Appending</h3>\n<p><code>Text</code> is represented as an array. This makes <code>&lt;&gt;</code> rather slow, because a new array has to be allocated and each <code>Text</code> copied into it. You can fix this by converting each piece to a <code>String</code> first, and then concatenating them. I imagine <code>Text</code> probably also offers an efficient way to concatenate multiple texts at once (as a <a href=\"https://stackoverflow.com/questions/33710015/why-is-building-a-haskell-string-from-data-text-so-slow/33710195#comment55191757_33710015\">commenter</a> mentions, you can use a lazy builder) but for this purpose that will be slower. Another good option might be the lazy version of <code>Text</code>, which probably supports efficient concatenation.</p>\n<h3>Sharing</h3>\n<p>In your <code>String</code>-based implementation, the <code>description</code> field doesn't have to be copied at all. It's just shared between the <code>Location</code> and the result of showing that <code>Location</code>. There's no way to accomplish this with the <code>Text</code> version.</p>\n"}, {"comments": [{"owner": {"reputation": 372, "user_id": 2722784, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/17935d19c83cba797a7c8e1470dc20bb?s=128&d=identicon&r=PG", "display_name": "Feenaboccles", "link": "https://stackoverflow.com/users/2722784/feenaboccles"}, "edited": false, "score": 0, "creation_date": 1447525604, "post_id": 33710346, "comment_id": 55194881, "body": "Doing this I find that the String version takes 700ns, and the Text version takes 2600ns, so the problem is clearly in the implementation of show, and not the evaluation - though it clearly helps to call length to ensure things are fully evaluated."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 3, "last_activity_date": 1447516966, "creation_date": 1447516966, "answer_id": 33710346, "question_id": 33710015, "link": "https://stackoverflow.com/questions/33710015/why-is-building-a-haskell-string-from-data-text-so-slow/33710346#33710346", "title": "Why is building a Haskell String from Data.Text so slow", "body": "<p>In the String case you are not fully evaluating all of the string operations - (++) and replicate.</p>\n\n<p>If you change your benchmark to:</p>\n\n<pre><code>benchmarks = [ bench \"show\" (whnf (length.show) l) ]\n</code></pre>\n\n<p>you'll see that the String case takes around 520 ns - approx 10 times longer.</p>\n"}], "owner": {"reputation": 372, "user_id": 2722784, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/17935d19c83cba797a7c8e1470dc20bb?s=128&d=identicon&r=PG", "display_name": "Feenaboccles", "link": "https://stackoverflow.com/users/2722784/feenaboccles"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "accepted_answer_id": 33710195, "answer_count": 2, "score": 3, "last_activity_date": 1447529966, "creation_date": 1447515079, "last_edit_date": 1447529966, "question_id": 33710015, "link": "https://stackoverflow.com/questions/33710015/why-is-building-a-haskell-string-from-data-text-so-slow", "title": "Why is building a Haskell String from Data.Text so slow", "body": "<p>So I had a location class</p>\n\n<pre><code>data Location = Location {\n    title :: String\n  , description :: String\n  }\n\ninstance Show Location where\n  show l = title l ++ \"\\n\"\n         ++ replicate (length $ title l) '-' ++ \"\\n\"\n         ++ description l\n</code></pre>\n\n<p>Then I changed it to use <code>Data.Text</code></p>\n\n<pre><code>data Location = Location {\n    title :: Text\n  , description :: Text\n  }\n\ninstance Show Location where\n  show l = T.unpack $\n    title l &lt;&gt; \"\\n\"\n    &lt;&gt; T.replicate (T.length $ title l) \"-\" &lt;&gt; \"\\n\"\n    &lt;&gt; description l\n</code></pre>\n\n<p>Using criterion, I benchmarked the time taken by <code>show</code> on both the <code>String</code> and <code>Data.Text</code> implementations:</p>\n\n<pre><code>benchmarks = [ bench \"show\" (whnf show l) ]\n  where l = Location {\n                title=\"My Title\"\n              , description = \"This is the description.\"\n              }\n</code></pre>\n\n<p>The <code>String</code> implementation took 34ns, the <code>Data.Text</code> implementation was almost <em>six times slower</em>, at 170ns</p>\n\n<p>How do I get <code>Data.Text</code> working as fast as <code>String</code>?</p>\n\n<p><strong>Edit: Silly mistakes</strong></p>\n\n<p>I'm not sure how this happened, but I cannot replicate the original speed difference: now for String and Text I get 28ns and 24ns respectively</p>\n\n<p>For the more aggressive <code>bench \"length.show\" (whnf (length . show) l)</code> benchmark, for String and Text, I get 467ns and 3954ns respectively.</p>\n\n<p>If I use a very basic lazy builder, without the replicated dashes</p>\n\n<pre><code>import qualified Data.Text.Lazy.Builder as Bldr\n\ninstance Show Location where\n  show l = show $\n    Bldr.fromText (title l) &lt;&gt; Bldr.singleton '\\n'\n  --  &lt;&gt; Bldr.fromText (T.replicate (T.length $ title l) \"-\") &lt;&gt; Bldr.singleton '\\n'\n    &lt;&gt; Bldr.fromText (description l)\n</code></pre>\n\n<p>and try the original, ordinary <code>show</code> benchmark, I get 19ns. Now this is buggy, as using <code>show</code> to convert a builder to a String will escape newlines. If I replace it with <code>LT.unpack $ Bldr.toLazyText</code>, where <code>LT</code> is a qualified import of <code>Data.Text.Lazy</code>, then I get 192ns. </p>\n\n<p>I'm testing this on a Mac laptop, and I suspect my timings are getting horribly corrupted by machine noise. Thanks for the guidance.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 6, "creation_date": 1447514850, "post_id": 33709921, "comment_id": 55191393, "body": "<code>type Colleagues = EmpPair</code> only creates a type synonym, not a data constructor synonym. So this is precisely the expected behaviour. Starting with GHC 7.8, you can do what you want with <a href=\"https://ghc.haskell.org/trac/ghc/wiki/PatternSynonyms\" rel=\"nofollow noreferrer\">pattern synonyms.</a>"}, {"owner": {"reputation": 4733, "user_id": 728407, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26b3f058ce75a05fd2ccc561f1cfa501?s=128&d=identicon&r=PG", "display_name": "Ashish Negi", "link": "https://stackoverflow.com/users/728407/ashish-negi"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1447516188, "post_id": 33709921, "comment_id": 55191874, "body": "cannot believe this.. i thought this to be so basic.."}, {"owner": {"reputation": 4733, "user_id": 728407, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26b3f058ce75a05fd2ccc561f1cfa501?s=128&d=identicon&r=PG", "display_name": "Ashish Negi", "link": "https://stackoverflow.com/users/728407/ashish-negi"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1447516259, "post_id": 33709921, "comment_id": 55191900, "body": "I have GHCi, version 7.8.3.. Do i need to do something else to enable this.."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1447516507, "post_id": 33709921, "comment_id": 55191988, "body": "Place <code>{-# LANGUAGE PatternSynonyms #-}</code> at the <i>top</i> of your source file, then define anywhere in your module: <code>pattern Colleagues x y = EmpPair x y</code>."}, {"owner": {"reputation": 4733, "user_id": 728407, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26b3f058ce75a05fd2ccc561f1cfa501?s=128&d=identicon&r=PG", "display_name": "Ashish Negi", "link": "https://stackoverflow.com/users/728407/ashish-negi"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1447516748, "post_id": 33709921, "comment_id": 55192060, "body": "I get on ghci ..<code>*Main&gt; Team (Colleagues &quot;Ashish&quot; &quot;Ajay&quot;) \\r\\n Team (EmpPair &quot;Ashish&quot; &quot;Ajay&quot;)</code>  I wished It would have printed &quot;Colleagues&quot; in its Show method of ghci.. Should not it ? Actually that was my actual curiosity behind writing this code in first place.."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1447517638, "post_id": 33709921, "comment_id": 55192337, "body": "No, it should not. If you would like a custom show instance for <code>Team</code>, you should not derive it. Just write it by hand."}, {"owner": {"reputation": 4733, "user_id": 728407, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26b3f058ce75a05fd2ccc561f1cfa501?s=128&d=identicon&r=PG", "display_name": "Ashish Negi", "link": "https://stackoverflow.com/users/728407/ashish-negi"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1447527220, "post_id": 33709921, "comment_id": 55195393, "body": "just last comment, do not understand why it should not.. Is their some logic ? It seems like &quot;type synonyms&quot; are like &quot;C macros&quot; that forget everything after they get replaced all over the source.. hope they would have more useful characteristics.. ?"}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1447544329, "post_id": 33709921, "comment_id": 55200263, "body": "@AshishNegi <code>type Colleagues = EmpPair</code> says that <code>Colleagues</code> is just another name for exactly the same type <code>EmpPair</code>. A type that displays differently via <code>show</code> is <i>not</i> the same type."}], "answers": [{"comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1447526661, "post_id": 33710217, "comment_id": 55195223, "body": "Most of your explanation is sound, but you are missing parentheses (or <code>$</code>) in <code>Team (EmpPair &quot;string1&quot; &quot;string2&quot;)</code>."}, {"owner": {"reputation": 4733, "user_id": 728407, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26b3f058ce75a05fd2ccc561f1cfa501?s=128&d=identicon&r=PG", "display_name": "Ashish Negi", "link": "https://stackoverflow.com/users/728407/ashish-negi"}, "edited": false, "score": 0, "creation_date": 1447529026, "post_id": 33710217, "comment_id": 55196015, "body": "Thanks.. but i am able to do it with <code>PatternSynonyms</code>.. Can you comment on that too ? Would you recommend this or pattern-synonyms ?"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 2, "last_activity_date": 1447543016, "last_edit_date": 1447543016, "creation_date": 1447516154, "answer_id": 33710217, "question_id": 33709921, "link": "https://stackoverflow.com/questions/33709921/unable-to-make-objects-with-type-synonyms-type/33710217#33710217", "title": "Unable to make objects with type synonyms : type", "body": "<p>The short answer is that you have to use something like:</p>\n\n<pre><code>Team (EmpPair \"string1\" \"string2\")\n</code></pre>\n\n<p>Haskell has separate name spaces for types and terms. That means a name may be defined as a type or as a term (a value or function) or as both, and the definitions may or may not be related to each other.</p>\n\n<p>In your code here is what each name is:</p>\n\n<pre><code>data Team = Team Colleagues\n      ^       ^       ^-- type\n    type     term\n\ntype Colleagues = EmpPair\n     type-^          ^-- type\n\ndata EmpPair = EmpPair EmpData EmpData\n   type-^        ^       ^        ^      \n               term     type    type\n</code></pre>\n\n<p>Compare this with an example of a multi-construtor type:</p>\n\n<pre><code>data Bool = True | False\n      ^       ^      ^\n    type     term   term\n</code></pre>\n\n<p>This says that to create a value of type Bool we can either use the function <code>True</code> or the function <code>False</code>.</p>\n\n<p>When there is only one constructor for a type the convention is to use the same name for the type and the constructor name - i.e. your Team type.\nHowever, there is no reason why you have to follow this. You could have decided to use, e.g.:</p>\n\n<pre><code>data Team = MakeTeam Colleagues\n</code></pre>\n\n<p>To create a value (term) of type Team, your original definition says we need to use the function <code>Team</code> with a value of type Colleagues.</p>\n\n<p>The definition of <code>Colleagues</code> says that the type Colleagues is the same as the type EmpPair.</p>\n\n<p>The definition for (the type) EmpPair says that to create a value of type EmpPair we need to use the function EmpPair with two values of type EmpData.</p>\n\n<p>The definition of EmpData says that the type EmpData is the same as the type String.</p>\n\n<p>Putting this all together, we can construct a value of type Team like this:</p>\n\n<pre><code>Team (EmpPair \"string1\" \"string2\")\n</code></pre>\n\n<p>You are getting the error message because Colleagues is not a term - it is only defined as a type.</p>\n\n<p><strong>Update</strong></p>\n\n<p>To answer your question in the comments about whether or not you should use PatternSynonyms, consider the following:</p>\n\n<ul>\n<li><p>PatternSynonyms are used in only about 35 packages (out of about 8400) on Hackage. Not only is it not used very much, but you can write a lot of useful code without it.</p></li>\n<li><p>Your particular use is very simple compared to other uses of PatternSynonyms. Most uses of PatternSynonyms are to create more elaborate layers of abstraction, but in this case you are just using it to create an alternate name for a constructor.</p></li>\n<li><p>You should ask yourself if you even want your users to have direct access to the Colleagues constructor. If you want to hide implementation details you are better off supplying alternatives for creating and accessing values within a Colleagues values, i.e. something like: </p>\n\n<pre><code>mkColleagues :: EmpData -&gt; EmpData -&gt; Colleagues\n...\n\nfirstColleague :: Colleagues -&gt; EmpData\n...\n\nsecondColleague :: Colleagues -&gt; EmpData\n...\n</code></pre></li>\n</ul>\n\n<p>Exposing only these functions potentially allows you to expand the Colleagues data type with additional fields without breaking the API.</p>\n"}], "owner": {"reputation": 4733, "user_id": 728407, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/26b3f058ce75a05fd2ccc561f1cfa501?s=128&d=identicon&r=PG", "display_name": "Ashish Negi", "link": "https://stackoverflow.com/users/728407/ashish-negi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 33710217, "answer_count": 1, "score": 1, "last_activity_date": 1447543016, "creation_date": 1447514516, "question_id": 33709921, "link": "https://stackoverflow.com/questions/33709921/unable-to-make-objects-with-type-synonyms-type", "title": "Unable to make objects with type synonyms : type", "body": "<p>I am reading \"Learn You A Haskell\" and in chapter <a href=\"http://%20http://learnyouahaskell.com/making-our-own-types-and-typeclasses\" rel=\"nofollow\">typeclasses</a>, i am playing with this code :</p>\n\n<pre><code>type EmpData = String\ndata EmpPair = EmpPair EmpData EmpData deriving (Show)\ntype Colleagues = EmpPair \ndata Team = Team Colleagues deriving (Show)\n</code></pre>\n\n<p>When i try to make an object of type <code>Team</code> , ghc gives :</p>\n\n<pre><code>*Main&gt; Team (Colleagues \"Ashish\" \"Ajay\")\n\n&lt;interactive&gt;:41:7: Not in scope: data constructor `Colleagues'\n</code></pre>\n\n<p>However, this is successful :</p>\n\n<pre><code>*Main&gt; Team (EmpPair \"Ashish\" \"Ajay\")\nTeam (EmpPair \"Ashish\" \"Ajay\")\n</code></pre>\n\n<p>I do not understand why is this happening ? Please explain.</p>\n"}, {"tags": ["haskell", "polymorphism", "field", "chess", "maybe"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1447514012, "post_id": 33709315, "comment_id": 55191110, "body": "You tried to use pattern syntax (<code>_</code>) in an expression, which would usually result in an error. However, <code>_</code> is now a &quot;valid expression&quot; as well, so the compile assumed you knew what you were doing and had intentionally placed the <code>_</code> there. In expression syntax, this is called a &quot;typed hole&quot; - basically, it is used for type directed programming, as the compiler spits out all the type information around that binding. The compiler should probably only recognize typed holes if they are enabled... otherwise it should give a parse/syntax error, to avoid confusion like this."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1447516312, "post_id": 33709315, "comment_id": 55191919, "body": "@user2407038, this confusion is rare, and avoiding it is not worth the inconvenience of making everyone enable an extension to use typed holes."}], "answers": [{"comments": [{"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 1, "creation_date": 1447511960, "post_id": 33709401, "comment_id": 55190520, "body": "this will fail to compile as the helper function is not in scope in the 2nd line"}, {"owner": {"reputation": 247, "user_id": 4572619, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh4.googleusercontent.com/-j-KVFCZUYuE/AAAAAAAAAAI/AAAAAAAAAXw/76TrGwYjMpw/photo.jpg?sz=128", "display_name": "Nicol&#225;s Siplis", "link": "https://stackoverflow.com/users/4572619/nicol%c3%a1s-siplis"}, "edited": false, "score": 0, "creation_date": 1447512225, "post_id": 33709401, "comment_id": 55190603, "body": "It also throws an error since  <code>n@(Just White _)</code> should be <code>n@(Just (Piece White _)</code>. However, fixing that and defining the helper function as a regular one worked! Out of curiosity, is there any way to define the helper function so that it remains inside of displaySquare? Googling about helper functions for multiple functions didn&#39;t seem to bring anything up."}, {"owner": {"reputation": 247, "user_id": 4572619, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh4.googleusercontent.com/-j-KVFCZUYuE/AAAAAAAAAAI/AAAAAAAAAXw/76TrGwYjMpw/photo.jpg?sz=128", "display_name": "Nicol&#225;s Siplis", "link": "https://stackoverflow.com/users/4572619/nicol%c3%a1s-siplis"}, "edited": false, "score": 0, "creation_date": 1447512973, "post_id": 33709401, "comment_id": 55190821, "body": "Answer works great! Using <code>case</code> makes it a lot more readable."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 247, "user_id": 4572619, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh4.googleusercontent.com/-j-KVFCZUYuE/AAAAAAAAAAI/AAAAAAAAAXw/76TrGwYjMpw/photo.jpg?sz=128", "display_name": "Nicol&#225;s Siplis", "link": "https://stackoverflow.com/users/4572619/nicol%c3%a1s-siplis"}, "edited": false, "score": 0, "creation_date": 1447527313, "post_id": 33709401, "comment_id": 55195431, "body": "@Nicol&#225;sSiplis You could also have kept the other guards (and avoiding moving the helper function) with a pattern guard: <code>| Just (Piece White _) &lt;- n</code> (standard since Haskell 2010)."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 5, "last_activity_date": 1447512655, "last_edit_date": 1447512655, "creation_date": 1447511016, "answer_id": 33709401, "question_id": 33709315, "link": "https://stackoverflow.com/questions/33709315/polymorphism-in-haskell-data-fields/33709401#33709401", "title": "Polymorphism in Haskell data fields", "body": "<p>This is the way to write <code>displaySquare</code> with pattern matching:</p>\n\n<pre><code>displaySquare Nothing = ' '\ndisplaySquare n@(Just (Piece White _)) = displaySquare' n\ndisplaySquare n                        = toLower (displaySquare' n)\n  where\n    ...your definition of displaySquare'...\n</code></pre>\n\n<p>You are using pattern matching correctly in your definition of <code>displaySquare'</code>.</p>\n\n<p>Note how the syntax <code>n@(Just (Piece White _))</code> works -- it provides a pattern to match against: <code>Just White _</code> and it also sets the variable <code>n</code> to the argument passed to the function.</p>\n\n<p><strong>Update</strong></p>\n\n<p>As @behzad.nouri mentions in the comments you'll need to put the helper function at the top level.</p>\n\n<p>Another way of writing it to keep the helper function local:</p>\n\n<pre><code>displaySquare n =\n  case n of\n    Nothing              -&gt; ' '\n    Just (Piece White _) -&gt; displaySquare' n\n    _                    -&gt; toLower (displaySquare' n)\n  where\n    displaySquare' x = ...\n</code></pre>\n\n<p>In this case <code>n</code> is bound to the first argument of <code>displaySquare</code> so you don't need to use the <code>n@...</code> syntax.</p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 1, "last_activity_date": 1490282444, "creation_date": 1490282444, "answer_id": 42980234, "question_id": 33709315, "link": "https://stackoverflow.com/questions/33709315/polymorphism-in-haskell-data-fields/42980234#42980234", "title": "Polymorphism in Haskell data fields", "body": "<p>The crucial thing is this: pattern matching works fundamentally different from equality comparison (and is usually much preferrable)!</p>\n\n<p>By pattern matching, you only look at whether a piece data \u201cfits some rough shape you're interested in\u201d. You may completely ignore parts of the data you're <em>not</em> interested in, as you tried with <code>Just (Piece White _)</code>. Pattern matching is thus generally a \u201cfuzzy operation\u201d.</p>\n\n<p>OTOH, <code>==</code> is just an operator (<a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Eq.html#v:-61--61-\" rel=\"nofollow noreferrer\">library-defined function</a>) which takes two values and determines whether they are <em>exactly equal</em>.  <code>Piece White _</code> is not actually a value, you'd need to give a concrete <code>PieceType</code> to fit the <code>_</code> gap. And that's what GHC tries to tell you with that message <code>Found hole \u2018_\u2019 with type: PieceType</code>: if you actually needed to build up a <code>Square</code> value, you would need to supply a <code>PieceType</code> value. Those typed holes are mighty useful when you're juggling with complex problems: just start out from the outside, e.g. you might start with <code>n == Piece _ _</code>, GHC would tell you it expects in the first gap a <code>PieceColor</code>, you'd insert <code>White</code>, GHC would tell you it expects in the second gap a <code>PieceType</code>, etc..</p>\n\n<p>Just, in the <code>displaySquare</code> function it doesn't really make sense to actually construct a concrete <code>Square</code> value to compare against: what you really want to do is <em>deconstructing</em> such values. And that's where pattern matching is much more handy. In fact, I'd write that function as a single big list of clauses:</p>\n\n<pre><code>displaySquare (Just (Piece White King))   = '\u2654'\ndisplaySquare (Just (Piece White Queen))  = '\u2655'\ndisplaySquare (Just (Piece White Rook))   = '\u2656'\ndisplaySquare (Just (Piece White Bishop)) = '\u2657'\ndisplaySquare (Just (Piece White Knight)) = '\u2658'\ndisplaySquare (Just (Piece White Pawn))   = '\u2659'\ndisplaySquare (Just (Piece Black pt))\n   = toEnum . (+6)  -- Unicode U+2659 WHITE CHESS PAWN\n                    --  is followed by BLACK CHESS KING, etc.\n      . fromEnum . displaySquare . Just $ Piece White pt\ndisplaySquare Nothing = ' '\n</code></pre>\n"}], "owner": {"reputation": 247, "user_id": 4572619, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh4.googleusercontent.com/-j-KVFCZUYuE/AAAAAAAAAAI/AAAAAAAAAXw/76TrGwYjMpw/photo.jpg?sz=128", "display_name": "Nicol&#225;s Siplis", "link": "https://stackoverflow.com/users/4572619/nicol%c3%a1s-siplis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "accepted_answer_id": 33709401, "answer_count": 2, "score": 1, "last_activity_date": 1490282444, "creation_date": 1447510472, "last_edit_date": 1490277360, "question_id": 33709315, "link": "https://stackoverflow.com/questions/33709315/polymorphism-in-haskell-data-fields", "title": "Polymorphism in Haskell data fields", "body": "<p>I'm trying to learn Haskell by creating a simple Chess game. However, I'm having trouble defining the function that represents a square of the board   </p>\n\n<pre><code>import Data.Char\ntype Board = [[Square]]\ntype Square = Maybe Piece\ndata Piece = Piece PieceColor PieceType deriving (Show, Eq)\ndata PieceColor = White | Black deriving (Show, Eq)\ndata PieceType = King | Queen | Rook | Bishop | Knight | Pawn deriving (Show, Eq)\n\n...    \n\ndisplaySquare :: Square -&gt; Char\n    displaySquare n\n        | n == Nothing = ' '\n        | n == Just (Piece White _) = displaySquare' n\n        | otherwise = toLower (displaySquare' n)\n            where\n                displaySquare'   (Just (Piece _ King))   = 'K'\n                displaySquare'   (Just (Piece _ Queen))  = 'Q'\n                displaySquare'   (Just (Piece _ Rook))   = 'R'\n                displaySquare'   (Just (Piece _ Bishop)) = 'B'\n                displaySquare'   (Just (Piece _ Knight)) = 'N'\n                displaySquare'   (Just (Piece _ Pawn))   = 'P'\n</code></pre>\n\n<p>Trying to run GHCI returns the following error:</p>\n\n<pre><code>Chess.hs:21:30:\n    Found hole \u2018_\u2019 with type: PieceType\n    Relevant bindings include\n      displaySquare' :: Maybe Piece -&gt; Char (bound at Chess.hs:24:13)\n      n :: Square (bound at Chess.hs:19:15)\n      displaySquare :: Square -&gt; Char (bound at Chess.hs:19:1)\n    In the second argument of \u2018Piece\u2019, namely \u2018_\u2019\n    In the first argument of \u2018Just\u2019, namely \u2018(Piece White _)\u2019\n    In the second argument of \u2018(==)\u2019, namely \u2018Just (Piece White _)\u2019\nFailed, modules loaded: none.\n</code></pre>\n\n<p>I'm not exactly sure what the error is trying to tell me. If I had to guess, I'd say the problem is defining a data field as a hole '_', since that means the function could take any type as a data field, which obviously conflicts with the type signature given. Is my assumption correct, and how should I go about solving it?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "edited": false, "score": 0, "creation_date": 1447508325, "post_id": 33708940, "comment_id": 55189529, "body": "hello, you&#39;re right, but how can I test if the list is infinite or no? (I will have a look at this question in the next few hours but if you know a answer, you can share it!).an idea : mark the list as finite with a boolean. what do you think about this? Is there a prettier answer?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "edited": false, "score": 0, "creation_date": 1447509475, "post_id": 33708940, "comment_id": 55189881, "body": "There is no way to check if a list is infinite."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "edited": false, "score": 1, "creation_date": 1447513560, "post_id": 33708940, "comment_id": 55190977, "body": "The decimal digits of 1/d always eventually repeat, and the cycle length is always &lt;= d. And the prefix before the cycle begins also has length &lt;= d. So there is no need to consider infinite lists."}, {"owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "edited": false, "score": 0, "creation_date": 1447609049, "post_id": 33708940, "comment_id": 55215111, "body": "hello, do you know why the length of the cycle is always &lt;=d?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "edited": false, "score": 0, "creation_date": 1447615124, "post_id": 33708940, "comment_id": 55217163, "body": "because for each decimal digit in the quotient you get a remainder mod d, and once you encounter the same remainder you have a cycle."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 2, "last_activity_date": 1447507957, "creation_date": 1447507957, "answer_id": 33708940, "question_id": 33708820, "link": "https://stackoverflow.com/questions/33708820/26th-euler-project-in-haskell-process-stopped/33708940#33708940", "title": "26th Euler project in Haskell : &quot;process stopped&quot;", "body": "<p>Your problem is that <code>liste 370</code> produces an infinite list, and you're trying to to take the length of it in <code>longeur</code>:</p>\n\n<pre><code>longeur i =\n  let ...\n      laliste = liste i\n      ...\n  in if (length laliste &lt; maxRecherche)\n       ...\n</code></pre>\n\n<p>Most likely the process terminates because it runs out of memory.</p>\n"}], "owner": {"reputation": 1481, "user_id": 1766495, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/7f0952fdd4c1c33e3d6c07b6ea651ff8?s=128&d=identicon&r=PG&f=1", "display_name": "lolveley", "link": "https://stackoverflow.com/users/1766495/lolveley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1591263073, "creation_date": 1447507078, "last_edit_date": 1591263073, "question_id": 33708820, "link": "https://stackoverflow.com/questions/33708820/26th-euler-project-in-haskell-process-stopped", "title": "26th Euler project in Haskell : &quot;process stopped&quot;", "body": "<p>I'm trying to solve the <a href=\"https://projecteuler.net/problem=26\" rel=\"nofollow noreferrer\">26th Project Euler problem</a> and I wrote something which compiles fine but when I launch it I get an error.</p>\n\n<p>The program is:</p>\n\n<pre><code>module Main where\n\nimport Data.List (maximumBy, unfoldr)\n\nliste :: Int -&gt; [(Int,Int)]\nliste i = unfoldr \u00e9tape (1,i)\n  where \u00e9tape (n,m) = if mod (n*10) m == 0 \n                      then Nothing \n                      else Just ((mod (n*10) m, div (n*10) m), (mod (n*10) m, i))\n\nlongueur :: Int -&gt; Maybe Int\nlongueur i =\n  let maxRecherche = 5000\n      laListe = liste i\n      assignAttribute :: Int -&gt; Maybe Int\n      assignAttribute j = if ((laListe !! j) == (laListe !! maxRecherche)) \n                          then Just (maxRecherche - j)\n                          else if (j==1) then Nothing\n                               else assignAttribute(j-1)\n  in if (length laListe &lt; maxRecherche)\n     then Nothing\n     else assignAttribute(maxRecherche-1) \n                          -- \u00e9l\u00e9ments compar\u00e9s \u00e0 maxRacherche, dv dc etre avant (a=a)\nmain :: IO()\nmain = do\n  putStrLn \"hello\"\n  let longueur370 = longueur 370\n  putStrLn $ \"370 : \" ++ show longueur370\n  let longueurs = Data.List.maximumBy tri $ map (\\i -&gt; (i,longueur i)) [1..1000]\n  putStrLn $ \"resultats : \" ++ (show longueurs)\n    where tri (_,Nothing)(_,Nothing) = EQ\n          tri (_,Nothing)(_,_) = LT\n          tri (_,_)(_,Nothing) = GT\n          tri (_,Just u)(_,Just v) = compare u v\n</code></pre>\n\n<p>Here are some short explanations :</p>\n\n<ul>\n<li>the function <code>liste</code> creates an infinite list of pairs, a pair containing (rest,digit) where rest and digit are the result of the computation of the i-th digit of 1/n (see the Project Euler for why I'm computing 1/n)\nthis function seems to work well, as proved by the test with 370.</li>\n<li>the function <code>longueur</code> extract the 5000 first pairs and try to find the length of any cycle. I assumed that the 5000th pair is contained in a possible cycle ie the cycle has already begun. Note that it's totally empiric but the 1/n to compute are limited to [1..1000], which is not very huge. Finally, all this is a little complicated by the fact that a list of pairs can stop if there is no cycle.   </li>\n</ul>\n\n<p>The error is given by the OS: after some minutes, I get the message \"processus stopped\"...</p>\n\n<h2>Edit</h2>\n\n<p>I found how to make it : I test if the list contains a given number of elements, by dropping this number of elements, and checking the list remaining is not null.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1398, "user_id": 601409, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9ec12784ac7ae1a91bd223ae176a5244?s=128&d=identicon&r=PG&f=1", "display_name": "EkcenierK", "link": "https://stackoverflow.com/users/601409/ekcenierk"}, "edited": false, "score": 0, "creation_date": 1447497433, "post_id": 33707468, "comment_id": 55186818, "body": "So what input args are you using? This is what gets assigned to xs. Please paste the whole run command."}, {"owner": {"reputation": 1316, "user_id": 2304212, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/217cbdae046a33da5633c7982463104c?s=128&d=identicon&r=PG", "display_name": "PepeHands", "link": "https://stackoverflow.com/users/2304212/pepehands"}, "reply_to_user": {"reputation": 1398, "user_id": 601409, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/9ec12784ac7ae1a91bd223ae176a5244?s=128&d=identicon&r=PG&f=1", "display_name": "EkcenierK", "link": "https://stackoverflow.com/users/601409/ekcenierk"}, "edited": false, "score": 0, "creation_date": 1447497567, "post_id": 33707468, "comment_id": 55186861, "body": "@KLibby for example <code>$ .&#47;run my_string any_argument</code> this is exactly what I tiped"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1447498640, "post_id": 33707468, "comment_id": 55187126, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/28553559/infinite-loop-in-haskell-when-binding-variables\">infinite loop in Haskell when binding variables</a>"}, {"owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "edited": false, "score": 2, "creation_date": 1447499286, "post_id": 33707468, "comment_id": 55187262, "body": "You should compile with <code>-Wall</code>; when you do, the compiler will warn you when these things happen. And just a by the way: instead of binding the head and then the tail you can just pattern match the <code>_:_</code> constructor. It&#39;s easier to write and if you do, the compiler will also warn you about the second potential problem in your code (inexhaustive pattern match -- what if <code>xs</code> is <code>[]</code>?). And besides that incomplete functions like <code>head</code> &amp; <code>tail</code> are just bad :P"}, {"owner": {"reputation": 1316, "user_id": 2304212, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/217cbdae046a33da5633c7982463104c?s=128&d=identicon&r=PG", "display_name": "PepeHands", "link": "https://stackoverflow.com/users/2304212/pepehands"}, "reply_to_user": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "edited": false, "score": 0, "creation_date": 1447499824, "post_id": 33707468, "comment_id": 55187381, "body": "@MasterMastic thanks, I did not know that <code>-Wall</code> exists in haskell."}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 6, "last_activity_date": 1447497768, "last_edit_date": 1447497768, "creation_date": 1447497610, "answer_id": 33707501, "question_id": 33707468, "link": "https://stackoverflow.com/questions/33707468/getting-loop-message-when-run-haskell-programme/33707501#33707501", "title": "getting &lt;&lt;loop&gt;&gt; message when run haskell programme", "body": "<p>to you see the part where you declare</p>\n\n<pre><code>let xs = tail xs\n</code></pre>\n\n<p>this says you want <code>xs</code> to be a list that is the <em>tail of itself</em> and this causes an infinte loop (which ghc seems to notice ;)) (seen as an definition every constant list <code>repeat c</code> would suffice here - technically of course you just get a plain infinite-loop)</p>\n\n<p>so just change it to something like</p>\n\n<pre><code>main :: IO ()\nmain = do\n    xs &lt;- getArgs\n    let str = head xs\n    let xs' = tail xs\n    f str xs'\n    return ()\n</code></pre>\n\n<p>and your code should work as expected ;)</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1447499128, "creation_date": 1447499128, "answer_id": 33707713, "question_id": 33707468, "link": "https://stackoverflow.com/questions/33707468/getting-loop-message-when-run-haskell-programme/33707713#33707713", "title": "getting &lt;&lt;loop&gt;&gt; message when run haskell programme", "body": "<p>Others have already answered. I just want to add that enabling warnings will point out redefinitions of existing bindings. This also covers this kind of unwanted recursion:</p>\n\n<pre><code>&gt; :set -Wall\n&gt; xs &lt;- return [1..10::Int]\n&gt; let xs = tail xs\n\n&lt;interactive&gt;:11:5: Warning:\n    This binding for \u2018xs\u2019 shadows the existing binding\n      defined at &lt;interactive&gt;:10:1\n</code></pre>\n\n<p>Now, one could think \"but in this case I <em>really</em> intend to shadow the previous binding\", and would be completely correct. Still, renaming the new binding incidentally avoids the problem.</p>\n\n<p>One more reason to add <code>{-# OPTIONS -Wall #-}</code> at the top of your source file.\n(Or enabling warning in your .cabal file, or whatever other build system)</p>\n"}], "owner": {"reputation": 1316, "user_id": 2304212, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/217cbdae046a33da5633c7982463104c?s=128&d=identicon&r=PG", "display_name": "PepeHands", "link": "https://stackoverflow.com/users/2304212/pepehands"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 33707501, "answer_count": 2, "score": 1, "last_activity_date": 1447499128, "creation_date": 1447497238, "question_id": 33707468, "link": "https://stackoverflow.com/questions/33707468/getting-loop-message-when-run-haskell-programme", "title": "getting &lt;&lt;loop&gt;&gt; message when run haskell programme", "body": "<p>I have written code like this</p>\n\n<pre><code>import System.Environment\nimport Control.Exception\nimport Data.List\n\nf :: String -&gt; [String] -&gt; IO ()\nf str []       =\n    putStrLn \"String 2\"\nf str (x : xs) =\n    putStrLn \"String 1\"\n\nmain :: IO ()\nmain = do\n    xs &lt;- getArgs\n    let str = head xs\n    let xs = tail xs\n    f str xs\n    return ()\n</code></pre>\n\n<p>but when I compile it and trying to run I always have only answer <code>&lt;&lt;loop&gt;&gt;</code></p>\n\n<pre><code>ghc run.hs\n./run some_string some_over_arguments\nrun: &lt;&lt;loop&gt;&gt;\n</code></pre>\n\n<p>What's wrong with this code? I've tryed to hoogle <code>&lt;&lt;loop&gt;&gt;</code> but found nothing. If I pass to <code>f</code> not <code>str xs</code> but <code>str [some_hardcoded_list]</code> this code works fine, so I guess this is something wrong with <code>xs</code>.</p>\n"}, {"tags": ["haskell", "hunit", "hspec"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1447512402, "post_id": 33707030, "comment_id": 55190660, "body": "What about <code>map (&quot;toHit&quot; ~:)</code>? I haven&#39;t tested it but it seems like it would work."}], "answers": [{"comments": [{"owner": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "edited": false, "score": 0, "creation_date": 1447520313, "post_id": 33709149, "comment_id": 55193227, "body": "Yeah, I did something very similar to this one!"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 1, "last_activity_date": 1447509258, "creation_date": 1447509258, "answer_id": 33709149, "question_id": 33707030, "link": "https://stackoverflow.com/questions/33707030/running-hunit-tests-with-hspec/33709149#33709149", "title": "Running HUnit tests with Hspec", "body": "<p>How about attaching labels to all the tests with a function like:</p>\n\n<pre><code>label ts =\n  [ show i ~: t | (i,t) &lt;- zip [(1::Int)..] ts ]\n</code></pre>\n\n<p>Just prefix your list of tests with a call to <code>label</code>:</p>\n\n<pre><code>spec :: Spec\nspec = do\n    fromHUnitTest (\"SHC.Lix\" ~: \"toHit\" ~:\n        label\n        [ Irrelevant @=? toHit []\n        , None       @=? toHit [False]\n        ...\n</code></pre>\n"}], "owner": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 33709149, "answer_count": 1, "score": 0, "last_activity_date": 1447509258, "creation_date": 1447493916, "question_id": 33707030, "link": "https://stackoverflow.com/questions/33707030/running-hunit-tests-with-hspec", "title": "Running HUnit tests with Hspec", "body": "<p>I want to run HUnit tests inside a spec:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>module SHCSpec (spec)\n    where\n\nimport Test.Hspec\nimport Test.Hspec.Contrib.HUnit\nimport Test.HUnit\n\nimport SHC.Types\nimport SHC.Lix\n\n\nspec :: Spec\nspec = do\n    fromHUnitTest (\"SHC.Lix\" ~: \"toHit\" ~:\n        [ Irrelevant @=? toHit []\n        , None       @=? toHit [False]\n        , None       @=? toHit [False, False]\n        , Partial    @=? toHit [False, True]\n        , Partial    @=? toHit [True, False]\n        , Partial    @=? toHit [False, False, True]\n        , Partial    @=? toHit [False, True, False]\n        , Partial    @=? toHit [True, False, False]\n        , Full       @=? toHit [True]\n        , Full       @=? toHit [True, True]\n        ])\n</code></pre>\n\n<p>The above code works, but it produces this ugly output:</p>\n\n<pre><code>SHC\n  SHC.Lix\n    toHit\n      &lt;unlabeled&gt;\n      &lt;unlabeled&gt;\n      &lt;unlabeled&gt;\n      &lt;unlabeled&gt;\n      &lt;unlabeled&gt;\n      &lt;unlabeled&gt;\n      &lt;unlabeled&gt;\n      &lt;unlabeled&gt;\n      &lt;unlabeled&gt;\n      &lt;unlabeled&gt;\n</code></pre>\n\n<p>Is it possible to attach the label <code>toHit</code> to every test case? Something like this:</p>\n\n<pre><code>SHC\n  SHC.Lix\n    toHit\n    toHit\n    toHit\n    toHit\n    toHit\n    toHit\n    toHit\n    toHit\n    toHit\n    toHit\n</code></pre>\n\n<p>Even better would be to append a number to each <code>toHit</code> case. I messed with <code>TestList</code> and <code>map TestLabel</code> to no avail.</p>\n"}, {"tags": ["haskell", "monads", "monad-transformers"], "answers": [{"comments": [{"owner": {"reputation": 14194, "user_id": 732016, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d2eb40aff994d83e1d271a3543efb22?s=128&d=identicon&r=PG", "display_name": "wchargin", "link": "https://stackoverflow.com/users/732016/wchargin"}, "edited": false, "score": 0, "creation_date": 1447563877, "post_id": 33706979, "comment_id": 55203788, "body": "You&#39;re right that I &quot;want the stateful bit outermost&quot; (in particular, this is because identifier lookup can fail depending on the state), but I don&#39;t understand how using <code>ExceptT String (State Store)</code> instead of <code>StateT Store (Either String)</code> accomplishes this. In fact, <a href=\"http://stackoverflow.com/a/5076096/732016\">this post seems to suggest otherwise</a> as well. Could you please explain?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 14194, "user_id": 732016, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d2eb40aff994d83e1d271a3543efb22?s=128&d=identicon&r=PG", "display_name": "wchargin", "link": "https://stackoverflow.com/users/732016/wchargin"}, "edited": false, "score": 1, "creation_date": 1447564481, "post_id": 33706979, "comment_id": 55203906, "body": "Just keep expanding newtypes until you get something at the base. You&#39;ll see the difference pretty quick: <code>ExceptT String (State Store) a</code> expands to <code>Store -&gt; (Store, Either String a)</code> while <code>StateT Store (Except String) a</code> expands to <code>Store -&gt; Either String (Store, a)</code>. Which you want is up to you, of course."}, {"owner": {"reputation": 14194, "user_id": 732016, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d2eb40aff994d83e1d271a3543efb22?s=128&d=identicon&r=PG", "display_name": "wchargin", "link": "https://stackoverflow.com/users/732016/wchargin"}, "edited": false, "score": 0, "creation_date": 1447611520, "post_id": 33706979, "comment_id": 55215974, "body": "One last question\u2014it seems that <code>Control.Monad.Error</code> is deprecated, but <code>Control.Monad.Error.Class</code> is not; is that correct? (I&#39;m not able to find any <code>Control.Monad.Except.Class</code>.)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 14194, "user_id": 732016, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d2eb40aff994d83e1d271a3543efb22?s=128&d=identicon&r=PG", "display_name": "wchargin", "link": "https://stackoverflow.com/users/732016/wchargin"}, "edited": false, "score": 1, "creation_date": 1447612091, "post_id": 33706979, "comment_id": 55216149, "body": "@WChargin Yep, <code>C.M.E.Class</code> is fine."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 13, "last_activity_date": 1447493448, "creation_date": 1447493448, "answer_id": 33706979, "question_id": 33705941, "link": "https://stackoverflow.com/questions/33705941/how-can-i-work-in-nested-monads-cleanly/33706979#33706979", "title": "How can I work in nested monads cleanly?", "body": "<p>This is what monad transformers are for. There is a <code>StateT</code> transformer to add state to a stack, and an <code>EitherT</code> transformer to add <code>Either</code>-like failure to a stack; however, I prefer <code>ExceptT</code> (which adds <code>Except</code>-like failure), so I will give my discussion in terms of that. Since you want the stateful bit outermost, you should use <code>ExceptT e (State s)</code> as your monad.</p>\n\n<pre><code>type DSL = ExceptT String (State Store)\n</code></pre>\n\n<p>Note that the stateful operations can be spelled <code>get</code> and <code>put</code>, and these are polymorphic over all instances of <code>MonadState</code>; so that in particular they will work okay in our <code>DSL</code> monad. Similarly, the canonical way to raise an error is <code>throwError</code>, which is polymorphic over all instances of <code>MonadError String</code>; and in particular will work okay in our <code>DSL</code> monad.</p>\n\n<p>So now we would write</p>\n\n<pre><code>eval :: Environment -&gt; Expression -&gt; DSL Value\neval _ (Literal v) = return v\neval e (Binary op l r) = liftM2 (applyBinop op) (eval e l) (eval e r)\n</code></pre>\n\n<p>You might also consider giving <code>eval</code> a more polymorphic type; it could return an <code>(MonadError String m, MonadState Store m) =&gt; m Value</code> instead of a <code>DSL Value</code>. In fact, for <code>allocateMany</code>, it's important that you give it a polymorphic type:</p>\n\n<pre><code>allocateMany :: MonadState Store m =&gt; Int -&gt; Value -&gt; m Address\n</code></pre>\n\n<p>There's two pieces of interest about this type: first, because it is polymorphic over all <code>MonadState Store m</code> instances, you can be just as sure that it only has stateful side effects as if it had the type <code>Int -&gt; Value -&gt; State Store Address</code> that you suggested. However, also because it is polymorphic, it can be specialized to return a <code>DSL Address</code>, so it can be used in (for example) <code>eval</code>. Your example <code>eval</code> code becomes this:</p>\n\n<pre><code>eval env (NewArrayC len el) = do\n    lenVal &lt;- eval env len\n    elVal  &lt;- eval env el\n    case lenVal of\n        NumV lenNum -&gt; allocateMany lenNum elVal\n        _           -&gt; throwError \"expected number in new-array length\"\n</code></pre>\n\n<p>I think that's quite readable, really; nothing too extraneous there.</p>\n"}], "owner": {"reputation": 14194, "user_id": 732016, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d2eb40aff994d83e1d271a3543efb22?s=128&d=identicon&r=PG", "display_name": "wchargin", "link": "https://stackoverflow.com/users/732016/wchargin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 1, "accepted_answer_id": 33706979, "answer_count": 1, "score": 14, "last_activity_date": 1447520470, "creation_date": 1447483825, "last_edit_date": 1447520470, "question_id": 33705941, "link": "https://stackoverflow.com/questions/33705941/how-can-i-work-in-nested-monads-cleanly", "title": "How can I work in nested monads cleanly?", "body": "<p>I'm writing an interpreter for a small language.\nThis language supports mutation, so its evaluator keeps track of a <code>Store</code> for all the variables (where <code>type Store = Map.Map Address Value</code>, <code>type Address = Int</code>, and <code>data Value</code> is a language-specific ADT).</p>\n\n<p>It's also possible for computations to fail (e.g., dividing by zero), so the result has to be an <code>Either String Value</code>.</p>\n\n<p>The type of my interpreter, then, is</p>\n\n<pre><code>eval :: Environment -&gt; Expression -&gt; State Store (Either String Value)\n</code></pre>\n\n<p>where <code>type Environment = Map.Map Identifier Address</code> keeps track of local bindings.</p>\n\n<p>For example, interpreting a constant literal doesn't need to touch the store, and the result always succeeds, so</p>\n\n<pre><code>eval _ (LiteralExpression v) = return $ Right v\n</code></pre>\n\n<p>But when we apply a binary operator, we do need to consider the store.\nFor example, if the user evaluates <code>(+ (x &lt;- (+ x 1)) (x &lt;- (+ x 1)))</code> and <code>x</code> is initially <code>0</code>, then the final result should be <code>3</code>, and <code>x</code> should be <code>2</code> in the resulting store.\nThis leads to the case</p>\n\n<pre><code>eval env (BinaryOperator op l r) = do\n    lval &lt;- eval env l\n    rval &lt;- eval env r\n    return $ join $ liftM2 (applyBinop op) lval rval\n</code></pre>\n\n<p>Note that the <code>do</code>-notation is working within the <code>State Store</code> monad.\nFurthermore, the use of <code>return</code> is monomorphic in <code>State Store</code>, while the uses of <code>join</code> and <code>liftM2</code> are monomorphic in the <code>Either String</code> monad.\nThat is, here we use</p>\n\n<pre><code>(return . join) :: Either String (Either String Value) -&gt; State Store (Either String Value)\n</code></pre>\n\n<p>and <code>return . join</code> is not a no-op.</p>\n\n<p>(As is evident, <code>applyBinop :: Identifier -&gt; Value -&gt; Value -&gt; Either String Value</code>.)</p>\n\n<p>This seems confusing at best, and this is a relatively simple case.\nThe case of function application, for example, is considerably more complicated.</p>\n\n<p>What useful best practices should I know about to keep my code readable\u2014and writable?</p>\n\n<p><strong>EDIT:</strong> Here's a more typical example, which better showcases the ugliness.\nThe <code>NewArrayC</code> variant has parameters <code>length :: Expression</code> and <code>element :: Expression</code> (it creates an array of a given length with all elements initialized to a constant).\nA simple example is <code>(newArray 3 \"foo\")</code>, which yields <code>[\"foo\", \"foo\", \"foo\"]</code>, but we could also write <code>(newArray (+ 1 2) (concat \"fo\" \"oo\"))</code>, because we can have arbitrary expressions in a <code>NewArrayC</code>.\nBut when we actually call</p>\n\n<pre><code>allocateMany :: Int -&gt; Value -&gt; State Store Address,\n</code></pre>\n\n<p>which takes the number of elements to allocate and the value for each slot, and returns the starting address, we need to unpack those values.\nIn the logic below, you can see that I'm duplicating a bunch of logic that should be built-in to the <code>Either</code> monad.\nAll the <code>case</code>s should just be binds.</p>\n\n<pre><code>eval env (NewArrayC len el) = do\n    lenVal &lt;- eval env len\n    elVal &lt;- eval env el\n    case lenVal of\n        Right (NumV lenNum) -&gt; case elVal of\n            Right val   -&gt; do\n                addr &lt;- allocateMany lenNum val\n                return $ Right $ ArrayV addr lenNum  -- result data type\n            left        -&gt; return left\n        Right _             -&gt; return $ Left \"expected number in new-array length\"\n        left                -&gt; return left\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": false, "score": 1, "last_activity_date": 1447485307, "creation_date": 1447485307, "answer_id": 33706072, "question_id": 33705754, "link": "https://stackoverflow.com/questions/33705754/section-of-importing-functions-in-haskell-is-called/33706072#33706072", "title": "Section of Importing functions in Haskell is called?", "body": "<p>The <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch5.html#x11-980005\" rel=\"nofollow\">Haskell 2010 Language Report</a> just calls it a \"list of import declarations\".</p>\n\n<p>Also, there are at least two (optional) sections that commonly come earlier: a list of language extension pragmas, and the module header with the export list.</p>\n"}], "owner": {"reputation": 785, "user_id": 4626332, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/aef1ae6850c8c49825ee336fd864b4c9?s=128&d=identicon&r=PG&f=1", "display_name": "Amar", "link": "https://stackoverflow.com/users/4626332/amar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1447510458, "creation_date": 1447482118, "last_edit_date": 1447510458, "question_id": 33705754, "link": "https://stackoverflow.com/questions/33705754/section-of-importing-functions-in-haskell-is-called", "title": "Section of Importing functions in Haskell is called?", "body": "<p>As we import other modules in Haskell by using <strong>import</strong> key word. It is the first section in the Haskell file then the body section starts. Can anyone tell me the name of <strong>importing modules section</strong>?</p>\n\n<pre><code>import Hugs.Prelude    \nimport Char \n</code></pre>\n"}]