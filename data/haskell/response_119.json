[{"tags": ["haskell", "monads", "monad-transformers"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1492634133, "post_id": 43505543, "comment_id": 74065829, "body": "You may be looking for continuation monads <code>Cont</code> and <code>ContT</code>."}, {"owner": {"reputation": 1780, "user_id": 4168972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc92e82d2eb21eb030d4c133c70ff554?s=128&d=identicon&r=PG&f=1", "display_name": "David Fletcher", "link": "https://stackoverflow.com/users/4168972/david-fletcher"}, "edited": false, "score": 4, "creation_date": 1492634668, "post_id": 43505543, "comment_id": 74066152, "body": "It looks to me like what you&#39;re asking for would break referential transparency - in <code>doTwoSteps</code> if you replace each <code>doStuff</code> with its definition, you&#39;ve changed the behaviour."}, {"owner": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1492634847, "post_id": 43505543, "comment_id": 74066250, "body": "@Alec any chance you could show me how to use ContT in my extended example?"}, {"owner": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "reply_to_user": {"reputation": 1780, "user_id": 4168972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc92e82d2eb21eb030d4c133c70ff554?s=128&d=identicon&r=PG&f=1", "display_name": "David Fletcher", "link": "https://stackoverflow.com/users/4168972/david-fletcher"}, "edited": false, "score": 0, "creation_date": 1492634928, "post_id": 43505543, "comment_id": 74066297, "body": "@DavidFletcher Maybe, I&#39;m doing the actions for the side effects. Also, in the real example the steps are different."}], "answers": [{"comments": [{"owner": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "edited": false, "score": 0, "creation_date": 1492638505, "post_id": 43506405, "comment_id": 74068009, "body": "Cool, thanks. But then I run into the mtl restriction on having more than one ExceptT in the stack, right? There&#39;s no way to get this to work with my extended example?"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "edited": false, "score": 0, "creation_date": 1492638878, "post_id": 43506405, "comment_id": 74068174, "body": "@SeanClarkHess: Sorry, I don\u2019t use <code>mtl</code>, so I\u2019m not sure about workarounds, but maybe the <code>ContT</code> example I added will help."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "edited": false, "score": 5, "creation_date": 1492643288, "post_id": 43506405, "comment_id": 74069660, "body": "@SeanClarkHess mtl does not place a restriction on having only one <code>ExceptT</code> in your stack. You can only &quot;access&quot; the top one with <code>MonadError</code>-polymorphic functions, but you&#39;re allowed to have as many as you want. I mention this in particular because it could be sensible to make your own newtype of <code>ExceptT</code> which exposes a <code>MonadEarlyExit</code> interface (which you invent and implement) but defers <code>MonadError</code> implementations to the underlying monad."}, {"owner": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "edited": false, "score": 0, "creation_date": 1492710857, "post_id": 43506405, "comment_id": 74106386, "body": "That is a great idea. I&#39;ve never tried newtyping another transformer."}], "tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": true, "score": 6, "last_activity_date": 1492638665, "last_edit_date": 1492638665, "creation_date": 1492637396, "answer_id": 43506405, "question_id": 43505543, "link": "https://stackoverflow.com/questions/43505543/skip-the-remaining-actions-in-a-monad-like-return/43506405#43506405", "title": "Skip the remaining actions in a monad - like return", "body": "<p>You can do this with <code>ExceptT</code> if you\u2019re willing to wrap the scope from which you want to be able to exit:</p>\n\n<pre><code>type EarlyReturnT m a = ExceptT a m a\n\nwithEarlyReturn :: (Functor m) =&gt; EarlyReturnT m a -&gt; m a\nwithEarlyReturn = fmap (either id id) . runExceptT\n\nearlyReturn :: (Applicative m) =&gt; a -&gt; EarlyReturnT m a\nearlyReturn = ExceptT . pure . Left\n</code></pre>\n\n<p>For example:</p>\n\n<pre><code>doStuff :: Bool -&gt; IO String\ndoStuff x = withEarlyReturn $ do\n  lift $ putStrLn \"hello\"\n  when x $ earlyReturn \"beans\"\n  lift $ putStrLn \"goodbye\"\n  return \"eggs\"\n\n&gt; doStuff False\nhello\ngoodbye\n\"eggs\"\n\n&gt; doStuff True\nhello\n\"beans\"\n</code></pre>\n\n<p>Or with <code>ContT</code>, where the \u201cearly return\u201d is a continuation.</p>\n\n<pre><code>type EarlyReturnT m a = ContT a m a\n\nwithEarlyReturn\n  :: (Applicative m)\n  =&gt; ((a -&gt; EarlyReturnT m a) -&gt; EarlyReturnT m a)\n  -&gt; m a\nwithEarlyReturn = flip runContT pure . callCC\n\ndoStuff :: Bool -&gt; IO String\ndoStuff x = withEarlyReturn $ \\ earlyReturn -&gt; do\n  lift $ putStrLn \"hello\"\n  when x $ earlyReturn \"beans\"\n  lift $ putStrLn \"goodbye\"\n  return \"eggs\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7397, "user_id": 27385, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/8ad2304dd68978c01b9bf45daa6d9fe4?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/27385/alex"}, "edited": false, "score": 0, "creation_date": 1492674016, "post_id": 43507946, "comment_id": 74080006, "body": "Did you miss Act IV?"}, {"owner": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "edited": false, "score": 0, "creation_date": 1492711921, "post_id": 43507946, "comment_id": 74107008, "body": "This is great, thank you! Loved the Primer reference :)"}], "tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": false, "score": 8, "last_activity_date": 1492706600, "last_edit_date": 1495540932, "creation_date": 1492646074, "answer_id": 43507946, "question_id": 43505543, "link": "https://stackoverflow.com/questions/43505543/skip-the-remaining-actions-in-a-monad-like-return/43507946#43507946", "title": "Skip the remaining actions in a monad - like return", "body": "\n\n<p>The other answer is great! I wanted to talk a little bit about how exactly the continuation solution works so I wrote up this weird big thing. Hope it helps.</p>\n\n<h2>Act I: A Trap Is Laid</h2>\n\n<p>We begin our journey in the low rolling plains of <code>IO</code>, our favorite state monad:</p>\n\n<pre><code>module Lib where\n\nstep1 :: IO String\nstep1 = do\n  print \"step1 - A\"\n  print \"step1 - B\"\n  pure \"--step1 result--\"\n\nstep2 :: String -&gt; IO String\nstep2 input = do\n  print input\n  print \"step2 - A\"\n  print \"step2 - B\"\n  pure \"--step2 complete--\"\n\nmain :: IO ()\nmain = do\n  result &lt;- step1 &gt;&gt;= step2\n  print \"--done--\"\n  print result\n</code></pre>\n\n<p>We want to ascend upward and find a way of returning early from step one. Our first attempt is to introduce some sort of questionably-typed escape mechanism:</p>\n\n<pre><code>step1 :: (String -&gt; ???) -&gt; IO String\nstep1 escape = do\n  print \"step1 - A\"\n  escape \"escaped!\"\n  print \"step1 - B\"\n  pure \"--step1 result--\"\n</code></pre>\n\n<p>We cross our fingers, hoping that the string we pass to <code>escape</code> will end up as the string in <code>IO String</code>, and ponder what exactly can fill in those pesky question marks.</p>\n\n<p>It seems to us that we need to hijack the <code>&gt;&gt;=</code> here if we are to have any hope of wresting the control flow away from the <code>IO</code> monad. We cautiously guess that we will need our own monad transformer.</p>\n\n<pre><code>newtype StrangeT inner a =\n  StrangeT { runStrangeT :: a -&gt; ??? }\n\nlift :: IO a -&gt; StrangeT IO a\nlift io =\n  StrangeT (\\trapDoor -&gt; io &gt;&gt;= trapDoor)\n\nescape :: a -&gt; StrangeT IO a\nescape a =\n  StrangeT (\\trapDoorA -&gt; trapDoorA a)\n\nstep1 :: StrangeT IO String\nstep1 = do\n  lift (print \"step1 - A\")\n  escape \"escaped!\"\n  lift (print \"step1 - B\")\n  pure \"--step1 result--\"\n</code></pre>\n\n<p>We can think of <code>trapDoorA</code> as an escape mechanism guarded by a key, the key being any value of type <code>a</code>. Once the door is open we fall through into the next step of the computation.</p>\n\n<p>What type to insert for the question marks? We have sort of boxed ourselves into a corner; in order for this code to compile we it can only be:</p>\n\n<pre><code>newtype StrangeT inner a =\n  StrangeT { runStrangeT :: (a -&gt; inner a) -&gt; inner a }\n</code></pre>\n\n<h2>Act II: Stranger Still</h2>\n\n<p>We now need to instance <code>Monad (StrangeT inner)</code>. Unfortunately we are going to run into a big problem. <code>StrangeT</code> is not a functor!</p>\n\n<p>The reason for this is that \"a\" appears in the \"negative position\":</p>\n\n<pre><code>newtype StrangeT inner a =\n  StrangeT { runStrangeT :: (a -&gt; inner a) -&gt; inner a }\n                               -- ^^^^^^^\n                               -- :(\n</code></pre>\n\n<p>(For a full discussion of this topic see <a href=\"https://stackoverflow.com/questions/38034077/what-is-a-contravariant-functor\">What is a contravariant functor?</a>.)</p>\n\n<p>We can employ a nasty trick, which is to split the \"negatives\" and the \"positives\" into two different type variables (<code>a</code> and <code>result</code>):</p>\n\n<pre><code>newtype StrangeT result inner a =\n  StrangeT { runStrangeT :: (a -&gt; inner result) -&gt; inner result }\n\nlift :: IO a -&gt; StrangeT whatever IO a\nlift io = StrangeT (\\trapDoor -&gt; io &gt;&gt;= trapDoor)\n\nescape :: a -&gt; StrangeT whatever IO a\nescape x = StrangeT (\\trapDoor -&gt; trapDoor x)\n</code></pre>\n\n<p>This makes everything possible. We can now instance Functor, Applicative, and Monad. Rather than trying to puzzle out the answers though, we will simply let the type checker take over. Any answer that type checks will be the right one.</p>\n\n<pre><code>instance Functor (StrangeT result inner) where\n  fmap a2b (StrangeT strange) =\n    StrangeT $ \\trapDoor -&gt; strange (\\a -&gt; trapDoor (a2b a))\n             -- ^^^^^^^^\n             -- b -&gt; inner result\n</code></pre>\n\n<p>Train of logic:</p>\n\n<ul>\n<li><p><code>trapDoor</code> is the only way to build an <code>inner result</code> value.</p></li>\n<li><p>It needs a value of type <code>b</code>.</p></li>\n<li><p>We have <code>a2b :: a -&gt; b</code> and <code>a :: a</code>.</p>\n\n<pre><code>instance Applicative (StrangeT result inner) where\n  pure :: a -&gt; StrangeT result inner a\n  pure a = StrangeT $ \\trapDoor -&gt; trapDoor a\n\n  (&lt;*&gt;) :: StrangeT result inner (a -&gt; b) -&gt;\n           StrangeT result inner a -&gt;\n           StrangeT result inner b\n  (StrangeT strangeA2B) &lt;*&gt; (StrangeT strangeA) =\n--          ^^^^^^^^^^                ^^^^^^^^\n--          (b -&gt; inner result) -&gt; inner result\n--                                    (a -&gt; inner result) -&gt; inner result\n    StrangeT (\\trapDoorB -&gt; strangeA2B (\\a2b -&gt; strangeA (\\a -&gt; trapDoorB (a2b a))))\n--             ^^^^^^^^                 \n--             b -&gt; inner result\n</code></pre></li>\n</ul>\n\n<p>Train of logic:</p>\n\n<ul>\n<li><p>We have <code>trapDoorB :: b -&gt; inner result</code> (the <em>only</em> way to construct inner result), <code>a2b :: a -&gt; b</code>, and <code>a :: a</code>.</p></li>\n<li><p>We need to construct a <code>StrangeT result inner b</code>;</p></li>\n<li><p>We therefore must at some point evaluate <code>trapDoorB (a2b a)</code>.</p></li>\n</ul>\n\n<p>The monadic instance is about as difficult:</p>\n\n<pre><code>    instance Monad (StrangeT result inner) where\n      (StrangeT strangeA) &gt;&gt;= a2strangeB =\n         --     ^^^^^^^^\n         --     (a -&gt; inner result) -&gt; inner result\n        StrangeT\n          (\\trapDoorB -&gt; strangeA (\\a -&gt; let StrangeT strangeB = a2strangeB a in strangeB (\\b -&gt; trapDoorB b)))\n         -- ^^^^^^^^^                                 ^^^^^^^^\n         -- b -&gt; inner result                         (b -&gt; inner result) -&gt; inner result\n</code></pre>\n\n<p>There is only one way to construct <code>inner result</code>, which by falling through <code>trapDoorB</code>, so everything else is built toward that singular goal.</p>\n\n<h2>Act III: A Fumble</h2>\n\n<p>We have defined a monad transformer without really knowing what it does or how it works! We simply smashed together the types that looked right.</p>\n\n<p>It would behoove us then to see it in action:</p>\n\n<pre><code>main :: IO ()\nmain = do\n  _ &lt;- runStrangeT (step1 &gt;&gt;= step2) (\\a -&gt; pure a)\n  print \"--done--\"\n  print result\n</code></pre>\n\n<p>This results in the following output:</p>\n\n<pre><code>\u03bb&gt; main\n\"step1 - A\"\n\"step1 - B\"\n\"--step1 result--\"\n\"step2 - A\"\n\"step2 - B\"\n\"--done--\"\n\"--step2 result--\"\n</code></pre>\n\n<p>How frustrating! We are right where we started from.</p>\n\n<p>However, something peculiar happens if we define this function:</p>\n\n<pre><code>escape :: a -&gt; StrangeT whatever IO a\nescape x = StrangeT (\\trapDoor -&gt; trapDoor x)\n\nescapeWeirdly :: a -&gt; StrangeT whatever IO a\nescapeWeirdly x = StrangeT (\\trapDoor -&gt; trapDoor x &gt;&gt; trapDoor x &gt;&gt; trapDoor x)\n\nstep1 :: StrangeT String IO String\nstep1 = do\n  lift (print \"step1 - A\")\n  escapeWeirdly \"--step1 exit--\"\n  lift (print \"step1 - B\")\n  pure \"--step1 result--\"\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>\u03bb&gt; main\n\"step1 - A\"\n\"step1 - B\"               &lt;- trap door call #1\n\"--step1 result--\"\n\"step2 - A\"\n\"step2 - B\"\n\"step1 - B\"               &lt;- trap door call #2\n\"--step1 result--\"\n\"step2 - A\"\n\"step2 - B\"\n\"step1 - B\"               &lt;- trap door call #3\n\"--step1 result--\"\n\"step2 - A\"\n\"step2 - B\"\n\"--done--\"\n\"--step2 result--\"\n</code></pre>\n\n<p><code>step2</code> runs three times! It seems that \"trapDoor\" encodes some notion of \"everything after this point in the control flow.\" Calling it once runs everything after it once. Calling it three times runs everything after it three times. Calling it zero times...</p>\n\n<pre><code>cut :: a -&gt; StrangeT a IO a\ncut x = StrangeT (\\_ -&gt; return x)\n\nstep1 :: (String -&gt; StrangeT String IO String) -&gt; StrangeT String IO String\nstep1 exit = do\n  lift (print \"step1 - A\")\n  cut \"--step1 exit--\"\n  lift (print \"step1 - B\")\n  pure \"--step1 result--\"\n\nmain :: IO ()\nmain = do\n  result &lt;- runStrangeT (step1 undefined &gt;&gt;= step2) pure\n  print \"--done--\"\n  print result\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>\u03bb&gt; main\n\"step1 - A\"\n\"--done--\"\n\"--step1 exit--\"\n</code></pre>\n\n<p>Nothing runs! This is <em>incredibly</em> close to what we need.</p>\n\n<h2>Act IV: Success and the Price Thereof</h2>\n\n<p>What if we could mark a do-block of <code>StrangeT</code> actions as needing an early exit? Something very similar to our original escape mechanism:</p>\n\n<pre><code>step1 = withEscape $ \\escape -&gt; do\n  lift (print \"step1 - A\")\n  escape \"--step1 exit--\"\n  lift (print \"step1 - B\")\n  pure \"--step1 result--\"\n</code></pre>\n\n<p>What <code>withEscape</code> does is it runs the do-block as written until someone calls <code>escape</code>, at which point the rest of the computation is aborted <em>but</em> any computation outside the <code>withEscape</code> (namely Step Two here) runs as-is.</p>\n\n<p>This helper must have a type of:</p>\n\n<pre><code>withEscape :: (??? -&gt; StrangeT result inner a) -&gt; StrangeT result inner a\n</code></pre>\n\n<p>Almost the exact same leap of faith we made when we went from <code>m a</code> to <code>(a -&gt; m a) -&gt; m a</code>.</p>\n\n<p>Since we are passing a <code>String</code> to <code>escape</code> and binding the result of that computation to the next line of the do-block, we can now fill in those question marks:</p>\n\n<pre><code>withEscape :: ((a -&gt; StrangeT result inner whatever) -&gt; StrangeT result inner a)\n              -&gt; StrangeT result inner a\n</code></pre>\n\n<p>A tricksy type! We are going to have to navigate by type again to find the definition:</p>\n\n<pre><code>-- We have to call f at some point, and trapDoorA\n-- is the only way to construct an inner result.\nwithEscape f =\n  StrangeT (\\trapDoorA -&gt; let StrangeT strangeA = f ??? in strangeA trapDoorA)\n\n-- f is passed the early exit value\nwithEscape f =\n  StrangeT (\\trapDoorA -&gt;\n    let StrangeT strangeA = f (\\a -&gt; ???) in strangeA trapDoorA)\n\n-- We need to construct a StrangeT value\nwithEscape f =\n  StrangeT (\\trapDoorA -&gt;\n    let StrangeT strangeA = f (\\a -&gt; StrangeT (\\trapDoorWhatever -&gt; ???)) in\n    strangeA trapDoorA)\n\n-- We are going to *ignore* the trapDoorWhatever\n-- we are supposed to fall into, and *instead*\n-- fall through our original trapDoorA.\nwithEscape f =\n  StrangeT (\\trapDoorA -&gt;\n    let StrangeT strangeA = f (\\a -&gt; StrangeT (\\_ -&gt; trapDoor a)) in\n    strangeA trapDoorA)\n</code></pre>\n\n<p>What happened here is that we stumbled onto a solution that gives us <em>two trap doors</em>. Instead of falling through the first door (which would make the helper boil down to something like <code>pure</code> in that it would resume normal control flow)  we chose to fall through the <em>original</em> door we built for ourselves. Fans of the movie <em>Primer</em> will recognize this as the original sin; normal people might just view all this with a confused look on their face.</p>\n\n<p>Regardless, this <strong>works</strong>:</p>\n\n<pre><code>step1 :: StrangeT String IO String\nstep1 =\n  withEscape $ \\escape -&gt; do\n    lift (print \"step1 - A\")\n    escape \"--step1 exit--\"\n    lift (print \"step1 - B\")\n    pure \"--step1 result--\"\n\nstep2 :: String -&gt; StrangeT String IO String\nstep2 result = do\n  lift (print result)\n  lift (print \"step2 - A\")\n  lift (print \"step2 - B\")\n  pure \"--step2 result--\"\n\nmain :: IO ()\nmain = do\n  result &lt;- runStrangeT (step1 &gt;&gt;= step2) pure\n  print \"--done--\"\n  print result\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>\u03bb&gt; main\n\"step1 - A\"              &lt;- early exit\n\"--step1 exit--\"         &lt;- step2 runs\n\"step2 - A\"\n\"step2 - B\"\n\"--done--\"               &lt;- back to main\n\"--step2 result--\"\n</code></pre>\n\n<h2>Summary</h2>\n\n<ul>\n<li><p>As telegraphed, this is the <code>ContT</code> monad and can be found packaged in the <a href=\"https://hackage.haskell.org/package/transformers-0.5.4.0/docs/Control-Monad-Trans-Cont.html\" rel=\"nofollow noreferrer\">transfomers package</a>. What we have been calling trap doors are really continuations.</p></li>\n<li><p><code>withEscape</code> is better known as <code>callCC</code> (call with current continuation); it lets you give the current continuation <em>at the time you called <code>callCC</code></em> a name (<code>escape</code> in our examples); when you activate the continuation it allows you to return a value immediately.</p></li>\n<li><p>You can implement a great deal many things with continuations, including early returns and exceptions and generators and god knows what else. We have yet to even talk about delimited continuations (shift and reset). They represent something primal and fundamental to the structure of computer programming.</p></li>\n<li><p>For more information, see the series of papers linked from <a href=\"http://okmij.org/ftp/Computation/Computation.html\" rel=\"nofollow noreferrer\">Oleg Kiselyov's website</a>. There is much much more to be said about continuations.</p></li>\n</ul>\n\n<h2>Should you ever actually do this in real life?</h2>\n\n<p>Probably not. <code>ExceptT</code> tends to create fewer headaches in the long run.</p>\n\n<h2>But is <code>ExceptT</code> cooler than <code>ContT</code>?</h2>\n\n<p>Hardly.</p>\n"}], "owner": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 1, "accepted_answer_id": 43506405, "answer_count": 2, "score": 4, "last_activity_date": 1492706600, "creation_date": 1492633960, "question_id": 43505543, "link": "https://stackoverflow.com/questions/43505543/skip-the-remaining-actions-in-a-monad-like-return", "title": "Skip the remaining actions in a monad - like return", "body": "<p>Hi I'm looking for a good way to allow a monad stack to skip the remaining actions, without skipping out entirely. Kind of like <code>return</code> in C-family langauges. </p>\n\n<p>For example, let's say I'm using monadic actions for the side effects</p>\n\n<pre><code>type MyMonad = ??\ndoStuff :: MyMonad ()\ndoStuff = do\n   r &lt;- doSomething\n\n   -- equivalent to if (r == \"X\") return; in C\n   dontGoPastHereIf (r == \"X\")\n\n   doSomeSideEffects r\n</code></pre>\n\n<p>So I want it to only perform <code>doSomeSideEffects</code> on some condition. </p>\n\n<p>I know you can do something close to this with <code>guard</code> and <code>when</code> already. Is it possible to do without nesting though?</p>\n\n<p><code>ExceptT</code> already allows you to exit the normal flow and return with an early result. But with <code>ExceptT</code> the error / skip will propogate. I want to only skip the rest of the steps in the local function</p>\n\n<pre><code>doTwoSteps :: MyMonad ()\ndoTwoSteps = do\n  -- if I used ExceptT, an error in the first function will skip the second.\n  -- But I still want to do the second step here\n  doStuff\n  doStuff\n</code></pre>\n\n<p>It seems like bind <code>&gt;&gt;=</code> already does this. At least it's certainly within the possibilities of a monad, but I'm not sure how to do with monad transformers. </p>\n\n<hr>\n\n<p>Here's a more complete example. This system is supposed to perform a \"workflow\". Each step can result in a response, which is supposed to stop the entire workflow and respond (<code>ExceptT</code>).</p>\n\n<p>The workflow can be restarted by passing <code>ApplicationState</code>. If a step has a previous <code>Continue</code> we can skip the logic for that step, but we still need to execute the next step. </p>\n\n<p>Is there a better way to do this? Is there some monad transformer or a way to define my <code>Flow</code> monad such that I can run <code>checkShouldSkip</code> without passing in an action?</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE FlexibleContexts #-}\n\nmodule Main where\n\nimport Control.Monad.Except (throwError, ExceptT)\nimport Control.Monad.State (gets, StateT, modify)\nimport Data.Text (Text)\n\ndata ApplicationState = ApplicationState\n    { step1Result :: Maybe StepResult\n    , step2Result :: Maybe StepResult\n    } deriving (Show, Eq)\n\ndata StepResult\n    = Stop\n    | Continue\n    deriving (Show, Eq)\n\ntype Flow a = StateT ApplicationState (ExceptT Text IO) a\n\n\nflow :: Flow ()\nflow = do\n    step1\n    step2\n\nstep1 :: Flow ()\nstep1 = do\n    ms &lt;- gets step1Result\n    checkShouldSkip ms $ do\n      info &lt;- getStuffFromAServer\n      let r = runSomeLogic info\n      modify $ setStep1 $ Just r\n      checkShouldRespond r\n\n  where\n    getStuffFromAServer = undefined\n    runSomeLogic _ = undefined\n    setStep1 r s = s { step1Result = r }\n\n\nstep2 :: Flow ()\nstep2 = do\n    ms &lt;- gets step2Result\n    checkShouldSkip ms $ do\n      -- this will run some different logic, eventually resulting in a step result\n      r &lt;- getStuffAndRunLogic\n      modify $ setStep2 $ Just r\n      checkShouldRespond r\n\n  where\n    getStuffAndRunLogic = undefined\n    setStep2 r s = s { step2Result = r }\n\n\ncheckShouldSkip :: Maybe StepResult -&gt; Flow () -&gt; Flow ()\ncheckShouldSkip (Just Continue) _ = pure () -- skip the logic, continue\ncheckShouldSkip (Just Stop) _ = respond \"Stop\" -- skip the logic, stop everything\ncheckShouldSkip Nothing a = a -- run the action\n\n\ncheckShouldRespond :: StepResult -&gt; Flow ()\ncheckShouldRespond Continue = pure ()\ncheckShouldRespond Stop = respond \"Stop\" -- if a response, stop all execution\n\n\n-- rename because these aren't really errors, I just want to stop everything\nrespond :: Text -&gt; Flow ()\nrespond t = throwError t\n</code></pre>\n"}, {"tags": ["haskell", "io", "controller", "genetic-algorithm", "ioerror"], "comments": [{"owner": {"reputation": 702, "user_id": 2890063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/07aeeae7c14c12cefde16bf826eceb4a?s=128&d=identicon&r=PG", "display_name": "ocramz", "link": "https://stackoverflow.com/users/2890063/ocramz"}, "edited": false, "score": 0, "creation_date": 1492633256, "post_id": 43505292, "comment_id": 74065323, "body": "The error just means that you forgot to supply one parameter, in this case that <code>Controller -&gt; IO ()</code> function."}, {"owner": {"reputation": 27, "user_id": 7891956, "user_type": "registered", "profile_image": "https://graph.facebook.com/1943447332554519/picture?type=large", "display_name": "illus", "link": "https://stackoverflow.com/users/7891956/illus"}, "reply_to_user": {"reputation": 702, "user_id": 2890063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/07aeeae7c14c12cefde16bf826eceb4a?s=128&d=identicon&r=PG", "display_name": "ocramz", "link": "https://stackoverflow.com/users/2890063/ocramz"}, "edited": false, "score": 0, "creation_date": 1492633405, "post_id": 43505292, "comment_id": 74065398, "body": "So how can I fix it, could you please show me the way?"}, {"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1492633449, "post_id": 43505292, "comment_id": 74065430, "body": "What he said, namely &quot;Callback to take the display controller.&quot; as you can see in the documentation you linked. You need something like <code>animateIO mode white (\\_ -&gt; return ()) $ const $ do</code> to satisfy the type, although you probably need to provide an actual callback there based on your intentions to make it work properly."}, {"owner": {"reputation": 558, "user_id": 1457136, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e1f8148bbb8ea15c4b7c02893c99cab?s=128&d=identicon&r=PG", "display_name": "Jean-Baptiste Potonnier", "link": "https://stackoverflow.com/users/1457136/jean-baptiste-potonnier"}, "edited": false, "score": 0, "creation_date": 1492633550, "post_id": 43505292, "comment_id": 74065501, "body": "More generally, I would try to extract some functions to make this block smaller and/or add type annotation to have a better, more targeted error message."}, {"owner": {"reputation": 702, "user_id": 2890063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/07aeeae7c14c12cefde16bf826eceb4a?s=128&d=identicon&r=PG", "display_name": "ocramz", "link": "https://stackoverflow.com/users/2890063/ocramz"}, "edited": false, "score": 0, "creation_date": 1492638638, "post_id": 43505292, "comment_id": 74068070, "body": "@ThaoDang, try splitting up the function in more manageable pieces like Jean-Baptiste suggested, and look at the type of each. In particular, this latest error means that the callback is not supposed to return a <code>Picture</code>, but the <code>do</code> block should just end by returning unit (<code>()</code>)."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1492643096, "post_id": 43505292, "comment_id": 74069600, "body": "This is completely unrelated to your problem, but your understanding (&quot;all of instructions in main() need to be an IO()&quot;) is incorrect. Having statements of type <code>IO a</code> for any <code>a</code> is fine and common."}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 7891956, "user_type": "registered", "profile_image": "https://graph.facebook.com/1943447332554519/picture?type=large", "display_name": "illus", "link": "https://stackoverflow.com/users/7891956/illus"}, "edited": false, "score": 1, "creation_date": 1492678288, "post_id": 43513711, "comment_id": 74082639, "body": "I will fix my code like what you advice and post the result as soon as possible, thank you for helping me."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 1, "last_activity_date": 1492675584, "creation_date": 1492675584, "answer_id": 43513711, "question_id": 43505292, "link": "https://stackoverflow.com/questions/43505292/couldnt-match-expected-type-io-with-actual-type-controller-io/43513711#43513711", "title": "Couldn&#39;t match expected type \u2018IO ()\u2019 with actual type \u2018(Controller -&gt; IO ()) -&gt; IO ()\u2019", "body": "<p>How many arguments does <code>animateIO</code> take?</p>\n\n<pre><code>animateIO :: Display    \n          -&gt; Color  \n          -&gt; (Float -&gt; IO Picture)  \n          -&gt; (Controller -&gt; IO ())  \n          -&gt; IO ()\n</code></pre>\n\n<p>Four. How many arguments did you provide to <code>animateIO</code>?</p>\n\n<pre><code>animateIO mode white $ \u2026\n</code></pre>\n\n<p>Three. The type of</p>\n\n<pre><code>animateIO mode white $ \u2026\n</code></pre>\n\n<p>is <code>(Controller -&gt; IO ()) -&gt; IO ()</code>, which is exactly what your error message tells you. Since you don't want to use the <code>Controller -&gt; IO ()</code> part, you can provide your own <code>animateIO</code>:</p>\n\n<pre><code>animateIO' :: Display -&gt; Color -&gt; IO Picture -&gt; IO ()\nanimateIO' m c a = animateIO m c (const a) (const $ return ())\n</code></pre>\n\n<p>Note that your <code>(\\_ -&gt; return ())</code> did not work because the third argument has to produce a <code>Picture</code>, not a <code>IO ()</code>.</p>\n"}], "owner": {"reputation": 27, "user_id": 7891956, "user_type": "registered", "profile_image": "https://graph.facebook.com/1943447332554519/picture?type=large", "display_name": "illus", "link": "https://stackoverflow.com/users/7891956/illus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 652, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1492675584, "creation_date": 1492632944, "last_edit_date": 1492636284, "question_id": 43505292, "link": "https://stackoverflow.com/questions/43505292/couldnt-match-expected-type-io-with-actual-type-controller-io", "title": "Couldn&#39;t match expected type \u2018IO ()\u2019 with actual type \u2018(Controller -&gt; IO ()) -&gt; IO ()\u2019", "body": "<p>I'm a newbie in Haskell, I took this error when I try to configure my code. I understand that all of instructions in main() need to be an IO(), and the error happened because one of function I used (in Graphics.Gloss.Interface.IO.Animate) didn't return IO(). I wanna display the result of a genetic algorithm by using gloss package.\nHere is my code:</p>\n\n<pre><code>module Main where\n\nimport Prelude as P\nimport Control.Monad.Random as Rand\nimport Data.Functor\nimport Data.IORef\nimport Graphics.Gloss.Interface.IO.Animate\nimport Graphics.Solution\nimport Graphics.Plot\n\nimport Args\nimport Task\nimport Parsing\nimport Genetic\n\nimport Control.Concurrent.Async\nimport Control.Concurrent.STM.TChan\nimport Control.Monad.STM\nimport Control.Arrow (first)\n\n\nmain :: IO ()\nmain = do\n  args &lt;- parseOptions \n\n  opts &lt;- loadEvolOptions (evolOptionsFileName args)\n  gen &lt;- newStdGen\n  task@(Task _ twrs _ _) &lt;- loadTask (inputFileName args) (fitnessFuncFileName args)\n\n  chan &lt;- newTChanIO\n  asolution &lt;- async $ solve chan gen opts task\n  dataRef &lt;- newIORef []\n  finalSolutionRef &lt;- newIORef Nothing\n\n  animateIO mode white $ const $ do\n      mfinsol &lt;- readIORef finalSolutionRef\n      case mfinsol of\n        Just solution -&gt; do\n          samples &lt;- readIORef dataRef\n          return $ solutionPicture task solution (fitnessPlot samples)\n        Nothing -&gt; do\n          msolution &lt;- poll asolution     \n          case msolution of\n            Nothing -&gt; do\n              mv &lt;- atomically $ tryReadTChan chan\n              case mv of\n                Nothing -&gt; return ()\n                Just v -&gt; modifyIORef dataRef (++[v])\n              samples &lt;- readIORef dataRef\n              return $ fitnessPlot samples\n            Just esol -&gt; case esol of\n              Left e -&gt; fail $ show e\n              Right solution -&gt; do\n                saveResult (outputFileName args) (filterTowers solution twrs)\n                writeIORef finalSolutionRef (Just solution)\n                samples &lt;- readIORef dataRef\n                return $ solutionPicture task solution (fitnessPlot samples)\n      where mode = InWindow \"test_genetic_al\" (1280, 1024) (10, 10)\n            fitnessPlot ds =  translate (-300) (-200) $ scale 600 600 $ plot \"generation\" \"fitness\" $ first fromIntegral &lt;$&gt; ds\n</code></pre>\n\n<p>And this is which I got:</p>\n\n<pre><code>Couldn't match expected type \u2018IO ()\u2019\n                with actual type \u2018(Controller -&gt; IO ()) -&gt; IO ()\u2019\n    In a stmt of a 'do' block:\n      animateIO mode white\n      $ const\n        $ do { mfinsol &lt;- readIORef finalSolutionRef;\n               case mfinsol of {\n                 Just solution -&gt; do { ... }\n                 Nothing -&gt; do { ... } } }\n    In the expression:\n      do { args &lt;- parseOptions;\n           opts &lt;- loadEvolOptions (evolOptionsFileName args);\n           gen &lt;- newStdGen;\n           task@(Task _ twrs _ _) &lt;- loadTask\n                                       (inputFileName args) (fitnessFuncFileName args);\n           .... }\n    In an equation for \u2018main\u2019:\n        main\n          = do { args &lt;- parseOptions;\n                 opts &lt;- loadEvolOptions (evolOptionsFileName args);\n                 gen &lt;- newStdGen;\n                 .... }\n          where\n              mode = InWindow \"test_genetic_al\" (1280, 1024) (10, 10)\n              fitnessPlot ds\n                = translate (- 300) (- 200)\n                  $ scale 600 600\n                    $ plot \"generation\" \"fitness\" $ first fromIntegral &lt;$&gt; ds\n</code></pre>\n\n<p>I've been searching my problem over Google and stackoverflow for so many times but still cannot find a solution for this error. Please help me.</p>\n\n<p>P/S: This is a guide line for Graphics.Gloss: <a href=\"https://hackage.haskell.org/package/gloss-1.11.1.1/docs/Graphics-Gloss-Interface-IO-Animate.html\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/gloss-1.11.1.1/docs/Graphics-Gloss-Interface-IO-Animate.html</a></p>\n\n<p>Sorry again for my silly question, after I gave Lazersmoke's suggestion (which you can see below in the comment area), I got another error which very similar with the error I asking for: </p>\n\n<p>I changed the line: animateIO mode white $ const $ do</p>\n\n<p>Into: animateIO mode white (_ -> return ()) $ const $ do</p>\n\n<pre><code>Couldn't match type \u2018Picture\u2019 with \u2018()\u2019\n    Expected type: Controller -&gt; IO ()\n      Actual type: Controller -&gt; IO Picture\n    In the second argument of \u2018($)\u2019, namely\n      \u2018const\n       $ do { mfinsol &lt;- readIORef finalSolutionRef;\n              case mfinsol of {\n                Just solution -&gt; do { ... }\n                Nothing -&gt; do { ... } } }\u2019\n    In a stmt of a 'do' block:\n      animateIO mode white (\\ _ -&gt; return ())\n      $ const\n        $ do { mfinsol &lt;- readIORef finalSolutionRef;\n               case mfinsol of {\n                 Just solution -&gt; do { ... }\n                 Nothing -&gt; do { ... } } }\n    In the expression:\n      do { args &lt;- parseOptions;\n           opts &lt;- loadEvolOptions (evolOptionsFileName args);\n           gen &lt;- newStdGen;\n           task@(Task _ twrs _ _) &lt;- loadTask\n                                       (inputFileName args) (fitnessFuncFileName args);\n           .... }\n</code></pre>\n"}, {"tags": ["postgresql", "haskell", "persistent"], "answers": [{"tags": [], "owner": {"reputation": 63855, "user_id": 124486, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/605442f85418d858e2ce1e1aea2092bb?s=128&d=identicon&r=PG", "display_name": "Evan Carroll", "link": "https://stackoverflow.com/users/124486/evan-carroll"}, "is_accepted": true, "score": 1, "last_activity_date": 1492630777, "creation_date": 1492630777, "answer_id": 43504689, "question_id": 43504368, "link": "https://stackoverflow.com/questions/43504368/how-to-access-a-table-present-in-a-schema-using-persistent/43504689#43504689", "title": "How to access a table present in a schema using persistent", "body": "<p>After a quick review of the docs and a search through the bug tracker, this is not currently support in Persistent. See <a href=\"https://github.com/yesodweb/persistent/issues/93\" rel=\"nofollow noreferrer\">bug #93</a>.</p>\n"}], "owner": {"reputation": 1822, "user_id": 5806729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43a68f68b462ab160b4764ee2952d1b6?s=128&d=identicon&r=PG&f=1", "display_name": "sandeep", "link": "https://stackoverflow.com/users/5806729/sandeep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 43504689, "answer_count": 1, "score": 0, "last_activity_date": 1492630777, "creation_date": 1492629754, "question_id": 43504368, "link": "https://stackoverflow.com/questions/43504368/how-to-access-a-table-present-in-a-schema-using-persistent", "title": "How to access a table present in a schema using persistent", "body": "<p>I have a database which has different schema for different tables.</p>\n\n<p>Example</p>\n\n<pre><code>CREATE TABLE animals.dog\n(\n      id                        INTEGER\n    , name                      CHARACTER VARYING(20)\n    , year                      INTEGER\n);\n</code></pre>\n\n<p>When I want to query the dog table, I want to access it directly, as if it was created by persistent.</p>\n\n<p>The query created to access data is generated as <code>SELECT \"id\", \"name\", \"year\" FROM \"animals.dog\";</code> which assumes <code>.</code> to be part of table name.</p>\n\n<p>Is there a way by which I can data from tables, present in some schema.</p>\n"}, {"tags": ["haskell", "terminal", "command-line-arguments", "readfile"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1492617495, "post_id": 43499943, "comment_id": 74055499, "body": "The <code>&lt;</code> symbol has absolutely nothing to do with Haskell - it is the &quot;pipe&quot; operator, which (is implemented by your shell, and) passes the output of one program as the <i>input</i> (not a command line argument) to the other program. Your Haskell program expects to always receive one argument and so crashes."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1492624414, "post_id": 43499943, "comment_id": 74060038, "body": "@user2407038 Actually, <code>&lt;</code> is not a shell pipe, it&#39;s just input redirection. <code>ls -l | grep foo</code> would be a pipe."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1492615663, "creation_date": 1492615663, "answer_id": 43500031, "question_id": 43499943, "link": "https://stackoverflow.com/questions/43499943/why-does-my-haskell-program-not-accept-standard-input-redirection/43500031#43500031", "title": "Why does my Haskell program not accept standard input redirection?", "body": "<p>If you run <code>./program arg</code> then <code>arg</code> is passed as an argument. The standard input is left on its default -- usually reading from keyboard from a terminal.</p>\n\n<p>If you run <code>./program &lt; filename</code> then no arguments are passed to the program. The standard input now is redirected so to read from file <code>filename</code>.</p>\n\n<p>This is just how the OS shell works.</p>\n\n<p>In Haskell, <code>getArgs</code> gets the program arguments. In the second case, they are empty, and <code>[fileName] &lt;- getArgs</code> fails with your runtime error.</p>\n"}, {"comments": [{"owner": {"reputation": 5, "user_id": 5661161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/766e4e4ec7c90906883d9f33c2aa0faf?s=128&d=identicon&r=PG&f=1", "display_name": "emile", "link": "https://stackoverflow.com/users/5661161/emile"}, "edited": false, "score": 0, "creation_date": 1492619512, "post_id": 43500052, "comment_id": 74056880, "body": "Thanks! :D Now I used file &lt;- getContents instead and it worked :)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1492621033, "post_id": 43500052, "comment_id": 74057881, "body": "Don&#39;t check length; pattern match."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1492621344, "post_id": 43500052, "comment_id": 74058110, "body": "Well, pattern matching is the best way to check the length of the arguments in this case. I wouldn&#39;t say we&#39;re <i>not</i> checking length."}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 4, "last_activity_date": 1492615725, "creation_date": 1492615725, "answer_id": 43500052, "question_id": 43499943, "link": "https://stackoverflow.com/questions/43499943/why-does-my-haskell-program-not-accept-standard-input-redirection/43500052#43500052", "title": "Why does my Haskell program not accept standard input redirection?", "body": "<p><code>./program &lt; input.txt</code> calls the program with 0 arguments and redirects stdin to the contents of <code>input.txt</code>.</p>\n\n<p>So you get a pattern matching error because <code>getArgs</code> is empty. So if you want your program to always read from stdin, don't use the command line arguments at all and read from stdin instead of a file.</p>\n\n<p>If you want your program to read from stdin only if no file name was given, check the length of the arguments first and then read from the given file name or from stdin depending on that.</p>\n"}], "owner": {"reputation": 5, "user_id": 5661161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/766e4e4ec7c90906883d9f33c2aa0faf?s=128&d=identicon&r=PG&f=1", "display_name": "emile", "link": "https://stackoverflow.com/users/5661161/emile"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 209, "favorite_count": 0, "accepted_answer_id": 43500052, "answer_count": 2, "score": 0, "last_activity_date": 1492624484, "creation_date": 1492615464, "last_edit_date": 1492624484, "question_id": 43499943, "link": "https://stackoverflow.com/questions/43499943/why-does-my-haskell-program-not-accept-standard-input-redirection", "title": "Why does my Haskell program not accept standard input redirection?", "body": "<p>I'm trying to read a file in Haskell by supplying the file name as a command line argument.\nI have read that you can accomplish this by:</p>\n\n<pre><code>./program &lt; input.txt\n</code></pre>\n\n<p>I wrote this code:</p>\n\n<pre><code>main = do\n    [fileName] &lt;- getArgs\n    file &lt;- readFile fileName\n    print file\n</code></pre>\n\n<p>But I get this error: \"pattern match failure in do expression\". If I omit the &lt; sign it works, is this the only way to accomplish this? I would much rather not omit it. What should I change?</p>\n"}, {"tags": ["haskell", "yesod"], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 2, "last_activity_date": 1492615712, "creation_date": 1492615712, "answer_id": 43500048, "question_id": 43499693, "link": "https://stackoverflow.com/questions/43499693/unable-to-find-type-relating-to-import-in-yesod-import-hs/43500048#43500048", "title": "Unable to find type relating to import in Yesod Import.hs", "body": "<p>That's not possible. It would defeat a main purpose of qualified imports: that the qualifier-prefix tells you where something comes from. If you have <code>E.&lt;.</code> in your code, the reader wants to be able to see where it comes from!</p>\n\n<p>You have two options:</p>\n\n<ul>\n<li>Put <code>import qualified Database.Esqueleto as E</code> directly in <code>Handler.MyProfile</code>. This is often the best solution \u2013 while it leads to somewhat unwieldy headers on top of every source file, the advantage is that one immediately sees where everything is coming from. Yes, it violates DRY, but I think in this case it's reasonable nevertheless.</li>\n<li><p>Make a dedicated \u201cimport module\u201d for esqueleto stuff. And, if necessary, for any other import-qualifier prefix you have.</p>\n\n<pre><code>module Import.Esqueleto where -- package-local, hidden module\nimport Database.Esqueleto\nimport Database.Esqueleto....\n\nmodule Handler.MyProfile where\nimport qualified Import.Esqueleto as E\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 5139, "user_id": 705510, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/7xrNQ.png?s=128&g=1", "display_name": "McBear Holden", "link": "https://stackoverflow.com/users/705510/mcbear-holden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 43500048, "answer_count": 1, "score": 0, "last_activity_date": 1492721216, "creation_date": 1492614809, "last_edit_date": 1492721216, "question_id": 43499693, "link": "https://stackoverflow.com/questions/43499693/unable-to-find-type-relating-to-import-in-yesod-import-hs", "title": "Unable to find type relating to import in Yesod Import.hs", "body": "<p>I have put in Import.hs</p>\n\n<p><code>import qualified Database.Esqueleto  as E</code></p>\n\n<p>But in my Handler file where I have </p>\n\n<p><code>import Import</code></p>\n\n<p>But it couldn't find E</p>\n\n<pre><code>module Handler.MyProfile where\n\nimport Import\n\n\ngetMyProfileR :: Handler Html\ngetMyProfileR = do\n  now &lt;- liftIO getCurrentTime\n  wordList &lt;- (runDB $ E.select $ E.from $ \\v -&gt; do\n                  where_ (v ^. VocabularyDate E.&lt;. val now)\n                  return v)\n  defaultLayout $ do\n    $(widgetFile \"myprofile\")\n</code></pre>\n"}, {"tags": ["haskell", "exception-handling", "maybe"], "comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1492613103, "post_id": 43498639, "comment_id": 74052301, "body": "Your example code is not valid. It has a type error."}], "answers": [{"comments": [{"owner": {"reputation": 29052, "user_id": 96233, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/85735330505ef1c84896fcb86491bd0b?s=128&d=identicon&r=PG", "display_name": "Ralph", "link": "https://stackoverflow.com/users/96233/ralph"}, "edited": false, "score": 0, "creation_date": 1492613080, "post_id": 43498949, "comment_id": 74052285, "body": "That worked. Thanks. I realized the mismatched types when I tried to compile, but was still working through how to fix it."}], "tags": [], "owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "is_accepted": true, "score": 3, "last_activity_date": 1492612868, "creation_date": 1492612868, "answer_id": 43498949, "question_id": 43498639, "link": "https://stackoverflow.com/questions/43498639/better-way-to-report-locked-file-in-haskell/43498949#43498949", "title": "Better way to report locked file in Haskell", "body": "<pre><code>fileLock &lt;- fromMaybe (throwIO (userError \"File locked\"))\n  &lt;$&gt; tryLockFile path Exclusive\n</code></pre>\n\n<p>but <code>throwIO :: Exception e =&gt; e -&gt; IO a</code>, so this and your code should mismatch between <code>FileLock</code> and <code>IO a</code>. Instead:</p>\n\n<pre><code>fileLock &lt;- maybe (throwIO (userError \"File locked\")) pure\n  =&lt;&lt; tryLockFile path Exclusive\n</code></pre>\n"}], "owner": {"reputation": 29052, "user_id": 96233, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/85735330505ef1c84896fcb86491bd0b?s=128&d=identicon&r=PG", "display_name": "Ralph", "link": "https://stackoverflow.com/users/96233/ralph"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 43498949, "answer_count": 1, "score": 1, "last_activity_date": 1492612868, "creation_date": 1492612149, "question_id": 43498639, "link": "https://stackoverflow.com/questions/43498639/better-way-to-report-locked-file-in-haskell", "title": "Better way to report locked file in Haskell", "body": "<p>I would like to lock a file for exclusive use in Haskell and throw an <code>IOError</code> in the case where it is already locked.</p>\n\n<pre><code>import Data.Maybe (fromMaybe)\nimport System.FileLock (FileLock, SharedExclusive (Exclusive), tryLockFile)\n\n-- ...\ndo\n  -- ...\n  maybeFileLock &lt;- tryLockFile path Exclusive -- returns Maybe FileLock\n  let fileLock = fromMaybe (throwIO (userError \"File locked\")) maybeFileLock\n</code></pre>\n\n<p>Is there a better way to handle the <code>Maybe</code> and just throw an exception if it is <code>Nothing</code>? Can I combine these two lines into one?</p>\n\n<p><strong>N.B.</strong>: One could argue that any combination of these lines will make the intent less clear.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1492615079, "post_id": 43497633, "comment_id": 74053768, "body": "<code>product</code> is not a built-in/primitive. It is just <code>foldr1 (*)</code>."}, {"owner": {"reputation": 7953, "user_id": 812149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6lIqv.png?s=128&g=1", "display_name": "S.L. Barth", "link": "https://stackoverflow.com/users/812149/s-l-barth"}, "reply_to_user": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1492615511, "post_id": 43497633, "comment_id": 74054055, "body": "@Lazersmoke Thanks, updated the answer. It is indeed not built in, but included via Prelude."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "reply_to_user": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 1, "creation_date": 1492637510, "post_id": 43497633, "comment_id": 74067597, "body": "@Lazersmoke <code>product</code> is not <code>foldr1 (*)</code>, because <code>product [] = 1</code>."}, {"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1492643128, "post_id": 43497633, "comment_id": 74069610, "body": "If we are to be 100% technically accurate, it is actually <code>product = getProduct #. foldMap Product</code> as defined in <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/src/Data.Foldable.html#product\" rel=\"nofollow noreferrer\"><code>Data.Foldable</code></a>, where <code>#.</code> is <code>const coerce</code> and the Monoid instance of the <code>Product</code> newtype multiplies for <code>mappend</code> and uses <code>1</code> as the identity element. Its actual type is <code>(Num a, Foldable t) =&gt; t a -&gt; a</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1492672350, "post_id": 43497633, "comment_id": 74079019, "body": "@Lazersmoke, that&#39;s the default definition of <code>product</code>, but for lists it&#39;s actually <code>foldl (*) 1</code>."}], "tags": [], "owner": {"reputation": 7953, "user_id": 812149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6lIqv.png?s=128&g=1", "display_name": "S.L. Barth", "link": "https://stackoverflow.com/users/812149/s-l-barth"}, "is_accepted": true, "score": 6, "last_activity_date": 1492669483, "last_edit_date": 1492669483, "creation_date": 1492609637, "answer_id": 43497633, "question_id": 43497559, "link": "https://stackoverflow.com/questions/43497559/int-int-with-multiply/43497633#43497633", "title": "[[Int]] -&gt; [Int] with multiply", "body": "<p>Very simple really, you need <code>map</code>:</p>\n\n<pre><code>map product [[2,3],[8,3,2],[2,10,1],[2,2,2,2]]\n</code></pre>\n\n<p>The <code>product</code> function multiplies all elements in a list. It is included in the <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Prelude.html#v:product\" rel=\"nofollow noreferrer\">Prelude</a>, which is imported by default. In other words, it is normally available.</p>\n\n<p>The <code>map</code> function applies that function to each element in the list.</p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 4, "last_activity_date": 1492611907, "creation_date": 1492611907, "answer_id": 43498546, "question_id": 43497559, "link": "https://stackoverflow.com/questions/43497559/int-int-with-multiply/43498546#43498546", "title": "[[Int]] -&gt; [Int] with multiply", "body": "<p>If you prefer a solution with folds only, first a couple of rules of thumb:</p>\n\n<ul>\n<li>Never use <code>foldl</code> (\u201clazy<sup>\u2020</sup> left fold\u201d), except in very specific circumstances (which you won't encounter until you've long learned the subtleties).</li>\n<li>Use <code>foldr</code> (lazy right fold) for deconstructing lists, if the result is <em>lazy</em>. In particular, this is usually the right choice if your fold produces a list again: <code>foldr</code> will only consume the list by demand, and it doesn't keep a reference to the original head, hence it works smoothly even on infinite lists and avoids memory blowup (in fact, the garbage collector can reclaim parts of the list that are already processed, before the processing is finished!)</li>\n<li>Use <code>foldl'</code> (strict left fold) for \u201catomic\u201d operations like computing the sum of all values in a list.</li>\n</ul>\n\n<p>So let's start with</p>\n\n<pre><code>listOfProductInt :: [[Int]] -&gt; [Int]\n-- listOfProductInt [] = [] -- no need for that, folds already handle the empty case.\nlistOfProductInt lists = foldr _ [] lists\n\nmultipleInts :: (Num a) =&gt; [a] -&gt; a\nmultipleInts list1 = foldl' _ 1 list1\n</code></pre>\n\n<p>GHC will inform you</p>\n\n<pre><code>/tmp/wtmpf-file9164.hs:4:32:\n    Found hole \u2018_\u2019 with type: [Int] -&gt; [Int] -&gt; [Int]\n    Relevant bindings include\n      lists :: [[Int]] (bound at /tmp/wtmpf-file9164.hs:4:18)\n      listOfProductInt :: [[Int]] -&gt; [Int]\n        (bound at /tmp/wtmpf-file9164.hs:4:1)\n    In the first argument of \u2018foldr\u2019, namely \u2018_\u2019\n</code></pre>\n\n<p>Unfortunately this is not as informtive as usually because both the result and the individual sub-lists have type <code>[Int]</code>. I'll annotate the type:</p>\n\n<pre><code>           [Int]   -- the sublist we're focusing on\n        -&gt; [Int]   -- the result of the future product-computations yet to be done\n        -&gt; [Int]   -- the result at this point of the computation\n</code></pre>\n\n<p>Now, for handling the sublist that's on the agenda first, we have <code>multipleInts</code>. So, it should look something like</p>\n\n<pre><code>listOfProductInt lists = foldr (\\l -&gt; _ (multipleInts l)) [] lists\n</code></pre>\n\n<p>to which GHC replies</p>\n\n<pre><code>/tmp/wtmpf-file9164.hs:4:39:\n    Found hole \u2018_\u2019 with type: Int -&gt; [Int] -&gt; [Int]\n    Relevant bindings include\n      l :: [Int] (bound at /tmp/wtmpf-file9164.hs:4:34)\n      lists :: [[Int]] (bound at /tmp/wtmpf-file9164.hs:4:18)\n      listOfProductInt :: [[Int]] -&gt; [Int]\n        (bound at /tmp/wtmpf-file9164.hs:4:1)\n    In the expression: _\n    In the expression: _ (multipleInts l)\n    In the first argument of \u2018foldr\u2019, namely\n      \u2018(\\ l -&gt; _ (multipleInts l))\u2019\n</code></pre>\n\n<p>You may recognise <code>Int -&gt; [Int] -&gt; [Int]</code>, or generally <code>a -&gt; [a] -&gt; [a]</code>, as the signature of the cons-operator <code>(:)</code>, and that's what's needed here:</p>\n\n<pre><code>listOfProductInt lists = foldr (\\l -&gt; (:) (multipleInts l)) [] lists\n</code></pre>\n\n<p>or, using point-free composition,</p>\n\n<pre><code>listOfProductInt = foldr ((:) . multipleInts) []\n</code></pre>\n\n<p>Proceed with the implementation of <code>multipleInts</code>:</p>\n\n<pre><code>/tmp/wtmpf-file9164.hs:7:29:\n    Found hole \u2018_\u2019 with type: a -&gt; a -&gt; a\n    Where: \u2018a\u2019 is a rigid type variable bound by\n               the type signature for multipleInts :: Num a =&gt; [a] -&gt; a\n               at /tmp/wtmpf-file9164.hs:6:17\n    Relevant bindings include\n      list1 :: [a] (bound at /tmp/wtmpf-file9164.hs:7:14)\n</code></pre>\n\n<p>Well, <code>a -&gt; a -&gt; a</code> where <code>a</code> fulfills a <code>Num</code> constraint? That's just the simple product operation!</p>\n\n<pre><code>multipleInts list1 = foldl' (*) 1 list1\n</code></pre>\n\n<hr>\n\n<p><sup>\u2020</sup><sub><code>foldl</code> is only lazy in the <em>values</em>, but not in the spine. In practice, this tends to give you the worst of both worlds: the processor is immediately clogged with having to handle the whole list, but instead of actually doing useful computations, it merely builds up stacks of memory-hogging laziness-thunks.</sub></p>\n"}], "owner": {"reputation": 1147, "user_id": 5168582, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/211e9efa5c3c53cb182ad9dd07014567?s=128&d=identicon&r=PG&f=1", "display_name": "Mateusz Sobczak", "link": "https://stackoverflow.com/users/5168582/mateusz-sobczak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 206, "favorite_count": 0, "accepted_answer_id": 43497633, "answer_count": 2, "score": 2, "last_activity_date": 1492669483, "creation_date": 1492609475, "last_edit_date": 1492636325, "question_id": 43497559, "link": "https://stackoverflow.com/questions/43497559/int-int-with-multiply", "title": "[[Int]] -&gt; [Int] with multiply", "body": "<p>I try to learn Haskell and I don't know how to create a function which takes a  list of lists and multiplies each element in this list e.g.</p>\n\n<pre><code>[[2,3], [8,3,2], [2,10,1], [2,2,2,2]] -&gt; [6,48,20,16]\n</code></pre>\n\n<p>I try something like this but it doesn't work. If anyone knows how to do this will be really helpfully for me:</p>\n\n<pre><code>listOfProductInt :: [[Int]] -&gt; [Int]\nlistOfProductInt [] = []\nlistOfProductInt lists = foldl (\\y x-&gt; multipleInts x concat) [] lists\n\nmultipleInts :: (Num a) =&gt; [a] -&gt; a\nmultipleInts list1 = foldl (\\y x -&gt; y * x) 1 list1\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 7967, "user_id": 880367, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/QGKaN.png?s=128&g=1", "display_name": "Yogu", "link": "https://stackoverflow.com/users/880367/yogu"}, "is_accepted": true, "score": 5, "last_activity_date": 1492598779, "creation_date": 1492598779, "answer_id": 43493499, "question_id": 43493437, "link": "https://stackoverflow.com/questions/43493437/haskell-replicate-function/43493499#43493499", "title": "haskell replicate function &quot;+----+--+&quot;", "body": "<p>Just use <code>+</code> for the <code>[]</code> case:</p>\n\n<pre><code>print_line :: [Int] -&gt; String\nprint_line numbers = case numbers of\n    []      -&gt;  \"+\"\n    n:ns    -&gt; '+' :replicate n '-' ++ print_line ns\n</code></pre>\n\n<p>I didn't test it though and it has been a while since I programmed in Haskell the last time.</p>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1492600680, "post_id": 43494051, "comment_id": 74042705, "body": "<code>concat (replicate n &quot;-&quot;)</code> might be better written as <code>replicate n &#39;-&#39;</code>, and <code>concat (intersperse &quot;+&quot; xs)</code> is <code>intercalate &quot;+&quot; xs</code>. So a bikeshed version might be <code>print_line ns = intercalate &quot;+&quot; ([&quot;&quot;] ++ map (`replicate` &#39;-&#39;) ns ++ [&quot;&quot;])</code>."}, {"owner": {"reputation": 5008, "user_id": 5762796, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b3acb5c2021f4c279f29d61481b28e15?s=128&d=identicon&r=PG&f=1", "display_name": "Aleph0", "link": "https://stackoverflow.com/users/5762796/aleph0"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1492600906, "post_id": 43494051, "comment_id": 74042846, "body": "Thanks for the hint!. Really shortened everything."}], "tags": [], "owner": {"reputation": 5008, "user_id": 5762796, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/b3acb5c2021f4c279f29d61481b28e15?s=128&d=identicon&r=PG&f=1", "display_name": "Aleph0", "link": "https://stackoverflow.com/users/5762796/aleph0"}, "is_accepted": false, "score": 2, "last_activity_date": 1492600884, "last_edit_date": 1492600884, "creation_date": 1492600165, "answer_id": 43494051, "question_id": 43493437, "link": "https://stackoverflow.com/questions/43493437/haskell-replicate-function/43494051#43494051", "title": "haskell replicate function &quot;+----+--+&quot;", "body": "<p>Just a simple hack using <code>Data.List</code></p>\n\n<pre><code>import Data.List\n\nprint_line x=intercalate \"+\" . map (flip replicate '-') $ [0]++x++[0]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "edited": false, "score": 0, "creation_date": 1492632915, "post_id": 43494383, "comment_id": 74065139, "body": "You might also like the <code>foldr</code> version,  <code>printLine = foldr (fmap (&#39;+&#39;:) . (++) . flip replicate &#39;-&#39;) &quot;+&quot;</code>   ... or of course if you like parentheses <code>fmap (&#39;+&#39; :)</code> expands in this case to <code>((&#39;+&#39; :) .)</code> and as you&#39;ve written one can write <code>flip replicate &#39;-&#39;</code> with backticks at the cost of even more parens."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "edited": false, "score": 0, "creation_date": 1492699330, "post_id": 43494383, "comment_id": 74098853, "body": "@CRDrost I find the original simple and instantly understandable; this answer&#39;s version is nice but only after some concentration; and yours requires squinting for quite some time before I can decipher it (and even then I&#39;m not sure I got it right)."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "edited": false, "score": 0, "creation_date": 1492726363, "post_id": 43494383, "comment_id": 74114091, "body": "@CRDrost If I had performance issues with my function - yours is one that I would keep in mind for a benchmark and replacing the one I did, if necessary, though I would write a comment why this was done with <code>foldr</code> and a short explanation and a quickcheck testcase with the original. I wrote this answer with &quot;readability&quot; in mind less with a performance centric view."}, {"owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1492755036, "post_id": 43494383, "comment_id": 74122294, "body": "@DanielWagner That is ever the problem with <code>foldr</code>, it requires a sort of magical thinking. If I were doing it more readable-like I suppose the complicated function in the middle can be rendered <code>segmentFromInt n = (&#39;+&#39; :) . (replicate n &#39;-&#39; ++)</code> with <code>segmentFromInt :: Int -&gt; String -&gt; String</code>, and then the whole thing is <code>foldr segmentFromInt &quot;+&quot; nums</code>. Does that help?"}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 3, "last_activity_date": 1492726074, "last_edit_date": 1492726074, "creation_date": 1492601095, "answer_id": 43494383, "question_id": 43493437, "link": "https://stackoverflow.com/questions/43493437/haskell-replicate-function/43494383#43494383", "title": "haskell replicate function &quot;+----+--+&quot;", "body": "<p>Adding a small helper function writing the whole thing pointfree you get</p>\n\n<pre><code>import Data.List\n\nprintLine :: [Int] -&gt; String\nprintLine = between '+' . intercalate \"+\" . map (`replicate` '-')\n  where between c str =  c:(str ++[c])\n</code></pre>\n\n<h2>Edit</h2>\n\n<p>If I would use these a lot I would even go further and make extra functions like</p>\n\n<pre><code>fillWith c = map (`replicate` c)\nsepBy = intercalate\nbetween c str = c:(str++[c])\n</code></pre>\n\n<p>so I could write <code>printLine = between '+' . sepBy '+' . fillWith '-'</code> which reads much alike the (Atto/Mega/Parsec-) parser that I would write to parse a String like this, it also has the flexibility of changing the whole thing easily if my end result string should look like <code>|----+-----------+-----|</code>, or <code>|=========|========|========|</code>.</p>\n"}], "owner": {"reputation": 53, "user_id": 7888923, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8d5e00d3fdb902cd98979b65909a6188?s=128&d=identicon&r=PG&f=1", "display_name": "adsbb pppp", "link": "https://stackoverflow.com/users/7888923/adsbb-pppp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 828, "favorite_count": 1, "accepted_answer_id": 43493499, "answer_count": 3, "score": 0, "last_activity_date": 1492726074, "creation_date": 1492598611, "question_id": 43493437, "link": "https://stackoverflow.com/questions/43493437/haskell-replicate-function", "title": "haskell replicate function &quot;+----+--+&quot;", "body": "<pre><code>print_line :: [Int] -&gt; String\nprint_line numbers = case numbers of\n    []      -&gt;  []\n    n:ns    -&gt; '+' :replicate n '-' ++ print_line ns\n</code></pre>\n\n<p>I want when you give the Print_line function a list of Int for example [8,2] it returns\n    \"+--------+--+\"\nthe function at the moment will return \"+--------+--\" how can i fix this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 12415, "user_id": 544439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xfbSn.png?s=128&g=1", "display_name": "Josep", "link": "https://stackoverflow.com/users/544439/josep"}, "edited": false, "score": 5, "creation_date": 1492578972, "post_id": 43486880, "comment_id": 74029054, "body": "2 + 5 = <b>7</b>; 5 + 7 = <b>12</b>; 7 + 12 = <b>19</b>; 12 + 19 = <b>31</b>"}, {"owner": {"reputation": 49, "user_id": 7847399, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2c1ac10c45c67e1cd981a0079f33c4e6?s=128&d=identicon&r=PG", "display_name": "Jackie Doesque", "link": "https://stackoverflow.com/users/7847399/jackie-doesque"}, "reply_to_user": {"reputation": 12415, "user_id": 544439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xfbSn.png?s=128&g=1", "display_name": "Josep", "link": "https://stackoverflow.com/users/544439/josep"}, "edited": false, "score": 0, "creation_date": 1492579621, "post_id": 43486880, "comment_id": 74029310, "body": "@Josep Thank you, is there time for you to make this comment the answer so I can possibly accept/vote?"}, {"owner": {"reputation": 12415, "user_id": 544439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xfbSn.png?s=128&g=1", "display_name": "Josep", "link": "https://stackoverflow.com/users/544439/josep"}, "edited": false, "score": 1, "creation_date": 1492582171, "post_id": 43486880, "comment_id": 74030418, "body": "Thanks, but no worries: @bipll already answered the question. I think that you should accept their answer. It&#39;s all good. :-)"}, {"owner": {"reputation": 49, "user_id": 7847399, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2c1ac10c45c67e1cd981a0079f33c4e6?s=128&d=identicon&r=PG", "display_name": "Jackie Doesque", "link": "https://stackoverflow.com/users/7847399/jackie-doesque"}, "reply_to_user": {"reputation": 12415, "user_id": 544439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xfbSn.png?s=128&g=1", "display_name": "Josep", "link": "https://stackoverflow.com/users/544439/josep"}, "edited": false, "score": 0, "creation_date": 1492583285, "post_id": 43486880, "comment_id": 74031009, "body": "@Josep Okay, I&#39;ll do that, thanks for your tip in the comments :)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1492586564, "post_id": 43486880, "comment_id": 74033057, "body": "Potential duplicate of <a href=\"http://stackoverflow.com/q/1105765/3234959\">stackoverflow.com/q/1105765/3234959</a> -- also see <a href=\"http://stackoverflow.com/a/42183415/3234959\">stackoverflow.com/a/42183415/3234959</a>"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 7847399, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2c1ac10c45c67e1cd981a0079f33c4e6?s=128&d=identicon&r=PG", "display_name": "Jackie Doesque", "link": "https://stackoverflow.com/users/7847399/jackie-doesque"}, "edited": false, "score": 0, "creation_date": 1492580175, "post_id": 43487031, "comment_id": 74029512, "body": "I understand the concept now, though is there any way you can elaborate? I can see how it gets [2, 5, 7] since tail lazee is 5 and adding 2 to 5 = 7, but then why does it shift to 5 + 7 = 12?"}, {"owner": {"reputation": 765, "user_id": 3316409, "user_type": "registered", "profile_image": "https://graph.facebook.com/719585406/picture?type=large", "display_name": "dvaergiller", "link": "https://stackoverflow.com/users/3316409/dvaergiller"}, "edited": false, "score": 0, "creation_date": 1492608343, "post_id": 43487031, "comment_id": 74048339, "body": "Imagine that the list <code>lazee</code> is the list <code>5, 7, a, b, c, d, e ...</code>, then <code>tail lazee</code> is <code>7, a, b, c, d, e ...</code>. Now <code>zipwith (+)</code> will calculate the sums <code>a = 5+7, b = 7+a, c = a+b, d = b+c ...</code>. In each step, the necessary values to calculate the next value is available."}], "tags": [], "owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "is_accepted": true, "score": 4, "last_activity_date": 1492579511, "creation_date": 1492579511, "answer_id": 43487031, "question_id": 43486880, "link": "https://stackoverflow.com/questions/43486880/take-n-with-zipwith-and-tail/43487031#43487031", "title": "take n with zipWith and tail", "body": "<p>As @Josep pointed out in the comment, this is a stereotypical Haskell way to define Fibonacci sequence <code>x_n = x_n-1 + x_n-2</code> with initial conditions 2 and 5.</p>\n"}, {"comments": [{"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "edited": false, "score": 0, "creation_date": 1492721555, "post_id": 43508751, "comment_id": 74112228, "body": "Did you mean an infinite stream of 1s?"}, {"owner": {"reputation": 33, "user_id": 7676564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/523f124b1ccb5538fcc03e8fb68d2b50?s=128&d=identicon&r=PG", "display_name": "snow_lemurian_snow", "link": "https://stackoverflow.com/users/7676564/snow-lemurian-snow"}, "reply_to_user": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "edited": false, "score": 0, "creation_date": 1492735011, "post_id": 43508751, "comment_id": 74116538, "body": "Oh yes, thank you, I intended to do <code>a = &#39;a&#39; : a</code> first and then realised how confusing it&#39;d be. I forgot to change the rest, thanks for noticing ^^"}, {"owner": {"reputation": 49, "user_id": 7847399, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2c1ac10c45c67e1cd981a0079f33c4e6?s=128&d=identicon&r=PG", "display_name": "Jackie Doesque", "link": "https://stackoverflow.com/users/7847399/jackie-doesque"}, "edited": false, "score": 0, "creation_date": 1492820248, "post_id": 43508751, "comment_id": 74159741, "body": "Thanks, this is a very detailed answer. I&#39;ll look over it again once I have time."}], "tags": [], "owner": {"reputation": 33, "user_id": 7676564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/523f124b1ccb5538fcc03e8fb68d2b50?s=128&d=identicon&r=PG", "display_name": "snow_lemurian_snow", "link": "https://stackoverflow.com/users/7676564/snow-lemurian-snow"}, "is_accepted": false, "score": 1, "last_activity_date": 1492734967, "last_edit_date": 1492734967, "creation_date": 1492652321, "answer_id": 43508751, "question_id": 43486880, "link": "https://stackoverflow.com/questions/43486880/take-n-with-zipwith-and-tail/43508751#43508751", "title": "take n with zipWith and tail", "body": "<p>This is a very idiomatic way to write fibonnacci in Haskell.</p>\n\n<p>Basically, in Haskell, one tries to exploit laziness (the fact data is computed only when needed) as much as possible.</p>\n\n<p>So for instance, if you write <code>a = 1 : a</code>, you'd get an infinite stream of 1s (<code>1:1:1:1:...</code>). Yet if you do <code>take 100 a</code>, you get exactly 100 1s, and the program doesn't hang. That is because Haskell doesn't care for the rest of the list execept if you ask for it.</p>\n\n<p>So how does it tie with your question? Well let's run hand by hand this definition shall we?</p>\n\n<pre><code>lazee = 2:5:(zipWith (+) lazee (tail lazee))\n</code></pre>\n\n<p>So first, you put a 2 and a 5 in lazee. So right now we have</p>\n\n<pre><code>lazee = 2 : 5 : ...\ntail lazee = 5 : ...\n</code></pre>\n\n<p>(I'm using <code>...</code> to show non yet-computed values)\nThen you do something quite tricky: you define lazee in term of itself. I find this actually way more beautiful than mere recursion because you abstract the recursion away, leaving only the pattern very legillibly.\nZipWith is a function that zips two list together with a function\nSo</p>\n\n<pre><code>zipWith (+) lazee (tail lazee) = zipWith (+) (2 : 5 : ...) (5 : ...) = 7 ...\n</code></pre>\n\n<p>So now</p>\n\n<pre><code>lazee = 2, 5, 7, ...\ntail lazee = 5, 7, ...\nzipWith (+) lazee (tail lazee) = zipWith (+) (2, 5, 7, ...) (5, 7, ...) = 7 : zipWith (+) (5, 7, ...) (7, ...) = 7 : 12 : ...\n</code></pre>\n\n<p>And so on, Haskell creates lazee as it goes on, adding the term it currently reads on lazee with the next one.</p>\n\n<hr>\n\n<p>This is a pattern you might often see in one liner: constant values that are expressed in terms of themselves. A common exemple that comes to mind is the <em>very innefficient</em> list of primes</p>\n\n<pre><code>primes = sieve [2..]\n  where sieve (p:xs) = p : (filter ((== 1) . (gcd p)) $ sieve xs)\n</code></pre>\n\n<p>What does it do? Well <code>filter (== 1) . (gcd p)</code> takes only value that are coprime with p (ie. Those who have a greater gcd than 1 with p)</p>\n\n<p>So first we have</p>\n\n<pre><code>sieve [2..] = 2 : (filter ((== 1) . (gcd 2) $ sieve [3..])\n</code></pre>\n\n<p>Which means that we take 2 as a prime, and every number in <code>sieve [3..]</code> that are not even. <code>sieve [3..]</code> is 3 followed with every number that are not coprime with 3.</p>\n\n<p>If we run this on a little exemple:</p>\n\n<pre><code>sieve [4..] = 4 : ...\nsieve [3..] = 3 : 4 : ...\nsieve [2..] = 2 : 3 : ...\n</code></pre>\n\n<p>Notice how the <code>4</code> got erased.</p>\n\n<hr>\n\n<p>I hope that helped a bit. If you want to see some interesting one-liners, consider looking at <a href=\"https://wiki.haskell.org/Blow_your_mind\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Blow_your_mind</a>\nI personnally recommend you to avoid direct recursion (ie. One where you just call yourself with a changed parameters) in favor of such patterns and list manipulations as the one you posted. \n(For instance writing <code>fact n = product [1..n]</code> to define factorial)</p>\n\n<p>Have a nice journey in Haskell ;)</p>\n"}], "owner": {"reputation": 49, "user_id": 7847399, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2c1ac10c45c67e1cd981a0079f33c4e6?s=128&d=identicon&r=PG", "display_name": "Jackie Doesque", "link": "https://stackoverflow.com/users/7847399/jackie-doesque"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "accepted_answer_id": 43487031, "answer_count": 2, "score": 0, "last_activity_date": 1492734967, "creation_date": 1492578623, "last_edit_date": 1492578815, "question_id": 43486880, "link": "https://stackoverflow.com/questions/43486880/take-n-with-zipwith-and-tail", "title": "take n with zipWith and tail", "body": "<p>Making this code in Haskell GHC:</p>\n\n<pre><code>lazee = 2:5:(zipWith (+) lazee (tail lazee))\n</code></pre>\n\n<p>And then</p>\n\n<pre><code>take 6 lazee\n</code></pre>\n\n<p>Gives you this:</p>\n\n<pre><code>[2,5,7,12,19,31]\n</code></pre>\n\n<p>I can see only how it gives <code>2</code> and <code>5</code>, not sure why on the <code>[7,12,19,31]</code> part.</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1492587637, "post_id": 43485540, "comment_id": 74033755, "body": "Could it be a forward backward slash issue?"}, {"owner": {"reputation": 4681, "user_id": 1264328, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/786f8275d9fa334bc27630e0fc7f0d22?s=128&d=identicon&r=PG", "display_name": "bwroga", "link": "https://stackoverflow.com/users/1264328/bwroga"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1492622221, "post_id": 43485540, "comment_id": 74058691, "body": "@epsilonhalbe I tried building with all forward slashes and all back slashes in the yaml and cabal files and still got the same error."}], "answers": [{"tags": [], "owner": {"reputation": 4681, "user_id": 1264328, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/786f8275d9fa334bc27630e0fc7f0d22?s=128&d=identicon&r=PG", "display_name": "bwroga", "link": "https://stackoverflow.com/users/1264328/bwroga"}, "is_accepted": false, "score": 0, "last_activity_date": 1492623054, "creation_date": 1492623054, "answer_id": 43502423, "question_id": 43485540, "link": "https://stackoverflow.com/questions/43485540/stack-not-finding-c-library-in-non-standard-location/43502423#43502423", "title": "Stack not finding C library in non-standard location", "body": "<p>I got this to work by changing </p>\n\n<pre><code>extra-libraries:     fmod, fsbank\n</code></pre>\n\n<p>To</p>\n\n<pre><code>extra-libraries:     fmod64, fsbank64\n</code></pre>\n"}], "owner": {"reputation": 4681, "user_id": 1264328, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/786f8275d9fa334bc27630e0fc7f0d22?s=128&d=identicon&r=PG", "display_name": "bwroga", "link": "https://stackoverflow.com/users/1264328/bwroga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 269, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492623054, "creation_date": 1492570599, "last_edit_date": 1492622133, "question_id": 43485540, "link": "https://stackoverflow.com/questions/43485540/stack-not-finding-c-library-in-non-standard-location", "title": "Stack not finding C library in non-standard location", "body": "<p>I am creating bindings to some C libraries, but I am unable to get Stack to find them.</p>\n\n<p>My stack.yaml file has these declarations:</p>\n\n<pre><code>extra-include-dirs: \n- c:\\inc\nextra-lib-dirs: \n- c:\\lib\n</code></pre>\n\n<p>My cabal file has these declarations:</p>\n\n<pre><code>library\n  ...\n  extra-libraries:     fmod, fsbank\n  include-dirs:        c:\\inc\n  includes:            fmod.h, fsbank.h\n  extra-lib-dirs:      c:\\lib\n</code></pre>\n\n<p><code>fmod.DLL</code> and <code>fsbank.DLL</code> are located in <code>c:\\lib</code>. <code>fmod.h</code> and <code>fsbank.h</code> are located in <code>c:\\inc</code>.</p>\n\n<p>When I build I get an error message: <code>Missing C Libraries: fmod, fsbank</code></p>\n\n<p>How can I point Stack to these files?</p>\n\n<p>I'm pretty sure the header files are being located, because when I comment out <code>extra-include-dirs</code> and <code>include-dirs</code>, the error message also states \n<code>Missing (or bad header) file: fmod.h</code></p>\n\n<p>I am using Windows 7 64 bit and Stack 1.4.0.</p>\n"}, {"tags": ["haskell", "audio"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1492570975, "post_id": 43485073, "comment_id": 74026571, "body": "Which types GHC says that are missing instances? I suggest you edit your question to include the full error message."}, {"owner": {"reputation": 155, "user_id": 7659347, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/vhPYA.png?s=128&g=1", "display_name": "Eben Cowley", "link": "https://stackoverflow.com/users/7659347/eben-cowley"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1492571814, "post_id": 43485073, "comment_id": 74026795, "body": "@duplode Just did"}, {"owner": {"reputation": 4185, "user_id": 15467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89c04ada36efa853c7f5be0a96b6dd9?s=128&d=identicon&r=PG", "display_name": "ja.", "link": "https://stackoverflow.com/users/15467/ja"}, "edited": false, "score": 0, "creation_date": 1492574736, "post_id": 43485073, "comment_id": 74027601, "body": "Do you have pulseAudio installed?  Might have an easier time on Windows with DirectSound."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 4185, "user_id": 15467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89c04ada36efa853c7f5be0a96b6dd9?s=128&d=identicon&r=PG", "display_name": "ja.", "link": "https://stackoverflow.com/users/15467/ja"}, "edited": false, "score": 0, "creation_date": 1492575048, "post_id": 43485073, "comment_id": 74027713, "body": "@ja. The issue described in the question isn&#39;t related to PulseAudio."}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 7659347, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/vhPYA.png?s=128&g=1", "display_name": "Eben Cowley", "link": "https://stackoverflow.com/users/7659347/eben-cowley"}, "edited": false, "score": 0, "creation_date": 1492669292, "post_id": 43487115, "comment_id": 74077181, "body": "This solved that problem, but now I&#39;ve run into another issue I&#39;ve never had to deal with before: a linking error due to &quot;undefined references&quot; to <code>pa_simple_free</code>, <code>pa_simple_get_latency</code>, etc. Wasn&#39;t sure if I should start a new question over this so I figured I&#39;d just check if there was a quick fix in the comments"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 155, "user_id": 7659347, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/vhPYA.png?s=128&g=1", "display_name": "Eben Cowley", "link": "https://stackoverflow.com/users/7659347/eben-cowley"}, "edited": false, "score": 0, "creation_date": 1492669641, "post_id": 43487115, "comment_id": 74077380, "body": "@EbenCowley Being an unrelated issue, it should go to a new question. (I&#39;m afraid I can&#39;t help much with it, other than noting that these are functions from the <a href=\"http://0pointer.de/lennart/projects/pulseaudio/doxygen/simple_8h.html\" rel=\"nofollow noreferrer\">C PulseAudio library</a>, and so you&#39;ll probably want to begin by checking whether that is properly installed in your system.)"}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 1, "last_activity_date": 1492579758, "creation_date": 1492579758, "answer_id": 43487115, "question_id": 43485073, "link": "https://stackoverflow.com/questions/43485073/sound-pulse-simple-not-working/43487115#43487115", "title": "Sound.Pulse.Simple not working?", "body": "<p>The \"ambiguous type variable\" errors mean that there wasn't enough information for the type checker to decide which type it should use to instantiate the type classes. To fix that, add a type annotation that specifies the type of the list elements, such as:</p>\n\n<pre><code>simpleWrite s ([sin $ 2*pi*440*(t/44100)|t&lt;-[1..44100*10]] :: [Float])\n</code></pre>\n\n<p>(The example in the <a href=\"http://hackage.haskell.org/package/pulse-simple-0.1.14/docs/Sound-Pulse-Simple.html\" rel=\"nofollow noreferrer\">documentation for the latest version of the library</a>, unlike the one you linked to, does include the missing annotation.)</p>\n\n<p>There are a few things left to explain, though. Firstly, you mention that you tried to fix the error by \"switch[ing] everything to a Float\". I suppose this attempt corresponds to the second set of errors you included, and that you changed <code>[1 .. 44100 * 10]</code> to <code>[1.0, 2.0 .. 44100.0 * 10.0]</code> and so forth. If that is indeed the case, it didn't work because adding a decimal point doesn't actually change the type to <code>Float</code>, because Haskell numeric literals are polymorphic:</p>\n\n<pre><code>GHCi&gt; :t 1\n1 :: Num t =&gt; t\nGHCi&gt; :t 1.0\n1.0 :: Fractional t =&gt; t\n</code></pre>\n\n<p>That also means that even in the absence of the type annotation the range in <code>[sin $ 2*pi*440*(t/44100)|t&lt;-[1..44100*10]]</code> generates floating point values, as if that weren't the case there would be no way to use them with <code>sin</code> and <code>(/)</code>. While in your case there is no risk of inaccuracy as far as the range is concerned (that problem only arises with step sizes that aren't whole numbers, or, for different reasons, with very large numbers), using e.g. <code>Integer</code>s for the range is possible as long as you introduce a suitable conversion function:</p>\n\n<pre><code>[sin $ 2*pi*440*(fromInteger t/44100)|t&lt;-[1..44100*10]]\n</code></pre>\n\n<p>Secondly, you might wonder why you got ambiguity errors this time, given that you have been using those polymorphic literals with no issues beforehand. You don't usually get such errors because there is a defaulting mechanism for polymorphic numbers that, in ambiguous cases, picks whichever of <code>Integer</code> or <code>Double</code> is more appropriate (see the <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch4.html#x10-790004.3.4\" rel=\"nofollow noreferrer\">Haskell Report</a> for details). This mechanism, however, only kicks in if the classes the polymorphic number calls for are drawn from a limited set of standard classes -- which makes sense, as if you are using more exotic classes the odds of the guess by the compiler being inappropriate increase. Now, if you look at the type of <code>simpleWrite</code>...</p>\n\n<pre><code>simpleWrite :: Storable a =&gt; Simple -&gt; [a] -&gt; IO ()\n</code></pre>\n\n<p>... you will note that it requires <code>Storable</code>. <code>Storable</code> is not among the aforementioned set of standard classes, and so there is no defaulting.</p>\n"}], "owner": {"reputation": 155, "user_id": 7659347, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/vhPYA.png?s=128&g=1", "display_name": "Eben Cowley", "link": "https://stackoverflow.com/users/7659347/eben-cowley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492579758, "creation_date": 1492567525, "last_edit_date": 1492571782, "question_id": 43485073, "link": "https://stackoverflow.com/questions/43485073/sound-pulse-simple-not-working", "title": "Sound.Pulse.Simple not working?", "body": "<p>I downloaded <a href=\"http://hackage.haskell.org/package/pulse-simple-0.1.11/docs/Sound-Pulse-Simple.html\" rel=\"nofollow noreferrer\">Sound.Pulse.Simple</a> and copy and pasted the example program:</p>\n\n<pre><code>main=do\n  s&lt;-simpleNew Nothing \"example\" Play Nothing \"this is example application\"\n      (SampleSpec (F32 LittleEndian) 44100 1) Nothing Nothing\n  simpleWrite s [sin $ 2*pi*440*(t/44100)|t&lt;-[1..44100*10]]\n  simpleDrain s\n  simpleFree s\n</code></pre>\n\n<p>into atom and tried to compile it just to make sure it would work on my system. ghc is really upset, here's the full error message (even though it's obscenely long):</p>\n\n<pre><code>soundtest.hs:6:5:\nNo instance for (Foreign.Storable.Storable a0)\n  arising from a use of `simpleWrite'\nThe type variable `a0' is ambiguous\nNote: there are several potential instances:\n  instance Foreign.Storable.Storable BufferAttr -- Defined in `Sound'\n  instance Foreign.Storable.Storable Sound.ChannelMap\n    -- Defined in `Sound'\n  instance Foreign.Storable.Storable SampleSpec -- Defined in `Sound'\n  ...plus 45 others\nIn a stmt of a 'do' block:\n  simpleWrite\n    s [sin $ 2 * pi * 440 * (t / 44100) | t &lt;- [1 .. 44100 * 10]]\nIn the expression:\n  do { s &lt;- simpleNew\n              Nothing\n              \"example\"\n              Play\n              Nothing\n              \"this is example application\"\n              (SampleSpec (F32 LittleEndian) 44100 1)\n              Nothing\n              Nothing;\n       simpleWrite\n         s [sin $ 2 * pi * 440 * (t / 44100) | t &lt;- [1 .. 44100 * 10]];\n       simpleDrain s;\n       simpleFree s }\nIn an equation for `main':\n    main\n      = do { s &lt;- simpleNew\n                    Nothing\n                    \"example\"\n                    Play\n                    Nothing\n                    \"this is example application\"\n                    (SampleSpec (F32 LittleEndian) 44100 1)\n                    Nothing\n                    Nothing;\n             simpleWrite\n               s [sin $ 2 * pi * 440 * (t / 44100) | t &lt;- [1 .. 44100 * 10]];\n             simpleDrain s;\n             .... }\n\nsoundtest.hs:6:20:\nNo instance for (Floating a0) arising from a use of `sin'\nThe type variable `a0' is ambiguous\nRelevant bindings include t :: a0 (bound at soundtest.hs:6:45)\nNote: there are several potential instances:\n  instance Floating Foreign.C.Types.CDouble\n    -- Defined in `Foreign.C.Types'\n  instance Floating Foreign.C.Types.CFloat\n    -- Defined in `Foreign.C.Types'\n  instance Floating Double -- Defined in `GHC.Float'\n  ...plus one other\nIn the expression: sin\nIn the expression: sin $ 2 * pi * 440 * (t / 44100)\nIn the second argument of `simpleWrite', namely\n  `[sin $ 2 * pi * 440 * (t / 44100) | t &lt;- [1 .. 44100 * 10]]'\n\nsoundtest.hs:6:37:\nNo instance for (Fractional a0) arising from a use of `/'\nThe type variable `a0' is ambiguous\nRelevant bindings include t :: a0 (bound at soundtest.hs:6:45)\nNote: there are several potential instances:\n  instance Fractional Foreign.C.Types.CDouble\n    -- Defined in `Foreign.C.Types'\n  instance Fractional Foreign.C.Types.CFloat\n    -- Defined in `Foreign.C.Types'\n  instance Integral a =&gt; Fractional (GHC.Real.Ratio a)\n    -- Defined in `GHC.Real'\n  ...plus two others\nIn the second argument of `(*)', namely `(t / 44100)'\nIn the second argument of `($)', namely\n  `2 * pi * 440 * (t / 44100)'\nIn the expression: sin $ 2 * pi * 440 * (t / 44100)\n\nsoundtest.hs:6:48:\nNo instance for (Enum a0)\n  arising from the arithmetic sequence `1 .. 44100 * 10'\nThe type variable `a0' is ambiguous\nNote: there are several potential instances:\n  instance Enum ChannelPosition -- Defined in `Sound'\n  instance Enum Direction -- Defined in `Sound'\n  instance Enum SampleFormat -- Defined in `Sound'\n  ...plus 45 others\nIn the expression: [1 .. 44100 * 10]\nIn a stmt of a list comprehension: t &lt;- [1 .. 44100 * 10]\nIn the second argument of `simpleWrite', namely\n  `[sin $ 2 * pi * 440 * (t / 44100) | t &lt;- [1 .. 44100 * 10]]'\n\nsoundtest.hs:6:49:\nNo instance for (Num a0) arising from the literal `1'\nThe type variable `a0' is ambiguous\nNote: there are several potential instances:\n  instance Num Foreign.C.Types.CChar -- Defined in `Foreign.C.Types'\n  instance Num Foreign.C.Types.CClock -- Defined in `Foreign.C.Types'\n  instance Num Foreign.C.Types.CDouble\n    -- Defined in `Foreign.C.Types'\n  ...plus 38 others\nIn the expression: 1\nIn the expression: [1 .. 44100 * 10]\nIn a stmt of a list comprehension: t &lt;- [1 .. 44100 * 10]\n\nsoundtest.hs:6:5:\nNo instance for (Foreign.Storable.Storable a0)\n  arising from a use of `simpleWrite'\nThe type variable `a0' is ambiguous\nNote: there are several potential instances:\n  instance Foreign.Storable.Storable BufferAttr -- Defined in `Sound'\n  instance Foreign.Storable.Storable Sound.ChannelMap\n    -- Defined in `Sound'\n  instance Foreign.Storable.Storable SampleSpec -- Defined in `Sound'\n  ...plus 45 others\nIn a stmt of a 'do' block:\n  simpleWrite\n    s\n    [sin $ 2.0 * pi * 440.0 * (t / 44100.0) |\n       t &lt;- [1.0, 2.0 .. 44100.0 * 10.0]]\nIn the expression:\n  do { s &lt;- simpleNew\n              Nothing\n              \"example\"\n              Play\n              Nothing\n              \"this is example application\"\n              (SampleSpec (F32 LittleEndian) 44100 1)\n              Nothing\n              Nothing;\n       simpleWrite\n         s\n         [sin $ 2.0 * pi * 440.0 * (t / 44100.0) |\n            t &lt;- [1.0, 2.0 .. 44100.0 * 10.0]];\n       simpleDrain s;\n       simpleFree s }\nIn an equation for `main':\n    main\n      = do { s &lt;- simpleNew\n                    Nothing\n                    \"example\"\n                    Play\n                    Nothing\n                    \"this is example application\"\n                    (SampleSpec (F32 LittleEndian) 44100 1)\n                    Nothing\n                    Nothing;\n             simpleWrite\n               s\n               [sin $ 2.0 * pi * 440.0 * (t / 44100.0) |\n                  t &lt;- [1.0, 2.0 .. 44100.0 * 10.0]];\n             simpleDrain s;\n             .... }\n\nsoundtest.hs:6:20:\nNo instance for (Floating a0) arising from a use of `sin'\nThe type variable `a0' is ambiguous\nRelevant bindings include t :: a0 (bound at soundtest.hs:6:51)\nNote: there are several potential instances:\n  instance Floating Foreign.C.Types.CDouble\n    -- Defined in `Foreign.C.Types'\n  instance Floating Foreign.C.Types.CFloat\n    -- Defined in `Foreign.C.Types'\n  instance Floating Double -- Defined in `GHC.Float'\n  ...plus one other\nIn the expression: sin\nIn the expression: sin $ 2.0 * pi * 440.0 * (t / 44100.0)\nIn the second argument of `simpleWrite', namely\n  `[sin $ 2.0 * pi * 440.0 * (t / 44100.0) |\n      t &lt;- [1.0, 2.0 .. 44100.0 * 10.0]]'\n\nsoundtest.hs:6:54:\nNo instance for (Enum a0)\n  arising from the arithmetic sequence `1.0, 2.0 .. 44100.0 * 10.0'\nThe type variable `a0' is ambiguous\nNote: there are several potential instances:\n  instance Enum ChannelPosition -- Defined in `Sound'\n  instance Enum Direction -- Defined in `Sound'\n  instance Enum SampleFormat -- Defined in `Sound'\n  ...plus 45 others\nIn the expression: [1.0, 2.0 .. 44100.0 * 10.0]\nIn a stmt of a list comprehension:\n  t &lt;- [1.0, 2.0 .. 44100.0 * 10.0]\nIn the second argument of `simpleWrite', namely\n  `[sin $ 2.0 * pi * 440.0 * (t / 44100.0) |\n      t &lt;- [1.0, 2.0 .. 44100.0 * 10.0]]'\n\nsoundtest.hs:6:55:\nNo instance for (Fractional a0) arising from the literal `1.0'\nThe type variable `a0' is ambiguous\nNote: there are several potential instances:\n  instance Fractional Foreign.C.Types.CDouble\n    -- Defined in `Foreign.C.Types'\n  instance Fractional Foreign.C.Types.CFloat\n    -- Defined in `Foreign.C.Types'\n  instance Integral a =&gt; Fractional (GHC.Real.Ratio a)\n    -- Defined in `GHC.Real'\n  ...plus two others\nIn the expression: 1.0\nIn the expression: [1.0, 2.0 .. 44100.0 * 10.0]\nIn a stmt of a list comprehension:\n  t &lt;- [1.0, 2.0 .. 44100.0 * 10.0]\n\nsoundtest.hs:6:71:\nNo instance for (Num a0) arising from a use of `*'\nThe type variable `a0' is ambiguous\nNote: there are several potential instances:\n  instance Num Foreign.C.Types.CChar -- Defined in `Foreign.C.Types'\n  instance Num Foreign.C.Types.CClock -- Defined in `Foreign.C.Types'\n  instance Num Foreign.C.Types.CDouble\n    -- Defined in `Foreign.C.Types'\n  ...plus 38 others\nIn the expression: 44100.0 * 10.0\nIn the expression: [1.0, 2.0 .. 44100.0 * 10.0]\nIn a stmt of a list comprehension:\n  t &lt;- [1.0, 2.0 .. 44100.0 * 10.0]\n</code></pre>\n\n<p>I tried switching everything to a <code>Float</code> (even though that risks floating point imprecision with the range) and it still won't compile. Is there another library I have to download or something? Is there a different library for sound output I should be using? I'm on windows and using the Haskell Platform 2014.2.0.0</p>\n"}, {"tags": ["haskell", "monads", "monad-transformers", "writer-monad"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1492567645, "post_id": 43485025, "comment_id": 74025732, "body": "Why don&#39;t you want to unwrap the monad?"}, {"owner": {"reputation": 1286, "user_id": 675799, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/87c5d0a7b707c5bfc04b415e96edef11?s=128&d=identicon&r=PG", "display_name": "krokodil", "link": "https://stackoverflow.com/users/675799/krokodil"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1492568184, "post_id": 43485025, "comment_id": 74025894, "body": "Ideally, I would like monad to track whole computation tree. Later I can use different Monoid to build a trace or do some other analysis. Implicitly unwrapping it will break this (I think). Full disclosure: the example above is in Haskell but I am actually implementing this in Coq :)"}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 1, "creation_date": 1492573546, "post_id": 43485025, "comment_id": 74027259, "body": "However you end up solving this, you will need a way to combine the <code>XFlags</code> coming from <code>xplus</code> with the <code>SFlags</code> coming from <code>splus</code>."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1492580997, "post_id": 43485025, "comment_id": 74029876, "body": "@krokodil, maybe you misunderstand monads.  There&#39;s nothing you can do with a monad that you can&#39;t do without one -- it&#39;s just shorthand.  So unwrap, do what you need to do, and wrap it back up again.  If your monad is keeping track of computation trees, just don&#39;t throw away that info when you unwrap/wrap."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1492597570, "post_id": 43485025, "comment_id": 74040472, "body": "Just use the state monad?"}, {"owner": {"reputation": 1286, "user_id": 675799, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/87c5d0a7b707c5bfc04b415e96edef11?s=128&d=identicon&r=PG", "display_name": "krokodil", "link": "https://stackoverflow.com/users/675799/krokodil"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1492625384, "post_id": 43485025, "comment_id": 74060626, "body": "@BenjaminHodgson Writer monad guarantees that my computation results never depend on state."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1492637407, "post_id": 43485025, "comment_id": 74067547, "body": "To reinforce @luqui &#39;s point, if you check the <a href=\"http://hackage.haskell.org/package/transformers-0.5.4.0/docs/src/Control.Monad.Trans.Writer.Lazy.html#mapWriter\" rel=\"nofollow noreferrer\">source of the <code>mapWriter</code> function</a> that is used in <a href=\"http://stackoverflow.com/a/43498169/2751851\">David Fletcher&#39;s answer</a> you&#39;ll find that all it does is unwrapping, applying the function and wrapping it back again."}], "answers": [{"tags": [], "owner": {"reputation": 1780, "user_id": 4168972, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc92e82d2eb21eb030d4c133c70ff554?s=128&d=identicon&r=PG&f=1", "display_name": "David Fletcher", "link": "https://stackoverflow.com/users/4168972/david-fletcher"}, "is_accepted": true, "score": 2, "last_activity_date": 1492611700, "last_edit_date": 1492611700, "creation_date": 1492611028, "answer_id": 43498169, "question_id": 43485025, "link": "https://stackoverflow.com/questions/43485025/swapping-mappend-in-writer-monad/43498169#43498169", "title": "Swapping `mappend` in Writer monad", "body": "<p>You can get something reasonable using <a href=\"http://hackage.haskell.org/package/transformers-0.5.4.0/docs/Control-Monad-Trans-Writer-Lazy.html#v:mapWriter\" rel=\"nofollow noreferrer\"><code>mapWriter</code></a>.</p>\n\n<pre><code>sFromX :: XInt -&gt; SInt\nsFromX = mapWriter (\\(x, XF fs) -&gt; (x, SF fs))\n</code></pre>\n\n<p>Now you can write <code>foo</code> like</p>\n\n<pre><code>foo :: SInt\nfoo = splus (return 1) (sFromX (xplus (return 2) (return 3)))\n</code></pre>\n\n<p>You might need the opposite, <code>xFromS</code> as well.  If you had more than two different monoids maybe it would be worth getting fancier and writing a class for flag containers, something like:</p>\n\n<pre><code>class FlagContainer a where\n  getFlags :: a -&gt; Flags\n  makeFromFlags :: Flags -&gt; a\n</code></pre>\n\n<p>Then use it to write a single function which would replace <code>sFromX</code>, <code>xFromS</code>, and\nany others you need.  (Haven't tested this though.)</p>\n"}], "owner": {"reputation": 1286, "user_id": 675799, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/87c5d0a7b707c5bfc04b415e96edef11?s=128&d=identicon&r=PG", "display_name": "krokodil", "link": "https://stackoverflow.com/users/675799/krokodil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 43498169, "answer_count": 1, "score": 2, "last_activity_date": 1492611700, "creation_date": 1492567185, "last_edit_date": 1492570808, "question_id": 43485025, "link": "https://stackoverflow.com/questions/43485025/swapping-mappend-in-writer-monad", "title": "Swapping `mappend` in Writer monad", "body": "<p>Summary: While using Writer monad, I would like to be able to switch between 2 different versions of <code>mappend</code> without losing the state.</p>\n\n<p>I use two boolean flags to track some state:</p>\n\n<pre><code>data Flags = F Bool Bool\n</code></pre>\n\n<p>Now I define two <code>Monoid</code> instances which differ in a way they combine the flags in <code>mappend</code>:</p>\n\n<pre><code>newtype XFlags = XF Flags\n\ninstance Monoid XFlags where\n  mempty = XF (F True False)\n  (XF (F s0 c0)) `mappend` (XF (F s1 c1)) = XF (F (s0 &amp;&amp; s1)\n  (c0 || c1 || not (s0 || s1)))\n\nnewtype SFlags = SF Flags\n\ninstance Monoid SFlags where\n  mempty = SF (F True False)\n  (SF (F s0 c0)) `mappend` (SF (F s1 c1)) = SF (F (s0 &amp;&amp; s1) (c0 || c1))\n</code></pre>\n\n<p>Now I can have 2 Writer monads with different flags handling:</p>\n\n<pre><code>type XInt = WriterT XFlags Identity Int\ntype SInt = WriterT SFlags Identity Int\n</code></pre>\n\n<p>Now I can have operations like:</p>\n\n<pre><code>xplus :: XInt -&gt; XInt -&gt; XInt\nxplus = liftM2 (+)\n\nsplus :: SInt -&gt; SInt -&gt; SInt\nsplus = liftM2 (+)\n</code></pre>\n\n<p>Now to I would like to build expressions like:</p>\n\n<pre><code>foo = splus (return 1) (xplus (return 2) (return 3))\n</code></pre>\n\n<p>To do so I need to be able to convert between the two without losing any flags and preferably without unwrapping the monad (using <code>runWriter</code>). This part I have not been figure out. It looks little bit like I can try to nest Writers using monad transformer but I am not sure if it is applicable directly here. I will appreciate some guidance on the best way to implement something like this.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 2, "creation_date": 1492563520, "post_id": 43482809, "comment_id": 74024743, "body": "Note that all GADTs do for you in this case is make the <code>forall</code> implicit in the syntax. There is no technical difference between the GADT here and the ADT in the question, it is simply different syntax."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 11, "last_activity_date": 1492552816, "last_edit_date": 1492552816, "creation_date": 1492552301, "answer_id": 43482809, "question_id": 43482610, "link": "https://stackoverflow.com/questions/43482610/how-to-do-existential-quantification-with-gadt/43482809#43482809", "title": "How to do existential quantification with GADT?", "body": "<p>Normally a GADT with a polymorphic constructor would have a type argument, so that you could know what type was used when constructing it, such as:</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\ndata Value a where\n  Str :: String -&gt; ExType String\n  Number :: Int -&gt; ExType Int\n  Other :: a -&gt; ExType a\n</code></pre>\n\n<p>However, the key thing an existential type does is bury this type, so that you can't know what <code>a</code> it was constructed with, merely that some type <code>a</code> exists that it contains. So, simply drop the type argument from its type constructor, and from the result types of the data constructors.</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\ndata ExType where\n  One :: a -&gt; ExType\n  Two :: a -&gt; ExType\n  Three :: a -&gt; ExType\n\nfoo :: [ExType]\nfoo = [One 3, Two \"hello\", One 'G']\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 6, "last_activity_date": 1492552339, "creation_date": 1492552339, "answer_id": 43482819, "question_id": 43482610, "link": "https://stackoverflow.com/questions/43482610/how-to-do-existential-quantification-with-gadt/43482819#43482819", "title": "How to do existential quantification with GADT?", "body": "<p>I cannot tell if GADTs are the new black but - here is your example using this syntax.</p>\n\n<pre><code>{-# LANGUAGE ExplicitForAll     #-}\n{-# LANGUAGE GADTs              #-}\n\ndata ExType where\n  One :: forall a. a -&gt; ExType\n  Two :: forall a. a -&gt; ExType\n  Three :: forall a. a -&gt; ExType\n\nlst :: [ExType]\nlst = [One 3, Two \"hello\", Three 'A']\n</code></pre>\n\n<p>Note that deriving instances for GADTs is best done with <code>{-# LANGUAGE StandaloneDeriving #-}</code>, though even basic stuff like <code>Eq</code> won't work because of the constraint <code>forall a.</code></p>\n"}], "owner": {"reputation": 1995, "user_id": 713861, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/1ed73350b722bb9ea9d5a8720a1af4f3?s=128&d=identicon&r=PG", "display_name": "GreenSaguaro", "link": "https://stackoverflow.com/users/713861/greensaguaro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 719, "favorite_count": 1, "accepted_answer_id": 43482809, "answer_count": 2, "score": 6, "last_activity_date": 1492552816, "creation_date": 1492551412, "question_id": 43482610, "link": "https://stackoverflow.com/questions/43482610/how-to-do-existential-quantification-with-gadt", "title": "How to do existential quantification with GADT?", "body": "<p>I have the following data type:</p>\n\n<pre><code>{-# LANGUAGE ExistentialQuantification #-}\n\ndata ExType = forall a. One a | forall a. Two a | forall a. Three a\n</code></pre>\n\n<p>With that I am able to create heterogeneous lists:</p>\n\n<p><code>[One 3, Two \"hello\", One 'G']</code></p>\n\n<p>I have been told that GADTs are the new way to do this. That GADTs can implicitly do what I am trying to do above. I have, so far, not been able to create a type with GADTs that allow me to do a heterogeneous list. How do I do this?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1492527558, "post_id": 43475469, "comment_id": 74006484, "body": "<code>1 + ((10 * 0) + (10 * 0 + 0))</code> does equal one.  Perhaps you wanted <code>foldl</code>?"}, {"owner": {"reputation": 139, "user_id": 6053118, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Y9Y01.jpg?s=128&g=1", "display_name": "Quentin Liu", "link": "https://stackoverflow.com/users/6053118/quentin-liu"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1492528050, "post_id": 43475469, "comment_id": 74006887, "body": "@ThomasM.DuBuisson yes! how careless I am LOL. Thanks a lot."}], "answers": [{"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1492532765, "post_id": 43476957, "comment_id": 74010328, "body": "In fairness, using <code>read</code> changes the semantics a bit.  <code>-18478429</code> and <code>((42))</code> are both valid strings for bounds of 43 or more."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1492537830, "post_id": 43476957, "comment_id": 74013348, "body": "I often throw <code>ensure p x = x &lt;$ guard (p x)</code> into codebases (much like your <code>toMaybe</code>). I do wish something like it were in a standard-ish package."}, {"owner": {"reputation": 139, "user_id": 6053118, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Y9Y01.jpg?s=128&g=1", "display_name": "Quentin Liu", "link": "https://stackoverflow.com/users/6053118/quentin-liu"}, "edited": false, "score": 0, "creation_date": 1492577095, "post_id": 43476957, "comment_id": 74028355, "body": "So whenever I want a imperative-style debugger, it is a sign that I am not thinking functionally?"}, {"owner": {"reputation": 295, "user_id": 1946543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c5bc3cc803d2303f47cb3d9c56fcfd1?s=128&d=identicon&r=PG", "display_name": "Steven Armstrong", "link": "https://stackoverflow.com/users/1946543/steven-armstrong"}, "edited": false, "score": 1, "creation_date": 1492619806, "post_id": 43476957, "comment_id": 74057066, "body": "It is a pretty good sign yes. A lot of thinking functionally is thinking about transforming values in a pure manner, and combining a series of transformations to produce the desired results. Since you can simply look at the entire intermediate state of everything relevant as a normal value, and your transformations are defined equationally, a traditional debugger tends to have much less to contribute when you really get thinking in a pure functional manner.  There are of course, times when you just can&#39;t do something in a pure functional manner, but those are fairly infrequent."}], "tags": [], "owner": {"reputation": 295, "user_id": 1946543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c5bc3cc803d2303f47cb3d9c56fcfd1?s=128&d=identicon&r=PG", "display_name": "Steven Armstrong", "link": "https://stackoverflow.com/users/1946543/steven-armstrong"}, "is_accepted": true, "score": 4, "last_activity_date": 1492552020, "last_edit_date": 1492552020, "creation_date": 1492531096, "answer_id": 43476957, "question_id": 43475469, "link": "https://stackoverflow.com/questions/43475469/arithmetic-error-when-trying-to-add-two-numbers/43476957#43476957", "title": "Arithmetic error when trying to add two numbers", "body": "<p>This is a <em>very</em> imperative way of solving the problem, and if you keep thinking like that you're going to have difficulties moving forward.</p>\n\n<p>Here's how you might want to re-think the problem:</p>\n\n<p>Replace \"<em>I have a list of characters, but I want digits, I'll iterate and replace them one by one</em>\" with \"<em>I have a list of characters but I want digits, I'll just replace them all at once</em>\" (I'm going to assume you want to actually parse the string yourself fully manually rather than just using <code>read</code> or some kind of parsing tool)</p>\n\n<p>So far we have:</p>\n\n<pre><code>reachBounded limit str = ... map digitToInt str\n</code></pre>\n\n<p>Next, you want to turn these digits into a number. Replace \"<em>I want to iterate through this list increment a sum</em>\" with \"<em>I need to know the place value of each digit</em>\". We can do this by reversing the digits and multiplying them pairwise with the list [1,10,100,1000...]. We can produce the place value list by mapping (10^) over the list of positive integers, or declaring that each element is 10 times the previous, starting with 1. Let's use the latter:</p>\n\n<pre><code>reachBounded limit str = ... zipWith (*) (iterate (*10) 1) $ reverse $ map digitToInt str\n</code></pre>\n\n<p>And we want the sum of these place values:</p>\n\n<pre><code>reachBounded limit str = ... where\n    val = sum $ zipWith (*) (iterate (*10) 1) $ reverse $ map digitToInt str\n</code></pre>\n\n<p>Lastly, we must check if it's within the bound given:</p>\n\n<pre><code>reachBounded limit str = val &lt;$ guard (val &lt; limit) where\n    val = sum $ zipWith (*) (iterate (*10) 1) $ reverse $ map digitToInt str\n</code></pre>\n\n<p>In this case <code>a &lt;$ b</code> will replace the contents of <code>b</code> with <code>a</code> if <code>b</code> is <code>Just something</code>, and leave it alone if <code>b</code> is <code>Nothing</code>.</p>\n\n<p>In terms of debugging, it is now trivial, as it is not some process we need to interrupt, but a series of values that we manipulate to get the desired result. You cannot run part of your process on each step and get a sensible answer, but here we can look at the result produced by any of these stages and see if we are on track.</p>\n\n<p>There isn't a <code>toMaybe :: (a -&gt; Bool) -&gt; a -&gt; Maybe a</code> function. I'm not sure why, but with one and using read, the solution is merely:</p>\n\n<pre><code>bounded l = toMaybe (&lt;l) . read\n</code></pre>\n\n<p>Or using the <code>Safe</code> library...</p>\n\n<pre><code>bounded l = toMaybe (&lt;l) &lt;=&lt; readMay\n</code></pre>\n\n<p>Which will not throw exceptions if you don't input a string that actually represents a number.</p>\n\n<hr>\n\n<p>Now, let's say you really do want to write your algorithm iteratively, maybe you need to for performance or it's just one of those algorithms that doesn't readily admit a declarative implementation (there aren't many of those, though). It's still going to be cleaner to use values instead of exceptions, but you need to stop and look at it sometimes.. so what do you do?</p>\n\n<p>Let's write our own iterator function:</p>\n\n<pre><code>data Iter a b c = Next a | Final b | Error c\n\niterateE :: (a -&gt; Iter a b c) -&gt; a -&gt; ([a], Either c b)\niterateE f = go where\n    go x = case f x of\n        Next a -&gt; let (list, final) = go a in (x:list, final)\n        Final b -&gt; ([x], Right b)\n        Error c -&gt; ([x], Left c)\n</code></pre>\n\n<p>This more directly encapsulates stopping the fold early and tracking the intermediate results - even though you can also just stop folds early and track the intermediate results - this is a simpler way to think about it for now. This will provide you with a complete list of all intermediate states and either a result or error that your iterator function can choose to terminate with.</p>\n\n<p>Transforming your solution into this format...</p>\n\n<pre><code>reachBounded limit str = iterateE iter (Just 0,str) where\n    iter (n, []) = Final n\n    iter (n, (s:str)) = Next (do\n        sum &lt;- s\n        let n = sum * 10 + digitToInt digit \n        guard (isDigit digit) \n        guard (n &lt;= limit) \n        return n, str)\n</code></pre>\n\n<p>... we don't don't announce any error in this code, but this will let us see what's happened at each step, and also doesn't have a direction in the fold, so you can't get it backwards between left and right.</p>\n"}], "owner": {"reputation": 139, "user_id": 6053118, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Y9Y01.jpg?s=128&g=1", "display_name": "Quentin Liu", "link": "https://stackoverflow.com/users/6053118/quentin-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 1, "accepted_answer_id": 43476957, "answer_count": 1, "score": 1, "last_activity_date": 1492552020, "creation_date": 1492527039, "question_id": 43475469, "link": "https://stackoverflow.com/questions/43475469/arithmetic-error-when-trying-to-add-two-numbers", "title": "Arithmetic error when trying to add two numbers", "body": "<p>I tried to implement a function that takes a limit and a string, parses the string and tests if the parsed number exceeds the limit. The function works well only for strings without 0s in it, like <code>\"123\"</code>. However, it could not parse strings correctly like <code>\"100\"</code>, whose result is <code>1</code>. </p>\n\n<p>What caused this problem? </p>\n\n<p>Below is the code. </p>\n\n<pre><code>reachBounded :: Int -&gt; String -&gt; Maybe Int \nreachBounded limit str = case str of \n    \"\"  -&gt; Nothing \n    \"0\" -&gt; Just 0\n    _   -&gt; foldr (\\digit s -&gt; do \n                sum &lt;- s\n                let n = sum * 10 + digitToInt digit \n                guard (isDigit digit) \n                guard (n &lt;= limit) \n                return n)\n            (Just 0) str\n</code></pre>\n\n<p>Moreover, is there any way to debug this code like we normally do in imperative languages? I found ghci debugger only able to print the type, not the value. </p>\n"}, {"tags": ["function", "haskell"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1492526816, "post_id": 43475251, "comment_id": 74005839, "body": "What do you mean by &quot;replacement function&quot;?  Can you give a bit more of a concrete example?  However, I&#39;m going to guess that the answer is probably &quot;not without some refactoring&quot;.  If you could somehow make <code>f</code>, <code>g</code>, and co live under a single typeclass then you could rewrite all of your <code>c</code> functions to use that typeclass instead.  Alternatively, you can do explicit passing by creating a data type that has fields for each function you want to use.  There&#39;s probably also a template haskell solution possible, but I rarely suggest TH unless there really is no other way."}, {"owner": {"reputation": 817, "user_id": 1077657, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/77827a893cf80112cc4157d96d81f5e0?s=128&d=identicon&r=PG", "display_name": "BenJacob", "link": "https://stackoverflow.com/users/1077657/benjacob"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1492527043, "post_id": 43475251, "comment_id": 74006049, "body": "Could you elaborate a little on the typeclass approach? I presume I would have a typeclass with a function that takes the function and produces another function in the manner I want but how then do I use this to produce <code>c&#39;</code>?"}, {"owner": {"reputation": 3392, "user_id": 7175117, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Tfz44.png?s=128&g=1", "display_name": "freestyle", "link": "https://stackoverflow.com/users/7175117/freestyle"}, "edited": false, "score": 0, "creation_date": 1492527267, "post_id": 43475251, "comment_id": 74006232, "body": "Maybe idea from &#39;Automatic differentiation&#39; can help you."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1492527512, "post_id": 43475251, "comment_id": 74006442, "body": "@BenJacob Something like <a href=\"https://gist.github.com/anonymous/f5b44a138c346e2878aa7e88054a7311\" rel=\"nofollow noreferrer\">gist.github.com/anonymous/f5b44a138c346e2878aa7e88054a7311</a> might work (this is pseudocode), but each alternate implementation has to be similar enough.  It also has restrictions in that each function needs to use the <code>api</code> type somewhere."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1492534075, "post_id": 43475251, "comment_id": 74011104, "body": "You can&#39;t really do this without generalizing your function in some way (using type classes in some way, passing function arguments, etc). In order to direct you to what the best option is, we would need more information about what you&#39;re trying to accomplish. What problem are you working on (or, at the very least, what problem domain) and are there any constraints at all to how these functions can be altered?"}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 1, "last_activity_date": 1492529392, "creation_date": 1492529392, "answer_id": 43476342, "question_id": 43475251, "link": "https://stackoverflow.com/questions/43475251/replacing-functions-in-composite-function-in-haskell/43476342#43476342", "title": "Replacing functions in composite function in haskell", "body": "<p>If, as seems to be the case with your example, <code>f</code> and <code>f'</code> have the same type etc., then you can easily pass them in as extra parameters. Like</p>\n\n<pre><code>cGen :: ([a] -&gt; [a] -&gt; [a]) -&gt; (([a] -&gt; [a]) -&gt; b) -&gt; [a] -&gt; b\ncGen f g x = g (f x)\n</code></pre>\n\n<p>...which BTW could also be written <code>cGen = (.)</code>...</p>\n\n<p>If you want to group together specific \u201csets of functions\u201d, you can do that with a \u201cconfiguration type\u201d</p>\n\n<pre><code>data CConfig a b = CConfig {\n       f :: [a] -&gt; [a] -&gt; [a]\n     , g :: ([a] -&gt; [a]) -&gt; b\n     }\n\ncGen :: CConfig a b -&gt; [a] -&gt; b\ncGen (CConfig f g) = f . g\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 295, "user_id": 1946543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c5bc3cc803d2303f47cb3d9c56fcfd1?s=128&d=identicon&r=PG", "display_name": "Steven Armstrong", "link": "https://stackoverflow.com/users/1946543/steven-armstrong"}, "is_accepted": false, "score": 0, "last_activity_date": 1492535819, "creation_date": 1492535819, "answer_id": 43478434, "question_id": 43475251, "link": "https://stackoverflow.com/questions/43475251/replacing-functions-in-composite-function-in-haskell/43478434#43478434", "title": "Replacing functions in composite function in haskell", "body": "<p>The most concise and reliable way to do something like this would be with <code>RecordWildCards</code></p>\n\n<pre><code>data Replacer ... = R {f :: ..., g :: ...}\n\nc R{..} x = g (f x)\n</code></pre>\n\n<p>Your set of functions now is now pulled from the local scope from the record, rather than a global definition, and can be swapped out for a different set of functions at your discretion.</p>\n\n<p>The only way to get closer to what you want would to be to use Template Haskell to parse the source and modify it. Regular Haskell code simply cannot inspect a function in any way - that would violate referential transparency.</p>\n"}], "owner": {"reputation": 817, "user_id": 1077657, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/77827a893cf80112cc4157d96d81f5e0?s=128&d=identicon&r=PG", "display_name": "BenJacob", "link": "https://stackoverflow.com/users/1077657/benjacob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 43476342, "answer_count": 2, "score": 0, "last_activity_date": 1492550178, "creation_date": 1492526451, "last_edit_date": 1492550178, "question_id": 43475251, "link": "https://stackoverflow.com/questions/43475251/replacing-functions-in-composite-function-in-haskell", "title": "Replacing functions in composite function in haskell", "body": "<p>I'm trying to become familiar with Haskell and I was wondering if the following was possible and if so, how?</p>\n\n<p>Say I have a set of functions <code>{f,g,..}</code> for which I was to define a replacement function <code>{f',g',..}</code>. Now say I have a function <code>c</code> which uses these functions (and only these functions) inside itself e.g. <code>c x = g (f x)</code>. Is there a way to automatically define <code>c' x = g' (f' x)</code> without explicitly defining it?</p>\n\n<p>EDIT: By a replacement function <code>f'</code> I mean some function that is conceptually relates to <code>f</code> by is altered in some arbitrary way. For example, if <code>f xs ys = (*) &lt;$&gt; xs &lt;*&gt; ys</code> then <code>f' (x:xs) (y:ys) = (x * y):(f' xs ys)</code> etc.</p>\n\n<p>Many thanks,\nBen </p>\n"}, {"tags": ["haskell", "threepenny-gui"], "answers": [{"comments": [{"owner": {"reputation": 781, "user_id": 1163717, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/cbba7289a669e4ca1fcf1064d0cf22fd?s=128&d=identicon&r=PG&f=1", "display_name": "The Red Fox", "link": "https://stackoverflow.com/users/1163717/the-red-fox"}, "edited": false, "score": 0, "creation_date": 1492619721, "post_id": 43484192, "comment_id": 74057018, "body": "Thanks! I completely forgot to try putting it as child elements to show them again. That works."}], "tags": [], "owner": {"reputation": 1178, "user_id": 1667161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233658d12fabd9d72b04d0a6916f6389?s=128&d=identicon&r=PG", "display_name": "liminalisht", "link": "https://stackoverflow.com/users/1667161/liminalisht"}, "is_accepted": true, "score": 2, "last_activity_date": 1492560904, "creation_date": 1492560904, "answer_id": 43484192, "question_id": 43471902, "link": "https://stackoverflow.com/questions/43471902/how-to-recreate-an-element-in-threepenny-gui/43484192#43484192", "title": "How to recreate an element in Threepenny GUI?", "body": "<p>Given that <code>delete</code> has the signature <code>delete :: Element -&gt; UI ()</code>, it follows that when you call <code>delete</code>, you have an <code>Element</code> in hand. Why can't you just hold onto this <code>Element</code> somewhere? (By which I mean maintain a reference to it in any number of ways.) Then just use <code>(#+) :: UI Element -&gt; [UI Element] -&gt; UI Element</code> to attach it as a child to another element later. If you just want it to reappear where it was before, you'd just attach it as a child to the very element that was its parent to begin with. Is this what you had in mind, or did I misunderstand the question?</p>\n"}, {"comments": [{"owner": {"reputation": 781, "user_id": 1163717, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/cbba7289a669e4ca1fcf1064d0cf22fd?s=128&d=identicon&r=PG&f=1", "display_name": "The Red Fox", "link": "https://stackoverflow.com/users/1163717/the-red-fox"}, "edited": false, "score": 0, "creation_date": 1492773452, "post_id": 43515127, "comment_id": 74134435, "body": "Oh right, I didn&#39;t realize it worked that way. I&#39;ll fix that then. Would be good to put that into the documentation though, since it doesn&#39;t make it clear that they shouldn&#39;t be usable after <code>delete</code>."}], "tags": [], "owner": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "is_accepted": false, "score": 3, "last_activity_date": 1492679506, "creation_date": 1492679506, "answer_id": 43515127, "question_id": 43471902, "link": "https://stackoverflow.com/questions/43471902/how-to-recreate-an-element-in-threepenny-gui/43515127#43515127", "title": "How to recreate an element in Threepenny GUI?", "body": "<p>(Library author here)</p>\n\n<p>Actually the, <code>delete</code> function does more than just remove the element from the DOM tree \u2014 it tries to delete any references to it in the JS and Haskell side. Essentially the element is (should be) unuseable after a <code>delete</code>.</p>\n\n<p>If you want to temporarily hide an element, you can</p>\n\n<ul>\n<li>Hide it via the CSS <code>display</code> property.</li>\n<li>Rest the children of the parent element, e.g. by <code>element parent # set children []</code>.</li>\n</ul>\n"}], "owner": {"reputation": 781, "user_id": 1163717, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/cbba7289a669e4ca1fcf1064d0cf22fd?s=128&d=identicon&r=PG&f=1", "display_name": "The Red Fox", "link": "https://stackoverflow.com/users/1163717/the-red-fox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "accepted_answer_id": 43484192, "answer_count": 2, "score": 2, "last_activity_date": 1492679506, "creation_date": 1492517826, "question_id": 43471902, "link": "https://stackoverflow.com/questions/43471902/how-to-recreate-an-element-in-threepenny-gui", "title": "How to recreate an element in Threepenny GUI?", "body": "<p>If I use the <code>delete</code> function on some <code>Element</code>s, how can I then recreate them (as in make them appear again)?</p>\n\n<p>I have looked around the examples and documentation, but I couldn't find any function that would allow me to do this except maybe <code>mkElement</code> which requires me to pass it a <code>String</code>. However since I'm working with <code>Element</code>s getting the <code>String</code> that would create it would be a bit difficult.</p>\n\n<p>So is there any way to do that?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 2, "creation_date": 1492512689, "post_id": 43470010, "comment_id": 73995116, "body": "I cannot reproduce that error. What&#39;s the minimal <code>Golf.hs</code> that reproduces that behaviour?"}, {"owner": {"reputation": 7463, "user_id": 1145760, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/065408758852145010d28c2aa811ca68?s=128&d=identicon&r=PG", "display_name": "Vorac", "link": "https://stackoverflow.com/users/1145760/vorac"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1492513021, "post_id": 43470010, "comment_id": 73995324, "body": "@Zeta I&#39;m sure it&#39;s a silly question, and could probably resolve it by myself by rtfm, but there seem to pop too many of those questions at the moment."}, {"owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "edited": false, "score": 2, "creation_date": 1492515010, "post_id": 43470010, "comment_id": 73996585, "body": "As the error says, you should rename your module to <code>Main</code> or import it from another main module."}, {"owner": {"reputation": 7323, "user_id": 343957, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FAVPm.jpg?s=128&g=1", "display_name": "mathk", "link": "https://stackoverflow.com/users/343957/mathk"}, "edited": false, "score": 0, "creation_date": 1492515140, "post_id": 43470010, "comment_id": 73996677, "body": "You can always reload a module using <code>:reload</code> in ghci."}, {"owner": {"reputation": 7463, "user_id": 1145760, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/065408758852145010d28c2aa811ca68?s=128&d=identicon&r=PG", "display_name": "Vorac", "link": "https://stackoverflow.com/users/1145760/vorac"}, "reply_to_user": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "edited": false, "score": 0, "creation_date": 1492515411, "post_id": 43470010, "comment_id": 73996885, "body": "@dimid the module and file are named as per the homework assignment. I was hoping to preserve the simple workflow &quot;write functions -&gt; write invocations with test data -&gt; compile -&gt; run -&gt; observe stdout&quot;. <code>reload</code>-ing modules in <code>ghci</code> is extra steps. Writing a separate <code>Main.hs</code>, which imports <code>Golf.hs</code> is extra steps plus spatial fragmentation. Maybe <code>runghc</code>  could aid me. I have never used it."}, {"owner": {"reputation": 6119, "user_id": 165753, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/w6iBN.jpg?s=128&g=1", "display_name": "dimid", "link": "https://stackoverflow.com/users/165753/dimid"}, "edited": false, "score": 0, "creation_date": 1492515944, "post_id": 43470010, "comment_id": 73997252, "body": "@Vorac Yeah, in that case you can just run <code>runghc Golf.hs</code>, but IMHO ghci is easier."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1492617941, "post_id": 43470010, "comment_id": 74055805, "body": "&quot; I would like to also understand the raw command-line invocations, that make programs work. &quot; then just use <code>cabal</code> and run it with <code>-v3</code>, in which case it will print all of the commands it runs to build your program. Also, one should note that re-loading a module in GHCi will basically always be much, much faster than compiling (except, when your code consists of 10 lines or so)."}], "answers": [{"comments": [{"owner": {"reputation": 7463, "user_id": 1145760, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/065408758852145010d28c2aa811ca68?s=128&d=identicon&r=PG", "display_name": "Vorac", "link": "https://stackoverflow.com/users/1145760/vorac"}, "edited": false, "score": 1, "creation_date": 1492582268, "post_id": 43471150, "comment_id": 74030470, "body": "This seems to be a classical example of XY problem. I was asking how to structure modules for testability, and the best solutions turns out to be <code>ghci</code>."}], "tags": [], "owner": {"reputation": 1227, "user_id": 5053374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efe57f0998df065470ff42c938f781cf?s=128&d=identicon&r=PG", "display_name": "Libby", "link": "https://stackoverflow.com/users/5053374/libby"}, "is_accepted": true, "score": 3, "last_activity_date": 1492515691, "creation_date": 1492515691, "answer_id": 43471150, "question_id": 43470010, "link": "https://stackoverflow.com/questions/43470010/module-level-tests-in-haskell/43471150#43471150", "title": "Module-level tests in Haskell", "body": "<p><code>ghci</code> is a really useful tool for learning!</p>\n\n<p>When you only have one module, it's very easy, too. Start <code>ghci</code>, then <code>:l Golf.hs</code>. This will load your file. Then you'll be able to type <code>foo 342</code> and see \"42\" displayed, or <code>main</code> and see \"hello\". You can edit the file, then use <code>:reload</code> or <code>:r</code> to load your changes. <a href=\"http://book.realworldhaskell.org/read/getting-started.html\" rel=\"nofollow noreferrer\">Real World Haskell</a> has a good intro to using <code>ghci</code>.</p>\n\n<p>This is a little easier than using <code>ghc</code> or tools like <code>cabal</code>, and all you really need while you're learning the very basics.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1492538842, "creation_date": 1492538842, "answer_id": 43479332, "question_id": 43470010, "link": "https://stackoverflow.com/questions/43470010/module-level-tests-in-haskell/43479332#43479332", "title": "Module-level tests in Haskell", "body": "<p>If you want to use <code>ghc</code>-the-compiler (instead of its interactive variant <code>ghci</code>), you might use the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/phases.html?highlight=main-is#ghc-flag--main-is\" rel=\"nofollow noreferrer\"><code>-main-is</code></a> option.</p>\n\n<p>From the docs:</p>\n\n<blockquote>\n  <p><code>-main-is\u27e8thing\u27e9</code></p>\n  \n  <p>The normal rule in Haskell is that your program must supply a main function in module <code>Main</code>. When testing, it is often convenient to\n  change which function is the \u201cmain\u201d one, and the <code>-main-is</code> flag allows\n  you to do so. The <code>\u27e8thing\u27e9</code> can be one of:</p>\n  \n  <ul>\n  <li>A lower-case identifier <code>foo</code>. GHC assumes that the main function is <code>Main.foo</code>.</li>\n  <li>A module name <code>A</code>. GHC assumes that the main function is <code>A.main</code>.</li>\n  <li>A qualified name <code>A.foo</code>. GHC assumes that the main function is <code>A.foo</code>.</li>\n  </ul>\n</blockquote>\n\n<p>So, try <code>ghc -main-is Golf2 Golf2.hs -o Golf2 &amp;&amp; ./Golf2</code>.</p>\n"}], "owner": {"reputation": 7463, "user_id": 1145760, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/065408758852145010d28c2aa811ca68?s=128&d=identicon&r=PG", "display_name": "Vorac", "link": "https://stackoverflow.com/users/1145760/vorac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 43471150, "answer_count": 2, "score": 0, "last_activity_date": 1492538842, "creation_date": 1492512283, "last_edit_date": 1492512967, "question_id": 43470010, "link": "https://stackoverflow.com/questions/43470010/module-level-tests-in-haskell", "title": "Module-level tests in Haskell", "body": "<p>I am getting acquainted to Haskell, currently writing my third \"homework\" to some course I found on the web. The homework assignment needs to be presented* in a file, named <code>Golf.hs</code>, starting with <code>module Golf where</code>. All well and good, this seems to be idiomatic in the language.</p>\n\n<p>However, I am used to python modules ending in <code>if __name__ == \"__main__:</code>, where one can put tests over the module, including during module development.<code>ghc</code> doesn't seem happy with such an approach:</p>\n\n<pre><code>$ ghc Golf.hs -o Golf &amp;&amp; ./Golf\n\n&lt;no location info&gt;: error:\n    output was redirected with -o, but no output will be generated\n</code></pre>\n\n<p>Even though using <code>cabal</code> seems to be the norm, I would like to also understand the raw command-line invocations, that make programs work. <code>ghci</code> seems to be another approach to testing newly written code, yet reloading modules is peta. What is the easiest way to write some invocations of my functions with predefined test data and observe on <code>stdout</code> the result?</p>\n\n<p><sub>* - for students, who actually attend the course, I just follow the lecture notes and strive to complete the homeworks</sub></p>\n\n<p>Golf2.hs:</p>\n\n<pre><code>{-# OPTIONS_GHC -Wall #-}\n\nmodule Golf2 where\n\nfoo :: Int -&gt; Int\nfoo n = 42\n\nmain = putStr \"Hello\"\n</code></pre>\n\n<p>The output:</p>\n\n<pre><code>$ ghc Golf2.hs -o Golf2\n[1 of 1] Compiling Golf             ( Golf2.hs, Golf2.o )\n\nGolf2.hs:6:5: warning: [-Wunused-matches] Defined but not used: \u2018n\u2019\n\nGolf2.hs:8:1: warning: [-Wmissing-signatures]\n    Top-level binding with no type signature: main :: IO ()\n\n&lt;no location info&gt;: error:\n    output was redirected with -o, but no output will be generated\nbecause there is no Main module.\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1492497766, "post_id": 43465101, "comment_id": 73985943, "body": "Try adding type signatures to get a better error."}, {"owner": {"reputation": 7323, "user_id": 343957, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FAVPm.jpg?s=128&g=1", "display_name": "mathk", "link": "https://stackoverflow.com/users/343957/mathk"}, "edited": false, "score": 0, "creation_date": 1492514926, "post_id": 43465101, "comment_id": 73996535, "body": "You also need to check that the exponent is not negative. In other word make sure your number is at least of 2 digit."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 6473325, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/83a984b18bddba398c7bea7cfc0e3305?s=128&d=identicon&r=PG&f=1", "display_name": "Amateur", "link": "https://stackoverflow.com/users/6473325/amateur"}, "edited": false, "score": 0, "creation_date": 1492499158, "post_id": 43465344, "comment_id": 73986658, "body": "Thank you very much Zeta. I understand the issue now."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 3, "last_activity_date": 1492497789, "creation_date": 1492497789, "answer_id": 43465344, "question_id": 43465101, "link": "https://stackoverflow.com/questions/43465101/extracting-first-two-digits-of-a-number-haskell/43465344#43465344", "title": "extracting first two digits of a number haskell", "body": "<p>You use <code>div</code> on <code>n</code> and <code>divisor</code>, but <code>divisor</code> isn't the same type as <code>n</code>, it's a function. That's why you end up with <code>Integral (r -&gt; a)</code>.</p>\n\n<p>Use <code>firstTwo n = div n (divisor n)</code>, but keep in mind that <code>logBase</code> only works on <code>Floating</code> such as <code>Double</code> and <code>Float</code>, whereas <code>div</code> only works on <code>Integral</code> such as <code>Integer</code> and <code>Int</code>. Therefore, it will still not compile, unless you've changed <code>len</code>'s type.</p>\n\n<p>Add type signatures to your function to get better error messages.</p>\n"}, {"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 3, "last_activity_date": 1492512511, "last_edit_date": 1492512511, "creation_date": 1492501346, "answer_id": 43466444, "question_id": 43465101, "link": "https://stackoverflow.com/questions/43465101/extracting-first-two-digits-of-a-number-haskell/43466444#43466444", "title": "extracting first two digits of a number haskell", "body": "<p>As you seem to be a beginner my very first advice would be, to add type information as much as possible. At least for every top level (function) definition. This helps you, the compiler and everyone else reading your code understanding \u200byour intent.</p>\n\n<p>Now to your problem: you try to divide a number <code>n</code> by a function <code>divisor</code> </p>\n\n<pre><code>div n (divisor n)\n</code></pre>\n\n<p>Should do the trick, well there is one small bit missing - <code>logBase</code> does not work on integers, while <code>div</code> does only work on integers. So you need to call <code>fromInteger</code> first to convert.</p>\n\n<p>An alternative that would work with a small adjustment for negative numbers could be <code>take 2 . show</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 121, "user_id": 2924117, "user_type": "registered", "profile_image": "https://graph.facebook.com/821112709/picture?type=large", "display_name": "Arthur Welf", "link": "https://stackoverflow.com/users/2924117/arthur-welf"}, "is_accepted": false, "score": 1, "last_activity_date": 1492544729, "last_edit_date": 1492544729, "creation_date": 1492502349, "answer_id": 43466730, "question_id": 43465101, "link": "https://stackoverflow.com/questions/43465101/extracting-first-two-digits-of-a-number-haskell/43466730#43466730", "title": "extracting first two digits of a number haskell", "body": "<ol>\n<li><p>Convert your number to String. </p></li>\n<li><p>Check if the string contains 2 or more chars. </p></li>\n<li><p>If the check is successful, take first 2 chars from your string and convert them to Int (or put those chars in tuple or do with them whatever you want). </p></li>\n<li><p>Do something with the case if your number contains less than 2 digits (throw error for example).</p>\n\n<pre><code>firstTwo :: Integer -&gt; Int\nfirstTwo n\n  | (length . show $ n) &gt;= 2 = read . take 2 . show $ n\n  | otherwise = error \"The number contains less than 2 digits\"\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 49, "user_id": 6473325, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/83a984b18bddba398c7bea7cfc0e3305?s=128&d=identicon&r=PG&f=1", "display_name": "Amateur", "link": "https://stackoverflow.com/users/6473325/amateur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 998, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1492551802, "creation_date": 1492496986, "last_edit_date": 1492551802, "question_id": 43465101, "link": "https://stackoverflow.com/questions/43465101/extracting-first-two-digits-of-a-number-haskell", "title": "extracting first two digits of a number haskell", "body": "<p>I'm getting a frustrating error when I try to extract the first two digits of a number. First, I work out the length of digit using log, then I divide the number by the <code>10^(length of digit - 2)</code> to extract the first two digits. The len and divisor functions work fine, but the firstTwo function fails, and I don't understand this because it seems so straight forward. I even tried adding <code>{-# LANGUAGE FlexibleContexts #-}</code>, but nothing.  Please assist. Here's the code:</p>\n\n<pre><code>len n = (+) 1 $ truncate $ logBase 10 n -- length of a digit\n\ndivisor n = 10 ^ (len n - 2)\n\nfirstTwo n = div n divisor\n</code></pre>\n\n<p>The error I get is: </p>\n\n<p>Non type-variable argument in the constraint: <code>Integral (r -&gt; a)</code></p>\n\n<pre><code>(Use FlexibleContexts to permit this)\nWhen checking that \u2018firstTwo\u2019 has the inferred type\n  firstTwo :: forall a r.\n              (Floating r, Integral (r -&gt; a), Num a, RealFrac r) =&gt;\n              (r -&gt; a) -&gt; r -&gt; a\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1492476095, "post_id": 43461746, "comment_id": 73979451, "body": "It&#39;s eta reduction.  Notice all sorts of wonderful uses, such as <code>plus = (+)</code> - how does it know there are two arguments? Eta reduction (googleable term).  <code>sumListV4 = sum</code> is more similar to your examples and the same concept."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1492493903, "post_id": 43461746, "comment_id": 73984187, "body": "Perhaps you don&#39;t buy that just because <code>foo xs = myFoldr (+) 0 xs</code> then we also know <code>foo = myFoldr (+) 0</code>. But do you buy the other implication? Does it make sense that if <code>foo = myFoldr (+) 0</code> then <code>foo xs = myFoldr (+) 0 xs</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 833, "user_id": 7847896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3e72cb1d5eceb94842bec50894e6943?s=128&d=identicon&r=PG&f=1", "display_name": "zbw", "link": "https://stackoverflow.com/users/7847896/zbw"}, "is_accepted": false, "score": 8, "last_activity_date": 1492983349, "last_edit_date": 1492983349, "creation_date": 1492477503, "answer_id": 43461940, "question_id": 43461746, "link": "https://stackoverflow.com/questions/43461746/spooky-haskell-function-that-somehow-knows-your-input/43461940#43461940", "title": "Spooky haskell function that somehow knows your input", "body": "<p>Functions in Haskell are \"curried\".</p>\n\n<p>This means that when you have a function <code>f :: a -&gt; b -&gt; c</code>, it's really <code>a -&gt; (b -&gt; c)</code>, and <code>f a b</code> is really <code>(f a) b</code> (because of associativity rules).</p>\n\n<p>So when you run <code>f a b</code>, it first does <code>f a</code>, which returns a new function of type <code>b -&gt; c</code>.  You can then give it a <code>b</code> and get your final answer of type <code>c</code>.</p>\n\n<p>This lets you partially apply functions:</p>\n\n<pre><code>ghci&gt; let add :: Int -&gt; Int -&gt; Int ; add a b = a + b\nghci&gt; add 2 3\n5\nghci&gt; (add 2) 3\n5\nghci&gt; let addToTwo = add 2\nghci&gt; :t addToTwo\naddToTwo :: Int -&gt; Int\nghci&gt; addToTwo 6\n8\nghci&gt; addToTwo 9\n11\n</code></pre>\n\n<p>What your example for <code>sumListV3</code> is doing is partially applying <code>myFoldr</code>. (Types here specified to your case.)</p>\n\n<pre><code>myFoldr       :: (Int -&gt; Int -&gt; Int) -&gt;  Int -&gt;  [Int] -&gt; Int\nmyFoldr       :: (Int -&gt; Int -&gt; Int) -&gt; (Int -&gt; ([Int] -&gt; Int))\nmyFoldr (+)   ::                         Int -&gt; ([Int] -&gt; Int)\nmyFoldr (+) 0 ::                                 [Int] -&gt; Int\nsumListV3     ::                                 [Int] -&gt; Int\n</code></pre>\n\n<p>Because <code>sumListV3</code> is defined as <code>myFoldr (+) 0</code>, you can replace <code>sumListV3</code> with <code>myFoldr (+) 0</code> in places where it is called:</p>\n\n<pre><code>sumListV3 [1,2] \n  = (myFoldr (+) 0) [1,2]\n  = myFoldr (+) 0 [1,2]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 23111, "user_id": 1319998, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/9f600f4583bec89109ce8c0c098951ae?s=128&d=identicon&r=PG", "display_name": "Michal Charemza", "link": "https://stackoverflow.com/users/1319998/michal-charemza"}, "is_accepted": false, "score": 1, "last_activity_date": 1492493548, "creation_date": 1492493548, "answer_id": 43464318, "question_id": 43461746, "link": "https://stackoverflow.com/questions/43461746/spooky-haskell-function-that-somehow-knows-your-input/43464318#43464318", "title": "Spooky haskell function that somehow knows your input", "body": "<p>Often there are multiple ways of defining a function in Haskell. In this case, you can use (basic) pattern matching on the argument <code>xs</code></p>\n\n<pre><code>sumListV2 :: [Int] -&gt; Int\nsumListV2 xs = myFoldr (+) 0 xs\n</code></pre>\n\n<p>which, in this case, is very similar, conceptually, to the \"usual\" C-style syntax, in this case Javascript.</p>\n\n<pre><code>var sumListV2 =  function(xs) {\n  return myFoldr(plusFunc, 0, xs)\n}\n</code></pre>\n\n<p>Or you can define the function in terms of a composition of other functions, also known as pointfree style.</p>\n\n<pre><code>sumListV3 :: [Int] -&gt; Int\nsumListV3 = myFoldr (+) 0\n</code></pre>\n\n<p>In this case, the thing to note is that on the r.h.s. isn't the return value of <code>myFoldr</code>, but, because <code>myFoldr</code> has been partially applied* with two of its three arguments, it's a function that takes the remaining one, a list. So <code>sumListV3</code> is defined to be this: a function that takes a list.</p>\n\n<p>An equivalent in Javascript is possible using <code>bind</code> to partially apply myFold.</p>\n\n<pre><code>var sumListV2 = myFold.bind(null, plusFunc, 0);\n</code></pre>\n\n<p>A really nifty thing about Haskell is that this is built into the language, so you don't need extra functions to do partial application. The tricky thing about Haskell, especially coming from other languages, is that you don't need extra functions to do partial application ;-). Tricky because the syntax for pattern matching and partial application is so similar while in other languages they are wildly different.</p>\n\n<hr>\n\n<p>*It's not giving the entire picture, as it's more accurate to delve into currying and the fact that every function in Haskell just takes one argument, and a function that takes 3 is a \"chain\" of functions that return functions. But I find it a useful analogy, especially when comparing to partial application in other languages.</p>\n"}], "owner": {"reputation": 45, "user_id": 7728834, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/559cba976f5ac51dc6afca9cb520655b?s=128&d=identicon&r=PG&f=1", "display_name": "John Doe", "link": "https://stackoverflow.com/users/7728834/john-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1492983349, "creation_date": 1492475815, "last_edit_date": 1492477765, "question_id": 43461746, "link": "https://stackoverflow.com/questions/43461746/spooky-haskell-function-that-somehow-knows-your-input", "title": "Spooky haskell function that somehow knows your input", "body": "<p>How can <code>sumListV3</code> function? <code>myFoldr</code> requires 3 args: function, base case num, and list. Yet it somehow knows the list (based on your input) even though it was never specified in the internal code.</p>\n\n<p>I think <code>sumListV2</code> is the simplest it can go. How does <code>sumListV3</code> even compile, let alone function properly?</p>\n\n<pre><code>myFoldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b\nmyFoldr _ baseCase [] = baseCase\nmyFoldr f b (x:xs) = f x (myFoldr f b xs)\n\nsumListV2 :: [Int] -&gt; Int\nsumListV2 xs = myFoldr (+) 0 xs\n\nsumListV3 :: [Int] -&gt; Int\nsumListV3 = myFoldr (+) 0 \n</code></pre>\n"}, {"tags": ["algorithm", "haskell"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1492451750, "post_id": 43456302, "comment_id": 73969076, "body": "Your problem is kind of underspecified in my opinion. <code>GenTree</code>s are bigger than <code>BinTree</code>s, in the sense that they have more stuff in them: a <code>NodeG</code> has many children whereas a <code>NodeB</code> has only two. What should your code do when you encounter a <code>NodeG</code> that doesn&#39;t fit into a <code>NodeB</code>? You&#39;ll need to come up with some sort of flattening strategy"}, {"owner": {"reputation": 656, "user_id": 6739197, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/596ca15ff00c5f201050c7b3194d9fd2?s=128&d=identicon&r=PG&f=1", "display_name": "victor.ja", "link": "https://stackoverflow.com/users/6739197/victor-ja"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1492453847, "post_id": 43456302, "comment_id": 73970201, "body": "Added more in depth explanation of the problem and a visual example of how the function should work"}], "answers": [{"tags": [], "owner": {"reputation": 3627, "user_id": 3695939, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d75f41bcfc1d3f20c084ec7e87d82012?s=128&d=identicon&r=PG&f=1", "display_name": "moondaisy", "link": "https://stackoverflow.com/users/3695939/moondaisy"}, "is_accepted": true, "score": 3, "last_activity_date": 1492469379, "last_edit_date": 1492469379, "creation_date": 1492456144, "answer_id": 43457913, "question_id": 43456302, "link": "https://stackoverflow.com/questions/43456302/function-to-turn-a-gentree-to-a-binary-tree/43457913#43457913", "title": "Function to turn a GenTree to a Binary Tree", "body": "<p>I'm not sure what should it return if the node is an <code>EmptyG</code>, for example:</p>\n\n<pre><code>   1\n / | \\\nE  2  3\n</code></pre>\n\n<p>I did it like this <code>aux (EmptyG:xs)= EmptyB</code> but it doesn't make much sense. The problem in this case is what value to put in <code>a</code> so you don't lose the rest of the tree (<code>xs</code>). </p>\n\n<p>Anyway this code works for the cases with no <code>EmptyG</code>:</p>\n\n<pre><code>aux :: [GenTree a] -&gt; (BinTree a)\naux [] = EmptyB\naux (EmptyG:xs)= EmptyB  \naux ((NodeG x []):xs) = NodeB (EmptyB) x (aux xs)\naux ((NodeG x ys):xs) = NodeB (aux ys) x (aux xs)\n</code></pre>\n\n<p>From your example:</p>\n\n<pre><code>(NodeG 1 [NodeG 2 [], NodeG 3 [], NodeG 4 [NodeG 6 [], NodeG 7 [], NodeG 8 []], NodeG 5[]])\n</code></pre>\n\n<p>It produces:</p>\n\n<pre><code>NodeB (NodeB EmptyB 2 (NodeB EmptyB 3 (NodeB (NodeB EmptyB 6 (NodeB EmptyB 7 (NodeB EmptyB 8 EmptyB))) 4 (NodeB EmptyB 5 EmptyB)))) 1 EmptyB\n</code></pre>\n\n<p>Which, if I didn't mess up while doing it by hand, is the desired outcome.</p>\n"}], "owner": {"reputation": 656, "user_id": 6739197, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/596ca15ff00c5f201050c7b3194d9fd2?s=128&d=identicon&r=PG&f=1", "display_name": "victor.ja", "link": "https://stackoverflow.com/users/6739197/victor-ja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 43457913, "answer_count": 1, "score": 2, "last_activity_date": 1492469379, "creation_date": 1492450055, "last_edit_date": 1492455311, "question_id": 43456302, "link": "https://stackoverflow.com/questions/43456302/function-to-turn-a-gentree-to-a-binary-tree", "title": "Function to turn a GenTree to a Binary Tree", "body": "<p>Given the following data structures, create a function which given a <code>GenTree</code>, turns it into a <code>BinTree</code>:</p>\n\n<ul>\n<li>Each in order <code>NodeG</code> matches a <code>NodeB</code> node in the Binary Tree;</li>\n<li>The left son of <code>NodeB</code> matches the first son of <code>NodeG</code>;</li>\n<li>The right son of <code>NodeB</code> is the next node which follows <code>NodeG</code> (this means, the next node in order between the childen of <code>NodeG</code> 's parents)</li>\n</ul>\n\n<p>Visual example ( <code>GenTree</code> left, <code>BinTree</code> right)</p>\n\n<pre><code>    1                       1\n/ |  |  \\                  / \\\n2 3  4   5                2   E  \n    /|\\                  / \\\n   6 7 8                E   3\n                           / \\\n                          E   4\n                             / \\\n                            6   5\n                           / \\\n                          E   7\n                             / \\\n                            E   8  \n</code></pre>\n\n<hr>\n\n<pre><code>data GenTree a = EmptyG | NodeG a [GenTree a]\n                                         deriving (Show)\n\ndata BinTree a = EmptyB | NodeB (BinTree a) a (BinTree a)\n                                                     deriving (Show)\n</code></pre>\n\n<p>. I can't figure out how to make the helper function (aux) of the main function work.</p>\n\n<pre><code>g2b :: (GenTree a) -&gt; (BinTree a)\n\ng2b EmptyG = EmptyB\ng2b (NodeG x ts) = NodeB (aux ts) x EmptyB\n\naux :: [GenTree a] -&gt; (BinTree a)\n\naux [] = EmptyB\naux (NodeG x xs) : xss = NodeB (aux xs) x (aux xss) ((NodeG x xs) xss)\n</code></pre>\n\n<p>The last line of code is the one that doesn't work and the one I can't understand</p>\n"}, {"tags": ["haskell", "servant", "derived-instances"], "answers": [{"tags": [], "owner": {"reputation": 815, "user_id": 245743, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/11a87619d08da72466e99e16453ea318?s=128&d=identicon&r=PG", "display_name": "ppb", "link": "https://stackoverflow.com/users/245743/ppb"}, "is_accepted": true, "score": 4, "last_activity_date": 1492458655, "last_edit_date": 1492458655, "creation_date": 1492441322, "answer_id": 43453996, "question_id": 43452514, "link": "https://stackoverflow.com/questions/43452514/customizing-the-fields-generated-by-automatic-derivation-of-toschema/43453996#43453996", "title": "Customizing the fields generated by automatic derivation of ToSchema", "body": "<p>Not too familiar with <code>servant-swagger</code> and <code>swagger2</code> but it looks like something like this should do the job:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.Swagger.Schema\nimport Data.Swagger.SchemaOptions\n\ninstance ToSchema Device where\n  declareNamedSchema =\n    genericDeclareNamedSchema\n      defaultSchemaOptions {fieldLabelModifier = \\fieldLabel -&gt; ...}\n</code></pre>\n"}], "owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 43453996, "answer_count": 1, "score": 0, "last_activity_date": 1492458655, "creation_date": 1492435928, "question_id": 43452514, "link": "https://stackoverflow.com/questions/43452514/customizing-the-fields-generated-by-automatic-derivation-of-toschema", "title": "Customizing the fields generated by automatic derivation of ToSchema", "body": "<p>I have the following type:</p>\n\n<pre><code>data Device = Device { _deviceId    :: DeviceId\n                     , _deviceName  :: Text\n                     , _deviceDtype :: DType }\n            deriving (Show, Eq, Generic)\nmakeFields ''Device\n$(deriveJSON (mkOptions \"_device\") ''Device)\n</code></pre>\n\n<p>Here I make use of <code>deriveJSON</code> instead of the <code>Generic</code> mechanism, since I need to adapt the name of the fields of the JSON representation for this data type:</p>\n\n<pre><code>-- | Make JSON conversion options.\nmkOptions :: String -&gt; Options\nmkOptions prefix = defaultOptions { fieldLabelModifier = removePrefix prefix\n                                  , unwrapUnaryRecords = True\n                                  }\n</code></pre>\n\n<p>The prefix is needed to generate lenses for the type, but not needed in the JSON representation. </p>\n\n<p>Now I'm trying to generate Swagger documentation, using <a href=\"http://hackage.haskell.org/package/servant-swagger-1.1.2.1/docs/Servant-Swagger.html\" rel=\"nofollow noreferrer\">servant-swagger</a>, which requires a <a href=\"https://hackage.haskell.org/package/swagger2-2.1.3/docs/Data-Swagger-Internal-Schema.html#t:ToSchema\" rel=\"nofollow noreferrer\"><code>ToSchema</code></a> instance for <code>Device</code>. Now the problem is that the generated schema will have the given prefixed names of the accessor functions above (<code>_deviceId</code>, <code>_deviceName</code>, <code>_deviceDType</code>). Instead I would to have the modified version (<code>id</code>, <code>name</code>, and <code>dtype</code>).</p>\n\n<p>Is there a way to customize the generic derivation process in such a way?</p>\n"}, {"tags": ["haskell", "yesod", "haskell-persistent"], "answers": [{"tags": [], "owner": {"reputation": 69847, "user_id": 3853934, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/GtQuz.jpg?s=128&g=1", "display_name": "Micha\u0142 Per\u0142akowski", "link": "https://stackoverflow.com/users/3853934/micha%c5%82-per%c5%82akowski"}, "is_accepted": true, "score": 1, "last_activity_date": 1492442051, "creation_date": 1492442051, "answer_id": 43454218, "question_id": 43452160, "link": "https://stackoverflow.com/questions/43452160/how-to-find-out-which-key-is-conflicting-when-using-the-replaceunique-method/43454218#43454218", "title": "How to find out which key is conflicting when using the replaceUnique method?", "body": "<p>This can be achieved with this code:</p>\n\n<pre><code>case unique of\n  UniqueEmail _ -&gt; -- email is conflicting\n  UniqueDisplayName _ -&gt; -- displayName is conflicting\n</code></pre>\n\n<p>where <code>unique</code> is <code>Unique record</code> and <code>UniqueEmail _</code> and <code>UniqueDisplayName _</code> are uniqueness  constraints.</p>\n"}], "owner": {"reputation": 69847, "user_id": 3853934, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/GtQuz.jpg?s=128&g=1", "display_name": "Micha\u0142 Per\u0142akowski", "link": "https://stackoverflow.com/users/3853934/micha%c5%82-per%c5%82akowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 43454218, "answer_count": 1, "score": 0, "last_activity_date": 1493746013, "creation_date": 1492434596, "last_edit_date": 1493746013, "question_id": 43452160, "link": "https://stackoverflow.com/questions/43452160/how-to-find-out-which-key-is-conflicting-when-using-the-replaceunique-method", "title": "How to find out which key is conflicting when using the replaceUnique method?", "body": "<p>I'm using the <a href=\"https://www.stackage.org/haddock/lts-8.9/persistent-2.6.1/Database-Persist-Class.html#v:replaceUnique\" rel=\"nofollow noreferrer\"><code>replaceUnique</code> method</a>, which has return type of <code>ReaderT backend m (Maybe (Unique record))</code>. My database table has two unique fields and if uniqueness is violated, I want to find out which key is conflicting. How can I do that?</p>\n"}, {"tags": ["haskell", "cabal", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1520584749, "post_id": 43453835, "comment_id": 85384437, "body": "I&#39;m reviewing this after almost a year, and indeed. Upper and lower bounds in <code>cabal</code> (or <code>hpack</code>?) files are needed when publishing a package to hackage the PVP requires upper and lower bounds for every dependency of the package one is trying to publish."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1520584981, "post_id": 43453835, "comment_id": 85384545, "body": "@DamianNadales No, it&#39;s not needed. The stance on PVP is controversial with different opinions among different peoples."}, {"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1520586943, "post_id": 43453835, "comment_id": 85385590, "body": "But the <a href=\"https://hackage.haskell.org/upload\" rel=\"nofollow noreferrer\">instructions on how to upload a package to hackage</a> refer to the PVP saying that &quot;all packages should follow Haskell&#39;s Package Versioning Policy (PVP)&quot;. Does that mean that package authors don&#39;t necessarily follow the instructions on that page?"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 3, "creation_date": 1520589384, "post_id": 43453835, "comment_id": 85386993, "body": "I get why you are getting confused, many people have. It is &quot;should&quot; in the RFC sense which translates to &quot;recommended but not required&quot;. See this reddit discussion: <a href=\"https://www.reddit.com/r/haskell/comments/7yfdei/haskell_ecosystem_requests/dug9f58/\" rel=\"nofollow noreferrer\">reddit.com/r/haskell/comments/7yfdei/haskell_ecosystem_reque&zwnj;&#8203;sts/&hellip;</a> But yeah, IMO it&#39;s just stupid and that sentence should be much more clearer than the current one."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1520589396, "post_id": 43453835, "comment_id": 85387000, "body": "CC: @DamianNadales"}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 5, "last_activity_date": 1492440805, "creation_date": 1492440805, "answer_id": 43453835, "question_id": 43451749, "link": "https://stackoverflow.com/questions/43451749/cabal-stack-specifying-the-packages-version-in-the-cabal-file/43453835#43453835", "title": "Cabal + Stack: specifying the packages version in the cabal file", "body": "<blockquote>\n  <p>I'm wondering whether it makes sense to specify the package versions in the .cabal file.</p>\n</blockquote>\n\n<p>That depends completely upon you. If you specify a package version\nwhich is not in that particular stackage resolver, then Stack will\nthrow an error saying you to adjust the versioning.</p>\n\n<blockquote>\n  <p>My guess would be that specifying the lts version in the stack.yaml is enough.</p>\n</blockquote>\n\n<p>For private packages, it doesn't matter and I prefer not putting any version bounds there. But if it's something I ultimately plan to publish on Hackage, I usually use a <a href=\"https://github.com/psibi/fb/blob/master/.travis.yml\" rel=\"noreferrer\">CI system like Travis</a> and get the bounds right for it with some testing. In fact, I think the Stack guide recommends something like that.</p>\n"}], "owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 408, "favorite_count": 1, "accepted_answer_id": 43453835, "answer_count": 1, "score": 2, "last_activity_date": 1492440805, "creation_date": 1492432975, "question_id": 43451749, "link": "https://stackoverflow.com/questions/43451749/cabal-stack-specifying-the-packages-version-in-the-cabal-file", "title": "Cabal + Stack: specifying the packages version in the cabal file", "body": "<p>Normally when adding a new dependency to a <code>.cabal</code> file I specify the version of the new library I'm depending on. However <code>stack</code> works with a curated set of libraries, and I'm wondering whether it makes sense to specify the package versions in the <code>.cabal</code> file. My guess would be that specifying the <code>lts</code> version in the <code>stack.yaml</code> is enough.</p>\n"}, {"tags": ["haskell", "servant"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1492446721, "post_id": 43450701, "comment_id": 73966400, "body": "I looked at that documentation mechanism briefly.  It wasn&#39;t useful enough for me to justify any real time investment so I just host a static page, hand crafted and manually kept up-to-date with the API.  In my case it helps that the API pretty much never changes (perhaps 1 change in over a year)."}], "answers": [{"comments": [{"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1492532050, "post_id": 43461594, "comment_id": 74009898, "body": "Thanks with your tips I was able to add custom <code>notes</code>. It differs from what I wanted in that adding a note adds a new section, but it is better than nothing. Now I&#39;m gonna try to make this work on generated Swagger docs, but that&#39;s another story."}], "tags": [], "owner": {"reputation": 1178, "user_id": 1667161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233658d12fabd9d72b04d0a6916f6389?s=128&d=identicon&r=PG", "display_name": "liminalisht", "link": "https://stackoverflow.com/users/1667161/liminalisht"}, "is_accepted": true, "score": 3, "last_activity_date": 1492474631, "creation_date": 1492474631, "answer_id": 43461594, "question_id": 43450701, "link": "https://stackoverflow.com/questions/43450701/generating-end-point-descriptions-in-servant/43461594#43461594", "title": "Generating end-point descriptions in Servant", "body": "<p>I believe what you are looking for can be found in the <code>Servant.Docs</code> module of <code>servant-docs</code> (<a href=\"https://hackage.haskell.org/package/servant-docs-0.10/docs/Servant-Docs.htm\" rel=\"nofollow noreferrer\">here</a>).</p>\n\n<p>If you use the <code>docsWith</code> function, you can supply an <code>ExtraInfo</code> object for the api you are documenting:</p>\n\n<pre><code>docsWith :: HasDocs api =&gt; DocOptions -&gt; [DocIntro] -&gt; ExtraInfo api -&gt; Proxy api -&gt; API\n</code></pre>\n\n<p>I believe that the point of <code>docsWith</code> is to allow you to supply extra endpoint documentation, as you are asking. There is a <code>Monoid</code> instance for <code>ExtraInfo</code>, so it looks like you can build separate <code>ExtraInfo</code> objects for each endpoint in your api, then <code>mappend</code> them together, and pass this to <code>docsWith</code>.</p>\n\n<p>To build <code>ExtraInfo</code>, use the <code>extraInfo</code> function: </p>\n\n<pre><code>extraInfo :: (IsIn endpoint api, HasLink endpoint, HasDocs endpoint) =&gt; Proxy endpoint -&gt; Action -&gt; ExtraInfo api \n</code></pre>\n\n<p>The documentation (linked to above) has an example of how one would go about using the <code>extraInfo</code> function.</p>\n"}], "owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 43461594, "answer_count": 1, "score": 0, "last_activity_date": 1492474631, "creation_date": 1492428955, "question_id": 43450701, "link": "https://stackoverflow.com/questions/43450701/generating-end-point-descriptions-in-servant", "title": "Generating end-point descriptions in Servant", "body": "<p>Servant <a href=\"http://haskell-servant.readthedocs.io/en/stable/tutorial/Docs.html\" rel=\"nofollow noreferrer\">provides a way</a> to generate documentation from the API definition. However, I see no way of (informally) documenting the functionality of each end-point. For the example used in the link above, the generated documentation contains:</p>\n\n<pre><code>## Welcome\n\nThis is our super webservice's API.\n\nEnjoy!\n\n## GET /hello\n\n#### GET Parameters:\n\n- name\n     - **Values**: *Alp, John Doe, ...*\n     - **Description**: Name of the person to say hello to.\n\n\n#### Response:\n</code></pre>\n\n<p>In the example above, what I miss is a way of documenting what the <code>GET /hello</code> end-point does, this is, I would like to have a way to augmenting the API docs with an informal description of each end-point.</p>\n\n<pre><code>## Welcome\n\nThis is our super webservice's API.\n\nEnjoy!\n\n## GET /hello\n\nSend a hello message to the given user. /&lt;-- My description.../\n\n#### GET Parameters:\n\n- name\n     - **Values**: *Alp, John Doe, ...*\n     - **Description**: Name of the person to say hello to.\n\n\n#### Response:\n</code></pre>\n\n<p>My guess is that this will require tagging the different end-points to identify them uniquely, something that as far as I know Servant does not support. However, I'm wondering how to solve this problem with what is available as of now.</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1492426818, "post_id": 43450063, "comment_id": 73955807, "body": "What have you tried so far? (Your <code>SList</code> is a tree type, so any tree traversal should work.)"}, {"owner": {"reputation": 115, "user_id": 7253589, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fd9a2b638a27d347e2232fdb495cabd0?s=128&d=identicon&r=PG&f=1", "display_name": "JoeDonald", "link": "https://stackoverflow.com/users/7253589/joedonald"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1492426898, "post_id": 43450063, "comment_id": 73955847, "body": "This is what I have by now : <code>onebyone (Num x) = x</code>  <code>atomToNormal x  \t| null x = [] \t| otherwise = (onebyone $ head x) : atomToNormal (tail x)</code>    <code>slistToList (List x) = atomToNormal x</code>"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1492427148, "post_id": 43450063, "comment_id": 73955966, "body": "That looks like it would almost work. You just have to change <code>(onebyone $ head x) :</code> to <code>slistToList (head x) ++</code> (and handle the <code>Num</code> case in <code>slistToList</code>)."}, {"owner": {"reputation": 115, "user_id": 7253589, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fd9a2b638a27d347e2232fdb495cabd0?s=128&d=identicon&r=PG&f=1", "display_name": "JoeDonald", "link": "https://stackoverflow.com/users/7253589/joedonald"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1492427692, "post_id": 43450063, "comment_id": 73956227, "body": "I change the code as you said. But it doesn&#39;t work. It bring me this error: <code>No instance for (Num (SList [t0]))</code>"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1492427847, "post_id": 43450063, "comment_id": 73956312, "body": "Try adding a type signature to <code>slistToList</code>. What should its type be?"}, {"owner": {"reputation": 115, "user_id": 7253589, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fd9a2b638a27d347e2232fdb495cabd0?s=128&d=identicon&r=PG&f=1", "display_name": "JoeDonald", "link": "https://stackoverflow.com/users/7253589/joedonald"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1492427994, "post_id": 43450063, "comment_id": 73956378, "body": "It should be <code>SList a -&gt; [a]</code> because this function should give me a normal list."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1492428198, "post_id": 43450063, "comment_id": 73956469, "body": "So put <code>slistToList :: SList a -&gt; [a]</code> in your code and see if you get a better error message. :-)"}], "answers": [{"comments": [{"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1492431032, "post_id": 43450409, "comment_id": 73957871, "body": "This type is actually <code>Free [] a</code>, and I would use it as such. Something called <code>Tree a</code> is relatively ambiguous about its meaning, while <code>Free [] a</code> is very standard. Best to use a type synonym or newtype + GND for instances."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1492433568, "post_id": 43450409, "comment_id": 73959083, "body": "@Lazersmoke well, it is also <a href=\"http://hackage.haskell.org/package/containers-0.5.10.2/docs/Data-Tree.html\" rel=\"nofollow noreferrer\">the standard <code>Tree</code> type from the <code>containers</code> package</a>. I would use it by that name. Sure, like many other types you can also express it through <code>Free</code>, but what&#39;s the point? If you&#39;d go this route consequently, you&#39;d actually have to write <code>Free (Free (Free (Const ())))</code>. This is silly."}, {"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1492436393, "post_id": 43450409, "comment_id": 73960538, "body": "@leftaroundabout <code>Tree</code> is <code>Cofree []</code>. <code>SList Char</code> can be <code>List [List [Num &#39;a&#39;]]</code>, <code>Free [] Char</code> can be <code>Free [Free [Pure &#39;a&#39;]]</code>, <code>Cofree</code>/<code>Tree</code> can&#39;t do this."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1492437998, "post_id": 43450409, "comment_id": 73961422, "body": "Alright, true. In particular you can have (even arbitrarily deep) <i>empty</i> structures with <code>Free []</code>, whereas <code>Tree</code> always has at least one value. Actually rather a forest than a tree thus."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 1, "last_activity_date": 1492428527, "last_edit_date": 1492428527, "creation_date": 1492427960, "answer_id": 43450409, "question_id": 43450063, "link": "https://stackoverflow.com/questions/43450063/creating-a-data-type-list-haskell/43450409#43450409", "title": "Creating a data type list Haskell", "body": "<p>GHC can actually write this function for you:</p>\n\n<pre><code>{-# LANGUAGE DeriveFoldable #-}\nimport Data.Foldable as Foldable\n\ndata SList a = Num a | List [SList a]\n  deriving (Show, Foldable)\n\nslistToList :: SList a -&gt; [a]\nslistToList = Foldable.toList\n</code></pre>\n\n<p>If you want to do it yourself \u2013 I don't see quite what <code>atomToNormal</code> is supposed to do, you don't need it. Just deconstruct the tree-branch list<sup>\u2020</sup> head-first right in <code>slistToList</code>:</p>\n\n<pre><code>slistToList :: SList a -&gt; [a]\nslistToList (Num x) = _\nslistToList (List []) = _\nslistToList (List (l:ls)) = _\n</code></pre>\n\n<p>Now fill in the gaps. GHC (>=7.10) can help you a lot there too: just try compiling as-is with the underscore-gaps, and it will tell you</p>\n\n<pre><code>/tmp/wtmpf-file17703.hs:8:23:\n    Found hole \u2018_\u2019 with type: [a]\n    Where: \u2018a\u2019 is a rigid type variable bound by\n               the type signature for slistToList :: SList a -&gt; [a]\n               at /tmp/wtmpf-file17703.hs:7:16\n    Relevant bindings include\n      x :: a (bound at /tmp/wtmpf-file17703.hs:8:18)\n      slistToList :: SList a -&gt; [a]\n        (bound at /tmp/wtmpf-file17703.hs:8:1)\n    In the expression: _\n    In an equation for \u2018slistToList\u2019: slistToList (Num x) = _\n</code></pre>\n\n<p>So the first gap needs to have type <code>[a]</code>, and the only value you have is <code>x::a</code>. Well, you can wrap that in a singleton list</p>\n\n<pre><code>slistToList (Num x) = [x]\n</code></pre>\n\n<p>Proceed in the same fashion with the other clauses. As a rule of thumb, if you just somehow include all of the \u201crelevant bindings\u201d (often, there's exactly one way to do this), then your implementation will probably be right.</p>\n\n<p>Of course, this only works when you first write out the type signature... which <em>should always be the first thing you do anyway</em>!</p>\n\n<p><hr>\n<sup>\u2020</sup><sub>Your type really should be called something tree-ish, not <code>SList</code>!</sub></p>\n"}], "owner": {"reputation": 115, "user_id": 7253589, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fd9a2b638a27d347e2232fdb495cabd0?s=128&d=identicon&r=PG&f=1", "display_name": "JoeDonald", "link": "https://stackoverflow.com/users/7253589/joedonald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1527, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492428527, "creation_date": 1492426452, "last_edit_date": 1492428507, "question_id": 43450063, "link": "https://stackoverflow.com/questions/43450063/creating-a-data-type-list-haskell", "title": "Creating a data type list Haskell", "body": "<p>I've done a personal list in Haskell like this:  (2,(1,1),3) -> List [Num 2, List [Num 1, Num 1], List [Num 3]].</p>\n\n<p>This is how I made it:</p>\n\n<pre><code>data SList a = Num a | List [SList a] deriving Show\nemptySList :: SList a\nemptySList = (List [])\n\nconsElem :: a -&gt; SList a -&gt; SList a\nconsElem x (List y) = (List ((Num x) : y))\n\nconsList :: SList a -&gt; SList a -&gt; SList a\nconsList a b = (List [a,b])\n</code></pre>\n\n<p>I manage to form this list (List [Num 2, List [Num 1, Num 1], List [Num 3]]) using consElem and consList like this: </p>\n\n<pre><code>consElem 2 $ consList (consElem 1 $ consElem 1 emptySList) $ consElem 3 emptySList\n</code></pre>\n\n<p>I wonder how can I transform a SList in a normal list. For example if I have this SList: <code>List [Num 2, List [Num 1, Num 1], List [Num 3]]</code> it should become <code>[2,1,1,3]</code>.</p>\n\n<p>My attempt:</p>\n\n<pre><code>atomToNormal x\n    | null x = []\n    | otherwise = slistToList (head x) ++ atomToNormal (tail x)\nslistToList :: SList a -&gt; [a]\nslistToList (List x) = atomToNormal x\nslistToList (Num x) = [x]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 1, "creation_date": 1492396692, "post_id": 43444363, "comment_id": 73945362, "body": "<code>leaves (Leaf _) </code> should be just <code>1</code>.   My suggestion implement this function with any other language you&#39;re comfortable with.  Once you understand how to implement, it will be easier to comprehend this solution."}, {"owner": {"reputation": 1, "user_id": 7876513, "user_type": "registered", "profile_image": "https://graph.facebook.com/1471735482859837/picture?type=large", "display_name": "Kim HanSol", "link": "https://stackoverflow.com/users/7876513/kim-hansol"}, "reply_to_user": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1492397000, "post_id": 43444363, "comment_id": 73945415, "body": "Sorry. The leaves next to the number 1 are typographical errors"}, {"owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "edited": false, "score": 0, "creation_date": 1492397724, "post_id": 43444363, "comment_id": 73945559, "body": "I don&#39;t understand what your question is. You&#39;ve provided the solution to your assignment in the question. (Though, you don&#39;t need the <code>&amp;&amp; balanced l &amp;&amp; balanced r</code> part, I don&#39;t think - seems redundant)."}, {"owner": {"reputation": 1, "user_id": 7876513, "user_type": "registered", "profile_image": "https://graph.facebook.com/1471735482859837/picture?type=large", "display_name": "Kim HanSol", "link": "https://stackoverflow.com/users/7876513/kim-hansol"}, "edited": false, "score": 0, "creation_date": 1492402540, "post_id": 43444363, "comment_id": 73946486, "body": "It does not run in ghci."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1492418858, "post_id": 43444363, "comment_id": 73951958, "body": "@KimHanSol if you notice errors in your question (e.g. the typographical one), make sure to <a href=\"https://stackoverflow.com/posts/43444363/edit\">edit</a> it."}, {"owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "edited": false, "score": 0, "creation_date": 1492421825, "post_id": 43444363, "comment_id": 73953382, "body": "A handy hint: if you get an error when trying to run in GHCi, paste that into your question, too. It&#39;s possibly one of the most important parts - we need to see where you&#39;re going wrong."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 0, "last_activity_date": 1492412348, "creation_date": 1492412348, "answer_id": 43446744, "question_id": 43444363, "link": "https://stackoverflow.com/questions/43444363/haskell-binary-tree-exercises/43446744#43446744", "title": "haskell Binary Tree exercises", "body": "<p>Your code looks mostly fine, but you have some minor errors.</p>\n\n<pre><code>leaves :: Tree -&gt; Int\nleaves (Leaf _) = 1         -- not 1 leaves\nleaves (Node l r) = leaves l + leaves r\n\nbalanced :: Tree -&gt; Bool\n-- don't declare (-) here, it's already declared by the libraries!\nbalanced (Leaf _) = True\nbalanced (Node l r) = abs (leaves l - leaves r) &lt;= 1\n   &amp;&amp; balanced l &amp;&amp; balanced r   -- indent this more\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7876513, "user_type": "registered", "profile_image": "https://graph.facebook.com/1471735482859837/picture?type=large", "display_name": "Kim HanSol", "link": "https://stackoverflow.com/users/7876513/kim-hansol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 360, "favorite_count": 0, "closed_date": 1492427625, "accepted_answer_id": 43446744, "answer_count": 1, "score": -3, "last_activity_date": 1492412348, "creation_date": 1492396343, "question_id": 43444363, "link": "https://stackoverflow.com/questions/43444363/haskell-binary-tree-exercises", "closed_reason": "Needs more focus", "title": "haskell Binary Tree exercises", "body": "<p>In Graham Hutton's book Programming in Haskell, there was an error in solving Chapter 10 Exercise 3.</p>\n\n<p>When the number of leaves on the left and right side trees is not more than one, these trees are said to be balanced.\nOf course, it seems to be balanced by itself. Define a function to determine if the tree is balanced.\nFirst, define a function that counts how many leaves are in the tree.</p>\n\n<pre><code>data Tree = Leaf Int | Node Tree Tree\n\nleaves :: Tree -&gt; Int\nleaves (Leaf _) = 1 leaves \nleaves (Node l r) = leaves l + leaves r\n\nbalanced :: Tree -&gt; Bool\n(-) :: Int -&gt; Int -&gt; Integer\nbalanced (Leaf _) = True\nbalanced (Node l r) = abs (leaves l - leaves r) &lt;= 1\n&amp;&amp; balanced l &amp;&amp; balanced r\n</code></pre>\n\n<p>I do not know anything about Haskell, but my professor gave me the assignment. Help</p>\n"}, {"tags": ["haskell", "typeclass", "newtype"], "comments": [{"owner": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "edited": false, "score": 0, "creation_date": 1492396322, "post_id": 43444170, "comment_id": 73945303, "body": "The following declaration works: <code>newtype A = A { _run :: A -&gt; [Int] -&gt; (forall m. Monad m =&gt; m Int) }</code> (requires <code>{-# LANGUAGE RankNTypes #-}</code> extension)."}], "answers": [{"tags": [], "owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "is_accepted": false, "score": -1, "last_activity_date": 1492420708, "last_edit_date": 1492420708, "creation_date": 1492396401, "answer_id": 43444370, "question_id": 43444170, "link": "https://stackoverflow.com/questions/43444170/can-a-typeclass-constraint-be-used-in-a-newtype-definition/43444370#43444370", "title": "Can a typeclass constraint be used in a newtype definition?", "body": "<p>How would GHC know what instance of <code>Monad</code> to use when you create a piece of data of type <code>A</code>?</p>\n\n<p>Or, put another way, the type variable <code>m</code> isn't in scope on the left hand side of the type definition. That means it doesn't know what <code>m</code> should be, and can't work it out. It's implicit.</p>\n\n<p>I'm sure there's some way you could do what you want to with an extension, probably using an explicit forall. (The RankNTypes extension), however we'd need to know what you were after a bit more.</p>\n"}, {"comments": [{"owner": {"reputation": 661, "user_id": 1914483, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/85cb70bcee5fd17394dafbbcfb96a37a?s=128&d=identicon&r=PG", "display_name": "Bill M", "link": "https://stackoverflow.com/users/1914483/bill-m"}, "edited": false, "score": 0, "creation_date": 1492399264, "post_id": 43444407, "comment_id": 73945831, "body": "Thank you for clarifying how to write the constructor and making the connection to Lenses, this made a bunch of things click for me."}], "tags": [], "owner": {"reputation": 833, "user_id": 7847896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3e72cb1d5eceb94842bec50894e6943?s=128&d=identicon&r=PG&f=1", "display_name": "zbw", "link": "https://stackoverflow.com/users/7847896/zbw"}, "is_accepted": false, "score": 8, "last_activity_date": 1492411983, "last_edit_date": 1492411983, "creation_date": 1492396787, "answer_id": 43444407, "question_id": 43444170, "link": "https://stackoverflow.com/questions/43444170/can-a-typeclass-constraint-be-used-in-a-newtype-definition/43444407#43444407", "title": "Can a typeclass constraint be used in a newtype definition?", "body": "<p>It depends on what you're trying to store in <code>A</code>.</p>\n\n<p>If you're trying to store any function like that, as long as <code>m</code> is a <code>Monad</code>, use it as a type parameter, and specify this contraint in your functions:</p>\n\n<pre><code>newtype A m = A { _run :: A m -&gt; [Int] -&gt; m Int }\n\nmyFunction :: Monad m =&gt; A m -&gt; A m\n</code></pre>\n\n<p>You could then have things like <code>A [] -&gt; [Int] -&gt; [Int]</code> or <code>A Maybe -&gt; [Int] -&gt; Maybe Int</code> inside the constructor.</p>\n\n<pre><code>f :: A Maybe -&gt; [Int] -&gt; Maybe Int\nf _ (x:_) = Just x\nf _ [] = Nothing\n\ng :: Monad m =&gt; A m -&gt; [Int] -&gt; m Int\ng _ xs = return $ head xs\n\nmyA :: A Maybe\nmyA = A f  -- this works\n\nmyOtherA :: Monad m =&gt; A m\nmyOtherA = A g  -- this works too\n</code></pre>\n\n<hr>\n\n<p>On the other hand, if you want to force the data you store to be polymorphic, you can use the GHC extension <code>RankNTypes</code>.</p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\nnewtype A = A { _run :: forall m. Monad m =&gt; A -&gt; [Int] -&gt; m Int }\n\nmyFunction :: A -&gt; A\n</code></pre>\n\n<p>You couldn't have things like <code>A -&gt; [Int] -&gt; [Int]</code> or <code>A -&gt; [Int] -&gt; Maybe Int</code> within the constructor, because the <code>forall</code> forces them to be general over <strong>any</strong> <code>Monad m</code>, so it would have to be of type <code>Monad m =&gt; A -&gt; [Int] -&gt; Maybe Int</code>.</p>\n\n<pre><code>f :: A -&gt; [Int] -&gt; Maybe Int\nf _ (x:_) = Just x\nf _ [] = Nothing\n\ng :: Monad m =&gt; A -&gt; [Int] -&gt; m Int\ng _ xs = return $ head xs\n\nmyA :: A\nmyA = A f  -- this does not work ; it wants forall m. Monad m =&gt; m, not []\n\nmyOtherA :: A\nmyOtherA = A g  -- this does work\n</code></pre>\n\n<p>This will only really be useful if you intend to use different specific <code>Monad</code> instances for an <code>A</code>-value.  For example, Lenses work this way by using different functors to do different things to the lens.</p>\n"}, {"comments": [{"owner": {"reputation": 661, "user_id": 1914483, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/85cb70bcee5fd17394dafbbcfb96a37a?s=128&d=identicon&r=PG", "display_name": "Bill M", "link": "https://stackoverflow.com/users/1914483/bill-m"}, "edited": false, "score": 0, "creation_date": 1492398786, "post_id": 43444453, "comment_id": 73945762, "body": "Thanks, this makes a lot more sense to me now. Is there any meaningful difference between the RankNTypes approach and GADT approach?"}, {"owner": {"reputation": 179940, "user_id": 20713, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09b9758a4a83cc25547eb93891f19df7?s=128&d=identicon&r=PG", "display_name": "ephemient", "link": "https://stackoverflow.com/users/20713/ephemient"}, "reply_to_user": {"reputation": 661, "user_id": 1914483, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/85cb70bcee5fd17394dafbbcfb96a37a?s=128&d=identicon&r=PG", "display_name": "Bill M", "link": "https://stackoverflow.com/users/1914483/bill-m"}, "edited": false, "score": 0, "creation_date": 1492400542, "post_id": 43444453, "comment_id": 73946036, "body": "@BillM Aside from a typo (fixed) and no name like <code>_run</code>? No."}, {"owner": {"reputation": 833, "user_id": 7847896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3e72cb1d5eceb94842bec50894e6943?s=128&d=identicon&r=PG&f=1", "display_name": "zbw", "link": "https://stackoverflow.com/users/7847896/zbw"}, "edited": false, "score": 0, "creation_date": 1492401119, "post_id": 43444453, "comment_id": 73946176, "body": "@ephemient I tried it in GHCi, and with my definition of <code>f</code> below, the GADTs way worked, but the RankNTypes way had an error."}, {"owner": {"reputation": 833, "user_id": 7847896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3e72cb1d5eceb94842bec50894e6943?s=128&d=identicon&r=PG&f=1", "display_name": "zbw", "link": "https://stackoverflow.com/users/7847896/zbw"}, "edited": false, "score": 0, "creation_date": 1492401161, "post_id": 43444453, "comment_id": 73946188, "body": "I&#39;m not sure how editing other people&#39;s answers works, but I edited it to that respect."}, {"owner": {"reputation": 833, "user_id": 7847896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3e72cb1d5eceb94842bec50894e6943?s=128&d=identicon&r=PG&f=1", "display_name": "zbw", "link": "https://stackoverflow.com/users/7847896/zbw"}, "edited": false, "score": 0, "creation_date": 1492402733, "post_id": 43444453, "comment_id": 73946522, "body": "I tried it more in GHCi, and whenever I tried to access the function member from the GADTs definition, it complained that <code>type variable \u2018m\u2019 would escape its scope</code> -- I think this way won&#39;t work."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 2, "creation_date": 1492411147, "post_id": 43444453, "comment_id": 73948839, "body": "There is a huge difference between the <code>data</code> and <code>newtype</code> versions.  They mean different things entirely.  The <code>data</code> version creates an existential. Whenever you apply the constructor, you lose the type <code>m</code>, and it can never be recovered.  The <code>newtype</code> version is universal. The value held by the constructor must be polymorphic across all <code>m</code> with a <code>Monad</code> instance.  When you extract it, you can use it for any <code>m</code>."}], "tags": [], "owner": {"reputation": 179940, "user_id": 20713, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09b9758a4a83cc25547eb93891f19df7?s=128&d=identicon&r=PG", "display_name": "ephemient", "link": "https://stackoverflow.com/users/20713/ephemient"}, "is_accepted": true, "score": 6, "last_activity_date": 1492400588, "last_edit_date": 1492400588, "creation_date": 1492397268, "answer_id": 43444453, "question_id": 43444170, "link": "https://stackoverflow.com/questions/43444170/can-a-typeclass-constraint-be-used-in-a-newtype-definition/43444453#43444453", "title": "Can a typeclass constraint be used in a newtype definition?", "body": "<p>This is possible:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\nnewtype A = A { _run :: forall m. Monad m =&gt; A -&gt; [Int] -&gt; m Int }\n</code></pre>\n\n<p>It's hard to tell what you want to do, but this isn't very usable. Any value of type <code>A</code> needs to work for all monads (you don't get to choose).</p>\n\n<p>This is also possible, with the same restrictions:</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\ndata A where A :: Monad m =&gt; (A -&gt; [Int] -&gt; m Int) -&gt; A\n</code></pre>\n\n<p>But perhaps you mean something more like</p>\n\n<pre><code>newtype A m = A { _run :: A m -&gt; [Int] -&gt; m Int }\n</code></pre>\n\n<p>This allows for values of different types of <code>A</code> using different monads.</p>\n"}], "owner": {"reputation": 661, "user_id": 1914483, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/85cb70bcee5fd17394dafbbcfb96a37a?s=128&d=identicon&r=PG", "display_name": "Bill M", "link": "https://stackoverflow.com/users/1914483/bill-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1658, "favorite_count": 0, "accepted_answer_id": 43444453, "answer_count": 3, "score": 3, "last_activity_date": 1492420708, "creation_date": 1492394409, "last_edit_date": 1492397481, "question_id": 43444170, "link": "https://stackoverflow.com/questions/43444170/can-a-typeclass-constraint-be-used-in-a-newtype-definition", "title": "Can a typeclass constraint be used in a newtype definition?", "body": "<p>Suppose we have the following <code>newtype</code> definition:</p>\n\n<pre><code>newtype A = A { _run :: Monad m =&gt; A -&gt; [Int] -&gt; m Int }\n</code></pre>\n\n<p>This does not compile with GHC 8.0.2: </p>\n\n<pre><code>error: Not in scope: type variable \u2018m\u2019\n</code></pre>\n\n<p>Replacing <code>m</code> with a concrete typeclass like <code>IO</code> or <code>[]</code> does compile, as I would expect. Given that this is ok, why does GHC not allow the signature above? What is wrong with adding a typeclass constraint inside of this <code>newtype</code>?  </p>\n"}, {"tags": ["haskell", "nix"], "comments": [{"owner": {"reputation": 815, "user_id": 245743, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/11a87619d08da72466e99e16453ea318?s=128&d=identicon&r=PG", "display_name": "ppb", "link": "https://stackoverflow.com/users/245743/ppb"}, "edited": false, "score": 0, "creation_date": 1492426115, "post_id": 43443961, "comment_id": 73955474, "body": "Bit of a shot in the dark but does adding <code>enableSplitObjs = false;</code> to your default.nix file help at all? If that errors out with <code>error: assertion failed at..</code> could you try <code>enableDeadCodeElimination = false;</code> instead?"}, {"owner": {"reputation": 1276, "user_id": 2449599, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8117b8eb8ef06d96fef4a5be131ab6c1?s=128&d=identicon&r=PG", "display_name": "phil", "link": "https://stackoverflow.com/users/2449599/phil"}, "reply_to_user": {"reputation": 815, "user_id": 245743, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/11a87619d08da72466e99e16453ea318?s=128&d=identicon&r=PG", "display_name": "ppb", "link": "https://stackoverflow.com/users/245743/ppb"}, "edited": false, "score": 0, "creation_date": 1492430629, "post_id": 43443961, "comment_id": 73957674, "body": "@ppb <code>enableSplitObjs = false;</code> made it build correctly. Why does that fix things though? Is there a place where all of the haskell nix options are documented? Also, if you make this an answer, I&#39;ll accept it."}], "answers": [{"tags": [], "owner": {"reputation": 815, "user_id": 245743, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/11a87619d08da72466e99e16453ea318?s=128&d=identicon&r=PG", "display_name": "ppb", "link": "https://stackoverflow.com/users/245743/ppb"}, "is_accepted": true, "score": 1, "last_activity_date": 1492442919, "last_edit_date": 1592644375, "creation_date": 1492442919, "answer_id": 43454449, "question_id": 43443961, "link": "https://stackoverflow.com/questions/43443961/build-simple-haskell-library-using-nix/43454449#43454449", "title": "Build simple haskell library using nix", "body": "<p>I believe by default nix, unlike plain cabal, will try to build any Haskell project using split objects feature, <a href=\"https://www.haskell.org/cabal/users-guide/installing-packages.html#miscellaneous-options\" rel=\"nofollow noreferrer\">per cabal's manual</a>:</p>\n<blockquote>\n<p>--enable-split-objs</p>\n<p>Use the GHC -split-objs feature when building the library. This reduces the final size of the executables that use the library by\nallowing them to link with only the bits that they use rather than the\nentire library. The downside is that building the library takes longer\nand uses considerably more memory.</p>\n</blockquote>\n<p>I'm not too sure as to why that may be failing on your system but depending on your nixpkgs version can be disabled by adding one of:</p>\n<p><code>enableSplitObjs = false;</code></p>\n<p><code>enableDeadCodeElimination = false;</code></p>\n<p>to the derivation.</p>\n<p>For a list of other other attributes / options you can refer to <a href=\"https://github.com/NixOS/nixpkgs/blob/master/pkgs/development/haskell-modules/generic-builder.nix\" rel=\"nofollow noreferrer\">https://github.com/NixOS/nixpkgs/blob/master/pkgs/development/haskell-modules/generic-builder.nix</a> Unfortunately I'm not aware of any official documentation describing those in more detail.</p>\n"}], "owner": {"reputation": 1276, "user_id": 2449599, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/8117b8eb8ef06d96fef4a5be131ab6c1?s=128&d=identicon&r=PG", "display_name": "phil", "link": "https://stackoverflow.com/users/2449599/phil"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 386, "favorite_count": 0, "accepted_answer_id": 43454449, "answer_count": 1, "score": 6, "last_activity_date": 1492442919, "creation_date": 1492392494, "question_id": 43443961, "link": "https://stackoverflow.com/questions/43443961/build-simple-haskell-library-using-nix", "title": "Build simple haskell library using nix", "body": "<p>I've been interested in Nix for a while, and I thought I would finally try to use it for starting a new haskell project.</p>\n\n<p>I began with the directory structure</p>\n\n<pre><code>project.cabal\nsrc/Lib.hs\n</code></pre>\n\n<p>Where the cabal file has the following contents:</p>\n\n<pre><code>name: project\nversion: 0.1.0.0\nbuild-type: Simple\nlicense: MIT\ncabal-version: &gt;= 1.18\n\nlibrary\n  exposed-modules: Lib\n  build-depends: base &lt; 5\n  hs-source-dirs: src\n  default-language: Haskell2010\n</code></pre>\n\n<p>and Lib.hs has</p>\n\n<pre><code>module Lib where\n\nhello :: Int -&gt; IO ()\nhello x = putStrLn (show x)\n</code></pre>\n\n<p>As you can see, it's quite simple. When I execute <code>cabal build</code>, it seems to be happy. Note that I'm no haskell expert by any means, so I may be making some beginner mistake here.</p>\n\n<p>To build this with Nix, I've been reading <a href=\"https://github.com/Gabriel439/haskell-nix\" rel=\"noreferrer\">https://github.com/Gabriel439/haskell-nix</a> to get my information. I executed <code>cabal2nix . &gt; default.nix</code> to get a Nix version of my cabal file. I then created a <code>release.nix</code> file to actually build it. The contents of the two files are as follows:</p>\n\n<p>default.nix</p>\n\n<pre><code>{ mkDerivation, base, stdenv }:\nmkDerivation {\n  pname = \"project\";\n  version = \"0.1.0.0\";\n  src = ./.;\n  libraryHaskellDepends = [ base ];\n  license = stdenv.lib.licenses.mit;\n}\n</code></pre>\n\n<p>release.nix</p>\n\n<pre><code>let\n  pkgs = import &lt;nixpkgs&gt; { };\nin\n  pkgs.haskellPackages.callPackage ./default.nix { }\n</code></pre>\n\n<p>After doing this, I executed <code>nix-build release.nix</code> and got back</p>\n\n<pre><code>these derivations will be built:\n  /nix/store/p481alkpm89712n3hnwai0nxhmjrm8b2-project-0.1.0.0.drv\nbuilding path(s) \u2018/nix/store/yszy2a6wd88pf6zlw0nw99l5wzvc0s9x-project-0.1.0.0\u2019\nsetupCompilerEnvironmentPhase\nBuild with /nix/store/d5w12a8bprd2518xnqp1cwh3rbjiagyx-ghc-8.0.1.\nunpacking sources\nunpacking source archive /nix/store/fsn4b9w54h2jdpv546nwvy82vnkszl1w-project\nsource root is project\npatching sources\ncompileBuildDriverPhase\nsetupCompileFlags: -package-db=/tmp/nix-build-project-0.1.0.0.drv-0/package.conf.d -j4 -threaded\n[1 of 1] Compiling Main             ( /nix/store/4mdp8nhyfddh7bllbi7xszz7k9955n79-Setup.hs, /tmp/nix-build-project-0.1.0.0.drv-0/Main.o )\nLinking Setup ...\n...\n...\nBuilding project-0.1.0.0...\nPreprocessing library project-0.1.0.0...\ndist/build/Lib_o_split: getDirectoryContents: does not exist (No such file or\ndirectory)\nbuilder for \u2018/nix/store/p481alkpm89712n3hnwai0nxhmjrm8b2-project-0.1.0.0.drv\u2019 failed with exit code 1\nerror: build of \u2018/nix/store/p481alkpm89712n3hnwai0nxhmjrm8b2-project-0.1.0.0.drv\u2019 failed\n</code></pre>\n\n<p>Which of course isn't good. What mistake am I making here? I've been successful in a similar attempt which was building an executable instead of a library, so I suspect it has something to do with that. The github repo I was following was using an executable as well.</p>\n"}, {"tags": ["regex", "haskell", "backtracking", "parsec", "attoparsec"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7876047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ea1f5547e24ecad990b3040f6d1a1a3?s=128&d=identicon&r=PG&f=1", "display_name": "Iguana Bob", "link": "https://stackoverflow.com/users/7876047/iguana-bob"}, "edited": false, "score": 1, "creation_date": 1492388847, "post_id": 43443339, "comment_id": 73943882, "body": "Well, the documentation explicitly says: &quot;attoparsec parsers always backtrack on failure&quot;. What parser combinators are there with full backtracking support? Performance is not an issue for me and the proposed solution with <code>manyTill</code> does not work well for my use case."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 31, "user_id": 7876047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ea1f5547e24ecad990b3040f6d1a1a3?s=128&d=identicon&r=PG&f=1", "display_name": "Iguana Bob", "link": "https://stackoverflow.com/users/7876047/iguana-bob"}, "edited": false, "score": 3, "creation_date": 1492391318, "post_id": 43443339, "comment_id": 73944291, "body": "@IguanaBob <a href=\"http://hackage.haskell.org/package/regex-applicative\" rel=\"nofollow noreferrer\">regex-applicative</a> does not backtrack but will always succeed if it is possible to. <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Text-ParserCombinators-ReadP.html\" rel=\"nofollow noreferrer\">ReadP</a> has the same property and can parse more grammars. <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Text-ParserCombinators-ReadP.html#t:ReadS\" rel=\"nofollow noreferrer\">ReadS</a> is basically a less efficient ReadP, and does actually backtrack -- but I consider &quot;backtracking&quot; to be an implementation detail for the real property you care about, which all three satisfy."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": false, "score": 2, "last_activity_date": 1492386165, "creation_date": 1492386165, "answer_id": 43443339, "question_id": 43442702, "link": "https://stackoverflow.com/questions/43442702/attoparsec-parse-fails-but-shouldnt-with-proper-backtracking/43443339#43443339", "title": "Attoparsec parse fails but shouldn&#39;t with proper backtracking", "body": "<blockquote>\n  <p>I am using Attoparsec which is said to backtrack by default.</p>\n</blockquote>\n\n<p>Not quite. Attoparsec <em>does</em> support backtracking, but only in some explicit situations (where the documentation says it does). Its purpose is high-performance parsing and, unsurprisingly, that doesn't play well with backtracking.</p>\n\n<p>You are looking for <a href=\"https://hackage.haskell.org/package/attoparsec-0.13.1.0/docs/Data-Attoparsec-Combinator.html#v:manyTill\" rel=\"nofollow noreferrer\"><code>manyTill</code></a> or <code>manyTill'</code>. Note that the backtracking behaviour is mentioned in the documentation.</p>\n\n<pre><code>ghci&gt; manyTill1 p e = (:) &lt;$&gt; p &lt;*&gt; manyTill p e \nghci&gt; parseOnly (string \"foo\" *&gt; manyTill1 anyChar (string \"bar\")) \"fooxxxbar\"\nRight \"xxx\"\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 7876047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ea1f5547e24ecad990b3040f6d1a1a3?s=128&d=identicon&r=PG&f=1", "display_name": "Iguana Bob", "link": "https://stackoverflow.com/users/7876047/iguana-bob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1492386165, "creation_date": 1492380674, "question_id": 43442702, "link": "https://stackoverflow.com/questions/43442702/attoparsec-parse-fails-but-shouldnt-with-proper-backtracking", "title": "Attoparsec parse fails but shouldn&#39;t with proper backtracking", "body": "<p>I am using Attoparsec which is said to backtrack by default. However, the following line:</p>\n\n<pre><code>parseOnly  (string \"foo\" *&gt; many1 anyChar &lt;* string \"bar\") \"fooxxxbar\"\n</code></pre>\n\n<p>fails with:</p>\n\n<pre><code>Left \"not enough input\"\n</code></pre>\n\n<p>Why is that so? If <code>many1 anyChar</code> decides to parse only three characters (<code>xxx</code>) it should be successful. And it should consider doing that at some point because of backtracking, shouldn't it?</p>\n\n<p>What is the proper way to do equivalent of <code>/foo(.*)bar/</code> regex using Attoparsec?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 3, "creation_date": 1492379500, "post_id": 43442038, "comment_id": 73941850, "body": "N.B. <code>&#47;=</code> makes sense in some ways because 1. Variables are immutable so operators like <code>+=, &#47;=, -=</code> etc aren&#39;t in the base language 2. It sort of looks like <code>\u2260</code>."}, {"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 1, "creation_date": 1492382488, "post_id": 43442038, "comment_id": 73942587, "body": "Nitpick: <code>&#47;=</code> is a normal function, not a &quot;Haskell syntax&quot;. <code>(&#47;=) x y</code> also works."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 3, "creation_date": 1492384024, "post_id": 43442038, "comment_id": 73942941, "body": "@ThomasM.DuBuisson I agree, yet I wish Haskell followed the C naming for that, since after all we already share <code>==,&lt;,&gt;,&lt;=,&gt;=,&amp;&amp;,||</code> with C. I can understand not using <code>!</code> for unary negation (non-alpha names are for binary operators), but <code>&#47;=</code> feels unique, compared to other languages (<code>!=,&lt;&gt;</code> are fairly common). After getting used to it, I like <code>&#47;=</code> on its own, though -- I only wish many languages followed the same notation for very basic operators."}, {"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 3, "creation_date": 1492408889, "post_id": 43442038, "comment_id": 73948072, "body": "I suggested != way back when, but I think it was Joe Fasel who decided to go for /= instead."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 5, "last_activity_date": 1492383510, "last_edit_date": 1492383510, "creation_date": 1492376067, "answer_id": 43442038, "question_id": 43441925, "link": "https://stackoverflow.com/questions/43441925/equivalent-code-in-haskell-for/43442038#43442038", "title": "Equivalent code in Haskell for !=", "body": "<p>The correct Haskell name is <code>/=</code> for the \"not equal\" comparison operator.</p>\n"}], "owner": {"reputation": 537, "user_id": 7869621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd1e52c50a93fb4403a9dd0d2192276?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/7869621/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 515, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1492383510, "creation_date": 1492375369, "last_edit_date": 1492380953, "question_id": 43441925, "link": "https://stackoverflow.com/questions/43441925/equivalent-code-in-haskell-for", "title": "Equivalent code in Haskell for !=", "body": "<p>Is there an equivalent statement, in Haskell, for code similar to the following:</p>\n\n<pre><code>x != y\n</code></pre>\n\n<p>For instance:</p>\n\n<pre><code>[x+y | x &lt;- list1, y &lt;- list2, x != y]\n</code></pre>\n\n<p>How would I say the last bit: (x != y) in Haskell?</p>\n"}, {"tags": ["haskell", "f#", "functional-programming", "ocaml"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1492361410, "post_id": 43439492, "comment_id": 73936138, "body": "For your types you can use basic application <code>funcAB valA valB</code>, but something tells me you didn&#39;t intend <code>funcAB</code> to take options as input (?). Can you clarify?"}, {"owner": {"reputation": 994, "user_id": 2349174, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3c97cf2b020c357692218a9c46807ee6?s=128&d=identicon&r=PG", "display_name": "mateuszlewko", "link": "https://stackoverflow.com/users/2349174/mateuszlewko"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1492361594, "post_id": 43439492, "comment_id": 73936192, "body": "So image that funcAB is a function from 3rd party api and it doesn&#39;t take option type, and even if it did it would need to handle option values (like a constructor that can create object only if all arguments are Some). EDIT: Yes, funcAB shouldn&#39;t take option types, I&#39;ve corrected this."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1492361695, "post_id": 43439492, "comment_id": 73936229, "body": "Ok, I&#39;d suggest you edit your question accordingly, fixing the input types to be non-options."}, {"owner": {"reputation": 11019, "user_id": 418488, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/625af9d6f5c5062f65a43582b57c041d?s=128&d=identicon&r=PG", "display_name": "Just another metaprogrammer", "link": "https://stackoverflow.com/users/418488/just-another-metaprogrammer"}, "edited": false, "score": 1, "creation_date": 1492424896, "post_id": 43439492, "comment_id": 73954886, "body": "FYI: There&#39;s also <code>Option.map2</code> and <code>Option.map3</code> that can help. But there&#39;s no <code>Option.map4</code> which means Applicative is the way to go in the general case IMO. In addition, in F# it&#39;s somewhat frowned upon using operators (I personally don&#39;t agree with this, just saying). Therefore a possibly more F# idiomatic way is to use <code>|&gt;</code>: <code>pure funcAB |&gt; ap valA |&gt; ap valB</code>"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 5, "last_activity_date": 1492362305, "last_edit_date": 1495542850, "creation_date": 1492361813, "answer_id": 43439667, "question_id": 43439492, "link": "https://stackoverflow.com/questions/43439492/proper-way-of-applying-two-or-many-option-values-to-a-function-in-f/43439667#43439667", "title": "Proper way of applying two (or many) option values to a function in F#", "body": "<p>In Haskell, we can use <code>Applicative</code> syntax for that:</p>\n\n<p>If</p>\n\n<pre><code>valA :: f a\nvalB :: f b\nfunAB :: a -&gt; b -&gt; f c\n</code></pre>\n\n<p>then</p>\n\n<pre><code>join $ funAB &lt;$&gt; valA &lt;*&gt; valB :: f c\n</code></pre>\n\n<p>provided <code>f</code> is a monad (like <code>Maybe</code>, Haskell's <code>option</code>).</p>\n\n<p>It should be adaptable to F# as well, I guess, as long as you define your operators</p>\n\n<pre><code>(&lt;$&gt;) ::   (a -&gt; b) -&gt; f a -&gt; f b\n(&lt;*&gt;) :: f (a -&gt; b) -&gt; f a -&gt; f b\njoin  :: f (f a) -&gt; f a\n</code></pre>\n\n<p>The above trick is a poor man's version of <a href=\"https://stackoverflow.com/q/33219871/3234959\">Idris !-notation (bang notation)</a>.</p>\n\n<p>Another common option is using <code>do</code></p>\n\n<pre><code>do a &lt;- valA\n   b &lt;- valB\n   funAB a b\n</code></pre>\n\n<p>but this is comparable with using <code>&gt;&gt;=</code>, indeed:</p>\n\n<pre><code>valA &gt;&gt;= \\a -&gt;\nvalB &gt;&gt;= \\b -&gt;\nfunAB a b\n</code></pre>\n\n<p>is not much more complex.</p>\n"}, {"tags": [], "owner": {"reputation": 7386, "user_id": 2894770, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xfbIb.png?s=128&g=1", "display_name": "CaringDev", "link": "https://stackoverflow.com/users/2894770/caringdev"}, "is_accepted": false, "score": 2, "last_activity_date": 1492428226, "creation_date": 1492428226, "answer_id": 43450494, "question_id": 43439492, "link": "https://stackoverflow.com/questions/43439492/proper-way-of-applying-two-or-many-option-values-to-a-function-in-f/43450494#43450494", "title": "Proper way of applying two (or many) option values to a function in F#", "body": "<p>One option is to use <a href=\"https://docs.microsoft.com/en-us/dotnet/articles/fsharp/language-reference/computation-expressions\" rel=\"nofollow noreferrer\">computation expressions</a>. For <code>option</code> there is no standard one but you can easily create your own:</p>\n\n<pre><code>type OptionBuilder() =\n    member this.Bind (x, f) = Option.bind f x\n    member this.Return x = Some x\n\nlet optional = OptionBuilder()\n\nlet a, b = Some(42), Some(7)\nlet f x y = x + y\n\nlet res = optional {\n    let! x = a\n    let! y = b\n    return f x y\n}\n</code></pre>\n\n<p>which closely resembles Haskells <code>do</code> notation.\nFor more advanced features, have a look at <a href=\"http://gusty.github.io/FSharpPlus/\" rel=\"nofollow noreferrer\">F#+</a> which also has a generic applicative functor operator <code>&lt;*&gt;</code>.</p>\n"}], "owner": {"reputation": 994, "user_id": 2349174, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3c97cf2b020c357692218a9c46807ee6?s=128&d=identicon&r=PG", "display_name": "mateuszlewko", "link": "https://stackoverflow.com/users/2349174/mateuszlewko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 309, "favorite_count": 0, "accepted_answer_id": 43439667, "answer_count": 2, "score": 5, "last_activity_date": 1492428226, "creation_date": 1492360666, "last_edit_date": 1492385845, "question_id": 43439492, "link": "https://stackoverflow.com/questions/43439492/proper-way-of-applying-two-or-many-option-values-to-a-function-in-f", "title": "Proper way of applying two (or many) option values to a function in F#", "body": "<p>Recently I discovered a style of programming which is very useful (and pretty) in functional world called <a href=\"https://fsharpforfunandprofit.com/rop/\" rel=\"nofollow noreferrer\">Railway oriented programming</a>.\nFor example when want to create a pipeline of functions that produce option type, and we want to return None if any of them fails we can do something like this:</p>\n\n<pre><code>someOptionValue // : 'a option\n&gt;&gt;= func1       // func1: 'a -&gt; 'b option\n&gt;&gt;= func2       // func2: 'b -&gt; 'c option\nand so on...\n</code></pre>\n\n<p>where <code>(&gt;&gt;=) : 'a option -&gt; (a' -&gt; 'b option) -&gt; 'b option</code> operator applies a value to the left hands side if it's <code>Some value</code> or <code>None</code> otherwise.</p>\n\n<p>But, here is my problem, what if we have a function that \"takes\" two (or many) option types, let say <code>funcAB : 'a -&gt; 'b -&gt; 'c option</code>, <code>valA : 'a option</code> and <code>valB : 'b option</code> and we still want to create this pipeline or use some nice operator (not create a new one specifically for this, but use some standard approach, in particular I don't want to use <code>match ... with</code> to \"unpack\" option values)</p>\n\n<p>Currently I have something like this:</p>\n\n<pre><code>valA\n&gt;&gt;= (funcAB &gt;&gt; Some)\n&gt;&gt;= (fun ctr -&gt; valB &gt;&gt;= ctr)\n</code></pre>\n\n<p>But is doesn't seem 'correct' (or fun is the better word ;] ), and it doesn't scale well if a function takes more parameters or we want to create a longer pipeline. Is there a better way to do this?</p>\n\n<p>I've used F# syntax but I think this question can be applied to any functional programming language, like OCaml and Haskell. </p>\n\n<p><strong>EDIT (Solution):</strong></p>\n\n<p>Thanks to the chi's answer I've created following code F# which is much more idiomatic then what I previously had:</p>\n\n<pre><code>funcAB &lt;!&gt; valA &lt;*&gt; valB |&gt; Option.flatten\n</code></pre>\n\n<p>And it looks well if we have more values: <code>funcAB &lt;!&gt; valA &lt;*&gt; valB &lt;*&gt; valC &lt;*&gt; ...</code>.</p>\n\n<p>I've used operators defined in <a href=\"https://github.com/haf/YoLo\" rel=\"nofollow noreferrer\">YoLo</a>.</p>\n"}, {"tags": ["haskell", "state-monad"], "comments": [{"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 5, "creation_date": 1492359358, "post_id": 43438875, "comment_id": 73935433, "body": "What is your exact question? What type of goals you&#39;re trying to accomplish? Where your confusion comes from? You don&#39;t know what is <code>newtype</code>, <code>type</code> and <code>class</code>? If you just don&#39;t understand those structures then just read some Haskell tutorials. StackOverflow is for specific questions."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1492359716, "post_id": 43438875, "comment_id": 73935547, "body": "And the question is...? :)"}], "answers": [{"tags": [], "owner": {"reputation": 833, "user_id": 7847896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3e72cb1d5eceb94842bec50894e6943?s=128&d=identicon&r=PG&f=1", "display_name": "zbw", "link": "https://stackoverflow.com/users/7847896/zbw"}, "is_accepted": false, "score": 6, "last_activity_date": 1492366446, "creation_date": 1492366446, "answer_id": 43440466, "question_id": 43438875, "link": "https://stackoverflow.com/questions/43438875/confusion-about-statet-state-and-monadstate/43440466#43440466", "title": "Confusion about StateT, State and MonadState", "body": "<p><code>State</code> is for your normal state monad.  This is the simplest of the three.  (In some older tutorials, you may see use of the <code>State</code> constructor, but this has been replaced with the <code>state</code> function, because <code>State s</code> is now a type alias for <code>StateT s Identity</code>.)</p>\n\n<p><code>StateT</code> is the monad transformer for the <code>State</code> monad.  It adds a layer of generality by allowing you to put an arbitrary monad inside the state.  This is useful for simple parsers, which could use e.g. <code>StateT [Token] Maybe Result</code> to represent the parsing as a stateful operation that could fail.</p>\n\n<p><code>MonadState</code> generalizes the situation even farther.  There is an instance <code>Monad m =&gt; MonadState s (StateT s m)</code>, but there are also instances, like one that allows you to perform stateful operations on monad transformers of <code>StateT</code>.  All basic state functions (<code>get</code>, <code>set</code>, <code>modify</code>, etc.) can be used with an instance of <code>MonadState</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 24, "last_activity_date": 1492371339, "creation_date": 1492371339, "answer_id": 43441289, "question_id": 43438875, "link": "https://stackoverflow.com/questions/43438875/confusion-about-statet-state-and-monadstate/43441289#43441289", "title": "Confusion about StateT, State and MonadState", "body": "<p>Once upon a time, there was a <code>State</code> type:</p>\n\n<pre><code>-- Not the current definition.\nnewtype State s a = State {runState :: s -&gt; (a, s)}\n</code></pre>\n\n<p><code>State s a</code> values are, in essence, functions that take a state and produce a result and an updated state. Suitable <code>Functor</code>, <code>Applicative</code> and <code>Monad</code> instances make it possible to compose such functions in a more convenient manner, by making the tuple shuffling need to handle the <code>(a, s)</code> output implicit. With the help of a handful basic of operations that manipulate the state...</p>\n\n<pre><code>get = State $ \\s -&gt; (s, s)\nput s = State $ \\_ -&gt; ((), s)\n</code></pre>\n\n<p>... it is possible to avoid any mention of the underlying <code>s -&gt; (a, s)</code> type, and write code that <em>feels</em> stateful.</p>\n\n<p><code>StateT s</code> is a monad transformer patterned after <code>State s</code>:</p>\n\n<pre><code>newtype StateT s m a = StateT {runStateT :: s -&gt; m (a, s)}\n</code></pre>\n\n<p>This transformer adds the state processing capabilities described above atop a base monad, <code>m</code>. It comes with <code>Functor</code>, <code>Applicative</code> and <code>Monad</code> instances, as well as versions of <code>get</code> and <code>put</code>.</p>\n\n<p>If <code>m</code>, the base monad, in <code>StateT s m</code> is <code>Identity</code>, the dummy functor...</p>\n\n<pre><code>newtype Identity a = Identity {runIdentity :: a}\n</code></pre>\n\n<p>... we get something equivalent to plain old <code>State s</code>. That being so, <em>transformers</em> defines <code>State</code> as a synonym...</p>\n\n<pre><code>type State s = StateT s Identity\n</code></pre>\n\n<p>... rather than as a separate type.</p>\n\n<p>As for <code>MonadState</code>, it caters to two different needs. Firstly, we can use the monad transformers machinery to have <code>StateT s m</code> as a base monad for some other transformer in a stack of transformers (arbitrary example: <code>MaybeT (StateT Int IO)</code>). In that case, though, <code>lift</code> from <code>MonadTrans</code> becomes necessary to use <code>get</code> and <code>put</code>. One way of using the operations directly in such cases is through <code>MonadState</code>: it provides them as methods...</p>\n\n<pre><code>-- Abridged class definition.\nclass Monad m =&gt; MonadState s m | m -&gt; s where\n    get :: m s\n    put :: s -&gt; m ()\n    state :: (s -&gt; (a, s)) -&gt; m a\n</code></pre>\n\n<p>... so that we can have instances for any combination of transformers involving <code>StateT</code> that we are interested in.</p>\n\n<pre><code>instance Monad m =&gt; MonadState s (StateT s m) where -- etc.\ninstance MonadState s m =&gt; MonadState s (MaybeT m) where -- etc.\n-- And so forth\n</code></pre>\n\n<p>Secondly, if we want to have a state monad with an implementation different than the one in <em>transformers</em>, we can make it an instance of <code>MonadState</code>, so that we keep the same basic operations and, as long as we write type signatures in terms of <code>MonadState</code>, have it easier to change implementations if need be.</p>\n"}], "owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4252, "favorite_count": 3, "accepted_answer_id": 43441289, "answer_count": 2, "score": 11, "last_activity_date": 1554994625, "creation_date": 1492356871, "question_id": 43438875, "link": "https://stackoverflow.com/questions/43438875/confusion-about-statet-state-and-monadstate", "title": "Confusion about StateT, State and MonadState", "body": "<p>I'm utterly confused between</p>\n\n<pre><code>newtype StateT s m a = StateT {runStateT :: s -&gt; m (a, s)}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>type State s = StateT s Identity\n</code></pre>\n\n<p>and</p>\n\n<pre><code>class Monad m =&gt; MonadState s m | m -&gt; s\n</code></pre>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1492357053, "post_id": 43438858, "comment_id": 73934707, "body": "What if the object occurs multiple times?"}, {"owner": {"reputation": 13, "user_id": 6414663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e380af78999d708464d707b94cedf255?s=128&d=identicon&r=PG&f=1", "display_name": "Slo", "link": "https://stackoverflow.com/users/6414663/slo"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1492357128, "post_id": 43438858, "comment_id": 73934733, "body": "I have to remove each occurrence."}, {"owner": {"reputation": 3627, "user_id": 3695939, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d75f41bcfc1d3f20c084ec7e87d82012?s=128&d=identicon&r=PG&f=1", "display_name": "moondaisy", "link": "https://stackoverflow.com/users/3695939/moondaisy"}, "edited": false, "score": 1, "creation_date": 1492358980, "post_id": 43438858, "comment_id": 73935304, "body": "Do you want to remove the object occurrences or the box that contains the object?"}, {"owner": {"reputation": 13, "user_id": 6414663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e380af78999d708464d707b94cedf255?s=128&d=identicon&r=PG&f=1", "display_name": "Slo", "link": "https://stackoverflow.com/users/6414663/slo"}, "edited": false, "score": 1, "creation_date": 1492359091, "post_id": 43438858, "comment_id": 73935339, "body": "I want to remove the box."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 6414663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e380af78999d708464d707b94cedf255?s=128&d=identicon&r=PG&f=1", "display_name": "Slo", "link": "https://stackoverflow.com/users/6414663/slo"}, "edited": false, "score": 0, "creation_date": 1492360700, "post_id": 43439381, "comment_id": 73935875, "body": "And if I also want to delete another object returneb by another function ? I&#39;m very bad with haskell sorry"}, {"owner": {"reputation": 3627, "user_id": 3695939, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d75f41bcfc1d3f20c084ec7e87d82012?s=128&d=identicon&r=PG&f=1", "display_name": "moondaisy", "link": "https://stackoverflow.com/users/3695939/moondaisy"}, "reply_to_user": {"reputation": 13, "user_id": 6414663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e380af78999d708464d707b94cedf255?s=128&d=identicon&r=PG&f=1", "display_name": "Slo", "link": "https://stackoverflow.com/users/6414663/slo"}, "edited": false, "score": 0, "creation_date": 1492361196, "post_id": 43439381, "comment_id": 73936062, "body": "What do you mean by that? If it&#39;s related to this just edit the question including more info or create a new one"}, {"owner": {"reputation": 13, "user_id": 6414663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e380af78999d708464d707b94cedf255?s=128&d=identicon&r=PG&f=1", "display_name": "Slo", "link": "https://stackoverflow.com/users/6414663/slo"}, "edited": false, "score": 0, "creation_date": 1492362885, "post_id": 43439381, "comment_id": 73936635, "body": "Thank, it&#39;s more the seconde case but i need to do this inside the function, not when i call the function"}, {"owner": {"reputation": 3627, "user_id": 3695939, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d75f41bcfc1d3f20c084ec7e87d82012?s=128&d=identicon&r=PG&f=1", "display_name": "moondaisy", "link": "https://stackoverflow.com/users/3695939/moondaisy"}, "reply_to_user": {"reputation": 13, "user_id": 6414663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e380af78999d708464d707b94cedf255?s=128&d=identicon&r=PG&f=1", "display_name": "Slo", "link": "https://stackoverflow.com/users/6414663/slo"}, "edited": false, "score": 0, "creation_date": 1492363810, "post_id": 43439381, "comment_id": 73936933, "body": "In that case if you change the <code>case</code> with <code>(elem o b) || (elem (negative o) b)</code> that would be removing the box if it contains the object or it&#39;s negative"}, {"owner": {"reputation": 13, "user_id": 6414663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e380af78999d708464d707b94cedf255?s=128&d=identicon&r=PG&f=1", "display_name": "Slo", "link": "https://stackoverflow.com/users/6414663/slo"}, "edited": false, "score": 0, "creation_date": 1492364010, "post_id": 43439381, "comment_id": 73937008, "body": "But if it contains the negative, i just have to remove the element, not the box, from the formula"}], "tags": [], "owner": {"reputation": 3627, "user_id": 3695939, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/d75f41bcfc1d3f20c084ec7e87d82012?s=128&d=identicon&r=PG&f=1", "display_name": "moondaisy", "link": "https://stackoverflow.com/users/3695939/moondaisy"}, "is_accepted": true, "score": 0, "last_activity_date": 1492364557, "last_edit_date": 1492364557, "creation_date": 1492360043, "answer_id": 43439381, "question_id": 43438858, "link": "https://stackoverflow.com/questions/43438858/haskell-find-and-remove-element-from-a-list-of-list/43439381#43439381", "title": "Haskell - Find and remove element from a list of list", "body": "<p>Since you want to remove the <code>Box</code> that contains the element you could use <code>elem :: Eq a =&gt; a -&gt; [a] -&gt; Bool</code> to check just that:</p>\n\n<pre><code>findAndDelete :: Formula -&gt; Object -&gt; Formula\nfindAndDelete [] o = []\nfindAndDelete (b:bs) o = case (elem o b) of {\n                            True -&gt; findAndDelete bs o;\n                            False -&gt; b:(findAndDelete bs o)\n                       };\n</code></pre>\n\n<p>So to remove the negative objects during the <code>findAndDelete</code> function you can use <code>filter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]</code> this will give you a <code>Box</code> where all the objects satisfy the predicate:</p>\n\n<pre><code>findAndDelete :: Formula -&gt; Object -&gt; Formula\nfindAndDelete [] o = []\nfindAndDelete (b:bs) o = case (elem o b) of {\n                             True -&gt; findAndDelete bs o;\n                             False -&gt; (filter ((/=) (negative o)) b):(findAndDelete bs o)\n                          };\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1492362767, "creation_date": 1492362767, "answer_id": 43439836, "question_id": 43438858, "link": "https://stackoverflow.com/questions/43438858/haskell-find-and-remove-element-from-a-list-of-list/43439836#43439836", "title": "Haskell - Find and remove element from a list of list", "body": "<p>If you want to remove the <strong>boxes</strong>, you can filter for all the boxes who do not have the given object as their element.</p>\n\n<pre><code>import Data.List\n\nfindAndDelete :: Formula -&gt; Object -&gt; Formula\nfindAndDelete f o = filter (not . elem o) f\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6414663, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e380af78999d708464d707b94cedf255?s=128&d=identicon&r=PG&f=1", "display_name": "Slo", "link": "https://stackoverflow.com/users/6414663/slo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1002, "favorite_count": 1, "accepted_answer_id": 43439381, "answer_count": 2, "score": 1, "last_activity_date": 1492364557, "creation_date": 1492356746, "last_edit_date": 1492361712, "question_id": 43438858, "link": "https://stackoverflow.com/questions/43438858/haskell-find-and-remove-element-from-a-list-of-list", "title": "Haskell - Find and remove element from a list of list", "body": "<p>I need to find an element l in a list of list, removing each list containing the element, and then return the list of list, but i don't know how to parsing list of list and, at the same time, removing the list and keeping parsing the rest of the list.</p>\n\n<p>To be more understandable, i have : </p>\n\n<pre><code>data Object = Pos Char | Neg Char\n     deriving (Show, Eq)\n\ntype Box = [Object]\n\ntype Formula = [Box]\n\nfindAndDelete :: Formula -&gt; Object -&gt; Formula\nfindAndDelete cs l\nfindAndDelete (c:cs) l\n</code></pre>\n\n<p><strong>edit</strong> : At the same time, I need to remove all x element from the Formula,x is returned by a function named negative with l in parameter.</p>\n\n<pre><code>negative :: Object -&gt; Object\nnegative (Pos v) = Neg v\nnegative (Neg v) = Pos v\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 20829, "user_id": 1030110, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/bsgx2.png?s=128&g=1", "display_name": "m0nhawk", "link": "https://stackoverflow.com/users/1030110/m0nhawk"}, "edited": false, "score": 3, "creation_date": 1492334775, "post_id": 43435721, "comment_id": 73928613, "body": "You can&#39;t have the following list: <code>[[1,2,3], 4, 5, 6]</code>. Only this: <code>[[1,2,3], [4], [5], [6]]</code>. You can make this a tuple instead."}, {"owner": {"reputation": 4096, "user_id": 2056979, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/pg0MQ.jpg?s=128&g=1", "display_name": "Keatinge", "link": "https://stackoverflow.com/users/2056979/keatinge"}, "edited": false, "score": 1, "creation_date": 1492336251, "post_id": 43435721, "comment_id": 73928998, "body": "To add one to what m0nhawk said, the reason you can&#39;t do this is because in Haskell lists are homogeneous. This means every element of the list must the same type. So you can have a list of lists. But you cannot have a list which contains both lists and numbers. This is an XY problem, you think you need this data structure but you don&#39;t. What actual problem are you trying to solve?"}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1492342106, "post_id": 43435933, "comment_id": 73930453, "body": "Incidentally, if you give <code>ScalarOrList</code> instances of both <code>Num</code> and <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/GHC-Exts.html#t:IsList\" rel=\"nofollow noreferrer\"><code>IsList</code></a> then you can actually write <code>[[1,2,3],4,5,6]</code>. I wouldn&#39;t necessarily consider it a good idea, though."}, {"owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1492342247, "post_id": 43435933, "comment_id": 73930482, "body": "@leftaroundabout Thanks for the useful info!"}], "tags": [], "owner": {"reputation": 66318, "user_id": 3510736, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/kVtHP.jpg?s=128&g=1", "display_name": "Ami Tavory", "link": "https://stackoverflow.com/users/3510736/ami-tavory"}, "is_accepted": true, "score": 6, "last_activity_date": 1492336324, "creation_date": 1492336324, "answer_id": 43435933, "question_id": 43435721, "link": "https://stackoverflow.com/questions/43435721/how-to-combine-two-lists-in-haskell/43435933#43435933", "title": "How to combine two lists in Haskell", "body": "<p>As m0nhawk writes in the comments, you can't directly have a Haskell List of both lists of integers and integers. There are several alternatives, though.</p>\n\n<hr>\n\n<p>One alternative is indeed to use a list of lists of integers (<code>[[1, 2, 3], [4], [5], [6]]</code>), like this:</p>\n\n<pre><code>combine:: [Int] -&gt; [Int] -&gt; [[Int]]\ncombine xs ys = [xs] ++ [[y] | y &lt;- ys] \n\nmain = do\n    putStrLn $ show $ combine [1, 2, 3] [4, 5, 6]               \n</code></pre>\n\n<p>(running this indeed prints <code>[[1, 2, 3], [4], [5], [6]]</code>).</p>\n\n<hr>\n\n<p>Another alternative is to use <a href=\"https://wiki.haskell.org/Algebraic_data_type\" rel=\"noreferrer\">algebraic data types</a>:</p>\n\n<pre><code>Prelude&gt; data ScalarOrList = Scalar Int | List [Int] deriving(Show)\nPrelude&gt; [List [1, 2, 3], Scalar 4, Scalar 5, Scalar 6]\n[List [1,2,3],Scalar 4,Scalar 5,Scalar 6]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "is_accepted": false, "score": 3, "last_activity_date": 1492341094, "creation_date": 1492341094, "answer_id": 43436596, "question_id": 43435721, "link": "https://stackoverflow.com/questions/43435721/how-to-combine-two-lists-in-haskell/43436596#43436596", "title": "How to combine two lists in Haskell", "body": "<p>There <em>are</em> such things as heterogeneous lists in Haskell, but they're not particularly trivial or beginner-friendly:</p>\n\n<p><a href=\"https://hackage.haskell.org/package/hvect-0.4.0.0/docs/Data-HVect.html\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/hvect-0.4.0.0/docs/Data-HVect.html</a></p>\n\n<p>This is also a good read: <a href=\"https://wiki.haskell.org/Heterogenous_collections\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Heterogenous_collections</a></p>\n\n<p>You're probably best off trying to see if you can make your own data type that encapsulates both simple values and lists of values:</p>\n\n<p><code>data IntOrList = AnInt Int | AList [Int]</code></p>\n\n<p>But then you'll have to unwrap your values, which might be an added layer that you don't want to deal with. At least they'll all be able to share a list though: <code>someList = [AnInt 5, AnInt 7, AList [1, 2, 5, 8], AnInt 2]</code></p>\n"}], "owner": {"reputation": 115, "user_id": 7253589, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fd9a2b638a27d347e2232fdb495cabd0?s=128&d=identicon&r=PG&f=1", "display_name": "JoeDonald", "link": "https://stackoverflow.com/users/7253589/joedonald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6886, "favorite_count": 0, "accepted_answer_id": 43435933, "answer_count": 2, "score": 4, "last_activity_date": 1492341094, "creation_date": 1492334565, "question_id": 43435721, "link": "https://stackoverflow.com/questions/43435721/how-to-combine-two-lists-in-haskell", "title": "How to combine two lists in Haskell", "body": "<p>I want to make a list of lists like this:</p>\n\n<p>[1,2,3] [4,5,6] -> [[1,2,3], 4, 5, 6]</p>\n\n<p>This what i have by now:</p>\n\n<pre><code>combine :: [a] -&gt; [a] -&gt; [[a]]\ncombine xs ys = [xs,ys]\n</code></pre>\n\n<p>But this code gives me: [[1, 2, 3], [4, 5, 6]] and is not what I need.</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 20350, "user_id": 411944, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7bf057b98d0652db34842d1817234853?s=128&d=identicon&r=PG", "display_name": "Reactormonk", "link": "https://stackoverflow.com/users/411944/reactormonk"}, "edited": false, "score": 0, "creation_date": 1492351846, "post_id": 43434680, "comment_id": 73933150, "body": "If you want to cache things in docker, you&#39;ll need a separate line. <a href=\"https://github.com/commercialhaskell/stack/issues/694\" rel=\"nofollow noreferrer\">github.com/commercialhaskell/stack/issues/694</a> comes somewhat close."}], "answers": [{"tags": [], "owner": {"reputation": 1178, "user_id": 1667161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233658d12fabd9d72b04d0a6916f6389?s=128&d=identicon&r=PG", "display_name": "liminalisht", "link": "https://stackoverflow.com/users/1667161/liminalisht"}, "is_accepted": false, "score": 0, "last_activity_date": 1492370357, "creation_date": 1492370357, "answer_id": 43441112, "question_id": 43434680, "link": "https://stackoverflow.com/questions/43434680/how-to-run-a-stack-build-in-a-docker-container/43441112#43441112", "title": "How to run a stack build in a Docker container?", "body": "<p>I typically put a <code>volumes</code> section in an accompanying <code>docker-compose.yml</code> file that will mount the <code>.stack-work</code> directory into the container. Then in the script that is referenced in the <code>ENTRYPOINT</code> of the <code>Dockerfile</code>, use <code>stack install</code> instead of <code>stack build</code>.</p>\n\n<p>My <code>docker-compose.yml</code> file might look something like this, where the <code>backend</code> folder contains my local <code>.stack-work</code> directory:</p>\n\n<pre><code>version: \"2\"\nservices:\n  backend:\n    build: ./docker-containers/backend\n    tty: true\n    stdin_open: true   \n    volumes:\n      - ./backend:/home/dev/backend\n      - ./.local:/root/.local\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 161, "user_id": 12147490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/90b4bec77f92f0db5db412409f1275e4?s=128&d=identicon&r=PG&f=1", "display_name": "bg2000 Reinstate Monica", "link": "https://stackoverflow.com/users/12147490/bg2000-reinstate-monica"}, "edited": false, "score": 0, "creation_date": 1601510412, "post_id": 47844018, "comment_id": 113434115, "body": "Does this mean that the host operating system&#39;s <code>~&#47;.stack</code> folder is used by the container operating system? What if they are different operating systems? Then I think it won&#39;t be able to re-use your previously built dependancies. Or, if the files made in the container overwrite what is in your host&#39;s <code>~&#47;.stack</code> then you will have problems."}], "tags": [], "owner": {"reputation": 1802, "user_id": 1897767, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b60e45c2f2adbfef9aa2d7c200b27f67?s=128&d=identicon&r=PG", "display_name": "Daishi Nakajima", "link": "https://stackoverflow.com/users/1897767/daishi-nakajima"}, "is_accepted": false, "score": 0, "last_activity_date": 1601542731, "last_edit_date": 1601542731, "creation_date": 1513414004, "answer_id": 47844018, "question_id": 43434680, "link": "https://stackoverflow.com/questions/43434680/how-to-run-a-stack-build-in-a-docker-container/47844018#47844018", "title": "How to run a stack build in a Docker container?", "body": "<p>My solution is as follows.</p>\n<p>Note that the docker image for build does not have stack setup.</p>\n<pre><code>FROM fpco/stack-build:lts-9.14\nADD ./build.sh /bin/\nENTRYPOINT [&quot;build.sh&quot;]\n</code></pre>\n<p>Run stack setup in <code>build.sh</code> like this:</p>\n<pre><code>stack setup --resolver=lts-9.14 --allow-different-user\nstack build --allow-different-user\n</code></pre>\n<p>Mount the project dir and stack_root from host at runtime.</p>\n<pre><code>docker run -w /workspace -v ~/myproject:/workspace -v ~/.stack:/root/.stack\n</code></pre>\n"}], "owner": {"reputation": 945, "user_id": 463800, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1327ce755b24b956995d68accae3eab2?s=128&d=identicon&r=PG", "display_name": "jml", "link": "https://stackoverflow.com/users/463800/jml"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1440, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1601542731, "creation_date": 1492326337, "last_edit_date": 1492327155, "question_id": 43434680, "link": "https://stackoverflow.com/questions/43434680/how-to-run-a-stack-build-in-a-docker-container", "title": "How to run a stack build in a Docker container?", "body": "<p>I'd like to set up a containerized build of a Haskell stack project for work. I know that <code>stack --docker build</code> exists, but I'd like to do this just with docker, so my colleagues are not required to first install <code>stack</code>.</p>\n\n<p>I currently have a Dockerfile that looks like:</p>\n\n<pre><code>FROM fpco/stack-build:lts-8.9\nRUN mkdir -p /stack &amp;&amp; stack --stack-root /stack setup --resolver lts-8.9\nCOPY build.sh /\nENTRYPOINT [\"/build.sh\"]\n</code></pre>\n\n<p>And am running <code>stack</code> as:</p>\n\n<pre><code>stack build --stack-root=/stack --resolver=lts-8.9\n</code></pre>\n\n<p>However, this has the following problems:</p>\n\n<ul>\n<li>it rebuilds all of the dependencies every time</li>\n<li>it requires <code>--allow-different-users</code>, as it seems to be re-using my local <code>.stack-work</code>, which seems less than ideal</li>\n</ul>\n\n<p>I also haven't figured out whether it will break native stack builds, or things like intero.</p>\n"}, {"tags": ["haskell", "syntax", "do-notation"], "comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1492318703, "post_id": 43433781, "comment_id": 73925317, "body": "Your last example doesn&#39;t type check. <code>(#(getLine) ++ #(getLine)) :: IO String</code> and is incompatible with <code>putStrLn :: String -&gt; IO ()</code>."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1492318823, "post_id": 43433781, "comment_id": 73925344, "body": "Unless <code>#</code> has higher precedence than parenthesis!"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1492318825, "post_id": 43433781, "comment_id": 73925345, "body": "@Cirdec how so? It desugars to <code>do { x &lt;- getLine; return (do { x&#39; &lt;- getLine; return (putStrLn (x ++ x&#39;)) }) }</code>, which typechecks fine."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1492318900, "post_id": 43433781, "comment_id": 73925356, "body": "@Cirdec it does; I was thinking more like <code>#</code> has precedence over everything, basically giving a left-to-right sequential read direction to a block, emulating how procedural languages work."}, {"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1492319283, "post_id": 43433781, "comment_id": 73925437, "body": "How would you sugar nested do notation like <a href=\"https://gist.github.com/Cedev/b55e8bba2d6a33f5023385addbf51c3e\" rel=\"nofollow noreferrer\">this</a>?"}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1492319408, "post_id": 43433781, "comment_id": 73925456, "body": "@Cirdec replied there how I think it would look"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1492320351, "post_id": 43433781, "comment_id": 73925623, "body": "Tangential note: the sugar-free version of your last example is <code>putStrLn =&lt;&lt; (++) &lt;$&gt; getLine &lt;*&gt; getLine</code>, which makes me think you might find <a href=\"https://personal.cis.strath.ac.uk/conor.mcbride/pub/she/idiom.html\" rel=\"nofollow noreferrer\">idiom brackets</a> interesting."}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1492323844, "post_id": 43433781, "comment_id": 73926271, "body": "Or <code>liftA2 (++) getLine getLine</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1679, "user_id": 1722752, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef35ad86b627ba3176b6aea8a184f51c?s=128&d=identicon&r=PG", "display_name": "MigMit", "link": "https://stackoverflow.com/users/1722752/migmit"}, "is_accepted": false, "score": 2, "last_activity_date": 1492320374, "creation_date": 1492320374, "answer_id": 43434023, "question_id": 43433781, "link": "https://stackoverflow.com/questions/43433781/is-this-syntax-as-expressive-as-the-do-notation/43434023#43434023", "title": "Is this syntax as expressive as the do-notation?", "body": "<p>How about this:</p>\n\n<pre><code>do a &lt;- something\n   b &lt;- somethingElse a\n   somethingFinal a b\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "edited": false, "score": 1, "creation_date": 1492400458, "post_id": 43434348, "comment_id": 73946017, "body": "Every <code>do</code> block that doesn&#39;t end in <code>return</code> can be trivially rewritten to a <code>do</code> block that does end in <code>return</code> that is equivalent if the monad laws hold. (Though it may lead to stack overflows as things cease to be tail calls.)"}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1492413718, "post_id": 43434348, "comment_id": 73949948, "body": "You are right, this isn&#39;t sufficient. I&#39;ve updated the answer."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1499021860, "post_id": 43434348, "comment_id": 76726728, "body": "@AlexeyRomanov what happens if we write something like <code>let y = 42 in f !(g (\\k -&gt; !(print y)) !x)</code> in Idris? Notice the lambda. That is nonsense to me."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1499022483, "post_id": 43434348, "comment_id": 76726941, "body": "If it isn&#39;t clear what <code>!</code> does in some case, well, you don&#39;t have to use it. (If I understand correctly, since <code>print y</code> doesn&#39;t depend on <code>k</code>, it would be pulled out of the lambda.)"}], "tags": [], "owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "is_accepted": true, "score": 11, "last_activity_date": 1492413655, "last_edit_date": 1592644375, "creation_date": 1492323454, "answer_id": 43434348, "question_id": 43433781, "link": "https://stackoverflow.com/questions/43433781/is-this-syntax-as-expressive-as-the-do-notation/43434348#43434348", "title": "Is this syntax as expressive as the do-notation?", "body": "<p><code>putStrLn</code> is already <code>String -&gt; IO ()</code>, so your desugaring <code>... return (... return (putStrLn (a ++ b)))</code> ends up having type <code>IO (IO (IO ()))</code>, which is likely not what you wanted: running this program won't print anything!</p>\n<p><s>Speaking more generally, your notation can't express any <code>do</code>-block which doesn't end in <code>return</code>.</s> [See Derek Elkins' comment.]</p>\n<p>I don't believe your notation can express <code>join</code>, which can be expressed with <code>do</code> without any additional functions:</p>\n<pre><code>join :: Monad m =&gt; m (m a) -&gt; m a\njoin mx = do { x &lt;- mx; x }\n</code></pre>\n<p>However, you can express <code>fmap</code> constrained to <code>Monad</code>:</p>\n<pre><code>fmap' :: Monad m =&gt; (a -&gt; b) -&gt; m a -&gt; m b\nfmap' f mx = f #mx\n</code></pre>\n<p>and <code>&gt;&gt;=</code> (and thus everything else) can be expressed using <code>fmap'</code> and <code>join</code>. So adding <code>join</code> would make your notation complete, but still not convenient in many cases, because you end up needing a <em>lot</em> of <code>join</code>s.</p>\n<p>However, if you drop <code>return</code> from the translation, you get something quite similar to <a href=\"http://docs.idris-lang.org/en/latest/tutorial/interfaces.html#monads-and-do-notation\" rel=\"noreferrer\">Idris' bang notation</a>:</p>\n<blockquote>\n<p>In many cases, using do-notation can make programs unnecessarily verbose, particularly in cases such as <code>m_add</code> above where the value bound is used once, immediately. In these cases, we can use a shorthand version, as follows:</p>\n<pre><code>m_add : Maybe Int -&gt; Maybe Int -&gt; Maybe Int\nm_add x y = pure (!x + !y)\n</code></pre>\n<p>The notation <code>!expr</code> means that the expression <code>expr</code> should be evaluated and then implicitly bound. Conceptually, we can think of <code>!</code> as being a prefix function with the following type:</p>\n<pre><code>(!) : m a -&gt; a\n</code></pre>\n<p>Note, however, that it is not really a function, merely syntax! In practice, a subexpression <code>!expr</code> will lift <code>expr</code> as high as possible within its current scope, bind it to a fresh name <code>x</code>, and replace <code>!expr</code> with <code>x</code>. Expressions are lifted depth first, left to right. In practice, !-notation allows us to program in a more direct style, while still giving a notational clue as to which expressions are monadic.</p>\n<p>For example, the expression:</p>\n<pre><code>let y = 42 in f !(g !(print y) !x)\n</code></pre>\n<p>is lifted to:</p>\n<pre><code>let y = 42 in do y' &lt;- print y\n                 x' &lt;- x\n                 g' &lt;- g y' x'\n                 f g'\n</code></pre>\n</blockquote>\n<p>Adding it to GHC was discussed, but rejected (so far). Unfortunately, I can't find the threads discussing it.</p>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 43434348, "answer_count": 2, "score": 4, "last_activity_date": 1492413655, "creation_date": 1492317758, "last_edit_date": 1492318100, "question_id": 43433781, "link": "https://stackoverflow.com/questions/43433781/is-this-syntax-as-expressive-as-the-do-notation", "title": "Is this syntax as expressive as the do-notation?", "body": "<p>The <code>do</code> notation allows us to express monadic code without overwhelming nestings, so that</p>\n\n<pre><code>main = getLine &gt;&gt;= \\ a -&gt; \n       getLine &gt;&gt;= \\ b -&gt;\n       putStrLn (a ++ b)\n</code></pre>\n\n<p>can be expressed as</p>\n\n<pre><code>main = do\n  a &lt;- getLine\n  b &lt;- getLine\n  putStrLn (a ++ b)\n</code></pre>\n\n<p>Suppose, though, the syntax allows <code>... #expression ...</code> to stand for <code>do { x &lt;- expression; return (... x ...) }</code>. For example, <code>foo = f a #(b 1) c</code> would be desugared as: <code>foo = do { x &lt;- b 1; return (f a x c) }</code>. The code above could, then, be expressed as:</p>\n\n<pre><code>main = let a = #getLine in\n       let b = #getLine in\n       putStrLn (a ++ b)\n</code></pre>\n\n<p>Which would be desugared as:</p>\n\n<pre><code>main = do\n  x &lt;- getLine\n  let a = x in\n    return (do\n      x' &lt;- getLine\n      let b = x' in\n        return (putStrLn (a ++ b)))\n</code></pre>\n\n<p>That is equivalent. This syntax is appealing to me because it seems to offer the same functionality as the do-notation, while also allowing some shorter expressions such as:</p>\n\n<pre><code>main = putStrLn (#(getLine) ++ #(getLine))\n</code></pre>\n\n<p>So, I wonder if there is anything defective with this proposed syntax, or if it is indeed complete and equivalent to the do-notation.</p>\n"}, {"tags": ["haskell", "ghci", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "edited": false, "score": 0, "creation_date": 1492317942, "post_id": 43433762, "comment_id": 73925183, "body": "Using <code>:load PrimeTools.Base</code> brings in definitions that are not exported. This has always been my experience, having used <code>:load</code> with several other modules in the past."}, {"owner": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "edited": false, "score": 0, "creation_date": 1492318190, "post_id": 43433762, "comment_id": 73925225, "body": "The link you provided says this: &quot;:load Main.hs ... Everything that is in scope at the top-level in the module Main we just loaded is also in scope at the prompt&quot;, and like Myridium that is indeed also my experience."}, {"owner": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "edited": false, "score": 0, "creation_date": 1492318229, "post_id": 43433762, "comment_id": 73925235, "body": "Also, when I run <code>stack ghci --no-load</code>, I&#39;m unable to import the package. I&#39;m told it&#39;s hidden: <code>It is a member of the hidden package \u2018prime-tools-0.1.2.0@prime_EA4ezNOr21Z4zu3ZQR52et\u2019.</code>"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "edited": false, "score": 0, "creation_date": 1492318493, "post_id": 43433762, "comment_id": 73925281, "body": "@jlmg and Myridium -- Seems I mixed up the multiple uses and meanings of <code>*</code> in this context; I have removed that final paragraph until I figure out how to phrase that better. Note that part of the reason I wrote that is that, in spite of the other issues, you do want have the modules loaded, as otherwise they won&#39;t be found, leading to the issue Myridium describes in the other comment."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "edited": false, "score": 0, "creation_date": 1492318606, "post_id": 43433762, "comment_id": 73925297, "body": "@Myridium Before importing, you need to load the source file with e.g. <code>:load src&#47;PrimeTools&#47;MathStuff.hs</code>. Between this and my other misunderstanding, that defeats the point of <code>--no-load</code> for your purposes, so I have removed that paragraph as well."}, {"owner": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "edited": false, "score": 0, "creation_date": 1492318765, "post_id": 43433762, "comment_id": 73925331, "body": "@duplode - Running <code>:load .&#47;src&#47;PrimeTools&#47;Base</code> or <code>:load PrimeTools.Base</code> loads the methods that are not exported, too. That&#39;s why I don&#39;t want to load the modules. As far as I&#39;ve experienced, <i>loading</i> a module always includes importing <i>all</i> definitions, even those that are not exported, whereas <b>importing</b> only takes in those that are exported."}, {"owner": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "edited": false, "score": 0, "creation_date": 1492318841, "post_id": 43433762, "comment_id": 73925348, "body": "After a quick test, running <code>:module PrimeTools.Base</code> seems to take in only those definitions which are exported."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "edited": false, "score": 0, "creation_date": 1492318980, "post_id": 43433762, "comment_id": 73925376, "body": "@Myridium On <code>:load .&#47;src&#47;PrimeTools&#47;Base</code>: indeed -- that&#39;s what I meant with my previous comment, once I realised I mixed things up with respect to <code>:load</code>. As for <code>:module PrimeTools.Base</code>, it is indeed equivalent to <code>import PrimeTools.Base</code> (as opposed to <code>:module *PrimeTools.Base</code>, which will do what you don&#39;t want)."}, {"owner": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "edited": false, "score": 0, "creation_date": 1492319198, "post_id": 43433762, "comment_id": 73925421, "body": "Okay. Though this solution does help remove some of the tedium, I don&#39;t like the hard-coded strings for the module names. Is there some way to have it automatically read the <code>.cabal</code> file for modules to unload and reimport?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "edited": false, "score": 2, "creation_date": 1492319814, "post_id": 43433762, "comment_id": 73925526, "body": "@Myridium Since the command definition is arbitrary Haskell, in principle it should be possible to parse the .cabal file and extract the module names, even using the Cabal library to do so (cf. <a href=\"http://stackoverflow.com/q/22785670/2751851\">this question</a>) as long as you import it at the beginning of the <code>.ghci</code> file. (I only say &quot;in principle&quot; because I haven&#39;t tried it yet.)"}, {"owner": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "edited": false, "score": 0, "creation_date": 1492320065, "post_id": 43433762, "comment_id": 73925563, "body": "Alright, that&#39;s too much trouble for me to worry about. It seems odd to me that <code>stack ghci</code> doesn&#39;t already behave the way I would expect, so I thought there might be some simple way to do this with <code>stack</code> flags or something."}, {"owner": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "reply_to_user": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "edited": false, "score": 0, "creation_date": 1492322299, "post_id": 43433762, "comment_id": 73925992, "body": "@Myridium Actually, I think it makes more sense the way it currently works. For most cases, there is no point in restricting what the developer should see. Putting everything in scope ensures the developer can get right to work without having to bring things into scope. Your problem right now was because you had a naming conflict between what&#39;s exported and what&#39;s not, but that could&#39;ve just as easily happened between the exports of different modules. Anyway, it&#39;s often quicker to type qualified names to avoid ambiguities than to bring multiple things into scope on your own."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 3, "last_activity_date": 1492318646, "last_edit_date": 1495541859, "creation_date": 1492317595, "answer_id": 43433762, "question_id": 43433164, "link": "https://stackoverflow.com/questions/43433164/how-to-import-rather-than-load-modules-on-startup-with-stack-ghci/43433762#43433762", "title": "How to import rather than load modules on startup with &#39;stack ghci&#39;?", "body": "<p>A reasonable workaround is defining <a href=\"https://downloads.haskell.org/~ghc/8.0.1/docs/html/users_guide/ghci.html#ghci-cmd-:def\" rel=\"nofollow noreferrer\">a custom GHCi macro</a> for importing your modules the way you want it. Create a <code>.ghci</code> file in your project root along these lines:</p>\n\n<pre><code>:{\n:def deload (\\_ -&gt; return \n    \":module -PrimeTools.MathStuff\\n\\\n    \\import PrimeTools.MathStuff\"\n    )\n:}\n</code></pre>\n\n<p>With this, the <code>:deload</code> command in GHCi  will remove from scope and then re-import <code>PrimeTools.MathStuff</code> -- you can add as many modules as you want to the list. Though I have written this using <a href=\"https://stackoverflow.com/q/22918837/2751851\">multiline string syntax</a>, you can have any <code>String -&gt; IO String</code> expression within the parentheses, so feel free to spell or extend it however you see fit.</p>\n"}], "owner": {"reputation": 398, "user_id": 1351182, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/a19ea4f2204cb5ccc2745fcdf8cda84c?s=128&d=identicon&r=PG", "display_name": "Myridium", "link": "https://stackoverflow.com/users/1351182/myridium"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 540, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1492318646, "creation_date": 1492310074, "last_edit_date": 1492317722, "question_id": 43433164, "link": "https://stackoverflow.com/questions/43433164/how-to-import-rather-than-load-modules-on-startup-with-stack-ghci", "title": "How to import rather than load modules on startup with &#39;stack ghci&#39;?", "body": "<p>I have a haskell package called <code>prime-tools</code>. When I use <code>stack ghci</code> inside the package directory, I expect it to open up an interactive <code>ghci</code> and automatically <code>import prime-tools</code>. Instead, I find that it <strong>loads all of the modules</strong> declared in the .cabal file.</p>\n\n<p>For example, here is the extract from my .cabal file showing which modules are declared:</p>\n\n<pre><code>library\n  -- Modules exported by the library.\n  exposed-modules:     PrimeTools.MathStuff, PrimeTools.Factors, PrimeTools.PQTrials, PrimeTools.Main, PrimeTools.Base, PrimeTools.Lucas\n\n  -- Modules included in this library but not exported.\n  other-modules:       PrimeTools.Extras\n</code></pre>\n\n<p>And this is what happens as I receive the <code>ghci&gt;</code> prompt after running <code>stack ghci</code> in the project folder:</p>\n\n<pre><code>Ok, modules loaded: PrimeTools.MathStuff, PrimeTools.Factors, PrimeTools.PQTrials, PrimeTools.Main, PrimeTools.Base, PrimeTools.Lucas, PrimeTools.Extras.\nghci&gt; \n</code></pre>\n\n<p>The problem with <em>loading the modules</em> instead of <code>import prime-tools</code> is that I can now use all functions defined in all modules <strong>whether or not they are exported</strong>. </p>\n\n<p>An example of the issues arising from this distinction: there are two modules in package <code>prime-tools</code> which have implementations of a function called <code>pfactor</code>. One of them is exported, and intended to be used by the end user of the package, while the other is for internal use only and not exported. </p>\n\n<p><em>Before someone comments, there is good reason to have two implementations of <code>pfactor</code>, but it's not relevant to my question.</em></p>\n\n<hr>\n\n<p>My question: how can I use <code>stack</code> to automatically start up a <code>ghci</code> environment with the local version of <code>ghc</code> and <strong>import</strong> the package whose folder I run the command in?</p>\n\n<p>My desired behaviour would be equivalent to running the following sequence of commands:</p>\n\n<pre><code>stack ghci\nghci&gt; :module -PrimeTools.MathStuff\nghci&gt; :module -PrimeTools.Factors\nghci&gt; :module -PrimeTools.PQTrials\nghci&gt; :module -PrimeTools.Main\nghci&gt; :module -PrimeTools.Base\nghci&gt; :module -PrimeTools.Lucas\nghci&gt; :module -PrimeTools.Extras\nghci&gt; import PrimeTools.MathStuff\nghci&gt; import PrimeTools.Factors\nghci&gt; import PrimeTools.PQTrials\nghci&gt; import PrimeTools.Main\nghci&gt; import PrimeTools.Base\nghci&gt; import PrimeTools.Lucas\n</code></pre>\n\n<p>The key here is that I want to import the <em>exposed-modules</em> declared in the .cabal file and <strong>not to <em>load</em> any modules</strong>. I don't mind if the <em>other-modules</em> are also imported, though. Is there a way I can do this using <code>stack</code> without having to run this long sequence of commands every time?</p>\n"}, {"tags": ["haskell", "operator-precedence"], "answers": [{"comments": [{"owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "edited": false, "score": 0, "creation_date": 1492296693, "post_id": 43431911, "comment_id": 73921868, "body": "I incur from this that infix operators with more than 2 arguments always need some special attention?"}, {"owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "edited": false, "score": 0, "creation_date": 1492299032, "post_id": 43431911, "comment_id": 73922267, "body": "Nitpick: I think you mean &quot;infer&quot;."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "edited": false, "score": 1, "creation_date": 1492326872, "post_id": 43431911, "comment_id": 73926842, "body": "@hgiesel I believe functions with more than two arguments are usually applied in prefix notation, only."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1492326899, "last_edit_date": 1492326899, "creation_date": 1492295429, "answer_id": 43431911, "question_id": 43431853, "link": "https://stackoverflow.com/questions/43431853/weird-behavior-for-infix-functions-regarding-precedence/43431911#43431911", "title": "Weird behavior for infix functions regarding precedence", "body": "<p>Infix operators bind loosely, applications bind tightly.</p>\n\n<pre><code>(-1) `bool` 1 True\n-- means\n(-1) `bool` (1 True)\n\n\n(-1) `bool` 1 $ True\n-- means\n((-1) `bool` 1) $ True\n\n\n(-1) `bool` 1 (True)\n-- means\n(-1) `bool` (1 (True))\n</code></pre>\n\n<p>You might want:</p>\n\n<pre><code>((-1) `bool` 1) True\n</code></pre>\n"}], "owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 43431911, "answer_count": 1, "score": 3, "last_activity_date": 1492326899, "creation_date": 1492294992, "last_edit_date": 1492295872, "question_id": 43431853, "link": "https://stackoverflow.com/questions/43431853/weird-behavior-for-infix-functions-regarding-precedence", "title": "Weird behavior for infix functions regarding precedence", "body": "<p>I am using the <code>bool :: a -&gt; a -&gt; Bool -&gt; a</code> function.\nI wanted to use the infix version, because I though it more readable, but I noticed that:</p>\n\n<pre><code>(-1) `bool` 1 True\n</code></pre>\n\n<p>is an error</p>\n\n<pre><code>(-1) `bool` 1 $ True\n</code></pre>\n\n<p>works. Even</p>\n\n<pre><code>(-1) `bool` 1 (True)\n</code></pre>\n\n<p>doesn't work, which I thought was an equal alternative until now (i.e. using <code>$</code> versus wrapping in parentheses from this location till the end)</p>\n\n<p>How can this even make a difference? In the first version there is only one single operation.  </p>\n"}, {"tags": ["haskell", "arrows", "category-abstractions"], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 7, "last_activity_date": 1492337568, "last_edit_date": 1492337568, "creation_date": 1492294848, "answer_id": 43431843, "question_id": 43431564, "link": "https://stackoverflow.com/questions/43431564/fmapping-arrows-over-monads/43431843#43431843", "title": "fmapping arrows over monads", "body": "<p><code>Arrow</code> combines two concepts. One of them, as you say, is that of a profunctor, but first of all it's just a specific class of <em>categories</em> (as indeed the superclass evidences).</p>\n\n<p>That's highly relevant for this question: yes, the signature of <code>fmap</code> is <code>(a -&gt; b) -&gt; f a -&gt; f b</code>, but actually that is not nearly the full generality of what a functor can do! In maths, a functor is a mapping between two categories <em>C</em> and <em>D</em>, that assigns each arrow in <em>C</em> to an arrow in <em>D</em>. Arrows in different categories, that is! The standard <code>Functor</code> class merely captures the simplest special case, that of endofunctors in the <strong>Hask</strong> category.</p>\n\n<p>The full general version of the functor class actually looks more like this (here my version <a href=\"http://hackage.haskell.org/package/constrained-categories-0.3.0.1/docs/Control-Functor-Constrained.html\" rel=\"nofollow noreferrer\">from constrained-categories</a>):</p>\n\n<pre><code>class (Category r, Category t) =&gt; Functor f r t | f r -&gt; t, f t -&gt; r where\n  fmap :: r a b -&gt; t (f a) (f b)\n</code></pre>\n\n<p>Or, in pseudo-syntax,</p>\n\n<pre><code>class (Category (\u2500\u2500&gt;), Category (~&gt;)) =&gt; Functor f (\u2500\u2500&gt;) (~&gt;) where\n  fmap :: (a \u2500\u2500&gt; b) -&gt; f a ~&gt; f b\n</code></pre>\n\n<p>This can sure enough also work when one of the categories is a proper arrow rather than an ordinary function category. For instance, you could define</p>\n\n<pre><code>instance Functor Maybe (Kleisli [] (-&gt;)) (Kleisli [] (-&gt;)) where\n  fmap (Kleisli f) = Kleisli mf\n   where mf Nothing = [Nothing]\n         mf (Just a) = Just &lt;$&gt; f a\n</code></pre>\n\n<p>to be used like</p>\n\n<pre><code>&gt; runKleisli (fmap . Kleisli $ \\i -&gt; [0..i]) $ Nothing\n[Nothing]\n&gt; runKleisli (fmap . Kleisli $ \\i -&gt; [0..i]) $ Just 4\n[Just 0,Just 1,Just 2,Just 3,Just 4]\n</code></pre>\n\n<p>Not sure whether this would be useful for anything nontrivial, if using the standard profunctor-ish arrows. It is definitely useful in other categories which are <em>not</em> <strong>Hask</strong>-profunctors, <a href=\"http://hackage.haskell.org/package/linearmap-category-0.3.2.0/docs/Math-LinearMap-Category.html#g:5\" rel=\"nofollow noreferrer\">for instance</a></p>\n\n<pre><code>instance (TensorSpace v) =&gt; Functor (Tensor s v) (LinearFunction s) (LinearFunction s)\n</code></pre>\n\n<p>expressing that you can map a linear function over a single factor of a tensor product (whereas it's generally not possible to map a nonlinear function over such a product \u2013 the result would depend on a choice of basis on the vector space).</p>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 4, "last_activity_date": 1492301210, "last_edit_date": 1495541402, "creation_date": 1492301210, "answer_id": 43432429, "question_id": 43431564, "link": "https://stackoverflow.com/questions/43431564/fmapping-arrows-over-monads/43432429#43432429", "title": "fmapping arrows over monads", "body": "<blockquote>\n  <p>I am looking for a way to, for example, transform a <code>Maybe</code> input with an arrow, where <code>Nothing</code> goes to <code>Nothing</code> and <code>Just x</code> goes to <code>Just y</code> where <code>y</code> is the result of applying the Arrow to <code>x</code>.</p>\n</blockquote>\n\n<p>This can be implemented for specific <code>Functor</code>s (such as <code>Maybe</code>), though <code>ArrowChoice</code> will likely be necessary:</p>\n\n<pre><code>maybeAmap :: ArrowChoice p =&gt; p a b -&gt; p (Maybe a) (Maybe b)\nmaybeAmap p =\n    maybe (Left ()) Right\n    ^&gt;&gt; returnA +++ p\n    &gt;&gt;^ const Nothing ||| Just\n</code></pre>\n\n<p>See <a href=\"https://stackoverflow.com/q/11303642/2751851\"><em>Arrow equivalent of mapM?</em></a> for a similar function written in proc-notation.</p>\n\n<p>Speaking of <code>mapM</code>, <em>profunctors</em> has <a href=\"https://hackage.haskell.org/package/profunctors-5.2/docs/Data-Profunctor-Traversing.html\" rel=\"nofollow noreferrer\">an interesting class called <code>Traversing</code></a>:</p>\n\n<pre><code>-- Abbreviated class definition:\nclass (Choice p, Strong p) =&gt; Traversing p where\n  traverse' :: Traversable f =&gt; p a b -&gt; p (f a) (f b)\n  wander :: (forall f. Applicative f =&gt; (a -&gt; f b) -&gt; s -&gt; f t) -&gt; p a b -&gt; p s t\n</code></pre>\n\n<p>The flag-bearer instance of <code>Traversing</code> is the one for the <a href=\"https://hackage.haskell.org/package/profunctors-5.2/docs/Data-Profunctor-Types.html#t:Star\" rel=\"nofollow noreferrer\"><code>Star</code> profunctor</a>, which provides an alternative encoding of the familiar <code>traverse</code> function. Note that, while <a href=\"https://stackoverflow.com/a/43431843/2751851\">leftaroundabout's answer</a> demonstrates a non-<strong>Hask</strong> functor for categories which are not necessarily <strong>Hask</strong>-profunctors, with <code>Traversing</code> we have a construction for <code>Profunctor</code>s that do not necessarily have a <code>Category</code> instance.</p>\n"}], "owner": {"reputation": 3185, "user_id": 114887, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/6b0c7e3c2d9ff81adf7470e066e4a705?s=128&d=identicon&r=PG&f=1", "display_name": "Matthew Piziak", "link": "https://stackoverflow.com/users/114887/matthew-piziak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 1, "answer_count": 2, "score": 5, "last_activity_date": 1559483902, "creation_date": 1492292578, "last_edit_date": 1559483902, "question_id": 43431564, "link": "https://stackoverflow.com/questions/43431564/fmapping-arrows-over-monads", "title": "fmapping arrows over monads", "body": "<p>I understand that an Arrow is a Profunctor, where one can transform its input and its output, but can one map an arrow <em>over</em> a Functor?</p>\n\n<p>I understand that as-asked the answer is \"no\", since the <code>fmap</code> function type signature is <code>(a -&gt; b) -&gt; f a -&gt; f b</code> and does not admit <code>Arrow a b</code>, but I hope what I'm asking is clear.</p>\n\n<p>I am looking for a way to, for example, transform a <code>Maybe</code> input with an Arrow, where <code>Nothing</code> goes to <code>Nothing</code> and <code>Just x</code> goes to <code>Just y</code> where <code>y</code> is the result of applying the Arrow to <code>x</code>.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 420, "user_id": 5610398, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/1666359996977941/picture?type=large", "display_name": "Bao Thai", "link": "https://stackoverflow.com/users/5610398/bao-thai"}, "edited": false, "score": 0, "creation_date": 1492289047, "post_id": 43431073, "comment_id": 73919940, "body": "How would I go about to test my functionality? Using Cons considering it is the data constructor? would I also derive the Show, Eq, Ord?"}, {"owner": {"reputation": 179940, "user_id": 20713, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09b9758a4a83cc25547eb93891f19df7?s=128&d=identicon&r=PG", "display_name": "ephemient", "link": "https://stackoverflow.com/users/20713/ephemient"}, "reply_to_user": {"reputation": 420, "user_id": 5610398, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/1666359996977941/picture?type=large", "display_name": "Bao Thai", "link": "https://stackoverflow.com/users/5610398/bao-thai"}, "edited": false, "score": 0, "creation_date": 1492289468, "post_id": 43431073, "comment_id": 73920038, "body": "@BaoThai You can derive them but those typeclasses aren&#39;t very useful on an infinite stream."}, {"owner": {"reputation": 420, "user_id": 5610398, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/1666359996977941/picture?type=large", "display_name": "Bao Thai", "link": "https://stackoverflow.com/users/5610398/bao-thai"}, "edited": false, "score": 0, "creation_date": 1492292239, "post_id": 43431073, "comment_id": 73920828, "body": "Would I have to derive it as instance Show a =&gt; Show (Stream a -&gt; String) or? @ephemient"}, {"owner": {"reputation": 179940, "user_id": 20713, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09b9758a4a83cc25547eb93891f19df7?s=128&d=identicon&r=PG", "display_name": "ephemient", "link": "https://stackoverflow.com/users/20713/ephemient"}, "reply_to_user": {"reputation": 420, "user_id": 5610398, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/1666359996977941/picture?type=large", "display_name": "Bao Thai", "link": "https://stackoverflow.com/users/5610398/bao-thai"}, "edited": false, "score": 1, "creation_date": 1492292992, "post_id": 43431073, "comment_id": 73921048, "body": "@BaoThai Manually, it would be <code>instance Show a =&gt; Show (Stream a) where show :: Stream a -&gt; String</code>. If you add <code>deriving Show</code> to the original <code>data</code> you&#39;ll get an automatic instance."}], "tags": [], "owner": {"reputation": 179940, "user_id": 20713, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09b9758a4a83cc25547eb93891f19df7?s=128&d=identicon&r=PG", "display_name": "ephemient", "link": "https://stackoverflow.com/users/20713/ephemient"}, "is_accepted": true, "score": 1, "last_activity_date": 1492288827, "creation_date": 1492288827, "answer_id": 43431073, "question_id": 43431048, "link": "https://stackoverflow.com/questions/43431048/error-using-stream-package-data-type/43431073#43431073", "title": "error using stream package/data type", "body": "<pre><code>streamToList :: Stream a -&gt; [a]\nstreamToList (Cons x xs) = x : streamToList xs\n</code></pre>\n\n<p><code>Stream</code> is the name of a type, so it can be used on the right-hand side of <code>::</code>. But it is not a data constructor, so it cannot be used as a value or in pattern matches.</p>\n\n<p><code>Cons</code> is the name of a data constructor, so it can be used as a value or in pattern matches. But it is not a type.</p>\n"}], "owner": {"reputation": 420, "user_id": 5610398, "user_type": "registered", "accept_rate": 93, "profile_image": "https://graph.facebook.com/1666359996977941/picture?type=large", "display_name": "Bao Thai", "link": "https://stackoverflow.com/users/5610398/bao-thai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 1, "accepted_answer_id": 43431073, "answer_count": 1, "score": 1, "last_activity_date": 1492289753, "creation_date": 1492288648, "last_edit_date": 1492289753, "question_id": 43431048, "link": "https://stackoverflow.com/questions/43431048/error-using-stream-package-data-type", "title": "error using stream package/data type", "body": "<p>I have been stuck with a particular situation. I am not sure what the error even is to be honest.</p>\n\n<pre><code>data Stream a = Cons a (Stream a)\nstreamToList :: Stream a -&gt; [a]\nstreamToList (Cons x (Stream xs)) = x: streamToList (Stream xs)\n</code></pre>\n\n<p>Doing something like this, I got <strong>Not in scope : data constructor 'Stream'</strong>, so I googled the error and some solutions were to change stream to a lower case</p>\n\n<pre><code>data Stream a = Cons a (Stream a)\nstreamToList :: Stream a -&gt; [a]\nstreamToList (Cons x xs) = x: streamToList (stream xs)\n</code></pre>\n\n<p>But then I get <strong>Parse error in pattern : stream</strong></p>\n\n<p>I tried importing <strong>Data.Stream</strong> (googled on Hoogle) but <strong>Could not find module 'Data.Stream'</strong></p>\n\n<p>Currently using Haskell from Ubuntu packages</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 420, "user_id": 6496011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5da204ac4ee7e380ab27daa05996a2a?s=128&d=identicon&r=PG&f=1", "display_name": "Antisthenes", "link": "https://stackoverflow.com/users/6496011/antisthenes"}, "edited": false, "score": 1, "creation_date": 1492287519, "post_id": 43430705, "comment_id": 73919520, "body": "It means that &quot;DecV&quot; is not a full-fledged type but is just a Type Synonym (denoted by keyword &#39;type&#39;). You can&#39;t instantiate on type synonyms in vanilla Haskell. The suggestion from compiler to use TypeSynonymInstances language extension will allow you to make type synonyms Instances of type classes."}, {"owner": {"reputation": 420, "user_id": 6496011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5da204ac4ee7e380ab27daa05996a2a?s=128&d=identicon&r=PG&f=1", "display_name": "Antisthenes", "link": "https://stackoverflow.com/users/6496011/antisthenes"}, "edited": false, "score": 1, "creation_date": 1492288080, "post_id": 43430705, "comment_id": 73919663, "body": "However in your code you don&#39;t need to derive instance of Show for DecV as [(a,b)] is instance of show for all types a and b that are instances of Show. Just remove the &quot;deriving&quot; clause for this synonym and it should work. I would also advice to stick the deriving clauses to the corresponding data type definitions, as it would keep all the important for specific types bits of code in one place and would allow you to remove the unnecessary extension in code."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5388697"}, "reply_to_user": {"reputation": 420, "user_id": 6496011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5da204ac4ee7e380ab27daa05996a2a?s=128&d=identicon&r=PG&f=1", "display_name": "Antisthenes", "link": "https://stackoverflow.com/users/6496011/antisthenes"}, "edited": false, "score": 0, "creation_date": 1492288389, "post_id": 43430705, "comment_id": 73919742, "body": "@Antisthenes thanks very much, removing the <code>deriving</code> works but now I have a <code>Couldn&#39;t match type \u2018(Var, Aexp)\u2019 with \u2018Char\u2019</code> error in my <code>pretty (Block decv decp stm) line</code>"}, {"owner": {"reputation": 420, "user_id": 6496011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5da204ac4ee7e380ab27daa05996a2a?s=128&d=identicon&r=PG&f=1", "display_name": "Antisthenes", "link": "https://stackoverflow.com/users/6496011/antisthenes"}, "edited": false, "score": 0, "creation_date": 1492288683, "post_id": 43430705, "comment_id": 73919834, "body": "It&#39;s because [(Var, Aexp)] is not instance of Pretty class. The easiest way to fix this is to replace pretty with show where it&#39;s not applicable, but if you want to have some specific form of output string then you may instantiate these types."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5388697"}, "reply_to_user": {"reputation": 420, "user_id": 6496011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5da204ac4ee7e380ab27daa05996a2a?s=128&d=identicon&r=PG&f=1", "display_name": "Antisthenes", "link": "https://stackoverflow.com/users/6496011/antisthenes"}, "edited": false, "score": 0, "creation_date": 1492329146, "post_id": 43430705, "comment_id": 73927382, "body": "@Antisthenes Ive replaced pretty with show but now get overlapping instances error"}, {"owner": {"reputation": 420, "user_id": 6496011, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5da204ac4ee7e380ab27daa05996a2a?s=128&d=identicon&r=PG&f=1", "display_name": "Antisthenes", "link": "https://stackoverflow.com/users/6496011/antisthenes"}, "edited": false, "score": 1, "creation_date": 1492332277, "post_id": 43430705, "comment_id": 73928057, "body": "When i wrote about removing deriving i meant removing all these instances as they aren&#39;t necessary and it would help you avoid &quot;type synonym instances&quot; extension. There are overlapping instances because, as i&#39;ve written already in previus comments, list of tuples of two types that are instances of Show is already instance of Show. Besides if you would want to have instance of class without defining method you would have to  derive it."}], "answers": [{"tags": [], "owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "is_accepted": true, "score": 1, "last_activity_date": 1492371155, "creation_date": 1492371155, "answer_id": 43441250, "question_id": 43430705, "link": "https://stackoverflow.com/questions/43430705/illegal-instance-declaration-for-show-decv/43441250#43441250", "title": "Illegal instance declaration for \u2018Show DecV\u2019", "body": "<p>When you have a type synonym</p>\n\n<pre><code>type Foo = [Int]\n</code></pre>\n\n<p><code>Int</code> and <code>[Int]</code> are both instances of <code>Show</code> already. So when you say</p>\n\n<pre><code>instance Show Foo\n</code></pre>\n\n<p>you create a new instance of <code>Show</code> for the <code>[Int]</code>. So now when you have</p>\n\n<pre><code>x :: Foo\nshow x\n</code></pre>\n\n<p>the poor compiler doesn't know which version of <code>show</code> to call. So it complains. This is an \"overlapping instance\" because the two instances cover at least some of the same types.</p>\n\n<p>Remove the instances for your type synonyms, but leave them for your <code>data</code> types.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5388697"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 0, "accepted_answer_id": 43441250, "answer_count": 1, "score": 1, "last_activity_date": 1492371155, "creation_date": 1492286668, "last_edit_date": 1492289800, "question_id": 43430705, "link": "https://stackoverflow.com/questions/43430705/illegal-instance-declaration-for-show-decv", "title": "Illegal instance declaration for \u2018Show DecV\u2019", "body": "<p>I'm trying to write a Parser for an extension of the While Language, called Proc, that takes input such as <code>x:=1</code> and returns <code>Ass \"x\" (N 1)</code>. My code so far is below:</p>\n\n<pre><code>{-# LANGUAGE StandaloneDeriving #-}\nmodule Attempt where\nimport Text.Megaparsec\nimport Text.Megaparsec.String\nimport Data.List (intercalate)\nimport Prelude hiding (Num)\nimport qualified Prelude (Num)\nimport System.IO\nimport Control.Monad\n\n-- S ::= x:=a\n--    | skip\n--    | S1 ; S2\n--    | if b then S1 else S2\n--    | while b do S\n--    | begin Dv Dv S end\n--    | call p\n-- Dv ::= var x := a ; DV | \u03b5\n-- Dp ::= proc p is S ; DP | \u03b5\n\ntype Num   = Integer\ntype Var   = String\ntype Pname = String\ntype DecV  = [(Var,Aexp)]\ntype DecP  = [(Pname,Stm)]\n\n--Parser\n\n--A few preliminaries that import modules and language features before\n--the full parser is defined.\n\ncr :: Parser [Char]\ncr = many (oneOf \"\\r\\n\")\n\ntok :: String -&gt; Parser String\ntok t = string t &lt;* whitespace\n\nwhitespace :: Parser ()\nwhitespace = many (oneOf \" \\t\") *&gt; pure ()\n\n--Now each of the production rules in the grammar will be considered and\n--translated into a corresponding datatype and parser.\n\n-- a ::= | n | x | a1 + a2 | a1 * a2 | a1 - a2\n\ndata Aexp = N Num\n          | V Var\n          | Mult Aexp Aexp\n          | Add Aexp Aexp\n          | Sub Aexp Aexp\n\naexp :: Parser Aexp\naexp =  N     &lt;$&gt; num\n    &lt;|&gt; V     &lt;$&gt; var\n    &lt;|&gt; Mult  &lt;$&gt; aexp &lt;* tok \"*\" &lt;*&gt; aexp\n    &lt;|&gt; Add   &lt;$&gt; aexp &lt;* tok \"+\" &lt;*&gt; aexp\n    &lt;|&gt; Sub   &lt;$&gt; aexp &lt;* tok \"-\" &lt;*&gt; aexp\n\n-- b ::= true | false | a1 = a2 | a1 =&lt; a2 | !b | b1 &amp; b2\n\ndata Bexp = TRUE\n          | FALSE\n          | Neg Bexp\n          | And Bexp Bexp\n          | Le Aexp Aexp\n          | Eq Aexp Aexp\n\nbexp :: Parser Bexp\nbexp = TRUE   &lt;$ tok \"TRUE\"\n   &lt;|&gt; FALSE  &lt;$ tok \"FALSE\"\n   &lt;|&gt; Neg    &lt;$ tok \"!\" &lt;*&gt; bexp\n   &lt;|&gt; And    &lt;$&gt; bexp &lt;* tok \"&amp;\" &lt;*&gt; bexp\n   &lt;|&gt; Le     &lt;$&gt; aexp &lt;* tok \"=&lt;\" &lt;*&gt; aexp\n   &lt;|&gt; Eq     &lt;$&gt; aexp &lt;* tok \"=\" &lt;*&gt; aexp\n\n-- S ::= x:=a\n--    | skip\n--    | S1 ; S2\n--    | if b then S1 else S2\n--    | while b do S\n--    | begin Dv Dp S end\n--    | call p\n\ndata Stm = Skip\n          | Ass Var Aexp\n          | Comp Stm Stm\n          | If Bexp Stm Stm\n          | While Bexp Stm\n          | Block DecV DecP Stm\n          | Call Pname\n\nstm :: Parser Stm\nstm = Skip    &lt;$ tok \"Skip\"\n  &lt;|&gt; Ass     &lt;$ tok \"Ass\" &lt;*&gt; var &lt;* tok \":=\" &lt;*&gt; aexp\n  &lt;|&gt; Comp    &lt;$ tok \"Comp\" &lt;*&gt; stm &lt;* tok \";\" &lt;*&gt; stm\n  &lt;|&gt; If      &lt;$ tok \"If\" &lt;*&gt; bexp &lt;* tok \"then\" &lt;*&gt; stm &lt;* tok \"else\" &lt;*&gt; stm\n  &lt;|&gt; While   &lt;$ tok \"While\" &lt;*&gt; bexp &lt;* tok \"do\" &lt;*&gt; stm\n  &lt;|&gt; Block   &lt;$ tok \"Block\" &lt;* tok \"begin\" &lt;*&gt; decv &lt;*&gt; decp &lt;*&gt; stm &lt;* tok \"end\"\n  &lt;|&gt; Call    &lt;$ tok \"Call\" &lt;*&gt; pname\n\n-- Dv ::= var x := a ; DV | \u03b5\n\ndecv :: Parser DecV\ndecv = many ((,) &lt;$&gt; var &lt;* tok \":=\" &lt;*&gt; aexp &lt;* tok \";\")\n\n-- Dp ::= proc p is S ; DP | \u03b5\n\ndecp :: Parser DecP\ndecp = many ((,) &lt;$&gt; pname &lt;* tok \"is\" &lt;*&gt; stm &lt;* tok \";\")\n\nnum :: Parser Num\nnum = (some (oneOf ['0' .. '9']) &gt;&gt;= return . read) &lt;* whitespace\n\nvar :: Parser Var\nvar = (some (oneOf ['A' .. 'Z'])) &lt;* whitespace\n\npname :: Parser Pname\npname = tok \"\\\"\" *&gt; some (noneOf (\"\\n\\r\\\"\")) &lt;* tok \"\\\"\"\n\nwhileParser :: Parser Stm\nwhileParser = whitespace &gt;&gt; stm\n\nparseFile :: FilePath -&gt; IO ()\nparseFile filePath = do\n  file &lt;- readFile filePath\n  putStrLn $ case parse whileParser filePath file of\n    Left err          -&gt; parseErrorPretty err\n    Right whileParser -&gt; pretty whileParser\n\n\n--Pretty Printing\n---------------\n\n--The instances below allow values to be inspected in the terminal.\n--The default instance that is derived shows all the constructor names.\n\nderiving instance Show Aexp\nderiving instance Show Bexp\nderiving instance Show Stm\nderiving instance Show DecV\n\n--The pretty-printed output gives a version that should be acceptable\n--Proc.\n\nclass Pretty a where\n  pretty :: a -&gt; String\n\ninstance Pretty Aexp where\n  pretty (N num)            = show num\n  pretty (V var)            = show var\n  pretty (Mult aexp1 aexp2) = \"Mult \" ++ pretty aexp1 ++ \" \" ++ pretty aexp2\n  pretty (Add aexp1 aexp2)  = \"Add \" ++ pretty aexp1 ++ \" \" ++ pretty aexp2\n  pretty (Sub aexp1 aexp2)  = \"Sub \" ++ pretty aexp1 ++ \" \" ++ pretty aexp2\n\ninstance Pretty Bexp where\n  pretty (TRUE)             = show True\n  pretty (FALSE)            = show False\n  pretty (Neg bexp)         = \"!\" ++ pretty bexp\n  pretty (And bexp1 bexp2)  = pretty bexp1 ++ \" &amp; \" ++ pretty bexp2\n  pretty (Le aexp1 aexp2)   = pretty aexp1 ++ \" =&lt; \" ++ pretty aexp2\n  pretty (Eq aexp1 aexp2)   = pretty aexp1 ++ \" = \" ++ pretty aexp2\n\ninstance Pretty Stm where\n  pretty (Skip)               = \"Skip \"\n  pretty (Ass var aexp)       = \"Ass \" ++ var ++ \" := \" ++ pretty aexp\n  pretty (Comp stm1 stm2)     = \"Comp \" ++ pretty stm1 ++ pretty stm2\n  pretty (If bexp stm1 stm2)  = \"If \" ++ pretty bexp ++ \" \" ++ pretty stm1 ++ \" \" ++ pretty stm2\n  pretty (While bexp stm)     = \"While \" ++ pretty bexp ++ \" \" ++ pretty stm\n  pretty (Block decv decp stm)= \"Block \" ++ pretty decv ++ \" \" ++ pretty decp ++ \" \" ++ pretty stm\n  pretty (Call pname)         = \"Call \" ++ pretty pname\n\nwrap :: Char -&gt; String\nwrap c = [c]\n</code></pre>\n\n<p>But when I try and compile it, I'm receiving the below error from my line <code>deriving instance Show DecV</code>:</p>\n\n<pre><code>Illegal instance declaration for \u2018Show DecV\u2019\n  (All instance types must be of the form (T t1 ... tn)\n   where T is not a synonym.\n   Use TypeSynonymInstances if you want to disable this.)\nIn the stand-alone deriving instance for \u2018Show DecV\u2019\n</code></pre>\n\n<p><strong>edit</strong>:</p>\n\n<p>Removed <code>deriving</code> from the instances of Stm, DecV and DecP fixed that issue, also changed <code>pretty</code> to <code>show</code> in Pretty Block. I'm now getting an error:</p>\n\n<pre><code>Overlapping instances for Show DecP arising from a use of \u2018show\u2019\nMatching instances:\n  instance Show a =&gt; Show [a] -- Defined in \u2018GHC.Show\u2019\n  instance Show DecP -- Defined at 2ndattempt.hs:143:10\nIn the first argument of \u2018(++)\u2019, namely \u2018show decp\u2019\nIn the second argument of \u2018(++)\u2019, namely\n  \u2018show decp ++ \" \" ++ pretty stm\u2019\nIn the second argument of \u2018(++)\u2019, namely\n  \u2018\" \" ++ show decp ++ \" \" ++ pretty stm\u2019\n</code></pre>\n\n<p>current code is:</p>\n\n<pre><code>{-# LANGUAGE StandaloneDeriving #-}\n{-# LANGUAGE TypeSynonymInstances #-}\n{-# LANGUAGE FlexibleInstances #-}\nmodule Attempt where\nimport Text.Megaparsec\nimport Text.Megaparsec.String\nimport Data.List (intercalate)\nimport Prelude hiding (Num)\nimport qualified Prelude (Num)\nimport System.IO\nimport Control.Monad\n\n-- S ::= x:=a\n--    | skip\n--    | S1 ; S2\n--    | if b then S1 else S2\n--    | while b do S\n--    | begin Dv Dv S end\n--    | call p\n-- Dv ::= var x := a ; DV | \u03b5\n-- Dp ::= proc p is S ; DP | \u03b5\n\ntype Num   = Integer\ntype Var   = String\ntype Pname = String\ntype DecV  = [(Var,Aexp)]\ntype DecP  = [(Pname,Stm)]\n\n--Parser\n\n--A few preliminaries that import modules and language features before\n--the full parser is defined.\n\ncr :: Parser [Char]\ncr = many (oneOf \"\\r\\n\")\n\ntok :: String -&gt; Parser String\ntok t = string t &lt;* whitespace\n\nwhitespace :: Parser ()\nwhitespace = many (oneOf \" \\t\") *&gt; pure ()\n\n--Now each of the production rules in the grammar will be considered and\n--translated into a corresponding datatype and parser.\n\n-- a ::= | n | x | a1 + a2 | a1 * a2 | a1 - a2\n\ndata Aexp = N Num\n          | V Var\n          | Mult Aexp Aexp\n          | Add Aexp Aexp\n          | Sub Aexp Aexp\n\naexp :: Parser Aexp\naexp =  N     &lt;$&gt; num\n    &lt;|&gt; V     &lt;$&gt; var\n    &lt;|&gt; Mult  &lt;$&gt; aexp &lt;* tok \"*\" &lt;*&gt; aexp\n    &lt;|&gt; Add   &lt;$&gt; aexp &lt;* tok \"+\" &lt;*&gt; aexp\n    &lt;|&gt; Sub   &lt;$&gt; aexp &lt;* tok \"-\" &lt;*&gt; aexp\n\n-- b ::= true | false | a1 = a2 | a1 =&lt; a2 | !b | b1 &amp; b2\n\ndata Bexp = TRUE\n          | FALSE\n          | Neg Bexp\n          | And Bexp Bexp\n          | Le Aexp Aexp\n          | Eq Aexp Aexp\n\nbexp :: Parser Bexp\nbexp = TRUE   &lt;$ tok \"TRUE\"\n   &lt;|&gt; FALSE  &lt;$ tok \"FALSE\"\n   &lt;|&gt; Neg    &lt;$ tok \"!\" &lt;*&gt; bexp\n   &lt;|&gt; And    &lt;$&gt; bexp &lt;* tok \"&amp;\" &lt;*&gt; bexp\n   &lt;|&gt; Le     &lt;$&gt; aexp &lt;* tok \"=&lt;\" &lt;*&gt; aexp\n   &lt;|&gt; Eq     &lt;$&gt; aexp &lt;* tok \"=\" &lt;*&gt; aexp\n\n-- S ::= x:=a\n--    | skip\n--    | S1 ; S2\n--    | if b then S1 else S2\n--    | while b do S\n--    | begin Dv Dp S end\n--    | call p\n\ndata Stm = Skip\n          | Ass Var Aexp\n          | Comp Stm Stm\n          | If Bexp Stm Stm\n          | While Bexp Stm\n          | Block DecV DecP Stm\n          | Call Pname\n\nstm :: Parser Stm\nstm = Skip    &lt;$ tok \"Skip\"\n  &lt;|&gt; Ass     &lt;$ tok \"Ass\" &lt;*&gt; var &lt;* tok \":=\" &lt;*&gt; aexp\n  &lt;|&gt; Comp    &lt;$ tok \"Comp\" &lt;*&gt; stm &lt;* tok \";\" &lt;*&gt; stm\n  &lt;|&gt; If      &lt;$ tok \"If\" &lt;*&gt; bexp &lt;* tok \"then\" &lt;*&gt; stm &lt;* tok \"else\" &lt;*&gt; stm\n  &lt;|&gt; While   &lt;$ tok \"While\" &lt;*&gt; bexp &lt;* tok \"do\" &lt;*&gt; stm\n  &lt;|&gt; Block   &lt;$ tok \"Block\" &lt;* tok \"begin\" &lt;*&gt; decv &lt;*&gt; decp &lt;*&gt; stm &lt;* tok \"end\"\n  &lt;|&gt; Call    &lt;$ tok \"Call\" &lt;*&gt; pname\n\n-- Dv ::= var x := a ; DV | \u03b5\n\ndecv :: Parser DecV\ndecv = many ((,) &lt;$&gt; var &lt;* tok \":=\" &lt;*&gt; aexp &lt;* tok \";\")\n\n-- Dp ::= proc p is S ; DP | \u03b5\n\ndecp :: Parser DecP\ndecp = many ((,) &lt;$&gt; pname &lt;* tok \"is\" &lt;*&gt; stm &lt;* tok \";\")\n\nnum :: Parser Num\nnum = (some (oneOf ['0' .. '9']) &gt;&gt;= return . read) &lt;* whitespace\n\nvar :: Parser Var\nvar = (some (oneOf ['A' .. 'Z'])) &lt;* whitespace\n\npname :: Parser Pname\npname = tok \"\\\"\" *&gt; some (noneOf (\"\\n\\r\\\"\")) &lt;* tok \"\\\"\"\n\nwhileParser :: Parser Stm\nwhileParser = whitespace &gt;&gt; stm\n\nparseFile :: FilePath -&gt; IO ()\nparseFile filePath = do\n  file &lt;- readFile filePath\n  putStrLn $ case parse whileParser filePath file of\n    Left err          -&gt; parseErrorPretty err\n    Right whileParser -&gt; pretty whileParser\n\n\n--Pretty Printing\n---------------\n\n--The instances below allow values to be inspected in the terminal.\n--The default instance that is derived shows all the constructor names.\n\nderiving instance Show Aexp\nderiving instance Show Bexp\ninstance Show Stm\ninstance Show DecV\ninstance Show DecP\n\n--The pretty-printed output gives a version that should be acceptable\n--Proc.\n\nclass Pretty a where\n  pretty :: a -&gt; String\n\ninstance Pretty Aexp where\n  pretty (N num)            = show num\n  pretty (V var)            = show var\n  pretty (Mult aexp1 aexp2) = \"Mult \" ++ pretty aexp1 ++ \" \" ++ pretty aexp2\n  pretty (Add aexp1 aexp2)  = \"Add \" ++ pretty aexp1 ++ \" \" ++ pretty aexp2\n  pretty (Sub aexp1 aexp2)  = \"Sub \" ++ pretty aexp1 ++ \" \" ++ pretty aexp2\n\ninstance Pretty Bexp where\n  pretty (TRUE)             = show True\n  pretty (FALSE)            = show False\n  pretty (Neg bexp)         = \"!\" ++ pretty bexp\n  pretty (And bexp1 bexp2)  = pretty bexp1 ++ \" &amp; \" ++ pretty bexp2\n  pretty (Le aexp1 aexp2)   = pretty aexp1 ++ \" =&lt; \" ++ pretty aexp2\n  pretty (Eq aexp1 aexp2)   = pretty aexp1 ++ \" = \" ++ pretty aexp2\n\ninstance Pretty Stm where\n  pretty (Skip)               = \"Skip \"\n  pretty (Ass var aexp)       = \"Ass \" ++ var ++ \" := \" ++ pretty aexp\n  pretty (Comp stm1 stm2)     = \"Comp \" ++ pretty stm1 ++ pretty stm2\n  pretty (If bexp stm1 stm2)  = \"If \" ++ pretty bexp ++ \" \" ++ pretty stm1 ++ \" \" ++ pretty stm2\n  pretty (While bexp stm)     = \"While \" ++ pretty bexp ++ \" \" ++ pretty stm\n  pretty (Block decv decp stm)= \"Block \" ++ show decv ++ \" \" ++ show decp ++ \" \" ++ pretty stm\n  pretty (Call pname)         = \"Call \" ++ pname\n\nwrap :: Char -&gt; String\nwrap c = [c]\n</code></pre>\n"}, {"tags": ["haskell", "gtk", "gtk3", "cairo"], "comments": [{"owner": {"reputation": 3411, "user_id": 69663, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aiMZN.png?s=128&g=1", "display_name": "unhammer", "link": "https://stackoverflow.com/users/69663/unhammer"}, "edited": false, "score": 0, "creation_date": 1511443736, "post_id": 43430388, "comment_id": 81867692, "body": "Does it still crash with haskell-gi-base-0.20.5 ? It was released some days ago, and fixed some <a href=\"https://github.com/unhammer/xcb-vs-gtk\" rel=\"nofollow noreferrer\">crashes I was having</a>. You may also want to ask on <a href=\"https://gitter.im/haskell-gi/haskell-gi\" rel=\"nofollow noreferrer\">gitter.im/haskell-gi/haskell-gi</a>"}, {"owner": {"reputation": 564, "user_id": 3637541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c455e355de061d57d5a2cabf3649eddb?s=128&d=identicon&r=PG&f=1", "display_name": "user3637541", "link": "https://stackoverflow.com/users/3637541/user3637541"}, "reply_to_user": {"reputation": 3411, "user_id": 69663, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/aiMZN.png?s=128&g=1", "display_name": "unhammer", "link": "https://stackoverflow.com/users/69663/unhammer"}, "edited": false, "score": 0, "creation_date": 1516810124, "post_id": 43430388, "comment_id": 83843863, "body": "I did&#39;nt try, but i created an issue on github and that got resolved, so i think it is working now."}], "answers": [{"tags": [], "owner": {"reputation": 564, "user_id": 3637541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c455e355de061d57d5a2cabf3649eddb?s=128&d=identicon&r=PG&f=1", "display_name": "user3637541", "link": "https://stackoverflow.com/users/3637541/user3637541"}, "is_accepted": false, "score": 0, "last_activity_date": 1548528445, "creation_date": 1548528445, "answer_id": 54381611, "question_id": 43430388, "link": "https://stackoverflow.com/questions/43430388/haskell-with-gi-cairo-and-gi-gtk-hangs/54381611#54381611", "title": "Haskell with gi-cairo and gi-gtk hangs", "body": "<p>It was an issue with haskell-gi and it was fixed by the maintainer.</p>\n"}], "owner": {"reputation": 564, "user_id": 3637541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c455e355de061d57d5a2cabf3649eddb?s=128&d=identicon&r=PG&f=1", "display_name": "user3637541", "link": "https://stackoverflow.com/users/3637541/user3637541"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1548528445, "creation_date": 1492284711, "question_id": 43430388, "link": "https://stackoverflow.com/questions/43430388/haskell-with-gi-cairo-and-gi-gtk-hangs", "title": "Haskell with gi-cairo and gi-gtk hangs", "body": "<p>In a project of mine i noticed the program hanging from time to time when i was scrolling in a special scrolled viewport. I condensed the problem down to a minimal programm.</p>\n\n<p>When you scroll fast up and down in the scrollable area it hangs but does not throw any error messages.</p>\n\n<p>By trying i found out that </p>\n\n<pre><code>onWidgetDraw drawingArea $ \\(Context fp) -&gt; withManagedPtr fp $ \\p -&gt; (`runReaderT` Cairo (castPtr p)) $ runRender $ do\n   return True\n</code></pre>\n\n<p>is responsible for the hang. Without these two lines it works just fine. I need them though (In my project it is more than two lines but it hangs with just the two already).</p>\n\n<p>I have no idea what is going on. Does anybody know how to fix this?</p>\n\n<p>Code (all files on <a href=\"https://github.com/phuhl/crashing-haskell\" rel=\"nofollow noreferrer\">github</a>):</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE OverloadedLabels #-}\n\nmodule NotificationCenter where\n\nimport Data.Maybe\nimport qualified Data.Text as Text\nimport Control.Monad.Trans.Reader (ReaderT(..))\nimport GI.Gtk as Gtk\nimport Graphics.Rendering.Cairo\nimport Graphics.Rendering.Cairo.Types (Cairo(..))\nimport Graphics.Rendering.Cairo.Internal (Render(..))\nimport GI.Cairo\nimport Foreign.Ptr (castPtr)\n\nmain :: IO ()\nmain = do\n  Gtk.init Nothing\n  let objsToGet = [ \"main_window\" , \"main_bg\" ]\n  builder &lt;- Gtk.builderNew\n  Gtk.builderAddFromFile builder \"crash.glade\"\n\n  (Just win) &lt;- Gtk.builderGetObject builder \"main_window\"\n  (Just bg) &lt;- Gtk.builderGetObject builder \"main_bg\"\n\n  mainWindow &lt;- (Gtk.unsafeCastTo Gtk.Window) $ win\n  drawingArea &lt;- (Gtk.unsafeCastTo Gtk.DrawingArea) $ bg\n\n  onWidgetDraw drawingArea $ \\(Context fp) -&gt; withManagedPtr fp $ \\p -&gt; (`runReaderT` Cairo (castPtr p)) $ runRender $ do\n    return True\n\n  onWidgetDestroy mainWindow mainQuit\n  widgetShowAll mainWindow\n  Gtk.main\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1492283740, "post_id": 43430226, "comment_id": 73918315, "body": "But <code>maybe :: b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b</code> is not an <code>IO</code> monad?"}, {"owner": {"reputation": 69847, "user_id": 3853934, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/GtQuz.jpg?s=128&g=1", "display_name": "Micha\u0142 Per\u0142akowski", "link": "https://stackoverflow.com/users/3853934/micha%c5%82-per%c5%82akowski"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1492284242, "post_id": 43430226, "comment_id": 73918460, "body": "@WillemVanOnsem In my code <code>maybe</code> returns either <code>return Nothing</code> (which is of type <code>IO (Maybe b)</code>) or the return value of <code>f</code> (which also is <code>IO (Maybe b)</code>)."}], "answers": [{"comments": [{"owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "edited": false, "score": 0, "creation_date": 1492592859, "post_id": 43430289, "comment_id": 74037108, "body": "In cases where <code>MaybeT</code> is overkill: you can sometimes use <code>(fmap . fmap)</code>"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "edited": false, "score": 0, "creation_date": 1492626470, "post_id": 43430289, "comment_id": 74061275, "body": "@JeremyList Yup. (Note for other readers: in this case, that amounts to a hand-written equivalent of <code>fmap</code> for <code>MaybeT IO</code> (or <code>Compose IO Maybe</code>), just like Micha\u0142&#39;s <code>ioMaybeApply</code> is a hand-written equivalent of <code>(&gt;&gt;=)</code> for <code>MaybeT IO</code>.)"}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 6, "last_activity_date": 1492285494, "last_edit_date": 1492285494, "creation_date": 1492284126, "answer_id": 43430289, "question_id": 43430226, "link": "https://stackoverflow.com/questions/43430226/apply-a-function-to-a-value-inside-io-maybe/43430289#43430289", "title": "Apply a function to a value inside IO Maybe", "body": "<p>This can be achieved through the <a href=\"http://hackage.haskell.org/package/transformers-0.5.4.0/docs/Control-Monad-Trans-Maybe.html\" rel=\"noreferrer\"><code>MaybeT</code> monad transformer</a>:</p>\n\n<pre><code>GHCi&gt; import Control.Monad.Trans.Maybe\nGHCi&gt; :t \\f m -&gt; runMaybeT (MaybeT m &gt;&gt;= MaybeT . f)\n\\f m -&gt; runMaybeT (MaybeT m &gt;&gt;= MaybeT . f)\n  :: Monad m =&gt; (a1 -&gt; m (Maybe a)) -&gt; m (Maybe a1) -&gt; m (Maybe a)\n</code></pre>\n\n\n\n<pre><code>import Control.Monad.Trans.Maybe\n\n-- Making it look like your definition, for the sake of comparison.\nioMaybeApply :: (a -&gt; IO (Maybe b)) -&gt; IO (Maybe a) -&gt; IO (Maybe b)\nioMaybeApply f ioMaybeA = runMaybeT $ do\n  a &lt;- MaybeT ioMaybeA\n  MaybeT (f a)\n</code></pre>\n\n<p>If you are using this pattern in multiple places, it will likely pay off to change your <code>a -&gt; IO (Maybe b)</code> functions to <code>a -&gt; MaybeT IO b</code> -- then you can just use <code>(&gt;&gt;=)</code> and/or seamless do-blocks instead of your special-purpose function. On the other hand, if this is just an one-off you may reasonably think that using <code>MaybeT</code> would be overkill; in that case, your implementation is perfectly fine.</p>\n\n<p>(It is worth mentioning that while there is a general-purpose wrapper for nested functors called <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Functor-Compose.html\" rel=\"noreferrer\"><code>Compose</code></a> that has <code>Functor</code> and <code>Applicative</code> instances, it doesn't have a <code>Monad</code> instance, as nesting two monads doesn't necessarily result in something that can be given a legal <code>Monad</code> instance. That being so, we typically resort to monad transformers tailored for each combination that works.)</p>\n"}], "owner": {"reputation": 69847, "user_id": 3853934, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/GtQuz.jpg?s=128&g=1", "display_name": "Micha\u0142 Per\u0142akowski", "link": "https://stackoverflow.com/users/3853934/micha%c5%82-per%c5%82akowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 633, "favorite_count": 1, "accepted_answer_id": 43430289, "answer_count": 1, "score": 4, "last_activity_date": 1492285494, "creation_date": 1492283626, "last_edit_date": 1492283667, "question_id": 43430226, "link": "https://stackoverflow.com/questions/43430226/apply-a-function-to-a-value-inside-io-maybe", "title": "Apply a function to a value inside IO Maybe", "body": "<p>I have a function of type <code>a -&gt; IO (Maybe b)</code> and I want to apply it to <code>IO (Maybe a)</code> and get <code>IO (Maybe b)</code>. I wrote a function to do that:</p>\n\n<pre><code>ioMaybeApply :: (a -&gt; IO (Maybe b)) -&gt; IO (Maybe a) -&gt; IO (Maybe b)\nioMaybeApply f ioMaybeA = do\n  maybeA &lt;- ioMaybeA\n  maybe (return Nothing) f maybeA\n</code></pre>\n\n<p>Is there a standard Haskell function to do that? I tried searching with Hoogle but I didn't find anything. If not, is my implementation good, or could it be simpler?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1492277516, "post_id": 43429069, "comment_id": 73916080, "body": "You need to indent <code>f = ...</code> and <code>nf = ...</code> otherwise there is no way of knowing they are attached to <code>divideList</code>."}, {"owner": {"reputation": 125, "user_id": 5886739, "user_type": "registered", "accept_rate": 12, "profile_image": "https://lh3.googleusercontent.com/-cWYFZDzBv4g/AAAAAAAAAAI/AAAAAAAABzU/DQ7EqhTj1S0/photo.jpg?sz=128", "display_name": "Graham Bewley", "link": "https://stackoverflow.com/users/5886739/graham-bewley"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1492278036, "post_id": 43429069, "comment_id": 73916283, "body": "I can&#39;t believe this is all it took... thank you so much"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1492339861, "post_id": 43429069, "comment_id": 73929871, "body": "BTW, <a href=\"https://www.haskell.org/hoogle/?hoogle=%28a+-%3E+Bool%29+-%3E+%5Ba%5D+-%3E+%28%5Ba%5D%2C%5Ba%5D%29\" rel=\"nofollow noreferrer\">Hoogle would have told you</a> that <code>partition</code> is the function you want."}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 5886739, "user_type": "registered", "accept_rate": 12, "profile_image": "https://lh3.googleusercontent.com/-cWYFZDzBv4g/AAAAAAAAAAI/AAAAAAAABzU/DQ7EqhTj1S0/photo.jpg?sz=128", "display_name": "Graham Bewley", "link": "https://stackoverflow.com/users/5886739/graham-bewley"}, "edited": false, "score": 0, "creation_date": 1492278228, "post_id": 43429249, "comment_id": 73916339, "body": "Thank you, I just realized that all I needed was some indentation. Does partition separate lists based on a predicate (a la filter)?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 125, "user_id": 5886739, "user_type": "registered", "accept_rate": 12, "profile_image": "https://lh3.googleusercontent.com/-cWYFZDzBv4g/AAAAAAAAAAI/AAAAAAAABzU/DQ7EqhTj1S0/photo.jpg?sz=128", "display_name": "Graham Bewley", "link": "https://stackoverflow.com/users/5886739/graham-bewley"}, "edited": false, "score": 1, "creation_date": 1492278349, "post_id": 43429249, "comment_id": 73916384, "body": "<a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-List.html#v:partition\" rel=\"nofollow noreferrer\">Yes.</a>"}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 1, "last_activity_date": 1492278092, "creation_date": 1492278092, "answer_id": 43429249, "question_id": 43429069, "link": "https://stackoverflow.com/questions/43429069/haskell-error-variable-not-in-scope/43429249#43429249", "title": "Haskell error: Variable not in scope", "body": "<p>Indent both <code>f</code> and <code>nf</code>:</p>\n\n<pre><code>divideList :: (a -&gt; Bool) -&gt; [a] -&gt; ([a],[a])\ndivideList p xs = (f, nf) where\n  f  = doFilter p xs\n  nf = doFilter (not . p) xs\n</code></pre>\n\n<p>After all, where would your <code>where</code> block stop?</p>\n\n<p>By the way, <code>divideList</code> is <code>partition</code> from <code>Data.List</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 125, "user_id": 5886739, "user_type": "registered", "accept_rate": 12, "profile_image": "https://lh3.googleusercontent.com/-cWYFZDzBv4g/AAAAAAAAAAI/AAAAAAAABzU/DQ7EqhTj1S0/photo.jpg?sz=128", "display_name": "Graham Bewley", "link": "https://stackoverflow.com/users/5886739/graham-bewley"}, "is_accepted": false, "score": 0, "last_activity_date": 1492338976, "last_edit_date": 1492338976, "creation_date": 1492278114, "answer_id": 43429252, "question_id": 43429069, "link": "https://stackoverflow.com/questions/43429069/haskell-error-variable-not-in-scope/43429252#43429252", "title": "Haskell error: Variable not in scope", "body": "<p>Thanks to Alec, I found that all I needed to do was indent the statements underneath <code>where</code>:</p>\n\n<pre><code>divideList :: (a -&gt; Bool) -&gt; [a] -&gt; ([a],[a])\ndivideList p xs = (f, nf) where \n    f = doFilter p xs\n    nf = doFilter (not . p) xs\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 5886739, "user_type": "registered", "accept_rate": 12, "profile_image": "https://lh3.googleusercontent.com/-cWYFZDzBv4g/AAAAAAAAAAI/AAAAAAAABzU/DQ7EqhTj1S0/photo.jpg?sz=128", "display_name": "Graham Bewley", "link": "https://stackoverflow.com/users/5886739/graham-bewley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6178, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1492338976, "creation_date": 1492277165, "question_id": 43429069, "link": "https://stackoverflow.com/questions/43429069/haskell-error-variable-not-in-scope", "title": "Haskell error: Variable not in scope", "body": "<p>I'm a bit new to Haskell but I've been working this problem for a couple hours with no luck.</p>\n\n<p>I'm trying to implement something similar to a filter, except a predicate and list is passed to a function and it returns a tuple of two lists, one which is filtered by the predicate and one which is not.</p>\n\n<pre><code>divideList :: (a -&gt; Bool) -&gt; [a] -&gt; ([a],[a])\ndivideList p xs = (f, nf) where \nf = doFilter p xs\nnf = doFilter (not . p) xs\n\ndoFilter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\ndoFilter _ [] = []\ndoFilter p (x:xs) = [x | p x] ++ doFilter p xs\n</code></pre>\n\n<p>The second function, <code>doFilter</code> works properly. It applies the filter to its list and spits out the appropriate list. (i.e. If I just use <code>doFilter (&gt;3) [1,2,3,4,5,6]</code> it will work properly)</p>\n\n<p>My issue is with the first function. When I use <code>divideList (&gt;3) [1,2,3,4,5,6]</code> I get a number of <code>Variable not in scope</code> errors. The errors are listed below:</p>\n\n<pre><code>AddListOperations.hs:20:23: error:\n    Variable not in scope: p :: a -&gt; Bool\n\nAddListOperations.hs:20:25: error: Variable not in scope: xs :: [a]\n\nAddListOperations.hs:21:31: error:\n    Variable not in scope: p :: a -&gt; Bool\n\nAddListOperations.hs:21:34: error: Variable not in scope: xs :: [a]\n</code></pre>\n\n<p>Like I said, I have only been messing around with Haskell for a few days so let me know if I'm leaving out any important information.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1492276513, "post_id": 43428558, "comment_id": 73915704, "body": "With respect to your P.S., cf. <a href=\"http://stackoverflow.com/q/39256410/2751851\"><i>Is there a reason for `iterate` to start with original element?</i></a>"}, {"owner": {"reputation": 441, "user_id": 5324537, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1da02c8d20023c2bb9823f8ef6b9e3ee?s=128&d=identicon&r=PG&f=1", "display_name": "Maxime VAST", "link": "https://stackoverflow.com/users/5324537/maxime-vast"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1492276741, "post_id": 43428558, "comment_id": 73915798, "body": "Very interesting thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 441, "user_id": 5324537, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1da02c8d20023c2bb9823f8ef6b9e3ee?s=128&d=identicon&r=PG&f=1", "display_name": "Maxime VAST", "link": "https://stackoverflow.com/users/5324537/maxime-vast"}, "edited": false, "score": 0, "creation_date": 1492275626, "post_id": 43428645, "comment_id": 73915388, "body": "Thank you for your answer. I tried to use your solution but got <code>Couldn&#39;t match expected type \u2018[b]\u2019 with actual type \u2018a0 -&gt; [a0]\u2019 Probable cause: \u2018iterate\u2019 is applied to too few arguments</code> and <code>Couldn&#39;t match type \u2018(Int, Int)\u2019 with \u2018a0 -&gt; a0\u2019 Expected type: a0 -&gt; a0 Actual type: (Int, Int) Possible cause: \u2018addTupple\u2019 is applied to too many arguments</code> Could you help again? Cheers"}, {"owner": {"reputation": 441, "user_id": 5324537, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1da02c8d20023c2bb9823f8ef6b9e3ee?s=128&d=identicon&r=PG&f=1", "display_name": "Maxime VAST", "link": "https://stackoverflow.com/users/5324537/maxime-vast"}, "edited": false, "score": 0, "creation_date": 1492276048, "post_id": 43428645, "comment_id": 73915536, "body": "Quick and efficient! I would upvote agian if I could. Thanks! Any idea for the fact that the initial pos is returned by iterate?"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1492276148, "last_edit_date": 1492276148, "creation_date": 1492274856, "answer_id": 43428645, "question_id": 43428558, "link": "https://stackoverflow.com/questions/43428558/iterate-and-map/43428645#43428645", "title": "iterate and map", "body": "<p>What you can use here is a <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Prelude.html#v:concatMap\" rel=\"nofollow noreferrer\"><code>concatMap :: (a -&gt; [b]) -&gt; [a] -&gt; [b]</code></a>: it <em>concatenates</em> the lists that are obtained by applying the function. So:</p>\n\n<pre><code>concatMap (<b>\\x</b> -&gt; (take 8 $ iterate (addTupple <b>x</b>) initpos)) legal</code></pre>\n\n<p>Here we thus introduce a <em>lambda-expression</em> which maps every element <code>x</code> of <code>legal</code> to <code>take 8 $ iterate (addTupple <b>x</b> initpos)</code>. All these lists are then concatenated together.</p>\n\n<pre><code>Prelude&gt; concatMap (\\x -&gt; (take 8 $ iterate (addTupple x) initpos)) legal\n[(1,1),(1,2),(1,3),(1,4),(1,5),(1,6),(1,7),(1,8),(1,1),(1,0),(1,-1),(1,-2),(1,-3),(1,-4),(1,-5),(1,-6),(1,1),(2,1),(3,1),(4,1),(5,1),(6,1),(7,1),(8,1),(1,1),(0,1),(-1,1),(-2,1),(-3,1),(-4,1),(-5,1),(-6,1)]\n</code></pre>\n\n<p><strong>EDIT</strong></p>\n\n<p>If you don't want the initial value to be returned (by the <code>iterate</code>), you can use <code>tail</code> to ignore the \"head\" of the list:</p>\n\n<pre><code>concatMap (\\x -&gt; (take 8 <b>$ tail</b> $ iterate (addTupple x) initpos)) legal</code></pre>\n\n<p>This constructs:</p>\n\n<pre><code>Prelude&gt; concatMap (\\x -&gt; (take 8 $ tail $ iterate (addTupple x) initpos)) legal\n[(1,2),(1,3),(1,4),(1,5),(1,6),(1,7),(1,8),(1,9),(1,0),(1,-1),(1,-2),(1,-3),(1,-4),(1,-5),(1,-6),(1,-7),(2,1),(3,1),(4,1),(5,1),(6,1),(7,1),(8,1),(9,1),(0,1),(-1,1),(-2,1),(-3,1),(-4,1),(-5,1),(-6,1),(-7,1)]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 441, "user_id": 5324537, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1da02c8d20023c2bb9823f8ef6b9e3ee?s=128&d=identicon&r=PG&f=1", "display_name": "Maxime VAST", "link": "https://stackoverflow.com/users/5324537/maxime-vast"}, "edited": false, "score": 1, "creation_date": 1492276997, "post_id": 43428936, "comment_id": 73915893, "body": "Cristal clear explanation, My exp&#233;rimentations allowed me to obtain the list of infinite lists that you are mentioning but I was using <code>take 8</code> before <code>map</code> which wasn&#39;t helpful. Thank you for taking the time!"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1492278614, "post_id": 43428936, "comment_id": 73916480, "body": "The output is not entirely equal to the expected since the elements in <code>legal</code> are the &quot;move directions&quot;. and <code>initpos</code> the first element. If you run it, I get <code>[(0,1),(1,2),(2,3),(3,4),(4,5),(5,6),(6,7),(7,8),(0,-1),...]</code>&zwnj;&#8203;."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1492280236, "post_id": 43428936, "comment_id": 73917060, "body": "@WillemVanOnsem Indeed -- that remark is more relevant that I thought of on a first reading of the question. Answer adjusted accordingly."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 3, "last_activity_date": 1492280166, "last_edit_date": 1495541388, "creation_date": 1492276451, "answer_id": 43428936, "question_id": 43428558, "link": "https://stackoverflow.com/questions/43428558/iterate-and-map/43428936#43428936", "title": "iterate and map", "body": "<p>Here is a slightly different way of looking at the problem -- the end result will be essentially the same as in <a href=\"https://stackoverflow.com/a/43428645/2751851\">Willem Van Onsem's answer</a>.</p>\n\n<p>Let's begin by noting that <code>iterate</code> is a function that modifies functions -- it turns an <code>a -&gt; a</code> function into one that produces an infinite list:</p>\n\n<pre><code>iterate :: (a -&gt; a) -&gt; a -&gt; [a]\n</code></pre>\n\n<p>That being so, starting from...</p>\n\n<pre><code>map (\\move -&gt; addTuple move initpos) legal\n</code></pre>\n\n<p>... and modifying the function being applied to <code>initpos</code> with <code>iterate</code>...</p>\n\n<pre><code>map (\\move -&gt; (iterate (addTuple move)) initpos) legal\n-- Alternatively: map (\\move -&gt; iterate (addTuple move) initpos) legal\n</code></pre>\n\n<p>... will give you a list of infinite lists, one per pair in <code>legal</code>. We can compose with <code>take 8</code> to cut down the infinite lists...</p>\n\n<pre><code>map (\\move -&gt; (take 8 . iterate (addTuple move)) initpos) legal\n-- Alternatively: map (\\move -&gt; take 8 $ iterate (addTuple move) initpos) legal\n</code></pre>\n\n<p>.. and flatten the resulting list of finite lists with <code>concat</code>:</p>\n\n<pre><code>concat $ map (\\move -&gt; (take 8 . iterate (addTuple move)) initpos) legal\n</code></pre>\n\n<p>Finally, given that <code>concatMap</code> is defined as <code>concat . map</code>, we can use it instead of this <code>concat</code>/<code>map</code> combination:</p>\n\n<pre><code>concatMap (\\move -&gt; (take 8 . iterate (addTuple move)) initpos) legal\n</code></pre>\n"}], "owner": {"reputation": 441, "user_id": 5324537, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1da02c8d20023c2bb9823f8ef6b9e3ee?s=128&d=identicon&r=PG&f=1", "display_name": "Maxime VAST", "link": "https://stackoverflow.com/users/5324537/maxime-vast"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 584, "favorite_count": 0, "accepted_answer_id": 43428645, "answer_count": 2, "score": 2, "last_activity_date": 1492280166, "creation_date": 1492274387, "last_edit_date": 1492274475, "question_id": 43428558, "link": "https://stackoverflow.com/questions/43428558/iterate-and-map", "title": "iterate and map", "body": "<p>I'm trying to use <code>iterate</code> and <code>map</code> together but I'm stuck.</p>\n\n<p>I have a list of possible positions and an initial position:</p>\n\n<pre><code>legal = [(0,1),(0,-1),(1,0),(-1,0)]\ninitpos = (1,1)\n</code></pre>\n\n<p>And a function:</p>\n\n<pre><code>addTupple::(Int,Int)-&gt;(Int,Int)-&gt;(Int,Int)\naddTupple (x1,y1) (x2,y2) = (x1+x2,y1+y2)\n</code></pre>\n\n<p>I can do:</p>\n\n<pre><code>map (addTupple initpos) legal\n</code></pre>\n\n<p>Which produce the expected:</p>\n\n<pre><code>[(1,2),(1,0),(2,1),(0,1)]\n</code></pre>\n\n<p>And I can do:</p>\n\n<pre><code>take 8 $ iterate (addTupple (0,1)) initpos\n</code></pre>\n\n<p>Resulting in:</p>\n\n<pre><code>[(1,1),(1,2),(1,3),(1,4),(1,5),(1,6),(1,7),(1,8)]\n</code></pre>\n\n<p>But what if I'd like to combine map and iterate to obtain the following result:</p>\n\n<pre><code>[(1,1),(1,2),(1,3),(1,4),(1,5),(1,6),(1,7),(1,8),(1,1),(1,0),(1,-1),(1,-2),(1,-3),(1,-4),(1,-5),(1,-6),(1,1),(2,1),(3,1),(4,1),(5,1),(6,1),(7,1),(8,1),(1,1),(0,1),(-1,1),(-2,1),(-3,1),(-4,1),(-5,1),(-6,1)]\n</code></pre>\n\n<p>which is the result of :</p>\n\n<pre><code>l1 = take 8 $ iterate (addTupple (0,1)) initpos\nl2 = take 8 $ iterate (addTupple (0,-1)) initpos\nl3 = take 8 $ iterate (addTupple (1,0)) initpos\nl4 = take 8 $ iterate (addTupple (-1,0)) initpos\nl1 ++ l2 ++ l3 ++ l4\n</code></pre>\n\n<p>I can't figure it out. Any idea? Thank you in advance.</p>\n\n<p>Ps: I also don't understand why <code>take 8 $ iterate</code> returns the initial pos <code>(1,1)</code></p>\n"}, {"tags": ["haskell", "functor", "applicative"], "answers": [{"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 4, "creation_date": 1492273929, "post_id": 43428168, "comment_id": 73914808, "body": "Note that the OP&#39;s expression isn&#39;t <code>x &lt;$&gt; y &lt;*&gt; z</code> (which is equivalent to <code>liftA2 x y z</code>), but rather <code>x &lt;*&gt; y &lt;$&gt; z</code>, which is far more confusing."}, {"owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "edited": false, "score": 1, "creation_date": 1492276318, "post_id": 43428168, "comment_id": 73915625, "body": "Even though the answer is wrong, I still find it very helpful. Given an edit that acknowledges it, I would still up vote it"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1492361896, "post_id": 43428168, "comment_id": 73936294, "body": "You&#39;ll probably be happy to hear that <code>liftA2</code> will become an <code>Applicative</code> method in the upcoming base library release, and <code>Traversable</code> deriving will use it as appropriate. Unfortunately, <code>ApplicativeDo</code> desugaring is a whole other level of tricky, so I haven&#39;t tried incorporating it there."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 3, "last_activity_date": 1492357166, "last_edit_date": 1495540009, "creation_date": 1492271998, "answer_id": 43428168, "question_id": 43428053, "link": "https://stackoverflow.com/questions/43428053/x-y-z-in-haskell/43428168#43428168", "title": "x &lt;*&gt; y &lt;$&gt; z in Haskell", "body": "<p>So in <code>x &lt;*&gt; y &lt;$&gt; z</code>, i.e. <code>fmap (x&lt;*&gt;y) z</code>, you apply the function <code>x&lt;*&gt;y</code> over the functor-value <code>z</code>. The <code>&lt;*&gt;</code> actually knows nothing about the fmapping \u2013 the two operators work on completely separate functors! That the first important thing to realise here.</p>\n\n<p>The next is that, if the result of <code>x&lt;*&gt;y</code> is a function, then the <code>Applicative</code> instance of the <code>&lt;*&gt;</code> is actually the <a href=\"https://stackoverflow.com/questions/43379364/typeclass-instances-for-functions/43379619#43379619\">function functor</a>. I wish people would stop using that so much, because it's really one of the more confusing instances and generally not the nicest abstraction to choose.</p>\n\n<p>Concretely, <code>f&lt;*&gt;g</code> is just a clever way of composing the functions <code>f</code> and <code>g</code> while also passing the initial input directly to <code>f</code>. It works thus:</p>\n\n<pre><code>(&lt;*&gt;) :: (f ~ (x-&gt;))\n     =&gt; f (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>i.e.</p>\n\n<pre><code>(&lt;*&gt;) :: (x -&gt;(a -&gt; b)) -&gt; (x -&gt; a) -&gt; (x -&gt; b)\n       \u2261 (x -&gt; a -&gt; b)  -&gt; (x -&gt; a) -&gt;  x -&gt; b\n(f &lt;*&gt; g) x = f x $ g x\n</code></pre>\n\n<p>In terms of data flow, it's this operation:</p>\n\n<pre><code>\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u25b6 f \u2500\u2500\u25b6\n    \u2502       \u2502\n    \u2514\u2500\u25b6 g \u2500\u2500\u2518\n</code></pre>\n\n<p>I would rather express this with <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Arrow.html\" rel=\"nofollow noreferrer\">arrow combinators</a>:</p>\n\n<pre><code>     \u250c\u2500\u2500\u2500id\u2500\u2500\u2510\n\u2500\u2500\u2500\u2500&amp;&amp;&amp;     uncurry f \u2500\u2500\u25b6\n     \u2514\u2500\u25b6 g \u2500\u2500\u2518\n</code></pre>\n\n<p>so <code>f&lt;*&gt;g \u2261 id &amp;&amp;&amp; g &gt;&gt;&gt; uncurry f</code>. Granted, that is nowhere as compact, in fact more verbose than the explicit lambda version <code>\\x -&gt; f x $ g x</code>, which frankly would probably be the best. However, the arrow version is the most general version of the three and arguably expresses best what's going on. The main reason it's so verbose is that currying does not work in out favour here; we might define an operator</p>\n\n<pre><code>(\u227b&gt;&gt;) :: (x-&gt;(a,b)) -&gt; (a-&gt;b-&gt;c) -&gt; x -&gt; c\ng\u227b&gt;&gt;h = uncurry h . g\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>         x &lt;*&gt; y &lt;$&gt; z\n\u2261 fmap (id &amp;&amp;&amp; y \u227b&gt;&gt; x) z\n\u2261 fmap (\\\u03be -&gt; x \u03be $ y \u03be) z\n</code></pre>\n\n<p>For the example, we have</p>\n\n<pre><code>   (+) &lt;*&gt; (+1) &lt;$&gt; a\n\u2261 fmap (id &amp;&amp;&amp; (+1) \u227b&gt;&gt; (+)) z\n\u2261 fmap (\\x -&gt; 1 + x+1) z\n\u2261 fmap (+2) z\n</code></pre>\n\n<hr>\n\n<p><strong>I first misread your question. The pattern <code>&lt;$&gt;</code> <code>&lt;*&gt;</code> much more common than your <code>&lt;*&gt;</code> <code>&lt;$&gt;</code>, the following adresses that... perhaps useful for other people.</strong></p>\n\n<p><code>f &lt;$&gt; y &lt;*&gt; z</code> can also be written <code>liftA2 f y z</code>, and <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Applicative.html#v:liftA2\" rel=\"nofollow noreferrer\"><code>liftA2</code></a> is IMO rather easier to understand than the equivalent <code>&lt;*&gt;</code>.</p>\n\n<pre><code>liftA2 :: (a -&gt; b -&gt; c) -&gt; f a -&gt; f b -&gt; f c\n</code></pre>\n\n<p>What it does is, it takes a combiner-function on values and produces from it a combiner-function on containers. It's a bit similar to <code>zipWith</code> except for the list instance, it not only combines each element in the <code>a</code> list with <em>the corresponding element</em> in the <code>b</code> list, but combines each element in the <code>a</code> list once <em>with all elements</em> in the <code>b</code> list, and concatenates the results.</p>\n\n<pre><code>Prelude&gt; Control.Applicative.liftA2 (+) [0,10..30] [0..3]\n[0,1,2,3,10,11,12,13,20,21,22,23,30,31,32,33]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 1, "creation_date": 1492278116, "post_id": 43428417, "comment_id": 73916312, "body": "Needless to say, but don&#39;t actually do this. It is <i>really</i> bad style because it looks like one thing, but is actually another. Rule of thumb is to never implicitly use a Reader instance."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1492280091, "post_id": 43428417, "comment_id": 73917012, "body": "@Lazersmoke Agreed. Using <code>&lt;*&gt;</code> as an S combinator, exploiting its <code>(-&gt;) a</code> instance, can be quite confusing."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 2, "creation_date": 1492281117, "post_id": 43428417, "comment_id": 73917379, "body": "@Lazersmoke I do think there are a few legitimate uses for <code>Applicative ((-&gt;) r)</code> (in particular, <code>op &lt;$&gt; f &lt;*&gt; g</code> doesn&#39;t bother me if the fact that <code>f</code> and <code>g</code> are functions is either very obvious or irrelevant in context). In any case, the example we are discussing is not one of them. (I agree with chi in that using a standalone <code>(&lt;*&gt;)</code> as the S combinator tends to be confusing.)"}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": true, "score": 4, "last_activity_date": 1492283164, "last_edit_date": 1492283164, "creation_date": 1492273498, "answer_id": 43428417, "question_id": 43428053, "link": "https://stackoverflow.com/questions/43428053/x-y-z-in-haskell/43428417#43428417", "title": "x &lt;*&gt; y &lt;$&gt; z in Haskell", "body": "<p>Let's start with:</p>\n\n<pre><code>x &lt;*&gt; y &lt;$&gt; z\n</code></pre>\n\n<p>Adding parentheses, it becomes:</p>\n\n<pre><code>(x &lt;*&gt; y) &lt;$&gt; z\n</code></pre>\n\n<p>Given that  <code>(&lt;$&gt;) :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b</code>, we have:</p>\n\n<pre><code>x &lt;*&gt; y :: a -&gt; b\nz :: Functor f =&gt; f a\n</code></pre>\n\n<p>Given that <code>(&lt;*&gt;) :: Applicative g =&gt; g (c -&gt; d) -&gt; g c -&gt; g d</code>, we have:</p>\n\n<pre><code>x :: Applicative g =&gt; g (c -&gt; d)\ny :: Applicative g =&gt; g c\nx &lt;*&gt; y :: Applicative g =&gt; g d\n</code></pre>\n\n<p>Combining the last few results, we get:</p>\n\n<pre><code>g d ~ a -&gt; b\ng ~ (-&gt;) a\nd ~ b\n\nx :: a -&gt; c -&gt; b\ny :: a -&gt; c\nx &lt;*&gt; y :: a -&gt; b\n</code></pre>\n\n<p>Therefore:</p>\n\n<pre><code>(\\x y z -&gt; x &lt;*&gt; y &lt;$&gt; z) :: Functor f =&gt; (a -&gt; c -&gt; b) -&gt; (a -&gt; c) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>Now knowing that <code>(&lt;*&gt;)</code> from the function instance is being used, we can also substitute its definition:</p>\n\n<pre><code>x &lt;*&gt; y &lt;$&gt; z\n(\\r -&gt; x r (y r)) &lt;$&gt; z\n</code></pre>\n\n<p>In your example, <code>x = (+)</code>, <code>y = (+1)</code> and <code>z = a</code>, so we get...</p>\n\n<pre><code>(\\r -&gt; r + (r + 1)) &lt;$&gt; a\n</code></pre>\n\n<p>... which adds each value in <code>a</code> to itself plus one:</p>\n\n<pre><code>GHCi&gt; (+) &lt;*&gt; (+1) &lt;$&gt; [0..3]\n[1,3,5,7]\nGHCi&gt; ((+) &lt;*&gt; (+1) &lt;$&gt; (*5)) 2\n21\n</code></pre>\n"}], "owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 192, "favorite_count": 0, "accepted_answer_id": 43428417, "answer_count": 2, "score": 5, "last_activity_date": 1492357166, "creation_date": 1492271241, "question_id": 43428053, "link": "https://stackoverflow.com/questions/43428053/x-y-z-in-haskell", "title": "x &lt;*&gt; y &lt;$&gt; z in Haskell", "body": "<p>I'm trying to understand some Haskell source code, and I encountered this structure some times:</p>\n\n<pre><code>x &lt;*&gt; y &lt;$&gt; z\n</code></pre>\n\n<p>e.g.</p>\n\n<pre><code>(+) &lt;*&gt; (+1) &lt;$&gt; a\n</code></pre>\n\n<p>Can somebody explain this structure to me? I get that it translates to <code>fmap a (+ a + 1)</code>, but I can't make the connection</p>\n"}, {"tags": ["debugging", "haskell", "ghc", "stack-trace"], "comments": [{"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 2, "creation_date": 1492275842, "post_id": 43428041, "comment_id": 73915455, "body": "I expect the answer to be simply \u201cno\u201d."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1492279948, "post_id": 43428041, "comment_id": 73916969, "body": "Perhaps the GHCi debugger could provide an alternative."}], "owner": {"reputation": 7724, "user_id": 305597, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4ca36f30d08f1d2708c7a0a8646f87e8?s=128&d=identicon&r=PG", "display_name": "Mart&#237;n Fixman", "link": "https://stackoverflow.com/users/305597/mart%c3%adn-fixman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1492271200, "creation_date": 1492271200, "question_id": 43428041, "link": "https://stackoverflow.com/questions/43428041/is-there-any-way-to-add-the-argument-values-to-the-stack-trace-when-using-fprof", "title": "Is there any way to add the argument values to the stack trace when using -fprof-auto-calls in GHC?", "body": "<p>I'm trying to debug a complicated and recursive function using <code>traceStack</code>. My current approach is something similar to the following.</p>\n\n<pre><code>import Debug.Trace\nsmosh :: (Eq a, Show a) =&gt; a -&gt; [a] -&gt; [a]\nsmosh f s = traceStack (show (f, s)) smoshed\n  where smoshed = ...\n</code></pre>\n\n<p>And later compiling it with <code>-prof -fprof-auto-calls</code> to get the full calling stack trace along with the variables each time I call <code>smosh</code>.</p>\n\n<p>However, the stack trace is missing with which arguments I'm calling the rest of the functions of the stack trace (all of which are <code>Show</code>). Is there any simple way to add them that's nicer than adding <code>trace</code> to every other function?</p>\n"}, {"tags": ["haskell", "associativity"], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1492279876, "post_id": 43427494, "comment_id": 73916947, "body": "So, it does not really matter if it is left or right associative, as far as semantics is concerned (and functors indeed satisfy functor laws). I wonder if the left associaitvity was a deliberate choice, e.g. for perfomance reasons. It could even have been defined in that way by chance, or by error, in theory."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1492450271, "post_id": 43427494, "comment_id": 73968209, "body": "@chi If <code>(&lt;$&gt;)</code> were right associative, you could no longer use that <code>f &lt;$&gt; x &lt;*&gt; y</code> style pattern (because <code>(&lt;*&gt;)</code> would also have to be right associative, for you to use them together without parentheses like that). There are some people who say that <code>($)</code> should have been left associative, because then you could do something like <code>f $ g x $ h y</code> and it would be equivalent to <code>f (g x) (h y)</code> (and I guess it would be symmetrical with how <code>-&gt;</code> is right associative). Of course, it really comes down to preference though."}], "tags": [], "owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "is_accepted": true, "score": 18, "last_activity_date": 1492268014, "creation_date": 1492268014, "answer_id": 43427494, "question_id": 43427351, "link": "https://stackoverflow.com/questions/43427351/how-can-be-left-associative/43427494#43427494", "title": "How can (&lt;$&gt;) be left associative", "body": "<p>No, <code>&lt;$&gt;</code> is left associative and this is no different in your example. <code>(+1) &lt;$&gt; (/5) &lt;$&gt; [5,10]</code> is read as <code>((+1) &lt;$&gt; (/5)) &lt;$&gt; [5,10]</code>. This happens to work because of the <code>Functor</code> instance of <code>(-&gt;) a</code> is basically equivalent to function composition; <code>fmap (+1) (/5)</code> is equivalent to <code>\\x -&gt; (x/5)+1</code>, which in this instance gives you the same result as what you'd get with the order you appear to think this works in, i.e. <code>(+1) &lt;$&gt; ((+5) &lt;$&gt; [5,10])</code>.</p>\n\n<p>Because this is a little bit confusing, if you want to apply multiple functions in a row it's probably better for readability to use the normal function composition operator here: <code>(+1) . (/5) &lt;$&gt; [5,10]</code>.</p>\n"}], "owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 649, "favorite_count": 0, "accepted_answer_id": 43427494, "answer_count": 1, "score": 16, "last_activity_date": 1492268014, "creation_date": 1492267282, "question_id": 43427351, "link": "https://stackoverflow.com/questions/43427351/how-can-be-left-associative", "title": "How can (&lt;$&gt;) be left associative", "body": "<p>I just noticed that <code>(&lt;$&gt;)</code> has a fixity of <code>infixl 4</code>. How can this be?</p>\n\n<p><code>(+1) &lt;$&gt; (/5) &lt;$&gt; [5,10]</code> obviously works right to left.</p>\n"}, {"tags": ["haskell", "functional-programming", "imperative-programming", "declarative-programming"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1492262083, "post_id": 43426155, "comment_id": 73910839, "body": "That was <a href=\"https://en.wikipedia.org/w/index.php?title=Haskell_(programming_language)&amp;diff=733757128&amp;oldid=732884393\" rel=\"nofollow noreferrer\">only quite recently added to Wikipedia</a>, and the reason given is that \u201cthe official wiki states it\u201d... but without a concrete reference. <a href=\"https://wiki.haskell.org/Introduction\" rel=\"nofollow noreferrer\">The HaskellWiki main article says no such thing</a>. I think this addition is just wrong and the Wikipedia article should be backrolled, any opinions?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1812457"}, "edited": false, "score": 1, "creation_date": 1492262424, "post_id": 43426155, "comment_id": 73910932, "body": "Things are never black and white. Your question reminds me of <a href=\"http://68.media.tumblr.com/tumblr_lyiqu5VFK71qz6f4bo2_500.jpg\" rel=\"nofollow noreferrer\">this great cartoon by Larsson</a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1812457"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1492262555, "post_id": 43426155, "comment_id": 73910981, "body": "@leftaroundabout It would be very disingenuous to claim that Haskell is <b>definitely not</b> an imperative programming language, don&#39;t you think?"}, {"owner": {"reputation": 531, "user_id": 4801466, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-LKQUV9yTvkc/AAAAAAAAAAI/AAAAAAAAABM/3umg80-LeJM/photo.jpg?sz=128", "display_name": "Iv&#225;n Cort&#233;s Romero", "link": "https://stackoverflow.com/users/4801466/iv%c3%a1n-cort%c3%a9s-romero"}, "edited": false, "score": 0, "creation_date": 1492263247, "post_id": 43426155, "comment_id": 73911192, "body": "@Boris I am learning functional languages, said Lisp or Erlang. Maybe I am thinking as you noticed with cartoon. But, how should I enrolled this paradigm, if almost each languages can have an <i>imperative</i> order in its sentences?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1812457"}, "edited": false, "score": 1, "creation_date": 1492263416, "post_id": 43426155, "comment_id": 73911245, "body": "Your English is a bit unconventional; anyway, keep on reading and learning and very importantly <i>writing code</i>, and things will slowly become less absolute."}, {"owner": {"reputation": 531, "user_id": 4801466, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-LKQUV9yTvkc/AAAAAAAAAAI/AAAAAAAAABM/3umg80-LeJM/photo.jpg?sz=128", "display_name": "Iv&#225;n Cort&#233;s Romero", "link": "https://stackoverflow.com/users/4801466/iv%c3%a1n-cort%c3%a9s-romero"}, "edited": false, "score": 0, "creation_date": 1492264007, "post_id": 43426155, "comment_id": 73911435, "body": "Sorry and thanks for your advice!"}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1492266060, "post_id": 43426155, "comment_id": 73912105, "body": "@Boris &quot;Imperative&quot; and &quot;declarative&quot; are just terms used to classify languages, more by a general feel than by any really hard precise meaning. If you end up calling Haskell &quot;an imperative language&quot; (as opposed to calling some particular Haskell programs imperative), you&#39;ve pretty much broadened the term so much it applies to any language, and so isn&#39;t a very useful classification."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1492266741, "post_id": 43426155, "comment_id": 73912338, "body": "@Boris no, I don&#39;t think that would be disingenuous, since the Haskell language itself includes <i>nothing</i> that actually can be used for doing anything imperative. What&#39;s true is, the Haskell base library includes a standard type (<code>IO</code>) whose values can be understood as imperative programs... but then, C includes a <code>char</code> type and arrays of chars can be understood Prolog programs. Still it wouldn&#39;t be disingenuous to say that C is <i>definitely not a logic programming language</i>."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1492267878, "post_id": 43426155, "comment_id": 73912709, "body": "@leftaroundabout Indeed. I have just undone the change at Wikipedia."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1812457"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1492271269, "post_id": 43426155, "comment_id": 73913981, "body": "@leftaroundabout I know that Haskellers get quite excited when it comes to classifying things. It might have to do something with the type system; I can&#39;t know this for sure of course."}, {"owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "edited": false, "score": 3, "creation_date": 1492298794, "post_id": 43426155, "comment_id": 73922231, "body": "I think an important question is... &quot;why is this question important?&quot;! That&#39;s to say, what is the questioner really asking here, and why do they want to know it? Haskell is declarative. Computer programs are, though, by definition imperative. The Haskell language has some things that look like sequenced commands, but they&#39;re really declarations of expressions <i>about</i> commands, and only get turned into imperative code by the compiler later. An action like <code>putStrLn &quot;hi&quot;</code> is not a command, and doesn&#39;t <i>do</i> anything. This might be helpful: <a href=\"http://www.happylearnhaskelltutorial.com/1/main_road.html\" rel=\"nofollow noreferrer\">happylearnhaskelltutorial.com/1/main_road.html</a>"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "edited": false, "score": 0, "creation_date": 1500024138, "post_id": 43426155, "comment_id": 77170107, "body": "@JulianLeviston when you talk to a compiler about printing, you still intend for stuff to get printed. If you talk about a mutable cell getting a new value, you intend for it to get a new value. C code can be viewed as us talking to a C compiler just as well. Monads are <i>embedded</i> DSLs, so any monadic code <i>is</i> part of Haskell by definition, especially for &quot;standard&quot; monads. Haskell is really two languages, functional and imperative at the same time, they are just well separated. And if Haskell <i>were</i> declarative, <code>null</code> would be <i>The Same</i> as <code>((==0).length)</code>. But it isn&#39;t."}, {"owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1500028313, "post_id": 43426155, "comment_id": 77172687, "body": "@WillNess I&#39;m not sure why you think they&#39;d be the same thing. Haskell <b>is</b> declarative. You write programs by declaring definitions for terms, and Haskell builds an executable based on your declarations. That its type system doesn&#39;t capture the shape of the computation fully is largely irrelevant. The semantics you encode when writing programs <b>are</b>, <i>nevertheless</i> encoded in declarative definitions."}], "answers": [{"comments": [{"owner": {"reputation": 531, "user_id": 4801466, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-LKQUV9yTvkc/AAAAAAAAAAI/AAAAAAAAABM/3umg80-LeJM/photo.jpg?sz=128", "display_name": "Iv&#225;n Cort&#233;s Romero", "link": "https://stackoverflow.com/users/4801466/iv%c3%a1n-cort%c3%a9s-romero"}, "edited": false, "score": 0, "creation_date": 1492262233, "post_id": 43426291, "comment_id": 73910880, "body": "Having this, is difficult for me thinking in a language programming which has no a imperative way. Despite this, wikipedia describe Haskell as <code>purely functional programming</code>, how this goes with your answer?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1492262505, "post_id": 43426291, "comment_id": 73910961, "body": "There is indeed some truth to \u201cHaskell is the best imperative language\u201d, but it&#39;s obviously meant ironically. I&#39;d say Haskell itself is declarative through and through, not imperative at all; only <code>IO</code> and <code>ST</code> are imperative eDSLs which happen to be easily described (declaratively!) in Haskell."}, {"owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "edited": false, "score": 0, "creation_date": 1492263154, "post_id": 43426291, "comment_id": 73911161, "body": "I don&#39;t think it&#39;s difficult. Haskell is both. When you assign a value to <code>main</code> (the entry point of a Haskell program), you&#39;re describing \u2014 declaratively \u2014 what the program should do when executed. You&#39;re not giving the compiler statements, you&#39;re giving it declarations. However, those declarations can be written in a sequenced way. If you use <code>do</code> syntax to connect up and &quot;sequence&quot; three <code>printLn</code> expressions, then you&#39;re telling the Haskell compiler to build a single expression out of them, in sequence. While actually declarative in truth, it&#39;s imperative in effect."}, {"owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "edited": false, "score": 0, "creation_date": 1492263597, "post_id": 43426291, "comment_id": 73911303, "body": "The difference is like between say me giving you a list of instructions where you&#39;ve agreed to perform each instruction one after another, versus giving you a list of values and expressions in any order some of which use other values and expressions, and a single instruction saying &quot;do this thing&quot; (which happens to use all the other expressions). Haskell is not imperative. However, to the end programmer programming with <code>IO</code>, it can sure seem like it sometimes (and it really helps to know your program is mostly type-safe, and using immutable data because it keeps lots of simple errors out)."}], "tags": [], "owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "is_accepted": true, "score": 0, "last_activity_date": 1492260749, "creation_date": 1492260749, "answer_id": 43426291, "question_id": 43426155, "link": "https://stackoverflow.com/questions/43426155/is-haskell-an-imperative-or-declarative-paradigm/43426291#43426291", "title": "Is Haskell an imperative or declarative paradigm?", "body": "<p>Functional languages generally use a declarative methodology when describing their programs, and Haskell is definitely one of these languages; Haskell programs are described as a set of declarations of values (including functions, because functions are first class values).</p>\n\n<p>However, in order for a computer to execute a program, it has to follow a sequence of instructions. To that end, Haskell has a way you can describe what can end up as sequencing when it's executed, in a special syntax (called \"do syntax\"). Each line of this syntax looks like the next \"statement\" in a normal imperative language, and kind of behaves that way, too. Really, though, it's just syntactic sugar for ordinary Haskell expressions of function application.</p>\n\n<p>Because it's still written in Haskell, though, and Haskell values and expressions are for the most part typesafe, Haskell is often called \"the best imperative language\".</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1812457"}, "is_accepted": false, "score": 1, "last_activity_date": 1492261409, "creation_date": 1492261409, "answer_id": 43426378, "question_id": 43426155, "link": "https://stackoverflow.com/questions/43426155/is-haskell-an-imperative-or-declarative-paradigm/43426378#43426378", "title": "Is Haskell an imperative or declarative paradigm?", "body": "<p>As long as changing the order of the atomic parts of a program can change its output, you can safely smack \"imperative\" on the language. Almost any high-level language is \"declarative\" in some way, and there are languages that support \"declarative programming\" better than Haskell does.</p>\n\n<p>In C, for example, <code>enum</code>s and even the <code>switch</code> can be \"declarative\", if you use it in a certain way. Much further in the \"declarative\" direction is Prolog, and you could write programs in a declarative style, but again, you can also use Prolog to write an imperative program.</p>\n"}], "owner": {"reputation": 531, "user_id": 4801466, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-LKQUV9yTvkc/AAAAAAAAAAI/AAAAAAAAABM/3umg80-LeJM/photo.jpg?sz=128", "display_name": "Iv&#225;n Cort&#233;s Romero", "link": "https://stackoverflow.com/users/4801466/iv%c3%a1n-cort%c3%a9s-romero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 943, "favorite_count": 0, "accepted_answer_id": 43426291, "answer_count": 2, "score": -3, "last_activity_date": 1509871011, "creation_date": 1492259828, "question_id": 43426155, "link": "https://stackoverflow.com/questions/43426155/is-haskell-an-imperative-or-declarative-paradigm", "title": "Is Haskell an imperative or declarative paradigm?", "body": "<p>I have read some sources where the Haskell's paradigm is described as <code>functional</code> but <code>imperative</code> paradigm. The main source where this is said is <a href=\"https://en.wikipedia.org/wiki/Haskell_(programming_language)\" rel=\"nofollow noreferrer\">Wikipedia</a>. How is possible a <code>functional</code> and <code>imperative</code> paradigm at the same time, or is this a mistake?  </p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 7253589, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fd9a2b638a27d347e2232fdb495cabd0?s=128&d=identicon&r=PG&f=1", "display_name": "JoeDonald", "link": "https://stackoverflow.com/users/7253589/joedonald"}, "edited": false, "score": 0, "creation_date": 1492254466, "post_id": 43425239, "comment_id": 73908661, "body": "Thank you for the answer. Can you tell me what is &quot;ap&quot;?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 115, "user_id": 7253589, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fd9a2b638a27d347e2232fdb495cabd0?s=128&d=identicon&r=PG&f=1", "display_name": "JoeDonald", "link": "https://stackoverflow.com/users/7253589/joedonald"}, "edited": false, "score": 0, "creation_date": 1492254631, "post_id": 43425239, "comment_id": 73908705, "body": "@JoeDonald You can use <a href=\"http://haskell.org/hoogle\" rel=\"nofollow noreferrer\">Hoogle</a> to find <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Monad.html#v:ap\" rel=\"nofollow noreferrer\">the documentation for <code>ap</code></a>. With the reader monad, <code>ap :: (e -&gt; a -&gt; b) -&gt; (e -&gt; a) -&gt; (e -&gt; b)</code>, which allows you to pass a single argument to two sub-functions. That is, <code>ap f g x</code> is <code>f x (g x)</code>, which passes <code>x</code> to both <code>f</code> and <code>g</code>. So when a given argument is duplicated on the RHS of an equation, <code>?pl</code> will often reply with a term that mentions <code>ap</code>."}, {"owner": {"reputation": 115, "user_id": 7253589, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fd9a2b638a27d347e2232fdb495cabd0?s=128&d=identicon&r=PG&f=1", "display_name": "JoeDonald", "link": "https://stackoverflow.com/users/7253589/joedonald"}, "edited": false, "score": 0, "creation_date": 1492255518, "post_id": 43425239, "comment_id": 73908958, "body": "Thanks for help, I was just curious."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 3, "last_activity_date": 1492254831, "last_edit_date": 1492254831, "creation_date": 1492254114, "answer_id": 43425239, "question_id": 43424777, "link": "https://stackoverflow.com/questions/43424777/adding-two-complex-numbers-in-haskell/43425239#43425239", "title": "Adding two complex numbers in Haskell", "body": "<p>Yup:</p>\n\n<pre><code>addC = ap (ap . (C .) . (. realC) . (+) . realC) ((. imgC) . (+) . imgC)\n</code></pre>\n\n<p>Obviously I do not recommend this. You can learn this yourself by asking lambdabot to point-free-ify things in the #haskell IRC channel, or download and use it yourself <a href=\"http://hackage.haskell.org/package/lambdabot\" rel=\"nofollow noreferrer\">from Hackage</a>. This is the command I ran to get the above definition:</p>\n\n<pre><code>?pl addC l r = C (realC l + realC r) (imgC l + imgC r)\n</code></pre>\n\n<p>However, when doing it by hand, it is often possible to make more readable results. For example:</p>\n\n<pre><code>addC = liftA2 (liftA2 C) ((+) `on` realC) ((+) `on` imgC)\n</code></pre>\n\n<p>Even with this somewhat decipherable version, I would still strongly prefer the code you wrote; your code is simple, it's blazingly obvious what it does, and that style makes it hard to get the code wrong.</p>\n"}], "owner": {"reputation": 115, "user_id": 7253589, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/fd9a2b638a27d347e2232fdb495cabd0?s=128&d=identicon&r=PG&f=1", "display_name": "JoeDonald", "link": "https://stackoverflow.com/users/7253589/joedonald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 724, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1492254831, "creation_date": 1492251091, "question_id": 43424777, "link": "https://stackoverflow.com/questions/43424777/adding-two-complex-numbers-in-haskell", "title": "Adding two complex numbers in Haskell", "body": "<p>I made the adding of two complex numbers in Haskell like this:</p>\n\n<pre><code>data Complex = C\n{ realC :: Double\n, imgC  :: Double\n} deriving Show\n\n\naddC :: Complex -&gt; Complex -&gt; Complex\naddC (C a b) (C c d)= C (a+c) (b+d)\n</code></pre>\n\n<p>My question is: Can i make the above function (addC) point-free? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1492261705, "post_id": 43422052, "comment_id": 73910749, "body": "Any potential answer would depend entirely on how you have chosen to represent Haskell terms and types; unless you are building your own Haskell typechecker as well (which you would have to do to somehow make this based on <code>Dynamic</code>), the same representation used by the GHC api would probably be an obvious choice. The GHC api would also allow you to lookup declarations based on type. After that, the answer to your 2nd question depends entirely on how hard you want your editor to try to find a potential answer (do you try to unify the target type with every declaration in scope? probably not)"}, {"owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1492262363, "post_id": 43422052, "comment_id": 73910912, "body": "I&#39;m using <code>Language.Haskell.Exts</code>, sorry if I didn&#39;t make that clear enough. This <i>is</i> the GHCI API representation. (Assuming I&#39;m understanding what you mean by the GHC API). I&#39;m not basing it on <code>Dynamic</code>, I just thought maybe <code>Dynamic</code> would let me grab a whole bunch of expressions and/or functions in a list (because that&#39;s the easiest way to have a heterogenous list). Yeah, I&#39;d like to unify the target type with every declaration in scope if possible, &quot;closest&quot; scopes first. <i>update</i>: sorry, now I see you mean the GHC package. Sorry and thanks."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1492268200, "post_id": 43422052, "comment_id": 73912812, "body": "To be clear, I mean <a href=\"https://downloads.haskell.org/~ghc/8.0.2/docs/html/libraries/ghc-8.0.2/index.html\" rel=\"nofollow noreferrer\">the GHC API</a>. The reason I said &#39;probably not&#39; is because unifying two random types which happen to be in scope is not likely to succeed, but can be very expensive; this could really harm the usability of your program. No program (IDE, typechecker) I know of does a perfect job of this, for any language with a rich type system, so if you should look to examples of such to figure out precisely what kind of functionality you want to attain (it is an entirely non-trivial problem!)"}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 0, "creation_date": 1492287551, "post_id": 43422052, "comment_id": 73919527, "body": "This is a very long and quite abstract question. Would it be possible to narrow it down to a concrete example? This usually helps a lot to get attention and specific solutions. See also <a href=\"http://sscce.org/\" rel=\"nofollow noreferrer\">Short, Self Contained, Correct Example</a> and <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a>."}, {"owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "reply_to_user": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 0, "creation_date": 1492296474, "post_id": 43422052, "comment_id": 73921828, "body": "Thanks @PetrPudl&#225;k I agree it&#39;s annoying. However, not all questions are short, and this problem is also actually quite abstract in nature. Believe it or not, <i>this</i> actually <i>is</i> more concrete than the actual problem I&#39;m trying to solve. I might close it. user2407038 has pointed me in a good direction, which is what I was after more than anything. Part of the problem there is I don&#39;t want to lead anyone to a particular solution, and my problem is not specifically concrete. WDYT? What should I do?"}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 0, "creation_date": 1492428659, "post_id": 43422052, "comment_id": 73956691, "body": "@JulianLeviston I understand. Approaching a very general problem with an unclear solution might be an overwhelming task with unexpected blockers. I&#39;d suggest to try to solve a more specific case and then iterating to the more general one. For example, as user2407038 suggests, an important thing is how you represent your terms and types. I&#39;d try to pick one and try to work with it. If there will be a problem, you&#39;ll know what else representation to choose and why. Similarly, you can start with a simpler language, perhaps the Hindley-Milner type system, and then extend it later to Haskell."}, {"owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "edited": false, "score": 0, "creation_date": 1492431190, "post_id": 43422052, "comment_id": 73957945, "body": "Yep. Classic divide and conquer (I&#39;m by no means a software development beginner, by the way). I <i>am</i> trying to solve a specific case. I built a small toy grammar and a few functions, but it&#39;s the same problem. It&#39;s irrelevant how I represent types. The things that were &quot;blocking&quot; me were primarily &quot;how to get a list of top level declarations&quot; which I&#39;ve found out how to do using <code>hint</code>, and secondarily &quot;how to filter those declarations based on their result value type&quot;. Not sure how to do the second one, but I&#39;ll find out, or ask again more simply in another question."}], "answers": [{"tags": [], "owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "is_accepted": true, "score": 0, "last_activity_date": 1492388290, "creation_date": 1492388290, "answer_id": 43443526, "question_id": 43422052, "link": "https://stackoverflow.com/questions/43422052/function-searching-for-applicable-types-for-applying-to-lensed-pieces-of-haskell/43443526#43443526", "title": "Function searching for applicable types for applying to Lensed pieces of Haskell AST", "body": "<p>Looks like I kind of answered my own questions, so I'm going to do so formally here.</p>\n\n<p>The answer to the first part of my question can be found in the <code>Reflection</code> module of the <code>hint</code> library. I knew I could get a list a <code>[String]</code> of these modules, but there's a function in there that can be used which has type: <code>getModuleExports :: MonadInterpreter m =&gt; ModuleName -&gt; m [ModuleElem]</code> and is most likely the sort of thing I'm after. This is because <code>hint</code> provides access to a large part of the GHC API. It also provides some lookup functions which I can then use to get the types of these top level terms.</p>\n\n<p><a href=\"https://github.com/mvdan/hint/blob/master/src/Hint/Reflection.hs#L30\" rel=\"nofollow noreferrer\">https://github.com/mvdan/hint/blob/master/src/Hint/Reflection.hs#L30</a></p>\n\n<p>Also, Template Haskell provides <em>some</em> of the functionality I'm interested in, and I'll probably end up using quite a bit of that to build my functions, or at least a set of lenses for whatever syntax is being used by the code (/text) under consideration.</p>\n\n<p>In terms of the second part of the question, I still don't have a particularly good answer, so my first attempt will be to use some <code>String</code> munging on the output of the lookup functions and see what I can do.</p>\n"}], "owner": {"reputation": 1589, "user_id": 2535671, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/fca1ba52e0c41803e676d449ef242e75?s=128&d=identicon&r=PG&f=1", "display_name": "Julian Leviston", "link": "https://stackoverflow.com/users/2535671/julian-leviston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 43443526, "answer_count": 1, "score": -2, "last_activity_date": 1492388290, "creation_date": 1492228751, "last_edit_date": 1492387945, "question_id": 43422052, "link": "https://stackoverflow.com/questions/43422052/function-searching-for-applicable-types-for-applying-to-lensed-pieces-of-haskell", "title": "Function searching for applicable types for applying to Lensed pieces of Haskell AST", "body": "<p>My primary queston is: <strong>is there, within some Haskell AST, a way I can determine a list of the available declarations, and their types</strong>? I'm trying to build an editor that allows for the user to be shown all the appropriate edits available, such as inserting functions and/or other declared values that can be used or inserted at any point. It'll also disallows syntax errors as well as type-errors. (That is, it'll be a semantic structural editor, which I'll also use the typechecker to make sure the editing pieces make sense to in this case, Haskell).</p>\n\n<p>The second part of my question is: once I have that list, given a particular expression or function or focussed-on piece of AST (using <code>Lens</code>), how could I filter the list based on what could possibly replace or fit that particular focussed-on AST piece (whether by providing arguments to a function, or if it's a value, just \"as-is\"). Perhaps I need to add some concrete example here... something like: \"Haskell, which declarations could possibly be applied (for functions) and/or placed into the hole at <code>yay x y z = (x + y - z) * _</code>?\" then if there was an expression <code>number2 :: Num a =&gt; a ; number2 = 23</code> it would put this in the list, as well as the functions available in the context, as well as those from <code>Num</code> itself such as <code>(+) :: Num a =&gt; a -&gt; a -&gt; a</code>, <code>(*) :: Num a =&gt; a -&gt; a -&gt; a</code>, and any other declarations that resulted in a type that would match such as <code>Num a =&gt; a</code> etc. etc.</p>\n\n<p>More details follow:</p>\n\n<p>I\u2019ve done a fair bit of research into this area over quite a long time: looked at and used <code>hint</code>, <code>Language.Haskell.Exts</code> and <code>Control.Lens</code> a fair bit. Also had a look into <code>Dynamic</code>. <code>Control.Lens</code> is relevant for the second half of my question. I've also looked at quite a few projects along the way including Conal Elliott's \"Semantic Editing Combinators\", Paul Chiusano's Unison system and quite a few things in Clojure and Lisp as well.</p>\n\n<p>So, I know I can get a list of the exports of a module with hint as <code>[String]</code>, and I could coerce that to <code>[Dynamic]</code>, I think (possibly?), but I\u2019m not sure how I\u2019d get <em>sub-function</em> declarations and their types. (Maybe I could take the declarations within that scope with AST and put them in their own modules in a String and pull them in by getting the top level declarations with hint? that would work but feels hacky and cumbersome)</p>\n\n<p>I can use <code>(:~:)</code> from <code>Data.Typeable</code> to do \"propositional equality\" (ie typechecking?) on two terms, but what I actually need to do is see if a term could be matched into a position in the source/AST (I'm using lenses and prisms to focus on those parts of the AST) given some number of arguments. Some kind of partial type-checking, or result type-checking? Because the thing I might be focussing on could very well be a function, and I might need to keep the same arity.</p>\n\n<p>I feel like perhaps this is very similar to Idris' term-searching, though I haven't looked into the source for that and I'm not sure if that's something only possible in a dependently typed language.</p>\n\n<p>Any help would be great.</p>\n"}, {"tags": ["haskell", "pretty-print"], "answers": [{"comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1492273869, "post_id": 43427269, "comment_id": 73914787, "body": "Thank you very much! This is really an amazing answer/explanation."}], "tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": true, "score": 3, "last_activity_date": 1492289503, "last_edit_date": 1492289503, "creation_date": 1492266759, "answer_id": 43427269, "question_id": 43421147, "link": "https://stackoverflow.com/questions/43421147/pretty-printing-javascript-objects/43427269#43427269", "title": "Pretty-printing JavaScript objects", "body": "<p>The pretty print library you are using can already do this; (you have just told it to do a different thing!) generally this family (WL) of pretty printers handles this case pretty well. </p>\n\n<p>Note the positioning of your <code>Union</code>:</p>\n\n<pre><code>prettyObject (Object fields) = Union &lt;one line&gt; &lt;many line&gt;\n</code></pre>\n\n<p>At the point in your text where you are logically making the choice to break, which is at the beginning of a key-value pair, you don't have a <code>Union</code> in your <code>Doc</code> structure. The choice is made at the point where a <code>{..}</code> enclosed block begins; and if you scrutinize the output, that is exactly what it gives you:</p>\n\n<pre><code>{ key5: { key1: \"val1\" }, key6: { ----- line break here\n  key2: \"val2\",\n</code></pre>\n\n<p>You need a function to implement your desired logic for key-value pairs: </p>\n\n<pre><code>indent' k x = flatAlt (indent k x) (flatten x) \nprettyKVPair (k,v) = indent' 2 $ text k &lt;&gt; \":\" &lt;+&gt; pretty v\n</code></pre>\n\n<p><code>indent'</code> is like <code>indent</code>, but provides an explicit alternative which is not indented. <code>flatAlt</code> provides an alternative which is used when the text is flattened, and your text will be flattened by (you may have guessed) <code>flatten</code>. You also need to re-structure <code>prettyObject</code> accordingly: </p>\n\n<pre><code>prettyObject :: Object -&gt; Doc a \nprettyObject (Object fields) = sep $ \"{\" : fields' ++ [ \"}\" ] where \n  fields' = punctuate \",\" $ map prettyKVPair fields\n...\n</code></pre>\n\n<p>Note there is no explicit <code>Union</code>, but <code>sep = group . vsep</code> and <code>group = \\x -&gt; Union (flatten x) x</code>. You now have a union corresponding to logical choices about where you flatten your text. </p>\n\n<p>The result: </p>\n\n<pre><code>&gt;pretty o1\n{ key1: \"val1\" }\n&gt;pretty o2\n{\n  key2: \"val2\",\n  looooooooooong key3: \"loooooooooooong val3\",\n  key4: \"val4\"\n}\n&gt;pretty o3\n{\n  key5: \"val5\",\n  key6: {\n    key2: \"val2\",\n    looooooooooong key3: \"loooooooooooong val3\",\n    key4: \"val4\"\n  },\n  key7: \"val7\"\n}\n</code></pre>\n\n<hr>\n\n<p>In response to the question in the comment, the way to provide a flat alternative is to use <code>flatAlt</code>, of course! The only issue here is you want to do this for a single element (the last one) of a list - but this is an issue with lists, not <code>Doc</code>. Feel free to use <code>Data.Sequence</code> or any other <code>Traversable</code>, with which most of the 'list-like' functions like <code>punctuate</code> work, if this is an operation you need a lot.</p>\n\n<pre><code>flattenedOf a b = flatAlt a (flatten b) # useful combinator\n\ntrailingSep _ [] = [] \ntrailingSep s xs = as ++ [ (a &lt;&gt; s) `flattenedOf` a ]\n  where as = init xs; a = last xs \n\n...\nprettyObject (Object fields) = &lt;unchanged&gt; where \n  fields' = trailingSep \",\" $ &lt;unchanged&gt;\n</code></pre>\n"}], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 3, "accepted_answer_id": 43427269, "answer_count": 1, "score": 4, "last_activity_date": 1492289503, "creation_date": 1492218759, "last_edit_date": 1492227429, "question_id": 43421147, "link": "https://stackoverflow.com/questions/43421147/pretty-printing-javascript-objects", "title": "Pretty-printing JavaScript objects", "body": "<p>I've chosen to center this question around JSON objects and <a href=\"https://hackage.haskell.org/package/wl-pprint-annotated\" rel=\"nofollow noreferrer\">wl-pprint-annotated</a> (<a href=\"http://homepages.inf.ed.ac.uk/wadler/papers/prettier/prettier.pdf\" rel=\"nofollow noreferrer\">here is the paper behind that library</a>) because they make it easy to have an MVCE, but my problem is not actually around pretty-printing <em>just</em> JSON objects and I am flexible for which pretty-printing library I use.</p>\n\n<hr>\n\n<p>Consider the following simplified JavaScript object data type:</p>\n\n<pre><code>data Object = Object [(String, Object)]\n            | String String\n</code></pre>\n\n<p><strong>How can I defined a pretty-printing function that wraps its output to multiple lines in the usual way?</strong> What I mean by that is: the pretty-printed output should, whenever possible fit on one line. When that is not possible, I expect the outermost objects to start adding newlines before the inner ones.</p>\n\n<p>Here is one attempt using <a href=\"https://hackage.haskell.org/package/wl-pprint-annotated\" rel=\"nofollow noreferrer\">wl-pprint-annotated</a>:</p>\n\n<pre><code>{-# LANGUAGE OverloadedString #-}\nimport Text.PrettyPrint.Annotated.WL\n\nprettyObject :: Object -&gt; Doc a \nprettyObject (String str) = \"\\\"\" &lt;&gt; text str &lt;&gt; \"\\\"\"\nprettyObject (Object fields) = Union (\"{\" &lt;+&gt; hsep fields' &lt;+&gt; \"}\")\n                                     (\"{\" &lt;#&gt; indent 2 (vsep fields') &lt;#&gt; \"}\")\n\n   where\n     fields' :: [Doc a]\n     fields' = punctuate \",\" [ text key &lt;&gt; \":\" &lt;+&gt; prettyObject val\n                             | (key,val) &lt;- fields ]\n</code></pre>\n\n<p>Now, some test cases.</p>\n\n<pre><code>ghci&gt; o1 = Object [(\"key1\", String \"val1\")]\nghci&gt; o2 = Object [(\"key2\", String \"val2\"), (\"looooooooooong key3\", String \"loooooooooooong val3\"),(\"key4\", String \"val4\")]\nghci&gt; o3 = Object [(\"key5\", String \"val5\"), (\"key6\", o2), (\"key7\", String \"val7\")]\nghci&gt; prettyObject o1\n{ key1: \"val1\" }\nghci&gt; prettyObject o2\n{\n  key2: \"val2\",\n  looooooooooong key3: \"loooooooooooong val3\",\n  key4: \"val4\"\n}\nghci&gt; prettyObject o3\n{ key5: { key1: \"val1\" }, key6: {\n  key2: \"val2\",\n  looooooooooong key3: \"loooooooooooong val3\",\n  key4: \"val4\"\n}, key7: \"val7\" }\n</code></pre>\n\n<p>I would like the last output to instead be</p>\n\n<pre><code>{\n  key5: { key1: \"val1\" },\n  key6: {\n    key2: \"val2\",\n    looooooooooong key3: \"loooooooooooong val3\",\n    key4: \"val4\"\n  },\n  key7: \"val7\"\n}\n</code></pre>\n\n<p>I am looking for a solution which somehow fits with one of the existing pretty-printing libraries in Haskell (in reality, I'm pretty-printing <em>much</em> more than just a subset of JSON).</p>\n\n<p>I am <em>not</em> looking for a solution which defines a <code>prettyObject :: Object -&gt; String</code> - the whole point of this approach is that the rendering of the <code>Doc</code> depends on where it is in the big picture of what is being pretty-printed.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 5, "creation_date": 1492217402, "post_id": 43420946, "comment_id": 73901019, "body": "You should not be trying to pattern match on types.  If you want to make a function like <code>map (+k)</code> operate only over a particular set of types then give it a suitable type constraint."}, {"owner": {"reputation": 537, "user_id": 7869621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd1e52c50a93fb4403a9dd0d2192276?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/7869621/rob"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1492229618, "post_id": 43420946, "comment_id": 73903012, "body": "Good point! thanks"}], "answers": [{"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 4, "creation_date": 1492218085, "post_id": 43421077, "comment_id": 73901135, "body": "It is worth mentioning that, if the OP doesn&#39;t literally need it to accept <code>Int</code> and <code>Integer</code> <i>and nothing else</i>, plain old <code>Integral</code> will likely be enough."}], "tags": [], "owner": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "is_accepted": false, "score": 1, "last_activity_date": 1492217861, "creation_date": 1492217861, "answer_id": 43421077, "question_id": 43420946, "link": "https://stackoverflow.com/questions/43420946/excluding-types-in-haskell/43421077#43421077", "title": "Excluding Types in Haskell", "body": "<p>You can create a dumb type class with instances only for <code>Int</code> and <code>Integer</code> and then use a type constraint:</p>\n\n<pre><code>class (Num a) =&gt; IntOrInteger a\ninstance IntOrInteger Int\ninstance IntOrInteger Integer\n\nf :: (IntOrInteger a) =&gt; [a] -&gt; a -&gt; [a]\nf list k =\n    if null list\n    then []\n    else head list + k : f (tail list) k\n</code></pre>\n\n<p>Then if you use <code>f</code> with <code>Int</code>, it will compile:</p>\n\n<pre><code>&gt; f [1,2,3] 1\n[2,3,4]\n</code></pre>\n\n<p>But it will not compile with <code>Double</code>:</p>\n\n<pre><code>&gt; f [1,2,3] (1::Double)\n\n&lt;interactive&gt;:19:1: error:\n    * No instance for (IntOrInteger Double) arising from a use of `f'\n    * In the expression: f [1, 2, 3] (1 :: Double)\n      In an equation for `it': it = f [1, 2, 3] (1 :: Double)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1492228508, "post_id": 43421354, "comment_id": 73902816, "body": "<code>Integral</code> includes <code>Integer</code>, <code>Natural</code>, <code>Int</code>, <code>Int8</code>, <code>Int16</code>, <code>Int32</code>, <code>Int64</code>, <code>Word</code>, <code>Word8</code>, <code>Word16</code>, <code>Word32</code>, and <code>Word64</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6428287"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1492229176, "post_id": 43421354, "comment_id": 73902942, "body": "@dfeuer Absolutely, there&#39;s a complete list of the <code>Integral</code> data types at the link. But I believe <code>Integral</code> is the floating-exclusive constrain OP was looking for. I don&#39;t think a new type class definition makes sense in this context."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1492229263, "post_id": 43421354, "comment_id": 73902959, "body": "I agree with your general approach; I just disagree with the details, especially since we have <code>Natural</code> now."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6428287"}, "is_accepted": false, "score": 3, "last_activity_date": 1503243993, "last_edit_date": 1503243993, "creation_date": 1492221044, "answer_id": 43421354, "question_id": 43420946, "link": "https://stackoverflow.com/questions/43420946/excluding-types-in-haskell/43421354#43421354", "title": "Excluding Types in Haskell", "body": "<p><code>f</code>/<code>mapAdd</code> implements a <code>map</code>. <code>map</code> is</p>\n\n<pre><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]\nmap _ []       = []\nmap f (x : xs) = f x : map f xs\n</code></pre>\n\n<p>and can be used to formulate <code>mapAdd</code>:</p>\n\n<pre><code>Prelude&gt; mapAdd n  =  map (+ n)\nPrelude&gt; mapAdd 3 [1,2,3,4]\n[4,5,6,7]\n</code></pre>\n\n<p>GHCi's <code>:type</code> command tells you the automatically inferred type signature of <code>mapAdd</code>:</p>\n\n<pre><code>Prelude&gt; :type mapAdd\nmapAdd :: Num b =&gt; b -&gt; [b] -&gt; [b]\n</code></pre>\n\n<p>Here, <code>mapAdd</code>'s <code>b</code>s are constrained to the general numerical <em>type class</em> <code>Num</code>. You can explicitly constrain to the type class <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Prelude.html#t:Integral\" rel=\"nofollow noreferrer\"><code>Integral</code></a>, which (basically) exclusively contains the data types <code>Int</code>, and <code>Integer</code>. <code>Integral</code> is a <em>subclass</em> of <code>Num</code>.</p>\n\n<pre><code>Prelude&gt; :{\nPrelude| mapAdd :: Integral a =&gt; a -&gt; [a] -&gt; [a]\nPrelude| mapAdd n  =  map (+ n)\nPrelude| :}\nPrelude&gt; :t mapAdd\nmapAdd :: Integral a =&gt; a -&gt; [a] -&gt; [a]\n</code></pre>\n\n<hr>\n\n<p><code>mapAdd n  =  map (+ n)</code> is <em>pointfree</em> for <code>mapAdd n lst = map (+ n) lst</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 3, "last_activity_date": 1492307514, "last_edit_date": 1492307514, "creation_date": 1492230985, "answer_id": 43422237, "question_id": 43420946, "link": "https://stackoverflow.com/questions/43420946/excluding-types-in-haskell/43422237#43422237", "title": "Excluding Types in Haskell", "body": "<p>As suchtgott explained, you should not actually try to limit your function to exactly <code>Int</code> and <code>Integer</code>; you probably want to use an <code>Integral</code> constraint.</p>\n\n<p>Suppose, for fun, that you really did want to limit it just like that. The way to do this in Haskell 98 is a bit weird (jump down to the break to see how this is done in GHC Haskell:</p>\n\n<pre><code>class Integral a =&gt; IntOrInteger a where\n  intOrInteger :: Either (f a -&gt; f Int) (f a -&gt; f Integer)\ninstance IntOrInteger Int where\n  intOrInteger = Left id\ninstance IntOrInteger Integer where\n  intOrInteger = Right id\n</code></pre>\n\n<p>How do you use such a thing? Well, to start off with</p>\n\n<pre><code>intOrIntegerSimple :: IntOrInteger a =&gt; Either (a -&gt; Int) (a -&gt; Integer)\nintOrIntegerSimple = case intOrInteger of\n  Left f -&gt; Left (runIdentity . f . Identity)\n  Right f -&gt; Right (runIdentity . f . Identity)\n</code></pre>\n\n<p>But how do you flip it around, and turn an <code>Int</code> or <code>Integer</code> back to an instance of <code>IntOrInteger</code>?</p>\n\n<pre><code>newtype Switch f a i = Switch {runSwitch :: f i -&gt; f a}\n\nintOrInteger' :: IntOrInteger a =&gt; Either (f Int -&gt; f a) (f Integer -&gt; f a)\nintOrInteger' = case intOrInteger of\n                  Left f -&gt; Left (runSwitch (f (Switch id)))\n                  Right f -&gt; Right (runSwitch (f (Switch id)))\n\nintOrIntegerSimple' :: IntOrInteger a =&gt; Either (Int -&gt; a) (Integer -&gt; a)\nintOrIntegerSimple' = case intOrInteger' of\n  Left f -&gt; Left (runIdentity . f . Identity)\n  Right f -&gt; Right (runIdentity . f . Identity)\n</code></pre>\n\n<p>When you don't really care whether you have an <code>Int</code> or an <code>Integer</code>, but want to be sure you really have one of them, you have to watch out for invalid instances. What might an invalid instance look like? This is one option:</p>\n\n<pre><code>instance IntOrInteger Word where\n  intOrInteger = Left (const undefined)\n</code></pre>\n\n<p>To just test that the instance is valid, you can use this (importing <code>Data.Proxy</code>):</p>\n\n<pre><code>ensureIntOrInteger :: IntOrInteger a =&gt; Proxy a -&gt; ()\nensureIntOrInteger p = case intOrInteger of\n  Left f -&gt; f p `seq` ()\n  Right f -&gt; f p `seq` ()\n</code></pre>\n\n<p>The result of <code>ensureIntOrInteger</code> will be defined if and only if the type <code>a</code> is actually an <code>Int</code> or an <code>Integer</code>.</p>\n\n<hr>\n\n<p>Nice; it works. But in practice it's pretty nasty to use. You can do much better with a few GHC extensions:</p>\n\n<pre><code>{-# LANGUAGE GADTs, TypeFamilies, TypeOperators, ConstraintKinds,\n      UndecidableInstances, UndecidableSuperClasses, DataKinds #-}\n\n-- In 8.0 and later, Constraint is also available from Data.Kind\nimport GHC.Exts (Constraint)\nimport Data.Type.Equality ((:~:)(..))\nimport GHC.TypeLits (TypeError, ErrorMessage (..))\n\ntype family IntOrIntegerC a :: Constraint where\n  IntOrIntegerC Int = ()\n  IntOrIntegerC Integer = ()\n  IntOrIntegerC t = TypeError ('ShowType t :&lt;&gt;:\n                               'Text \" is not an Int or an Integer.\")\n\nclass (Integral a, IntOrIntegerC a) =&gt; IntOrInteger a where\n  intOrInteger :: Either (a :~: Int) (a :~: Integer)\ninstance IntOrInteger Int where\n  intOrInteger = Left Refl\ninstance IntOrInteger Integer where\n  intOrInteger = Right Refl\n</code></pre>\n\n<p>With this formulation, the <code>IntOrIntegerC</code> constraint family blocks out any invalid types without your needing to do <em>anything</em>, giving a useful error message if someone tries to write a bogus instance. And if you actually do need to use the equality evidence, it's simply a matter of pattern matching on <code>intOrInteger</code> or using the various handy functions in <code>Data.Type.Equality</code>.</p>\n\n<hr>\n\n<p>A point of style: using <code>head</code> and <code>tail</code> is generally discouraged in Haskell. We prefer to pattern match instead. Your function could be written</p>\n\n<pre><code>f [] _ = []\nf (x : xs) k = x + k : f xs k\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 295, "user_id": 1946543, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c5bc3cc803d2303f47cb3d9c56fcfd1?s=128&d=identicon&r=PG", "display_name": "Steven Armstrong", "link": "https://stackoverflow.com/users/1946543/steven-armstrong"}, "is_accepted": false, "score": 0, "last_activity_date": 1492491463, "creation_date": 1492491463, "answer_id": 43463862, "question_id": 43420946, "link": "https://stackoverflow.com/questions/43420946/excluding-types-in-haskell/43463862#43463862", "title": "Excluding Types in Haskell", "body": "<p>There are a lot of ways to constrain types, the most direct is just with type families.</p>\n\n<pre><code>type family Elem x xs :: Constraint where\n    Elem x (x ': xs) = ()\n    Elem x (y ': xs) = Elem x xs\n    Elem x '[] = TypeError ('ShowType x :&lt;&gt;: 'Text \" is not a permitted type.\")\n\ntype a ~~ b = Elem a b\n\nfunction :: (a ~~ [Int, Integer], Num a) =&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>This allows you to white list a set of types. You won't know which one in particular you have though, that's more complicated.</p>\n\n<p>However, you said you wanted to <em>exclude</em> certain types, so perhaps you want a black list. We simply flip the first and last case:</p>\n\n<pre><code>type family NotElem x xs :: Constraint where\n    NotElem x (x ': xs) = TypeError ('ShowType x :&lt;&gt;: 'Text \" is a forbidden type.\")\n    NotElem x (y ': xs) = NotElem x xs\n    NotElem x '[] = ()\n\ntype a !~~ b = NotElem a b\n\nfunction :: (a !~~ [Double, Float], Num a) =&gt; [a] -&gt; [a]\n</code></pre>\n\n<p><code>function</code> will now accept any <code>Num</code> type that is <em>not</em> a Double or Float.</p>\n\n<p>However, there's no reason to actually do any of this for your example function. You lose nothing at all by allowing it to work on the full range of <code>Num</code> types. In fact, these hijinks will at the least cost you a tiny smidgen more time on type checking, or if you go further and do reflection based things, possibly run time overhead as well.</p>\n"}], "owner": {"reputation": 537, "user_id": 7869621, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1bd1e52c50a93fb4403a9dd0d2192276?s=128&d=identicon&r=PG&f=1", "display_name": "Rob", "link": "https://stackoverflow.com/users/7869621/rob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 421, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1503243993, "creation_date": 1492216620, "last_edit_date": 1492217806, "question_id": 43420946, "link": "https://stackoverflow.com/questions/43420946/excluding-types-in-haskell", "title": "Excluding Types in Haskell", "body": "<p>How would I use pattern matching in order to exclude certain types of inputs? For instance given the following:</p>\n\n<pre><code>f list k =\n    if null list\n    then []\n    else head list + k : f (tail list) k\n</code></pre>\n\n<p>How can I use pattern matching to make f s/t it only allows Int and Integer but not Double or Float?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1492209008, "post_id": 43419762, "comment_id": 73899173, "body": "<code>do</code> <i>something</i> in it."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 2, "creation_date": 1492209645, "post_id": 43419762, "comment_id": 73899353, "body": "Is that \u2237 character actually allowed?"}, {"owner": {"reputation": 31, "user_id": 7864785, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/110e8c32d0a3e8ec38ec51948c103363?s=128&d=identicon&r=PG&f=1", "display_name": "octoCat", "link": "https://stackoverflow.com/users/7864785/octocat"}, "edited": false, "score": 0, "creation_date": 1492215695, "post_id": 43419762, "comment_id": 73900727, "body": "yea I left out what the do was doing I didnt think it was needed ?"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7864785, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/110e8c32d0a3e8ec38ec51948c103363?s=128&d=identicon&r=PG&f=1", "display_name": "octoCat", "link": "https://stackoverflow.com/users/7864785/octocat"}, "edited": false, "score": 0, "creation_date": 1492215648, "post_id": 43420136, "comment_id": 73900716, "body": "but I did use two colons?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 31, "user_id": 7864785, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/110e8c32d0a3e8ec38ec51948c103363?s=128&d=identicon&r=PG&f=1", "display_name": "octoCat", "link": "https://stackoverflow.com/users/7864785/octocat"}, "edited": false, "score": 2, "creation_date": 1492216045, "post_id": 43420136, "comment_id": 73900789, "body": "@octoCat Not in the code you posted. You used a special 4-dots Unicode character instead of two colons."}], "tags": [], "owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "is_accepted": false, "score": 7, "last_activity_date": 1492209700, "creation_date": 1492209700, "answer_id": 43420136, "question_id": 43419762, "link": "https://stackoverflow.com/questions/43419762/why-do-i-get-a-naked-top-level-expression-when-i-add-a-type-description-to-my-ma/43420136#43420136", "title": "Why do I get a naked top level expression when I add a type description to my main function?", "body": "<p>You must enable the <code>UnicodeSyntax</code> extension to use <code>\u2237</code>. Try <code>{-# LANGUAGE UnicodeSyntax #-}</code> at the top of your file or using two colons like <code>main :: IO ()</code>.</p>\n"}], "owner": {"reputation": 31, "user_id": 7864785, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/110e8c32d0a3e8ec38ec51948c103363?s=128&d=identicon&r=PG&f=1", "display_name": "octoCat", "link": "https://stackoverflow.com/users/7864785/octocat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 260, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492209700, "creation_date": 1492207109, "last_edit_date": 1492208819, "question_id": 43419762, "link": "https://stackoverflow.com/questions/43419762/why-do-i-get-a-naked-top-level-expression-when-i-add-a-type-description-to-my-ma", "title": "Why do I get a naked top level expression when I add a type description to my main function?", "body": "<p>I'm trying to run my main file and it says</p>\n\n<pre><code>Parse error: naked expression at top level\nPerhaps you intended to use TemplateHaskell\n</code></pre>\n\n<p>Here's my related code</p>\n\n<pre><code>module Main where  \nimport System.IO\n\nimport System.Environment\n\nmain \u2237 IO ()\n\nmain = do \n</code></pre>\n"}, {"tags": ["haskell", "aeson"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1492206368, "post_id": 43419562, "comment_id": 73898377, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/43175498/why-isn-t-this-newtype-being-given-the-right-read-instance\">Why isn\u2019t this newtype being given the right Read instance?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "is_accepted": false, "score": 3, "last_activity_date": 1492206433, "creation_date": 1492206433, "answer_id": 43419668, "question_id": 43419562, "link": "https://stackoverflow.com/questions/43419562/automatically-deriving-tojson-fromjson-using-the-instances-of-the-inner-type-of/43419668#43419668", "title": "Automatically deriving toJSON/fromJSON using the instances of the inner type of a newtype", "body": "<p>I needed to set the option <code>unwrapUnaryRecords</code> to <code>True</code> when using <code>deriveJSON</code>:</p>\n\n<pre><code>import           Data.Aeson\nimport           Data.Aeson.TH\nimport           Data.Text            (Text)\n\nnewtype PersonName = PersonName { personName :: Text }\n$(deriveJSON (defaultOptions { unwrapUnaryRecords = True }) ''InstallationId)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1492206761, "post_id": 43419701, "comment_id": 73898503, "body": "Would this unwrap the record as well?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1492206863, "post_id": 43419701, "comment_id": 73898532, "body": "No, <code>GeneralizedNewtypeDeriving</code> instances work exactly the same way as their underlying type. Basically <code>PersonName</code> is an abstract synonym for <code>Text</code>"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 2, "creation_date": 1492206958, "post_id": 43419701, "comment_id": 73898570, "body": "Er I mean yes.  I misunderstood what &quot;unwrap&quot; meant"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 2, "creation_date": 1492209097, "post_id": 43419701, "comment_id": 73899209, "body": "Might be worth mentioning the new deriving strategies extension, which would probably be worth using if <code>DeriveAnyClass</code> is also enabled in that module."}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 3, "last_activity_date": 1492206620, "creation_date": 1492206620, "answer_id": 43419701, "question_id": 43419562, "link": "https://stackoverflow.com/questions/43419562/automatically-deriving-tojson-fromjson-using-the-instances-of-the-inner-type-of/43419701#43419701", "title": "Automatically deriving toJSON/fromJSON using the instances of the inner type of a newtype", "body": "<p>You can use <a href=\"https://downloads.haskell.org/~ghc/8.0.1/docs/html/users_guide/glasgow_exts.html#generalised-derived-instances-for-newtypes\" rel=\"nofollow noreferrer\"><code>GeneralizedNewtypeDeriving</code></a> to derive the instances.</p>\n\n<pre><code>{-# LANGUAGE GeneralizedNewtypeDeriving #-}\n\nnewtype PersonName = PersonName { personName :: Text }\n    deriving (ToJSON, FromJSON)\n</code></pre>\n"}], "owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 735, "favorite_count": 1, "accepted_answer_id": 43419701, "answer_count": 2, "score": 2, "last_activity_date": 1492206620, "creation_date": 1492205714, "question_id": 43419562, "link": "https://stackoverflow.com/questions/43419562/automatically-deriving-tojson-fromjson-using-the-instances-of-the-inner-type-of", "title": "Automatically deriving toJSON/fromJSON using the instances of the inner type of a newtype", "body": "<p>In my code I use a lot of <code>newtype</code> declarations, like:</p>\n\n<pre><code>newtype PersonName = PersonName { personName :: Text }\nnewtype PetName = PetName { petName :: Text }\n</code></pre>\n\n<p>(In practice I use lenses to avoid the cumbersome names for the accessor functions.)</p>\n\n<p>However, if I derive the instance from <code>ToJSON</code> and <code>FromJSON</code> automatically, the resulting JSON will be of the form:</p>\n\n<pre><code>{ \"personName\": \"The person name\" }\n{ \"petName\": \"The pet name\" }\n</code></pre>\n\n<p>Is there a way to avoid the boilerplate of declaring trivial instances of <code>ToJSON</code> and <code>FromJSON</code> for the <code>newtype</code>s above, in such a way that the resulting JSON objects will be of the form:</p>\n\n<pre><code>\"The person name\"\n\"The pet name\"\n</code></pre>\n"}, {"tags": ["haskell", "io"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1492196814, "post_id": 43417641, "comment_id": 73894420, "body": "Instead of <code>print list</code>, use <code>print (executeList 0 list)</code> in your main? Note that there is no (safe) function <code>IO a -&gt; a</code>."}, {"owner": {"reputation": 69, "user_id": 5331502, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh3.googleusercontent.com/-LTHBpJe-ZeM/AAAAAAAAAAI/AAAAAAAAAEQ/gwpVEtXZiRQ/photo.jpg?sz=128", "display_name": "motleycrue", "link": "https://stackoverflow.com/users/5331502/motleycrue"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1492197370, "post_id": 43417641, "comment_id": 73894688, "body": "Thank you!!! One more question. Is it possible to write this list to some other file in the same function? I try to add something like: outh &lt;- openFile &quot;results.txt&quot; WriteMode hPrint outh (executeList 0 list) hClose outh"}, {"owner": {"reputation": 69, "user_id": 5331502, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh3.googleusercontent.com/-LTHBpJe-ZeM/AAAAAAAAAAI/AAAAAAAAAEQ/gwpVEtXZiRQ/photo.jpg?sz=128", "display_name": "motleycrue", "link": "https://stackoverflow.com/users/5331502/motleycrue"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1492197435, "post_id": 43417641, "comment_id": 73894709, "body": "But get: parse error on input &#39;&lt;-&#39;. Perhaps this statemeent should be withing a &#39;do&#39; block? Error."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1492197724, "post_id": 43417641, "comment_id": 73894821, "body": "@motleycrue Instead of manually dealing with handles just use the higher level functions of <code>{read,write}File</code>.  For your second question consider <code>writeFile &quot;results.txt&quot; (unwords (executeList 0 list))</code>."}, {"owner": {"reputation": 69, "user_id": 5331502, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh3.googleusercontent.com/-LTHBpJe-ZeM/AAAAAAAAAAI/AAAAAAAAAEQ/gwpVEtXZiRQ/photo.jpg?sz=128", "display_name": "motleycrue", "link": "https://stackoverflow.com/users/5331502/motleycrue"}, "edited": false, "score": 0, "creation_date": 1492197929, "post_id": 43417641, "comment_id": 73894914, "body": "Thank you both. Have a nice day, guys :)"}], "answers": [{"tags": [], "owner": {"reputation": 853, "user_id": 3645112, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/QFHGj.jpg?s=128&g=1", "display_name": "Rainbacon", "link": "https://stackoverflow.com/users/3645112/rainbacon"}, "is_accepted": false, "score": 2, "last_activity_date": 1575240842, "last_edit_date": 1575240842, "creation_date": 1492202440, "answer_id": 43418932, "question_id": 43417641, "link": "https://stackoverflow.com/questions/43417641/haskell-read-integers-from-a-file-to-a-list/43418932#43418932", "title": "Haskell Read Integers from a file to a list", "body": "<p>The short answer is that you can't transform <code>IO()</code> into <code>[Integer]</code>.</p>\n\n<p>It seems as though you are misunderstanding the <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/System-IO.html\" rel=\"nofollow noreferrer\">IO monad</a>. Most functions return a value. Functions with a return type of <code>IO a</code> instead return an I/O action that performs some sort I/O before returning a value of type <code>a</code>. In your case <code>IO ()</code> is an I/O action that will return <code>()</code> which is just an empty tuple. When you are writing console programs like this that read in data and then print out some results you'll typically follow this pattern:</p>\n\n<ol>\n<li>Read input from file or command line</li>\n<li>Pass data to function for computation</li>\n<li>Print results</li>\n</ol>\n\n<p>Your whole program will end up living inside of the IO monad. <code>do</code> is a notation that is a syntactic sugar for the bind operator <code>&gt;&gt;=</code>. This operator allows us to chain monadic computations together. The <code>&lt;-</code> in your code extracts a value from a monad (in your case an IO action) and stores it in a variable. Lets take a look at the type signature of <code>hGetContents</code>. From GHCI we can learn that this function has a type of <code>hGetContents :: Handle -&gt; IO String</code> It takes a <code>Handle</code> and returns an I/O action that returns a string. When you call <code>contents &lt;- hGetContents handle</code> the program calls <code>hGetContents</code> with the file handle you specified and then extracts a string from the IO action that is returned and stores that string in the variable contents. So now you've read the input. After you've converted the numbers to actual integer types the next step is to call your function which is the simple call <code>let data = executeList 0 list</code> From there you can output you data with <code>print data</code>. It's important to keep in mind that the whole time you are in the IO monad. In the end your entire main function should look something like this:</p>\n\n<pre><code>main = do\n    handle &lt;- openFile \"data.txt\" ReadMode\n    contents &lt;- hGetContents handle\n    let singlewords = words contents\n        list = f singlewords\n        data = executeList 0 list\n    print data\n    hClose handle   \n\nf :: [String] -&gt; [Integer]\nf = map read\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 5331502, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh3.googleusercontent.com/-LTHBpJe-ZeM/AAAAAAAAAAI/AAAAAAAAAEQ/gwpVEtXZiRQ/photo.jpg?sz=128", "display_name": "motleycrue", "link": "https://stackoverflow.com/users/5331502/motleycrue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2763, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1575240842, "creation_date": 1492196503, "last_edit_date": 1495540947, "question_id": 43417641, "link": "https://stackoverflow.com/questions/43417641/haskell-read-integers-from-a-file-to-a-list", "title": "Haskell Read Integers from a file to a list", "body": "<p>I have a simple text file with one line:</p>\n\n<pre><code>6 195 265 750 265 750 196\n</code></pre>\n\n<p>I have a function:</p>\n\n<pre><code>executeList :: Integer -&gt; [Integer] -&gt; [String]\nexecuteList n x = [reverseAndAdd n i | i &lt;- x]\n</code></pre>\n\n<p>That takes an integer, list of integer and returns an array of Strings.</p>\n\n<p>What I want to do, is to read that text file to and [Integer] list and pass that to executeList function.\nHere is my code:</p>\n\n<pre><code>main = do  \n    let list = []\n    handle &lt;- openFile \"data.txt\" ReadMode\n    contents &lt;- hGetContents handle\n    let singlewords = words contents\n        list = f singlewords\n    print list\n    hClose handle   \nf :: [String] -&gt; [Integer]\nf = map read\n</code></pre>\n\n<p>I found it here:\n<a href=\"https://stackoverflow.com/questions/7867723/haskell-file-reading\">Haskell file reading</a></p>\n\n<p>When I run 'main' I get this output:\n[6,195,265,750,265,750,196]</p>\n\n<p>but when I try to pass it like this to executeList:</p>\n\n<pre><code>let list = main\nexecuteList 0 list\n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code>&lt;interactive&gt;:103:15: error:\n* Couldn't match expected type `[Integer]' with actual type `IO ()'\n* In the second argument of `executeList', namely `list'\n  In the expression: executeList 0 list\n  In an equation for `it': it = executeList 0 list\n</code></pre>\n\n<p>If I check the type of that list, i get this:</p>\n\n<pre><code>list :: IO()\n</code></pre>\n\n<p>I looked up on the internet for how to transform IO() to [Integer] but found nothing useful. Maybe someone can show me the way to do that conversion? </p>\n"}, {"tags": ["parsing", "haskell", "functional-programming", "eval"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1492195807, "post_id": 43417277, "comment_id": 73893947, "body": "Related: <a href=\"http://stackoverflow.com/q/42701878/2751851\"><i>How to serialize function type to json in haskell?</i></a>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1492203366, "post_id": 43417277, "comment_id": 73897238, "body": "You might like <a href=\"http://hackage.haskell.org/package/dyre\" rel=\"nofollow noreferrer\">dyre</a>, which lets you invert control: rather than your program taking a string and evaluating it as Haskell, you write some Haskell that uses things exposed in your library (and dyre handles the job of handing off to GHC when the &quot;string&quot; changes). There is also of course the GHC API and things built on top of them like <a href=\"http://hackage.haskell.org/package/hint\" rel=\"nofollow noreferrer\">hint</a> and <a href=\"http://hackage.haskell.org/package/mueval\" rel=\"nofollow noreferrer\">mueval</a>."}], "answers": [{"comments": [{"owner": {"reputation": 930, "user_id": 4387539, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xN2AM.png?s=128&g=1", "display_name": "hyiltiz", "link": "https://stackoverflow.com/users/4387539/hyiltiz"}, "edited": false, "score": 0, "creation_date": 1492196435, "post_id": 43417298, "comment_id": 73894236, "body": "Question edited with more information about context and &quot;correspondence&quot;."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 930, "user_id": 4387539, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xN2AM.png?s=128&g=1", "display_name": "hyiltiz", "link": "https://stackoverflow.com/users/4387539/hyiltiz"}, "edited": false, "score": 3, "creation_date": 1492196969, "post_id": 43417298, "comment_id": 73894497, "body": "@hyiltiz: well, there is such a function. It&#39;s called &quot;compiler&quot; ;)."}, {"owner": {"reputation": 930, "user_id": 4387539, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xN2AM.png?s=128&g=1", "display_name": "hyiltiz", "link": "https://stackoverflow.com/users/4387539/hyiltiz"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1492197192, "post_id": 43417298, "comment_id": 73894596, "body": "@Zeta The compiler can/will do part of that. However, it also (lazily, in Haskell&#39;s case) evaluates the functions. I am not asking for evaluating the function (yet), just turning the string into a function."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 930, "user_id": 4387539, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xN2AM.png?s=128&g=1", "display_name": "hyiltiz", "link": "https://stackoverflow.com/users/4387539/hyiltiz"}, "edited": false, "score": 2, "creation_date": 1492203293, "post_id": 43417298, "comment_id": 73897210, "body": "@hyiltiz No, the compiler generally does not run the programs it produces. What makes you say that it does (&quot;the compiler also evaluates the functions&quot;)?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1492212120, "post_id": 43417298, "comment_id": 73899965, "body": "@hylitiz the compiler does <i>not</i> &#39;evaluate functions&#39;. Lazy evaluation is done via thunks, and certainly not by the compiler during runtime. Haskell is not a scripting language, so no such function exists."}], "tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": false, "score": 4, "last_activity_date": 1492195086, "creation_date": 1492195086, "answer_id": 43417298, "question_id": 43417277, "link": "https://stackoverflow.com/questions/43417277/eval-string-a-b-string-to-function-converter/43417298#43417298", "title": "&#39;eval :: String -&gt; (a -&gt; b)&#39; string to function converter", "body": "<p>No, there is no such function.</p>\n"}, {"comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 1, "creation_date": 1492198279, "post_id": 43417993, "comment_id": 73895073, "body": "It&#39;d be nice if it were possible to write <code>eval :: Typeable a =&gt; String -&gt; Maybe a</code> without the <code>IO</code> wrapper and without GHC overwriting signal handlers (which I think is the only side effect of things like <code>eval</code>)."}, {"owner": {"reputation": 930, "user_id": 4387539, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xN2AM.png?s=128&g=1", "display_name": "hyiltiz", "link": "https://stackoverflow.com/users/4387539/hyiltiz"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1492198516, "post_id": 43417993, "comment_id": 73895198, "body": "@Cirdec Can you elaborate a bit on the IO wrapper and &quot;GHC overwriting signal handlers&quot;? Seems interesting."}, {"owner": {"reputation": 930, "user_id": 4387539, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xN2AM.png?s=128&g=1", "display_name": "hyiltiz", "link": "https://stackoverflow.com/users/4387539/hyiltiz"}, "edited": false, "score": 0, "creation_date": 1492198601, "post_id": 43417993, "comment_id": 73895236, "body": "@chi I understand that using <code>eval</code> to actually evaluating something (random) string is a very bad idea, but not sure why turning strings into values / functions would be a bad idea."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 930, "user_id": 4387539, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xN2AM.png?s=128&g=1", "display_name": "hyiltiz", "link": "https://stackoverflow.com/users/4387539/hyiltiz"}, "edited": false, "score": 0, "creation_date": 1492200597, "post_id": 43417993, "comment_id": 73896121, "body": "@hyiltiz To turn strings into first-order values we have <code>read</code>. For functions, it depends on what are you trying to achieve. If you are writing an interpreter, that&#39;s ok. If your strings, say, can only be <code>(*)</code> and <code>(+)</code>, using eval is overkill, and potentially dangerous. Again, as I wrote above, why would one circumvent the static type system? I program in statically typed languages to detect errors early, <code>eval</code> turns compile time errors into runtime one, which is very bad to me -- the whole philosophy of Haskell is going the other way"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1492267298, "post_id": 43417993, "comment_id": 73912520, "body": "@Cirdec It would also require your runtime to include a copy of the GHC compiler! The <code>IO</code> constraint present in e.g. <code>hint</code> is because it starts a copy of the GHC process through system commands and interacts with that new process through a pipe."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 7, "last_activity_date": 1492197975, "creation_date": 1492197975, "answer_id": 43417993, "question_id": 43417277, "link": "https://stackoverflow.com/questions/43417277/eval-string-a-b-string-to-function-converter/43417993#43417993", "title": "&#39;eval :: String -&gt; (a -&gt; b)&#39; string to function converter", "body": "<p>If I have a function</p>\n\n<pre><code>eval :: String -&gt; (a -&gt; b)\n</code></pre>\n\n<p>Then, the following code type checks:</p>\n\n<pre><code>foo :: Int -&gt; Int -&gt; Int\nfoo = eval \"(+)\"\n\nbar :: Char -&gt; Bool\nbar = eval \"(+)\"\n</code></pre>\n\n<p>There's clearly something wrong. What you want, to start, is to quantify <code>a</code> and  <code>b</code> <em>existentially</em> instead of universally.</p>\n\n<pre><code>data Fun where\n   Fun :: (a -&gt; b) -&gt; Fun\n\neval :: String -&gt; Fun\n</code></pre>\n\n<p>However, a value in such existential type would be unusable for anything else. Given a <code>Fun</code> and, say, a string, you can't apply the function to the string because the function might require a boolean input, for what we know.</p>\n\n<p>A more sensible option could be using <code>Typeable</code>.</p>\n\n<pre><code>eval :: (Typeable a, Typeable b) =&gt; String -&gt; Maybe (a -&gt; b)\n</code></pre>\n\n<p>this could return <code>Nothing</code> when the string does not type check against the chosen <code>a</code> and <code>b</code>, while parsing the string and evaluating it to a function of the right types otherwise.</p>\n\n<p>(By the way, why the result of such <code>eval</code> should be constrained to a function? It seems pointless to do so.)</p>\n\n<p>This is, in principle, achievable. The libraries in fact contain <code>System.Eval.Haskell.eval</code> to a similar aim.</p>\n\n<p>However, unless you really want to write a program which receives Haskell code at runtime and interprets it, I strongly recommend you avoid anything like <code>eval</code>. Using it for ordinary programming seems to grossly violate the spirit of the language, its idioms, and to possibly circumvent the static guarantees offered by the type system, turning compile time errors into runtime.</p>\n\n<p>While I am no expert, I think using <code>eval</code> in scripting languages is mostly considered a very bad design.</p>\n\n<p>TL;DR. It is probably a very bad idea to use <code>eval</code> for anything which does not strictly require <code>eval</code>. Avoid it.</p>\n"}], "owner": {"reputation": 930, "user_id": 4387539, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xN2AM.png?s=128&g=1", "display_name": "hyiltiz", "link": "https://stackoverflow.com/users/4387539/hyiltiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 43417993, "answer_count": 2, "score": 1, "last_activity_date": 1492197975, "creation_date": 1492194956, "last_edit_date": 1492197544, "question_id": 43417277, "link": "https://stackoverflow.com/questions/43417277/eval-string-a-b-string-to-function-converter", "title": "&#39;eval :: String -&gt; (a -&gt; b)&#39; string to function converter", "body": "<p>Is there a function in Haskell standard library (or some other modules / packages) that can take a <code>String</code> literal such as <code>\"+\"</code>, <code>\"head\"</code> etc., then turn those into their <em>corresponding</em> Haskell functions, such as <code>+</code>, <code>head</code> ? </p>\n\n<p>Hoogle did not produce any immediately useful answers. A dummy example for such a function would work like this:</p>\n\n<pre><code>eval :: String -&gt; (a -&gt; b)\neval \"+\" = (+)\neval \"head\" = head\n</code></pre>\n\n<p>p.s. Given that \"corresponding\" here can mean different things under different context (<code>+</code> may no longer be defined as numeric addition for types that are not <code>Num</code>bers) but is necessary to answer this question, let's assume that the \"corresponding\" function for a string is the function that type checks and could be evaluated in the environment where the string is being turned into this function, a.k.a. use the lexical scope to lookup the value of this function.</p>\n\n<p>If there is no such function, is there a deep reason (e.g. from lambda calculus, type theory etc.) why, and is it impossible to implement in any strict static typed language? If it is impossible in Haskell, what is actually a recommended practice to problems such as this? Imagine implementing a linear algebra library where strings either eval into functions that create values (e.g. <code>vect2</code> is a function that creates a two dimensional function), or (binary, <em>for simplicity</em>) operations that map from them unto some other type (we could optionally provide type annotations for these, such as <code>eval \"innerProduct\" :: Double</code>, <code>eval \"matrixProduct\" :: Matrix</code> etc.)</p>\n\n<p>More generally, a <code>String</code> type has a kind <code>*</code>, but a function <code>-&gt;</code> has a kind <code>* -&gt; * -&gt; *</code>. Assuming that we can provide the first two kinds <code>*</code> from the lexical scope, it should be possible, right? </p>\n"}, {"tags": ["string", "haskell", "if-statement"], "comments": [{"owner": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 2, "creation_date": 1492194140, "post_id": 43417040, "comment_id": 73893079, "body": "Please share the <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 1491, "user_id": 6480793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fe10b5df5ec1164b5bade347d8599f8?s=128&d=identicon&r=PG&f=1", "display_name": "Delioth", "link": "https://stackoverflow.com/users/6480793/delioth"}, "reply_to_user": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 0, "creation_date": 1492194295, "post_id": 43417040, "comment_id": 73893177, "body": "In addition to @bereal&#39;s note, Welcome to Stack Overflow! I see you&#39;ve taken the <a href=\"https://stackoverflow.com/tour\">tour</a> already, so I&#39;ll just link you to the <a href=\"https://stackoverflow.com/help\">help center</a>, and also to the article on <a href=\"https://stackoverflow.com/questions/how-to-ask\">How to Ask</a>."}, {"owner": {"reputation": 23, "user_id": 6040433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77ebfa1aa96f09dbf5978e2e8b83580c?s=128&d=identicon&r=PG&f=1", "display_name": "OreOS", "link": "https://stackoverflow.com/users/6040433/oreos"}, "reply_to_user": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 0, "creation_date": 1492194877, "post_id": 43417040, "comment_id": 73893483, "body": "@bereal Added it into the post Delioth Thank you very much for your help and kind attitude, I&#39;ll make sure to read it"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1492195650, "post_id": 43417040, "comment_id": 73893858, "body": "Tangential note after looking at the source of your question: don&#39;t use tabs in Haskell code. See <a href=\"http://stackoverflow.com/q/35855170/2751851\"><i>Why shouldn&#39;t I mix tabs and spaces?</i></a> for discussion of the matter."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1492196271, "post_id": 43417040, "comment_id": 73894163, "body": "@duplode Oh god. <code>\u21a6</code> doesn&#39;t fit into the monospaced font on FF@Win. <i>Why has no one edited my answer?</i>"}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6040433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77ebfa1aa96f09dbf5978e2e8b83580c?s=128&d=identicon&r=PG&f=1", "display_name": "OreOS", "link": "https://stackoverflow.com/users/6040433/oreos"}, "edited": false, "score": 0, "creation_date": 1492195241, "post_id": 43417147, "comment_id": 73893678, "body": "I think there was a misunderstanding between us, first of all I suggest you look at my newly added examples and perhaps it&#39;ll clear things up. Second of all let me try to re-explain myself, what I mean is that my goal is to check if the string &#39;op&#39; is equal to &quot;plus&quot; (without quotation marks so it&#39;d be <code>plus</code>)  but when using <code>op == &quot;plus&quot;</code> it takes the string as <code>&quot;plus&quot;</code> rather than <code>plus</code>"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "reply_to_user": {"reputation": 23, "user_id": 6040433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77ebfa1aa96f09dbf5978e2e8b83580c?s=128&d=identicon&r=PG&f=1", "display_name": "OreOS", "link": "https://stackoverflow.com/users/6040433/oreos"}, "edited": false, "score": 2, "creation_date": 1492195504, "post_id": 43417147, "comment_id": 73893801, "body": "@OreOS &#39;my goal is to check if the string &#39;op&#39; is equal to &quot;plus&quot; (without quotation marks so it&#39;d be plus)&#39; That&#39;s exactly what <code>op == &quot;plus&quot;</code> does. &#39;when using op == &quot;plus&quot; it takes the string as &quot;plus&quot; rather than plus&#39; That is not true."}, {"owner": {"reputation": 23, "user_id": 6040433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77ebfa1aa96f09dbf5978e2e8b83580c?s=128&d=identicon&r=PG&f=1", "display_name": "OreOS", "link": "https://stackoverflow.com/users/6040433/oreos"}, "reply_to_user": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 0, "creation_date": 1492196515, "post_id": 43417147, "comment_id": 73894275, "body": "Thank you to everyone who helped and @bereal your example made me realize what I believe was the cause. I think that when running it in ghci as a parameter for a function it was looking for a variable named <code>plus</code> rather than taking it as a value and when I input <code>&quot;plus&quot;</code> that&#39;s when it recognized it as a value rather than a variable name, sorry if this was a bother and thank you again for your help."}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 4, "last_activity_date": 1492194474, "creation_date": 1492194474, "answer_id": 43417147, "question_id": 43417040, "link": "https://stackoverflow.com/questions/43417040/how-to-compare-string-to-value-without-quotation-marks/43417147#43417147", "title": "How to compare string to value without quotation marks", "body": "<p>The quotation marks are just part of the syntax of string literals, not their contents. That is, if you write <code>op == \"plus\"</code>, this will be true if (and only if) <code>plus</code> contains the characters 'p', 'l', 'u' and 's' (in that order, obviously) - it does not require (or allow) <code>op</code> to contain any quotes.</p>\n\n<p>So if <code>op == \"plus\"</code> does not produce <code>True</code> for you even when you think it should, <code>op</code> does not contain what you think it does.</p>\n"}], "owner": {"reputation": 23, "user_id": 6040433, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77ebfa1aa96f09dbf5978e2e8b83580c?s=128&d=identicon&r=PG&f=1", "display_name": "OreOS", "link": "https://stackoverflow.com/users/6040433/oreos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "accepted_answer_id": 43417147, "answer_count": 1, "score": 0, "last_activity_date": 1492195271, "creation_date": 1492194005, "last_edit_date": 1492195271, "question_id": 43417040, "link": "https://stackoverflow.com/questions/43417040/how-to-compare-string-to-value-without-quotation-marks", "title": "How to compare string to value without quotation marks", "body": "<p>I am pretty new to Haskell and today I was trying to make a calculator using Haskell (like most people make when learning a new language to get the hold of if statements) and I had trouble using if values with strings. I want to check if the string the user wrote is \"plus\" (without \"\") but if I don't the quotation marks (so it'd look like <code>if op == plus</code>) it doesn't recognize it as a string and outputs an error but if on the other hand I use the quotation marks (so it'd look like this <code>if op == \"plus\"</code>) then it looks for the string \"plus\" with the quotation marks, how can I compare a string to a value without quotation marks?</p>\n\n<p>Case 1: </p>\n\n<pre><code>calculate x op y = do\n            if op == \"plus\"\n                        then x+y\n                        else x\n</code></pre>\n\n<p>Result: the program looks for \"plus\" when calling the function and thus if the input when calling the function is for example \"1 plus 3\" it will give out an error of ':67:13: error: Variable not in scope: plus :: [Char]</p>\n\n<p>Case 2: </p>\n\n<pre><code>calculate x op y = do\n            if op == plus\n                        then x+y\n                        else x\n</code></pre>\n\n<p>Result: When trying to load the program I get the error \"test.hs:2:33: error: Variable not in scope: plus\nFailed, modules loaded: none.\", so I can't try and call the function obviously.</p>\n"}, {"tags": ["ubuntu", "haskell", "profiling", "ubuntu-14.04", "glut"], "comments": [{"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1492184651, "post_id": 43413820, "comment_id": 73888359, "body": "It should have solved the problem if you are really using <code>Graphics.UI.GLUT</code> installed from Ubuntu (via the <code>libghc-glut-dev</code> package). Are you sure you did not install <code>glut</code> via <code>cabal</code> (<code>cabal install glut</code>) as well?"}, {"owner": {"reputation": 4952, "user_id": 5987698, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1b26d6435dcb8897d1a57fa24b462da0?s=128&d=identicon&r=PG&f=1", "display_name": "GoodDeeds", "link": "https://stackoverflow.com/users/5987698/gooddeeds"}, "reply_to_user": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1492184713, "post_id": 43413820, "comment_id": 73888397, "body": "@JoachimBreitner I think I installed using cabal. What should be the solution in this case please?"}], "answers": [{"comments": [{"owner": {"reputation": 4952, "user_id": 5987698, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1b26d6435dcb8897d1a57fa24b462da0?s=128&d=identicon&r=PG&f=1", "display_name": "GoodDeeds", "link": "https://stackoverflow.com/users/5987698/gooddeeds"}, "edited": false, "score": 0, "creation_date": 1492185667, "post_id": 43414949, "comment_id": 73888883, "body": "Thank you! This is going to take some time for me it seems, because each package says that another package needs its profiling libraries to be installed first. Will accept when done."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "reply_to_user": {"reputation": 4952, "user_id": 5987698, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1b26d6435dcb8897d1a57fa24b462da0?s=128&d=identicon&r=PG&f=1", "display_name": "GoodDeeds", "link": "https://stackoverflow.com/users/5987698/gooddeeds"}, "edited": false, "score": 0, "creation_date": 1492193696, "post_id": 43414949, "comment_id": 73892840, "body": "You can also just nuke <code>~&#47;.ghc&#47;</code> and start fresh. That\u2019s probably what I would do\u2026"}], "tags": [], "owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "is_accepted": false, "score": 1, "last_activity_date": 1492185078, "creation_date": 1492185078, "answer_id": 43414949, "question_id": 43413820, "link": "https://stackoverflow.com/questions/43413820/how-can-i-install-profiling-libraries-in-haskell-when-using-cabal-in-ubuntu-14/43414949#43414949", "title": "How can I install profiling libraries in Haskell when using cabal, in Ubuntu 14.04.5?", "body": "<p>Running</p>\n\n<pre><code>sudo apt-get install libghc-glut-prof\n</code></pre>\n\n<p>is the right thing to do if you indeed use the Debian package to get <code>Graphics.UI.GLUT</code>.</p>\n\n<p>If you have installed the <code>glut</code> package with <code>cabal</code> yourself, e.g. with</p>\n\n<pre><code>cabal install glut\n</code></pre>\n\n<p>or some other package that pulls in <code>glut</code>, then you can run</p>\n\n<pre><code>cabal install --enable-library-profiling --force-reinstall glut\n</code></pre>\n\n<p>(or whatever other package you installed that pulled in <code>glut</code>) to rebuild with profiling enabled.</p>\n\n<p>None of this is specific to <code>glut</code>.</p>\n"}], "owner": {"reputation": 4952, "user_id": 5987698, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1b26d6435dcb8897d1a57fa24b462da0?s=128&d=identicon&r=PG&f=1", "display_name": "GoodDeeds", "link": "https://stackoverflow.com/users/5987698/gooddeeds"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1300, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492197057, "creation_date": 1492181081, "last_edit_date": 1492197057, "question_id": 43413820, "link": "https://stackoverflow.com/questions/43413820/how-can-i-install-profiling-libraries-in-haskell-when-using-cabal-in-ubuntu-14", "title": "How can I install profiling libraries in Haskell when using cabal, in Ubuntu 14.04.5?", "body": "<p>I have a Haskell project for which I would like to obtain the stack trace when an exception is thrown. I am using GHC 8.0.2 and the module <code>Graphics.UI.GLUT</code>, where the version of GLUT is 2.7.0.11.</p>\n\n<p>I have installed the module using cabal.</p>\n\n<p><a href=\"https://wiki.haskell.org/Debugging#Stack_trace\" rel=\"nofollow noreferrer\">This page from the official website</a> suggests that I compile using the <code>-prof</code> flag. However, I get the following error</p>\n\n<pre><code> Failed to load interface for \u2018Graphics.UI.GLUT\u2019\n Perhaps you haven't installed the profiling libraries for package \u2018GLUT-2.7.0.11\u2019?\n Use -v to see a list of the files searched for.\n</code></pre>\n\n<p>I am using Ubuntu 14.04.5 LTS. Using <a href=\"http://packages.ubuntu.com/cgi-bin/search_packages.pl?keywords=glut&amp;searchon=names&amp;subword=1&amp;version=breezy&amp;release=all\" rel=\"nofollow noreferrer\">this link</a>, I decided to run</p>\n\n<pre><code>sudo apt-get install libghc-glut-prof\n</code></pre>\n\n<p>However, this did not solve the problem. How can I solve this?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["haskell", "functional-programming", "pattern-matching", "tuples"], "answers": [{"comments": [{"owner": {"reputation": 1755, "user_id": 3666591, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70206265199564bb40833280d34ce9cb?s=128&d=identicon&r=PG&f=1", "display_name": "just.me", "link": "https://stackoverflow.com/users/3666591/just-me"}, "edited": false, "score": 0, "creation_date": 1492178737, "post_id": 43412368, "comment_id": 73885020, "body": "Out of curiosity, could you tell me which mistake I made in this line? <code>crt m a = (sum $ ae m a M, M) where M = product m</code>. I defined <code>crt :: (Integral a) =&gt; [a] -&gt; [a] -&gt; (a,a)</code> and <code>ae :: (Integral a) =&gt; [a] -&gt; [a] -&gt; a -&gt; [a]</code>, but the compiler says <code>Not in scope: data constructor </code>M&#39;`."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 1755, "user_id": 3666591, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70206265199564bb40833280d34ce9cb?s=128&d=identicon&r=PG&f=1", "display_name": "just.me", "link": "https://stackoverflow.com/users/3666591/just-me"}, "edited": false, "score": 0, "creation_date": 1492178788, "post_id": 43412368, "comment_id": 73885047, "body": "Well uppercases are used for constructors. Use a lowercase, like <code>where pr = product m</code>."}, {"owner": {"reputation": 1755, "user_id": 3666591, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70206265199564bb40833280d34ce9cb?s=128&d=identicon&r=PG&f=1", "display_name": "just.me", "link": "https://stackoverflow.com/users/3666591/just-me"}, "edited": false, "score": 0, "creation_date": 1492178922, "post_id": 43412368, "comment_id": 73885125, "body": "Thank you! Having a hard time getting used to haskell."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1492180628, "post_id": 43412368, "comment_id": 73886070, "body": "&quot;The do is used a syntactical sugar for monads.&quot; is a good first approximation to the truth, but just adding a <code>let</code> to the <code>(x,y) = ...</code> line works as well: <a href=\"http://ideone.com/ZL7QZs\" rel=\"nofollow noreferrer\">ideone.com/ZL7QZs</a>"}, {"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1492182701, "post_id": 43412368, "comment_id": 73887239, "body": "@DanielWagner it is using the <code>Identity</code> Monad instance by default. <code>x &gt;&gt;= f = f (runIdentity x)</code> and <code>return = Identity</code>."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 1, "creation_date": 1492183700, "post_id": 43412368, "comment_id": 73887832, "body": "@Lazersmoke That code isn&#39;t using a monad in <code>g</code> at all, despite the <code>do</code> &quot;block.&quot;"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 4, "creation_date": 1492184125, "post_id": 43412368, "comment_id": 73888094, "body": "@Lazersmoke No, there is no <code>Monad</code> at use in that code. Just run <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-470003.14\" rel=\"nofollow noreferrer\">the desugaring rules</a> by hand and you will see that none is needed."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1492196610, "post_id": 43412368, "comment_id": 73894320, "body": "My first thought was &quot;to pattern match over the result of <code>f x</code>, one can use a <code>case f x of ...</code>&quot;. I was very surprised to find a long list of every alternative but that one! :-)"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 8, "last_activity_date": 1492178168, "last_edit_date": 1492178168, "creation_date": 1492175955, "answer_id": 43412368, "question_id": 43412324, "link": "https://stackoverflow.com/questions/43412324/pattern-matching-for-return-values/43412368#43412368", "title": "Pattern matching for return values", "body": "<p>The <code>do</code> is used a <em>syntactical sugar</em> for <strong>monads</strong>. Your function is however not a monad.</p>\n\n<p>What you can do is use a <strong><code>let</code>-clause</strong>, like:</p>\n\n<pre><code>g :: (Integral a) =&gt; a -&gt; a\ng z = <b>let (x,y) = fn (z,(z+5)) in</b> x `mod` y</code></pre>\n\n<p>Or a <strong><code>where</code>-clause</strong>:</p>\n\n<pre><code>g :: (Integral a) =&gt; a -&gt; a\ng z = x `mod` y\n    <b>where (x,y) = fn (z,(z+5))</b></code></pre>\n\n<p>You can also define a <strong>pattern in a <em>lambda-expression</em></strong>, like:</p>\n\n<pre><code>g :: (Integral a) =&gt; a -&gt; a\ng z = (\\<b>(x,y)</b> -> x `mod` y) $ fn (z,(z+5))</code></pre>\n\n<p>Along these lines, you can also define a <strong>helper function</strong> that does the pattern matching, like:</p>\n\n<pre><code>g :: (Integral a) =&gt; a -&gt; a\ng z = <b>h</b> $ fn (z,(z+5))\n    where <b>h</b> (x,y) = x `mod` y</code></pre>\n\n<p>This can be useful if there are several patterns that need to be handled differently (like the <code>Nothing</code> and <code>Just x</code> for the <code>Maybe a</code> type).</p>\n\n<p>Say for instance that you defined a function:</p>\n\n<pre><code>foo :: Int -&gt; Int -&gt; Maybe Int\nfoo x y | x &gt; y = Just x\n        | otherwise = Nothing\n</code></pre>\n\n<p>than you can define <code>bar</code> with a helper function <code>qux</code> to handle the output of <code>foo</code>, like:</p>\n\n<pre><code>bar :: Int -&gt; Int -&gt; Int\nbar x y = qux $ foo x y\n    where qux Nothing = y\n          qux (Just z) = z\n</code></pre>\n\n<p>Finally in the case of 2-tuples, you can decide <strong>not to use pattern matching</strong>, but use <code>fst :: (a,b) -&gt; a</code> and <code>snd :: (a,b) -&gt; b</code>, like for instance:</p>\n\n<pre><code>g :: (Integral a) =&gt; a -&gt; a\ng z = let <b>t</b> = fn (z,(z+5)) in (<b> fst  t</b>) `mod` (<b>snd t</b>)</code></pre>\n\n<p>But this is less elegant since here one has to start thinking about what <code>fst</code> and <code>snd</code> do, and furtermore if not optimized, it can result in additional computation overhead.</p>\n\n<p>Which one to pick depends of course on the context and a bit on personal taste. Since here the pattern is the only one, I would pick the <code>let</code> or <code>where</code> pattern, but like the French say: \"<em>Les go\u00fbts et les couleurs ne se discutent pas.</em>\".</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1492196746, "creation_date": 1492196746, "answer_id": 43417701, "question_id": 43412324, "link": "https://stackoverflow.com/questions/43412324/pattern-matching-for-return-values/43417701#43417701", "title": "Pattern matching for return values", "body": "<p>My personal preference in the general case, is to use a <code>case .. of</code> expression. For instance, if <code>f :: Int -&gt; Maybe Int</code>, we can write</p>\n\n<pre><code>g :: Int -&gt; Int\ng x = case f x of\n   Nothing -&gt; 5\n   Just y  -&gt; x+y\n</code></pre>\n\n<p>For types with only one constructor, like tuples, then <code>let .. in</code> can also be used:</p>\n\n<pre><code>h a = let (x, y) = foo a in ...\n</code></pre>\n\n<p>Remember, however, that <code>case</code> is strict while <code>let</code> is lazy. E.g.</p>\n\n<pre><code>case undefined of (x,y) -&gt; 5\n</code></pre>\n\n<p>raises an error. Instead</p>\n\n<pre><code>let (x, y) = undefined in 5\n</code></pre>\n\n<p>evaluates to <code>5</code>. So, they are not completely equivalent. They became such when using irrefutable patterns, or matching against a <code>newtype</code> constructor.</p>\n"}], "owner": {"reputation": 1755, "user_id": 3666591, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70206265199564bb40833280d34ce9cb?s=128&d=identicon&r=PG&f=1", "display_name": "just.me", "link": "https://stackoverflow.com/users/3666591/just-me"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 809, "favorite_count": 0, "accepted_answer_id": 43412368, "answer_count": 2, "score": 2, "last_activity_date": 1492196746, "creation_date": 1492175796, "question_id": 43412324, "link": "https://stackoverflow.com/questions/43412324/pattern-matching-for-return-values", "title": "Pattern matching for return values", "body": "<p>I know I can use pattern matching for function parameters like this:</p>\n\n<pre><code>fn :: (Integral a) =&gt; (a,a) -&gt; (a, a)\nfn (x,y) = (y,x)\n</code></pre>\n\n<p>But how can I match the return value? I would expect something like this:</p>\n\n<pre><code>g :: (Integral a) =&gt; a -&gt; a\ng z = do\n  (x, y) = fn (z, z + 5)\n  x `mod` y\n</code></pre>\n\n<p>This results in a syntax error. Is there a way to match return values? Basically, I want to split the returned tuple into two variables.</p>\n"}, {"tags": ["haskell", "reflection"], "comments": [{"owner": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "edited": false, "score": 1, "creation_date": 1492169529, "post_id": 43410291, "comment_id": 73880078, "body": "<a href=\"https://wiki.haskell.org/Show_instance_for_functions\" rel=\"nofollow noreferrer\">The wiki has some information</a> on this subject."}, {"owner": {"reputation": 14867, "user_id": 517371, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/0owFn.jpg?s=128&g=1", "display_name": "Tobia", "link": "https://stackoverflow.com/users/517371/tobia"}, "reply_to_user": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "edited": false, "score": 0, "creation_date": 1492188408, "post_id": 43410291, "comment_id": 73890147, "body": "@gspr Thanks. I figured it was a reason like that. But it still does not explain whether it could theoretically output anything more than <code>&lt;function&gt;</code>, such as the type signature, or not."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1492182170, "post_id": 43410869, "comment_id": 73886896, "body": "I downvoted. This doesn&#39;t appear to address the question as asked, which is about motivation rather than alternatives."}, {"owner": {"reputation": 14867, "user_id": 517371, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/0owFn.jpg?s=128&g=1", "display_name": "Tobia", "link": "https://stackoverflow.com/users/517371/tobia"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1492187767, "post_id": 43410869, "comment_id": 73889894, "body": "@DanielWagner Yes, motivation for the limited output of show was my primary question. Data.Typeable is interesting, but it seems to lack builtin or automatic instances for most functions, for example <code>(+1)</code> works, but <code>const (+1)</code> fails miserably"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 14867, "user_id": 517371, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/0owFn.jpg?s=128&g=1", "display_name": "Tobia", "link": "https://stackoverflow.com/users/517371/tobia"}, "edited": false, "score": 2, "creation_date": 1492198749, "post_id": 43410869, "comment_id": 73895300, "body": "@Tobia <code>Typeable</code> is derived for most types.  The problem you present is one of polymorphism - const introduces a free type variable that needs to be monomorphic for <code>typeOf</code>.  Try <code>typeOf (const (+1) :: String -&gt; Int -&gt; Int)</code>"}], "tags": [], "owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "is_accepted": true, "score": 3, "last_activity_date": 1492170270, "creation_date": 1492170270, "answer_id": 43410869, "question_id": 43410291, "link": "https://stackoverflow.com/questions/43410291/why-does-text-show-functions-only-return-function/43410869#43410869", "title": "Why does Text.Show.Functions only return &lt;function&gt;?", "body": "<p>Not exactly the same level of details, but you can use <code>typeOf</code> from <a href=\"https://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Typeable.html#v:typeOf\" rel=\"nofollow noreferrer\">Data.Typeable</a>:</p>\n\n<pre><code>Prelude&gt; import Data.Typeable\nPrelude Data.Typeable&gt; typeOf (+1)\nInteger -&gt; Integer\n</code></pre>\n"}], "owner": {"reputation": 14867, "user_id": 517371, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/0owFn.jpg?s=128&g=1", "display_name": "Tobia", "link": "https://stackoverflow.com/users/517371/tobia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 245, "favorite_count": 0, "accepted_answer_id": 43410869, "answer_count": 1, "score": 3, "last_activity_date": 1492170270, "creation_date": 1492167931, "question_id": 43410291, "link": "https://stackoverflow.com/questions/43410291/why-does-text-show-functions-only-return-function", "title": "Why does Text.Show.Functions only return &lt;function&gt;?", "body": "<p>The standard package to show functions only returns a constant string:</p>\n\n<pre><code>\u03bb&gt; :m +Text.Show.Functions \n\u03bb&gt; show (+1)\n\"&lt;function&gt;\"\n</code></pre>\n\n<p>GHCi's <code>:type</code> command is much more useful:</p>\n\n<pre><code>\u03bb&gt; :t (+1)\n(+1) :: Num a =&gt; a -&gt; a\n</code></pre>\n\n<p>Is it impossible to get such a level of detail at runtime? Does the compilation process leave any kind of information at all about functions, except for them being functions?</p>\n"}, {"tags": ["haskell", "quickcheck"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1492165418, "post_id": 43409610, "comment_id": 73878294, "body": "That\u2026 sounds like a XY problem."}, {"owner": {"reputation": 401, "user_id": 5256940, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/b6QRW.png?s=128&g=1", "display_name": "pterodragon", "link": "https://stackoverflow.com/users/5256940/pterodragon"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1492165815, "post_id": 43409610, "comment_id": 73878448, "body": "@Zeta I think everyone can search for the solution as StateT is in the Base library... but the point is, I want to test it"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1492166556, "post_id": 43409610, "comment_id": 73878740, "body": "I&#39;m not talking about <i>&quot;re-inventing the wheel&quot;</i> (by the way, <code>StateT</code> it&#39;s not in <code>base</code>). I&#39;m talking about that you <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">ask about &quot;X&quot; (how to write an Arbitarry instance) but actually just want &quot;Y&quot; (how to test my applicative instance of StateT)</a>."}, {"owner": {"reputation": 401, "user_id": 5256940, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/b6QRW.png?s=128&g=1", "display_name": "pterodragon", "link": "https://stackoverflow.com/users/5256940/pterodragon"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1492166711, "post_id": 43409610, "comment_id": 73878813, "body": "@Zeta Ok... Question title corrected"}, {"owner": {"reputation": 401, "user_id": 5256940, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/b6QRW.png?s=128&g=1", "display_name": "pterodragon", "link": "https://stackoverflow.com/users/5256940/pterodragon"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1492167045, "post_id": 43409610, "comment_id": 73878963, "body": "Since I&#39;m actually in practice mode, I actually want to know how to write Arbitrary instance for this complicated type also even if it isn&#39;t needed anyway..."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1492167596, "post_id": 43409610, "comment_id": 73879197, "body": "Allright. Could you add some more detail on <code>-- doesn&#39;t quite work</code>?"}, {"owner": {"reputation": 401, "user_id": 5256940, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/b6QRW.png?s=128&g=1", "display_name": "pterodragon", "link": "https://stackoverflow.com/users/5256940/pterodragon"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1492168732, "post_id": 43409610, "comment_id": 73879729, "body": "It looks like using <code>{-# LANGUAGE FlexibleContexts #-}</code>, I can write <code>Arbitrary (m a)</code> but I can&#39;t write <code>Arbitrary (m (a, s))</code>"}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 0, "creation_date": 1492194471, "post_id": 43409610, "comment_id": 73893271, "body": "Related: <a href=\"http://stackoverflow.com/q/38930234/1333025\">Testing monadic laws using QuickCheck</a>. And <a href=\"https://hackage.haskell.org/package/checkers-0.4.6/docs/Test-QuickCheck-Classes.html#v:applicative\" rel=\"nofollow noreferrer\"><code>applicative</code></a> test from the <i>checkers</i> package."}], "answers": [{"comments": [{"owner": {"reputation": 401, "user_id": 5256940, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/b6QRW.png?s=128&g=1", "display_name": "pterodragon", "link": "https://stackoverflow.com/users/5256940/pterodragon"}, "edited": false, "score": 1, "creation_date": 1492228087, "post_id": 43415006, "comment_id": 73902742, "body": ":) I can generate StateT instance by using <code>arbitrary :: Gen (StateT Int Maybe Bool)</code>. I actually don&#39;t quite get the &quot;@&quot; sign used when generating StateT instance and in <code>prop_StateTFunctorId</code>. Is that some kind of language extension? I couldn&#39;t search it..."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 401, "user_id": 5256940, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/b6QRW.png?s=128&g=1", "display_name": "pterodragon", "link": "https://stackoverflow.com/users/5256940/pterodragon"}, "edited": false, "score": 3, "creation_date": 1492252013, "post_id": 43415006, "comment_id": 73908020, "body": "@pterodragon Yes, it&#39;s <code>-XTypeApplications</code> extension. You can find some info in my answer: <a href=\"http://stackoverflow.com/questions/42999199/how-can-i-get-the-type-of-a-polymorphic-function-for-a-specific-type-class-insta/43000393#43000393\" title=\"how can i get the type of a polymorphic function for a specific type class insta\">stackoverflow.com/questions/42999199/&hellip;</a> There is link to haskell user guide, you can read more there. Very useful and nice feature. Brief overview here: <a href=\"http://kseo.github.io/posts/2017-01-08-visible-type-application-ghc8.html\" rel=\"nofollow noreferrer\">kseo.github.io/posts/&hellip;</a>"}, {"owner": {"reputation": 401, "user_id": 5256940, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/b6QRW.png?s=128&g=1", "display_name": "pterodragon", "link": "https://stackoverflow.com/users/5256940/pterodragon"}, "edited": false, "score": 0, "creation_date": 1492253859, "post_id": 43415006, "comment_id": 73908466, "body": "My machine doesn&#39;t have ghc 8, I will probably check later :)"}], "tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": true, "score": 3, "last_activity_date": 1492185274, "creation_date": 1492185274, "answer_id": 43415006, "question_id": 43409610, "link": "https://stackoverflow.com/questions/43409610/how-to-write-a-test-for-statet-using-quickcheck/43415006#43415006", "title": "How to write a test for StateT using QuickCheck", "body": "<p>Your question is really interesting. Indeed, it would be very nice to verify functor/apllicative/monad laws using <code>QuickCheck</code> for <code>StateT</code> monad transformer. Because this is one of the most useful applications of <code>QuickCheck</code>. </p>\n\n<p>But writing <code>Arbitrary</code> instance for <code>StateT</code> is not trivial. It's possible. But actually there is no profit in it. You should use <code>CoArbitrary</code> type class in some smart way. And also couple extensions. The idea is described in <a href=\"https://kseo.github.io/posts/2016-12-14-how-quick-check-generate-random-functions.html\" rel=\"nofollow noreferrer\">this blog post</a>. Having <code>CoArbitrary</code> instance for <code>a -&gt; b</code> you can easily create <code>Arbitrary</code> instance for <code>StateT</code>.</p>\n\n<pre><code>instance ( CoArbitrary s\n         , Arbitrary s\n         , Arbitrary a\n         , Arbitrary (m a)\n         , Monad m\n         ) =&gt; Arbitrary (StateT s m a)\n  where\n    arbitrary = StateT &lt;$&gt; promote (\\s -&gt; fmap (,s) &lt;$&gt; arbitrary)\n</code></pre>\n\n<p>Then you can generate states:</p>\n\n<pre><code>ghci&gt; (`runStateT` 3) &lt;$&gt; generate (arbitrary @(StateT Int Maybe Bool))\nJust (True,3)\n</code></pre>\n\n<p>And you can even write property:</p>\n\n<pre><code>propStateFunctorId :: forall m s a .\n                      ( Arbitrary s\n                      , Eq (m (a, s))\n                      , Show s\n                      , Show (m (a, s))\n                      , Functor m\n                      )\n                   =&gt; StateT s m a -&gt; Property\npropStateFunctorId st = forAll arbitrary $ \\s -&gt; \n                            runStateT (fmap id st) s === runStateT st s\n</code></pre>\n\n<p>But you can't run this property because it requires <code>instance Show</code> for <code>StateT</code> and you can't write sensible instance for it :( It's just how <code>QuickCheck</code> works. It should print failed counterexample. Knowledge of the fact that 100 tests were passed and 1 test failed doesn't really help you if you don't know which one failed. This is not a programming contest :)</p>\n\n<pre><code>ghci&gt; quickCheck (propStateFunctorId @Maybe @Int @Bool) \n&lt;interactive&gt;:68:1: error:\n    \u2022 No instance for (Show (StateT Int Maybe Bool))\n        arising from a use of \u2018quickCheck\u2019\n</code></pre>\n\n<p>So instead of generating arbitrary <code>StateT</code> it's better to generate <code>s</code> and <code>a</code> and then check properties.</p>\n\n<pre><code>prop_StateTFunctorId :: forall s a .\n                      ( Arbitrary s\n                      , Arbitrary a\n                      , Eq a\n                      , Eq s\n                      )\n                     =&gt; s -&gt; a -&gt; Bool\nprop_StateTFunctorId s a = let st = pure a\n                           in runStateT @_ @Maybe (fmap id st) s == runStateT st s\n\nghci&gt; quickCheck (prop_StateTFunctorId @Int @Bool) \n+++ OK, passed 100 tests.\n</code></pre>\n\n<p>This approach doesn't require knowledge of some high-level skills.</p>\n"}], "owner": {"reputation": 401, "user_id": 5256940, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/b6QRW.png?s=128&g=1", "display_name": "pterodragon", "link": "https://stackoverflow.com/users/5256940/pterodragon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 301, "favorite_count": 0, "accepted_answer_id": 43415006, "answer_count": 1, "score": 2, "last_activity_date": 1492185274, "creation_date": 1492165165, "last_edit_date": 1492166637, "question_id": 43409610, "link": "https://stackoverflow.com/questions/43409610/how-to-write-a-test-for-statet-using-quickcheck", "title": "How to write a test for StateT using QuickCheck", "body": "<p>The StateT is in <code>Control.Monad.Trans.State.Lazy</code></p>\n\n<p>The function inside and <code>m</code> being higher kinded makes it hard</p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts #-}\nimport Test.QuickCheck\n\nnewtype StateT s m a = StateT { runStateT :: s -&gt; m (a,s) }\ninstance (CoArbitrary s, Arbitrary s, Arbitrary a) =&gt; \n    Arbitrary (StateT s (Maybe) a) where -- doesn't quite work\n    arbitrary = undefined\n</code></pre>\n\n<p>The reason I want to do this is because I want to check using QuickCheck if the applicative instance for StateT that I write (for practice) is correct</p>\n\n<p>Edit:\nok, here is the instance I want to test (supposedly incorrect)</p>\n\n<pre><code>instance (Monad m) =&gt; Applicative (StateT s m) where\n    pure x = StateT (\\s -&gt; (\\a -&gt; (a, s)) &lt;$&gt; pure x)\n    StateT smfs &lt;*&gt; StateT smas = StateT $ \\s -&gt; liftA2 (\\ (f, s) (a, _) -&gt; (f a, s)) (smfs s) (smas s)\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 409, "user_id": 1897830, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4bb6f01afcee8d6fd59ccb93499732d6?s=128&d=identicon&r=PG", "display_name": "user1897830", "link": "https://stackoverflow.com/users/1897830/user1897830"}, "edited": false, "score": 0, "creation_date": 1492171667, "post_id": 43411129, "comment_id": 73881189, "body": "OS  W7 and GHC Ver 8.0.1"}], "tags": [], "owner": {"reputation": 13626, "user_id": 492865, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5c69a2080e68c8606961a18aba3a08ec?s=128&d=identicon&r=PG", "display_name": "Yuras", "link": "https://stackoverflow.com/users/492865/yuras"}, "is_accepted": false, "score": 1, "last_activity_date": 1492171306, "creation_date": 1492171306, "answer_id": 43411129, "question_id": 43409494, "link": "https://stackoverflow.com/questions/43409494/how-does-hwaitforinput-work/43411129#43411129", "title": "How does hWaitForInput work?", "body": "<p>What OS and GHC version are you using?</p>\n\n<p>AFAIK with the resent <code>GHC</code> versions <code>hWaitForInput</code> <a href=\"https://ghc.haskell.org/trac/ghc/ticket/13519\" rel=\"nofollow noreferrer\">doesn't work on linux</a> at all when timeout is not 0. On windows the whole IO subsystem is <a href=\"https://ghc.haskell.org/trac/ghc/ticket/12873#comment:1\" rel=\"nofollow noreferrer\">\"a bit lacking\"</a> too.</p>\n"}, {"tags": [], "owner": {"reputation": 24109, "user_id": 775954, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/9f5a87db35489d2958945f35b457f1ee?s=128&d=identicon&r=PG", "display_name": "Matthias Braun", "link": "https://stackoverflow.com/users/775954/matthias-braun"}, "is_accepted": false, "score": 1, "last_activity_date": 1558082763, "creation_date": 1558082763, "answer_id": 56182787, "question_id": 43409494, "link": "https://stackoverflow.com/questions/43409494/how-does-hwaitforinput-work/56182787#56182787", "title": "How does hWaitForInput work?", "body": "<blockquote>\n  <p>However once a character has been entered it no longer times out. No matter what the input wait time is.</p>\n</blockquote>\n\n<p>That's how it's supposed to work according to <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/System-IO.html#v:hWaitForInput\" rel=\"nofollow noreferrer\">the docs</a>:</p>\n\n<blockquote>\n  <p>Computation hWaitForInput hdl t waits until input is available on handle hdl. It returns True as soon as input is available on hdl, or False if no input is available within t milliseconds.</p>\n</blockquote>\n\n<p>Here's a usage example of <code>hWaitForInput</code> where it will wait for five seconds and then check if there are characters in <code>stdin</code>. If not, it will say \"Timeout reached\". Otherwise it'll wait for the user to hit enter (<code>hGetLine</code> checks for the end of line) and print the user-entered string:</p>\n\n<pre><code>main :: IO ()\nmain =\n  hWaitForInput stdin 5000 &gt;&gt;= \\inputIsAvailable -&gt;\n    if inputIsAvailable\n      then hGetLine stdin &gt;&gt;= \\input -&gt; putStrLn $ \"There is input: \" ++ input\n      else putStrLn \"Timeout reached\"\n</code></pre>\n"}], "owner": {"reputation": 409, "user_id": 1897830, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/4bb6f01afcee8d6fd59ccb93499732d6?s=128&d=identicon&r=PG", "display_name": "user1897830", "link": "https://stackoverflow.com/users/1897830/user1897830"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1558082763, "creation_date": 1492164637, "question_id": 43409494, "link": "https://stackoverflow.com/questions/43409494/how-does-hwaitforinput-work", "title": "How does hWaitForInput work?", "body": "<p>This bit of code gets characters from <code>stdin</code> and converts them to a String. There is a timeout on the input implemented with <code>hWaitForInput</code>. I have included the <code>tryIOError</code> function to capture <code>isEOFError</code>. It times out correctly when the program is run and no input has taken place ie.it is waiting for input. However once a character has been entered it no longer times out. No matter what the input wait time is.</p>\n\n<pre><code>-- get string from stdin\ngetFrmStdIn :: Int -&gt; IO String\ngetFrmStdIn timeout = do\n  inAvail &lt;- tryIOError $ hWaitForInput stdin timeout\n  let tOut = either (const False) id inAvail\n  if isLeft inAvail\n    then return []\n  else\n    if not tOut\n      then die \"00 timed out\"\n    else\n      (:) &lt;$&gt; hGetChar stdin &lt;*&gt; getFrmStdIn timeout\n</code></pre>\n"}, {"tags": ["haskell", "monads", "monad-transformers", "applicative", "maybe"], "comments": [{"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1492162713, "post_id": 43408620, "comment_id": 73877037, "body": "Judging from the error, you are missing <code>return</code>, not <code>liftIO</code>."}, {"owner": {"reputation": 328, "user_id": 1213968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b53fb563063c6f31b403b5cb5d978ac6?s=128&d=identicon&r=PG", "display_name": "tmpz", "link": "https://stackoverflow.com/users/1213968/tmpz"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1492169370, "post_id": 43408620, "comment_id": 73880023, "body": "@arrowd could well be, but unfortunately that does not help with my applicative problem here. Maybe this is not the right approach to begin with?"}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 0, "creation_date": 1492729434, "post_id": 43408620, "comment_id": 74115171, "body": "Can you include the code where the <code>runReaderT ...</code> expression actually appears?  Most likely, it&#39;s being used in the do-block in a such a way that Haskell is trying to type it as <code>ExceptT String IO ()</code> instead of <code>Maybe (IO ())</code>.  This would ultimately explain both errors, as <code>Maybe</code> isn&#39;t <code>ExceptT String IO</code>, and <code>()</code> isn&#39;t <code>IO ()</code>.  It may be as simple as adding a standard Maybe-to-ExceptT interface."}, {"owner": {"reputation": 328, "user_id": 1213968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b53fb563063c6f31b403b5cb5d978ac6?s=128&d=identicon&r=PG", "display_name": "tmpz", "link": "https://stackoverflow.com/users/1213968/tmpz"}, "reply_to_user": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 0, "creation_date": 1492802535, "post_id": 43408620, "comment_id": 74153269, "body": "@K.A.Buhr it just appears in the middle of a <code>do</code> block in a <code>ExceptT String IO ()</code> see edit"}], "answers": [{"comments": [{"owner": {"reputation": 328, "user_id": 1213968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b53fb563063c6f31b403b5cb5d978ac6?s=128&d=identicon&r=PG", "display_name": "tmpz", "link": "https://stackoverflow.com/users/1213968/tmpz"}, "edited": false, "score": 0, "creation_date": 1492811030, "post_id": 43550859, "comment_id": 74157077, "body": "You are right, I was completely confused by the error message and all those <code>T</code>s . Generally I find it quite difficult to compose monad transformers, <code>maybe</code> (wink wink) I&#39;m doing it wrong :)"}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 2, "last_activity_date": 1492804460, "last_edit_date": 1492804460, "creation_date": 1492803992, "answer_id": 43550859, "question_id": 43408620, "link": "https://stackoverflow.com/questions/43408620/monad-transformer-and-applicative-maybe/43550859#43550859", "title": "Monad Transformer and applicative Maybe", "body": "<p><strong>Edit:</strong> Oops, fixed a bug.</p>\n\n<p>There seems to be a minor inconsistency in your question, because the do-block you provide contains a <code>runReaderT ...</code> expression that doesn't match the expression given in your error message.</p>\n\n<p>However, ultimately the problem is this:  in a do-block of type <code>m a</code> for some monad <code>m</code>, each plain expression (and each right-hand side of an <code>x &lt;- y</code> expression) has to have type <code>m b</code> for some <code>b</code>.  So, by using your <code>runReaderT ...</code> expression in a do-block of type <code>ExceptT String IO ()</code>, you're forcing Haskell to type-check it as <code>ExceptT String IO a</code> for some <code>a</code>.  However, it's a <code>Maybe (IO ())</code>, so that type-checking will fail.</p>\n\n<p>You'd get a similar error if you tried:</p>\n\n<pre><code>foo :: ExceptT String IO ()\nfoo = do Just (putStrLn \"won't work\")   -- has type Maybe (IO ())\n         undefined\n</code></pre>\n\n<p>You need to decide how to adapt the <code>runReaderT ...</code> expression to the surrounding do-block.  Two reasonable options are:</p>\n\n<pre><code>foo = do ...\n         maybe (throwError \"reader was Nothing!\") liftIO\n             $ runReaderT ...\n         undefined\n</code></pre>\n\n<p>which will throw an <code>ExceptT</code>-style error if your <code>maybeReader</code> is <code>Nothing</code> or:</p>\n\n<pre><code>foo = do ...\n         maybe (return ()) liftIO\n             $ runReaderT ...\n         undefined\n</code></pre>\n\n<p>which will do .. erm .. nothing in case of <code>Nothing</code>.  </p>\n"}], "owner": {"reputation": 328, "user_id": 1213968, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b53fb563063c6f31b403b5cb5d978ac6?s=128&d=identicon&r=PG", "display_name": "tmpz", "link": "https://stackoverflow.com/users/1213968/tmpz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 43550859, "answer_count": 1, "score": 1, "last_activity_date": 1492804460, "creation_date": 1492161181, "last_edit_date": 1492802676, "question_id": 43408620, "link": "https://stackoverflow.com/questions/43408620/monad-transformer-and-applicative-maybe", "title": "Monad Transformer and applicative Maybe", "body": "<p>Inside a do block of a <code>ExceptT String IO ()</code></p>\n\n<p>I have a function that produces a ReaderT like so:</p>\n\n<pre><code>type UDCEnv = (AWS.Env, Bool)\n\nuploadVersionFilesToCaches :: S3.BucketName\n                               -&gt; FilePath\n                               -&gt; [GitRepoNameAndVersion]\n                               -&gt; ReaderT UDCEnv IO ()\n</code></pre>\n\n<p>I just so happen to have a <code>Maybe FilePath</code> so I create my ReaderT like so:</p>\n\n<pre><code>let maybeReader ::  Maybe (ReaderT UDCEnv IO ()) =\n    uploadVersionFilesToCaches s3BucketName &lt;$&gt; maybeFilePath &lt;*&gt; Just gitRepoNamesAndVersions\n</code></pre>\n\n<p>I can even run the ReaderT like so:</p>\n\n<pre><code>let maybeIO :: Maybe (IO ()) = \n    runReaderT &lt;$&gt; maybeReader &lt;*&gt; Just (env, shouldIgnoreLocalCache, verbose)\n</code></pre>\n\n<p>Everything works fine as long as I use <code>let</code> expressions. As soon as I drop the <code>let</code> in the expression above to actually try to have expression evaluated Applicative gets types as <code>ExceptT String IO FilePath</code> instead of <code>Maybe</code></p>\n\n<p>The parts I am omitting are marked by <code>...</code> :</p>\n\n<pre><code>f :: ... -&gt; ExceptT String IO ()\nf ... = do\n   ... \n   runReaderT &lt;$&gt; maybeReader &lt;*&gt; Just (env, shouldIgnoreLocalCache, verbose) -- Error here\n   undefined\n</code></pre>\n\n<p>Produces</p>\n\n<pre><code>Couldn't match type \u2018IO ()\u2019 with \u2018()\u2019\nExpected type: ReaderT UDCEnv IO () -&gt; UDCEnv -&gt; ()\n  Actual type: ReaderT UDCEnv IO () -&gt; UDCEnv -&gt; IO ()\nIn the first argument of \u2018(&lt;$&gt;)\u2019, namely \u2018runReaderT\u2019\nIn the first argument of \u2018(&lt;*&gt;)\u2019, namely\n  \u2018runReaderT\n   &lt;$&gt;\n     (uploadVersionFilesToCaches s3BucketName &lt;$&gt; maybeFilePath\n      &lt;*&gt; Just gitRepoNamesAndVersions)\u2019\n/Users/blender/Code/Personal/Haskell/Rome-Public/src/Lib.hs: 82, 73\n\nCouldn't match type \u2018Maybe\u2019 with \u2018ExceptT String IO\u2019\n    Expected type: ExceptT String IO FilePath\n      Actual type: Maybe FilePath\n    In the second argument of \u2018(&lt;$&gt;)\u2019, namely \u2018maybeFilePath\u2019\n    In the first argument of \u2018(&lt;*&gt;)\u2019, namely\n      \u2018uploadVersionFilesToCaches s3BucketName &lt;$&gt; maybeFilePath\u2019\n</code></pre>\n\n<p>I think the first error is because I'm missing some <code>liftIO</code> somewhere. </p>\n\n<p>However I have no idea what to do about the misunderstood Applicative.</p>\n\n<p>I could case analysis on the Maybe of course instead of using Applicative but I would really prefer not to.</p>\n"}, {"tags": ["haskell", "fold", "type-level-computation"], "comments": [{"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1492172289, "post_id": 43405415, "comment_id": 73881513, "body": "Why not <code>type Fun as bs = forall z. Tupled as z -&gt; Tupled bs z</code>?"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1492198834, "post_id": 43405415, "comment_id": 73895347, "body": "@Li-yaoXia: I want to be able to pass a <code>Fun</code> as an argument to a <code>Fun</code>, so I need the <code>newtype</code> to hide the impredicativity."}], "answers": [{"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1492161623, "post_id": 43407491, "comment_id": 73876548, "body": "I should have noted this in the question, but enabling this seems to make no difference\u2014I get the same error message. I\u2019m using GHC 8.0.2 from the <code>lts-8.9</code> Stack resolver."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1492176704, "post_id": 43407491, "comment_id": 73883757, "body": "This <a href=\"http://lpaste.net/354579\" rel=\"nofollow noreferrer\">file</a> is accepted by both GHC 8.0.1 and 8.0.2. I&#39;m not sure what&#39;s wrong on your side (also, I used closed type familiy there but open works just as well)."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1492219426, "post_id": 43407491, "comment_id": 73901360, "body": "Aha, <code>newtype Fun as bs = Fun (forall z. \u2026)</code> typechecks, but <code>\u2026 = Fun { unfun :: forall z. \u2026 }</code> does not. I was confused because the <i>definition</i> of <code>unfun</code> is considered an ambiguous <i>use site</i>. Making it a separate function and using a type application <code>unfun :: forall as bs z. Fun as bs -&gt; Tupled as z -&gt; Tupled bs z; unfun (Fun f) as = f @z as</code> solves the problem. Thanks for helping me figure this out. :)"}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 4, "last_activity_date": 1492156458, "creation_date": 1492156458, "answer_id": 43407491, "question_id": 43405415, "link": "https://stackoverflow.com/questions/43405415/polymorphic-functions-over-chains-of-nested-tuples/43407491#43407491", "title": "Polymorphic functions over chains of nested tuples", "body": "<p>Enable <code>AllowAmbiguousTypes</code>. From GHC 8, the ambiguity check is completely superfluous, because any (fundamentally resolvable) ambiguity can be resolved with type applications. Also, your case seems to be just a false positive for ambiguity check, since we can clearly use <code>Fun</code> even without type applications.</p>\n"}], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 43407491, "answer_count": 1, "score": 5, "last_activity_date": 1492156458, "creation_date": 1492145819, "last_edit_date": 1492150580, "question_id": 43405415, "link": "https://stackoverflow.com/questions/43405415/polymorphic-functions-over-chains-of-nested-tuples", "title": "Polymorphic functions over chains of nested tuples", "body": "<p>Suppose I have a list of types, of kind <code>[*]</code>:</p>\n\n<pre><code>let Ts = '[Int, Bool, Char]\n</code></pre>\n\n<p>I want to convert this to a chain of tuples:</p>\n\n<pre><code>type family Tupled (ts :: [*]) z :: *\ntype instance Tupled (t ': ts) z = (t, Tupled ts z)\ntype instance Tupled '[] z = z\n</code></pre>\n\n<p>So far so good:</p>\n\n<pre><code>&gt; :kind! Tupled Ts ()\nTupled Ts () :: *\n= (Int, (Bool, (Char, ())))\n</code></pre>\n\n<p>Now I\u2019d like to be able to write a type <code>Fun</code> to represent functions that are polymorphic in the \u201cbottom\u201d of this chain. For example, <code>Fun Ts Ts</code> should work on either of these types:</p>\n\n<pre><code>(Int, (Bool, (Char, (String, ()))))\n(Int, (Bool, (Char, (Word, (ByteString, ())))))\n</code></pre>\n\n<p>I tried this:</p>\n\n<pre><code>newtype Fun as bs = Fun\n  { unfun :: forall z. Tupled as z -&gt; Tupled bs z }\n</code></pre>\n\n<p>But it fails to typecheck:</p>\n\n<pre><code>Couldn't match type \u2018Tupled bs z\u2019 with \u2018Tupled bs z0\u2019\nNB: \u2018Tupled\u2019 is a type function, and may not be injective\nThe type variable \u2018z0\u2019 is ambiguous\nExpected type: Tupled as z -&gt; Tupled bs z\n  Actual type: Tupled as z0 -&gt; Tupled bs z0\nIn the ambiguity check for the type of the constructor \u2018Fun\u2019:\n  Fun :: forall z. Tupled as z -&gt; Tupled bs z\nTo defer the ambiguity check to use sites, enable AllowAmbiguousTypes\nIn the definition of data constructor \u2018Fun\u2019\nIn the newtype declaration for \u2018Fun\u2019\n</code></pre>\n\n<p>I\u2019ve seen recommendations to use a data family to avoid problems with injectivity:</p>\n\n<pre><code>data family Tupled (ts :: [*]) z :: *\ndata instance Tupled (t ': ts) z = Cons t (Tupled ts z)\ndata instance Tupled '[] z = Nil\n</code></pre>\n\n<p>And indeed that makes <code>Fun</code> compile, but it looks like that gets me \u201cstuck\u201d in the land of <code>Cons</code> and <code>Nil</code> when I\u2019m looking to work with tuples, like this:</p>\n\n<pre><code>Fun $ \\ (i, (b, (c, z))) -&gt; (succ i, (not b, (pred c, z)))\n</code></pre>\n\n<p>Can I work around this somehow?</p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 5, "creation_date": 1492136609, "post_id": 43404290, "comment_id": 73869136, "body": "In what way is that not the definition you want? It seems to me that it works just fine - the result would be <code>[1]</code>, and if you want to wrap each element of that result in <code>Element</code> (for whatever reason...) then just do <code>map Element . flatten</code>."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1492145687, "post_id": 43404290, "comment_id": 73870897, "body": "A simpler, equivalent definition would be to replace the last two clauses with <code>flatten (Sublist xs) = xs &gt;&gt;= flatten</code>."}, {"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1492146658, "post_id": 43404290, "comment_id": 73871097, "body": "FWIW, <code>NestedList</code> is just <code>Free []</code>, and <code>flatten</code> is just <code>toList</code> from <code>instance Foldable f =&gt; Foldable (Free f)</code> and <code>instance Foldable []</code>."}, {"owner": {"reputation": 1826, "user_id": 519568, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2d77dac9b768c1f5e134afda30314c07?s=128&d=identicon&r=PG", "display_name": "David Jeske", "link": "https://stackoverflow.com/users/519568/david-jeske"}, "edited": false, "score": 0, "creation_date": 1492149915, "post_id": 43404290, "comment_id": 73871990, "body": "if that is not what you want, what do you want?"}, {"owner": {"reputation": 31, "user_id": 6026981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/053d50d356c9096efdc8f320ee7e02cb?s=128&d=identicon&r=PG&f=1", "display_name": "Mithsul", "link": "https://stackoverflow.com/users/6026981/mithsul"}, "edited": false, "score": 0, "creation_date": 1492185697, "post_id": 43404290, "comment_id": 73888897, "body": "I mean I need to take an input like [Element 1, SubList []] instead of SubList [Element 1, SubList []]."}], "answers": [{"tags": [], "owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "is_accepted": false, "score": 0, "last_activity_date": 1492147306, "creation_date": 1492147306, "answer_id": 43405613, "question_id": 43404290, "link": "https://stackoverflow.com/questions/43404290/a-list-of-recursive-data-structure-as-function-input/43405613#43405613", "title": "A List of Recursive Data Structure as Function Input", "body": "<p>If you want to flatten your <code>NestedList</code> into a flat <code>NestedList</code> instead of a normal list, you can define a separate function <code>fromList :: [a] -&gt; NestedList a</code> that builds a flat nested list from a normal list.</p>\n\n<pre><code>fromList :: [a] -&gt; NestedList a\nfromList l = SubList (toElems l)\n  where\n    toElems :: [a] -&gt; [SubList a]\n    toElems (x:xs) = Element x : toElems xs\n    toElems [] = []\n</code></pre>\n\n<p>or simply</p>\n\n<pre><code>fromList = SubList . map Element\n</code></pre>\n\n<p>and write</p>\n\n<pre><code>flattenNested :: NestedList a -&gt; NestedList a\nflattenNested = fromList . flatten\n</code></pre>\n\n<p>Of course, you can also write <code>flatten</code> itself more simply as:</p>\n\n<pre><code>flatten :: NestedList a -&gt; [a]\nflatten (Element a) = [a]\nflatten (SubList xs) = concat (map flatten xs)\n</code></pre>\n\n<p>or even one of these increasingly nerdy substitutes:</p>\n\n<pre><code>flatten (SubList xs) = concatMap flatten xs\n</code></pre>\n\n<p>Since <code>concatMap</code> is the same as <code>=&lt;&lt;</code>:</p>\n\n<pre><code>flatten (SubList xs) = flatten =&lt;&lt; xs\n</code></pre>\n\n<p>Since <code>NestedList</code> is isomorphic to <code>Free []</code>:</p>\n\n<pre><code>flatten :: Free [] a -&gt; [a]\nflatten (Pure a) = [a]\nflatten (Free xs) = flatten =&lt;&lt; xs\n</code></pre>\n\n<p>Or by (ab)using this relationship even further:</p>\n\n<pre><code>flatten :: Free [] a -&gt; [a]\nflatten = toList\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 0, "last_activity_date": 1492808328, "creation_date": 1492808328, "answer_id": 43551905, "question_id": 43404290, "link": "https://stackoverflow.com/questions/43404290/a-list-of-recursive-data-structure-as-function-input/43551905#43551905", "title": "A List of Recursive Data Structure as Function Input", "body": "<p>I suspect you're looking for the following:</p>\n\n<pre><code>flatten :: [NestedList a] -&gt; [NestedList a]\nflatten (Element a  : rest) = Element a : flatten rest\nflatten (SubList xs : rest) = flatten xs ++ flatten rest\nflatten [] = []\n</code></pre>\n\n<p>which appears to do what you want:</p>\n\n<pre><code>&gt; flatten [Element 1, SubList []]\n[Element 1]\n&gt; flatten [Element 1, SubList [Element 2, SubList []]]\n[Element 1,Element 2]\n&gt;\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6026981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/053d50d356c9096efdc8f320ee7e02cb?s=128&d=identicon&r=PG&f=1", "display_name": "Mithsul", "link": "https://stackoverflow.com/users/6026981/mithsul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "accepted_answer_id": 43551905, "answer_count": 2, "score": 0, "last_activity_date": 1492808328, "creation_date": 1492135928, "last_edit_date": 1492185611, "question_id": 43404290, "link": "https://stackoverflow.com/questions/43404290/a-list-of-recursive-data-structure-as-function-input", "title": "A List of Recursive Data Structure as Function Input", "body": "<p>I defined a recursive data structure in Haskell:</p>\n\n<pre><code>data NestedList a = Element a | SubList [NestedList a]\n</code></pre>\n\n<p>and then I want to define a <code>flatten</code> function which will take a list of NestedList and return the flattened result, for example:</p>\n\n<pre><code>Input: [Element 1, SubList [Element 2, SubList [] ]]\nOutput: [Element 1, Element 2].\n</code></pre>\n\n<p>However, my definition of function is not correct:</p>\n\n<pre><code>flatten :: NestedList a -&gt; [a]\nflatten (Element a) = [a]\nflatten (SubList (x:xs)) = flatten x ++ flatten (SubList xs)\nflatten (SubList []) = []\n</code></pre>\n\n<p>According to this definition, my function will work like:</p>\n\n<pre><code>flatten (SubList [Element 1, SubList []])\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>flatten [Element 1, SubList []]\n</code></pre>\n\n<p>So this <code>flatten</code> cannot take the input I mentioned above, so how should I define <code>flatten</code> to make it take input like [Element 1, SubList [Element 2, SubList [] ]]?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 7864785, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/110e8c32d0a3e8ec38ec51948c103363?s=128&d=identicon&r=PG&f=1", "display_name": "octoCat", "link": "https://stackoverflow.com/users/7864785/octocat"}, "edited": false, "score": 0, "creation_date": 1492136230, "post_id": 43404178, "comment_id": 73869053, "body": "Thanks and unfortunately I have to make my own complex. Also, escapeCount has a signature which I&#39;m trying to implement under instance but how do I access the second &quot;Parameter&quot; it takes? Also when I tried to do pattern matching it said Variable not in scope?"}], "tags": [], "owner": {"reputation": 833, "user_id": 7847896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3e72cb1d5eceb94842bec50894e6943?s=128&d=identicon&r=PG&f=1", "display_name": "zbw", "link": "https://stackoverflow.com/users/7847896/zbw"}, "is_accepted": false, "score": 1, "last_activity_date": 1492134909, "creation_date": 1492134909, "answer_id": 43404178, "question_id": 43403983, "link": "https://stackoverflow.com/questions/43403983/how-do-you-get-a-specific-type-from-a-data-definition-in-an-instance/43404178#43404178", "title": "How do you get a specific type from a data definition in an instance?", "body": "<p>I'm not sure the specifics of what you're trying to accomplish, but you can access the parts of these datatypes with pattern matching:</p>\n\n<pre><code>instance Fractal Mandelbrot where\n    escapeCount (M maxIter row col c1 c2) c3 = ...\n</code></pre>\n\n<p>This makes the parts available within the function as the variables <code>maxIter</code>, <code>row</code>, <code>col</code>, etc.</p>\n\n<p>You can do as much pattern matching as needed:</p>\n\n<pre><code>escapeCount (M maxIter row col (C real1 imag1) (C real2 imag2)) (C real3 imag3) = ...\n</code></pre>\n\n<p>Also, I recommend the <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Data-Complex.html#t:Complex\" rel=\"nofollow noreferrer\"><code>Complex</code> datatype from <code>Data.Complex</code></a>, instead of making your own.  It already has a <code>Num</code> instance, so you can add, subtract, etc. them just like with normal numbers, as well as a base of useful functions.</p>\n"}], "owner": {"reputation": 31, "user_id": 7864785, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/110e8c32d0a3e8ec38ec51948c103363?s=128&d=identicon&r=PG&f=1", "display_name": "octoCat", "link": "https://stackoverflow.com/users/7864785/octocat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492135607, "creation_date": 1492133104, "last_edit_date": 1492135607, "question_id": 43403983, "link": "https://stackoverflow.com/questions/43403983/how-do-you-get-a-specific-type-from-a-data-definition-in-an-instance", "title": "How do you get a specific type from a data definition in an instance?", "body": "<p>I'm going to assume that in the instance of <code>Fractal Mandelbrot</code>, in <code>escapeCount f (C comp3)</code> the <code>f</code> stands for <code>Mandelbrot</code> datatype. How would I access an element of that such as MaxIter. Do I just have to write definitions for each element that I could want?</p>\n\n<pre><code>  type MaxIter = Int\n  type Row = Int \n  type Col = Int \n  data Complex = C Double Double                    deriving (Show,Eq)\n  data Mandelbrot = M MaxIter Row Col Complex Complex    deriving (Eq)\n\n  class (Show f) =&gt; Fractal f where \n  escapeCount :: f -&gt; Complex -&gt; Int\n\n  instance Fractal Mandelbrot where\n              escapeCount f (C comp3) = &lt;- I assume this means that comp3 is of type C?\n</code></pre>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 4516, "user_id": 1937198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b97a3ec92aed1c16e35c1bf532465d6b?s=128&d=identicon&r=PG", "display_name": "user1937198", "link": "https://stackoverflow.com/users/1937198/user1937198"}, "edited": false, "score": 2, "creation_date": 1492129388, "post_id": 43403525, "comment_id": 73867631, "body": "<code>Num n =&gt; (n -&gt; n)</code> means that your function will work with any function that takes transforms a concrete type to a concrete type so long as that type is an instance of Num. It does not mean it takes a function that can handle any instance of Num. What I am not sure is how to express that within the haskell typesystem."}, {"owner": {"reputation": 10963, "user_id": 306257, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/701752cfc3dd805d412884f38a464296?s=128&d=identicon&r=PG", "display_name": "Haldean Brown", "link": "https://stackoverflow.com/users/306257/haldean-brown"}, "reply_to_user": {"reputation": 4516, "user_id": 1937198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b97a3ec92aed1c16e35c1bf532465d6b?s=128&d=identicon&r=PG", "display_name": "user1937198", "link": "https://stackoverflow.com/users/1937198/user1937198"}, "edited": false, "score": 0, "creation_date": 1492129530, "post_id": 43403525, "comment_id": 73867664, "body": "Ah! That was exactly the clue I needed, thanks. Writing an answer now..."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 2, "creation_date": 1492129564, "post_id": 43403525, "comment_id": 73867671, "body": "you need only change <code>wrap :: (forall n. Num n =&gt; n -&gt; n) -&gt; X -&gt; X</code>."}], "answers": [{"tags": [], "owner": {"reputation": 10963, "user_id": 306257, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/701752cfc3dd805d412884f38a464296?s=128&d=identicon&r=PG", "display_name": "Haldean Brown", "link": "https://stackoverflow.com/users/306257/haldean-brown"}, "is_accepted": true, "score": 4, "last_activity_date": 1492129650, "creation_date": 1492129650, "answer_id": 43403625, "question_id": 43403525, "link": "https://stackoverflow.com/questions/43403525/polymorphic-functions-as-parameters-in-haskell/43403625#43403625", "title": "Polymorphic functions as parameters in Haskell", "body": "<p>Thanks to @user1937198, I figured out that the implicit qualification of <code>n</code> was happening in the wrong scope; I was saying that I wanted to take a function that took any type that satisfied <code>Num</code> and mapped that type onto the same type, when what I wanted to say was I needed a function that took all types that satisfied <code>Num</code>. With <code>RankNTypes</code> the code becomes:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\ndata X = Y Integer\n       | Z Double\nwrap :: (forall n. Num n =&gt; n -&gt; n) -&gt; X -&gt; X\nwrap f (Y i) = Y $ f i\nwrap f (Z i) = Z $ f i\n</code></pre>\n\n<p>and all is good again. Thanks!</p>\n"}], "owner": {"reputation": 10963, "user_id": 306257, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/701752cfc3dd805d412884f38a464296?s=128&d=identicon&r=PG", "display_name": "Haldean Brown", "link": "https://stackoverflow.com/users/306257/haldean-brown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 1, "accepted_answer_id": 43403625, "answer_count": 1, "score": 2, "last_activity_date": 1492129650, "creation_date": 1492128688, "question_id": 43403525, "link": "https://stackoverflow.com/questions/43403525/polymorphic-functions-as-parameters-in-haskell", "title": "Polymorphic functions as parameters in Haskell", "body": "<p>I have an ADT with two constructors; one that wraps a <code>Double</code> and one that wraps an <code>Integer</code>. I would like to create a function that takes a unary function on the <code>Num</code> typeclass and returns a function that applies that unary function to the contents of my ADT.</p>\n\n<p>I've tried this:</p>\n\n<pre><code>data X = Y Integer\n       | Z Double\nwrap :: Num n =&gt; (n -&gt; n) -&gt; X -&gt; X\nwrap f (Y i) = Y $ f i\nwrap f (Z i) = Z $ f i\n</code></pre>\n\n<p>But the compiler informs me that it can't match the type variable <code>n</code> to the type <code>Double</code> in the second definition of <code>wrap</code>:</p>\n\n<pre><code>test.hs:5:22: error:\n    \u2022 Couldn't match expected type \u2018n\u2019 with actual type \u2018Double\u2019\n      \u2018n\u2019 is a rigid type variable bound by\n        the type signature for:\n          wrap :: forall n. Num n =&gt; (n -&gt; n) -&gt; X -&gt; X\n        at test.hs:3:9\n    \u2022 In the first argument of \u2018f\u2019, namely \u2018i\u2019\n      In the second argument of \u2018($)\u2019, namely \u2018f i\u2019\n      In the expression: Z $ f i\n    \u2022 Relevant bindings include\n        f :: n -&gt; n (bound at test.hs:5:6)\n        wrap :: (n -&gt; n) -&gt; X -&gt; X (bound at test.hs:4:1)\n</code></pre>\n\n<p>If I remove the second definition (so I only define <code>wrap</code> on the integer constructor <code>Y</code>), I get the same error, but on the first definition instead (and with <code>actual type 'Integer'</code> instead of double).</p>\n\n<p>If instead I remove the type signature, the first definition causes it to infer the type <code>(Integer -&gt; Integer) -&gt; X -&gt; X</code> for wrap, which (expectedly) causes the second definition to fail to type check.</p>\n\n<p>This seems like such a simple problem that I must be missing something glaringly obvious. Thanks in advance for your help and patience!</p>\n"}, {"tags": ["haskell", "lazy-evaluation"], "comments": [{"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 3, "creation_date": 1492125979, "post_id": 43403095, "comment_id": 73866912, "body": "It must build and organize the <code>Map</code> before looking up elements (due to the internal implementation of a <code>Map</code> as a binary search tree). <code>lookup 1 (iterate apply (0,1))</code> has no such problem, since it doesn&#39;t need to create a search tree, it just traverses the list, ignoring the infinite tail."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1492127004, "post_id": 43403095, "comment_id": 73867117, "body": "I made <a href=\"https://hackage.haskell.org/package/data-inttrie\" rel=\"nofollow noreferrer\">data-inttrie</a> for maps that can be lazy in this way."}], "owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492125412, "creation_date": 1492125412, "question_id": 43403095, "link": "https://stackoverflow.com/questions/43403095/implementing-an-inc-function-with-data-map-in-haskell", "title": "Implementing an inc function with Data.Map in Haskell", "body": "<p>I try to reimplement a simple increment function using <code>Data.Map</code>. However eagerness makes my program hang:</p>\n\n<pre><code>apply :: Num a =&gt; (a, a) -&gt; (a, a)\napply (a, b) = (a + 1, b + 1)\n\ninc :: Map Int Int\ninc = fromList (iterate apply (0, 1))\ninc ! 1 -- program freezes...\n</code></pre>\n\n<p>I don't get why it freezes? Why is it eager?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1492174671, "post_id": 43402733, "comment_id": 73882695, "body": "Note that this kind of task can be done much nicer using a <i>typed physical quantity library</i>, such as <a href=\"http://hackage.haskell.org/package/units\" rel=\"nofollow noreferrer\">units</a>. Also, I wouldn&#39;t write a <i>program executable</i> for such computations, ghci is much more handy \u2013 or IHaskell. Here&#39;s how it would look for the string-tension calculator: <a href=\"http://nbviewer.jupyter.org/gist/leftaroundabout/7a42ac10e89293605f4f18b9ec61b998\" rel=\"nofollow noreferrer\">nbviewer.jupyter.org/gist/leftaroundabout/&hellip;</a> (You can freely mix units from different unit systems, and the library automatically performs the right unit conversions. Also it will complain if you enter units whose dimension don&#39;t match up.)"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 0, "last_activity_date": 1492156271, "creation_date": 1492156271, "answer_id": 43407446, "question_id": 43402733, "link": "https://stackoverflow.com/questions/43402733/instrument-string-tension-calculator-in-haskell/43407446#43407446", "title": "Instrument string tension calculator in Haskell", "body": "<p>I'll give you an hint for a basic solution.</p>\n\n<p>Define your map as a list of pairs <code>(gauge, unitWeight)</code>. Make it ordered according to <code>gauge</code>.</p>\n\n<pre><code>gw :: [(Double, Double)]\ngw = [(1, 2), (2, 4), ... ]\n</code></pre>\n\n<p>Then, assume you have a <code>g</code> to lookup. You want to discard from <code>gw</code> all the initial pairs with gauge <code>&lt;g</code>. For that, you can use</p>\n\n<pre><code>dropWhile (some predicate here) gw\n</code></pre>\n\n<p>then, you can take the first pair element in the remaining list, and extract the unit weight.</p>\n\n<p>This is not terribly efficient since you scan almost the whole list every time, depending on your gauge. One could improve this with <code>Data.Map.Map</code>. Yet, for a beginner exercise, using a list should do. You probably won't have a huge amount of list items anyway, so the program should still be pretty fast.</p>\n"}], "owner": {"reputation": 11, "user_id": 7864582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31c308c90ae615857045b34ff242265f?s=128&d=identicon&r=PG&f=1", "display_name": "splntrdgrss", "link": "https://stackoverflow.com/users/7864582/splntrdgrss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1492156271, "creation_date": 1492122830, "question_id": 43402733, "link": "https://stackoverflow.com/questions/43402733/instrument-string-tension-calculator-in-haskell", "title": "Instrument string tension calculator in Haskell", "body": "<p>I'm completely new to Haskell, so please bear that in mind</p>\n\n<p>I'm working on a fairly simple (or so do I think) project - a string instrument tension calculator. Here's what I've got so far:</p>\n\n<pre><code>data Operator = Metric | Imperial\n  deriving Read\n\neval o l u p = case o of\n  Imperial -&gt; (((2 * l * p)^2) * u) / 386.4\n\n  Metric   -&gt; (((2 * (l * 2.54) * p)^2) * u) / 386.4\n\nprompt txt = do\n  putStrLn txt\n  readLn\n\nmain = do \n  o &lt;- prompt \"Metric or Imperial?\"\n  l &lt;- prompt \"Scale length?\"\n  u &lt;- prompt \"Gauge?\" -- Unit Weight\n  p &lt;- prompt \"Pitch? (In hertz)\" \n  putStrLn $ \"The result is \" ++ show (eval o l u p)    \n</code></pre>\n\n<p>It lets you choose either Metric or Imperial for your scale length, and calculates the tension based on length, gauge and the desired pitch, giving you an output in pounds.</p>\n\n<p>What I'm having a problem with is: I want the calculator to fetch me unit weight based on the gauge number I input.</p>\n\n<p>I want to change the \"u\" in</p>\n\n<pre><code>  u &lt;- prompt \"Gauge?\" -- Unit Weight\n</code></pre>\n\n<p>to a \"g\", and if the \"g\" matches a number from 0.07 to 0.80, it returns me the unit weight of \"u\" corresponding to the gauge from a table, for example, the unit weight for a gauge of 0.80 would be 0.00115011, and I want it to be reflected in the equation. </p>\n\n<p>How would I go about that? What do I need to do to create a table/list of the \"g\" values giving \"u\"'s?</p>\n\n<p>The table and the equation I'm using, by the way: <a href=\"http://www.daddario.com/upload/tension_chart_13934.pdf\" rel=\"nofollow noreferrer\">http://www.daddario.com/upload/tension_chart_13934.pdf</a></p>\n"}, {"tags": ["haskell", "compare"], "comments": [{"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 2, "creation_date": 1492120810, "post_id": 43401656, "comment_id": 73865265, "body": "The result should be <code>LT</code>, <code>EQ</code>, <code>GT</code>, no?"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 3, "creation_date": 1492121439, "post_id": 43401656, "comment_id": 73865489, "body": "@LouisWasserman Better would be just: <code>instance Ord Complex where compare = comparing (\\(Com x y) -&gt; x^2 + y^2)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 2, "last_activity_date": 1492118516, "creation_date": 1492118516, "answer_id": 43401916, "question_id": 43401656, "link": "https://stackoverflow.com/questions/43401656/what-is-causing-this-error-in-ord-instance-for-complex-numbers-in-haskell/43401916#43401916", "title": "What is causing this error in Ord instance for complex numbers in Haskell?", "body": "<p>Unbalanced parentheses in both clauses. You're missing a close paren.</p>\n"}, {"comments": [{"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 2, "creation_date": 1492190150, "post_id": 43402695, "comment_id": 73891022, "body": "Just to amplify on point 1, there are laws that all Ord instances should follow. One of these is that (compare x y == EQ) implies (x == y), which your definition doesn&#39;t obey."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 4, "last_activity_date": 1492125287, "last_edit_date": 1492125287, "creation_date": 1492122553, "answer_id": 43402695, "question_id": 43401656, "link": "https://stackoverflow.com/questions/43401656/what-is-causing-this-error-in-ord-instance-for-complex-numbers-in-haskell/43402695#43402695", "title": "What is causing this error in Ord instance for complex numbers in Haskell?", "body": "<p>There are multiple issues with your code.</p>\n\n<ol>\n<li>There are good reasons to <em>not</em> give complex number an <code>Ord</code> instance. The one you're trying to define gives very counterintuitive results like <code>-2 &gt; -1</code>. a more reasonable instance would just compare the real parts, but that is problematic in case they're equal.<br>All in all, this is one the instances you'd better just not define.</li>\n<li><p>Your clauses are needlessly complicated.</p>\n\n<ul>\n<li><p>Taking the <a href=\"https://en.wikipedia.org/wiki/Monotonic_function\" rel=\"nofollow noreferrer\">square root</a> on both sides of an inequality (with positive values, as ensured by the <code>(^2)</code> makes no difference.</p>\n\n<pre><code>compare (Com x1 y1) (Com x2 y2) \n  | ((x1^2)+(y1^2)) &lt; ((x2^2)+(y2^2) = -1 \n  | ((x1^2)+(y1^2)) == ((x2^2)+(y2^2) = 0 \n</code></pre>\n\n<p>This is a really important change, because <code>sqrt</code> is substantially more expensive than most other operations, so you definitely don't want to call it four times with no need.</p></li>\n<li><p>You don't need parens around the square expressions, because <code>infixr 8 ^</code> binds tighter than <code>infixl 6 +</code>.</p>\n\n<pre><code>compare (Com x1 y1) (Com x2 y2)\n  | (x1^2 + y1^2) &lt; (x2^2 + y2^2 = -1\n  | (x1^2 + y1^2) == (x2^2 + y2^2 = 0\n</code></pre>\n\n<p>Ok, at this point it's really obvious what the problem was the compiler complained about: you're missing two closing parens. Or rather, you have <em>too many opening parens</em>, because again none of these are actually needed (<code>infix 4 ==</code> binds even weaker than <code>+</code>).</p>\n\n<pre><code>compare (Com x1 y1) (Com x2 y2)\n  | x1^2 + y1^2 &lt; x2^2 + y2^2 = -1\n  | x1^2 + y1^2 == x2^2 + y2^2 = 0\n</code></pre>\n\n<p>This starts to look decent, but there's still a lot of redundancy: you're computing both sides of the inequality twice. This is probably not too much of a performance, but it still violates <a href=\"https://en.wikipedia.org/wiki/Don%27t_repeat_yourself\" rel=\"nofollow noreferrer\">DRY</a>.</p>\n\n<pre><code>compare (Com x\u2081 y\u2081) (Com x\u2082 y\u2082)\n  | r\u2081 &lt; r\u2082    = -1\n  | r\u2081 == r\u2082   = 0\n  | otherwise  = 1\n where r\u2081 = x\u2081^2 + y\u2081^2\n       r\u2082 = x\u2082^2 + y\u2082^2\n</code></pre></li>\n</ul></li>\n<li><p>As already said, <code>compare</code> should not yield <code>-1</code> <code>0</code> <code>1</code> but <code>LT</code> <code>GT</code> or <code>EQ</code>.</p>\n\n<pre><code>compare (Com x\u2081 y\u2081) (Com x\u2082 y\u2082)\n  | r\u2081 &lt; r\u2082    = LT\n  | r\u2081 == r\u2082   = EQ\n  | otherwise  = GT\n where r\u2081 = x\u2081^2 + y\u2081^2\n       r\u2082 = x\u2082^2 + y\u2082^2\n</code></pre>\n\n<p>But those guards are so standard that you don't need to write them out: just invoke <code>compare</code> (the already-defined <code>Double</code> instance) again on the <code>r</code> values:</p>\n\n<pre><code>compare (Com x\u2081 y\u2081) (Com x\u2082 y\u2082) = compare r\u2081 r\u2082\n where r\u2081 = x\u2081^2 + y\u2081^2\n       r\u2082 = x\u2082^2 + y\u2082^2\n</code></pre>\n\n<p>You might now also again inline the variables:</p>\n\n<pre><code>compare (Com x\u2081 y\u2081) (Com x\u2082 y\u2082) = compare (x\u2081^2 + y\u2081^2) (x\u2082^2 + y\u2082^2)\n</code></pre></li>\n</ol>\n"}], "owner": {"reputation": 61, "user_id": 7565331, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fc5a004f73658bd935375314fd317af1?s=128&d=identicon&r=PG&f=1", "display_name": "SmackMore", "link": "https://stackoverflow.com/users/7565331/smackmore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1492125287, "creation_date": 1492117351, "question_id": 43401656, "link": "https://stackoverflow.com/questions/43401656/what-is-causing-this-error-in-ord-instance-for-complex-numbers-in-haskell", "title": "What is causing this error in Ord instance for complex numbers in Haskell?", "body": "<p>I'm trying to implement an Ord instance for complex numbers in Haskell. I followed the format I found online for implementing Ord instances but I get an error that I don't understand. The following is my instance code:</p>\n\n<pre><code>instance Ord Complex where\n compare (Com x1 y1) (Com x2 y2) \n  | (sqrt ((x1^2)+(y1^2))) &lt; (sqrt ((x2^2)+(y2^2)) = -1 \n  | (sqrt ((x1^2)+(y1^2))) == (sqrt ((x2^2)+(y2^2)) = 0 \n  | otherwise = 1\n</code></pre>\n\n<p>When I try loading it into GHCI I get this error:</p>\n\n<pre><code>Complex.hs:45:52: error:\n parse error on input `='\n Perhaps you need a 'let' in a 'do' block?\n e.g. 'let x = 5' instead of 'x = 5'\n</code></pre>\n\n<p>But all the examples of Ord instances I've seen use that same format. What's this error?</p>\n"}, {"tags": ["haskell", "ghc"], "answers": [{"comments": [{"owner": {"reputation": 564, "user_id": 3637541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c455e355de061d57d5a2cabf3649eddb?s=128&d=identicon&r=PG&f=1", "display_name": "user3637541", "link": "https://stackoverflow.com/users/3637541/user3637541"}, "edited": false, "score": 0, "creation_date": 1492115594, "post_id": 43401111, "comment_id": 73863157, "body": "I really thought i had tried this but i must have done &#39;\\57441&#39; instead (as the compiler gives that as an error) or something... Thank you so much."}], "tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": true, "score": 2, "last_activity_date": 1492115036, "creation_date": 1492115036, "answer_id": 43401111, "question_id": 43401065, "link": "https://stackoverflow.com/questions/43401065/lexical-error-in-string-character-literal-at-character-57441/43401111#43401111", "title": "lexical error in string/character literal at character &#39;\\57441&#39;", "body": "<p>You should be able to write it as a Unicode escape, decimal <code>\"\\57441\"</code> or hexadecimal <code>\"\\xE061\"</code>.</p>\n"}], "owner": {"reputation": 564, "user_id": 3637541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c455e355de061d57d5a2cabf3649eddb?s=128&d=identicon&r=PG&f=1", "display_name": "user3637541", "link": "https://stackoverflow.com/users/3637541/user3637541"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 715, "favorite_count": 0, "accepted_answer_id": 43401111, "answer_count": 1, "score": 1, "last_activity_date": 1492115036, "creation_date": 1492114805, "question_id": 43401065, "link": "https://stackoverflow.com/questions/43401065/lexical-error-in-string-character-literal-at-character-57441", "title": "lexical error in string/character literal at character &#39;\\57441&#39;", "body": "<p>GHC gives me an error with a special unicode character. The character is the \"mute\" symbol from font-awesome.</p>\n\n<pre><code>putStrLn \"\ue061\"\n</code></pre>\n\n<p>The error: <code>lexical error in string/character literal at character '\\57441'</code></p>\n\n<p>I found this ticket where a similar behavior is described (<a href=\"https://ghc.haskell.org/trac/ghc/ticket/5518\" rel=\"nofollow noreferrer\">https://ghc.haskell.org/trac/ghc/ticket/5518</a>). The ticket says it should be fixed with ghc > 7.2.1. I am using ghc 8.0.2 and it does not work anyways.</p>\n\n<p>Does anybody know how to bypass this error?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1492110601, "post_id": 43399904, "comment_id": 73860612, "body": "Use multiline input or explicit semicolons, as demonstrated in <a href=\"http://stackoverflow.com/q/42593284/2751851\"><i>Function definiton by special cases in GHCi</i></a>."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 3, "creation_date": 1492110657, "post_id": 43399904, "comment_id": 73860636, "body": "I find it easier to put all definitions in a file I then <code>:load</code> into ghci."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1492111220, "post_id": 43399904, "comment_id": 73860871, "body": "Consider also <a href=\"https://github.com/gibiansky/IHaskell\" rel=\"nofollow noreferrer\">IHaskell</a>, which combines the direct-feedback experience of typing directly in the interpreter with the structure and backup capabilities of a proper source file."}], "answers": [{"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1492217712, "post_id": 43407356, "comment_id": 73901073, "body": "Note that we generally use <code>Maybe</code> instead of lists that will always have at most one element. By doing it that way, the right-hand side of the definition above might become <code>if (x &#47;= 0 &amp;&amp; y &#47;= 0) then Just (x * y) else Nothing</code>."}], "tags": [], "owner": {"reputation": 170, "user_id": 5419015, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/wsXwJ.jpg?s=128&g=1", "display_name": "Aerron", "link": "https://stackoverflow.com/users/5419015/aerron"}, "is_accepted": true, "score": 0, "last_activity_date": 1492217525, "last_edit_date": 1492217525, "creation_date": 1492155821, "answer_id": 43407356, "question_id": 43399904, "link": "https://stackoverflow.com/questions/43399904/haskell-beginner-error-with-ghci/43407356#43407356", "title": "Haskell Beginner Error with GHCi", "body": "<p>If you want to add a type signature to a definition in GHCi, you can specify it by using multiline input through <code>:set +m</code> or <code>:{ ... :}</code>, as described in the <a href=\"https://downloads.haskell.org/~ghc/8.0.1-rc1/docs/html/users_guide/ghci.html#using-do-notation-at-the-prompt\" rel=\"nofollow noreferrer\">GHC Users Guide</a>, or by using semicolons, as in:</p>\n\n<pre><code>mulme x y = [x*y| x /= 0, y/= 0]; mulme :: Int -&gt; Int -&gt; [Int]\n</code></pre>\n"}], "owner": {"reputation": 10637, "user_id": 3102968, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/1XKm3.png?s=128&g=1", "display_name": "joesan", "link": "https://stackoverflow.com/users/3102968/joesan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 300, "favorite_count": 0, "accepted_answer_id": 43407356, "answer_count": 1, "score": 0, "last_activity_date": 1492217525, "creation_date": 1492110357, "question_id": 43399904, "link": "https://stackoverflow.com/questions/43399904/haskell-beginner-error-with-ghci", "title": "Haskell Beginner Error with GHCi", "body": "<p>I'm on my Mac trying out Haskell and to my surprise, when I defined a function, I got an error:</p>\n\n<pre><code>Prelude System.IO&gt; :set prompt \"ghci&gt; \"\nghci&gt; addMe :: Int -&gt; Int -&gt; Int\n\n&lt;interactive&gt;:11:1: error:\n    Variable not in scope: addMe :: Int -&gt; Int -&gt; Int\nghci&gt;\n</code></pre>\n\n<p>How can I define functions on the ghci?</p>\n"}, {"tags": ["postgresql", "haskell", "servant", "opaleye"], "answers": [{"tags": [], "owner": {"reputation": 7947, "user_id": 997606, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b6117f6630078d6612afa75fb8e5bc9a?s=128&d=identicon&r=PG", "display_name": "Tom Ellis", "link": "https://stackoverflow.com/users/997606/tom-ellis"}, "is_accepted": true, "score": 2, "last_activity_date": 1492160834, "last_edit_date": 1492160834, "creation_date": 1492123207, "answer_id": 43402792, "question_id": 43399733, "link": "https://stackoverflow.com/questions/43399733/opaleye-newtype/43402792#43402792", "title": "Opaleye newtype", "body": "<blockquote>\n  <p>the issue appears to be that Opaleye doesn't know how to convert ItemId into a PGUuid but I know it can convert UUID to PGUuid</p>\n</blockquote>\n\n<p>It's the other way round.  It's trying to convert a <code>Column PGUuid</code> into an <code>ItemId</code> and it only knows how to convert it into a <code>UUID</code>.  One approach is to add the instance yourself:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>instance O.QueryRunnerColumnDefault O.PGUuid ItemId where\n  queryRunnerColumnDefault =\n         O.queryRunnerColumn id ItemId queryRunnerColumnDefault\n</code></pre>\n\n<p>Another approach would be to make <code>ItemId</code> polymorphic:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>newtype ItemId' a = ItemId a\n$(makeAdaptorAndInstance \"pItemId\" ''ItemId')\n</code></pre>\n\n<p>and then you can use it on both the Haskell side and Opaleye side without having to write the extra instance.</p>\n"}], "owner": {"reputation": 37, "user_id": 7452201, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7MQyN.png?s=128&g=1", "display_name": "Carolyn Knight-Serrano", "link": "https://stackoverflow.com/users/7452201/carolyn-knight-serrano"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 43402792, "answer_count": 1, "score": 1, "last_activity_date": 1492160834, "creation_date": 1492109629, "last_edit_date": 1492147427, "question_id": 43399733, "link": "https://stackoverflow.com/questions/43399733/opaleye-newtype", "title": "Opaleye newtype", "body": "<p>One of the fields in my datatype for a table in my PostgreSQL database is a newtype wrapping <code>UUID</code> called <code>ItemId</code>.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.Profunctor.Product.TH (makeAdaptorAndInstance)\nimport Data.DateTime (DateTime)\nimport Data.UUID\nimport GHC.Generics\nimport qualified Opaleye as O\nimport Data.Text (pack, Text)\n\nnewtype ItemId = ItemId UUID\n  deriving (Show, Eq, Generic)\n\ntoItemId :: UUID -&gt; ItemId\ntoItemId = ItemId\n\nfromItemId :: ItemId -&gt; UUID\nfromItemId (ItemId x) = x\n\ndata Item' id name desc num most\n  = Item {\n    _itemId          :: id,\n    _itemName        :: name,\n    _itemDesc        :: desc,\n    _numTimesOrdered :: num,\n    _mostRecentOrder :: most\n }\n\ntype ItemRead = Item' ItemId Text Text Int DateTime\ntype ItemWrite = Item' (Maybe ItemId) Text Text (Maybe Int) (Maybe DateTime)\ntype ItemColRead = Item' (O.Column O.PGUuid)\n                         (O.Column O.PGText)\n                         (O.Column O.PGText)\n                         (O.Column O.PGInt4)\n                         (O.Column O.PGTimestamptz)\ntype ItemColWrite = Item' (Maybe (O.Column O.PGUuid))\n                          (O.Column O.PGText)\n                          (O.Column O.PGText)\n                          (Maybe (O.Column O.PGInt4))\n                          (Maybe (O.Column O.PGTimestamptz))\n\n$(makeAdaptorAndInstance \"pItem\" ''Item')\n\nitemTable :: O.Table ItemColWrite ItemColRead\nitemTable = O.Table \"items\" (pItem Item { _itemId          = O.optional \"id\"\n                                        , _itemName        = O.required \"name\"\n                                        , _itemDesc        = O.required \"desc\"\n                                        , _numTimesOrdered = O.optional \"numTimesOrdered\"\n                                        , _mostRecentOrder = O.optional \"mostRecentOrder\"\n                                        })\n\nitemToPG :: ItemWrite -&gt; ItemColWrite\nitemToPG = pItem Item { _itemId          = const Nothing\n                      , _itemName        = O.pgStrictText\n                      , _itemDesc        = O.pgStrictText\n                      , _numTimesOrdered = const Nothing\n                      , _mostRecentOrder = const Nothing\n                      }\n</code></pre>\n\n<p>However, when I compile my project, GHC throws:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>/home/gigavinyl/Projects/ordermage/src/Api/Item.hs:34:3: error:\n    \u2022 No instance for (O.QueryRunnerColumnDefault O.PGUuid ItemId)\n        arising from a use of \u2018O.runInsertManyReturning\u2019\n    \u2022 In the second argument of \u2018(&lt;$&gt;)\u2019, namely\n        \u2018O.runInsertManyReturning con itemTable [itemToPG item] _itemId\u2019\n      In the second argument of \u2018($)\u2019, namely\n        \u2018listToMaybe\n         &lt;$&gt; O.runInsertManyReturning con itemTable [itemToPG item] _itemId\u2019\n      In the expression:\n        liftIO\n        $ listToMaybe\n          &lt;$&gt; O.runInsertManyReturning con itemTable [itemToPG item] _itemId\n</code></pre>\n\n<p>where <code>src/Api/Item.hs</code> is:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE OverloadedStrings #-}\n\nmodule Api.Item where\n\nimport Control.Monad.IO.Class (liftIO)\nimport Data.Maybe (listToMaybe)\nimport Database.PostgreSQL.Simple (Connection)\nimport Models.Item\nimport Queries.Item\nimport Servant\nimport qualified Opaleye as O\n\ntype ItemApi =\n   Get '[JSON] [ItemRead]                                      :&lt;|&gt;\n   Capture \"itemId\" ItemId     :&gt; Get '[JSON] (Maybe ItemRead) :&lt;|&gt;\n   ReqBody '[JSON] ItemWrite   :&gt; Post '[JSON] (Maybe ItemId)\n\nitemServer :: Connection -&gt; Server ItemApi\nitemServer con =\n  getItems con    :&lt;|&gt;\n  getItemById con :&lt;|&gt;\n  postItem con\n\ngetItems :: Connection -&gt; Handler [ItemRead]\ngetItems con = liftIO $ O.runQuery con itemsQuery\n\ngetItemById :: Connection -&gt; ItemId -&gt; Handler (Maybe ItemRead)\ngetItemById con itemID = liftIO $ listToMaybe &lt;$&gt; O.runQuery con (itemByIdQuery itemID)\n\npostItem :: Connection -&gt; ItemWrite -&gt; Handler (Maybe ItemId)\npostItem con item = liftIO $ listToMaybe &lt;$&gt;\n  O.runInsertManyReturning con itemTable [itemToPG item] _itemId\n</code></pre>\n\n<p>I'm still fairly new to Haskell but the issue appears to be that Opaleye doesn't know how to convert <code>ItemId</code> into a <code>PGUuid</code> but I know it can convert <code>UUID</code> to <code>PGUuid</code>. How would I go about writing the instance to allow Opaleye to do this conversion?</p>\n"}, {"tags": ["haskell", "types", "data-kinds"], "comments": [{"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1492109276, "post_id": 43399332, "comment_id": 73859947, "body": "Why don&#39;t you try it? You seem to have written the code already. (implementation: <code>foldr Cons Nil</code>)"}, {"owner": {"reputation": 483, "user_id": 521370, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a8d69ed3d32273571045f30fc755ff0a?s=128&d=identicon&r=PG", "display_name": "Dmitry Olshansky", "link": "https://stackoverflow.com/users/521370/dmitry-olshansky"}, "reply_to_user": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1492112137, "post_id": 43399332, "comment_id": 73861351, "body": "I tried but have no success. <code>foldr</code> has type <code>foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b</code>. But for instance <code>Cons</code> has type <code>Cons :: a -&gt; b -&gt; c</code> where <code>a ~ a</code>, <code>b ~ List (n-1) a</code>, <code>c ~ List n a</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1492113958, "post_id": 43399332, "comment_id": 73862323, "body": "You can&#39;t convert to that type since <code>n</code> is not known. At most, you can define an existential wrapper <code>data List2 a where List2 :: List n a -&gt; List2 a</code> and define <code>toConsList :: [a] -&gt; List2 a</code>"}, {"owner": {"reputation": 483, "user_id": 521370, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a8d69ed3d32273571045f30fc755ff0a?s=128&d=identicon&r=PG", "display_name": "Dmitry Olshansky", "link": "https://stackoverflow.com/users/521370/dmitry-olshansky"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1492117344, "post_id": 43399332, "comment_id": 73863914, "body": "@chi: In case of existential wrapper I think I can&#39;t unwrap it and apply for instance function g :: List n a -&gt; (a, List (n-1) a). Right? So, there is no sense for such a wrapper. It seems that I can implement some algorithm in type-checked manner but I can&#39;t start it with real data..."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1492125724, "post_id": 43399332, "comment_id": 73866846, "body": "@DmitryOlshansky You can apply <code>g</code> only if you rewrap its result later, or you use it to produce a non-list result. The existential is not pointless on its own, but it might be pointless in some scenarios."}], "answers": [{"comments": [{"owner": {"reputation": 483, "user_id": 521370, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a8d69ed3d32273571045f30fc755ff0a?s=128&d=identicon&r=PG", "display_name": "Dmitry Olshansky", "link": "https://stackoverflow.com/users/521370/dmitry-olshansky"}, "edited": false, "score": 0, "creation_date": 1492118817, "post_id": 43401079, "comment_id": 73864509, "body": "There are <a href=\"https://downloads.haskell.org/~ghc/8.0-latest/docs/html/libraries/base-4.9.0.0/GHC-TypeLits.html#v:someNatVal\" rel=\"nofollow noreferrer\">GHC.TypeLits.someNatVal</a> and it seems that we can do <code>case someNatVal (length xs) of Just (p :: Proxy n) -&gt; my_func p xs  -- (or my_func xs :: List n a) </code>. But I have no success with this also."}, {"owner": {"reputation": 483, "user_id": 521370, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a8d69ed3d32273571045f30fc755ff0a?s=128&d=identicon&r=PG", "display_name": "Dmitry Olshansky", "link": "https://stackoverflow.com/users/521370/dmitry-olshansky"}, "edited": false, "score": 0, "creation_date": 1492120062, "post_id": 43401079, "comment_id": 73864996, "body": "Sorry, I meant <code>Just (SomeNat (p :: Proxy n)) -&gt; ...</code>"}, {"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "reply_to_user": {"reputation": 483, "user_id": 521370, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a8d69ed3d32273571045f30fc755ff0a?s=128&d=identicon&r=PG", "display_name": "Dmitry Olshansky", "link": "https://stackoverflow.com/users/521370/dmitry-olshansky"}, "edited": false, "score": 0, "creation_date": 1492125713, "post_id": 43401079, "comment_id": 73866843, "body": "@DmitryOlshansky <code>SomeNat</code> is an existential wrapper around a <code>KnownNat</code>"}], "tags": [], "owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "is_accepted": true, "score": 2, "last_activity_date": 1492114878, "creation_date": 1492114878, "answer_id": 43401079, "question_id": 43399332, "link": "https://stackoverflow.com/questions/43399332/convert-a-list-to-list-with-type-constrained-fixed-length/43401079#43401079", "title": "Convert a list to list with type-constrained fixed length", "body": "<p>You can't, because that would require dependent types. The <strong>type</strong> of the resulting <code>List</code> <strong>depends on</strong> the <strong>value</strong>. As your type error shows, you can't use <code>foldr Cons Nil</code> (which would be the obvious implementation) to create the list because the accumulator must stay the same type for the entire fold. </p>\n\n<p>As @chi pointed out in the comments, you can use an existential wrapper to ignore the type parameter to allow this to work. You would end up with a value that was <code>List n a</code> for <em>some unknown</em> <code>n</code>, which gains you nothing over just using <code>[a]</code>.</p>\n\n<p>There is <a href=\"https://hackage.haskell.org/package/fixed-vector-0.9.0.0/docs/Data-Vector-Fixed.html#v:fromList\" rel=\"nofollow noreferrer\"><code>Data.Vector.Fixed.fromList</code></a>, but the documentation there tells us that it \"Will throw error if list is shorter than resulting vector.\" This means that it is really just asking you to specify the type (length) of your vector (list) at compile time, and truncating or throwing an error at runtime if that expectation is not met.</p>\n\n<p>You may be interested in Idris' <a href=\"https://www.idris-lang.org/docs/1.0/base_doc/docs/Data.Vect.html#Data.Vect.Vect\" rel=\"nofollow noreferrer\"><code>Data.Vect.Vect</code></a>.</p>\n"}], "owner": {"reputation": 483, "user_id": 521370, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a8d69ed3d32273571045f30fc755ff0a?s=128&d=identicon&r=PG", "display_name": "Dmitry Olshansky", "link": "https://stackoverflow.com/users/521370/dmitry-olshansky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 43401079, "answer_count": 1, "score": 1, "last_activity_date": 1492114878, "creation_date": 1492108158, "last_edit_date": 1492112340, "question_id": 43399332, "link": "https://stackoverflow.com/questions/43399332/convert-a-list-to-list-with-type-constrained-fixed-length", "title": "Convert a list to list with type-constrained fixed length", "body": "<p>Let I define a list with constrained length. I.e.</p>\n\n<pre><code>data List (n::Nat) a where\n  Nil :: List 0 a\n  Cons :: a -&gt; List (n-1) a -&gt; List n a\n</code></pre>\n\n<p>Then I want to initialize this list from common list (e.g. input string with any length). Can I do that? Is it possible to write function (or class) like this?</p>\n\n<pre><code>toConsList :: [a] -&gt; List n a\n</code></pre>\n\n<p>Or is this suitable only for a structures with length which is known in compile time?</p>\n"}, {"tags": ["haskell", "exception", "exception-handling"], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 8, "last_activity_date": 1492103810, "creation_date": 1492103810, "answer_id": 43398175, "question_id": 43397911, "link": "https://stackoverflow.com/questions/43397911/why-cant-i-catch-exception-in-different-io-than-in-haskell/43398175#43398175", "title": "Why can&#39;t I catch exception in different IO than () in Haskell?", "body": "<p>This has nothing to do with <code>()</code> vs. other types. Note that the following also doesn't catch:</p>\n\n<pre><code>boom = return $ error \"ERR\"\n</code></pre>\n\n<p>The reason <code>catch</code> won't do anything about that is that <code>return</code> is lazy, thus the error isn't actually triggered by <code>catch</code>, only if you try to <em>get at the contained value</em>.</p>\n\n<p>It is for precisely this reason that the <code>Exception</code> module has <a href=\"http://hackage.haskell.org/package/base-4.9.1.0/docs/Control-Exception-Base.html#v:evaluate\" rel=\"noreferrer\">evaluate</a>, which is equivalent to <code>return</code> but strict.</p>\n\n<pre><code>boom :: IO String\nboom = evaluate . show $ 3`div`0\n</code></pre>\n"}], "owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 43398175, "answer_count": 1, "score": 2, "last_activity_date": 1492103810, "creation_date": 1492102836, "question_id": 43397911, "link": "https://stackoverflow.com/questions/43397911/why-cant-i-catch-exception-in-different-io-than-in-haskell", "title": "Why can&#39;t I catch exception in different IO than () in Haskell?", "body": "<p>I want to catch all exceptions in IO String function. When I run this code:</p>\n\n<pre><code>import Control.Exception.Base\n\nhandler :: SomeException -&gt; IO String\nhandler _ = return \"Gotta catch'em all!\"\n\nboom :: IO String\nboom = return (show (3 `div` 0))\n\nget :: IO String\nget = boom `catch` handler\n\nmain :: IO()\nmain = do\n  x &lt;- get\n  print x\n</code></pre>\n\n<p>I get</p>\n\n<pre><code>exctest: divide by zero\n</code></pre>\n\n<p>However this code works:</p>\n\n<pre><code>import Control.Exception.Base\n\nhandler2 :: SomeException -&gt; IO ()\nhandler2 _ = print \"Gotta catch'em all!\"\n\nboom2 :: IO ()\nboom2 = print $ show (3 `div` 0)\n\nmain :: IO()\nmain = do\n  boom2 `catch` handler2\n</code></pre>\n\n<p>with result</p>\n\n<pre><code>&gt; Gotta catch'em all!\n</code></pre>\n\n<p>When I change boom in first example to </p>\n\n<pre><code>boom = error \"ERR\"\n</code></pre>\n\n<p>The exception is caught ok. Why does it behave this way? What should I do to catch exception in first example?</p>\n"}, {"tags": ["string", "haskell"], "comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1492100169, "post_id": 43397137, "comment_id": 73855228, "body": "Can you make a function that just takes in a <code>String</code> <code>s</code> and an integer <code>n</code> and gives back the <code>String</code> that is <code>s</code> multiplied by <code>n</code> (without dealing with the <code>Client</code> stuff)? I would start there."}, {"owner": {"reputation": 2283, "user_id": 2250712, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/421f0a0ddf91f441710930ae777923eb?s=128&d=identicon&r=PG", "display_name": "metaphori", "link": "https://stackoverflow.com/users/2250712/metaphori"}, "edited": false, "score": 0, "creation_date": 1492100963, "post_id": 43397137, "comment_id": 73855661, "body": "Then why didn&#39;t you title your question to reflect the fact that you are interested in &quot;string multiplication&quot; (rather than mere &quot;concatenation&quot;)?"}, {"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 1, "creation_date": 1492101071, "post_id": 43397137, "comment_id": 73855724, "body": "If you want to use a standard library function (instead of implementing it yourself), there is <code>replicate</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 0, "creation_date": 1492101048, "post_id": 43397354, "comment_id": 73855703, "body": "While both of these work, neither one is really appropriate for what he is doing."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1735, "user_id": 2892792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5DNyi.jpg?s=128&g=1", "display_name": "Lazersmoke", "link": "https://stackoverflow.com/users/2892792/lazersmoke"}, "edited": false, "score": 1, "creation_date": 1492105956, "post_id": 43397354, "comment_id": 73858252, "body": "@Lazersmoke I agree on that these are suboptimal, but they work, have the correct complexity, and are reasonably readable. This is a good answer in my eye, and would be very good if only the library didn&#39;t contain <code>replicate(M)</code>. But that&#39;s not a huge deal."}], "tags": [], "owner": {"reputation": 2283, "user_id": 2250712, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/421f0a0ddf91f441710930ae777923eb?s=128&d=identicon&r=PG", "display_name": "metaphori", "link": "https://stackoverflow.com/users/2250712/metaphori"}, "is_accepted": false, "score": 1, "last_activity_date": 1492100803, "creation_date": 1492100803, "answer_id": 43397354, "question_id": 43397137, "link": "https://stackoverflow.com/questions/43397137/string-concatenation-in-haskell/43397354#43397354", "title": "String concatenation in Haskell", "body": "<p>Repeating a char</p>\n\n<pre><code>take 10 $ repeat 'a'     -- \"aaaaaaaaaa\"\n</code></pre>\n\n<p>Repeating a string</p>\n\n<pre><code>[1..10] &gt;&gt;= (\\_ -&gt; \"x-\") -- \"x-x-x-x-x-x-x-x-x-x-\"\n[1..10] &gt;&gt; \"x-\"          -- \"x-x-x-x-x-x-x-x-x-x-\"\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 7847767, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10208231670339035/picture?type=large", "display_name": "Felipe Otero", "link": "https://stackoverflow.com/users/7847767/felipe-otero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492115267, "creation_date": 1492100014, "last_edit_date": 1492115267, "question_id": 43397137, "link": "https://stackoverflow.com/questions/43397137/string-concatenation-in-haskell", "title": "String concatenation in Haskell", "body": "<p>My problem is to build a function that given a person and an amount of hours(<strong>Integer</strong>) it adds \"erp\" at the start of the name, but the \"r\" must multiply the amount of hours.</p>\n\n<p>My function must be of the type:</p>\n\n<pre><code>drink :: Integer -&gt; Client -&gt; Client\n</code></pre>\n\n<p>here it\u00b4s an example:</p>\n\n<pre><code>drink 5 (Aperson name _ _) = \"errrrrpname\"\n</code></pre>\n\n<p>I know how to do the concatenation but i dont know how to multiply the \"r\" the amount of time.</p>\n"}, {"tags": ["haskell", "yesod"], "answers": [{"tags": [], "owner": {"reputation": 827, "user_id": 1276388, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/4ae985df9e533570f5ac2ea9bfc25dfd?s=128&d=identicon&r=PG", "display_name": "\u0397\u03bb\u03b5\u03ba\u03c4\u03c1\u03bf\u03bb\u03cc\u03b3\u03bf\u03c2 \u039c\u03b7\u03c7\u03b1\u03bd\u03b9\u03ba\u03cc\u03c2", "link": "https://stackoverflow.com/users/1276388/%ce%97%ce%bb%ce%b5%ce%ba%cf%84%cf%81%ce%bf%ce%bb%cf%8c%ce%b3%ce%bf%cf%82-%ce%9c%ce%b7%cf%87%ce%b1%ce%bd%ce%b9%ce%ba%cf%8c%cf%82"}, "is_accepted": false, "score": 0, "last_activity_date": 1492105033, "creation_date": 1492105033, "answer_id": 43398510, "question_id": 43395944, "link": "https://stackoverflow.com/questions/43395944/prevent-yesod-from-generating-client-session-key-aes-file/43398510#43398510", "title": "Prevent Yesod from generating client_session_key.aes file", "body": "<p>Comment or delete this code from your <code>Foundation.hs</code> file:</p>\n\n<pre><code>makeSessionBackend _ = Just &lt;$&gt; defaultClientSessionBackend\n    120    -- timeout in minutes\n    \"config/client_session_key.aes\"\n</code></pre>\n\n<p>And do <code>stack build</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 69847, "user_id": 3853934, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/GtQuz.jpg?s=128&g=1", "display_name": "Micha\u0142 Per\u0142akowski", "link": "https://stackoverflow.com/users/3853934/micha%c5%82-per%c5%82akowski"}, "is_accepted": true, "score": 5, "last_activity_date": 1492111084, "creation_date": 1492111084, "answer_id": 43400105, "question_id": 43395944, "link": "https://stackoverflow.com/questions/43395944/prevent-yesod-from-generating-client-session-key-aes-file/43400105#43400105", "title": "Prevent Yesod from generating client_session_key.aes file", "body": "<p><a href=\"https://hackage.haskell.org/package/yesod-core-1.4.33/docs/Yesod-Core.html#v:makeSessionBackend\" rel=\"noreferrer\">Yesod documentation</a> says that the <code>makeSessionBackend</code> method by default \"uses clientsession with a 2 hour timeout\", and that \"returning <code>Nothing</code> disables sessions\". So the solution is to override that method and return <code>Nothing</code>:</p>\n\n<pre><code>instance Yesod App where\n    makeSessionBackend _ = return Nothing\n</code></pre>\n"}], "owner": {"reputation": 69847, "user_id": 3853934, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/GtQuz.jpg?s=128&g=1", "display_name": "Micha\u0142 Per\u0142akowski", "link": "https://stackoverflow.com/users/3853934/micha%c5%82-per%c5%82akowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 43400105, "answer_count": 2, "score": 3, "last_activity_date": 1492111084, "creation_date": 1492096333, "question_id": 43395944, "link": "https://stackoverflow.com/questions/43395944/prevent-yesod-from-generating-client-session-key-aes-file", "title": "Prevent Yesod from generating client_session_key.aes file", "body": "<p>When I launch my Yesod application, it generates a file named <code>client_session_key.aes</code>. I don't need it, because I use sessionless authentication. Can I stop Yesod generating this file?</p>\n"}, {"tags": ["sockets", "haskell", "tcp"], "answers": [{"comments": [{"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 1, "creation_date": 1511789630, "post_id": 43402252, "comment_id": 81980089, "body": "I just <a href=\"https://ghc.haskell.org/trac/ghc/ticket/14530#ticket\" rel=\"nofollow noreferrer\">opened a bug</a>. Let&#39;s see what happens..."}], "tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 3, "last_activity_date": 1492120379, "last_edit_date": 1492120379, "creation_date": 1492120069, "answer_id": 43402252, "question_id": 43395074, "link": "https://stackoverflow.com/questions/43395074/haskell-tcp-server-fd-is-too-big-error/43402252#43402252", "title": "Haskell tcp server, fd is too big error", "body": "<p>You aren't doing anything wrong.  The specific error message you're seeing only shows up with GHC >=8.0.2 running on Windows and represents a bug/limitation in an internal GHC function <code>fdReady</code> that they've tried to address on non-Windows architectures but have left unfixed on Windows.  (Don't feel too jealous, though -- the \"fix\" on non-Windows architectures is currently broken and crashes, too.)  Trying an earlier version of GHC probably wouldn't help -- it would still cause an error, but the error message would be different.</p>\n\n<p>Here's the problem: on Windows, the internal function <code>fdReady</code> uses the <code>select()</code> system call to poll file descriptors for sockets, and <code>select</code> is limited to a certain maximum numerical value for the file descriptors it can poll.  It looks like the Windows default for this value is quite low (64) but can be increased at compile time (the time <em>GHC</em> is compiled, unfortunately, not the time when GHC compiles your program).</p>\n\n<p>If you add the line:</p>\n\n<pre><code>hShow handle &gt;&gt;= putStrLn\n</code></pre>\n\n<p>just before your <code>hWaitForInput</code>, you should see some debug info printed for the socket, including something like <code>loc=&lt;socket: nnn&gt;</code> where <code>nnn</code> is the file descriptor.  This may help you verify that you're seeing a file descriptor greater than 64 that's causing the problem.</p>\n\n<p>If this is the case, I would suggest filing a GHC bug to see if you can get it fixed.</p>\n"}, {"comments": [{"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1511787801, "post_id": 43402407, "comment_id": 81978975, "body": "I wonder if killing the thread that is doing the <code>hGetLine</code> will work on Windows. I currently cannot do this, as explained in <a href=\"https://stackoverflow.com/questions/47507586/killing-a-thread-waiting-on-hgetline-from-a-socket-windows\">this question</a>."}], "tags": [], "owner": {"reputation": 179940, "user_id": 20713, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09b9758a4a83cc25547eb93891f19df7?s=128&d=identicon&r=PG", "display_name": "ephemient", "link": "https://stackoverflow.com/users/20713/ephemient"}, "is_accepted": false, "score": 2, "last_activity_date": 1492121285, "last_edit_date": 1492121285, "creation_date": 1492120836, "answer_id": 43402407, "question_id": 43395074, "link": "https://stackoverflow.com/questions/43395074/haskell-tcp-server-fd-is-too-big-error/43402407#43402407", "title": "Haskell tcp server, fd is too big error", "body": "<p>As an alternative/workaround, you could try reading a line in one thread and a timer in another thread.</p>\n\n<pre><code>putStrLn \"Waiting for Input\"\nmsgMVar &lt;- newEmptyMVar\ntid &lt;- forkIO $ hGetLine handle &gt;&gt;= putMVar msgMVar\nmaybeExn &lt;- waitTimeout tid (1000*10)\ncase maybeExn of\n    Nothing -&gt; do\n        killThread tid\n        putStrLn \"Client timed out\"\n    Just (Just _) -&gt;\n        putStrLn \"Exception\"\n    _ -&gt; do\n        msg &lt;- takeMVar msgMVar\n        putStrLn msg\nhClose handle\n</code></pre>\n\n<p>This does have different behavior (can time out in the middle of reading a line) than your code (never times out if a single byte can be read, even if the line is not complete), though.</p>\n"}], "owner": {"reputation": 733, "user_id": 5757964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3639bf68fea827de4f005972c1adee68?s=128&d=identicon&r=PG&f=1", "display_name": "AnkithD", "link": "https://stackoverflow.com/users/5757964/ankithd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 1, "accepted_answer_id": 43402252, "answer_count": 2, "score": 1, "last_activity_date": 1492121285, "creation_date": 1492093987, "last_edit_date": 1492116413, "question_id": 43395074, "link": "https://stackoverflow.com/questions/43395074/haskell-tcp-server-fd-is-too-big-error", "title": "Haskell tcp server, fd is too big error", "body": "<p>I've been trying to write a Haskell server for a Go client. For the Haskell TCP server I'm simply using <code>Network.Socket</code>. Whenever I try to run <code>hWaitForInput</code>, I am getting this error:</p>\n\n<pre><code>fdReady: fd is too big.\n</code></pre>\n\n<p>Here is the server code -</p>\n\n<pre><code>connHandler :: (Socket, SockAddr) -&gt; IO()\nconnHandler (sock, _) = do\n  putStrLn \"Starting Handler\"\n  handle &lt;- socketToHandle sock ReadWriteMode\n  hSetBuffering handle LineBuffering\n  hPutStrLn handle \"Hello Client!\"\n  putStrLn \"Waiting for Input\"\n  success &lt;- hWaitForInput handle (1000*10)\n  putStrLn \"Wait done\"\n  if success\n      then do\n          putStrLn \"Client timed out\"\n      else do\n          msg &lt;- hGetLine handle\n          putStrLn msg\n  hClose handle\n</code></pre>\n\n<p>The Go client is receiving and printing the server's message(\"Hello Client!\") but the haskell server throws the error right after printing \"Waiting for Input\" </p>\n"}, {"tags": ["haskell", "functional-programming", "generator", "truthtable"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1492093964, "post_id": 43394736, "comment_id": 73851083, "body": "What does <code>makeRow</code> do?"}, {"owner": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "edited": false, "score": 0, "creation_date": 1492093986, "post_id": 43394736, "comment_id": 73851097, "body": "Are you saying that you want the cartesian product two lists? Do you know list comprehensions?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1492094775, "post_id": 43394736, "comment_id": 73851705, "body": "<code>data TableRow = [(String,Bool)]</code> is not valid. You need a data constructor name."}], "answers": [{"comments": [{"owner": {"reputation": 131, "user_id": 7756612, "user_type": "registered", "profile_image": "https://graph.facebook.com/1444588332232208/picture?type=large", "display_name": "Sajid Anower", "link": "https://stackoverflow.com/users/7756612/sajid-anower"}, "edited": false, "score": 0, "creation_date": 1492095319, "post_id": 43395148, "comment_id": 73852114, "body": "Wow that makes a lot of sense. Thank you so much. I was not quite aware of list comprehensions, and did not know of this particular syntax. Just to clarify,  <code>genRow (x:xs) = [(x,b):ti | b &lt;- [True,False], ti &lt;- ts]     where ts = genRow xs</code> Does this work because it makes a separate list for True and False in each case?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 131, "user_id": 7756612, "user_type": "registered", "profile_image": "https://graph.facebook.com/1444588332232208/picture?type=large", "display_name": "Sajid Anower", "link": "https://stackoverflow.com/users/7756612/sajid-anower"}, "edited": false, "score": 0, "creation_date": 1492096032, "post_id": 43395148, "comment_id": 73852617, "body": "What do you mean with a <i>separate list</i>?"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 1, "last_activity_date": 1492094486, "last_edit_date": 1492094486, "creation_date": 1492094140, "answer_id": 43395148, "question_id": 43394736, "link": "https://stackoverflow.com/questions/43394736/gen-for-a-custom-data-type-in-haskell/43395148#43395148", "title": "Gen for a custom data type in Haskell", "body": "<p>The problem with your program is that <code>genRow :: [String] -&gt; [TableRow]</code> generates <strong>a list of <code>TableRow</code></strong> elements, and you cannot use the cons <code>(:)</code> constructor on a <code>(String,Bool)</code> and <code>TableRow</code> since <code>TableRow</code> is <code>[[(String,Bool)]]</code>.</p>\n\n<p>You can however easily use <em>list comprehension</em> for that:</p>\n\n<pre><code>genRow :: [String] -&gt; [[(String,Bool)]]\ngenRow [] = [<b>[]</b>]\ngenRow (x:xs) = <b>[(x,b):ti | b &lt;- [True,False], ti &lt;- ts]\n    where ts = genRow xs</b></code></pre>\n\n<p>The first statement should thus generate a list <strong>with one element</strong>: the <strong>empty list <code>[]</code></strong> (not the empty list as result). Furthermore we use list comprehension: we iterate over the two <code>Bool</code>s <code>True</code> and <code>False</code> for <code>b</code> and for each such value, we iterate over the possible values as tails <code>ts</code> and prepend the <code>(x,b)</code> to each of the possible tails.</p>\n\n<p>This gives:</p>\n\n<pre><code>*Main&gt; genRow [\"A\",\"B\",\"C\"]\n[[(\"A\",True),(\"B\",True),(\"C\",True)],\n [(\"A\",True),(\"B\",True),(\"C\",False)],\n [(\"A\",True),(\"B\",False),(\"C\",True)],\n [(\"A\",True),(\"B\",False),(\"C\",False)],\n [(\"A\",False),(\"B\",True),(\"C\",True)],\n [(\"A\",False),(\"B\",True),(\"C\",False)],\n [(\"A\",False),(\"B\",False),(\"C\",True)],\n [(\"A\",False),(\"B\",False),(\"C\",False)]]\n*Main&gt; genRow [\"Foo\",\"Bar\"]\n[[(\"Foo\",True),(\"Bar\",True)],\n [(\"Foo\",True),(\"Bar\",False)],\n [(\"Foo\",False),(\"Bar\",True)],\n [(\"Foo\",False),(\"Bar\",False)]]\n</code></pre>\n\n<p>(new lines added for readability)</p>\n"}], "owner": {"reputation": 131, "user_id": 7756612, "user_type": "registered", "profile_image": "https://graph.facebook.com/1444588332232208/picture?type=large", "display_name": "Sajid Anower", "link": "https://stackoverflow.com/users/7756612/sajid-anower"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 309, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1492094486, "creation_date": 1492093100, "last_edit_date": 1492093900, "question_id": 43394736, "link": "https://stackoverflow.com/questions/43394736/gen-for-a-custom-data-type-in-haskell", "title": "Gen for a custom data type in Haskell", "body": "<p>I was trying to make a truth table for a list of strings. \nSay, I have a list <code>[\"a\",\"b\"]</code> and as an output, I want \n<code>[[(\"a\",True),(\"b\",True)],\n[(\"a\",True),(\"b\",False)],\n[(\"a\",False),(\"b\",True)],\n[(\"a\",False),(\"b\",False)]]</code></p>\n\n<p>Each of those instances in the truth table are a custom data type defined as</p>\n\n<pre><code>data TableRow = [(String,Bool)]\n</code></pre>\n\n<p>Is there any easier way of doing this? Until now I have been doing this</p>\n\n<hr>\n\n<pre><code>genRow :: [String] -&gt; [TableRow]\ngenRow [] = []\ngenRow (x:xs) = ((makeRow x True) : genRow xs) ++ \n            ((makeRow x False) : genRow xs)\n</code></pre>\n\n<p>Quite obviously, this does not quite give me what I expect. Note that <code>makeRow</code> just takes in a <code>String</code> and a <code>Bool</code> and returns a <code>TableRow</code>.</p>\n\n<p>Is there any cleaner way of doing this? Thanks</p>\n"}, {"tags": ["haskell", "type-systems"], "owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "closed_date": 1492076934, "answer_count": 0, "score": 2, "last_activity_date": 1492076573, "creation_date": 1492076573, "question_id": 43388791, "link": "https://stackoverflow.com/questions/43388791/num-b-b-num-b-in-haskell", "closed_reason": "Duplicate", "title": "(Num (b -&gt; b), Num b) in Haskell", "body": "<p>I noticed a pattern in Haskell. Usually when I do something wrong</p>\n\n<pre><code>[(+3),(-3)] &lt;*&gt; pure 4 :: (Num (b -&gt; b), Num b) =&gt; [b]\n</code></pre>\n\n<p>I know the issue is the <code>(-3)</code>, which should be <code>(subtract 3)</code>, but however the type signature seems to imply at first, that you get a valid value, with some constraints.</p>\n\n<p><code>Num b</code> is logical, there are mathematical operations are involved.\nBut what does this <code>Num (b -&gt; b)</code> mean? The operation <code>b -&gt; b</code> is supposed to be a number?</p>\n\n<p>Usually when I notice this, I can imply further arguments to the statement and I get well-typed statements:</p>\n\n<pre><code>[(+ 3),(- 3)] &lt;*&gt;  pure 4 4 4 :: (Num (t -&gt; [b]), Num (b -&gt; b), Num t, Num b) =&gt; [b]\n</code></pre>\n\n<p>What is happening here?</p>\n"}, {"tags": ["parsing", "haskell", "io", "parsec"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1492074168, "post_id": 43387843, "comment_id": 73836918, "body": "What if the <code>otherfile</code> links back to the current file such that there is an <code>include</code> loop."}, {"owner": {"reputation": 123, "user_id": 5931939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/681e5cb3394a3dccd07b910c7162e2b0?s=128&d=identicon&r=PG&f=1", "display_name": "hexhex", "link": "https://stackoverflow.com/users/5931939/hexhex"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1492074456, "post_id": 43387843, "comment_id": 73837097, "body": "The <code>otherfile</code> is in a subdirectory and cannot include the current file (the language is not a proper programming language but rather a training language). Circular references cannot occur."}, {"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 0, "creation_date": 1492075589, "post_id": 43387843, "comment_id": 73837922, "body": "Can you deal with the &quot;include&quot; in the tokeniser? Or else call it &quot;#include&quot; and pass the file through `cpp&#39; before you parse it?"}, {"owner": {"reputation": 123, "user_id": 5931939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/681e5cb3394a3dccd07b910c7162e2b0?s=128&d=identicon&r=PG&f=1", "display_name": "hexhex", "link": "https://stackoverflow.com/users/5931939/hexhex"}, "edited": false, "score": 0, "creation_date": 1492078441, "post_id": 43387843, "comment_id": 73839832, "body": "You are right, that seems to be a reasonable approach as well. I will see how complex it is to take the tokenizer apart."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1492078496, "post_id": 43387843, "comment_id": 73839857, "body": "Parsec et al doesn&#39;t let you dynamically alter the input stream, afaik. I see a few reasonable ways of doing this. One is to use a preprocessor (either <code>cpp</code> or a custom built one) which does a textual substitution on the input. Another is to include a case for <code>include</code> in your AST, parse the file directly and then rewrite the AST as a separate compilation pass.  A third is to build your parser on top of <code>IO</code>, load and parse the included file, and then attach the returned tree within your parser itself."}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1492078759, "post_id": 43387843, "comment_id": 73839996, "body": "<code>However, this leads to many changes in the parser since all the default token parsers rely on Identity as an underyling monad.</code>  Judging from documentation, this is not true. For instance, all parsers from <code>Text.Parsec.Char</code> work as <code>ParsecT</code> with non-fixed <code>m</code>."}, {"owner": {"reputation": 123, "user_id": 5931939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/681e5cb3394a3dccd07b910c7162e2b0?s=128&d=identicon&r=PG&f=1", "display_name": "hexhex", "link": "https://stackoverflow.com/users/5931939/hexhex"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1492079605, "post_id": 43387843, "comment_id": 73840542, "body": "@BenjaminHodgson thanks a lot for this overview! I will look at these options and post my used solution."}, {"owner": {"reputation": 123, "user_id": 5931939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/681e5cb3394a3dccd07b910c7162e2b0?s=128&d=identicon&r=PG&f=1", "display_name": "hexhex", "link": "https://stackoverflow.com/users/5931939/hexhex"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 0, "creation_date": 1492079684, "post_id": 43387843, "comment_id": 73840594, "body": "@arrowd You are right - I meant only the default LanguageDef&#39;s, which rely on Identity. I will fix the post."}], "answers": [{"comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1492088914, "post_id": 43391271, "comment_id": 73847271, "body": "I&#39;d probably write an instance of <a href=\"https://hackage.haskell.org/package/mmorph-1.0.9/docs/Control-Monad-Morph.html#t:MFunctor\" rel=\"nofollow noreferrer\"><code>MFunctor</code></a> for <code>ParsecT s u</code> and write <code>parsecTrans = hoist generalize</code>"}], "tags": [], "owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "is_accepted": false, "score": 0, "last_activity_date": 1492083426, "creation_date": 1492083426, "answer_id": 43391271, "question_id": 43387843, "link": "https://stackoverflow.com/questions/43387843/extending-input-in-haskell-parsec/43391271#43391271", "title": "Extending input in Haskell Parsec", "body": "<p>Okay, here is what I come up with:</p>\n\n<pre><code>parsecTrans :: Monad m =&gt; ParsecT s u Identity a -&gt; ParsecT s u m a\nparsecTrans p = mkPT $ \\s -&gt; return $ fmap (return . runIdentity) $ runIdentity $ (runParsecT p) s\n</code></pre>\n\n<p>This function unpacks <code>ParsecT</code> monad and generalizes it to arbitrary monad. You can use it to lift all <code>Identity</code>-based parsers to <code>IO</code> based ones.</p>\n"}], "owner": {"reputation": 123, "user_id": 5931939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/681e5cb3394a3dccd07b910c7162e2b0?s=128&d=identicon&r=PG&f=1", "display_name": "hexhex", "link": "https://stackoverflow.com/users/5931939/hexhex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1492083426, "creation_date": 1492074093, "last_edit_date": 1492080662, "question_id": 43387843, "link": "https://stackoverflow.com/questions/43387843/extending-input-in-haskell-parsec", "title": "Extending input in Haskell Parsec", "body": "<p>I want to implement a Parsec parser for a simple language that allows file inclusions. I.e., the language looks like this:</p>\n\n<pre><code>include otherfile;\n\nexpression in the language;\n</code></pre>\n\n<p>If an inclusion is parsed, I want to read a file with this name and embed its parsed contents in the parent structure.</p>\n\n<p>Since I have to read a file, the parser needs to be packed in IO. My guess was that the underyling monad <code>u</code> in <code>ParsecT s u m a</code> can be used for this. However, this leads to quite some changes in the language definition since the LanguageDef's rely on <code>Identity</code> as an underyling monad.</p>\n\n<p>Is my approach reasonable? Are there other ways to include files within a parser, e.g., extending the input stream?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user5388697"}, "edited": false, "score": 0, "creation_date": 1492083455, "post_id": 43390945, "comment_id": 73843253, "body": "The example I gave at the top is what should work, so have I incorrectly defined x so as that it only works with &quot;&quot; around it, so my <code>var</code> function is incorrect? I tried <code>parseString &quot;\\&quot;x\\&quot;:=1&quot;</code> and got the error <code>Exception: &quot;1:6:\\nunexpected &#39;1&#39;\\nexpecting \\&quot;Add\\&quot;, \\&quot;Mult\\&quot;, \\&quot;Sub\\&quot;, &#39;N&#39;, or &#39;V&#39;\\n&quot;</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1492087120, "post_id": 43390945, "comment_id": 73845961, "body": "@datguywelbz Yes, your parser is requiring quotes around x. Also, it is requiring Add, etc. in front of expressions, which copes with the examples at the top."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 0, "last_activity_date": 1492082632, "creation_date": 1492082632, "answer_id": 43390945, "question_id": 43387827, "link": "https://stackoverflow.com/questions/43387827/parser-does-not-return-anything-in-terminal/43390945#43390945", "title": "Parser does not return anything in terminal", "body": "<pre><code>var = tok \"\\\"\" *&gt; some (noneOf (\"\\n\\r\\\"\")) &lt;* tok \"\\\"\" &lt;* whitespace\n</code></pre>\n\n<p>It looks as if <code>x</code> is not a valid variable name according to this parser, hence <code>x:=1</code> is not an assignment.</p>\n\n<p>A variable name could be <code>\"x\"</code> instead. Try something like <code>parseString \"\\\"x\\\":=1\"</code> and see what happens.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5388697"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1492082632, "creation_date": 1492074039, "question_id": 43387827, "link": "https://stackoverflow.com/questions/43387827/parser-does-not-return-anything-in-terminal", "title": "Parser does not return anything in terminal", "body": "<p>I'm trying to write a parser for the Proc language, which is an extended version of the While language. When complete it should be able to take input such as:</p>\n\n<pre><code>\"/*fac_loop (p.23)*/\\ny:=1;\\nwhile !(x=1) do (\\n y:=y*x;\\n x:=x-1\\n)\"\n</code></pre>\n\n<p>and produce:</p>\n\n<pre><code>(Comp (Ass \"y\" (N 1)) (While (Neg (Eq (V \"x\") (N 1))) (Comp (Ass \"y\"\n   (Mult (V \"y\") (V \"x\"))) (Ass \"x\" (Sub (V \"x\") (N 1))))))\n</code></pre>\n\n<p>I have been given the grammars for Aexp, Bexp and Stm along with the types of Num, Var, Pname, DecV and DecV which I cannot change. My Haskell code is below:</p>\n\n<pre><code>import System.IO\nimport Control.Monad\n{-# LANGUAGE StandaloneDeriving #-}\nimport Text.Megaparsec\nimport Text.Megaparsec.String\nimport Data.List (intercalate)\n\n\nimport Prelude hiding (Num)\nimport qualified Prelude (Num)\n\n\n-- S ::= x:=a\n--    | skip\n--    |S1 ;S2\n--    | if b then S1 else S2\n--    | while b do S\n--    | begin Dv Dv S end\n--    | call p\n-- Dv ::= var x := a ; DV | \u03b5\n-- Dp ::= proc p is S ; DP | \u03b5\n\ntype Num   = Integer\ntype Var   = String\ntype Pname = String\ntype DecV  = [(Var,Aexp)]\ntype DecP  = [(Pname,Stm)]\n\n--- Data structures -------------------------------\n\ndata Aexp = N Num\n          | V Var\n          | Mult Aexp Aexp\n          | Add Aexp Aexp\n          | Sub Aexp Aexp\n            deriving (Show, Eq, Read)\n\n\ndata Bexp = TRUE\n          | FALSE\n          | Neg Bexp\n          | And Bexp Bexp\n          | Le Aexp Aexp\n          | Eq Aexp Aexp\n            deriving (Show, Eq, Read)\n\n\ndata Stm = Skip\n          | Ass Var Aexp\n          | Comp Stm Stm\n          | If Bexp Stm Stm\n          | While Bexp Stm\n          | Block DecV DecP Stm\n          | Call Pname\n            deriving (Show, Eq, Read)\n\n\n--- Parser Preliminaries ----------------------------------------\n\ncr :: Parser [Char]\ncr = many (oneOf \"\\r\\n\")\n\ntok :: String -&gt; Parser String\ntok t = string t &lt;* whitespace\n\nwhitespace :: Parser ()\nwhitespace = many (oneOf \" \\t\") *&gt; pure ()\n\nwhileParser :: Parser Stm\nwhileParser = whitespace &gt;&gt; stm\n\n--- Parser\n\naexp :: Parser Aexp\naexp =  N     &lt;$ tok \"N\" &lt;*&gt; num\n    &lt;|&gt; V     &lt;$ tok \"V\" &lt;*&gt; var\n    &lt;|&gt; Mult  &lt;$ tok \"Mult\" &lt;*&gt; aexp &lt;* tok \"*\" &lt;*&gt; aexp\n    &lt;|&gt; Add   &lt;$ tok \"Add\" &lt;*&gt; aexp &lt;* tok \"+\" &lt;*&gt; aexp\n    &lt;|&gt; Sub   &lt;$ tok \"Sub\" &lt;*&gt; aexp &lt;* tok \"-\" &lt;*&gt; aexp\n\nbexp :: Parser Bexp\nbexp =  TRUE  &lt;$ tok \"TRUE\"\n    &lt;|&gt; FALSE &lt;$ tok \"FALSE\"\n    &lt;|&gt; Neg   &lt;$ tok \"Neg\" &lt;* tok \"!\" &lt;*&gt; bexp\n    &lt;|&gt; And   &lt;$ tok \"And\" &lt;*&gt; bexp &lt;* tok \"&amp;\" &lt;*&gt; bexp\n    &lt;|&gt; Le    &lt;$ tok \"Le\" &lt;*&gt; aexp &lt;* tok \"&lt;=\" &lt;*&gt; aexp\n    &lt;|&gt; Eq    &lt;$ tok \"Eq\" &lt;*&gt; aexp &lt;* tok \"=\" &lt;*&gt; aexp\n\nstm :: Parser Stm\nstm =   ifStm\n    &lt;|&gt; whileStm\n    &lt;|&gt; skipStm\n    &lt;|&gt; assStm\n    &lt;|&gt; compStm\n    &lt;|&gt; blockStm\n    &lt;|&gt; callStm\n\nifStm :: Parser Stm\nifStm =\n  do tok \"if\"\n     cond  &lt;- bexp\n     tok \"then\"\n     stm1 &lt;- stm\n     tok \"else\"\n     stm2 &lt;- stm\n     return $ If cond stm1 stm2\n\nwhileStm :: Parser Stm\nwhileStm =\n  do tok \"while\"\n     cond &lt;- bexp\n     tok \"do\"\n     stm &lt;- stm\n     return $ While cond stm\n\nassStm :: Parser Stm\nassStm =\n  do var  &lt;- var\n     tok \":=\"\n     expr &lt;- aexp\n     return $ Ass var expr\n\nskipStm :: Parser Stm\nskipStm = tok \"skip\" &gt;&gt; return Skip\n\ncompStm :: Parser Stm\ncompStm =\n  do stm1 &lt;- stm\n     tok \";\"\n     stm2 &lt;- stm\n     return $ Comp stm1 stm2\n\nblockStm :: Parser Stm\nblockStm =\n  do tok \"begin\"\n     decv &lt;- decv\n     decp &lt;- decp\n     stm &lt;- stm\n     tok \"end\"\n     return $ Block decv decp stm\n\ncallStm :: Parser Stm\ncallStm =\n  do tok \"call\"\n     pname &lt;- pname\n     return $ Call pname\n\nnum :: Parser Num\nnum = (some (oneOf ['0' .. '9']) &gt;&gt;= return . read) &lt;* whitespace\n\nvar :: Parser Var\nvar = tok \"\\\"\" *&gt; some (noneOf (\"\\n\\r\\\"\")) &lt;* tok \"\\\"\" &lt;* whitespace\n\ndecv :: Parser DecV\ndecv = many ((,) &lt;$&gt; var &lt;* tok \":=\" &lt;*&gt; aexp &lt;* tok \";\")\n\ndecp :: Parser DecP\ndecp = many ((,) &lt;$&gt; pname &lt;* tok \"is\" &lt;*&gt; stm &lt;* tok \";\")\n\npname :: Parser Pname\npname = tok \"\\\"\" *&gt; some (noneOf (\"\\n\\r\\\"\")) &lt;* tok \"\\\"\"\n\ntrue :: Bool\ntrue = True\n\nfalse :: Bool\nfalse = False\n\nparseString :: String -&gt; Stm\nparseString str =\n  case parse whileParser \"\" str of\n    Left e  -&gt; error $ show (parseErrorPretty e)\n    Right r -&gt; r\n</code></pre>\n\n<p>it compiles fine but when I run a command such as `parseString \"x:=1\" once the program is loaded in ghci, it just hangs and does not print out anything to the terminal. Any ideas why?</p>\n"}, {"tags": ["parsing", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 747, "user_id": 1970264, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/67f9ece670c7c74328b2f20488fd573c?s=128&d=identicon&r=PG", "display_name": "StalkAlex", "link": "https://stackoverflow.com/users/1970264/stalkalex"}, "edited": false, "score": 0, "creation_date": 1492065133, "post_id": 43384685, "comment_id": 73831612, "body": "Thank you, it works on example cases and now I got the idea. But unfortunetaly it fails on grading system in some other test."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": true, "score": 3, "last_activity_date": 1492066862, "last_edit_date": 1492066862, "creation_date": 1492063683, "answer_id": 43384685, "question_id": 43384256, "link": "https://stackoverflow.com/questions/43384256/self-made-many1-parser/43384685#43384685", "title": "Self made &quot;Many1&quot; parser", "body": "<p>Your <code>many1</code> will need some way to fail: as you've written it it consumes characters for a while, consing them onto a pending result, until it eventually runs out of matches. This doesn't cover any cases where the parse could fail.</p>\n\n<p>What you've implemented here is, in a way, <code>many0</code>, a parser which consumes 0 or more repetitions of something. Can you think of a way to implement <code>many1</code> in terms of <code>many0</code>? It will look something like:</p>\n\n<ol>\n<li>Consume one instance of <code>p</code>, <em>without</em> an alternative in case that fails</li>\n<li>Consume 0 or more instances of <code>p</code>, returning <code>[]</code> when that fails.</li>\n</ol>\n\n<p>Or in Haskell,</p>\n\n<pre><code>many1 :: Prs a -&gt; Prs [a]\nmany1 p = (:) &lt;$&gt; p &lt;*&gt; many0 p\n</code></pre>\n"}], "owner": {"reputation": 747, "user_id": 1970264, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/67f9ece670c7c74328b2f20488fd573c?s=128&d=identicon&r=PG", "display_name": "StalkAlex", "link": "https://stackoverflow.com/users/1970264/stalkalex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 43384685, "answer_count": 1, "score": 1, "last_activity_date": 1492066862, "creation_date": 1492061617, "question_id": 43384256, "link": "https://stackoverflow.com/questions/43384256/self-made-many1-parser", "title": "Self made &quot;Many1&quot; parser", "body": "<p>This is task from online course. I've been sitting on this for two days. Please give some explanation or hints to solve it.</p>\n\n<p>Here's type</p>\n\n<pre><code>newtype Prs a = Prs { runPrs :: String -&gt; Maybe (a, String) }\n</code></pre>\n\n<p>I need to implement <code>many1</code> parser. This is how it should work</p>\n\n<pre><code>&gt; runPrs (many1 $ char 'A') \"AAABCDE\"\nJust (\"AAA\",\"BCDE\")\n&gt; runPrs (many1 $ char 'A') \"BCDE\"\nNothing\n</code></pre>\n\n<p>I have parser <code>many</code> implemented like that</p>\n\n<pre><code>many p = (:) &lt;$&gt; p &lt;*&gt; many p  &lt;|&gt; pure []\n</code></pre>\n\n<p>Here's output for previous example.</p>\n\n<pre><code>*Main&gt; test9\nJust (\"AAA\",\"BCDE\")\n*Main&gt; test10\nJust (\"\",\"BCDE\")\n</code></pre>\n\n<p>Note last result, it returns empty string but <code>many1</code> should return <code>Nothing</code>. I don't know how to change <code>many</code> code to make work like <code>many1</code>. I can't undestand how to stop on first incorrect symbol. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 4185, "user_id": 15467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89c04ada36efa853c7f5be0a96b6dd9?s=128&d=identicon&r=PG", "display_name": "ja.", "link": "https://stackoverflow.com/users/15467/ja"}, "edited": false, "score": 0, "creation_date": 1492057382, "post_id": 43383089, "comment_id": 73828689, "body": "start with getting your first line to compile: <code>data Client = aClient {name::String,alcohol::Int,friends::[Client]} deriving (Show) </code>"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1492063198, "post_id": 43383089, "comment_id": 73830722, "body": "That won&#39;t compile either, ja. The data constructor has to start with a capital letter."}, {"owner": {"reputation": 4185, "user_id": 15467, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a89c04ada36efa853c7f5be0a96b6dd9?s=128&d=identicon&r=PG", "display_name": "ja.", "link": "https://stackoverflow.com/users/15467/ja"}, "edited": false, "score": 0, "creation_date": 1492063480, "post_id": 43383089, "comment_id": 73830849, "body": "That&#39;s right; that was a tip, not the answer."}, {"owner": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "edited": false, "score": 0, "creation_date": 1492086124, "post_id": 43383089, "comment_id": 73845225, "body": "You won&#39;t really be &quot;updating&quot; the alcohol field, as you would in an imperative language. Rather, you&#39;ll be constructing a new <code>Client</code> with the appropriate value in the alcohol field. Would you know how to do that?"}], "answers": [{"tags": [], "owner": {"reputation": 1722, "user_id": 1526266, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/1HT7M.jpg?s=128&g=1", "display_name": "Rob Stewart", "link": "https://stackoverflow.com/users/1526266/rob-stewart"}, "is_accepted": true, "score": -1, "last_activity_date": 1492089645, "last_edit_date": 1492089645, "creation_date": 1492084479, "answer_id": 43391647, "question_id": 43383089, "link": "https://stackoverflow.com/questions/43383089/function-with-data-types/43391647#43391647", "title": "Function with data types", "body": "<pre class=\"lang-haskell prettyprint-override\"><code>data Client = Client {name::String,alcohol::Int,friends::[Client]} deriving (Show)\n\nletgo :: Client -&gt; Integer -&gt; Client\nletgo client@(Client name alcohol friends) hours\n  | sufficientRest hours = Client name (increaseResistance alcohol) friends\n  | otherwise = client\n\nsufficientRest     :: Integer -&gt; Bool\nincreaseResistance :: Int -&gt; Int\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 7847767, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/10208231670339035/picture?type=large", "display_name": "Felipe Otero", "link": "https://stackoverflow.com/users/7847767/felipe-otero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 43391647, "answer_count": 1, "score": 1, "last_activity_date": 1492089645, "creation_date": 1492054374, "last_edit_date": 1492057991, "question_id": 43383089, "link": "https://stackoverflow.com/questions/43383089/function-with-data-types", "title": "Function with data types", "body": "<p>I have this data in my code</p>\n\n<pre><code>data Client = aClient {name::String,alcohol::Int,friends::[Client]} deriving (Show)\n</code></pre>\n\n<p>I'm trying to make a function that depends on the amount of hours that a client rest, it increase the alcohol resistance.</p>\n\n<pre><code>letgo :: Client -&gt; Integer -&gt; Client\nletgo (aClient _ alcohol _) hours\n</code></pre>\n\n<p>I need to know how to update that alcohol field within my data depending on the condition.</p>\n"}, {"tags": ["haskell", "monads", "monad-transformers"], "answers": [{"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": true, "score": 3, "last_activity_date": 1492076028, "last_edit_date": 1495541860, "creation_date": 1492076028, "answer_id": 43388598, "question_id": 43382213, "link": "https://stackoverflow.com/questions/43382213/a-monadtransformer-to-typecheck-for-a-completed-action/43388598#43388598", "title": "A MonadTransformer to typecheck for a completed action", "body": "<p>Sounds like some kind of <a href=\"https://stackoverflow.com/questions/28690448/what-is-indexed-monad\">indexed monad</a> could help. Indexed monads allow or forbid some operations according to some type-level state.</p>\n\n<hr>\n\n<p>We could also rely on polymorphism:</p>\n\n<pre><code>{-# language RankNTypes #-}\nimport Control.Monad\nimport Control.Monad.Trans.State\n\n-- Receives an v and returns a \"proof\" token\nnewtype Gulp token v = Gulp (v -&gt; IO token)\n\n-- Computation polymorphic on the token\ntype EnsuredWrite v r = forall token. StateT (Gulp token v) IO (token,r)\n</code></pre>\n\n<p>The idea is that actions of type <code>EnsuredWrite</code> need to return a <code>token</code> value, but only know how to produce one by feeding the function in <code>Gulp</code>. If they return at all, they must have called that function.</p>\n\n<p>The actual type of the token is not important, it can be a simple <code>()</code>. But <code>EnsuredWrite</code> actions shouldn't know that, hence the <code>forall</code>.</p>\n\n<p>This solution doesn't forbid repeated writes, though.</p>\n"}], "owner": {"reputation": 25321, "user_id": 163177, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e811b5337bcad19d52c8fed3a0ea0075?s=128&d=identicon&r=PG", "display_name": "John F. Miller", "link": "https://stackoverflow.com/users/163177/john-f-miller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 1, "accepted_answer_id": 43388598, "answer_count": 1, "score": 3, "last_activity_date": 1492076028, "creation_date": 1492047827, "question_id": 43382213, "link": "https://stackoverflow.com/questions/43382213/a-monadtransformer-to-typecheck-for-a-completed-action", "title": "A MonadTransformer to typecheck for a completed action", "body": "<p><strong>Preamble</strong></p>\n\n<p>This is one of those questions where I think that someone has already solved my problem, but I don't know where to look.</p>\n\n<p><strong>Question</strong></p>\n\n<p>I am looking for a MonadTransformer that carries the idea of being complete or incomplete in such a way that an action of the monad stack will fail to typecheck unless it is complete.</p>\n\n<p><strong>My Situation</strong></p>\n\n<p>I have a Monad stack with a state which holds an MVar.  Failing to write to this MVar will cause a <code>thread blocked indefinitely in an MVar</code> exception. I could just check the MVar itself, but handing it off to another thread (which follows the same rules) is also a valid way to get the MVar filled (as is throwing an error).</p>\n\n<p>I am seeking some way for the typechecker to throw an error if one of those conditions is not met by the time the monad is run.  I can check at run time but, I think there might be a way to use the type system.</p>\n"}]