[{"tags": ["list", "haskell", "types", "maybe"], "comments": [{"owner": {"reputation": 3609, "user_id": 2565354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/590ed3229d95cdcaa05a96028c586165?s=128&d=identicon&r=PG", "display_name": "badcook", "link": "https://stackoverflow.com/users/2565354/badcook"}, "edited": false, "score": 0, "creation_date": 1461200486, "post_id": 36756536, "comment_id": 61095291, "body": "One place to look for potential motivations as to why we care about distinguishing isomorphic types is why people use and care about <code>newtype</code>."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 6, "creation_date": 1461201368, "post_id": 36756536, "comment_id": 61095500, "body": "I would ask &quot;why would you use a list when you just need a <code>Maybe</code>?&quot; <code>Maybe</code> is more specific and many errors are prevented because you can&#39;t even write the erroneous code. It also makes your intent more clear in type signatures. I can&#39;t really think of a benefit off the top of my head of using a list in a situation where you could use a <code>Maybe</code> (except maybe as a very brief intermediate form). What prompted the question?"}, {"owner": {"reputation": 769, "user_id": 6155692, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0e4ef26e040c1b1fbc5f10777e5b0649?s=128&d=identicon&r=PG&f=1", "display_name": "Zac", "link": "https://stackoverflow.com/users/6155692/zac"}, "edited": false, "score": 0, "creation_date": 1555407733, "post_id": 36756536, "comment_id": 98091177, "body": "One example of using a list in place of <code>Maybe</code> is in the book &quot;Programming in Haskell&quot;, where it is shown how to implement a <code>Parser</code> monad from scratch (similar to <code>ReadP</code>), and it has a type of <code>String -&gt; [(a, String)]</code>, which is perculiar because the list is only ever empty or a singleton. No idea why this is done, just giving an example"}], "answers": [{"tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": false, "score": 3, "last_activity_date": 1461192779, "creation_date": 1461192779, "answer_id": 36756622, "question_id": 36756536, "link": "https://stackoverflow.com/questions/36756536/why-would-i-ever-want-to-use-maybe-instead-of-a-list/36756622#36756622", "title": "Why would I ever want to use Maybe instead of a List?", "body": "<p>Because there are an infinite number of possible lists, and a finite number of possible values for the Maybe type. It perfectly represents one thing or the absence of something without any other possibility.</p>\n"}, {"comments": [{"owner": {"reputation": 755, "user_id": 5323311, "user_type": "registered", "accept_rate": 74, "profile_image": "https://lh5.googleusercontent.com/-v8SDvlJNQBU/AAAAAAAAAAI/AAAAAAAAAD4/IT0tDo9PwT4/photo.jpg?sz=128", "display_name": "Tshimanga", "link": "https://stackoverflow.com/users/5323311/tshimanga"}, "edited": false, "score": 0, "creation_date": 1461194096, "post_id": 36756636, "comment_id": 61093632, "body": "Yes, you are at full liberty to disregard the warning and use &quot;assignments&quot;  with non-exhaustive patterns (can&#39;t call them functions/maps if they aren&#39;t exhaustive over the domain). The situations in which you would use a Maybe type, however, are those (from what I&#39;ve seen) in which it is either easy or effortless to guarantee that using non-map assignments won&#39;t get you in trouble."}, {"owner": {"reputation": 755, "user_id": 5323311, "user_type": "registered", "accept_rate": 74, "profile_image": "https://lh5.googleusercontent.com/-v8SDvlJNQBU/AAAAAAAAAAI/AAAAAAAAAD4/IT0tDo9PwT4/photo.jpg?sz=128", "display_name": "Tshimanga", "link": "https://stackoverflow.com/users/5323311/tshimanga"}, "edited": false, "score": 0, "creation_date": 1461194236, "post_id": 36756636, "comment_id": 61093661, "body": "That said, I am still a budding haskeller so my experiences are possibly merely not yet extended to such problematic situations"}, {"owner": {"reputation": 13379, "user_id": 1033027, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b56ea1c43a4ecb1060ec8bcb8d2bce78?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/1033027/jules"}, "reply_to_user": {"reputation": 755, "user_id": 5323311, "user_type": "registered", "accept_rate": 74, "profile_image": "https://lh5.googleusercontent.com/-v8SDvlJNQBU/AAAAAAAAAAI/AAAAAAAAAD4/IT0tDo9PwT4/photo.jpg?sz=128", "display_name": "Tshimanga", "link": "https://stackoverflow.com/users/5323311/tshimanga"}, "edited": false, "score": 3, "creation_date": 1461200876, "post_id": 36756636, "comment_id": 61095391, "body": "@Tshimanga while you <i>can</i> disregard those warnings, it&#39;s often useful to write functions which are total over their domain, especially when writing something with a publicly-facing API (e.g. a package); <code>Maybe</code> helps with writing semantically meaningful code to achieve this, among other things."}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 14, "last_activity_date": 1461192883, "creation_date": 1461192883, "answer_id": 36756636, "question_id": 36756536, "link": "https://stackoverflow.com/questions/36756536/why-would-i-ever-want-to-use-maybe-instead-of-a-list/36756636#36756636", "title": "Why would I ever want to use Maybe instead of a List?", "body": "<p>Because if you match a list against the patterns <code>[]</code> and <code>[x]</code> that's not an exhaustive match and you'll get a warning about that, forcing you to either add another case that'll never get called or to ignore the warning.</p>\n\n<p>Matching a <code>Maybe</code> against <code>Nothing</code> and <code>Just x</code> however is exhaustive. So you'll only get a warning if you fail to match one of those cases.</p>\n\n<p>If you choose your types such that they can only represent values that you may actually produce, you can rely on non-exhaustiveness warnings to tell you about bugs in your code where you forget to check for a given a case. If you choose more \"permissive\" types, you'll always have to think about whether a warning represents an actual bug or just an impossible case.</p>\n"}, {"tags": [], "owner": {"reputation": 689, "user_id": 6217179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633461a7b7bd893feebbc9285d0fb049?s=128&d=identicon&r=PG&f=1", "display_name": "sapanoia", "link": "https://stackoverflow.com/users/6217179/sapanoia"}, "is_accepted": false, "score": 11, "last_activity_date": 1461193093, "creation_date": 1461193093, "answer_id": 36756676, "question_id": 36756536, "link": "https://stackoverflow.com/questions/36756536/why-would-i-ever-want-to-use-maybe-instead-of-a-list/36756676#36756676", "title": "Why would I ever want to use Maybe instead of a List?", "body": "<p>You should strive to have accurate types. <em>Maybe</em> expresses that there is exactly one value or that there is none. Many imperative languages represent the \"none\" case by the value <em>null</em>.</p>\n\n<p>If you chose a list instead of <em>Maybe</em>, all your functions would be faced with the possibility that they get a list with more than one member. Probably many of them would only be defined for one value, and would have to fail on a pattern match. By using <em>Maybe</em>, you avoid a class of runtime errors entirely.</p>\n"}, {"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1461196578, "post_id": 36756954, "comment_id": 61094282, "body": "As a concrete example, <code>Just x &lt;|&gt; Just y == Just x</code>, but <code>[x] &lt;|&gt; [y] == [x, y]</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1461197115, "post_id": 36756954, "comment_id": 61094416, "body": "This doesn&#39;t seem like an ideal example, since these behave similarly if (like the OP) you only pay attention to the head of the list. The example I&#39;m thinking of now is <code>Monoid</code>, but that&#39;s a poor example because the <code>Monoid (Maybe a)</code> instance was designed wrong."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1461200863, "post_id": 36756954, "comment_id": 61095388, "body": "@dfeuer Yeah, the example could be better. I couldn&#39;t think of anything else simple enough (<code>Functor</code>, <code>Applicative</code>, <code>Monad</code> behave the same way and <code>Monoid</code> also requires another <code>Monoid</code>). If you have a better idea, please comment it!"}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 8, "last_activity_date": 1461194628, "creation_date": 1461194628, "answer_id": 36756954, "question_id": 36756536, "link": "https://stackoverflow.com/questions/36756536/why-would-i-ever-want-to-use-maybe-instead-of-a-list/36756954#36756954", "title": "Why would I ever want to use Maybe instead of a List?", "body": "<p>Building on existing (and correct) answers, I'll mention a <em>typeclass</em> based answer.</p>\n\n<p><strong>Different types convey different intentions</strong> - returning a <code>Maybe a</code> represents a computation with the possiblity of failing while <code>[a]</code> could represent non-determinism (or, in simpler terms, multiple possible return values).</p>\n\n<p>This plays into the fact that different types have different instances for typeclasses - and these instances cater to the underlying essence the type conveys. Take <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Control-Applicative.html\" rel=\"noreferrer\"><code>Alternative</code></a> and its operator <code>(&lt;|&gt;)</code> which represents what it means to combine (or choose) between arguments given.</p>\n\n<ul>\n<li><strong><code>Maybe a</code></strong> Combining computations that can fail just means taking the first that is not <code>Nothing</code></li>\n<li><strong><code>[a]</code></strong> Combining two computations that each had multiple return values just means concatenating together all possible values.</li>\n</ul>\n\n<p>Then, depending on which types your functions use, <code>(&lt;|&gt;)</code> would behave differently. Of course, you could argue that you don't need <code>(&lt;|&gt;)</code> or anything like that, but then you are missing out on one of Haskell's main strengths: it's many high-level combinator libraries.</p>\n\n<p>As a general rule, we like our types to be as snug fitting and intuitive as possible. That way, we are not fighting the standard libraries and our code is more readable.</p>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1461227087, "post_id": 36757464, "comment_id": 61105939, "body": "My thoughts, precisely."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 5, "last_activity_date": 1461205318, "last_edit_date": 1461205318, "creation_date": 1461198017, "answer_id": 36757464, "question_id": 36756536, "link": "https://stackoverflow.com/questions/36756536/why-would-i-ever-want-to-use-maybe-instead-of-a-list/36757464#36757464", "title": "Why would I ever want to use Maybe instead of a List?", "body": "<p>Lisp, Scheme, Python, Ruby, JavaScript, etc., manage to get along with just one type each, which you could represent in Haskell with a big sum type. Every function handling a JavaScript (or whatever) value must be prepared to receive a number, a string, a function, a piece of the document object model, etc., and throw an exception if it gets something unexpected. People who program in typed languages like Haskell prefer to limit the number of unexpected things that can occur. They also like to express <em>ideas</em> using types, making types useful (and machine-checked) documentation. The closer the types come to representing the intended meaning, the more useful they are.</p>\n"}, {"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 2, "last_activity_date": 1461212230, "last_edit_date": 1461212230, "creation_date": 1461202916, "answer_id": 36758111, "question_id": 36756536, "link": "https://stackoverflow.com/questions/36756536/why-would-i-ever-want-to-use-maybe-instead-of-a-list/36758111#36758111", "title": "Why would I ever want to use Maybe instead of a List?", "body": "<p>Several answers have mentioned exhaustiveness as a factor here.  I think it is a factor, but not the biggest one, because there is a way to consistently treat lists as if they were <code>Maybe</code>s, which the <code>listToMaybe</code> function illustrates:</p>\n\n<pre><code>listToMaybe :: [a] -&gt; Maybe a\nlistToMaybe [] = Nothing\nlistToMaybe (a:_) = Just a\n</code></pre>\n\n<p>That's an exhaustive pattern match, which rules out any straightforward errors.</p>\n\n<p>The factor I'd highlight as bigger is that by using the type that more precisely models the behavior of your code, you eliminate potential behaviors that would be possible if you used a more general alternative.  Say for example you have some context in your code where you uses a type of the form <code>a -&gt; [b]</code>, though the only correct alternatives (given your program's specification) are empty or singleton lists.  Try as hard as you may to enforce the convention that this context should obey that rule, it's still possible that you'll mess up and:</p>\n\n<ol>\n<li>Somehow a function used in that context will produce a list of two or more items;</li>\n<li>And somehow a function that uses the results produced in that context will observe whether the lists have two or more items, and behave incorrectly in that case. \n\n<ul>\n<li>Example: some code that expects there to be no more than one value will blindly print the contents of the list and thus print multiple items when only one was supposed to be.</li>\n</ul></li>\n</ol>\n\n<p>But if you use <code>Maybe</code>, then there really must be either one value or none, and the compiler enforces this.</p>\n"}, {"tags": [], "owner": {"reputation": 9966, "user_id": 171121, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/63c0a0bf0ddd889a0ea8f78d1ea73b8a?s=128&d=identicon&r=PG", "display_name": "Dax Fohl", "link": "https://stackoverflow.com/users/171121/dax-fohl"}, "is_accepted": false, "score": 0, "last_activity_date": 1461213852, "creation_date": 1461213852, "answer_id": 36759852, "question_id": 36756536, "link": "https://stackoverflow.com/questions/36756536/why-would-i-ever-want-to-use-maybe-instead-of-a-list/36759852#36759852", "title": "Why would I ever want to use Maybe instead of a List?", "body": "<p>Even though isomorphic, e.g. QuickCheck will run slower because of the increase in search space. </p>\n"}], "owner": {"reputation": 755, "user_id": 5323311, "user_type": "registered", "accept_rate": 74, "profile_image": "https://lh5.googleusercontent.com/-v8SDvlJNQBU/AAAAAAAAAAI/AAAAAAAAAD4/IT0tDo9PwT4/photo.jpg?sz=128", "display_name": "Tshimanga", "link": "https://stackoverflow.com/users/5323311/tshimanga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 310, "favorite_count": 0, "accepted_answer_id": 36756954, "answer_count": 7, "score": 4, "last_activity_date": 1461213852, "creation_date": 1461192284, "last_edit_date": 1461203063, "question_id": 36756536, "link": "https://stackoverflow.com/questions/36756536/why-would-i-ever-want-to-use-maybe-instead-of-a-list", "title": "Why would I ever want to use Maybe instead of a List?", "body": "<p>Seeing as the Maybe type is isomorphic to the set of null and singleton lists, why would anyone ever want to use the Maybe type when I could just use lists to accomodate absence?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 349, "user_id": 5272264, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/98128613e53d179b233d139cc64f6e7f?s=128&d=identicon&r=PG&f=1", "display_name": "zaig", "link": "https://stackoverflow.com/users/5272264/zaig"}, "edited": false, "score": 0, "creation_date": 1461195520, "post_id": 36755362, "comment_id": 61094012, "body": "I don&#39;t really understand how this works? Can you explain me?"}, {"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "reply_to_user": {"reputation": 349, "user_id": 5272264, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/98128613e53d179b233d139cc64f6e7f?s=128&d=identicon&r=PG&f=1", "display_name": "zaig", "link": "https://stackoverflow.com/users/5272264/zaig"}, "edited": false, "score": 0, "creation_date": 1461233189, "post_id": 36755362, "comment_id": 61110377, "body": "@zaig this is an application of <code>foldr :: Foldable t =&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; t a -&gt; b</code> where <code>b</code> itself is a function, like <code>c -&gt; d</code>, so the signature would be <code>(a -&gt; (c -&gt; d) -&gt; c -&gt; d) -&gt; (c -&gt; d) -&gt; t a -&gt; c -&gt; d</code>. if you follow the signature should make sense how it works"}, {"owner": {"reputation": 349, "user_id": 5272264, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/98128613e53d179b233d139cc64f6e7f?s=128&d=identicon&r=PG&f=1", "display_name": "zaig", "link": "https://stackoverflow.com/users/5272264/zaig"}, "edited": false, "score": 0, "creation_date": 1461246243, "post_id": 36755362, "comment_id": 61120273, "body": "I still don&#39;t understand who is the function f? By the order I would say it will be <code>randomRs</code> when go will be called, but <code>randomRs</code> takes a generator and <code>lst</code> and <code>x</code> are not generators. I am still a little confused. What am I missing?"}, {"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "reply_to_user": {"reputation": 349, "user_id": 5272264, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/98128613e53d179b233d139cc64f6e7f?s=128&d=identicon&r=PG&f=1", "display_name": "zaig", "link": "https://stackoverflow.com/users/5272264/zaig"}, "edited": false, "score": 0, "creation_date": 1461246428, "post_id": 36755362, "comment_id": 61120441, "body": "@zaig <code>(randomRs (1, 20) g)</code> is an infinite list, and it has already passed in the generator <code>g</code>. you can replace <code>(randomRs (1, 20) g)</code> with an arbitrary list, say <code>[2, 3, 6, 8, 5]</code>, to see how this works"}, {"owner": {"reputation": 349, "user_id": 5272264, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/98128613e53d179b233d139cc64f6e7f?s=128&d=identicon&r=PG&f=1", "display_name": "zaig", "link": "https://stackoverflow.com/users/5272264/zaig"}, "edited": false, "score": 0, "creation_date": 1461260787, "post_id": 36755362, "comment_id": 61130432, "body": "If you can explain step by step the code with the list <code>[2, 3, 6]</code> I&#39;d be grateful. I don&#39;t get who <code>f</code> is when the <code>go</code> function is called. And also which are the parameters <code>go</code> is taking."}, {"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "reply_to_user": {"reputation": 349, "user_id": 5272264, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/98128613e53d179b233d139cc64f6e7f?s=128&d=identicon&r=PG&f=1", "display_name": "zaig", "link": "https://stackoverflow.com/users/5272264/zaig"}, "edited": false, "score": 0, "creation_date": 1461260989, "post_id": 36755362, "comment_id": 61130522, "body": "@zaig <a href=\"http://stackoverflow.com/questions/6172004/writing-foldl-using-foldr\">this question</a> has a step by step example of a similar usage"}], "tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": true, "score": 2, "last_activity_date": 1461187346, "last_edit_date": 1461187346, "creation_date": 1461187024, "answer_id": 36755362, "question_id": 36755220, "link": "https://stackoverflow.com/questions/36755220/haskell-generate-random-numbers-with-a-propriety-without-explicit-recursion/36755362#36755362", "title": "Haskell generate random numbers with a propriety without explicit recursion", "body": "<p>A right fold would probably fit better, something like:</p>\n\n<pre><code>import System.Random (RandomGen, randomRs, mkStdGen)\n\nrandomFunc :: RandomGen g =&gt; g -&gt; [Int]\nrandomFunc g = foldr go (const []) (randomRs (1, 20) g) 1\n    where go x f lst = if gcd x lst == 1 then x: f x else f lst\n</code></pre>\n\n<p>then</p>\n\n<pre><code>\\&gt; take 20 . randomFunc $ mkStdGen 1\n[16,7,6,19,8,15,16,1,9,2,15,17,14,3,11,17,15,8,1,5]\n</code></pre>\n\n<p>Doing so you may build the list using <code>:</code> instead of <code>++</code> which may cause quadratic performance cost, and you may bypass the call to <code>last</code>.</p>\n"}], "owner": {"reputation": 349, "user_id": 5272264, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/98128613e53d179b233d139cc64f6e7f?s=128&d=identicon&r=PG&f=1", "display_name": "zaig", "link": "https://stackoverflow.com/users/5272264/zaig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 36755362, "answer_count": 1, "score": 2, "last_activity_date": 1461187346, "creation_date": 1461186514, "question_id": 36755220, "link": "https://stackoverflow.com/questions/36755220/haskell-generate-random-numbers-with-a-propriety-without-explicit-recursion", "title": "Haskell generate random numbers with a propriety without explicit recursion", "body": "<p>Here I have a function to generate a stream of random numbers between 0 and 999.</p>\n\n<pre><code>randomHelp :: RandomGen g =&gt; g -&gt; [Int]\nrandomHelp g = zipWith (mod) (map fst $ iterate (next . snd) $ next $ snd $ split g) $ repeat 1000\n</code></pre>\n\n<p>I would like to select all numbers from the stream defined above and each <code>elem(i)</code> and <code>elem(i + 1)</code> must respect a propriety. For example their gcd have to be one. All I can think is a fold function with because I can start with and accumulator which contains the number 1 (let's assume 1 will be the first element I want to show) then I check the propriety in fold's function and if it is respected i add the element to the accumulator, but the problem is the program blocks because of stackoverflow I think.</p>\n\n<p>Here is the function:</p>\n\n<pre><code>randomFunc :: RandomGen g =&gt; g -&gt; [Int]\nrandomFunc g = foldl (\\acc x -&gt; if (gcd x (last acc) == 1) then acc ++ [x] else acc) [1] (randomHelp g)\n</code></pre>\n\n<p>Note: I don't want to use explicit recursion.</p>\n"}, {"tags": ["haskell", "ghc", "cabal"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 4, "creation_date": 1461183141, "post_id": 36754027, "comment_id": 61088666, "body": "I see how this could be useful, but don&#39;t think there&#39;s a standard way to accomplish it. You&#39;ll be best off simply defining <code>MyLib</code> as a proxy module which merely re-exports some of the contents of <code>MyLibExt</code>. That&#39;s certainly how it&#39;s done in many existing libraries."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1461183421, "post_id": 36754027, "comment_id": 61088858, "body": "Just put everything inside the extended version <code>MyLib.Internal</code> and then import that into <code>MyLib</code> but re-export only the basic stuff. This is a pretty common pattern."}], "answers": [{"tags": [], "owner": {"reputation": 574, "user_id": 1504029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96a8e68ffdcc9aca971108c6a989b74c?s=128&d=identicon&r=PG", "display_name": "Paul Visschers", "link": "https://stackoverflow.com/users/1504029/paul-visschers"}, "is_accepted": true, "score": 1, "last_activity_date": 1461184461, "creation_date": 1461184461, "answer_id": 36754622, "question_id": 36754027, "link": "https://stackoverflow.com/questions/36754027/building-two-distinct-modules-with-the-same-source-code-with-haskell/36754622#36754622", "title": "Building two distinct modules with the same source code with Haskell", "body": "<p>You can't put two modules in the same file. But you can sort of get what you want with a bit of re-exporting.</p>\n\n<p>One file would have both the basic and extended code (I shortened it a bit):</p>\n\n<pre><code>module MyLibExt where\n\nMyType = TypeA | TypeB | TypeC | TypeExtendedD | TypeExtendedE\n\nmyFunction TypeA = ...\nmyFunction TypeB = ...\nmyFunction TypeExtendedD = ...\n</code></pre>\n\n<p>then the other file would be the basic one:</p>\n\n<pre><code>module MyLib (MyType (TypeA, TypeB, TypeC), myFunction)\n\nimport MyLibExt\n</code></pre>\n\n<p>This way if someone imports just <code>MyLib</code> they only get access to the basic constructors, but not the extended ones. <code>myFunction</code> will still work on <code>TypeExtendedD</code> values like it would in <code>MyLibExt</code>, but since we're unable to create those values with just <code>MyLib</code>, that's fine.</p>\n\n<p>More generally, when you define your module, you can say what exactly you want to export. Here are some basic examples:</p>\n\n<pre><code>module Example (\n  exampleFunction, -- simply export this function.\n\n  ExampleType1 (), -- export the type, but no constructors.\n  ExampleType2 (ExampleConstructor1, ExampleConstructor2), -- export the given type and its given constructors. You can't export constructors like functions, you have to do it like this).\n  ExampleType3 (..), -- export given type and all its constructors.\n\n  ExampleClass1, -- export type class, but no functions that belong to it.\n  ExampleClass2 (exampleFunction2, exampleFunction3), -- export type class and the given functions belonging to it. You can also export these functions as though they were normal functions, like in the first of the examples.\n  ExampleClass3 (..), -- export type class and all its functions.\n\n  module Module1, -- re-export anything that is imported from Module1.\n  ) where\n</code></pre>\n\n<p>You can export anything that is in scope, including anything that you imported from other modules. In fact if you want to re-export something from other modules, you need to explicitly define an export list like this, by default it will only export whatever is defined in this module.</p>\n"}, {"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": false, "score": 0, "last_activity_date": 1461197642, "last_edit_date": 1461197642, "creation_date": 1461197311, "answer_id": 36757370, "question_id": 36754027, "link": "https://stackoverflow.com/questions/36754027/building-two-distinct-modules-with-the-same-source-code-with-haskell/36757370#36757370", "title": "Building two distinct modules with the same source code with Haskell", "body": "<p>Consider abstracting.  It may not be worth it, but sometimes there is beauty and power hiding, and it can only be teased out with abstraction.  For your case <code>MyType</code> and <code>MyFunction</code>, perhaps it goes like this (just an example, and it could look very different depending on your details):</p>\n\n<pre><code>class MyFunction a where\n    myFunction :: a -&gt; Int\n\ndata MyType = TypeA | TypeB | TypeC\n\ninstance MyFunction MyType where\n    myFunction TypeA = 0\n    myFunction TypeB = 1\n    myFunction TypeC = 2\n\ndata MyTypeExt = Orig MyType | TypeExtendedD | TypeExtendedE\n\ninstance MyFunction MyTypeExt where\n    myFunction (Orig x) = myFunction x\n    myFunction TypeExtendedD = myFunction TypeC + 1\n    myFunction TypeExtendedE = myFunction TypeC + 2\n</code></pre>\n\n<p>That would be the first level.  You can go further, making the extension parametric:</p>\n\n<pre><code>data MyTypeExt a = Orig a | TypeExtendedD | TypeExtendedE\n\ninstance (MyFunction a) =&gt; MyFunction (MyTypeExt a) where\n    ...  -- defined so that it works for any myFunction-able Orig\n</code></pre>\n\n<p>Then it's easy to separate out into different files.  But the advantages of abstracting go far beyond splitting things into public and private spaces.  If there are two \"valid\" versions of your code, then those two versions each have consistent meanings.  Find what they have in common, see if you can code what they have in common without referencing either one in particular.  Then look carefully -- what else has these things in common with your two examples?  Can you build your two examples out of yet simpler pieces that also have those things in common?  In Haskell, code programs you.</p>\n"}], "owner": {"reputation": 2337, "user_id": 3595992, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/a8fc8a00391b1282338f66de57e3fea0?s=128&d=identicon&r=PG&f=1", "display_name": "JeanJouX", "link": "https://stackoverflow.com/users/3595992/jeanjoux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 36754622, "answer_count": 2, "score": 3, "last_activity_date": 1461197642, "creation_date": 1461182476, "question_id": 36754027, "link": "https://stackoverflow.com/questions/36754027/building-two-distinct-modules-with-the-same-source-code-with-haskell", "title": "Building two distinct modules with the same source code with Haskell", "body": "<p>I'm writing a module with Haskell and I would like to create two versions of this module : </p>\n\n<ul>\n<li>A 'basic' one (named MyLib) : for speed and public release.</li>\n<li>An 'extended' one (named MyLibExt) : for expert and private usage.</li>\n</ul>\n\n<p>For convenience, I would like these two modules (with two differents names) to share the same source files. the two modules will have the same type and same functions with some differences ('extended' version will rely on the 'basic' one).</p>\n\n<p>My idea is to have something like this : </p>\n\n<pre><code>module MyLib where  -- for 'basic' version\n\nmodule MyLibExt where  -- for 'extended' version\n\nMyType = \n         TypeA            -- for 'basic' version\n       | TypeB            -- for 'basic' version\n       | TypeC            -- for 'basic' version\n\n       | TypeExtendedD    -- for 'extended' version\n       | TypeExtendedE    -- for 'extended' version\n\n\nMyFunction TypeA         = ...  -- for 'basic' version\nMyFunction TypeB         = ...  -- for 'basic' version\n\nMyFunction TypeExtendedD = ...  -- for 'extended' version\n</code></pre>\n\n<p>and build the two modules with some compilation directive given to GHC/Cabal.</p>\n\n<p><strong>Is it possible to do a such thing with Haskell ?</strong></p>\n\n<p><strong>What are the GHC/Cabal compilation directive which can be useful to make conditionnal building ?</strong></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 6, "creation_date": 1461181301, "post_id": 36753155, "comment_id": 61087435, "body": "you can use <code>fromIntegral . length</code> instead of <code>foldl&#39; ...</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 2, "creation_date": 1461181542, "post_id": 36753155, "comment_id": 61087593, "body": "@behzad.nouri I agree, especially on 64 bit systems that is more than enough."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1461185265, "post_id": 36753155, "comment_id": 61090007, "body": "<code>foldl&#39;</code> is optimized exactly as much as you need. However, <code>fromIntegral . length</code> will often be faster because <code>Int</code> arithmetic is faster than, say, <code>Integer</code> arithmetic."}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1461186572, "post_id": 36753155, "comment_id": 61090667, "body": "Good to know. Does anyone know why this isn&#39;t the default implementation for <code>genericLength</code>?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 4, "creation_date": 1461188762, "post_id": 36753155, "comment_id": 61091716, "body": "@semicolon, thanks to its unfortunate reference implementation, <code>genericLength</code> is only really good for lazy natural numbers implemented in one particular way. That terrible flaw is pasted over for <code>Int</code> and <code>Integer</code> using rewrite rules. However, the potential performance problems are sufficiently serious that most people have just learned not to use <code>genericLength</code>, ever. So generalizing it would generally be a waste of time."}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1461188934, "post_id": 36753155, "comment_id": 61091779, "body": "@dfeuer Could that be fixed by changing the reference implementation to <code>fromIntegral . length</code>?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1461189398, "post_id": 36753155, "comment_id": 61091974, "body": "@semicolon, not really. That could break on 32-bit architectures, and would break any obscure code that relies on the current behavior (I&#39;m told there&#39;s at least one program out there that relies on it). That said, it might be possible to convince the right people some day."}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1461189605, "post_id": 36753155, "comment_id": 61092035, "body": "@dfeuer Some people have lists that are longer than 2^32? Because <code>genericLength</code> can only work on lists..."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1461190236, "post_id": 36753155, "comment_id": 61092280, "body": "Why not? <code>length $ [1..10] ++ [1..(maxBound :: Word)]</code> shouldn&#39;t take too long if you use <code>-O2</code>."}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1461190502, "post_id": 36753155, "comment_id": 61092378, "body": "@dfeuer Alright fair enough, well in that case why not have the reference implementation be <code>foldl&#39; (\\n _ -&gt; n + 1) 0</code>, wouldn&#39;t that be ok, if a little slower than <code>fromIntegral . length</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1461190806, "post_id": 36753155, "comment_id": 61092504, "body": "That will never work if the list is infinite. Can you see why the reference implementation can with the right <code>Num</code> instance?"}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1461191071, "post_id": 36753155, "comment_id": 61092586, "body": "By right do you mean custom? I can&#39;t think of one honestly, without some weird optimization rewrite rules and an <code>Infinity</code> value."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1461191735, "post_id": 36753155, "comment_id": 61092835, "body": "Use <code>data Nat = Z | S Nat</code>. Can you find five different ways to implement <code>+</code>? Can you see why some of these will make <code>genericLength</code> work for infinite lists?"}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1461195017, "post_id": 36753155, "comment_id": 61093864, "body": "Ah I see. So it would just be an infinite list of <code>S</code>? But I mean isn&#39;t that just basically a weird way of doing <code>\\list -&gt; const () &lt;$&gt; list</code> seeing as list is defined in a similar-ish way."}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 0, "creation_date": 1468853025, "post_id": 36753155, "comment_id": 64284957, "body": "Would something like having <code>genericLength</code> with <code>foldr</code> and potential performance issues and rewrite rules, but then also having <code>genericLength&#39;</code> with <code>foldl&#39;</code> and good performance work?"}], "answers": [{"tags": [], "owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "is_accepted": true, "score": 0, "last_activity_date": 1468943277, "creation_date": 1468943277, "answer_id": 38463167, "question_id": 36753155, "link": "https://stackoverflow.com/questions/36753155/actually-generic-length-function-in-haskell/38463167#38463167", "title": "Actually generic length function in Haskell", "body": "<p>I mean this was pretty much answered in the comments. But just so this question is marked as answered the reason is basically that <code>genericLength</code> has terrible performance due to it supporting lazy natural numbers, and thus should pretty much be avoided. This performance issue is partially avoided via rewrite rules, but even with that it is still not a good function to use and thus it isn't worth it to attempt to generalize it further.</p>\n"}], "owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 806, "favorite_count": 0, "accepted_answer_id": 38463167, "answer_count": 1, "score": 4, "last_activity_date": 1468943277, "creation_date": 1461179815, "last_edit_date": 1461964019, "question_id": 36753155, "link": "https://stackoverflow.com/questions/36753155/actually-generic-length-function-in-haskell", "title": "Actually generic length function in Haskell", "body": "<p><code>length</code> is generic on the input in that it accepts any <code>Foldable</code>.</p>\n\n<p><code>genericLength</code> is generic on the output in that it outputs any <code>Integral</code>.</p>\n\n<p>Is there an actually fully generic function with type:</p>\n\n<pre><code>(Integral b, Foldable t) =&gt; t a -&gt; b\n</code></pre>\n\n<p>Or even:</p>\n\n<pre><code>(Num b, Foldable t) =&gt; t a -&gt; b\n</code></pre>\n\n<p>As even though length should only ever produce integer values, integers are also floats, so producing any number works just fine.</p>\n\n<p>Currently I am just using:</p>\n\n<pre><code>foldl' (const (+ 1)) 0\n</code></pre>\n\n<p>I know one can be made fairly easily, but I also know that often the base functions are optimized in some way or another, so I was hoping there was an existing function for generically calculating <code>length</code>. If not my followup question is why? Specifically why doesn't <code>genericLength</code> accept a <code>Foldable</code>?</p>\n"}, {"tags": ["function", "haskell", "recursion"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1461179786, "post_id": 36753092, "comment_id": 61086504, "body": "you are aware that you never use the <code>&lt;</code> function, a hint would be assert that just <code>x</code> is in the second list (or not) and then do that recursively for all other <code>xs</code>"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1461179818, "post_id": 36753092, "comment_id": 61086521, "body": "What is the logic of your last line?  What is <code>disjoint</code> and where did it come from and why does it only need to consider the second list in isolation?"}, {"owner": {"reputation": 69, "user_id": 5548343, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-z8cHpXUKKFQ/AAAAAAAAAAI/AAAAAAAAAB0/4kqa6zSaTVo/photo.jpg?sz=128", "display_name": "Business Man", "link": "https://stackoverflow.com/users/5548343/business-man"}, "edited": false, "score": 0, "creation_date": 1461179952, "post_id": 36753092, "comment_id": 61086611, "body": "I edited it, it is not disjoint, sorry. I don&#39;t know the logic thats why I ask for help."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1461179997, "post_id": 36753092, "comment_id": 61086646, "body": "Please provide one of: compiling code with an explanation of what part of its behavior you don&#39;t understand, or the error message the compiler gives when provided with the exact code in the post and why you don&#39;t understand the compiler error.  This post doesn&#39;t contain either of those."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1461180046, "post_id": 36753092, "comment_id": 61086679, "body": "OK, if you don&#39;t know the logic then why did you write the last line?  What is it you want to happen at that point?   Think about it some, this line is the core of your problem."}, {"owner": {"reputation": 69, "user_id": 5548343, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-z8cHpXUKKFQ/AAAAAAAAAAI/AAAAAAAAAB0/4kqa6zSaTVo/photo.jpg?sz=128", "display_name": "Business Man", "link": "https://stackoverflow.com/users/5548343/business-man"}, "edited": false, "score": 0, "creation_date": 1461180102, "post_id": 36753092, "comment_id": 61086716, "body": "I don&#39;t know how should I call recursively the funtion to compare each of elements."}, {"owner": {"reputation": 69, "user_id": 5548343, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-z8cHpXUKKFQ/AAAAAAAAAAI/AAAAAAAAAB0/4kqa6zSaTVo/photo.jpg?sz=128", "display_name": "Business Man", "link": "https://stackoverflow.com/users/5548343/business-man"}, "edited": false, "score": 0, "creation_date": 1461180715, "post_id": 36753092, "comment_id": 61087099, "body": "I though it about 3 hours... Any useful help?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1461183393, "post_id": 36753092, "comment_id": 61088840, "body": "for <code>myfunction (x:xs) (y:ys)</code>, either <code>x==y</code>, or <code>x&lt;y</code>, or <code>x&gt;y</code>. If <code>x&lt;y</code>, we know that for all <code>z</code> in <code>ys</code> it is guaranteed to be <code>x&lt;z</code> too."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1461183478, "post_id": 36753092, "comment_id": 61088898, "body": "in which case we need not worry about <code>x</code> anymore -- can just ignore it."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1461189526, "post_id": 36754981, "comment_id": 61092012, "body": "Can we assume that each argument consists of unique values? That doesn&#39;t seem clear in the question."}, {"owner": {"reputation": 574, "user_id": 1504029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96a8e68ffdcc9aca971108c6a989b74c?s=128&d=identicon&r=PG", "display_name": "Paul Visschers", "link": "https://stackoverflow.com/users/1504029/paul-visschers"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1461189945, "post_id": 36754981, "comment_id": 61092178, "body": "@chepner: It should work either way. (Unless I&#39;m missing something.)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1461212139, "post_id": 36754981, "comment_id": 61098206, "body": "I&#39;m probably misinterpreting the problem. It seemed to me the goal was to detect any duplicates between the two arguments."}], "tags": [], "owner": {"reputation": 574, "user_id": 1504029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96a8e68ffdcc9aca971108c6a989b74c?s=128&d=identicon&r=PG", "display_name": "Paul Visschers", "link": "https://stackoverflow.com/users/1504029/paul-visschers"}, "is_accepted": true, "score": 2, "last_activity_date": 1461185775, "last_edit_date": 1461185775, "creation_date": 1461185606, "answer_id": 36754981, "question_id": 36753092, "link": "https://stackoverflow.com/questions/36753092/how-can-i-write-this-recursive-haskell-function/36754981#36754981", "title": "How can I write this recursive Haskell function", "body": "<p>(This answer is really just the comments you already received in answer form.) You'd implement it as follows:</p>\n\n<pre><code>myFunction [] _ = True\nmyFunction _ [] = True\nmyFunction (x : xs) (y : ys) = case compare x y of\n  LT -&gt; myFunction xs (y : ys)\n  EQ -&gt; False\n  GT -&gt; myFunction (x : xs) ys\n</code></pre>\n\n<p>This works because if <code>x</code> is smaller than <code>y</code>, <code>x</code> is also smaller (and therefore not equal, which is what we really wanted to know) than any element in <code>ys</code>. That means we can ignore it and check the rest of the lists. When <code>x</code> is greater than <code>y</code>, it's the other way around.</p>\n"}], "owner": {"reputation": 69, "user_id": 5548343, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-z8cHpXUKKFQ/AAAAAAAAAAI/AAAAAAAAAB0/4kqa6zSaTVo/photo.jpg?sz=128", "display_name": "Business Man", "link": "https://stackoverflow.com/users/5548343/business-man"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 36754981, "answer_count": 1, "score": 1, "last_activity_date": 1461208899, "creation_date": 1461179617, "last_edit_date": 1592644375, "question_id": 36753092, "link": "https://stackoverflow.com/questions/36753092/how-can-i-write-this-recursive-haskell-function", "title": "How can I write this recursive Haskell function", "body": "<p>Task:</p>\n<blockquote>\n<p>Write a recursive Haskell function, which get 2 ordered list and the function decide that each of them element are equal or not (if one of them are same the function value is <code>False</code>).</p>\n<p>For example:</p>\n<ul>\n<li><code>myfunction [1..5] [6..10] == True</code></li>\n<li><code>myfunction [1..5] [5..10] == False</code></li>\n</ul>\n</blockquote>\n<p>I cannot use the <code>elem</code> function.\nI can use recursion and case apart choice.</p>\n<p>Function type:</p>\n<pre><code>myfunction :: Ord a =&gt; [a] -&gt; [a] -&gt; Bool\n</code></pre>\n<p>I tried something like this:</p>\n<pre><code>myfunction :: Ord a =&gt; [a] -&gt; [a] -&gt; Bool\nmyfunction [] list = True\nmyfunction list [] = True\nmyfunction (x:xs) (y:ys)\n    | x == y = False\n    | xs == myfunction ???????? = False\n</code></pre>\n<p>But it does not works...</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1461176463, "post_id": 36751906, "comment_id": 61084465, "body": "Have you heard of the Euclidean algorithm? That will be much better than any technique based on prime factorization."}, {"owner": {"reputation": 1641, "user_id": 1329075, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/34e5fc21fefdb23ecfbf381cf5cce26d?s=128&d=identicon&r=PG", "display_name": "neu-rah", "link": "https://stackoverflow.com/users/1329075/neu-rah"}, "edited": false, "score": 0, "creation_date": 1461176764, "post_id": 36751906, "comment_id": 61084646, "body": "it sounds like multiplication"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1461177018, "post_id": 36751906, "comment_id": 61084788, "body": "the euclidean algorithm <b>is</b> a way to get the gcd - so if you want to do it without (why?) then this is not the way"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1461177165, "post_id": 36751906, "comment_id": 61084880, "body": "if you want you can do the <i>naive</i> algorithm: take the multiples of your numbers (always increase the smaller) till you get to the point where both numbers are equal - this is a simple recursive algorithm you should be able to figure out"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1461189599, "post_id": 36751906, "comment_id": 61092033, "body": "@Carsten, perhaps I misunderstood the intention. I figured they just weren&#39;t allowed to use a pre-existing gcd function. Doing without that seems more a question for math.stackexchange.com than for this site."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1461211017, "post_id": 36751906, "comment_id": 61097916, "body": "@dfeuer the best Haskell/Programming exercises always are ;) ... of course chances are high that I totally got this wrong and you are right ^^"}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 3, "last_activity_date": 1461177384, "creation_date": 1461177384, "answer_id": 36752352, "question_id": 36751906, "link": "https://stackoverflow.com/questions/36751906/least-common-multiple-without-using-gcd/36752352#36752352", "title": "Least common multiple without using gcd", "body": "<p>here is the (very) <em>naive</em> algorithm I was talking about:</p>\n\n<pre><code>kgv :: (Ord a, Num a) =&gt; a -&gt; a -&gt; a\nkgv x y = find x y\n  where find i j\n          | i == j = i\n          | i &lt; j = find (i+x) j\n          | i &gt; j = find i (j+y)\n</code></pre>\n\n<p>it's basically what a school-child would do ;)</p>\n\n<hr>\n\n<p><strong>caution</strong> I ignored negative numbers and 0 - you'll probably have to handle those</p>\n"}, {"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 3, "last_activity_date": 1461178137, "creation_date": 1461178137, "answer_id": 36752586, "question_id": 36751906, "link": "https://stackoverflow.com/questions/36751906/least-common-multiple-without-using-gcd/36752586#36752586", "title": "Least common multiple without using gcd", "body": "<p>perhaps another easy way is</p>\n\n<pre><code>import Data.List(intersect)\nlcm m n = head $ intersect (series m n) (series n m)     \n    where series a b = take a $ map (*b) [1..]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 1, "creation_date": 1461204704, "post_id": 36756091, "comment_id": 61096304, "body": "or, <code>lcm m n = head [x | x &lt;- [n,2*n..], rem x m == 0]</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1461205275, "post_id": 36756091, "comment_id": 61096441, "body": "@karakfa, sure, that&#39;s perfectly valid as well. Since neither of them is remotely close to being efficient, I figured it best to go for the very simplest."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 3, "last_activity_date": 1461190021, "creation_date": 1461190021, "answer_id": 36756091, "question_id": 36751906, "link": "https://stackoverflow.com/questions/36751906/least-common-multiple-without-using-gcd/36756091#36756091", "title": "Least common multiple without using gcd", "body": "<p>Here's an absurdly simple and obscenely inefficient solution:</p>\n\n<pre><code>lcm m n = head [x | x &lt;- [1..], x `rem` m == 0, x `rem` n == 0]\n</code></pre>\n\n<p>Of course, this relies on two different notions of \"least\" coinciding under the circumstances, which they do. A fully naive solution doesn't seem possible.</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 6224002, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b02f66ed6b3bea433f6369ba4c818f14?s=128&d=identicon&r=PG&f=1", "display_name": "HoRnsUp", "link": "https://stackoverflow.com/users/6224002/hornsup"}, "is_accepted": false, "score": 0, "last_activity_date": 1461190889, "creation_date": 1461190889, "answer_id": 36756261, "question_id": 36751906, "link": "https://stackoverflow.com/questions/36751906/least-common-multiple-without-using-gcd/36756261#36756261", "title": "Least common multiple without using gcd", "body": "<p>I figured it out myself mostly. Thanks for the ideas and pointers.</p>\n\n<pre><code>ggt n m   | n &gt; m     = maximum [t | t &lt;- [1 .. m], gt n m t]\n    | otherwise = maximum [t | t &lt;- [1 .. n], gt n m t]\ngt n m c              = t n c  &amp;&amp; t m c\nt n c     | n &gt;= c    = (mod n c == 0)\n    | otherwise = False\n\nkgv :: Int -&gt; Int -&gt; Int\nkgv x y |x==0=0|y==0=0 |otherwise = abs ((x `quot` (ggt x y)) * y)\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 6224002, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b02f66ed6b3bea433f6369ba4c818f14?s=128&d=identicon&r=PG&f=1", "display_name": "HoRnsUp", "link": "https://stackoverflow.com/users/6224002/hornsup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 401, "favorite_count": 0, "accepted_answer_id": 36756091, "answer_count": 4, "score": 1, "last_activity_date": 1461208833, "creation_date": 1461175961, "last_edit_date": 1461208833, "question_id": 36751906, "link": "https://stackoverflow.com/questions/36751906/least-common-multiple-without-using-gcd", "title": "Least common multiple without using gcd", "body": "<p>With gcd its fairly easy but i do not understand how to tie in all the functions to make it happen without.    </p>\n\n<pre><code>kgv :: Int -&gt; Int -&gt; Int\nkgv x y =  abs ((x `quot` (gcd x y)) * y)\n</code></pre>\n\n<p>I got this function to find the prime factors which works (<code>prime_factors</code>) and I am working on making a function that takes the maximum number from one list and checks if its on the other list (<code>comp</code>):</p>\n\n<pre><code>prime_factors :: Int -&gt; [Int]\nprime_factors 1 = []\nprime_factors n\n  | factors == []  = [n]\n  | otherwise = factors ++ prime_factors (n `div` (head factors))\n  where factors = take 1 $ filter (\\x -&gt; (n `mod` x) == 0) [2 .. n-1]\n\n\ncomp :: [Int]-&gt;Int\ncomp (ys)(x:xs)\n |maximum prime_factors xs elem prime_factors ys == x\n |otherwise tail x\n\n\nkgv :: Int -&gt; Int -&gt; Int\nkgv x y =  abs ((x `quot` (comp x y)) * y)\n</code></pre>\n"}, {"tags": ["haskell", "dependent-type", "curry-howard"], "comments": [{"owner": {"reputation": 8263, "user_id": 32878, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e44c79ea155b0bca0a4027d9a38b11d0?s=128&d=identicon&r=PG", "display_name": "Jay Kominek", "link": "https://stackoverflow.com/users/32878/jay-kominek"}, "edited": false, "score": 0, "creation_date": 1461174083, "post_id": 36750996, "comment_id": 61082989, "body": "you might be interested in looking at Djinn, discussed in <a href=\"http://stackoverflow.com/a/10205941/32878\">stackoverflow.com/a/10205941/32878</a> which generates programs from a limited set of types. as for your question, i think you&#39;d need a model of what&#39;s hard for humans to do, as well as some automated prover that could check that there aren&#39;t easier alternatives to the intended answer."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 3, "creation_date": 1461174885, "post_id": 36750996, "comment_id": 61083477, "body": "Is &quot;15 is a semiprime&quot; (a product of two primes) a theorem? I would say yes. The security of RSA is based on the ability to generate arbitrarily hard theorems of that form."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1461175183, "post_id": 36750996, "comment_id": 61083652, "body": "Interesting paper that may give you some ideas is: <a href=\"https://www.mpi-sws.org/~dreyer/tor/papers/wadler.pdf\" rel=\"nofollow noreferrer\">Theorems for free</a>."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1461175445, "post_id": 36750996, "comment_id": 61083820, "body": "You might want to look into the Coq language. The basics are ultimately not <i>that</i> different from Haskell and it is a dependently typed functional programming language designed for theorem proving. The free book <a href=\"https://www.cis.upenn.edu/~bcpierce/sf/current/index.html\" rel=\"nofollow noreferrer\">Software Foundations</a> is a nice introduction to it. It has a pretty extensive standard library of proofs and lemmas about various things and there are many existing proofs written in it, including a proof of the four color theorem."}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 3, "last_activity_date": 1461184882, "creation_date": 1461184882, "answer_id": 36754752, "question_id": 36750996, "link": "https://stackoverflow.com/questions/36750996/is-it-possible-to-randomly-generate-theorems-that-are-arbitrarily-difficult-to-p/36754752#36754752", "title": "Is it possible to randomly generate theorems that are arbitrarily difficult to prove?", "body": "<p>A one-way function is a function that can be calculated in polynomial time, but that does not have a right inverse that can be calculated in polynomial time. If <code>f</code> is a one-way function, then you can choose an argument <code>x</code> whose size is determined by the difficulty setting, calculate <code>y = f x</code>, and ask the user to prove, constructively, that <code>y</code> is in the image of <code>f</code>.</p>\n\n<p>This is not terribly simple. No one knows whether there are any one-way functions. Most people believe there are, but proving that, if true, is known to be at least as hard as proving <code>P /= NP</code>. However, there is a ray of light! People have managed to construct functions with the strange property that if <em>any</em> functions are one-way, then these must be. So you could choose such a function and be pretty confident you'll be offering sufficiently hard problems. Unfortunately, I believe all known universal one-way functions are pretty nasty. So you will likely find it hard to code them, and your users will likely find even the easiest proofs too difficult. So from a practical standpoint, you might be better off choosing something like a cryptographic hash function that's not as thoroughly likely to be truly one-way but that's sure to be hard for a human to crack.</p>\n"}, {"tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": false, "score": 1, "last_activity_date": 1461233505, "last_edit_date": 1461233505, "creation_date": 1461221867, "answer_id": 36761928, "question_id": 36750996, "link": "https://stackoverflow.com/questions/36750996/is-it-possible-to-randomly-generate-theorems-that-are-arbitrarily-difficult-to-p/36761928#36761928", "title": "Is it possible to randomly generate theorems that are arbitrarily difficult to prove?", "body": "<p>If you generate just types, most of them will be isomorphic to <code>\u22a5</code>. <code>\u2200 n m -&gt; n + m \u2261 m + n</code> is meaningful, but <code>\u2200 n m -&gt; n + m \u2261 n</code>, <code>\u2200 n m -&gt; n + m \u2261 suc m</code>, <code>\u2200 n m -&gt; n + m \u2261 0</code>, <code>\u2200 n m xs -&gt; n + m \u2261 length xs</code> and zillions of others are not. You can try to generate well-typed terms and then check, using something like Djinn, that the type of a generated term is not inhabited by a much simpler term. However many generated terms will be either too simple or just senseless garbage even with a <a href=\"http://okmij.org/ftp/Haskell/AlgorithmsH1.html#random-term\" rel=\"nofollow\">clever strategy</a>. Typed setting contains less terms than non-typed, but a type of just one variable can be <code>A</code>, <code>A -&gt; A</code>, <code>A -&gt; B</code>, <code>B -&gt; A</code>, <code>A -&gt; ... -&gt; E</code> and all these type variables can be free or universally quantified. Besides, <code>\u2200 A B -&gt; A -&gt; B -&gt; B</code> and <code>\u2200 B A -&gt; A -&gt; B -&gt; B</code> are essentially the same types, so your equality is not just \u03b1\u03b7, but something more complex. The search space is just too big and I doubt a random generator can produce something really non-trivial.</p>\n\n<p>But maybe terms of some specific form can be interesting. <strong>Bakuriu</strong> in comments suggested theorems provided by parametricity: you can simply take <code>Data.List.Base</code> or <code>Function</code> or any other basic module from Agda standard library and generate many theorems out of thin air. Check also the <a href=\"http://www.cse.chalmers.se/~mouling/share/AComputationalInterpretationOfParametricity.pdf\" rel=\"nofollow\">A computational interpretation of parametricity</a> paper which gives an algorithm for deriving theorems from types in a dependently typed setting (though, I don't know how it's related to <a href=\"https://www.mpi-sws.org/~dreyer/tor/papers/wadler.pdf\" rel=\"nofollow\">Theorems for free</a> and they don't give the rules for data types). But I'm not sure that most produced theorems won't be provable by straightforward induction. Though, theorems about functions that are instances of left folds are usually harder than about those which are instances of right folds \u2014 that can be one criteria.</p>\n"}, {"tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": false, "score": 1, "last_activity_date": 1461256350, "creation_date": 1461256350, "answer_id": 36775616, "question_id": 36750996, "link": "https://stackoverflow.com/questions/36750996/is-it-possible-to-randomly-generate-theorems-that-are-arbitrarily-difficult-to-p/36775616#36775616", "title": "Is it possible to randomly generate theorems that are arbitrarily difficult to prove?", "body": "<p>This falls into an interesting and difficult field of proving lower bounds in proof complexity. First, it very much depends on the strenght of the logic system you're using, and what proofs it allows. A proposition can be hard to prove in one system and easy to prove in another.</p>\n\n<p>Next problem is that for a random proposition (in a reasonably strong logic system) it's even impossible to decide if it's provable or not (for example the set of provable propositions in first-order logic is only <a href=\"https://en.wikipedia.org/wiki/Recursively_enumerable_set?oldid=654867810\" rel=\"nofollow\">recursively enumerable</a>). And even if we know it's provable, deciding its proof complexity can be extremely hard or undecidable (if you find a proof, it doesn't mean it's the shortest one).</p>\n\n<p>Intuitively it seems similar to <a href=\"https://en.wikipedia.org/wiki/Kolmogorov_complexity\" rel=\"nofollow\">Kolmogorov complexity</a>: For a general string we can't tell what's the shortest program that produces it.</p>\n\n<p>For some proof systems and specific types of formulas there are known lower bounds. Haken proved in 1989:</p>\n\n<blockquote>\n  <p>For a sufficiently large <em>n</em>, any Resolution proof of <em>PHP^n</em>{n-1}_ (Pigeon hole principle) requires length 2^{\\Omega(n)}.</p>\n</blockquote>\n\n<p><a href=\"http://www.ti.inf.ethz.ch/ew/lehre/extremal04/raemy.pdf\" rel=\"nofollow\">These slides</a> give an overview of the theorem. So you could generate propositions using such a schema, but that'd probably won't be very interesting for a game.</p>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 1, "answer_count": 3, "score": 6, "last_activity_date": 1461256350, "creation_date": 1461173210, "question_id": 36750996, "link": "https://stackoverflow.com/questions/36750996/is-it-possible-to-randomly-generate-theorems-that-are-arbitrarily-difficult-to-p", "title": "Is it possible to randomly generate theorems that are arbitrarily difficult to prove?", "body": "<p>If I understand Curry-Howard's isomorphism correctly, every dependent type correspond to a theorem, for which a program implementing it is a proof. That means that any mathematical problem, such as <code>a^n + b^n = c^n</code> can be, somehow, expressed as a type.</p>\n\n<p>Now, suppose I want to design a game which generates random types (theorems), and on which plays must try to implement programs (proofs) of those types (theorems). Is it possible to have control over the difficulty of those theorems? I.e., an easy mode would generate trivial theorems while a hard mode would generate much harder theorems.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "edited": false, "score": 2, "creation_date": 1461162115, "post_id": 36746690, "comment_id": 61074577, "body": "It would help to pattern match the two leading elements of the list with <code>compress (x1:x2:xs)</code> and then check if they are equal. If they are, then you can create the new list without <code>x2</code>."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 6224002, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b02f66ed6b3bea433f6369ba4c818f14?s=128&d=identicon&r=PG&f=1", "display_name": "HoRnsUp", "link": "https://stackoverflow.com/users/6224002/hornsup"}, "edited": false, "score": 0, "creation_date": 1461163346, "post_id": 36746841, "comment_id": 61075551, "body": "got a parse error and figured that i have to put the constructors in &quot;()&quot; works great thank you."}], "tags": [], "owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "is_accepted": true, "score": 6, "last_activity_date": 1461167469, "last_edit_date": 1461167469, "creation_date": 1461162206, "answer_id": 36746841, "question_id": 36746690, "link": "https://stackoverflow.com/questions/36746690/removing-direct-duplicates-on-a-list/36746841#36746841", "title": "removing direct duplicates on a list", "body": "<p>Right now you are checking if x has a duplicate in the rest of the function. You actually want to check if the next element is a duplicate. You can do this by looking at the first two elements of a list not just the first one.</p>\n\n<pre><code>compress :: [Int] -&gt; [Int]\ncompress [] = []\ncompress [x] = [x]\ncompress (x:x2:xs) | x == x2   = compress (x2:xs)\n                   | otherwise = x : compress (x2:xs)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1461173583, "post_id": 36750552, "comment_id": 61082669, "body": "I got a kick out of figuring this one out. Thanks for the fun! :)"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1461171837, "creation_date": 1461171837, "answer_id": 36750552, "question_id": 36746690, "link": "https://stackoverflow.com/questions/36746690/removing-direct-duplicates-on-a-list/36750552#36750552", "title": "removing direct duplicates on a list", "body": "<p>I've been getting a lot of bang from this little fold technique lately:</p>\n\n<pre><code>smash :: Eq a =&gt; [a] -&gt; [a]\nsmash xs = foldr go (`seq` []) xs Nothing\n  where\n    go x r (Just prev)\n      | x == prev = r (Just x)\n    go x r _ = x : r (Just x)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 4, "last_activity_date": 1461175937, "creation_date": 1461175937, "answer_id": 36751896, "question_id": 36746690, "link": "https://stackoverflow.com/questions/36746690/removing-direct-duplicates-on-a-list/36751896#36751896", "title": "removing direct duplicates on a list", "body": "<p>The <code>group</code> function finds adjacent equal values and groups them together. So your function may be implemented as</p>\n\n<pre><code>compress = map head . group\n</code></pre>\n\n<p>At first, it may look dangerous to use <code>head</code>; however, a promise of <code>group</code> is that each element it returns is a non-empty list.</p>\n"}], "owner": {"reputation": 51, "user_id": 6224002, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b02f66ed6b3bea433f6369ba4c818f14?s=128&d=identicon&r=PG&f=1", "display_name": "HoRnsUp", "link": "https://stackoverflow.com/users/6224002/hornsup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 424, "favorite_count": 0, "accepted_answer_id": 36746841, "answer_count": 3, "score": 1, "last_activity_date": 1461175937, "creation_date": 1461161892, "question_id": 36746690, "link": "https://stackoverflow.com/questions/36746690/removing-direct-duplicates-on-a-list", "title": "removing direct duplicates on a list", "body": "<p>So i am supposed to remove direct duplicates that are next to each other from a list. For example 1,3,3,3,2,4,4,2,4] = [1,3,2,4,2,4] or [63,65,65,64,65,63,65,65,64,64,65] = [63,65,64,65,63,65,64,65]. My code just removes all duplicates. I think my problem is that i compare with elem and i need a function that only compares with the next element.</p>\n\n<pre><code>module Blueprint where\nimport Prelude\n\ncompress :: [Int] -&gt; [Int]\ncompress [] = []\ncompress (x:xs)   | x `elem` xs   = compress xs\n                  | otherwise     = x : compress xs\n</code></pre>\n"}, {"tags": ["haskell", "error-handling", "monads"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461161024, "post_id": 36746135, "comment_id": 61073576, "body": "I can remember your question from earlier but I have trouble seen how your parts are related there - (for example you don&#39;t seem to use <code>foo</code> in <code>f</code>) - can you please produce a working example (obviously it may have compile errors - but it should be complete in the sense that things like <code>...</code> are not present) and the error your get?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1461161256, "post_id": 36746135, "comment_id": 61073812, "body": "btw: this time you probably want to wrap <code>ef</code> into <code>ErrorT</code> (<code>vl &lt;- lift $ lift $ ErrorT $ ef i s</code>"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1461161445, "post_id": 36746135, "comment_id": 61073953, "body": "&quot;ef can call throwError. Also it can return (Value, String).&quot;. No. And No. Please review the description, because it&#39;s hard to follow otherwise"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1461167775, "post_id": 36746135, "comment_id": 61079113, "body": "What is the trailing <code>()</code> in your return value for <code>f</code>? <code>StateT</code> only takes two types, the state type (<code>Integer</code>) and the underlying monad <code>(ReaderT Integer (ErrorT String IO))</code>."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1461169529, "post_id": 36746135, "comment_id": 61080283, "body": "The semantics you are describing are precisely that of <code>&gt;&gt;=</code>. Monadic bind in the <code>ErrorT</code> monad propagates the error if it occurs, or allows you to access the value that was produced by the computation otherwise. It seems like you already have everything you need - just use the result <code>vl</code> after the line <code>vl &lt;- lift $ lift $ lift $ ef i s</code>."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "edited": false, "score": 0, "creation_date": 1461197276, "post_id": 36746649, "comment_id": 61094458, "body": "Thanks for your answer. Don&#39;t think about my problem. Is there no other solution ? Maybe applicative ? I would like to be able propagate error if it happened before, could you explain this issue. I ask for it, becaue I am aware that my first post was unclear. It is why I would like to your personally  answer - to be more precisely - handling error (propagation also!) with my monad. Could you edit your answer, please ?"}], "tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": false, "score": 2, "last_activity_date": 1461162551, "last_edit_date": 1461162551, "creation_date": 1461161800, "answer_id": 36746649, "question_id": 36746135, "link": "https://stackoverflow.com/questions/36746135/using-errort-transformer-monad-in-do-section/36746649#36746649", "title": "using ErrorT transformer monad in do section", "body": "<p>The function:</p>\n\n<pre><code>ef :: Int -&gt; String -&gt;  IO (Either String (Value, Integer))\n</code></pre>\n\n<p>Can only <code>throwError</code> an <code>IOException</code>:</p>\n\n<pre><code>instance MonadError IOException IO where\n    throwError = ioError\n    catchError = catch\n</code></pre>\n\n<p>Otherwise, it's just an <code>IO</code> function returning <code>Either String (Value, Integer)</code>.</p>\n\n<p>Given that function, to act on its value you need to execute it in an <code>IO</code>-capable context, and then simply use the resulting value:</p>\n\n<pre><code>callEf :: IO ()\ncallEf = do\n    result &lt;- ef ...\n    case result of\n        Left s -&gt;         -- do something with the String\n        Right (v, i) -&gt;   -- do something with the tuple\n\n    return ()\n    -- ^ you can also obviously produce the value above,\n    -- if you want something more complicated than ()\n</code></pre>\n\n<p>This doesn't change if you're in a monad stack. In your function <code>f</code>, calling <code>lift</code> three times give you an <code>IO</code> context. After that, you can do whatever you want with the resulting value, including any operation from the stack, like <code>throwError</code> (after two lifts) or <code>put</code> (with no lifts).</p>\n\n<p>Alternatively, refer to my answer to your previous question to get rid of the <code>lift</code>s.</p>\n\n<p>If you want the error propagation to happen automatically from <code>Either</code> to <code>ErrorT</code>, it would be reasonably simple, just like above:</p>\n\n<pre><code>eitherToError :: Either e v -&gt; ErrorT e m v\neitherToError f = case f of\n    Left err -&gt; throwError err\n    Right val -&gt; return val\n</code></pre>\n\n<p>Which you can <a href=\"http://hayoo.fh-wedel.de/?query=Either+e+v+-%3E+ErrorT+e+m+v\" rel=\"nofollow\">easily search for in Hayoo</a>, resulting <a href=\"https://hackage.haskell.org/package/GenI-0.24.3/docs/src/NLP-GenI-ErrorIO.html#liftEither\" rel=\"nofollow\">in a very similar implementation</a> in some library.</p>\n\n<hr>\n\n<p>All that being said, it seems that <code>ErrorT</code> is deprecated in favor of <code>Control.Monad.Trans.Except</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 31, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1461162551, "creation_date": 1461160638, "last_edit_date": 1461161304, "question_id": 36746135, "link": "https://stackoverflow.com/questions/36746135/using-errort-transformer-monad-in-do-section", "title": "using ErrorT transformer monad in do section", "body": "<p>I would like to understand how to deal with stack of transformators in do section.  It is also about error handling. </p>\n\n<p>Namely, I will show you my problem in my case.<br>\nI have some funcion:   </p>\n\n<pre><code>foo :: Int -&gt; String -&gt; IO (Either String (Value, Integer))\n</code></pre>\n\n<p>Body of <code>foo</code> is not important here.  </p>\n\n<pre><code>ef :: evalExpr :: Int -&gt; String -&gt;  IO (Either String (Value, Integer))\n</code></pre>\n\n<p>Now,  </p>\n\n<pre><code>f :: Integer -&gt; String -&gt; StateT Integer (ReaderT Integer (ErrorT String IO)) ()\nf i s = do\n  vl &lt;- lift $ lift $ lift $ ef i s\n  ....\n  return ()\n</code></pre>\n\n<p><code>ef</code> can call throwError. Also it can return <code>(Value, String)</code>.<br>\nI would like to be able (<code>....</code>)  do something with Right value (so <code>(Value, String)</code>).  However, I can't do it. It is my permanent problem.</p>\n\n<p>Idea is following:<br>\nWhen <code>ef</code> called <code>throwError</code> then  <code>foo</code> should propagate the same error (so <code>Left String</code>). Neverhteless, when <code>ef</code> return <code>Right Value (so (Value, String))</code> I would like to use it and on this base make decision what should return <code>foo</code> - <code>throwError</code> or <code>(Value, ())</code></p>\n\n<p>I know about <code>fmap</code> and <code>&lt;*&gt;</code>.\nCan you help me, please ?  </p>\n"}, {"tags": ["string", "list", "haskell"], "comments": [{"owner": {"reputation": 23557, "user_id": 12266, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6a2a454191fa75d4114ed05836a0b924?s=128&d=identicon&r=PG", "display_name": "Andrew Jaffe", "link": "https://stackoverflow.com/users/12266/andrew-jaffe"}, "edited": false, "score": 0, "creation_date": 1461155157, "post_id": 36743679, "comment_id": 61068687, "body": "Will there be any delimiters between grades in the string? (It&#39;s a well-posed problem even without that, but it&#39;s easier that way...)"}, {"owner": {"reputation": 601, "user_id": 6005857, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/10940e23bda8cf7bbc35957025ef3348?s=128&d=identicon&r=PG&f=1", "display_name": "user6005857", "link": "https://stackoverflow.com/users/6005857/user6005857"}, "reply_to_user": {"reputation": 23557, "user_id": 12266, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/6a2a454191fa75d4114ed05836a0b924?s=128&d=identicon&r=PG", "display_name": "Andrew Jaffe", "link": "https://stackoverflow.com/users/12266/andrew-jaffe"}, "edited": false, "score": 0, "creation_date": 1461155225, "post_id": 36743679, "comment_id": 61068733, "body": "Oh, I will edit the question. It looks like this <code>&quot;A+FABA+B-A&quot;</code>"}, {"owner": {"reputation": 601, "user_id": 6005857, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/10940e23bda8cf7bbc35957025ef3348?s=128&d=identicon&r=PG&f=1", "display_name": "user6005857", "link": "https://stackoverflow.com/users/6005857/user6005857"}, "edited": false, "score": 0, "creation_date": 1461155594, "post_id": 36743679, "comment_id": 61069011, "body": "I actually don&#39;t want it to be split by alphabetical characters because I want this to work for data structures that have the same type."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461155604, "post_id": 36743679, "comment_id": 61069017, "body": "is it only me - you are basically there if you say <code>| x == &#39;A&#39; &amp;&amp; y == &#39;+&#39; -&gt; A+ : extractGrades ys</code> following with  <code>| x == &#39;A&#39; -&gt; A : extractGrades (y:ys)</code> and so on - yes you have to type it all in but hey it&#39;s supposed to be working not looking neat for iteration 0 right?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461155704, "post_id": 36743679, "comment_id": 61069107, "body": "the only problem you seem to have is that you don&#39;t understand the differences between <code>Char</code> and <code>[Char] = String</code> and <code>:</code> vs <code>++</code> - you will also need a final case with just one character left"}, {"owner": {"reputation": 601, "user_id": 6005857, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/10940e23bda8cf7bbc35957025ef3348?s=128&d=identicon&r=PG&f=1", "display_name": "user6005857", "link": "https://stackoverflow.com/users/6005857/user6005857"}, "reply_to_user": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1461156288, "post_id": 36743679, "comment_id": 61069524, "body": "@zakyggaps I made a new update and added a Pass grade. I am ok with separating the list by alphabetical characters."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1461157022, "post_id": 36743679, "comment_id": 61070133, "body": "Minor point: in Haskell <code>A+</code> is not a valid constructor name, I&#39;d recommend <code>Ap</code> instead."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1461158544, "post_id": 36743679, "comment_id": 61071419, "body": "@chi this point is fluctuating ;)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1461176140, "post_id": 36743679, "comment_id": 61084257, "body": "You (or others who find this question close to their own) may also like <a href=\"http://stackoverflow.com/q/34356668/791604\">this question about creating a parsec parser that chooses among many strings that may share prefixes</a>."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1461157183, "creation_date": 1461157183, "answer_id": 36744605, "question_id": 36743679, "link": "https://stackoverflow.com/questions/36743679/convert-a-string-to-a-list-of-grades/36744605#36744605", "title": "Convert a string to a list of &quot;grades&quot;", "body": "<p>We can apply pattern matching so to match a string prefix. Here's an example:</p>\n\n<pre><code>foo :: String -&gt; [Int]\nfoo [] = []\nfoo ('h':'e':'l':'l':'o':rest) = 1 : foo rest\nfoo ('b':'o':'b':rest) = 2 : foo rest\nfoo ('b':rest) = 3 : foo rest\nfoo _ = error \"foo: invalid input syntax\"\n</code></pre>\n\n<p>Sample usage:</p>\n\n<pre><code>foo \"hellobbobbobhello\" ==&gt; [1,3,2,2,1]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 0, "last_activity_date": 1461158394, "creation_date": 1461158394, "answer_id": 36745154, "question_id": 36743679, "link": "https://stackoverflow.com/questions/36743679/convert-a-string-to-a-list-of-grades/36745154#36745154", "title": "Convert a string to a list of &quot;grades&quot;", "body": "<p>You can split the string into tokens using combination of split functions.</p>\n\n<pre><code>split (keepDelimsR $ oneOf \"+-\") \"PA+FABA+B-A\"\n</code></pre>\n\n<p>will create this form, where the suffixes are attached.</p>\n\n<pre><code>[\"PA+\",\"FABA+\",\"B-\",\"A\"]\n</code></pre>\n\n<p>Now, you can split this further with a custom splitter</p>\n\n<pre><code>splitInit [] = []\nsplitInit [x] = [[x]]\nsplitInit [x,y] = [[x,y]]\nsplitInit (x:xs) = [x] : splitInit xs\n</code></pre>\n\n<p>a combination will give you</p>\n\n<pre><code>concatMap splitInit $ split (keepDelimsR $ oneOf \"+-\") \"PA+FABA+B-A\"\n[\"P\",\"A+\",\"F\",\"A\",\"B\",\"A+\",\"B-\",\"A\"]\n</code></pre>\n\n<p>where you can map through your constructors</p>\n"}], "owner": {"reputation": 601, "user_id": 6005857, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/10940e23bda8cf7bbc35957025ef3348?s=128&d=identicon&r=PG&f=1", "display_name": "user6005857", "link": "https://stackoverflow.com/users/6005857/user6005857"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "accepted_answer_id": 36744605, "answer_count": 2, "score": 1, "last_activity_date": 1461158394, "creation_date": 1461154941, "last_edit_date": 1461156715, "question_id": 36743679, "link": "https://stackoverflow.com/questions/36743679/convert-a-string-to-a-list-of-grades", "title": "Convert a string to a list of &quot;grades&quot;", "body": "<p>I want to make a function that takes in a string of multiple \"grades\" of varying length and convert it to a list of grades.</p>\n\n<p>Grade is just a data structure that looks like this (just an arbitrary grading system):</p>\n\n<pre><code>data Grade = A+ | A | A- | B+ | B | B- | P | F\n    deriving (Show, Eq)\n</code></pre>\n\n<p>As you can see, the grades have varying length. If they had length 1 or consistent length, this would have been much easier.</p>\n\n<p>Here is the function that I want to make:</p>\n\n<p>This is what the string input looks like <code>\"PA+FABA+B-A\"</code></p>\n\n<pre><code>stringToGrade :: String -&gt; Grade\nstringToGrade stringGrade\n  | stringGrade == \"A+\" = A+\n  | stringGrade == \"A\" = A\n  -- and so on\n\nextractGrades :: String -&gt; [Grade]\nextractGrades stringGrades = case stringGrades of\n  [] -&gt; []\n  x:y:ys\n    | x == \"A\" &amp;&amp; y == \"+\" -&gt; [stringToGrade (x : y)] : extractGrades ys\n    | x == \"A\" -&gt; [stringToGrade x] : extractGrades y:ys\n    -- and so on\n</code></pre>\n\n<p>As you can see, this is not going anywhere.</p>\n\n<p>Is there an elegant and easy way I cam do this instead of had coding everything?</p>\n"}, {"tags": ["haskell", "mqtt", "mosquitto"], "answers": [{"comments": [{"owner": {"reputation": 1326, "user_id": 445023, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/RsFNp.jpg?s=128&g=1", "display_name": "carlosayam", "link": "https://stackoverflow.com/users/445023/carlosayam"}, "edited": false, "score": 0, "creation_date": 1461274156, "post_id": 36763513, "comment_id": 61137967, "body": "Yes, adding <code>cReconnPeriod = Just 1</code> fixes it! I need to read about <code>TChan</code> but simple approach above works with fix given. Tnx."}], "tags": [], "owner": {"reputation": 11549, "user_id": 244473, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0d1cd517cd22ec9ce1fb5f7d8653387b?s=128&d=identicon&r=PG", "display_name": "gpampara", "link": "https://stackoverflow.com/users/244473/gpampara"}, "is_accepted": true, "score": 1, "last_activity_date": 1461226059, "creation_date": 1461226059, "answer_id": 36763513, "question_id": 36743322, "link": "https://stackoverflow.com/questions/36743322/basic-mqtt-with-haskell/36763513#36763513", "title": "basic mqtt with haskell", "body": "<p>I believe that you might have it misconfigured. I'm currently using <code>mqtt-hs</code> in production and have almost no issues with it (barring a bug that has already been corrected in the project's github). The new update uses a <code>TChan</code> to have the messages delivered correctly as in a persistent connection, there is a chance the that some messages may be lost as the handler has not yet been made available.</p>\n\n<p>You define the connection to the broker, but you don't tell the client about how the reconnections should be handled. For reference, I'm using something like the following at the moment:</p>\n\n<pre><code>mqttConfig :: HostName -&gt; MQTTConfig\nmqttConfig host = defaultConfig { cClean = False\n                                , cClientID = \"myClientId\"\n                                , cHost = host\n                                , cUsername = Just \"username\"\n                                , cPassword = Just \"password\"\n                                , cKeepAlive = Just 10\n                                , cReconnPeriod = Just 1\n                                , cLogger = stdLogger }\n</code></pre>\n\n<p>Even though the version in use here is slightly updated, very little needed to change and reconnctions happen as needed when the broker (mosquitto as well here) goes down and then later recovers.</p>\n"}], "owner": {"reputation": 1326, "user_id": 445023, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/RsFNp.jpg?s=128&g=1", "display_name": "carlosayam", "link": "https://stackoverflow.com/users/445023/carlosayam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 435, "favorite_count": 0, "accepted_answer_id": 36763513, "answer_count": 1, "score": 2, "last_activity_date": 1461226059, "creation_date": 1461154116, "last_edit_date": 1461218582, "question_id": 36743322, "link": "https://stackoverflow.com/questions/36743322/basic-mqtt-with-haskell", "title": "basic mqtt with haskell", "body": "<p>I moved mqtt-hs to LTS-5.13 and compiled just fine with <em>stack</em>. Then I created the following subscriber to listen on a topic hierarchy. This is the subscriber code</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nmodule Main(main) where\n\nimport Control.Concurrent (threadWaitRead)\nimport System.Posix.Types\nimport Network.MQTT\nimport Network.MQTT.Logger\n\nmain :: IO ()\nmain = do\n  conn &lt;- connect defaultConfig { cLogger = warnings stdLogger, cHost = \"192.168.0.1\" }\n  qos &lt;- subscribe conn Confirm \"/something\" callback\n  putStrLn \"control-c to finish\"\n  threadWaitRead $ Fd 1\n\ncallback topic payload = putStrLn $ \"A message was published to \" ++ show topic ++ \": \" ++ show payload\n</code></pre>\n\n<p>When I send something to the topic (using a simple Haskell publisher too), I am getting this in the console of this program:</p>\n\n<pre><code>control-c to finish\n[Error] {handle: &lt;socket: 3&gt;}: recvLoop: end of file\n[Error] recvLoop: No reconnect, terminating.\n</code></pre>\n\n<p>but no other output.</p>\n\n<p>Both publisher and subscriber connect to a broker (Mosquitto). The subscriber seems to be Ok, the above happens only when receiving the message from the publisher. The above message also occurs when I stop the broker.</p>\n\n<p>Any ideas?</p>\n\n<p><strong>Update</strong></p>\n\n<p>I cloned most recent mqtt-hs (0.3.0) and introduced this change</p>\n\n<pre><code>--- a/Network/MQTT.hs\n+++ b/Network/MQTT.hs\n@@ -448,9 +448,10 @@ recvLoop :: MQTT -&gt; IO ()\n recvLoop m = loopWithReconnect m \"recvLoop\" $ \\mqtt -&gt; do\n     h &lt;- readMVar (handle mqtt)\n     eof &lt;- hIsEOF h\n-    if eof\n-      then ioError $ mkIOError eofErrorType \"\" (Just h) Nothing\n-      else getMessage mqtt &gt;&gt;= dispatchMessage mqtt\n+    getMessage mqtt &gt;&gt;= dispatchMessage mqtt\n+    -- if eof\n+    --   then ioError $ mkIOError eofErrorType \"\" (Just h) Nothing\n+    --   else getMessage mqtt &gt;&gt;= dispatchMessage mqtt\n   `catch`\n     \\e -&gt; logWarning mqtt $ \"recvLoop: Caught \" ++ show (e :: MQTTException)\n</code></pre>\n\n<p>i.e, I disabled the EOF checking. Now the message is printed to the console, but the subscriber enters into a loop throwing <code>[Warning] recvLoop: Caught EOF</code> as fast as it can.</p>\n\n<p>Is this a <em>mosquito</em> error or bug in mqtt-hs?</p>\n\n<p><strong>Update 2</strong></p>\n\n<p>I can confirm it works with ActiveMQ without the hack. Having said this, it is better if mqtt-hs could recover from broker closing connection to a subscriber.</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 3609, "user_id": 2565354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/590ed3229d95cdcaa05a96028c586165?s=128&d=identicon&r=PG", "display_name": "badcook", "link": "https://stackoverflow.com/users/2565354/badcook"}, "edited": false, "score": 0, "creation_date": 1461163151, "post_id": 36742236, "comment_id": 61075388, "body": "In general if you ever want to add more &quot;context&quot; than <code>map</code> will allow you, consider using either a fold or explicit recursion to traverse your data structure."}], "answers": [{"comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 2, "creation_date": 1461153417, "post_id": 36742378, "comment_id": 61067367, "body": "You only need <code>Applicative m</code> to write <code>mapM</code> (aka <code>traverse</code>). <code>traverse f (x:xs) = (:) &lt;$&gt; f x &lt;*&gt; traverse f xs</code>"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1461155343, "post_id": 36742378, "comment_id": 61068822, "body": "@BenjaminHodgson told you it&#39;s <i>basic</i> - IMO it&#39;s a bit problematic to tell someone about <code>Traversable</code> if they struggle with monads (and I think most can handle <code>do</code> notations as they look familiar-imperative) - but why don&#39;t you add this as a nice answer?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1556779775, "post_id": 36742378, "comment_id": 98546666, "body": "we could have Monadic do... Applicative do... Functorial do! or in the other direction, <a href=\"https://stackoverflow.com/a/53829742/849891\">LiftF... LiftA2... liftBind</a>. and yes, I think <code>do</code> notation could be the gateway drug to monads, and should even be presented much earlier than <code>&gt;&gt;=</code> or even the name &quot;monad&quot; is mentioned. Come to think of it, teaching Haskell should start with <code>main = do { putStrLn &quot;Hello, World!&quot;; return () }</code>!"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 3, "last_activity_date": 1556778487, "last_edit_date": 1556778487, "creation_date": 1461151614, "answer_id": 36742378, "question_id": 36742236, "link": "https://stackoverflow.com/questions/36742236/implement-mapm-without-using-sequence/36742378#36742378", "title": "Implement mapM without using sequence", "body": "<p>Well I don't know how to do this without too much spoiler -- so here you go with a very basic / recursive definition:</p>\n\n<pre><code>moppy :: Monad m =&gt; [a] -&gt; (a -&gt; m b) -&gt; m [b]\nmoppy [] _ = return []\nmoppy (x:xs) f = do\n  y  &lt;- f x\n  ys &lt;- moppy xs f\n  return (y:ys)\n</code></pre>\n\n<p>It should be rather self-explanatory -- please note that you need the <code>Monad m</code> constraint (I think you want it anyway, as it gets rather impossible without it ;) )</p>\n"}, {"tags": [], "owner": {"reputation": 66, "user_id": 6228937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c011d81846af89f254a8147133eb998f?s=128&d=identicon&r=PG&f=1", "display_name": "Jasper", "link": "https://stackoverflow.com/users/6228937/jasper"}, "is_accepted": false, "score": 2, "last_activity_date": 1461163280, "creation_date": 1461163280, "answer_id": 36747318, "question_id": 36742236, "link": "https://stackoverflow.com/questions/36742236/implement-mapm-without-using-sequence/36747318#36747318", "title": "Implement mapM without using sequence", "body": "<p>Maybe it helps when you start with implementing <code>mapM</code> with just <code>&gt;&gt;=</code> and <code>return</code>. You would end up with something similar to:</p>\n\n<pre><code>mapM' :: Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]\nmapM' _ []     = return []\nmapM' f (x:xs) =        f x           &gt;&gt;=\n                 \\y  -&gt; mapM' f xs    &gt;&gt;=\n                 \\ys -&gt; return (y:ys)\n</code></pre>\n\n<p>This kind of gives you the answer as the previous poster mentioned. All you need to do is change the order of arguments:</p>\n\n<pre><code>moppy :: (Misty m) =&gt; [a] -&gt; (a -&gt; m b) -&gt; m [b]      \nmoppy []     _ = unicorn []\nmoppy (x:xs) f = banana (\\y -&gt; banana (\\ys -&gt; unicorn (y:ys)) (moppy xs f)) (f x)\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>moppy :: (Misty m) =&gt; [a] -&gt; (a -&gt; m b) -&gt; m [b]      \nmoppy []     _ = unicorn []\nmoppy (x:xs) f = (\\y  -&gt; (\\ys -&gt; unicorn (y:ys)) `banana` moppy xs f) `banana` f x\n</code></pre>\n\n<p>Or:</p>\n\n<pre><code>moppy :: (Misty m) =&gt; [a] -&gt; (a -&gt; m b) -&gt; m [b]      \nmoppy []     _ = unicorn []\nmoppy (x:xs) f = let g y = let h ys = unicorn (y : ys)\n                            in h `banana` moppy xs f\n                  in g `banana` f x \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1461176082, "post_id": 36748280, "comment_id": 61084222, "body": "For true inscrutability, <code>myMapM = (`foldr` pure []) . (((&lt;*&gt;) . fmap (:)) .)</code>"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 3, "creation_date": 1556777618, "post_id": 36748280, "comment_id": 98545810, "body": "i.e. <code>liftA2 (:) . f</code> in the <code>foldr</code>, to get a one-liner, and to avoid the scare brackets. :)"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 11, "last_activity_date": 1461165504, "creation_date": 1461165504, "answer_id": 36748280, "question_id": 36742236, "link": "https://stackoverflow.com/questions/36742236/implement-mapm-without-using-sequence/36748280#36748280", "title": "Implement mapM without using sequence", "body": "<p>In the modern era, as Benjamin Hodgson mentioned, we should be using <code>Applicative</code> for this particular purpose:</p>\n\n<pre><code>myMapM :: Applicative f\n       =&gt; (a -&gt; f b) -&gt; [a] -&gt; f [b]\n</code></pre>\n\n<p>We want <code>myMapM f []</code> to be <code>pure []</code> (there's no way we can get any <code>b</code>s!), so</p>\n\n<pre><code>myMapM f [] = pure []\n</code></pre>\n\n<p>Now we get to the heart of the matter, figuring out the recursive step. We want <code>myMapM f (x : xs)</code> to perform <code>f x</code>, perform <code>myMapM f xs</code>, and combine the results. So</p>\n\n<pre><code>myMapM f [] = pure []\nmyMapM f (x : xs) = (:) &lt;$&gt; f x &lt;*&gt; myMapM f xs\n</code></pre>\n\n<p>When doing something nice and regular with a list, we can very often get away with just <code>foldr</code>:</p>\n\n<pre><code>myMapM f = foldr go (pure []) where\n  go x r = (:) &lt;$&gt; f x &lt;*&gt; r\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 115, "user_id": 3680029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2f9062247d1bcf616e8a6cf493c00fc?s=128&d=identicon&r=PG&f=1", "display_name": "user3680029", "link": "https://stackoverflow.com/users/3680029/user3680029"}, "is_accepted": false, "score": 1, "last_activity_date": 1556778075, "last_edit_date": 1556778075, "creation_date": 1556741797, "answer_id": 55942191, "question_id": 36742236, "link": "https://stackoverflow.com/questions/36742236/implement-mapm-without-using-sequence/55942191#55942191", "title": "Implement mapM without using sequence", "body": "<p>Take this implementation:</p>\n\n<pre><code>moppy :: Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m [b]\nmoppy f xs = foldr g n xs \n  where\n    n = return []\n    g x mys = do {\n      y  &lt;- f x ;\n      ys &lt;- mys ;\n      return (y:ys) }\n</code></pre>\n\n<p>(<code>mys :: m [b]</code> because <code>foldr g n (x:xs) = g x (foldr g n xs)</code>.)</p>\n\n<p>(adapted from C9 Lectures: Ralf L\u00e4mmel - Going Bananas [8:06 min - youtube).</p>\n"}], "owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 586, "favorite_count": 0, "accepted_answer_id": 36748280, "answer_count": 4, "score": 5, "last_activity_date": 1570165566, "creation_date": 1461151273, "question_id": 36742236, "link": "https://stackoverflow.com/questions/36742236/implement-mapm-without-using-sequence", "title": "Implement mapM without using sequence", "body": "<p>I am currently trying to solve the <a href=\"http://blog.tmorris.net/posts/20-intermediate-haskell-exercises/\" rel=\"noreferrer\">20 Intermediate Haskell Excercises</a> excercises and am stuck which trying to implement <code>mapM</code> (which is <code>moppy</code> in the excercise) without the use of <code>sequence</code>.</p>\n\n<p>All I can produce is a <code>[m b]</code> by simply applying <code>fmap</code> but I don't know how to continue:</p>\n\n<pre><code>moppy :: [a] -&gt; (a -&gt; m b) -&gt; m [b]\nmoppy la f = furry' f la -- how do I transform [m b] to m [b] without sequence\n</code></pre>\n\n<p>Can someone give me a hint in which direction to look?</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1461150904, "post_id": 36741999, "comment_id": 61065638, "body": "can you please add an example where you <i>call</i> <code>foo</code> inside <code>bar</code> - you probably just need the right <i>lift</i>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461151256, "post_id": 36741999, "comment_id": 61065869, "body": "yeah, thanks you very much. I used <code>lift $ lift $ </code> and compiler accpeted it.  I didnt know about it - I thought that lift will be done in automatic way."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1461151404, "post_id": 36741999, "comment_id": 61065966, "body": "well that would make using monad-stacks a lot easier ;) - but never mind - maybe you want to write your own answer or close the question when it&#39;s solved for you"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1461151575, "post_id": 36741999, "comment_id": 61066074, "body": "Instead of using concrete types, it would probaly make more sense to use <code>MonadState</code>, <code>MonadReader</code> and <code>MonadError</code> - that way you don&#39;t have to <code>lift</code>."}], "answers": [{"tags": [], "owner": {"reputation": 574, "user_id": 1504029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96a8e68ffdcc9aca971108c6a989b74c?s=128&d=identicon&r=PG", "display_name": "Paul Visschers", "link": "https://stackoverflow.com/users/1504029/paul-visschers"}, "is_accepted": true, "score": 2, "last_activity_date": 1461151421, "creation_date": 1461151421, "answer_id": 36742298, "question_id": 36741999, "link": "https://stackoverflow.com/questions/36741999/haskell-how-to-deal-with-mismatched-types-monads/36742298#36742298", "title": "haskell, how to deal with mismatched types - monads", "body": "<p>Something like this should work:</p>\n\n<pre><code>bar x y = do\n  -- some code\n  z &lt;- lift $ lift $ foo x y\n  -- some more code\n  return z\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": false, "score": 2, "last_activity_date": 1461152746, "last_edit_date": 1461152746, "creation_date": 1461152366, "answer_id": 36742662, "question_id": 36741999, "link": "https://stackoverflow.com/questions/36741999/haskell-how-to-deal-with-mismatched-types-monads/36742662#36742662", "title": "haskell, how to deal with mismatched types - monads", "body": "<p>What I typically do is using what I've dubbed <em>Transformer Monad Classes</em>:</p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts #-}\n\nimport Control.Monad.Reader\nimport Control.Monad.State\n\ninner :: ReaderT Char IO Int\ninner = do\n    a &lt;- ask\n    lift $ print a\n    return 5\n\ninner' :: (MonadReader Char m, MonadIO m) =&gt; m Int\ninner' = do\n    a &lt;- ask\n    liftIO $ print a\n    return 5\n\nouter :: StateT Char (ReaderT Char IO) Int\nouter = do\n    a &lt;- get\n\n    b &lt;- lift $ inner    -- need to lift\n    c &lt;- inner'          -- no need to lift\n\n    lift . lift $ print \"need to lift twice to get to IO\"            \n\n    return 5\n\nmain = runReaderT (runStateT outer 'b') 'a'\n</code></pre>\n\n<p>Let's break it down; the first <code>inner</code> function has a concrete type you need to directly lift to in order to use it. However, if you parametrize it leaving only <em>capabilities</em> in the signature, you can skip the lifting, as long as it's unambiguous in the stack where to get this capability. In this case it's clear, because <code>StateT Char (ReaderT Char IO) Int</code> has exactly one instance for <code>MonadIO</code> (from <code>IO</code>) and exactly one instance of <code>MonadReader Char</code> (from <code>ReaderT ... Char</code>).</p>\n\n<p>Now, it doesn't matter <em>how many lifts</em> you need to make, as long as the instance is clear! Consider:</p>\n\n<pre><code>outer' :: ErrorT String (StateT Char (ReaderT Char IO)) Int\nouter' = do\n    a &lt;- inner'               -- still no need to lift!\n    b &lt;- lift . lift $ inner  -- need to double lift in this case\n    return 5\n</code></pre>\n\n<p>The last thing that might not be obvious is that the signature of <code>outer</code> could be expressed in a generic way as well:</p>\n\n<pre><code>outer :: (MonadState Char m, MonadReader Char m, MonadIO m) =&gt; m Int\n</code></pre>\n\n<p>And it would still work without any lifts (well sans <code>liftIO</code> for IO operations, because functions like <code>print</code> are defined in terms of <code>IO</code>, not <code>MonadIO m</code>. In comparison, functions like <code>ask</code> and <code>get</code> are defined in terms of the respective <code>MonadX</code> class which allows us to skip the lifting).</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 36742298, "answer_count": 2, "score": 2, "last_activity_date": 1461152746, "creation_date": 1461150659, "question_id": 36741999, "link": "https://stackoverflow.com/questions/36741999/haskell-how-to-deal-with-mismatched-types-monads", "title": "haskell, how to deal with mismatched types - monads", "body": "<p>I can't deal with following problem:<br>\nI have some function, that return <code>foo :: a -&gt; b -&gt; ErrorT String IO Int</code><br>\nI know that it returns <code>IO (Either String Int)</code>.<br>\nNevertheless, I have also more complex function, that returns:  </p>\n\n<p><code>bar :: a -&gt; b -&gt;   StateT Char (ReaderT Char (ErrorT String IO)) Int</code>  </p>\n\n<p>This function <code>bar</code> calls function <code>foo</code>. I am going to to following thing:<br>\nIf <code>foo</code> called <code>throwError</code> <code>bar</code> also throws the same error.  If <code>foo</code> returns <code>Int</code> <code>bar</code> also returns <code>Int</code>.   </p>\n\n<p>However, it is possible due to mismatch types.  </p>\n\n<p>I dont know how to do this in elegant way.\nI think that my order of transformator monad is not ok. </p>\n"}, {"tags": ["haskell", "monads", "monad-transformers"], "comments": [{"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 1, "creation_date": 1461148438, "post_id": 36741000, "comment_id": 61064056, "body": "In general, it&#39;s due to polymorphism and overloading. It&#39;s not possible to say exactly without seeing the code for <code>foo</code>."}], "answers": [{"comments": [{"owner": {"reputation": 574, "user_id": 1504029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96a8e68ffdcc9aca971108c6a989b74c?s=128&d=identicon&r=PG", "display_name": "Paul Visschers", "link": "https://stackoverflow.com/users/1504029/paul-visschers"}, "edited": false, "score": 2, "creation_date": 1461151020, "post_id": 36741152, "comment_id": 61065717, "body": "If you remove your own type signature from <code>foo</code> and then use <code>:t foo</code> in ghci you can see the most general type that <code>foo</code> can have, which is often quite helpful. Also <code>:i SomeFunctionOrTypeOrTypeClass</code> can be very useful when figuring out monad stacks."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 574, "user_id": 1504029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96a8e68ffdcc9aca971108c6a989b74c?s=128&d=identicon&r=PG", "display_name": "Paul Visschers", "link": "https://stackoverflow.com/users/1504029/paul-visschers"}, "edited": false, "score": 1, "creation_date": 1461151271, "post_id": 36741152, "comment_id": 61065884, "body": "Right, though this should not be seen as an invitation to ever omit type signatures in code that&#39;s actually supposed to be <i>used</i>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 574, "user_id": 1504029, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/96a8e68ffdcc9aca971108c6a989b74c?s=128&d=identicon&r=PG", "display_name": "Paul Visschers", "link": "https://stackoverflow.com/users/1504029/paul-visschers"}, "edited": false, "score": 0, "creation_date": 1461151664, "post_id": 36741152, "comment_id": 61066129, "body": "Also, sometimes the inferred type shown by ghci is not really the most useful one \u2013 or would you like documentation that says <code>smoothInterpolate   :: (Data.LinearMap.HerMetric.HasMetric&#39; y,       Data.LinearMap.HerMetric.HasMetric&#39; (Data.LinearMap.HerMetric.DualSpace y,         </code> ...(more constraints)... <code>Data.LinearMap.HerMetric.DualSpace         (Data.LinearMap.HerMetric.DualSpace y)       ~ y, Scalar (Needly y) ~ manifolds-0.2.1.0:Data.Manifold.Types.Primitive.\u211d) =&gt;      Data.List.NonEmpty.NonEmpty (x, y) -&gt; x -&gt; y</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "edited": false, "score": 0, "creation_date": 1461189186, "post_id": 36741152, "comment_id": 61091880, "body": "So it will be ok (when it comes to types) when from function I return something like <code>m a</code>"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1461200950, "post_id": 36741152, "comment_id": 61095403, "body": "Well, not <i>anything</i> like <code>m a</code>. It does need to be a monad fulfilling the necessary constraints."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 7, "last_activity_date": 1461148808, "last_edit_date": 1461148808, "creation_date": 1461148474, "answer_id": 36741152, "question_id": 36741000, "link": "https://stackoverflow.com/questions/36741000/why-it-it-possible-to-replace-these-types/36741152#36741152", "title": "Why it it possible to replace these types?", "body": "<p>Clearly, it is not possible to replace these with one another in <em>all</em> circumstances. For instance, if you explicitly use <code>ErrorT . return $ Left \"Muahar\"</code>, then this <em>must</em> be an <code>ErrorT String m a</code>.</p>\n\n<p>However, both types are of the form <code>a -&gt; M String</code>, with a (transformer-stack) monad <code>M</code> which is an instance of <a href=\"http://hackage.haskell.org/package/transformers-0.5.2.0/docs/Control-Monad-IO-Class.html#t:MonadIO\"><code>MonadIO</code></a> and <a href=\"http://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Error-Class.html#t:MonadError\"><code>MonadError String</code></a>. So, if this function is defined using only actions of the form <code>liftIO ioaction</code>, and possibly <code>throwError</code> and <code>catchError</code>, then it'll work as any of these monads. The general type is</p>\n\n<pre><code>foo :: (MonadIO m, MonadError String m) =&gt; a -&gt; m String\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 36741152, "answer_count": 1, "score": 1, "last_activity_date": 1461148910, "creation_date": 1461148097, "last_edit_date": 1461148910, "question_id": 36741000, "link": "https://stackoverflow.com/questions/36741000/why-it-it-possible-to-replace-these-types", "title": "Why it it possible to replace these types?", "body": "<p>Some thing seems to be incredible:   </p>\n\n<p><code>foo :: a -&gt; StateT Env (ReaderT Env (ErrorT String IO)) String</code></p>\n\n<p>may be replaced with<br>\n<code>foo :: a -&gt; ErrorT String IO String</code></p>\n\n<p>How is it possible ?  After all, they are absolutely different types...</p>\n"}, {"tags": ["haskell", "cabal", "haskell-stack"], "comments": [{"owner": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "edited": false, "score": 2, "creation_date": 1461145122, "post_id": 36739026, "comment_id": 61061620, "body": "<code>stack build --jobs 1</code>"}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "reply_to_user": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "edited": false, "score": 0, "creation_date": 1461146021, "post_id": 36739026, "comment_id": 61062285, "body": "@josejuan sounds like an answer. can you put it below ?"}, {"owner": {"reputation": 842, "user_id": 4737779, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/009c3f05f9273268e5d530785ef14327?s=128&d=identicon&r=PG&f=1", "display_name": "Beerend Lauwers", "link": "https://stackoverflow.com/users/4737779/beerend-lauwers"}, "reply_to_user": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "edited": false, "score": 1, "creation_date": 1461146038, "post_id": 36739026, "comment_id": 61062294, "body": "@josejuan, add this as an answer instead of a comment so the question can be closed :)"}], "answers": [{"tags": [], "owner": {"reputation": 6942, "user_id": 1540749, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/dd6c24a0bc5c0a59a456aa8b08a78b6a?s=128&d=identicon&r=PG", "display_name": "josejuan", "link": "https://stackoverflow.com/users/1540749/josejuan"}, "is_accepted": true, "score": 5, "last_activity_date": 1461147350, "creation_date": 1461147350, "answer_id": 36740693, "question_id": 36739026, "link": "https://stackoverflow.com/questions/36739026/how-to-build-sequentially-each-haskell-package-using-stack-cabal/36740693#36740693", "title": "How to build sequentially each haskell package using stack/cabal?", "body": "<p>You could override the number of jobs used to compile with</p>\n\n<pre><code>stack build --jobs=1\n</code></pre>\n\n<p>Without it</p>\n\n<pre><code>$ stack build\nhnexus-models-0.1.0.0: configure\nhnexus-models-0.1.0.0: build\nkey-doc-schema-0.1.0.0: configure\nkey-doc-schema-0.1.0.0: build\nkey-doc-schema-0.1.0.0: copy/register\nkey-doc-client-0.1.0.0: configure\nhnexus-models-0.1.0.0: copy/register\nkey-doc-client-0.1.0.0: build\nhnexus-mschema-0.1.0.0: configure\nhnexus-mschema-0.1.0.0: build\n...\n</code></pre>\n\n<p>with it</p>\n\n<pre><code>$ stack build --jobs=1\nhnexus-models-0.1.0.0: configure\nhnexus-models-0.1.0.0: build\nhnexus-models-0.1.0.0: copy/register\nhnexus-mschema-0.1.0.0: configure\nhnexus-mschema-0.1.0.0: build\nhnexus-mschema-0.1.0.0: copy/register\nbnexus-mschema-0.1.0.0: configure\nbnexus-mschema-0.1.0.0: build\nbnexus-mschema-0.1.0.0: copy/register\nbnexus-client-0.1.0.0: configure\nbnexus-client-0.1.0.0: build\n...\n</code></pre>\n"}], "owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 36740693, "answer_count": 1, "score": 3, "last_activity_date": 1483520108, "creation_date": 1461143579, "last_edit_date": 1483520108, "question_id": 36739026, "link": "https://stackoverflow.com/questions/36739026/how-to-build-sequentially-each-haskell-package-using-stack-cabal", "title": "How to build sequentially each haskell package using stack/cabal?", "body": "<p>I am trying to debug some compilation problem and I would like to know if it is possible to have non interleaving build steps, like displayed here.</p>\n\n<pre><code>$ stack build\nstring-conv-0.1: configure\nstring-conv-0.1: build\ndotnet-timespan-0.0.1.0: configure\ndotnet-timespan-0.0.1.0: build\nservant-0.7: configure\nstring-conv-0.1: copy/register\ndotnet-timespan-0.0.1.0: copy/register\nservant-0.7: build\ncontrol-monad-omega-0.3.1: configure\ncontrol-monad-omega-0.3.1: build\nswagger2-2.0.1: configure\ncontrol-monad-omega-0.3.1: copy/register\nswagger2-2.0.1: build\neventstore-0.12.0.0: configure\neventstore-0.12.0.0: build\nservant-0.7: copy/register\nservant-client-0.7: configure\nservant-client-0.7: build\nservant-docs-0.7: configure\nservant-docs-0.7: build\nservant-client-0.7: copy/register\nservant-server-0.7: configure\nservant-server-0.7: build\nservant-server-0.7: copy/register\nservant-docs-0.7: copy/register\nswagger2-2.0.1: copy/register\nservant-swagger-1.0.3: configure\nservant-swagger-1.0.3: build\nservant-swagger-1.0.3: copy/register\neventstore-0.12.0.0: copy/register\npl-cqrs-0.1.0.0: configure\npl-cqrs-0.1.0.0: build\npl-cqrs-0.1.0.0: copy/register\npl-server-0.1.0.0: configure\npl-server-0.1.0.0: build\npl-server-0.1.0.0: copy/register\npl-wrapper-0.0.0: configure\npl-wrapper-0.0.0: build\npl-wrapper-0.0.0: copy/register\nCompleted 13 action(s).\n</code></pre>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 3, "creation_date": 1461141485, "post_id": 36738161, "comment_id": 61058814, "body": "there is a <code>Functor</code> instance for <code>Either</code> already - so if you provide one for <code>TypeConstructor</code> (which is a strange name here) - you can just to <code>fmap . fmap</code>"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "edited": false, "score": 0, "creation_date": 1461141750, "post_id": 36738325, "comment_id": 61058989, "body": "Yes, but then my error is not &#39;underground&#39;  - it is why I would like to use something like <code>fmap</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1461142005, "post_id": 36738325, "comment_id": 61059186, "body": "@HaskellFun Then I&#39;m afraid I can not fully understand the question. Maybe you can use the <code>either</code> combinator to remove the left/right pattern matching, but it seems you still need to use <code>case</code> for all the constructors."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1461141687, "creation_date": 1461141687, "answer_id": 36738325, "question_id": 36738161, "link": "https://stackoverflow.com/questions/36738161/haskell-case-of-like-fmap/36738325#36738325", "title": "haskell, case of like fmap", "body": "<p>A basic way could be to pattern match everything</p>\n\n<pre><code>case foo x y of\n  Left string -&gt; ...\n  Right (Cons1 z w) -&gt; ...\n  Right (Cons2 a b c) -&gt; ...\n  Right Cons3 -&gt; ...\n</code></pre>\n\n<p>where <code>Cons1, ...</code> are the value constructors of <code>TypeConstructor</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 44721, "user_id": 546084, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/wMoWk.jpg?s=128&g=1", "display_name": "Chris Taylor", "link": "https://stackoverflow.com/users/546084/chris-taylor"}, "is_accepted": false, "score": 2, "last_activity_date": 1461145808, "creation_date": 1461145808, "answer_id": 36740010, "question_id": 36738161, "link": "https://stackoverflow.com/questions/36738161/haskell-case-of-like-fmap/36740010#36740010", "title": "haskell, case of like fmap", "body": "<p>You can't directly write</p>\n\n<pre><code>case (foo x y) of ...\n</code></pre>\n\n<p>and then pattern match on the type constructors of <code>TypeConstructor</code> since <code>foo x y</code> does not have the correct type (it is <code>Either String TypeConstructor</code>).</p>\n\n<p>However, you can define a function which pattern matches on the type constructors of <code>TypeConstructor</code> and then <code>fmap</code> this over the result of <code>foo x y</code> as shown below.</p>\n\n<pre><code>import Control.Monad.Except (throwError)\n\ndata Type = Int Int\n          | Str String\n          deriving (Show)\n\nfoo :: Int -&gt; String -&gt; Either String Type\nfoo n s =\n    if n == 0\n        then throwError \"Zero\"\n        else return (Str s)\n\nbar x y = fmap f (foo x y)\n    where\n        f a = case a of\n            Int n -&gt; Int (n +  x)\n            Str s -&gt; Str (s ++ y)\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1461145808, "creation_date": 1461141288, "question_id": 36738161, "link": "https://stackoverflow.com/questions/36738161/haskell-case-of-like-fmap", "title": "haskell, case of like fmap", "body": "<p>I have a function of type <code>foo :: a -&gt; a -&gt; Either String TypeConstructor</code><br>\n<code>foo</code> can return both <code>throwError String</code> and something of <code>TypeConstructor</code>.  </p>\n\n<p>I would like to do something like <code>fmap</code>.  I mean that I would like to <code>case (foo x y z) of ...</code> where <code>...</code> means different values (it depends on used constructor value in foo).  </p>\n\n<p>Is there exista any way to do it ?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1461140531, "post_id": 36737790, "comment_id": 61058177, "body": "How about using <code>nub :: Eq a =&gt; [a] -&gt; [a]</code>? Note that you need to provide (or derive) an <code>Eq</code> instance."}], "answers": [{"tags": [], "owner": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "is_accepted": false, "score": 2, "last_activity_date": 1461142881, "creation_date": 1461142881, "answer_id": 36738759, "question_id": 36737790, "link": "https://stackoverflow.com/questions/36737790/haskell-removing-repeated-elements-from-an-adt-list-in-an-adt/36738759#36738759", "title": "Haskell - removing repeated elements from an ADT list in an ADT", "body": "<p>Easy.</p>\n\n<p>First make <code>Book</code> an instance of <code>Eq</code>:</p>\n\n<pre><code>data Book = Book {title :: String, barcode :: Integer} deriving Eq\n</code></pre>\n\n<p>Then fix the function <code>addBook</code> to filter books that are already in the library (by using the <code>elem</code> function):</p>\n\n<pre><code>addBook :: Book -&gt; Library -&gt; Library\naddBook book library = if elem book (getBooks library)\n  then library -- The library already contains this book\n  else library {book = book : getBooks library}\n</code></pre>\n\n<p>The <code>elem</code> function has the following signature:</p>\n\n<pre><code>elem :: a -&gt; [a] -&gt; Bool\n</code></pre>\n"}], "owner": {"reputation": 183, "user_id": 6133691, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d12022bcc552642e8dc3a545df1c42e?s=128&d=identicon&r=PG&f=1", "display_name": "R. Rengold", "link": "https://stackoverflow.com/users/6133691/r-rengold"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1461143003, "creation_date": 1461140285, "last_edit_date": 1495542671, "question_id": 36737790, "link": "https://stackoverflow.com/questions/36737790/haskell-removing-repeated-elements-from-an-adt-list-in-an-adt", "title": "Haskell - removing repeated elements from an ADT list in an ADT", "body": "<p>Hello Stackoverflow community, another fairly elementary question on my behalf:</p>\n\n<p>There was a question asked some five years back which asked \"removing repeated elements from a list in Haskell.\" I have something similar to ask, albiet with a certain degree of complication.</p>\n\n<p>Say that I have these data types:</p>\n\n<pre><code>data Library = Library {borrower :: String, book :: [Book]}\ndata Book = Book {title :: String, barcode :: Integer}\n</code></pre>\n\n<p>Then say I have the function:</p>\n\n<pre><code>addBook :: Book -&gt; Library -&gt; Library\naddBook book library = library {book = book : getBooks library}\n</code></pre>\n\n<p>where getBooks is simply a function that extracts [Book] from Library.</p>\n\n<p>Obviously, this function is fine as long as Ralph doesn't borrow duplicates of books. Nevertheless, if he does, then there will be a duplicate in the list of Books, which is not desirable.</p>\n\n<p>How would I go about writing a function which returns the current [Book], however also removes any duplicates? I tried the method in the question aforementioned at the beginning of the post, however the compiler complains it specifically wants [Book] not [a].</p>\n\n<p>Link to the previous question: \n<a href=\"https://stackoverflow.com/questions/8227218/removing-repeated-elements-from-a-list-in-haskell\">Removing repeated elements from a list in Haskell</a></p>\n"}, {"tags": ["haskell", "types"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1461140120, "post_id": 36737677, "comment_id": 61057896, "body": "usually <a href=\"https://en.wikipedia.org/wiki/Duck_typing\" rel=\"nofollow noreferrer\">duck typing</a> is a runtime/dynamic problem - so Haskell is not the best fit - looking at your example <code>duckplus 1 &quot;1&quot;</code> would have type <code>duckplus :: Num a =&gt; a -&gt; String -&gt; b</code> so you could not have it your type"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1461140165, "post_id": 36737677, "comment_id": 61057923, "body": "you can still do things like this with type-families and associated types - but I would not call it duck-typing"}, {"owner": {"reputation": 2370, "user_id": 1230175, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/YdHmD.png?s=128&g=1", "display_name": "Rax Wunter", "link": "https://stackoverflow.com/users/1230175/rax-wunter"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461140346, "post_id": 36737677, "comment_id": 61058050, "body": "Your definitions doesn&#39;t fit, because it should be possible also to pass duckplus &quot;1&quot; 1 and the result should be &quot;11&quot;"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461140401, "post_id": 36737677, "comment_id": 61058089, "body": "of course it does not fit - see you wanted <code>a -&gt; a -&gt; a</code> and this will never fit neither <code>Int -&gt; String -&gt; String</code> nor <code>String -&gt; Int -&gt; String</code>"}, {"owner": {"reputation": 2370, "user_id": 1230175, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/YdHmD.png?s=128&g=1", "display_name": "Rax Wunter", "link": "https://stackoverflow.com/users/1230175/rax-wunter"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461140480, "post_id": 36737677, "comment_id": 61058141, "body": "@Carsten so how to implement it? :) Create a union type :: Addable a =&gt; a -&gt; a -&gt; a ?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461140564, "post_id": 36737677, "comment_id": 61058198, "body": "no you would have to create a type-class that associates the two input types with the desired output type and includes the <code>duckplus</code> function - but this will open a can of nasty worms and it&#39;s not really idiomatic haskell"}, {"owner": {"reputation": 2370, "user_id": 1230175, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/YdHmD.png?s=128&g=1", "display_name": "Rax Wunter", "link": "https://stackoverflow.com/users/1230175/rax-wunter"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461140641, "post_id": 36737677, "comment_id": 61058243, "body": "@Carsten Sure, I know, I just do it for myself to be more familiar with types mechanics in Haskell"}], "answers": [{"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1461140998, "post_id": 36737965, "comment_id": 61058477, "body": "Alternatively, use <code>data Expr = EInt Int | EString String</code> and provide the <code>Num</code> (for <code>fromIntegral</code>) and <code>IsString</code> (for <code>-XOverloadedStrings</code>) instances. Still going to be fun, since <code>Num</code> is likely partial."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1461141068, "post_id": 36737965, "comment_id": 61058528, "body": "@Zeta this should probably be another answer ;)"}, {"owner": {"reputation": 2370, "user_id": 1230175, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/YdHmD.png?s=128&g=1", "display_name": "Rax Wunter", "link": "https://stackoverflow.com/users/1230175/rax-wunter"}, "edited": false, "score": 0, "creation_date": 1461141190, "post_id": 36737965, "comment_id": 61058599, "body": "Great, thank you. Now it&#39;s more clear for me how to use type classes"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 2370, "user_id": 1230175, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/YdHmD.png?s=128&g=1", "display_name": "Rax Wunter", "link": "https://stackoverflow.com/users/1230175/rax-wunter"}, "edited": false, "score": 0, "creation_date": 1461141251, "post_id": 36737965, "comment_id": 61058640, "body": "@RaxWunter well the magic here are the associated types that come with type-families - the class is just to <i>overload</i>  <code>duckplus</code> ;) - glad to help out"}, {"owner": {"reputation": 2370, "user_id": 1230175, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/YdHmD.png?s=128&g=1", "display_name": "Rax Wunter", "link": "https://stackoverflow.com/users/1230175/rax-wunter"}, "edited": false, "score": 0, "creation_date": 1461141612, "post_id": 36737965, "comment_id": 61058888, "body": "@Carsten and are there any options to do it without extensions?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1461142446, "post_id": 36737965, "comment_id": 61059524, "body": "that what @Zeta hinted at - in this case you would have an <code>Expr</code> ADT and make use of the fact that integer-literals are used with <code>fromIntegral</code> - but you would need an extension to add this for <code>String</code>s as well (<code>OverloadedStrings</code>) - aside from this no - I don&#39;t think so - aside from the <code>TypeSynonymInstances</code> those are perfectly fine with most Haskellers - indeed you&#39;ll see the <code>FlexibleInstances</code> and <code>MultiParamTypeClasses</code> almost everywhere ;)"}, {"owner": {"reputation": 2370, "user_id": 1230175, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/YdHmD.png?s=128&g=1", "display_name": "Rax Wunter", "link": "https://stackoverflow.com/users/1230175/rax-wunter"}, "reply_to_user": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1461143585, "post_id": 36737965, "comment_id": 61060411, "body": "@JoachimBreitner so how I should? As I said, task is specific one, I&#39;m just curious with Haskell type capabilities"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1461144008, "post_id": 36737965, "comment_id": 61060710, "body": "@JoachimBreitner I hope I have not offended - want me to add an disclaimer of sorts (aside form the small warning)?"}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1461155005, "post_id": 36737965, "comment_id": 61068550, "body": "@Carsten No, not offended, just amused. You might want to add that this is not idiomatic Haskell."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "reply_to_user": {"reputation": 2370, "user_id": 1230175, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/YdHmD.png?s=128&g=1", "display_name": "Rax Wunter", "link": "https://stackoverflow.com/users/1230175/rax-wunter"}, "edited": false, "score": 0, "creation_date": 1461155010, "post_id": 36737965, "comment_id": 61068554, "body": "@RaxWunter: I guess one reply would be \u201dWhat problem are you trying to solve?\u201d and figure out a Haskellish way of doing it. (At least if the problem is not \u201cplaying around with the type system\u201d, which is of course a valid thing to do.)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1461155079, "post_id": 36737965, "comment_id": 61068617, "body": "@JoachimBreitner I actually did in one of the comments that led to the answer - but I&#39;ll add the warning ^^"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 7, "last_activity_date": 1461155229, "last_edit_date": 1461155229, "creation_date": 1461140762, "answer_id": 36737965, "question_id": 36737677, "link": "https://stackoverflow.com/questions/36737677/duck-typing-sum-in-haskell/36737965#36737965", "title": "Duck typing sum in haskell", "body": "<h3>caution:</h3>\n\n<p><strong>no-idiomatic Haskell following</strong></p>\n\n<p>You probably should see this as a demonstration of what Haskells type-system is capable of if you ask it nicely.</p>\n\n<p>For actual work I would not <em>recommend</em> a solution like this.</p>\n\n<hr>\n\n<p>here is a possible implementation (with the <em>can of worms</em> aka extensions):</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE TypeSynonymInstances #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE TypeFamilies #-}\n\nclass DuckSum a b where\n  type Result a b :: *\n  duckplus :: a -&gt; b -&gt; Result a b\n\ninstance DuckSum Int String where\n  type Result Int String = String\n  duckplus a b = show a ++ b\n\ninstance DuckSum String Int where\n  type Result String Int = String\n  duckplus a b = a ++ show b\n\ninstance DuckSum Int Int where\n  type Result Int Int = Int\n  duckplus a b = a+b\n</code></pre>\n\n<p>here is an interactive session using this:</p>\n\n<pre><code>\u03bb&gt; duckplus (1 :: Int) \"1\"\n\"11\"\n\u03bb&gt; duckplus \"1\" (1 :: Int)\n\"11\"\n\u03bb&gt; duckplus (1 :: Int) (1 :: Int)\n2\n</code></pre>\n\n<p><strong>note</strong> that you need the type-annotations here as <code>1</code> could be any <code>Num</code> - also use with care</p>\n"}, {"tags": [], "owner": {"reputation": 2370, "user_id": 1230175, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/YdHmD.png?s=128&g=1", "display_name": "Rax Wunter", "link": "https://stackoverflow.com/users/1230175/rax-wunter"}, "is_accepted": true, "score": 0, "last_activity_date": 1461572878, "last_edit_date": 1461572878, "creation_date": 1461516997, "answer_id": 36826157, "question_id": 36737677, "link": "https://stackoverflow.com/questions/36737677/duck-typing-sum-in-haskell/36826157#36826157", "title": "Duck typing sum in haskell", "body": "<p>Maybe I put the question incorrectly, but it seems, that it can be solved easier, something like this:</p>\n\n<pre><code>data IntOrString = Mint Int | Mstr String\n\nplus (Mint a) (Mint b) = show (a + b)\nplus (Mint a) (Mstr b) = show a ++ b\nplus (Mstr a) (Mint b) = a ++ show b\nplus (Mstr a) (Mstr b) = a ++ b\n\nres = plus (Mint 1) (Mint 1) -- 2\nres = plus (Mstr \"1\") (Mint 1) -- 11\n</code></pre>\n\n<p>It requires to wrap Int and String to the constructor values, but doesn't need any externals.</p>\n"}], "owner": {"reputation": 2370, "user_id": 1230175, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/YdHmD.png?s=128&g=1", "display_name": "Rax Wunter", "link": "https://stackoverflow.com/users/1230175/rax-wunter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "accepted_answer_id": 36826157, "answer_count": 2, "score": 2, "last_activity_date": 1461572878, "creation_date": 1461139915, "last_edit_date": 1461140204, "question_id": 36737677, "link": "https://stackoverflow.com/questions/36737677/duck-typing-sum-in-haskell", "title": "Duck typing sum in haskell", "body": "<p>I'm learning Haskell and trying to figure out how to implement \"duck typing\" sum in haskell. So it should be a function, that accepts either char or int, and depending on it either concat or add it.\nSo function definition should look something like this:\nduckplus :: (AddableUnionType a) -> a -> a -> a</p>\n\n<pre><code>  duckplus 1 \"1\" -- \"11\"\n  duckplus 1 1 -- 2\n</code></pre>\n\n<p>Is it possible to use pattern matching?</p>\n"}, {"tags": ["haskell", "typeclass", "duck-typing"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1461139580, "post_id": 36736976, "comment_id": 61057519, "body": "btw: I don&#39;t think this is duck-typing at all - first you change the signature of <code>bar</code> between <i>ducks</i> and then you need the <code>instance</code>s - it&#39;s just polymorphism"}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461165310, "post_id": 36736976, "comment_id": 61077160, "body": "@Carsten I was thinking l largely about automatic code generation. Where you would use duck typing in a (modified version of a) language like Python, and it would be converted to Haskell by automatically generating these &quot;psuedo-ducktyping&quot; classes and instances and what not."}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 4, "last_activity_date": 1461139086, "last_edit_date": 1461139086, "creation_date": 1461138622, "answer_id": 36737202, "question_id": 36736976, "link": "https://stackoverflow.com/questions/36736976/how-to-make-this-example-of-pseudo-ducktyping-type-unambiguously-without-annotat/36737202#36737202", "title": "How to make this example of pseudo-ducktyping type unambiguously without annotations", "body": "<p>the problem is that it's not only looking for what it <em>sees</em> but what it can <em>know</em> - and there is the possibility for you to make an instance that will be <code>HasBar Int Foo</code> as well so it complains</p>\n\n<p>You can get rid of this with either <a href=\"https://wiki.haskell.org/Functional_dependencies\" rel=\"nofollow\"><code>FunctionalDependencies</code></a> or <a href=\"https://wiki.haskell.org/GHC/Type_families\" rel=\"nofollow\"><code>TypeFamilies</code></a> </p>\n\n<h2>using <em>functional dependencies</em></h2>\n\n<p>the first extension is probably the way to go here (you don't have to change much of your code). You can basically tell GHCi, that the type <code>b</code> in your class/constraint will be enough to decide the type <code>a</code>.</p>\n\n<p>if you change it to:</p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses, FunctionalDependencies #-}\n\nclass HasBar a b | b -&gt; a where\n    bar :: b -&gt; a \n</code></pre>\n\n<p>it'll work (you need the <code>FlexibleContexts</code> only in GHCi</p>\n\n<pre><code>\u03bb&gt; :set -XFlexibleContexts\n\u03bb&gt; bar (Foo True)\nTrue\n</code></pre>\n\n<h2>using <em>type families</em></h2>\n\n<p>In case you are interested here is the same thing with type-families and associated types:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n\nclass HasBar a where\n  type Bar a :: *\n  bar :: a -&gt; Bar a\n\ndata Foo = Foo { barBool :: Bool } deriving (Show)\n\ninstance HasBar Foo where\n  type Bar Foo = Bool\n  bar = barBool\n\ndata Bazz = Bazz { barInt :: Int } deriving (Show)\n\ninstance HasBar Bazz where\n  type  Bar Bazz = Int\n  bar = barInt\n</code></pre>\n\n<p>note that you don't need the <code>MultiParamTypeClasses</code> any more</p>\n"}], "owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "accepted_answer_id": 36737202, "answer_count": 1, "score": 2, "last_activity_date": 1461139086, "creation_date": 1461137993, "question_id": 36736976, "link": "https://stackoverflow.com/questions/36736976/how-to-make-this-example-of-pseudo-ducktyping-type-unambiguously-without-annotat", "title": "How to make this example of pseudo-ducktyping type unambiguously without annotations", "body": "<p>I wanted to demonstrate the idea of statically verifiable duck typing in Haskell using <code>MultiParamTypeClasses</code>, but I am having trouble avoiding type ambiguity.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>{-# LANGUAGE MultiParamTypeClasses #-}\n\nclass HasBar a b where\n    bar :: b -&gt; a \n\ndata Foo = Foo { barBool :: Bool } deriving (Show)\n\ninstance HasBar Bool Foo where\n    bar = barBool\n\ndata Bazz = Bazz { barInt :: Int } deriving (Show)\n\ninstance HasBar Int Bazz where\n    bar = barInt\n</code></pre>\n\n<p>When I load it into GHCi and try to do <code>bar (Foo True)</code> or <code>bar (Bazz 5)</code> I get a <code>Non type-variable argument</code> error and it suggests <code>FlexibleContexts</code>, which just changes the error to an ambiguity error. Now doing something like <code>False || bar (Foo True)</code> works fine. But that doesn't seem like it should be needed as <code>Foo</code> is only a member of the typeclass that returns a <code>Bool</code>.</p>\n\n<p>It seems like the issue is something to do with the possibility of something like:</p>\n\n<pre><code>instance HasBar Int Foo where\n    bar = const 5\n</code></pre>\n\n<p>Which would necessitate the types being ambiguous. But if there is just one instance I don't see why there are any issues preventing Haskell from finding out the type (do I need some sort of extension). If I can't do it that way then is there an alternative to <code>MultiParamTypeClasses</code> that only allows one instance and would allow for this pseudo-ducktyping type of thing to work?</p>\n"}, {"tags": ["xml", "haskell", "hxt"], "comments": [{"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1461154121, "post_id": 36736504, "comment_id": 61067908, "body": "Is explicitly calling <code>mkCdata</code> inconvenient in you program? I didn&#39;t find such an option while grepping over the source of hxt."}, {"owner": {"reputation": 1747, "user_id": 343761, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cf716ff342bad8a3aa8178ab9b39366d?s=128&d=identicon&r=PG", "display_name": "homam", "link": "https://stackoverflow.com/users/343761/homam"}, "reply_to_user": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1461157531, "post_id": 36736504, "comment_id": 61070574, "body": "I can call <code>mkCdata</code> myself in the program. But how? This is a type error: <code>X.mkelem &quot;texts&quot; [] [X.mkCdata &quot;hello&lt;br&gt;world!&quot;]</code>"}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 3, "creation_date": 1461161780, "post_id": 36736504, "comment_id": 61074269, "body": "<code>mkCdata</code> is an arrow, you have to combine it with another constant <code>String</code> arrow like <code>constA &quot;hello&lt;br&gt;world!&quot; &gt;&gt;&gt; mkCdata</code>"}, {"owner": {"reputation": 1747, "user_id": 343761, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cf716ff342bad8a3aa8178ab9b39366d?s=128&d=identicon&r=PG", "display_name": "homam", "link": "https://stackoverflow.com/users/343761/homam"}, "reply_to_user": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1461218317, "post_id": 36736504, "comment_id": 61100365, "body": "Thanks. What&#39;s the type of this function? <code>cDataTxt txt = mkCdata &lt;&lt;&lt; constA txt</code> ? I tried <code>cDataTxt :: String -&gt; a n XmlTree</code> and some other variants but none of them worked. How can I write it in point-free style?"}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 1, "creation_date": 1461236134, "post_id": 36736504, "comment_id": 61112571, "body": "It&#39;s of the same type with <code>txt</code> which is <code>ArrowXml a =&gt; String -&gt; a n XmlTree</code>."}], "answers": [{"tags": [], "owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "is_accepted": true, "score": 1, "last_activity_date": 1461236454, "last_edit_date": 1461236454, "creation_date": 1461236136, "answer_id": 36767462, "question_id": 36736504, "link": "https://stackoverflow.com/questions/36736504/rendering-cdata-with-haskell-xht-library/36767462#36767462", "title": "Rendering CDATA with Haskell XHT Library", "body": "<p>I didn't find such an option while grepping over the source of hxt, but you always can call <code>mkCdata</code> explicitly to construct a CDATA text node:</p>\n\n<pre><code>import Text.XML.HXT.Core\n\nhello :: ArrowXml a =&gt; a XmlTree XmlTree\nhello =\n  mkelem \"texts\" [] [constA \"hello&lt;br&gt;world!\" &gt;&gt;&gt; mkCdata]\n</code></pre>\n\n<p>And you may define a function simliar to <code>txt</code>, in the same manner how <code>txt</code> is defined <a href=\"http://hackage.haskell.org/package/hxt-9.3.1.15/docs/src/Text-XML-HXT-Arrow-XmlArrow.html#txt\" rel=\"nofollow\">in the source</a>:</p>\n\n<pre><code>import qualified Text.XML.HXT.DOM.XmlNode as XN\n\ntxtCdata :: ArrowXml a =&gt; String -&gt; a n XmlTree\n-- XN.mkCdata :: XmlNode n =&gt; String -&gt; n, XmlTree is an instance of XmlNode\n-- constA :: Arrow a =&gt; c -&gt; a b c, b is free\ntxtCdata = constA . XN.mkCdata\n\nhello :: ArrowXml a =&gt; a XmlTree XmlTree\nhello =\n  mkelem \"texts\" [] [txtCdata \"hello&lt;br&gt;world!\"]\n</code></pre>\n"}], "owner": {"reputation": 1747, "user_id": 343761, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/cf716ff342bad8a3aa8178ab9b39366d?s=128&d=identicon&r=PG", "display_name": "homam", "link": "https://stackoverflow.com/users/343761/homam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 36767462, "answer_count": 1, "score": 1, "last_activity_date": 1461236454, "creation_date": 1461136736, "question_id": 36736504, "link": "https://stackoverflow.com/questions/36736504/rendering-cdata-with-haskell-xht-library", "title": "Rendering CDATA with Haskell XHT Library", "body": "<p>How can I make <a href=\"https://wiki.haskell.org/HXT\" rel=\"nofollow\">HXT</a> library to output CDATA?</p>\n\n<p>For example running <code>test</code> in this snippet will result in</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;texts&gt;hello&amp;lt;br&gt;world!&lt;/texts&gt;\n</code></pre>\n\n<hr>\n\n<pre><code>import Text.XML.HXT.Core\n\nhello :: ArrowXml a =&gt; a XmlTree XmlTree\nhello =\n  mkelem \"texts\" [] [txt \"hello&lt;br&gt;world!\"]\n\ntest = runX $\n  root [] [hello]\n  &gt;&gt;&gt;\n  writeDocument [withIndent yes] \"somefile.xml\"\n</code></pre>\n\n<p>But I need it to render:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;texts&gt;&lt;![CDATA[hello&lt;br&gt;world!]]&gt;&lt;/texts&gt;\n</code></pre>\n\n<p>Can <code>HXT</code> automatically detect if CDATA is necessary?</p>\n"}, {"tags": ["haskell", "monads", "interpreter", "monad-transformers"], "comments": [{"owner": {"reputation": 15004, "user_id": 562906, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a15f15ed0023f4177a518b6c15ca4b6?s=128&d=identicon&r=PG", "display_name": "sinelaw", "link": "https://stackoverflow.com/users/562906/sinelaw"}, "edited": false, "score": 1, "creation_date": 1461136801, "post_id": 36735017, "comment_id": 61055631, "body": "Can you add the definitions of the data types Arithmic &amp; Value? Also InterpError and Environment are missing but that&#39;s less important since you&#39;re not using them in the example"}], "answers": [{"tags": [], "owner": {"reputation": 3609, "user_id": 2565354, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/590ed3229d95cdcaa05a96028c586165?s=128&d=identicon&r=PG", "display_name": "badcook", "link": "https://stackoverflow.com/users/2565354/badcook"}, "is_accepted": true, "score": 1, "last_activity_date": 1461137270, "creation_date": 1461137270, "answer_id": 36736706, "question_id": 36735017, "link": "https://stackoverflow.com/questions/36735017/get-data-from-2-states-in-haskell/36736706#36736706", "title": "Get data from 2 states in Haskell", "body": "<p>There's quite a bit of context missing from your code so I've done my best to piece it together into something that compiles by itself. Your type signatures also have parentheses that extend a bit too far out. Presumably <code>Either</code> was meant to be <code>EitherT</code> as well.</p>\n\n<p>I'm still slightly confused by what exactly you want since it seems like you're almost there, but is the following akin to what you're looking for (this compiles as you would expect)? Perhaps you think that <code>st1 &lt;- interpArithmic</code> is only \"unwrapping one layer\" and therefore gives back a <code>StateT ...</code> when in fact <code>st1</code> is a <code>Value</code>? </p>\n\n<pre><code>import Control.Monad.Trans.Except\nimport Control.Monad.Trans.State\n\ntype EitherT = ExceptT\n\ndata Arithmic = ConstInteger Integer | BinaryArithmicExpression Exp Arithmic Arithmic\n\ndata Value = Num Integer\n\ndata Exp = Add\n\ntype InterpError = String\n\ntype Environment = String\n\ngetVal :: Value -&gt; Integer\ngetVal (Num x) = x\n\nbArithHelper :: Arithmic -&gt; Arithmic -&gt; (Integer -&gt; Integer -&gt; Integer) -&gt; EitherT InterpError (StateT Environment IO) Value\nbArithHelper a b func =\n    do\n        st1 &lt;- interpArithmic a\n        st2 &lt;- interpArithmic b\n        return $ Num (func (getVal st1) (getVal st2))\n\ninterpArithmic :: Arithmic -&gt; EitherT InterpError (StateT Environment IO) Value\ninterpArithmic (ConstInteger a) = return (Num a)\ninterpArithmic (BinaryArithmicExpression Add a b) = bArithHelper a b (\\x -&gt; \\y -&gt; x + y)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15004, "user_id": 562906, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7a15f15ed0023f4177a518b6c15ca4b6?s=128&d=identicon&r=PG", "display_name": "sinelaw", "link": "https://stackoverflow.com/users/562906/sinelaw"}, "is_accepted": false, "score": 1, "last_activity_date": 1461137351, "creation_date": 1461137351, "answer_id": 36736738, "question_id": 36735017, "link": "https://stackoverflow.com/questions/36735017/get-data-from-2-states-in-haskell/36736738#36736738", "title": "Get data from 2 states in Haskell", "body": "<p>Your question is missing some data type definitions, so I inferred from the context what I thought you meant. Here's what I got:</p>\n\n<pre><code>module Main where\n\nimport Control.Monad.Trans.Either\nimport Control.Monad.Trans.State\n\ndata InterpError = InterpError () deriving (Show)\ndata Environment = Environment () deriving (Show)\ndata Op = Add deriving (Show)\ndata Value = Num Integer deriving (Show)\n\ndata Arithmic = ConstInteger Integer\n                | BinaryArithmicExpression Op Arithmic Arithmic\n                deriving (Show)\n\nbArithHelper :: Arithmic -&gt; Arithmic -&gt; (Integer -&gt; Integer -&gt; Integer) -&gt; EitherT InterpError (StateT Environment IO) Value\nbArithHelper a b func = do\n    Num st1 &lt;- interpArithmic a\n    Num st2 &lt;- interpArithmic b\n    return $ Num $ func st1 st2\n\n-- This function interpretes an arithmic expression and returns it's result.\n-- An error message (int the form of Error) is returned in case something goes wrong.\ninterpArithmic :: Arithmic -&gt; EitherT InterpError (StateT Environment IO) Value\ninterpArithmic (ConstInteger a) = return (Num a)\ninterpArithmic (BinaryArithmicExpression Add a b) = bArithHelper a b (\\x -&gt; \\y -&gt; x + y)\n\nmain :: IO ()\nmain = do\n    res &lt;- runStateT (runEitherT $ interpArithmic (BinaryArithmicExpression Add (ConstInteger 2) (ConstInteger 3))) $ Environment ()\n    print res\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4424299"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 36736706, "answer_count": 2, "score": 1, "last_activity_date": 1461137351, "creation_date": 1461132061, "question_id": 36735017, "link": "https://stackoverflow.com/questions/36735017/get-data-from-2-states-in-haskell", "title": "Get data from 2 states in Haskell", "body": "<p>I'm writing a small interpreter in Haskell that uses the StateT-monad (in combination with IO) and the EitherT monad. Now I want to apply an integer function to the values interpreted by the interpArithmic function. But the problem is that the interpArithmic itself also has the <code>EitherT InterpError (StateT Environment IO ())</code> signature. How can I extract the values interpreted by the interpArithmic function, use it in my bAritHelper function, add them together (for example) and return there new value?</p>\n\n<pre><code>bArithHelper :: Arithmic -&gt; Arithmic -&gt; (Integer -&gt; Integer -&gt; Integer) -&gt; EitherT InterpError (StateT Environment IO Value)\nbArithHelper a b func = \n-- Body of this function is completely broken, don't know how to fix this.\ndo\n    st1 &lt;- interpArithmic a\n    st2 &lt;- interpArithmic b\n    return $ do  \n        env1 &lt;- get st1\n        env2 &lt;- get st2\n        return Num\n    liftM $ \n\n-- This function interpretes an arithmic expression and returns it's result.\n-- An error message (int the form of Error) is returned in case something goes wrong.\ninterpArithmic :: Arithmic -&gt; Either InterpError (StateT Environment IO Value)\ninterpArithmic (ConstInteger a) = return (Num a)\ninterpArithmic (BinaryArithmicExpression Add a b) = bArithHelper a b (\\x -&gt; \\y -&gt; x + y)\n</code></pre>\n\n<p>Or is there some other way to handle errors and use the StateT monad in combination with IO?</p>\n\n<p>PS: I would like to retain EitherT as the outer monad transformer, because that way I don't have to use some sort of case in do-block.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461127436, "post_id": 36733925, "comment_id": 61051135, "body": "btw: for the given data and the example string the output is impossible - there is no <code>B1 :: Quest</code>"}, {"owner": {"reputation": 3, "user_id": 6228191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1df734191aaf749d84177835a94ee9e?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/6228191/j-doe"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461127873, "post_id": 36733925, "comment_id": 61051296, "body": "Sorry, that A2 should be B1"}], "answers": [{"tags": [], "owner": {"reputation": 66, "user_id": 6228937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c011d81846af89f254a8147133eb998f?s=128&d=identicon&r=PG&f=1", "display_name": "Jasper", "link": "https://stackoverflow.com/users/6228937/jasper"}, "is_accepted": true, "score": 1, "last_activity_date": 1461146545, "last_edit_date": 1461146545, "creation_date": 1461145228, "answer_id": 36739774, "question_id": 36733925, "link": "https://stackoverflow.com/questions/36733925/if-my-input-is-a1cb1-how-to-make-the-output-become-a1-c-b1/36739774#36739774", "title": "If my input is &quot;A1CB1&quot; how to make the output become [A1, C, B1]?", "body": "<p>Does something like this help? It can probably be done shorter / more elegantly but the snippet below makes the idea clear I hope:</p>\n\n<pre><code>import Data.List\nimport Data.Maybe\n\ndata Quest = A1 | B1 | C deriving \n        ( Enum     -- Defines sequential ordering\n        , Bounded  -- Name the lower and upper limits of a type\n        , Show     -- String conversion\n        , Read     -- Conversion from string\n        )\n\n-- A parser for \"a\" is a function that works on input, \n-- and then possibly yields a value of type \"a\", and the\n-- remaining input.\ntype Parser a = String -&gt; (Maybe a, String)\n\n-- Give us all possible quests.\nallQuests :: [Quest]\nallQuests = [minBound..]\n\n-- Simply lift a value to the \"Parser\" domain.\nyield :: a -&gt; Parser a\nyield value = \\input -&gt; (Just value, input)\n\n-- A parser that always fails.\ndecline :: Parser a\ndecline = \\input -&gt; (Nothing, input)\n\n-- Creates a parser for a given Quest.\n-- maybe: http://hackage.haskell.org/package/base-4.8.2.0/docs/Prelude.html#v:maybe\n-- stripPrefix: http://hackage.haskell.org/package/base-4.8.2.0/docs/Data-List.html#v:stripPrefix\nparseQuest :: Quest -&gt; Parser Quest\nparseQuest quest = \\input -&gt; \n    maybe (decline input)                   -- Default: decline the input\n          (yield quest)                     -- If we found the correct prefix: yield it.\n          (stripPrefix (show quest) input)  -- Try to strip the prefix.\n\n-- Parse a string into a list of quests. \n-- Defined to be somewhat fault tolerant: the function\n-- will attempt to parse as much as it can, and will yield\n-- the remaining input in its result.\n-- find: http://hackage.haskell.org/package/base-4.8.2.0/docs/Data-List.html#v:find\n-- \nparseQuests :: Parser [Quest]\nparseQuests = \\input -&gt; \n    let parsers = map parseQuest allQuests         -- A list of parsers; one for each quest.\n        results = map ($ input) parsers            -- Each parser is applied to \"input\".\n     in case find (isJust . fst) results of        -- Stop when one parser succeeded.\n        Nothing                 -&gt; yield [] input  -- No quest could be parsed. \n        Just (Just quest, rest) -&gt; \n            let (Just quests, rest') = parseQuests rest -- Parse the rest recursively.\n             in yield (quest:quests) rest'              -- And then yield it all.\n</code></pre>\n\n<p>This gives:</p>\n\n<pre><code>parseQuests \"A1CB1\" == (Just [A1,C,B1],\"\")\n</code></pre>\n\n<p>Or if you want something identical to your function:</p>\n\n<pre><code>getQuest = fromJust . fst . parseQuests\n</code></pre>\n\n<p>So that </p>\n\n<pre><code>getQuest \"A1CB1\" == [A1,C,B1]\n</code></pre>\n\n<p><strong>Note:</strong> I did not take into account overlapping constructor names (e.g. adding a <code>B12 :: Quest</code>). One way to account for this case is to order the result from <code>allQuests</code> so that <code>parseQuests</code> attempts to parse <code>B1</code> before <code>B12</code>, but this would not always work. For example when there is ambiguity:</p>\n\n<pre><code>data Quest = C1 | EC1 | E\n-- Should input \"EC1\" be parsed as [E, C1] or [EC1]?\n</code></pre>\n\n<p>Or when only a certain combination parses successfully:</p>\n\n<pre><code>data Quest = AB | ABC | DE\n-- Input \"ABCDE\" would only parse as [ABC, DE], \n-- but will fail when parsing starts with AB.\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 6228191, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1df734191aaf749d84177835a94ee9e?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/6228191/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 36739774, "answer_count": 1, "score": -2, "last_activity_date": 1461146545, "creation_date": 1461127078, "last_edit_date": 1461130701, "question_id": 36733925, "link": "https://stackoverflow.com/questions/36733925/if-my-input-is-a1cb1-how-to-make-the-output-become-a1-c-b1", "title": "If my input is &quot;A1CB1&quot; how to make the output become [A1, C, B1]?", "body": "<p>If my input is <code>\"A1CB1\"</code> how to make the output become <code>[A1, C, B1]</code>?</p>\n\n<pre><code>data Quest = A1 | B1 | C\ngetQuest :: String -&gt; Maybe [Quest]\n</code></pre>\n"}, {"tags": ["haskell", "non-exhaustive-patterns"], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 1, "last_activity_date": 1461124573, "creation_date": 1461124573, "answer_id": 36733541, "question_id": 36733513, "link": "https://stackoverflow.com/questions/36733513/keep-getting-matching-error-in-haskell-when-testing-function/36733541#36733541", "title": "Keep getting matching error in haskell when testing function", "body": "<p>of course it is - in your <code>testRevDigits</code> you match for <code>[d]</code> - which means the second component of the input tuple will only work with lists of length 1 but you pass in longer lists.</p>\n\n<p>My best guess is that you want this:</p>\n\n<pre><code>testRevDigits :: (Integer, [Integer]) -&gt; Bool\ntestRevDigits (n,expected) = toRevDigits n == expected\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 4317506, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/20c43601a772dd3af647da6ae4e1f445?s=128&d=identicon&r=PG&f=1", "display_name": "Spencer Josephs", "link": "https://stackoverflow.com/users/4317506/spencer-josephs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21, "favorite_count": 0, "closed_date": 1474567470, "answer_count": 1, "score": -2, "last_activity_date": 1461124573, "creation_date": 1461124303, "question_id": 36733513, "link": "https://stackoverflow.com/questions/36733513/keep-getting-matching-error-in-haskell-when-testing-function", "closed_reason": "Duplicate", "title": "Keep getting matching error in haskell when testing function", "body": "<blockquote>\n  <p>this is the function</p>\n</blockquote>\n\n<pre><code>toRevDigits :: Integer -&gt; [Integer]\ntoRevDigits 0 = []\ntoRevDigits x\n    | x&lt;0 = []\n    | otherwise = lastDigit x:(toRevDigits (dropLastDigit x))\n</code></pre>\n\n<blockquote>\n  <p>this is the test</p>\n</blockquote>\n\n<pre><code>testRevDigits :: (Integer, [Integer]) -&gt; Bool\ntestRevDigits (n, [d]) = toRevDigits n ==[n]\n\nex2Tests :: [Test]\nex2Tests = [Test \"toRevDigits test\" testRevDigits\n            [(321,[1,2,3]), (0,[]), ((-17),[])]\n           ]\n</code></pre>\n\n<blockquote>\n  <p>this is the error</p>\n</blockquote>\n\n<pre><code>*** Exception: LAB8Tests.hs:27:1-44: Non-exhaustive patterns in function         testRevDigits\n</code></pre>\n\n<blockquote>\n  <p>how can i fix the tester to function to make it work?</p>\n</blockquote>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13379, "user_id": 1033027, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b56ea1c43a4ecb1060ec8bcb8d2bce78?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/1033027/jules"}, "edited": false, "score": 0, "creation_date": 1461124205, "post_id": 36733472, "comment_id": 61050279, "body": "Could you include more code? The most likely cause of this is a bad type signature, but without seeing more code it&#39;s difficult to be sure <i>which</i> signature&#39;s at the root of the problem."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461124819, "post_id": 36733472, "comment_id": 61050453, "body": "it&#39;s the <code>resp</code> in this line - this is supposed to be an action <i>processing</i> this <code>Response BodyReader</code> (a function from this to some <code>IO a</code>) - but you only give it the response (<b>you</b> have to create the actual <code>content</code> here) - for example <code>content &lt;- withResponse req man (\\resp -&gt; return &quot;What&quot;)</code> should work (but is not what you wont most likely) - btw: you don&#39;t need either the <code>resonseOpen</code> or then <code>withResponse</code> - go with one of them"}, {"owner": {"reputation": 121, "user_id": 4132736, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/184bf384d8d1eb5cd66d7ee4d77f62db?s=128&d=identicon&r=PG", "display_name": "lamino", "link": "https://stackoverflow.com/users/4132736/lamino"}, "edited": false, "score": 0, "creation_date": 1461126293, "post_id": 36733472, "comment_id": 61050808, "body": "Thanks for the input, however, the third argument needs some <code>(Response BodyReader -&gt; IO a)</code>, not some string.. which is seemingly difficult to produce here."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461126838, "post_id": 36733472, "comment_id": 61050960, "body": "yes of course - the idea of <code>withResponse</code> is that it will fetch the resonponse from the <code>req</code> for you (using a connection obtained from <code>mng</code>) - once it got the response it will feed it to the function/action <i>you have to provide</i> in the thirds parameter and feed the output of this back - it&#39;s a high-level way to let you only be concerned with the <code>Response Body</code>"}, {"owner": {"reputation": 121, "user_id": 4132736, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/184bf384d8d1eb5cd66d7ee4d77f62db?s=128&d=identicon&r=PG", "display_name": "lamino", "link": "https://stackoverflow.com/users/4132736/lamino"}, "edited": false, "score": 0, "creation_date": 1461127030, "post_id": 36733472, "comment_id": 61051026, "body": "Well I got a workaround by changing <code>resp &lt;- responseOpen req man</code> to <code>let resp = responseOpen req man</code>. I don&#39;t get the error anymore."}, {"owner": {"reputation": 121, "user_id": 4132736, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/184bf384d8d1eb5cd66d7ee4d77f62db?s=128&d=identicon&r=PG", "display_name": "lamino", "link": "https://stackoverflow.com/users/4132736/lamino"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461127251, "post_id": 36733472, "comment_id": 61051089, "body": "Thanks @Carsten I get what you were implying in your first comment. Namely I could have <code>content &lt;- withResponse req man (\\resp -&gt; return responseOpen req man)</code>"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461127306, "post_id": 36733472, "comment_id": 61051107, "body": "but this would be really strange ... why would you ignore the <code>resp</code> the function fetched for you and <i>refetch</i> it - isn&#39;t <code>withResponse req man return</code> what you want then?"}, {"owner": {"reputation": 121, "user_id": 4132736, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/184bf384d8d1eb5cd66d7ee4d77f62db?s=128&d=identicon&r=PG", "display_name": "lamino", "link": "https://stackoverflow.com/users/4132736/lamino"}, "edited": false, "score": 0, "creation_date": 1461127561, "post_id": 36733472, "comment_id": 61051177, "body": "Well I&#39;m just not sure what syntax to use to achieve that."}, {"owner": {"reputation": 121, "user_id": 4132736, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/184bf384d8d1eb5cd66d7ee4d77f62db?s=128&d=identicon&r=PG", "display_name": "lamino", "link": "https://stackoverflow.com/users/4132736/lamino"}, "edited": false, "score": 0, "creation_date": 1461127851, "post_id": 36733472, "comment_id": 61051285, "body": "Does this make sense? <code>content &lt;- withResponse req man &gt;&gt;= withResponse</code>"}, {"owner": {"reputation": 121, "user_id": 4132736, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/184bf384d8d1eb5cd66d7ee4d77f62db?s=128&d=identicon&r=PG", "display_name": "lamino", "link": "https://stackoverflow.com/users/4132736/lamino"}, "edited": false, "score": 0, "creation_date": 1461128306, "post_id": 36733472, "comment_id": 61051451, "body": "I believe this is what I need: <code>content &lt;- withResponse req man (\\x -&gt; return (withResponse req man))</code>"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1461128896, "post_id": 36733472, "comment_id": 61051673, "body": "I believe it&#39;s getting worse ... maybe you should edit your question and explain what you want with the response"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1461130538, "post_id": 36733472, "comment_id": 61052345, "body": "Leaving aside type errors and the nested <code>withResponse</code>s, are you looking for something like <code>do ... let x = withResponse req man; withResponse req man x ...</code>?"}, {"owner": {"reputation": 121, "user_id": 4132736, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/184bf384d8d1eb5cd66d7ee4d77f62db?s=128&d=identicon&r=PG", "display_name": "lamino", "link": "https://stackoverflow.com/users/4132736/lamino"}, "edited": false, "score": 0, "creation_date": 1461132072, "post_id": 36733472, "comment_id": 61052961, "body": "Yes, I want something like that. The problem is that withResponse is wrapped with IO in the first call, so as a result I get this: <code>Couldn&#39;t match type &#39;Response BodyReader -&gt; IO a0&#39; with &#39;Response BodyReader&#39;</code>"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1461174037, "post_id": 36733472, "comment_id": 61082963, "body": "Since you&#39;re already in <code>do</code> notation for <code>IO</code>, you can use <code>do ... x &lt;- withResponse req man; withResponse req man x ...</code>. Note, however, that <code>withResponse</code> takes 3 arguments and you are giving the first one 2 arguments. You may want to give a third argument to the first call, or use a different approach."}], "answers": [{"tags": [], "owner": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "is_accepted": true, "score": 2, "last_activity_date": 1461183344, "creation_date": 1461183344, "answer_id": 36754277, "question_id": 36733472, "link": "https://stackoverflow.com/questions/36733472/how-to-store-a-functions-return-argument-in-haskell/36754277#36754277", "title": "How to store a function&#39;s return argument in Haskell", "body": "<p>You're confused and it's going to take a bit to unpack this.</p>\n\n<p>While there is a generic way to sneak the input parameter out when you're working inside the <code>IO</code> monad using <code>IORef</code>s, I'm not going to tell you that because:</p>\n\n<ol>\n<li>It isn't necessary to do anything sneaky because the return value of <code>withResponse</code> is what its third parameter returns anyway.</li>\n<li>It wouldn't help you, because if you take the <code>Response BodyReader</code> out of <code>withResponse</code>, it will be closed and you won't be able to read it.</li>\n</ol>\n\n<p>First off, the type of <code>withResponse</code> is this:</p>\n\n<pre><code>withResponse :: Request -&gt; Manager -&gt; (Response BodyReader -&gt; IO a) -&gt; IO a\n</code></pre>\n\n<p>Now, the <a href=\"https://hackage.haskell.org/package/http-client-0.4.28/docs/Network-HTTP-Client.html#v:withResponse\" rel=\"nofollow\">description of <code>withResponse</code></a> makes it clear that the <code>Response BodyReader</code> object is only valid inside the action of <code>withResponse</code>. So if you try to take that object out of <code>withResponse</code> as you're asking to, you won't be able to read it. The <code>Response BodyReader</code> object will already be closed.</p>\n\n<p>Instead, what you're supposed to do is create a function that uses the response and does something with it, and pass that function. Since all you claim to want to do is call <code>brRead</code> on the response a single time, you could do this:</p>\n\n<pre><code>startOn url = do\n    man &lt;- newManager defaultManagerSettings\n    req &lt;- parseUrl url\n    read &lt;- withResponse req man (brRead . responseBody)\n    return $ read\n</code></pre>\n\n<p>That will return to you only the first <code>ByteString</code> chunk of the given URL, but if that's all you need, that's fine. If what you're trying to do here is return the whole <code>ByteString</code> of a response, there's already a convenience function for that - <code>httpLbs</code>:</p>\n\n<pre><code>startOn url = do\n    man &lt;- newManager defaultManagerSettings\n    req &lt;- parseUrl url\n    response &lt;- httpLbs req man\n    return $ responseBody response\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 4132736, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/184bf384d8d1eb5cd66d7ee4d77f62db?s=128&d=identicon&r=PG", "display_name": "lamino", "link": "https://stackoverflow.com/users/4132736/lamino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 36754277, "answer_count": 1, "score": -2, "last_activity_date": 1461183344, "creation_date": 1461124063, "last_edit_date": 1461130119, "question_id": 36733472, "link": "https://stackoverflow.com/questions/36733472/how-to-store-a-functions-return-argument-in-haskell", "title": "How to store a function&#39;s return argument in Haskell", "body": "<p>I intend to use the return type of the third argument of <code>withResponse</code> for another function <code>brRead</code>. I get this error:</p>\n\n<blockquote>\n  <p>parse error on input `)' Failed, modules loaded: none.</p>\n</blockquote>\n\n<p>From the following code(using <a href=\"https://hackage.haskell.org/package/http-client-0.4.28/docs/Network-HTTP-Client.html\" rel=\"nofollow\">Network.HTTP.Client</a>):</p>\n\n<pre><code>startOn url = do\n    man &lt;- newManager defaultManagerSettings\n    req &lt;- parseUrl url\n    withResponse req man (let x = return (withResponse req man))\n    brRead x\n    return $ read\n</code></pre>\n\n<p>Any ideas?</p>\n"}, {"tags": ["haskell", "yesod", "hamlet", "shakespeare-text"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1461121293, "post_id": 36732907, "comment_id": 61049518, "body": "Include the precise code which gives you the error, as well as the error itself."}, {"owner": {"reputation": 423, "user_id": 2653131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5223eb44abc331b45762a01c7e67f02?s=128&d=identicon&r=PG", "display_name": "jnes", "link": "https://stackoverflow.com/users/2653131/jnes"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1461122045, "post_id": 36732907, "comment_id": 61049719, "body": "I am not asking you to help me fix a compile error, I am asking for suggestions or ideas on how I could go about to pass fields of <code>[Map Text HamletData]</code> or other datatype. Possibly I could work something out with list of lists but its not the best solution"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1461125479, "post_id": 36732907, "comment_id": 61050587, "body": "You&#39;ve mentioned that you found a potential solution but it gave you an error. Instead of asking someone to find a solution for you, you should ask them to help you with your attempt."}], "owner": {"reputation": 423, "user_id": 2653131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a5223eb44abc331b45762a01c7e67f02?s=128&d=identicon&r=PG", "display_name": "jnes", "link": "https://stackoverflow.com/users/2653131/jnes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 25, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1461120383, "creation_date": 1461120383, "question_id": 36732907, "link": "https://stackoverflow.com/questions/36732907/text-hamlet-runtime-nesting-hamletdata", "title": "Text.Hamlet.Runtime - nesting HamletData?", "body": "<p>I am rendering Hamlet templates using the Runtime module. The following works as promised with the example data:</p>\n\n<pre><code>let hamletDataMap = Map.fromList\n  [ (\"name\", \"Michael\")\n  , (\"hungry\", toHamletData True) -- always True\n  , (\"foods\", toHamletData\n    [ \"Apples\"\n    , \"Bananas\"\n    , \"Carrots\"\n    ])\n  ]\n</code></pre>\n\n<p>But I can't see any way for me to render nested data. For instance if I have a list of metadata of various fruits, I would like to do something like:</p>\n\n<pre><code>let hamletDataMap = Map.fromList\n  [ (\"name\", \"Michael\")\n  , (\"hungry\", toHamletData True) -- always True\n  , (\"fruits\", toHamletData\n    [ [ (\"name\", \"apple\")\n      , (\"taste\", \"sour\")\n      ]\n    , [ (\"name\", \"..\")\n      , (\"taste\", \"...\")\n      ]\n    ])\n  ] \n</code></pre>\n\n<p>In the <code>Text.Hamlet.RT</code> there is the <code>HDList [HamletMap]</code> which looks kindof strange but still promising. I can creates instances of <code>HDList</code> but it gives me type mismatch <code>HamletData</code> with actual type <code>RT.HamletData url0</code>.</p>\n\n<p>I'm thankful for any ideas or suggestions. </p>\n"}, {"tags": ["haskell", "redirect", "haskell-warp", "servant"], "answers": [{"comments": [{"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "reply_to_user": {"reputation": 145, "user_id": 6207699, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb172b885ff17a03b2969a9339d4a0a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jushiti", "link": "https://stackoverflow.com/users/6207699/jushiti"}, "edited": false, "score": 0, "creation_date": 1461134032, "post_id": 36733209, "comment_id": 61053987, "body": "You can look at <code>req</code> and decide however you want if and where you want to redirect."}, {"owner": {"reputation": 145, "user_id": 6207699, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb172b885ff17a03b2969a9339d4a0a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jushiti", "link": "https://stackoverflow.com/users/6207699/jushiti"}, "edited": false, "score": 0, "creation_date": 1461134400, "post_id": 36733209, "comment_id": 61054178, "body": "since on localhost I don&#39;t have &quot;www&quot; in a request, on localhost I can&#39;t debug it, can it? I need it because I don&#39;t know exactly what&#39;s inside a request and how &quot;www&quot; is represented."}], "tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": false, "score": 1, "last_activity_date": 1461290128, "last_edit_date": 1461290128, "creation_date": 1461122329, "answer_id": 36733209, "question_id": 36732299, "link": "https://stackoverflow.com/questions/36732299/how-to-redirect-requests-from-domain-com-to-www-domain-in-wai-warp-app/36733209#36733209", "title": "How to redirect requests from domain.com to www.domain in Wai/Warp app?", "body": "<p>The package <a href=\"https://hackage.haskell.org/package/wai-util-0.8\" rel=\"nofollow\"><code>wai-util</code></a> has a convenience function <a href=\"https://hackage.haskell.org/package/wai-util-0.8/docs/Network-Wai-Util.html#v:redirect-39-\" rel=\"nofollow\"><code>redirect'</code></a> to create such a <code>Response</code>, so you should be able to do something like</p>\n\n<pre><code>app :: Application\napp req respond = respond =&lt;&lt; redirect' status302 [] uri\n  where\n    Just uri = parseURI \"http://example.com/\"\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 6207699, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb172b885ff17a03b2969a9339d4a0a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jushiti", "link": "https://stackoverflow.com/users/6207699/jushiti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 431, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461290128, "creation_date": 1461115893, "last_edit_date": 1461129194, "question_id": 36732299, "link": "https://stackoverflow.com/questions/36732299/how-to-redirect-requests-from-domain-com-to-www-domain-in-wai-warp-app", "title": "How to redirect requests from domain.com to www.domain in Wai/Warp app?", "body": "<p>My site is built in Haskell/Servant and Wai/Warp. I need to redirect all requests from my <code>domain.com</code> to <code>www.domain.com</code> with the the 301 or 302 status.  I know I can do that with the help of Wai/Warp somehow. How exactly?</p>\n\n<pre><code>startApp :: IO ()\nstartApp = run 1234 app\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1461116308, "post_id": 36732210, "comment_id": 61048265, "body": "<code>f . g . h = f . (g . h) = \\x -&gt; f (g (h x))</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1426, "user_id": 417377, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1aa2c99d2089ac6753753db614b2ff1a?s=128&d=identicon&r=PG", "display_name": "Martin Capodici", "link": "https://stackoverflow.com/users/417377/martin-capodici"}, "is_accepted": true, "score": 8, "last_activity_date": 1503491297, "last_edit_date": 1503491297, "creation_date": 1461116000, "answer_id": 36732322, "question_id": 36732210, "link": "https://stackoverflow.com/questions/36732210/what-does-the-dot-and-plus-operator-mean/36732322#36732322", "title": "What does the dot and plus operator mean?", "body": "<p>First thing to notice is there are 3 functions composed together, and will be composed in this order:</p>\n\n<pre><code>1. ord\n2. (+ offset)\n3. chr\n</code></pre>\n\n<p>The first converts a character to a number. The second will add an offset to a number. The third will convert a number back to a character. Chained together they act as follow in an imperative style:</p>\n\n<pre><code>function encodeChar(int ord)\n{\n    x = ord\n    y = x + offset\n    z = chr y\n    return z\n}\n</code></pre>\n\n<p>The <code>(+ offset)</code> notiation gives a function because <code>+</code> takes two arguments and one is being applied. The other is yet to be applied. So you get an <code>Int -&gt; Int</code> function.</p>\n\n<p>The three functions composed give a function that takes a <code>Char</code> and returns a <code>Char</code> and can therefore be mapped to a list of <code>Char</code>s, i.e. a <code>String</code>.</p>\n"}], "owner": {"reputation": 139, "user_id": 5500643, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/917c902851b09bf9265a55ad35df9cfd?s=128&d=identicon&r=PG&f=1", "display_name": "heyyo", "link": "https://stackoverflow.com/users/5500643/heyyo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 36732322, "answer_count": 1, "score": 0, "last_activity_date": 1503491297, "creation_date": 1461115222, "last_edit_date": 1461118041, "question_id": 36732210, "link": "https://stackoverflow.com/questions/36732210/what-does-the-dot-and-plus-operator-mean", "title": "What does the dot and plus operator mean?", "body": "<p>I tried googling it but I couldn't find a simple explanation. Can someone explain how this function works?</p>\n\n<pre><code>import Data.Char\n\nencode :: Int -&gt; String -&gt; String\nencode offset msg = map (chr . (+ offset) . ord) msg\n</code></pre>\n\n<p>I understand that it's mapping the <code>(chr . (+ offset) . ord)</code> function to <code>msg</code>, but what is happening inside <code>(chr . (+ offset) . ord)</code>. </p>\n"}, {"tags": ["haskell", "events"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1461110494, "post_id": 36731014, "comment_id": 61046784, "body": "If you decide to use <a href=\"https://hackage.haskell.org/package/async\" rel=\"nofollow noreferrer\"><code>async</code></a> then  <a href=\"https://hackage.haskell.org/package/async-2.1.0/docs/Control-Concurrent-Async.html#waitAny\" rel=\"nofollow noreferrer\"><code>waitAny</code></a> might be what you want."}, {"owner": {"reputation": 1346, "user_id": 2774342, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a44003ae0b1ac699630fa5c54f1f0966?s=128&d=identicon&r=PG&f=1", "display_name": "dani24", "link": "https://stackoverflow.com/users/2774342/dani24"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1461123109, "post_id": 36731014, "comment_id": 61049977, "body": "@Wagner I want an example, and not just a clarification (as it is answered in the &quot;duplicated&quot; question). I think the Alec&#39;s comment is worth for me, But should I use like a <code>(a, b, ...) &lt;- concurrently getFirstEvent getSecondEvent ...</code> and then check if one of those is instanced or what ?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1461124580, "post_id": 36731014, "comment_id": 61050391, "body": "If you just want to wait for one of either of those occurrences (so you are waiting for exactly one of <code>getChar</code> or <code>getSomethingFromSocket</code>) you can use <a href=\"https://hackage.haskell.org/package/async-2.1.0/docs/Control-Concurrent-Async.html#v:race\" rel=\"nofollow noreferrer\"><code>race</code></a>. Definitely not <code>concurrently</code>, since that will block until BOTH (not either) events occur."}], "owner": {"reputation": 1346, "user_id": 2774342, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a44003ae0b1ac699630fa5c54f1f0966?s=128&d=identicon&r=PG&f=1", "display_name": "dani24", "link": "https://stackoverflow.com/users/2774342/dani24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "closed_date": 1461109048, "answer_count": 0, "score": 0, "last_activity_date": 1461107331, "creation_date": 1461107331, "question_id": 36731014, "link": "https://stackoverflow.com/questions/36731014/haskell-wait-for-the-first-event-no-busy-waiting", "closed_reason": "Duplicate", "title": "Haskell - wait for the first event (no busy waiting)", "body": "<p>I wanted to have in Haskell a very simple code in which events are handled.</p>\n\n<p>For instance, I'm looking for something like this:</p>\n\n<pre><code>main = do\n    firstEvent &lt;- waitForEvent\n    -- Do Something with that... --\n\nwaitForEvent = do\n    letter &lt;- getChar\n    OR\n    sth &lt;- getSomethingFromSocket\n    OR\n    -- etc --\n</code></pre>\n\n<p>I wanted to get the first event that take place without the 'busy waiting'.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 333, "user_id": 6009572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7899bee63fefec4974ebc4e92809e695?s=128&d=identicon&r=PG&f=1", "display_name": "w13rfed", "link": "https://stackoverflow.com/users/6009572/w13rfed"}, "edited": false, "score": 0, "creation_date": 1461103654, "post_id": 36729884, "comment_id": 61044465, "body": "I&#39;ve not used the (l:ls) notation before, if I entered a list of [&quot;first&quot;,&quot;second&quot;,&quot;third&quot;] how would I use &#39;l&#39;  to get the last two strings because &#39;ls&#39; is a list and &#39;l&#39; refers to the first string in the list doesn&#39;t it?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1461124348, "post_id": 36729884, "comment_id": 61050324, "body": "Another good one: <code>intercalate</code>, which easily generalizes <code>unwords</code> and <code>unlines</code>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 333, "user_id": 6009572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7899bee63fefec4974ebc4e92809e695?s=128&d=identicon&r=PG&f=1", "display_name": "w13rfed", "link": "https://stackoverflow.com/users/6009572/w13rfed"}, "edited": false, "score": 0, "creation_date": 1461146167, "post_id": 36729884, "comment_id": 61062380, "body": "@W22: right. That&#39;s why you do a recursive call on <code>ls</code>: in one of these calls, any line will be the <code>l</code> once!"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 3, "last_activity_date": 1461101593, "creation_date": 1461101593, "answer_id": 36729884, "question_id": 36729614, "link": "https://stackoverflow.com/questions/36729614/list-of-strings-to-single-string/36729884#36729884", "title": "List of Strings to single String", "body": "<p>A <code>String</code> is nothing but a list of characters:</p>\n\n<pre><code>type String = [Char]\n</code></pre>\n\n<p>Hence,</p>\n\n<pre><code>onSeperateLines :: [[Char]] -&gt; [Char]\n</code></pre>\n\n<p>Now, if you actually need this for some application, it's a good idea to first <a href=\"https://www.haskell.org/hoogle/?hoogle=[[Char]]+-%3E+[Char]\" rel=\"nofollow\">ask Hoogle if there's already something there</a>. You get a whole lot of results:</p>\n\n<blockquote>\n  <p><code>unlines :: [String] -&gt; String</code> -- that's <em>exactly</em> the function you're trying to implement!<br>\n  <code>unwords :: [String] -&gt; String</code> -- similar, but only insert spaces, not newlines<br>\n  <code>joinPath :: [FilePath] -&gt; FilePath</code> -- Not relevant here<br>\n  <code>concat :: [[a]] -&gt; [a]</code> -- this does the general task of flattening a nested list to a simple one like a string.</p>\n</blockquote>\n\n<p><code>concat</code> is a good choice if you don't just want to use a standard function for the specific task, but also don't want to make life more difficult than necessary.</p>\n\n<p>Of course, it also can't hurt to write a function like that once <em>completely</em> by yourself. To do that, you'll need to recursively<sup>&dagger;</sup> <em>deconstruct a list</em>. This is extremely simple thanks to pattern matching:</p>\n\n<pre><code>onSeperateLines [] = ... --- no lines to concatenate... what's the result?\nonSeperateLines (l:ls) = ...\n where otherLines = onSeperateLines ls\n</code></pre>\n\n<p>Think a little about what goes in these gaps.</p>\n\n<hr>\n\n<p><sup>&dagger;</sup><sub>The equivalent solution with <code>foldr</code> is also a good excercise.</sub></p>\n"}], "owner": {"reputation": 333, "user_id": 6009572, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7899bee63fefec4974ebc4e92809e695?s=128&d=identicon&r=PG&f=1", "display_name": "w13rfed", "link": "https://stackoverflow.com/users/6009572/w13rfed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2092, "favorite_count": 0, "accepted_answer_id": 36729884, "answer_count": 1, "score": -1, "last_activity_date": 1461128864, "creation_date": 1461100512, "last_edit_date": 1461100656, "question_id": 36729614, "link": "https://stackoverflow.com/questions/36729614/list-of-strings-to-single-string", "title": "List of Strings to single String", "body": "<p>I'm trying to do this exercise in a book, </p>\n\n<p>Define a function:</p>\n\n<pre><code>onSeperateLines :: [String] -&gt; String\n</code></pre>\n\n<p>which takes a list of string and returns a single string which when printed shows the strings on separate lines.</p>\n\n<p>I'm struggling with converting a list to a single string</p>\n\n<pre><code>onSeperateLines :: [String] -&gt; String\nonSeperateLines ls = [x | x &lt;- ls]\n</code></pre>\n\n<p>I can write functions that take a String and convert it to a list and also a list that outputs a list, but I can't figure out how to take a list and convert it to a single string.</p>\n"}, {"tags": ["haskell", "haskell-lens"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1461099128, "post_id": 36729034, "comment_id": 61042370, "body": "I don&#39;t know if the lens package can derive such an instance, but you can just write it yourself: <code>instance HasFruit Fruits where fruit k (Banana x f) = Banana x &lt;$&gt; k f ; fruit k (Strawberry x f) = Strawberry x &lt;$&gt; k f</code>. It should be noted that <code>Banana</code> and <code>Strawberry</code> are <i>not</i> types - and cannot be made instances of classes because they are not types. They are constructors which return a value of type <code>Fruit</code>."}], "answers": [{"tags": [], "owner": {"reputation": 715, "user_id": 4883127, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/428914dd1ba6786d9242170f4bbce2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Hardy", "link": "https://stackoverflow.com/users/4883127/bradley-hardy"}, "is_accepted": false, "score": 1, "last_activity_date": 1461104784, "creation_date": 1461104784, "answer_id": 36730583, "question_id": 36729034, "link": "https://stackoverflow.com/questions/36729034/lenses-with-sum-types-that-have-product-types/36730583#36730583", "title": "Lenses with Sum Types (that have Product types)", "body": "<p>It would make more sense to do something like this:</p>\n\n<pre><code>data FruitType = Banana Int | Strawberry String\n\ndata Fruits = Fruits { _fruitsFruitType :: FruitType, _fruitsFruit :: Fruit }\n\nmakeFields ''Fruits\n\n-- `Fruits` now instantiates `HasFruit`\n</code></pre>\n\n<p>You might also want to make prisms for <code>FruitType</code>. Prisms are essentially traversals into different parts of a sum type, except they can also be used to construct it.</p>\n\n<pre><code>makePrisms ''FruitType\n\n-- double the int if the argument is a `Banana`\n\ndoubleBanana = fruitType._Banana *~ 2\n</code></pre>\n"}], "owner": {"reputation": 211, "user_id": 4589460, "user_type": "registered", "accept_rate": 0, "profile_image": "https://lh6.googleusercontent.com/-vDj0ltaGLZU/AAAAAAAAAAI/AAAAAAAAEeU/zGlq69ZIPyI/photo.jpg?sz=128", "display_name": "Mark Fine", "link": "https://stackoverflow.com/users/4589460/mark-fine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 486, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1461104784, "creation_date": 1461098515, "question_id": 36729034, "link": "https://stackoverflow.com/questions/36729034/lenses-with-sum-types-that-have-product-types", "title": "Lenses with Sum Types (that have Product types)", "body": "<pre><code>{-# LANGUAGE TemplateHaskell      #-}\n\nimport Control.Lens\n\ndata Fruit = Fruit\n  { _fruitColor :: String\n  }\n\n$(makeClassy ''Fruit)\n\ndata Fruits =\n    Banana Int Fruit\n  | Strawberry String Fruit\n\nprinter :: HasFruit s =&gt; s -&gt; IO ()\nprinter f = putStrLn $ f ^. fruitColor\n\nsample :: IO ()\nsample = do\n  printer $ Fruit \"yellow\"\n  printer $ Banana 5 $ Fruit \"yellow\"\n</code></pre>\n\n<p>I have a core product type, Fruit. I want to have data types that all contain the core product type, Fruit, but want to be able to have them represented by a sum type, Fruits. Using the sum type, Fruits, I'd like to be able to access components of the core product type, Fruit. Namely, I'd like types like Banana and Strawberry to be an instance of HasFruit.</p>\n\n<p>Is there a straightforward way to have Fruits instantiate HasFruit? Is there a better pattern to represent this - core product type in a sum type?</p>\n"}, {"tags": ["haskell", "io", "monads"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1461098695, "post_id": 36729022, "comment_id": 61042091, "body": "You don&#39;t &#39;unwrap&#39; this type - you can &#39;unwrap&#39; things like <code>Identity</code> and <code>ErrorT</code> because they are simply newtypes for other types."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "edited": false, "score": 0, "creation_date": 1461099072, "post_id": 36729084, "comment_id": 61042334, "body": "<code>fmap (+1) (IO 1)</code> give error: no constructor for <code>IO</code>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1461099144, "post_id": 36729084, "comment_id": 61042377, "body": "@HaskellFun You may teach pure values how to be <code>IO</code>-like with <code>return :: a -&gt; IO a</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "edited": false, "score": 0, "creation_date": 1461099371, "post_id": 36729084, "comment_id": 61042518, "body": "It doesn&#39;t help me"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1461099412, "post_id": 36729084, "comment_id": 61042540, "body": "@HaskellFun You&#39;ll have to say a bit more than that if you want help. Why didn&#39;t it help you? What did you try? What went wrong?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "edited": false, "score": 0, "creation_date": 1461099540, "post_id": 36729084, "comment_id": 61042611, "body": "I would like to be able following thing:   <code>fmap (+1) (IO 21) = (IO 22)</code>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1461099596, "post_id": 36729084, "comment_id": 61042640, "body": "@HaskellFun As suggested in my previous comment: use <code>return</code>, as in <code>fmap (+1) (return 21)</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "edited": false, "score": 0, "creation_date": 1461099741, "post_id": 36729084, "comment_id": 61042729, "body": "Ok, is it possible to use <code>&gt;&gt;=</code> instead of do to wrap value from <code>IO</code> ?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1461099854, "post_id": 36729084, "comment_id": 61042785, "body": "@HaskellFun Yes, <code>do</code>-notation is desugared to calls to <code>(&gt;&gt;=)</code> and <code>return</code>. See <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-470003.14\" rel=\"nofollow noreferrer\">the Report</a> for details, and recall the definition <code>m1 &gt;&gt; m2 = m1 &gt;&gt;= \\_ -&gt; m2</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "edited": false, "score": 0, "creation_date": 1461100279, "post_id": 36729084, "comment_id": 61042991, "body": "How to use <code>fmap</code> ?  I know that I unwrap on Right element closed in IO monad ? I mean: <code>fmap (+11) (IO (Right 12)) = IO (Right 23)</code>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1461104858, "post_id": 36729084, "comment_id": 61044937, "body": "@HaskellFun I encourage you to open a fresh top-level thread if you have further questions. Also note that <code>IO</code> is a type constructor, but there is <i>no</i> term constructor named <code>IO</code> -- so <code>IO (Right 12)</code> is not a good mental model to hold. Do follow through with the proposed further reading; I think it will clear up many of your misconceptions."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 3, "last_activity_date": 1461099118, "last_edit_date": 1461099118, "creation_date": 1461098674, "answer_id": 36729084, "question_id": 36729022, "link": "https://stackoverflow.com/questions/36729022/haskell-how-to-unwrap-io-monad/36729084#36729084", "title": "haskell, how to unwrap IO monad", "body": "<p>You do not unwrap <code>IO a</code> actions. Instead, you include them in the <code>main</code> action (which has an <code>IO</code> type, hence can use such actions) and the compiler ensures that <code>main</code> is executed.</p>\n\n<p>You may also teach functions that do not understand <code>IO</code> how to handle <code>IO</code>; for example, we have:</p>\n\n<pre><code>fmap  :: (a -&gt;    b) -&gt; IO a -&gt; IO b\n(=&lt;&lt;) :: (a -&gt; IO b) -&gt; IO a -&gt; IO b\n</code></pre>\n\n<p>Thus if you have a function which consumes an <code>Either String Int</code>, you may use one of the above functions to teach it how to consume an <code>IO (Either String Int)</code> instead.</p>\n\n<p>For further reading, you may enjoy <a href=\"http://blog.sigfpe.com/2007/11/io-monad-for-people-who-simply-dont.html\" rel=\"nofollow\">The IO Monad for People Who Simply Don't Care</a>. (I also like the monad tutorials <a href=\"http://blog.sigfpe.com/2006/08/you-could-have-invented-monads-and.html\" rel=\"nofollow\">You Could Have Invented Monads! (And Maybe You Already Have.)</a> and <a href=\"https://wiki.haskell.org/All_About_Monads\" rel=\"nofollow\">All About Monads</a>, though they are less directly relevant to this question.)</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1579, "favorite_count": 0, "closed_date": 1461098868, "accepted_answer_id": 36729084, "answer_count": 1, "score": 0, "last_activity_date": 1461099118, "creation_date": 1461098479, "question_id": 36729022, "link": "https://stackoverflow.com/questions/36729022/haskell-how-to-unwrap-io-monad", "closed_reason": "Duplicate", "title": "haskell, how to unwrap IO monad", "body": "<p>I can do:  <code>runIdentity</code>, <code>runErrorT</code> and more to unwrap inner monad.<br>\nHowever, What should I do in case of <code>IO (Either String Int)</code>  ? How to unwrap it ?  </p>\n"}, {"tags": ["class", "haskell", "types"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1461098160, "post_id": 36728690, "comment_id": 61041783, "body": "You have not defined any functions in the <code>class</code> declaration."}], "answers": [{"comments": [{"owner": {"reputation": 111, "user_id": 6070958, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/267b9e19e33143b759550c8dbaf9e5a8?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/6070958/vlad"}, "edited": false, "score": 0, "creation_date": 1461100110, "post_id": 36729021, "comment_id": 61042912, "body": "Thanks. The code is working perfectly fine, but now, when I am trying to run fromCoeffs [1,2,3,5] I get this error message: &lt;interactive&gt;:176:1:     No instance for (Num a0) arising from a use of \u2018it\u2019     The type variable \u2018a0\u2019 is ambiguous     Note: there are several potential instances:       instance Integral a =&gt; Num (GHC.Real.Ratio a)         -- Defined in \u2018GHC.Real\u2019        instance Num Integer -- Defined in \u2018GHC.Num\u2019       instance Num Double -- Defined in \u2018GHC.Float\u2019       ...plus three others     In the first argument of \u2018print\u2019, namely \u2018it\u2019"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 111, "user_id": 6070958, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/267b9e19e33143b759550c8dbaf9e5a8?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/6070958/vlad"}, "edited": false, "score": 0, "creation_date": 1461100231, "post_id": 36729021, "comment_id": 61042961, "body": "@Vlad Give it a type signature, as in <code>fromCoeffs [1,2,3,5] :: PolyA Int</code> or <code>fromCoeffs [1,2,3,5] :: PolyB Double</code>."}, {"owner": {"reputation": 111, "user_id": 6070958, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/267b9e19e33143b759550c8dbaf9e5a8?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/6070958/vlad"}, "edited": false, "score": 0, "creation_date": 1461100396, "post_id": 36729021, "comment_id": 61043048, "body": "Ok, Fair enough. Thanks so much for that! I programmed in Haskell for a year, but still don&#39;t know every little aspect of it. Thanks loads for your help mate!"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 1, "last_activity_date": 1461098477, "creation_date": 1461098477, "answer_id": 36729021, "question_id": 36728690, "link": "https://stackoverflow.com/questions/36728690/haskell-type-class-instantiation/36729021#36729021", "title": "Haskell type class instantiation", "body": "<p>The following code compiles for me:</p>\n\n<pre><code>class Polynomial p where\n  coeffs :: p a -&gt; [a]\n  fromCoeffs :: [a] -&gt; p a\n\n--default implementations\ndata PolyA a = Coeffs [a]\n           deriving (Show)\ndata PolyB a = Const a | X (PolyB a) a\n           deriving (Show)\n\n--instances\ninstance Polynomial PolyA where\n    coeffs (Coeffs f)=f\n    fromCoeffs f= Coeffs f\n\ninstance Polynomial PolyB where\n coeffs (Const f)= [f]\n coeffs (X f a)= coeffs f ++ [a]\n fromCoeffs [] = error \"Wrong Input!\"\n fromCoeffs [f]= Const f\n fromCoeffs lis@(_:t)= X (fromCoeffs (init lis)) (last lis)\n</code></pre>\n\n<p>Summary of changes:</p>\n\n<ul>\n<li>Add methods to the <code>Polynomial</code> class declaration.</li>\n<li>Remove the type arguments in the instance declarations.</li>\n<li>Change <code>coeffsB</code> to <code>coeffs</code> and <code>fromCoeffsB</code> to <code>fromCoeffs</code> everywhere.</li>\n<li>Outdent the <code>PolyB</code> instance declaration by one space.</li>\n</ul>\n"}], "owner": {"reputation": 111, "user_id": 6070958, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/267b9e19e33143b759550c8dbaf9e5a8?s=128&d=identicon&r=PG&f=1", "display_name": "Vlad", "link": "https://stackoverflow.com/users/6070958/vlad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1461098477, "creation_date": 1461097364, "question_id": 36728690, "link": "https://stackoverflow.com/questions/36728690/haskell-type-class-instantiation", "title": "Haskell type class instantiation", "body": "<p>I am trying to set (PolyA a) and (PolyB a) to be instances of class Polynomial, where I want to implement coeffs, fromCoeffs, coeffsB, fromCoeffsB. I am not quite sure what am I doing wrong, because I receive an error message saying that my functions are not visible to the class Polynomial. Any help please?</p>\n\n<pre><code>class Polynomial p where\n\n--default implementations\ndata PolyA a = Coeffs [a]\n           deriving (Show)\ndata PolyB a = Const a | X (PolyB a) a\n           deriving (Show)\n\n--instances\ninstance Polynomial (PolyA a) where\n    coeffs (Coeffs f)=f\n    fromCoeffs f= Coeffs f\n\n instance Polynomial (PolyB a) where\n coeffsB (Const f)= [f]\n coeffsB (X f a)= coeffsB f ++ [a]\n fromCoeffsB [] = error \"Wrong Input!\"\n fromCoeffsB [f]= Const f\n fromCoeffsB lis@(_:t)= X (fromCoeffsB (init lis)) (last lis)\n</code></pre>\n"}, {"tags": ["haskell", "yesod", "servant"], "comments": [{"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1461360717, "post_id": 36727794, "comment_id": 61181189, "body": "I&#39;m afraid we need a more minimal testcase. Could you post an example that doesn&#39;t use <code>Handler</code> or <code>runDB</code>? Those seem like functions that you wrote. (Psychically, though, I am guessing that you&#39;re missing constraints on <code>getTable</code>. If you look at <code>selectList</code>, you&#39;ll see that the return values are constrained not only by <code>MonadIO</code> but the rather complicated <code>PersistEntity val, PersistQuery backend, PersistEntityBackend val ~ backend</code> \u2013 although if you&#39;re just doing SQL you can abbreviate the last two to just <code>ToBackendKey SqlBackend val</code>.)"}], "owner": {"reputation": 71, "user_id": 3550758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd786a4db46ac35360b1447054d859d0?s=128&d=identicon&r=PG&f=1", "display_name": "user3550758", "link": "https://stackoverflow.com/users/3550758/user3550758"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1461094394, "creation_date": 1461094394, "question_id": 36727794, "link": "https://stackoverflow.com/questions/36727794/haskell-persistent-reusing-selectlist", "title": "Haskell/Persistent: Reusing &quot;selectList&quot;", "body": "<p>I am trying to write an API in Servant and I am writing a lot of handlers that look like this:</p>\n\n<pre><code>getTableA :: Handler [ARecord]\ngetTableA = do\n    xs &lt;- runDB (selectList [] [])\n    let records = map (\\(Entity _ v) -&gt; v) xs\n    return records\n\ngetTableB :: Handler [BRecord]\ngetTableB = do\n    xs &lt;- runDB (selectList [] [])\n    let records = map (\\(Entity _ v) -&gt; v) xs\n    return records\n\ngetTableC :: Handler [CRecord]\ngetTableC = do\n    xs &lt;- runDB (selectList [] [])\n    let records = map (\\(Entity _ v) -&gt; v) xs\n    return records\n</code></pre>\n\n<p>And so on.</p>\n\n<p>I want to be able to have something more like</p>\n\n<pre><code>getTable :: Handler [a]\ngetTable = do\n    xs &lt;- runDB (selectList [] [])\n    let records = map (\\(Entity _ v) -&gt; v) xs\n    return records\n</code></pre>\n\n<p>However I get the error</p>\n\n<pre><code>Couldn't match expected type \u2018SqlBackend\u2019\n            with actual type \u2018PersistEntityBackend val\u2019\nRelevant bindings include\n  getAll :: Handler [val] (bound at src/Novation/Handler.hs:101:1)\nIn the first argument of \u2018runDB\u2019, namely \u2018(selectList [] [])\u2019\nIn a stmt of a 'do' block: xs &lt;- runDB (selectList [] [])\nIn the expression:\n  do { xs &lt;- runDB (selectList [] []);\n       let records = map (\\ (Entity _ v) -&gt; ...) xs;\n       return records }\n</code></pre>\n\n<p>I am hoping that in the end I'll be able to have something like this</p>\n\n<pre><code>server :: Server MyAPI\nserver = getTable :&lt;|&gt; getTable :&lt;|&gt; getTable\n\ntype MyAPI = \n         \"tableA\" :&gt; Get '[JSON] [ARecord]\n    :&lt;|&gt; \"tableB\" :&gt; Get '[JSON] [BRecord]\n    :&lt;|&gt; \"tableC\" :&gt; Get '[JSON] [CRecord]\n</code></pre>\n\n<p>Instead of</p>\n\n<pre><code>server :: Server MyAPI\nserver = getTableA :&lt;|&gt; getTableB :&lt;|&gt; getTableC\n</code></pre>\n"}, {"tags": ["haskell", "profiling", "ghc"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1461092234, "post_id": 36726811, "comment_id": 61038175, "body": "&quot;Furthermore the fields GC time and total memory use are missing&quot; No they aren&#39;t"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1461092306, "post_id": 36726811, "comment_id": 61038225, "body": "Maybe it&#39;s just a matter of e.g. whether GC happened to happen once or twice? Is your program running for a very brief period?"}, {"owner": {"reputation": 1795, "user_id": 1839343, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b26d97dd045ce61904e7c6d1a9775e0c?s=128&d=identicon&r=PG", "display_name": "jules", "link": "https://stackoverflow.com/users/1839343/jules"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1461094869, "post_id": 36726811, "comment_id": 61039796, "body": "@jberryman Yes, it&#39;s only running for a very short time ... why is garbage collection not deterministic in that case?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1461172017, "post_id": 36726811, "comment_id": 61081781, "body": "It may not be the garbage collection that is non-deterministic, but the profiling. All the allocation numbers are precisely identical for both runs (for which the profiler presumably has exact statistics) but I&#39;ve never seen identical times from two differents runs of a program in the profiler. <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/runtime-control.html#rts-options-misc\" rel=\"nofollow noreferrer\">&quot;Disabling the interval timer is useful for debugging, because it eliminates a source of non-determinism at runtime.&quot;</a>"}], "owner": {"reputation": 1795, "user_id": 1839343, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/b26d97dd045ce61904e7c6d1a9775e0c?s=128&d=identicon&r=PG", "display_name": "jules", "link": "https://stackoverflow.com/users/1839343/jules"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1461094990, "creation_date": 1461091165, "last_edit_date": 1461094990, "question_id": 36726811, "link": "https://stackoverflow.com/questions/36726811/strong-variations-in-runtime-statistics-when-profiling-program-with-ghc-rts", "title": "Strong variations in runtime statistics when profiling program with ghc RTS", "body": "<p>I'm trying to profile my program. I compiled it with</p>\n\n<pre><code>stack build --executable-profiling --library-profiling --ghc-options=\" -fprof-auto -rtsopts=all -caf-all\"\n</code></pre>\n\n<p>When running the program there are strong variations within the runtime statistics:</p>\n\n<pre><code>./example +RTS -s -sstderr\n\n      68,183,336 bytes allocated in the heap\n       7,520,984 bytes copied during GC\n         573,296 bytes maximum residency (5 sample(s))\n          34,728 bytes maximum slop\n               3 MB total memory in use (0 MB lost due to fragmentation)\n\n                                 Tot time (elapsed)  Avg pause  Max pause\n  Gen  0       127 colls,     0 par    0.020s   0.007s     0.0001s    0.0004s\n  Gen  1         5 colls,     0 par    0.000s   0.002s     0.0005s    0.0007s\n\n  TASKS: 4 (1 bound, 3 peak workers (3 total), using -N1)\n\n  SPARKS: 0 (0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)\n\n  INIT    time    0.000s  (  0.002s elapsed)\n  MUT     time    0.012s  (  0.026s elapsed)\n  GC      time    0.020s  (  0.010s elapsed)\n  RP      time    0.000s  (  0.000s elapsed)\n  PROF    time    0.000s  (  0.000s elapsed)\n  EXIT    time    0.000s  (  0.000s elapsed)\n  Total   time    0.032s  (  0.038s elapsed)\n\nAlloc rate    5,681,944,666 bytes per MUT second\n\nProductivity  37.5% of total user, 31.8% of total elapsed\n\ngc_alloc_block_sync: 0\nwhitehole_spin: 0\ngen[0].sync: 0\ngen[1].sync: 0\n</code></pre>\n\n<p>And the next run gives:</p>\n\n<pre><code>$ ./example +RTS -s -sstderr\n\n     68,183,336 bytes allocated in the heap\n      7,520,984 bytes copied during GC\n        573,296 bytes maximum residency (5 sample(s))\n         34,728 bytes maximum slop\n              3 MB total memory in use (0 MB lost due to fragmentation)\n\n                                 Tot time (elapsed)  Avg pause  Max pause\n  Gen  0       127 colls,     0 par    0.000s   0.007s     0.0001s    0.0002s\n  Gen  1         5 colls,     0 par    0.004s   0.002s     0.0004s    0.0006s\n\n  TASKS: 4 (1 bound, 3 peak workers (3 total), using -N1)\n\n  SPARKS: 0 (0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)\n\n  INIT    time    0.000s  (  0.002s elapsed)\n  MUT     time    0.024s  (  0.025s elapsed)\n  GC      time    0.004s  (  0.009s elapsed)\n  RP      time    0.000s  (  0.000s elapsed)\n  PROF    time    0.000s  (  0.000s elapsed)\n  EXIT    time    0.000s  (  0.000s elapsed)\n  Total   time    0.028s  (  0.036s elapsed)\n\nAlloc rate    2,840,972,333 bytes per MUT second\n\nProductivity  85.7% of total user, 67.5% of total elapsed\n\ngc_alloc_block_sync: 0\nwhitehole_spin: 0\ngen[0].sync: 0\ngen[1].sync: 0\n</code></pre>\n\n<p>The program was invoked in the exact same way (without being recompiled of course); yet the <code>Productivity</code> changes from 38% to over 85% and other values are totally different, too. <s>Furthermore the fields <code>GC time</code> and <code>total memory use</code> are missing</s> ... what am I doing wrong?</p>\n\n<p>Many thanks in advance!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 2, "creation_date": 1461089123, "post_id": 36726046, "comment_id": 61036161, "body": "What is <code>rp</code> supposed to do? If it is supposed to make a random list, you should probably pass in the desired length of the random list..."}, {"owner": {"reputation": 125, "user_id": 6041081, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e3d9256e6fdc97157bda8353f665e673?s=128&d=identicon&r=PG&f=1", "display_name": "Ionut Cosmin Mihai", "link": "https://stackoverflow.com/users/6041081/ionut-cosmin-mihai"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1461089182, "post_id": 36726046, "comment_id": 61036194, "body": "It suppose to end first of all. Isn&#39;t it?"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1461089723, "post_id": 36726046, "comment_id": 61036590, "body": "The first argument in your tuple is the infinite list <code>[1..]</code> hence my question about the length."}, {"owner": {"reputation": 125, "user_id": 6041081, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e3d9256e6fdc97157bda8353f665e673?s=128&d=identicon&r=PG&f=1", "display_name": "Ionut Cosmin Mihai", "link": "https://stackoverflow.com/users/6041081/ionut-cosmin-mihai"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1461089816, "post_id": 36726046, "comment_id": 61036652, "body": "I&#39;m using it with takeWhile, but I&#39;m sure that the stopping condition is good"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1461091504, "post_id": 36726046, "comment_id": 61037691, "body": "The first component is the infinite list <code>[1,1,1,1,...]</code> so <code>takeWhile</code> takes nothing or all of it."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1461091608, "post_id": 36726046, "comment_id": 61037765, "body": "By the way, <code>iterate id</code> is a bit unidiomatic: if you really want to repeat the same element <code>x</code> forever, use <code>repeat x</code>"}], "answers": [{"tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": true, "score": 5, "last_activity_date": 1461092487, "last_edit_date": 1461092487, "creation_date": 1461091945, "answer_id": 36727056, "question_id": 36726046, "link": "https://stackoverflow.com/questions/36726046/data-list-iterate-lazy-evaluation-not-happening/36727056#36727056", "title": "Data.List.iterate lazy evaluation not happening", "body": "<p>While I'm not exactly sure what you're trying to achieve with your function, the reason it doesn't stop is because you're mapping over an infinite list and giving it no reason <em>to</em> stop.</p>\n\n<p>The infinite list originates in your use of <code>iterate</code>:</p>\n\n\n\n<blockquote>\n  <p><code>lst = (Data.List.iterate id ([1], g_second))</code></p>\n</blockquote>\n\n<p>What you've done there is create an infinite list which contains an infinite number of the tuple value <code>([1], g_second)</code>. That seems like a logic error - that list of tuple has no variation; every element is the same, to infinity. To be clear, this list you are building looks like this:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>[([1], g_second), ([1], g_second), ([1], g_second), ([1], g_second)...]\n</code></pre>\n\n<p><code>g_second</code> is unchanging and never gets a reason to evaluate, so it is, in essence, discarded.</p>\n\n<p>If you were to use something like <code>take</code> or <code>takeWhile</code>, you could force that infinite list to stop and return a known number of elements. However, by using <code>map</code> in this statement:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>map (\\x -&gt; (last (fst x))) lst\n</code></pre>\n\n<p>All you are doing is pulling the value <code>1</code> out of the tuple and repeating it forever.</p>\n\n<p>And since you discard <code>g_second</code> and never use <code>g_first</code>, your function is equivalent to the following:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>rp :: RandomGen g =&gt; g -&gt; ([Int], g)\nrp g = (repeat 1 , snd (next g))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 2, "last_activity_date": 1461092544, "creation_date": 1461092544, "answer_id": 36727238, "question_id": 36726046, "link": "https://stackoverflow.com/questions/36726046/data-list-iterate-lazy-evaluation-not-happening/36727238#36727238", "title": "Data.List.iterate lazy evaluation not happening", "body": "<p>Assuming you want to generate an infinite list of random-numbers based on a <code>RandomGen g</code> then you can use <code>Data.List.unfold</code> as it fit's <code>next</code> nicely:</p>\n\n<pre><code>&gt; import System.Random\n&gt; import Data.List\n&gt; let rnds g = unfoldr (Just . next) g\n&gt; let rnds' = rnds (mkStdGen 0)\n&gt; take 3 rnds'\n[2147482884,2092764894,1390461064]\n</code></pre>\n\n<p>BTW: <strong>yes</strong> the final <code>g</code> is missing - but to get this you would have to generate the infinite list first ... which seems unlikely (<em>plus</em> it would not fit <code>unfoldr</code> as nicely ;))</p>\n"}], "owner": {"reputation": 125, "user_id": 6041081, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e3d9256e6fdc97157bda8353f665e673?s=128&d=identicon&r=PG&f=1", "display_name": "Ionut Cosmin Mihai", "link": "https://stackoverflow.com/users/6041081/ionut-cosmin-mihai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 36727056, "answer_count": 2, "score": 0, "last_activity_date": 1461092544, "creation_date": 1461088724, "question_id": 36726046, "link": "https://stackoverflow.com/questions/36726046/data-list-iterate-lazy-evaluation-not-happening", "title": "Data.List.iterate lazy evaluation not happening", "body": "<p>I'm having the above function, but when I call it, it gets stuck, the Data.List.iterate evaluates without stopping.</p>\n\n<pre><code>rp:: RandomGen g =&gt; g -&gt; ([Int], g)\nrp g = (map (\\x -&gt; (last (fst x))) lst , snd (next g))\n    where \n        lst = (Data.List.iterate id ([1], g_second))\n        (g_first, g_second) = (split g)\n</code></pre>\n\n<p>Why does that happend?</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1461084423, "post_id": 36724104, "comment_id": 61033477, "body": "Why <code>map fst</code> does not suit you? It precisely removes the context, and only that."}, {"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "edited": false, "score": 0, "creation_date": 1461084617, "post_id": 36724104, "comment_id": 61033589, "body": "<code>fst</code> does but return pair&#39;s left element. If it does not return what you expected then your pair computation is wrong."}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 10, "last_activity_date": 1461083086, "creation_date": 1461083086, "answer_id": 36724169, "question_id": 36724104, "link": "https://stackoverflow.com/questions/36724104/infinite-list-with-context-propagation/36724169#36724169", "title": "Infinite list with context propagation", "body": "<p>I think <code>unfoldr</code> is exactly what you want:</p>\n\n<pre><code>Prelude&gt; import Data.List(unfoldr)\nPrelude Data.List&gt; :t unfoldr\nunfoldr :: (b -&gt; Maybe (a, b)) -&gt; b -&gt; [a]\nPrelude Data.List&gt; let nrs = unfoldr (\\n -&gt; Just (n,n+1)) 1\nPrelude Data.List&gt; take 10 nrs\n[1,2,3,4,5,6,7,8,9,10]\n</code></pre>\n\n<p>it works like this:</p>\n\n<p>you have to give it a function which takes a state/context (the type <code>b</code> above) and either:</p>\n\n<ul>\n<li>returns <code>Just (output,newState)</code> if you want to go on</li>\n<li>return <code>Nothing</code> if you want to stop</li>\n</ul>\n\n<p>so if you always return <code>Just ...</code> you get an infinite list of <code>[output]</code>s</p>\n"}, {"comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461084146, "post_id": 36724382, "comment_id": 61033319, "body": "based on the OPs last comment I think he knows this but he kind of wants the <i>very last</i> element (the fixpoint ;)) of this list"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461084353, "post_id": 36724382, "comment_id": 61033435, "body": "@Carsten Oh, I missed that... But I don&#39;t understand it."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1461084237, "last_edit_date": 1461084237, "creation_date": 1461083790, "answer_id": 36724382, "question_id": 36724104, "link": "https://stackoverflow.com/questions/36724104/infinite-list-with-context-propagation/36724382#36724382", "title": "Infinite list with context propagation", "body": "<p>Update: I missed the <code>map fst</code> comment in the question, yet I can't see why it's not producing the expected result.</p>\n\n<hr>\n\n<p>You can use <code>iterate</code> and discard the context later:</p>\n\n<pre><code>iter :: ((a, context)-&gt;(a, context)) -&gt; (a, context) -&gt; [a]\niter f x = map fst $ iterate f x\n</code></pre>\n\n<p>Laziness makes the <code>map</code> not to be applied further than necessary. Just make sure that <code>fst . f</code> is strict in the <code>context</code> argument, so that this does not build up large thunks.</p>\n\n<p>It can also be used inline, since it's quite short:</p>\n\n<pre><code>&gt; take 15 $ map fst $ iterate (\\(a,b) -&gt; (b,a+b)) (0,1)\n[0,1,1,2,3,5,8,13,21,34,55,89,144,233,377]\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 6041081, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e3d9256e6fdc97157bda8353f665e673?s=128&d=identicon&r=PG&f=1", "display_name": "Ionut Cosmin Mihai", "link": "https://stackoverflow.com/users/6041081/ionut-cosmin-mihai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 36724169, "answer_count": 2, "score": 0, "last_activity_date": 1461084237, "creation_date": 1461082890, "last_edit_date": 1461083860, "question_id": 36724104, "link": "https://stackoverflow.com/questions/36724104/infinite-list-with-context-propagation", "title": "Infinite list with context propagation", "body": "<p>I want to build an infinite list, I tried using <code>Data.List.iterate</code>, but I need a context to be propagated (the context changes while propagated).</p>\n\n<p>The <code>Data.List.iterate</code> is of type <code>(a -&gt; a) -&gt; a -&gt; [a]</code></p>\n\n<p>I need something like <code>((a, context)-&gt;(a-&gt;context)) -&gt; (a, context) -&gt; [a]</code></p>\n\n<p>Until now I only obtained <code>[(a, context)]</code> and I can't do <code>map fst</code> because I will get something like <code>[1, 12, 123, 1234...]</code> instead of <code>[1, 2, 3, 4....]</code>.</p>\n"}, {"tags": ["file", "loops", "haskell", "matrix", "io"], "comments": [{"owner": {"reputation": 35932, "user_id": 76722, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4baed26d9b00bbc7c0c706515aeb596e?s=128&d=identicon&r=PG", "display_name": "Sebastian Mach", "link": "https://stackoverflow.com/users/76722/sebastian-mach"}, "edited": false, "score": 0, "creation_date": 1461081141, "post_id": 36723406, "comment_id": 61031283, "body": "I think your question is &quot;what&#39;s the Haskell equivalent of iteration&quot;."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 3, "creation_date": 1461081144, "post_id": 36723406, "comment_id": 61031284, "body": "in Haskell <b>what</b> you want to do is more important then how - so it&#39;s nice that you want to iterate but it does not help us answer your question - can you please give an example of your input and expected output and what you tried so far?"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 6225797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a5163f3890f09f9bda453398354b1ae?s=128&d=identicon&r=PG&f=1", "display_name": "fullmoon", "link": "https://stackoverflow.com/users/6225797/fullmoon"}, "edited": false, "score": 0, "creation_date": 1461195525, "post_id": 36724459, "comment_id": 61094015, "body": "Thank for all your answers, maybe i don&#39;t explain myself crearly, the thing is that I have a matrix in a file called &quot;matrix.txt&quot;, i have something like this: [[&quot;team;country;name;years&quot;],[&quot;X;X;X;N&quot;],[&quot;Team A;USA;Building A1;4.57&quot;],[&quot;Team B;COL;Building B2;9.32&quot;]...] What I need is how can I iterate every single element of this list, because I need to convert the values into a Jvalue. Thank you"}], "tags": [], "owner": {"reputation": 24, "user_id": 4680964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f7a543db0b3b8e8f947859d479d6960?s=128&d=identicon&r=PG&f=1", "display_name": "HiramHakim", "link": "https://stackoverflow.com/users/4680964/hiramhakim"}, "is_accepted": true, "score": -1, "last_activity_date": 1461099549, "last_edit_date": 1461099549, "creation_date": 1461084028, "answer_id": 36724459, "question_id": 36723406, "link": "https://stackoverflow.com/questions/36723406/how-to-iterate-a-matrix-in-haskell/36724459#36724459", "title": "How to iterate a matrix in haskell", "body": "<p>I don't know how you wanna represent matrix, but this is my solution:</p>\n\n<pre><code>import System.IO\n\nconvLine::String -&gt; [String]\nconvLine (x:[]) = [\"b\"]\nconvLine (x:xs) = [\"a\"] ++ convLine xs\n\nconvMatrix::[String] -&gt; [[String]]\nconvMatrix (x:[]) = [convLine x]\nconvMatrix (x:xs) = [convLine x] ++ convMatrix xs\n\nmain = do \n    handler &lt;- openFile \"./matrix\" ReadMode\n    content &lt;- hGetContents handler\n    let input = lines content\n    print $ convMatrix input\n</code></pre>\n\n<p>Content of my input file ./matrix was <br>\n123 <br>\n123 <br>\n123 <br></p>\n\n<p>and my result is: <br>\n[[\"a\",\"a\",\"b\"],[\"a\",\"a\",\"b\"],[\"a\",\"a\",\"b\"]]<br>\nI've just showed example how to convert values in some kind of matrix representation.</p>\n"}], "owner": {"reputation": 27, "user_id": 6225797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a5163f3890f09f9bda453398354b1ae?s=128&d=identicon&r=PG&f=1", "display_name": "fullmoon", "link": "https://stackoverflow.com/users/6225797/fullmoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 392, "favorite_count": 0, "accepted_answer_id": 36724459, "answer_count": 1, "score": 0, "last_activity_date": 1461099549, "creation_date": 1461080990, "last_edit_date": 1461081691, "question_id": 36723406, "link": "https://stackoverflow.com/questions/36723406/how-to-iterate-a-matrix-in-haskell", "title": "How to iterate a matrix in haskell", "body": "<p>I need to iterate a matrix in Haskell and I don't know how to do it. </p>\n\n<p>I have my matrix in a <code>.txt</code> file so I get the content with this line: <code>contents &lt;- readFile file</code>, and then I need to iterate that matrix one by one, because I need to convert the values to a JValue.</p>\n\n<p>This is my code: </p>\n\n<pre><code>myFunction file = do \ncontents &lt;- readFile file      \nlet element = endBy \",\" contents\nprint(element)\n</code></pre>\n\n<p>What can I do?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 18168, "user_id": 47552, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/20c0f42cfd92cb56a020ef5bce95621d?s=128&d=identicon&r=PG", "display_name": "Matt McHenry", "link": "https://stackoverflow.com/users/47552/matt-mchenry"}, "is_accepted": false, "score": 0, "last_activity_date": 1484276576, "creation_date": 1484276576, "answer_id": 41626761, "question_id": 36722830, "link": "https://stackoverflow.com/questions/36722830/parse-error-possibly-incorrect-indentation-or-mismatched-brackets-in-tower-of/41626761#41626761", "title": "parse error (possibly incorrect indentation or mismatched brackets) in tower of hanoi", "body": "<p>I see three issues.  First, your function definitions need to be indented.  (Unlike most C-family languages that use curly braces and semicolons, Haskell's parser uses whitespace to define the bodies of functions and other syntactic constructs like do-blocks.)  So instead of:</p>\n\n<pre><code>hanoi n a b c =\nlet\n...\n</code></pre>\n\n<p>you need:</p>\n\n<pre><code>hanoi n a b c =\n  let\n  ..\n</code></pre>\n\n<p>Second, you have two stray backtick (`) characters.</p>\n\n<p>Third, your <code>segment</code> function definition looks like it's got some wrong characters in it:</p>\n\n<pre><code>-segment n = let half1 = n div 2 in (half1, n half1=1)`\n+segment n = let half1 = n div 2 in (half1, n-half1-1)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6225679, "user_type": "registered", "profile_image": "https://graph.facebook.com/1074452215931492/picture?type=large", "display_name": "Muhammad Saad Mumbasit", "link": "https://stackoverflow.com/users/6225679/muhammad-saad-mumbasit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 190, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1484276576, "creation_date": 1461079576, "last_edit_date": 1484259560, "question_id": 36722830, "link": "https://stackoverflow.com/questions/36722830/parse-error-possibly-incorrect-indentation-or-mismatched-brackets-in-tower-of", "title": "parse error (possibly incorrect indentation or mismatched brackets) in tower of hanoi", "body": "<p>This my program problem is occurring when I load this file:</p>\n\n<pre><code>hanoi :: Integer -&gt; Peg -&gt; Peg -&gt; Peg -&gt; [Move]\nhanoi 0 _ _ _ = []\nhanoi n a b c =\nlet \nstep1move = hanoi (n-1) a c b\nstep2move = (a,b)\nstep3move = hanoi (n-1) c b a\nin\nstep1move ++ [step2move] ++ step3move`\n\nhanoi4 :: Integer -&gt; Peg -&gt; Peg -&gt; Peg -&gt; Peg -&gt; [Move]\nhanoi4 0 _ _ _ _ = []\nhanoi4 n a b c d =\nlet \n(half1,half2) = segment n\nstep1 = hanoi4 half1 a c b d\nstep2 = hanoi half2 a d b\nstep3 = (a, b)\nstep4 = hanoi half2 d b a\nstep5 = hanoi4 half1 c b a d\nin\nstep1 ++ step2 ++ [step3] ++ step4 ++ step5\n\n-- Segment n into two \"halves\" such that half1 + half2 = n - 1\nsegment :: Integer -&gt; (Integer, Integer)\nsegment n = let half1 = n div 2 in (half1, n half1=1)`\n</code></pre>\n"}, {"tags": ["multithreading", "haskell", "servlets"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 4, "creation_date": 1461077838, "post_id": 36721863, "comment_id": 61028786, "body": "Maybe something like this? <a href=\"http://hackage.haskell.org/package/stm-containers-0.2.10/docs/STMContainers-Map.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/stm-containers-0.2.10/docs/&hellip;</a>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1461166032, "post_id": 36721863, "comment_id": 61077716, "body": "Your update is an entirely separate question, and shouldn&#39;t be snuck into this one. The two main approaches are <code>ReaderT&#47;MonadReader</code> and <code>reflection</code>. <code>ReaderT&#47;MonadReader</code> is simpler; <code>reflection</code> may be helpful if your &quot;global static&quot; thing turns out not to be so global static once you&#39;ve gone through more design iterations."}], "answers": [{"tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": false, "score": 6, "last_activity_date": 1461079808, "creation_date": 1461079808, "answer_id": 36722938, "question_id": 36721863, "link": "https://stackoverflow.com/questions/36721863/what-is-the-analogue-of-concurrenthashmap-in-haskell/36722938#36722938", "title": "What is the analogue of ConcurrentHashMap in Haskell?", "body": "<p>First off, I'm going to assume you mean it needs to be available to multiple threads, not multiple processes.  (The difference being that threads share memory, processes do not.)  If that assumption is wrong, much of your question doesn't make sense.</p>\n\n<p>So, the first important point: Haskell has mutable data structures. They can easily be shared between threads. Here's a small example:</p>\n\n<pre><code>import Control.Concurrent\nimport Control.Monad\n\nmain :: IO ()\nmain = do\n    v &lt;- newMVar 0 :: IO (MVar Int)\n    forkIO . forever $ do\n        x &lt;- takeMVar v\n        putMVar v $! x + 1\n    forM_ [1..10] $ \\_ -&gt; do\n        x &lt;- readMVar v\n        threadDelay 100\n        print x\n</code></pre>\n\n<p>Note the use of ($!) when putting the value in the <code>MVar</code>.  <code>MVar</code>s don't enforce that their contents are evaluated.  There's some subtlety in making sure everything works properly.  You will get lots of space leaks until you understand Haskell's evaluation model.  That's part of why this sort of thing is usually done in a library that handles all those details.</p>\n\n<p>Given this, the first pass approach is to just store a map of some sort in an <code>MVar</code>.  Unless it's under a lot of contention, that actually has pretty good performance properties.</p>\n\n<p>When it is under contention, you have a good fallback secondary approach, especially when using a hash map.  That's striping.  Instead of storing one map in one MVar, use N maps in N MVars.  The first step in a lookup is using the hash to determine which of the N MVars to look in.</p>\n\n<p>There are fancy lock-free algorithms, which could be implemented using finer-grained mutable values.  But in general, they are a lot of engineering effort for a few percent improvement in performance that doesn't really matter in most use cases.</p>\n"}, {"tags": [], "owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "is_accepted": true, "score": 7, "last_activity_date": 1461127890, "last_edit_date": 1461127890, "creation_date": 1461081496, "answer_id": 36723601, "question_id": 36721863, "link": "https://stackoverflow.com/questions/36721863/what-is-the-analogue-of-concurrenthashmap-in-haskell/36723601#36723601", "title": "What is the analogue of ConcurrentHashMap in Haskell?", "body": "<p>It's not clear from your question whether the client API will provide ways of mutating the data.</p>\n\n<p>If not (i.e., the API will only be about querying), then any immutable data-structure will suffice, since one beauty of immutable data is that it can be accessed from multiple threads safely with you being sure that it can't change. No need for the overhead of locks or other strategies for working with concurrency. You'll simply construct the immutable data during the initialisation and then just query it. For this consider a package like <a href=\"http://hackage.haskell.org/package/unordered-containers\" rel=\"nofollow\">\"unordered-containers\"</a>.</p>\n\n<p>If your API will also be mutating the data, then you will need mutable data-structures, which are optimised for concurrency. <a href=\"http://hackage.haskell.org/package/stm-containers\" rel=\"nofollow\">\"stm-containers\"</a> is one package, which provides those.</p>\n"}], "owner": {"reputation": 3190, "user_id": 875265, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/acf761af25a59c5da69b56deaf8a32e7?s=128&d=identicon&r=PG", "display_name": "fycth", "link": "https://stackoverflow.com/users/875265/fycth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 691, "favorite_count": 0, "accepted_answer_id": 36723601, "answer_count": 2, "score": 6, "last_activity_date": 1461139814, "creation_date": 1461077271, "last_edit_date": 1461139814, "question_id": 36721863, "link": "https://stackoverflow.com/questions/36721863/what-is-the-analogue-of-concurrenthashmap-in-haskell", "title": "What is the analogue of ConcurrentHashMap in Haskell?", "body": "<p><strong>update</strong>: please, bear in mind, I'm just started learning Haskell</p>\n\n<p>Let's say we're writing an application with the following general functionality:</p>\n\n<ul>\n<li>when starting, it gathers some data from an external source;</li>\n<li>this data are a set of complex structures which contain lists,\narrays, ints, string, etc.;</li>\n<li>when running, the application serves web API (servlets) that provides\naccess to the data.</li>\n</ul>\n\n<p>Now, if the application would be written in Java, we could use static ConcurrentHashMap object where the data could be stored (representing Java classes). So that, during start, the app could fill the map with data, and then servlets could access it providing some API to the clients.</p>\n\n<p>If the application would be written in Erlang, we could use ETS/DETS for storing the data (as native Erlang structures).</p>\n\n<p><strong>Now the question: what is the proper Haskell way for implementing such design?</strong> \nIt shouldn't be DB, it should be some sort of a lightweight in-memory something, that could store complex structures (Haskell native structures), and that could be accessible from different threads (servlets, talking by Java-world entities). In Haskell: no static global vars as in Java, no ETS and OTP as in Erlang, - so how to do it the right way (with no using external solutions like Redis)?</p>\n\n<p>Thanks</p>\n\n<p><strong>update</strong>: another important part of the question - since Haskell doesn't (?) have 'global static' variables, then what would be the right way for implementing this 'global accessible' data keeping object (say, it is  \"stm-containers\")? Should I initialize it somewhere in the 'main' function and then just pass it to every REST API handler? Or is there any other more correct way?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 8, "creation_date": 1461071520, "post_id": 36719431, "comment_id": 61024020, "body": "the inner case is just another <code>fmap</code> ;)"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 2, "creation_date": 1461071938, "post_id": 36719431, "comment_id": 61024367, "body": "<code>fmap (\\x -&gt; case x of Just j -&gt; Just (f j); Nothing -&gt; Nothing) = fmap (\\x -&gt; fmap f x) = fmap (fmap f)</code>. The double <code>fmap</code> should be surprising since you have nested functors. You need one <code>fmap</code> for each layer."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1461072313, "post_id": 36719431, "comment_id": 61024662, "body": "@Bakuriu You surely mean &quot;should <i>not</i> be surprising&quot; :)"}, {"owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1461072425, "post_id": 36719431, "comment_id": 61024746, "body": "@Bakuriu <code>= (fmap . fmap) f</code>"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "edited": false, "score": 0, "creation_date": 1461073042, "post_id": 36719431, "comment_id": 61025222, "body": "@NikitaVolkov iMO <code>fmap (fmap f)</code> is more readable as it indicates the nesting better"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1461073367, "post_id": 36719431, "comment_id": 61025439, "body": "@chi Yeah, obviously. I believe I had written it, then I decided to rephrase the sentence and forgot it."}, {"owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461075384, "post_id": 36719431, "comment_id": 61026944, "body": "@Carsten Might be, but I find it rather eye-opening, as it provides a whole other perspective on the problem."}], "owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1461071351, "creation_date": 1461071351, "question_id": 36719431, "link": "https://stackoverflow.com/questions/36719431/make-more-monadic-solution", "title": "Make more monadic solution", "body": "<pre><code>instance (Functor m) =&gt; Functor (MaybeT m) where\n    fmap f m = MaybeT $ fmap (\\x -&gt; case x of\n        Just j -&gt; Just (f j)\n        Nothing -&gt; Nothing\n        ) (runMaybeT m)\n</code></pre>\n\n<p>My implementation of <code>Functor MaybeT</code>. But, on my eye it seems to by a bit ugly ;) from monadic semantic / monadic solution. Please suggest me some advices to be better functional programmer :).</p>\n"}, {"tags": ["algorithm", "haskell", "expression", "equivalence"], "answers": [{"comments": [{"owner": {"reputation": 1804, "user_id": 1260229, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a918b56d3f83f46ced68b33737396b87?s=128&d=identicon&r=PG", "display_name": "sn&#248;reven", "link": "https://stackoverflow.com/users/1260229/sn%c3%b8reven"}, "edited": false, "score": 0, "creation_date": 1494170898, "post_id": 36719603, "comment_id": 74703212, "body": "It also had to work on fractional values so I needed both open and closed interval bounds which made everything more complex - but the approach worked. Thanks!"}], "tags": [], "owner": {"reputation": 51837, "user_id": 2144669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e7393f439028063515255b63ed94cfd?s=128&d=identicon&r=PG", "display_name": "David Eisenstat", "link": "https://stackoverflow.com/users/2144669/david-eisenstat"}, "is_accepted": true, "score": 2, "last_activity_date": 1461071750, "creation_date": 1461071750, "answer_id": 36719603, "question_id": 36719402, "link": "https://stackoverflow.com/questions/36719402/check-numeric-constraint-expressions-for-equivalence-subset-of-allowed-values/36719603#36719603", "title": "Check numeric constraint expressions for equivalence/subset of allowed values", "body": "<p>You can write a function</p>\n\n<pre><code>evaluate :: Expression -&gt; ValueSet\n</code></pre>\n\n<p>that evaluates an expression into a set of values where it is true. This value set could be something like</p>\n\n<pre><code>data Value = MinusInfinity | Finite Integer | PositiveInfinity\ntype Range = (Value, Value)\ntype ValueSet = [Range]\n</code></pre>\n\n<p>where <code>ValueSet</code> is a sorted list of closed, disjoint ranges. Then you can implement the cases of <code>evaluate</code> one by one using logic that resembles a sorted merge.</p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 6220183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/690f5cca7b4909728671e8f69e513d3f?s=128&d=identicon&r=PG&f=1", "display_name": "J Ward", "link": "https://stackoverflow.com/users/6220183/j-ward"}, "is_accepted": false, "score": 1, "last_activity_date": 1461073576, "creation_date": 1461073576, "answer_id": 36720340, "question_id": 36719402, "link": "https://stackoverflow.com/questions/36719402/check-numeric-constraint-expressions-for-equivalence-subset-of-allowed-values/36720340#36720340", "title": "Check numeric constraint expressions for equivalence/subset of allowed values", "body": "<p>This problem is NP-hard.  Sure feels like it, anyway.</p>\n\n<p>But there might be hope.  As stated, your expression language is pretty darned constrained.  For example, you didn't mention the <code>not</code> operator, which means that <code>&amp;&amp;</code> can never be converted to <code>||</code>.</p>\n\n<p>Here's the outlines of the answer:</p>\n\n<ol>\n<li>Normalize the comparison operators:  walk the trees, converting all <strong>&lt;=</strong> to <strong>></strong> by swapping operands.  At the same time, convert <strong>>=</strong> to <strong>&lt;</strong>.</li>\n<li>Collapse repeated <strong>and</strong>s and <strong>or</strong>s to 'a multi-operand tree node'.  For example, rewriting <code>A || ( B || C )</code> so that it's a single three-operand tree node <code>or(A,B,C)</code>.  A node can be collapsed iff it is the same operator as its parent node.  </li>\n<li>Sort the operands <code>||</code>, <code>&amp;&amp;</code>, <code>or</code>, and <code>and</code> using a stable sort, so that <code>C || (B || A)</code> also collapses to <code>or(A,B,C)</code>.  And <code>B || A</code> and `A</li>\n<li>Now that the trees are normalized, a recursive tree comparison works.</li>\n</ol>\n\n<p>This answer doesn't take into account overlapping sets.  For example,\nit won't tree the expression </p>\n"}], "owner": {"reputation": 1804, "user_id": 1260229, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a918b56d3f83f46ced68b33737396b87?s=128&d=identicon&r=PG", "display_name": "sn&#248;reven", "link": "https://stackoverflow.com/users/1260229/sn%c3%b8reven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 36719603, "answer_count": 2, "score": 2, "last_activity_date": 1461084036, "creation_date": 1461071278, "last_edit_date": 1461084036, "question_id": 36719402, "link": "https://stackoverflow.com/questions/36719402/check-numeric-constraint-expressions-for-equivalence-subset-of-allowed-values", "title": "Check numeric constraint expressions for equivalence/subset of allowed values", "body": "<p>I have an AST representing expressions like these:</p>\n\n<ul>\n<li><code>(&lt;=10 &amp;&amp; &gt;=3) || ==0</code></li>\n<li><code>==1 || ==2 || ==3</code></li>\n<li><code>==1 &amp;&amp; !=1</code></li>\n</ul>\n\n<p>There are numerics as well as boolean (<code>||</code>, <code>&amp;&amp;</code>) and numeric (<code>&lt;</code>, <code>&lt;=</code>, <code>==</code>, <code>!=</code>, <code>&gt;=</code>, <code>&gt;</code>) operators. A boolean <code>not</code> operator can be added to the AST if needed. These expressions are used to constrain possible numeric input values (note that the last one does not allow anything).</p>\n\n<p>I am looking for a way of comparing two expressions. I need to know if they allow the exact same set of numbers (are equivalent), or if one expression permits a subset of the other one.</p>\n"}, {"tags": ["haskell", "heroku", "rabbitmq", "backgroundworker", "background-process"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1461072254, "post_id": 36718177, "comment_id": 61024613, "body": "if you just want to keep it running <i>forever</i> (till killed) you could use <code>forever $ threadDelay 10000</code> - if not you should find some way to signal your process to finish - a simple <code>MVar</code> should do"}, {"owner": {"reputation": 2097, "user_id": 1646823, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8471ef6adbd84694d3c37e445768a75f?s=128&d=identicon&r=PG", "display_name": "jvans", "link": "https://stackoverflow.com/users/1646823/jvans"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461367102, "post_id": 36718177, "comment_id": 61183246, "body": "@Carsten thanks for your comment, that did the trick! If you write that as an answer I&#39;ll accept it. Appreciate the help."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461391397, "post_id": 36718177, "comment_id": 61187975, "body": "the <code>forever</code>? - I&#39;ll write a short answer"}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 1, "last_activity_date": 1461391796, "creation_date": 1461391796, "answer_id": 36807330, "question_id": 36718177, "link": "https://stackoverflow.com/questions/36718177/keeping-a-background-process-running-on-heroku/36807330#36807330", "title": "keeping a background process running on heroku", "body": "<p>as I pointed out in the comment if you just want to keep it running forever you can use <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Control-Monad.html#v:forever\" rel=\"nofollow\"><code>forever</code></a> with - for example - <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Control-Concurrent.html#v:threadDelay\" rel=\"nofollow\"><code>threadDelay</code></a>:</p>\n\n<pre><code>import Control.Concurrent (threadDelay)\nimport Control.Monad (forever)\n\nmain = do\n    --setup connection omitted\n    --connect to queue, wait for messages\n    consumeMsgs chan \"myQueue\" Ack myCallback\n    --halts process so messages are taken off the queue forever\n    forever $ threadDelay 10000\n    -- so this will never happen and you could remove it\n    closeConnection conn -- close connection after key\n    putStrLn \"connection closed\"\n</code></pre>\n\n<p>note that this will of course never really close the connection or exit the application - you'll have to kill the process.</p>\n\n<hr>\n\n<p>the alternative would be a bit more involved as you need some message/way to send your program a termination signal.</p>\n\n<p>An easy way is to use <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Control-Concurrent-MVar.html\" rel=\"nofollow\"><code>MVar</code></a>s which you could set in your <code>myCallback</code> when a certain <em>stop</em>-message was received on your queue:</p>\n\n<pre><code>import Control.Concurrent.MVar\n\nmain = do\n    -- MVar to receve the quit-signal\n    quitSignal &lt;- newEmptyMVar\n    --setup connection omitted\n    --connect to queue, wait for messages - the callback should\n    --set the quitSignal with putMVar quitSignal ()\n    consumeMsgs chan \"myQueue\" Ack (myCallback quitSignal)\n    --halts process so messages are taken off the queue till quitSignal\n    takeMVar quitSignal\n    -- so this will happen after quitSignal was set\n    closeConnection conn -- close connection after key\n    putStrLn \"connection closed\"\n</code></pre>\n"}], "owner": {"reputation": 2097, "user_id": 1646823, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/8471ef6adbd84694d3c37e445768a75f?s=128&d=identicon&r=PG", "display_name": "jvans", "link": "https://stackoverflow.com/users/1646823/jvans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 360, "favorite_count": 0, "accepted_answer_id": 36807330, "answer_count": 1, "score": 2, "last_activity_date": 1461428207, "creation_date": 1461068331, "last_edit_date": 1495541754, "question_id": 36718177, "link": "https://stackoverflow.com/questions/36718177/keeping-a-background-process-running-on-heroku", "title": "keeping a background process running on heroku", "body": "<p>I'm trying to run a rabbitmq background process on heroku to pick tasks off a queue and process them. I'm working with the AMQP haskell library and they give the following <a href=\"https://hackage.haskell.org/package/amqp-0.13.0/docs/Network-AMQP.html\" rel=\"nofollow noreferrer\">example</a> (parts omitted or brevity.</p>\n\n<pre><code>main = do\n    --setup connection omitted\n    --connect to queue, wait for messages\n    consumeMsgs chan \"myQueue\" Ack myCallback\n    --halts process so messages are taken off the queue until a key is presseed\n    getLine -- wait for keypress\n    closeConnection conn -- close connection after key\n    putStrLn \"connection closed\"\n</code></pre>\n\n<p>This works fine locally because <code>getLine</code> keeps the process running until you press a key. However, when I deploy this to heroku the process exits with</p>\n\n<p><code>2016-04-19T08:37:23.373087+00:00 app[worker.1]: worker: &lt;stdin&gt;: hGetChar: end of file</code></p>\n\n<p>I figured out from <a href=\"https://stackoverflow.com/questions/19955260/what-is-dev-null-in-bash\">the accepted answer to this question</a> that this is because in order to deploy a background process via ssh you need to redirect <code>/dev/null/</code> to <code>stdin</code> which sends an <code>EOF</code> signal to the process.</p>\n\n<p>In our case the <code>getLine</code> function exits because of this signal and the entire process stops, preventing our worker from staying up.</p>\n\n<p>How can I keep this worker running when I deploy?</p>\n\n<p><strong>EDIT: Final Solution</strong>\nUsing @carstons comments I ended up with the following implementation that worked:</p>\n\n<pre><code>main :: IO ()\nmain = do\n    mvar &lt;- newEmptyMVar\n    conn &lt;- setupConnection\n    queueName &lt;- pack &lt;$&gt; getEnv \"QUEUE_NAME\"\n    chan &lt;- openChannel conn\n    consumeMsgs chan queueName Ack processMessage\n    installHandler sigINT (Catch (cleanupConnection conn mvar)) Nothing\n    putStrLn \"Running forever, press ctrl c to exit\"\n    -- this blocks until sigint is recieved and the handler for SIGINT\n    -- \"fills\" the mvar. once that is filled the process exits\n    run &lt;- takeMVar mvar\n    case run of\n      _ -&gt; return ()\n\nmixpanelConfig :: IO Config\nmixpanelConfig = liftM2 Config (ApiToken . pack &lt;$&gt; getEnv \"MIXPANEL_API_TOKEN\") (newManager tlsManagerSettings)\n\ncleanupConnection :: Connection -&gt; MVar () -&gt; IO ()\ncleanupConnection conn mvar = do\n  closeConnection conn\n  putStrLn \"SIGINT received.. closing rabbitmq connection\"\n  putMVar mvar ()\n\nprocessMessage :: (Message, Envelope) -&gt; IO ()\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1461067266, "post_id": 36717438, "comment_id": 61020714, "body": "<code>lift</code> is <code>lift :: Monad m =&gt; m a -&gt; t m a</code> in your case <code>MaybeT ~ t</code> so it has to work for <b>all</b> Monads <code>m</code> - if you want to cheat you can look at the source of <code>MaybeT</code> ;)"}], "answers": [{"tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": true, "score": 3, "last_activity_date": 1461068303, "creation_date": 1461068303, "answer_id": 36718167, "question_id": 36717438, "link": "https://stackoverflow.com/questions/36717438/own-implementation-of-maybet-lift/36718167#36718167", "title": "Own implementation of MaybeT lift", "body": "<p>If you specialise the type of <code>lift</code> to your <code>MaybeT</code> type you have:</p>\n\n<pre><code>newtype MaybeT m a = MaybeT { runMaybeT :: m (Maybe a) }\n\nlift :: Monad m =&gt; m a -&gt; MaybeT m a\n</code></pre>\n\n<p>The type of <code>&gt;&gt;=</code> is <code>Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b</code> so in your implementation:</p>\n\n<pre><code>lift m = m &gt;&gt;= \\a -&gt; MaybeT $ return (Just a)\n</code></pre>\n\n<p>you need to return a value of type <code>m b</code> while you return a value of type <code>MaybeT m b</code>, hence the error.</p>\n\n<p>You now have two problems. The first is you need to move the application of <code>MaybeT</code> outside the application of <code>&gt;&gt;=</code>. The second is you need to construct a value of <code>m (Maybe a)</code> from the lamba passed to <code>&gt;&gt;=</code> i.e.</p>\n\n<pre><code>lift x = MaybeT $ x &gt;&gt;= \\a -&gt; return (Just a)\n</code></pre>\n\n<p>or simply:</p>\n\n<pre><code>lift x = MaybeT $ fmap Just x\n</code></pre>\n"}], "owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 36718167, "answer_count": 1, "score": 1, "last_activity_date": 1461068303, "creation_date": 1461066383, "question_id": 36717438, "link": "https://stackoverflow.com/questions/36717438/own-implementation-of-maybet-lift", "title": "Own implementation of MaybeT lift", "body": "<p>I am trying to implement:</p>\n\n<pre><code>instance MonadTrans MaybeT where\n    lift m = m &gt;&gt;= \\a -&gt; MaybeT $ return (Just a)\n</code></pre>\n\n<p>And it gets compiler error:</p>\n\n<pre><code>    Could not deduce (m ~ MaybeT m)\n    from the context (Monad m)\n      bound by the type signature for\n                 lift :: Monad m =&gt; m a -&gt; MaybeT m a\n      at MaybeTrans.hs:16:9-53\n      `m' is a rigid type variable bound by\n          the type signature for lift :: Monad m =&gt; m a -&gt; MaybeT m a\n\n    Expected type: MaybeT m a\n      Actual type: m a\n    In the first argument of `(&gt;&gt;=)', namely `m'\n    In the expression: m &gt;&gt;= \\ a -&gt; MaybeT $ return (Just a)\n    In an equation for `lift':\n        lift m = m &gt;&gt;= \\ a -&gt; MaybeT $ return (Just a)\n</code></pre>\n\n<p>I cannot understand where I made a mistake.\nPlease help me ;)</p>\n"}, {"tags": ["haskell", "io", "output"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1461064770, "post_id": 36716745, "comment_id": 61018953, "body": "seems another one hit the Monomorphism-Restriction - use <code>let myPrint a = putStrLn $ show a</code>"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461064831, "post_id": 36716745, "comment_id": 61018992, "body": "possible duplicate of <a href=\"https://stackoverflow.com/questions/36643445/no-instance-for-ariving-from-use-of-next/36643992#36643992\" title=\"no instance for ariving from use of next\">stackoverflow.com/questions/36643445/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461065034, "post_id": 36716939, "comment_id": 61019147, "body": "add <code>:set -XMonomorphismRestriction</code> for the observed behavior ;)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461065093, "post_id": 36716939, "comment_id": 61019188, "body": "(not sure but on older compilers <code>:set -XNoMonomorphismRestriction</code> might work too)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461065095, "post_id": 36716939, "comment_id": 61019190, "body": "@Carsten I have no desire to observe it! :-P"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461065268, "post_id": 36716939, "comment_id": 61019308, "body": "to be honest I&#39;m not 100% sure if I agree - the difference between the compiler and GHCi here is the cause of quite a few questions here (and indeed it&#39;s puzzling) - maybe you know it right away: is there a switch to activate warnings on defaults in GHCi?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461065802, "post_id": 36716939, "comment_id": 61019678, "body": "@Carsten I agree that the mismatch between GHCi and GHC generates several questions here on SO, perhaps too many. A &quot;monomorphism warning&quot; could be nice to have in GHCi... I don&#39;t know if that is already implemented."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461065966, "post_id": 36716939, "comment_id": 61019775, "body": "I think you get warnings (with <code>-Wall</code>) when GHC is <i>defaulting</i>  and that would help here to - I think I saw the switch to use this in GHCi (Wall) but I cannot find it right now"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461066206, "post_id": 36716939, "comment_id": 61019937, "body": "@Carsten <code>-fwarn-monomorphism-restriction</code> <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/options-sanity.html\" rel=\"nofollow noreferrer\">downloads.haskell.org/~ghc/latest/docs/html/users_guide/&hellip;</a>"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1461065046, "last_edit_date": 1461065046, "creation_date": 1461064993, "answer_id": 36716939, "question_id": 36716745, "link": "https://stackoverflow.com/questions/36716745/haskell-error-by-using-point-operator-to-combine-two-functions/36716939#36716939", "title": "Haskell: error by using point-operator to combine two functions", "body": "<p>You are using an old GHCi/Hugs interpreter, where the dreaded monomorphism restriction applies. I'd recommend you update it.</p>\n\n<pre><code>GHCi, version 7.10.2: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; let myPrint = putStrLn . show\nPrelude&gt; :t myPrint\nmyPrint :: Show a =&gt; a -&gt; IO ()\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 6224454, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe0c708c85d700367be059cccb44d44d?s=128&d=identicon&r=PG&f=1", "display_name": "lenbold", "link": "https://stackoverflow.com/users/6224454/lenbold"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 36716939, "answer_count": 1, "score": 1, "last_activity_date": 1461065046, "creation_date": 1461064449, "question_id": 36716745, "link": "https://stackoverflow.com/questions/36716745/haskell-error-by-using-point-operator-to-combine-two-functions", "title": "Haskell: error by using point-operator to combine two functions", "body": "<p>i just started Haskell and ran into a problem with (.).</p>\n\n<pre><code>let myPrint = putStrLn . show\nmyPrint (\"Hello World!\")\n&lt;interactive&gt;:171:10:\nCouldn't match expected type `()' with actual type `[Char]'\nIn the first argument of `myPrint', namely `(\"hello Wordl!\")'\nIn the expression: myPrint (\"hello Wordl!\")\nIn an equation for `it': it = myPrint (\"hello Wordl!\")\n</code></pre>\n\n<p>The information about my defined function prints:</p>\n\n<pre><code>Prelude&gt; :info myPrint\nmyPrint :: () -&gt; IO ()\n</code></pre>\n\n<p>Shouldn't the output be: </p>\n\n<pre><code>myPrint:: Show a =&gt; a -&gt; IO ()\n</code></pre>\n"}, {"tags": ["haskell", "functor", "scalaz", "category-theory", "scala-cats"], "answers": [{"comments": [{"owner": {"reputation": 1902, "user_id": 396079, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/5d537347eb54566c1b9d975a30fc0147?s=128&d=identicon&r=PG", "display_name": "Henry Story", "link": "https://stackoverflow.com/users/396079/henry-story"}, "edited": false, "score": 0, "creation_date": 1461066311, "post_id": 36716618, "comment_id": 61020017, "body": "could <code>foo:: a -&gt; a</code> not be the successor function? <code>succ:: Int =&gt; Int</code> is not the identity function. succ 1 == 2"}, {"owner": {"reputation": 1902, "user_id": 396079, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/5d537347eb54566c1b9d975a30fc0147?s=128&d=identicon&r=PG", "display_name": "Henry Story", "link": "https://stackoverflow.com/users/396079/henry-story"}, "edited": false, "score": 0, "creation_date": 1461067407, "post_id": 36716618, "comment_id": 61020808, "body": "I am having trouble following this for the moment, because I get stuck on the question in the previous comment. In any case you may want to check out how Theorems for Free fit in with HoTT. <a href=\"https://groups.google.com/d/msg/hott-cafe/ak301lhl9Qs/TLUDoah40pkJ\" rel=\"nofollow noreferrer\">Apparently it&#39;s not that easy</a> and may be false there..."}, {"owner": {"reputation": 4919, "user_id": 1061656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/639473b7e713c19f12a27070fb1a7eb3?s=128&d=identicon&r=PG", "display_name": "opqdonut", "link": "https://stackoverflow.com/users/1061656/opqdonut"}, "reply_to_user": {"reputation": 1902, "user_id": 396079, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/5d537347eb54566c1b9d975a30fc0147?s=128&d=identicon&r=PG", "display_name": "Henry Story", "link": "https://stackoverflow.com/users/396079/henry-story"}, "edited": false, "score": 4, "creation_date": 1461068008, "post_id": 36716618, "comment_id": 61021220, "body": "@HenryStory : <code>succ</code> has the type <code>Int -&gt; Int</code>, which is not the same as <code>a -&gt; a</code>, that is, <code>forall a. a -&gt; a</code>. The type of <code>succ</code> is more specific than <code>a -&gt; a</code>, and <code>map succ</code> is well-typed, but according to <code>map</code>s type, <code>map</code> must work for all such functions, and thus cannot assume anything about them."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1902, "user_id": 396079, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/5d537347eb54566c1b9d975a30fc0147?s=128&d=identicon&r=PG", "display_name": "Henry Story", "link": "https://stackoverflow.com/users/396079/henry-story"}, "edited": false, "score": 1, "creation_date": 1461069616, "post_id": 36716618, "comment_id": 61022421, "body": "@HenryStory If Haskell allowed existention types, we could write <code>succ :: exists a. a -&gt; a</code>. However, parametricity applies to types such as <code>forall a. a -&gt; a</code>, i.e. functions that have to work on &quot;all&quot; arguments of the unknown type <code>a</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1902, "user_id": 396079, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/5d537347eb54566c1b9d975a30fc0147?s=128&d=identicon&r=PG", "display_name": "Henry Story", "link": "https://stackoverflow.com/users/396079/henry-story"}, "edited": false, "score": 2, "creation_date": 1461069754, "post_id": 36716618, "comment_id": 61022546, "body": "@HenryStory I&#39;d would neglect HoTT for this. HoTT is beautiful, but it&#39;s about dependent types (and higher homotopies), which Haskell lacks. I don&#39;t believe HoTT can help here (but I&#39;d love to be proved wrong on this...)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1461069840, "post_id": 36716618, "comment_id": 61022620, "body": "Put another way, don&#39;t confuse (the syntactically illegal) <code>forall a . succ :: a -&gt; a</code> (which say, &quot;Give me a type, and I can provide a definition of <code>such</code> for that type) with <code>succ :: forall a . a -&gt; a</code>, which says &quot;Give me a definition of <code>succ</code>, and I can apply <i>that definition</i> to a value of any type.&quot;"}, {"owner": {"reputation": 1902, "user_id": 396079, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/5d537347eb54566c1b9d975a30fc0147?s=128&d=identicon&r=PG", "display_name": "Henry Story", "link": "https://stackoverflow.com/users/396079/henry-story"}, "edited": false, "score": 0, "creation_date": 1461131133, "post_id": 36716618, "comment_id": 61052575, "body": "Good thing I asked this question here. I don&#39;t think I would have found this proof by myself soon :-)"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 11, "last_activity_date": 1555347230, "last_edit_date": 1555347230, "creation_date": 1461064108, "answer_id": 36716618, "question_id": 36715851, "link": "https://stackoverflow.com/questions/36715851/why-must-fmap-map-every-element-of-a-list/36716618#36716618", "title": "Why must fmap map every element of a List?", "body": "<p>This relies on a theoretical result called \"parametricity\", first defined by Reynolds and then developed by Wadler (among others). Perhaps the most famous paper on this topic is <a href=\"http://homepages.inf.ed.ac.uk/wadler/topics/parametricity.html\" rel=\"nofollow noreferrer\">\"Theorems for free!\"</a> by Wadler.</p>\n\n<p>The key idea is that from the polymorphic type of a function <em>only</em>, we can get some information about the semantics of the function. For instance:</p>\n\n<pre><code>foo :: a -&gt; a\n</code></pre>\n\n<p>From this type alone, we can see that, if <code>foo</code> terminates, it is the identity function. Intuitively, <code>foo</code> can not distinguish between different <code>a</code>s since in Haskell we do not have e.g. Java's <code>instanceof</code> which can inspect the actual runtime type. Similarly,</p>\n\n<pre><code>bar :: a -&gt; b -&gt; a\n</code></pre>\n\n<p>must return the first argument. And <code>baz :: a -&gt; a -&gt; a</code> must return either the first or the second. And <code>quz :: a -&gt; (a -&gt; a) -&gt; a</code> must apply some fixed number of times the function to the first argument. You probably get the idea now.</p>\n\n<p>The general property which can be inferred from a type is quite complex, but luckily it can be computed <a href=\"http://www-ps.iai.uni-bonn.de/cgi-bin/free-theorems-webui.cgi\" rel=\"nofollow noreferrer\">mechanically</a>. In category-theory, this is related to the notion of <a href=\"https://en.wikipedia.org/wiki/Natural_transformation\" rel=\"nofollow noreferrer\">natural transformation</a>.</p>\n\n<p>For the <code>map</code> type, we get the following scary property:</p>\n\n<pre><code>forall t1,t2 in TYPES, f :: t1 -&gt; t2.\n forall t3,t4 in TYPES, g :: t3 -&gt; t4.\n  forall p :: t1 -&gt; t3.\n   forall q :: t2 -&gt; t4.\n    (forall x :: t1. g (p x) = q (f x))\n    ==&gt; (forall y :: [t1].\n          map_{t3}_{t4} g (map2_{t1}_{t3} p y) =\n          map2_{t2}_{t4} q (map_{t1}_{t2} f y))\n</code></pre>\n\n<p>Above, <code>map</code> is the well-known map function, while <code>map2</code> is any arbitrary function which has type <code>(a -&gt; b) -&gt; [a] -&gt; [b]</code>.</p>\n\n<p>Now, further assume that <code>map2</code> satisfies the functor laws, in particular <code>map2 id = id</code>. We then can choose <code>p = id</code> and <code>t3 = t1</code>. We get</p>\n\n<pre><code>forall t1,t2 in TYPES, f :: t1 -&gt; t2.\n forall t4 in TYPES, g :: t1 -&gt; t4.\n   forall q :: t2 -&gt; t4.\n    (forall x :: t1. g x = q (f x))\n    ==&gt; (forall y :: [t1].\n          map_{t1}_{t4} g (map2_{t1}_{t1} id y) =\n          map2_{t2}_{t4} q (map_{t1}_{t2} f y))\n</code></pre>\n\n<p>Applying the functor law on <code>map2</code>:</p>\n\n<pre><code>forall t1,t2 in TYPES, f :: t1 -&gt; t2.\n forall t4 in TYPES, g :: t1 -&gt; t4.\n   forall q :: t2 -&gt; t4.\n    (forall x :: t1. g x = q (f x))\n    ==&gt; (forall y :: [t1].\n          map_{t1}_{t4} g y =\n          map2_{t2}_{t4} q (map_{t1}_{t2} f y))\n</code></pre>\n\n<p>Now, let's choose <code>t2 = t1</code> and <code>f = id</code>:</p>\n\n<pre><code>forall t1 in TYPES.\n forall t4 in TYPES, g :: t1 -&gt; t4.\n   forall q :: t1 -&gt; t4.\n    (forall x :: t1. g x = q x)\n    ==&gt; (forall y :: [t1].\n          map_{t1}_{t4} g y =\n          map2_{t1}_{t4} q (map_{t1}_{t1} id y))\n</code></pre>\n\n<p>By the functor law of <code>map</code>:</p>\n\n<pre><code>forall t1, t4 in TYPES.\n   forall g :: t1 -&gt; t4, q :: t1 -&gt; t4.\n    g = q\n    ==&gt; (forall y :: [t1].\n          map_{t1}_{t4} g y =\n          map2_{t1}_{t4} q y)\n</code></pre>\n\n<p>which means</p>\n\n<pre><code>forall t1, t4 in TYPES.\n forall g :: t1 -&gt; t4.\n    (forall y :: [t1].\n          map_{t1}_{t4} g y =\n          map2_{t1}_{t4} g y)\n</code></pre>\n\n<p>which means</p>\n\n<pre><code>forall t1, t4 in TYPES.\n          map_{t1}_{t4} = map2_{t1}_{t4}\n</code></pre>\n\n<p>Summing up:</p>\n\n<p>If <code>map2</code> is any function with polymorphic type <code>(a -&gt; b) -&gt; [a] -&gt; [b]</code>, and such that it satisfies the first functor law <code>map2 id = id</code>, then <code>map2</code> must be equivalent to the standard <code>map</code> function.</p>\n\n<p>Also see a <a href=\"https://www.schoolofhaskell.com/user/edwardk/snippets/fmap\" rel=\"nofollow noreferrer\">related blog post by Edward Kmett</a>.</p>\n\n<p>Note that in Scala the above holds only if you do not use <code>x.isInstanceOf[]</code>, and other reflection tools, which can break parametricity.</p>\n"}], "owner": {"reputation": 1902, "user_id": 396079, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/5d537347eb54566c1b9d975a30fc0147?s=128&d=identicon&r=PG", "display_name": "Henry Story", "link": "https://stackoverflow.com/users/396079/henry-story"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5870, "favorite_count": 1, "accepted_answer_id": 36716618, "answer_count": 1, "score": 11, "last_activity_date": 1555347230, "creation_date": 1461062144, "last_edit_date": 1495535569, "question_id": 36715851, "link": "https://stackoverflow.com/questions/36715851/why-must-fmap-map-every-element-of-a-list", "title": "Why must fmap map every element of a List?", "body": "<p>Having read the book <a href=\"http://learnyouahaskell.com/\" rel=\"nofollow noreferrer\">Learn you a Haskell For Great Good</a>, and the very helpful wiki book article <a href=\"https://en.wikibooks.org/wiki/Haskell/Category_theory\" rel=\"nofollow noreferrer\">Haskell Category Theory</a> which helped me overcome the common category mistake <a href=\"https://stackoverflow.com/questions/33441140/why-is-pure-only-required-for-applicative-and-not-already-for-functor\">of confusing category objects with the programming objects</a>, I still have the following question: </p>\n\n<p><strong>Why must <code>fmap</code> map over every elements of a List?</strong></p>\n\n<p>I like that it does, I just want to understand how this is justified category theoretically. ( or perhaps it is easier to justify using HoTT? )</p>\n\n<p>In Scala notation, <code>List</code> is a functor that takes any type and maps that into an type from the set of all list types, eg it maps the type <code>Int</code> to the type <code>List[Int]</code> and it maps the functions on <code>Int</code> eg </p>\n\n<ul>\n<li><code>Int.successor: Int =&gt; Int</code> to <code>Functor[List].fmap(successor) : List[Int] =&gt; List[Int]</code></li>\n<li><code>Int.toString: Int =&gt; String</code> to <code>Functor[List].fmap(toString): List[Int] =&gt; List[String]</code></li>\n</ul>\n\n<p>Now every instance of <code>List[X]</code> is a monoid with a <a href=\"https://github.com/non/algebra/blob/ae69096581de077b1e6195eb0e4a4d6446f0001c/core/src/main/scala/algebra/Monoid.scala#L5\" rel=\"nofollow noreferrer\"><code>empty</code> function</a> (<code>mempty</code> in Haskell) and <a href=\"https://github.com/non/algebra/blob/ae69096581de077b1e6195eb0e4a4d6446f0001c/core/src/main/scala/algebra/Semigroup.scala#L9-L9\" rel=\"nofollow noreferrer\"><code>combine</code> function</a> (<code>mappend</code> in Haskell). My guess is that one can use the fact that Lists are Monoids, to show that <code>map</code> has to map all elements of a list. My feeling here is that if one adds the <a href=\"https://github.com/typelevel/cats/blob/051fb845d6219784de2fe231d8bfecfc1f880fb9/core/src/main/scala/cats/Applicative.scala#L16-L16\" rel=\"nofollow noreferrer\"><code>pure</code> function from Applicative</a>, this gives us a list with just one element of some other type. e.g <code>Applicative[List[Int]].pure(1) == List(1)</code>. Since <code>map(succ)</code> on those elements gives us the singleton list with the next element, this covers all those subsets. Then I suppose the <code>combine</code> function on all those singletons gives us all the other elements of the lists. Somehow I suppose that constrains the way map has to work.</p>\n\n<p>Another suggestive argument is that <code>map</code> has to map functions between lists. Since every element in a <code>List[Int]</code> is of type Int, and if one maps to <code>List[String]</code> one has to map every element of it, or one would not the right type.</p>\n\n<p>So both of those arguments seem to point in the right direction. But I was wondering what was needed to get the rest of the way.</p>\n\n<p><strong>Counterexample?</strong></p>\n\n<p>Why is this not a counterexample map function?</p>\n\n<pre><code>def map[X,Y](f: X=&gt;Y)(l: List[X]): List[Y] = l match {\n  case Nil =&gt; Nil\n  case head::tail=&gt; List(f(head))\n}\n</code></pre>\n\n<p>It seems to follow the rules</p>\n\n<pre><code>val l1 = List(3,2,1)\nval l2 = List(2,10,100)\n\nval plus2 = (x: Int) =&gt; x+ 2\nval plus5 = (x: Int) =&gt; x+5\n\nmap(plus2)(List()) == List()\nmap(plus2)(l1) == List(5)\nmap(plus5)(l1) == List(8)\n\nmap(plus2 compose plus5)(l1) == List(10)\n(map(plus2)_ compose map(plus5)_)(l1) == List(10)\n</code></pre>\n\n<p>Ahh. But it does not fit the id law.</p>\n\n<pre><code>def id[X](x: X): X = x\n\nmap(id[Int] _)(l1) == List(3)\nid(l1) == List(3,2,1)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1461062029, "post_id": 36714461, "comment_id": 61017028, "body": "Teaching to perform such a task using partial functions, when pattern matching would be safer and simpler, should be regarded as a criminal offense. ;-P"}, {"owner": {"reputation": 51, "user_id": 6224002, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b02f66ed6b3bea433f6369ba4c818f14?s=128&d=identicon&r=PG&f=1", "display_name": "HoRnsUp", "link": "https://stackoverflow.com/users/6224002/hornsup"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1461066432, "post_id": 36714461, "comment_id": 61020099, "body": "yeah well my professor thinks otherwise :D"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1461070134, "post_id": 36714461, "comment_id": 61022850, "body": "I can actually understand professors giving these kinds of exercise: they want to make sure you understand <code>head,tail</code>,etc. Still, if I had to teach Haskell I would not mention them (if not at the very end) so to make sure pattern matching is well understood. I&#39;d also postpone guards: lately on SO guards have seen much abuse. Even above the guards <code>null n == True</code> and <code>==False</code> should be avoided. (<code>x == True</code> is equivalent to <code>x</code>, and I&#39;d use <code>otherwise</code> for the last case -- of course, with pattern matching there would be no guards around...)"}], "answers": [{"tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 6, "last_activity_date": 1461059244, "creation_date": 1461059244, "answer_id": 36714717, "question_id": 36714461, "link": "https://stackoverflow.com/questions/36714461/product-of-elements-in-a-list-by-using-head-tail-and-null/36714717#36714717", "title": "Product of Elements in a list by using head, tail and null", "body": "<p>You've almost got it! You just need to recursively call <code>prod</code> to get the product of the tail of the list, then multiply the head of the list by the result.</p>\n\n<pre><code>prod :: [Int] -&gt; Int\nprod xs\n    | null xs = 1\n    | otherwise = head xs * prod (tail xs)  -- note recursive call to prod\n</code></pre>\n\n<p>Incidentally, it's more idiomatic to use <em>pattern matching</em> to deconstruct your list, rather than manually calling <code>head</code>, <code>tail</code> and <code>null</code>.</p>\n\n<pre><code>prod [] = 1\nprod (x:xs) = x * prod xs\n</code></pre>\n\n<p>Hopefully you can see how this is equivalent to the code above.</p>\n\n<p>Terser still is expressing <code>prod</code> as a <em>fold</em>:</p>\n\n<pre><code>prod = foldr (*) 1\n</code></pre>\n\n<p><code>foldr</code> is the standard Haskell idiom for consuming a list one element at a time. It's defined like this:</p>\n\n<pre><code>foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b\nfoldr f acc [] = acc\nfoldr f acc (x:xs) = f x acc (foldr f acc xs)\n</code></pre>\n\n<p>Substitute <code>*</code> for <code>f</code> and <code>1</code> for <code>acc</code> in that definition and you'll recover <code>prod</code> from above.</p>\n"}], "owner": {"reputation": 51, "user_id": 6224002, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b02f66ed6b3bea433f6369ba4c818f14?s=128&d=identicon&r=PG&f=1", "display_name": "HoRnsUp", "link": "https://stackoverflow.com/users/6224002/hornsup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 548, "favorite_count": 0, "accepted_answer_id": 36714717, "answer_count": 1, "score": 2, "last_activity_date": 1461059244, "creation_date": 1461058666, "question_id": 36714461, "link": "https://stackoverflow.com/questions/36714461/product-of-elements-in-a-list-by-using-head-tail-and-null", "title": "Product of Elements in a list by using head, tail and null", "body": "<p>So basically i am supposed to use head to take the first element and multiply and iterate through the list with tail and null. I am very new to haskell so i do not understand the flow control at all. The code below already works i just need to figure out where to use tail and iterate through the list.</p>\n\n<pre><code>module Blueprint where\nimport Prelude\n\n\nx=1\nprod :: [Integer] -&gt; Integer\nprod n \n|null n == True = 0\n|null n== False = x*head n \n</code></pre>\n\n<p>adding some pseudo code:</p>\n\n<pre><code>x=1\nprod :: [Integer] -&gt; Integer\nprod n \n|null n == True = 0\n|null n== False = x*head n  do tail n repeat until null n == true   \n</code></pre>\n\n<p>Any help would be great. Thanks.</p>\n"}, {"tags": ["haskell", "cabal", "haskell-stack"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1461058371, "post_id": 36713727, "comment_id": 61014490, "body": "Wouldn&#39;t fixing the package be a better solution...?"}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1461058531, "post_id": 36713727, "comment_id": 61014613, "body": "sure, but that&#39;s like saying we don&#39;t need defer-type-errors"}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1461058691, "post_id": 36713727, "comment_id": 61014744, "body": "and actually in that case, there is no type error per se. it compiles fine with ghc, but ghcjs maps to some other primitive type unfortunately"}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1461058721, "post_id": 36713727, "comment_id": 61014772, "body": "GHCJS maps replace CTime with HTYPE_TIME_T (<a href=\"https://github.com/ghcjs/ghcjs-boot/blob/master/boot/base/Foreign/C/Types.hs\" rel=\"nofollow noreferrer\">github.com/ghcjs/ghcjs-boot/blob/master/boot/base/Foreign/C&zwnj;&#8203;/&hellip;</a>) and maps this symbol to Int32 (<a href=\"https://github.com/ghcjs/ghcjs/blob/master/include/HsBaseConfig.h\" rel=\"nofollow noreferrer\">github.com/ghcjs/ghcjs/blob/master/include/HsBaseConfig.h</a>) whereas ghc maps to Int64"}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1461058795, "post_id": 36713727, "comment_id": 61014811, "body": "ideally we&#39;d have no error etc.. but since I dont use that code anyway, the escape latch would be useful, if it&#39;s not a general one"}, {"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 1, "creation_date": 1461071658, "post_id": 36713727, "comment_id": 61024116, "body": "If you really have to you can <a href=\"https://github.com/commercialhaskell/stack/blob/master/doc/yaml_configuration.md#ghc-options\" rel=\"nofollow noreferrer\">set ghc options per package in <code>stack.yaml</code></a>. I&#39;m not sure whether it&#39;s compatible with ghcjs."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1461085875, "post_id": 36713727, "comment_id": 61034322, "body": "@nicolas I think it&#39;s different than saying we don&#39;t need <code>-fdefer-type-errors</code>: that flag can be a useful tool during development without ever once appearing in a production system."}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1461139296, "post_id": 36713727, "comment_id": 61057314, "body": "@DanielWagner and that can be useful here too. I know I don&#39;t use the problematic library. Fixing some constant deep in the guts of GHCJS with potentially rippling consequences for something I dont use is of little benefit"}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1461139903, "post_id": 36713727, "comment_id": 61057730, "body": "@DanielWagner I agree that the burden of proof is too big for me to claim that this equate to saying we dont need defer-type-error in every scenario you might use it for. my bad :)"}, {"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "reply_to_user": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 0, "creation_date": 1461147616, "post_id": 36713727, "comment_id": 61063467, "body": "@zakyggaps can you put that as an answer. that&#39;s a useful setting to know about"}], "answers": [{"tags": [], "owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "is_accepted": true, "score": 2, "last_activity_date": 1461151278, "last_edit_date": 1461151278, "creation_date": 1461150388, "answer_id": 36741885, "question_id": 36713727, "link": "https://stackoverflow.com/questions/36713727/runtime-type-checking-with-haskell-cabal-stack/36741885#36741885", "title": "runtime type checking with haskell / cabal / stack", "body": "<p>If you really have to you can <a href=\"https://github.com/commercialhaskell/stack/blob/master/doc/yaml_configuration.md#ghc-options\" rel=\"nofollow\">set ghc options per package in stack.yaml</a>, namely:</p>\n\n<pre><code>ghc-options:\n    your_package_name: -fdefer-type-errors\n</code></pre>\n\n<p>I'm not sure whether it's compatible with ghcjs.</p>\n\n<p>But please be sure to make the users of your package aware, maybe include a disclaimer in the document in <strong>big bold fonts</strong>.</p>\n"}], "owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 36741885, "answer_count": 1, "score": 2, "last_activity_date": 1483520121, "creation_date": 1461056840, "last_edit_date": 1483520121, "question_id": 36713727, "link": "https://stackoverflow.com/questions/36713727/runtime-type-checking-with-haskell-cabal-stack", "title": "runtime type checking with haskell / cabal / stack", "body": "<p>In a Haskell project, I am using a dependency which I know contains type error. But that's actually fine as I never call this code.</p>\n\n<p>So I want to enable  <code>defer-type-errors</code> but <strong><em>only for that dependent package</em></strong>.</p>\n\n<p>Is there a way to scope that compiler instruction somewhere (stack ? cabal?)</p>\n"}, {"tags": ["haskell", "combinations"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1461043675, "post_id": 36709050, "comment_id": 61005693, "body": "Is this supposed to scale past 6 Xs and 3 Qs? A naive approach looks easy - but there is a more efficient dynamic programming solution."}, {"owner": {"reputation": 1455, "user_id": 5050863, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10205087533363171/picture?type=large", "display_name": "sschilli", "link": "https://stackoverflow.com/users/5050863/sschilli"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1461043837, "post_id": 36709050, "comment_id": 61005762, "body": "I am trying to scale this to bigger <code>n</code> where there are <code>n*n-n</code> Xs and <code>n</code> Qs. The above example is just with <code>n=3</code>."}], "answers": [{"tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": false, "score": 3, "last_activity_date": 1461044881, "last_edit_date": 1461044881, "creation_date": 1461044454, "answer_id": 36709496, "question_id": 36709050, "link": "https://stackoverflow.com/questions/36709050/generating-all-combinations-of-6-xs-with-3-qs-in-haskell/36709496#36709496", "title": "Generating all combinations of 6 Xs with 3 Qs in Haskell", "body": "<p>Here is a dynamic programming solution using <code>Data.Array</code>. <code>mem</code> just stores memoized values.</p>\n\n<pre><code>import Data.Array\n\nstrings :: Int -&gt; Int -&gt; [String]\nstrings n m = strings' n m\n  where\n    mem :: Array (Int,Int) [String]\n    mem = array ((0,0),(n,m)) [ ((i,j), strings' i j) | i &lt;- [0..n], j &lt;- [0..m] ]\n\n    strings' 0 m = [replicate m 'X']\n    strings' n 0 = [replicate n 'Q']\n    strings' n m = (('Q':) &lt;$&gt; mem ! (n-1,m)) ++ (('X':) &lt;$&gt; mem ! (n,m-1))\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1461055224, "post_id": 36710055, "comment_id": 61012190, "body": "@Alec Our solutions are pretty close in performance. On my machine, <code>stringsDmwit 11 11</code> takes 0.44s and 62MB while <code>stringsAlec 11 11</code> takes 0.63s and 148MB. At time of writing, all other solutions suggested are much less performant."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 3, "last_activity_date": 1461054394, "last_edit_date": 1461054394, "creation_date": 1461046742, "answer_id": 36710055, "question_id": 36709050, "link": "https://stackoverflow.com/questions/36709050/generating-all-combinations-of-6-xs-with-3-qs-in-haskell/36710055#36710055", "title": "Generating all combinations of 6 Xs with 3 Qs in Haskell", "body": "<p>The naive solution is to recursively choose one of <code>X</code> or <code>Q</code> until we run out of choices to make. This is especially convenient when using the list monad to model the nondeterministic choice, and leads to quite short code:</p>\n\n<pre><code>stringsNondet m 0 = [replicate m 'X']\nstringsNondet 0 n = [replicate n 'Q']\nstringsNondet m n = do\n    (char, m', n') &lt;- [('X', m-1, n), ('Q', m, n-1)]\n    rest &lt;- stringsNondet m' n'\n    return (char:rest)\n</code></pre>\n\n<p>The disadvantage of this approach is that it does a lot of extra work. If we choose an <code>X</code> and then choose a <code>Q</code>, the continuations are the same as if we had chosen a <code>Q</code> and then an <code>X</code>, but these continuations will be recomputed in the above. (And similarly for other choice paths that lead to shared continuations.)</p>\n\n<p>Alec has posted a dynamic programming solution which solves this problem by introducing a recursively-defined array to share the subcomputations. I like this solution, but the recursive definition is a bit mind-bending. The following solution is also a dynamic programming solution -- subcomputations are also shared -- but uses no hand-written recursion. It does make use of standard recursive patterns (<code>map</code>, <code>zip</code>, <code>iterate</code>, <code>++</code>, and <code>!!</code>) but notably does not require \"tying the knot\" as Alec's solution does.</p>\n\n<p>As a warmup, let's discuss the type of the function of interest to us:</p>\n\n<pre><code>step :: [[String]] -&gt; [[String]]\n</code></pre>\n\n<p>The final result of interest to us is <code>[String]</code>, a collection of strings with a fixed number <code>m</code> of <code>'X'</code>s and a fixed number <code>n</code> of <code>'Q'</code>s. The <code>step</code> function will expect a collection of results, all of the same length, and will assume that the result at index <code>m</code> has <code>m</code> copies of <code>'X'</code>. It will also produce a result with these properties, and where each result is one longer than the input results.</p>\n\n<p>We implement <code>step</code> by producing two intermediate <code>[[String]]</code>s, one with an extra <code>'X'</code> compared to the input results and one with an extra <code>'Q'</code>. These two intermediates can then be zipped together with a little \"stutter\" to represent the slight difference in <code>'X'</code> count between them. Thus:</p>\n\n<pre><code>step css = zipWith (++)\n    ([[]] ++ map (map ('X':)) css)\n    (map (map ('Q':)) css ++ [[]])\n</code></pre>\n\n<p>The top-level function is now easy to write: we simply index into the iterated version of <code>step</code> by the length of the final string we want, then index into the list of results we get that way by the number of <code>'X'</code>s we want.</p>\n\n<pre><code>strings m n = iterate step [[[]]] !! (m+n) !! m\n</code></pre>\n\n<p>A bonus of this approach is the single, aesthetically pleasing base case of <code>[[[]]]</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 1, "creation_date": 1461050907, "post_id": 36710375, "comment_id": 61009456, "body": "Since <code>permutations</code> will generate (n+m)! Strings and <code>nub</code> is quadratic in input size, this is spectacularly inefficient: <code>O(((n+m)!)^2)</code>. Add just one extra X or Q and it hangs for a while - I stopped it after a couple seconds."}], "tags": [], "owner": {"reputation": 22253, "user_id": 126916, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4d29918c109bc75d2a1fd8420660d72b?s=128&d=identicon&r=PG", "display_name": "Abhinav Sarkar", "link": "https://stackoverflow.com/users/126916/abhinav-sarkar"}, "is_accepted": false, "score": 1, "last_activity_date": 1461051082, "last_edit_date": 1461051082, "creation_date": 1461047874, "answer_id": 36710375, "question_id": 36709050, "link": "https://stackoverflow.com/questions/36709050/generating-all-combinations-of-6-xs-with-3-qs-in-haskell/36710375#36710375", "title": "Generating all combinations of 6 Xs with 3 Qs in Haskell", "body": "<p>Use <code>permutations</code> and <code>nub</code> functions from <code>Data.List</code>:</p>\n\n<pre><code>Prelude Data.List&gt; nub $ permutations \"XXXXXXQQQ\"\n[\"XXXXXXQQQ\",\"QXXXXXXQQ\",\"XQXXXXXQQ\",\"XXQXXXXQQ\",\"XXXQXXXQQ\",\"XXXXQXXQQ\",\"XXXXXQXQQ\",\"QQXXXXXXQ\",\"QXQXXXXXQ\",\"QXXQXXXXQ\",\"QXXXQXXXQ\",\"QXXXXQXXQ\",\"QXXXXXQXQ\",\"XQQXXXXXQ\",\"XQXQXXXXQ\",\"XQXXQXXXQ\",\"XQXXXQXXQ\",\"XQXXXXQXQ\",\"XXQQXXXXQ\",\"XXQXQXXXQ\",\"XXQXXQXXQ\",\"XXQXXXQXQ\",\"XXXQQXXXQ\",\"XXXQXQXXQ\",\"XXXQXXQXQ\",\"XXXXQQXXQ\",\"XXXXQXQXQ\",\"XXXXXQQXQ\",\"QQQXXXXXX\",\"QQXQXXXXX\",\"QQXXQXXXX\",\"QQXXXQXXX\",\"QQXXXXQXX\",\"QQXXXXXQX\",\"QXQQXXXXX\",\"XQQQXXXXX\",\"XQQXQXXXX\",\"XQQXXQXXX\",\"XQQXXXQXX\",\"XQQXXXXQX\",\"QXQXQXXXX\",\"QXQXXQXXX\",\"QXQXXXQXX\",\"QXQXXXXQX\",\"QXXQQXXXX\",\"XQXQQXXXX\",\"XXQQQXXXX\",\"XXQQXQXXX\",\"XXQQXXQXX\",\"XXQQXXXQX\",\"XQXQXQXXX\",\"XQXQXXQXX\",\"XQXQXXXQX\",\"QXXQXQXXX\",\"QXXQXXQXX\",\"QXXQXXXQX\",\"QXXXQQXXX\",\"XQXXQQXXX\",\"XXQXQQXXX\",\"XXXQQQXXX\",\"XXXQQXQXX\",\"XXXQQXXQX\",\"XXQXQXQXX\",\"XXQXQXXQX\",\"XQXXQXQXX\",\"XQXXQXXQX\",\"QXXXQXQXX\",\"QXXXQXXQX\",\"QXXXXQQXX\",\"XQXXXQQXX\",\"XXQXXQQXX\",\"XXXQXQQXX\",\"XXXXQQQXX\",\"XXXXQQXQX\",\"XXXQXQXQX\",\"XQXXXQXQX\",\"QXXXXQXQX\",\"XXQXXQXQX\",\"QXXXXXQQX\",\"XQXXXXQQX\",\"XXQXXXQQX\",\"XXXQXXQQX\",\"XXXXQXQQX\",\"XXXXXQQQX\"]\n</code></pre>\n\n<p>We can have a faster implementation as well:</p>\n\n<pre><code>insertAtEvery x []     = [[x]]\ninsertAtEvery x (y:ys) = (x:y:ys) : map (y:) (insertAtEvery x ys)\n\ncombinations []     = [[]]\ncombinations (x:xs) = nub . concatMap (insertAtEvery x) . combinations $ xs\n</code></pre>\n\n<p>Comparison with the previous solution in ghci:</p>\n\n<pre><code>Prelude Data.List&gt; (sort . nub . permutations $ \"XXXXXXQQQ\") == (sort . combinations $ \"XXXXXXQQQ\")\nTrue\nPrelude Data.List&gt; :set +s\nPrelude Data.List&gt; combinations \"XXXXXXQQQ\"\n[\"XXXXXXQQQ\",\"XXXXXQXQQ\",\"XXXXXQQXQ\",\"XXXXXQQQX\",\"XXXXQXXQQ\",\"XXXXQXQXQ\",\"XXXXQXQQX\",\"XXXXQQXXQ\",\"XXXXQQXQX\",\"XXXXQQQXX\",\"XXXQXXXQQ\",\"XXXQXXQXQ\",\"XXXQXXQQX\",\"XXXQXQXXQ\",\"XXXQXQXQX\",\"XXXQXQQXX\",\"XXXQQXXXQ\",\"XXXQQXXQX\",\"XXXQQXQXX\",\"XXXQQQXXX\",\"XXQXXXXQQ\",\"XXQXXXQXQ\",\"XXQXXXQQX\",\"XXQXXQXXQ\",\"XXQXXQXQX\",\"XXQXXQQXX\",\"XXQXQXXXQ\",\"XXQXQXXQX\",\"XXQXQXQXX\",\"XXQXQQXXX\",\"XXQQXXXXQ\",\"XXQQXXXQX\",\"XXQQXXQXX\",\"XXQQXQXXX\",\"XXQQQXXXX\",\"XQXXXXXQQ\",\"XQXXXXQXQ\",\"XQXXXXQQX\",\"XQXXXQXXQ\",\"XQXXXQXQX\",\"XQXXXQQXX\",\"XQXXQXXXQ\",\"XQXXQXXQX\",\"XQXXQXQXX\",\"XQXXQQXXX\",\"XQXQXXXXQ\",\"XQXQXXXQX\",\"XQXQXXQXX\",\"XQXQXQXXX\",\"XQXQQXXXX\",\"XQQXXXXXQ\",\"XQQXXXXQX\",\"XQQXXXQXX\",\"XQQXXQXXX\",\"XQQXQXXXX\",\"XQQQXXXXX\",\"QXXXXXXQQ\",\"QXXXXXQXQ\",\"QXXXXXQQX\",\"QXXXXQXXQ\",\"QXXXXQXQX\",\"QXXXXQQXX\",\"QXXXQXXXQ\",\"QXXXQXXQX\",\"QXXXQXQXX\",\"QXXXQQXXX\",\"QXXQXXXXQ\",\"QXXQXXXQX\",\"QXXQXXQXX\",\"QXXQXQXXX\",\"QXXQQXXXX\",\"QXQXXXXXQ\",\"QXQXXXXQX\",\"QXQXXXQXX\",\"QXQXXQXXX\",\"QXQXQXXXX\",\"QXQQXXXXX\",\"QQXXXXXXQ\",\"QQXXXXXQX\",\"QQXXXXQXX\",\"QQXXXQXXX\",\"QQXXQXXXX\",\"QQXQXXXXX\",\"QQQXXXXXX\"]\n(0.01 secs, 3,135,792 bytes)\nPrelude Data.List&gt; nub $ permutations \"XXXXXXQQQ\"\n[\"XXXXXXQQQ\",\"QXXXXXXQQ\",\"XQXXXXXQQ\",\"XXQXXXXQQ\",\"XXXQXXXQQ\",\"XXXXQXXQQ\",\"XXXXXQXQQ\",\"QQXXXXXXQ\",\"QXQXXXXXQ\",\"QXXQXXXXQ\",\"QXXXQXXXQ\",\"QXXXXQXXQ\",\"QXXXXXQXQ\",\"XQQXXXXXQ\",\"XQXQXXXXQ\",\"XQXXQXXXQ\",\"XQXXXQXXQ\",\"XQXXXXQXQ\",\"XXQQXXXXQ\",\"XXQXQXXXQ\",\"XXQXXQXXQ\",\"XXQXXXQXQ\",\"XXXQQXXXQ\",\"XXXQXQXXQ\",\"XXXQXXQXQ\",\"XXXXQQXXQ\",\"XXXXQXQXQ\",\"XXXXXQQXQ\",\"QQQXXXXXX\",\"QQXQXXXXX\",\"QQXXQXXXX\",\"QQXXXQXXX\",\"QQXXXXQXX\",\"QQXXXXXQX\",\"QXQQXXXXX\",\"XQQQXXXXX\",\"XQQXQXXXX\",\"XQQXXQXXX\",\"XQQXXXQXX\",\"XQQXXXXQX\",\"QXQXQXXXX\",\"QXQXXQXXX\",\"QXQXXXQXX\",\"QXQXXXXQX\",\"QXXQQXXXX\",\"XQXQQXXXX\",\"XXQQQXXXX\",\"XXQQXQXXX\",\"XXQQXXQXX\",\"XXQQXXXQX\",\"XQXQXQXXX\",\"XQXQXXQXX\",\"XQXQXXXQX\",\"QXXQXQXXX\",\"QXXQXXQXX\",\"QXXQXXXQX\",\"QXXXQQXXX\",\"XQXXQQXXX\",\"XXQXQQXXX\",\"XXXQQQXXX\",\"XXXQQXQXX\",\"XXXQQXXQX\",\"XXQXQXQXX\",\"XXQXQXXQX\",\"XQXXQXQXX\",\"XQXXQXXQX\",\"QXXXQXQXX\",\"QXXXQXXQX\",\"QXXXXQQXX\",\"XQXXXQQXX\",\"XXQXXQQXX\",\"XXXQXQQXX\",\"XXXXQQQXX\",\"XXXXQQXQX\",\"XXXQXQXQX\",\"XQXXXQXQX\",\"QXXXXQXQX\",\"XXQXXQXQX\",\"QXXXXXQQX\",\"XQXXXXQQX\",\"XXQXXXQQX\",\"XXXQXXQQX\",\"XXXXQXQQX\",\"XXXXXQQQX\"]\n(0.71 secs, 161,726,128 bytes)\n</code></pre>\n"}], "owner": {"reputation": 1455, "user_id": 5050863, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10205087533363171/picture?type=large", "display_name": "sschilli", "link": "https://stackoverflow.com/users/5050863/sschilli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1461054394, "creation_date": 1461042495, "question_id": 36709050, "link": "https://stackoverflow.com/questions/36709050/generating-all-combinations-of-6-xs-with-3-qs-in-haskell", "title": "Generating all combinations of 6 Xs with 3 Qs in Haskell", "body": "<p>I am trying to generate a list of all strings that consist of 6 Xs and 3 Qs.</p>\n\n<p>A subset of the list I am trying to generate is as follows:</p>\n\n<pre><code>[\"XXXXXXQQQ\", \"XQXXQXXQX\", \"QXQXQXXXX\",...\n</code></pre>\n\n<p>What is a good way to go about this?</p>\n"}, {"tags": ["list", "haskell", "functional-programming"], "answers": [{"comments": [{"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 0, "creation_date": 1461351973, "post_id": 36707570, "comment_id": 61177036, "body": "Nitpick: a right fold can short-circuit <b>in a lazily evaluated language</b> like Haskell. But this is of course a very important point to know!  Many people who come to Haskell have experience with eagerly evaluated languages, where right folds are often shunned because they (a) continue to the end of the list and (b) blow the stack on long lists. But Haskell&#39;s <code>foldr</code> can be and is often used in ways that don&#39;t have that problem\u2014and in fact, in Haskell <code>foldl</code> is the one that more often risks blowing the stack!"}], "tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": true, "score": 9, "last_activity_date": 1461034125, "last_edit_date": 1461034125, "creation_date": 1461033701, "answer_id": 36707570, "question_id": 36707461, "link": "https://stackoverflow.com/questions/36707461/take-from-a-list-while-increasing/36707570#36707570", "title": "Take From a List While Increasing", "body": "<blockquote>\n  <p>A fold [...] would continue to the end of the list. I would like the function to stop taking at the first instance the constraint is not met. </p>\n</blockquote>\n\n<p>A right fold can short circuit:</p>\n\n<pre><code>fun :: Ord a =&gt; [a] -&gt; [a]\nfun []     = []\nfun (x:xs) = x: foldr go (const []) xs x\n    where go x f i = if i &lt; x then x: f x else []\n</code></pre>\n\n<p>then, </p>\n\n<pre><code>\\&gt; fun [1,2,3,4,3,undefined]\n[1,2,3,4]\n</code></pre>\n\n<p>or infinite size list:</p>\n\n<pre><code>\\&gt; fun $ [1,2,3,4,3] ++ [1..]\n[1,2,3,4]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 4, "last_activity_date": 1461048997, "last_edit_date": 1461048997, "creation_date": 1461042634, "answer_id": 36709086, "question_id": 36707461, "link": "https://stackoverflow.com/questions/36707461/take-from-a-list-while-increasing/36709086#36709086", "title": "Take From a List While Increasing", "body": "<p>Right folds are magical, so you never even have to pattern match on the list.</p>\n\n<pre><code>twi xs = foldr go (const []) xs Nothing where\n  go x _ (Just prev)\n    | x &lt; prev = []\n  go x r _ = x : r (Just x)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1461051102, "creation_date": 1461051102, "answer_id": 36711485, "question_id": 36707461, "link": "https://stackoverflow.com/questions/36707461/take-from-a-list-while-increasing/36711485#36711485", "title": "Take From a List While Increasing", "body": "<p>A solution without folds:</p>\n\n<pre><code>takeIncreasing :: Ord a =&gt; [a] -&gt; [a]\ntakeIncreasing [] = []\ntakeIncreasing (x:xs) = (x :) . map snd . takeWhile (uncurry (&lt;)) $ zip (x:xs) xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 765, "user_id": 3316409, "user_type": "registered", "profile_image": "https://graph.facebook.com/719585406/picture?type=large", "display_name": "dvaergiller", "link": "https://stackoverflow.com/users/3316409/dvaergiller"}, "is_accepted": false, "score": 3, "last_activity_date": 1461072112, "last_edit_date": 1461072112, "creation_date": 1461066808, "answer_id": 36717596, "question_id": 36707461, "link": "https://stackoverflow.com/questions/36707461/take-from-a-list-while-increasing/36717596#36717596", "title": "Take From a List While Increasing", "body": "<p>Or one that IMO has a bit less code complexity:</p>\n\n<pre><code>takeIncreasing :: Ord x =&gt; [x] -&gt; [x]\ntakeIncreasing (x:x':xs) | x &lt; x'    = x : takeIncreasing (x':xs)\n                         | otherwise = [x]\ntakeIncreasing xs = xs\n</code></pre>\n\n<p>This one is just a bit less clever than previous suggestions. I like un-clever code.</p>\n"}], "owner": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 0, "accepted_answer_id": 36707570, "answer_count": 4, "score": 3, "last_activity_date": 1461072112, "creation_date": 1461032864, "question_id": 36707461, "link": "https://stackoverflow.com/questions/36707461/take-from-a-list-while-increasing", "title": "Take From a List While Increasing", "body": "<p>I have a list of values that I would like to take from while the value is increasing. I assume it would always take the head of the list and then compare it to the next value. The function will continue to take as long as this continues to increase. Upon reaching an list element that is less than or equal the pervious value the list is returned.</p>\n\n<pre><code>takeIncreasing :: (Ord a) =&gt; [a] -&gt; [a]\ntakeIncreasing [1,2,3,4,3,5,6,7,8] -- Should return [1,2,3,4]\n</code></pre>\n\n<p>A fold could compare the <code>last</code> element of  the accumulation with the next value and append if the condition is met, but would continue to the end of the list. I would like the function to stop taking at the first instance the constraint is not met. </p>\n\n<p>This seems like an application of a monad but cannot determine if an existing monad accomplishes this. </p>\n"}, {"tags": ["haskell", "grid-layout"], "comments": [{"owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 1, "creation_date": 1461028138, "post_id": 36706700, "comment_id": 61001372, "body": "<code>[(x, y) | x &lt;- [0..n-1], y &lt;- [0..n-1]]</code> for row-major, or <code>[(y, x) ...]</code> for column-major."}, {"owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 0, "creation_date": 1461028238, "post_id": 36706700, "comment_id": 61001405, "body": "Also see <a href=\"http://stackoverflow.com/questions/8029046/\">this question</a> which generates the exact desired output (although it is a different question)."}, {"owner": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "edited": false, "score": 0, "creation_date": 1461034939, "post_id": 36706700, "comment_id": 61003156, "body": "<code>grid d n = sequence $ replicate d [0..n]</code> will generate a <code>d</code> dimensional grid of size <code>n</code>. This can be partially evaluated to get a 2 dimensional grid <code>2dGrid = grid 2</code>."}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 3, "creation_date": 1461037391, "post_id": 36706700, "comment_id": 61003771, "body": "this is also almost a duplicate of <a href=\"http://stackoverflow.com/questions/4119730/cartesian-product\">stackoverflow.com/questions/4119730/cartesian-product</a>, which gives a bunch of alternate solns.  My favorite is <code>(,) &lt;$&gt; [0..x] &lt;*&gt; [0..x]</code>"}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 5, "last_activity_date": 1461047968, "creation_date": 1461047968, "answer_id": 36710411, "question_id": 36706700, "link": "https://stackoverflow.com/questions/36706700/generating-tuples-of-grid-coordinates-in-haskell/36710411#36710411", "title": "Generating tuples of grid coordinates in Haskell", "body": "<p>The <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Data-Ix.html\"><code>range</code></a> function does this:</p>\n\n<pre><code>Data.Ix&gt; range ((0, 0), (2, 3))\n[(0,0),(0,1),(0,2),(0,3),(1,0),(1,1),(1,2),(1,3),(2,0),(2,1),(2,2),(2,3)]\n</code></pre>\n"}], "owner": {"reputation": 1455, "user_id": 5050863, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10205087533363171/picture?type=large", "display_name": "sschilli", "link": "https://stackoverflow.com/users/5050863/sschilli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 956, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1461047968, "creation_date": 1461027541, "question_id": 36706700, "link": "https://stackoverflow.com/questions/36706700/generating-tuples-of-grid-coordinates-in-haskell", "title": "Generating tuples of grid coordinates in Haskell", "body": "<p>I want to write a function that generates a list of tuples containing the coordinates of an n by n grid.</p>\n\n<p>For example:</p>\n\n<pre><code>&gt; genGrid 2\n[(0,0),(0,1),(1,0),(1,1)]\n&gt; genGrid 3\n[(0,0),(0,1),(0,2),(1,0),(1,1),(1,2),(2,0),(2,1),(2,2)]\n</code></pre>\n\n<p>I know I can generate a diagonal by doing the following:</p>\n\n<pre><code>genDiagonal n = zip [0..] [0..n-1]\n</code></pre>\n\n<p>I am thinking there is a fairly simple way to do this, perhaps a variant of my diagonal function, but am coming up blank. </p>\n"}, {"tags": ["list", "parsing", "csv", "haskell"], "comments": [{"owner": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "edited": false, "score": 0, "creation_date": 1461045430, "post_id": 36706624, "comment_id": 61006481, "body": "Have you looked into the Parsec library? It allows for the construction of dynamic parsers."}, {"owner": {"reputation": 21, "user_id": 5525481, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8f03ae342914dcc7d1ed0ccbf4b00ace?s=128&d=identicon&r=PG&f=1", "display_name": "NorwegianViking", "link": "https://stackoverflow.com/users/5525481/norwegianviking"}, "reply_to_user": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "edited": false, "score": 0, "creation_date": 1461117930, "post_id": 36706624, "comment_id": 61048688, "body": "First of all; I am very sorry for violating the rules. I will try to clarify by editing my original post, and will not do it again. I am new to this forum, but I still know it is my own responsibility to understand the rules.   Second; I have looked at this, I think, but it overwhelmed me pretty fast. That is why I concluded that my skillset not yet allow me to take advantage of the suggested library."}], "owner": {"reputation": 21, "user_id": 5525481, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8f03ae342914dcc7d1ed0ccbf4b00ace?s=128&d=identicon&r=PG&f=1", "display_name": "NorwegianViking", "link": "https://stackoverflow.com/users/5525481/norwegianviking"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1461119186, "creation_date": 1461026895, "last_edit_date": 1461119186, "question_id": 36706624, "link": "https://stackoverflow.com/questions/36706624/haskell-from-string-to-class-feature-vector-double-double", "title": "Haskell; from [[String]] to Class &amp; Feature-vector (Double, [Double])", "body": "<p>I am struggling with reading from a large data set. I think the main issue is that I don't know how to process lists properly. What I want to do is:</p>\n\n<ol>\n<li>Get the raw-data. </li>\n<li>Drop empty lists in the raw-data. </li>\n<li>Read the features that exist in [[String]]: [####, A/B, #,#,#,#]</li>\n<li>Have the result in [Double, [Double]]: [ 1/0, #,#,#,#]</li>\n</ol>\n\n<p>EDIT: The below post is somewhat messy, therefore I will attempt to summarize/clarify here. I believe the remainder of the topic can be skipped, but as I am not able to say with certainty what is needed and what is not I leave it there - in case anyone needs it. </p>\n\n<p>So far I have two functions, and the next step is to implement a third that calls on both of them. The goal further down the road is to parse through a dataset, giving me a list of lists of Doubles - with a class label and a feature vector for each instance. </p>\n\n<p>However, for the time being I will  be happy with just calling the function with a \"dummy\" string. Baby steps.   </p>\n\n<p>The functions I have implemented, and that works separately are \"numericLabel\" and \"numericFeatures\". </p>\n\n<p>Example of raw data <code>([String]) = [32142, \"B\", 1,2,0.4,3,2]</code>\n                     Meaning: (ID#, Class label, features) </p>\n\n<pre><code>numericLabel :: [Char] -&gt; Int \nnumericLabel x = (if(isBenign x)\n                    then 1\n                    else if(isMalign x)\n                    then -1\n                    else 0)\n\n\n\nnumericFeatures :: [String] -&gt; [Double]\nnumericFeatures [] = []\nnumericFeatures (x:xs) = (read x :: Double) : numericFeatures xs\n</code></pre>\n\n<p>These two functions works by calling numericLabel \"B or M\" and numericFeatures [1,2,0.4,3,2]. The first returns Double, the second returns [Double]. Both read from String. </p>\n\n<p>The function I am having a hard time implementing is one that takes the whole [String], including both the redundant \"ID\", the char for conversion to Double, and the [String] for conversion to [Double]. </p>\n\n<p>Goal: To call on <code>processItem [32142, \"B\", 1,2,0.4,3,2]</code> which then in turns call on the abovementioned functions for the different parts of the Item, <code>returning: (Double,[Double]) (for this example: (1,[1.0 2.0 0.4 3.0 2.0]) )</code></p>\n\n<p>PARSING: As benjic mentions, parsing is probably the solution I would be looking for if I knew what I was doing. But trying to utilize parsing examples was pretty much impossible within the scope of my skillset. </p>\n\n<p>ASMENTIONED: Below here is what I consider to be unneccessary information, I believe all is stated in this \"EDIT\". But for possible need I leave it there. </p>\n\n<pre><code>import Text.CSV\n\ntype Label = Double\ntype Feats = [Double]\n\ngetRawData' :: String -&gt; IO [[String]]\ngetRawData' fn = do\n    s &lt;- readFile fn \n    return $ parseCSVsimple s \n-- Return: Wraps given value in an IO action. \n\ngetRawData :: String -&gt; IO [[String]]\ngetRawData fn = do\n    d &lt;- getRawData' fn\n    return (dropEmpty d)\n\ndropEmpty :: [[String]] -&gt; [[String]]\ndropEmpty d = filter(not . null) d --filter(not.null) d\n\nisBenign :: [Char] -&gt; Bool\nisBenign x = x == \"M\" \nisMalign :: [Char] -&gt; Bool\nisMalign x = x == \"B\" \n\nisChar :: [Char] -&gt; Bool\nisChar = (`elem` ['A'..'Z'])\n\nnumericLabel :: [Char] -&gt; Int \nnumericLabel x = (if(isBenign x)\n                then 1\n                else if(isMalign x)\n                then -1\n                else 0)\n\nnumericFeatures :: [String] -&gt; [Double]\nnumericFeatures [] = []\nnumericFeatures (x:xs) = (read x :: Double) : numericFeatures xs\n\n\nThis below here is just garbage, and what I need help with. \n--processItem :: [String] -&gt; (Label,Feats)\n--processItem st takeWhile (not . isChar)  \n--processItem   Label = numericLabel filter (isChar) x:xs \n--processItem   Feats = numericFeatures filter (not . isChar) x:xs  \n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 3, "creation_date": 1461024727, "post_id": 36706339, "comment_id": 61000521, "body": "Is parsing the URI then opening the file out of the question?"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1461048030, "post_id": 36706339, "comment_id": 61007689, "body": "Note that <code>download</code> package can directly operate on file protocol: <a href=\"https://github.com/psibi/download\" rel=\"nofollow noreferrer\">github.com/psibi/download</a>"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1461050267, "post_id": 36706339, "comment_id": 61009012, "body": "Check whether the text begins with <code>file:&#47;&#47;&lt;rest&gt;</code> and then load <code>&#47;&lt;rest&gt;</code>."}, {"owner": {"reputation": 149, "user_id": 1132816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40eb6a9679ea254308099cb066a131ac?s=128&d=identicon&r=PG", "display_name": "seagreen", "link": "https://stackoverflow.com/users/1132816/seagreen"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1461345496, "post_id": 36706339, "comment_id": 61173647, "body": "@ThomasM.DuBuisson not at all! If you want to submit that as an answer, though I won&#39;t know whether to accept it or Sibi&#39;s."}, {"owner": {"reputation": 149, "user_id": 1132816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40eb6a9679ea254308099cb066a131ac?s=128&d=identicon&r=PG", "display_name": "seagreen", "link": "https://stackoverflow.com/users/1132816/seagreen"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1461345514, "post_id": 36706339, "comment_id": 61173655, "body": "@Sibi thanks for the tip. If you want to submit that as an answer."}, {"owner": {"reputation": 149, "user_id": 1132816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40eb6a9679ea254308099cb066a131ac?s=128&d=identicon&r=PG", "display_name": "seagreen", "link": "https://stackoverflow.com/users/1132816/seagreen"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1461345794, "post_id": 36706339, "comment_id": 61173780, "body": "@Zeta that happens not to be correct, it won&#39;t work for non-local files. See the &quot;Non-local files&quot; section here: <a href=\"https://tools.ietf.org/html/draft-ietf-appsawg-file-scheme-03#appendix-A\" rel=\"nofollow noreferrer\">tools.ietf.org/html/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 1, "last_activity_date": 1461347585, "creation_date": 1461347585, "answer_id": 36800369, "question_id": 36706339, "link": "https://stackoverflow.com/questions/36706339/how-do-i-get-the-contents-of-a-uri-that-uses-the-file-protocol-in-haskell/36800369#36800369", "title": "How do I get the contents of a URI that uses the `file` protocol in Haskell?", "body": "<p>You can achieve what you want using the package <a href=\"https://www.stackage.org/package/download\" rel=\"nofollow\">download</a>. But note that the type signature is little different than what you wanted:</p>\n\n<pre><code>openURI :: String -&gt; IO (Either String ByteString) \n</code></pre>\n\n<p>The first String parameter denotes url which can be <code>FTP</code>, <code>HTTP</code> or a file protocol. Note that this package doesn't support <code>HTTPS</code> protocol.</p>\n"}], "owner": {"reputation": 149, "user_id": 1132816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/40eb6a9679ea254308099cb066a131ac?s=128&d=identicon&r=PG", "display_name": "seagreen", "link": "https://stackoverflow.com/users/1132816/seagreen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 36800369, "answer_count": 1, "score": 1, "last_activity_date": 1461347585, "creation_date": 1461024519, "question_id": 36706339, "link": "https://stackoverflow.com/questions/36706339/how-do-i-get-the-contents-of-a-uri-that-uses-the-file-protocol-in-haskell", "title": "How do I get the contents of a URI that uses the `file` protocol in Haskell?", "body": "<p>How can I write a function of the type <code>Text -&gt; IO (Maybe ByteString)</code> where the argument to <code>Text</code> is a URI that uses the <code>file</code> protocol, e.g. <code>file://foo/bar</code>?</p>\n"}, {"tags": ["list", "haskell", "printf"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1461021849, "post_id": 36705679, "comment_id": 60999739, "body": "Do you actually need <code>printf</code>? Tell us more about your actual goal. (&quot;Use <code>printf</code> on a list&quot; is a plan, not a goal.) Perhaps <code>unwords . map show</code> is enough for you."}, {"owner": {"reputation": 49, "user_id": 5724503, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4f822b38f63cbeedbc540c28a69ab75?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Mack", "link": "https://stackoverflow.com/users/5724503/bill-mack"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1461022565, "post_id": 36705679, "comment_id": 60999945, "body": "I want to print a list of floats as text with <code>\\n</code> at the end and the numbers must be in the &quot;%+.2f&quot; form."}, {"owner": {"reputation": 14562, "user_id": 71116, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7e3643cd0195fab5a3bfa310b5ea27e7?s=128&d=identicon&r=PG", "display_name": "Michael Steele", "link": "https://stackoverflow.com/users/71116/michael-steele"}, "edited": false, "score": 0, "creation_date": 1461023253, "post_id": 36705679, "comment_id": 61000114, "body": "@BillMack The most simple thing to do is apply printf to each member of your list individually, and then splice all those short strings together. Something like <code>intercalate &quot; &quot; (map (printf &quot;%+.2f&quot;) [1, 2, 3 :: Float])</code>"}, {"owner": {"reputation": 49, "user_id": 5724503, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4f822b38f63cbeedbc540c28a69ab75?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Mack", "link": "https://stackoverflow.com/users/5724503/bill-mack"}, "edited": false, "score": 0, "creation_date": 1461024775, "post_id": 36705679, "comment_id": 61000540, "body": "Yes, this was I was looking for ! Thanks :)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 14562, "user_id": 71116, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7e3643cd0195fab5a3bfa310b5ea27e7?s=128&d=identicon&r=PG", "display_name": "Michael Steele", "link": "https://stackoverflow.com/users/71116/michael-steele"}, "edited": false, "score": 1, "creation_date": 1461027841, "post_id": 36705679, "comment_id": 61001281, "body": "@MichaelSteele <code>intercalate &quot; &quot;</code> is better spelled <code>unwords</code>."}], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 2, "last_activity_date": 1461050179, "creation_date": 1461050179, "answer_id": 36711140, "question_id": 36705679, "link": "https://stackoverflow.com/questions/36705679/how-to-use-text-printf-on-entire-lists/36711140#36711140", "title": "How to use Text.Printf on entire lists", "body": "<p>You split the task into several smaller ones. You write function that handles a single <code>Double</code>:</p>\n\n<pre><code>show2Decimals :: Double -&gt; String\nshow2Decimals x = printf \"%+.2f\" x\n</code></pre>\n\n<p>Afterwards, you can use standard functions to map all your numbers in your list and splice the resulting strings together:</p>\n\n<pre><code>showDoubleList :: [Double] -&gt; String\nshowDoubleList xs = unlines (map show2Decimals xs)\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 5724503, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4f822b38f63cbeedbc540c28a69ab75?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Mack", "link": "https://stackoverflow.com/users/5724503/bill-mack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 461, "favorite_count": 0, "accepted_answer_id": 36711140, "answer_count": 1, "score": 0, "last_activity_date": 1461050179, "creation_date": 1461020114, "last_edit_date": 1461034869, "question_id": 36705679, "link": "https://stackoverflow.com/questions/36705679/how-to-use-text-printf-on-entire-lists", "title": "How to use Text.Printf on entire lists", "body": "<p>How can I use printf with a specific format like <code>printf \"%d %d\\n\"</code> on a list ?\nFor example, <code>printf \"%d %d %d\\n\", [1, 2, 3]</code></p>\n\n<p>My idea was to create a string based on the list that I want to print using a separate function and parse it to <code>printf</code>. The problem is I can't get printf to treat the list elements as separate arguments. What am I missing ?</p>\n"}, {"tags": ["haskell", "matrix", "accelerate-haskell"], "answers": [{"tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": true, "score": 2, "last_activity_date": 1461171273, "creation_date": 1461171273, "answer_id": 36750371, "question_id": 36705133, "link": "https://stackoverflow.com/questions/36705133/how-to-define-the-matrix-product-in-accelerate-haskell/36750371#36750371", "title": "How to define the matrix product in accelerate-haskell", "body": "<p>Your code is actually correct. Unfortunately the typechecker isn't smart enough to figure it out, so you have to help it: </p>\n\n<pre><code>let (Z:.i:.j) = A.unlift sh\n</code></pre>\n\n<p>becomes</p>\n\n<pre><code>let (Z:.i:.j) = A.unlift sh :: (Z :. Exp Int) :. Exp Int\n</code></pre>\n\n<p>The critical thing here is that <code>A.unlift :: A.Unlift c e =&gt; c (A.Plain e) -&gt; e</code> but <code>A.Plain</code> is an associated type family (and therefore non-injective) so the type <code>e</code> cannot be determined without a type signature, and <code>e</code> is required to select an instance to use for <code>Unlift c e</code>. This is where the 'ambiguous type' errors come from - it is really <code>e</code> that is ambiguous. </p>\n\n<hr>\n\n<p>You also have an unrelated error. <code>aux</code> should have the type</p>\n\n<pre><code>aux :: (IsNum e, Elt e) =&gt; ...\n</code></pre>\n\n<p>or </p>\n\n<pre><code>aux :: (e ~ a) =&gt; ... \n</code></pre>\n\n<p>in the latter case the <code>a</code> is the one in type signature of <code>(#*#)</code> so it already has the constraints <code>IsNum, Elt</code></p>\n"}], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 0, "accepted_answer_id": 36750371, "answer_count": 1, "score": 4, "last_activity_date": 1461171273, "creation_date": 1461017244, "question_id": 36705133, "link": "https://stackoverflow.com/questions/36705133/how-to-define-the-matrix-product-in-accelerate-haskell", "title": "How to define the matrix product in accelerate-haskell", "body": "<p>I am trying to define a typesafe matrix computation library on top of accelerate, partly for educational purposes, partly to see whether this is a practical approach.</p>\n\n<p>But I am completely stuck when it comes to define the product of to matrices properly - i.e. in a way GHC accepts/compiles my code.</p>\n\n<p>I have had a few tries, which were variations of this:</p>\n\n<p><code>Linear.hs</code></p>\n\n<pre><code>{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n\nimport qualified Data.Array.Accelerate as A\n\nimport GHC.TypeLits\nimport Data.Array.Accelerate ( (:.)(..), Array\n                             , Exp, Shape, FullShape, Slice\n                             , DIM0, DIM1, DIM2, Z(Z)\n                             , IsFloating, IsNum, Elt, Acc\n                             , Any(Any), All(All))\nimport           Data.Proxy\n\nnewtype Matrix (rows :: Nat) (cols :: Nat) a = AccMatrix {unMatrix :: Acc (Array DIM2 a)}\n(#*#) :: forall k m n a. (KnownNat k, KnownNat m, KnownNat n, IsNum a, Elt a) =&gt;\n    Matrix k m a -&gt; Matrix m n a -&gt; Matrix k n a\n v #*# w = let v' = unMatrix v\n               w' = unMatrix w\n           in AccMatrix $ A.generate (A.index2 k' n') undefined\n          where k' = fromInteger $ natVal (Proxy :: Proxy k)\n                n' = fromInteger $ natVal (Proxy :: Proxy n)\n                aux :: Acc (Array (FullShape (Z :. Int) :. Int) e) -&gt; Acc (Array (FullShape (Z :. All) :. Int) e) -&gt; Exp ((Z :. Int) :. Int) -&gt; Exp e\n                aux v w sh = let (Z:.i:.j) = A.unlift sh\n                                 v' = A.slice v (A.lift $ Z:.i:.All)\n                                 w' = A.slice w (A.lift $ Z:.All:.j)\n                              in A.the $ A.sum $ A.zipWith (*) v' w'\n</code></pre>\n\n<p>The error <code>stack build</code> gives me is</p>\n\n<pre><code>.../src/Linear.hs:196:55:\n    Couldn't match type \u2018A.Plain ((Z :. head0) :. head1)\u2019\n                   with \u2018(Z :. Int) :. Int\u2019\n    The type variables \u2018head0\u2019, \u2018head1\u2019 are ambiguous\n    Expected type: Exp (A.Plain ((Z :. head0) :. head1))\n      Actual type: Exp ((Z :. Int) :. Int)\n    Relevant bindings include\n      i :: head0 (bound at src/Linear.hs:196:38)\n      j :: head1 (bound at src/Linear.hs:196:41)\n    In the first argument of \u2018A.unlift\u2019, namely \u2018sh\u2019\n    In the expression: A.unlift sh\n\n.../src/Linear.hs:197:47:\n    Couldn't match type \u2018FullShape (A.Plain (Z :. head0))\u2019\n                   with \u2018Z :. Int\u2019\n    The type variable \u2018head0\u2019 is ambiguous\n    Expected type: Acc\n                     (Array (FullShape (A.Plain (Z :. head0) :. All)) e)\n      Actual type: Acc (Array (FullShape (Z :. Int) :. Int) e)\n    Relevant bindings include\n      v' :: Acc (Array (A.SliceShape (A.Plain (Z :. head0)) :. Int) e)\n        (bound at src/Linear.hs:197:34)\n      i :: head0 (bound at src/Linear.hs:196:38)\n    In the first argument of \u2018A.slice\u2019, namely \u2018v\u2019\n    In the expression: A.slice v (A.lift $ Z :. i :. All)\n\n.../src/Linear.hs:198:39:\n    Couldn't match type \u2018A.SliceShape (A.Plain ((Z :. All) :. head1))\u2019\n                   with \u2018A.SliceShape (A.Plain (Z :. head0)) :. Int\u2019\n    The type variables \u2018head0\u2019, \u2018head1\u2019 are ambiguous\n    Expected type: Acc\n                     (Array (A.SliceShape (A.Plain (Z :. head0)) :. Int) e)\n      Actual type: Acc\n                     (Array (A.SliceShape (A.Plain ((Z :. All) :. head1))) e)\n    Relevant bindings include\n      w' :: Acc (Array (A.SliceShape (A.Plain (Z :. head0)) :. Int) e)\n        (bound at src/Linear.hs:198:34)\n      v' :: Acc (Array (A.SliceShape (A.Plain (Z :. head0)) :. Int) e)\n        (bound at src/Linear.hs:197:34)\n      i :: head0 (bound at src/Linear.hs:196:38)\n      j :: head1 (bound at src/Linear.hs:196:41)\n    In the expression: A.slice w (A.lift $ Z :. All :. j)\n    In an equation for \u2018w'\u2019: w' = A.slice w (A.lift $ Z :. All :. j)\n\n.../src/Linear.hs:198:47:\n    Couldn't match type \u2018FullShape (A.Plain ((Z :. All) :. head1))\u2019\n                   with \u2018(Z :. Int) :. Int\u2019\n    The type variable \u2018head1\u2019 is ambiguous\n    Expected type: Acc\n                     (Array (FullShape (A.Plain ((Z :. All) :. head1))) e)\n      Actual type: Acc (Array (FullShape (Z :. All) :. Int) e)\n    Relevant bindings include\n      j :: head1 (bound at src/Linear.hs:196:41)\n    In the first argument of \u2018A.slice\u2019, namely \u2018w\u2019\n    In the expression: A.slice w (A.lift $ Z :. All :. j)\n</code></pre>\n\n<p>I have consulted the documentation of <a href=\"https://hackage.haskell.org/package/accelerate-0.15.1.0/docs/Data-Array-Accelerate.html\" rel=\"nofollow\">Accelerate</a>, and I am also reading <a href=\"https://hackage.haskell.org/package/accelerate-arithmetic\" rel=\"nofollow\">accelerate-arithmetic</a> which has a similar aim but does not use <code>TypeLits</code> in order to assert the array/vector dimensions.</p>\n\n<p>I also tried to make a vanilla version (i.e. without my own matrix type), in case my types were wrong, which I believe is suffering from the same misconception about the usage of <code>slice</code>. I am including this just for completeness' sake, I can add the error messages,but I chose to omit them as I believe they do not relate to the problem above.</p>\n\n<pre><code>(#*#) :: forall a. (IsNum a, Elt a) =&gt;\n    Acc (Array DIM2 a) -&gt; Acc (Array DIM2 a) -&gt; Maybe (Acc (Array DIM2 a))   \nv #*# w = let Z:.k :.m = A.unlift $ A.arrayShape $ I.run v\n              Z:.m':.n = A.unlift $ A.arrayShape $ I.run w\n           in if m /= m'\n                 then Nothing\n                 else Just $ AccMatrix $ A.generate (A.index2 k n) (aux v w)\n          where aux :: Acc (Array DIM2 a) -&gt; Acc (Array DIM2 a) -&gt; Exp DIM2 -&gt; Exp a\n                aux v w sh = let (Z:.i:.j) = A.unlift sh\n                                 v' = A.slice v (A.lift $ Z:.i:.All)\n                                 w' = A.slice w (A.lift $ Z:.All:.j)\n                              in A.the $ A.sum $ A.zipWith (*) v' w'\n</code></pre>\n"}, {"tags": ["haskell", "networking", "proxy"], "answers": [{"comments": [{"owner": {"reputation": 426, "user_id": 1324707, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/136032b0e1156db2d514866cc2b2dff1?s=128&d=identicon&r=PG", "display_name": "Kai", "link": "https://stackoverflow.com/users/1324707/kai"}, "edited": false, "score": 0, "creation_date": 1461061787, "post_id": 36705968, "comment_id": 61016881, "body": "Thanks, that is ugly, yet works. I ended up using HTTP.Conduit instead, as it supports SSL tunnelling."}], "tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": true, "score": 1, "last_activity_date": 1461021904, "creation_date": 1461021904, "answer_id": 36705968, "question_id": 36705065, "link": "https://stackoverflow.com/questions/36705065/make-network-wreq-proxy-from-network-http-proxy-proxy/36705968#36705968", "title": "Make Network.Wreq.Proxy from Network.HTTP.Proxy.Proxy", "body": "<p>It's likely that the Wreq authors were just unaware of the other <code>Proxy</code> as they seem to be storing equivalent information. It'll be tricky to get them to talk to each other, however, since <code>fetchProxy</code> stores the host:port as a string and Wreq's <code>Proxy</code> wants the individual host and port. You'll have to do some URI parsing:</p>\n\n<pre><code>import Control.Lens\nimport Data.Text.Strict.Lens\nimport Network.HTTP.Proxy\nimport Network.Wreq\nimport URI.ByteString\n\nmain :: IO ()\nmain = do\n  Network.HTTP.Proxy.Proxy host _ &lt;- fetchProxy True\n  case parseURI strictURIParserOptions (host ^. packed . re utf8) of\n    Left e -&gt; do\n      putStrLn \"uh oh\"\n      print e\n    Right uri -&gt;\n      case ( uri ^? uriAuthorityL . _Just . authorityHostL . hostBSL\n           , uri ^? uriAuthorityL . _Just . authorityPortL . _Just . portNumberL) of\n        (Just host_, Just port_) -&gt; do\n          let opts = defaults &amp; proxy ?~ httpProxy host_ port_\n          response &lt;- getWith opts \"http://example.com\"\n          print response\n        _ -&gt;\n          putStrLn \"uh oh\"\n</code></pre>\n\n\n\n<p>I'm using <code>lens</code> here to do the boring bits and pieces of packing/unpacking strings, encoding UTF8, and talking to the <code>uri-bytestring</code> package to get URI parsing. But the general idea is that datatypes in Haskell can be sliced and diced simply by pattern matching on the constructor; once extracted, the <code>host:string</code> here is funneled down into the <code>httpProxy</code> call, which returns Wreq's <code>Proxy</code> type. By qualifying the name of the constructor (<code>Newtork.HTTP.Proxy.Proxy</code>) I've let the compiler know which module I want that name from.</p>\n\n<p>It would also not be too difficult, and probably less code to boot, to manually parse proxy information from the environment variables yourself. You could even have a separate environment variable for host and port, which would obviate the need for URI parsing. URIs are have such massively low entropy that they're an awful format for storing configuration information.</p>\n"}], "owner": {"reputation": 426, "user_id": 1324707, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/136032b0e1156db2d514866cc2b2dff1?s=128&d=identicon&r=PG", "display_name": "Kai", "link": "https://stackoverflow.com/users/1324707/kai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 36705968, "answer_count": 1, "score": 0, "last_activity_date": 1461021904, "creation_date": 1461016933, "question_id": 36705065, "link": "https://stackoverflow.com/questions/36705065/make-network-wreq-proxy-from-network-http-proxy-proxy", "title": "Make Network.Wreq.Proxy from Network.HTTP.Proxy.Proxy", "body": "<p><a href=\"https://hackage.haskell.org/package/HTTP-4000.3.3/docs/Network-HTTP-Proxy.html\" rel=\"nofollow\">Network.HTTP.Proxy</a> has a nice function called <code>fetchProxy</code>:</p>\n\n<pre><code>fetchProxy :: Bool -&gt; IO Proxy\n</code></pre>\n\n<blockquote>\n  <p>fetchProxy flg gets the local proxy settings and parse the string into\n  a Proxy value. If you want to be informed of ill-formed proxy\n  configuration strings, supply True for flg. Proxy settings are sourced\n  from the HTTP_PROXY environment variable [...]</p>\n</blockquote>\n\n<p>I want to use the <code>Proxy</code> obtained this way with <code>Wreq</code> library, which has it's own <code>Proxy</code> <a href=\"https://github.com/bos/wreq/blob/master/Network/Wreq.hs#L165\" rel=\"nofollow\">defined like this</a>, by importing it from HTTP:</p>\n\n<pre><code>import Network.HTTP.Client.Internal (Proxy(..), Response)\n</code></pre>\n\n<p>There appears to be a type mismatch between <code>Network.HTTP.Proxy.Proxy</code> and <code>Network.Wreq.Proxy</code>, where I presume they must be identical.</p>\n\n<p>I import both like this:</p>\n\n<pre><code>import           Network.Wreq\nimport           Network.HTTP.Proxy (fetchProxy)\n</code></pre>\n\n<p>How can I use HTTP.Proxy.Proxy with Wreq and why does GHC see them as different types?</p>\n"}, {"tags": ["haskell", "monads"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "edited": false, "score": 0, "creation_date": 1461088750, "post_id": 36705770, "comment_id": 61035928, "body": "When we use newtype then it may has only one constructor. Is it true that type is equivalent to constructor ? Additionally, where is the parameter <code>a</code> ?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1461144334, "post_id": 36705770, "comment_id": 61060939, "body": "A <code>newtype</code> is a wrapper around the type inside its constructor. It&#39;s isomorphic to that type; indeed, they are represented in the same way at runtime. The parameter <code>a</code> has been curried out to give a type of kind <code>* -&gt; *</code>."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": true, "score": 1, "last_activity_date": 1461055584, "last_edit_date": 1461055584, "creation_date": 1461020559, "answer_id": 36705770, "question_id": 36704591, "link": "https://stackoverflow.com/questions/36704591/what-does-this-monad-transformer-type-mean/36705770#36705770", "title": "What does this monad transformer type mean?", "body": "<p>The author of the documentation is playing fast and loose with notation. They're replacing the types <code>ErrorT</code> and <code>StateT</code> with their constructors, which also have the names <code>ErrorT</code> and <code>StateT</code>. (It makes some sort of sense because they're <code>newtype</code>s.) The point the author is trying to make is that <code>ErrorAndStateWithIO e s a</code> is equivalent to <code>s -&gt; IO (Either e a, s)</code>; it just has a couple of <code>newtype</code> wrappers around it.</p>\n\n<p>Looking at the definitions of those types,</p>\n\n<pre><code>newtype ErrorT e m a = ErrorT { runErrorT :: m (Either e a) }\nnewtype StateT s m a = StateT { runStateT :: s -&gt; m (a, s) }\n</code></pre>\n\n<p>you can see that in the first step the outer <code>ErrorT</code> has been replaced with its definition, and in the second the inner <code>StateT</code> has been replaced with its definition.</p>\n\n<hr>\n\n<blockquote>\n  <p>Here, we have <code>StateT s IO</code>. Where is <code>a</code> parameter?</p>\n</blockquote>\n\n<p><code>ErrorT e</code> is a <a href=\"https://hackage.haskell.org/package/transformers-0.4.2.0/docs/Control-Monad-Trans-Class.html\" rel=\"nofollow\">monad transformer</a>, which means it transforms monads into other monads. Monads always have a kind of <code>* -&gt; *</code>; monad transformers have a kind of <code>(* -&gt; *) -&gt; (* -&gt; *)</code>. <code>StateT s</code> is also a monad transformer. Here, <code>StateT s</code> is being applied to <code>IO</code> to produce a new monad (which is <code>IO</code> augmented with state-management capabilities), and then <code>ErrorT e</code> is being applied to that to produce another monad (which is <code>StateT s IO</code> augmented with error-handling capabilities).</p>\n\n<hr>\n\n<blockquote>\n  <p>Can somebody explain how to run this monad?</p>\n</blockquote>\n\n<p>As I mentioned above, <code>ErrorAndStateWithIO e s a</code> is just <code>s -&gt; IO (Either e a, s)</code> with a couple of <code>newtype</code> wrappers around it. So to run it you'd unwrap the <code>newtype</code>s, pass in an <code>s</code>, plumb it into an IO computation and scrutinise the result.</p>\n\n<pre><code>myComputation :: ErrorAndStateWithIO String Int Char\nmyComputation =  -- ...\n\nmain = do\n    (result, _) &lt;- runStateT (runErrorT myComputation) 5\n    case result of\n         Left err -&gt; putStrLn err\n         Right result -&gt; putStrLn $ \"Success: \" ++ [result]\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 36705770, "answer_count": 1, "score": 1, "last_activity_date": 1461055584, "creation_date": 1461014794, "last_edit_date": 1461020916, "question_id": 36704591, "link": "https://stackoverflow.com/questions/36704591/what-does-this-monad-transformer-type-mean", "title": "What does this monad transformer type mean?", "body": "<p>Look at this thing from the <a href=\"https://hackage.haskell.org/package/transformers-0.4.2.0/docs/Control-Monad-Trans-Error.html#g:4\" rel=\"nofollow\">documentation</a>:  </p>\n\n<pre><code>type ErrorAndStateWithIO e s a = ErrorT e (StateT s IO) a\n==&gt; ErrorT (StateT s IO (Either e a))\n==&gt; ErrorT (StateT (s -&gt; IO (Either e a,s)))\n</code></pre>\n\n<p>I attach also constructor of <code>ErrorT</code>:  </p>\n\n<pre><code>Constructors\n  ErrorT \n    runErrorT :: m (Either e a)\n</code></pre>\n\n<p>The thing that I can't understand is a thing on the top of my post. What does it mean? For me it means that <code>ErrorT e (StateT s IO) a = ErrorT (StateT s IO (Either e a))</code>. What's up? It is something like auto call constructor (<code>runErrorT</code>)?</p>\n\n<p>The second thing that bothers me: We know form of <code>StateT</code> as <code>StateT s m a</code>. Here, we have <code>StateT s IO</code>. Where is <code>a</code> parameter?</p>\n\n<p>And last thing - can somebody explain how to run this monad?  </p>\n"}, {"tags": ["string", "haskell", "return", "printf"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461007105, "post_id": 36702399, "comment_id": 60992763, "body": "what about <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Text-Printf.html#v:printf\" rel=\"nofollow noreferrer\"><code>printf</code></a> (the function ... ) - btw: <code>PrintfType</code> is no type - it&#39;s a class"}, {"owner": {"reputation": 2118, "user_id": 2787364, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lxZ8k.png?s=128&g=1", "display_name": "Cosmin Ioni\u021b\u0103", "link": "https://stackoverflow.com/users/2787364/cosmin-ioni%c8%9b%c4%83"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461007253, "post_id": 36702399, "comment_id": 60992860, "body": "This is the function I am talking about. It takes a formatted String an an input and returns a PrintfType. My problem is that I want to convert that PrintfType to a String. I don&#39;t understand what you&#39;re trying to say."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1461007323, "post_id": 36702399, "comment_id": 60992926, "body": "it will give you a string if you ask it to - try: <code>printf &quot;%d&quot; 55 :: String</code> - <code>String ~ [Char]</code> is an instance of <code>PrintfType</code>"}, {"owner": {"reputation": 2118, "user_id": 2787364, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lxZ8k.png?s=128&g=1", "display_name": "Cosmin Ioni\u021b\u0103", "link": "https://stackoverflow.com/users/2787364/cosmin-ioni%c8%9b%c4%83"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461007552, "post_id": 36702399, "comment_id": 60993051, "body": "It works, but it gives me an array of chars, not a String. I really need it to be a String. Thank you for that workaround."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461007590, "post_id": 36702399, "comment_id": 60993076, "body": "... well a <code>String</code> <i>is</i> a list of <code>Char</code> (not an array) ... but let me guess: you are using Hugs?"}, {"owner": {"reputation": 2118, "user_id": 2787364, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lxZ8k.png?s=128&g=1", "display_name": "Cosmin Ioni\u021b\u0103", "link": "https://stackoverflow.com/users/2787364/cosmin-ioni%c8%9b%c4%83"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461007782, "post_id": 36702399, "comment_id": 60993197, "body": "No, I am not using Hugs (I don&#39;t really know what this is). Yes, a String is a list of Char, not an array. My bad."}, {"owner": {"reputation": 2118, "user_id": 2787364, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lxZ8k.png?s=128&g=1", "display_name": "Cosmin Ioni\u021b\u0103", "link": "https://stackoverflow.com/users/2787364/cosmin-ioni%c8%9b%c4%83"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461007809, "post_id": 36702399, "comment_id": 60993211, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/109473/discussion-between-xor-ntg-and-carsten\">continue this discussion in chat</a>."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1461007825, "post_id": 36702399, "comment_id": 60993222, "body": "just a wild guess (Hugs is an older Haskell implementation and I thought it might give the type as <code>[Char]</code>) - let me give you an advice on your way: forget anything about types and classes you might bring along from C# - they will hurt your understanding for the most parts"}, {"owner": {"reputation": 2118, "user_id": 2787364, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lxZ8k.png?s=128&g=1", "display_name": "Cosmin Ioni\u021b\u0103", "link": "https://stackoverflow.com/users/2787364/cosmin-ioni%c8%9b%c4%83"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461008233, "post_id": 36702399, "comment_id": 60993448, "body": "Yes, I already feel that. I will try now to convert [Char] to String"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1461008589, "post_id": 36702399, "comment_id": 60993645, "body": "look you don&#39;t have to convert anything - <code>String</code> is just a type-synonym for <code>[Char]</code> ... they are literally the same in Haskell - it&#39;s as if you would write <code>using MyString = System.IEnumerable&lt;System.Char&gt;;</code> in C#"}, {"owner": {"reputation": 2118, "user_id": 2787364, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lxZ8k.png?s=128&g=1", "display_name": "Cosmin Ioni\u021b\u0103", "link": "https://stackoverflow.com/users/2787364/cosmin-ioni%c8%9b%c4%83"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461011132, "post_id": 36702399, "comment_id": 60995065, "body": "Yes, you are right. Thank you respectfully!"}], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 4, "last_activity_date": 1461009548, "creation_date": 1461009548, "answer_id": 36703223, "question_id": 36702399, "link": "https://stackoverflow.com/questions/36702399/how-can-i-convert-the-result-of-text-printf-to-string/36703223#36703223", "title": "How can I convert the result of Text.Printf to String?", "body": "<blockquote>\n  <p>The result of Text.Printf is a variable of type PrintfType.</p>\n</blockquote>\n\n<p>No.  <code>PrintfType</code>  is a constraint on the type, not a type itself.  Notice the instances of <code>PrintfType</code> provided by <code>module Text.Printf</code> are:</p>\n\n<pre><code>IsChar c =&gt; PrintfType [c]\n(~) * a () =&gt; PrintfType (IO a)\n(PrintfArg a, PrintfType r) =&gt; PrintfType (a -&gt; r)\n</code></pre>\n\n<blockquote>\n  <p>Is there a way to convert this result to String?</p>\n</blockquote>\n\n<p>No conversion necessary, <code>String ~ [Char]</code> and there exists an instance <code>IsChar Char</code>.  Thus, the constraint of <code>PrintfType String</code> is satisfied.</p>\n\n<blockquote>\n  <p>I want something like that: convertToString :: PrintfType -> String</p>\n</blockquote>\n\n<p>That makes no sense since you're using <code>PrintfType</code> as a Type instead of a constraint.</p>\n"}], "owner": {"reputation": 2118, "user_id": 2787364, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/lxZ8k.png?s=128&g=1", "display_name": "Cosmin Ioni\u021b\u0103", "link": "https://stackoverflow.com/users/2787364/cosmin-ioni%c8%9b%c4%83"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 36703223, "answer_count": 1, "score": -1, "last_activity_date": 1461009548, "creation_date": 1461006626, "question_id": 36702399, "link": "https://stackoverflow.com/questions/36702399/how-can-i-convert-the-result-of-text-printf-to-string", "title": "How can I convert the result of Text.Printf to String?", "body": "<p>The result of Text.Printf is a variable of type PrintfType. </p>\n\n<p>Is there a way to convert this result to String?</p>\n\n<p>I want something like that: convertToString :: PrintfType -> String</p>\n\n<p>I've searched everywhere but I can't find anything.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 2, "creation_date": 1461005083, "post_id": 36701841, "comment_id": 60991460, "body": "What type should <code>matrixIdentity</code> have? At the moment, <code>matrixIdentity :: Int -&gt; Int</code>, and <code>showMatrix :: Int -&gt; String</code> would solve this. But that&#39;s not what you actually want."}, {"owner": {"reputation": 21, "user_id": 6221346, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b2f23a6abb15d5c6fae71b2df7357307?s=128&d=identicon&r=PG&f=1", "display_name": "Begovic", "link": "https://stackoverflow.com/users/6221346/begovic"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1461005711, "post_id": 36701841, "comment_id": 60991847, "body": "showMatrix :: Int -&gt; String , matrixIdentity :: Int -&gt; Int, it was correct"}, {"owner": {"reputation": 1178, "user_id": 1667161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233658d12fabd9d72b04d0a6916f6389?s=128&d=identicon&r=PG", "display_name": "liminalisht", "link": "https://stackoverflow.com/users/1667161/liminalisht"}, "edited": false, "score": 0, "creation_date": 1461009373, "post_id": 36701841, "comment_id": 60994060, "body": "@abdessamadabba <code>matrixIdentity</code> taking an <code>Int</code> makes sense, but if it returns an <code>Int</code>, then where exactly is your matrix in this code?"}], "answers": [{"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 2, "creation_date": 1461005801, "post_id": 36702086, "comment_id": 60991916, "body": "<i>&quot;I want to make a Identify matrix without syntax list or <b>list functions</b>&quot;</i>. However, the question isn&#39;t clear at the moment. &#175;\\_(\u30c4)_/&#175;"}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1461007293, "post_id": 36702086, "comment_id": 60992896, "body": "@Zeta What I thought was asked whether one can print the matrix form of an identity matrix without actually creating the matrix in concrete beforehand.  What I think I answered is you can have it created when it&#39;s printed out."}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 1, "last_activity_date": 1461006946, "last_edit_date": 1461006946, "creation_date": 1461005555, "answer_id": 36702086, "question_id": 36701841, "link": "https://stackoverflow.com/questions/36701841/matrix-identity-in-haskell-without-list/36702086#36702086", "title": "Matrix Identity in haskell without list", "body": "<p>Here is a trick to create an identity matrix</p>\n\n<pre><code>import Data.List.Split(splitEvery)\nidentity n = splitEvery n $ take (n*n) $ concat $ replicate n (1:replicate n 0)\n</code></pre>\n\n<p>Now, to get the output in that format you can </p>\n\n<pre><code>putStr $ unlines $ map (unwords . map show) (identity 3)\n</code></pre>\n\n<p>to package these all</p>\n\n<pre><code>import Data.List.Split(splitEvery)\ndata IdentityMatrix = I Int\nshowMatrix :: IdentityMatrix -&gt; IO ()\nshowMatrix (I n) = putStr $ unlines $ map (unwords . map show) identity\n       where identity = splitEvery n $ take (n*n) $ concat $ replicate n (1:replicate n 0)\n\n\n&gt; showMatrix (I 4)\n1 0 0 0\n0 1 0 0\n0 0 1 0\n0 0 0 1\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6221346, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/b2f23a6abb15d5c6fae71b2df7357307?s=128&d=identicon&r=PG&f=1", "display_name": "Begovic", "link": "https://stackoverflow.com/users/6221346/begovic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 391, "favorite_count": 0, "answer_count": 1, "score": -5, "last_activity_date": 1461013687, "creation_date": 1461004780, "last_edit_date": 1461013687, "question_id": 36701841, "link": "https://stackoverflow.com/questions/36701841/matrix-identity-in-haskell-without-list", "title": "Matrix Identity in haskell without list", "body": "<p>I want to make an Identity matrix without list syntax or list functions  for eg something with tuple <code>(x,x)</code> ...and i want to print it like </p>\n\n<pre><code>*&gt; showMatrix (matrixIdentity 4)\n1 0 0 0\n0 1 0 0\n0 0 1 0\n0 0 0 1 \n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1461002765, "post_id": 36700845, "comment_id": 60990073, "body": "&quot;I&#39;ve figured out how to do it using individual lines of code in the win hugs compiler&quot; - Hugs hasn&#39;t been maintained for a number of years, I&#39;d recommend switching to GHC/GHCi."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 3, "creation_date": 1461002860, "post_id": 36700845, "comment_id": 60990126, "body": "@bheklilr we both know that he probably has no choice here ;)"}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1461010250, "post_id": 36700845, "comment_id": 60994561, "body": "Related: <a href=\"http://stackoverflow.com/questions/27407773/sum-of-squares-using-haskell\" title=\"sum of squares using haskell\">stackoverflow.com/questions/27407773/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461002812, "post_id": 36701177, "comment_id": 60990100, "body": "of course you can have more than one <code>let</code> - for example: <code>f x = let y = x+5 in let z = y+6 in z</code> is a perfectly fine expression - yours indeed is just a shorter syntactic sugar to this"}, {"owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1461002983, "post_id": 36701177, "comment_id": 60990194, "body": "Sure, I was just trying to be succinct. I&#39;ve updated it to make it a little more clear."}], "tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": true, "score": 2, "last_activity_date": 1461002969, "last_edit_date": 1461002969, "creation_date": 1461002516, "answer_id": 36701177, "question_id": 36700845, "link": "https://stackoverflow.com/questions/36700845/creating-a-haskell-function-that-returns-the-sum-of-the-squares-in-a-list-of-lis/36701177#36701177", "title": "Creating a haskell function that returns the sum of the squares in a list of lists of ints?", "body": "<p>You should only have one <code>let</code> statement in your example function if I understand your example. (While you can have multiple <code>let</code> statements, this isn't how you do it). <code>let</code> gives you the ability to define functions within a function, things that are one-off pieces of code you won't use elsewhere.</p>\n\n<p>When you use <code>let</code>, you have to also include <code>in</code> to provide the actual return value of the function.</p>\n\n<p>You are also missing the <code>=</code> sign for defining your function body.</p>\n\n<p>Here's what I think you're trying to do:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>sumSquaresMax :: [[Int]] -&gt; Int\nsumSquaresMax x = \n    let maxes = map maximum x\n        squares = map (^2) maxes\n    in sum squares\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 2, "last_activity_date": 1461002613, "creation_date": 1461002613, "answer_id": 36701203, "question_id": 36700845, "link": "https://stackoverflow.com/questions/36700845/creating-a-haskell-function-that-returns-the-sum-of-the-squares-in-a-list-of-lis/36701203#36701203", "title": "Creating a haskell function that returns the sum of the squares in a list of lists of ints?", "body": "<p>you actually have it there - all you have to do is replacing names: </p>\n\n<pre><code>sumSquaresMax x\n= sum squares\n= sum (map (^2) maxes)\n= sum (map (^2) (map maximum x))\n= sum . map (^2) . map maximum $ x\n= sum . map ((^2) . maximum) $ x\n</code></pre>\n\n<p>so overall:</p>\n\n<pre><code>sumSquaresMax = sum . map ((^2) . maximum)\n</code></pre>\n\n<p>example:</p>\n\n<pre><code>Prelude&gt; let sumSquaresMax = sum . map ((^2) . maximum)\nPrelude&gt; sumSquaresMax [[4,2,5],[6,2],[2],[-6,4,1]]\n81\n</code></pre>\n"}], "owner": {"reputation": 273, "user_id": 3857250, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/c603a09e908db2b2ddb53c59343fccc7?s=128&d=identicon&r=PG&f=1", "display_name": "Johnathan Scott", "link": "https://stackoverflow.com/users/3857250/johnathan-scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 776, "favorite_count": 0, "accepted_answer_id": 36701177, "answer_count": 2, "score": 0, "last_activity_date": 1461002969, "creation_date": 1461001407, "question_id": 36700845, "link": "https://stackoverflow.com/questions/36700845/creating-a-haskell-function-that-returns-the-sum-of-the-squares-in-a-list-of-lis", "title": "Creating a haskell function that returns the sum of the squares in a list of lists of ints?", "body": "<p>I'm currently working on a small practice question for a haskell course I have. It asks the following:</p>\n\n<blockquote>\n  <p>Write a Haskell function called sumSquareMax which takes a list of lists of Ints as a parameter,\n  finds the maximum of each sub-list and returns the sum the squares of those maximums.</p>\n</blockquote>\n\n<p>I've figured out how to do it using individual lines of code in the win hugs compiler but I really want to make it a simple function with parameters. What I have so far is as follows: </p>\n\n<pre><code>sumSquaresMax :: [[Int]] -&gt; Int\nsumSquaresMax x\n    let maxes = map maximum x\n    let squares = map (^2) maxes\n    let finalSum = sum squares\n</code></pre>\n\n<p>So if I were to run <code>sumSquaresMax [[4,2,5],[6,2],[2],[-6,4,1]]</code> first it would map the maximum of the lists: <code>[5,6,2,4]</code> then, it would square each of these numbers and then sum the squares leading to my answer.</p>\n\n<p>How would I go about \"printing\" <code>finalSum</code>? I know this is not even close to being correct but I'm not entirely sure where to go from here. Any help is greatly appreciated!</p>\n"}, {"tags": ["haskell", "yesod", "esqueleto"], "answers": [{"tags": [], "owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "is_accepted": true, "score": 2, "last_activity_date": 1461006605, "last_edit_date": 1461006605, "creation_date": 1461006288, "answer_id": 36702297, "question_id": 36700690, "link": "https://stackoverflow.com/questions/36700690/yesoddb-how-to-put-types-correctly/36702297#36702297", "title": "YesodDB, how to put types correctly", "body": "<p>I remembered there is a <a href=\"http://www.yesodweb.com/book/sql-joins\" rel=\"nofollow\">chapter about joins in the great Yesod book</a>, so I read it again and found the solution, maybe my code may help others, so here it goes:</p>\n\n<pre><code>module Select where\n\nimport Import hiding((==.), on, Value)\nimport Database.Persist.Sql (toSqlKey) -- Useful when I want to explicitly use primary keys\nimport Database.Esqueleto\n\n-- type Distance = Int\nworksByNhood :: AdrNhoodId -&gt; Int64 -&gt; Int64 -&gt; YesodDB App [(Entity Work, Value Distance, [Entity WImage])] \nworksByNhood nId offset' limit' = do\n  works &lt;- select $ from $ \\(w `InnerJoin` d) -&gt; do\n    on $ d ^. AdrDistanceNhood2 ==. w ^. WorkNhood\n    where_ (d ^. AdrDistanceNhood1 ==. val nId)\n    orderBy [asc (d ^. AdrDistanceDistance)]\n    offset offset'\n    limit limit'\n    return (w, d ^. AdrDistanceDistance)\n  forM works $ \\(w@(Entity wId _), d) -&gt; do\n    images &lt;- select $ from $ \\wi -&gt; do\n      where_ (wi ^. WImageWork ==. val wId)\n      return wi\n    return (w, d, images)\n</code></pre>\n\n<p><strong><code>Value Distance</code> at the type declaration is the answer</strong></p>\n"}], "owner": {"reputation": 1336, "user_id": 2801316, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/cqx1a.jpg?s=128&g=1", "display_name": "FtheBuilder", "link": "https://stackoverflow.com/users/2801316/fthebuilder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 36702297, "answer_count": 1, "score": 2, "last_activity_date": 1461006605, "creation_date": 1461000924, "last_edit_date": 1461001564, "question_id": 36700690, "link": "https://stackoverflow.com/questions/36700690/yesoddb-how-to-put-types-correctly", "title": "YesodDB, how to put types correctly", "body": "<p>I have created a function for loading some <code>Entities</code> but I am having some trouble to understand how I should put its type declaration, so I took this <a href=\"http://www.yesodweb.com/book/yesods-monads\" rel=\"nofollow\">Yesod book chapter</a>\nabout Yesod monads, to understand it better, and I came to this snippet:</p>\n\n<pre><code>-- type Distance = Int\nworksByNhood :: AdrNhoodId -&gt; Int64 -&gt; Int64 -&gt; YesodDB App [(Entity Work, Int, [Entity WImage])] \nworksByNhood nId offset' limit' = do\n  works &lt;- select $ from $ \\(w `InnerJoin` d) -&gt; do\n    on $ d ^. AdrDistanceNhood2 ==. w ^. WorkNhood\n    where_ (d ^. AdrDistanceNhood1 ==. val nId)\n    orderBy [asc (d ^. AdrDistanceDistance)]\n    offset offset'\n    limit limit'\n    return (w, d ^. AdrDistanceDistance)\n  works' &lt;- forM works $ \\(w@(Entity wId _), d) -&gt; do\n    images &lt;- select $ from $ \\wi -&gt; do\n      where_ (wi ^. WImageWork ==. val wId)\n      return wi\n    return (w, d, images);\n  return works'\n</code></pre>\n\n<p>I think this <code>Int</code> in the type declaration needs to be converted someway, to be more specific, I am getting this error:</p>\n\n<pre><code>Select.hs:20:12:\n    Couldn't match type \u2018Database.Esqueleto.Value Distance\u2019 with \u2018Int\u2019\n    Expected type: (Entity Work, Distance, [Entity WImage])\n      Actual type: (Entity Work,\n                    Database.Esqueleto.Value Distance,\n                    [Entity WImage])\n    In the first argument of \u2018return\u2019, namely \u2018(w, d, images)\u2019\n    In a stmt of a 'do' block: return (w, d, images)\n    In the expression:\n      do { images &lt;- select $ from $ \\ wi -&gt; do { ... };\n           return (w, d, images) }\n</code></pre>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 5, "creation_date": 1460998772, "post_id": 36699939, "comment_id": 60987861, "body": "where is that a recursion? you define a type  (constructor) &quot;Parser&quot; with a (data) constructor &quot;Parser&quot;. The defined type does not occur on the right."}, {"owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "reply_to_user": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 0, "creation_date": 1460999416, "post_id": 36699939, "comment_id": 60988238, "body": "<code>data Tree a = Leaf | Node (Tree a) (Tree a).</code> Is there here recursion?"}, {"owner": {"reputation": 1958, "user_id": 3217013, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8fe4c19ed2edcb4fe6e661a5faed0205?s=128&d=identicon&r=PG&f=1", "display_name": "Emil", "link": "https://stackoverflow.com/users/3217013/emil"}, "edited": false, "score": 0, "creation_date": 1460999491, "post_id": 36699939, "comment_id": 60988286, "body": "Also, semantically, there is no difference between <code>newtype</code> and <code>data</code> so you haven&#39;t really done anything different."}, {"owner": {"reputation": 1958, "user_id": 3217013, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8fe4c19ed2edcb4fe6e661a5faed0205?s=128&d=identicon&r=PG&f=1", "display_name": "Emil", "link": "https://stackoverflow.com/users/3217013/emil"}, "edited": false, "score": 1, "creation_date": 1460999562, "post_id": 36699939, "comment_id": 60988328, "body": "Also, your Tree definition doesn&#39;t make use of the parametrized variable <code>a</code>. It is recursive though."}], "answers": [{"tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": true, "score": 7, "last_activity_date": 1460999592, "creation_date": 1460999592, "answer_id": 36700280, "question_id": 36699939, "link": "https://stackoverflow.com/questions/36699939/newtype-and-recursive-definition/36700280#36700280", "title": "newtype and recursive definition", "body": "<p>Your Parser definition is not actually recursive. On the right of the <code>=</code> sign is <a href=\"https://wiki.haskell.org/Constructor\">constructor</a>. Constructors can have the same name as their type but the two things are separate concepts.</p>\n\n<p>You could call the parser constructor something else without losing any functionality:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>data Parser a = Foo (String -&gt; [(a, String)])\n</code></pre>\n\n<p>Your <code>Tree</code> type has two constructors, <code>Leaf</code> and <code>Node</code>. The thing that makes it recursive is that the definition of <code>Node</code> recursively includes two type parameters, both of which are <code>Tree</code>.</p>\n"}], "owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 147, "favorite_count": 0, "accepted_answer_id": 36700280, "answer_count": 1, "score": 0, "last_activity_date": 1460999592, "creation_date": 1460998531, "question_id": 36699939, "link": "https://stackoverflow.com/questions/36699939/newtype-and-recursive-definition", "title": "newtype and recursive definition", "body": "<pre><code>newtype Parser a = Parser (String -&gt; [(a,String)])\n</code></pre>\n\n<p>Hi, Let's consider above definition:\nOn my eye it is infinite definition- recursive definition. For example I defined tree ( recursive, infinite structures) like:</p>\n\n<pre><code>data Tree a = Leaf | Node (Tree a) (Tree a).\n</code></pre>\n\n<p>And <code>Tree</code> can be inifinite but we have <code>Leaf</code> and it can \"finish\" recursive definition. So, let's translate my first definition to <code>data</code>:\n( just replace newtype- according to <a href=\"https://wiki.haskell.org/Newtype\" rel=\"nofollow\">https://wiki.haskell.org/Newtype</a> ) </p>\n\n<pre><code>data Parser a = Parser (String -&gt; [(a,String)])\n</code></pre>\n\n<p>And it is recursive definition and there is no \"finite element\" like <code>Leaf</code>. How to understand it?</p>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 1282, "user_id": 807631, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/3120b244b19cab8e1c52845139b3fc23?s=128&d=identicon&r=PG&f=1", "display_name": "Misguided", "link": "https://stackoverflow.com/users/807631/misguided"}, "edited": false, "score": 1, "creation_date": 1460998247, "post_id": 36699695, "comment_id": 60987552, "body": "Just guessing this has a lot to do with your using take and drop at every step of your recursion. These are &quot;O(a)&quot; functions, maybe trying with splitAt would be a better choice?. Also, keep in mind that ++ is also an &quot;O(a)&quot; operation, as concatenation is not done using pointer arithmetic, but by traversing the whole structure."}, {"owner": {"reputation": 51, "user_id": 6220864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed90c240cb87a5b6e5de5b48741cde90?s=128&d=identicon&r=PG&f=1", "display_name": "zoko", "link": "https://stackoverflow.com/users/6220864/zoko"}, "reply_to_user": {"reputation": 1282, "user_id": 807631, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/3120b244b19cab8e1c52845139b3fc23?s=128&d=identicon&r=PG&f=1", "display_name": "Misguided", "link": "https://stackoverflow.com/users/807631/misguided"}, "edited": false, "score": 0, "creation_date": 1460998810, "post_id": 36699695, "comment_id": 60987887, "body": "I thought it could be that, but then I tried a simpler <code>recurseone xs = head xs : zipWith (+) (tail xs) (recurseone xs)</code> and it was still slow"}, {"owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 2, "creation_date": 1460998959, "post_id": 36699695, "comment_id": 60987979, "body": "Do you understand why your code is correct in the first place? Often you can infer ressource usage (that is, a complexity bound) from a correctness proof (the &quot;termination&quot; part of the correctness property)."}, {"owner": {"reputation": 2019, "user_id": 5800895, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0cab3b0361b7e54267c70c02754f21de?s=128&d=identicon&r=PG&f=1", "display_name": "Derek Elkins left SE", "link": "https://stackoverflow.com/users/5800895/derek-elkins-left-se"}, "edited": false, "score": 5, "creation_date": 1460999094, "post_id": 36699695, "comment_id": 60988052, "body": "You aren&#39;t sharing any work between your calls to <code>recurse</code>.  If you said <code>recurse a xs = let l = take a xs ++ zipWith (+) (drop a xs) l in l</code>, it would be more like the <code>fibs</code> example. &#39;not saying this would make it fast because you are also not sharing work between the calls of <code>recurse</code> in the <code>foldr</code>. You can, however, exploit laziness to get a slick implementation of dynamic programming."}, {"owner": {"reputation": 1958, "user_id": 3217013, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8fe4c19ed2edcb4fe6e661a5faed0205?s=128&d=identicon&r=PG&f=1", "display_name": "Emil", "link": "https://stackoverflow.com/users/3217013/emil"}, "edited": false, "score": 0, "creation_date": 1460999283, "post_id": 36699695, "comment_id": 60988156, "body": "Does your code actually terminate? This line makes it seem like it shouldn&#39;t: <code>recurse a xs = take a xs ++ zipWith (+) (drop a xs) (recurse a xs)</code> because you&#39;d be computing <code>recurse a xs</code> which requires you to compute <code>recurse a xs</code>. There isn&#39;t a base case."}, {"owner": {"reputation": 51, "user_id": 6220864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed90c240cb87a5b6e5de5b48741cde90?s=128&d=identicon&r=PG&f=1", "display_name": "zoko", "link": "https://stackoverflow.com/users/6220864/zoko"}, "edited": false, "score": 0, "creation_date": 1460999495, "post_id": 36699695, "comment_id": 60988292, "body": "Derek: Thanks! That actually made the code way faster."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1958, "user_id": 3217013, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8fe4c19ed2edcb4fe6e661a5faed0205?s=128&d=identicon&r=PG&f=1", "display_name": "Emil", "link": "https://stackoverflow.com/users/3217013/emil"}, "edited": false, "score": 2, "creation_date": 1461000025, "post_id": 36699695, "comment_id": 60988589, "body": "@user3217013 In lazy lists, it&#39;s more important that the recursion is productive than well-founded. I mean, <code>let x=1:x in take 100 x</code> will terminate because <code>1:x</code> is productive. The posted <code>fibs</code> uses the same trick. In the OP code, I guess the part <code>take a xs ++ ...</code> is what should make it productive (if <code>a</code>&gt;0 and <code>xs</code> not null)."}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 6220864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed90c240cb87a5b6e5de5b48741cde90?s=128&d=identicon&r=PG&f=1", "display_name": "zoko", "link": "https://stackoverflow.com/users/6220864/zoko"}, "edited": false, "score": 0, "creation_date": 1461001009, "post_id": 36700502, "comment_id": 60989107, "body": "That looks almost exactly like my code + Derek&#39;s edit... Only difference is you add zeros in front, then add, whereas I use <code>take a xs</code> for the front. So I think it would give the same performance."}], "tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": false, "score": 2, "last_activity_date": 1465053021, "last_edit_date": 1495541279, "creation_date": 1461000306, "answer_id": 36700502, "question_id": 36699695, "link": "https://stackoverflow.com/questions/36699695/why-is-this-recursion-slow/36700502#36700502", "title": "Why is this recursion slow?", "body": "<p>The problem with recursion is that care needs to be taken not to branch exponentially or have exponential memory foot-print; and also writing a <em>tail recursive</em> function is usually less expressive.</p>\n\n<p>You can bypass the entire recursion overhead by dynamic programming; which has a very performant implementation in Haskell using a right fold:</p>\n\n<pre><code>count :: (Num a, Foldable t) =&gt; t Int -&gt; Int -&gt; a\ncount coins total = foldr go (1: repeat 0) coins !! total\n    where\n    go coin acc = out where out = zipWith (+) acc $ replicate coin 0 ++ out\n</code></pre>\n\n<p>then:</p>\n\n<pre><code>\\&gt; count [1, 5, 10, 25, 50] 5000\n432699251\n</code></pre>\n\n<p>or as in <a href=\"https://projecteuler.net/problem=31\" rel=\"nofollow noreferrer\">31st problem of Project Euler</a><sup> (1)</sup>:</p>\n\n<pre><code>\\&gt; count [1, 2, 5, 10, 20, 50, 100, 200] 200\n73682\n</code></pre>\n\n<p>A <em>less</em> efficient alternative would be to use <em>immutable non-strict (boxed) arrays</em>:</p>\n\n<pre><code>import Data.Array (listArray, (!))\n\ncount :: (Num a, Foldable t) =&gt; t Int -&gt; Int -&gt; a\ncount coins total = foldr go init coins ! total\n    where\n    init = listArray (0, total) $ 1: repeat 0\n    go coin arr = out\n        where\n        out = listArray (0, total) $ map inc [0..total]\n        inc i = arr ! i + if i &lt; coin then 0 else out ! (i - coin)\n</code></pre>\n\n<hr>\n\n<p><sub>(1) The problem is already posted elsewhere on stackoverflow; see <a href=\"https://stackoverflow.com/questions/13871308\">Using dynamic programming in Haskell? [Warning: ProjectEuler 31 solution inside]</a></sub></p>\n"}, {"tags": [], "owner": {"reputation": 10492, "user_id": 603688, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1058344e1b119c4d9dd3aedc5456277b?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/603688/dan"}, "is_accepted": false, "score": 0, "last_activity_date": 1465049504, "creation_date": 1465049504, "answer_id": 37631224, "question_id": 36699695, "link": "https://stackoverflow.com/questions/36699695/why-is-this-recursion-slow/37631224#37631224", "title": "Why is this recursion slow?", "body": "<p>You are correct, this is quadratic time. The problem is that</p>\n\n<pre><code>+------------+\nv            v\nfoo a = bar (foo a)\n</code></pre>\n\n<p>is not the same thing as</p>\n\n<pre><code>foo a = r\n          +-------+\n          v       v\n    where r = bar r\n</code></pre>\n\n<p>In the first case, the two <code>foo</code> functions refer to the same object, but in the second, the <em>result</em> of <code>foo</code> refers to the same object. So in the first case, if <code>bar</code> wants to refer to part of <code>foo a</code> it has already computed, it has to compute the whole thing again.</p>\n"}], "owner": {"reputation": 51, "user_id": 6220864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed90c240cb87a5b6e5de5b48741cde90?s=128&d=identicon&r=PG&f=1", "display_name": "zoko", "link": "https://stackoverflow.com/users/6220864/zoko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1465053021, "creation_date": 1460997706, "question_id": 36699695, "link": "https://stackoverflow.com/questions/36699695/why-is-this-recursion-slow", "title": "Why is this recursion slow?", "body": "<p>I'm trying to solve the problem:</p>\n\n<blockquote>\n  <p>How many ways are there to get $50 using only 1c, 5c, 10c, 25c, or 50c coins?</p>\n</blockquote>\n\n<p>Here's my code:</p>\n\n<pre><code>main = print $ coinCombinations [1,5,10,25,50] !! 5000\n\ncoinCombinations coins = foldr recurse (1 : repeat 0) coins\n  where recurse a xs = take a xs ++ zipWith (+) (drop a xs) (recurse a xs)\n</code></pre>\n\n<p>It turns out that my <code>recurse</code> function is slow, maybe quadratic time or worse. But I don't understand why, since it looks similar to the fibonacci list</p>\n\n<pre><code>fibs = 0 : 1 : zipWith (+) fibs (tail fibs)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1460992380, "post_id": 36697878, "comment_id": 60983721, "body": "It doesn&#39;t know how to print your function.  You can invoke it with an argument, then it will show you the result."}, {"owner": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "edited": false, "score": 3, "creation_date": 1460992607, "post_id": 36697878, "comment_id": 60983909, "body": "Stackoverflow has been getting lots of Haskell questions lately that look like people attempting Haskell without any course or book to guide them through the first steps. I&#39;m curious where this is coming from - what inspired you to attempt your first Haskell program, and what inspired you to create an account on Stackoverflow as the way to solve your problem?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "edited": false, "score": 0, "creation_date": 1460995013, "post_id": 36697878, "comment_id": 60985595, "body": "@DanielMartin: Apparently, there&#39;s a new course in\u2026 Munich? Given that <code>verdopple</code> is German, OP might also attend that course. But I&#39;m not sure about that yet."}, {"owner": {"reputation": 1, "user_id": 6220470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d975b318edeb5d13747816af46739466?s=128&d=identicon&r=PG&f=1", "display_name": "ccwpog", "link": "https://stackoverflow.com/users/6220470/ccwpog"}, "reply_to_user": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "edited": false, "score": 0, "creation_date": 1461000135, "post_id": 36697878, "comment_id": 60988661, "body": "@DanielMartin: Haskell is part of my computer science course that I just started. Unfortunately it is the very first programming language we are learning. Looking back at my question my mistake was pretty obvious. I could not find the answer in our script so  I turned to the Internet and found Stackoverflow. Thanks alot for your help! Oh and Germany is right, the place is Frankfurt though."}], "answers": [{"tags": [], "owner": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "is_accepted": true, "score": 3, "last_activity_date": 1460992383, "creation_date": 1460992383, "answer_id": 36697983, "question_id": 36697878, "link": "https://stackoverflow.com/questions/36697878/error-code-in-simple-function/36697983#36697983", "title": "Error Code in simple function", "body": "<p>You get this error because at the ghci prompt, you did something like this:</p>\n\n<pre><code>*Main&gt; verdopple\n</code></pre>\n\n<p>This is asking ghci to print out your function, and its error message is telling you \"I can't print functions\".</p>\n\n<p>Try asking for <code>verdopple 5</code> or <code>:type verdopple</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 6220470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d975b318edeb5d13747816af46739466?s=128&d=identicon&r=PG&f=1", "display_name": "ccwpog", "link": "https://stackoverflow.com/users/6220470/ccwpog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 36697983, "answer_count": 1, "score": 0, "last_activity_date": 1460994932, "creation_date": 1460992149, "last_edit_date": 1460994932, "question_id": 36697878, "link": "https://stackoverflow.com/questions/36697878/error-code-in-simple-function", "title": "Error Code in simple function", "body": "<pre><code>verdopple :: Integer -&gt; Integer\nverdopple x = x + x\n</code></pre>\n\n<p>When I try to run the previous code into GHCi I get the following error:</p>\n\n<pre><code>No instance for (Show (Integer -&gt; Integer))\n    (maybe you haven't applied enough arguments to a function?) arising from a sue of 'print'\n    In a stmt on an interactice GHCi command: print it\n</code></pre>\n\n<p>Can anyone tell me what is wrong?\nThanks in advance!</p>\n"}, {"tags": ["haskell", "functional-programming", "fold"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1460989982, "post_id": 36696804, "comment_id": 60981855, "body": "In newer versions <code>Data.Foldable.foldl</code> is defined in terms of <code>foldr</code> to let the fuse with other operations. <code>reverse</code> should be one of these so you should end up with a pretty efficient version by just using <code>reverse $ foldl ...</code>.  My guess at least."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 1, "creation_date": 1460991163, "post_id": 36696804, "comment_id": 60982824, "body": "No, reverse does not take part in list fusion."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1460992684, "post_id": 36697518, "comment_id": 60983978, "body": "Is a difference list better than accumulating a list and then reversing it?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1460993009, "post_id": 36697518, "comment_id": 60984214, "body": "Ah, I guess you found it so. I&#39;m surprised; I&#39;ve seen the reversal technique win (by a little) in other contexts. The whole situation is a bit unsatisfactory. I&#39;d like to see a safe <code>IO</code> interleaving combinator that allows <code>IO</code> to produce a value lazily but does <i>not</i> allow lazy evaluation to drive <code>IO</code>. A sort of <code>lazyFixIO</code>."}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1460993977, "post_id": 36697518, "comment_id": 60984910, "body": "I agree; a combinator for \u201chere is an expression with an hole, I\u2019ll fill the hole later\u201d would be nice. But in any case it would be a mutable change to some closure, which the runtime/GC always penalizes."}], "tags": [], "owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "is_accepted": false, "score": 3, "last_activity_date": 1460991336, "creation_date": 1460991336, "answer_id": 36697518, "question_id": 36696804, "link": "https://stackoverflow.com/questions/36696804/most-efficient-way-of-building-a-list-in-a-left-fold/36697518#36697518", "title": "Most efficient way of building a list in a left fold?", "body": "<p>Since you mention <code>foldlM</code>, likely this blog post of mine answers your question in depth:</p>\n\n<p><a href=\"https://www.joachim-breitner.de/blog/620-Constructing_a_list_in_a_Monad\" rel=\"nofollow\">Constructing a list in a Monad</a></p>\n\n<p>The bottom line is: Use difference lists; i.e. in your left-fold, you accumulate a value of type <code>[a] -&gt; [a]</code>, where you can append a value using <code>. (x:)</code> efficiently, and at the end you apply this function to <code>[]</code> to obtain your list.</p>\n"}, {"tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": false, "score": 5, "last_activity_date": 1461022637, "last_edit_date": 1461022637, "creation_date": 1460992828, "answer_id": 36698144, "question_id": 36696804, "link": "https://stackoverflow.com/questions/36696804/most-efficient-way-of-building-a-list-in-a-left-fold/36698144#36698144", "title": "Most efficient way of building a list in a left fold?", "body": "<blockquote>\n  <p>when I have to use a left fold (... because ... the monadic actions produced must be performed in left-to-right order)</p>\n</blockquote>\n\n<p>Right fold can <em>lean so far right that it comes back left again</em>. For example, you can print (i.e. monadic action) each number and calculate partial sums of a list from <em>left to right</em> using a <em>right fold</em>:</p>\n\n<pre><code>fun :: [Int] -&gt; IO [Int]\nfun xs = foldr go (const $ return []) xs 0\n    where go x f a = let a' = a + x in print x &gt;&gt; (a' :) &lt;$&gt; f a'\n</code></pre>\n\n<p>then:</p>\n\n<pre><code>\\&gt; fun [1..5]\n1\n2\n3\n4\n5\n[1,3,6,10,15]\n</code></pre>\n\n<p>note that the output list is built using <code>(a' :)</code> and the monadic action is performed left to right, even though it is a right fold.</p>\n"}], "owner": {"reputation": 13337, "user_id": 441899, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/368fb99f86e2264ceec0539a3746b9d3?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/441899/jules"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1461022637, "creation_date": 1460989585, "question_id": 36696804, "link": "https://stackoverflow.com/questions/36696804/most-efficient-way-of-building-a-list-in-a-left-fold", "title": "Most efficient way of building a list in a left fold?", "body": "<p>When building lists, I usually use a right fold, as that lets me use the right-associative <code>:</code> operator without affecting the order of the resulting list.  In a left fold, I could use <code>++</code>, but I understand that this will entail repeatedly copying the list while it is being produced, giving O(N^2) operations for an N-element list, which is generally unacceptable.</p>\n\n<p>So, when I have to use a left fold (in my specific case this is because I'm using <code>foldlM</code> and the monadic actions produced <em>must</em> be performed in left-to-right order), is there any better way of reconciling this other than building the list in the fold using <code>:</code> and reversing the result?</p>\n"}, {"tags": ["haskell", "recursion", "types"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1460989038, "post_id": 36696528, "comment_id": 60981129, "body": "This has nothing to do with <code>Maybe</code>. And no. <code>tester</code> is just a sequence of characters <i>in your code</i>, yet it isn&#39;t a <code>String</code>. You have to use <code>&#39;</code> for characters, e.g. <code>[&#39;n&#39;,&#39;o&#39;]</code> or <code>&quot;no&quot;</code>. Also <code>a -&gt;  \u2026</code> will always match. You want <code>&#39;a&#39; -&gt; \u2026</code>."}, {"owner": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "edited": false, "score": 2, "creation_date": 1460989202, "post_id": 36696528, "comment_id": 60981256, "body": "Look, I love that more people are getting into Haskell, and I&#39;m trying to be gentle here, but perhaps learning Haskell on your own shouldn&#39;t be your first introduction to a programming language? Maybe you could try a nice &quot;intro to programming&quot; Coursera course instead. (I&#39;ve heard great things about them)"}, {"owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "edited": false, "score": 0, "creation_date": 1460990388, "post_id": 36696528, "comment_id": 60982205, "body": "There have been a few of these questions lately where the answer was, &quot;you have to quote your characters.&quot; I wonder whether they&#39;re related and where these tutorials or college courses are that are causing confusion."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "edited": false, "score": 1, "creation_date": 1460991474, "post_id": 36696528, "comment_id": 60983049, "body": "@DanielMartin I understand your point, but I don&#39;t think there&#39;s anything wrong with learning Haskell as a first programming language. Moving from imperative programming to pure FP, one usually has to unlearn certain habits (&quot;how do I modify <code>x</code>?&quot;), while learning FP upfront can make it simpler."}, {"owner": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1460991775, "post_id": 36696528, "comment_id": 60983263, "body": "@chi, I see what you&#39;re saying but if you&#39;re approaching Haskell with so little programming experience that the distinction between quoted literals and variable names is surprising, you shouldn&#39;t be attempting to go it all on your own. Find a course or a book or even a step-by-step walk through online. Don&#39;t just pick ghci/ghc up and go from zero. (That being said, I still think learning Haskell as a first programming language is not the way to go - I have heard good things about Racket as a first PL though)"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1460992434, "post_id": 36696528, "comment_id": 60983759, "body": "@chi Thing is, most resources I know compare Haskell with imperative languages, like Python or C in their first chapter. I haven&#39;t found a resource that teaches Haskell from 0 (yet)."}], "answers": [{"tags": [], "owner": {"reputation": 52258, "user_id": 375232, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/h3OwD.png?s=128&g=1", "display_name": "Landei", "link": "https://stackoverflow.com/users/375232/landei"}, "is_accepted": false, "score": 1, "last_activity_date": 1460989069, "creation_date": 1460989069, "answer_id": 36696604, "question_id": 36696528, "link": "https://stackoverflow.com/questions/36696528/haskell-how-do-i-use-the-maybe-type-in-recursive-functions/36696604#36696604", "title": "Haskell: How do I use the Maybe type in recursive functions?", "body": "<p>You use the <code>Char</code> type wrong, literals are written <code>'n'</code>,<code>'o'</code>.</p>\n\n<p>You are correct that <code>String</code> is just an alias for <code>[Char]</code>, so <code>\"no\"</code> is an abbreviation for <code>['n','o']</code>.</p>\n"}], "owner": {"reputation": 93, "user_id": 6062637, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/53f9677f2cd0195df649552b12c1c88f?s=128&d=identicon&r=PG&f=1", "display_name": "JJ chips", "link": "https://stackoverflow.com/users/6062637/jj-chips"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 247, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1460989072, "creation_date": 1460988885, "last_edit_date": 1460989072, "question_id": 36696528, "link": "https://stackoverflow.com/questions/36696528/haskell-how-do-i-use-the-maybe-type-in-recursive-functions", "title": "Haskell: How do I use the Maybe type in recursive functions?", "body": "<p>Suppose I want to construct a function that turns a string of letters into a list of chars. </p>\n\n<p>An example would be we input abc and it would output <code>[a,b,c]</code></p>\n\n<p>I constructed the function:</p>\n\n<pre><code>tester:: String-&gt; [Char]\ntester []= []\ntester (x:xs)= case x of\n    a -&gt; a: (tester  xs)\n    b -&gt; b: (tester  xs)\n    c -&gt; c: (tester  xs)\n    otherwise -&gt; [n,o]\n</code></pre>\n\n<p>Haskell gives the errors that <code>n</code> and <code>o</code> aren't in scope.\nbut <code>n</code> and <code>o</code> are both Chars aern't they? Hence <code>[n,o]</code> is a <code>[Char]</code>, fitting the output type. What is the problem?</p>\n\n<p>I remember reading somewhere that string is just a list of <code>Char</code>s, so is <code>String</code> the same as <code>[Char]</code>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460989098, "post_id": 36695695, "comment_id": 60981177, "body": "How do you ensure that the value stored is the same that the value used by TF ?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460990610, "post_id": 36695695, "comment_id": 60982359, "body": "right - I missed that data-kind part (sorry) - this way <code>A s -&gt; s</code> will be a problem anyway"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1460992298, "post_id": 36695695, "comment_id": 60983659, "body": "What should <code>status (A 3 :: A Valid)</code> be? A value of type <code>Valid</code>? But <code>Valid</code> is not a type (hasn&#39;t kind <code>*</code>). I don&#39;t think this is doable: <code>(-&gt;)</code> requires two types, and <code>s</code> is not a type. I would expect this to trigger a kind error on <code>A s -&gt; s</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1460993281, "post_id": 36695695, "comment_id": 60984429, "body": "@chi, you could make a singleton GADT. <code>data Ay s where Validy :: Ay Valid; Invalidy :: Ay Invalid</code> then return a singleton instead."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1460993330, "post_id": 36695695, "comment_id": 60984465, "body": "@chi the answer should be <code>Valid</code> (question updated)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1460993339, "post_id": 36695695, "comment_id": 60984470, "body": "mb14, I think it would be helpful if you gave more background about what you&#39;re trying to accomplish, ultimately."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1460993473, "post_id": 36695695, "comment_id": 60984560, "body": "Also, the <i>type</i> <code>Status</code> is largely disconnected from the <i>kind</i> <code>Status</code>, because Haskell is not (yet?) a fully dependently typed language."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1460993940, "post_id": 36695695, "comment_id": 60984885, "body": "@dfeur This is not a XY problem. I am curious to see the answer to this question. The background (not sure it helps) is to display a html form and have one type to represent all the different &quot;shape&quot; corresponding to the steps of validation, or parse a csv where different line can represent different type (but all have the same columns). You can see more <a href=\"https://www.reddit.com/r/haskell/comments/4db04s/how_to_modelize_datatype_to_handle_error_and/\" rel=\"nofollow noreferrer\">there</a>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1460994085, "post_id": 36695695, "comment_id": 60984980, "body": "If <code>s = Valid</code>, we do not have <code>status (A 3 :: A s) = Valid :: s = Valid</code>. I guess you want <code>status :: A s -&gt; Status</code> instead?"}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1460994417, "post_id": 36695695, "comment_id": 60985227, "body": "@chi: You are right. question updated."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1461000245, "post_id": 36695695, "comment_id": 60988722, "body": "There is no way, in Glasgow Haskell, to demote a type to its associated value. That&#39;s what I meant when I said the <code>Status</code> type and kind are pretty much disconnected. The <code>singletons</code> package offers Template Haskell bits to create types, promotions, and demotions in one go, but GHC proper won&#39;t prove them correct."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1461000809, "post_id": 36695695, "comment_id": 60989013, "body": "It seems we can demote nat and symbol, maybe I can use that ?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1461004451, "post_id": 36695695, "comment_id": 60991047, "body": "@mb14 If you want some general function to convert a type to the value from which it is promoted, this is simply impossible. As mentioned by another commenter, packages like <code>singletons</code> accomplish this by generating a bunch of boilerplate for each type with TH. The only reason it works with <code>Nat</code> and <code>Symbol</code> is because they are special, built-in kinds."}], "answers": [{"tags": [], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "is_accepted": true, "score": 0, "last_activity_date": 1460995624, "creation_date": 1460995624, "answer_id": 36699090, "question_id": 36695695, "link": "https://stackoverflow.com/questions/36695695/how-to-extract-the-value-of-literal-phantom-type/36699090#36699090", "title": "How to extract the value of literal phantom type?", "body": "<p>Type class work but you need to roll down all the cases</p>\n\n<pre><code>class HasStatus where\n  status :: s -&gt; status\n\ninstance HasStatus (A Valid) where\n  status = const Valid\ninstance HasStatus (A Invalid) where\n  status = const Invalid\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1461003160, "post_id": 36700779, "comment_id": 60990295, "body": "Everything is known at compile time and the typeclass solution works so it&#39;s possible."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 1, "creation_date": 1461013440, "post_id": 36700779, "comment_id": 60996442, "body": "It&#39;s not true that everything is known at compile time, for example if you put an <code>A s</code> in some kind of existential data structure that forgets <code>s</code>, and then take it back out. A function of type <code>A s -&gt; Status</code> is not the same as a function of type <code>(HasStatus s) =&gt; A s -&gt; Status</code>, even if there are instances for both &quot;values&quot; of <code>HasStatus</code>. The type class solution does work exactly when the type <code>s</code> actually is known."}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": false, "score": 2, "last_activity_date": 1461001213, "creation_date": 1461001213, "answer_id": 36700779, "question_id": 36695695, "link": "https://stackoverflow.com/questions/36695695/how-to-extract-the-value-of-literal-phantom-type/36700779#36700779", "title": "How to extract the value of literal phantom type?", "body": "<p>You can't write your function <code>status :: A s -&gt; Status</code> simply because (in GHC) functions do not receive any kind of representation of their type arguments at runtime, and without knowing anything about <code>s</code>, you have no useful information in the argument of type <code>A s</code>. This applies regardless of whether <code>s</code> has a kind promoted from a data type or a traditional kind like <code>*</code>.</p>\n\n<p>In order to get out information that varies at runtime (your <code>Status</code> result) you must provide some input that varies at runtime. This can be either a type class context, as you found, or you could add the information to <code>A</code> itself:</p>\n\n<pre><code>data A (s :: Status) where\n    A1 :: Int -&gt; A Valid\n    A2 :: Either String Int -&gt; A Invalid\n</code></pre>\n\n<p>and then you can implement <code>status</code> by pattern-matching on the argument.</p>\n"}], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 1, "accepted_answer_id": 36699090, "answer_count": 2, "score": 3, "last_activity_date": 1461001213, "creation_date": 1460986821, "last_edit_date": 1460995700, "question_id": 36695695, "link": "https://stackoverflow.com/questions/36695695/how-to-extract-the-value-of-literal-phantom-type", "title": "How to extract the value of literal phantom type?", "body": "<p>I use a type lateral phantom type (status) to change the type of a record field (via type family). How can I get the value back?</p>\n\n<p>Let's say I have the following code:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies, DataKinds #-}\n\ndata Status = Valid | Invalid deriving(Show)\n\ndata A s = A (TF s)\n\ntype family TF (s:: Status) where\n    TF Valid = Int\n    TF Invalid = Either String Int\n\nstatus :: A s -&gt; Status\nstatus = ???\n</code></pre>\n\n<p>How can I write status?</p>\n\n<h2>Update</h2>\n\n<p>To clarify, <code>s</code> is a value of type Status. Therefore, I expect <code>status (A 3 :: A Valid)</code> (for example) to be <code>Valid</code>.</p>\n\n<h2>Update2</h2>\n\n<p>I found a solution with typeclass (see my own answer), however I would much prefer a way to demote a type to its value.</p>\n"}, {"tags": ["haskell", "protocol-buffers"], "answers": [{"comments": [{"owner": {"reputation": 2795, "user_id": 622025, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f0878784007b4bbf4ddf6f30402b5cee?s=128&d=identicon&r=PG", "display_name": "Dan Kruchinin", "link": "https://stackoverflow.com/users/622025/dan-kruchinin"}, "edited": false, "score": 0, "creation_date": 1460987614, "post_id": 36695914, "comment_id": 60980018, "body": "cheers mate, you can&#39;t imagine how much time I spent trying to figure out what&#39;s wrong :)"}], "tags": [], "owner": {"reputation": 573, "user_id": 1138356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f30592f8b30fedad0e7dbe50f0a7102?s=128&d=identicon&r=PG", "display_name": "Dmitry Dzhus", "link": "https://stackoverflow.com/users/1138356/dmitry-dzhus"}, "is_accepted": true, "score": 6, "last_activity_date": 1460987319, "creation_date": 1460987319, "answer_id": 36695914, "question_id": 36695462, "link": "https://stackoverflow.com/questions/36695462/haskell-protobuf-ambiguous-type-variable/36695914#36695914", "title": "Haskell protobuf: ambiguous type variable", "body": "<p>You need to give more information about what the type of your optional data is. When you use <code>Nothing</code> as a value of type <code>Maybe a</code>, the compiler cannot infer what type exactly <code>a</code> is. You can fix it by explicitly giving a type to <code>Nothing</code>, as in <code>(Nothing :: Maybe Foo)</code>.</p>\n"}], "owner": {"reputation": 2795, "user_id": 622025, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f0878784007b4bbf4ddf6f30402b5cee?s=128&d=identicon&r=PG", "display_name": "Dan Kruchinin", "link": "https://stackoverflow.com/users/622025/dan-kruchinin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "accepted_answer_id": 36695914, "answer_count": 1, "score": 1, "last_activity_date": 1460987319, "creation_date": 1460986213, "last_edit_date": 1460986627, "question_id": 36695462, "link": "https://stackoverflow.com/questions/36695462/haskell-protobuf-ambiguous-type-variable", "title": "Haskell protobuf: ambiguous type variable", "body": "<p>Usually I know how to fix ambiguous type variable problems but not this time. Long story short, I use <a href=\"https://hackage.haskell.org/package/protobuf-0.2.1.0/docs/Data-ProtocolBuffers.html#t:Encode\" rel=\"nofollow\">protobuf</a> Haskell library for working with <a href=\"https://developers.google.com/protocol-buffers/\" rel=\"nofollow\">protocol buffers</a>. The library makes you forget about maintaining separate .proto files, it derives the way to serialise and deserialise your data type if it's an instance of Encode and Decode type classes respectively.</p>\n\n<p>I'm designing a simple protocol on top of protobuf. There's a main message data type containing a message id, message type and some optional data that depends on the type. I want to have a function that gets message id, message type and the optional data (which is required to be an instance of Encode class) and creates a new instance of MyMessage with optional data serialised to ByteString in advance.</p>\n\n<p>That's how I try to do this:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE DataKinds     #-}\n{-# LANGUAGE DeriveGeneric #-}\n\nimport           Data.ByteString      (ByteString)\nimport           Data.Int\nimport           Data.Maybe\nimport           Data.Monoid\nimport           Data.ProtocolBuffers\nimport           Data.Serialize\nimport           Data.Text            (Text, pack)\nimport           GHC.Generics         (Generic)\nimport           GHC.TypeLits\n\ndata MyMsgType = MSG_TYPE_1\n               | MSG_TYPE_2\n               deriving (Enum, Show)\n\ndata MyMessage = MyMessage {\n    msgId   :: Required 1 (Value Int64)\n  , msgType :: Required 2 (Enumeration MyMsgType)\n  , cpData  :: Optional 3 (Value ByteString)\n} deriving (Generic, Show)\n\ninstance Encode MyMessage\ninstance Decode MyMessage\n\ncreateMessage :: Encode a =&gt; Int64 -&gt; MyMsgType -&gt; Maybe a -&gt; MyMessage\ncreateMessage msgId msgType optionalData =\n  MyMessage (putField msgId) (putField msgType) (putField $ serialiseOptionalData optionalData)\n\nserialiseMessage :: MyMessage -&gt; ByteString\nserialiseMessage = runPut . encodeLengthPrefixedMessage\n\nserialiseOptionalData :: Encode a =&gt; Maybe a -&gt; Maybe ByteString\nserialiseOptionalData Nothing    = Nothing\nserialiseOptionalData (Just ctx) =\n  Just . runPut . encodeLengthPrefixedMessage $ ctx\n</code></pre>\n\n<p>When I try using createMessage function I get the following error:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>\u03bb&gt; createMessage 1 MSG_TYPE_1 Nothing\n\n&lt;interactive&gt;:7:1:\n    No instance for (Encode a0) arising from a use of \u2018createMessage\u2019\n    The type variable \u2018a0\u2019 is ambiguous\n    Note: there are several potential instances:\n      instance Encode MyMessage -- Defined at test.hs:24:10\n      instance Encode\n                 (unordered-containers-0.2.6.0:Data.HashMap.Base.HashMap\n                    protobuf-0.2.1.0:Data.ProtocolBuffers.Wire.Tag\n                    [protobuf-0.2.1.0:Data.ProtocolBuffers.Wire.WireField])\n        -- Defined in \u2018protobuf-0.2.1.0:Data.ProtocolBuffers.Encode\u2019\n    In the expression: createMessage 1 MSG_TYPE_1 Nothing\n    In an equation for \u2018it\u2019: it = createMessage 1 MSG_TYPE_1 Nothing\n</code></pre>\n\n<p>Can someone explain me why this error arises and how to fix it? I don't get where exactly the compiler sees the ambiguity.</p>\n"}, {"tags": ["macos", "haskell", "path", "functional-programming", "main"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1460985885, "post_id": 36694684, "comment_id": 60978658, "body": "A little bit more information. Where do you execute your program, where is <code>file.txt</code>?"}, {"owner": {"reputation": 195, "user_id": 6188704, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b0666611ba934676767d250089c4a4fa?s=128&d=identicon&r=PG&f=1", "display_name": "Mauritius", "link": "https://stackoverflow.com/users/6188704/mauritius"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1460985933, "post_id": 36694684, "comment_id": 60978694, "body": "thanks for reply. i run a shell and open ghci mode there, on a mac. file.txt is in the same folder like the program itself"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1460985958, "post_id": 36694684, "comment_id": 60978713, "body": "<a href=\"https://stackoverflow.com/posts/36694684/edit\">edit</a> your question with additional information. Show your whole GHCi session and the relevant contents of your working directory, e.g. <code>ls -l *.txt</code>."}, {"owner": {"reputation": 195, "user_id": 6188704, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b0666611ba934676767d250089c4a4fa?s=128&d=identicon&r=PG&f=1", "display_name": "Mauritius", "link": "https://stackoverflow.com/users/6188704/mauritius"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1460986277, "post_id": 36694684, "comment_id": 60978972, "body": "added screenshot. working directory is on the left, path there in second line of shell"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1460986620, "post_id": 36694684, "comment_id": 60979222, "body": "Well, where do you execute GHCi? Probably in <code>&#47;home&#47;Mauritius&#47;Uni&#47;Vorlesungen&#47;Haskell&#47;</code>. Either way, <b>that&#39;s</b> where GHCi will look for your file. You need to provide a complete path. By the way, this is the same for <b>all</b> programming languages: if you use relative paths, you need to run the program at the right place."}, {"owner": {"reputation": 195, "user_id": 6188704, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b0666611ba934676767d250089c4a4fa?s=128&d=identicon&r=PG&f=1", "display_name": "Mauritius", "link": "https://stackoverflow.com/users/6188704/mauritius"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1460986780, "post_id": 36694684, "comment_id": 60979342, "body": "ok thanks! i just started ghc from that directory and it worked all fine. but as i work on different files and i don&#39;t want to leave ghci all the time, is there a way of getting that path and adding it after openFile?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1460987011, "post_id": 36694684, "comment_id": 60979532, "body": "You mean like &quot;ask the user for the path&quot;? That would be <code>getLine</code> or similar. By the way <code>openFile path ReadMode &gt;&gt;= \\handle -&gt; hGetContents handle &gt;&gt;= \\input -&gt; hClose handle &gt;&gt; return input</code> is the same as <code>readFile path</code>."}], "answers": [{"comments": [{"owner": {"reputation": 195, "user_id": 6188704, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b0666611ba934676767d250089c4a4fa?s=128&d=identicon&r=PG&f=1", "display_name": "Mauritius", "link": "https://stackoverflow.com/users/6188704/mauritius"}, "edited": false, "score": 0, "creation_date": 1460987063, "post_id": 36695765, "comment_id": 60979575, "body": "okay, working fine now. did&#39;t know that i can use :cd in ghci."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 195, "user_id": 6188704, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b0666611ba934676767d250089c4a4fa?s=128&d=identicon&r=PG&f=1", "display_name": "Mauritius", "link": "https://stackoverflow.com/users/6188704/mauritius"}, "edited": false, "score": 1, "creation_date": 1460987128, "post_id": 36695765, "comment_id": 60979640, "body": "@Mauritius: Check <code>:?</code> or <code>:help</code> for a full list of all commands."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 3, "last_activity_date": 1460986976, "creation_date": 1460986976, "answer_id": 36695765, "question_id": 36694684, "link": "https://stackoverflow.com/questions/36694684/how-to-get-the-path-for-openfile-in-haskell/36695765#36695765", "title": "How to get the path for openFile in Haskell?", "body": "<p>Your current program uses a relative path. As such, the file must be in the same directory where you started GHCi. Given that your workspace is <code>$HOME/Desktop/Haskell</code>, it probably checks only for <code>$HOME/Desktop/Haskell/palindrome.txt</code>. If you want to use the <code>palindrome.txt</code> in $HOME/Desktop/Haskell/u03/3-1/`, you need to either use the absolute path in your code, or run GHCi in that directory.</p>\n\n<p>Note that you can change the current directory in GHCi with <code>:cd</code>, so the following commands in GHCi should work:</p>\n\n<pre><code>Prelude&gt; :cd /path/to/your/directory\nPrelude&gt; :l palindrom-a.hs\n*Main&gt; :main\n</code></pre>\n"}], "owner": {"reputation": 195, "user_id": 6188704, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b0666611ba934676767d250089c4a4fa?s=128&d=identicon&r=PG&f=1", "display_name": "Mauritius", "link": "https://stackoverflow.com/users/6188704/mauritius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 718, "favorite_count": 0, "accepted_answer_id": 36695765, "answer_count": 1, "score": 0, "last_activity_date": 1460986976, "creation_date": 1460984241, "last_edit_date": 1460986794, "question_id": 36694684, "link": "https://stackoverflow.com/questions/36694684/how-to-get-the-path-for-openfile-in-haskell", "title": "How to get the path for openFile in Haskell?", "body": "<p>I have the following program which throws a runtime exception:</p>\n\n<pre><code>import System.IO\n\nmain :: IO ()\nmain = do\n  handle &lt;- openFile \"palindrome.txt\" ReadMode\n  input  &lt;- hGetContents handle\n  hClose handle\n</code></pre>\n\n<p>It type checks, but whenever I try to run <code>main</code>, I'll get an error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/qQXFs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qQXFs.png\" alt=\"Atom session on Mac OS X\"></a></p>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["haskell", "matrix", "dimension"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1460983874, "creation_date": 1460983874, "answer_id": 36694545, "question_id": 36694337, "link": "https://stackoverflow.com/questions/36694337/how-to-access-the-elements-of-a-matrix-without-lists-in-this-example/36694545#36694545", "title": "How to access the elements of a matrix without lists in this example?", "body": "<p>To access the element of the matrix at row <code>i</code> and column <code>j</code>, you can simply use <code>matrixA i j</code>. In fact, <code>matrixA</code> is a function which maps both indexes to the matrix element.</p>\n\n<p>I guess that the last <code>-1</code> case represents an invalid value, meaning \"indexes outside the matrix\". So, it seems that to find the size you just have to query the matrix with larger and larger row/column indexes until you get <code>-1</code>. A basic way to solve that is to proceed recursively.</p>\n"}], "owner": {"reputation": 101, "user_id": 6219741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BjRTR.jpg?s=128&g=1", "display_name": "Memphis", "link": "https://stackoverflow.com/users/6219741/memphis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 156, "favorite_count": 0, "accepted_answer_id": 36694545, "answer_count": 1, "score": -3, "last_activity_date": 1460985950, "creation_date": 1460983307, "last_edit_date": 1460985950, "question_id": 36694337, "link": "https://stackoverflow.com/questions/36694337/how-to-access-the-elements-of-a-matrix-without-lists-in-this-example", "title": "How to access the elements of a matrix without lists in this example?", "body": "<p>I am quite new at haskell. Our task is to write an algorithm that calculates the dimension of a square matrix. But we are not supposed to use lists. But I dont know how to access to each element of the matrix, which is given like that:</p>\n\n<pre><code>matrixA 1 1 = 0\nmatrixA 1 2 = 42\nmatrixA 1 3 = 1337\nmatrixA 2 1 = 501\nmatrixA 2 2 = 314\nmatrixA 2 3 = 301\nmatrixA 3 1 = 13\nmatrixA 3 2 = 161\nmatrixA 3 3 = 271\nmatrixA _ _ = -1\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 28584, "user_id": 706317, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/1mafF.jpg?s=128&g=1", "display_name": "ZhekaKozlov", "link": "https://stackoverflow.com/users/706317/zhekakozlov"}, "edited": false, "score": 0, "creation_date": 1460982691, "post_id": 36692763, "comment_id": 60976272, "body": "One line declaration is useful when all variables have the same type: <code>a,b,c,d,e,f :: Int</code>"}], "tags": [], "owner": {"reputation": 21654, "user_id": 107331, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/cf6d0868b2b4c69bac3e6f265a32b6a7?s=128&d=identicon&r=PG", "display_name": "Daniel Martin", "link": "https://stackoverflow.com/users/107331/daniel-martin"}, "is_accepted": false, "score": 8, "last_activity_date": 1460979094, "creation_date": 1460979094, "answer_id": 36692763, "question_id": 36692560, "link": "https://stackoverflow.com/questions/36692560/how-to-declare-type-of-multiple-variables-in-same-line/36692763#36692763", "title": "How to declare type of multiple variables in same line", "body": "<p>If you really have to do this, you can:</p>\n\n<pre><code>a :: Integer; b :: Double; c :: String\n(a, b, c) = (10, 12.34, \"Abcd\")\n</code></pre>\n\n<p>Though I'd recommend you learn to like multiple lines, since that's generally better style.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 3, "last_activity_date": 1460979204, "creation_date": 1460979204, "answer_id": 36692812, "question_id": 36692560, "link": "https://stackoverflow.com/questions/36692560/how-to-declare-type-of-multiple-variables-in-same-line/36692812#36692812", "title": "How to declare type of multiple variables in same line", "body": "<pre><code>(a :: Integer, b :: Double, c :: String) = ...`\n</code></pre>\n\n<p>should work, but probably requires the <code>ScopedTypeVariables</code> extension.</p>\n"}, {"tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": false, "score": 2, "last_activity_date": 1460980383, "creation_date": 1460980383, "answer_id": 36693222, "question_id": 36692560, "link": "https://stackoverflow.com/questions/36692560/how-to-declare-type-of-multiple-variables-in-same-line/36693222#36693222", "title": "How to declare type of multiple variables in same line", "body": "<p>If they form a structure (that makes sense as a composite), structuring them first might be an option:</p>\n\n<pre><code>vals :: (Integer, Double, String)\nvals = (10, 12.34, \"Abcd\")\n\n(a, b, c) = vals\n</code></pre>\n\n<p>I don't see a reason to not put them on separate lines otherwise.</p>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1460983017, "creation_date": 1460983017, "answer_id": 36694231, "question_id": 36692560, "link": "https://stackoverflow.com/questions/36692560/how-to-declare-type-of-multiple-variables-in-same-line/36694231#36694231", "title": "How to declare type of multiple variables in same line", "body": "<p>You can combine the binding and the type declaration in one line.</p>\n\n<pre><code>a = 10     :: Int\nb = 12.34  :: Double\nc = \"Abcd\" :: String\n</code></pre>\n\n<p>There's not much value in separating the two, since you can't really assign a different value to any of these names later.</p>\n"}], "owner": {"reputation": 2579, "user_id": 3302424, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/70d64f2369ad3cfd0d9271792bdccf3c?s=128&d=identicon&r=PG&f=1", "display_name": "Hari Krishna", "link": "https://stackoverflow.com/users/3302424/hari-krishna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1253, "favorite_count": 0, "accepted_answer_id": 36692812, "answer_count": 4, "score": 1, "last_activity_date": 1460983017, "creation_date": 1460978599, "question_id": 36692560, "link": "https://stackoverflow.com/questions/36692560/how-to-declare-type-of-multiple-variables-in-same-line", "title": "How to declare type of multiple variables in same line", "body": "<p>Suppose my Haskell file contains following declarations.</p>\n\n<pre><code>a :: Integer\nb :: Double\nc :: String\n\na = 10\nb = 12.34\nc = \"Abcd\"\n</code></pre>\n\n<p>I am able to assign values to variables in same line like below.</p>\n\n<pre><code> (a, b, c) = (10, 12.34, \"Abcd\")\n</code></pre>\n\n<p>My question is, how can I define the type signature in same line?</p>\n\n<p>When I used following statement.</p>\n\n<pre><code>  (a, b, c) :: (Integer, Double, String)\n</code></pre>\n\n<p>I am getting following error.</p>\n\n<pre><code>Invalid type signature: (a, b, c) :: (Integer, Double, String)\n    Should be of form &lt;variable&gt; :: &lt;type&gt;\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1460971596, "post_id": 36686235, "comment_id": 60968610, "body": "Not as far as I know; you could maybe add a symlink <code>MyProject \u2192 .</code> t the <code>src</code> folder. And see what tools break that naively traverse the directory tree :-)"}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1460971677, "post_id": 36686235, "comment_id": 60968677, "body": "If you don\u2019t want to break tools, add a symlink <code>MyProject \u2192 ..&#47;src</code> to a new directory <code>real-src</code> and use that as the <code>hs-sources</code> option in the <code>.cabal</code> file."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1461456706, "post_id": 36686235, "comment_id": 61208113, "body": "While you can probably use a symlink as suggested, I would just create the <code>src&#47;MyProject</code> directory and move everything into it. This is how cabal expects it, and how every other package does it, so why not just do it?"}, {"owner": {"reputation": 365, "user_id": 1560138, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/370b89d2b931def9f3df67326283b295?s=128&d=identicon&r=PG", "display_name": "tmortiboy", "link": "https://stackoverflow.com/users/1560138/tmortiboy"}, "edited": false, "score": 0, "creation_date": 1461460492, "post_id": 36686235, "comment_id": 61208813, "body": "I now realise that the best solution is to just follow the convention and move my source files into the <code>MyProject</code> folder."}], "owner": {"reputation": 365, "user_id": 1560138, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/370b89d2b931def9f3df67326283b295?s=128&d=identicon&r=PG", "display_name": "tmortiboy", "link": "https://stackoverflow.com/users/1560138/tmortiboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 101, "favorite_count": 0, "closed_date": 1461460399, "answer_count": 0, "score": 6, "last_activity_date": 1461456450, "creation_date": 1460958222, "last_edit_date": 1461456450, "question_id": 36686235, "link": "https://stackoverflow.com/questions/36686235/haskell-default-module-prefix", "closed_reason": "Duplicate", "title": "Haskell: Default module prefix", "body": "<p>If have a Stack Haskell project called <code>MyProject</code> that contains the following modules:</p>\n\n<pre><code>src\\\n   Foo1\n   Foo2\n   Bar\\\n       Foo3\n</code></pre>\n\n<p>I would like to add a project prefix to all of the module names to help me distinguish them from other imported modules from other packages, eg <code>MyProject.Bar.Foo3</code></p>\n\n<p>I know I could move the contents of <code>src</code> into a folder <code>MyProject</code> and then prefix all the modules with <code>MyProject.</code>, but is there a way to do this with the cabal file, eg <code>project-prefix=MyProject</code>, or other solution that will give me the same effect, without having to restructure the project files?</p>\n"}, {"tags": ["java", "haskell", "ghci"], "comments": [{"owner": {"reputation": 592, "user_id": 2261532, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3b4ee8d416be243b77f04228f91f8131?s=128&d=identicon&r=PG&f=1", "display_name": "Norsk", "link": "https://stackoverflow.com/users/2261532/norsk"}, "edited": false, "score": 0, "creation_date": 1460953371, "post_id": 36685367, "comment_id": 60959785, "body": "Have you tried using a buffered reader instead of Scanner?"}, {"owner": {"reputation": 13391, "user_id": 2775450, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/NSYSd.jpg?s=128&g=1", "display_name": "Codebender", "link": "https://stackoverflow.com/users/2775450/codebender"}, "edited": false, "score": 2, "creation_date": 1460953543, "post_id": 36685367, "comment_id": 60959823, "body": "Because <code>sc.hasNextLine()</code> waits until the <b>end of stream</b> has been reached (if there&#39;s no input)... And end of stream will happen only when the program quits."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1461254596, "post_id": 36685367, "comment_id": 61126689, "body": "Two concerns: 1. GHCi isn&#39;t really designed to be used like this. It&#39;s an interactive development tool. Relying on any details of its interactive user interface could make your program break when a new version comes out. Could you just use <code>ghc -e</code> for your purposes? 2. You&#39;d better not be exposing GHCi to the web, unless you have some major sandbox around it; full GHCi access is like full shell access."}], "answers": [{"comments": [{"owner": {"reputation": 199, "user_id": 1276588, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/306650b5c1a53bc6d2a87516ff6a480f?s=128&d=identicon&r=PG", "display_name": "Max Lipton", "link": "https://stackoverflow.com/users/1276588/max-lipton"}, "edited": false, "score": 0, "creation_date": 1460954020, "post_id": 36685489, "comment_id": 60959920, "body": "Do you know how I could have it print out everything until the user has to enter input?"}, {"owner": {"reputation": 8201, "user_id": 3690024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2d5067f52318f0ed4db9eca0b2cda1?s=128&d=identicon&r=PG", "display_name": "AJNeufeld", "link": "https://stackoverflow.com/users/3690024/ajneufeld"}, "reply_to_user": {"reputation": 199, "user_id": 1276588, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/306650b5c1a53bc6d2a87516ff6a480f?s=128&d=identicon&r=PG", "display_name": "Max Lipton", "link": "https://stackoverflow.com/users/1276588/max-lipton"}, "edited": false, "score": 0, "creation_date": 1460954119, "post_id": 36685489, "comment_id": 60959947, "body": "Watch the output stream, looking for a prompt from <code>GHCi</code>.  See edit"}, {"owner": {"reputation": 199, "user_id": 1276588, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/306650b5c1a53bc6d2a87516ff6a480f?s=128&d=identicon&r=PG", "display_name": "Max Lipton", "link": "https://stackoverflow.com/users/1276588/max-lipton"}, "edited": false, "score": 0, "creation_date": 1461228148, "post_id": 36685489, "comment_id": 61106710, "body": "Are you saying after I receive a new line, I should check to see if it is equal to &quot;Main&gt;&quot;, which is what GHCi prints before requesting user input? Is there a general solution to determining whether the scanner is blocked from reading the next character in an InputStream?"}, {"owner": {"reputation": 8201, "user_id": 3690024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2d5067f52318f0ed4db9eca0b2cda1?s=128&d=identicon&r=PG", "display_name": "AJNeufeld", "link": "https://stackoverflow.com/users/3690024/ajneufeld"}, "reply_to_user": {"reputation": 199, "user_id": 1276588, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/306650b5c1a53bc6d2a87516ff6a480f?s=128&d=identicon&r=PG", "display_name": "Max Lipton", "link": "https://stackoverflow.com/users/1276588/max-lipton"}, "edited": false, "score": 0, "creation_date": 1461247985, "post_id": 36685489, "comment_id": 61121665, "body": "If you can change the prompt to &quot;Main&gt;\\n&quot;, (note the newline at the end), then yes.  <code>in.nextLine()</code> would return the entire prompt (minus the newline), which would be an indication that GHCi will be expecting user input.   Is there a general solution?  No.  The Haskell program may take a long time to produce output; is the scanner blocked?   Alternately, the Haskell program might be expecting input from the user.  If you wait (say) 10 seconds after the last character appeared on the output, that might indicate it is waiting for input ... or it could be just slow."}, {"owner": {"reputation": 8201, "user_id": 3690024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2d5067f52318f0ed4db9eca0b2cda1?s=128&d=identicon&r=PG", "display_name": "AJNeufeld", "link": "https://stackoverflow.com/users/3690024/ajneufeld"}, "reply_to_user": {"reputation": 199, "user_id": 1276588, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/306650b5c1a53bc6d2a87516ff6a480f?s=128&d=identicon&r=PG", "display_name": "Max Lipton", "link": "https://stackoverflow.com/users/1276588/max-lipton"}, "edited": false, "score": 0, "creation_date": 1461253753, "post_id": 36685489, "comment_id": 61126082, "body": "Blinding flash of the obvious.  Instead of trying to force GHCi&#39;s prompt to match the <code>nextLine()</code> delimiter <code>\\n</code>, change the scanner&#39;s delimiter to match the GHCi&#39;s prompt.  See edit."}, {"owner": {"reputation": 199, "user_id": 1276588, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/306650b5c1a53bc6d2a87516ff6a480f?s=128&d=identicon&r=PG", "display_name": "Max Lipton", "link": "https://stackoverflow.com/users/1276588/max-lipton"}, "edited": false, "score": 0, "creation_date": 1461277272, "post_id": 36685489, "comment_id": 61139312, "body": "The issue with waiting is that I&#39;m having GHCi execute some potentially lengthy calculations, and it&#39;s difficult to know how long I should wait. I got it to work by using &quot;Main&gt;&quot; as a delimiter, but now I&#39;m curious if there&#39;s a general method to know when a process is waiting for input. Like if there&#39;s an &quot;isWaiting()&quot; method."}, {"owner": {"reputation": 8201, "user_id": 3690024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2d5067f52318f0ed4db9eca0b2cda1?s=128&d=identicon&r=PG", "display_name": "AJNeufeld", "link": "https://stackoverflow.com/users/3690024/ajneufeld"}, "reply_to_user": {"reputation": 199, "user_id": 1276588, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/306650b5c1a53bc6d2a87516ff6a480f?s=128&d=identicon&r=PG", "display_name": "Max Lipton", "link": "https://stackoverflow.com/users/1276588/max-lipton"}, "edited": false, "score": 0, "creation_date": 1461277906, "post_id": 36685489, "comment_id": 61139533, "body": "No, as long as the process hasn&#39;t terminated or closed its standard input, it is &quot;waiting for input&quot;.  But, if you are using the &quot;Main&gt;&quot; delimiter, you don&#39;t really need to know how long to wait for.  The <code>in.hasNext()</code> will block until the stream is closed or the prompt is encountered, so it is doing the waiting for you."}], "tags": [], "owner": {"reputation": 8201, "user_id": 3690024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2d5067f52318f0ed4db9eca0b2cda1?s=128&d=identicon&r=PG", "display_name": "AJNeufeld", "link": "https://stackoverflow.com/users/3690024/ajneufeld"}, "is_accepted": false, "score": 2, "last_activity_date": 1461254397, "last_edit_date": 1495542234, "creation_date": 1460953672, "answer_id": 36685489, "question_id": 36685367, "link": "https://stackoverflow.com/questions/36685367/using-command-prompt-with-java/36685489#36685489", "title": "Using command prompt with Java", "body": "<p>Your loop won't exit until the end of the stream has been reached:</p>\n\n<pre><code>while (sc.hasNextLine()){\n    System.out.println(sc.nextLine());\n}\n</code></pre>\n\n<p>The end of the stream is the end of your process.   So, your Java program is waiting for the sub process to run to completion, and terminate.  Once that happens, the loop will end, and the Java program will send the desired commands to the process. </p>\n\n<p>Sorry, I mean, try to send the desired commands to the process; it won't succeed because the process has terminated.</p>\n\n<p>If the GHCi process outputs a \"prompt\" of some kind, you could try to break your <code>while(...) { print }</code> at that moment, get input from the user, send that to the process, and then loop back and re-enter your <code>while(...) { print }</code>, waiting for the next prompt.</p>\n\n<p>Assuming the prompt does not end with a newline, but rather appears at the start of a line where the user input gets typed, you cannot use a <code>while(sc.hasNextLine()) { ... }</code> type of loop, because the prompt is not a complete line.  You might have to resort to reading character by character, looking for the prompt sequence in the last \"n\" characters.</p>\n\n<p>Looks like you can change the prompt in GHCi.  See <a href=\"https://stackoverflow.com/questions/25373116/how-can-i-set-my-ghci-prompt-to-a-lambda-character-on-windows\">here for details</a>.  If you change the prompt to end with a newline, you could still read the stream in lines.</p>\n\n<pre><code>while (sc.hasNextLine()){\n    String line = sc.nextLine();\n    if (line.equals(\"YourPromptHere\"))\n         break;\n    System.out.println(line);\n}\n</code></pre>\n\n<p>(Alternately, you might be able to do something with threads to allow both parts to run without blocking each other.  Of course, threading comes with its own issues and complexity.)</p>\n\n<hr>\n\n<p><strong>EDIT</strong></p>\n\n<p>I had a blinding flash of the obvious.  Assuming GHC's prompt looks like this ...</p>\n\n<blockquote>\n<pre><code>GHCi, version 7.10.3\nyada, yada, yada ...\nMain&gt; _\n</code></pre>\n</blockquote>\n\n<p>... you could set the scanner's delimiter to be the prompt string <code>Main&gt;</code>.</p>\n\n<pre><code>// Set scanner delimiter to GHCi's Prompt string\nsc = new Scanner(hugsout).setDelimiter(\"^Main&gt; \");\n\nwhile (sc.hasNext()) {\n\n    // Echo GHCi's output upto the delimiter (prompt)\n    System.out.println(sc.next());\n\n    // Read user input &amp; transfer to GHCi.\n    System.out.print(\"Replacement Prompt&gt; \");\n    rdnextline = rd.nextLine();\n    if (rdnextline == \"quit\") {\n        break;\n    }\n    hugsin.println(rdnextline);\n    hugsin.flush();\n }\n</code></pre>\n\n<p><em>Note</em>: This does not take into account the secondary prompt, used when GHCi expects more input to complete the command.  You could use a regex something like <code>\"^Main&gt; |\\bAlt&gt; \"</code> that matches either prompt, but you would not be able to tell which prompt the delimiter matched.\nThe first subexpression <code>\"^Main&gt; \"</code> matches the start of a line, followed by \"Main> \", where as the second subexpression <code>\"\\bAlt&gt; \"</code> only matches a <em>word boundary</em> followed by \"Alt> \".  This is because the output stream of the GHCi, would look like <code>\"\\nMain&gt; Alt&gt; \"</code> with a long pause before the <code>Alt&gt;</code>; the \"newline\" before <code>Alt&gt;</code> would normally come from the echoing of the <code>Enter</code> keypressed on the input stream.</p>\n"}, {"comments": [{"owner": {"reputation": 199, "user_id": 1276588, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/306650b5c1a53bc6d2a87516ff6a480f?s=128&d=identicon&r=PG", "display_name": "Max Lipton", "link": "https://stackoverflow.com/users/1276588/max-lipton"}, "edited": false, "score": 0, "creation_date": 1460955837, "post_id": 36685586, "comment_id": 60960408, "body": "Thanks for that, it seems to be working. It appears you take a reader and have it read the characters and print them out one at a time. Why are you checking if the character is not -1?"}, {"owner": {"reputation": 199, "user_id": 1276588, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/306650b5c1a53bc6d2a87516ff6a480f?s=128&d=identicon&r=PG", "display_name": "Max Lipton", "link": "https://stackoverflow.com/users/1276588/max-lipton"}, "edited": false, "score": 0, "creation_date": 1460956272, "post_id": 36685586, "comment_id": 60960542, "body": "And how come the while(true) loop only continuously retrieves user input? It appears that the program only prints the output of GHCi once, yet it loops just fine."}], "tags": [], "owner": {"reputation": 13155, "user_id": 4910279, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a24754c60fd95e2f27f4c8275505863?s=128&d=identicon&r=PG", "display_name": "saka1029", "link": "https://stackoverflow.com/users/4910279/saka1029"}, "is_accepted": false, "score": 2, "last_activity_date": 1460954420, "creation_date": 1460954420, "answer_id": 36685586, "question_id": 36685367, "link": "https://stackoverflow.com/questions/36685367/using-command-prompt-with-java/36685586#36685586", "title": "Using command prompt with Java", "body": "<p>Receive output of ghci in another thread like this.</p>\n\n<pre><code>System.out.println(\"Starting... \");\n\nProcess p = Runtime.getRuntime().exec(\"ghci\");\n\nPrintStream hugsin = new PrintStream(p.getOutputStream());\nInputStream hugsout = p.getInputStream();\nScanner rd = new Scanner(System.in);\nnew Thread(() -&gt; {\n    try (Reader r = new InputStreamReader(hugsout)) {\n        int ch;\n        while ((ch = r.read()) != -1)\n            System.out.print((char)ch);\n    } catch (IOException e ) {}\n}).start();\nScanner sc = new Scanner(hugsout);\nString rdnextline;\nwhile (true) {\n    rdnextline = rd.nextLine();\n    hugsin.println(rdnextline);\n    hugsin.flush();\n    if (rdnextline.equals(\"quit\")) {\n        break;\n    }\n}\nSystem.out.println(\" ... successful completion.\");\n</code></pre>\n"}], "owner": {"reputation": 199, "user_id": 1276588, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/306650b5c1a53bc6d2a87516ff6a480f?s=128&d=identicon&r=PG", "display_name": "Max Lipton", "link": "https://stackoverflow.com/users/1276588/max-lipton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1461254397, "creation_date": 1460952763, "question_id": 36685367, "link": "https://stackoverflow.com/questions/36685367/using-command-prompt-with-java", "title": "Using command prompt with Java", "body": "<p>I'm working on a Windows 7 machine.</p>\n\n<p>I'm working on an application which is a front for the GHCi interpreter for Haskell. The user will input a command, then Java will execute the command via the exec() method on Runtime, and then the application will display the text that would display if the user was just running GHCi using command prompt.</p>\n\n<p>Right now, I'm running into issues with the loop that prints the output.</p>\n\n<p>Here is the code I have right now.</p>\n\n<pre><code>public class GHCiTest {\npublic static Scanner rd, sc;\n\n/**\n * @param args the command line arguments\n */\npublic static void main(String[] args) {\n\ntry {\n\n  System.out.println(\"Starting... \");\n\n  Process p = Runtime.getRuntime().exec(\"ghci\");\n\n  PrintStream hugsin  = new PrintStream(p.getOutputStream());\n  InputStream hugsout = p.getInputStream();\n\n  sc = new Scanner(hugsout);\n  rd = new Scanner(System.in);\n\n  String rdnextline;\n\n\n\n  while (true){\n    while (sc.hasNextLine()){\n        System.out.println(sc.nextLine());\n\n    }\n      System.out.println(\"yay\");\n      rdnextline = rd.nextLine();\n    if (rdnextline == \"quit\"){break;}\n    hugsin.println(rdnextline);\n    hugsin.flush();\n\n  }\n  System.out.println(\" ... successful completion.\");\n}\ncatch(IOException e) {\n  e.printStackTrace();\n}\n}\n\n}\n</code></pre>\n\n<p>I know that the initial starting of GHCi is working, because the program is printing out \"GHCi, version 7.10.3: <a href=\"http://www.haskell.org/ghc/\" rel=\"nofollow\">http://www.haskell.org/ghc/</a>  :? for help\". However, the issue appears to be the while(sc.hasNextLine()) loop, which is supposed to read the output of the command prompt and output it until there's nothing left, as it won't break out of the loop and proceed to read the user input. I know this because the program isn't printing the \"yay\" flag I put in after the loop.</p>\n"}, {"tags": ["haskell", "ssl", "https", "haskell-warp", "servant"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460954381, "post_id": 36685193, "comment_id": 60960001, "body": "do you get the error in your application or is this the browser informing you that the certificate might be untrusted? - Because if I check the <a href=\"https://hackage.haskell.org/package/tls-1.3.3/docs/src/Network-TLS-Credentials.html#credentialLoadX509Chain\" rel=\"nofollow noreferrer\">code</a> that should be used here (well I only had a quick glance and the current docs are not on <i>hackage</i> so I&#39;m not sure at all)  - it seems that the only error you should get is <code>&quot;no keys found&quot;</code> - can you post the actual output?"}, {"owner": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "edited": false, "score": 0, "creation_date": 1460955647, "post_id": 36685193, "comment_id": 60960351, "body": "You may want to try <a href=\"https://github.com/shimmercat/mousebox\" rel=\"nofollow noreferrer\">MouseBox</a> ...."}, {"owner": {"reputation": 145, "user_id": 6207699, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb172b885ff17a03b2969a9339d4a0a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jushiti", "link": "https://stackoverflow.com/users/6207699/jushiti"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460961844, "post_id": 36685193, "comment_id": 60962852, "body": "@Carsten, it&#39;s the output of my application, there&#39;s nothing more there."}, {"owner": {"reputation": 145, "user_id": 6207699, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb172b885ff17a03b2969a9339d4a0a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jushiti", "link": "https://stackoverflow.com/users/6207699/jushiti"}, "reply_to_user": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "edited": false, "score": 0, "creation_date": 1460961935, "post_id": 36685193, "comment_id": 60962910, "body": "@dsign, why on Earth I&#39;d take a solution which more difficult and unknown? Instead of fixing my error, I&#39;d take that library and encounter another error who no body would know how to fix?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1460964351, "post_id": 36685193, "comment_id": 60964182, "body": "@Jushiti: How did you &quot;went to https://\u2026&quot;? Using a browser? Try <code>curl</code> or <code>wget</code> with verbose information instead. Where did you get the error? In the client? In the server? Note that several systems expect you to update their certificate store, for example Ubuntu wants them at <code>&#47;usr&#47;local&#47;share&#47;ca-certificates&#47;</code> and places them with <code>sudo update-ca-certificates</code> at the correct place afterwards. Either way, at the moment, you need to provide a little bit more information."}, {"owner": {"reputation": 145, "user_id": 6207699, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb172b885ff17a03b2969a9339d4a0a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jushiti", "link": "https://stackoverflow.com/users/6207699/jushiti"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460966229, "post_id": 36685193, "comment_id": 60965235, "body": "@Carsten, updated."}, {"owner": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "edited": false, "score": 0, "creation_date": 1460966453, "post_id": 36685193, "comment_id": 60965359, "body": "@Jushiti It&#39;s a tool that I made exactly to solve that problem. And it is part of a <a href=\"https://www.shimmercat.com/\" rel=\"nofollow noreferrer\">commercial solution</a>, we are on it for the long run. Plus, it has a standalone executable, it is not just a library."}, {"owner": {"reputation": 145, "user_id": 6207699, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb172b885ff17a03b2969a9339d4a0a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jushiti", "link": "https://stackoverflow.com/users/6207699/jushiti"}, "reply_to_user": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "edited": false, "score": 0, "creation_date": 1460966778, "post_id": 36685193, "comment_id": 60965519, "body": "@dsign, so instead of understanding how to do that on a lower level, I&#39;d have to use your abstraction and depend on it?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460966801, "post_id": 36685193, "comment_id": 60965527, "body": "well to me it looks as if your system/browser rejects the certificate (see Zetas comment for a possible fix) - sorry that I missed the <code>csr&#47;pem</code> problem in the first place - anyway it should work - locally you don&#39;t need it so I would just use it on the server with the actual certificate"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "edited": false, "score": 0, "creation_date": 1460966864, "post_id": 36685193, "comment_id": 60965564, "body": "BTW: please stop complaining about @dsign s comment - it&#39;s probably both viable and the right thing to do - in the end you are at a point where it&#39;s no Haskell/programming issue but hard IT stuff ;)"}, {"owner": {"reputation": 145, "user_id": 6207699, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb172b885ff17a03b2969a9339d4a0a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jushiti", "link": "https://stackoverflow.com/users/6207699/jushiti"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460966956, "post_id": 36685193, "comment_id": 60965619, "body": "@Carsten, on a server I have 4 files: cert1.pem, chain1.pem, fullchain1.pem and privkey1.pem. Which one is  my key and certificate I should I use in Haskell, could you tell me?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1460967471, "post_id": 36685193, "comment_id": 60965922, "body": "@Jushiti: Wait a second. Could you please show how you generated the certificate? It seems like you didn&#39;t fill in the FQDN (fully qualified domain name, also called <i>common name</i>). Without one, it&#39;s not clear to which domain the certificate actually belongs and will get rejected."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460967615, "post_id": 36685193, "comment_id": 60966022, "body": "I would go with <code>cert1.pem</code> for the certificate and <code>privkey1.pem</code> for the key"}, {"owner": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "edited": false, "score": 0, "creation_date": 1460967617, "post_id": 36685193, "comment_id": 60966025, "body": "@Jushiti If you want to understand things at a lower level, this <a href=\"http://security.stackexchange.com/questions/20803/how-does-ssl-tls-work\">answer may help you</a>. This <a href=\"https://www.thawte.com/resources/getting-started/how-ssl-works/\" rel=\"nofollow noreferrer\">guide</a> is also good."}, {"owner": {"reputation": 145, "user_id": 6207699, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb172b885ff17a03b2969a9339d4a0a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jushiti", "link": "https://stackoverflow.com/users/6207699/jushiti"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1460968499, "post_id": 36685193, "comment_id": 60966564, "body": "@Zeta, all empty. Where should&#39;ve I specified localhost?"}, {"owner": {"reputation": 145, "user_id": 6207699, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb172b885ff17a03b2969a9339d4a0a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jushiti", "link": "https://stackoverflow.com/users/6207699/jushiti"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1460969048, "post_id": 36685193, "comment_id": 60966894, "body": "@Zeta, with localhost for FQDN the error is still the same, maybe it depends on a port also?"}], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 3, "last_activity_date": 1460973026, "last_edit_date": 1492085615, "creation_date": 1460973026, "answer_id": 36690586, "question_id": 36685193, "link": "https://stackoverflow.com/questions/36685193/error-empty-certificate-chain-in-a-basic-haskell-app/36690586#36690586", "title": "Error &quot;empty certificate chain&quot; in a basic haskell app", "body": "<p><strong>TL;DR</strong>: Handling certificates is hard. Use the self-signed <code>.pem</code> file (and the key) and add security exceptions to your browser or your operating system. The <code>.csr</code> file isn't something you can use. The server is fine (except for the <code>.csr</code> file), but you will end up with security warnings till you get your key signed by a CA (which isn't possible for local domain names).</p>\n\n<hr>\n\n<blockquote>\n  <p>What's wrong with it?</p>\n</blockquote>\n\n<p>The server is (almost) fine. However, you want to send the <code>.pem</code> file. The <code>.csr</code> is a <em>request for signing your certificate</em> by a certificate authority (CA). A CA needs to get trusted by the user or another CA (that's trusted by the user). Let's have a look at your original commands:</p>\n\n<pre><code>openssl genrsa -out key.pem 2048\n</code></pre>\n\n<p>This will generate <a href=\"https://www.openssl.org/docs/manmaster/apps/genrsa.html\" rel=\"nofollow noreferrer\">the private key</a>, which will get used for the TLS handshake and other operations.</p>\n\n<pre><code>openssl req -new -key key.pem -out certificate.csr\n</code></pre>\n\n<p>This will generate the mentioned <a href=\"https://serverfault.com/questions/9708/what-is-a-pem-file-and-how-does-it-differ-from-other-openssl-generated-key-file\"><b>c</b>ertificate <b>s</b>igining <b>r</b>equest</a>. You would send this request to a CA, which checks your identity. For example, they would check whether the FQDN actually is yours. Otherwise, you could ask for a certificate for stackoverflow.com and use a MITM attack. This also concludes that you cannot ask a (non-local) CA for a certificate on a local name, like <code>localhost</code> or <code>hostname.local.domain.name</code>.</p>\n\n<pre><code>openssl x509 -req -in certificate.csr -signkey key.pem -out certificate.pem\n</code></pre>\n\n<p>This will take the original certificate request, use your <em>own</em> key to sign it, and generate a certificate (<code>certificate.pem</code>). Usually, this certificate contains a CA chain, e.g. who signed the CA's certificate, who signed the certificate of the one that signed the CA's certificate and so on, till we end up at a root certificate.</p>\n\n<p>So, all you have to do is to use <em>that</em> certificate together with your private key. This will lead to security warnings though, since you cannot prove your own identity. That's why you need <code>--insecure</code> in <code>curl</code> and a security exception in most browsers. That aside, it will work. Note that the server doesn't know that its certificate is self-signed. It's just using two files to initiate the communication with the client.</p>\n"}], "owner": {"reputation": 145, "user_id": 6207699, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb172b885ff17a03b2969a9339d4a0a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jushiti", "link": "https://stackoverflow.com/users/6207699/jushiti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2209, "favorite_count": 0, "accepted_answer_id": 36690586, "answer_count": 1, "score": 0, "last_activity_date": 1460973026, "creation_date": 1460951477, "last_edit_date": 1460970497, "question_id": 36685193, "link": "https://stackoverflow.com/questions/36685193/error-empty-certificate-chain-in-a-basic-haskell-app", "title": "Error &quot;empty certificate chain&quot; in a basic haskell app", "body": "<p>I generated a certificate in the directory of my Haskell app:</p>\n\n<pre><code>openssl genrsa -out key.pem 2048\nopenssl req -new -key key.pem -out certificate.csr\nopenssl x509 -req -in certificate.csr -signkey key.pem -out certificate.pem\n</code></pre>\n\n<p>and then I ran my app:</p>\n\n<pre><code>import Network.Wai\nimport Network.Wai.Handler.Warp\nimport Servant\nimport Network.Wai.Handler.WarpTLS\n\nstartApp :: IO ()\nstartApp = do\n  let port = 3345\n  let tls = tlsSettings \"certificate.csr\" \"key.pem\"\n  runTLS tls (setPort port defaultSettings) app\n</code></pre>\n\n<p>And then went to <a href=\"https://localhost:3345\" rel=\"nofollow\">https://localhost:3345</a> and I got an error \"empty certificate chain\"</p>\n\n<p>What's wrong with it? Maybe I've put my certificate somewhere such as \"/opt/....\"? </p>\n\n<p>For now all 3 files are in the root directory of my application: key.pem, certificate.csr and  certificate.pem.</p>\n\n<p>UPDATE:</p>\n\n<p>It's arch linux, whereas on hosting I have Ubuntu, therefore I'll need a solution for both.</p>\n\n<p>This certificate is self-signed, whereas on hosting it's issued by let's encrypt.</p>\n\n<p>I've changed a code a bit:  \"csr\" to pem:</p>\n\n<pre><code>let tls = tlsSettings \"certificate.pem\" \"key.pem\"\nrunTLS tls (setPort port defaultSettings) app\n</code></pre>\n\n<p>Here's another error:</p>\n\n<pre><code>    $ curl -v https://localhost:3345\n* Rebuilt URL to: https://localhost:3345/\n*   Trying ::1...\n* connect to ::1 port 3345 failed: Connection refused\n*   Trying 127.0.0.1...\n* Connected to localhost (127.0.0.1) port 3345 (#0)\n* ALPN, offering http/1.1\n* Cipher selection: ALL:!EXPORT:!EXPORT40:!EXPORT56:!aNULL:!LOW:!RC4:@STRENGTH\n* successfully set certificate verify locations:\n*   CAfile: /etc/ssl/certs/ca-certificates.crt\n  CApath: none\n* TLSv1.2 (OUT), TLS header, Certificate Status (22):\n* TLSv1.2 (OUT), TLS handshake, Client hello (1):\n* TLSv1.2 (IN), TLS handshake, Server hello (2):\n* TLSv1.2 (IN), TLS handshake, Certificate (11):\n* TLSv1.2 (OUT), TLS alert, Server hello (2):\n* SSL certificate problem: self signed certificate\n* Closing connection 0\n* TLSv1.2 (OUT), TLS alert, Client hello (1):\ncurl: (60) SSL certificate problem: self signed certificate\nMore details here: https://curl.haxx.se/docs/sslcerts.html\n\ncurl performs SSL certificate verification by default, using a \"bundle\"\n of Certificate Authority (CA) public keys (CA certs). If the default\n bundle file isn't adequate, you can specify an alternate file\n using the --cacert option.\nIf this HTTPS server uses a certificate signed by a CA represented in\n the bundle, the certificate verification probably failed due to a\n problem with the certificate (it might be expired, or the name might\n not match the domain name in the URL).\nIf you'd like to turn off curl's verification of the certificate, use\n the -k (or --insecure) option.\n</code></pre>\n"}, {"tags": ["haskell", "monad-transformers", "terminfo"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1460945454, "post_id": 36684189, "comment_id": 60958098, "body": "It might help if you could post a bigger example of the pattern you don&#39;t like in context. But I wonder have you looked at what the <code>Monad</code> instance offers you? <code>(&gt;&gt;=) :: Capability a -&gt; (a -&gt; Capability b) -&gt; Capability b</code>"}, {"owner": {"reputation": 159, "user_id": 2063685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5e2639158953513e7ffb051bf5a0a39e?s=128&d=identicon&r=PG", "display_name": "user2063685", "link": "https://stackoverflow.com/users/2063685/user2063685"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1460961446, "post_id": 36684189, "comment_id": 60962648, "body": "@jberryman : Bind doesn&#39;t get me much in this instance as I&#39;m trying to go from <code>Capability a -&gt; IO ()</code> so that <code>main</code> can execute it. However, looking at this question, I think my actual issue is that <code>runTermOutput :: Terminal -&gt; TermOutput -&gt; IO ()</code> doesn&#39;t take a <code>Capability</code>. Having some function <code>runCapability :: Terminal -&gt; Capability TermOutput -&gt; IO ()</code> would probably get rid of my code repetition. Hmm, I think this question is a little too specific for StackOverflow. Can/Should it be changed to a more general, &quot;How should Terminfo be used?&quot;"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1461004985, "post_id": 36684189, "comment_id": 60991402, "body": "@user2063685 Is there any reason you cannot write such a function? e.g. <code>\\t c -&gt; maybe (return ()) (\\x -&gt; runTermOutput ...) . getCapability t c</code> - just define it wherever you like and use it. Monad transformers won&#39;t help you here much - you could use a <code>MaybeT IO</code> transformer but unless you are using the <code>Maybe</code> logic elsewhere, it won&#39;t give you anything over simply defining the function you want. A question like &quot;How should Terminfo be used?&quot; would probably be much too broad."}, {"owner": {"reputation": 159, "user_id": 2063685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5e2639158953513e7ffb051bf5a0a39e?s=128&d=identicon&r=PG", "display_name": "user2063685", "link": "https://stackoverflow.com/users/2063685/user2063685"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1461037466, "post_id": 36684189, "comment_id": 61003790, "body": "@user2407038 Is there a way to move the <code>Capability</code> IO action to the IO unit return of <code>runCapability</code>? I would like to avoid <code>getCapability</code> as it uses <a href=\"https://hackage.haskell.org/package/terminfo-0.4.0.2/docs/src/System-Console-Terminfo-Base.html#getCapability\" rel=\"nofollow noreferrer\"><code>unsafePerformIO</code></a>. I think this may be my actual question."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1461097837, "post_id": 36684189, "comment_id": 61041585, "body": "@user2063685 <code>Capability</code> is an abstract type - the constructor is not exported. Trying to &#39;move&#39; the IO action out of the capability doesn&#39;t make any sense - there is no way to observe that it even contains an IO action without looking at the source. I&#39;m not sure why you wouldn&#39;t want to use a function just because it uses <code>unsafePerformIO</code> (if you don&#39;t trust that the author knew what they were doing when they used it, do you trust any code they write?)."}, {"owner": {"reputation": 159, "user_id": 2063685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5e2639158953513e7ffb051bf5a0a39e?s=128&d=identicon&r=PG", "display_name": "user2063685", "link": "https://stackoverflow.com/users/2063685/user2063685"}, "edited": false, "score": 0, "creation_date": 1461128880, "post_id": 36684189, "comment_id": 61051666, "body": "I just feel that if the IO actions all bubble up to <code>main</code>, it means the rest of the program is more pure, and the AST is better for it. In any case, I think your <code>\\t c -&gt; maybe (return ()) (\\x -&gt; runTermOutput t x) . (getCapability t c)</code> is the best answer I can see. This question is really a mess. I don&#39;t know if it would be for you to write up an answer, or just flag to close. Thank you to everyone that put up with me."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1461170533, "post_id": 36684189, "comment_id": 61080898, "body": "@user2063685 You are correct about isolating the IO in your program to one place, preferably <code>main</code>, but <code>Capability</code> is an abstract type - you shouldn&#39;t even need to know that it contains <code>IO</code>. The fact that it does is an implementation detail - the author could easily change the implementation without changing the interface. Trying to extract the IO from the <code>Capability</code> could violate some invariants set up by the author. Also, if my comment solves your problem feel free to make it into an answer and accept it (perhaps with some explanation as to how it solved your problem)."}], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 2063685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5e2639158953513e7ffb051bf5a0a39e?s=128&d=identicon&r=PG", "display_name": "user2063685", "link": "https://stackoverflow.com/users/2063685/user2063685"}, "edited": false, "score": 0, "creation_date": 1461037007, "post_id": 36688503, "comment_id": 61003671, "body": "<code>Capability</code> is not an instance of <code>Traversable</code>. How would I define the instance?"}, {"owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "reply_to_user": {"reputation": 159, "user_id": 2063685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5e2639158953513e7ffb051bf5a0a39e?s=128&d=identicon&r=PG", "display_name": "user2063685", "link": "https://stackoverflow.com/users/2063685/user2063685"}, "edited": false, "score": 0, "creation_date": 1461106357, "post_id": 36688503, "comment_id": 61045483, "body": "I meant that you use that instead of the case match. Hmm <i>rereads post and discussions</i> Why do you have more than one place where you want to convert the Capability into IO? (If it&#39;s just subsequent lines in the same main, where each step depends on the previous result, you could indeed use bind)"}, {"owner": {"reputation": 159, "user_id": 2063685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5e2639158953513e7ffb051bf5a0a39e?s=128&d=identicon&r=PG", "display_name": "user2063685", "link": "https://stackoverflow.com/users/2063685/user2063685"}, "edited": false, "score": 0, "creation_date": 1461129003, "post_id": 36688503, "comment_id": 61051720, "body": "<code>Capability</code> actually supports <code>mappend</code> so that&#39;s what I&#39;ve been using to string it together. I think your suggestion is equivalent."}], "tags": [], "owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "is_accepted": false, "score": 1, "last_activity_date": 1460966871, "creation_date": 1460966871, "answer_id": 36688503, "question_id": 36684189, "link": "https://stackoverflow.com/questions/36684189/how-to-use-terminfos-capability-type-correctly-are-monad-transformers-the-answ/36688503#36688503", "title": "How to use Terminfo&#39;s Capability type correctly. Are monad transformers the answer?", "body": "<pre><code>mapM :: (Monad m, Traversable t) =&gt; (a -&gt; m b) -&gt; t a -&gt; m (t b)\n</code></pre>\n\n<p>specializes not only to</p>\n\n<pre><code>mapM :: (a -&gt; IO b) -&gt; [a] -&gt; IO [b]\n</code></pre>\n\n<p>, but also to</p>\n\n<pre><code>mapM :: (a -&gt; IO b) -&gt; Maybe a -&gt; IO (Maybe b)\n</code></pre>\n\n<p>. Same goes for <code>mapM_</code> and <code>for</code> and <code>for_</code> and <code>traverse</code> and <code>traverse_</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 159, "user_id": 2063685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5e2639158953513e7ffb051bf5a0a39e?s=128&d=identicon&r=PG", "display_name": "user2063685", "link": "https://stackoverflow.com/users/2063685/user2063685"}, "is_accepted": true, "score": 0, "last_activity_date": 1461298707, "creation_date": 1461298707, "answer_id": 36784742, "question_id": 36684189, "link": "https://stackoverflow.com/questions/36684189/how-to-use-terminfos-capability-type-correctly-are-monad-transformers-the-answ/36784742#36784742", "title": "How to use Terminfo&#39;s Capability type correctly. Are monad transformers the answer?", "body": "<p>From what I understand, the <code>Terminfo Capability</code> interface means that monad transformers are not the answer.</p>\n\n<p>As user2407038 suggested, the <code>case</code> pattern can be avoided with the function,</p>\n\n<pre><code>\\t -&gt; maybe (return ()) (runTermOutput t) . (getCapability t)\n  :: Terminal -&gt; Capability TermOutput -&gt; IO ()\n</code></pre>\n"}], "owner": {"reputation": 159, "user_id": 2063685, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/5e2639158953513e7ffb051bf5a0a39e?s=128&d=identicon&r=PG", "display_name": "user2063685", "link": "https://stackoverflow.com/users/2063685/user2063685"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 36784742, "answer_count": 2, "score": 0, "last_activity_date": 1461298707, "creation_date": 1460943445, "last_edit_date": 1460967886, "question_id": 36684189, "link": "https://stackoverflow.com/questions/36684189/how-to-use-terminfos-capability-type-correctly-are-monad-transformers-the-answ", "title": "How to use Terminfo&#39;s Capability type correctly. Are monad transformers the answer?", "body": "<p>I've been struggling to simplify a small program using <code>System.Console.Terminfo</code>. I've gotten as far as <code>mappend</code>ing multiple <code>Capability</code> together, but whenever I need to evaluate them, I have to use <code>getCapability</code> and then use a <code>case</code> to pattern-match the resulting <code>Maybe</code>. The pattern is always the same</p>\n\n<pre><code>Just ... -&gt; runTermOutput ...\nNothing -&gt; return ()\n</code></pre>\n\n<p>so I think there must be a better way to do this. It seems to me that the pattern-matching is replacing <code>Maybe</code> with <code>IO</code>, so I thought it might be what monad transformers are for. Looking at the <code>Capability</code> definition,</p>\n\n<pre><code>&gt; :i Capability\nnewtype Capability a\n  = System.Console.Terminfo.Base.Capability (Terminal\n                                             -&gt; IO (Maybe a))\n...\n</code></pre>\n\n<p>it does look similar to the <code>MaybeT</code> example I found here on StackOverflow, but the fact that it's a function throws me off. (Plus, I can't claim to understand monad transformers after reading just one example.)</p>\n\n<p>Am I on the right track? Is there a different pattern that can help me avoid writing this <code>case</code> over and over again?</p>\n\n<p>Here's <code>getCapability</code> type:</p>\n\n<pre><code>&gt; :i getCapability \ngetCapability :: Terminal -&gt; Capability a -&gt; Maybe a\n...\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1460936057, "post_id": 36683322, "comment_id": 60956337, "body": "Please make sure to get the indentation right when posting StackOverflow questions (you can paste Haskell code as it is, then mark all the code and just press <code>ctrl</code>+<code>k</code> to achieve this). Also, please always add type signatures!"}, {"owner": {"reputation": 29, "user_id": 2984839, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0d3057c5cbe3a3d70d2df9d1259c5d97?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin D", "link": "https://stackoverflow.com/users/2984839/kevin-d"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1460936435, "post_id": 36683322, "comment_id": 60956413, "body": "edited :) it was my understanding that the type inference already assumes what I want to do. Both return lists."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 2, "creation_date": 1460936845, "post_id": 36683322, "comment_id": 60956492, "body": "@KevinD I wouldn&#39;t suggest making that assumption... It can lead to weirder looking type errors. If you specify what you want the types of the top level bindings to be, the errors much clearer (because you are telling the type checker what you want it to attempt to match against). Top-level type signatures also make the code easier to read."}, {"owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "edited": false, "score": 0, "creation_date": 1460966657, "post_id": 36683322, "comment_id": 60965462, "body": "By the way, your call to elem, which you probably inserted to save the time of traversing the list with an element that&#39;s not in it, will take as much time as traversing the list with that element would have, because that&#39;s exactly what elem does. You can just tell it to remove y and if it&#39;s not in there then nothing happens."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1460977419, "post_id": 36683322, "comment_id": 60972472, "body": "Style comment: the <code>otherwise</code> branch looks funny. You check for a condition and its negation, so there are no other cases. I&#39;d change the <code>not (elem y aList)</code> to <code>otherwise</code> and remove the third guard."}], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 2984839, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0d3057c5cbe3a3d70d2df9d1259c5d97?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin D", "link": "https://stackoverflow.com/users/2984839/kevin-d"}, "edited": false, "score": 0, "creation_date": 1461028591, "post_id": 36684161, "comment_id": 61001491, "body": "That did the trick. Thank you so much for your help. This really opened my eyes to Haskell!"}], "tags": [], "owner": {"reputation": 26848, "user_id": 683453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/263366f6318ce617f95d7282883402c0?s=128&d=identicon&r=PG", "display_name": "Philip JF", "link": "https://stackoverflow.com/users/683453/philip-jf"}, "is_accepted": true, "score": 3, "last_activity_date": 1460943256, "creation_date": 1460943256, "answer_id": 36684161, "question_id": 36683322, "link": "https://stackoverflow.com/questions/36683322/why-does-the-guarded-statements-not-run/36684161#36684161", "title": "Why does the guarded statements not run?", "body": "<p>The problem isn't the guard, it is that</p>\n\n<pre><code>removeMultipleElements remove@(y:ys) aList@(x:xs) \n</code></pre>\n\n<p>will only match when neither list is empty, so in your base case you have</p>\n\n<pre><code>removeMultipleElements [] aList\n</code></pre>\n\n<p>which matches only with the second definition and so becomes the empty list.  You should probably replace</p>\n\n<pre><code>removeMultipleElements _ _ = []\n</code></pre>\n\n<p>with something like</p>\n\n<pre><code>removeMultipleElements _ xs = xs\n</code></pre>\n"}], "owner": {"reputation": 29, "user_id": 2984839, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0d3057c5cbe3a3d70d2df9d1259c5d97?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin D", "link": "https://stackoverflow.com/users/2984839/kevin-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 36684161, "answer_count": 1, "score": 0, "last_activity_date": 1460943256, "creation_date": 1460935607, "last_edit_date": 1460936307, "question_id": 36683322, "link": "https://stackoverflow.com/questions/36683322/why-does-the-guarded-statements-not-run", "title": "Why does the guarded statements not run?", "body": "<p>Hello I'm in a programming languages class which we were just introduced to Haskell. So in the homework we had to create a function that can remove multiple instances of an element in a list. I had a previous function that can remove one element but my removeMultipleElements does not want to run the guarded statements and just go straight to the empty list. Any help is appreciated. I'm sure it is something syntactical but I'm not sure what.</p>\n\n<p>Here is the code </p>\n\n<pre><code>--This one works great    \nremoveElement x aList@(y:ys)\n        | y == x = rest\n        | otherwise = y : rest\n          where\n            rest = removeElement x ys \n    removeElement _ _ = []\n\n--this does not want to\nremoveMultipleElements remove@(y:ys) aList@(x:xs) \n        | elem y aList = removeMultipleElements ys (removeElement y aList)\n        | not (elem y aList) = removeMultipleElements ys aList\n        | otherwise = aList\nremoveMultipleElements _ _ = []\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "nested-lists"], "comments": [{"owner": {"reputation": 4798, "user_id": 460175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dUcwY.png?s=128&g=1", "display_name": "comonad", "link": "https://stackoverflow.com/users/460175/comonad"}, "edited": false, "score": 0, "creation_date": 1460936465, "post_id": 36683204, "comment_id": 60956420, "body": "Is this homework? To me, it seems like you are already guessing so much that you do not know what you are doing in the first place. What does head and tail mean to you? Do you even know what a list is? Or an Int? (You could replace the names Int and List with Foo and Bar, it would still work the same and would be less confusing.)"}, {"owner": {"reputation": 866, "user_id": 2491551, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/wgrbu.png?s=128&g=1", "display_name": "Xzenon", "link": "https://stackoverflow.com/users/2491551/xzenon"}, "edited": false, "score": 0, "creation_date": 1460936802, "post_id": 36683204, "comment_id": 60956479, "body": "I&#39;m not sure what exactly you mean by &quot;What does head and tail mean to you?&quot;, but I am looking to make something that works just like car and cdr in Racket, meaning return the first element or - for cdr - a list of everything but the first element."}, {"owner": {"reputation": 866, "user_id": 2491551, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/wgrbu.png?s=128&g=1", "display_name": "Xzenon", "link": "https://stackoverflow.com/users/2491551/xzenon"}, "reply_to_user": {"reputation": 4798, "user_id": 460175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dUcwY.png?s=128&g=1", "display_name": "comonad", "link": "https://stackoverflow.com/users/460175/comonad"}, "edited": false, "score": 0, "creation_date": 1460937138, "post_id": 36683204, "comment_id": 60956547, "body": "To add to my answer, @comonad, this is not homework and I am indeed guessing based on what I found on other SO posts, because I don&#39;t understand much from the available documentation - any Google search for &quot;nested list in haskell&quot; gives me 10 pages of flattening lists (which is what I tried to use as a base for the headList function and clearly did not work)."}, {"owner": {"reputation": 4798, "user_id": 460175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dUcwY.png?s=128&g=1", "display_name": "comonad", "link": "https://stackoverflow.com/users/460175/comonad"}, "edited": false, "score": 0, "creation_date": 1460938353, "post_id": 36683204, "comment_id": 60956772, "body": "haskell lists are like this: <code>data List a = Cons a (List a) | Nil</code> but written syntactically more cute: <code>data [] a = (:) a ([] a) | []</code> where <code>(:)</code> is cons and that rightmost <code>[]</code> is Nil. you did write the two names Int and List, which are not types but the constructor names you did define. so your <code>NestedList a</code> contains elements of type <code>a</code> instead of Int, and a <code>NestedList String</code> could be i.e. an <code>Int &quot;Hello&quot;</code> or an <code>List []</code> or <code>List [List [],Int &quot;&quot;]</code>. Your function headList returns not an element but a NestedList. The nested list you might want could probably be the type <code>[[a]]</code> instead"}, {"owner": {"reputation": 4798, "user_id": 460175, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dUcwY.png?s=128&g=1", "display_name": "comonad", "link": "https://stackoverflow.com/users/460175/comonad"}, "edited": false, "score": 1, "creation_date": 1460938903, "post_id": 36683204, "comment_id": 60956873, "body": "as a lisp programmer, you might be more interested in skimming the language spec than reading random SO questions. see the haskell language report about the list library: <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch20.html\" rel=\"nofollow noreferrer\">haskell.org/onlinereport/haskell2010/haskellch20.html</a> or hoogle: <a href=\"https://www.haskell.org/hoogle/?hoogle=head\" rel=\"nofollow noreferrer\">haskell.org/hoogle/?hoogle=head</a> or the library for lists: <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Data-List.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.8.2.0/docs/Data-List.html</a>"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1460939492, "post_id": 36683204, "comment_id": 60956965, "body": "It seems like you just want <code>headList (List (x:_)) = x</code>"}, {"owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "edited": false, "score": 2, "creation_date": 1460966402, "post_id": 36683204, "comment_id": 60965327, "body": "Don&#39;t make head/tail functions, though - they are partial. Use pattern matching or NestedList&#39;s variant of <code>uncons :: [a] -&gt; Maybe (a, [a])</code> instead."}], "answers": [{"comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1460968567, "post_id": 36688819, "comment_id": 60966614, "body": "Also, consider the case <code>N [N [], N []]</code> - is that an empty list as well?"}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 2, "last_activity_date": 1461017284, "last_edit_date": 1495542151, "creation_date": 1460967813, "answer_id": 36688819, "question_id": 36683204, "link": "https://stackoverflow.com/questions/36683204/obtain-head-and-tail-of-nested-list/36688819#36688819", "title": "Obtain head and tail of nested list", "body": "<p>A <code>NestedList</code> of <code>a</code>s is an atom of <code>a</code>, marked by <code>Int</code> (let's use <code>A</code> instead) or a nested list of <code>a</code>s (let's use <code>N</code> for that):</p>\n\n<pre><code>data NestedList a = A a | N [NestedList a]\n       deriving (Show, Eq)\n</code></pre>\n\n<p>So, what's an empty list? -- It's <code>N[ ]</code>. It has no head or tail.</p>\n\n<p>What's a singleton list? -- If it's either <code>A x</code> or <code>N[A x]</code>, its head is just <code>x</code>.</p>\n\n<p>What's a tail of a singleton list? -- It's an empty list. </p>\n\n<p>What's a tail of a longer list <code>N(h:t)</code>? -- If <code>h</code> is <code>A _</code>, it's <code>N t</code>.</p>\n\n<p>The other cases where you have  more nested structure are more involved. Do you want your <code>head</code> to return the left-most atom in such cases, and <code>tail</code> to construct a similarly-nested structure without the left-most element in it? This can be done recursively:</p>\n\n<pre><code>headNested (A x) = x\nheadNested (N xs) = headNested (head xs)\n</code></pre>\n\n<p>Right? Not that simple, as <a href=\"https://stackoverflow.com/users/1048572/bergi\">user Bergi</a> points out in the comments: what about the nested empty lists case, <code>N[ N[ ], N[ ]]</code>? Is it to be considered empty too? (probably, yes). So this will have to be more involved. Perhaps you'd want to decide on some kind of canonical structure, and implement a <code>normalize</code> routine, to be used first.</p>\n\n<p>Or better yet, keep the structure as is and instead follow <a href=\"https://stackoverflow.com/questions/36683204/obtain-head-and-tail-of-nested-list/36688819#comment60965327_36683204\">the other advice in the comments</a>, switch to returning the <code>Maybe</code> pair of head and tail, and use <em>that</em> recursively.</p>\n"}], "owner": {"reputation": 866, "user_id": 2491551, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/wgrbu.png?s=128&g=1", "display_name": "Xzenon", "link": "https://stackoverflow.com/users/2491551/xzenon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 842, "favorite_count": 0, "accepted_answer_id": 36688819, "answer_count": 1, "score": 3, "last_activity_date": 1461017284, "creation_date": 1460934506, "last_edit_date": 1460936993, "question_id": 36683204, "link": "https://stackoverflow.com/questions/36683204/obtain-head-and-tail-of-nested-list", "title": "Obtain head and tail of nested list", "body": "<p>I have a nested list type declared as such:</p>\n\n<pre><code>data NestedList a \n= Int a\n| List [NestedList a]\nderiving (Show, Eq)\n</code></pre>\n\n<p>I am trying to get the head and tail of a NestedList, but I'm not sure how it can be achieved. My attempt wasn't really successful, as it wil get the first Int in the NestedList. My code is:</p>\n\n<pre><code>headList :: NestedList a -&gt; NestedList a\nheadList (Int x) = Int x\nheadList (List x) = head $ map headList x\n</code></pre>\n\n<p>I understand why this doesn't work, because it iterates over all Lists and gets the Int from each one. So for example:</p>\n\n<pre><code>test = List [List [Int 5]] -&gt; headList test = Int 5, instead of List [Int 5]\n</code></pre>\n\n<p>I guess the solution for tail would be similar (except for the list instead of an element part), so can anyone help me get the <code>headList</code> working at least?</p>\n"}, {"tags": ["haskell", "syntax", "function-composition", "dollar-sign"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1460932268, "post_id": 36682882, "comment_id": 60955508, "body": "<code>let (&amp;) :: (a -&gt; b) -&gt; a -&gt; b; (&amp;) = ($); infixl 0 &amp;; min &amp; max 1 2 &amp; max 3 4</code>"}, {"owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "edited": false, "score": 1, "creation_date": 1460932358, "post_id": 36682882, "comment_id": 60955530, "body": "<code>(&amp;)</code> is usually used for <code>flip ($)</code>, and I&#39;d make the precedence 1, but the principle is nice."}, {"owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "edited": false, "score": 0, "creation_date": 1460932529, "post_id": 36682882, "comment_id": 60955560, "body": "How can you look up the definition of functions like <code>$</code> or <code>.</code> in <code>ghci</code>? Writing <code>:t $</code> will just give an input error."}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1460933156, "post_id": 36682882, "comment_id": 60955702, "body": "You use <code>:info $</code> in GHCi."}], "answers": [{"comments": [{"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1460933107, "post_id": 36682941, "comment_id": 60955687, "body": "While this is an elegant solution, it doesn&#39;t work in the general case. For example, this method can&#39;t be used when there is are more than two arguments. It can&#39;t be used when the function to be applied is not directly referenced either."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1460934155, "post_id": 36682941, "comment_id": 60955905, "body": "@AaditMShah right. However, in these cases, it is probably best to <i>use</i> parens, or named subexpressions in a <code>where</code> binding. For simple cases like this, the infix trick works great."}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1460937677, "post_id": 36682941, "comment_id": 60956654, "body": "@leftaroundabout In these cases, it&#39;s best to simply write <code>min (max 10 20) (max 30 40)</code>. Parentheses aren&#39;t bad. In fact, I&#39;ve been trying to avoid <code>$</code> as much as possible for the sake of consistency. It doesn&#39;t really help make things clearer. Any benefit of using infix <code>$</code> is, in my humble opinion, purely psychological. The only real use case for <code>$</code> is right sections (e.g. <code>map ($ 2) [odd, even]</code>)."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1460938323, "post_id": 36682941, "comment_id": 60956767, "body": "@AaditMShah: I wouldn&#39;t quite agree with <i>that</i>. Sure, there&#39;s no objective benefit if you use <code>$</code> to get rid of a single pair of parens, but it can make code tremendously more readable if you use it to reduce a quadruply-nested bracket construct to just a doubly-nested one. Though again, one should of course also consider local named variables in such a case."}], "tags": [], "owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "is_accepted": false, "score": 5, "last_activity_date": 1460932274, "creation_date": 1460932274, "answer_id": 36682941, "question_id": 36682882, "link": "https://stackoverflow.com/questions/36682882/chaining-two-parentheses-together-using-operator/36682941#36682941", "title": "Chaining two parentheses together using $ operator", "body": "<p>You're looking for</p>\n\n<pre><code>max 10 20 `min` max 30 40\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "is_accepted": true, "score": 5, "last_activity_date": 1460932763, "creation_date": 1460932763, "answer_id": 36683007, "question_id": 36682882, "link": "https://stackoverflow.com/questions/36682882/chaining-two-parentheses-together-using-operator/36683007#36683007", "title": "Chaining two parentheses together using $ operator", "body": "<p>It would be nice to be able to write:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>min $ max 10 20 $ max 30 40\n</code></pre>\n\n<p>However, this wouldn't work because <code>$</code> is right associative:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>Prelude&gt; :info $\n($) :: (a -&gt; b) -&gt; a -&gt; b   -- Defined in \u2018GHC.Base\u2019\ninfixr 0 $\n</code></pre>\n\n<p>Hence, the expression is disambiguated as:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>min ((max 10 20) max 30 40)\n</code></pre>\n\n<p>Indeed, it would make more sense for <code>$</code> to be left associative. However, we can't simply make <code>$</code> left associative because it might break existing code. Nevertheless, you could define a new operator:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>infixl 0 %\n\n(%) :: (a -&gt; b) -&gt; a -&gt; b\nf % x = f x\n\nmain = print (min % max 10 20 % max 30 40)\n</code></pre>\n\n<p>The <code>%</code> symbol is right next to the <code>$</code> symbol on a US keyboard.</p>\n"}], "owner": {"reputation": 4639, "user_id": 3986708, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/g0JCF.jpg?s=128&g=1", "display_name": "hgiesel", "link": "https://stackoverflow.com/users/3986708/hgiesel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 36683007, "answer_count": 2, "score": 3, "last_activity_date": 1460932763, "creation_date": 1460931827, "question_id": 36682882, "link": "https://stackoverflow.com/questions/36682882/chaining-two-parentheses-together-using-operator", "title": "Chaining two parentheses together using $ operator", "body": "<p>I have this function:</p>\n\n<pre><code>min (max 10 20) (max 30 40)\n</code></pre>\n\n<p>I can rewrite this as:</p>\n\n<pre><code>min (max 10 20) $ max 30 40\n</code></pre>\n\n<p>But is there also a way to resolve these last parentheses?</p>\n\n<p>Not as if this wasn't good enough, but I just can't let the thought go, that there must be some way to do this...</p>\n"}, {"tags": ["haskell", "binary-tree"], "answers": [{"comments": [{"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 3, "creation_date": 1460935010, "post_id": 36682921, "comment_id": 60956089, "body": "Word of warning: This is probably quite inefficient. I&#39;m not sure if there is a more efficient way or not."}], "tags": [], "owner": {"reputation": 14704, "user_id": 908515, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/f1L9v.png?s=128&g=1", "display_name": "undur_gongor", "link": "https://stackoverflow.com/users/908515/undur-gongor"}, "is_accepted": true, "score": 2, "last_activity_date": 1460932144, "creation_date": 1460932144, "answer_id": 36682921, "question_id": 36682805, "link": "https://stackoverflow.com/questions/36682805/haskell-binary-tree-with-values-only-in-leaves/36682921#36682921", "title": "Haskell binary tree with values only in leaves", "body": "<p>First, you need a function to see if two trees are equal. You can derive <code>Eq</code> or implement something recursively like this</p>\n\n<pre><code>eq :: Eq a =&gt; BinaryTree a -&gt; BinaryTree a -&gt; Bool\neq (Leaf x) (Leaf y) = x == y\neq (Node l1 r1) (Node l2 r2) = (l1 `eq` l2) &amp;&amp; (r1 `eq` r2)\neq _ _ = False\n</code></pre>\n\n<p>With that you can do</p>\n\n<pre><code>sub :: Eq a =&gt; BinaryTree a -&gt; BinaryTree a -&gt; Bool\nsub s (Leaf y) = s `eq` Leaf y\nsub s t@(Node l r) = s `eq` t || sub s l || sub s r\n</code></pre>\n\n<p>The first tree is a sub-tree of the second if both are equal or it is a sub-tree of the left or the right sub-tree.</p>\n"}], "owner": {"reputation": 349, "user_id": 5272264, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/98128613e53d179b233d139cc64f6e7f?s=128&d=identicon&r=PG&f=1", "display_name": "zaig", "link": "https://stackoverflow.com/users/5272264/zaig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 0, "accepted_answer_id": 36682921, "answer_count": 1, "score": 0, "last_activity_date": 1460932144, "creation_date": 1460931138, "question_id": 36682805, "link": "https://stackoverflow.com/questions/36682805/haskell-binary-tree-with-values-only-in-leaves", "title": "Haskell binary tree with values only in leaves", "body": "<p>I would like to create a data type which represents a binary tree which has the values stored only in the leaves, then a function <code>sub</code> to check if a tree is subtree of other tree.\nHere is my code, but I got no idea how to implement the function <code>sub</code>.</p>\n\n<pre><code>data BinaryTree a = Leaf a | Node (BinaryTree a) (BinaryTree a)  deriving Show\n\nmakeBinTree :: [a] -&gt; BinaryTree a\nmakeBinTree lst = head $ mrg leaves\nwhere\n  leaves = map (\\x -&gt; Leaf x) lst\n  mrg [] = []\n  mrg [x] = [x]\n  mrg (x:y:xs) = mrg ( (Node x y) : mrg xs)\n\nsub :: Eq a =&gt; BinaryTree a -&gt; BinaryTree a -&gt; Bool\n</code></pre>\n"}, {"tags": ["json", "haskell", "aeson", "lazy-io"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 4, "creation_date": 1460930238, "post_id": 36682345, "comment_id": 60955051, "body": "The idiomatic solution is to use <code>Data.ByteString.Builder</code> - and note that <code>aeson-pretty</code> provides a function <code>encodePrettyToTextBuilder :: ToJSON a =&gt; a -&gt; Builder</code> so you are pretty much good to go - appending to the end of a <code>Builder</code> is constant time. Alternatively you could sequence writes to the file instead of appending to the string (e.g. <code>withFile f $ \\h -&gt; hPutStr h (encodePretty ...) &gt;&gt; hPutStr h &quot;\\n&quot;</code>), but (in my opinion) this is not as idiomatic as using a builder (simply due to being impure)."}, {"owner": {"reputation": 5774, "user_id": 105137, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/253329f6f7506a5299db1cb608d8defd?s=128&d=identicon&r=PG", "display_name": "kostmo", "link": "https://stackoverflow.com/users/105137/kostmo"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1460937457, "post_id": 36682345, "comment_id": 60956601, "body": "Perfect, thank you.  I then used the implementation of <code>writeFile</code> from <code>Data.Text.Lazy.IO</code> instead of from <code>Data.ByteString.Lazy</code>."}], "owner": {"reputation": 5774, "user_id": 105137, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/253329f6f7506a5299db1cb608d8defd?s=128&d=identicon&r=PG", "display_name": "kostmo", "link": "https://stackoverflow.com/users/105137/kostmo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 183, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1460927825, "creation_date": 1460927825, "question_id": 36682345, "link": "https://stackoverflow.com/questions/36682345/efficiently-add-trailing-newline-to-json-bytestring-emitted-by-aeson-when-writin", "title": "Efficiently add trailing newline to JSON ByteString emitted by Aeson when writing to file", "body": "<p>By default, Aeson <code>encode</code> or <code>encodePretty</code> do not append a trailing newline to the <code>ByteString</code>.  I.e., when viewing the resulting file in vim I see the <code>[noeol]</code> indicator.</p>\n\n<p>What is a performant/idiomatic way to append a newline to the file?</p>\n\n<p>Here's an <a href=\"http://sscce.org/\" rel=\"nofollow\">SSCCE</a> for <code>Main.hs</code>:</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric #-}\n\nimport           Data.Aeson\nimport           Data.Aeson.Encode.Pretty\nimport           GHC.Generics\nimport qualified Data.ByteString.Lazy as L\nimport qualified Data.ByteString.Internal  as BS\n\ndata ExampleRecord =\n  ExampleRecord {\n       field1 :: String\n     , field2 :: String\n       } deriving (Show, Generic)\n\ninstance ToJSON ExampleRecord\n\nmain = L.writeFile \"foo.json\" $ encodePretty (ExampleRecord \"a\" \"b\")\n</code></pre>\n\n<p>with accompanying <code>myproj.cabal</code> file:</p>\n\n<pre><code>name:                myproj\nversion:             0.1.0.0\nbuild-type:          Simple\ncabal-version:       &gt;=1.10\n\nexecutable emit-json\n  main-is:             Main.hs\n  build-depends:\n      base &gt;=4.8 &amp;&amp; &lt;4.9\n    , aeson\n    , aeson-pretty\n    , bytestring\n  default-language:    Haskell2010\n</code></pre>\n\n<p>I am able to append a newline to <code>foo.json</code> by using the <a href=\"https://hackage.haskell.org/package/bytestring-0.10.4.0/docs/Data-ByteString-Lazy.html#v:snoc\" rel=\"nofollow\"><code>snoc</code> function from <code>ByteString</code></a>, changing the last line in <code>Main.hs</code> to this:</p>\n\n<pre><code>main = L.writeFile \"foo.json\" $ encodePretty (ExampleRecord \"a\" \"b\") `L.snoc` BS.c2w '\\n'\n</code></pre>\n\n<p>However, the <code>snoc</code> documentation describes this as an O(n) operation.  Should there be a way to append this newline in constant time?</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 2, "creation_date": 1460928540, "post_id": 36682315, "comment_id": 60954608, "body": "<code>ReaderT</code>s bind. You can look at the source to see what it does."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "reply_to_user": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1460928563, "post_id": 36682315, "comment_id": 60954618, "body": "From what you know it ?"}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 2, "creation_date": 1460928699, "post_id": 36682315, "comment_id": 60954652, "body": "it&#39;s the outermost constructor. The outermost constructor controls it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "reply_to_user": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1460929672, "post_id": 36682315, "comment_id": 60954901, "body": "Is it rule ? Can we something similar about result of run* ?"}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 1, "creation_date": 1460929753, "post_id": 36682315, "comment_id": 60954927, "body": "what is &quot;run*&quot;? It&#39;s because of the way <code>&gt;&gt;=</code> in defined. Most things are defined that way."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "reply_to_user": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1460929923, "post_id": 36682315, "comment_id": 60954967, "body": "Ok, I don&#39;t understan how to run such monad. Could you give more precisely answer, please ?"}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1460930091, "post_id": 36682315, "comment_id": 60955007, "body": "Something with an outer layer of ReaderT can be be &quot;run&quot; via <a href=\"https://hackage.haskell.org/package/mtl-2.2.1/docs/Control-Monad-Reader.html#v:runReaderT\" rel=\"nofollow noreferrer\">runReaderT</a>."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "edited": false, "score": 0, "creation_date": 1460936544, "post_id": 36682681, "comment_id": 60956433, "body": "so bind is chosen based on left argument of bind ?"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 2, "creation_date": 1460936662, "post_id": 36682681, "comment_id": 60956463, "body": "@HaskellFun Not quite. If the return type of the right argument, here called <code>f</code>, didn&#39;t use the same Monad instance as the left argument the compiler would give a compiler error. Also, if the monad instance of the left argument is left polymorphic but the right argument uses a specific monad, it will match based on the right argument&#39;s monad."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 2, "creation_date": 1460936684, "post_id": 36682681, "comment_id": 60956468, "body": "With <code>x &gt;&gt;= f</code>, the compiler tries to match both <code>m a</code> against the type of <code>x</code> <i>and</i> <code>(a -&gt; m b)</code> against the type of <code>f</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "edited": false, "score": 0, "creation_date": 1460937850, "post_id": 36682681, "comment_id": 60956687, "body": "hmm, assuming that none of cases that you mentioned above happened - then decision is based on left arguement ?"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 2, "creation_date": 1460938146, "post_id": 36682681, "comment_id": 60956737, "body": "@HaskellFun It&#39;s really always based on <i>both</i> argument types, neither of them is more important than the other. If <code>x :: Maybe Int</code> and <code>f :: Int -&gt; [Bool]</code>, then <code>x &gt;&gt;= f</code> won&#39;t type check even though both <code>Maybe</code> and <code>[]</code> are <code>Monad</code>s. The <code>m</code> can&#39;t unify to two different types."}], "tags": [], "owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "is_accepted": true, "score": 5, "last_activity_date": 1460930599, "last_edit_date": 1460930599, "creation_date": 1460930258, "answer_id": 36682681, "question_id": 36682315, "link": "https://stackoverflow.com/questions/36682315/what-bind-operator-will-be-used/36682681#36682681", "title": "What bind operator will be used?", "body": "<p>For reference, <code>(&gt;&gt;=)</code> has the type</p>\n\n<pre><code>(&gt;&gt;=) :: Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b\n</code></pre>\n\n<p>and also note that</p>\n\n<pre><code>ReaderT Integer (ErrorT String (StateT Integer Identity)) Integer\n</code></pre>\n\n<p>is the same as </p>\n\n<pre><code>(ReaderT Integer (ErrorT String (StateT Integer Identity))) Integer\n</code></pre>\n\n<p>because type application (like function application) is left associative in Haskell.</p>\n\n<p>So, given</p>\n\n<pre><code>x :: ReaderT Integer (ErrorT String (StateT Integer Identity)) Integer\n</code></pre>\n\n<p>and an <code>f</code> with the appropriate type, in the expression</p>\n\n<pre><code>x &gt;&gt;= f\n</code></pre>\n\n<p>the type checker will try to match the type of <code>x</code> with the left argument type of <code>(&gt;&gt;=)</code>. This means it will try to unify <code>ReaderT Integer (ErrorT String (StateT Integer Identity)) Integer</code> with <code>m a</code>. The only way that this unifies is by taking <code>a</code> to be <code>Integer</code> and <code>m</code> to be <code>ReaderT Integer (ErrorT String (StateT Integer Identity))</code>. So, using the <code>~</code> type equality notation, we end up with</p>\n\n<pre><code> m ~ (ReaderT Integer (ErrorT String (StateT Integer Identity)))\n a ~ Integer\n</code></pre>\n\n<p>As a result, it must use the <code>(ReaderT r n)</code> instance of <code>Monad</code>, where <code>r ~ Integer</code> and <code>n ~ ErrorT String (StateT Integer Identity)</code>.</p>\n\n<p>This is a result of how type unification works in Haskell in general, not just for <code>(&gt;&gt;=)</code>, so this general idea can be used for interpreting how the type checking of other polymorphic functions works.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 36682681, "answer_count": 1, "score": 0, "last_activity_date": 1460930599, "creation_date": 1460927669, "question_id": 36682315, "link": "https://stackoverflow.com/questions/36682315/what-bind-operator-will-be-used", "title": "What bind operator will be used?", "body": "<p>Look at this example:   </p>\n\n<pre><code>ReaderT Integer (ErrorT String (StateT Integer Identity)) Integer\n</code></pre>\n\n<p>What operator bind <code>(&gt;&gt;=)</code> will be used here ?<br>\nFor example, if we use <code>do</code> notation, then what bind operator will be chosen by compiler ?</p>\n"}, {"tags": ["haskell", "pointfree"], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 6158468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/446d1f3f8c1aa9d4a7b1d1adf5d02056?s=128&d=identicon&r=PG&f=1", "display_name": "G.G", "link": "https://stackoverflow.com/users/6158468/g-g"}, "edited": false, "score": 0, "creation_date": 1461012902, "post_id": 36682002, "comment_id": 60996114, "body": "Also can you explain me how does this works?  <code>emptyDL :: DList a</code>  <code>emptyDL = DL id</code>"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 27, "user_id": 6158468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/446d1f3f8c1aa9d4a7b1d1adf5d02056?s=128&d=identicon&r=PG&f=1", "display_name": "G.G", "link": "https://stackoverflow.com/users/6158468/g-g"}, "edited": false, "score": 0, "creation_date": 1461013199, "post_id": 36682002, "comment_id": 60996296, "body": "The empty difference list is that list-prepending funcion which, when passed the (empty) terminator list, will just give that same list as the result."}, {"owner": {"reputation": 27, "user_id": 6158468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/446d1f3f8c1aa9d4a7b1d1adf5d02056?s=128&d=identicon&r=PG&f=1", "display_name": "G.G", "link": "https://stackoverflow.com/users/6158468/g-g"}, "edited": false, "score": 0, "creation_date": 1461018271, "post_id": 36682002, "comment_id": 60998530, "body": "But if we look at the types, <code>DL :: ([a] -&gt; [a]) -&gt; DList a</code> and <code>id :: a -&gt; a</code>"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 27, "user_id": 6158468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/446d1f3f8c1aa9d4a7b1d1adf5d02056?s=128&d=identicon&r=PG&f=1", "display_name": "G.G", "link": "https://stackoverflow.com/users/6158468/g-g"}, "edited": false, "score": 0, "creation_date": 1461021793, "post_id": 36682002, "comment_id": 60999721, "body": "Note that these polymorphic signatures are shorthand for <i>universally-quantified types</i>, i.e. really it should be <code>DL :: \u2200a. ([a] -&gt; [a]) -&gt; DList a</code> and <code>id :: \u2200a. a -&gt; a</code>. Hence I might also write it as <code>id :: \u2200b. b -&gt; b</code>. And for any given type <code>A</code>, I can then substitute <code>b ~ [A]</code>. Got it?"}, {"owner": {"reputation": 27, "user_id": 6158468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/446d1f3f8c1aa9d4a7b1d1adf5d02056?s=128&d=identicon&r=PG&f=1", "display_name": "G.G", "link": "https://stackoverflow.com/users/6158468/g-g"}, "edited": false, "score": 0, "creation_date": 1461022984, "post_id": 36682002, "comment_id": 61000044, "body": "This is clear now. I wasn&#39;t aware I can substitute `a ~ [A]. Thanks for that."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 2, "last_activity_date": 1460925729, "creation_date": 1460925729, "answer_id": 36682002, "question_id": 36681801, "link": "https://stackoverflow.com/questions/36681801/haskell-difference-lists-and-point-free-function/36682002#36682002", "title": "Haskell difference lists and point free function", "body": "<p>The first step in seeing into a point-free definition of a function is to revert the &eta;-reduction:</p>\n\n<pre><code>dlToList = ($[]) . unDL\ndlToList dl = (($[]) . unDL) dl\n</code></pre>\n\n<p>Then you start applying to the composition-chain, right-to-left:</p>\n\n<pre><code>dlToList dl = ($[]) (unDL dl)\n</code></pre>\n\n<p>You could then unpack the operator section<sup>&dagger;</sup></p>\n\n<pre><code>dlToList dl = unDL dl $ []\n</code></pre>\n\n<p>However, keeping the <code>($[])</code> as it is actually makes sense, because this is the essential converter between difference lists and ordinary lists: it takes a <code>[a]-&gt;[a]</code>-prepender-function and applies it to the terminator <code>[]</code>, resulting in a concrete list.</p>\n\n<p><hr>\n<sup>&dagger;</sup><sub>\nWe could simplify that further:</p>\n\n<pre><code>dlToList dl = unDL dl []\n</code></pre>\n\n<p>which, incidentally, could be made point-free again in a shorter manner:</p>\n\n<pre><code>dlToList = (`unDL`[])\n</code></pre>\n\n<p></sub></p>\n"}], "owner": {"reputation": 27, "user_id": 6158468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/446d1f3f8c1aa9d4a7b1d1adf5d02056?s=128&d=identicon&r=PG&f=1", "display_name": "G.G", "link": "https://stackoverflow.com/users/6158468/g-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 36682002, "answer_count": 1, "score": 0, "last_activity_date": 1460925729, "creation_date": 1460924656, "last_edit_date": 1460925163, "question_id": 36681801, "link": "https://stackoverflow.com/questions/36681801/haskell-difference-lists-and-point-free-function", "title": "Haskell difference lists and point free function", "body": "<p>I was researching difference lists and found the <code>DList</code> type</p>\n\n<pre><code>newtype DList a = DL { unDL :: [a] -&gt; [a] }\n</code></pre>\n\n<p>and the function</p>\n\n<pre><code>dlToList :: DList a -&gt; [a]\ndlToList = ($[]) . unDL\n</code></pre>\n\n<p>I am wondering what is the non point free version of the function and what does <code>($[])</code> do?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 5097, "user_id": 5058871, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fe7ecb8d6a0171ca6462d59ab0663c25?s=128&d=identicon&r=PG", "display_name": "Dov Benyomin Sohacheski", "link": "https://stackoverflow.com/users/5058871/dov-benyomin-sohacheski"}, "edited": false, "score": 0, "creation_date": 1460921627, "post_id": 36681225, "comment_id": 60952283, "body": "Your question and example is not so clear"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460921633, "post_id": 36681225, "comment_id": 60952286, "body": "it&#39;s the kind-signature - a <code>*</code> stands for a type - so it tells you that <code>r</code> is a type, <code>m</code> is a type-constructor (like <code>Maybe</code> or <code>IO</code> - you give those a type and they return one) and <code>a</code> is a type - the result (which is <code>ReaderT r m a</code>) is a type again - it&#39;s just there to help you understand the parts involved ;)"}], "answers": [{"comments": [{"owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 0, "creation_date": 1460924739, "post_id": 36681419, "comment_id": 60953374, "body": "why <code>(* -&gt; *)</code> is monad?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "edited": false, "score": 2, "creation_date": 1460927258, "post_id": 36681419, "comment_id": 60954212, "body": "@Gilgamesz <code>* -&gt; *</code> is not a monad, but if you have any monad <code>m</code>, then <code>m</code> must have kind <code>* -&gt; *</code>. E.g. <code>m = Maybe</code>, or <code>m = IO</code>"}, {"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1460983168, "post_id": 36681419, "comment_id": 60976644, "body": "<code>(,)</code> is <code>* -&gt; * -&gt; *</code> no? I thought you could not think of <code>* -&gt; *</code> as <code>*</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1460983342, "post_id": 36681419, "comment_id": 60976762, "body": "@jd823592 Yes, but <code>(,) Char</code> is <code>* -&gt; *</code> (above there&#39;s an unfortunate automatically inserted line break...)"}, {"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1460983442, "post_id": 36681419, "comment_id": 60976843, "body": "@chi oh sorry I did not notice that."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1460922613, "creation_date": 1460922613, "answer_id": 36681419, "question_id": 36681225, "link": "https://stackoverflow.com/questions/36681225/reader-transformer-monad/36681419#36681419", "title": "Reader Transformer Monad", "body": "<p>It should actually be</p>\n\n<pre><code>ReaderT :: * -&gt; (* -&gt; *) -&gt; * -&gt; *\n</code></pre>\n\n<p>Loosely speaking, the type above is a the type of a function which takes an argument of type <code>*</code>, another of type <code>* -&gt; *</code>, another of type <code>*</code>, and produces a result of type <code>*</code>.\nThe type <code>*</code> is the \"type of all types\". E.g. <code>Int :: *</code>, <code>Char :: *</code>, etc.</p>\n\n<p>To avoid confusion, <code>*</code> is not really called \"a type\" but \"a kind\", to reflect that it works at an higher level. For instance, <code>'a'</code> has type <code>Char</code>, and <code>Char</code> has kind <code>*</code>.</p>\n\n<p>Finally, the kind <code>* -&gt; *</code> is the kind of unary type constructors, such as <code>Maybe</code>, <code>[]</code>, <code>IO</code>, <code>(,) Char</code>, <code>Either Bool</code>, etc. All of these take a type argument and return a type. The kind <code>* -&gt; *</code> is also the kind of any functor, applicative, or monad.</p>\n\n<p>So, if we have  type <code>r</code>, a type constructor <code>m</code> (typically, a monad), and a type <code>a</code>, we have:</p>\n\n<pre><code>r :: *\nm :: (* -&gt; *)\na :: *\nReaderT :: * -&gt; (* -&gt; *) -&gt; * -&gt; *\nReaderT r :: (* -&gt; *) -&gt; * -&gt; *\nReaderT r m :: * -&gt; *\nReaderT r m a :: *\n</code></pre>\n\n<p>Hence, when all three arguments are passed, the result <code>ReaderT r m a</code> is a type.</p>\n"}], "owner": {"reputation": 3815, "user_id": 5382150, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/GwGSL.png?s=128&g=1", "display_name": "Gilgamesz", "link": "https://stackoverflow.com/users/5382150/gilgamesz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 36681419, "answer_count": 1, "score": 0, "last_activity_date": 1460922613, "creation_date": 1460921562, "question_id": 36681225, "link": "https://stackoverflow.com/questions/36681225/reader-transformer-monad", "title": "Reader Transformer Monad", "body": "<pre><code>newtype ReaderT r m a :: * -&gt; (* -&gt; *) -&gt; * -&gt; *\n</code></pre>\n\n<p>I cannot understand how to understand above expression, especially \n<code>* -&gt; (* -&gt; *) -&gt; * -&gt; *</code></p>\n"}, {"tags": ["url", "haskell", "uri"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460920742, "post_id": 36681058, "comment_id": 60951926, "body": "can you encode them (replace it with <code>%7C</code>) ?"}, {"owner": {"reputation": 5734, "user_id": 394796, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aad9f3d17d0679d81841dc6d83a03ea3?s=128&d=identicon&r=PG", "display_name": "Cameron Martin", "link": "https://stackoverflow.com/users/394796/cameron-martin"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460920870, "post_id": 36681058, "comment_id": 60951980, "body": "I can yeah, and it correctly parses then. But fully url encoding the url results in <code>&quot;http%3A%2F%2Fsomething.com%2Ffoo%7Cbar&quot;</code>, which fails to parse too. So how do I choose which characters to url encode and which to not?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1460921559, "post_id": 36681058, "comment_id": 60952258, "body": "well I can only guess but usually you build up those from a base-url (&quot;<a href=\"http://something.com/\" rel=\"nofollow noreferrer\">something.com</a>&quot; I guess) - why do you both encode and then try to decode them (I guess you do the encoding in your front-end probably JS?)"}], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 3, "last_activity_date": 1460923379, "creation_date": 1460923379, "answer_id": 36681563, "question_id": 36681058, "link": "https://stackoverflow.com/questions/36681058/why-does-network-uri-parseuri-not-like-the-pipe-character/36681563#36681563", "title": "Why does Network.URI (parseURI) not like the pipe character?", "body": "<p>You need to use <code>escapeURIString</code> before parsing. <code>isUnescapedInURI</code> will tell you if the character is allowed unescaped in a URI component as mentioned in the <a href=\"https://hackage.haskell.org/package/network-uri-2.6.1.0/docs/Network-URI.html#v:isUnescapedInURI\" rel=\"nofollow\">documentation</a>.</p>\n\n<pre><code>\u03bb&gt; isUnescapedInURI '|'\nFalse\n</code></pre>\n\n<p>So, to properly encode and parse it:</p>\n\n<pre><code>\u03bb&gt; parseURI $ escapeURIString isUnescapedInURI \"http://something.com/foo|bar\"\nJust http://something.com/foo%7Cbar\n</code></pre>\n\n<p>In fact this specific corner case, is well explained in the Hackage docs.</p>\n"}], "owner": {"reputation": 5734, "user_id": 394796, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aad9f3d17d0679d81841dc6d83a03ea3?s=128&d=identicon&r=PG", "display_name": "Cameron Martin", "link": "https://stackoverflow.com/users/394796/cameron-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 36681563, "answer_count": 1, "score": 0, "last_activity_date": 1460923379, "creation_date": 1460920665, "last_edit_date": 1460920924, "question_id": 36681058, "link": "https://stackoverflow.com/questions/36681058/why-does-network-uri-parseuri-not-like-the-pipe-character", "title": "Why does Network.URI (parseURI) not like the pipe character?", "body": "<p>I'm using the <code>parseURI</code> function from the <a href=\"https://hackage.haskell.org/package/network-uri\" rel=\"nofollow\">network-uri package</a> to parse some urls. Some of these urls have a pipe character in and parsing fails for them. For example:</p>\n\n<pre><code>Network.URI&gt; parseURI \"http://something.com/foo|bar\"\nNothing\n</code></pre>\n\n<p>However, these urls are obtained from a real website and they load correctly in a web browser, so there must be some sort of correct way of dealing with them.</p>\n\n<p>Why does parsing fail on urls with a pipe character, and what can I do to make them correctly parse?</p>\n"}, {"tags": ["haskell", "types", "typeclass"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1460922108, "post_id": 36680830, "comment_id": 60952471, "body": "I am no expert, but I guess that as soon as a constraint involves no variables, GHC tries to produce a dictionary/proof for it. If that fails, a type error is generated. It would be interesting to see what would happen if e.g. <code>&#39;c&#39; &amp;&amp; True :: Bool ~ Char =&gt; Bool</code>, allowing the constraint to float around. Perhaps the fail-early method is more efficient or produces better errors (?)"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 3, "creation_date": 1460924297, "post_id": 36680830, "comment_id": 60953246, "body": "You could <code>EmptyCase</code> on a <a href=\"https://hackage.haskell.org/package/constraints-0.6/docs/Data-Constraint.html#g:2\" rel=\"nofollow noreferrer\"><code>Dict</code></a>."}], "answers": [{"tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": false, "score": 4, "last_activity_date": 1460945756, "last_edit_date": 1460945756, "creation_date": 1460926886, "answer_id": 36682185, "question_id": 36680830, "link": "https://stackoverflow.com/questions/36680830/how-can-i-use-contradictory-evidence/36682185#36682185", "title": "How can I use contradictory evidence?", "body": "<p>Such a constraint will cause a type error if it ever appears as a given constraint. In general, this applies to any constraint the typechecker deems impossible.</p>\n\n<p>Even writing a function </p>\n\n<pre><code>f :: ('True ~ 'False) =&gt; x\nf = undefined \n</code></pre>\n\n<p>does not typecheck, because the context of a function is a given constraint in the body of the function - and <code>'True ~ 'False</code> simply cannot appear as a given constraint.</p>\n\n<p>At best you could have e.g. </p>\n\n<pre><code>import Data.Type.Equality ((:~:)(..))\n\ntype family (==) (a :: k) (b :: k) :: Bool where \n  a == a = 'True \n  a == b = 'False \n\nf :: ((x == y) ~ 'False) =&gt; x :~: y -&gt; a\n-- f Refl = undefined -- Inaccessible code \nf = \\case{} \n</code></pre>\n\n<p>which again comes back to an <code>EmptyCase</code>, this time on the <code>:~:</code>. Note that </p>\n\n<pre><code>f :: ((x == y) ~ 'False, x ~ y) =&gt; a \n</code></pre>\n\n<p>also reduces to a trivially impossible constraint, because <code>x == x</code> reduces to <code>True</code>. You could write an equality predicate which doesn't reduce for trivially equal types (e.g. the one in <code>Data.Type.Equality</code>), which allows you to write:</p>\n\n<pre><code>import Data.Type.Equality \n\nf :: ((x == y) ~ 'False, x ~ y) =&gt; Proxy '(x,y) -&gt; a \nf = undefined \n</code></pre>\n\n<p>There may be a way to write this function without <code>undefined</code> but it is sort of moot anyways since this type is immediately reduced by GHC:</p>\n\n<blockquote>\n<pre><code>&gt;:t f\nf :: forall (k :: BOX) (y :: k) a. ((y == y) ~ 'False) =&gt; Proxy '(y, y) -&gt; a\n</code></pre>\n</blockquote>\n\n<p>Even without the constraint there, it is definitionally impossible to call the function <code>Proxy '(y,y) -&gt; a</code> with two different types. There is no way to hide an equality constraint <code>~</code> from the typechecker - you must use a different form of equality, one which does not reduce to <code>~</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1460932749, "post_id": 36682387, "comment_id": 60955615, "body": "While trying to build an answer myself I also noticed that bug. It&#39;s a nasty one! There&#39;s some good reading at that link."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 8, "last_activity_date": 1572318099, "last_edit_date": 1572318099, "creation_date": 1460928105, "answer_id": 36682387, "question_id": 36680830, "link": "https://stackoverflow.com/questions/36680830/how-can-i-use-contradictory-evidence/36682387#36682387", "title": "How can I use contradictory evidence?", "body": "<p>You can often do this by separating the exact nature of the evidence from the way you plan to use it. If the type checker <em>sees</em> that you've introduced an absurd constraint, it will bark at you. So the trick is to delay that equality behind <code>:~:</code>, and then to manipulate the equality evidence using generally reasonable functions.</p>\n\n<pre><code>{-# LANGUAGE GADTs, TypeOperators, ScopedTypeVariables, DataKinds,\n      PolyKinds, RankNTypes #-}\n{-# OPTIONS_GHC -Wall #-}\n\nmodule TrueFalse where\nimport Data.Type.Equality\n\ndata Foo (a :: Bool) where\n  Can :: Foo 'False\n  Can't :: (forall x . x) -&gt; Foo 'True\n\nextr :: Foo 'True -&gt; a\nextr (Can't x) = x\n\nsubst :: a :~: b -&gt; f a -&gt; f b\nsubst Refl x = x\n\nwhoop :: 'False :~: 'True -&gt; a\nwhoop pf = extr $ subst pf Can\n</code></pre>\n\n<p>The <code>whoop</code> function seems to be approximately what you're looking for.</p>\n\n<hr>\n\n<p>As Andr\u00e1s Kov\u00e1cs commented, you could even just use <code>EmptyCase</code> on the <code>'False :~: 'True</code> value. At present (7.10.3), unfortunately, <code>EmptyCase</code> <a href=\"https://ghc.haskell.org/trac/ghc/ticket/10746\" rel=\"nofollow noreferrer\">doesn't warn about non-exhaustive matches</a>. This will hopefully be fixed soon.</p>\n\n<p>Update 2019: that bug has been fixed.</p>\n"}], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 1, "accepted_answer_id": 36682387, "answer_count": 2, "score": 10, "last_activity_date": 1572318099, "creation_date": 1460919396, "last_edit_date": 1495542704, "question_id": 36680830, "link": "https://stackoverflow.com/questions/36680830/how-can-i-use-contradictory-evidence", "title": "How can I use contradictory evidence?", "body": "<p>While writing <a href=\"https://stackoverflow.com/a/36680559/791604\">about how to do subtyping in Haskell</a>, it occurred to me that it would be very convenient to be able to \"use\" contradictory evidence such as <code>True ~ False</code> to inform the compiler about dead branches. With another standard empty type, <code>Void</code>, the <code>EmptyCase</code> extension allows you to mark a dead branch (i.e. one that contains a value of type <code>Void</code>) this way:</p>\n\n<pre><code>use :: Void -&gt; a\nuse x = case x of\n</code></pre>\n\n<p>I'd like to do something similar for unsatisfiable <code>Constraint</code>s.</p>\n\n<p>Is there a term which can be given the type <code>True ~ False =&gt; a</code> but cannot be given the type <code>a</code>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1460914224, "post_id": 36678700, "comment_id": 60949439, "body": "<a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Control-Exception.html\" rel=\"nofollow noreferrer\">Control.Exception</a> has the SomeException type which seems to be what you are looking for..."}, {"owner": {"reputation": 1804, "user_id": 1260229, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a918b56d3f83f46ced68b33737396b87?s=128&d=identicon&r=PG", "display_name": "sn&#248;reven", "link": "https://stackoverflow.com/users/1260229/sn%c3%b8reven"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1460914530, "post_id": 36678700, "comment_id": 60949551, "body": "@Alec: Are you suggesting to make my error types instances of <code>Exception</code> class and use <code>SomeException</code>? (Because despite the name, <code>Except</code> has nothing to do with exceptions). Sounds like a solution that would work, I just can&#39;t really tell if that&#39;s a good one or not."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1460914725, "post_id": 36678700, "comment_id": 60949622, "body": "After more poking around, I&#39;m not sure that helps at all - the <code>Exception</code> class requires you to implement <code>displayException :: e -&gt; String</code>, which kind of defies the point."}, {"owner": {"reputation": 1804, "user_id": 1260229, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a918b56d3f83f46ced68b33737396b87?s=128&d=identicon&r=PG", "display_name": "sn&#248;reven", "link": "https://stackoverflow.com/users/1260229/sn%c3%b8reven"}, "reply_to_user": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1460914796, "post_id": 36678700, "comment_id": 60949646, "body": "@Alec: &quot;Default implementation: show.&quot;"}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1460915282, "post_id": 36678700, "comment_id": 60949822, "body": "Oh, missed that. Then yeah, you could simply derive <code>SomeException</code>, and now you can wrap your exception types in this. Alternately you could make your own <code>data Exception = forall e . Show e =&gt; Exception e</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1804, "user_id": 1260229, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a918b56d3f83f46ced68b33737396b87?s=128&d=identicon&r=PG", "display_name": "sn&#248;reven", "link": "https://stackoverflow.com/users/1260229/sn%c3%b8reven"}, "edited": false, "score": 0, "creation_date": 1460915483, "post_id": 36679928, "comment_id": 60949896, "body": "This is not exactly what I asked. I mentioned your approach: &quot;I could convert the error types for every fun* [...]&quot; - the problem is: this is a lot of boilerplate code when there are loads of calls with different error types."}], "tags": [], "owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "is_accepted": false, "score": 0, "last_activity_date": 1460915144, "last_edit_date": 1460915144, "creation_date": 1460914825, "answer_id": 36679928, "question_id": 36678700, "link": "https://stackoverflow.com/questions/36678700/compose-bind-excepts-with-varying-error-types-by-common-error-type-class/36679928#36679928", "title": "Compose/bind &quot;Except&quot;s with varying error types by common error type class", "body": "<p><code>withExceptT T.unpack . funB =&lt;&lt; funA s</code>. Your show is superfluous.</p>\n\n<p>Using <code>Control.Lens</code>:</p>\n\n<p><code>fun = void . _Left putStrLn . runExcept . (withExceptT T.unpack . funB &lt;=&lt; funA)</code></p>\n"}, {"comments": [{"owner": {"reputation": 1804, "user_id": 1260229, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a918b56d3f83f46ced68b33737396b87?s=128&d=identicon&r=PG", "display_name": "sn&#248;reven", "link": "https://stackoverflow.com/users/1260229/sn%c3%b8reven"}, "edited": false, "score": 0, "creation_date": 1460920831, "post_id": 36680232, "comment_id": 60951964, "body": "Will go through that in detail tomorrow, but from what I could see so far it would be better to write my own error/exception existential type (with Show constraint). Making the errors an instance of <code>Control.Exception</code> would be misleading because they are not supposed to be thrown, just returned. Additionally it would reduce the number of instance declarations and - if I&#39;m not mistaken - this approach would work immediately with any <code>Show e =&gt; Except e</code>."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "reply_to_user": {"reputation": 1804, "user_id": 1260229, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a918b56d3f83f46ced68b33737396b87?s=128&d=identicon&r=PG", "display_name": "sn&#248;reven", "link": "https://stackoverflow.com/users/1260229/sn%c3%b8reven"}, "edited": false, "score": 1, "creation_date": 1460921020, "post_id": 36680232, "comment_id": 60952036, "body": "If you are sure you won&#39;t throw exceptions, that is indeed probably the better approach."}], "tags": [], "owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "is_accepted": true, "score": 1, "last_activity_date": 1460918611, "last_edit_date": 1460918611, "creation_date": 1460916472, "answer_id": 36680232, "question_id": 36678700, "link": "https://stackoverflow.com/questions/36678700/compose-bind-excepts-with-varying-error-types-by-common-error-type-class/36680232#36680232", "title": "Compose/bind &quot;Except&quot;s with varying error types by common error type class", "body": "<p>The simplest way would be to create a new <code>Exception</code> type (but this does require <code>-XExistentialQuantification</code>) of exceptions that can be shown.</p>\n\n<pre><code>data Exception = forall e . Show e =&gt; Exception e\n</code></pre>\n\n<p>Then, all that needs to be changed to make your code compile is the type signatures.</p>\n\n<pre><code>funA :: String -&gt; Except Exception String\nfunB :: String -&gt; Except Exception T.Text\n</code></pre>\n\n<p>Additionally, whenever you create an exception (of which there are no examples in your code above) you now need to wrap it in the <code>Exception</code> constructor.</p>\n\n<pre><code>throwsA :: String -&gt; Except Exception String\nthrowsA = throwE . Exception\n\nthrowsB :: T.Text -&gt; Except Exception T.Text\nthrowsB = throwE . Exception\n</code></pre>\n\n<p><strong>EDIT</strong> I would encourage you to make new types for your exceptions (with appropriate <code>Show</code>) then derive <code>Exception</code> from <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Control-Exception.html\" rel=\"nofollow\">Control.Exception</a>. That is more overhead, but it may benefit you afterwards if you ever need to switch back and forth between heterogeneous exception types. This is the way I would do it.</p>\n\n<pre><code>{-# LANGUAGE DeriveDataTypeable #-}\nmodule Main where\n\nimport Data.Typeable\nimport Control.Exception\nimport Control.Monad.Trans.Except\nimport qualified Data.Text as T\nimport Control.Monad\n\nnewtype StrError = StrError String deriving (Show,Typeable)\nnewtype TxtError = TxtError T.Text deriving (Show,Typeable)\n\ninstance Exception StrError\ninstance Exception TxtError\n\ntoErr :: Exception e =&gt; Except e a -&gt; Except SomeException a\ntoErr = mapExcept (either (Left . toException) Right)\n\n\nfunA :: String -&gt; Except StrError String\nfunA = return\n\nfunB :: String -&gt; Except TxtError T.Text\nfunB = return . T.pack\n\nthrowsA :: String -&gt; Except StrError String\nthrowsA = throwE . StrError\n\nthrowsB :: T.Text -&gt; Except TxtError T.Text\nthrowsB = throwE . TxtError\n\n\nfun :: String -&gt; IO ()\nfun s = case runExcept $ (toErr . funA &gt;=&gt; toErr . funB) s of\n            Left e  -&gt; putStrLn $ displayException e\n            Right _ -&gt; return ()\n\nmain :: IO ()\nmain = fun \"foo\"\n</code></pre>\n"}], "owner": {"reputation": 1804, "user_id": 1260229, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a918b56d3f83f46ced68b33737396b87?s=128&d=identicon&r=PG", "display_name": "sn&#248;reven", "link": "https://stackoverflow.com/users/1260229/sn%c3%b8reven"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 36680232, "answer_count": 2, "score": 3, "last_activity_date": 1460918611, "creation_date": 1460908158, "last_edit_date": 1460908677, "question_id": 36678700, "link": "https://stackoverflow.com/questions/36678700/compose-bind-excepts-with-varying-error-types-by-common-error-type-class", "title": "Compose/bind &quot;Except&quot;s with varying error types by common error type class", "body": "<p>I have some functions returning <code>Except</code> types (from <a href=\"http://haddock.stackage.org/lts-5.12/transformers-0.4.2.0/Control-Monad-Trans-Except.html\" rel=\"nofollow\">transformers</a> package) with varying error types but all implementing the class <code>Show</code>. In case of an error I just want to print the message.</p>\n\n<p>What's the best way to compose/bind them?</p>\n\n<p>I could convert the error types for every <code>fun*</code> before <code>(=&lt;&lt;)</code>, or write a <code>(=&lt;&lt;)</code> wrapper that takes all showable types and converts them to <code>String</code>s (<code>RankNTypes</code>?), but that feels ugly. Is there a better way, using the type system, that handles all that automatically?</p>\n\n<p>Example code:</p>\n\n<pre><code>module Main where\n\nimport           Control.Monad.Trans.Except\nimport qualified Data.Text as T\n\ntype StrError = String\ntype TxtError = T.Text\n\nfunA :: String -&gt; Except StrError String\nfunA = return\n\nfunB :: String -&gt; Except TxtError T.Text\nfunB = return . T.pack\n\nfun :: String -&gt; IO ()\nfun s = case runExcept (funB =&lt;&lt; funA s) of\n            Left e  -&gt; putStrLn $ show e\n            Right _ -&gt; return ()\n\nmain :: IO ()\nmain = fun \"foo\"\n</code></pre>\n"}, {"tags": ["haskell", "ssl", "https", "haskell-warp"], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 6207699, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb172b885ff17a03b2969a9339d4a0a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jushiti", "link": "https://stackoverflow.com/users/6207699/jushiti"}, "edited": false, "score": 0, "creation_date": 1460894034, "post_id": 36676039, "comment_id": 60942383, "body": "you know everything!"}, {"owner": {"reputation": 145, "user_id": 6207699, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb172b885ff17a03b2969a9339d4a0a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jushiti", "link": "https://stackoverflow.com/users/6207699/jushiti"}, "edited": false, "score": 0, "creation_date": 1460894099, "post_id": 36676039, "comment_id": 60942401, "body": "but at warp-tls it says &quot;Support for SSL is now obsoleted. &quot; and SSL is what I need."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 145, "user_id": 6207699, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb172b885ff17a03b2969a9339d4a0a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jushiti", "link": "https://stackoverflow.com/users/6207699/jushiti"}, "edited": false, "score": 0, "creation_date": 1460894120, "post_id": 36676039, "comment_id": 60942408, "body": "I can assure you I know very little (beside how to enter queries into Hayoo ;))"}, {"owner": {"reputation": 145, "user_id": 6207699, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb172b885ff17a03b2969a9339d4a0a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jushiti", "link": "https://stackoverflow.com/users/6207699/jushiti"}, "edited": false, "score": 0, "creation_date": 1460894237, "post_id": 36676039, "comment_id": 60942449, "body": "I&#39;ve never heard of Hayoo before, that&#39;s not me."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 145, "user_id": 6207699, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb172b885ff17a03b2969a9339d4a0a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jushiti", "link": "https://stackoverflow.com/users/6207699/jushiti"}, "edited": false, "score": 0, "creation_date": 1460894322, "post_id": 36676039, "comment_id": 60942470, "body": "well maybe they moved it somewhere else but it should still work"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 145, "user_id": 6207699, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb172b885ff17a03b2969a9339d4a0a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jushiti", "link": "https://stackoverflow.com/users/6207699/jushiti"}, "edited": false, "score": 0, "creation_date": 1460894350, "post_id": 36676039, "comment_id": 60942475, "body": "it&#39;s like Hoogle but searches more packages by default"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 145, "user_id": 6207699, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb172b885ff17a03b2969a9339d4a0a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jushiti", "link": "https://stackoverflow.com/users/6207699/jushiti"}, "edited": false, "score": 1, "creation_date": 1460894909, "post_id": 36676039, "comment_id": 60942633, "body": "I looked around a bit and I think the comment in the package is a bit misleading: <a href=\"http://www.yesodweb.com/blog/2015/07/http2\" rel=\"nofollow noreferrer\">yesodweb.com/blog/2015/07/http2</a> (if I get it correctly it means that current browsers will establish TLS over the headers so you probably don&#39;t need the open 443 port anymore and can use 80(?) - as I said: I am no expert on this)"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 11, "last_activity_date": 1460893427, "creation_date": 1460893427, "answer_id": 36676039, "question_id": 36675791, "link": "https://stackoverflow.com/questions/36675791/haskell-warp-wai-and-https-how-to-make-them-work/36676039#36676039", "title": "Haskell Warp/Wai and HTTPS -- how to make them work?", "body": "<p>I guess the easiest way is using the <a href=\"https://hackage.haskell.org/package/warp-tls\">warp-tls</a> library - settup your certificate files in the <code>TLSSettings</code> (I would try <a href=\"https://hackage.haskell.org/package/warp-tls-3.2.0/docs/Network-Wai-Handler-WarpTLS.html#v:tlsSettings\"><code>tlsSettings</code></a> first) and use <a href=\"https://hackage.haskell.org/package/warp-tls-3.2.0/docs/Network-Wai-Handler-WarpTLS.html#v:runTLS\"><code>runTLS</code></a> instead of <code>run</code>:</p>\n\n<pre><code>serveApp :: IO ()\nserveApp = do\n   let tls = tlsSettings \"pathToCert\" \"pathToKey\"\n   runTLS tls (setPort 443 defaultSettings) app\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 6207699, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb172b885ff17a03b2969a9339d4a0a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jushiti", "link": "https://stackoverflow.com/users/6207699/jushiti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1281, "favorite_count": 2, "accepted_answer_id": 36676039, "answer_count": 1, "score": 10, "last_activity_date": 1516542728, "creation_date": 1460891863, "question_id": 36675791, "link": "https://stackoverflow.com/questions/36675791/haskell-warp-wai-and-https-how-to-make-them-work", "title": "Haskell Warp/Wai and HTTPS -- how to make them work?", "body": "<p>I have a basic hello-world application in Haskell Servant and Warp. This is not real code but for the sake of simplicity let's say I'm using it:</p>\n\n<pre><code>import Network.Wai\nimport Network.Wai.Handler.Warp\nimport Servant\n\n\npersonAPI :: Proxy PersonAPI\npersonAPI = Proxy\n\nserver :: Server PersonAPI\nserver = return people\n\napp :: Application\napp = serve personAPI server\n\nserveApp :: IO ()\nserveApp = run 80 app\n</code></pre>\n\n<p>It works fine on a server. With http. </p>\n\n<p>I'm not using nginx or apache, I run it as-is and at this point it's fine for me.</p>\n\n<p>But with https it won't load the page. I've installed https certificate but I gathered that I should somehow setup warp/wai to use it, because by default it won't use it. There's shortage of information about this - warp/wai and SSL, I haven't found anything. Could anyone help me? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1460885746, "post_id": 36673631, "comment_id": 60940001, "body": "Possible duplicate: <a href=\"https://stackoverflow.com/questions/631284/dot-operator-in-haskell-need-more-explanation\" title=\"dot operator in haskell need more explanation\">stackoverflow.com/questions/631284/&hellip;</a> , <a href=\"https://stackoverflow.com/questions/2486564/what-does-a-fullstop-or-period-or-dot-mean-in-haskell\" title=\"what does a fullstop or period or dot mean in haskell\">stackoverflow.com/questions/2486564/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 6207699, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb172b885ff17a03b2969a9339d4a0a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jushiti", "link": "https://stackoverflow.com/users/6207699/jushiti"}, "edited": false, "score": 0, "creation_date": 1460877535, "post_id": 36673683, "comment_id": 60938047, "body": "list is a Monad, isn&#39;t it?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 145, "user_id": 6207699, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb172b885ff17a03b2969a9339d4a0a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jushiti", "link": "https://stackoverflow.com/users/6207699/jushiti"}, "edited": false, "score": 1, "creation_date": 1460879512, "post_id": 36673683, "comment_id": 60938522, "body": "yes it is - but the one that matters here is the <code>IO</code> monad - do make list the one that matters you would need a action of type <code>a -&gt; [b]</code> - try and play with <code>mapM (\\x -&gt; [x,x]) (Just 5)</code> do see the difference with a different <code>Foldable</code> (<code>Maybe</code> in this case) as well"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1460895185, "post_id": 36673683, "comment_id": 60942715, "body": "To get a better feel for how list as a monad works, try <code>mapM (\\x -&gt; [x, -x]) [1,2,3]</code>, compared to <code>map (\\x -&gt; [x,-x]) [1,2,3]</code>. (IMO, the example mapping over a <code>Maybe</code> hides the nondeterministic interpretation of the list monad that <code>mapM</code> allows.)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1460895242, "post_id": 36673683, "comment_id": 60942741, "body": "@chepner yes - but so you can mistake the monad and the foldable again ;)"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1460895621, "post_id": 36673683, "comment_id": 60942856, "body": "We need a bigger, non-list traversable, like a tree :)"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 4, "last_activity_date": 1460879802, "last_edit_date": 1460879802, "creation_date": 1460877001, "answer_id": 36673683, "question_id": 36673631, "link": "https://stackoverflow.com/questions/36673631/trying-to-understand-the-dot-operator/36673683#36673683", "title": "Trying to understand the dot operator", "body": "<p>it's just composition - it does one after the other (from the right) - so</p>\n\n<pre><code>(putStr . showInterface) n\n</code></pre>\n\n<p>is just</p>\n\n<pre><code>putStr (showInterface n)\n</code></pre>\n\n<p>so in a sense <code>showInterface</code> is <em>called first</em></p>\n\n<hr>\n\n<p>please note that your understanding is a bit flawed here - <code>ns</code> is not the monad here that matters (it's a list - it's the <code>Foldable</code> part in the newer versions of <code>mapM_</code>) - the monad that matters is <code>IO</code> and <code>mapM_</code> accepts a monadic action and a list of things to put into that action (one by one) - so here every item in <code>ns</code> is put into the action</p>\n\n<pre><code>putStr . showInterface\n</code></pre>\n\n<p>and of course each one will first be used int the <em>pure</em> function <code>showInterface</code> (which obviously produces a string) and then be printed to <code>stdout</code> using <code>putStr</code> (<strong>this</strong> is the monadic action that <em>needs</em> the <code>mapM_</code>)</p>\n\n<hr>\n\n<h2>if in <em>doubt</em> check the signature</h2>\n\n<p>If you want to find out which part <em>matters</em> look at the signature</p>\n\n<p>In case of <code>mapM_</code> it's:</p>\n\n<pre><code>mapM_ :: (Monad m, Foldable t) =&gt; (a -&gt; m b) -&gt; t a -&gt; m ()\n</code></pre>\n\n<p>forget the <code>Foldable t</code> here - it's your list:</p>\n\n<pre><code>mapM_ :: Monad m =&gt; (a -&gt; m b) -&gt; [a] -&gt; m ()\n</code></pre>\n\n<p>now what can the <code>m</code> be?</p>\n\n<p>Well you use <code>putStr . showInterface</code> for the first argument - now I don't know exactly what <code>showInterface</code> is - but as you compose it with <code>putStr</code> the resulting type should be something like</p>\n\n<pre><code>putStr . showInterface :: SomeInterfaceType -&gt; IO ()\n</code></pre>\n\n<p>and now you should see that: <code>m ~ IO</code>, <code>a ~ SomeInterfaceType</code> and <code>b ~ ()</code> - notice that the <strong>monad</strong> is <code>IO</code>! - and you get:</p>\n\n<pre><code>mapM_ (putStr . showInterface) :: [SomeInterfaceType] -&gt; IO ()\n</code></pre>\n"}], "owner": {"reputation": 145, "user_id": 6207699, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb172b885ff17a03b2969a9339d4a0a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jushiti", "link": "https://stackoverflow.com/users/6207699/jushiti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "closed_date": 1460914878, "accepted_answer_id": 36673683, "answer_count": 1, "score": 0, "last_activity_date": 1460879802, "creation_date": 1460876562, "question_id": 36673631, "link": "https://stackoverflow.com/questions/36673631/trying-to-understand-the-dot-operator", "closed_reason": "Duplicate", "title": "Trying to understand the dot operator", "body": "<p>I'm trying to understand how the dot operator works. Here's an example:</p>\n\n<pre><code>main = do\n    ns &lt;- getNetworkInterfaces\n    mapM_ (putStr . showInterface) ns\n</code></pre>\n\n<p>I know that <code>mapM_</code> accepts a function and <code>Monad</code>. \"ns\" is a <code>Monad</code>. But how actually the part <code>(putStr . showInterface)</code> works in terms of Haskell grammar or syntax in this particular example? Once again: in this particular example. Also, which function will be called first: putStr or showInterface?</p>\n"}, {"tags": ["json", "haskell"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1460873015, "post_id": 36673145, "comment_id": 60937101, "body": "That&#39;s not a valid <code>data</code> type. Did you miss some <code>|</code>?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1460903472, "post_id": 36673145, "comment_id": 60945490, "body": "You ask about ToJSON then show FromJSON... are you wanting both?"}], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 2, "last_activity_date": 1460873525, "creation_date": 1460873525, "answer_id": 36673272, "question_id": 36673145, "link": "https://stackoverflow.com/questions/36673145/how-to-properly-implement-fromjson-for-my-data-type/36673272#36673272", "title": "How to properly implement FromJSON for my data type?", "body": "<p>Aeson's <code>Parser</code> is an instance of <a href=\"https://hackage.haskell.org/package/base-4.8.2.0/docs/Control-Applicative.html#t:Alternative\" rel=\"nofollow\"><code>Alternative</code></a>. As such, you can provide multiple parsers and combine them with <code>(&lt;|&gt;)</code>:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\nimport Control.Applicative ((&lt;|&gt;))\nimport Data.Aeson\n\n-- Removed record fields to keep things short, but you can put them back.\ndata MyData = A1 Int String\n            | A2 Int String Char\n            | A3 Int Char   String String\n            deriving Show\n\ninstance FromJSON MyData where\n  parseJSON (Object v) =  A3 &lt;$&gt; v .: \"var1\" &lt;*&gt; v .: \"var2\" &lt;*&gt; v .: \"var3\" &lt;*&gt; v .: \"var4\" \n                      &lt;|&gt; A2 &lt;$&gt; v .: \"var1\" &lt;*&gt; v .: \"var2\" &lt;*&gt; v .: \"var3\"\n                      &lt;|&gt; A1 &lt;$&gt; v .: \"var1\" &lt;*&gt; v .: \"var2\"\n</code></pre>\n\n<p>Note that the order of parsers is important, since <code>v .: \"var1\"</code> and <code>v .: \"var2\"</code> succeed for all three parsers.</p>\n"}], "owner": {"reputation": 145, "user_id": 6207699, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cb172b885ff17a03b2969a9339d4a0a5?s=128&d=identicon&r=PG&f=1", "display_name": "Jushiti", "link": "https://stackoverflow.com/users/6207699/jushiti"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1460873525, "creation_date": 1460872320, "question_id": 36673145, "link": "https://stackoverflow.com/questions/36673145/how-to-properly-implement-fromjson-for-my-data-type", "title": "How to properly implement FromJSON for my data type?", "body": "<p>I have a data with a few constructors:</p>\n\n<pre><code>data MyData = \n  A1 { var1 :: Int, var2 :: String }\n  A2 { var1 :: Int, var2 :: String, var3 :: Char }\n  A3 { var1 :: Int, var2 :: Char, var3 :: String, var4 :: String }\n</code></pre>\n\n<p>This is a simplified version of my real \"data\".  Without using <code>deriving (Generic)</code>, how can I implement it for the class <code>ToJSON</code>?</p>\n\n<pre><code>instance FromJSON MyData where\n  parseJSON (Object v) = do\n    .. --- how do I know if v is created by A1 or A2 or A3?\n</code></pre>\n"}, {"tags": ["json", "haskell", "aeson", "lazy-io"], "comments": [{"owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "edited": false, "score": 2, "creation_date": 1460865861, "post_id": 36672472, "comment_id": 60936022, "body": "Could you please post the part of your source code which causes the error? I can&#39;t see where the strict bytestring comes from, <code>encodePretty</code> returns lazy bytestring and <code>writeFile</code> from <code>Data.ByteString.Lazy</code> expects lazy bytestring as well."}, {"owner": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "edited": false, "score": 2, "creation_date": 1460888883, "post_id": 36672472, "comment_id": 60940860, "body": "Could it be that you&#39;re importing the <code>writeFile</code> from the strict bytestring module <code>Data.ByteString</code>? Make sure you&#39;re definitely using the lazy one you linked to."}, {"owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 0, "creation_date": 1460919229, "post_id": 36672472, "comment_id": 60951315, "body": "that not enough? <a href=\"https://hackage.haskell.org/package/bytestring-0.10.6.0/docs/Data-ByteString-Lazy.html#v:hPut\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/bytestring-0.10.6.0/docs/&hellip;</a>"}, {"owner": {"reputation": 5774, "user_id": 105137, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/253329f6f7506a5299db1cb608d8defd?s=128&d=identicon&r=PG", "display_name": "kostmo", "link": "https://stackoverflow.com/users/105137/kostmo"}, "reply_to_user": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "edited": false, "score": 0, "creation_date": 1460926306, "post_id": 36672472, "comment_id": 60953917, "body": "@WillSewell you are correct.  D&#39;oh."}], "owner": {"reputation": 5774, "user_id": 105137, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/253329f6f7506a5299db1cb608d8defd?s=128&d=identicon&r=PG", "display_name": "kostmo", "link": "https://stackoverflow.com/users/105137/kostmo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 356, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1460864985, "creation_date": 1460864985, "question_id": 36672472, "link": "https://stackoverflow.com/questions/36672472/write-json-to-file-as-lazy-bytestring-directly-from-aeson-encode-output-without", "title": "write JSON to file as lazy ByteString directly from Aeson encode output without converting to String", "body": "<p>Currently, I'm using something like this to write JSON content (<code>my_json</code>) to a file (<code>my_output_filepath</code>):</p>\n\n<pre><code>import           Data.Aeson.Encode.Pretty\nimport qualified Data.ByteString.Lazy.UTF8 as U\n\nwriteFile my_output_filepath $ U.toString $ encodePretty my_json\n</code></pre>\n\n<p>This works, but I'm wondering whether it is necessary to convert the <code>ByteString</code> that is returned by (<code>encodePretty</code>) to a <code>String</code> before writing it to a file, or if it incurs a performance penalty.</p>\n\n<p>I see <a href=\"https://hackage.haskell.org/package/bytestring-0.10.6.0/docs/Data-ByteString-Lazy.html#v:writeFile\" rel=\"nofollow\">there is a variant</a> of <code>writeFile</code> that accepts a <code>ByteString</code> as input.  However, when I try to use it, I get this error:</p>\n\n<pre><code>Couldn't match expected type \u2018B.ByteString\u2019\n            with actual type \u2018U.ByteString\u2019\nNB: \u2018B.ByteString\u2019 is defined in \u2018Data.ByteString.Internal\u2019\n    \u2018U.ByteString\u2019 is defined in \u2018Data.ByteString.Lazy.Internal\u2019\n</code></pre>\n\n<p>Is there some way to get the <code>Lazy</code> variant of <code>ByteString</code> to interoperate with <code>writeFile</code>?</p>\n"}, {"tags": ["haskell", "functional-programming", "ocaml"], "comments": [{"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 2, "creation_date": 1460866920, "post_id": 36672346, "comment_id": 60936161, "body": "It&#39;s not clear if you realize Haskell won&#39;t let you do this."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1460869740, "post_id": 36672346, "comment_id": 60936585, "body": "Agreed.  I&#39;m tempted to close as off topic since the answer is &quot;no&quot; and subjectively &quot;yes&quot; to the two questions."}, {"owner": {"reputation": 1676, "user_id": 249669, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/1dfb6b94a31ec3d874dbc7c3f82c5cf9?s=128&d=identicon&r=PG", "display_name": "neuron", "link": "https://stackoverflow.com/users/249669/neuron"}, "reply_to_user": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 0, "creation_date": 1460875072, "post_id": 36672346, "comment_id": 60937502, "body": "@LouisWasserman Please see my edit."}, {"owner": {"reputation": 1676, "user_id": 249669, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/1dfb6b94a31ec3d874dbc7c3f82c5cf9?s=128&d=identicon&r=PG", "display_name": "neuron", "link": "https://stackoverflow.com/users/249669/neuron"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1460875308, "post_id": 36672346, "comment_id": 60937544, "body": "@ThomasM.DuBuisson When you say the answer is no, do you mean no one has ever attempted something similar? If that is the case, is there any reason as to why this approach is nonsensical?"}, {"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 2, "creation_date": 1460886124, "post_id": 36672346, "comment_id": 60940104, "body": "I assume you already know about Generalized algebraic datatypes (GADTs)?"}, {"owner": {"reputation": 1676, "user_id": 249669, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/1dfb6b94a31ec3d874dbc7c3f82c5cf9?s=128&d=identicon&r=PG", "display_name": "neuron", "link": "https://stackoverflow.com/users/249669/neuron"}, "reply_to_user": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 0, "creation_date": 1460888743, "post_id": 36672346, "comment_id": 60940824, "body": "@mb21 I&#39;ve heard of them and I think they kinda make sense. But I&#39;m not sure how to encode a subtype hierarchy using GADTs. If you think it is doable, would you mind providing an answer with an example as to how the type hierarchy given in my example may be encoded? Thanks a lot!"}, {"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 0, "creation_date": 1460891605, "post_id": 36672346, "comment_id": 60941692, "body": "@neuron, I don&#39;t quite follow what kind of subtyping you want... but have a look at <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/data-type-extensions.html#gadt\" rel=\"nofollow noreferrer\">what you can do with GADTs</a>..."}, {"owner": {"reputation": 19369, "user_id": 4609915, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/4fcZU.png?s=128&g=1", "display_name": "repeat", "link": "https://stackoverflow.com/users/4609915/repeat"}, "reply_to_user": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 0, "creation_date": 1599724511, "post_id": 36672346, "comment_id": 112863542, "body": "@mb21 The link in your comment has become broken. Do you have a new one? Thank you."}, {"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "reply_to_user": {"reputation": 19369, "user_id": 4609915, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/4fcZU.png?s=128&g=1", "display_name": "repeat", "link": "https://stackoverflow.com/users/4609915/repeat"}, "edited": false, "score": 0, "creation_date": 1599730025, "post_id": 36672346, "comment_id": 112866111, "body": "@repeat <a href=\"https://downloads.haskell.org/ghc/latest/docs/html/users_guide/glasgow_exts.html#generalised-algebraic-data-types-gadts\" rel=\"nofollow noreferrer\">GADT docs</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1676, "user_id": 249669, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/1dfb6b94a31ec3d874dbc7c3f82c5cf9?s=128&d=identicon&r=PG", "display_name": "neuron", "link": "https://stackoverflow.com/users/249669/neuron"}, "edited": false, "score": 1, "creation_date": 1460875436, "post_id": 36673067, "comment_id": 60937564, "body": "I don&#39;t want polymorphic variants because I don&#39;t want the possibility that one type includes only some of the variants of another type. I want it to be all-or-none. That is, I want the subtype relation to be explicitly expressed instead of implied by structure. Or, another reason is that I don&#39;t want the same value constructor to be defined twice."}], "tags": [], "owner": {"reputation": 8625, "user_id": 2642162, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f497a9526578cba7c81514047b3120fb?s=128&d=identicon&r=PG", "display_name": "gsg", "link": "https://stackoverflow.com/users/2642162/gsg"}, "is_accepted": false, "score": 2, "last_activity_date": 1460871559, "creation_date": 1460871559, "answer_id": 36673067, "question_id": 36672346, "link": "https://stackoverflow.com/questions/36672346/is-there-a-name-for-adt-with-explicit-subtyping/36673067#36673067", "title": "Is there a name for ADT with explicit subtyping?", "body": "<p>Unless I misunderstand, polymorphic variants can do pretty much exactly this. However, \"untagged union\" isn't a great term to use (I imagine most people would think you were asking for C-style unions).</p>\n\n<p>The example would look like this:</p>\n\n<pre><code>type empty = [`Empty]\n\ntype bin_op = Add | Sub\n\ntype expr = [`Int of int | `Add of expr * bin_op * expr]\n\ntype optional_expr = [empty | expr]\n\ntype weird_expr = [expr | `Wierd of expr | `Zonk of string]\n</code></pre>\n\n<p>Note that with OCaml's polymorphic variants the subtype relationship is defined structurally and not between named types.</p>\n"}, {"tags": [], "owner": {"reputation": 16267, "user_id": 1346276, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/Tu8Re.jpg?s=128&g=1", "display_name": "phipsgabler", "link": "https://stackoverflow.com/users/1346276/phipsgabler"}, "is_accepted": false, "score": 2, "last_activity_date": 1460885931, "creation_date": 1460885931, "answer_id": 36674904, "question_id": 36672346, "link": "https://stackoverflow.com/questions/36672346/is-there-a-name-for-adt-with-explicit-subtyping/36674904#36674904", "title": "Is there a name for ADT with explicit subtyping?", "body": "<p>There are two things that come to my mind, both for \"real\" subtyping systems (so not available in Haskell), although I am not completely sure whether any of them fits all of your requirements:</p>\n\n<ol>\n<li><p>Explicit untagged <a href=\"http://ceylon-lang.org/documentation/1.2/spec/html_single/#uniontypes\" rel=\"nofollow\">union types</a>, as in Ceylon, which let you name the type <code>A | B</code>, which is a supertype of both <code>A</code> and <code>B</code>. Thus, you could just make <code>Empty</code> and <code>Expr</code> normal ADTs, and then declare a synonym <code>type OptionalExpr = Empty | Expr</code>.</p></li>\n<li><p>The way ADTs are modelled in Scala, as hierarchies of sealed traits and case classes:</p>\n\n<pre><code>sealed trait OptionalExpr\ncase object Empty extends OptionalExpr\nsealed trait Expr extends OptionalExpr\ncase class IntExpr(i: Int) extends OptionaExpr\ncase class AddExpr(lhs: Expr, op: AddOp, rhs: Expr) extends OptionalExpr\n</code></pre>\n\n<p>This way, <code>OptionalExpr</code> and <code>Expr</code> are not extensible (since the traits are sealed) and behave mostly like ADTs in Haskell, but you can still access the \"intermediate\" types like in a normal inheritance hierarchy (unlike in Haskell, where you have only the constructors, which are not by themselves types).</p></li>\n</ol>\n\n<p>Both cases require a form of pattern matching to access values, of course, since you have to recover in which \"part of the union\" you are.</p>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1460919720, "post_id": 36680559, "comment_id": 60951517, "body": "One downside of this approach is that the compiler won&#39;t notice that, e.g., the only two patterns needed for a function of type <code>Expr Primary -&gt; Whatever</code> are <code>ID</code> and <code>Paren x</code>; I have asked a question about whether there is a way to deal with this <a href=\"http://stackoverflow.com/q/36680830/791604\">here</a>."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 3, "last_activity_date": 1460918382, "last_edit_date": 1460918382, "creation_date": 1460918052, "answer_id": 36680559, "question_id": 36672346, "link": "https://stackoverflow.com/questions/36672346/is-there-a-name-for-adt-with-explicit-subtyping/36680559#36680559", "title": "Is there a name for ADT with explicit subtyping?", "body": "<p>In a comment, you say:</p>\n\n<blockquote>\n  <p>I'm not sure how to encode a subtype hierarchy using GADTs. If you think it is doable, would you mind providing an answer with an example as to how the type hierarchy given in my example may be encoded?</p>\n</blockquote>\n\n<p>Therefore I give an answer to this question here. The key idea is to give a type-level function (in the host language, here Haskell) for computing the subtyping relation (of the target language's type system, here your custom EDSL). For simplicity, I will spell out the subtyping relation in full, but standard type-level programming can be used to reduce the repetition and raise the abstraction level as appropriate. First, the extensions needed:</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE TypeFamilies #-}\n</code></pre>\n\n<p>Now the definition of the subtyping relation:</p>\n\n<pre><code>data Level = Primary | Unary | Mult | Add | Comp\n\ntype family Subtype a b where\n    Subtype Primary a       = True\n    Subtype Unary   Primary = False\n    Subtype Unary   a       = True\n    Subtype Mult    Primary = False\n    Subtype Mult    Unary   = False\n    Subtype Mult    a       = True\n    Subtype Add     Add     = True\n    Subtype Add     Comp    = True\n    Subtype Add     a       = False\n    Subtype Comp    Comp    = True\n    Subtype Comp    a       = False\n</code></pre>\n\n<p>A closed type family is used to guarantee that the subtyping relation cannot be expanded by clients (your second property). Finally, the GADT for target language terms can use the subtyping relation as a constraint on its constructors.</p>\n\n<pre><code>data Expr a where\n    ID      :: Subtype Primary a ~ True =&gt; Expr a\n    Paren   :: Subtype Primary a ~ True =&gt; Expr b -&gt; Expr a\n    Negate  :: Subtype Unary   a ~ True =&gt; Expr Unary -&gt; Expr a\n    Times   :: Subtype Add     a ~ True =&gt; Expr Mult -&gt; Expr Mult -&gt; Expr a\n    Plus    :: Subtype Add     a ~ True =&gt; Expr Add -&gt; Expr Add -&gt; Expr a\n    Compose :: Subtype Comp    a ~ True =&gt; Expr Comp -&gt; Expr Comp -&gt; Expr a\n</code></pre>\n\n<p>Note that because the argument to <code>Paren</code> is polymorphic, you will need a type annotation on the contained term to express which \"level\" of the subtyping hierarchy you want that term to be treated as. I would expect you would need to do this in whatever language you are designing as well. In ghci, we can ask for the type of a sample term:</p>\n\n<pre><code>:t Compose (Times ID ID) (Negate (Paren (Plus ID ID :: Expr Add)))\nCompose (Times ID ID) (Negate (Paren (Plus ID ID :: Expr Add)))\n  :: (Subtype 'Comp a ~ 'True) =&gt; Expr a\n</code></pre>\n\n<p>This is more or less the type you would expect for this term, I think. You can also see that the expression hierarchy is strictly enforced, though I dare say the error message is not 100% clear (since it is written in host language terms and not target language terms):</p>\n\n<pre><code>:t Negate (Plus ID ID)\n\n&lt;interactive&gt;:1:9:\n    Couldn't match type \u2018'False\u2019 with \u2018'True\u2019\n    Expected type: 'True\n      Actual type: Subtype 'Add 'Unary\n    In the first argument of \u2018Negate\u2019, namely \u2018(Plus ID ID)\u2019\n    In the expression: Negate (Plus ID ID)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": false, "score": 3, "last_activity_date": 1460939258, "last_edit_date": 1460939258, "creation_date": 1460938385, "answer_id": 36683633, "question_id": 36672346, "link": "https://stackoverflow.com/questions/36672346/is-there-a-name-for-adt-with-explicit-subtyping/36683633#36683633", "title": "Is there a name for ADT with explicit subtyping?", "body": "<p>Haskell is particularly amenable to modeling your domain, perhaps because it can be described with a fairly simple mathematical model. Crucially, your first point implies that the subtype relation is a <a href=\"https://en.wikipedia.org/wiki/Well-order\" rel=\"nofollow\">well-order</a>. This makes your life very easy - this model would likely translate easily to any language whose type system is at least as strong as that of Haskell. </p>\n\n<p>Start by defining a type (which will be lifted to a kind) to represent your variants:</p>\n\n<pre><code>data Variant = Primary | Unary | Mult | Add | Comp | Expr \n</code></pre>\n\n<p>Next a <em>non</em>-recursive datatype to represent the nodes in your term language: </p>\n\n<pre><code>data ExprF (k :: Variant -&gt; *) (x :: Variant) where \n  ID_F :: ExprF k 'Primary \n  Paren_F :: k 'Expr -&gt; ExprF k 'Primary  \n  Negate_F :: k 'Primary -&gt; ExprF k 'Unary\n  Mult_F :: k 'Mult -&gt; k 'Unary -&gt; ExprF k 'Mult \n  Add_F  :: k 'Add -&gt; k 'Mult -&gt; ExprF k 'Add \n  Comp_F :: k 'Add -&gt; k 'Add -&gt; ExprF k 'Comp \n</code></pre>\n\n<p>Recursive occurrences of terms are represented by an additional parameter. Essentially this is just the typical polynomial functor representation (i.e. <a href=\"http://haddock.stackage.org/lts-5.13/recursion-schemes-4.1.2/Data-Functor-Foldable.html#v:Fix\" rel=\"nofollow\"><code>Fix</code></a>) but with an index parameter. </p>\n\n<p>Your expression type is then:</p>\n\n<pre><code>data Expr' (x :: Variant) where \n  Expr' :: (x &lt;= y) =&gt; Expr x -&gt; Expr' y \n\ndata Expr (x :: Variant) where \n  MkExpr :: ExprF Expr' x -&gt; Expr x \n</code></pre>\n\n<p>The <code>&lt;=</code> class has not been introduced yet, but it represents your subtype relation. </p>\n\n<p>As mentioned previously, your subtype relation is a well-order, and by this virtue each element in the ordering can be assigned a unique natural number such that the typical ordering on naturals respects your subtype relation. Or in other words, there is an injection <code>f : Variant -&gt; Nat</code> such that <code>x</code> is a subtype of <code>y</code> iff <code>f x &lt;= f y</code> (or strict subtype iff <code>f x &lt; f y</code> - such a representation gives you a lot of generality). </p>\n\n<p>The required injection is just given by your grammar. Note that each production is only a \"subtype\" (i.e. has a right-hand side which should not introduce a constructor) of of productions above it. </p>\n\n<pre><code>data Nat = Z | S Nat \ninfixr 0 $ \ntype ($) f a = f a \n\ntype family VariantIx (x :: Variant) :: Nat where \n  VariantIx 'Primary = 'Z \n  VariantIx 'Unary = 'S 'Z \n  VariantIx 'Mult = 'S $ 'S 'Z \n  VariantIx 'Add = 'S $ 'S $ 'S 'Z \n  VariantIx 'Comp = 'S $ 'S $ 'S $ 'S 'Z \n  VariantIx 'Expr = 'S $ 'S $ 'S $ 'S $ 'S 'Z \n</code></pre>\n\n<p>You need an implicit subtype relation (which is <code>&lt;=</code>) but it is often much easier to work with an explicit proof of the relation, so it is typical that the implicit version simply generates the explicit proof. To this end you write two declarations:</p>\n\n<pre><code>data family (:&lt;=:) (x :: k) (y :: k) \nclass (&lt;=) (x :: k) (y :: k) where \n  isLTEQ :: x :&lt;=: y \n</code></pre>\n\n<p>The instances for naturals should fairly obvious: </p>\n\n<pre><code>data instance (:&lt;=:) (x :: Nat) y where \n  LT_Z :: 'Z :&lt;=: n \n  LT_S :: n :&lt;=: m -&gt; 'S n :&lt;=: 'S m \ninstance 'Z &lt;= n where isLTEQ = LT_Z \ninstance (n &lt;= m) =&gt; 'S n &lt;= 'S m where isLTEQ = LT_S isLTEQ \n</code></pre>\n\n<p>and the instances for <code>Variant</code> define the order induced by <code>VariantIx</code>: </p>\n\n<pre><code>newtype instance (:&lt;=:) (x :: Variant) y = IsSubtype (VariantIx x :&lt;=: VariantIx y) \ninstance (VariantIx x &lt;= VariantIx y) =&gt; x &lt;= y where isLTEQ = IsSubtype isLTEQ \n</code></pre>\n\n<p>You probably want some smart constructors. If you are using a recent GHC you will have access to pattern synonyms, but it isn't necessary:</p>\n\n<pre><code>id_ = MkExpr ID_F \npattern Id = MkExpr ID_F \n\npattern Paren e = MkExpr (Paren_F (Expr' e)) \n\npattern Neg e = MkExpr (Negate_F (Expr' e)) \n\ninfixl 6 :+ \npattern (:+) a b = MkExpr (Add_F (Expr' a) (Expr' b)) \n\ninfixl 7 :* \npattern (:*) a b = MkExpr (Mult_F (Expr' a) (Expr' b)) \n\npattern Cmp a b = MkExpr (Comp_F (Expr' a) (Expr' b)) \n</code></pre>\n\n<p>and some simple examples:</p>\n\n<pre><code>&gt;Id :+ Id :+ Neg Id :* Id\nAdd_F (Add_F ID_F ID_F) (Mult_F (Negate_F ID_F) ID_F)\n&gt;Id :+ Id :* Neg (Id :* Id)\n\n&lt;interactive&gt;:6:13:\n    No instance for (('S $ 'S 'Z) &lt;= 'Z) arising from a use of `Neg'\n</code></pre>\n\n<hr>\n\n<p>Note that you could also write your expression type in a slightly different way:</p>\n\n<pre><code>data ExprFlip (x :: Variant) where \n  MkExprFlip :: (x &lt;= y) =&gt; ExprF ExprFlip x -&gt; ExprFlip y \n</code></pre>\n\n<p>This differs from the original in that the outermost type of an expression has the subtype relation applied to it - so e.g.</p>\n\n<pre><code>pattern Id' = MkExprFlip ID_F \n</code></pre>\n\n<p>has type <code>ExprFlip t</code> while <code>Id :: Expr 'Primary</code>. I can't see any other way in which they differ, and I imagine that it would simply be a matter of preference, or which use cases are most common. The original presentation has the advantage the the output type is always monomorphic, which may make type inference better in some cases, but does not affect the construction of expressions. </p>\n\n<hr>\n\n<p>To address your four points:</p>\n\n<ol>\n<li>This model relies on the semantics of the subtype relation by design. </li>\n<li><code>VariantIx</code> and the <code>Variant</code> type are closed. Any additional instances for <code>:&lt;=:</code> or <code>&lt;=</code> for <code>Variant</code> or <code>Nat</code> will overlap with the existing ones (which are as general as possible) so while in principle they can defined, attempting to use them will produce type errors.</li>\n<li>Essentially you have a reflexive and transitive relation, and these properties are captured in the <code>&lt;=</code> instance for <code>Nat</code> once and for all. Changing the subtype relation amounts only to changing <code>Variant</code> and <code>VariantIx</code>.</li>\n<li>The proofs of the subtype relation are constructed by type inference - by the <code>&lt;=</code> class. Since all of the indices in the <code>ExprF</code> datatype are monomorphic, the type checker will always be able to compute the subtype relation for the indices.</li>\n</ol>\n\n<hr>\n\n<p>Full code: </p>\n\n<pre><code>{-# LANGUAGE StandaloneDeriving, UndecidableInstances, PatternSynonyms\n  , TypeOperators, KindSignatures, PolyKinds, DataKinds, GADTs, TypeFamilies\n  , MultiParamTypeClasses, FlexibleContexts, FlexibleInstances #-} \n\ndata Variant = Primary | Unary | Mult | Add | Comp | Expr \n\ndata ExprF (k :: Variant -&gt; *) (x :: Variant) where \n  ID_F :: ExprF k 'Primary \n  Paren_F :: k 'Expr -&gt; ExprF k 'Primary  \n  Negate_F :: k 'Primary -&gt; ExprF k 'Unary\n  Mult_F :: k 'Mult -&gt; k 'Unary -&gt; ExprF k 'Mult \n  Add_F  :: k 'Add -&gt; k 'Mult -&gt; ExprF k 'Add \n  Comp_F :: k 'Add -&gt; k 'Add -&gt; ExprF k 'Comp \n\ndata Expr' (x :: Variant) where \n  Expr' :: (x &lt;= y) =&gt; Expr x -&gt; Expr' y \n\ndata Expr (x :: Variant) where \n  MkExpr :: ExprF Expr' x -&gt; Expr x \n\ndata ExprFlip (x :: Variant) where \n  MkExprFlip :: (x &lt;= y) =&gt; ExprF ExprFlip x -&gt; ExprFlip y \n\npattern Id' = MkExprFlip ID_F \n\ndata Nat = Z | S Nat \ninfixr 0 $ \ntype ($) f a = f a \n\ntype family VariantIx (x :: Variant) :: Nat where \n  VariantIx 'Primary = 'Z \n  VariantIx 'Unary = 'S 'Z \n  VariantIx 'Mult = 'S $ 'S 'Z \n  VariantIx 'Add = 'S $ 'S $ 'S 'Z \n  VariantIx 'Comp = 'S $ 'S $ 'S $ 'S 'Z \n  VariantIx 'Expr = 'S $ 'S $ 'S $ 'S $ 'S 'Z \n\ndata family (:&lt;=:) (x :: k) (y :: k) \nclass (&lt;=) (x :: k) (y :: k) where \n  isLTEQ :: x :&lt;=: y \n\ndata instance (:&lt;=:) (x :: Nat) y where \n  LT_Z :: 'Z :&lt;=: n \n  LT_S :: n :&lt;=: m -&gt; 'S n :&lt;=: 'S m \ninstance 'Z &lt;= n where isLTEQ = LT_Z \ninstance (n &lt;= m) =&gt; 'S n &lt;= 'S m where isLTEQ = LT_S isLTEQ \n\nnewtype instance (:&lt;=:) (x :: Variant) y = IsSubtype (VariantIx x :&lt;=: VariantIx y) \ninstance (VariantIx x &lt;= VariantIx y) =&gt; x &lt;= y where isLTEQ = IsSubtype isLTEQ \n\nid_ = MkExpr ID_F \n\npattern Id = MkExpr ID_F \n\npattern Paren e = MkExpr (Paren_F (Expr' e)) \n\npattern Neg e = MkExpr (Negate_F (Expr' e)) \n\ninfixl 6 :+ \npattern (:+) a b = MkExpr (Add_F (Expr' a) (Expr' b)) \n\ninfixl 7 :* \npattern (:*) a b = MkExpr (Mult_F (Expr' a) (Expr' b)) \n\npattern Cmp a b = MkExpr (Comp_F (Expr' a) (Expr' b)) \n\ninstance Show (Expr' x) where\n  showsPrec k (Expr' x) = showsPrec k x  \n\ninstance Show (Expr x) where \n  showsPrec k (MkExpr x) = showsPrec k x \n\nderiving instance (Show (k 'Mult), Show (k 'Add), Show (k 'Expr), Show (k 'Primary), Show (k 'Unary)) =&gt; Show (ExprF k x) \n</code></pre>\n"}], "owner": {"reputation": 1676, "user_id": 249669, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/1dfb6b94a31ec3d874dbc7c3f82c5cf9?s=128&d=identicon&r=PG", "display_name": "neuron", "link": "https://stackoverflow.com/users/249669/neuron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 423, "favorite_count": 3, "answer_count": 4, "score": 5, "last_activity_date": 1460939258, "creation_date": 1460863550, "last_edit_date": 1460880682, "question_id": 36672346, "link": "https://stackoverflow.com/questions/36672346/is-there-a-name-for-adt-with-explicit-subtyping", "title": "Is there a name for ADT with explicit subtyping?", "body": "<p>I'm looking for a proper name for a data type that combines ADT with explicit subtyping.</p>\n\n<p>In one of my applications, I use a structure similar to ADT to represent parse trees, on which I perform recursive pattern matching. I find it rather convenient if I could combine ADT with subtyping, as demonstrated in the example below:</p>\n\n<p>Note: the example is written in Haskell's syntax, but this is not Haskell code.</p>\n\n<pre><code>data Empty = Empty\ndata Expr = Int Int | Add Expr AddOp Expr\ndata OptionalExpr =\n| Empty  // I want to make Empty a subtype of OptionalExpr\n| Expr   // I want to make Expr  a subtype of OptionalExpr\n</code></pre>\n\n<p>In the example above, I first define 2 types: Empty and Expr. Then I make these 2 types the subtype of OptionalExpr. I realize this kind of data type is <em>uncommon</em>. Apparently neither Haskell nor OCaml support it. But I don't know about other functional languages.</p>\n\n<p>I am looking for something that combines ADT with <em>explicit subtyping</em>, not structurally-implied subtyping as in polymorphic variant. There are a few justifications for this requirement:</p>\n\n<ul>\n<li>First, we want all-or-none subtyping. Say we want A to be a subtype of B, then we will <em>never</em> want to include only some of the variants of A under B. Either A is a subtype of B, in which case B includes all the variants of A, or A is not a subtype of B, in which case B includes none of the variants of A. We don't allow gray-area in between.</li>\n<li>Second, we don't want B to be open in any sense. We have in mind a very specific set of subtypes of B. We don't want something to become an instance of B just by implementing a typeclass or the like.</li>\n<li>Third, say type A has a large number of variants. We want to make type B a supertype of A. Copying all the variants into B, as is required with polymorphic variant, is just too cumbersome and error-prone.</li>\n<li>Fourth, we don't want to introduce new value-constructors when all we want to express is a subtype. In the example above, we could have written OptionalExpr as an ADT with 2 value-constructors, like this: <code>data OptionalExpr = EmptyExpr | NonEmptyExpr Expr</code>, or we could have used <code>Maybe</code>, but in my application this is unacceptable, because the level of embedding can be quite deep, and it would be a nightmare to deconstruct an deeply embedded value like <code>(L1 (L2 (L3 (L4 (L5 value_wanted)))))</code>.</li>\n</ul>\n\n<p>To give you some idea why such requirements exist, I show a more specific example below:</p>\n\n<pre><code>PrimaryExpr = ID | LeftParen Expr RightParen\nUnaryExpr = PrimaryExpr | NegateOp PrimaryExpr    // -\nMultExpr  = UnaryExpr | MultExpr MultOp UnaryExpr // *\nAddExpr   = MultExpr  | AddExpr  AddOp MultExpr   // +\nCompExpr  = AddExpr | AddExpr CompOp AddExpr\nExpr = CompExpr\n</code></pre>\n\n<p>The above example expresses a subtype hierarchy, and expresses ideas such as AddExpr is a CompExpr, but a CompExpr is not an AddExpr. For this specific example, some people have suggested to me that I can replace UnaryExpr, MultExpr, AddExpr and so on with just Expr. That is, I can define all the types as a single type. That loses type constraints such as CompExpr is not AddExpr, and because I'm doing recursive pattern matching on these types, I need that constraints of this hierarchy to be statically enforced.</p>\n\n<p>Is there a name for this kind of data type I'm looking for in the literature? Or am I looking for something that doesn't even make sense? If you think this is the case, why am I looking for something nonsensical? Thanks for any pointers.</p>\n\n<p>EDIT: even though I've written the above code snippets in Haskell's syntax, I am not writing my application in Haskell. I'm using my own language and my own data types, so I am not limited by Haskell's semantics. I am looking for a pointer to similar concepts in literature, so that when I write a report for my project I don't appear to be reinventing something new. I tried all the google keywords I can think of and nothing right was returned so I'm asking here.</p>\n"}, {"tags": ["haskell", "monads", "transformation"], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 5, "last_activity_date": 1460852257, "creation_date": 1460852257, "answer_id": 36671302, "question_id": 36671136, "link": "https://stackoverflow.com/questions/36671136/what-is-difference-between-those-two-monad-transformers/36671302#36671302", "title": "What is difference between those two monad transformers?", "body": "<p>To simplify, compare only the relevant part (which isn't trivially the same):</p>\n\n<pre><code>MaybeT (StateT Integer Identity) a\nStateT Integer (MaybeT Identity) a\n</code></pre>\n\n<p>We know that (ignoring the <code>newtype</code> abstractions)</p>\n\n<pre><code>type MaybeT m a = m (Maybe a)\ntype StateT s m a = s -&gt; m (a, s)\n</code></pre>\n\n<p>Hence, the two transformer stack come out to be</p>\n\n<pre><code>MaybeT (\u039bb. Integer -&gt; (b, Integer)) a\n    \u2261 Integer -&gt; (Maybe a, Integer)\n</code></pre>\n\n<p>and</p>\n\n<pre><code>StateT Integer (\u039bb. Maybe b) a\n    \u2261 Integer -&gt; Maybe (a, Integer)\n</code></pre>\n\n<p>So, these aren't exactly the same, the difference being that the latter only yields the state-integer inside of the <code>Maybe</code>. This means, if the <code>MaybeT</code> is down in the stack then the computation must immediately terminate as soon as you get a <code>Nothing</code>, whereas if the <code>MaybeT</code> is used on top then the <code>State</code> can still keep on going.</p>\n\n<p>This is even more drastic with <code>IO</code>: once you get an exception, you <em>can't</em> possibly continue &ndash; exceptions can only be caught in <code>IO</code> itself. This is one reason why there can be no <code>IOT</code> transformer.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1460878732, "creation_date": 1460878732, "answer_id": 36673893, "question_id": 36671136, "link": "https://stackoverflow.com/questions/36671136/what-is-difference-between-those-two-monad-transformers/36673893#36673893", "title": "What is difference between those two monad transformers?", "body": "<pre><code>ReaderT Env (ErrorT String (StateT Integer Identity)) a\nReaderT Env (StateT Integer (ErrorT String Identity)) a\n</code></pre>\n\n<p>Briefly put, in the first errors only depend on the <code>Env</code> input, while the second allows errors to depend on both <code>Env</code> and the <code>Integer</code> state.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6023611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 1, "accepted_answer_id": 36671302, "answer_count": 2, "score": 4, "last_activity_date": 1460879653, "creation_date": 1460850613, "last_edit_date": 1460879653, "question_id": 36671136, "link": "https://stackoverflow.com/questions/36671136/what-is-difference-between-those-two-monad-transformers", "title": "What is difference between those two monad transformers?", "body": "<p>I'm familiar with monads, e.g. <code>Reader</code>, <code>Error</code>, and <code>State</code>. Transformers, however, are very new to me, hence this question.</p>\n\n<p>Intuitively, I can tell there is a difference between the following two monad transformers, but I can't quite pinpoint what it is...</p>\n\n<pre><code>ReaderT Env (ErrorT String (StateT Integer Identity)) a\n\nReaderT Env (StateT Integer (ErrorT String Identity)) a\n</code></pre>\n\n<p>What makes these two monad transformers different?</p>\n"}, {"tags": ["list", "haskell", "tuples"], "comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1460856427, "post_id": 36670539, "comment_id": 60934569, "body": "also, <code>(\\xs-&gt; [(x,y) | (x:y:_)&lt;- tails xs])</code>. <a href=\"http://hackage.haskell.org/package/base-4.8.2.0/docs/Data-List.html#v:tails\" rel=\"nofollow noreferrer\"><code>tails</code></a> is defined with recursion, but then so is <code>zip</code>."}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1460846329, "post_id": 36670569, "comment_id": 60932539, "body": "The latter would better be written <code>zip&lt;*&gt;tail</code>. I&#39;m actually not a big fan of these function-functor hacks, but I have to admit that this here is pretty nice."}, {"owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1460846668, "post_id": 36670569, "comment_id": 60932647, "body": "It doesn&#39;t save any brackets here so whatevz but sure."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1460846829, "post_id": 36670569, "comment_id": 60932686, "body": "<code>ap</code> is somewhat obsolete now that <code>Applicative</code> is a superclass of <code>Monad</code> (at least in GHC, and assuming it is adopted by the Haskell 2014 standard)."}, {"owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "edited": false, "score": 0, "creation_date": 1460847056, "post_id": 36670569, "comment_id": 60932729, "body": "If they&#39;re gonna make return an alias of pure, then ap will be a prefix alias of &lt;*&gt;, right?"}, {"owner": {"reputation": 62908, "user_id": 567620, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/g8HIM.jpg?s=128&g=1", "display_name": "ely", "link": "https://stackoverflow.com/users/567620/ely"}, "edited": false, "score": 3, "creation_date": 1460847586, "post_id": 36670569, "comment_id": 60932830, "body": "For other noobs like me, the relevant instance of Applicative being used is the instance for functions of a common first argument type, <code>((-&gt;) r)</code>, for which you have <code>&lt;*&gt; f g x = f x (g x)</code>, which apparently is also called the S combinator."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1460847689, "post_id": 36670569, "comment_id": 60932856, "body": "Oddly, while the current implementation does define <code>return = pure</code>, it still provides an explicit definition of <code>ap</code> due to the amount of existing code that just defines <code>(&lt;*&gt;) = ap</code>. I guess <code>pure</code> was easy enough to implement directly that fewer people would define it as <code>return</code>?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1550864954, "post_id": 36670569, "comment_id": 96443127, "body": "The fact that this works for empty lists is a bit subtle for my taste."}], "tags": [], "owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "is_accepted": true, "score": 11, "last_activity_date": 1460846566, "last_edit_date": 1460846566, "creation_date": 1460846052, "answer_id": 36670569, "question_id": 36670539, "link": "https://stackoverflow.com/questions/36670539/consecutive-pairs-from-list-in-haskell/36670569#36670569", "title": "Consecutive pairs from list in haskell", "body": "<p><code>\\xs -&gt; zip xs $ tail xs</code> or <code>zip &lt;*&gt; tail</code>.</p>\n"}], "owner": {"reputation": 49, "user_id": 5724503, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4f822b38f63cbeedbc540c28a69ab75?s=128&d=identicon&r=PG&f=1", "display_name": "Bill Mack", "link": "https://stackoverflow.com/users/5724503/bill-mack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1197, "favorite_count": 0, "accepted_answer_id": 36670569, "answer_count": 1, "score": 3, "last_activity_date": 1550862820, "creation_date": 1460845886, "last_edit_date": 1550862820, "question_id": 36670539, "link": "https://stackoverflow.com/questions/36670539/consecutive-pairs-from-list-in-haskell", "title": "Consecutive pairs from list in haskell", "body": "<p>How can I get a list of consecutive pairs (tuples) from a list without recursion ? </p>\n\n<p>For example : <code>[1, 2, 3, 4]</code> would be <code>[(1, 2), (2, 3), (3, 4)]</code></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1460850275, "post_id": 36670180, "comment_id": 60933412, "body": "You can do e.g. <code>ufold ((&gt;&gt;) . print) (return ())</code> to see how the output of <code>ufold</code> is constructed exactly. In particular, edges appear exactly once in the list - either as an outgoing edge from the source or an incoming edge to the target (seems almost arbitrary which edges appear where? I&#39;m not sure). You are ignoring those edges which are including as incoming edges, not outgoing edges."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 1, "last_activity_date": 1460853804, "creation_date": 1460853804, "answer_id": 36671434, "question_id": 36670180, "link": "https://stackoverflow.com/questions/36670180/fgl-library-node-context-not-providing-expected-outgoing-connections-lists-with/36671434#36671434", "title": "fgl library: node context not providing expected outgoing connections lists with ufold", "body": "<p>Contexts refer only to nodes that have not yet been visited. (Imagine deleting each node and all edges to/from that node as it is visited.) If you want to see the extra edges, don't ignore the incoming edges (the first field of the four-tuple).</p>\n"}], "owner": {"reputation": 1722, "user_id": 1526266, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/1HT7M.jpg?s=128&g=1", "display_name": "Rob Stewart", "link": "https://stackoverflow.com/users/1526266/rob-stewart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1460853804, "creation_date": 1460843225, "question_id": 36670180, "link": "https://stackoverflow.com/questions/36670180/fgl-library-node-context-not-providing-expected-outgoing-connections-lists-with", "title": "fgl library: node context not providing expected outgoing connections lists with ufold", "body": "<p>Take the following edges in the <code>{A,B,C,D,E}</code> graph:</p>\n\n<pre><code>A -&gt; B\nC -&gt; D\nC -&gt; E\nD -&gt; A\n</code></pre>\n\n<p>where the nodes are indexed with an <code>Int</code>:</p>\n\n<pre><code>-5959232120642455838 -&gt; \"A\"\n-5322791284737046018 -&gt; \"B\"\n6963039171755682694  -&gt; \"C\"\n-5226022365236209258 -&gt; \"D\"\n-5226022365169098782 -&gt; \"E\"\n</code></pre>\n\n<p>The <code>ufold</code> provided by fgl provides a context at each node A, B, C, D and E.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>ufold :: Graph gr =&gt; (Context a b -&gt; c -&gt; c) -&gt; c -&gt; gr a b -&gt; c\ntype Context a b = (Adj b, Node, a, Adj b)\ntype Adj b = [(b, Node)]\n</code></pre>\n\n<p>Here's a function that generates a <code>String</code> showing the current visited node and a list of all of its outgoing connections.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>getOutgoing :: Gr String String -&gt; [String]\ngetOutgoing myGraph =\n  ufold (\\(_,_,nodeStr,connsOut) st -&gt; \n      (nodeStr ++ \" -&gt; \" ++ show (map snd connsOut)) : st)\n        [] myGraph\n</code></pre>\n\n<p>For the connections listed above, I would expect this <code>getOutgoing</code> to return:</p>\n\n<pre><code>A -&gt; [-5322791284737046018]\nB -&gt; []\nC -&gt; [-5226022365236209258,-5226022365169098782]\nD -&gt; [-5959232120642455838]\nE -&gt; []\n</code></pre>\n\n<p>However, it returns:</p>\n\n<pre><code>A -&gt; [-5322791284737046018]\nB -&gt; []\nD -&gt; []\nE -&gt; []\nC -&gt; []\n</code></pre>\n\n<p>This is a complete version:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>module Main where\n\nimport Data.Graph.Inductive.Graph\nimport Data.Graph.Inductive.PatriciaTree (Gr)\n\ngrEdges :: [LEdge String]\ngrEdges = [ (-5959232120642455838, -5322791284737046018,\"AtoB\")\n          , (6963039171755682694,  -5226022365236209258,\"CtoD\")\n          , (6963039171755682694,  -5226022365169098782,\"CtoE\")\n          , (-5226022365236209258, -5959232120642455838,\"DtoA\") ]\n\ngrNodes :: [LNode String]\ngrNodes = [ (-5959232120642455838,\"A\")\n          , (-5322791284737046018,\"B\")\n          , (6963039171755682694,\"C\")\n          , (-5226022365236209258,\"D\")\n          , (-5226022365169098782,\"E\") ]\n\ngetOutgoing :: Gr String String -&gt; [String]\ngetOutgoing myGraph =\n    ufold (\\(_,_,nodeStr,connsOut) st -&gt;\n       (nodeStr ++ \" -&gt; \" ++ show (map snd connsOut)) : st)\n          [] myGraph\n\nmain :: IO ()\nmain = do\n  putStrLn \"Expected outgoing connections to nodeIDs:\"\n  mapM_ putStrLn [ \"A -&gt; [-5322791284737046018]\"\n                 , \"B -&gt; []\"\n                 , \"C -&gt; [-5226022365236209258,-5226022365169098782]\"\n                 , \"D -&gt; [-5959232120642455838]\"\n                 , \"E -&gt; []\" ]\n\n  putStrLn \"Actual outgoing connections to nodeIDs:\"\n  let gr = mkGraph grNodes grEdges :: Gr String String\n  mapM_ putStrLn (getOutgoing gr)\n</code></pre>\n\n<p>So, why for nodes C and D, is <code>ufold</code> providing a node context containing an empty list for their outgoing connections? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1460835270, "post_id": 36668709, "comment_id": 60929330, "body": "Is <code>TextEditor</code> supposed to be type, or some sort of value? In your code you&#39;re mixing both together, you can&#39;t do that."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1460835500, "post_id": 36668709, "comment_id": 60929408, "body": "<code>reverse (tail (reverse l))</code> is already defined as <code>init</code> in the module <code>Data.List</code>."}, {"owner": {"reputation": 7, "user_id": 4329496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/caa79e1b8dd8882a15799f3ed7d0db24?s=128&d=identicon&r=PG&f=1", "display_name": "DJRD4465", "link": "https://stackoverflow.com/users/4329496/djrd4465"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1460836460, "post_id": 36668709, "comment_id": 60929703, "body": "@chepner I&#39;m learning Haskell as part of an assignment. Annoyingly we are only allowed to use the head, tail, concatenate and the dot operator. Thanks for the info though!"}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1460835423, "post_id": 36668777, "comment_id": 60929381, "body": "The definitions of <code>l</code>, <code>h</code>, <code>a</code>, and <code>x</code> appear to be irrelevant, other than as part of the incorrect attempt to define <code>TextEditor</code> as a type of tuple containing four lists."}, {"owner": {"reputation": 13379, "user_id": 1033027, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b56ea1c43a4ecb1060ec8bcb8d2bce78?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/1033027/jules"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1460835550, "post_id": 36668777, "comment_id": 60929419, "body": "Correct; that&#39;s what I was trying to convey in my answer."}], "tags": [], "owner": {"reputation": 13379, "user_id": 1033027, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/b56ea1c43a4ecb1060ec8bcb8d2bce78?s=128&d=identicon&r=PG", "display_name": "Jules", "link": "https://stackoverflow.com/users/1033027/jules"}, "is_accepted": true, "score": 1, "last_activity_date": 1460835309, "creation_date": 1460835309, "answer_id": 36668777, "question_id": 36668709, "link": "https://stackoverflow.com/questions/36668709/noob-having-difficulties-with-haskell-not-in-scope-errors/36668777#36668777", "title": "Noob having difficulties with Haskell - Not in scope errors", "body": "<p>What you've done here is declared a top-level scoped <em>symbol</em> (like a variable) called <code>TextEditor</code>.</p>\n\n<p>What you probably want to do is to declare a <code>TextEditor</code> data type and its corresponding type constructor, which might be done like this:</p>\n\n<pre><code>data TextEditor = TextEditor ([String], [String], [String], [String])\n</code></pre>\n\n<p>(Your definition may vary; you didn't declare the types of <code>l</code>, <code>h</code>, <code>a</code> or <code>x</code> so I'm just assuming <code>[String]</code>)</p>\n\n<p>I'd recommend reading up about <code>data</code> declarations and typeclass definitions in <a href=\"http://learnyouahaskell.com/making-our-own-types-and-typeclasses\" rel=\"nofollow\">the appropriate LYAH chapter</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 2, "last_activity_date": 1460835390, "creation_date": 1460835390, "answer_id": 36668793, "question_id": 36668709, "link": "https://stackoverflow.com/questions/36668709/noob-having-difficulties-with-haskell-not-in-scope-errors/36668793#36668793", "title": "Noob having difficulties with Haskell - Not in scope errors", "body": "<p>I guess what you're trying to do is this:</p>\n\n<pre><code>type L = [Char]  -- aka String\ntype H = [Char]\ntype A = [Char]\ntype X = [Char]\n\ndata TextEditor = TextEditor L H A X -- You really should use more discriptive names\n\nbackspace :: TextEditor -&gt; TextEditor\nbackspace (TextEditor l h a x) = \n    (TextEditor(reverse (tail (reverse l))) [] a x)\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 4329496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/caa79e1b8dd8882a15799f3ed7d0db24?s=128&d=identicon&r=PG&f=1", "display_name": "DJRD4465", "link": "https://stackoverflow.com/users/4329496/djrd4465"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "accepted_answer_id": 36668777, "answer_count": 2, "score": 0, "last_activity_date": 1460835390, "creation_date": 1460834936, "last_edit_date": 1460835286, "question_id": 36668709, "link": "https://stackoverflow.com/questions/36668709/noob-having-difficulties-with-haskell-not-in-scope-errors", "title": "Noob having difficulties with Haskell - Not in scope errors", "body": "<p>I am a beginner with Haskell and having some difficulties getting a tuple consisting of 4 empty lists to work. The below code is the entirety of my Haskell Program.</p>\n\n<pre><code>import Data.List\nimport System.IO\n\nl = []\nh = []\na = []\nx = []\n\nTextEditor = (l, h, a, x) \n\nbackspace :: TextEditor -&gt; TextEditor\nbackspace (TextEditor l h a x) = \n    (TextEditor(reverse (tail (reverse l))) [] a x)\n</code></pre>\n\n<p>I get multiple errors.</p>\n\n<pre><code>Not in scope: data constructor \u2018TextEditor\u2019\nNot in scope: type constructor 'TextEditor'\n</code></pre>\n\n<p>Despite googling I can't work out what's wrong with my functions. Could someone help push me in the right direction please?</p>\n"}, {"tags": ["haskell", "functional-programming", "amqp"], "answers": [{"comments": [{"owner": {"reputation": 426, "user_id": 1324707, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/136032b0e1156db2d514866cc2b2dff1?s=128&d=identicon&r=PG", "display_name": "Kai", "link": "https://stackoverflow.com/users/1324707/kai"}, "edited": false, "score": 0, "creation_date": 1460833807, "post_id": 36668328, "comment_id": 60928831, "body": "Thank you, this is beautiful \ud83d\ude2e"}], "tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 3, "last_activity_date": 1460832859, "creation_date": 1460832859, "answer_id": 36668328, "question_id": 36668276, "link": "https://stackoverflow.com/questions/36668276/pass-function-with-different-signature-than-is-expected/36668328#36668328", "title": "Pass function with different signature than is expected", "body": "<p>I'm a little unclear on your constraints, but if you have what you need available at the <code>consumeMsgs</code> call site, you can use a closure.  (I assume <code>ch</code> is the channel you want)</p>\n\n<pre><code>lock &lt;- ...\nconsumeMsgs ch \"tasks\" Ack (\\(msg,env) -&gt; taskHandler (msg,env) ch lock)\n</code></pre>\n\n<p>(It's not strictly necessary to match on the tuple <code>(msg,env)</code> since it's just used directly, it was just the best name for the thing I could think of)</p>\n\n<p>If you change the order of the arguments to <code>taskHandler</code> you can get a very idiomatic Haskell solution with partial application:</p>\n\n<pre><code>taskHandler :: Channel -&gt; MVar () -&gt; (Message, Envelope) -&gt; IO ()\n\n...\n\nconsumeMsgs ch \"tasks\" Ack (taskHandler ch lock)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2299, "user_id": 1018290, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/113bcc8f198ab8a17839aab5f4f0776f?s=128&d=identicon&r=PG", "display_name": "Will Sewell", "link": "https://stackoverflow.com/users/1018290/will-sewell"}, "is_accepted": false, "score": 2, "last_activity_date": 1460832895, "creation_date": 1460832895, "answer_id": 36668337, "question_id": 36668276, "link": "https://stackoverflow.com/questions/36668276/pass-function-with-different-signature-than-is-expected/36668337#36668337", "title": "Pass function with different signature than is expected", "body": "<p>This is where partial application comes in.</p>\n\n<p>If you change the order of the arguments to</p>\n\n<pre><code>taskHandler :: Channel -&gt; MVar () -&gt; (Message, Envelope) -&gt; IO ()\n</code></pre>\n\n<p>Then you can partially apply <code>taskHandler</code> to just a <code>Channel</code> and an <code>MVar ()</code>, i.e. <code>taskHandler channel mvar</code>. This will return a new function which is precisely the type that <code>consumeMsgs</code> expects.</p>\n"}], "owner": {"reputation": 426, "user_id": 1324707, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/136032b0e1156db2d514866cc2b2dff1?s=128&d=identicon&r=PG", "display_name": "Kai", "link": "https://stackoverflow.com/users/1324707/kai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 36668328, "answer_count": 2, "score": 1, "last_activity_date": 1460832895, "creation_date": 1460832546, "question_id": 36668276, "link": "https://stackoverflow.com/questions/36668276/pass-function-with-different-signature-than-is-expected", "title": "Pass function with different signature than is expected", "body": "<p>I am using <a href=\"https://hackage.haskell.org/package/amqp\" rel=\"nofollow\">AMQP library for Haskell</a> in a message consuming console application. I am binding a message handler like this:</p>\n\n<pre><code>  consumeMsgs ch \"tasks\" Ack taskHandler\n</code></pre>\n\n<p>My problem is that <code>consumeMsgs</code> expects a message handler with this signature:</p>\n\n<pre><code>taskHandler :: (Message, Envelope) -&gt; IO ()\n</code></pre>\n\n<p>...but I need to pass in additional <code>Channel</code> and a <code>Lock</code> (<em><code>Channel</code> so I can publish the result to a different queue, <code>Lock</code> for printing to console</em>), like this:</p>\n\n<pre><code>taskHandler :: (Message, Envelope) -&gt; Channel -&gt; MVar () -&gt; IO ()\n</code></pre>\n\n<p>I come from Javascript land, but I don't expect a dirty solution like a global variable. What can be done here?</p>\n"}, {"tags": ["haskell", "type-inference"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1460831084, "post_id": 36667956, "comment_id": 60927896, "body": "The signature of <code>avgFunction</code> suggests that you convert somewhere from <code>a</code> to <code>b</code>. Where is this supposed to happen? At the moment you don&#39;t do a conversion anywhere, hence the error. BTW, a conversion from a general <code>Num</code> isn&#39;t <i>possible</i>. How do you \u201cconvert\u201d a complex number to a real one?"}, {"owner": {"reputation": 3340, "user_id": 1159192, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/f3ca25e72b9e02db94b198dacad7a3b8?s=128&d=identicon&r=PG", "display_name": "ControlAltDelete", "link": "https://stackoverflow.com/users/1159192/controlaltdelete"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1460831248, "post_id": 36667956, "comment_id": 60927961, "body": "Please see edits - Yea i would like to take in integers and end up with potentially a decimal average."}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 3, "last_activity_date": 1460841304, "last_edit_date": 1460841304, "creation_date": 1460832123, "answer_id": 36668188, "question_id": 36667956, "link": "https://stackoverflow.com/questions/36667956/haskell-inferred-type-error/36668188#36668188", "title": "Haskell Inferred Type Error", "body": "<ul>\n<li>The result of <code>sumtest a</code> has type <code>a</code>. We know this an <code>Integral</code> type. Hence a type that can <em>not</em> be divided...</li>\n<li>The result of <code>length a</code> has type <code>Int</code>. This is also an <code>Integral</code> type. (And possibly <code>a</code> is a different one.)</li>\n</ul>\n\n<p>So you're trying to divide two numbers, both of which have types that <em>can not</em> be divided. Well, that can't work, can it?</p>\n\n<p>Fortunately, you can convert numbers. Some languages actually do this implicitly (regularly leading to all kinds of havoc<sup>&dagger;</sup>), but not Haskell. Well, but it sure has <em>functions</em> to do it! <a href=\"https://www.haskell.org/hoogle/?hoogle=%28Integral+a%2C+Floating+b%29+%3D%3E+a+-%3E+b\" rel=\"nofollow\">hoogle is your friend</a>:</p>\n\n<pre><code>avgFunction a = fromIntegral (sumtest a) / fromIntegral (length a)\n</code></pre>\n\n<p><hr>\n<sup>&dagger;</sup><sub>Admittedly, it <em>is</em> sometimes just annoying to have to convert every <code>length</code> to <code>Int</code> or <code>Double</code>. And some conservative implicit conversions, like Python does, sure don't seem <em>too</em> bad. But <em>any</em> kind of implicit conversion would not work with a Hindley-Milner type system like Haskell's.</sub></p>\n\n<hr>\n\n<p>On another note: these constraints are actually unnecessarily strong. The following is sufficient:</p>\n\n<pre><code>avgFunction ::  (Real a, Fractional b) =&gt; [a] -&gt; b\navgFunction a = realToFrac (sumtest a) / realToFrac (length a)\n</code></pre>\n\n<p>This way, the function will also allow <code>Double</code> as the input, not just as the result. (And perhaps it's also easier to understand what's going on.)</p>\n"}, {"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1460841117, "post_id": 36669484, "comment_id": 60931140, "body": "Note that this restricts the function signature to <code>[Int] -&gt; b</code>."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 0, "last_activity_date": 1460839259, "last_edit_date": 1592644375, "creation_date": 1460839259, "answer_id": 36669484, "question_id": 36667956, "link": "https://stackoverflow.com/questions/36667956/haskell-inferred-type-error/36669484#36669484", "title": "Haskell Inferred Type Error", "body": "<p>(This is really a comment/enhancement of <a href=\"https://stackoverflow.com/a/36668188/1126841\">leftaroundabout's answer</a>, but really needs more formatting than comments allow.)</p>\n<hr />\n<p>The module <code>Data.Function</code> provides a function <code>on</code> which allows you to specify a function to apply to each of another function's arguments. In this case,</p>\n<pre><code>avgFunction a = (sumtest a) ./ (length a)\n                where (./) = (/) `on` fromIntegral\n</code></pre>\n<p>It's actually a little longer, but it's arguably clearer in the sense that the locally defined <code>./</code> operator allows you to focus the algorithm by abstracting away the type-conversion boilerplate code.</p>\n<hr />\n<p>And then there's also this fun little gem using <code>Control.Arrow</code>:</p>\n<pre><code>avgFunction = sum &amp;&amp;&amp; length &gt;&gt;&gt; uncurry ((/) `on` fromIntegral)\n</code></pre>\n"}], "owner": {"reputation": 3340, "user_id": 1159192, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/f3ca25e72b9e02db94b198dacad7a3b8?s=128&d=identicon&r=PG", "display_name": "ControlAltDelete", "link": "https://stackoverflow.com/users/1159192/controlaltdelete"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 36668188, "answer_count": 2, "score": 0, "last_activity_date": 1460841304, "creation_date": 1460830814, "last_edit_date": 1460833588, "question_id": 36667956, "link": "https://stackoverflow.com/questions/36667956/haskell-inferred-type-error", "title": "Haskell Inferred Type Error", "body": "<p>I am new to Haskell and am curious why this is causing an error.</p>\n\n<pre><code>sumtest :: (Real a) =&gt; [a] -&gt; a\nsumtest [] = 0\nsumtest (x:xs) = x + sumtest xs\n\navgFunction ::  (Integral a, Floating b) =&gt; [a] -&gt; b\navgFunction a = sumtest a / length a\n</code></pre>\n\n<p>Error</p>\n\n<pre><code>ERROR file:code/test1.hs:114  - Inferred type is not general enough\n*** Expression    : avgFunction\n*** Expected type : (Integral a, Floating b) =&gt; [a] -&gt; b\n*** Inferred type : (Integral Int, Floating Int) =&gt; [Int] -&gt; Int\n</code></pre>\n\n<p>----- Working Code Below Per Accepted Answer----</p>\n\n<pre><code>sumtest :: (Num a) =&gt; [a] -&gt; a\nsumtest [] = 0\nsumtest (x:xs) = x + sumtest xs\n\navgFunction ::  (Integral a, Floating b) =&gt; [a] -&gt; b\navgFunction a = fromIntegral (sumtest a) / fromIntegral (length a)\n</code></pre>\n"}, {"tags": ["haskell", "functor", "generic-programming"], "comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 1, "creation_date": 1460877483, "post_id": 36667541, "comment_id": 60938033, "body": "I don&#39;t really think that lists are indexed by numbers (this <code>Nothing</code> is rather ugly). To me a list <code>xs</code> is indexed by either <code>Fin (length xs)</code> or something like <a href=\"http://lpaste.net/160209\" rel=\"nofollow noreferrer\">this</a>. Then indices are simply positions in the corresponding container. For lists <code>Shape = \u2115</code> and <code>Position = Fin</code>, i.e. you get exactly <code>Fin (length xs)</code>, since the shape of a list is its length."}], "answers": [{"tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": false, "score": 5, "last_activity_date": 1460865252, "creation_date": 1460865252, "answer_id": 36672495, "question_id": 36667541, "link": "https://stackoverflow.com/questions/36667541/indexing-into-containers-the-mathematical-underpinnings/36672495#36672495", "title": "Indexing into containers: the mathematical underpinnings", "body": "<p>It seems like the index into the type is an index into the set of constructors, following by an index into the product representing that constructor. This can be implemented quite naturally with e.g. <a href=\"https://hackage.haskell.org/package/generics-sop\" rel=\"noreferrer\">generics-sop</a>.</p>\n\n<p>First you need a datatype to represent possible indices into a single element of the product. This could be an index pointing to an element of type <code>a</code>, \nor an index pointing to something of type <code>g b</code> - which requires an index pointing into <code>g</code> and an index pointing to an element of type <code>a</code> in <code>b</code>. This is encoded with the following type:</p>\n\n<pre><code>import Generics.SOP\n\ndata ArgIx f x x' where \n  Here :: ArgIx f x x \n  There :: (Generic (g x')) =&gt; Ix g -&gt; ArgIx f x x' -&gt; ArgIx f x (g x') \n\nnewtype Ix f = ...\n</code></pre>\n\n<p>The index itself is just a sum (implemented by <code>NS</code> for n-ary sum) of sums over the generic representation of the type (choice of constructor, choice of constructor element):</p>\n\n<pre><code>newtype Ix f = MkIx (forall x . NS (NS (ArgIx f x)) (Code (f x)))\n</code></pre>\n\n<p>You can write smart constructors for various indices: </p>\n\n<pre><code>listIx :: Natural -&gt; Ix [] \nlistIx 0 = MkIx $ S $ Z $ Z Here \nlistIx k = MkIx $ S $ Z $ S $ Z $ There (listIx (k-1)) Here  \n\ntreeIx :: [Bool] -&gt; Ix Tree \ntreeIx [] = MkIx $ S $ Z $ S $ Z Here \ntreeIx (b:bs) = \n  case b of \n    True -&gt; MkIx $ S $ Z $ Z $ There (treeIx bs) Here \n    False -&gt; MkIx $ S $ Z $ S $ S $ Z $ There (treeIx bs) Here \n\nroseIx :: [Natural] -&gt; Ix Rose \nroseIx [] = MkIx $ Z $ Z Here  \nroseIx (k:ks) = MkIx $ Z $ S $ Z $ There (listIx k) (There (roseIx ks) Here)\n</code></pre>\n\n<p>Note that e.g. in the list case, you cannot construct an (non-bottom) index pointing to the <code>[]</code> constructor - likewise for <code>Tree</code> and <code>Empty</code>, or constructors containing values whose type is not <code>a</code> or something containing some values of type <code>a</code>. The quantification in <code>MkIx</code> prevents the construction bad things like an index pointing to the first <code>Int</code> in <code>data X x = X Int x</code> where <code>x</code> is instantiated to <code>Int</code>. </p>\n\n<p>The implementation of the index function is fairly straightforward, even if the types are scary:</p>\n\n<pre><code>(!) :: (Generic (f x)) =&gt; f x -&gt; Ix f -&gt; Maybe x \n(!) arg (MkIx ix) = go (unSOP $ from arg) ix where \n\n  atIx :: a -&gt; ArgIx f x a -&gt; Maybe x \n  atIx a Here = Just a \n  atIx a (There ix0 ix1) = a ! ix0 &gt;&gt;= flip atIx ix1 \n\n  go :: (All SListI xss) =&gt; NS (NP I) xss -&gt; NS (NS (ArgIx f x)) xss -&gt; Maybe x \n  go (Z a) (Z b) = hcollapse $ hzipWith (\\(I x) -&gt; K . atIx x) a b \n  go (S x) (S x') = go x x' \n  go Z{} S{} = Nothing \n  go S{} Z{} = Nothing \n</code></pre>\n\n<p>The <code>go</code> function compares the constructor pointed to by the index and the actual constructor used by the type. If the constructors don't match, the indexing returns <code>Nothing</code>. If they do, the actual indexing is done - which is trivial in the case that the index points exactly <code>Here</code>, and in the case of some substructure, both indexing operations must succeed one after the other, which is handled by <code>&gt;&gt;=</code>. </p>\n\n<p>And a simple test:</p>\n\n<pre><code>&gt;map ((\"hello\" !) . listIx) [0..5]\n[Just 'h',Just 'e',Just 'l',Just 'l',Just 'o',Nothing]\n</code></pre>\n"}], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 242, "favorite_count": 5, "answer_count": 1, "score": 20, "last_activity_date": 1460966961, "creation_date": 1460828676, "last_edit_date": 1495540940, "question_id": 36667541, "link": "https://stackoverflow.com/questions/36667541/indexing-into-containers-the-mathematical-underpinnings", "title": "Indexing into containers: the mathematical underpinnings", "body": "<p>When you want to pull an element out of a data structure, you have to give its index. But the meaning of <em>index</em> depends on the data structure itself.</p>\n\n<pre><code>class Indexed f where\n    type Ix f\n    (!) :: f a -&gt; Ix f -&gt; Maybe a  -- indices can be out of bounds\n</code></pre>\n\n<p>For example...</p>\n\n<p>Elements in a list have numeric positions.</p>\n\n<pre><code>data Nat = Z | S Nat\ninstance Indexed [] where\n    type Ix [] = Nat\n    [] ! _ = Nothing\n    (x:_) ! Z = Just x\n    (_:xs) ! (S n) = xs ! n\n</code></pre>\n\n<p>Elements in a binary tree are identified by a sequence of directions.</p>\n\n<pre><code>data Tree a = Leaf | Node (Tree a) a (Tree a)\ndata TreeIx = Stop | GoL TreeIx | GoR TreeIx  -- equivalently [Bool]\ninstance Indexed Tree where\n    type Ix Tree = TreeIx\n    Leaf ! _ = Nothing\n    Node l x r ! Stop = Just x\n    Node l x r ! GoL i = l ! i\n    Node l x r ! GoR j = r ! j\n</code></pre>\n\n<p>Looking for something in a rose tree entails stepping down the levels one at a time by selecting a tree from the forest at each level.</p>\n\n<pre><code>data Rose a = Rose a [Rose a]  -- I don't even like ros\u00e9\ndata RoseIx = Top | Down Nat RoseIx  -- equivalently [Nat]\ninstance Indexed Rose where\n    type Ix Rose = RoseIx\n    Rose x ts ! Top = Just x\n    Rose x ts ! Down i j = ts ! i &gt;&gt;= (! j)\n</code></pre>\n\n<p>It seems that the index of a product type is a sum (telling you which arm of the product to look at), the index of an element is the unit type, and the index of a nested type is a product (telling you where to look in the nested type). Sums seem to be the only one which aren't somehow linked to the <a href=\"https://stackoverflow.com/questions/25554062/zipper-comonads-generically\">derivative</a>. The index of a sum is also a sum - it tells you which part of the sum the user is hoping to find, and if that expectation is violated you're left with a handful of <code>Nothing</code>.</p>\n\n<p>In fact I had some success implementing <code>!</code> generically for functors defined as the fixed point of a polynomial bifunctor. I won't go into detail, but <code>Fix f</code> can be made an instance of <code>Indexed</code> when <code>f</code> is an instance of <code>Indexed2</code>...</p>\n\n<pre><code>class Indexed2 f where\n    type IxA f\n    type IxB f\n    ixA :: f a b -&gt; IxA f -&gt; Maybe a\n    ixB :: f a b -&gt; IxB f -&gt; Maybe b\n</code></pre>\n\n<p>... and it turns out you can define an instance of <code>Indexed2</code> for each of the bifunctor building blocks.</p>\n\n<p>But what's really going on? What is the underlying relationship between a functor and its index? How does it relate to the functor's derivative? Does one need to understand the <a href=\"https://en.wikipedia.org/wiki/Container_(type_theory)\" rel=\"nofollow noreferrer\">theory of containers</a> (which I don't, really) to answer this question?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 4, "creation_date": 1460828281, "post_id": 36667293, "comment_id": 60926799, "body": "An infinite list concatenated with a finite list is infinite the same way the first list is infinite. List are not ordinal numbers, there&#39;s no different kinds of infinities there. There is no last element in <code>[1..]++[0]</code>."}, {"owner": {"reputation": 16690, "user_id": 234248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2e3e7f03ab2e85c1be14975ebc9945bf?s=128&d=identicon&r=PG", "display_name": "mykhal", "link": "https://stackoverflow.com/users/234248/mykhal"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1460828576, "post_id": 36667293, "comment_id": 60926942, "body": "I&#39;m adding a quiestion, which might clear why I am asking that question.."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1460829181, "post_id": 36667293, "comment_id": 60927166, "body": "Please add all info relevant to this question to the question itself."}, {"owner": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 4, "creation_date": 1460829523, "post_id": 36667293, "comment_id": 60927290, "body": "Haskell is cool -- but it doesn&#39;t do transfinite ordinals -- <i>without</i> you doing the necessary work of deciding how to represent them and writng functions to work with them."}, {"owner": {"reputation": 116, "user_id": 2526001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b40226907e5dbdd4b0a8b94d59e374c?s=128&d=identicon&r=PG", "display_name": "Sergei Iashin", "link": "https://stackoverflow.com/users/2526001/sergei-iashin"}, "edited": false, "score": 0, "creation_date": 1460829729, "post_id": 36667293, "comment_id": 60927361, "body": "An infinite list concatenated with a finite list - is infinite list. While at the infinite list you can`t get the final (last) element, it is his property."}, {"owner": {"reputation": 16690, "user_id": 234248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2e3e7f03ab2e85c1be14975ebc9945bf?s=128&d=identicon&r=PG", "display_name": "mykhal", "link": "https://stackoverflow.com/users/234248/mykhal"}, "reply_to_user": {"reputation": 45920, "user_id": 4996248, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IUaWZ.jpg?s=128&g=1", "display_name": "John Coleman", "link": "https://stackoverflow.com/users/4996248/john-coleman"}, "edited": false, "score": 0, "creation_date": 1460829867, "post_id": 36667293, "comment_id": 60927410, "body": "@JohnColeman, thanks for naming the problem, whatever that name means.. :) so, .. who does them (transfinite ordinals), and why don&#39;t you make a regular answer? I might get it: it might be LONG"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1460830473, "post_id": 36667293, "comment_id": 60927641, "body": "the last element of a list which is one element longer than infinity... what is it, you ask? yes, when you &quot;define&quot; such a list you refer to that element, but <i>is</i> it really the last element of a list which has no last element at all, being infinite? You do <i>not</i> in fact define a list which is one element longer than infinity; but just a list that is infinite."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1460834021, "post_id": 36667293, "comment_id": 60928916, "body": "Regarding your edit, why should the internal representation accommodate mathematically undefined lists? If you want to make up a definition for appending to an infinite list, you can do so yourself; don&#39;t expect the language to anticipate your definition."}, {"owner": {"reputation": 16690, "user_id": 234248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2e3e7f03ab2e85c1be14975ebc9945bf?s=128&d=identicon&r=PG", "display_name": "mykhal", "link": "https://stackoverflow.com/users/234248/mykhal"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1460839159, "post_id": 36667293, "comment_id": 60930578, "body": "@chepner, appending itself obviously was not the problem."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 1, "creation_date": 1460881011, "post_id": 36667293, "comment_id": 60938841, "body": "You can do this with <a href=\"https://hackage.haskell.org/package/fmlist-0.9/docs/Data-FMList.html\" rel=\"nofollow noreferrer\"><code>FMList</code></a>s."}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 5, "last_activity_date": 1460829764, "creation_date": 1460829764, "answer_id": 36667735, "question_id": 36667293, "link": "https://stackoverflow.com/questions/36667293/how-to-get-last-items-of-infinite-list-concatenated-with-finite-list-in-haskell/36667735#36667735", "title": "How to get last items of infinite list concatenated with finite list in Haskell?", "body": "<p>You can't in general find &ldquo;Haskell's internal representation&rdquo; for any expression. The Haskell standard defines no such thing as an internal representation; it's up to the compiler to choose one.</p>\n\n<p>In a na&iuml;ve implementation, <code>[1..] ++ [0]</code> would sure enough be represented as a thunk pointing to two different lists. However, no matter how many elements you pop off the result, you will always take from the first, infinite list (the standard does guarantee <em>that</em>). So the compiler is perfectly free to optimise the <code>++ [0]</code> away altogether, because it can provenly make no difference to the outcome.</p>\n\n<p>If you actually need to store multiple lists of possibly infinite length and access the head of more than one of them, well, make it explicit! For instance just use a nested list <code>[[1..], [0]]</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 4, "last_activity_date": 1460887641, "last_edit_date": 1460887641, "creation_date": 1460843647, "answer_id": 36670227, "question_id": 36667293, "link": "https://stackoverflow.com/questions/36667293/how-to-get-last-items-of-infinite-list-concatenated-with-finite-list-in-haskell/36670227#36670227", "title": "How to get last items of infinite list concatenated with finite list in Haskell?", "body": "<p>Whatever the internal representation of an append operation <code>++</code> is, it has to conform to the language definition.</p>\n\n<p><a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch20.html#x28-22900020.1\" rel=\"nofollow\">Haskell 2010 Language Report specifies</a>:</p>\n\n<blockquote>\n  <p><code>(++) :: [a] -&gt; [a] -&gt; [a]</code>  </p>\n  \n  <p>Append two lists, i.e.,  </p>\n\n<pre><code>  [x1, ..., xm] ++ [y1, ..., yn] == [x1, ..., xm, y1, ..., yn]   \n  [x1, ..., xm] ++ [y1, ...] == [x1, ..., xm, y1, ...]  \n</code></pre>\n  \n  <p>If the first list is not finite, the result is the first list.</p>\n</blockquote>\n\n<p>Yes, you could try to define it differently, like some bona fide object in memory  holding its argument lists, responding to different requests like <code>head</code> or <code>last</code> in specific ways, aiming to get the law of</p>\n\n<pre><code>last (xs ++ ys) == last ys\n</code></pre>\n\n<p>to hold; but that is just not Haskell. </p>\n"}, {"tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": false, "score": 1, "last_activity_date": 1460891007, "last_edit_date": 1495540360, "creation_date": 1460891007, "answer_id": 36675666, "question_id": 36667293, "link": "https://stackoverflow.com/questions/36667293/how-to-get-last-items-of-infinite-list-concatenated-with-finite-list-in-haskell/36675666#36675666", "title": "How to get last items of infinite list concatenated with finite list in Haskell?", "body": "<p>Lists in Haskell are left-biased, so in order to get the last element of a list you have to traverse the whole spine, but <a href=\"https://hackage.haskell.org/package/fmlist-0.9/docs/Data-FMList.html\" rel=\"nofollow noreferrer\">lists defined as free monoids</a> are unbiased and hence</p>\n\n<pre><code>last $ fromList [1..] `append` fromList [0]\n</code></pre>\n\n<p>computes to <code>0</code>. But such lists have their own <a href=\"https://stackoverflow.com/questions/27381133/list-based-on-right-kan-extension\">problems</a>.</p>\n"}], "owner": {"reputation": 16690, "user_id": 234248, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/2e3e7f03ab2e85c1be14975ebc9945bf?s=128&d=identicon&r=PG", "display_name": "mykhal", "link": "https://stackoverflow.com/users/234248/mykhal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 396, "favorite_count": 0, "accepted_answer_id": 36670227, "answer_count": 3, "score": 2, "last_activity_date": 1460891007, "creation_date": 1460827333, "last_edit_date": 1460829427, "question_id": 36667293, "link": "https://stackoverflow.com/questions/36667293/how-to-get-last-items-of-infinite-list-concatenated-with-finite-list-in-haskell", "title": "How to get last items of infinite list concatenated with finite list in Haskell?", "body": "<p>In Haskell, how to efficiently get the last item(s) of an infinite list concatenated with a finite list?</p>\n\n<p><code>last</code> does not work, it obviously iterates from the head, so the following never finishes:\n</p>\n\n<pre><code>-- let's have a list of all natural numbers,\n-- with zero appended\narr = [1..] ++ [0]\n-- it was fast! now get the last item, should be easy\nres = last arr\n</code></pre>\n\n<p><strong>EDIT</strong>: I wonder what is the Haskell's internal representation of <code>[1..] ++ [0]</code>, is it initially \"totally unevaluated\"? If it would <strong>internally</strong> represent it like a \"sequence\" of two (unevaluated) lists, the <code>last</code> function could just get the last item of the last item, immediately.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 3040, "user_id": 4308453, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc596d8352ad2c4254536343139b5b82?s=128&d=identicon&r=PG&f=1", "display_name": "zakyggaps", "link": "https://stackoverflow.com/users/4308453/zakyggaps"}, "is_accepted": true, "score": 3, "last_activity_date": 1460829501, "creation_date": 1460829501, "answer_id": 36667697, "question_id": 36667163, "link": "https://stackoverflow.com/questions/36667163/minecraft-server-manager/36667697#36667697", "title": "Minecraft server manager", "body": "<p>You didn't flush the pipe, due to the lazyness of <code>IO</code> actions the program silently terminate before <code>hPutStr</code> has a chance to do its job.</p>\n\n<p>Try add this line after <code>hPutStr hin \"stop\"</code>:</p>\n\n<pre><code>hFlush hin\n</code></pre>\n"}], "owner": {"reputation": 675, "user_id": 4784666, "user_type": "registered", "accept_rate": 79, "profile_image": "https://lh3.googleusercontent.com/-Mb9XpU7rE_o/AAAAAAAAAAI/AAAAAAAAABE/KbF_UYZ95wQ/photo.jpg?sz=128", "display_name": "Martin Fischer", "link": "https://stackoverflow.com/users/4784666/martin-fischer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 36667697, "answer_count": 1, "score": 1, "last_activity_date": 1460829501, "creation_date": 1460826594, "question_id": 36667163, "link": "https://stackoverflow.com/questions/36667163/minecraft-server-manager", "title": "Minecraft server manager", "body": "<p>I wanna write a Haskell script which handles interaction with a minecraft server.</p>\n\n<p>To send commands to the server, I have a file <code>server.cmd</code> where in the first line 1 command can be written which should be executed in the server (e.g. <code>stop</code>).</p>\n\n<p>So, here is my code:</p>\n\n<pre><code>-- servermanager.hs\n\n{-# OPTIONS_GHC -fno-warn-warnings-deprecations #-}\n\nmodule ServerManager where\n\nimport System.Process\nimport System.Exit\nimport GHC.IO.Handle\nimport Control.Monad\nimport System.Posix.Unistd\n\nmanagerfile :: FilePath\nmanagerfile = \"manager.cmd\"\n\nserverfile :: FilePath\nserverfile = \"server.cmd\"\n\nmain :: IO ()\nmain = do\n  (Just hin, _, _, _) &lt;- createProcess (proc \"java\" [\"-jar\", \"minecraft_server.1.8.9.jar\", \"nogui\"]) {cwd = Just \"/home/tekkkz/Downloads\", std_in = CreatePipe, std_out = CreatePipe}\n  sleep 20\n  servercmd &lt;- readFile serverfile\n  case servercmd of\n    \"stop\" -&gt; do\n      putStrLn \"&gt;&gt; [S] Stop\"\n      hPutStr hin \"stop\"\n    _ -&gt; return ()\n</code></pre>\n\n<p>When there is \"stop\" in my server.cmd file, it print's out the string but is not stopping the server ... why not?</p>\n"}, {"tags": ["list", "haskell", "filter", "io"], "comments": [{"owner": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "edited": false, "score": 2, "creation_date": 1460826189, "post_id": 36667026, "comment_id": 60925995, "body": "As soon as you&#39;ve reached <code>dropEmpty</code> you&#39;re outside of IO and only need to concern yourself with pure Haskell. So, just filter it like a normal list."}, {"owner": {"reputation": 573, "user_id": 1485641, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/DZfVI.jpg?s=128&g=1", "display_name": "Bruno", "link": "https://stackoverflow.com/users/1485641/bruno"}, "edited": false, "score": 0, "creation_date": 1461185430, "post_id": 36667026, "comment_id": 61090087, "body": "Your dropEmpty function is correct. Keep in mind that Haskell&#39;s list are immutable so your dropEmpty input list isn&#39;t modified, you have to check the result of the function"}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 5525481, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8f03ae342914dcc7d1ed0ccbf4b00ace?s=128&d=identicon&r=PG&f=1", "display_name": "NorwegianViking", "link": "https://stackoverflow.com/users/5525481/norwegianviking"}, "edited": false, "score": 0, "creation_date": 1460967014, "post_id": 36668923, "comment_id": 60965648, "body": "Thank you! I will be able to figure it out now"}], "tags": [], "owner": {"reputation": 573, "user_id": 1485641, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/DZfVI.jpg?s=128&g=1", "display_name": "Bruno", "link": "https://stackoverflow.com/users/1485641/bruno"}, "is_accepted": false, "score": 1, "last_activity_date": 1460836130, "creation_date": 1460836130, "answer_id": 36668923, "question_id": 36667026, "link": "https://stackoverflow.com/questions/36667026/haskell-i-o-filtering-empty-lists-in-csv-data-set/36668923#36668923", "title": "Haskell I/O: Filtering empty lists in CSV data-set", "body": "<p>The do keyword is just a sugar syntax for monads</p>\n\n<p>Monad are defined like this: </p>\n\n<pre><code>class Monad m where\n  (&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b\n  return :: a -&gt; m a\n</code></pre>\n\n<p>Your <code>getRawData</code> function is equivalent to </p>\n\n<pre><code>getRawData fn = getRawData' fn &gt;&gt;= \\d -&gt; return (dropEmpty d)\n</code></pre>\n\n<p>As you can see in the monad definition, the second argument of <code>&gt;&gt;=</code> is the inner type of the monad, in your case, it's <code>[[String]]</code></p>\n\n<p>So there is nothing wrong with your code, you can use your dropEmpty without worrying about IO</p>\n"}, {"comments": [{"owner": {"reputation": 21, "user_id": 5525481, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8f03ae342914dcc7d1ed0ccbf4b00ace?s=128&d=identicon&r=PG&f=1", "display_name": "NorwegianViking", "link": "https://stackoverflow.com/users/5525481/norwegianviking"}, "edited": false, "score": 0, "creation_date": 1460966972, "post_id": 36682373, "comment_id": 60965627, "body": "Thanks alot :) I think I will be able to make sense out of this!"}], "tags": [], "owner": {"reputation": 689, "user_id": 6217179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/633461a7b7bd893feebbc9285d0fb049?s=128&d=identicon&r=PG&f=1", "display_name": "sapanoia", "link": "https://stackoverflow.com/users/6217179/sapanoia"}, "is_accepted": false, "score": 1, "last_activity_date": 1461001635, "last_edit_date": 1461001635, "creation_date": 1460928006, "answer_id": 36682373, "question_id": 36667026, "link": "https://stackoverflow.com/questions/36667026/haskell-i-o-filtering-empty-lists-in-csv-data-set/36682373#36682373", "title": "Haskell I/O: Filtering empty lists in CSV data-set", "body": "<pre><code>getRawData :: String -&gt; IO [[String]]\ngetRawData fn = do\n  d &lt;- getRawData' fn\n  return (dropEmpty d)\n</code></pre>\n\n<p><code>getRawData</code> and <code>return</code> are the monadic actions in this <strong>do</strong> block. All other expressions do not have the <strong>IO</strong> type.</p>\n\n<p>In particular, the expression to the left of <code>&lt;-</code>, namely <strong>d</strong>, has just the plain type <code>[[String]]</code>. All parameters, namely <code>fn :: String</code> and <code>(dropEmpty d) :: [[String]]</code>, are also not in <strong>IO</strong>.</p>\n\n<p>So you can get non-monadic values (e.g. <code>d</code>) out of the monadic actions (e.g. <code>getRawData'</code>) easily. However, you can only do so temporarily: You cannot make <code>d</code> escape the <strong>do</strong> block, only <code>IO d</code>. This is a \"core feature\" of monads in general.</p>\n\n<p>This is only a very superficial explanation to give you a quick start on monadic code. I recommend you read up on monads. Learn how monads are desugared. Take the <code>state</code> monad for example, and understand what problem it solves by trying to re-implement it.</p>\n"}], "owner": {"reputation": 21, "user_id": 5525481, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/8f03ae342914dcc7d1ed0ccbf4b00ace?s=128&d=identicon&r=PG&f=1", "display_name": "NorwegianViking", "link": "https://stackoverflow.com/users/5525481/norwegianviking"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1461001635, "creation_date": 1460825834, "last_edit_date": 1460972941, "question_id": 36667026, "link": "https://stackoverflow.com/questions/36667026/haskell-i-o-filtering-empty-lists-in-csv-data-set", "title": "Haskell I/O: Filtering empty lists in CSV data-set", "body": "<p>Once again I'm stuck with haskell. This time I'm supposed to filter a CSV-dataset, using IO which I'm struggling to understand. Any additional related information is appreciated. </p>\n\n<p>The structure is predetermined, and to me it seems messy. Is this really how one should do it? (I still have to do it this way, so this is a little \"on the side\"-question). </p>\n\n<pre><code>getRawData' :: String -&gt; IO [[String]]\ngetRawData' fn = do\n    s &lt;- readFile fn \n    return $ parseCSVsimple s \n\n\n\ngetRawData :: String -&gt; IO [[String]]\ngetRawData fn = do\n    d &lt;- getRawData' fn\n    return (dropEmpty d)\n\n\n\ndropEmpty [[String]] -&gt; [[String]] \n</code></pre>\n\n<p><strong>DropEmpty - This is where I need help</strong> For a \"normal\" list I would just filter it straightforward, but this IO and different functions calling each other has me confused. </p>\n\n<p>Sorry for stupid questions, I've programmed for 8 months and had to use 6-7 languages since then. Any general information related to the question is very much appreciated as well. </p>\n\n<p>EDIT; FOLLOW-UP: </p>\n\n<p>Thanks to good answers I have improved my understanding and implemented the following code: </p>\n\n<pre><code>dropEmpty :: [[String]] -&gt; [[String]]\ndropEmpty = filter(not . null) \n</code></pre>\n\n<p>However, I still see empty lists in the list. Is this because I am checking if the whole list of lists is empty? How do I sepcify that I want to check the \"internal\" lists? </p>\n"}]