[{"tags": ["haskell", "tuples", "applicative"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 7, "creation_date": 1524701045, "post_id": 50032674, "comment_id": 87081966, "body": "I think it&#39;s a shame the original Q got deleted. I really hope that it&#39;s because the questioneer figured out his problem on his own, and not that he felt like we were piling on to him. (I personally felt everyone was being polite and trying to help, but things can get lost in translation on the internet, and words have a tendency to hurt people&#39;s feelings even unintentionally. If you&#39;re reading this, SeanD, I apologise if I came over as rude or condescending.)"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1524704194, "post_id": 50032674, "comment_id": 87082749, "body": "Let me add that I entirely agree with @BenjaminHodgson on that."}, {"owner": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "edited": false, "score": 1, "creation_date": 1524726301, "post_id": 50032674, "comment_id": 87089631, "body": "There is also <a href=\"https://hackage.haskell.org/package/fixed-vector\" rel=\"nofollow noreferrer\">fixed-vector</a> package"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1524747100, "post_id": 50032674, "comment_id": 87102945, "body": "Now the previous question has been undeleted. It&#39;s a bit weird to undelete a question when the asker was the deleter -- in some cases, it feels bad to override their own choice. However, SO lets us do it, and in this case I think (hope?) it was justified."}, {"owner": {"reputation": 361, "user_id": 5327391, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/fd6737949d4afa42fc802236da015dea?s=128&d=identicon&r=PG", "display_name": "Sean D", "link": "https://stackoverflow.com/users/5327391/sean-d"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1524768950, "post_id": 50032674, "comment_id": 87116442, "body": "@BenjaminHodgson I honestly believe the intent was good, but I thought the discussion was just unproductive and I decided that that was my fault for not asking the question properly."}], "answers": [{"comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1524700268, "post_id": 50032675, "comment_id": 87081790, "body": "There&#39;s also <code>uncurry (***) :: (a -&gt; c, b -&gt; d) -&gt; (a, b) -&gt; (c, d)</code> but, like <code>Biapplicative</code>, that only works on pairs, so doesn&#39;t address the original now-deleted question."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1524700797, "post_id": 50032675, "comment_id": 87081902, "body": "@BenjaminHodgson In a similar spirit, it would be nice if <code>dup = id &amp;&amp;&amp; id</code> were defined in <code>Control.Arrow</code>, or somewhere similarly standard-ish. That way, I&#39;d be able to suggest <code>dup (+) &lt;&lt;*&gt;&gt; (1,2) &lt;&lt;*&gt;&gt; (3,4)</code> without a second thought."}], "tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 11, "last_activity_date": 1524699093, "last_edit_date": 1524699093, "creation_date": 1524698683, "answer_id": 50032675, "question_id": 50032674, "link": "https://stackoverflow.com/questions/50032674/is-there-a-zipwith-analogue-for-tuples/50032675#50032675", "title": "Is there a zipWith analogue for tuples?", "body": "<p>One option is using the <a href=\"https://hackage.haskell.org/package/tuples-homogenous-h98-0.1.1.0\" rel=\"noreferrer\"><em>tuples-homogenous-h98</em></a> package, which provides newtype wrappers for homogeneous tuples that have appropriate <code>Applicative</code> instances:</p>\n\n<pre><code>GHCi&gt; import Data.Tuple.Homogenous\nGHCi&gt; import Control.Applicative\nGHCi&gt; liftA2 (+) (Tuple2 (1,2)) (Tuple2 (3,4))\nTuple2 {untuple2 = (4,6)}\nGHCi&gt; (&gt;) &lt;$&gt; Tuple3 (7,4,7) &lt;*&gt; Tuple3 (6,6,6)\nTuple3 {untuple3 = (True,False,True)}\n</code></pre>\n\n<p>If you have a favourite homogenous tuple/fixed-size vector/fixed-size list library other than <em>tuples-homogenous-h98</em>, odds are that it will also have suitable <code>ZipList</code>-like <code>Applicative</code> instances.</p>\n\n<hr>\n\n<p>For a slightly different take on the matter when it comes to pairs, you might want to consider <a href=\"https://hackage.haskell.org/package/bifunctors-5.5.2/docs/Data-Biapplicative.html\" rel=\"noreferrer\"><code>Data.Biapplicative</code></a> from <em>bifunctors</em>:</p>\n\n<pre><code>GHCi&gt; import Data.Biapplicative\nGHCi&gt; bimap (+) (+) (1,2) &lt;&lt;*&gt;&gt; (3,4)\n(4,6)\n</code></pre>\n\n<p>One nice thing about this approach is that it can handle heterogeneous pairs:</p>\n\n<pre><code>GHCi&gt; bimap (+) (+) (1,2.5) &lt;&lt;*&gt;&gt; (3,4)\n(4,6.5)\nGHCi&gt; bimap (+) (++) (1,\"foo\") &lt;&lt;*&gt;&gt; (3,\"bar\")\n(4,\"foobar\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1524751222, "post_id": 50044839, "comment_id": 87106122, "body": "Nice; it is good to have a comprehensive generics-powered answer here."}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": false, "score": 6, "last_activity_date": 1524780595, "last_edit_date": 1524780595, "creation_date": 1524750831, "answer_id": 50044839, "question_id": 50032674, "link": "https://stackoverflow.com/questions/50032674/is-there-a-zipwith-analogue-for-tuples/50044839#50044839", "title": "Is there a zipWith analogue for tuples?", "body": "<p>Using GHC Generics, we can define operations that only depend on the structure of a type (the number of constructor and their arities).</p>\n\n<p>We want a function <code>zipWithP</code> that takes a function <code>f</code> and zips two tuples applying <code>f</code> between matching fields. Perhaps something with a signature matching this:</p>\n\n<pre><code>zipWithP\n  :: forall c s. _\n  =&gt; (forall s. c s =&gt; s -&gt; s -&gt; s) -&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>Here <code>f :: forall s. c s =&gt; s -&gt; s -&gt; s</code> is polymorphic, allowing the tuple to be heterogeneous, as long as the fields are all instances of <code>c</code>. That requirement will be captured by the <code>_</code> constraint, which is up to the implementation, as long as it works.</p>\n\n<p>There are libraries that capture common constructions, notably <a href=\"https://hackage.haskell.org/package/one-liner-1.0\" rel=\"nofollow noreferrer\"><em>one-liner</em></a> and <a href=\"https://hackage.haskell.org/package/generics-sop-0.3.2.0\" rel=\"nofollow noreferrer\"><em>generics-sop</em></a>.</p>\n\n<p>In increasing order of automation...</p>\n\n<hr>\n\n<p>The classical solution is to use the <a href=\"https://hackage.haskell.org/package/base-4.11.1.0/docs/GHC-Generics.html\" rel=\"nofollow noreferrer\"><code>GHC.Generics</code></a> module. A <code>Generic</code> instance represents an isomorphism between a user-defined type <code>a</code> and an \"generic representation\" <code>Rep a</code> associated with it.</p>\n\n<p>This generic representation is constructed from a fixed set of types defined in <a href=\"https://hackage.haskell.org/package/base-4.11.1.0/docs/GHC-Generics.html\" rel=\"nofollow noreferrer\"><code>GHC.Generics</code></a>. (The documentation of the module has more details about that representation.)</p>\n\n<p>The standard steps are:</p>\n\n<ol>\n<li><p>define functions on that fixed set of types (possibly a subset of it);</p></li>\n<li><p>adapt them to user-defined types by using the isomorphism given by a <code>Generic</code> instance.</p></li>\n</ol>\n\n<p>Step 1 is typically a type class. Here <code>GZipWith</code> is the class of generic representations that can be zipped. The type constructors handled here are, in decreasing order of importance:</p>\n\n<ul>\n<li><code>K1</code> represents fields (just apply <code>f</code>);</li>\n<li><code>(:*:)</code> represents type products (zip the operands separately);</li>\n<li>the <code>M1</code> newtype carries information at the type-level, that we aren't using here so we just wrap/unwrap with it;</li>\n<li><code>U1</code> represents nullary constructors, mostly for completeness.</li>\n</ul>\n\n<p>Step 2 defines <code>zipWithP</code> by composing <code>gZipWith</code> with <code>from</code>/<code>to</code> where appropriate.</p>\n\n<pre><code>{-# LANGUAGE AllowAmbiguousTypes #-}\n{-# LANGUAGE ConstraintKinds #-}\n{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE RankNTypes #-}\n{-# LANGUAGE TypeApplications #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE UndecidableInstances #-}\n\nimport GHC.Generics\n\nclass GZipWith c f where\n  gZipWith :: (forall s. c s =&gt; s -&gt; s -&gt; s) -&gt; f p -&gt; f p -&gt; f p\n\ninstance c a =&gt; GZipWith c (K1 _i a) where\n  gZipWith f (K1 a) (K1 b) = K1 (f a b)\n\ninstance (GZipWith c f, GZipWith c g) =&gt; GZipWith c (f :*: g) where\n  gZipWith f (a1 :*: a2) (b1 :*: b2) = gZipWith @c f a1 b1 :*: gZipWith @c f a2 b2\n\ninstance GZipWith c f =&gt; GZipWith c (M1 _i _c f) where\n  gZipWith f (M1 a) (M1 b) = M1 (gZipWith @c f a b)\n\ninstance GZipWith c U1 where\n  gZipWith _ _ _ = U1\n\nzipWithP\n  :: forall c a. (Generic a, GZipWith c (Rep a))\n  =&gt; (forall s. c s =&gt; s -&gt; s -&gt; s) -&gt; a -&gt; a -&gt; a\nzipWithP f a b = to (gZipWith @c f (from a) (from b))\n\nmain = do\n  print (zipWithP @Num (+) (1,2) (3,4) :: (Int, Integer))\n</code></pre>\n\n<hr>\n\n<p><a href=\"https://hackage.haskell.org/package/generics-sop-0.3.2.0\" rel=\"nofollow noreferrer\"><em>generics-sop</em></a> provides high-level combinators to program generically with operations that feel like <code>fmap</code>/<code>traverse</code>/<code>zip</code>...</p>\n\n<p>In this case, the relevant combinator is <code>hcliftA2</code>, which zips generic heterogeneous tuples of fields with a binary function. More explanations after the code.</p>\n\n<pre><code>{-# LANGUAGE AllowAmbiguousTypes #-}\n{-# LANGUAGE ConstraintKinds #-}\n{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE RankNTypes #-}\n{-# LANGUAGE TypeApplications #-}\n{-# LANGUAGE TypeFamilies #-}\n\nimport Control.Applicative (liftA2)\nimport Data.Proxy (Proxy(..))\nimport Generics.SOP\n\nzipWithP\n  :: forall c a k\n  .  (Generic a, Code a ~ '[k], All c k)\n  =&gt; (forall s. c s =&gt; s -&gt; s -&gt; s) -&gt; a -&gt; a -&gt; a\nzipWithP f x y =\n  case (from x, from y) of\n    (SOP (Z u), SOP (Z v)) -&gt;\n      to (SOP (Z (hcliftA2 (Proxy :: Proxy c) (liftA2 f) u v)))\n\nmain = do\n  print (zipWithP @Num (+) (1,2) (3,4) :: (Int, Integer))\n</code></pre>\n\n<p>Starting from the top of <code>zipWithP</code>.</p>\n\n<p>Constraints:</p>\n\n<ul>\n<li><code>Code a ~ '[k]</code>: <code>a</code> must be a single-constructor type (<code>Code a :: [[*]]</code> is the list of constructors of <code>a</code>, each given as the list of its fields).</li>\n<li><code>All c k</code>: all fields of the constructor <code>k</code> satisfy the constraint <code>c</code>.</li>\n</ul>\n\n<p>Body:</p>\n\n<ul>\n<li><code>from</code> maps from regular type <code>a</code> to a generic Sum Of Products (<code>SOP I (Code a)</code>).</li>\n<li>We assumed that the type <code>a</code> has a single constructor. We apply that knowledge by pattern-matching to get rid of the \"sum\" layer. We get <code>u</code> and <code>v</code>, whose types are <em>products</em> (<code>NP I k</code>).</li>\n<li>We apply <code>hcliftA2</code> to zip the two tuples <code>u</code> and <code>v</code>.</li>\n<li>Fields are wrapped in a type constructor <code>I</code>/<code>Identity</code> (<a href=\"https://www.benjamin.pizza/posts/2017-12-15-functor-functors.html\" rel=\"nofollow noreferrer\">functor-functor</a> or <a href=\"http://reasonablypolymorphic.com/blog/higher-kinded-data/\" rel=\"nofollow noreferrer\">HKD</a> style), hence there is also a <code>liftA2</code> layer on top of <code>f</code>.</li>\n<li>We get a new tuple, and go backwards from the first two steps, by applying constructors and <code>to</code> (the inverse of <code>from</code>).</li>\n</ul>\n\n<p>See the generics-sop documentation for more details.</p>\n\n<hr>\n\n<p><code>zipWithP</code> belongs to a class of operations that are commonly described by \"do this for each field\". <a href=\"https://hackage.haskell.org/package/one-liner\" rel=\"nofollow noreferrer\"><em>one-liner</em></a> exports operations, some of whose names may look familiar (<code>map...</code>, <code>traverse...</code>), that are essentially specializations of a single \"generalized traversal\" associated with any generic type.</p>\n\n<p>In particular, <code>zipWithP</code> is called <code>binaryOp</code>.</p>\n\n<pre><code>{-# LANGUAGE TypeApplications #-}\n\nimport Generics.OneLiner\n\nmain = print (binaryOp @Num (+) (1,2) (3,4) :: (Int, Integer))\n</code></pre>\n"}], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1266, "favorite_count": 0, "answer_count": 2, "score": 8, "last_activity_date": 1524780595, "creation_date": 1524698683, "question_id": 50032674, "link": "https://stackoverflow.com/questions/50032674/is-there-a-zipwith-analogue-for-tuples", "title": "Is there a zipWith analogue for tuples?", "body": "<p><em>Preliminary note: this is a respin of <a href=\"https://stackoverflow.com/q/50020370/2751851\">a deleted question by SeanD</a>.</em></p>\n\n<p>Just like there is <code>zipWith</code> for lists...</p>\n\n<pre><code>GHCi&gt; zipWith (+) [1,2] [3,4]\n[4,6]\n</code></pre>\n\n<p>... it feels like there should be something analogous for tuples, in the spirit of...</p>\n\n<pre><code>tupleZipWith (+) (1,2) (3,4)\n</code></pre>\n\n<p>... but there doesn't seem to be anything obviously like that in <em>base</em>. Which options do I have?</p>\n"}, {"tags": ["haskell", "fold"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 6, "creation_date": 1524691497, "post_id": 50031532, "comment_id": 87079222, "body": "Note that you aren&#39;t actually using <code>a</code> in the function you pass to <code>foldl</code>. <code>sum1</code> and <code>len1</code> are always <code>0</code>, because you defined them to be so."}, {"owner": {"reputation": 161, "user_id": 7916942, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/124af8fc95168eb085275c92f593dd95?s=128&d=identicon&r=PG&f=1", "display_name": "helloworld", "link": "https://stackoverflow.com/users/7916942/helloworld"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1524691640, "post_id": 50031532, "comment_id": 87079280, "body": "i originally had them as functions where sum1 a = sum1 + a and len1 = len1+ 1 but i was getting infinite type errors which makes sense sum1 is a function not a variable"}, {"owner": {"reputation": 789, "user_id": 8120642, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OX8-_3nAbeE/AAAAAAAAAAI/AAAAAAAAAAA/of7PUZBmbk4/photo.jpg?sz=128", "display_name": "hegel5000", "link": "https://stackoverflow.com/users/8120642/hegel5000"}, "edited": false, "score": 0, "creation_date": 1524691786, "post_id": 50031532, "comment_id": 87079325, "body": "Well that makes sense: if you want to compute the value of <code>sum1 + a</code>, then you have to look at the value of <code>sum1</code>, which is <code>sum1 + a</code>, which brings our total to to <code>sum1 + a + a</code>.  Next, you need to compute the value of <code>sum1</code> in <i>that</i> expression.  Ad infinitum."}, {"owner": {"reputation": 789, "user_id": 8120642, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OX8-_3nAbeE/AAAAAAAAAAI/AAAAAAAAAAA/of7PUZBmbk4/photo.jpg?sz=128", "display_name": "hegel5000", "link": "https://stackoverflow.com/users/8120642/hegel5000"}, "edited": false, "score": 0, "creation_date": 1524691923, "post_id": 50031532, "comment_id": 87079384, "body": "Anyways, there&#39;s a function called <a href=\"https://www.stackage.org/haddock/lts-11.6/base-4.10.1.0/Prelude.html#v:sum\" rel=\"nofollow noreferrer\">sum</a> and another one called <a href=\"https://www.stackage.org/haddock/lts-11.6/base-4.10.1.0/Prelude.html#v:length\" rel=\"nofollow noreferrer\">length</a> which each do exactly what they say on the tin."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1524692274, "post_id": 50031532, "comment_id": 87079518, "body": "<code>((sum1 + b),(len1 + 1))</code> is equivalent to <code>(b,1)</code>, according to the above definitions -- that can not work."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1524692393, "post_id": 50031532, "comment_id": 87079562, "body": "@helloworld: well writing things like <code>a = sum1 + a</code> does not makes any sense since variables in Haskell are <i>immutable</i>: you can not reassign them (in fact you can not assign them in the first place, only declare them)."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524692510, "post_id": 50031532, "comment_id": 87079615, "body": "Why are you by the way constantly talking about <code>foldr</code>, but use <code>foldl</code> in your code sample?"}, {"owner": {"reputation": 161, "user_id": 7916942, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/124af8fc95168eb085275c92f593dd95?s=128&d=identicon&r=PG&f=1", "display_name": "helloworld", "link": "https://stackoverflow.com/users/7916942/helloworld"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524693534, "post_id": 50031532, "comment_id": 87079965, "body": "@WillemVanOnsem sorry, i started initally wrote it with foldr but switched to foldl so i kept mixing the two up - i meant foldl"}], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 7916942, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/124af8fc95168eb085275c92f593dd95?s=128&d=identicon&r=PG&f=1", "display_name": "helloworld", "link": "https://stackoverflow.com/users/7916942/helloworld"}, "edited": false, "score": 0, "creation_date": 1524693383, "post_id": 50031723, "comment_id": 87079913, "body": "thank you for the explanation! that makes more sense to me now. im coming from java so im still getting used to not defining variables like i did above i guess."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1524697508, "post_id": 50031723, "comment_id": 87081120, "body": "<i>Caveat lector</i>: <code>foldl</code> almost always performs worse than its non-lazy sibling <code>foldl&#39;</code>. They behave the same, so for didactic purposes you needn&#39;t worry about it, but in production code you probably want <code>foldl&#39;</code>."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 6, "last_activity_date": 1524692328, "creation_date": 1524692328, "answer_id": 50031723, "question_id": 50031532, "link": "https://stackoverflow.com/questions/50031532/calculate-sum-and-length-of-a-list-simultaneously-with-foldl-and-a-tuple/50031723#50031723", "title": "Calculate sum and length of a list simultaneously with foldl and a tuple", "body": "<p>Well <code>foldl</code> has type <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:foldl\" rel=\"noreferrer\"><strong><code>foldl :: (a -&gt; b -&gt; a) -&gt; a -&gt; [b] -&gt; a</code></strong></a> with <code>a</code> the type of the accumulator (here a 2-tuple), and <code>b</code> the type of elements in the list.</p>\n\n<p>But in your <em>lambda expression</em> you write</p>\n\n<pre><code>\\a b -&gt; ((sum1 + b),(len1 + 1))\n</code></pre>\n\n<p>Note that here the variable <code>b</code> is an element of the list, and <code>a</code> is a tuple. But here you omit the accumulator. You always add <code>sum1</code> to <code>b</code>, but since <code>sum1</code>, is a constant, that is rather useless. The same for <code>len1</code>, as a result, you will always obtain a tuple that contains the <em>last</em> element of the list as first item, and <code>1</code> as second item.</p>\n\n<p>But based on your attempt, I think that you somehow aim to write \"imperative\" code in Haskell. Now in Haskell all variables are <em>immutable</em>, so setting <code>len1</code> to <code>0</code> (in the <code>where</code> clause), will result in the fact that <code>len1</code> is always <code>0</code>, etc. We do not change the accumulator, in fact <code>foldr</code> is a recursive function that each time calls itself with parameters with different values, and at the end returns the parameter we call the \"<em>accumulator</em>\".</p>\n\n<p>We can thus change the attempt to:</p>\n\n<pre><code>toTuple = (Fractional s, Fractional n) =&gt; [s] -&gt; (s, n)\ntoTuple = foldl (\\(cursum, curlen) b -&gt; (cursum + b, curlen + 1)) (0.0,0.0)\n</code></pre>\n\n<p>So here we each time pattern match the accumulator with <code>(cursum, curlen)</code> (containing the \"<em>current</em>\" (thus far) sum and length), and each time we construct a new tuple that contains the \"new\" current sum (the sum of the old sum and <code>b</code>), and the \"new\" current length (the length incremented with one).</p>\n\n<p>But it it still not very elegant: here the initial tuple has value <code>(0.0, 0.0)</code>, but as a result, you tell Haskell that this is a 2-tuple where both elements are <code>Fractional</code>s. Although this will probably work given there are no rounding errors, why restrict this to <code>Fractional</code>s? If you have a list of <code>Integer</code>s for example, we can sum these up without any rounding errors. By using <code>(0, 0)</code> as initial tuple, we make the tuple a 2-tuple where both elements have a type that belongs to the <code>Num</code> typeclass: so numbers. Note that the two do not <em>per se</em> have the same <code>Num</code> type, which is less restrictive.</p>\n\n<p>So now we got:</p>\n\n<pre><code>toTuple = (Num s, Num n) =&gt; [s] -&gt; (s, n)\ntoTuple = foldl (\\(cursum, curlen) b -&gt; (cursum + b, curlen + 1)) (0, 0)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 161, "user_id": 7916942, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/124af8fc95168eb085275c92f593dd95?s=128&d=identicon&r=PG&f=1", "display_name": "helloworld", "link": "https://stackoverflow.com/users/7916942/helloworld"}, "edited": false, "score": 0, "creation_date": 1524693120, "post_id": 50031749, "comment_id": 87079827, "body": "thinking of foldl visually like that is really helpful and clear, thanks for taking the time to explain it like that!"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 161, "user_id": 7916942, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/124af8fc95168eb085275c92f593dd95?s=128&d=identicon&r=PG&f=1", "display_name": "helloworld", "link": "https://stackoverflow.com/users/7916942/helloworld"}, "edited": false, "score": 0, "creation_date": 1524901663, "post_id": 50031749, "comment_id": 87164664, "body": "@helloworld: No problem. Please mark my or Willem Van Onsem\u2019s answer as the accepted answer if you feel it\u2019s adequately answered your question. :)"}], "tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": true, "score": 7, "last_activity_date": 1524693377, "last_edit_date": 1524693377, "creation_date": 1524692474, "answer_id": 50031749, "question_id": 50031532, "link": "https://stackoverflow.com/questions/50031532/calculate-sum-and-length-of-a-list-simultaneously-with-foldl-and-a-tuple/50031749#50031749", "title": "Calculate sum and length of a list simultaneously with foldl and a tuple", "body": "<p>It looks like you haven\u2019t built an intuition for folds yet. You can think of a fold like <code>foldl combine start input</code> as starting with some <code>start</code> value, then combining that value with each element of the <code>input</code> using the <code>combine</code> function. The function accepts the current \u201cstate\u201d and the next element of the list, and returns the updated state. So you are very close to a working solution:</p>\n\n<pre><code>toTuple xs = foldl (\\ (sum, len) x -&gt; (sum + x, len + 1)) (0, 0) xs\n</code></pre>\n\n<p>Stepping through an example input like <code>[1, 2, 3, 4]</code>, the state <code>(sum, len)</code>, usually called an \u201caccumulator\u201d, takes on the following values each time the folding function is called:</p>\n\n<pre><code>(0, 0)\n(0+1, 0+1)             = (1, 1)\n(0+1+2, 0+1+1)         = (3, 2)\n(0+1+2+3, 0+1+1+1)     = (6, 3)\n(0+1+2+3+4, 0+1+1+1+1) = (10, 4)\n</code></pre>\n\n<p>At no point are we modifying any variables, just calculating the <em>next</em> value of the sum and the length by combining the <em>current</em> partial sum &amp; length with each element of the list. For a left fold (<code>foldl</code>) that\u2019s done from left to right; for a right fold (<code>foldr</code>) it\u2019s from right to left, so the order of the parameters (<code>(sum, len)</code> and <code>x</code>) is reversed:</p>\n\n<pre><code>toTuple xs = foldr (\\ x (sum, len) -&gt; (sum + x, len + 1)) (0, 0) xs\n</code></pre>\n\n<p>However, for right folds, I find it easier to think of them as replacing all the <code>:</code> in a list with a function and replacing the <code>[]</code> with a value:</p>\n\n<pre><code>foldr f z [1, 2, 3, 4]\nfoldr f z (1 : (2 : (3 : (4 : []))))\n1 `f` (2 `f` (3 `f` (4 `f` z)))\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 7916942, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/124af8fc95168eb085275c92f593dd95?s=128&d=identicon&r=PG&f=1", "display_name": "helloworld", "link": "https://stackoverflow.com/users/7916942/helloworld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1564, "favorite_count": 0, "accepted_answer_id": 50031749, "answer_count": 2, "score": 2, "last_activity_date": 1524693377, "creation_date": 1524691249, "last_edit_date": 1524692474, "question_id": 50031532, "link": "https://stackoverflow.com/questions/50031532/calculate-sum-and-length-of-a-list-simultaneously-with-foldl-and-a-tuple", "title": "Calculate sum and length of a list simultaneously with foldl and a tuple", "body": "<p>I've been struggling with foldr for a while now. i want to convert a list of ints to a single tuple that contains the sum of list and number of ints. for example [1,2,3,4] -> (10,4) \nthe function i have below iterates through the list fine but only outputs the last element as the x val and 1 as the y val. </p>\n\n<pre><code>toTuple xs = let tuple = foldl (\\a b -&gt; ((sum1 + b),(len1 + 1))) (0.0,0.0) xs \n              in tuple   \n               where sum1 = 0\n                     len1 = 0  \n</code></pre>\n\n<p>i originally had sum1 and len1 as functions that take in an single int as an input but that didnt' work either so i changed them to variables initailized to 0. however it seems like its setting sum and len to 0 at every element in the list. any suggestions to modify this? thanks! </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1524686120, "post_id": 50030343, "comment_id": 87076753, "body": "I find the type signature for this rather odd, I would expect a list of 2-tuples."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524686302, "post_id": 50030343, "comment_id": 87076824, "body": "And once again, you write <code>[x:xs]</code>, where it should be <code>(x:xs)</code>, somehow, every other day, people make this mistake :("}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 1, "creation_date": 1524686685, "post_id": 50030343, "comment_id": 87077005, "body": "What is your question?"}, {"owner": {"reputation": 45, "user_id": 9303902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c65f1cea6c37b057c97dbabfd942d5ab?s=128&d=identicon&r=PG&f=1", "display_name": "YPFighter", "link": "https://stackoverflow.com/users/9303902/ypfighter"}, "edited": false, "score": 0, "creation_date": 1524686761, "post_id": 50030343, "comment_id": 87077035, "body": "I have tried to use (x:xs) instead, however, it still having an error"}, {"owner": {"reputation": 45, "user_id": 9303902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c65f1cea6c37b057c97dbabfd942d5ab?s=128&d=identicon&r=PG&f=1", "display_name": "YPFighter", "link": "https://stackoverflow.com/users/9303902/ypfighter"}, "edited": false, "score": 1, "creation_date": 1524686908, "post_id": 50030343, "comment_id": 87077097, "body": "My question is scanD not works as expected for recursively look for each sub list and apply the expand for each of them. How should I correct my code to become workable."}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1524687574, "post_id": 50030343, "comment_id": 87077414, "body": "What does &quot;I cannot deal with lists of list&quot; mean? If you got a compilation error, what did it say? What part of the error (if any) do you not understand? All this would be useful in your question."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1524687669, "post_id": 50030343, "comment_id": 87077454, "body": "Hint: Write a function that turns <code>[7,3]</code> into <code>[7,7,7]</code>, then use <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Prelude.html#v:concatMap\" rel=\"nofollow noreferrer\"><code>concatMap</code></a>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524687809, "post_id": 50030343, "comment_id": 87077515, "body": "@T.Tony: yes, there is still an error, since your first pattern is <code>[[]]</code> wich is <i>not</i> an empty list, but a list containing one element: the empty list."}], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 9303902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c65f1cea6c37b057c97dbabfd942d5ab?s=128&d=identicon&r=PG&f=1", "display_name": "YPFighter", "link": "https://stackoverflow.com/users/9303902/ypfighter"}, "edited": false, "score": 0, "creation_date": 1524692864, "post_id": 50030874, "comment_id": 87079729, "body": "May I ask you one more question? For the reverse one. [777888877] to [[7,3],[8,4],[7,7]]"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 45, "user_id": 9303902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c65f1cea6c37b057c97dbabfd942d5ab?s=128&d=identicon&r=PG&f=1", "display_name": "YPFighter", "link": "https://stackoverflow.com/users/9303902/ypfighter"}, "edited": false, "score": 0, "creation_date": 1524692891, "post_id": 50030874, "comment_id": 87079742, "body": "@T.Tony: feel free"}, {"owner": {"reputation": 45, "user_id": 9303902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c65f1cea6c37b057c97dbabfd942d5ab?s=128&d=identicon&r=PG&f=1", "display_name": "YPFighter", "link": "https://stackoverflow.com/users/9303902/ypfighter"}, "edited": false, "score": 0, "creation_date": 1524693012, "post_id": 50030874, "comment_id": 87079792, "body": "Can you see my coding from the above link?"}, {"owner": {"reputation": 45, "user_id": 9303902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c65f1cea6c37b057c97dbabfd942d5ab?s=128&d=identicon&r=PG&f=1", "display_name": "YPFighter", "link": "https://stackoverflow.com/users/9303902/ypfighter"}, "edited": false, "score": 0, "creation_date": 1524693106, "post_id": 50030874, "comment_id": 87079818, "body": "The count is to count for the number of first consecutive number while the shrink is to remove all the first consecutive number"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 45, "user_id": 9303902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c65f1cea6c37b057c97dbabfd942d5ab?s=128&d=identicon&r=PG&f=1", "display_name": "YPFighter", "link": "https://stackoverflow.com/users/9303902/ypfighter"}, "edited": false, "score": 0, "creation_date": 1524693230, "post_id": 50030874, "comment_id": 87079863, "body": "@T.Tony: here you need to use a colon, since you are constructing a list of lists, so <code>scanC (x:xs) = [x, count (x:xs)] : ...</code>. But there are still other errors, like non-exhaustive patterns, and the code is not very &quot;Haskellish&quot;."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 45, "user_id": 9303902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c65f1cea6c37b057c97dbabfd942d5ab?s=128&d=identicon&r=PG&f=1", "display_name": "YPFighter", "link": "https://stackoverflow.com/users/9303902/ypfighter"}, "edited": false, "score": 0, "creation_date": 1524693374, "post_id": 50030874, "comment_id": 87079909, "body": "@T.Tony: a hint is to turn on <code>-Wall</code> and look at the warnings, Haskell can detect non-exhaustive patterns in your own functions. Furthermore it is advisable not to use functions like <code>tail</code>, <code>head</code>, etc. since those are non-exhaustive."}, {"owner": {"reputation": 45, "user_id": 9303902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c65f1cea6c37b057c97dbabfd942d5ab?s=128&d=identicon&r=PG&f=1", "display_name": "YPFighter", "link": "https://stackoverflow.com/users/9303902/ypfighter"}, "edited": false, "score": 0, "creation_date": 1524693420, "post_id": 50030874, "comment_id": 87079922, "body": "Oh, I got when should I use colon and when should I use ++ now."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 45, "user_id": 9303902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c65f1cea6c37b057c97dbabfd942d5ab?s=128&d=identicon&r=PG&f=1", "display_name": "YPFighter", "link": "https://stackoverflow.com/users/9303902/ypfighter"}, "edited": false, "score": 0, "creation_date": 1524693463, "post_id": 50030874, "comment_id": 87079936, "body": "@T.Tony: or you wrap the first element in a list, but that would only result in more inefficiency."}, {"owner": {"reputation": 45, "user_id": 9303902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c65f1cea6c37b057c97dbabfd942d5ab?s=128&d=identicon&r=PG&f=1", "display_name": "YPFighter", "link": "https://stackoverflow.com/users/9303902/ypfighter"}, "edited": false, "score": 0, "creation_date": 1524693477, "post_id": 50030874, "comment_id": 87079940, "body": "Can you explain more what non-exhaustive means?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 45, "user_id": 9303902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c65f1cea6c37b057c97dbabfd942d5ab?s=128&d=identicon&r=PG&f=1", "display_name": "YPFighter", "link": "https://stackoverflow.com/users/9303902/ypfighter"}, "edited": false, "score": 0, "creation_date": 1524693547, "post_id": 50030874, "comment_id": 87079973, "body": "@T.Tony: if you have different constructors (for example a list has two constructors <code>[]</code> and <code>(:)</code>), then it checks if all the possible constructors as parameters are covered. Since in your function of <code>count</code>, you only define the case for <code>(x:xs)</code>, the <code>[]</code> data constructor is not handled."}, {"owner": {"reputation": 45, "user_id": 9303902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c65f1cea6c37b057c97dbabfd942d5ab?s=128&d=identicon&r=PG&f=1", "display_name": "YPFighter", "link": "https://stackoverflow.com/users/9303902/ypfighter"}, "edited": false, "score": 0, "creation_date": 1524693682, "post_id": 50030874, "comment_id": 87080009, "body": "In Haskell (i.e. count :: [Int] -&gt; Int) &lt;----- This line is act like a constructor?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 45, "user_id": 9303902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c65f1cea6c37b057c97dbabfd942d5ab?s=128&d=identicon&r=PG&f=1", "display_name": "YPFighter", "link": "https://stackoverflow.com/users/9303902/ypfighter"}, "edited": false, "score": 0, "creation_date": 1524693744, "post_id": 50030874, "comment_id": 87080022, "body": "@T.Tony: no a constructor is define at the <code>data</code> (and <code>newtype</code>) level, you can not define extra ones (see <a href=\"https://wiki.haskell.org/Constructor#Data_constructor\" rel=\"nofollow noreferrer\">wiki.haskell.org/Constructor#Data_constructor</a>)"}, {"owner": {"reputation": 45, "user_id": 9303902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c65f1cea6c37b057c97dbabfd942d5ab?s=128&d=identicon&r=PG&f=1", "display_name": "YPFighter", "link": "https://stackoverflow.com/users/9303902/ypfighter"}, "edited": false, "score": 0, "creation_date": 1524694036, "post_id": 50030874, "comment_id": 87080096, "body": "Then should I rewrite the count function?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 45, "user_id": 9303902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c65f1cea6c37b057c97dbabfd942d5ab?s=128&d=identicon&r=PG&f=1", "display_name": "YPFighter", "link": "https://stackoverflow.com/users/9303902/ypfighter"}, "edited": false, "score": 0, "creation_date": 1524694123, "post_id": 50030874, "comment_id": 87080130, "body": "@T.Tony: yes, since now for instance it does not handle the empty list case (nor does <code>counting</code>, and <code>shrink</code> do this). Usually it is better to implement <i>total</i> functions: functions that work on <i>all</i> possible input."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1524730061, "last_edit_date": 1524730061, "creation_date": 1524688323, "answer_id": 50030874, "question_id": 50030343, "link": "https://stackoverflow.com/questions/50030343/haskell-about-handling-lists-of-list-without-any-import/50030874#50030874", "title": "Haskell about handling lists of list without any import", "body": "<h1>Problems with <code>scanD</code></h1>\n\n<p>There are three errors with <code>scanD</code> here:</p>\n\n<ol>\n<li>your basecase uses the <code>[[]]</code> pattern, but this is <em>not</em> an empty list, but a singleton list (a list with one element): the empty list;</li>\n<li>your second pattern uses as pattern <code>[x:xs]</code>, which is short for <code>[(x:xs)]</code>, so here you have again a singleton list, where the list is non-empty; and</li>\n<li>the return type of <code>expand</code> is an <code>[Int]</code>, so we again build a list of lists.</li>\n</ol>\n\n<p>We can fix those errors by writing:</p>\n\n<pre><code>scanD :: [[Int]] -&gt; [Int]\nscanD [] = []\nscanD (x:xs) = expand x ++ scanD xs\n</code></pre>\n\n<p>So here we use <code>[]</code> as basecase, <code>(x:xs)</code> as inductive case, and we use <code>(++)</code> to concatenate the results of <code>expand</code> together.</p>\n\n<h1><code>concatMap</code></h1>\n\n<p>Nevertheless can make it more elegant: what we see here is a typical <code>map</code> operation where we later concatenate the results together. We can use <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Prelude.html#v:concatMap\" rel=\"nofollow noreferrer\"><strong><code>concatMap :: (a -&gt; [b]) -&gt; [a] -&gt; [b]</code></strong></a> for this:</p>\n\n<pre><code>scanD :: [[Int]] -&gt; [Int]\nscanD = concatMap expand\n</code></pre>\n\n<h1>Improving types</h1>\n\n<p>The types you use are however rather odd, do not provide much guarantees, and make the function more restrictive than necessary. A list can not give any guarantees about the length. As a result a user could call your <code>scanD</code> function with a list containing the empty list, a list with 3 elements, etc. In those cases your <code>expand</code> function will not be able to handle it properly. One of the reasons why programmers use types is to ensure at compile time that functions obtain parameters that are elements of a specific domain. Although types are sometimes too \"<em>coarse</em>\" to capture the set of allowed variables (and furthermore it would sometimes be impossible to prove that the output is always an element of such types, usually by writing a signature, you aim to restrictions to what a function can handle as possible. In your case your function does <em>not</em> hint that it takes a list of 2-item lists.</p>\n\n<p>Furthermore your function is rather restrictive: what if we wanted to <code>scanD</code> characters instead of <code>Int</code>s. Since you use a list, all elements in the list need to have the same type.</p>\n\n<p>A better type to encapsulate this, would be a list of 2-tuples: <code>[(a, Int)]</code> for example. In that case we can write it as:</p>\n\n<pre><code>scanD :: [(a, Int)] -&gt; [a]\nscanD = concatMap (uncurry (flip replicate))\n</code></pre>\n\n<p>we thus do not need to implement functions like <code>expand</code> and <code>expanding</code> anymore.</p>\n\n<p>We can then call it like:</p>\n\n<pre><code>Prelude&gt; scanD [(7,3),(8,5),(7,2)]\n[7,7,7,8,8,8,8,8,7,7]\n</code></pre>\n\n<p>But we can perform string processing as well:</p>\n\n<pre><code>Prelude&gt; scanD [('i',1),('a',4),('t',2), ('f', 5)]\n\"iaaaattfffff\"\n</code></pre>\n\n<p>In recent versions of <code>Data.List</code> module, <code>concatMap</code> has a more generic type signature, such that we can work with any <code>Foldable</code> type:</p>\n\n<pre><code>scanD :: Foldable t =&gt; t (a, Int) -&gt; [a]\nscanD = concatMap (uncurry (flip replicate))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "is_accepted": false, "score": 0, "last_activity_date": 1525119278, "creation_date": 1525119278, "answer_id": 50107590, "question_id": 50030343, "link": "https://stackoverflow.com/questions/50030343/haskell-about-handling-lists-of-list-without-any-import/50107590#50107590", "title": "Haskell about handling lists of list without any import", "body": "<p>If you are going to process lists with a number to represent repetitions then the list must be all numeric. This list compression can be easily modified to handle tuples and a tuple version follows the list version.</p>\n\n<pre><code>ls = [[7,3],[8,5],[7,2]]]\n\n[ [a|x&lt;-[1..b]] | (a:b:c)&lt;-ls]\n</code></pre>\n\n<p>The tuple version must have all one type of first element because a list is produced</p>\n\n<pre><code>tp = [('a',3),('b',5),('b',2)]\n\n[ [a|x&lt;-[1..b]] | (a,b)&lt;- tp]\n</code></pre>\n"}], "owner": {"reputation": 45, "user_id": 9303902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c65f1cea6c37b057c97dbabfd942d5ab?s=128&d=identicon&r=PG&f=1", "display_name": "YPFighter", "link": "https://stackoverflow.com/users/9303902/ypfighter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 50030874, "answer_count": 2, "score": 1, "last_activity_date": 1525119278, "creation_date": 1524686085, "last_edit_date": 1524687469, "question_id": 50030343, "link": "https://stackoverflow.com/questions/50030343/haskell-about-handling-lists-of-list-without-any-import", "title": "Haskell about handling lists of list without any import", "body": "<p>I am a totally new learner for Haskell:</p>\n\n<p>Target: For a given lists of list: <code>[[7,3],[8,5],[7,2]]</code>,\nOutput a expand list: <code>[7,7,7,8,8,8,8,8,7,7]</code></p>\n\n<p>Tasks: Writing two function: expand and scan to obtain the target</p>\n\n<p>Process: I wrote expand function and now doing the scan function</p>\n\n<pre><code>main= print(scanD [[7,3],[8,5],[7,2]]) \n\nexpanding :: Int -&gt; [Int] -&gt; [Int]\nexpanding y (n:ns)\n  | (n&gt;0) = y:expanding y (n-1:ns)\n  | otherwise = []\n\nexpand :: [Int] -&gt; [Int]\nexpand (x:xs) = expanding x xs\n\nscanD :: [[Int]]-&gt;[Int]\nscanD [[]] = []\nscanD [x:xs] = expand x : scanD xs\n</code></pre>\n\n<p>I am struggling on scan part since I cannot deal with lists of list.\nPlease help!</p>\n\n<p>My question is scanD not works as expected for recursively look for each sub list and apply the expand for each of them. How should I correct my code to become workable.</p>\n"}, {"tags": ["haskell", "gtk", "gtk3", "deprecation-warning"], "answers": [{"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": false, "score": 0, "last_activity_date": 1524714288, "creation_date": 1524714288, "answer_id": 50034499, "question_id": 50030340, "link": "https://stackoverflow.com/questions/50030340/sizing-child-elements-of-a-container-automatically-why-is-container-resize-chil/50034499#50034499", "title": "Sizing child elements of a container automatically (why is container_resize_children deprecated)", "body": "<p>Looking at the <a href=\"https://github.com/GNOME/gtk/blob/f5482e6954cb2aca70d14064ec28a3a38d1fd831/gtk/gtkcontainer.c#L2227\" rel=\"nofollow noreferrer\">implementation of <code>gtk_container_resize_children</code></a>, it seems you should be able to replace it with calls to <a href=\"https://developer.gnome.org/gtk3/stable/GtkWidget.html#gtk-widget-get-allocated-size\" rel=\"nofollow noreferrer\"><code>gtk_widget_get_allocated_size</code></a> and <a href=\"https://developer.gnome.org/gtk3/stable/GtkWidget.html#gtk-widget-size-allocate-with-baseline\" rel=\"nofollow noreferrer\"><code>gtk_widget_allocate_with_baseline</code></a>, neither of which is deprecated in GTK+ 3.</p>\n"}], "owner": {"reputation": 195, "user_id": 2042053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8269ce33797e5d4b2fbb726b6e790328?s=128&d=identicon&r=PG", "display_name": "imalison", "link": "https://stackoverflow.com/users/2042053/imalison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1524714288, "creation_date": 1524686044, "question_id": 50030340, "link": "https://stackoverflow.com/questions/50030340/sizing-child-elements-of-a-container-automatically-why-is-container-resize-chil", "title": "Sizing child elements of a container automatically (why is container_resize_children deprecated)", "body": "<p>I'm writing a system tray whose size is determined at runtime (and can possibly changed due to a resize), and I would like to size tray icons so that they expand to the size of the container object in which they are placed.</p>\n\n<p>I have actually gotten this to work in the following way registering for the size allocated signal for the gtk_image widget, and assigning to it a pixbuf with a size that matches the height allocated to this image widget in provided callback function.</p>\n\n<p>The only issue with this approach is that this does not seem to trigger a resize of the image widget (even if I explicitly call widget_set_size_request), which leads to this issue: <a href=\"https://i.stack.imgur.com/lKfms.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/lKfms.png\" alt=\"tray images overlap\"></a> Calls to widget_queue_draw or widget_queue_resize to both the image and the containing box do nothing to ameliorate this issue, but calling the deprecated function <code>gtk_container_resize_children</code> DOES fix the issue:\n<a href=\"https://i.stack.imgur.com/fp5Pu.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fp5Pu.png\" alt=\"enter image description here\"></a></p>\n\n<p>My questions are</p>\n\n<ul>\n<li>Why is gtk_container_resize_children deprecated?</li>\n<li>Is my approach of only actually setting the pixbuf for the image when the size allocate signal is received sound, or is there a better way of doing this?</li>\n<li>Why doesn't widget_queue_draw work here either?</li>\n</ul>\n\n<p>You can find the actual code in question here, but it is written in haskell, so may be difficult to understand if you are not familiar with the language:</p>\n\n<p><a href=\"https://github.com/IvanMalison/gtk-sni-tray/blob/4e7750b2893dc3c6c0091355f3c9b42ab35dcdf2/src/StatusNotifier/Tray.hs#L166\" rel=\"nofollow noreferrer\">https://github.com/IvanMalison/gtk-sni-tray/blob/4e7750b2893dc3c6c0091355f3c9b42ab35dcdf2/src/StatusNotifier/Tray.hs#L166</a></p>\n"}, {"tags": ["string", "haskell"], "comments": [{"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 0, "creation_date": 1524672870, "post_id": 50026883, "comment_id": 87070044, "body": "What do you want to happen if the number of characters is larger than the length of the string?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1524673018, "post_id": 50026883, "comment_id": 87070119, "body": "You are probably looking for <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Prelude.html#v:take\" rel=\"nofollow noreferrer\"><code>take</code></a>."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 2, "creation_date": 1524673276, "post_id": 50026883, "comment_id": 87070273, "body": "Haskell single-line comments are of the form <code>-- comment</code>, not <code>&#47;&#47; comment</code>. I&#39;ve edited your question to reflect that."}, {"owner": {"reputation": 43, "user_id": 7821431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uiKCH.png?s=128&g=1", "display_name": "MKB 06", "link": "https://stackoverflow.com/users/7821431/mkb-06"}, "edited": false, "score": 0, "creation_date": 1524673927, "post_id": 50026883, "comment_id": 87070652, "body": "Lee in my case this should not happen, but I think it should return the entire string"}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 3, "creation_date": 1524674516, "post_id": 50026883, "comment_id": 87070936, "body": "When faced with such a question, consider using <a href=\"https://www.haskell.org/hoogle/\" rel=\"nofollow noreferrer\">Hoogle</a> rather than resorting to Stack Overflow. Hoogle can point you to existing functions whose signature (<code>Int -&gt; String -&gt; String</code>, here) is as desired. Then, scan the search results for a function that exhibits the desired semantics. <a href=\"https://www.haskell.org/hoogle/?hoogle=Int+-%3E+String+-%3E+String\" rel=\"nofollow noreferrer\">In this case</a>, <code>take</code> is the fourth result down the list."}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 7821431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uiKCH.png?s=128&g=1", "display_name": "MKB 06", "link": "https://stackoverflow.com/users/7821431/mkb-06"}, "edited": false, "score": 0, "creation_date": 1524674036, "post_id": 50026936, "comment_id": 87070701, "body": "Thanks this is exactly what I wanted."}], "tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": true, "score": 5, "last_activity_date": 1524673304, "last_edit_date": 1524673304, "creation_date": 1524672922, "answer_id": 50026936, "question_id": 50026883, "link": "https://stackoverflow.com/questions/50026883/cut-first-x-characters-from-a-string-in-haskell/50026936#50026936", "title": "Cut first x characters from a String in Haskell", "body": "<p>See <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Prelude.html#v:take\" rel=\"noreferrer\"><code>take</code></a>:</p>\n\n\n\n<pre class=\"lang-hs prettyprint-override\"><code>take :: Int -&gt; [a] -&gt; [a]\n</code></pre>\n\n<blockquote>\n  <p><code>take n</code>, applied to a list <code>xs</code>, returns the prefix of <code>xs</code> of length <code>n</code>, or <code>xs</code> itself if <code>n &gt; length xs</code></p>\n</blockquote>\n\n<p>Using it in Prelude shows:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>Prelude&gt; take 3 \"Hello\"\n\"Hel\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": false, "score": 2, "last_activity_date": 1524682869, "creation_date": 1524682869, "answer_id": 50029601, "question_id": 50026883, "link": "https://stackoverflow.com/questions/50026883/cut-first-x-characters-from-a-string-in-haskell/50029601#50029601", "title": "Cut first x characters from a String in Haskell", "body": "<p>You can implement <code>take</code> yourself with explicit recursion:</p>\n\n<pre><code>-- note the signature here is less general than it need be:\n-- cutString :: Int -&gt; [a] -&gt; [a]\ncutString :: Int -&gt; String -&gt; String\ncutString 0 _      = []\ncutString n (x:xs)\n  | n &gt; 0     = x : cutString (n-1) xs\n  | otherwise = []\ncutString _ _      = []\n</code></pre>\n\n<p>The first alternation is your usual base case -- taking zero elements of anything is the empty string: <code>[]</code>.</p>\n\n<p>The second alternation is your recursive case. If n is zero, execution hits the first alternation, so we only have to worry about two cases here: either n is greater than zero in which case we give back one character and recurse with n-1, or n is less than zero in which case we catch the edge case and give back something sensible. Taking less than zero elements from a string isn't a sensible thing to do, so you could choose your response here -- <code>error</code> might be appropriate.</p>\n\n<p>The third alternation is the fallback and is another base case. If <code>n</code> is still not zero, but we've run out of items in the string, stop recursing and give back <code>[]</code>. Without this case, the code crashes on <code>cutString 100 \"Hello\"</code> (anything where <code>n &gt; length str</code>)</p>\n"}], "owner": {"reputation": 43, "user_id": 7821431, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uiKCH.png?s=128&g=1", "display_name": "MKB 06", "link": "https://stackoverflow.com/users/7821431/mkb-06"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3386, "favorite_count": 0, "accepted_answer_id": 50026936, "answer_count": 2, "score": 1, "last_activity_date": 1601294867, "creation_date": 1524672748, "last_edit_date": 1601294867, "question_id": 50026883, "link": "https://stackoverflow.com/questions/50026883/cut-first-x-characters-from-a-string-in-haskell", "title": "Cut first x characters from a String in Haskell", "body": "<p>I'm trying to create a function that concatenates parts of strings in a list to another. I already know how to select the strings I want but now I need the first part of them (and it's not always the same value).</p>\n<p>So I want to cut the first part of a string</p>\n<pre><code>-- here is a function that should take a string and the numbers\n-- of characters we want to take from the start\ncutString :: Int -&gt; String -&gt; String\ncutString x str = cut x str -- here's a way to take the first x characters\n</code></pre>\n<p>And the way to use it:</p>\n<pre><code>print (cutString 3 &quot;Hello World&quot;)\nOutput --&gt; &quot;Hel&quot;\n</code></pre>\n<p>Is there any simple ways to do that?</p>\n<p>Thanks for any help or advices.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 1, "creation_date": 1524672582, "post_id": 50026768, "comment_id": 87069880, "body": "Replace the final equation with <code>myzipWith func (x:xs) (y:ys) = func x y : myzipWith func xs ys</code>."}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 0, "creation_date": 1524673909, "post_id": 50026768, "comment_id": 87070636, "body": "There are good reasons to avoid <code>head</code> and <code>tail</code>. Let me ask, out of curiosity: were you given them?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1524674808, "post_id": 50026768, "comment_id": 87071066, "body": "Knowing how <code>head</code> and <code>tail</code> are defined should help: <code>head (x:_) = x</code> and <code>tail (_:xs) = xs</code>."}, {"owner": {"reputation": 73, "user_id": 7761918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VGjdT.png?s=128&g=1", "display_name": "chungonion", "link": "https://stackoverflow.com/users/7761918/chungonion"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1524689509, "post_id": 50026768, "comment_id": 87078329, "body": "@chepner I know the definition but I was just not so familiar how to deal with the input parameter (sry idk whether I have used a right term) alongside with the function signature. Thanks anyway :)"}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 6, "creation_date": 1524673040, "post_id": 50026829, "comment_id": 87070134, "body": "Also note that the pattern matching is not exhaustive, as turning on warnings should point out."}, {"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 2, "creation_date": 1524675857, "post_id": 50026829, "comment_id": 87071591, "body": "To deal with all the (three) edge cases elegantly, it&#39;s probably best to remove the first line of your definition and add <code>myzipWith _ _ _ = []</code> after the other line - &quot;given any lists that don&#39;t match, return <code>[]</code>&quot;."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1524677598, "post_id": 50026829, "comment_id": 87072511, "body": "While your suggestion is more idiomatic, it&#39;s not any more efficient, in fact i suspect it will generate exactly the same code, since <code>++</code> will be inlined."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 2, "creation_date": 1524682221, "post_id": 50026829, "comment_id": 87074885, "body": "@luqui, likely, with optimizations, but desugaring list literals to optimize well is all sorts of tricky. I wouldn&#39;t really want to rely on it when I don&#39;t have to."}, {"owner": {"reputation": 73, "user_id": 7761918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VGjdT.png?s=128&g=1", "display_name": "chungonion", "link": "https://stackoverflow.com/users/7761918/chungonion"}, "edited": false, "score": 0, "creation_date": 1524689604, "post_id": 50026829, "comment_id": 87078365, "body": "Hi guys, thanks for the comments, it was helpful and I have understand more on this subject :) Cheers :)"}], "tags": [], "owner": {"reputation": 1096, "user_id": 5021447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-gwPYP717ZyU/AAAAAAAAAAI/AAAAAAAAAP8/WoyhftM4PuU/photo.jpg?sz=128", "display_name": "Jordan Mackie", "link": "https://stackoverflow.com/users/5021447/jordan-mackie"}, "is_accepted": true, "score": 7, "last_activity_date": 1524672593, "creation_date": 1524672593, "answer_id": 50026829, "question_id": 50026768, "link": "https://stackoverflow.com/questions/50026768/haskell-how-should-i-avoid-head-or-tail-and-adopt-pattern-matching/50026829#50026829", "title": "Haskell -- How should I avoid head or tail, and adopt pattern matching?", "body": "<pre><code>myzipWith :: (a-&gt;b-&gt;c) -&gt; [a] -&gt; [b] -&gt;[c]\nmyzipWith func [] [] = []\nmyzipWith func (headA:restA) (headB:restB) =\n    [func headA headB] ++ myzipWith func restA restB\n</code></pre>\n\n<p>But note the append (<code>++</code>) isn't necessary. This would be more idiomatic (and efficient):</p>\n\n<pre><code>    func headA headB : myzipWith func restA restB\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 36141, "user_id": 4354477, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/SuxtS.gif?s=128&g=1", "display_name": "ForceBru", "link": "https://stackoverflow.com/users/4354477/forcebru"}, "is_accepted": false, "score": 4, "last_activity_date": 1524672601, "creation_date": 1524672601, "answer_id": 50026833, "question_id": 50026768, "link": "https://stackoverflow.com/questions/50026768/haskell-how-should-i-avoid-head-or-tail-and-adopt-pattern-matching/50026833#50026833", "title": "Haskell -- How should I avoid head or tail, and adopt pattern matching?", "body": "<pre><code>myzipWith func (a:as) (b:bs) = [func a b] ++ (myzipWith func as bs)\n</code></pre>\n\n<p>The syntax <code>function (x:xs)</code> splits the list passed to <code>function</code> into two parts: the first element <code>x</code> and the rest of the list <code>xs</code>.</p>\n"}], "owner": {"reputation": 73, "user_id": 7761918, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VGjdT.png?s=128&g=1", "display_name": "chungonion", "link": "https://stackoverflow.com/users/7761918/chungonion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 138, "favorite_count": 0, "accepted_answer_id": 50026829, "answer_count": 2, "score": 3, "last_activity_date": 1524672601, "creation_date": 1524672379, "question_id": 50026768, "link": "https://stackoverflow.com/questions/50026768/haskell-how-should-i-avoid-head-or-tail-and-adopt-pattern-matching", "title": "Haskell -- How should I avoid head or tail, and adopt pattern matching?", "body": "<p>I am a beginner in Haskell, and I have been told that I should avoid using head and tail for list operation and use pattern matching instead. I got a code snippet here, and I wonder how should this be converted so that no head or tail is used?</p>\n\n<pre><code>myzipWith :: (a-&gt;b-&gt;c) -&gt; [a] -&gt; [b] -&gt;[c]\nmyzipWith func [] [] = []\nmyzipWith func listA listB =\n    [func (head listA) (head listB) ] ++ (myzipWith func (tail listA) (tail listB))\n</code></pre>\n"}, {"tags": ["haskell", "io", "monads"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1524665391, "post_id": 50024114, "comment_id": 87064926, "body": "Before you start thinking about maybe using some kind of monad at some point in the future if the stars are just right, please explain what exactly <code>fmap waffles contents</code> does."}, {"owner": {"reputation": 1920, "user_id": 4841832, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/hD1nI.jpg?s=128&g=1", "display_name": "Jsevillamol", "link": "https://stackoverflow.com/users/4841832/jsevillamol"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1524665637, "post_id": 50024114, "comment_id": 87065084, "body": "@n.m. Well <code>contents</code> should be a <code>IO String</code> type, and <code>fmap</code> maps a function to affect the insides of a monad, right?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 3, "creation_date": 1524665742, "post_id": 50024114, "comment_id": 87065146, "body": "I&#39;ll give you a hint for the first error: because you&#39;re composing <code>tail</code> with <code>fmap</code>, the compiler assumes you meant <code>fmap</code> to refer to <code>[]</code>&#39;s version of <code>fmap</code> (<code>fmap lines :: [String] -&gt; [[String]]</code>), not <code>IO</code>&#39;s."}, {"owner": {"reputation": 1920, "user_id": 4841832, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/hD1nI.jpg?s=128&g=1", "display_name": "Jsevillamol", "link": "https://stackoverflow.com/users/4841832/jsevillamol"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1524665877, "post_id": 50024114, "comment_id": 87065235, "body": "@BenjaminHodgson yay progress! I substitued the first line to <code>contents &lt;- fmap tail . fmap lines . readFile $ &quot;testInput&quot;</code> and now that one seems to work"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1524666049, "post_id": 50024114, "comment_id": 87065360, "body": "Nice one! For the second error, have a think about what you expect the type of <code>contents</code> to be in the expression <code>fmap waffles contents</code>. (I wish Haskell had a decent interactive IDE so you could look at the types of variables in real time.)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1524667640, "post_id": 50024114, "comment_id": 87066516, "body": "@BenjaminHodgson ghci has a not-decent way of achieving that. For example, here if I <code>:set -fdefer-type-errors; :set +c; :l test.hs; :type-at test.hs 2 4 2 13</code> (that last command has format start-line, start-column, end-line, end-column) I get <code>:: [String]</code>. But it&#39;s super finicky, doesn&#39;t appear to coordinate well with <code>:r</code> (or even with later <code>:l</code> commands), and having to muck about in your editor to get line and column numbers sucks. The <code>:all-types</code> command is significantly more verbose and less interactive, but ironically is more usable in some ways..."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1524669289, "post_id": 50024114, "comment_id": 87067717, "body": "@DanielWagner Neat trick but not a very good UI! If the questioneer had been able to hover over an identifier and see a popup with the type, they probably would have been able to fix their own problem and wouldn\u2019t have needed to even come to Stack Overflow"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1524670501, "post_id": 50024114, "comment_id": 87068596, "body": "&quot;Well contents should be a IO String type&quot; Several errors here. One, the <code>&lt;-</code> you are using is not for nothing, it gets you inside the monad so you don&#39;t have to fmap over it yourself. Two, from <code>lines</code> you get a <code>[String]</code> not a <code>String</code>. Three, <code>waffles</code> accepts two arguments, how exactly do you plan to use it to map over a <code>String</code> (or <code>IO String</code>, or <code>[String]</code>, or whatever) ? Four, these arguments are numbers, you are not supposed to multiply strings."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1524682497, "post_id": 50024114, "comment_id": 87075022, "body": "@BenjaminHodgson For what it&#39;s worth, Emacs + Intero does that: when the cursor is on any variable, its type is shown. If you select a subexpression the type of that is shown. Errors and warnings are similarly shown when the cursor (or mouse pointer) is at the right spot."}], "answers": [{"comments": [{"owner": {"reputation": 16362, "user_id": 49220, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/431cd43aaf713caa80316e852a87a840?s=128&d=identicon&r=PG", "display_name": "Paul Johnson", "link": "https://stackoverflow.com/users/49220/paul-johnson"}, "edited": false, "score": 1, "creation_date": 1524672454, "post_id": 50024981, "comment_id": 87069810, "body": "The reason you need the &quot;fmap&quot; is that &quot;readFile&quot; gives you an &quot;IO String&quot; (i.e the string is inside the IO monad). You can&#39;t get the string out of the IO, but you can reach inside the IO and do stuff to the string in it, just like you can with any other container. &quot;fmap&quot; is the function that does this."}, {"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 0, "creation_date": 1524686473, "post_id": 50024981, "comment_id": 87076895, "body": "I think <code>fmap (tail . fmap)</code> is supposed to be <code>fmap (tail . lines)</code>."}, {"owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "reply_to_user": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 0, "creation_date": 1524688168, "post_id": 50024981, "comment_id": 87077697, "body": "Thanks @DarthFennec. I fixed the mistake"}], "tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": true, "score": 4, "last_activity_date": 1524688126, "last_edit_date": 1524688126, "creation_date": 1524666858, "answer_id": 50024981, "question_id": 50024114, "link": "https://stackoverflow.com/questions/50024114/using-the-do-statement-in-haskell/50024981#50024981", "title": "Using the do statement in Haskell", "body": "<p>The first line in your <code>do</code> statement fails because you are trying to use <code>tail</code> on an <code>IO [String]</code>. You need to <code>fmap</code> the <code>tail</code> function:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>contents &lt;- fmap tail . fmap lines . readFile $ \"testInput\"\n-- or....\ncontents &lt;- fmap (tail . lines) . readFile $ \"testInput\"\n</code></pre>\n\n<p>Now you need a way to get every other line from <code>contents</code>. You could define a simple <code>everyOther</code> function for this:</p>\n\n<pre><code>everyOther :: [a] -&gt; [a]\neveryOther (x:_:xs) = x : everyOther xs\neveryOther _        = []\n</code></pre>\n\n<p>And now you can chain that into your <code>fmap</code> in the first line:</p>\n\n<pre><code>contents &lt;- fmap (everyOther . tail . lines) . readFile $ \"testInput\"\n</code></pre>\n\n<p>Your <code>waffles</code> function of <code>(row - 1)*(col - 1)</code> does not seem related to what I believe the type signature should be. Try starting with a type signature and building <code>waffles</code> from their. Based on your description, you are simply providing every other line to the function, so it should have signature:</p>\n\n<pre><code>waffles :: String -&gt; String\n</code></pre>\n\n<p>Given that type signature for <code>waffles</code>, you can apply it via:</p>\n\n<pre><code>let result = fmap waffles contents\n</code></pre>\n\n<p>One more thing on the output: <code>concat</code> will smush all lines together. You probably want line breaks in there, so you might want to use <code>unlines</code> instead.</p>\n\n<pre><code>main = do\n    contents &lt;- fmap (everyOther . tail . lines) . readFile $ \"testInput\"\n    let result = fmap waffles contents\n    writeFile \"output.txt\" $ unlines result\n</code></pre>\n"}], "owner": {"reputation": 1920, "user_id": 4841832, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/hD1nI.jpg?s=128&g=1", "display_name": "Jsevillamol", "link": "https://stackoverflow.com/users/4841832/jsevillamol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 50024981, "answer_count": 1, "score": 2, "last_activity_date": 1524688126, "creation_date": 1524664328, "last_edit_date": 1524665106, "question_id": 50024114, "link": "https://stackoverflow.com/questions/50024114/using-the-do-statement-in-haskell", "title": "Using the do statement in Haskell", "body": "<p>Finally learning how to use monads in Haskell!</p>\n\n<p>I want to read a file <code>testInput</code>, drop the first line, apply the function <code>waffles</code> to every other line, and save the result in a file <code>output.txt</code>.</p>\n\n<p>I have written the following code:</p>\n\n<pre><code>main = do\n    contents &lt;- tail . fmap lines . readFile $ \"testInput\"\n    result &lt;- fmap waffles contents\n    writeFile \"output.txt\" $ concat result\n\nwaffles row col = (row - 1)*(col - 1)\n</code></pre>\n\n<p>Sadly the compiler complains:</p>\n\n<pre><code>waffles.hs:3:41:\n    Couldn't match type \u2018IO String\u2019 with \u2018[String]\u2019\n    Expected type: FilePath -&gt; [String]\n      Actual type: FilePath -&gt; IO String\n    In the second argument of \u2018(.)\u2019, namely \u2018readFile\u2019\n    In the second argument of \u2018(.)\u2019, namely \u2018fmap lines . readFile\u2019\n\nwaffles.hs:5:9:\n    Couldn't match expected type \u2018[b]\u2019 with actual type \u2018IO ()\u2019\n    Relevant bindings include program :: [b] (bound at waffles.hs:2:1)\n    In a stmt of a 'do' block: writeFile \"output.txt\" $ concat result\n    In the expression:\n      do { contents &lt;- tail . fmap lines . readFile $ \"testInput\";\n           result &lt;- fmap waffles contents;\n           writeFile \"output.txt\" $ concat result }\n    In an equation for \u2018program\u2019:\n        program\n          = do { contents &lt;- tail . fmap lines . readFile $ \"testInput\";\n                 result &lt;- fmap waffles contents;\n                 writeFile \"output.txt\" $ concat result }\nFailed, modules loaded: none.\n</code></pre>\n\n<p>I find that error quite daunting. Can you help me debug it?</p>\n\n<p>I also would appreciate code style advice!</p>\n\n<p>EDIT: I forgot to split the lines of the file and convert them to integers. I tried solving that as follows:</p>\n\n<pre><code>main = do\n    contents &lt;- tail . fmap lines . readFile $ \"testInput\"\n    contents &lt;- fmap read . words contents\n    result &lt;- fmap waffles contents\n    writeFile \"output.txt\" $ concat result\n\nwaffles row col = (row - 1)*(col - 1)\n</code></pre>\n\n<p>But that only introduced more confusing compiler errors.</p>\n"}, {"tags": ["haskell", "custom-data-type"], "comments": [{"owner": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "edited": false, "score": 3, "creation_date": 1524657059, "post_id": 50021549, "comment_id": 87058885, "body": "Try <code>TextEditor ((b++ [head (a)]) , tail(a))</code> Looks like you didn&#39;t place your <code>()</code> correctly"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1524657764, "post_id": 50021549, "comment_id": 87059374, "body": "Just out of interest, what do you think will happen when I call <code>moveCursorLeft (TextEditor (&quot;abc&quot;,&quot;&quot;))</code>?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1524685621, "post_id": 50021549, "comment_id": 87076535, "body": "It looks like you want a <a href=\"http://learnyouahaskell.com/zippers\" rel=\"nofollow noreferrer\">zipper</a> (scroll down to &quot;Focusing on lists&quot;)."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 9697142, "user_type": "registered", "profile_image": "https://graph.facebook.com/1846288642049065/picture?type=large", "display_name": "Andrew Morrison", "link": "https://stackoverflow.com/users/9697142/andrew-morrison"}, "edited": false, "score": 0, "creation_date": 1524658146, "post_id": 50021639, "comment_id": 87059683, "body": "Thank you very much this worked! Legend :)"}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 3, "last_activity_date": 1524657116, "creation_date": 1524657116, "answer_id": 50021639, "question_id": 50021549, "link": "https://stackoverflow.com/questions/50021549/haskell-couldnt-match-expected-type/50021639#50021639", "title": "Haskell - Couldn&#39;t match expected type", "body": "<p>This line is wrong:</p>\n\n<pre><code>moveCursorLeft (TextEditor (b, a)) = (TextEditor (b++ [head (a)]) , tail(a))\n--                                   ^ Why is this bracket here?\n</code></pre>\n\n<p>it should be:</p>\n\n<pre><code>moveCursorLeft (TextEditor (b, a)) = TextEditor ((b ++ [head a]) , tail a)\n--                                              ^ It should be here.\n</code></pre>\n\n<p>Note also that I have removed some brackets for the sake of being more idiomatic and readable Haskell.</p>\n\n<p>In general you should avoid using tuples (and therefore this issue) by defining your data like so:</p>\n\n<pre><code>data TextEditor = TextEditor [Char] [Char] deriving (Show)\n</code></pre>\n\n<p>Then (omitting other lines) the problematic line would become</p>\n\n<pre><code>moveCursorLeft (TextEditor b a) = TextEditor (b ++ [head a]) (tail a)\n-- Much cleaner!\n</code></pre>\n\n<p>Remember that in Haskell, functions are called like <code>function arg1 arg2</code>, not <code>function(arg1, arg2)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 5, "last_activity_date": 1524660360, "last_edit_date": 1524660360, "creation_date": 1524657416, "answer_id": 50021728, "question_id": 50021549, "link": "https://stackoverflow.com/questions/50021549/haskell-couldnt-match-expected-type/50021728#50021728", "title": "Haskell - Couldn&#39;t match expected type", "body": "<p>You write in the second clause:</p>\n\n<pre><code>(TextEditor (b++ [head (a)]) , tail(a))\n</code></pre>\n\n<p>But that means that you do not construct a <code>TextEditor</code> object, but a <code>(TextEditor, String)</code> 2-tuple (although the first element is still malformed). Indeed:</p>\n\n<pre><code><b>(</b>TextEditor (b++ [head (a)]) <b>,</b> tail(a)<b>)</b></code></pre>\n\n<p>You probably are looking for:</p>\n\n<pre><code>TextEditor <b>(</b>b++ [head (a)] <b>,</b> tail(a)<b>)</b></code></pre>\n\n<p>Nevertheless this is still not a good idea: it is possible that <code>a</code> is an empty list, and hence has no <code>head</code> or <code>tail</code>.</p>\n\n<p>Usually it is better to perform pattern matching here:</p>\n\n<pre><code>moveCursorRight :: TextEditor -&gt; TextEditor\nmoveCursorRight (t@TextEditor ([], b)) = t  -- I think?\nmoveCursorRight (TextEditor ((a:as), b)) = TextEditor (b ++ [a] , as)\n</code></pre>\n\n<p>But now it is still quite inefficient, since appending takes <em>O(n)</em> time. A common technique is to use two lists, where the first one is reversed, so <code>TextEditor ([1, 4, 2], [5, 1, 3, 0, 2])</code> would then mean <code>241|51302</code> (with <code>|</code> the cursor).</p>\n\n<p>We can then write it like:</p>\n\n<pre><code>-- In case we reverse the first item of the 2-tuple\nmoveCursorRight :: TextEditor -&gt; TextEditor\nmoveCursorRight (t@TextEditor (b, [])) = t\nmoveCursorRight (TextEditor (b, (a:as))) = TextEditor ((a:b) , as)\n</code></pre>\n\n<p>Note that this is actually moving a cursor to the <em>right</em>, in all fucntions, since we pop from the right element of the tuple, and push to the left.</p>\n"}], "owner": {"reputation": 25, "user_id": 9697142, "user_type": "registered", "profile_image": "https://graph.facebook.com/1846288642049065/picture?type=large", "display_name": "Andrew Morrison", "link": "https://stackoverflow.com/users/9697142/andrew-morrison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 635, "favorite_count": 0, "closed_date": 1525376744, "accepted_answer_id": 50021639, "answer_count": 2, "score": 2, "last_activity_date": 1524660360, "creation_date": 1524656871, "last_edit_date": 1524656957, "question_id": 50021549, "link": "https://stackoverflow.com/questions/50021549/haskell-couldnt-match-expected-type", "closed_reason": "Not suitable for this site", "title": "Haskell - Couldn&#39;t match expected type", "body": "<p>So I am trying to create a simple text editor in Haskell. I have defined a custom data type 'TextEditor' which consists of two char sets one acts as all the characters before the cursor then next is all the characters after the cursor. I've initialized this with some text to begin with.</p>\n\n<pre><code>import Data.List\nimport System.IO\n\ndata TextEditor = TextEditor([Char],[Char]) deriving (Show)\n\ninputLine :: TextEditor\ninputLine = TextEditor(\"The quick br\", \"own fox\")\n\nmoveCursorLeft :: TextEditor -&gt; TextEditor\nmoveCursorLeft (TextEditor (b, a)) = (TextEditor (b++ [head (a)]) , tail(a))\n</code></pre>\n\n<p>I am getting this error when I try to load. </p>\n\n<pre><code>Test.hs:10:38: error:\nCouldn't match expected type `TextEditor' with actual type `(TextEditor, [Char])'\n    * In the expression: (TextEditor (b ++ [head (a)]), tail (a))\n      In an equation for `moveCursorLeft':\n          moveCursorLeft (TextEditor (b, a))\n            = (TextEditor (b ++ [head (a)]), tail (a))\n\nTest.hs:10:51: error:\n    * Couldn't match expected type `([Char], [Char])' with actual type `[Char]'\n    * In the first argument of `TextEditor', namely `(b ++ [head (a)])'\n      In the expression: TextEditor (b ++ [head (a)])\n      In the expression: (TextEditor (b ++ [head (a)]), tail (a))\n</code></pre>\n\n<p>I am very new to Haskell so any help would be greatly appreciated.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1524644474, "post_id": 50017321, "comment_id": 87050826, "body": "with pattern matching: <code>getInfoString (Info x _ _) = x</code>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1524644694, "post_id": 50017321, "comment_id": 87050959, "body": "then you can call it with <code>getInfoString aylmoa</code>. Note that in Haskell, the <code>.</code> is not used to access attributes. It is the function composition operator."}, {"owner": {"reputation": 966, "user_id": 5669167, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/2cc0p.jpg?s=128&g=1", "display_name": "zython", "link": "https://stackoverflow.com/users/5669167/zython"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524644717, "post_id": 50017321, "comment_id": 87050973, "body": "@WillemVanOnsem  awesome thanks for the quick answer, put it as an answer for SEO etc. I&#39;ll accept in a bit"}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 1, "creation_date": 1524645904, "post_id": 50017321, "comment_id": 87051648, "body": "@zython: This part is answered in <a href=\"http://learnyouahaskell.com/making-our-own-types-and-typeclasses#record-syntax\" rel=\"nofollow noreferrer\">LYAH chapter 8.2: Making Our Own Types and Typeclasses, Record Syntax</a>."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1524685133, "post_id": 50017321, "comment_id": 87076322, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/2225774/haskell-pattern-matching-what-is-it\">Haskell pattern matching - what is it?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": true, "score": 6, "last_activity_date": 1582065343, "last_edit_date": 1592644375, "creation_date": 1524645797, "answer_id": 50017760, "question_id": 50017321, "link": "https://stackoverflow.com/questions/50017321/how-to-get-custom-data-type-member/50017760#50017760", "title": "How to get custom data type member?", "body": "<blockquote>\n<p>How to get custom data type member?</p>\n<pre><code>data Info = Info String Int Int\n</code></pre>\n</blockquote>\n<p>As Willem Van Onsem said, you can write a function that does this:</p>\n<pre><code>infoString :: Info -&gt; String\ninfoString (Info s _ _) = s\n</code></pre>\n<p>Or you can <a href=\"http://learnyouahaskell.com/making-our-own-types-and-typeclasses#record-syntax\" rel=\"noreferrer\">use record syntax</a> to name your data type fields:</p>\n<pre><code>data Info = Info { infoString :: String\n                 , infoInt1   :: Int\n                 , infoInt2   :: Int\n                 }\n</code></pre>\n<p>and use the automatically generated <code>infoString :: Info -&gt; String</code> as a function.</p>\n<p>Preferrably, come up with better names for those fields.</p>\n"}], "owner": {"reputation": 966, "user_id": 5669167, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/2cc0p.jpg?s=128&g=1", "display_name": "zython", "link": "https://stackoverflow.com/users/5669167/zython"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 976, "favorite_count": 0, "accepted_answer_id": 50017760, "answer_count": 1, "score": 2, "last_activity_date": 1582065343, "creation_date": 1524644393, "last_edit_date": 1524645850, "question_id": 50017321, "link": "https://stackoverflow.com/questions/50017321/how-to-get-custom-data-type-member", "title": "How to get custom data type member?", "body": "<p>This is what I have tried so far. I wanted to make a type <code>Info</code> with a <code>String</code> and two <code>Int</code>s. Now I want to access the <code>String</code> for a given instance of that type. I have read <a href=\"https://stackoverflow.com/questions/10115623/accessing-members-of-a-custom-data-type-in-haskell\">Accessing members of a custom data type in Haskell</a>.</p>\n\n<p>I did not expect this to work but couldn't search for what I'm looking for:</p>\n\n<pre><code>Prelude&gt; data Info = Info String Int Int\nPrelude&gt; aylmao = Info \"aylmao\" 2 3\nPrelude&gt; aylmao . String \n\n&lt;interactive&gt;:4:1: error:\n    \u2022 Couldn't match expected type \u2018b0 -&gt; c\u2019 with actual type \u2018Info\u2019\n    \u2022 In the first argument of \u2018(.)\u2019, namely \u2018aylmao\u2019\n      In the expression: aylmao . String\n      In an equation for \u2018it\u2019: it = aylmao . String\n    \u2022 Relevant bindings include\n        it :: a -&gt; c (bound at &lt;interactive&gt;:4:1)\n\n&lt;interactive&gt;:4:10: error:\n    Data constructor not in scope: String :: a -&gt; b0\nPrelude&gt; \n</code></pre>\n\n<p>I want to be able to access any anonymous member of my type, how can I do this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 0, "creation_date": 1524645163, "post_id": 50016841, "comment_id": 87051226, "body": "By linear you mean linear proportional to the haystack rather than the needle, right? Well, as long as you produce a copy with some bytes modified, you can&#39;t avoid that. If you want destructive, in-place substitution, you may want the ST monad."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 0, "creation_date": 1524646634, "post_id": 50016841, "comment_id": 87052158, "body": "@SimonShine I was referring to the number of replacements. I will edit the post to indicate that."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 1, "creation_date": 1524646884, "post_id": 50016841, "comment_id": 87052328, "body": "@SimonShine Would be great if you could write an answer that shows how to perform that with ST monad. As I understand, we will have to regard a ByteString as an array, and I am unsure if it is morally correct since the underlying representation may change, and whether it is reasonable to use a plain array here."}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 1, "creation_date": 1524648090, "post_id": 50016841, "comment_id": 87053064, "body": "I might later today; doing some quick research, I&#39;d either try combining <a href=\"https://stackoverflow.com/questions/34494893/how-to-understand-the-state-type-in-haskells-st-monad\">ST</a> and <a href=\"https://wiki.haskell.org/Arrays#Mutable_arrays_in_ST_monad_.28module_Data.Array.ST.29\" rel=\"nofollow noreferrer\">STArray from Data.Array.ST</a>, but going between ByteString and STArray has a cost. Alternatively, <a href=\"https://www.reddit.com/r/haskell/comments/29nvsx/how_to_get_good_performance_when_processing/\" rel=\"nofollow noreferrer\">using Data.Conduit.Binary</a> seems to let you do it directly on ByteStrings. I&#39;ve never tried something like this, though."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 0, "creation_date": 1524648936, "post_id": 50016841, "comment_id": 87053626, "body": "@SimonShine Thank you, Simon. I will be looking into these links now. I think a constant comlexity isomorphism between a strict byte string and an ST array would solve the problem, but I am not sure how to go about obtaining one."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1524658794, "post_id": 50016841, "comment_id": 87060190, "body": "If you are doing a lot of replacements, consider converting to a lazy bytestring (for which concat is constant time). For absolutely optimal performance, your best bet is to copy the bytestring, then do a mutable replacement on the underlying ForeignPtr of the copy."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1524659605, "post_id": 50016841, "comment_id": 87060830, "body": "@user2407038 And how does one do that? And why is copying unavoidable? (If I promise that no other piece of logic cares about a given byte string, could I change it in place?) Perchance you could be bothered to summarize this all in a proper answer?"}, {"owner": {"reputation": 789, "user_id": 8120642, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OX8-_3nAbeE/AAAAAAAAAAI/AAAAAAAAAAA/of7PUZBmbk4/photo.jpg?sz=128", "display_name": "hegel5000", "link": "https://stackoverflow.com/users/8120642/hegel5000"}, "edited": false, "score": 0, "creation_date": 1524661545, "post_id": 50016841, "comment_id": 87062337, "body": "@Ignat Insarov How does your data come into your program?  I have a strong feeling that making just a single copy of the array in order to make a series of mutations is <i>not</i> going to be your rate-limiting step, especially if your data came in from the disk, the network, or spent any time as the type <code>[Word8]</code>."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 789, "user_id": 8120642, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OX8-_3nAbeE/AAAAAAAAAAI/AAAAAAAAAAA/of7PUZBmbk4/photo.jpg?sz=128", "display_name": "hegel5000", "link": "https://stackoverflow.com/users/8120642/hegel5000"}, "edited": false, "score": 0, "creation_date": 1524662587, "post_id": 50016841, "comment_id": 87063111, "body": "@hegel5000 I&#39;m reading it from a file with <code>ByteString.readFile</code>, so, yes, there is no problem at all in making a copy. I&#39;m just being a perfectionist for the cause of understanding the case better."}, {"owner": {"reputation": 789, "user_id": 8120642, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OX8-_3nAbeE/AAAAAAAAAAI/AAAAAAAAAAA/of7PUZBmbk4/photo.jpg?sz=128", "display_name": "hegel5000", "link": "https://stackoverflow.com/users/8120642/hegel5000"}, "edited": false, "score": 1, "creation_date": 1524663768, "post_id": 50016841, "comment_id": 87063833, "body": "I&#39;ve gone from writing database type stuff in Haskell to doing scientific computing in C++.  C++ doesn&#39;t have GC which means it can&#39;t do persistent data structures (e.g. <code>[]</code> or <code>Data.Map</code>) without a lot of setup.  The result is that there is a <i>lot</i> of copying, even if you aren&#39;t going for pure functional programming (which I do).  But now I profile my programs a lot and I&#39;ve found that most of that copying just doesn&#39;t show up, and if it does then it&#39;s not the O(n) copying step per se that&#39;s the problem but the O(1) allocation/deallocation steps."}], "answers": [{"comments": [{"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1524659775, "post_id": 50021628, "comment_id": 87060975, "body": "Well, this is definitely very readable and nice. But I still hope there is a better solution performance wise."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1524660129, "post_id": 50021628, "comment_id": 87061261, "body": "Also, I wonder how you would extend this to work with multiple offset-replacement pairs."}, {"owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "reply_to_user": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 1, "creation_date": 1524660860, "post_id": 50021628, "comment_id": 87061803, "body": "With a fold of course :-) Well if I&#39;m correct, if you take non-strictness into account this is amortised O(1)."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1524662702, "post_id": 50021628, "comment_id": 87063200, "body": "I&#39;m not sure I see how it should go. Do you mind editing your thoughts on this into the answer? Especially on the amortized O(1) part."}, {"owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "reply_to_user": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1524674786, "post_id": 50021628, "comment_id": 87071060, "body": "I thought the ByteString type worked somehow like a list, in that you would only pay the cost of concat when you actually consume the list, but then I looked into the source code and it\u2019s using memcpy so now I\u2019m not so sure. Anyway, just added some code, I hope it\u2019s helpful."}, {"owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "reply_to_user": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1524676404, "post_id": 50021628, "comment_id": 87071891, "body": "I don&#39;t see how you would go about doing n operations in one go, other than using SIMD instructions \ud83e\udd14"}], "tags": [], "owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "is_accepted": true, "score": 2, "last_activity_date": 1524674612, "last_edit_date": 1524674612, "creation_date": 1524657082, "answer_id": 50021628, "question_id": 50016841, "link": "https://stackoverflow.com/questions/50016841/efficiently-replace-a-portion-of-a-binary-object/50021628#50021628", "title": "Efficiently replace a portion of a binary object", "body": "<p>Given <code>concat</code> is linear in the size of the list and both <code>take</code> and <code>drop</code> are O(1), this may be as good as it gets:</p>\n\n<pre><code>replace source offset replacement = \n  concat [ take offset source\n         , replacement\n         , drop n source\n         ] \n  where n = offset + length replacement\n</code></pre>\n\n<p>For an arbitrary number of replacements:</p>\n\n<pre><code>replacemany :: [(Int, ByteString)] -&gt; ByteString -&gt; ByteString\nreplacemany wss bs = foldr f bs wss where\n  f (l, ws) bs = replace bs l ws\n</code></pre>\n"}], "owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 1, "accepted_answer_id": 50021628, "answer_count": 1, "score": 2, "last_activity_date": 1524674612, "creation_date": 1524642825, "last_edit_date": 1524646687, "question_id": 50016841, "link": "https://stackoverflow.com/questions/50016841/efficiently-replace-a-portion-of-a-binary-object", "title": "Efficiently replace a portion of a binary object", "body": "<p>My goal is to efficiently overwrite several sections of a blob, while leaving its overall content\nand structure pristine. To this end, I have written the following functions:</p>\n\n<pre><code>replace :: ByteString -&gt; Int -&gt; ByteString -&gt; ByteString\nreplace source offset replacement = prefix &lt;&gt; replacement &lt;&gt; suffix\n  where\n    prefix = ByteString.take offset source \n    suffix = ByteString.drop (offset + ByteString.length replacement) source\n\nfix :: Int -&gt; ByteString -&gt; ByteString -&gt; ByteString\nfix offset replacement source = replace source offset replacement\n</code></pre>\n\n<p>And this is how they work:</p>\n\n<pre><code>\u03bb replace \"I have a cat.\" 0x09 \"dog\"\n\"I have a dog.\"\n\u03bb fix 0x0A \"fat\" . fix 0x03 \"dog\" $ \"My cat is red.\"\n\"My dog is fat.\"\n</code></pre>\n\n<p>Unfortunately, <code>&lt;&gt;</code> = <code>append</code> is linear time, and therefore these functions too. Having the\nknowledge that the replacement is just as long as the section being replaced, surely we can do\nbetter?</p>\n\n<p>I would be especially joyful if it happens that we can replace multiple sections in time less than linear over the number of replacements.</p>\n"}, {"tags": ["string", "windows", "haskell", "encode"], "comments": [{"owner": {"reputation": 2077, "user_id": 3009636, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/04e0f94443ae5d17f977cb09ccde315b?s=128&d=identicon&r=PG&f=1", "display_name": "quant", "link": "https://stackoverflow.com/users/3009636/quant"}, "edited": false, "score": 2, "creation_date": 1524623644, "post_id": 50013110, "comment_id": 87042769, "body": "All of your &quot;This is displayed as messy codes.&quot; examples are working on my computer (Ubuntu, GHCI, version 7.10.3). Probably haskell is using a slightly different file encoding then your text editor?"}, {"owner": {"reputation": 1270, "user_id": 2383766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc13aeb9c9f89e097f48d815b81541d5?s=128&d=identicon&r=PG", "display_name": "Z-Y.L", "link": "https://stackoverflow.com/users/2383766/z-y-l"}, "reply_to_user": {"reputation": 2077, "user_id": 3009636, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/04e0f94443ae5d17f977cb09ccde315b?s=128&d=identicon&r=PG&f=1", "display_name": "quant", "link": "https://stackoverflow.com/users/3009636/quant"}, "edited": false, "score": 0, "creation_date": 1524624278, "post_id": 50013110, "comment_id": 87042939, "body": "@quant my computer is Windows 10, GHCI, version 8.2.2. The same problem also exists in Windows 7, GHCI, version 8.0.2"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1524626040, "post_id": 50013110, "comment_id": 87043345, "body": "What encoding does your text editor use?"}, {"owner": {"reputation": 5469, "user_id": 7083401, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eA15o.png?s=128&g=1", "display_name": "ice1000", "link": "https://stackoverflow.com/users/7083401/ice1000"}, "edited": false, "score": 0, "creation_date": 1524628474, "post_id": 50013110, "comment_id": 87043876, "body": "Have you tried importing <code>System.IO.UTF8</code> instead of <code>System.IO</code>?"}, {"owner": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "edited": false, "score": 1, "creation_date": 1524628811, "post_id": 50013110, "comment_id": 87043959, "body": "What encoding do you expect to be in the file? Could you verify with their actual byte content rather than what notepad shows?"}, {"owner": {"reputation": 1270, "user_id": 2383766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc13aeb9c9f89e097f48d815b81541d5?s=128&d=identicon&r=PG", "display_name": "Z-Y.L", "link": "https://stackoverflow.com/users/2383766/z-y-l"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1524630985, "post_id": 50013110, "comment_id": 87044474, "body": "@DanielWagner The output file uses UTF-8."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1524632522, "post_id": 50013110, "comment_id": 87044869, "body": "@Z-Y.L That&#39;s good to know, but it&#39;s not what I asked. For the file to display correctly, the program creating the file and the program reading the file have to agree on an encoding. So: what encoding does your text editor use? (And how do you know?) My guess is that your editor is trying to auto-detect an encoding and getting it wrong sometimes."}, {"owner": {"reputation": 1270, "user_id": 2383766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc13aeb9c9f89e097f48d815b81541d5?s=128&d=identicon&r=PG", "display_name": "Z-Y.L", "link": "https://stackoverflow.com/users/2383766/z-y-l"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1524634009, "post_id": 50013110, "comment_id": 87045363, "body": "@DanielWagner The Windows&#39; nodpad should use ANSI by default, since when I saveAs a new-created file, the default encoding shows as ANSI."}, {"owner": {"reputation": 1270, "user_id": 2383766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc13aeb9c9f89e097f48d815b81541d5?s=128&d=identicon&r=PG", "display_name": "Z-Y.L", "link": "https://stackoverflow.com/users/2383766/z-y-l"}, "reply_to_user": {"reputation": 5469, "user_id": 7083401, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eA15o.png?s=128&g=1", "display_name": "ice1000", "link": "https://stackoverflow.com/users/7083401/ice1000"}, "edited": false, "score": 0, "creation_date": 1524634104, "post_id": 50013110, "comment_id": 87045393, "body": "@ice1000 With <code>System.IO.UTF8</code> imported, the output is normal. But I don&#39; t know why the default <code>writeFile</code> doesn&#39;t work."}, {"owner": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "edited": false, "score": 0, "creation_date": 1524635487, "post_id": 50013110, "comment_id": 87045896, "body": "What does &quot;chcp&quot; show you before you start ghci?"}, {"owner": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "edited": false, "score": 0, "creation_date": 1524635613, "post_id": 50013110, "comment_id": 87045948, "body": "Apparently writeFile&#39;s encoding depends on the current locale. With ghc 8.2.2 from stack lts-10.4 at Windows 10 I cannot reproduce it with both codepage 936 (gb2312) and 65001 (utf-8)"}, {"owner": {"reputation": 7268, "user_id": 2303202, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/iT9aU.png?s=128&g=1", "display_name": "max630", "link": "https://stackoverflow.com/users/2303202/max630"}, "edited": false, "score": 0, "creation_date": 1524635758, "post_id": 50013110, "comment_id": 87046018, "body": "I used (g)vim to view the file (&quot;<code>:e ++enc=&lt;encoding&gt; r.txt</code>&quot; to open file with explicit encoding)"}], "answers": [{"comments": [{"owner": {"reputation": 1270, "user_id": 2383766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc13aeb9c9f89e097f48d815b81541d5?s=128&d=identicon&r=PG", "display_name": "Z-Y.L", "link": "https://stackoverflow.com/users/2383766/z-y-l"}, "edited": false, "score": 1, "creation_date": 1524717820, "post_id": 50015435, "comment_id": 87085977, "body": "Using I/O function such as <code>writeFile</code> from Data.Text.IO still results in strange characters in the output file when writing &quot;\u56fe&quot;. But I think it&#39;s related to the encoding used by Windows, since I type \u201c\u56fe&quot; directly into a notepad and save it, it shows messy codes when I reopen it. But regarding string, <code>Data.Text</code> is a better tool. Thanks for your advice!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user554538"}, "is_accepted": true, "score": 4, "last_activity_date": 1524637862, "creation_date": 1524637862, "answer_id": 50015435, "question_id": 50013110, "link": "https://stackoverflow.com/questions/50013110/how-to-avoid-messy-codes-when-outputting-chinese-characters/50015435#50015435", "title": "how to avoid messy codes when outputting Chinese characters", "body": "<p>First off, this is an excellent question. Encoding issues are a problem still, even now. <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd374081%28v=vs.85%29.aspx?f=255&amp;MSPPError=-2147217396\" rel=\"nofollow noreferrer\">Windows uses UTF-16 by default now</a>, while much of Haskell is developed on UTF-8 platforms. The actual encoding used by the <code>System.IO</code> functions isn't well-defined at runtime since it's set by the platform environment, or is chosen arbitrarily if not.</p>\n\n<p>The first thing to do is switch to <a href=\"http://hackage.haskell.org/package/text\" rel=\"nofollow noreferrer\"><code>Data.Text</code></a> for text handling. Not only is this more aware of encodings, it's also considerably more efficient than the \"List of Characters\" model that <code>String</code> is. It has it's <a href=\"http://hackage.haskell.org/package/text-1.2.3.0/docs/Data-Text-IO.html\" rel=\"nofollow noreferrer\">own I/O functions</a> that take specific encodings into account, too.</p>\n\n<p>To make this easier, enabling the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#overloaded-string-literals\" rel=\"nofollow noreferrer\"><code>OverloadedStrings</code></a> will be very helpful. Also, since you're using string literals, checking that the source code file encoding matches the environment when GHC compiles it will help, too. There are a lot of places handling that data, and past a certain point, loading your strings from a known-good file ends up being less of a headache than putting them in the source.</p>\n"}], "owner": {"reputation": 1270, "user_id": 2383766, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bc13aeb9c9f89e097f48d815b81541d5?s=128&d=identicon&r=PG", "display_name": "Z-Y.L", "link": "https://stackoverflow.com/users/2383766/z-y-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 1, "accepted_answer_id": 50015435, "answer_count": 1, "score": 1, "last_activity_date": 1524637862, "creation_date": 1524622663, "last_edit_date": 1524628691, "question_id": 50013110, "link": "https://stackoverflow.com/questions/50013110/how-to-avoid-messy-codes-when-outputting-chinese-characters", "title": "how to avoid messy codes when outputting Chinese characters", "body": "<p>I've found a strange problem about writing Chinese characters into a file by <code>writeFile</code>.</p>\n\n<pre><code>&gt; writeFile \"r.txt\" \"\u8fc7\"  -- outputting as expected.\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/QHwVs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QHwVs.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>&gt; writeFile \"r.txt\" \"\u56fe\"  -- not displaying as expected. see the following:\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/c9I1l.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/c9I1l.png\" alt=\"enter image description here\"></a></p>\n\n<p>Then the stranger thing happens: </p>\n\n<pre><code>&gt; writeFile \"r.txt\" \"\u56fe\u753b\"  -- outputting is normal, as follows: \n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/A8YRx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/A8YRx.png\" alt=\"enter image description here\"></a></p>\n\n<p>More examples that display messy codes: </p>\n\n<pre><code>&gt; writeFile \"r.txt\" \"\u58eb\"\n&gt; writeFile \"r.txt\" \"\u5341\"\n&gt; writeFile \"r.txt\" \"\u5343\"\n&gt; writeFile \"r.txt\" \"\u4e00\"\n&gt; writeFile \"r.txt\" \"\u4e00\u5343\u5341\u58eb\u56fe\" -- This is displayed as messy codes.\n</code></pre>\n\n<p>But the following is normal: </p>\n\n<pre><code>&gt; writeFile \"r.txt\" \"\u4e00\u5343\u5341\u58eb\u56fe\u753b\" -- This is normal.\n</code></pre>\n\n<p>So it's normal if the characters above are exported together with other characters that can be displayed normally such as <code>writeFile \"r.txt\" \"\u5341\u8fc7\"</code>\u3002</p>\n\n<p>I have no idea why this happens:</p>\n\n<p>\u2014\u2014 Why some characters are outputted as messy codes while others don't? In fact, \"\u4e00\u5343\u5341\u58eb\u56fe\" are the most used characters in Chinese.</p>\n\n<p>\u2014\u2014 Why the characters exported as messy codes can be displayed normally together with other characters that can be displayed normally?</p>\n\n<p>I appreciate it if anyone can provide some information.</p>\n"}, {"tags": ["haskell", "conditional"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 5, "creation_date": 1524608287, "post_id": 50011455, "comment_id": 87039409, "body": "Because reassigning is fundamentally impossible in Haskell. All variable are immutable. That is rather logical since Haskell is a lazy language and hence if objects were mutable, then the behavior would be completely unpredictable."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1524608371, "post_id": 50011455, "comment_id": 87039431, "body": "Is is rather weird to name a string <code>index</code> by the way."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1524659276, "post_id": 50011455, "comment_id": 87060580, "body": "Hi @DanHessler, you seem to be a Haskell beginner! If you&#39;re looking for a good text for totally new Haskell programmers, I&#39;d recommend <a href=\"http://learnyouahaskell.com/chapters\" rel=\"nofollow noreferrer\">LYAH</a>."}], "answers": [{"tags": [], "owner": {"reputation": 241, "user_id": 7993952, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/BzDdP.png?s=128&g=1", "display_name": "Dan Hessler", "link": "https://stackoverflow.com/users/7993952/dan-hessler"}, "is_accepted": false, "score": 1, "last_activity_date": 1524608536, "creation_date": 1524608536, "answer_id": 50011509, "question_id": 50011455, "link": "https://stackoverflow.com/questions/50011455/variable-assignment-in-haskell/50011509#50011509", "title": "Variable assignment in haskell", "body": "<p>I found a fix, instead of changing index, I am just returning a single space.</p>\n\n<p>Insead of:</p>\n\n<pre><code>if isInfixOf \" \" index then index = \" \"\n</code></pre>\n\n<p>I did:</p>\n\n<pre><code>if isInfixOf \" \" index then \" \"\n</code></pre>\n\n<p>So I just return the space.</p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 8, "last_activity_date": 1524608863, "creation_date": 1524608863, "answer_id": 50011553, "question_id": 50011455, "link": "https://stackoverflow.com/questions/50011455/variable-assignment-in-haskell/50011553#50011553", "title": "Variable assignment in haskell", "body": "<blockquote>\n  <p>Why am I not able to reassign index to a single space?</p>\n</blockquote>\n\n<p>Because in Haskell you are unable to reassign anything. In fact you never even <em>assign</em>, you <em>declare</em> (that is something related, but different). Even in some cases where it might perhaps look like you reassign variables (like in <code>do</code> blocks, you do not reassign, but you <em>shadow</em> variables by declaring a new one with the same name, again this is a bit related, but there are a lot of cases where we see different behavior, for example in a loop, we can not shadow the variable every iteration).</p>\n\n<p>To answer your question, you probably want to return a string with one space, we can do that by writing:</p>\n\n<pre><code>getSpaces index = if (length index) == 1 then index else\n                                 if isInfixOf \" \" index then <b>\" \"</b> else index</code></pre>\n\n<p>But nevertheless this is still rather inelegant, as well as it is rather unsafe since in case of an infinite <code>String</code>, this will start looping: the <code>length</code> keeps looping until the list (of characters) is exhausted, and it is possible that this never happens. Furthermore even if it does not get stuck in an infinite loop, then still it is not advisable, since it runs in <em>O(n)</em> (with <em>n</em> the length of the list). So for long lists, this is inefficient.</p>\n\n<p>Usually in Haskell, one uses a combination of <em>patterns</em> and <em>guards</em> to distinct between possible values. Your case can be mapped to:</p>\n\n<pre><code>getSpaces :: String -&gt; String\ngetSpaces st@[_] = st\ngetSpaces st | isInfixOf \" \" st = st\n             | otherwise = \" \"\n</code></pre>\n\n<p>This will still loop however, in case the list has infinite size, sinze <code>isInfixOf</code> keeps looking for a space, until it has found one, or the <code>String</code> is exhausted.</p>\n\n<p>Since <code>isPrefixOf</code> with as search pattern a string with <em>one</em> character in fact means that we look if the string contains a space, we can replace that with <code>elem</code> and look for the character <code>' '</code>:</p>\n\n<pre><code>getSpaces :: String -&gt; String\ngetSpaces st@[_] = st\ngetSpaces st | elem ' ' st = st\n             | otherwise = \" \"\n</code></pre>\n"}], "owner": {"reputation": 241, "user_id": 7993952, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/BzDdP.png?s=128&g=1", "display_name": "Dan Hessler", "link": "https://stackoverflow.com/users/7993952/dan-hessler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 429, "favorite_count": 0, "accepted_answer_id": 50011553, "answer_count": 2, "score": 0, "last_activity_date": 1524608863, "creation_date": 1524608210, "question_id": 50011455, "link": "https://stackoverflow.com/questions/50011455/variable-assignment-in-haskell", "title": "Variable assignment in haskell", "body": "<p>I'm trying to write a helper function that takes in a string and if the string has multiple spaces it turns it into just one string. Here is the code:</p>\n\n<pre><code>getSpaces :: String -&gt; String\ngetSpaces index = \n    if (length index) == 1 then index\n    else\n        if isInfixOf \" \" index then index = \" \"\n        else index\n</code></pre>\n\n<p>When I try to load my module into GHCI I get the error:</p>\n\n<pre><code>Prelude&gt; :l Utilities\n[1 of 1] Compiling Utilities        ( Utilities.hs, interpreted )\n\nUtilities.hs:55:42: error:\nparse error on input \u2018=\u2019\nPerhaps you need a 'let' in a 'do' block?\ne.g. 'let x = 5' instead of 'x = 5'\n   |\n55 |        if isInfixOf \" \" index then index = \" \"\n   |                                          ^\nFailed, no modules loaded.\n</code></pre>\n\n<p>Why am I not able to reassign index to a single space?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 5, "creation_date": 1524605389, "post_id": 50010967, "comment_id": 87038486, "body": "Question: why do you use <code>(\\x xs -&gt; x : xs)</code> here as <code>foldr</code> function? How would you - let us forget about Haskell for now - write an <code>average</code> function?"}], "answers": [{"tags": [], "owner": {"reputation": 309, "user_id": 6222757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48fdecaf00efb53f6ed0ee200fa9ba2b?s=128&d=identicon&r=PG&f=1", "display_name": "evzh", "link": "https://stackoverflow.com/users/6222757/evzh"}, "is_accepted": true, "score": 3, "last_activity_date": 1524608748, "creation_date": 1524608748, "answer_id": 50011539, "question_id": 50010967, "link": "https://stackoverflow.com/questions/50010967/haskell-average-function/50011539#50011539", "title": "Haskell average function", "body": "<blockquote>\n  <p>I need to write an average function that uses a lambda expression ...</p>\n</blockquote>\n\n<p>I take that as you want to implement an <code>average</code> function using <code>foldr</code> and a lambda you write. Otherwise, (not considering performance issues) I would just write</p>\n\n<pre><code>average :: (Num a) =&gt; [a] -&gt; a\naverage xs = sum xs / length xs\n</code></pre>\n\n<p>But maybe it's more important for you to figure out how to write things in Haskell than simply have that average function. </p>\n\n<p>First, note the type signature of <code>average</code> above. As a general rule it's good to have the type in mind (and also in the code). <code>average</code> takes a bunch of numbers and return one number, thus the <code>(Num a) =&gt; [a] -&gt; a</code>. If you stick to the type you'll find out what's wrong with your definition: <code>average xs = foldr (\\x xs -&gt; x : xs) []</code> would have type <code>[a] -&gt; [a]</code>, so that wouldn't work anyway.</p>\n\n<p>Then, as you've mentioned in the comment, you need to keep a running sum <em>and</em> a running counter and divide them to get the average. So you could just translate that into code:</p>\n\n<pre><code>sumAndCount :: (Num a) =&gt; [a] -&gt; (a, Int)\nsumAndCount xs = foldr (\\x (s, c) -&gt; (s + x, c + 1)) (0, 0) xs\n\naverage :: (Num a) =&gt; [a] -&gt; a\naverage [] = error \"Taking average of 0 numbers\"\naverage xs = total / (fromIntegral counter) where\n    (total, counter) = sumAndCount xs\n</code></pre>\n\n<p>Two small glitches:</p>\n\n<ul>\n<li><p>For mathematical consistency, it's better not to define average of <code>[]</code> as 0, because it actually should be <code>0/0</code> which is <code>NaN</code>. But you could do that if it's reasonable for your task.</p></li>\n<li><p><code>fromIntegral</code> casts an integer to any <code>Num</code> type. That's necessary because division only works between the same type. </p></li>\n</ul>\n\n<p>Apart from these, everything just happens naturally. </p>\n"}], "owner": {"reputation": 21, "user_id": 9693664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebbaf47ec35993e9ef57a3208ea1e167?s=128&d=identicon&r=PG&f=1", "display_name": "Anna Choi", "link": "https://stackoverflow.com/users/9693664/anna-choi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1854, "favorite_count": 0, "closed_date": 1525376760, "accepted_answer_id": 50011539, "answer_count": 1, "score": -1, "last_activity_date": 1524608748, "creation_date": 1524605344, "last_edit_date": 1524605367, "question_id": 50010967, "link": "https://stackoverflow.com/questions/50010967/haskell-average-function", "closed_reason": "Needs more focus", "title": "Haskell average function", "body": "<p>I'm not really sure where to start here. </p>\n\n<p>I need to write an average function that uses a lambda expression and takes in a list of floats and returns the average as a float in haskell </p>\n\n<p>So far I have </p>\n\n<pre><code>average [] = 0\naverage xs = foldr (\\x xs -&gt; x : xs) []\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524604982, "post_id": 50010827, "comment_id": 87038363, "body": "A poor mans solution could be to define <code>minLen</code> and <code>maxLen</code> as <code>a -&gt; Int64</code>, define them like <code>minLen _ = 12</code>, and then call it with that argument."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1524629523, "post_id": 50010998, "comment_id": 87044143, "body": "It&#39;s easy to avoid <code>ScopedTypeVariables</code> in your last example; e.g. replace <code>(Proxy :: Proxy a)</code> with just <code>[x]</code>. It&#39;s even less cumbersome than the &quot;modern&quot; way in some respects (e.g. no <code>forall</code> needed)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1524667709, "post_id": 50010998, "comment_id": 87066567, "body": "@DanielWagner I partly agree, but I really don&#39;t like that solution. Passing <code>[x]</code> would make me thing that its value matters, when it does not. I prefer to pass real proxies to make my intent clear -- so much that i would use <code>Proxy a</code> instead of <code>proxy a</code> in the method signatures. To remove the extension, I&#39;d refine a global <code>proxyOf :: a -&gt; Proxy a</code> and exploit that. IMO, it should be defined in the library along <code>reproxy</code> and friends. Or better, (IMO) the whole library should be scrapped, since there&#39;s no more need for proxies."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 5, "last_activity_date": 1524605526, "creation_date": 1524605526, "answer_id": 50010998, "question_id": 50010827, "link": "https://stackoverflow.com/questions/50010827/types-with-min-length-and-max-length-in-haskell/50010998#50010998", "title": "Types with min length and max length in haskell", "body": "<p>The modern way is to turn on a bunch of extensions: <code>ScopedTypeVariables, AmbiguousTypes, TypeApplications</code>.</p>\n\n<pre><code>validateLen :: forall a. BoundedLen a =&gt; a -&gt; Either LenError a\nvalidateLen x\n    | minLen @a &gt; len x = Left TooShort\n    | maxLen @a &lt; len x = Left TooLong\n    | otherwise         = Right x\n</code></pre>\n\n<p>Alternatively, you can add a dummy argument to your methods, to remove the ambiguity.</p>\n\n<pre><code>class BoundedLen a where\n  minLen :: a -&gt; Int64  -- the argument is not really used\n  maxLen :: a -&gt; Int64  -- the argument is not really used\n  len    :: a -&gt; Int64\n\nvalidateLen :: BoundedLen a =&gt; a -&gt; Either LenError a\nvalidateLen x\n    | minLen x &gt; len x = Left TooShort\n    | maxLen x &lt; len x = Left TooLong\n    | otherwise        = Right x\n</code></pre>\n\n<p>This is not too bad here, but passing <code>x</code> only to disambiguate the type feels quite unnatural, since the value of <code>x</code> is irrelevant.</p>\n\n<p>One can also use a proxy, as in</p>\n\n<pre><code>class BoundedLen a where\n  minLen :: proxy a -&gt; Int64\n  maxLen :: proxy a -&gt; Int64\n  len    :: a -&gt; Int64\n\nvalidateLen :: forall a. BoundedLen a =&gt; a -&gt; Either LenError a\nvalidateLen x\n    | minLen (Proxy :: Proxy a) &gt; len x = Left TooShort\n    | maxLen (Proxy :: Proxy a) &lt; len x = Left TooLong\n    | otherwise        = Right x\n</code></pre>\n\n<p>but this is more cumbersome to use than the first alternative, and still requires <code>ScopedTypeVariables</code> (or even more code). I don't recommend to use proxies.</p>\n"}], "owner": {"reputation": 410, "user_id": 3927886, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/689a75ec29af93dcc938fdbd5f039b54?s=128&d=identicon&r=PG&f=1", "display_name": "RamiroPastor", "link": "https://stackoverflow.com/users/3927886/ramiropastor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 50010998, "answer_count": 1, "score": 1, "last_activity_date": 1524605526, "creation_date": 1524604599, "question_id": 50010827, "link": "https://stackoverflow.com/questions/50010827/types-with-min-length-and-max-length-in-haskell", "title": "Types with min length and max length in haskell", "body": "<p>Is there a simple way to do something like this?</p>\n\n<pre><code>import Data.Int (Int64)\n\n\n\nclass BoundedLen a where\n  minLen :: Int64\n  maxLen :: Int64\n  len    :: a -&gt; Int64\n\n\n\ndata LenError = TooShort | TooLong\n\n\n\nvalidateLen :: BoundedLen a =&gt; a -&gt; Either LenError a\nvalidateLen x\n    | minLen &gt; len x = Left TooShort\n    | maxLen &lt; len x = Left TooLong\n    | otherwise      = Right x\n</code></pre>\n\n<p>That code won't work because of the ambiguity check.</p>\n\n<p>I want to do this to validate user input of any kind, but maybe i'm going too far?</p>\n"}, {"tags": ["haskell", "haskell-platform"], "comments": [{"owner": {"reputation": 100768, "user_id": 1899640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/47374ccb28e4b0d2454b64f7b975bc66?s=128&d=identicon&r=PG", "display_name": "that other guy", "link": "https://stackoverflow.com/users/1899640/that-other-guy"}, "edited": false, "score": 0, "creation_date": 1524591718, "post_id": 50007769, "comment_id": 87032089, "body": "The answer is &quot;Yes&quot;. The dupe question is about how to also remove dependencies on non-Haskell shared libraries like zlib and gmp."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 4, "creation_date": 1524591736, "post_id": 50007769, "comment_id": 87032102, "body": "FWIW, a compiled <code>.exe</code> <i>cannot</i> be run on any computer, only on Windows (or Wine), and particularly not when it&#39;s written with .net, which <i>is</i> a separate runtime comparable to the JVM which just happens to be included in Windows if I recall correctly. But yeah, for a properly native-compiled language like C++ or Haskell (and indeed C#, through Mono) this is possible, as long as you stay with a given type of OS."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1524615680, "post_id": 50007769, "comment_id": 87041095, "body": "@leftaroundabout wouldn&#39;t <a href=\"https://stackoverflow.com/questions/6389948/do-ghc-compiled-binaries-require-ghc-or-are-they-self-contained\" title=\"do ghc compiled binaries require ghc or are they self contained\">stackoverflow.com/questions/6389948/&hellip;</a> be a better dupe target?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1524626103, "post_id": 50007769, "comment_id": 87043359, "body": "@BenjaminHodgson I have added it to the duplicate targets list."}], "owner": {"reputation": 327, "user_id": 8052539, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ff2b0f87a3312c4f0295d2bca8c5cbf5?s=128&d=identicon&r=PG&f=1", "display_name": "Ignas", "link": "https://stackoverflow.com/users/8052539/ignas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "closed_date": 1524591524, "answer_count": 0, "score": 0, "last_activity_date": 1524626066, "creation_date": 1524591431, "question_id": 50007769, "link": "https://stackoverflow.com/questions/50007769/can-compiled-haskell-run-w-o-haskell-environment", "closed_reason": "Duplicate", "title": "Can compiled Haskell run w/o Haskell environment?", "body": "<p>I was trying to find out, whether the Haskell environment is needed to run Haskell program? For instance like Java.\nOr does it work more like .net, where compiled .exe can be run on any computer wherever one copies it to?\nI got this question, because in addition to normal arguments, one can give arguments for Haskell environment (<code>+RTS -RTS</code>) when launching an executable.</p>\n"}, {"tags": ["haskell", "module"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1524588349, "post_id": 50006962, "comment_id": 87030354, "body": "By using <code>concat</code>, but I don&#39;t see why you use <code>group</code> then, since by using <code>sort</code>, you already will place equal elements near each other. Note that since <code>Ord</code> implies <code>Eq</code>, you can drop the redundant <code>Eq a</code> type constraint."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524588707, "post_id": 50006962, "comment_id": 87030548, "body": "Or if you want only one element, by using <code>map head</code>"}, {"owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524633109, "post_id": 50006962, "comment_id": 87045053, "body": "Still learning here, Willem :) I will get there, definitely with the help of your (valid!) comments..."}, {"owner": {"reputation": 570, "user_id": 3295004, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IGNvT.jpg?s=128&g=1", "display_name": "fp_mora", "link": "https://stackoverflow.com/users/3295004/fp-mora"}, "edited": false, "score": 0, "creation_date": 1524695694, "post_id": 50006962, "comment_id": 87080566, "body": "If you just want to practice and do some things yourself, put a function like the following as the first in you composition. <code>ff . DL.group . DL sort</code>. The <code>ff</code> function will flatten the list. <code>ff [] = []; ff (x:xs) =  x ++ ff xs</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1096, "user_id": 5021447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-gwPYP717ZyU/AAAAAAAAAAI/AAAAAAAAAP8/WoyhftM4PuU/photo.jpg?sz=128", "display_name": "Jordan Mackie", "link": "https://stackoverflow.com/users/5021447/jordan-mackie"}, "is_accepted": false, "score": 1, "last_activity_date": 1524588791, "creation_date": 1524588791, "answer_id": 50007111, "question_id": 50006962, "link": "https://stackoverflow.com/questions/50006962/haskell-extracting-list-from-list-of-lists/50007111#50007111", "title": "Haskell extracting list from list of lists", "body": "<p>Try <code>concat</code> which is available via <code>Prelude</code>, <code>Data.List</code>, or <code>Data.Foldable</code>. How concrete this <code>concat</code> function is will depend on the package and your <code>ghc</code> version (i.e. whether it operates on <code>[[a]]</code> or <code>Foldable t =&gt; t [a]</code>)</p>\n\n<p>Also look at <code>Control.Monad.join</code> which is a stronger abstraction of the <em>\"flatten\"</em> concept.</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 3, "last_activity_date": 1524590228, "creation_date": 1524590228, "answer_id": 50007485, "question_id": 50006962, "link": "https://stackoverflow.com/questions/50006962/haskell-extracting-list-from-list-of-lists/50007485#50007485", "title": "Haskell extracting list from list of lists", "body": "<p>If you don't want similar elements grouped together, don't call <code>group</code>.</p>\n\n<pre><code>don'tGroup167 :: Ord a =&gt; [a] -&gt; [a]\ndon'tGroup167 = DL.sort\n</code></pre>\n\n<p>An aside: the <code>Eq a</code> constraint is unnecessary. <code>Ord a</code> implies <code>Eq a</code>.</p>\n"}], "owner": {"reputation": 999, "user_id": 8604871, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/36382829e5be7f6da95308288d976949?s=128&d=identicon&r=PG&f=1", "display_name": "Madderote", "link": "https://stackoverflow.com/users/8604871/madderote"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1524590228, "creation_date": 1524588290, "question_id": 50006962, "link": "https://stackoverflow.com/questions/50006962/haskell-extracting-list-from-list-of-lists", "title": "Haskell extracting list from list of lists", "body": "<p>Got this:</p>\n\n<pre><code>group167 :: (Eq a, Ord a) =&gt; [a] -&gt; [[a]]\ngroup167 = DL.group . DL.sort\n</code></pre>\n\n<p>Where DL is import qualified Data.List as DL. Obviously this returns a list of lists, but how to go one level up and make it just a flat list (one tier)? Just me being curious. No direct necessity to know, just want to understand. Have the feeling slowly but surely start to see the logic in Haskell. </p>\n"}, {"tags": ["shell", "haskell", "concurrency", "command-line-arguments"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1524560240, "post_id": 49996566, "comment_id": 87011037, "body": "Arguments before <code>+RTS</code> mean whatever you ask your program to do with them. If you don&#39;t have <code>getArgs</code> in your program, they will all just be ignored."}], "answers": [{"comments": [{"owner": {"reputation": 327, "user_id": 8052539, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ff2b0f87a3312c4f0295d2bca8c5cbf5?s=128&d=identicon&r=PG&f=1", "display_name": "Ignas", "link": "https://stackoverflow.com/users/8052539/ignas"}, "edited": false, "score": 0, "creation_date": 1524585533, "post_id": 49997991, "comment_id": 87028732, "body": "Thanks, well explained, now it&#39;s much more clear to me."}], "tags": [], "owner": {"reputation": 1096, "user_id": 5021447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-gwPYP717ZyU/AAAAAAAAAAI/AAAAAAAAAP8/WoyhftM4PuU/photo.jpg?sz=128", "display_name": "Jordan Mackie", "link": "https://stackoverflow.com/users/5021447/jordan-mackie"}, "is_accepted": true, "score": 3, "last_activity_date": 1524561889, "creation_date": 1524561889, "answer_id": 49997991, "question_id": 49996566, "link": "https://stackoverflow.com/questions/49996566/haskell-parallel-program-launch-arguments/49997991#49997991", "title": "Haskell parallel program launch arguments", "body": "<p>Arguments between <code>+RTS ... -RTS</code> are intercepted by the runtime and not passed to your program (<code>-RTS</code> is optional if the arguments are at the end of the call). Everything else will be consumed by your program.</p>\n\n<p>So the answer to your question is in the program's code - specifically the usage message reads: <code>usage: zeta &lt;nthreads&gt; &lt;boundary&gt; &lt;s&gt;</code>, which makes more sense if you compile with <code>ghc -O2 -threaded --make Main.hs -o zeta</code>. Have a look at the functions to see how these are being used.</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 0, "last_activity_date": 1524590122, "creation_date": 1524590122, "answer_id": 50007457, "question_id": 49996566, "link": "https://stackoverflow.com/questions/49996566/haskell-parallel-program-launch-arguments/50007457#50007457", "title": "Haskell parallel program launch arguments", "body": "<p>The other answer addresses you question as asked, but I want to address this off-hand comment:</p>\n\n<blockquote>\n  <p>for it to be really concurrent, one has to... launch compiled program with some additional arguments.</p>\n</blockquote>\n\n<p>(I understood this as a complaint which you would like to fix.) One can also design the program to use additional OS threads even without having the RTS options using the <a href=\"https://hackage.haskell.org/package/base-4.11.1.0/docs/Control-Concurrent.html\" rel=\"nofollow noreferrer\"><code>Control.Concurrent</code></a> API. In particular, <code>getNumCapabilities</code> and <code>setNumCapabilities</code> read and write the number of OS threads dedicated to evaluating Haskell code. You may also like <code>rtsSupportsBoundThreads</code> to check whether the program was compiled with the right threading flags and <a href=\"http://hackage.haskell.org/package/base-4.11.0.0/docs/GHC-Conc.html#v:getNumProcessors\" rel=\"nofollow noreferrer\"><code>getNumProcessors</code></a> to check how many CPUs are available to run threads on.</p>\n"}], "owner": {"reputation": 327, "user_id": 8052539, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/ff2b0f87a3312c4f0295d2bca8c5cbf5?s=128&d=identicon&r=PG&f=1", "display_name": "Ignas", "link": "https://stackoverflow.com/users/8052539/ignas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 1, "accepted_answer_id": 49997991, "answer_count": 2, "score": 0, "last_activity_date": 1524590122, "creation_date": 1524557518, "last_edit_date": 1524587088, "question_id": 49996566, "link": "https://stackoverflow.com/questions/49996566/haskell-parallel-program-launch-arguments", "title": "Haskell parallel program launch arguments", "body": "<p>I have programmed a Haskell program which works in a Unix utility manner - you launch the program, it gets the job done, and exits.\nI used concurrency in that program, but for it to be really concurrent, one has to compile it respectively, and furthermore, what surprises me, launch compiled program with some additional arguments.\nI compiled it with:</p>\n\n<p><code>ghc -O2 -threaded --make Main.hs -o Main.parallel</code></p>\n\n<p>And it seems to work in parallel when I run it like that:</p>\n\n<p><code>./Main.parallel ds_houses/task.txt 8 500000 1:+1 +RTS -N8\n./Main.parallel ds_houses/task.txt 8 500000 +RTS -N8\n./Main.parallel ds_houses/task.txt 8 +RTS -N8\n./Main.parallel ds_houses/task.txt +RTS -N8</code></p>\n\n<p>I use arguments <code>8</code>, <code>500000</code> and <code>1:+1</code> because I saw them <a href=\"https://wiki.haskell.org/Concurrency_demos/Zeta\" rel=\"nofollow noreferrer\">here</a>, in the shell script.</p>\n\n<p>I understand the first argument as cores of CPU, but what are others? It doesn't seem that those arguments are used by <code>/usr/bin/time</code> program, because if you add <code>%C</code> to its format, these arguments are shown as arguments for benchmarked program.</p>\n\n<p>Can someone explain or point me to what these arguments do?\nIs my assumption true, that one's Haskell compiled program accepts not only arguments expected by programmer, but also other arguments that are forwarded to Haskell runtime?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 5, "creation_date": 1524531623, "post_id": 49991552, "comment_id": 87000545, "body": "You can&#39;t use two operators in a row."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1524536222, "post_id": 49991552, "comment_id": 87001494, "body": "Rahul Manne\u2019s answer already explained why, but just to add some alternatives: you could keep <code>($)</code> and <code>(&lt;$&gt;)</code> using an operator section <code>(abs &lt;$&gt;) $ (-) &lt;$&gt; x &lt;*&gt; y</code>, but that\u2019s a bit silly\u2014I sometimes use the named <code>fmap</code> instead of the <code>(&lt;$&gt;)</code> operator in this situation: <code>fmap abs $ (-) &lt;$&gt; x &lt;*&gt; y</code>. You could also remove a level of nesting with <code>liftA2</code> instead of the <code>(&lt;$&gt;)</code> and <code>(&lt;*&gt;)</code> operators: <code>abs &lt;$&gt; liftA2 (-) x y</code>; or if you\u2019re going to be using this lifted subtraction pattern often, define <code>(.-) = liftA2 (-); infixl 6 .-</code> and write <code>abs &lt;$&gt; x .- y</code>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1524544139, "post_id": 49991552, "comment_id": 87003179, "body": "BTW, <code>dist</code> is not a good name for this function. A distance should always be a scalar."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524549537, "post_id": 49991552, "comment_id": 87004978, "body": "<code>$</code> is in fact not really Haskell syntax, it is an operator defined in the prelude."}], "answers": [{"tags": [], "owner": {"reputation": 1159, "user_id": 3953988, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/803352198cc6f048e409a07eefa19d7b?s=128&d=identicon&r=PG", "display_name": "Rahul Manne", "link": "https://stackoverflow.com/users/3953988/rahul-manne"}, "is_accepted": true, "score": 10, "last_activity_date": 1524532205, "last_edit_date": 1524532205, "creation_date": 1524531764, "answer_id": 49991970, "question_id": 49991552, "link": "https://stackoverflow.com/questions/49991552/why-when-cant-be-used-instead-of-parentheses-in-haskell/49991970#49991970", "title": "Why/when can&#39;t $ be used instead of parentheses in Haskell?", "body": "<p><code>$</code> is an operator, same as <code>&lt;$&gt;</code>. The problem is that you have two binary operators following one another.</p>\n\n<p><code>$</code> works the way it does specifically due to its declaration (<code>infixr 0</code>), where it takes the lowest priority. (See: <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Prelude.html#v:-36-\" rel=\"noreferrer\">http://hackage.haskell.org/package/base-4.11.1.0/docs/Prelude.html#v:-36-</a>)</p>\n\n<p>See <a href=\"https://www.haskell.org/onlinereport/decls.html#fixity\" rel=\"noreferrer\">https://www.haskell.org/onlinereport/decls.html#fixity</a> for more information.</p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 11, "last_activity_date": 1524544057, "last_edit_date": 1524544057, "creation_date": 1524543710, "answer_id": 49993391, "question_id": 49991552, "link": "https://stackoverflow.com/questions/49991552/why-when-cant-be-used-instead-of-parentheses-in-haskell/49993391#49993391", "title": "Why/when can&#39;t $ be used instead of parentheses in Haskell?", "body": "<p>Although it is in practice indeed used primarily for this purpose, the <code>$</code> operator is not in any fundamental way syntactically linked to parenthisation \u2013 it's just another infix operator (i.e. 2-argument function written in the middle between arguments), like <code>+</code> or <code>*</code> or <code>&lt;$&gt;</code>. What the operator does is take a function on its left side and a value that the function should be applied to on the right. So, for instance <code>sqrt (1 - x^2)</code> can be written <code>sqrt $ 1 - x^2</code>, because <code>sqrt</code> is just a function and instead of flat out applying the function to its argument you can also use the <code>$</code> to do the same thing, benefiting from the low <code>infixr 0 $</code>.</p>\n\n<p>The function may also be a composition or partial application of other stuff, as in</p>\n\n<pre><code>(sum . map (^2)) (0 : xs)   \u2261   sum . map (^2) $ 0 : xs\n</code></pre>\n\n<p>But <code>abs &lt;$&gt; ((-) &lt;$&gt; x &lt;*&gt; y)</code> is not of this form: it is <em>already</em> an infix expression.</p>\n\n<p>We can however exploit the fact that Haskell allows partial application also of infix operators, because that gives you a <em>simple function</em> form. You need an <em>operator section</em>:</p>\n\n<pre><code>abs &lt;$&gt; ((-) &lt;$&gt; x &lt;*&gt; y)   \u2261   (abs &lt;$&gt;) ((-) &lt;$&gt; x &lt;*&gt; y)\n</code></pre>\n\n<p>and this is now of simple function-application form, so you can make it</p>\n\n<pre><code>(abs &lt;$&gt;) $ (-) &lt;$&gt; x &lt;*&gt; y\n</code></pre>\n\n<p>Of course that somewhat defeats the point, because the operator section has introduced another pair of parentheses, so in this case the original way of writing the expression probably remains the best. Fortunately though, <code>&lt;$&gt;</code> also comes in a plain-function form, namely</p>\n\n<pre><code>fmap abs $ (-) &lt;$&gt; x &lt;*&gt; y\n</code></pre>\n\n<p>Another option would be to rewrite the <code>&lt;*&gt;</code> subexpression: <code>f &lt;$&gt; a &lt;*&gt; b</code> is the same as <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Control-Applicative.html#v:liftA2\" rel=\"noreferrer\"><code>liftA2 f a b</code></a>, which as a plain function binds tighter than the infix <code>&lt;$&gt;</code> anyway. So</p>\n\n<pre><code>abs &lt;$&gt; ((-) &lt;$&gt; x &lt;*&gt; y)   \u2261   abs &lt;$&gt; liftA2 (-) x y\n</code></pre>\n\n<p>Or alternatively, remove the outer <code>fmap</code> entirely: if you first define</p>\n\n<pre><code>numDist :: Num a =&gt; a -&gt; a -&gt; a\nnumDist a b = abs $ a - b\n</code></pre>\n\n<p>then you can just write</p>\n\n<pre><code>dist x y = numDist &lt;$&gt; x &lt;*&gt; y\n</code></pre>\n\n<p>...or</p>\n\n<pre><code>dist = liftA2 numDist\n</code></pre>\n"}], "owner": {"reputation": 18780, "user_id": 683218, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/7Vy7c.png?s=128&g=1", "display_name": "tinlyx", "link": "https://stackoverflow.com/users/683218/tinlyx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 410, "favorite_count": 1, "accepted_answer_id": 49991970, "answer_count": 2, "score": 8, "last_activity_date": 1524544057, "creation_date": 1524527991, "question_id": 49991552, "link": "https://stackoverflow.com/questions/49991552/why-when-cant-be-used-instead-of-parentheses-in-haskell", "title": "Why/when can&#39;t $ be used instead of parentheses in Haskell?", "body": "<p>I have the impression that I can use <code>$ ...</code> to represent <code>(...)</code> as long as there is nothing to the right of <code>...</code>.</p>\n\n<p>However, when I try to re-write  the following</p>\n\n<pre><code>dist' x y = abs  &lt;$&gt; ( (-) &lt;$&gt; x &lt;*&gt; y)\n</code></pre>\n\n<p>as</p>\n\n<pre><code>dist x y = abs  &lt;$&gt; $ (-) &lt;$&gt; x &lt;*&gt; y\n</code></pre>\n\n<p>I get an error:</p>\n\n<pre><code> error: \u2026\n    parse error on input \u2018$\u2019\n    Perhaps you intended to use TemplateHaskell\n  |\nCompilation failed.\n</code></pre>\n\n<p>I can live with writing the parenthesis, but I am just curious. Why (or when) does the <code>$</code> not work in replacing <code>()</code>.</p>\n\n<p>(This is with GHC 8.2.2)</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1524540264, "post_id": 49991440, "comment_id": 87002316, "body": "The somewhat oddly-named <code>foldl</code> package offers a nice framework for doing a wide variety of things like this efficiently. For this simple case, another option is the <code>foldl&#39;</code> function, and a third is a higher-order fold: <code>bounds xs = foldr go stop xs minBound maxBound where ...</code>."}], "answers": [{"comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 5, "creation_date": 1524531884, "post_id": 49991904, "comment_id": 87000607, "body": "The <code>foldMap</code> approach uses a boxed pair that isn&#39;t forced during the whole traversal. It&#39;s going to allocate more than the two-pass approach, <i>and</i> not allow the input to be gc&#39;d. Lose/lose."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1524533017, "post_id": 49991904, "comment_id": 87000859, "body": "@Carl Interesting, thanks for this. Do you think a judicious use of <code>!</code> somewhere could fix the performance problem?"}, {"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 5, "creation_date": 1524533058, "post_id": 49991904, "comment_id": 87000869, "body": "Might be worth trying with a strict tuple type instead of the one given by &amp;&amp;&amp;"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1524537948, "post_id": 49991904, "comment_id": 87001873, "body": "I don&#39;t think you can actually get good behavior out of <code>foldMap</code> here without using something like <code>Endo</code> over a sufficiently strict pair type. The <code>foldMap</code> definition for <code>[]</code> is going to associate in the wrong direction. You&#39;ll need to reassociate with function passing to get good space use."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1524552818, "post_id": 49991904, "comment_id": 87006577, "body": "Thanks for the benchmark! I know <code>Criterion</code> but it does not work well on Windows (at least, the last time I tried it)."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 11, "last_activity_date": 1524531221, "creation_date": 1524531221, "answer_id": 49991904, "question_id": 49991440, "link": "https://stackoverflow.com/questions/49991440/simultaneous-minimum-and-maximum-of-a-list/49991904#49991904", "title": "&quot;Simultaneous&quot; minimum and maximum of a list", "body": "<p>First off, your two functions do not behave the same. <code>(minimum xs, maximum xs)</code> dies when <code>xs</code> is an empty list.</p>\n\n<blockquote>\n  <p>Is it more efficient than <code>(minimum x, maximum x)</code>?</p>\n</blockquote>\n\n<p>They're both O(n), but the only way to answer questions like this is to benchmark them competitively. I think I'd expect the <code>foldMap</code> solution to be faster, as it makes only a single pass over the list, but let's find out.</p>\n\n<pre><code>import Control.Arrow ((***), (&gt;&gt;&gt;), (&amp;&amp;&amp;))\nimport Data.Semigroup (getMin, getMax, Min(..), Max(..))\nimport System.Random\nimport Criterion.Main\n\nbounds1, bounds2 :: (Bounded a, Ord a) =&gt; [a] -&gt; (a,a)\nbounds1 = foldMap (Min &amp;&amp;&amp; Max) &gt;&gt;&gt; getMin *** getMax\nbounds2 xs = (minimum xs, maximum xs)\n\nrandomList :: Int -&gt; IO [Int]\nrandomList count = take count &lt;$&gt; randoms &lt;$&gt; newStdGen\n\nmkBench n = env (randomList n) $ \\list -&gt; bgroup (show n) [\n    bench \"foldMap\" $ nf bounds1 list,\n    bench \"minMax\" $ nf bounds2 list\n    ]\n\nmain = defaultMain $ map mkBench [100, 1000, 10000, 100000, 1000000]\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/eg0kh.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/eg0kh.png\" alt=\"enter image description here\"></a></p>\n\n<p>Tabulated, that's</p>\n\n<pre><code>100/foldMap 1.411 \u03bcs\n100/minMax 517.6 ns\n\n1000/foldMap 28.94 \u03bcs\n1000/minMax 5.078 \u03bcs\n\n10000/foldMap 488.4 \u03bcs\n10000/minMax 51.56 \u03bcs\n\n100000/foldMap 21.08 ms\n100000/minMax 537.3 \u03bcs\n\n1000000/foldMap 268.9 ms\n1000000/minMax 8.989 ms\n</code></pre>\n\n<p>So <code>(minimum xs, maximum xs)</code> turns out to be faster than the <code>foldMap</code> idea, across the board.</p>\n"}], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 648, "favorite_count": 1, "answer_count": 1, "score": 10, "last_activity_date": 1524531221, "creation_date": 1524527089, "question_id": 49991440, "link": "https://stackoverflow.com/questions/49991440/simultaneous-minimum-and-maximum-of-a-list", "title": "&quot;Simultaneous&quot; minimum and maximum of a list", "body": "<p>This function returns a 2-tuple with the minimum and the maximum of a list:</p>\n\n<pre><code>import Control.Arrow ((***), (&gt;&gt;&gt;), (&amp;&amp;&amp;))\nimport Data.Semigroup (getMin, getMax, Min(..), Max(..))\n\nbounds :: (Bounded a, Ord a) =&gt; [a] -&gt; (a,a)\nbounds = foldMap (Min &amp;&amp;&amp; Max) &gt;&gt;&gt; getMin *** getMax\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>&gt; x = [1..10 :: Int]\n&gt; bounds x\n(1,10)\n</code></pre>\n\n<p>Is it more efficient than <code>(minimum x, maximum x)</code> ?</p>\n\n<p>Or is there another way more efficient than <code>(minimum x, maximum x)</code> ?</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1524523857, "post_id": 49990973, "comment_id": 86998592, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/26407535/colon-versus-brackets-in-haskell-list-syntax\">Colon versus brackets in haskell list syntax</a>"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 9, "creation_date": 1524523877, "post_id": 49990973, "comment_id": 86998596, "body": "For some strange reason people always seem to think you need square brackets to pattern-match on any list. You don&#39;t!  <code>[foo]</code> is specifically a pattern that matches lists with <i>exactly one element</i>, no matter if <code>foo</code> itself is another pattern. To pop off the head (i.e. in this case, the first row of the 2D list) of <i>any</i> nonzero list, just write <code>((x:xs):tx)</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 3, "creation_date": 1524524384, "post_id": 49990973, "comment_id": 86998736, "body": "<code>[[]]</code> is not an empty list of type <code>[[a]]</code>; it&#39;s a list <i>containing</i> an empty list. <code>[]</code> is the unique empty list for types <code>[a]</code>, <code>[[a]]</code>, <code>[[[a]]]</code>, etc., no matter how deeply nested the type may be."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 7620559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4578055def59107eec472c94f5966af9?s=128&d=identicon&r=PG&f=1", "display_name": "935", "link": "https://stackoverflow.com/users/7620559/935"}, "edited": false, "score": 0, "creation_date": 1524590675, "post_id": 49991207, "comment_id": 87031588, "body": "This worked perfectly for me, thank you! Also a really clear explanation of the syntax, so double thanks!"}], "tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": true, "score": 3, "last_activity_date": 1524526230, "last_edit_date": 1524526230, "creation_date": 1524525497, "answer_id": 49991207, "question_id": 49990973, "link": "https://stackoverflow.com/questions/49990973/haskell-syntax-for-manipulating-a-list-of-lists/49991207#49991207", "title": "Haskell: Syntax for manipulating a list of lists", "body": "<p>As is pointed out in the comments on the question, <code>(x:xs)</code> is the pattern for an object of type <code>[a]</code>, whether the <code>a</code> there is <code>Int</code>, <code>String</code>, <code>Bool</code>, or even <code>[a]</code> itself like <code>[Int]</code>.</p>\n\n<p>In this case your pattern match should be:</p>\n\n<pre><code>sumLsts ((x:xs):tx) ((y:ys):ty) = ...\n{- to [[1, 3, 6], [2, 4, 7], [3, 5, 8]], ((x:xs): tx) matches:\n   x  = 1\n   xs = [3, 6]\n   tx = [[2, 4, 7], [3, 5, 8]]\n-}\n</code></pre>\n\n<p>However do note that your function is just:</p>\n\n<pre><code>sumLsts = zipWith (zipWith (+))\n</code></pre>\n\n<p><code>zipWith</code> pairs two lists together with a joining function, such that</p>\n\n<pre><code>zipWith f [x1, x2, ..., xn] [y1, y2, ..., yn] =\n  [ f x1 y1\n  , f x2 y2\n  , ...\n  , f xn yn ]\n</code></pre>\n\n<p>In this case, your outer two lists get paired together so each sublist is an <code>x</code> and <code>y</code>. You're trying to pair <em>those</em> together with addition, so <code>f</code> is another <code>zipWith</code>, this time <code>zipWith (+)</code></p>\n\n<pre><code>zipWith (zipWith (+)) [[1,1,1], [1,10,20], [-3, -4, -2]] [[3,5,6],[2,3,4],[2,3,2]]\n\n= [ [ 1,  1,  1] `zipWith (+)` [3, 5, 6]\n  , [ 1, 10, 20] `zipWith (+)` [2, 3, 4]\n  , [-3, -4, -2] `zipWith (+)` [2, 3, 2]]\n\n= [ [  1 + 3\n    ,  1 + 5\n    ,  1 + 6]\n  , [  1 + 2\n    , 10 + 3\n    , 20 + 4]\n  , [ -3 + 2\n    , -4 + 3\n    , -2 + 2] ]\n</code></pre>\n"}], "owner": {"reputation": 59, "user_id": 7620559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4578055def59107eec472c94f5966af9?s=128&d=identicon&r=PG&f=1", "display_name": "935", "link": "https://stackoverflow.com/users/7620559/935"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "accepted_answer_id": 49991207, "answer_count": 1, "score": 1, "last_activity_date": 1524526230, "creation_date": 1524523693, "question_id": 49990973, "link": "https://stackoverflow.com/questions/49990973/haskell-syntax-for-manipulating-a-list-of-lists", "title": "Haskell: Syntax for manipulating a list of lists", "body": "<p>I am having trouble finding the correct syntax for manipulating a list of lists.</p>\n\n<p>Here's what I have</p>\n\n<pre><code>&gt; sumLsts :: [[a]] -&gt; [[a]] -&gt; [[a]]\n&gt; sumLsts [[]] [[]] = [[]]\n&gt; sumLsts [(x:xs):tx] [(y:ys):ty] = [((+) x y) : sumLsts xs ys] : sumLsts tx ty\n</code></pre>\n\n<p>Here's sample input and output</p>\n\n<pre><code>&gt; sumLsts [[1,1,1], [1,10,20], [-3, -4, -2]] [[3,5,6],[2,3,4],[2,3,2]]\n&gt; [[4,6,7],[3,13,24],[-1,-1,0]]\n</code></pre>\n\n<p>I was thinking that [(x:xs):tx] would have (x:xs) be seen as a single list and tx be seen as the following list. Haskell doesn't seem to agree. </p>\n\n<p>Here is the error message</p>\n\n<pre><code>Couldn't match expected type 'a' with actual type '[[a0]]'\n'a' is a rigid type variable bound by\n   the type signature for:\n      sumLsts :: forall a. [[a]] -&gt; [[a]] -&gt; [[a]]\nIn the pattern: x : xs\nIn the pattern: (x : xs) : tx\nIn the pattern [(x : xs) : tx]\nRelevant bindings include\n   sumLsts :: [[a]] -&gt; [[a]] -&gt; [[a]]\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1524521739, "post_id": 49990662, "comment_id": 86997985, "body": "You typed, in GHCi, <code>print it</code>.  The <code>it</code> you just tried to print is a function and can not be shown. If you would like you may evaluate the function by providing it with an argument of type <code>(Int,Int)</code> then print the result."}, {"owner": {"reputation": 105, "user_id": 7028615, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/ji4FV.jpg?s=128&g=1", "display_name": "Frank Ponte", "link": "https://stackoverflow.com/users/7028615/frank-ponte"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1524521868, "post_id": 49990662, "comment_id": 86998018, "body": "I&#39;ve never typed such thing! This is what i&#39;m passing to GHCi:      backtracking [[18,0,0],[0,0,0],[0,0,6]] (0,0)"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1524522249, "post_id": 49990662, "comment_id": 86998142, "body": "Same concept, though the error message could be improved in this case.  Your <code>backtracking</code> function takes 3 arguments but you have provided only 2."}, {"owner": {"reputation": 105, "user_id": 7028615, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/ji4FV.jpg?s=128&g=1", "display_name": "Frank Ponte", "link": "https://stackoverflow.com/users/7028615/frank-ponte"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1524522331, "post_id": 49990662, "comment_id": 86998169, "body": "Omg i&#39;m so dumb! Thank you, Thomas.! Now i&#39;ve learned how to understand new kind of console errors."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1524522342, "post_id": 49990662, "comment_id": 86998171, "body": "To expand on that: the concept is the same because providing fewer arguments is legal - it is just partial application.  You thus have a result that is a function from <code>missing argument</code> to <code>result type</code>.  And, as stated above, functions can&#39;t be printed in a meaningful manner."}, {"owner": {"reputation": 105, "user_id": 7028615, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/ji4FV.jpg?s=128&g=1", "display_name": "Frank Ponte", "link": "https://stackoverflow.com/users/7028615/frank-ponte"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1524522565, "post_id": 49990662, "comment_id": 86998238, "body": "That&#39;s also true, professor taught me that. Although is not a concept that i&#39;ve mastered yet (about partial application)!"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1524522989, "post_id": 49990662, "comment_id": 86998368, "body": "Are you using an old GHC version, perhaps? GHCi here clearly suggests the solution using &quot;(maybe you haven&#39;t applied a function to enough arguments?)&quot; in the middle of the error message."}, {"owner": {"reputation": 105, "user_id": 7028615, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/ji4FV.jpg?s=128&g=1", "display_name": "Frank Ponte", "link": "https://stackoverflow.com/users/7028615/frank-ponte"}, "edited": false, "score": 0, "creation_date": 1524523141, "post_id": 49990662, "comment_id": 86998397, "body": "Yes, might be that. Since i&#39;m on 32 bits computer, newer versions are only available for 64 bits architectures"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1524523394, "post_id": 49990662, "comment_id": 86998464, "body": "@ThomasM.DuBuisson <code>print it</code> is a thing ghci implicitly does. Mentioning that to new haskellers as though they&#39;d typed it themselves is just confusing."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1524523744, "post_id": 49990662, "comment_id": 86998559, "body": "@amalloy Yes, I&#39;ve just internalized that <code>print it</code> is not just implicit, but that abstraction leaks through to the error message as shown above. I agree exposing it to the user as though they typed it themselves is confusing and we should patch GHC."}], "answers": [{"tags": [], "owner": {"reputation": 105, "user_id": 7028615, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/ji4FV.jpg?s=128&g=1", "display_name": "Frank Ponte", "link": "https://stackoverflow.com/users/7028615/frank-ponte"}, "is_accepted": false, "score": 1, "last_activity_date": 1524522505, "creation_date": 1524522505, "answer_id": 49990820, "question_id": 49990662, "link": "https://stackoverflow.com/questions/49990662/error-interactive-no-instance-for-show-int-int-string-haskell/49990820#49990820", "title": "Error &quot;Interactive&quot; No instance for (Show ((Int, Int) -&gt; String)) - Haskell", "body": "<p>This was caused because i increased the amount of parameters but forgot to do add it when i was calling the function, and that's why i was getting the error: </p>\n\n<pre><code>backtracking [[18,0,0],[0,0,0],[0,0,6]] (0,0)\n</code></pre>\n\n<p>but i declared it this way: </p>\n\n<pre><code>backtracking :: [[Int]] -&gt; (Int,Int) -&gt; (Int,Int) -&gt; String \n</code></pre>\n\n<p>It's useful for newbies in Haskell like me to understand why errors are showing.Thanks to @Thomas M. DuBuisson for helping me out. Let's keep rocking! </p>\n"}], "owner": {"reputation": 105, "user_id": 7028615, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/ji4FV.jpg?s=128&g=1", "display_name": "Frank Ponte", "link": "https://stackoverflow.com/users/7028615/frank-ponte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 629, "favorite_count": 0, "closed_date": 1524572498, "answer_count": 1, "score": 1, "last_activity_date": 1524522505, "creation_date": 1524521488, "question_id": 49990662, "link": "https://stackoverflow.com/questions/49990662/error-interactive-no-instance-for-show-int-int-string-haskell", "closed_reason": "Duplicate", "title": "Error &quot;Interactive&quot; No instance for (Show ((Int, Int) -&gt; String)) - Haskell", "body": "<p>I'm in the middle of the way of a backtracking function. This is what i've done so far, it was working, then i added an extra value and now GHCi is printing an error. I'm still new to this language and i don't know how to fix this. Help!</p>\n\n<pre><code>backtracking :: [[Int]] -&gt; (Int,Int) -&gt; (Int,Int) -&gt; String --montapuercos (posActual, vida)\nbacktracking matriz montapuercos memory | checkMove (-1,0) montapuercos memory matriz = \"Norte \"++(backtracking matriz (-1+(fst montapuercos),(snd montapuercos)) montapuercos)\n                                            | checkMove (0,1) montapuercos memory matriz = \"Este \"++(backtracking matriz (fst montapuercos,(snd montapuercos)+1) montapuercos)\n                                            | checkMove (1,0) montapuercos memory matriz = \"Sur \"++(backtracking matriz (fst montapuercos+1,(snd montapuercos)) montapuercos)\n                                            | checkMove (0,-1) montapuercos memory matriz = \"Oeste \"++(backtracking matriz (fst montapuercos,(snd montapuercos)-1) montapuercos)\n                                            | montapuercos == (length matriz,length(head matriz)) = \" Llegu\u00e9 a la salida\"\n\ncheckMove :: (Int,Int) -&gt; (Int,Int)  -&gt; (Int,Int) -&gt; [[Int]] -&gt; Bool\ncheckMove (mx,my) (pA1,pA2) (mem1,mem2) matriz  | ( (pA1+mx) &gt;= 0 &amp;&amp; (pA1+mx) &lt; length matriz ) &amp;&amp;\n                                                ( (pA2+my) &gt;= 0 &amp;&amp; (pA2+my) &lt; length (head matriz) ) &amp;&amp; \n                                                ( (pA1+mx) /= mem1 &amp;&amp; (pA2+my) /= mem2 ) = True                                             \n                                                | otherwise = False\n</code></pre>\n\n<p>This is the error i get</p>\n\n<pre><code>&lt;interactive&gt;:105:1:\n    No instance for (Show ((Int, Int) -&gt; String))\n      arising from a use of \u2018print\u2019\n    In a stmt of an interactive GHCi command: print it\n</code></pre>\n\n<p>Why is this happening?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 5, "creation_date": 1524515284, "post_id": 49989439, "comment_id": 86995352, "body": "No, that would break parametricity."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1524515286, "post_id": 49989439, "comment_id": 86995353, "body": "But the parameter is known at compile time. It makes no sense to do that. You probably want to use a typeclass here."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1524515632, "post_id": 49989439, "comment_id": 86995499, "body": "Somewhat related: <a href=\"https://stackoverflow.com/q/9106980/1848654\">stackoverflow.com/q/9106980/1848654</a>. The construct you&#39;re describing is also known as &quot;typecase&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 6, "last_activity_date": 1524526384, "last_edit_date": 1524526384, "creation_date": 1524515533, "answer_id": 49989496, "question_id": 49989439, "link": "https://stackoverflow.com/questions/49989439/check-type-of-parameter-in-haskell/49989496#49989496", "title": "Check type of parameter in haskell", "body": "<p>No.</p>\n\n<p>Use a datatype instead:</p>\n\n<pre><code>data MyType = MyInt Int | MyChar Char\n\nfoo :: MyType -&gt; MyType\nfoo (MyInt i) = MyInt (i + 1) -- Or whatever\nfoo (MyChar c) = case c of {'a' -&gt; MyChar 'A'; k -&gt; MyChar k}\n</code></pre>\n\n<p>Though this of course restricts what types you can use.</p>\n\n<p>Alternatively, use a typeclass:</p>\n\n<pre><code>class MyClass a where\n    foo :: a -&gt; a\n\ninstance MyClass Int where\n    foo i = i + 1\n\ninstance MyClass Char where\n    foo c = case c of {'a' -&gt; 'A'; k -&gt; k}\n\n-- N.B. foo :: MyClass a =&gt; a -&gt; a\n</code></pre>\n\n<p>Though once again this restricts what types you can use.</p>\n"}, {"comments": [{"owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "edited": false, "score": 3, "creation_date": 1524535281, "post_id": 49990313, "comment_id": 87001323, "body": "Note that this is a &quot;safe&quot; way around parametricity because this is essentially the same as <code>foo :: TypeRep a -&gt; a -&gt; a</code>, which is still parametrically polymorphic."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 4, "last_activity_date": 1524554723, "last_edit_date": 1524554723, "creation_date": 1524519223, "answer_id": 49990313, "question_id": 49989439, "link": "https://stackoverflow.com/questions/49989439/check-type-of-parameter-in-haskell/49990313#49990313", "title": "Check type of parameter in haskell", "body": "<p>A way to do this, which however I do <em>not</em> recommend, is to add a <code>Typeable</code> constraint.</p>\n\n<pre><code>foo :: forall a . Typeable a =&gt; a -&gt; a\nfoo x = case eqT :: a :~: Int of -- check if a = Int\n   Just Refl -&gt; x + 1            -- here we can use x as an Int\n   Nothing   -&gt; x                -- here we can not use x as an Int\n</code></pre>\n\n<p>For this to work you need a number of extensions, such as <code>ScopedTypeVariables</code> and <code>GADTs</code>.</p>\n\n<p>This is usually not a good idea, in general. Before adopting this, you should first understand if you really need it: <code>Typeable</code> is very powerful and it should be used as a last resort, when simpler alternatives are not enough. Perhaps a custom type class could be a better solution for your tasks, as AJFarmar showed.</p>\n\n<p>Also note that, without a type class constraint, a function <code>foo :: a -&gt; a</code>, according to its \"free theorem\" (AKA parametricity property) can only be the identity function, or be undefined (e.g. infinite recursion, or a runtime exception).</p>\n"}], "owner": {"reputation": 104, "user_id": 4782303, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mZ0OM.jpg?s=128&g=1", "display_name": "Prototype", "link": "https://stackoverflow.com/users/4782303/prototype"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1094, "favorite_count": 0, "accepted_answer_id": 49989496, "answer_count": 2, "score": 0, "last_activity_date": 1524554723, "creation_date": 1524515219, "question_id": 49989439, "link": "https://stackoverflow.com/questions/49989439/check-type-of-parameter-in-haskell", "title": "Check type of parameter in haskell", "body": "<p>I have a function <code>(a-&gt;a)</code> which can take in different types but is there a way to determine what datatype the parameter is?\nLike</p>\n\n<pre><code>foo :: a -&gt; a\nfoo a == int =..\nfoo a == char =..\n</code></pre>\n\n<p>Is there anyway to do a check like this in haskell?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1524513120, "post_id": 49988841, "comment_id": 86994280, "body": "What do you mean by &quot;<i>at the end or one by one</i>&quot;? Haskell uses lazy evaluation."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1524513056, "creation_date": 1524513056, "answer_id": 49988944, "question_id": 49988841, "link": "https://stackoverflow.com/questions/49988841/implementing-filter-with-concat-and-map-in-haskell/49988944#49988944", "title": "Implementing filter with concat and map in Haskell", "body": "<p>Well imagine that we have for example five elements:</p>\n\n<pre><code>[x1, x2, x3, x4, x5]\n</code></pre>\n\n<p>and that <code>p</code> holds for <code>x2</code>, <code>x3</code> and <code>x5</code>. Then we perform a mapping as follows:</p>\n\n<pre><code>              map box [x1, x2, x3, x4, x5]\n------------------------------------------\n= [box x1, box x2, box x3, box x4, box x5]\n</code></pre>\n\n<p>Since <code>p</code> holds for <code>x2</code>, <code>x3</code> and <code>x5</code>, it means that <code>box</code> returns an empty list for <code>x1</code> and <code>x4</code>, and a singleton list with the original list for <code>x2</code>, <code>x3</code> and <code>x5</code>, so:</p>\n\n<pre><code>  [box x1, box x2, box x3, box x4, box x5]\n------------------------------------------\n=               [[], [x2], [x3], [], [x5]]\n</code></pre>\n\n<p>Then if we apply the <code>concat</code>, the empty lists (<code>[]</code>) will not add any elements to the result, so the original elements are \"filtered out\", whereas the content of the singleton lists - the elements for which <code>p</code> holds - are added to the list, so:</p>\n\n<pre><code>  concat [[], [x2], [x3], [], [x5]]\n-----------------------------------\n=                      [x2, x3, x5]\n</code></pre>\n\n<p>So by mapping elements that we want to filter out to empty lists, and elements that we want to keep to singleton lists with that element, and concatenating those elements, we manage to filter out the elements we do not want. Nevertheless this for of filtering is - if not optimized - not very efficient, since we box and unbox all the elements we want.</p>\n\n<p>Note that Haskell is a lazy language, so if you somehow <code>filter1</code> some elements, then this is <em>not</em> performed, unless you need the result. Furthermore both <code>map</code> and <code>concat</code> are lazy as well (like all functions). Here this means that if we are for instance interested in the <em>i</em>-th element of the result, we will not calculate the entire list.</p>\n"}, {"tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": false, "score": 7, "last_activity_date": 1524513219, "creation_date": 1524513219, "answer_id": 49988983, "question_id": 49988841, "link": "https://stackoverflow.com/questions/49988841/implementing-filter-with-concat-and-map-in-haskell/49988983#49988983", "title": "Implementing filter with concat and map in Haskell", "body": "<p>It is very hard to discern from your question what you are actually asking. Please try to phrase your questions clearly. I will just explain how the function works, and hope that this explanation will address whatever it is that you're actually asking.</p>\n\n<hr>\n\n<p>First, <code>map box</code> is applied to the input list. Every call to <code>box</code> will either return <code>[x]</code>, for those <code>x</code> that satisfy the predicate <code>p</code>; or an empty list, for those <code>x</code> that do not satisfy the predicate. Thus, the result of <code>map box</code> will be a list of empty lists and singleton lists.</p>\n\n<p>Let's consider an example. Let's say that:</p>\n\n<pre><code>input_list = [1,2,3,4,5]\np = odd\n</code></pre>\n\n<p>Then:</p>\n\n<pre><code>map box input_list = [ [1], [], [3], [], [5] ]\n</code></pre>\n\n<p>The first element <code>1</code> was mapped to <code>[1]</code>, because <code>p 1 == True</code>. The second element <code>2</code> was mapped to <code>[]</code>, because <code>p 2 == False</code>. And so on.</p>\n\n<p>After that, <code>concat</code> is applied to this list of lists. It concatenates all those small lists into a big list. So in our example:</p>\n\n<pre><code>concat [ [1], [], [3], [], [5] ] = [1] ++ [] ++ [3] ++ [] ++ [5] = [1,3,5]\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 8168791, "user_type": "registered", "profile_image": "https://graph.facebook.com/1685691695074031/picture?type=large", "display_name": "Marcos Ayala", "link": "https://stackoverflow.com/users/8168791/marcos-ayala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 418, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1524520093, "creation_date": 1524512697, "last_edit_date": 1524520093, "question_id": 49988841, "link": "https://stackoverflow.com/questions/49988841/implementing-filter-with-concat-and-map-in-haskell", "title": "Implementing filter with concat and map in Haskell", "body": "<pre><code>filter1 :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\nfilter1 p = concat.map box\n              where box x\n                    | p x       = [x]\n                    | otherwise = []\n</code></pre>\n\n<p>I don't understand this solution. \nmap apply box to all the elements of the list and if p x == True it's puts the element on a list of a single element and then concat unificates everything? concat unify everything at the end or one by one?</p>\n\n<p>Thanks! I hope somebody understands this</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "edited": false, "score": 1, "creation_date": 1524503572, "post_id": 49986462, "comment_id": 86989348, "body": "<code>else hasRating y z xs</code> shouldn&#39;t it be <code>exists</code>? Also take a look at any <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Prelude.html#v:any\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.11.1.0/docs/&hellip;</a> , and learn to use <a href=\"https://www.haskell.org/hoogle/\" rel=\"nofollow noreferrer\">haskell.org/hoogle</a> to easily find base functions that you can use as a construction blocks."}, {"owner": {"reputation": 801, "user_id": 7130982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10155393562339298/picture?type=large", "display_name": "Omar Hussein", "link": "https://stackoverflow.com/users/7130982/omar-hussein"}, "reply_to_user": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "edited": false, "score": 0, "creation_date": 1524503723, "post_id": 49986462, "comment_id": 86989411, "body": "same error after changing"}, {"owner": {"reputation": 3355, "user_id": 4114447, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/aa93321ad023953eaaae28b490855e7a?s=128&d=identicon&r=PG&f=1", "display_name": "Dan M.", "link": "https://stackoverflow.com/users/4114447/dan-m"}, "edited": false, "score": 1, "creation_date": 1524503836, "post_id": 49986462, "comment_id": 86989463, "body": "What is the code for the <code>extract*</code> functions? Most likely you have the same code for <code>extractuser </code> and <code>extractitem</code> (copy/paster error)."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1524504141, "post_id": 49986462, "comment_id": 86989618, "body": "Oh, is this <code>hugs</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 801, "user_id": 7130982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10155393562339298/picture?type=large", "display_name": "Omar Hussein", "link": "https://stackoverflow.com/users/7130982/omar-hussein"}, "edited": false, "score": 1, "creation_date": 1524504805, "post_id": 49986719, "comment_id": 86989971, "body": "You&#39;re actually right my extractitem was flawed as you described, both it and your method works, thanks for the help man you rock."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 801, "user_id": 7130982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10155393562339298/picture?type=large", "display_name": "Omar Hussein", "link": "https://stackoverflow.com/users/7130982/omar-hussein"}, "edited": false, "score": 0, "creation_date": 1524504848, "post_id": 49986719, "comment_id": 86989991, "body": "@OmarHussein awesome, glad I could help!"}, {"owner": {"reputation": 801, "user_id": 7130982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10155393562339298/picture?type=large", "display_name": "Omar Hussein", "link": "https://stackoverflow.com/users/7130982/omar-hussein"}, "edited": false, "score": 0, "creation_date": 1524505208, "post_id": 49986719, "comment_id": 86990158, "body": "I&#39;d just like to note that your approach only checks a single tuple as opposed to the list I wanted to check in the question, I used it as a helper method and iterated over the list."}, {"owner": {"reputation": 1096, "user_id": 5021447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-gwPYP717ZyU/AAAAAAAAAAI/AAAAAAAAAP8/WoyhftM4PuU/photo.jpg?sz=128", "display_name": "Jordan Mackie", "link": "https://stackoverflow.com/users/5021447/jordan-mackie"}, "edited": false, "score": 1, "creation_date": 1524513743, "post_id": 49986719, "comment_id": 86994588, "body": "exists is missing the base case: <code>exists _ _ [] = False</code>"}], "tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": true, "score": 7, "last_activity_date": 1524514917, "last_edit_date": 1524514917, "creation_date": 1524504282, "answer_id": 49986719, "question_id": 49986462, "link": "https://stackoverflow.com/questions/49986462/haskell-multiple-tuple-check-in-list/49986719#49986719", "title": "Haskell multiple tuple check in list", "body": "<p>You should be able to do this entirely with pattern matching. Your current error <em>appears</em> to be a typo, but pattern matching is more straightforward and serves to eliminate some of those errors.</p>\n\n<pre><code>exists :: (Eq a, Eq b) =&gt; a -&gt; b -&gt; [(a, b, c)] -&gt; Bool\nexists u i ((u', i', _):xs) = u == u' &amp;&amp; i == i' || exists u i xs\nexists _ _ []               = False\n</code></pre>\n\n<p>or with less explicit recursion:</p>\n\n<pre><code>exists :: (Eq a, Eq b) =&gt; a -&gt; b -&gt; [(a, b, c)] -&gt; Bool\nexists u i = any (\\(u', i', _) -&gt; u==u' &amp;&amp; i==i')\n</code></pre>\n\n<hr>\n\n<p>The error message</p>\n\n<pre><code>Inferred type is not general enough  \n*** Expression    : exists  \n*** Expected type : (Eq a, Eq b) =&gt; a -&gt; b -&gt; [(a,b,c)] -&gt; Bool  \n*** Inferred type : (Eq a, Eq a) =&gt; a -&gt; a -&gt; [(a,a,b)] -&gt; Bool\n</code></pre>\n\n<p>seems to indicate that your <code>extractitem</code> function is doing:</p>\n\n<pre><code>extractitem (x, _, _) = x\n</code></pre>\n\n<p>when it should be</p>\n\n<pre><code>extractitem (_, y, _) = y\n</code></pre>\n"}], "owner": {"reputation": 801, "user_id": 7130982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10155393562339298/picture?type=large", "display_name": "Omar Hussein", "link": "https://stackoverflow.com/users/7130982/omar-hussein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 185, "favorite_count": 0, "accepted_answer_id": 49986719, "answer_count": 1, "score": -1, "last_activity_date": 1524514917, "creation_date": 1524503327, "last_edit_date": 1524503693, "question_id": 49986462, "link": "https://stackoverflow.com/questions/49986462/haskell-multiple-tuple-check-in-list", "title": "Haskell multiple tuple check in list", "body": "<p>Say I have a list of elements in this format\n(U \"NAME\", I \"Item Name\", INT_HERE)\nI would like to make a function that takes a U, an I and checks if they exist in that list in any of the elements and return true if yes, else otherwise.\nfor example </p>\n\n<pre><code>exists (U \"John\") (I \"Sofa\") \n[(U \"Mark\" , I \"Legion Y520\", 5),\n(U \"Ahmed\" ,I \"GTX 1060\", 3),\n(U \"Carole\" , I \"BMW C-Class\", 5),\n(U \"John\" , I \"Maximized outlet\", 4),\n(U \"Malik\" , I \"Honda Civic\", 1)]\n</code></pre>\n\n<p>should return <strong>False</strong></p>\n\n<p>this is the code I have tried using(extractitem and extractuser both extract the first and second part of the item properly and I have tested them, issue should be with this part)</p>\n\n<pre><code>exists :: (Eq a, Eq b) =&gt; a -&gt; b -&gt; [(a,b,c)] -&gt; Bool\nexists y z [] = False\nexists y z (x:xs) = if ((extractuser x) == y) then if ((extractitem x) == \nz) then True else False else exists y z xs\n</code></pre>\n\n<p>and this is the error im getting</p>\n\n<pre><code>Inferred type is not general enough\n*** Expression    : exists\n*** Expected type : (Eq a, Eq b) =&gt; a -&gt; b -&gt; [(a,b,c)] -&gt; Bool\n*** Inferred type : (Eq a, Eq a) =&gt; a -&gt; a -&gt; [(a,a,b)] -&gt; Bool\n</code></pre>\n\n<p>I would also like to make a second function get that has the same functionality with the difference that it actually displays the element which the conditions applies to / give out an error message if it doesn't exist.</p>\n"}, {"tags": ["haskell", "polymorphism", "representation"], "comments": [{"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 1, "creation_date": 1524506902, "post_id": 49986342, "comment_id": 86991016, "body": "I suppose that <code>\u22a5</code> is any computation that cannot terminate normally, including e.g. infinite loops. OTOH <code>undefined</code> is a known <i>value</i> which is checked for at runtime."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 3, "creation_date": 1524507976, "post_id": 49986342, "comment_id": 86991530, "body": "@9000 But the definition of unlifted types is explicitly that they do not have that known value as an inhabitant. I think this question is quite well-motivated, and I myself am curious about the answer."}, {"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1524508553, "post_id": 49986342, "comment_id": 86991836, "body": "@DanielWagner: I fail to see a contradiction. &#171;The element <code>\u22a5</code> does not exist in an unlifted type&#187;; <code>undefined</code> \u2260 <code>\u22a5</code>. I also don&#39;t think that <code>I# (undefined :: Int#)</code> actually &quot;produces&quot; an <code>undefined</code> of type <code>Int#</code>. I suppose that at the first moment strict evaluation touches an &quot;undefined&quot;, it raises an exception, and this is special-cased, as opposed to adding an <code>undefined</code> to every type."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 1, "creation_date": 1524508787, "post_id": 49986342, "comment_id": 86991944, "body": "@9000 Hm. <code>undefined</code> is synonymous with \u22a5 in every discussion of Haskell semantics I know of; why do you believe they are not equal? Or, what equality relation are you using that does not conflate them, and why do you believe that is the equality intended by the discussion in the question above?"}, {"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1524509445, "post_id": 49986342, "comment_id": 86992263, "body": "@DanielWagner: I&#39;m looking <a href=\"https://en.wikipedia.org/wiki/Bottom_type#Computer_science_applications\" rel=\"nofollow noreferrer\">at wikipedia</a> which states: &#171;The bottom type is frequently used for the following purposes: To signal that a function or computation diverges; in other words, does not return a result to the caller.&#187; That is, a bottom&#39;s meaning may be an infinite loop, a crash, an exit, etc. It therefore <i>can not</i> be returned as a value. This is why it cannot inhabit a type of a strict / unlifted computation; in a lazy computation, it can be deferred."}, {"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 1, "creation_date": 1524509449, "post_id": 49986342, "comment_id": 86992264, "body": "I <i>don&#39;t know</i> if <code>undefined</code> is indeed a value (that is, something that can be strictly computed and returned). I can imagine that it&#39;s not; then it can represent the bottom value. But then it also cannot be &quot;instantiated&quot;, as the OP tries to do. OTOH if it were a value that can be computed, then it won&#39;t be bottom. So I suppose that computation around <code>undefined</code> is special-cased in compiler and runtime. It can be cast to any type, but not actually touched, so an attempt to construct in for an unlifted type should fail immediately (this must be easy to check)."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 2, "creation_date": 1524510843, "post_id": 49986342, "comment_id": 86993044, "body": "@9000 This is the bottom value, not the bottom type. That said: yes, an infinite loop, a crash, an exit, an exception are all bottom (and semantically identical -- the fact that Haskell occasionally lets you distinguish them is cheating in some ways). <code>undefined</code> throws an exception, and is bottom in that way."}, {"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 1, "creation_date": 1524511121, "post_id": 49986342, "comment_id": 86993213, "body": "Hence we seem to have an answer: <code>undefined</code> may be levity-polymorphic because it&#39;s special-cased. It cannot be computed, by definition, so it can take part in any lazy computation as long as it&#39;s lazy, but an attempt to construct it for an unlifted type (with which it is  type-compatible) ends with a runtime error, &quot;producing&quot; the bottom value."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 7, "creation_date": 1524511545, "post_id": 49986342, "comment_id": 86993453, "body": "One thing is that a variable (and even the dummy pattern <code>_</code>) can never be bound to a bottom value of an unlifted type. Given <code>f (x :: Int#) = ...</code>, if I call <code>f undefined</code>, execution will never reach the right-hand side. GHC will attempt to evaluate <code>undefined</code> <i>before</i> calling <code>f</code>."}, {"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1524512055, "post_id": 49986342, "comment_id": 86993760, "body": "@dfeuer: Yes, because a value of bottom type is basically a crashed (or hung) computation, so the computation will crash (with an exception) before binding."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1524512456, "post_id": 49986342, "comment_id": 86993941, "body": "Another point: I&#39;m quite confident you actually <i>can&#39;t</i> write <code>undefined</code> with the signature you indicate. Its <code>HasCallStack</code> constraint is necessary to satisfy the type checker. That makes it (effectively) a function rather than a value."}, {"owner": {"reputation": 3128, "user_id": 3040129, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TcwLC.png?s=128&g=1", "display_name": "illabout", "link": "https://stackoverflow.com/users/3040129/illabout"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1524535970, "post_id": 49986342, "comment_id": 87001446, "body": "@dfeuer Good point about <code>HasCallStack</code>.  I took it out, hoping to make the type signature for <code>undefined</code> a little easier to read.  It makes sense that it is actually necessary!"}], "answers": [{"tags": [], "owner": {"reputation": 259, "user_id": 1062395, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/o9kzo.jpg?s=128&g=1", "display_name": "Richard Eisenberg", "link": "https://stackoverflow.com/users/1062395/richard-eisenberg"}, "is_accepted": true, "score": 14, "last_activity_date": 1525100208, "creation_date": 1525100208, "answer_id": 50103121, "question_id": 49986342, "link": "https://stackoverflow.com/questions/49986342/why-is-the-undefined-function-levity-polymorphic-when-using-it-with-unboxed-type/50103121#50103121", "title": "Why is the undefined function levity-polymorphic when using it with unboxed types?", "body": "<p>Author of the \"Levity Polymorphism\" paper here.</p>\n\n<p>First, I want to clear up a few misconceptions stated above:</p>\n\n<ul>\n<li><p><code>Bool</code> is indeed a lifted, boxed type. However, it still has only 2 values: <code>True</code> and <code>False</code>. The expression \u22a5 is simply not a value. It's an expression, and a variable can be bound to \u22a5, but that doesn't make \u22a5 a value. Perhaps a better way of saying this all is that, if <code>x :: Bool</code>, then evaluating <code>x</code> can lead to three different results: evaluating to <code>True</code>, evaluating to <code>False</code>, and \u22a5. Here, \u22a5 represents any computation that doesn't terminate normally, including throwing an exception (which is what <code>undefined</code> really does) and looping forever.</p></li>\n<li><p>Similar to that last point, <code>undefined</code> is not a value. It's an inhabitant of any type, but it's not a value. A value is something that, when evaluated, does nothing -- but <code>undefined</code> doesn't meet that specification.</p></li>\n<li><p>Depending on how you look at it, \u22a5 <em>can</em> exist in an unlifted type. For example, take this definition:</p>\n\n<pre><code>loop :: () -&gt; Int#\nloop x = loop x\n</code></pre>\n\n<p>This definition is accepted by GHC. Yet <code>loop ()</code> is a \u22a5 element of the unlifted, unboxed type <code>Int#</code>. The difference between an unlifted type and a lifted type in this regard is that there is no way to bind a variable to <code>loop ()</code>. Any attempt to do so (like <code>let z = loop () in ...</code>) will loop before the variable ever gets bound.</p>\n\n<p>Note that this is no different than an infinitely recursive function in an unmanaged language, like C.</p></li>\n</ul>\n\n<p>So, how is it that we allow <code>undefined</code> to have an unlifted type? @dfeuer has it right: <code>undefined</code> is secretly a function. Its full type signature is <code>undefined :: forall (r :: RuntimeRep) (a :: TYPE r). HasCallStack =&gt; a</code>, meaning that it's a function, just like <code>loop</code>, above. At runtime, it will take the current call stack as a parameter. So, whenever you use <code>undefined</code>, you're just calling a function that throws an exception, causing no trouble.</p>\n\n<p>Indeed, when designing levity polymorphism, we struggled with <code>undefined</code> for quite some time, with all sorts of shenanigans to make it work out. Then, when we realized that <code>undefined</code> had the <code>HasCallStack</code> constraint, we saw that we could just dodge the problem entirely. I honestly don't know what we would have done without the seemingly inconsequential user convenience of <code>HasCallStack</code>.</p>\n"}], "owner": {"reputation": 3128, "user_id": 3040129, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TcwLC.png?s=128&g=1", "display_name": "illabout", "link": "https://stackoverflow.com/users/3040129/illabout"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 319, "favorite_count": 5, "accepted_answer_id": 50103121, "answer_count": 1, "score": 14, "last_activity_date": 1525100208, "creation_date": 1524502891, "question_id": 49986342, "link": "https://stackoverflow.com/questions/49986342/why-is-the-undefined-function-levity-polymorphic-when-using-it-with-unboxed-type", "title": "Why is the undefined function levity-polymorphic when using it with unboxed types?", "body": "<p>I just got finished reading the paper <a href=\"https://cs.brynmawr.edu/~rae/papers/2017/levity/levity-extended.pdf\" rel=\"noreferrer\">Levity Polymorphism</a>.</p>\n\n<p>I had a question about why <a href=\"https://hackage.haskell.org/package/base-4.11.1.0/docs/Prelude.html#v:undefined\" rel=\"noreferrer\"><code>undefined</code></a> can be levity-polymorphic when used as an unboxed type.</p>\n\n<p>First, let's start with some definitions of boxity from the paper:</p>\n\n<ul>\n<li><p><strong>boxed</strong>:</p>\n\n<ul>\n<li><p>A <strong>boxed</strong> value is represented by a pointer into the heap.</p></li>\n<li><p><code>Int</code> and <code>Bool</code> are examples of types that have <strong>boxed</strong> values.</p></li>\n</ul></li>\n<li><p><strong>unboxed</strong>:</p>\n\n<ul>\n<li><p>An <strong>unboxed</strong> value is represented by the value itself (<em>not</em> a pointer to the heap).</p></li>\n<li><p><a href=\"https://hackage.haskell.org/package/ghc-prim-0.5.2.0/docs/GHC-Prim.html#g:3\" rel=\"noreferrer\"><code>Int#</code></a> and <a href=\"https://hackage.haskell.org/package/ghc-prim-0.5.2.0/docs/GHC-Prim.html#g:2\" rel=\"noreferrer\"><code>Char#</code></a> from the <a href=\"https://hackage.haskell.org/package/ghc-prim-0.5.2.0/docs/GHC-Prim.html\" rel=\"noreferrer\"><code>GHC.Prim</code></a> module are examples of types with <strong>unboxed</strong> values.</p></li>\n<li><p>An <strong>unboxed</strong> value cannot be a thunk.  Function arguments of unboxed types must be passed by value.</p></li>\n</ul></li>\n</ul>\n\n<p>The paper follows with some definitions of levity:</p>\n\n<ul>\n<li><p><strong>lifted</strong>:</p>\n\n<ul>\n<li><p>A <strong>lifted</strong> type is one that is lazy.</p></li>\n<li><p>A <strong>lifted</strong> type has on extra element beyond the normal ones, representing a non-terminating computation.</p></li>\n<li><p>For example, the type <code>Bool</code> is <strong>lifted</strong>, meaning that there are three different values for <code>Bool</code>: <code>True</code>, <code>False</code>, and <code>\u22a5</code> (bottom).</p></li>\n<li><p>All <strong>lifted</strong> types MUST be <strong>boxed</strong>.</p></li>\n</ul></li>\n<li><p><strong>unlifted</strong></p>\n\n<ul>\n<li><p>An <strong>unlifted</strong> type is one that is strict.</p></li>\n<li><p>The element <code>\u22a5</code> does not exist in an <strong>unlifted</strong> type.</p></li>\n<li><p><code>Int#</code> and <code>Char#</code> are examples of <strong>unlifted</strong> types.</p></li>\n</ul></li>\n</ul>\n\n<p>The paper goes on to explain how GHC 8 provides functionality allowing type variables to have polymorphic levity.</p>\n\n<p>This allows you to write a levity-polymorphic <a href=\"https://hackage.haskell.org/package/base-4.11.1.0/docs/Prelude.html#v:undefined\" rel=\"noreferrer\"><code>undefined</code></a> with the following type:</p>\n\n<pre><code>undefined :: forall (r :: RuntimeRep). forall (a :: TYPE r). a\n</code></pre>\n\n<p>This says that <code>undefined</code> should work for <em>any</em> <code>RuntimeRep</code>, even unlifted types.</p>\n\n<p>Here is an example of using <code>undefined</code> as an unboxed, unlifted <code>Int#</code> in GHCi:</p>\n\n<pre><code>&gt; :set -XMagicHash\n&gt; import GHC.Prim\n&gt; import GHC.Exts\n&gt; I# (undefined :: Int#)\n*** Exception: Prelude.undefined\n</code></pre>\n\n<hr>\n\n<p>I've always thought of <code>undefined</code> as being the same as <code>\u22a5</code> (bottom).  However, the paper says, \"The element <code>\u22a5</code> does not exist in an unlifted type.\"</p>\n\n<p>What is going on here? Is <code>undefined</code> not actually <code>\u22a5</code> when used as an unlifted type?  Am I misunderstanding something about the paper (or boxity or levity)?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524497516, "post_id": 49984788, "comment_id": 86985937, "body": "Great function! What have you tried?"}, {"owner": {"reputation": 801, "user_id": 7130982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10155393562339298/picture?type=large", "display_name": "Omar Hussein", "link": "https://stackoverflow.com/users/7130982/omar-hussein"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524497573, "post_id": 49984788, "comment_id": 86985969, "body": "stackOverFlowFunctionn :: Eq a =&gt; [(b,a,c)] -&gt; [a] stackOverFlowFunctionn  ((b,a,c):xs) = a"}, {"owner": {"reputation": 801, "user_id": 7130982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10155393562339298/picture?type=large", "display_name": "Omar Hussein", "link": "https://stackoverflow.com/users/7130982/omar-hussein"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524497601, "post_id": 49984788, "comment_id": 86985986, "body": "Got a unification would give infinite type error"}], "answers": [{"comments": [{"owner": {"reputation": 801, "user_id": 7130982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10155393562339298/picture?type=large", "display_name": "Omar Hussein", "link": "https://stackoverflow.com/users/7130982/omar-hussein"}, "edited": false, "score": 0, "creation_date": 1524498457, "post_id": 49984966, "comment_id": 86986514, "body": "ERROR - Undefined data constructor &quot;I&quot; on using this"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 801, "user_id": 7130982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10155393562339298/picture?type=large", "display_name": "Omar Hussein", "link": "https://stackoverflow.com/users/7130982/omar-hussein"}, "edited": false, "score": 0, "creation_date": 1524498505, "post_id": 49984966, "comment_id": 86986544, "body": "Well, where is is supposed to come from? Your input implies it is already defined."}, {"owner": {"reputation": 801, "user_id": 7130982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10155393562339298/picture?type=large", "display_name": "Omar Hussein", "link": "https://stackoverflow.com/users/7130982/omar-hussein"}, "edited": false, "score": 0, "creation_date": 1524498619, "post_id": 49984966, "comment_id": 86986632, "body": "My bad forgot to include the declaration, the recursion approach works fine, many thanks"}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 2, "last_activity_date": 1524498643, "last_edit_date": 1524498643, "creation_date": 1524498093, "answer_id": 49984966, "question_id": 49984788, "link": "https://stackoverflow.com/questions/49984788/separate-elements-and-return-in-haskell/49984966#49984966", "title": "Separate elements and return in haskell", "body": "<p>Your function takes a list, but only returns a <em>single</em> value. As-is, you need recursion to <em>add</em> the extracted value to the list of the rest of such values.</p>\n\n<pre><code>stackOverflowFunction [] = []\nstackOverflowFunction ((b,a,c):xs) = a : stackOverflowFunction xs\n</code></pre>\n\n<p>However, this just duplicates the recursion scheme implemented by the <code>map</code> function:</p>\n\n<pre><code>extract :: (b, a, c) -&gt; a\nextract (_, a, _) = a\n\nstackOverflowFunction :: [(b, a, c)] -&gt; [a]\nstackOverflowFunction xs = dis (map extract xs)\n-- stackOverflowFunction xs = dis (map (\\(_,a,_) -&gt; a) xs)\n</code></pre>\n\n<p>With these, </p>\n\n<pre><code>&gt;&gt;&gt; extract (U \"John\" , I \"GTX 1070\", 5)\nI \"GTX 1070\"\n&gt;&gt;&gt; stackOverflowFunction [(U \"John\" , I \"GTX 1070\", 5), (U \"Ahmed\" , I \"Lenovo Y5070\", 3), (U \"Carole\" , I \"Honda Civic\", 5), (U \"Nada\" , I \"Honda Civic\", 4),(U \"Ahmed\" , I \"GTX 1070\", 1)]\n&gt;&gt;&gt; [I \"GTX 1070\",I \"Lenovo Y5070\",I \"Honda Civic\"]\n</code></pre>\n\n<p>(Presumed output of your <code>dis</code> function.)</p>\n"}, {"comments": [{"owner": {"reputation": 801, "user_id": 7130982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10155393562339298/picture?type=large", "display_name": "Omar Hussein", "link": "https://stackoverflow.com/users/7130982/omar-hussein"}, "edited": false, "score": 0, "creation_date": 1524498780, "post_id": 49985046, "comment_id": 86986720, "body": "This is perfect, didn&#39;t know about nub so now I don&#39;t need my distinct helper either, thanks!"}], "tags": [], "owner": {"reputation": 1096, "user_id": 5021447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-gwPYP717ZyU/AAAAAAAAAAI/AAAAAAAAAP8/WoyhftM4PuU/photo.jpg?sz=128", "display_name": "Jordan Mackie", "link": "https://stackoverflow.com/users/5021447/jordan-mackie"}, "is_accepted": true, "score": 3, "last_activity_date": 1524498339, "creation_date": 1524498339, "answer_id": 49985046, "question_id": 49984788, "link": "https://stackoverflow.com/questions/49984788/separate-elements-and-return-in-haskell/49985046#49985046", "title": "Separate elements and return in haskell", "body": "<p>You're after a slightly modified <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Data-List.html#v:nub\" rel=\"nofollow noreferrer\"><code>nub</code></a>:</p>\n\n<pre><code>data I = I String deriving (Show, Eq)\ndata U = U String deriving (Show, Eq)\n\nnubI :: [(U, I, Int)] -&gt; [I]\nnubI = nub . map (\\(_, i, _) -&gt; i)\n</code></pre>\n\n<p>Which gives...</p>\n\n<pre><code>&gt; nubI [(U \"John\" , I \"GTX 1070\", 5), (U \"Ahmed\" , I \"Lenovo Y5070\", 3), (U \"Carole\" , I \"Honda Civic\", 5), (U \"Nada\" , I \"Honda Civic\", 4),(U \"Ahmed\" , I \"GTX 1070\", 1)]\n[I \"GTX 1070\",I \"Lenovo Y5070\",I \"Honda Civic\"]\n</code></pre>\n"}], "owner": {"reputation": 801, "user_id": 7130982, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10155393562339298/picture?type=large", "display_name": "Omar Hussein", "link": "https://stackoverflow.com/users/7130982/omar-hussein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 49985046, "answer_count": 2, "score": -1, "last_activity_date": 1524499858, "creation_date": 1524497473, "last_edit_date": 1524499858, "question_id": 49984788, "link": "https://stackoverflow.com/questions/49984788/separate-elements-and-return-in-haskell", "title": "Separate elements and return in haskell", "body": "<p>I need to implement a Haskell function that takes a list of elements in the form of <code>(U \"NAME\", I \"Item Name\", INT_HERE)</code> and returns the \"Item Name\" part of each, I would like however to only return each distinct \"Item name\" once if it's repeated, I have already implemented the function <code>(dis :: Eq a =&gt; [a] -&gt; [a])</code> that filters only distinct values in a list.</p>\n\n<p>For example, for this input:</p>\n\n<pre><code>stackOverFlowFunction [(U \"John\" , I \"GTX 1070\", 5), \n                       (U \"Ahmed\" , I \"Lenovo Y5070\", 3), \n                       (U \"Carole\" , I \"Honda Civic\", 5), \n                       (U \"Nada\" , I \"Honda Civic\", 4),\n                       (U \"Ahmed\" , I \"GTX 1070\", 1)]\n</code></pre>\n\n<p>It should return</p>\n\n<pre><code>[I \"GTX 1070\", I \"Lenovo Y5070\", I \"Honda Civic\"]\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1524493911, "post_id": 49983629, "comment_id": 86983532, "body": "This is not a typeclass... But a <code>data</code>type. Datatypes act like records. One of the crucial differences is still that data is immutable in Haskell. A typeclass in Haskell is usually closer to what is known in OO programming as an <i>interface</i>."}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "edited": false, "score": 2, "creation_date": 1524494143, "post_id": 49983629, "comment_id": 86983659, "body": "It seems there are two different questions here. The title asks about typeclasses whereas the question asks about datatypes. Those are two <i>very</i> different concepts in Haskell, so which are you asking about?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1524494687, "post_id": 49983629, "comment_id": 86984044, "body": "Your Haskell code is incorrect anyway. <code>age</code> is predefined by the record syntax, and <code>p = Person &quot;bob&quot; &quot;smith&quot; 34 1.7 &quot;123-4567&quot; &quot;?&quot;; newage = age  (p { age = 35} )</code> would be closer to the mark."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1524495139, "post_id": 49983629, "comment_id": 86984369, "body": "If you remove PHP inheritance, Haskell&#39;s parametric types, PHP mutability, Haskell&#39;s multiple constructors and pattern matching, PHP methods, Haskell&#39;s higher kinds, etc. etc. eventually you get something similarly trivial, but perhaps it&#39;s not that interesting."}], "answers": [{"comments": [{"owner": {"reputation": 3148, "user_id": 2693928, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f4c1419246c9c4d03a08f7c5db65303e?s=128&d=identicon&r=PG&f=1", "display_name": "user2693928", "link": "https://stackoverflow.com/users/2693928/user2693928"}, "edited": false, "score": 0, "creation_date": 1524495435, "post_id": 49983959, "comment_id": 86984577, "body": "Thanks, but can i ask in haskell if i have age for data Person and Manager for example: age (Person p) = p.age   age (Manager m) = m.managerAge  Doesnt this break Open Closed principle?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1524495738, "post_id": 49983959, "comment_id": 86984788, "body": "In versions of Haskell that allow duplicate field names, the function really takes <i>two</i> arguments, a type and a value of that type. With the appropriate extension, you can add the type argument explicitly: <code>age @Person p</code> instead of <code>age p</code> (which infers the correct &quot;version&quot; of <code>age</code> from the argument <code>p</code>)."}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "reply_to_user": {"reputation": 3148, "user_id": 2693928, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f4c1419246c9c4d03a08f7c5db65303e?s=128&d=identicon&r=PG&f=1", "display_name": "user2693928", "link": "https://stackoverflow.com/users/2693928/user2693928"}, "edited": false, "score": 0, "creation_date": 1524496065, "post_id": 49983959, "comment_id": 86984997, "body": "@user2693928: What&#39;s a Manager? This sounds like you&#39;re mixing object-oriented inheritance into Haskell data types. The Open/Closed Principle mostly applies to OOP. If you&#39;d like to know how it applies to functional programming, I think you should ask a new question. See <a href=\"https://stackoverflow.com/questions/5577054/solid-for-functional-programming\">SOLID for functional programming</a>, <a href=\"http://gorodinski.com/blog/2013/09/18/oop-patterns-from-a-functional-perspective/\" rel=\"nofollow noreferrer\">Object-oriented Design Patterns From a Functional Perspective</a>, etc."}, {"owner": {"reputation": 3148, "user_id": 2693928, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f4c1419246c9c4d03a08f7c5db65303e?s=128&d=identicon&r=PG&f=1", "display_name": "user2693928", "link": "https://stackoverflow.com/users/2693928/user2693928"}, "edited": false, "score": 0, "creation_date": 1524496316, "post_id": 49983959, "comment_id": 86985141, "body": "I have different type of form fields: TextField, PasswordField, etc. How can i add new field type like (AutocompleterField) without breaking Open closed principle. I want new fields to be pluggable. All code for different field to be in a separate file instead of defining all different implementations in one place."}, {"owner": {"reputation": 22377, "user_id": 2288659, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/bBg8v.png?s=128&g=1", "display_name": "Silvio Mayolo", "link": "https://stackoverflow.com/users/2288659/silvio-mayolo"}, "reply_to_user": {"reputation": 3148, "user_id": 2693928, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f4c1419246c9c4d03a08f7c5db65303e?s=128&d=identicon&r=PG&f=1", "display_name": "user2693928", "link": "https://stackoverflow.com/users/2693928/user2693928"}, "edited": false, "score": 0, "creation_date": 1524497100, "post_id": 49983959, "comment_id": 86985671, "body": "@user2693928 It seems to me that you&#39;re trying to directly apply OO principles in Haskell. While this is ostensibly doable, it will result in unidiomatic and, frankly ugly, Haskell code. You&#39;d do better to learn the functional idioms used in Haskell and rethink your design using those principles."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1524497429, "post_id": 49983959, "comment_id": 86985883, "body": "Haskell data types can allow several constructors, similarly to variant types in some other languages. A type <code>data T = A Int | B String</code> has no int fields, and has no string fields. It could be modeled in OOP through inheritance from an empty base class and abusing <code>instanceof</code> -- or better, through the visitor pattern (which can model any algebraic data type)."}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 0, "creation_date": 1524498351, "post_id": 49983959, "comment_id": 86986447, "body": "Stackoverflow works best if you contain questions. If they keep expanding, then both comments and continually changing your questions are terrible ways to have a longer discussion."}], "tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": false, "score": 5, "last_activity_date": 1524494924, "creation_date": 1524494924, "answer_id": 49983959, "question_id": 49983629, "link": "https://stackoverflow.com/questions/49983629/haskell-type-classes/49983959#49983959", "title": "Haskell type classes", "body": "<p>Besides the confusion between <em>type classes</em> and <em>data types</em>, you may want to read <a href=\"https://wiki.haskell.org/OOP_vs_type_classes\" rel=\"noreferrer\">OOP vs. Haskell type classes</a>. <em>Data types</em>, which you use, behave much like immutable objects. So Haskell's</p>\n\n<pre><code>data Person = Person { age :: Int }\n\np1, p2 :: Person\np1 = Person { age = 35 }\np2 = p1 { age = age p1 + 1 }\n</code></pre>\n\n<p>might be written in ES6 like</p>\n\n<pre><code>class Person {\n    constructor(age) {\n        this.age = age;\n    }\n}\n\np1 = new Person(35);\np2 = new Person(p1.age + 1);\n</code></pre>\n\n<p>In ES6 this does not guarantee against immutability, though. For that, see <a href=\"https://wecodetheweb.com/2016/02/12/immutable-javascript-using-es6-and-beyond/\" rel=\"noreferrer\">the <code>const</code> and <code>...</code> keywords</a> for merging the properties of objects without changing the original objects. The article discusses various other solutions but ends up suggesting:</p>\n\n<pre><code>const p1 = {\n    age: 35\n}\n\nconst p2 = {\n    ...p1,\n    age: p1.age + 1\n}\n</code></pre>\n"}], "owner": {"reputation": 3148, "user_id": 2693928, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f4c1419246c9c4d03a08f7c5db65303e?s=128&d=identicon&r=PG&f=1", "display_name": "user2693928", "link": "https://stackoverflow.com/users/2693928/user2693928"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1524495381, "creation_date": 1524493835, "last_edit_date": 1524495381, "question_id": 49983629, "link": "https://stackoverflow.com/questions/49983629/haskell-type-classes", "title": "Haskell type classes", "body": "<p>How haskell types are different than regular PHP classes.</p>\n\n<p>If i disable extending can I simulate something similar in PHP or JavaScript.</p>\n\n<p>Haskell:</p>\n\n<pre><code>data Person = Person { firstName :: String  \n                      , lastName :: String  \n                      , age :: Int  \n                      , height :: Float  \n                      , phoneNumber :: String  \n                      , flavor :: String \nage :: Person -&gt; Int  \nage (Person p) = p.age  \n\nnewAge = age(Person {age:=35})\n</code></pre>\n\n<p>Js:</p>\n\n<pre><code>class Person {\n    constructor(data) {\n        this.data = data\n    }\n}\nfunction age(p) {\n   if (p instanceof Person) return p.age\n}\nlet personAge = age(new Person({age: 35})); // 35\n</code></pre>\n\n<p>There can be syntax errors but ignore them.</p>\n\n<p>In a nutshell if I dont use inheritance the js code is similar to Haskell's.</p>\n\n<p>I dont have pattern matching but i can use \"if instanceof \" to check types. </p>\n"}, {"tags": ["docker", "haskell", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 1872, "user_id": 701940, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d6ea807bc634041db1c8ad327b770ee2?s=128&d=identicon&r=PG", "display_name": "Tehnix", "link": "https://stackoverflow.com/users/701940/tehnix"}, "edited": false, "score": 0, "creation_date": 1524562077, "post_id": 49990908, "comment_id": 87012247, "body": "Ah, I think I misunderstood <i>&quot;Please note that in a docker-enabled configuration, stack uses the GHC installed in the Docker container by default. To use a compiler installed by stack, add system-ghc: false&quot;</i> <a href=\"https://docs.haskellstack.org/en/stable/docker_integration/#enable-in-stackyaml\" rel=\"nofollow noreferrer\">from the docs</a> to mean, that if you want a stack installed GHC <b>inside the docker</b> then you needed to disable it. Currently trying out to build it with this, crossing fingers! :) (have a feeling, as you mentioned, that the compiler-check is causing issues)"}, {"owner": {"reputation": 1872, "user_id": 701940, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d6ea807bc634041db1c8ad327b770ee2?s=128&d=identicon&r=PG", "display_name": "Tehnix", "link": "https://stackoverflow.com/users/701940/tehnix"}, "edited": false, "score": 0, "creation_date": 1524567698, "post_id": 49990908, "comment_id": 87015928, "body": "It seems stack can&#39;t find the compiler---I&#39;ve updated my question with the log output from building it with your suggested configuration."}, {"owner": {"reputation": 1872, "user_id": 701940, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d6ea807bc634041db1c8ad327b770ee2?s=128&d=identicon&r=PG", "display_name": "Tehnix", "link": "https://stackoverflow.com/users/701940/tehnix"}, "edited": false, "score": 1, "creation_date": 1524596221, "post_id": 49990908, "comment_id": 87034510, "body": "Hmm, I was thinking it might be because stack sets the user? <code>-e USER=christiankjaerlaustsen</code>, and the GHCJS has been compiled at <code>&#47;root&#47;.stack&#47;...</code>. Btw, if you want to move around in the image, a simple <code>docker run -it tehnix&#47;ghcjs-docker:lts-9.21 bash</code> will get you a bash shell."}, {"owner": {"reputation": 833, "user_id": 1007926, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dc0133e5980f0289b82d223562ec0a49?s=128&d=identicon&r=PG", "display_name": "Peter Becich", "link": "https://stackoverflow.com/users/1007926/peter-becich"}, "reply_to_user": {"reputation": 1872, "user_id": 701940, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d6ea807bc634041db1c8ad327b770ee2?s=128&d=identicon&r=PG", "display_name": "Tehnix", "link": "https://stackoverflow.com/users/701940/tehnix"}, "edited": false, "score": 0, "creation_date": 1566189261, "post_id": 49990908, "comment_id": 101563470, "body": "@Tehnix This doesn&#39;t appear to fix the possible user issue:  <code># If true (the default when using the local Docker Engine), run processes in the Docker container as the same UID&#47;GID as the host.  The ensures that files written by the container are owned by you on the host.  When the Docker Engine is remote (accessed by tcp), defaults to false.</code> <code>set-user: false</code>  <a href=\"https://docs.haskellstack.org/en/stable/docker_integration/#configuration\" rel=\"nofollow noreferrer\">docs.haskellstack.org/en/stable/docker_integration/&hellip;</a>"}], "tags": [], "owner": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "is_accepted": false, "score": 2, "last_activity_date": 1524523252, "creation_date": 1524523252, "answer_id": 49990908, "question_id": 49979697, "link": "https://stackoverflow.com/questions/49979697/getting-stack-to-pick-up-ghcjs-built-in-docker-image-when-using-docker-true/49990908#49990908", "title": "Getting stack to pick up GHCJS built in docker image when using docker: true", "body": "<p>Not sure how much this usecase has been tested so it's quite possible that it doesn't directly work.  One thing I noticed is that you have <code>compiler-check: match-exact</code>.  While in a way it's good to have this, it also means that when you ask the ghcjs binary to report its version it will need to yield the exact version number you have specified.  A lot of the time these binaries unfortunately are not built with the <code>9009021</code> portion of the version number.</p>\n\n<p>Also, you have <code>system-ghc: false</code> which means that stack will not use compilers it finds in the environment, and will only use compilers it has installed.  The opposite of what you want!  How about trying something like this (I haven't tested this):</p>\n\n<p><code>\nresolver: lts-9.21\ncompiler: ghcjs-0.2.1.9009021_ghc-8.0.2\ncompiler-check: newer-minor\ndocker:\n    enable: true\n    repo: \"tehnix/ghcjs-docker\" # It will automatically add :lts-x.xx\n    auto-pull: true\nsystem-ghc: true\n</code></p>\n\n<blockquote>\n  <p>Unfortunately, stack will start looking for GHCJS on the host system, and therefore will not catch that GHCJS has already been built in the container image it's using.</p>\n</blockquote>\n\n<p>I don't think this should happen.  If it looks for a system ghcjs, it should be done from within the container.</p>\n"}], "owner": {"reputation": 1872, "user_id": 701940, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/d6ea807bc634041db1c8ad327b770ee2?s=128&d=identicon&r=PG", "display_name": "Tehnix", "link": "https://stackoverflow.com/users/701940/tehnix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1524595027, "creation_date": 1524481903, "last_edit_date": 1524595027, "question_id": 49979697, "link": "https://stackoverflow.com/questions/49979697/getting-stack-to-pick-up-ghcjs-built-in-docker-image-when-using-docker-true", "title": "Getting stack to pick up GHCJS built in docker image when using docker: true", "body": "<p>As part of my attempt to make <a href=\"https://github.com/Tehnix/miso-isomorphic-stack\" rel=\"nofollow noreferrer\">miso-isomorphic-stack</a> as smooth an experience as possible, I've made a couple of docker images with GHCJS and some newer stack versions (<a href=\"https://github.com/Tehnix/ghcjs-docker\" rel=\"nofollow noreferrer\">repo here</a> and <a href=\"https://hub.docker.com/r/tehnix/ghcjs-docker/\" rel=\"nofollow noreferrer\">hub here</a>), based on <a href=\"https://github.com/matchwood/ghcjs-stack-dist\" rel=\"nofollow noreferrer\">these distributions</a>. You can see in the repo how you can use them, and maybe <a href=\"https://github.com/Tehnix/miso-isomorphic-stack/blob/master/stack-build-docker.sh\" rel=\"nofollow noreferrer\">this script</a> for how to integrate that more nicely in your process.</p>\n\n<p>So, ideally, you would make stack manage the docker image, by having something like,</p>\n\n<pre><code>resolver: lts-9.21\ncompiler: ghcjs-0.2.1.9009021_ghc-8.0.2\ncompiler-check: match-exact\nsetup-info:\nghcjs:\n    source:\n    ghcjs-0.2.1.9009021_ghc-8.0.2:\n        url: https://github.com/matchwood/ghcjs-stack-dist/raw/master/ghcjs-0.2.1.9009021.tar.gz\n        sha1: b1740c3c99e5039ac306702894cd6e58283f4d31\n\ndocker:\n    enable: true\n    repo: \"tehnix/ghcjs-docker\" # It will automatically add :lts-x.xx\n    auto-pull: true\nsystem-ghc: false\n</code></pre>\n\n<p>Unfortunately, stack will start looking for GHCJS on the host system, and therefore will not catch that GHCJS has already been built in the container image it's using. I suspect this has something to do with setup-info, but it's not entirely clear to me how to resolve this issue.</p>\n\n<p>I'm hoping someone here might know a bit more what goes on with stack, and how the compiler is handled.</p>\n\n<p>The images themselves are fairly simple, they just install GHCJS in them, meaning you don't have to spend hours building GHCJS yourself, with whatever issues that bring up, and can get started quickly trying out GHCJS.</p>\n\n<h1>Update</h1>\n\n<p>Trying with the suggestion from @mgsloan fails with the following,</p>\n\n<pre><code>No information found for ghcjs-0.2.1.9009021_ghc-8.0.2.\nSupported versions for OS key 'source': GhcjsVersion 0.1.0.20150924 7.10.2\n</code></pre>\n\n<p>With the full build log of <code>stack -v build</code>:</p>\n\n<pre><code>Version 1.6.3, Git revision b27e629b8c4ce369e3b8273f04db193b060000db (5454 commits) x86_64 hpack-0.20.0\n2018-04-24 12:56:42.195877: [debug] Loading project config file frontend/stack.yaml\n@(Stack/Config.hs:868:13)\n2018-04-24 12:56:42.205781: [debug] Run process: /usr/local/bin/docker --version\n@(System/Process/Log.hs:37:3)\n2018-04-24 12:56:42.559527: [debug] Process finished in 353ms: /usr/local/bin/docker --version\n@(System/Process/Log.hs:44:3)\n2018-04-24 12:56:42.559917: [debug] Run process: /usr/local/bin/docker inspect tehnix/ghcjs-docker:lts-9.21\n@(System/Process/Log.hs:37:3)\n2018-04-24 12:56:42.643497: [debug] Process finished in 83ms: /usr/local/bin/docker inspect tehnix/ghcjs-docker:lts-9.21\n@(System/Process/Log.hs:44:3)\n2018-04-24 12:56:42.657949: [debug] Run process: /usr/local/bin/docker create --net=host -e STACK_IN_CONTAINER=1 -e STACK_ROOT=/Users/christiankjaerlaustsen/.stack -e STACK_PLATFORM_VARIANT=dkb61b2dc4e76119fbba7cceb60d5ffa49 -e HOME=/Users/christiankjaerlaustsen/GitHub/Tehnix/miso-isomorphic-stack/frontend/.stack-work/docker/_home -e PATH=/opt/host/bin:/Users/christiankjaerlaustsen/GitHub/Tehnix/miso-isomorphic-stack/frontend/.stack-work/docker/_home/.local/bin:/root/.cabal/bin:/root/.local/bin:/opt/ghc/8.2.2/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin -e PWD=/Users/christiankjaerlaustsen/GitHub/Tehnix/miso-isomorphic-stack -v /Users/christiankjaerlaustsen:/Users/christiankjaerlaustsen -v /Users/christiankjaerlaustsen/.stack:/Users/christiankjaerlaustsen/.stack -v /Users/christiankjaerlaustsen/GitHub/Tehnix/miso-isomorphic-stack/frontend:/Users/christiankjaerlaustsen/GitHub/Tehnix/miso-isomorphic-stack/frontend -v /Users/christiankjaerlaustsen/GitHub/Tehnix/miso-isomorphic-stack/frontend/.stack-work/docker/_home:/Users/christiankjaerlaustsen/GitHub/Tehnix/miso-isomorphic-stack/frontend/.stack-work/docker/_home -w /Users/christiankjaerlaustsen/GitHub/Tehnix/miso-isomorphic-stack -e USER=christiankjaerlaustsen -e SSH_AUTH_SOCK=/private/tmp/com.apple.launchd.D8v3WjTyAg/Listeners -v /private/tmp/com.apple.launchd.D8v3WjTyAg/Listeners:/private/tmp/com.apple.launchd.D8v3WjTyAg/Listeners -v /Users/christiankjaerlaustsen/.stack/programs/x86_64-linux/stack-1.6.3/stack:/opt/host/bin/stack -t -i tehnix/ghcjs-docker:lts-9.21 /opt/host/bin/stack --internal-re-exec-version=1.6.3 --internal-docker-entrypoint \"DockerEntrypoint {deUser = Just (DockerUser {duUid = 501, duGid = 20, duGroups = [20,12,61,79,80,81,98,702,33,100,204,250,395,398,399,701], duUmask = 18})}\" --stack-yaml=frontend/stack.yaml -v build\n@(System/Process/Log.hs:37:3)\n2018-04-24 12:56:42.909494: [debug] Process finished in 248ms: /usr/local/bin/docker create --net=host -e STACK_IN_CONTAINER=1 -e STACK_ROOT=/Users/christiankjaerlaustsen/.stack -e STACK_PLATFORM_VARIANT=dkb61b2dc4e76119fbba7cceb60d5ffa49 -e HOME=/Users/christiankjaerlaustsen/GitHub/Tehnix/miso-isomorphic-stack/frontend/.stack-work/docker/_home -e PATH=/opt/host/bin:/Users/christiankjaerlaustsen/GitHub/Tehnix/miso-isomorphic-stack/frontend/.stack-work/docker/_home/.local/bin:/root/.cabal/bin:/root/.local/bin:/opt/ghc/8.2.2/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin -e PWD=/Users/christiankjaerlaustsen/GitHub/Tehnix/miso-isomorphic-stack -v /Users/christiankjaerlaustsen:/Users/christiankjaerlaustsen -v /Users/christiankjaerlaustsen/.stack:/Users/christiankjaerlaustsen/.stack -v /Users/christiankjaerlaustsen/GitHub/Tehnix/miso-isomorphic-stack/frontend:/Users/christiankjaerlaustsen/GitHub/Tehnix/miso-isomorphic-stack/frontend -v /Users/christiankjaerlaustsen/GitHub/Tehnix/miso-isomorphic-stack/frontend/.stack-work/docker/_home:/Users/christiankjaerlaustsen/GitHub/Tehnix/miso-isomorphic-stack/frontend/.stack-work/docker/_home -w /Users/christiankjaerlaustsen/GitHub/Tehnix/miso-isomorphic-stack -e USER=christiankjaerlaustsen -e SSH_AUTH_SOCK=/private/tmp/com.apple.launchd.D8v3WjTyAg/Listeners -v /private/tmp/com.apple.launchd.D8v3WjTyAg/Listeners:/private/tmp/com.apple.launchd.D8v3WjTyAg/Listeners -v /Users/christiankjaerlaustsen/.stack/programs/x86_64-linux/stack-1.6.3/stack:/opt/host/bin/stack -t -i tehnix/ghcjs-docker:lts-9.21 /opt/host/bin/stack --internal-re-exec-version=1.6.3 --internal-docker-entrypoint \"DockerEntrypoint {deUser = Just (DockerUser {duUid = 501, duGid = 20, duGroups = [20,12,61,79,80,81,98,702,33,100,204,250,395,398,399,701], duUmask = 18})}\" --stack-yaml=frontend/stack.yaml -v build\n@(System/Process/Log.hs:44:3)\n2018-04-24 12:56:42.910090: [debug] Creating process: /usr/local/bin/docker start -a -i 791fe386a759de5b23f7bf62a2cca15bdfa540287528024ec9931c4c69b4d913\n@(System/Process/Log.hs:22:3)\nVersion 1.6.3, Git revision b27e629b8c4ce369e3b8273f04db193b060000db (5454 commits) x86_64 hpack-0.20.0\n2018-04-24 10:56:48.844354: [debug] Loading project config file frontend/stack.yaml\n@(Stack/Config.hs:868:13)\n2018-04-24 10:56:48.856002: [debug] Run process: /usr/sbin/groupadd -o --gid 20 stack\n@(System/Process/Log.hs:37:3)\n2018-04-24 10:56:48.887487: [debug] Process finished in 31ms: /usr/sbin/groupadd -o --gid 20 stack\n@(System/Process/Log.hs:44:3)\n2018-04-24 10:56:48.890291: [debug] Run process: /usr/sbin/useradd -oN --uid 501 --gid 20 --home /Users/christiankjaerlaustsen/GitHub/Tehnix/miso-isomorphic-stack/frontend/.stack-work/docker/_home stack\n@(System/Process/Log.hs:37:3)\n2018-04-24 10:56:48.929204: [debug] Process finished in 38ms: /usr/sbin/useradd -oN --uid 501 --gid 20 --home /Users/christiankjaerlaustsen/GitHub/Tehnix/miso-isomorphic-stack/frontend/.stack-work/docker/_home stack\n@(System/Process/Log.hs:44:3)\n2018-04-24 10:56:48.929360: [debug] Run process: /usr/sbin/groupadd -o --gid 20 group20\n@(System/Process/Log.hs:37:3)\n2018-04-24 10:56:48.938691: [debug] Process finished in 9ms: /usr/sbin/groupadd -o --gid 20 group20\n@(System/Process/Log.hs:44:3)\n2018-04-24 10:56:48.938807: [debug] Run process: /usr/sbin/groupadd -o --gid 12 group12\n@(System/Process/Log.hs:37:3)\n2018-04-24 10:56:48.952149: [debug] Process finished in 13ms: /usr/sbin/groupadd -o --gid 12 group12\n@(System/Process/Log.hs:44:3)\n2018-04-24 10:56:48.952316: [debug] Run process: /usr/sbin/groupadd -o --gid 61 group61\n@(System/Process/Log.hs:37:3)\n2018-04-24 10:56:48.977534: [debug] Process finished in 25ms: /usr/sbin/groupadd -o --gid 61 group61\n@(System/Process/Log.hs:44:3)\n2018-04-24 10:56:48.977670: [debug] Run process: /usr/sbin/groupadd -o --gid 79 group79\n@(System/Process/Log.hs:37:3)\n2018-04-24 10:56:48.991099: [debug] Process finished in 13ms: /usr/sbin/groupadd -o --gid 79 group79\n@(System/Process/Log.hs:44:3)\n2018-04-24 10:56:48.991271: [debug] Run process: /usr/sbin/groupadd -o --gid 80 group80\n@(System/Process/Log.hs:37:3)\n2018-04-24 10:56:49.006803: [debug] Process finished in 14ms: /usr/sbin/groupadd -o --gid 80 group80\n@(System/Process/Log.hs:44:3)\n2018-04-24 10:56:49.006984: [debug] Run process: /usr/sbin/groupadd -o --gid 81 group81\n@(System/Process/Log.hs:37:3)\n2018-04-24 10:56:49.020884: [debug] Process finished in 13ms: /usr/sbin/groupadd -o --gid 81 group81\n@(System/Process/Log.hs:44:3)\n2018-04-24 10:56:49.021037: [debug] Run process: /usr/sbin/groupadd -o --gid 98 group98\n@(System/Process/Log.hs:37:3)\n2018-04-24 10:56:49.030441: [debug] Process finished in 9ms: /usr/sbin/groupadd -o --gid 98 group98\n@(System/Process/Log.hs:44:3)\n2018-04-24 10:56:49.030551: [debug] Run process: /usr/sbin/groupadd -o --gid 702 group702\n@(System/Process/Log.hs:37:3)\n2018-04-24 10:56:49.040424: [debug] Process finished in 9ms: /usr/sbin/groupadd -o --gid 702 group702\n@(System/Process/Log.hs:44:3)\n2018-04-24 10:56:49.040532: [debug] Run process: /usr/sbin/groupadd -o --gid 33 group33\n@(System/Process/Log.hs:37:3)\n2018-04-24 10:56:49.051412: [debug] Process finished in 10ms: /usr/sbin/groupadd -o --gid 33 group33\n@(System/Process/Log.hs:44:3)\n2018-04-24 10:56:49.051632: [debug] Run process: /usr/sbin/groupadd -o --gid 100 group100\n@(System/Process/Log.hs:37:3)\n2018-04-24 10:56:49.061282: [debug] Process finished in 8ms: /usr/sbin/groupadd -o --gid 100 group100\n@(System/Process/Log.hs:44:3)\n2018-04-24 10:56:49.061803: [debug] Run process: /usr/sbin/groupadd -o --gid 204 group204\n@(System/Process/Log.hs:37:3)\n2018-04-24 10:56:49.074834: [debug] Process finished in 12ms: /usr/sbin/groupadd -o --gid 204 group204\n@(System/Process/Log.hs:44:3)\n2018-04-24 10:56:49.075014: [debug] Run process: /usr/sbin/groupadd -o --gid 250 group250\n@(System/Process/Log.hs:37:3)\n2018-04-24 10:56:49.085177: [debug] Process finished in 9ms: /usr/sbin/groupadd -o --gid 250 group250\n@(System/Process/Log.hs:44:3)\n2018-04-24 10:56:49.085324: [debug] Run process: /usr/sbin/groupadd -o --gid 395 group395\n@(System/Process/Log.hs:37:3)\n2018-04-24 10:56:49.093166: [debug] Process finished in 7ms: /usr/sbin/groupadd -o --gid 395 group395\n@(System/Process/Log.hs:44:3)\n2018-04-24 10:56:49.093303: [debug] Run process: /usr/sbin/groupadd -o --gid 398 group398\n@(System/Process/Log.hs:37:3)\n2018-04-24 10:56:49.101006: [debug] Process finished in 7ms: /usr/sbin/groupadd -o --gid 398 group398\n@(System/Process/Log.hs:44:3)\n2018-04-24 10:56:49.101161: [debug] Run process: /usr/sbin/groupadd -o --gid 399 group399\n@(System/Process/Log.hs:37:3)\n2018-04-24 10:56:49.109153: [debug] Process finished in 7ms: /usr/sbin/groupadd -o --gid 399 group399\n@(System/Process/Log.hs:44:3)\n2018-04-24 10:56:49.109306: [debug] Run process: /usr/sbin/groupadd -o --gid 701 group701\n@(System/Process/Log.hs:37:3)\n2018-04-24 10:56:49.117319: [debug] Process finished in 7ms: /usr/sbin/groupadd -o --gid 701 group701\n@(System/Process/Log.hs:44:3)\n2018-04-24 10:56:49.119055: [debug] Decoding build plan from: /Users/christiankjaerlaustsen/.stack/build-plan/lts-9.21.yaml\n@(Stack/Snapshot.hs:150:5)\n2018-04-24 10:56:49.119212: [debug] Trying to decode /Users/christiankjaerlaustsen/.stack/build-plan-cache/lts-9.21.cache\n@(Data/Store/VersionTagged.hs:66:5)\n2018-04-24 10:56:49.132586: [debug] Success decoding /Users/christiankjaerlaustsen/.stack/build-plan-cache/lts-9.21.cache\n@(Data/Store/VersionTagged.hs:70:13)\n2018-04-24 10:56:49.133008: [debug] Getting system compiler version\n@(Stack/Setup.hs:387:17)\nNo information found for ghcjs-0.2.1.9009021_ghc-8.0.2.\nSupported versions for OS key 'source': GhcjsVersion 0.1.0.20150924 7.10.2\n2018-04-24 12:56:46.033052: [debug] Run process: /usr/local/bin/docker rm -f 791fe386a759de5b23f7bf62a2cca15bdfa540287528024ec9931c4c69b4d913\n@(System/Process/Log.hs:37:3)\n2018-04-24 12:56:46.109114: [debug] Process finished in 75ms: /usr/local/bin/docker rm -f 791fe386a759de5b23f7bf62a2cca15bdfa540287528024ec9931c4c69b4d913\n@(System/Process/Log.hs:44:3)\n</code></pre>\n\n<h1>Taking a step back</h1>\n\n<p>I guess, if we go back to the basics, what I'm really asking about is, where/how does stack find GHC inside the docker image, and how can I specify the path to GHCJS?</p>\n\n<p>So, currently, the Dockerfiles that make this image are fairly simple. Take e.g. the one to build GHCJS for lts-9.21,</p>\n\n<pre><code>FROM fpco/stack-build:lts-11.5\n\n# Install node.js for GHCJS.\nRUN curl -sL https://deb.nodesource.com/setup_9.x | sudo -E bash - \\\n &amp;&amp; apt-get update \\\n &amp;&amp; apt-get install -y nodejs \\\n &amp;&amp; rm -rf /var/lib/apt/lists/*\n\n# Set up GHCJS.\nCOPY src /tmp/setup-ghcjs\nRUN cd /tmp/setup-ghcjs \\\n &amp;&amp; stack setup --system-ghc \\\n &amp;&amp; rm -rf /tmp/setup-ghcjs\n\nRUN mkdir -p /src\nVOLUME /src\nWORKDIR /src\n</code></pre>\n\n<p>What this does is </p>\n\n<ul>\n<li>use the <code>fpco/stack-build:lts-11.5</code> stack as a base layer, because it contains cabal, stack, etc. </li>\n<li>Then it installs node.js, because this is needed for GHCJS</li>\n<li>Finally, it builds GHCJS using a project that contains a <a href=\"https://github.com/Tehnix/ghcjs-docker/blob/master/src/stack.yaml\" rel=\"nofollow noreferrer\">stack.yaml</a> that looks exactly like the one in the top of my question, taking out of course the docker/system-ghc parts.</li>\n</ul>\n\n<p>Now, what I imagined would happen was that stack's docker support would pick up this <code>ghcjs-0.2.1.9009021_ghc-8.0.2</code> compiler when using the image, but that doesn't seem to happen. The image itself works with e.g. <code>docker run -v $(pwd):/src -it tehnix/ghcjs-docker:lts-9.21 stack build</code>.</p>\n\n<p>In other words: <strong>How do I make the GHCJS installed compiler discoverable for stack's docker support?</strong></p>\n"}, {"tags": ["haskell", "monad-transformers"], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 8, "last_activity_date": 1524473554, "creation_date": 1524473554, "answer_id": 49976947, "question_id": 49976795, "link": "https://stackoverflow.com/questions/49976795/why-is-rwst-m-a-not-an-instance-of-monadreader-monadstate-monadwriter/49976947#49976947", "title": "Why is RWST ... m a not an instance of MonadReader, MonadState, MonadWriter", "body": "<p><code>RWST</code> is an instance of all those classes. You won't see that in the Haddock documentation for <code>transformers</code> because the classes and the instances you seek are in <code>mtl</code>.</p>\n"}], "owner": {"reputation": 507, "user_id": 4966887, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2b2d9b78341809c8b9b01ac9ae3f3c72?s=128&d=identicon&r=PG&f=1", "display_name": "Chirs", "link": "https://stackoverflow.com/users/4966887/chirs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 82, "favorite_count": 0, "accepted_answer_id": 49976947, "answer_count": 1, "score": 2, "last_activity_date": 1524475078, "creation_date": 1524473047, "last_edit_date": 1524475078, "question_id": 49976795, "link": "https://stackoverflow.com/questions/49976795/why-is-rwst-m-a-not-an-instance-of-monadreader-monadstate-monadwriter", "title": "Why is RWST ... m a not an instance of MonadReader, MonadState, MonadWriter", "body": "<p>I just discovered that <code>RWST</code> (from <code>transformers</code>)  does not carry an instance for <code>MonadReader</code>, <code>MonadState</code>, or <code>MonadWriter</code>. This seems a little odd to me as those instances would immediately improve usability, e.g. being able to use <code>.=</code>, or just generally improve reusability.</p>\n\n<p>Surely there is a reason for this decision?</p>\n"}, {"tags": ["haskell", "abstract-syntax-tree", "recursive-datastructures", "fixpoint-combinators"], "comments": [{"owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "edited": false, "score": 1, "creation_date": 1524467140, "post_id": 49973915, "comment_id": 86966270, "body": "<code>Attr f a</code> is just a synonym for <code>Mu (Ann f a)</code>, so you can use the cornucopia of traversals available in fixplate. <code>toANF</code> is essentially <code>forget</code>, but reading your intents, you don&#39;t want to remove the labels from your AST, do you? <a href=\"https://hackage.haskell.org/package/fixplate-0.1.7/docs/Data-Generics-Fixplate-Traversals.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/fixplate-0.1.7/docs/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "is_accepted": true, "score": 3, "last_activity_date": 1524516185, "last_edit_date": 1524516185, "creation_date": 1524492572, "answer_id": 49983263, "question_id": 49973915, "link": "https://stackoverflow.com/questions/49973915/haskell-ast-annotation-with-fix/49983263#49983263", "title": "Haskell AST Annotation with Fix", "body": "<p><em>Edit:</em> Add an example of a function for <code>ProgramF</code>s with generic annotations.</p>\n\n<p>Yes, at least in the case of <code>toANF</code>, you're using it wrong.</p>\n\n<p>In <code>toANF</code>, note that your <code>Let bindingANF nbody</code> and the companion definitions of <code>bindingANF</code> and <code>nbody</code> are just a reimplementation of <code>fmap toANF</code> for the specific constructor <code>Let</code>.</p>\n\n<p>That is, if you derive a <code>Functor</code> instance for your <code>ProgramF</code>, then you can re-write your <code>toANF</code> snippet as:</p>\n\n<pre><code>toANF :: LabelProgram -&gt; Program\ntoANF (Fix (Ann label l@(Let _ _))) = Fix (fmap toANF l)\n</code></pre>\n\n<p>If <code>toANF</code> is <em>just</em> stripping labels, then this definition works for all constructors and not just <code>Let</code>, so you can drop the pattern:</p>\n\n<pre><code>toANF :: LabelProgram -&gt; Program\ntoANF (Fix (Ann label l)) = Fix (fmap toANF l)\n</code></pre>\n\n<p>and now, as per @Regis_Kuckaertz's comment, you've just re-implemented <code>forget</code> which is defined as:</p>\n\n<pre><code>forget = Fix . fmap forget . unAnn . unFix\n</code></pre>\n\n<p>With respect to writing functions that work generically on <code>Program</code>, <code>LabelProgram</code>, etc., I think it makes more sense to write functions generic in a (single) annotation:</p>\n\n<pre><code>foo :: Attr ProgramF a -&gt; Attr ProgramF a\n</code></pre>\n\n<p>and, if you <em>really</em> need to apply them to the unannotated program, define:</p>\n\n<pre><code>type ProgramU = Attr ProgramF ()\n</code></pre>\n\n<p>where the \"U\" in <code>ProgramU</code> stands for \"unit\".  Obviously, you can easily write translators to work with <code>Program</code>s as <code>ProgramU</code>s if really needed:</p>\n\n<pre><code>toU :: Functor f =&gt; Mu f -&gt; Attr f ()\ntoU = synthetise (const ())\n\nfromU :: Functor f =&gt; Attr f () -&gt; Mu f\nfromU = forget\n\nmapU :: (Functor f) =&gt; (Attr f () -&gt; Attr f ()) -&gt; Mu f -&gt; Mu f\nmapU f = fromU . f . toU\n\nfoo' :: Mu ProgramF -&gt; Mu ProgramF\nfoo' = mapU foo\n</code></pre>\n\n<p>As a concrete -- if stupid -- example, here's a function that separates <code>Let</code>s with multiple bindings into nested <code>Let</code>s with singleton bindings (and so breaks mutually recursive bindings in the <code>Program</code> language).  It assumes that the annotation on a multi-binding <code>Let</code> will be copied to each of the resulting singleton <code>Let</code>s:</p>\n\n<pre><code>splitBindings :: Attr ProgramF a -&gt; Attr ProgramF a\nsplitBindings (Fix (Ann a (Let (x:y:xs) e)))\n  = Fix (Ann a (Let [x] (splitBindings (Fix (Ann a (Let (y:xs) e))))))\nsplitBindings (Fix e) = Fix (fmap splitBindings e)\n</code></pre>\n\n<p>It can be applied to an example <code>Program</code>:</p>\n\n<pre><code>testprog :: Program\ntestprog = Fix $ Unary (Fix $ Let [(Identifier \"x\", Fix $ Number 1), \n                                   (Identifier \"y\", Fix $ Number 2)] \n                                  (Fix $ Unary (Fix $ Number 3) NegOp))\n                       NegOp\n</code></pre>\n\n<p>like so:</p>\n\n<pre><code>&gt; mapU splitBindings testprog\nFix (Unary (Fix (Let {bindings = [(Identifier \"x\",Fix (Number 1))],\nbody = Fix (Let {bindings = [(Identifier \"y\",Fix (Number 2))], \nbody = Fix (Unary (Fix (Number 3)) NegOp)})})) NegOp)\n&gt;\n</code></pre>\n\n<p>Here's my full working example:</p>\n\n<pre><code>{-# LANGUAGE DeriveFunctor #-}\n{-# OPTIONS_GHC -Wall #-}\n\nimport Data.Generics.Fixplate\n\ndata Identifier = Identifier String deriving (Show)\ndata PLabel = PLabel deriving (Show)\ndata Operator = NegOp deriving (Show)\n\ndata ProgramF a\n  = Unary a\n          Operator\n  | Number Int\n  | Let { bindings :: [(Identifier, a)]\n        , body :: a }\n  deriving (Show, Functor)\ninstance ShowF ProgramF where showsPrecF = showsPrec\n\ntype Program = Mu ProgramF\ntype LabelProgram = Attr ProgramF PLabel\n\nsplitBindings :: Attr ProgramF a -&gt; Attr ProgramF a\nsplitBindings (Fix (Ann a (Let (x:y:xs) e)))\n  = Fix (Ann a (Let [x] (splitBindings (Fix (Ann a (Let (y:xs) e))))))\nsplitBindings (Fix e) = Fix (fmap splitBindings e)\n\ntoU :: Functor f =&gt; Mu f -&gt; Attr f ()\ntoU = synthetise (const ())\n\nfromU :: Functor f =&gt; Attr f () -&gt; Mu f\nfromU = forget\n\nmapU :: (Functor f) =&gt; (Attr f () -&gt; Attr f ()) -&gt; Mu f -&gt; Mu f\nmapU f = fromU . f . toU\n\ntestprog :: Program\ntestprog = Fix $ Unary (Fix $ Let [(Identifier \"x\", Fix $ Number 1), \n                                   (Identifier \"y\", Fix $ Number 2)] \n                                  (Fix $ Unary (Fix $ Number 3) NegOp))\n                       NegOp\n\nmain :: IO ()\nmain = print $ mapU splitBindings testprog\n</code></pre>\n"}], "owner": {"reputation": 49728, "user_id": 374797, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/7a7c59685abf968ca5ef37f79668ec93?s=128&d=identicon&r=PG&f=1", "display_name": "John Howard", "link": "https://stackoverflow.com/users/374797/john-howard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 304, "favorite_count": 3, "accepted_answer_id": 49983263, "answer_count": 1, "score": 5, "last_activity_date": 1563168411, "creation_date": 1524461149, "last_edit_date": 1563168411, "question_id": 49973915, "link": "https://stackoverflow.com/questions/49973915/haskell-ast-annotation-with-fix", "title": "Haskell AST Annotation with Fix", "body": "<p>I am working on creating an AST in Haskell. I want to add different annotations, such as types and location information, so I ended up using <a href=\"https://hackage.haskell.org/package/fixplate-0.1.7\" rel=\"noreferrer\">fixplate</a>. However, I can't find any examples online and am having some difficulty.</p>\n\n<p>I've set up my AST as recommended by fixplate (some striped out):</p>\n\n<pre><code>data ProgramF a\n  = Unary a\n          Operator\n  | Number Int\n  | Let { bindings :: [(Identifier, a)]\n        , body :: a }\n\ntype Program = Mu ProgramF\n</code></pre>\n\n<p>Next to add a label I created another type, and a function to add labels based on a tree traversal.</p>\n\n<pre><code>type LabelProgram = Attr ProgramF PLabel\n\nlabelProgram :: Program -&gt; LabelProgram\nlabelProgram =\n  annMap (PLabel . show . fst) . (snd . synthAccumL (\\i x -&gt; (i + 1, (i, x))) 0)\n</code></pre>\n\n<p>However, beyond this I am running into some issues. For example, I am trying to write a function that does some transformation on the AST. Because it requires a label to function, I've made the type <code>LabelProgram -&gt; Program</code>, but I think I am doing something wrong here. Below is a snippet of part of the function (one of the simpler parts):</p>\n\n<pre><code>toANF :: LabelProgram -&gt; Program\ntoANF (Fix (Ann label (Let {bindings, body}))) = Fix $ Let bindingANF nbody\n  where\n    bindingANF = map (\\(i, e) -&gt; (i, toANF e)) bindings\n    nbody = toANF body\n</code></pre>\n\n<p>I feel like I am working at the wrong level of abstraction here. Should I be explicitly matching against <code>Fix Ann ...</code> and returning <code>Fix ...</code> like this, or am I utilizing fixplate wrong?</p>\n\n<p>Additionally, I am concerned about how to generalize functions. How can I make my functions work for <code>Program</code>s, <code>LabelProgram</code>s, and <code>TypeProgram</code>s generically?</p>\n"}, {"tags": ["haskell", "radio-group"], "answers": [{"tags": [], "owner": {"reputation": 56, "user_id": 9683386, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Jonathan Daugherty", "link": "https://stackoverflow.com/users/9683386/jonathan-daugherty"}, "is_accepted": true, "score": 4, "last_activity_date": 1524440957, "creation_date": 1524440957, "answer_id": 49971789, "question_id": 49971276, "link": "https://stackoverflow.com/questions/49971276/how-to-have-procedural-radiofield-options-in-haskells-brick-library/49971789#49971789", "title": "How to have procedural radioField options in haskells brick library", "body": "<p>I'm the author of Brick. For what it's worth, the Brick Users e-mail list is a good place to ask questions like this.</p>\n\n<p>To your question, though: since the name type is under your control, you can give your name type a constructor that takes parameters to construct sufficiently unique name values that are relevant to the data for each radio button value. For example, if you load database data and each value of your radio button is associated with some numeric ID, you might just have a name type like:</p>\n\n<pre><code>-- The type of database record IDs\ntype ID = Int\n\ndata Name = ...\n          | RadioOption ID\n</code></pre>\n"}], "owner": {"reputation": 1660, "user_id": 1186907, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/02b03f1d05b71cbcb8a81eb08c38b76a?s=128&d=identicon&r=PG", "display_name": "sclausen", "link": "https://stackoverflow.com/users/1186907/sclausen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 49971789, "answer_count": 1, "score": 0, "last_activity_date": 1524440957, "creation_date": 1524435459, "question_id": 49971276, "link": "https://stackoverflow.com/questions/49971276/how-to-have-procedural-radiofield-options-in-haskells-brick-library", "title": "How to have procedural radioField options in haskells brick library", "body": "<p>I can't wrap my head around how to have procedural a <code>radioField</code>, since I have to give each option a name.\nIn my case, I want to load the available options from a database and therefore I can't have them statically named. Has anybody an idea?</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>radioField handed [ (LeftHanded, LeftHandField, \"Left\")\n                  , (RightHanded, RightHandField, \"Right\")\n                  , (Ambidextrous, AmbiField, \"Both\")\n                  ]\n</code></pre>\n"}, {"tags": ["haskell", "compare", "tuples"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1524428897, "post_id": 49970416, "comment_id": 86956707, "body": "Being new to something is not really an excuse for lak of effort. Pleace show what you tried, what did not work, what ideas did you had, why these were unsuccesful."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524428952, "post_id": 49970416, "comment_id": 86956728, "body": "Furthermore <code>[(1,3),(2,1),(4,4)]</code> is <i>not</i> a tuple, it is a <i>list</i> of 2-tuples."}, {"owner": {"reputation": 81, "user_id": 7992697, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o0wuEhAAl4s/AAAAAAAAAAI/AAAAAAAAAD0/g1Cix0JhRM4/photo.jpg?sz=128", "display_name": "hristoforidisc", "link": "https://stackoverflow.com/users/7992697/hristoforidisc"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1524429148, "post_id": 49970416, "comment_id": 86956776, "body": "@WillemVanOnsem Yes, you are right. Excuse me for that, indeed that&#39;s a list of tuples. I have edited the post adding some code that I wrote but I didn&#39;t do that in the first place since I think that it&#39;s not something that worths mentioning."}], "answers": [{"tags": [], "owner": {"reputation": 309, "user_id": 6222757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48fdecaf00efb53f6ed0ee200fa9ba2b?s=128&d=identicon&r=PG&f=1", "display_name": "evzh", "link": "https://stackoverflow.com/users/6222757/evzh"}, "is_accepted": false, "score": 2, "last_activity_date": 1524429178, "creation_date": 1524429178, "answer_id": 49970469, "question_id": 49970416, "link": "https://stackoverflow.com/questions/49970416/haskell-list-of-tuples-compare-pair/49970469#49970469", "title": "Haskell List of Tuples Compare Pair", "body": "<p>Hint: use a function of type <code>(a -&gt; b) -&gt; [a] -&gt; [b]</code> to transform the list of tuple into a list of your summands (3 or 1 or 0), and use another function of type <code>[a] -&gt; a</code> to get the sum.</p>\n\n<p>The <a href=\"https://www.haskell.org/hoogle/\" rel=\"nofollow noreferrer\">Hoogle</a> is a very nice site for looking up Haskell functions, both by name and by signature.</p>\n\n<p>Please do try these things out before simply asking for the complete code; that helps neither of us.</p>\n"}, {"comments": [{"owner": {"reputation": 81, "user_id": 7992697, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o0wuEhAAl4s/AAAAAAAAAAI/AAAAAAAAAD0/g1Cix0JhRM4/photo.jpg?sz=128", "display_name": "hristoforidisc", "link": "https://stackoverflow.com/users/7992697/hristoforidisc"}, "edited": false, "score": 0, "creation_date": 1524430643, "post_id": 49970472, "comment_id": 86957215, "body": "May I ask you something else too? In my example the list of tuples represents the results from some matches given by a team. In each tuple (a,b) a stands for goals scored by my team and b for goals scored by the opponent team. For example the list of tuples ` [(1,3),(2,1),(4,4)]` represents 3 matches that my team gave. How is it possible to get the biggest difference between goals scored in each match? For example this number should be &gt;0 if my team has at least one win, 0 if no wins and at least one even score and negative if my team has been defited at all matches. Example [(1,5)] I want -4"}, {"owner": {"reputation": 81, "user_id": 7992697, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o0wuEhAAl4s/AAAAAAAAAAI/AAAAAAAAAD0/g1Cix0JhRM4/photo.jpg?sz=128", "display_name": "hristoforidisc", "link": "https://stackoverflow.com/users/7992697/hristoforidisc"}, "edited": false, "score": 0, "creation_date": 1524430702, "post_id": 49970472, "comment_id": 86957233, "body": "For example: [(0,1),(1,3),(1,2)] I want -1. I guess the code is similar to the above one so I hope you are kind enough to help me out."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 81, "user_id": 7992697, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o0wuEhAAl4s/AAAAAAAAAAI/AAAAAAAAAD0/g1Cix0JhRM4/photo.jpg?sz=128", "display_name": "hristoforidisc", "link": "https://stackoverflow.com/users/7992697/hristoforidisc"}, "edited": false, "score": 1, "creation_date": 1524431509, "post_id": 49970472, "comment_id": 86957434, "body": "Well you can perform another mapping, and then use <code>maximum</code> instead of <code>sum</code>, a very short implementation is <code>maximum . map (uncurry (-))</code>."}, {"owner": {"reputation": 81, "user_id": 7992697, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o0wuEhAAl4s/AAAAAAAAAAI/AAAAAAAAAD0/g1Cix0JhRM4/photo.jpg?sz=128", "display_name": "hristoforidisc", "link": "https://stackoverflow.com/users/7992697/hristoforidisc"}, "edited": false, "score": 0, "creation_date": 1524432347, "post_id": 49970472, "comment_id": 86957641, "body": "I don&#39;t think I was clear about what I want. Let me explain. I have the list of tuples [(8,1),(2,3),(3,3),(2,0)]. My team has 2 wins and 1 even score. I want the difference between the goals of the best match. The best match is the one that the difference between the goals scored is the maximum. In this case 8-1 is the best match, so the return value is 8. However this value depends not only on the scores but at the general results. This value is &gt;0 if my team has at least one win, 0 if no wins and at least one even score (any case), and negative if my team has been defited at all matches."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 81, "user_id": 7992697, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o0wuEhAAl4s/AAAAAAAAAAI/AAAAAAAAAD0/g1Cix0JhRM4/photo.jpg?sz=128", "display_name": "hristoforidisc", "link": "https://stackoverflow.com/users/7992697/hristoforidisc"}, "edited": false, "score": 0, "creation_date": 1524433881, "post_id": 49970472, "comment_id": 86957989, "body": "@hristoforidisc: precisely, if you define <code>bestmatch = maximum . map (uncurry (-))</code>, then you can call it with <code>bestmatch [(8,1),(2,3),(3,3),(2,0)]</code>, and this will yield <code>7</code>."}, {"owner": {"reputation": 81, "user_id": 7992697, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o0wuEhAAl4s/AAAAAAAAAAI/AAAAAAAAAD0/g1Cix0JhRM4/photo.jpg?sz=128", "display_name": "hristoforidisc", "link": "https://stackoverflow.com/users/7992697/hristoforidisc"}, "edited": false, "score": 0, "creation_date": 1524434557, "post_id": 49970472, "comment_id": 86958124, "body": "bestmatch ::  Ord a =&gt; [(a, a)] -&gt; Int bestmatch = maximum . map (uncurry (-))    Something like that? I get an error Inferred type is not general enough *** Expression    : bestmatch *** Expected type : Ord a =&gt; [(a,a)] -&gt; Int *** Inferred type : Ord Int =&gt; [(Int,Int)] -&gt; Int"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 81, "user_id": 7992697, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o0wuEhAAl4s/AAAAAAAAAAI/AAAAAAAAAD0/g1Cix0JhRM4/photo.jpg?sz=128", "display_name": "hristoforidisc", "link": "https://stackoverflow.com/users/7992697/hristoforidisc"}, "edited": false, "score": 0, "creation_date": 1524434813, "post_id": 49970472, "comment_id": 86958182, "body": "@hristoforidisc: the signature is different. For <code>bestmatch</code> it is <code>bestmatch :: (Ord a, Num a) =&gt; [(a, a)] -&gt; a</code>."}, {"owner": {"reputation": 81, "user_id": 7992697, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o0wuEhAAl4s/AAAAAAAAAAI/AAAAAAAAAD0/g1Cix0JhRM4/photo.jpg?sz=128", "display_name": "hristoforidisc", "link": "https://stackoverflow.com/users/7992697/hristoforidisc"}, "edited": false, "score": 0, "creation_date": 1524435087, "post_id": 49970472, "comment_id": 86958250, "body": "Oh I see. Thank you so much mate. You are a lifesaver!"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1524429228, "creation_date": 1524429228, "answer_id": 49970472, "question_id": 49970416, "link": "https://stackoverflow.com/questions/49970416/haskell-list-of-tuples-compare-pair/49970472#49970472", "title": "Haskell List of Tuples Compare Pair", "body": "<p>This looks like the point system of a <em>soccer cup</em> (and some other sports). Instead of implementing a function that calculates the sum, we better first aim to calculate something that calculates the score for <em>one</em> such tuple, so something like:</p>\n\n<pre><code>score :: Ord a =&gt; (a, a) -&gt; Int\n</code></pre>\n\n<p>By using <code>a</code> as type, we can use any type of values, as long as we can compare them (the <code>Ord</code> type constraint). So we can write something like:</p>\n\n<pre><code>score (x, y) = -- ...\n</code></pre>\n\n<p>now in case <code>x &gt; y</code>, then the score is <code>3</code> points, in case <code>x == y</code>, then the score is <code>1</code> point, and finally in case <code>x &lt; y</code> (otherwise), then the score is <code>0</code> points, so we can write it as:</p>\n\n<pre><code>score :: Ord a =&gt; (a, a) -&gt; Int\nscore (x, y) | x &gt; y = 3\n             | x == y = 1\n             | otherwise = 0\n</code></pre>\n\n<p>So now we can perform a <code>map score</code> to calcuate a list of scores, and by using <code>sum</code>, we can calculate the sum of those points, like:</p>\n\n<pre><code>calculateWins :: Ord a =&gt; [(a, a)] -&gt; Int\ncalculateWins = sum . map score\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 7992697, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o0wuEhAAl4s/AAAAAAAAAAI/AAAAAAAAAD0/g1Cix0JhRM4/photo.jpg?sz=128", "display_name": "hristoforidisc", "link": "https://stackoverflow.com/users/7992697/hristoforidisc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 924, "favorite_count": 0, "accepted_answer_id": 49970472, "answer_count": 2, "score": 1, "last_activity_date": 1550843734, "creation_date": 1524428843, "last_edit_date": 1550843734, "question_id": 49970416, "link": "https://stackoverflow.com/questions/49970416/haskell-list-of-tuples-compare-pair", "title": "Haskell List of Tuples Compare Pair", "body": "<p>I am new to Haskell and I am trying some stuff out. I am having some trouble comparing tuples elements.</p>\n\n<p>Let's say I have a tuple <code>[(1,3),(2,1),(4,4)]</code>.\nI want to compare each pair index with each other and save some data into a counter value and return that value.</p>\n\n<p>For example what I want is this:\nTuple: <code>[(a,b),(c,d),(e,f)]</code><br>\nWhen   <code>a&gt;b</code> I want to <code>add 3</code> to the counter.<br>\nWhen <code>a==b</code> I want to <code>add 1</code> to the counter.<br>\nOtherwise <code>add 0</code> to the counter. Same for <code>(c,d)</code> and <code>(e,f)</code>.<br>\nAfter iterating through my tuples I want to return the counter.  </p>\n\n<blockquote>\n  <p>So in my example I have tuple <code>[(1,3),(2,1),(4,4)]</code>.<br>\n  The function should do<br>\n  Since <code>1&lt;3</code> add 0 to counter.<br>\n  Since <code>2&gt;1</code> add 3 to counter.<br>\n  Since <code>4=4</code> add 1 to counter.<br>\n  And after all return <code>0+3+1 = 4</code>.</p>\n</blockquote>\n\n<p>Any ideas? Thank you in advance!</p>\n\n<p>(Edit) </p>\n\n<pre><code>calculateWins :: [(Int,Int)]-&gt;Int           \ncalculateWins d ((a,b) :xs) = x\n    where x \n     |a&gt;b   =   3\n     |a==b  =   1\n     |otherwise =   0\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 2, "creation_date": 1524424439, "post_id": 49969748, "comment_id": 86955453, "body": "The <a href=\"https://hoogle.haskell.org/?hoogle=repeat&amp;scope=set%3Astackage\" rel=\"nofollow noreferrer\"><code>repeat</code></a> function already exists."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1524424440, "post_id": 49969748, "comment_id": 86955454, "body": "Lists are constructed with <code>:</code>, not <code>*</code>."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 2, "creation_date": 1524424483, "post_id": 49969748, "comment_id": 86955464, "body": "This is basically correct, except that &#39;*&#39; isn&#39;t right operator."}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 4, "creation_date": 1524424612, "post_id": 49969748, "comment_id": 86955508, "body": "@hnefatl btw OP&#39;s implementation (if they had used the right operator) is more efficient than yours -- it will create a small referential cycle rather than producing a whole bunch of cons cells.  You can see this by checking memory usage of <code>let xs = repeat 1 in (xs!!(10^6)) + (xs!!(10^6))</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 0, "creation_date": 1524424668, "post_id": 49969748, "comment_id": 86955532, "body": "@hnefatl: by using a variable, you basically produce a linked list with a loop. As a result, you can fold sometimes iterate over the list in constant memory."}, {"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1524424687, "post_id": 49969748, "comment_id": 86955538, "body": "@luqui (and @WillemVanOnsem) Huh, that&#39;s cool - thanks for telling me!"}, {"owner": {"reputation": 1994, "user_id": 1234621, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/QO6nO.png?s=128&g=1", "display_name": "ian5v", "link": "https://stackoverflow.com/users/1234621/ian5v"}, "edited": false, "score": 0, "creation_date": 1524474140, "post_id": 49969748, "comment_id": 86970278, "body": "@amina one of the really nice things about haskell is that you can go straight to the source to find the definitions of functions like these: eg <a href=\"https://hackage.haskell.org/package/base-4.11.1.0/docs/src/GHC.List.html#repeat\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.11.1.0/docs/src/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1524497512, "post_id": 49969797, "comment_id": 86985933, "body": "Alternatively, <code>repeat x = x : repeat x</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 2, "creation_date": 1524497539, "post_id": 49969797, "comment_id": 86985949, "body": "@AJFarmar: this will result in linear memory usage in case you iterate over the list. As they say &quot;<i>if you name it, Haskell remembers it</i>&quot;. If you use <code>x : repeat x</code>, then you will lazily keep calling the tail. With your given repeat function, you will eventually run out of memory if you call <code>let l = repeat 14 in l!!100000000000 + l!!100000000000</code>"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 8, "last_activity_date": 1524424622, "creation_date": 1524424622, "answer_id": 49969797, "question_id": 49969748, "link": "https://stackoverflow.com/questions/49969748/produce-an-infinite-list-of-identical-elements-in-haskell/49969797#49969797", "title": "Produce an infinite list of identical elements in Haskell", "body": "<p>You are quite close, but the strange thing here is that you write <code>x*xs</code>, <code>(*)</code> is an operator that is usually used to <em>multiply</em> numbers, it is a function that is a method of the <code>Num</code> typeclass.</p>\n\n<p>In case you construct a list, you use the <em>list data constructors</em>. The two data constructors are <code>[] :: [a]</code> (the empty list), and <code>(:) :: a -&gt; [a] -&gt; [a]</code>. Here it makes sense to use the <code>(:)</code> operator: we prepend <code>xs</code> with <code>x</code>, so we can write:</p>\n\n<pre><code>repeat :: a -&gt; [a]\nrepeat x = xs\n    where xs = x : xs\n</code></pre>\n\n<p>Here we thus construct for a given <code>x</code> parameter, a linked list that looks like:</p>\n\n<pre><code>+-------+\n|  (:)  |&lt;-|\n+---+---+  |\n| o | o |  |\n+-|-+-|-+  |\n  v   `----'\n  x\n</code></pre>\n\n<p>So a \"cons\" element where the tail refers to itself. As a result if you perform <em>some</em> list processing, it is possible that the memory usage remains constant (without garbage collection) and Haskell thus keeps looping in the <em>same</em> cons object.</p>\n"}], "owner": {"reputation": 37, "user_id": 9320274, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-y2XXwLLa_4A/AAAAAAAAAAI/AAAAAAAAACM/ZDabh3cNQOo/photo.jpg?sz=128", "display_name": "AMINA ARSHAD", "link": "https://stackoverflow.com/users/9320274/amina-arshad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 926, "favorite_count": 0, "accepted_answer_id": 49969797, "answer_count": 1, "score": 2, "last_activity_date": 1524424622, "creation_date": 1524424346, "last_edit_date": 1524424392, "question_id": 49969748, "link": "https://stackoverflow.com/questions/49969748/produce-an-infinite-list-of-identical-elements-in-haskell", "title": "Produce an infinite list of identical elements in Haskell", "body": "<p>In Haskell programming language, how can we produce an infinite list of identical elements.What is the code in Haskell in which user inputs some number and infinite list of that number generated. I had practiced but it was not successful. My logic is below:\nCode:</p>\n\n<pre><code>repeat :: a -&gt; [a]\nrepeat x = xs where \n          xs=x*xs\n</code></pre>\n"}, {"tags": ["haskell", "hugs"], "comments": [{"owner": {"reputation": 1341, "user_id": 1036044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PzcQL.jpg?s=128&g=1", "display_name": "Probie", "link": "https://stackoverflow.com/users/1036044/probie"}, "edited": false, "score": 6, "creation_date": 1524416766, "post_id": 49968446, "comment_id": 86952839, "body": "How have you defined your permutations function?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1524417834, "post_id": 49968446, "comment_id": 86953180, "body": "How can we help you without seeing how you implemented the permutations generator?"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1524419823, "post_id": 49968446, "comment_id": 86953871, "body": "One thing to keep in mind when writing such functions is that <i>prepending is basically always better than appending</i>.  If you have some list <code>xs</code>, then <code>1:xs</code> and <code>2:xs</code> will <i>share</i> <code>xs</code>, whereas <code>xs ++ [1]</code> and <code>xs ++ [2]</code> will each make their own copy of it."}], "answers": [{"comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1524432546, "post_id": 49968926, "comment_id": 86957683, "body": "Calling the garbage collector a lot isn&#39;t a big deal as long as the working set stays small, and the working set there should stay within a multiple of the list length, if my cursory analysis is right."}], "tags": [], "owner": {"reputation": 1341, "user_id": 1036044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PzcQL.jpg?s=128&g=1", "display_name": "Probie", "link": "https://stackoverflow.com/users/1036044/probie"}, "is_accepted": false, "score": 3, "last_activity_date": 1524419200, "creation_date": 1524419200, "answer_id": 49968926, "question_id": 49968446, "link": "https://stackoverflow.com/questions/49968446/hugs-permutations-sufficient-space/49968926#49968926", "title": "Hugs Permutations Sufficient Space", "body": "<p>It's likely that the problem isn't because of Hugs, but because your permutation function is written in a way which is preventing garbage collection, or just otherwise allocating too much memory.</p>\n\n<p>The following definition of permutations works for <code>[1..9]</code> in both GHC and Hugs for me (although <code>permutations [1..9]</code> in Hugs requires the garbage collector to be called a staggering 58 times on my computer)</p>\n\n<pre><code>permutations :: [a] -&gt; [[a]]\npermutations [] = [[]]\npermutations (x:xs) = concatMap insertEverywhere (permutations xs)\n  where insertEverywhere [] = [[x]]\n        insertEverywhere (y:ys) = (x:y:ys): (map (y:) $ insertEverywhere ys)\n</code></pre>\n"}], "owner": {"reputation": 640, "user_id": 8015575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/600de8cfd5d1fbd41152c709122662f0?s=128&d=identicon&r=PG&f=1", "display_name": "Ben373", "link": "https://stackoverflow.com/users/8015575/ben373"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "closed_date": 1524463353, "answer_count": 1, "score": 0, "last_activity_date": 1524419200, "creation_date": 1524416033, "last_edit_date": 1524418296, "question_id": 49968446, "link": "https://stackoverflow.com/questions/49968446/hugs-permutations-sufficient-space", "closed_reason": "Not suitable for this site", "title": "Hugs Permutations Sufficient Space", "body": "<p>First of all, yeah I know that I should use ghc instead (but we are forced to use hugs in the course)</p>\n\n<p>So I try to generate all permutations of <code>[1 .. 9]</code> but when evaluating this, hugs throws an error:\n\"ERROR - Garbage collection fails to reclaim sufficient space\"</p>\n\n<p>Is there any quickfix or roundabout for this?</p>\n"}, {"tags": ["haskell", "x11", "pid"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1524415113, "post_id": 49968223, "comment_id": 86952263, "body": "You can try _NET_WM_PID but chances it will work are rather slim, given that _NET_WM_NAME is not set. (_NET_WM_NAME has nothing to do with PIDs) In general, it is not possible to do reliably, or even define precisely what it means."}, {"owner": {"reputation": 20326, "user_id": 750216, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/974fb481d985024715a6816dfbb9cebf?s=128&d=identicon&r=PG", "display_name": "R\u0103zvan Flavius Panda", "link": "https://stackoverflow.com/users/750216/r%c4%83zvan-flavius-panda"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1524415602, "post_id": 49968223, "comment_id": 86952440, "body": "@n.m. Thank you, that was a copy/typo, it was supposed to say <code>_NET_WM_PID</code>. I updated it now."}, {"owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "edited": false, "score": 0, "creation_date": 1524428810, "post_id": 49968223, "comment_id": 86956686, "body": "Please note that if you get a value in <code>_NET_WM_PID</code> you don&#39;t know if you can use it yet. It might not be for your machine. See <code>ssh -X</code>."}], "answers": [{"comments": [{"owner": {"reputation": 20326, "user_id": 750216, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/974fb481d985024715a6816dfbb9cebf?s=128&d=identicon&r=PG", "display_name": "R\u0103zvan Flavius Panda", "link": "https://stackoverflow.com/users/750216/r%c4%83zvan-flavius-panda"}, "edited": false, "score": 0, "creation_date": 1524450450, "post_id": 49970271, "comment_id": 86961220, "body": "We know for sure that PID can be obtained at least as reliable as running <code>xprop _NET_WM_PID</code> and then clicking on a window is. So there are ways, we just need the code to achieve that."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 20326, "user_id": 750216, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/974fb481d985024715a6816dfbb9cebf?s=128&d=identicon&r=PG", "display_name": "R\u0103zvan Flavius Panda", "link": "https://stackoverflow.com/users/750216/r%c4%83zvan-flavius-panda"}, "edited": false, "score": 0, "creation_date": 1524468395, "post_id": 49970271, "comment_id": 86966964, "body": "@R\u0103zvanFlaviusPanda if you can do xprop _NET_WM_PID, you shoould be able to do the same with XGetWindowRoperty. If you in fact cannot, there is a problem with your code and you should ask a question about a problem in your code, showing a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 20326, "user_id": 750216, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/974fb481d985024715a6816dfbb9cebf?s=128&d=identicon&r=PG", "display_name": "R\u0103zvan Flavius Panda", "link": "https://stackoverflow.com/users/750216/r%c4%83zvan-flavius-panda"}, "edited": false, "score": 0, "creation_date": 1524488284, "post_id": 49970271, "comment_id": 86979495, "body": "@R\u0103zvanFlaviusPanda Sure. But the question explicitly says, &quot;I tried checking the <code>_NET_WM_PID</code> and it was always unset&quot;... so I took that as true. If it&#39;s not, well... that&#39;s on you, isn&#39;t it? =P (And anyway I wouldn&#39;t consider that &quot;reliable&quot; at all.)"}, {"owner": {"reputation": 20326, "user_id": 750216, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/974fb481d985024715a6816dfbb9cebf?s=128&d=identicon&r=PG", "display_name": "R\u0103zvan Flavius Panda", "link": "https://stackoverflow.com/users/750216/r%c4%83zvan-flavius-panda"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1524498622, "post_id": 49970271, "comment_id": 86986633, "body": "@n.m. Before answering you could have asked in comments if it was unclear what I was asking for or wanted more information. How do you suggest we proceed now so this question does not become useless (eg. without proper answers)? What should I do?"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1524427784, "creation_date": 1524427784, "answer_id": 49970271, "question_id": 49968223, "link": "https://stackoverflow.com/questions/49968223/x11-lib-how-to-obtain-pid-of-the-current-window/49970271#49970271", "title": "X11 lib - How to obtain PID of the current window?", "body": "<p>It can't be reliably done, due to architectural decisions made by the X11 team. For example, the process that created a window may not even be on the same machine as the X11 server (and who knows if the OS of the machine it's running on even has a concept of PIDs?); and besides that there's not really a concept of \"ownership\" in X11, as any program can do anything to any window.</p>\n"}, {"comments": [{"owner": {"reputation": 20326, "user_id": 750216, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/974fb481d985024715a6816dfbb9cebf?s=128&d=identicon&r=PG", "display_name": "R\u0103zvan Flavius Panda", "link": "https://stackoverflow.com/users/750216/r%c4%83zvan-flavius-panda"}, "edited": false, "score": 0, "creation_date": 1524450444, "post_id": 49970490, "comment_id": 86961218, "body": "We know for sure that PID can be obtained at least as reliable as running <code>xprop _NET_WM_PID</code> and then clicking on a window is. So there are ways, we just need the code to achieve that."}], "tags": [], "owner": {"reputation": 33990, "user_id": 14768, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/b6aMa.png?s=128&g=1", "display_name": "Joshua", "link": "https://stackoverflow.com/users/14768/joshua"}, "is_accepted": false, "score": 1, "last_activity_date": 1524451847, "last_edit_date": 1524451847, "creation_date": 1524429374, "answer_id": 49970490, "question_id": 49968223, "link": "https://stackoverflow.com/questions/49968223/x11-lib-how-to-obtain-pid-of-the-current-window/49970490#49970490", "title": "X11 lib - How to obtain PID of the current window?", "body": "<p>There is no good way to get the PID of an X11 window; and if there were it would not be immediately useful because the process is not guaranteed to be on the same machine, and may not even be resolvable from the machine your process is running on.</p>\n\n<p>The old <code>xhost</code> mechanism is virtually gone from modern usage, but the concept is very much alive. <code>ssh -X</code> is very much in use and you may have to deal with the fact that both your process and the target process are running under different instances of <code>ssh -X</code>, potentially under different users. This leaves no path to resolve target.</p>\n\n<p>However, if you got here because you need to kill the process, you are (kind of) in luck. The process can be dumped from the X11 session (which terminates it in the default handler) by calling <code>XKilLClient</code> on the target window.</p>\n\n<pre><code>int XKillClient(Display *display, XID resource);\n</code></pre>\n\n<p>The first argument is your connection to the X server. The second argument is any window (or any other resource) of the process you want gone. See <code>man 3 XKillClient</code> for more details.</p>\n\n<p>After reading comment, I feel like I am obliged to point out that <code>_NET_WM_PID</code> is completely unreliable. At this moment I have a window on my desktop for which <code>_NET_WM_PID</code> reports 1. This now sounds like a horrible XY problem. The C API function to retrieve a property is <code>XGetWindowProperty</code>, which you would call to get things like window title.</p>\n"}, {"tags": [], "owner": {"reputation": 20326, "user_id": 750216, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/974fb481d985024715a6816dfbb9cebf?s=128&d=identicon&r=PG", "display_name": "R\u0103zvan Flavius Panda", "link": "https://stackoverflow.com/users/750216/r%c4%83zvan-flavius-panda"}, "is_accepted": true, "score": 0, "last_activity_date": 1524521091, "creation_date": 1524521091, "answer_id": 49990593, "question_id": 49968223, "link": "https://stackoverflow.com/questions/49968223/x11-lib-how-to-obtain-pid-of-the-current-window/49990593#49990593", "title": "X11 lib - How to obtain PID of the current window?", "body": "<p>In the end, I figured out what I was doing wrong.\nCode adapted from <a href=\"https://github.com/nomeata/arbtt\" rel=\"nofollow noreferrer\">ARBTT</a>:</p>\n\n<pre><code>getParent :: Display -&gt; Window -&gt; IO Window\ngetParent dpy w = do\n  (_, parent, _) &lt;- queryTree dpy w `catchIOError` const (return (0,0,[]))\n  return parent\n\nfollowTreeUntil :: Display -&gt; (Window -&gt; IO Bool) -&gt; Window -&gt; IO Window\nfollowTreeUntil dpy cond = go\n  where go w = do\n          match &lt;- cond w\n          if match\n            then return w\n            else\n              do p &lt;- getParent dpy w\n                 if p == 0 then return w\n                           else go p\n\ngetFocusedWindowPID :: Display -&gt; IO String\ngetFocusedWindowPID d = do\n  (w, _) &lt;- getInputFocus d\n  wt &lt;- followTreeUntil d (hasCorrectPID d) w\n  getWindowPID d wt\n\ngetWindowPID :: Display -&gt; Window -&gt; IO String\ngetWindowPID d w = do\n  nWP &lt;- internAtom d \"_NET_WM_PID\" False\n  pid' &lt;- getWindowProperty32 d nWP w\n  let pid = case pid' of\n              Just [pid''] -&gt; show pid''\n              _            -&gt; \"\"\n  return pid\n\nhasCorrectPID :: Display -&gt; Window -&gt; IO Bool\nhasCorrectPID d w = do\n  pid &lt;- getWindowPID d w\n  return $ pid /= \"\"\n\nprintPIDs :: IO ()\nprintPIDs = do\n  d &lt;- openDisplay \"\"\n  pid &lt;- getFocusedWindowPID d\n  print pid\n  closeDisplay d\n  threadDelay 1000000\n  printPIDs\n</code></pre>\n\n<p>This will display the PID of the focused window once every second.</p>\n"}], "owner": {"reputation": 20326, "user_id": 750216, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/974fb481d985024715a6816dfbb9cebf?s=128&d=identicon&r=PG", "display_name": "R\u0103zvan Flavius Panda", "link": "https://stackoverflow.com/users/750216/r%c4%83zvan-flavius-panda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 389, "favorite_count": 0, "accepted_answer_id": 49990593, "answer_count": 3, "score": 0, "last_activity_date": 1524521091, "creation_date": 1524414527, "last_edit_date": 1524415570, "question_id": 49968223, "link": "https://stackoverflow.com/questions/49968223/x11-lib-how-to-obtain-pid-of-the-current-window", "title": "X11 lib - How to obtain PID of the current window?", "body": "<p>How to obtain PID of the current window using <a href=\"https://hackage.haskell.org/package/X11\" rel=\"nofollow noreferrer\">X11 lib</a>?</p>\n\n<p>I tried checking the <code>_NET_WM_PID</code> property of the window and its parents and it was always unset.</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1524404802, "post_id": 49966579, "comment_id": 86948808, "body": "Write a function with the pattern and add a parameter for everything that is different in your cases. (Bonus tip: use a function as a parameter for everything that is too different)"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 6, "creation_date": 1524404821, "post_id": 49966579, "comment_id": 86948811, "body": "Congratulations, you&#39;ve discovered <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Data-Monoid.html#t:Monoid\" rel=\"nofollow noreferrer\">Monoids</a>! Or <a href=\"https://www.haskell.org/hoogle/?hoogle=foldr\" rel=\"nofollow noreferrer\">folds</a>, depending on your perspective."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1524404919, "post_id": 49966579, "comment_id": 86948844, "body": "These are called <i>folds</i>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1524404954, "post_id": 49966579, "comment_id": 86948853, "body": "Lookup <code>foldr</code> and <code>foldl</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1524407233, "post_id": 49966579, "comment_id": 86949658, "body": "We can even generalize this further: this is in fact a <i>catamorphism</i>."}, {"owner": {"reputation": 106013, "user_id": 633183, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/RHeN9.png?s=128&g=1", "display_name": "Thank you", "link": "https://stackoverflow.com/users/633183/thank-you"}, "edited": false, "score": 0, "creation_date": 1524458511, "post_id": 49966579, "comment_id": 86962887, "body": "Are congratulations in order? It looks like a homework assignment..."}, {"owner": {"reputation": 172, "user_id": 7072110, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2a0dba2d20a496db6baed0c5e59416de?s=128&d=identicon&r=PG&f=1", "display_name": "realicado", "link": "https://stackoverflow.com/users/7072110/realicado"}, "reply_to_user": {"reputation": 106013, "user_id": 633183, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/RHeN9.png?s=128&g=1", "display_name": "Thank you", "link": "https://stackoverflow.com/users/633183/thank-you"}, "edited": false, "score": 0, "creation_date": 1524490138, "post_id": 49966579, "comment_id": 86980850, "body": "@user633183 Nope, revision for an exam that I have next week; took some sample questions from previous years to try"}], "answers": [{"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 19, "last_activity_date": 1524405596, "creation_date": 1524405596, "answer_id": 49966755, "question_id": 49966579, "link": "https://stackoverflow.com/questions/49966579/writing-a-high-order-function-to-capture-common-pattern-haskell/49966755#49966755", "title": "Writing a high order function to capture common pattern haskell", "body": "<p>All* your functions have the form:</p>\n\n<pre><code>fn [] = P_0\nfn (x:xs) = P_1 x (fn xs)\n</code></pre>\n\n<p>Where <code>P_0</code> and <code>P_1</code> are some constants. I'll call <code>P_0</code> <code>zero</code>, and <code>P_1</code> <code>combine</code>, and add them to the function:</p>\n\n<pre><code>-- P_0  P_1     list   = result\nfn zero _       []     = zero\nfn zero combine (x:xs) = combine x (fn zero combine xs)\n</code></pre>\n\n<p>There we go. Now we have <code>f1 = fn 1 (*)</code>, <code>f3 = fn 0 (+)</code>, and <code>f4 = fn [] (++)</code>. <code>f2</code> is a little weird, but you can work it out: <code>f2 = fn 0 (\\_ b -&gt; b+1)</code>.</p>\n\n<p>Asking GHCi the type gives us that <code>fn :: b -&gt; (a -&gt; b -&gt; b) -&gt; [a] -&gt; b</code>, and <a href=\"https://www.haskell.org/hoogle/?hoogle=b+-%3E+%28a+-%3E+b+-%3E+b%29+-%3E+%5Ba%5D+-%3E+b\" rel=\"noreferrer\">Hoogling</a> shows us that this function <code>fn</code> is actually the function <code>foldr</code>:</p>\n\n<pre><code>foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b\n--       ^combine         ^zero\n</code></pre>\n\n<p>So there you go: folds, or particularly <em>right</em> folds (the <code>r</code> in <code>foldr</code> means right) is the general pattern you're looking for.</p>\n\n<p>By the way, there are also <em>left</em> folds. I'll leave you to try to work out what those might be. Hoogle could also help you here.</p>\n\n<p>There's another pattern you could see here, called Monoids, but I'll also leave that to you, since it seems out of scope for this question.</p>\n\n<hr>\n\n<p>* This may look weird for <code>f2 (x:xs) = 1 + f2 xs</code>, because there isn't an <code>x</code> involved in the result, but this is just the case where <code>P_1 a b = 1 + b</code>, which is still technically the same form.</p>\n"}, {"comments": [{"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 3, "creation_date": 1524411655, "post_id": 49966756, "comment_id": 86950995, "body": "<code>foldr (\\_ a -&gt; a + 1) 0 $ [1,2,3]</code> might be a slightly easier-to-recognise/digest version of <code>f2</code>, rather than using <code>map (const 1)</code>."}], "tags": [], "owner": {"reputation": 521, "user_id": 7126380, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10207438513426512/picture?type=large", "display_name": "Johnny Liao", "link": "https://stackoverflow.com/users/7126380/johnny-liao"}, "is_accepted": false, "score": 7, "last_activity_date": 1524428492, "last_edit_date": 1524428492, "creation_date": 1524405596, "answer_id": 49966756, "question_id": 49966579, "link": "https://stackoverflow.com/questions/49966579/writing-a-high-order-function-to-capture-common-pattern-haskell/49966756#49966756", "title": "Writing a high order function to capture common pattern haskell", "body": "<p>It looks like you can use foldr to represent all of them.</p>\n\n<pre><code>foldr (*) 1 [1,2,3]  --f1\n\nfoldr (\\_ a-&gt; 1 + a) 0 [1,2,3]  --f2\n\nfoldr (+) 0 [1,2,3]  --f3\n\nfoldr (++) [] [\"a\",\"b\",\"c\"]  --f4\n</code></pre>\n\n<p>They all need a list, an init value and an operator.\nThey all apply the operator from right to left: e.g <code>f1 [1,2,3]  = 1*2*(3*1)</code>\nSo you can use <a href=\"http://zvon.org/other/haskell/Outputprelude/foldr_f.html\" rel=\"nofollow noreferrer\"><code>foldr</code></a> to parameterize the operator and the init value.</p>\n"}], "owner": {"reputation": 172, "user_id": 7072110, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2a0dba2d20a496db6baed0c5e59416de?s=128&d=identicon&r=PG&f=1", "display_name": "realicado", "link": "https://stackoverflow.com/users/7072110/realicado"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 603, "favorite_count": 2, "accepted_answer_id": 49966755, "answer_count": 2, "score": 15, "last_activity_date": 1524428492, "creation_date": 1524404538, "last_edit_date": 1524404990, "question_id": 49966579, "link": "https://stackoverflow.com/questions/49966579/writing-a-high-order-function-to-capture-common-pattern-haskell", "title": "Writing a high order function to capture common pattern haskell", "body": "<pre><code>f1 [] = 1\nf1 (x:xs) = x * f1 xs\n\nf2 [] = 0\nf2 (x:xs) = 1 + f2 xs\n\nf3 [] = 0\nf3 (x:xs) = x + f3 xs\n\nf4 [] = []\nf4 (x:xs) = x ++ f4 xs\n</code></pre>\n\n<p>These all have a common behavior, how exactly can I identify the pattern and write a high order function to capture it?</p>\n"}, {"tags": ["haskell", "io", "sum"], "comments": [{"owner": {"reputation": 2139, "user_id": 465100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/debe4d3217980e495cf1f15e7e4b4c9f?s=128&d=identicon&r=PG", "display_name": "Artem Pelenitsyn", "link": "https://stackoverflow.com/users/465100/artem-pelenitsyn"}, "edited": false, "score": 0, "creation_date": 1524396046, "post_id": 49964920, "comment_id": 86946469, "body": "Solution with <code>replicateM</code> is preferable, while recursion (as in other answer) is \u201cgoto of functional programming\u201d. So I suggest switching \u201csolution\u201d mark to the answer with <code>replicateM</code>."}, {"owner": {"reputation": 187, "user_id": 9517321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dc52bd738d15863c94b001d51483099?s=128&d=identicon&r=PG&f=1", "display_name": "Aelin", "link": "https://stackoverflow.com/users/9517321/aelin"}, "reply_to_user": {"reputation": 2139, "user_id": 465100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/debe4d3217980e495cf1f15e7e4b4c9f?s=128&d=identicon&r=PG", "display_name": "Artem Pelenitsyn", "link": "https://stackoverflow.com/users/465100/artem-pelenitsyn"}, "edited": false, "score": 1, "creation_date": 1524398400, "post_id": 49964920, "comment_id": 86947074, "body": "The <code>replicateM</code> solution didn&#39;t have the printing of the sum after every number, so it isn&#39;t a solution to this particular function."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1524408123, "post_id": 49964920, "comment_id": 86949953, "body": "Equating explicit recursion with using goto is a bit extreme, but I like the idea. :)"}, {"owner": {"reputation": 2139, "user_id": 465100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/debe4d3217980e495cf1f15e7e4b4c9f?s=128&d=identicon&r=PG", "display_name": "Artem Pelenitsyn", "link": "https://stackoverflow.com/users/465100/artem-pelenitsyn"}, "edited": false, "score": 0, "creation_date": 1524408142, "post_id": 49964920, "comment_id": 86949962, "body": "@Aelin oh, missed that, sorry. Still, the part about printing partial sums is orthogonal to <code>replicateM</code>-one. To get those you could replace <code>sum</code> from that answer with <code>scanl (+) 0</code>."}, {"owner": {"reputation": 2139, "user_id": 465100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/debe4d3217980e495cf1f15e7e4b4c9f?s=128&d=identicon&r=PG", "display_name": "Artem Pelenitsyn", "link": "https://stackoverflow.com/users/465100/artem-pelenitsyn"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1524408222, "post_id": 49964920, "comment_id": 86949989, "body": "@chepner the idea is not my, it&#39;s Erik Meijer&#39;s."}], "answers": [{"comments": [{"owner": {"reputation": 2139, "user_id": 465100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/debe4d3217980e495cf1f15e7e4b4c9f?s=128&d=identicon&r=PG", "display_name": "Artem Pelenitsyn", "link": "https://stackoverflow.com/users/465100/artem-pelenitsyn"}, "edited": false, "score": 0, "creation_date": 1524408318, "post_id": 49964990, "comment_id": 86950022, "body": "They say the part about printing partial sums is not addressed in the answer. Perhaps, you could update it, so we might persuade OP to use library functions instead of plain recursion."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1524409198, "last_edit_date": 1524409198, "creation_date": 1524393456, "answer_id": 49964990, "question_id": 49964920, "link": "https://stackoverflow.com/questions/49964920/haskell-read-n-numbers-from-user-and-return-their-sum/49964990#49964990", "title": "Haskell read n numbers from user and return their sum", "body": "<p>You can use <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Control-Monad.html#v:replicateM\" rel=\"nofollow noreferrer\"><strong><code>replicateM :: Applicative m =&gt; Int -&gt; m a -&gt; m [a]</code></strong></a> for this:</p>\n\n<pre><code>import Control.Monad(replicateM)\n\nisums :: (Read n, Num n) =&gt; Int -&gt; IO n\nisums n = do\n    numbers &lt;- replicateM n readLn\n    return (sum numbers)\n</code></pre>\n\n<p>So here we repeat <code>readLn</code> the given number of times, and then we return the <code>sum</code> of the <code>numbers</code> list.</p>\n\n<p>An equivalent can be achieved with an <code>fmap</code>:</p>\n\n<pre><code>import Control.Monad(replicateM)\n\nisums :: (Read n, Num n) =&gt; Int -&gt; IO n\nisums n = fmap sum (replicateM n readLn)\n</code></pre>\n\n<p>Or even <em>pointfree</em> (and <em>pointless</em>):</p>\n\n<pre><code>import Control.Monad(replicateM)\n\nisums :: (Read n, Num n) =&gt; Int -&gt; IO n\nisums = fmap sum . flip replicateM readLn\n</code></pre>\n\n<p>We can also produce a list of partial sums with <code>scanl</code>:</p>\n\n<pre><code>import Control.Monad(replicateM)\n\nisums :: (Read n, Num n) =&gt; Int -&gt; IO [n]\nisums = fmap (scanl (+) 0) . flip replicateM readLn\n</code></pre>\n\n<p>and then later process the list, or in case we need to print these, and return the last one, we can perform a <code>mapM</code> on that list, like:</p>\n\n<pre><code>import Control.Monad(replicateM)\n\nisums :: (Read n, Num n) =&gt; Int -&gt; IO ()\nisums n = fmap (scanl (+) 0) (replicateM n readLn) &gt;&gt;= mapM_ print\n</code></pre>\n\n<p>Or in case we need to print the partial sums:</p>\n\n<pre><code>isums :: (Read n, Num n, Show n) =&gt; Int -&gt; IO n\nisums n = foldM f 0 (replicate n ())\n    where f a _ = readLn &gt;&gt;= \\b -&gt; let c = a + b in print c &gt;&gt; return c\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "is_accepted": false, "score": 3, "last_activity_date": 1524409828, "last_edit_date": 1524409828, "creation_date": 1524393721, "answer_id": 49965024, "question_id": 49964920, "link": "https://stackoverflow.com/questions/49964920/haskell-read-n-numbers-from-user-and-return-their-sum/49965024#49965024", "title": "Haskell read n numbers from user and return their sum", "body": "<p>This would probably be easiest to express using a helper function, as the extra requirement of printing the partial sums after each input adds a bit of extra clutter:</p>\n\n<pre><code>isums :: Int -&gt; IO Int\nisums n = helper n 0\n  where\n    helper 0 acc = return acc\n    helper m acc = do\n        x &lt;- readLn\n        let x' = acc + x\n        print x'\n        helper (m - 1) x'\n</code></pre>\n\n<hr>\n\n<p>What you're doing is kinda like a fold (look at <a href=\"https://hoogle.haskell.org/?hoogle=foldM&amp;scope=set%3Astackage\" rel=\"nofollow noreferrer\"><code>foldM</code></a>), only instead of traversing a list, you're getting the values \"to be folded\" from IO. If we had a function:</p>\n\n<pre><code>accM :: Monad m =&gt; (a -&gt; m a) -&gt; m a -&gt; Int -&gt; m a\naccM f acc 0 = acc\naccM f acc n = accM f (acc &gt;&gt;= f) (n - 1)\n</code></pre>\n\n<p>Then we could write this as:</p>\n\n<pre><code>isums :: Int -&gt; IO Int\nisums n = accM helper (return 0) n\n  where\n    helper acc = do\n        x &lt;- readLn\n        let x' = acc + x\n        print x'\n        return x'\n</code></pre>\n\n<p>Which is a bit nicer (and more reusable) as it lets us separate the general behaviour (<code>accM</code>) from the specific behaviour (<code>helper</code>).</p>\n"}, {"comments": [{"owner": {"reputation": 5397, "user_id": 2193020, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/aa10d01a3d48851073bd61877a56b5a7?s=128&d=identicon&r=PG", "display_name": "hnefatl", "link": "https://stackoverflow.com/users/2193020/hnefatl"}, "edited": false, "score": 1, "creation_date": 1524686289, "post_id": 49983117, "comment_id": 87076820, "body": "Nice use of the list of lazy IO actions - I&#39;d hoped something like that was possible, but I hadn&#39;t got round to testing it."}], "tags": [], "owner": {"reputation": 2139, "user_id": 465100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/debe4d3217980e495cf1f15e7e4b4c9f?s=128&d=identicon&r=PG", "display_name": "Artem Pelenitsyn", "link": "https://stackoverflow.com/users/465100/artem-pelenitsyn"}, "is_accepted": true, "score": 2, "last_activity_date": 1524500031, "last_edit_date": 1524500031, "creation_date": 1524492138, "answer_id": 49983117, "question_id": 49964920, "link": "https://stackoverflow.com/questions/49964920/haskell-read-n-numbers-from-user-and-return-their-sum/49983117#49983117", "title": "Haskell read n numbers from user and return their sum", "body": "<p>Here is one more solution: it builds on the last version of the @Willem's one, but instead of using a list of <code>()</code>'s (which is a bit underwhelming) as a fuel for the loop (<code>foldM</code>) it applies a list of actions for reading the values. </p>\n\n<pre><code>import Control.Monad\n\nisums n = foldM go 0 (replicate n readLn) \n  where\n    go s a = do \n      x &lt;- a\n      let s' = s + x \n      print s'\n      return s'\n</code></pre>\n\n<p>Here <code>replicate n readLn</code> creates a list of actions, each of which reads an integer. These actions are not evaluated till the <code>go</code> is called during the looping by means of <code>foldM</code>. The fact that we can create such a list without performing actual reading stems from the Haskell's laziness.</p>\n"}], "owner": {"reputation": 187, "user_id": 9517321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dc52bd738d15863c94b001d51483099?s=128&d=identicon&r=PG&f=1", "display_name": "Aelin", "link": "https://stackoverflow.com/users/9517321/aelin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 751, "favorite_count": 0, "accepted_answer_id": 49983117, "answer_count": 3, "score": 3, "last_activity_date": 1524500031, "creation_date": 1524392919, "question_id": 49964920, "link": "https://stackoverflow.com/questions/49964920/haskell-read-n-numbers-from-user-and-return-their-sum", "title": "Haskell read n numbers from user and return their sum", "body": "<p>I'm trying to write a function <code>isums</code> that reads <code>n</code> numbers from user and returns their sum. Also, after each number, the sum up to that number is printed. I have this so far:</p>\n\n<pre><code>isums :: Int -&gt; IO Int\nisums n = do\n    num &lt;- readLn\n    putStrLn (show (num + sum))\n    sum &lt;- isums (n - 1)\n    return (num + sum)\n</code></pre>\n\n<p>Also I'm not using IORef.</p>\n"}, {"tags": ["haskell", "maybe"], "comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 3, "creation_date": 1524384962, "post_id": 49963328, "comment_id": 86943899, "body": "It might be worth pointing out explicitly that this difference is a significant one: There are some things (like, in general, functions) that cannot have an <code>Eq</code> instance. So <code>coalesce</code> would work fine with these, but <code>coalesce&#39;</code> would not."}], "answers": [{"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 6, "last_activity_date": 1524380193, "creation_date": 1524380193, "answer_id": 49963357, "question_id": 49963328, "link": "https://stackoverflow.com/questions/49963328/difference-between-isnothing-and-nothing-in-haskell/49963357#49963357", "title": "difference between isNothing and (== Nothing) in Haskell?", "body": "<p>Because the type of <code>==</code> is</p>\n\n<pre><code>(==) :: (Eq a) =&gt; a -&gt; a -&gt; Bool\n</code></pre>\n\n<p>Your second definition (<code>coalesce'</code>) uses <code>==</code>, so it inherits the <code>Eq</code> constraint on its arguments from <code>==</code>.</p>\n\n<hr>\n\n<p>Strictly speaking <code>coalesce'</code> uses <code>==</code> on values of type <code>Maybe a</code>, but there's an instance</p>\n\n<pre><code>instance (Eq a) =&gt; Eq (Maybe a) where ...\n</code></pre>\n\n<p>so the <code>Eq (Maybe a)</code> constraint becomes <code>Eq a</code>, because that's what's needed to support <code>==</code> on <code>Maybe a</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "is_accepted": true, "score": 16, "last_activity_date": 1524380657, "last_edit_date": 1524380657, "creation_date": 1524380230, "answer_id": 49963359, "question_id": 49963328, "link": "https://stackoverflow.com/questions/49963328/difference-between-isnothing-and-nothing-in-haskell/49963359#49963359", "title": "difference between isNothing and (== Nothing) in Haskell?", "body": "<p><code>==</code> is a function <code>Eq a =&gt; a -&gt; a -&gt; Bool</code>. You\u2019re making one of its operands <code>Nothing</code>, so <code>a</code> is a <code>Maybe b</code> for some type <code>b</code>, but that <code>Eq a</code> restriction still applies \u2013 the <code>Maybe b</code> has to have an <code>Eq</code> instance. <code>Maybe b</code> includes a definition for such an instance \u2013 <code>Eq (Maybe b)</code> \u2013 for all <code>Eq b</code>.</p>\n\n<p>In other words, <code>==</code> is just a function and it doesn\u2019t know ahead of time that you\u2019re providing <code>Nothing</code> as an argument. It only knows it\u2019s <em>some</em> <code>Maybe a</code>, and it needs to be able to compare equality if it happens to be a <code>Just \u2026</code>.</p>\n\n<p>In other other words, here\u2019s how you can define the <code>==</code> that already exists for <code>Maybe</code>s:</p>\n\n<pre><code>equals a b = case a of\n    Nothing -&gt; isNothing b\n    Just x -&gt; case b of\n        Nothing -&gt; False\n        Just y -&gt; x == y\n</code></pre>\n\n<p>Notice how <code>x == y</code> appears, meaning there must be an <code>Eq</code> instance for the type of <code>x</code> and <code>y</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 4, "last_activity_date": 1524386256, "creation_date": 1524386256, "answer_id": 49964062, "question_id": 49963328, "link": "https://stackoverflow.com/questions/49963328/difference-between-isnothing-and-nothing-in-haskell/49964062#49964062", "title": "difference between isNothing and (== Nothing) in Haskell?", "body": "<p>Let us first aim to design a <code>(==)</code> function over <code>Maybe</code> values. Usually we consider two things the same if they have the <em>same</em> data constructor, and the <em>parameters</em> are all equal. So we consider <code>F x1 x2 x3</code> and <code>G y1 y2 y3</code> the same if <code>F</code> and <code>G</code> are the same data constructor, and <code>x1 == y1</code>, <code>x2 == y2</code>, and <code>x3 == y3</code>.</p>\n\n<p>So if we implement this for <code>Maybe</code>, there are two cases that are equal: two <code>Nothing</code>s, and two <code>Just</code>s, where the values the <code>Just</code>s encapsulate are the same, so:</p>\n\n<pre><code>instance Eq a =&gt; Eq (Maybe a) where\n    (==) Nothing Nothing = True\n    (==) (Just x) (Just y) = x == y\n    (==) _ _ = False\n</code></pre>\n\n<p>is the most logical way to implement the <code>Eq</code> instance for <code>Maybe a</code>. In the implementation, we use <code>x == y</code>, hence we added the <code>Eq a</code> type constraint.</p>\n\n<p>Now Haskell sees functions conceptually as blackboxes. For <code>Maybe</code>, it thus sees <code>(==)</code> as <code>(==) :: Eq a =&gt; Maybe a -&gt; Maybe a -&gt; Bool</code>. If you thus use this <code>(==)</code> function, it will always require the type constraint <code>Eq a</code>, regardless whether the specific usage will ever need this type constraint to perform the <code>x == y</code> check. If you write <code>(== Nothing)</code>, then we see, that the second clause (<code>(==) (Just x) (Just y)</code>) will never be used, but since Haskell treats functions as blackboxes, it does not known in what cases the type constraint is relevant.</p>\n\n<p><a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Data-Maybe.html#v:isNothing\" rel=\"nofollow noreferrer\"><strong><code>isNothing :: Maybe a -&gt; Bool</code></strong></a> only checks if the value is a <code>Nothing</code>, if it is a <code>Just</code>, then it is always <code>False</code>, regardless what the value is the <code>Just</code> constructor wraps, it is thus implemented like:</p>\n\n<pre><code>isNothing :: Maybe a -&gt; Bool\nisNothing Nothing = True\nisNothing _ = False\n</code></pre>\n\n<p>So we do not need the <code>Eq a</code> type constraint here: we do not check equality of elements <code>Just</code> constructor(s) wrap. So again if we use this, Haskell only checks the type signature, notices that there is no <code>Eq a</code> type constraint involved and hence does not add it to functions that use this function.</p>\n\n<p>Notice that what you implement here actually already is implemented in the <code>Control.Applicative</code> module: <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Control-Applicative.html#v:-60--124--62-\" rel=\"nofollow noreferrer\"><strong><code>(&lt;|&gt;) :: Alternative f =&gt; f a -&gt; f a -&gt; f a</code></strong></a>, for example:</p>\n\n<pre><code>Prelude&gt; import Control.Applicative\nPrelude Control.Applicative&gt; (&lt;|&gt;) Nothing Nothing\nNothing\nPrelude Control.Applicative&gt; (&lt;|&gt;) Nothing (Just 3)\nJust 3\nPrelude Control.Applicative&gt; (&lt;|&gt;) (Just 3) Nothing\nJust 3\nPrelude Control.Applicative&gt; (&lt;|&gt;) (Just 3) (Just 2)\nJust 3\n</code></pre>\n"}], "owner": {"reputation": 18780, "user_id": 683218, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/7Vy7c.png?s=128&g=1", "display_name": "tinlyx", "link": "https://stackoverflow.com/users/683218/tinlyx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5270, "favorite_count": 2, "accepted_answer_id": 49963359, "answer_count": 3, "score": 14, "last_activity_date": 1524386256, "creation_date": 1524379836, "question_id": 49963328, "link": "https://stackoverflow.com/questions/49963328/difference-between-isnothing-and-nothing-in-haskell", "title": "difference between isNothing and (== Nothing) in Haskell?", "body": "<p>I'm confused about why the two functions below involving <code>Nothing</code> are different:</p>\n\n<pre><code>coalesce  m1 m2 = if  isNothing m1 then m2 else m1\n\ncoalesce' m1 m2 = if  (m1 == Nothing) then m2 else m1\n</code></pre>\n\n<p>The first one has type:</p>\n\n<pre><code>\u03bb&gt; :t coalesce\ncoalesce :: Maybe a -&gt; Maybe a -&gt; Maybe a\n</code></pre>\n\n<p>as expected. But the second one has:</p>\n\n<pre><code>\u03bb&gt; :t coalesce'\ncoalesce' :: Eq a =&gt; Maybe a -&gt; Maybe a -&gt; Maybe a\n</code></pre>\n\n<p>Why does using <code>(==Nothing)</code> introduce the <code>Eq a</code> constraint? </p>\n\n<p>(GHC 8.2.2)</p>\n"}, {"tags": ["haskell", "existential-type", "dynamic-dispatch"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 9680729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/381b4e6b719f4c4faa210f3a867bf41a?s=128&d=identicon&r=PG&f=1", "display_name": "richie", "link": "https://stackoverflow.com/users/9680729/richie"}, "edited": false, "score": 0, "creation_date": 1524397899, "post_id": 49963756, "comment_id": 86946956, "body": "Is there maybe some link to an article or a blogpost on this matter you could provide?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 53, "user_id": 9680729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/381b4e6b719f4c4faa210f3a867bf41a?s=128&d=identicon&r=PG&f=1", "display_name": "richie", "link": "https://stackoverflow.com/users/9680729/richie"}, "edited": false, "score": 0, "creation_date": 1524404890, "post_id": 49963756, "comment_id": 86948835, "body": "@richie I can&#39;t find anything, sorry. What I wrote comes from folk lore. You should be able to find material on the dictionary-based implementation of type classes, by googling a bit. Seeing how dependently typed languages (Coq, Idris, Agda) work with existential types also helps: there, the type argument is (by default) explicit, instead of implicit like in Haskell."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 8, "last_activity_date": 1524384039, "last_edit_date": 1524384039, "creation_date": 1524383659, "answer_id": 49963756, "question_id": 49963134, "link": "https://stackoverflow.com/questions/49963134/does-ghc-use-dynamic-dispatch-with-existential-types/49963756#49963756", "title": "Does GHC use dynamic dispatch with existential types?", "body": "<p>Roughly, yes.</p>\n\n<p>When you use a <em>bounded</em> existential quantification, i.e. when the quantified type variable is restricted by some constraint <code>C a =&gt; ...</code> then GHC will store some pointer(s) inside the constructor, remembering the methods of <code>C a</code> so that they can be accessed later on, when you pattern match on that constructor.</p>\n\n<p>Usually a single pointer is used, much like a <code>vptr</code> to a <code>vtable</code> in many OOP implementations. The compiler could also instead store the pointers to the methods directly, avoiding the indirection. I think this is done by GHC when there's only one method in the type class. It might also be used when there are very few, say two, methods -- this would make the memory footprint of each value larger, but faster to access.</p>\n\n<p>So, compiling your code is rouhgly done as if the constraint is replaced with an <code>Eq</code> dictionary, listing its methods. That is:</p>\n\n<pre><code>data EqDict a = EqDict\n   { eq  :: a-&gt;a-&gt;Bool\n   , new :: a-&gt;a-&gt;Bool }\n\ndata ForallFunc = forall a. Forall EqDict (Value -&gt; a) \n\nunpackA (A int) = int\n\nequalityTest :: Value -&gt; Value -&gt; ForallFunc -&gt; Bool            \nequalityTest arg1 arg2 (Forall eqDict unpacker) =\n  let a1 = unpacker arg1\n      a2 = unpacker arg2 in\n    eq eqDict a1 a2\n</code></pre>\n\n<p>Of course, compiling a constructor call <code>Forall someFunction</code> is compiled, roughly, by providing the implementation for the needed <code>==</code>, <code>/=</code> functions, on their specific type which will be abstracted away by the existential quantification.</p>\n"}, {"tags": [], "owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "is_accepted": false, "score": 4, "last_activity_date": 1524383844, "creation_date": 1524383844, "answer_id": 49963777, "question_id": 49963134, "link": "https://stackoverflow.com/questions/49963134/does-ghc-use-dynamic-dispatch-with-existential-types/49963777#49963777", "title": "Does GHC use dynamic dispatch with existential types?", "body": "<p>Yes, ghc uses a form of dynamic dispatch. The <code>Eq a</code> constraint means that the representation for <code>ForallFunc</code> will contain a dictionary (corresponds to a vtable) which is used at runtime to call the right equality function. </p>\n"}], "owner": {"reputation": 53, "user_id": 9680729, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/381b4e6b719f4c4faa210f3a867bf41a?s=128&d=identicon&r=PG&f=1", "display_name": "richie", "link": "https://stackoverflow.com/users/9680729/richie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 219, "favorite_count": 0, "accepted_answer_id": 49963756, "answer_count": 2, "score": 5, "last_activity_date": 1524384039, "creation_date": 1524377904, "question_id": 49963134, "link": "https://stackoverflow.com/questions/49963134/does-ghc-use-dynamic-dispatch-with-existential-types", "title": "Does GHC use dynamic dispatch with existential types?", "body": "<p>Does the following bit of code use dynamic dispatch as it's understood in C++ or Java?</p>\n\n<p>As I understand, at the last line, compiler cannot possibly know at compile time which implementation of (==) to call, yet the code compiles and produces correct results.\nCan someone please explain, what kind of implementation (vptr, for example) lies behind this?</p>\n\n<pre><code>{-# LANGUAGE ExistentialQuantification #-}\n\ndata Value = A Int\n\ndata ForallFunc = forall a. Eq a =&gt; Forall (Value -&gt; a) \n\nunpackA (A int) = int\n\nequalityTest :: Value -&gt; Value -&gt; ForallFunc -&gt; Bool            \nequalityTest arg1 arg2 (Forall unpacker) =\n  let a1 = unpacker arg1\n      a2 = unpacker arg2 in\n    a1 == a2\n</code></pre>\n"}, {"tags": ["haskell", "gcc", "gpgpu", "openacc", "pgcc"], "comments": [{"owner": {"reputation": 3901, "user_id": 3204484, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F7Cc9.jpg?s=128&g=1", "display_name": "Mat Colgrove", "link": "https://stackoverflow.com/users/3204484/mat-colgrove"}, "edited": false, "score": 1, "creation_date": 1524498908, "post_id": 49963011, "comment_id": 86986792, "body": "I&#39;m not able to recreate the segv so I&#39;m not sure what&#39;s wrong there.  Though when putting OpenACC code in a shared object, you need to compile with the &quot;nordc&quot; sub-option (-ta=tesla:cc60,nordc) since RDC requires the code to be statically linked.  It wont effect your call to &quot;acc_init&quot;, but will cause issues when you try to run a device kernel.  Doubtful that it&#39;s the source of your segv either, but worth a try."}, {"owner": {"reputation": 51, "user_id": 1656163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76ccf597bb421199ac3782cc4d7b9b9e?s=128&d=identicon&r=PG", "display_name": "masterq", "link": "https://stackoverflow.com/users/1656163/masterq"}, "reply_to_user": {"reputation": 3901, "user_id": 3204484, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F7Cc9.jpg?s=128&g=1", "display_name": "Mat Colgrove", "link": "https://stackoverflow.com/users/3204484/mat-colgrove"}, "edited": false, "score": 0, "creation_date": 1524821539, "post_id": 49963011, "comment_id": 87135198, "body": "Unfortunately, &quot;nordc&quot; option doesn&#39;t fix my issue."}, {"owner": {"reputation": 51, "user_id": 1656163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76ccf597bb421199ac3782cc4d7b9b9e?s=128&d=identicon&r=PG", "display_name": "masterq", "link": "https://stackoverflow.com/users/1656163/masterq"}, "reply_to_user": {"reputation": 3901, "user_id": 3204484, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/F7Cc9.jpg?s=128&g=1", "display_name": "Mat Colgrove", "link": "https://stackoverflow.com/users/3204484/mat-colgrove"}, "edited": false, "score": 0, "creation_date": 1526962127, "post_id": 49963011, "comment_id": 87932454, "body": "Sorry. This is caused by bad installation of CUDA, and not issue in Haskell language."}], "owner": {"reputation": 51, "user_id": 1656163, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76ccf597bb421199ac3782cc4d7b9b9e?s=128&d=identicon&r=PG", "display_name": "masterq", "link": "https://stackoverflow.com/users/1656163/masterq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 67, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1524376807, "creation_date": 1524376807, "question_id": 49963011, "link": "https://stackoverflow.com/questions/49963011/why-does-mixed-binary-with-haskell-and-openacc-get-segv", "title": "Why does mixed binary with Haskell and OpenACC get SEGV?", "body": "<p>Why does mixed binary with Haskell and OpenACC get SEGV?</p>\n\n<p>The mixed binary with GCC and OpenACC has good result:</p>\n\n<p><a href=\"https://github.com/master-q/test-openacc-gcc\" rel=\"nofollow noreferrer\">https://github.com/master-q/test-openacc-gcc</a></p>\n\n<pre><code>$ make\ngcc main.c -ldl\n/opt/pgi/linux86-64/17.10/bin/pgcc -shared -fpic -fast -acc -ta=tesla,cc60 -o libtestacc.so acc.c\n$ make run\nLD_LIBRARY_PATH=./ ACC_DEVICE_TYPE=NVIDIA ACC_DEVICE_NUM=1 PGI_ACC_NOTIFY=1 ./a.out\n*** acc_init called!\n</code></pre>\n\n<p>However the mixed binary with Haskell and OpenACC has SEGV:</p>\n\n<p><a href=\"https://github.com/master-q/test-openacc-hs\" rel=\"nofollow noreferrer\">https://github.com/master-q/test-openacc-hs</a></p>\n\n<pre><code>$ make\nmkdir -p lib\n/opt/pgi/linux86-64/17.10/bin/pgcc -shared -fpic -fast -acc -ta=tesla,cc60 -o lib/libtestacc.so cbits/acc.c\nstack build\ntest-openacc-hs-0.1.0.0: unregistering (local file changes: README.md app/Main.hs package.yaml src/Lib.hs test-openacc-hs.cabal)\nBuilding all executables for `test-openacc-hs' once. After a successful build of all of them, only specified executables will be rebuilt.\ntest-openacc-hs-0.1.0.0: configure (lib + exe)\nConfiguring test-openacc-hs-0.1.0.0...\ntest-openacc-hs-0.1.0.0: build (lib + exe)\nPreprocessing library for test-openacc-hs-0.1.0.0..\nBuilding library for test-openacc-hs-0.1.0.0..\n[1 of 2] Compiling Lib              ( src/Lib.hs, .stack-work/dist/x86_64-linux/Cabal-2.0.1.0/build/Lib.o )\n[2 of 2] Compiling Paths_test_openacc_hs ( .stack-work/dist/x86_64-linux/Cabal-2.0.1.0/build/autogen/Paths_test_openacc_hs.hs, .stack-work/dist/x86_64-linux/Cabal-2.0.1.0/build/Paths_test_openacc_hs.o )\nPreprocessing executable 'test-openacc-hs-exe' for test-openacc-hs-0.1.0.0..\nBuilding executable 'test-openacc-hs-exe' for test-openacc-hs-0.1.0.0..\n[1 of 2] Compiling Main             ( app/Main.hs, .stack-work/dist/x86_64-linux/Cabal-2.0.1.0/build/test-openacc-hs-exe/test-openacc-hs-exe-tmp/Main.o )\n[2 of 2] Compiling Paths_test_openacc_hs ( .stack-work/dist/x86_64-linux/Cabal-2.0.1.0/build/test-openacc-hs-exe/autogen/Paths_test_openacc_hs.hs, .stack-work/dist/x86_64-linux/Cabal-2.0.1.0/build/test-openacc-hs-exe/test-openacc-hs-exe-tmp/Paths_test_openacc_hs.o )\nLinking .stack-work/dist/x86_64-linux/Cabal-2.0.1.0/build/test-openacc-hs-exe/test-openacc-hs-exe ...\ntest-openacc-hs-0.1.0.0: copy/register\nInstalling library in /home/kiwamu/src/test-openacc-hs/.stack-work/install/x86_64-linux/lts-11.3/8.2.2/lib/x86_64-linux-ghc-8.2.2/test-openacc-hs-0.1.0.0-BEbANszZF7r4p0JDQtDviz\nInstalling executable test-openacc-hs-exe in /home/kiwamu/src/test-openacc-hs/.stack-work/install/x86_64-linux/lts-11.3/8.2.2/bin\nRegistering library for test-openacc-hs-0.1.0.0..\n$ make run\nulimit -c unlimited\nLD_LIBRARY_PATH=lib ACC_DEVICE_TYPE=NVIDIA ACC_DEVICE_NUM=1 PGI_ACC_NOTIFY=1 stack exec test-openacc-hs-exe\n*** acc_init called!\ntotal/free CUDA memory: 0/0\nSegmentation fault (core dumped)\nMakefile:9: recipe for target 'run' failed\nmake: *** [run] Error 139\n$ gdb .stack-work/install/x86_64-linux/lts-11.3/8.2.2/bin/test-openacc-hs-exe core\n--snip--\n[Thread debugging using libthread_db enabled]\nUsing host libthread_db library \"/lib/x86_64-linux-gnu/libthread_db.so.1\".\nCore was generated by `/home/kiwamu/src/test-openacc-hs/.stack-work/install/x86_64-linux/lts-11.3/8.2.'.\nProgram terminated with signal SIGSEGV, Segmentation fault.\n#0  0x00007f6855e787ca in __pgi_uacc_cuda_error_handler () from /opt/pgi/linux86-64/17.10/lib/libaccn.so\n[Current thread is 1 (Thread 0x7f6857a56740 (LWP 21368))]\n(gdb) bt\n#0  0x00007f6855e787ca in __pgi_uacc_cuda_error_handler () from /opt/pgi/linux86-64/17.10/lib/libaccn.so\n#1  0x00007f6855e7c3c6 in __pgi_uacc_cuda_init () from /opt/pgi/linux86-64/17.10/lib/libaccn.so\n#2  0x00007f685609e289 in __pgi_uacc_enumerate () from /opt/pgi/linux86-64/17.10/lib/libaccg.so\n#3  0x00007f685609e5c4 in __pgi_uacc_initialize () from /opt/pgi/linux86-64/17.10/lib/libaccg.so\n#4  0x00007f68562b6c05 in acc_get_device_type () from /opt/pgi/linux86-64/17.10/lib/libaccapi.so\n#5  0x00007f6857355a07 in wrap_acc_init () at cbits/acc.c:5\n#6  0x00000000004096cd in ?? ()\n#7  0x0000000000000000 in ?? ()\n</code></pre>\n\n<p>Best regards,\nKiwamu Okabe</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 2, "creation_date": 1524372740, "post_id": 49962583, "comment_id": 86941227, "body": "You haven\u2019t used or matched on <code>n</code> anywhere."}, {"owner": {"reputation": 109, "user_id": 9483263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6b32a3928438fb127d3fda119065bff?s=128&d=identicon&r=PG&f=1", "display_name": "R.N", "link": "https://stackoverflow.com/users/9483263/r-n"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1524372984, "post_id": 49962583, "comment_id": 86941267, "body": "Thanks, you are right. It works now. Thanks a lot!"}, {"owner": {"reputation": 2139, "user_id": 465100, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/debe4d3217980e495cf1f15e7e4b4c9f?s=128&d=identicon&r=PG", "display_name": "Artem Pelenitsyn", "link": "https://stackoverflow.com/users/465100/artem-pelenitsyn"}, "edited": false, "score": 0, "creation_date": 1524379616, "post_id": 49962583, "comment_id": 86942512, "body": "In the last equation for <code>takeElem&#39;</code> I suggest using list constructor <code>:</code> instead of creation of a singleton list <code>[x]</code> and using <code>++</code>."}], "answers": [{"tags": [], "owner": {"reputation": 109, "user_id": 9483263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6b32a3928438fb127d3fda119065bff?s=128&d=identicon&r=PG&f=1", "display_name": "R.N", "link": "https://stackoverflow.com/users/9483263/r-n"}, "is_accepted": false, "score": 2, "last_activity_date": 1524372929, "creation_date": 1524372929, "answer_id": 49962605, "question_id": 49962583, "link": "https://stackoverflow.com/questions/49962583/extracting-elements-from-the-start-of-a-list-in-haskell-without-the-builtin-func/49962605#49962605", "title": "Extracting elements from the start of a list in Haskell without the builtin function", "body": "<p>I didn't add what should happen in the case when n is zero. I just added</p>\n\n<pre><code>takeElem' 0 list = []\n</code></pre>\n\n<p>it works now.</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 7386052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0899ad471e46cce7f5ebc7af5d715175?s=128&d=identicon&r=PG&f=1", "display_name": "PedroCastro", "link": "https://stackoverflow.com/users/7386052/pedrocastro"}, "is_accepted": false, "score": 0, "last_activity_date": 1524389912, "creation_date": 1524389912, "answer_id": 49964526, "question_id": 49962583, "link": "https://stackoverflow.com/questions/49962583/extracting-elements-from-the-start-of-a-list-in-haskell-without-the-builtin-func/49964526#49964526", "title": "Extracting elements from the start of a list in Haskell without the builtin function", "body": "<p>It should be 0 _ instead of _ [].\nBecause you are saying it is [] when you took everything of the list instead of [] when your n reaches 0.</p>\n"}], "owner": {"reputation": 109, "user_id": 9483263, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6b32a3928438fb127d3fda119065bff?s=128&d=identicon&r=PG&f=1", "display_name": "R.N", "link": "https://stackoverflow.com/users/9483263/r-n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1524507785, "creation_date": 1524372650, "question_id": 49962583, "link": "https://stackoverflow.com/questions/49962583/extracting-elements-from-the-start-of-a-list-in-haskell-without-the-builtin-func", "title": "Extracting elements from the start of a list in Haskell without the builtin function", "body": "<p>I want to write a function that extracts n number of elements from the start of a list in Haskell. I know it can be done using the built-in 'take' function and I have done it, which works. However, I can't seem to write a function without take.\nThis is my code.</p>\n\n<pre><code>takeElem' :: Int -&gt; [t] -&gt; [t]\ntakeElem' _ [] = []\ntakeElem' n (x:xs) = [x] ++ takeElem' (n-1) xs\n</code></pre>\n\n<p>This code complies fine but when I test it for example</p>\n\n<pre><code>takeElem' 3 \"hello\"\n</code></pre>\n\n<p>It returns \"hello\" instead of \"hel\"</p>\n\n<p>Any idea what could be wrong?</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1524344194, "post_id": 49960117, "comment_id": 86936779, "body": "Your code doesn&#39;t compile (indentation error)."}, {"owner": {"reputation": 649, "user_id": 2129212, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/p4ojp.png?s=128&g=1", "display_name": "Swapnil B.", "link": "https://stackoverflow.com/users/2129212/swapnil-b"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1524344322, "post_id": 49960117, "comment_id": 86936810, "body": "@melpomene, the code that I tried works fine for one out of two strings. Am I not getting what you are saying?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1524344418, "post_id": 49960117, "comment_id": 86936835, "body": "<code>prog.hs:3:12: error: parse error on input \u2018line2\u2019</code> - <a href=\"https://ideone.com/dLe2de\" rel=\"nofollow noreferrer\">ideone.com/dLe2de</a>"}, {"owner": {"reputation": 649, "user_id": 2129212, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/p4ojp.png?s=128&g=1", "display_name": "Swapnil B.", "link": "https://stackoverflow.com/users/2129212/swapnil-b"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1524345164, "post_id": 49960117, "comment_id": 86937023, "body": "@melpomene fixed the indentation. Thanks for pointing out."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 9, "last_activity_date": 1524344252, "creation_date": 1524344252, "answer_id": 49960154, "question_id": 49960117, "link": "https://stackoverflow.com/questions/49960117/converting-the-do-notation-to-bind-notation/49960154#49960154", "title": "Converting the do notation to bind notation", "body": "<p>You're almost there: you need to use <code>&gt;&gt;</code>.</p>\n\n<pre><code>getLine &gt;&gt;= (\\line1 -&gt; \ngetLine &gt;&gt;= (\\line2 -&gt; \nputStrLn (reverse line2) &gt;&gt;\nputStrLn (reverse line1)\n))\n</code></pre>\n\n<p>Note that <code>&gt;&gt; ...</code> is equivalent to <code>&gt;&gt;= (\\_ -&gt; ...)</code>, so you can also use that if you prefer. </p>\n\n<p>Similarly, your block</p>\n\n<pre><code> do line1 &lt;- getLine\n    line2 &lt;- getLine\n    putStrLn (reverse line2)\n    putStrLn (reverse line1)\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code> do line1 &lt;- getLine\n    line2 &lt;- getLine\n    _ &lt;- putStrLn (reverse line2)\n    putStrLn (reverse line1)\n</code></pre>\n\n<p>Essentially, any entry in the block (but the last one) which has no explicit <code>&lt;-</code> uses <code>&gt;&gt;</code> (or, if you prefer, has an implicit <code>_ &lt;-</code> in front).</p>\n"}, {"comments": [{"owner": {"reputation": 649, "user_id": 2129212, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/p4ojp.png?s=128&g=1", "display_name": "Swapnil B.", "link": "https://stackoverflow.com/users/2129212/swapnil-b"}, "edited": false, "score": 0, "creation_date": 1524344606, "post_id": 49960168, "comment_id": 86936881, "body": "thanks a ton for the quick and correct answer. can you please explain why did we need to use the <b>&gt;&gt;</b> operator?"}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": false, "score": 6, "last_activity_date": 1524344349, "creation_date": 1524344349, "answer_id": 49960168, "question_id": 49960117, "link": "https://stackoverflow.com/questions/49960117/converting-the-do-notation-to-bind-notation/49960168#49960168", "title": "Converting the do notation to bind notation", "body": "<p>Assuming you meant</p>\n\n<pre><code>rev2lines = do\n           line1 &lt;- getLine\n           line2 &lt;- getLine\n           putStrLn (reverse line2)\n           putStrLn (reverse line1)\n</code></pre>\n\n<p>the desugaring looks like</p>\n\n<pre><code>rev2lines =\n           getLine &gt;&gt;= \\line1 -&gt;\n           getLine &gt;&gt;= \\line2 -&gt;\n           putStrLn (reverse line2) &gt;&gt;\n           putStrLn (reverse line1)\n</code></pre>\n\n<p>which parses as</p>\n\n<pre><code>rev2lines =\n    getLine &gt;&gt;= (\n        \\line1 -&gt; getLine &gt;&gt;= (\n            \\line2 -&gt; (putStrLn (reverse line2)) &gt;&gt; (putStrLn (reverse line1))))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 6, "last_activity_date": 1524346516, "last_edit_date": 1524346516, "creation_date": 1524344356, "answer_id": 49960169, "question_id": 49960117, "link": "https://stackoverflow.com/questions/49960117/converting-the-do-notation-to-bind-notation/49960169#49960169", "title": "Converting the do notation to bind notation", "body": "<p>The <code>putStrLn</code> has type <code>IO ()</code>, so we can construct a dummy variable <code>_</code> as a way to obtain the <em>unit type</em> <code>()</code> and so keep processing, so:</p>\n\n<pre><code>rev2lines = getLine &gt;&gt;=\n                (\\line1 -&gt; getLine &gt;&gt;=\n                    (\\line2 -&gt; putStrLn (reverse line2) &gt;&gt;=\n                        (\\_ -&gt; putStrLn (reverse line1))\n                    )\n                )\n</code></pre>\n\n<p>Since the pattern <code>f &gt;&gt;= \\_ -&gt; g</code> occurs quite often, there is the <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Prelude.html#v:-62--62-\" rel=\"nofollow noreferrer\"><strong><code>(&gt;&gt;) :: Monad m =&gt; m a -&gt; m b -&gt; m b</code></strong></a> operator such that <code>f &gt;&gt; g</code> is semantically the same as <code>f &gt;&gt;= (\\_ -&gt; g)</code>, so a shorter form is:</p>\n\n<pre><code>rev2lines = getLine &gt;&gt;=\n                (\\line1 -&gt; getLine &gt;&gt;=\n                    (\\line2 -&gt; putStrLn (reverse line2) &gt;&gt;\n                        (putStrLn (reverse line1))\n                    )\n                )\n</code></pre>\n"}], "owner": {"reputation": 649, "user_id": 2129212, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/p4ojp.png?s=128&g=1", "display_name": "Swapnil B.", "link": "https://stackoverflow.com/users/2129212/swapnil-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 394, "favorite_count": 1, "accepted_answer_id": 49960154, "answer_count": 3, "score": 8, "last_activity_date": 1524346516, "creation_date": 1524343896, "last_edit_date": 1524345129, "question_id": 49960117, "link": "https://stackoverflow.com/questions/49960117/converting-the-do-notation-to-bind-notation", "title": "Converting the do notation to bind notation", "body": "<p>How do I convert the below Haskell do notation to the bind <code>(&gt;&gt;=)</code> notation?</p>\n\n<pre><code>rev2lines :: IO ()\nrev2lines = do line1 &lt;- getLine\n               line2 &lt;- getLine\n               putStrLn (reverse line2)\n               putStrLn (reverse line1)\n</code></pre>\n\n<p>I am a Haskell beginner with decent knowledge and I tried something like</p>\n\n<pre><code>getLine &gt;&gt;= (\\line1 -&gt; getLine &gt;&gt;= (\\line2 -&gt; putStrLn $ reverse(line2)))\n</code></pre>\n\n<p>but I am not able to include the print statement for the other line i.e. line1. Kindly help me to understand this concept properly.</p>\n"}, {"tags": ["haskell", "binary-search"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 5, "creation_date": 1524340141, "post_id": 49959626, "comment_id": 86935592, "body": "The function needs another parameter: one that calculates a value in the middle of two other values"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1524340302, "post_id": 49959626, "comment_id": 86935639, "body": "But there is indeed a package to perform such operations, for example <a href=\"http://hackage.haskell.org/package/binary-search\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/binary-search</a>"}], "owner": {"reputation": 2740, "user_id": 832847, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/8d537be713ae7b9be79f446de62e61f7?s=128&d=identicon&r=PG", "display_name": "Leo Zhang", "link": "https://stackoverflow.com/users/832847/leo-zhang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 122, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1524340005, "creation_date": 1524340005, "question_id": 49959626, "link": "https://stackoverflow.com/questions/49959626/does-haskell-have-a-generic-binary-search-function", "title": "Does Haskell have a generic binary search function?", "body": "<p>I wonder if haskell has a generic binary search function that takes a compare function <code>f</code>, which will return <code>EQ</code> if it finds the value, and a start and end value to search from. <code>f start</code> returns <code>LT</code>, <code>f end</code> returns <code>GT</code>, and <code>f output</code> returns <code>EQ</code>. </p>\n\n<pre><code>binarysearch :: (a -&gt; Ordering) -&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>For example:</p>\n\n<pre><code>binarysearch (\\x -&gt; compare x 100) 1 1000 == 100\n\nbinarysearch (\\x -&gt; compare (x * x) 900) 10 1000 == 30\n</code></pre>\n"}, {"tags": ["haskell", "visual-studio-code"], "answers": [{"tags": [], "owner": {"reputation": 2458, "user_id": 3335966, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gDVU2.png?s=128&g=1", "display_name": "user3335966", "link": "https://stackoverflow.com/users/3335966/user3335966"}, "is_accepted": true, "score": 8, "last_activity_date": 1551265791, "creation_date": 1551265791, "answer_id": 54904120, "question_id": 49959032, "link": "https://stackoverflow.com/questions/49959032/debugging-haskell-in-vs-code/54904120#54904120", "title": "Debugging haskell in VS Code", "body": "<p>As described in repository - <a href=\"https://github.com/phoityne/hdx4vsc\" rel=\"noreferrer\">You can't use <code>STD[IN|OUT]</code> methods</a>;<br>\nSomething like <code>putStrLn</code> will be ignored, but <code>IN</code> methods (<code>getLine</code> for example) just will get stuck;</p>\n\n<p>For functions without <code>STD[IN|OUT]</code> methods You can use <code>F10</code> - select function and send params (for example <code>[1,2,3]</code> for send list or <code>\"str\"</code> for send string):\n<a href=\"https://i.stack.imgur.com/Rd6ai.gif\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/Rd6ai.gif\" alt=\"enter image description here\"></a></p>\n\n<p>With <code>F5</code> You can run previous configuration or configuration from <code>launch.json</code>:</p>\n\n<ul>\n<li><code>mainArgs</code> - params, that You can get with <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/System-Environment.html#v:getArgs\" rel=\"noreferrer\"><code>getArgs</code></a> (cmd params for your programm);</li>\n<li><code>startupFunc</code> - name of the function that will be call first;</li>\n<li><code>startupArgs</code> - params for that first function (for example <code>\"startupArgs\": \"666\"</code> will the same as <code>&lt;F10&gt; -&gt; 666 -&gt; &lt;Enter&gt;</code>)</li>\n<li><code>stopOnEntry</code> - boolean param for enable\\disable breakpoint at the start of the function;</li>\n</ul>\n\n<p>Also, if I understood correctly, <code>F10</code> will rewrite <code>startupFunc</code> and <code>startupArgs</code>;</p>\n\n<p>I'm really new in haskell so I'm confused a little bit when I can get value of constant in debug console, sometimes I have:</p>\n\n<blockquote>\n  <p>[DAP][ERROR] error occurred while runStmt.<br>\n  Variable not in scope: &lt;...></p>\n</blockquote>\n\n<p>Also look like <code>where</code> and <code>let</code> blocks are ignored <code>:D</code><br>\nUse <code>watch</code> panel for better understanding when You can use some constant:</p>\n\n<p><a href=\"https://i.stack.imgur.com/w2ewb.gif\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/w2ewb.gif\" alt=\"enter image description here\"></a></p>\n\n<p>If You want to debug input\\output methods You can use <code>ghci</code> debug commands (<code>:h</code> - <code>Commands for debugging</code> block);</p>\n\n<p>For example, You have a program:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>89| test :: IO ()\n90| test = do\n91|   a &lt;- getLine\n92|   b &lt;- getLine\n93|   putStrLn $ a ++ b\n</code></pre>\n\n<p>Use <code>:break 93</code> to add breakpoint at the 93'th line;<br>\nThen run your program in interpreter: <code>test</code>;<br>\nEnter values. Now You will stop at <code>putStrLn $ a ++ b</code> - if You type <code>a</code> or <code>b</code> in console - You'll get values of these constants;<br>\nThen <code>:step</code> for evaluate <code>++</code> and <code>:step</code> for <code>putStrLn</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/Thw6X.gif\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/Thw6X.gif\" alt=\"enter image description here\"></a></p>\n\n<p>I hope it will be helpful for someone;</p>\n"}], "owner": {"reputation": 179, "user_id": 5783821, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fa642da8c87d1daadf303e0c67f0602b?s=128&d=identicon&r=PG&f=1", "display_name": "user5783821", "link": "https://stackoverflow.com/users/5783821/user5783821"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3494, "favorite_count": 5, "accepted_answer_id": 54904120, "answer_count": 1, "score": 6, "last_activity_date": 1551265791, "creation_date": 1524335734, "question_id": 49959032, "link": "https://stackoverflow.com/questions/49959032/debugging-haskell-in-vs-code", "title": "Debugging haskell in VS Code", "body": "<p>I am trying to debug a simple Haskell application in VS Code with the phoityne-vscode plugin.\nI managed to configure the plugin and run the application - I can see the breakpoints being hit. </p>\n\n<p>The problem is cannot figure out how to interact with the running application. I have a line where I expect user input </p>\n\n<pre><code>do\n  someValue &lt;- getLine\n</code></pre>\n\n<p>Once the debugger reaches this line it stops and I cannot figure out how to pass arguments to the program. I would guess it is somewhere in the <em>Debug Console</em> but it looks like the prompt is only for driving the debugger.</p>\n\n<p>I am sure I am missing something very simple - it's my first attempt at tempering with Haskell and I'm new to VS Code too.</p>\n"}, {"tags": ["list", "haskell", "element"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1524333975, "post_id": 49958725, "comment_id": 86933801, "body": "The very same question was asked a few days ago, (with the same &quot;helper&quot; functions)."}, {"owner": {"reputation": 81, "user_id": 7992697, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o0wuEhAAl4s/AAAAAAAAAAI/AAAAAAAAAD0/g1Cix0JhRM4/photo.jpg?sz=128", "display_name": "hristoforidisc", "link": "https://stackoverflow.com/users/7992697/hristoforidisc"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524334062, "post_id": 49958725, "comment_id": 86933824, "body": "@WillemVanOnsem I guess you are talking for this question. The problem is that this answer only moves the element one position an a time. <a href=\"https://stackoverflow.com/questions/49518370/how-to-move-1-element-of-a-list-to-right-or-left-in-haskell\" title=\"how to move 1 element of a list to right or left in haskell\">stackoverflow.com/questions/49518370/&hellip;</a>"}, {"owner": {"reputation": 4414, "user_id": 5241032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/056c678e99e8253ad280b230ba30a7fb?s=128&d=identicon&r=PG&f=1", "display_name": "cmaher", "link": "https://stackoverflow.com/users/5241032/cmaher"}, "edited": false, "score": 0, "creation_date": 1524334114, "post_id": 49958725, "comment_id": 86933840, "body": "Your <code>checkIfElementIsInList</code> function is perfectly redundant. Check the type signature of <code>elem</code>."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524334201, "post_id": 49958725, "comment_id": 86933871, "body": "No: <a href=\"https://stackoverflow.com/q/49699485/67579\">stackoverflow.com/q/49699485/67579</a>"}, {"owner": {"reputation": 81, "user_id": 7992697, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o0wuEhAAl4s/AAAAAAAAAAI/AAAAAAAAAD0/g1Cix0JhRM4/photo.jpg?sz=128", "display_name": "hristoforidisc", "link": "https://stackoverflow.com/users/7992697/hristoforidisc"}, "reply_to_user": {"reputation": 4414, "user_id": 5241032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/056c678e99e8253ad280b230ba30a7fb?s=128&d=identicon&r=PG&f=1", "display_name": "cmaher", "link": "https://stackoverflow.com/users/5241032/cmaher"}, "edited": false, "score": 0, "creation_date": 1524334216, "post_id": 49958725, "comment_id": 86933877, "body": "@cmaher My problem has also other stuff that I have already solved so I need this function. There is a reason for this. Sorry for not explaining."}, {"owner": {"reputation": 81, "user_id": 7992697, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o0wuEhAAl4s/AAAAAAAAAAI/AAAAAAAAAD0/g1Cix0JhRM4/photo.jpg?sz=128", "display_name": "hristoforidisc", "link": "https://stackoverflow.com/users/7992697/hristoforidisc"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524334316, "post_id": 49958725, "comment_id": 86933919, "body": "@WillemVanOnsem Oh I see. These inputs that are used are the same I have for my assingment. I guess he/she is a teammate from uni. Thank you."}], "owner": {"reputation": 81, "user_id": 7992697, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-o0wuEhAAl4s/AAAAAAAAAAI/AAAAAAAAAD0/g1Cix0JhRM4/photo.jpg?sz=128", "display_name": "hristoforidisc", "link": "https://stackoverflow.com/users/7992697/hristoforidisc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 261, "favorite_count": 0, "closed_date": 1524340767, "answer_count": 0, "score": 0, "last_activity_date": 1524333935, "creation_date": 1524333780, "last_edit_date": 1524333935, "question_id": 49958725, "link": "https://stackoverflow.com/questions/49958725/how-to-move-an-element-inside-a-list-in-haskell", "closed_reason": "Duplicate", "title": "How to move an element inside a list in Haskell?", "body": "<p>I am new to Haskell and I have been trying out some functions. I want to make a function that has as input a list (any kind of elements), an element (same type as the list elements) and an Integer.</p>\n\n<p>So lets say we have the function move.</p>\n\n<pre><code>move :: Eq u =&gt; [u]-&gt;u-&gt;Int-&gt;[u]\n</code></pre>\n\n<p>So here is what I want to do. Everything is about moving the input element inside my list if it is a part of it. The integer input means how many positions left or right I want to move the specific element.</p>\n\n<p>When my Integer is grater than zero (Integer>0) I want the element to move right for as many positions as the Integer. </p>\n\n<p>When my Integer is lesst han zero (Integer&lt;0) I want the element to move leftfor as many positions as the |Integer|.</p>\n\n<p>Now if the Integer is grater than the positions available the element should go to the top or the end of the list. </p>\n\n<p>For example </p>\n\n<p>I have the list <code>[1,2,3,4,5]</code> the element <code>3</code> and the Integer <code>1</code>.</p>\n\n<p>Since <code>1&gt;0</code>, element <code>3</code> moves <code>1</code> position to the right so I have <code>[1,2,4,3,5]</code></p>\n\n<p>I have the list <code>[1,2,3,4,5]</code> the element <code>3</code> and the Integer <code>-1</code>.</p>\n\n<p>Since <code>-1&lt;0</code>, element <code>3</code> moves <code>|-1|=1</code> position to the left so I have <code>[1,3,2,4,5]</code></p>\n\n<p>I have the list <code>[1,2,3,4,5]</code> the element <code>3</code> and the Integer <code>5</code>.</p>\n\n<p>Since 5>0, element 3 moves 5 positions to the right. But to the right I can only move 2 positions. So the element goes to the end of the list an I have [1,2,4,5,3].</p>\n\n<p>I have the list [1,2,3,4,5] the element 3 and the Integer -5.</p>\n\n<p>Since -5&lt;0, element 3 moves |-5|=5 positions to the left. But to the left I can only move 2 positions. So the element goes to the top of the list an I have [3,1,2,4,5].</p>\n\n<p>If my input Integer is 0 I delete the first instance of the input element in the list if there is one. Also I have a function to check if my input element is in the list.</p>\n\n<p>Any ideas? Thank you in advance!</p>\n\n<pre><code>    checkIfElementIsInList :: (Eq u) =&gt; u-&gt;[u] -&gt;Bool\n    checkIfElementIsInList x l \n                        |x`elem` l = True\n                        |otherwise = False\n\n    deleteFirstInstance :: (Eq u) =&gt; u-&gt;[u]-&gt;[u]            \n    deleteFirstInstance _ [] = [] \n    deleteFirstInstance a (b:bc) | a == b    = bc \n                         | otherwise = b : deleteFirstInstance a bc \n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1524326299, "post_id": 49957586, "comment_id": 86931282, "body": "1. ask a question, 2. please copy the error as text in the question, 3. where did you define <code>doubleMe</code>?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524326320, "post_id": 49957586, "comment_id": 86931289, "body": "4. what book? What exactly did you do?"}, {"owner": {"reputation": 7, "user_id": 9152388, "user_type": "registered", "profile_image": "https://graph.facebook.com/306978343039824/picture?type=large", "display_name": "Murphy Ho", "link": "https://stackoverflow.com/users/9152388/murphy-ho"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524326712, "post_id": 49957586, "comment_id": 86931409, "body": "Sorry, this is my first time to ask questions on stackflow. I just refined the  question description. Thanks!"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1524327635, "post_id": 49957586, "comment_id": 86931745, "body": "I think you understand the book the wrong way. It speaks of hypothetical lists and functions to demonstrate the difference between a functional and imperative program."}], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 4, "last_activity_date": 1524327523, "creation_date": 1524327523, "answer_id": 49957774, "question_id": 49957586, "link": "https://stackoverflow.com/questions/49957586/variable-not-in-scope-doubleme-integer-t-haskell/49957774#49957774", "title": "Variable not in scope: doubleMe :: [Integer] -&gt; t (Haskell)", "body": "<p><code>doubleMe</code> isn't a built-in function. The book <em>assumes</em> that you have defined it with something like</p>\n\n<pre><code>doubleMe = fmap (* 2)\n</code></pre>\n\n<p>(that's what \"Say you have ...\" means.)</p>\n\n<p>You haven't defined the function yet, so the interpreter is telling you that <code>doubleMe</code> is not defined.</p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1524327930, "creation_date": 1524327930, "answer_id": 49957832, "question_id": 49957586, "link": "https://stackoverflow.com/questions/49957586/variable-not-in-scope-doubleme-integer-t-haskell/49957832#49957832", "title": "Variable not in scope: doubleMe :: [Integer] -&gt; t (Haskell)", "body": "<p>The book states:</p>\n\n<blockquote>\n  <p>Say you have ...</p>\n</blockquote>\n\n<p>This is in a hypothetical sense: both the list <code>xs</code> and the function <code>doubleMe</code>, do not exist as builtins in Haskell, the book aims to demonstrate that if we had such function, there is an important difference between how a Haskell interpreter will construct a new list (in a lazy manner), and an imperative equivalent would do that (construct three complete lists).</p>\n\n<p>We can define this with:</p>\n\n<pre><code>Prelude&gt; doubleMe = map (2*)\nPrelude&gt; xs = [1,2,3,4,5,6,7,8]\nPrelude&gt; doubleMe xs\n[2,4,6,8,10,12,14,16]\n</code></pre>\n\n<p>So here we define <code>doubleMe</code> as <code>map (2*)</code> such that we multiply all elements. Probably the book explains that in Haskell, if we evaluate this, due to lazyness, we will never fully construct intermediate lists in case we call:</p>\n\n<pre><code> Prelude&gt; doubleMe (doubleMe (doubleMe xs))\n[8,16,24,32,40,48,56,64]\n</code></pre>\n\n<p>Indeed, if we want to obtain the first list, we will evaluate the first item of <code>xs</code>, and each time mutliply it times two until we obtain eight.</p>\n"}], "owner": {"reputation": 7, "user_id": 9152388, "user_type": "registered", "profile_image": "https://graph.facebook.com/306978343039824/picture?type=large", "display_name": "Murphy Ho", "link": "https://stackoverflow.com/users/9152388/murphy-ho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1636, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1524327930, "creation_date": 1524326200, "last_edit_date": 1524327414, "question_id": 49957586, "link": "https://stackoverflow.com/questions/49957586/variable-not-in-scope-doubleme-integer-t-haskell", "title": "Variable not in scope: doubleMe :: [Integer] -&gt; t (Haskell)", "body": "<p><img src=\"https://i.stack.imgur.com/57rjt.png\" alt=\"Picture of the problem\"></p>\n\n<p>I don't know want's the problem with it. I just followed what the book stated. The book of [learn you a Haskell for Great Good] description is below:</p>\n\n<blockquote>\n  <p>Say you have an immutable list of numbers xs = [1,2,3,4,5,6,7,8] and a function doubleMe which multiplies every element by 2 and then returns a new list. If we wanted to multiply our list by 8 in an imperative language and did\n  doubleMe(doubleMe(doubleMe(xs))) , it would probably pass through the list once and make a copy and then return it.</p>\n</blockquote>\n"}, {"tags": ["haskell", "singleton", "dependent-type", "existential-type", "type-level-computation"], "comments": [{"owner": {"reputation": 3128, "user_id": 3040129, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TcwLC.png?s=128&g=1", "display_name": "illabout", "link": "https://stackoverflow.com/users/3040129/illabout"}, "edited": false, "score": 1, "creation_date": 1524393246, "post_id": 49957552, "comment_id": 86945841, "body": "I guess another possibility would be a generalized existential type, as explained in section 3.3 of <a href=\"https://cs.brynmawr.edu/~rae/papers/2018/stitch/stitch.pdf\" rel=\"nofollow noreferrer\">Stitch: The Sound Type-Indexed Type Checker</a>.  I implemented replicate for a generalized existential type <a href=\"https://gist.github.com/cdepillabout/91f6a36f3451e1026bdd01e83c3ba5fb#file-existential-vs-sigma-hs-L97-L108\" rel=\"nofollow noreferrer\">here</a>."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1524423199, "post_id": 49968471, "comment_id": 86955060, "body": "A specialized existential can of course offer two fields as well. <code>data SomeVec a where SV :: SNat n -&gt; Vec n a -&gt; SomeVec a</code>."}], "tags": [], "owner": {"reputation": 121, "user_id": 1567086, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb8dcb363e677eef37dad92aa8a6368b?s=128&d=identicon&r=PG", "display_name": "Ryan Scott", "link": "https://stackoverflow.com/users/1567086/ryan-scott"}, "is_accepted": true, "score": 6, "last_activity_date": 1524416188, "creation_date": 1524416188, "answer_id": 49968471, "question_id": 49957552, "link": "https://stackoverflow.com/questions/49957552/when-to-use-existential-type-vs-dependent-pair-in-haskell/49968471#49968471", "title": "When to use existential type vs. dependent pair in Haskell?", "body": "<blockquote>\n  <ol>\n  <li>When should I use a specialized existential type (like <code>SomeVect</code>) vs. a dependent pair (like <code>Sigma</code>)?</li>\n  </ol>\n</blockquote>\n\n<p>This question is somewhat tricky to answer, because:</p>\n\n<ol>\n<li><code>Sigma</code> is itself a form of specialized existential type.</li>\n<li>There are infinitely many ways to create specialized existential types\u2014<code>SomeVect</code> and <code>Sigma</code> are just two examples of the phenomenon.</li>\n</ol>\n\n<p>Nevertheless, it does feel as if <code>Sigma</code> is subtly different from other ways of encoding existential types in GHC. Let's try and identify what exactly makes it different.</p>\n\n<p>First, let's write out the definition of <code>Sigma</code>, in its full glory:</p>\n\n<pre><code>    data Sigma (s :: Type) :: (s ~&gt; Type) -&gt; Type where\n      (:&amp;:) :: forall s (t :: s ~&gt; Type) (x :: s).\n               Sing x -&gt; Apply t x -&gt; Sigma s t\n</code></pre>\n\n<p>And for comparison, I'll also define a \"typical\" existential type:</p>\n\n<pre><code>    data Ex :: (s -&gt; Type) -&gt; Type where\n      MkEx :: forall s (t :: s -&gt; Type) (x :: s).\n              t x -&gt; Ex t\n</code></pre>\n\n<p>Let's go over the differences between the two:</p>\n\n<ol>\n<li><p><code>Sigma s t</code> has two type arguments, whereas <code>Ex t</code> only has one. This isn't a terribly significant difference, and in fact, you could write <code>Sigma</code> using only one argument:</p>\n\n<pre><code>data Sigma :: (s ~&gt; Type) -&gt; Type where\n  (:&amp;:) :: forall s (t :: s ~&gt; Type) (x :: s).\n           Sing x -&gt; Apply t x -&gt; Sigma t\n</code></pre>\n\n<p>Or <code>Ex</code> using two arguments:</p>\n\n<pre><code>data Ex (s :: Type) :: (s -&gt; Type) -&gt; Type where\n  MkEx :: forall s (t :: s -&gt; Type) (x :: s).\n          t x -&gt; Ex s t\n</code></pre>\n\n<p>The only reason why I opted to use two arguments in <code>Sigma</code> is to more closely match the presentation of dependent pairs in other languages, such as in <a href=\"https://www.idris-lang.org/docs/current/prelude_doc/docs/Builtins.html#Builtins.DPair\" rel=\"noreferrer\">Idris's <code>DPair</code></a>. It also perhaps makes the analogy between <code>Sigma s t</code> and <code>\u2203 (x \u2208 s). t(x)</code> clearer.</p></li>\n<li><p>Much more importantly, the kind of <code>Sigma</code>'s last argument, <code>s ~&gt; Type</code>, is different from the kind of <code>Ex</code>'s argument, <code>s -&gt; Type</code>. In particular, the difference is between the <a href=\"https://hackage.haskell.org/package/singletons-2.4.1/docs/Data-Singletons.html#t:-126--62-\" rel=\"noreferrer\"><code>(~&gt;)</code></a> and <code>(-&gt;)</code> kinds. The latter, <code>(-&gt;)</code> is the familiar function arrow, whereas the former, <code>(~&gt;)</code>, is the kind of defunctionalization symbols in <code>singletons</code>.</p>\n\n<p>What are defunctionalization symbols, and why do they need their own kind? They're explained in section 4.3 of the paper <a href=\"https://cs.brynmawr.edu/%7Erae/papers/2014/promotion/promotion.pdf\" rel=\"noreferrer\"><em>Promoting Functions to Type Families in Haskell</em></a>, but I'll try to give a condensed version here. Essentially, we want to be able to write type families like:</p>\n\n<pre><code>type family Positive (n :: Nat) :: Type where\n  Positive Z     = Void\n  Positive (S _) = ()\n</code></pre>\n\n<p>And be able to use the type <code>Sigma Nat Positive</code>. But this won't work, since you can't partially apply a type family like <code>Positive</code>. Luckily, the defunctionalization trick lets us work around this issue. Using the following definitions:</p>\n\n<pre><code>data TyFun :: Type -&gt; Type -&gt; Type\n\ntype a ~&gt; b = TyFun a b -&gt; Type\ninfixr 0 ~&gt;\n\ntype family Apply (f :: k1 ~&gt; k2) (x :: k1) :: k2\n</code></pre>\n\n<p>We can define a <em>defunctionalization symbol</em> for <code>Positive</code> that lets us partially apply it:</p>\n\n<pre><code>data PositiveSym0 :: Nat ~&gt; Type\ntype instance Apply PositiveSym0 n = Positive n\n</code></pre>\n\n<p>Now, in the type <code>Sigma Nat PositiveSym0</code>, the second field is of type <code>Apply PositiveSym0 x</code>, or just <code>Positive x</code>. Thus, <code>(~&gt;)</code> is in some sense more general than <code>(-&gt;)</code>, since it lets us use <em>more</em> types than <code>(-&gt;)</code> would.</p>\n\n<p>(If it helps, one can think of <code>(~&gt;)</code> as the kind of <em>unmatchable</em> functions, as described in Section 4.2.4 of <a href=\"https://cs.brynmawr.edu/~rae/papers/2016/thesis/eisenberg-thesis.pdf\" rel=\"noreferrer\">Richard Eisenberg's thesis</a>, whereas <code>(-&gt;)</code> is the kind of <em>matchable</em> functions.)</p></li>\n<li><p>While the <code>MkEx</code> constructor only has one field, the <code>(:&amp;:)</code> constructor has an additional field (of type <code>Sing x</code>). There are two reasons for this. One is that storing this extra field is, by definition, part of what makes <code>Sigma</code> a dependent pair, and this allows us to retrieve it by way of the <a href=\"https://hackage.haskell.org/package/singletons-2.4.1/docs/Data-Singletons-Sigma.html#v:projSigma1\" rel=\"noreferrer\"><code>projSigma1</code></a> function. Another reason is that if you took out the <code>Sing x</code> field:</p>\n\n<pre><code>data Sigma (s :: Type) :: (s ~&gt; Type) -&gt; Type where\n  (:&amp;:) :: forall s (t :: s ~&gt; Type) (x :: s).\n           Apply t x -&gt; Sigma s t\n</code></pre>\n\n<p>Then this definition would require <code>AllowAmbiguousTypes</code>, as the <code>x</code> type variable is ambiguous. This might be burdensome, so having an explicit <code>Sing x</code> field avoids this.</p></li>\n</ol>\n\n<hr>\n\n<p>Now that I've finished my long-winded explanation, let me try to actually answer your questions:</p>\n\n<blockquote>\n  <ol>\n  <li>When should I use a specialized existential type (like <code>SomeVect</code>) vs. a dependent pair (like <code>Sigma</code>)?</li>\n  </ol>\n</blockquote>\n\n<p>I think this is ultimately a matter of personal taste. <code>Sigma</code> is nice because it's pretty darn general, but you may find that defining a specialized existential type makes your code easier to understand. (But also see the caveats below.)</p>\n\n<blockquote>\n  <ol start=\"2\">\n  <li>Are there any functions that can only be written with one or the other?</li>\n  </ol>\n</blockquote>\n\n<p>I suppose my earlier <code>Sigma Nat PositiveSym0</code> example would count as something you couldn't do with <code>Ex</code>, since it requires exploiting the <code>(~&gt;)</code> kind. On the other hand, you could just as well define:</p>\n\n<pre><code>data SomePositiveNat :: Type where\n  SPN :: Sing (n :: Nat) -&gt; Positive n -&gt; SomePositiveNat\n</code></pre>\n\n<p>So you'd don't technically need <code>(~&gt;)</code> to do this.</p>\n\n<p>Additionally, I don't know of a way to write a <code>projSigma1</code> equivalent for <code>Ex</code>, since it doesn't store enough information in order to be able to write this.</p>\n\n<p>On the other hand, <code>Sigma s t</code> requires that there be a <code>Sing</code> instance for the kind <code>s</code>, so if there isn't one, <code>Sigma</code> is probably not going to work.</p>\n\n<blockquote>\n  <ol start=\"3\">\n  <li>Are there any functions that are significantly easier to write with one or the other?</li>\n  </ol>\n</blockquote>\n\n<p>You'll have an easier time using <code>Sigma</code> when you have a pressing need to use something with a <code>(~&gt;)</code> kind, since that is where it shines. If your type can get away with just a <code>(-&gt;)</code> kind, it might be more convenient to use a \"typical\" existential type like <code>Ex</code>, because otherwise you have to introduce noise in the form of <a href=\"https://hackage.haskell.org/package/singletons-2.4.1/docs/Data-Singletons.html#t:TyCon\" rel=\"noreferrer\"><code>TyCon</code></a> to lift something of kind <code>s -&gt; Type</code> to <code>s ~&gt; Type</code>.</p>\n\n<p>Also, you might find <code>Sigma</code> easier to work with if being able to retrieve the field of type <code>Sing x</code> conveniently is important.</p>\n"}], "owner": {"reputation": 3128, "user_id": 3040129, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/TcwLC.png?s=128&g=1", "display_name": "illabout", "link": "https://stackoverflow.com/users/3040129/illabout"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 525, "favorite_count": 3, "accepted_answer_id": 49968471, "answer_count": 1, "score": 6, "last_activity_date": 1524416188, "creation_date": 1524325919, "question_id": 49957552, "link": "https://stackoverflow.com/questions/49957552/when-to-use-existential-type-vs-dependent-pair-in-haskell", "title": "When to use existential type vs. dependent pair in Haskell?", "body": "<p>When would one want to use a specialized existential type vs. a dependent pair (also called a dependent sum or sigma type)?</p>\n\n<p>Here is an example.</p>\n\n<p>The following is a length-indexed list and dependently-typed replicate function.  See <a href=\"https://stackoverflow.com/questions/49709113/replicate-function-for-a-length-indexed-list-using-ghc-typelits-and-singletons\">this other question</a> for how to implement <code>replicateVect</code>.  The following is using the <a href=\"https://hackage.haskell.org/package/singletons-2.4.1\" rel=\"noreferrer\"><code>singletons</code></a> library:</p>\n\n<pre><code>data Vect :: Type -&gt; Nat -&gt; Type where\n  VNil :: Vect a 0\n  VCons :: a -&gt; Vect a n -&gt; Vect a (n + 1)\n\nreplicateVect :: forall n a. SNat n -&gt; a -&gt; Vect a n\n</code></pre>\n\n<p>There are (at least) two possible ways to create a replicate function that takes a normal <a href=\"http://hackage.haskell.org/package/base-4.11.1.0/docs/Numeric-Natural.html\" rel=\"noreferrer\"><code>Natural</code></a>, instead of a singleton <a href=\"https://hackage.haskell.org/package/singletons-2.4.1/docs/Data-Singletons-TypeLits.html#t:SNat\" rel=\"noreferrer\"><code>SNat</code></a>.</p>\n\n<p>One way is to create a specialized existential type for <code>Vect</code>.  I call this <code>SomeVect</code>, following the conventions of <code>singletons</code>:</p>\n\n<pre><code>data SomeVect :: Type -&gt; Type where\n  SomeVect :: forall a n. Vect a n -&gt; SomeVect a\n\nreplicateExistentialVect :: forall a. Natural -&gt; a -&gt; SomeVect a\nreplicateExistentialVect nat a =\n  case toSing nat of\n    SomeSing sNat -&gt; SomeVect $ replicateVect sNat a\n</code></pre>\n\n<p>Another way is to use a dependent pair.  This uses the <a href=\"https://hackage.haskell.org/package/singletons-2.4.1/docs/Data-Singletons-Sigma.html\" rel=\"noreferrer\"><code>Sigma</code></a> type from <code>singletons</code>:</p>\n\n<pre><code>replicateSigmaVect :: forall n a. Natural -&gt; a -&gt; Sigma Nat (TyCon (Vect a))\nreplicateSigmaVect nat a =\n  case toSing nat of\n    SomeSing sNat -&gt; sNat :&amp;: replicateVect sNat a\n</code></pre>\n\n<p>These functions looks very similar.  Using <code>replicateExistentialVect</code> and <code>replicteSigmaVect</code> is also very similar:</p>\n\n<pre><code>testReplicateExistentialVect :: IO ()\ntestReplicateExistentialVect =\n  case replicateExistentialVect 3 \"hello\" of\n    SomeVect vect -&gt; print vect\n\ntestReplicateSigmaVect :: IO ()\ntestReplicateSigmaVect =\n  case replicateSigmaVect 3 \"hello\" of\n    _ :&amp;: vect -&gt; print vect\n</code></pre>\n\n<p>The full code can be found <a href=\"https://gist.github.com/cdepillabout/91f6a36f3451e1026bdd01e83c3ba5fb\" rel=\"noreferrer\">here</a>.</p>\n\n<hr>\n\n<p>This brings me to my questions.</p>\n\n<ol>\n<li>When should I use a specialized existential type (like <code>SomeVect</code>) vs. a dependent pair (like <code>Sigma</code>)?</li>\n<li>Are there any functions that can <strong>only</strong> be written with one or the other?</li>\n<li>Are there any functions that are significantly easier to write with one or the other?</li>\n</ol>\n"}, {"tags": ["list", "haskell", "recursion", "io"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1524314600, "post_id": 49955881, "comment_id": 86928116, "body": "<code>f = True</code>. I&#39;m a bit surprised to see such check."}, {"owner": {"reputation": 187, "user_id": 9517321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dc52bd738d15863c94b001d51483099?s=128&d=identicon&r=PG&f=1", "display_name": "Aelin", "link": "https://stackoverflow.com/users/9517321/aelin"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524314972, "post_id": 49955881, "comment_id": 86928212, "body": "@WillemVanOnsem I did a bit of a pseudo code to start with (since I&#39;m kinda stuck), as in &quot;check if f is True here&quot;. Sorry I should&#39;ve explained it."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1524315229, "post_id": 49955881, "comment_id": 86928275, "body": "Well I have the idea that you are quite close to a valid solution. Here you want that <code>f</code> applied with parameter <code>x</code> is <code>True</code>, so I guess with a few hints you can come up with a solution."}, {"owner": {"reputation": 187, "user_id": 9517321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dc52bd738d15863c94b001d51483099?s=128&d=identicon&r=PG&f=1", "display_name": "Aelin", "link": "https://stackoverflow.com/users/9517321/aelin"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524317438, "post_id": 49955881, "comment_id": 86928797, "body": "I changed it to <code>if f x == True</code> and it works, thank you!"}, {"owner": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "edited": false, "score": 0, "creation_date": 1524320772, "post_id": 49955881, "comment_id": 86929629, "body": "<code>a == True</code> has the same value as <code>a</code>"}, {"owner": {"reputation": 28376, "user_id": 5743988, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/IeSSM.jpg?s=128&g=1", "display_name": "4castle", "link": "https://stackoverflow.com/users/5743988/4castle"}, "edited": false, "score": 0, "creation_date": 1524322264, "post_id": 49955881, "comment_id": 86930066, "body": "Using <code>Control.Monad.Loops</code>: <code>unfoldWhileM (not . f) getLine</code>"}], "answers": [{"tags": [], "owner": {"reputation": 829, "user_id": 640078, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/01e5b91ad42c7d309b09d6ae8991a32c?s=128&d=identicon&r=PG", "display_name": "rprospero", "link": "https://stackoverflow.com/users/640078/rprospero"}, "is_accepted": false, "score": 0, "last_activity_date": 1524416495, "creation_date": 1524416495, "answer_id": 49968517, "question_id": 49955881, "link": "https://stackoverflow.com/questions/49955881/haskell-recursive-function-to-read-input-from-user-until-a-condition-and-then-r/49968517#49968517", "title": "Haskell recursive function to read input from user until a condition, and then return the input as list", "body": "<p>I've included a small example below.  You're pretty much at the solution.  The important bit is just remembering how you'd generate a non-monad recusive list, then just putting that in the monad.</p>\n\n<pre><code>collectUntil :: (Monad m) =&gt; m a -&gt; (a -&gt; Bool) -&gt; m [a]\ncollectUntil act f = do\n  x &lt;- act\n  if f x\n    then return []\n    else (x:) &lt;$&gt; collectUntil act f\n\nreadUntil :: (String -&gt; Bool) -&gt; IO [String]\nreadUntil = collectUntil getLine\n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 9517321, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dc52bd738d15863c94b001d51483099?s=128&d=identicon&r=PG&f=1", "display_name": "Aelin", "link": "https://stackoverflow.com/users/9517321/aelin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 503, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1524416495, "creation_date": 1524314506, "last_edit_date": 1524315092, "question_id": 49955881, "link": "https://stackoverflow.com/questions/49955881/haskell-recursive-function-to-read-input-from-user-until-a-condition-and-then-r", "title": "Haskell recursive function to read input from user until a condition, and then return the input as list", "body": "<p>I'm making a function <code>readUntil</code> that reads lines from user. Reading stops when <code>f</code> returns True for a line. Then the lines are returned as a list (the line that returned True is not included in that list). Here's what I have at the moment (some really raw/pseudo code now, excuse me):</p>\n\n<pre><code>readUntil :: (String -&gt; Bool) -&gt; IO [String]\nreadUntil f = fmap reverse (go []) where\n    go xs = do\n    x &lt;- getLine\n    if f = True then return xs\n                else go (x : xs)\n</code></pre>\n\n<p>I would also like to make <code>readUntil</code> recursive (or implement a recursive helper function).</p>\n"}, {"tags": ["haskell", "ghc", "haddock"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1524312227, "post_id": 49955451, "comment_id": 86927472, "body": "So, <i>are</i> you defining <code>Main</code> in those files?"}, {"owner": {"reputation": 7947, "user_id": 997606, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b6117f6630078d6612afa75fb8e5bc9a?s=128&d=identicon&r=PG", "display_name": "Tom Ellis", "link": "https://stackoverflow.com/users/997606/tom-ellis"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 2, "creation_date": 1524313672, "post_id": 49955451, "comment_id": 86927872, "body": "This seems to be a weird restriction on comments.  GHC allows comments between <code>LANGUAGE</code> and <code>module</code> but Haddock doesn&#39;t, except for Haddockized comments."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1524372570, "post_id": 49955451, "comment_id": 86941199, "body": "Urk this is gross. FWIW Haddock in either 8.6 or 8.8 should no longer be duplicating GHC&#39;s compilation work (so small differences like this won&#39;t show up anymore)."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1570658543, "post_id": 49955451, "comment_id": 102986698, "body": "I exactly the same problem (Main is not defined anywhere). Have you find the solution or a workaround ?"}, {"owner": {"reputation": 7947, "user_id": 997606, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b6117f6630078d6612afa75fb8e5bc9a?s=128&d=identicon&r=PG", "display_name": "Tom Ellis", "link": "https://stackoverflow.com/users/997606/tom-ellis"}, "edited": false, "score": 0, "creation_date": 1570710903, "post_id": 49955451, "comment_id": 103004710, "body": "Not that I recall.  I imagine I just removed the comments that were between <code>LANGUAGE</code> and <code>module</code>."}, {"owner": {"reputation": 7947, "user_id": 997606, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b6117f6630078d6612afa75fb8e5bc9a?s=128&d=identicon&r=PG", "display_name": "Tom Ellis", "link": "https://stackoverflow.com/users/997606/tom-ellis"}, "reply_to_user": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1570710927, "post_id": 49955451, "comment_id": 103004729, "body": "@mb14 Have you tried Alec&#39;s suggestion of using GHC 8.6 or 8.8?"}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1570791338, "post_id": 49955451, "comment_id": 103034901, "body": "I tried but it doesn&#39;t solve the problem. However I found that the error was due to Haddock not being able to parse the file correcti (with form example -- | or -- * before the import section). It seems then that Haddock can&#39;t figure out the module name and therefore default it to Main (so Main here is a module name or function or type ...) Fixing those comments worked."}], "owner": {"reputation": 7947, "user_id": 997606, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b6117f6630078d6612afa75fb8e5bc9a?s=128&d=identicon&r=PG", "display_name": "Tom Ellis", "link": "https://stackoverflow.com/users/997606/tom-ellis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 150, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1524311329, "creation_date": 1524311329, "question_id": 49955451, "link": "https://stackoverflow.com/questions/49955451/haddock-fails-because-main-is-defined-in-multiple-files", "title": "haddock fails because &quot;&#39;Main\u2019 is defined in multiple files&quot;", "body": "<pre><code>% ghc --version; cabal --version; haddock --version; cabal haddock\nThe Glorious Glasgow Haskell Compilation System, version 8.0.1\ncabal-install version 2.2.0.0\ncompiled using version 2.2.0.0 of the Cabal library\nHaddock version 2.17.4, (c) Simon Marlow 2006\nPorted to use the GHC API by David Waern 2006-2008\nPreprocessing library for opaleye-0.6.1.0..\nRunning Haddock on library for opaleye-0.6.1.0..\nWarning: The documentation for the following packages are not installed. No\nlinks will be generated to these packages: StateVar-1.1.0.4, ...\n\n&lt;no location info&gt;: error:\n    module \u2018opaleye-0.6.1.0-54np2PrjcDbJYVV9W7uGXD:Main\u2019 is defined in multiple files: src/Opaleye/Operators.hs\n                                                                                       src/Opaleye/Order.hs\n</code></pre>\n\n<p>This appears to <em>not</em> be an instance of <a href=\"https://stackoverflow.com/questions/29276971/cabal-haddock-failing-because-function-is-defined-in-multiple-files\">cabal haddock failing because function is defined in multiple files</a> because I'm not on Mac and <code>cabal haddock --ghc-options=-optP-P</code> does not work.</p>\n"}, {"tags": ["haskell", "io", "monads", "typing"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1524301854, "post_id": 49953848, "comment_id": 86924792, "body": "I think you are using <code>let</code> instead of <code>&lt;-</code> (in a <code>do</code> block). Relevant: <a href=\"https://stackoverflow.com/questions/28624408/equal-vs-left-arrow-symbols-in-haskell\" title=\"equal vs left arrow symbols in haskell\">stackoverflow.com/questions/28624408/&hellip;</a>"}, {"owner": {"reputation": 329, "user_id": 3434305, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/56ca245206e5b80befba7113d5c76bc1?s=128&d=identicon&r=PG&f=1", "display_name": "kubci98", "link": "https://stackoverflow.com/users/3434305/kubci98"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1524302134, "post_id": 49953848, "comment_id": 86924848, "body": "I am not using a do block, nor the &gt;&gt;= notation, that snippet i put here is actually the whole definition. Also, using the do notation gives exactly the same error (plus, as i said, the <code>lns</code> variable is actually typed correctly, it is the foldM result that is wrong)."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1524305634, "post_id": 49954529, "comment_id": 86925744, "body": "I think you don&#39;t understand yet the difference between <code>f (g x)</code> (which is equivalent to <code>let y=g x in f y</code>) and <code>g x &gt;&gt;= f</code>. In IO, the latter runs the IO action <code>g x</code>, takes its result, and passes it to <code>f</code>, running the action returned by <code>f</code>. The former does not run <code>g x</code>, but it passes the whole action to <code>f</code>, which must have type <code>f :: IO something -&gt; ...</code>. In imperative languages, it&#39;s (very roughly) the difference between <code>f(() =&gt; g(x))</code> (the former) and <code>f(g(x))</code> (the latter) -- the former does not run <code>g(x)</code>. Perhaps a monad tutorial could help, here."}], "tags": [], "owner": {"reputation": 329, "user_id": 3434305, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/56ca245206e5b80befba7113d5c76bc1?s=128&d=identicon&r=PG&f=1", "display_name": "kubci98", "link": "https://stackoverflow.com/users/3434305/kubci98"}, "is_accepted": false, "score": 0, "last_activity_date": 1524304681, "creation_date": 1524304681, "answer_id": 49954529, "question_id": 49953848, "link": "https://stackoverflow.com/questions/49953848/haskell-wrong-typing-when-making-an-io-map-out-of-io-strings/49954529#49954529", "title": "Haskell: Wrong typing when making an IO Map out of IO Strings", "body": "<p>Ok, so I have actually managed to fix the code, though I am still not entirely sure where the problem was, so i would be still grateful if someone could point that out.</p>\n\n<p>So, instead of</p>\n\n<pre><code>let lns = liftM lines $ readFile $ getSet $ listF c in\n    foldM (\\m n -&gt; liftM3 Map.insert n n m) (return Map.empty) lns\n</code></pre>\n\n<p>I used</p>\n\n<pre><code>(readFile . getSet $ listF c)\n    &gt;&gt;= (\\tx -&gt; return $ lines tx)\n    &gt;&gt;= (\\lns -&gt; return $ foldl (\\m n -&gt; Map.insert n n m) Map.empty lns)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "is_accepted": true, "score": 2, "last_activity_date": 1524318466, "creation_date": 1524318466, "answer_id": 49956440, "question_id": 49953848, "link": "https://stackoverflow.com/questions/49953848/haskell-wrong-typing-when-making-an-io-map-out-of-io-strings/49956440#49956440", "title": "Haskell: Wrong typing when making an IO Map out of IO Strings", "body": "<p>The signature of <code>foldM</code> is</p>\n\n<pre><code>foldM :: Monad m =&gt; (a -&gt; b -&gt; m a) -&gt; a -&gt; [b] -&gt; m a\n</code></pre>\n\n<p>Let's see what you've got:</p>\n\n<pre><code>return Map.empty :: IO (Map String String)\nlns :: IO [String]\n</code></pre>\n\n<p>That definitely does not match parameters <code>a</code> and <code>[b]</code>. Fixing the former is easy: just use <code>Map.empty</code>. For the latter, you need access to what's inside <code>lns</code>, which is what the bind operator is for:</p>\n\n<pre><code>&gt;&gt;= :: m a -&gt; (a -&gt; m b) -&gt; m b\n</code></pre>\n\n<p>Hence</p>\n\n<pre><code>lns &gt;&gt;= foldM (\u2026) Map.empty\n</code></pre>\n\n<p>But since you operation is pure, you might as well just use <code>fmap</code> and <code>foldl</code></p>\n\n<pre><code>foldl (\u2026) Map.empty &lt;$&gt; lns\n</code></pre>\n"}], "owner": {"reputation": 329, "user_id": 3434305, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/56ca245206e5b80befba7113d5c76bc1?s=128&d=identicon&r=PG&f=1", "display_name": "kubci98", "link": "https://stackoverflow.com/users/3434305/kubci98"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 0, "accepted_answer_id": 49956440, "answer_count": 2, "score": 0, "last_activity_date": 1524318466, "creation_date": 1524299432, "last_edit_date": 1524299794, "question_id": 49953848, "link": "https://stackoverflow.com/questions/49953848/haskell-wrong-typing-when-making-an-io-map-out-of-io-strings", "title": "Haskell: Wrong typing when making an IO Map out of IO Strings", "body": "<p>I have a function with the following signature:</p>\n\n<pre><code>Config -&gt; IO (Map.Map String String)\n</code></pre>\n\n<p>that is used to extract a FilePath from the Config, then load that file (contains lines of text), and then parse the lines into keys and values - which is why I need to save them into map, preferably.</p>\n\n<p>So, I have created the following function:</p>\n\n<pre><code>let lns = liftM lines $ readFile $ getSet $ listF c in\n    foldM (\\m n -&gt; liftM3 Map.insert n n m) (return Map.empty) lns\n</code></pre>\n\n<p>Now, I would hope that Haskell realizes that I want this to be a IO Map of Strings (for simplicity, I dont parse the lines into keys and vals for now, and just put the whole line in there).</p>\n\n<p>However, I get the following errors:</p>\n\n<pre><code>\u2022 Couldn't match type \u2018Map.Map String\u2019 with \u2018IO\u2019\n  Expected type: IO (Map.Map String String)\n    Actual type: Map.Map\n                   String (Map.Map String (Map.Map String String))\n\u2022 In the expression:\n    foldM (\\ m n -&gt; liftM3 Map.insert n n m) (return Map.empty) lns\n  In the expression:\n    let lns = liftM lines $ readFile $ getSet $ listF c\n    in foldM (\\ m n -&gt; liftM3 Map.insert n n m) (return Map.empty) lns\n  In an equation for \u2018getEpisodeNames\u2019:\n      getEpisodeNames c\n        | listF c == NotSet = return Map.empty\n        | otherwise\n        = let lns = liftM lines $ readFile $ getSet $ listF c\n          in foldM (\\ m n -&gt; liftM3 Map.insert n n m) (return Map.empty) lns\n\n\n\u2022 Couldn't match type \u2018[Char]\u2019 with \u2018Map.Map String String\u2019\n  Expected type: Map.Map\n                   String (Map.Map String (Map.Map String String))\n    Actual type: Map.Map String (Map.Map String String)\n\u2022 In the expression: liftM3 Map.insert n n m\n  In the first argument of \u2018foldM\u2019, namely\n    \u2018(\\ m n -&gt; liftM3 Map.insert n n m)\u2019\n  In the expression:\n    foldM (\\ m n -&gt; liftM3 Map.insert n n m) (return Map.empty) lns\n\n\n\u2022 Couldn't match type \u2018[]\u2019 with \u2018Map.Map String\u2019\n  Expected type: IO (Map.Map String String)\n    Actual type: IO [String]\n\u2022 In the third argument of \u2018foldM\u2019, namely \u2018lns\u2019\n  In the expression:\n    foldM (\\ m n -&gt; liftM3 Map.insert n n m) (return Map.empty) lns\n  In the expression:\n    let lns = liftM lines $ readFile $ getSet $ listF c\n    in foldM (\\ m n -&gt; liftM3 Map.insert n n m) (return Map.empty) lns\n</code></pre>\n\n<p>From that, it seems that <code>return Map.empty</code> tries to wrap the Map in something else than IO monad, which honestly does not make sense to me.</p>\n\n<p>As Haskell never makes mistakes, it is clear to me that I have messed up somewhere, I just can't find, where (though I am pretty sure it is in the second line, as I have checked the lns for the correct type using <code>:t</code> in ghci). I also tried rewriting the function to >>= notation instead of let ... in ..., but it didn't help. Thanks for any help.</p>\n"}, {"tags": ["haskell", "types", "aeson"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1524278356, "post_id": 49951664, "comment_id": 86920158, "body": "You misunderstand how Aeson works. Try serializing your data and see what comes out."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1524278609, "post_id": 49951664, "comment_id": 86920199, "body": "The <a href=\"https://hackage.haskell.org/package/aeson-1.3.1.0/docs/Data-Aeson-TH.html#t:SumEncoding\" rel=\"nofollow noreferrer\"><code>Data.Aeson.TH</code> documentation</a> suggests you want <code>sumEncoding = defaultTaggedObject { tagFieldName = &quot;what&quot; }</code> to use your preexisting field as the tag."}, {"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1524296295, "post_id": 49951664, "comment_id": 86923467, "body": "You don&#39;t need the what field in the data declaration. You already have the constructor for that. The different tags options in AESON are only relevant to the JSON itself, not the Haskell structures. So, just remove the what field."}, {"owner": {"reputation": 941, "user_id": 1364783, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4eda80ff284139c0614e80a943d9c307?s=128&d=identicon&r=PG", "display_name": "rausted", "link": "https://stackoverflow.com/users/1364783/rausted"}, "edited": false, "score": 0, "creation_date": 1524503460, "post_id": 49951664, "comment_id": 86989285, "body": "I agree on removing the &quot;what&quot; field from my structures, but what about the last error <code>key &quot;tag&quot; not present</code> even when I add a tag? (see EDIT)"}], "answers": [{"tags": [], "owner": {"reputation": 1894, "user_id": 412417, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/880a205c1958574d83803d5e30da95ca?s=128&d=identicon&r=PG&f=1", "display_name": "MCH", "link": "https://stackoverflow.com/users/412417/mch"}, "is_accepted": false, "score": 3, "last_activity_date": 1526123629, "creation_date": 1526123629, "answer_id": 50305604, "question_id": 49951664, "link": "https://stackoverflow.com/questions/49951664/haskell-aeson-with-sum-types/50305604#50305604", "title": "Haskell Aeson with Sum Types", "body": "<p>If you have control over the structure of the JSON, meaning you are not trying to match an existing JSON, I would use the generic instances of <code>ToJSON</code> and <code>FromJSON</code>. However, this means you cannot have a selector that means <code>tag</code>. The generic and Template Haskell instances reserve the keyword <code>tag</code> for the constructors of sum types, because different constructors could have the similarly named selectors (this is the case for your example, or they could have unnamed selectors that hold similar types like <code>data Wrapper = A Int | B Int</code>.</p>\n\n<pre><code>{-# LANGUAGE DeriveGeneric #-}\n\nimport Data.Aeson\nimport GHC.Generics\n\n-- I added these so it would compile\ntype Arg = String\ntype Fixitem = String\ntype Typ = String\ntype Constructor = String\n\ndata Declaration \n  = IndDecl \n    { what :: String\n    , name :: String\n    , argnames :: Maybe [String]\n    , constructors :: [Constructor] \n    }\n  | TypeDecl \n    { what :: String\n    , name :: String\n    , argnames :: Maybe [String]\n    , value :: Maybe Arg \n    }\n  | FixDecl \n    { what :: String\n    , fixlist :: Maybe [Fixitem]\n    }\n  | TermDecl \n    { what :: String\n    , name :: String\n    , typ :: Maybe Typ\n    , value :: Maybe Arg \n    }\n  deriving (Show, Eq, Generic)\n\ninstance ToJSON Declaration\ninstance FromJSON Declaration\n</code></pre>\n\n<p>Now we can convert a Haskell value to JSON:</p>\n\n<pre><code>\u03bb&gt; encode $ IndDecl \"a\" \"b\" (Just [\"c\", \"d\"]) [\"e\"]\n\"{\\\"tag\\\":\\\"IndDecl\\\",\\\"what\\\":\\\"a\\\",\\\"argnames\\\":[\\\"c\\\",\\\"d\\\"],\\\"constructors\\\":[\\\"e\\\"],\\\"name\\\":\\\"b\\\"}\"\n</code></pre>\n\n<p>And we can also convert a JSON string back to value of the <code>Declaration</code> type.</p>\n\n<pre><code>\u03bb&gt; decode $ \"{\\\"tag\\\":\\\"FixDecl\\\",\\\"what\\\":\\\"a\\\"}\" :: (Maybe Declaration)\nJust (FixDecl {what = \"a\", fixlist = Nothing})\n\n\u03bb&gt; decode $ \"{\\\"tag\\\":\\\"TermDecl\\\",\\\"what\\\":\\\"a\\\",\\\"name\\\":\\\"c\\\",\\\"typ\\\":\\\"e\\\",\\\"value\\\":\\\"b\\\"}\" :: (Maybe Declaration)\nJust (TermDecl {what = \"a\", name = \"c\", typ = Just \"e\", value = Just \"b\"})\n</code></pre>\n"}], "owner": {"reputation": 941, "user_id": 1364783, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4eda80ff284139c0614e80a943d9c307?s=128&d=identicon&r=PG", "display_name": "rausted", "link": "https://stackoverflow.com/users/1364783/rausted"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1147, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1526123629, "creation_date": 1524275895, "last_edit_date": 1524278071, "question_id": 49951664, "link": "https://stackoverflow.com/questions/49951664/haskell-aeson-with-sum-types", "title": "Haskell Aeson with Sum Types", "body": "<p>I have a sum data type that looks like this:</p>\n\n<pre><code>data Declaration =\n    IndDecl { what :: String, name :: String, argnames :: Maybe [String], constructors :: [Constructor] }\n    | TypeDecl { what :: String, name :: String, argnames :: Maybe [String], value :: Maybe Arg }\n    | FixDecl { what :: String, fixlist :: Maybe [Fixitem] }\n    | TermDecl { what :: String, name :: String, typ :: Maybe Typ, value :: Maybe Arg }\n    deriving (Show, Eq)\n</code></pre>\n\n<p>And I'm deriving the JSON serializer/deserializer using <code>Data.Aeson.TH</code> with the following options:</p>\n\n<pre><code>$(deriveJSON defaultOptions { sumEncoding = UntaggedValue } ''Declaration)\n</code></pre>\n\n<p>That removes the tag from the JSON construction. At the same time, I think my data already has a tag, which is the <code>what</code> field. It can be one of the following:</p>\n\n<pre><code>IndDecl : \"decl:ind\" \nFixDecl : \"decl:fix\"\n</code></pre>\n\n<p>etc. So the fact that I'm using an Untagged configuration for my JSON deserialized objects is kind of worrisome. How can I make Aeson derive JSON stubs based on the tags that my data already has? </p>\n\n<p>Or maybe it's a better idea to remove the <code>what</code> field and let Aeson add a \"tag\" field which describes the constructor?</p>\n\n<p>EDIT: I tried the latter, by adding a tag field. Now it looks like:</p>\n\n<pre><code>-- Declarations\ndata Declaration =\n    IndDecl { what :: String, tag :: String, name :: String, argnames :: Maybe [String], constructors :: [Constructor] }\n    | TypeDecl { what :: String, tag :: String, name :: String, argnames :: Maybe [String], value :: Maybe Arg }\n    | FixDecl { what :: String, tag :: String, fixlist :: Maybe [Fixitem] }\n    | TermDecl { what :: String, tag :: String, name :: String, typ :: Maybe Typ, value :: Maybe Arg }\n    deriving (Show, Eq)\n</code></pre>\n\n<p>However, I get the following error:</p>\n\n<blockquote>\n  <p>Error in $.declarations[0]: key \"tag\" not present</p>\n</blockquote>\n\n<p>Which I don't understand, since I created a \"tag\" field.</p>\n"}, {"tags": ["haskell", "recursion", "binary-tree", "huffman-code"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1524273415, "post_id": 49951370, "comment_id": 86919423, "body": "Your algorithm description doesn&#39;t match annotations in the picture, which doesn&#39;t match the bit representation under it. Something is amiss."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1524301991, "post_id": 49951370, "comment_id": 86924817, "body": "<a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> ________"}, {"owner": {"reputation": 195, "user_id": 3423191, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a243e75c08c65be2998b7ecd69abdfb6?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/3423191/ben"}, "edited": false, "score": 0, "creation_date": 1524310463, "post_id": 49951370, "comment_id": 86927010, "body": "Sorry I took the picture from the net. I should have erased the 0 and 1 on the branches (they are used for encoding phase). I admit it&#39;s confusing"}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1524414437, "post_id": 49951370, "comment_id": 86952009, "body": "This seems quite similar to <a href=\"https://stackoverflow.com/q/47763477/5684257\">this question</a> but with bits instead of characters."}], "answers": [{"comments": [{"owner": {"reputation": 195, "user_id": 3423191, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a243e75c08c65be2998b7ecd69abdfb6?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/3423191/ben"}, "edited": false, "score": 0, "creation_date": 1524309719, "post_id": 49953486, "comment_id": 86926806, "body": "Oh thanks that&#39;s exactly what I needed: to understand the methodology behind. It&#39;s easier for me to have a function returning the bits left. I realize it is the functional equivalent of maintaining a pointer to the last bit read we would have done in an imperative paradigm. Have a nice day"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 195, "user_id": 3423191, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a243e75c08c65be2998b7ecd69abdfb6?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/3423191/ben"}, "edited": false, "score": 0, "creation_date": 1524318528, "post_id": 49953486, "comment_id": 86929035, "body": "@Ben Yes, that&#39;s a close analogy. More in general, an imperative function which returns type <code>A</code>, while modifying (through assignment / mutation) an external variable <code>B</code>, is often rendered using a state monad, i.e. using a type like <code>B -&gt; (A,B)</code>. This, in a sense, reads the old <code>B</code> and produces a new one, along with the result <code>A</code>. The state monad is only a small library around this to make it more convenient for the programmer."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1524318312, "last_edit_date": 1524318312, "creation_date": 1524296171, "answer_id": 49953486, "question_id": 49951370, "link": "https://stackoverflow.com/questions/49951370/haskell-rebuild-binary-tree-from-its-bits-representation/49953486#49953486", "title": "Haskell: rebuild binary tree from its bits representation", "body": "<p>You need to write a parser, using a type suitable for recursion.</p>\n\n<p>At the top level you indeed want <code>[Bit] -&gt; HTree a</code> (probably restricting <code>a</code> to some type class, but I'll neglect this). However, for enabling recursion you need</p>\n\n<pre><code>parser :: [Bit] -&gt; (HTree a, [Bit])\n-- or, if you need to handle failure\nparser :: [Bit] -&gt; Maybe (HTree a, [Bit])\n</code></pre>\n\n<p>The idea is that <code>parser</code> is fed with the bits to be parsed. \nIt then tries to parse the <em>first</em> tree which is represented in the <em>prefix</em> of those bits. If it succeeds, it returns an <code>HTree a</code> and a list of the exceeding (non consumed) bits.</p>\n\n<p>Returning the non consumed bits is crucial for <code>Branch</code> where you need to parse two subtrees. You parse the first one, take the non consumed bits, and then use those to start the parser of the right subtree.</p>\n\n<p>This topic is too broad for a SO answer, but if you google for \"Haskell parser monad\" you should find plenty of examples.</p>\n"}], "owner": {"reputation": 195, "user_id": 3423191, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/a243e75c08c65be2998b7ecd69abdfb6?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/3423191/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 264, "favorite_count": 0, "accepted_answer_id": 49953486, "answer_count": 1, "score": 0, "last_activity_date": 1524318312, "creation_date": 1524272159, "question_id": 49951370, "link": "https://stackoverflow.com/questions/49951370/haskell-rebuild-binary-tree-from-its-bits-representation", "title": "Haskell: rebuild binary tree from its bits representation", "body": "<p>I'm rewriting the Huffman coding algorithm as a Haskell rookie exercise and I'm struggling a bit reforming the tree I serialized using the following technique:<br>\n- Walk the tree from root in depth-first preorder<br>\n- Encounter a Node put 0 followed by recurse on left then right childs<br>\n- Encounter a Leaf put 1 followed by the symbol byte</p>\n\n<p>My serialization code:</p>\n\n<pre><code>serializeHtree :: (Ord a) =&gt; CodeDict a -&gt; HTree a -&gt; [Bit]\nserializeHtree dict (Leaf a) = I : (myLpad $ dict M.! a)\nserializeHtree dict (Branch l r) = O : (serializeHtree dict r ++ serializeHtree dict l)\n</code></pre>\n\n<p>Where:<br>\n- CodeDict is a Map from a to [Bit]<br>\n- myLpad fill the variable-length huffman code with 0 to make it fixed-length<br>\n- and Bit is my own datatype constructed by O and I  </p>\n\n<p>For example,<br>\n<a href=\"https://i.stack.imgur.com/5SBtI.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5SBtI.png\" alt=\"Huffman tree\"></a>  </p>\n\n<p>The tree above will be represented as:<br>\n 01<strong>00000000</strong>001<strong>00000100</strong>1<strong>00000101</strong>01<strong>00000110</strong>1<strong>00000111</strong></p>\n\n<p>Now to deserialize it, I know I have to read the stream bit per bit and:<br>\n- Encounter a 1 make a Leaf with the next byte<br>\n- Encounter a 0 make a branch recursing on left then right subtrees </p>\n\n<p>But I'm failing in my approach, here is my deserialization code (non functional this time):  </p>\n\n<pre><code>deserializeHtree :: [Bit] -&gt; HTree a\ndeserializeHtree (x:xs) = case x of\n    'O' -&gt; Branch (deserializeHtree xs) (deserializeHtree xs)\n    'I' -&gt; Leaf (head xs)  \n</code></pre>\n\n<p>Thanks for support</p>\n"}, {"tags": ["javascript", "bash", "haskell", "pandoc", "prismjs"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 1, "creation_date": 1524262575, "post_id": 49950240, "comment_id": 86917460, "body": "Can&#39;t you just <code>sed &#39;&#47;s&#47;class=&quot;php&quot;&#47;class=&quot;language-php&quot;&#47;&#39;</code> ?"}, {"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 0, "creation_date": 1524392375, "post_id": 49950240, "comment_id": 86945615, "body": "using a <a href=\"https://pandoc.org/filters.html\" rel=\"nofollow noreferrer\">pandoc filter</a> would be much more robust than <code>sed</code>..."}, {"owner": {"reputation": 1132, "user_id": 4541434, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c01ee7f3a87a4d738ff35a92d34e1503?s=128&d=identicon&r=PG", "display_name": "Tania Rascia", "link": "https://stackoverflow.com/users/4541434/tania-rascia"}, "edited": false, "score": 0, "creation_date": 1524448259, "post_id": 49950240, "comment_id": 86960806, "body": "That will be very useful, thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 1132, "user_id": 4541434, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c01ee7f3a87a4d738ff35a92d34e1503?s=128&d=identicon&r=PG", "display_name": "Tania Rascia", "link": "https://stackoverflow.com/users/4541434/tania-rascia"}, "edited": false, "score": 0, "creation_date": 1524362810, "post_id": 49959541, "comment_id": 86939983, "body": "Absolutely amazing! Thank you so much, this works perfectly!"}], "tags": [], "owner": {"reputation": 1327, "user_id": 1110636, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/709ba1cdc862cffcbab3c518209e634d?s=128&d=identicon&r=PG", "display_name": "Timir", "link": "https://stackoverflow.com/users/1110636/timir"}, "is_accepted": true, "score": 1, "last_activity_date": 1524339337, "creation_date": 1524339337, "answer_id": 49959541, "question_id": 49950240, "link": "https://stackoverflow.com/questions/49950240/output-semantic-code-blocks-with-prism/49959541#49959541", "title": "Output semantic code blocks with Prism", "body": "<p>I'm for using sed as well, but as a pre-processor. You could write a script like the one below, and name it <code>pre-process</code>:</p>\n\n<pre><code>#!/bin/bash -e\n\nderived_dir=derived\nrm -fr ${derived_dir} &amp;&amp; mkdir -p ${derived_dir}\nfor file in $*\ndo\n    cat ${file} | sed 's/```php/```language-php/g' &gt; ${derived_dir}/$(basename ${file})\ndone\necho \"${derived_dir}/*\"\n</code></pre>\n\n<p>Then you could use <code>```php</code> in your source, and produce html via:</p>\n\n<p><code>pandoc assets/metadata.yaml $(pre-process chapters/*.md) -s --toc --no-highlight  --css ../assets/style.css -A assets/template/footer.html -o build/book.html</code></p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 1132, "user_id": 4541434, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c01ee7f3a87a4d738ff35a92d34e1503?s=128&d=identicon&r=PG", "display_name": "Tania Rascia", "link": "https://stackoverflow.com/users/4541434/tania-rascia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 0, "accepted_answer_id": 49959541, "answer_count": 1, "score": 2, "last_activity_date": 1524380469, "creation_date": 1524261387, "last_edit_date": 1524380469, "question_id": 49950240, "link": "https://stackoverflow.com/questions/49950240/output-semantic-code-blocks-with-prism", "title": "Output semantic code blocks with Prism", "body": "<p>I'm inputting markdown data and outputting HTML files with Pandoc. Using the <code>--no-highlight</code> flag, I can get the syntax to output without the built-in basic syntax highlighting, and use Prism.js to highlight the code instead, which is much more robust.</p>\n\n<p>However, Prism requires that the <code>code</code> or <code>pre</code> have <code>language-*</code> in the class name. Using php as an example, Pandoc outputs <code>&lt;pre class=\"php\"&gt;</code>. I've managed to hack it to work by using:</p>\n\n<pre><code>```language-php\n</code></pre>\n\n<p>As the start of each code block. However, when I want to export the same code as an EPUB, it won't recognize the language to be able to use the built in syntax highlighting.</p>\n\n<p>Here are the commands I use for EPUB and HTML output:</p>\n\n<pre><code># epub output\npandoc assets/metadata.yaml chapters/*.md -o build/book.epub\n\n# html output\npandoc assets/metadata.yaml chapters/*.md -s --toc --no-highlight  --css ../assets/style.css -A assets/template/footer.html -o build/book.html\n</code></pre>\n\n<p>My issue:</p>\n\n<p>I want to be able to write</p>\n\n<pre><code>```php\n</code></pre>\n\n<p>As the start of my code blocks, instead of</p>\n\n<pre><code>```language-php\n</code></pre>\n\n<p>So both Prism.js and the built-in syntax highlighter will work, with my EPUB and HTML generation.</p>\n\n<p>If I could get Pandoc to interpret \"```php\" as <code>class=\"language-php\"</code>, this would solve the issue.</p>\n\n<p><a href=\"https://github.com/jgm/pandoc/issues/3858\" rel=\"nofollow noreferrer\">Here is a link</a> on the Pandoc GitHub for someone else with the same issue I'm trying to solve.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1524257707, "post_id": 49949580, "comment_id": 86915753, "body": "By declaring it <code>Foldable</code>, and then apply a <code>fold</code> on it."}, {"owner": {"reputation": 1283, "user_id": 3897333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d784367ca82572dea0a2c43217770b?s=128&d=identicon&r=PG", "display_name": "Paul Stelian", "link": "https://stackoverflow.com/users/3897333/paul-stelian"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524257761, "post_id": 49949580, "comment_id": 86915783, "body": "The thing is the real data structure isn&#39;t exactly like this but slightly more complicated (more similar to <code>(Object s (Maybe (a, Object)))</code>). Won&#39;t Foldable force me to implement fold myself, and thus make me do explicit recursion?"}, {"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 4, "creation_date": 1524258066, "post_id": 49949580, "comment_id": 86915901, "body": "<i>Why</i> are you avoiding explicit recursion to process a recursive data structure? Explicit tail recursion is not going to blow your RAM usage, afaict. What is the real problem you&#39;re solving?"}, {"owner": {"reputation": 1283, "user_id": 3897333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d784367ca82572dea0a2c43217770b?s=128&d=identicon&r=PG", "display_name": "Paul Stelian", "link": "https://stackoverflow.com/users/3897333/paul-stelian"}, "edited": false, "score": 0, "creation_date": 1524258169, "post_id": 49949580, "comment_id": 86915947, "body": "Well I&#39;m actually requested to avoid recursion for homework. I hope I don&#39;t have to change my current structure to a separate one."}, {"owner": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 0, "creation_date": 1524258312, "post_id": 49949580, "comment_id": 86916015, "body": "A trick solution could be redefining <code>show</code> for it so that it outputs a string that could be then <code>read</code> back as a plain list."}, {"owner": {"reputation": 1283, "user_id": 3897333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d784367ca82572dea0a2c43217770b?s=128&d=identicon&r=PG", "display_name": "Paul Stelian", "link": "https://stackoverflow.com/users/3897333/paul-stelian"}, "edited": false, "score": 0, "creation_date": 1524258395, "post_id": 49949580, "comment_id": 86916050, "body": "Trouble again as <code>show</code> itself would become recursive and the points would still be deducted. I guess I may ask my teacher for this or submit it with the recursive variant."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 5, "creation_date": 1524258931, "post_id": 49949580, "comment_id": 86916256, "body": "Recursion is really the only means of iteration in Haskell. Even if it&#39;s buried deep down in folds and binds, it&#39;s still recursion. I would guess that what your homework probably means is hiding recursion somewhere outside your own code. I mean, you could always imitate an imperative list accumulation approach in a <code>State</code> monad."}, {"owner": {"reputation": 1283, "user_id": 3897333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d784367ca82572dea0a2c43217770b?s=128&d=identicon&r=PG", "display_name": "Paul Stelian", "link": "https://stackoverflow.com/users/3897333/paul-stelian"}, "edited": false, "score": 0, "creation_date": 1524259155, "post_id": 49949580, "comment_id": 86916343, "body": "I think I could use unfoldr really. So I just need to understand how that works"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 36902, "user_id": 223424, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e97c628a88337b15e76a4690e916a2cd?s=128&d=identicon&r=PG", "display_name": "9000", "link": "https://stackoverflow.com/users/223424/9000"}, "edited": false, "score": 2, "creation_date": 1524296879, "post_id": 49949580, "comment_id": 86923624, "body": "@9000 Quite the opposite: in Haskell, tail recursion on a lazy data structure is indeed going to blow the RAM usage. Using instead <code>convert (Cons x xs) = x : convert xs</code>, without tail recursion, will proceed just fine, in a &quot;streaming&quot; fashion."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1524299608, "post_id": 49949580, "comment_id": 86924289, "body": "^^^ a.k.a. &quot;guarded recursion&quot;, with recursion being &quot;guarded&quot; by a lazy data constructor such as <code>(:)</code>."}, {"owner": {"reputation": 1283, "user_id": 3897333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d784367ca82572dea0a2c43217770b?s=128&d=identicon&r=PG", "display_name": "Paul Stelian", "link": "https://stackoverflow.com/users/3897333/paul-stelian"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1524323597, "post_id": 49949580, "comment_id": 86930462, "body": "@chi Thankfully for my use case the RAM usage doesn&#39;t blow up since the list has much less than 100 elements."}], "answers": [{"comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1524261194, "post_id": 49950039, "comment_id": 86917087, "body": "Yes there will definitely be recursion <i>somewhere</i>, since both <code>ConsList</code> and <code>[]</code> are recursive data structures."}, {"owner": {"reputation": 1283, "user_id": 3897333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d784367ca82572dea0a2c43217770b?s=128&d=identicon&r=PG", "display_name": "Paul Stelian", "link": "https://stackoverflow.com/users/3897333/paul-stelian"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1524261293, "post_id": 49950039, "comment_id": 86917127, "body": "Of course. I did want to point out that only the explicit recursion is removed."}], "tags": [], "owner": {"reputation": 1283, "user_id": 3897333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d784367ca82572dea0a2c43217770b?s=128&d=identicon&r=PG", "display_name": "Paul Stelian", "link": "https://stackoverflow.com/users/3897333/paul-stelian"}, "is_accepted": false, "score": 3, "last_activity_date": 1524261265, "last_edit_date": 1524261265, "creation_date": 1524260137, "answer_id": 49950039, "question_id": 49949580, "link": "https://stackoverflow.com/questions/49949580/how-can-i-convert-a-cons-list-to-a-haskell-list-without-explicit-recursion/49950039#49950039", "title": "How can I convert a Cons list to a Haskell list without (explicit) recursion?", "body": "<p>I found the solution for simple data structures is to simply derive Foldable. Apparently though it didn't seem to work even for this structure, let alone the more complicated one I actually needed.</p>\n\n<p>There is a function <code>unfoldr</code>. Its type signature is:</p>\n\n<pre><code>unfoldr :: (b -&gt; Maybe (a, b)) -&gt; b -&gt; [a]\n</code></pre>\n\n<p>Essentially it takes a function which produces the next element of the list and the remainder.</p>\n\n<p>We would call it like:</p>\n\n<pre><code>unfoldr unwrapElem l\n</code></pre>\n\n<p>and <code>unwrapElem</code> itself is defined such as:</p>\n\n<pre><code>unwrapElem :: (ConsList e) -&gt; Maybe (e, ConsList e)\nunwrapElem Nil = Nothing\nunwrapElem (Cons el rem) = Just (el,rem)\n</code></pre>\n\n<p>One thing to notice is that there still is recursion, however it is implicit now (within <code>unfoldr</code> itself)</p>\n"}], "owner": {"reputation": 1283, "user_id": 3897333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51d784367ca82572dea0a2c43217770b?s=128&d=identicon&r=PG", "display_name": "Paul Stelian", "link": "https://stackoverflow.com/users/3897333/paul-stelian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 412, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1524274770, "creation_date": 1524257621, "last_edit_date": 1524274770, "question_id": 49949580, "link": "https://stackoverflow.com/questions/49949580/how-can-i-convert-a-cons-list-to-a-haskell-list-without-explicit-recursion", "title": "How can I convert a Cons list to a Haskell list without (explicit) recursion?", "body": "<p>I have the following type: <code>data ConsList elem = Nil | Cons elem (ConsList elem)</code></p>\n\n<p>How can I convert a list of this form into a Haskell list, with the conversion not being recursive?</p>\n\n<p>That is, I want <code>(Cons 3 (Cons 5 (Cons 7 Nil)))</code> to convert to <code>[3,5,7]</code>, or to <code>(3:(5:(7:[])))</code> if you wish, and that without actually using a recursive function.</p>\n\n<p>I don't think using fold is okay since this type doesn't actually have it overloaded and I don't see how I could overload fold without actually having explicit recursion.</p>\n"}, {"tags": ["haskell", "locale", "gitlab-ci", "pandoc", "hakyll"], "comments": [{"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1524334591, "post_id": 49947462, "comment_id": 86934002, "body": "You should try the <a href=\"https://groups.google.com/forum/#!forum/hakyll\" rel=\"nofollow noreferrer\">Hakyll google group</a> if you don&#39;t get an answer here."}, {"owner": {"reputation": 25733, "user_id": 1615903, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KQ5iT.png?s=128&g=1", "display_name": "1615903", "link": "https://stackoverflow.com/users/1615903/1615903"}, "edited": false, "score": 0, "creation_date": 1524463001, "post_id": 49947462, "comment_id": 86964336, "body": "The error message suggests that en_CA locale is not available - you might need to generate it first: <code>locale-gen en_CA</code>"}], "owner": {"reputation": 7230, "user_id": 788337, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/wiVpx.png?s=128&g=1", "display_name": "jmite", "link": "https://stackoverflow.com/users/788337/jmite"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 175, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1524247655, "creation_date": 1524247655, "question_id": 49947462, "link": "https://stackoverflow.com/questions/49947462/pandoc-cant-get-locale-encoding-right-with-hakyll-and-gitlab-ci", "title": "Pandoc can&#39;t get Locale/Encoding right with Hakyll and Gitlab CI", "body": "<p>I'm trying to use Gitlab Pages to automatically deploy my Hakyll blog, but I keep having problems with file encoding.</p>\n\n<p>When building the pages, I get the following error:</p>\n\n<pre><code>[ERROR] /builds/jmite/hakyll/.stack/snapshots/x86_64-linux/lts-8.14/8.0.2/share/x86_64-linux-ghc-8.0.2/pandoc-citeproc-0.10.4.1/locales/locales-C-.xml: openBinaryFile: does not exist (No such file or directory)\n</code></pre>\n\n<p>My <code>.gitlab-ci.yaml</code> looks like this:</p>\n\n<pre><code>image: fpco/stack-build:lts-8.14\n\n\nbefore_script:\n  - LC_ALL=en_CA.UTF-8\n  - LANG=en_CA.UTF-8\n  - apt-get update &amp;&amp; apt-get install xz-utils make\n  - export STACK_ROOT=`pwd`/.stack\n  - stack setup\n  - stack install --only-dependencies\n  - stack build\n\nbuild:\n  cache:\n    paths:\n      - _cache\n      - .stack\n  script:\n    - stack exec site build\n  except:\n    - master\n\npages:\n  cache:\n    paths:\n      - _cache\n      - .stack\n  script:\n    - stack exec site build\n  artifacts:\n    paths:\n      - public\n  only:\n    - master\n</code></pre>\n\n<p>I've tried adding locale information to my config:</p>\n\n<pre><code>  - LC_ALL=en_CA.UTF-8\n  - LANG=en_CA.UTF-8\n</code></pre>\n\n<p>But then I get the following error:</p>\n\n<pre><code>/bin/bash: warning: setlocale: LC_ALL: cannot change locale (en_CA.UTF-8)\n[ERROR] ./templates/default.html: hGetContents: invalid argument (invalid byte sequence)\n</code></pre>\n\n<p>How can I fix this? Is there a way to (1) change the encoding on mo local machine, and push to GitLab, so that the files will match whatever Pandoc is expecting, or (2) to configure the GitLab CI to work with them how they're encoded now?</p>\n\n<p>When I open the files in vscode it says they are UTF-8. Are there ways to get more information about the encoding that might be causing problems?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 3, "creation_date": 1524243505, "post_id": 49946389, "comment_id": 86909385, "body": "Wait, so does each <code>FilterType</code> have the same parameters (that&#39;s the way your data types are structured)?  I&#39;m not really sure what the pattern is that you would like to abstract away, partially because this code is not valid.  Can you write some <i>working</i> code with a small number of <code>FilterType</code>s?  (This can be a good place to start, and clarify with yourself exactly what you need.)"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1524243720, "post_id": 49946389, "comment_id": 86909500, "body": "I assume you want to do something like <code>mkFilterParams reportId filterId = case filterId of ...</code> or <code>mkFilterParams reportId = go where go ...</code> or (with LambdaCase) <code>mkFilterParams reportId = \\case ...</code>"}, {"owner": {"reputation": 37, "user_id": 8678276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7749277831353da6c548be887745c0d6?s=128&d=identicon&r=PG&f=1", "display_name": "jek339", "link": "https://stackoverflow.com/users/8678276/jek339"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1524245551, "post_id": 49946389, "comment_id": 86910425, "body": "@luqui Aside from a typo, what is invalid about this? It does work."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 3, "last_activity_date": 1524245031, "creation_date": 1524245031, "answer_id": 49946848, "question_id": 49946389, "link": "https://stackoverflow.com/questions/49946389/making-a-scalable-setter/49946848#49946848", "title": "Making a scalable setter", "body": "<p>How about something like this?</p>\n\n<pre><code>data FilterType = OwnerT | ProductT | ReportProductT\ndata Filter\n    = Owner Id\n    | Product ProductType\n    | ReportProduct ReportType ProductType\n\nmkFilter :: FilterType -&gt; ReportId -&gt; IO Filter\nmkFilter ty reportId = case ty of\n    OwnerT -&gt; Owner &lt;$&gt; getOwnerId reportId\n    ProductT -&gt; Product &lt;$&gt; getProductType reportId\n    ReportProductT -&gt; ReportProduct &lt;$&gt; getReportType reportId\n                                    &lt;*&gt; getProductType reportId\n</code></pre>\n\n<p>If the repeated <code>reportId</code> bothers you, you could consider using a type like:</p>\n\n<pre><code>mkFilter :: FilterType -&gt; ReaderT ReportId IO Filter\n</code></pre>\n\n<p>This would probably feel cleanest if you then also modified <code>getOwnerId</code>, <code>getReportType</code>, and <code>getProductType</code> to use <code>ReaderT</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 4, "last_activity_date": 1524246023, "creation_date": 1524246023, "answer_id": 49947081, "question_id": 49946389, "link": "https://stackoverflow.com/questions/49946389/making-a-scalable-setter/49947081#49947081", "title": "Making a scalable setter", "body": "<p>My other answer discusses a very simple solution that is Haskell2010; this has the advantage of being easy to understand and easy to use. But it does have a funny duplication of constructor names. In this answer I will give a short description of how to use GADTs to avoid that problem. GADTs give us a way to connect term constructors with the type-level. So:</p>\n\n<pre><code>data FilterType a where\n    Owner :: FilterType Id\n    Product :: FilterType ProductType\n    ReportProduct :: FilterType (ReportType, ProductType)\n</code></pre>\n\n<p>Then we can return different information for each type of filter:</p>\n\n<pre><code>mkFilter :: FilterType a -&gt; ReportId -&gt; IO a\nmkFilter Owner = getOwnerId\nmkFilter Product = getProductId\nmkFilter ReportProduct = \\reportId -&gt; (,) &lt;$&gt; getReportType reportId\n                                          &lt;*&gt; getProductType reportId\n</code></pre>\n\n<p>Presumably to use one of these we would need to bundle together a <code>FilterType a</code> and an <code>a</code>; e.g. perhaps you would have a function with a type like this one:</p>\n\n<pre><code>filterMatches :: FilterType a -&gt; a -&gt; Record -&gt; Bool\n</code></pre>\n\n<p>Such a bundle might even be worth formalizing in its own existential type:</p>\n\n<pre><code>data Filter where Filter :: FilterType a -&gt; a -&gt; Filter\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 8678276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7749277831353da6c548be887745c0d6?s=128&d=identicon&r=PG&f=1", "display_name": "jek339", "link": "https://stackoverflow.com/users/8678276/jek339"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 49947081, "answer_count": 2, "score": 1, "last_activity_date": 1524246023, "creation_date": 1524243091, "last_edit_date": 1524245464, "question_id": 49946389, "link": "https://stackoverflow.com/questions/49946389/making-a-scalable-setter", "title": "Making a scalable setter", "body": "<p>I have a constructor that looks something like this:</p>\n\n<pre><code>data FilterType \n  = OwnerId\n  | OwnerIdReportType\n  | ReportTypeProductType\n\nfilterParams = FilterParams\n  { filterType :: FilterType\n  , ownerId :: Maybe Id\n  , productType :: Maybe ProductType\n  , reportType :: Maybe ReportType\n  }\n</code></pre>\n\n<p>Then when I set the filter params, I'm doing it like this, so I only fetch the data that I need:</p>\n\n<pre><code>defaultFilterParams =\n  { filterType = OwnerId\n  , ownerId = Nothing\n  , productType = Nothing\n  , reportType = Nothing\n  }\n\nmkFilterParams :: FilterType -&gt; Id -&gt; IO FilterParams\nmkFilterParams OwnerId reportId = do\n  ownerId &lt;- getOwnerId reportId\n  defaultFilterParams { ownerId }\nmkFilterParams ReportTypeProductType reportId = do\n  reportType &lt;- getReportType reportId\n  productType &lt;- getProductType reportId\n  defaultFilterParams\n    { filterType = ReportTypeProductType\n    , productType\n    , reportType\n    }\n-- etc\n</code></pre>\n\n<p>Obviously as more FilterTypes get added, <code>mkFilterParams</code> starts to contain a lot of repeated code. Is there a more efficient/scalable way to implement this? I've been staring at it for too long to be able to see a new way.</p>\n"}, {"tags": ["haskell", "aeson"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1524240615, "post_id": 49945289, "comment_id": 86907893, "body": "I think your idea of defining an extra datatype representing an &quot;observation without a filename&quot; is a very good one!"}, {"owner": {"reputation": 1096, "user_id": 5021447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-gwPYP717ZyU/AAAAAAAAAAI/AAAAAAAAAP8/WoyhftM4PuU/photo.jpg?sz=128", "display_name": "Jordan Mackie", "link": "https://stackoverflow.com/users/5021447/jordan-mackie"}, "edited": false, "score": 0, "creation_date": 1524241269, "post_id": 49945289, "comment_id": 86908268, "body": "It may not seem terribly clever, but I also think your suggested solution is the best one. Particularly if it had the signature <code>NotNamedObservation -&gt; FilePath -&gt; Observation</code>, then it&#39;s obvious what&#39;s going on."}], "answers": [{"comments": [{"owner": {"reputation": 1096, "user_id": 5021447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-gwPYP717ZyU/AAAAAAAAAAI/AAAAAAAAAP8/WoyhftM4PuU/photo.jpg?sz=128", "display_name": "Jordan Mackie", "link": "https://stackoverflow.com/users/5021447/jordan-mackie"}, "edited": false, "score": 0, "creation_date": 1524241919, "post_id": 49945883, "comment_id": 86908563, "body": "This would be a strong answer for someone with more haskell experience, but I think you&#39;re turning the fire hose onto a newbie here. The article from Sandy Maguire is great though, so thank you for that."}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": false, "score": 2, "last_activity_date": 1524241084, "creation_date": 1524241084, "answer_id": 49945883, "question_id": 49945289, "link": "https://stackoverflow.com/questions/49945289/using-file-name-in-json-parsing-haskell-aeson/49945883#49945883", "title": "Using file name in json parsing (Haskell Aeson)", "body": "<p>When you don't control the <code>data</code> definition and you have strict requirements about the format to parse, it's better to write the (de)serializer explicitly.</p>\n\n<p>If external information is required to fully construct values, avoid the <code>FromJSON</code>/<code>ToJSON</code> type classes, and just write standalone parsers.</p>\n\n<p><em>aeson</em>'s deriving mechanism is more suited to applications that talk to themselves (and thus only care about round-tripping between <code>parseJSON</code> and <code>toJSON</code>), or where there is flexibility either in defining the JSON format or the Haskell types.</p>\n\n<hr>\n\n<p>If you still have to use these classes for some reason, one option is of course to just put <code>undefined</code> in those missing fields. To rely on the type system more, you can also parameterize types by a \"phase\" (that assumes again you can tweak the data type), which is a type constructor that wraps some fields.</p>\n\n<ul>\n<li><a href=\"https://www.benjamin.pizza/posts/2017-12-15-functor-functors.html\" rel=\"nofollow noreferrer\">Functor functors</a></li>\n<li>One way to keep that style compatible with regular records is to use <a href=\"http://reasonablypolymorphic.com/blog/higher-kinded-data\" rel=\"nofollow noreferrer\">this HKD/defunctionalization design pattern</a>.</li>\n</ul>\n\n<hr>\n\n<pre><code>data Observation' p = Observation\n  { id :: Integer\n  , value :: Integer\n  , filename :: p String }\n\n-- This is isomorphic to the original Observation data type\ntype Observation = Observation Identity\n\n-- When we don't have the filename available, we keep the field empty with Proxy\ninstance FromJSON (Observation' Proxy) where\n  ...\n\nmkObservation :: FileName -&gt; Observation' Proxy -&gt; Observation\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 2, "last_activity_date": 1524247160, "creation_date": 1524247160, "answer_id": 49947356, "question_id": 49945289, "link": "https://stackoverflow.com/questions/49945289/using-file-name-in-json-parsing-haskell-aeson/49947356#49947356", "title": "Using file name in json parsing (Haskell Aeson)", "body": "<p>Just make your instance a function from file path to Observation:</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE OverloadedStrings #-}\nimport Data.Aeson\nimport qualified Data.ByteString.Lazy as LBS\nimport System.Environment\n\ndata Observation = Observation { ident    :: Integer\n                               , value    :: Integer\n                               , filename :: FilePath\n                               } deriving (Show)\n\ninstance FromJSON (FilePath -&gt; Observation) where\n  parseJSON (Object v) =\n    do i &lt;- read &lt;$&gt; v .: \"id\"\n       l &lt;- v .: \"value\"\n       pure $ Observation i l\n\nmain :: IO ()\nmain = do\n  files &lt;- getArgs\n  fileContents &lt;- traverse LBS.readFile files\n  print fileContents\n  let fs = map (maybe (error \"Invalid json\") id . decode) fileContents\n      jsons :: [Observation]\n      jsons = zipWith ($) fs files\n  print jsons\n</code></pre>\n"}], "owner": {"reputation": 110, "user_id": 7241424, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0efd503bce039844915a7cd8bace5fe?s=128&d=identicon&r=PG&f=1", "display_name": "Vitorqb", "link": "https://stackoverflow.com/users/7241424/vitorqb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 49947356, "answer_count": 2, "score": 5, "last_activity_date": 1524247160, "creation_date": 1524238813, "question_id": 49945289, "link": "https://stackoverflow.com/questions/49945289/using-file-name-in-json-parsing-haskell-aeson", "title": "Using file name in json parsing (Haskell Aeson)", "body": "<p>I have no experience in Haskell. I'm trying to parse many <code>.json</code> files to a data structure in Haskell using <a href=\"https://github.com/bos/aeson\" rel=\"noreferrer\">aeson</a>. However, by reasons beyond my control, I need to store the name of the file from where the data was parsed as one of the fields in my data. A simple example of what I have so far is:</p>\n\n<pre><code>data Observation = Observation { id :: Integer\n                               , value :: Integer\n                               , filename :: String}\n\ninstance FromJSON Observation where\n  parseJson (Object v) =\n    Observation &lt;$&gt; (read &lt;$&gt; v .: \"id\")\n                &lt;*&gt; v .: \"value\"\n                &lt;*&gt; ????\n</code></pre>\n\n<p>My question is: what is a smart way to be able to serialize my data when parsing a json file having access to the name of the file?</p>\n\n<p>What comes in my mind is to define another <code>data</code> like <code>NotNamedObservation</code>, initialize it and then having a function that converts <code>NotNamedObservation -&gt; String -&gt; Observation</code> (where String is the filename) but that sounds like a very poor approach.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["c", "haskell", "ffi"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 4, "creation_date": 1524231694, "post_id": 49942879, "comment_id": 86902151, "body": "This smells of an outdated C standard library, that&#39;s already linked in the haskell process. Does this by chance happen on windows? Could be the good old MSVCRT.DLL ;)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 1, "creation_date": 1524231790, "post_id": 49942879, "comment_id": 86902221, "body": "You could work around it by using <code>%lu</code> and explicitly cast <code>x</code> to <code>unsigned long</code> -- with the slight risk of wrong output on platforms where <code>size_t</code> is larger than <code>unsigned long</code> and your program actually handles a size that large ..."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1524232188, "post_id": 49942879, "comment_id": 86902472, "body": "@FelixPalmen yes, Windows. Not tested on Linux."}, {"owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "edited": false, "score": 0, "creation_date": 1524232322, "post_id": 49942879, "comment_id": 86902568, "body": "Ok, I will try your workaround. Currently I simply use <code>%u</code> instead of <code>%zu</code>, without casting, this works but I get some tedious warnings in my C editor."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1524232324, "post_id": 49942879, "comment_id": 86902569, "body": "You could check with some process explorer tool what modules are dynamically linked in both cases. I bet when running from haskell, you have the MSVCRT.DLL from the windows system folder. This one doesn&#39;t support <code>%zu</code>, at least not through the publicly visible interface."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "edited": false, "score": 0, "creation_date": 1524232413, "post_id": 49942879, "comment_id": 86902638, "body": "Yes, use <code>%lu</code> to further reduce the risk of precision loss, this was already supported in the oldest standard. The cast is <b>strictly</b> necessary, as <code>printf()</code> is a variadic function, so there&#39;s no prototype for the compiler to do the conversion automatically."}], "answers": [{"comments": [{"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 1, "creation_date": 1524234176, "post_id": 49943447, "comment_id": 86903781, "body": "Note that Windows (64-bit) is precisely the one real-world case where <code>unsigned long</code> is not the same or higher rank than <code>size_t</code>, so this is probably not the best advice unless you just want to ignore (silently print the wrong value) the possibility of very large sizes."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1524234526, "post_id": 49943447, "comment_id": 86904042, "body": "@R.. I think I exactly stated when it&#39;s possible to print a wrong value. <code>unsigned long</code> is required to have <i>at least</i> 32 value bits, so can always hold any value up to 4G. I could state this explicitly in my second condition for wrong results. IMHO, this is good enough for <b>most</b> real-world usecases of printing a size. Of course not for all."}, {"owner": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1524234681, "post_id": 49943447, "comment_id": 86904160, "body": "Indeed you did mention it and my comment didn&#39;t reflect that well. Main thing I wanted to point out is that Win64 is the unique case where bullet point 1 fails."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 194515, "user_id": 379897, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/73c5967cf90e62b10d34b1d2d0ad3aae?s=128&d=identicon&r=PG", "display_name": "R.. GitHub STOP HELPING ICE", "link": "https://stackoverflow.com/users/379897/r-github-stop-helping-ice"}, "edited": false, "score": 0, "creation_date": 1524234892, "post_id": 49943447, "comment_id": 86904308, "body": "@R.. I added more details, so every reader can better judge by himself whether this approach is safe or risky for his usecase."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1524241924, "post_id": 49943447, "comment_id": 86908567, "body": "Why not use <code>printf(&quot;x=%llu&quot;, (unsigned long long)x);</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1524242276, "post_id": 49943447, "comment_id": 86908756, "body": "@chqrlie because this would require a C99-conforming standard library as well ... then you could have used <code>%zu</code> in the first place."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1524242794, "post_id": 49943447, "comment_id": 86909010, "body": "@chqrlie for windows, there&#39;s a better solution: Microsoft has own format specifiers and they are present in every version, up to 64 bits. The headers that come with mingw map them to the <code>PRI*</code> macros in <code>inttypes.h</code>. So you <b>could</b> convert to <code>uint64_t</code> and use these macros -&gt; standard conforming and no truncation."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1524243069, "post_id": 49943447, "comment_id": 86909139, "body": "@chqrlie reminded me of an answer I wrote specifically for mingw / MSVCRT.DLL -- there is a better way in this special case, linking it here."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "is_accepted": false, "score": 5, "last_activity_date": 1524243030, "last_edit_date": 1524243030, "creation_date": 1524232994, "answer_id": 49943447, "question_id": 49942879, "link": "https://stackoverflow.com/questions/49942879/printf-with-a-size-t-using-the-ffi/49943447#49943447", "title": "printf with a size_t using the FFI", "body": "<p>As <code>printf()</code> is part of the C standard library, it is typically implemented in some runtime library. When this is linked dynamically, it's possible to have such effects with the same code, if, depending on which Process calls the code, a different version of the library is linked. If <code>%zu</code> doesn't work, it's an old version that doesn't support C99 yet.</p>\n\n<p>On windows, it's quite probably the system's MSVCRT.DLL, that's not intended for public usage any more, but is kept compatible to the old MS Visual C 6 version. For example MinGW by default links to that library, so you don't need to ship your own C runtime. This of course has the drawback to limit the library functions to C89/C90.</p>\n\n<p>An often reasonably safe thing to do for printing a <code>size_t</code> is to convert it to an <code>unsigned long</code> and print that:</p>\n\n<pre><code>size_t x = 666;\nprintf(\"x=%lu\", (unsigned long)x);\n</code></pre>\n\n<p>This would only give wrong results if</p>\n\n<ul>\n<li>the platform actually has a larger <code>size_t</code> than <code>unsigned long</code> (this is true e.g. for a 64bit system with LLP64 data model like, unfortunately, win64) and</li>\n<li>you really have a size at runtime that doesn't fit in the <code>unsigned long</code>. This would have to be at least a value larger than 4G (2<sup>32</sup>) as this is the guaranteed minimum range for <code>unsigned long</code>.</li>\n</ul>\n\n<p>Please note that the cast is very important here. Because <code>printf()</code> is a variadic function, the prototype just looks like <code>printf(const char *fmt, ...)</code>, so there's no type information for the compiler available -- therefore automatic conversions are not possible.</p>\n\n<hr>\n\n<p>If the problem is specifically MSVCRT.DLL and you want to stick to C99 or later in general, <a href=\"https://stackoverflow.com/a/44383330/2371524\">I suggested a method using <code>inttypes.h</code> in an earlier answer</a>. This will <strong>never</strong> print a wrong value on Windows (and still require a C99-conforming standard library on other platforms).</p>\n"}, {"comments": [{"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1524241845, "post_id": 49943461, "comment_id": 86908532, "body": "If <code>%llu</code> is not implemented, the system should be avoided altogether. Furthermore, the <code>printf</code> formats using 2 parts are somewhat incorrect. The code should only be used if <code>sizeof(long) &gt; 4</code> and the decimal format will have at least one leading <code>0</code> and multiple ones if the value is smaller that <code>100000000</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1524242601, "post_id": 49943461, "comment_id": 86908906, "body": "@chqrlie &quot;<i>If</i> <code>%llu</code> <i>is not implemented, the system should be avoided altogether.</i>&quot; &lt;- <code>%llu</code> first appeared in C99 as well, so if you <b>have</b> <code>%llu</code>, it is <b>very</b> likely you have <code>%zu</code> as well."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1524243367, "post_id": 49943461, "comment_id": 86909303, "body": "C99 appeared 19 years ago... systems that still do not implement this should be retired."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2371524"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1524243671, "post_id": 49943461, "comment_id": 86909469, "body": "@chqrlie too bold. Microsoft declared the system-wide installation of <code>msvcrt.dll</code> &quot;private&quot; for a long time and delivers newer/better runtime libraries with their compiler products, so, &quot;problem solved&quot; for them. Some don&#39;t like the bloat to redist a full standard library with every application written in C -- and although there were already plans to (optionally) replace <code>msvcrt.dll</code> with mingw, it can be considered a good thing to be able to compile lean dynamically linked C programs for windows. There really aren&#39;t <b>many</b> restrictions when using this ancient library."}, {"owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "reply_to_user": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 1, "creation_date": 1524245060, "post_id": 49943461, "comment_id": 86910177, "body": "@chqrlie Unclear about &quot;The code should only be used if <code>sizeof(long) &gt; 4</code>&quot;.  Are you referring to <code>printf(&quot;%lu\\n&quot;, (unsigned long) sz);</code> or  <code>printf(&quot;%lX%08lX\\n&quot;, ...</code> or both?  Please detail the &quot;somewhat incorrect&quot; if it is something other than truncation in the first case or the leading 0 issue in the 2nd.  Both those issues are noted in the answer. Perhaps text should have had more emphasis on those?  The <code>&gt; 4</code> part is especially unclear as any size/range limitation I&#39;d expect to be due to <code>unsigned long</code> vs. <code>size_t</code> and not a fixed value of 4 (as in 4-byte types)."}, {"owner": {"reputation": 97126, "user_id": 4593267, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/EEyLy.jpg?s=128&g=1", "display_name": "chqrlie", "link": "https://stackoverflow.com/users/4593267/chqrlie"}, "edited": false, "score": 0, "creation_date": 1524318538, "post_id": 49943461, "comment_id": 86929039, "body": "After rethinking the issue, I think splitting the printf format in 2 parts as not a good option, nor needed in practical cases: if <code>sizeof(size_t)&gt;4</code>, then the type <code>unsigned long long</code> can be assumed to exist and to be at least as large as <code>size_t</code>, so <code>printf(&quot;%llu\\n&quot;, (unsigned long long)sz);</code> will do the job. Otherwise <code>printf(&quot;%lu\\n&quot;, (unsigned long)sz);</code> will handle the remaining cases correctly. Pathological architectures with non 8-bit bytes can be ignored for this argument IMHO."}], "tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1524235113, "last_edit_date": 1524235113, "creation_date": 1524233016, "answer_id": 49943461, "question_id": 49942879, "link": "https://stackoverflow.com/questions/49942879/printf-with-a-size-t-using-the-ffi/49943461#49943461", "title": "printf with a size_t using the FFI", "body": "<p>When <code>\"%zu\"</code> is not implemented, the alternative is to cast to some wide type and print that, with a modest risk of truncation.</p>\n\n<pre><code>size_t sz = foo();\nprintf(\"%lu\\n\", (unsigned long) sz);  // risk of truncation.\n</code></pre>\n\n<p>Code could attempt other integer wide types like <code>uintmax_t</code> and <code>unsigned long long</code>, yet if <code>\"%zu\"</code> is not implemented, then likely <code>\"%ju\"</code> and <code>\"%llu\"</code> will also not be implemented.</p>\n\n<p>Truncation can be avoided with printing in parts.</p>\n\n<pre><code>printf(\"%lX%08lX\\n\", \n    (unsigned long) (sz/0x10000u/0x10000u), (unsigned long) (sz &amp; 0xFFFFFFFFu));\n\n// remote truncation risk remains.\nprintf(\"%lu%09lu\\n\", \n    (unsigned long) (sz/1000000000u), (unsigned long) (sz%1000000000u));\n</code></pre>\n\n<p>More complex code could be used to avoid leading digits.</p>\n"}, {"tags": [], "owner": {"reputation": 112912, "user_id": 2410359, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/pIl9T.png?s=128&g=1", "display_name": "chux - Reinstate Monica", "link": "https://stackoverflow.com/users/2410359/chux-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1524246194, "last_edit_date": 1524246194, "creation_date": 1524245637, "answer_id": 49946993, "question_id": 49942879, "link": "https://stackoverflow.com/questions/49942879/printf-with-a-size-t-using-the-ffi/49946993#49946993", "title": "printf with a size_t using the FFI", "body": "<p>I'd like to offer another approach to working with systems with that are not up to C99/C11 standards yet provide 64-bit or wider types.</p>\n\n<p>Import and include a <code>stdint.h/inttypes.h</code> designed to bridge older systems to new C99 standards.</p>\n\n<p>Example:  <a href=\"https://stackoverflow.com/q/126279/2410359\">C99 stdint.h header and MS Visual Studio</a></p>\n\n<p>Then cast to a wide type available though them</p>\n\n<pre><code>#if SIZE_MAX &gt; ULONG_MAX\n// Include from the standard location or wherever the imported included files are saved.\n#include &lt;stdint.h&gt;\n#include &lt;inttypes.h&gt;\n\nvoid printzu(){\n    size_t x = 666;\n    printf(\"x=%\" PRIuMAX \"\\n\", (uint_max_t) x);\n}\n\n#else\nvoid printzu(){\n    size_t x = 666;\n    printf(\"x=%lu\\n\", (unsigned long) x);\n}\n#endif\n</code></pre>\n"}], "owner": {"reputation": 46777, "user_id": 1100107, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/8789d3da0b482bcd8e562bfdf3687c74?s=128&d=identicon&r=PG", "display_name": "St&#233;phane Laurent", "link": "https://stackoverflow.com/users/1100107/st%c3%a9phane-laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1524246194, "creation_date": 1524231239, "question_id": 49942879, "link": "https://stackoverflow.com/questions/49942879/printf-with-a-size-t-using-the-ffi", "title": "printf with a size_t using the FFI", "body": "<p>In order to print a <code>size_t</code> integer in C with <code>printf</code>, the conversion formatter is <code>%zu</code>. </p>\n\n<p>However when I use <code>printf</code> with <code>%zu</code>, calling the C function in Haskell through the FFI prints <code>zu</code> instead of the integer. How to solve that? </p>\n\n<h2>Minimal example</h2>\n\n<p><em>file zu.c</em></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n\nvoid printzu(){\n    size_t x = 666;\n    printf(\"x=%zu\", x);\n}\n</code></pre>\n\n<p><em>module Lib.hs</em></p>\n\n<pre><code>{-# LANGUAGE ForeignFunctionInterface #-}\nmodule Lib\n  where\nimport Foreign\n\nforeign import ccall unsafe \"printzu\" printzu' :: IO ()\n</code></pre>\n\n<h3>Test</h3>\n\n<pre><code>Prelude&gt; import Lib\nPrelude Lib&gt; printzu'\nx=zu\n</code></pre>\n"}, {"tags": ["haskell", "module"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1524223823, "post_id": 49940351, "comment_id": 86896930, "body": "Why is this being downvoted?"}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 0, "creation_date": 1524224117, "post_id": 49940351, "comment_id": 86897134, "body": "Yes, this is a pretty good question."}, {"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1524224457, "post_id": 49940351, "comment_id": 86897388, "body": "I have no idea. It&#39;d be nice to get some feedback about why this question is bad. Specially since I would really like to simplify my code base ... :/ Maybe I shound&#39;t have included the &quot;module&quot; tag, who knows who&#39;s watching that tag..."}, {"owner": {"reputation": 7953, "user_id": 812149, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/6lIqv.png?s=128&g=1", "display_name": "S.L. Barth", "link": "https://stackoverflow.com/users/812149/s-l-barth"}, "edited": false, "score": 8, "creation_date": 1524227953, "post_id": 49940351, "comment_id": 86899608, "body": "Seems somebody is using 6 accounts to downvote; <a href=\"https://meta.stackoverflow.com/q/366288/812149\">discussed on Meta</a>."}, {"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 1, "creation_date": 1524228170, "post_id": 49940351, "comment_id": 86899757, "body": "What the hell? Thanks a lot for tracking this down!"}], "answers": [{"comments": [{"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1524223306, "post_id": 49940491, "comment_id": 86896593, "body": "Thanks. Could you provide more details or links?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 1, "creation_date": 1524223995, "post_id": 49940491, "comment_id": 86897049, "body": "@DamianNadales Turn on the <code>CPP</code> extension. Put the imports in a file, say <code>imports.h</code>. Add <code>#include &quot;imports.h&quot;</code> in each module. (I&#39;m not sure it is worth it, though -- I&#39;d just repeat the imports)"}, {"owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "edited": false, "score": 0, "creation_date": 1524225261, "post_id": 49940491, "comment_id": 86897907, "body": "Thanks. I just tried that, but it seems that this &quot;imports.h&quot; has to be in the same directory (on under) as the file which imports it, which won&#39;t work if this prelude has to be imported by files in different directories (or am I wrong?)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1524227947, "post_id": 49940491, "comment_id": 86899604, "body": "You don&#39;t really need a macro, if you use <code>#include</code> where you would have written <code>import ...</code>."}, {"owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "edited": false, "score": 0, "creation_date": 1524228062, "post_id": 49940491, "comment_id": 86899677, "body": "Ohh that&#39;s true!"}], "tags": [], "owner": {"reputation": 24509, "user_id": 6863749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UyoQv.jpg?s=128&g=1", "display_name": "Li-yao Xia", "link": "https://stackoverflow.com/users/6863749/li-yao-xia"}, "is_accepted": true, "score": 6, "last_activity_date": 1524242048, "last_edit_date": 1524242048, "creation_date": 1524223188, "answer_id": 49940491, "question_id": 49940351, "link": "https://stackoverflow.com/questions/49940351/what-is-an-alternative-to-a-prelude-with-qualfied-imports/49940491#49940491", "title": "What is an alternative to a prelude with qualfied imports", "body": "<p>One solution is to define the import list in a CPP header.</p>\n\n<p><strong>N.B.</strong>: This answer is just to show what is technically possible; <a href=\"https://stackoverflow.com/a/49942046/6863749\">Daniel Wagner's answer</a> is generally the better alternative.</p>\n\n<hr>\n\n<p>For a package-level example:</p>\n\n<pre><code>my-pkg/\n  my-pkg.cabal\n  include/imports.h\n  src/MyModule.hs\n  ...\n</code></pre>\n\n<p><code>include/imports.h</code>:</p>\n\n<pre><code>import Control.Applicative\nimport Data.Maybe\nimport Data.Char\n</code></pre>\n\n<p>In <code>my-pkg.cabal</code>, components (<code>library</code>, <code>executable</code>, <code>test</code>, ...) have a <code>include-dirs</code> field (that in turn correspond to some GHC option):</p>\n\n<pre><code>library\n  ...\n  include-dirs: include\n</code></pre>\n\n<p>Then you can use that header in any module:</p>\n\n<pre><code>{-# LANGUAGE CPP #-}\n\nmodule MyModule where\n\n#include \"imports.h\"\n\n-- your code here\nmymaybe = maybe\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1524231103, "post_id": 49942046, "comment_id": 86901746, "body": "Further, unless the header dependency is somehow specified to cabal (is that possible?), it might happen that modifying the header file does not trigger the rebuilding of all the dependent modules. Spurious redundant imports warnings can also arise."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1524243874, "post_id": 49942046, "comment_id": 86909575, "body": "@duplode Not sure what you&#39;re seeing, but on my end, the <code>lang-haskell</code> annotation definitely does change the syntax highlighting (for the better). I&#39;ve rolled back your modification."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1524253132, "post_id": 49942046, "comment_id": 86913787, "body": "@DanielWagner The codes for Haskell highlighting are <code>lang-hs</code> and <code>haskell</code>. <code>lang-haskell</code>, not being a valid code, makes the highlighter fallback to the default highlighting, which for Haskell handles several things wrongly (see <a href=\"https://meta.stackoverflow.com/q/267272\">this Meta question</a> for an example). The difference you see here is that the default highlighting will colour anything starting with an upper case letter -- in our case, that means indistinctly using the same colour for value constructors, types, classes and modules."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 1, "creation_date": 1524255835, "post_id": 49942046, "comment_id": 86914950, "body": "@duplode Okay... but if that&#39;s the case, then the Haskell syntax highlighter kind of sucks. It doesn&#39;t even pick up <code>qualified</code> or <code>as</code> as keywords..."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1524282237, "post_id": 49942046, "comment_id": 86920806, "body": "@DanielWagner Indeed... at least it is, IMO, better than the one used by older versions of MediaWiki (as in the Haskell Wiki, and formerly in the Wikibook) -- it highlights Prelude identifiers, which means badly inconsistent styling for pretty much any piece of code."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 25, "last_activity_date": 1524243836, "last_edit_date": 1524243836, "creation_date": 1524228623, "answer_id": 49942046, "question_id": 49940351, "link": "https://stackoverflow.com/questions/49940351/what-is-an-alternative-to-a-prelude-with-qualfied-imports/49942046#49942046", "title": "What is an alternative to a prelude with qualfied imports", "body": "<p>I'm going to answer this question, interpreted as literally as possible:</p>\n\n<blockquote>\n  <p>How do people solve this problem in large Haskell code bases?</p>\n</blockquote>\n\n<p>Answer: they write</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>import qualified Data.Map as Map\nimport qualified Data.Set as Set\nimport qualified Data.Text as Text\n</code></pre>\n\n<p>at the top of each module which needs <code>Map</code>, <code>Set</code>, and <code>Text</code>.</p>\n\n<p>In my experience, managing imports is not a significant part of the difficulty of working with large codebases. The effort of jumping to the import list and adding a line for <code>Data.Map</code> when you discover you need it is <em>absolutely swamped</em> by the effort of finding the right place in the codebase to make changes, knowing the full breadth of the codebase so you don't duplicate efforts, and finding ways to test small chunks of a large application in isolation.</p>\n\n<p>Compared to the proposed alternative in the other answer (CPP), this way also has some technical advantages:</p>\n\n<ul>\n<li>Less project lead-in time. The fewer surprises there are for the humans who join onto your project, the quicker they can get up and running and be independently useful.</li>\n<li>Better tool support. If I see <code>Foo.bar</code> as an identifier somewhere, I can use my text editor's regex search to find out what import line made the <code>Foo</code> namespace available without fancy additions to include <code>#include</code>d files. If I want to find all the files that depend on <code>Some.Fancy.Module</code>, I can learn that by grepping for <code>Some.Fancy.Module</code>. Build systems that do change detection don't need to know about the extra <code>.h</code> file when computing which files to watch. And so forth.</li>\n<li>Fewer spurious rebuilds. If you have more imports than you actually use, this can cause GHC to rebuild your module even when it need not be rebuilt.</li>\n</ul>\n"}], "owner": {"reputation": 4593, "user_id": 2289983, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/LG4hj.jpg?s=128&g=1", "display_name": "Damian Nadales", "link": "https://stackoverflow.com/users/2289983/damian-nadales"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 808, "favorite_count": 0, "accepted_answer_id": 49940491, "answer_count": 2, "score": 21, "last_activity_date": 1524243836, "creation_date": 1524222684, "last_edit_date": 1524223678, "question_id": 49940351, "link": "https://stackoverflow.com/questions/49940351/what-is-an-alternative-to-a-prelude-with-qualfied-imports", "title": "What is an alternative to a prelude with qualfied imports", "body": "<p>Almost every module in our code base has imports such as:</p>\n\n<pre><code>import qualified Data.Map as Map\nimport qualified Data.Set as Set\nimport qualified Data.Text as Text\n</code></pre>\n\n<p>I would like to define a local prelude so that <code>Map</code>, <code>Set</code> and <code>Text</code> are available to the modules importing that prelude. Apparently <a href=\"https://stackoverflow.com/questions/22973256/how-do-i-reexport-qualified-imported-modules\">there is no way to do that in Haskell</a>. So I am wondering how do people solve this problem in large Haskell code bases.</p>\n"}, {"tags": ["loops", "haskell"], "comments": [{"owner": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "edited": false, "score": 4, "creation_date": 1524211894, "post_id": 49937034, "comment_id": 86889566, "body": "Can you include the bunch of errors? Usually those are quite informative."}, {"owner": {"reputation": 11, "user_id": 9509352, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Steam Second", "link": "https://stackoverflow.com/users/9509352/steam-second"}, "reply_to_user": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "edited": false, "score": 0, "creation_date": 1524211986, "post_id": 49937034, "comment_id": 86889639, "body": "Included errors"}, {"owner": {"reputation": 240688, "user_id": 14955, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/5DblQ.png?s=128&g=1", "display_name": "Thilo", "link": "https://stackoverflow.com/users/14955/thilo"}, "edited": false, "score": 2, "creation_date": 1524212211, "post_id": 49937034, "comment_id": 86889747, "body": "<code>Ambiguous type variable &#39;b0&#39; arising from a use of &#39;read&#39;</code> Nowhere in your program does it say that you want to work with integers. The <code>read</code> function needs to know what it is supposed to read. You can probably fix that by adding type declarations for <code>check</code> and <code>calculate</code> (good practice anyway)"}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 1, "creation_date": 1524212617, "post_id": 49937034, "comment_id": 86889980, "body": "You have 2 IO monads, I would try to use 1 and do the rest in the functional part."}], "answers": [{"comments": [{"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "edited": false, "score": 0, "creation_date": 1524216903, "post_id": 49938203, "comment_id": 86892689, "body": "Perhaps a <code>getInts = map read . words &lt;$&gt; getLine</code> of type <code>IO [Int]</code> as an interface between <code>main</code> and <code>calculate</code>."}], "tags": [], "owner": {"reputation": 1096, "user_id": 5021447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-gwPYP717ZyU/AAAAAAAAAAI/AAAAAAAAAP8/WoyhftM4PuU/photo.jpg?sz=128", "display_name": "Jordan Mackie", "link": "https://stackoverflow.com/users/5021447/jordan-mackie"}, "is_accepted": false, "score": 5, "last_activity_date": 1524215859, "creation_date": 1524215859, "answer_id": 49938203, "question_id": 49937034, "link": "https://stackoverflow.com/questions/49937034/haskell-reading-and-iterating/49938203#49938203", "title": "haskell reading and iterating", "body": "<p>To start with, I suggest you default to always writing type annotations. And before you start implementing anything, sketch out what the types of your program look like. For this program I suggest you start from:</p>\n\n<pre><code>main :: IO ()\n\nsolve :: String -&gt; String\n\ncalculate :: [Int] -&gt; Int\n\ncheck :: Int -&gt; Int\n</code></pre>\n\n<p>The names could also probably be improved to better convey what it is they're doing. </p>\n\n<p>Note that there is only one function with type <code>IO _</code>. This serves to isolate the impure part of your program, which will make your life easier (e.g. testing, code reasoning, etc).</p>\n\n<p>You're not far off. Just try reworking your code to fit into the above types. And be aware that you're missing a pattern in your <code>calculate</code> implementation  ;)</p>\n"}, {"tags": [], "owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "is_accepted": false, "score": 0, "last_activity_date": 1524248509, "last_edit_date": 1524248509, "creation_date": 1524248198, "answer_id": 49947580, "question_id": 49937034, "link": "https://stackoverflow.com/questions/49937034/haskell-reading-and-iterating/49947580#49947580", "title": "haskell reading and iterating", "body": "<p>If you inspect your code and follow the types, it is crystal-clear where the error is. Yes, you can add type annotations -- that is highly recommended -- but I find your code is so simple you could get away with just a bit of equational reasoning.</p>\n\n<p>It starts with <code>solve</code>, it is easy to see that <code>nums</code> is of type <code>Read a =&gt; [a]</code>, given that you split a string by words (i.e. <code>[String]</code>) and map <code>read</code> over it. So a list of <code>a</code>s is what you give to <code>calculate</code>. As you know, a list is the disjoint sum between (1) the empty list (<code>[]</code>) and (2) a cons cell made of a head, an element of type <code>a</code>, and a tail, the rest of the list (<code>(x:xs)</code>).</p>\n\n<p>First thing you notice is that the case of the empty list is missing; let's add it:</p>\n\n<pre><code>calculate [] = 0 -- I assume this is correct\n</code></pre>\n\n<p>On to the body of <code>calculate</code> and <code>check</code>. The latter clearly expects a number, you can be a bit more concise by the way:</p>\n\n<pre><code>check 0 = -1\ncheck _ = 1\n</code></pre>\n\n<p>Now if you look at <code>calculate</code>, you see that you are calling <code>check</code> and passing it <code>xs</code>. What is <code>xs</code>? It is bound in the pattern <code>(x:xs)</code> which is how you uncons a cons cell. Clearly, <code>xs</code> is the tail of the cell and so a list itself. But <code>check</code> expects a number! The only number you can expect here is <code>x</code>, not <code>xs</code>. So let's change you code to</p>\n\n<pre><code>calculate (x:xs) = check x + ...\n</code></pre>\n\n<p>Your specifications state that you want to iterate over the list. That can only happen if you do something with <code>xs</code>. What can you do with it? The only answer to that is to call <code>calculate</code> recursively:</p>\n\n<pre><code>calculate (x:xs) = check x + calculate xs\n</code></pre>\n\n<p>... and with these changes, your code is fine.</p>\n"}], "owner": {"reputation": 11, "user_id": 9509352, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Steam Second", "link": "https://stackoverflow.com/users/9509352/steam-second"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1524248509, "creation_date": 1524211800, "last_edit_date": 1524211963, "question_id": 49937034, "link": "https://stackoverflow.com/questions/49937034/haskell-reading-and-iterating", "title": "haskell reading and iterating", "body": "<p>I need your help guys. \nIm trying to learn and do a simple task in haskell, but it's still hard for me.\nWhat im trying to do is: Read a line of numbers separated with whitespace, iterate over that list, check values, and if values are not zero add 1 otherwise -1. I was trying to do it watching some tutorials and other project code, but it just outputs a bunch of errors.\nMy code:</p>\n\n<pre><code>import System.Environment\nimport Control.Monad\nimport Text.Printf\nimport Data.List\nimport System.IO\n\nsolve :: IO ()\nsolve = do\n    nums &lt;- map read . words &lt;$&gt; getLine\n    print (calculate nums)\n\ncalculate (x:xs) = x + check xs\n\ncheck num\n    | num == 0 =\n        -1\n    | otherwise = \n        1\n\nmain :: IO ()\nmain = do\n    n &lt;- readLn\n    if n /= 0\n        then do \n            printf \"Case: \"\n            solve\n        else main\n</code></pre>\n\n<p>Errors:</p>\n\n<pre><code>C:\\Users\\Donatas\\Documents\\haskell\\la3.hs:9:21: error:\n    * Ambiguous type variable `b0' arising from a use of `read'\n      prevents the constraint `(Read b0)' from being solved.\n      Probable fix: use a type annotation to specify what `b0' should be.\n      These potential instances exist:\n        instance Read BufferMode -- Defined in `GHC.IO.Handle.Types'\n        instance Read Newline -- Defined in `GHC.IO.Handle.Types'\n        instance Read NewlineMode -- Defined in `GHC.IO.Handle.Types'\n        ...plus 25 others\n        ...plus six instances involving out-of-scope types\n        (use -fprint-potential-instances to see them all)\n    * In the first argument of `map', namely `read'\n      In the first argument of `(.)', namely `map read'\n      In the first argument of `(&lt;$&gt;)', namely `map read . words'\n  |\n9 |         nums &lt;- map read . words &lt;$&gt; getLine\n  |                     ^^^^\n\nC:\\Users\\Donatas\\Documents\\haskell\\la3.hs:10:9: error:\n    * Ambiguous type variable `a0' arising from a use of `print'\n      prevents the constraint `(Show a0)' from being solved.\n      Probable fix: use a type annotation to specify what `a0' should be.\n      These potential instances exist:\n        instance Show HandlePosn -- Defined in `GHC.IO.Handle'\n        instance Show BufferMode -- Defined in `GHC.IO.Handle.Types'\n        instance Show Handle -- Defined in `GHC.IO.Handle.Types'\n        ...plus 27 others\n        ...plus 13 instances involving out-of-scope types\n        (use -fprint-potential-instances to see them all)\n    * In a stmt of a 'do' block: print (calculate nums)\n      In the expression:\n        do nums &lt;- map read . words &lt;$&gt; getLine\n           print (calculate nums)\n      In an equation for `solve':\n          solve\n            = do nums &lt;- map read . words &lt;$&gt; getLine\n                 print (calculate nums)\n   |\n10 |         print (calculate nums)\n   |         ^^^^^^^^^^^^^^^^^^^^^^\n\nC:\\Users\\Donatas\\Documents\\haskell\\la3.hs:12:1: error:\n    * Non type-variable argument in the constraint: Num [a]\n      (Use FlexibleContexts to permit this)\n    * When checking the inferred type\n        calculate :: forall a. (Eq a, Num [a], Num a) =&gt; [a] -&gt; a\n   |\n12 | calculate (x:xs) = x + check xs\n   | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nFailed, no modules loaded.\n</code></pre>\n"}, {"tags": ["function", "haskell"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 3, "creation_date": 1524193243, "post_id": 49933239, "comment_id": 86882150, "body": "<code>all</code> takes two arguments: a predicate function (i.e. a boolean test for the elements) and a list."}, {"owner": {"reputation": 121, "user_id": 7023122, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4fc771105a47761221bba39fd522effe?s=128&d=identicon&r=PG&f=1", "display_name": "James Johnson", "link": "https://stackoverflow.com/users/7023122/james-johnson"}, "reply_to_user": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1524193475, "post_id": 49933239, "comment_id": 86882212, "body": "@duplode Ohh I see! Thank you"}, {"owner": {"reputation": 2585, "user_id": 8491228, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/j5T09.jpg?s=128&g=1", "display_name": "Mor A.", "link": "https://stackoverflow.com/users/8491228/mor-a"}, "reply_to_user": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1524216333, "post_id": 49933239, "comment_id": 86892289, "body": "@Elmex80s <code>and</code> has the signature <code>[Bool] -&gt; Bool</code>"}], "answers": [{"tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": false, "score": 5, "last_activity_date": 1524193463, "creation_date": 1524193463, "answer_id": 49933285, "question_id": 49933239, "link": "https://stackoverflow.com/questions/49933239/understanding-the-use-of-brackets-in-the-all-function-in-haskell/49933285#49933285", "title": "Understanding the use of brackets in the all function in Haskell?", "body": "<h3>What parentheses do here</h3>\n\n<p>Parentheses in Haskell serve a purpose that is very similar to most other programming languages: changing precedence of operations and/or grouping terms.</p>\n\n<p>In your case, the fact that <code>(a -&gt; Bool)</code> is wrapped in parentheses shows that the type of the function's first parameter is <code>a -&gt; Bool</code>. If there was no parentheses (i.e. if the signature was <code>all :: a -&gt; Bool -&gt; [a] -&gt; Bool</code>), then the meaning would be that the type of the function's first parameter is <code>a</code>, and the type of the function's second parameter is <code>Bool</code>.</p>\n\n<h3>Wouldn't it be enough to have <code>all :: [a] -&gt; Bool</code>?</h3>\n\n<p>If that was the signature, then the question would be: what does such function mean? Does it return <code>True</code> when the list is not empty? Or when it's empty? Or when it contains precisely 42 elements? A bad name for a function. Should have named it <code>has42Elements</code> instead of <code>all</code>.</p>\n\n<p>On the other hand, if the function takes the first parameter of type <code>a -&gt; Bool</code> (that is, a function that takes an <code>a</code> and returns a <code>Bool</code>), then the meaning of <code>all</code> would be \"<em>check if this function is <code>True</code> for all elements in this list</em>\".</p>\n"}], "owner": {"reputation": 121, "user_id": 7023122, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/4fc771105a47761221bba39fd522effe?s=128&d=identicon&r=PG&f=1", "display_name": "James Johnson", "link": "https://stackoverflow.com/users/7023122/james-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 237, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1524193463, "creation_date": 1524193132, "question_id": 49933239, "link": "https://stackoverflow.com/questions/49933239/understanding-the-use-of-brackets-in-the-all-function-in-haskell", "title": "Understanding the use of brackets in the all function in Haskell?", "body": "<p>I'm trying to wrap my head around the conventions and rules of programming in Haskell. One thing that I find confusing or difficult to understand is the use of brackets (). Can anyone explain to me what it does in the case of the all function?</p>\n\n<pre><code>all :: (a -&gt; Bool) -&gt; [a] -&gt; Bool\nall p xs = and [ p x | x &lt;- xs ]\n</code></pre>\n\n<p>As I understand it, the type of a function shows the type constraints, inputs and outputs. Wouldn't having </p>\n\n<pre><code>all :: [a] -&gt; Bool\n</code></pre>\n\n<p>Be enough?</p>\n"}, {"tags": ["docker", "haskell", "travis-ci", "haskell-stack"], "comments": [{"owner": {"reputation": 1733, "user_id": 4473232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NYHx1.png?s=128&g=1", "display_name": "fly2matrix", "link": "https://stackoverflow.com/users/4473232/fly2matrix"}, "edited": false, "score": 2, "creation_date": 1524200124, "post_id": 49932954, "comment_id": 86883992, "body": "Is it possible for you to share Dockerfile or the COPY instruction ?"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 2, "creation_date": 1524259330, "post_id": 49932954, "comment_id": 86916399, "body": "The github link seems bad (<code>%20https</code> isn&#39;t a valid protocol, and even changing it to <code>https</code> I get an error). In any case StackOverflow guidelines requires you to share the code that does not work <b>in the question itself</b> so that we can look at it."}, {"owner": {"reputation": 195, "user_id": 2042053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8269ce33797e5d4b2fbb726b6e790328?s=128&d=identicon&r=PG", "display_name": "imalison", "link": "https://stackoverflow.com/users/2042053/imalison"}, "edited": false, "score": 1, "creation_date": 1524280955, "post_id": 49932954, "comment_id": 86920543, "body": "Not sure how that 20% got in the copy instruction link. Fixed now."}], "answers": [{"comments": [{"owner": {"reputation": 195, "user_id": 2042053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8269ce33797e5d4b2fbb726b6e790328?s=128&d=identicon&r=PG", "display_name": "imalison", "link": "https://stackoverflow.com/users/2042053/imalison"}, "edited": false, "score": 2, "creation_date": 1524281020, "post_id": 49933096, "comment_id": 86920551, "body": "The code in question is COPY ./stack-7.10.yaml ./stack-8.0.yaml ./stack-8.2.yaml /taffybar/, so I don&#39;t think the dockerignore file would have any effect..."}], "tags": [], "owner": {"reputation": 7381, "user_id": 4095830, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nLf56.png?s=128&g=1", "display_name": "whoan", "link": "https://stackoverflow.com/users/4095830/whoan"}, "is_accepted": false, "score": 1, "last_activity_date": 1524192149, "creation_date": 1524192149, "answer_id": 49933096, "question_id": 49932954, "link": "https://stackoverflow.com/questions/49932954/why-is-the-copy-instruction-causing-a-cache-miss-in-my-docker-build/49933096#49933096", "title": "Why is the COPY instruction causing a cache miss in my Docker build", "body": "<p>How are you completely sure any file was modified in the context?<br>\nDo you have a <a href=\"https://docs.docker.com/engine/reference/builder/#dockerignore-file\" rel=\"nofollow noreferrer\">.dockerignore file</a> with all the files/directories you want to ignore in the moment docker sends the context to the engine?</p>\n\n<p>There are a lot of files than can be getting modified and you don't know. For example, if you have a <code>.git</code> folder in the mentioned context and you made a <code>git commit</code>, now your cache will be invalidated.</p>\n\n<p><strong>Be sure you ignore the unneeded files in the .dockerignore file.</strong></p>\n"}, {"tags": [], "owner": {"reputation": 144207, "user_id": 596285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6975c494d3d9c404dd3d7af2edf3133?s=128&d=identicon&r=PG", "display_name": "BMitch", "link": "https://stackoverflow.com/users/596285/bmitch"}, "is_accepted": false, "score": 8, "last_activity_date": 1524326523, "creation_date": 1524326523, "answer_id": 49957633, "question_id": 49932954, "link": "https://stackoverflow.com/questions/49932954/why-is-the-copy-instruction-causing-a-cache-miss-in-my-docker-build/49957633#49957633", "title": "Why is the COPY instruction causing a cache miss in my Docker build", "body": "<p>Check the layers of the different images being built with <code>docker history --no-trunc $image</code>. On the copy step, you'll see a \"file:abc\" hash of the files being copied:</p>\n\n<pre><code>IMAGE                                                                     CREATED             CREATED BY                                                                                                        SIZE                COMMENT\nsha256:202cb043f70a2565ea40629e891642e1e24be7b52e29116a6520736f47183904   9 minutes ago       /bin/sh -c #(nop) COPY file:d523f0d1cac93e44179baf9c36a7a4feff221b604224e26900075ddb02812448 in /test/test.txt    12B\n</code></pre>\n\n<p>If that hash is different between the two images you are building, then that will invalidate the build cache and result in the miss. Keep in mind the metadata of the files can also cause a cache miss, especially the file permissions. If you're still having problems, then please update the question to include the <code>docker history --no-trunc ...</code> output from the different builds.</p>\n"}, {"comments": [{"owner": {"reputation": 329, "user_id": 952932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c1ba9d038acfce658b328b3abe06803?s=128&d=identicon&r=PG", "display_name": "esmail", "link": "https://stackoverflow.com/users/952932/esmail"}, "edited": false, "score": 2, "creation_date": 1574869184, "post_id": 59073724, "comment_id": 104385060, "body": "Currently this happens in GitLab CI because of a <a href=\"https://gitlab.com/gitlab-org/gitlab-runner/issues/1736\" rel=\"nofollow noreferrer\">bug</a> that causes the source to be cloned with 666 permissions."}], "tags": [], "owner": {"reputation": 329, "user_id": 952932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c1ba9d038acfce658b328b3abe06803?s=128&d=identicon&r=PG", "display_name": "esmail", "link": "https://stackoverflow.com/users/952932/esmail"}, "is_accepted": false, "score": 1, "last_activity_date": 1574869174, "creation_date": 1574869174, "answer_id": 59073724, "question_id": 49932954, "link": "https://stackoverflow.com/questions/49932954/why-is-the-copy-instruction-causing-a-cache-miss-in-my-docker-build/59073724#59073724", "title": "Why is the COPY instruction causing a cache miss in my Docker build", "body": "<p>If the contents of your file have indeed not changed, differences in <em>permissions</em> can cause cache invalidation.</p>\n\n<blockquote>\n  <p>For the ADD and COPY instructions, the contents of the file(s) in the image are examined and a checksum is calculated for each file. The last-modified and last-accessed times of the file(s) are not considered in these checksums. During the cache lookup, the checksum is compared against the checksum in the existing images. If anything has changed in the file(s), such as the contents and metadata, then the cache is invalidated.</p>\n</blockquote>\n\n<p><a href=\"https://docs.docker.com/develop/develop-images/#leverage-build-cache\" rel=\"nofollow noreferrer\">https://docs.docker.com/develop/develop-images/#leverage-build-cache</a></p>\n"}], "owner": {"reputation": 195, "user_id": 2042053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8269ce33797e5d4b2fbb726b6e790328?s=128&d=identicon&r=PG", "display_name": "imalison", "link": "https://stackoverflow.com/users/2042053/imalison"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2173, "favorite_count": 2, "answer_count": 3, "score": 2, "last_activity_date": 1574869174, "creation_date": 1524191039, "last_edit_date": 1524280917, "question_id": 49932954, "link": "https://stackoverflow.com/questions/49932954/why-is-the-copy-instruction-causing-a-cache-miss-in-my-docker-build", "title": "Why is the COPY instruction causing a cache miss in my Docker build", "body": "<p>The <a href=\"https://github.com/travitch/taffybar/blob/0392685bcc3622b48c8afbffbf148f7f697f7f1e/Dockerfile#L21\" rel=\"nofollow noreferrer\">copy instruction</a> in the docker file for my project seems to cause a <a href=\"https://travis-ci.org/travitch/taffybar/jobs/368916195#L477\" rel=\"nofollow noreferrer\">cache miss</a>, even though none of the files being copied have changed since the image was last pushed to docker hub. This causes all subsequent layers to miss the cache which makes the build take much longer than it should. I've also noticed that the hashes belonging to each layer seem to be different than what they are when I <code>docker build</code> on my local machine. Could this be because of a docker version mismatch? What is going on here? How can I diagnose this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 4414, "user_id": 5241032, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/056c678e99e8253ad280b230ba30a7fb?s=128&d=identicon&r=PG&f=1", "display_name": "cmaher", "link": "https://stackoverflow.com/users/5241032/cmaher"}, "edited": false, "score": 0, "creation_date": 1524184106, "post_id": 49932042, "comment_id": 86879964, "body": "Try editing your question to make the explanation of your logic more readable; as written it&#39;s very tedious."}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1524184181, "post_id": 49932042, "comment_id": 86879981, "body": "Are you asking how to define a function <code>:: [a] -&gt; ([a], a])</code> that returns both the init and the last element of the list?"}, {"owner": {"reputation": 17, "user_id": 9656078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d15f7db84c3cf1b3f6507a24631283?s=128&d=identicon&r=PG&f=1", "display_name": "Car", "link": "https://stackoverflow.com/users/9656078/car"}, "edited": false, "score": 0, "creation_date": 1524187398, "post_id": 49932042, "comment_id": 86880682, "body": "the program works in a way that it stores a value  then from that value a number is removed using init. Now as we go further into the program other things happen such as doubling elements and adding them. Finally I use mod again after all the doubling and adding etc has been done. I want to Check whether this mod number I have taken is equivalent to that when I originally removed a number earlier in the program. then if the original number that was removed equals the final mod number I want to print true else false"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1524191747, "post_id": 49932042, "comment_id": 86881824, "body": "<code>finalcheck</code> doesn&#39;t have the element it needs. So you need to fix that. Most likely, you should pass it the &quot;removed&quot; element as a separate argument."}], "answers": [{"tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": true, "score": 2, "last_activity_date": 1524195109, "creation_date": 1524195109, "answer_id": 49933527, "question_id": 49932042, "link": "https://stackoverflow.com/questions/49932042/is-it-possible-to-store-a-removed-value-in-haskell/49933527#49933527", "title": "Is it possible to store a removed value in haskell", "body": "<p>Once you remove data, you can't access it again. You need a function that preserves the final checkdigit that you're stripping off.</p>\n\n<p>Since order is (mostly) irrelevant, consider:</p>\n\n<pre><code>validate :: Integer -&gt; Bool\nvalidate x = let digits = toDigits x\n             in  if   checkLength digits\n                 then doesMatch . splitCheckdigit $ digits\n                 else False\n  where\n  toDigits 0 = [0]\n  toDigits x = go x\n    where\n    go 0 = []\n    go x = let (d, m) = x `divMod` 10\n           in  m : toDigits d\n  -- reverses order\n  checkLength x = let l = length x\n                  in  13 &lt;= l &amp;&amp; l &lt;= 16\n  splitCheckdigit (checkdigit:rest) = (checkdigit, rest)\n  -- remember we reversed in toDigits, so the *first* digit is the checkdigit!\n  doesMatch (checkdigit, rest) = let total    = (*9) . sum . reduce $ rest\n                                     shouldBe = total `mod` 10\n                                 in  checkdigit == shouldBe\n    where\n    reduce (x:y:xs) = (sum . toDigits $ x) : y : reduce xs\n    reduce [x]      = [sum . toDigits $ x]\n    reduce []       = []\n    -- note how @toDigits@ is reused here rather than redefined.\n</code></pre>\n\n<p>If you prefer Arrows, <code>validate</code> can be written as:</p>\n\n<pre><code>toDigits &gt;&gt;&gt; ((doesMatch &lt;&lt;&lt; splitCheckdigit) &amp;&amp;&amp; checkLength) &gt;&gt;&gt; uncurry (&amp;&amp;)\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 9656078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8d15f7db84c3cf1b3f6507a24631283?s=128&d=identicon&r=PG&f=1", "display_name": "Car", "link": "https://stackoverflow.com/users/9656078/car"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 49933527, "answer_count": 1, "score": -1, "last_activity_date": 1524195109, "creation_date": 1524183321, "last_edit_date": 1524187153, "question_id": 49932042, "link": "https://stackoverflow.com/questions/49932042/is-it-possible-to-store-a-removed-value-in-haskell", "title": "Is it possible to store a removed value in haskell", "body": "<p>Hi I am new to haskell and I was just wondering whether it was possible to store a value that has already been removed:</p>\n\n<p>This is my code</p>\n\n<pre><code>input :: Integer -&gt; String\ninput x = checklength $ intolist x\n\nintolist 0 = []\nintolist x = intolist (x `div` 10) ++ [x `mod` 10] \n\nchecklength x = if length(x) &gt;= 13 &amp;&amp; length(x) &lt;= 16 then doubleall \n(init(x)) else \"Not valid length of credit card number\" \n\ndoubleall x = finalcheck $ final $ double (reverse (x))\n\ndouble x = case x of\n[]   -&gt; []\n[x]  -&gt; if (x*2 &lt; 10) then [x*2] else [x*2 `div` 10 + x*2 `mod` 10]\nx:y:xs -&gt; (if (x*2 &lt; 10) then [x*2] else [x*2 `div` 10 + x*2 `mod` 10]) ++ \ny:double xs\n\nfinal x = (sum x) * 9\n\nfinalcheck x = if (x `mod` 10 == ...... ) then \"True\" else \"False\"  \n</code></pre>\n\n<p>My code basically takes an input as an integer such as 987564736264535. then makes this integer into a list of number such as [9,8,7..5]. Then it checks the length has to between 13 to 16 digits. If not you get an error statement. If the digits are between the required amount it will go into the doubeall function and remove the last number using (init). <strong>the number removed is 5</strong> in which it will double the numbers and reverse the list order. It will then sum the numbers together and multiple by 9. The final step that I have done part of is taking the last digit of the number that has already been summed together and multiplied by 9. So lets give and example lets say I get 456 then I use mod 10 to take the last number which is 6. **Now here is where I am having a problem in which I want to check whether this 6 is equal to the same number that was removed originally in the checklength function when I used init. So in the checklength function I removed the number 5 **  </p>\n\n<p>Thanks</p>\n"}, {"tags": ["haskell", "operators"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 0, "creation_date": 1524173622, "post_id": 49930500, "comment_id": 86877092, "body": "Write it as <code>a `op` b</code> (note the backticks around <code>op</code>)."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1524173728, "post_id": 49930500, "comment_id": 86877134, "body": "Operators cannot contain alphanumeric characters, see <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch2.html#x7-180002.4\" rel=\"nofollow noreferrer\">the specification.</a>"}], "answers": [{"tags": [], "owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "is_accepted": true, "score": 6, "last_activity_date": 1524182889, "last_edit_date": 1524182889, "creation_date": 1524173688, "answer_id": 49930578, "question_id": 49930500, "link": "https://stackoverflow.com/questions/49930500/operators-in-haskell/49930578#49930578", "title": "Operators in Haskell", "body": "<p>Operators are functions with symbol names. They\u2019re infix by default, and you can use them like other functions by wrapping them in parentheses.</p>\n\n<pre><code>a + b       (+) a b\n</code></pre>\n\n<p>Functions with identifier names, like your <code>op</code>, can be used as infix by wrapping them with <em>backticks</em>.</p>\n\n<pre><code>op a b      a `op` b\n</code></pre>\n\n<p>See also <a href=\"https://wiki.haskell.org/Infix_operator\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Infix_operator</a></p>\n"}], "owner": {"reputation": 11, "user_id": 9152955, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/635806cae3fc3f5365db6f8d92e725d3?s=128&d=identicon&r=PG&f=1", "display_name": "P-A", "link": "https://stackoverflow.com/users/9152955/p-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 74, "favorite_count": 0, "accepted_answer_id": 49930578, "answer_count": 1, "score": 1, "last_activity_date": 1524182889, "creation_date": 1524173282, "question_id": 49930500, "link": "https://stackoverflow.com/questions/49930500/operators-in-haskell", "title": "Operators in Haskell", "body": "<p>I wrote the following function</p>\n\n<pre><code>foldList :: (Double -&gt; Double -&gt; Double) -&gt; [Double] -&gt; Double\nfoldList op (x:t)\n | t == []     = x\n | otherwise   = (op) x (foldList op t)\n</code></pre>\n\n<p>and it worked perfectly fine. But when I changed the last line to </p>\n\n<pre><code>  | otherwise  = x op (foldList op t)\n</code></pre>\n\n<p>it didn't compile anymore. I am still rather new to Haskell but I thought when dealing with operators </p>\n\n<pre><code>a op b\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>(op) a b\n</code></pre>\n\n<p>Do I have to treat <code>op</code> as just a normal function? And if so, in what cases is it regarded an operator and why not here?</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 2, "creation_date": 1524172589, "post_id": 49930349, "comment_id": 86876721, "body": "You&#39;re on the right track. Have you looked at <a href=\"https://www.haskell.org/hoogle/?hoogle=groupBy\" rel=\"nofollow noreferrer\"><code>groupBy</code></a>?"}], "answers": [{"comments": [{"owner": {"reputation": 1096, "user_id": 5021447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-gwPYP717ZyU/AAAAAAAAAAI/AAAAAAAAAP8/WoyhftM4PuU/photo.jpg?sz=128", "display_name": "Jordan Mackie", "link": "https://stackoverflow.com/users/5021447/jordan-mackie"}, "edited": false, "score": 0, "creation_date": 1524235406, "post_id": 49931566, "comment_id": 86904657, "body": "Good answer. I think <code>map (concatMap snd)</code> is clearer than  <code>(map . concatMap) snd</code> though. Sounds picky but it stalled me for a bit."}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 1096, "user_id": 5021447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-gwPYP717ZyU/AAAAAAAAAAI/AAAAAAAAAP8/WoyhftM4PuU/photo.jpg?sz=128", "display_name": "Jordan Mackie", "link": "https://stackoverflow.com/users/5021447/jordan-mackie"}, "edited": false, "score": 0, "creation_date": 1524246088, "post_id": 49931566, "comment_id": 86910706, "body": "@JordanMackie that&#39;s a common Haskell idiom though. <code>f (g x) == (f . g) x</code>"}], "tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": false, "score": 2, "last_activity_date": 1524181628, "last_edit_date": 1524181628, "creation_date": 1524179410, "answer_id": 49931566, "question_id": 49930349, "link": "https://stackoverflow.com/questions/49930349/lists-of-lists-haskell/49931566#49931566", "title": "lists of lists haskell", "body": "<p>using a couple functions from <code>Data.List</code> and <code>Data.Function.on</code> this becomes:</p>\n\n<pre><code>import Data.List     (sortBy, groupBy)\nimport Data.Function (on)\n\nsortByFirst :: Ord a =&gt; [(a, b)] -&gt; [(a, b)]\nsortByFirst = sortBy (compare `on` fst)\n</code></pre>\n\n<p>the <code>groupBy</code> functions expect that the data is sorted, so we must first sort by each inner tuple (i.e. sort by <code>(a, b)</code> in <code>((a, b), [x,y,z])</code>)</p>\n\n<pre><code>groupByFirst :: Eq a =&gt; [(a, b)] -&gt; [[(a, b)]]\ngroupByFirst = groupBy ((==) `on` fst)\n</code></pre>\n\n<p>then we use <code>groupBy</code> to group the resulting list of tuples into <em>lists</em> of lists of tuples, where each inner list shares the same first element.</p>\n\n<pre><code>squishByFirst :: (Eq a, Ord a) =&gt; [(a, b)] -&gt; [[b]]\nsquishByFirst = (map . concatMap) snd . groupByFirst . sortByFirst\n</code></pre>\n\n<p>then we use some fancy mapping over <code>snd</code> to roll into each inner list, pull out the second element (the list), combine them together, and give back the result. This is equivalent to:</p>\n\n<pre><code>squishByFirst xs =\n  let grouped = groupByFirst . sortByFirst $ xs\n  in  [concat [ys | (_, ys) &lt;- g] | g &lt;- grouped]\n</code></pre>\n\n<hr>\n\n<p>You can also implement this as a fold over <code>Map.insertWith</code></p>\n\n<pre><code>import Data.Map (elems, empty, insertWith)\n\nsquishByFirst :: Ord k =&gt; [(k, [v])] -&gt; [[v]]\nsquishByFirst = elems . mkMap\n  where\n  mkMap = foldr (uncurry (insertWith (++))) empty\n</code></pre>\n\n<p>or for any Monoid:</p>\n\n<pre><code>squishByFirst :: (Ord k, Monoid vs) =&gt; [(k, vs)] -&gt; [vs]\nsquishByFirst = elems . mkMap\n  where\n  mkMap = foldr (uncurry (insertWith mappend)) empty\n</code></pre>\n"}], "owner": {"reputation": 7, "user_id": 9616965, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cd799fb5ac5f4d64e36a04f6cfe79be?s=128&d=identicon&r=PG&f=1", "display_name": "Hara", "link": "https://stackoverflow.com/users/9616965/hara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1524181628, "creation_date": 1524172468, "question_id": 49930349, "link": "https://stackoverflow.com/questions/49930349/lists-of-lists-haskell", "title": "lists of lists haskell", "body": "<p>I have a simple question, i am new to Haskell and trying to learn a lot.\nHow can i concatenate for example </p>\n\n<pre><code> [( (0,1) , [1,2,3]) , ((1,2) , [7,8,9]) ,((0,1) , [4,5,6]) ] to [[1,2,3,4,5,6] , [7,8,9]]\n</code></pre>\n\n<p>I want to concatenate the lists that  have first element of the pair equal.\nI tried </p>\n\n<pre><code> map concat list \n\n map (\\t -&gt; (filter (==).first) list ) list \n</code></pre>\n\n<p>but the first one doesn't work and the second one gives an error.\nAny ideas?</p>\n"}, {"tags": ["haskell"], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "closed_date": 1524171072, "answer_count": 0, "score": 1, "last_activity_date": 1524170899, "creation_date": 1524170899, "question_id": 49930013, "link": "https://stackoverflow.com/questions/49930013/are-functions-with-monadio-constraint-less-powerful-than-ones-with-io", "closed_reason": "Duplicate", "title": "Are functions with MonadIO constraint less powerful than ones with IO?", "body": "<p><a href=\"https://www.yesodweb.com/blog/2016/03/why-i-prefer-typeclass-based-libraries\" rel=\"nofollow noreferrer\">There is an interesting claim</a> that <code>MonadIO</code> constraint tells more about the function using it than if it were using <code>IO</code> directly:</p>\n\n<pre><code>foo :: MonadIO m =&gt; m a -&gt; m a\n</code></pre>\n\n<blockquote>\n  <p>Reason: MonadIO requires that the IO be in positive, not negative,\n  position.</p>\n  \n  <p>This lets us know, for example, that foo is safe to use in a\n  continuation-based monad like ContT or Conduit.</p>\n</blockquote>\n\n<p>How does <code>MonadIO</code> enforce this? Is it always the case or is it related to the example?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1524167301, "post_id": 49929102, "comment_id": 86874168, "body": "Is this the way you have indented the program?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524167433, "post_id": 49929102, "comment_id": 86874231, "body": "You need to indent the <code>getNumber</code> (as well as the <code>main</code>) properly. Right know the parser does not see that <code>main</code> is a new function."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1524167463, "post_id": 49929102, "comment_id": 86874241, "body": "You must indent by at least one space..."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524167477, "post_id": 49929102, "comment_id": 86874252, "body": "But regardless of that, it will still not work, since you aim to sort a list of <code>IO Int</code>s? I do not really see why you here perform <code>IO</code> on a list of ``Int`s?"}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1524170569, "post_id": 49929269, "comment_id": 86875796, "body": "You don&#39;t <i>have</i> to indent the contents of a <code>do</code> block, but it helps the parser know when to stop parsing lines as part of the <code>do</code> block. The problem is that the parser thinks that the unindented <code>main = ...</code> is still part of the definition of <code>getNumber</code>."}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 2, "last_activity_date": 1524167911, "creation_date": 1524167911, "answer_id": 49929269, "question_id": 49929102, "link": "https://stackoverflow.com/questions/49929102/haskell-parse-error-on-input-perhaps-you-need-a-let-in-a-do-block-e-g/49929269#49929269", "title": "haskell parse error on input `=&#39; Perhaps you need a &#39;let&#39; in a &#39;do&#39; block? e.g. &#39;let x = 5&#39; instead of &#39;x = 5&#39;", "body": "<p>You must indent all <code>do</code>-blocks:</p>\n\n<pre><code>-- NOT correct: this will fail\nmain = do\nputStrLn \"This is...\"\nputStrLn \"WRONG!\"\n\n-- Correct:\nmain = do\n  putStrLn \"This is...\"\n  putStrLn \"correct!\"\n</code></pre>\n\n<p>The number of spaces doesn't matter as long it is consistent.</p>\n\n<p>To avoid this you could use c-like notation:</p>\n\n<pre><code>-- Also correct:\nmain = do {\nputStrLn \"This is...\";\nputStrLn \"also correct!\";\n}\n</code></pre>\n\n<p>And this leaves you free to indent as you like. Example:</p>\n\n<pre><code>-- Also correct:\nmain = do\n{ putStrLn \"This is...\"\n; putStrLn \"also correct!\"\n;}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 0, "last_activity_date": 1524171237, "creation_date": 1524171237, "answer_id": 49930088, "question_id": 49929102, "link": "https://stackoverflow.com/questions/49929102/haskell-parse-error-on-input-perhaps-you-need-a-let-in-a-do-block-e-g/49930088#49930088", "title": "haskell parse error on input `=&#39; Perhaps you need a &#39;let&#39; in a &#39;do&#39; block? e.g. &#39;let x = 5&#39; instead of &#39;x = 5&#39;", "body": "<p>Without indentation, the parser doesn't know that <code>main = ...</code> starts a new definition, separate from the preceding definition of <code>getNumber</code>. The following would work fine:</p>\n\n<pre><code>getNumber::IO Int\ngetNumber = do\n s &lt;- getLine\n return (read s)\nmain = do\np &lt;- getNumber\nlst &lt;- sequence (getList p)\nprint (sort lst)\n</code></pre>\n\n<p>The transition from one-space indentation to no indentation is enough to tell the parser that <code>return (read s)</code> is the last line of the <code>do</code> block defining <code>getNumber</code>, and that <code>main = do</code> is the beginning of a new top-level definition.</p>\n\n<p>Either indenting your code, or using the explicit brace syntax in AJFarmar's answer, lets the parser know where one definition ends and the next begins.</p>\n"}], "owner": {"reputation": 11, "user_id": 9671707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/331d80a17ce719ba97e8f38cffdfbe42?s=128&d=identicon&r=PG&f=1", "display_name": "Jay Przenkop", "link": "https://stackoverflow.com/users/9671707/jay-przenkop"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3228, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1524171237, "creation_date": 1524167217, "last_edit_date": 1524167283, "question_id": 49929102, "link": "https://stackoverflow.com/questions/49929102/haskell-parse-error-on-input-perhaps-you-need-a-let-in-a-do-block-e-g", "title": "haskell parse error on input `=&#39; Perhaps you need a &#39;let&#39; in a &#39;do&#39; block? e.g. &#39;let x = 5&#39; instead of &#39;x = 5&#39;", "body": "<p>Can't get my haskell program to work</p>\n\n<pre><code>sort [] = []\nsort (x:xs) = sort [a | a &lt;- xs , a&lt;=x ] ++ [x] ++ sort [a | a &lt;- xs , a &gt; x]  \n\ngetList:: Int-&gt;[IO Int]  \ngetList 0 = [] --declaring the empty list\ngetList n = [a | a &lt;- [getNumber] ] ++ getList (n-1)\n\ngetNumber::IO Int --get number function\ngetNumber = do\ns &lt;- getLine\nreturn (read s)\n--Main function to handle\nmain = do\np &lt;- getNumber -- taking the number of variable\nlst &lt;- sequence (getList p) --calling gtlistFunction to input the list\nprint (sort lst) --print\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>quicksort.hs:13:6: error:\n    parse error on input `='\n    Perhaps you need a 'let' in a 'do' block?\n    e.g. 'let x = 5' instead of 'x = 5'\n   |\n13 | main = do\n   |      ^\n</code></pre>\n"}, {"tags": ["haskell", "functor"], "comments": [{"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1524165914, "post_id": 49928654, "comment_id": 86873507, "body": "Why are you asking?"}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 2, "creation_date": 1524165962, "post_id": 49928654, "comment_id": 86873532, "body": "<code>(\\(k, v) -&gt; (k, v))</code> doesn&#39;t do anything. It seems you forgot to use <code>f</code> there."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524166011, "post_id": 49928654, "comment_id": 86873556, "body": "Well the compiler gives an error. Usually that is a good starting point to debug."}, {"owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "edited": false, "score": 0, "creation_date": 1524208451, "post_id": 49928654, "comment_id": 86887577, "body": "You are applying f to k instead of v."}], "answers": [{"comments": [{"owner": {"reputation": 59, "user_id": 4442461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34220c17be521f39e136ffc8b9b4547b?s=128&d=identicon&r=PG&f=1", "display_name": "barnabas markus", "link": "https://stackoverflow.com/users/4442461/barnabas-markus"}, "edited": false, "score": 0, "creation_date": 1524166648, "post_id": 49928910, "comment_id": 86873840, "body": "is it possible to apply the function on the key?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 59, "user_id": 4442461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34220c17be521f39e136ffc8b9b4547b?s=128&d=identicon&r=PG&f=1", "display_name": "barnabas markus", "link": "https://stackoverflow.com/users/4442461/barnabas-markus"}, "edited": false, "score": 0, "creation_date": 1524166704, "post_id": 49928910, "comment_id": 86873871, "body": "@barnabasmarkus: no, since <code>Functor f</code>, expects an <code>f</code> with one type parameter, and here that is the value. You can of course redesign it, and define a <code>Map v k</code>, such that you can <code>fmap</code> on the values, but not the way the <code>Map</code> is currently defined."}, {"owner": {"reputation": 59, "user_id": 4442461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34220c17be521f39e136ffc8b9b4547b?s=128&d=identicon&r=PG&f=1", "display_name": "barnabas markus", "link": "https://stackoverflow.com/users/4442461/barnabas-markus"}, "edited": false, "score": 0, "creation_date": 1524166938, "post_id": 49928910, "comment_id": 86873992, "body": "thanks a lot! that was my original question, but somehow I have made a mistake when I posted here!"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1524166415, "creation_date": 1524166415, "answer_id": 49928910, "question_id": 49928654, "link": "https://stackoverflow.com/questions/49928654/map-data-structure-implementation/49928910#49928910", "title": "Map data structure implementation", "body": "<p>If we compile this, we get the error:</p>\n\n<pre><code>&lt;interactive&gt;:6:21: error:\n    \u2022 Couldn't match type \u2018a1\u2019 with \u2018b\u2019\n      \u2018a1\u2019 is a rigid type variable bound by\n        the type signature for:\n          fmap :: forall a1 b. (a1 -&gt; b) -&gt; Map a a1 -&gt; Map a b\n        at &lt;interactive&gt;:5:3\n      \u2018b\u2019 is a rigid type variable bound by\n        the type signature for:\n          fmap :: forall a1 b. (a1 -&gt; b) -&gt; Map a a1 -&gt; Map a b\n        at &lt;interactive&gt;:5:3\n      Expected type: Map a b\n        Actual type: Map a a1\n    \u2022 In the expression: Map xs'\n      In an equation for \u2018fmap\u2019:\n          fmap f (Map xs)\n            = Map xs'\n            where\n                xs' = map (\\ (k, v) -&gt; (k, v)) xs\n      In the instance declaration for \u2018Functor (Map a)\u2019\n    \u2022 Relevant bindings include\n        xs' :: [(a, a1)] (bound at &lt;interactive&gt;:7:11)\n        xs :: [(a, a1)] (bound at &lt;interactive&gt;:6:15)\n        f :: a1 -&gt; b (bound at &lt;interactive&gt;:6:8)\n        fmap :: (a1 -&gt; b) -&gt; Map a a1 -&gt; Map a b\n          (bound at &lt;interactive&gt;:5:3)\n</code></pre>\n\n<p>The error actually is a good starting point: it says that your <code>fmap</code> should have signature:</p>\n\n<pre><code>fmap :: forall a1 b. (a1 -&gt; b) -&gt; Map a a1 -&gt; Map a b\n</code></pre>\n\n<p>but apparently your output type is <code>Map a a1</code>, so you did not met these contracts. If we further investigate, we see that <code>map (\\(k, v) -&gt; (k, v)) xs</code> actually does not do much (except repacking the data in a <em>new</em> tuple). The output tuple should have type <code>(a, b)</code> instead of <code>(a, a1)</code> (<code>a1</code> being the original type of the <em>values</em> in the <code>Map</code>).</p>\n\n<p>We thus should apply <code>f</code> on the value, like:</p>\n\n<pre><code>instance Functor (Map a) where\n  fmap _ (Map []) = Map []\n  fmap f (Map xs) = Map xs'\n    where xs' = map (\\(k, v) -&gt; (k, <b>f</b> v)) xs</code></pre>\n\n<p>or in a more clean way:</p>\n\n<pre><code>instance Functor (Map a) where\n  fmap f (Map xs) = Map <b>(fmap (fmap f) xs)</b></code></pre>\n\n<p>Note that you do not need to implement two separate cases here (one for an empty and one for a non-empty list), since a <code>map</code> (or <code>fmap</code>) on an empty list is an empty list.</p>\n"}], "owner": {"reputation": 59, "user_id": 4442461, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34220c17be521f39e136ffc8b9b4547b?s=128&d=identicon&r=PG&f=1", "display_name": "barnabas markus", "link": "https://stackoverflow.com/users/4442461/barnabas-markus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 49928910, "answer_count": 1, "score": -1, "last_activity_date": 1524168780, "creation_date": 1524165445, "last_edit_date": 1524168780, "question_id": 49928654, "link": "https://stackoverflow.com/questions/49928654/map-data-structure-implementation", "title": "Map data structure implementation", "body": "<p>What's the problem w this <code>Functor</code> instance?</p>\n\n<pre><code>data Map k v = Map [(k, v)] deriving (Show, Eq)\n\ninstance Functor (Map a) where\n  fmap _ (Map []) = Map []\n  fmap f (Map xs) = Map xs'\n    where xs' = map (\\(k, v) -&gt; (f k, v)) xs\n</code></pre>\n"}, {"tags": ["list", "haskell", "functional-programming", "tuples"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524157952, "post_id": 49926594, "comment_id": 86869252, "body": "Perhaps you better first aim to solve it without counting. How would you implement such &quot;erasure&quot; function that only returns the list?"}, {"owner": {"reputation": 105, "user_id": 7028615, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/ji4FV.jpg?s=128&g=1", "display_name": "Frank Ponte", "link": "https://stackoverflow.com/users/7028615/frank-ponte"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524158048, "post_id": 49926594, "comment_id": 86869298, "body": "I already did what you&#39;re suggesting, but i&#39;m now trying to &quot;merge&quot; both problems in a single one and i just can&#39;t."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524158086, "post_id": 49926594, "comment_id": 86869315, "body": "is it possible to show an implementation? I think it will probably result in a better answer by showing how we can <i>alter</i> the previous function."}, {"owner": {"reputation": 105, "user_id": 7028615, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/ji4FV.jpg?s=128&g=1", "display_name": "Frank Ponte", "link": "https://stackoverflow.com/users/7028615/frank-ponte"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1524158294, "post_id": 49926594, "comment_id": 86869432, "body": "Of course, Willem. I&#39;ve just added both implementations"}], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 7028615, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/ji4FV.jpg?s=128&g=1", "display_name": "Frank Ponte", "link": "https://stackoverflow.com/users/7028615/frank-ponte"}, "edited": false, "score": 3, "creation_date": 1524158726, "post_id": 49926764, "comment_id": 86869661, "body": "Excellent answer, very didactical and it totally helped me. I&#39;m excited about learning more of this programming language, it&#39;s a very different approach if we compare with PL like C, Java, etc. Thank you, Willem. I probably will be around again to keep asking and learning from the best! Keep rockin, buddy!"}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 5, "last_activity_date": 1524159365, "last_edit_date": 1524159365, "creation_date": 1524158380, "answer_id": 49926764, "question_id": 49926594, "link": "https://stackoverflow.com/questions/49926594/list-to-tuple-counting-values-repeated-and-the-list-inside-the-tuple-haskell/49926764#49926764", "title": "List to tuple counting values repeated and the list inside the tuple - Haskell", "body": "<p>Usually it helps to think of functions like in mathematics you think about <em>inductive definitions</em>. For example the first line of your function can read like:</p>\n\n<p>\"<em>The <code>ex3</code> of an empty list, and any element is a tuple containing the empty list and zero</em>\"</p>\n\n<pre><code>ex3 [] _ = ([], 0)\n</code></pre>\n\n<p>For non-empty lists of course the problem is a bit harder. Like in your code, there are basically two cases here.</p>\n\n<p>\"<em>The <code>ex3</code> of a non-empty list and an element <code>z</code> where the head of the list is</em> not <em>equal to <code>z</code> is the same as the <code>ex3</code> of the</em> tail <em>of the list</em>, but prepended with the head of that list\", so we can write it like:</p>\n\n<pre><code>ex3 [] _ = ([], 0)\nex3 (x:xs) z | x /= z = (x:t, n)\n             | otherwise = ...\n    where (t, n) = ex3 xs z\n</code></pre>\n\n<p>So here we make a recursive call to <code>ex3</code> with the tail of the list <code>xs</code>, and we obtain the result tuple <code>(t, n)</code>, so <code>t</code> contains the \"erased\" tail, and <code>n</code> the number of times we removed the element, and in case <code>x /= z</code>, then we can return <code>(x:t, n)</code>, since the number of removals does not change, but we have to prepend <code>x</code> to the list.</p>\n\n<p>\"<em>The <code>ex3</code> of a non-empty list and an element <code>z</code> where the head of the list is equal to <code>z</code> is the same as the <code>ex3</code> of the</em> tail <em>of the list but with an incremented count</em>\", so:</p>\n\n<pre><code>ex3 :: (Eq a, Num n) =&gt; [a] -&gt; a -&gt; ([a], n)\nex3 [] _ = ([], 0)\nex3 (x:xs) z | x /= z = (x:t, n)\n             | otherwise = (t, n+1)\n    where (t, n) = ex3 xs z\n</code></pre>\n\n<p>We then obtain the expected results:</p>\n\n<pre><code>Prelude&gt; ex3 [2,3,4,2,2] 2\n([3,4],3)\nPrelude&gt; ex3 [1,1,1,1] 1\n([],4)\nPrelude&gt; ex3 [1,2,3,4] 5\n([1,2,3,4],0)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1524159573, "post_id": 49927033, "comment_id": 86870126, "body": "You&#39;re slightly cheating with that <code>Sum Int</code> in your result type. :-) But very neat code."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1524159845, "post_id": 49927033, "comment_id": 86870278, "body": "@melpomene Okay. No cheating now."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1524160090, "post_id": 49927033, "comment_id": 86870408, "body": "Yeah, now you&#39;re using the <code>Functor</code> instance of <code>(,) a</code>, which is probably another hurdle for beginners. But you did say you were answering for fun and I would totally do the same thing, so there&#39;s nothing left to nitpick. Well played. :-)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1524162481, "post_id": 49927033, "comment_id": 86871648, "body": "35% fewer tokens than the competition!"}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "edited": false, "score": 0, "creation_date": 1524164506, "post_id": 49927033, "comment_id": 86872748, "body": "This answer requires you know the default Monoid for <code>(a, b)</code>, too (which caused me to go look that up, so now I know that woohoo! :D)"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 3, "last_activity_date": 1524159833, "last_edit_date": 1524159833, "creation_date": 1524159411, "answer_id": 49927033, "question_id": 49926594, "link": "https://stackoverflow.com/questions/49926594/list-to-tuple-counting-values-repeated-and-the-list-inside-the-tuple-haskell/49927033#49927033", "title": "List to tuple counting values repeated and the list inside the tuple - Haskell", "body": "<p>Just for fun, this is how I would implement that function:</p>\n\n<pre><code>import Data.Foldable\nimport Data.Monoid\n\nex3 :: Eq a =&gt; [a] -&gt; a -&gt; ([a], Int)\nex3 haystack needle = getSum &lt;$&gt; foldMap inject haystack where\n    inject hay | hay == needle = ([], 1)\n               | otherwise     = ([hay], 0)\n</code></pre>\n\n<p>What I like about this is that the recursion pattern is immediately obvious -- at least to those familiar with Haskell's standard library -- without careful scrutiny (because it is just a call to <code>foldMap</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 181, "user_id": 3511511, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f695d53cc3acd300a9e119b40c9d7ac?s=128&d=identicon&r=PG", "display_name": "user12457", "link": "https://stackoverflow.com/users/3511511/user12457"}, "is_accepted": false, "score": 0, "last_activity_date": 1524203206, "creation_date": 1524203206, "answer_id": 49934808, "question_id": 49926594, "link": "https://stackoverflow.com/questions/49926594/list-to-tuple-counting-values-repeated-and-the-list-inside-the-tuple-haskell/49934808#49934808", "title": "List to tuple counting values repeated and the list inside the tuple - Haskell", "body": "<p>The partition function consumes a predicate and a list; it produces a pair of lists whose first element satisfies the predicate, the second doesn't.</p>\n\n<pre><code>import Data.List (partition)\n\nex4 :: Eq a =&gt; [a] -&gt; a -&gt; ([a], Int)\nex4 xs x = length &lt;$&gt; partition (/= x) xs\n</code></pre>\n"}], "owner": {"reputation": 105, "user_id": 7028615, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/ji4FV.jpg?s=128&g=1", "display_name": "Frank Ponte", "link": "https://stackoverflow.com/users/7028615/frank-ponte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 430, "favorite_count": 0, "accepted_answer_id": 49926764, "answer_count": 3, "score": 2, "last_activity_date": 1524203206, "creation_date": 1524157721, "last_edit_date": 1524158492, "question_id": 49926594, "link": "https://stackoverflow.com/questions/49926594/list-to-tuple-counting-values-repeated-and-the-list-inside-the-tuple-haskell", "title": "List to tuple counting values repeated and the list inside the tuple - Haskell", "body": "<p>im learning functional programming with Haskell and i have this exercise where i have something like <code>[a], z</code>, with <code>[a]</code> any kind of list and <code>z</code> the element that im gonna erase inside <code>[a]</code>. This problem it's kinda easy to solve (even for a newbie like me in Haskell) but I am having troubles with the way I need to print the output.</p>\n\n<p>I need to create a <strong>tuple</strong> where the first element is the list without any <code>z</code> element and the number of times that it found <code>z</code> inside of <code>a</code>. Couple examples:</p>\n\n<ul>\n<li>Input: <code>[2,3,4,2,2] 2</code></li>\n<li><p>Output: <code>([3,4],3)</code></p></li>\n<li><p>Input: <code>[1,1,1,1] 1</code></p></li>\n<li><p>Output: <code>([],4)</code></p></li>\n<li><p>Input: <code>[1,2,3,4] 5</code></p></li>\n<li>Output: <code>([1,2,3,4],0)</code></li>\n</ul>\n\n<p>So far i've done something like this but I don't know how to keep going:</p>\n\n<pre><code>ex3 :: (Eq a, Num a) =&gt; [a] -&gt; a -&gt; ([a],Int)\nex3 [] _ = ([],0)\nex3 (x:xs) z | x == z = (xs,1) -- this line is wrong, but idk how to fix it\n             | otherwise = ([0],0) -- same here\n</code></pre>\n\n<p>I've done both problems individually (deleting <code>z</code> elements and counting how many times <code>z</code> is in <code>[a]</code>. Looks like this:</p>\n\n<p>a) Deleting <code>z</code> elements:</p>\n\n<pre><code>ex3a :: (Eq a) =&gt; [a] -&gt; a -&gt; [a]\nex3a [] _ = []\nex3a (x:xs) z | x == z = ex3a xs z\n              | otherwise = x : ex3a xs z\n</code></pre>\n\n<p>b) Counting how many times <code>z</code> is in <code>[a]</code>:</p>\n\n<pre><code>ex3b :: (Eq a) =&gt; [a] -&gt; a -&gt; Int\nex3b [] _ = 0\nex3b (x:xs) z | x == z = 1 + ex3b xs z\n              | otherwise = ex3b xs z\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1524155949, "post_id": 49926099, "comment_id": 86868140, "body": "Well syntax highlighting here already revelals one of the issues. But there are some other issues, for example, it can not process an infinite list at all (unless it only contains duplicates, but then it will keep searching for the first non-duplicate)."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1524156008, "post_id": 49926099, "comment_id": 86868173, "body": "What is <code>A</code> supposed to be here? Of course the compiler doesn&#39;t know what you&#39;re talking about, if <code>A</code> isn&#39;t defined!"}, {"owner": {"reputation": 13, "user_id": 9670991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/054dd5f4f92958ed669ed4a5633f38d6?s=128&d=identicon&r=PG&f=1", "display_name": "Islam Nasr", "link": "https://stackoverflow.com/users/9670991/islam-nasr"}, "edited": false, "score": 0, "creation_date": 1524156079, "post_id": 49926099, "comment_id": 86868213, "body": "Then how can I edit the code if i want it to work for a list like the one above"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1524156129, "post_id": 49926099, "comment_id": 86868236, "body": "@IslamNasr Define <code>A</code>, or remove it. I don&#39;t know what you want it to be, but you probably want this line: <code>data A = A String deriving (Eq, Show)</code>."}, {"owner": {"reputation": 13, "user_id": 9670991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/054dd5f4f92958ed669ed4a5633f38d6?s=128&d=identicon&r=PG&f=1", "display_name": "Islam Nasr", "link": "https://stackoverflow.com/users/9670991/islam-nasr"}, "edited": false, "score": 0, "creation_date": 1524156316, "post_id": 49926099, "comment_id": 86868354, "body": "@AJFarmer ill try it now"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1524156348, "post_id": 49926099, "comment_id": 86868372, "body": "@IslamNasr You still haven&#39;t answered  though - what is <code>A</code> meant to be?"}, {"owner": {"reputation": 13, "user_id": 9670991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/054dd5f4f92958ed669ed4a5633f38d6?s=128&d=identicon&r=PG&f=1", "display_name": "Islam Nasr", "link": "https://stackoverflow.com/users/9670991/islam-nasr"}, "edited": false, "score": 0, "creation_date": 1524156836, "post_id": 49926099, "comment_id": 86868651, "body": "It is a letter the project description didn&#39;t specify what is it"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1524156405, "creation_date": 1524156405, "answer_id": 49926260, "question_id": 49926099, "link": "https://stackoverflow.com/questions/49926099/haskell-list-remove-duplicates-doesnt-work-completely-correctly/49926260#49926260", "title": "Haskell list remove duplicates doesn&#39;t work completely correctly", "body": "<p>The issue here is not per se the function itself, but the input list:</p>\n\n<pre><code>remove [ A \"List\", A \"List\", A \"Gone\", A \"Still\"]\n</code></pre>\n\n<p>It contains a list of elements, each element has the <em>data constructor</em> <code>A</code> followed by a string. In some languages like Prolog, one can dynamically introduce functors, but not in Haskell: Haskell is statically typed, and as a result you need to declare the types. We can for instance declare the type:</p>\n\n<pre><code>data A = A String deriving (Eq, Show)\n</code></pre>\n\n<p>Now we declared a type <code>A</code>, where there is a single data constructor <code>A</code> that takes as parameter a <code>String</code>. We made it <code>deriving (Eq, Show)</code>, such that two <code>A</code>s are equal, given they have the same data constructor (but since there is only one, this is always the case), as well as the fact that the parameter should be the same. The <code>Show</code> enables us to print <code>A</code> instances.</p>\n\n<p>So now it will at least produce output (not generate a compiler error). But the function itself still has a potential problem: here you check membership in the <em>tail</em> of ther list. There can be two problems with that:</p>\n\n<ol>\n<li>we will always keep the <em>last</em> occurrence, so <code>remove [1, 4, 1, 2]</code> will return <code>[4, 1, 2]</code>, whereas we probably want to return <code>[1, 4, 2]</code>; and</li>\n<li>in case we process an infinite list, then for non-duplicate elements, <code>elem</code>, will keep looking for a duplicate. As a result eventually Haskell will run out of memory and crash.</li>\n</ol>\n\n<p>We better use an accumulator here that stores the elements thus far observed, and call <code>elem</code> on that list, like:</p>\n\n<pre><code>remove :: Eq a =&gt; [a] -&gt; [a]\nremove = go []\n    where go _ [] = []\n          go seen (x:xs) | elem x seen = go seen xs\n                         | otherwise = x : go (x:seen) xs\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 9670991, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/054dd5f4f92958ed669ed4a5633f38d6?s=128&d=identicon&r=PG&f=1", "display_name": "Islam Nasr", "link": "https://stackoverflow.com/users/9670991/islam-nasr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 49926260, "answer_count": 1, "score": 1, "last_activity_date": 1524156405, "creation_date": 1524155851, "last_edit_date": 1524155960, "question_id": 49926099, "link": "https://stackoverflow.com/questions/49926099/haskell-list-remove-duplicates-doesnt-work-completely-correctly", "title": "Haskell list remove duplicates doesn&#39;t work completely correctly", "body": "<p>I made this code for removing common elements in a list but it only worked for integers list i have an example for </p>\n\n<pre><code>remove [ A \"List\", A \"List\", A \"Gone\", A \"Still\"]\n</code></pre>\n\n<p>it must give as an output <code>[ A \"List\", A \"Gone\", A \"Still\"]</code>\nit doesn't work gives an undefined constructor A</p>\n\n<pre><code>remove [] = []\nremove (x:xs) | x `elem` xs = remove xs\n              | otherwise = x : remove xs\n</code></pre>\n"}, {"tags": ["haskell", "pattern-matching"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1524148804, "post_id": 49923805, "comment_id": 86863489, "body": "But <code>y</code> here is <i>an</i> element of the list, regardless of the data constructor."}, {"owner": {"reputation": 789, "user_id": 8120642, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OX8-_3nAbeE/AAAAAAAAAAI/AAAAAAAAAAA/of7PUZBmbk4/photo.jpg?sz=128", "display_name": "hegel5000", "link": "https://stackoverflow.com/users/8120642/hegel5000"}, "edited": false, "score": 1, "creation_date": 1524148982, "post_id": 49923805, "comment_id": 86863612, "body": "I just wanna get this out there: by definition, if they&#39;re all in the same list, then they&#39;re all of the same type.  What you&#39;re doing is matching on different data constructors for the same type."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1524149305, "post_id": 49923805, "comment_id": 86863826, "body": "After rereading the question, I have the idea that with <code>y</code>, you want to specify zero or more elements of the list. This is impossible, since Haskell actually has no special understanding of lists (at least not syntactically), it only looks at the data constructors."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 4, "creation_date": 1524149543, "post_id": 49923805, "comment_id": 86864014, "body": "You can&#39;t use pattern matching to skip over an arbitrary portion of a list. You can pattern match on <code>Circle r1 : rest</code> and then scan over <code>rest</code> trying to find another circle. For that you can define a custom recursive function taking <code>rest</code> as an argument."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1524151692, "post_id": 49924676, "comment_id": 86865547, "body": "Hm. After rereading the question... whether I would do this or not depends a bit on what exactly you are meaning to do. This is what I would do if I wanted to swap the first two circles. If I wanted to swap the first element with the next element that had the same constructor, I&#39;d do something different (though similar)."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 2, "last_activity_date": 1524151174, "creation_date": 1524151174, "answer_id": 49924676, "question_id": 49923805, "link": "https://stackoverflow.com/questions/49923805/pattern-matching-multiple-elements-in-haskell/49924676#49924676", "title": "Pattern matching multiple elements in Haskell", "body": "<p>I would use the <a href=\"http://hackage.haskell.org/package/split-0.2.3.3/docs/Data-List-Split.html\" rel=\"nofollow noreferrer\">split</a> package, using <code>Circle</code>s as delimiters. There are two interesting cases: either the list begins with a <code>Circle</code>, in which case the first two delimiters will be at the start of the first two lists in the split, or the list does not begin with a <code>Circle</code>, in which case the first two delimiters will be at the start of the second and third elements in the split.</p>\n\n<pre><code>import Data.List.Split\n\nisCircle (Circle _) = True\nisCircle _ = False\n\nswap shapes = case split (keepDelimsL $ whenElt isCircle) shapes of\n    (c@(Circle _):ss):(c':ss'):sss -&gt; concat $ (c':ss):(c:ss):sss\n    ss:(c:ss'):(c':ss''):sss -&gt; concat $ ss:(c':ss'):(c:ss''):sss\n    _ -&gt; shapes -- what if there aren't two circles?\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": false, "score": 2, "last_activity_date": 1524154880, "creation_date": 1524154880, "answer_id": 49925857, "question_id": 49923805, "link": "https://stackoverflow.com/questions/49923805/pattern-matching-multiple-elements-in-haskell/49925857#49925857", "title": "Pattern matching multiple elements in Haskell", "body": "<p>Per Daniel Wagner's comment on his answer:</p>\n\n<blockquote>\n  <p>If I wanted to swap the first element with the next element that had the same constructor, I'd do something different</p>\n</blockquote>\n\n<p>I thought I'd answer that question too, since the posted question is ambiguous in this regard. I'd write a function that tests equality by constructor, e.g.:</p>\n\n<pre><code>-- from your code somewhere, however this is defined\ndata Shape a = Circle a\n             | Square a\n             | Rectangle a a\n             | EquilTriangle a\n\nsameShape :: Shape a -&gt; Shape a -&gt; Bool\nsameShape (Circle _) (Circle _)               = True\nsameShape (Square _) (Square _)               = True\nsameShape (Rectangle _ _) (Rectangle _ _)     = True\nsameShape (EquilTriangle _) (EquilTriangle _) = True\nsameShape _ _                                 = False\n</code></pre>\n\n<p>then pull out the head of the list as <code>x</code>, <code>break</code> on <code>sameShape x</code>, and reassemble the list from there.</p>\n\n<pre><code>swapHeadWithSameConstructor :: [Shape a] -&gt; [Shape a]\nswapHeadWithSameConstructor xss@(x:xs) =\n  let (xs', ys) = break (sameShape x) xs\n  in  case ys of\n        (y:ys') -&gt; y : xs' ++ x : ys'\n        []      -&gt; xss  -- if there's no element to swap, change nothing\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 9670411, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/234ae6cc29f1dac31053d7cdf167553f?s=128&d=identicon&r=PG&f=1", "display_name": "T. Swiz", "link": "https://stackoverflow.com/users/9670411/t-swiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1048, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1524154880, "creation_date": 1524148704, "question_id": 49923805, "link": "https://stackoverflow.com/questions/49923805/pattern-matching-multiple-elements-in-haskell", "title": "Pattern matching multiple elements in Haskell", "body": "<p>If I had for example a list of types:</p>\n\n<pre><code>[Circle r, Square s, Rectangle w d, Equil.Triangle t, Circle r, Rectangle wd]\n</code></pre>\n\n<p>I want to swap two elements of the same type in a list.\nI tried for example pattern matching like:</p>\n\n<pre><code>swap (Circle r1:y:Circle r2:xs) = (Circle r2:y:Circle r1:xs)\n</code></pre>\n\n<p>Is there any way to match one or more elements with <em>y</em> or is there another preferred method?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["haskell", "hlist"], "answers": [{"tags": [], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "is_accepted": true, "score": 3, "last_activity_date": 1524145337, "creation_date": 1524145337, "answer_id": 49922641, "question_id": 49920911, "link": "https://stackoverflow.com/questions/49920911/why-is-an-instance-not-picked/49922641#49922641", "title": "Why is an instance not picked?", "body": "<p>Well, it's saying there's no such instance because there is no such instance.  The instance head you're expecting to match does not match.</p>\n\n<pre><code>HasRecipeCase False target ((Recipe effect target deps)      ': leftoverPot)`\nHasRecipeCase False M4     ((Recipe IO     M1     '[M2, M3]) ': '[Recipe IO M2 '[], Recipe IO M3 '[M4], Recipe IO M4 '[]]`\n</code></pre>\n\n<p>Those don't match, because the instance head requires <code>target</code> to be the same type everywhere to match. But you are attempting to use that instance with <code>target</code> as <code>M1</code> in one location and <code>M4</code> in another.</p>\n"}], "owner": {"reputation": 20350, "user_id": 411944, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/7bf057b98d0652db34842d1817234853?s=128&d=identicon&r=PG", "display_name": "Reactormonk", "link": "https://stackoverflow.com/users/411944/reactormonk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 49922641, "answer_count": 1, "score": 0, "last_activity_date": 1524145337, "creation_date": 1524140188, "question_id": 49920911, "link": "https://stackoverflow.com/questions/49920911/why-is-an-instance-not-picked", "title": "Why is an instance not picked?", "body": "<p>This is an iteration over <a href=\"https://stackoverflow.com/questions/49903372/type-variables-in-context-not-fixed?noredirect=1#comment86825131_49903372\">Type variables in context not fixed?</a> with associated types.</p>\n\n<p>Im' getting the following error message, but I can't figure out why exactly the <code>HasRecipeCase False</code> instance isn't selected - all the other fields (besides the <code>False</code>) should be generic enough so it can pick that instance.</p>\n\n<pre><code>script.hs:126:6: error:\n    \u2022 No instance for (HasRecipeCase\n                         'False\n                         M4\n                         '[Recipe IO M1 '[M2, M3], Recipe IO M2 '[], Recipe IO M3 '[M4],\n                           Recipe IO M4 '[]])\n        arising from a use of \u2018cook\u2019\n    \u2022 In the expression: cook cookbook1 :: IO M4\n      In an equation for \u2018c1\u2019: c1 = cook cookbook1 :: IO M4\n    |\n126 | c1 = cook cookbook1 :: IO M4\n    |      ^^^^^^^^^^^^^^\n</code></pre>\n\n<p>Script:</p>\n\n<pre><code>#!/usr/bin/env stack\n-- stack --resolver lts-11.4 --install-ghc runghc\n{-# LANGUAGE ScopedTypeVariables #-}\n{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE TypeOperators #-}\n{-# LANGUAGE MultiParamTypeClasses #-}\n{-# LANGUAGE FunctionalDependencies #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE UndecidableInstances #-}\n{-# LANGUAGE StandaloneDeriving #-}\n{-# LANGUAGE PolyKinds #-}\n\nimport Data.Proxy\n\nclass HEq (x :: k) (y :: k) (b :: Bool) | x y -&gt; b\ninstance {-# OVERLAPPING #-} HEq x x True\ninstance {-# OVERLAPPABLE  #-} False ~ b =&gt; HEq x y b\n\ndata family HList (l::[*])\n\ndata instance HList '[] = HNil\ndata instance HList (x ': xs) = x `HCons` HList xs\n\nderiving instance Eq (HList '[])\nderiving instance (Eq x, Eq (HList xs)) =&gt; Eq (HList (x ': xs))\n\nderiving instance Ord (HList '[])\nderiving instance (Ord x, Ord (HList xs)) =&gt; Ord (HList (x ': xs))\n\nderiving instance Bounded (HList '[])\nderiving instance (Bounded x, Bounded (HList xs)) =&gt; Bounded (HList (x ': xs))\n\nclass HExtend e l where\n  type HExtendR e l\n  (.*.) :: e -&gt; l -&gt; HExtendR e l\n\ninfixr 2 .*.\n\ninstance HExtend e (HList l) where\n  type HExtendR e (HList l) = HList (e ': l)\n  (.*.) = HCons\n\nmain = pure ()\n\n\nnewtype Recipe effect target (deps :: [*]) = Recipe { runRecipe :: HList deps -&gt; effect target }\n\nclass DefaultRecipe target where\n  def :: Recipe target deps effect\n\ntype family Foo\n\nclass CanCook target (pot :: [*]) where\n  type CDeps pot target :: [*]\n  cook :: HList pot -&gt; (PotEffect pot) target\n\ninstance (HasRecipe target pot, SubSelect pot (CDeps pot target)) =&gt; CanCook target pot where\n  type CDeps pot target = RDeps pot target\n  cook pot =\n    let\n      deps :: HList deps\n      deps = subselect pot\n      r :: Recipe (PotEffect pot) target (CDeps pot target)\n      r = recipe pot\n    in\n      runRecipe r $ deps\n\ntype family PotEffect (pot :: [*]) :: * -&gt; *\ntype instance PotEffect (Recipe effect _ _ ': '[]) = effect\ntype instance PotEffect (Recipe effect _ _ ': Recipe effect _ _ ': '[]) = effect\ntype instance PotEffect (Recipe effect _ _ ': Recipe effect _ _ ': Recipe effect _ _ ': '[]) = effect\ntype instance PotEffect (Recipe effect _ _ ': Recipe effect _ _ ': Recipe effect _ _ ': Recipe effect _ _ ': '[]) = effect\ntype instance PotEffect (Recipe effect _ _ ': Recipe effect _ _ ': Recipe effect _ _ ': Recipe effect _ _ ': Recipe effect _ _ ': '[]) = effect\n\nclass HasRecipe target (pot :: [*]) where\n  type RDeps pot target :: [*]\n  recipe :: HList pot -&gt; Recipe (PotEffect pot) target (RDeps pot target)\n\nclass SubSelect (pot :: [*]) (deps :: [*]) where\n  subselect :: HList pot -&gt; HList deps\n\ninstance SubSelect p d where\n  subselect = undefined\n\nclass HasRecipeCase (b :: Bool) (target :: *) (pot :: [*]) where\n  type RCDeps b target pot :: [*]\n  recipeCase :: Proxy b -&gt; Proxy target -&gt; HList pot -&gt; Recipe (PotEffect pot) target (RCDeps b target pot)\n\ninstance (PotEffect ((Recipe effect target deps) ': leftoverPot) ~ effect) =&gt; HasRecipeCase True target ((Recipe effect target deps) ': leftoverPot) where\n  type RCDeps True target ((Recipe effect target deps) ': leftoverPot) = deps\n  recipeCase _ _ (HCons head _) = head\n\ninstance (HasRecipe target leftoverPot, PotEffect ((Recipe effect target deps) ': leftoverPot) ~ effect, PotEffect leftoverPot ~ effect) =&gt;\n  HasRecipeCase False target ((Recipe effect target deps) ': leftoverPot) where\n  type RCDeps False target ((Recipe effect target deps) ': leftoverPot) = RDeps leftoverPot target\n  recipeCase _ _ (HCons _ tail) = recipe tail\n\ninstance (HEq target t bool, HasRecipeCase bool target pot , pot ~ ((Recipe effect t deps) ': leftoverPot)) =&gt;\n  HasRecipe target ((Recipe effect t deps) ': leftoverPot) where\n  recipe = undefined\n\nnewtype M1 = M1 ()\nnewtype M2 = M2 ()\nnewtype M3 = M3 ()\nnewtype M4 = M4 ()\n\nr1 :: Recipe IO M1 '[M2, M3]\nr1 = undefined\n\nr2 :: Recipe IO M2 '[]\nr2 = undefined\n\nr3 :: Recipe IO M3 '[M4]\nr3 = undefined\n\nr4 :: Recipe IO M4 '[]\nr4 = undefined\n\ncookbook1 = r1 .*. r2 .*. r3 .*. r4 .*. HNil\n\ncookbook2 = r3 .*. r4 .*. r2 .*. r1 .*. HNil\n\nc1 = cook cookbook1 :: IO M4\n-- c2 = cook cookbook2 :: IO M4\n</code></pre>\n"}, {"tags": ["json", "haskell", "aeson"], "comments": [{"owner": {"reputation": 1096, "user_id": 5021447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-gwPYP717ZyU/AAAAAAAAAAI/AAAAAAAAAP8/WoyhftM4PuU/photo.jpg?sz=128", "display_name": "Jordan Mackie", "link": "https://stackoverflow.com/users/5021447/jordan-mackie"}, "edited": false, "score": 1, "creation_date": 1524127206, "post_id": 49916272, "comment_id": 86848316, "body": "You probably want to define your own <code>FromJSON</code> instance here. If you want an example of how to do that you should really provide a sample of <code>&quot;path&#47;to&#47;json&quot;</code>"}, {"owner": {"reputation": 15, "user_id": 9668463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4938143bdc9381e78c23eb79b0f6ee7?s=128&d=identicon&r=PG", "display_name": "Orbit", "link": "https://stackoverflow.com/users/9668463/orbit"}, "reply_to_user": {"reputation": 1096, "user_id": 5021447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-gwPYP717ZyU/AAAAAAAAAAI/AAAAAAAAAP8/WoyhftM4PuU/photo.jpg?sz=128", "display_name": "Jordan Mackie", "link": "https://stackoverflow.com/users/5021447/jordan-mackie"}, "edited": false, "score": 0, "creation_date": 1524127476, "post_id": 49916272, "comment_id": 86848480, "body": "Its there at the beginning, I&#39;ll edit to make it clearer."}, {"owner": {"reputation": 1096, "user_id": 5021447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-gwPYP717ZyU/AAAAAAAAAAI/AAAAAAAAAP8/WoyhftM4PuU/photo.jpg?sz=128", "display_name": "Jordan Mackie", "link": "https://stackoverflow.com/users/5021447/jordan-mackie"}, "edited": false, "score": 0, "creation_date": 1524129256, "post_id": 49916272, "comment_id": 86849596, "body": "<code>&quot;stringA1&quot;:floatA1</code> isn&#39;t valid json. Presumably this should be <code>&quot;stringA1&quot;:0.0</code> or something?"}, {"owner": {"reputation": 15, "user_id": 9668463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4938143bdc9381e78c23eb79b0f6ee7?s=128&d=identicon&r=PG", "display_name": "Orbit", "link": "https://stackoverflow.com/users/9668463/orbit"}, "reply_to_user": {"reputation": 1096, "user_id": 5021447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-gwPYP717ZyU/AAAAAAAAAAI/AAAAAAAAAP8/WoyhftM4PuU/photo.jpg?sz=128", "display_name": "Jordan Mackie", "link": "https://stackoverflow.com/users/5021447/jordan-mackie"}, "edited": false, "score": 0, "creation_date": 1524129533, "post_id": 49916272, "comment_id": 86849784, "body": "Sorry, yes should have made this clear too, floatX1 are actually strings like &quot;0.238238273827&quot; but it should really end up being a floats in the end."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1524130456, "post_id": 49916272, "comment_id": 86850497, "body": "Why do you have them as <i>strings</i> in the JSON file? why not <code>&quot;stringA1&quot;: 0.238238273827</code>?"}, {"owner": {"reputation": 15, "user_id": 9668463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4938143bdc9381e78c23eb79b0f6ee7?s=128&d=identicon&r=PG", "display_name": "Orbit", "link": "https://stackoverflow.com/users/9668463/orbit"}, "edited": false, "score": 0, "creation_date": 1524134874, "post_id": 49916272, "comment_id": 86853555, "body": "The JSON arrives from an external source... So I&#39;m not in control of that unfortunately. I know I could process it in python first but that defeats the point of learning something."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 9668463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4938143bdc9381e78c23eb79b0f6ee7?s=128&d=identicon&r=PG", "display_name": "Orbit", "link": "https://stackoverflow.com/users/9668463/orbit"}, "edited": false, "score": 0, "creation_date": 1524134967, "post_id": 49917918, "comment_id": 86853626, "body": "Thanks for the reply! Unfortunately I both of these didn&#39;t want to compile..  &quot;Couldn&#39;t match type \u2018IO\u2019 with \u2018[]\u2019       Expected type: [LBS.ByteString]         Actual type: IO LBS.ByteString&quot; seems to be the key part of the error message. But I will accept Jordan&#39;s solution below since it nearly works and I think I can understand it. Thanks again for your quick response!"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 15, "user_id": 9668463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4938143bdc9381e78c23eb79b0f6ee7?s=128&d=identicon&r=PG", "display_name": "Orbit", "link": "https://stackoverflow.com/users/9668463/orbit"}, "edited": false, "score": 0, "creation_date": 1524137449, "post_id": 49917918, "comment_id": 86855403, "body": "Of course it must be <code>IO [MyDat]</code> in the type signature because you&#39;re reading from a file. (Though it would actually better to make the conversion <code>GarbledJSON -&gt; [MyDat]</code> a separate, pure function.)"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 0, "last_activity_date": 1524137367, "last_edit_date": 1524137367, "creation_date": 1524131288, "answer_id": 49917918, "question_id": 49916272, "link": "https://stackoverflow.com/questions/49916272/trouble-with-json-data-aeson/49917918#49917918", "title": "Trouble with JSON (Data.Aeson)", "body": "<p>As I commented, the best thing would probably be to make your JSON file well-formed in the sense that the float fields should really be floats, not strings.</p>\n\n<p>If that's not an option, I would recommend you phrase out the type that the JSON file <em>seems to represent</em> as simple as possible (but without dynamic <code>Object</code>s), and then convert that to the type you actually want.</p>\n\n<pre><code>import Data.Map (Map)\nimport qualified Data.Map as Map\n\ntype GarbledJSON = Map String (Map String String)\n                -- ^ you could also stick with hash maps for everything, but\n                --   usually `Map` is actually more sensible in Haskell.\n\ndata MyDat = MyDat {name :: String, num :: Float} deriving (Show)\n\ntest :: FilePath -&gt; IO [MyDat]\ntest s = do \n  d &lt;- LBS.readFile s \n  case decode d :: Maybe GarbledJSON of\n    Just v -&gt; return [ MyDat iName ( read . filter (`elem`good)\n                                             $ iVals Map.! valKey )\n                     | (iName, iVals) &lt;- Map.toList v\n                     , let valKey = takeWhile (/='_') iName ]\n</code></pre>\n\n<p>Note that this will crash completely if any of the items don't contain the first part of the name as a string of float format, and likely give bogus items when you filter out characters that aren't <code>good</code>. If you just want to ignore any malformed items (which is also not a very clean approach...), you can do it this way:</p>\n\n<pre><code>test :: FilePath -&gt; IO [MyDat]\ntest s = do \n  d &lt;- LBS.readFile s \n  return $ case decode d :: Maybe GarbledJSON of\n    Just v -&gt; [ MyDat iName iVal\n              | (iName, iVals) &lt;- Map.toList v\n              , let valKey = takeWhile (/='_') iName\n              , Just iValStr &lt;- [iVals Map.!? valKey]\n              , [(iVal,\"\")] &lt;- [reads iValStr] ]\n    Nothing -&gt; []\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 15, "user_id": 9668463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4938143bdc9381e78c23eb79b0f6ee7?s=128&d=identicon&r=PG", "display_name": "Orbit", "link": "https://stackoverflow.com/users/9668463/orbit"}, "edited": false, "score": 0, "creation_date": 1524135173, "post_id": 49918127, "comment_id": 86853772, "body": "Thanks allot, this almost does what I want and I think I&#39;ll be able to modify it to work for me."}], "tags": [], "owner": {"reputation": 1096, "user_id": 5021447, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh5.googleusercontent.com/-gwPYP717ZyU/AAAAAAAAAAI/AAAAAAAAAP8/WoyhftM4PuU/photo.jpg?sz=128", "display_name": "Jordan Mackie", "link": "https://stackoverflow.com/users/5021447/jordan-mackie"}, "is_accepted": true, "score": 1, "last_activity_date": 1524134320, "last_edit_date": 1524134320, "creation_date": 1524131864, "answer_id": 49918127, "question_id": 49916272, "link": "https://stackoverflow.com/questions/49916272/trouble-with-json-data-aeson/49918127#49918127", "title": "Trouble with JSON (Data.Aeson)", "body": "<p>The structure of your JSON is pretty nasty, but here's a basic working solution:</p>\n\n<pre><code>#!/usr/bin/env stack\n-- stack --resolver lts-11.5 script --package containers --package aeson\n{-# LANGUAGE OverloadedStrings #-}\n\nimport qualified Data.Map as Map\nimport qualified Data.Aeson as Aeson\n\ndata Mydat = Mydat { name :: String\n                   , num  :: Float\n                   } deriving (Show)\n\n\ninstance Eq Mydat where\n    (Mydat _ x1) == (Mydat _ x2) = x1 == x2\n\ninstance Ord Mydat where\n    (Mydat _ x1) `compare` (Mydat _ x2) = x1 `compare` x2\n\ntype MydatRaw = Map.Map String (Map.Map String String)\n\nprocessRaw :: MydatRaw -&gt; [Mydat]\nprocessRaw = Map.foldrWithKey go []\n    where go key value accum = \n              accum ++ (Mydat key . read &lt;$&gt; Map.elems value)\n\nmain :: IO ()\nmain =\n    do let json = \"{\\\"stringA1_stringA2\\\":{\\\"stringA1\\\":\\\"0.1\\\",\\\"stringA2\\\":\\\"0.2\\\"}}\"\n       print $ fmap processRaw (Aeson.eitherDecode json)\n</code></pre>\n\n<p>Note that <code>read</code> is partial and generally not a good idea. But I'll leave it to you to flesh out a safer version :) </p>\n"}], "owner": {"reputation": 15, "user_id": 9668463, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4938143bdc9381e78c23eb79b0f6ee7?s=128&d=identicon&r=PG", "display_name": "Orbit", "link": "https://stackoverflow.com/users/9668463/orbit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 49918127, "answer_count": 2, "score": 0, "last_activity_date": 1524137367, "creation_date": 1524126543, "last_edit_date": 1524129654, "question_id": 49916272, "link": "https://stackoverflow.com/questions/49916272/trouble-with-json-data-aeson", "title": "Trouble with JSON (Data.Aeson)", "body": "<p>I'm new to Haskell and in order to learn the language I am working on a project that involves dealing with JSON. I am currently getting the feeling Haskell is the wrong language for the job, but that isn't the point here.</p>\n\n<p>I've been struggling to understand how this works for a few days. I have searched and everything I have found does not seem to work. Here's the issue:</p>\n\n<p>I have some JSON in the following format:</p>\n\n<pre><code>&gt;&gt;&gt;less \"path/to/json\"\n{\n\"stringA1_stringA2\": {\"stringA1\":floatA1,\n                      \"stringA2\":foatA2},\n\"stringB1_stringB2\": {\"stringB1\":floatB1,\n                      \"stringB2\":floatB2}\n...\n}\n</code></pre>\n\n<p>Here floatX1 and floatX2 are actually strings of the form \"0.535613567\", \"1.221362183\" etc. What I want to do is parse this into the following data </p>\n\n<pre><code>data Mydat = Mydat { name :: String, num :: Float} deriving (Show)\n</code></pre>\n\n<p>where name would correspond to \"stringX1_stringX2\" and num to floatX1 for X = A,B,...</p>\n\n<p>So far I have reached a 'solution' which feels fairly hackish and convoluted and doesn't work properly.</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE DeriveGeneric #-}\n\nimport Data.Functor\nimport Data.Monoid\nimport Data.Aeson\nimport Data.List\nimport Data.Text\nimport Data.Map (Map)\nimport qualified Data.HashMap.Strict as DHM\n--import qualified Data.HashMap as DHM\nimport qualified Data.ByteString.Lazy as LBS\nimport System.Environment\nimport GHC.Generics\nimport Text.Read\n\ndata Mydat = Mydat {name :: String, num :: Float} deriving (Show)\n\ntest s = do \n  d &lt;- LBS.readFile s \n  let v = decode d :: Maybe (DHM.HashMap String Object) \n  case v of\n    -- Just v -&gt; print v\n    Just v -&gt; return $ Prelude.map dataFromList $ DHM.toList $ DHM.map (DHM.lookup \"StringA1\") v\n\n\ngood = ['1','2','3','4','5','6','7','8','9','0','.']\n\nf x = elem x good\n\ndataFromList :: (String, Maybe Value) -&gt; Mydat\ndataFromList (a,b) = Mydat a (read (Prelude.filter f (show b)) :: Float)\n</code></pre>\n\n<p>Now I can compile this and run</p>\n\n<pre><code>test \"path/to/json\" \n</code></pre>\n\n<p>in ghci and it prints a list of Mydat's in the case where \"stringX1\"=\"stringA1\" for all X. In reality there are two values for \"stringX1\" so aside from the hackyness this is not satisfactory. There must be a better way to do this. I get that I need to write my own parser probably but I am confused about how this works so any suggestions would be great. Thanks in advance. </p>\n"}, {"tags": ["string", "haskell", "text", "type-conversion", "esqueleto"], "answers": [{"comments": [{"owner": {"reputation": 20326, "user_id": 750216, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/974fb481d985024715a6816dfbb9cebf?s=128&d=identicon&r=PG", "display_name": "R\u0103zvan Flavius Panda", "link": "https://stackoverflow.com/users/750216/r%c4%83zvan-flavius-panda"}, "edited": false, "score": 0, "creation_date": 1524109698, "post_id": 49912363, "comment_id": 86840422, "body": "I forgot to mention but the pack I used is the one you mentioned, eg. from <code>Data.Text.Lazy</code>. So this is what I am doing and it is not working."}, {"owner": {"reputation": 20326, "user_id": 750216, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/974fb481d985024715a6816dfbb9cebf?s=128&d=identicon&r=PG", "display_name": "R\u0103zvan Flavius Panda", "link": "https://stackoverflow.com/users/750216/r%c4%83zvan-flavius-panda"}, "edited": false, "score": 0, "creation_date": 1524110408, "post_id": 49912363, "comment_id": 86840631, "body": "I tried [Value (fromStrict $ pack currentWindowTitle)] == previousLogItem but it still gives same error: Couldn&#39;t match type \u2018Data.Text.Internal.Lazy.Text\u2019 with \u2018Text\u2019"}, {"owner": {"reputation": 20326, "user_id": 750216, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/974fb481d985024715a6816dfbb9cebf?s=128&d=identicon&r=PG", "display_name": "R\u0103zvan Flavius Panda", "link": "https://stackoverflow.com/users/750216/r%c4%83zvan-flavius-panda"}, "edited": false, "score": 0, "creation_date": 1524110712, "post_id": 49912363, "comment_id": 86840709, "body": "Using [Value (toStrict $ pack currentWindowTitle)] == previousLogItem is what worked in the end."}], "tags": [], "owner": {"reputation": 1341, "user_id": 1036044, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PzcQL.jpg?s=128&g=1", "display_name": "Probie", "link": "https://stackoverflow.com/users/1036044/probie"}, "is_accepted": false, "score": 0, "last_activity_date": 1524109940, "last_edit_date": 1524109940, "creation_date": 1524109450, "answer_id": 49912363, "question_id": 49912333, "link": "https://stackoverflow.com/questions/49912333/how-to-compare-for-equality-data-text-internal-lazy-text-and-char/49912363#49912363", "title": "How to compare for equality Data.Text.Internal.Lazy.Text and [Char]?", "body": "<p>Edit: I misread the original question</p>\n\n<p>Have you tried using <code>fromString</code> from the <code>IsString</code> class? <code>Data.Text.Internal.Lazy.Text</code> should be an instance of <code>IsString</code></p>\n\n<p>Old (useless) answer:</p>\n\n<p>Use the <code>pack</code> function from <code>Data.Text.Lazy</code> to convert the <code>String</code> to <code>Text</code></p>\n\n<p><a href=\"https://hackage.haskell.org/package/text-1.2.3.0/docs/Data-Text-Lazy.html\" rel=\"nofollow noreferrer\">https://hackage.haskell.org/package/text-1.2.3.0/docs/Data-Text-Lazy.html</a></p>\n"}, {"tags": [], "owner": {"reputation": 128, "user_id": 947407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f20474e5c7fc041f3e79565316a53d6c?s=128&d=identicon&r=PG", "display_name": "David Kraeutmann", "link": "https://stackoverflow.com/users/947407/david-kraeutmann"}, "is_accepted": false, "score": 2, "last_activity_date": 1524114848, "creation_date": 1524114848, "answer_id": 49913164, "question_id": 49912333, "link": "https://stackoverflow.com/questions/49912333/how-to-compare-for-equality-data-text-internal-lazy-text-and-char/49913164#49913164", "title": "How to compare for equality Data.Text.Internal.Lazy.Text and [Char]?", "body": "<pre><code>Couldn't match type \u2018Data.Text.Internal.Lazy.Text\u2019\n                with \u2018Text\u2019\n  NB: \u2018Text\u2019 is defined in \u2018Data.Text.Internal\u2019\n    \u2018Data.Text.Internal.Lazy.Text\u2019\n</code></pre>\n\n<p>You're using the wrong kind of <code>Text</code>. Check your imports.</p>\n"}], "owner": {"reputation": 20326, "user_id": 750216, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/974fb481d985024715a6816dfbb9cebf?s=128&d=identicon&r=PG", "display_name": "R\u0103zvan Flavius Panda", "link": "https://stackoverflow.com/users/750216/r%c4%83zvan-flavius-panda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1524114848, "creation_date": 1524109261, "last_edit_date": 1524109628, "question_id": 49912333, "link": "https://stackoverflow.com/questions/49912333/how-to-compare-for-equality-data-text-internal-lazy-text-and-char", "title": "How to compare for equality Data.Text.Internal.Lazy.Text and [Char]?", "body": "<p>The <code>previousLogItem</code> data type returned by esqueleto contains <a href=\"https://hackage.haskell.org/package/text-1.2.3.0/docs/Data-Text-Internal-Lazy.html\" rel=\"nofollow noreferrer\">Data.Text.Internal.Lazy.Text</a></p>\n\n<pre><code>import           Data.Text.Lazy                        (pack)\n\npreviousLogItem &lt;- select $ from $ \\l -&gt; do\n        orderBy [desc (l ^. LogItemId)]\n        limit 1\n        return (l ^. LogItemTitle)\n</code></pre>\n\n<p>Later I tried to compare <code>previousLogItem</code> with <code>exampleCharList</code> by using:</p>\n\n<pre><code>[Value (pack currentWindowTitle)] == previousLogItem\n</code></pre>\n\n<p>But that does not work since the types still differ:</p>\n\n<pre><code>Couldn't match type \u2018Data.Text.Internal.Lazy.Text\u2019\n                 with \u2018Text\u2019\n  NB: \u2018Text\u2019 is defined in \u2018Data.Text.Internal\u2019\n      \u2018Data.Text.Internal.Lazy.Text\u2019\n        is defined in \u2018Data.Text.Internal.Lazy\u2019\n    arising from a functional dependency between:\n      constraint \u2018Database.Esqueleto.Internal.Sql.SqlSelect\n                    (SqlExpr (Value Text)) (Value Data.Text.Internal.Lazy.Text)\u2019\n        arising from a use of \u2018select\u2019\n      instance \u2018Database.Esqueleto.Internal.Sql.SqlSelect\n                  (SqlExpr (Value a)) (Value a)\u2019\n</code></pre>\n"}, {"tags": ["haskell", "math", "functional-programming"], "comments": [{"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "edited": false, "score": 3, "creation_date": 1524108180, "post_id": 49912173, "comment_id": 86840069, "body": "Minor, tangential note: <code>if foo then True else False</code> is always redundant -- it is the same as <code>foo</code>."}, {"owner": {"reputation": 81794, "user_id": 9859, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/KEZOL.jpg?s=128&g=1", "display_name": "rampion", "link": "https://stackoverflow.com/users/9859/rampion"}, "edited": false, "score": 2, "creation_date": 1524112756, "post_id": 49912173, "comment_id": 86841273, "body": "<a href=\"https://en.wikipedia.org/wiki/Convergence_tests\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Convergence_tests</a>"}, {"owner": {"reputation": 931, "user_id": 2631185, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/75f07727c65d676aa81eeb97b794cfa7?s=128&d=identicon&r=PG", "display_name": "Regis Kuckaertz", "link": "https://stackoverflow.com/users/2631185/regis-kuckaertz"}, "edited": false, "score": 0, "creation_date": 1524118436, "post_id": 49912173, "comment_id": 86843249, "body": "Your question reminded me of this: <a href=\"http://conal.net/papers/compiling-to-categories/\" rel=\"nofollow noreferrer\">conal.net/papers/compiling-to-categories</a>"}, {"owner": {"reputation": 73919, "user_id": 44309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iL4TW.png?s=128&g=1", "display_name": "High Performance Mark", "link": "https://stackoverflow.com/users/44309/high-performance-mark"}, "edited": false, "score": 0, "creation_date": 1524124204, "post_id": 49912173, "comment_id": 86846622, "body": "Also tangential, see <a href=\"https://meta.stackoverflow.com/questions/270933/should-i-answer-is-it-possible-type-of-questions\" title=\"should i answer is it possible type of questions\">meta.stackoverflow.com/questions/270933/&hellip;</a>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1524147619, "post_id": 49912173, "comment_id": 86862603, "body": "I suppose this depends very much on how complicated your expression language is. If your expressions are, say, all linear, then it&#39;s easy as heck (the constant 0 is convergent and nothing else is); while if your expressions are Turing-complete it&#39;s obviously undecidable. (Likely any expression language complicated enough to be fun to use is going to leave this question undecidable in general.)"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 1, "creation_date": 1524150960, "post_id": 49912173, "comment_id": 86865049, "body": "You can&#39;t use any delta-based system to detect convergence. The <a href=\"https://en.wikipedia.org/wiki/Harmonic_series_(mathematics)\" rel=\"nofollow noreferrer\">harmonic series</a> famously doesn&#39;t converge, and the delta between elements has 0 as its limit."}, {"owner": {"reputation": 151, "user_id": 8622509, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/64ce0a9af573d9ec892fbd05278c43ec?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Buckley", "link": "https://stackoverflow.com/users/8622509/jack-buckley"}, "edited": false, "score": 0, "creation_date": 1524151297, "post_id": 49912173, "comment_id": 86865291, "body": "This was my fear in wondering whether it&#39;d be possible to find convergence this way. My expressions are too complex to code the multiple convergence tests, so I was just looking for something that works most of the time. For instance, maybe knowing that 1/x^1.1 converges while maybe not being able to determine that 1/x^1.000000001 does"}], "owner": {"reputation": 151, "user_id": 8622509, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/64ce0a9af573d9ec892fbd05278c43ec?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Buckley", "link": "https://stackoverflow.com/users/8622509/jack-buckley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 140, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1524108089, "creation_date": 1524107924, "last_edit_date": 1524108089, "question_id": 49912173, "link": "https://stackoverflow.com/questions/49912173/is-it-possible-to-compute-with-high-accuracy-if-a-series-converges-using-haskell", "title": "Is it possible to compute with high accuracy if a series converges using Haskell?", "body": "<p>I am trying to develop a custom math library in Haskell that encodes expressions for a project. I'm wondering whether it is possible to determine (with high accuracy) if a mathematical from n to infinity converges or diverges. I have a sigma sum function available in my library, which I initially thought I could use to determine if a series converges by finding the difference of the sigma sum from some n to say something like 1000 and the sum from the same n to something much higher 100000. However, while I thought this might work at first, I realized this wouldn't work as any constant times a convergent series is also convergent and will wind up increasing the difference in the sums I was using to determine if a series is convergent or not.</p>\n\n<p>This is what I have:</p>\n\n<pre><code>isConverging :: String -&gt; a -&gt; Expr a -&gt; Bool\nisConverging x a expr = if abs((eval (Map.fromList [(x, a)]) $ sigma x a (1000) expr) - (eval (Map.fromList [(x, a)]) $ sigma x a (100000) expr)) &lt;= 1.0e-3 then True else False\n</code></pre>\n\n<p>As a result, I'm wondering if there is a better way to compute if a series likely converges. Any help would be much appreciated. </p>\n"}]