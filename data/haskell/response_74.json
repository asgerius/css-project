[{"tags": ["haskell", "yesod", "yesod-forms"], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 2, "last_activity_date": 1465427582, "creation_date": 1465427582, "answer_id": 37714445, "question_id": 37714297, "link": "https://stackoverflow.com/questions/37714297/how-get-the-user-id-from-the-session-at-yesod-haskell-project/37714445#37714445", "title": "How get the user ID from the Session at (Yesod / Haskell Project", "body": "<p>Use <code>keyToValues</code> to get a list of <a href=\"https://hackage.haskell.org/package/persistent-2.2.4/docs/Database-Persist-Types.html#t:PersistValue\" rel=\"nofollow\"><code>PersistValue</code></a> values.</p>\n\n<pre><code>keyToValues :: Key record -&gt; [PersistValue]\n</code></pre>\n\n<p>If you know, for instance, that the key is a Text value, then your list will consist of a single <code>PersistText</code> value and you could proceed like this:</p>\n\n<pre><code>do uid &lt;- lookupSession \"_ID\"\n   let pvals = keyToValues uid\n       [ PersistText txt ] = pvals\n   liftIO $ print pvals            -- to see what pvals is\n   -- now txt is a Text value\n   ...\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 5558619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0daf238ed465f8fec6db6cb0397c603e?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas F", "link": "https://stackoverflow.com/users/5558619/jonas-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 228, "favorite_count": 0, "accepted_answer_id": 37714445, "answer_count": 1, "score": 1, "last_activity_date": 1465427582, "creation_date": 1465426790, "last_edit_date": 1465427365, "question_id": 37714297, "link": "https://stackoverflow.com/questions/37714297/how-get-the-user-id-from-the-session-at-yesod-haskell-project", "title": "How get the user ID from the Session at (Yesod / Haskell Project", "body": "<p>guys i got a little projet and i need to extrat de ID of the user from the Session.</p>\n\n<p>I can't put it in a Text/Int because it says that the Session carry an Key (Sql Key i think) how can i converte it to Int to use in other methods from my project</p>\n\n<p>I Tried to do it to recover the ID from session</p>\n\n<pre><code>getInicioR :: Handler Html\ngetInicioR = do\n        uid &lt;- lookupSession \"_ID\"\n        user &lt;- runDB $ get404 uid \n</code></pre>\n\n<p>Shows the follow error message:</p>\n\n<pre><code>Couldn't match expected type \u2018Key t0\u2019 with actual type \u2018Maybe Text\u2019\nIn the first argument of \u2018get404\u2019, namely \u2018uid\u2019\nIn the second argument of \u2018($)\u2019, namely \u2018get404 uid\u2019\n</code></pre>\n"}, {"tags": ["haskell", "matrix"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1465420614, "post_id": 37713027, "comment_id": 62899733, "body": "You may like to write a helper function that takes the &quot;media&quot; and a single row of the input matrix and produces a single row of the output matrix. I encourage you to give this a try and include your thoughts on this in the question!"}, {"owner": {"reputation": 9, "user_id": 6442445, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-SemP1PbE6w4/AAAAAAAAAAI/AAAAAAAAAF8/1X13x-QAnfY/photo.jpg?sz=128", "display_name": "Gabriel Antonio Lavagnoli Broc", "link": "https://stackoverflow.com/users/6442445/gabriel-antonio-lavagnoli-broc"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1465421565, "post_id": 37713027, "comment_id": 62900177, "body": "Well, the biggest problem here is that I have to make it work with a Amxn matrix, a &quot;infinite&quot; one. That is why I&#39;m stuck."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1465422381, "post_id": 37713027, "comment_id": 62900548, "body": "Infinite in which dimension?  If rows, how do you compute the mean?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 1, "creation_date": 1465422573, "post_id": 37713027, "comment_id": 62900631, "body": "I think you&#39;ll find it easier to work with rows of a transposed matrix than with columns of the original matrix."}], "answers": [{"comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1465426235, "post_id": 37713917, "comment_id": 62901952, "body": "Good answer! Two suggestions: <code>minus = zipWith (--)</code> and <code>agg</code> may be written in terms of <code>foldr</code>"}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 2, "last_activity_date": 1465433937, "last_edit_date": 1465433937, "creation_date": 1465424507, "answer_id": 37713917, "question_id": 37713027, "link": "https://stackoverflow.com/questions/37713027/matrix-averages-in-haskell/37713917#37713917", "title": "Matrix averages in Haskell", "body": "<p>something like this, without validations and formatting</p>\n\n<pre><code>colmean rs = let (a,c) = agg rs in map (/(fromIntegral c)) a\n\nagg [r] = (r,1)\nagg (r:rs) = let (a,c) = agg rs in (zipWith (+) a r, c+1)\n\nminus = flip (zipWith (-))\n\ndemean x = map (minus $ colmean x) x\n\n&gt; demean media\n[[-9.999999999999964e-2,-8.000000000000007e-2,-4.0000000000000036e-3],\n [0.10000000000000053,2.0000000000000018e-2,-1.4000000000000012e-2],\n [-0.19999999999999973,-8.000000000000007e-2,-2.400000000000002e-2],\n [0.20000000000000018,2.0000000000000018e-2,1.6000000000000014e-2],\n [0.0,0.1200000000000001,2.6000000000000023e-2]]\n</code></pre>\n\n<p>with this, the second dimension (number of columns) can be infinite</p>\n\n<pre><code>&gt; map (take 10) $ demean [[1..], [2..]]\n[[-0.5,-0.5,-0.5,-0.5,-0.5,-0.5,-0.5,-0.5,-0.5,-0.5],\n [0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5,0.5]]\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "edited": false, "score": 0, "creation_date": 1465472463, "post_id": 37719168, "comment_id": 62921054, "body": "This answer will probably be more useful with a quick description of what is going on and perhaps how it works."}, {"owner": {"reputation": 1958, "user_id": 3217013, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8fe4c19ed2edcb4fe6e661a5faed0205?s=128&d=identicon&r=PG&f=1", "display_name": "Emil", "link": "https://stackoverflow.com/users/3217013/emil"}, "reply_to_user": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "edited": false, "score": 0, "creation_date": 1465494249, "post_id": 37719168, "comment_id": 62936849, "body": "Sure :) Thanks for the feedback."}], "tags": [], "owner": {"reputation": 1958, "user_id": 3217013, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/8fe4c19ed2edcb4fe6e661a5faed0205?s=128&d=identicon&r=PG&f=1", "display_name": "Emil", "link": "https://stackoverflow.com/users/3217013/emil"}, "is_accepted": false, "score": 1, "last_activity_date": 1465494482, "last_edit_date": 1465494482, "creation_date": 1465456407, "answer_id": 37719168, "question_id": 37713027, "link": "https://stackoverflow.com/questions/37713027/matrix-averages-in-haskell/37719168#37719168", "title": "Matrix averages in Haskell", "body": "<p>Here's how I would do it:</p>\n\n<pre><code>mean l = sum l / (fromIntegral (length l))\n\ngetColumnMeans = map mean . transpose\n\nnormalizeMatrix m = map (zipWith subtract columnMeans) m\n    where\n        columnMeans = getColumnMeans m\n</code></pre>\n\n<p><code>mean</code> does exactly what its name suggests and <code>getColumnMeans</code> is the function that you seem to have implemented yourself.</p>\n\n<p><code>normalizeMatrix</code> is the function that you are looking for. It takes in a matrix, computes its column means and then subtracts it from each of its rows via <code>map</code>.</p>\n\n<p><code>subtract</code> function is basically <code>(-)</code> but with its arguments flipped. I use it whenever I wanna map something like <code>subtract 5</code> and it reads like regular English. So, <code>subtract 5 10</code> would return <code>5</code>. Here, <code>zipWith subtract columnMeans</code> does it on an entry-by-entry basis for a row. <code>map</code> does this for all rows. Hope this is useful.</p>\n"}], "owner": {"reputation": 9, "user_id": 6442445, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-SemP1PbE6w4/AAAAAAAAAAI/AAAAAAAAAF8/1X13x-QAnfY/photo.jpg?sz=128", "display_name": "Gabriel Antonio Lavagnoli Broc", "link": "https://stackoverflow.com/users/6442445/gabriel-antonio-lavagnoli-broc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1465494482, "creation_date": 1465420433, "last_edit_date": 1465423857, "question_id": 37713027, "link": "https://stackoverflow.com/questions/37713027/matrix-averages-in-haskell", "title": "Matrix averages in Haskell", "body": "<p>I have a matrix, lets use this one for example:</p>\n\n<pre><code>[ [4.0, 2.0, 0.6],\n  [4.2, 2.1, 0.59], \n  [3.9, 2.0, 0.58], \n  [4.3, 2.1, 0.62], \n  [4.1, 2.2, 0.63] ] \n</code></pre>\n\n<p>Now, I take the average of each column, which results in this:</p>\n\n<pre><code> [4.10, 2.08, 0.604]\n</code></pre>\n\n<p>All these I'm able to make, I have the informations.</p>\n\n<p>What I'm having problem is at this part now. I'm looking a way to subtract each average element with his respective element on the first Matrix.</p>\n\n<p>It should look like this:</p>\n\n<pre><code>[ [-0.1, -0.08, -0.004],\n  [0.1, 0.02, -0.014],\n  [-0.2, -0.08, -0.024],\n  [0.2, 0.02, 0.016],\n  [0.0, 0.12, 0.026]  ]\n</code></pre>\n\n<p>I have to make it viable for an arbitrary-sized matrix.</p>\n"}, {"tags": ["haskell", "types", "numbers", "typeclass"], "comments": [{"owner": {"reputation": 791, "user_id": 1587319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c8a88b9a8d79a518cba52a7a8d099f9?s=128&d=identicon&r=PG", "display_name": "pdexter", "link": "https://stackoverflow.com/users/1587319/pdexter"}, "edited": false, "score": 1, "creation_date": 1465418481, "post_id": 37711500, "comment_id": 62898723, "body": "You want <code>round (sqrt n)</code> and not <code>round sqrt n</code>. Also you need a fromIntegral on the righthand expression. So <code>check = filter (\\n -&gt; n == fromIntegral (round (sqrt n)))</code>"}, {"owner": {"reputation": 403, "user_id": 3881672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/47b10fd6274c1d6e83308fa1dd375007?s=128&d=identicon&r=PG&f=1", "display_name": "Doopy", "link": "https://stackoverflow.com/users/3881672/doopy"}, "reply_to_user": {"reputation": 791, "user_id": 1587319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c8a88b9a8d79a518cba52a7a8d099f9?s=128&d=identicon&r=PG", "display_name": "pdexter", "link": "https://stackoverflow.com/users/1587319/pdexter"}, "edited": false, "score": 0, "creation_date": 1465418785, "post_id": 37711500, "comment_id": 62898891, "body": "Aren&#39;t the function calls right-associative? Also, I still get two error messages: <code>No instance for (RealFrac Int) arising from a use of &quot;round&quot;</code> <code>No instance for (Floating Int) arising from a use of &quot;sqrt&quot;</code>"}, {"owner": {"reputation": 791, "user_id": 1587319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c8a88b9a8d79a518cba52a7a8d099f9?s=128&d=identicon&r=PG", "display_name": "pdexter", "link": "https://stackoverflow.com/users/1587319/pdexter"}, "edited": false, "score": 0, "creation_date": 1465420227, "post_id": 37711500, "comment_id": 62899575, "body": "Remove your <code>[Int] -&gt; [Int]</code> type, you want <code>[Double] -&gt; [Double]</code> for example. If you really want <code>Int</code> then you have to further change the definition. Function calls are left-associative."}, {"owner": {"reputation": 403, "user_id": 3881672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/47b10fd6274c1d6e83308fa1dd375007?s=128&d=identicon&r=PG&f=1", "display_name": "Doopy", "link": "https://stackoverflow.com/users/3881672/doopy"}, "reply_to_user": {"reputation": 791, "user_id": 1587319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c8a88b9a8d79a518cba52a7a8d099f9?s=128&d=identicon&r=PG", "display_name": "pdexter", "link": "https://stackoverflow.com/users/1587319/pdexter"}, "edited": false, "score": 0, "creation_date": 1465478768, "post_id": 37711500, "comment_id": 62925962, "body": "Why do I have to change the definition?"}, {"owner": {"reputation": 791, "user_id": 1587319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c8a88b9a8d79a518cba52a7a8d099f9?s=128&d=identicon&r=PG", "display_name": "pdexter", "link": "https://stackoverflow.com/users/1587319/pdexter"}, "edited": false, "score": 0, "creation_date": 1465480822, "post_id": 37711500, "comment_id": 62927655, "body": "Because <code>sqrt</code> has a <code>Floating</code> constraint. You could do <code>check = filter (\\n -&gt; n == round (sqrt (fromIntegral n)))</code>"}], "answers": [{"comments": [{"owner": {"reputation": 403, "user_id": 3881672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/47b10fd6274c1d6e83308fa1dd375007?s=128&d=identicon&r=PG&f=1", "display_name": "Doopy", "link": "https://stackoverflow.com/users/3881672/doopy"}, "edited": false, "score": 0, "creation_date": 1465416285, "post_id": 37711632, "comment_id": 62897553, "body": "It didn&#39;t work without the first fromIntegral either.  Edit: But does that mean fromIntegral is just something like a constraint for the following? I thought it was something like a converter function"}, {"owner": {"reputation": 403, "user_id": 3881672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/47b10fd6274c1d6e83308fa1dd375007?s=128&d=identicon&r=PG&f=1", "display_name": "Doopy", "link": "https://stackoverflow.com/users/3881672/doopy"}, "edited": false, "score": 0, "creation_date": 1465416665, "post_id": 37711632, "comment_id": 62897772, "body": "Also Yes, its an Int because of the context ;)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 403, "user_id": 3881672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/47b10fd6274c1d6e83308fa1dd375007?s=128&d=identicon&r=PG&f=1", "display_name": "Doopy", "link": "https://stackoverflow.com/users/3881672/doopy"}, "edited": false, "score": 0, "creation_date": 1465417196, "post_id": 37711632, "comment_id": 62898076, "body": "well obviously it is rather useless with an <code>Int</code> in the first place (a <code>Int</code> is always <i>whole</i>) - but in this case it would be something like <code>test n = n == round (fromIntegral n)</code> - you use <code>fromIntegral</code> to get to some <code>RealFrac</code> and then you can use <code>round</code> to go back - but remember: this is practically useless"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 403, "user_id": 3881672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/47b10fd6274c1d6e83308fa1dd375007?s=128&d=identicon&r=PG&f=1", "display_name": "Doopy", "link": "https://stackoverflow.com/users/3881672/doopy"}, "edited": false, "score": 0, "creation_date": 1465417238, "post_id": 37711632, "comment_id": 62898103, "body": "also: you should always add type-signatures if you ask a question here (and it is a good idea to do so in your code too)"}, {"owner": {"reputation": 403, "user_id": 3881672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/47b10fd6274c1d6e83308fa1dd375007?s=128&d=identicon&r=PG&f=1", "display_name": "Doopy", "link": "https://stackoverflow.com/users/3881672/doopy"}, "edited": false, "score": 0, "creation_date": 1465417834, "post_id": 37711632, "comment_id": 62898406, "body": "Oh wow, with all these typeclasses I forgot what I going to do... I wanted to check if the square root of the number is whole or not. I&#39;ll edit the context into my question."}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 2, "last_activity_date": 1465415992, "last_edit_date": 1465415992, "creation_date": 1465415313, "answer_id": 37711632, "question_id": 37711500, "link": "https://stackoverflow.com/questions/37711500/haskell-no-instance-for-arising/37711632#37711632", "title": "Haskell No instance for ... arising", "body": "<p>it will work if you remove the left <code>fromIntegral</code>: </p>\n\n<pre><code>test n = n == fromIntegral (round n) \n</code></pre>\n\n<p>the reason is that as it is your <code>n</code> has to be <code>RealFrac</code> (<code>round</code>) and <code>Integral</code> (<code>fromIntegral</code>) but there is no type in the prelude which is both (neither <code>Integer</code> nor <code>Double</code> for example)</p>\n\n<p>if you remove the left <code>fromIntegral</code> you only need <code>n</code> to have a type which is an instance of <code>RealFrac</code> - <code>Double</code> for example</p>\n\n<p>the right side is like this:</p>\n\n<pre><code>RealFrac -round-&gt; Integral -fromIntegral-&gt; RealFrac\n</code></pre>\n\n<hr>\n\n<p>if you are in doubt you can always ask GHCi:</p>\n\n<pre><code>Prelude&gt; :i RealFrac\nclass (Real a, Fractional a) =&gt; RealFrac a where\n  properFraction :: Integral b =&gt; a -&gt; (b, a)\n  truncate :: Integral b =&gt; a -&gt; b\n  round :: Integral b =&gt; a -&gt; b\n  ceiling :: Integral b =&gt; a -&gt; b\n  floor :: Integral b =&gt; a -&gt; b\n    -- Defined in \u2018GHC.Real\u2019\ninstance RealFrac Float -- Defined in \u2018GHC.Float\u2019\ninstance RealFrac Double -- Defined in \u2018GHC.Float\u2019\n</code></pre>\n\n<p>as you can see this type-class gives you ways to <em>cut</em>-back numbers to <code>Integral</code> (ask for <code>Integral</code> to see what it's about - hint: think something like Integers)</p>\n\n<p>you also see the <em>known</em> instances</p>\n\n<p>if you see <code>RealFrac Int</code> it means it was looking to find a <code>RealFrac</code> instance-definition for <code>Int</code> (there is none)</p>\n\n<p>Why there is an <code>Int</code> is another matter:</p>\n\n<ul>\n<li>either you ran into a technicality: GHCi default <code>n</code> to <code>Int</code> here - you probably ran into the dreaded <a href=\"https://wiki.haskell.org/Monomorphism_restriction\" rel=\"nofollow\">monomorphism restriction</a> - which should not happen like this with newer GHC versions but well ...</li>\n<li>or you use it in a context which constraints it to <code>Int</code> (which we do not see)</li>\n</ul>\n\n<p>to be honest I'm not sure which it is here</p>\n"}, {"comments": [{"owner": {"reputation": 403, "user_id": 3881672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/47b10fd6274c1d6e83308fa1dd375007?s=128&d=identicon&r=PG&f=1", "display_name": "Doopy", "link": "https://stackoverflow.com/users/3881672/doopy"}, "edited": false, "score": 0, "creation_date": 1465420081, "post_id": 37712776, "comment_id": 62899515, "body": "Oh of course the other side too... Well im definitely too tired right now, so i will try this tomorrow, thank you very much!"}, {"owner": {"reputation": 403, "user_id": 3881672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/47b10fd6274c1d6e83308fa1dd375007?s=128&d=identicon&r=PG&f=1", "display_name": "Doopy", "link": "https://stackoverflow.com/users/3881672/doopy"}, "edited": false, "score": 0, "creation_date": 1465476670, "post_id": 37712776, "comment_id": 62924271, "body": "still errors: <code>Ambiguous type variable &quot;a0&quot; in the constraints:   (Floating a0)     arising from a use of &quot;sqrt&quot;   (Integral a0)     arising from a use of &quot;fromIntegral&quot;   (Num a0)     arising from a use of &quot;fromIntegral&quot; </code> Do you guys have a link or something where I can learn all these stuff about number typeclasses? I couldn&#39;t find anything newbie friendly and informative with google."}], "tags": [], "owner": {"reputation": 10492, "user_id": 603688, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1058344e1b119c4d9dd3aedc5456277b?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/603688/dan"}, "is_accepted": false, "score": 2, "last_activity_date": 1465419412, "creation_date": 1465419412, "answer_id": 37712776, "question_id": 37711500, "link": "https://stackoverflow.com/questions/37711500/haskell-no-instance-for-arising/37712776#37712776", "title": "Haskell No instance for ... arising", "body": "<p>It should be</p>\n\n<pre><code>check :: [Int] -&gt; [Int]\ncheck xs = filter (\\n -&gt; fromIntegral n == round (sqrt (fromIntegral n))) xs\n</code></pre>\n\n<p>The error message is telling you the problem:</p>\n\n<pre><code>(maybe you haven't applied enough arguments to a function?)\narising from a use of \"round\"\n</code></pre>\n\n<p>Because <code>round sqrt n</code> calls <code>round</code> with the arguments <code>sqrt</code> and <code>n</code>.</p>\n\n<p>But that still doesn't do what you want. You need to <code>sqrt</code> the other side as well</p>\n\n<pre><code>check :: [Int] -&gt; [Int]\ncheck xs = filter (\\n -&gt; sqrt (fromIntegral n) == round (sqrt (fromIntegral n))) xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 403, "user_id": 3881672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/47b10fd6274c1d6e83308fa1dd375007?s=128&d=identicon&r=PG&f=1", "display_name": "Doopy", "link": "https://stackoverflow.com/users/3881672/doopy"}, "is_accepted": true, "score": 1, "last_activity_date": 1465479947, "creation_date": 1465479947, "answer_id": 37727777, "question_id": 37711500, "link": "https://stackoverflow.com/questions/37711500/haskell-no-instance-for-arising/37727777#37727777", "title": "Haskell No instance for ... arising", "body": "<p>So I found another solution by myself:</p>\n\n<pre><code>check :: [Int] -&gt; [Int]\ncheck xs = filter (\\n -&gt; (ceiling (sqrt (fromIntegral n))) == (floor (sqrt (fromIntegral n)))) xs\n</code></pre>\n\n<p>This is the only one that doesn't throw compiler errors (in my case).</p>\n"}], "owner": {"reputation": 403, "user_id": 3881672, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/47b10fd6274c1d6e83308fa1dd375007?s=128&d=identicon&r=PG&f=1", "display_name": "Doopy", "link": "https://stackoverflow.com/users/3881672/doopy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 886, "favorite_count": 0, "accepted_answer_id": 37727777, "answer_count": 3, "score": 0, "last_activity_date": 1465479947, "creation_date": 1465414837, "last_edit_date": 1465418145, "question_id": 37711500, "link": "https://stackoverflow.com/questions/37711500/haskell-no-instance-for-arising", "title": "Haskell No instance for ... arising", "body": "<p>I'm trying to write a function that tests if the square root of a number is whole or not.\nMy function looks like this:</p>\n\n<pre><code>check :: [Int] -&gt; [Int]\ncheck xs = filter (\\n -&gt; n == round sqrt n) xs\n</code></pre>\n\n<p>And the error messages I'm receiving are these:</p>\n\n<pre><code>No instance for (Integral (Int -&gt; Int))\n(maybe you haven't applied enough arguments to a function?)\narising from a use of \"round\"\nIn the second argument of \"(==)\", namely \"round sqrt n\"\n ...\nNo instance for (Floating a0) arising from a use of `sqrt'\nThe type variable `a0' is ambiguous\nNote: there are several potential instances:\ninstance Floating Double -- Defined in `GHC.Float'\ninstance Floating Float -- Defined in `GHC.Float'\nIn the first argument of `round', namely `sqrt'\n</code></pre>\n\n<p>Edit: I ended up rewriting the whole question, I hope thats not a problem!</p>\n"}, {"tags": ["algorithm", "performance", "pointers", "haskell", "time-complexity"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1465397292, "post_id": 37705664, "comment_id": 62885609, "body": "Mind that Haskell uses lazy programming. In some circumstances, for instance if you turn out to be interested in only the five first numbers, the time complexity can be O(1)."}, {"owner": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1465397342, "post_id": 37705664, "comment_id": 62885652, "body": "@WillemVanOnsem You will need to read in m+4 bits in that case don&#39;t you?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1465397479, "post_id": 37705664, "comment_id": 62885769, "body": "@eleanora: given your window looks to the future, yes. If it would look to the past, it requires only the first 4 (or m, if m is less)."}, {"owner": {"reputation": 2082, "user_id": 5849470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/270b9a87f8f1cba83d545b6e601337ea?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Jordan", "link": "https://stackoverflow.com/users/5849470/matt-jordan"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1465397576, "post_id": 37705664, "comment_id": 62885841, "body": "@WillemVanOnsem is correct, since m is not dependent on the length of the bit string, and is therefore considered a constant in O() notation.  Have you timed any tests to find out whether Haskell can compete?  I expect Haskell to beat Python, but lose by a small margin to C, assuming equal quality code for each, and the numbers would be a nice resource to post."}, {"owner": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "reply_to_user": {"reputation": 2082, "user_id": 5849470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/270b9a87f8f1cba83d545b6e601337ea?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Jordan", "link": "https://stackoverflow.com/users/5849470/matt-jordan"}, "edited": false, "score": 0, "creation_date": 1465398095, "post_id": 37705664, "comment_id": 62886220, "body": "@MattJordan I was assuming that m grows as well as n but it&#39;s not an important detail.  My interest is not so much in practical speed but rather in just how to actually write the code in a purely functional style so that it at least has the same theoretical performance (up to constant factors)."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 4, "creation_date": 1465398196, "post_id": 37705664, "comment_id": 62886291, "body": "Well, that&#39;s not a bad thing to ask, but you should start out with some implementations of your own and a demonstration of how they do <i>not</i> give the desired performance."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 2082, "user_id": 5849470, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/270b9a87f8f1cba83d545b6e601337ea?s=128&d=identicon&r=PG&f=1", "display_name": "Matt Jordan", "link": "https://stackoverflow.com/users/5849470/matt-jordan"}, "edited": false, "score": 1, "creation_date": 1465399126, "post_id": 37705664, "comment_id": 62887025, "body": "@MattJordan <code>m</code> may not depend on the length of the int string, but it <i>is</i> part of the input size (contributing O(lg m) bits) if the algorithm does not include a fixed <code>m</code> as part of its definition."}], "answers": [{"comments": [{"owner": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "edited": false, "score": 0, "creation_date": 1465401353, "post_id": 37707365, "comment_id": 62888754, "body": "Thanks. <a href=\"https://en.wikipedia.org/wiki/Purely_functional\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Purely_functional</a> has a definition that might be helpful but I really meant using only pure functions <a href=\"https://en.wikipedia.org/wiki/Pure_function\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Pure_function</a> ."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "edited": false, "score": 0, "creation_date": 1465401584, "post_id": 37707365, "comment_id": 62888924, "body": "Well - that article says that Haskell is a purely functional language. So does that mean any Haskell function is purely functional?"}, {"owner": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "edited": false, "score": 0, "creation_date": 1465401740, "post_id": 37707365, "comment_id": 62889045, "body": "I don&#39;t feel I am the right expert to give a great answer to that question. However, I can say that I had immutability in mind when I asked the question."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "edited": false, "score": 0, "creation_date": 1465402226, "post_id": 37707365, "comment_id": 62889330, "body": "Questions about the problem: it appears the C program reads the input from an array - is that correct? And what does it mean to &quot;output&quot;? Are the results placed in another array or sent to <code>stdout</code> or ...?"}, {"owner": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "edited": false, "score": 0, "creation_date": 1465402921, "post_id": 37707365, "comment_id": 62889777, "body": "I am happy for the input to come in any form that is convenient and for the output to be sent directly to stdout."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 1, "last_activity_date": 1465404442, "last_edit_date": 1465404442, "creation_date": 1465401289, "answer_id": 37707365, "question_id": 37705664, "link": "https://stackoverflow.com/questions/37705664/simple-loop-with-good-performance-in-haskell/37707365#37707365", "title": "Simple loop with good performance in Haskell", "body": "<p><strong>Update</strong></p>\n\n<p>After reading the question more carefully I noticed that the\nC program reads its input from an array.</p>\n\n<p>So here is an equivalent Haskell \"pure\" function which performs the task.</p>\n\n<pre><code> import qualified Data.Vector as V\n import Data.List\n import Control.Monad\n\n count :: Int -&gt; V.Vector Int -&gt; [Int]\n count m v = \n   let c0 = V.sum (V.take m v)\n       n = V.length v\n       results = scanl' go c0 [0..n-m-1]\n         where go r i = r - (v V.! i) + (v V.! (i+m))\n   in results\n\n test1 = let v = V.fromList [0,0,1,1,1,1,1,0,0,0,0]\n         in print $ count 3 v\n</code></pre>\n\n<p>Even though <code>count</code> returns a list it will be generated lazily. Moreover, if it is consume by another list operation it could be optimized via one of the various fusion techniques.</p>\n\n<p><strong>Original Answer</strong></p>\n\n<p>This is a good exercise, but why does it have to be \"purely functional\" (and what does that mean anyway)?</p>\n\n<p>You can write the C algorithm in Haskell - it's not as terse, but it will\ngenerate essentially the same code.</p>\n\n<pre><code> import Data.Vector.Unboxed.Mutable as V\n\n count m = do\n   v &lt;- V.replicate m '0'\n   let toInt ch = if ch == '1' then 1 else 0\n   let loop c i = do\n         ch &lt;- getChar\n         oldch &lt;- V.read v i\n         let c' = c + toInt ch - toInt oldch\n         V.write v i ch\n         let i' = mod (i+1) m \n         putStrLn $ show c\n         loop c' i'\n   loop 0 0\n\n main = count 3\n</code></pre>\n\n<p>(For simplicity this generates <em>n</em> results.)</p>\n\n<p>If you were benchmark this note that you are also including the performance of\n<code>getChar</code> and <code>putStrLn</code> and <code>show</code>, so it might be difficult to make a fair\ncomparison with a C program. However, it has O(n) complexity and constant\nmemory usage which is what I think you're asking for.</p>\n"}, {"comments": [{"owner": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "edited": false, "score": 0, "creation_date": 1465402987, "post_id": 37707859, "comment_id": 62889817, "body": "This looks really nice. Thank you."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1465416866, "post_id": 37707859, "comment_id": 62897883, "body": "@dfeuer You mean instead of <code>ByteString</code> or <code>Text</code>? First of all, OP is &quot;starting in Haskel&quot; and I didn&#39;t want to introduce additional packages. Second, you can exchange <code>zipWith</code> and <code>drop</code> with the variants from <code>ByteString.(Lazy.)Char8</code> and you&#39;re done, so the code <i>almost</i> stays the same. Last but not least, the question is underspecified. Should the result get printed, or should it be a list? Either way, I&#39;ll add something about <code>String</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1465428705, "post_id": 37707859, "comment_id": 62902710, "body": "@Zeta, no, I mean at all. Why not use <code>Bool</code>, or <code>data Bit = Zero | One</code> or something?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1465455283, "post_id": 37707859, "comment_id": 62910215, "body": "@dfeuer: <i>&quot;You are given a long string of 1s and 0s of length n&quot;</i>. But yeah, a <code>Input -&gt; BoolString</code> followed by <code>slidingWindow :: Int -&gt; BoolString -&gt; \u2026</code> would be better."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1465483157, "post_id": 37707859, "comment_id": 62929368, "body": "A &quot;string&quot; to a C programmer is just an array of 8-bit things. The OP appears to be an experienced C programmer."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 5, "last_activity_date": 1465417293, "last_edit_date": 1465417293, "creation_date": 1465402779, "answer_id": 37707859, "question_id": 37705664, "link": "https://stackoverflow.com/questions/37705664/simple-loop-with-good-performance-in-haskell/37707859#37707859", "title": "Simple loop with good performance in Haskell", "body": "<h2>C Code</h2>\n\n<p>Here is the C code you've described:</p>\n\n<pre><code>int sliding_window(const char * const str, const int n, const int m, int * result){\n  const char * back  = str;\n  const char * front = str + m;\n  int sum = 0;\n  int i;\n\n  for(i = 0; i &lt; m; ++i){\n     sum += str[i] == '1';\n  }\n\n  *result++ = sum;\n\n  for(; i &lt; n; ++i){\n    sum += *front++ == '1';\n    sum -= *back++  == '1';\n    *result++ = sum;\n  }\n  return n - m + 1;\n}\n</code></pre>\n\n<h2>Algorithm</h2>\n\n<p>The code above is apparently <em>O(n)</em>, since we have <code>n</code> iterations. But lets go a step back and have a look at the underlying algorithm:</p>\n\n<ol>\n<li>Sum the first <code>m</code> elements. Keep this as <code>sum</code>. <em>O(m)</em></li>\n<li>Our first window has <code>sum</code> 1s. <em>O(1)</em></li>\n<li>Until we've exhausted our original string: <em>O(n)</em>\n\n<ol>\n<li>\"Slide\" the window. <em>O(1)</em>\n\n<ul>\n<li>add 1 to <code>sum</code> if we gain a <code>'1'</code> by sliding <em>O(1)</em></li>\n<li>subtract 1 from <code>sum</code> if we lose a <code>'1'</code> by sliding <em>O(1)</em></li>\n</ul></li>\n<li>Push <code>sum</code> onto the results. <em>O(1)</em></li>\n</ol></li>\n</ol>\n\n<p>Since <code>n &gt; m</code> (otherwise there is no window), <em>O(n)</em> holds.</p>\n\n<h2>Moulding a Haskell variant</h2>\n\n<p>That's basically a left scan (<code>scanl</code>) with a way to get a list of those differences in (2.1.). So all we need is a way to somehow slide:</p>\n\n<pre><code>slide :: Int -&gt; [Char] -&gt; [Int]\nslide m xs = zipWith f xs (drop m xs)\n  where\n    f '1' '0' = -1  -- we lose a one\n    f '0' '1' =  1  -- we gain a one\n    f  _   _  =  0  -- nothing :/\n</code></pre>\n\n<p>That's <em>O(n)</em>, where <em>n</em> is the length of our list. </p>\n\n<pre><code>slidingWindow :: Int -&gt; [Char] -&gt; [Int]\nslidingWindow m xs = scanl (+) start (slide m xs)\n where\n   start = length (filter (== '1') (take m xs))\n</code></pre>\n\n<p>That's <em>O(n)</em>, same as in C, since both use the same algorithm.</p>\n\n<h3>Caveats</h3>\n\n<p>In a real life application, you would always use <code>Text</code> or <code>ByteString</code> instead of <code>String</code>, since the latter is a list of <code>Char</code> with much overhead. Since you only use a string of <code>'1'</code> and <code>'0'</code>, you can use <code>ByteString</code>:</p>\n\n<pre><code>import           Data.ByteString.Char8 (ByteString)\nimport qualified Data.ByteString.Char8 as BS\nimport           Data.List (scanl')\n\nslide :: Int -&gt; ByteString -&gt; [Int]\nslide m xs = BS.zipWith f xs (BS.drop m xs)\n  where\n    f '1' '0' = -1\n    f '0' '1' =  1\n    f  _   _  =  0\n\nslidingWindow :: Int -&gt; ByteString -&gt; [Int]\nslidingWindow m xs = scanl' (+) start (slide m xs)\n where\n   start = BS.count '1' (BS.take m xs)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 1, "last_activity_date": 1465506276, "creation_date": 1465506276, "answer_id": 37736158, "question_id": 37705664, "link": "https://stackoverflow.com/questions/37705664/simple-loop-with-good-performance-in-haskell/37736158#37736158", "title": "Simple loop with good performance in Haskell", "body": "<p>The most basic level is re-implementing the cool HOF-based algorithms with hand-written recursive functions to express the loops. </p>\n\n<p>Banged patterns mark arguments as strict, so simple values can be calculated without unnecessary delay (this is implicitly taken care of when using <code>scanl'</code>, for example). This also shows that \"pointers\" are just names:</p>\n\n<pre><code>{-# LANGUAGE BangPatterns #-}\n\n-- assumes xs has only 0s and 1s\ncounts :: Int -&gt; [Int] -&gt; [Int]\ncounts m xs = g 0 m xs\n  where\n    g !c    0      ys  = h c ys xs\n    g !c    _      []  = []                  -- m &gt; |xs|\n    g !c    m   (y:ys) = g (c+y) (m-1) ys\n    h !c    []     _   = [c]\n    h !c (y:ys) (x:xs) = c : h (c+y-x) ys xs\n</code></pre>\n\n<p>Testing,</p>\n\n<pre><code> &gt; counts [1,1,0,0,1,1,0,1] 2\n[2,1,0,1,2,1,1]\n &gt; counts [1,1,0,0,1,1,1,1] 3\n[2,1,1,2,3,3]\n</code></pre>\n"}], "owner": {"reputation": 9307, "user_id": 2179021, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/629b9942cb64be30074eecfe0a100a50?s=128&d=identicon&r=PG", "display_name": "eleanora", "link": "https://stackoverflow.com/users/2179021/eleanora"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "accepted_answer_id": 37707859, "answer_count": 3, "score": 2, "last_activity_date": 1465506368, "creation_date": 1465396763, "last_edit_date": 1465506368, "question_id": 37705664, "link": "https://stackoverflow.com/questions/37705664/simple-loop-with-good-performance-in-haskell", "title": "Simple loop with good performance in Haskell", "body": "<p>I am starting in Haskell and am interested in how to get matching performance for simple code I would normally write in C or Python.  Consider the following problem.</p>\n\n<p>You are given a long string of 1s and 0s of length <code>n</code>.   We want to output, for each substring of length <code>m</code>, the number of 1s in that window. That is the output has <code>n-m+1</code> different possible values between <code>0</code> and <code>m</code> inclusive.</p>\n\n<p>In C this is very simple to do in time proportional to <code>n</code> and using extra space (on top of the space needed to store the input) proportional to <code>m</code> bits.  You just count the number of 1s in the first window of length <code>m</code> and then maintain two pointers, one to the start of the window and one to the end and increment or decrement depending of whether one points to a 1 and the other points to a 0 or the opposite occurs.</p>\n\n<p>Is it possible to get the same theoretical performance in a purely functional way in Haskell?</p>\n\n<p>Some terrible code:</p>\n\n<pre><code>chunkBits m = helper\n  where helper [] = []\n        helper xs = sum (take m xs) : helper (drop m xs)\n\nmain = print $ chunkBits 5 [0,1,1,0,1,0,0,1,0,1,0,1,1,1,0,0,0,1]\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "monads"], "comments": [{"owner": {"reputation": 2571, "user_id": 1264675, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7cdce6fa69152f105c232420c8e62925?s=128&d=identicon&r=PG", "display_name": "Undreren", "link": "https://stackoverflow.com/users/1264675/undreren"}, "edited": false, "score": 0, "creation_date": 1465386966, "post_id": 37701551, "comment_id": 62877621, "body": "It is difficult to determine what you are trying to achieve. Could you rephrase your question, such that it is clear what you are trying to achieve? Maybe even just an example input with an associated desired output?"}, {"owner": {"reputation": 623, "user_id": 5910215, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/62487068172a6c63ecc4f2e13d4b2a8f?s=128&d=identicon&r=PG&f=1", "display_name": "khaled omar", "link": "https://stackoverflow.com/users/5910215/khaled-omar"}, "reply_to_user": {"reputation": 2571, "user_id": 1264675, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7cdce6fa69152f105c232420c8e62925?s=128&d=identicon&r=PG", "display_name": "Undreren", "link": "https://stackoverflow.com/users/1264675/undreren"}, "edited": false, "score": 0, "creation_date": 1465388224, "post_id": 37701551, "comment_id": 62878471, "body": "thanks for your interest, hope it is clear now"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1465396897, "post_id": 37701551, "comment_id": 62885305, "body": "<code>zip&#39;&#39;</code> takes a <code>(String, String)</code> argument, but <code>res1 :: [(String, String)]</code>. You would have to run <code>map zip&#39;&#39; res1</code> to get the <code>res2</code> that you show."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1465396934, "post_id": 37701551, "comment_id": 62885332, "body": "<code>zip&#39;</code>, by the way, can be written more succinctly as <code>zip &lt;*&gt; tail</code>."}], "answers": [{"tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": true, "score": 3, "last_activity_date": 1465387563, "creation_date": 1465387563, "answer_id": 37702015, "question_id": 37701551, "link": "https://stackoverflow.com/questions/37701551/haskell-error-while-chaining-function-using-monad/37702015#37702015", "title": "Haskell : error while chaining function using monad", "body": "<p>Your <code>ff</code> function is backwards. You should start with <code>zip'</code> and bind to <code>zip''</code> like this:</p>\n\n\n\n<pre class=\"lang-haskell prettyprint-override\"><code>ff list = zip' list &gt;&gt;= zip''\n</code></pre>\n\n<p>Running it through the REPL gives you:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>&gt; let zip' xs = zip xs (tail xs)\n&gt; let zip'' = \\(a,b)-&gt;zip a b\n&gt; let ff list = zip' list &gt;&gt;= zip''\n&gt; ff [\"c\", \"cac\", \"cb\", \"bcc\", \"ba\"]\n[('c','c'),('c','c'),('a','b'),('c','b'),('b','c'),('b','b'),('c','a')]\n</code></pre>\n"}], "owner": {"reputation": 623, "user_id": 5910215, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/62487068172a6c63ecc4f2e13d4b2a8f?s=128&d=identicon&r=PG&f=1", "display_name": "khaled omar", "link": "https://stackoverflow.com/users/5910215/khaled-omar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 1, "accepted_answer_id": 37702015, "answer_count": 1, "score": 2, "last_activity_date": 1465388181, "creation_date": 1465386107, "last_edit_date": 1592644375, "question_id": 37701551, "link": "https://stackoverflow.com/questions/37701551/haskell-error-while-chaining-function-using-monad", "title": "Haskell : error while chaining function using monad", "body": "<p>The aim of this exercise is to take a list of String and and construct a list of Char, in other words, given a the below list a string</p>\n<p><strong>function  input</strong></p>\n<p><code>let input = [&quot;c&quot;, &quot;cac&quot;, &quot;cb&quot;, &quot;bcc&quot;, &quot;ba&quot;]</code></p>\n<p><em><strong>applying some behavior</strong></em></p>\n<pre><code>zip' xs = zip xs (tail xs)\nlet res1 =zip' input\n</code></pre>\n<p>after zipping each element in the (<em>input</em>) list with the rest of the list, i will get a list of tuple as per the below</p>\n<pre><code>print res1\nres1 =  [(&quot;c&quot;,&quot;cac&quot;),(&quot;cac&quot;,&quot;cb&quot;),(&quot;cb&quot;,&quot;bcc&quot;),(&quot;bcc&quot;,&quot;ba&quot;)]\n</code></pre>\n<p><em><strong>applying some other behavior on res1</strong></em></p>\n<pre><code>zip''  = \\(a,b)-&gt;zip a b\nlet res2 = zip'' res1\n</code></pre>\n<p>zipping the first and the second item of each pair in the list will get the below list</p>\n<pre><code> print res2\n    res2 = [[('c','c')],[('c','c'),('a','b')],[('c','b'),('b','c')],[('b','b'),('c','a')]]\n</code></pre>\n<p><em><strong>applying some other behavior on res2</strong></em></p>\n<pre><code>let finalRes = concat res2\n</code></pre>\n<p><strong>output</strong></p>\n<pre><code>print finalRes\nfinalRes= [('c','c'),('c','c'),('a','b'),('c','b'),('b','c'),('b','b'),('c','a')]\n</code></pre>\n<p><em><strong>NOW THE MONADIC STYLE</strong></em></p>\n<p>this problem is obvious to solve it without monad, while I am new to monad and trying to understand it, I have made an attempt to solve it using the bind function <code>&gt;&gt;=</code>, I wrote 2 function and bind it together  in order to get from ** input ** to <strong>output</strong> :</p>\n<pre><code>zip':: [String] -&gt; [(String,String)]\nzip' xs = zip xs (tail xs)\n</code></pre>\n<p>and</p>\n<pre><code>zip'' :: ([a], [b]) -&gt; [(a, b)]\nzip''  = \\(a,b)-&gt;zip a b\n</code></pre>\n<p>then</p>\n<p><code>ff =zip'' &gt;&gt;= zip'  </code></p>\n<p>while compiling the code I got an error in the function ff that type do not align.</p>\n<p>let me re-write the bind signature</p>\n<pre><code>Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b\n</code></pre>\n<p>applying  <code>ff [&quot;c&quot;, &quot;cac&quot;, &quot;cb&quot;, &quot;bcc&quot;, &quot;ba&quot;]</code></p>\n<p>as I have understood, that the <code>zip'</code> takes a list of String and return a list of pair which is a <strong>context</strong> of pair so it is the first argument <code>m a</code> for the bind operator which shouhld align with  the second function <code>zip''</code>.\nso the function <code>zip''</code> will take each pair/tuple and apply its behavior in order to return the concatenated list of Char.</p>\n<p>what Have I miss , and what is wrong in the code?</p>\n<p><em>sorry for the long question</em></p>\n"}, {"tags": ["haskell", "aeson"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1465379973, "post_id": 37698679, "comment_id": 62872995, "body": "why don&#39;t you just use those you know about?"}, {"owner": {"reputation": 634, "user_id": 5093690, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a3c8f6b503d9ea35c843eda8d891479f?s=128&d=identicon&r=PG&f=1", "display_name": "qwe", "link": "https://stackoverflow.com/users/5093690/qwe"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1465381332, "post_id": 37698679, "comment_id": 62873979, "body": "I would, if I could. :)"}], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 5, "last_activity_date": 1465382277, "creation_date": 1465382277, "answer_id": 37700126, "question_id": 37698679, "link": "https://stackoverflow.com/questions/37698679/placeholder-for-additional-fields-with-data-aeson/37700126#37700126", "title": "Placeholder for additional fields with Data.Aeson", "body": "<p>Sure - just store the Object in additionalFields (the fourth slot):</p>\n\n<pre><code>instance FromJSON MyObject where\n    parseJSON obj@(Object v) = MyObject  &lt;$&gt;\n        v .: \"a\"                         &lt;*&gt;\n        v .: \"b\"                         &lt;*&gt;\n        v .: \"c\"                         &lt;*&gt;\n        (pure obj)\n    parseJSON _                      = mzero\n</code></pre>\n\n<p>If you want to remove the keys for <code>a</code>, <code>b</code> and <code>c</code> first, then use:</p>\n\n<pre><code>import Data.HashMap.Strict as HM\n\n...\n\n   pure ( HM.delete \"a\" $ HM.delete \"b\" $ HM.delete \"c\" obj )\n</code></pre>\n"}], "owner": {"reputation": 634, "user_id": 5093690, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a3c8f6b503d9ea35c843eda8d891479f?s=128&d=identicon&r=PG&f=1", "display_name": "qwe", "link": "https://stackoverflow.com/users/5093690/qwe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 37700126, "answer_count": 1, "score": 1, "last_activity_date": 1465382277, "creation_date": 1465378493, "last_edit_date": 1465381746, "question_id": 37698679, "link": "https://stackoverflow.com/questions/37698679/placeholder-for-additional-fields-with-data-aeson", "title": "Placeholder for additional fields with Data.Aeson", "body": "<p>Let's say I get a JSON with some fields I know and some fields I don't know:</p>\n\n<pre><code>{\n  \"a\": { ... },\n  \"b\": { ... },\n  \"c\": { ... },\n  \"something\": \"else\",\n  \"more\": {\"of\": [\"the\", \"same\"]},\n  \"and\": [\"even\", \"some\", \"more\"]\n}\n</code></pre>\n\n<p>Since the JSON structure is kind of complicated, I would really like to work with it within Haskell using the following data:</p>\n\n<pre><code>data A = ...\ndata B = ...\ndata C = ...\ndata MyObject = MyObject\n  {\n    a :: A\n  , b :: B\n  , c :: C\n  , additionalFields :: Object\n  }\n</code></pre>\n\n<p>Is it possible to have the fields a, b and c translated to Haskell objects and all the additional fields be packed and passed as an Aeson.Object?</p>\n\n<p>Also, I don't have any guarantee of the JSON fields order.</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1465372954, "post_id": 37696504, "comment_id": 62868377, "body": "it&#39;s CPU-time vs. wall-clock-time (what you would call time) - the first is the time spend <i>warming</i> the CPU - the other is you waiting for the result"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1465373007, "post_id": 37696504, "comment_id": 62868412, "body": "in this case it seems you did lots of slow IO(?) / waiting for stuff to happen"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1465373090, "post_id": 37696504, "comment_id": 62868467, "body": "btw: it&#39;s there in the docs: &quot;Next there is the CPU time and wall clock time&quot;"}, {"owner": {"reputation": 6568, "user_id": 383508, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d61149baeb9e5c9d1432b220e49cd0?s=128&d=identicon&r=PG", "display_name": "fho", "link": "https://stackoverflow.com/users/383508/fho"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1465373127, "post_id": 37696504, "comment_id": 62868488, "body": "About 500mb reading and 500mb writing csv files. Wouldn&#39;t have thought that that is actually io bound."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1465374029, "post_id": 37696504, "comment_id": 62868980, "body": "5minutes seems way to much to just read/write 500MB - but this is probably another question"}, {"owner": {"reputation": 6568, "user_id": 383508, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d61149baeb9e5c9d1432b220e49cd0?s=128&d=identicon&r=PG", "display_name": "fho", "link": "https://stackoverflow.com/users/383508/fho"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1465388134, "post_id": 37696504, "comment_id": 62878407, "body": "Docs could probably be improved by stating &quot;and wall clock time (in parenthesis)&quot;, there is probably a place to raise that issue. There is some processing involved, but if that stats are correct most of the time is spend waiting for the os to provide the data from disc?"}], "answers": [{"tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": false, "score": 1, "last_activity_date": 1465393592, "creation_date": 1465393592, "answer_id": 37704370, "question_id": 37696504, "link": "https://stackoverflow.com/questions/37696504/what-is-the-meaning-of-this-statistics-output/37704370#37704370", "title": "What is the meaning of this statistics output?", "body": "<p>The time in parenthesis is the wall clock time. It's the time a human (you) experiences while the program is running if you look at a clock at the wall. The CPU time is the time your program experiences:</p>\n\n<blockquote>\n  <p>If you use the <code>-s</code> flag then, when your program finishes, you will see something like this (the exact details will vary depending on what sort of RTS you have, e.g. you will only see profiling data if your RTS is compiled for profiling):</p>\n\n<pre><code>    36,169,392 bytes allocated in the heap\n     4,057,632 bytes copied during GC\n     1,065,272 bytes maximum residency (2 sample(s))\n        54,312 bytes maximum slop\n             3 MB total memory in use (0 MB lost due to fragmentation)\n\nGeneration 0:    67 collections,     0 parallel,  0.04s,  0.03s elapsed\nGeneration 1:     2 collections,     0 parallel,  0.03s,  0.04s elapsed\n\nSPARKS: 359207 (557 converted, 149591 pruned)\n\nINIT  time    0.00s  (  0.00s elapsed)\nMUT   time    0.01s  (  0.02s elapsed)\nGC    time    0.07s  (  0.07s elapsed)\nEXIT  time    0.00s  (  0.00s elapsed)\nTotal time    0.08s  (  0.09s elapsed)\n\n%GC time      89.5%  (75.3% elapsed)\n\nAlloc rate    4,520,608,923 bytes per MUT second\n\nProductivity  10.5% of total user, 9.1% of total elapsed\n</code></pre>\n  \n  <p>[\u2026]</p>\n  \n  <p>Next there is the CPU time and wall clock time elapsed broken down by what the runtime system was doing at the time. INIT is \u2026</p>\n</blockquote>\n\n<p>The wall clock time is usually greater than the CPU time, unless you use multiple cores at once. A simple example where the CPU time is <em>very</em> low and the wall clock time is high can be achieved by using <code>getLine</code>, <code>sleep</code> and <code>echo</code>:</p>\n\n<pre class=\"lang-bash prettyprint-override\"><code>$ {sleep 10; echo 1} | ghc -e 'getLine' +RTS -s &gt; /dev/null\n\n      32,006,664 bytes allocated in the heap\n      20,644,024 bytes copied during GC\n       5,813,624 bytes maximum residency (6 sample(s))\n         156,360 bytes maximum slop\n              12 MB total memory in use (0 MB lost due to fragmentation)\n\n                                     Tot time (elapsed)  Avg pause  Max pause\n  Gen  0        37 colls,     0 par    0.011s   0.011s     0.0003s    0.0009s\n  Gen  1         6 colls,     0 par    0.052s   0.052s     0.0087s    0.0105s\n\n  TASKS: 5 (1 bound, 4 peak workers (4 total), using -N1)\n\n  SPARKS: 0 (0 converted, 0 overflowed, 0 dud, 0 GC'd, 0 fizzled)\n\n  INIT    time    0.001s  (  0.001s elapsed)\n  MUT     time    0.016s  (  9.903s elapsed) &lt;------------\n  GC      time    0.063s  (  0.063s elapsed)\n  EXIT    time    0.010s  (  0.010s elapsed)\n  Total   time    0.125s  (  9.977s elapsed)\n\n  Alloc rate    1,956,305,120 bytes per MUT second\n\n  Productivity  48.7% of total user, 0.6% of total elapsed\n</code></pre>\n\n<p>As you can see, the  MUT CPU time is small, whereas the MUT wall clock time is high, since the application waits for input. </p>\n"}], "owner": {"reputation": 6568, "user_id": 383508, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/d9d61149baeb9e5c9d1432b220e49cd0?s=128&d=identicon&r=PG", "display_name": "fho", "link": "https://stackoverflow.com/users/383508/fho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1465393592, "creation_date": 1465372577, "question_id": 37696504, "link": "https://stackoverflow.com/questions/37696504/what-is-the-meaning-of-this-statistics-output", "title": "What is the meaning of this statistics output?", "body": "<p>So I have a <code>io-streams</code> based pipeline that I just ran (interpreted) and dumped the statistics with <code>-s</code>:</p>\n\n<pre><code>    123,680 bytes allocated in the heap\n       3,464 bytes copied during GC\n      68,912 bytes maximum residency (1 sample(s))\n      13,008 bytes maximum slop\n           1 MB total memory in use (0 MB lost due to fragmentation)\n\n                                 Tot time (elapsed)  Avg pause  Max pause\nGen  0         0 colls,     0 par    0.000s   0.000s     0.0000s    0.0000s\nGen  1         1 colls,     0 par    0.000s   0.000s     0.0002s    0.0002s\n\nINIT    time    0.000s  (  0.000s elapsed)\nMUT     time    0.001s  (299.935s elapsed)\nGC      time    0.000s  (  0.000s elapsed)\nEXIT    time    0.000s  (  0.000s elapsed)\nTotal   time    0.134s  (299.936s elapsed)\n\n%GC     time       0.2%  (0.0% elapsed) \n\nAlloc rate    106,371,724 bytes per MUT second\n\nProductivity  99.7% of total user, 0.0% of total elapsed\n</code></pre>\n\n<p>So basically no time was spend garbage collecting. But what I am confused about is the times in parenthesis. From <a href=\"https://downloads.haskell.org/~ghc/8.0.1/docs/html/users_guide/runtime_control.html#rts-options-to-produce-runtime-statistics\" rel=\"nofollow\">the docs</a> it is not obvious what the difference between the times and the times in parenthesis is. Anyone can shed some light on this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1465368245, "post_id": 37694942, "comment_id": 62865581, "body": "there are to many <i>parentheses</i>: <code>myfunc((tail(mylist)) (i+1))</code> - try <code>myfunc (tail mylist) (i+1)</code> (you call <code>tail (mylist)</code> with <code>(i+1)</code>)"}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 0, "creation_date": 1465369411, "post_id": 37694942, "comment_id": 62866278, "body": "Function calls in Haskell don&#39;t require brackets. <code>function first_argument</code> is enough. Multiple arguments are passed like <code>function first_argument second_argument third_argument</code>, which is the same as <code>((function first_argument) second_argument) third_argument</code>. A function with type <code>a -&gt; b -&gt; c</code> is actually a function with type <code>a -&gt; (b -&gt; c)</code>: it takes one argument (like all Haskell functions), and returns another function."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1465371400, "post_id": 37694942, "comment_id": 62867460, "body": "You seem to program in Haskell like you would do in an <i>imperative</i> programming language. Mind Haskell is a <i>functional</i> programming language. Therefore you should program <i>functionally</i>. Your current code is very <i>un</i>-Haskell."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1465399380, "post_id": 37694942, "comment_id": 62887223, "body": "There&#39;s nothing imperative about this code; it just uses <code>head</code> and <code>tail</code> instead of pattern matching. The same function could be written <code>myfunc [] i = 1; myfunc (x:xs) i = x*i + myfunc xs (i + 1)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6438729, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xh3UZ6dal6k/AAAAAAAAAAI/AAAAAAAAABU/DoUrhrH-LaM/photo.jpg?sz=128", "display_name": "\ub098\uc138\uc77c", "link": "https://stackoverflow.com/users/6438729/%eb%82%98%ec%84%b8%ec%9d%bc"}, "edited": false, "score": 0, "creation_date": 1465371336, "post_id": 37695272, "comment_id": 62867427, "body": "Thank you for answering. That code is just prototype of my assignment. I rewrite my code recommended style, but 1 problem occurred. what I have to do execute function at specific situation? for example,  myfunc (h:tl)  = if check h++tl == True then somthing. how this style code would be rewrited? I want to erase &quot;if then&quot; statement."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 1, "user_id": 6438729, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xh3UZ6dal6k/AAAAAAAAAAI/AAAAAAAAABU/DoUrhrH-LaM/photo.jpg?sz=128", "display_name": "\ub098\uc138\uc77c", "link": "https://stackoverflow.com/users/6438729/%eb%82%98%ec%84%b8%ec%9d%bc"}, "edited": false, "score": 0, "creation_date": 1465372818, "post_id": 37695272, "comment_id": 62868289, "body": "first <code>h++tl</code> is probably not what you want (it&#39;s <code>h:tl</code>) - and this depends on what <code>check</code> is really doing (does it really need the remaining lists or only the <code>h</code>?) - please open another question where you describe your real problem / this problem"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 2, "last_activity_date": 1465368887, "creation_date": 1465368887, "answer_id": 37695272, "question_id": 37694942, "link": "https://stackoverflow.com/questions/37694942/haskell-multiple-arguments-function/37695272#37695272", "title": "Haskell multiple arguments function", "body": "<p>you should check your parentheses - you use much more of them then you need to (leading to the problem here)</p>\n\n<p>If you look at <code>myfunc((tail(mylist)) (i+1))</code> then if you count the <code>(..)</code> you will see that the one argument to <code>myfunc</code> here is <code>tail(mylist) (i+1)</code> but this would mean that you try to apply <code>(i+1)</code> to <code>tail(mylist)</code></p>\n\n<p>Also instead of the check with <code>length</code> and <code>head</code> you can use pattern-matching.</p>\n\n<p>here is a cleaned up version of your function:</p>\n\n<pre><code>myfunc :: [Int] -&gt; Int -&gt; Int   \nmyfunc [] _ = 1\nmyfunc (h:tl) i = h*i + myfunc tl (i+1)\n</code></pre>\n\n<p>which will return <code>111</code> for your example:</p>\n\n<pre><code>&gt; myfunc [10,9,8,7,6] 1\n111\n</code></pre>\n\n<hr>\n\n<p>I don't know how much you've seen of Haskell but you can express this as</p>\n\n<pre><code>myfunc :: [Int] -&gt; Int -&gt; Int   \nmyfunc weights start = 1 + sum (zipWith (*) weights [start..])\n</code></pre>\n\n<p>too - which I would consider more readable and idiomatic</p>\n\n<p><strong>Also:</strong> - why the <code>1</code> if the list is empty? Shouldn't your weighted <em>sum</em> be <code>0</code> if the list is empty??</p>\n"}], "owner": {"reputation": 1, "user_id": 6438729, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-xh3UZ6dal6k/AAAAAAAAAAI/AAAAAAAAABU/DoUrhrH-LaM/photo.jpg?sz=128", "display_name": "\ub098\uc138\uc77c", "link": "https://stackoverflow.com/users/6438729/%eb%82%98%ec%84%b8%ec%9d%bc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7233, "favorite_count": 1, "accepted_answer_id": 37695272, "answer_count": 1, "score": -3, "last_activity_date": 1465368887, "creation_date": 1465367807, "last_edit_date": 1465368521, "question_id": 37694942, "link": "https://stackoverflow.com/questions/37694942/haskell-multiple-arguments-function", "title": "Haskell multiple arguments function", "body": "<pre><code>myfunc:: [Int] -&gt; Int -&gt; Int   \nmyfunc mylist i =\n    if length(mylist) == 0 then 1\n\n    else\n       (head(mylist) * i) +  myfunc((tail(mylist)) (i+1))\n</code></pre>\n\n<p>I want to get a weighted sum over a list.</p>\n\n<p>for example, at given parameter <code>[10,9,8,7,6]</code> and <code>1</code>,\nI want to get <code>10*1 + 9*2 + 8*3 + 7*4 + 6*5 ..</code></p>\n\n<p>But my code puts error that</p>\n\n<pre><code>test.hs:9:18: error:\n    \u2022 Couldn't match expected type \u2018Int\u2019 with actual type \u2018Int -&gt; Int\u2019 \n</code></pre>\n\n<p>how to fix this problem??</p>\n"}, {"tags": ["haskell", "haskell-lens"], "answers": [{"tags": [], "owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "is_accepted": false, "score": 1, "last_activity_date": 1465370967, "last_edit_date": 1465370967, "creation_date": 1465370455, "answer_id": 37695758, "question_id": 37692177, "link": "https://stackoverflow.com/questions/37692177/using-lens-cosmosof-uniplate-and-the-state-monad-to-extract-info-about-an-ast/37695758#37695758", "title": "Using lens, cosmosOf, uniplate, and the State monad to extract info about an AST", "body": "<p>It seems you are asking about how best to implement the <code>walk</code> function for your custom tree. This can be done using simple recursion, which doesn't depend on any libraries. On the other hand, depending on the size of your ADTs it's a lot more typing. But the consumers of your library will be thankful if they don't have to install lenses etc.</p>\n\n<p>For a good example, see <a href=\"https://github.com/jgm/pandoc-types/blob/master/Text/Pandoc/Walk.hs\" rel=\"nofollow\">pandoc's walk functions</a> to traverse its <a href=\"https://github.com/jgm/pandoc-types/blob/master/Text/Pandoc/Definition.hs#L211\" rel=\"nofollow\">AST</a>:</p>\n\n<ul>\n<li><code>walk  :: (a -&gt; a) -&gt; b -&gt; b</code> simply modifies the tree, while</li>\n<li><code>walkM :: (Monad m, Functor m) =&gt; (a -&gt; m a) -&gt; b -&gt; m b</code> is monadic, so additionally you can for example keep state around, like the boolean values you asked about. There's nothing wrong with that and the state monad was in fact built for cases like this.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 1, "creation_date": 1465393733, "post_id": 37699595, "comment_id": 62882696, "body": "There is also a <a href=\"https://hackage.haskell.org/package/lens/docs/Control-Lens-Plated.html#v:para\" rel=\"nofollow noreferrer\">para</a> for <code>Plated</code>, the equivalent of <code>Uniplate</code> in the lens package."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 4, "last_activity_date": 1465394365, "last_edit_date": 1465394365, "creation_date": 1465380821, "answer_id": 37699595, "question_id": 37692177, "link": "https://stackoverflow.com/questions/37692177/using-lens-cosmosof-uniplate-and-the-state-monad-to-extract-info-about-an-ast/37699595#37699595", "title": "Using lens, cosmosOf, uniplate, and the State monad to extract info about an AST", "body": "<p>What you want to do can be accomplished by <a href=\"https://hackage.haskell.org/package/uniplate-1.6.12/docs/Data-Generics-Uniplate.html#v:para\" rel=\"nofollow\"><code>para</code></a> from the Uniplate module.</p>\n\n<p>Basically <code>para</code> aggregates information collected from a node and its children and passed it up to the node's parent for further aggregation.</p>\n\n<p>Here's a simplified version of your example - we determine whether or not a Node contains CommandAnnotation and/or FunctionAnnotation nodes</p>\n\n<pre><code>import Data.Monoid\nimport qualified Data.Set as Set\nimport qualified Data.Generics.Uniplate.Data as Uniplate\nimport Data.Data\n\n...\n\ndata HasSection = HasCommandAnnotation | HasFunction | HasOther\n  deriving (Show,Read,Enum,Bounded,Ord,Eq)\n\ntoHas :: Node -&gt; HasSection  \ntoHas (CommandAnnotation {})   = HasCommandAnnotation\ntoHas (FunctionsAnnotation {}) = HasFunction\ntoHas _                        = HasOther\n\ngetSectionInfo :: Node -&gt; Set.Set HasSection\ngetSectionInfo n = Uniplate.para visit n\n  where visit n res = Set.singleton (toHas n) &lt;&gt; mconcat res\n</code></pre>\n\n<p>The <a href=\"https://github.com/ndmitchell/uniplate\" rel=\"nofollow\">README.md</a> at the uniplate github repo has a good overview of the library with examples.</p>\n\n<p>For better efficiency you could use the <a href=\"https://hackage.haskell.org/package/bitset\" rel=\"nofollow\"><code>bitset</code></a> package for the sets.</p>\n"}], "owner": {"reputation": 4387, "user_id": 2103996, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ef9ecd30591995af2cf62cde10b26e49?s=128&d=identicon&r=PG", "display_name": "wincent", "link": "https://stackoverflow.com/users/2103996/wincent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 2, "accepted_answer_id": 37699595, "answer_count": 2, "score": 2, "last_activity_date": 1465394365, "creation_date": 1465351866, "question_id": 37692177, "link": "https://stackoverflow.com/questions/37692177/using-lens-cosmosof-uniplate-and-the-state-monad-to-extract-info-about-an-ast", "title": "Using lens, cosmosOf, uniplate, and the State monad to extract info about an AST", "body": "<p>I have <a href=\"https://github.com/wincent/docvim/blob/1614c718e7ca99bf20a8c487df76558f55ef2b77/lib/Docvim/Visitor/Section.hs\" rel=\"nofollow\">the following code</a> that traverses <a href=\"https://github.com/wincent/docvim/blob/1614c718e7ca99bf20a8c487df76558f55ef2b77/lib/Docvim/AST.hs\" rel=\"nofollow\">an AST</a> using <a href=\"https://hackage.haskell.org/package/lens-4.14/docs/Control-Lens-Plated.html#v:cosmosOf\" rel=\"nofollow\"><code>cosmosOf</code></a> and <a href=\"http://hackage.haskell.org/package/lens-4.14/docs/Data-Data-Lens.html#v:uniplate\" rel=\"nofollow\"><code>uniplate</code></a> looking for nodes of a certain type. For any that it finds, it sets a <code>Bool</code> flag in a record that is propagated using a <code>State</code> monad with the help of <a href=\"https://hackage.haskell.org/package/lens-4.14\" rel=\"nofollow\">the <code>lens</code> package</a>.</p>\n\n<p>This all works, but feels pretty heavy-handed. It feels like lenses, the <code>State</code> monad, and possibly <code>cosmosOf</code>/<code>uniplate</code> may all be overkill here. Is there a better or more idiomatic way to do this?</p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts #-}\n{-# LANGUAGE TemplateHaskell #-}\n\nmodule Docvim.Visitor.Section (getSectionInfo) where\n\nimport Control.Lens\nimport Control.Monad.State\nimport Data.Data.Lens (uniplate)\nimport Docvim.AST\n\ndata SectionInfo = SectionInfo { _hasCommand :: Bool\n                               , _hasCommands :: Bool\n                               , _hasFunction :: Bool\n                               , _hasFunctions :: Bool\n                               , _hasMapping :: Bool\n                               , _hasMappings :: Bool\n                               , _hasOption :: Bool\n                               , _hasOptions :: Bool\n                               } deriving (Show)\n\ntype Env = State SectionInfo\n\nmakeLenses ''SectionInfo\n\ndefaultSectionInfo :: SectionInfo\ndefaultSectionInfo = SectionInfo { _hasCommand = False\n                                 , _hasCommands = False\n                                 , _hasFunction = False\n                                 , _hasFunctions = False\n                                 , _hasMapping = False\n                                 , _hasMappings = False\n                                 , _hasOption = False\n                                 , _hasOptions = False\n                                 }\n\ngetSectionInfo :: Node -&gt; SectionInfo\ngetSectionInfo n = execState (mapMOf_ (cosmosOf uniplate) check n) defaultSectionInfo\n  where\n    check (CommandAnnotation {}) = hasCommand .= True\n    check CommandsAnnotation     = hasCommands .= True\n    check (FunctionAnnotation _) = hasFunction .= True\n    check FunctionsAnnotation    = hasFunctions .= True\n    check (MappingAnnotation _)  = hasMapping .= True\n    check MappingsAnnotation     = hasMappings .= True\n    check (OptionAnnotation {})  = hasOption .= True\n    check OptionsAnnotation      = hasOptions .= True\n    check _                      = modify id\n</code></pre>\n"}, {"tags": ["sorting", "haskell"], "comments": [{"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 0, "creation_date": 1465351350, "post_id": 37691898, "comment_id": 62860419, "body": "<a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-List.html#v:sortOn\" rel=\"nofollow noreferrer\"><code>sortOn</code></a> already exists; if the sorting algorithm is <i>stable</i> then the comparison function does <i>not</i> have to specify a <a href=\"https://en.wikipedia.org/wiki/Weak_ordering#Strict_weak_orderings\" rel=\"nofollow noreferrer\"><i>strict weak ordering</i></a>"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1465351739, "post_id": 37691898, "comment_id": 62860494, "body": "Why is an <code>Ord</code> instance awkward? Most of the time it can be automatically generated with a <code>deriving</code> clause on your data type definition and the main exceptions to that are when you want a special ordering to be the default (so you&#39;d have to define the ordering regardless)."}, {"owner": {"reputation": 8873, "user_id": 2913864, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8fd76251e7baccce47654c94e399b915?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/2913864/alan"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1465354557, "post_id": 37691898, "comment_id": 62861121, "body": "@DavidYoung Because you may want to sort the same data type in varying ways."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1465355102, "post_id": 37691898, "comment_id": 62861226, "body": "That&#39;s exactly the reason <code>sortBy</code> exists! An <code>Ord</code> instance lets you provide a default ordering, if you want to (like the typical ordering of integers) and, regardless of whether an <code>Ord</code> instance exists, <code>sortBy</code> allows you to sort in any way you&#39;d like."}, {"owner": {"reputation": 8873, "user_id": 2913864, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8fd76251e7baccce47654c94e399b915?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/2913864/alan"}, "reply_to_user": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 0, "creation_date": 1465355255, "post_id": 37691898, "comment_id": 62861254, "body": "@behzad.nouri   1. It only exists in Data.List, right?  I wanted a more general version (or at least one for Data.Sequence). 2. I&#39;m not understanding your second point.  I&#39;m suggesting that mapping to an Ord instance would be more sensible."}, {"owner": {"reputation": 8873, "user_id": 2913864, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8fd76251e7baccce47654c94e399b915?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/2913864/alan"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1465361764, "post_id": 37691898, "comment_id": 62862942, "body": "@DavidYoung Of course, but that observation does not address my question."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1465362277, "post_id": 37691898, "comment_id": 62863098, "body": "@Alan, <code>sortBy</code> <a href=\"https://hackage.haskell.org/package/containers-0.5.7.1/docs/Data-Sequence.html#g:10\" rel=\"nofollow noreferrer\">is also available</a> In <code>Data.Sequence</code>. Note also that you can use the <code>reflection</code> package to implement <code>sortBy</code> in terms of <code>sort</code> cleanly."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1465362484, "post_id": 37691898, "comment_id": 62863167, "body": "What do you mean by &quot;key?&quot; Unless I&#39;m misreading the question, this seems like an important part, but I&#39;m not sure what you mean. I would expect it to mean something like a key in a hash map, but a Haskell list doesn&#39;t work that way (because it is a linked list). I&#39;m also not sure what a key would be in the context of <code>Data.Sequence</code>."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1465363093, "post_id": 37691898, "comment_id": 62863384, "body": "Rereading it, if you mean a key <i>function</i>, I&#39;m not sure how that differs significantly from the <code>sortBy</code> approach. <code>sortOn</code> just uses an already existing <code>Ord</code> instance (which has its place as well), but if you just want to write a quick function to perform a certain kind of comparison in a sort then <code>sortBy</code> would be easier (say you want to sort favoring the second element of a pair rather than the first)."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1465363610, "post_id": 37691898, "comment_id": 62863568, "body": "In fact, one nice use of monoids is using them with <code>sortBy</code>: You can sort by the second element then the first element of a list of pairs with <code>sortBy (comparing snd &lt;&gt; comparing fst)</code>. This provides a pretty readable and succinct little &quot;language&quot; for creating orderings and using them to sort things (which can be expanded to any number of criteria just by adding more &quot;terms&quot; with <code>&lt;&gt;</code>)."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1465382013, "post_id": 37691898, "comment_id": 62874420, "body": "@DavidYoung One advantage of key functions is time efficiency. By mapping the potentially complex elements to, say, <code>Int</code>s and then doing comparisons only on <code>Int</code>s is faster then doing complex comparisons on the actual values. Obviously you are adding an O(n) space complexity.   Obiously this is different if you want to do simple comparisons like compare only the kth element of a tuple."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1465413979, "post_id": 37691898, "comment_id": 62896274, "body": "I object to your claim that Python is more sensible about what comparison functions it accepts. To use your phrasing: Python seems happy with <code>def __lt__(self, other): return other.isOdd()</code> as a comparison function, but I do not understand the meaning of &quot;comparison&quot; in such a case."}, {"owner": {"reputation": 8873, "user_id": 2913864, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8fd76251e7baccce47654c94e399b915?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/2913864/alan"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1465416709, "post_id": 37691898, "comment_id": 62897805, "body": "@DanielWagner You have misunderstood me.  My point was that Python abandoned comparison arguments to sort in favor of key functions, and they seem (to me) to have good reasons for this change."}, {"owner": {"reputation": 8873, "user_id": 2913864, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8fd76251e7baccce47654c94e399b915?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/2913864/alan"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1465416868, "post_id": 37691898, "comment_id": 62897884, "body": "@dfeuer Yes, I know about <code>Data.Sequence.sortBy</code>.  Not finding a <code>Data.Sequence.sortOn</code> was the basis of my question.  Is it under consideration?  Thanks."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1465420330, "post_id": 37691898, "comment_id": 62899614, "body": "@Alan I believe I did understand you. But the &quot;good reasons&quot; you cite appear to be on the one hand that it is unfortunate to allow ill-behaved comparison functions like <code>xxx</code> and on the other hand that you have an aesthetic objection (&quot;...this just <i>feels</i> needlessly awkward and indirect...&quot;, emphasis mine). I can&#39;t speak to your aesthetics; but my point is that your technical objection doesn&#39;t seem to actually be a difference between the two languages or between new Python and old Python."}, {"owner": {"reputation": 8873, "user_id": 2913864, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8fd76251e7baccce47654c94e399b915?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/2913864/alan"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1465422025, "post_id": 37691898, "comment_id": 62900391, "body": "@DanielWagner  I believe the main reason for the Python change was time efficiency.  It is a real change: <code>List.sort</code> and <code>sorted</code> no longer accept a <code>cmp</code> argument.  Your point seems to be that we could still build objects with perverse magic comparison methods. That&#39;s true, but that is really not about the <code>key</code> and <code>cmp</code> arguments of sorting functions.  On the aesthetic/readability front, having used both <code>cmp</code> and <code>key</code> arguments in Python 2 sorting, I wound up <i>never</i> wanting <code>cmp</code> -- which is why I was so startled by seeing Haskell privilege <code>sortBy</code> over <code>sortOn</code>. Hope that&#39;s clearer."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1465431588, "post_id": 37691898, "comment_id": 62903577, "body": "@Alan, as the documentation for <code>sortOn</code> says, you can use <code>sortBy</code> with <code>comparing</code> (or <code>compare `on` ...</code>) To cache the conversions, you can use <code>fmap</code> to pair the values with keys, then sort by the keys, or do it however you like. Haskell makes you be explicit about what you want to cache; Python seems to have decided it knows better. Also, good luck sorting <code>Rational</code>s or computable reals or search trees without a general ordering mechanism."}], "answers": [{"comments": [{"owner": {"reputation": 8873, "user_id": 2913864, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8fd76251e7baccce47654c94e399b915?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/2913864/alan"}, "edited": false, "score": 0, "creation_date": 1465356144, "post_id": 37692106, "comment_id": 62861442, "body": "I don&#39;t really understand the idea that Haskell &quot;shouldn&#39;t&quot; restrict anything here.  That&#39;s why I&#39;m asking for an application where one would want e.g. to violate asymmetry of the strict comparison.  <code>Data.List.sortOn</code> requires that the key function produce an instance or <code>Ord</code>, which totally makes sense to me."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 8873, "user_id": 2913864, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8fd76251e7baccce47654c94e399b915?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/2913864/alan"}, "edited": false, "score": 2, "creation_date": 1465363213, "post_id": 37692106, "comment_id": 62863428, "body": "@Alan the problem here is that being an instance of Ord doesn&#39;t guarantee you anything in particular. It&#39;s up to the programmer to guarantee that instances of Ord are well behaved."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 8873, "user_id": 2913864, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8fd76251e7baccce47654c94e399b915?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/2913864/alan"}, "edited": false, "score": 0, "creation_date": 1465363690, "post_id": 37692106, "comment_id": 62863596, "body": "@Alan and another problem is that you cannot create instances of Ord dynamically, e.g. by reading collation order from a file."}, {"owner": {"reputation": 8873, "user_id": 2913864, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8fd76251e7baccce47654c94e399b915?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/2913864/alan"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1465403570, "post_id": 37692106, "comment_id": 62890211, "body": "@n.m. Unless I&#39;m misunderstanding you, this is readily addressed by a key function.  I&#39;m looking for a reason (a true use case) for using a (potentially inefficient -- see Bakuriu&#39;s comments above) compare function rather than a key function.  (A key function cannot produce the inconsistent rankings illustrated in my original question, so presumably the use case will illustrate why such inconsistency can be desirable.)"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 8873, "user_id": 2913864, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8fd76251e7baccce47654c94e399b915?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/2913864/alan"}, "edited": false, "score": 2, "creation_date": 1465406369, "post_id": 37692106, "comment_id": 62891928, "body": "@Alan &quot;this is readily addressed by a key function&quot; no, it is not. A key function cannot make an ill-behaved Ord instance well-behaved. &quot;A key function cannot produce the inconsistent rankings&quot; A key function does not produce any rankings by itself, it can only do so in conjunction with an instance of Ord. If that instance does not behave, the key function will jolly well produce inconsistent rankings. I&#39;m not sure I can express myself any more clearly."}, {"owner": {"reputation": 8873, "user_id": 2913864, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8fd76251e7baccce47654c94e399b915?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/2913864/alan"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1465407691, "post_id": 37692106, "comment_id": 62892646, "body": "@n.m. So ... one could still screw things up by using a screwed up instance of <code>Ord</code> as the codomain of the <code>key</code> function. But why would you do that?  (Possible response: well why would one write a compare function like the one I posted.) In any case, I was addressing your subsequent comment. And, my motivating question remains: what is a use case where <code>sortOn</code> is not satisfactory but <code>sortBy</code> is?   (In the background I make an assumption: <code>sortOn</code> is simpler, more intuitive, less error prone, and potentially more efficient.  Feel free to challenge this if you feel it is misleading.)"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 8873, "user_id": 2913864, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8fd76251e7baccce47654c94e399b915?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/2913864/alan"}, "edited": false, "score": 1, "creation_date": 1465414105, "post_id": 37692106, "comment_id": 62896337, "body": "@Alan Well, like I said in the other comment, one possible use is that it is easy to make a new ordering by combining existing orderings with <code>sortBy</code>. To sort a hypothetical list of users by join date, last seen and finally alphabetically by user name you could write: <code>sortBy (comparing joinDate &lt;&gt; comparing lastSeen &lt;&gt; comparing username)</code>. It is possible to do this sort of thing with <code>sortOn</code>, but you&#39;d need either new types for every ordering or to pack things into pairs in a way that reflects the particular order you want (which I suspect would be less efficient and maybe less intuitive)."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 8873, "user_id": 2913864, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8fd76251e7baccce47654c94e399b915?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/2913864/alan"}, "edited": false, "score": 3, "creation_date": 1465417164, "post_id": 37692106, "comment_id": 62898057, "body": "@Alan &quot;why would you do that&quot; Who says I would? The original question was IIRC why Haskell won&#39;t police me doing that. The answer to that question is because it cannot. &quot;what is a use case where sortOn is not satisfactory but sortBy is?&quot; Alphabetical sorting of strings in human languages comes to mind. Transformed data would be larger than the original set, and allocations are not free. I didn&#39;t measure it though. Perhaps I should."}, {"owner": {"reputation": 8873, "user_id": 2913864, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8fd76251e7baccce47654c94e399b915?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/2913864/alan"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1465417720, "post_id": 37692106, "comment_id": 62898343, "body": "@n.m. That is certainly the best example offered yet, but I remain dubious.  Would you really reach for <code>sortBy</code> and supply it with nsome complicated comparison function?  I suspect you would make your strings an instance of <code>Ord</code> (as Haskell already does)."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 8873, "user_id": 2913864, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8fd76251e7baccce47654c94e399b915?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/2913864/alan"}, "edited": false, "score": 0, "creation_date": 1465418838, "post_id": 37692106, "comment_id": 62898915, "body": "@Alan Each language has its own sorting rules, so no, can&#39;t do that. An instance of Ord per language is not feasible, the rules are normally stored in locale data files."}, {"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 0, "creation_date": 1465418867, "post_id": 37692106, "comment_id": 62898930, "body": "Sure, you might, especially if you wanted to compare some type that was an instance of <code>Ord</code> but you wanted to compare by some other metric.  The point is Haskell can only constrain by <i>type</i> here, not by implementation."}, {"owner": {"reputation": 8873, "user_id": 2913864, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8fd76251e7baccce47654c94e399b915?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/2913864/alan"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1465419246, "post_id": 37692106, "comment_id": 62899119, "body": "@n.m.  Point taken.  I&#39;m still dubious anyone would approach this problem that way.  I suspect they would wrap the ICU library.  But thanks."}, {"owner": {"reputation": 8873, "user_id": 2913864, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8fd76251e7baccce47654c94e399b915?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/2913864/alan"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1465420707, "post_id": 37692106, "comment_id": 62899779, "body": "@DavidYoung  OK, that&#39;s a good example.  I would be inclined to use <code>sortOn</code> with a key function that produces tuples, which I suspect would be more time efficient and less space efficient.  But thanks."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1465562469, "post_id": 37692106, "comment_id": 62966617, "body": "@n.m., that&#39;s what <code>reflection</code> is for! You can definitely have an <code>Ord</code> instance based on a config file if you like! But sorting strings based on <code>Ord</code> seems odd; I&#39;d expect a bucket/trie sort to be better."}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": false, "score": 1, "last_activity_date": 1465351136, "creation_date": 1465351136, "answer_id": 37692106, "question_id": 37691898, "link": "https://stackoverflow.com/questions/37691898/why-is-sortby-so-oddly-unconstrained-and-why-no-general-sorton/37692106#37692106", "title": "why is sortBy so oddly unconstrained, and why no general sortOn", "body": "<blockquote>\n  <p>What is an application of allowing such things?</p>\n</blockquote>\n\n<p>Depends upon the problem domain you are solving. When you do <code>sortBy xxx [1,2,3,4,5,6,7]</code>, it's just doing what it is supposed to do. <code>sortBy</code> is a function which accepts a function of type <code>(a -&gt; a -&gt; Ordering)</code>. So you can pass any function satisfying that type signature. Haskell doesn't and shouldn't restrict that!</p>\n\n<blockquote>\n  <p>As a point of reference, consider the Python and Mathematica approaches: a list is sorted based on a univariate \"key\" function that maps list items to something already ordered. </p>\n</blockquote>\n\n<p>Not a Python expert, but even with Python 3, I can get this to work:</p>\n\n<pre><code>&gt;&gt;&gt; x = [1,2,3,4,5]\n&gt;&gt;&gt; x.sort(key=lambda x: x % 2 == 0)\n&gt;&gt;&gt; x\n[1, 3, 5, 2, 4]\n</code></pre>\n\n<blockquote>\n  <p>Is this just a legacy, like the one Python discarded, or is there a mathematical motivation for this situation?</p>\n</blockquote>\n\n<p>No, this is not a legacy. This is how it's supposed to work. :)</p>\n"}, {"comments": [{"owner": {"reputation": 2134, "user_id": 2623659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1bd33f70a971bf89c7719005d477e2b?s=128&d=identicon&r=PG", "display_name": "ach", "link": "https://stackoverflow.com/users/2623659/ach"}, "edited": false, "score": 0, "creation_date": 1465351944, "post_id": 37692131, "comment_id": 62860541, "body": "Wouldn&#39;t it be shorter to write <code>xxx a b = compare (even a, a) (even b, b)</code>?"}, {"owner": {"reputation": 8873, "user_id": 2913864, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8fd76251e7baccce47654c94e399b915?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/2913864/alan"}, "reply_to_user": {"reputation": 2134, "user_id": 2623659, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1bd33f70a971bf89c7719005d477e2b?s=128&d=identicon&r=PG", "display_name": "ach", "link": "https://stackoverflow.com/users/2623659/ach"}, "edited": false, "score": 0, "creation_date": 1465355923, "post_id": 37692131, "comment_id": 62861400, "body": "@AndreyChernyakhovskiy Which means the key could just be (\\x-&gt;(even x,x)), again raising the question, why is <code>sortBy</code> salient?"}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 1, "last_activity_date": 1465351389, "creation_date": 1465351389, "answer_id": 37692131, "question_id": 37691898, "link": "https://stackoverflow.com/questions/37691898/why-is-sortby-so-oddly-unconstrained-and-why-no-general-sorton/37692131#37692131", "title": "why is sortBy so oddly unconstrained, and why no general sortOn", "body": "<p>pairwise comparison has some advantages, for example if you slightly change the  comparison function to sort odds before evens but in their natural order, for example</p>\n\n<pre><code>xxx a b | both odd || both even = compare a b\n        | odd a &amp;&amp; even b = LT\n        | otherwise = GT\n       where both f = f a &amp;&amp; f b\n\n&gt; sortBy xxx [1..6]\n[1,3,5,2,4,6]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": false, "score": 0, "last_activity_date": 1465351594, "creation_date": 1465351594, "answer_id": 37692147, "question_id": 37691898, "link": "https://stackoverflow.com/questions/37691898/why-is-sortby-so-oddly-unconstrained-and-why-no-general-sorton/37692147#37692147", "title": "why is sortBy so oddly unconstrained, and why no general sortOn", "body": "<p><code>sortBy</code> isn't going to be terribly meaningful if the function you pass to it doesn't define some kind of <a href=\"https://en.wikipedia.org/wiki/Order_theory#Basic_definitions\" rel=\"nofollow\">ordering</a>: either the result will depend on the implementation details of <code>sortBy</code>, or the result will not be \"sorted\" properly (since <code>sortBy</code> is allowed to take shortcuts assuming transitivity etc.)</p>\n"}, {"comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 2, "creation_date": 1465382171, "post_id": 37693606, "comment_id": 62874514, "body": "AFAIK the reason why Python moved to the key approach is efficiency.  If you are able to map complex objects into simple keys (like <code>int</code>s) then the O(nlog n) comparisons can be done pretty fast. Using a custom comparison function could potentially require O(n log n) costly comparisons. Using keys you need only O(n) potentially costing key function calls and you end up using O(n) extra space (but with generally a small constant there)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1465487835, "post_id": 37693606, "comment_id": 62932955, "body": "@Bakuriu, of course, there are any number of ways to layer that on top of Haskell&#39;s more flexible approach!"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 6, "last_activity_date": 1465362047, "creation_date": 1465362047, "answer_id": 37693606, "question_id": 37691898, "link": "https://stackoverflow.com/questions/37691898/why-is-sortby-so-oddly-unconstrained-and-why-no-general-sorton/37693606#37693606", "title": "why is sortBy so oddly unconstrained, and why no general sortOn", "body": "<p><code>sortBy</code> is unconstrained in essentially the same ways, and for essentially the same reasons, that <code>Ord</code> instances generally are unconstrained. Haskell is not dependently typed. You simply can't state or prove, in Haskell, that a certain relation is actually a total ordering. In a language like Agda, <code>sortBy</code> could take a proof that the ordering really is one, and produce a proof that the result really is a sorted permutation of the input. This is not easy! The Python approach seems to lose some flexibility without gaining any guarantees, so it doesn't smell like a solution.</p>\n"}, {"comments": [{"owner": {"reputation": 8873, "user_id": 2913864, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8fd76251e7baccce47654c94e399b915?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/2913864/alan"}, "edited": false, "score": 0, "creation_date": 1465519048, "post_id": 37735121, "comment_id": 62947283, "body": "The question was not about <i>how</i> to do the equivalent of <code>sortOn</code> but rather why <code>sortBy</code> was privileged.  (<code>sortOn</code> came late to the party for lists and doesn&#39;t even exist for Sequences.)  Nevertheless, I take your point. (Well, there was another part to my question, but in retrospect it seems less interesting.) Separately, doesn&#39;t <code>comparing</code> (in Data.Ord) accomplish what <code>on compare</code> does in your answer? Cheers."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 8873, "user_id": 2913864, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8fd76251e7baccce47654c94e399b915?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/2913864/alan"}, "edited": false, "score": 0, "creation_date": 1465562207, "post_id": 37735121, "comment_id": 62966407, "body": "@Alan, if you send a message to libraries@haskell.org laying out a good argument for adding <code>Data.Sequence.sortOn</code>, and the list does not generally object, and your argument convinces me, then I will add it."}], "tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 3, "last_activity_date": 1465502347, "creation_date": 1465502347, "answer_id": 37735121, "question_id": 37691898, "link": "https://stackoverflow.com/questions/37691898/why-is-sortby-so-oddly-unconstrained-and-why-no-general-sorton/37735121#37735121", "title": "why is sortBy so oddly unconstrained, and why no general sortOn", "body": "<p>Sorting by a function of the elements to some ordered type is easy to express in terms of <code>sortBy</code> and the standard <code>on</code> function (which I believe exists primarily for this precise use case):</p>\n\n<pre><code>import Data.Function (on)\nimport Data.List (sortBy)\n\n-- | Sort in the Python/Mathematica way the question describes.\nsortOn :: Ord key =&gt; (a -&gt; key) -&gt; [a] -&gt; [a]\nsortOn f = sortBy (compare `on` f)\n\n-- Code example\ntype Person = String\ntype Age = Int    \n\nexample :: [(Person, Age)]\nexample = sortOn snd input\n    where input = [ (\"Mary\", 33)\n                  , (\"Mario\", 12)\n                  , (\"Mariama\", 25)\n                  , (\"Mariano\", 58)\n                  ]\n</code></pre>\n\n<p>Some might object here that the key extraction function is not memoized\u2014it will be called over and over on the same arguments (something like N log N calls, I wager.).  But that's easy to fix as well:</p>\n\n<pre><code>sortOn :: Ord key =&gt; (a -&gt; key) -&gt; [a] -&gt; [a]\nsortOn f = map fst \n         . sortBy (compare `on` snd) \n         . map (\\a -&gt; (a, f a))\n</code></pre>\n\n<p>And there's a third factor that should override the performance concerns several commenters have raised: if sorting really is the key performance bottleneck, then perhaps one shouldn't use Haskell's list type in the first place!  The <a href=\"https://hackage.haskell.org/package/vector-algorithms\" rel=\"nofollow\"><code>vector-algorithms</code></a> package provides several sorting algorithms on mutable <code>Vector</code>s.  They do use the <code>e -&gt; e -&gt; Ordering</code> interface discussed here, but again that should be easy to work around if it matters that much.</p>\n\n<p><strong>TL;DR:</strong> Meh.</p>\n"}], "owner": {"reputation": 8873, "user_id": 2913864, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/8fd76251e7baccce47654c94e399b915?s=128&d=identicon&r=PG&f=1", "display_name": "Alan", "link": "https://stackoverflow.com/users/2913864/alan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 640, "favorite_count": 1, "answer_count": 5, "score": 1, "last_activity_date": 1465502347, "creation_date": 1465349303, "last_edit_date": 1465416743, "question_id": 37691898, "link": "https://stackoverflow.com/questions/37691898/why-is-sortby-so-oddly-unconstrained-and-why-no-general-sorton", "title": "why is sortBy so oddly unconstrained, and why no general sortOn", "body": "<p>Example 2 at <a href=\"http://zvon.org/other/haskell/Outputlist/sortBy_f.html\" rel=\"nofollow\">http://zvon.org/other/haskell/Outputlist/sortBy_f.html</a> defines the  comparison function <code>xxx a b = if (odd a) then LT else GT</code>.  Haskell seems happy with this as a comparison function, but I do not understand the meaning of \"comparison\" in such a case.  What is an application of allowing such things? (Here, 2>4 and 4>2.)</p>\n\n<p>As a point of reference, consider the Python and Mathematica approaches: a list is sorted based on a univariate \"key\" function that maps list items to something already ordered.  This seems eminently sensible.  (In fact, Python dropped Haskell-like comparisons for sorting as superfluous and replaced them with sort keys.)  What is the basis for Haskell's (apparently) conflicting judgment on this?  Is there any talk of providing <code>sortOn</code> functionality to encourage a more coherent (?) notion of \"comparison\".  (I recognized that a \"key\" function could be used in a comparison function or in making the data type to be sorted an instance of <code>Ord</code>, but this just feels needlessly awkward and indirect for something so simple.)</p>\n\n<p>What am I missing?  Is this just a legacy, like the one Python discarded, or is there a mathematical motivation for this situation?</p>\n\n<p>Edit: As noted by Nouri, <code>Data.List.sortOn</code> does exist for lists.  This was apparently added in 2014.</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 2, "creation_date": 1465329509, "post_id": 37688094, "comment_id": 62853582, "body": "Note that incomplete patterns with <code>&lt;-</code> end up calling the <code>fail</code> function of that monad. So at least in old versions of Haskell the code isn&#39;t per se wrong, there could be valid results: <code>Prelude&gt; let {x::[Int]; x = do {[y] &lt;- return [1,2]; return y}} Prelude&gt; x [] </code>  Or changing <code>x :: [Int]</code>  to <code>x :: Maybe Int</code> you get <code>Nothing</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1465329684, "post_id": 37688094, "comment_id": 62853680, "body": "Indeed, fixing this would require to know when <code>fail</code> is returning bottom, which is tricky. I&#39;d still want <code>[ f x | Just x &lt;- list ]</code> and the equivalent <code>do Just x &lt;- list ; return (f x)</code> not to trigger warnings. Not sure how one can realistically achieve this..."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 7, "creation_date": 1465332670, "post_id": 37688094, "comment_id": 62855133, "body": "I propose you file a GHC feature request for <code>-fwarn-implicit-fail</code> or similar that warns when desugaring inserts a call to <code>fail</code> that wasn&#39;t in the source."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 2, "creation_date": 1465387930, "post_id": 37688094, "comment_id": 62878253, "body": "I think the expectation is that when you use <code>&lt;-</code> in that way you know what you are doing and are accept that <code>fail</code> may get called. After all, you can only specify a single pattern so you should know if the pattern is exhaustive or not. It&#39;s also a very convenient feature - the pattern <code>Just ... &lt;-</code> alone appears several hundred times in Hackage. It would be interesting to see the original discussion that went on when it was added to GHC - I&#39;m sure the pros and cons were extensively debated."}, {"owner": {"reputation": 1375, "user_id": 420038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14e486867defc84340f1837639ca54ee?s=128&d=identicon&r=PG", "display_name": "thomie", "link": "https://stackoverflow.com/users/420038/thomie"}, "edited": false, "score": 3, "creation_date": 1466854824, "post_id": 37688094, "comment_id": 63496333, "body": "<a href=\"https://ghc.haskell.org/trac/ghc/ticket/5813\" rel=\"nofollow noreferrer\">ghc.haskell.org/trac/ghc/ticket/5813</a> &quot;Offer a compiler warning for failable pattern matches&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 4072, "user_id": 4400060, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/9g6QZ.png?s=128&g=1", "display_name": "radrow", "link": "https://stackoverflow.com/users/4400060/radrow"}, "is_accepted": false, "score": 0, "last_activity_date": 1603970644, "creation_date": 1603970644, "answer_id": 64590151, "question_id": 37688094, "link": "https://stackoverflow.com/questions/37688094/how-can-i-get-ghc-to-warn-about-incomplete-pattern-bindings-in-do-blocks/64590151#64590151", "title": "How can I get GHC to warn about incomplete pattern bindings in do blocks?", "body": "<p>As for now, the only thing you can do in order to avoid bugs due to this quirk is to avoid monads with <code>MonadFail</code> instance (in recent GHC versions incomplete bind patterns would then lead to a compilation error).</p>\n<p><a href=\"https://gitlab.haskell.org/ghc/ghc/-/issues/5813\" rel=\"nofollow noreferrer\">There is already an issue for this</a>. There is also a statement defending this solution stating that it may be something completely desirable and therefore does not deserve a warning:</p>\n<blockquote>\n<p>This is actually the right useful behavior. using things like</p>\n<pre><code>do\n  Just x &lt;- xs\n  Just y &lt;- ys\n  return (x,y)\n</code></pre>\n<p>will do the right thing, failing if xs or ysresults in Nothing. for\ninstance, in the list monad, it will create the cross product of the\nnon Nothing members of the two lists. a parse monad may backtrack and\ntry another route, the IO monad will create a useful (and\ndeterministic/catchable) exception pointing to the exact file and line\nnumber of the pattern match. The do notation is the only place in\nhaskell that allows us to hook into the pattern matching mechanism of\nthe language in a general way.</p>\n</blockquote>\n"}], "owner": {"reputation": 945, "user_id": 463800, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1327ce755b24b956995d68accae3eab2?s=128&d=identicon&r=PG", "display_name": "jml", "link": "https://stackoverflow.com/users/463800/jml"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 577, "favorite_count": 2, "answer_count": 1, "score": 13, "last_activity_date": 1603970644, "creation_date": 1465329001, "question_id": 37688094, "link": "https://stackoverflow.com/questions/37688094/how-can-i-get-ghc-to-warn-about-incomplete-pattern-bindings-in-do-blocks", "title": "How can I get GHC to warn about incomplete pattern bindings in do blocks?", "body": "<p>The following Haskell program is broken, because it does an incomplete pattern binding:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>main = do\n  [x] &lt;- pure [\"foo\", \"bar\"]\n  print x\n</code></pre>\n\n<p>If you compile it, you'll get no warnings:</p>\n\n<pre><code>$ ghc -fwarn-incomplete-uni-patterns -o example example.hs\n[1 of 1] Compiling Main             ( example.hs, example.o )\nLinking example ...\n</code></pre>\n\n<p>but if you run it you'll get:</p>\n\n<pre><code>example: user error (Pattern match failure in do expression at example.hs:2:3-5)\n</code></pre>\n\n<p>I would like to somehow get a compiler warning.</p>\n\n<p>From the documentation, I would have thought <code>-fwarn-incomplete-uni-patterns</code> would do it, since the <code>do</code> block desugars to:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>desugared = pure [\"foo\", \"bar\"] &gt;&gt;= \\[x] -&gt; print x\n</code></pre>\n\n<p>And indeed, adding that to the example file does produce a warning:</p>\n\n<pre><code>$ ghc -fwarn-incomplete-uni-patterns -o example example.hs\n[1 of 1] Compiling Main             ( example.hs, example.o )\n\nexample.hs:1:37: Warning:\n    Pattern match(es) are non-exhaustive\n    In a lambda abstraction:\n        Patterns not matched:\n            []\n            _ : (_ : _)\n</code></pre>\n\n<p>How do I get a similar warning when I do the same thing inside a <code>do</code> block?</p>\n\n<pre><code>$ ghc --version\nThe Glorious Glasgow Haskell Compilation System, version 7.10.3\n</code></pre>\n"}, {"tags": ["haskell", "ffi"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 2, "creation_date": 1465327726, "post_id": 37687318, "comment_id": 62852546, "body": "I clicked on the link and may I just say that the new GHC docs look marvellous!"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1465328035, "post_id": 37687318, "comment_id": 62852713, "body": "I think the difference lies with the import of plain c-files and header files, but this is only guessing, I have actually never used the FFI."}], "answers": [{"comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 6, "creation_date": 1465369239, "post_id": 37688666, "comment_id": 62866165, "body": "Do you have any concrete reasons for preferring <code>ccall</code> over <code>capi</code>? C libraries are normally defined by their API, not ABI, and using <code>ccall</code> often causes problems when porting to exotic platforms (such as Android) that choose to implement some functions as macros that can be easily avoided by using <code>capi</code>. I&#39;ve never encountered an issue caused by using <code>capi</code> over <code>ccall</code> (though that is probably just because people rarely use <code>capi</code> in the first place)."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 6, "last_activity_date": 1465331073, "creation_date": 1465331073, "answer_id": 37688666, "question_id": 37687318, "link": "https://stackoverflow.com/questions/37687318/difference-between-ccall-and-capi-ffi-calling-conventions/37688666#37688666", "title": "Difference between ccall and capi FFI calling conventions", "body": "<p><code>ccall</code> is the normal way. It works by directly linking against a symbol defined in a (usually written in C) library.</p>\n\n<p><code>capi</code> is a ghc extension that works on the C source level. That's why it can access things that don't exist at the ABI level, such as macros. (I don't know how it's implemented, but I would guess it generates a small C function wrapper, which it then compiles with a C compiler behind the scenes.)</p>\n\n<p>I would use <code>ccall</code> where possible. It's part of the language standard and looks less \"magical\" in general.</p>\n"}], "owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 230, "favorite_count": 0, "accepted_answer_id": 37688666, "answer_count": 1, "score": 5, "last_activity_date": 1465331073, "creation_date": 1465326170, "last_edit_date": 1465330292, "question_id": 37687318, "link": "https://stackoverflow.com/questions/37687318/difference-between-ccall-and-capi-ffi-calling-conventions", "title": "Difference between ccall and capi FFI calling conventions", "body": "<p>I discovered that there are two calling conventions using <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/ffi-chap.html\" rel=\"nofollow\">GHC's FFI</a>: <code>ccall</code> and <code>capi</code>. The docs don't have much information about the two conventions. What is the difference between them, and when should I use each one? Is one faster than the other?</p>\n"}, {"tags": ["haskell", "types"], "answers": [{"tags": [], "owner": {"reputation": 9139, "user_id": 773228, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/baaecdda322cf4462a0dd018d7959b1e?s=128&d=identicon&r=PG&f=1", "display_name": "Justin Wood", "link": "https://stackoverflow.com/users/773228/justin-wood"}, "is_accepted": true, "score": 11, "last_activity_date": 1465318223, "creation_date": 1465318223, "answer_id": 37685009, "question_id": 37684907, "link": "https://stackoverflow.com/questions/37684907/haskell-access-field-of-a-type/37685009#37685009", "title": "Haskell - Access field of a type", "body": "<p>I would suggest using records when creating such a large type. Something along the lines of</p>\n\n<pre><code>data Book = Book { pages  :: Int\n                 , author :: String\n                 , title  :: String\n                 }\n</code></pre>\n\n<p>at which point, if you ever wanted the author of a book, it is as simple as</p>\n\n<pre><code>main = do\n  let book = Book 20 \"me\" \"my book\"\n  putStrLn (author book)\n</code></pre>\n\n<p>which would print the author of your book.</p>\n\n<p>Records essentially create functions that pull out only a single piece of data from your type.</p>\n"}, {"comments": [{"owner": {"reputation": 6415, "user_id": 1416525, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/6f23f148b7241e345a61d193ed205685?s=128&d=identicon&r=PG", "display_name": "cdk", "link": "https://stackoverflow.com/users/1416525/cdk"}, "edited": false, "score": 2, "creation_date": 1465326746, "post_id": 37685047, "comment_id": 62852050, "body": "Even better than type synonyms would be to use <code>newtype</code> so that <code>Title</code>, <code>Author</code>, <code>Genre</code> etc. cannot be used in place of each other."}], "tags": [], "owner": {"reputation": 6025, "user_id": 3053082, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cf7725958a43181e6b2b4c0f5f02b91b?s=128&d=identicon&r=PG&f=1", "display_name": "Kapol", "link": "https://stackoverflow.com/users/3053082/kapol"}, "is_accepted": false, "score": 5, "last_activity_date": 1465321506, "last_edit_date": 1465321506, "creation_date": 1465318371, "answer_id": 37685047, "question_id": 37684907, "link": "https://stackoverflow.com/questions/37684907/haskell-access-field-of-a-type/37685047#37685047", "title": "Haskell - Access field of a type", "body": "<p>If you want to use a type synonym, then you have to manually create functions to retrieve every \"field\" of your <code>Book</code> type:</p>\n\n<pre><code>getTitle :: Book -&gt; String\ngetTitle (_, title, _, _, _, _, _) = title\n</code></pre>\n\n<p>I would recommend you to create your own data type using <em>record syntax</em> to get such functions for free.</p>\n\n<p>Additionally, when creating such complex type synonyms, you can create other synonyms that represent the individual parts of your main synonym to make clear what the <code>Book</code> represents.</p>\n\n<pre><code>type Isbn = Int\ntype Title = String\ntype Author = String\ntype Genre = String\ntype Date = String \ntype Publisher = String\ntype Summary = String\n\ntype Book = (Isbn, Title, Author, Genre, Date, Publisher, Summary)\n</code></pre>\n\n<p>Then <code>getTitle</code> can have the type <code>Book -&gt; Title</code></p>\n"}], "owner": {"reputation": 95, "user_id": 4687529, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh6.googleusercontent.com/-E6XgPOn1Tb8/AAAAAAAAAAI/AAAAAAAAABk/FqvUYEijHFo/photo.jpg?sz=128", "display_name": "Eric Marchetti Santos", "link": "https://stackoverflow.com/users/4687529/eric-marchetti-santos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1918, "favorite_count": 0, "accepted_answer_id": 37685009, "answer_count": 2, "score": 2, "last_activity_date": 1465321506, "creation_date": 1465317882, "last_edit_date": 1465318724, "question_id": 37684907, "link": "https://stackoverflow.com/questions/37684907/haskell-access-field-of-a-type", "title": "Haskell - Access field of a type", "body": "<p>I have created a type in Haskell but I have no idea on how to get one of the fields of my created type. How should I go about? Should I make a function <code>Book -&gt; String</code> or something like that?</p>\n\n<pre><code>import Data.List\nimport System.IO\n\n\ntype Book = (Int, String, String, String, String, String, String)\n\n\n\nbookNew :: Int -&gt; String -&gt; String-&gt; String -&gt; String -&gt; String -&gt; String -&gt; Book\nbookNew isbn title author genre date publisher summary =\n   (isbn,title,author,genre,date,publisher,summary):: Book \n\n\nmain = do\n   let book = bookNew 1 \"title\" \"author\" \"genre\" \"date\" \"publisher\" \"summary\"\n   --Access title of \"book\" somehow\n   return book\n</code></pre>\n"}, {"tags": ["sorting", "haskell", "vector"], "comments": [{"owner": {"reputation": 791, "user_id": 1587319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c8a88b9a8d79a518cba52a7a8d099f9?s=128&d=identicon&r=PG", "display_name": "pdexter", "link": "https://stackoverflow.com/users/1587319/pdexter"}, "edited": false, "score": 0, "creation_date": 1465310124, "post_id": 37682168, "comment_id": 62841530, "body": "<code>V.fromList $ sortOn  snd (V.toList (V.zip x y))</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 791, "user_id": 1587319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c8a88b9a8d79a518cba52a7a8d099f9?s=128&d=identicon&r=PG", "display_name": "pdexter", "link": "https://stackoverflow.com/users/1587319/pdexter"}, "edited": false, "score": 1, "creation_date": 1465330732, "post_id": 37682168, "comment_id": 62854235, "body": "@pdexter, wouldn&#39;t using a sort from <code>vector-algorithms</code> along with <code>Data.Vector.Modify</code> be faster than converting to a list, sorting, and converting back?"}, {"owner": {"reputation": 791, "user_id": 1587319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c8a88b9a8d79a518cba52a7a8d099f9?s=128&d=identicon&r=PG", "display_name": "pdexter", "link": "https://stackoverflow.com/users/1587319/pdexter"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1465331104, "post_id": 37682168, "comment_id": 62854416, "body": "@dfeuer, yes, most likely"}], "answers": [{"comments": [{"owner": {"reputation": 6241, "user_id": 722869, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1c5c02f9165e188ab81a53efabc062e2?s=128&d=identicon&r=PG", "display_name": "daj", "link": "https://stackoverflow.com/users/722869/daj"}, "edited": false, "score": 0, "creation_date": 1465310936, "post_id": 37682305, "comment_id": 62842170, "body": "is there a go-to drop-in replacement for Data.List (sort)? Most sorting functionality for vector seems to be intended for mutable / boxed variants."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1465310209, "creation_date": 1465310209, "answer_id": 37682305, "question_id": 37682168, "link": "https://stackoverflow.com/questions/37682168/how-to-re-order-vector-values-based-on-the-sort-order-from-another-vector-in-has/37682305#37682305", "title": "How to re-order vector values based on the sort-order from another vector in haskell?", "body": "<p>Here's a list-based way:</p>\n\n<pre><code>&gt; import Data.List\n&gt; let x = [\"foo\", \"bar\", \"baz\"]\n&gt; let y = [1,3,2]\n&gt; map snd . sort $ zip y x\n[\"foo\",\"baz\",\"bar\"]\n</code></pre>\n\n<p>Basically, we zip so to obtain a list of pairs</p>\n\n<pre><code>[(1,\"foo\"),(3,\"bar\"),(2,\"baz\")]\n</code></pre>\n\n<p>Then we sort it, lexicographically, so that the first component matters more.</p>\n\n<p>Finally, we discard the first components.</p>\n\n<p>You should be able to adapt this to vectors as well.</p>\n"}, {"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 5, "last_activity_date": 1465328669, "last_edit_date": 1465328669, "creation_date": 1465312816, "answer_id": 37683316, "question_id": 37682168, "link": "https://stackoverflow.com/questions/37682168/how-to-re-order-vector-values-based-on-the-sort-order-from-another-vector-in-has/37683316#37683316", "title": "How to re-order vector values based on the sort-order from another vector in haskell?", "body": "<p>I think you are looking for <a href=\"http://hackage.haskell.org/package/vector-0.11.0.0/docs/Data-Vector.html#v:backpermute\" rel=\"nofollow\"><code>backpermute</code></a></p>\n\n<blockquote>\n<pre><code>backpermute :: Vector a -&gt; Vector Int -&gt; Vector a\n</code></pre>\n  \n  <p><em>O(n)</em> Yield the vector obtained by replacing each element <code>i</code> of the index vector by <code>xs!i</code>. This is equivalent to <code>map (xs!)</code> is but is often much more efficient.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": false, "score": 1, "last_activity_date": 1465353173, "last_edit_date": 1465353173, "creation_date": 1465319712, "answer_id": 37685417, "question_id": 37682168, "link": "https://stackoverflow.com/questions/37682168/how-to-re-order-vector-values-based-on-the-sort-order-from-another-vector-in-has/37685417#37685417", "title": "How to re-order vector values based on the sort-order from another vector in haskell?", "body": "<p>Sort a vector of <em>indices</em> comparing indexed values; then <a href=\"http://hackage.haskell.org/package/vector-0.11.0.0/docs/Data-Vector.html#v:backpermute\" rel=\"nofollow\">permute</a> both vectors based on sorted indices. <a href=\"http://hackage.haskell.org/package/vector-algorithms-0.7.0.1/docs/Data-Vector-Algorithms-Intro.html\" rel=\"nofollow\">Data.Vector.Algorithms.Intro</a> provides \n<a href=\"https://en.wikipedia.org/wiki/Introsort\" rel=\"nofollow\">introsort</a> for mutable vectors and <a href=\"http://hackage.haskell.org/package/vector-0.11.0.0/docs/Data-Vector-Generic.html#g:18\" rel=\"nofollow\"><code>modify</code></a> provides safe destructive updates using <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Control-Monad-ST.html\" rel=\"nofollow\">ST Monad</a>.</p>\n\n<pre><code>import Data.Ord (comparing)\nimport Data.Vector.Algorithms.Intro (sortBy)\nimport Data.Vector.Unboxed (generate, modify)\nimport Data.Vector (Vector, unsafeIndex, backpermute, convert, fromList)\nimport qualified Data.Vector as V\n\nreorder :: (Ord b) =&gt; Vector a -&gt; Vector b -&gt; (Vector a, Vector b)\nreorder a b = (backpermute a idx, backpermute b idx)\n    where\n    idx  = convert $ modify (sortBy comp) init\n    comp = comparing $ unsafeIndex b  -- comparing function\n    init = generate (V.length b) id   -- [0..size - 1]\n</code></pre>\n\n<p>then,</p>\n\n<pre><code>\\&gt; reorder (fromList [\"foo\", \"bar\", \"baz\"]) $ fromList [1, 3, 2]\n([\"foo\",\"baz\",\"bar\"],[1,2,3])\n</code></pre>\n"}], "owner": {"reputation": 6241, "user_id": 722869, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1c5c02f9165e188ab81a53efabc062e2?s=128&d=identicon&r=PG", "display_name": "daj", "link": "https://stackoverflow.com/users/722869/daj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 633, "favorite_count": 0, "accepted_answer_id": 37682305, "answer_count": 3, "score": 2, "last_activity_date": 1465353173, "creation_date": 1465309853, "last_edit_date": 1465311192, "question_id": 37682168, "link": "https://stackoverflow.com/questions/37682168/how-to-re-order-vector-values-based-on-the-sort-order-from-another-vector-in-has", "title": "How to re-order vector values based on the sort-order from another vector in haskell?", "body": "<p>suppose i have two vectors:</p>\n\n<pre><code>  let x = V.fromList [\"foo\", \"bar\", \"baz\"]\n  let y = V.fromList [1,3,2]\n</code></pre>\n\n<p>I want to define a vector <code>y'</code> which is the sorted version of <code>y</code>, but I also want to defined a reordered <code>x'</code> which is ordered based on the sort ordering of <code>y</code> (<code>x'</code> should look like <code>[\"foo\", \"baz\", \"bar\"]</code>). </p>\n\n<p>What's the best function to do that? Ideally, I want to avoid writing sorting functions from scratch.</p>\n"}, {"tags": ["string", "haskell", "monads"], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 3, "creation_date": 1465323293, "post_id": 37681969, "comment_id": 62850074, "body": "<code>replicate 10</code> is a better version of <code>take 10 . repeat</code>."}], "tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": false, "score": 4, "last_activity_date": 1465309281, "creation_date": 1465309281, "answer_id": 37681969, "question_id": 37681485, "link": "https://stackoverflow.com/questions/37681485/haskell-print-10-times-input-string-do-notation/37681969#37681969", "title": "haskell print 10 times input string, do-notation", "body": "<p><code>repeat</code> only takes a single argument and repeats it indefinitely. You are probably looking for <code>take 10 $ repeat name</code>.</p>\n\n<p>If you want to print a list, you may be better off using <code>mapM_</code> to map <code>putStrLn</code> against each element in the list. Try this out:</p>\n\n\n\n<pre class=\"lang-haskell prettyprint-override\"><code>print10Times :: String -&gt; IO ()\nprint10Times name = mapM_ putStrLn $ take 10 $ repeat name\n</code></pre>\n\n<p>Or, put more succinctly:</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>print10Times = mapM_ putStrLn . take 10 . repeat\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 0, "creation_date": 1465326176, "post_id": 37682359, "comment_id": 62851747, "body": "with <code>:set +m</code> you can enable multi line input mode in ghci."}], "tags": [], "owner": {"reputation": 791, "user_id": 1587319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c8a88b9a8d79a518cba52a7a8d099f9?s=128&d=identicon&r=PG", "display_name": "pdexter", "link": "https://stackoverflow.com/users/1587319/pdexter"}, "is_accepted": false, "score": 5, "last_activity_date": 1465310327, "creation_date": 1465310327, "answer_id": 37682359, "question_id": 37681485, "link": "https://stackoverflow.com/questions/37681485/haskell-print-10-times-input-string-do-notation/37682359#37682359", "title": "haskell print 10 times input string, do-notation", "body": "<p>You can use <code>replicateM_</code> for this.</p>\n\n<pre><code>\u039b: :t replicateM_\nreplicateM_ :: Monad m =&gt; Int -&gt; m a -&gt; m ()\n\u039b: do { putStrLn \"what is your name?\" ; name &lt;- getLine ; replicateM_ 10 (putStrLn name) }\nwhat is your name?\nnone of your business\nnone of your business\nnone of your business\nnone of your business\nnone of your business\nnone of your business\nnone of your business\nnone of your business\nnone of your business\nnone of your business\nnone of your business\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1465315317, "last_edit_date": 1495535324, "creation_date": 1465315317, "answer_id": 37684159, "question_id": 37681485, "link": "https://stackoverflow.com/questions/37681485/haskell-print-10-times-input-string-do-notation/37684159#37684159", "title": "haskell print 10 times input string, do-notation", "body": "<p>You can definitely use <code>replicateM_</code> like <a href=\"https://stackoverflow.com/a/37682359/67579\">@pdexter</a> suggests, or you can rewrite it using recursion:</p>\n\n<pre><code>print10Times :: String -&gt; IO ()\nprint10Times = printNTimes 10\n\nprintNTimes :: Int -&gt; String -&gt; IO ()\nprintNTimes n name | n &lt;= 0 = return ()\n                   | otherwise = do\n                         putStrLn name\n                         printNTimes (n-1) name\n\nmain :: IO ()\nmain = do\n  putStrLn \"What is your name?\"\n  name &lt;- getLine\n  print10Times name\n</code></pre>\n\n<p><code>print10Times</code> simply redirects control to <code>printNTimes</code> with a constant <code>10</code> (the number of times it should be printed). Then a decrement is performed each time the name is printed and <code>return ()</code> is done if the counter hits <code>0</code>.</p>\n\n<p>This is a bit reinventing <code>replicateM_</code> which could be defined as:</p>\n\n<pre><code>replicateM_ :: (Monad m, Num n, Ord n) =&gt; n -&gt; m a -&gt; m ()\nreplicateM_ n f = loop n\n    where loop i | i &lt;= 0 = return ()\n                 | otherwise = f &gt;&gt; loop (i-1)\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 2931588, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93a9499a898bce63dd78f23826dfe02f?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/2931588/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 644, "favorite_count": 0, "closed_date": 1465319480, "answer_count": 3, "score": 0, "last_activity_date": 1465484328, "creation_date": 1465307881, "last_edit_date": 1465484328, "question_id": 37681485, "link": "https://stackoverflow.com/questions/37681485/haskell-print-10-times-input-string-do-notation", "closed_reason": "Needs details or clarity", "title": "haskell print 10 times input string, do-notation", "body": "<p>Take input as a string and print it 10 times using do-notation?</p>\n\n<pre class=\"lang-haskell prettyprint-override\"><code>print10Times :: String -&gt; IO ()\nprint10Times name = putStrLn $ repeat 10 name\n\nmain :: IO ()\nmain = do\n  putStrLn \"What is your name?\"\n  name &lt;- getLine\n  print10Times name\n</code></pre>\n"}, {"tags": ["parsing", "haskell", "parsec", "mutual-recursion"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1465309028, "post_id": 37681474, "comment_id": 62840734, "body": "Please try to boil that down to a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> and give a proper description of the problems you get."}, {"owner": {"reputation": 881, "user_id": 646565, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Cu0yq.jpg?s=128&g=1", "display_name": "freinn", "link": "https://stackoverflow.com/users/646565/freinn"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1465309879, "post_id": 37681474, "comment_id": 62841362, "body": "done @leftaroundabout, now is better explained and shortened."}, {"owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1465313878, "post_id": 37681474, "comment_id": 62844439, "body": "Could you comment in the expected values for <code>getResult 1 &quot;46+10&quot;</code> and <code>getResult 1 &quot;46+10+1&quot;</code>?"}, {"owner": {"reputation": 881, "user_id": 646565, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Cu0yq.jpg?s=128&g=1", "display_name": "freinn", "link": "https://stackoverflow.com/users/646565/freinn"}, "reply_to_user": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "edited": false, "score": 0, "creation_date": 1465318271, "post_id": 37681474, "comment_id": 62847181, "body": "@haoformayor exactly the integer value of the arithmetic expression, so 56 and 57 respectively"}], "answers": [{"comments": [{"owner": {"reputation": 881, "user_id": 646565, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Cu0yq.jpg?s=128&g=1", "display_name": "freinn", "link": "https://stackoverflow.com/users/646565/freinn"}, "edited": false, "score": 0, "creation_date": 1465318374, "post_id": 37683882, "comment_id": 62847243, "body": "I&#39;m just trying this algorithm to work, but I&#39;ve upvoted your answer because I think is helpful for my future work and for the readers of this question."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 1, "last_activity_date": 1465331637, "last_edit_date": 1465331637, "creation_date": 1465314450, "answer_id": 37683882, "question_id": 37681474, "link": "https://stackoverflow.com/questions/37681474/precedence-climbing-in-haskell-parsec-mutual-recursion-error/37683882#37683882", "title": "precedence climbing in haskell: parsec mutual recursion error", "body": "<p>I'm not sure exactly what's wrong with your code but I'll offer these comments:</p>\n\n<p><em>(1)</em> These statements are not equivalent:</p>\n\n<pre><code>Generic Imperative: rhs = compute_expr(next_min_prec)\n\nHaskell:            rhs &lt;- computeExpr(next_min_prec)\n</code></pre>\n\n<p>The imperative call to <code>compute_expr</code> will <em>always</em> return. The Haskell call may fail in which case the stuff following the call never happens.</p>\n\n<p><em>(2)</em> You are really working against Parsec's strengths by trying to parse tokens one at a time in sequence. To see the \"Parsec way\" of generically parsing expressions with operators of various precedences and associativities, have a look at:</p>\n\n<ul>\n<li><a href=\"http://hackage.haskell.org/package/parsec-3.1.10/docs/Text-Parsec-Expr.html#v:buildExpressionParser\" rel=\"nofollow\"><code>buildExpression</code></a></li>\n<li><a href=\"http://www.mega-nerd.com/erikd/Blog/CodeHacking/Haskell/parsec_expression_parsing.html\" rel=\"nofollow\">Parsec and Expression Printing</a></li>\n</ul>\n\n<p><strong>Update</strong></p>\n\n<p>I've posted a solution to <a href=\"http://lpaste.net/165651\" rel=\"nofollow\">http://lpaste.net/165651</a></p>\n"}], "owner": {"reputation": 881, "user_id": 646565, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Cu0yq.jpg?s=128&g=1", "display_name": "freinn", "link": "https://stackoverflow.com/users/646565/freinn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 37683882, "answer_count": 1, "score": 0, "last_activity_date": 1465331637, "creation_date": 1465307853, "last_edit_date": 1465309528, "question_id": 37681474, "link": "https://stackoverflow.com/questions/37681474/precedence-climbing-in-haskell-parsec-mutual-recursion-error", "title": "precedence climbing in haskell: parsec mutual recursion error", "body": "<p>I'm programming the precedence climbing algorithm in Haskell, but for a reason unknown to me, does not work. I think that Parsec state info is lost at some point, but I don't even know that is the source of the error:</p>\n\n<pre><code>module PrecedenceClimbing where\n\nimport Text.Parsec\nimport Text.Parsec.Char\n\n{-\nAlgorithm\n\ncompute_expr(min_prec):\n  result = compute_atom()\n\n  while cur token is a binary operator with precedence &gt;= min_prec:\n    prec, assoc = precedence and associativity of current token\n    if assoc is left:\n      next_min_prec = prec + 1\n    else:\n      next_min_prec = prec\n    rhs = compute_expr(next_min_prec)\n    result = compute operator(result, rhs)\n\n  return result\n-}\n\ntype Precedence = Int\ndata Associativity = LeftAssoc\n                   | RightAssoc\n                   deriving (Eq, Show)\ndata OperatorInfo = OPInfo Precedence Associativity (Int -&gt; Int -&gt; Int)\n\nmkOperator :: Char -&gt; OperatorInfo\nmkOperator = \\c -&gt; case c of\n                     '+' -&gt; OPInfo 1 LeftAssoc  (+)\n                     '-' -&gt; OPInfo 1 LeftAssoc  (-)\n                     '*' -&gt; OPInfo 2 LeftAssoc  (*)\n                     '/' -&gt; OPInfo 2 LeftAssoc  div\n                     '^' -&gt; OPInfo 3 RightAssoc (^)\n\ngetPrecedence :: OperatorInfo -&gt; Precedence\ngetPrecedence (OPInfo prec _ _) = prec\n\ngetAssoc :: OperatorInfo -&gt; Associativity\ngetAssoc (OPInfo _ assoc _) = assoc\n\ngetFun :: OperatorInfo -&gt; (Int -&gt; Int -&gt; Int)\ngetFun (OPInfo _ _ fun) = fun\n\nnumber :: Parsec String () Int\nnumber = do\n  spaces\n  fmap read $ many1 digit\n\noperator :: Parsec String () OperatorInfo\noperator = do\n  spaces\n  fmap mkOperator $ oneOf \"+-*/^\"\n\ncomputeAtom = do\n  spaces\n  number\n\nloop minPrec res = (do\n  oper &lt;- operator\n  let prec = getPrecedence oper\n  if prec &gt;= minPrec\n  then do\n    let assoc = getAssoc oper\n        next_min_prec = if assoc == LeftAssoc\n                        then prec + 1\n                        else prec\n    rhs &lt;- computeExpr(next_min_prec)\n    loop minPrec $ getFun oper res rhs\n  else return res) &lt;|&gt; (return res)\n\ncomputeExpr :: Int -&gt; Parsec String () Int\ncomputeExpr minPrec = (do\n  result &lt;- computeAtom\n  loop minPrec result) &lt;|&gt; (computeAtom)\n\ngetResult minPrec = parse (computeExpr minPrec) \"\"\n</code></pre>\n\n<p>My program for some reason is only processing the first operation or the first operand depending on the case, but does not go any further</p>\n\n<p>GHCi session:</p>\n\n<pre><code>*PrecedenceClimbing&gt; getResult 1 \"46+10\"\nRight 56\n*PrecedenceClimbing&gt; getResult 1 \"46+10+1\"\nRight 56\n</code></pre>\n"}, {"tags": ["web-services", "rest", "haskell", "servant"], "comments": [{"owner": {"reputation": 791, "user_id": 1587319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c8a88b9a8d79a518cba52a7a8d099f9?s=128&d=identicon&r=PG", "display_name": "pdexter", "link": "https://stackoverflow.com/users/1587319/pdexter"}, "edited": false, "score": 1, "creation_date": 1465303297, "post_id": 37679436, "comment_id": 62836244, "body": "This looks like valid syntax. What exactly do you want to do that <code>:&gt;</code> doesn&#39;t do? That does compose apis."}], "answers": [{"comments": [{"owner": {"reputation": 6241, "user_id": 722869, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1c5c02f9165e188ab81a53efabc062e2?s=128&d=identicon&r=PG", "display_name": "daj", "link": "https://stackoverflow.com/users/722869/daj"}, "edited": false, "score": 0, "creation_date": 1465307392, "post_id": 37680165, "comment_id": 62839527, "body": "is there a way to do this without the top level &quot;users&quot; in the route? The problem is that code generated by servant-JS no longer works because it doesn&#39;t correspond to CombinedAPI. I can&#39;t run writeJSForAPI on my equivalent of CombinedAPI because it includes a Raw combinator which doesn&#39;t have a GenerateList instance."}, {"owner": {"reputation": 1049, "user_id": 793874, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/512e19604a6878fd5aa38c4f180d5af9?s=128&d=identicon&r=PG", "display_name": "klappvisor", "link": "https://stackoverflow.com/users/793874/klappvisor"}, "reply_to_user": {"reputation": 6241, "user_id": 722869, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1c5c02f9165e188ab81a53efabc062e2?s=128&d=identicon&r=PG", "display_name": "daj", "link": "https://stackoverflow.com/users/722869/daj"}, "edited": false, "score": 0, "creation_date": 1465307831, "post_id": 37680165, "comment_id": 62839847, "body": "Sorry, cannot answer that question right now. best way to test it is to try it. I don&#39;t think  <code>UsersAPI :&lt;|&gt; &quot;products&quot; :&gt; ProductsAPI</code> is invalid thing to do"}, {"owner": {"reputation": 6241, "user_id": 722869, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1c5c02f9165e188ab81a53efabc062e2?s=128&d=identicon&r=PG", "display_name": "daj", "link": "https://stackoverflow.com/users/722869/daj"}, "edited": false, "score": 0, "creation_date": 1465308342, "post_id": 37680165, "comment_id": 62840210, "body": "you&#39;re right it is valid. to do that following your example and excluding the top level piece of the route. wasn&#39;t compiling because I had the ordering mixed up in the implementation definition."}, {"owner": {"reputation": 1049, "user_id": 793874, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/512e19604a6878fd5aa38c4f180d5af9?s=128&d=identicon&r=PG", "display_name": "klappvisor", "link": "https://stackoverflow.com/users/793874/klappvisor"}, "reply_to_user": {"reputation": 6241, "user_id": 722869, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1c5c02f9165e188ab81a53efabc062e2?s=128&d=identicon&r=PG", "display_name": "daj", "link": "https://stackoverflow.com/users/722869/daj"}, "edited": false, "score": 0, "creation_date": 1465309560, "post_id": 37680165, "comment_id": 62841102, "body": "Glad that everything is sorted out!"}], "tags": [], "owner": {"reputation": 1049, "user_id": 793874, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/512e19604a6878fd5aa38c4f180d5af9?s=128&d=identicon&r=PG", "display_name": "klappvisor", "link": "https://stackoverflow.com/users/793874/klappvisor"}, "is_accepted": true, "score": 8, "last_activity_date": 1465304481, "creation_date": 1465304481, "answer_id": 37680165, "question_id": 37679436, "link": "https://stackoverflow.com/questions/37679436/haskell-servant-is-there-a-way-to-compose-api-types/37680165#37680165", "title": "Haskell Servant - is there a way to compose API types?", "body": "<p>Yes, referencing <a href=\"http://haskell-servant.github.io/tutorial/0.4/server.html#nested-apis\" rel=\"noreferrer\">Servant documentation</a> you can use </p>\n\n<pre><code>type CombinedAPI = \"users\" :&gt; UsersAPI\n          :&lt;|&gt; \"products\" :&gt; ProductsAPI\n\nserver :: Server CombinedAPI\nserver = usersServer :&lt;|&gt; productsServer\n\nusersServer :: Server UsersAPI\nusersServer = -- implementation\n\nproductsServer :: Server ProductsAPI\nproductsServer = -- implementation\n</code></pre>\n"}], "owner": {"reputation": 6241, "user_id": 722869, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1c5c02f9165e188ab81a53efabc062e2?s=128&d=identicon&r=PG", "display_name": "daj", "link": "https://stackoverflow.com/users/722869/daj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 403, "favorite_count": 0, "accepted_answer_id": 37680165, "answer_count": 1, "score": 3, "last_activity_date": 1465304481, "creation_date": 1465302554, "question_id": 37679436, "link": "https://stackoverflow.com/questions/37679436/haskell-servant-is-there-a-way-to-compose-api-types", "title": "Haskell Servant - is there a way to compose API types?", "body": "<p>I know this isn't valid syntax, but is there a way to accomplish something like this in servant?</p>\n\n<pre><code>type StandardAPI = \"foo\" :&gt; Get '[JSON] Whatever\n\ntype CustomAPI = StandardAPI :&lt;|&gt; \"customroute\" :&gt; Get '[JSON] Blah\n</code></pre>\n\n<p>in other words, composing APIs. In Spock I could do this with the monadic route construction, but I'm not sure how to do this in servant.</p>\n\n<p>This way I can reuse shared routes across APIs. Another reason to use this is that there are certain types that don't work with client generators, such as Raw.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 791, "user_id": 1587319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c8a88b9a8d79a518cba52a7a8d099f9?s=128&d=identicon&r=PG", "display_name": "pdexter", "link": "https://stackoverflow.com/users/1587319/pdexter"}, "edited": false, "score": 0, "creation_date": 1465289044, "post_id": 37674438, "comment_id": 62826384, "body": "Can you create a <a href=\"http://stackoverflow.com/help/mcve\">minimal working example</a>? For example, what is Ide? What is Value?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1465290194, "post_id": 37674438, "comment_id": 62827107, "body": "How about <code>show [(ident, snd m ident) | ident &lt;- fst m]</code>"}, {"owner": {"reputation": 1, "user_id": 6434159, "user_type": "registered", "profile_image": "https://graph.facebook.com/1237287659637753/picture?type=large", "display_name": "Matthew Rae", "link": "https://stackoverflow.com/users/6434159/matthew-rae"}, "edited": false, "score": 0, "creation_date": 1465293043, "post_id": 37674438, "comment_id": 62829119, "body": "Value is <code>data Value = Numeric Integer | Boolean Bool | ERROR             deriving Show</code> and Ide is either a Stored Value or Unbound defined by the MemVal"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1465290207, "creation_date": 1465290207, "answer_id": 37674935, "question_id": 37674438, "link": "https://stackoverflow.com/questions/37674438/mapping-multiple-functions-in-haskell/37674935#37674935", "title": "mapping multiple functions in haskell", "body": "<p>You probably want something like this</p>\n\n<pre><code>display :: Memory -&gt; String\ndisplay (ides, mem) = \n   \"Memory = [\" ++ unwords (map (\\x -&gt; x ++ \"=\" ++ mem x) ides) ++ \"]\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 1, "last_activity_date": 1465290218, "creation_date": 1465290218, "answer_id": 37674940, "question_id": 37674438, "link": "https://stackoverflow.com/questions/37674438/mapping-multiple-functions-in-haskell/37674940#37674940", "title": "mapping multiple functions in haskell", "body": "<p>I'm guessing this is what you are after:</p>\n\n<pre><code>import Data.List (intercalate)\n\ndisplay (Memory ids f) = \"Memory = [\" ++ (intercalates \", \" assigns) ++ \"]\"\n  where assigns = [ show i ++ \" = \" ++ show (f i) | i &lt;- ids ]\n</code></pre>\n\n<p>Here <code>assigns</code> is a list like:</p>\n\n<pre><code>[ \"sum = stored Numeric 1\", \"x = stored Boolean true\", ...]\n</code></pre>\n\n<p>and <code>intercalate \", \" assigns</code> joins the strings together.</p>\n\n<p>I've used destructuring to avoid having to refer to <code>fst ...</code> and <code>snd ...</code></p>\n"}], "owner": {"reputation": 1, "user_id": 6434159, "user_type": "registered", "profile_image": "https://graph.facebook.com/1237287659637753/picture?type=large", "display_name": "Matthew Rae", "link": "https://stackoverflow.com/users/6434159/matthew-rae"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 446, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1465290218, "creation_date": 1465288719, "question_id": 37674438, "link": "https://stackoverflow.com/questions/37674438/mapping-multiple-functions-in-haskell", "title": "mapping multiple functions in haskell", "body": "<p>I'm working on a way of representing memory in Haskell that looks like this...</p>\n\n<pre><code>data MemVal = Stored Value | Unbound\n          deriving Show\n\ntype Memory = ([Ide],Ide -&gt; MemVal)\n</code></pre>\n\n<p>As an Identifier is called its added to the list of Identifiers. If an error occurs in the program I want to be able to recall the identifiers used up to date. So far I have this...</p>\n\n<pre><code>display :: Memory -&gt; String\ndisplay m = \"Memory = \" ++ show (map (snd m) (fst m)) ++ \" \"\n</code></pre>\n\n<p>But was wondering if there were a way to map the name of the identifier to (fst m) as well as the function (snd m) so the output will be similar to...</p>\n\n<pre><code>Memory = [sum = stored Numeric 1, x = stored Boolean true]\n</code></pre>\n\n<p>Thank you.</p>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1465258941, "post_id": 37668517, "comment_id": 62815476, "body": "Possible duplicate: <a href=\"http://stackoverflow.com/q/11234632/791604\">Monads with join instead of bind</a>. Can you say whether this question&#39;s answers meet your needs, and if not, update your question with details about why so that we can target our answers to the parts you don&#39;t understand?"}], "answers": [{"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": false, "score": 3, "last_activity_date": 1465262602, "creation_date": 1465262602, "answer_id": 37669114, "question_id": 37668517, "link": "https://stackoverflow.com/questions/37668517/what-is-the-intuitive-meaning-of-join/37669114#37669114", "title": "What is the intuitive meaning of &quot;join&quot;?", "body": "<p>An <code>action :: IO (IO a)</code> is a way of producing a way of producing an <code>a</code>. <code>join action</code>, then, is a way of producing an <code>a</code> by  running the outermost producer of <code>action</code>, taking the producer it produced and then running that as well, to finally get to that juicy <code>a</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1835, "user_id": 6292577, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/gqMCP.jpg?s=128&g=1", "display_name": "rityzmon", "link": "https://stackoverflow.com/users/6292577/rityzmon"}, "edited": false, "score": 0, "creation_date": 1465332655, "post_id": 37669501, "comment_id": 62855123, "body": "To me, this was the most understandable explanation. Thanks."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 2, "last_activity_date": 1465265895, "creation_date": 1465265895, "answer_id": 37669501, "question_id": 37668517, "link": "https://stackoverflow.com/questions/37668517/what-is-the-intuitive-meaning-of-join/37669501#37669501", "title": "What is the intuitive meaning of &quot;join&quot;?", "body": "<p>For the List monad, <code>join</code> is simply <code>concat</code>, and <code>concatMap</code> is <code>join . fmap</code>.\nSo <code>join</code> implicitly appears in any list expression which uses <code>concat</code>\nor <code>concatMap</code>.</p>\n\n<p>Suppose you were asked to find all of the numbers which are divisors of any\nnumber in an input list. If you have a <code>divisors</code> function:</p>\n\n<pre><code>divisors :: Int -&gt; [Int]\ndivisors n = [ d | d &lt;- [1..n], mod n d == 0 ]\n</code></pre>\n\n<p>you might solve the problem like this:</p>\n\n<pre><code>foo xs = concat $ (map divisors xs)\n</code></pre>\n\n<p>Here we are thinking of solving the problem by first mapping the\ndivisors function over all of the input elements and then concatenating\nall of the resulting lists. You might even think that this is a very\n\"functional\" way of solving the problem.</p>\n\n<p>Another approch would be to write a list comprehension:</p>\n\n<pre><code>bar xs = [ d | x &lt;- xs, d &lt;- divisors x ]\n</code></pre>\n\n<p>or using do-notation:</p>\n\n<pre><code>bar xs = do x &lt;- xs\n            d &lt;- divisors\n            return d\n</code></pre>\n\n<p>Here it might be said we're thinking a little more\nimperatively - first draw a number from the list <code>xs</code>;  then draw\n a divisors from the divisors of the number and yield it.</p>\n\n<p>It turns out, though, that <code>foo</code> and <code>bar</code> are exactly the same function.</p>\n\n<p>Morever, these two approaches are exactly the same in <em>any</em> monad.\nThat is, for any monad, and appropriate monadic functions f and g:</p>\n\n<pre><code>do x &lt;- f      \n   y &lt;- g x           is the same as:    (join . fmap g) f\n   return y\n</code></pre>\n\n<p>For instance, in the IO monad if we set <code>f = getLine</code> and <code>g = readFile</code>,\nwe have:</p>\n\n<pre><code>do x &lt;- getLine\n   y &lt;- readFile x    is the same as:   (join . fmap readFile) getLine\n   return y\n</code></pre>\n\n<p>The do-block is a more imperative way of expressing the action: first read a\nline of input; then treat returned string as a file name, read the contents\nof the file and finally return the result.</p>\n\n<p>The equivalent join expression seems a little unnatural in the IO-monad.\nHowever it shouldn't be as we are using it in exactly the same way as we\nused <code>concatMap</code> in the first example.</p>\n"}, {"tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 3, "last_activity_date": 1465367598, "last_edit_date": 1465367598, "creation_date": 1465283063, "answer_id": 37672593, "question_id": 37668517, "link": "https://stackoverflow.com/questions/37668517/what-is-the-intuitive-meaning-of-join/37672593#37672593", "title": "What is the intuitive meaning of &quot;join&quot;?", "body": "<p><code>join</code> collapses consecutive layers of the type constructor.</p>\n\n<p>A valid <code>join</code> must satisfy the property that, for any number of consecutive applications of the type constructor, it shouldn't matter the order in which we collapse the layers.</p>\n\n<p>For example</p>\n\n<pre><code>ghci&gt; let lolol = [[['a'],['b','c']],[['d'],['e']]]\nghci&gt; lolol :: [[[Char]]]\nghci&gt; lolol :: [] ([] ([] Char)) -- the type can also be expressed like this\n\nghci&gt; join (fmap join lolol) -- collapse inner layers first\n\"abcde\"\nghci&gt; join (join lolol) -- collapse outer layers first\n\"abcde\"\n</code></pre>\n\n<p>(We used <code>fmap</code> to \"get inside\" the outer monadic layer so that we could collapse the inner layers first.)</p>\n\n<p>A small non container example where <code>join</code> is useful: for the function monad <code>(-&gt;) a</code>, <code>join</code> is equivalent to <code>\\f x -&gt; f x x</code>, a function of type <code>(a -&gt; a -&gt; b) -&gt; a -&gt; b</code> that applies two times the same argument to another function.</p>\n"}, {"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 1, "last_activity_date": 1465294106, "creation_date": 1465294106, "answer_id": 37676376, "question_id": 37668517, "link": "https://stackoverflow.com/questions/37668517/what-is-the-intuitive-meaning-of-join/37676376#37676376", "title": "What is the intuitive meaning of &quot;join&quot;?", "body": "<p>Given an action that produces <em>another</em> action, run the action and then run the action that it produces.</p>\n\n<p>If you imagine some kind of <code>Parser x</code> monad that parses an <code>x</code>, then <code>Parser (Parser x)</code> is a parser that does some parsing, and then returns another parser. So <code>join</code> would flatten this into a <code>Parser x</code> that just runs both actions and returns the final <code>x</code>.</p>\n\n<p>Why would you even have a <code>Parser (Parser x)</code> in the first place? Basically, because <code>fmap</code>. If you have a parser, you can <code>fmap</code> a function that changes the result over it. But if you <code>fmap</code> a function that itself returns a parser, you end up with a <code>Parser (Parser x)</code>, where you probably want to just run both actions. <code>join</code> implements \"just run both actions\".</p>\n\n<p>I like the parsing example because a parser typically has a <code>runParser</code> function. And it's clear that a <code>Parser Int</code> <em>is not</em> an integer. It's something that can <em>parse</em> an integer, <em>after</em> you give it some input to parse from. I think a lot of people end up thinking of an <code>IO Int</code> as being just a normal integer but with this annoying <code>IO</code> bit that you can't get rid of. <em>It isn't.</em> It's an unexecuted I/O operation. There's no integer \"inside\" it; the integer doesn't exist until you actually <em>perform</em> the I/O.</p>\n"}, {"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 1, "last_activity_date": 1465339530, "creation_date": 1465339530, "answer_id": 37690609, "question_id": 37668517, "link": "https://stackoverflow.com/questions/37668517/what-is-the-intuitive-meaning-of-join/37690609#37690609", "title": "What is the intuitive meaning of &quot;join&quot;?", "body": "<p>I find these things easier to interpret by writing out the types and refactoring them a bit to reveal what the functions do.</p>\n\n<h2>Reader monad</h2>\n\n<p>The <code>Reader</code> type is defined thus, and its <code>join</code> function has the type shown:</p>\n\n<pre><code>newtype Reader r a = Reader { runReader :: r -&gt; a }\n\njoin :: Reader r (Reader r a) -&gt; Reader r a\n</code></pre>\n\n<p>Since this is a <code>newtype</code>, this means that the type <code>Reader r a</code> is <strong>isomorphic</strong> to <code>r -&gt; a</code>.  So we can refactor the type definition to give us this type that, albeit it's not the same, it's really \"the same\" with scare quotes:</p>\n\n<p>In the <code>(-&gt;) r</code> monad, which is isomorphic to <code>Reader r</code>, <code>join</code> is the function:</p>\n\n<pre><code>join :: (r -&gt; r -&gt; a) -&gt; r -&gt; a\n</code></pre>\n\n<p>So the <code>Reader</code> join is the function that takes a two-place function (<code>r -&gt; r -&gt; a</code>) and applies to the same value at both its argument positions.</p>\n\n<h2>Writer monad</h2>\n\n<p>Since the <code>Writer</code> type has this definition:</p>\n\n<pre><code>newtype Writer w a = Writer { runWriter :: (a, w) }\n</code></pre>\n\n<p>...then when we remove the <code>newtype</code>, its <code>join</code> function has a type isomorphic to:</p>\n\n<pre><code>join :: Monoid w =&gt; ((a, w), w) -&gt; (a, w)\n</code></pre>\n\n<p>The <code>Monoid</code> constraint needs to be there because the <code>Monad</code> instance for <code>Writer</code> requires it, and it lets us guess right away what the function does:</p>\n\n<pre><code>join ((a, w0), w1) = (a, w0 &lt;&gt; w1)\n</code></pre>\n\n<h2>State monad</h2>\n\n<p>Similarly, since <code>State</code> has this definition:</p>\n\n<pre><code>newtype State s a = State { runState :: s -&gt; (a, s) }\n</code></pre>\n\n<p>...then its <code>join</code> is like this:</p>\n\n<pre><code>join :: (s -&gt; (s -&gt; (a, s), s)) -&gt; s -&gt; (a, s)\n</code></pre>\n\n<p>...and you can also venture just writing it directly:</p>\n\n<pre><code>join f s0 = (a, s2)\n  where \n    (g, s1) = f s0\n    (a, s2) = g s1\n\n\n{- Here's the \"map\" to the variable names in the function:\n\n               f     g      s2   s1      s0        s2\n    join :: (s -&gt; (s -&gt; (a, s ), s )) -&gt; s  -&gt; (a, s )\n-}\n</code></pre>\n\n<p>If you stare at this type a bit, you might think that it bears some resemblance to <em>both</em> the <code>Reader</code> and <code>Writer</code>'s types for their <code>join</code> operations.  And you'd be right!  The <code>Reader</code>, <code>Writer</code> and <code>State</code> monads are all instances of a more general pattern called <a href=\"https://www.schoolofhaskell.com/user/edwardk/heap-of-successes\" rel=\"nofollow\">update monads</a>.</p>\n\n<h2>List monad</h2>\n\n<pre><code>join :: [[a]] -&gt; [a]\n</code></pre>\n\n<p>As other people have pointed out, this is the type of the <code>concat</code> function.</p>\n\n<h2>Parsing monads</h2>\n\n<p>Here comes a really neat thing to realize.  Very often, \"fancy\" monads turn out to be combinations or variants of \"basic\" ones like <code>Reader</code>, <code>Writer</code>, <code>State</code> or lists.  So often what I do when confronted with a novel monad is ask: which of the basic monads does it resemble, and how?</p>\n\n<p>Take for example parsing monads, which have been brought up in other answers here.  A simplistic parser monad (with no support for important things like error reporting) looks like this:</p>\n\n<pre><code>newtype Parser a = Parser { runParser :: String -&gt; [(a, String)] }\n</code></pre>\n\n<p>A <code>Parser</code> is a function that takes a string as input, and returns a list of <em>candidate parses</em>, where each candidate parse is a pair of:</p>\n\n<ol>\n<li>A parse result of type <code>a</code>;</li>\n<li>The <em>leftovers</em> (the suffix of the input string that was not consumed in that parse).</li>\n</ol>\n\n<p>But notice that this type looks very much like the state monad:</p>\n\n<pre><code>newtype Parser  a = Parser { runParser :: String -&gt; [(a, String)] }\nnewtype State s a = State  { runState  :: s      -&gt;  (a, s)       }\n</code></pre>\n\n<p>And this is no accident!  Parser monads are <em>nondeterministic state monads</em>, where the state is the unconsumed portion of the input string, and parse steps generate <em>alternatives</em> that may be later rejected in light of further input.  List monads are often called \"nondeterminism\" monads, so it's no surprise that a parser resembles a mix of the state and list monads.  </p>\n\n<p>And this intuition can be systematized by using <strong>monad transfomers</strong>.  The state monad transformer is defined like this:</p>\n\n<pre><code>newtype StateT s m a = StateT { runStateT :: s -&gt; m (a, s) }\n</code></pre>\n\n<p>Which means that the <code>Parser</code> type from above can be written like this as well:</p>\n\n<pre><code>type Parser a = StateT String [] a\n</code></pre>\n\n<p>...and its <code>Monad</code> instance follows <em>mechanically</em> from those of <code>StateT</code> and <code>[]</code>.</p>\n\n<h2>The <code>IO</code> monad</h2>\n\n<p>Imagine we could enumerate all of the possible <em>primitive</em> <code>IO</code> actions, somewhat like this:</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n\ndata Command a where\n  -- An action that writes a char to stdout\n  putChar :: Char -&gt; Command ()\n\n  -- An action that reads a char from stdin\n  getChar :: Command Char\n\n  -- ...\n</code></pre>\n\n<p>Then we could think of the <code>IO</code> type as this (which I've adapted from the highly-recommended <a href=\"http://apfelmus.nfshost.com/articles/operational-monad.html\" rel=\"nofollow\">Operational monad tutorial</a>):</p>\n\n<pre><code>data IO a where\n  -- An `IO` action that just returns a constant value.\n  Return :: a -&gt; IO a\n\n  -- An action that binds the result of a `Command` to \n  -- a function that computes the next step after it.\n  Bind :: Command x -&gt; (x -&gt; IO a) -&gt; IO a\n\ninstance Monad IO where ...\n</code></pre>\n\n<p>Then <code>join</code> action would then look like this:</p>\n\n<pre><code>join :: IO (IO a) -&gt; IO a\n\n-- If the action is just `Return`, then its payload already\n-- is what we need to return.\njoin (Return ioa) = ioa\n\n-- If the action is a `Bind`, then its \"next step\" function\n-- `f` produces `IO (IO a)`, so we can just recursively stick \n-- a `join` to its result end.\njoin (Bind cmd f) = Bind cmd (join . f)\n</code></pre>\n\n<p>So all that the <code>join</code> does here is \"chase down\" the <code>IO</code> action until it sees a result that fits the pattern <code>Return (ma :: IO a)</code>, and strip out the outer <code>Return</code>.</p>\n\n<p>So what did I do here?  Just like for parser monads, I just defined (or rather copied) a  toy model of the <code>IO</code> type that has the virtue of being <em>transparent</em>.  Then I work out the behavior of <code>join</code> from the toy model.</p>\n"}], "owner": {"reputation": 1835, "user_id": 6292577, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/gqMCP.jpg?s=128&g=1", "display_name": "rityzmon", "link": "https://stackoverflow.com/users/6292577/rityzmon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "accepted_answer_id": 37669501, "answer_count": 5, "score": 1, "last_activity_date": 1465367598, "creation_date": 1465257213, "question_id": 37668517, "link": "https://stackoverflow.com/questions/37668517/what-is-the-intuitive-meaning-of-join", "title": "What is the intuitive meaning of &quot;join&quot;?", "body": "<p>What is the intuitive meaning of <code>join</code> for a Monad? </p>\n\n<p>The <em>monads-as-containers</em> analogies make sense to me, and inside these analogies <code>join</code> makes sense. A value is double-wrapped and we unwrap one layer. But as we all know, a monad is not a container. </p>\n\n<p>How might one write sensible, understandable code using <code>join</code> in normal circumstances, say when in <code>IO</code>?</p>\n"}, {"tags": ["session", "haskell", "authentication", "yesod"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1465259920, "post_id": 37668314, "comment_id": 62815673, "body": "Why do you want to do that ? If I remember correctly, Yesod already does those bookkeeping. It stores <code>AuthID</code> in your session which is usually the persistent key."}, {"owner": {"reputation": 1, "user_id": 4358379, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AN6S4CwIpSk/AAAAAAAAAAI/AAAAAAAAAEU/Ek28VcRjURI/photo.jpg?sz=128", "display_name": "Bruno Menezes", "link": "https://stackoverflow.com/users/4358379/bruno-menezes"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1465304341, "post_id": 37668314, "comment_id": 62837055, "body": "Can I use AuthID as Key for another tables that use UserID as foreign key? If it&#39;s possible, I believe that solves my problem."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1465308937, "post_id": 37668314, "comment_id": 62840664, "body": "Yes. But that&#39;s on the database schema level itself. So you can pretty much do whatever you want. Probably, we can help you better if you can say what you are trying to solve."}, {"owner": {"reputation": 1, "user_id": 4358379, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AN6S4CwIpSk/AAAAAAAAAAI/AAAAAAAAAEU/Ek28VcRjURI/photo.jpg?sz=128", "display_name": "Bruno Menezes", "link": "https://stackoverflow.com/users/4358379/bruno-menezes"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1465309868, "post_id": 37668314, "comment_id": 62841350, "body": "I want to get information related to User from database. So, I have to retrieve the logged-in UserId to find data in another tables. It doesn&#39;t need to be necessarily Session value."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1465312640, "post_id": 37668314, "comment_id": 62843526, "body": "You are looking for something like this: <a href=\"https://s3.amazonaws.com/haddock.stackage.org/lts-6.2/yesod-auth-1.4.13.2/Yesod-Auth.html#v:maybeAuth\" rel=\"nofollow noreferrer\">s3.amazonaws.com/haddock.stackage.org/lts-6.2/&hellip;</a> . I recommend you to go through this chapter: <a href=\"http://www.yesodweb.com/book/authentication-and-authorization\" rel=\"nofollow noreferrer\">yesodweb.com/book/authentication-and-authorization</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 4358379, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AN6S4CwIpSk/AAAAAAAAAAI/AAAAAAAAAEU/Ek28VcRjURI/photo.jpg?sz=128", "display_name": "Bruno Menezes", "link": "https://stackoverflow.com/users/4358379/bruno-menezes"}, "edited": false, "score": 0, "creation_date": 1465308859, "post_id": 37669969, "comment_id": 62840604, "body": "I got the following error: <code>&#47;home&#47;ubuntu&#47;workspace&#47;tpayesod&#47;src&#47;Handlers.hs:235:30:     Couldn&#39;t match expected type \u2018Key t0\u2019 with actual type \u2018Maybe Text\u2019     In the first argument of \u2018get404\u2019, namely \u2018uid\u2019     In the second argument of \u2018($)\u2019, namely \u2018get404 uid\u2019</code>"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 1, "user_id": 4358379, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AN6S4CwIpSk/AAAAAAAAAAI/AAAAAAAAAEU/Ek28VcRjURI/photo.jpg?sz=128", "display_name": "Bruno Menezes", "link": "https://stackoverflow.com/users/4358379/bruno-menezes"}, "edited": false, "score": 0, "creation_date": 1465312974, "post_id": 37669969, "comment_id": 62843759, "body": "Well - it won&#39;t work. You&#39;ve got to convert <code>uid</code> to a Text. Currently <code>uid</code> is a <code>Key ...</code>. It will work if you can convert it to a Text value somehow."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 0, "last_activity_date": 1465312867, "last_edit_date": 1465312867, "creation_date": 1465269824, "answer_id": 37669969, "question_id": 37668314, "link": "https://stackoverflow.com/questions/37668314/get-user-from-database-using-session-value-haskell-yesod/37669969#37669969", "title": "Get user from database using session value (Haskell - Yesod)", "body": "<p>The type of <code>lookupSession</code> is:</p>\n\n<pre><code>lookupSession :: MonadHandler m =&gt; Text -&gt; m (Maybe Text)\n</code></pre>\n\n<p>So I would try something like this:</p>\n\n<pre><code>    getProfileR :: Handler Html\n    getProfileR = do\n      uid &lt;- lookupSession \"_ID\"\n      user &lt;- runDB $ get404 (Just uid)\n      defaultLayout $ do\n        $(whamletFile \"templates/profile.hamlet\")  \n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4358379, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-AN6S4CwIpSk/AAAAAAAAAAI/AAAAAAAAAEU/Ek28VcRjURI/photo.jpg?sz=128", "display_name": "Bruno Menezes", "link": "https://stackoverflow.com/users/4358379/bruno-menezes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 209, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1559065626, "creation_date": 1465255639, "last_edit_date": 1559065626, "question_id": 37668314, "link": "https://stackoverflow.com/questions/37668314/get-user-from-database-using-session-value-haskell-yesod", "title": "Get user from database using session value (Haskell - Yesod)", "body": "<p>I want to get User information from database using session value instead Key.</p>\n\n<p>Use this:</p>\n\n<pre><code>    getProfileR :: Handler Html\n    getProfileR = do\n    user &lt;- runDB $ get404 $ lookupSession \"_ID\"\n    defaultLayout $ do\n        $(whamletFile \"templates/profile.hamlet\")\n</code></pre>\n\n<p>Instead this:</p>\n\n<pre><code>    getProfileR :: UserId -&gt; Handler Html\n    getProfileR uid = do\n    user &lt;- runDB $ get404 uid\n    defaultLayout $ do\n        $(whamletFile \"templates/profile.hamlet\")\n</code></pre>\n\n<p>Is it possible? Is it not recommended?</p>\n"}, {"tags": ["haskell", "yesod", "yesod-forms"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1465272318, "post_id": 37666989, "comment_id": 62818447, "body": "what is the problem with this code (aside from the layout)? Is it compiling? If not what are the compiler errors? Because on a first glance you should have a button and a link both deleting your animal"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1465272472, "post_id": 37666989, "comment_id": 62818481, "body": "or is the question how you can <i>edit</i> one animal? Well in this case the easiest solution is probably to add a link/button that will navigate the user to another route/form - you probably have this somewhere for new animals (wherever you use <code>formAnimal</code>) - the only additional work you have is to first load the animal and then replace the <code>Nothing</code> parts in your <code>formAnimal</code> with the data from this animal (just change the function to <code>formAnmial :: Maybe Animal -&gt; Form Animal</code>)"}, {"owner": {"reputation": 25, "user_id": 5558619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0daf238ed465f8fec6db6cb0397c603e?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas F", "link": "https://stackoverflow.com/users/5558619/jonas-f"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1465273212, "post_id": 37666989, "comment_id": 62818697, "body": "Thanks Carsten! Doing this, chance the form to Maybe Animals it could still be used to register animals? Thinking when the user acess the form t&#244; insert a Animal, i wont need the Nothing to the fields come empty? And how can i send the Animal atributes to the Form? I understood what you said, but can you show me in code? Thanks alooot"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1465276811, "post_id": 37666989, "comment_id": 62819772, "body": "if you have <code>input :: Maybe Animal</code> and assuming one of the field is named <code>nome</code> you should be able to replace <code>areq textField &quot;Nome: &quot; Nothing &lt;*&gt;</code> with <code>areq textField &quot;Nome: &quot; (fmap nome input) &lt;*&gt; ...</code> - then you can use the existing with <code>formAnmial Nothing</code> and can provide values with <code>formAnmial (Just data)</code>"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1465276928, "post_id": 37666989, "comment_id": 62819813, "body": "it&#39;s explained here too: <a href=\"http://www.yesodweb.com/book/forms\" rel=\"nofollow noreferrer\">yesodweb.com/book/forms</a> (look for <code>carAForm</code>) - only difference is that it&#39; using <code>&lt;$&gt;</code> instead of <code>fmap</code> (it&#39;s the same - so pick what suits you)"}], "owner": {"reputation": 25, "user_id": 5558619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0daf238ed465f8fec6db6cb0397c603e?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas F", "link": "https://stackoverflow.com/users/5558619/jonas-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 80, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1465247662, "creation_date": 1465247662, "question_id": 37666989, "link": "https://stackoverflow.com/questions/37666989/how-add-update-at-my-haskel-yesod-project", "title": "How Add Update at my Haskel Yesod Project", "body": "<p>guys, i need suggestions to add Update at my Haskell Project.\nI'm using Yesod.</p>\n\n<p>That's the part of my code that i List all the animals and for each one, a button to delete the animal.\nHow can i make a Update, like this way ?</p>\n\n<p>Thanks.</p>\n\n<pre><code>getListarAnimalR :: Handler Html\ngetListarAnimalR = do\n             listaAnm &lt;- runDB $ selectList [] [Asc AnimalsNome]\n             defaultLayout $ [whamlet|\n                 &lt;h1&gt; Animais cadastrados:\n                 $forall Entity pid animals &lt;- listaAnm\n                     &lt;a href=@{ChecarAnimalR pid}&gt; #{animalsNome animals} \n                     &lt;form method=post action=@{ChecarAnimalR pid}&gt; \n                         &lt;input type=\"submit\" value=\"Deletar Animal\"&gt;&lt;br&gt;\n             |] &gt;&gt; toWidget [lucius|\n                form  { display:inline; }\n                input { background-color: #ecc; border:0;}\n             |]\n\n\n    postChecarAnimalR :: AnimalsId -&gt; Handler Html\n    postChecarAnimalR pid = do\n         runDB $ delete pid\n         redirect ListarAnimalR\n\nformAnimal :: Form Animals\nformAnimal = renderDivs $ Animals &lt;$&gt;\n           areq textField \"Nome: \" Nothing &lt;*&gt;\n           areq intField \"Idade: \" Nothing &lt;*&gt;\n           areq (selectField racas) \"Raca\" Nothing\n</code></pre>\n"}, {"tags": ["haskell", "functor", "applicative", "haskell-lens", "lenses"], "answers": [{"comments": [{"owner": {"reputation": 634, "user_id": 5093690, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a3c8f6b503d9ea35c843eda8d891479f?s=128&d=identicon&r=PG&f=1", "display_name": "qwe", "link": "https://stackoverflow.com/users/5093690/qwe"}, "edited": false, "score": 0, "creation_date": 1465250365, "post_id": 37667128, "comment_id": 62813345, "body": "Can you please explain in greater details why wrapping a type inside a functor would prevent that? I can always do the exact same thing, even if a type is wrapped: <code>zlens f p = fmap (const p) $ f 0 -- zlens :: Lens&#39; Point Int</code>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 634, "user_id": 5093690, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a3c8f6b503d9ea35c843eda8d891479f?s=128&d=identicon&r=PG&f=1", "display_name": "qwe", "link": "https://stackoverflow.com/users/5093690/qwe"}, "edited": false, "score": 0, "creation_date": 1465250568, "post_id": 37667128, "comment_id": 62813411, "body": "@qwe hence my footnote. But at least, with the wrapper you must apply the provided function to some value of the right type."}, {"owner": {"reputation": 634, "user_id": 5093690, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a3c8f6b503d9ea35c843eda8d891479f?s=128&d=identicon&r=PG&f=1", "display_name": "qwe", "link": "https://stackoverflow.com/users/5093690/qwe"}, "edited": false, "score": 0, "creation_date": 1465250652, "post_id": 37667128, "comment_id": 62813435, "body": "Then I guess I&#39;m still not convinced it&#39;s necessary. Could it be something concerning monads and side effect computations?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1465308473, "post_id": 37667128, "comment_id": 62840310, "body": "I don&#39;t think you can cheat your way around it if you make a <i>type-changing</i> <code>Setter</code>. But of course those aren&#39;t always available."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 6, "last_activity_date": 1465248723, "last_edit_date": 1465248723, "creation_date": 1465248370, "answer_id": 37667128, "question_id": 37666781, "link": "https://stackoverflow.com/questions/37666781/isnt-it-redundant-for-control-lens-setter-to-wrap-types-in-functors/37667128#37667128", "title": "Isn&#39;t it redundant for Control.Lens.Setter to wrap types in functors?", "body": "<p>In a sense, the reason <code>lens</code> wraps setters in functor-returns is that they would be <em>too powerful</em> otherwise.</p>\n\n<p>In fact, when a setter is <em>used</em>, the functor will be instantiated to <code>Identity</code> anyway, which is exactly like your proposed signature. However, <em>the implementation of a setter must not exploit this fact</em>. With your signature, I could write something like</p>\n\n<pre><code>zlens :: MySetter Point Point Int Int\nzlens _f p = p  -- no z here!\n</code></pre>\n\n<p>Well, this is just not possible with the <code>Functor</code> based signature, because <code>zlens</code> would need to be universally quantified over the functor it could not know how to inject a result into the <code>f</code> wrapper. The only way to get a result of the functor type is to first apply the setter-function to a field of the right type!</p>\n\n<p>So, this is just a nice free theorem<sup>&dagger;</sup>.</p>\n\n<p>More practically, we need the functor wrapper for <em>compatibility</em>. While you can define <em>setters</em> without this wrapper, this is not possible for getters, as these use <code>Const</code> rather than <code>Identity</code>, and need the added polymorphism in the first argument of this type constructor. By requiring such a wrapper for <em>all</em> lens flavours (only with different class constraints), we can use the same combinators for all of them, yet the type system will always collapse the functionality down to whichever features are actually applicable to the situation.</p>\n\n<hr>\n\n<p><sup>&dagger;</sup><sub>Thinking about it, the guarantee is actually not very strong... I can still subvert it with some <code>fmap (const old)</code> cheatery, but it's certainly not something that could realistically happen by mistake.</sub></p>\n"}, {"tags": [], "owner": {"reputation": 9772, "user_id": 3963, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9pDQ8.png?s=128&g=1", "display_name": "hao", "link": "https://stackoverflow.com/users/3963/hao"}, "is_accepted": true, "score": 20, "last_activity_date": 1465251038, "last_edit_date": 1465251038, "creation_date": 1465250638, "answer_id": 37667560, "question_id": 37666781, "link": "https://stackoverflow.com/questions/37666781/isnt-it-redundant-for-control-lens-setter-to-wrap-types-in-functors/37667560#37667560", "title": "Isn&#39;t it redundant for Control.Lens.Setter to wrap types in functors?", "body": "<p>This is a wonderful question and will require a little bit of unpacking.</p>\n\n<p>I want to gently correct you on one point right off the bat: the type of Setter in the <code>lens</code> package as of recent versions is</p>\n\n<pre><code>type Setter s t a b = (a -&gt; Identity b) -&gt; s -&gt; Identity t\n</code></pre>\n\n<p>No <code>Functor</code> in sight ... yet.</p>\n\n<p>That does not invalidate your question however. Why isn't the type simply</p>\n\n<pre><code>type Setter s t a b = (a -&gt; b) -&gt; s -&gt; t\n</code></pre>\n\n<p>For that we first have to talk about <code>Lens</code>.</p>\n\n<h2>Lens</h2>\n\n<p>A <code>Lens</code> is a type that allows us to perform both a getter and a setter operation. These two combined form one beautiful functional reference.</p>\n\n<p>A simple pick for <code>Lens</code> type is:</p>\n\n<pre><code>type Getter s a = s -&gt; a\ntype Setter s t a b = (a -&gt; b) -&gt; s -&gt; t\ntype Lens s t a b = (Getter s a, Setter s t a b)\n</code></pre>\n\n<p>This type however is deeply unsatisfying.</p>\n\n<ul>\n<li>It fails to compose with <code>.</code>, which is perhaps the single best selling point of the <code>lens</code> package.</li>\n<li>It is rather memory inefficient to build lots of tuples, only to rip them apart later.</li>\n<li>The big one: functions that take getters (like <code>view</code>) and setters (like <code>over</code>) cannot take lenses because their types are so different.</li>\n</ul>\n\n<p>Without that last problem solved why even bother writing a library? We would hate for users to have to constantly think about where they are in the UML hierarchy of optics, adjusting their function calls each time they move up or down.</p>\n\n<p>The question of the moment is then: is there a type we can write down for <code>Lens</code> such that it is <em>automatically</em> both a <code>Getter</code> and a <code>Setter</code>? And for that we have to transform the types of <code>Getter</code> and <code>Setter</code>.</p>\n\n<h2>Getter</h2>\n\n<ul>\n<li><p>First note that <code>s -&gt; a</code> is equivalent to <code>forall r. (a -&gt; r) -&gt; s -&gt; r</code>. This transformation into continuation passing style is far from obvious. You might be able to intuit this transformation as this: \"A function of type <code>s -&gt; a</code> is a promise that given any <code>s</code> you can hand me an <code>a</code>. But that should be equivalent to the promise that given a function that maps <code>a</code> to <code>r</code> you can hand me a function that maps <code>s</code> to <code>r</code> also.\" Maybe? Maybe not. There might be a leap of faith involved here.</p></li>\n<li><p>Now define <code>newtype Const r a = Const r deriving Functor</code>. Note that <code>Const r a</code> is the same as <code>r</code>, mathematically and at runtime.</p></li>\n<li><p>Now note that <code>type Getter s a = forall r. (a -&gt; r) -&gt; s -&gt; r</code> can be rewritten as <code>type Getter s t a b = forall r. (a -&gt; Const r b) -&gt; s -&gt; Const r t</code>. Though we introduced new type variables and mental anguish for ourselves this type is still mathematically identical to what we started out with (<code>s -&gt; a</code>).</p></li>\n</ul>\n\n<h2>Setter</h2>\n\n<ul>\n<li><p>Define <code>newtype Identity a = Identity a</code>. Note that <code>Identity a</code> is the same as <code>a</code>, mathematically and at runtime.</p></li>\n<li><p>Now note that <code>type Setter s t a b = (a -&gt; Identity b) -&gt; s -&gt; Identity t</code> is still identical to the type that we started out with.</p></li>\n</ul>\n\n<h2>All together</h2>\n\n<p>With this paperwork out of the way, can we unify setters and getters into one single <code>Lens</code> type?</p>\n\n<pre><code>type Setter s t a b = (a -&gt; Identity b) -&gt; s -&gt; Identity t\ntype Getter s t a b = forall r. (a -&gt; Const r b) -&gt; s -&gt; Const r t\n</code></pre>\n\n<p>Well this is Haskell and we can abstract out the choice of <code>Identity</code> or <code>Const</code> to a quantified variable. As <a href=\"https://github.com/ekmett/lens/wiki/Derivation\">the lens wiki says</a>, all that <code>Const</code> and <code>Identity</code> have in common is that each is a <code>Functor</code>. We then choose that as a sort of point of unification for these types:</p>\n\n<pre><code>type Lens s t a b = forall f. Functor f =&gt; (a -&gt; f b) -&gt; s -&gt; f t\n</code></pre>\n\n<p>(There are other reasons to choose <code>Functor</code> too, such as to prove the laws of functional references by using free theorems. But we will handwave a little bit here for time.) That <code>forall f</code> is like the <code>forall r</code>. above \u2013 it lets consumers of the type choose how to fill the variable in. Fill in an <code>Identity</code> and you get a setter. Fill in a <code>Const a</code> and you get a getter. It was by choosing small and careful transformations along the way that we were able to arrive at this point.</p>\n\n<h2>Caveats</h2>\n\n<p>It might be important to note that this derivation is <em>not</em> the original motivation for the <code>lens</code> package. As the <a href=\"https://github.com/ekmett/lens/wiki/Derivation\">Derivation wiki page states</a> explains, you can start from the interesting behavior of <code>(.)</code> with certain functions and tease out optics from there. But I think this path we carved out is a little better at explaining the question you posed, which was a big question I had starting out too. I also want to refer you to <a href=\"https://artyom.me/lens-over-tea-1\">lens over tea</a>, which provides yet <em>another</em> derivation.</p>\n\n<p>I think these multiple derivations are a good thing and a kind of dipstick for the healthiness of the <code>lens</code> design. That we are able to arrive at the same elegant solution from different angles means that this abstraction is robust and well-supported by different intuitions and mathematics.</p>\n\n<p>I also lied a little bit about the type of Setter in recent <code>lens</code>. It's actually</p>\n\n<pre><code>type Setter s t a b = forall f. Settable f =&gt; (a -&gt; f b) -&gt; s -&gt; t b\n</code></pre>\n\n<p>This is another example of abstracting the higher-order type in optical types to provide the library user a better experience. Almost always <code>f</code> will be instantiated to <code>Identity</code>, as there is an <code>instance Settable Identity</code>. However every now and then you might want to pass setters to the <code>backwards</code> function, which fixes <code>f</code> to be <code>Backwards Identity</code>. We can probably categorize this paragraph as \"more information about <code>lens</code> than you probably wanted to know.\"</p>\n"}], "owner": {"reputation": 634, "user_id": 5093690, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a3c8f6b503d9ea35c843eda8d891479f?s=128&d=identicon&r=PG&f=1", "display_name": "qwe", "link": "https://stackoverflow.com/users/5093690/qwe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 434, "favorite_count": 3, "accepted_answer_id": 37667560, "answer_count": 2, "score": 21, "last_activity_date": 1467507027, "creation_date": 1465246672, "last_edit_date": 1467507027, "question_id": 37666781, "link": "https://stackoverflow.com/questions/37666781/isnt-it-redundant-for-control-lens-setter-to-wrap-types-in-functors", "title": "Isn&#39;t it redundant for Control.Lens.Setter to wrap types in functors?", "body": "<p>I'm watching the <code>Control.Lens</code> introduction <a href=\"https://www.youtube.com/watch?v=cefnmjtAolY\" rel=\"noreferrer\">video</a>.<br>\nIt makes me wonder why is it needed for the <code>Setter</code> type to wrap things in functors.<br>\nIt's (roughly) defined like this:</p>\n\n<pre><code>type Control.Lens.Setter s t a b = (Functor f) =&gt; (a -&gt; f a) -&gt; s -&gt; f t\n</code></pre>\n\n<p>Let's say I have a data called <code>Point</code> that's defined like this:</p>\n\n<pre><code>data Point = Point { _x :: Int, _y :: Int } deriving Show\n</code></pre>\n\n<p>Then I can write my own <code>xlens</code> like this:</p>\n\n<pre><code>type MySetter s t a b = (a -&gt; b) -&gt; s -&gt; t\nxlens :: MySetter Point Point Int Int\nxlens f p = p { _x = f (_x p) }\n</code></pre>\n\n<p>And I can use it like this:</p>\n\n<pre><code>p = Point 100 200\nxlens (+1) p -- Results in Point { _x = 101, _y = 200 }\n</code></pre>\n\n<p>By using <code>Control.Lens</code>, the same effect is achieved by:</p>\n\n<pre><code>over x (+1) p\n</code></pre>\n\n<p>where the following stands:</p>\n\n<pre><code>x :: Functor f =&gt; (Int -&gt; f Int) -&gt; Point -&gt; f Point\nover :: Setter Point Point Int Int -&gt; (Int -&gt; Int) -&gt; Point -&gt; Point\n</code></pre>\n\n<p>So my question is, since the same effect can be achieved in a simpler manner, why <code>Control.Lens</code> wraps things in functors? It looks redundant to me, since my <code>xlens</code> does the same as <code>Control.Lens</code>'s <code>over x</code>.</p>\n\n<p>Just for the record, I can also chain my lenses in the same manner:  </p>\n\n<pre><code>data Atom = Atom { _element :: String, _pos :: Point } deriving Show\nposlens :: MySetter Atom Atom Point Point\nposlens f a = a { _pos = f (_pos a) }\n\na = Atom \"Oxygen\" p\n(poslens . xlens) :: (Int -&gt; Int) -&gt; Atom -&gt; Atom\n(poslens . xlens) (+1) a -- Results in Atom \"Oxygen\" (Point 101 200)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 7136, "user_id": 1467115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81bee3c36aa1c59317d525baabecec11?s=128&d=identicon&r=PG", "display_name": "Jan Gerlinger", "link": "https://stackoverflow.com/users/1467115/jan-gerlinger"}, "edited": false, "score": 2, "creation_date": 1465237421, "post_id": 37664128, "comment_id": 62807032, "body": "What does your function <code>lista</code> do?"}, {"owner": {"reputation": 11780, "user_id": 2827654, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a171742e9c31a541d4d2031af932e94a?s=128&d=identicon&r=PG&f=1", "display_name": "jamshidh", "link": "https://stackoverflow.com/users/2827654/jamshidh"}, "edited": false, "score": 2, "creation_date": 1465237499, "post_id": 37664128, "comment_id": 62807079, "body": "What is <code>lista</code>?  I can also see that the output will always start with a list of length 1, because of the <code>(x:[])</code>....  This is not what you want."}], "answers": [{"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 2, "last_activity_date": 1465238737, "creation_date": 1465238737, "answer_id": 37664734, "question_id": 37664128, "link": "https://stackoverflow.com/questions/37664128/group-function-using-takewhile-and-dropwhile/37664734#37664734", "title": "group function using takeWhile and dropWhile", "body": "<p>hint</p>\n\n<pre><code>group :: (Eq a) =&gt; [a] -&gt; [[a]]\ngroup [] = []\ngroup xs@(x:_) = -- what should be here?  \n      where (f,s) = (takeWhile (==x) xs, dropWhile (==x) xs)\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 6431419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8c63516d72c6c0e67aff718ea231b505?s=128&d=identicon&r=PG&f=1", "display_name": "Maria", "link": "https://stackoverflow.com/users/6431419/maria"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 872, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1493863512, "creation_date": 1465236670, "last_edit_date": 1493863512, "question_id": 37664128, "link": "https://stackoverflow.com/questions/37664128/group-function-using-takewhile-and-dropwhile", "title": "group function using takeWhile and dropWhile", "body": "<p>I'm a beginner in Haskell. I'd like to define the function <code>group</code> defined in the module <code>Data.List</code>. What I have done is this:</p>\n\n<pre><code>group []=[]\n\ngroup (x:xs)=(x:[]):lista xs\n</code></pre>\n\n<p>However, it doesn't result when we have equal letters together. How do I do that part? If possible using <code>dropWhile</code> and <code>takeWhile</code>.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 7, "creation_date": 1465235725, "post_id": 37663881, "comment_id": 62806150, "body": "<code>import Data.Monoid ((&lt;&gt;))</code>"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1465236193, "post_id": 37663881, "comment_id": 62806411, "body": "Welcome to monoids, enjoy your stay.  Watch out for the functors."}, {"owner": {"reputation": 1049, "user_id": 793874, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/512e19604a6878fd5aa38c4f180d5af9?s=128&d=identicon&r=PG", "display_name": "klappvisor", "link": "https://stackoverflow.com/users/793874/klappvisor"}, "reply_to_user": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1465236505, "post_id": 37663881, "comment_id": 62806549, "body": "Oh, shame on me... @Michael I think it&#39;s valid answer for invalid question... make it answer I will accept it. or should I remove question?"}, {"owner": {"reputation": 1049, "user_id": 793874, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/512e19604a6878fd5aa38c4f180d5af9?s=128&d=identicon&r=PG", "display_name": "klappvisor", "link": "https://stackoverflow.com/users/793874/klappvisor"}, "edited": false, "score": 0, "creation_date": 1465237650, "post_id": 37663881, "comment_id": 62807152, "body": "OK, there is nothing to add to answer by @leftaroundabout"}, {"owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "edited": false, "score": 0, "creation_date": 1465242083, "post_id": 37663881, "comment_id": 62809519, "body": "By the way, when searching for symbols you can use <a href=\"http://symbolhound.com\" rel=\"nofollow noreferrer\">SymbolHound</a>."}], "answers": [{"comments": [{"owner": {"reputation": 1049, "user_id": 793874, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/512e19604a6878fd5aa38c4f180d5af9?s=128&d=identicon&r=PG", "display_name": "klappvisor", "link": "https://stackoverflow.com/users/793874/klappvisor"}, "edited": false, "score": 0, "creation_date": 1465236774, "post_id": 37664101, "comment_id": 62806687, "body": "Thanks! did not know about Hayoo... Tried <a href=\"https://www.haskell.org/hoogle/?hoogle=%3C%3E\" rel=\"nofollow noreferrer\">query on Hoogle</a> but results where irrelevant. Does anybody know why?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 1049, "user_id": 793874, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/512e19604a6878fd5aa38c4f180d5af9?s=128&d=identicon&r=PG", "display_name": "klappvisor", "link": "https://stackoverflow.com/users/793874/klappvisor"}, "edited": false, "score": 0, "creation_date": 1465237196, "post_id": 37664101, "comment_id": 62806882, "body": "That&#39;s strange indeed, I would have thought Hoogle would also give the correct location."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 1049, "user_id": 793874, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/512e19604a6878fd5aa38c4f180d5af9?s=128&d=identicon&r=PG", "display_name": "klappvisor", "link": "https://stackoverflow.com/users/793874/klappvisor"}, "edited": false, "score": 1, "creation_date": 1465237286, "post_id": 37664101, "comment_id": 62806946, "body": "The stackage version of Hoogle <a href=\"https://www.stackage.org/lts-6.2/hoogle?q=%3C%3E\" rel=\"nofollow noreferrer\">does find it</a>. No idea why haskell.org/hoogle doesn&#39;t."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 4, "last_activity_date": 1465236551, "creation_date": 1465236551, "answer_id": 37664101, "question_id": 37663881, "link": "https://stackoverflow.com/questions/37663881/not-in-scope-for-data-text/37664101#37664101", "title": "Not in scope: \u2018&lt;&gt;\u2019 for Data.Text", "body": "<p>Whenever the compiler complains that some function isn't in scope, there's a good chance that you've just forgotten to import it. Your first stop at such an occasion should be Hayoo, which <a href=\"http://hayoo.fh-wedel.de/?query=%3C%3E\" rel=\"nofollow\">will readily tell you</a> that <code>&lt;&gt;</code> is defined in the module <code>Data.Monoid</code> from the <code>base</code> library<sup>&dagger;</sup>. So you just need to </p>\n\n<pre><code>import Data.Monoid ((&lt;&gt;))\n</code></pre>\n\n<p>on top of your module. Actually that's such a common module that I'd pretty much always import it, just as</p>\n\n<pre><code>import Data.Monoid\n</code></pre>\n\n<hr>\n\n<p><sup>&dagger;</sup><sub>If something <em>isn't</em> in <code>base</code>, you may also need to install the package it is in / add it as a dependency to the <code>.cabal</code> file.</sub></p>\n"}], "owner": {"reputation": 1049, "user_id": 793874, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/512e19604a6878fd5aa38c4f180d5af9?s=128&d=identicon&r=PG", "display_name": "klappvisor", "link": "https://stackoverflow.com/users/793874/klappvisor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "accepted_answer_id": 37664101, "answer_count": 1, "score": 2, "last_activity_date": 1465236551, "creation_date": 1465235647, "last_edit_date": 1495535641, "question_id": 37663881, "link": "https://stackoverflow.com/questions/37663881/not-in-scope-for-data-text", "title": "Not in scope: \u2018&lt;&gt;\u2019 for Data.Text", "body": "<p>I'm trying to join two Data.Text using <code>&lt;&gt;</code> operator, but when I compile I see the following error: </p>\n\n<pre><code>Not in scope: \u2018&lt;&gt;\u2019\n    Perhaps you meant one of these:\n      \u2018&lt;*&gt;\u2019 (imported from Prelude), \u2018&gt;&gt;\u2019 (imported from Prelude),\n      \u2018&lt;=\u2019 (imported from Prelude)\n</code></pre>\n\n<p>I use GHC 7.10.3, but according to <a href=\"https://stackoverflow.com/a/9963250/793874\">this answer</a> it was added long ago.</p>\n\n<p>Probably there is already answer to that question, but it's very hard to find it on StackOverflow due to <code>&lt;&gt;</code> symbols.</p>\n\n<p>Could you please help?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 339644, "user_id": 118068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077db5466d3b58e7bbbd498dca173f04?s=128&d=identicon&r=PG", "display_name": "Marc B", "link": "https://stackoverflow.com/users/118068/marc-b"}, "edited": false, "score": 1, "creation_date": 1465235264, "post_id": 37663752, "comment_id": 62805857, "body": "Write code. We don&#39;t do that for you. We (maybe) try help fix code that you have written."}, {"owner": {"reputation": 338, "user_id": 3613144, "user_type": "registered", "accept_rate": 53, "profile_image": "https://lh4.googleusercontent.com/-THxYGBq56MM/AAAAAAAAAAI/AAAAAAAAAWU/TxPNde2ZpYU/photo.jpg?sz=128", "display_name": "dpaul1994", "link": "https://stackoverflow.com/users/3613144/dpaul1994"}, "edited": false, "score": 0, "creation_date": 1465235341, "post_id": 37663752, "comment_id": 62805900, "body": "What is so hard? You need only the logic and syntaxes. If you know the syntaxes and logic, you can write your program :) (Logic simple: Search for word, and if is found, increment a variable, simple as that)"}], "answers": [{"comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1465236605, "post_id": 37663812, "comment_id": 62806610, "body": "maybe <code>words</code> instead of <code>tails</code> is ok here too (and maybe easier to the novice-eye)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1465237092, "post_id": 37663812, "comment_id": 62806842, "body": "@Carsten Perhaps. It depends on what behavior is desired, too. Hopefully anyone who stumbles on this and takes the time to understand the snippet  will be able to either modify it as needed for their behavior or be able to write a well-formed follow-up question."}, {"owner": {"reputation": 1049, "user_id": 793874, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/512e19604a6878fd5aa38c4f180d5af9?s=128&d=identicon&r=PG", "display_name": "klappvisor", "link": "https://stackoverflow.com/users/793874/klappvisor"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1465237483, "post_id": 37663812, "comment_id": 62807067, "body": "@Carsten <code>words</code> may not work on some input like <code>world,world</code>"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 1049, "user_id": 793874, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/512e19604a6878fd5aa38c4f180d5af9?s=128&d=identicon&r=PG", "display_name": "klappvisor", "link": "https://stackoverflow.com/users/793874/klappvisor"}, "edited": false, "score": 1, "creation_date": 1465238049, "post_id": 37663812, "comment_id": 62807385, "body": "@klappvisor that&#39;s why I had the &quot;maybe&quot; in there - it&#39;s just when the question asks for words instead of prefix ..."}, {"owner": {"reputation": 1049, "user_id": 793874, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/512e19604a6878fd5aa38c4f180d5af9?s=128&d=identicon&r=PG", "display_name": "klappvisor", "link": "https://stackoverflow.com/users/793874/klappvisor"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1465238718, "post_id": 37663812, "comment_id": 62807794, "body": "@Carsten I just thought it would be good to mention for some user who does not know that <code>words</code> in haskell splits text by spaces, and not by any regexp or some other logic. <code>tails</code> solution also has similar issue when <code>world</code> is part of other word which should not be found..."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 0, "last_activity_date": 1465235387, "creation_date": 1465235387, "answer_id": 37663812, "question_id": 37663752, "link": "https://stackoverflow.com/questions/37663752/how-i-can-know-how-many-times-a-word-is-repeated/37663812#37663812", "title": "How I can know how many times a word is repeated?", "body": "<p>The stupid way is to look at each position in the list and check if it's the start of <code>\"world\"</code>. Count up the positions that are and you're done.</p>\n\n<pre><code>Data.List&gt; length . filter (\"world\" `isPrefixOf`) . tails $ \"Hello world! I love this world\"\n2\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 1, "last_activity_date": 1465242914, "creation_date": 1465242914, "answer_id": 37665816, "question_id": 37663752, "link": "https://stackoverflow.com/questions/37663752/how-i-can-know-how-many-times-a-word-is-repeated/37665816#37665816", "title": "How I can know how many times a word is repeated?", "body": "<pre><code>import Data.List.Split(splitOneOf)\n\nwordcount w = length . filter (==w) . splitOneOf \";.,! \"\n\n&gt; wordcount \"world\" \"Hello world! I love this world\"\n2\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 4989750, "user_type": "registered", "accept_rate": 48, "profile_image": "https://graph.facebook.com/10155683297590191/picture?type=large", "display_name": "BarneyL. BarStin", "link": "https://stackoverflow.com/users/4989750/barneyl-barstin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "closed_date": 1465249995, "answer_count": 2, "score": -3, "last_activity_date": 1465242914, "creation_date": 1465235144, "last_edit_date": 1465236303, "question_id": 37663752, "link": "https://stackoverflow.com/questions/37663752/how-i-can-know-how-many-times-a-word-is-repeated", "closed_reason": "Needs more focus", "title": "How I can know how many times a word is repeated?", "body": "<p>I have the follow text: <code>\"Hello world! I love this world\"</code> and I need to know how many times the word \"world\" is repeated in the text. How I can do it with Haskell?</p>\n"}, {"tags": ["haskell", "getline", "notation"], "comments": [{"owner": {"reputation": 2319, "user_id": 2211273, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/6d55ba6b0f08aed750502866c7e7ee77?s=128&d=identicon&r=PG", "display_name": "Kritzefitz", "link": "https://stackoverflow.com/users/2211273/kritzefitz"}, "edited": false, "score": 1, "creation_date": 1465232716, "post_id": 37662754, "comment_id": 62804522, "body": "These two questions (<a href=\"http://stackoverflow.com/q/16964732/2211273\">1</a>, <a href=\"http://stackoverflow.com/q/25255260/2211273\">2</a>) questions also are about desugaring do syntax. <a href=\"http://stackoverflow.com/a/16726740/2211273\">This answer</a> also explains nicely how to do it."}], "answers": [{"comments": [{"owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "edited": false, "score": 0, "creation_date": 1465232875, "post_id": 37662972, "comment_id": 62804606, "body": "In your more straight-forward translation, shouldn&#39;t the parentheses be wrapping simply the <code>putStr $ show $ length $ words s</code> statement? Wrapping <code>(\\s -&gt; putStr $ show $ length $ words s)</code> means that <code>s</code> is not usable in subsequent monadic statements"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "edited": false, "score": 0, "creation_date": 1465233152, "post_id": 37662972, "comment_id": 62804722, "body": "@ChadGilbert: you mean like the updated answer? Yes indeed. Thanks for spotting that."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "edited": false, "score": 1, "creation_date": 1465233635, "post_id": 37662972, "comment_id": 62804954, "body": "@ChadGilbert: I&#39;ve updated the answer with an additional note to further explain the isue, many thanks."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1465296526, "last_edit_date": 1495535642, "creation_date": 1465232212, "answer_id": 37662972, "question_id": 37662754, "link": "https://stackoverflow.com/questions/37662754/haskell-words-count-from-a-getline-without-the-do-notation/37662972#37662972", "title": "Haskell: words count from a getLine without the &quot;do&quot; notation", "body": "<p>Instead of using <a href=\"https://wiki.haskell.org/Keywords#do\" rel=\"nofollow noreferrer\"><code>do</code></a>, you can use <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#v:-62--62-\" rel=\"nofollow noreferrer\"><code>&gt;&gt;</code></a> and <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#v:-62--62--61-\" rel=\"nofollow noreferrer\"><code>&gt;&gt;=</code></a>:</p>\n\n<pre><code>wordsCount = putStr \"Write a line and press [enter]:\\n\" &gt;&gt; getLine &gt;&gt;= putStr . show . length . words &gt;&gt; putChar '\\n'\n</code></pre>\n\n<p>Or making it easier to read:</p>\n\n<pre><code>wordsCount = putStr \"Write a line and press [enter]:\\n\" &gt;&gt;\n    getLine &gt;&gt;=\n    putStr . show . length . words &gt;&gt;\n    putChar '\\n'\n</code></pre>\n\n<p>A more straight-forward translation would be:</p>\n\n<pre><code>wordsCount = putStr \"Write a line and press [enter]:\\n\" &gt;&gt;\n    getLine &gt;&gt;=\n    \\s -&gt; (putStr $ show $ length $ words s) &gt;&gt;\n    putChar '\\n'\n</code></pre>\n\n<p>Basically the compiler converts such <code>do</code>-notation blocks to its monadic equivalent (using only <code>&gt;&gt;</code> and <code>&gt;&gt;=</code>). <code>do</code> is only syntactical sugar such that one does not have to write <code>&gt;&gt;=</code> each time and/or mange variables.</p>\n\n<p><strong>Additional notes:</strong></p>\n\n<ul>\n<li><p>as @ChadGilbert said in <a href=\"https://stackoverflow.com/questions/37662754/haskell-words-count-from-a-getline-without-the-do-notation/37662972?noredirect=1#comment62804606_37662972\">his comment</a>, the parenthesis should be wrapped around the function, excluding the <code>\\s -&gt;</code> such that the <code>s</code> can be used later on in the program, for example:</p>\n\n<pre><code>-- This is not an equivalent program\nwordsCount = putStr \"Write a line and press [enter]:\\n\" &gt;&gt;\n    getLine &gt;&gt;=\n    \\s -&gt; (putStr $ show $ length $ words s) &gt;&gt;\n    putChar '\\n' &gt;&gt;\n    putStrLn s -- repeat s\n</code></pre></li>\n<li><p>Instead of using <code>putStr</code> and <code>putChar</code>, you can use <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Prelude.html#v:putStrLn\" rel=\"nofollow noreferrer\"><code>putStrLn</code></a>. For example:</p>\n\n<pre><code>wordsCount = putStr \"Write a line and press [enter]:\\n\" &gt;&gt;\n    getLine &gt;&gt;=\n    putStrLn . show . length . words\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 141, "user_id": 6185125, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/680282768780295/picture?type=large", "display_name": "John Doe", "link": "https://stackoverflow.com/users/6185125/john-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 530, "favorite_count": 1, "accepted_answer_id": 37662972, "answer_count": 1, "score": 3, "last_activity_date": 1465296526, "creation_date": 1465231433, "last_edit_date": 1465233076, "question_id": 37662754, "link": "https://stackoverflow.com/questions/37662754/haskell-words-count-from-a-getline-without-the-do-notation", "title": "Haskell: words count from a getLine without the &quot;do&quot; notation", "body": "<p>How do I write the following function without using the \"do\" notation?</p>\n\n<pre><code>wordsCount =  do \n    putStr \"Write a line and press [enter]:\\n\"\n    s &lt;- getLine\n    putStr $ show $ length . words $ s\n    putChar '\\n'\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "fold", "foldleft"], "comments": [{"owner": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "edited": false, "score": 8, "creation_date": 1465221118, "post_id": 37659198, "comment_id": 62797029, "body": "For <code>foldl</code> you need to switch the argument order between <code>acc</code> and <code>_</code>, because <code>foldr</code> logically puts the initial argument on the end of the sequence, while <code>foldl</code> puts it logically at the start. That means that the accumulator is the first (!) argument to the folding function for <code>foldl</code> (and the second argument for <code>foldr</code>). Because of this mistake, your accumulator &#39;starts&#39; at <code>1</code> for <code>foldl</code> rather than <code>0</code>. If you change the list to <code>[&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;, &quot;e&quot;]</code> for instance, then you&#39;ll get a nice type-check error on the <code>foldl</code> sample."}, {"owner": {"reputation": 791, "user_id": 1587319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c8a88b9a8d79a518cba52a7a8d099f9?s=128&d=identicon&r=PG", "display_name": "pdexter", "link": "https://stackoverflow.com/users/1587319/pdexter"}, "edited": false, "score": 3, "creation_date": 1465221184, "post_id": 37659198, "comment_id": 62797094, "body": "If you try <code>foldl (\\_ acc -&gt; acc + 1) 0 [0,0,0,0]</code> then maybe you will see your error."}, {"owner": {"reputation": 43, "user_id": 4282249, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f48592e60c8cafdfb79f2d1e1d166668?s=128&d=identicon&r=PG&f=1", "display_name": "laurentiupiciu", "link": "https://stackoverflow.com/users/4282249/laurentiupiciu"}, "reply_to_user": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "edited": false, "score": 0, "creation_date": 1465221300, "post_id": 37659198, "comment_id": 62797181, "body": "Thank you, @MicroVirus !"}, {"owner": {"reputation": 43, "user_id": 4282249, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f48592e60c8cafdfb79f2d1e1d166668?s=128&d=identicon&r=PG&f=1", "display_name": "laurentiupiciu", "link": "https://stackoverflow.com/users/4282249/laurentiupiciu"}, "reply_to_user": {"reputation": 791, "user_id": 1587319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c8a88b9a8d79a518cba52a7a8d099f9?s=128&d=identicon&r=PG", "display_name": "pdexter", "link": "https://stackoverflow.com/users/1587319/pdexter"}, "edited": false, "score": 0, "creation_date": 1465221373, "post_id": 37659198, "comment_id": 62797244, "body": "Yes, I&#39;ve seen it, @pdexter"}, {"owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "reply_to_user": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "edited": false, "score": 1, "creation_date": 1465222779, "post_id": 37659198, "comment_id": 62798257, "body": "@MicroVirus You should consider making that comment into an answer!"}, {"owner": {"reputation": 791, "user_id": 1587319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c8a88b9a8d79a518cba52a7a8d099f9?s=128&d=identicon&r=PG", "display_name": "pdexter", "link": "https://stackoverflow.com/users/1587319/pdexter"}, "reply_to_user": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "edited": false, "score": 0, "creation_date": 1465224969, "post_id": 37659198, "comment_id": 62799742, "body": "@MicroVirus, it&#39;s not because the accumulator starts at 1, it&#39;s that the fold just returns the last element of the list plus 1."}, {"owner": {"reputation": 5171, "user_id": 2718186, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/ca44ca18bf615e74f930d28a89d01508?s=128&d=identicon&r=PG", "display_name": "MicroVirus", "link": "https://stackoverflow.com/users/2718186/microvirus"}, "reply_to_user": {"reputation": 791, "user_id": 1587319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c8a88b9a8d79a518cba52a7a8d099f9?s=128&d=identicon&r=PG", "display_name": "pdexter", "link": "https://stackoverflow.com/users/1587319/pdexter"}, "edited": false, "score": 1, "creation_date": 1465225029, "post_id": 37659198, "comment_id": 62799779, "body": "@pdexter Yeah, that was maybe a bit confusing wording on my part, but I meant the &#39;element&#39; <code>1</code>. I cramped it all in one comment, so it&#39;s not a complete answer. Feel free to write up a complete answer; that goes for everyone."}], "answers": [{"tags": [], "owner": {"reputation": 22952, "user_id": 210211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8721ff8fa4b5c658058f4a2803231f44?s=128&d=identicon&r=PG", "display_name": "comingstorm", "link": "https://stackoverflow.com/users/210211/comingstorm"}, "is_accepted": true, "score": 4, "last_activity_date": 1465318623, "last_edit_date": 1465318623, "creation_date": 1465234952, "answer_id": 37663696, "question_id": 37659198, "link": "https://stackoverflow.com/questions/37659198/how-does-foldl-work/37663696#37663696", "title": "How does foldl work?", "body": "<p>In <code>foldr</code>, the accumulator is the second argument of the function you're folding with, but in <code>foldl</code>, the accumulator is the first argument.  If you look carefully at the question's introductory paragraph, you can work this out for yourself...</p>\n\n<p>The \"1st example\" code is misleading because the <code>acc</code> argument (whose name suggests that it should be an accumulator) is consistently the second argument to the lambda, when it should be first for <code>foldl</code>.  It is additionally confusing because the type and values of the sample list elements mirror the type and value of the accumulator value... as the comments mention, it would have been better to use other values, and better yet to use some other type!</p>\n\n<p>For the \"2nd example\", you get a type error because your arguments are swapped (and you can't have a list whose elements are lists of itself).  Either swap the argument order by hand:</p>\n\n<pre><code>foldl (\\xs x -&gt; x:xs)\n</code></pre>\n\n<p>or else use <code>flip</code>, the library function designed for this:</p>\n\n<pre><code>foldl (flip (:))\n</code></pre>\n\n<p>Note that the result for the <code>foldl</code> case should be a reversed list (not a copied one), because <code>foldl</code> iterates in the opposite direction from <code>foldr</code>.</p>\n"}], "owner": {"reputation": 43, "user_id": 4282249, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f48592e60c8cafdfb79f2d1e1d166668?s=128&d=identicon&r=PG&f=1", "display_name": "laurentiupiciu", "link": "https://stackoverflow.com/users/4282249/laurentiupiciu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 389, "favorite_count": 0, "accepted_answer_id": 37663696, "answer_count": 1, "score": 3, "last_activity_date": 1465318623, "creation_date": 1465220903, "question_id": 37659198, "link": "https://stackoverflow.com/questions/37659198/how-does-foldl-work", "title": "How does foldl work?", "body": "<p>Can anybody explain how <code>foldl</code> works?<br>\nI understood that, for example, <code>foldr (-) 0 [1,2,3]</code> produces (1 - (2 - (3 - 0))), whereas <code>foldl (-) 0 [1,2,3]</code> produces (((0 - 1) - 2) - 3), but I have still some questions:  </p>\n\n<ul>\n<li><p>1st example (length of a list with foldr/foldl):<br>\n<code>foldr (\\_ acc -&gt; acc + 1) 0 [1,2,3,4,5]</code> produces 5, as expected.<br>\n<code>foldl (\\_ acc -&gt; acc + 1) 0 [1,2,3,4,5]</code> produces 6. :|<br>\n<code>foldl (\\_ acc -&gt; acc + 1) 0 [2]</code> produces 3. :|<br>\nHow does foldl react to these given examples?  </p></li>\n<li><p>2nd example:<br>\n<code>foldr (:) [] [1,2,3,4]</code> produces [1,2,3,4] - no worry, but <code>foldl (:) [] [1,2,3,4]</code> gives me an error: <code>Occurs check: cannot construct the infinite type: a ~ [a]</code><br>\nWhat is wrong with foldl?</p></li>\n</ul>\n"}, {"tags": ["haskell", "concat", "fold"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1465220859, "post_id": 37659150, "comment_id": 62796864, "body": "It&#39;s doesn&#39;t make a lot of sense to define a <code>++</code>-like operator using <code>fold</code> if the fold uses <code>++</code>."}, {"owner": {"reputation": 791, "user_id": 1587319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c8a88b9a8d79a518cba52a7a8d099f9?s=128&d=identicon&r=PG", "display_name": "pdexter", "link": "https://stackoverflow.com/users/1587319/pdexter"}, "edited": false, "score": 0, "creation_date": 1465221034, "post_id": 37659150, "comment_id": 62796982, "body": "For a simple fix, you could try the &#39;other&#39; fold"}], "answers": [{"tags": [], "owner": {"reputation": 4071, "user_id": 3806046, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5fedf50ce7cd2659bca902e9a2969158?s=128&d=identicon&r=PG&f=1", "display_name": "jkeuhlen", "link": "https://stackoverflow.com/users/3806046/jkeuhlen"}, "is_accepted": true, "score": 3, "last_activity_date": 1465222970, "creation_date": 1465222970, "answer_id": 37659911, "question_id": 37659150, "link": "https://stackoverflow.com/questions/37659150/concat-two-lists-definition-with-fold/37659911#37659911", "title": "Concat two lists definition with fold", "body": "<p>You are using the wrong <code>fold</code> for what you want to do. </p>\n\n<p>Take a look at <a href=\"https://wiki.haskell.org/Foldr_Foldl_Foldl&#39;\" rel=\"nofollow\">wiki haskell's page on foldr, foldl, and foldl'</a>. </p>\n\n<p><code>foldr</code> puts the first argument at the end (think of it as on the \"right\")<br>\n<code>foldl</code> puts the first argument logically at the beginning (think of it as on the \"left\")</p>\n\n<p>When you think of the different fold's like this their names become much more clear. It is simply fold-right and fold-left!</p>\n\n<p>So to get the orders correct use:</p>\n\n<pre><code>plusplus :: [a]-&gt;[a]-&gt;[a] \nplusplus l = foldl (\\x l1 -&gt; x:l1) l\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 671, "user_id": 1404864, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/1e0c29e1eb05ea4197aca463b41a5c2c?s=128&d=identicon&r=PG", "display_name": "Rubbal", "link": "https://stackoverflow.com/users/1404864/rubbal"}, "edited": false, "score": 0, "creation_date": 1570229086, "post_id": 37661610, "comment_id": 102859894, "body": "The last line is super helpful!"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 7, "last_activity_date": 1465227883, "creation_date": 1465227883, "answer_id": 37661610, "question_id": 37659150, "link": "https://stackoverflow.com/questions/37659150/concat-two-lists-definition-with-fold/37661610#37661610", "title": "Concat two lists definition with fold", "body": "<p>We start from your wrong code:</p>\n\n<pre><code>plusplus :: [a]-&gt;[a]-&gt;[a]\nplusplus l = foldr (\\x l1 -&gt; x:l1) l\n</code></pre>\n\n<p>We eta-expand so to mention the second argument:</p>\n\n<pre><code>plusplus :: [a]-&gt;[a]-&gt;[a]\nplusplus xs ys = foldr (\\x l1 -&gt; x:l1) xs ys\n</code></pre>\n\n<p>This appends in the reverse order, so we flip the arguments to fix it:</p>\n\n<pre><code>plusplus :: [a]-&gt;[a]-&gt;[a]\nplusplus xs ys = foldr (\\x l1 -&gt; x:l1) ys xs\n</code></pre>\n\n<p>Further finishing touches:</p>\n\n<pre><code>plusplus :: [a]-&gt;[a]-&gt;[a]\nplusplus xs ys = foldr (:) ys xs\n\n\nplusplus :: [a]-&gt;[a]-&gt;[a]\nplusplus xs ys = flip (foldr (:)) xs ys\n\n\nplusplus :: [a]-&gt;[a]-&gt;[a]\nplusplus = flip (foldr (:))\n</code></pre>\n\n<p>The last one is a tad cryptic, but not excessively so.</p>\n\n<p>My own preferred variant is the pointful <code>foldr (:) ys xs</code>, which can be read as follows. Take <code>xs</code>, replace every <code>(:)</code> in it with <code>(:)</code> (no-op), and replace the final <code>[]</code> with <code>ys</code>.</p>\n"}], "owner": {"reputation": 313, "user_id": 6066031, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/87e031e69d7be579f9a4a5c0f72e4cce?s=128&d=identicon&r=PG&f=1", "display_name": "P_Ferreira", "link": "https://stackoverflow.com/users/6066031/p-ferreira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2159, "favorite_count": 1, "accepted_answer_id": 37659911, "answer_count": 2, "score": 2, "last_activity_date": 1465259185, "creation_date": 1465220788, "last_edit_date": 1465259185, "question_id": 37659150, "link": "https://stackoverflow.com/questions/37659150/concat-two-lists-definition-with-fold", "title": "Concat two lists definition with fold", "body": "<p>I want to make <code>(++) :: [a] -&gt; [a] -&gt; [a]</code> with a fold.\nI made this:</p>\n\n<pre><code>plusplus :: [a]-&gt;[a]-&gt;[a]\nplusplus l = foldr (\\x l1 -&gt; x:l1) l\n</code></pre>\n\n<p>But i am getting the reverser order. E.g:</p>\n\n<pre><code>plusplus [1,2,3] [4,5,6]\nOutput: [4,5,6,1,2,3]\n</code></pre>\n\n<p>I understand why i am geting this, but i still don't know how to fix this.</p>\n\n<p>Edit: I posted the wrong solution, sorry.</p>\n"}, {"tags": ["haskell", "recursion", "types", "typeclass"], "comments": [{"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 3, "creation_date": 1465216853, "post_id": 37657698, "comment_id": 62794113, "body": "<code>Int a =&gt; ...</code> makes no sense. <code>Int</code> is a concrete type, not a type class."}, {"owner": {"reputation": 791, "user_id": 1587319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c8a88b9a8d79a518cba52a7a8d099f9?s=128&d=identicon&r=PG", "display_name": "pdexter", "link": "https://stackoverflow.com/users/1587319/pdexter"}, "edited": false, "score": 2, "creation_date": 1465216876, "post_id": 37657698, "comment_id": 62794127, "body": "You put a typeclass constraint when the function body uses a member of that typeclass."}], "answers": [{"tags": [], "owner": {"reputation": 34669, "user_id": 34409, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4dfdadcd9bb62300eb1a54f02fe5dc18?s=128&d=identicon&r=PG", "display_name": "Chad Gilbert", "link": "https://stackoverflow.com/users/34409/chad-gilbert"}, "is_accepted": false, "score": 0, "last_activity_date": 1465216977, "creation_date": 1465216977, "answer_id": 37657800, "question_id": 37657698, "link": "https://stackoverflow.com/questions/37657698/when-include-in-haskell-typeclass-in-a-function-when-declaring-its-type/37657800#37657800", "title": "When include in Haskell TypeClass in a function when declaring its type", "body": "<p>It is typically best to design your functions with the minimal amount of restriction necessary. Does your <code>reverse'</code> function actually do anything that requires its contents to be of type <code>Int</code>? If not, then there is no reason to enforce the restriction that the contents are of type <code>Int</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 3, "last_activity_date": 1465219085, "creation_date": 1465219085, "answer_id": 37658561, "question_id": 37657698, "link": "https://stackoverflow.com/questions/37657698/when-include-in-haskell-typeclass-in-a-function-when-declaring-its-type/37658561#37658561", "title": "When include in Haskell TypeClass in a function when declaring its type", "body": "<p>Most of the time GHC can figure out what constraints are needed. Here are two ways to have GHC tell you what it thinks the most general type of a function is:</p>\n\n<ol>\n<li><p>Do not put a type signature on the function, and at the ghci prompt use the command <code>:t functionName</code></p></li>\n<li><p>Use a type-hole <code>_</code> (GHC >= 7.8) as the type signature:</p>\n\n<pre><code> repeat' :: _\n repeat' ... = ...\n</code></pre></li>\n</ol>\n\n<p>Both ghci and ghc will emit a message like:</p>\n\n<pre><code>    Found hole \u2018_\u2019 with type: ...\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6430430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/58cc3face8378d254e7004ec0960a430?s=128&d=identicon&r=PG&f=1", "display_name": "Paul", "link": "https://stackoverflow.com/users/6430430/paul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1465219085, "creation_date": 1465216669, "question_id": 37657698, "link": "https://stackoverflow.com/questions/37657698/when-include-in-haskell-typeclass-in-a-function-when-declaring-its-type", "title": "When include in Haskell TypeClass in a function when declaring its type", "body": "<p>I'm learning haskell with <a href=\"http://learnyouahaskell.com\" rel=\"nofollow\">http://learnyouahaskell.com</a>\nI'm confused to know when I have to include the TypeClass into the function type declaration like this one:</p>\n\n<pre><code>reverse' :: (Int a) =&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>For example, in the recursion: <a href=\"http://learnyouahaskell.com/recursion\" rel=\"nofollow\">http://learnyouahaskell.com/recursion</a>. There are examples when teacher includes the Typeclass and others only put the type without Typeclass.</p>\n\n<pre><code>repeat' :: a -&gt; [a]  \n</code></pre>\n\n<p><strong>When</strong> I should include the Typeclass and In which cases is not necessary?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2571, "user_id": 1264675, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7cdce6fa69152f105c232420c8e62925?s=128&d=identicon&r=PG", "display_name": "Undreren", "link": "https://stackoverflow.com/users/1264675/undreren"}, "edited": false, "score": 0, "creation_date": 1465215309, "post_id": 37656419, "comment_id": 62793063, "body": "The line of code can&#39;t compile. <code>splitOn</code> is of type <code>Text -&gt; Text -&gt; [Text]</code> and <code>unwords</code> are of type <code>[String] -&gt; String</code>. Your are handing <code>unwords</code> a wrong type. Could you copy the entire function?"}], "answers": [{"tags": [], "owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "is_accepted": true, "score": 11, "last_activity_date": 1465213692, "creation_date": 1465213692, "answer_id": 37656663, "question_id": 37656419, "link": "https://stackoverflow.com/questions/37656419/how-i-can-split-n-in-haskell/37656663#37656663", "title": "How i can split &quot;\\n&quot; in haskell?", "body": "<p>Have you tried to use <code>lines</code>?</p>\n\n<pre><code>let secondLine = (lines seccion) !! 1 in\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2571, "user_id": 1264675, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/7cdce6fa69152f105c232420c8e62925?s=128&d=identicon&r=PG", "display_name": "Undreren", "link": "https://stackoverflow.com/users/1264675/undreren"}, "is_accepted": false, "score": 3, "last_activity_date": 1465215375, "creation_date": 1465215375, "answer_id": 37657230, "question_id": 37656419, "link": "https://stackoverflow.com/questions/37656419/how-i-can-split-n-in-haskell/37657230#37657230", "title": "How i can split &quot;\\n&quot; in haskell?", "body": "<p>The easiest solution to dropping the first line is to uses <code>lines</code>. It has the following signatures:</p>\n\n<pre><code>lines :: String -&gt; [String]   -- Splits string over newline character\n</code></pre>\n\n<p>You can therefore get the second line using:</p>\n\n<pre><code>let secondLine = head (tail (lines seccion))\n</code></pre>\n\n<p>Alternatively, you can use point-free style:</p>\n\n<pre><code>let secondLine = head . tail . lines $ seccion\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11096, "user_id": 2749717, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/46af1ef54856d737d52b7667afd240ee?s=128&d=identicon&r=PG&f=1", "display_name": "bipll", "link": "https://stackoverflow.com/users/2749717/bipll"}, "edited": false, "score": 0, "creation_date": 1568493543, "post_id": 37657869, "comment_id": 102293599, "body": "<code>let (_:second:_) = lines seccion in</code>"}], "tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 1, "last_activity_date": 1465217170, "creation_date": 1465217170, "answer_id": 37657869, "question_id": 37656419, "link": "https://stackoverflow.com/questions/37656419/how-i-can-split-n-in-haskell/37657869#37657869", "title": "How i can split &quot;\\n&quot; in haskell?", "body": "<p>or simply</p>\n\n<pre><code>let (header:second:rest) = lines seccion\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 4989750, "user_type": "registered", "accept_rate": 48, "profile_image": "https://graph.facebook.com/10155683297590191/picture?type=large", "display_name": "BarneyL. BarStin", "link": "https://stackoverflow.com/users/4989750/barneyl-barstin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2903, "favorite_count": 0, "accepted_answer_id": 37656663, "answer_count": 3, "score": 1, "last_activity_date": 1465217170, "creation_date": 1465213006, "last_edit_date": 1465213984, "question_id": 37656419, "link": "https://stackoverflow.com/questions/37656419/how-i-can-split-n-in-haskell", "title": "How i can split &quot;\\n&quot; in haskell?", "body": "<p>i have the following text as String:</p>\n\n<pre><code>1. INTRODUCTION\nCerebral venous sinus thrombosis (CVST)\n</code></pre>\n\n<p>and i only need the second line as string, so i am using the below code</p>\n\n<pre><code>let SecondLine = unwords( tail (splitOn \"\\n\" seccion))\n</code></pre>\n\n<p>but SecondLine is empty. Someone can help me?</p>\n"}, {"tags": ["haskell", "networking", "process", "signals", "port"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1465204389, "post_id": 37652996, "comment_id": 62786541, "body": "is the question how to get the <code>ProcessID</code> of your server? What about <a href=\"https://hackage.haskell.org/package/unix-2.7.2.0/docs/System-Posix-Process-ByteString.html#v:getProcessID\" rel=\"nofollow noreferrer\"><code>getProcessID</code></a>?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 3, "creation_date": 1465204473, "post_id": 37652996, "comment_id": 62786578, "body": "to be honest this looks like something you should do with your OS tools"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1465226739, "post_id": 37652996, "comment_id": 62800976, "body": "couldn&#39;t you use <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/System-Exit.html\" rel=\"nofollow noreferrer\">System.Exit <code>exitSuccess</code></a> instead of terminating the application from outside"}, {"owner": {"reputation": 3794, "user_id": 137871, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/48469162d45686615c6bf0eb4304bf26?s=128&d=identicon&r=PG", "display_name": "insitu", "link": "https://stackoverflow.com/users/137871/insitu"}, "edited": false, "score": 0, "creation_date": 1465305124, "post_id": 37652996, "comment_id": 62837679, "body": "My usual approach to this problem is to provide a <code>stop</code> endpoint in the server that&#39;s accessible only on an administration interface, e.g. localhost. This makes your application much easier to manage, including when you want to run tests"}], "owner": {"reputation": 87, "user_id": 3978367, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3p4xS.jpg?s=128&g=1", "display_name": "Alex Elyasov", "link": "https://stackoverflow.com/users/3978367/alex-elyasov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1465202451, "creation_date": 1465202451, "question_id": 37652996, "link": "https://stackoverflow.com/questions/37652996/haskell-function-to-get-process-pid-by-port-number", "title": "Haskell function to get process pid by port number", "body": "<p>I have a <em>warp</em> server running locally on a known port. I would like to send termination signal to this application programmatically using haskell. If I knew the application pid, I could use <strong>signalProcess</strong> function from <em>System.Posix.Signals</em> module. Unfortunately all my attempts to find the right package with required functionality didn't bring any result. </p>\n\n<p>As an alternative approach to send a signal to an application, I could use haskell wrapper around shell and try to kill the server by the port number. But this solution to me looks a bit ugly and I would rather use some build-in haskell library to do this.</p>\n"}, {"tags": ["haskell", "types", "algebraic-data-types"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1465200246, "post_id": 37652243, "comment_id": 62784239, "body": "I&#39;m not sure about what you actually want: if you have a large number of fields you still have to write them all... what would you what to do instead? Also, fields and sum types do not play terribly well together since e.g. <code>a :: T3 -&gt; Int</code> is partial, and will crash your program as soon as you mistakenly feed a <code>T2 &#39;c&#39;</code> value to it. (OTOH, if fields are only used in patterns, then they are safe.)"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 1, "creation_date": 1465205810, "post_id": 37652243, "comment_id": 62787394, "body": "&quot;how to handle&quot;: What actual problem are you having? That the definition looks too big? You have to repeat yourself too much? Records aren&#39;t extensible? Something else?"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1465209500, "post_id": 37652243, "comment_id": 62789580, "body": "... avoid writing all data constructors on one line?"}, {"owner": {"reputation": 111, "user_id": 6091550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/673693960db305ee6cfe4680c6f2c334?s=128&d=identicon&r=PG&f=1", "display_name": "liu3tao", "link": "https://stackoverflow.com/users/6091550/liu3tao"}, "edited": false, "score": 0, "creation_date": 1465230702, "post_id": 37652243, "comment_id": 62803418, "body": "Sorry I wasn&#39;t very clear in my question. My concern is that since T1 and T2 are embedded in T3, T3 might get bloated if T1 or T2 are complex. I am looking for a way to &quot;decouple&quot; T1 and T2 from T3 such that the internals of T1 and T2 can be defined separately. @leftaroundabout showed a solution with <code>T3_1</code> and <code>T3_2</code> below."}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 13, "last_activity_date": 1465215547, "creation_date": 1465215547, "answer_id": 37657296, "question_id": 37652243, "link": "https://stackoverflow.com/questions/37652243/record-syntax-and-sum-types/37657296#37657296", "title": "Record syntax and sum types", "body": "<p>I don't quite understand what concerns you have, but to answer the question in the last line: <em>no</em>, it is rather not a good idea to mix sum types with record syntax. Records in general remain a bit of a weak spot of the Haskell language; they don't handle scoping very well at all. It's usually fine as long as you just have some seperate types with different record labels, but as soon as sum types or name clashes come in it gets rather nasty.</p>\n\n<p>In particular, Haskell permits you to use a record field accessor of the <code>T1</code> constructor for any value of type <code>T3</code> &ndash; <code>print $ a (T2 'x')</code> will compile without warnings, but give a rather hard to foresee error at runtime.</p>\n\n<p>In your example, it fortunately looks like you can easily avoid that kind of trouble:</p>\n\n<pre><code>data T3 = T3_1 T1 | T3_2 T2\n           deriving (Show)\ndata T1 = T1 { a :: Int\n             , b :: Float}\n           deriving (Show)\ndata T2 = T2 { x :: Char }\n           deriving (Show)\n</code></pre>\n\n<p>Now, any deconstruction you could write will be properly typechecked to make sense.</p>\n\n<p>And such a structure of meaningful, small specialised sub-types<sup>&dagger;</sup> is generally better to handle than a single monolithic type, especially if you have many functions that really deal only with part of the data structure.</p>\n\n<p>The flip side is that it gets quadratically tedious to unwrap the layers of constructors, but that's fortunately a solved problem now: <a href=\"http://lens.github.io/\" rel=\"noreferrer\">lens libraries</a> allow you to compose accessor/modifiers very neatly.</p>\n\n<p>Speaking of solved problems: <a href=\"https://nikita-volkov.github.io/record/\" rel=\"noreferrer\">Nikita Volkov</a> has come up with a really nice concept for entirely replacing the problem-ridden record syntax.</p>\n\n<hr>\n\n<p><sup>&dagger;</sup><sub>Um... actually these aren't subtypes in any proper sense of the word, but you get what I mean.</sub></p>\n"}], "owner": {"reputation": 111, "user_id": 6091550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/673693960db305ee6cfe4680c6f2c334?s=128&d=identicon&r=PG&f=1", "display_name": "liu3tao", "link": "https://stackoverflow.com/users/6091550/liu3tao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1751, "favorite_count": 4, "accepted_answer_id": 37657296, "answer_count": 1, "score": 4, "last_activity_date": 1465215547, "creation_date": 1465199857, "last_edit_date": 1465206435, "question_id": 37652243, "link": "https://stackoverflow.com/questions/37652243/record-syntax-and-sum-types", "title": "Record syntax and sum types", "body": "<p>I have this question about sum types in Haskell.</p>\n\n<p>I'd like to create a sum type which is comprised of two or more other types, and each of the types may contain multiple fields. A trivial example would be like this:</p>\n\n<pre><code>data T3 = T1 { a :: Int, b :: Float} | T2 { x :: Char } deriving (Show)\n</code></pre>\n\n<p>In my understanding, <code>T1</code> and <code>T2</code> are data constructors which use record syntax. It seems that the definition of <code>T3</code> will grow as the number of fields in <code>T1</code> or <code>T2</code> increases. My question is that how to practically handle these sum type constructors if the number of fields are large? Or, is it a good idea to mix sum type with record syntax?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1465186115, "post_id": 37649093, "comment_id": 62778738, "body": "does it work outside MSYS?"}, {"owner": {"reputation": 67, "user_id": 3150422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2191bc1435b756d5b3f46e9c9e2404ce?s=128&d=identicon&r=PG&f=1", "display_name": "user3150422", "link": "https://stackoverflow.com/users/3150422/user3150422"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1465186677, "post_id": 37649093, "comment_id": 62778868, "body": "Sorry, I don&#39;t know how to avoid msys; I just ran it under a command prompt window."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1465187258, "post_id": 37649093, "comment_id": 62779001, "body": "well I had to upgrade to 1.1.2 first but on my system it runs fine - can you post more of the output (you did not start in this path right)?"}, {"owner": {"reputation": 67, "user_id": 3150422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2191bc1435b756d5b3f46e9c9e2404ce?s=128&d=identicon&r=PG&f=1", "display_name": "user3150422", "link": "https://stackoverflow.com/users/3150422/user3150422"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1465187644, "post_id": 37649093, "comment_id": 62779089, "body": "Downloaded lts-6.1 build plan. Populated index cache. Updating package index Hackage (mirrored at <a href=\"https://github.com/commercialhas\" rel=\"nofollow noreferrer\">github.com/commercialhas</a>  remote: Counting objects: 24310, done. ... Resolving deltas: 100% (6576/6576), completed with 1683 local objects. From <a href=\"https://github.com/commercialhaskell/all-cabal-hashes\" rel=\"nofollow noreferrer\">github.com/commercialhaskell/all-cabal-hashes</a>  + 7a21e49...42c815c display    -&gt; origin/display  (forced update)  - [tag update]      current-hackage -&gt; current-hackage Fetched package index. C:\\msys64\\usr\\share\\bash-completion\\completions\\sh: streamingProcess: invali gument (Exec format error)"}, {"owner": {"reputation": 67, "user_id": 3150422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2191bc1435b756d5b3f46e9c9e2404ce?s=128&d=identicon&r=PG&f=1", "display_name": "user3150422", "link": "https://stackoverflow.com/users/3150422/user3150422"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1465187719, "post_id": 37649093, "comment_id": 62779120, "body": "I started in directory C:Users\\John\\begriffs\\bahugs"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1465188598, "post_id": 37649093, "comment_id": 62779332, "body": "are you using a non-english OS?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1465188665, "post_id": 37649093, "comment_id": 62779353, "body": "if so try this: <a href=\"http://windows.microsoft.com/en-us/windows/change-system-locale#1TC=windows-7\" rel=\"nofollow noreferrer\">windows.microsoft.com/en-us/windows/&hellip;</a> - it helped in my case: <a href=\"https://github.com/commercialhaskell/stack/issues/1448\" rel=\"nofollow noreferrer\">github.com/commercialhaskell/stack/issues/1448</a>"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1465197111, "post_id": 37649093, "comment_id": 62782554, "body": "@user3150422: Always <a href=\"https://stackoverflow.com/posts/37649093/edit\">edit</a> additional information in your original post."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1465198815, "post_id": 37649093, "comment_id": 62783496, "body": "@Zeta I added the comment for readability - obviously my line-breaks are different"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1465202624, "post_id": 37649093, "comment_id": 62785557, "body": "Hm. Seems like bash autocompletion in msys64 is somehow messing things up. You could disable them temporarily and try again."}, {"owner": {"reputation": 67, "user_id": 3150422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2191bc1435b756d5b3f46e9c9e2404ce?s=128&d=identicon&r=PG&f=1", "display_name": "user3150422", "link": "https://stackoverflow.com/users/3150422/user3150422"}, "edited": false, "score": 0, "creation_date": 1465236137, "post_id": 37649093, "comment_id": 62806376, "body": "Carsten: No, I&#39;m using American English Win7."}, {"owner": {"reputation": 67, "user_id": 3150422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2191bc1435b756d5b3f46e9c9e2404ce?s=128&d=identicon&r=PG&f=1", "display_name": "user3150422", "link": "https://stackoverflow.com/users/3150422/user3150422"}, "edited": false, "score": 0, "creation_date": 1465250288, "post_id": 37649093, "comment_id": 62813317, "body": "could it be related to this:It is strongly advised to set your STACK_ROOT environment variable similarly to your root (e.g., set STACK_ROOT=c:\\stack_root) before running stack. -- I don&#39;t know what to set this to ..."}, {"owner": {"reputation": 67, "user_id": 3150422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2191bc1435b756d5b3f46e9c9e2404ce?s=128&d=identicon&r=PG&f=1", "display_name": "user3150422", "link": "https://stackoverflow.com/users/3150422/user3150422"}, "edited": false, "score": 0, "creation_date": 1465268940, "post_id": 37649093, "comment_id": 62817627, "body": "SUCCESS!  I used the Mingw64 shell from MSYS2 and stack init now creates a good stack.yaml"}], "owner": {"reputation": 67, "user_id": 3150422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2191bc1435b756d5b3f46e9c9e2404ce?s=128&d=identicon&r=PG&f=1", "display_name": "user3150422", "link": "https://stackoverflow.com/users/3150422/user3150422"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1465198782, "creation_date": 1465183267, "last_edit_date": 1465198782, "question_id": 37649093, "link": "https://stackoverflow.com/questions/37649093/stack-yaml-not-created-by-stack-new-on-win7", "title": "stack.yaml not created by stack new on Win7", "body": "<p>I ran \"stack new bahugs franklinchen\" on a command prompt window under Win7; stack version is 1.1.2.  It did not create a stack.yaml file, and got error:</p>\n\n<pre><code>C:\\msys64\\usr\\share\\bash-completion\\completions\\sh: streamingProcess: invalid argument (Exec format error)\n</code></pre>\n\n<p>Is this likely due to a bug in template franklinchen, or something more fundamental with stack on Windows?</p>\n\n<p>Am following \"pragmatic Haskell\" video by Alexandr Kurilin.</p>\n\n<hr>\n\n<h3>output</h3>\n\n<pre><code>Downloaded lts-6.1 build plan. \nPopulated index cache. \nUpdating package index Hackage (mirrored at github.com/commercialhas remote:\nCounting objects: 24310, done. \n... Resolving deltas: 100% (6576/6576), completed with 1683 local objects. \nFrom github.com/commercialhaskell/all-cabal-hashes + 7a21e49...42c815c display \n-&gt; origin/display (forced update) - [tag update] current-hackage \n-&gt; current-hackage Fetched package index. \nC:\\msys64\\usr\\share\\bash-completion\\completions\\sh: streamingProcess: invalid argument (Exec format error)\n</code></pre>\n"}, {"tags": ["haskell", "functor"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1465192465, "post_id": 37648366, "comment_id": 62780508, "body": "maybe you&#39;ll find <a href=\"https://oleksandrmanzyuk.wordpress.com/2013/01/18/co-yoneda-lemma/\" rel=\"nofollow noreferrer\">this blogpost</a> helpful"}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1465199113, "post_id": 37648748, "comment_id": 62783663, "body": "Is <code>Coyoneda Pred</code> nearly isomorphic or equivalent in some sense to <code>Const ()</code>? You shouldn&#39;t be able to extract any information from any of them..."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1465213508, "post_id": 37648748, "comment_id": 62791920, "body": "@chi Yeah, I suppose so. You can manufacture a <code>Coyoneda Pred</code> from nothing by picking <code>Void</code> as the existentially quantified <code>b</code> type inside it: <code>Coyoneda absurd absurd :: forall a. Coyoneda Pred a</code>. Then it should be trivial to construct both directions of the isomorphism."}, {"owner": {"reputation": 91, "user_id": 6428267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02d310bb060801b2300bdee6ff64df0d?s=128&d=identicon&r=PG&f=1", "display_name": "sato", "link": "https://stackoverflow.com/users/6428267/sato"}, "edited": false, "score": 0, "creation_date": 1465380913, "post_id": 37648748, "comment_id": 62873685, "body": "@BenjaminHodgson if using the <code>DeriveFunctor</code> together with <code>StandaloneDeriving</code>, a typical datatype seem to be able to become a functor without benefiting from the power of <code>Coyoneda</code>, right?  I know the name of the Freer Monad but not fully understanding yet."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 91, "user_id": 6428267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02d310bb060801b2300bdee6ff64df0d?s=128&d=identicon&r=PG&f=1", "display_name": "sato", "link": "https://stackoverflow.com/users/6428267/sato"}, "edited": false, "score": 0, "creation_date": 1465825321, "post_id": 37648748, "comment_id": 63048829, "body": "@sato Only if the datatype is already a (covariant) <code>Functor</code> to start with. <code>DerivingFunctor</code> only writes the boilerplate code that you would have written yourself."}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 8, "last_activity_date": 1492293252, "last_edit_date": 1492293252, "creation_date": 1465179613, "answer_id": 37648748, "question_id": 37648366, "link": "https://stackoverflow.com/questions/37648366/coyoneda-and-deriving-functor-in-haskell/37648748#37648748", "title": "Coyoneda and Deriving Functor in Haskell", "body": "<p>Good question!</p>\n\n<p><code>Coyoneda</code> and <code>DeriveFunctor</code> do different things. <code>Coyoneda</code> creates a new, separate datatype which happens to be a <code>Functor</code> for any choice of argument. <code>DeriveFunctor</code> simply generates the boilerplate code for types which <em>are</em> functors by themselves. You can only derive a <code>Functor</code> instance for types for which you could write such an instance by hand.</p>\n\n<p>Take <code>newtype Pred a = Pred (a -&gt; Bool)</code> as a (somewhat contrived) example: there is no <code>instance Functor Pred</code> because <code>Pred</code> is contravariant in its <code>a</code> parameter, so<code>DeriveFunctor</code> won't be able to help you. On the other hand <code>Coyoneda Pred</code> is a <code>Functor</code> because <code>Coyoneda f</code> is a <code>Functor</code>, albeit not a very useful one, for any <code>f</code>.</p>\n\n<p>As an aside, the <a href=\"http://okmij.org/ftp/Haskell/extensible/more.pdf\" rel=\"nofollow noreferrer\">Freer monad</a> arises as an application of <code>Free</code> to <code>Coyoneda</code>.</p>\n"}], "owner": {"reputation": 91, "user_id": 6428267, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02d310bb060801b2300bdee6ff64df0d?s=128&d=identicon&r=PG&f=1", "display_name": "sato", "link": "https://stackoverflow.com/users/6428267/sato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 379, "favorite_count": 3, "answer_count": 1, "score": 6, "last_activity_date": 1492293252, "creation_date": 1465175722, "last_edit_date": 1465224166, "question_id": 37648366, "link": "https://stackoverflow.com/questions/37648366/coyoneda-and-deriving-functor-in-haskell", "title": "Coyoneda and Deriving Functor in Haskell", "body": "<p>After studying the category theory based on MacLane, Awodey and Spivak books, I'm trying to understand free/operational monad in Haskell.</p>\n\n<p>We can get a monad from just a data type by using <code>Control.Monad.Free</code> after transforming it to a functor with <code>Data.Functor.Coyoneda</code>, which is based on the mathematical background called Yoneda lemma.</p>\n\n<p>But I'm not fully understanding the functor can be automatically generated by the deriving functor extension in GHC instead of relying on Yoneda lemma.</p>\n\n<p>Is there any restriction to use the deriving functor in GHC compared to <code>Data.Functor.Coyoneda</code>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 2, "creation_date": 1465174325, "post_id": 37648203, "comment_id": 62776603, "body": "I can&#39;t tell what you&#39;re asking. What is the input and the desired output of the function you&#39;re trying to write?"}, {"owner": {"reputation": 319, "user_id": 4989750, "user_type": "registered", "accept_rate": 48, "profile_image": "https://graph.facebook.com/10155683297590191/picture?type=large", "display_name": "BarneyL. BarStin", "link": "https://stackoverflow.com/users/4989750/barneyl-barstin"}, "reply_to_user": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "edited": false, "score": 0, "creation_date": 1465175047, "post_id": 37648203, "comment_id": 62776759, "body": "@ChrisMartin thank you so much for comment, the question was edited with my input and output"}, {"owner": {"reputation": 6500, "user_id": 57879, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/419a88bdf20aeaa3fb2de53ca0f4d836?s=128&d=identicon&r=PG", "display_name": "yatima2975", "link": "https://stackoverflow.com/users/57879/yatima2975"}, "edited": false, "score": 0, "creation_date": 1465293243, "post_id": 37648203, "comment_id": 62829260, "body": "Should it also work with in put like &quot;blah with developmental venous anomaly (DVA) blah blah&quot;, or with multiple (or zero) acronyms in a sentence?"}], "answers": [{"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": true, "score": 2, "last_activity_date": 1465176085, "creation_date": 1465176085, "answer_id": 37648398, "question_id": 37648203, "link": "https://stackoverflow.com/questions/37648203/how-i-can-get-a-substring-from-a-string-with-haskell/37648398#37648398", "title": "How I can get a Substring from a String with haskell?", "body": "<p>something like this?</p>\n\n<pre><code>desc a = reverse $ take ((length h)-2) xs           \n    where (h:xs) = reverse $ words a                   \n\n\n&gt; desc \"blah blah blah with developmental venous anomaly (DVA)\"     \n[\"developmental\",\"venous\",\"anomaly\"]\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 4989750, "user_type": "registered", "accept_rate": 48, "profile_image": "https://graph.facebook.com/10155683297590191/picture?type=large", "display_name": "BarneyL. BarStin", "link": "https://stackoverflow.com/users/4989750/barneyl-barstin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1330, "favorite_count": 0, "accepted_answer_id": 37648398, "answer_count": 1, "score": -1, "last_activity_date": 1465176085, "creation_date": 1465173993, "last_edit_date": 1465174989, "question_id": 37648203, "link": "https://stackoverflow.com/questions/37648203/how-i-can-get-a-substring-from-a-string-with-haskell", "title": "How I can get a Substring from a String with haskell?", "body": "<p>I have the next <strong>text</strong>: </p>\n\n<pre><code>blah blah blah with developmental venous anomaly (DVA)\n</code></pre>\n\n<p>as a <code>[String]</code> <code>[blah,blah,blah,with,developmental,venous,anomaly,(DVA)]</code> </p>\n\n<p>where <strong><code>DVA</code></strong> is a the acronym from <strong><code>Developmental venous anomaly</code></strong> . I  know that the length of this acronym is 3, so the definition start 3 positions befores, and ends where is the acronym, <code>[developmental,venous,anomaly]</code>. I trying to implement a function for this. I know how do it with java, but I'm beginner in haskell and I can't do it.</p>\n\n<p>Should be something like this:</p>\n\n<pre><code>f:: [String]-&gt;String-&gt; [String]\n</code></pre>\n\n<p>where my inputs is <code>[blah,blah,blah,with,developmental,venous,anomaly,(DVA)] and  (DVA)</code> </p>\n\n<p>and my output:  <code>[developmental,venous,anomaly]</code></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "edited": false, "score": 2, "creation_date": 1465170492, "post_id": 37647839, "comment_id": 62775887, "body": "Not the problem, but a much better idea to do <code>(x2:xs)</code> instead of <code>[x2]++xs</code>"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1465171712, "post_id": 37647839, "comment_id": 62776112, "body": "Better even would be <code>ordered f (x:xx@(y:_))</code> and then use <code>xx</code> instead of <code>y:xs</code>, but this is a minor optimization - always keep Knuth in mind: correctness before optimization"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1465177979, "post_id": 37647839, "comment_id": 62777271, "body": "<code>f</code> is not (syntactically) an infix operator, so it should not be in parentheses."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1465286786, "post_id": 37647839, "comment_id": 62825048, "body": "@chepner it doesn&#39;t have to be, but it can."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1465287798, "post_id": 37647839, "comment_id": 62825622, "body": "<code>if a then b else False</code> is the same as <code>a &amp;&amp; b</code>;  your code (when corrected) is then equivalent to <code>foldr (\\ xs r -&gt; case xs of (a:b:_) -&gt; f a b &amp;&amp; r ; _ -&gt; True) True (tails xs)</code>. <code>tails</code> are from <code>Data.List</code>; or <code>(iterate (drop 1) xs)</code> can be used <i>here</i> as well, instead."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1465300112, "post_id": 37647839, "comment_id": 62833967, "body": "@WillNess By &quot;syntactically&quot;, I mean that the string <code>f</code> itself is not an infix operator. Even if <code>f</code> is bound to <code>(*)</code>, the correct syntax is still <code>f x1 x2</code>, not <code>(f) x1 x2</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1465317206, "post_id": 37647839, "comment_id": 62846556, "body": "@chepner apologies for not writing out the full sentence. &quot;it doesn&#39;t have to be in parentheses, but it can be&quot; is what I meant. <code>(f)</code> is the same as <code>f</code> in every respect. <code>(f) x1 x2</code> is working, so can&#39;t be considered incorrect, only superfluous. I think. :)"}], "answers": [{"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 2, "last_activity_date": 1465197779, "last_edit_date": 1465197779, "creation_date": 1465170669, "answer_id": 37647913, "question_id": 37647839, "link": "https://stackoverflow.com/questions/37647839/checking-whether-the-list-is-ordered-according-to-the-function/37647913#37647913", "title": "Checking whether the list is ordered according to the function", "body": "<p>With list comprehensions, it can be</p>\n\n<pre><code>ordered f xs = null [() | (a,b) &lt;- zip xs (drop 1 xs), not (f a b)]\n</code></pre>\n\n<p>This can of course be coded with <code>any</code>, <code>and</code>, etc., if you're familiar with them. With list comprehensions you can just wing it, while you're still learning.</p>\n\n<p>Your code is also good, it just misses some parentheses. It should be </p>\n\n<pre><code>       then ordered f ( [x2]++xs )\n</code></pre>\n\n<p>Incidentally, just saying</p>\n\n<blockquote>\n  <p>doesn't work - what's wrong in this code?</p>\n</blockquote>\n\n<p>is not enough. Surely you've tried to load this code, and have received an error message, talking something about \"type mismatch\", even showing you the expression in question, </p>\n\n<pre>\n    In the expression: <b>ordered f [x2] ++ xs</b>\n    In the expression:\n      <b>if ((f) x1 x2) then ordered f [x2] ++ xs else False</b>\n    In an equation for `ordered':\n        ordered f (x1 : x2 : xs)\n          = if ((f) x1 x2) then ordered f [x2] ++ xs else False\n</pre>\n\n<p>which could have provided a clue. In Haskell, function application (denoted by just juxtaposition, i.e. white space) is of <em>highest</em> precedence, so your code was interpreted as <code>(ordered f [x2]) ++ (xs)</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1465213762, "post_id": 37647931, "comment_id": 62792080, "body": "you can avoid tail using pattern synonyms: <code>xs@(_:xs&#39;)</code> and use <code>zipWith f xs xs&#39;</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1465225699, "post_id": 37647931, "comment_id": 62800272, "body": "@Bakuriu except that it makes it fail on empty lists."}], "tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 6, "last_activity_date": 1465170866, "creation_date": 1465170866, "answer_id": 37647931, "question_id": 37647839, "link": "https://stackoverflow.com/questions/37647839/checking-whether-the-list-is-ordered-according-to-the-function/37647931#37647931", "title": "Checking whether the list is ordered according to the function", "body": "<p>The errors you get are twofold - first error</p>\n\n<blockquote>\n<pre><code>$ &gt; ghci tmp.hs\nGHCi, version 7.10.3: http://www.haskell.org/ghc/  :? for help\n[1 of 1] Compiling Main             ( tmp.hs, interpreted )\n\ntmp.hs:8:14:\n    Couldn't match expected type \u2018[Integer]\u2019 with actual type \u2018Bool\u2019\n    In the first argument of \u2018(++)\u2019, namely \u2018ordered f [x2]\u2019\n    In the expression: ordered f [x2] ++ xs\n\ntmp.hs:8:14:\n    Couldn't match expected type \u2018Bool\u2019 with actual type \u2018[Integer]\u2019\n    In the expression: ordered f [x2] ++ xs\n    In the expression:\n      if ((f) x1 x2) then ordered f [x2] ++ xs else False\n    In an equation for \u2018ordered\u2019:\n        ordered f (x1 : x2 : xs)\n          = if ((f) x1 x2) then ordered f [x2] ++ xs else False\nFailed, modules loaded: none.\n</code></pre>\n</blockquote>\n\n<p>says essentially that you try to apply the <code>(++)</code> operator to two different lists - because <code>ordered f [x2] :: [Bool]</code> and <code>xs :: [Integer]</code></p>\n\n<p>to fix it - you simply need to add braces <code>ordered f ([x2] ++ xs)</code></p>\n\n<p>compiling this you get another error</p>\n\n<blockquote>\n<pre><code>$ &gt;  ghci tmp.hs\nGHCi, version 7.10.3: http://www.haskell.org/ghc/  :? for help\n[1 of 1] Compiling Main             ( tmp.hs, interpreted )\n\ntmp.hs:7:13:\n    Couldn't match expected type \u2018a\u2019 with actual type \u2018Integer\u2019\n      \u2018a\u2019 is a rigid type variable bound by\n          the type signature for\n            ordered :: Ord a =&gt; (a -&gt; a -&gt; Bool) -&gt; [Integer] -&gt; Bool\n          at tmp.hs:3:12\n    Relevant bindings include\n      f :: a -&gt; a -&gt; Bool (bound at tmp.hs:6:9)\n      ordered :: (a -&gt; a -&gt; Bool) -&gt; [Integer] -&gt; Bool\n        (bound at tmp.hs:4:1)\n    In the first argument of \u2018f\u2019, namely \u2018x1\u2019\n    In the expression: ((f) x1 x2)\nFailed, modules loaded: none.\n</code></pre>\n</blockquote>\n\n<p>which says that ghc cannot match any <code>Ord a</code> with the concrete type <code>Integer</code>.</p>\n\n<p>The fix is to change the type signature - to the following</p>\n\n<pre><code>ordered :: Ord a =&gt; (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; Bool\n</code></pre>\n\n<hr>\n\n<p>On a side note - the algorithm can be simplified using the functions</p>\n\n<ul>\n<li><code>and</code></li>\n<li><code>zipWith</code></li>\n<li><code>tail</code></li>\n</ul>\n\n<blockquote class=\"spoiler\">\n  <p> <code>ordered f xs = and $ zipWith f xs (tail xs)</code></p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 2, "last_activity_date": 1465170905, "creation_date": 1465170905, "answer_id": 37647934, "question_id": 37647839, "link": "https://stackoverflow.com/questions/37647839/checking-whether-the-list-is-ordered-according-to-the-function/37647934#37647934", "title": "Checking whether the list is ordered according to the function", "body": "<p>another alternative</p>\n\n<pre><code>ordered f a = and $ zipWith f a (tail a)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1465226725, "post_id": 37648870, "comment_id": 62800963, "body": "isn&#39;t the <code>seq</code> superfluous here, though, and simple <code>const</code> is enough?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1465228119, "post_id": 37648870, "comment_id": 62801862, "body": "@WillNess, it&#39;s definitely on the defensive side. I&#39;ve been bitten in the past when a computation wasn&#39;t strict in the final value of an accumulating parameter. All was well in simple situations but went sideways when the function was used in a sufficiently complicated context."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1465228892, "post_id": 37648870, "comment_id": 62802373, "body": "@WillNess, to clarify: I&#39;m not concerned about allocating a huge thunk; I&#39;m concerned about GHC&#39;s ability to eliminate the <code>Just</code> constructor allocation, and (when the <code>foldr</code> fuses with something) to unbox numeric elements."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1465229009, "post_id": 37648870, "comment_id": 62802447, "body": "thanks. so, would <code>null[()|(a:b:_)&lt;-tails xs, not(f a b)]</code> be better or worse, in that respect? or the hand-written loops (as recursive functions)? If the latter, then maybe the answer should always be &quot;roll your own&quot;? hmm."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 0, "last_activity_date": 1465180932, "creation_date": 1465180932, "answer_id": 37648870, "question_id": 37647839, "link": "https://stackoverflow.com/questions/37647839/checking-whether-the-list-is-ordered-according-to-the-function/37648870#37648870", "title": "Checking whether the list is ordered according to the function", "body": "<p>I'd personally write it like this:</p>\n\n<pre><code>ordered f xs = foldr go (`seq` True) xs Nothing\n  where\n    go x r Nothing = r (Just x)\n    go x r (Just prev) = f prev x &amp;&amp; r (Just x)\n</code></pre>\n\n<p>But some might consider that odd.</p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 1, "last_activity_date": 1465198075, "creation_date": 1465198075, "answer_id": 37651758, "question_id": 37647839, "link": "https://stackoverflow.com/questions/37647839/checking-whether-the-list-is-ordered-according-to-the-function/37651758#37651758", "title": "Checking whether the list is ordered according to the function", "body": "<p>A solution that does not make use of builtin functions (yes it is reinventing the wheel) but provides some insight into how to tackle such problems is the following:</p>\n\n<pre><code>ordered :: (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; Bool\nordered f = ordered'\n    where ordered' (x:xs@(x2:_)) = f x x2 &amp;&amp; ordered' xs\n          ordered' [_] = True\n          ordered' [] = True\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 5705378, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/f0119eb7b9e0e495fd4088956bc60eb8?s=128&d=identicon&r=PG&f=1", "display_name": "foxbuur", "link": "https://stackoverflow.com/users/5705378/foxbuur"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 1, "accepted_answer_id": 37647913, "answer_count": 5, "score": 4, "last_activity_date": 1465198075, "creation_date": 1465169873, "question_id": 37647839, "link": "https://stackoverflow.com/questions/37647839/checking-whether-the-list-is-ordered-according-to-the-function", "title": "Checking whether the list is ordered according to the function", "body": "<p>How can I check whether the list is ordered according to the function?</p>\n\n<pre><code>&gt; ordered (&lt;) [1,2,3,4,5]\nTrue\n&gt; ordered (&lt;) [5,4,3,2,1]\nFalse\n&gt; ordered (&gt;) [5,4,3,2,1]\nTrue\n</code></pre>\n\n<p>I tried to write something like this, but it doesn't work - what's wrong in this code?</p>\n\n<pre><code>ordered :: (Ord a) =&gt; (a -&gt; a -&gt; Bool) -&gt; [Integer] -&gt; Bool\nordered f [] = True\nordered f [a] = True\nordered f (x1:x2:xs) =\n    if ((f) x1 x2)\n        then ordered f [x2]++xs\n        else False\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1465165690, "post_id": 37647341, "comment_id": 62774937, "body": "Can you provide the source where you&#39;ve got these definitions from?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1465166799, "post_id": 37647341, "comment_id": 62775174, "body": "<code>_ &gt;&gt;= x = x</code> is just wrong. <code>&gt;&gt;=</code> has type <code>m a -&gt; (a -&gt; m b) -&gt; m b</code>, so this definition ignores the <code>m a</code> value (which we know is a <code>Just</code>, but it doesn&#39;t matter here), and tries to return the <code>a -&gt; m b</code> value as if it were an <code>m b</code>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1465167149, "post_id": 37647341, "comment_id": 62775255, "body": "Indeed. <i>Where exactly</i> did you find that definition with <code>_ &gt;&gt;= x = x</code>? At least it&#39;s neither in the online version of LYAH nor in my print one. And, well, it shouldn&#39;t be, wrong-wise."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1465167637, "post_id": 37647341, "comment_id": 62775365, "body": "@chepner I don&#39;t think it matters. That line of code is just a dead code and will never be reachable."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1465169221, "post_id": 37647341, "comment_id": 62775654, "body": "@Sibi It still has to type-check, or the compiler will reject it."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1465171731, "post_id": 37647341, "comment_id": 62776118, "body": "@amalloy Ah yes. I didn&#39;t notice that. :)"}], "answers": [{"tags": [], "owner": {"reputation": 5190, "user_id": 353268, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/68f14024956c4a67bd92f44a15505e7c?s=128&d=identicon&r=PG", "display_name": "mariosangiorgio", "link": "https://stackoverflow.com/users/353268/mariosangiorgio"}, "is_accepted": true, "score": 3, "last_activity_date": 1465197868, "last_edit_date": 1465197868, "creation_date": 1465167155, "answer_id": 37647568, "question_id": 37647341, "link": "https://stackoverflow.com/questions/37647341/haskell-creation-of-a-monad/37647568#37647568", "title": "Haskell - creation of a monad", "body": "<p>I'd suggest you to read through <a href=\"http://learnyouahaskell.com/a-fistful-of-monads#the-monad-type-class\" rel=\"nofollow\">this chapter of 'Learn you a Haskell'</a>, it provides some examples that should help you clarify what a monad is.</p>\n\n<p>Going back to your question about <code>x</code>, it is not a function, but it's the value contained in <code>Just</code>. <code>Maybe a</code> is a type with two different constructors: <code>Nothing</code>, which means it's not holding any value, and <code>Just a</code>, which means it's holding a value of type <code>a</code>.</p>\n\n<p>Let's look at the signature of <code>&gt;&gt;=</code>. It is <code>(&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b</code>, which means it takes a monad <code>m a</code>, a function <code>(a -&gt; m b)</code> and returns a monad <code>m b</code>. Note that you have the same monad <code>m</code> but possibly a different value of it's type parameter (from <code>a</code> to <code>b</code>).</p>\n\n<p>For <code>Maybe a</code> we need to handle two cases: when we have a value (<code>Just a</code>) or when we don't have a value (<code>Nothing</code>). <code>&gt;&gt;=</code> for <code>Maybe</code> is implemented such that applies <code>f</code> to the value there is a value, otherwise it simply propagates <code>Nothing</code>. In your example you also have <code>_ &gt;&gt;= x = x</code>, but that's not needed since you already exhaustively matched all the possible patterns.</p>\n"}], "owner": {"reputation": 140, "user_id": 6364239, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10208962845131414/picture?type=large", "display_name": "Joanna", "link": "https://stackoverflow.com/users/6364239/joanna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 1, "accepted_answer_id": 37647568, "answer_count": 1, "score": 0, "last_activity_date": 1465197868, "creation_date": 1465165089, "last_edit_date": 1465168462, "question_id": 37647341, "link": "https://stackoverflow.com/questions/37647341/haskell-creation-of-a-monad", "title": "Haskell - creation of a monad", "body": "<p>I am trying to understand the rules of how to create a monad. As far as I understand, it depends on the data types that I want to use and that a monad has to fulfill three laws:</p>\n\n<pre><code>1. m &gt;&gt;= return = m\n2. return x &gt;&gt;= f = f x\n3. (m &gt;&gt;= f) &gt;&gt;= g = m &gt;&gt;= (\\x-&gt; f x) &gt;&gt;= g\n</code></pre>\n\n<p>Okay. So for a monad <code>Maybe</code> I have the last 2 lines. For what does \"<code>x</code>\" stands in the third line. If should be a function, should it not?</p>\n\n<pre><code>data Maybe a = Nothing | Just a\ninstance Monad Maybe where\n  (Just x) &gt;&gt;= f = f x\n  Nothing &gt;&gt;= _ = Nothing\n  _ &gt;&gt;= x = x  \n\n fail _ = Nothing\n</code></pre>\n\n<p>(I am unable to find now the source of this definition, but I found it somewhere)</p>\n\n<p>I found another version as well - why do I need the line with \"fail\"?</p>\n\n<pre><code>data Maybe a = Nothing | Just a\ninstance Monad Maube where\n  return x = Just x\n\n  Just x &gt;&gt;= f = f x\n  Nothing &gt;&gt;= f = Nothing\n\n  fail _ = Nothing\n</code></pre>\n\n<p>(source: <a href=\"http://learnyouahaskell.com/a-fistful-of-monads\" rel=\"nofollow\">http://learnyouahaskell.com/a-fistful-of-monads</a>)</p>\n"}, {"tags": ["haskell", "template-haskell"], "answers": [{"tags": [], "owner": {"reputation": 1020, "user_id": 500060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c122862374667042520953c02df7d7ed?s=128&d=identicon&r=PG", "display_name": "glguy", "link": "https://stackoverflow.com/users/500060/glguy"}, "is_accepted": true, "score": 2, "last_activity_date": 1465173327, "creation_date": 1465173327, "answer_id": 37648148, "question_id": 37647176, "link": "https://stackoverflow.com/questions/37647176/how-to-replace-zs-in-p-zsz-with-a-name-i-generate-myself/37648148#37648148", "title": "How to replace `zs` in `[p| zs@(z:_) |]` with a name I generate myself?", "body": "<p>You probably can't. Splices only work for patterns, expressions, declarations, and types. This isn't any of those because it's just a name.</p>\n\n<p>Similarly you can't splice names in other places with Template Haskell</p>\n\n<p><code>[d| $(mkName \"f\") x = x |] -- invalid</code></p>\n\n<p>Using <code>asP</code> as you mentioned the closest you get is</p>\n\n<p><code>asP (mkName \"zs\") [p| z:_ |]</code></p>\n"}], "owner": {"reputation": 1835, "user_id": 6292577, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/gqMCP.jpg?s=128&g=1", "display_name": "rityzmon", "link": "https://stackoverflow.com/users/6292577/rityzmon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 37648148, "answer_count": 1, "score": 2, "last_activity_date": 1465173327, "creation_date": 1465163804, "question_id": 37647176, "link": "https://stackoverflow.com/questions/37647176/how-to-replace-zs-in-p-zsz-with-a-name-i-generate-myself", "title": "How to replace `zs` in `[p| zs@(z:_) |]` with a name I generate myself?", "body": "<p>If I run:</p>\n\n<pre><code>&gt; runQ [p| zs@(z:_) |]\nAsP zs_46 (InfixP (VarP z_47) GHC.Types.: WildP)\n</code></pre>\n\n<p>I'd like to replace <code>zs</code> and <code>z</code> with names I generate myself. I can replace <code>z</code>:</p>\n\n<pre><code>&gt; let z = mkName \"z\"\n&gt; runQ [p| zs@($(varP z):_) |]\nAsP zs_48 (InfixP (VarP z) GHC.Types.: WildP)\n</code></pre>\n\n<p>but I cannot figure out how to replace <code>zs</code>. Is there a way to do it inside quotes or do I have to resort to <code>asP</code>, etc ... ?</p>\n"}, {"tags": ["haskell", "time-complexity", "ioref"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 0, "creation_date": 1465153995, "post_id": 37644620, "comment_id": 62771568, "body": "While you&#39;re thinking operationally at this low level you might like to read <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Commentary/Rts/Storage/HeapObjects\" rel=\"nofollow noreferrer\">ghc.haskell.org/trac/ghc/wiki/Commentary/Rts/Storage/&hellip;</a> . And if you&#39;re working with mutable variables keep in mind that an <code>IORef</code> can easily point to a thunk and you should be mindful of this to avoid space leaks with <code>write&#47;modifyIOref</code>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1465155424, "post_id": 37644620, "comment_id": 62772013, "body": "Side question: any specific reason for choosing a continuation-passing function? Wouldn&#39;t <code>lstream :: L.ByteString -&gt; IO S.ByteString</code> be easier to use, which basically corresponds to the <code>sink = id</code> case?"}, {"owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1465163163, "post_id": 37644620, "comment_id": 62774310, "body": "@chi, that style is due to <code>GivesPopper</code> function in the original question that I linked to."}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 7, "last_activity_date": 1465148931, "creation_date": 1465148931, "answer_id": 37644971, "question_id": 37644620, "link": "https://stackoverflow.com/questions/37644620/ioref-handling-of-list/37644971#37644971", "title": "IORef handling of list", "body": "<p>Yes, in GHC it is O(1). The things that are read and written from <code>IORef</code>s are exactly the same pointers that everything else in the implementation uses as data representation. Indeed, you can know <em>just from the type</em> of <code>writeIORef</code> that it does nothing special to its data:</p>\n\n<pre><code>writeIORef :: IORef a -&gt; a -&gt; IO ()\n</code></pre>\n\n<p>Because the <code>a</code> is completely unconstrained, <code>writeIORef</code> <em>cannot</em> inspect the data and in particular cannot traverse any list you hand it. (This is not quite convincing -- the runtime can do anything it likes even with unconstrained types, and you might believe that <code>writeIORef</code> is a runtime primitive -- but it turns out to be true in this case anyway.)</p>\n"}], "owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 37644971, "answer_count": 1, "score": 1, "last_activity_date": 1526820445, "creation_date": 1465146682, "last_edit_date": 1526820445, "question_id": 37644620, "link": "https://stackoverflow.com/questions/37644620/ioref-handling-of-list", "title": "IORef handling of list", "body": "<p>This is a follow-up to a <a href=\"https://stackoverflow.com/questions/37624793/constructing-requestbodystream-from-lazy-bytestring-when-length-is-known\">question</a> I asked earlier. I am wondering if the way list is updated in <code>IORef</code> below in the accepted solution is <code>O(1)</code> or not, in every call of <code>fetch</code>. I suspect it is because <code>IORef</code> is likely just keeping a pointer to head of the list (instead of traversing and copying entire list which will be O(n) every time. Just changing the pointer to new head should be O(1), and should prevent eager evaluation of entire list). But, <code>ghc-core</code> won't show that low-level code. So, asking here:</p>\n\n<pre><code>mklstream :: L.ByteString -&gt; (IO S.ByteString -&gt; IO r) -&gt; IO r\nmklstream lbs sink = do\n  ref &lt;- newIORef (L.toChunks lbs)\n  let fetch :: IO S.ByteString\n      fetch = do chunks &lt;- readIORef ref\n                 case chunks of\n                   [] -&gt; return S.empty\n                   (c:cs) -&gt; do writeIORef ref cs\n                                return c\n  sink fetch\n</code></pre>\n"}, {"tags": ["haskell", "prelude.ls"], "answers": [{"comments": [{"owner": {"reputation": 663, "user_id": 2930101, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/UYXdd.png?s=128&g=1", "display_name": "OneEyeQuestion", "link": "https://stackoverflow.com/users/2930101/oneeyequestion"}, "edited": false, "score": 0, "creation_date": 1465146992, "post_id": 37644623, "comment_id": 62769113, "body": "Is it possible to make the strings literals infer the type <code>LText</code>? Do I have to remove the Overloaded strings extension?"}, {"owner": {"reputation": 663, "user_id": 2930101, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/UYXdd.png?s=128&g=1", "display_name": "OneEyeQuestion", "link": "https://stackoverflow.com/users/2930101/oneeyequestion"}, "edited": false, "score": 0, "creation_date": 1465148424, "post_id": 37644623, "comment_id": 62769573, "body": "If you mean <code>toS ((&quot;(&quot; :: LText) ++ show x ++ (&quot;, &quot; :: LText) ++ show y ++ (&quot;)&quot; :: LText))</code>, then the compiler is still thinking that &quot;...&quot; has type [a]."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 663, "user_id": 2930101, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/UYXdd.png?s=128&g=1", "display_name": "OneEyeQuestion", "link": "https://stackoverflow.com/users/2930101/oneeyequestion"}, "edited": false, "score": 1, "creation_date": 1465149564, "post_id": 37644623, "comment_id": 62769979, "body": "@OneEyeQuestion Uhm.. please post the full error. Only one annotation should be enough (the others are then inferred). Which is the type of the <code>show</code> you are using, by the way?"}, {"owner": {"reputation": 663, "user_id": 2930101, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/UYXdd.png?s=128&g=1", "display_name": "OneEyeQuestion", "link": "https://stackoverflow.com/users/2930101/oneeyequestion"}, "edited": false, "score": 1, "creation_date": 1465149817, "post_id": 37644623, "comment_id": 62770068, "body": "I solved it. Was my fault. Thought (++) was also available with <code>Text</code>."}, {"owner": {"reputation": 663, "user_id": 2930101, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/UYXdd.png?s=128&g=1", "display_name": "OneEyeQuestion", "link": "https://stackoverflow.com/users/2930101/oneeyequestion"}, "edited": false, "score": 0, "creation_date": 1465160463, "post_id": 37644623, "comment_id": 62773559, "body": "Tried this: <code>toS (&quot;My Sample Text&quot; :: LText)</code> but I get this error: No instance for (StringConv a0 LText) arising from a use of <code>toS&#39;     The type variable </code>a0&#39; is ambiguous     Note: there are several potential instances:      ...    In the expression: toS &quot;My Sample Text&quot;"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1465146693, "creation_date": 1465146693, "answer_id": 37644623, "question_id": 37644406, "link": "https://stackoverflow.com/questions/37644406/how-to-show-strings-in-custom-prelude-library-protolude/37644623#37644623", "title": "How to show strings in custom Prelude library Protolude", "body": "<p>It could be caused by the following:</p>\n\n<ul>\n<li><code>show</code> can produce any string-like type</li>\n<li>string literals are overloaded, so they are of any string-like type</li>\n<li><code>toS</code> can accept many different types</li>\n</ul>\n\n<p>If so, the compiler does not know which intermediate string-like type to pick, and an ambiguity error is thrown.</p>\n"}, {"comments": [{"owner": {"reputation": 663, "user_id": 2930101, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/UYXdd.png?s=128&g=1", "display_name": "OneEyeQuestion", "link": "https://stackoverflow.com/users/2930101/oneeyequestion"}, "edited": false, "score": 0, "creation_date": 1465147495, "post_id": 37644701, "comment_id": 62769280, "body": "But wouldn&#39;t that defeat the purpose of hiding Show? Or I am just misinterpreting the use of Protolude library? That would be returning a <code>String</code>, if I am not mistaken, so it would reintroduce the hidden type that the library wanted to avoid."}, {"owner": {"reputation": 663, "user_id": 2930101, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/UYXdd.png?s=128&g=1", "display_name": "OneEyeQuestion", "link": "https://stackoverflow.com/users/2930101/oneeyequestion"}, "edited": false, "score": 0, "creation_date": 1465149225, "post_id": 37644701, "comment_id": 62769859, "body": "So the return type of <code>show</code> is inferred to <code>LText</code>? How does <code>show</code> interact with the SPECIALIZE pragmas?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 663, "user_id": 2930101, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/UYXdd.png?s=128&g=1", "display_name": "OneEyeQuestion", "link": "https://stackoverflow.com/users/2930101/oneeyequestion"}, "edited": false, "score": 1, "creation_date": 1465155493, "post_id": 37644701, "comment_id": 62772044, "body": "The return type of <code>PBase.show</code> is always <code>String</code>. The return type of protolude&#39;s show can be Text or LText or String or any other type <code>b</code> for which <code>StringConv String b</code> holds. SPECIALIZE just tells GHC to create monomorphic implementations of the function for certain types. This can make those routines run faster - otherwise the polymorphic code is executed."}, {"owner": {"reputation": 663, "user_id": 2930101, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/UYXdd.png?s=128&g=1", "display_name": "OneEyeQuestion", "link": "https://stackoverflow.com/users/2930101/oneeyequestion"}, "edited": false, "score": 0, "creation_date": 1465159842, "post_id": 37644701, "comment_id": 62773375, "body": "Do you have to do anything special to import <code>import qualified Base as PBase</code> ? It says it is a hidden module in the package protolude."}, {"owner": {"reputation": 663, "user_id": 2930101, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/UYXdd.png?s=128&g=1", "display_name": "OneEyeQuestion", "link": "https://stackoverflow.com/users/2930101/oneeyequestion"}, "edited": false, "score": 0, "creation_date": 1465165056, "post_id": 37644701, "comment_id": 62774778, "body": "Your solution would resolve to <code>String</code>, right? Is it possible to force <code>show</code> function from <code>Show Instance</code> to always resolve to LText, or Bytestring without passing through <code>String</code> ?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 663, "user_id": 2930101, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/UYXdd.png?s=128&g=1", "display_name": "OneEyeQuestion", "link": "https://stackoverflow.com/users/2930101/oneeyequestion"}, "edited": false, "score": 1, "creation_date": 1465165733, "post_id": 37644701, "comment_id": 62774950, "body": "The PBase.show typeclass function <i>always</i> returns a String. But when you call Protolude&#39;s  <code>show</code> you can specify what the return type should be. The definition of Protolude&#39;s <code>show</code> is fixed - you cannot change the way it works. It always will call the value&#39;s Pbase <code>show</code> function and convert the String to whatever result type is requested."}, {"owner": {"reputation": 663, "user_id": 2930101, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/UYXdd.png?s=128&g=1", "display_name": "OneEyeQuestion", "link": "https://stackoverflow.com/users/2930101/oneeyequestion"}, "edited": false, "score": 0, "creation_date": 1465166661, "post_id": 37644701, "comment_id": 62775143, "body": "Just curious, do you think that is a performance efficient implementation? that is one of the expectations I had behind using Protolude and its removal of String."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 2, "last_activity_date": 1465163933, "last_edit_date": 1465163933, "creation_date": 1465147316, "answer_id": 37644701, "question_id": 37644406, "link": "https://stackoverflow.com/questions/37644406/how-to-show-strings-in-custom-prelude-library-protolude/37644701#37644701", "title": "How to show strings in custom Prelude library Protolude", "body": "<p>This is what worked for me:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\nmodule Test where\n\nimport Protolude\nimport qualified Base as PBase\n\ndata P = P Int\n\ninstance PBase.Show P where\n  show (P x) = \"a P \" ++ show x\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>The protolude implemention of <code>show</code> is as a normal function (see the end of Protolude.hs):</p>\n\n<pre><code>show :: (Show a, StringConv String b) =&gt; a -&gt; b\nshow x = toS (PBase.show x)\n</code></pre>\n\n<p>So you need a <code>PBase.Show</code> instance in order use protolude's show function.</p>\n\n<p>Also protolude's <code>show</code> can return any of the string types, so you're not forcing others to use of String by defining a PBase.show instance.</p>\n\n<p><strong>Update #2</strong></p>\n\n<p>You can import the typeclass <code>show</code> function from <code>GHC.Show</code>:</p>\n\n<pre><code>{-# LANGUAGE NoImplicitPrelude #-}\n\nimport Protolude\nimport GHC.Show\n\ndata P  = P Int\n\ninstance Show P where\n  show (P x) = \"&lt;-- P \" ++ GHC.Show.show x ++ \" --&gt;\"\n\nmain = print (P 123)\n</code></pre>\n"}], "owner": {"reputation": 663, "user_id": 2930101, "user_type": "registered", "accept_rate": 52, "profile_image": "https://i.stack.imgur.com/UYXdd.png?s=128&g=1", "display_name": "OneEyeQuestion", "link": "https://stackoverflow.com/users/2930101/oneeyequestion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 558, "favorite_count": 0, "accepted_answer_id": 37644701, "answer_count": 2, "score": 1, "last_activity_date": 1465163933, "creation_date": 1465145354, "last_edit_date": 1465162452, "question_id": 37644406, "link": "https://stackoverflow.com/questions/37644406/how-to-show-strings-in-custom-prelude-library-protolude", "title": "How to show strings in custom Prelude library Protolude", "body": "<p>I read <a href=\"http://www.stephendiehl.com/posts/protolude.html\" rel=\"nofollow\">this</a> blog post on how to create a custom Prelude library. The library can be found <a href=\"https://github.com/sdiehl/protolude\" rel=\"nofollow\">here</a>. One of the things it does is prohibit <code>String</code>. It also defines a function for automatic string conversions (<a href=\"https://github.com/sdiehl/protolude/blob/master/src/Conv.hs\" rel=\"nofollow\">here</a>). I have enabled <code>OverloadedStrings</code> in the cabal file.</p>\n\n<p>Before using this library I had:</p>\n\n<pre><code>data Point = Point Int Int\ninstance Show Point where\n  show (Point x y) = \"(\" ++ show x ++ \", \" ++ show y ++ \")\"\n</code></pre>\n\n<p>After using the library it says: \"<code>show' is not a (visible) method of class</code>Show'\"</p>\n\n<p>So I resorted to create a custom function to show the data type:</p>\n\n<pre><code>showPoint :: Point -&gt; LText\nshowPoint (Point x y) = toS (\"(\" ++ show x ++ \", \" ++ show y ++ \")\")\n</code></pre>\n\n<p>The compiler is saying that the use of <code>toS, \"(\", show</code> is ambiguous, but I don't understand why. Do I have to do something like what is proposed <a href=\"https://stackoverflow.com/questions/11552764/restricting-string-literals-to-text-only\">here</a>?</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>Had to disable OverloadedStrings and change the code to the following:</p>\n\n<pre><code>showPoint :: Point -&gt; LText\nshowPoint (Point x y) = toS \"(\" &lt;&gt; show x &lt;&gt; toS \", \" &lt;&gt; show y &lt;&gt; toS \")\"\n</code></pre>\n\n<p>Wondering if it is possible to do the same without disabling OverloadedStrings so I don't have to use <code>toS</code> for every <code>String</code>.</p>\n"}, {"tags": ["haskell", "recursion", "binary-tree", "tail-recursion"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1465145701, "post_id": 37644382, "comment_id": 62768652, "body": "so what have you tried (show the code) - I somewhat wonder why you should but in this case a natural approach seems to be using continuations"}, {"owner": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 1, "creation_date": 1465147400, "post_id": 37644382, "comment_id": 62769253, "body": "do you think that the purpose of homework is to go find help on the internet?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 1, "creation_date": 1465148322, "post_id": 37644382, "comment_id": 62769539, "body": "@d8d0d65b3f7cf42: I think since the OP showed his/her attempt and simply has questions about a specific topic - in this case <i>tail recursion</i>, that it is acceptable question."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1465148474, "post_id": 37644382, "comment_id": 62769589, "body": "@GabbaGandalf: are tail-recursive helper functions allowed?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 0, "creation_date": 1465148844, "post_id": 37644382, "comment_id": 62769726, "body": "@d8d0d65b3f7cf42 homework is no problem on SO - it should just show a bit of own effort but just because the question itself will be really bad otherwise"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 1, "creation_date": 1465148875, "post_id": 37644382, "comment_id": 62769740, "body": "Related SO thread: <a href=\"http://stackoverflow.com/questions/14805700/how-to-do-tail-recursion-for-a-binary-tree\" title=\"how to do tail recursion for a binary tree\">stackoverflow.com/questions/14805700/&hellip;</a>"}, {"owner": {"reputation": 119, "user_id": 5655543, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FjwbY.gif?s=128&g=1", "display_name": "GabbaGandalf", "link": "https://stackoverflow.com/users/5655543/gabbagandalf"}, "reply_to_user": {"reputation": 2501, "user_id": 2868481, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/d32920192c6bebcffb83fffd557b9553?s=128&d=identicon&r=PG&f=1", "display_name": "d8d0d65b3f7cf42", "link": "https://stackoverflow.com/users/2868481/d8d0d65b3f7cf42"}, "edited": false, "score": 0, "creation_date": 1465214530, "post_id": 37644382, "comment_id": 62792584, "body": "thanks for your help everyone. We managed to solve it with a bit of help by our tutor. @d8d0d65b3f7cf42 No, i think the purpose of homework is to help me teaching myself, but in this case i got stuck."}, {"owner": {"reputation": 119, "user_id": 5655543, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FjwbY.gif?s=128&g=1", "display_name": "GabbaGandalf", "link": "https://stackoverflow.com/users/5655543/gabbagandalf"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1465214674, "post_id": 37644382, "comment_id": 62792668, "body": "@WillemVanOnsem no, since we are working just with ghci, we are not allowed to get any help by the compiler or other functions.."}], "answers": [{"tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": true, "score": 4, "last_activity_date": 1465150907, "creation_date": 1465150907, "answer_id": 37645292, "question_id": 37644382, "link": "https://stackoverflow.com/questions/37644382/splitting-a-bintree-with-tail-recursion-in-haskell/37645292#37645292", "title": "Splitting a BinTree with tail recursion in Haskell", "body": "<p>Since nodes do not have a parent link, one approach would be to maintain root-to-leaf path within a list. At the end the modified tree can be constructed using a left fold:</p>\n\n<pre><code>slm :: BinTree a -&gt; Maybe (a, BinTree a)\nslm = run []\n    where\n    run _ Empty = Nothing\n    run t (Node Empty x r) = Just (x, foldl go r t)\n        where go l (Node _ x r) = Node l x r\n\n    run t n@(Node l _ _) = run (n:t) l\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 119, "user_id": 5655543, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FjwbY.gif?s=128&g=1", "display_name": "GabbaGandalf", "link": "https://stackoverflow.com/users/5655543/gabbagandalf"}, "edited": false, "score": 0, "creation_date": 1465215787, "post_id": 37647044, "comment_id": 62793425, "body": "very interesting solution. Now ill try to understand it.. ^^ Thanks for the help!"}], "tags": [], "owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "is_accepted": false, "score": 2, "last_activity_date": 1465215598, "last_edit_date": 1465215598, "creation_date": 1465162749, "answer_id": 37647044, "question_id": 37644382, "link": "https://stackoverflow.com/questions/37644382/splitting-a-bintree-with-tail-recursion-in-haskell/37647044#37647044", "title": "Splitting a BinTree with tail recursion in Haskell", "body": "<p>Here, not to spoil anything, are some \"tail recursive\" definitions of functions for summing along the left and right branches, at least as I understand \"tail recursion\":</p>\n\n<pre><code>sumLeftBranch tree = loop 0 tree where\n  loop n Empty        = n\n  loop n (Node l a r) = loop (n+a) l\n\nsumRightBranch tree = loop 0 tree where\n  loop n Empty        = n\n  loop n (Node l a r) = loop (n+a) r\n</code></pre>\n\n<p>You can see that all the recursive uses of loop will have the same answer as the first call <code>loop 0 tree</code> - the arguments just keep getting put into better and better shape, til they are in the ideal shape, <code>loop n Empty</code>, which is <code>n</code>, the desired sum.</p>\n\n<p>If this is the kind of thing that is wanted, the setup for <code>splitleftmost</code> would be </p>\n\n<pre><code>splitLeftMost tree = loop Nothing tree \n  where\n  loop m              Empty        = m\n  loop Nothing        (Node l a r) = loop ? ? \n  loop (Just (a',r')) (Node l a r) = loop ? ?\n</code></pre>\n\n<p>Here, the first use of <code>loop</code> is in the form of <code>loop Nothing tree</code>, but that's the same as <code>loop result Empty</code> - when we come to it, namely <code>result</code>. It took me a couple of tries to get the missing arguments to <code>loop ? ?</code> right, but, as usual, they were obvious once I got them.</p>\n"}, {"comments": [{"owner": {"reputation": 119, "user_id": 5655543, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FjwbY.gif?s=128&g=1", "display_name": "GabbaGandalf", "link": "https://stackoverflow.com/users/5655543/gabbagandalf"}, "edited": false, "score": 1, "creation_date": 1465215376, "post_id": 37647671, "comment_id": 62793123, "body": "Sadly we are only working with ghci, writing everything in .lhs files. So i guess thats why we were asked to do something like this.But for some reason ghci tells me it cant parse the pattern in line 5. : <code>(# hd, ...</code> ."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 119, "user_id": 5655543, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FjwbY.gif?s=128&g=1", "display_name": "GabbaGandalf", "link": "https://stackoverflow.com/users/5655543/gabbagandalf"}, "edited": false, "score": 0, "creation_date": 1465266196, "post_id": 37647671, "comment_id": 62817039, "body": "@GabbaGandalf, this sounds more like an exercise to teach a corrupt"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1465168063, "creation_date": 1465168063, "answer_id": 37647671, "question_id": 37644382, "link": "https://stackoverflow.com/questions/37644382/splitting-a-bintree-with-tail-recursion-in-haskell/37647671#37647671", "title": "Splitting a BinTree with tail recursion in Haskell", "body": "<p>As others have hinted, there is no reason, in Haskell, to make this function tail-recursive. In fact, a tail-recursive solution will almost certainly be slower than the one you have devised! The main <em>potential</em> inefficiencies in the code you've provided involve allocation of pair and <code>Just</code> constructors. I believe GHC (with optimization enabled) will be able to figure out how to avoid these. My guess is that its ultimate code will probably look something like this:</p>\n\n<pre><code>splitleftmost :: BinTree a -&gt; Maybe (a, BinTree a)\nsplitleftmost Empty = Nothing\nsplitleftmost (Node l a r) =\n  case slm l a r of\n    (# hd, tl #) -&gt; Just (hd, tl)\n\nslm :: BinTree a -&gt; a -&gt; BinTree a\n    -&gt; (# a, BinTree a #)\nslm Empty a r = (# a, r #)\nslm (Node ll la lr) a r =\n  case slm ll la lr of\n    (# hd, tl' #) -&gt; (# hd, Node tl' a r #)\n</code></pre>\n\n<p>Those funny-looking <code>(# ..., ... #)</code> things are <em>unboxed pairs</em>, which are handled pretty much like multiple return values. In particular, no actual tuple constructor is allocated until the end. By recognizing that every invocation of <code>splitleftmost</code> with a non-empty tree will produce a <code>Just</code> result, we (and thus almost certainly GHC) can separate the empty case from the rest to avoid allocating intermediate <code>Just</code> constructors. So this final code only allocates stack frames to handle the recursive results. Since <em>some</em> representation of such a stack is inherently necessary to solve this problem, using GHC's built-in one seems pretty likely to give the best results.</p>\n"}], "owner": {"reputation": 119, "user_id": 5655543, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/FjwbY.gif?s=128&g=1", "display_name": "GabbaGandalf", "link": "https://stackoverflow.com/users/5655543/gabbagandalf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 340, "favorite_count": 0, "accepted_answer_id": 37645292, "answer_count": 3, "score": 4, "last_activity_date": 1465215598, "creation_date": 1465145245, "last_edit_date": 1465148417, "question_id": 37644382, "link": "https://stackoverflow.com/questions/37644382/splitting-a-bintree-with-tail-recursion-in-haskell", "title": "Splitting a BinTree with tail recursion in Haskell", "body": "<p>So this week we learned about union types, tail recursion and binary trees in Haskell. We defined our tree data type like so:</p>\n\n<pre><code>data BinTree a = Empty\n           | Node (BinTree a) a (BinTree a)\n           deriving (Eq, Show)\n\nleaf :: a -&gt; BinTree a\nleaf x = Node Empty x Empty\n</code></pre>\n\n<p>Now we were asked to write a function to find the most left node, return it, cut it out and also return the remaining tree without the node we just cut.</p>\n\n<p>We did something like this, which worked quite well:</p>\n\n<pre><code>splitleftmost :: BinTree a -&gt; Maybe (a, BinTree a)\nsplitleftmost Empty = Nothing\nsplitleftmost (Node l a r) = case splitleftmost l of\n                                 Nothing -&gt; Just (a, r)\n                                 Just (a',l') -&gt; Just (a', Node l' a r)\n</code></pre>\n\n<p>Now I need to make this function tail recursive. I think I understood what tail recursion is about, but found it hard to apply it to this problem. I was told to write a function which calls the main function with the fitting arguments, but was still not able to solve this.</p>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 3, "creation_date": 1465146532, "post_id": 37644359, "comment_id": 62768956, "body": "This is possible if your text editor writes to a temp file, then renames it over <code>somefile.txt</code>. In that case all existing handles would still refer to the (now nameless) old file."}, {"owner": {"reputation": 35, "user_id": 1408152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8e355709b15a8b21cf5eecc21b395f1?s=128&d=identicon&r=PG", "display_name": "CeilingHoles", "link": "https://stackoverflow.com/users/1408152/ceilingholes"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1465151184, "post_id": 37644359, "comment_id": 62770556, "body": "Good point, I modified the question with a more specific scenario"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1465160500, "post_id": 37644359, "comment_id": 62773567, "body": "How are you using <code>cat</code>? <code>cat</code> only writes to standard output, so it won&#39;t change the file unless you redirect stdout from <code>cat</code> to the file."}, {"owner": {"reputation": 35, "user_id": 1408152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8e355709b15a8b21cf5eecc21b395f1?s=128&d=identicon&r=PG", "display_name": "CeilingHoles", "link": "https://stackoverflow.com/users/1408152/ceilingholes"}, "edited": false, "score": 0, "creation_date": 1465177908, "post_id": 37644359, "comment_id": 62777266, "body": "Yes, cat was redirected to the file: cat &gt; somefile.txt"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1465185027, "post_id": 37644359, "comment_id": 62778507, "body": "Did you try <code>hGetChar</code> one more time? <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/System-IO.html#t:BufferMode\" rel=\"nofollow noreferrer\">This</a> says &quot;The hLookAhead operation implies that even a no-buffered handle may require a one-character buffer.&quot; If it is still behaving that way, I suspect there is buffering happening at the OS level and you might need to read the entire old file in before you can read the new data. I don&#39;t know much about that though, so hopefully someone more informed about that can answer."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1465468188, "post_id": 37644359, "comment_id": 62918215, "body": "@DavidYoung Trying on my computer it seems like the old contents are still returned, and after those the new contents are shown. If you <code>hSeek</code> at the beginning of the file you see the new contents."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1465468313, "post_id": 37644359, "comment_id": 62918301, "body": "Okay: trick to obtain the new contents: <code>pos &lt;- hTell h; hSeek h pos</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1375, "user_id": 420038, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14e486867defc84340f1837639ca54ee?s=128&d=identicon&r=PG", "display_name": "thomie", "link": "https://stackoverflow.com/users/420038/thomie"}, "is_accepted": true, "score": 1, "last_activity_date": 1466035746, "last_edit_date": 1466035746, "creation_date": 1465914094, "answer_id": 37814730, "question_id": 37644359, "link": "https://stackoverflow.com/questions/37644359/why-does-haskell-nobuffering-option-still-seem-to-buffer/37814730#37814730", "title": "Why does Haskell NoBuffering option still seem to buffer?", "body": "<p><code>BufferMode</code> is only relevant when writing to a handle, not when reading from it.</p>\n\n<p>From <code>[note Buffered Reading]</code> in <a href=\"http://git.haskell.org/ghc.git/blob/ghc-8.0.1-release:/libraries/base/GHC/IO/Handle/Types.hs#l257\" rel=\"nofollow\">GHC.IO.Handle.Types</a>:</p>\n\n<pre><code>Note that the buffering mode (haBufferMode) makes no difference when\nreading data into a Handle.  When reading, we can always just read all\nthe data there is available without blocking, decode it into the Char\nbuffer, and then provide it immediately to the caller.\n</code></pre>\n\n<p>The documentation for input <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/System-IO.html#t:BufferMode\" rel=\"nofollow\">BufferMode</a> seems to be outdated.</p>\n"}], "owner": {"reputation": 35, "user_id": 1408152, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8e355709b15a8b21cf5eecc21b395f1?s=128&d=identicon&r=PG", "display_name": "CeilingHoles", "link": "https://stackoverflow.com/users/1408152/ceilingholes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 37814730, "answer_count": 1, "score": 2, "last_activity_date": 1466035746, "creation_date": 1465145064, "last_edit_date": 1465177814, "question_id": 37644359, "link": "https://stackoverflow.com/questions/37644359/why-does-haskell-nobuffering-option-still-seem-to-buffer", "title": "Why does Haskell NoBuffering option still seem to buffer?", "body": "<p>I loaded up a file in ghci with the following:</p>\n\n<pre><code>h &lt;- openFile \"somefile.txt\" ReadMode\nhSetBuffering h NoBuffering\n</code></pre>\n\n<p>I then modified and saved somefile.txt in a text editor. When I call hGetChar several times in ghci, I receive the old characters of the file (as if the entire file was buffered when I opened it). I expected to calls of hGetChar to return the modified contents. Why is this not the case?</p>\n\n<p><strong>Edit:</strong>\nThe reason why it isn't showing the modified contents in the case decribed above is indeed because of the text editor. When the cat command is used instead (<em>cat > somefile.txt</em>), then the modified file contents is returned.</p>\n\n<p>However, it does still seem to doing buffering. Say the file contents is as follows:</p>\n\n<pre><code>ABCDEFGHI\n123456789\n</code></pre>\n\n<p>If I run hGetChar I get the 'A' as expected.</p>\n\n<p>Now if I use cat (<em>cat > somefile.txt</em>) to change the contents to the following, and run hGetChar again, I would expect 'Z' but it's returning 'B':</p>\n\n<pre><code>AZZZZZZZZ\n</code></pre>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 791, "user_id": 1587319, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1c8a88b9a8d79a518cba52a7a8d099f9?s=128&d=identicon&r=PG", "display_name": "pdexter", "link": "https://stackoverflow.com/users/1587319/pdexter"}, "edited": false, "score": 4, "creation_date": 1465142388, "post_id": 37643861, "comment_id": 62767564, "body": "You&#39;re running into the monomorphism restriction, if you put {-# LANGUAGE NoMonomorphismRestriction #-} at the top of your file it will work. See <a href=\"https://wiki.haskell.org/Monomorphism_restriction\" rel=\"nofollow noreferrer\">here</a>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1465142997, "post_id": 37643861, "comment_id": 62767754, "body": "GHCi runs with <code>-XNoMonomorphismRestriction</code> by default, GHC does not. Another way to get rid of the error is to ditch the pointfree style. <code>getLast xs = foldr1 (flip const) xs</code> works too. You can reproduce the same general error by declaring e.g. <code>foo = show</code>, while <code>foo x = show x</code> is OK."}, {"owner": {"reputation": 514, "user_id": 1375259, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yuWQ9.jpg?s=128&g=1", "display_name": "Chakravarthy Raghunandan", "link": "https://stackoverflow.com/users/1375259/chakravarthy-raghunandan"}, "edited": false, "score": 0, "creation_date": 1465143226, "post_id": 37643861, "comment_id": 62767846, "body": "oops sorry, forgot to include the error : Ambiguous type variable \u2018t0\u2019 arising from a use of \u2018foldr1\u2019   And thanks for your answers n.m and pdexter :)  But, how does ditching pointer free style make the code suddenly work? Is this also because of the monomorphism restriction ?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1465143620, "post_id": 37643861, "comment_id": 62767952, "body": "@ChakravarthyRaghunandan Yes. The MR does not apply to function bindings (i.e. non-pointfree), or to bindings with an explicit type annotations. The rationale is quite involved, leading to surprising results sometimes. Adding type annotations is good style, anyway, so in real-world code the MR is not such a big deal."}, {"owner": {"reputation": 514, "user_id": 1375259, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yuWQ9.jpg?s=128&g=1", "display_name": "Chakravarthy Raghunandan", "link": "https://stackoverflow.com/users/1375259/chakravarthy-raghunandan"}, "edited": false, "score": 0, "creation_date": 1465144575, "post_id": 37643861, "comment_id": 62768269, "body": "I understand the issue now, thanks everyone for the replies.  Cheers"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1465149497, "post_id": 37643861, "comment_id": 62769956, "body": "See especially the section on extended defaulting in the marked duplicate."}], "owner": {"reputation": 514, "user_id": 1375259, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/yuWQ9.jpg?s=128&g=1", "display_name": "Chakravarthy Raghunandan", "link": "https://stackoverflow.com/users/1375259/chakravarthy-raghunandan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 38, "favorite_count": 0, "closed_date": 1465149476, "answer_count": 0, "score": 1, "last_activity_date": 1465142211, "creation_date": 1465142128, "last_edit_date": 1465142211, "question_id": 37643861, "link": "https://stackoverflow.com/questions/37643861/differences-between-writing-haskell-code-directly-in-ghci-vs-hs-file", "closed_reason": "Duplicate", "title": "differences between writing haskell code directly in GHCi vs .hs file", "body": "<p>I just began learning haskell a few days ago and I started with the first problem in \"99 haskell questions\" a few minutes ago.</p>\n\n<p>The first one is fairly simple, to get the last element from a list. I was trying out various ways to solve, but I encountered the above error when I tried this little guy:</p>\n\n<pre><code>getLast = foldr1 $ flip const\n</code></pre>\n\n<p>I understand that this error occurs due to haskell being unable to infer the type of the function getLast and all I need to do is add an explicit type annotation for getLast. </p>\n\n<p>But strangely, if I write the above code in GHCi, it works! How is this possible? Is somehow GHCi Clairvoyant and be able to deduce types now?</p>\n\n<p>What are the major differences between writing a code directly in GHCi and writing haskell code in a .hs file and loading it?</p>\n"}, {"tags": ["haskell", "data-kinds", "church-encoding"], "answers": [{"comments": [{"owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "edited": false, "score": 0, "creation_date": 1465152860, "post_id": 37645141, "comment_id": 62771131, "body": "I was confusing STLC with second order typed calculus I guess. when you define <code>type Boolean = forall r. r -&gt; r -&gt; r</code> you are using it as well."}, {"owner": {"reputation": 108, "user_id": 6476589, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-OHBMKOvbfng/AAAAAAAAAAI/AAAAAAAADjw/5ye5MX8Sbzo/photo.jpg?sz=128", "display_name": "Brendan Murphy", "link": "https://stackoverflow.com/users/6476589/brendan-murphy"}, "edited": false, "score": 0, "creation_date": 1509507684, "post_id": 37645141, "comment_id": 81042921, "body": "The typical name for &quot;second order typed calculus&quot; is System F, fyi"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 4, "last_activity_date": 1465149980, "creation_date": 1465149980, "answer_id": 37645141, "question_id": 37643529, "link": "https://stackoverflow.com/questions/37643529/church-encoding-of-boolean-and-stlc/37645141#37645141", "title": "Church encoding of boolean and STLC", "body": "<p>It is not only true in the untyped lambda calculus; but in typed calculi, one does need to be a bit careful with typing, as usual. We should define:</p>\n\n<pre><code>type Boolean = forall r. r -&gt; r -&gt; r\n</code></pre>\n\n<p>We certainly have <code>tru, fls :: Boolean</code>, and should annotate them as such.\nBut we do <em>not</em> have <code>tryMeOnFalse :: Boolean -&gt; String</code>! So there is no real contradiction here.</p>\n\n<p>Your comments about STLC are a bit weird, since STLC has a very different typing system. We would need separate boolean types for each result type there, since there is <em>no</em> polymorphism.</p>\n\n<p>In Haskell, one can certainly define types which are inhabited only by <code>tru</code> or only by <code>fls</code> (well, each type is also inhabited by <code>undefined</code>, of course); but this is generally not very useful.</p>\n"}], "owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1465156409, "creation_date": 1465140300, "last_edit_date": 1465156409, "question_id": 37643529, "link": "https://stackoverflow.com/questions/37643529/church-encoding-of-boolean-and-stlc", "title": "Church encoding of boolean and STLC", "body": "<p>It is often said that </p>\n\n<pre><code>tru t f = t\nfls t f = f\n</code></pre>\n\n<p>represent True and False in the sense that \"we can use those terms to perform the operation on testing the truth of a boolean value\". </p>\n\n<p>But that hides an important caveat in that it seems only true in the untyped lambda calculus. If I just plug those values in haskell, I can write a function :</p>\n\n<pre><code>tryMeOnFalse \u2237  (\u2200 t f. t \u2192 f \u2192 t) \u2192 String\ntryMeOnFalse tr = \"Hi\"\na' = tryMeOnFalse tru\nb' = tryMeOnFalse fls  -- type error !\n</code></pre>\n\n<p>which distinguishes tru and fls at the type level. How wrong/true would it be to say that :</p>\n\n<ul>\n<li>in STLC <code>tru</code> and <code>fls</code> are value level witness of some promoted <code>'Boolean</code> kind, which has types <code>'True</code> and <code>'False</code>  </li>\n<li>in STLC the (coerced) typed values <code>(tru :: \u2200 t . t \u2192 t \u2192 t)</code> and <code>(fls ::  \u2200 t . t \u2192 t \u2192 t)</code> represent True and False (and in untyped, well the usual)</li>\n</ul>\n\n<p>Edit : I now realize thanks to @Daniel Wagner's answer I was thinking of Second Order Lambda Calculus and not STLC in my question.</p>\n"}, {"tags": ["haskell", "fold"], "answers": [{"comments": [{"owner": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "edited": false, "score": 0, "creation_date": 1465125589, "post_id": 37641109, "comment_id": 62762387, "body": "Oh my, that is handy! I was not familiar with <code>groupBy</code>/<code>orderBy</code> (although I&#39;ve used them in other languages of course). Reading the code it&#39;s pretty obvious what it does, although I&#39;m gonna have to read up on <code>on</code> and exercise my type-fu!"}, {"owner": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "edited": false, "score": 0, "creation_date": 1465125651, "post_id": 37641109, "comment_id": 62762398, "body": "I don&#39;t suppose you know a way to get rid of the rather ugly lambda in <code>foldr1 (\\(b,r) (_,r&#39;) -&gt; (b,r+r&#39;))</code>?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "edited": false, "score": 0, "creation_date": 1465126868, "post_id": 37641109, "comment_id": 62762760, "body": "@kai: IMO that lambda is just fine, but you can do <code>foldr1 (second . (+) . snd)</code> if you prefer."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 2, "last_activity_date": 1465124567, "creation_date": 1465124567, "answer_id": 37641109, "question_id": 37641022, "link": "https://stackoverflow.com/questions/37641022/haskell-sum-up-probability-list/37641109#37641109", "title": "Haskell - Sum up probability list", "body": "<p>Using <code>Map</code> is a good idea, but you'll need <code>Ord a</code> in addition to <code>Eq a</code>. If you're ok with that, then we can also do simpler list solution: just replace <code>partition</code> with a combination of <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-List.html#v:sortBy\" rel=\"nofollow\"><code>sortBy</code></a> and <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-List.html#v:groupBy\" rel=\"nofollow\"><code>groupBy</code></a>:</p>\n\n<pre><code>import Data.List (groupBy, sortBy)\nimport Data.Function (on)\n\nsumProbs :: (Ord a) =&gt; Prob a -&gt; Prob a\nsumProbs (Prob ps) = Prob . map reduce\n                   . groupBy ((==)`on`fst)\n                   $ sortBy (compare`on`fst) ps\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "edited": false, "score": 0, "creation_date": 1465132026, "post_id": 37642031, "comment_id": 62764337, "body": "Ah yes, this is very clean. I guess the downside is that this requires and <code>Ord</code> constraint on a, whereas the other solution works with <code>Eq</code> (I think the <code>sortBy</code> is unnecessary)."}, {"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "reply_to_user": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "edited": false, "score": 1, "creation_date": 1465132317, "post_id": 37642031, "comment_id": 62764443, "body": "@Kai <code>groupBy</code> will <i>not</i> group if the keys of equal value are not next to each other (try <code>group [1, 2, 1]</code>). so the <code>sortBy</code> is necessary"}, {"owner": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "edited": false, "score": 0, "creation_date": 1465132596, "post_id": 37642031, "comment_id": 62764526, "body": "Oh, well that settles it then! I suppose this is for performance reasons?"}, {"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "reply_to_user": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "edited": false, "score": 0, "creation_date": 1465137552, "post_id": 37642031, "comment_id": 62766101, "body": "@kai  it <i>may</i> perform faster if there are many duplicate keys (this will perform <code>n log u</code> where <code>u</code> is the number unique keys)"}], "tags": [], "owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "is_accepted": true, "score": 3, "last_activity_date": 1465136314, "last_edit_date": 1465136314, "creation_date": 1465130519, "answer_id": 37642031, "question_id": 37641022, "link": "https://stackoverflow.com/questions/37641022/haskell-sum-up-probability-list/37642031#37642031", "title": "Haskell - Sum up probability list", "body": "<p>If you use <code>Data.Map</code>, then <a href=\"https://hackage.haskell.org/package/containers-0.5.7.1/docs/Data-Map-Strict.html#v:fromListWith\" rel=\"nofollow\"><code>fromListWith</code></a> and <a href=\"https://hackage.haskell.org/package/containers-0.5.7.1/docs/Data-Map-Strict.html#v:toList\" rel=\"nofollow\"><code>toList</code></a> will do:</p>\n\n<pre><code>import Data.Map (toList, fromListWith)\n\nnewtype Prob a = Prob { getProb :: [(a, Rational)] }\n    deriving Show\n\nsumProbs :: (Ord a) =&gt; Prob a -&gt; Prob a\nsumProbs = Prob . toList . fromListWith (+) . getProb\n</code></pre>\n\n<hr>\n\n<p>Relaxing <code>Ord a</code> to <code>Eq a</code> would require a less efficient quadratic computation; something like:</p>\n\n<pre><code>sumProbs :: (Eq a) =&gt; Prob a -&gt; Prob a\nsumProbs = Prob . foldr go [] . getProb\n    where\n    go (x, y) = run\n        where\n        run [] = (x, y):[]\n        run ((a, b):rest)\n            | x == a    = (x, y + b): rest\n            | otherwise = (a, b): run rest\n</code></pre>\n"}], "owner": {"reputation": 3203, "user_id": 2622234, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/a4b0faa804acdb74ea677bc421d5caac?s=128&d=identicon&r=PG", "display_name": "sara", "link": "https://stackoverflow.com/users/2622234/sara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 37642031, "answer_count": 2, "score": 2, "last_activity_date": 1465136314, "creation_date": 1465123923, "question_id": 37641022, "link": "https://stackoverflow.com/questions/37641022/haskell-sum-up-probability-list", "title": "Haskell - Sum up probability list", "body": "<p>I'm going through Learn You A Haskell and just finished the part \"For a few monads more\". In this part we created a <code>newtype Prob a = Prob { getProb :: [(a, Rational)] }</code> and created a <code>Monad</code> instance for it. This allows us to calculate probabilities of results in non-deterministic calculations like the following:</p>\n\n<pre><code>data Coin = Heads | Tails deriving (Show, Eq)\n\ncoin :: Prob Coin\ncoin = Prob [(Heads, 1%2), (Tails, 1%2)]\n\nloadedCoin :: Prob Coin\nloadedCoin = Prob [(Heads, 1%10), (Tails, 9%10)]\n\ncoinTest :: Prob Bool\ncoinTest = do\n    a &lt;- coin\n    b &lt;- coin\n    c &lt;- loadedCoin\n    return (all (==Tails) [a,b,c])\n</code></pre>\n\n<p>Of course, this doesn't generate a very pretty result:</p>\n\n<pre><code>getProb coinTest\n&gt;&gt; [(False,1 % 40),(False,9 % 40),(False,1 % 40),(False,9 % 40),(False,1 % 40),(False,9 % 40),(False,1 % 40),(True,9 % 40)]\n</code></pre>\n\n<p>It was left as an exercise to the reader to write a neat function to sum up all the <code>False</code>s and all the <code>True</code>s so we get <code>[(True,9 % 40),(False,31 % 40)]</code>. I've managed to do this, sort of. It works for this particular case, but I feel like it isn't a useful function at all since it's so specialized. Here's what I came up with:</p>\n\n<pre><code>sumProbs :: Prob Bool -&gt; Prob Bool\nsumProbs (Prob ps) = let (trues, falses) = partition fst ps\n                         ptrue = reduce trues\n                         pfalse = reduce falses\n                     in Prob [ptrue, pfalse]\n                     where reduce = foldr1 (\\(b,r) (_,r') -&gt; (b,r+r'))\n</code></pre>\n\n<p>I'd love to generalize it to work for any <code>Eq a =&gt; Prob a</code>, but so far no luck. I was thinking of maybe using a <code>Map</code> together with <code>unionWith</code> or something like that. Or maybe I can exploit the fact that <code>(a,b)</code> has a <code>Functor b</code> instance? I think I'm missing some simpler more elegant solution.</p>\n\n<p>So, to sum it up: How can I write a function <code>sumProbs :: (Eq a) =&gt; Prob a -&gt; Prob a</code> that sums up all the probabilities that share the same value (key)?</p>\n"}, {"tags": ["haskell", "monad-transformers"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1465126927, "post_id": 37640980, "comment_id": 62762776, "body": "Can you provide a small code snippet with the actual types? It&#39;s hard to understand as it is."}, {"owner": {"reputation": 2117, "user_id": 149268, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/abef26583e8bf39b506ff3986c88850e?s=128&d=identicon&r=PG", "display_name": "hcvst", "link": "https://stackoverflow.com/users/149268/hcvst"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1465128249, "post_id": 37640980, "comment_id": 62763111, "body": "Hi Chi. Please see the code above."}, {"owner": {"reputation": 2117, "user_id": 149268, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/abef26583e8bf39b506ff3986c88850e?s=128&d=identicon&r=PG", "display_name": "hcvst", "link": "https://stackoverflow.com/users/149268/hcvst"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1465129146, "post_id": 37640980, "comment_id": 62763374, "body": "Perhaps wrapping it with return is ok. The question then is how to force evaluation I tried seq, which didn&#39;t help and seqdeep which resulted in type errors again."}], "answers": [{"comments": [{"owner": {"reputation": 2117, "user_id": 149268, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/abef26583e8bf39b506ff3986c88850e?s=128&d=identicon&r=PG", "display_name": "hcvst", "link": "https://stackoverflow.com/users/149268/hcvst"}, "edited": false, "score": 0, "creation_date": 1465129729, "post_id": 37641797, "comment_id": 62763548, "body": "Thank you. That fixed it. I am a bit confused though still. Looking at the <code>maybe</code> docs it says &quot;The maybe function takes a default value, a function, and a Maybe value.&quot; So here <code>(return ())</code> is default, <code>id $ onMsg &lt;*&gt;</code> the partially applied function and <code>(message update)</code> the value? Are you using id to force evaluation?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 2117, "user_id": 149268, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/abef26583e8bf39b506ff3986c88850e?s=128&d=identicon&r=PG", "display_name": "hcvst", "link": "https://stackoverflow.com/users/149268/hcvst"}, "edited": false, "score": 0, "creation_date": 1465130006, "post_id": 37641797, "comment_id": 62763631, "body": "Default value is <code>return ()</code> - a <code>Bot a</code> action; the function is <code>id</code>; the Maybe value is <code>onMsg &lt;*&gt; (message update)</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1465130016, "post_id": 37641797, "comment_id": 62763635, "body": "As a minor alternative, <code>fromMaybe (return ()) $ onMg &lt;*&gt; (message update)</code>"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 2117, "user_id": 149268, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/abef26583e8bf39b506ff3986c88850e?s=128&d=identicon&r=PG", "display_name": "hcvst", "link": "https://stackoverflow.com/users/149268/hcvst"}, "edited": false, "score": 0, "creation_date": 1465130724, "post_id": 37641797, "comment_id": 62763875, "body": "@hcvst - updated answer to explain more how this &quot;forces&quot; evaluation."}, {"owner": {"reputation": 2117, "user_id": 149268, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/abef26583e8bf39b506ff3986c88850e?s=128&d=identicon&r=PG", "display_name": "hcvst", "link": "https://stackoverflow.com/users/149268/hcvst"}, "edited": false, "score": 0, "creation_date": 1465144135, "post_id": 37641797, "comment_id": 62768119, "body": "Thank you very much @ErikR. Thanks also chi for your alt."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 2, "last_activity_date": 1465130694, "last_edit_date": 1465130694, "creation_date": 1465129077, "answer_id": 37641797, "question_id": 37640980, "link": "https://stackoverflow.com/questions/37640980/applicative-inside-readert-statet-io/37641797#37641797", "title": "Applicative &lt;*&gt; inside ReaderT StateT IO", "body": "<p>From what you say, I understand that:</p>\n\n<pre><code>onMsg &lt;*&gt; (message update) :: Maybe ( Bot a () )\n</code></pre>\n\n<p>To execute the enclosed <code>Bot a ()</code> computation if it is a Just, you can use:</p>\n\n<pre><code>maybe (return ()) id $ onMsg &lt;*&gt; (message update)\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>How does this \"force\" evaluation of the wrapped <code>Bot a ()</code> computation?</p>\n\n<p>We know that <code>onMsg &lt;*&gt; ...</code> is either <code>Nothing</code> or <code>Just comp</code> where <code>comp</code> is a <code>Bot a ()</code> computation.</p>\n\n<p><code>comp</code> will be \"evaluated\" if it becomes part of the monadic sequence in the do-block.</p>\n\n<p>The code above is the same as:</p>\n\n<pre><code>case (onMsg &lt;*&gt; ...) of\n  Nothing    -&gt; return ()\n  Just comp  -&gt; comp\n</code></pre>\n\n<p>So either <code>return ()</code> or <code>comp</code> will be the next step in the do-block.</p>\n"}], "owner": {"reputation": 2117, "user_id": 149268, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/abef26583e8bf39b506ff3986c88850e?s=128&d=identicon&r=PG", "display_name": "hcvst", "link": "https://stackoverflow.com/users/149268/hcvst"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 37641797, "answer_count": 1, "score": 1, "last_activity_date": 1465130694, "creation_date": 1465123550, "last_edit_date": 1465128149, "question_id": 37640980, "link": "https://stackoverflow.com/questions/37640980/applicative-inside-readert-statet-io", "title": "Applicative &lt;*&gt; inside ReaderT StateT IO", "body": "<p>Inside a ReaderT StateT IO do block I am trying to call a function inside a Maybe with a Maybe parameter using <code>&lt;*&gt;</code> but that results in a type error.</p>\n\n<p><code>onMessage &lt;*&gt; (message update)</code></p>\n\n<p>If I wrap the expression using <code>return $ onMessage &lt;*&gt; (message update)</code> it type checks but then the function does not appear to be evaluated.</p>\n\n<p>If I unwrap both the function and the argument and check for <code>Nothing</code> manually the function is called but that seems ugly.</p>\n\n<p>Is there another operator to use in this context? These are my first Monad Transformer steps and the types are too perplexing to even try and hoogle an answer. </p>\n\n<hr>\n\n<pre><code>...\n\ntype Bot a = ReaderT (BotConfig a) (StateT (BotState a) IO)\n\n...\n\nprocessUpdate :: Update -&gt; Bot a ()\nprocessUpdate update = do\n    BotConfig {tw_handlers = MessageHandlers {\n          tw_onMessage = onMg\n        }\n    } &lt;- ask\n\n    onMg &lt;*&gt; (message update) -- this is what I would like to do\n                              -- onMg :: Maybe (Message -&gt; Bot a ())\n                              -- message :: Update -&gt; Maybe Message\n</code></pre>\n"}, {"tags": ["haskell", "yesod", "yesod-forms"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1465111148, "post_id": 37638541, "comment_id": 62759074, "body": "why relate to the session instead of the user-id? Sessions will change for the same user"}, {"owner": {"reputation": 25, "user_id": 5558619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0daf238ed465f8fec6db6cb0397c603e?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas F", "link": "https://stackoverflow.com/users/5558619/jonas-f"}, "edited": false, "score": 0, "creation_date": 1465175302, "post_id": 37638541, "comment_id": 62776813, "body": "The session isn&#39;t the user_id ? If not can session guard User-Id to use in insert, selects ?How can i do it ?"}], "owner": {"reputation": 25, "user_id": 5558619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0daf238ed465f8fec6db6cb0397c603e?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas F", "link": "https://stackoverflow.com/users/5558619/jonas-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 92, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1465101877, "creation_date": 1465101877, "question_id": 37638541, "link": "https://stackoverflow.com/questions/37638541/relate-an-item-in-the-database-to-the-user-session-id-yesod-haskell-postgree", "title": "Relate an item in the database to the User Session ID - Yesod Haskell Postgree", "body": "<p>Im doing a PetShop System. I have a form that list all Animals. I already have Session in my Project. How can i add a Animal linking to session ID and in the page that list's the animals, list just the animals of that user.</p>\n\n<p>This is the part related it.</p>\n\n<pre><code>share [mkPersist sqlSettings, mkMigrate \"migrateAll\"] [persistLowerCase|\nAnimals \n   nome Text\n   idade Int\n   racaid RacaId\n   deriving Show\n\nUsers \n   nome Text\n   login Text\n   senha Text\n   deriving Show\n\nRaca\n   nome Text\n   apelido Text sqltype=varchar(10)\n   deriving Show\n|]\n\n--Form that include animals\nformAnimal :: Form Animals\nformAnimal = renderDivs $ Animals &lt;$&gt;\n           areq textField \"Nome: \" Nothing &lt;*&gt;\n           areq intField \"Idade: \" Nothing &lt;*&gt;\n           areq (selectField racas) \"Raca\" Nothing\n\n--Form that include Users\nformUser :: Form Users\nformUser = renderDivs $ Users &lt;$&gt;\n           areq textField \"Nome: \" Nothing &lt;*&gt;\n           areq textField \"Login: \" Nothing &lt;*&gt;\n           areq passwordField \"Password: \" Nothing\n\n--Function do include animals\ngetAnimalR :: Handler Html\ngetAnimalR = do\n           (widget, enctype) &lt;- generateFormPost formAnimal\n           defaultLayout $ do \n           toWidget [cassius|\n              label\n                  color:blue;\n           |]\n           [whamlet|\n                 &lt;form .form-horizontal method=post enctype=#{enctype} action=@{AnimalR}&gt;\n                     ^{widget}\n                     &lt;input type=\"submit\" value=\"Cadastrar Animal\"&gt;\n           |]\n\n--Part that list all Animals (need to list just of the User)\ngetListarAnimalR :: Handler Html\ngetListarAnimalR = do\n             listaAnm &lt;- runDB $ selectList [] [Asc AnimalsNome]\n             defaultLayout $ [whamlet|\n                 &lt;h1&gt; Animais cadastrados:\n                 $forall Entity pid animals &lt;- listaAnm\n                     &lt;a href=@{ChecarAnimalR pid}&gt; #{animalsNome animals} \n                     &lt;form method=post action=@{ChecarAnimalR pid}&gt; \n                         &lt;input type=\"submit\" value=\"Deletar Animal\"&gt;&lt;br&gt;\n             |] &gt;&gt; toWidget [lucius|\n                form  { display:inline; }\n                input { background-color: #ecc; border:0;}\n             |]\n\n--Function that get the User. Check in database if contain any user with that login and pass\npostLoginR :: Handler Html\npostLoginR = do\n           ((result, _), _) &lt;- runFormPost formLogin\n           case result of \n               FormSuccess (\"admin\",\"admin\") -&gt; setSession \"_ID\" \"admin\" &gt;&gt; redirect AdminR\n               FormSuccess (login,senha) -&gt; do \n                   user &lt;- runDB $ selectFirst [UsersLogin ==. login, UsersSenha ==. senha] []\n                   case user of\n                       Nothing -&gt; redirect LoginR\n                       Just (Entity pid u) -&gt; setSession \"_ID\" (pack $ show $ fromSqlKey pid) &gt;&gt; redirect (PerfilR pid)\n</code></pre>\n"}, {"tags": ["haskell", "unicode"], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1465083772, "post_id": 37634913, "comment_id": 62753898, "body": "Maybe \u22a5 is being treated as an infix symbol, like + , rather than a letter?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 1, "creation_date": 1465085352, "post_id": 37634913, "comment_id": 62754175, "body": "Not sure exactly what the rules are. I got a hint from <a href=\"https://mail.haskell.org/pipermail/haskell-cafe/2008-January/037723.html\" rel=\"nofollow noreferrer\">this old Haskell Cafe message</a>. Seems like you can use \u22a5 as a name as long as you use parens, e.g. <code>(\u22a5) = &#39;z&#39;</code>"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1465141647, "post_id": 37634913, "comment_id": 62767304, "body": "The Unicode category for this codepoint is probably &quot;symbol&quot;, which is why Haskell regards it as a punctuation mark (like &quot;+&quot;, which is Unicode &quot;PLUS SIGN&quot; category Sm, &quot;Symbol, Math&quot;). Every Unicode character has various properties such as category, case, etc."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 4, "last_activity_date": 1465073574, "creation_date": 1465073574, "answer_id": 37634913, "question_id": 37634783, "link": "https://stackoverflow.com/questions/37634783/parse-error-in-haskell-file-with-unicode-symbol/37634913#37634913", "title": "parse error in haskell file with unicode symbol", "body": "<p>Try:</p>\n\n<pre><code>a = (\u22a5)\n</code></pre>\n\n<p>(along with <code>LANGUAGE UnicodeSyntax</code>)</p>\n"}], "owner": {"reputation": 7792, "user_id": 242189, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/48a18a00706b9c7206ef4092b6e68a41?s=128&d=identicon&r=PG", "display_name": "nicolas", "link": "https://stackoverflow.com/users/242189/nicolas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 37634913, "answer_count": 1, "score": 1, "last_activity_date": 1465074003, "creation_date": 1465072676, "question_id": 37634783, "link": "https://stackoverflow.com/questions/37634783/parse-error-in-haskell-file-with-unicode-symbol", "title": "parse error in haskell file with unicode symbol", "body": "<p>It's probably very stupid, but I get a </p>\n\n<p>parse error on input \u2018\u22a5\u2019</p>\n\n<p>when I process this file </p>\n\n<pre><code>#!/usr/bin/env stack\n-- stack --install-ghc --resolver lts-5.13 runghc --package http-conduit\n{-# LANGUAGE OverloadedStrings, RankNTypes, MultiParamTypeClasses, FunctionalDependencies #-}\n{-# LANGUAGE ScopedTypeVariables, UnicodeSyntax, PartialTypeSignatures #-}\nmodule MainImplicitConfiguration where\n\na = \u22a5\n</code></pre>\n\n<p>Is there a reason why that should be a parse error ?</p>\n"}, {"tags": ["haskell", "maybe"], "comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 7, "creation_date": 1465062863, "post_id": 37633245, "comment_id": 62748483, "body": "Check out the type signature of <code>fmap</code>, and see if you can make it do anything interesting."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1465067128, "post_id": 37633660, "comment_id": 62749696, "body": "Very nice. If we wanted to be very pedantic, we can also return <code>Just (f (f ... (f y)...))</code> for any number of <code>f</code>s. (Not a common result, but if we want to be exhaustive...)"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1465070734, "post_id": 37633660, "comment_id": 62750839, "body": "There is only one function with the exact type <code>a -&gt; a</code>, but there are many many functions that <i>unify</i> with that type, such as <code>succ</code> or <code>(* 2)</code>. (b) and (c) are nowhere near equivalent for an arbitrary <code>f</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2512323"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1465070924, "post_id": 37633660, "comment_id": 62750884, "body": "@amalloy, true, if we are talking about <code>forall a . f :: a-&gt;a</code>, but my assumption is based on <code>f :: forall a . a-&gt;a</code>."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1465070997, "post_id": 37633660, "comment_id": 62750909, "body": "That&#39;s a strange assumption to make, since as you point out there is only one such function, and it&#39;s not the type that Haskell infers when you accept <code>f</code> as an argument to your function."}, {"owner": {"user_type": "does_not_exist", "display_name": "user2512323"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1465071802, "post_id": 37633660, "comment_id": 62751154, "body": "@amalloy, of course your are correct, making <code>f</code> global just simplifies explanation a bit without loss of generality, and I put a note just to point out that one strange thing. Edited now to incorporate your point."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2512323"}, "is_accepted": true, "score": 5, "last_activity_date": 1465071751, "last_edit_date": 1465071751, "creation_date": 1465064940, "answer_id": 37633660, "question_id": 37633245, "link": "https://stackoverflow.com/questions/37633245/haskell-converting-a-functions-type-into-maybe/37633660#37633660", "title": "(Haskell) Converting a functions type into maybe", "body": "<p>Assuming you have</p>\n\n<pre><code>f :: a -&gt; a\n</code></pre>\n\n<p>And you need to construct</p>\n\n<pre><code>g :: Maybe a -&gt; Maybe a\ng = ...\n</code></pre>\n\n<p>How we can construct it? First, it is a function of one argument, so it should be something like:</p>\n\n<pre><code>g = \\x -&gt; ...\n</code></pre>\n\n<p>Second, we have an argument of type <code>Maybe</code>, so we can analyze two cases separately:</p>\n\n<pre><code>g = \\x -&gt; case x of\n  Nothing -&gt; ... (1)\n  Just y -&gt; ... (2)\n</code></pre>\n\n<p>In (1), we can't do much: we can't produce a value of abstract type <code>a</code>, so can't use <code>Just</code>. The only thing we can use is <code>Nothing</code>.</p>\n\n<p>In (2), we have three options:</p>\n\n<p>a) <code>Nothing</code> again, so we get a boring solution:</p>\n\n<pre><code>g = \\x -&gt; case x of\n  Nothing -&gt; Nothing\n  Just y -&gt; Nothing\n</code></pre>\n\n<p>which is simply </p>\n\n<pre><code>g = \\x -&gt; Nothing\n</code></pre>\n\n<p>b) Or, we have a <code>y::a</code>, so we can return <code>Just y</code>:</p>\n\n<pre><code>g = \\x -&gt; case x of\n  Nothing -&gt; Nothing\n  Just y -&gt; Just y\n</code></pre>\n\n<p>which is simply </p>\n\n<pre><code>g = \\x -&gt; x -- = id\n</code></pre>\n\n<p>c) Or, we can apply <code>f</code> to <code>y</code>, to get a new value of type <code>a</code>. All we need to do then is to wrap this value in a <code>Just</code>:</p>\n\n<pre><code>g = \\x -&gt; case x of\n  Nothing -&gt; Nothing\n  Just y -&gt; Just (f y)\n</code></pre>\n\n<p>As @chi pointed out, we can keep applying <code>f</code> to the result, so we can also return <code>Just (f (f ... (f y)...))</code> for any number of <code>f</code>s.</p>\n\n<p>Only (c) ever uses <code>f</code>, so it is the only non-trivial solution here.</p>\n\n<p><em>For the sake of completeness, it's worth noting that for real world application, both (b) and (c) are equivalent, as <code>f</code> can't be anything except <code>id</code>.</em></p>\n\n<p>As @amalloy pointed out, this is not the case if we take <code>f</code> as an argument instead of global function, as only <code>id</code> can serve as <code>a-&gt;a</code> for any <code>a</code>, but there are many functions with type <code>a-&gt;a</code> <em>for given <code>a</code></em>. So if your <code>g</code> supposed to be</p>\n\n<pre><code>g :: (a-&gt;a)-&gt;(Maybe a-&gt;Maybe a)\n</code></pre>\n\n<p>Then (b) and (c) are no longer the same thing.</p>\n\n<p>For sure, this can be written in many ways: the naive version above, using the fact <code>Maybe</code> is a <code>Monad</code>, using <code>fmap</code> from <code>Functor Maybe</code> (credits to @amalloy), but the result will be the same.</p>\n"}, {"tags": [], "owner": {"reputation": 41209, "user_id": 485115, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/59693d66b96ca17ca9d2fdb2393e2be3?s=128&d=identicon&r=PG", "display_name": "Nikita Volkov", "link": "https://stackoverflow.com/users/485115/nikita-volkov"}, "is_accepted": false, "score": 1, "last_activity_date": 1465069272, "creation_date": 1465069272, "answer_id": 37634309, "question_id": 37633245, "link": "https://stackoverflow.com/questions/37633245/haskell-converting-a-functions-type-into-maybe/37634309#37634309", "title": "(Haskell) Converting a functions type into maybe", "body": "<p>It's really tough to avoid the final answer to this, because it's a trivial problem, really.</p>\n\n<p>Check out the signature of the standard function <code>fmap</code> (I'll drop the constraint part, since we don't need it now):</p>\n\n<pre><code>fmap :: (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>You can look at it as on a function of two arguments <code>(a -&gt; b)</code> and <code>f a</code>, producing a result <code>f b</code>. However the following signature is absolutely the same:</p>\n\n<pre><code>fmap :: (a -&gt; b) -&gt; (f a -&gt; f b)\n</code></pre>\n\n<p>Do the bells start ringing? Yes, <code>fmap</code> can also be seen as a function of one argument <code>(a -&gt; b)</code> producing the <code>(f a -&gt; f b)</code> function as a result.</p>\n\n<p>Now, the <code>f</code> in those signatures represents any type that has an instance of <code>Functor</code>, of which <code>Maybe</code> is just the case. Now, figure out the rest :)</p>\n"}], "owner": {"reputation": 181, "user_id": 6364331, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-fm9wjqYCF0w/AAAAAAAAAAI/AAAAAAAAAB0/aZXQLwmq884/photo.jpg?sz=128", "display_name": "JinseiNagai", "link": "https://stackoverflow.com/users/6364331/jinseinagai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 443, "favorite_count": 0, "accepted_answer_id": 37633660, "answer_count": 2, "score": 1, "last_activity_date": 1465071751, "creation_date": 1465062278, "question_id": 37633245, "link": "https://stackoverflow.com/questions/37633245/haskell-converting-a-functions-type-into-maybe", "title": "(Haskell) Converting a functions type into maybe", "body": "<p>given a function that does: (a -> a) We should take the function and convert it's type into (Maybe a -> Maybe a). I am kinda sitting here trying everything possible but I only got as far as getting the type Maybe (a -> a) but I don't get the idea of changing the actual Input and Output. So could someone give me only some hints or ideas on solving this problem so I can try it on my own? Thanks.</p>\n"}, {"tags": ["eclipse", "haskell"], "comments": [{"owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "edited": false, "score": 0, "creation_date": 1465062903, "post_id": 37633176, "comment_id": 62748503, "body": "First of all, I recommend reading the documentation for <code>insert</code> to see if it&#39;s doing what you want. I don&#39;t know whatever language your code is in, so it&#39;s a little difficult for me to be sure.  But to fix your problem, you need to make <code>Documento</code> an instance of <code>Ord</code>. Fortunately, GHC will do that for you if you add <code>Ord</code> to the deriving clause of the type. That is, change <code>deriving Show</code> to <code>deriving (Show, Ord)</code> at the end of the <code>data Documento = ...</code> declaration."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1465064590, "post_id": 37633176, "comment_id": 62748990, "body": "You should explain - in English - what you want <code>mostrarDocumento&#39;</code> to do."}], "answers": [{"tags": [], "owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "is_accepted": false, "score": 1, "last_activity_date": 1465066712, "creation_date": 1465066712, "answer_id": 37633905, "question_id": 37633176, "link": "https://stackoverflow.com/questions/37633176/why-i-have-the-error-no-instance-for-ord-documento-arising-from-a-use-of-ins/37633905#37633905", "title": "why i have the error &quot;No instance for (Ord Documento) arising from a use of \u2018insert&quot; wit haskell", "body": "<p>As you can see from <a href=\"http://hackage.haskell.org/package/base-4.9.0.0/docs/Data-List.html#v:insert\" rel=\"nofollow\">the documentation</a>:</p>\n\n<pre><code>insert :: Ord a =&gt; a -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>So <code>insert</code> works on a list of <code>a</code>s, but only if that <code>a</code> is of typeclass <code>Ord</code>, i.e. that have an order defined on them. So try:</p>\n\n<pre><code>data Documento = ... deriving (Show, Ord)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 0, "last_activity_date": 1465067371, "creation_date": 1465067371, "answer_id": 37634027, "question_id": 37633176, "link": "https://stackoverflow.com/questions/37633176/why-i-have-the-error-no-instance-for-ord-documento-arising-from-a-use-of-ins/37634027#37634027", "title": "why i have the error &quot;No instance for (Ord Documento) arising from a use of \u2018insert&quot; wit haskell", "body": "<p>I have a feeling this is what you are trying to do:</p>\n\n<pre><code>mostrarDocumento' :: Documentos -&gt; String -&gt; Documentos\nmostrarDocumento' [] _ = []\nmostrarDocumento' (docu:documentos) anno =\n    if esAnnoIgual docu anno\n      then docu : (mostrarDocumento' documentos anno)\n      else mostrarDocumento' documentos anno\n</code></pre>\n\n<p>which is the same as:</p>\n\n<pre><code>mostrarDocumento' docs = filter (\\d -&gt; esAnnoIgual d anno) docs\n</code></pre>\n"}], "owner": {"reputation": 319, "user_id": 4989750, "user_type": "registered", "accept_rate": 48, "profile_image": "https://graph.facebook.com/10155683297590191/picture?type=large", "display_name": "BarneyL. BarStin", "link": "https://stackoverflow.com/users/4989750/barneyl-barstin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1465067371, "creation_date": 1465061808, "question_id": 37633176, "link": "https://stackoverflow.com/questions/37633176/why-i-have-the-error-no-instance-for-ord-documento-arising-from-a-use-of-ins", "title": "why i have the error &quot;No instance for (Ord Documento) arising from a use of \u2018insert&quot; wit haskell", "body": "<p>Im beginner with haskell and im trying to execute my method mostrarDocumento, setting Documentos and String(year), and the method should return all documents that have the same year , but i having the error : </p>\n\n<pre><code>    No instance for (Ord Documento) arising from a use of \u2018insert\u2019\n    In a stmt of a 'do' block:\n      insert docu (mostrarDocumento' documentos anno)\n    In the expression:\n      do { insert docu (mostrarDocumento' documentos anno) }\n    In the expression:\n      if esAnnoIgual docu anno then\n          do { insert docu (mostrarDocumento' documentos anno) }\n      else\n          mostrarDocumento' documentos anno\n</code></pre>\n\n<p>Someone can help me with my code?</p>\n\n<pre><code>module Documento where\nimport Data.List\nimport Data.Function (on)\nimport System.IO()\n\ntype Revista = String\ntype IdD = String\ntype Anno = String\ntype Titulo = String\ntype Resumen = String\ntype Secciones = [String]\n\ndata Documento = D (Revista, IdD, Anno, Titulo, Resumen, Secciones)deriving Show\ntype Documentos = [Documento]\n\nanio :: Documento -&gt; Anno\nanio (D (_,_,anio,_,_,_)) = anio\n\n\npintarDocOrd :: Documentos -&gt; IO()\npintarDocOrd [] = return ()\npintarDocOrd (dc:dcs) = do\n        print dc\n        pintarDocOrd dcs\n\nmostrarDocumeto :: Documentos -&gt; String-&gt; IO()\nmostrarDocumeto [] _ =  return ()\nmostrarDocumeto documentos anno = do\n      let documento = mostrarDocumento' documentos anno\n      pintarDocOrd documento\n\nmostrarDocumento' :: Documentos -&gt; String -&gt; Documentos\nmostrarDocumento' [] _ = []\nmostrarDocumento' (docu:documentos) anno =\n                                        if esAnnoIgual docu anno then do\n                                          insert docu (mostrarDocumento' documentos anno)\n                                         else\n                                           mostrarDocumento' documentos anno\n\nesAnnoIgual :: Documento -&gt; String -&gt; Bool\nesAnnoIgual documento anno\n          | anio documento == anno = True\n          | otherwise = False\n</code></pre>\n"}, {"tags": ["haskell", "streaming", "haskell-pipes"], "comments": [{"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1465140570, "post_id": 37632027, "comment_id": 62766973, "body": "Here&#39;s a similar question <a href=\"http://stackoverflow.com/questions/25982213/using-haskell-pipes-bytestring-to-iterate-a-file-by-line/27727521#27727521\" title=\"using haskell pipes bytestring to iterate a file by line\">stackoverflow.com/questions/25982213/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1465068673, "post_id": 37633828, "comment_id": 62750219, "body": "Is <code>PG.concats</code> is the same as your <code>mconcats</code> ?"}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1465075621, "post_id": 37633828, "comment_id": 62752177, "body": "No, <code>PG.concats</code> just removes the <code>FreeT</code> breaks in the succession, so it doesn&#39;t have a monoid constraint. The analogy to <code>concat</code> follows the general analogy <code>FreeT (Producer m) m r  : Producer a m r  ::  [[a]] : [a]</code>  My little <code>mconcats</code> crushes each successive producer of monoidal values into a summary monoidal value - that is, it does a number of little mconcat-like operations. Maybe it&#39;s not the best name."}, {"owner": {"reputation": 6241, "user_id": 722869, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1c5c02f9165e188ab81a53efabc062e2?s=128&d=identicon&r=PG", "display_name": "daj", "link": "https://stackoverflow.com/users/722869/daj"}, "edited": false, "score": 0, "creation_date": 1465141892, "post_id": 37633828, "comment_id": 62767382, "body": "i&#39;m running every n lines in a parser (probably attoparsec or megaparsec) to build records. it would seem like i would have to build individual bytestrings (at least one per record for that). or is there a way to avoid that?"}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1465155210, "post_id": 37633828, "comment_id": 62771934, "body": "If you have written a single attoparsec parser that succeeds on a given n-line segment and returns a record, then you can repeatedly apply it directly to the bytestring producer, without breaking it into lines.  See <a href=\"https://hackage.haskell.org/package/pipes-attoparsec-0.5.1.3/docs/Pipes-Attoparsec.html#v:parsed\" rel=\"nofollow noreferrer\"><code>Pipes.Attoparsec.decoded</code></a>. So, <code>parsed my_n_line_parser . decompress</code> will stream the records as they come from the compressed file; if it fails it will return the rest of the (decompressed) producer of bytestrings with messages. If it fits the task this may be simplest."}], "tags": [], "owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "is_accepted": true, "score": 2, "last_activity_date": 1465079503, "last_edit_date": 1465079503, "creation_date": 1465066243, "answer_id": 37633828, "question_id": 37632027, "link": "https://stackoverflow.com/questions/37632027/haskell-pipes-how-to-repeatedly-perform-a-takewhile-operation-on-a-bytestring/37633828#37633828", "title": "haskell pipes - how to repeatedly perform a takeWhile operation on a bytestring pipe?", "body": "<p><code>pipes-bytestring</code> and <code>pipes-group</code> are arranged so that repeatedly breaking a <code>Producer ByteString m r</code> yields a <code>FreeT (Producer ByteString m) m r</code>. <code>FreeT</code> can here be read to mean <code>A_Succession_Of</code>, so the result can be thought of as 'a succession of bytestring-producer segments returning an r'. This way if one of the segments is, say, 10 gibabytes long, <a href=\"http://www.haskellforall.com/2013/09/perfect-streaming-using-pipes-bytestring.html\" rel=\"nofollow\">we still have streaming rather than a 10 gigabyte strict bytestring</a>. </p>\n\n<p>It looks to me that you want to break the bytestring producer on newlines, but I couldn't tell if you wanted to keep the newlines. If you are throwing them out, this is the same as splitting the bytestring producer with <code>view PB.lines</code>, followed by concatenating each subordinate producer into a single strict bytestring - the individual line. I wrote this below as <code>accumLines</code>. It is straightforward, but makes a tiny use of <code>Lens.view</code> to turn the fancy <code>PB.lines</code> lens into a regular function. (Many operations are written as lenses in <code>pipes-bytestring</code> because then they can be re-used for other purpose, especially the kind of producer parsing <code>pipes</code> favors.)</p>\n\n<pre><code>import Pipes\nimport qualified Pipes.Prelude as P\nimport Pipes.ByteString as PB\nimport qualified Pipes.Group as PG\nimport Pipes.GZip\n\nimport qualified Data.ByteString.Internal as BS (c2w, w2c)\n\nimport System.IO\nimport Lens.Simple (view) -- or Control.Lens or whatever\nimport Data.Monoid\n\nmain = run &gt;&gt;= mapM_ print\n\nmyPipe fileHandle = P.toListM $ accumLines (decompress fileProducer)\n  where\n    fileProducer = PB.fromHandle fileHandle\n\nrun = do\n  dat &lt;- withFile \"a.gz\" ReadMode myPipe\n  pure dat\n\n-- little library additions\n\naccumLines :: Monad m =&gt; Producer ByteString m r -&gt; Producer ByteString m r\naccumLines = mconcats . view PB.lines \n\naccumSplits :: Monad m =&gt; Char -&gt; Producer ByteString m r -&gt; Producer ByteString m r\naccumSplits c  = mconcats . view (PB.splits (BS.c2w c)) \n\n-- this is convenient, but the operations above could \n-- be more rationally implemented using e.g. BL.fromChunks and toListM \nmconcats :: (Monad m, Monoid b) =&gt; FreeT (Producer b m) m r -&gt; Producer b m r\nmconcats = PG.folds (&lt;&gt;) mempty id\n</code></pre>\n\n<p>Ideally you would not write a new bytestring at each line break. Whether you have to depends on what you were going to do with the lines.</p>\n"}, {"comments": [{"owner": {"reputation": 6241, "user_id": 722869, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1c5c02f9165e188ab81a53efabc062e2?s=128&d=identicon&r=PG", "display_name": "daj", "link": "https://stackoverflow.com/users/722869/daj"}, "edited": false, "score": 0, "creation_date": 1465141664, "post_id": 37634693, "comment_id": 62767310, "body": "Thanks for explaining this. Why is some functionality provided as a lens view vs. providing transformation functions directly? I understand lenses provide more generality, but the design is not obvious beyond that. What does it mean that the lenses are described as &quot;improper&quot; in the haddocks?"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 6241, "user_id": 722869, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1c5c02f9165e188ab81a53efabc062e2?s=128&d=identicon&r=PG", "display_name": "daj", "link": "https://stackoverflow.com/users/722869/daj"}, "edited": false, "score": 0, "creation_date": 1465143057, "post_id": 37634693, "comment_id": 62767779, "body": "Those are good questions for <a href=\"http://stackoverflow.com/users/1026598/gabriel-gonzalez\">stackoverflow.com/users/1026598/gabriel-gonzalez</a> ! Another place to ask questions specifically about pipes is the <a href=\"https://groups.google.com/forum/#!forum/haskell-pipes\" rel=\"nofollow noreferrer\">pipes mailing list</a>"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 3, "last_activity_date": 1465072031, "creation_date": 1465072031, "answer_id": 37634693, "question_id": 37632027, "link": "https://stackoverflow.com/questions/37632027/haskell-pipes-how-to-repeatedly-perform-a-takewhile-operation-on-a-bytestring/37634693#37634693", "title": "haskell pipes - how to repeatedly perform a takeWhile operation on a bytestring pipe?", "body": "<p>@Michael's answer is good. I just want to illustrate some\nusage patterns that are going on here.</p>\n\n<p>( .lhs available at <a href=\"http://lpaste.net/165352\" rel=\"nofollow\">http://lpaste.net/165352</a> )</p>\n\n<p>First a few imports:</p>\n\n<pre><code> {-# LANGUAGE OverloadedStrings, NoMonomorphismRestriction #-}\n\n import Pipes\n import qualified Pipes.Prelude as PP\n import qualified Pipes.Group as PG\n import qualified Pipes.ByteString as PB\n import qualified Pipes.GZip as GZip\n import qualified Data.ByteString as BS\n import Lens.Family (view, over)\n import Control.Monad\n import System.IO\n</code></pre>\n\n<p>If you look over the functions in Pipes.ByteString and Pipes.GZip\nyou'll see that they all into the following type schemas:</p>\n\n<ol>\n<li>Producer ... -> FreeT (Producer ...) ...</li>\n<li>FreeT (Producer ...) ...  -> Producer ...</li>\n<li>Lens' (Producer ...) (FreeT (Producer ...) ...)</li>\n<li>Producer ... -> Producer ...</li>\n</ol>\n\n<p>Examples of functions in each category:</p>\n\n<ol>\n<li><code>PB.words</code></li>\n<li><code>PG.concats</code></li>\n<li><code>PB.lines</code>, <code>PB.chunksOf</code>, <code>PB.splits</code>, ...</li>\n<li><code>GZip.compress</code>, <code>GZip.decompress</code></li>\n</ol>\n\n<p>Here's how to use <code>PB.words</code> to split an input stream into words:</p>\n\n<pre><code> prod = yield \"this is\\na test\\nof the pipes\\nprocessing\\nsystem\"\n\n t1 = runEffect $ (PG.concats . PB.words) prod &gt;-&gt; PP.print\n</code></pre>\n\n<p>To use a function of type 3 -- e.g. <code>PB.lines</code>, just use <code>view</code> on the\n<code>Lens'</code> to get a function of type 1 and then compose with <code>PG.concats</code>:</p>\n\n<pre><code> t2a = runEffect $ (PG.concats . view PB.lines) prod &gt;-&gt; PP.print\n\n t2b h = (PG.concats . view PB.lines) (PB.fromHandle h) &gt;-&gt; PP.print\n\n run2 = withFile \"input\" ReadMode (runEffect . t2b)\n</code></pre>\n\n<p>For a Producer -> Producer function, just use normal function application:</p>\n\n<pre><code> t3 h = GZip.decompress (PB.fromHandle h) &gt;-&gt; PP.print\n\n run3 = withFile \"input.gz\" ReadMode (runEffect . t3)\n\n t4 h = GZip.decompress (PB.fromHandle h) &gt;-&gt; PP.map BS.length &gt;-&gt; PP.print\n\n run4 = withFile \"big.gz\" ReadMode (runEffect . t4)\n</code></pre>\n\n<p>To first decompress and then split by lines, we nest function\napplication:</p>\n\n<pre><code> t5 h = (PG.concats . view PB.lines) ( GZip.decompress (PB.fromHandle h) )\n          &gt;-&gt; PP.map BS.length &gt;-&gt; PP.print\n\n run5 = withFile \"input.gz\" ReadMode (runEffect . t5)\n</code></pre>\n"}], "owner": {"reputation": 6241, "user_id": 722869, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1c5c02f9165e188ab81a53efabc062e2?s=128&d=identicon&r=PG", "display_name": "daj", "link": "https://stackoverflow.com/users/722869/daj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "accepted_answer_id": 37633828, "answer_count": 2, "score": 2, "last_activity_date": 1465079503, "creation_date": 1465054629, "question_id": 37632027, "link": "https://stackoverflow.com/questions/37632027/haskell-pipes-how-to-repeatedly-perform-a-takewhile-operation-on-a-bytestring", "title": "haskell pipes - how to repeatedly perform a takeWhile operation on a bytestring pipe?", "body": "<p>What I'm trying to do is use takeWhile to split a bytestring by some character.</p>\n\n<pre><code>import qualified Data.ByteString.Internal as BS (c2w, w2c)\nimport Pipes\nimport Pipes.ByteString as PB\nimport Pipes.GZip\nimport Pipes.Prelude as PP\nimport System.IO\n\nnewline = BS.c2w '\\n'\n\nsplitter = PB.takeWhile (\\myWord -&gt; myWord /= newline)\n\nmyPipe fileHandle = PP.toListM $ decompress fileProducer &gt;-&gt; splitter\n  where\n    fileProducer = PB.fromHandle fileHandle       \n\nrun = do\n  dat &lt;- withFile \"somefile.blob\" ReadMode myPipe\n  pure dat\n</code></pre>\n\n<p>This gets me the first line, but what I really want is to effectively yield each chunk up to a newline character at a time. How do I do that?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 3, "creation_date": 1465053136, "post_id": 37631576, "comment_id": 62745300, "body": "It&#39;s much more efficient to write <code>listToTuples xs@(_:xs&#39;) = zip xs xs&#39;</code>"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1465053280, "post_id": 37631576, "comment_id": 62745348, "body": "BTW: I cannot reproduce your problem: <code>Prelude&gt; take 10 $ listToTuples primes [(2,3),(5,7),(11,13),(17,19),(23,29),(31,37),(41,43),(47,53)&zwnj;&#8203;,(59,61),(67,71)] </code>  (using your implementation for <code>listToTuples</code>)."}, {"owner": {"reputation": 5481, "user_id": 2913106, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/cM7Yq.jpg?s=128&g=1", "display_name": "flawr", "link": "https://stackoverflow.com/users/2913106/flawr"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1465056371, "post_id": 37631576, "comment_id": 62746406, "body": "@Bakuriu Thank you for the hint (I&#39;m obviously still a beginner). On my computer it does still get stuck at the exact same point even when using <code>take 10 $ listToTuples primes</code>. What OS / versio nare you using?"}, {"owner": {"reputation": 5481, "user_id": 2913106, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/cM7Yq.jpg?s=128&g=1", "display_name": "flawr", "link": "https://stackoverflow.com/users/2913106/flawr"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1465056542, "post_id": 37631576, "comment_id": 62746447, "body": "@Carsten Yes this still does not work. I did update the question accordingly. PS: To the people voting to close: Why do you consider this question off topic?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1465056814, "post_id": 37631576, "comment_id": 62746534, "body": "@Bakuriu That behaves differently -- note that <code>(l !! 1, l !! 2)</code> is <i>not</i> in the output of <code>listtotuples</code>, but <code>(xs !! 1, xs !! 2)</code> does appear in the output of <code>listToTuples</code>. <a href=\"http://hackage.haskell.org/package/split-0.2.2/docs/Data-List-Split.html#v:chunksOf\" rel=\"nofollow noreferrer\"><code>chunksOf 2</code></a> is a better replacement."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1465056909, "post_id": 37631576, "comment_id": 62746569, "body": "@flawr Are you sure that the code you&#39;re executing is exactly the code you&#39;ve posted here? e.g. is your editor looking at the right file, have you definitely hit save, etc.?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1465057208, "post_id": 37631576, "comment_id": 62746679, "body": "For what it&#39;s worth, I have not yet voted to close. I read the proposed reason (&quot;typo/not reproducible&quot;) to mean that even the person who posted the question can no longer reproduce the problem. Just because we can&#39;t reproduce it doesn&#39;t mean it isn&#39;t a problem -- just that we haven&#39;t yet figured out what the problem could be in a way that lets us reproduce it. We may need more information; but what, exactly? Unless somebody has a concrete suggestion for what&#39;s missing, I don&#39;t think the &quot;no MWE&quot; reason for closing applies, either."}, {"owner": {"reputation": 5481, "user_id": 2913106, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/cM7Yq.jpg?s=128&g=1", "display_name": "flawr", "link": "https://stackoverflow.com/users/2913106/flawr"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1465057342, "post_id": 37631576, "comment_id": 62746712, "body": "@DanielWagner Thank you, now we are on the right track. I&#39;ve had another (unrelated) function in the file. If I comment that function out, the problem dissappears. Still very strange, I updated the question again. Right now I&#39;m trying to figure out why the presence of <code>f</code> causes this problem."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1465108590, "post_id": 37631576, "comment_id": 62758665, "body": "@DanielWagner Yes I know. I just wanted to show a different approach that didn&#39;t involve <code>!!</code> which is generally an evil operation. The correct alternative for infinite lists could be <code>listToTuples (x:y:xs) = (x,y) : listToTuples xs</code> which is more or less what <code>chunksOf 2</code> does (except that produces lists instead of tuples and works with finite lists too)"}], "answers": [{"comments": [{"owner": {"reputation": 5481, "user_id": 2913106, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/cM7Yq.jpg?s=128&g=1", "display_name": "flawr", "link": "https://stackoverflow.com/users/2913106/flawr"}, "edited": false, "score": 0, "creation_date": 1465058121, "post_id": 37632548, "comment_id": 62746968, "body": "Thank you very much your answer (and your patience)! I now learned that I should check my types more. (But type signatures are so wasteful in <i>code-golf</i> =)"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 6, "last_activity_date": 1465057781, "creation_date": 1465057781, "answer_id": 37632548, "question_id": 37631576, "link": "https://stackoverflow.com/questions/37631576/creating-tuples-from-infinite-list/37632548#37632548", "title": "creating tuples from infinite list", "body": "<p>The addition of <code>f</code> forces your primes to have type <code>Int</code>, which does overflow during the factorial operation. The reasoning goes like this:</p>\n\n<ol>\n<li><code>take :: Int -&gt; [a] -&gt; [a]</code></li>\n<li>In <code>f n</code>, the use of <code>take n p</code> forces <code>n :: Int</code>.</li>\n<li>Because the arguments to <code>order</code> must have the same type, the calls <code>order r n</code> and <code>order s n</code> force <code>r, s :: Int</code>.</li>\n<li><code>(r, s) &lt;- take n p</code> forces <code>p :: [(Int, Int)]</code></li>\n<li><code>p = listtotuples primes</code> forces <code>primes :: [Int]</code></li>\n</ol>\n\n<p>Simple fixes include breaking steps 2 or 3 above; use <code>take (fromInteger n) p</code> to break step 2 or <code>order s (fromIntegral n)</code> and <code>order r (fromIntegral n)</code> to break step 3.</p>\n\n<p>...and now you know why adding top-level type signatures is considered a best practice. =)</p>\n"}], "owner": {"reputation": 5481, "user_id": 2913106, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/cM7Yq.jpg?s=128&g=1", "display_name": "flawr", "link": "https://stackoverflow.com/users/2913106/flawr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 155, "favorite_count": 0, "accepted_answer_id": 37632548, "answer_count": 1, "score": 3, "last_activity_date": 1465057781, "creation_date": 1465051982, "last_edit_date": 1492087139, "question_id": 37631576, "link": "https://stackoverflow.com/questions/37631576/creating-tuples-from-infinite-list", "title": "creating tuples from infinite list", "body": "<p>When trying to solve <a href=\"https://codegolf.stackexchange.com/questions/81253/swap-prime-exponents-with-their-neighbours\">this challenge</a> I stumbled upon something I was not able to explain myself.</p>\n\n<p>First I generate an infinite list of prime numbers as follows:</p>\n\n<pre><code>primes = [n|n&lt;-[2..],product[1..n-1]`rem`n==n-1]\n</code></pre>\n\n<p>This has the inferred type <code>[Integer]</code> so Int-overflow should not be a problem.</p>\n\n<p>Then I try to make 2-tuples of subsequent primes (goal: <code>[(2,3),(5,7),...]</code>). To achieve this I wrote another function:</p>\n\n<pre><code>listtotuples l=[ (l!!i, l!!(i+1) ) |i&lt;-[0,2..]]\n</code></pre>\n\n<p>Strangely this <code>listtotuples</code> function seems to work fine on e.g. <code>[0..]</code>, but it just stops working when I apply it to <code>primes</code>, the output is just (after interrupting)</p>\n\n<pre><code>[(2,3),(5,7),(11,13),(Interrupted.\n</code></pre>\n\n<p>I do not understand why this happens, can anyone explain?</p>\n\n<p><strong>EDIT:</strong> This does not only happen when trying to output the infinite list, but also e.g. using <code>take 10 $ listtotuples primes</code> in Prelude after having loaded a file with the two lines from above. It does get stuck at the exact same point.</p>\n\n<p>I am using Windows 7 with GHCi 7.10.2.</p>\n\n<p><strong>EDIT2:</strong> The full contents of my file are as follows:</p>\n\n<pre><code>order p m=head[n-1|n&lt;-[0..],mod m (p^n)&gt;0] \nprimes = [n|n&lt;-[2..],product[1..n-1]`rem`n==n-1]\nlisttotuples l=[ (l!!i, l!!(i+1) ) |i&lt;-[0,2..]]\np=listtotuples primes\nf n=product[r^(order s n) * s^(order r n)|(r,s)&lt;-take n p]\n</code></pre>\n\n<p>The problem disappears as soon as I comment/remove the last line (the function <code>f</code>, but I still think this is very strange, as <code>f</code> is not called and does not have anything todo with the functions above. Also if I replace <code>take n p</code> in the function <code>f</code> with <code>[(2,3)]</code> everything works as defined.</p>\n"}, {"tags": ["haskell", "yesod", "yesod-forms"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 5558619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0daf238ed465f8fec6db6cb0397c603e?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas F", "link": "https://stackoverflow.com/users/5558619/jonas-f"}, "edited": false, "score": 0, "creation_date": 1465073862, "post_id": 37632249, "comment_id": 62751713, "body": "Hi, Sibi. Thanks for the answer, but when i try add this that you posted and try do build i get this error:   The last statement in a &#39;do&#39; block must be an expression       (widget, enctype) &lt;- generateFormPost formUser defaultLayout                            $ do { addStylesheetRemote &quot;<a href=\"http://remote-bootstrap-path.css\" rel=\"nofollow noreferrer\">remote-bootstrap-path.css</a>&quot;;                                   [whamlet|                  &lt;form method=post enctype=#{enctype} action=@{UsuarioR}&gt;                      ^{widget}                      &lt;input type=&quot;submit&quot; value=&quot;Enviar&quot;&gt;            |] }"}, {"owner": {"reputation": 25, "user_id": 5558619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0daf238ed465f8fec6db6cb0397c603e?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas F", "link": "https://stackoverflow.com/users/5558619/jonas-f"}, "edited": false, "score": 0, "creation_date": 1465076716, "post_id": 37632249, "comment_id": 62752451, "body": "Thanks Sib. It Worked, dont know why, no error. Now, to use the BootStrap i just need set the .class of bootstrap in my elemments, Right ?"}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 1, "last_activity_date": 1465055813, "creation_date": 1465055813, "answer_id": 37632249, "question_id": 37631562, "link": "https://stackoverflow.com/questions/37631562/how-add-bootstrap-to-yesodform/37632249#37632249", "title": "How add bootstrap to YesodForm", "body": "<p>You can add it in your <code>Handler</code> function like this:</p>\n\n<pre><code>getUsuarioR :: Handler Html\ngetUsuarioR = do\n       (widget, enctype) &lt;- generateFormPost formUser\n        defaultLayout $ do\n           addStylesheetRemote \"http://remote-bootstrap-path.css\"\n           [whamlet|\n                 &lt;form method=post enctype=#{enctype} action=@{UsuarioR}&gt;\n                     ^{widget}\n                     &lt;input type=\"submit\" value=\"Enviar\"&gt;\n           |]\n</code></pre>\n\n<p>Also if you are new to Haskell, I would suggest you to learn some minimal Haskell before diving into Yesod.</p>\n"}, {"tags": [], "owner": {"reputation": 319, "user_id": 5556960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8461c69f2ceeed1b54eb5c5ae3dd275e?s=128&d=identicon&r=PG&f=1", "display_name": "MarLinn", "link": "https://stackoverflow.com/users/5556960/marlinn"}, "is_accepted": false, "score": 0, "last_activity_date": 1465076327, "creation_date": 1465076327, "answer_id": 37635260, "question_id": 37631562, "link": "https://stackoverflow.com/questions/37631562/how-add-bootstrap-to-yesodform/37635260#37635260", "title": "How add bootstrap to YesodForm", "body": "<p>Especially for a first project I would advise to use the scaffolded site. You can get it by following the quick start guide on the Yesod home page. Not only do you get sensible default settings, but it also has the bootstrap css already integrated.</p>\n\n<p>The downside is of course that the scaffolding throws a lot of stuff and opinions at you that you might not want or not agree with. But even if you don't like the scaffolding, you can always keep one in a separate folder and just take inspiration from it and incorporate parts of it into your own site - like the integration of bootstrap or jquery.</p>\n\n<p>What you need to do next is to add the appropriate classes to your html elements. There are two ways to do that, depending on the context. In your own widgets you just add them like you would any other class (with a point in front of it). If you use code that is generated, for example for forms or for yesod-table, you often have a choice between different rendering functions. For example you can render forms in two columns by using the <em>renderTable</em> rendering function. But there is almost always another function with a name like <em>renderBootstrap</em> which will render the content as plain divs with bootstrap classes.</p>\n\n<p>So all in all Yesod is extremely well integrated with bootstrap. Even too much in my personal opinion. But in your case it should make your task comparatively easy after the initial setup confusion.</p>\n"}], "owner": {"reputation": 25, "user_id": 5558619, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0daf238ed465f8fec6db6cb0397c603e?s=128&d=identicon&r=PG&f=1", "display_name": "Jonas F", "link": "https://stackoverflow.com/users/5558619/jonas-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "accepted_answer_id": 37632249, "answer_count": 2, "score": 0, "last_activity_date": 1465076327, "creation_date": 1465051883, "question_id": 37631562, "link": "https://stackoverflow.com/questions/37631562/how-add-bootstrap-to-yesodform", "title": "How add bootstrap to YesodForm", "body": "<p>I need Help to add BootStrap to My YesodForm Project. Can you help me, guys ?</p>\n\n<p>Thats my code. I just want add BootStrap styles to add to my html components\nI already read aloot tutorials but are complexive, i am new at Haskell. I Need a simples thing just to that simple project. Thank.s</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings, TypeFamilies, QuasiQuotes,\n             TemplateHaskell, GADTs, FlexibleInstances,\n             MultiParamTypeClasses, DeriveDataTypeable,\n             GeneralizedNewtypeDeriving, ViewPatterns, EmptyDataDecls #-}\nimport Yesod\nimport Database.Persist.Postgresql\nimport Data.Text\nimport Text.Lucius\nimport Control.Monad.Logger (runStdoutLoggingT)\n\ndata Pagina = Pagina{connPool :: ConnectionPool}\n\nshare [mkPersist sqlSettings, mkMigrate \"migrateAll\"] [persistLowerCase|\nAnimals json\n   nome Text\n   idade Int\n   deriving Show\n\nUsers json\n   nome Text\n   login Text\n   senha Text\n   deriving Show\n|]\n\nmkYesod \"Pagina\" [parseRoutes|\n/ HomeR GET\n/animal/cadastro AnimalR GET POST\n/animal/checar/#AnimalsId ChecarAnimalR GET\n/erro ErroR GET\n\n/login LoginR GET POST\n/usuario UsuarioR GET POST\n/perfil/#UsersId PerfilR GET\n/admin AdminR GET\n/logout LogoutR GET\n|]\n\ninstance Yesod Pagina where\n    authRoute _ = Just LoginR\n\n    isAuthorized LoginR _ = return Authorized\n    isAuthorized ErroR _ = return Authorized\n    isAuthorized HomeR _ = return Authorized\n    isAuthorized UsuarioR _ = return Authorized\n    isAuthorized AdminR _ = isAdmin\n    isAuthorized _ _ = isUser\n\nisUser = do\n    mu &lt;- lookupSession \"_ID\"\n    return $ case mu of\n        Nothing -&gt; AuthenticationRequired\n        Just _ -&gt; Authorized\n\nisAdmin = do\n    mu &lt;- lookupSession \"_ID\"\n    return $ case mu of\n        Nothing -&gt; AuthenticationRequired\n        Just \"admin\" -&gt; Authorized \n        Just _ -&gt; Unauthorized \"Acesso Restrito para Administrador\"\n\ninstance YesodPersist Pagina where\n   type YesodPersistBackend Pagina = SqlBackend\n   runDB f = do\n       master &lt;- getYesod\n       let pool = connPool master\n       runSqlPool f pool\n\ntype Form a = Html -&gt; MForm Handler (FormResult a, Widget)\n\ninstance RenderMessage Pagina FormMessage where\n    renderMessage _ _ = defaultFormMessage\n------------------------\n\nformAnimal :: Form Animals\nformAnimal = renderDivs $ Animals &lt;$&gt;\n           areq textField \"Nome: \" Nothing &lt;*&gt;\n           areq intField \"Idade: \" Nothing\n\nformUser :: Form Users\nformUser = renderDivs $ Users &lt;$&gt;\n           areq textField \"Nome: \" Nothing &lt;*&gt;\n           areq textField \"Login: \" Nothing &lt;*&gt;\n           areq passwordField \"Password: \" Nothing\n\nformLogin :: Form (Text,Text)\nformLogin = renderDivs $ (,) &lt;$&gt;\n           areq textField \"Login: \" Nothing &lt;*&gt;\n           areq passwordField \"Senha: \" Nothing           \n\ngetAnimalR :: Handler Html\ngetAnimalR = do\n           (widget, enctype) &lt;- generateFormPost formAnimal\n           defaultLayout $ do \n           toWidget [cassius|\n               label\n                   color:blue;\n           |]\n           [whamlet|\n                 &lt;form .form-horizontal method=post enctype=#{enctype} action=@{AnimalR}&gt;\n                     ^{widget}\n                     &lt;input type=\"submit\" value=\"Cadastrar Animal\"&gt;\n           |]\n\ngetPerfilR :: UsersId -&gt; Handler Html\ngetPerfilR uid = do\n      user &lt;- runDB $ get404 uid\n      defaultLayout $ do\n          toWidget $ $(luciusFile \"templates/perfil.lucius\")\n          $(whamletFile \"templates/perfil.hamlet\")\n\ngetUsuarioR :: Handler Html\ngetUsuarioR = do\n           (widget, enctype) &lt;- generateFormPost formUser\n           defaultLayout [whamlet|\n                 &lt;form method=post enctype=#{enctype} action=@{UsuarioR}&gt;\n                     ^{widget}\n                     &lt;input type=\"submit\" value=\"Enviar\"&gt;\n           |]\n\npostAnimalR :: Handler Html\npostAnimalR = do\n           ((result, _), _) &lt;- runFormPost formAnimal\n           case result of \n               FormSuccess anim -&gt; (runDB $ insert anim) &gt;&gt;= \\piid -&gt; redirect (ChecarAnimalR piid)\n               _ -&gt; redirect ErroR\n\npostUsuarioR :: Handler Html\npostUsuarioR = do\n           ((result, _), _) &lt;- runFormPost formUser\n           case result of \n               FormSuccess user -&gt; (runDB $ insert user) &gt;&gt;= \\piid -&gt; redirect (PerfilR piid)\n               _ -&gt; redirect ErroR\n\ngetHomeR :: Handler Html\ngetHomeR = defaultLayout [whamlet|Hello World!|]\n\naddStyle :: Widget\naddStyle = addStylesheetRemote \"http://netdna.bootstrapcdn.com/twitter-bootstrap/2.1.0/css/bootstrap-combined.min.css\"\n\ngetAdminR :: Handler Html\ngetAdminR = defaultLayout [whamlet|\n    &lt;b&gt;&lt;h1&gt;&lt;font size=\"11\"&gt; Bem vindo ao Painel Administrativo&lt;/font&gt;&lt;/h1&gt;&lt;/b&gt;\n|]\n\ngetLoginR :: Handler Html\ngetLoginR = do\n           (widget, enctype) &lt;- generateFormPost formLogin\n           defaultLayout [whamlet|\n                 &lt;form method=post enctype=#{enctype} action=@{LoginR}&gt;\n                     ^{widget}\n                     &lt;input type=\"submit\" value=\"Login\"&gt;\n           |]\n\npostLoginR :: Handler Html\npostLoginR = do\n           ((result, _), _) &lt;- runFormPost formLogin\n           case result of \n               FormSuccess (\"admin\",\"eitapleuga\") -&gt; setSession \"_ID\" \"admin\" &gt;&gt; redirect AdminR\n               FormSuccess (login,senha) -&gt; do \n                   user &lt;- runDB $ selectFirst [UsersLogin ==. login, UsersSenha ==. senha] []\n                   case user of\n                       Nothing -&gt; redirect LoginR\n                       Just (Entity pid u) -&gt; setSession \"_ID\" (pack $ show $ fromSqlKey pid) &gt;&gt; redirect (PerfilR pid)\n\ngetChecarAnimalR :: AnimalsId -&gt; Handler Html\ngetChecarAnimalR pid = do\n    animal &lt;- runDB $ get404 pid\n    defaultLayout  [whamlet|\n    &lt;font size=\"10\"&gt;Perfil do Pet&lt;/font&gt;&lt;br&gt;\n        &lt;p&gt;&lt;b&gt; Nome do Pet:&lt;/b&gt;  #{animalsNome animal}  \n        &lt;p&gt;&lt;b&gt; Idade do Pet:&lt;/b&gt; #{show $ animalsIdade animal} Anos\n    |]\n\ngetErroR :: Handler Html\ngetErroR = defaultLayout [whamlet|\n    &lt;h1&gt;Falha no Cadastro !&lt;/h1&gt;\n|]\n\ngetLogoutR :: Handler Html\ngetLogoutR = do\n     deleteSession \"_ID\"\n     defaultLayout [whamlet| \n         &lt;h1&gt; &lt;b&gt;Logout&lt;/b&gt; efetuado com sucesso! &lt;/h1&gt;\n     |]\n\nconnStr = \"dbname=d4673as0stmsm7 host=ec2-54-221-225-242.compute-1.amazonaws.com user=nzjfptmglfomng password=fyYms4A9T8gkP4_Go8GswcfIiE port=5432\"\n</code></pre>\n\n<p>main::IO()\nmain = runStdoutLoggingT $ withPostgresqlPool connStr 10 $ \\pool -> liftIO $ do \n       runSqlPersistMPool (runMigration migrateAll) pool\n       warp 8080 (Pagina pool)</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 1, "creation_date": 1465049238, "post_id": 37631033, "comment_id": 62744013, "body": "What&#39;s your <code>main</code> function?"}, {"owner": {"reputation": 319, "user_id": 4989750, "user_type": "registered", "accept_rate": 48, "profile_image": "https://graph.facebook.com/10155683297590191/picture?type=large", "display_name": "BarneyL. BarStin", "link": "https://stackoverflow.com/users/4989750/barneyl-barstin"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1465049279, "post_id": 37631033, "comment_id": 62744030, "body": "@ErikR is this: module Main where    main::IO() main = undefined"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1465049684, "post_id": 37631033, "comment_id": 62744168, "body": "you are trying to open <code>.</code> and <code>..</code> (those are included see <a href=\"https://hackage.haskell.org/package/directory-1.2.6.3/docs/System-Directory.html#v:getDirectoryContents\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/directory-1.2.6.3/docs/&hellip;</a>) - you should probably start by using <code>listDirectory</code> instead"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1465049796, "post_id": 37631033, "comment_id": 62744205, "body": "as a nice exercise you should try to use <code>doesFileExist</code>to check if the thing you are trying to open is indeed a file"}], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 2, "last_activity_date": 1465049668, "creation_date": 1465049668, "answer_id": 37631248, "question_id": 37631033, "link": "https://stackoverflow.com/questions/37631033/my-haskell-code-have-error-to-openfile-with-haskell/37631248#37631248", "title": "My haskell code have error to openFile with haskell", "body": "<p>Again, don't use <code>unsafePerformIO</code>.</p>\n\n<p>I bet your problem is that <code>getDirectoryContents</code> returns <code>.</code> and <code>..</code> which are directories.</p>\n\n<p>At the very least I would filter those out. If the directory has any sub-directories you will also need to filter those out.</p>\n\n<p>Also, I would become familiar with Control.Monad. Try something like this:</p>\n\n<pre><code>import Control.Monad (forM)\nimport Data.List  (isPrefixOf)\n\nreader = do setCurrentDirectory ...\n            paths &lt;- getDirectoryContents dir\n            let files = filter (not . isPrefixOf \".\") paths\n            forM files $ \\file -&gt; do\n              putStrLn $ \"processing \" ++ file\n              leerDocumento file\n</code></pre>\n\n<p>Now you can get rid of <code>unsafePerformIO</code> and <code>leerDocumentos</code>.</p>\n"}], "owner": {"reputation": 319, "user_id": 4989750, "user_type": "registered", "accept_rate": 48, "profile_image": "https://graph.facebook.com/10155683297590191/picture?type=large", "display_name": "BarneyL. BarStin", "link": "https://stackoverflow.com/users/4989750/barneyl-barstin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 37631248, "answer_count": 1, "score": -1, "last_activity_date": 1465050068, "creation_date": 1465048397, "last_edit_date": 1465050068, "question_id": 37631033, "link": "https://stackoverflow.com/questions/37631033/my-haskell-code-have-error-to-openfile-with-haskell", "title": "My haskell code have error to openFile with haskell", "body": "<p>Im beginner and im trying to read files of a folder calles \"papers\"(you can see the tree of my project in the attached file). Im using this code for do it:\n<a href=\"https://i.stack.imgur.com/92ixG.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/92ixG.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>module LeerDocumentos2 where\nimport System.Directory\nimport System.IO.Unsafe\nimport System.IO()\nimport Documento\n\n\nreader :: IO [Documento]\nreader = do\n    setCurrentDirectory \"papers\"\n    directorio &lt;- getCurrentDirectory\n    putStrLn directorio       -- Directorio donde estan los documentos\n    pathFicheros &lt;- getDirectoryContents directorio\n    printAll pathFicheros\n    return (leerDocumentos pathFicheros)\nprintAll xs = if null xs        -- If the list is empty\n        then return ()              -- then we're done, so we quit.\n        else do print (head xs)     -- Otherwise, print the first element\n                printAll (tail xs)  -- then print all the other elements.\n\nleerDocumentos :: [FilePath] -&gt; [Documento]\nleerDocumentos [] = []\nleerDocumentos (x:xs) = do\n                    let documento = unsafePerformIO (leerDocumento x)\n                    [documento]++ leerDocumentos xs\nleerDocumento :: String -&gt; IO Documento\nleerDocumento ruta = do\n                putStrLn ruta\n                texto &lt;- readFile ruta\n                let docuAux = lines texto\n                let revista = obtenerRevista docuAux\n                let idd = obtenerID docuAux\n                let anno = obtenerAnno docuAux\n                let titulo = obtenerTitulo docuAux\n                let resumen = obtenerResumen docuAux\n                let secciones = obtenerSecciones docuAux\n                let documento = D (revista,idd,anno,titulo,resumen,secciones)\n                return documento\n\nobtenerRevista :: [String] -&gt; String\nobtenerRevista [] = []\nobtenerRevista texto = head texto\n\nobtenerID:: [String] -&gt; String\nobtenerID [] = []\nobtenerID texto =  head (drop 1 (texto))\n\nobtenerAnno:: [String] -&gt; String\nobtenerAnno [] = []\nobtenerAnno texto =  head (drop 2 (texto))\n\nobtenerTitulo:: [String] -&gt; String\nobtenerTitulo [] = []\nobtenerTitulo texto =  head (drop 4 (texto))\n\nobtenerResumen:: [String] -&gt; String\nobtenerResumen [] = []\nobtenerResumen texto =  head (drop 6 (texto))\n\nobtenerSecciones :: [String]-&gt;[String]\nobtenerSecciones [] = []\nobtenerSecciones texto = quitarSeparador (drop 8 (texto))\n\nquitarSeparador :: [String] -&gt; [String]\nquitarSeparador [] = []\nquitarSeparador (s:sn) = if s == \"--\" || length s &lt;= 1 then --Para quitar lineas blancas\n                            quitarSeparador sn\n                          else\n                            s:quitarSeparador sn\n</code></pre>\n\n<p>but im having the next error:</p>\n\n<p>*** Exception: .: openFile: inappropriate type (is a directory)</p>\n\n<p>Someone can help me please?</p>\n"}, {"tags": ["java", "haskell", "category-theory"], "comments": [{"owner": {"reputation": 5008, "user_id": 2088822, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c96b4e7fa4e410b2df9513f79cffd0fe?s=128&d=identicon&r=PG", "display_name": "afsantos", "link": "https://stackoverflow.com/users/2088822/afsantos"}, "edited": false, "score": 0, "creation_date": 1465047958, "post_id": 37630864, "comment_id": 62743648, "body": "Is there a reason why you haven&#39;t used <code>EndoFunctor&lt;Y&gt; fmap(Function&lt;X,Y&gt; map)</code> instead? This way, each instance would use its instance variables. I.e., <code>return new Id&lt;&gt;(map.apply(this.witness))</code>."}, {"owner": {"reputation": 663, "user_id": 1376095, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/884037b1b8e55abaacc5c6a20a8829d5?s=128&d=identicon&r=PG&f=1", "display_name": "jackb", "link": "https://stackoverflow.com/users/1376095/jackb"}, "reply_to_user": {"reputation": 5008, "user_id": 2088822, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c96b4e7fa4e410b2df9513f79cffd0fe?s=128&d=identicon&r=PG", "display_name": "afsantos", "link": "https://stackoverflow.com/users/2088822/afsantos"}, "edited": false, "score": 0, "creation_date": 1465048513, "post_id": 37630864, "comment_id": 62743794, "body": "Well, I don&#39;t think that this observation could answer my question. Your map (<code>fmap2(x)</code>) is definable as <code>fmap(x,this)</code>, so this does not really solve the type problem."}, {"owner": {"reputation": 663, "user_id": 1376095, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/884037b1b8e55abaacc5c6a20a8829d5?s=128&d=identicon&r=PG&f=1", "display_name": "jackb", "link": "https://stackoverflow.com/users/1376095/jackb"}, "reply_to_user": {"reputation": 5008, "user_id": 2088822, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c96b4e7fa4e410b2df9513f79cffd0fe?s=128&d=identicon&r=PG", "display_name": "afsantos", "link": "https://stackoverflow.com/users/2088822/afsantos"}, "edited": false, "score": 0, "creation_date": 1465048825, "post_id": 37630864, "comment_id": 62743897, "body": "By the way, I defined the function in this way in order to make it resemble more the definition of a functor, that is <a href=\"http://latex.codecogs.com/gif.download?F%5Ccolon%20%28a%5Cto%20b%29%5Cto%20%28Fa%5Cto%20Fb%29\" rel=\"nofollow noreferrer\">F:(a-&gt;b)-&gt;(Fa -&gt; Fb)</a>, where F in this case is the EndoFunctor."}, {"owner": {"reputation": 5008, "user_id": 2088822, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/c96b4e7fa4e410b2df9513f79cffd0fe?s=128&d=identicon&r=PG", "display_name": "afsantos", "link": "https://stackoverflow.com/users/2088822/afsantos"}, "edited": false, "score": 1, "creation_date": 1465048930, "post_id": 37630864, "comment_id": 62743933, "body": "It seemed to me that in your <code>Id</code> implementation you were limiting the range of arguments to instances of <code>Id</code>. I was trying to understand whether an  <code>Id</code> could ever accept an argument of any other Functor type."}, {"owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "edited": false, "score": 1, "creation_date": 1465063153, "post_id": 37630864, "comment_id": 62748577, "body": "You might want to consider trying this in Scala instead because its type system can actual do it. e.g. <code>trait Functor[F[_]] { def fmap[A,B](g: A =&gt; B)(f: F[A]): F[B] }</code>"}, {"owner": {"reputation": 663, "user_id": 1376095, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/884037b1b8e55abaacc5c6a20a8829d5?s=128&d=identicon&r=PG&f=1", "display_name": "jackb", "link": "https://stackoverflow.com/users/1376095/jackb"}, "edited": false, "score": 0, "creation_date": 1465065404, "post_id": 37630864, "comment_id": 62749241, "body": "Good to know. The only problem is that when such functions are called from Java (I have some code that has been already written in Java), such Typecasts are not preserved. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 663, "user_id": 1376095, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/884037b1b8e55abaacc5c6a20a8829d5?s=128&d=identicon&r=PG&f=1", "display_name": "jackb", "link": "https://stackoverflow.com/users/1376095/jackb"}, "edited": false, "score": 0, "creation_date": 1465050984, "post_id": 37631120, "comment_id": 62744599, "body": "This approach solves other issues (with which I will not bore you) that I have later on on my code. Thanks"}], "tags": [], "owner": {"reputation": 26542, "user_id": 3699139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pYdt3.jpg?s=128&g=1", "display_name": "Jorn Vernee", "link": "https://stackoverflow.com/users/3699139/jorn-vernee"}, "is_accepted": true, "score": 8, "last_activity_date": 1465049302, "last_edit_date": 1465049302, "creation_date": 1465048882, "answer_id": 37631120, "question_id": 37630864, "link": "https://stackoverflow.com/questions/37630864/functors-in-java/37631120#37631120", "title": "Functors in Java", "body": "<p>You could use <a href=\"https://en.wikipedia.org/wiki/Curiously_recurring_template_pattern\" rel=\"noreferrer\">CRTP</a>:</p>\n\n<pre><code>interface EndoFunctor&lt;X extends Type, T extends EndoFunctor&lt;X, T&gt;&gt; extends Type {\n    &lt;Y extends Type&gt; EndoFunctor&lt;Y, ?&gt; fmap(Function&lt;X,Y&gt; map, T fx);    \n}\n\nclass Id&lt;X extends Type&gt; implements EndoFunctor&lt;X, Id&lt;X&gt;&gt; {\n    protected X witness;\n    Id(X witness) { this.witness = witness; }\n\n    @Override\n    public &lt;Y extends Type&gt; Id&lt;Y&gt; fmap(Function&lt;X, Y&gt; map, Id&lt;X&gt; fx) {\n        return new Id&lt;&gt;(map.apply(fx.witness));\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 663, "user_id": 1376095, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/884037b1b8e55abaacc5c6a20a8829d5?s=128&d=identicon&r=PG&f=1", "display_name": "jackb", "link": "https://stackoverflow.com/users/1376095/jackb"}, "edited": false, "score": 0, "creation_date": 1465050940, "post_id": 37631131, "comment_id": 62744579, "body": "Your advice has a similar problem as the one described above: by doing this, I only allow one specific returned type."}], "tags": [], "owner": {"reputation": 601, "user_id": 5562621, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-5KTKBm0Brl4/AAAAAAAAAAI/AAAAAAAAABU/3lhB1oMTpN4/photo.jpg?sz=128", "display_name": "Harry Harrison", "link": "https://stackoverflow.com/users/5562621/harry-harrison"}, "is_accepted": false, "score": 2, "last_activity_date": 1465048919, "creation_date": 1465048919, "answer_id": 37631131, "question_id": 37630864, "link": "https://stackoverflow.com/questions/37630864/functors-in-java/37631131#37631131", "title": "Functors in Java", "body": "<p>The problem is not that <code>Id&lt;X&gt;</code> does not match <code>EndoFunctor&lt;X&gt;</code>, but that when you have tried to override <code>fmap</code> you have made the parameter types more specific, and consequently the method signature no longer matches the method signature of <code>fmap</code> in <code>EndoFunctor</code></p>\n\n<p>This means that <code>Id&lt;X&gt;</code> in it's current form does not fully implement the <code>EndoFunctor&lt;X&gt;</code> interface. When implementing an interface, it must be possible to interact with your class without needing to know that it's a different interface.</p>\n\n<p>Either follow the advice in the comments about removing this method parameter and using the instance variable, or modify the signature in <code>Id&lt;X&gt;</code> to <code>public &lt;Y extends Type&gt; Id&lt;Y&gt; fmap(Function&lt;X, Y&gt; map, EndoFunctor&lt;X&gt; fx)</code> to make it compatible with the interface.</p>\n"}, {"comments": [{"owner": {"reputation": 663, "user_id": 1376095, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/884037b1b8e55abaacc5c6a20a8829d5?s=128&d=identicon&r=PG&f=1", "display_name": "jackb", "link": "https://stackoverflow.com/users/1376095/jackb"}, "edited": false, "score": 0, "creation_date": 1465062285, "post_id": 37633181, "comment_id": 62748306, "body": "Actually, I hoped that performing some lifting over types would have helped on that issue. Your answer is formally correct, while the previous one helped me to code. Too bad that I cannot accept two answers at the same time."}], "tags": [], "owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "is_accepted": false, "score": 8, "last_activity_date": 1465062545, "last_edit_date": 1465062545, "creation_date": 1465061847, "answer_id": 37633181, "question_id": 37630864, "link": "https://stackoverflow.com/questions/37630864/functors-in-java/37633181#37633181", "title": "Functors in Java", "body": "<blockquote>\n  <p>How could I determine fmap in the EndoFunctor interface such that if any type K implements EndoFunctor and a map function T->U is given, then K is returned as a value, without any typecasting (that is, since I know that my object is an Id, then the result of fmap \"has to be\" a Id, and hence I downcast the result of type EndoFunctor to such type)?</p>\n</blockquote>\n\n<p>You can't; this is called higher-kinded polymorphism, and Java doesn't support it (very few languages do). Jorn Vernee's answer gets you the closest you can in Java, but that interface allows you to write</p>\n\n<pre><code>class NotId&lt;X extends Type&gt; implements EndoFunctor&lt;X, Id&lt;X&gt;&gt; {\n\n    @Override\n    public &lt;Y extends Type&gt; ADifferentEndoFunctorAgain&lt;Y&gt; fmap(Function&lt;X, Y&gt; map, Id&lt;X&gt; fx) { ... }\n}\n</code></pre>\n\n<p>and won't work if you want to write the code generic over <code>EndoFunctor</code>s instead of working with a <em>specific</em> <code>EndoFunctor</code> like <code>Id</code>.</p>\n"}], "owner": {"reputation": 663, "user_id": 1376095, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/884037b1b8e55abaacc5c6a20a8829d5?s=128&d=identicon&r=PG&f=1", "display_name": "jackb", "link": "https://stackoverflow.com/users/1376095/jackb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 516, "favorite_count": 3, "accepted_answer_id": 37631120, "answer_count": 3, "score": 6, "last_activity_date": 1465062545, "creation_date": 1465047343, "question_id": 37630864, "link": "https://stackoverflow.com/questions/37630864/functors-in-java", "title": "Functors in Java", "body": "<p>I'm trying to define classes in Java that are similar to Haskell's functors. Hereby, a functor is defined as:</p>\n\n<pre><code>/**\n * Programming languages allow only (just simply enough) endofunctor, that are functors from and to the same category.\n * In this case, the category is the one of the datatypes (in here Type, in order to make it more clear)\n */\npublic interface EndoFunctor&lt;X extends Type&gt; extends Type {\n\n    /**\n     * The basic implementation for any element fx\n     * @param map   Transformation function for the type parameter\n     * @param fx    Element of the current class\n     * @param &lt;Y&gt;   Target type\n     * @return      transformed element through map\n     */\n    &lt;Y extends Type&gt; EndoFunctor&lt;Y&gt; fmap(Function&lt;X,Y&gt; map, EndoFunctor&lt;X&gt; fx);\n\n}\n</code></pre>\n\n<p>If I want to implement a <a href=\"https://i.stack.imgur.com/XtbyC.gif\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/XtbyC.gif\" alt=\"Identity Functor over types\"></a> functor, I have to write something like</p>\n\n<pre><code>public class Id&lt;X extends Type&gt; implements EndoFunctor&lt;X&gt; {\n    protected X witness;\n    Id(X witness) { this.witness = witness; }\n    @Override\n    public &lt;Y extends Type&gt; Id&lt;Y&gt; fmap(Function&lt;X, Y&gt; map, Id&lt;X&gt; fx) {\n        return new Id&lt;&gt;(map.apply(fx.witness));\n    }\n}\n</code></pre>\n\n<p>The problem with this code is that <code>Id&lt;X&gt;</code> does not match the type <code>EndoFunctor&lt;X&gt;</code>. How could I determine <code>fmap</code> in the <code>EndoFunctor</code> interface such that if any type <code>K&lt;T&gt;</code> implements <code>EndoFunctor&lt;T&gt;</code> and a map function <code>T-&gt;U</code> is given, then <code>K&lt;U&gt;</code> is returned as a value, without any typecasting (that is, since I know that my object is an <code>Id&lt;T&gt;</code>, then the result of <code>fmap</code> \"has to be\" a <code>Id&lt;U&gt;</code>, and hence I downcast the result of type <code>EndoFunctor&lt;U&gt;</code> to such type)?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 4, "creation_date": 1465043481, "post_id": 37630155, "comment_id": 62742246, "body": "first please forget for now that <code>unsafePerfomIO</code> even exists then use <code>pathFicheros &lt;- getDirectoryContents directorio</code> instead of the <code>let</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1786, "user_id": 4764550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/15506251d83edf00de9f0936d2edf4e2?s=128&d=identicon&r=PG", "display_name": "Christopher Wells", "link": "https://stackoverflow.com/users/4764550/christopher-wells"}, "is_accepted": true, "score": 0, "last_activity_date": 1465780898, "creation_date": 1465780898, "answer_id": 37780696, "question_id": 37630155, "link": "https://stackoverflow.com/questions/37630155/how-i-can-read-files-in-haskell/37780696#37780696", "title": "How i can read files in haskell?", "body": "<p>The issue that you are having is that you are trying to call a function which takes in a <code>[FilePath]</code>, but you are passing into it an <code>IO [FilePath]</code>.</p>\n\n<p>The issue is that the value that you want to pass into the function is encapsulated in the <code>IO</code> Monad. A value is held in the <code>IO</code> Monad whenever an input/output operation is used to calculate it. In this case, the <code>IO</code> Monad is basically saying that some IO was done to create the value, and therefore calling the function that generates the value may not always produce the same output on the same input.</p>\n\n<p>For example, the function <code>getLines</code> gets a line of input from the user, and since the line that the user enters cannot be guaranteed to be the same every time, the function returns an <code>IO String</code> rather than a regular <code>String</code>.</p>\n\n<p>In Haskell, you always want to keep track of when input/output is used. So thus, you generally will not work with functions that take in an IO value and return a non-IO value, as that destroys important context.</p>\n\n<p>Thus, the use of the function <code>unsafePerformIO :: IO a -&gt; a</code> is generally discouraged, as it performs an IO action without keeping track of the fact that IO has been performed.</p>\n\n<hr>\n\n<p>That is the theory behind the issue you are facing, now that you know that, you can figure out how to deal with the issue.</p>\n\n<p>When working with IO values, or any other type of monadic values, you need a way to work with the value held within the monad and temporarily ignore the monadic context around the value.</p>\n\n<p>There are a few ways in which this can be done. In your case, you will probably want to work with do notation, since you are already using it a bit.</p>\n\n<p>Let's take a look at the section where you are having issues:</p>\n\n<pre><code>reader :: IO [Documento]\nreader = do\n    setCurrentDirectory \"papers\"\n    directorio &lt;- getCurrentDirectory\n    putStrLn directorio       -- Directorio donde estan los documentos\n    let pathFicheros = getDirectoryContents directorio\n    return (leerDocumentos pathFicheros)\n</code></pre>\n\n<p>Specifically, the error you are getting is with the following lines:</p>\n\n<pre><code>let pathFicheros = getDirectoryContents directorio\nreturn (leerDocumentos pathFicheros)\n</code></pre>\n\n<p>The issue is that you are trying to call <code>leerDocumentos :: [FilePath] -&gt; [Documento]</code> and pass in <code>pathFicheros</code>, which is of type <code>IO [FIlePath]</code>, since it is obtained from calling <code>getDirectoryContents :: FilePath -&gt; IO [FilePath]</code>.</p>\n\n<p>What you want to do is find a way to work with <code>pathFicheros</code> as just a <code>[FilePath]</code>, but keep the IO context.</p>\n\n<p>Since you are doing all of this in a do block, you can use the <code>&lt;-</code> operator to sort of chuck the IO context up to the do block and assign just the contained value into the constant <code>pathFicheros</code>.</p>\n\n<pre><code>pathFicheros &lt;- getDirectoryContents directorio\nreturn (leerDocumentos pathFicheros)\n</code></pre>\n\n<p>That way, you can work with <code>pathFicheros</code> as a <code>[FilePath]</code>, but keep the IO context within the value returned by the <code>reader :: IO [Documento]</code> function.</p>\n\n<p>Once you make that change, the code should compile without issue.</p>\n\n<p>However, you will also want to remove your usage of <code>unsafePerformIO</code> in <code>leerDocumentos</code> and replace it with the proper functionality in the do block, which should then return an <code>IO [Documento]</code> instead of just a <code>[Documento]</code>. After that you just need to remove the use of <code>return</code> at the end of <code>reader</code>, leaving in the stuff within the <code>return</code>, and you should be good.</p>\n\n<p>I recommend that you do some reading on and experimenting with monads, and common functions work working with monads, such as the \"bind\" function <code>&gt;&gt;=</code>, and that should help you to get a better understanding of how to work with monads such as <code>IO</code>.</p>\n\n<p>Monads are a difficult concept to grasp at first in Haskell, but the best thing you can do to get better at working with them is to read up on them and try to implement the ideas you are reading about.</p>\n"}], "owner": {"reputation": 319, "user_id": 4989750, "user_type": "registered", "accept_rate": 48, "profile_image": "https://graph.facebook.com/10155683297590191/picture?type=large", "display_name": "BarneyL. BarStin", "link": "https://stackoverflow.com/users/4989750/barneyl-barstin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 37780696, "answer_count": 1, "score": -2, "last_activity_date": 1465780898, "creation_date": 1465042785, "last_edit_date": 1465058457, "question_id": 37630155, "link": "https://stackoverflow.com/questions/37630155/how-i-can-read-files-in-haskell", "title": "How i can read files in haskell?", "body": "<p>Im beginner and im trying to read files from my folder \"papers\"(in the same path that the scripts), but i have the next error:</p>\n\n<pre><code>Couldn't match expected type \u2018[FilePath]\u2019\n                with actual type \u2018IO [FilePath]\u2019\n    In the first argument of \u2018leerDocumentos\u2019, namely \u2018pathFicheros\u2019\n    In the first argument of \u2018return\u2019, namely\n      \u2018(leerDocumentos pathFicheros)\u2019\n</code></pre>\n\n<p>Maybe this is not the one error that i have on my code, so i hope that someone can help me to complete my module.</p>\n\n<p>The code of my reader:</p>\n\n<pre><code>module LeerDocumentos2 where\nimport System.Directory\nimport System.IO.Unsafe\nimport System.IO()\nimport Documento\n\n\nreader :: IO [Documento]\nreader = do\n    setCurrentDirectory \"papers\"\n    directorio &lt;- getCurrentDirectory\n    putStrLn directorio       -- Directorio donde estan los documentos\n    let pathFicheros = getDirectoryContents directorio\n    return (leerDocumentos pathFicheros)\n\nleerDocumentos :: [FilePath] -&gt; [Documento]\nleerDocumentos [] = []\nleerDocumentos (x:xs) = do\n                    let documento = unsafePerformIO (leerDocumento x)\n                    [documento]++ leerDocumentos xs\nleerDocumento :: String -&gt; IO Documento\nleerDocumento ruta = do\n                putStrLn ruta\n                texto &lt;- readFile ruta\n                let docuAux = lines texto\n                let revista = obtenerRevista docuAux\n                let idd = obtenerID docuAux\n                let anno = obtenerAnno docuAux\n                let titulo = obtenerTitulo docuAux\n                let resumen = obtenerResumen docuAux\n                let secciones = obtenerSecciones docuAux\n                let documento = D (revista,idd,anno,titulo,resumen,secciones)\n                return documento\n\nobtenerRevista :: [String] -&gt; String\nobtenerRevista [] = []\nobtenerRevista texto = head texto\n\nobtenerID:: [String] -&gt; String\nobtenerID [] = []\nobtenerID texto =  head (drop 1 (texto))\n\nobtenerAnno:: [String] -&gt; String\nobtenerAnno [] = []\nobtenerAnno texto =  head (drop 2 (texto))\n\nobtenerTitulo:: [String] -&gt; String\nobtenerTitulo [] = []\nobtenerTitulo texto =  head (drop 4 (texto))\n\nobtenerResumen:: [String] -&gt; String\nobtenerResumen [] = []\nobtenerResumen texto =  head (drop 6 (texto))\n\nobtenerSecciones :: [String]-&gt;[String]\nobtenerSecciones [] = []\nobtenerSecciones texto = quitarSeparador (drop 8 (texto))\n\nquitarSeparador :: [String] -&gt; [String]\nquitarSeparador [] = []\nquitarSeparador (s:sn) = if s == \"--\" || length s &lt;= 1 then --Para quitar lineas blancas\n                            quitarSeparador sn\n                          else\n                            s:quitarSeparador sn\n</code></pre>\n\n<p>and this is the code of my module Documento:</p>\n\n<p>module Documento where</p>\n\n<pre><code>data Documento = Documento {revista :: String, idD :: String, anno :: String, titulo :: String, resumen :: String, secciones :: [String]} deriving (Eq)\ntype Documentos = [Documento]\n</code></pre>\n\n<p>thanks!!</p>\n"}, {"tags": ["haskell", "porting", "frege"], "answers": [{"tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": true, "score": 4, "last_activity_date": 1465042520, "creation_date": 1465042520, "answer_id": 37630118, "question_id": 37629983, "link": "https://stackoverflow.com/questions/37629983/which-projects-have-been-ported-successfully-from-haskell-to-frege/37630118#37630118", "title": "Which projects have been ported successfully from Haskell to Frege?", "body": "<p>Almost all of the existing library code (i.e. Prelude, Data, etc.) have been ported. Also things like QuickCheck, with almost no adaptions.</p>\n\n<p>An interesting case is <code>Data.HashMap</code> which has the same interface as in Haskell, but the implementation relies on Java arrays.</p>\n\n<p>Things to watch out for: unsupported GHC extensions, Strings/Text, code that uses foreign functions (that is, C).</p>\n\n<p>In such cases the Frege analogue of Haskell is usually slightly different, or misses features. Examples would be JSON support and parser combinator libraries (Data.MicroParsec).</p>\n"}], "owner": {"reputation": 1381, "user_id": 2950946, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0004950ef51b069a6150b456ea7a73da?s=128&d=identicon&r=PG&f=1", "display_name": "Stefanus", "link": "https://stackoverflow.com/users/2950946/stefanus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "closed_date": 1465042795, "accepted_answer_id": 37630118, "answer_count": 1, "score": 2, "last_activity_date": 1465042520, "creation_date": 1465041603, "question_id": 37629983, "link": "https://stackoverflow.com/questions/37629983/which-projects-have-been-ported-successfully-from-haskell-to-frege", "closed_reason": "Not suitable for this site", "title": "Which projects have been ported successfully from Haskell to Frege?", "body": "<p>I'd like to learn how to port Haskell code to Frege. Are there any projects that have already been ported and serve as good examples?</p>\n"}, {"tags": ["haskell", "haskell-stack", "hspec"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1465042273, "post_id": 37629948, "comment_id": 62741867, "body": "why don&#39;t you use one of the <code>stack</code> templates? - btw: <b>what</b> exactly does not work - do you get an error message or something? Can you run your tests in ghci?"}, {"owner": {"reputation": 9225, "user_id": 3248346, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/377f7423a286949201e0aa8cb2257fcc?s=128&d=identicon&r=PG&f=1", "display_name": "M.K.", "link": "https://stackoverflow.com/users/3248346/m-k"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1465044875, "post_id": 37629948, "comment_id": 62742647, "body": "there&#39;s no error message - I just want all the specs to run automatically when I run stack test. At the moment it does not find any of the other specs apart from Spec.hs which I have specified in the cabal file."}], "answers": [{"comments": [{"owner": {"reputation": 9225, "user_id": 3248346, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/377f7423a286949201e0aa8cb2257fcc?s=128&d=identicon&r=PG&f=1", "display_name": "M.K.", "link": "https://stackoverflow.com/users/3248346/m-k"}, "edited": false, "score": 0, "creation_date": 1465044412, "post_id": 37630066, "comment_id": 62742507, "body": "I added the above to my test/Specs.hs file as you have done in your example. I changed my cabal file back to Specs.hs being my main file. When I run stack test it does not pick up my other test module located in test/Foo.hs."}, {"owner": {"reputation": 9225, "user_id": 3248346, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/377f7423a286949201e0aa8cb2257fcc?s=128&d=identicon&r=PG&f=1", "display_name": "M.K.", "link": "https://stackoverflow.com/users/3248346/m-k"}, "edited": false, "score": 0, "creation_date": 1465045498, "post_id": 37630066, "comment_id": 62742831, "body": "finally got it working - I had to have the same directory layout in my test directory as my src directory."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 5, "last_activity_date": 1465042511, "last_edit_date": 1465042511, "creation_date": 1465042169, "answer_id": 37630066, "question_id": 37629948, "link": "https://stackoverflow.com/questions/37629948/setting-up-a-test-suite-in-hspec/37630066#37630066", "title": "Setting up a test suite in HSpec", "body": "<p>Here is some docs on hspec testing:</p>\n\n<p><a href=\"http://hspec.github.io/hspec-discover.html\" rel=\"noreferrer\">http://hspec.github.io/hspec-discover.html</a></p>\n\n<p>If your main spec module contains just the lines:</p>\n\n<pre><code>{-# OPTIONS_GHC -F -pgmF hspec-discover #-}\n</code></pre>\n\n<p><code>hspec-discover</code> will scan the directory tree for spec tests.</p>\n\n<p>Also - here is a small hspec example:</p>\n\n<p><a href=\"https://github.com/hspec/hspec-example\" rel=\"noreferrer\">https://github.com/hspec/hspec-example</a></p>\n"}], "owner": {"reputation": 9225, "user_id": 3248346, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/377f7423a286949201e0aa8cb2257fcc?s=128&d=identicon&r=PG&f=1", "display_name": "M.K.", "link": "https://stackoverflow.com/users/3248346/m-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 965, "favorite_count": 0, "accepted_answer_id": 37630066, "answer_count": 1, "score": 1, "last_activity_date": 1465042511, "creation_date": 1465041371, "question_id": 37629948, "link": "https://stackoverflow.com/questions/37629948/setting-up-a-test-suite-in-hspec", "title": "Setting up a test suite in HSpec", "body": "<p>How do I specify test suites in HSpec? I'm going to have multiple <code>*.hs</code> test files for each of my modules and I want to just run <code>stack test</code> and for all of the tests to run. How do I set that up?</p>\n\n<p>I tried to list the test modules like this in my cabal file but it doesn't work:</p>\n\n<pre><code>test-suite foo-test\n  type:                exitcode-stdio-1.0\n  hs-source-dirs:      test\n  main-is:             Spec.hs\n                     , Mod1Spec.hs\n  build-depends:       base\n                     , containers &gt;= 0.5.6.2\n                     , hqfl\n                     , hspec &gt;= 2.2.3\n                     , hspec &gt;= 2.2.3\n                     , mtl &gt;= 2.2.1\n                     , pipes &gt;= 4.1.8\n                     , random &gt;= 1.1\n  ghc-options:         -threaded -rtsopts -with-rtsopts=-N\n  default-language:    Haskell2010\n</code></pre>\n"}, {"tags": ["haskell", "applicative"], "comments": [{"owner": {"reputation": 40537, "user_id": 465378, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c03b8d34978563858020eff0d14cc17b?s=128&d=identicon&r=PG", "display_name": "Alexis King", "link": "https://stackoverflow.com/users/465378/alexis-king"}, "edited": false, "score": 4, "creation_date": 1465024717, "post_id": 37627513, "comment_id": 62737182, "body": "What happens when the lists are of varying lengths? Either you silently lose information (scary) or you have partial functions (even worse). I think making that behavior opt-in makes people more likely to consider the consequences. In contrast, the default Applicative and Monad instances are lossless and therefore less likely to silently cause problems, and are probably just more conceptually satisfying. Plus they generalize the idea of Maybe quite nicely (instead of 0 or 1 values you can encode any number of values, encoding a sort of nondeterminism or ambiguity)."}, {"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 1, "creation_date": 1465027139, "post_id": 37627513, "comment_id": 62737785, "body": "I think the default one is more <code>elementary</code> in a sense similar to <code>free</code> objects in category theory. It preserves the most information and alternatives can be assigned to this default by forgetting some of the information. Here the <code>ZipList</code> forgets about some of the pairs of elements that the default considers. But I am really not too familiar with categories yet so don&#39;t quote me :)"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 6, "creation_date": 1465037582, "post_id": 37628028, "comment_id": 62740505, "body": "I think it would be better to require newtype wrapping for both, so that intent is clealy expressed. Lists don&#39;t have intent."}, {"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 3, "creation_date": 1465072536, "post_id": 37628028, "comment_id": 62751344, "body": "There&#39;s also the fact that we want <code>Applicative</code> and <code>Monad</code> instances to agree; since <code>ZipList</code>s aren&#39;t <code>Monad</code>s, if we want lists to be <code>Monad</code>s, then they have to use the nondeterminism <code>Applicative</code> semantics as well.  (This also prevents the newtype-both-of-them approach: we <i>have</i> to give them an <code>Applicative</code> instance to give them their only possible <code>Monad</code> instance!)"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 15, "last_activity_date": 1465028296, "creation_date": 1465028296, "answer_id": 37628028, "question_id": 37627513, "link": "https://stackoverflow.com/questions/37627513/why-ziplist-is-not-the-default-applicative-instance-for-list/37628028#37628028", "title": "Why ZipList is not the default Applicative Instance for List", "body": "<p>I suspect the honest answer here is \"historical accident\". The monad abstraction was popular before the applicative one was; since there is a natural list monad, that instance was defined. For backwards compatibility, it makes sense to keep the functor and applicative instances consistent moving forward.</p>\n\n<p>That said, if we had to make the choice again today, I think I would support the current situation anyway: the nondeterminism monad is <em>useful</em> as a syntactically cheap backtracking search, and I've taken advantage of that frequently; arbitrary-arity zipping is (in my personal experience) a much less frequent need.</p>\n"}], "owner": {"reputation": 2430, "user_id": 1525842, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/95abedfeb09f68271233421d1aafb3be?s=128&d=identicon&r=PG", "display_name": "zeronone", "link": "https://stackoverflow.com/users/1525842/zeronone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1048, "favorite_count": 1, "accepted_answer_id": 37628028, "answer_count": 1, "score": 7, "last_activity_date": 1465028296, "creation_date": 1465024527, "question_id": 37627513, "link": "https://stackoverflow.com/questions/37627513/why-ziplist-is-not-the-default-applicative-instance-for-list", "title": "Why ZipList is not the default Applicative Instance for List", "body": "<p>I am currently learning Applicatives in Haskell. If I am not wrong, there are two different Applicative instances for Lists, (<code>List</code> and <code>ZipList</code> - the second being defined as a newtype wrapping a List value). The <code>ZipList</code> applicative instances seems more intuitive for me. </p>\n\n<p>It might be a dumb question, but is there a specific reason <code>ZipList</code> is not the default Applicative instance for Lists.</p>\n\n<pre><code>pure (+) &lt;*&gt; [1,2,3] &lt;*&gt; [4,5,6]\n-- [5,6,7,6,7,8,7,8,9]\n\npure (+) &lt;*&gt; ZipList [1,2,3] &lt;*&gt; ZipList [4,5,6]\n-- ZipList [5,7,9]\n</code></pre>\n\n<p>Is it because the distributive version of Applicative List also happens to have a Monad instance?</p>\n"}, {"tags": ["haskell", "zeromq"], "comments": [{"owner": {"reputation": 1, "user_id": 3666197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79fc6c23061326c7e6a6f82a1663634b?s=128&d=identicon&r=PG", "display_name": "user3666197", "link": "https://stackoverflow.com/users/3666197/user3666197"}, "edited": false, "score": 1, "creation_date": 1465009696, "post_id": 37625833, "comment_id": 62734259, "body": "Does the Haskell binding detect &amp; handle a mandatory part of the API <code>REQ&#47;ROUTER</code> behaviour <b>automatically?</b> (<i>cit.:</i> &quot;<b>When</b> a <code>ZMQ_REQ</code> socket is connected to a <code>ZMQ_ROUTER</code> socket, in addition to the identity of the originating peer each message received <b>shall contain</b> an empty <i>delimiter</i> message part. Hence, the entire structure of each received message as seen by the application becomes: one or more <i>identity</i> parts, <i>delimiter</i> part, one or more <i>body</i> parts. <b>When sending replies</b> to a <code>ZMQ_REQ</code> socket the <b>application must</b> include the <b><i>delimiter</i></b> part.&quot; )"}, {"owner": {"reputation": 1, "user_id": 3666197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79fc6c23061326c7e6a6f82a1663634b?s=128&d=identicon&r=PG", "display_name": "user3666197", "link": "https://stackoverflow.com/users/3666197/user3666197"}, "edited": false, "score": 0, "creation_date": 1465010187, "post_id": 37625833, "comment_id": 62734338, "body": "You would also like the full story by Pieter Hintjens&#39; book [ Code Connected, Vol. 1 ], page 97 ( &gt;&gt;&gt; <a href=\"http://hintjens.wdfiles.com/local--files/main%3Afiles/cc1pe.pdf\" rel=\"nofollow noreferrer\">hintjens.wdfiles.com/local--files/main%3Afiles/cc1pe.pdf</a> ), (<i>cit.:</i> &quot;The <code>worker</code> <b>has to save the envelope</b> ( which is all the parts up to and including the empty message frame ) and then it can do what\u2019 s needed with the data part. <b>Note that a <code>REP</code> socket would do this <i>automatically</i>, but we\u2019 re using the <code>REQ-ROUTER</code> pattern ...</b> &quot; )"}, {"owner": {"reputation": 1, "user_id": 3666197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/79fc6c23061326c7e6a6f82a1663634b?s=128&d=identicon&r=PG", "display_name": "user3666197", "link": "https://stackoverflow.com/users/3666197/user3666197"}, "edited": false, "score": 0, "creation_date": 1465010580, "post_id": 37625833, "comment_id": 62734401, "body": "( <i>cit.:</i> We can use <code>ROUTER</code> in two distinct ways: \u2022 As a proxy that switches messages between frontend and backend sockets. \u2022 As an application that reads the message and acts on it. In the first case, the <code>ROUTER</code> simply reads all frames, including the artificial identity frame, and passes them on blindly. In the second case the <code>ROUTER</code> <b>must know</b> the format of the reply envelope it\u2019 s being sent. As the other peer is a <code>REQ</code> socket, the <code>ROUTER</code> gets the identity frame, an empty frame, and then the data frame.&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 0, "creation_date": 1465994578, "post_id": 37645262, "comment_id": 63132714, "body": "<code>when a dealer socket sends a message it strips off the first message frame and uses it as an address</code>. Trying to apply this knowledge to my <code>Req to Router</code> scenario, my problem is that the <code>Router</code> doesn&#39;t know to whom it must send the <code>World</code> reply from the Req&#39;s initial <code>Hello</code>?"}, {"owner": {"reputation": 1450, "user_id": 6216811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1c3f4852b869530a7fcca4d2f1d615e?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6216811/david"}, "reply_to_user": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 1, "creation_date": 1466012377, "post_id": 37645262, "comment_id": 63145081, "body": "Yes, in your case you need to take the first frame received and prepend it, along with an empty frame, to the message you send from the Router. More generally you should take all frames up to an including the empty frame and prepend them in the same order to an outgoing message, this will allow you to chain routers."}, {"owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 0, "creation_date": 1466043776, "post_id": 37645262, "comment_id": 63157138, "body": "Does multi-frame mean the same as multi-part?"}, {"owner": {"reputation": 1450, "user_id": 6216811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1c3f4852b869530a7fcca4d2f1d615e?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6216811/david"}, "reply_to_user": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 1, "creation_date": 1466062544, "post_id": 37645262, "comment_id": 63164076, "body": "Yes. All messages sent to router sockets end up as multi-frame/multi-part due the addition of the routing info."}], "tags": [], "owner": {"reputation": 1450, "user_id": 6216811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1c3f4852b869530a7fcca4d2f1d615e?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/6216811/david"}, "is_accepted": false, "score": 4, "last_activity_date": 1465150780, "creation_date": 1465150780, "answer_id": 37645262, "question_id": 37625833, "link": "https://stackoverflow.com/questions/37625833/why-a-zeromq-req-router-example-does-not-receive-any-message/37645262#37645262", "title": "Why a ZeroMQ REQ / ROUTER Example Does Not Receive Any Message?", "body": "<p>Answering in reverse order...</p>\n\n<p>Your 3 'messages' are the 3 frames of the recieved message. The first frame is added by the <code>Router</code> socket to identify where the message came from. The 2nd is an empty delimiter frame added by the <code>Requester</code> socket and the final frame contains the data you sent. </p>\n\n<p>This leads on to why you don't get a response, when a dealer socket sends a message it strips off the first message frame and uses it as an address to identify the client it needs to reply to. As you aren't saving and appending the first frame received to the outgoing message then it'll just be dropped.</p>\n\n<p>Sadly I don't know enough about the haskell or its zeromq bindings to give you a code solution, but if you receive into an address buffer until you read an empty packet, then read the data packet into the data buffer. When replying send the address buffer, an empty buffer and then the reply.</p>\n"}, {"tags": [], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "is_accepted": true, "score": 1, "last_activity_date": 1466269550, "last_edit_date": 1495535331, "creation_date": 1466171827, "answer_id": 37883499, "question_id": 37625833, "link": "https://stackoverflow.com/questions/37625833/why-a-zeromq-req-router-example-does-not-receive-any-message/37883499#37883499", "title": "Why a ZeroMQ REQ / ROUTER Example Does Not Receive Any Message?", "body": "<p>With <a href=\"https://stackoverflow.com/users/6216811/david\">David's</a> and <a href=\"https://stackoverflow.com/users/3666197/user3666197\">user3666197's</a> responses that I was discarding the <code>identity</code> frame, I came up with:</p>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\n-- Hello World server\n\nmodule Main where\n\nimport Control.Concurrent\nimport Control.Monad\nimport System.ZMQ4.Monadic\nimport Text.Printf\nimport Data.ByteString.Char8 (unpack, pack)\nimport Data.List.NonEmpty\n\nmain :: IO ()\nmain = runZMQ $ do\n    -- Socket to talk to clients\n    responder &lt;- socket Router\n    bind responder \"tcp://*:5555\"\n\n    forever $ do\n        response @ (identity : _ : body : []) &lt;- receiveMulti responder\n        _ &lt;- liftIO $ putStrLn . show . Prelude.length $ response\n        _ &lt;- liftIO $ forM_ response (printf \"received request: %s\\n\" . unpack)\n        liftIO $ putStrLn \"sending world\"\n        sendMulti responder $ identity `cons` (pack \"\" `cons` (pack \"world\" :| []))\n</code></pre>\n\n<p><strong>Running it</strong></p>\n\n<pre><code>-- terminal 1\n$stack exec -- client-exe\nConnecting to hello world server\u2026\nSending Hello 1\u2026\nreceived request: world\n...\n\n--terminal 2\n$stack exec -- router-exe\n3\nreceived request: A\u00a7\nreceived request: \nreceived request: Hello\nsending world  \n...\n</code></pre>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1413, "favorite_count": 1, "accepted_answer_id": 37883499, "answer_count": 2, "score": 2, "last_activity_date": 1466269550, "creation_date": 1465008416, "last_edit_date": 1465307329, "question_id": 37625833, "link": "https://stackoverflow.com/questions/37625833/why-a-zeromq-req-router-example-does-not-receive-any-message", "title": "Why a ZeroMQ REQ / ROUTER Example Does Not Receive Any Message?", "body": "<p><a href=\"https://rads.stackoverflow.com/amzn/click/com/1449334067\" rel=\"nofollow noreferrer\" rel=\"nofollow noreferrer\">ZeroMQ: Messaging for Many Applications</a> comments on <code>REQ -&gt; ROUTER</code> communication:</p>\n\n<blockquote>\n  <p>If we rewrote our \u201cHello World\u201d server using <strong><code>ROUTER</code></strong>, we\u2019d be able to process any number of \u201cHello\u201d requests in parallel.</p>\n</blockquote>\n\n<p>So I typed out <a href=\"http://zguide.zeromq.org/hs:hwclient\" rel=\"nofollow noreferrer\"><strong><code>hwclient.hs</code></strong></a> and have slightly modified the <a href=\"http://zguide.zeromq.org/hs:hwserver\" rel=\"nofollow noreferrer\"><strong><code>hwserver.hs</code></strong></a> from the ZeroMQ Guide:</p>\n\n<h1>Hello World Client</h1>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\n-- Hello World client\n\nmodule Main where\n\nimport Control.Monad\nimport System.ZMQ4.Monadic\n\nmain :: IO ()\nmain = runZMQ $ do\n    liftIO $ putStrLn \"Connecting to hello world server\u2026\"\n\n    requester &lt;- socket Req\n    connect requester \"tcp://localhost:5555\"\n\n    forM_ [1..10] $ \\i -&gt; do\n        liftIO . putStrLn $ \"Sending Hello \" ++ show i ++ \"\u2026\"\n        send requester [] \"Hello\"\n        _ &lt;- receive requester\n        liftIO . putStrLn $ \"Received World \" ++ show i\n</code></pre>\n\n<p>And the Router:</p>\n\n<h1>Hello World Router</h1>\n\n<pre><code>{-# LANGUAGE OverloadedStrings #-}\n\n-- Hello World server\n\nmodule Main where\n\nimport Control.Concurrent\nimport Control.Monad\nimport System.ZMQ4.Monadic\n\nmain :: IO ()\nmain = runZMQ $ do\n    -- Socket to talk to clients\n    responder &lt;- socket Router\n    bind responder \"tcp://*:5555\"\n\n    forever $ do\n        buffer &lt;- receive responder\n        liftIO $ do\n            putStrLn \"Received Hello\"\n            threadDelay 1000000 -- Do some 'work'\n        send responder [] \"World\"\n</code></pre>\n\n<p>But, when I run it, I see the client send a message, but never receive a response.</p>\n\n<pre><code>$stack exec -- client-exe\nConnecting to hello world server\u2026\nSending Hello 1\u2026\n</code></pre>\n\n<p>In my other window, I see the server receives 3 messages and nothing more:</p>\n\n<pre><code>$stack exec -- server-exe\nReceived Hello\nReceived Hello\nReceived Hello\n</code></pre>\n\n<p><strong><code>Q1:</code></strong> Why does the client never receive a reply?<br>\n<strong><code>Q2:</code></strong> And why does the server (<code>ROUTER</code>) receive 3 messages rather than 1?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>I updated <code>hwserver.hs</code> to print out the messages that it receives rather than simply \"Hello\".</p>\n\n<p>Posting the diff:</p>\n\n<pre><code>printf \"received request: %s\\n\" . unpack $ buffer\n</code></pre>\n\n<p>replaced</p>\n\n<pre><code>putStrLn \"Received Hello\"\n</code></pre>\n\n<p>And the server (Router) showed:</p>\n\n<pre><code>$stack exec -- server-exe\nreceived request: A\u00a7\nreceived request: \nreceived request: Hello\n</code></pre>\n\n<p>Lastly, here's the <code>send</code>'s function signature:</p>\n\n<pre><code>\u03bb: :t send\nsend\n  :: Sender t =&gt;\n     Socket z t\n     -&gt; [Flag] -&gt; Data.ByteString.Internal.ByteString -&gt; ZMQ z ()\n</code></pre>\n"}, {"tags": ["haskell", "bytestring", "http-conduit"], "answers": [{"comments": [{"owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "edited": false, "score": 0, "creation_date": 1465005555, "post_id": 37625399, "comment_id": 62733683, "body": "Isn&#39;t this solution going to read the entire lazy bytestring into memory because of <code>L.toStrict</code> call? We want to read one chunk at a time, or place an upper bound on memory usage."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "edited": false, "score": 0, "creation_date": 1465007984, "post_id": 37625399, "comment_id": 62734030, "body": "Well - it shows you how to create some state (an IORef) to keep track of what you&#39;ve already given out. Note that unless you&#39;re using lazy-IO they lazy byte string is already in memory."}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1465023830, "post_id": 37625399, "comment_id": 62736962, "body": "It should probably be said that the updated <code>mklstream</code> relies on the invariant that a lazy bytestring never has an empty bytestring chunk. It would be clearer that it does what <code>http-client</code> wants if the ref were defined with <code>newIORef (filter (not . S.null) (L.toChunks lbs))</code>, but it doesn&#39;t need to do this, if I understand. Then it has the desired structure, which is to be like <a href=\"http://hackage.haskell.org/package/bytestring-0.10.8.1/docs/Data-ByteString.html#v:hGet\" rel=\"nofollow noreferrer\"><code>hGet</code></a>"}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1465024617, "post_id": 37625399, "comment_id": 62737157, "body": "The same result comes more or less prepackaged with <code>io-streams</code>. There you would write <code>ref &lt;- Streams.fromLazyByteString lbs</code> and then the <code>fetch</code> function would be something like <code>fmap (maybe S.empty id) (Streams.read ref)</code>"}, {"owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "reply_to_user": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "edited": false, "score": 0, "creation_date": 1465027753, "post_id": 37625399, "comment_id": 62737921, "body": "@Michael, yep, good point about <code>io-streams</code>. I took a look at the implementation there. Wondering if <code>writeIORef</code> in the code above is efficient because the way it pops top of the stack is by rewriting the new stack after removing the top element. <code>io-streams</code> too has similar logic in <code>makeInputStream</code>. So, it is likely to be efficient, I guess."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 2, "last_activity_date": 1465050348, "last_edit_date": 1465050348, "creation_date": 1465002671, "answer_id": 37625399, "question_id": 37624793, "link": "https://stackoverflow.com/questions/37624793/constructing-requestbodystream-from-lazy-bytestring-when-length-is-known/37625399#37625399", "title": "Constructing RequestBodyStream from Lazy ByteString when length is known", "body": "<p>Is this what you're looking for?</p>\n\n<pre><code>import qualified Data.ByteString as S\nimport qualified Data.ByteString.Lazy as L\nimport System.IO\n\nfile = \"test\"\n-- original streamer for feeding a sink from a file\nstreamer :: (IO S.ByteString -&gt; IO r) -&gt; IO r\nstreamer sink = withFile file ReadMode $ \\h -&gt; sink $ S.hGet h 10240\n\n-- feed a lazy ByteString to sink    \nlstreamer :: L.ByteString -&gt; (IO S.ByteString -&gt; IO r) -&gt; IO r\nlstreamer lbs sink = sink (return (L.toStrict lbs))\n</code></pre>\n\n<p><code>lstreamer</code> type checks but probably doesn't do exactly what you want it to do. It simply returns the same data every time the sink calls it. On the other hand <code>S.hGet h ...</code> will eventually return the empty string.</p>\n\n<p>Here is a solution which uses an IORef to keep track of if we should start returning the empty string:</p>\n\n<pre><code>import Data.IORef\n\nmklstream :: L.ByteString -&gt; (IO S.ByteString -&gt; IO r) -&gt; IO r\nmklstream lbs sink = do\n  ref &lt;- newIORef False\n  let fetch :: IO S.ByteString\n      fetch = do sent &lt;- readIORef ref\n                 writeIORef ref True\n                 if sent\n                   then return S.empty\n                   else return (L.toStrict lbs)\n  sink fetch\n</code></pre>\n\n<p>Here <code>fetch</code> is the action which gets the next chunk. The first time you call it you will get the original lazy Bytestring (strict-ified). Subsequent calls will always return the empty string.</p>\n\n<p><strong>Update</strong></p>\n\n<p>Here's how to give out a small amount at a time:</p>\n\n<pre><code>mklstream :: L.ByteString -&gt; (IO S.ByteString -&gt; IO r) -&gt; IO r\nmklstream lbs sink = do\n  ref &lt;- newIORef (L.toChunks lbs)\n  let fetch :: IO S.ByteString\n      fetch = do chunks &lt;- readIORef ref\n                 case chunks of\n                   [] -&gt; return S.empty\n                   (c:cs) -&gt; do writeIORef ref cs\n                                return c\n  sink fetch\n</code></pre>\n"}], "owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 37625399, "answer_count": 1, "score": 1, "last_activity_date": 1465050348, "creation_date": 1464996192, "question_id": 37624793, "link": "https://stackoverflow.com/questions/37624793/constructing-requestbodystream-from-lazy-bytestring-when-length-is-known", "title": "Constructing RequestBodyStream from Lazy ByteString when length is known", "body": "<p>I am trying to adapt this <a href=\"https://github.com/aristidb/aws/blob/master/Examples/PutObjectIA.hs\" rel=\"nofollow\">AWS S3 upload code</a> to handle <code>Lazy ByteString</code> where length is already known (so that it is not forced to be read in its entirety in memory - it comes over the network where length is sent beforehand). It seems I have to define a <a href=\"https://hackage.haskell.org/package/http-client-0.4.28/docs/Network-HTTP-Client.html#t:GivesPopper\" rel=\"nofollow\"><code>GivesPopper</code></a> function over <code>Lazy ByteString</code> to convert it to <a href=\"http://hackage.haskell.org/package/http-client-0.4.24/docs/Network-HTTP-Client.html#v:RequestBodyStream\" rel=\"nofollow\"><code>RequestBodyStream</code></a>. Because of the convoluted way <code>GivesPopper</code> is defined, I am not sure how to write it for <code>Lazy ByteString</code>. Will appreciate pointers on how to write it. <a href=\"https://github.com/aristidb/aws/blob/master/Examples/PutObjectIA.hs#L27\" rel=\"nofollow\">Here</a> is how it is written for reading from the file:</p>\n\n<pre><code>let file =\"test\"\n-- streams large file content, without buffering more than 10k in memory\nlet streamer sink = withFile file ReadMode $ \\h -&gt; sink $ S.hGet h 10240\n</code></pre>\n\n<p><code>streamer</code> in the code above is of type <code>GivesPopper ()</code> if I understand it correctly.\nGiven a <code>Lazy ByteString</code> with known length <code>len</code>, what would be a good way to write <code>GivesPopper</code> function over it? We can read one chunk at a time.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 140, "user_id": 6364239, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10208962845131414/picture?type=large", "display_name": "Joanna", "link": "https://stackoverflow.com/users/6364239/joanna"}, "edited": false, "score": 0, "creation_date": 1464996443, "post_id": 37624812, "comment_id": 62732073, "body": "I am a real beginner. Could you give me more explanations what I should do? The types are already defined through type definition of ($$$)."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 140, "user_id": 6364239, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10208962845131414/picture?type=large", "display_name": "Joanna", "link": "https://stackoverflow.com/users/6364239/joanna"}, "edited": false, "score": 0, "creation_date": 1464996552, "post_id": 37624812, "comment_id": 62732101, "body": "Well, what&#39;s the mathematical definition of <i>(f.g)(x)</i> ?   <a href=\"https://en.wikipedia.org/wiki/Function_composition\" rel=\"nofollow noreferrer\">Wikipedia article on function composition</a>"}, {"owner": {"reputation": 140, "user_id": 6364239, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10208962845131414/picture?type=large", "display_name": "Joanna", "link": "https://stackoverflow.com/users/6364239/joanna"}, "edited": false, "score": 0, "creation_date": 1464996944, "post_id": 37624812, "comment_id": 62732188, "body": "This does not work either ($$$) (f g) x =  f(y) where y = g(x)"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 140, "user_id": 6364239, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10208962845131414/picture?type=large", "display_name": "Joanna", "link": "https://stackoverflow.com/users/6364239/joanna"}, "edited": false, "score": 0, "creation_date": 1464997165, "post_id": 37624812, "comment_id": 62732242, "body": "Answer updated. Just start with what I&#39;ve written and fill in the <code>...</code>"}, {"owner": {"reputation": 140, "user_id": 6364239, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10208962845131414/picture?type=large", "display_name": "Joanna", "link": "https://stackoverflow.com/users/6364239/joanna"}, "edited": false, "score": 0, "creation_date": 1465029645, "post_id": 37624812, "comment_id": 62738330, "body": "My last answer was almost correct but for the brackets."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 5, "last_activity_date": 1464997157, "last_edit_date": 1464997157, "creation_date": 1464996332, "answer_id": 37624812, "question_id": 37624713, "link": "https://stackoverflow.com/questions/37624713/haskell-write-your-version-of-function/37624812#37624812", "title": "Haskell write your version of (.) function", "body": "<p>From the signature:</p>\n\n<pre><code>($$$) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n</code></pre>\n\n<p>your function needs 3 arguments. So I would start:</p>\n\n<pre><code>($$$) f g x = ...\n      | |  \\\n      | \\   a\n      |  \\\n      |   a-&gt;b\n    b-&gt;c\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>This attempt at defining <code>($$$)</code> does not work:</p>\n\n<pre><code>($$$) (f g) x = ...\n</code></pre>\n\n<p>It says that <code>($$$)</code> takes <em>two</em> arguments. The way I've started to define <code>($$$)</code> says that the function takes three arguments.</p>\n"}, {"tags": [], "owner": {"reputation": 140, "user_id": 6364239, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10208962845131414/picture?type=large", "display_name": "Joanna", "link": "https://stackoverflow.com/users/6364239/joanna"}, "is_accepted": false, "score": 2, "last_activity_date": 1465168017, "last_edit_date": 1465168017, "creation_date": 1464997414, "answer_id": 37624932, "question_id": 37624713, "link": "https://stackoverflow.com/questions/37624713/haskell-write-your-version-of-function/37624932#37624932", "title": "Haskell write your version of (.) function", "body": "<p>Many thanks for your patience. I used brackets where I should not have. I still have problems with looking at everything (including mathematical operators) as a function. Now the idea of (.) is clear. </p>\n\n<pre><code>($$$) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c \n($$$) f g x =  f(g x)\ninfixr 9 $$$\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 2, "last_activity_date": 1464998337, "last_edit_date": 1464998337, "creation_date": 1464997939, "answer_id": 37624992, "question_id": 37624713, "link": "https://stackoverflow.com/questions/37624713/haskell-write-your-version-of-function/37624992#37624992", "title": "Haskell write your version of (.) function", "body": "<p>Are you coming from Lisp? You still seem to assume lists everywhere...</p>\n\n<p>As I already said in the other thread, lists have nothing to do with this task, so neither of <code>(:)</code>, <code>foldr</code> or <code>map</code> can possibly be useful here.</p>\n\n<p>More to the point, the occurence of <code>(g x)</code> in the left-hand side of the definition doesn't make sense. (This is not a list, but apparently you think it should be a kind of &ldquo;argument list&rdquo;).</p>\n\n<p>As a matter of fact, you <em>could</em> define <code>($$$)</code> in <em>un-<a href=\"https://en.wikipedia.org/wiki/Currying\" rel=\"nofollow\">curried</a> form</em> this way:</p>\n\n<pre><code>($$$) :: (b-&gt;c) -&gt; (a-&gt;b, a) -&gt; c\n($$$) f (g, x) = ...\n</code></pre>\n\n<p>...which is exactly the same thing as the more elegant</p>\n\n<pre><code>f $$$ (g, x) = ...\n</code></pre>\n\n<p>In this case, you have an argument <em>tuple</em> <code>(g, x)</code>, which is more or less equivalent to a Lisp list.</p>\n\n<p>In Haskell, we like to write functions curried though. The signature</p>\n\n<pre><code>($$$) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c\n</code></pre>\n\n<p>is in fact parsed as</p>\n\n<pre><code>($$$) :: (b -&gt; c) -&gt; ( (a -&gt; b) -&gt; (a -&gt; c) )\n</code></pre>\n\n<p>Hence the way to define such a function is, at the most fundamental level</p>\n\n<pre><code>($$$) = \\f -&gt; (\\g -&gt; (\\x -&gt; ... ))\n</code></pre>\n\n<p>Which can be written short as</p>\n\n<pre><code>($$$) f g x = ...\n</code></pre>\n\n<p>or</p>\n\n<pre><code>(f $$$ g) x = ...\n</code></pre>\n\n<p>In the actual <em>definition</em> part, you should similarly get the grasp of how things are actually parsed. As you have by now figured out, the composition operator can be defined as</p>\n\n<pre><code>($$$) f g x = f(g(x))\n</code></pre>\n\n<p>In fact, only the outer parentheses are necessary here: the preferred form is</p>\n\n<pre><code>($$$) f g x = f (g x)\n</code></pre>\n\n<p>or indeed</p>\n\n<pre><code>($$$) f g x = f $ g x\n</code></pre>\n\n<p>If something like <code>g x</code> or <code>(f g)</code> appears on its own in an expression, it <em>always</em> means that the left function is applied to the right argument. For <code>f g</code> this doesn't make sense, because though <code>f</code> is a function it can not take another function as its argument, only the <em>result</em> of such a function. Well, to get such a result you need to apply <code>g</code> to an argument!</p>\n"}], "owner": {"reputation": 140, "user_id": 6364239, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10208962845131414/picture?type=large", "display_name": "Joanna", "link": "https://stackoverflow.com/users/6364239/joanna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 0, "accepted_answer_id": 37624992, "answer_count": 3, "score": 2, "last_activity_date": 1465168017, "creation_date": 1464995481, "last_edit_date": 1495540350, "question_id": 37624713, "link": "https://stackoverflow.com/questions/37624713/haskell-write-your-version-of-function", "title": "Haskell write your version of (.) function", "body": "<p>Can someone help me with writing my own version of a (.) function in Haskell?\nFrom this post <a href=\"https://stackoverflow.com/questions/37623871/haskell-write-your-version-of-a-function\">Haskell write your version of a ($) function</a> I know how to determine a type of this function, but I still have the problem with its body.\nI also do not know why ghci refuses to use the name (..). </p>\n\n<pre><code> ($$$) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c \n ($$$) f (g x) = ((f g) $) x\n infixr 9 $$$\n</code></pre>\n\n<p>Another idea of mine was for instance this one:</p>\n\n<pre><code>($$$) :: (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c \n($$$) f (g x) = map (f) (g x)\ninfixr 9 $$$\n</code></pre>\n\n<p>The error message says that \"Parse error in pattern: g\".</p>\n"}, {"tags": ["haskell", "svg", "haskell-diagrams"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1464995333, "post_id": 37624115, "comment_id": 62731783, "body": "Can&#39;t reproduce. The SVG certainly is <i>not</i> cropped, at worst the browser crops the output it renders from it. And <code>frame</code> <i>does</i> add a margin so even this won&#39;t happen (at least in recent versions; I tried it with <code>diagrams-1.3.0.1</code>)."}], "answers": [{"tags": [], "owner": {"reputation": 1943, "user_id": 305559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc113924265dbeb535c8b2fefe4e33ee?s=128&d=identicon&r=PG", "display_name": "Brent Yorgey", "link": "https://stackoverflow.com/users/305559/brent-yorgey"}, "is_accepted": false, "score": 0, "last_activity_date": 1487103964, "creation_date": 1487103964, "answer_id": 42235555, "question_id": 37624115, "link": "https://stackoverflow.com/questions/37624115/haskell-diagrams-svg-clipped/42235555#42235555", "title": "Haskell diagrams SVG clipped", "body": "<p>Sorry I never saw this before; just in case anyone else runs across it: you're right that the tutorial is pulling a bit of a fast one on you, since it automatically wraps all the example diagrams in a <code>frame</code>.  There is no way to tell diagrams to take the width of the line into account when making the envelope (for various reasons that would be very difficult), but you can add some space around the outside of a diagram, e.g. using a function like <code>frame</code> or <code>pad</code>.</p>\n"}], "owner": {"reputation": 26374, "user_id": 229792, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/NIE5f.jpg?s=128&g=1", "display_name": "jameshfisher", "link": "https://stackoverflow.com/users/229792/jameshfisher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 242, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1491911966, "creation_date": 1464991455, "last_edit_date": 1465033324, "question_id": 37624115, "link": "https://stackoverflow.com/questions/37624115/haskell-diagrams-svg-clipped", "title": "Haskell diagrams SVG clipped", "body": "<p>The <a href=\"http://projects.haskell.org/diagrams/doc/quickstart.html\" rel=\"nofollow noreferrer\">quickstart for the <code>diagrams</code> package</a> tells me to compile and run the following program:</p>\n\n<pre><code>{-# LANGUAGE NoMonomorphismRestriction #-}\n\nimport Diagrams.Prelude\nimport Diagrams.Backend.SVG.CmdLine\n\nmain = mainWith (circle 1 :: Diagram B)\n</code></pre>\n\n<p>It them claims:</p>\n\n<blockquote>\n  <p>If you now view circle.svg in your favorite web browser, you should see\n  <img src=\"https://i.stack.imgur.com/hm2mp.png\" alt=\"circle\"></p>\n</blockquote>\n\n<p>However, it doesn't. What I actually see is this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/JzmMr.png\" alt=\"crop circle\"></p>\n\n<p><strong>Notice the cropped edges of the diagram.</strong> This is because the line has a width, but the image is being cropped with the assumption of the line having no width.</p>\n\n<p>Here is the SVG output:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE svg PUBLIC \"-//W3C//DTD SVG 1.1//EN\"\n    \"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd\"&gt;\n&lt;svg\n    xmlns=\"http://www.w3.org/2000/svg\" \n    height=\"200.0000\" stroke-opacity=\"1\" \n    viewBox=\"0 0 200 200\" \n    font-size=\"1\" \n    width=\"200.0000\" \n    xmlns:xlink=\"http://www.w3.org/1999/xlink\" \n    stroke=\"rgb(0,0,0)\" \n    version=\"1.1\"&gt;\n  &lt;defs&gt;&lt;/defs&gt;\n  &lt;g\n      stroke-linejoin=\"miter\" \n      stroke-opacity=\"1.0\" \n      fill-opacity=\"0.0\" \n      stroke=\"rgb(0,0,0)\" \n      stroke-width=\"0.8\" \n      fill=\"rgb(0,0,0)\" \n      stroke-linecap=\"butt\" \n      stroke-miterlimit=\"10.0\"&gt;\n    &lt;path \n      d=\"M 200.0000,100.0000 c 0.0000,-55.2285 -44.7715,-100.0000 -100.0000 -100.0000c -55.2285,-0.0000 -100.0000,44.7715 -100.0000 100.0000c -0.0000,55.2285 44.7715,100.0000 100.0000 100.0000c 55.2285,0.0000 100.0000,-44.7715 100.0000 -100.0000Z\"\n    /&gt;\n  &lt;/g&gt;\n&lt;/svg&gt;\n</code></pre>\n\n<p>How can I tell <code>diagrams</code> to take the width of the line into account when defining the envelope of the diagram?</p>\n"}, {"tags": ["python", "unix", "haskell", "pipe", "tee"], "answers": [{"comments": [{"owner": {"reputation": 37256, "user_id": 736308, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/o5EqQ.jpg?s=128&g=1", "display_name": "cdarke", "link": "https://stackoverflow.com/users/736308/cdarke"}, "edited": false, "score": 0, "creation_date": 1464992309, "post_id": 37624142, "comment_id": 62730905, "body": "Note that <code>script</code> logs non-canonical (raw) user input, not just stdin/out/err.  For example, if the user makes a mistake and presses backspace then everything, including the backspace character, is recorded."}, {"owner": {"reputation": 99, "user_id": 6342264, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01288c6a2a59550030bcff28a8dfb899?s=128&d=identicon&r=PG&f=1", "display_name": "masterchefsenior", "link": "https://stackoverflow.com/users/6342264/masterchefsenior"}, "edited": false, "score": 0, "creation_date": 1465002445, "post_id": 37624142, "comment_id": 62733208, "body": "Right, that&#39;s a bit annoying to parse. Is there another way to do this without <code>script</code>? I just need each line output at the terminal every newline or whatever."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1465003082, "post_id": 37624142, "comment_id": 62733313, "body": "Not without writing your own program that sits in between the user and the application, so it reads the user input and saves it before piping it to the application. I don&#39;t know of anything simple that does this."}], "tags": [], "owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "is_accepted": true, "score": 4, "last_activity_date": 1464992443, "last_edit_date": 1464992443, "creation_date": 1464991589, "answer_id": 37624142, "question_id": 37624020, "link": "https://stackoverflow.com/questions/37624020/how-to-capture-prompts-in-stdout-stderr/37624142#37624142", "title": "How to capture prompts in stdout/stderr?", "body": "<p>You can use the <a href=\"http://man7.org/linux/man-pages/man1/script.1.html\" rel=\"nofollow\"><code>script</code></a> command to capture both input and output.</p>\n\n<pre><code>cmd = 'script hs.log ghci'\n</code></pre>\n\n<p>Note that this captures all the raw input and output from the terminal. You'll see all the user's editing, and if the program is full-screen you'll see all its escape sequences to move the cursor around. See the linked documentation for full details.</p>\n"}], "owner": {"reputation": 99, "user_id": 6342264, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01288c6a2a59550030bcff28a8dfb899?s=128&d=identicon&r=PG&f=1", "display_name": "masterchefsenior", "link": "https://stackoverflow.com/users/6342264/masterchefsenior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 129, "favorite_count": 1, "accepted_answer_id": 37624142, "answer_count": 1, "score": 3, "last_activity_date": 1464992443, "creation_date": 1464990815, "question_id": 37624020, "link": "https://stackoverflow.com/questions/37624020/how-to-capture-prompts-in-stdout-stderr", "title": "How to capture prompts in stdout/stderr?", "body": "<p>I'm trying to record a user's terminal session in a log file; fairly simply, I made a Python wrapper for <code>ghci</code> (interactive Haskell) that looks like:</p>\n\n<pre><code>#!/usr/bin/env python\n\nimport os\n\ncmd = 'ghci 2&gt;&amp;1 | tee hs.log'\nos.system(cmd)\n</code></pre>\n\n<p>However, this only captures what is printed <em>back</em> to the user, and not the prompts/what the user has typed in. So if the session looks like:</p>\n\n<pre><code>$ ghci 2&gt;$1 | tee hs.log\nGHCi, version 7.10.3: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; 1+2\n3\nPrelude&gt; 3+4\n7\nPrelude&gt;\n</code></pre>\n\n<p><code>hs.log</code> only has:</p>\n\n<pre><code>$ cat hs.log\nGHCi, version 7.10.3: http://www.haskell.org/ghc/  :? for help\n3\n7\n</code></pre>\n\n<p>How do you capture both the output and the input during an interactive terminal session?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 22952, "user_id": 210211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8721ff8fa4b5c658058f4a2803231f44?s=128&d=identicon&r=PG", "display_name": "comingstorm", "link": "https://stackoverflow.com/users/210211/comingstorm"}, "edited": false, "score": 2, "creation_date": 1464990647, "post_id": 37623871, "comment_id": 62730387, "body": "Don&#39;t assume the second argument will be a list..."}, {"owner": {"reputation": 140, "user_id": 6364239, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10208962845131414/picture?type=large", "display_name": "Joanna", "link": "https://stackoverflow.com/users/6364239/joanna"}, "reply_to_user": {"reputation": 22952, "user_id": 210211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8721ff8fa4b5c658058f4a2803231f44?s=128&d=identicon&r=PG", "display_name": "comingstorm", "link": "https://stackoverflow.com/users/210211/comingstorm"}, "edited": false, "score": 0, "creation_date": 1464990771, "post_id": 37623871, "comment_id": 62730429, "body": "f function x = f(x) ? Or shall I use foldr somehow?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1464992106, "post_id": 37623871, "comment_id": 62730838, "body": "Please don&#39;t use names like <code>function</code> or <code>list</code>. Names should describe what something <i>does</i>, not what it <i>is</i> (that&#39;s what type signatures are for, which you should BTW also always write out). If you can&#39;t come up with a proper name, then better call it just <code>foo</code> or even <code>test</code> or something."}], "answers": [{"comments": [{"owner": {"reputation": 140, "user_id": 6364239, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10208962845131414/picture?type=large", "display_name": "Joanna", "link": "https://stackoverflow.com/users/6364239/joanna"}, "edited": false, "score": 0, "creation_date": 1464992861, "post_id": 37624139, "comment_id": 62731085, "body": "And &quot;.&quot; function is then function2 f x = f(x) ?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 140, "user_id": 6364239, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10208962845131414/picture?type=large", "display_name": "Joanna", "link": "https://stackoverflow.com/users/6364239/joanna"}, "edited": false, "score": 0, "creation_date": 1464992950, "post_id": 37624139, "comment_id": 62731109, "body": "No. <code>f(x)</code> is just a clunky way of writing <code>f x</code>, so <code>function2</code> is also equivalent to <code>($)</code>."}, {"owner": {"reputation": 140, "user_id": 6364239, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10208962845131414/picture?type=large", "display_name": "Joanna", "link": "https://stackoverflow.com/users/6364239/joanna"}, "edited": false, "score": 0, "creation_date": 1464993237, "post_id": 37624139, "comment_id": 62731197, "body": "Should I ask about (.) a separate question :) ?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 140, "user_id": 6364239, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10208962845131414/picture?type=large", "display_name": "Joanna", "link": "https://stackoverflow.com/users/6364239/joanna"}, "edited": false, "score": 0, "creation_date": 1464993959, "post_id": 37624139, "comment_id": 62731406, "body": "Well, preferrably, you should think about it <i>for yourself</i> a bit more. If you get stuck at some particular point, you can then ask about that particular problem."}, {"owner": {"reputation": 140, "user_id": 6364239, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10208962845131414/picture?type=large", "display_name": "Joanna", "link": "https://stackoverflow.com/users/6364239/joanna"}, "edited": false, "score": 0, "creation_date": 1464995574, "post_id": 37624139, "comment_id": 62731852, "body": "I did, but for a beginner this is not easy. I tried several possible ideas but ghci reports problems..."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 140, "user_id": 6364239, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10208962845131414/picture?type=large", "display_name": "Joanna", "link": "https://stackoverflow.com/users/6364239/joanna"}, "edited": false, "score": 0, "creation_date": 1464995873, "post_id": 37624139, "comment_id": 62731931, "body": "Well, then wrap up your ideas, how you came by them and how they failed in a question. But make sure you did actually try something that you had good reason to expect it could work."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 6, "last_activity_date": 1464991579, "creation_date": 1464991579, "answer_id": 37624139, "question_id": 37623871, "link": "https://stackoverflow.com/questions/37623871/haskell-write-your-version-of-a-function/37624139#37624139", "title": "Haskell write your version of a ($) function", "body": "<p>First, why do you think you need <code>:</code> or <code>foldr</code> here? These are exclusive to lists. <code>$</code> has nothing to do with lists.</p>\n\n<p><code>f function (x) = f (x)</code> is more like it, however it seems you're confused about whether you defining <code>function</code> with <code>f</code> as an argument, or vice versa. In fact, <code>f function (x) = f (x)</code> means this:</p>\n\n<pre><code>f = \\function x -&gt; f x\n</code></pre>\n\n<p>i.e. you're defining <code>f</code> as a function which takes an argument called <code>function</code> (that is never actually used) and another argument <code>x</code> to which it then applies the very function you're defining right here... this kind of recursive knot-tying is actually possible in Haskell (and sometimes quite useful), but in this case it doesn't make any sense.</p>\n\n<p>What you actually want to write is much simpler:</p>\n\n<pre><code>f $ x = f x\n</code></pre>\n\n<p>note that <code>$</code>, because it consists of a non-letter symbol, is an <em>infix</em> and therefore parsed differently:</p>\n\n<pre><code>($) = \\f x -&gt; f x\n</code></pre>\n\n<p>Which means, <code>$</code> takes a function and an argument and applies the function to the argument; that's it.</p>\n\n<p>You could also achieve this with a name with letters by using <em>backticks</em> to have it parsed as an infix:</p>\n\n<pre><code>f `function` x = f x\n</code></pre>\n\n<p>...or simply</p>\n\n<pre><code>function f x = f x\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 4, "last_activity_date": 1464992690, "creation_date": 1464992690, "answer_id": 37624319, "question_id": 37623871, "link": "https://stackoverflow.com/questions/37623871/haskell-write-your-version-of-a-function/37624319#37624319", "title": "Haskell write your version of a ($) function", "body": "<pre><code>% ghci\nGHCi, version 7.10.3: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; :i ($)\n($) :: (a -&gt; b) -&gt; a -&gt; b       -- Defined in \u2018GHC.Base\u2019\ninfixr 0 $\n</code></pre>\n\n<p>So lets just copy and paste, defining our own <code>$$</code> (borrowing the logic from the discussion already presented by @leftaroundabout):</p>\n\n<pre><code>($$) :: (a -&gt; b) -&gt; a -&gt; b\nf $$ x = f x\ninfixr 0 $$\n</code></pre>\n"}], "owner": {"reputation": 140, "user_id": 6364239, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/10208962845131414/picture?type=large", "display_name": "Joanna", "link": "https://stackoverflow.com/users/6364239/joanna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 1, "accepted_answer_id": 37624139, "answer_count": 2, "score": -1, "last_activity_date": 1465036368, "creation_date": 1464990064, "last_edit_date": 1465036368, "question_id": 37623871, "link": "https://stackoverflow.com/questions/37623871/haskell-write-your-version-of-a-function", "title": "Haskell write your version of a ($) function", "body": "<p>Could someone help me with writing my own version of the <code>($)</code> function? \nThis is my attempt which does not work. </p>\n\n<pre><code>f function (x:xs) = f (x:xs)\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 1, "creation_date": 1464988966, "post_id": 37623560, "comment_id": 62729750, "body": "<code>Currency</code> has a <code>Read</code> instance, so how about using <code>read (args !! 1)</code>"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1465072314, "post_id": 37623560, "comment_id": 62751295, "body": "For future searches, it can be helpful to use the term &#39;parse&#39;.  What you are saying is that you want to parse the string and there are many ways to do that, the most simple method being <code>read</code> and <code>Text.Read.readMaybe</code>."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1464990066, "creation_date": 1464990066, "answer_id": 37623872, "question_id": 37623560, "link": "https://stackoverflow.com/questions/37623560/convert-char-to-own-type-in-haskell/37623872#37623872", "title": "Convert [Char] to own type in Haskell", "body": "<p>I have no idea about what <code>verbally</code> requires, but I'm guessing you want this:</p>\n\n<pre><code>main = do\n    args &lt;- getArgs\n    putStrLn $ verbally $ Currency (args !! 0) (args !! 1)\n</code></pre>\n"}], "owner": {"reputation": 994, "user_id": 2349174, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3c97cf2b020c357692218a9c46807ee6?s=128&d=identicon&r=PG", "display_name": "mateuszlewko", "link": "https://stackoverflow.com/users/2349174/mateuszlewko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "accepted_answer_id": 37623872, "answer_count": 1, "score": -2, "last_activity_date": 1464990066, "creation_date": 1464988690, "question_id": 37623560, "link": "https://stackoverflow.com/questions/37623560/convert-char-to-own-type-in-haskell", "title": "Convert [Char] to own type in Haskell", "body": "<p>In one module I have this type:</p>\n\n<pre><code>module Verbally (verbally, Currency) where\nimport Data.String.Utils\n\n    data Currency = Currency {\n    singular :: String,\n    plural :: String\n} deriving (Read, Show)\n\naud = Currency \"Australian Dollar\" \"Australian Dollars\"\nbgn = Currency \"Lev\" \"Levs\"\n</code></pre>\n\n<p>In my second (main) module which looks like this:</p>\n\n<pre><code>main = do\n    args &lt;- getArgs\n    putStrLn $ verbally (args !! 0) (args !! 1)\n</code></pre>\n\n<p>I want to convert args !! 1 to Currency.</p>\n\n<p>Verbally takes Integer and Currency as arguments.</p>\n\n<p>Compilation error:</p>\n\n<pre><code>Couldn't match type \u2018[Char]\u2019 with \u2018Currency\u2019\nExpected type: [Currency]\n  Actual type: [String]\nIn the first argument of \u2018(!!)\u2019, namely \u2018args\u2019\nIn the second argument of \u2018verbally\u2019, namely \u2018(args !! 1)\u2019\n</code></pre>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1464986014, "post_id": 37622761, "comment_id": 62728507, "body": "What does <code>ghc-pkg find-module Text.Show.TimePrint</code> say?"}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 1, "last_activity_date": 1464986129, "creation_date": 1464986129, "answer_id": 37622947, "question_id": 37622761, "link": "https://stackoverflow.com/questions/37622761/how-to-maintain-interactive-print-after-load-or-reload-in-ghci/37622947#37622947", "title": "How to maintain -interactive-print after :load or :reload in ghci?", "body": "<p>You are using GHC 7.10.3; the ticket you linked says that this is fixed <em>after</em> 7.10.3. So you will need to upgrade your GHC to something newer.</p>\n"}], "owner": {"reputation": 99, "user_id": 6342264, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01288c6a2a59550030bcff28a8dfb899?s=128&d=identicon&r=PG&f=1", "display_name": "masterchefsenior", "link": "https://stackoverflow.com/users/6342264/masterchefsenior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 37622947, "answer_count": 1, "score": 1, "last_activity_date": 1464986129, "creation_date": 1464985339, "question_id": 37622761, "link": "https://stackoverflow.com/questions/37622761/how-to-maintain-interactive-print-after-load-or-reload-in-ghci", "title": "How to maintain -interactive-print after :load or :reload in ghci?", "body": "<p>I'm using <code>-interactive-print</code> to print the current time after each line evaluated in <code>ghci</code>:</p>\n\n<p>(from <code>~/.ghci</code>):</p>\n\n<pre><code>import qualified Text.Show.TimePrint\n:set -interactive-print=Text.Show.TimePrint.timePrint\n</code></pre>\n\n<p>It works until I try to <code>:load</code> a file:</p>\n\n<pre><code>$ ghci\nGHCi, version 7.10.3: http://www.haskell.org/ghc/  :? for help\nPrelude Text.Show.TimePrint&gt; 1+2\n3\n20:08:42\nPrelude Text.Show.TimePrint&gt; :l file.hs\n[1 of 1] Compiling Main             ( file.hs, interpreted )\nOk, modules loaded: Main.\n*Main Text.Show.TimePrint&gt; 1+2\n3\n</code></pre>\n\n<p>I saw this ticket here that describes the problem: <a href=\"https://ghc.haskell.org/trac/ghc/ticket/11159\" rel=\"nofollow\">https://ghc.haskell.org/trac/ghc/ticket/11159</a>; the proposed solution is to put it in a \"registered package\", which I don't exactly understand. I put it in <code>Text.Show</code>, is that not quite right? Thanks.</p>\n\n<p>(The code for the package installed to do <code>TimePrint</code>:)</p>\n\n<pre><code>module Text.Show.TimePrint (timePrint) where\n\nimport System.IO\nimport Data.Time\n\ngetTime :: IO String\ngetTime = do\n    now &lt;- getCurrentTime\n    return (formatTime defaultTimeLocale \"%T\" now)\n\ntimePrint :: Show a =&gt; a -&gt; IO ()\ntimePrint a = do\n    s &lt;- getTime\n    putStrLn $ show a ++ \"\\n\" ++ s\n</code></pre>\n"}, {"tags": ["haskell", "conduit"], "answers": [{"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": false, "score": 0, "last_activity_date": 1464969304, "creation_date": 1464969304, "answer_id": 37618754, "question_id": 37617885, "link": "https://stackoverflow.com/questions/37617885/how-make-chunking-work-with-amazonka-conduit-and-lazy-bytestring/37618754#37618754", "title": "How make chunking work with amazonka, conduit and lazy bytestring", "body": "<p>I am not sure but I think the culprit is <code>LBS.readFile</code> its <a href=\"https://hackage.haskell.org/package/bytestring-0.10.8.1/docs/Data-ByteString-Lazy.html#v:readFile\" rel=\"nofollow\">documentation</a> says:</p>\n\n<blockquote>\n<pre><code>readFile :: FilePath -&gt; IO ByteString\n\nRead an entire file lazily into a ByteString.\nThe Handle will be held open until EOF is encountered.\n</code></pre>\n</blockquote>\n\n<p><code>chunkedFile</code> works in the way of conduit - alternatively you could use</p>\n\n<pre><code>sourceFile :: MonadResource m =&gt; FilePath -&gt; Producer m ByteString\n</code></pre>\n\n<p>from (<a href=\"https://hackage.haskell.org/package/conduit-extra-1.1.13.1\" rel=\"nofollow\"><code>conduit-extras/Data.Conduit.Binary</code></a>) instead of <code>LBS.readFile</code>, but I am not an expert.</p>\n"}, {"comments": [{"owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "edited": false, "score": 0, "creation_date": 1464975549, "post_id": 37620206, "comment_id": 62723428, "body": "How would one simulate lazy bytestring then? I need to simulate it since it is coming over the network socket, not a file handle. I thought <code>sourceLbs</code> would take care of reading the lazy bytestring incrementally."}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "reply_to_user": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "edited": false, "score": 0, "creation_date": 1464975756, "post_id": 37620206, "comment_id": 62723556, "body": "Well, as it stands you are getting the simulating bytes from a file, so why not use <code>sourceFile</code>? Later you will replace <code>sourceFile &quot;out&quot;</code> with a conduit source that reads from a socket, no?"}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "reply_to_user": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "edited": false, "score": 0, "creation_date": 1464975808, "post_id": 37620206, "comment_id": 62723572, "body": "Oh wait ... there will be the further complication of getting the total length. Will the source tell you that in advance?"}, {"owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "edited": false, "score": 0, "creation_date": 1464976027, "post_id": 37620206, "comment_id": 62723659, "body": "total length can be easily supplied ahead of time by the source - I have already thought about it. So, yep, I can simulate like what you suggested. Just wanted to get confirmation that it is the way to go."}, {"owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "reply_to_user": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "edited": false, "score": 0, "creation_date": 1464976577, "post_id": 37620206, "comment_id": 62723942, "body": "Yes, that seems right. There will be the complication of e.g. first parsing the length from the source/socket and then feeding the remainder to <code>toBody $ ChunkedBody ...</code>"}], "tags": [], "owner": {"reputation": 2831, "user_id": 183792, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ddcfbc6c31012fd25384f6301363347?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/183792/michael"}, "is_accepted": true, "score": 2, "last_activity_date": 1464975546, "last_edit_date": 1464975546, "creation_date": 1464974499, "answer_id": 37620206, "question_id": 37617885, "link": "https://stackoverflow.com/questions/37617885/how-make-chunking-work-with-amazonka-conduit-and-lazy-bytestring/37620206#37620206", "title": "How make chunking work with amazonka, conduit and lazy bytestring", "body": "<p>It's clear this bit </p>\n\n<pre><code>  inb &lt;- LBS.readFile \"out\"\n  lenb &lt;- System.IO.withFile \"out\" ReadMode hFileSize -- evaluates to 104857600 (100MB)\n  let cbytes = toBody $ ChunkedBody (1024*128) (fromIntegral lenb) (sourceLbs inb)\n</code></pre>\n\n<p>should be rewritten as </p>\n\n<pre><code>  lenb &lt;- System.IO.withFile \"out\" ReadMode hFileSize -- evaluates to 104857600 (100MB)\n  let cbytes = toBody $ ChunkedBody (1024*128) (fromIntegral lenb) (C.sourceFile \"out\")\n</code></pre>\n\n<p>As you wrote it, the purpose of conduits is defeated. The entire file would need to be accumulated by <code>LBS.readFile</code>, but then broken apart chunk by chunk when fed to <code>sourceLBS</code>. (If lazy IO is working right, this might not happen.) <code>sourceFile</code> reads the file incrementally, chunk by chunk. It may be that, e.g. <code>toBody</code> accumulates the whole file, in which case the point of conduits is defeated at a different point.  Glancing at the source for <code>send</code> and so on I can't see anything that would do this, though.</p>\n"}], "owner": {"reputation": 4185, "user_id": 986475, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dd36406ee6957594a633373c297a3ab1?s=128&d=identicon&r=PG", "display_name": "Sal", "link": "https://stackoverflow.com/users/986475/sal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 443, "favorite_count": 1, "accepted_answer_id": 37620206, "answer_count": 2, "score": 3, "last_activity_date": 1464975546, "creation_date": 1464966639, "question_id": 37617885, "link": "https://stackoverflow.com/questions/37617885/how-make-chunking-work-with-amazonka-conduit-and-lazy-bytestring", "title": "How make chunking work with amazonka, conduit and lazy bytestring", "body": "<p>I wrote the code below to simulate upload to <code>S3</code> from <code>Lazy ByteString</code> (which will be received over the network socket. Here, we simulate by reading from a file of size ~100MB). The problem with the code below is that it seems to be forcing the read of entire file into memory instead of chunking it (<code>cbytes</code>) - will appreciate pointers on why chunking is not working:</p>\n\n<pre><code>import Control.Lens\nimport Network.AWS\nimport Network.AWS.S3\nimport Network.AWS.Data.Body\nimport System.IO\nimport           Data.Conduit (($$+-))\nimport           Data.Conduit.Binary (sinkLbs,sourceLbs)\nimport qualified Data.Conduit.List as CL (mapM_)\nimport           Network.HTTP.Conduit (responseBody,RequestBody(..),newManager,tlsManagerSettings)\nimport qualified Data.ByteString.Lazy as LBS\n\nexample :: IO PutObjectResponse\nexample = do\n    -- To specify configuration preferences, newEnv is used to create a new Env. The Region denotes the AWS region requests will be performed against,\n    -- and Credentials is used to specify the desired mechanism for supplying or retrieving AuthN/AuthZ information.\n    -- In this case, Discover will cause the library to try a number of options such as default environment variables, or an instance's IAM Profile:\n    e &lt;- newEnv NorthVirginia Discover\n\n    -- A new Logger to replace the default noop logger is created, with the logger set to print debug information and errors to stdout:\n    l &lt;- newLogger Debug stdout\n\n    -- The payload for the S3 object is retrieved from a file that simulates lazy bytestring received over network\n    inb &lt;- LBS.readFile \"out\"\n    lenb &lt;- System.IO.withFile \"out\" ReadMode hFileSize -- evaluates to 104857600 (100MB)\n    let cbytes = toBody $ ChunkedBody (1024*128) (fromIntegral lenb) (sourceLbs inb)\n\n    -- We now run the AWS computation with the overriden logger, performing the PutObject request:\n    runResourceT . runAWS (e &amp; envLogger .~ l) $\n        send ((putObject \"yourtestenv-change-it-please\" \"testbucket/test\" cbytes) &amp; poContentType .~ Just \"text; charset=UTF-8\")\n\nmain = example &gt;&gt; return ()\n</code></pre>\n\n<p>Running the executable with <code>RTS -s</code> option shows that entire thing is read into memory (~113MB maximum residency - I did see ~87MB once). On the other hand, if I use <a href=\"http://haddock.stackage.org/nightly-2015-10-23/amazonka-1.3.3.1/src/Network.AWS.Internal.Body.html#chunkedFile\" rel=\"nofollow\"><code>chunkedFile</code></a>, it is chunked correctly (~10MB maximum residency).  </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 6, "creation_date": 1464941146, "post_id": 37608369, "comment_id": 62701824, "body": "Unfortunately Haskell doesn&#39;t provide any way to only import a specific <i>type class instance</i>. Importing anything from a module imports <b>all</b> instances defined there. So even doing <code>import Data.Vec.Packed()</code> which explicitly says to import nothing in scope will still import all class instances defined in that module."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1464951175, "post_id": 37608369, "comment_id": 62707796, "body": "You could of course circumvent the problem with <a href=\"http://hackage.haskell.org/package/linear-1.20.5/docs/Linear-V3.html\" rel=\"nofollow noreferrer\"><code>import Linear.V3(V3(..))</code></a>, though I&#39;d see why you might want to avoid the heavy dependencies of <code>linear</code>."}, {"owner": {"reputation": 877, "user_id": 1385900, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90128ed8aba2b5dea85920090967190e?s=128&d=identicon&r=PG", "display_name": "Daniel K", "link": "https://stackoverflow.com/users/1385900/daniel-k"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1465121079, "post_id": 37608369, "comment_id": 62761266, "body": "@Bakuriu, using <code>import Data.Vec.Packed ()</code> does not import the <code>Vec3D</code> data constructor. I still don&#39;t understand how to import the data constructor without importing the whole module."}], "answers": [{"tags": [], "owner": {"reputation": 1602, "user_id": 5947247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5212b96ae435bb73b9980f34b2913e8?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac van Bakel", "link": "https://stackoverflow.com/users/5947247/isaac-van-bakel"}, "is_accepted": false, "score": 0, "last_activity_date": 1535377849, "creation_date": 1535377849, "answer_id": 52040892, "question_id": 37608369, "link": "https://stackoverflow.com/questions/37608369/how-do-i-import-this-complicated-data-constructor-and-nothing-more/52040892#52040892", "title": "How do I import this complicated data constructor, and nothing more?", "body": "<p>To bundle the constructor with the family import, you can write</p>\n\n<p><code>import Data.Vec.Packed (Packed(Vec3D))</code></p>\n\n<p>Testing this in GHCi with <code>:info Vec3D</code> shows</p>\n\n<pre><code>data instance Packed (Data.Vec.Base.Vec3 Double)\n  = Vec3D {-# UNPACK #-}Double\n          {-# UNPACK #-}Double\n          {-# UNPACK #-}Double\n        -- Defined in \u2018Data.Vec.Packed\u2019\n</code></pre>\n"}], "owner": {"reputation": 877, "user_id": 1385900, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/90128ed8aba2b5dea85920090967190e?s=128&d=identicon&r=PG", "display_name": "Daniel K", "link": "https://stackoverflow.com/users/1385900/daniel-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 201, "favorite_count": 1, "answer_count": 1, "score": 6, "last_activity_date": 1535377849, "creation_date": 1464938684, "last_edit_date": 1464939387, "question_id": 37608369, "link": "https://stackoverflow.com/questions/37608369/how-do-i-import-this-complicated-data-constructor-and-nothing-more", "title": "How do I import this complicated data constructor, and nothing more?", "body": "<p>I'd like to import the <code>Vec3D</code> data constructor from the Vec package, the <code>Data.Vec.Packed</code> module. Obviously, I can</p>\n\n<pre><code>import Data.Vec.Packed\n</code></pre>\n\n<p>and be done with things, but that's not what I want to do, because that adds extra stuff to what's currently in scope.</p>\n\n<p>The <code>Vec3D</code> data constructor is declared like this in the <code>Data.Vec.Packed</code> module:</p>\n\n<pre><code>instance PackedVec (Vec3 Double) where\n  data Packed (Vec3 Double) = Vec3D {-#UNPACK#-} !Double {-#UNPACK#-} !Double {-#UNPACK#-} !Double\n...\n</code></pre>\n\n<p>I tried this, but it didn't compile:</p>\n\n<pre><code>import Data.Vec.Packed (Packed (Vec3 Double)(..))\n</code></pre>\n\n<p>How can I import just the <code>Vec3D</code> data constructor?</p>\n\n<p>FYI, if you import the module in ghci:</p>\n\n<pre><code>* Data.Vec&gt; :info  Vec3D\ndata instance Packed (Vec3 Double)\n  = Vec3D {-# UNPACK #-}Double\n          {-# UNPACK #-}Double\n          {-# UNPACK #-}Double\n    -- Defined in \u2018Data.Vec.Packed\u2019\n\ntype Vec3D = Packed (Vec3 Double)   -- Defined in \u2018Data.Vec.Packed\u2019\n</code></pre>\n"}, {"tags": ["haskell", "ghci"], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 6342264, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01288c6a2a59550030bcff28a8dfb899?s=128&d=identicon&r=PG&f=1", "display_name": "masterchefsenior", "link": "https://stackoverflow.com/users/6342264/masterchefsenior"}, "edited": false, "score": 0, "creation_date": 1464985619, "post_id": 37603477, "comment_id": 62728329, "body": "In other words, &lt;- is to run the IO action, and turn it into (in this case) a String?"}, {"owner": {"reputation": 2179, "user_id": 412549, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a194a155579e30bda0926705aeb9d165?s=128&d=identicon&r=PG&f=1", "display_name": "Franky", "link": "https://stackoverflow.com/users/412549/franky"}, "reply_to_user": {"reputation": 99, "user_id": 6342264, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01288c6a2a59550030bcff28a8dfb899?s=128&d=identicon&r=PG&f=1", "display_name": "masterchefsenior", "link": "https://stackoverflow.com/users/6342264/masterchefsenior"}, "edited": false, "score": 1, "creation_date": 1464986005, "post_id": 37603477, "comment_id": 62728502, "body": "@masterchefsenior exactly!"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1464908491, "creation_date": 1464908491, "answer_id": 37603477, "question_id": 37603307, "link": "https://stackoverflow.com/questions/37603307/cant-use-interactive-print-to-print-timestamps-after-each-line-in-ghci/37603477#37603477", "title": "Can&#39;t use -interactive-print to print timestamps after each line in ghci", "body": "<pre><code>timePrint a = do\n   s &lt;- getTime\n   putStrLn $ show a ++ \"\\n\" ++ s\n</code></pre>\n\n<p><code>++</code> wants a string, not an IO action.</p>\n"}], "owner": {"reputation": 99, "user_id": 6342264, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01288c6a2a59550030bcff28a8dfb899?s=128&d=identicon&r=PG&f=1", "display_name": "masterchefsenior", "link": "https://stackoverflow.com/users/6342264/masterchefsenior"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 1, "accepted_answer_id": 37603477, "answer_count": 1, "score": 2, "last_activity_date": 1464908491, "creation_date": 1464907423, "question_id": 37603307, "link": "https://stackoverflow.com/questions/37603307/cant-use-interactive-print-to-print-timestamps-after-each-line-in-ghci", "title": "Can&#39;t use -interactive-print to print timestamps after each line in ghci", "body": "<p>I'm trying to print the current time after each line evaluated in <code>ghci</code>. Here's my code so far:</p>\n\n<pre><code>module TimePrint (timePrint) where\n\nimport System.IO\nimport Data.Time\n\ngetTime :: IO String\ngetTime = do\n    now &lt;- getCurrentTime\n    return (formatTime defaultTimeLocale \"%T\" now)\n\ntimePrint :: Show a =&gt; a -&gt; IO ()\ntimePrint a = putStrLn $ show a ++ \"\\n\" ++ getTime\n</code></pre>\n\n<p>And I'm running <code>ghci</code> like so: <code>ghci -interactive-print=TimePrint.timePrint TimePrint</code></p>\n\n<p>The error I'm getting is this:</p>\n\n<pre><code>TimePrint.hs:12:44:\n    Couldn't match expected type \u2018[Char]\u2019 with actual type \u2018IO String\u2019\n    In the second argument of \u2018(++)\u2019, namely \u2018getTime\u2019\n    In the second argument of \u2018(++)\u2019, namely \u2018\"\\n\" ++ getTime\u2019\nFailed, modules loaded: none.\n</code></pre>\n\n<p>I gather it has something to do with the fact that timePrint isn't in the IO monad, but other than that I have no clue. Any ideas? I'd like each line of <code>ghci</code> output to look something like:</p>\n\n<pre><code>Prelude&gt; 1+2\n3\n11:59:20\nPrelude&gt; 3+4\n7\n12:00:16\n</code></pre>\n\n<p>etc.</p>\n"}, {"tags": ["haskell", "arrows"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1464888632, "post_id": 37598291, "comment_id": 62681942, "body": "In your definition of Category L, why are you returning <code>s&#39;&#39;+1</code> instead of <code>s&#39;&#39;+s&#39;</code>? The asymmetry just stands out as odd."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 9, "creation_date": 1464888909, "post_id": 37598291, "comment_id": 62682080, "body": "Your <code>Monad</code> instance for <code>K</code> is not law-abiding. Counting binds can&#39;t be, because some laws have a different number of binds on the two sides of the equation, e.g. <code>return x &gt;&gt;= f = f x</code>. Counting uses of <code>.</code> in a <code>Category</code> has a similar problem, since <code>id . f = f</code> is an equation."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1464895160, "post_id": 37598291, "comment_id": 62685606, "body": "Related question: <a href=\"http://stackoverflow.com/questions/20292694/how-to-write-a-monad-that-prints-step-i-of-n-when-executing-each-statement-in/20293615\" title=\"how to write a monad that prints step i of n when executing each statement in\">stackoverflow.com/questions/20292694/&hellip;</a>"}, {"owner": {"reputation": 1835, "user_id": 6292577, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/gqMCP.jpg?s=128&g=1", "display_name": "rityzmon", "link": "https://stackoverflow.com/users/6292577/rityzmon"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1464900387, "post_id": 37598291, "comment_id": 62688405, "body": "@DanielWagner Does this mean that the concept of a monad that counts binds or an arrow that counts connections cannot be done?"}, {"owner": {"reputation": 1835, "user_id": 6292577, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/gqMCP.jpg?s=128&g=1", "display_name": "rityzmon", "link": "https://stackoverflow.com/users/6292577/rityzmon"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1464901157, "post_id": 37598291, "comment_id": 62688791, "body": "@ErikR It is WIP code that doesn&#39;t work. I&#39;m looking for help in modifying the code so that it will allow me to count connections."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1464902410, "post_id": 37598291, "comment_id": 62689387, "body": "@ritzymon No. It just means the interface you propose is not compatible with being a well-behaved monad/arrow. Consider designing a different interface -- e.g. adding an explicit &quot;bump the counter&quot; operation would be a straightforward and perfectly-law-abiding fix. If you say more about what you hope to achieve, we may also be able to advise you on other routes to take."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1464909545, "post_id": 37602529, "comment_id": 62691875, "body": "When using <code>QuickCheck</code>, you should write properties to take <code>Fun</code>s (from QuickCheck) rather than functions. That way you don&#39;t need to import <code>Text.Show.Functions</code> and you get better errors when tests fail."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1464909615, "post_id": 37602529, "comment_id": 62691901, "body": "<code>prop_ap :: Fun Int Int -&gt; Int -&gt; Bool; prop_ap fun x = let f = apply fun in ...</code>"}, {"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1464909880, "post_id": 37602529, "comment_id": 62691970, "body": "@dfeuer: Huh, I didn&#39;t know that one.  I&#39;ve incorporated the suggestion."}], "tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 5, "last_activity_date": 1464909855, "last_edit_date": 1464909855, "creation_date": 1464903409, "answer_id": 37602529, "question_id": 37598291, "link": "https://stackoverflow.com/questions/37598291/how-to-create-an-arrow-that-counts-connections/37602529#37602529", "title": "How to create an Arrow that &quot;counts connections&quot;?", "body": "<p>(This is really the same as Daniel Wagner's observation, but I thought I'd make it friendlier.)</p>\n\n<p>You should meditate on what the meaning is of having <strong>laws</strong> like the monad laws.  This is a topic that can get subtle and complicated, but a very simple rule of thumb that you can apply is this:</p>\n\n<ul>\n<li>If a type or function promises that it obeys a law that says <code>x = y</code>, clients of that class should not be able to tell <code>x</code> and <code>y</code> apart.</li>\n<li>I.e., you should <strong>not</strong> be able to write a function <code>f</code> such that:\n\n<ul>\n<li>The law says that <code>x = y</code>;</li>\n<li>But <code>f x /= f y</code></li>\n</ul></li>\n</ul>\n\n<p>Now this cannot be an absolute rule.  Take for example sorting; merge sort and bubble sort are both stable sorting algorithms, and thus they \"the same function\" in the sense that you cannot tell them apart from looking at the inputs and outputs.  But if you use a \"side channel\" like timing you could still tell them apart, but we normally exclude that from consideration when we ask whether some code obeys a given law.</p>\n\n<p>Now when we apply this to your <code>K</code> type, then the problem is that you can write a program that distinguishes two expressions that the monad laws say should be indistinguishable.  For example, in the <a href=\"https://hackage.haskell.org/package/base-4.9.0.0/docs/Control-Monad.html#t:Monad\" rel=\"nofollow\">documentation for the <code>Monad</code> class</a> it says that:</p>\n\n<blockquote>\n  <p>Furthermore, the <code>Monad</code> and <code>Applicative</code> operations should relate as follows:</p>\n\n<pre><code>pure = return\n(&lt;*&gt;) = ap\n</code></pre>\n</blockquote>\n\n<p>And we can easily refute the second one of these with a QuickCheck test like this:</p>\n\n<pre><code>import Control.Monad (ap)\nimport Test.QuickCheck\nimport Test.QuickCheck.Function\n\n-- Snipped your code for `K`\n\nprop_ap :: Fun Int Int -&gt; Int -&gt; Bool\nprop_ap f x = runK applicative 0 == runK monadic 0\n    where applicative = pure (apply f) &lt;*&gt; pure x\n          monadic = return (apply f) `ap` return x\n</code></pre>\n\n<p>Testing this fails right away:</p>\n\n<pre><code>&gt;&gt;&gt;  quickCheck prop_ap\n*** Failed! Falsifiable (after 1 test and 2 shrinks): \n{_-&gt;0}\n0\n</code></pre>\n\n<p>The reason here being that your <code>Monad</code> instance is doing the <code>+1</code> but your <code>Applicative</code> one isn't doing anything of the sort.  So we can distinguish between equivalent computations, but one of them was built with <code>&lt;*&gt;</code> and the other with <code>ap</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": false, "score": 2, "last_activity_date": 1464959231, "creation_date": 1464959231, "answer_id": 37615244, "question_id": 37598291, "link": "https://stackoverflow.com/questions/37598291/how-to-create-an-arrow-that-counts-connections/37615244#37615244", "title": "How to create an Arrow that &quot;counts connections&quot;?", "body": "<p>As described by others, you can't count \"connections\" such as binds or arrow binding operations, because then they won't satisfy monad/arrow laws.</p>\n\n<p>However, what you <em>can</em> do is to create an arrow where you can explicitly give sizes to your building blocks and then compute the size of such an circuit. To give an example:\n    {-# LANGUAGE Arrows #-}</p>\n\n<pre><code>import Control.Arrow\nimport qualified Control.Category as C\n\ndata A a b c = A { runA :: a b c, sizeA :: !Int }\n</code></pre>\n\n<p>Here we defined an arrow transformer that wraps an existing arrow and adds its size.</p>\n\n<pre><code>instance (C.Category a) =&gt; C.Category (A a) where\n    id = A C.id 0\n    (A a1 s1) . (A a2 s2) = A (a1 C.. a2) (s1 + s2)\n\ninstance (Arrow a) =&gt; Arrow (A a) where\n    arr f = A (arr f) 0\n    first (A f s) = A (first f) s\n\ninstance (ArrowChoice a) =&gt; ArrowChoice (A a) where\n    left (A f s) = A (left f) s\n\n-- instance (Arrow a) =&gt; ArrowTransformer A a where\n--     lift a = A a 0\n</code></pre>\n\n<p>The default size must be always 0 to satisfy the laws. For example <code>id</code> must have size of 0, as <code>x . id === x</code>, thanks to law <code>arr id === id</code> we have that <code>arr f</code> must also have size of 0 etc.</p>\n\n<p>But we can define a custom function that assigns a given size to an underlying arrow:</p>\n\n<pre><code>sized :: Int -&gt; a b c -&gt; A a b c\nsized = flip A\n</code></pre>\n\n<p>To give an example, let's construct some arrows of type <code>A (-&gt;)</code>. That is, the underlying arrows are just functions.</p>\n\n<pre><code>-- * Example (adapted from https://wiki.haskell.org/Arrow_tutorial)\n\n-- | Both 'f' and 'g' are constructed to have a size of 1.\nf, g :: A (-&gt;) Int Int\nf = sized 1 $ arr (`div` 2)\ng = sized 1 $ arr (\\x -&gt; x*3 + 1)\n\nh :: A (-&gt;) Int Int\nh = proc x -&gt; do\n      fx &lt;- f -&lt; x\n      gx &lt;- g -&lt; x\n      returnA -&lt; (fx + gx)\n</code></pre>\n\n<p>You can run <code>h</code> for example as <code>runA h 5</code>. But you can also measure its size by <code>sizeA h</code>, which returns 2, as expected. Note that you don't need to run the arrow to get its size. You can picture it as a circuit, and you don't need to actually power up a circuit to just view its size.</p>\n\n<p>Note that we can't do this for a monad, so we can't have instance <code>ArrowChoice A</code>. In a monad we can compute the next \"effect\" from a previous result, which means we can never compute the size without actually running the monadic computation.</p>\n"}], "owner": {"reputation": 1835, "user_id": 6292577, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/gqMCP.jpg?s=128&g=1", "display_name": "rityzmon", "link": "https://stackoverflow.com/users/6292577/rityzmon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 2, "answer_count": 2, "score": 3, "last_activity_date": 1483398750, "creation_date": 1464887899, "last_edit_date": 1483398750, "question_id": 37598291, "link": "https://stackoverflow.com/questions/37598291/how-to-create-an-arrow-that-counts-connections", "title": "How to create an Arrow that &quot;counts connections&quot;?", "body": "<p>I recently had the idea to build a monad that counted the number of binds a computation goes through. I came up with the following:</p>\n\n<pre><code>newtype K a = K { runK :: Int -&gt; (a, Int) }\n\ninstance Functor K where\n  fmap f k = K $ \\s -&gt;\n    let (iv, s') = runK k s\n     in (f iv, s')\n\ninstance Applicative K where\n  pure x = K $ \\s -&gt; (x, s)\n  f &lt;*&gt; b = K $ \\s -&gt;\n    let (f', s')  = runK f s\n        (ih, s'') = runK b s'\n     in (f' ih, s'')\n\ninstance Monad K where\n  return x = K $ \\s -&gt; (x, s)\n  a &gt;&gt;= f = K $ \\s -&gt;\n    let (iv, s') = runK a s\n     in runK (f iv) (s' + 1)\n</code></pre>\n\n<p>which I later realized was just the <code>State</code> monad and not very interesting. Then, I had the idea to try to build an arrow that counted \"connections\". Here I am a bit stumped.</p>\n\n<pre><code>newtype L a b = L { runL :: Int -&gt; (a -&gt; b, Int) }\n\ninstance Category L where\n  id = arr Prelude.id\n  b . a = L $ \\s -&gt;\n    let (f1, s') = runL a s\n        (f2, s'') = runL b s'\n     in (f2 Prelude.. f1, s'' + 1)\n\ninstance Arrow L where\n  arr f = L $ \\s -&gt; (f, s + 1)\n  first a = L $ \\s -&gt;\n    let (f1, s') = runL a s\n     in (\\(x, y) -&gt; (f1 x, y), s')\n</code></pre>\n\n<p>I came up with the above which would count the number of connections, but doesn't count the number of connections a computation goes through. Suggestions?</p>\n"}, {"tags": ["haskell", "state-monad"], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 1, "last_activity_date": 1464885255, "creation_date": 1464885255, "answer_id": 37597450, "question_id": 37596493, "link": "https://stackoverflow.com/questions/37596493/adding-state-monad-to-the-haskell-kv-database/37597450#37597450", "title": "adding state monad to the haskell kv database", "body": "<p>For starters, your code doesn't type check, so let's just concentrate on the first part of <code>execCmd</code>:</p>\n\n<pre><code>execCmd :: Command -&gt; State DB Result\nexecCmd (Set key val) = do\n  (db@(DB map), r) &lt;- get\n  let newMap = M.insert key val map\n  put ((DB newMap), r)\n  return $ Result Nothing False\n</code></pre>\n\n<p>Clearly this isn't going to work because <code>get</code> and <code>put</code> are operating with a pair <code>(DB, r)</code> but your type signature says that the state type is only a <code>DB</code>.</p>\n\n<p>What is <code>r</code> here? Do you need it? This definition of <code>execCmd</code> agrees with the type signature:</p>\n\n<pre><code>execCmd :: Command -&gt; State DB Result\nexecCmd (Set key val) = do\n  db@(DB map) &lt;- get\n  let newMap = M.insert key val map\n  put (DB newMap)\n  return $ Result Nothing False\n</code></pre>\n"}], "owner": {"reputation": 4988, "user_id": 161289, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/KUaQL.jpg?s=128&g=1", "display_name": "zinking", "link": "https://stackoverflow.com/users/161289/zinking"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 37597450, "answer_count": 1, "score": 0, "last_activity_date": 1464885255, "creation_date": 1464882288, "last_edit_date": 1492087236, "question_id": 37596493, "link": "https://stackoverflow.com/questions/37596493/adding-state-monad-to-the-haskell-kv-database", "title": "adding state monad to the haskell kv database", "body": "<p>Playing with an old code review here <a href=\"https://codereview.stackexchange.com/questions/24741/simple-in-memory-db\">simple-db</a>. and get stuck when I added State Monad into it to further reduce the code. </p>\n\n<p>I somehow feel I am not doing it correctly. <code>repl cmd = getCmd &gt;&gt;= execCmd cmd &gt;&gt;= displayResult &gt;&gt;= continue</code>  change the interface of <code>execCmd</code> means change all the functions along the line. </p>\n\n<p><strong>if I follow this approach, how to get it work?</strong> </p>\n\n<p><strong>what's the correct way of doing the suggested refactoring using <code>state</code> Monad ?</strong></p>\n\n<pre><code>--import qualified\nimport Data.Map as M\nimport Control.Monad.State\n\ntype History = [String]\n\ndata Result = Result (Maybe String) Bool\n\ndata Command = Invalid | End | Get String | Set String String\ndata DB = DB (M.Map String String)\n\n\nexecCmd :: Command -&gt; State DB Result\nexecCmd (Set key val) = do\n  (db@(DB map), r) &lt;- get\n  let newMap = M.insert key val map\n  put ((DB newMap), r)\n  return $ Result Nothing False \nexecCmd (Get key) = do\n  (db@(DB map), r) &lt;- get\n  return $ Result (M.lookup key map) False \nexecCmd End = do\n  return $ Result Nothing True \nexecCmd Invalid = do\n  return $ Result Nothing False \n\ngetCmd = getLine &gt;&gt;= return . parseCmd\n\nparseCmd :: String -&gt; Command\nparseCmd s =\n  case words s of\n    (\"set\":key:value:_) -&gt; Set key value\n    (\"get\":key:_)       -&gt; Get key\n    (\"end\":_)           -&gt; End\n    _                   -&gt; Invalid\n\ndisplayResult :: Result -&gt; IO Result\ndisplayResult r@(Result (Just s) _ ) = putStrLn s &gt;&gt; return r\ndisplayResult r                      = return r\n\ncontinue :: Result -&gt; IO ()\ncontinue (Result _ end) = if end then return () else repl \n\nrepl cmd = getCmd &gt;&gt;= execCmd cmd &gt;&gt;= displayResult &gt;&gt;= continue\n\nstartState = ((DB M.empty), (Result Nothing False))\n\n--main = repl Invalid \n</code></pre>\n"}, {"tags": ["haskell", "constraints", "instance", "typeclass"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 3, "creation_date": 1464863828, "post_id": 37589361, "comment_id": 62663896, "body": "the constraint is not your problem - the problem is that you are saying: <i>no matter what <code>Eq</code> type you want from me as a result - I can provide it</i>"}, {"owner": {"reputation": 4507, "user_id": 305949, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/38d369d1ad1a4ffba29c6ee1eae6a19f?s=128&d=identicon&r=PG", "display_name": "FK82", "link": "https://stackoverflow.com/users/305949/fk82"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1464866897, "post_id": 37589361, "comment_id": 62665852, "body": "Where do I say that?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1464869270, "post_id": 37589361, "comment_id": 62667547, "body": "in <code>f :: Eq u =&gt; t -&gt; u</code> - <code>t</code> is know from the context - the <code>u</code> is there with an implicit <code>forall</code>"}, {"owner": {"reputation": 4507, "user_id": 305949, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/38d369d1ad1a4ffba29c6ee1eae6a19f?s=128&d=identicon&r=PG", "display_name": "FK82", "link": "https://stackoverflow.com/users/305949/fk82"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1464883366, "post_id": 37589361, "comment_id": 62678714, "body": "@Carsten Can you link me to a reference for your claim. From what I understand a type constraint only limits potential definitions."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1464883909, "post_id": 37589361, "comment_id": 62679051, "body": "it&#39;s not about the constraint - it&#39;s about the <code>u</code> - it&#39;s really just what Chi pointed out in his answer and comments"}], "answers": [{"comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 4, "creation_date": 1464864207, "post_id": 37589470, "comment_id": 62664138, "body": "This. 1,000 times this. In a typical OO language, <i>the method</i> can choose to return anything it wants, so long as it matches the requirements. In Haskell <i>the caller</i> gets to choose, not the method."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1464865437, "post_id": 37589470, "comment_id": 62664898, "body": "This also applies to normal functions that aren&#39;t typeclass methods; if you claim you can return &quot;some type that implements <code>Foo</code>&quot;, you really have to be able to return <i>any type</i> that implements <code>Foo</code>!"}, {"owner": {"reputation": 4507, "user_id": 305949, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/38d369d1ad1a4ffba29c6ee1eae6a19f?s=128&d=identicon&r=PG", "display_name": "FK82", "link": "https://stackoverflow.com/users/305949/fk82"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1464866954, "post_id": 37589470, "comment_id": 62665892, "body": "@MathematicalOrchid, chi: That&#39;s confusing. Any idea on how to provide an instance definition for the concrete data type?"}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 4507, "user_id": 305949, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/38d369d1ad1a4ffba29c6ee1eae6a19f?s=128&d=identicon&r=PG", "display_name": "FK82", "link": "https://stackoverflow.com/users/305949/fk82"}, "edited": false, "score": 0, "creation_date": 1464867693, "post_id": 37589470, "comment_id": 62666431, "body": "@FK82 The return type has to be determined at compile-time. There&#39;s no (useful) way to return a different type depending on what input you give it at run-time. Perhaps if we knew what you want this function <i>for</i>... but that&#39;s possibly a new question."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 4507, "user_id": 305949, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/38d369d1ad1a4ffba29c6ee1eae6a19f?s=128&d=identicon&r=PG", "display_name": "FK82", "link": "https://stackoverflow.com/users/305949/fk82"}, "edited": false, "score": 4, "creation_date": 1464868046, "post_id": 37589470, "comment_id": 62666687, "body": "@FK82 It&#39;s impossible to work with that class, it&#39;s promising the impossible, so it can&#39;t be implemented. You need to rework your approach. Your question looks like a case of the XY problem. <a href=\"http://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\" title=\"what is the xy problem\">meta.stackexchange.com/questions/66377/what-is-the-xy-proble&zwnj;&#8203;m</a>"}, {"owner": {"reputation": 4507, "user_id": 305949, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/38d369d1ad1a4ffba29c6ee1eae6a19f?s=128&d=identicon&r=PG", "display_name": "FK82", "link": "https://stackoverflow.com/users/305949/fk82"}, "edited": false, "score": 0, "creation_date": 1464869726, "post_id": 37589470, "comment_id": 62667883, "body": "@chi Translate it to OOP. E.g. in Java <code>interface T&lt;U extends Comparable&gt; {         U f(); } public class T_Impl_Boolean         implements T&lt;Boolean&gt; {         private Boolean b;         public Boolean f() {return b;}}</code> works just fine. I don&#39;t understand why it would be impossible to implement a type constrained class function for a subset of the constraining class..."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 4507, "user_id": 305949, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/38d369d1ad1a4ffba29c6ee1eae6a19f?s=128&d=identicon&r=PG", "display_name": "FK82", "link": "https://stackoverflow.com/users/305949/fk82"}, "edited": false, "score": 0, "creation_date": 1464872612, "post_id": 37589470, "comment_id": 62670113, "body": "@FK82 This isn&#39;t even a typeclass problem. You&#39;re trying to write a function that sometimes returns <code>Bool</code> and sometimes returns <code>Float</code>, but depending on what data you feed it at run-time. You can&#39;t do that; the exact return type must be known at <i>compile-time</i>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1464875693, "post_id": 37589470, "comment_id": 62672565, "body": "Your Java example would be similar to <code>f :: Eq u =&gt; u -&gt; Bool</code>, where the <i>input</i> type, not the return type, has an <code>Eq</code> instance."}, {"owner": {"reputation": 4507, "user_id": 305949, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/38d369d1ad1a4ffba29c6ee1eae6a19f?s=128&d=identicon&r=PG", "display_name": "FK82", "link": "https://stackoverflow.com/users/305949/fk82"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1464877131, "post_id": 37589470, "comment_id": 62673820, "body": "@chepner No, it is not. For one, the signature of <code>f</code> in <code>T</code> makes it clear that the <b>return type</b> (<code>U</code>) is being parameterized and not the &quot;input type&quot; (there actually is none because, but it would translate to an input of a <code>T</code> instance). Also <code>T</code> does not implement <code>Comparable</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 4507, "user_id": 305949, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/38d369d1ad1a4ffba29c6ee1eae6a19f?s=128&d=identicon&r=PG", "display_name": "FK82", "link": "https://stackoverflow.com/users/305949/fk82"}, "edited": false, "score": 1, "creation_date": 1464881016, "post_id": 37589470, "comment_id": 62676979, "body": "@FK82 OOP translations are necessarily imprecise, but it is roughly like <code>interface T { &lt;U extends Comparable&gt; U f(); }</code> This is promising to be able to produce any <code>U</code>, caller&#39;s choice."}, {"owner": {"reputation": 4507, "user_id": 305949, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/38d369d1ad1a4ffba29c6ee1eae6a19f?s=128&d=identicon&r=PG", "display_name": "FK82", "link": "https://stackoverflow.com/users/305949/fk82"}, "edited": false, "score": 0, "creation_date": 1464882733, "post_id": 37589470, "comment_id": 62678255, "body": "@chi Yes, you&#39;re right. Btw, with the <code>MultiParamTypeClasses</code> pragma enabled, something like <code>class Eq u =&gt; T u t where ...</code> (roughly equivalent to my Java translation) actually passes the compiler. But the problem is just postponed to runtime. I think I begin to understand the problem a little better though: a typeclass constraint on an open type variable cannot be applied unless the data type is either given explicitely or may be safely inferred. That&#39;s why my code is not viable in Haskell."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1464884146, "post_id": 37589470, "comment_id": 62679198, "body": "not exactly (but it&#39;s also a problem) - you code does not work because you your function does not have a unique type - you defined a different return type for each constructor (see chis answer) - you could not do this in java either (well you could use object for them all)"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 4507, "user_id": 305949, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/38d369d1ad1a4ffba29c6ee1eae6a19f?s=128&d=identicon&r=PG", "display_name": "FK82", "link": "https://stackoverflow.com/users/305949/fk82"}, "edited": false, "score": 2, "creation_date": 1464892858, "post_id": 37589470, "comment_id": 62684316, "body": "@FK82 What are you ultimately trying to accomplish? Knowing that might help us help you more."}, {"owner": {"reputation": 4507, "user_id": 305949, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/38d369d1ad1a4ffba29c6ee1eae6a19f?s=128&d=identicon&r=PG", "display_name": "FK82", "link": "https://stackoverflow.com/users/305949/fk82"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1464898656, "post_id": 37589470, "comment_id": 62687506, "body": "@DavidYoung I&#39;m implementing a non-monotonic logical system in Haskell as part of my thesis in computer science. In typicall OOP fashion\u2014which of course does not necessarily translate too well to Haskell\u2014you would typically abstract common properties into an interface\u2014e.g. <code>interface Formula { Formula toCNF(); &#47;*...*&#47;}</code> (<code>toCNF</code> converts to clause normal form)\u2014and then implement this interface for the formulas of each logical system. That&#39;s basically what I was trying to do."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1464912430, "post_id": 37589470, "comment_id": 62692636, "body": "@MathematicalOrchid, <code>data Blah a where {Bint :: Blah Int ; Boat :: Blah Float}; hi :: Blah a -&gt; a; hi Bint = 1 :: Int; hi Boat = 3.7</code>. Whether this is <i>useful</i> is another question, I suppose."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "reply_to_user": {"reputation": 4507, "user_id": 305949, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/38d369d1ad1a4ffba29c6ee1eae6a19f?s=128&d=identicon&r=PG", "display_name": "FK82", "link": "https://stackoverflow.com/users/305949/fk82"}, "edited": false, "score": 0, "creation_date": 1464943209, "post_id": 37589470, "comment_id": 62702994, "body": "@FK82 Your actual <i>question</i> (why doesn&#39;t this work?) seems to be answered. Perhaps you should try asking &quot;how do I do XYZ?&quot; as a new question. If you include some details about what you&#39;re after, perhaps we can point you in the right direction."}, {"owner": {"reputation": 4507, "user_id": 305949, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/38d369d1ad1a4ffba29c6ee1eae6a19f?s=128&d=identicon&r=PG", "display_name": "FK82", "link": "https://stackoverflow.com/users/305949/fk82"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1464945483, "post_id": 37589470, "comment_id": 62704371, "body": "@MathematicalOrchid No it&#39;s ok. I understand what&#39;s happening now."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 17, "last_activity_date": 1464864300, "last_edit_date": 1464864300, "creation_date": 1464863909, "answer_id": 37589470, "question_id": 37589361, "link": "https://stackoverflow.com/questions/37589361/how-do-you-apply-function-constraints-in-instance-methods-in-haskell/37589470#37589470", "title": "How do you apply function constraints in instance methods in Haskell?", "body": "<p>The signature</p>\n\n<pre><code>f :: (Eq u) =&gt; t -&gt; u \n</code></pre>\n\n<p>means that the <strong>caller</strong> can pick <code>t</code> and <code>u</code> as wanted, with the only burden of ensuring that <code>u</code> is of class <code>Eq</code> (and <code>t</code> of class <code>T</code> -- in class methods there's an implicit <code>T t</code> constraint).</p>\n\n<p>It does not mean that the implementation can choose any <code>u</code>.</p>\n\n<p>So, the caller can use <code>f</code> in any of these ways: (with <code>t</code> in class <code>T</code>)</p>\n\n<pre><code>f :: t -&gt; Bool \nf :: t -&gt; Char\nf :: t -&gt; Int\n... \n</code></pre>\n\n<p>The compiler is complaining that your implementation is not general enough to cover all these cases.</p>\n\n<pre><code>Couldn't match expected type \u2018u\u2019 with actual type \u2018Float\u2019 \n</code></pre>\n\n<p>means \"You gave me a <code>Float</code>, but you must provide a value of the general type <code>u</code> (where <code>u</code> will be chosen by the caller)\"</p>\n"}, {"comments": [{"owner": {"reputation": 4507, "user_id": 305949, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/38d369d1ad1a4ffba29c6ee1eae6a19f?s=128&d=identicon&r=PG", "display_name": "FK82", "link": "https://stackoverflow.com/users/305949/fk82"}, "edited": false, "score": 0, "creation_date": 1464879038, "post_id": 37593114, "comment_id": 62675417, "body": "I think I understand the problem now: the type declaration of the class function must either specify a certain data type (this is the most simple case); or, if the type may be parameterized \u2014 and hence constrained by a type class \u2014 the compiler must be able to safely infer it. Anything else will not pass compilation."}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 8, "last_activity_date": 1464873669, "creation_date": 1464873669, "answer_id": 37593114, "question_id": 37589361, "link": "https://stackoverflow.com/questions/37589361/how-do-you-apply-function-constraints-in-instance-methods-in-haskell/37593114#37593114", "title": "How do you apply function constraints in instance methods in Haskell?", "body": "<p>Chi has already pointed out why your code doesn't compile. But it's not even that typeclasses are the problem; indeed, your example has only one instance, so it might just as well be a normal function rather than a class.</p>\n\n<p>Fundamentally, the problem is that you're trying to do something like</p>\n\n<pre><code>foobar :: Show x =&gt; Either Int Bool -&gt; x\nfoobar (Left  x) = x\nfoobar (Right x) = x\n</code></pre>\n\n<p>This won't work. It tries to make <code>foobar</code> return a different type depending on the value you feed it at run-time. But in Haskell, all types must be 100% determined at <em>compile-time</em>. So this cannot work.</p>\n\n<p>There are several things you <em>can</em> do, however.</p>\n\n<p>First of all, you <em>can</em> do this:</p>\n\n<pre><code>foo :: Either Int Bool -&gt; String\nfoo (Left  x) = show x\nfoo (Right x) = show x\n</code></pre>\n\n<p>In other words, rather than return something showable, <em>actually show it</em>. That means the result type is always <code>String</code>. It means that which version of <code>show</code> gets called will vary at run-time, but that's fine. Code paths can vary at run-time, it's <em>types</em> which cannot.</p>\n\n<p>Another thing you <em>can</em> do is this:</p>\n\n<pre><code>toInt :: Either Int Bool -&gt; Maybe Int\ntoInt (Left  x) = Just x\ntoInt (Right x) = Nothing\n\ntoBool :: Either Int Bool -&gt; Maybe Bool\ntoBool (Left  x) = Nothing\ntoBool (Right x) = Just x\n</code></pre>\n\n<p>Again, that works perfectly fine.</p>\n\n<p>There are other things you <em>can</em> do; without knowing why you want this, it's difficult to suggest others.</p>\n\n<p>As a side note, you want to stop thinking about this like it's object oriented programming. It isn't. It requires a new way of thinking. In particular, don't reach for a typeclass unless you really need one. (I realise this particular example may just be a learning exercise to learn about typeclasses of course...)</p>\n"}, {"tags": [], "owner": {"reputation": 2196, "user_id": 1980863, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9248211c4148f5d7df2269aa711e2e?s=128&d=identicon&r=PG", "display_name": "RandomB", "link": "https://stackoverflow.com/users/1980863/randomb"}, "is_accepted": false, "score": 0, "last_activity_date": 1534411406, "creation_date": 1534411406, "answer_id": 51873685, "question_id": 37589361, "link": "https://stackoverflow.com/questions/37589361/how-do-you-apply-function-constraints-in-instance-methods-in-haskell/51873685#51873685", "title": "How do you apply function constraints in instance methods in Haskell?", "body": "<p>It's possible to do this:</p>\n\n<pre><code>class Eq u =&gt; T t u | t -&gt; u where\n    f :: t -&gt; u\n</code></pre>\n\n<p>You need FlexibleContextx+FunctionalDepencencies and MultiParamTypeClasses+FlexibleInstances on call-site. Or to eliminate class and to use data types instead like Gabriel shows <a href=\"http://www.haskellforall.com/2012/05/scrap-your-type-classes.html\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 4507, "user_id": 305949, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/38d369d1ad1a4ffba29c6ee1eae6a19f?s=128&d=identicon&r=PG", "display_name": "FK82", "link": "https://stackoverflow.com/users/305949/fk82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1881, "favorite_count": 1, "accepted_answer_id": 37589470, "answer_count": 3, "score": 7, "last_activity_date": 1534411406, "creation_date": 1464863634, "last_edit_date": 1465108884, "question_id": 37589361, "link": "https://stackoverflow.com/questions/37589361/how-do-you-apply-function-constraints-in-instance-methods-in-haskell", "title": "How do you apply function constraints in instance methods in Haskell?", "body": "<p>I'm learning how to use <em>typeclasses</em> in Haskell. </p>\n\n<p>Consider the following implementation of a typeclass <code>T</code> with a type constrained class function <code>f</code>.</p>\n\n<pre><code>class T t where\n    f :: (Eq u) =&gt; t -&gt; u \n\ndata T_Impl = T_Impl_Bool Bool | T_Impl_Int Int | T_Impl_Float Float \ninstance T T_Impl where\n    f (T_Impl_Bool x) = x\n    f (T_Impl_Int x) = x\n    f (T_Impl_Float x) = x\n</code></pre>\n\n<hr>\n\n<p>When I load this into GHCI 7.10.2, I get the following error:</p>\n\n<blockquote>\n<pre><code>Couldn't match expected type \u2018u\u2019 with actual type \u2018Float\u2019\n      \u2018u\u2019 is a rigid type variable bound by\n          the type signature for f :: Eq u =&gt; T_Impl -&gt; u \n          at generics.hs:6:5\n\nRelevant bindings include\n  f :: T_Impl -&gt; u (bound at generics.hs:6:5)\nIn the expression: x\nIn an equation for \u2018f\u2019: f (T_Impl_Float x) = x\n</code></pre>\n</blockquote>\n\n<hr>\n\n<p>What am I doing/understanding wrong? It seems reasonable to me that one would want to specialize a typeclass in an instance by providing an accompaning data constructor and function implementation. The part</p>\n\n<blockquote>\n  <p>Couldn't match expected type '<code>u</code>' with actual type '<code>Float</code>'</p>\n</blockquote>\n\n<p>is especially confusing. Why does <code>u</code> not match <code>Float</code> if <code>u</code> only has the constraint that it must qualify as an <code>Eq</code> type (<code>Float</code>s do that afaik)?</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1464856017, "post_id": 37585503, "comment_id": 62658415, "body": "There isn&#39;t a GHC package, neither on Stackage, nor on Hackage. What exactly are you trying to do?"}], "answers": [{"comments": [{"owner": {"reputation": 427, "user_id": 2711315, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1ffa40725d2eafd3505dbf3832ce42bf?s=128&d=identicon&r=PG", "display_name": "aesadde", "link": "https://stackoverflow.com/users/2711315/aesadde"}, "edited": false, "score": 0, "creation_date": 1464864410, "post_id": 37587183, "comment_id": 62664260, "body": "I already have <code>ghc</code> and <code>ghc-paths</code> in the <code>build-depends</code> of the project.  I am using GHC API to compile some modules to Core but somehow it fails to compile hidden modules inside a package I believe, so I was trying to follow advice from <a href=\"http://codeutopia.net/blog/2011/08/20/adventures-in-haskell-dynamic-loading-and-compiling-of-modules/\" rel=\"nofollow noreferrer\">this</a> blogpost to see if I could solve the problems"}], "tags": [], "owner": {"reputation": 3075, "user_id": 1164871, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6a54a3752ab47170d790085935988f?s=128&d=identicon&r=PG", "display_name": "mgsloan", "link": "https://stackoverflow.com/users/1164871/mgsloan"}, "is_accepted": false, "score": 2, "last_activity_date": 1464858019, "creation_date": 1464858019, "answer_id": 37587183, "question_id": 37585503, "link": "https://stackoverflow.com/questions/37585503/exposing-package-through-stack-exec/37587183#37587183", "title": "Exposing package through stack exec", "body": "<p>If your application needs to build against <code>ghc</code>, then add it to the <code>build-depends</code> in your cabal file.  If your application needs to run the ghc executable, then it will be visible from within <code>stack exec</code>.</p>\n\n<p>So if your project is using ghc-7.10.3, the proper ghc version should be on the PATH.</p>\n\n<p>If you want <code>stack exec</code> to use a different resolver or compiler than configured, do <code>stack --resolver lts-6.0</code>, or <code>stack exec --compiler ghc-7.10.3</code></p>\n"}, {"tags": [], "owner": {"reputation": 427, "user_id": 2711315, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1ffa40725d2eafd3505dbf3832ce42bf?s=128&d=identicon&r=PG", "display_name": "aesadde", "link": "https://stackoverflow.com/users/2711315/aesadde"}, "is_accepted": true, "score": 0, "last_activity_date": 1469980521, "creation_date": 1469980521, "answer_id": 38685769, "question_id": 37585503, "link": "https://stackoverflow.com/questions/37585503/exposing-package-through-stack-exec/38685769#38685769", "title": "Exposing package through stack exec", "body": "<p>I had forgotten about this!</p>\n\n<p>For future reference.</p>\n\n<p>In the end all I had to do was <code>ghc-pkg expose ghc</code>. </p>\n"}], "owner": {"reputation": 427, "user_id": 2711315, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1ffa40725d2eafd3505dbf3832ce42bf?s=128&d=identicon&r=PG", "display_name": "aesadde", "link": "https://stackoverflow.com/users/2711315/aesadde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "accepted_answer_id": 38685769, "answer_count": 2, "score": 1, "last_activity_date": 1469980521, "creation_date": 1464853030, "question_id": 37585503, "link": "https://stackoverflow.com/questions/37585503/exposing-package-through-stack-exec", "title": "Exposing package through stack exec", "body": "<p>I have been trying build and run an application that needs access to the <code>ghc</code> package but I can't manage to expose it through <code>stack</code>.</p>\n\n<p>I know this should be an easy flag <code>-package ghc</code> but how do I do that with stack?</p>\n\n<p>I've tried this:\n<code>stack exec Engine-exe --package ghc-7.10.3 -- core</code></p>\n\n<p>I get this:</p>\n\n<pre><code>Didn't see ghc-7.10.3 in your package indices.\nUpdating and trying again.\nFetching package index ...remote: Counting objects: 1, done.\nremote: Total 1 (delta 0), reused 1 (delta 0), pack-reused 0\nUnpacking objects: 100% (1/1), done.\nFetched package index.\nThe following package identifiers were not found in your indices: ghc-7.10.3\nPerhaps you meant gc, ghci, ght, or lhc?\n</code></pre>\n\n<p>I've also tried to build it as: <code>stack build --ghc-options -package ghc\n</code> and get the same result.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1464855815, "post_id": 37584912, "comment_id": 62658288, "body": "Could not reproduce. After importing <code>Data.Word8</code> (did you forget to do this?), the <code>_x</code> constant works fine. Perhaps you should include detailed instructions for reproducing your error."}], "answers": [{"comments": [{"owner": {"reputation": 1029, "user_id": 668074, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/f82d3dd033cd691ad5340b9620bdcf38?s=128&d=identicon&r=PG", "display_name": "user668074", "link": "https://stackoverflow.com/users/668074/user668074"}, "edited": false, "score": 0, "creation_date": 1464861507, "post_id": 37586379, "comment_id": 62662281, "body": "Well, I feel dumb. I think it was an unfortunate coincidence that typed-holes involve similar errors as undefined variables and involve underscores. That was quite a rabbit hole."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 5, "last_activity_date": 1464855760, "creation_date": 1464855760, "answer_id": 37586379, "question_id": 37584912, "link": "https://stackoverflow.com/questions/37584912/role-of-ascii-character-variables-in-data-word8/37586379#37586379", "title": "Role of ASCII character variables in Data.Word8", "body": "<blockquote>\n  <p>(a) Why Data.Word8 uses them </p>\n</blockquote>\n\n<p>It doesn't. You forgot to <code>import Data.Word8</code>. Therefore, the identifier <code>_x</code> is unknown:</p>\n\n<pre><code>GHCi, version 7.10.3: http://www.haskell.org/ghc/  :? for help\nghci&gt; _x\n\n&lt;interactive&gt;:2:1:\n    Found hole \u2018_x\u2019 with type: t\n    Where: \u2018t\u2019 is a rigid type variable bound by\n               the inferred type of it :: t at &lt;interactive&gt;:2:1\n    Relevant bindings include it :: t (bound at &lt;interactive&gt;:2:1)\n    In the expression: _x\n    In an equation for \u2018it\u2019: it = _x\nghci&gt; import Data.Word8\nghci&gt; _x\n120\n</code></pre>\n\n<blockquote>\n  <p>(b) How can the typed-holes appear on the LHS of the equals sign</p>\n</blockquote>\n\n<p>It <em>does</em> appear on the right hand side, because GHCi uses <code>it = &lt;last-expression&gt;</code>. Since the last expression was <code>_x</code>, you suddenly have a typed hole.</p>\n\n<blockquote>\n  <p>(c) How can I use these variables in my code?</p>\n</blockquote>\n\n<p><strong><em>Import</em></strong> <code>Data.Word8</code>.</p>\n"}], "owner": {"reputation": 1029, "user_id": 668074, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/f82d3dd033cd691ad5340b9620bdcf38?s=128&d=identicon&r=PG", "display_name": "user668074", "link": "https://stackoverflow.com/users/668074/user668074"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 37586379, "answer_count": 1, "score": 1, "last_activity_date": 1464860914, "creation_date": 1464851255, "last_edit_date": 1464860914, "question_id": 37584912, "link": "https://stackoverflow.com/questions/37584912/role-of-ascii-character-variables-in-data-word8", "title": "Role of ASCII character variables in Data.Word8", "body": "<p>I was trying to find a variable for the ord value of a letter (a=97,A=65) to make my code easier to read. I found that the <code>Data.Word8</code> module defines some variables for characters in the following way:</p>\n\n<pre><code>_a = 0x61\n_b = 0x62\n_c = 0x63\n_d = 0x64\n</code></pre>\n\n<p>etc.</p>\n\n<p>However, when I try to use these variables I get the following error:</p>\n\n<pre><code>Found hole `_x' with type: t\nWhere: `t' is a rigid type variable bound by\n           the inferred type of it :: t at &lt;interactive&gt;:27:1\nRelevant bindings include it :: t (bound at &lt;interactive&gt;:27:1)\nIn the expression: _x\nIn an equation for `it': it = _x\n</code></pre>\n\n<p>This is the first time I've encountered typed-holes. After looking at an introduction to typed-holes I still don't understand (a) Why <code>Data.Word8</code> uses them and (b) How can the typed-holes appear on the LHS of the equals sign. In the introduction I read they only appear on the RHS (c) How can I use these variables in my code?</p>\n\n<p>If anyone has an explanation it would be appreciated.</p>\n\n<p>Edit: I feel a bit stupid now. I was mixing up the <code>Data.Word8</code> package with the <code>Data.Word</code> package which contains the <code>Word8</code> data type.</p>\n"}, {"tags": ["performance", "haskell"], "comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 1, "creation_date": 1464843096, "post_id": 37582807, "comment_id": 62652161, "body": "Have you compiled your program, can you give some evidence of your claim? Usually you use <code>seq</code> or bang patterns to make calculations more strict. Also switching to Into or Word64 provides a significant speedup"}, {"owner": {"reputation": 49, "user_id": 6412274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/888fe06a1b7526091500ea1c773489c7?s=128&d=identicon&r=PG&f=1", "display_name": "C.J", "link": "https://stackoverflow.com/users/6412274/c-j"}, "reply_to_user": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 0, "creation_date": 1464844129, "post_id": 37582807, "comment_id": 62652501, "body": "@epsilonhalbe Added more details. I don&#39;t think Word64 works as the input may out of range."}, {"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 6, "creation_date": 1464844541, "post_id": 37582807, "comment_id": 62652614, "body": "Notice that in JavaScript all number are double-precision floating point numbers. Your <code>m</code> is already out of the range where integers are precisely representable; this code neither will give accurate results nor is it comparable to Haskell&#39;s <code>Integer</code>s."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 4, "creation_date": 1464845692, "post_id": 37582807, "comment_id": 62652999, "body": "The equivalent Haskell code has type <code>Double -&gt; Double</code> and uses <code>** 3</code> instead of <code>^3</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1464849968, "post_id": 37582807, "comment_id": 62654925, "body": "@Bakuriu, wouldn&#39;t <code>^3</code> be faster than <code>**3</code>?"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1464850834, "post_id": 37582807, "comment_id": 62655401, "body": "@dfeuer I don&#39;t think so. <code>^</code> is a more generic operation while <code>**</code> is specifically floating exponentiation which is what the javascript code does."}], "answers": [{"comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1464851583, "post_id": 37584962, "comment_id": 62655785, "body": "Yes, but his point was he didn&#39;t want to change the algorithm, he wanted to use the naive approach as a benchmark and figure out the performance issues with the language and compiler under question."}, {"owner": {"reputation": 11293, "user_id": 981855, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/44e220c5150326866af030a7c9d944b3?s=128&d=identicon&r=PG", "display_name": "madjar", "link": "https://stackoverflow.com/users/981855/madjar"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1464854067, "post_id": 37584962, "comment_id": 62657199, "body": "Oh, indeed, I misread the question (that&#39;ll teach be to not do this before breakfast). Thanks for pointing it out."}], "tags": [], "owner": {"reputation": 11293, "user_id": 981855, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/44e220c5150326866af030a7c9d944b3?s=128&d=identicon&r=PG", "display_name": "madjar", "link": "https://stackoverflow.com/users/981855/madjar"}, "is_accepted": false, "score": 4, "last_activity_date": 1464854181, "last_edit_date": 1464854181, "creation_date": 1464851393, "answer_id": 37584962, "question_id": 37582807, "link": "https://stackoverflow.com/questions/37582807/optimize-haskell-function-with-huge-numbers-of-power-function-call/37584962#37584962", "title": "Optimize haskell function with huge numbers of power function call", "body": "<p>EDIT : I realized afterward that's not what the author of the question wanted. I'll keep it there as a in case someone wants to know the formula in question, but otherwise please disregard.</p>\n\n<hr>\n\n<p>There is indeed a formula that lets you compute this in constant time (rather than n iterations). Since I couldn't remember the exact formula from school, I did a bit of searching, and here is is: <a href=\"https://proofwiki.org/wiki/Sum_of_Sequence_of_Cubes\" rel=\"nofollow\">https://proofwiki.org/wiki/Sum_of_Sequence_of_Cubes</a>.</p>\n\n<p>In haskell code, that would translate to</p>\n\n<pre><code>findNb n = n ^ 2 * (n + 1) ^ 2 / 4\n</code></pre>\n\n<p>which I believe should be much faster.</p>\n"}, {"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 6, "last_activity_date": 1464851535, "creation_date": 1464851535, "answer_id": 37585003, "question_id": 37582807, "link": "https://stackoverflow.com/questions/37582807/optimize-haskell-function-with-huge-numbers-of-power-function-call/37585003#37585003", "title": "Optimize haskell function with huge numbers of power function call", "body": "<p>Haskell too can use <code>Double</code> to get the wrong answer in less time:</p>\n\n<pre><code>% time ./so\n./so  0.03s user 0.00s system 95% cpu 0.038 total\n</code></pre>\n\n<p>And Javascript too can get the correct result via npm-installing <code>big-integer</code> and using bigInt everywhere instead of Double:</p>\n\n<pre><code>% node so.js\n^C\nnode so.js  35.62s user 0.30s system 93% cpu 38.259 total\n</code></pre>\n\n<p>... or maybe it isn't as trivial as that.</p>\n"}, {"tags": [], "owner": {"reputation": 2313, "user_id": 5318306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/897fd4f3b92d28c5c1eb28a8024661a1?s=128&d=identicon&r=PG&f=1", "display_name": "Gurkenglas", "link": "https://stackoverflow.com/users/5318306/gurkenglas"}, "is_accepted": false, "score": 0, "last_activity_date": 1464859798, "creation_date": 1464859798, "answer_id": 37587861, "question_id": 37582807, "link": "https://stackoverflow.com/questions/37582807/optimize-haskell-function-with-huge-numbers-of-power-function-call/37587861#37587861", "title": "Optimize haskell function with huge numbers of power function call", "body": "<p>Not sure if this wording of that algorithm is faster, but try this?</p>\n\n<pre><code>findNb :: Integer -&gt; Integer\nfindNb m = length $ takeWhile (&lt;=m) $ scanl1 (+) [n^3 | n &lt;- [1..]]\n</code></pre>\n\n<p>(This has different semantics in the undefined case, though.)</p>\n"}], "owner": {"reputation": 49, "user_id": 6412274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/888fe06a1b7526091500ea1c773489c7?s=128&d=identicon&r=PG&f=1", "display_name": "C.J", "link": "https://stackoverflow.com/users/6412274/c-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 1, "answer_count": 3, "score": 2, "last_activity_date": 1464859798, "creation_date": 1464842518, "last_edit_date": 1464859009, "question_id": 37582807, "link": "https://stackoverflow.com/questions/37582807/optimize-haskell-function-with-huge-numbers-of-power-function-call", "title": "Optimize haskell function with huge numbers of power function call", "body": "<p>The following function is to find a number <code>n</code> which <code>1^3 + 2^3 + ... + (n-1) ^3 + n^3 = m</code>. Is there any chance this function can be optimized for speed?  </p>\n\n<pre><code>findNb :: Integer -&gt; Integer\nfindNb m = findNb' 1 0\n  where findNb' n m' =\n          if m' == m then n - 1\n          else if  m' &lt; m then findNb' (n + 1) (m' + n^3)\n          else -1\n</code></pre>\n\n<p>I know there is a faster solution by using a math formula. </p>\n\n<p>The reason I'm asking is that the similar implementation in JavaScript / C# seems far more faster than in Haskell. I'm just curious if it can be optimized.  Thanks. </p>\n\n<h2>EDIT1: Add more evidences on the rum time</h2>\n\n<h1>Haskell Version:</h1>\n\n<p>With <code>main = print (findNb2 152000000000000000000000)</code>: </p>\n\n<ol>\n<li><p>Compile with <strong>-O2</strong> and profiling: <code>ghc -o testo2.exe -O2 -prof -fprof-auto -rtsopts pileofcube.hs</code>. Here is total time from profiling report: </p>\n\n<p>total time  =        <strong>0.19</strong> secs (190 milliseconds)   (190 ticks @ 1000 us, 1 processor)</p></li>\n<li><p>Compile with -O2 but no profiling: <code>ghc -o testo22.exe -O2 pileofcube.hs</code>. Run it with <code>Measure-Command {./testo22.exe}</code> in powershell. The result is:</p>\n\n<p>Milliseconds      : <strong>157</strong> </p></li>\n</ol>\n\n<h2>JavaScript Version:</h2>\n\n<p>Code: </p>\n\n<pre><code>function findNb(m) {\n    let n = 0;\n    let sum = 0;\n    while (sum &lt; m) {\n      n++;\n      sum += Math.pow(n, 3);\n    }\n\n    return sum === m ? n : -1;\n}\nvar d1 = new Date();\nfindNb(152000000000000000000000);\nconsole.log(new Date() - d1);\n</code></pre>\n\n<p>Result: <strong>45</strong> milliseconds running in Chrome on the same machine</p>\n\n<h2>EDIT2: Add C# Version</h2>\n\n<p>As @Berji and @Bakuriu commented, comparing to the JavaScript version above is not fair as it uses double-precision floating point numbers underlying and could not give the correct answer even.  So I implemented it in C#, here is the code and result: </p>\n\n<pre><code> static void Main(string[] args)\n        {\n            BigInteger m = BigInteger.Parse(\"152000000000000000000000\");\n            var s = new Stopwatch();\n            s.Start();\n            long n = 0;\n            BigInteger sum = 0;\n            while (sum &lt; m)\n            {\n                n++;\n                sum += BigInteger.Pow(n, 3);\n            }\n\n            Console.WriteLine(sum == m ? n : -1);\n            s.Stop();\n            Console.WriteLine($\"Escaped Time: {s.ElapsedMilliseconds} milliseconds.\");\n        }\n</code></pre>\n\n<p>Result: Escaped Time: <strong>457</strong> milliseconds.</p>\n\n<h2>Conclusion</h2>\n\n<p>Haskell version is faster than C# one...  </p>\n\n<p>I was wrong at start because I didn't realized JavaScript use double-precision floating point numbers under the hood due to my poor JavaScript knowledge. </p>\n\n<p>At this point seems the question does not make sense anymore... </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 659, "user_id": 6067119, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/893dbce2becf20ee2a3dcb6dee6ea5f2?s=128&d=identicon&r=PG&f=1", "display_name": "Qwertford", "link": "https://stackoverflow.com/users/6067119/qwertford"}, "edited": false, "score": 0, "creation_date": 1464833853, "post_id": 37581475, "comment_id": 62649898, "body": "Wait a second, am I misunderstanding how this function works? Im thinking that the list created is recursively fed into itself. and the list increases in length each time its fed into itself. I think the list would be doubled because  start:[(operation x changeby)| x&lt;-(infiniteList start operation changeby)] is the list so far concatenated with (infiniteList start operation changeby)"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 1, "creation_date": 1464835937, "post_id": 37581475, "comment_id": 62650331, "body": "Empirical benchmarking suggests that, as written, execution time is quadratic, even when compiled with -O2."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1464836906, "post_id": 37581475, "comment_id": 62650556, "body": "This isn&#39;t relevant, but your <code>Floating a</code> context is completely useless and should be removed."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 1, "creation_date": 1464840449, "post_id": 37581475, "comment_id": 62651286, "body": "btw - in the title did you mean to write O(n^2) instead of O(2^n)?"}], "answers": [{"tags": [], "owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "is_accepted": false, "score": 1, "last_activity_date": 1464835828, "creation_date": 1464835828, "answer_id": 37581840, "question_id": 37581475, "link": "https://stackoverflow.com/questions/37581475/is-the-computational-complexity-of-this-function-o2n-or-on/37581840#37581840", "title": "Is the computational complexity of this function O(2^n) or O(n)", "body": "<p>I'm not sure where you are getting the \"batches\" idea from. Below is a transcript of the first few elements of the list. From that, I think you should be able to figure out the complexity.</p>\n\n<p>What's the first element of the list? It is <code>start</code>, because <code>infiniteList</code> is defined as <code>start:[something]</code>, and the first element of any list of that form is <code>start</code>.</p>\n\n<p>What is the second element of the list? We certainly need to consult the <code>[something]</code> portion of the list above. The first element of that sublist is <code>operation x changeby</code> where <code>x</code> is the first element of <code>infiniteList</code>. We decided already that the first element is <code>start</code>, so the second element is <code>operation start changeby</code>, which is exactly what we wanted. What do we have to compute to get the second element? Just the first, plus the <code>operation</code>.</p>\n\n<p>What is the third element of the list? It's the second element of <code>[something]</code>, which is <code>operation x changeby</code> where <code>x</code> is the second element of <code>infiniteList</code>. Fortunately, we just calculated what that is...\nWhat do we have to compute to get the third element? Just the first and second, plus the <code>operation</code>.</p>\n\n<p>Although it doesn't directly answer the question, you should ask yourself what complexity you <em>expect</em> the function to have. How much work needs to be done to get the <code>n</code>th element? It's possible that your implementation in code is worse, but it might help you think about your code differently.</p>\n"}, {"tags": [], "owner": {"reputation": 3633, "user_id": 675154, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/23da6806cab4830b5d1b15ef2a410541?s=128&d=identicon&r=PG", "display_name": "delta", "link": "https://stackoverflow.com/users/675154/delta"}, "is_accepted": false, "score": 1, "last_activity_date": 1464837229, "creation_date": 1464837229, "answer_id": 37582008, "question_id": 37581475, "link": "https://stackoverflow.com/questions/37581475/is-the-computational-complexity-of-this-function-o2n-or-on/37582008#37582008", "title": "Is the computational complexity of this function O(2^n) or O(n)", "body": "<p>Just do some math, assume calculate nth item requires <code>T(n)</code> calculations, as</p>\n\n<pre><code>[(operation x changeby)| x&lt;-(infiniteList start operation changeby)]\n</code></pre>\n\n<p>suggests, we need to know sub problem <code>T(n-1)</code>, and the full list comprehension have <code>n-1</code> operations, and then concat <code>star:...</code> operation is efficient, and have <code>1</code> calculation, so</p>\n\n<pre><code>T(n) = T(n-1) + (n - 1) + 1 = T(n-1) + n -&gt; O(n^2)\n</code></pre>\n\n<hr>\n\n<p>Actually, you can \"feel\" the time complexity just by running some examples. Let <code>f n = (infiniteList 0 (+) 1) !! n</code>, then run <code>f 10</code>, <code>f 100</code>, <code>f 1000</code>, <code>f 10000</code>, you can see the difference.</p>\n\n<p>Usually, when <code>n=1000</code> runs in no time, <code>n=10000</code> run some time like 1 or 2 seconds, and <code>n=100000</code> run forever, it is usually <code>O(n^2)</code>.</p>\n\n<hr>\n\n<p>BTW, there is an <code>O(n)</code> approach:</p>\n\n<pre><code>infi :: a -&gt; (a -&gt; a -&gt; a) -&gt; a -&gt; [a]\ninfi x f s = x : infi (f x s) f s\n</code></pre>\n\n<p>You can do some math and run some examples to feel the difference.</p>\n"}, {"tags": [], "owner": {"reputation": 2863, "user_id": 2297560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/948d4a17494b3c616a0873453b74670c?s=128&d=identicon&r=PG", "display_name": "user2297560", "link": "https://stackoverflow.com/users/2297560/user2297560"}, "is_accepted": false, "score": 1, "last_activity_date": 1464837415, "creation_date": 1464837415, "answer_id": 37582036, "question_id": 37581475, "link": "https://stackoverflow.com/questions/37581475/is-the-computational-complexity-of-this-function-o2n-or-on/37582036#37582036", "title": "Is the computational complexity of this function O(2^n) or O(n)", "body": "<p>One strategy that sometimes helps with recursion is to expand it out a few times to get a better idea of what's going on. Let's try that:</p>\n\n<pre><code>infiniteList start operation changeby = \nstart:[(operation x changeby) | x &lt;-\n       start:[(operation x changeby) | x &lt;-\n              start:[(operation x changeby) | x &lt;-\n                     start:[(operation x changeby) | x &lt;-\n                            start:[(operation x changeby) | x &lt;- (infiniteList start operation changeby)]]]]]\n</code></pre>\n\n<p>We can see the first element in the list is going to be <code>start</code> as expected. Then the second element will be <code>start</code> from the first recursive call passed through <code>operation x changeby</code>. What will the third item be? Well it'll be the second item of the first recursive call, so it'll be <code>start</code> passed through two calls of <code>operation x changeby</code>. Now the pattern emerges! In general, the nth item of <code>infiniteList</code> will be <code>start</code> with <code>operation x changeby</code> called on it <code>n-1</code> times. This is rather unfortunate because ,as any student of computer science knows, <code>1 + 2 + ... + n - 1 = n(n-1)/2 = O(n^2)</code>.</p>\n\n<p>There is, of course, a much more efficient way to write this function. Instead of applying <code>operation x changeby</code> to <code>start</code> n-1 times to get the nth item, why don't we just apply it once to the previous item? This will give us an <code>O(n)</code> solution. For example, we can use <code>unfoldr</code> from <code>Data.List</code>:</p>\n\n<pre><code>import Data.List (unfoldr)\n\ninfiniteList start operation changeby =\n    unfoldr (\\x -&gt; Just (x, operation x changeby)) start\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 7, "last_activity_date": 1464838051, "last_edit_date": 1464838051, "creation_date": 1464837509, "answer_id": 37582048, "question_id": 37581475, "link": "https://stackoverflow.com/questions/37581475/is-the-computational-complexity-of-this-function-o2n-or-on/37582048#37582048", "title": "Is the computational complexity of this function O(2^n) or O(n)", "body": "<p>A key tool is the following rule:</p>\n\n<blockquote>\n  <p>When analyzing the <em>performance</em> (not the totality) of a binding, you are allowed to assume, when analyzing its right-hand-side, that the binding itself has been fully evaluated.</p>\n</blockquote>\n\n<p>You are defining <code>infiniteList</code>, so you are allowed to assume that in the RHS, the <code>infiniteList</code> binding has been fully evaluated. That, unfortunately, isn't useful, because <code>infiniteList</code> is just a function, and fully evaluating it just gives you the function!</p>\n\n<p>But you can use this reasoning tool to figure out a fix: you have to <em>bind the right thing</em>.</p>\n\n<pre><code>infiniteList :: a -&gt; (a -&gt; a -&gt; a) -&gt; a -&gt; [a]\ninfiniteList start operation changeby =\n  let result =\n    start : [operation x changeby | x &lt;- result]\n  in result\n</code></pre>\n\n<p>Now you have a <em>useful</em> binding, <code>result</code>, which you can assume is fully evaluated! In the RHS, you now have, essentially,</p>\n\n<pre><code>start : map (\\x -&gt; operation x changeby) result\n</code></pre>\n\n<p>which is clearly <code>O(n)</code>.</p>\n\n<p>Indeed with the first definition,</p>\n\n<pre><code>&gt; infiniteList 1 (*) 2 !! 10000\n</code></pre>\n\n<p>takes longer than I wish to wait, but with the modified definition, it takes a mere 0.04 seconds even in GHCi.</p>\n"}, {"comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1464838381, "post_id": 37582143, "comment_id": 62650864, "body": "Sorry - I didn&#39;t see your post before I posted mine. But I upvoted you, though."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 2, "last_activity_date": 1464838113, "creation_date": 1464838113, "answer_id": 37582143, "question_id": 37581475, "link": "https://stackoverflow.com/questions/37581475/is-the-computational-complexity-of-this-function-o2n-or-on/37582143#37582143", "title": "Is the computational complexity of this function O(2^n) or O(n)", "body": "<p>The run time depends a lot on how GHC decides to evaluate it.</p>\n\n<p>To simplify things, consider this version of the function:</p>\n\n<pre><code>inf a f = a : [ f x | x &lt;- inf a f ]\n</code></pre>\n\n<p>If GHC performed common sub-expression elimination on <code>int a f</code>, it could decide to evaluate it as if it had been written:</p>\n\n<pre><code>inf a f = let r = a : [ f x | x &lt;- r ]\n          in r\n</code></pre>\n\n<p>and this runs in linear time.</p>\n"}], "owner": {"reputation": 659, "user_id": 6067119, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/893dbce2becf20ee2a3dcb6dee6ea5f2?s=128&d=identicon&r=PG&f=1", "display_name": "Qwertford", "link": "https://stackoverflow.com/users/6067119/qwertford"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "answer_count": 5, "score": 1, "last_activity_date": 1464838113, "creation_date": 1464832770, "last_edit_date": 1464835022, "question_id": 37581475, "link": "https://stackoverflow.com/questions/37581475/is-the-computational-complexity-of-this-function-o2n-or-on", "title": "Is the computational complexity of this function O(2^n) or O(n)", "body": "<p>I want to make a function that creates an infinite list that takes two numbers and an operator as input so it can generate arithmetic and geometric sequences.</p>\n\n<pre><code>infiniteList:: (Floating a)=&gt;a-&gt;(a-&gt;a-&gt;a)-&gt;a-&gt;[a]\ninfiniteList start operation changeby = \n  start:[(operation x changeby)| x&lt;-(infiniteList start operation changeby)]\n</code></pre>\n\n<p>the code compiles and works properly: <code>infiniteList 1 (*) 2</code> generates a list starting from 1 and subsequent numbers are double its predecessor.</p>\n\n<p>Now I'm having trouble figuring out the computational complexity \"to calculate the nth element of the list\". Technically it is doing one operation to figure out each element of the list. However, if you were after the (2^k +1) term, I would have to wait for the computer to finish calculating 2^(k+1) elements first. </p>\n\n<p>I hope I'm explaining this properly, so basically I think the program produces the elments in 2^k batches where k is an integer, so you could potentially be waiting for ( 2^(k+1)-2^k) time to calculate the (2^k +1)th integer. So what is the computational complexity \"to calculate the nth element of the list\"?</p>\n"}]