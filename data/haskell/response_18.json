[{"tags": ["haskell", "combinations"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4890258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7f1e6a0e9aff44f199eb7d575ef6179?s=128&d=identicon&r=PG&f=1", "display_name": "JimmyCo", "link": "https://stackoverflow.com/users/4890258/jimmyco"}, "edited": false, "score": 0, "creation_date": 1431559274, "post_id": 30225969, "comment_id": 48557355, "body": "Excellent, thank you. That&#39;s just the thing I was after."}], "tags": [], "owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "is_accepted": true, "score": 1, "last_activity_date": 1431554620, "creation_date": 1431554620, "answer_id": 30225969, "question_id": 30225948, "link": "https://stackoverflow.com/questions/30225948/generate-a-list-of-unique-combinations-from-a-list/30225969#30225969", "title": "Generate a list of unique combinations from a list", "body": "<pre><code>pairs xs = [[x1, x2] | (x1:xs1) &lt;- tails xs, x2 &lt;- xs1]\n</code></pre>\n\n<p>...assuming the list starts out unique, or you could compose this with <code>nub</code> otherwise.</p>\n"}], "owner": {"reputation": 3, "user_id": 4890258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7f1e6a0e9aff44f199eb7d575ef6179?s=128&d=identicon&r=PG&f=1", "display_name": "JimmyCo", "link": "https://stackoverflow.com/users/4890258/jimmyco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 821, "favorite_count": 0, "accepted_answer_id": 30225969, "answer_count": 1, "score": 0, "last_activity_date": 1431554620, "creation_date": 1431554514, "question_id": 30225948, "link": "https://stackoverflow.com/questions/30225948/generate-a-list-of-unique-combinations-from-a-list", "title": "Generate a list of unique combinations from a list", "body": "<p>I want to generate a list of all unique ways to choose two from a list of numbers in Haskell. So from the list <code>[1,2,3]</code> I would like <code>[[1,2],[2,3],[1,3]]</code>. Order is not important so I want to avoid producing both <code>[1,2]</code> and <code>[2,1]</code> for example. </p>\n\n<p>My current solution is:</p>\n\n<pre><code>pairs :: Ord a =&gt; [a] -&gt; [[a]]\npairs x = nub $ map sort $ map (take 2) (permutations x)\n</code></pre>\n\n<p>This isn't a particularly nice solution however and it certainly has some serious performance issues. Is there a simple and efficient solution to this problem?</p>\n"}, {"tags": ["haskell", "theorem-proving", "dependent-type", "higher-rank-types"], "comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 5, "creation_date": 1431550005, "post_id": 30224796, "comment_id": 48553564, "body": "Someone light the @pigworker signal."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 7, "creation_date": 1431550055, "post_id": 30224796, "comment_id": 48553599, "body": "@ReinHenrichs I think you have to project a <code>\u03a0</code> onto the night sky to catch his attention"}, {"owner": {"reputation": 91978, "user_id": 387076, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/cFyP6.jpg?s=128&g=1", "display_name": "Gilles &#39;SO- stop being evil&#39;", "link": "https://stackoverflow.com/users/387076/gilles-so-stop-being-evil"}, "edited": false, "score": 0, "creation_date": 1431551674, "post_id": 30224796, "comment_id": 48554469, "body": "While this question is on-topic here due to the Haskell involvement, it has a strong type-theoretic bent, so it might have a better chance on <a href=\"https://cs.stackexchange.com\">Computer Science</a> (or perhaps even <a href=\"https://cstheory.stackexchange.com\">Theoretical Computer Science</a>). Do not repost; you can request that your question be migrating by flagging it."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 91978, "user_id": 387076, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/cFyP6.jpg?s=128&g=1", "display_name": "Gilles &#39;SO- stop being evil&#39;", "link": "https://stackoverflow.com/users/387076/gilles-so-stop-being-evil"}, "edited": false, "score": 2, "creation_date": 1431551818, "post_id": 30224796, "comment_id": 48554536, "body": "@Gilles Let&#39;s see whether it gets any answers and migrate it if not :)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1431557915, "post_id": 30224796, "comment_id": 48557005, "body": "This seems reminiscent of, although more powerful than, the correspondence between <code>type Not1 a = a -&gt; Void</code> and <code>type Not2 a = forall b . a -&gt; b</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 5, "creation_date": 1431558112, "post_id": 30224796, "comment_id": 48557050, "body": "Here is a fun question to ponder: for a given type <code>a</code>, what is the difference between <code>forall v. (a -&gt; v) -&gt; v</code> and <code>a</code>? Then observe that <code>=&gt;</code> is basically implemented as a function in GHC, and you have discovered a way to represent a value of type <code>l ~ r</code> even though that&#39;s not an inhabitable type in GHC-Haskell, namely, in its CPS&#39;d form as <code>forall v. ((l ~ r) =&gt; v) -&gt; v</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1431558241, "post_id": 30224796, "comment_id": 48557088, "body": "Or, to say it another way, you can read <code>((l ~ r) =&gt; t) -&gt; t</code> as, &quot;given a term that is well typed assuming that <code>l ~ r</code>, return that same term from a context where we have proven <code>l ~ r</code> and discharged that assumption&quot;."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1431597186, "post_id": 30224796, "comment_id": 48570729, "body": "@Daniel Wagner, that would be a great answer."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1431638268, "post_id": 30224796, "comment_id": 48595944, "body": "@DanielWagner - I agree, if you were to write that up as a full answer it&#39;d be really helpful ;)"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1431558478, "post_id": 30225870, "comment_id": 48557156, "body": "i think chi&#39;s answer gets at &quot;what it means&quot; a bit better, but this is an awesome demonstration of its power. Wow."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1431637987, "post_id": 30225870, "comment_id": 48595796, "body": "Your example has helped me build a &quot;top-down&quot; intuition about the type&#39;s <i>usage</i> (it seems to be a way to safely cast between equivalent types) but I&#39;m still struggling with a &quot;bottom-up&quot; understanding of what it <i>means</i>. Do you think you could provide a worked example of how GHC might go about type-checking your <code>assoc</code> and <code>coerce</code> functions?"}], "tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": true, "score": 6, "last_activity_date": 1431647041, "last_edit_date": 1431647041, "creation_date": 1431554208, "answer_id": 30225870, "question_id": 30224796, "link": "https://stackoverflow.com/questions/30224796/how-should-the-general-type-of-a-lemma-function-be-understood/30225870#30225870", "title": "How should the general type of a &quot;lemma&quot; function be understood?", "body": "<blockquote>\n  <p>I'm reading it as \"given a term which requires <code>l ~ r</code>, return that\n  term\"</p>\n</blockquote>\n\n<p>It's \"given a term whose type contains <code>l</code>, return that term with all <code>l</code>s being substituted by <code>r</code>s in the type\" (or in the other direction <code>r -&gt; l</code>). It's a very neat trick, that allows you to delegate all <code>cong</code>, <code>trans</code>, <code>subst</code> and similar stuff to GHC.</p>\n\n<p>Here is an example:</p>\n\n<pre><code>{-# LANGUAGE GADTs, DataKinds, PolyKinds, TypeFamilies, TypeOperators, RankNTypes #-}\n\ndata Nat = Z | S Nat\n\ndata Natty n where\n    Zy :: Natty Z\n    Sy :: Natty n -&gt; Natty (S n)\n\ndata Vec a n where\n    Nil  :: Vec a Z\n    Cons :: a -&gt; Vec a n -&gt; Vec a (S n)\n\ntype family (n :: Nat) :+ (m :: Nat) :: Nat where\n    Z     :+ m = m\n    (S n) :+ m = S (n :+ m)\n\nassoc :: Natty n -&gt; Natty m -&gt; Natty p -&gt; (((n :+ m) :+ p) ~ (n :+ (m :+ p)) =&gt; t) -&gt; t\nassoc  Zy     my py t = t\nassoc (Sy ny) my py t = assoc ny my py t\n\ncoerce :: Natty n -&gt; Natty m -&gt; Natty p -&gt; Vec a ((n :+ m) :+ p) -&gt; Vec a (n :+ (m :+ p))\ncoerce ny my py xs = assoc ny my py xs\n</code></pre>\n\n<p><strong>UPDATE</strong></p>\n\n<p>It's instructive to specialize <code>assoc</code>:</p>\n\n<pre><code>assoc' :: Natty n -&gt; Natty m -&gt; Natty p -&gt;\n            (((n :+ m) :+ p) ~ (n :+ (m :+ p)) =&gt; Vec a (n :+ (m :+ p)))\n                                               -&gt; Vec a (n :+ (m :+ p))\nassoc'  Zy     my py t = t\nassoc' (Sy ny) my py t = assoc ny my py t\n\ncoerce' :: Natty n -&gt; Natty m -&gt; Natty p -&gt; Vec a ((n :+ m) :+ p) -&gt; Vec a (n :+ (m :+ p))\ncoerce' ny my py xs = assoc' ny my py xs\n</code></pre>\n\n<p><strong>Daniel Wagner</strong> explained what's going on in comments:</p>\n\n<blockquote>\n  <p>Or, to say it another way, you can read ((l ~ r) => t) -> t as, \"given\n  a term that is well typed assuming that l ~ r, return that same term\n  from a context where we have proven l ~ r and discharged that\n  assumption\".</p>\n</blockquote>\n\n<p>Let's elaborate the proving part.</p>\n\n<p>In the <code>assoc'  Zy my py t = t</code> case <code>n</code> is equal to <code>Zy</code> and hence we have</p>\n\n<pre><code>((Zy :+ m) :+ p) ~ (Zy :+ (m :+ p))\n</code></pre>\n\n<p>which reduces to</p>\n\n<pre><code>(m :+ p) ~ (m :+ p)\n</code></pre>\n\n<p>This is clearly identity and hence we can discharge that assumption and return <code>t</code>.</p>\n\n<p>At each recursive step we maintain the</p>\n\n<pre><code>((n :+ m) :+ p) ~ (n :+ (m :+ p))\n</code></pre>\n\n<p>equation. So when <code>assoc' (Sy ny) my py t = assoc ny my py t</code> the equation becomes</p>\n\n<pre><code>((Sy n :+ m) :+ p) ~ (Sy n :+ (m :+ p))\n</code></pre>\n\n<p>which reduces to</p>\n\n<pre><code> Sy ((n :+ m) :+ p) ~ Sy (n :+ (m :+ p))\n</code></pre>\n\n<p>due to the definition of <code>(:+)</code>. And since constructors are injective</p>\n\n<pre><code>constructors_are_injective :: S n ~ S m =&gt; Vec a n -&gt; Vec a m\nconstructors_are_injective xs = xs\n</code></pre>\n\n<p>the equation becomes</p>\n\n<pre><code>((n :+ m) :+ p) ~ (n :+ (m :+ p))\n</code></pre>\n\n<p>and we can call <code>assoc'</code> recursively.</p>\n\n<p>Finally in the call of <code>coerce'</code> these two terms are unified:</p>\n\n<pre><code> 1. ((n :+ m) :+ p) ~ (n :+ (m :+ p)) =&gt; Vec a (n :+ (m :+ p))\n 2.                                      Vec a ((n :+ m) :+ p)\n</code></pre>\n\n<p>Clearly <code>Vec a ((n :+ m) :+ p)</code> is <code>Vec a (n :+ (m :+ p))</code> under the assumption that <code>((n :+ m) :+ p) ~ (n :+ (m :+ p))</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1431638089, "post_id": 30226303, "comment_id": 48595843, "body": "Thanks, this confirms my suspicion that the two versions of the proofs are equivalent."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 4, "last_activity_date": 1431559178, "last_edit_date": 1431559178, "creation_date": 1431556290, "answer_id": 30226303, "question_id": 30224796, "link": "https://stackoverflow.com/questions/30224796/how-should-the-general-type-of-a-lemma-function-be-understood/30226303#30226303", "title": "How should the general type of a &quot;lemma&quot; function be understood?", "body": "<blockquote>\n  <p>I would have expected an equality proof to have a type more like this:</p>\n\n<pre><code>Natty x1 \u2192 ... \u2192 Natty xn \u2192 l :~: r\n</code></pre>\n</blockquote>\n\n<p>That's a reasonable alternative. In fact, it's logically equivalent to the one in the Hasochism paper:</p>\n\n<pre><code>{-# LANGUAGE GADTs, RankNTypes, TypeOperators, ScopedTypeVariables #-}\nmodule Hasochism where\n\ndata l :~: r where\n  Refl :: l :~: l\n\ntype Hasoc l r = forall t. (l ~ r =&gt; t) -&gt; t\n\nlemma1 :: forall l r. Hasoc l r -&gt; l :~: r\nlemma1 h = h Refl \n\nlemma2 :: forall l r. l :~: r -&gt; Hasoc l r\nlemma2 Refl t = t\n</code></pre>\n\n<p>In a sense, <code>Hasoc l r</code> is an impredicative encoding of the constraint <code>l ~ r</code>.</p>\n\n<p>The Hasochistic variant is slightly easier to use than the <code>:~:</code> one, in that once you have e.g.</p>\n\n<pre><code>type family A a\n-- ...\nproof1 :: Proxy a -&gt; Hasoc a (A a)\nproof1 _ = -- ...\n</code></pre>\n\n<p>you can simply use it as in</p>\n\n<pre><code>use1 :: forall a. [a] -&gt; [A a]\nuse1 t = proof1 (Proxy :: Proxy a) t\n</code></pre>\n\n<p>Instead, with</p>\n\n<pre><code>proof2 :: Proxy a -&gt; a :~: A a\nproof2 _ = -- ...\n</code></pre>\n\n<p>you would need</p>\n\n<pre><code>use2 :: forall a. [a] -&gt; [A a]\nuse2 t = case proof2 (Proxy :: Proxy a) of Refl -&gt; t\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "is_accepted": false, "score": 4, "last_activity_date": 1494836274, "creation_date": 1494836274, "answer_id": 43974498, "question_id": 30224796, "link": "https://stackoverflow.com/questions/30224796/how-should-the-general-type-of-a-lemma-function-be-understood/43974498#43974498", "title": "How should the general type of a &quot;lemma&quot; function be understood?", "body": "<p>We've had some excellent answers, but as the perpetrator, I thought I'd offer some remarks.</p>\n\n<p>Yes, there are multiple equivalent presentations of these lemmas. The presentation I use is one of them, and the choice is largely a pragmatic one. These days (in a more recent codebase), I go as far as to define</p>\n\n<pre><code>-- Holds :: Constraint -&gt; *\ntype Holds c = forall t . (c =&gt; t) -&gt; t\n</code></pre>\n\n<p>This is an example of an <em>eliminator type</em>: it abstracts over what it delivers (the <em>motive</em> of the elimination) and it requires you to construct zero or more <em>methods</em> (one, here) of achieving the motive under more specific circumstances. The way to read it is <em>backwards</em>. It says</p>\n\n<blockquote>\n  <p>If you have a problem (to inhabit any motive type <code>t</code>), and nobody else can help, maybe you can make progress by assuming constraint <code>c</code> in your method.</p>\n</blockquote>\n\n<p>Given that the language of constraints admits conjunction (aka tupling), we acquire the means to write lemmas of the form</p>\n\n<pre><code>lemma :: forall x1 .. xn. (p1[x1 .. xn],.. pm[x1 .. xn])        -- premises\n                       =&gt; t1[x1 .. xn] -&gt; .. tl[x1 .. xn]       -- targets\n                       -&gt; Holds (c1[x1 .. xn],.. ck[x1 .. xn])  -- conclusions\n</code></pre>\n\n<p>and it might even be that some constraint, a premise <code>p</code> or a conclusion <code>c</code>, has the form of an equation</p>\n\n<pre><code>l[x1 .. xn] ~ r[x1 .. cn]\n</code></pre>\n\n<p>Now, to deploy such a <code>lemma</code>, consider the problem of filling a hole</p>\n\n<pre><code>_ :: Problem\n</code></pre>\n\n<p>Refine this <code>_</code> by the elimination <code>lemma</code>, specifying the <em>targets</em>. The <em>motive</em> comes from the problem at hand. The <em>method</em> (singular in the case of <code>Holds</code>) remains open.</p>\n\n<pre><code>lemma target1 .. targetl $ _\n</code></pre>\n\n<p>and the method hole will not have changed type</p>\n\n<pre><code>_ :: Problem\n</code></pre>\n\n<p>but GHC will know a bunch more stuff and thus be more likely to believe your solution.</p>\n\n<p>Sometimes, there's a constraint-versus-data choice to make for what's a (constraint) premise and what's a (data) target. I tend to pick these to avoid ambiguity (Simon likes to guess the <code>x1 .. xn</code>, but sometimes needs a hint) and to facilitate <em>proof by induction</em>, which is much easier on targets (often the singletons for type level data) than on premises.</p>\n\n<p>As to deployment, for equations, you can certainly switch to a datatype presentation and break out a case analysis</p>\n\n<pre><code>case dataLemma target1 .. targetl of Refl -&gt; method\n</code></pre>\n\n<p>and indeed, if you equip yourself with the <code>Dict</code> existential</p>\n\n<pre><code>data Dict (c :: Constraint) :: * where\n  Dict :: c =&gt; Dict c\n</code></pre>\n\n<p>you can do a bunch at once</p>\n\n<pre><code>case multiLemma blah blah blah of (Refl, Dict, Dict, Refl) -&gt; method\n</code></pre>\n\n<p>but the eliminator form is more compact and readable <em>when there is at most one method</em>. Indeed, we can chain multiple lemmas without sliding ever rightward</p>\n\n<pre><code>lemma1 ..   $\n...\nlemmaj ..   $\nmethod\n</code></pre>\n\n<p>If you have such an eliminator with two or more cases, I think it's often better to wrap it up as a GADT, so that usage sites helpfully tag each case with a constructor label.</p>\n\n<p>Anyhow, yes, the point is to choose the presentation of the facts which most compactly enables us to extend the reach of GHC's constraint solving machinery so that more stuff just typechecks. If you're in a scrap with Simon, it's often a good strategy to explain yourself to Dimitrios next door.</p>\n"}], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 486, "favorite_count": 4, "accepted_answer_id": 30225870, "answer_count": 3, "score": 12, "last_activity_date": 1522439080, "creation_date": 1431549651, "last_edit_date": 1522439080, "question_id": 30224796, "link": "https://stackoverflow.com/questions/30224796/how-should-the-general-type-of-a-lemma-function-be-understood", "title": "How should the general type of a &quot;lemma&quot; function be understood?", "body": "<p>Perhaps this is a stupid question. Here's a quote from <a href=\"https://personal.cis.strath.ac.uk/conor.mcbride/pub/hasochism.pdf\" rel=\"nofollow noreferrer\">the <em>Hasochism</em> paper</a>:</p>\n\n<blockquote>\n  <p>One approach to resolving this issue is to encode lemmas, given by\n  parameterised equations, as Haskell functions. In general, such lemmas\n  may be encoded as functions of type:</p>\n\n<pre><code>\u2200 x1 ... xn. Natty x1 \u2192 ... \u2192 Natty xn \u2192 ((l ~ r) \u21d2 t) \u2192 t\n</code></pre>\n</blockquote>\n\n<p>I thought I understood <code>RankNTypes</code>, but I can't make sense of the last part of this proposition. I'm reading it informally as \"given a term which requires <code>l ~ r</code>, return that term\". I'm sure this interpretation is wrong because it seems to lead to a circularity: we don't know <code>l ~ r</code> until the conclusion of the proof itself, so how can I be expected to provide as an assumption of the proof a term which requires that?</p>\n\n<p>I would have expected an equality proof to have a type more like this:</p>\n\n<pre><code>Natty x1 \u2192 ... \u2192 Natty xn \u2192 l :~: r\n</code></pre>\n\n<p>Informally, \"given a bunch of <code>Natty</code>s, return a proof of the proposition that <code>l</code> and <code>r</code> are equal\" (using GHC's <a href=\"https://hackage.haskell.org/package/base-4.7.0.2/docs/Data-Type-Equality.html\" rel=\"nofollow noreferrer\">Data.Type.Equality</a>). This makes far more sense to me, and seems to align with what you'd say in other dependently typed systems. I'm guessing it's equivalent to the version in the paper, but I'm struggling to mentally square away the two versions.</p>\n\n<p>In short, I'm confused. I feel like I'm missing a key insight. How should I read the type <code>((l ~ r) =&gt; t) -&gt; t</code>?</p>\n"}, {"tags": ["haskell", "command-line-arguments"], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 113, "user_id": 877650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ozmlT.jpg?s=128&g=1", "display_name": "Christopher Lewis", "link": "https://stackoverflow.com/users/877650/christopher-lewis"}, "edited": false, "score": 0, "creation_date": 1521739155, "post_id": 30227609, "comment_id": 85871338, "body": "@ChristopherLewis Oh, sure; if you want, you could use <code>data Exclusive = E1 | E2</code> and return a <code>Maybe Exclusive</code> or <code>Except CommandLineParsingError Exclusive</code> or whatever, and that would probably be a cleaner design -- especially if it meant you could compose the parser and error-reporting applicatives."}, {"owner": {"reputation": 113, "user_id": 877650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ozmlT.jpg?s=128&g=1", "display_name": "Christopher Lewis", "link": "https://stackoverflow.com/users/877650/christopher-lewis"}, "edited": false, "score": 1, "creation_date": 1521739978, "post_id": 30227609, "comment_id": 85871846, "body": "[Deleted previous comment: hit enter too soon, but it&#39;s content is essentially included in this comment.] I&#39;m marking this as the correct answer: after careful inspection I can find no better way to handle this situation. However, encoding the failure indicator in the sum type does leave a bad taste in my mouth. I should point out that optparse-applicative&#39;s error messages have been improved (added) since I originally posed this question. Since version 0.14 the parser in the question will output the error <code>Invalid option `-e2&#39;</code>."}, {"owner": {"reputation": 962, "user_id": 490815, "user_type": "registered", "accept_rate": 24, "profile_image": "https://www.gravatar.com/avatar/366f7b0d571e7811680c53984c34c966?s=128&d=identicon&r=PG", "display_name": "sinoTrinity", "link": "https://stackoverflow.com/users/490815/sinotrinity"}, "edited": false, "score": 0, "creation_date": 1617757009, "post_id": 30227609, "comment_id": 118393170, "body": "I&#39;m using the solution with version 1.2.1. Error <b>Invalid option `-e2&#39;</b> is thrown BEFORE command line options are parsed. Thus I cannot check <b>Both</b>. How to get <b>Both</b>?"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 3, "last_activity_date": 1431565063, "creation_date": 1431565063, "answer_id": 30227609, "question_id": 30224307, "link": "https://stackoverflow.com/questions/30224307/how-do-you-provide-a-specific-error-message-with-optparse-applicative-when-multi/30227609#30227609", "title": "How do you provide a specific error message with optparse-applicative when multiple mutually exclusive options are provided?", "body": "<p>I'm not familiar with optparse-applicative, so I'm not sure what error-printing facilities it provides. (Sometimes parser combinator libraries offer a primitive that changes the error that's printed, but I didn't see anything for that on a quick skim of the optparse-applicative docs. Entirely possible that I missed it.)</p>\n\n<p>But in case nothing is available from the library itself, you could always print your own message by accepting both flags; e.g.</p>\n\n<pre><code>data Exclusive = E1 | E2 | Both\nexclusiveParser\n     =  (flag' E1 (short 'e'))\n    &lt;|&gt; (flag' E2 (short 'f'))\n    &lt;|&gt; (flag' Both (short 'e') &lt;* flag' Both (short 'f'))\n</code></pre>\n\n<p>Then in your top-level handler (i.e. once the options are all parsed), if you see <code>Both</code>, you can issue an error message of your own crafting at that moment.</p>\n"}], "owner": {"reputation": 113, "user_id": 877650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ozmlT.jpg?s=128&g=1", "display_name": "Christopher Lewis", "link": "https://stackoverflow.com/users/877650/christopher-lewis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 2, "accepted_answer_id": 30227609, "answer_count": 1, "score": 7, "last_activity_date": 1431565063, "creation_date": 1431547805, "question_id": 30224307, "link": "https://stackoverflow.com/questions/30224307/how-do-you-provide-a-specific-error-message-with-optparse-applicative-when-multi", "title": "How do you provide a specific error message with optparse-applicative when multiple mutually exclusive options are provided?", "body": "<p>It's easy to specify mutually exclusive options with <a href=\"https://github.com/pcapriotti/optparse-applicative\" rel=\"noreferrer\" title=\"optparse-applicative\">optparse-applicative</a>:</p>\n\n<pre><code>data Exclusive = E1 | E2\n\nexclusiveParser :: Parser ExclusiveOption\nexclusiveParser = \n        (flag' E1 (short 'e1')\n    &lt;|&gt; (flag' E2 (short 'e2')\n</code></pre>\n\n<p>The above parser will parse either <code>-e1</code> or <code>-e2</code>, but not both. The default optparse-applicative action when both <code>-e1</code> and <code>-e2</code> are provided is to print the application's usage message. I would like to provide the user with a specific error message informing them that they cannot provide both <code>-e1</code> and <code>-e2</code>, but I don't see an obvious way to do that.</p>\n\n<p>Any suggestions (or solutions) would be appreciated?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1431547454, "post_id": 30224130, "comment_id": 48552298, "body": "What do you mean by &quot;a sequence of reduction lazy and eager&quot;?  And what is the <code>?</code> symbol mean in <code>x?y</code>?"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1431547542, "post_id": 30224130, "comment_id": 48552350, "body": "@bheklilr I guess he wants <code>sort</code> sequence as a lazy list as well as  a eager list. But that&#39;s my guess."}, {"owner": {"reputation": 25, "user_id": 4897277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24181b454417d08cdef4c45d26a73f19?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Voicu", "link": "https://stackoverflow.com/users/4897277/adrian-voicu"}, "edited": false, "score": 0, "creation_date": 1431548236, "post_id": 30224130, "comment_id": 48552696, "body": "Your guess is right. This is what I want. Have you any idea of how could i do this?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1431548518, "post_id": 30224130, "comment_id": 48552837, "body": "maybe you can tell us what you tried so far and where the problem is (because this seems to be a homework problem)"}, {"owner": {"reputation": 25, "user_id": 4897277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24181b454417d08cdef4c45d26a73f19?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Voicu", "link": "https://stackoverflow.com/users/4897277/adrian-voicu"}, "edited": false, "score": 0, "creation_date": 1431550488, "post_id": 30224130, "comment_id": 48553807, "body": "I&#39;m a beginner in haskell. I recently started studying programming. At first, I was just curios, but now i like it. I found this in a book: where d=sqrt(square b-4&lt;a&lt;c) e=2&lt;a , and i thought this example can help me to solve this exercise, but I found that I didn&#39;t know how to resolve it. I understand your fear of not solve my &quot;homework&quot;, but that was just my curiosity, at school I haven&#39;t yet reached this chapter."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 4897277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24181b454417d08cdef4c45d26a73f19?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Voicu", "link": "https://stackoverflow.com/users/4897277/adrian-voicu"}, "edited": false, "score": 0, "creation_date": 1431862203, "post_id": 30225066, "comment_id": 48670331, "body": "I understood. Thanks a lot!"}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 2, "last_activity_date": 1431555874, "last_edit_date": 1431555874, "creation_date": 1431550720, "answer_id": 30225066, "question_id": 30224130, "link": "https://stackoverflow.com/questions/30224130/how-i-could-build-a-sequence-of-reduction-lazy-and-eager/30225066#30225066", "title": "how I could build a sequence of reduction lazy and eager", "body": "<p>You have written an implementation of <a href=\"http://en.wikipedia.org/wiki/Insertion_sort\" rel=\"nofollow\">insertion sort</a>, which, like all other deterministic comparison-based sorting algorithms, is <a href=\"https://wiki.haskell.org/Lazy_vs._non-strict\" rel=\"nofollow\">strict</a>. The first value returned by <code>sort</code> is defined to be the minimum of the input list, which means that <code>sort</code> has to inspect every element of the list to be sure it's found the minimum. You can't return a minimum value early because the <em>actual</em> minimum value might be right at the end of the list - you'll never know until you test them all.</p>\n\n<p>So <code>sort</code> can't possibly be lazy. If the list is infinite, it'll never return a value. If any elements of the list are <code>undefined</code>, it'll crash.</p>\n\n<p>In other words, your version of <code>sort</code> (and, as I say, <em>any</em> deterministic comparison-based <code>sort</code>) treats lazy lists <em>just the same</em> as eager lists (those that have been fully evaluated to <a href=\"http://en.wikipedia.org/wiki/Normal_form_(abstract_rewriting)\" rel=\"nofollow\">normal form</a>) - it will always evaluate every element of the input before it produces any output.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1431583689, "post_id": 30229170, "comment_id": 48563890, "body": "Non-strict in what sense?"}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1431586077, "post_id": 30229170, "comment_id": 48564931, "body": "@dfeuer You can get the smallest element of the list without having to sort the rest of the list. Should I call it lazy instead?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1431613326, "post_id": 30229170, "comment_id": 48580953, "body": "I believe that&#39;s generally called &quot;incremental&quot;. Heap sorts using heaps with O(1) insertion are inherently incremental, but there are also incremental merge sorts (I think a bottom-up mergesort in Haskell is likely to be incremental, but I could be confused) and quick sorts (essentially hybrids between selection and sorting)."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1431639768, "post_id": 30229170, "comment_id": 48596632, "body": "@dfeuer is right; this version is still strict. The <code>foldr</code> has to consume the whole list in order to determine the value of <code>y</code>. It may avoid <i>sorting</i> the tail of the list before it returns a value, but it does not avoid <i>evaluating</i> it."}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1431655832, "post_id": 30229170, "comment_id": 48601375, "body": "@BenjaminHodgson Of course it has to evaluate the entire list in order to find the smallest element of the list. That&#39;s exactly why I mentioned that selection sort always takes <code>O(n^2)</code> time for all cases. If you see the algorithm of selection sort then it is a loop nested within a loop. The outer loop can be made non-strict. However, the inner loop has to be strict. When I said that selection sort is non-strict I meant that the outer loop is non-strict. It only produces the next smallest element on demand and I believe that&#39;s what the OP was looking for. So technically my answer is not wrong."}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "reply_to_user": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1431656095, "post_id": 30229170, "comment_id": 48601428, "body": "@BenjaminHodgson Anyway, I understood your argument. If there&#39;s any <code>undefined</code> values in the list then the sorting algorithm will halt. Hence, there&#39;s no non-strict algorithm for sorting. I edited my answer and corrected my terminology. Mind removing the downvote?"}, {"owner": {"reputation": 25, "user_id": 4897277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24181b454417d08cdef4c45d26a73f19?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Voicu", "link": "https://stackoverflow.com/users/4897277/adrian-voicu"}, "edited": false, "score": 0, "creation_date": 1431862343, "post_id": 30229170, "comment_id": 48670378, "body": "Thanks all of you for all the explanations. They helped me a lot to understand this problem."}], "tags": [], "owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "is_accepted": false, "score": 0, "last_activity_date": 1431655950, "last_edit_date": 1431655950, "creation_date": 1431577390, "answer_id": 30229170, "question_id": 30224130, "link": "https://stackoverflow.com/questions/30224130/how-i-could-build-a-sequence-of-reduction-lazy-and-eager/30229170#30229170", "title": "how I could build a sequence of reduction lazy and eager", "body": "<p><a href=\"http://en.wikipedia.org/wiki/Selection_sort\" rel=\"nofollow\">Selection sort</a> can be implemented both <strike>non-strictly</strike> incrementally and strictly.</p>\n\n<h3>Incremental selection sort</h3>\n\n<pre class=\"lang-hs prettyprint-override\"><code>sort :: Ord a =&gt; [a] -&gt; [a]\nsort []     = []\nsort (x:xs) = let (y, ys) = foldr select (x, []) xs\n              in y : sort ys\n\nselect :: Ord a =&gt; a -&gt; (a, [a]) -&gt; (a, [a])\nselect x (y, ys)\n    | x &lt; y     = (x, y:ys)\n    | otherwise = (y, x:ys)\n</code></pre>\n\n<h3>Strict selection sort</h3>\n\n<pre class=\"lang-hs prettyprint-override\"><code>sort :: Ord a =&gt; [a] -&gt; [a]\nsort []     = []\nsort (x:xs) = let (y, ys) = foldr select (x, []) xs\n              in let zs = sort ys in seq zs (y:zs)\n\nselect :: Ord a =&gt; a -&gt; (a, [a]) -&gt; (a, [a])\nselect x (y, ys)\n    | x &lt; y     = (x, y:ys)\n    | otherwise = (y, x:ys)\n</code></pre>\n\n<p>However, selection sort always takes <code>O(n^2)</code> time for all cases. For most cases, it would be better to use the <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Data-List.html#v:sort\" rel=\"nofollow\"><code>sort</code></a> function exported by the <code>Data.List</code> module.</p>\n"}], "owner": {"reputation": 25, "user_id": 4897277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24181b454417d08cdef4c45d26a73f19?s=128&d=identicon&r=PG&f=1", "display_name": "Adrian Voicu", "link": "https://stackoverflow.com/users/4897277/adrian-voicu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "closed_date": 1431973008, "answer_count": 2, "score": 0, "last_activity_date": 1431655950, "creation_date": 1431547159, "last_edit_date": 1431548628, "question_id": 30224130, "link": "https://stackoverflow.com/questions/30224130/how-i-could-build-a-sequence-of-reduction-lazy-and-eager", "closed_reason": "Needs details or clarity", "title": "how I could build a sequence of reduction lazy and eager", "body": "<p>Does anyone know how I sort sequence as a lazy list as well as a eager list, <code>sort [3,4,2,1]</code>, with this definition of <code>sort</code></p>\n\n<pre><code>sort = foldr insert []\n  where \n    insert x [] = [x]\n    insert x (y:ys) =\n        if x&lt;y\n            then x:y:ys\n            else y:insert x ys\n</code></pre>\n"}, {"tags": ["linux", "performance", "haskell", "virtual-machine", "ghc"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 6, "creation_date": 1431546950, "post_id": 30223208, "comment_id": 48552014, "body": "A friend reports running this code on a non-virtualized linux box with GHC 7.6, and seeing <code>sys 0m0.136s</code> in the output. It&#39;s quite possible virtualization is the underlying cause of this."}, {"owner": {"reputation": 42504, "user_id": 1161878, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/0157ddd785dc01e95342e3661d34b42a?s=128&d=identicon&r=PG", "display_name": "Gene", "link": "https://stackoverflow.com/users/1161878/gene"}, "edited": false, "score": 0, "creation_date": 1434264272, "post_id": 30223208, "comment_id": 49698977, "body": "<code>munmap</code> is almost certainly used by the garbage collector to manage the arena. A functional language w/ copying GC is a bad match for running on a virtual machine. Try running on bare metal."}], "answers": [{"comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1434422636, "post_id": 30857206, "comment_id": 49759080, "body": "I had to use <code>-H128M</code> rather than <code>-H128</code>. It did reduce the <code>sys</code> time reported by <code>time</code>, but it did it by increasing the <code>user</code> time, not reducing the total.  Still, that&#39;s a better representation of what&#39;s <i>actually</i> going on. It also removed all the <code>munmap</code> calls from <code>strace</code>&#39;s result, which I suppose is the point."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1434423035, "post_id": 30857206, "comment_id": 49759179, "body": "And this is an i7.  Could you add a couple sentences about why the i7 is particularly bad for running a VM in this situation?"}, {"owner": {"reputation": 740, "user_id": 2010049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f556e6ab640fd00c0cef1a47017a0c4?s=128&d=identicon&r=PG", "display_name": "miniscule", "link": "https://stackoverflow.com/users/2010049/miniscule"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1434432526, "post_id": 30857206, "comment_id": 49761515, "body": "I did not intend to cloud the matter, but everything below the i7 chipset families had physical chip architecture from the core 2 family of processors.  Any VM running on a core 2 architecture were better off running on only one of the cores of a pair.  The time it would take to sync for GC for a core 2 duo for example, was much longer."}, {"owner": {"reputation": 740, "user_id": 2010049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f556e6ab640fd00c0cef1a47017a0c4?s=128&d=identicon&r=PG", "display_name": "miniscule", "link": "https://stackoverflow.com/users/2010049/miniscule"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1434433054, "post_id": 30857206, "comment_id": 49761726, "body": "Fortunately the true multicore i7 (Intel codenamed Nehalem) and later generation systems have independent L1 cache of 64kb per core (the absolutely fastest ram) and L2 cache of 256kb per core also on chip (ram next to the processor).  For the non-deterministic system you are modelling, independent, per core caching is crucial for better performance."}, {"owner": {"reputation": 740, "user_id": 2010049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f556e6ab640fd00c0cef1a47017a0c4?s=128&d=identicon&r=PG", "display_name": "miniscule", "link": "https://stackoverflow.com/users/2010049/miniscule"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1434433603, "post_id": 30857206, "comment_id": 49761937, "body": "The other boon for i7 chipsets onward is Intel brought HyperThreading back (two cores per processor).  Hope your project goes well and that you discover even more than expected..."}, {"owner": {"reputation": 740, "user_id": 2010049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f556e6ab640fd00c0cef1a47017a0c4?s=128&d=identicon&r=PG", "display_name": "miniscule", "link": "https://stackoverflow.com/users/2010049/miniscule"}, "reply_to_user": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1434491249, "post_id": 30857206, "comment_id": 49798590, "body": "Were you able to squeeze any more performance out of the system by trying the priority increase trick I mentioned?"}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1434496304, "post_id": 30857206, "comment_id": 49800540, "body": "I probably would be able to..  I&#39;m not <i>that</i> concerned over all, though. I was just trying to figure out what&#39;s going on.  If I don&#39;t get a better answer than yours, I will award the bounty for this. I&#39;m just holding out until the last day. :)"}], "tags": [], "owner": {"reputation": 740, "user_id": 2010049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f556e6ab640fd00c0cef1a47017a0c4?s=128&d=identicon&r=PG", "display_name": "miniscule", "link": "https://stackoverflow.com/users/2010049/miniscule"}, "is_accepted": true, "score": 5, "last_activity_date": 1434415705, "creation_date": 1434415705, "answer_id": 30857206, "question_id": 30223208, "link": "https://stackoverflow.com/questions/30223208/excessive-mysterious-system-time-use-in-a-ghc-compiled-binary/30857206#30857206", "title": "Excessive mysterious system time use in a GHC-compiled binary", "body": "<p>Be sure to add -H128 to your build command line after </p>\n\n<p>+RTS -s </p>\n\n<p>Your eval looks fine, so you are good to go there.</p>\n\n<p>If you really wanted to go after sluggishness on this VM, increase the thread priority on the VM (and the VM console slightly if you want). </p>\n\n<p>Another unexpected penalty will be due to sync confirmation for GC (since this is SMP Debian on a multicore system). </p>\n\n<p>The GC will have even more VM manipulation to perform on any multicore system, which partially explains the 61 percent GC stat and your strace and time discrepancy.  The stats are not reliable for most situations anyway </p>\n\n<p>You are actually doing quite well - - especially if this is on an i7 or later, for example.  </p>\n\n<p>I would be surprised if the -H128 option does not resolve this.</p>\n\n<p>I am new here, please do let me know if I can help further or if there is anything you require prior to doling out the bounty.</p>\n"}], "owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 0, "accepted_answer_id": 30857206, "answer_count": 1, "score": 33, "last_activity_date": 1434415705, "creation_date": 1431543686, "last_edit_date": 1431546371, "question_id": 30223208, "link": "https://stackoverflow.com/questions/30223208/excessive-mysterious-system-time-use-in-a-ghc-compiled-binary", "title": "Excessive mysterious system time use in a GHC-compiled binary", "body": "<p>I'm working on an exploration of automatic bounding of constraint-base searches.  As such, my starting point is the <a href=\"http://mathforum.org/library/drmath/view/60417.html\">SEND MORE MONEY problem</a>, with a <a href=\"http://blog.jle.im/entry/unique-sample-drawing-searches-with-list-and-statet\">solution based on nondeterministic selection without replacement</a>. I've modified the approach to count the number of samples performed, in order to better measure the impact of adding constraints to the search.</p>\n\n<pre><code>import Control.Monad.State\nimport Control.Monad.Trans.List\nimport Control.Monad.Morph\nimport Data.List (foldl')\n\ntype CS a b = StateT [a] (ListT (State Int)) b\n\nselect' :: [a] -&gt; [(a, [a])]\nselect' [] = []\nselect' (x:xs) = (x, xs) : [(y, x:ys) | ~(y, ys) &lt;- select' xs]\n\nselect :: CS a a\nselect = do\n    i &lt;- lift . lift $ get\n    xs &lt;- get\n    lift . lift . put $! i + length xs\n    hoist (ListT . return) (StateT select')\n\nrunCS :: CS a b -&gt; [a] -&gt; ([b], Int)\nrunCS a xs = flip runState 0 . runListT $ evalStateT a xs\n\nfromDigits :: [Int] -&gt; Int\nfromDigits = foldl' (\\x y -&gt; 10 * x + y) 0\n\nsendMoreMoney :: ([(Int, Int, Int)], Int)\nsendMoreMoney = flip runCS [0..9] $ do\n    [s,e,n,d,m,o,r,y] &lt;- replicateM 8 select\n    let send  = fromDigits [s,e,n,d]\n        more  = fromDigits [m,o,r,e]\n        money = fromDigits [m,o,n,e,y]\n    guard $ s /= 0 &amp;&amp; m /= 0 &amp;&amp; send + more == money\n    return (send, more, money)\n\nmain :: IO ()\nmain = print sendMoreMoney\n</code></pre>\n\n<p>It works, it gets correct results, and it maintains a flat heap profile during the search. But even so, it's slow. It's something like 20x slower than without counting the selections. Even <em>that</em> isn't terrible. I can live with paying a huge penalty in order to collect these performance numbers.</p>\n\n<p>But I still don't want the performance to be needlessly terrible, so I decided to look for low-hanging fruit in terms of performance. And I came across some baffling results when I did.</p>\n\n<pre><code>$ ghc -O2 -Wall -fforce-recomp -rtsopts statefulbacktrack.hs\n[1 of 1] Compiling Main             ( statefulbacktrack.hs, statefulbacktrack.o )\nLinking statefulbacktrack ...\n$ time ./statefulbacktrack\n([(9567,1085,10652)],2606500)\n\nreal    0m6.960s\nuser    0m3.880s\nsys     0m2.968s\n</code></pre>\n\n<p>That system time is utterly ridiculous.  The program performs output once.  Where's it all going?  My next step was checking <code>strace</code>.</p>\n\n<pre><code>$ strace -cf ./statefulbacktrack\n([(9567,1085,10652)],2606500)\n% time     seconds  usecs/call     calls    errors syscall\n------ ----------- ----------- --------- --------- ----------------\n 98.38    0.033798        1469        23           munmap\n  1.08    0.000370           0     21273           rt_sigprocmask\n  0.26    0.000090           0     10638           clock_gettime\n  0.21    0.000073           0     10638           getrusage\n  0.07    0.000023           4         6           mprotect\n  0.00    0.000000           0         8           read\n  0.00    0.000000           0         1           write\n  0.00    0.000000           0       144       134 open\n  0.00    0.000000           0        10           close\n  0.00    0.000000           0         1           execve\n  0.00    0.000000           0         9         9 access\n  0.00    0.000000           0         3           brk\n  0.00    0.000000           0         1           ioctl\n  0.00    0.000000           0       847           sigreturn\n  0.00    0.000000           0         1           uname\n  0.00    0.000000           0         1           select\n  0.00    0.000000           0        13           rt_sigaction\n  0.00    0.000000           0         1           getrlimit\n  0.00    0.000000           0       387           mmap2\n  0.00    0.000000           0        16        15 stat64\n  0.00    0.000000           0        10           fstat64\n  0.00    0.000000           0         1         1 futex\n  0.00    0.000000           0         1           set_thread_area\n  0.00    0.000000           0         1           set_tid_address\n  0.00    0.000000           0         1           timer_create\n  0.00    0.000000           0         2           timer_settime\n  0.00    0.000000           0         1           timer_delete\n  0.00    0.000000           0         1           set_robust_list\n------ ----------- ----------- --------- --------- ----------------\n100.00    0.034354                 44039       159 total\n</code></pre>\n\n<p>So..  <code>strace</code> tells me only 0.034354s was spent in system calls.</p>\n\n<p>Where's the rest of the <code>sys</code> time reported by <code>time</code> going?</p>\n\n<p>One further data point:  GC time is really high.  Is there an easy way to bring that down?</p>\n\n<pre><code>$ ./statefulbacktrack +RTS -s\n([(9567,1085,10652)],2606500)\n   5,541,572,660 bytes allocated in the heap\n   1,465,208,164 bytes copied during GC\n      27,317,868 bytes maximum residency (66 sample(s))\n         635,056 bytes maximum slop\n              65 MB total memory in use (0 MB lost due to fragmentation)\n\n                                     Tot time (elapsed)  Avg pause  Max pause\n  Gen  0     10568 colls,     0 par    1.924s   2.658s     0.0003s    0.0081s\n  Gen  1        66 colls,     0 par    0.696s   2.226s     0.0337s    0.1059s\n\n  INIT    time    0.000s  (  0.001s elapsed)\n  MUT     time    1.656s  (  2.279s elapsed)\n  GC      time    2.620s  (  4.884s elapsed)\n  EXIT    time    0.000s  (  0.009s elapsed)\n  Total   time    4.276s  (  7.172s elapsed)\n\n  %GC     time      61.3%  (68.1% elapsed)\n\n  Alloc rate    3,346,131,972 bytes per MUT second\n\n  Productivity  38.7% of total user, 23.1% of total elapsed\n</code></pre>\n\n<p>System Info:</p>\n\n<pre><code>$ ghc --version\nThe Glorious Glasgow Haskell Compilation System, version 7.10.1\n$ uname -a\nLinux debian 3.2.0-4-686-pae #1 SMP Debian 3.2.68-1+deb7u1 i686 GNU/Linux\n</code></pre>\n\n<p>Running a Debian 7 virtual machine in VMWare Player 7.10 hosted on Windows 8.1.</p>\n"}, {"tags": ["file", "haskell"], "comments": [{"owner": {"reputation": 31108, "user_id": 350351, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b1a41bbf4677c8961237c4d147e764d6?s=128&d=identicon&r=PG", "display_name": "Daenyth", "link": "https://stackoverflow.com/users/350351/daenyth"}, "edited": false, "score": 1, "creation_date": 1431539470, "post_id": 30221792, "comment_id": 48547741, "body": "Does this help? <a href=\"https://mail.haskell.org/pipermail/haskell-cafe/2010-June/078666.html\" rel=\"nofollow noreferrer\">mail.haskell.org/pipermail/haskell-cafe/2010-June/078666.htm&zwnj;&#8203;l</a>"}, {"owner": {"reputation": 2966, "user_id": 315302, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1d57a52c98eee46fb4bc92e0b4ffe163?s=128&d=identicon&r=PG", "display_name": "Javran", "link": "https://stackoverflow.com/users/315302/javran"}, "edited": false, "score": 4, "creation_date": 1431540496, "post_id": 30221792, "comment_id": 48548316, "body": "The problem is that <code>readFile</code> reads file content on demand, and the underlying file handler is still held at the time you want to execute <code>writeFile</code>. The solution is to demand the full file content so that the handler gets closed before doing <code>writeFile</code>. IMHO the easier way is to use strict IO, you might find <a href=\"https://hackage.haskell.org/package/strict/docs/System-IO-Strict.html\" rel=\"nofollow noreferrer\">strict</a> useful in this case (at the cost of holding all file contents as a list of <code>Char</code>s in memory)."}, {"owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "reply_to_user": {"reputation": 2966, "user_id": 315302, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1d57a52c98eee46fb4bc92e0b4ffe163?s=128&d=identicon&r=PG", "display_name": "Javran", "link": "https://stackoverflow.com/users/315302/javran"}, "edited": false, "score": 3, "creation_date": 1431541001, "post_id": 30221792, "comment_id": 48548598, "body": "@Javran: Could you write that as an answer? It addresses the underlying problem pretty well. Thanks!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2388535"}, "edited": false, "score": 0, "creation_date": 1431542775, "post_id": 30221792, "comment_id": 48549622, "body": "<a href=\"http://stackoverflow.com/questions/2527271/in-haskell-i-want-to-read-a-file-and-then-write-to-it-do-i-need-strictness-ann\" title=\"in haskell i want to read a file and then write to it do i need strictness ann\">stackoverflow.com/questions/2527271/&hellip;</a>"}, {"owner": {"reputation": 2966, "user_id": 315302, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1d57a52c98eee46fb4bc92e0b4ffe163?s=128&d=identicon&r=PG", "display_name": "Javran", "link": "https://stackoverflow.com/users/315302/javran"}, "reply_to_user": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "edited": false, "score": 0, "creation_date": 1431543640, "post_id": 30221792, "comment_id": 48550159, "body": "@TikhonJelvis just added, hope you like it :)"}, {"owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "reply_to_user": {"reputation": 2966, "user_id": 315302, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1d57a52c98eee46fb4bc92e0b4ffe163?s=128&d=identicon&r=PG", "display_name": "Javran", "link": "https://stackoverflow.com/users/315302/javran"}, "edited": false, "score": 0, "creation_date": 1431544046, "post_id": 30221792, "comment_id": 48550409, "body": "@Javran: Yep. You did a good job of explaining what was actually going on."}], "answers": [{"comments": [{"owner": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "edited": false, "score": 0, "creation_date": 1431543139, "post_id": 30222309, "comment_id": 48549831, "body": "Is using <code>Char8</code> really appropriate here? I think it will fail with unicode files (<code>Char8</code> truncates)."}, {"owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "reply_to_user": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "edited": false, "score": 1, "creation_date": 1431543264, "post_id": 30222309, "comment_id": 48549926, "body": "@bennofs It will not fail because the unicode chars are just 1 or more Char8 glued together."}, {"owner": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "edited": false, "score": 0, "creation_date": 1431543522, "post_id": 30222309, "comment_id": 48550081, "body": "Oh you&#39;re right. Looking at the code, it actually should work. I was scared by the &quot;All Chars will be truncated to 8 bits.&quot; note of that module."}, {"owner": {"reputation": 95, "user_id": 4365658, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1B8et.jpg?s=128&g=1", "display_name": "Jacko", "link": "https://stackoverflow.com/users/4365658/jacko"}, "edited": false, "score": 0, "creation_date": 1431613830, "post_id": 30222309, "comment_id": 48581360, "body": "thank you for your answer . Can you explain me what the signification of the &quot;$ B.pack&quot; please ?"}, {"owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "reply_to_user": {"reputation": 95, "user_id": 4365658, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1B8et.jpg?s=128&g=1", "display_name": "Jacko", "link": "https://stackoverflow.com/users/4365658/jacko"}, "edited": false, "score": 1, "creation_date": 1431675580, "post_id": 30222309, "comment_id": 48608240, "body": "@Raphael B.pack transform from String to Byte8. $ B.pack &quot;1&quot; is the same as (B.pack &quot;1&quot;) . In simple words $ open ( an close it at the end of line"}], "tags": [], "owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "is_accepted": false, "score": 5, "last_activity_date": 1431540613, "creation_date": 1431540613, "answer_id": 30222309, "question_id": 30221792, "link": "https://stackoverflow.com/questions/30221792/write-at-the-beginning-of-a-file-in-haskell/30222309#30222309", "title": "Write at the beginning of a file in Haskell", "body": "<p>I managed to make it works but I used ByteString which is a strict data type:</p>\n\n<pre><code>import Data.ByteString.Char8 as B\n\nmyAppendFile file = do\n    x &lt;- B.readFile file\n    B.writeFile file $ B.pack \"1\"\n    B.appendFile file x\n    return $ B.unpack x\n\nmain = myAppendFile \"c:\\\\test.txt\"\n</code></pre>\n\n<p>Your code gave you that error because of Haskell laziness.\nWhen you tried to write something in file, the data was not completely read out in <code>x</code> because haskell don't need <code>x</code> value until that point of code. That's why Haskell still hangs the file.</p>\n\n<p>One more observation, if you have another lazy read before this function, please replace it also with the strict version because you will run into troubles again.</p>\n"}, {"comments": [{"owner": {"reputation": 95, "user_id": 4365658, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1B8et.jpg?s=128&g=1", "display_name": "Jacko", "link": "https://stackoverflow.com/users/4365658/jacko"}, "edited": false, "score": 0, "creation_date": 1431613565, "post_id": 30222920, "comment_id": 48581145, "body": "thank you for your answer , but how can I use the System.IO.Strict ? I need to install something ?"}, {"owner": {"reputation": 2966, "user_id": 315302, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1d57a52c98eee46fb4bc92e0b4ffe163?s=128&d=identicon&r=PG", "display_name": "Javran", "link": "https://stackoverflow.com/users/315302/javran"}, "reply_to_user": {"reputation": 95, "user_id": 4365658, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1B8et.jpg?s=128&g=1", "display_name": "Jacko", "link": "https://stackoverflow.com/users/4365658/jacko"}, "edited": false, "score": 1, "creation_date": 1431625405, "post_id": 30222920, "comment_id": 48588688, "body": "@Raphael yep, you need to installl <a href=\"http://hackage.haskell.org/package/strict\" rel=\"nofollow noreferrer\">strict</a>. just type in <code>cabal install strict</code> (will be installed somewhere under your home directory, root privilege is not required)"}], "tags": [], "owner": {"reputation": 2966, "user_id": 315302, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/1d57a52c98eee46fb4bc92e0b4ffe163?s=128&d=identicon&r=PG", "display_name": "Javran", "link": "https://stackoverflow.com/users/315302/javran"}, "is_accepted": true, "score": 8, "last_activity_date": 1431543129, "last_edit_date": 1431543129, "creation_date": 1431542730, "answer_id": 30222920, "question_id": 30221792, "link": "https://stackoverflow.com/questions/30221792/write-at-the-beginning-of-a-file-in-haskell/30222920#30222920", "title": "Write at the beginning of a file in Haskell", "body": "<p>As Gabriel has pointed out, the problem is that <code>readFile</code> reads file content on demand, and it closes the underlying file handle only when the file content is fully consumed.</p>\n\n<p>The solution is to demand the full file content so that the handler gets closed before doing <code>writeFile</code>.</p>\n\n<p>Short answer: use <a href=\"https://hackage.haskell.org/package/strict-0.3.2/docs/System-IO-Strict.html#v:readFile\">readFile</a> from strict package.</p>\n\n<pre><code>import qualified System.IO.Strict as SIO\nimport Data.Functor\n\nmyAppendFile :: FilePath -&gt; IO String\nmyAppendFile file = do\n    x &lt;- SIO.readFile file\n    writeFile file \"1\"\n    appendFile file x\n    return x\n\nmain :: IO ()\nmain = void $ myAppendFile \"data\"\n</code></pre>\n\n<p>Another simple \"hack\" to achieve this is to use <code>seq</code>:</p>\n\n<pre><code>myAppendFile :: FilePath -&gt; IO String\nmyAppendFile file = do\n    x &lt;- readFile file\n    length x `seq` writeFile file \"1\"\n    appendFile file x\n    return x\n</code></pre>\n\n<p><code>seq a b</code> is basically just <code>b</code> plus that when <code>b</code> is demanded, <code>a</code>(<code>length x</code> in this case) is evaluated to <a href=\"https://wiki.haskell.org/Weak_head_normal_form\">WHNF</a> before scrutinizing <code>b</code>, This is because <code>length</code> requires its argument (<code>x</code> in this case) to be traversed until the empty list <code>[]</code> can be seen, so the full file content is demanded.</p>\n\n<p>Keep in mind that by using strict IO, your program will hold all file contents (as a list of <code>Char</code>s) in memory. For toy programs it is fine,\nbut if you care about performance, you can take a look at <a href=\"http://hackage.haskell.org/package/bytestring\">bytestring</a> or <a href=\"http://hackage.haskell.org/package/text\">text</a> depending on whether your program deals with bytes or texts(if you want to deal with unicode text). They are both far more efficient than <code>String</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1431544931, "creation_date": 1431544931, "answer_id": 30223546, "question_id": 30221792, "link": "https://stackoverflow.com/questions/30221792/write-at-the-beginning-of-a-file-in-haskell/30223546#30223546", "title": "Write at the beginning of a file in Haskell", "body": "<p>The traditional way to do this will work in Haskell too. Create a new temporary file, stream bytes from the old one into the temporary one, and then move the temporary one over the old one. You can/should use <code>ByteString</code> or some such for efficiency, but you can do the copying in chunks, rather than needing to read everything into memory and then spit it out again. I think <code>pipes</code> and <code>conduit</code> both offer interfaces that are supposed to make this more pleasant.</p>\n"}], "owner": {"reputation": 95, "user_id": 4365658, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1B8et.jpg?s=128&g=1", "display_name": "Jacko", "link": "https://stackoverflow.com/users/4365658/jacko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 849, "favorite_count": 0, "accepted_answer_id": 30222920, "answer_count": 3, "score": 9, "last_activity_date": 1504441208, "creation_date": 1431538806, "last_edit_date": 1504441208, "question_id": 30221792, "link": "https://stackoverflow.com/questions/30221792/write-at-the-beginning-of-a-file-in-haskell", "title": "Write at the beginning of a file in Haskell", "body": "<p>I am trying to add a number at the beginning of a file but the function \"appendFile\" add at the end of a file.</p>\n\n<p>I wrote this but it didn't work.</p>\n\n<pre><code>myAppendFile file = do x &lt;- readFile file\n                   writeFile file \"1\"\n                   appendFile file x\n                   return x\n</code></pre>\n\n<p>when I do:</p>\n\n<pre><code>*main&gt; myAppendFile \"File.txt\"\n</code></pre>\n\n<p>the error is </p>\n\n<pre><code>the ressource is busy (file is locked)\n</code></pre>\n\n<p>so how can I write something at the beginning of a file?</p>\n"}, {"tags": ["haskell", "monoids"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1431542185, "post_id": 30221441, "comment_id": 48549293, "body": "Side note: you <i>probably</i> should make <code>Sometype</code> a newtype as well."}], "answers": [{"comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 634, "user_id": 4697270, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7884aed17ee40cfaae6b53e6966b29ea?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4697270/david"}, "edited": false, "score": 2, "creation_date": 1431548997, "post_id": 30221631, "comment_id": 48553067, "body": "@David You must also verify that <code>fun1</code> is associative for it to be a correct Monoid instance."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 1, "last_activity_date": 1431541351, "last_edit_date": 1431541351, "creation_date": 1431538250, "answer_id": 30221631, "question_id": 30221441, "link": "https://stackoverflow.com/questions/30221441/how-to-make-monoid-instance-for-my-type/30221631#30221631", "title": "How to make Monoid instance for my type?", "body": "<p>If you already have <code>fun1</code>, just add an instance:</p>\n\n<pre><code>instance Monoid TypeA where\n   mempty = .... -- fill this with the neutral element\n   mappend = fun1\n</code></pre>\n\n<p>Probably, you want <code>mempty = TypeA []</code>.</p>\n"}], "owner": {"reputation": 634, "user_id": 4697270, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7884aed17ee40cfaae6b53e6966b29ea?s=128&d=identicon&r=PG&f=1", "display_name": "David", "link": "https://stackoverflow.com/users/4697270/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "accepted_answer_id": 30221631, "answer_count": 1, "score": 1, "last_activity_date": 1431541351, "creation_date": 1431537644, "question_id": 30221441, "link": "https://stackoverflow.com/questions/30221441/how-to-make-monoid-instance-for-my-type", "title": "How to make Monoid instance for my type?", "body": "<p>I have the following type:</p>\n\n<pre><code>data SomeType = Var String\n    deriving (Eq,Show)\n\nnewtype TypeA = TypeA [(String, SomeType)]\n  deriving (Eq,Show)\n</code></pre>\n\n<p>Also, I have a function:</p>\n\n<pre><code>fun1 :: TypeA -&gt; TypeA -&gt; TypeA\n</code></pre>\n\n<p>I can use this function for <code>mappend</code>. </p>\n\n<p>I don't understand, how to implement Monoid interface in my case.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1431534136, "post_id": 30220219, "comment_id": 48544548, "body": "Also see this: <a href=\"http://programmers.stackexchange.com/questions/211053/why-isnt-length-generic-by-default\" title=\"why isnt length generic by default\">programmers.stackexchange.com/questions/211053/&hellip;</a>"}], "owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 77, "favorite_count": 1, "closed_date": 1431534186, "answer_count": 0, "score": 2, "last_activity_date": 1431533681, "creation_date": 1431533681, "question_id": 30220219, "link": "https://stackoverflow.com/questions/30220219/why-length-return-int-and-not-num", "closed_reason": "Duplicate", "title": "Why length return Int and not Num", "body": "<p>Is there any reason for restricting <code>length</code> function to <code>Int</code> and not to <code>Num</code> ? </p>\n\n<p>A lot of functions from prelude have the restriction to <code>Int</code> type and not to a more generic type / typeclass:</p>\n\n<pre><code>:t length\nlength :: [a] -&gt; Int\n\n:t take\ntake :: Int -&gt; [a] -&gt; [a]\n\n:t drop\ndrop :: Int -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>But there are also more generic functions in Data.List</p>\n\n<pre><code>:t genericLength\ngenericLength :: Num i =&gt; [a] -&gt; i\n\n:t genericTake\ngenericTake :: Integral i =&gt; i -&gt; [a] -&gt; [a]\n\n:t genericDrop\ngenericDrop :: Integral i =&gt; i -&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>Why the first ones have the <code>Int</code> restrictions and are not defined generic as the second ones ? \nIs there any reason for this <code>Int</code> restriction?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1431527423, "post_id": 30217539, "comment_id": 48539543, "body": "What do you mean by &quot;hard to come by&quot;? It&#39;s impossible to &quot;normally&quot; create a function of the type <code>a -&gt; b</code>. The only function of the type <code>a -&gt; b</code> is <code>let f x = f x</code> or a variant thereof such as <code>let f x = undefined</code> or <code>let f x = error &quot;This function is pointless.&quot;</code>. There&#39;s no useful function of the type <code>a -&gt; b</code>."}, {"owner": {"reputation": 23816, "user_id": 572606, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c20a126ad0dce40e8fc4a43456107919?s=128&d=identicon&r=PG", "display_name": "shang", "link": "https://stackoverflow.com/users/572606/shang"}, "edited": false, "score": 1, "creation_date": 1431527514, "post_id": 30217539, "comment_id": 48539615, "body": "Well, except <code>unsafeCoerce</code>."}], "tags": [], "owner": {"reputation": 10108, "user_id": 450811, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b1a81486c967643c2f05cddb94841d27?s=128&d=identicon&r=PG", "display_name": "Waldheinz", "link": "https://stackoverflow.com/users/450811/waldheinz"}, "is_accepted": false, "score": 2, "last_activity_date": 1431526545, "creation_date": 1431526545, "answer_id": 30217539, "question_id": 30217354, "link": "https://stackoverflow.com/questions/30217354/confused-about-haskell-polymorphic-types/30217539#30217539", "title": "Confused about Haskell polymorphic types", "body": "<p>Your type signature <code>gen :: a -&gt; b</code> is stating, that your function can work for <em>any</em> type a (and provide <em>any</em> type b the <em>caller</em> of the function demands).</p>\n\n<p>Besides the fact that such a function is hard to come by, the line <code>gen 2 = \"test\"</code> tries to return a <code>String</code> which very well may not be what the caller demands.</p>\n"}, {"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 7, "last_activity_date": 1431558250, "last_edit_date": 1431558250, "creation_date": 1431526558, "answer_id": 30217542, "question_id": 30217354, "link": "https://stackoverflow.com/questions/30217354/confused-about-haskell-polymorphic-types/30217542#30217542", "title": "Confused about Haskell polymorphic types", "body": "<p><code>gen :: a -&gt; b</code> does not mean \"for some type <code>a</code> and some type <code>b</code>, <code>foo</code> must be of type <code>a -&gt; b</code>\", it means \"for <em>any</em> type <code>a</code> and <em>any</em> type <code>b</code>, <code>foo</code> must be of type <code>a -&gt; b</code>\".</p>\n\n<p>to motivate this: If the type checker sees something like <code>let x :: Int = gen \"hello\"</code>, it sees that <code>gen</code> is used as <code>String -&gt; Int</code> here and then looks at <code>gen</code>'s type to see whether it can be used that way. The type is <code>a -&gt; b</code>, which can be specialized to <code>String -&gt; Int</code>, so the type checker decides that this is fine and allows this call. That is since the function is declared to have type <code>a -&gt; b</code>, the type checker allows you to call the function with any type you want and allows you to use the result as any type you want.</p>\n\n<p>However that clearly does not match the definition you gave the function. The function knows how to handle numbers as arguments - nothing else. And likewise it knows how to produce strings as its result - nothing else. So clearly it should not be possible to call the function with a string as its argument or to use the function's result as an Int. So since the type <code>a -&gt; b</code> would allow that, it's clearly the wrong type for that function.</p>\n"}, {"comments": [{"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1431527820, "post_id": 30217905, "comment_id": 48539911, "body": "The <code>Object</code> type in Java is not the same as a universally quantified type variable in Haskell. The <code>Object</code> type is the <a href=\"https://en.wikipedia.org/wiki/Top_type\" rel=\"nofollow noreferrer\">top type</a> of Java whereas a universally quantified type variable is the <a href=\"https://en.wikipedia.org/wiki/Bottom_type\" rel=\"nofollow noreferrer\">bottom type</a> in Haskell. Hence, the <code>Object</code> type in Java is actually equivalent to <code>forall r. (forall a. a -&gt; r) -&gt; r</code> in Haskell where <code>a</code> is the existentially quantified variable."}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1431528126, "post_id": 30217905, "comment_id": 48540174, "body": "Oops. I misread your answer. I thought that you were saying that the <code>Object</code> type in Java is equivalent to the bottom type in Haskell. Nevertheless, you can have a function that returns an existential type in Haskell. Thus, technically it is possible for a function in Haskell to choose its own return type."}, {"owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "edited": false, "score": 0, "creation_date": 1431529176, "post_id": 30217905, "comment_id": 48541008, "body": "@MathematicalOrchid so what is a valid implementation of &#39;gen&#39; given I cannot return any type other than &#39;b&#39;? I fail to see how this is polymorphic, even though I know it is..."}, {"owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "edited": false, "score": 0, "creation_date": 1431530175, "post_id": 30217905, "comment_id": 48541793, "body": "@MathematicalOrchid cool, think I see things a little clearer now : data List t = E | C t (List t) \tderiving Show gen :: a -&gt; List a gen a = C a E"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "reply_to_user": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "edited": false, "score": 2, "creation_date": 1431530792, "post_id": 30217905, "comment_id": 48542265, "body": "@blue-sky There are some ways to implement <code>gen</code>, but most of them are useless. For example <code>gen x = gen x</code> works (and never successfully produces a result), so does <code>gen x = unsafeCoerce x</code>, which actually may produce a valid result, but the function doesn&#39;t have &quot;unsafe&quot; in its name for no reason (basically it&#39;s like a <code>reinterpret_cast</code> in C++ or addressof + cast + dereference in C)."}, {"owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "edited": false, "score": 0, "creation_date": 1431543853, "post_id": 30217905, "comment_id": 48550301, "body": "@MathematicalOrchid &quot;the caller gets to decide what type that is, not you!&quot; what is the caller in this context ? Is the caller not the code that invokes the function, which is me ?"}, {"owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "edited": false, "score": 0, "creation_date": 1431548825, "post_id": 30217905, "comment_id": 48552982, "body": "@MathematicalOrchid so &quot;the caller gets to decide what type that is, not you!&quot; is false as I do not get to decide what that type is ? The type is &quot;a&quot; and I do not get to decide what the type is, it must be type a, therefore the caller does not get to decide the type ?"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "reply_to_user": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "edited": false, "score": 1, "creation_date": 1431549267, "post_id": 30217905, "comment_id": 48553211, "body": "@blue-sky The caller is the expression that calls (applies) the function. The fact that you wrote both expressions is irrelevant."}, {"owner": {"reputation": 1376, "user_id": 996028, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/PUCrl.png?s=128&g=1", "display_name": "Sawny", "link": "https://stackoverflow.com/users/996028/sawny"}, "edited": false, "score": 0, "creation_date": 1431644776, "post_id": 30217905, "comment_id": 48598408, "body": "<a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/Unsafe-Coerce.html#v:unsafeCoerce\" rel=\"nofollow noreferrer\"><code>Unsafe.Coerce</code></a> is <code>a -\u202d&gt; b</code> ;)"}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": true, "score": 11, "last_activity_date": 1431529469, "last_edit_date": 1431529469, "creation_date": 1431527427, "answer_id": 30217905, "question_id": 30217354, "link": "https://stackoverflow.com/questions/30217354/confused-about-haskell-polymorphic-types/30217905#30217905", "title": "Confused about Haskell polymorphic types", "body": "<p>This is a very common misunderstanding.</p>\n\n<p>The key thing to understand is that if you have a variable in your type signature, then <em>the caller</em> gets to decide what type that is, <em>not you!</em></p>\n\n<p>So you cannot say \"this function returns type <code>x</code>\" and then just return a <code>String</code>; your function actually has to be able to return <em>any possible type</em> that the caller may ask for. If I ask your function to return an <code>Int</code>, it has to return an <code>Int</code>. If I ask it to return a <code>Bool</code>, it has to return a <code>Bool</code>.</p>\n\n<p>Your function <em>claims</em> to be able to return any possible type, but <em>actually</em> it only ever returns <code>String</code>. So it doesn't do what the type signature claims it does. Hence, a compile-time error.</p>\n\n<p>A lot of people apparently misunderstand this. In (say) Java, you can say \"this function returns <code>Object</code>\", and then your function can return anything it wants. So the <em>function</em> decides what type it returns. In Haskell, the <em>caller</em> gets to decide what type is returned, not the function.</p>\n\n<p><strong>Edit:</strong> Note that the type you're written, <code>a -&gt; b</code>, is impossible. No function can <em>ever</em> have this type. There's no way a function can construct a value of type <code>b</code> out of thin air. The only way this can work is if some of the inputs also involve type <code>b</code>, or if <code>b</code> belongs to some kind of typeclass which allows value construction.</p>\n\n<p>For example:</p>\n\n<pre><code>head :: [x] -&gt; x\n</code></pre>\n\n<p>The return type here is <code>x</code> (\"any possible type\"), but the input type also mentions <code>x</code>, so this function is possible; you just have to return one of the values that was in the original list.</p>\n\n<p>Similarly, <code>gen :: a -&gt; a</code> is a perfectly valid function. But the only thing it can do is return it's input unchanged (i.e., what the <code>id</code> function does).</p>\n\n<p>This property of type signatures telling you what a function does is a very useful and powerful property of Haskell.</p>\n"}, {"comments": [{"owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "edited": false, "score": 1, "creation_date": 1431551643, "post_id": 30224725, "comment_id": 48554449, "body": "+1 thanks, I sort of &quot;get it&quot;, it seems to me that once a generic type parameter is used the operations of the function are extremely limited, as cannot subtype the generic type to more specific behavior. I&#39;ve just started on my Haskell journey so hopefully will make more sense as I go deeper."}], "tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 1, "last_activity_date": 1431549381, "creation_date": 1431549381, "answer_id": 30224725, "question_id": 30217354, "link": "https://stackoverflow.com/questions/30217354/confused-about-haskell-polymorphic-types/30224725#30224725", "title": "Confused about Haskell polymorphic types", "body": "<p>Excellent answers.  Given your profile, however, you seem to know Java, so I think it's valuable to connect this to Java as well.</p>\n\n<p>Java offers two kinds of polymorphism:</p>\n\n<ol>\n<li><strong>Subtype polymorphism:</strong> e.g., every type is a subtype of <code>java.lang.Object</code></li>\n<li><strong>Generic polymorphism:</strong> e.g., in the <code>List&lt;T&gt;</code> interface.</li>\n</ol>\n\n<p>Haskell's type variables are a version of (2).  Haskell doesn't really have a version of (1).</p>\n\n<p>One way to think of generic polymorphism is in terms of <em>templates</em> (which is what C++ people call them): a type that has a type variable parameter is a template that can be <em>specialized</em> into a variety of <em>monomorphic</em> types.  So for example, the interface <code>List&lt;T&gt;</code> is a template for constructing monomorphic interfaces like <code>List&lt;String&gt;</code>, <code>List&lt;List&lt;String&gt;&gt;</code> and so on, all of which have the same structure but differ only because the type variable <code>T</code> gets replaced uniformly throughout the signatures with the instantiation type.</p>\n\n<p>The concept that \"the caller chooses\" that several responders have mentioned here is basically a friendly way of referring to instantiation.  In Java, for example, the most common point where the type variable gets \"chosen\" is when an object is instantiated:</p>\n\n<pre><code>List&lt;String&gt; myList = new ArrayList&lt;String&gt;();\n</code></pre>\n\n<p>Second common point is that a subtype of a generic type may instantiate the supertype's variables:</p>\n\n<pre><code>class MyFunction implements Function&lt;Integer, String&gt; {\n    public String apply(Integer i) { ... }\n}\n</code></pre>\n\n<p>Third one is methods that allow the caller to instantiate a variable that's not a parameter of its enclosing type:</p>\n\n<pre><code>/**\n * Visitor-pattern style interface for a simple arithmetical language\n * abstract syntax tree.\n */\ninterface Expression {\n    // The caller of `accept` implicitly chooses which type `R` is,\n    // by supplying a `Visitor&lt;R&gt;` with `R` instantiated to something\n    // of its choice.\n    &lt;R&gt; accept(Expression.Visitor&lt;R&gt; visitor);\n\n    static interface Visitor&lt;R&gt; {\n        R constant(int i);\n        R add(Expression a, Expression b);\n        R multiply(Expression a, Expression b);\n    }\n}\n</code></pre>\n\n<p>In Haskell, instantiation is carried out implicitly by the type inference algorithm.  In any expression where you use <code>gen :: a -&gt; b</code>, type inference will infer what types need to be instantiated for <code>a</code> and <code>b</code>, given the context in which <code>gen</code> is used.  So basically, \"caller chooses\" means that any code that uses <code>gen</code> controls the types to which <code>a</code> and <code>b</code> will be instantiated; if I write <code>gen [()]</code>, then I'm implicitly instantiating <code>a</code> to <code>[()]</code>.  The error here means that your type declaration says that <code>gen [()]</code> is allowed, but your equation <code>gen 2 = \"test\"</code> implies that it's not.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 0, "last_activity_date": 1431556174, "creation_date": 1431556174, "answer_id": 30226274, "question_id": 30217354, "link": "https://stackoverflow.com/questions/30217354/confused-about-haskell-polymorphic-types/30226274#30226274", "title": "Confused about Haskell polymorphic types", "body": "<p>In Haskell, type variables are implicitly quantified, but we can make this explicit:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n\ngen :: forall a b . a -&gt; b\ngen x = ????\n</code></pre>\n\n<p>The \"forall\" is really just a type level version of a lambda, often written &Lambda;. So <code>gen</code> is a function taking three arguments: a type, bound to the name <code>a</code>, another type, bound to the name <code>b</code>, and a value of type <code>a</code>, bound to the name <code>x</code>. When your function is called, it is called with those three arguments. Consider a saner case:</p>\n\n<pre><code>fst :: (a,b) -&gt; a\nfst (x1,x2) = x1\n</code></pre>\n\n<p>This gets translated to</p>\n\n<pre><code>fst :: forall (a::*) (b::*) . (a,b) -&gt; a\nfst = /\\ (a::*) -&gt; /\\ (b::*) -&gt; \\ (x::(a,b)) -&gt;\n   case x of\n      (x1, x2) -&gt; x1\n</code></pre>\n\n<p>where <code>*</code> is the type (often called a <em>kind</em>) of normal concrete types. If I call <code>fst (3::Int, 'x')</code>, that gets translated into</p>\n\n<pre><code>fst Int Char (3Int, 'x')\n</code></pre>\n\n<p>where I use <code>3Int</code> to represent specifically the <code>Int</code> version of <code>3</code>. We could then calculate it as follows:</p>\n\n<pre><code>fst Int Char (3Int, 'x')\n=\n(/\\ (a::*) -&gt; /\\ (b::*) -&gt; \\(x::(a,b)) -&gt; case x of (x1,x2) -&gt; x1) Int Char (3Int, 'x')\n=\n(/\\ (b::*) -&gt; \\(x::(Int,b)) -&gt; case x of (x1,x2) -&gt; x1) Char (3Int, 'x')\n=\n(\\(x::(Int,Char)) -&gt; case x of (x1,x2) -&gt; x1) (3Int, x)\n=\ncase (3Int,x) of (x1,x2) -&gt; x1\n=\n3Int\n</code></pre>\n\n<p>Whatever types I pass in, as long as the value I pass in matches, the <code>fst</code> function will be able to produce something of the required type. If you try to do this for <code>a-&gt;b</code>, you will get stuck.</p>\n"}], "owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 262, "favorite_count": 0, "accepted_answer_id": 30217905, "answer_count": 5, "score": 4, "last_activity_date": 1431558250, "creation_date": 1431526083, "last_edit_date": 1431527564, "question_id": 30217354, "link": "https://stackoverflow.com/questions/30217354/confused-about-haskell-polymorphic-types", "title": "Confused about Haskell polymorphic types", "body": "<p>I have defined a function : </p>\n\n<pre><code>gen :: a -&gt; b\n</code></pre>\n\n<p>So just trying to provide a simple implementation : </p>\n\n<pre><code>gen 2 = \"test\"\n</code></pre>\n\n<p>But throws error : </p>\n\n<pre><code>gen.hs:51:9:\n    Couldn't match expected type \u2018b\u2019 with actual type \u2018[Char]\u2019\n      \u2018b\u2019 is a rigid type variable bound by\n          the type signature for gen :: a -&gt; b at gen.hs:50:8\n    Relevant bindings include gen :: a -&gt; b (bound at gen.hs:51:1)\n    In the expression: \"test\"\n    In an equation for \u2018gen\u2019: gen 2 = \"test\"\nFailed, modules loaded: none.\n</code></pre>\n\n<p>So my function is not correct. Why is <code>a</code> not typed as Int and <code>b</code> not typed as String ?</p>\n"}, {"tags": ["list", "haskell", "types", "existential-type", "heterogeneous"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1431523866, "post_id": 30216149, "comment_id": 48536499, "body": "I&#39;m curious though: why not just <code>[[&quot;h&quot;], [&quot;x&quot;, &quot;y&quot;], [&quot;i&quot;], [&quot;m&quot;, &quot;n&quot;, &quot;p&quot;]]</code>?"}, {"owner": {"reputation": 487, "user_id": 1732572, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/606b0e170b829d9e94d107d83d082fab?s=128&d=identicon&r=PG", "display_name": "spacingissue", "link": "https://stackoverflow.com/users/1732572/spacingissue"}, "reply_to_user": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1431526724, "post_id": 30216149, "comment_id": 48538954, "body": "Essentially, for user-friendliness.  I wanted the user to have more than one option in expressing their config.  After a while, a lot of curiosity as to whether it could be done."}, {"owner": {"reputation": 2179, "user_id": 412549, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a194a155579e30bda0926705aeb9d165?s=128&d=identicon&r=PG&f=1", "display_name": "Franky", "link": "https://stackoverflow.com/users/412549/franky"}, "edited": false, "score": 0, "creation_date": 1431531885, "post_id": 30216149, "comment_id": 48543044, "body": "These &quot;lists&quot; are called <i>Trees</i>."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 6, "creation_date": 1431527617, "post_id": 30216560, "comment_id": 48539715, "body": "I&#39;m simultaneously impressed and disgusted."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1431527787, "post_id": 30216560, "comment_id": 48539880, "body": "@dfeuer You&#39;re not the only one... It makes it look like I&#39;m writing Python instead."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 7, "last_activity_date": 1431531671, "last_edit_date": 1431531671, "creation_date": 1431524224, "answer_id": 30216560, "question_id": 30216149, "link": "https://stackoverflow.com/questions/30216149/haskell-type-without-boilerplate-for-a-heterogeneous-list-of-string-and-or-s/30216560#30216560", "title": "Haskell: Type (without boilerplate) for a heterogeneous list of String and/or [String]?", "body": "<p>This will work for arbitrarily nested lists of strings with a few extension tricks:</p>\n\n<pre><code>{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE OverloadedLists #-}\n\nimport GHC.Exts\nimport Data.String\n\ndata MyStringListThingy\n    = String String\n    | List [MyStringListThingy]\n    deriving (Eq, Show)\n\ninstance IsString MyStringListThingy where\n    fromString = String\n\ninstance IsList MyStringListThingy where\n    type Item MyStringListThingy = MyStringListThingy\n    fromList = List\n    fromListN _ = List\n    toList (String s) = [String s]\n    toList (List ss) = ss\n\nstrs :: MyStringListThingy\nstrs = [\"h\", [\"x\", \"y\"], \"i\", [\"m\", \"n\", \"p\", [\"q\", [\"r\", \"s\"]]]]\n</code></pre>\n\n<p>You need at least GHC 7.8 for this though, possibly 7.10 (I haven't tested with 7.8).</p>\n\n<p>This isn't precisely getting away without boilerplate, the compiler puts implicit function calls in front of each of those literals:</p>\n\n<pre><code>strs = fL [fS \"h\", fL [fS \"x\", fS \"y\"], fS \"i\", fL [fS \"m\", fS \"n\", fS \"p\", fL [fS \"q\", fL [fS \"r\", fS \"s\"]]]]\n    where\n        fL = fromList\n        fS = fromString\n</code></pre>\n\n<p>Although without the <code>fL</code> and <code>fS</code> aliasing, I only did that so I wouldn't have to type so much.  It only feels boilerplate-free because the compiler puts those function calls in there for you, but you still will have the overhead of turning those values into <code>MyStringListThingy</code>.</p>\n\n<p>You could probably get away with heterogeneous lists of numbers using this trick as well, since numeric literals are also polymorphic, which is what the <code>OverloadedStrings</code> and <code>OverloadedLists</code> extensions do for those literals as well.  By making a type that wraps lists and strings, then instances the requisite typeclasses you allow Haskell to cast from those literals to your custom type.  The <code>TypeFamilies</code> extension is necessary for the <code>IsList</code> instance only.  If you want to play with it in GHCi you'll have to enable all these extensions there as well, but it definitely works.</p>\n\n<p>A more generic implementation would be</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-}\n{-# LANGUAGE TypeFamilies #-}\n{-# LANGUAGE OverloadedStrings #-}\n{-# LANGUAGE OverloadedLists #-}\n\nimport GHC.Exts\nimport Data.String\n\ndata NestedList a\n    = Item a\n    | List [NestedList a]\n    deriving (Eq, Show)\n\ninstance IsList (NestedList a) where\n    type Item (NestedList a) = NestedList a\n    fromList = List\n    fromListN _ = List\n    toList (List xs) = xs\n    toList item = [item]\n\ninstance IsString (NestedList String) where\n    fromString = Item\n\ninstance Num a =&gt; Num (NestedList a) where\n    fromInteger = Item . fromInteger\n</code></pre>\n\n<p>The <code>Num</code> instance doesn't implement everything it needs to, just enough to show off that this works</p>\n\n<pre><code>&gt; [1, [2, 3]] :: NestedList Int\nList [Item 1, List [Item 2, Item 3]]\n</code></pre>\n\n<p>I wouldn't recommend using this in real code, though.</p>\n"}], "owner": {"reputation": 487, "user_id": 1732572, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/606b0e170b829d9e94d107d83d082fab?s=128&d=identicon&r=PG", "display_name": "spacingissue", "link": "https://stackoverflow.com/users/1732572/spacingissue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 30216560, "answer_count": 1, "score": 2, "last_activity_date": 1431531671, "creation_date": 1431523305, "last_edit_date": 1431531394, "question_id": 30216149, "link": "https://stackoverflow.com/questions/30216149/haskell-type-without-boilerplate-for-a-heterogeneous-list-of-string-and-or-s", "title": "Haskell: Type (without boilerplate) for a heterogeneous list of String and/or [String]?", "body": "<p>I would like to have a heterogeneous list of <code>String</code> and <code>[String]</code>, as such:</p>\n\n<pre><code>strs = [\"h\", [\"x\", \"y\"], \"i\", [\"m\", \"n\", \"p\"]]\n</code></pre>\n\n<p>I know I can do this with a custom data type:</p>\n\n<pre><code>data EitherOr t = StringS t | StringL [t]\n\neitherOrstrs :: [EitherOr String]\neitherOrstrs = [StringS \"h\", StringL [\"x\", \"y\"], StringS \"i\", StringL [\"m\", \"n\", \"p\"]]\n</code></pre>\n\n<p>But I'm curious as to whether this is possible without any boilerplate, as in <code>strs</code> above.</p>\n\n<p>So far I've tried:</p>\n\n<pre><code>{-# LANGUAGE ExistentialQuantification #-}\n\nclass Listable a where\n  toListForm :: [String]\n\ninstance Listable String where\n  toListForm s = [s]\n\ninstance Listable [String] where\n  toListForm = id\n\nstrs :: forall a. Listable a =&gt; [a]\nstrs = [\"h\", [\"x\", \"y\"], \"i\", [\"m\", \"n\", \"p\"]]\n</code></pre>\n\n<p>But haven't yet found a working method:</p>\n\n<pre><code>The class method \u2018toListForm\u2019\nmentions none of the type or kind variables of the class \u2018Listable a\u2019\nWhen checking the class method: toListForm :: [String]\nIn the class declaration for \u2018Listable\u2019\n</code></pre>\n\n<p>Does anyone know if this is possible?</p>\n"}, {"tags": ["haskell", "logging", "persistent", "esqueleto"], "answers": [{"comments": [{"owner": {"reputation": 7283, "user_id": 348716, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9d46cbdc3830248a0615f14ae4b7b33d?s=128&d=identicon&r=PG", "display_name": "Anupam Jain", "link": "https://stackoverflow.com/users/348716/anupam-jain"}, "edited": false, "score": 0, "creation_date": 1431535657, "post_id": 30219483, "comment_id": 48545494, "body": "I may be missing something. I tried putting in your code but it doesn&#39;t seem to have an effect. Is the following correct?      <code>main :: IO ()</code>     <code>main = runResourceT $ runStdoutLoggingT $ runSqlite &quot;:memory:&quot; $ do</code>  The output is still only - <code>Migrating: CREATE TABLE &quot;person&quot;(&quot;id&quot; INTEGER PRIMARY KEY,&quot;name&quot; VARCHAR NOT NULL,&quot;status&quot; VARCHAR NULL)</code>"}, {"owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "reply_to_user": {"reputation": 7283, "user_id": 348716, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9d46cbdc3830248a0615f14ae4b7b33d?s=128&d=identicon&r=PG", "display_name": "Anupam Jain", "link": "https://stackoverflow.com/users/348716/anupam-jain"}, "edited": false, "score": 1, "creation_date": 1431545174, "post_id": 30219483, "comment_id": 48551077, "body": "Sorry, my mistake, runSqlLite already sets up the logging (to none), so you need to use the lower level functions. I&#39;ve updated my answer."}, {"owner": {"reputation": 7283, "user_id": 348716, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9d46cbdc3830248a0615f14ae4b7b33d?s=128&d=identicon&r=PG", "display_name": "Anupam Jain", "link": "https://stackoverflow.com/users/348716/anupam-jain"}, "edited": false, "score": 0, "creation_date": 1431580447, "post_id": 30219483, "comment_id": 48562713, "body": "That worked! Thanks! Yes I realised that I should have used <code>isNothing</code>, that&#39;s the bug that took me a while to track down without SQL logging and prompted this question :)"}, {"owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "edited": false, "score": 0, "creation_date": 1499781356, "post_id": 30219483, "comment_id": 77047144, "body": "@JPMoresmau would you know how to to this in a yesod project? It seems like I should change this line <code>logFunc = messageLoggerSource tempFoundation appLogger</code>"}], "tags": [], "owner": {"reputation": 7002, "user_id": 827593, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4d852cf0e1b0e4036e07754fc3925f46?s=128&d=identicon&r=PG", "display_name": "JP Moresmau", "link": "https://stackoverflow.com/users/827593/jp-moresmau"}, "is_accepted": true, "score": 3, "last_activity_date": 1492360385, "last_edit_date": 1492360385, "creation_date": 1431531521, "answer_id": 30219483, "question_id": 30214887, "link": "https://stackoverflow.com/questions/30214887/how-to-enable-automatic-logging-of-sql-statements-with-persistent/30219483#30219483", "title": "How to enable automatic logging of SQL statements with Persistent", "body": "<p>You need to call your SQL code in a Monad that implements MonadLogger and not just IO. (see <a href=\"http://hackage.haskell.org/package/monad-logger-0.3.13.1/docs/Control-Monad-Logger.html#v:runStdoutLoggingT\" rel=\"nofollow noreferrer\">http://hackage.haskell.org/package/monad-logger-0.3.13.1/docs/Control-Monad-Logger.html#v:runStdoutLoggingT</a>). However, runSqlite already sets up the logging (to none...) for you, so you need to use the lower level function withSqliteConn.\nSo for example, if you change your code to:</p>\n\n<pre><code>import Control.Monad.Logger\nimport Control.Monad.Trans.Resource\n\nrunResourceT $ runStdoutLoggingT $ withSqliteConn \":memory:\" . runSqlConn  $ do...\n</code></pre>\n\n<p>(with the proper dependencies on resourcet and monad-logger), you can have your SQL statement written to standard out.</p>\n\n<p>As a real-life example, have a look at my scion-class-browser project:\nin <a href=\"https://github.com/JPMoresmau/scion-class-browser/blob/5ab9c7576f8faf93299826e72defe70dd5b6dd6f/src/Server/PersistentCommands.hs#L93\" rel=\"nofollow noreferrer\">https://github.com/JPMoresmau/scion-class-browser/blob/5ab9c7576f8faf93299826e72defe70dd5b6dd6f/src/Server/PersistentCommands.hs#L93</a> you see the call to runSqlite. runLogging is a helper function, to switch between logging or no logging, defined in <a href=\"https://github.com/JPMoresmau/scion-class-browser/blob/f7f2ab0de4f4edb01b307411abf0aa951a3c7c48/src/Scion/PersistentBrowser/DbTypes.hs#L16\" rel=\"nofollow noreferrer\">https://github.com/JPMoresmau/scion-class-browser/blob/f7f2ab0de4f4edb01b307411abf0aa951a3c7c48/src/Scion/PersistentBrowser/DbTypes.hs#L16</a> (the currently build version does not log, replace by the commented out code).</p>\n\n<p>Of course, you can instead of using a simple dump to stdout or stderr, write your own implementation of MonadLogger that does what you want.</p>\n\n<p>As a side note, your code doesn't print out the matching records because you shouldn't compare with val Nothing but instead use isNothing:</p>\n\n<pre><code>where_ (isNothing $ person ^. PersonStatus)\n</code></pre>\n"}], "owner": {"reputation": 7283, "user_id": 348716, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/9d46cbdc3830248a0615f14ae4b7b33d?s=128&d=identicon&r=PG", "display_name": "Anupam Jain", "link": "https://stackoverflow.com/users/348716/anupam-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 753, "favorite_count": 0, "accepted_answer_id": 30219483, "answer_count": 1, "score": 2, "last_activity_date": 1492360385, "creation_date": 1431520352, "question_id": 30214887, "link": "https://stackoverflow.com/questions/30214887/how-to-enable-automatic-logging-of-sql-statements-with-persistent", "title": "How to enable automatic logging of SQL statements with Persistent", "body": "<p>I have searched for a clear answer to this question but haven't been able to find one yet - How do I enable automatic logging of SQL statements being executed by persistent? Can someone give me a small example program for this?</p>\n\n<p>Following is an example program that currently does not have logging. How do I enable logging in it?</p>\n\n<pre><code>share [mkPersist sqlSettings, mkMigrate \"migrateAll\"] [persistLowerCase|\n    Person\n    name Text\n    status Text Maybe\n    deriving Show\n|]\n\nmain :: IO ()\nmain = runSqlite \":memory:\" $ do\n    runMigration migrateAll\n    insert (Person \"Oliver Charles\" Nothing)\n    insert (Person \"Jon Snow\" Nothing)\n    insert (Person \"Marky Mark\" (Just \"helloo helloo\"))\n    noStatusPeople &gt;&gt;= mapM_ (liftIO . print)\n    where\n        noStatusPeople =\n            select $ from $ \\person -&gt; do\n                where_ (person ^. PersonStatus ==. val Nothing)\n                return (person ^. PersonName)\n</code></pre>\n"}, {"tags": ["haskell", "monads", "function-composition"], "comments": [{"owner": {"reputation": 13597, "user_id": 1463507, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9d940a7d55911df9afca8e2dd525f3ee?s=128&d=identicon&r=PG", "display_name": "kqr", "link": "https://stackoverflow.com/users/1463507/kqr"}, "edited": false, "score": 1, "creation_date": 1431506506, "post_id": 30206660, "comment_id": 48524043, "body": "Now that I get to read these typeclasses with names like <code>misty</code>, <code>furry</code> and <code>banana</code> I understand why so many people dislike their mathematical names..."}], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 4, "last_activity_date": 1431505497, "last_edit_date": 1431505497, "creation_date": 1431499560, "answer_id": 30207512, "question_id": 30206660, "link": "https://stackoverflow.com/questions/30206660/haskell-function-composition-of-two-binary-functions/30207512#30207512", "title": "Haskell Function composition of two binary functions?", "body": "<p>Let's start step by step. <code>Misty</code> typeclass is given:</p>\n\n<pre><code>class Misty m where \n  banana :: (a -&gt; m b) -&gt; m a -&gt; m b \n  unicorn :: a -&gt; m a\n</code></pre>\n\n<p>Also <code>furry'</code> is already solved in an earlier problem in those exercises:</p>\n\n<pre><code>furry' :: Misty m =&gt; (a -&gt; b) -&gt; m a -&gt; m b\nfurry' f mi = banana (\\x -&gt; unicorn (f x)) mi\n</code></pre>\n\n<p>Now you have <code>apple</code> function which you have to define:</p>\n\n<pre><code>apple :: (Misty m) =&gt; m a -&gt; m (a -&gt; b) -&gt; m b\napple = error \"todo\"\n</code></pre>\n\n<p>Now just try to follow the type signature. Assume you are defining <code>apple</code> like this:</p>\n\n<pre><code>apple xs ys\n\nxs will have type of m a\n\nys will have type of m (a -&gt; b)\n</code></pre>\n\n<p>Now can you see the relation between the above types and <code>furry'</code> ? So\nyou have to somehow apply <code>xs</code> and <code>ys</code> to <code>furry'</code> Now since it's\nsecond parameter is <code>m a</code> which you already have in <code>xs</code>, you can use\n<code>flip</code> to obtain it:</p>\n\n<p><code>flip furry' ::  m a -&gt; (a -&gt; b) -&gt; m b</code></p>\n\n<p>So you can apply <code>xs</code> to the first parameter of it and you will have\nthe following type signature:</p>\n\n<p><code>(flip furry') xs :: (a -&gt; b) -&gt; m b</code>   <strong>-------</strong> <strong>Equation</strong> <strong>1</strong></p>\n\n<p>Any guess on how to apply it <code>ys</code>? Try to unify the above type\nsignature with the first parameter of <code>banana</code> :</p>\n\n<p>That will give you:</p>\n\n<pre><code>a ~ (a -&gt; b)\nm b ~ (m b)\n</code></pre>\n\n<p>So, the type signature of <code>banana</code> gets transformed from</p>\n\n<pre><code>banana :: (a -&gt; m b) -&gt; m a -&gt; m b\n</code></pre>\n\n<p>to</p>\n\n<pre><code>banana :: ((a -&gt; b) -&gt; m b) -&gt; m (a -&gt; b) -&gt; m b \n</code></pre>\n\n<p>Now from <code>Equation (1)</code> we know that <code>(flip furry') xs</code> type signature matches\nthe first parameter of <code>banana</code> and <code>ys</code> matches the second parameter\nof <code>banana</code>. And that gives you the definition of <code>apple</code>:</p>\n\n<pre><code>apple :: (Misty m) =&gt; m a -&gt; m (a -&gt; b) -&gt; m b\napple xs ys = banana ((flip furry') xs ) ys\n</code></pre>\n\n<p>which can be expressed in pointfree manner as:</p>\n\n<pre><code>apple :: (Misty m) =&gt; m a -&gt; m (a -&gt; b) -&gt; m b\napple = banana . flip furry'\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 4894200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/23d4af4e5945a567021e8b68a32430ad?s=128&d=identicon&r=PG&f=1", "display_name": "Roscode", "link": "https://stackoverflow.com/users/4894200/roscode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 2, "accepted_answer_id": 30207512, "answer_count": 1, "score": 2, "last_activity_date": 1431519404, "creation_date": 1431496203, "last_edit_date": 1431519404, "question_id": 30206660, "link": "https://stackoverflow.com/questions/30206660/haskell-function-composition-of-two-binary-functions", "title": "Haskell Function composition of two binary functions?", "body": "<p>I'm working my way through <a href=\"https://www.fpcomplete.com/user/DanBurton/20-intermediate-exercises\" rel=\"nofollow\">20 Intermediate Haskell exercises</a> and I got stuck on exercise 13:</p>\n\n<pre><code>-- Exercise 13\n-- Relative Difficulty: 6\napple :: (Misty m) =&gt; m a -&gt; m (a -&gt; b) -&gt; m b\napple = error \"todo\"\n</code></pre>\n\n<p>where the Misty Typeclass is essentially the Monad Typeclass and is implemented like this:</p>\n\n<pre><code>class Misty m where\n    banana :: (a -&gt; m b) -&gt; m a -&gt; m b\n    unicorn :: a -&gt; m a\n</code></pre>\n\n<p>I gave in to my curiosity and found the solution to this exercise online as</p>\n\n<pre><code>apple = banana . flip furry'\n</code></pre>\n\n<p>where furry' is a version of liftM implemented as</p>\n\n<pre><code>furry' f mi = banana (\\x -&gt; unicorn (f x)) mi\n</code></pre>\n\n<p>What I don't understand is the use of function composition (.) on two binary functions (namely banana and the flipped furry'), if someone could walk through the evaluation of this I think that would help me a lot.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1431486585, "post_id": 30204950, "comment_id": 48515069, "body": "This is two questions in one... the second one has some simple solutions that I&#39;m sure you&#39;d find enlightening, but the first one, if at all solvable, will most probably involve some large-ish singleton-based framework with lots of type-level programming. Are you sure you don&#39;t want to split your question into two?"}, {"owner": {"reputation": 581, "user_id": 1816555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/44e6a725538adcac07636305f824ed32?s=128&d=identicon&r=PG", "display_name": "Liao Pengyu", "link": "https://stackoverflow.com/users/1816555/liao-pengyu"}, "reply_to_user": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1431487077, "post_id": 30204950, "comment_id": 48515218, "body": "@Cactus I am very interested in the <code>type-level</code> programming, would you please help me split the question, as I am new to haskell and cannot tell the difference between the two?"}], "answers": [{"comments": [{"owner": {"reputation": 581, "user_id": 1816555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/44e6a725538adcac07636305f824ed32?s=128&d=identicon&r=PG", "display_name": "Liao Pengyu", "link": "https://stackoverflow.com/users/1816555/liao-pengyu"}, "edited": false, "score": 0, "creation_date": 1431498240, "post_id": 30205119, "comment_id": 48519002, "body": "Illuminating, but Daniel Wagner&#39;s answer looks more appropriate so I changed the acceptance. Thanks for your answer."}], "tags": [], "owner": {"reputation": 62902, "user_id": 90511, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/nmOPo.png?s=128&g=1", "display_name": "hugomg", "link": "https://stackoverflow.com/users/90511/hugomg"}, "is_accepted": false, "score": 3, "last_activity_date": 1431487533, "creation_date": 1431487533, "answer_id": 30205119, "question_id": 30204950, "link": "https://stackoverflow.com/questions/30204950/is-it-possible-to-define-a-function-that-return-a-n-dimensional-list-in-haskell/30205119#30205119", "title": "Is it possible to define a function that return a n-dimensional list in Haskell", "body": "<p>The biggest problem with <code>makeList</code> is that you can't easily give a type for it. One of the things you can do is use a recursive type instead of lists of lists. Instead of having a sequence of types <code>[a]</code>, <code>[[a]]</code>, <code>[[[a]]]</code>, ..., you have a single type <code>RecList a</code> that represents nested lists with an arbitrary number of levels.</p>\n\n<p>Here is a simplified example using lists of length 1 instead of infinite lists:</p>\n\n<pre><code>data RecList a\n  = Elem a\n  | Dim [RecList a]\n  deriving (Eq, Show)\n\nmakeNested :: Int -&gt; RecList String\nmakeNested n\n    | n == 0 = Elem \"Hi There\"\n    | n &gt; 0  = Dim [(makeList (n - 1))]\n    | n &lt; 0  = undefined\n</code></pre>\n\n<p>Output from ghci:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>Main*&gt; makeList 4\nDim [Dim [Dim [Dim [Elem \"0\"]]]]\n</code></pre>\n\n<p>By using a recursive type like this you make the number of dimensions be a value-level thing instead of a type-level thing. It doesn't have the static safety of the type level or metaprogramming-based solutions but its much easier to implement.</p>\n"}, {"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": false, "score": 4, "last_activity_date": 1431489930, "last_edit_date": 1431489930, "creation_date": 1431489123, "answer_id": 30205359, "question_id": 30204950, "link": "https://stackoverflow.com/questions/30204950/is-it-possible-to-define-a-function-that-return-a-n-dimensional-list-in-haskell/30205359#30205359", "title": "Is it possible to define a function that return a n-dimensional list in Haskell", "body": "<p>You can improve the code in @hugomg's answer by adding a type index to <code>RecList</code> that tracks the <em>number of dimenions</em> in <code>RecList</code>:</p>\n\n<pre><code>{-# LANGUAGE GADTs, DataKinds, KindSignatures, TypeFamilies, StandaloneDeriving #-}\nimport Data.Singletons\nimport Data.Singletons.TH\n\ndata Nat = Z | S Nat\n\ndata RecList (d :: Nat) a where\n    Elem :: a -&gt; RecList Z a\n    Dim :: [RecList d a] -&gt; RecList (S d) a\nderiving instance (Show a) =&gt; Show (RecList d a)\n</code></pre>\n\n<p>This way, you will know that <code>RecList d a</code> has exactly <code>d</code> dimensions.</p>\n\n<p>Here is an example using the <a href=\"https://hackage.haskell.org/package/singletons\" rel=\"nofollow\">Singletons</a> library to reify a type-level index into a term, so we can recurse over it, to make an infinite, <code>d</code>-dimensional grid of <code>()</code>s:</p>\n\n<pre><code>{-# LANGUAGE TemplateHaskell #-}\n\n$(genSingletons [''Nat])\n\nmakeNested :: Sing d -&gt; RecList d ()\nmakeNested SZ = Elem ()\nmakeNested (SS d) = Dim $ repeat (makeNested d)\n</code></pre>\n\n<p>and here's something closer to your example:</p>\n\n<pre><code>makeList :: Sing d -&gt; RecList (S d) Int\nmakeList SZ = Dim $ map Elem [0..]\nmakeList (SS d) = Dim $ repeat $ makeList d\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1431498872, "post_id": 30206970, "comment_id": 48519317, "body": "Very nice and makes me look like an idiot for bringing a gun to a knifefight :)"}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1431498981, "post_id": 30206970, "comment_id": 48519381, "body": "OTOH, mine can be turned into something like this via an existential, whereas this can&#39;t be turned into something that statically knows its number of dimensions... so it&#39;s not so clear-cut."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 2, "creation_date": 1431499820, "post_id": 30206970, "comment_id": 48519806, "body": "@Cactus Indeed, these three answers are just three points in the tradeoff space between convenience and strong static guarantees. Which one is &quot;right&quot; depends a lot on what&#39;s wanted for the given application."}, {"owner": {"reputation": 581, "user_id": 1816555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/44e6a725538adcac07636305f824ed32?s=128&d=identicon&r=PG", "display_name": "Liao Pengyu", "link": "https://stackoverflow.com/users/1816555/liao-pengyu"}, "edited": false, "score": 0, "creation_date": 1431500062, "post_id": 30206970, "comment_id": 48519967, "body": "A question, if I remove the type declaration of makeList, <code>makeList :: Int -&gt; a -&gt; DeepList a</code>, the GHC complain for an error. Why?"}, {"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1431503670, "post_id": 30206970, "comment_id": 48522248, "body": "That&#39;s because if there&#39;s no type signature, type inference assigns a monomorphic type to definitions inside the same mutually recursive group of definitions, and it gets generalized into a polymorphic type only afterward."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 581, "user_id": 1816555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/44e6a725538adcac07636305f824ed32?s=128&d=identicon&r=PG", "display_name": "Liao Pengyu", "link": "https://stackoverflow.com/users/1816555/liao-pengyu"}, "edited": false, "score": 0, "creation_date": 1431504985, "post_id": 30206970, "comment_id": 48523028, "body": "@LiaoPengyu Note that the recursive call has a <i>different type</i> than the top-level call. Nobody really knows how to do type inference in the presence of polymorphic recursion [clarification edit: we in fact know that this problem is undecidable]. So Haskell just punts on that and requires you to annotate the types of things which require it."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 9, "last_activity_date": 1431498433, "last_edit_date": 1431498433, "creation_date": 1431497514, "answer_id": 30206970, "question_id": 30204950, "link": "https://stackoverflow.com/questions/30204950/is-it-possible-to-define-a-function-that-return-a-n-dimensional-list-in-haskell/30206970#30206970", "title": "Is it possible to define a function that return a n-dimensional list in Haskell", "body": "<p>In hugomg's answer, we have</p>\n\n<pre><code>data RecList a\n  = Elem a\n  | Dim [RecList a]\n  deriving (Eq, Show)\n</code></pre>\n\n<p>These do not quite represent n-dimensional lists for some n; in fact, they allow the mixing of lists of different dimensions, as in <code>Dim [Elem 0, Dim [Elem 0]]</code>. In Cactus' answer, we have a more complicated type that fixes this problem by exposing the dimension at the type level and forcing all lists to have that dimension; but it uses some quite complicated extensions.</p>\n\n<p>In this answer, we will give a type which is not inhabited by mixed-dimension lists, but which requires no extensions. The idea is simply to track the dimension by giving more constructors to higher-dimensional lists. So:</p>\n\n<pre><code>data DeepList a = Z a | S (DeepList [a]) deriving Show\n</code></pre>\n\n<p>Each value will be a Peano nat giving the dimension, followed by a list of that dimension. Thus:</p>\n\n<pre><code>Z 0\nS (Z [0])\nS (S (Z [[0]]))\n</code></pre>\n\n<p>are all values. On the other hand, we simply cannot write something like</p>\n\n<pre><code>S (S (Z [\"zero\", [\"zero\"]]))\n</code></pre>\n\n<p>as it is not well-typed!</p>\n\n<p>We can construct values of this type. For purposes of testing, I will use <code>replicate 3</code> instead of <code>repeat</code>, but the idea is the same.</p>\n\n<pre><code>makeList :: Int -&gt; a -&gt; DeepList a\nmakeList 0 v = S (Z (replicate 3 v))\nmakeList n v = S (makeList (n-1) (replicate 3 v))\n</code></pre>\n\n<p>In ghci:</p>\n\n<pre><code>*Main&gt; makeList 2 5\nS (S (S (Z [[[5,5,5],[5,5,5],[5,5,5]],[[5,5,5],[5,5,5],[5,5,5]],[[5,5,5],[5,5,5],[5,5,5]]])))\n</code></pre>\n\n<p>Once we have given a <code>Functor</code> instance for <code>DeepList</code>, it isn't too hard to write your indexed list, either:</p>\n\n<pre><code>instance Functor DeepList where\n    fmap f (Z v) = Z (f v)\n    fmap f (S v) = S (fmap (map f) v)\n\nnD :: Int -&gt; DeepList [Int]\nnD 0 = Z []\nnD n = S (fmap (\\v -&gt; map (:v) [0..]) (nD (n-1)))\n</code></pre>\n\n<p>In ghci:</p>\n\n<pre><code>*Main&gt; putStrLn . take 100 . show $ nD 3\nS (S (S (Z [[[[0,0,0],[1,0,0],[2,0,0],[3,0,0],[4,0,0],[5,0,0],[6,0,0],[7,0,0],[8,0,0],[9,0,0],[10,0,\n*Main&gt; let S (S (S (Z v))) = nD 3\n*Main&gt; putStrLn . take 100 . show . drop 1 $ v\n[[[[0,0,1],[1,0,1],[2,0,1],[3,0,1],[4,0,1],[5,0,1],[6,0,1],[7,0,1],[8,0,1],[9,0,1],[10,0,1],[11,0,1]\n*Main&gt; putStrLn . take 100 . show . map (drop 1) $ v\n[[[[0,1,0],[1,1,0],[2,1,0],[3,1,0],[4,1,0],[5,1,0],[6,1,0],[7,1,0],[8,1,0],[9,1,0],[10,1,0],[11,1,0]\n*Main&gt; putStrLn . take 100 . show . map (map (drop 1)) $ v\n[[[[1,0,0],[2,0,0],[3,0,0],[4,0,0],[5,0,0],[6,0,0],[7,0,0],[8,0,0],[9,0,0],[10,0,0],[11,0,0],[12,0,0\n</code></pre>\n"}], "owner": {"reputation": 581, "user_id": 1816555, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/44e6a725538adcac07636305f824ed32?s=128&d=identicon&r=PG", "display_name": "Liao Pengyu", "link": "https://stackoverflow.com/users/1816555/liao-pengyu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 2, "accepted_answer_id": 30206970, "answer_count": 3, "score": 2, "last_activity_date": 1431498433, "creation_date": 1431486300, "last_edit_date": 1431489865, "question_id": 30204950, "link": "https://stackoverflow.com/questions/30204950/is-it-possible-to-define-a-function-that-return-a-n-dimensional-list-in-haskell", "title": "Is it possible to define a function that return a n-dimensional list in Haskell", "body": "<p>I wanted to do something like:</p>\n\n<pre><code>makeList n\n    | n == 0 = [0 ..]\n    | n &gt; 0  = repeat $ makeList (n - 1)\n    | n &lt; 0  = undefined\n</code></pre>\n\n<p>The code is wrong as its return type is dependent on the value <code>n</code>. \nIs there a way that to implement something like that?</p>\n\n<p>Furthermore, I want to construct a N-dimensional list in which every element contains its index, something like:</p>\n\n<pre><code>oneD = [0 ..]\ntwoD = map (\\x -&gt; map (\\y -&gt; (x, y)) [0 ..]) [0..]\nthreeD = .. -- hard to code\n</code></pre>\n\n<p>Is there an elegant way to construct a high dimensional list?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 1, "last_activity_date": 1431495925, "creation_date": 1431495925, "answer_id": 30206601, "question_id": 30204084, "link": "https://stackoverflow.com/questions/30204084/in-haskell-how-do-you-remove-a-duplicate-list-with-different-order-than-the-orig/30206601#30206601", "title": "In Haskell how do you remove a duplicate list with different order than the original?", "body": "<p>In many cases, a better solution is to avoid generating the duplicates in the first place. For example, here's a naive way of generating the list you have:</p>\n\n<pre><code>listsOfSize 0 xs = [[]]\nlistsOfSize n xs = do\n    first &lt;- xs\n    rest  &lt;- listsOfSize (n-1) xs\n    return (first:rest)\n</code></pre>\n\n<p>I would bet you have this or something very like it in your code base generating the list you suggested you \"have\". It is not too hard to change the way this generates lists to never generate duplicates (provided the input list has no duplicates). The idea is to generate lists that are in \"sorted\" order: once we have chosen an element of the input list, we will refuse to later choose an earlier element of that list. That looks like this:</p>\n\n<pre><code>import Data.List\n\nrisingListsOfSize 0 xs = [[]]\nrisingListsOfSize n xs = do\n    choicesForRest@(first:_) &lt;- tails xs\n    rest &lt;- risingListsOfSize (n-1) choicesForRest\n    return (first:rest)\n</code></pre>\n\n<p>Then we simply do not generate the duplicates:</p>\n\n<pre><code>*Main&gt; risingListsOfSize 3 [1,2]\n[[1,1,1],[1,1,2],[1,2,2],[2,2,2]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "is_accepted": false, "score": 1, "last_activity_date": 1431504868, "creation_date": 1431504868, "answer_id": 30209263, "question_id": 30204084, "link": "https://stackoverflow.com/questions/30204084/in-haskell-how-do-you-remove-a-duplicate-list-with-different-order-than-the-orig/30209263#30209263", "title": "In Haskell how do you remove a duplicate list with different order than the original?", "body": "<p>To obtain only unique elements, first you need to <code>sort</code> each list of your list and then use remove duplicate elements :</p>\n\n<pre><code>import Data.List\nlst = [[1,1,1],[1,1,2],[1,2,1],[1,2,2],[2,1,1],[2,1,2],[2,2,1],[2,2,2]]\n\ngetUniqueLists :: (Ord a) =&gt; [[a]] -&gt; [[a]]\ngetUniqueList xs = nub ( map sort xs)\n</code></pre>\n\n<p>where <code>map sort xs</code> will sort your inner lists</p>\n\n<pre><code>[[1,1,1],[1,1,2],[1,1,2],[1,2,2],[1,1,2],[1,2,2],[1,2,2],[2,2,2]]\n</code></pre>\n\n<p>and <code>nub</code> will remove the duplicate elements:</p>\n\n<pre><code>[[1,1,1],[1,1,2],[1,2,2],[2,2,2]]\n</code></pre>\n\n<p>You can also write this in point free style :</p>\n\n<pre><code>getUniqueList = nub . map sort\n</code></pre>\n"}], "owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 30206601, "answer_count": 2, "score": 0, "last_activity_date": 1431504868, "creation_date": 1431480392, "question_id": 30204084, "link": "https://stackoverflow.com/questions/30204084/in-haskell-how-do-you-remove-a-duplicate-list-with-different-order-than-the-orig", "title": "In Haskell how do you remove a duplicate list with different order than the original?", "body": "<p>I'm trying to find all ways to combine number in a certain group size without any repeats using Haskell. I currently have a list like this:</p>\n\n<pre><code>[[1,1,1],[1,1,2],[1,2,1],[1,2,2],[2,1,1],[2,1,2],[2,2,1],[2,2,2]]\n</code></pre>\n\n<p>[1,1,2] [1,2,1] [2,1,1] are all duplicates of each other even though the order differs. How could I remove the duplicates from the list?</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1431481496, "post_id": 30203965, "comment_id": 48513715, "body": "First of all, the list is not proactively constructed, but using lazy evaluation..."}, {"owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1431481567, "post_id": 30203965, "comment_id": 48513732, "body": "Could you elaborate on that? I understand lazy evaluation at a very basic level but don&#39;t know it&#39;s capabilities yet."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1431481665, "post_id": 30203965, "comment_id": 48513759, "body": "Well the list is not &quot;fully&quot; generated (actually not generated at all). It simply stores the &quot;definition&quot;, when you are interested in the first element, it will calculate the first, and construct a new expression for the remaining part, etc. You can therefore even define lists with infinite length."}, {"owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1431481802, "post_id": 30203965, "comment_id": 48513800, "body": "Ok I think I understand, but does that have any effect on why x remains constant while y increments?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1431505671, "post_id": 30203965, "comment_id": 48523462, "body": "@AR7 Lazy evaluation never has an effect on <i>which</i> value is produced; all evaluation orders that terminate will produce the same value. The magic sauce of lazy evaluation is that if any evaluation order terminates, lazy evaluation does, too. In short: no, lazy evaluation has no effect on why x remains constant while y increments."}], "answers": [{"comments": [{"owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "edited": false, "score": 0, "creation_date": 1431482348, "post_id": 30204341, "comment_id": 48513937, "body": "Thank you for the explanation. I&#39;ve been reading through &quot;Learn You A Haskell&quot; and I haven&#39;t gotten to Monads yet which is probably why I&#39;m confused."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "edited": false, "score": 1, "creation_date": 1431483084, "post_id": 30204341, "comment_id": 48514158, "body": "Well the monad part is a bit hard, but it is important for deep understanding of some functional programming concepts. After reading monads, one starts to understand most of Haskell is syntactical sugar for monadic concepts."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "edited": false, "score": 3, "creation_date": 1431505753, "post_id": 30204341, "comment_id": 48523524, "body": "@AR7 It is not necessary to understand monads in their full generality to understand list comprehensions. The other answer gives the Haskell Report&#39;s actual desugaring translation for list comprehensions (which is more complete than the one suggested in this answer), and mentions monads exactly zero times."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1431525910, "post_id": 30204341, "comment_id": 48538271, "body": "It <i>could</i> be translated like that, but it is not. In fact, in the latest GHC version, it ends up going in precisely the opposite direction! List comprehensions actually desugar in one of two different ways, one of them full of invocations to <code>foldr</code> and <code>build</code>, and one full of recursive functions."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1431525964, "post_id": 30204341, "comment_id": 48538319, "body": "The Haskell Report, on the other hand, explains list comprehensions in terms of <code>concatMap</code>."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 8, "last_activity_date": 1431483139, "last_edit_date": 1431483139, "creation_date": 1431482199, "answer_id": 30204341, "question_id": 30203965, "link": "https://stackoverflow.com/questions/30203965/in-haskell-what-are-the-inner-workings-of-list-comprehension/30204341#30204341", "title": "In Haskell what are the inner workings of list comprehension?", "body": "<p>This <a href=\"http://learnyouahaskell.com/starting-out#im-a-list-comprehension\">introduction</a> explains the <em>syntax</em> of list comprehension. Basically one can say that every <code>x &lt;- list</code> means an additional nested \"for\"-loop to generate tuples and every predicate is simply tested. Thus the expression:</p>\n\n<pre><code>[(x,y) | x &lt;- xs, even x, y &lt;- ys, even 3*y-div x 2]\n</code></pre>\n\n<p>Would be translated in an imperative language as:</p>\n\n<pre><code>for (var x : xs) {\n    if(even(x)) {\n    for(var y : ys) {\n        if(even(3*y-x/2)) {\n            yield (x,y)\n        }\n    }\n}\n</code></pre>\n\n<p><code>yield</code> is a keyword that is sometimes used with co-routines. Furthermore as for <code>yield</code> the evaluation is done lazily. This enables for instance to generate <strong>all</strong> even integers as:</p>\n\n<pre><code>[x|x &lt;-[2..],even x]\n</code></pre>\n\n<h1>List monads</h1>\n\n<p>In order to understand list comprehension fundamentally, one needs to know what <a href=\"http://en.wikibooks.org/wiki/Haskell/Understanding_monads\"><em>Monads</em></a> are. Every list comprehension can be translated into a <em>list monad</em>. For instance your example is translated into:</p>\n\n<pre><code>do x &lt;- xs\n   return\n      (do y &lt;- ys\n          return (x,y))\n</code></pre>\n\n<p>Which is again syntactical sugar for:</p>\n\n<pre><code>xs &gt;&gt;= (\\x -&gt; (ys &gt;&gt;= \\y -&gt; return (x,y)))\n</code></pre>\n\n<p>A monad is an important concept in functional programming (and probably one better reads the wikipedia page), because it is a bit hard to master. The sometimes say a <em>monads are like burritos,...</em>.</p>\n\n<p>Once you more or less understand a monad: a monad is a type-class with a <code>return</code> statement and a <code>&gt;&gt;</code> channeling statement. Now the <code>return</code> statement for the inner part is easy:</p>\n\n<pre><code>return x = [x]\n</code></pre>\n\n<p>So that means that each time <code>x</code> and <code>y</code> are set, you will create a tuple <code>(x,y)</code> and return it as a singleton list: thus <code>[(x,y)]</code>. Now the \"bind\" operator <code>&gt;&gt;=</code> needs to \"glue\" <code>ys</code> and <code>\\y -&gt; return (x,y)</code> together. This is done by implementing it as:</p>\n\n<pre><code>(&gt;&gt;=) xs f = concat $ map f xs\n</code></pre>\n\n<p>In other words you do a mapping and concatenate the result of the mapping.</p>\n\n<p>Now if take the second part of the unsugared expression into account:</p>\n\n<pre><code>ys &gt;&gt;= \\y -&gt; return (x,y)\n</code></pre>\n\n<p>It means that for a given <code>x</code> (we now abstract away), we will map every element in <code>ys</code> to a tuple <code>(x,y)</code> and return it. We will thus generate a list of lists with every list being a singleton containing a tuple. Something like (if <code>ys=[1,2]</code>):</p>\n\n<pre><code>[[(x,1)],[(x,2)]]\n</code></pre>\n\n<p>Now the <code>&gt;&gt;=</code> will furthermore <code>concat</code> it into:</p>\n\n<pre><code>\\x -&gt; [(x,1),(x,2)]\n</code></pre>\n\n<p>Until now, we've abstracted the <code>x</code> away (assumed it was one). But now we can take the first part of that expression:</p>\n\n<pre><code>xs &gt;&gt;= \\x -&gt; [(x,1),(x,2)]\n</code></pre>\n\n<p>If <code>xs=[3,5]</code>, it means we will create again lists:</p>\n\n<pre><code>[[(3,1),(3,2)],[(5,1),(5,2)]]\n</code></pre>\n\n<p>and after the concat:</p>\n\n<pre><code>[(3,1),(3,2),(5,1),(5,2)]\n</code></pre>\n\n<p>Which is what we expect for:</p>\n\n<pre><code>[(x,y)|x&lt;-[3,5],y&lt;-[1,2]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 6, "last_activity_date": 1431504057, "creation_date": 1431504057, "answer_id": 30208987, "question_id": 30203965, "link": "https://stackoverflow.com/questions/30203965/in-haskell-what-are-the-inner-workings-of-list-comprehension/30208987#30208987", "title": "In Haskell what are the inner workings of list comprehension?", "body": "<p>Quoting from the Haskell Report, list comprehensions are evaluated as follows:</p>\n\n<pre><code>[ e | True ]   = [e]\n[ e | q ]      = [ e | q, True ]\n[ e | b,  Q  ] = if b then [ e | Q ] else []\n[ e | p &lt;- l,  Q ] = let ok p = [ e | Q ]\n                         ok _ = []\n                     in concatMap ok  l\n[ e | let decls,  Q ] = let decls in [ e | Q ]\n</code></pre>\n\n<p>In your case, the relevant part is, since the pattern <code>p</code> is just a variable <code>x</code>:</p>\n\n<pre><code>[ e | x &lt;- l, Q ] = concatMap (\\x -&gt; [ e | Q ]) l\n</code></pre>\n\n<p>More concretely, the comprehension <code>[(x,y) | x &lt;- xs, y &lt;- ys]</code> is translated to</p>\n\n<pre><code>concatMap (\\x -&gt; [(x,y) | y &lt;- ys]) xs\n</code></pre>\n\n<p>Which is, by definition of <code>concatMap</code></p>\n\n<pre><code>concat (map (\\x -&gt; [(x,y) | y &lt;- ys]) xs)\n</code></pre>\n\n<p>Let's substitute concrete values for <code>xs</code>,<code>ys</code>:</p>\n\n<pre><code>concat (map (\\x -&gt; [(x,y) | y &lt;- [4,5,6]]) [1,2,3])\n</code></pre>\n\n<p>Applying <code>map</code>:</p>\n\n<pre><code>concat [ [(1,y) | y &lt;- [4,5,6]] \n       , [(2,y) | y &lt;- [4,5,6]] \n       , [(3,y) | y &lt;- [4,5,6]] ]\n</code></pre>\n\n<p>Evaluating the inner list comprehensions: (these could be translated again using the laws above, but I'll make it short)</p>\n\n<pre><code>concat [ [(1,4),(1,5),(1,6)]\n       , [(2,4),(2,5),(2,6)]\n       , [(3,4),(3,5),(3,6)] ]\n</code></pre>\n\n<p>And by concatenating the above lists we obtain the result.</p>\n\n<hr>\n\n<p>Note that GHC also implements as a Haskell extension the so-called <em>parallel list comprehensions</em>, which do operate as you expected:</p>\n\n<pre><code>&gt; :set -XParallelListComp\n&gt; [(x,y)| x&lt;-[1,2,3] | y &lt;-[4,5,6]]\n[(1,4),(2,5),(3,6)]\n</code></pre>\n\n<p>Internally, they use the <code>zip</code> (or rather, <code>zipWith</code>) function.</p>\n"}], "owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 1, "accepted_answer_id": 30204341, "answer_count": 2, "score": 2, "last_activity_date": 1431504057, "creation_date": 1431479354, "last_edit_date": 1495539859, "question_id": 30203965, "link": "https://stackoverflow.com/questions/30203965/in-haskell-what-are-the-inner-workings-of-list-comprehension", "title": "In Haskell what are the inner workings of list comprehension?", "body": "<p>I'm rather new to Haskell and was looking at this post here: <a href=\"https://stackoverflow.com/questions/4119730/cartesian-product\">Cartesian product of 2 lists in Haskell</a>.</p>\n\n<p>In the answer there is this snippet of code:</p>\n\n<pre><code>cartProd xs ys = [(x,y) | x &lt;- xs, y &lt;- ys]\n</code></pre>\n\n<p>Which with these two lists:</p>\n\n<pre><code>xs = [1,2,3]\nys = [4,5,6]\n</code></pre>\n\n<p>would yield</p>\n\n<pre><code>[(1,4),(1,5),(1,6),(2,4),(2,5),(2,6),(3,4),(3,5),(3,6)]\n</code></pre>\n\n<p>Had I not seen this result I would have assumed it would just have returned</p>\n\n<pre><code>[(1,4),(2,5),(3,6)]\n</code></pre>\n\n<p>because it would traverse both lists at the same time.</p>\n\n<p>But now it - to programming languages I know better - looks like a double for loop used to traverse a matrix:</p>\n\n<pre><code>for (int x = 1; x &lt; 4; x++)\n    for(int y = 4; y &lt; 7; y++)\n        //make tuple (x,y)\n</code></pre>\n\n<p>What causes a list comprehension to behave in this manner?</p>\n"}, {"tags": ["haskell", "profiling"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1431560471, "post_id": 30203566, "comment_id": 48557678, "body": "As the <code>TODO</code> comment in the code bennofs quotes should suggest, GHC profiler reports (and pretty much anything the compiler outputs) should always be accompanied by the result of <code>ghc --version</code>."}, {"owner": {"reputation": 2942, "user_id": 129889, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/68971fe7ee8fd814c26391c727c065bb?s=128&d=identicon&r=PG", "display_name": "alltom", "link": "https://stackoverflow.com/users/129889/alltom"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1431571932, "post_id": 30203566, "comment_id": 48560494, "body": "Thanks for the reminder! For posterity, I happen to be running The Glorious Glasgow Haskell Compilation System, version 7.8.1."}], "answers": [{"comments": [{"owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "edited": false, "score": 0, "creation_date": 1431553005, "post_id": 30222071, "comment_id": 48555139, "body": "I love (and totally sympathize with) the <code>TODO</code> comment there :P."}, {"owner": {"reputation": 2942, "user_id": 129889, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/68971fe7ee8fd814c26391c727c065bb?s=128&d=identicon&r=PG", "display_name": "alltom", "link": "https://stackoverflow.com/users/129889/alltom"}, "edited": false, "score": 0, "creation_date": 1431571892, "post_id": 30222071, "comment_id": 48560487, "body": "Corollary: to disambiguate the cost centres, name the values before pattern-matching, like <code>(x:_) = foo where foo = reverse [1..10000000]</code>. Great answer, bennofs, thanks a ton!"}], "tags": [], "owner": {"reputation": 11593, "user_id": 2494803, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/58b4b1d0d8887426a51330a990936ac1?s=128&d=identicon&r=PG", "display_name": "bennofs", "link": "https://stackoverflow.com/users/2494803/bennofs"}, "is_accepted": true, "score": 7, "last_activity_date": 1431539725, "creation_date": 1431539725, "answer_id": 30222071, "question_id": 30203566, "link": "https://stackoverflow.com/questions/30203566/what-does-mean-in-a-prof-report-mean/30222071#30222071", "title": "What does .(...) mean in a .prof report mean?", "body": "<p><em>TL; DR:</em> GHC generates this when you do a pattern match in a let binding, like <code>let (x,y) = c</code>. The cost of evaluating <code>c</code> is tracked by the <code>...</code> cost centre (since there is no unique name to it)`.</p>\n\n<hr>\n\n<p>So how did I find this out?\nA grep for <code>(...)</code> in the GHC source code finds the following (from compiler/deSugar/Coverage.hs):</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>-- TODO: Revisit this\naddTickLHsBind (L pos (pat@(PatBind { pat_lhs = lhs, pat_rhs = rhs }))) = do\n  let name = \"(...)\"\n  (fvs, rhs') &lt;- getFreeVars $ addPathEntry name $ addTickGRHSs False False rhs\n\n   {- ... more code following, but not relevant to this purpose\n   -}\n</code></pre>\n\n<p>That code tells us that it has to do something with pattern bindings.\nSo we can make a small test program to check the behavior:</p>\n\n<pre><code>x :: Int\n(x:_) = reverse [1..1000000000]\n\nmain :: IO ()\nmain = print x\n</code></pre>\n\n<p>Then, we can run this program with profiling enabled. An indeed, GHC generates the following output:</p>\n\n<pre><code>COST CENTRE MODULE                  no.     entries  %time %alloc   %time \n\n%alloc\nMAIN        MAIN                     42           0    0.0    0.0   100.0  100.0\n CAF        Main                     83           0    0.0    0.0   100.0  100.0\n  (...)     Main                     86           1  100.0  100.0   100.0  100.0\n  x         Main                     85           1    0.0    0.0     0.0    0.0\n  main      Main                     84           1    0.0    0.0     0.0    0.0\n</code></pre>\n\n<p>So it turns out the assumption made from the code was correct. All of the time of the program is spent evaluating the <code>reverse [1..1000000000]</code> expression, and it's assigned to the <code>(...)</code> cost centre. </p>\n"}], "owner": {"reputation": 2942, "user_id": 129889, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/68971fe7ee8fd814c26391c727c065bb?s=128&d=identicon&r=PG", "display_name": "alltom", "link": "https://stackoverflow.com/users/129889/alltom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 1, "accepted_answer_id": 30222071, "answer_count": 1, "score": 12, "last_activity_date": 1431572250, "creation_date": 1431476357, "last_edit_date": 1431572250, "question_id": 30203566, "link": "https://stackoverflow.com/questions/30203566/what-does-mean-in-a-prof-report-mean", "title": "What does .(...) mean in a .prof report mean?", "body": "<p>I'm looking for optimization oportunities in my Haskell program by compiling with <code>-prof</code>, but I don't know how to interpret the cost centres that contain ellipses. What are <code>filter.(...)</code> and <code>jankRoulette.select.(...)</code>?</p>\n\n<pre><code>COST CENTRE                MODULE                     %time %alloc\n\nfilter.(...)               Forest                      46.5   22.3\nset-union                  Forest                      22.5    4.1\ncache-lookup               Forest                      16.0    0.1\nremoveMany                 MultiMapSet                  3.7    1.9\ninsertMany                 MultiMapSet                  3.3    1.8\njankRoulette.select.(...)  Forest                       1.4   15.2\n</code></pre>\n\n<p>I generated that with: <code>$ ghc --make -rtsopts -prof -auto-all main.hs &amp;&amp; ./main +RTS -p &amp;&amp; cat main.prof</code></p>\n\n<p>The function <code>filter</code> has a few definitions in a <code>where</code> clause, like this:</p>\n\n<pre><code>filter a b = blahblah where\n    foo = bar\n    bar = baz\n    baz = bing\n</code></pre>\n\n<p>But those all show up as <code>filter.foo</code>, <code>filter.bar</code>, etc.</p>\n\n<p>I thought they might be nested let expressions, but <code>jankRoulette.select</code> doesn't have any. And I've added SCC directives in front of most of them without any of those cost centres rising to the top.</p>\n\n<p>Since most of the time is spent in <code>filter.(...)</code>, I'd like to know what that is. :)</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2838, "user_id": 3614521, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AR81q.png?s=128&g=1", "display_name": "Mephy", "link": "https://stackoverflow.com/users/3614521/mephy"}, "edited": false, "score": 0, "creation_date": 1431474949, "post_id": 30203350, "comment_id": 48512082, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/16878251/high-precision-floating-point-numbers-in-haskell\">High precision floating point numbers in Haskell?</a>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1431613491, "post_id": 30203350, "comment_id": 48581079, "body": "Talking about floating point and &quot;arbitrary precision&quot; is just confusing people here\u2014those are irrelevant."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1431613535, "post_id": 30203403, "comment_id": 48581112, "body": "I would change that to &quot;exact rationals&quot;."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1431614057, "post_id": 30203403, "comment_id": 48581516, "body": "@dfeuer What would be the difference between an exact rational and a not-exact rational?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1431614223, "post_id": 30203403, "comment_id": 48581635, "body": "What is the &quot;precision&quot; of a rational? To a Scheme programmer, the notion of &quot;inexact rational&quot; would actually make perfect sense, and would mean a rational that was approximating something else; that concept does not really exist in Haskell."}], "tags": [], "owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "is_accepted": true, "score": 3, "last_activity_date": 1431484583, "last_edit_date": 1431484583, "creation_date": 1431475229, "answer_id": 30203403, "question_id": 30203350, "link": "https://stackoverflow.com/questions/30203350/haskell-floating-point-operation-precision/30203403#30203403", "title": "Haskell floating point operation precision", "body": "<p>Arbitrary precision rationals are possible to implement in every language (how easy it is depends, of course). In Haskell there is the <a href=\"https://hackage.haskell.org/package/base/docs/Data-Ratio.html\" rel=\"nofollow\"><code>Data.Ratio</code></a> module that gives you arbitrary precision rationals. Note that this isn't the same thing as floating point numbers.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 0, "last_activity_date": 1431613763, "creation_date": 1431613763, "answer_id": 30239941, "question_id": 30203350, "link": "https://stackoverflow.com/questions/30203350/haskell-floating-point-operation-precision/30239941#30239941", "title": "Haskell floating point operation precision", "body": "<pre><code>&gt; import Data.Ratio\n&gt; 95.123^12 :: Rational\n548815620517731830194541899025343415715973535967221869852721 % 1000000000000000000000000000000000000\n</code></pre>\n\n<p>That <code>%</code> is the fraction bar. You can also use it for input:</p>\n\n<pre><code>&gt; (4%5)^12\n16777216 % 244140625\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 2886632, "user_type": "registered", "accept_rate": 90, "profile_image": "https://graph.facebook.com/1741635647/picture?type=large", "display_name": "Lukas Klizas", "link": "https://stackoverflow.com/users/2886632/lukas-klizas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "accepted_answer_id": 30203403, "answer_count": 2, "score": 0, "last_activity_date": 1431613763, "creation_date": 1431474801, "question_id": 30203350, "link": "https://stackoverflow.com/questions/30203350/haskell-floating-point-operation-precision", "title": "Haskell floating point operation precision", "body": "<p>I have to make software to solve this problem:\n<a href=\"http://uva.onlinejudge.org/index.php?option=com_onlinejudge&amp;Itemid=8&amp;page=show_problem&amp;problem=689\" rel=\"nofollow\">http://uva.onlinejudge.org/index.php?option=com_onlinejudge&amp;Itemid=8&amp;page=show_problem&amp;problem=689</a></p>\n\n<p>Basically, I need to calculate powers of rational numbers, for example 95.123^12 with arbitrary precision.</p>\n\n<p>Is it possible to achieve it with haskell?</p>\n"}, {"tags": ["python", "ruby", "haskell", "floating-point", "erlang"], "comments": [{"owner": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "edited": false, "score": 13, "creation_date": 1431466750, "post_id": 30201855, "comment_id": 48509342, "body": "Why would you expect differences? They&#39;re all implementing <a href=\"http://en.wikipedia.org/wiki/IEEE_floating_point\" rel=\"nofollow noreferrer\">IEEE 754</a> on the same hardware."}, {"owner": {"reputation": 44359, "user_id": 2363712, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/beAJU.jpg?s=128&g=1", "display_name": "Sylvain Leroux", "link": "https://stackoverflow.com/users/2363712/sylvain-leroux"}, "reply_to_user": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "edited": false, "score": 2, "creation_date": 1431466884, "post_id": 30201855, "comment_id": 48509405, "body": "@jonrsharpe You should very probably post that as an answer !"}, {"owner": {"reputation": 2049, "user_id": 324098, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5ddb089dbe33b4f8e0d04e7f87155e0b?s=128&d=identicon&r=PG", "display_name": "CodeGroover", "link": "https://stackoverflow.com/users/324098/codegroover"}, "edited": false, "score": 0, "creation_date": 1431466912, "post_id": 30201855, "comment_id": 48509418, "body": "Nice, i didn&#39;t know that. Please post it."}, {"owner": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 2, "creation_date": 1431467140, "post_id": 30201855, "comment_id": 48509525, "body": "Why is this labelled &quot;pi&quot;?"}, {"owner": {"reputation": 98400, "user_id": 3001761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/feZwC.jpg?s=128&g=1", "display_name": "jonrsharpe", "link": "https://stackoverflow.com/users/3001761/jonrsharpe"}, "edited": false, "score": 1, "creation_date": 1431467228, "post_id": 30201855, "comment_id": 48509561, "body": "Related: <a href=\"http://stackoverflow.com/q/14631761/3001761\">stackoverflow.com/q/14631761/3001761</a>"}, {"owner": {"reputation": 2049, "user_id": 324098, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5ddb089dbe33b4f8e0d04e7f87155e0b?s=128&d=identicon&r=PG", "display_name": "CodeGroover", "link": "https://stackoverflow.com/users/324098/codegroover"}, "reply_to_user": {"reputation": 73209, "user_id": 290394, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/d7908f05c89e965f6bc5308ad6f41256?s=128&d=identicon&r=PG", "display_name": "steenslag", "link": "https://stackoverflow.com/users/290394/steenslag"}, "edited": false, "score": 0, "creation_date": 1431467294, "post_id": 30201855, "comment_id": 48509596, "body": "@steenslag i didn&#39;t know how to ask in general, but question is clear."}, {"owner": {"reputation": 10492, "user_id": 1351298, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/KJKqs.jpg?s=128&g=1", "display_name": "Electric Coffee", "link": "https://stackoverflow.com/users/1351298/electric-coffee"}, "edited": false, "score": 1, "creation_date": 1431469122, "post_id": 30201855, "comment_id": 48510331, "body": "22/7 isn&#39;t pi though, it&#39;s wrong after the 2nd decimal place"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1431470781, "post_id": 30201855, "comment_id": 48510908, "body": "Yes, please don&#39;t use 22/7 for pi. In Haskell, just write <code>pi</code>, which gives <code>3.141592653589793</code>."}, {"owner": {"reputation": 35276, "user_id": 182590, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/134ea397777886d6f0aa992672a50eaa?s=128&d=identicon&r=PG", "display_name": "Mark Thomas", "link": "https://stackoverflow.com/users/182590/mark-thomas"}, "edited": false, "score": 0, "creation_date": 1431472329, "post_id": 30201855, "comment_id": 48511357, "body": "Agreed. Most languages have a constant defined already. In Ruby, it is <code>Math::PI</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1431472908, "post_id": 30201855, "comment_id": 48511511, "body": "use 355/113, if you must. it&#39;s good for 6 places."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1440199303, "post_id": 30201855, "comment_id": 52190392, "body": "@WillNess, there are some great approximations from Ramanujen and such that will go much further pretty quickly."}], "answers": [{"comments": [{"owner": {"reputation": 8425, "user_id": 1396822, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f2e818842b0436e98b279af7f69997cb?s=128&d=identicon&r=PG", "display_name": "aka.nice", "link": "https://stackoverflow.com/users/1396822/aka-nice"}, "edited": false, "score": 3, "creation_date": 1431499401, "post_id": 30202144, "comment_id": 48519580, "body": "Not only because they share the same representation which is exactly 3.142857142857142793701541449991054832935333251953125, but also because they share the same way of printing the shortest decimal representation that would be correctly rounded to the same floating point."}], "tags": [], "owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "is_accepted": true, "score": 16, "last_activity_date": 1431467886, "creation_date": 1431467886, "answer_id": 30202144, "question_id": 30201855, "link": "https://stackoverflow.com/questions/30201855/why-are-the-programming-languages-limits-precision-of-22-7-equally/30202144#30202144", "title": "Why are the programming languages limits precision of 22/7 equally?", "body": "<p>This happens because all the languages are using the same numerical representation for non-integer numbers: <a href=\"http://en.wikipedia.org/wiki/IEEE_floating_point\">IEEE 754 floating point numbers</a> with, most likely, the same level of precision. (Either 32-bit \"floats\" or 64-bit \"doubles\", depending on how your system and languages are configured.)</p>\n\n<p>Floating point numbers are the default choice for this sort of operation, in large part because they're supported directly in hardware. However, fundamentally, nothing stops languages from supporting other kinds of numbers as well. This is easiest to demonstrate in Haskell, which has rational numbers in its standard library:</p>\n\n<pre><code>\u03bb&gt; 22/7 :: Rational\n22 % 7\n</code></pre>\n\n<p>A rational number is a fraction, so it's stored as a pair of integers and you don't lose any precision when dividing. At the same time, some operations are more difficult and less efficient than with normal floating point numbers.</p>\n\n<p>Another possible representation are <a href=\"http://en.wikipedia.org/wiki/Fixed-point_arithmetic\">fixed-point numbers</a> which have a smaller range than floating point numbers but do a better job of maintaining precision <em>within</em> that range. (I'm really handwaving a lot of details here.) You can try these out in Haskell too:</p>\n\n<pre><code>\u03bb&gt; import Data.Fixed\n\u03bb&gt; 22/7 :: Deci\n3.1\n\u03bb&gt; 22/7 :: Centi\n3.14\n\u03bb&gt; 22/7 :: Micro\n3.142857\n</code></pre>\n"}], "owner": {"reputation": 2049, "user_id": 324098, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5ddb089dbe33b4f8e0d04e7f87155e0b?s=128&d=identicon&r=PG", "display_name": "CodeGroover", "link": "https://stackoverflow.com/users/324098/codegroover"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 0, "accepted_answer_id": 30202144, "answer_count": 1, "score": 4, "last_activity_date": 1440189016, "creation_date": 1431466617, "last_edit_date": 1440189016, "question_id": 30201855, "link": "https://stackoverflow.com/questions/30201855/why-are-the-programming-languages-limits-precision-of-22-7-equally", "title": "Why are the programming languages limits precision of 22/7 equally?", "body": "<p>I tried</p>\n\n<pre><code>Erlang\n$ erl\n1&gt; Pi = 22/7.\n3.142857142857143\n\nHaskell\n$ ghci \nPrelude&gt; 22/7\n3.142857142857143\n\nPython\n$ python\n&gt;&gt;&gt; 22/7.0\n3.142857142857143\n\nRuby \n$ irb\n2.1.6 :001 &gt; 22 / 7.0\n =&gt; 3.142857142857143\n</code></pre>\n\n<p>The results are the same. Why?</p>\n"}, {"tags": ["linux", "haskell", "raspberry-pi"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1431465350, "post_id": 30201508, "comment_id": 48508658, "body": "run <code>cabal install base-io-access</code>, see if that works.  I&#39;m responsible for that (tiny, unfinished, don&#39;t use this in real code) package, but it only depends on <code>base</code> and doesn&#39;t do any FFI or anything like that.  It&#39;s about as simple a package as you could ask for.  If it doesn&#39;t compile then it&#39;ll tell you that something is really borked, if it does compile then it&#39;s package dependent."}, {"owner": {"reputation": 13699, "user_id": 11173, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6b5276e65cb7a7417188c9a035953cee?s=128&d=identicon&r=PG", "display_name": "Doug McClean", "link": "https://stackoverflow.com/users/11173/doug-mcclean"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1431466274, "post_id": 30201508, "comment_id": 48509133, "body": "Thanks @bheklilr, That&#39;s a test I ran with my own similar package <code>exact-pi</code> that only depends on base. I just tried yours and got the same thing. (Basically, different temp file name, but even the same line numbers and character positions.)"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1431466343, "post_id": 30201508, "comment_id": 48509168, "body": "In that case I have no idea.  My initial guess was trying to link to some C code or something.  Maybe you need some extra flags to GHC to get it to compile right?  I&#39;ve never tried installing GHC on my RPi so I have no experience here"}, {"owner": {"reputation": 13699, "user_id": 11173, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6b5276e65cb7a7417188c9a035953cee?s=128&d=identicon&r=PG", "display_name": "Doug McClean", "link": "https://stackoverflow.com/users/11173/doug-mcclean"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1431534472, "post_id": 30201508, "comment_id": 48544783, "body": "Yeah, I&#39;m out of guesses too. It&#39;s weird, because others seem to have gotten it working, so it&#39;s probably something simpler than it seems."}], "answers": [{"comments": [{"owner": {"reputation": 1657, "user_id": 4183787, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XedpJ.png?s=128&g=1", "display_name": "zigazou", "link": "https://stackoverflow.com/users/4183787/zigazou"}, "edited": false, "score": 1, "creation_date": 1468379185, "post_id": 30247459, "comment_id": 64097995, "body": "I had the same problem with ghc 7.10 on Raspberry Pi 3. I had to use <code>--ghc-options=-opta-march=armv7-a</code> with cabal"}, {"owner": {"reputation": 833, "user_id": 1007926, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/dc0133e5980f0289b82d223562ec0a49?s=128&d=identicon&r=PG", "display_name": "Peter Becich", "link": "https://stackoverflow.com/users/1007926/peter-becich"}, "edited": false, "score": 0, "creation_date": 1556435083, "post_id": 30247459, "comment_id": 98433082, "body": "For Stack, I found these useful: <a href=\"https://gist.github.com/blender/7c4c6e7224e622ee078e5b3320ac951d\" rel=\"nofollow noreferrer\">gist.github.com/blender/7c4c6e7224e622ee078e5b3320ac951d</a> <a href=\"https://allocinit.io/haskell/haskell-on-raspberry-pi-3/#installing-stack\" rel=\"nofollow noreferrer\">allocinit.io/haskell/haskell-on-raspberry-pi-3/&hellip;</a> <a href=\"https://github.com/commercialhaskell/stack/issues/2708\" rel=\"nofollow noreferrer\">github.com/commercialhaskell/stack/issues/2708</a>"}], "tags": [], "owner": {"reputation": 13699, "user_id": 11173, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6b5276e65cb7a7417188c9a035953cee?s=128&d=identicon&r=PG", "display_name": "Doug McClean", "link": "https://stackoverflow.com/users/11173/doug-mcclean"}, "is_accepted": true, "score": 6, "last_activity_date": 1432149425, "last_edit_date": 1432149425, "creation_date": 1431638115, "answer_id": 30247459, "question_id": 30201508, "link": "https://stackoverflow.com/questions/30201508/why-cant-i-install-any-packages-with-ghc-7-8-4-on-raspberry-pi/30247459#30247459", "title": "Why can&#39;t I install any packages with GHC 7.8.4 on Raspberry Pi?", "body": "<p>It needs <code>--ghc-options=-opta-march=armv7a</code> as an option every time you want to build something with GHC or <code>cabal install</code> something. With this, it works!</p>\n\n<p><strong>Update</strong></p>\n\n<p>If instead you do <code>--ghc-options=\"-opta-mcpu=cortex-a7 -opta-mfpu=neon -opta-mtune=native -opta-mfloat-abi=hard</code>, floating point will work too. I arrived at this by guessing-and-checking and reading old forum posts, so its possible that these too are not the best settings.</p>\n\n<p>Cabal also has a user configuration file where you can store this setting and have it applied whenever GHC is invoked.</p>\n"}], "owner": {"reputation": 13699, "user_id": 11173, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/6b5276e65cb7a7417188c9a035953cee?s=128&d=identicon&r=PG", "display_name": "Doug McClean", "link": "https://stackoverflow.com/users/11173/doug-mcclean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 627, "favorite_count": 1, "accepted_answer_id": 30247459, "answer_count": 1, "score": 7, "last_activity_date": 1432149425, "creation_date": 1431465128, "question_id": 30201508, "link": "https://stackoverflow.com/questions/30201508/why-cant-i-install-any-packages-with-ghc-7-8-4-on-raspberry-pi", "title": "Why can&#39;t I install any packages with GHC 7.8.4 on Raspberry Pi?", "body": "<p>According to <a href=\"http://www.reddit.com/r/haskell/comments/35bw0b/at_last_debian_unstable_has_working_arm_ghci_and/\">this post</a> there is finally a debian package for a version of GHC that supports template haskell and ghci.</p>\n\n<p>And this is true, I started from a fresh copy of Raspbian, I changed my <code>/etc/apt/sources.list</code> file to:</p>\n\n<pre><code>deb http://http.debian.net/debian sid main contrib non-free\n# Uncomment line below then 'apt-get update' to enable 'apt-get source'\n#deb-src http://archive.raspbian.org/raspbian/ wheezy main contrib non-free rpi\n</code></pre>\n\n<p>I did <code>sudo apt-get update &amp;&amp; sudo apt-get upgrade</code>, and then I did <code>sudo apt-get install ghc</code> and <code>sudo apt-get install cabal-install</code>.</p>\n\n<p><code>ghc --version</code> reports 7.8.4. GHCi works just fine, and so does TH.</p>\n\n<p>But for some reason I can't install any packages with cabal. No matter which one I pick, I get some version of this error:</p>\n\n<pre><code>login as: pi\npi@192.168.1.5's password: \nLinux raspberrypi 3.18.11-v7+ #781 SMP PREEMPT Tue Apr 21 18:07:59 BST 2015 armv7l\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nLast login: Mon May 11 17:17:22 2015\n\n$ ghc --version\nThe Glorious Glasgow Haskell Compilation System, version 7.8.4\n$ mkdir test\n$ cd test\n$ cabal sandbox init\nWriting a default package environment file to\n/home/pi/test/cabal.sandbox.config\nCreating a new sandbox at /home/pi/test/.cabal-sandbox\n$ cabal install array\nResolving dependencies...\nNotice: installing into a sandbox located at /home/pi/test/.cabal-sandbox\nDownloading array-0.5.1.0...\nConfiguring array-0.5.1.0...\nFailed to install array-0.5.1.0\nBuild log ( /home/pi/test/.cabal-sandbox/logs/array-0.5.1.0.log ):\ncabal: Error: some packages failed to install:\narray-0.5.1.0 failed during the configure step. The exception was:\nuser error ('/usr/bin/ghc' exited with an error:\n/tmp/ghc2287_0/ghc2287_6.s: Assembler messages:\n\n/tmp/ghc2287_0/ghc2287_6.s:76:0:\nError: selected processor does not support ARM mode `movw\nr7,:lower16:stg_bh_upd_frame_info'\n\n/tmp/ghc2287_0/ghc2287_6.s:77:0:\nError: selected processor does not support ARM mode `movt\nr7,:upper16:stg_bh_upd_frame_info'\n\n/tmp/ghc2287_0/ghc2287_6.s:80:0:\nError: selected processor does not support ARM mode `movw\nr7,:lower16:base_GHCziTopHandler_runMainIO_closure'\n\n/tmp/ghc2287_0/ghc2287_6.s:81:0:\nError: selected processor does not support ARM mode `movt\nr7,:upper16:base_GHCziTopHandler_runMainIO_closure'\n\n/tmp/ghc2287_0/ghc2287_6.s:82:0:\nError: selected processor does not support ARM mode `movw\nr8,:lower16:Cabalzm1zi22zi1zi1_DistributionziSimple_defaultMain_closure'\n\n/tmp/ghc2287_0/ghc2287_6.s:83:0:\nError: selected processor does not support ARM mode `movt\nr8,:upper16:Cabalzm1zi22zi1zi1_DistributionziSimple_defaultMain_closure'\n)\n</code></pre>\n\n<p>Does anyone know where I went off the rails?</p>\n\n<p><strong>Update</strong></p>\n\n<pre><code>$ cabal --version\ncabal-install version 1.22.0.1\nusing version 1.22.1.1 of the Cabal library\n</code></pre>\n"}, {"tags": ["haskell", "haste"], "answers": [{"tags": [], "owner": {"reputation": 4630, "user_id": 160386, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b6044f355342bb055fbb03804d9673e3?s=128&d=identicon&r=PG", "display_name": "Jan Tojnar", "link": "https://stackoverflow.com/users/160386/jan-tojnar"}, "is_accepted": true, "score": 3, "last_activity_date": 1431464664, "creation_date": 1431464664, "answer_id": 30201368, "question_id": 30199877, "link": "https://stackoverflow.com/questions/30199877/different-server-and-client-dependencies-with-haste/30201368#30201368", "title": "Different server and client dependencies with haste", "body": "<p><a href=\"https://www.haskell.org/cabal/users-guide/developing-packages.html#conditional-compilation\" rel=\"nofollow\">Preprocessor</a> can be used for this purpose. Haste defines <code>__HASTE__</code> macro so it should be enough to wrap your code in conditional statement:</p>\n\n<pre><code>{-# LANGUAGE CPP #-}\n\nmain = do\n#ifdef __HASTE__\n    print \"haste!\"\n#endif\n\n#ifndef __HASTE__\n    print \"not haste!\"\n#endif\n\n    print \"everybody\"\n</code></pre>\n\n<p>Don\u2019t forget to enable C preprocessor extension using <code>{-# LANGUAGE CPP #-}</code> pragma.</p>\n\n<p>You can also achieve similar effect in your \u2018.cabal\u2019 file:</p>\n\n<pre><code>Build-Depends:\n    bytestring &gt;= 0.9.2.1\nif flag(haste-inst)\n    Build-Depends:\n        base == 4.6.0.1,\n        array == 0.4.0.1\nelse\n    Build-Depends:\n        base,\n        array,\n        random,\n        websockets &gt;= 0.8\n</code></pre>\n\n<p>(source <a href=\"https://github.com/valderman/haste-compiler/blob/0.4/libraries/haste-lib/haste-lib.cabal#L63\" rel=\"nofollow\">https://github.com/valderman/haste-compiler/blob/0.4/libraries/haste-lib/haste-lib.cabal#L63</a>)</p>\n\n<p>Note that the <code>haste-inst</code> flag has been renamed to <code>haste-cabal</code> in the latest development version of Haste.</p>\n"}, {"comments": [{"owner": {"reputation": 1518, "user_id": 439034, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/25bcd10eae437d11365ec0fb5483d354?s=128&d=identicon&r=PG", "display_name": "worldsayshi", "link": "https://stackoverflow.com/users/439034/worldsayshi"}, "edited": false, "score": 0, "creation_date": 1431858021, "post_id": 30209312, "comment_id": 48669166, "body": "This is probably possible as an alternative. I can&#39;t currently imagine a scenario where it is preferable to the one I accepted though."}], "tags": [], "owner": {"reputation": 1518, "user_id": 439034, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/25bcd10eae437d11365ec0fb5483d354?s=128&d=identicon&r=PG", "display_name": "worldsayshi", "link": "https://stackoverflow.com/users/439034/worldsayshi"}, "is_accepted": false, "score": 0, "last_activity_date": 1431505030, "creation_date": 1431505030, "answer_id": 30209312, "question_id": 30199877, "link": "https://stackoverflow.com/questions/30199877/different-server-and-client-dependencies-with-haste/30209312#30209312", "title": "Different server and client dependencies with haste", "body": "<p>A potential solution I've thought about is to import a \"Shared\" module with to different implementations, one <code>client/Shared.hs</code> and one <code>server/Shared.hs</code> and then include one of the implementations using the <code>-i</code> option. So <code>-iclient</code> for haste and <code>-iserver</code> for ghc.</p>\n\n<p>I can't test this at the moment though so I'll have to get back to it.</p>\n"}], "owner": {"reputation": 1518, "user_id": 439034, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/25bcd10eae437d11365ec0fb5483d354?s=128&d=identicon&r=PG", "display_name": "worldsayshi", "link": "https://stackoverflow.com/users/439034/worldsayshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 30201368, "answer_count": 2, "score": 1, "last_activity_date": 1431505030, "creation_date": 1431459104, "last_edit_date": 1495539877, "question_id": 30199877, "link": "https://stackoverflow.com/questions/30199877/different-server-and-client-dependencies-with-haste", "title": "Different server and client dependencies with haste", "body": "<p>I'm building a small haste project where I want to use Elasticsearch. However, <a href=\"https://hackage.haskell.org/package/bloodhound\" rel=\"nofollow noreferrer\">bloodhound</a> which seems like the library to go for for elasticsearch in haskell depends indirectly on <a href=\"https://stackoverflow.com/a/29839610/439034\">template-haskell - which isn't supported by haste</a>. Now, I don't need to call elastic from the client, so I don't <em>need</em> bloodhound in haste, but I need to be able to call it from within the same code base as haste is built to use the same code for server and client side. I guess I somehow could have separate client and server side implementations but I really like the haste way. </p>\n\n<p>How can I have calls to dependencies that only exist on the server side in haste?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 2, "creation_date": 1431446652, "post_id": 30195775, "comment_id": 48497306, "body": "You can simplify <code>prependToAll</code> as <code>prependToAll x = (x :) . intersperse x</code>, which is also pretty simple."}, {"owner": {"reputation": 1069, "user_id": 2153280, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zkQvQ.jpg?s=128&g=1", "display_name": "Alberto Capitani", "link": "https://stackoverflow.com/users/2153280/alberto-capitani"}, "reply_to_user": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 0, "creation_date": 1431447798, "post_id": 30195775, "comment_id": 48498097, "body": "@AntalS-Z: from Data.Library: intersperse sep (x:xs)  = x : prependToAll sep xs Hence: prependToAll&#39; sep (x:xs) = sep : x : prependToAll sep xs. It seems to me a little redundant."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "edited": false, "score": 1, "creation_date": 1431447882, "post_id": 30195775, "comment_id": 48498147, "body": "@AntalS-Z I&#39;m not so sure. I would bet <code>prependToAll x [] = []</code>."}, {"owner": {"reputation": 34864, "user_id": 237428, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ThNhZ.jpg?s=128&g=1", "display_name": "Antal Spector-Zabusky", "link": "https://stackoverflow.com/users/237428/antal-spector-zabusky"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1431447999, "post_id": 30195775, "comment_id": 48498220, "body": "@DanielWagner: Oops, you&#39;re right."}, {"owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "edited": false, "score": 0, "creation_date": 1431465447, "post_id": 30195775, "comment_id": 48508709, "body": "You can <i>correctly</i> simplify it as <code>prependToAll = (=&lt;&lt;) . (. return) . (:)</code>. :-D"}, {"owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "edited": false, "score": 0, "creation_date": 1431467136, "post_id": 30195775, "comment_id": 48509523, "body": "Or I suppose <code>prependToAll = (=&lt;&lt;) . (. (: [])) . (:)</code> is shorter and has the distinct advantage of having no letters."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1431469659, "post_id": 30195775, "comment_id": 48510510, "body": "The premise of your question is not quite right, since intersperse produces just <code>[x1, sep, x2, sep, .. xn]</code> with no leading or trailing <code>sep</code>. Maybe that by itself clarifies the issue."}, {"owner": {"reputation": 1069, "user_id": 2153280, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zkQvQ.jpg?s=128&g=1", "display_name": "Alberto Capitani", "link": "https://stackoverflow.com/users/2153280/alberto-capitani"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1431530594, "post_id": 30195775, "comment_id": 48542116, "body": "@ReidBarton Fixed the example. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 1069, "user_id": 2153280, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zkQvQ.jpg?s=128&g=1", "display_name": "Alberto Capitani", "link": "https://stackoverflow.com/users/2153280/alberto-capitani"}, "edited": false, "score": 0, "creation_date": 1431447075, "post_id": 30196061, "comment_id": 48497605, "body": "So, if I need a list separator in the first place I have to reimplement prependToAll, exactly as it is in Data.List library, or is there a better alternative?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 1069, "user_id": 2153280, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zkQvQ.jpg?s=128&g=1", "display_name": "Alberto Capitani", "link": "https://stackoverflow.com/users/2153280/alberto-capitani"}, "edited": false, "score": 4, "creation_date": 1431447800, "post_id": 30196061, "comment_id": 48498099, "body": "@AlbertoCapitani If you can make a solid case for exposing <code>prependToAll</code>, feel free to do so. The <a href=\"https://wiki.haskell.org/Library_submissions\" rel=\"nofollow noreferrer\">wiki page</a> has some guidelines for writing a good proposal to the libraries mailing list (see especially the &quot;Guide to proposers&quot; section). Fair warning: &quot;because it would be convenient for me at this moment&quot; is probably not sufficient justification."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1431460920, "post_id": 30196061, "comment_id": 48506298, "body": "I wonder if that comment is still true with newer GHCs. It&#39;s hard to imagine why a <i>closed</i> local worker function would be any slower than its top-level equivalent."}], "tags": [], "owner": {"reputation": 1190, "user_id": 1560890, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DnL9W.jpg?s=128&g=1", "display_name": "kaz", "link": "https://stackoverflow.com/users/1560890/kaz"}, "is_accepted": false, "score": 7, "last_activity_date": 1431456873, "last_edit_date": 1431456873, "creation_date": 1431446550, "answer_id": 30196061, "question_id": 30195775, "link": "https://stackoverflow.com/questions/30195775/intersperse-and-the-hidden-function-prependtoall/30196061#30196061", "title": "Intersperse and the hidden function prependToAll", "body": "<p>From <a href=\"http://hackage.haskell.org/package/base-4.6.0.1/docs/src/Data-List.html#prependToAll\" rel=\"nofollow\">the comment on <code>prependToAll</code> in the <code>Data.List</code> source code</a>:</p>\n\n<pre><code> ...\n -- Not exported:\n -- We want to make every element in the 'intersperse'd list available\n -- as soon as possible to avoid space leaks. Experiments suggested that\n -- a separate top-level helper is more efficient than a local worker.\n ...\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1431469813, "post_id": 30199318, "comment_id": 48510554, "body": "Does that require explanation? The purpose of <code>prependToAll</code> is as an auxiliary definition for <code>intersperse</code>, which is more commonly useful and less trivial. One doesn&#39;t normally export such auxiliary definitions &quot;by default&quot;."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1431497720, "post_id": 30199318, "comment_id": 48518794, "body": "Then why isn&#39;t it defined in a <code>where</code> clause after <code>intersperse</code>?"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1431524236, "post_id": 30199318, "comment_id": 48536860, "body": "That particular question is addressed by kaz&#39;s answer."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1431534711, "post_id": 30199318, "comment_id": 48544944, "body": "Not really. If <code>prependToAll</code> was more non-trivial and easier to name clearly, then it might have been worth exporting on its own merits. There&#39;s lots of ways to slice up this question."}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": false, "score": 0, "last_activity_date": 1431457094, "creation_date": 1431457094, "answer_id": 30199318, "question_id": 30195775, "link": "https://stackoverflow.com/questions/30195775/intersperse-and-the-hidden-function-prependtoall/30199318#30199318", "title": "Intersperse and the hidden function prependToAll", "body": "<p><code>prependToAll</code> is not such a clear name. I would have guessed that </p>\n\n<pre><code>prependToAll x = map (x :)\n</code></pre>\n\n<p>so that <code>prependToAll :: a -&gt; [[a]] -&gt; [[a]]</code>.</p>\n\n<p>It's easier to just write the function you want inline as a <code>concatMap</code> or a <code>foldr</code> than it is to come up with a good name for it.</p>\n"}], "owner": {"reputation": 1069, "user_id": 2153280, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/zkQvQ.jpg?s=128&g=1", "display_name": "Alberto Capitani", "link": "https://stackoverflow.com/users/2153280/alberto-capitani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 191, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1431530406, "creation_date": 1431445753, "last_edit_date": 1431530406, "question_id": 30195775, "link": "https://stackoverflow.com/questions/30195775/intersperse-and-the-hidden-function-prependtoall", "title": "Intersperse and the hidden function prependToAll", "body": "<p>There are two possibilities to intersperse a separator in a list:</p>\n\n<ul>\n<li><p><code>[x1, sep, x2, sep, .. xn]</code></p></li>\n<li><p><code>[sep, x1, sep, x2, .. sep, xn]</code></p></li>\n</ul>\n\n<p>Using the function \"intersperse\" in Data.List:</p>\n\n<pre><code>\u03bb&gt; intersperse 0 [1..5]\n[1,0,2,0,3,0,4,0,5] \n\u03bb&gt; 0 : intersperse 0 [1..5]\n[0,1,0,2,0,3,0,4,0,5]\n</code></pre>\n\n<p>However the second case can be simplified using the hidden (not exported) function \"prependToAll\":</p>\n\n<pre><code>\u03bb&gt; prependToAll 0 [1..5]\n[0,1,0,2,0,3,0,4,0,5]\n</code></pre>\n\n<p>Why, in Data.List library, <strong>intersperse</strong> is exported whereas the dual <strong>prependToAll</strong> is not?</p>\n"}, {"tags": ["algorithm", "haskell", "breadth-first-search"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 1, "creation_date": 1431441316, "post_id": 30193329, "comment_id": 48493036, "body": "You could probably use one of the many existing graph libraries. You need to take a list of words and produce the graph corresponding to the &quot;connections&quot; between those words. Your BFS algorithm (or the one from the library you use) then doesn&#39;t care about &quot;how&quot; you got your connections - its just a graph."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1431441335, "post_id": 30193329, "comment_id": 48493049, "body": "You don&#39;t provide any information about what the functions are doing..."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1431447457, "post_id": 30193329, "comment_id": 48497872, "body": "StackOverflow is not a code-writing service."}, {"owner": {"reputation": 79, "user_id": 3395417, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/12f40b2a5f12c5fbfbec839b477203a7?s=128&d=identicon&r=PG&f=1", "display_name": "IvanSorokin", "link": "https://stackoverflow.com/users/3395417/ivansorokin"}, "edited": false, "score": 0, "creation_date": 1431451348, "post_id": 30193329, "comment_id": 48500445, "body": "I just want to find some clues"}, {"owner": {"reputation": 79, "user_id": 3395417, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/12f40b2a5f12c5fbfbec839b477203a7?s=128&d=identicon&r=PG&f=1", "display_name": "IvanSorokin", "link": "https://stackoverflow.com/users/3395417/ivansorokin"}, "edited": false, "score": 0, "creation_date": 1431452005, "post_id": 30193329, "comment_id": 48500860, "body": "Some useful libraries or something like that."}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 3395417, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/12f40b2a5f12c5fbfbec839b477203a7?s=128&d=identicon&r=PG&f=1", "display_name": "IvanSorokin", "link": "https://stackoverflow.com/users/3395417/ivansorokin"}, "edited": false, "score": 0, "creation_date": 1431453249, "post_id": 30198032, "comment_id": 48501664, "body": "Thank you very much! I will try to use it and improve my program."}], "tags": [], "owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "is_accepted": true, "score": 2, "last_activity_date": 1431452899, "creation_date": 1431452899, "answer_id": 30198032, "question_id": 30193329, "link": "https://stackoverflow.com/questions/30193329/how-to-write-haskell-bfs-algorithm-for-the-list-of-strings/30198032#30198032", "title": "How to write Haskell BFS algorithm for the list of strings", "body": "<p>So BFS is a common problem in early programming, and while its solution is not particular to Haskell, the functional nature of Haskell makes things a little trickier. So let's start with DFS:</p>\n\n<pre><code>import Control.Monad (msum)\n\ndfs target tree@(Tree value children)\n  | value == target = Just tree\n  | otherwise       = msum $ map (dfs target) children\n</code></pre>\n\n<p>This is simple because we can recurse directly on each of the children in order (<code>map</code>) and then take the first success (<code>msum</code>). But when we do BFS we need to also thread a \"context\" through, and this means that we'll have to replace <code>map</code> with our own iterator:</p>\n\n<pre><code>bfs target tree = go [tree] where\n  go [] = Nothing\n  go (tree@(Tree value children) : rest)\n    | value == target = Just tree\n    | otherwise       = go (rest ++ children)\n</code></pre>\n\n<p>This is a valid BFS with one major flaw: In Haskell, <code>++</code> adds a conditional operation to future accesses, and here that can eventually cause O(n<sup>2</sup>) performance because they'll \"stack up\". This is because lists are natively \"LIFO\" (last-in is first-out) queues whereas you want a \"FIFO\" (first-in is first-out) queue. </p>\n\n<p>You should still use that solution until you're sure that this flaw is noticeable. The classic solution to the flaw is to <em>amortize</em> these costs (accept O(N) costs as long as they only happen O(1/N) of the time) with two lists, but there's also a huge benefit to be gained in Haskell by making the lists themselves spine-strict so that you're not constructing huge piles of thunks:</p>\n\n<pre><code>-- spine-strict linked-lists\ndata SL x = Nil | Cons x !(SL x) deriving (Eq, Ord, Read, Show)\n\nrev sl = go sl Nil where -- reversal\n    go Nil xs = xs\n    go (Cons x xs) ys = go xs (Cons x ys)\n\n-- finite fifo queues\ndata Fifo x = Fifo !(SL [x]) !(SL [x])\n\nappend x (Fifo l r) = Fifo l (Cons x r)\n{-# INLINE append #-}\n\nfirstRest (Fifo Nil Nil) = Nothing\nfirstRest (Fifo Nil r) = let (Cons x l) = rev r in Just (x, Fifo l Nil)\nfirstRest (Fifo (Cons x l) r) = Just (x, Fifo l r)\n{-# INLINE firstRest #-} \n-- ^ we can't get rid of `rev`, which is recursive, but hopefully this INLINE \n-- will eliminate the cost to make the Maybe terms and the Haskell pair. We\n-- could also manually unroll this ourselves into the case analysis of the\n-- method below.\n\nbfs target tree = go [tree] Nil where\n  go bufs [] = case firstRest bufs of\n                 Nothing -&gt; Nothing\n                 Just (buf, bufs') -&gt; go buf bufs'\n  go bufs (tree@(Tree value children) : xs)\n     | value == target = Just tree\n     | otherwise       = go (append children bufs) xs\n</code></pre>\n\n<p>Notice that we still allow a node with an infinite list of children, and notice that this overhead should usually be avoided because this code is maybe 4 times as cognitively complex as the earlier code, and may even be a lot slower for small inputs (as the overheads of <code>++</code> could well be lighter than the overheads of detecting the <code>rev</code> step and constructing new <code>Fifo</code>s.) Do things the easy way first, and if that fails we can approach the harder way.</p>\n"}], "owner": {"reputation": 79, "user_id": 3395417, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/12f40b2a5f12c5fbfbec839b477203a7?s=128&d=identicon&r=PG&f=1", "display_name": "IvanSorokin", "link": "https://stackoverflow.com/users/3395417/ivansorokin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 769, "favorite_count": 0, "closed_date": 1431464276, "accepted_answer_id": 30198032, "answer_count": 1, "score": 0, "last_activity_date": 1431452899, "creation_date": 1431439586, "last_edit_date": 1431440761, "question_id": 30193329, "link": "https://stackoverflow.com/questions/30193329/how-to-write-haskell-bfs-algorithm-for-the-list-of-strings", "closed_reason": "Needs more focus", "title": "How to write Haskell BFS algorithm for the list of strings", "body": "<p>I try to solve \"ladder\" problem using Haskell. The task is to find the shortest path (if it exists) in list of the words between two words of the same length. The rule for words connection is</p>\n\n<ol>\n<li>We can get one word from another with one replace (word -> cord)</li>\n<li>This word (in my example \"cord\") should be in our list of the words</li>\n</ol>\n\n<p>So, if we have list[word, cord, wore] and we need a ladder from wore to cord the answer will be wore -> word -> cord. I try to solve this using bfs algorithm. To get neighbours of the word I use next functions</p>\n\n<pre><code>--(x:xs) - letters\ngetChanged :: [String] -&gt; [Char] -&gt; [String] -&gt; [String]\ngetChanged cont (x:xs) ans = \n    if length xs == 0\n    then ans ++ [cont !! 0 ++ [x] ++ cont !! 1]\n    else getChanged cont xs (ans ++ [cont !! 0 ++ [x] ++ cont !! 1])\n\n--get for getChanged\ndivide :: String -&gt; Int -&gt; [String]\ndivide word index = [(take index word)] ++ [(drop (index + 1) word)]\n\n\n--word alphabet indexToChange AnswerAcc Answer\ngetNeighbours :: String -&gt; [Char] -&gt; Int -&gt; [String] -&gt; [String]\ngetNeighbours word alphabet index answerAcc = \n    if index == length word\n    then\n        answerAcc\n    else\n        getNeighbours word alphabet (index + 1) (answerAcc ++ (getChanged (divide word index) alphabet []))\n\nmain = do\n    putStrLn (unlines (getNeighbours \"hello kitty\" ['a', 'b', 'c'] 0 []))\n</code></pre>\n\n<p>The ladder signature is something like this</p>\n\n<pre><code>ladder :: String -&gt; String -&gt; String -&gt; IO()\nladder word1 word2 words = do\n    content &lt;- readFile words\n    let words = lines content\n    let myWords = Set.fromList (filter (\\x -&gt; length x == length word1) words)\n    if not (Set.member word1 myWords) || not (Set.member word2 myWords)  \n    then error \"Path not found\"\n    else do\n        let b = [\"1\"]\n        putStrLn $ unlines b\n        print $ length b\n</code></pre>\n\n<p>I tried to use HashSet and HashMap but got nothing. Now I stuck on this. My question is how to write bfs for this problem?</p>\n"}, {"tags": ["function", "haskell", "where", "local"], "comments": [{"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 0, "creation_date": 1431422286, "post_id": 30186420, "comment_id": 48478349, "body": "If I had to guess, I&#39;d say it&#39;s probably an indentation problem. Last two lines need to be indented as far as the one above. (I.e., <code>binpsum</code> needs to line up on all three lines.)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1431422290, "post_id": 30186420, "comment_id": 48478356, "body": "Try fixing indentation so that the three <code>binpsum</code> lines start on the same column."}, {"owner": {"reputation": 818, "user_id": 4287267, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/MxZkq.png?s=128&g=1", "display_name": "mjgalindo", "link": "https://stackoverflow.com/users/4287267/mjgalindo"}, "edited": false, "score": 0, "creation_date": 1431422511, "post_id": 30186420, "comment_id": 48478540, "body": "Sorry, pasting the code made the indentation like that, my code has the indentation like I just edited it and gets that error."}], "answers": [{"comments": [{"owner": {"reputation": 10281, "user_id": 1033448, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d64fdbd293e80580b1c702998cb6e740?s=128&d=identicon&r=PG", "display_name": "Anton Guryanov", "link": "https://stackoverflow.com/users/1033448/anton-guryanov"}, "edited": false, "score": 0, "creation_date": 1431423452, "post_id": 30186962, "comment_id": 48479259, "body": "I think that <code>binpsum (x1, x2)</code> should be changed to <code>binpsum x1 x2</code> as the type of <code>binpsum</code> according to its definition is <code>[Float] -&gt; [Float] -&gt; [Float]</code>"}, {"owner": {"reputation": 4763, "user_id": 1065586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qYTQe.jpg?s=128&g=1", "display_name": "tomferon", "link": "https://stackoverflow.com/users/1065586/tomferon"}, "reply_to_user": {"reputation": 10281, "user_id": 1033448, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d64fdbd293e80580b1c702998cb6e740?s=128&d=identicon&r=PG", "display_name": "Anton Guryanov", "link": "https://stackoverflow.com/users/1033448/anton-guryanov"}, "edited": false, "score": 0, "creation_date": 1431423768, "post_id": 30186962, "comment_id": 48479486, "body": "Yes, I just edited. I just rearrange the code, didn&#39;t try to run it to be honest. Cheers."}, {"owner": {"reputation": 818, "user_id": 4287267, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/MxZkq.png?s=128&g=1", "display_name": "mjgalindo", "link": "https://stackoverflow.com/users/4287267/mjgalindo"}, "edited": false, "score": 0, "creation_date": 1431424093, "post_id": 30186962, "comment_id": 48479748, "body": "You both are right. However now I get a <code>parse error on input &#39;:&#39;</code> on the second &#39;:&#39; of <code>(x1:x2:xs)</code> . Shouldn&#39;t that work for getting two lists and the rest?"}, {"owner": {"reputation": 4763, "user_id": 1065586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qYTQe.jpg?s=128&g=1", "display_name": "tomferon", "link": "https://stackoverflow.com/users/1065586/tomferon"}, "edited": false, "score": 0, "creation_date": 1431425903, "post_id": 30186962, "comment_id": 48481051, "body": "Just made your code compile (see the edited answer), I don&#39;t know if it works though as I haven&#39;t looked into that."}], "tags": [], "owner": {"reputation": 4763, "user_id": 1065586, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qYTQe.jpg?s=128&g=1", "display_name": "tomferon", "link": "https://stackoverflow.com/users/1065586/tomferon"}, "is_accepted": false, "score": 3, "last_activity_date": 1431425852, "last_edit_date": 1431425852, "creation_date": 1431423346, "answer_id": 30186962, "question_id": 30186420, "link": "https://stackoverflow.com/questions/30186420/haskell-local-function-is-not-in-scope/30186962#30186962", "title": "Haskell local function Is not in scope", "body": "<p>Your function <code>binpsum</code> is only in the scope of the second definition. You can rewrite it one of these ways:</p>\n\n<pre><code>psum :: [[Float]] -&gt; [Float]\npsum (x1:x2:xs) = psum (binpsum x1 x2):xs\n  where \n    binpsum (x:xs) (y:ys) = x+y : binpsum xs ys\n    binpsum (x) (y:ys) = x+y:ys\n    binpsum (x:xs) (y) = x+y:xs\npsum x = x\n</code></pre>\n\n<p>or better:</p>\n\n<pre><code>psum :: [[Float]] -&gt; [Float]\npsum lst = case lst of\n   x1:x2:xs -&gt; psum (binpsum x1 x2) : xs\n   _        -&gt; lst\n where \n   binpsum (x:xs) (y:ys) = x+y : binpsum xs ys\n   binpsum (x) (y:ys) = x+y : ys\n   binpsum (x:xs) (y) = x+y : xs\n</code></pre>\n\n<p><strong>EDIT:</strong> After some correction in your code, though, it would look like this: (I just made it compile, I don't know if it does what you intended)</p>\n\n<pre><code>psum :: [[Float]] -&gt; [Float]\npsum lst = case lst of\n    x1:x2:xs -&gt; psum $ binpsum x1 x2 : xs\n    [x]      -&gt; x\n  where\n    binpsum [x] (y:ys)    = x + y : ys\n    binpsum (x:xs) [y]    = x + y : xs\n    binpsum (x:xs) (y:ys) = x + y : binpsum xs ys\n</code></pre>\n\n<p>Note that <code>binpsum (x:xs) (y:ys)</code> is now at the end as <code>[3]</code> would match <code>(x:xs)</code> with <code>x = 3</code> and <code>xs = []</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 715, "user_id": 4883127, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/428914dd1ba6786d9242170f4bbce2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Hardy", "link": "https://stackoverflow.com/users/4883127/bradley-hardy"}, "is_accepted": true, "score": 4, "last_activity_date": 1431452620, "last_edit_date": 1431452620, "creation_date": 1431423778, "answer_id": 30187107, "question_id": 30186420, "link": "https://stackoverflow.com/questions/30186420/haskell-local-function-is-not-in-scope/30187107#30187107", "title": "Haskell local function Is not in scope", "body": "<p><strong>The <code>where</code> clause only provides bindings to the equation directly above (or to the left) of it.</strong> You can fix this by moving it up, under the first of equation of <code>psum</code> where it is actually used.</p>\n\n<p>Other than that, there are various additional misunderstandings that I'm seeing in your code:</p>\n\n<ol>\n<li>When a function is defined like <code>f x y</code>, it must be called like that too (not like <code>f (x, y)</code>).</li>\n<li>If you want to pattern match against a single item in a list, you must enclose the item in square brackets to indicate that it is indeed the item that you want to bind, and not the list itself.</li>\n<li>If an argument to a function is a expression of more than one word/symbol, you usually need to enclose it in brackets (e.g. <code>f (a + b)</code> instead of <code>f a + b</code>).</li>\n</ol>\n\n<p>Here is a version of your code that compiles:</p>\n\n<pre><code>psum :: [[Float]] -&gt; [Float]\npsum (x1:x2:xs) = psum (binpsum x1 x2 : xs)\n    where binpsum (x:xs) (y:ys) = x+y : binpsum xs ys\n          binpsum [x] (y:ys) = x+y : ys\n          binpsum (x:xs) [y] = x+y : xs\npsum [x] = x\n</code></pre>\n"}], "owner": {"reputation": 818, "user_id": 4287267, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/MxZkq.png?s=128&g=1", "display_name": "mjgalindo", "link": "https://stackoverflow.com/users/4287267/mjgalindo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 651, "favorite_count": 0, "accepted_answer_id": 30187107, "answer_count": 2, "score": 0, "last_activity_date": 1431452620, "creation_date": 1431421802, "last_edit_date": 1431447437, "question_id": 30186420, "link": "https://stackoverflow.com/questions/30186420/haskell-local-function-is-not-in-scope", "title": "Haskell local function Is not in scope", "body": "<p>The following function is supposed to return the sum of all the polynomials in a list having a polynomial as a list of floats. <em>(ie: 4x\u00b2+2x+1 would be <code>[4,2,1]</code> and 5x\u2075+x+2 <code>[5,0,0,0,1,2]</code>)</em></p>\n\n<pre><code>psum :: [[Float]] -&gt; [Float]\npsum (x1:x2:xs) = psum (binpsum (x1, x2)):xs\npsum x = x\n    where   binpsum (x:xs) (y:ys) = x+y:binpsum (xs, ys) \n            binpsum (x) (y:ys) = x+y:ys\n            binpsum (x:xs) (y) = x+y:xs\n</code></pre>\n\n<p>I'm getting</p>\n\n<pre><code> Not in scope: \u2018binpsum\u2019\n</code></pre>\n\n<p>It's the first time I work with haskell so I'd guess there's something wrong in the way I use <code>binpsum (x1, x2)</code> since I can't find anything wrong in the where clause.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["function", "haskell", "types", "monomorphism-restriction"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 9, "creation_date": 1431411104, "post_id": 30181658, "comment_id": 48471738, "body": "<i>The dreaded monomorphism restriction strikes again!</i>"}, {"owner": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 1, "creation_date": 1431422832, "post_id": 30181658, "comment_id": 48478791, "body": "I thought, in recent GHC the monomorphism restriction was turned off by default?"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 29966, "user_id": 637669, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0227e5d5eaceb8ae2f751df38d421764?s=128&d=identicon&r=PG", "display_name": "arrowd", "link": "https://stackoverflow.com/users/637669/arrowd"}, "edited": false, "score": 3, "creation_date": 1431435205, "post_id": 30181658, "comment_id": 48487903, "body": "@arrowdodger, you missed a letter: in recent GHCi the monomorphism restriction is turned off by default."}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1441874108, "post_id": 30181658, "comment_id": 52853604, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/32496864/what-is-the-monomorphism-restriction\">What is the monomorphism restriction?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "edited": false, "score": 0, "creation_date": 1431407185, "post_id": 30182176, "comment_id": 48470058, "body": "Here&#39;s an example of a related situation: <a href=\"https://stackoverflow.com/questions/6052670/\">stackoverflow.com/questions/6052670</a>"}, {"owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "edited": false, "score": 0, "creation_date": 1431451219, "post_id": 30182176, "comment_id": 48500364, "body": "Sign ... monomorphism restriction. What a name."}, {"owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "reply_to_user": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "edited": false, "score": 0, "creation_date": 1431471744, "post_id": 30182176, "comment_id": 48511194, "body": "@Ana: It sounds a lot scarier than it is, and it comes up <i>a lot</i>. And no surprise: it&#39;s arbitrary and unnatural, so it&#39;s going to trip you up unless you know about it off-hand. That&#39;s why people like to call it the <i>dreaded</i> monomorphism restriction :)."}, {"owner": {"reputation": 9560, "user_id": 2023370, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/4840a671d94ce5df0818cce059cab62b?s=128&d=identicon&r=PG&f=1", "display_name": "user2023370", "link": "https://stackoverflow.com/users/2023370/user2023370"}, "edited": false, "score": 0, "creation_date": 1559814981, "post_id": 30182176, "comment_id": 99540596, "body": "I see the above error also in GHCi (version 8.4.4). Is the monomorphism restriction now enabled by default in GHCi?"}], "tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 13, "last_activity_date": 1460622192, "last_edit_date": 1460622192, "creation_date": 1431407031, "answer_id": 30182176, "question_id": 30181658, "link": "https://stackoverflow.com/questions/30181658/why-does-haskell-point-free-version-of-function-result-in-ambiguous-type-error/30182176#30182176", "title": "Why does Haskell point free version of function result in ambiguous type error?", "body": "<p>As usual with cases where making a well-typed function point-free suddenly results in type errors about unfulfilled typeclass constraints, the ultimate cause of this is the <a href=\"https://wiki.haskell.org/Monomorphism_restriction\" rel=\"nofollow\">monomorphism restriction</a>, enabled by default.</p>\n\n<p>You can solve this by either adding a type signature to <code>mysum</code>:</p>\n\n<pre><code>mysum :: (Foldable f, Num a) =&gt; f a -&gt; a\n</code></pre>\n\n<p>or by turning off the monomorphism restriction:</p>\n\n<pre><code>{-# LANGUAGE NoMonomorphismRestriction #-}\n</code></pre>\n"}], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 708, "favorite_count": 1, "accepted_answer_id": 30182176, "answer_count": 1, "score": 11, "last_activity_date": 1460622192, "creation_date": 1431403927, "last_edit_date": 1431418669, "question_id": 30181658, "link": "https://stackoverflow.com/questions/30181658/why-does-haskell-point-free-version-of-function-result-in-ambiguous-type-error", "title": "Why does Haskell point free version of function result in ambiguous type error?", "body": "<p>It turns out that in GHC 7.10, this compiles fine:</p>\n\n<pre><code>mysum xs = foldr (+) 0 xs\n</code></pre>\n\n<p>But this:</p>\n\n<pre><code>mysum    = foldr (+) 0\n</code></pre>\n\n<p>results in the following error:</p>\n\n<pre><code>No instance for (Foldable t0) arising from a use of \u2018foldr\u2019\nThe type variable \u2018t0\u2019 is ambiguous\nRelevant bindings include\n  mysum :: t0 Integer -&gt; Integer (bound at src/Main.hs:37:1)\nNote: there are several potential instances:\n  instance Foldable (Either a) -- Defined in \u2018Data.Foldable\u2019\n  instance Foldable Data.Functor.Identity.Identity\n    -- Defined in \u2018Data.Functor.Identity\u2019\n  instance Foldable Data.Proxy.Proxy -- Defined in \u2018Data.Foldable\u2019\n  ...plus five others\nIn the expression: foldr (+) 0\nIn an equation for \u2018mysum\u2019: mysum = foldr (+) 0\n</code></pre>\n\n<p>Why does this happen, and what is the insight that's achieved by understanding this difference? Also, can I give this function a type (that's still generic) to make this error go away?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "edited": false, "score": 0, "creation_date": 1431399494, "post_id": 30180972, "comment_id": 48467754, "body": "What is <code>f</code> in your line <code>f 1 2 :: [[TheTypeYouPicked]]</code>?"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "edited": false, "score": 0, "creation_date": 1431399587, "post_id": 30180972, "comment_id": 48467777, "body": "@AR7 <code>f</code> is your function you&#39;ve been given, you didn&#39;t give it a name in your post, just a type, but it&#39;s your <code>Group g =&gt; Int -&gt; Int -&gt; [[g]]</code> function."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "edited": false, "score": 0, "creation_date": 1431399696, "post_id": 30180972, "comment_id": 48467815, "body": "@AR7 I guess it&#39;s named in your type signature as <code>myTest</code>, I can edit my answer to reflect that.  To be honest, I didn&#39;t read the whole error message because the really important information is all within the first 2 lines."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 3, "last_activity_date": 1431399710, "last_edit_date": 1431399710, "creation_date": 1431399388, "answer_id": 30180972, "question_id": 30180938, "link": "https://stackoverflow.com/questions/30180938/show-list-of-unknown-type-in-haskell/30180972#30180972", "title": "Show list of unknown type in Haskell", "body": "<p>Try running</p>\n\n<pre><code>&gt; :info Group\n</code></pre>\n\n<p>This should print out the <code>Group</code> typeclass and its members, followed by a list of instances.  Pick one of these instances, then execute</p>\n\n<pre><code>&gt; myTest 1 2 :: [[TheTypeYouPicked]]\n</code></pre>\n\n<p>If you wanted to use it inside <code>main</code> you'll have to give it a type signature there too:</p>\n\n<pre><code>main :: IO ()\nmain = print (myTest 10 0 :: [[TheTypeYouPicked]])\n</code></pre>\n\n<p>The reason why the compiler is showing you this error is because there could be many instances of <code>Group</code> to choose from, not all of them necessarily implement <code>Show</code> as well.  In order to print something in the console, either by just executing it (there's an implicit <code>print</code> when you just run a normal function in GHCi) or with an explicit <code>print</code> it needs to implement <code>Show</code>.</p>\n"}], "owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 0, "accepted_answer_id": 30180972, "answer_count": 1, "score": 2, "last_activity_date": 1431400010, "creation_date": 1431399134, "last_edit_date": 1431400010, "question_id": 30180938, "link": "https://stackoverflow.com/questions/30180938/show-list-of-unknown-type-in-haskell", "title": "Show list of unknown type in Haskell", "body": "<p>I was given an assignment in which I should have the type signature</p>\n\n<pre><code>Group g =&gt; Int -&gt; Int -&gt; [[g]]\n</code></pre>\n\n<p>However if g is ambiguous how can I <code>print</code> it? I get this error:</p>\n\n<pre><code>No instance for (Show g0) arising from a use of \u2018print\u2019\nThe type variable \u2018g0\u2019 is ambiguous\nNote: there are several potential instances:\n  instance Show Double -- Defined in \u2018GHC.Float\u2019\n  instance Show Float -- Defined in \u2018GHC.Float\u2019\n  instance (Integral a, Show a) =&gt; Show (GHC.Real.Ratio a)\n    -- Defined in \u2018GHC.Real\u2019\n  ...plus 24 others\nIn the expression: print\nIn the expression: print $ myTest 10 0\nIn an equation for \u2018main\u2019: main = print $ myTest 10 0\n</code></pre>\n\n<p>Which makes sense to me. Is there an error in the assignment? Or is there a way to <code>print</code> an ambiguous type?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 2024, "user_id": 3026489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/42eefce716334b3baef26625220fb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Yosh", "link": "https://stackoverflow.com/users/3026489/yosh"}, "edited": false, "score": 0, "creation_date": 1431399252, "post_id": 30180922, "comment_id": 48467704, "body": "I felt there should be some function, perfect ! And <i>you definitely could</i> -- that&#39;s the insight I was missing. Both question perfectly solved, thank you!"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 2024, "user_id": 3026489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/42eefce716334b3baef26625220fb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Yosh", "link": "https://stackoverflow.com/users/3026489/yosh"}, "edited": false, "score": 0, "creation_date": 1431399556, "post_id": 30180922, "comment_id": 48467772, "body": "@Yosh Sorry, it&#39;s better now.  I must have copy/pasted wrong or something.  I read over that line about 3 times and didn&#39;t see that I hadn&#39;t left the return type polymorphic like I intended."}, {"owner": {"reputation": 2024, "user_id": 3026489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/42eefce716334b3baef26625220fb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Yosh", "link": "https://stackoverflow.com/users/3026489/yosh"}, "edited": false, "score": 0, "creation_date": 1431399595, "post_id": 30180922, "comment_id": 48467781, "body": "Thanks again. So neat. :)"}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 6, "last_activity_date": 1431399515, "last_edit_date": 1431399515, "creation_date": 1431399003, "answer_id": 30180922, "question_id": 30180737, "link": "https://stackoverflow.com/questions/30180737/polymorphism-with-type-variable/30180922#30180922", "title": "Polymorphism with type variable?", "body": "<p>You just need to use <code>realToFrac</code>, which converts any <code>Real r =&gt; r</code> value to a <code>Fractional f =&gt; f</code> value:</p>\n\n<pre><code>norm :: (Real r, Floating f) =&gt; Vect r -&gt; f\nnorm (Vect x y) = sqrt . realToFrac $ x^2 + y^2\n</code></pre>\n\n<p>Then it will work for even more types than just <code>Double</code>, too.</p>\n\n<p>As for the error message, you don't technically have an overlap on those two instances, but you definitely could.  Someone could define an <code>Integral Double</code> instance, then import your code.  Suddenly the compiler can't decide which instance to use!</p>\n\n<p>While this precise situation is not likely to happen, the type system does allow someone to instance <code>Integral</code> for <code>Double</code>, and this certainly can occur with other typeclasses and data types.</p>\n"}], "owner": {"reputation": 2024, "user_id": 3026489, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/42eefce716334b3baef26625220fb7a0?s=128&d=identicon&r=PG&f=1", "display_name": "Yosh", "link": "https://stackoverflow.com/users/3026489/yosh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 0, "accepted_answer_id": 30180922, "answer_count": 1, "score": 2, "last_activity_date": 1431399515, "creation_date": 1431397676, "question_id": 30180737, "link": "https://stackoverflow.com/questions/30180737/polymorphism-with-type-variable", "title": "Polymorphism with type variable?", "body": "<p>The title might not be appropriate, so please read on. </p>\n\n<p>What I initially want is the following : I'm writing a 2D Vector data</p>\n\n<pre><code>data Vect a = Vect a a deriving (Show)\n</code></pre>\n\n<p>and want to write a <code>norm :: Vect a -&gt; Double</code> function that works for all <code>Vect a</code> where a is an instance of <code>Integral</code> or <code>Floating</code>.</p>\n\n<p>For Double, I can wrote:</p>\n\n<pre><code>norm :: Vect Double -&gt; Double\nnorm (Vect x y) = sqrt  $ x^2 + y^2\n</code></pre>\n\n<p>But I want this function to also work with <code>Vect Int</code>. I can write another function like:</p>\n\n<pre><code>normFromInt :: (Integral a) =&gt; Vect a -&gt; Double\nnormFromInt (Vect x y) = sqrt . fromIntegral $ x^2 + y^2\n</code></pre>\n\n<p>Having two functions seems rather awkward. What are the good ways of achieving this?</p>\n\n<hr>\n\n<p>I tried to use special class for this:</p>\n\n<pre><code>class Vectorlike a where\n    norm :: a -&gt; Double\n\ninstance (Integral a) =&gt; Vectorlike (Vect a) where\n    norm (Vect x y) = sqrt . fromIntegral $ x^2 + y^2\n-- |\n-- &gt;&gt;&gt; norm (Vect 3 4 :: Vect Int)\n-- 5.0\n\ninstance Vectorlike (Vect Double) where\n    norm (Vect x y) = sqrt $ x^2 + y^2\n</code></pre>\n\n<p>but with this, when usnig `norm (Vect 3.0 4.0 :: Vect Double) I get an error</p>\n\n<pre><code>Overlapping instances for Vectorlike (Vect Double)\n||   print $ norm (Vect 3.0 4.0 :: Vect Double)\nfoo.hs|40 col 13 error| Overlapping instances for Vectorlike (Vect Double)\n||   arising from a use of `norm'\n|| Matching instances:\n||   instance Integral a =&gt; Vectorlike (Vect a)\n||     -- Defined at /home/yosh/foo.hs:26:10\n||   instance Vectorlike (Vect Double)\n||     -- Defined at /home/yosh/foo.hs:32:10\n</code></pre>\n\n<p>My question is how I can define <code>norm</code> so that it works for integers and floatings, and the error message is not the main concern (it's puzzling for me, but I think I can work with that afterwards).</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1406, "user_id": 1379930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/373e9e09bd32347a059d56cba8691d84?s=128&d=identicon&r=PG", "display_name": "Jeff Ames", "link": "https://stackoverflow.com/users/1379930/jeff-ames"}, "edited": false, "score": 0, "creation_date": 1431392292, "post_id": 30179752, "comment_id": 48465907, "body": "To print something, it must be an instance of the <code>Show</code> typeclass."}, {"owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "reply_to_user": {"reputation": 1406, "user_id": 1379930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/373e9e09bd32347a059d56cba8691d84?s=128&d=identicon&r=PG", "display_name": "Jeff Ames", "link": "https://stackoverflow.com/users/1379930/jeff-ames"}, "edited": false, "score": 0, "creation_date": 1431392525, "post_id": 30179752, "comment_id": 48465974, "body": "@JeffAmes so I should make group part of the show type class? And if so how would I do that?"}, {"owner": {"reputation": 1406, "user_id": 1379930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/373e9e09bd32347a059d56cba8691d84?s=128&d=identicon&r=PG", "display_name": "Jeff Ames", "link": "https://stackoverflow.com/users/1379930/jeff-ames"}, "edited": false, "score": 0, "creation_date": 1431393189, "post_id": 30179752, "comment_id": 48466105, "body": "I think you&#39;d want <code>class (Show g) =&gt; Group g where</code> ..."}], "answers": [{"comments": [{"owner": {"reputation": 914, "user_id": 460282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52b4265ed7ecd0b9cd67653fb5264a24?s=128&d=identicon&r=PG", "display_name": "Jomel Imperio", "link": "https://stackoverflow.com/users/460282/jomel-imperio"}, "edited": false, "score": 0, "creation_date": 1431390859, "post_id": 30179811, "comment_id": 48465462, "body": "So is the proper type signature just <code>myTest :: Int -&gt; Int -&gt; [Int]</code>?"}, {"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "reply_to_user": {"reputation": 914, "user_id": 460282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52b4265ed7ecd0b9cd67653fb5264a24?s=128&d=identicon&r=PG", "display_name": "Jomel Imperio", "link": "https://stackoverflow.com/users/460282/jomel-imperio"}, "edited": false, "score": 3, "creation_date": 1431390972, "post_id": 30179811, "comment_id": 48465498, "body": "@JomelI.: That would be one possible solution, yes.  But note that the function <code>myTest</code> would then just be the same as <code>makeGroup</code> but restricted with <code>g ~ Int</code>."}, {"owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "edited": false, "score": 0, "creation_date": 1431390978, "post_id": 30179811, "comment_id": 48465499, "body": "I thought that <code>instance</code> would convert <code>g</code> to <code>Int</code> or something along those lines. How should I properly leverage <code>instance</code>?"}, {"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "reply_to_user": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "edited": false, "score": 1, "creation_date": 1431391204, "post_id": 30179811, "comment_id": 48465562, "body": "@AR7: Haskell doesn&#39;t modify or refine the types that you declare. It doesn&#39;t look at the <code>g</code> in <code>myTest</code>&#39;s type signature and rewrite it to <code>Int</code> based on the inference that it must be the same as <code>Int</code>. It just interprets it as &quot;any type can go here, as long as it&#39;s a <code>Group</code> instance.&quot; As Jomel I. suggests, if you declared <code>myTest :: Int -&gt; Int -&gt; [Int] </code> the problem should go away; your actual <code>instance</code> declaration looks right (though I haven&#39;t actually checked it in the compiler, I could have missed something)."}, {"owner": {"reputation": 1406, "user_id": 1379930, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/373e9e09bd32347a059d56cba8691d84?s=128&d=identicon&r=PG", "display_name": "Jeff Ames", "link": "https://stackoverflow.com/users/1379930/jeff-ames"}, "edited": false, "score": 1, "creation_date": 1431391525, "post_id": 30179811, "comment_id": 48465658, "body": "You could also declare the type of <code>myTest</code> as <code>(Group g) =&gt; g -&gt; g -&gt; [g]</code>."}, {"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "reply_to_user": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "edited": false, "score": 3, "creation_date": 1431391594, "post_id": 30179811, "comment_id": 48465680, "body": "@AR7: One more tip I would give is this: Haskell is a very, very literal language.  Most languages have a bit of &quot;do what I mean&quot; built into them, but Haskell has way less than that.  If you say <code>myTest :: (Group g) =&gt; Int -&gt; Int -&gt; [g]</code>, Haskell takes that absolutely literally as &quot;the function <code>myTest</code> takes two <code>Int</code> arguments, and returns a result of whatever type <code>g</code> that the caller expects, as long as <code>g</code> is a <code>Group</code> instance.&quot; It doesn&#39;t question at all whether your type signature is what you meant\u2014it just goes &quot;Yes, boss, whatever you say!&quot;"}, {"owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "edited": false, "score": 0, "creation_date": 1431391935, "post_id": 30179811, "comment_id": 48465794, "body": "@LuisCasillas if you have the time I have a few more questions. You said <code>myTest :: Int -&gt; Int -&gt; [Int]</code> is one way to solve it. Is there a better way? The other question I have edited into the question and resulted from &quot;<code>myTest</code> as <code>(Group g) =&gt; g -&gt; g -&gt; [g]</code>&quot; as Jeff Ames suggested if you could please take a look."}, {"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "reply_to_user": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "edited": false, "score": 0, "creation_date": 1431392307, "post_id": 30179811, "comment_id": 48465912, "body": "@AR7: both <code>Int -&gt; Int -&gt; Int</code> and <code>Group g =&gt; g -&gt; g -&gt; [g]</code> are fine, the choice between them is entirely about what you want."}], "tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": true, "score": 6, "last_activity_date": 1431392119, "last_edit_date": 1431392119, "creation_date": 1431390742, "answer_id": 30179811, "question_id": 30179752, "link": "https://stackoverflow.com/questions/30179752/i-made-my-first-typeclass-and-i-got-could-not-deduce-g-int-from-the-context/30179811#30179811", "title": "I made my first typeclass and I got &quot;Could not deduce (g ~ Int) from the context (Group g)&quot;", "body": "<p>This is your class definition:</p>\n\n<pre><code>class Group g where\n    makeGroup :: g -&gt; g -&gt; [g]\n</code></pre>\n\n<p>This means that in any use of <code>makeGroup</code>, all three occurrences of the type variable <code>g</code> must be instantiated to the same type.  But in your <code>myTest</code> function's type signature, you're indirectly saying that the first two occurrences are <code>Int</code>s but the third one could be any type <code>g</code> (caller's choice!) that satisfies the <code>Group</code> constraint:</p>\n\n<pre><code>myTest :: (Group g) =&gt; Int -&gt; Int -&gt; [g]\nmyTest x y = makeGroup x y\n</code></pre>\n\n<p><strong>EDIT:</strong> Well, to make this much clearer, I should add that when we say that <code>g</code> could be \"any type,\" more precisely this means that it could be <strong>any type that <code>myTest</code>'s caller chooses</strong>.  This is the way generic types work: the function <code>myTest</code> is like a <strong>template</strong> that the caller can <strong>specialize</strong> by choosing what type they would like <code>g</code> to be.</p>\n\n<p>The notation is odd, but  <code>(g ~ Int)</code> in the error is a <strong>type equality constraint</strong>: Haskell is telling you that, given the declarations that you've provided elsewhere, in <code>myTest</code>'s signature <code>g</code>'s type must be the same as <code>Int</code>, but you've asserted that it could be any type <code>g</code> as long as that type implements <code>Group</code>.  That assertion is not compatible with what you've said elsewhere in the code.</p>\n"}], "owner": {"reputation": 14050, "user_id": 3772221, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/xfx4l.png?s=128&g=1", "display_name": "m0meni", "link": "https://stackoverflow.com/users/3772221/m0meni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 30179811, "answer_count": 1, "score": 1, "last_activity_date": 1431392119, "creation_date": 1431390249, "last_edit_date": 1431391869, "question_id": 30179752, "link": "https://stackoverflow.com/questions/30179752/i-made-my-first-typeclass-and-i-got-could-not-deduce-g-int-from-the-context", "title": "I made my first typeclass and I got &quot;Could not deduce (g ~ Int) from the context (Group g)&quot;", "body": "<p>I'm new to haskell and I've tried to make my own typeclass here:</p>\n\n<pre><code>class Group g where\n    makeGroup :: g -&gt; g -&gt; [g]\n\ninstance Group Int where\n    makeGroup size offset = [ x `mod` size | x &lt;- [1 + offset, size + offset]]\n\nmyTest :: (Group g) =&gt; Int -&gt; Int -&gt; [g]\nmyTest x y = makeGroup x y\n</code></pre>\n\n<p>Could someone tell me where I went wrong?</p>\n\n<p><strong>New problem</strong></p>\n\n<p>The type signature <code>myTest :: (Group g) =&gt; g -&gt; g -&gt; [g]</code> compiles but throws this error</p>\n\n<blockquote>\n  <p><code>&lt;interactive&gt;:30:1:</code>\n      No instance for (Group g0) arising from a use of \u2018it\u2019\n      The type variable \u2018g0\u2019 is ambiguous\n      Note: there is a potential instance available:\n        instance Group Int -- Defined at ex.hs:4:10\n      In the first argument of \u2018print\u2019, namely \u2018it\u2019\n      In a stmt of an interactive GHCi command: print it</p>\n</blockquote>\n\n<p>What does this stem from?</p>\n"}, {"tags": ["list", "haskell", "optimization"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1431383900, "post_id": 30178676, "comment_id": 48463485, "body": "Not in general, but you can sometimes ensure that both lists are ordered and thus boost performance..."}, {"owner": {"reputation": 901, "user_id": 550292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f007116df8b3b452c8a2fc45e816eb69?s=128&d=identicon&r=PG", "display_name": "Anschel Schaffer-Cohen", "link": "https://stackoverflow.com/users/550292/anschel-schaffer-cohen"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1431384103, "post_id": 30178676, "comment_id": 48463566, "body": "Unfortunately, one of the lists is coming from a user. I could sort them first, but I doubt it would be worth the cost."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1431384243, "post_id": 30178676, "comment_id": 48463608, "body": "sorting can be done in O(n log n) whereas your comparison is done in O(n^2)"}, {"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1431384470, "post_id": 30178676, "comment_id": 48463700, "body": "At least make it tail recursive (since your return type is flat).  And you should benchmark--sorting may still be worth it."}, {"owner": {"reputation": 901, "user_id": 550292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f007116df8b3b452c8a2fc45e816eb69?s=128&d=identicon&r=PG", "display_name": "Anschel Schaffer-Cohen", "link": "https://stackoverflow.com/users/550292/anschel-schaffer-cohen"}, "edited": false, "score": 0, "creation_date": 1431384493, "post_id": 30178676, "comment_id": 48463711, "body": "Hmm, I&#39;ll try it. But keep in mind that <code>n==6</code>, so asymptotic time doesn&#39;t really matter."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1431384901, "post_id": 30178676, "comment_id": 48463827, "body": "@AnschelSchaffer-Cohen: in case <i>n=6</i>, I don&#39;t see much benefit to optimize this function anyway. Profiling in general focuses on the parts that require a significant amount of computational effort."}, {"owner": {"reputation": 901, "user_id": 550292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f007116df8b3b452c8a2fc45e816eb69?s=128&d=identicon&r=PG", "display_name": "Anschel Schaffer-Cohen", "link": "https://stackoverflow.com/users/550292/anschel-schaffer-cohen"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1431384992, "post_id": 30178676, "comment_id": 48463858, "body": "@CommuSoft: n=6, but this function gets run about a million times, it&#39;s the bottleneck of the program."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1431385054, "post_id": 30178676, "comment_id": 48463875, "body": "@AnschelSchaffer-Cohen: but in that case, you can do the sorting only <i>once</i>, and thus repeat the intersection in linear time. Linear time is in many cases a significant boost over quadratic time."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1431385093, "post_id": 30178676, "comment_id": 48463884, "body": "You probably have a specific type <code>c</code> in mind: try using directly that instead of using a polymorphic function. Or alternatively use a <code>SPECIALIZE</code> GHC pragma."}, {"owner": {"reputation": 901, "user_id": 550292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f007116df8b3b452c8a2fc45e816eb69?s=128&d=identicon&r=PG", "display_name": "Anschel Schaffer-Cohen", "link": "https://stackoverflow.com/users/550292/anschel-schaffer-cohen"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1431398644, "post_id": 30178676, "comment_id": 48467566, "body": "@chi: My understanding is I can just SPECIALIZE a top-level function and GHC will specialize anything it calls within the module. Is that right?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1431416234, "post_id": 30178676, "comment_id": 48474507, "body": "I&#39;m not sure about when GHC specializes. Check the GHC Core to see if that&#39;s actually done in your case. Or add a SPECIALIZE pragma and see if it makes any difference in performance."}], "answers": [{"comments": [{"owner": {"reputation": 901, "user_id": 550292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f007116df8b3b452c8a2fc45e816eb69?s=128&d=identicon&r=PG", "display_name": "Anschel Schaffer-Cohen", "link": "https://stackoverflow.com/users/550292/anschel-schaffer-cohen"}, "edited": false, "score": 0, "creation_date": 1431384588, "post_id": 30178839, "comment_id": 48463737, "body": "I am using the same <code>ys</code> for multiple <code>xs</code>. But comparison is cheap (in practice <code>c</code> is <code>Int</code>), so I don&#39;t think hashing will help."}], "tags": [], "owner": {"reputation": 1825, "user_id": 2671214, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/v464b.jpg?s=128&g=1", "display_name": "Tomasz Lewowski", "link": "https://stackoverflow.com/users/2671214/tomasz-lewowski"}, "is_accepted": false, "score": 0, "last_activity_date": 1431384223, "creation_date": 1431384223, "answer_id": 30178839, "question_id": 30178676, "link": "https://stackoverflow.com/questions/30178676/fast-length-of-an-intersection-with-duplicates-in-haskell/30178839#30178839", "title": "Fast length of an intersection with duplicates in Haskell", "body": "<p>Are you using same <code>ys</code> for multiple <code>xs</code>? </p>\n\n<p>If yes, you can try to calculate hash values for each element in <code>ys</code> and match by this value, but keep in mind that calculating hash needs to be faster then 6 comparisons.</p>\n\n<p>If either of those is <code>Ord</code> you may also sort it earlier, and verify only necessary part of <code>ys</code>.</p>\n\n<p>However, if you need fast random access lists aren't the best structure, you should probably take a look at <code>Data.Array</code> and <code>Data.HashMap</code></p>\n"}, {"comments": [{"owner": {"reputation": 901, "user_id": 550292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f007116df8b3b452c8a2fc45e816eb69?s=128&d=identicon&r=PG", "display_name": "Anschel Schaffer-Cohen", "link": "https://stackoverflow.com/users/550292/anschel-schaffer-cohen"}, "edited": false, "score": 0, "creation_date": 1431384913, "post_id": 30178863, "comment_id": 48463833, "body": "I will benchmark both of these ideas some time in the next 24 hours. Asymptotic time complexity is probably irrelevant when the lists are so short, so I wouldn&#39;t want to guess one way or the other what will be fastest."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 901, "user_id": 550292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f007116df8b3b452c8a2fc45e816eb69?s=128&d=identicon&r=PG", "display_name": "Anschel Schaffer-Cohen", "link": "https://stackoverflow.com/users/550292/anschel-schaffer-cohen"}, "edited": false, "score": 0, "creation_date": 1431384974, "post_id": 30178863, "comment_id": 48463853, "body": "@AnschelSchaffer-Cohen: I think optimization is a bit (sorry for the word) <i>useless</i> if you are dealing with such small lists anyway. You will not lose significant time over these in general."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1431384746, "last_edit_date": 1431384746, "creation_date": 1431384368, "answer_id": 30178863, "question_id": 30178676, "link": "https://stackoverflow.com/questions/30178676/fast-length-of-an-intersection-with-duplicates-in-haskell/30178863#30178863", "title": "Fast length of an intersection with duplicates in Haskell", "body": "<p>In general it is (almost) impossible to boost the performance of such algorithm: in order to remove duplicates in two <em>unordered</em> and <em>unhashable</em> lists, can be done in <em>O(n^2)</em>.</p>\n\n<p>In general, you can however boost performance with the following conditions (per condition, a different approach):</p>\n\n<ul>\n<li><p>If you can for instance ensure that for each list you create/modify/..., the order of the elements is maintained; this can require some engineering. In that case, the algorithm can run in O(n).</p>\n\n<p>In that case you can run it with:</p>\n\n<pre><code>--Use this only if xs and ys are sorted\noverlap :: Ord c =&gt; [c] -&gt; [c] -&gt; Int\noverlap (x:xs) (y:ys) | x &lt; y = overlap xs (y:ys)\n                      | x &gt; y = overlap (x:xs) ys\n                      | otherwise = 1 + overlap xs ys\noverlap [] _ = 0\noverlap _ [] = 0\n</code></pre>\n\n<p>In general sorting of a list can be done in <em>O(n log n)</em> and is thus more efficient than your <em>O(n^2)</em> overlap algorithm. The new overlap algorithm runs in <em>O(n)</em>.</p></li>\n<li><p>In case <code>c</code> is ordered, you might use a <a href=\"https://hackage.haskell.org/package/containers-0.3.0.0/docs/Data-Set.html\" rel=\"nofollow\"><code>Data.Set</code></a> as well. In that case you can use the <a href=\"https://hackage.haskell.org/package/containers-0.3.0.0/docs/Data-Set.html#g:11\" rel=\"nofollow\"><code>fromList</code></a> method that runs in <em>O(n log n)</em> to create a TreeSet for the two lists, then use the <a href=\"https://hackage.haskell.org/package/containers-0.3.0.0/docs/Data-Set.html#g:5\" rel=\"nofollow\"><code>intersection</code></a> function to calculate the intersection in <em>O(n)</em> time and finally use the <a href=\"https://hackage.haskell.org/package/containers-0.3.0.0/docs/Data-Set.html#g:3\" rel=\"nofollow\"><code>size</code></a> function to calculate the size.</p>\n\n<pre><code>--Use this only if c can be ordered\noverlap :: Ord c =&gt; [c] -&gt; [c] -&gt; Int\noverlap xs ys = size $ intersection (fromList xs) (fromList ys)\n</code></pre></li>\n</ul>\n"}], "owner": {"reputation": 901, "user_id": 550292, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f007116df8b3b452c8a2fc45e816eb69?s=128&d=identicon&r=PG", "display_name": "Anschel Schaffer-Cohen", "link": "https://stackoverflow.com/users/550292/anschel-schaffer-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 465, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1434368259, "creation_date": 1431383327, "last_edit_date": 1495540713, "question_id": 30178676, "link": "https://stackoverflow.com/questions/30178676/fast-length-of-an-intersection-with-duplicates-in-haskell", "title": "Fast length of an intersection with duplicates in Haskell", "body": "<p>I'm writing a mastermind solver, and in an inner loop I calculate the length of the <a href=\"https://stackoverflow.com/questions/27332815/haskell-intersection-with-duplicates\">intersection with duplicates</a> of two lists. Right now the function I have is</p>\n\n<pre><code>overlap :: Eq c =&gt; [c] -&gt; [c] -&gt; Int\noverlap [] _ = 0\noverlap (x:xs) ys\n    | x `elem` ys = 1 + overlap xs (delete x ys)\n    | otherwise = overlap xs ys\n</code></pre>\n\n<p>Is it possible to make this faster? If it helps, the arguments to <code>overlap</code> are short lists of the same length, at most 6 elements, and the <code>c</code> type has less than 10 possible values.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1764, "user_id": 2478883, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/ys9QL.png?s=128&g=1", "display_name": "Ryoichiro Oka", "link": "https://stackoverflow.com/users/2478883/ryoichiro-oka"}, "edited": false, "score": 1, "creation_date": 1431372547, "post_id": 30175974, "comment_id": 48458125, "body": "Maybe the same question as this? <a href=\"http://stackoverflow.com/questions/1717553/pointer-equality-in-haskell\" title=\"pointer equality in haskell\">stackoverflow.com/questions/1717553/pointer-equality-in-hask&zwnj;&#8203;ell</a>"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 14, "creation_date": 1431372778, "post_id": 30175974, "comment_id": 48458247, "body": "I am almost sure you don&#39;t actually want this."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1431373234, "post_id": 30175974, "comment_id": 48458517, "body": "Values in pure functional programming have no identity like OOP objects."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1431375241, "post_id": 30175974, "comment_id": 48459580, "body": "It is nigh on impossible to compare two functions in Haskell. For instance, <code>Control.Applicative.&lt;*&gt;</code> and <code>Control.Monad.ap</code> are pretty much identical, but are incomparable because of their types."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1431378762, "post_id": 30175974, "comment_id": 48461374, "body": "What would you want the result of, say, <code>f (\\x -&gt; x+x) (\\x -&gt; 2*x)</code> to be?"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1431454929, "post_id": 30175974, "comment_id": 48502720, "body": "If you solve the halting problem for me, I will solve this problem for you."}, {"owner": {"reputation": 25321, "user_id": 163177, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e811b5337bcad19d52c8fed3a0ea0075?s=128&d=identicon&r=PG", "display_name": "John F. Miller", "link": "https://stackoverflow.com/users/163177/john-f-miller"}, "edited": false, "score": 0, "creation_date": 1431587670, "post_id": 30175974, "comment_id": 48565733, "body": "Leftroundabout: False.  They are not the same function.  Rein Henrichs, it is my inability to solve the halting problem that leads to my question.  I have a data structure that includes a function so I cannot create an Eq class for it.  They form a graph, and I need to know if I&#39;ve looped back to the node I started from."}], "answers": [{"comments": [{"owner": {"reputation": 2846, "user_id": 4347335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7e6f293a134a5defec74e12cae42cc?s=128&d=identicon&r=PG&f=1", "display_name": "cchalmers", "link": "https://stackoverflow.com/users/4347335/cchalmers"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1431380212, "post_id": 30176255, "comment_id": 48462113, "body": "@Sibi Right, my understanding is for <code>c :: Num a =&gt; a -&gt; a</code>, <code>a</code> gets defaulted to <code>Integer</code> by ghci&#39;s default rules (because it needs to have some type). This means <code>c</code> gets &quot;cloned&quot; at each site and so they have different pointer values. On the other hand <code>id</code> doesn&#39;t need to select a specific type so it points to the same thing."}], "tags": [], "owner": {"reputation": 2846, "user_id": 4347335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7e6f293a134a5defec74e12cae42cc?s=128&d=identicon&r=PG&f=1", "display_name": "cchalmers", "link": "https://stackoverflow.com/users/4347335/cchalmers"}, "is_accepted": true, "score": 10, "last_activity_date": 1431381425, "last_edit_date": 1495540262, "creation_date": 1431373154, "answer_id": 30176255, "question_id": 30175974, "link": "https://stackoverflow.com/questions/30175974/haskell-function-to-check-if-two-values-are-identical/30176255#30176255", "title": "Haskell function to check if two values are identical", "body": "<p>One way that wasn't mentioned in <a href=\"https://stackoverflow.com/questions/1717553/pointer-equality-in-haskell\">Pointer equality in Haskell?</a> is <a href=\"https://hackage.haskell.org/package/ghc-prim-0.4.0.0/docs/GHC-Prim.html#g:21\" rel=\"nofollow noreferrer\"><code>reallyUnsafePtrEquality#</code></a>. As the name suggests it can be unpredictable and probably should't be used but it can be interesting to see how ghc works. Here's how you can use it in ghci:</p>\n\n<pre><code>&gt; :set -package ghc-prim\n&gt; import GHC.Prim\n&gt; import GHC.Types\n&gt; isTrue# (reallyUnsafePtrEquality# id id)\nTrue\n&gt; let a x = x + 2 :: Int\n&gt; isTrue# (reallyUnsafePtrEquality# a a)\nTrue\n&gt; let b x = x + 2 :: Int\n&gt; isTrue# (reallyUnsafePtrEquality# a b)\nFalse\n</code></pre>\n\n<p>If the function isn't monomorphic it doesn't work:</p>\n\n<pre><code>&gt; let c x = x + 2\n&gt; isTrue# (reallyUnsafePtrEquality# c c)\nFalse\n</code></pre>\n\n<hr>\n\n<p>Some more examples:</p>\n\n<pre><code>&gt; let d = c in isTrue# (reallyUnsafePtrEquality# d d)\nFalse\n&gt; :set -XMonomorphismRestriction\n&gt; let d = c in isTrue# (reallyUnsafePtrEquality# d d)\nTrue\n</code></pre>\n\n<p>You can compare polymorphic types if you wrap them in a newtype:</p>\n\n<pre><code>&gt; :set -XRankNTypes\n&gt; newtype X = X (forall a. Num a =&gt; a -&gt; a)\n&gt; let d = X c\n&gt; isTrue# (reallyUnsafePtrEquality# d d)\nTrue\n</code></pre>\n\n<p>Applying anything makes them not equal</p>\n\n<pre><code>&gt; isTrue# (reallyUnsafePtrEquality# (id ()) (id ()))\nFalse\n</code></pre>\n\n<p>But when compiling with optimisations this is <code>True</code>.</p>\n\n<p>Hopefully this is enough to convince you that what you want is a bad idea. One of the solutions in <a href=\"https://stackoverflow.com/questions/1717553/pointer-equality-in-haskell\">Pointer equality in Haskell?</a> would be a better.</p>\n"}], "owner": {"reputation": 25321, "user_id": 163177, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e811b5337bcad19d52c8fed3a0ea0075?s=128&d=identicon&r=PG", "display_name": "John F. Miller", "link": "https://stackoverflow.com/users/163177/john-f-miller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2215, "favorite_count": 0, "accepted_answer_id": 30176255, "answer_count": 1, "score": 1, "last_activity_date": 1431589322, "creation_date": 1431372163, "last_edit_date": 1431589322, "question_id": 30175974, "link": "https://stackoverflow.com/questions/30175974/haskell-function-to-check-if-two-values-are-identical", "title": "Haskell function to check if two values are identical", "body": "<p>In Haskell we have the function <code>(==) :: Eq a =&gt; a-&gt;a-&gt;Bool</code> which is fine for the large number of datatypes for which an instance of <code>Eq</code> can be defined.  However there are some types for which there is no reasonable way to define an instance of <code>Eq</code>.  one example is the simple function type <code>(a-&gt;b)</code></p>\n\n<p>I am looking for a function that will tell me if two values are actually the same -- not equal but identical.</p>\n\n<p>For example <code>f(id,id)</code> ==> <code>True</code>  <code>f((+),(-))</code> = False </p>\n\n<p><strong>Clarification:</strong></p>\n\n<p>I <em>don't</em> want to know if two function do the same thing. It is not possible in the general case to do so.  I want to know if I've gotten back the same thing I started with. Let me give a stripped down example:</p>\n\n<pre><code>data Foo = Foo (Foo-&gt;Foo)  --contains a function so no Eq instance\n\nx :: Foo\nx = Foo id -- or for that matter Foo undefined\n\ny :: Foo\ny = Foo (const x)\n\na :: Foo\na = let (Foo fy) = y\n     in fy x\n</code></pre>\n\n<p>It is clear that by inspection once evaluated, <code>a</code> will be <code>x</code>.  But let's assume I don't know the function in y but I want to test if the Foo I put in is the same one I got back - that is does <code>fy x</code> give me <code>x</code>. How do I do this?</p>\n"}, {"tags": ["haskell", "evaluation"], "comments": [{"owner": {"reputation": 204954, "user_id": 1903116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w6Ffg.jpg?s=128&g=1", "display_name": "thefourtheye", "link": "https://stackoverflow.com/users/1903116/thefourtheye"}, "edited": false, "score": 0, "creation_date": 1431367876, "post_id": 30174686, "comment_id": 48455447, "body": "Do you have any problem with the code?"}, {"owner": {"reputation": 109, "user_id": 4681752, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b20ddab2fd80116be9d04704f0a7a56f?s=128&d=identicon&r=PG&f=1", "display_name": "Programm-ist", "link": "https://stackoverflow.com/users/4681752/programm-ist"}, "reply_to_user": {"reputation": 204954, "user_id": 1903116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w6Ffg.jpg?s=128&g=1", "display_name": "thefourtheye", "link": "https://stackoverflow.com/users/1903116/thefourtheye"}, "edited": false, "score": 0, "creation_date": 1431368048, "post_id": 30174686, "comment_id": 48455539, "body": "@thefourtheye The code works fine but I am not sure if this line &#39;((\\x n-&gt;n+1) 4 (foldr  (\\x n-&gt;n+1) 0 [4])) + 1&#39; is correct or rather it should be &#39;((\\x n-&gt;n+1) 4 (foldr  (\\x n-&gt;n+1) 0 [])) + 1&#39;"}, {"owner": {"reputation": 204954, "user_id": 1903116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w6Ffg.jpg?s=128&g=1", "display_name": "thefourtheye", "link": "https://stackoverflow.com/users/1903116/thefourtheye"}, "edited": false, "score": 1, "creation_date": 1431368082, "post_id": 30174686, "comment_id": 48455562, "body": "Please edit the question and explain your intentions clearly."}, {"owner": {"reputation": 109, "user_id": 4681752, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b20ddab2fd80116be9d04704f0a7a56f?s=128&d=identicon&r=PG&f=1", "display_name": "Programm-ist", "link": "https://stackoverflow.com/users/4681752/programm-ist"}, "reply_to_user": {"reputation": 204954, "user_id": 1903116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w6Ffg.jpg?s=128&g=1", "display_name": "thefourtheye", "link": "https://stackoverflow.com/users/1903116/thefourtheye"}, "edited": false, "score": 2, "creation_date": 1431368229, "post_id": 30174686, "comment_id": 48455653, "body": "I just want to know if my evaluation is correct, if not then tell me where I am getting wrong."}], "answers": [{"tags": [], "owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "is_accepted": true, "score": 2, "last_activity_date": 1431373896, "creation_date": 1431373896, "answer_id": 30176464, "question_id": 30174686, "link": "https://stackoverflow.com/questions/30174686/haskell-expression-evaluation/30176464#30176464", "title": "haskell expression evaluation", "body": "<p>First of all we need the foldr implementation:</p>\n\n<pre><code>foldr f z []     = z \nfoldr f z (x:xs) = f x (foldr f z xs)\n</code></pre>\n\n<p>now let's try to \"trace\" our computation <code>f [1, 4]</code>:</p>\n\n<pre><code>f [1, 4]  -- rewrite list \nf (1:(4:[]))  -- replace f function where xs = (1:(4:[]))\nfoldr (\\x n-&gt; (+) n 1 ) 0 (1:(4:[])) \n\n-- using foldr f z (x:xs) = f x (foldr f z xs)\n-- where f = (\\x n -&gt; (+) n 1), z = 0, x = 1, xs = (4:[])\n(\\x n -&gt;(+) n 1) 1 ( foldr (\\x n -&gt; (+) n 1) 0 (4:[]))\n\n-- lambda function will be evaluated with x = 1, n = ( foldr (\\x n -&gt; n+1) 0 (4:[]))\n(+) (foldr (\\x n -&gt; n+1) 0 (4:[])) 1\n\n-- (+) will try to evaluate first parameter\n-- foldr will be applied with f = (\\x n -&gt; (+) n 1), z = 0,  x = 4, xs = []\n(+) ((\\x n -&gt; (+) n 1) 4 (foldr (\\x n -&gt; (+) n 1) 0 [] )) 1\n\n-- now again the lambda will be evaluated where x = 4 and n = (foldr (\\x n -&gt; (+) n 1) 0 [] )\n\n(+) ( (+) (foldr (\\x n -&gt; (+) n 1) 0 [] ) 1 ) 1\n\n--  now foldr will be evaluated again but this time first form will be used, so just z counts: f = (\\x n -&gt; (+) n 1), z = 0, [] = []\n(+) ( (+) ( 0 ) 1 ) 1\n\n-- now just go with the flow\n(+) ( (+) 0 1 ) 1\n(+) ( 1 ) 1\n(+) 1 1\n2\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 4681752, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b20ddab2fd80116be9d04704f0a7a56f?s=128&d=identicon&r=PG&f=1", "display_name": "Programm-ist", "link": "https://stackoverflow.com/users/4681752/programm-ist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 30176464, "answer_count": 1, "score": 0, "last_activity_date": 1431373896, "creation_date": 1431367775, "question_id": 30174686, "link": "https://stackoverflow.com/questions/30174686/haskell-expression-evaluation", "title": "haskell expression evaluation", "body": "<p>I am new to haskell and I would like you to give me your suggestion about the following haskell expression evaluation.</p>\n\n<pre><code>f xs = foldr (\\x n-&gt;n+1) 0 xs\n</code></pre>\n\n<p>function</p>\n\n<pre><code>f [1, 4]\n</code></pre>\n\n<p><strong>Evaluation</strong></p>\n\n<pre><code>(\\x n-&gt;n+1) 1 (foldr  (\\x n-&gt;n+1) 0 [4])\n= (foldr  (\\x n-&gt;n+1) 0 [4]) + 1\n= ((\\x n-&gt;n+1) 4 (foldr  (\\x n-&gt;n+1) 0 [4])) + 1\n= (foldr  (\\x n-&gt;n+1) 0 [] + 1) + 1\n= (0 + 1) + 1 \n= 1 + 1\n= 2\n</code></pre>\n"}, {"tags": ["haskell", "metaprogramming", "code-inspection"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1431360375, "post_id": 30172449, "comment_id": 48450996, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/2469139/equivalent-of-python-eval-in-haskell\">Equivalent of python eval in Haskell</a>"}, {"owner": {"reputation": 36134, "user_id": 493729, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bU0Kx.jpg?s=128&g=1", "display_name": "Peter Hall", "link": "https://stackoverflow.com/users/493729/peter-hall"}, "edited": false, "score": 6, "creation_date": 1431360579, "post_id": 30172449, "comment_id": 48451120, "body": "In Lisp, the distinction between data and code is blurred and everything is inspectable and dynamic at runtime. In Haskell, all types and binding names are erased at compile time, which allows for a huge amount of optimisation."}, {"owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "edited": false, "score": 1, "creation_date": 1431360758, "post_id": 30172449, "comment_id": 48451225, "body": "Perhaps you could explain why you want this? Depending on exactly what you&#39;re after, Template Haskell may or may not be able to help."}, {"owner": {"reputation": 645, "user_id": 2223605, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/f325a491aff2ce55a035c2a84888b10e?s=128&d=identicon&r=PG", "display_name": "v217", "link": "https://stackoverflow.com/users/2223605/v217"}, "edited": false, "score": 1, "creation_date": 1431367418, "post_id": 30172449, "comment_id": 48455162, "body": "@ MathematicalOrchid I think the question right now, reflects better what I want to do: print the name of a binding/identifier not the value. The name is known at compile time!"}, {"owner": {"reputation": 645, "user_id": 2223605, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/f325a491aff2ce55a035c2a84888b10e?s=128&d=identicon&r=PG", "display_name": "v217", "link": "https://stackoverflow.com/users/2223605/v217"}, "reply_to_user": {"reputation": 36134, "user_id": 493729, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bU0Kx.jpg?s=128&g=1", "display_name": "Peter Hall", "link": "https://stackoverflow.com/users/493729/peter-hall"}, "edited": false, "score": 0, "creation_date": 1431368108, "post_id": 30172449, "comment_id": 48455581, "body": "@PeterHall This seems to answer my question. Still strange, that there are no source inspection/debugging options. In ghci I have the command &quot;:bindings&quot;, which lists all bindings. For debbugging this is very useful."}, {"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "reply_to_user": {"reputation": 36134, "user_id": 493729, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/bU0Kx.jpg?s=128&g=1", "display_name": "Peter Hall", "link": "https://stackoverflow.com/users/493729/peter-hall"}, "edited": false, "score": 1, "creation_date": 1431380633, "post_id": 30172449, "comment_id": 48462288, "body": "@PeterHall: A Lisp function only receives references to the values of its arguments.  It doesn&#39;t know any more than a Haskell function does what identifiers the caller bound those values to (if any!)."}], "answers": [{"comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1431369769, "post_id": 30174672, "comment_id": 48456532, "body": "Of course the name is known at compile time... I think you meant to say something else but I&#39;m not quite sure what."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1431374650, "post_id": 30174672, "comment_id": 48459276, "body": "@ReidBarton Whoops, it&#39;s <i>run</i>time! Edited."}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 3, "last_activity_date": 1431375047, "last_edit_date": 1431375047, "creation_date": 1431367717, "answer_id": 30174672, "question_id": 30172449, "link": "https://stackoverflow.com/questions/30172449/how-can-one-print-the-name-of-an-identifier-or-binding-in-haskell/30174672#30174672", "title": "How can one print the name of an identifier or binding in Haskell?", "body": "<p>As @PeterHall said:</p>\n\n<blockquote>\n  <p>In Lisp, the distinction between data and code is blurred and everything is inspectable and dynamic at runtime. In Haskell, <strong>all types and binding names are erased at compile time</strong>, which allows for a huge amount of optimisation.</p>\n</blockquote>\n\n<p>In other words, <em>the name is <strong>not</strong> known at runtime.</em></p>\n\n<p>Furthermore, these are not <em>'variables'</em>, these are <em>constants</em>, or, as said before, <em>bindings</em>. For this reason, there is no point in being able to access the name of the binding, because it will never change.</p>\n\n<p>As @MathematicalOrchid suggested, there may be a template Haskell solution, though it may be only relatively useful.</p>\n\n<p>As for a better way of printing the bindings, try this:</p>\n\n<pre><code>import Control.Monad (forM_)\n\nviewAllConstants = forM_ (\\(a, b) -&gt; putStrLn (a ++ \" = \" ++ show b)) \n                   $ zip [\"c\", \"e\", \"eV\", \"h\", \"hbar\", \"nm\", \"k\"] \n                         [ c,   e,   eV,   h,   hbar,   nm,   k ]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": false, "score": 2, "last_activity_date": 1431376666, "creation_date": 1431376666, "answer_id": 30177202, "question_id": 30172449, "link": "https://stackoverflow.com/questions/30172449/how-can-one-print-the-name-of-an-identifier-or-binding-in-haskell/30177202#30177202", "title": "How can one print the name of an identifier or binding in Haskell?", "body": "<p>I think you're a bit confused about what you really want. The name of the identifier <code>c</code> is just <code>\"c\"</code>; there's no problem in printing that.</p>\n\n<p>I assume what you really want is to eliminate the duplication in your module between <code>[\"c\", \"e\", \"eV\", \"h\", \"hbar\", \"nm\", \"k\"]</code> and <code>[c,e,eV,h,hbar,nm,k]</code>. How, concretely, do you intend to do that? Then we can talk about whether it can or cannot work in Haskell.</p>\n\n<p>Probably it will come down to one or both of</p>\n\n<ol>\n<li><p>Lack of <code>eval</code>. If you keep the list <code>[\"c\", \"e\", \"eV\", \"h\", \"hbar\", \"nm\", \"k\"]</code>, you could hope to evaluate those strings to find out the values of the corresponding variables. While you could potentially embed a Haskell interpreter in your program, there is not necessarily any mapping at runtime of the names <code>\"c\"</code>, <code>\"e\"</code>, ... to their values, as has been pointed out by others, so you just cannot go from the string <code>\"c\"</code> to the value <code>2.99792458e8</code>.</p></li>\n<li><p>Referential transparency. You could keep the list <code>[c,e,eV,h,hbar,nm,k]</code> and hope for some magic way to recover the strings <code>\"c\"</code>, <code>\"e\"</code>, ... from it. But that is also impossible. <code>[c,e,eV,h,hbar,nm,k]</code> is just a list of Doubles and, since <code>c = 2.99792458e8</code>, we also have <code>[c,e,eV,h,hbar,nm,k] = [2.99792458e8,e,eV,h,hbar,nm,k]</code>, and there is no way to extract <code>\"c\"</code> from the latter.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 2, "last_activity_date": 1431380518, "creation_date": 1431380518, "answer_id": 30178125, "question_id": 30172449, "link": "https://stackoverflow.com/questions/30172449/how-can-one-print-the-name-of-an-identifier-or-binding-in-haskell/30178125#30178125", "title": "How can one print the name of an identifier or binding in Haskell?", "body": "<blockquote>\n  <p>Supose I want to print the name and the value of a \"variable\" in Haskell. The name is known at compile time! </p>\n</blockquote>\n\n<p>The name is known <strong>in some scopes</strong>, and not in others.  This is critical.  Let's look at your example code:</p>\n\n<pre><code>module V (e, c, eV, h, hbar, nm, k, viewAllConstants) where\n\nc = 2.99792458e8\ne = exp(1)\neV = 1.602176565e-19\nh = 6.62606957e-34\nhbar = h/(2*pi)\nnm = 1e-9\nk = 1.3806488e-23\n\nviewAllConstants = do\n    putStr (foldl (++) \"\" (map (\"\\n\" ++)\n                    ( zipWith (++) [\"c\", \"e\", \"eV\", \"h\", \"hbar\", \"nm\", \"k\"]\n                        (map ((\" = \" ++) . show) [c,e,eV,h,hbar,nm,k])\n                    )\n\n                )\n        )\n</code></pre>\n\n<p><code>putStr</code>, <code>foldl</code>, <code>map</code>, <code>zipWith</code> and <code>show</code> are functions defined in modules that come with GHC, and are compiled separately from your program.  These functions have no way of knowing the names of your variables\u2014all they get handed is their values.</p>\n\n<p>Note that contrary to Peter Hall's comment, this isn't a Haskell vs. Lisp difference.  In Lisp, the arguments to a procedure are passed by reference to the value, not to the symbol; a Lisp function doesn't any more know the names of its arguments than a Haskell one does.</p>\n\n<p>Also, you can pass arbitrary expressions as arguments to functions in both languages.  These are values that aren't bound to variables in the call site.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 2, "last_activity_date": 1431393442, "creation_date": 1431393442, "answer_id": 30180175, "question_id": 30172449, "link": "https://stackoverflow.com/questions/30172449/how-can-one-print-the-name-of-an-identifier-or-binding-in-haskell/30180175#30180175", "title": "How can one print the name of an identifier or binding in Haskell?", "body": "<p>You can do it! You just can't do it like you're thinking. Some language implementations use dictionaries to represent the environments in which expressions are evaluated. Some of the more foolish ones expose this mechanism to programmers. This is foolish because it prevents the implementors from switching to faster techniques in the future. Haskell does not do anything like that, except maybe in the type checker. But that doesn't stop you from building and using such dictionaries yourself!</p>\n\n<p>If you're dealing with a bunch of things of the same type, you're in luck\u2014you can use a <code>Map</code> or a trie to connect names with values. If you need things of various types, your life gets more complicated\u2014see <a href=\"http://hackage.haskell.org/package/HList-0.4.0.0/docs/Data-HList-Record.html\" rel=\"nofollow\">HList records</a> for example.</p>\n\n<p>All that said, I think you should think carefully about how much you really want this. It's kind of unusual.</p>\n"}], "owner": {"reputation": 645, "user_id": 2223605, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/f325a491aff2ce55a035c2a84888b10e?s=128&d=identicon&r=PG", "display_name": "v217", "link": "https://stackoverflow.com/users/2223605/v217"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 30180175, "answer_count": 4, "score": 2, "last_activity_date": 1431618790, "creation_date": 1431360274, "last_edit_date": 1431618790, "question_id": 30172449, "link": "https://stackoverflow.com/questions/30172449/how-can-one-print-the-name-of-an-identifier-or-binding-in-haskell", "title": "How can one print the name of an identifier or binding in Haskell?", "body": "<p>Supose I want to print the name and the value of a \"variable\" in Haskell. The name is known at compile time! Is there a better way than in the following example? </p>\n\n<pre><code>module V\n(e, c, eV, h, hbar, nm, k, viewAllConstants) where\nimport Text.Printf\nc = 2.99792458e8::Double\ne = exp(1)\neV = 1.602176565e-19\nh = 6.62606957e-34\nhbar = h/(2*pi)\nnm = 1e-9\nk = 1.3806488e-23\nviewAllConstants = do\n    putStr ((\\a b -&gt; (foldl (++) \"\" ( zipWith (++) a (map (printf \" = %.2e\\n\") b))))\n        [\"c\", \"e\", \"eV\", \"h\", \"hbar\", \"nm\", \"k\"]\n        [c, e, eV, h, hbar, nm, k] )\n</code></pre>\n\n<p>Please post a working code example (runhaskell) in your answer!</p>\n"}, {"tags": ["haskell", "module", "haskell-platform"], "comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1431355348, "post_id": 30170434, "comment_id": 48447279, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/8543039/cabal-build-dir-with-source\">Cabal: build dir with source</a>"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1431366815, "post_id": 30170434, "comment_id": 48454839, "body": "That doesn&#39;t seem a very good reason not to use Cabal. Seriously, for any project that&#39;s more than a single-file script, Cabal is absolutely the way to go; if your editor doesn&#39;t support it then just execute the commands in a seperate terminal. (But also consider switching to a better editor...)"}], "answers": [{"tags": [], "owner": {"reputation": 23816, "user_id": 572606, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c20a126ad0dce40e8fc4a43456107919?s=128&d=identicon&r=PG", "display_name": "shang", "link": "https://stackoverflow.com/users/572606/shang"}, "is_accepted": true, "score": 6, "last_activity_date": 1431355591, "creation_date": 1431355591, "answer_id": 30170775, "question_id": 30170434, "link": "https://stackoverflow.com/questions/30170434/how-can-i-tell-runhaskell-that-a-module-is-not-in-the-same-folder/30170775#30170775", "title": "How can I tell runhaskell that a module is not in the same folder?", "body": "<p>You can use the <code>-i</code> flag to define an include dir, for example</p>\n\n<pre><code>runhaskell -isrc MyModule\n</code></pre>\n\n<p>Also, if you have a .cabal-file in your project you can invoke <code>runhaskell</code> with the same source folder and package configuration via <code>cabal exec</code>:</p>\n\n<pre><code>cabal exec runhaskell -- MyModule\n</code></pre>\n"}], "owner": {"reputation": 645, "user_id": 2223605, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/f325a491aff2ce55a035c2a84888b10e?s=128&d=identicon&r=PG", "display_name": "v217", "link": "https://stackoverflow.com/users/2223605/v217"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 522, "favorite_count": 1, "accepted_answer_id": 30170775, "answer_count": 1, "score": 2, "last_activity_date": 1431355591, "creation_date": 1431354731, "last_edit_date": 1431355553, "question_id": 30170434, "link": "https://stackoverflow.com/questions/30170434/how-can-i-tell-runhaskell-that-a-module-is-not-in-the-same-folder", "title": "How can I tell runhaskell that a module is not in the same folder?", "body": "<p>I want to place a module in a different folder.\nIs there a possibility to tell in the import statement the path to the module?\nNote I don't want to use cabal, because in the editor I use, runhaskell is the default executable for haskell.</p>\n"}, {"tags": ["haskell", "types", "monads", "type-signature"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1431357054, "post_id": 30170279, "comment_id": 48448667, "body": "The type of monad is <code>m</code> and it doesn&#39;t change. What changes is the result type <code>b</code>."}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 15, "last_activity_date": 1431357576, "last_edit_date": 1431357576, "creation_date": 1431355232, "answer_id": 30170639, "question_id": 30170279, "link": "https://stackoverflow.com/questions/30170279/haskell-forever-type-signature/30170639#30170639", "title": "Haskell `forever` type signature", "body": "<p>The type signature of <code>forever</code> is crafted to suggest that its result runs forever. Specifically, there is no way to write an action of type <code>m b</code> (polymorphic in its return value) that terminates and yields a non-bottom value. An alternative way to suggest the same thing would be <code>forever' :: m a -&gt; m Void</code>.</p>\n\n<p>Another answer is to just say that this is the most general type available for the function as it's defined, so that's the one it was given.</p>\n\n<pre><code>Prelude&gt; let forever m = let x = m &gt;&gt; x in x\nPrelude&gt; :t forever\nforever :: Monad m =&gt; m a -&gt; m b\n</code></pre>\n\n<p>These days, it probably should be defined differently:</p>\n\n<pre><code>forever :: Applicative f =&gt; f a -&gt; f b\nforever a = let x = a *&gt; x in x\n</code></pre>\n"}], "owner": {"reputation": 949, "user_id": 1219515, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/64ce0ac7d44d2076d23b21ac62214970?s=128&d=identicon&r=PG", "display_name": "Maciej Goszczycki", "link": "https://stackoverflow.com/users/1219515/maciej-goszczycki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 381, "favorite_count": 0, "accepted_answer_id": 30170639, "answer_count": 1, "score": 13, "last_activity_date": 1431357576, "creation_date": 1431354317, "question_id": 30170279, "link": "https://stackoverflow.com/questions/30170279/haskell-forever-type-signature", "title": "Haskell `forever` type signature", "body": "<p>In Haskell why is type-signature of <code>forever</code></p>\n\n<pre><code>forever :: Monad m =&gt; m a -&gt; m b\n</code></pre>\n\n<p>Specifically why isn't it just <code>:: Monad m =&gt; m a -&gt; m a</code>?\nSurely the type of monad we are acting upon doesn't change half way through <code>forever</code>?</p>\n\n<p>A function such as:</p>\n\n<pre><code> forever' :: Monad m =&gt; m a -&gt; m a\n forever' = forever\n</code></pre>\n\n<p>seems to work exactly the same.</p>\n"}, {"tags": ["string", "haskell"], "comments": [{"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 10, "creation_date": 1431332607, "post_id": 30162735, "comment_id": 48432185, "body": "Does it help you if I tell you that <code>$ password</code> is the same as <code>(\\f -&gt; f password)</code>? Maybe you can work it out from there."}, {"owner": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "reply_to_user": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "edited": false, "score": 0, "creation_date": 1431333833, "post_id": 30162735, "comment_id": 48432865, "body": "@JoachimBreitner that&#39;s a cool shortcut!"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 15, "last_activity_date": 1431334536, "creation_date": 1431334536, "answer_id": 30163357, "question_id": 30162735, "link": "https://stackoverflow.com/questions/30162735/what-is-the-use-of-sign-in-string-manipulation-in-haskell/30163357#30163357", "title": "What is the use of &#39;$&#39; sign in String manipulation in Haskell?", "body": "<pre><code>all ($ password) requirements\n  where requirements = [minLength 15, any isUpper, any isLower, any isDigit]\n</code></pre>\n\n<p>By definition of <code>all</code>, the above is equivalent to</p>\n\n<pre><code>($ password) (minLength 15) &amp;&amp;\n($ password) (any isUpper) &amp;&amp;\n($ password) (any isLower) &amp;&amp;\n($ password) (any isDigit)\n</code></pre>\n\n<p>Now, in Haskell a so-called <em>section</em> <code>(+-*/ x)</code> stands for <code>(\\y -&gt; y +-*/ x)</code>, whatever is the operator <code>+-*/</code> (which is <code>$</code>, in your case). So, we obtain</p>\n\n<pre><code>(minLength 15 $ password) &amp;&amp;\n(any isUpper $ password) &amp;&amp;\n(any isLower $ password) &amp;&amp;\n(any isDigit $ password)\n</code></pre>\n\n<p>Finally, the operator <code>$</code> is defined like this: <code>f $ x = f x</code>, i.e. it is the function application operator. We further simplify the code above as:</p>\n\n<pre><code>minLength 15 password &amp;&amp;\nany isUpper password &amp;&amp;\nany isLower password &amp;&amp;\nany isDigit password\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 159, "user_id": 4878529, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PHCAd7dBxRQ/AAAAAAAAAAI/AAAAAAAAAR4/idA5SWFjVBo/photo.jpg?sz=128", "display_name": "dan9131", "link": "https://stackoverflow.com/users/4878529/dan9131"}, "edited": false, "score": 0, "creation_date": 1431409064, "post_id": 30163420, "comment_id": 48470813, "body": "Thanks!! Got it. Great explanation."}, {"owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "reply_to_user": {"reputation": 159, "user_id": 4878529, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PHCAd7dBxRQ/AAAAAAAAAAI/AAAAAAAAAR4/idA5SWFjVBo/photo.jpg?sz=128", "display_name": "dan9131", "link": "https://stackoverflow.com/users/4878529/dan9131"}, "edited": false, "score": 0, "creation_date": 1431439846, "post_id": 30163420, "comment_id": 48491747, "body": "@bunny9131 can you accept my answer as accepted ? or the other one ?"}], "tags": [], "owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "is_accepted": false, "score": 6, "last_activity_date": 1431410321, "last_edit_date": 1431410321, "creation_date": 1431334725, "answer_id": 30163420, "question_id": 30162735, "link": "https://stackoverflow.com/questions/30162735/what-is-the-use-of-sign-in-string-manipulation-in-haskell/30163420#30163420", "title": "What is the use of &#39;$&#39; sign in String manipulation in Haskell?", "body": "<p><code>$</code> means \"Function Application\" .</p>\n\n<pre><code>&gt; :t ($) \n($) :: (a -&gt; b) -&gt; a -&gt; b\n</code></pre>\n\n<p><code>$</code> can be used to provide a parameter to a function. In this case you use it to apply \"password\" to each function the \"requirements\" have and have type of:</p>\n\n<pre><code>-- because $ is infix, left and right param are the 1st and 2nd respectively\n-- partial apply with the right param will still need the left one (a-&gt;b)\n:t ( $ \"a\")    \n( $ \"a\") :: ([Char] -&gt; b) -&gt; b --where \"b\" is a bool in this case\n</code></pre>\n\n<p>seems familiar ?</p>\n\n<pre><code>:t (\\f -&gt; f \"a\")\n(\\f -&gt; f \"a\") :: ([Char] -&gt; b) -&gt; b\n</code></pre>\n\n<p><code>$ password</code> and <code>(\\f -&gt; f password)</code> have the same type and same behaviour: take a function and apply it over <code>a</code>.</p>\n\n<p>When you have to apply a function over a list, you just put the function alone.\nBut in this case you have to apply functions from a list to \"password\". If you omit <code>$</code> it will try to do \"password (any isLower)\" for example, which don't make any sense.</p>\n\n<p>But you can do it using a lambda like <code>all (\\f -&gt; f password) ...</code> to apply each function to <code>password</code> or you can do it with <code>$</code>.</p>\n"}], "owner": {"reputation": 159, "user_id": 4878529, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PHCAd7dBxRQ/AAAAAAAAAAI/AAAAAAAAAR4/idA5SWFjVBo/photo.jpg?sz=128", "display_name": "dan9131", "link": "https://stackoverflow.com/users/4878529/dan9131"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 411, "favorite_count": 2, "answer_count": 2, "score": 14, "last_activity_date": 1431410321, "creation_date": 1431332442, "last_edit_date": 1431334171, "question_id": 30162735, "link": "https://stackoverflow.com/questions/30162735/what-is-the-use-of-sign-in-string-manipulation-in-haskell", "title": "What is the use of &#39;$&#39; sign in String manipulation in Haskell?", "body": "<p>This code checks whether the given password is valid according to the constraints in the requirements</p>\n\n<pre><code>import Data.Char\n\nstrong :: String -&gt; Bool\nstrong password = all ($ password) requirements\n  where requirements = [minLength 15, any isUpper, any isLower, any isDigit] \n        minLength n str = n &lt;= length str  \n</code></pre>\n"}, {"tags": ["haskell", "aeson"], "answers": [{"comments": [{"owner": {"reputation": 2846, "user_id": 4347335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7e6f293a134a5defec74e12cae42cc?s=128&d=identicon&r=PG&f=1", "display_name": "cchalmers", "link": "https://stackoverflow.com/users/4347335/cchalmers"}, "edited": false, "score": 2, "creation_date": 1431338920, "post_id": 30161791, "comment_id": 48436167, "body": "Why not just use <code>Endo</code> instead of writing a misleading orphan? Also <code>_Object . ix k = key i</code>. Here&#39;s a more succinct version <code>extract ks = preview (alaf Endo foldMap key ks) . Object</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user3594595"}, "edited": false, "score": 0, "creation_date": 1431363436, "post_id": 30161791, "comment_id": 48452863, "body": "This is elegant but seems like overkill (possibly because I haven&#39;t learned lenses yet). Is there a simpler, possibly recursive solution to this?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user3594595"}, "reply_to_user": {"reputation": 2846, "user_id": 4347335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7e6f293a134a5defec74e12cae42cc?s=128&d=identicon&r=PG&f=1", "display_name": "cchalmers", "link": "https://stackoverflow.com/users/4347335/cchalmers"}, "edited": false, "score": 0, "creation_date": 1431363462, "post_id": 30161791, "comment_id": 48452884, "body": "@cchalmers Can you expand upon your suggestions in a new answer?"}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 2846, "user_id": 4347335, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb7e6f293a134a5defec74e12cae42cc?s=128&d=identicon&r=PG&f=1", "display_name": "cchalmers", "link": "https://stackoverflow.com/users/4347335/cchalmers"}, "edited": false, "score": 0, "creation_date": 1431373877, "post_id": 30161791, "comment_id": 48458873, "body": "@cchalmers I had the mistaken impression that <code>Endo</code> didn&#39;t work well with traversals/lenses."}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": true, "score": 0, "last_activity_date": 1431374812, "last_edit_date": 1431374812, "creation_date": 1431328996, "answer_id": 30161791, "question_id": 30160945, "link": "https://stackoverflow.com/questions/30160945/extract-nested-property-inside-aeson-object/30161791#30161791", "title": "Extract nested property inside Aeson object", "body": "<p>The following solution makes use of the <code>lens</code> and <code>lens-aeson</code> packages:</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-}\n\nimport Control.Lens (view,pre,ix)        -- from lens\nimport Control.Lens.Reified (ReifiedTraversal(..))\nimport Data.Aeson           -- from aeson\nimport Data.Aeson.Lens (_Object)  -- from lens-aeson\nimport Data.Text            -- form text\n\ninstance Monoid (ReifiedTraversal s s s s) where\n    mempty = Traversal id\n    mappend (Traversal t1) (Traversal t2) = Traversal (t1 . t2) \n\nextractProperty :: [Text] -&gt; Object -&gt; Maybe Value \nextractProperty keys o = \n    view (pre telescope) (Object o)\n  where\n    telescope = runTraversal $ foldMap (\\k -&gt; Traversal $ _Object . ix k) keys\n</code></pre>\n\n<p><code>ReifiedTraversal</code> is simply a newtype around a <code>Traversal</code>, we define a <code>Monoid</code> instance on it to allow easy composition of traversals that start and end in the same type (similar to how the <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/Data-Monoid.html#t:Endo\" rel=\"nofollow\"><code>Endo</code></a> monoid works).</p>\n\n<p>In our case, the traversal <code>_Object . ix k</code> goes from <code>Value</code> to <code>Value</code>. <a href=\"http://hackage.haskell.org/package/lens-4.9.1/docs/Control-Lens-At.html#v:ix\" rel=\"nofollow\"><code>ix</code></a> comes from <code>Control.Lens.At</code> and indexes on the map of properties of an <code>Object</code>.</p>\n\n<p>We extract the first result of the composed traversal (if it exists) with the <a href=\"http://hackage.haskell.org/package/lens-4.9.1/docs/Control-Lens-Fold.html#v:pre\" rel=\"nofollow\"><code>pre</code></a> function.</p>\n\n<p><strong>Edit:</strong> As @cchalmers mentions in his comment, there's no need to declare an orphan instance, it works fine just with <code>Endo</code>. Also <code>key k</code> is the same as <code>_Object . ix k</code>.</p>\n\n<p>Here's a version of <code>extractProperty</code> that doesn't use <code>lens</code> and instead relies on composing a list of kleisli arrows <code>Value -&gt; Maybe Value</code> using <code>foldr</code>:</p>\n\n<pre><code>import qualified Data.HashMap.Strict as HM\n\nextractProperty :: [T.Text] -&gt; Object -&gt; Maybe Value \nextractProperty keys o = telescope keys (Object o)\n  where\n    telescope = foldr (&gt;=&gt;) return . map maybeKey \n    maybeKey k v = case v of \n        Object o -&gt; HM.lookup k o  \n        _ -&gt; Nothing \n</code></pre>\n\n<p>Perhaps <code>lens</code> was a bit overkill in this case.</p>\n"}, {"tags": [], "owner": {"reputation": 29647, "user_id": 4999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae995fa03b218e7c27a608b5f14e68ae?s=128&d=identicon&r=PG", "display_name": "\u0141ukasz", "link": "https://stackoverflow.com/users/4999/%c5%81ukasz"}, "is_accepted": false, "score": 0, "last_activity_date": 1494016900, "creation_date": 1494016900, "answer_id": 43813457, "question_id": 30160945, "link": "https://stackoverflow.com/questions/30160945/extract-nested-property-inside-aeson-object/43813457#43813457", "title": "Extract nested property inside Aeson object", "body": "<p>Another approach, using monadic bind:</p>\n\n<pre><code>import Data.Text (Text)\nimport qualified Data.HashMap.Strict as HM\n\nextractProperty :: [Text] -&gt; Value -&gt; Maybe Value\nextractProperty []     v          = Just v\nextractProperty (k:ks) (Object o) = HM.lookup k o &gt;&gt;= prop ks\nextractProperty _      _          = Nothing\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user3594595"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 544, "favorite_count": 0, "accepted_answer_id": 30161791, "answer_count": 2, "score": 1, "last_activity_date": 1494016900, "creation_date": 1431325937, "question_id": 30160945, "link": "https://stackoverflow.com/questions/30160945/extract-nested-property-inside-aeson-object", "title": "Extract nested property inside Aeson object", "body": "<p>How can I get a nested property using <code>Data.Aeson</code>? </p>\n\n<p>For example, when decoding an arbitrary JSON string using <code>Value</code> like this: </p>\n\n<pre><code>decode \"{\\\"foo\\\":{\\\"bar0\\\":\\\"foobar0\\\",\n                  \\\"bar1\\\":\\\"foobar1\\\"}}\" :: Maybe Value\n</code></pre>\n\n<p>I end up with this:</p>\n\n<pre><code>Just (Object (fromList [(\"foo\",Object (fromList [(\"bar1\",String \"foobar1\"),(\"bar0\",String \"foobar0\")]))]))\n</code></pre>\n\n<p>Now, how can I write a function <code>[String] -&gt; Object -&gt; Maybe Value</code> that will extract the <code>Value</code>, if any, arrived at by following the provided list of properties? </p>\n\n<p>This function should be used like so:</p>\n\n<pre><code>extractProperty [\"foo\", \"bar0\"] (Object (fromList [(\"foo\",Object (fromList [(\"bar1\",String \"foobar1\"),(\"bar0\",String \"foobar0\")]))]))\n\n==&gt; Just (String \"foobar0\")\n\nextractProperty [\"foo\", \"bar0\", \"baz\"] (Object (fromList [(\"foo\",Object (fromList [(\"bar1\",String \"foobar1\"),(\"bar0\",String \"foobar0\")]))]))\n\n==&gt; Nothing\n</code></pre>\n"}, {"tags": ["haskell", "ghc"], "answers": [{"tags": [], "owner": {"reputation": 25144, "user_id": 477476, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Qf4TT.png?s=128&g=1", "display_name": "Cactus", "link": "https://stackoverflow.com/users/477476/cactus"}, "is_accepted": true, "score": 8, "last_activity_date": 1448591363, "last_edit_date": 1448591363, "creation_date": 1431326407, "answer_id": 30161052, "question_id": 30160457, "link": "https://stackoverflow.com/questions/30160457/can-a-haskell-ghc-self-report-its-gc-stats-live/30161052#30161052", "title": "Can a Haskell/GHC self-report its GC stats live?", "body": "<p>The GHC-specific module <code>GHC.Stats</code> provides a function <a href=\"http://hackage.haskell.org/package/base/docs/GHC-Stats.html#v:getGCStats\" rel=\"nofollow\"><code>getGCStats</code></a> whichs returns (in <code>IO</code>) various GC statistics:</p>\n\n<blockquote>\n<pre><code>getGCStats :: IO GCStats\n</code></pre>\n  \n  <p>Retrieves garbage collection and memory statistics as of the last\n  garbage collection. If you would like your statistics as recent as\n  possible, first run a <code>performGC</code>.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "edited": false, "score": 0, "creation_date": 1431332702, "post_id": 30162529, "comment_id": 48432234, "body": "That&#39;s definitely something I want to do! Thanks."}], "tags": [], "owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "is_accepted": false, "score": 10, "last_activity_date": 1431331701, "creation_date": 1431331701, "answer_id": 30162529, "question_id": 30160457, "link": "https://stackoverflow.com/questions/30160457/can-a-haskell-ghc-self-report-its-gc-stats-live/30162529#30162529", "title": "Can a Haskell/GHC self-report its GC stats live?", "body": "<p>If you integrate <a href=\"http://hackage.haskell.org/package/ekg\" rel=\"noreferrer\">ekg</a> into your server, you can access nice graphs and statistics about the runtime and even your own custom metrics via HTTP:</p>\n\n<p><img src=\"https://i.stack.imgur.com/FYapx.png\" alt=\"enter image description here\"></p>\n\n<p>(Image linked from <a href=\"https://ocharles.org.uk/blog/posts/2012-12-11-24-day-of-hackage-ekg.html\" rel=\"noreferrer\">Oliver Charles\u2019 blogpost on ekg</a>)</p>\n"}], "owner": {"reputation": 11062, "user_id": 296827, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/eMQgS.jpg?s=128&g=1", "display_name": "dsign", "link": "https://stackoverflow.com/users/296827/dsign"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "accepted_answer_id": 30161052, "answer_count": 2, "score": 9, "last_activity_date": 1448591363, "creation_date": 1431323514, "question_id": 30160457, "link": "https://stackoverflow.com/questions/30160457/can-a-haskell-ghc-self-report-its-gc-stats-live", "title": "Can a Haskell/GHC self-report its GC stats live?", "body": "<p>I'm thinking that having a server to self-report its memory usage would be handy. </p>\n\n<p>I have read the section on <a href=\"https://downloads.haskell.org/~ghc/7.10.1/docs/html/users_guide/prof-heap.html\" rel=\"noreferrer\">memory profiling</a> in the manual, but there are a few drawbacks with this:</p>\n\n<ul>\n<li>First this seems to give only post-mortem stats.</li>\n<li>There is an overhead associated with enabling profiling.</li>\n<li>I don't really need that much detail.</li>\n</ul>\n\n<p>So that's my question, how can one track the different sets of memory in a running program compiled by GHC?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 7872, "user_id": 440302, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e785baf6d4a2626b8649d5b538c51858?s=128&d=identicon&r=PG", "display_name": "Rufflewind", "link": "https://stackoverflow.com/users/440302/rufflewind"}, "is_accepted": true, "score": 6, "last_activity_date": 1431315986, "last_edit_date": 1431315986, "creation_date": 1431315181, "answer_id": 30159263, "question_id": 30159239, "link": "https://stackoverflow.com/questions/30159239/square-root-of-rational/30159263#30159263", "title": "Square Root of Rational", "body": "<p>You can use either the <a href=\"https://hackage.haskell.org/package/base/docs/Prelude.html#v:fromRational\"><code>fromRational</code></a>,</p>\n\n<pre><code>fromRational :: Fractional a =&gt; Rational -&gt; a\n</code></pre>\n\n<p>or the general-purpose <a href=\"https://hackage.haskell.org/package/base/docs/Prelude.html#v:realToFrac\"><code>realToFrac</code></a>,</p>\n\n<pre><code>realToFrac :: (Real a, Fractional b) =&gt; a -&gt; b\n</code></pre>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 537, "favorite_count": 0, "accepted_answer_id": 30159263, "answer_count": 1, "score": 4, "last_activity_date": 1431315986, "creation_date": 1431315015, "question_id": 30159239, "link": "https://stackoverflow.com/questions/30159239/square-root-of-rational", "title": "Square Root of Rational", "body": "<p>Given the following Rational:</p>\n\n<pre><code>Prelude&gt; x\n1 % 2\n</code></pre>\n\n<p>I tried to take its square root:</p>\n\n<pre><code>Prelude&gt; sqrt x\n\n&lt;interactive&gt;:14:1:\n    No instance for (Floating Rational) arising from a use of `sqrt'\n    In the expression: sqrt x\n    In an equation for `it': it = sqrt x\n</code></pre>\n\n<p>I read this Math conversion <a href=\"https://wiki.haskell.org/Converting_numbers#Converting_from_integers_and_between_integer_types\" rel=\"nofollow\">article</a>. But I did not see how to convert between Rational and Floating.</p>\n\n<p>How can I do this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 7, "creation_date": 1431314712, "post_id": 30159154, "comment_id": 48425467, "body": "You could &quot;concat&quot; the list to get <code>[a,c,e,b,d,f]</code>, and then print it. Ah, but that&#39;s the wrong order. It&#39;s printing the row-major order of your matrix, but you seek the column major order. If only there were a way to <a href=\"https://www.haskell.org/hoogle/?hoogle=transpose\" rel=\"nofollow noreferrer\">transpose</a> a matrix before you <a href=\"https://www.haskell.org/hoogle/?hoogle=concat\" rel=\"nofollow noreferrer\">concat</a>..."}], "answers": [{"tags": [], "owner": {"reputation": 1442, "user_id": 1329939, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e3625c1190e615af93c958522eec51e0?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/1329939/andrew"}, "is_accepted": false, "score": 0, "last_activity_date": 1431318994, "creation_date": 1431318994, "answer_id": 30159744, "question_id": 30159154, "link": "https://stackoverflow.com/questions/30159154/how-to-print-each-lists-values-in-haskell/30159744#30159744", "title": "How to print each lists values in Haskell", "body": "<pre><code>combine :: [a] -&gt; [a] -&gt; [a]\ncombine [] ys = ys\ncombine (x:xs) ys = x:combine ys xs\n\nmain :: IO ()\nmain = do\n    print (combine [1,3,5] [2,4,6])\n    return ()\n</code></pre>\n\n<p>outputs: [1,2,3,4,5,6]</p>\n"}, {"tags": [], "owner": {"reputation": 144, "user_id": 1808054, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/GLsdL.png?s=128&g=1", "display_name": "Ori", "link": "https://stackoverflow.com/users/1808054/ori"}, "is_accepted": false, "score": 1, "last_activity_date": 1431333776, "last_edit_date": 1431333776, "creation_date": 1431333289, "answer_id": 30162985, "question_id": 30159154, "link": "https://stackoverflow.com/questions/30159154/how-to-print-each-lists-values-in-haskell/30162985#30162985", "title": "How to print each lists values in Haskell", "body": "<p>How's the following</p>\n\n<pre><code>concat $ transpose [[1,2,3],[4,5,6]]\n</code></pre>\n\n<p>returns </p>\n\n<pre><code>[1,4,2,5,3,6]\n\nmapM_ (putStr . show) [1,4,3,5,3,6]\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4630228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68358a550e0b99bc863fc30360b4a34a?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Riccelli", "link": "https://stackoverflow.com/users/4630228/anthony-riccelli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1431333776, "creation_date": 1431314251, "last_edit_date": 1431317946, "question_id": 30159154, "link": "https://stackoverflow.com/questions/30159154/how-to-print-each-lists-values-in-haskell", "title": "How to print each lists values in Haskell", "body": "<p>I have a list of lists like <code>[[a,c,e],[b,d,f]]</code> and I was wondering how to print out every value from the lists, one at a time from each list.</p>\n\n<p>The order I want when I print is <code>abcdef</code>.</p>\n\n<p>I've been thinking about this for a while but I can't seem to figure it out.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 0, "creation_date": 1431313711, "post_id": 30158737, "comment_id": 48425254, "body": "<code>type</code> creates a <i>synonym</i>, not a new type. Tuples are already a <code>Read</code> instance."}], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 6, "last_activity_date": 1431312151, "creation_date": 1431312151, "answer_id": 30158917, "question_id": 30158737, "link": "https://stackoverflow.com/questions/30158737/can-i-easily-make-my-tuple-type-synonym-an-instance-of-read/30158917#30158917", "title": "Can I easily make my tuple type synonym an instance of Read?", "body": "<p>Have you just <em>tried it</em>?</p>\n\n<p>The answer is: yes, the tuple instance is used, there's no need to do anything at all yourself because <code>Coordinate</code> isn't even a different type &ndash; it's just a \u201chard link\u201d to the same type <code>(Int,Int)</code>, with all the same functions and class instances.</p>\n"}, {"tags": [], "owner": {"reputation": 936, "user_id": 4884579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0fca1fac3b94fed8f0291116e9b4ef6?s=128&d=identicon&r=PG&f=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/4884579/erik"}, "is_accepted": true, "score": 2, "last_activity_date": 1431312770, "creation_date": 1431312770, "answer_id": 30158985, "question_id": 30158737, "link": "https://stackoverflow.com/questions/30158737/can-i-easily-make-my-tuple-type-synonym-an-instance-of-read/30158985#30158985", "title": "Can I easily make my tuple type synonym an instance of Read?", "body": "<pre><code>type Coordinate = (Int, Int)\nhome = read \"(1,2)\" :: Coordinate\nschool = read \"(10,4)\" :: Coordinate\n</code></pre>\n"}], "owner": {"reputation": 1442, "user_id": 1329939, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/e3625c1190e615af93c958522eec51e0?s=128&d=identicon&r=PG", "display_name": "Andrew", "link": "https://stackoverflow.com/users/1329939/andrew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 30158985, "answer_count": 2, "score": -1, "last_activity_date": 1431312770, "creation_date": 1431310452, "question_id": 30158737, "link": "https://stackoverflow.com/questions/30158737/can-i-easily-make-my-tuple-type-synonym-an-instance-of-read", "title": "Can I easily make my tuple type synonym an instance of Read?", "body": "<p>I have a type synonym declared for the tuple of two Ints:</p>\n\n<pre><code>type Coordinate = (Int, Int)\n</code></pre>\n\n<p>I'd like to read in Coordinates as part of an IO Action, which boils down to using the read function.  Is there a way to leverage the existing Read instance of Tuples to accomplish this?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 5, "last_activity_date": 1431310342, "creation_date": 1431310342, "answer_id": 30158718, "question_id": 30158631, "link": "https://stackoverflow.com/questions/30158631/why-my-haskell-program-is-too-slow/30158718#30158718", "title": "Why my haskell program is too slow?", "body": "<p>If you change the definition of <code>g</code> to:</p>\n\n<pre><code>g::Int-&gt;Int\ng 4=13\ng n=x+n `gcd` x\n  where x = g (n-1)\n</code></pre>\n\n<p>then I get acceptable run times even under <code>ghci</code> or <code>runhaskell</code> (as opposed to <code>ghc -O2</code>.)</p>\n"}, {"comments": [{"owner": {"reputation": 155, "user_id": 2427168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17c9fa664fa34bf3c682a48b90c887a5?s=128&d=identicon&r=PG", "display_name": "Maddy", "link": "https://stackoverflow.com/users/2427168/maddy"}, "edited": false, "score": 0, "creation_date": 1431311016, "post_id": 30158719, "comment_id": 48424674, "body": "Why my code is not memoizied? Only my guess is haskell tried to compute g parallelly so it takes exponential time. Is that right?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 155, "user_id": 2427168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17c9fa664fa34bf3c682a48b90c887a5?s=128&d=identicon&r=PG", "display_name": "Maddy", "link": "https://stackoverflow.com/users/2427168/maddy"}, "edited": false, "score": 7, "creation_date": 1431313147, "post_id": 30158719, "comment_id": 48425122, "body": "@Maddy It is a common, but baffling, misconception that Haskell automatically memoizes.  No other language (more accurately: compiler) I know of does so and Haskell (GHC) is not so vastly different as many articles might lead you to believe."}], "tags": [], "owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "is_accepted": true, "score": 7, "last_activity_date": 1431310350, "creation_date": 1431310350, "answer_id": 30158719, "question_id": 30158631, "link": "https://stackoverflow.com/questions/30158631/why-my-haskell-program-is-too-slow/30158719#30158719", "title": "Why my haskell program is too slow?", "body": "<blockquote>\n  <p>it takes only O(n) for each g(n)</p>\n</blockquote>\n\n<p>Not exactly. In your recursive case</p>\n\n<blockquote>\n<pre><code>g n=g (n-1)+n `gcd` g(n-1)\n</code></pre>\n</blockquote>\n\n<p>you are calling <code>g</code> <em>twice</em>. Which means you are getting exponential runtime actually (<code>O(2<sup>n</sup>)</code>).</p>\n\n<p>To make sure that <code>g (n-1)</code> is evaluated only once in each step, use a <code>let</code> or <code>where</code> statement so that you can refer to a single value - the result of the one call - twice.</p>\n\n<pre><code>g :: Int -&gt; Int\ng 4 = 13\ng n = let r = g (n-1)\n      in r + n `gcd` r\n</code></pre>\n\n<blockquote>\n  <p>when I tried this code in ideone, it's fine, but in my computer it's not. Is that haskell version problem?</p>\n</blockquote>\n\n<p>Possibly, although rather an optimisation level parameter problem. Haskell's compiler can optimise functions such as yours when it detects that an expression (like <code>g (n-1)</code>) appears twice, but searching for these is costly and needs to be enabled.</p>\n"}], "owner": {"reputation": 155, "user_id": 2427168, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17c9fa664fa34bf3c682a48b90c887a5?s=128&d=identicon&r=PG", "display_name": "Maddy", "link": "https://stackoverflow.com/users/2427168/maddy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 30158719, "answer_count": 2, "score": 0, "last_activity_date": 1431310350, "creation_date": 1431309537, "last_edit_date": 1431310008, "question_id": 30158631, "link": "https://stackoverflow.com/questions/30158631/why-my-haskell-program-is-too-slow", "title": "Why my haskell program is too slow?", "body": "<p>I tried to solve Problem 443 on ProjectEuler, <a href=\"https://projecteuler.net/problem=443\" rel=\"nofollow\">https://projecteuler.net/problem=443</a>.</p>\n\n<p>To find pattern of g, I simply implemented g in Haskell as</p>\n\n<pre><code>g::Int-&gt;Int\ng 4=13\ng n=g (n-1)+n `gcd` g(n-1)\n</code></pre>\n\n<p>But computing list <code>t=[g i|i&lt;-[4..100]]</code> takes much more than 1 second.\nWhy this happens? Even without memoization, it takes only O(n) for each g(n).</p>\n\n<p>Edit: when I tried this code in ideone, it's fine, but in my computer it's not. Is that haskell version problem? I'm using version ghc 7.8.3 on Windows, while ideone using ghc 7.6.</p>\n"}, {"tags": ["string", "haskell", "dictionary", "words"], "comments": [{"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 0, "creation_date": 1431305304, "post_id": 30158143, "comment_id": 48423508, "body": "I don&#39;t understand why <code>map words</code> is not what you want.  Can you give an example?"}, {"owner": {"reputation": 224, "user_id": 2538263, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c2ed191e73527fa2db7d98c3696b20ba?s=128&d=identicon&r=PG", "display_name": "Birdie", "link": "https://stackoverflow.com/users/2538263/birdie"}, "reply_to_user": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 0, "creation_date": 1431309433, "post_id": 30158143, "comment_id": 48424370, "body": "I was getting an error which appeared to point to <code>map words</code> not working; however, after further analysis at the prompting of the answers, I discovered that my initial analysis of the cause of the error was not in fact <code>map words</code>. Thanks everyone for your help!"}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1431315204, "post_id": 30158197, "comment_id": 48425580, "body": "No need to special case the empty list. We already have <code>map words [] = []</code>."}], "tags": [], "owner": {"reputation": 52334, "user_id": 702638, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/892f65bc0a8a0949ab88598de7d83cab?s=128&d=identicon&r=PG", "display_name": "Hunter McMillen", "link": "https://stackoverflow.com/users/702638/hunter-mcmillen"}, "is_accepted": false, "score": 2, "last_activity_date": 1431305327, "creation_date": 1431305327, "answer_id": 30158197, "question_id": 30158143, "link": "https://stackoverflow.com/questions/30158143/split-list-of-strings-into-list-of-lists-of-strings/30158197#30158197", "title": "Split list of strings into list of lists of strings", "body": "<p>I am not sure I understand, you can use <code>map</code> and <code>words</code> to produce such a result:</p>\n\n<pre><code>GHCi, version 7.10.1: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; let { splitWords [] = []; splitWords ws = map words ws }\nPrelude&gt; splitWords []\n[]\nPrelude&gt; splitWords [\"first sentence\", \"second sentence\"]\n[[\"first\",\"sentence\"],[\"second\",\"sentence\"]]\nPrelude&gt; \n</code></pre>\n\n<p>I think the important thing to take away here is just because map expects <code>(a -&gt; b) -&gt; [a] -&gt; [b]</code> doesn't mean that <code>b</code> has to be the same type as <code>a</code>. Here <code>a</code> is a String and <code>b</code> is a <code>[String]</code></p>\n"}, {"tags": [], "owner": {"reputation": 936, "user_id": 4884579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0fca1fac3b94fed8f0291116e9b4ef6?s=128&d=identicon&r=PG&f=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/4884579/erik"}, "is_accepted": true, "score": 3, "last_activity_date": 1431305459, "creation_date": 1431305459, "answer_id": 30158216, "question_id": 30158143, "link": "https://stackoverflow.com/questions/30158143/split-list-of-strings-into-list-of-lists-of-strings/30158216#30158216", "title": "Split list of strings into list of lists of strings", "body": "<p>The type signature of 'map' is </p>\n\n<pre><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]\n</code></pre>\n\n<p>The type signature of 'words' is</p>\n\n<pre><code>words :: String -&gt; [String]\n</code></pre>\n\n<p>Therefore, the type signature of 'map words' is</p>\n\n<pre><code>map words :: [String] -&gt; [[String]]\n</code></pre>\n\n<p>Hey, that's exactly what you want! Let's give it a try.</p>\n\n<pre><code>map words [\"hello world\",\"stack exchange\"]\n</code></pre>\n\n<p>outputs:</p>\n\n<pre><code>[[\"hello\",\"world\"],[\"stack\",\"exchange\"]]\n</code></pre>\n"}], "owner": {"reputation": 224, "user_id": 2538263, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c2ed191e73527fa2db7d98c3696b20ba?s=128&d=identicon&r=PG", "display_name": "Birdie", "link": "https://stackoverflow.com/users/2538263/birdie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 935, "favorite_count": 0, "accepted_answer_id": 30158216, "answer_count": 2, "score": -1, "last_activity_date": 1431305459, "creation_date": 1431304768, "question_id": 30158143, "link": "https://stackoverflow.com/questions/30158143/split-list-of-strings-into-list-of-lists-of-strings", "title": "Split list of strings into list of lists of strings", "body": "<p>I have a list of strings. I want to split each of the strings on space, e.g. using <code>words</code>, resulting in a list of lists of strings. Unfortunately I can't use <code>map words myList</code> because map expects [a] -> [b], whereas I want [a] -> [[b]]. How would I go about this?</p>\n\n<p>The other option off the top of my head is a recursive function where I split off the head string from my original list, <code>words</code> it and then analyse the result there and then, but I was trying to do it with pre-existing functions and a one-liner.</p>\n"}, {"tags": ["haskell", "io", "gtk2hs"], "answers": [{"tags": [], "owner": {"reputation": 936, "user_id": 4884579, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b0fca1fac3b94fed8f0291116e9b4ef6?s=128&d=identicon&r=PG&f=1", "display_name": "Erik", "link": "https://stackoverflow.com/users/4884579/erik"}, "is_accepted": true, "score": 4, "last_activity_date": 1431306845, "creation_date": 1431306845, "answer_id": 30158380, "question_id": 30158064, "link": "https://stackoverflow.com/questions/30158064/gtk2hs-couldnt-match-expected-type-io-int-with-actual-type-int/30158380#30158380", "title": "gtk2hs: Couldn&#39;t match expected type \u2018IO [Int]\u2019 with actual type \u2018[Int]\u2019", "body": "<p>Do-notation is syntactic sugar for a series of bind operations. With that in mind, it makes sense that every line in your do-block needs to be of type 'IO' because that is how you defined your function. </p>\n\n<p>Try changing the following line</p>\n\n<pre><code>mesg &lt;- \" is the first element of input text\" ++ txt\n</code></pre>\n\n<p>to</p>\n\n<pre><code>let mesg = \" is the first element of input text\" ++ txt\n</code></pre>\n\n<p>(which is also equivalent to)</p>\n\n<pre><code>mesg &lt;- return \" is the first element of input text\" ++ txt\n</code></pre>\n\n<p>That should fix the issue you have on that particular line. And it makes even more sense if we look at the type signature of the 'return' function:</p>\n\n<pre><code>Monad m =&gt; a -&gt; m a\n</code></pre>\n\n<p>This says, \"supply an 'a', and I will give you an 'a' wrapped inside a monad\" (in this case the IO monad)</p>\n\n<p>I hope this helps a bit.</p>\n"}], "owner": {"reputation": 35, "user_id": 3470406, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/183bc2a62c1339e81dedb2acc6fe1537?s=128&d=identicon&r=PG&f=1", "display_name": "user3470406", "link": "https://stackoverflow.com/users/3470406/user3470406"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2895, "favorite_count": 0, "accepted_answer_id": 30158380, "answer_count": 1, "score": -2, "last_activity_date": 1431306845, "creation_date": 1431304130, "question_id": 30158064, "link": "https://stackoverflow.com/questions/30158064/gtk2hs-couldnt-match-expected-type-io-int-with-actual-type-int", "title": "gtk2hs: Couldn&#39;t match expected type \u2018IO [Int]\u2019 with actual type \u2018[Int]\u2019", "body": "<p>everyone\nI want to get a list of numbers from GUI to do some changes by using gtk2hs, and return the result to GUI. However, it got lots of error. I'm a rookie of Haskell, could someone tell me how to fix it. Thanks!!</p>\n\n<pre><code>import Graphics.UI.Gtk\nimport Data.List \n\nmain :: IO ()\nmain= do\n  initGUI\n  window &lt;- windowNew\n  set window [windowTitle := \"Text Entry\", containerBorderWidth := 10]\n\n  vb &lt;- vBoxNew False 0\n  containerAdd window vb\n\n  hb &lt;- hBoxNew False 0\n  boxPackStart vb hb PackNatural 0\n\n  txtfield &lt;- entryNew\n  boxPackStart hb txtfield PackNatural 5\n  button &lt;- buttonNewFromStock stockInfo\n  boxPackStart hb button PackNatural 0\n\n  txtstack &lt;- statusbarNew\n  boxPackStart vb txtstack PackNatural 0\n  id &lt;- statusbarGetContextId txtstack \"Line\"\n\n  widgetShowAll window\n  widgetSetSensitivity button False\n\n  onEntryActivate txtfield (saveText txtfield button txtstack id)\n  onPressed button (statusbarPop txtstack id)\n  onDestroy window mainQuit\n  mainGUI\n\n  saveText :: Entry -&gt; Button -&gt; Statusbar -&gt; ContextId -&gt; IO ()\n  saveText fld b stk id = do\n                        txt &lt;- entryGetText fld\n                        result &lt;- convert txt\n                        lt &lt;- first resultt\n                        result2 &lt;- combineTogether lt\n                        mesg &lt;-  \" is the first element of input text\" ++ txt\n\n                        widgetSetSensitivity b True\n                        msgid &lt;- statusbarPush stk id mesg\n                        return ()\nconvert :: [Int] -&gt; IO [Int]\nconvert lstr = map read $ words lstr :: [Int]\n\nconverttoStr lst = map show lst \n\ncombineTogether :: [Int] -&gt; IO[Char]\ncombineTogether lst = intercalate \" \" (converttoStr lst)\n\nfirst :: [Int] -&gt; IO [Int]\nfirst (x:xs) = xs\n</code></pre>\n\n<p>Here are the error message:</p>\n\n<pre><code>[1 of 1] Compiling Main             ( testproject.hs, testproject.o )\n\ntestproject.hs:39:38:\nCouldn't match type \u2018[]\u2019 with \u2018IO\u2019\nExpected type: IO Char\n  Actual type: [Char]\nIn a stmt of a 'do' block:\n  mesg &lt;- \" is the first element of input text\" ++ txt\nIn the expression:\n  do { txt &lt;- entryGetText fld;\n       result &lt;- convert txt;\n       lt &lt;- first result;\n       result2 &lt;- combineTogether lt;\n       .... }\nIn an equation for \u2018saveText\u2019:\n    saveText fld b stk id\n      = do { txt &lt;- entryGetText fld;\n             result &lt;- convert txt;\n             lt &lt;- first result;\n             .... }\n\ntestproject.hs:39:79:\nCouldn't match type \u2018Int\u2019 with \u2018Char\u2019\nExpected type: [Char]\n  Actual type: [Int]\nIn the second argument of \u2018(++)\u2019, namely \u2018txt\u2019\nIn a stmt of a 'do' block:\n  mesg &lt;- \" is the first element of input text\" ++ txt\n\ntestproject.hs:48:16:\nCouldn't match expected type \u2018IO [Int]\u2019 with actual type \u2018[Int]\u2019\nIn the expression: map read $ words lstr :: [Int]\nIn an equation for \u2018convert\u2019:\n    convert lstr = map read $ words lstr :: [Int]\n\ntestproject.hs:48:33:\nCouldn't match type \u2018Int\u2019 with \u2018Char\u2019\nExpected type: String\n  Actual type: [Int]\nIn the first argument of \u2018words\u2019, namely \u2018lstr\u2019\nIn the second argument of \u2018($)\u2019, namely \u2018words lstr\u2019\n\ntestproject.hs:51:23:\nCouldn't match expected type \u2018IO [Char]\u2019 with actual type \u2018[Char]\u2019\nIn the expression: intercalate \" \" (converttoStr lst)\nIn an equation for \u2018combineTogether\u2019:\n    combineTogether lst = intercalate \" \" (converttoStr lst)\n\ntestproject.hs:54:16:\nCouldn't match expected type \u2018IO [Int]\u2019 with actual type \u2018[Int]\u2019\nIn the expression: xs\nIn an equation for \u2018first\u2019: first (x : xs) = xs\n</code></pre>\n"}, {"tags": ["haskell", "ghc"], "answers": [{"comments": [{"owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "edited": false, "score": 0, "creation_date": 1431294547, "post_id": 30156704, "comment_id": 48421070, "body": "what is the use of &quot;data IntList = Empty | Cons Int IntList&quot; as &quot;data IntList = Empty | Cons Int&quot; is same data type ?"}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "reply_to_user": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "edited": false, "score": 1, "creation_date": 1431295171, "post_id": 30156704, "comment_id": 48421238, "body": "@blue-sky The use it that it can represent lists of arbitrary sizes by nesting multiple cons cells. The latter definition would only allow list of zero or one elements."}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 3, "last_activity_date": 1431292272, "creation_date": 1431292272, "answer_id": 30156704, "question_id": 30156681, "link": "https://stackoverflow.com/questions/30156681/how-to-implement-recursive-function/30156704#30156704", "title": "How to implement recursive function?", "body": "<p>A <code>Cons</code> cell contains two things: an element and a tail. If the list is only supposed to contain one element, the tail is empty (represented by the nullary constructor <code>Empty</code>). So to represent a list containing 3 as its only element, you use:</p>\n\n<pre><code>let x = Cons 3 Empty\n</code></pre>\n\n<p>Then <code>:t x</code> will be <code>IntList</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "edited": false, "score": 0, "creation_date": 1431335399, "post_id": 30162987, "comment_id": 48433867, "body": "so for the statement &quot;data IntList = Empty | Cons Int IntList&quot; , specificall the &quot;data IntList&quot; section defines the return type for each of the constructors, in this case IntList ?"}, {"owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "reply_to_user": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "edited": false, "score": 1, "creation_date": 1431338133, "post_id": 30162987, "comment_id": 48435611, "body": "@blue-sky exactly, data IntList is the return and Const Int IntList is a function &quot;Const&quot; which takes 2 params &quot;Int&quot; and &quot;IntList&quot; and return an IntList (because of data IntList)"}], "tags": [], "owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "is_accepted": false, "score": 1, "last_activity_date": 1431333295, "creation_date": 1431333295, "answer_id": 30162987, "question_id": 30156681, "link": "https://stackoverflow.com/questions/30156681/how-to-implement-recursive-function/30162987#30162987", "title": "How to implement recursive function?", "body": "<p>You are creating a new data type:</p>\n\n<p><code>data IntList = Empty | Cons Int IntList</code></p>\n\n<p>This basically create you 2 data contructor function:</p>\n\n<pre><code>&gt; :t Empty\nEmpty :: IntList\n\n&gt; :t Cons\nCons :: Int -&gt; IntList -&gt; IntList\n</code></pre>\n\n<p>So the first returns an IntList type and the second need 2 parameters ( Int and IntList) and return an IntList.</p>\n\n<p>In your binding you just partially apply <code>Cons</code> function, giving it just 1 param :</p>\n\n<pre><code>*Main&gt; let x = Cons 3\n</code></pre>\n\n<p>and this is asking you for another IntList to be a complete type.\nNow, you can obtain an IntList in 2 ways (because you have 2 constructors for this type):</p>\n\n<pre><code>Cons 3 (Empty)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Cons 3 (Cons a b) --where a is an Int and b is IntList.\n</code></pre>\n\n<p>Now for the second, b can be Empty or Const a' b':</p>\n\n<pre><code>Cons 3 (Cons 1 (Empty))\n</code></pre>\n\n<p>or</p>\n\n<pre><code>Cons 3 (Cons 2 (Cons 1 (Empty))) -- 3 2 1 could be any Int number.\n</code></pre>\n\n<p>Let's now take a closer at type of the second one:</p>\n\n<pre><code>Cons Int ( Cons Int ( Cons Int ( IntList)))\n</code></pre>\n\n<p>Remember Cons takes an Int and an IntList and returns an IntList ? </p>\n\n<pre><code>Cons Int ( Cons Int ( IntList)) --Now doing the same we came up to\nCons Int (IntList) -- Once more\nIntList \n</code></pre>\n\n<p>That means our construction <code>Cons 3 (Cons 2 (Cons 1 (Empty)))</code> have type of <code>IntList</code> and can be used to apply <code>intListProd</code> computation over it.</p>\n"}], "owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 30156704, "answer_count": 2, "score": 0, "last_activity_date": 1431333295, "creation_date": 1431292069, "question_id": 30156681, "link": "https://stackoverflow.com/questions/30156681/how-to-implement-recursive-function", "title": "How to implement recursive function?", "body": "<p>Below defines an Algebraic Data Type IntList : </p>\n\n<pre><code>data IntList = Empty | Cons Int IntList\n</code></pre>\n\n<p>The function intListProd computes the product of IntList type : </p>\n\n<pre><code>intListProd :: IntList -&gt; Int\nintListProd Empty      = 1\nintListProd (Cons x l) = x * intListProd l\n</code></pre>\n\n<p>But I'm unsure how to create IntList type.</p>\n\n<p>I've tried :</p>\n\n<pre><code>*Main&gt; let x = Cons 3\n*Main&gt; :t x\nx :: IntList -&gt; IntList\n</code></pre>\n\n<p>But how to create type IntList so as to invoke intListProd ?</p>\n"}, {"tags": ["haskell", "ghci"], "answers": [{"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 5, "last_activity_date": 1431290243, "last_edit_date": 1431290243, "creation_date": 1431289653, "answer_id": 30156303, "question_id": 30156255, "link": "https://stackoverflow.com/questions/30156255/when-are-brackets-required-for-pattern-matching/30156303#30156303", "title": "When are brackets required for pattern matching?", "body": "<pre><code>getAge Person \"a\" 1 Cabbage\n</code></pre>\n\n<p>is parsed as</p>\n\n<pre><code>(((getAge Person) \"a\") 1) Cabbage\n</code></pre>\n\n<p>i.e. this would have to be a function accepting a <code>Person</code>-<em>constructor</em> and three more arguments, not a function accepting a single <code>Person</code>-<em>value</em>.</p>\n\n<p>Why it's <a href=\"https://en.wikipedia.org/wiki/Currying\" rel=\"nofollow\">done this way</a>? Well, it makes multi-parameter functions much nicer. For instance, <code>Person</code> itself is a function, taking three arguments (the data type's fields). If Haskell didn't just feed arguments one-by-one, you would also need to write <code>Person (\"Brent\", 31, Sealingwax)</code>.</p>\n\n<p>The parsing rules Haskell uses are actually much simpler than in most other languages, and they allow <em>partial application</em> very naturally, which is really useful. For instance,</p>\n\n<blockquote>\n  <p>GHCi> map (Person \"Brent\" 31) [Cabbage, SealingWax]<br>\n  [Person \"Brent\" 31 Cabbage, Person \"Brent\" 31 SealingWax]</p>\n</blockquote>\n"}], "owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 30156303, "answer_count": 1, "score": 0, "last_activity_date": 1431290243, "creation_date": 1431289283, "question_id": 30156255, "link": "https://stackoverflow.com/questions/30156255/when-are-brackets-required-for-pattern-matching", "title": "When are brackets required for pattern matching?", "body": "<p>Using this code : </p>\n\n<pre><code>-- Store a person's name, age, and favourite Thing.\ndata Person = Person String Int Thing\n  deriving Show\n\nbrent :: Person\nbrent = Person \"Brent\" 31 SealingWax\n\nstan :: Person\nstan  = Person \"Stan\" 94 Cabbage\n\ngetAge :: Person -&gt; Int\ngetAge (Person _ a _) = a\n</code></pre>\n\n<p>to access age of stan use : </p>\n\n<pre><code>getAge stan\n</code></pre>\n\n<p>prints : \n94</p>\n\n<p>Defining stan does not require brackets.</p>\n\n<p>However <code>getAge Person \"a\" 1 Cabbage</code> causes error : </p>\n\n<pre><code>&lt;interactive&gt;:60:8:\n    Couldn't match expected type `Person'\n                with actual type `String -&gt; Int -&gt; Thing -&gt; Person'\n    Probable cause: `Person' is applied to too few arguments\n    In the first argument of `getAge', namely `Person'\n    In the expression: getAge Person \"a\" 1 Cabbage\n</code></pre>\n\n<p>I need to use brackets : </p>\n\n<pre><code>*Main&gt; getAge (Person \"a\" 1 Cabbage)\n1\n</code></pre>\n\n<p>Why are brackets required in this case ? But when defining <code>stan  = Person \"Stan\" 94 Cabbage</code> does not require brackets ?</p>\n"}, {"tags": ["list", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1431287455, "post_id": 30155697, "comment_id": 48419023, "body": "<code>lookup</code>: <a href=\"https://www.haskell.org/hoogle/?hoogle=Eq+a+%3D%3E+a+-%3E+%5B%28a%2C+b%29%5D+-%3E+b\" rel=\"nofollow noreferrer\">haskell.org/hoogle/&hellip;</a>"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 7, "last_activity_date": 1431285709, "creation_date": 1431285709, "answer_id": 30155697, "question_id": 30155607, "link": "https://stackoverflow.com/questions/30155607/how-to-get-an-element-in-a-haskell-list/30155697#30155697", "title": "How to get an element in a Haskell list?", "body": "<p>Let's take the posted code:</p>\n\n<pre><code>assignmentVariable::String -&gt; [(String, Integer)] -&gt; Integer\nassignmentVariable [] = error \"list is empty\"\nassignmentVariable n (x:xs) = if x == n then xs else ...\n</code></pre>\n\n<p>The first equation has only one argument, while the second has two. Let's fix that.</p>\n\n<pre><code>assignmentVariable::String -&gt; [(String, Integer)] -&gt; Integer\nassignmentVariable _ []     = error \"list is empty\"\nassignmentVariable n (x:xs) = if x == n then xs else ...\n</code></pre>\n\n<p>Since we do <code>x == n</code>, these variables must be of the same type.\nHowever, <code>n::String</code> and <code>x::(String,Integer)</code>. We need to split <code>x</code> into its components before comparing.</p>\n\n<pre><code>assignmentVariable::String -&gt; [(String, Integer)] -&gt; Integer\nassignmentVariable _ []         = error \"list is empty\"\nassignmentVariable n ((m,x):xs) = if m == n then xs else ...\n</code></pre>\n\n<p>The result <code>xs</code> is a list, not an <code>Integer</code> as the type signature suggests. You just want <code>x</code> there.</p>\n\n<pre><code>assignmentVariable::String -&gt; [(String, Integer)] -&gt; Integer\nassignmentVariable _ []         = error \"list is empty\"\nassignmentVariable n ((m,x):xs) = if m == n then x else ...\n</code></pre>\n\n<p>Finally, the recursive call. When <code>m/=n</code>, we want to try the other pairs in the list <code>xs</code>, so:</p>\n\n<pre><code>assignmentVariable::String -&gt; [(String, Integer)] -&gt; Integer\nassignmentVariable _ []         = error \"list is empty\"\nassignmentVariable n ((m,x):xs) = if m == n \n                                  then x\n                                  else assignmentVariable n xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 2, "last_activity_date": 1431285859, "creation_date": 1431285859, "answer_id": 30155728, "question_id": 30155607, "link": "https://stackoverflow.com/questions/30155607/how-to-get-an-element-in-a-haskell-list/30155728#30155728", "title": "How to get an element in a Haskell list?", "body": "<p>You want to pattern-match on the pair.</p>\n\n<pre><code>assignmentVariable expected ((key, value) : rest)\n</code></pre>\n\n<p>If the variable name matches the expected name, the first element of the pair\u2026</p>\n\n<pre><code>  = if key == expected\n</code></pre>\n\n<p>You return the associated value, the second element of the pair.</p>\n\n<pre><code>    then value\n</code></pre>\n\n<p>Otherwise, you try to find the value in the rest of the list.</p>\n\n<pre><code>    else assignmentVariable expected rest\n</code></pre>\n\n<p>You can implement it without pattern-matching, of course:</p>\n\n<pre><code>assignmentVariable expected list\n  = if expected == fst (head list)\n    then snd (head list)\n    else assignmentVariable expected (tail list)\n</code></pre>\n\n<p>However, this is not the usual style in Haskell code.</p>\n\n<p>This function also exists in the Prelude, by the name of <code>lookup</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 1, "last_activity_date": 1431287807, "creation_date": 1431287807, "answer_id": 30156034, "question_id": 30155607, "link": "https://stackoverflow.com/questions/30155607/how-to-get-an-element-in-a-haskell-list/30156034#30156034", "title": "How to get an element in a Haskell list?", "body": "<p>You're halfway there, actually!</p>\n\n<p>First, it would be better to make a more general type signature, and a better name:</p>\n\n<pre><code>myLookup :: (Eq a) =&gt; a -&gt; [(a, b)] -&gt; b\n</code></pre>\n\n<p>You've done well to have sorted out the edge case of <code>[]</code>, but you've not quite finished:</p>\n\n<pre><code>myLookup _       []     = error \"myLookup: empty list.\"\nmyLookup n  ((x, b):xs) = if x == n\n                          then b\n                          else myLookup n xs\n</code></pre>\n\n<p>Your problem was what you put after the <code>else</code>: you weren't recursively calling the function, you were returning the function, which doesn't make any sense - you need to call it again with different arguments to recur.</p>\n\n<hr>\n\n<p>If you want to improve, try making a similar function of type <code>Eq a =&gt; a -&gt; [(a, b)] -&gt; Maybe b</code> for a challenge.</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 1, "last_activity_date": 1431302303, "creation_date": 1431302303, "answer_id": 30157881, "question_id": 30155607, "link": "https://stackoverflow.com/questions/30155607/how-to-get-an-element-in-a-haskell-list/30157881#30157881", "title": "How to get an element in a Haskell list?", "body": "<p>Just for posterity, I would like to propose an alternative implementation:</p>\n\n<pre><code>assignmentVariables :: Eq a =&gt; a -&gt; [(a, b)] -&gt; [b]\nassignmentVariables n xs = [v | (n', v) &lt;- xs, n == n']\n</code></pre>\n\n<p>You can run it in ghci:</p>\n\n<pre><code>&gt; assignmentVariables \"x\" [(\"x\", 3), (\"y\", 4), (\"z\", 1)]\n[3]\n</code></pre>\n\n<p>\"Ah!\", I hear you say, \"But it returns <code>[3]</code> and not <code>3</code>!\". But don't give up on it yet; there are several advantages of the behavior of this function over the behavior you proposed.</p>\n\n<p>The type of <code>assignmentVariables</code> is more honest than the type of <code>assignmentVariable</code>. It doesn't promise to return a value when it doesn't find the given key in its lookup table. This means that, unlike your version, this version will not cause runtime crashes. Moreover, it has a clean way to report the unlikely situation where there are conflicts in the lookup table: it will return all values associated with the given key, even if there are many.</p>\n\n<p>The consumer of the call then gets to decide how to handle the exceptional cases: one can write</p>\n\n<pre><code>case assignmentVariables key lookupTable of\n    []      -&gt; -- do something appropriate to complain about missing keys\n    [value] -&gt; -- do something with the value\n    values  -&gt; -- do conflict resolution; for example, use the first value or complain or something\n</code></pre>\n\n<p>or may simply treat the output of <code>assignmentVariables</code> as a nondeterministic value. The key here is that you are not locked into one behavior (which, of all the choices, <em>crashing</em>? really?).</p>\n"}], "owner": {"reputation": 35, "user_id": 4834712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a69f8d4d9673764d127b0f1a08d9c2db?s=128&d=identicon&r=PG&f=1", "display_name": "Hans", "link": "https://stackoverflow.com/users/4834712/hans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 91, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1431302303, "creation_date": 1431285218, "last_edit_date": 1431287782, "question_id": 30155607, "link": "https://stackoverflow.com/questions/30155607/how-to-get-an-element-in-a-haskell-list", "title": "How to get an element in a Haskell list?", "body": "<p>I want to make a function that looks up a <code>String</code> in a list of type <code>[(String, Int)]</code> and returns the <code>Int</code> paired with the <code>String</code>.</p>\n\n<p>Like this:</p>\n\n<pre><code>\u03bb&gt; assignmentVariable \"x\" [(\"x\", 3), (\"y\", 4), (\"z\", 1)]\n3\n</code></pre>\n\n<p>Here's what I've tried:</p>\n\n<pre><code>assignmentVariable :: String -&gt; [(String, Int)] -&gt; Int\nassignmentVariable [] = error \"list is empty\"\nassignmentVariable n (x:xs) = if x == n\n                              then xs\n                              else assignmentVariable\n</code></pre>\n\n<p>How could I write this?</p>\n"}, {"tags": ["haskell", "ghci"], "answers": [{"tags": [], "owner": {"reputation": 976, "user_id": 1274282, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nBRxs.png?s=128&g=1", "display_name": "Taylor Fausak", "link": "https://stackoverflow.com/users/1274282/taylor-fausak"}, "is_accepted": true, "score": 4, "last_activity_date": 1431281577, "creation_date": 1431281577, "answer_id": 30154916, "question_id": 30154629, "link": "https://stackoverflow.com/questions/30154629/function-not-evaluating-in-ghci/30154916#30154916", "title": "Function not evaluating in GHCI", "body": "<p><code>maxBound</code> is a function in the <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/Prelude.html#t:Bounded\" rel=\"nofollow\"><code>Bounded</code></a> type class. By default, GHCi appears to choose the instance for <code>()</code>, which returns <code>()</code>. You can force it to use another instance by adding a type signature.</p>\n\n<pre><code>let bInt :: Int; bInt = maxBound\nbInt -- 9223372036854775807\n\nlet x = maxBound\nx :: () -- ()\nx :: Bool -- True\nx :: Char -- '\\1114111'\n</code></pre>\n"}], "owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 30154916, "answer_count": 1, "score": 3, "last_activity_date": 1431281577, "creation_date": 1431280100, "question_id": 30154629, "link": "https://stackoverflow.com/questions/30154629/function-not-evaluating-in-ghci", "title": "Function not evaluating in GHCI", "body": "<p>If I assign a var to maxBound : </p>\n\n<pre><code>let bInt = maxBound\n</code></pre>\n\n<p>evaluation of <code>bInt</code> prints ()</p>\n\n<p>but if I type bInt</p>\n\n<pre><code>bInt :: Int\nprints : 9223372036854775807\n</code></pre>\n\n<p>Why does bInt not evaluate until I type </p>\n\n<pre><code>bInt (bInt :: Int) ?\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 12, "creation_date": 1431277711, "post_id": 30154177, "comment_id": 48415619, "body": "<a href=\"https://www.haskell.org/hoogle/?hoogle=Int+-%3E+IO+%28%29+-%3E+IO+%28%29\" rel=\"nofollow noreferrer\">hoogle</a> gives <a href=\"http://hackage.haskell.org/packages/archive/base/latest/doc/html/Control-Monad.html#v:replicateM\" rel=\"nofollow noreferrer\"><code>replicateM_</code></a> as the fifth result..."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1431283354, "post_id": 30154315, "comment_id": 48417598, "body": "You probably mean <code>forM_ [1..10] $ \\_ -&gt; do ...</code>."}, {"owner": {"reputation": 1706, "user_id": 1840613, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2dfd4d21060ccd9b972864e0f6cb8c4?s=128&d=identicon&r=PG", "display_name": "Jeremy List", "link": "https://stackoverflow.com/users/1840613/jeremy-list"}, "edited": false, "score": 0, "creation_date": 1431595905, "post_id": 30154315, "comment_id": 48570017, "body": "There&#39;s also <code>replicateM</code>, but with that you have to use an <code>Int</code> (on the other hand: I can&#39;t think of any reason why calling <code>replicateM</code> with an argument greater than <code>maxBound :: Int</code> would ever be useful)."}], "tags": [], "owner": {"reputation": 98, "user_id": 3658814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vrUWC.jpg?s=128&g=1", "display_name": "Sheev", "link": "https://stackoverflow.com/users/3658814/sheev"}, "is_accepted": true, "score": 6, "last_activity_date": 1431312536, "last_edit_date": 1431312536, "creation_date": 1431278210, "answer_id": 30154315, "question_id": 30154177, "link": "https://stackoverflow.com/questions/30154177/how-to-do-the-same-thing-n-times-in-haskell/30154315#30154315", "title": "How to do the same thing n times in Haskell", "body": "<p><code>forM_</code> from <code>Control.Monad</code> is one way. </p>\n\n<p>Example:</p>\n\n<pre><code>import Control.Monad (forM_) \n\nmain = forM_ [1..10] $ \\_ -&gt; do\n    print \"We'll do this 10 times!\"\n</code></pre>\n\n<p>See the documentation here</p>\n\n<p><a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/Control-Monad.html#v:forM-95-\" rel=\"nofollow\">http://hackage.haskell.org/package/base-4.8.0.0/docs/Control-Monad.html#v:forM-95-</a></p>\n"}], "owner": {"reputation": 980, "user_id": 2412394, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/54ab5dd99c2e2bb4f43c5932d9c49407?s=128&d=identicon&r=PG", "display_name": "Richard Fung", "link": "https://stackoverflow.com/users/2412394/richard-fung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1361, "favorite_count": 0, "accepted_answer_id": 30154315, "answer_count": 1, "score": 5, "last_activity_date": 1431312536, "creation_date": 1431277509, "last_edit_date": 1431280863, "question_id": 30154177, "link": "https://stackoverflow.com/questions/30154177/how-to-do-the-same-thing-n-times-in-haskell", "title": "How to do the same thing n times in Haskell", "body": "<p>Excuse me if this is a really dumb question, but I've read through one book and most of another book on Haskell already and don't seem to remember anywhere this was brought up.</p>\n\n<p>How do I do the same thing n times? If you want to know exactly what I am doing, I'm trying to do some of the Google Code Jam questions to learn Haskell, and the first line of the input gives you the number of test cases. That being the case, I need to do the same thing n times where n is the number of test cases.</p>\n\n<p>The only way I can think of to do this so far is to write a recursive function like this:</p>\n\n<pre><code>recFun :: Int -&gt; IO () -&gt; IO ()\nrecFun 0 f = do return ()\nrecFun n f = do\n    f\n    recFun (n-1) f\n    return ()\n</code></pre>\n\n<p>Is there no built in function that already does this?</p>\n"}, {"tags": ["haskell", "recursion"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1431276136, "post_id": 30153882, "comment_id": 48415100, "body": "Have you, like, tried anything yourself yet? We aren&#39;t just going to give you teh codez that does all of that..."}, {"owner": {"reputation": 1, "user_id": 4882554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f0264314146eb47e70b544135eba54c?s=128&d=identicon&r=PG&f=1", "display_name": "makaku", "link": "https://stackoverflow.com/users/4882554/makaku"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1431279798, "post_id": 30153882, "comment_id": 48416349, "body": "I wouldn&#39;t count on that. But maybe someone found out a good tutorial or anything that would help."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 1, "last_activity_date": 1431277687, "creation_date": 1431277687, "answer_id": 30154220, "question_id": 30153882, "link": "https://stackoverflow.com/questions/30153882/haskell-program-how-to-read-files-recursively-and-search-their-contents/30154220#30154220", "title": "Haskell program: How to read files recursively and search their contents?", "body": "<p>See <a href=\"http://hackage.haskell.org/package/directory-1.2.2.1/docs/System-Directory.html\" rel=\"nofollow\"><code>System.Directory</code></a>.</p>\n\n<p>To fetch the entries of a directory:</p>\n\n<pre><code>getDirectoryContents :: FilePath -&gt; IO [FilePath] \n</code></pre>\n\n<p>To check if an entry is a non-directory:</p>\n\n<pre><code>doesFileExist :: FilePath -&gt; IO Bool\n</code></pre>\n\n<p>To check if an entry is a directory:</p>\n\n<pre><code>doesDirectoryExist :: FilePath -&gt; IO Bool\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4882554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f0264314146eb47e70b544135eba54c?s=128&d=identicon&r=PG&f=1", "display_name": "makaku", "link": "https://stackoverflow.com/users/4882554/makaku"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 0, "accepted_answer_id": 30154220, "answer_count": 1, "score": 0, "last_activity_date": 1431290800, "creation_date": 1431275827, "last_edit_date": 1431290800, "question_id": 30153882, "link": "https://stackoverflow.com/questions/30153882/haskell-program-how-to-read-files-recursively-and-search-their-contents", "title": "Haskell program: How to read files recursively and search their contents?", "body": "<p>I'm struggling to write a Haskell program which would cover at least these:</p>\n\n<ol>\n<li><p>Search through a given directory (recursively) for files containing a specified string </p></li>\n<li><p>Execution can be parameterized through command-line (typing <code>--name SomeName</code> will throw every file containing <code>SomeName</code>)</p></li>\n<li><p>Can be run both Unix and Windows</p></li>\n</ol>\n\n<p>Considering above, how should reading files and searching functions should be written? Any advice would be much appreciated.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 7942, "user_id": 516188, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/934a553983eaca4c3f8f939daf6d2faa?s=128&d=identicon&r=PG", "display_name": "Emmanuel Touzery", "link": "https://stackoverflow.com/users/516188/emmanuel-touzery"}, "edited": false, "score": 0, "creation_date": 1431276028, "post_id": 30153762, "comment_id": 48415060, "body": "Yes most of the time in my use I agree <code>fmap . fmap</code> is the more pragmatic/sensible choice over monad transformers. I just feel very tempted right now to define this <code>&lt;$$&gt;</code> and start using in all my projects (typing <code>fmap . fmap</code> or <code>fmap g &lt;$&gt;</code> just feels a shame if I can get the operator) but it&#39;s annoying to add one operator and not follow the conventions of the community... Would you actually type <code>fmap . fmap</code> if your code if you stumbled on that situation?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 7942, "user_id": 516188, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/934a553983eaca4c3f8f939daf6d2faa?s=128&d=identicon&r=PG", "display_name": "Emmanuel Touzery", "link": "https://stackoverflow.com/users/516188/emmanuel-touzery"}, "edited": false, "score": 2, "creation_date": 1431276729, "post_id": 30153762, "comment_id": 48415291, "body": "Well, I rather wouldn&#39;t call it <a href=\"http://hayoo.fh-wedel.de/?query=%3C%24%24%3E\" rel=\"nofollow noreferrer\"><code>&lt;$$&gt;</code></a> at any rate. \u2014 Yes, indeed I would type <code>fmap . fmap</code> in an appropriate situation, or <code>fmap f &lt;$&gt;</code>. Might not be the most elegant thing possible, but it definitely works and is very readable. If this idiom piles up, I would switch to the transformer / functor composition."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 4, "last_activity_date": 1431275574, "last_edit_date": 1431275574, "creation_date": 1431275232, "answer_id": 30153762, "question_id": 30153728, "link": "https://stackoverflow.com/questions/30153728/haskell-fmap-fmap-function-function-over-two-functors/30153762#30153762", "title": "haskell fmap . fmap function, function over two functors", "body": "<p>Well, what you have there is a <em>composition of functors</em>. The most widespread implementation of that concept &ndash; albeit not really as general as you might like &ndash; are <em>monad transformers</em>.</p>\n\n<p><a href=\"http://hackage.haskell.org/package/transformers-0.4.3.0/docs/Control-Monad-Trans-List.html#v:ListT\" rel=\"nofollow\">http://hackage.haskell.org/package/transformers-0.4.3.0/docs/Control-Monad-Trans-List.html#v:ListT</a></p>\n\n<pre><code>f' :: ListT IO a\nf' = ListT f\n</code></pre>\n\n<p>On that, you can simply use <code>fmap g</code>, to get a value <code>h' :: ListT IO b</code> that can with <code>runListT</code> then be evaluated as <code>IO [b]</code>.</p>\n\n<p>Whether that wrapping and unwrapping is worthwhile depends on how many operations you do in a row, that can use the same composition. For some applications, monad transformers are just terrific; in other cases they just make stuff more clunky than it already is. <code>fmap . fmap</code> is actually not too bad, is it? Often I'd just stay with that.</p>\n"}, {"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1431276429, "post_id": 30153913, "comment_id": 48415191, "body": "That&#39;s nice, I wasn&#39;t aware that <code>Compose</code> was also in the transformers package."}, {"owner": {"reputation": 7942, "user_id": 516188, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/934a553983eaca4c3f8f939daf6d2faa?s=128&d=identicon&r=PG", "display_name": "Emmanuel Touzery", "link": "https://stackoverflow.com/users/516188/emmanuel-touzery"}, "edited": false, "score": 1, "creation_date": 1431276497, "post_id": 30153913, "comment_id": 48415216, "body": "but that is more verbose than <code>fmap . fmap</code>, what is the advantage of that approach?"}, {"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "reply_to_user": {"reputation": 7942, "user_id": 516188, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/934a553983eaca4c3f8f939daf6d2faa?s=128&d=identicon&r=PG", "display_name": "Emmanuel Touzery", "link": "https://stackoverflow.com/users/516188/emmanuel-touzery"}, "edited": false, "score": 1, "creation_date": 1431277077, "post_id": 30153913, "comment_id": 48415418, "body": "@EmmanuelTouzery - This abstracts the lifting of <code>fmap</code>, <code>&lt;*&gt;</code> etc. over the inner functor/applicative (<code>[]</code> in this case). If you only have one function to lift then it&#39;s not going to be worth it, but if you have a few then it might."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 7942, "user_id": 516188, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/934a553983eaca4c3f8f939daf6d2faa?s=128&d=identicon&r=PG", "display_name": "Emmanuel Touzery", "link": "https://stackoverflow.com/users/516188/emmanuel-touzery"}, "edited": false, "score": 2, "creation_date": 1431277123, "post_id": 30153913, "comment_id": 48415436, "body": "@EmmanuelTouzery: it&#39;s only an advantage if you can \u201cstay\u201d in the composed functor for a while. For monads that&#39;s quite natural (e.g. an entire web application in Yesod&#39;s handler monads, which are defined as transformers). For functors that aren&#39;t monads or at least applicatives, it does indeed not make so much sense, because you can always merge multiple <code>fmap</code>s into a single one by the functor laws."}], "tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": false, "score": 4, "last_activity_date": 1431276379, "last_edit_date": 1431276379, "creation_date": 1431275997, "answer_id": 30153913, "question_id": 30153728, "link": "https://stackoverflow.com/questions/30153728/haskell-fmap-fmap-function-function-over-two-functors/30153913#30153913", "title": "haskell fmap . fmap function, function over two functors", "body": "<p>Functors (and applicatives) compose and <a href=\"http://hackage.haskell.org/package/transformers-0.4.3.0/docs/Data-Functor-Compose.html#v:Compose\" rel=\"nofollow\">the <code>Compose</code> newtype</a> defines functor and applicative instances for the composition of two functors. This means you can wrap your <code>IO [a]</code> in a <code>Compose IO [] a</code> and apply <code>fmap</code> e.g.</p>\n\n<pre><code>import Data.Functor.Compose\ngetCompose $ fmap g $ Compose f\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1431288048, "post_id": 30154210, "comment_id": 48419201, "body": "I agree with your unpopular opinion."}, {"owner": {"reputation": 759, "user_id": 432982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a7cb0c3c8d5864e2e72c49cafc3e4d5?s=128&d=identicon&r=PG", "display_name": "Mathias V", "link": "https://stackoverflow.com/users/432982/mathias-v"}, "edited": false, "score": 0, "creation_date": 1511417313, "post_id": 30154210, "comment_id": 81852210, "body": "Your argument that <code>IO</code> and <code>[]</code> are not logically connected makes a lot of sense to me. But would you then be of the opinion that when the two functors are in fact logically connected, adding <code>(&lt;$$&gt;) = fmap.fmap</code> makes sense? For example in <code>toUpper &lt;$$&gt; [&quot;abc&quot;, &quot;cde&quot;]</code>"}, {"owner": {"reputation": 749, "user_id": 1080552, "user_type": "registered", "accept_rate": 19, "profile_image": "https://www.gravatar.com/avatar/d1043eb5fb5084c29d29fd09dc285e6e?s=128&d=identicon&r=PG", "display_name": "steviekm3", "link": "https://stackoverflow.com/users/1080552/steviekm3"}, "edited": false, "score": 0, "creation_date": 1606438426, "post_id": 30154210, "comment_id": 114969292, "body": "Hi Reid,  would you ever want to do Ted talk on programming and math ?  I think people would be interested to hear your thoughts."}], "tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": true, "score": 11, "last_activity_date": 1431277650, "creation_date": 1431277650, "answer_id": 30154210, "question_id": 30153728, "link": "https://stackoverflow.com/questions/30153728/haskell-fmap-fmap-function-function-over-two-functors/30154210#30154210", "title": "haskell fmap . fmap function, function over two functors", "body": "<p>I am of the opinion (which seems to be rather unpopular among parts of the Haskell community) that you should write your code to express your intent clearly and follow the expectations of the reader, and <em>not</em> then algebraically refactor your code into an equivalent form which is \"neater\", but not any more clear.</p>\n\n<p>In this case there doesn't seem to be any real meaning to the fact that you have two occurrences of fmap here. The fact that you are adjusting the result of an IO action is not logically conected to the fact that the adjustment happens to be mapping over a list. If you see the \"<code>fmap . fmap</code> pattern\" many times in your code, that's just because <code>fmap</code> is a quite common function.</p>\n\n<p>If you write</p>\n\n<pre><code>    y &lt;- g &lt;$$&gt; x      -- or any other made-up operator name\n</code></pre>\n\n<p>not only do you force your reader to learn an unfamiliar operator, but once they have learned it, they have to expand it to <code>y &lt;- fmap g &lt;$&gt; x</code> anyways to understand what is happening, since you grouped two unrelated operations together.</p>\n\n<p>The best form is your <code>y &lt;- fmap g &lt;$&gt; x</code> (or even better, <code>y &lt;- map g &lt;$&gt; x</code>), since it fits into a familiar pattern <code>var &lt;- function &lt;$&gt; action</code>.</p>\n\n<p>(By the way, you mentioned the Functor laws, but they are in no way relevant to any of the rewritings in your question, which just amount to expanding definitions.)</p>\n"}, {"tags": [], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "is_accepted": false, "score": 2, "last_activity_date": 1431288259, "creation_date": 1431288259, "answer_id": 30156100, "question_id": 30153728, "link": "https://stackoverflow.com/questions/30153728/haskell-fmap-fmap-function-function-over-two-functors/30156100#30156100", "title": "haskell fmap . fmap function, function over two functors", "body": "<p>I'm finding myself doing that often as well and find it really confusing. I found <code>liftM . map</code> easier to read than <code>fmap . fmap</code>.</p>\n"}], "owner": {"reputation": 7942, "user_id": 516188, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/934a553983eaca4c3f8f939daf6d2faa?s=128&d=identicon&r=PG", "display_name": "Emmanuel Touzery", "link": "https://stackoverflow.com/users/516188/emmanuel-touzery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1074, "favorite_count": 1, "accepted_answer_id": 30154210, "answer_count": 4, "score": 4, "last_activity_date": 1431288259, "creation_date": 1431274986, "question_id": 30153728, "link": "https://stackoverflow.com/questions/30153728/haskell-fmap-fmap-function-function-over-two-functors", "title": "haskell fmap . fmap function, function over two functors", "body": "<p>I find myself more and more often doing something like that...</p>\n\n<p>I have a function <code>f :: IO [a]</code> then I want to apply on it a function of type <code>g :: a -&gt; b</code>, to get <code>IO [b]</code>.</p>\n\n<p>The long way is:</p>\n\n<pre><code>x &lt;- f\nlet y = fmap g x\n</code></pre>\n\n<p>Which I then shortened to:</p>\n\n<pre><code>x &lt;- f\nlet y = g &lt;$&gt; x\n</code></pre>\n\n<p>and nowadays I rather do:</p>\n\n<pre><code>y &lt;- fmap g &lt;$&gt; f\n</code></pre>\n\n<p>but then with the <code>Functor</code> laws, I can see that I can do even:</p>\n\n<pre><code>(&lt;$$&gt;) = fmap . fmap\ny &lt;- g &lt;$$&gt; f\n</code></pre>\n\n<p>and though I saw often mentions of this <code>fmap . fmap</code> I see it has no special binding in the base library, while it seems like a massively frequent idiom for me. I literally could use this all over the place! So now I wonder, am I not trying hard enough to write pure code and that's why I hit this more than more experienced haskell programmers... Or is there a more elegant way to achieve this that explains why this idiom is not used by others much?</p>\n"}, {"tags": ["haskell", "newtype", "type-signature"], "answers": [{"tags": [], "owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "is_accepted": false, "score": 3, "last_activity_date": 1431266961, "creation_date": 1431266961, "answer_id": 30152384, "question_id": 30152316, "link": "https://stackoverflow.com/questions/30152316/how-to-define-a-function-inside-haskell-newtype/30152384#30152384", "title": "How to define a function inside haskell newtype?", "body": "<blockquote>\n  <p>As per my reasoning C is a type which accepts a function and a parameter</p>\n</blockquote>\n\n<p>How so? The constructor has only one argument.\nNewtypes always have a single constructor with exactly one argument.</p>\n\n<p>The type C, otoh, has two type parameters. But that has nothing to do with the number of arguments you can apply to the constructor.</p>\n"}, {"comments": [{"owner": {"reputation": 325, "user_id": 2841309, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dd89b9b62cd483082b3f1a20acff659?s=128&d=identicon&r=PG&f=1", "display_name": "coffeequant", "link": "https://stackoverflow.com/users/2841309/coffeequant"}, "edited": false, "score": 0, "creation_date": 1431270078, "post_id": 30152461, "comment_id": 48413043, "body": "So how do you explain this,  A Haskell continuation has the following type:  newtype Cont r a = Cont { runCont :: (a -&gt; r) -&gt; r }  A continuation takes a function of type (a -&gt; r) and generates an r, where r can sometimes be a fixed value like Int or IO ()."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 325, "user_id": 2841309, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dd89b9b62cd483082b3f1a20acff659?s=128&d=identicon&r=PG&f=1", "display_name": "coffeequant", "link": "https://stackoverflow.com/users/2841309/coffeequant"}, "edited": false, "score": 0, "creation_date": 1431270335, "post_id": 30152461, "comment_id": 48413136, "body": "It means this: <i>A Haskell continuation <code>c</code> has a type of the following form: <code>c :: (A -&gt; R) -&gt; R</code>, for instance it might be <code>c :: (String -&gt; Int) -&gt; Int</code>. To abstract over this, we define the wrapper <code>newtype Cont r a = ...</code>, so that we can then simply write <code>c&#39; :: Cont String Int</code>, defined by <code>c&#39; = Cont c</code>.</i>"}, {"owner": {"reputation": 325, "user_id": 2841309, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dd89b9b62cd483082b3f1a20acff659?s=128&d=identicon&r=PG&f=1", "display_name": "coffeequant", "link": "https://stackoverflow.com/users/2841309/coffeequant"}, "edited": false, "score": 0, "creation_date": 1431270629, "post_id": 30152461, "comment_id": 48413234, "body": "Ok let&#39;s follow with your definition that ((a-&gt;b) -&gt; a) is a function that&#39;s required in value constructor of C. How do I now initialize C? Let&#39;s say I define a function                                                                                                                  let f a = 2*a which can act as parameter to C&#39;s value constructor. I am a bit lost with defining C using this function f. Should it be C (\\x e -&gt; x e), where x is the function and e is the parameter and I am calling the function on this parameter e."}, {"owner": {"reputation": 325, "user_id": 2841309, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dd89b9b62cd483082b3f1a20acff659?s=128&d=identicon&r=PG&f=1", "display_name": "coffeequant", "link": "https://stackoverflow.com/users/2841309/coffeequant"}, "edited": false, "score": 0, "creation_date": 1431270950, "post_id": 30152461, "comment_id": 48413343, "body": "If Cont is defined in newtype shouldn&#39;t it be newtype Cont r a = Cont {runCont :: ((a-&gt;r) -&gt; r) }, a function which accepts a function as parameter?"}, {"owner": {"reputation": 325, "user_id": 2841309, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dd89b9b62cd483082b3f1a20acff659?s=128&d=identicon&r=PG&f=1", "display_name": "coffeequant", "link": "https://stackoverflow.com/users/2841309/coffeequant"}, "edited": false, "score": 0, "creation_date": 1431270996, "post_id": 30152461, "comment_id": 48413352, "body": "So can I say this a continuation is a function which takes a function of type (a-&gt;r) and generates an r?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 325, "user_id": 2841309, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dd89b9b62cd483082b3f1a20acff659?s=128&d=identicon&r=PG&f=1", "display_name": "coffeequant", "link": "https://stackoverflow.com/users/2841309/coffeequant"}, "edited": false, "score": 0, "creation_date": 1431271036, "post_id": 30152461, "comment_id": 48413365, "body": "Ok, well... I think we&#39;re gonna need some nomenclature nitpicking here. \u201c<code>((a-&gt;b) -&gt; a)</code> is a function...\u201d no. That is a <i>type</i>. \u201c...define a function <code>let f a = 2*a</code>...\u201d alright, <code>f</code> <i>is</i> a function. Unfortunately, it has a type <code>n -&gt; n</code> (it maps a number to a number), could be <code>Int -&gt; Int</code> for instance. This doesn&#39;t match with the type you need. What you could use instead is, for instance, <code>g :: (Int -&gt; Bool) -&gt; Int</code>, defined by <code>g f = if f 1 then 1 else 2</code>."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 325, "user_id": 2841309, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dd89b9b62cd483082b3f1a20acff659?s=128&d=identicon&r=PG&f=1", "display_name": "coffeequant", "link": "https://stackoverflow.com/users/2841309/coffeequant"}, "edited": false, "score": 2, "creation_date": 1431271414, "post_id": 30152461, "comment_id": 48413490, "body": "Well, it <i>is</i> a confusing subject. And perhaps you should have chosen something easier to start with Haskell... Even after 5 years of Haskell (and plenty of contravariant endofunctors in bicartesian closed categories), <i>continuations</i> are a concept that I never quite grokked. \u2014 Did you read some easier example of newtypes, along the lines <code>newtype Time = Time { getSeconds :: Double }</code>?"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 2, "last_activity_date": 1431268946, "last_edit_date": 1431268946, "creation_date": 1431267536, "answer_id": 30152461, "question_id": 30152316, "link": "https://stackoverflow.com/questions/30152316/how-to-define-a-function-inside-haskell-newtype/30152461#30152461", "title": "How to define a function inside haskell newtype?", "body": "<p>It's always good to emphasise that Haskell has two completely separate namespaces, the <em>type language</em> and the <em>value language</em>. In your case, there's</p>\n\n<ul>\n<li>A type constructor <code>C :: * -&gt; * -&gt; *</code>, which lives in the type language. It takes two types <code>a</code>, <code>b</code> (of kind <code>*</code>) and maps them to a type <code>C a b</code> (also of kind <code>*</code>).</li>\n<li>A value constructor <code>C :: ((a-&gt;b) -&gt; a) -&gt; C a b</code>, which lives in the value language. It takes a function <code>f</code> (of type <code>(a-&gt;b) -&gt; a</code>) and maps it to a value <code>C f</code> (of type <code>C a b</code>).</li>\n</ul>\n\n<p>Perhaps it would be less confusing if you had</p>\n\n<pre><code>newtype CT a b = CV ((a-&gt;b) -&gt; a)\n</code></pre>\n\n<p>but because for a newtype there is always exactly one value constructor (and exactly one type constructor) it makes sense to name them the same.</p>\n\n<p><code>CV</code> is a value constructor that accepts one function, full stop. That function will have signature <code>(a-&gt;b) -&gt; a</code>, i.e. its argument is also a function, but as far as <code>CT</code> is concerned this doesn't really matter.</p>\n\n<p>Really, it's kind of wrong that <code>data</code> and <code>newtype</code> declarations use a <code>=</code> symbol, because it doesn't mean the things on the left and right are &ldquo;the same&rdquo; &ndash; can't, because they don't even belong to the same language. There's an alternative syntax which expresses the relation better:</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n\ndata CT :: * -&gt; * -&gt; * where\n   CV :: ((a-&gt;b) -&gt; a) -&gt; CT a b\n</code></pre>\n\n<p>As for that value you tried to construct</p>\n\n<blockquote>\n  <p><code>let d1 = CV $ (\\x-&gt;(2*x)) 3</code></p>\n</blockquote>\n\n<p>here you did <em>not</em> pass &ldquo;a function and a parameter&rdquo; to <code>CV</code>. What you actually did<sup>1</sup> was, you applied the function <code>\\x-&gt;2*x</code> to the value <code>3</code> (might as well have written <code>6</code>) and passed that number to <code>CV</code>. But as I said, <code>CV</code> expects a function. What then happens is, GHC tries to interpret <code>6</code> as a function, which gives the bogus constraint <code>Num ((a-&gt;b) -&gt; a)</code>. What that means is: &ldquo;if <code>(a-&gt;b)-&gt;a</code> is a number type, then...&rdquo;. Of course it <em>isn't</em> a number type, <a href=\"https://en.wikipedia.org/wiki/Principle_of_explosion\" rel=\"nofollow\">so the rest doesn't make sense either</a>.</p>\n\n<hr>\n\n<p><sup>1</sup><sub>This is because <code>$</code> has the lowest precedence, i.e. the expression <code>CV $ (\\x-&gt;(2*x)) 3</code> is actually parsed as <code>CV ((\\x-&gt;(2*x)) 3)</code>, or equivalently <code>let y = 2*3 in CV y</code>.</sub></p>\n"}], "owner": {"reputation": 325, "user_id": 2841309, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dd89b9b62cd483082b3f1a20acff659?s=128&d=identicon&r=PG&f=1", "display_name": "coffeequant", "link": "https://stackoverflow.com/users/2841309/coffeequant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1317, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1431270764, "creation_date": 1431266534, "last_edit_date": 1431270764, "question_id": 30152316, "link": "https://stackoverflow.com/questions/30152316/how-to-define-a-function-inside-haskell-newtype", "title": "How to define a function inside haskell newtype?", "body": "<p>I am trying to decipher the record syntax in haskell for newtype and my understanding breaks when there is a function inside newtype. Consider this simple example</p>\n\n<pre><code>newtype C a b = C { getC :: (a -&gt; b) -&gt; a }\n</code></pre>\n\n<p>As per my reasoning C is a type which accepts a function and a parameter in it's constructor.\nso,</p>\n\n<pre><code>let d1 = C $ (2 *) 3 \n</code></pre>\n\n<p><code>:t d1</code> also gives </p>\n\n<pre><code>d1 :: Num ((a -&gt; b) -&gt; a) =&gt; C a b\n</code></pre>\n\n<p>Again to check this I do <code>:t getC d1</code>, which shows this</p>\n\n<pre><code>getC d1 :: Num ((a -&gt; b) -&gt; a) =&gt; (a -&gt; b) -&gt; a\n</code></pre>\n\n<p>Why the error if I try <code>getC d1</code>? <code>getC</code> should return the function and it's parameter or at least apply the parameter. </p>\n\n<p>I can't have <code>newtype C a b = C { getC :: (a-&gt;b)-&gt;b } deriving (Show)</code>, because this won't make sense!</p>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 6093, "user_id": 4293020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/352ea26cb808b26c421ab55184231322?s=128&d=identicon&r=PG", "display_name": "Simon Gibbons", "link": "https://stackoverflow.com/users/4293020/simon-gibbons"}, "edited": false, "score": 1, "creation_date": 1431257944, "post_id": 30150877, "comment_id": 48409244, "body": "The answer to this question <a href=\"http://stackoverflow.com/questions/21505192/haskell-program-outputs-loop\" title=\"haskell program outputs loop\">stackoverflow.com/questions/21505192/&hellip;</a> should be what you&#39;re looking for."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 6093, "user_id": 4293020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/352ea26cb808b26c421ab55184231322?s=128&d=identicon&r=PG", "display_name": "Simon Gibbons", "link": "https://stackoverflow.com/users/4293020/simon-gibbons"}, "edited": false, "score": 0, "creation_date": 1431269733, "post_id": 30150877, "comment_id": 48412917, "body": "@SimonGibbons that&#39;s identical; this is a duplicate question."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1431278294, "post_id": 30150877, "comment_id": 48415857, "body": "@AJFarmar: it&#39;s actually not a duplicate, since the other question was specifically about the <code>&lt;&lt;loop&gt;&gt;</code> output, which ghci does <i>not</i> always produce when stuck in an infinite loop."}], "answers": [{"comments": [{"owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "edited": false, "score": 0, "creation_date": 1431260381, "post_id": 30150938, "comment_id": 48409951, "body": "where is the recursive invocation? Calling y from GHCI invokes y once ?"}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "reply_to_user": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "edited": false, "score": 0, "creation_date": 1431260627, "post_id": 30150938, "comment_id": 48410007, "body": "@blue-sky Try thinking about the definition of <code>y</code> ?"}, {"owner": {"reputation": 6093, "user_id": 4293020, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/352ea26cb808b26c421ab55184231322?s=128&d=identicon&r=PG", "display_name": "Simon Gibbons", "link": "https://stackoverflow.com/users/4293020/simon-gibbons"}, "edited": false, "score": 1, "creation_date": 1431260668, "post_id": 30150938, "comment_id": 48410020, "body": "Calling y from ghci attempts to evaluate <code>y</code>, which it then sees as <code>y + 1</code>, as it knows the definition of <code>y</code> it will attempt to expand this as <code>(y+1) +1</code> and so on....."}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": false, "score": 4, "last_activity_date": 1431261080, "last_edit_date": 1431261080, "creation_date": 1431257964, "answer_id": 30150938, "question_id": 30150877, "link": "https://stackoverflow.com/questions/30150877/why-does-this-cause-ghci-to-hang/30150938#30150938", "title": "Why does this cause GHCI to hang?", "body": "<p>That's because it recurses infinitely. You are calling <code>y</code> which is defined as <code>y + 1</code>. So how will the evaluation proceed ?</p>\n\n<p>It goes like this:</p>\n\n<pre><code>y\ny + 1\n(y + 1) + 1\n((y + 1) + 1) + 1\n</code></pre>\n\n<p>and so on...</p>\n"}, {"tags": [], "owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "is_accepted": true, "score": 3, "last_activity_date": 1431262068, "last_edit_date": 1431262068, "creation_date": 1431260743, "answer_id": 30151377, "question_id": 30150877, "link": "https://stackoverflow.com/questions/30150877/why-does-this-cause-ghci-to-hang/30151377#30151377", "title": "Why does this cause GHCI to hang?", "body": "<p>Speaking more broadly, a Haskell file (or GHCi) does NOT contain a list of imperatives/orders, like some other programming languages. It is a different style of programming language. Instead there are a handful of kinds of top-level statements which you have access to:</p>\n\n<ol>\n<li><p>You can define values. <code>y = y + 1</code> defines the symbol <code>y</code> to be an application of a function <code>(+)</code> to two other parameters, <code>y</code> and <code>1</code>. This definition holds <em>throughout the file</em>, in particular to things <em>above</em> the definition and <em>within</em> the definition. So, you can totally write <code>y = x + 1</code> and then <code>x = 2</code> in a <code>.hs</code> file and ask GHCi for <code>y</code> and it will say <code>3</code>. Note that this gets more complicated with the <code>let</code> keyword, which forms a \"wall\" to this expansive nature of definition: <code>let</code> accepts a block of definitions and a value-expression and scopes those definitions to within the combined (block-of-definitions, value-expression) context, but walls off those definitions from the world outside the <code>let</code>. So this is valid, too:</p>\n\n<pre><code>Prelude&gt; let y = x + 1; x = 2\nPrelude&gt; y\n3\n</code></pre></li>\n<li><p>You can define data structures and their constructors. A constructor is a special function which we allow to participate in <em>pattern-matching</em>: in other words, Haskell knows how to <em>invert</em> or <em>destructure</em> every constructor. You can also define a <code>type</code> synonym and a <code>newtype</code>, which is halfway in-between those.</p></li>\n<li><p>You can provide metadata about individual values (type declarations). These are really helpful for narrowing down where a type error is because they set up a \"wall\" for the type inference algorithm. They also can have semantic effects either in adding polymorphism (Haskell has a \"monomorphism restriction\" which often bites newcomers) or in restricting that polymorphism to a concrete type.</p></li>\n<li><p>You can provide metadata about the package as a whole: both how it incorporates other packages (import statements) and how it can be used by other packages (module statements). </p></li>\n</ol>\n\n<p>None of these are <em>orders</em> that you're giving to the Haskell system; instead your file is all one big <em>description of a module</em>. Similarly within an expression (the first part above) there are only a couple of things you can do, and they are not usually imperatives: you can apply values to other values, create functions, you can create local definitions (<code>let</code>) and pattern-match (<code>case</code>), and you can locally add type metadata. Everything else, including <code>do</code> notation, is just a more convenient way (\"syntactic sugar\") to do those things above.</p>\n\n<p>Your two statements are a type declaration (\"the type of the <code>y</code> defined by this module will be an integer\") and a definition (\"to compute a <code>y</code> as defined by this module, first compute the value of a <code>y</code>, then add one to it\"). Haskell reads both of them together and says, \"oh, <code>y</code> has type <code>Int</code>, so <code>(+)</code> is the specific Int-Plus operation that I know, <code>(+) :: Int -&gt; Int -&gt; Int</code>, and then <code>1</code> is the specific <code>Int</code> of that name which I know... . It will then confirm that the types are self-consistent and produce some imperative code which loops forever.</p>\n"}, {"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 3, "last_activity_date": 1431269668, "creation_date": 1431269668, "answer_id": 30152851, "question_id": 30150877, "link": "https://stackoverflow.com/questions/30150877/why-does-this-cause-ghci-to-hang/30152851#30152851", "title": "Why does this cause GHCI to hang?", "body": "<p><strong>Haskell has no variables, only constants</strong>, thus, you cannot use the same style as in other languages, with updatable values referring to the last. It does mean, however, that you can do some pretty awesome things, which you've tripped upon.</p>\n\n<p>Take this declaration as an example:</p>\n\n<pre><code>myList = 1 : myList\n</code></pre>\n\n<p>When evaluated, this will refer to itself, thus doing this:</p>\n\n<pre><code>myList = 1 : myList                      -- but I'm referring to myList, so...\nmyList = 1 : (1 : myList)                -- but I'm referring to myList, so...\nmyList = 1 : (1 : (1 : myList))          -- but I'm referring to myList, so...\nmyList = 1 : 1 : 1 : 1 : 1 : 1...        -- etc.\n</code></pre>\n\n<p>The same goes for your constant <code>y</code>:</p>\n\n<pre><code>y = y + 1             -- but I'm referring to y, so...\ny = y + 1 + 1         -- but I'm referring to y, so...\ny = y + 1 + 1 + 1     -- but I'm referring to y, so...\ny = 1 + 1 + 1 + 1 ... -- etc.\n</code></pre>\n\n<p>GHCi can never completely evaluate the value of <code>y</code>, because it's infinite, causing GHCi to hang.</p>\n"}], "owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 0, "accepted_answer_id": 30151377, "answer_count": 3, "score": 0, "last_activity_date": 1431269668, "creation_date": 1431257569, "question_id": 30150877, "link": "https://stackoverflow.com/questions/30150877/why-does-this-cause-ghci-to-hang", "title": "Why does this cause GHCI to hang?", "body": "<p>This code : </p>\n\n<pre><code>y :: Int\ny = y + 1\n</code></pre>\n\n<p>When executed causes GHCI to hang. </p>\n\n<pre><code>y :: Int; this means y is of type Int\ny = y + 1; this means y is defined to be an Int + 1\n</code></pre>\n\n<p>Please correct me if I'm incorrect in definitions of statements.</p>\n\n<p>Why does y not evaluate ?</p>\n\n<p>Is reason that y is being added to an Int, but its just being added to a type not to a value ?</p>\n"}, {"tags": ["haskell", "haskell-platform", "haskell-snap-framework"], "answers": [{"tags": [], "owner": {"reputation": 887, "user_id": 1622256, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/4446ea0060a0859fdd3aeae71883dfdf?s=128&d=identicon&r=PG", "display_name": "Raghavan", "link": "https://stackoverflow.com/users/1622256/raghavan"}, "is_accepted": false, "score": 2, "last_activity_date": 1431265490, "creation_date": 1431265490, "answer_id": 30152151, "question_id": 30147380, "link": "https://stackoverflow.com/questions/30147380/module-snap-does-not-export-get/30152151#30152151", "title": "Module \u2018Snap\u2019 does not export \u2018get\u2019", "body": "<p>I was using different version of the snap framework than given in this tutorial . Things works fine after changed the version .</p>\n"}, {"tags": [], "owner": {"reputation": 85, "user_id": 8930059, "user_type": "registered", "profile_image": "https://graph.facebook.com/10210486235700399/picture?type=large", "display_name": "Pond Premtoon", "link": "https://stackoverflow.com/users/8930059/pond-premtoon"}, "is_accepted": false, "score": 1, "last_activity_date": 1511034100, "creation_date": 1511034100, "answer_id": 47370261, "question_id": 30147380, "link": "https://stackoverflow.com/questions/30147380/module-snap-does-not-export-get/47370261#47370261", "title": "Module \u2018Snap\u2019 does not export \u2018get\u2019", "body": "<p>In the current version (11/18/17), you can get the <code>get</code> function from <code>Data.Monad.State</code>. So, add the following:</p>\n\n<pre><code>import Data.Monad.State\n</code></pre>\n\n<p>and remove</p>\n\n<pre><code>import Snap (get)\n</code></pre>\n"}], "owner": {"reputation": 887, "user_id": 1622256, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/4446ea0060a0859fdd3aeae71883dfdf?s=128&d=identicon&r=PG", "display_name": "Raghavan", "link": "https://stackoverflow.com/users/1622256/raghavan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1511034100, "creation_date": 1431228227, "question_id": 30147380, "link": "https://stackoverflow.com/questions/30147380/module-snap-does-not-export-get", "title": "Module \u2018Snap\u2019 does not export \u2018get\u2019", "body": "<p>I am trying to learn snap web framework is haskell . I am following the tutorial <a href=\"http://janrain.com/blog/tutorial-building-a-sample-application-with-haskell-snap-postgresql-and-the-postgresql-simple-snaplet/\" rel=\"nofollow\">http://janrain.com/blog/tutorial-building-a-sample-application-with-haskell-snap-postgresql-and-the-postgresql-simple-snaplet/</a> </p>\n\n<p>I get the following error when I do cabal install and no clue what is mistake ?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["haskell", "functional-programming", "pointfree"], "comments": [{"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 1, "creation_date": 1431229320, "post_id": 30147368, "comment_id": 48403018, "body": "A point free function is a function that takes another function instead of a value. I don&#39;t see how it wouldn&#39;t be a function."}, {"owner": {"reputation": 1489, "user_id": 1692268, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54836036152193dbb1f54c65ad7d1623?s=128&d=identicon&r=PG", "display_name": "Shou", "link": "https://stackoverflow.com/users/1692268/shou"}, "reply_to_user": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 4, "creation_date": 1431229619, "post_id": 30147368, "comment_id": 48403063, "body": "Are you confusing point-free with higher-order?"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 2, "creation_date": 1431230023, "post_id": 30147368, "comment_id": 48403123, "body": "A point-free function takes arguments while a nullary &quot;function&quot; does not. The point-free function&#39;s arguments are not explicitly named, but it still takes arguments."}, {"owner": {"reputation": 35578, "user_id": 3000206, "user_type": "registered", "accept_rate": 98, "profile_image": "https://i.stack.imgur.com/BK1fo.jpg?s=128&g=1", "display_name": "Carcigenicate", "link": "https://stackoverflow.com/users/3000206/carcigenicate"}, "edited": false, "score": 0, "creation_date": 1431230280, "post_id": 30147368, "comment_id": 48403151, "body": "@Shou No. I think I&#39;m tired though, my last post is wrong. I know a point-free function as a function that instead of explicitly taking all of its arguments, returns a function that takes the last argument(s). <code>isAllUpper xs = all isUpper xs</code> vs <code>isAllUpper = all isUpper</code>; the latter being point-free."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1431230834, "post_id": 30147368, "comment_id": 48403223, "body": "In your edit, they are not different: both are point free functions. An example of a nullary &quot;function&quot; would be <code>x = &#39;a&#39;</code>. <code>x</code> takes no arguments at all."}, {"owner": {"reputation": 1489, "user_id": 1692268, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54836036152193dbb1f54c65ad7d1623?s=128&d=identicon&r=PG", "display_name": "Shou", "link": "https://stackoverflow.com/users/1692268/shou"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1431231052, "post_id": 30147368, "comment_id": 48403257, "body": "@DavidYoung isn&#39;t that exactly what Conal argues against in his article, i.e. that they aren&#39;t functions?"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1431231220, "post_id": 30147368, "comment_id": 48403278, "body": "@Shou If you mean <code>x</code>, then yeah. That&#39;s why I put &quot;function&quot; in quotes."}, {"owner": {"reputation": 1489, "user_id": 1692268, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54836036152193dbb1f54c65ad7d1623?s=128&d=identicon&r=PG", "display_name": "Shou", "link": "https://stackoverflow.com/users/1692268/shou"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1431231414, "post_id": 30147368, "comment_id": 48403300, "body": "@DavidYoung So how is <code>x = 2</code> different from <code>x = map</code>? Aren&#39;t both <code>x</code> both just bindings to values, rather than the latter being a function declaration?"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1431244559, "post_id": 30147368, "comment_id": 48405844, "body": "@Shou you seem confused about the difference between syntax and semantics. The declaration <code>x = map</code> contains no <i>syntactic</i> argument bindings, but the <i>semantics</i> of <code>x</code> are those of a function. To put it another way, something is a function in Haskell when its type contains <code>-&gt;</code>, not when its declaration contains pattern-matching."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1431235834, "post_id": 30147748, "comment_id": 48403981, "body": "<code>7</code> seems a poor example, because it actually is a function, of type <code>Num a =&gt; a</code> (it takes a type and a <code>Num</code> dictionary and produces a value). Once that function is applied, however, the result (say <code>7 :: Int</code>) is not a function."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 5, "creation_date": 1431236441, "post_id": 30147748, "comment_id": 48404068, "body": "@dfeuer That&#39;s not how I like to think about numbers! Or type classes. Being computed from a dictionary is an implementation concern, not what <code>7 :: Num a =&gt; a</code> <i>means</i>.  But even considering that, <code>7</code> does not fit the definition of &quot;function&quot; that is &quot;things with a function type&quot;. You do not apply <code>7 :: Num a =&gt; a</code> to something to compute <code>7 :: Int</code> in anything like the same way you apply <code>not</code> to <code>False</code> to compute <code>True</code>; you just reference it in a type-constrained position. I think calling it a function is just muddying the waters more than clarifying."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 0, "creation_date": 1431237422, "post_id": 30147748, "comment_id": 48404255, "body": "@Ben It would be far more accurate to say <code>7</code> <i>can be</i> a function. Define a <code>Num</code> instance for <code>(a -&gt; b)</code>, and <code>7</code> is a function. Something like <code>()</code> or <code>False</code> or <code>Just 45</code> is guaranteed to not be a function, regardless of instances in scope, though."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1431237463, "post_id": 30147748, "comment_id": 48404268, "body": "The dictionary per se is indeed an implementation concern, but the notion that it&#39;s a function taking a type and some sort of <code>Num</code>ness seems fairly inevitable. &quot;Reference it in a type-constrained position&quot; seems awfully vague. Trying to pin it down gets you &quot;Whenever <code>a</code> is a <code>Num</code> type, <code>7</code> has type <code>a</code>&quot;. But constructively (and Haskell&#39;s type system is certainly constructive), universal quantification can only be proven by some sort of function!"}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1431239003, "post_id": 30147748, "comment_id": 48404596, "body": "@dfeuer That&#39;s a different sort of function though, and not one that you can actually write in Haskell (other than implying it through use of type class constraints). Haskell functions are values with types of the form <code>A -&gt; B</code>, for any (possibly interdependent) types <code>A</code> and <code>B</code>. The function from a type and dictionary to a value you&#39;re talking about is not a (Haskell) value, and its &quot;type&quot; isn&#39;t of the required form, since the input type has to be something like <code>(Dict, *)</code>, which isn&#39;t a (Haskell) type (it might be arguably a kind?)."}], "tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": true, "score": 16, "last_activity_date": 1431238171, "last_edit_date": 1431238171, "creation_date": 1431232415, "answer_id": 30147748, "question_id": 30147368, "link": "https://stackoverflow.com/questions/30147368/how-are-point-free-functions-actually-functions/30147748#30147748", "title": "How are point-free functions actually &quot;functions&quot;?", "body": "<p>Conal's blog post boils down to saying \"non-functions are not functions\", e.g. <code>False</code> is not a function. This is pretty obvious; if you consider all possible values and remove the ones which have a function type, then those that remain are... not functions.</p>\n\n<p>That has absolutely nothing to do with the notion of point-free definitions.</p>\n\n<p>Consider the following function definitions:</p>\n\n<pre><code>map1, map2, map3, map4 :: (a -&gt; b) -&gt; [a] -&gt; [b]\n\nmap1 = map\n\nmap2 = id . map\n\nmap3 f = map f\n\nmap4 _ [] = []\nmap4 f (x:xs) = f x : map4 f xs\n</code></pre>\n\n<p>These are all definitions of <strong>the same function</strong> (and there are infinitely many more ways to define something equivalent to the <code>map</code> function). <code>map1</code> is obviously a point-free definition; <code>map4</code> is obviously not. They also both obviously have a function type (the same one!), so how can we say that point-free definitions are not functions? Only if we change our definition of \"function\" to something else than what is usually meant by Haskell programmers (which is that a function is something of type <code>x -&gt; y</code>, for some <code>x</code> and <code>y</code>; in this case we're using <code>a -&gt; b</code> as <code>x</code> and <code>[a] -&gt; [b]</code> for <code>y</code>).</p>\n\n<p>And the definition of <code>map3</code> is \"partially point-free\" (point-reduced?); the definition names its first argument <code>f</code>, but doesn't mention the second argument.</p>\n\n<p>The point in all this is that \"point-free-ness\" is a quality of <strong>definitions</strong>, while \"being a function\" is a property of <strong>values</strong>. The notion of point-free <em>function</em> doesn't actually make sense, since a given function can be defined many ways (some of them point-free, others not). Whenever you see someone talking about a point-free function, they mean a point-free <em>definition</em>.</p>\n\n<p>You seem to be concerned that <code>map1 = map</code> isn't a function because it's just a binding to the existing value <code>map</code>, just like <code>x = 2</code>. You're confusing notions here. Remember that functions are first-class in Haskell; \"things that are functions\" is a <strong>subset</strong> of \"things that are values\", not a different class of thing! So when <code>map</code> is an existing value <em>which is a function</em>, then yes <code>map1 = map</code> is just binding a new name to an existing value. It's <strong>also</strong> defining the function <code>map1</code>; the two are not mutually exclusive.</p>\n\n<p>You answer the question \"is this point-free\" by looking at <em>code</em>; the definition of a function. You answer the question \"is this a function\" by looking at <em>types</em>.</p>\n"}, {"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1431273624, "post_id": 30148316, "comment_id": 48414231, "body": "\u201cNullary functions are side-effectful because they take no arguments.\u201d Mmmm... could you rephrase that as a bit less of a non-sequitur?"}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1431275542, "post_id": 30148316, "comment_id": 48414877, "body": "@leftaroundabout Edited. Does that elucidate the statement?"}], "tags": [], "owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "is_accepted": false, "score": 5, "last_activity_date": 1431275491, "last_edit_date": 1495542653, "creation_date": 1431238444, "answer_id": 30148316, "question_id": 30147368, "link": "https://stackoverflow.com/questions/30147368/how-are-point-free-functions-actually-functions/30148316#30148316", "title": "How are point-free functions actually &quot;functions&quot;?", "body": "<p>Contrary to what some people might believe everything in Haskell is not a function. Seriously. Numbers, strings, booleans, etc. are not functions. Not even nullary functions.</p>\n\n<h1>Nullary Functions</h1>\n\n<p>A nullary function is a function which takes no arguments and performs some &ldquo;side-effectful&rdquo; computation. For example, consider this nullary JavaScript function:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"false\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>main();\r\n\r\nfunction main() {\r\n    alert(\"Hello World!\");\r\n    alert(\"My name is Aadit M Shah.\");\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Functions that take no arguments can only return different results if the are side-effectful. Thus, they are similar to IO actions in Haskell which take no arguments and perform some side-effectful computations:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>main = do\n    putStrLn \"Hello World!\"\n    putStrLn \"My name is Aadit M Shah.\"\n</code></pre>\n\n<h1>Unary Functions</h1>\n\n<p>In contrast, functions in Haskell can never be nullary. In fact, functions in Haskell are always unary. Functions in Haskell always take one and only one argument. Multiparameter functions in Haskell can be simulated either using currying or using data structures with multiple fields.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>add' :: Int -&gt; Int -&gt; Int -- an example of using currying\nadd'   x  y  = x + y\n\nadd'' :: (Int, Int) -&gt; Int -- an example of using multi-field data structures\nadd'' (x, y) = x + y\n</code></pre>\n\n<h1>Covariance and Contravariance</h1>\n\n<p>Functions in Haskell are a data type, just like any other data type you may define in Haskell. However, functions are special because they are <a href=\"https://en.wikipedia.org/wiki/Covariance_and_contravariance_(computer_science)#Function_types\" rel=\"nofollow noreferrer\">contravariant in the argument type and covariant in the return type</a>.</p>\n\n<p>When you define a new algebraic data type, all the fields of its type constructors are covariant (i.e. a source of data) instead of contravariant (i.e. a sink of data). A covariant field produces data while a contravariant field consumes data.</p>\n\n<p>For example, suppose I create a new data type:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Foo = Bar { field1 :: Char, field2 :: Int }\n         | Baz { field3 :: Bool }\n</code></pre>\n\n<p>Here the fields <code>field1</code>, <code>field2</code> and <code>field3</code> are covariant. They produce data of the type <code>Char</code>, <code>Int</code> and <code>Bool</code> respectively. Consider:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>let x = Baz True -- I create a new value of type Foo\nin  field3 x     -- I can access the value of field3 because it is covariant\n</code></pre>\n\n<p>Now, consider the definition of a function:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Function a b = Function { domain   :: a -- the argument type\n                             , codomain :: b -- the return   type\n                             }\n</code></pre>\n\n<p>Ofcourse, a function is not actually defined as follows but let's assume that it is. A function has two fields <code>domain</code> and <code>codomain</code>. When we create a value of the type <code>Function</code> we don't know either of these two fields.</p>\n\n<ol>\n<li>We don't know the value of <code>domain</code> because it is contravariant. Hence, it needs to be provided by the user.</li>\n<li>We don't know the value of <code>codomain</code> because although it is covariant yet it might depend on the <code>domain</code> and we don't know the value of the <code>domain</code>.</li>\n</ol>\n\n<p>For example, <code>\\x -&gt; x + x</code> is a function where the value of the <code>domain</code> is <code>x</code> and the value of the <code>codomain</code> is <code>x + x</code>. Here the <code>domain</code> is contravariant (i.e. a sink of data) because data goes into the function via the <code>domain</code>. Similarly, the <code>codomain</code> is covariant (i.e. a source of data) because data comes out of the function via the <code>codomain</code>.</p>\n\n<p>The fields of algebraic data structures in Haskell (like the <code>Foo</code> we defined earlier) are all covariant because data comes out of those data structures via their fields. Data never goes into these structures like the way it does for the <code>domain</code> field of functions. Hence, they are never contravariant.</p>\n\n<h1>Multiparameter Functions</h1>\n\n<p>As I explained before, although all functions in Haskell are unary yet we can emulate multiparameter functions either using currying or fields with multiple data structures.</p>\n\n<p>To understand this, I'll use a new notation. The minus sign (<code>[-]</code>) represents a contravariant type. The plus sign (<code>[+]</code>) represents a covariant type. Hence, a function from one type to another is denoted as:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>[-] -&gt; [+]\n</code></pre>\n\n<p>Now, the domain and the codomain of the function could each be individually replaced with other types. For example in currying, the codomain of the function is another function:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>[-] -&gt; ([-] -&gt; [+]) -- an example of currying\n</code></pre>\n\n<p>Notice that when a covariant type is replaced with another type then the variance of the new type is preserved. This makes sense because this is equivalent to a function with two arguments and one return type.</p>\n\n<p>On the other hand if we were to replace the domain with another function:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>([+] -&gt; [-]) -&gt; [+]\n</code></pre>\n\n<p>Notice that when we replace a contravariant type with another type then the variance of the new type is flipped. This makes sense because although <code>([+] -&gt; [-])</code> as a whole is contravariant yet its input type becomes the output of the whole function and its output type becomes the input of the whole function. For example:</p>\n\n<pre class=\"lang-js prettyprint-override\"><code>function f(g) {       // g is contravariant for f (an input value for f)\n    return g(x) + 10; // x is covariant for f (an output value for f)\n                      // x is contravariant for g (an input value for g)\n                      // g(x) is contravariant for f (an input value for f)\n                      // g(x) is covariant for g (an output value for g)\n                      // g(x) + 10 is covariant for f (an output value for f)\n}\n</code></pre>\n\n<p>Currying emulates multiparameter functions because when one function returns another function we get multiple inputs and one output because variance is preserved for the return type:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>[-] -&gt; [-] -&gt; [+]        -- a binary function\n[-] -&gt; [-] -&gt; [-] -&gt; [+] -- a ternary function\n</code></pre>\n\n<p>A data structure with multiple fields as the domain of a function also emulates multiparameter functions because variance is flipped for the argument type of a function:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>([+], [+])        -- the fields of a tuple are covariant\n([-], [-]) -&gt; [+] -- a binary function, variance is flipped for arguments\n</code></pre>\n\n<h1>Non Functions</h1>\n\n<p>Now, if you take a look at values like numbers, strings and booleans, these values are not functions. However, they are still covariant.</p>\n\n<p>For example, <code>5</code> produces a value of <code>5</code> itself. Similarly, <code>Just 5</code> produces a value of <code>Just 5</code> and <code>fromJust (Just 5)</code> produces a value of <code>5</code>. None of these expressions consume a value and hence none of them are contravariant. However, in <code>Just 5</code> the function <code>Just</code> consumes the value <code>5</code> and in <code>fromJust (Just 5)</code> the function <code>fromJust</code> consumes the value <code>Just 5</code>.</p>\n\n<p>So everything in Haskell is covariant except for the arguments of functions (which are contravariant). This is important because every expression in Haskell must evaluate to a value (i.e. produce a value, not consume a value). At the same time we want functions to consume a value and produce a new value (hence facilitating transformation of data, <a href=\"https://en.wikipedia.org/wiki/Lambda_calculus#.CE.B2-reduction\" rel=\"nofollow noreferrer\">beta reduction</a>).</p>\n\n<p>The end effect is that we can never have a contravariant expression. For example, the expression <code>Just</code> is covariant and the expression <code>Just 5</code> is also covariant. However, in the expression <code>Just 5</code> the function <code>Just</code> consumes the value <code>5</code>. Hence, contravariance is restricted to function arguments and bounded by the scope of the function.</p>\n\n<p>Because every expression in Haskell is covariant people often think of non-functional values like <code>5</code> as &ldquo;nullary functions&rdquo;. Although this intuition is insightful yet it is wrong. The value <code>5</code> is not a nullary function. It is an expression which is cannot be beta reduced. Similarly, the value <code>fromJust (Just 5)</code> is not a nullary function. It is an expression which can be beta reduced to <code>5</code>, which is not a function.</p>\n\n<p>However, the expression <code>fromJust (Just (\\x -&gt; x + x))</code> is a function because it can be beta reduced to <code>\\x -&gt; x + x</code> which is a function.</p>\n\n<h1>Pointful and Pointfree Functions</h1>\n\n<p>Now, consider the function <code>\\x -&gt; x + x</code>. This is a pointful function because we are explicitly declaring the argument of the function by giving it the name <code>x</code>.</p>\n\n<p>Every function can also be written in pointfree style (i.e. without explicitly declaring the argument of the function). For example, the function <code>\\x -&gt; x + x</code> can be written in pointfree style as <code>join (+)</code> as described in the <a href=\"https://stackoverflow.com/a/29713525/783743\">following answer</a>.</p>\n\n<p>Note that <code>join (+)</code> is a function because it beta reduces to the function <code>\\x -&gt; x + x</code>. It doesn't look like a function because it has no points (i.e. explicitly declared arguments). However, it is still a function.</p>\n\n<p>Pointfree functions have nothing to do with currying. Pointfree functions are about writing functions without points (e.g. <code>join (+)</code> instead of <code>\\x -&gt; x + x</code>). Currying is when one function returns another function, thereby allowing partial application (e.g. <code>\\x -&gt; \\y -&gt; x + y</code> which can be written in pointfree style as <code>(+)</code>).</p>\n\n<h1>Name Binding</h1>\n\n<p>In the binding <code>f = map</code> we are just giving <code>map</code> the alternative name <code>f</code>. Note that <code>f</code> does not &ldquo;return&rdquo; <code>map</code>. It is just an alternative name for <code>map</code>. For example, in the binding <code>x = 5</code> we don't say that <code>x</code> returns <code>5</code> because it doesn't. The name <code>x</code> is not a function nor a value. It's just a name which identifies the value of <code>5</code>. Similarly, in <code>f = map</code> the name <code>f</code> just identifies the value of <code>map</code>. The name <code>f</code> is said to denote a function because <code>map</code> denotes a function.</p>\n\n<p>The binding <code>f = map</code> is pointfree because we haven't explicitly declared any arguments of <code>f</code>. If we wanted to then we could have written <code>f g xs = map g xs</code>. This would be a pointful definition but because of <a href=\"https://en.wikipedia.org/wiki/Lambda_calculus#.CE.B7-conversion\" rel=\"nofollow noreferrer\">eta conversion</a> we can write it more succinctly in pointfree form as <code>f = map</code>. The concept of eta conversion is that <code>\\x -&gt; f x</code> is equivalent to <code>f</code> itself and that the pointful <code>\\x -&gt; f x</code> can be converted into the pointfree <code>f</code> and vice versa. Note that <code>f g xs = map g xs</code> is just syntactic sugar for <code>f = \\g xs -&gt; map g xs</code>.</p>\n\n<p>On the other hand <code>f = id . map</code> is a function not because it is pointfree but because <code>id . map</code> beta reduces to the function <code>\\x -&gt; id (map x)</code>. BTW, any function composed with <code>id</code> is equivalent to itself (i.e. <code>id . f = f . id = f</code>). Hence, <code>id . map</code> is equivalent to <code>map</code> itself. There's no difference between <code>f = map</code> and <code>f = id . map</code>.</p>\n\n<p>Just remember that <code>f</code> is not a function that &ldquo;returns&rdquo; <code>id . map</code>. It is just a name given to the expression <code>id . map</code> for convenience.</p>\n\n<p>P.S. For an intro to pointfree functions read:</p>\n\n<p><a href=\"https://stackoverflow.com/q/20279306/783743\">What does (f .) . g mean in Haskell?</a></p>\n"}], "owner": {"reputation": 1489, "user_id": 1692268, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/54836036152193dbb1f54c65ad7d1623?s=128&d=identicon&r=PG", "display_name": "Shou", "link": "https://stackoverflow.com/users/1692268/shou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 421, "favorite_count": 1, "accepted_answer_id": 30147748, "answer_count": 2, "score": 6, "last_activity_date": 1431275491, "creation_date": 1431228090, "last_edit_date": 1431231817, "question_id": 30147368, "link": "https://stackoverflow.com/questions/30147368/how-are-point-free-functions-actually-functions", "title": "How are point-free functions actually &quot;functions&quot;?", "body": "<p><a href=\"http://conal.net/blog/posts/everything-is-a-function-in-haskell\">Conal</a> here argues that nullary-constructed types are not functions. However, point-free functions are described as such for example on <a href=\"http://en.wikipedia.org/wiki/Tacit_programming\">Wikipedia</a>, when they take no explicit arguments in their definitions, and it seemingly is rather a property of currying. How exactly are they functions?</p>\n\n<p>Specifically: how are <code>f = map</code> and <code>f = id . map</code> different in this context? As in, <code>f = map</code> is simply just a binding to a value that happens to be a function where <code>f</code> simply \"returns\" <code>map</code> (similar to how <code>f = 2</code> \"returns\" <code>2</code>) which then takes the arguments. But <code>f = id . map</code> is referred to as a <em>function</em> because it's point-free.</p>\n"}, {"tags": ["haskell", "left-join"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1431244413, "post_id": 30147350, "comment_id": 48405798, "body": "Try pre-sorting both lists. In this way, you do not need a list comprehension to scan all the O(n^2) value combinations, but you can proceed by recursion."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1431248120, "post_id": 30147350, "comment_id": 48406686, "body": "Why do you have entries with Nothing at all? What do they mean?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1431248646, "post_id": 30147350, "comment_id": 48406804, "body": "Clarification, the above is a leading question"}, {"owner": {"reputation": 2826, "user_id": 225767, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/c8ac828c3bb0005321e26657909f537d?s=128&d=identicon&r=PG", "display_name": "uhbif19", "link": "https://stackoverflow.com/users/225767/uhbif19"}, "edited": false, "score": 0, "creation_date": 1537481645, "post_id": 30147350, "comment_id": 91811711, "body": "<a href=\"http://www.haskellforall.com/2014/12/a-very-general-api-for-relational-joins.html\" rel=\"nofollow noreferrer\">haskellforall.com/2014/12/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4883477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0678ee84cbce2d2e30ceae2b97281a13?s=128&d=identicon&r=PG&f=1", "display_name": "charl_ton", "link": "https://stackoverflow.com/users/4883477/charl-ton"}, "edited": false, "score": 0, "creation_date": 1431419567, "post_id": 30149052, "comment_id": 48476451, "body": "Thanks for your tips, they helped me fill in blanks. Cheers."}], "tags": [], "owner": {"reputation": 499, "user_id": 4629794, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb19f570a2d96e68ec79f0af208d23a8?s=128&d=identicon&r=PG", "display_name": "lierdakil", "link": "https://stackoverflow.com/users/4629794/lierdakil"}, "is_accepted": false, "score": 0, "last_activity_date": 1431246180, "last_edit_date": 1431246180, "creation_date": 1431244676, "answer_id": 30149052, "question_id": 30147350, "link": "https://stackoverflow.com/questions/30147350/haskell-implement-left-outer-join/30149052#30149052", "title": "Haskell Implement left outer join", "body": "<p>If keys in <code>ys</code> are unique, then the simplest option would be to use <code>Prelude.lookup</code>:</p>\n\n<pre><code>ljoin xs ys = [ (kx, x, lookup kx ys) | (kx,x) &lt;- xs ]\n</code></pre>\n\n<p>Otherwise, it boils down to something like this:</p>\n\n<pre><code>ljoin ((kx,x):xs) ys = (case [ y | (ky, y) &lt;- ys, ky==kx ] of\n                           [] -&gt; [(kx, x, Nothing)]\n                           ys' -&gt; [(kx, x, Just y') | y' &lt;- ys'])\n                       ++ ljoin xs ys\nljoin [] _ = []\n</code></pre>\n\n<p>Or equivalently, if you want to get fancy with comprehensions:</p>\n\n<pre><code> ljoin xs ys = [ (kx, x, my) | (kx, x) &lt;- xs, my &lt;- case [ y | (ky, y) &lt;- ys, kx==ky ] of { [] -&gt; [Nothing]; ys' -&gt; fmap Just ys'} ]\n</code></pre>\n\n<p>You can, of course, replace <code>case</code> with pattern-matching function:</p>\n\n<pre><code> ljoin xs ys = [ (kx, x, my) | (kx, x) &lt;- xs, my &lt;- listToMaybe [ y | (ky, y) &lt;- ys, kx==ky ] ]\n     where listToMaybe []  = [Nothing]\n           listToMaybe ys' = map Just ys'\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 13, "user_id": 4883477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0678ee84cbce2d2e30ceae2b97281a13?s=128&d=identicon&r=PG&f=1", "display_name": "charl_ton", "link": "https://stackoverflow.com/users/4883477/charl-ton"}, "edited": false, "score": 0, "creation_date": 1431419591, "post_id": 30152454, "comment_id": 48476467, "body": "Thanks for your help, Cheers."}], "tags": [], "owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "is_accepted": true, "score": 2, "last_activity_date": 1431267481, "creation_date": 1431267481, "answer_id": 30152454, "question_id": 30147350, "link": "https://stackoverflow.com/questions/30147350/haskell-implement-left-outer-join/30152454#30152454", "title": "Haskell Implement left outer join", "body": "<p>So when you do <code>[f x y | x &lt;- xs, y &lt;- ys]</code> you are doing a <em>Cartesian product</em> or <em>inner join</em>: every element from <code>xs</code> will be paired against every value of <code>ys</code>. That's not what you want.</p>\n\n<p>What you want is to first go over all of the elements of <code>xs</code>, then get a list of all of the values in <code>ys</code> which match, then dispatch over whether that latter list is null, to include a <code>Nothing</code> if you need it, then adjoin <code>x1</code> and <code>x2</code> to the elements of that list to make triples. So we start with writing that \"general strategy\":</p>\n\n<pre><code>ljoin xs ys = concat [map (adjoin x1 x2) $ handleNulls $ getMatches x1 ys \n                          | (x1, x2) &lt;- xs] where\n</code></pre>\n\n<p>The \"concat\" is needed because each element of <code>xs</code> will be producing its own list, and we want to \"flatten\" them all into one big list of results, that's the only thing that was missing from our general strategy. Now we fill in the details:</p>\n\n<pre><code>ljoin xs ys = concat [map (adjoin x1 x2) $ handleNulls $ getMatches x1 ys \n                          | (x1, x2) &lt;- xs] where\n    adjoin x1 x2 x3 = (x1, x2, x3)\n    handleNulls zs | null zs   = [Nothing]\n                   | otherwise = map Just zs\n    getMatches x1 ys = [y2 | (y1, y2) &lt;- ys, y1 == x1]\n</code></pre>\n\n<p>Now there are two ways that you might mean \"using only the prelude function definitions\": this could mean that you're not allowed any <code>import</code> statements but you're allowed to make the expression as complex as you like (sane!), or it could mean that you're not allowed <em>any other definitions at all</em>, including <code>where</code> (insane!). I don't see any way to do the latter without cheating for the <code>handleNulls</code> step, but you can sort of \"hide\" the cheating as a function application because it's not a recursive binding:</p>\n\n<pre><code>ljoin xs ys = concat [ zip3 (repeat x1) (repeat x2) . \n                  (\\zs -&gt; if null zs then [Nothing] else map Just zs) .\n                  map snd . filter ((x1 ==) . fst) $ ys | (x1, x2) &lt;- xs]\n</code></pre>\n\n<p>But that's just \"yuck\"; the previous version is much clearer.</p>\n"}], "owner": {"reputation": 13, "user_id": 4883477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0678ee84cbce2d2e30ceae2b97281a13?s=128&d=identicon&r=PG&f=1", "display_name": "charl_ton", "link": "https://stackoverflow.com/users/4883477/charl-ton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 351, "favorite_count": 0, "accepted_answer_id": 30152454, "answer_count": 2, "score": 1, "last_activity_date": 1431267481, "creation_date": 1431227877, "question_id": 30147350, "link": "https://stackoverflow.com/questions/30147350/haskell-implement-left-outer-join", "title": "Haskell Implement left outer join", "body": "<p>I am working on a uni assignment to implement a left outer join in Haskell using only the prelude function definitions. I have tried using list comprehensions:</p>\n\n<pre><code>ljoin :: Eq a =&gt; [(a,b)] -&gt; [(a,c)] -&gt; [(a,b, Maybe c)]\nljoin xs ys = [if x1 == y1 then (x1,x2, Just y2) else (x1,x2, Nothing)| (x1, x2) &lt;- xs, (y1,y2) &lt;- ys]\n</code></pre>\n\n<p>This produces the following output for the example:</p>\n\n<pre><code>Main&gt; ljoin [(2,\"S\"),(1,\"J\")] [(2,1),(2,2),(3,4)]\n[(2,\"S\",Just 1),(2,\"S\",Just 2),(2,\"S\",Nothing),(1,\"J\",Nothing),(1,\"J\",Nothing),(1,\"J\",Nothing)]\n(399 reductions, 834 cells)           \n</code></pre>\n\n<p>Is anyone able to give me any tips to get rid of the duplicate entries in the result? The (2, \"S\", Nothing) should not be in the results and only 1 of the (1, \"J\", Nothing) term should be present.</p>\n\n<p>Thanks in advance. </p>\n"}, {"tags": ["haskell", "monad-transformers", "state-monad"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1431213439, "post_id": 30145992, "comment_id": 48400422, "body": "You may want <code>put $! state</code> or <code>deepseq state $ put state</code> where <code>deepseq</code> is a suitable function which forces what&#39;s needed."}, {"owner": {"reputation": 715, "user_id": 4883127, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/428914dd1ba6786d9242170f4bbce2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Hardy", "link": "https://stackoverflow.com/users/4883127/bradley-hardy"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1431214339, "post_id": 30145992, "comment_id": 48400593, "body": "@chi I tried <code>put $! state&#39;</code> in <code>promoteContext</code> (which is where I assume you meant I should do that), and everything in my state record has strictness annotations all the way down to <code>Double</code>, <code>Int</code>, etc, and it still overflows just as quickly."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 1, "creation_date": 1431235142, "post_id": 30145992, "comment_id": 48403869, "body": "I think we need more context. Could you provide a link to the code?"}], "answers": [{"comments": [{"owner": {"reputation": 715, "user_id": 4883127, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/428914dd1ba6786d9242170f4bbce2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Hardy", "link": "https://stackoverflow.com/users/4883127/bradley-hardy"}, "edited": false, "score": 0, "creation_date": 1431264656, "post_id": 30150140, "comment_id": 48411248, "body": "The suggestion to isolate the code was very helpful, thank you. I did that, and it seems the Writer is the issue. See my edit."}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "reply_to_user": {"reputation": 715, "user_id": 4883127, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/428914dd1ba6786d9242170f4bbce2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Hardy", "link": "https://stackoverflow.com/users/4883127/bradley-hardy"}, "edited": false, "score": 0, "creation_date": 1431276611, "post_id": 30150140, "comment_id": 48415249, "body": "@BradleyHardy Updated the answer."}, {"owner": {"reputation": 715, "user_id": 4883127, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/428914dd1ba6786d9242170f4bbce2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Hardy", "link": "https://stackoverflow.com/users/4883127/bradley-hardy"}, "edited": false, "score": 0, "creation_date": 1431284338, "post_id": 30150140, "comment_id": 48417950, "body": "Making my own <code>forever</code>-like construct worked, thanks, although I had to do it a bit differently since I have a bit of code that <i>can&#39;t</i> thread its state through monadically due to existential quantification. It all worked out though. About the O(n^2) logging: I can work around that just by making a monoid that prepends instead of appends since I don&#39;t particularly care about the order. Anyway, all said, thank you very much--I learned a lot from your answer, including some things not directly related to my question. If I had the rep I&#39;d upvote you :P"}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "reply_to_user": {"reputation": 715, "user_id": 4883127, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/428914dd1ba6786d9242170f4bbce2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Hardy", "link": "https://stackoverflow.com/users/4883127/bradley-hardy"}, "edited": false, "score": 0, "creation_date": 1431285248, "post_id": 30150140, "comment_id": 48418278, "body": "@BradleyHardy For the monoid, I&#39;d probably define something like <code>data Bag a = Empty | Singleton a | Node !(Bag a) !(Bag a)</code> with an internal invariant that <code>Empty</code> never occurs inside <code>Node</code> and implement <code>Foldable</code>/<code>Traversable</code>. (Alternatively one could have <code>Node [Bag a]</code>.) So <code>mappend</code> of two nonempty <code>Bag</code>s would be just <code>Node</code>, always <i>O(1)</i>, and evaluating a <code>Bag</code> to WHNF suffices to prevent memory leaks in its structure."}], "tags": [], "owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "is_accepted": true, "score": 1, "last_activity_date": 1431276600, "last_edit_date": 1431276600, "creation_date": 1431252672, "answer_id": 30150140, "question_id": 30145992, "link": "https://stackoverflow.com/questions/30145992/infinite-recursion-in-io-wrapped-with-statet-causing-stack-space-overflow/30150140#30150140", "title": "Infinite recursion in IO wrapped with StateT causing stack space overflow", "body": "<p><strong>Update:</strong> I wasn't able to reproduce the issue, different GHC versions might optimize code differently. Nevertheless some ideas below:</p>\n\n<p>The forced evaluation you added doesn't do anything - it's never executed, as <code>problem</code> runs indefinitely.</p>\n\n<p>The reason why adding <code>WriterT</code> to the stack causes the memory leak could be precisely because it's never used for anything. This is a common problem with <code>Writer</code>s. With <code>State</code> you can force the current state at any point, but not with a <code>Writer</code>.</p>\n\n<p>What I'd do is to create a separate primitive for looping forever in <code>ContextT</code> that ensures that after each loop both the state and the log are fully evaluated:</p>\n\n<pre><code> import Control.Monad\n import Control.Monad.IO.Class\n import Control.Monad.RWS.Strict\n\n import Control.Exception (evaluate)\n import Control.DeepSeq\n\n import qualified Data.Sequence as Seq\n\n type ContextT s m = RWST () (Seq.Seq String) s m\n\n evaluate' :: (MonadIO m, NFData a) =&gt; a -&gt; m a\n evaluate' = liftIO . evaluate . force\n\n forever' :: (MonadIO m, NFData s) =&gt; ContextT s m a -&gt; ContextT s m b\n forever' k = RWST $ \\_ -&gt; loop mempty\n   where\n     loop w s = do\n         (_, s', w') &lt;- runRWST k () s\n         let w'' = w &lt;&gt; w'\n         evaluate' s'\n         evaluate' w''\n         loop w'' s'\n\n evalContext ctx state = do\n   (a, _, _) &lt;- runRWST ctx () state\n   return a\n\n problem :: ContextT Double IO ()\n problem = do modify (+ 0.001)\n              s &lt;- get\n              liftIO $ print s\n\n main :: IO ()\n main = evalContext (forever' problem) 0\n</code></pre>\n\n<p>Some notes and caveats:</p>\n\n<ul>\n<li>Separating the one-step computation from looping gives you more control how to ensure strictness or other properties of the loop.</li>\n<li>Using <code>[String]</code> as the monoid inside a <code>Writer</code> will most likely have <em>O(n^2)</em> performance as you're appending small lists from the right to the growing list of current entries. Therefore I'd use <code>Seq</code> to get it down to <em>O(n log n)</em>.</li>\n<li>However, forcing the log at every loop will still be <em>O(n^2)</em> - we'll traverse the full log each time. Solving this is probably out of the scope of this answer, I'd probably implement my own monoid with a relaxed tree structure for this.</li>\n<li>I'd suggest to use <code>newtype</code> for <code>ContextT</code> and not to export its internals outside the module. Even though this requires little boiler-plate code to add all the required instances, I see two advantages:\n<ul>\n<li>Encapsulation - this forces every other part of your code to use only supplied primitives, which allows you to change the internals later (like changing <code>StateT</code> + <code>WriterT</code> to <code>RWST</code>) without touching anything outside the module.</li>\n<li>You have more control of the monadic operations - for example by defining a customized <code>&gt;&gt;=</code> you can enforce that the state is evaluated to its NF after each monadic operation.</li>\n</ul></li>\n</ul>\n\n<hr>\n\n<p><strong>Old answer:</strong> If possible, please include <a href=\"http://sscce.org/\" rel=\"nofollow\">a self-contained code sample</a> that demonstrates the issue, otherwise it's hard to just guess the cause.</p>\n\n<p>Some general suggestions I'd try out:</p>\n\n<ul>\n<li>The leak might be also caused by the writer part, so try out <code>tell $! log</code> or <code>tell $!! log</code> as well.</li>\n<li>If you're in the <code>IO</code> monad, a canonical way how to force evaluation is <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/Control-Exception-Base.html#v:evaluate\" rel=\"nofollow\"><code>evaluate</code></a>. If you want a normal form then you'd use <code>evaluate (rnf value)</code>.</li>\n<li>If your stack uses <code>StateT</code>, <code>ReaderT</code> as well as <code>WriterT</code>, you might use <a href=\"http://hackage.haskell.org/package/transformers-0.4.3.0/docs/Control-Monad-Trans-RWS-Lazy.html#t:RWST\" rel=\"nofollow\">`RWST</a> instead.</li>\n<li><p>Your <code>promoteContext</code> looks very close to <a href=\"https://hackage.haskell.org/package/mmorph-1.0.4/docs/Control-Monad-Morph.html#v:hoist\" rel=\"nofollow\"><code>hoist</code></a>. To be more specific: You could create a monad transformer parametrized by the base monad:</p>\n\n<pre><code>newtype ContextT m a = ...\n</code></pre>\n\n<p>And also implement <a href=\"https://hackage.haskell.org/package/mmorph-1.0.4/docs/Control-Monad-Morph.html#t:MFunctor\" rel=\"nofollow\"><code>MFunctor</code></a>. Then the pure computations would be run inside <code>ContextT Identity</code>, the <code>IO</code>-based would be run in <code>ContextT IO</code> and you can hoist from <code>ContextT Identity</code> to <code>ContextT IO</code> using <code>hoist generalize</code>.</p></li>\n<li>Another approach could be to run the pure parts in <code>ContextT m</code> for an arbitrary <code>m</code> (or constrained by a type class such as <code>MonadRandom m =&gt; ...</code>). If <code>m</code> is arbitrary then it's possible to substitute <code>Identity</code> for <code>m</code>, so the code is indeed pure, but you can combine it together with the <code>IO</code> based parts seamlessly (also <code>IO</code> implements <code>MonadRandom</code>).</li>\n<li><p>I'd try to separate the part that forces evaluation of all the internal state and writer output into a separate function, something as</p>\n\n<pre><code>forceContext :: ContextT IO () -- or MonadIO m =&gt; ContextT m ()\nforceContext = do\n  -- state\n  s &lt;- -- read the internal state\n  liftIO $ evaluate (rnf s)\n  ...\n</code></pre>\n\n<p>Then you could express the main loop as something similar to</p>\n\n<pre><code>main = runContextT (forever (step &gt;&gt; forceContext))\n</code></pre></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 4328, "user_id": 1473927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AO6Ui.jpg?s=128&g=1", "display_name": "Jonathan Cast", "link": "https://stackoverflow.com/users/1473927/jonathan-cast"}, "is_accepted": false, "score": 0, "last_activity_date": 1431561020, "creation_date": 1431561020, "answer_id": 30227071, "question_id": 30145992, "link": "https://stackoverflow.com/questions/30145992/infinite-recursion-in-io-wrapped-with-statet-causing-stack-space-overflow/30227071#30227071", "title": "Infinite recursion in IO wrapped with StateT causing stack space overflow", "body": "<p>The problem is that <code>Writer</code> doesn't have proper tail calls; its <code>&gt;&gt;=</code> is something like (ignoring minor details like <code>newtype</code> constructors / extractors):</p>\n\n<pre><code>a &gt;&gt;= f = do\n    (w0, x) &lt;- a\n    (w1, y) &lt;- f x\n    return (w0 `mappend` w1, y)\n</code></pre>\n\n<p>So <code>f</code> isn't really in tail context here; as such, infinite tail-recursive loops like you're using <em>will</em> accumulate stack space on every loop.</p>\n\n<p><code>Writer</code> is a problem even though you 'aren't using it' because <code>do</code> is always de-sugared using the <code>&gt;&gt;=</code> of whatever type your computation is in, and it's the <code>&gt;&gt;=</code> you're picking up that's the problem here.</p>\n"}], "owner": {"reputation": 715, "user_id": 4883127, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/428914dd1ba6786d9242170f4bbce2d9?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Hardy", "link": "https://stackoverflow.com/users/4883127/bradley-hardy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 285, "favorite_count": 0, "accepted_answer_id": 30150140, "answer_count": 2, "score": 2, "last_activity_date": 1431561020, "creation_date": 1431212931, "last_edit_date": 1431266117, "question_id": 30145992, "link": "https://stackoverflow.com/questions/30145992/infinite-recursion-in-io-wrapped-with-statet-causing-stack-space-overflow", "title": "Infinite recursion in IO wrapped with StateT causing stack space overflow", "body": "<p>I am developing a graphical (game-like) program (using SDL for graphics) in Haskell. As part of this, there is necessarily a 'main' infinite loop, which handles the state updates and drawing, keeping track of time in the process. I previously had it working where it would take the state as a parameter like the following simplified example:</p>\n\n<pre><code>loop :: State -&gt; Int -&gt; IO ()\nloop state prevTime = do\n  time &lt;- getTicks\n  let state' = updateState state (time - prevTime)\n  loop state' time\n</code></pre>\n\n<p>In this, the <code>updateState</code> function itself used a monad transformer stack including a StateT for state, ReaderT for config, a WriterT for logging, and a RandT for random number generation, so I had to pass all of the parameters required through to <code>updateState</code>, and take the random number generator back. And there were multiple different <code>updateState</code>-related functions, all of which needed some <code>IO</code> done in between them, and so a lot of the code in my main loop was just threading state and parameters through.</p>\n\n<p>Of course, I quickly realised that that kind of code was horrible and decided I could probably do away with it by making the whole loop run in a different transformer stack, this one with <code>IO</code> at the bottom. I can then run code in my pure monad and have it automatically thread its state through with the following function:</p>\n\n<pre><code>promoteContext :: PureContext a -&gt; IOContext a\npromoteContext ctx = do\n  state &lt;- get\n  config &lt;- ask\n  gen &lt;- liftIO getStdGen\n  let (result, state', log, gen') = runContext ctx gen rules state\n  liftIO $ setStdGen gen'\n  put state'\n  tell log\n  return result\n</code></pre>\n\n<p>This cleaned up my code massively, and it seemed like a much better solution at first, but I soon encountered a massive issue: running my program for around a minute or so suddenly started causing a stack space overflow.</p>\n\n<p>I managed to somewhat work around this issue while keeping my code cleaner than it was before, by making the main loop method run in the <code>IO</code> monad directly and thread the state through, meaning I only have to deal with that boilerplate once per loop. This clearly forces the state to be fully evaluated every time it loops, meaning the stack doesn't fill up, but it still feels 'dirty'.</p>\n\n<p>My question is this: <strong>is there any way I can force a full evaluation of the state every time I loop, without resorting to falling back to <code>IO</code> and explicitly leaving/re-entering the transformer stack?</strong></p>\n\n<p><strong>EDIT:</strong> Thanks to suggestions by Petr Pudl\u00e1k, I spent some time trying to isolate the issue, and eventually arrived at this code which causes the problem:</p>\n\n<pre><code>import Control.Monad.Writer.Strict\nimport Control.Monad.State.Strict\n\nimport Control.DeepSeq\nimport Exception\n\ntype ContextT s m = StateT s (WriterT [String] m)\n\nevalContext ctx state = do\n  (a, log) &lt;- runWriterT (evalStateT ctx state)\n  liftIO $ evaluate (rnf log)\n  return a\n\nproblem :: ContextT Double IO ()\nproblem = do modify (+ 0.001)\n             s &lt;- get\n             liftIO $ print s\n             problem\n\nmain :: IO ()\nmain = evalContext problem 0\n</code></pre>\n\n<p>{A small edit to the code: I added the forced evaluation of the log and the problem still happens.}</p>\n\n<p>Running this causes the stack space to overflow by the time the state reaches about 500. Getting rid of the <code>WriterT</code>, however, stops the overflow from happening, suggesting that it was the <code>Writer</code>'s fault all along. I don't understand how this can be, though, as in this isolated code the writer isn't even used. I guess my question is now why on Earth does the presence of a <code>WriterT</code> cause this to happen?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 7380, "user_id": 1189745, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f8595855d0f63aa1c19c79e74aff16d1?s=128&d=identicon&r=PG", "display_name": "Kristopher Micinski", "link": "https://stackoverflow.com/users/1189745/kristopher-micinski"}, "edited": false, "score": 2, "creation_date": 1431207597, "post_id": 30145271, "comment_id": 48398987, "body": "It&#39;s just what you think.  If an expression <code>e1</code> is equal to an expression <code>e2</code>, then you can replace <code>e1</code> with <code>e2</code> inside any expression.  A simple example might be <code>1 + 1</code>, which could easily be replaced by <code>2</code>, or <code>(\\x. y) z</code> with <code>y</code> inside the expression <code>(\\x. x) ((\\x. y) z)</code>"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user3402224"}, "is_accepted": true, "score": 11, "last_activity_date": 1431212146, "last_edit_date": 1431212146, "creation_date": 1431209156, "answer_id": 30145520, "question_id": 30145271, "link": "https://stackoverflow.com/questions/30145271/what-is-meant-by-replace-equals-by-equals/30145520#30145520", "title": "What is meant by \u201creplace equals by equals\u201d", "body": "<p>It means that if you know that <code>A</code> (an expression) is equal to <code>B</code> (another expression), then you may always replace <code>A</code> for <code>B</code> in any expression involving <code>A</code>, and vice-versa.</p>\n\n<p>For instance, we know that <code>even = not . odd</code>. Therefore</p>\n\n<pre><code>   filter even\n= \n   filter (not . odd)\n</code></pre>\n\n<p>On the other hand, we know that <code>odd</code> satisfies the following equation</p>\n\n<pre><code> odd = (1 ==) . (`mod` 2)\n</code></pre>\n\n<p>As such, we also know that</p>\n\n<pre><code>   filter even\n =\n   filter (not . odd)\n =\n   filter (not . (1 ==) . (`mod` 2))\n</code></pre>\n\n<p>Moreover, you know that <code>mod 2</code> always returns <code>0</code> or <code>1</code>. So, by case analysis, the following is valid.</p>\n\n<pre><code>   not . (1 ==)\n= \n   (0 ==)\n</code></pre>\n\n<p>Therefore, we can also say</p>\n\n<pre><code>  filter even\n= \n  filter ((0 ==) . (`mod` 2))\n</code></pre>\n\n<p>The advantage of being able to <em>replace equals by equals</em> is to design a program by massaging equation after equation until a suitable definition is found, like in typical <em>solve for x</em> kind of problems of Algebra.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1431255780, "last_edit_date": 1431255780, "creation_date": 1431212734, "answer_id": 30145963, "question_id": 30145271, "link": "https://stackoverflow.com/questions/30145271/what-is-meant-by-replace-equals-by-equals/30145963#30145963", "title": "What is meant by \u201creplace equals by equals\u201d", "body": "<p>In its simplest form, substituting \"equals by equals\" means replacing a defined identifier with its definition. For instance</p>\n\n<pre><code>let x = f 1 in x + x\n</code></pre>\n\n<p>can be equivalently written as</p>\n\n<pre><code>f 1 + f 1\n</code></pre>\n\n<p>in the sense that the result will be the same. In GHC, you can expect the second one to re-compute <code>f 1</code> twice, possibly degrading performance, but the result of the sum is the same.</p>\n\n<p>In impure languages, such as Ocaml, the two snippets above are instead <em>not</em> equivalent. This is because side effects are allowed: evaluating <code>f 1</code> can have observable effects. For instance, <code>f</code> could be defined as follows:</p>\n\n<pre class=\"lang-ml prettyprint-override\"><code>(* Ocaml code *)\nlet f = let r = ref 0 in\n        fun x -&gt; r := !r + x ; !r\n</code></pre>\n\n<p>Using the above definition, <code>f</code> has an internal mutable state, which gets incremented by its argument every time it is called, before the new state is returned. Because of this,</p>\n\n<pre><code>f 1 + f 1\n</code></pre>\n\n<p>would evaluate to <code>1 + 2</code> since the state is incremented twice, while</p>\n\n<pre><code>let x = f 1 in x + x\n</code></pre>\n\n<p>would evaluate to <code>1 + 1</code>, since only one increment of the state is performed.</p>\n\n<p>The consequence is that, in Ocaml, replacing <code>x</code> with its definition would not be a semantics-preserving program transformation. Of course, the same would hold in imperative languages, which allow side effects. Only in pure languages (Haskell, Agda, Coq, ...) the transformation is safe.</p>\n"}], "owner": {"reputation": 45345, "user_id": 470184, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/DzXRW.jpg?s=128&g=1", "display_name": "blue-sky", "link": "https://stackoverflow.com/users/470184/blue-sky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 582, "favorite_count": 0, "accepted_answer_id": 30145520, "answer_count": 2, "score": 4, "last_activity_date": 1431255780, "creation_date": 1431207418, "question_id": 30145271, "link": "https://stackoverflow.com/questions/30145271/what-is-meant-by-replace-equals-by-equals", "title": "What is meant by \u201creplace equals by equals\u201d", "body": "<p>I'm Haskell newbie and reading : </p>\n\n<p><a href=\"http://www.seas.upenn.edu/~cis194/spring13/lectures/01-intro.html\" rel=\"nofollow\">http://www.seas.upenn.edu/~cis194/spring13/lectures/01-intro.html</a></p>\n\n<p>It states \"In Haskell one can always \u201creplace equals by equals\u201d, just like you learned in algebra class.\". What is meant by this and what are its advantages ?</p>\n\n<p>I don't recall learning this in algebra but perhaps I do not recognise the terminology.</p>\n"}, {"tags": ["list", "function", "haskell", "recursion"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2908819"}, "edited": false, "score": 2, "creation_date": 1431205217, "post_id": 30144925, "comment_id": 48398360, "body": "Maybe try a <a href=\"http://learnyouahaskell.com/starting-out#im-a-list-comprehension\" rel=\"nofollow noreferrer\">list comprehension</a> or a <a href=\"http://learnyouahaskell.com/higher-order-functions#maps-and-filters\" rel=\"nofollow noreferrer\">map</a> or <a href=\"http://learnyouahaskell.com/syntax-in-functions#pattern-matching\" rel=\"nofollow noreferrer\">patern matching</a>."}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 4882971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c335822229ffbe96f2eb201b1a98d39?s=128&d=identicon&r=PG&f=1", "display_name": "Rick James", "link": "https://stackoverflow.com/users/4882971/rick-james"}, "edited": false, "score": 0, "creation_date": 1431205823, "post_id": 30145004, "comment_id": 48398518, "body": "I&#39;m sorry, I must have explained it a little poorly. I want to return just a single value after all the functions have operated on it...more like this: func :: ([(a-&gt;a)]) -&gt; a -&gt; a              I&#39;m unsure if this recursive approach will be able to do what I&#39;m trying to accomplish"}, {"owner": {"reputation": 13, "user_id": 4882971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c335822229ffbe96f2eb201b1a98d39?s=128&d=identicon&r=PG&f=1", "display_name": "Rick James", "link": "https://stackoverflow.com/users/4882971/rick-james"}, "edited": false, "score": 0, "creation_date": 1431206185, "post_id": 30145004, "comment_id": 48398600, "body": "Huh, that&#39;s interesting. Thank you for that. But again, see my above comment, haha I&#39;m sorry"}, {"owner": {"reputation": 13, "user_id": 4882971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c335822229ffbe96f2eb201b1a98d39?s=128&d=identicon&r=PG&f=1", "display_name": "Rick James", "link": "https://stackoverflow.com/users/4882971/rick-james"}, "edited": false, "score": 0, "creation_date": 1431206292, "post_id": 30145004, "comment_id": 48398631, "body": "so there parameters are: a list of functions -&gt; value -&gt; modified value"}, {"owner": {"reputation": 13, "user_id": 4882971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c335822229ffbe96f2eb201b1a98d39?s=128&d=identicon&r=PG&f=1", "display_name": "Rick James", "link": "https://stackoverflow.com/users/4882971/rick-james"}, "edited": false, "score": 0, "creation_date": 1431206380, "post_id": 30145004, "comment_id": 48398659, "body": "So kind of like the reverse of map...does that make sense?"}, {"owner": {"reputation": 13, "user_id": 4882971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c335822229ffbe96f2eb201b1a98d39?s=128&d=identicon&r=PG&f=1", "display_name": "Rick James", "link": "https://stackoverflow.com/users/4882971/rick-james"}, "edited": false, "score": 0, "creation_date": 1431207915, "post_id": 30145004, "comment_id": 48399060, "body": "Wow, seriously, thank you so much for your help. This makes sense now. You wrote a lot and explained a lot, and I greatly appreciate it :) this stuff is interesting!"}, {"owner": {"reputation": 13, "user_id": 4882971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c335822229ffbe96f2eb201b1a98d39?s=128&d=identicon&r=PG&f=1", "display_name": "Rick James", "link": "https://stackoverflow.com/users/4882971/rick-james"}, "edited": false, "score": 0, "creation_date": 1431220734, "post_id": 30145004, "comment_id": 48401689, "body": "Another one related to this one, what if we were dealing with a list now instead? E.g func:: ([(a-&gt;a)]) -&gt; [a] -&gt; [a]     I tried implementing it, but not quite there:  <code>func xs ys =  if length xs == 1 then   (head xs) (head ys)  else    (head xs) (head ys) : func (drop 1 xs) ys</code>"}, {"owner": {"reputation": 13, "user_id": 4882971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c335822229ffbe96f2eb201b1a98d39?s=128&d=identicon&r=PG&f=1", "display_name": "Rick James", "link": "https://stackoverflow.com/users/4882971/rick-james"}, "edited": false, "score": 0, "creation_date": 1431224663, "post_id": 30145004, "comment_id": 48402337, "body": "Here&#39;s what I&#39;m doing now, I think this is closer...but it goes into an infinite loop.... <code>func xs ys =  if length xs == 0 || length ys == 0 then   []  else   [(head xs) (head ys)] ++ func (drop 1 xs) (drop 1 ys) </code>"}, {"owner": {"reputation": 47690, "user_id": 55925, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4d4fbbf7cbb15f7076a5bc273f7fa039?s=128&d=identicon&r=PG", "display_name": "Johannes Weiss", "link": "https://stackoverflow.com/users/55925/johannes-weiss"}, "reply_to_user": {"reputation": 13, "user_id": 4882971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c335822229ffbe96f2eb201b1a98d39?s=128&d=identicon&r=PG&f=1", "display_name": "Rick James", "link": "https://stackoverflow.com/users/4882971/rick-james"}, "edited": false, "score": 0, "creation_date": 1431246886, "post_id": 30145004, "comment_id": 48406383, "body": "The last implementation looks correct. However again, in Haskell you would normally <code>zip</code> <code>xs</code> and <code>ys</code> together, then map the uncurried application function <code>($)</code> to it. So that&#39;d be <code>func&#39; xs ys = map (uncurry ($)) (zip xs ys)</code>. The type is even a bit more general than what you mention, it&#39;s <code>func&#39; :: [a -&gt; b] -&gt; [a] -&gt; [b]</code> (but obviously <code>a</code> and <code>b</code> can be the same type)."}, {"owner": {"reputation": 47690, "user_id": 55925, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4d4fbbf7cbb15f7076a5bc273f7fa039?s=128&d=identicon&r=PG", "display_name": "Johannes Weiss", "link": "https://stackoverflow.com/users/55925/johannes-weiss"}, "reply_to_user": {"reputation": 13, "user_id": 4882971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c335822229ffbe96f2eb201b1a98d39?s=128&d=identicon&r=PG&f=1", "display_name": "Rick James", "link": "https://stackoverflow.com/users/4882971/rick-james"}, "edited": false, "score": 0, "creation_date": 1431247125, "post_id": 30145004, "comment_id": 48406438, "body": "If you prefer to &quot;write it all out&quot;, then still I would recommend pattern matching to checking lengths of lists and using <code>head</code>. With pattern matching that&#39;d be <code>func&#39;&#39; xs ys = case (xs, ys) of { ((x:xs&#39;), (y:ys&#39;)) -&gt; x y : func&#39;&#39; xs&#39; ys&#39;; _ -&gt; [] }</code>. It&#39;s much nicer, isn&#39;t it?"}, {"owner": {"reputation": 13, "user_id": 4882971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c335822229ffbe96f2eb201b1a98d39?s=128&d=identicon&r=PG&f=1", "display_name": "Rick James", "link": "https://stackoverflow.com/users/4882971/rick-james"}, "edited": false, "score": 0, "creation_date": 1431302884, "post_id": 30145004, "comment_id": 48423000, "body": "Sticking with what I wrote, i think I&#39;m getting an infinite loop <code>func:: ([((a)-&gt;a)]) -&gt; [a] -&gt; [a] func xs ys =  if length xs &lt; 1 || length ys &lt; 1 then   []  else   [(head xs) (head ys)] ++ func (drop 1 xs) (drop 1 ys) </code>"}], "tags": [], "owner": {"reputation": 47690, "user_id": 55925, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4d4fbbf7cbb15f7076a5bc273f7fa039?s=128&d=identicon&r=PG", "display_name": "Johannes Weiss", "link": "https://stackoverflow.com/users/55925/johannes-weiss"}, "is_accepted": true, "score": 2, "last_activity_date": 1431208181, "last_edit_date": 1431208181, "creation_date": 1431205472, "answer_id": 30145004, "question_id": 30144925, "link": "https://stackoverflow.com/questions/30144925/haskell-list-of-functions-that-operate-on-single-value/30145004#30145004", "title": "Haskell - List of functions that operate on single value", "body": "<h1>Misunderstood version</h1>\n\n<p>So, first of all, I would recommend to add a type signature, that helps you because the compiler will give you better error messages:</p>\n\n<pre><code>func :: [a -&gt; b] -&gt; a -&gt; [b]\n</code></pre>\n\n<p>Let's compile it:</p>\n\n<pre><code>test.hs:4:9:\nCouldn't match type \u2018b\u2019 with \u2018[b]\u2019\n</code></pre>\n\n<p>Ah, so in line 4 (originally line 3 because I added the type signature), we have type <code>b</code> but we need a list! Makes sense, no? So that line should really be:</p>\n\n<pre><code>[(head xs) y]   -- originally just `(head xs) y`\n</code></pre>\n\n<p>Problem 1 fixed, let's compile again:</p>\n\n<pre><code>test.hs:6:9:\nCouldn't match type \u2018b\u2019 with \u2018a -&gt; b\u2019\n  \u2018b\u2019 is a rigid type variable bound by\n      the type signature for func :: [a -&gt; b] -&gt; a -&gt; [b] at test.hs:1:9\n</code></pre>\n\n<p>Ah, so we would like to have type <code>b</code> but we actually find <code>a -&gt; b</code> which is a function. Makes sense! You forgot to actually apply the value to the function. So that line should be</p>\n\n<pre><code>(head xs) y : func (drop 1 xs) y   -- instead of `(head xs) : func (drop 1 xs) y`\n</code></pre>\n\n<p>Now let's try again:</p>\n\n<pre><code>Ok, modules loaded: Main.\n</code></pre>\n\n<p>Fixed!</p>\n\n<p>Now, let's think about how we could write this more idiomatically in Haskell:</p>\n\n<p>I guess, one option would be pattern matches, they are nicer than using the unsafe <code>head</code> function:</p>\n\n<pre><code>func' :: [a -&gt; b] -&gt; a -&gt; [b]\nfunc' fs x =\n    case fs of\n      f:[] -&gt; [f x]\n      f:fs' -&gt; f x : func' fs' x\n</code></pre>\n\n<p>But actually we might realise, that we just want to map something on every value (in this case a function), so this should really work:</p>\n\n<pre><code>func' :: [a -&gt; b] -&gt; a -&gt; [b]\nfunc' xs y = map SOMETHING xs\n</code></pre>\n\n<p>And <code>SOMETHING</code> is something that given a function should apply that function with <code>y</code>. Well, that's quite simple: <code>\\f -&gt; f y</code> will, given a function <code>f</code>, apply it with <code>y</code>. So</p>\n\n<pre><code>func' :: [a -&gt; b] -&gt; a -&gt; [b]\nfunc' xs y = map (\\f -&gt; f y) xs\n</code></pre>\n\n<p>does the job just fine. Or in point free style:</p>\n\n<pre><code>func' :: [a -&gt; b] -&gt; a -&gt; [b]\nfunc' xs y = map (flip ($) y) xs\n</code></pre>\n\n<p>The <code>($)</code> function has signature <code>(a -&gt; b) -&gt; a -&gt; b</code> and we need exactly that but with the first two arguments flipped (so <code>a -&gt; (a -&gt; b) -&gt; b</code>) which can be achieved by <code>flip ($)</code>.</p>\n\n<p>I hope that makes sense, otherwise just add a comment.</p>\n\n<h1>Hopefully correct version</h1>\n\n<p>I misunderstood the question unfortunately, so let's try again: As of the comments, the type signature should be <code>func :: [a -&gt; a] -&gt; a -&gt; a</code>. Let's compile then:</p>\n\n<pre><code>test2.hs:7:3:\nCouldn't match expected type \u2018a\u2019 with actual type \u2018[a]\u2019\n</code></pre>\n\n<p>Ah, fair enough, in the line <code>(head xs) y : func (drop 1 xs) y</code> we are returning a list but actually we just want a value. So that's easily fixed as we don't want to call the second function with the original <code>y</code> but with <code>first_function y</code>. So let's change that to</p>\n\n<pre><code>func (drop 1 xs) ((head xs) y)\n</code></pre>\n\n<p>and then it already works :).</p>\n\n<p>Let's also try to make that a bit more idiomatic: So if we find a call <code>func [f1, f2, f3, f4] y</code> what we actually want to execute is <code>(f4 (f3 (f2 (f1 y))))</code>.  And the whole thing already really looks like a fold. And it is!</p>\n\n<pre><code>import Data.List (foldl') \nfunc' :: [a -&gt; a] -&gt; a -&gt; a\nfunc' xs y = foldl' (\\x f -&gt; f x) y xs\n</code></pre>\n\n<p>alternatively again</p>\n\n<pre><code>func' xs y = foldl' (flip ($)) y xs\n</code></pre>\n\n<p>In case you wonder why I use <code>foldl'</code> and not <code>foldl</code>, read here <a href=\"http://www.well-typed.com/blog/90/\" rel=\"nofollow\">why <code>foldl</code> is broken and shouldn't be used</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 47690, "user_id": 55925, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4d4fbbf7cbb15f7076a5bc273f7fa039?s=128&d=identicon&r=PG", "display_name": "Johannes Weiss", "link": "https://stackoverflow.com/users/55925/johannes-weiss"}, "edited": false, "score": 0, "creation_date": 1431208413, "post_id": 30145354, "comment_id": 48399195, "body": "this will build a huge thunk for big enough input. Try <code>func (replicate 100000000 $ (+) 3) 2</code> for example and watch the memory your program consumes. I proposed <code>func&#39; xs y = foldl&#39; (flip ($)) y xs</code> which runs in constant memory and doesn&#39;t suffer from this problem."}, {"owner": {"reputation": 47690, "user_id": 55925, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4d4fbbf7cbb15f7076a5bc273f7fa039?s=128&d=identicon&r=PG", "display_name": "Johannes Weiss", "link": "https://stackoverflow.com/users/55925/johannes-weiss"}, "edited": false, "score": 0, "creation_date": 1431208659, "post_id": 30145354, "comment_id": 48399241, "body": "Sorry, it depends in the strictness of the functions in the list. Your implementation is better if the functions are lazy. For <code>func (repeat $ (++) [2]) [2]</code>, your&#39;s will constantly produce values and mine will never produce anything."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 47690, "user_id": 55925, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4d4fbbf7cbb15f7076a5bc273f7fa039?s=128&d=identicon&r=PG", "display_name": "Johannes Weiss", "link": "https://stackoverflow.com/users/55925/johannes-weiss"}, "edited": false, "score": 0, "creation_date": 1431208679, "post_id": 30145354, "comment_id": 48399249, "body": "@JohannesWei&#223; True. Note however that it depends on the functions. Consider e.g. <code>func (replicate 1000000 $ (:) 3) 2</code>. Here a right fold runs in constant memory and a left fold does not."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 47690, "user_id": 55925, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4d4fbbf7cbb15f7076a5bc273f7fa039?s=128&d=identicon&r=PG", "display_name": "Johannes Weiss", "link": "https://stackoverflow.com/users/55925/johannes-weiss"}, "edited": false, "score": 0, "creation_date": 1431208739, "post_id": 30145354, "comment_id": 48399267, "body": "@JohannesWei&#223; Yes, exactly. Your case (strict function) is probably more common."}, {"owner": {"reputation": 47690, "user_id": 55925, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/4d4fbbf7cbb15f7076a5bc273f7fa039?s=128&d=identicon&r=PG", "display_name": "Johannes Weiss", "link": "https://stackoverflow.com/users/55925/johannes-weiss"}, "edited": false, "score": 1, "creation_date": 1431209299, "post_id": 30145354, "comment_id": 48399451, "body": "yes, and there&#39;s associativity difference: <code>func [(+) 2, (*) 5] 7</code> with your implementation will return <code>37</code> ( <code>(+) 2 ((*) 5 7)</code>) however in my understanding it should evaluate <code>(*) 5 ((+) 2 7)</code> which is <code>45</code>."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 0, "last_activity_date": 1431208025, "creation_date": 1431208025, "answer_id": 30145354, "question_id": 30144925, "link": "https://stackoverflow.com/questions/30144925/haskell-list-of-functions-that-operate-on-single-value/30145354#30145354", "title": "Haskell - List of functions that operate on single value", "body": "<p>If I have understood correctly, you want to take as input a list of functions and a point, and apply all these function to that point. For example, given a list of three functions we want to have</p>\n\n<pre><code>func [f,g,h] x = f (g (h x))\n</code></pre>\n\n<p>The above example can be rewritten using the function composition operator as</p>\n\n<pre><code>func [f,g,h] x = (f . g . h) x\n</code></pre>\n\n<p>which can then be simplified to, thanks to eta-contraction,</p>\n\n<pre><code>func [f,g,h] = f . g . h\n</code></pre>\n\n<p>which clarifies that the problem is: given a list of functions, return their composition.</p>\n\n<p>Now, consider a different problem: if we wanted to solve (the generalization of)</p>\n\n<pre><code>anotherFunc [a,b,c] = a + b + c\n</code></pre>\n\n<p>we would use either recursion</p>\n\n<pre><code>anotherfunc []     = 0\nanotherfunc (x:xs) = x + anotherfunc xs\n</code></pre>\n\n<p>or a fold</p>\n\n<pre><code>anotherFunc xs = foldr (+) 0 xs\n</code></pre>\n\n<p>Note that <code>anotherFunc</code> exploits a binary operation <code>(+)</code> and its neutral element <code>0</code> (i.e. an element for which <code>x + 0 = 0 + x = x</code>). </p>\n\n<p>For the original problem (composing a list of functions) we can do the same:</p>\n\n<pre><code>func xs = foldr (.) id xs\n</code></pre>\n\n<p>Indeed, the identity function <code>id</code> is the neutral element of composition.\nWe can even eta-contract the above to</p>\n\n<pre><code>func = foldr (.) id\n</code></pre>\n\n<p>or, if preferred, use explicit recursion</p>\n\n<pre><code>func []     y = y\nfunc (x:xs) y = x (func xs y)\n  -- or equivalently (x . func xs) y\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": false, "score": 0, "last_activity_date": 1431226407, "creation_date": 1431226407, "answer_id": 30147228, "question_id": 30144925, "link": "https://stackoverflow.com/questions/30144925/haskell-list-of-functions-that-operate-on-single-value/30147228#30147228", "title": "Haskell - List of functions that operate on single value", "body": "<p>Another way of looking at this:</p>\n\n<p>After realising that the type you want should be <code>[a -&gt; a] -&gt; a -&gt; a</code>. Adding redundant parentheses to change the emphasis we get <code>[a -&gt; a] -&gt; (a -&gt; a)</code>; another way of looking at your function is that it takes a list of functions and \"condenses\" them down to single function.</p>\n\n<p>That sounds extremely similar to function composition, and it is! You're basically specified composition of a list of functions instead of the <code>.</code> operator which composes two of them; we just want to \"keep composing all of the functions until there's only one left\". Now it sounds very much like a fold:</p>\n\n<pre><code>func' :: [a -&gt; a] -&gt; (a -&gt; a)\nfunc' = foldr (.) _\n</code></pre>\n\n<p>But what do we fill in the blank with? GHC actually tells us (at least for GHC >= 7.8)!</p>\n\n<pre><code>foo.hs:3:19:\n    Found hole \u2018_\u2019 with type: a -&gt; a\n    Where: \u2018a\u2019 is a rigid type variable bound by\n               the type signature for func' :: [a -&gt; a] -&gt; a -&gt; a at foo.hs:2:10\n    Relevant bindings include\n      func' :: [a -&gt; a] -&gt; a -&gt; a (bound at foo.hs:3:1)\n    In the second argument of \u2018foldr\u2019, namely \u2018_\u2019\n    In the expression: foldr (.) _\n    In an equation for \u2018func'\u2019: func' = foldr (.) _\n</code></pre>\n\n<p>Concentrate on the <code>Found hole \u2018_\u2019 with type: a -&gt; a</code> bit.</p>\n\n<p>If you've been doing this a while you'll know that the only reasonable function with type <code>a -&gt; a</code> for any <code>a</code> is <code>id</code>, so that seems like a good candidate. Thinking about it from your specification also leads to <code>id</code>; the \"starting value\" of a fold over function composition must be a function to be composed with all the others; we don't want it to do anything, so <code>id</code> makes sense. It's also the function that will be applied to the value if our list of functions is empty (e.g. <code>func [] x</code>) - \"applying no functions to a value\" sounds like it should just leave it unchanged, so again <code>id</code> fits the bill.</p>\n\n<p>So<sup>1</sup>:</p>\n\n<pre><code>func' :: [a -&gt; a] -&gt; (a -&gt; a)\nfunc' = foldr (.) id\n</code></pre>\n\n<p>Why do I write <code>func'</code>? Because this isn't your <code>func</code>; you specified that the value should first pass through the first function in the list, then the second, and finally the last. This means the way to get the effect of <code>f1 (f2 (f3 (f4 x)))</code> out of your <code>func</code> is to write <code>func [f4, f3, f2, f1] x</code>; the left-to-write order of the functions when you write out the full application is the opposite of the left-to-write order of the functions in the list. <code>.</code> composes in the opposite order, and so does building our list compose by folding with <code>.</code>: <code>func' [f1, f2, f3, f4] x = f1 (f2 (f3 (f4 x)))</code>.</p>\n\n<p>But that's an easy fix; we can just pipe the list of functions through <code>reverse</code> before feeding it to the fold! Which give us:</p>\n\n<pre><code>func :: [a -&gt; a] -&gt; (a -&gt; a)\nfunc = foldr (.) id . reverse\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>\u03bb func [(\"f1 . \" ++), (\"f2 . \" ++), (\"f3 . \" ++)] \"id $ x\"\n\"f3 . f2 . f1 . id $ x\"\n</code></pre>\n\n<hr>\n\n<p><sup>1</sup> \"But wait!\" I hear you cry, \"doesn't function composition form a monoid with <code>id</code> as the identity element?\". Mathematically yes it does, and so actually this function \"could\" just be: <code>func' = mconcat</code>. But that <code>Monoid</code> instance doesn't actually exist in Haskell, because it requires extentions to write and would overlap with another <code>Monoid</code> instance which does exist in the prelude. In <code>Data.Monoid</code> there's a newtype wrapper <code>Endo a</code> (wrapping <code>a -&gt; a</code>), which does have the instance.</p>\n\n<p>So you could write <code>func' = appEndo . mconcat . map Endo</code>, but at that point it's debatable that we're being \"simpler\" than the fold by exploiting the monoid structure.</p>\n"}], "owner": {"reputation": 13, "user_id": 4882971, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c335822229ffbe96f2eb201b1a98d39?s=128&d=identicon&r=PG&f=1", "display_name": "Rick James", "link": "https://stackoverflow.com/users/4882971/rick-james"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 339, "favorite_count": 0, "accepted_answer_id": 30145004, "answer_count": 3, "score": 1, "last_activity_date": 1431226407, "creation_date": 1431204918, "last_edit_date": 1431206078, "question_id": 30144925, "link": "https://stackoverflow.com/questions/30144925/haskell-list-of-functions-that-operate-on-single-value", "title": "Haskell - List of functions that operate on single value", "body": "<p>I'm new to Haskell and am doing some beginner exercises I found. I have a function that takes in a list of functions and a value. I need send that value through each function in the list, beginning at the head, and return that value. I've considered recursion and folds...but I think some kind of recursive approach would be the way to go. </p>\n\n<p>I attempted a recursive approach like below, but it gets to the base case, returns, and I can't combine it properly</p>\n\n<pre><code>func xs y =\n if length xs == 1 then\n  (head xs) y\n else\n  (head xs) y : func (drop 1 xs) y\n</code></pre>\n\n<p>I just can't figure it out!\nAny help would be great, thank you!!!</p>\n"}, {"tags": ["haskell", "text"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 3, "creation_date": 1431196600, "post_id": 30143475, "comment_id": 48395814, "body": "Is performance a concern, or would  <code>pack &lt;$&gt; readMaybe</code> suffice?"}], "answers": [{"tags": [], "owner": {"reputation": 1521, "user_id": 365807, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8c9db2824164d60fe55d2b0c1c361f20?s=128&d=identicon&r=PG", "display_name": "Fraser", "link": "https://stackoverflow.com/users/365807/fraser"}, "is_accepted": true, "score": 5, "last_activity_date": 1431202431, "creation_date": 1431202431, "answer_id": 30144540, "question_id": 30143475, "link": "https://stackoverflow.com/questions/30143475/is-there-a-haskell-readmaybe-function-for-text/30144540#30144540", "title": "Is there a Haskell readMaybe function for Text?", "body": "<p>are you looking for a function <code>Read a =&gt; Text -&gt; Maybe a</code>? Use <code>readMaybe . unpack</code>. Unfortunately there's no way to make it more efficient since the <code>Read</code> typeclass is restricted to <code>String</code>. If you need it to be from <code>Text</code>s without any intermediate step, you'd have to implement an <code>attoparsec</code> or <code>parsec</code> parser.</p>\n"}], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 486, "favorite_count": 0, "accepted_answer_id": 30144540, "answer_count": 1, "score": 4, "last_activity_date": 1431283520, "creation_date": 1431195568, "last_edit_date": 1431283520, "question_id": 30143475, "link": "https://stackoverflow.com/questions/30143475/is-there-a-haskell-readmaybe-function-for-text", "title": "Is there a Haskell readMaybe function for Text?", "body": "<p>Question says it all: Is there a <a href=\"https://hackage.haskell.org/package/base-4.7.0.1/docs/Text-Read.html#g:3\" rel=\"nofollow\"><code>readMaybe</code></a> for <a href=\"https://hackage.haskell.org/package/text\" rel=\"nofollow\"><code>Text</code></a> ? I cannot seem to find a package to implement it.</p>\n"}, {"tags": ["haskell", "yesod"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2879704"}, "edited": false, "score": 0, "creation_date": 1431195307, "post_id": 30143307, "comment_id": 48395406, "body": "hi leftaroundabout, thanks for spending a lot of time on this question... i have this doubt <code>storeS &lt;- liftIO $ readIORef (reqStore yourYesod)</code> Vs <code>storedReq &lt;- readIORef store</code>. Why is the <code>liftIO</code> function used in the first case?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1431195738, "post_id": 30143307, "comment_id": 48395556, "body": "My mistake, <code>liftIO</code> is actually needed in both cases. Why it&#39;s needed: all those \u201cmutable variables\u201d are really just references; the references themselves live in the Yesod or the local scope, but the actual mutable <i>content</i> they&#39;re pointing to is in the messy general <code>IO</code> monad, and Haskellers generally avoid exposing that. Yesod&#39;s monads <i>can</i> access <code>IO</code>, but only by explicitly lifting."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 6, "last_activity_date": 1431195487, "last_edit_date": 1431195487, "creation_date": 1431194401, "answer_id": 30143307, "question_id": 30143081, "link": "https://stackoverflow.com/questions/30143081/post-and-get-a-variable-using-yesod-server/30143307#30143307", "title": "Post and Get a variable using yesod server", "body": "<p>Using global constants is trivial in Haskell: you just write <code>foo = bla</code> somewhere (preferrably with a signature <code>foo :: FooType</code>). <code>foo</code> can then be used anywhere in your module (or even outside, if you export it).</p>\n\n<p><em>Global variables</em> OTOH aren't really possible in Haskell, as such. For the most part, that's a good thing because global state tends to lead to <em>lots</em> of bugs. Often when programmers think about global variables, it turns out global constants would be just fine, or otherwise the mutable state should better be re-written as explicit parameters.</p>\n\n<p>Sometimes however you pretty much do need state variables. In Yesod in particular, there's a place where you can store them sort-of globally: <em>the Yesod</em>. That is the data structure that your web application has as its &ldquo;basement&rdquo;. For instance, you may have</p>\n\n<pre><code>data YourYesod = YourYesod {\n      ...\n      , reqStore :: IORef RequestBody   -- IORef basically means, it's variable\n                                        -- in the imperative sense.\n      ...\n      }\n\nmkYesod \"YourYesod\" [parseRoutes| ... |]\n</code></pre>\n\n<p>The Yesod can be accessed from anywhere in the <code>Handler</code> etc. monads, e.g. in</p>\n\n<pre><code>getHomeR :: Handler Html\ngetHomeR = do\n    ...\n    yourYesod &lt;- getYesod           -- gain \"access\" to the Yesod\n    storeS &lt;- liftIO $ readIORef (reqStore yourYesod)  -- look up the variable state\n    ...\n    liftIO $ writeIORef (reqStore yourYesod) newStoreS -- write new state\n    ...\n</code></pre>\n\n<p>At the beginning of the program, the <code>reqStore</code> will need to be initialised, by something like</p>\n\n<pre><code>main :: IO ()\nmain = do\n   ...\n   initReqStore = newIORef emptyRequest\n   ...\n   warp 3000 $ YourYesod ... initReqStore ...\n</code></pre>\n\n<p>Before doing it this way, think about whether the <code>store</code> variable really needs to be that global. The Yesod is pretty much the most global scope you have for stuff like that; that means also danger of those typical bugs like in procedural languages. If the variable is only used within one handler, you might as well just introduce it locally, like</p>\n\n<pre><code>               do\n                 ...\n                 store &lt;- newIORef emptyRequest\n                 appPost \"/\" $ \\req res -&gt; do\n                       liftIO $ writeIORef store $ body req\n                 appGet \"/\" $ \\req res -&gt; do\n                       storedReq &lt;- liftIO $ readIORef store\n                       send res storedReq\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2879704"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 30143307, "answer_count": 1, "score": 3, "last_activity_date": 1431195487, "creation_date": 1431193006, "question_id": 30143081, "link": "https://stackoverflow.com/questions/30143081/post-and-get-a-variable-using-yesod-server", "title": "Post and Get a variable using yesod server", "body": "<pre><code>var express = require('express')\nvar app = express()\nvar store = undefined\n\napp.post(\"/\", function(req, res){\n  store = req.body\n})\n\napp.get(\"/\", function(req, res){\n  res.send(store)\n} \napp.listen(some_port_num)\n</code></pre>\n\n<p>This is a simple nodejs/express server application which stores the http request body in a global variable and sends the same variable as responsse on a get request. </p>\n\n<p>How to write this code in yesod/haskell. I don't know how to use global/module-scoped variables in haskell/yesod. And, is there any other way to share variables between two  functions in haskell?</p>\n"}, {"tags": ["string", "haskell", "replace", "backslash"], "comments": [{"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1431201425, "post_id": 30143020, "comment_id": 48397285, "body": "The escaping makes this a bit confusing. Are you looking for a function that turns a \\ followed by an n into an actual newline character?"}, {"owner": {"reputation": 881, "user_id": 646565, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Cu0yq.jpg?s=128&g=1", "display_name": "freinn", "link": "https://stackoverflow.com/users/646565/freinn"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1431203003, "post_id": 30143020, "comment_id": 48397772, "body": "@DavidYoung Now it&#39;s edited and I think that is more clear. When I do <code>getArgs</code>, that getArgs give me a <code>String</code> with those <code>\\\\n</code>, so my parser can&#39;t parse that and my program fails."}, {"owner": {"reputation": 707, "user_id": 646408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e62561db40e46118628b31cba87840d6?s=128&d=identicon&r=PG", "display_name": "lpsmith", "link": "https://stackoverflow.com/users/646408/lpsmith"}, "edited": false, "score": 0, "creation_date": 1431205708, "post_id": 30143020, "comment_id": 48398487, "body": "Note that when you <code>print</code> a string that contains a single backslash,  Haskell will quote that backslash.   Are you sure that the string actually contains a double backslash,  or might it just have a <code>\\n</code> in it?  The confusing thing about your question is that in Haskell syntax,  the first string contains a <code>\\n</code>,  whereas the second contains a literal ascii newline character."}, {"owner": {"reputation": 881, "user_id": 646565, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Cu0yq.jpg?s=128&g=1", "display_name": "freinn", "link": "https://stackoverflow.com/users/646565/freinn"}, "reply_to_user": {"reputation": 707, "user_id": 646408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e62561db40e46118628b31cba87840d6?s=128&d=identicon&r=PG", "display_name": "lpsmith", "link": "https://stackoverflow.com/users/646408/lpsmith"}, "edited": false, "score": 0, "creation_date": 1431207410, "post_id": 30143020, "comment_id": 48398944, "body": "@lpsmith yes, I edit and include the link to github.com for you to see the entire code and some comments with examples."}], "answers": [{"tags": [], "owner": {"reputation": 881, "user_id": 646565, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Cu0yq.jpg?s=128&g=1", "display_name": "freinn", "link": "https://stackoverflow.com/users/646565/freinn"}, "is_accepted": true, "score": 2, "last_activity_date": 1431250717, "creation_date": 1431250717, "answer_id": 30149876, "question_id": 30143020, "link": "https://stackoverflow.com/questions/30143020/removing-double-backslash-from-string-containing-some-of-them/30149876#30149876", "title": "removing double backslash from string containing some of them", "body": "<p>The needed function is:</p>\n\n<pre><code>foo :: String -&gt; String\nfoo s = read $ \"\\\"\" ++ s ++ \"\\\"\"\n</code></pre>\n\n<p>That achieves what I wanted, transform:</p>\n\n<p>\"(case (+ 5 5) ((4 9 1) 'd64)\\\\n((1 2) 'pepito)\\\\n((10) '789.456)\"  </p>\n\n<p>into  </p>\n\n<p>\"(case (+ 5 5) ((4 9 1) 'd64)\\n((1 2) 'pepito)\\n((10) '789.456)\"</p>\n\n<p>and now my parser is working like a charm</p>\n"}], "owner": {"reputation": 881, "user_id": 646565, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/Cu0yq.jpg?s=128&g=1", "display_name": "freinn", "link": "https://stackoverflow.com/users/646565/freinn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 641, "favorite_count": 0, "accepted_answer_id": 30149876, "answer_count": 1, "score": -2, "last_activity_date": 1431250717, "creation_date": 1431192590, "last_edit_date": 1431207873, "question_id": 30143020, "link": "https://stackoverflow.com/questions/30143020/removing-double-backslash-from-string-containing-some-of-them", "title": "removing double backslash from string containing some of them", "body": "<p>I'm having trouble cause I can't define a function to do this:</p>\n\n<p>Input: \"(case (+ 5 5) ((4 9 1) 'd64)\\\\n((1 2) 'pepito)\\\\n((10) 'jorgito)\"<br>\nOutput: \"(case (+ 5 5) ((4 9 1) 'd64)\\n((1 2) 'pepito)\\n((10) 'jorgito)\"</p>\n\n<p>I've tried this and many other, without success:</p>\n\n<pre><code>import Data.List.Split (splitOn)\nimport Data.List (intersperse)\nimport Data.Char\n\nreplace :: String -&gt; String -&gt; String -&gt; [String]\nreplace current next [] = []\nreplace current next xs = intersperse [chr 92] $ splitOn current xs\n</code></pre>\n\n<p>I know the last function is not well coded looking their arguments, but I tried to do a replace function for \"all strings\" but I can't by now.</p>\n\n<p>Then, my parser can't work cause is something like this:</p>\n\n<pre><code>parseCaseResult :: Parser LispVal\nparseCaseResult = do\n    char '\\''\n    first &lt;- (letter &lt;|&gt; symbol) --de momento ser\u00e1 una String\n    rest &lt;- many (digit &lt;|&gt; letter &lt;|&gt; symbol)\n    return $ String (first:rest)\n\nparseCasePair :: Parser CasePair\nparseCasePair = do\n    list &lt;- lexeme (char '(') &gt;&gt; (lexeme (char '(')) *&gt; parseList &lt;* (lexeme $ char ')')\n    result &lt;- lexeme $ parseCaseResult &lt;* char ')'\n    return (list, result)\n\nparseCaseExpr :: Parser LispVal\nparseCaseExpr = do\n    lexeme $ char '('\n    lexeme $ string \"case\"\n    conditional_expr &lt;- lexeme (char '(') *&gt; parseList &lt;* lexeme (char ')')\n    -- armada en las nuevas l\u00edneas, solucionado con un parser m\u00e1s trabajado\n    lista &lt;- sepBy parseCasePair newline -- $ try (string \"\\\\\\\\\\n\") &lt;|&gt; try (string \"\\n\") &lt;|&gt; string \"\\r\"\n    return $ CaseExpr conditional_expr lista\n</code></pre>\n\n<p>New info:</p>\n\n<p><a href=\"https://github.com/freinn/libroshaskell/blob/master/write48/cap_5/ejercicio_3.hs\" rel=\"nofollow\">Complete code in github.com</a></p>\n\n<p>Example that works in GHCi:</p>\n\n<pre><code>*Main&gt; eval $ fromRight $ parse parseExpr \"jaja\" \"(case (+ 5 5) ((4 9 1)   'd64\\n((1 2) 'pepito\\n((10) 'jorgito)\"  \n10 (4 9 1)\n10 (1 2)\n10 (10)\nRight \"jorgito\"\n</code></pre>\n\n<p>But if I compile and run the <code>main</code> function, the code does not work I think because the parser doesn't match those <code>\\\\n</code>.</p>\n\n<p>Sorry for the bad explanation in earlier versions of this question.</p>\n"}, {"tags": ["python", "haskell"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1431192574, "post_id": 30142933, "comment_id": 48394515, "body": "Also see this nice answer from @leftaroundbot: <a href=\"http://stackoverflow.com/a/20188103/1651941\">stackoverflow.com/a/20188103/1651941</a>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1431201206, "post_id": 30142933, "comment_id": 48397220, "body": "I would recommend against learning any new language in this way, and strongly so when different paradigms are involved. Thinking in one paradigm and then translating into another can (and <i>will</i>) generate very unidiomatic code, at best."}], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1431193678, "post_id": 30142986, "comment_id": 48394908, "body": "It&#39;s worth noting that this is still remarkably similar to the original Python code :)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1431201366, "post_id": 30142986, "comment_id": 48397268, "body": "@chepner Yes, but mind the warning in the first line of this answer. The code may look similar, but there are some profound differences. For one, the original Python code <i>prints</i> a string, while the Haskell code <i>returns</i> it."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1431291040, "post_id": 30142986, "comment_id": 48420051, "body": "Yes, but even something like <code>greet :: Person -&gt; IO ()</code>, <code>greet p = putStr $ &quot;Good day, &quot; ...</code> is still pretty easy to understand what it&#39;s doing. (Even you don&#39;t entirely understand what <code>IO ()</code> means or the exact syntax.)"}], "tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": false, "score": 10, "last_activity_date": 1431192493, "last_edit_date": 1431192493, "creation_date": 1431192415, "answer_id": 30142986, "question_id": 30142933, "link": "https://stackoverflow.com/questions/30142933/python-objects-and-methods-in-haskell/30142986#30142986", "title": "Python objects and methods in haskell", "body": "<p>First don't think with an OOPS mind, that will just not work out with Haskell and would cause you pain.</p>\n\n<p>Try to think the problem in terms of the Haskell way,</p>\n\n\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Person = Person { fname :: String, lname :: String } deriving Show\n\ngreet :: Person -&gt; String\ngreet p = \"Good day, \" ++ fname p ++ \", \" ++ lname p\n</code></pre>\n\n<p>Demo in ghci:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>\u03bb&gt; greet $ Person \"Erik\" \"Meijer\"\n\"Good day, Erik, Meijer\"\n</code></pre>\n\n<p>See how simple was that ?</p>\n"}, {"comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1431261454, "post_id": 30149825, "comment_id": 48410273, "body": "Note that your <code>Human</code> typeclass is sort of isomorphic to <code>Show</code>."}], "tags": [], "owner": {"reputation": 729, "user_id": 1838505, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0012b91653dc7d12e75c5823bee3d8f2?s=128&d=identicon&r=PG", "display_name": "Shanthakumar", "link": "https://stackoverflow.com/users/1838505/shanthakumar"}, "is_accepted": true, "score": 4, "last_activity_date": 1431250320, "creation_date": 1431250320, "answer_id": 30149825, "question_id": 30142933, "link": "https://stackoverflow.com/questions/30142933/python-objects-and-methods-in-haskell/30149825#30149825", "title": "Python objects and methods in haskell", "body": "<p>lets try to port it to Haskell literally..</p>\n\n<pre><code>data Person = Person { fname :: String\n                     , lname :: String \n                     }   \n</code></pre>\n\n<p>In your Python code, any Person object can perform an action greet() that does some IO which gets translated to Haskell as:</p>\n\n<pre><code>greet :: Person -&gt; IO ()\ngreet person = putStrLn $ (fname person) ++ \" \" ++ (lname person)\n</code></pre>\n\n<p>then you would write main as:</p>\n\n<pre><code>main :: IO ()\nmain = greet $ Person \"Ben\" \"Tennyson\"\n</code></pre>\n\n<p>Now, what's wrong in doing it that way ? - Purity.</p>\n\n<p>Haskell idioms provides ways to keep pure and impure code separate.\nlets try to do it Haskell way...</p>\n\n<p>Create a Category <strong>Human</strong> whose elements could be a <strong>Person</strong>/<strong>Student</strong>/<strong>Employee</strong> or whatever who all share a common action <em>greet()</em></p>\n\n<pre><code>class Human a where\n  greet :: a -&gt; String\n</code></pre>\n\n<p>We can also create a <strong>Show</strong> instance for our <strong>Person</strong> type:</p>\n\n<pre><code>instance Show Person where\n  show person = (fname person) ++ \" \" ++ (lname person)\n</code></pre>\n\n<p>then create a <strong>Human</strong> instance for <strong>Person</strong> implementing <em>greet()</em> action:</p>\n\n<pre><code>instance Human Person where\n  greet person = \"Hello, \" ++ (show person)\n\nmain :: IO ()\nmain = putStrLn . greet $ Person \"Ben\" \"Tennyson\"\n\n-- \u03bb main\n-- Hello, Ben Tennyson\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2879704"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 30149825, "answer_count": 2, "score": -1, "last_activity_date": 1431250320, "creation_date": 1431192117, "last_edit_date": 1431192425, "question_id": 30142933, "link": "https://stackoverflow.com/questions/30142933/python-objects-and-methods-in-haskell", "title": "Python objects and methods in haskell", "body": "<pre><code>class Person:\n  def __init(fname, lname):\n    this.fname = fname\n    this.lname = lname\n\n  def greet():\n    print \"Good day, \" + fname + \", \" + lname\n\nif __name__ == \"__main__\":\n  p = Person(\"saravana\", \"kumar\")\n  p.greet()\n</code></pre>\n\n<p>outputs,</p>\n\n<pre><code>hello saravana, kumar\n</code></pre>\n\n<p>How can this simple python code be ported to haskell? I am keen on learning oops concept like initializing object states and accessing them through methods in the haskell language.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 3, "creation_date": 1431184606, "post_id": 30141515, "comment_id": 48391862, "body": "Probably some optimization enabled by <code>-O2</code> is going awry, but is blocked by the profiling annotations added by <code>-fprof-auto</code>. Specifically GHC might have decided that <code>mimeMap</code> is used only once and moved the <code>M.fromList</code> into the second loop. Try building with <code>-fno-state-hack</code>."}, {"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "edited": false, "score": 0, "creation_date": 1431185858, "post_id": 30141515, "comment_id": 48392236, "body": "I can&#39;t reproduce the slow behavior. How big are <code>n</code> and <code>q</code> in your situation?"}, {"owner": {"reputation": 8806, "user_id": 257418, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/97Mb4.png?s=128&g=1", "display_name": "Lynn", "link": "https://stackoverflow.com/users/257418/lynn"}, "edited": false, "score": 2, "creation_date": 1431186262, "post_id": 30141515, "comment_id": 48392373, "body": "<a href=\"https://ghc.haskell.org/trac/ghc/ticket/1957\" rel=\"nofollow noreferrer\">This ghc ticket</a> is also about IO code that runs slower with optimizations on, and gets sped up significantly by compiling with <code>-fno-state-hack</code> like Reid Barton mentioned. There&#39;s some more discussion about this on <a href=\"http://comments.gmane.org/gmane.comp.lang.haskell.glasgow.user/13941\" rel=\"nofollow noreferrer\">the mailing list</a>."}, {"owner": {"reputation": 11293, "user_id": 981855, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/44e220c5150326866af030a7c9d944b3?s=128&d=identicon&r=PG", "display_name": "madjar", "link": "https://stackoverflow.com/users/981855/madjar"}, "edited": false, "score": 0, "creation_date": 1431210221, "post_id": 30141515, "comment_id": 48399678, "body": "<code>n</code> and <code>q</code> are 9999 each. The problematic input can be found there: <a href=\"http://www.codingame.com/ide/fileservlet?id=1632865475298\" rel=\"nofollow noreferrer\">codingame.com/ide/fileservlet?id=1632865475298</a>. Sadly, <code>-fno-state-hack</code> doesn&#39;t seem to fix it. However, building without optimization does indeed make it much faster."}, {"owner": {"reputation": 11293, "user_id": 981855, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/44e220c5150326866af030a7c9d944b3?s=128&d=identicon&r=PG", "display_name": "madjar", "link": "https://stackoverflow.com/users/981855/madjar"}, "edited": false, "score": 0, "creation_date": 1431210759, "post_id": 30141515, "comment_id": 48399817, "body": "Also, strictly evaluating mimeMap with a bang pattern prevents the slowdown."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1431235566, "post_id": 30141515, "comment_id": 48403930, "body": "Could you include your code that does file reading? (instead of stdin reading, as we see here)."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1431235977, "post_id": 30141515, "comment_id": 48404006, "body": "(I used <code>openFile</code> and changed the <code>getLine</code>-s to <code>hGetLine handle</code> and indeed I can reproduce the slowdown beautifully, even on ghc 7.8.4)."}, {"owner": {"reputation": 11293, "user_id": 981855, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/44e220c5150326866af030a7c9d944b3?s=128&d=identicon&r=PG", "display_name": "madjar", "link": "https://stackoverflow.com/users/981855/madjar"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1431248946, "post_id": 30141515, "comment_id": 48406888, "body": "@Andr&#225;sKov&#225;cs forgive me if I misunderstand, but this is the code I use. I pass the file directly to stdin by calling it with <code>.&#47;coding Test_5_input.txt</code>."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1431313606, "post_id": 30141515, "comment_id": 48425224, "body": "Thanks for including the input file. <code>-fno-state-hack</code> did fix it for me, are you sure you recompiled?"}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1431313625, "post_id": 30141515, "comment_id": 48425228, "body": "Oops, it fixed it in 7.8 but not 7.10...!"}], "answers": [{"tags": [], "owner": {"reputation": 11293, "user_id": 981855, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/44e220c5150326866af030a7c9d944b3?s=128&d=identicon&r=PG", "display_name": "madjar", "link": "https://stackoverflow.com/users/981855/madjar"}, "is_accepted": true, "score": 2, "last_activity_date": 1431500770, "creation_date": 1431500770, "answer_id": 30207902, "question_id": 30141515, "link": "https://stackoverflow.com/questions/30141515/why-would-a-program-be-faster-in-runghc-or-with-profiling/30207902#30207902", "title": "Why would a program be faster in runghc or with profiling?", "body": "<p>To provide a complete answer to the question:</p>\n\n<p>As Reid Barton mentioned, the problem seems to be the infamous state hack optimization, which inlines <code>mimeMap</code> into the repeated IO action, executing it much more times than necessary. <code>-fno-state-hack</code> disables that optimization and solves the problem. Another way to solve the problem is to force a strict evaluation of ``mimeMap.</p>\n\n<pre><code>!mimeMap &lt;- fmap M.fromList $ replicateM n [...]\n</code></pre>\n\n<p>However, there also seems to be a <a href=\"https://ghc.haskell.org/trac/ghc/ticket/10401\" rel=\"nofollow\">regression in GHC 7.10</a>, in which <code>-fno-state-hack</code> does not solves the problem. That explains why it didn't fix it for me.</p>\n\n<p>Thanks a lot everyone for your answers.</p>\n"}], "owner": {"reputation": 11293, "user_id": 981855, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/44e220c5150326866af030a7c9d944b3?s=128&d=identicon&r=PG", "display_name": "madjar", "link": "https://stackoverflow.com/users/981855/madjar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "accepted_answer_id": 30207902, "answer_count": 1, "score": 9, "last_activity_date": 1431500770, "creation_date": 1431183937, "last_edit_date": 1431211503, "question_id": 30141515, "link": "https://stackoverflow.com/questions/30141515/why-would-a-program-be-faster-in-runghc-or-with-profiling", "title": "Why would a program be faster in runghc or with profiling?", "body": "<p>I've got the following program that takes a big input (a list of extension/mime mapping, a list of files) and output results line by line (the mime type for each file).</p>\n\n<pre><code>import System.IO\nimport Control.Monad\nimport qualified Data.Map as M\nimport System.FilePath\nimport Data.Char\n\nmain :: IO ()\nmain = do\n    input_line &lt;- getLine\n    let n = read input_line :: Int -- Number of elements which make up the association table.\n    input_line &lt;- getLine\n    let q = read input_line :: Int -- Number Q of file names to be analyzed.\n\n    mimeMap &lt;- fmap M.fromList $ replicateM n $ do\n        input_line &lt;- getLine\n        let input = words input_line\n        let ext = input!!0 -- file extension\n        let mt = input!!1 -- MIME type.\n        return (map toLower ext, mt)\n\n    replicateM_ q $ do\n        fname &lt;- getLine\n        let ext = map toLower . drop 1 . takeExtension $ fname\n            mime = M.findWithDefault \"UNKNOWN\" ext mimeMap\n        putStrLn mime\n</code></pre>\n\n<p>The program was quite slow, so I started profiling it, and I got a strange result.</p>\n\n<p>When compiled with</p>\n\n<pre><code>ghc --make -O2 coding.hs\n</code></pre>\n\n<p>the program is very slow. However, the <code>-fprof-auto</code> seems to speed it all up. Compiled with</p>\n\n<pre><code>ghc --make -O2 coding.hs -prof -fprof-auto -fforce-recomp\n</code></pre>\n\n<p>makes it blazing fast <code>-prof</code> alone has no effect.</p>\n\n<p>Strangely, it is also very fast when run with <code>runghc coding.hs</code>.</p>\n\n<p>I have no idea in what direction to go from there. Does anyone understand what is happenning here?</p>\n\n<p>EDIT: I should mention that my ghc is 7.10.1.</p>\n"}, {"tags": ["haskell", "configuration-files"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1431179308, "post_id": 30140175, "comment_id": 48390078, "body": "Implicit arguments or reader monad are common choices, but they do require some change."}, {"owner": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 1, "creation_date": 1431182521, "post_id": 30140175, "comment_id": 48391146, "body": "Have a look at <a href=\"http://okmij.org/ftp/Haskell/types.html#Prepose\" rel=\"nofollow noreferrer\">Implicit configurations -- or, type classes reflect the values of types</a>, if it could help."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 60057, "user_id": 1333025, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/79ab43010f900324ac5e2de19a2916cb?s=128&d=identicon&r=PG", "display_name": "Petr", "link": "https://stackoverflow.com/users/1333025/petr"}, "edited": false, "score": 2, "creation_date": 1431254727, "post_id": 30140175, "comment_id": 48408371, "body": "Expanding on @Petr Pudl&#225;k comment, an implementation of implicit configurations can be found in the <code>reflection</code> package. In the examples folder from the repo there&#39;s a &quot;reader-like&quot; example that seems relevant: <a href=\"https://github.com/ekmett/reflection/blob/master/examples/ReaderLike.hs\" rel=\"nofollow noreferrer\">github.com/ekmett/reflection/blob/master/examples/ReaderLike&zwnj;&#8203;.hs</a>. See also this SO answer for an example of use: <a href=\"http://stackoverflow.com/a/29929718/1364288\">stackoverflow.com/a/29929718/1364288</a>"}], "answers": [{"tags": [], "owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "is_accepted": false, "score": 0, "last_activity_date": 1431186495, "creation_date": 1431186495, "answer_id": 30141977, "question_id": 30140175, "link": "https://stackoverflow.com/questions/30140175/moving-from-static-configuration-to-dynamic-configuration/30141977#30141977", "title": "Moving from static configuration to dynamic configuration", "body": "<p>What you are asking, if it was possible would break referential transparency, at least for pure function ( a pure function result can depend on some global variables but not on a config file couldn't it ) ?</p>\n\n<p>Usually people avoid that type of situation by passing implicitly  the configuration as data via a Monad. Alternatively (if you are happy to refactor your code a bit) you can use the <a href=\"https://wiki.haskell.org/Implicit_parameters\" rel=\"nofollow\">implicit parameter extenson</a>, which in theory has been made to solve that type of problem but in practice doesn't really work.\nHowever, if you really need, you can use <code>unsafePerformIO</code> and <code>ioRef</code> to have a <a href=\"https://wiki.haskell.org/Top_level_mutable_state\" rel=\"nofollow\">top level mutable state</a> which is dirty and frowned upton. You need a top level mutable state, because you need to be able to modify \"mutate\" your initial config when you are loading it.</p>\n\n<p>Then you get things like that :</p>\n\n<pre><code>myGlobalVar :: IORef Int\n{-# NOINLINE myGlobalVar #-}\nmyGlobalVar = unsafePerformIO (newIORef 17)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1431359061, "post_id": 30151044, "comment_id": 48450110, "body": "How is it different from implicit parameters. If <code>f</code> call <code>g</code> which needs the constraint, does <code>f</code> needs the constraint as well ? If not, does <code>g</code> get the value ?"}, {"owner": {"reputation": 463, "user_id": 2976251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efe393a6e3c9fe3857dc7b27ff5db473?s=128&d=identicon&r=PG&f=1", "display_name": "hasufell", "link": "https://stackoverflow.com/users/2976251/hasufell"}, "reply_to_user": {"reputation": 20862, "user_id": 376113, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/d3a5bd12fe6d876527a3cf4ac0de5fc6?s=128&d=identicon&r=PG", "display_name": "mb14", "link": "https://stackoverflow.com/users/376113/mb14"}, "edited": false, "score": 0, "creation_date": 1431364104, "post_id": 30151044, "comment_id": 48453265, "body": "Yes, <code>f</code> needs the constraint as well. I have updated the code. Also, your question is excellent and I can only vaguely answer it. But the paper which reflection is based on <a href=\"http://okmij.org/ftp/Haskell/tr-15-04.pdf\" rel=\"nofollow noreferrer\">okmij.org/ftp/Haskell/tr-15-04.pdf</a> mentions several advantages over &quot;implicit parameters&quot; in the Introduction and Section 6.2. Reflection is supposed to play more &quot;nicely&quot; with the type system and supports concurrent sets of parameters better."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1431370819, "post_id": 30151044, "comment_id": 48457149, "body": "<code>give</code> is Considered Evil. Edward Kmett has indicated that if other people wouldn&#39;t object so strongly, he would remove it altogether."}, {"owner": {"reputation": 463, "user_id": 2976251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efe393a6e3c9fe3857dc7b27ff5db473?s=128&d=identicon&r=PG&f=1", "display_name": "hasufell", "link": "https://stackoverflow.com/users/2976251/hasufell"}, "edited": false, "score": 0, "creation_date": 1431384280, "post_id": 30151044, "comment_id": 48463626, "body": "Interesting, can you elaborate more on that or give a reference?"}, {"owner": {"reputation": 28832, "user_id": 34707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c51a8b8afa2366a2ef4650c411f187a?s=128&d=identicon&r=PG", "display_name": "Edward KMETT", "link": "https://stackoverflow.com/users/34707/edward-kmett"}, "edited": false, "score": 1, "creation_date": 1431442806, "post_id": 30151044, "comment_id": 48494277, "body": "<a href=\"http://ircbrowse.net/selection/haskell?title=Conversation&amp;events=20652226,20652227,20652228,20652233,20652235,20652237,20652239,20652240,20652245,20652246,20652252,20652254,20652258,20652259\" rel=\"nofollow noreferrer\">ircbrowse.net/selection/&hellip;</a>"}], "tags": [], "owner": {"reputation": 463, "user_id": 2976251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efe393a6e3c9fe3857dc7b27ff5db473?s=128&d=identicon&r=PG&f=1", "display_name": "hasufell", "link": "https://stackoverflow.com/users/2976251/hasufell"}, "is_accepted": false, "score": 4, "last_activity_date": 1431363501, "last_edit_date": 1431363501, "creation_date": 1431258636, "answer_id": 30151044, "question_id": 30140175, "link": "https://stackoverflow.com/questions/30140175/moving-from-static-configuration-to-dynamic-configuration/30151044#30151044", "title": "Moving from static configuration to dynamic configuration", "body": "<p>Thanks for the hints! I came up with a minimal example which shows how I will go about it with the <a href=\"https://hackage.haskell.org/package/reflection\" rel=\"nofollow\">reflection</a> package:</p>\n\n<pre><code>{-# LANGUAGE Rank2Types, FlexibleContexts, UndecidableInstances #-}\n\nimport Data.Reflection\n\ndata GlobalConfig = MkGlobalConfig {\n    getVal1 :: Int\n  , getVal2 :: Double\n  , getVal3 :: String\n}\n\nmain :: IO ()\nmain = do\n  let config = MkGlobalConfig 1 2.0 \"test\"\n  -- initialize the program flow via 'give'\n  print $ give config (doSomething 2)\n  -- this works too, the type is properly inferred\n  print $ give config (3 + 3)\n  -- and this as well\n  print $ give config (addInt 7 3)\n\n-- We need the Given constraint, because we call 'somethingElse', which finally\n-- calls 'given' to retrieve the configuration. So it has to be propagated up\n-- the program flow.\ndoSomething :: (Given GlobalConfig) =&gt; Int -&gt; Int\ndoSomething = somethingElse \"abc\"\n\n-- since we call 'given' inside the function to retrieve the configuration,\n-- we need the Given constraint\nsomethingElse :: (Given GlobalConfig) =&gt; String -&gt; Int -&gt; Int\nsomethingElse str x\n  | str == \"something\"      = x + getVal1 given\n  | getVal3 given == \"test\" = 0 + getVal1 given\n  | otherwise               = round (fromIntegral x * getVal2 given)\n\n-- no need for Given constraint here, since this does not use 'given'\n-- or any other functions that would\naddInt :: Int -&gt; Int -&gt; Int\naddInt = (+)\n</code></pre>\n\n<p>The <code>Given</code> class is a bit easier to work with and perfectly suitable for a global configuration model. All functions that do not make use of <code>given</code> (which gets the value) don't seem to need the class constraint. That means I only have to change functions that actually access the global configuration.</p>\n\n<p>That's what I was looking for.</p>\n"}], "owner": {"reputation": 463, "user_id": 2976251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efe393a6e3c9fe3857dc7b27ff5db473?s=128&d=identicon&r=PG&f=1", "display_name": "hasufell", "link": "https://stackoverflow.com/users/2976251/hasufell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 3, "answer_count": 2, "score": 6, "last_activity_date": 1431363501, "creation_date": 1431176103, "question_id": 30140175, "link": "https://stackoverflow.com/questions/30140175/moving-from-static-configuration-to-dynamic-configuration", "title": "Moving from static configuration to dynamic configuration", "body": "<p>I am working on a haskell project where the settings are currently in a file called <code>Setting.hs</code>, so they are checked during compile time and can be accessed globally.</p>\n\n<p>However, since that is a bit too static, I was considering to read the configuration during runtime. The codebase is huge and it seems it would be considerable effort to pass the setting e.g. as an argument through the whole program flow, since they may be arbitrarily accessed from anywhere.</p>\n\n<p>Are there any design patterns, libraries or even ghc extensions that can help here without refactoring the whole code?</p>\n"}, {"tags": ["debugging", "haskell", "types"], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 7, "last_activity_date": 1431179107, "last_edit_date": 1431179107, "creation_date": 1431167243, "answer_id": 30138805, "question_id": 30138726, "link": "https://stackoverflow.com/questions/30138726/what-is-the-nearest-equivalent-of-type-in-ghci-in-a-ghc-source-file/30138805#30138805", "title": "What is the nearest equivalent of :type in ghci in a ghc source file?", "body": "<p><a href=\"https://wiki.haskell.org/GHC/Typed_holes\" rel=\"nofollow\">Typed holes!</a></p>\n\n<pre><code>foo x =  length [x] + _\n</code></pre>\n\n<p>Compiling with GHC or loading into GHCi will give:</p>\n\n<pre><code>Found hole \u2018_\u2019 with type: Int\nRelevant bindings include\n  x :: a\n  foo :: a -&gt; Int\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": true, "score": 4, "last_activity_date": 1431233639, "creation_date": 1431233639, "answer_id": 30147871, "question_id": 30138726, "link": "https://stackoverflow.com/questions/30138726/what-is-the-nearest-equivalent-of-type-in-ghci-in-a-ghc-source-file/30147871#30147871", "title": "What is the nearest equivalent of :type in ghci in a ghc source file?", "body": "<p>A handy trick I've recently discovered is to use typed holes in combination with <code>asTypeOf</code><sup>1</sup>.</p>\n\n<p>If you have code that <em>does</em> compile, and you want to know what the type of an expression within it is, replacing that expression with a hole sometimes messes things up, as in:</p>\n\n<pre><code>           -- what is the type of this part, I wonder?\nf xs = 3 * length xs\n</code></pre>\n\n<p>Replacing <code>length xs</code> with a <code>_</code> reports:</p>\n\n<pre><code>foo.hs:1:12: Warning:\n    Found hole \u2018_\u2019 with type: a\n    Where: \u2018a\u2019 is a rigid type variable bound by\n               the inferred type of f :: t -&gt; a at foo.hs:1:1\n</code></pre>\n\n<p><code>length xs</code> is certainly not of type <code>a</code>!</p>\n\n<p>But if you use <code>asTypeOf</code>, you can leave the <code>length xs</code> there <em>and</em> insert a hole which has to have the same type as it:</p>\n\n<pre><code>f xs = 3 * (length xs `asTypeOf` _)\n</code></pre>\n\n<p>Now we get:</p>\n\n<pre><code>foo.hs:1:34: Warning:\n    Found hole \u2018_\u2019 with type: Int\n</code></pre>\n\n<p>Much better.</p>\n\n<hr>\n\n<p><sup>1</sup> <code>asTypeOf</code> is exactly the same as <code>const</code>, in that it returns its first argument and completely ignores its second. However its type forces the second argument to be the same as the first; it's designed to be written infix with backticks.</p>\n\n<p>It's designed for when you have an a sub-expression that's too polymorphic and GHC complains about ambiguous type variables; you could use an inline type declaration, but sometimes that's impossible without the <code>ScopedTypeVariables</code> extension. If you have another value that is the correct type, you can use <code>asTypeOf</code> to \"select\" the appropriate case from the polymorphic expression, without changing the value returned by the expression.</p>\n\n<p>My use of it here is \"backwards\" from the intended case; I want the thing on the left to constrain type of the (ignored) hole on the right, rather than the other way around.</p>\n"}], "owner": {"reputation": 645, "user_id": 2223605, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/f325a491aff2ce55a035c2a84888b10e?s=128&d=identicon&r=PG", "display_name": "v217", "link": "https://stackoverflow.com/users/2223605/v217"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 30147871, "answer_count": 2, "score": 3, "last_activity_date": 1431233639, "creation_date": 1431166775, "question_id": 30138726, "link": "https://stackoverflow.com/questions/30138726/what-is-the-nearest-equivalent-of-type-in-ghci-in-a-ghc-source-file", "title": "What is the nearest equivalent of :type in ghci in a ghc source file?", "body": "<p>If I want to compare types or just print type information in a Haskell source file, what options do I have?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1431164361, "post_id": 30138279, "comment_id": 48385729, "body": "Haskell functions are called <code>fun arg1 arg2 ...</code> not <code>fun(arg1, arg2, ...)</code>."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1431164432, "post_id": 30138279, "comment_id": 48385753, "body": "@AJFarmar Both of those are perfectly legal depending on the type of <code>fun</code>. What matters is that you call the function with the same type as you defined it."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 0, "creation_date": 1431164773, "post_id": 30138279, "comment_id": 48385837, "body": "@sepp2k I realise that, but for the sake of learning Haskell, it&#39;s ideal to show beginners the curried method."}, {"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1431165266, "post_id": 30138279, "comment_id": 48385951, "body": "I am sure the type checker does have ideas about it!"}, {"owner": {"reputation": 204954, "user_id": 1903116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w6Ffg.jpg?s=128&g=1", "display_name": "thefourtheye", "link": "https://stackoverflow.com/users/1903116/thefourtheye"}, "edited": false, "score": 2, "creation_date": 1431166076, "post_id": 30138279, "comment_id": 48386163, "body": "When you include code which doesn&#39;t work, please include the actual problem as well."}], "answers": [{"tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": false, "score": 5, "last_activity_date": 1431164094, "creation_date": 1431164094, "answer_id": 30138308, "question_id": 30138279, "link": "https://stackoverflow.com/questions/30138279/why-doesnt-such-a-recursive-haskell-function-work/30138308#30138308", "title": "Why doesn&#39;t such a recursive Haskell function work?", "body": "<p>The first argument to <code>rep'</code> should be an <code>Int</code>, but when you call it as <code>rep' (n-1, x)</code> the first and only argument is a tuple.</p>\n"}, {"tags": [], "owner": {"reputation": 204954, "user_id": 1903116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w6Ffg.jpg?s=128&g=1", "display_name": "thefourtheye", "link": "https://stackoverflow.com/users/1903116/thefourtheye"}, "is_accepted": true, "score": 10, "last_activity_date": 1431165634, "last_edit_date": 1431165634, "creation_date": 1431164158, "answer_id": 30138319, "question_id": 30138279, "link": "https://stackoverflow.com/questions/30138279/why-doesnt-such-a-recursive-haskell-function-work/30138319#30138319", "title": "Why doesn&#39;t such a recursive Haskell function work?", "body": "<p>Haskell expresses its problems and expectations in the error messages, like this</p>\n\n<pre><code>Prelude&gt; :{\nPrelude|     let\nPrelude|     {\nPrelude|         rep' :: Int -&gt; a -&gt; [a];\nPrelude|         rep' 0 x = [];\nPrelude|         rep' n x = x:rep' (n-1, x);\nPrelude|     }\nPrelude| :}\n\n&lt;interactive&gt;:73:22:\n    Couldn't match expected type `[a]' with actual type `a0 -&gt; [a0]'\n    In the return type of a call of rep'\n    Probable cause: rep' is applied to too few arguments\n    In the second argument of `(:)', namely `rep' (n - 1, x)'\n    In the expression: x : rep' (n - 1, x)\n\n&lt;interactive&gt;:73:27:\n    Couldn't match expected type `Int' with actual type `(Int, a)'\n    In the first argument of rep', namely `(n - 1, x)'\n    In the second argument of `(:)', namely `rep' (n - 1, x)'\n    In the expression: x : rep' (n - 1, x)\n</code></pre>\n\n<p>In the first section,</p>\n\n<pre><code>    Couldn't match expected type `[a]' with actual type `a0 -&gt; [a0]'\n    In the return type of a call of rep'\n    Probable cause: rep' is applied to too few arguments\n</code></pre>\n\n<p>says that, you have declared the return type of <code>rep'</code> as <code>[a]</code>, but it is returning <code>a0 -&gt; [a0]</code>, which means it is returning a partially applied function. The possible problem is also given to you as a hint</p>\n\n<pre><code>    Probable cause: rep' is applied to too few arguments\n</code></pre>\n\n<p>so you might be passing fewer arguments to the function <code>rep'</code>. And in the next section, the line</p>\n\n<pre><code>    Couldn't match expected type `Int' with actual type `(Int, a)'\n</code></pre>\n\n<p>says that it is expecting an <code>Int</code>, but it got <code>(Int, a)</code>. In Haskell, when you say <code>(n-1, x)</code>, it is treated as a tuple object, with two elements in it. So, you are actually invoking <code>rep'</code> with a single tuple object, not two parameters.</p>\n\n<p>To actually invoke <code>rep'</code> with two parameters you can do like this</p>\n\n<pre><code>rep' n x = x:rep' (n-1) x\n</code></pre>\n\n<p>Now, you are calling <code>rep'</code> with two arguments, <code>(n-1)</code> and <code>x</code>.</p>\n\n<pre><code>Prelude&gt; :{\nPrelude|     let\nPrelude|     {\nPrelude|         rep' :: Int -&gt; a -&gt; [a];\nPrelude|         rep' 0 x = [];\nPrelude|         rep' n x = x:rep' (n-1) x;\nPrelude|     }\nPrelude| :}\nPrelude&gt; rep' 5 100\n[100,100,100,100,100]\n</code></pre>\n"}], "owner": {"reputation": 38877, "user_id": 1272683, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6ea2bbebf39d8f4d9ba654471289d576?s=128&d=identicon&r=PG", "display_name": "Hanfei Sun", "link": "https://stackoverflow.com/users/1272683/hanfei-sun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 30138319, "answer_count": 2, "score": -1, "last_activity_date": 1431188741, "creation_date": 1431163827, "last_edit_date": 1431188741, "question_id": 30138279, "link": "https://stackoverflow.com/questions/30138279/why-doesnt-such-a-recursive-haskell-function-work", "title": "Why doesn&#39;t such a recursive Haskell function work?", "body": "<p>Here is the codes:</p>\n\n<pre><code>rep' :: Int -&gt; a -&gt; [a]\nrep' 0 x = []\nrep' n x = x:rep'(n-1, x)\n</code></pre>\n\n<p>I tried to rewrite it like this:</p>\n\n<pre><code>rep' :: Int -&gt; a -&gt; [a]\nrep' 0 x = []\nrep' n x = x:(rep' n-1 x)\n</code></pre>\n\n<p>but it doesn't work either.</p>\n\n<pre><code>baby.hs:3:15-20: Couldn't match expected type \u2018[a]\u2019 with actual type \u2018a0 -&gt; [a0]\u2019 \u2026\n    Relevant bindings include\n      x :: a (bound at /Users/hanfeisun/Workspace/haskell/baby.hs:3:8)\n      rep' :: Int -&gt; a -&gt; [a]\n        (bound at /Users/hanfeisun/Workspace/haskell/baby.hs:2:1)\n    Probable cause: \u2018rep'\u2019 is applied to too few arguments\n    In the first argument of \u2018(-)\u2019, namely \u2018rep' n\u2019\n    In the second argument of \u2018(:)\u2019, namely \u2018(rep' n - 1 x)\u2019\nCompilation failed.\n\u03bb&gt; \n</code></pre>\n\n<p>Does anyone have ideas about this?</p>\n"}, {"tags": ["haskell", "ghci"], "comments": [{"owner": {"reputation": 204954, "user_id": 1903116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w6Ffg.jpg?s=128&g=1", "display_name": "thefourtheye", "link": "https://stackoverflow.com/users/1903116/thefourtheye"}, "edited": false, "score": 0, "creation_date": 1431157943, "post_id": 30137424, "comment_id": 48384120, "body": "<code>it doesn&#39;t work either</code> What do you mean by that?"}, {"owner": {"reputation": 38877, "user_id": 1272683, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6ea2bbebf39d8f4d9ba654471289d576?s=128&d=identicon&r=PG", "display_name": "Hanfei Sun", "link": "https://stackoverflow.com/users/1272683/hanfei-sun"}, "reply_to_user": {"reputation": 204954, "user_id": 1903116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w6Ffg.jpg?s=128&g=1", "display_name": "thefourtheye", "link": "https://stackoverflow.com/users/1903116/thefourtheye"}, "edited": false, "score": 0, "creation_date": 1431158033, "post_id": 30137424, "comment_id": 48384140, "body": "@thefourtheye added the &quot;error information&quot;, it just says <code>parse error</code>"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1431158079, "post_id": 30137424, "comment_id": 48384149, "body": "Why are you putting a constraint symbol <code>=&gt;</code> in your type signature? It&#39;s pointless. The other problem is that you&#39;re missing an <code>=</code> after that <code>otherwise</code>."}, {"owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "edited": false, "score": 2, "creation_date": 1431158311, "post_id": 30137424, "comment_id": 48384201, "body": "@hanfeisun &quot;parse error&quot; isn&#39;t the only thing it says. It also gives you a line and column number, which of course are useless to us as your code snippets don&#39;t even contain a line 20."}, {"owner": {"reputation": 38877, "user_id": 1272683, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6ea2bbebf39d8f4d9ba654471289d576?s=128&d=identicon&r=PG", "display_name": "Hanfei Sun", "link": "https://stackoverflow.com/users/1272683/hanfei-sun"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1431158314, "post_id": 30137424, "comment_id": 48384203, "body": "@AJFarmar Just found it is a typographical error of the book, &lt;Learn You a Haskell for Great Good!&gt;.  the correct form is <code>bmiTell :: (RealFloat a) =&gt; a -&gt; String</code>"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 0, "creation_date": 1431158595, "post_id": 30137424, "comment_id": 48384260, "body": "The correct form is <code>bmiTell :: (RealFloat a) =&gt; a -&gt; String</code>. In fact you don&#39;t need <code>RealFloat</code> for your definition of that function; plain old <code>Num</code> will do."}], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 6, "last_activity_date": 1431157924, "creation_date": 1431157924, "answer_id": 30137450, "question_id": 30137424, "link": "https://stackoverflow.com/questions/30137424/why-does-this-helloworld-haskell-snippet-fails-to-load/30137450#30137450", "title": "Why does this helloworld haskell snippet fails to load?", "body": "<p>In your first case, your type signature is wrong. It should be like this:</p>\n\n<pre><code>bmiTell ::  Double -&gt; String  -- Notice that there is no =&gt;\n</code></pre>\n\n<p>In your second case, you are missing <code>=</code> in the last line. It should be like this:</p>\n\n<pre><code>| otherwise = \"huge\"  -- Notice the presence of =\n</code></pre>\n\n<p>So a proper working code will look like this:</p>\n\n<pre><code>bmiTell ::  Double -&gt; String\nbmiTell bmi\n  | bmi &lt;= 1 = \"small\"\n  | bmi &lt;= 10 = \"medium\"\n  | bmi &lt;= 100 = \"large\"\n  | otherwise = \"huge\"\n</code></pre>\n"}], "owner": {"reputation": 38877, "user_id": 1272683, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/6ea2bbebf39d8f4d9ba654471289d576?s=128&d=identicon&r=PG", "display_name": "Hanfei Sun", "link": "https://stackoverflow.com/users/1272683/hanfei-sun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 30137450, "answer_count": 1, "score": 0, "last_activity_date": 1431158366, "creation_date": 1431157758, "last_edit_date": 1431158366, "question_id": 30137424, "link": "https://stackoverflow.com/questions/30137424/why-does-this-helloworld-haskell-snippet-fails-to-load", "title": "Why does this helloworld haskell snippet fails to load?", "body": "<p>I write a file named \"baby.hs\" with the following codes</p>\n\n<pre><code>bmiTell :: =&gt; Double -&gt; String                                                  \nbmiTell bmi                                                                     \n | bmi &lt;= 1 = \"small\"                                                           \n | bmi &lt;= 10 = \"medium\"                                                         \n | bmi &lt;= 100 = \"large\"                                                         \n | otherwise = \"huge\"     \n</code></pre>\n\n<p>When I load this file in <code>GHCi</code>, it complains like this:</p>\n\n<pre><code>ghci&gt;:l baby.hs\n[1 of 1] Compiling Main             ( baby.hs, interpreted )\n\nbaby.hs:1:12: parse error on input \u2018=&gt;\u2019\nFailed, modules loaded: none.\nghci&gt;\n</code></pre>\n\n<p>If I remove the <code>=&gt;</code>, it doesn't work either:</p>\n\n<pre><code>bmiTell :: Double -&gt; String                                                     \nbmiTell bmi                                                                     \n | bmi &lt;= 1 = \"small\"                                                           \n | bmi &lt;= 10 = \"medium\"                                                         \n | bmi &lt;= 100 = \"large\"                                                         \n | otherwise \"huge\" \n</code></pre>\n\n<p>Error info:</p>\n\n<pre><code>ghci&gt;:l baby\n[1 of 1] Compiling Main             ( baby.hs, interpreted )\n\nbaby.hs:7:1:\n    parse error (possibly incorrect indentation or mismatched brackets)\nFailed, modules loaded: none.\n</code></pre>\n\n<p>Does anyone have ideas about this?</p>\n"}, {"tags": ["haskell", "threepenny-gui"], "comments": [{"owner": {"reputation": 640, "user_id": 949024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d81f9bcedb04a5e043fc9edd218ad83?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/949024/alex"}, "edited": false, "score": 0, "creation_date": 1431168675, "post_id": 30135637, "comment_id": 48386965, "body": "Are you running in the sandbox environment via <code>cabal exec</code>. If you aren&#39;t the code is being run outside the sandbox. The cabal sandbox only applies to cabal commands unless you use cabal exec."}, {"owner": {"reputation": 195, "user_id": 4438776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512bdc9775b923e0444553ea5d919854?s=128&d=identicon&r=PG", "display_name": "655321", "link": "https://stackoverflow.com/users/4438776/655321"}, "reply_to_user": {"reputation": 640, "user_id": 949024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d81f9bcedb04a5e043fc9edd218ad83?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/949024/alex"}, "edited": false, "score": 0, "creation_date": 1431169733, "post_id": 30135637, "comment_id": 48387251, "body": "Hey, thanks! I got it to compile with <code>cabal exec ghc test.hs</code> and the same for the examples. This sandbox stuff is a bit confusing sometimes..."}, {"owner": {"reputation": 195, "user_id": 4438776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512bdc9775b923e0444553ea5d919854?s=128&d=identicon&r=PG", "display_name": "655321", "link": "https://stackoverflow.com/users/4438776/655321"}, "reply_to_user": {"reputation": 640, "user_id": 949024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d81f9bcedb04a5e043fc9edd218ad83?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/949024/alex"}, "edited": false, "score": 0, "creation_date": 1431170649, "post_id": 30135637, "comment_id": 48387499, "body": "I&#39;m still a bit confused about using this package in my own code. I can now compile code in the threepenny-gui directory (with the sandbox set correctly), but if I wanted to do it somewhere else (for example use threepenny-gui with some code I have in <code>~&#47;myGreatProject&#47;</code>), how would I set the sandbox up then?"}, {"owner": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "edited": false, "score": 0, "creation_date": 1431244543, "post_id": 30135637, "comment_id": 48405840, "body": "@655321 In the <code>~&#47;myGreatProject</code> folder, you simply set up a new sandbox with <code>cabal sandbox init</code> and install the packages you want to use within the sandbox environment. In particular, you would execute the command <code>cabal install threepenny-gui</code> in the folder in order to install the threepenny-gui package, which you can then use from the sandbox."}, {"owner": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "edited": false, "score": 0, "creation_date": 1431244622, "post_id": 30135637, "comment_id": 48405860, "body": "@655321 The error that you&#39;ve encountered when running <code>.&#47;runhaskell CRUD.hs</code> seems strange to me. Can you run <code>.&#47;ghci -v CRUD.hs</code> and show the output?"}, {"owner": {"reputation": 195, "user_id": 4438776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512bdc9775b923e0444553ea5d919854?s=128&d=identicon&r=PG", "display_name": "655321", "link": "https://stackoverflow.com/users/4438776/655321"}, "edited": false, "score": 0, "creation_date": 1431271551, "post_id": 30135637, "comment_id": 48413532, "body": "Ok, thanks, the sandbox thing was after all easier than I thought. Running the command you asked gives the following output <a href=\"http://pastebin.com/qFjfJq1a\" rel=\"nofollow noreferrer\">pastebin.com/qFjfJq1a</a>."}, {"owner": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "edited": false, "score": 0, "creation_date": 1431419015, "post_id": 30135637, "comment_id": 48476103, "body": "@655321 The error that you&#39;ve encountered while running <code>.&#47;ghci</code> is due to a problem with your source tree. The <code>.&#47;ghci</code> and <code>.&#47;runhaskell</code> scripts try to recompile Threepenny from the local <code>src</code> folder, which is not necessarily the same version of Threepenny as the one that you have installed. This particular problem was <a href=\"https://github.com/HeinrichApfelmus/threepenny-gui/commits/master/src/Graphics/UI/Threepenny/Core.hs\" rel=\"nofollow noreferrer\">fixed already</a>. It looks like your <code>src</code> folder still contains the old Threepenny version 0.5.0.0 or thelike."}], "owner": {"reputation": 195, "user_id": 4438776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/512bdc9775b923e0444553ea5d919854?s=128&d=identicon&r=PG", "display_name": "655321", "link": "https://stackoverflow.com/users/4438776/655321"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 392, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1431142118, "creation_date": 1431142118, "question_id": 30135637, "link": "https://stackoverflow.com/questions/30135637/running-code-with-threepenny-gui", "title": "Running code with threepenny-gui", "body": "<p>I installed threepenny-gui by setting up a cabal sandbox and running</p>\n\n<pre><code>cabal install threepenny-gui -fbuildExamples\n</code></pre>\n\n<p>which seemed to work fine. The examples were found in the <code>.cabal-sandbox/bin</code>-folder and they worked perfectly.</p>\n\n<p>After that I looked at the source code of the examples and tried to run them using the <code>runhaskell</code> and <code>ghci</code> -scripts and got the following errors</p>\n\n<pre><code>&gt;./runhaskell CRUD.hs \n../src/Foreign/JavaScript/Marshal.hs:62:7: Warning:\nIn the use of \u2018Data.Aeson.Encode.fromValue\u2019\n(imported from Data.Aeson.Encode):\nDeprecated: \"Use 'encodeToTextBuilder' instead\"\n\n../src/Graphics/UI/Threepenny/Core.hs:349:43:\nCould not deduce (JS.FromJS a) arising from a use of \u2018get\u2019\nfrom the context (ToJS a, FFI (JSFunction a))\n  bound by the type signature for\n             fromObjectProperty :: (ToJS a, FFI (JSFunction a)) =&gt;\n                                   String -&gt; Attr Element a\n  at ../src/Graphics/UI/Threepenny/Core.hs:348:23-78\nPossible fix:\n  add (JS.FromJS a) to the context of\n    the type signature for\n      fromObjectProperty :: (ToJS a, FFI (JSFunction a)) =&gt;\n                            String -&gt; Attr Element a\nIn the first argument of \u2018mkReadWriteAttr\u2019, namely \u2018get\u2019\nIn the expression: mkReadWriteAttr get set\nIn an equation for \u2018fromObjectProperty\u2019:\n    fromObjectProperty name\n      = mkReadWriteAttr get set\n      where\n          set v el = runFunction $ ffi (\"%1.\" ++ name ++ \" = %2\") el v\n          get el = callFunction $ ffi (\"%1.\" ++ name) el\n</code></pre>\n\n<p>with both of the scripts. I also tried running/compiling the sample program from <a href=\"http://hackage.haskell.org/package/threepenny-gui-0.6.0.1/docs/Graphics-UI-Threepenny.html\" rel=\"nofollow\">http://hackage.haskell.org/package/threepenny-gui-0.6.0.1/docs/Graphics-UI-Threepenny.html</a> which resulted in the following errors</p>\n\n<pre><code>&gt; ghci test.hs \nGHCi, version 7.8.4: http://www.haskell.org/ghc/  :? for help\nLoading package ghc-prim ... linking ... done.\nLoading package integer-gmp ... linking ... done.\nLoading package base ... linking ... done.\n\ntest.hs:3:18:\nCould not find module \u2018Graphics.UI.Threepenny\u2019\nUse -v to see a list of the files searched for.\n\ntest.hs:4:25:\nCould not find module \u2018Graphics.UI.Threepenny.Core\u2019\nUse -v to see a list of the files searched for.\nFailed, modules loaded: none.\n</code></pre>\n\n<p>My experience using external libraries with Haskell is very limited and the latter one clearly comes from ghc not knowing where to look for these packages.</p>\n\n<p>How can I provide the right paths to ghc and get the <code>Core.hs</code> to work properly?</p>\n"}, {"tags": ["haskell", "monads", "type-signature"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 2, "creation_date": 1431125356, "post_id": 30133940, "comment_id": 48377929, "body": "What do you mean by this? Please be more specific."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1431125466, "post_id": 30133940, "comment_id": 48377961, "body": "How is the <code>(+)</code> example related to monads? The monadic bind operator is <code>&gt;&gt;=</code>, and is unrelated to the application <code>(+) 4 9</code> or the partial application <code>(+) 4</code>."}, {"owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1431126153, "post_id": 30133940, "comment_id": 48378161, "body": "@chi They are related in that both <code>(+)</code> and <code>(&gt;&gt;=)</code> are binary operators, but that&#39;s pretty much it."}], "answers": [{"comments": [{"owner": {"reputation": 613, "user_id": 4543556, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gL1nL.png?s=128&g=1", "display_name": "curieux", "link": "https://stackoverflow.com/users/4543556/curieux"}, "edited": false, "score": 0, "creation_date": 1431126761, "post_id": 30133983, "comment_id": 48378321, "body": "Oh hi, Gabriel!  I&#39;ve been reading your site/blog.  Mostly over my head, but very interesting nonetheless.  So, m a is Just 1.  Got that.  Then, the value from Just 1 gets shoved into the lambda function.  That value would be a in the right argument, right?  One gets added to the value.  How does a monad pop out without using return?  Oh, the lambda is still an argument to the monad, so it does it &#39;automagically&#39;?"}, {"owner": {"reputation": 23816, "user_id": 572606, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c20a126ad0dce40e8fc4a43456107919?s=128&d=identicon&r=PG", "display_name": "shang", "link": "https://stackoverflow.com/users/572606/shang"}, "edited": false, "score": 2, "creation_date": 1431157804, "post_id": 30133983, "comment_id": 48384085, "body": "For <code>Maybe</code>, <code>return</code> is the same as <code>Just</code>. The function <code>\\n -&gt; return (n + 1)</code> does the exact same thing as the lambda function in Gabriel&#39;s example but it would work for any monad."}, {"owner": {"reputation": 613, "user_id": 4543556, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gL1nL.png?s=128&g=1", "display_name": "curieux", "link": "https://stackoverflow.com/users/4543556/curieux"}, "edited": false, "score": 0, "creation_date": 1431197778, "post_id": 30133983, "comment_id": 48396173, "body": "Thanks to everyone for a ton of very helpul information.  Many things have clicked in the last few hours.  Hard choice, but I think this answer most directly responded to the question, and did so in the simplest way, which was what I needed to understand it."}], "tags": [], "owner": {"reputation": 34015, "user_id": 1026598, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e4cf2da845e7862bd0b0e4edd405f77d?s=128&d=identicon&r=PG", "display_name": "Gabriel Gonzalez", "link": "https://stackoverflow.com/users/1026598/gabriel-gonzalez"}, "is_accepted": true, "score": 5, "last_activity_date": 1431125970, "last_edit_date": 1431125970, "creation_date": 1431125513, "answer_id": 30133983, "question_id": 30133940, "link": "https://stackoverflow.com/questions/30133940/monad-type-signature-example/30133983#30133983", "title": "Monad type signature example", "body": "<p>Here is the type signature of bind:</p>\n\n<pre><code>(&gt;&gt;=)\n    :: Monad m\n    =&gt; m a         -- Left argument\n    -&gt; (a -&gt; m b)  -- Right argument\n    -&gt; m b\n</code></pre>\n\n<p>Here is an example of a bind with two arguments:</p>\n\n<pre><code>Just 1 &gt;&gt;= (\\n -&gt; Just (n + 1))\n^^^^^^     ^^^^^^^^^^^^^^^^^^^^\nArg #1     Arg #2\n</code></pre>\n\n<p>.. and it evaluates to <code>Just 2</code></p>\n"}, {"tags": [], "owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "is_accepted": false, "score": 0, "last_activity_date": 1431126224, "last_edit_date": 1431126224, "creation_date": 1431125534, "answer_id": 30133990, "question_id": 30133940, "link": "https://stackoverflow.com/questions/30133940/monad-type-signature-example/30133990#30133990", "title": "Monad type signature example", "body": "<blockquote>\n  <p>Could someone please walk me through a simple example using the <code>Maybe</code> monad the way I've done above for <code>(+)</code>?</p>\n</blockquote>\n\n<p><code>(&gt;&gt;=)</code> combines a monadic action with a function that returns a monadic action:</p>\n\n<pre><code>(       &gt;&gt;=            ) :: Maybe Int -&gt; (Int -&gt; Maybe Bool) -&gt; Maybe Bool\n(Just 1 &gt;&gt;=            ) ::              (Int -&gt; Maybe Bool) -&gt; Maybe Bool\n(Just 1 &gt;&gt;= Just . even) ::                                     Maybe Bool\n</code></pre>\n\n<p>Exactly as with <code>(+)</code>, two things go in (a monadic action and a function returning a monadic action) and one thing comes out (a monadic action).</p>\n\n<blockquote>\n  <p>To me, in practice, it always looks like one in, one out.</p>\n</blockquote>\n\n<p>Note that Haskell monads are unrelated to APL monads which are indeed unary functions.</p>\n"}, {"comments": [{"owner": {"reputation": 613, "user_id": 4543556, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gL1nL.png?s=128&g=1", "display_name": "curieux", "link": "https://stackoverflow.com/users/4543556/curieux"}, "edited": false, "score": 0, "creation_date": 1431136488, "post_id": 30134224, "comment_id": 48380179, "body": "Thank you!  This is going to take me a couple tries to digest, but I will be back.  Thanks for connecting it to (.) -- that helps.  For now, it just occurred to me that the function argument is always a lambda in examples.  Is it so inside an actual monad?  In this example, (from LYAHfGG), or general chaining, or just in general I guess, where is the function argument (a -&gt; m b)?  It looks like one value in, one value out.  ghci&gt; return (0,0) &gt;&gt;= landLeft 1 &gt;&gt;= banana &gt;&gt;= landRight 1  I think that&#39;s the sticking point for me."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 613, "user_id": 4543556, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gL1nL.png?s=128&g=1", "display_name": "curieux", "link": "https://stackoverflow.com/users/4543556/curieux"}, "edited": false, "score": 1, "creation_date": 1431148959, "post_id": 30134224, "comment_id": 48382307, "body": "@curieux It might help to put all the parentheses in: <code>(((return (0,0)) &gt;&gt;= (landLeft 1)) &gt;&gt;= banana) &gt;&gt;= (landRight 1)</code>. <code>(&gt;&gt;=)</code> is just a normal function that happens to be infix operator, there&#39;s nothing really magical about it. Its first argument is on the left and its second argument is on the right. You can make a non-operator synonym for it: <code>bind x f = x &gt;&gt;= f</code> and then you could rewrite this example as <code>bind (bind (bind (return (0,0)) (landLeft 1)) banana) (landRight 1)</code>"}], "tags": [], "owner": {"reputation": 10492, "user_id": 1351298, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/KJKqs.jpg?s=128&g=1", "display_name": "Electric Coffee", "link": "https://stackoverflow.com/users/1351298/electric-coffee"}, "is_accepted": false, "score": 0, "last_activity_date": 1431128835, "last_edit_date": 1431128835, "creation_date": 1431127243, "answer_id": 30134224, "question_id": 30133940, "link": "https://stackoverflow.com/questions/30133940/monad-type-signature-example/30134224#30134224", "title": "Monad type signature example", "body": "<p>The thing that confuses people a lot when they see the <code>&gt;&gt;=</code> type signature, is that it looks lop-sided</p>\n\n<p>If you take <code>+</code> you get a signature like this:</p>\n\n<pre><code>(+) :: Num a \n    =&gt; a  -- 1st arg\n    -&gt; a  -- 2nd arg\n    -&gt; a  -- return-type\n</code></pre>\n\n<p>If you take <code>.</code> you get this:</p>\n\n<pre><code>(.) :: (b -&gt; c) -- 1st arg, a function from b to c\n    -&gt; (a -&gt; b) -- 2nd arg, a function from a to b\n    -&gt;  a -&gt; c  -- return-type, a function from a to c\n</code></pre>\n\n<p>Nothing so far is scary</p>\n\n<p>Now take a look at <code>&gt;&gt;=</code></p>\n\n<pre><code>(&gt;&gt;=) :: Monad m\n      =&gt;       m a  -- 1st arg, a monad a\n      -&gt; (a -&gt; m b) -- 2nd arg, a function from a to a monad b\n      -&gt;       m b  -- return-type, a monad b\n</code></pre>\n\n<p>The 1st argument doesn't match the 2nd one, but that's okay, and I'm gonna show why.</p>\n\n<p>So let's say you have a the following two functions:</p>\n\n<pre><code>f :: Monad m =&gt; a -&gt; m a -- we just need the type signatures\ng :: Monad m =&gt; a -&gt; m a\n</code></pre>\n\n<p>We then do the following:</p>\n\n<pre><code>\\a -&gt; f a &gt;&gt;= \\b -&gt; g b\n</code></pre>\n\n<p>What's the type of <code>f a</code>? it's <code>m a</code>, what's the type of <code>g b</code>? it's <code>m b</code></p>\n\n<p>So basically what I did was this:</p>\n\n<pre><code>function: \\a -&gt; f a &gt;&gt;= \\b -&gt; g b\ntypes   :  a -&gt; m a      b -&gt; m b\n</code></pre>\n\n<p>What was the type of <code>&gt;&gt;=</code>'s arguments? Look again:</p>\n\n<pre><code>function: \\a -&gt; f a &gt;&gt;= \\b -&gt; g b\ntypes   :  a -&gt; m a      b -&gt; m b\n&gt;&gt;=-args:       m a  -&gt; (b -&gt; m b)\n</code></pre>\n\n<p>So in essence what we've done here, is by adding a lambda to the expression, we've <em>completed</em> the \"missing\" type information that made the signature \"lop-sided\"</p>\n\n<pre><code>\\n -&gt; (Just n &gt;&gt;= (\\m -&gt; Just (m + 1))) -- added extra () for highlighting\n</code></pre>\n\n<p>or put differently:</p>\n\n<pre><code>fn a = Just a &gt;&gt;= (\\m -&gt; Just (m + 1))\nfn 3 -- returns Just 4\n</code></pre>\n\n<p>Essentially what I just did, was create a function <code>fn</code> with the signature <code>a -&gt; m a</code>... Exactly the same as <code>f</code> and <code>g</code>. So what <code>&gt;&gt;=</code> is, is a way to compose monadic funcions. Just like how <code>.</code> is a way to compose <em>normal</em> functions.</p>\n\n<p>Watch [<a href=\"https://www.youtube.com/watch?v=ZhuHCtR3xq8\" rel=\"nofollow\">Don't fear the Monad</a>] which was the inspiration for this answer, and ultimately what made me somewhat understand why it looks the way it does.</p>\n"}], "owner": {"reputation": 613, "user_id": 4543556, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gL1nL.png?s=128&g=1", "display_name": "curieux", "link": "https://stackoverflow.com/users/4543556/curieux"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1554, "favorite_count": 0, "accepted_answer_id": 30133983, "answer_count": 3, "score": 2, "last_activity_date": 1431128835, "creation_date": 1431125221, "last_edit_date": 1431125964, "question_id": 30133940, "link": "https://stackoverflow.com/questions/30133940/monad-type-signature-example", "title": "Monad type signature example", "body": "<p>The type signature of (+) is:</p>\n\n<pre><code>    (+) :: Num a =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>I can see this in:</p>\n\n<pre><code>    + 4 5\n</code></pre>\n\n<p>Resulting in 9.  + takes 4 and returns a function of roughly:</p>\n\n<pre><code>    (4 + a) -&gt; a\n</code></pre>\n\n<p>...which then takes 5 and evaluates to 9.  Basically, two things in, one thing out.  I don't see how this works using the bind operator's type signature.  To me, in practice, it always looks like one in, one out.</p>\n\n<p>Could someone please walk me through a simple example using a Maybe monad the way I've done above for (+) ?  Hopefully, this will be generally useful to Haskell newbie's like me!</p>\n"}, {"tags": ["haskell", "error-handling", "monad-transformers"], "answers": [{"tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": false, "score": 1, "last_activity_date": 1431118605, "creation_date": 1431118605, "answer_id": 30132732, "question_id": 30131295, "link": "https://stackoverflow.com/questions/30131295/using-errort-in-haskell/30132732#30132732", "title": "Using ErrorT in Haskell", "body": "<p>The ErrorT datatype records errors in the <code>Left</code> field, which holds exactly one error. It cannot save each error. If you want to just \"throw an error\", use the IO monad and use <code>throw/catch</code> from <code>Control.Exception</code>. </p>\n\n<p>If you want to use your current code, try the following:</p>\n\n<pre><code>withErr :: MonadError e m =&gt; (e -&gt; m ()) -&gt; m a -&gt; m a\nwithErr f ac = catchError ac (\\e -&gt; f e &gt;&gt; throwError e)\n</code></pre>\n\n<p>This function applies an additional function to the error before it is rethrown. In your case, you just want to print the error:</p>\n\n<pre><code>askPassword' :: PwdErrorMonad ()\naskPassword' = do\n    liftIO $ putStrLn \"Enter your new password:\" \n    _ &lt;- msum $ repeat $ withErr (liftIO . print) getValidPassword'\n    liftIO $ putStrLn \"Storing in database...\" \n</code></pre>\n\n<p>Another approach is to use the mtl API to create a function which runs a function until it doesn't return an error. </p>\n\n<pre><code>try :: MonadError e m =&gt; (e -&gt; m ()) -&gt; m a -&gt; m a\ntry h ac = go where go = catchError ac (\\e -&gt; h e &gt;&gt; go)\n</code></pre>\n\n<p>You can do anything with the errors, for example, collect them in a list:</p>\n\n<pre><code>recordErrors :: MonadError e m =&gt; m a -&gt; m (a, [e])\nrecordErrors = runWriterT . try (tell . (:[])) . lift \n</code></pre>\n\n<p>However, what you want is to just print them:</p>\n\n<pre><code>askPassword' :: PwdErrorMonad ()\naskPassword' = do\n    liftIO $ putStrLn \"Enter your new password:\"\n    _ &lt;- try (liftIO . print) getValidPassword'  \n    liftIO $ putStrLn \"Storing in database...\" \n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 2302260, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8f97ff66bdfe5674beb4b843bdea852d?s=128&d=identicon&r=PG", "display_name": "EdZhavoronkov", "link": "https://stackoverflow.com/users/2302260/edzhavoronkov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1431118605, "creation_date": 1431112645, "question_id": 30131295, "link": "https://stackoverflow.com/questions/30131295/using-errort-in-haskell", "title": "Using ErrorT in Haskell", "body": "<p>I have a task to implement a function that repeatly asks user for a password and says if it is not correct. If the password is OK, then it says \"Storing in database and exits\". I need to use ErrorT monad transformer to tell user, that his password is incorrect, so the basic behavior looks like this</p>\n\n<pre><code>GHCi&gt;runErrorT askPassword'\nEnter your new password:\nqwerty\nIncorrect input: password is too short!\nqwertyuiop\nIncorrect input: password must contain some digits!\nqwertyuiop123\nIncorrect input: password must contain some punctuations!\nqwertyuiop123!!!\nStoring in database...\nGHCi&gt;\n</code></pre>\n\n<p><code>askPassword'</code> is like </p>\n\n<pre><code>data PwdError = PwdError String\ntype PwdErrorMonad = ErrorT PwdError IO\n\ninstance Error PwdError where\n    noMsg = PwdError \"Unknown error\"\n    strMsg s = PwdError s \n\ninstance Show PwdError where\n    show (PwdError s) = show s \n\naskPassword' :: PwdErrorMonad ()\naskPassword' = do\n    liftIO $ putStrLn \"Enter your new password:\"\n    value &lt;- msum $ repeat getValidPassword'\n    liftIO $ putStrLn \"Storing in database...\" \n</code></pre>\n\n<p>and <code>getValidPassword</code> looks like this:</p>\n\n<pre><code>getValidPassword' :: PwdErrorMonad String\ngetValidPassword' = do\n    s &lt;- liftIO getLine\n    if length s &lt; 8\n        then throwError $ PwdError \"Incorrect input: password is too short!\"\n        else if (not $ any isNumber s)\n            then throwError $ PwdError \"Incorrect input: password must contain some digits!\"\n            else if (not $ any isPunctuation s)\n                then throwError $ PwdError \"Incorrect input: password must contain some punctuations!\"\n                else return s\n</code></pre>\n\n<p>What am i missing here?\nThanks for help!</p>\n"}, {"tags": ["xml", "haskell", "hxt"], "comments": [{"owner": {"reputation": 2567, "user_id": 994206, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/699bacad8f85a069dda312cc29e03baa?s=128&d=identicon&r=PG", "display_name": "Mokosha", "link": "https://stackoverflow.com/users/994206/mokosha"}, "edited": false, "score": 0, "creation_date": 1431121352, "post_id": 30130556, "comment_id": 48376517, "body": "Perhaps you&#39;re looking for <code>processChildren</code> from <a href=\"http://www.fh-wedel.de/~si/HXmlToolbox/hdoc/Control-Arrow-ArrowTree.html\" rel=\"nofollow noreferrer\">fh-wedel.de/~si/HXmlToolbox/hdoc/Control-Arrow-ArrowTree.htm&zwnj;&#8203;l</a>`"}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 0, "last_activity_date": 1431112423, "creation_date": 1431112423, "answer_id": 30131246, "question_id": 30130556, "link": "https://stackoverflow.com/questions/30130556/stubbornness-of-operator/30131246#30131246", "title": "Stubbornness of += operator", "body": "<p>At a guess: an <code>ArrowXml</code> is intended to take an XML tree as input and produce an XML tree as output. <code>hasName</code> queries the input; <code>eelem</code> modifies the output. I would be very surprised to find there was a way to query the output or modify the input.</p>\n\n<p>On the other hand, the <code>arrows</code> package seems to offer a <a href=\"http://hackage.haskell.org/package/arrows-0.4.4.1/docs/Control-Arrow-Transformer-State.html\" rel=\"nofollow\">stateful arrow transformer</a> that may be useful. Presumably you could write an <code>instance ArrowXml a =&gt; ArrowXml (StateArrow s a)</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "edited": false, "score": 0, "creation_date": 1431150743, "post_id": 30134561, "comment_id": 48382625, "body": "Great, I works! Although I prefer <code>&gt;&gt;&gt;</code> over <code>.</code> (from <code>Control.Category</code>)."}], "tags": [], "owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "is_accepted": true, "score": 3, "last_activity_date": 1431131521, "last_edit_date": 1431131521, "creation_date": 1431129894, "answer_id": 30134561, "question_id": 30130556, "link": "https://stackoverflow.com/questions/30130556/stubbornness-of-operator/30134561#30134561", "title": "Stubbornness of += operator", "body": "<p>This is one of those cases where type signatures really help. Stare for a second at the type signature: </p>\n\n<pre><code>(+=) :: (ArrowXml a) =&gt; a b XmlTree -&gt; a b XmlTree -&gt; a b XmlTree \n</code></pre>\n\n<p>First off, <code>ArrowXml</code> is a subclass of <code>Arrow</code>, which describes some sort of machinery taking some input to some output. You can think of it like a big factory with conveyor belts taking things to different machines, and we're building these factory machines and hence factories with functions. Three of the Arrow combinators, for example, are:</p>\n\n<pre><code>(&amp;&amp;&amp;) :: (Arrow a) =&gt; a b c -&gt; a b c' -&gt; a b (c, c') |infixr 3|\n  Fanout: send the input to both argument arrows and combine their output.\n\narr :: (Arrow a) =&gt; (b -&gt; c) -&gt; a b c\n  Lift a function to an arrow.\n\n(.) :: (Category cat) =&gt; cat b c -&gt; cat a b -&gt; cat a c\n  morphism composition.\n</code></pre>\n\n<p>Now look at the lowercase letter (type variable) very closely in:</p>\n\n<pre><code>(+=) :: (ArrowXml a) =&gt; a b XmlTree -&gt; a b XmlTree -&gt; a b XmlTree \n</code></pre>\n\n<p>Clearly we're taking two machines which turn <code>b</code>s into <code>XmlTree</code>s and \"merging them together\" into one machine which takes a <code>b</code> in and expels an <code>XmlTree</code>. But importantly, this type signature tells us that more or less the <strong>only</strong> way that this can be implemented is:</p>\n\n<pre><code>arr1 += arr2 = arr f . (arr1 &amp;&amp;&amp; arr2) where\n    f :: (XmlTree, XmlTree) -&gt; XmlTree\n    f = _\n</code></pre>\n\n<p>This is because of \"free theorems\"; if you don't know the type of a parameter then we can prove that you can't really <em>do</em> much with it. (It can be a little more complicated because the arrow might have structures which aren't totally encapsulated by <code>arr</code>, like internal counters which are summed together with <code>.</code> which are then set to <code>0</code> when using <code>arr</code>. So actually replace <code>arr f</code> with a generic <code>a (XmlTree, XmlTree) XmlTree</code> and you're good to go.)</p>\n\n<p>So we must have <strong>parallel execution</strong> of the two arrows here. That's what I'm trying to say. Because the combinator <code>(+=)</code> doesn't know what <code>b</code> is, it has no choice but to blithely feed the <code>b</code> to the arrows in parallel and then try to combine their outputs together. So, <code>deep (hasName \"bar\")</code> does not look at <code>foo</code>.</p>\n\n<p>You can possibly make a mutually recursive solution with <code>deep (hasName \"bar\") . foo</code> if you really want, but it seems potentially dangerous (i.e. infinite loop), so it may be safer to simply define something like:</p>\n\n<pre><code>a ++= b = a += (b . a)\n</code></pre>\n\n<p>where the \"current\" a is \"fed\" to b to produce the update. To do this you will have to import <code>.</code> from <code>Control.Category</code> as it is not the same as <code>Prelude..</code> (which does function composition only). This looks like:</p>\n\n<pre><code>import Prelude hiding ((.))\nimport Control.Category ((.))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "is_accepted": false, "score": 1, "last_activity_date": 1431151215, "creation_date": 1431151215, "answer_id": 30136599, "question_id": 30130556, "link": "https://stackoverflow.com/questions/30130556/stubbornness-of-operator/30136599#30136599", "title": "Stubbornness of += operator", "body": "<p>Here is solution that works, thanks to @ChrisDrost:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>infixl 7 ++=\n\n(++=) :: ArrowXml a =&gt; a XmlTree XmlTree -&gt; a XmlTree XmlTree -&gt;\n         a XmlTree XmlTree\na ++= b = a += (a &gt;&gt;&gt; b)\n</code></pre>\n\n<p>In my understanding, <code>+=</code> just pass its input around, since it has type <code>b</code>,\nso it can't do much with it anyway. So, it just goes through the chain of\nthe operators unchanged. Here we put stronger constraint on that input of\n<code>++=</code> can be: it must be an <code>XmlArrow</code>. We feed this arrow to the second\nargument of <code>++=</code>, so it knows about \u00abupdated\u00bb state of XML document.</p>\n"}], "owner": {"reputation": 7134, "user_id": 3687048, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/i0GDr.jpg?s=128&g=1", "display_name": "Mark Karpov", "link": "https://stackoverflow.com/users/3687048/mark-karpov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 30134561, "answer_count": 3, "score": 1, "last_activity_date": 1431151215, "creation_date": 1431109744, "last_edit_date": 1495541196, "question_id": 30130556, "link": "https://stackoverflow.com/questions/30130556/stubbornness-of-operator", "title": "Stubbornness of += operator", "body": "<p>As we have learned from <a href=\"https://stackoverflow.com/questions/30029001/arrow-to-add-one-element-at-a-time\">my previous\nquestion</a>,\n<a href=\"http://hackage.haskell.org/package/hxt-9.3.1.15/docs/Text-XML-HXT-Arrow-XmlArrow.html#v:-43--61-\" rel=\"nofollow noreferrer\"><code>+=</code></a>\nis the operator that allows to add one element at a time. Is it possible to\n\u00abdetect\u00bb previously added elements and control how future additions are\ndone?</p>\n\n<p>Here is a simple program to start our investigation:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>module Main (main) where\n\nimport Control.Monad (void)\nimport Text.XML.HXT.Core\n\nmain :: IO ()\nmain = void $ runX $ root [] [foo]\n       &gt;&gt;&gt; writeDocument [withIndent yes] \"test.xml\"\n\nfoo :: ArrowXml a =&gt; a XmlTree XmlTree\nfoo = eelem \"foo\" += bar += bar += bar -- += is left associative\n\nbar :: ArrowXml a =&gt; a XmlTree XmlTree\nbar = ifA (deep (hasName \"bar\")) (eelem \"baz\") (eelem \"bar\")\n</code></pre>\n\n<p>Here, <code>foo</code> creates \u2018foo\u2019 node and its contents. Contents are generated with\n<code>bar</code> arrow, that's supposed to be smart enough to detect previously added\n\u2018bar\u2019 element, and change its behavior. Here we use <code>deep</code> for simplicity:\nif \u2018bar\u2019 element is child of \u2018foo\u2019 element, it should be detected, no matter\nhow deep it is (<code>getChildren &gt;&gt;&gt; hasName \"bar\"</code> should do the trick too).</p>\n\n<p>So, expected contents of <code>test.xml</code> file are:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;foo&gt;\n  &lt;bar/&gt;\n  &lt;baz/&gt;\n  &lt;baz/&gt;\n&lt;/foo&gt;\n</code></pre>\n\n<p>It doesn't work, of course. Here is what I get:</p>\n\n<pre class=\"lang-xml prettyprint-override\"><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;foo&gt;\n  &lt;bar/&gt;\n  &lt;bar/&gt;\n  &lt;bar/&gt;\n&lt;/foo&gt;\n</code></pre>\n\n<p>My questions:</p>\n\n<ol>\n<li><p>Why \u2018bar\u2019 element cannot be detected by <code>bar</code> arrow?</p></li>\n<li><p>How to detect it?</p></li>\n</ol>\n"}, {"tags": ["string", "list", "haskell"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1431102019, "post_id": 30128401, "comment_id": 48366744, "body": "Are you trying to filter out the words <code>&quot;poultry&quot;</code>, <code>&quot;outwits&quot;</code>, <code>&quot;ants&quot;</code>?  The function ``` <code>elem</code> [&quot;poultry outwits ants&quot;]``` will only filter out a string matching the exact value <code>&quot;poultry outwits ants&quot;</code>, not any of the strings <code>&quot;poultry&quot;</code>, <code>&quot;outwits&quot;</code>, or <code>&quot;ants&quot;</code>."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 2, "creation_date": 1431102088, "post_id": 30128401, "comment_id": 48366795, "body": "Also, don&#39;t use tabs in Haskell.  It&#39;s possible to do, but you&#39;re a lot more likely to run into weird syntax errors.  Just use spaces, they always work."}, {"owner": {"reputation": 21, "user_id": 4879722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b80ca83eaefc41421de7a5758046b8e5?s=128&d=identicon&r=PG&f=1", "display_name": "sgolay", "link": "https://stackoverflow.com/users/4879722/sgolay"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1431102509, "post_id": 30128401, "comment_id": 48367081, "body": "@bheklilr Yes, that is exactly what I am trying to do. I have changed the filter code to &#39;filterWords :: String -&gt; [String] filterWords = filter (<code>elem</code> [&quot;poultry&quot;, &quot;outwits&quot;, &quot;ants&quot;] . words&#39; but it still gives me the same error &quot;parse error (possibly incorrect indentation or mismatched brackets)&quot; I&#39;m not sure how to go about solving this issue. Thanks"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1431102660, "post_id": 30128401, "comment_id": 48367171, "body": "change your tabs to spaces first, does that help? You&#39;ll just have type errors after that (I think)"}, {"owner": {"reputation": 21, "user_id": 4879722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b80ca83eaefc41421de7a5758046b8e5?s=128&d=identicon&r=PG&f=1", "display_name": "sgolay", "link": "https://stackoverflow.com/users/4879722/sgolay"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1431102786, "post_id": 30128401, "comment_id": 48367247, "body": "Sorry, I&#39;m new to haskell and not quite sure what you mean by tabs?"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1431102887, "post_id": 30128401, "comment_id": 48367317, "body": "indentation. You had tab characters in your code that you had initially posted. You should be able to configure your editor to insert some number of spaces (I like 4) whenever you press the tab key on your keyboard. If you can&#39;t make your editor do that, stop using notepad.exe and get a real editor :P"}, {"owner": {"reputation": 21, "user_id": 4879722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b80ca83eaefc41421de7a5758046b8e5?s=128&d=identicon&r=PG&f=1", "display_name": "sgolay", "link": "https://stackoverflow.com/users/4879722/sgolay"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1431103169, "post_id": 30128401, "comment_id": 48367510, "body": "Right, I&#39;ve done that now and when I ran the code again,  the error was &#39;parse error on input \u2018where\u2019"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1431104964, "post_id": 30128401, "comment_id": 48368484, "body": "I can&#39;t see your exact code, can you edit your question with the exact code you&#39;re using now? Please make sure to put 4 lines in front of each line so stackoverflow formats it correctly."}], "answers": [{"tags": [], "owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "is_accepted": false, "score": 1, "last_activity_date": 1431109116, "creation_date": 1431109116, "answer_id": 30130381, "question_id": 30128401, "link": "https://stackoverflow.com/questions/30128401/filtering-string-from-list-haskell/30130381#30130381", "title": "Filtering String from List Haskell", "body": "<p>It might be easier if you split the program in a different way.  For example</p>\n\n<pre><code>import Data.List(group,sort)\nimport Control.Arrow((&amp;&amp;&amp;))\n\nfreq :: Ord a =&gt; [a] -&gt; [(Int,a)]\nfreq = reverse . sort . map (length &amp;&amp;&amp; head) . group . sort\n</code></pre>\n\n<p>second part will be defining the input to this function.  You want to filter only certain elements. </p>\n\n<pre><code>select :: Eq a =&gt; [a] -&gt; [a] -&gt; [a]\nselect list = filter (`elem` list)\n</code></pre>\n\n<p>these will make testing easier since you don't need the specific typed input.</p>\n\n<p>Finally, you can tie it all together</p>\n\n<pre><code>freq $ select [\"a\",\"b\",\"c\"] $ words \"a b a d e a b b b c d e c\"\n</code></pre>\n\n<p>will give you</p>\n\n<pre><code>[(4,\"b\"),(3,\"a\"),(2,\"c\")]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "is_accepted": false, "score": 0, "last_activity_date": 1431111114, "creation_date": 1431111114, "answer_id": 30130882, "question_id": 30128401, "link": "https://stackoverflow.com/questions/30128401/filtering-string-from-list-haskell/30130882#30130882", "title": "Filtering String from List Haskell", "body": "<p>There is my code which solve your problem</p>\n\n<pre><code>top :: String -&gt; [(Int,String)] --Signature is always important\ntop = sorter . wordFrequency . groups . filtered --just compose `where` functions\n    where\n        -- This will filter your words\n        filtered = filter (`notElem` [\"poultry\",\"outwits\",\"ants\"]) . words . map toLower \n        -- Group your words\n        groups = group . sort \n        -- Create the pairs of (count, word)\n        wordFrequency = map (length &amp;&amp;&amp; head)\n        -- Sort your list by first. for reverse just switch a and b\n        sorter = sortBy (\\ a b -&gt; fst b `compare` fst a)\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 4879722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b80ca83eaefc41421de7a5758046b8e5?s=128&d=identicon&r=PG&f=1", "display_name": "sgolay", "link": "https://stackoverflow.com/users/4879722/sgolay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 425, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1431111114, "creation_date": 1431101718, "last_edit_date": 1431101934, "question_id": 30128401, "link": "https://stackoverflow.com/questions/30128401/filtering-string-from-list-haskell", "title": "Filtering String from List Haskell", "body": "<p>I'm trying to write a program that reads a text file, then displays the frequencies and count of words in the file. What I need to do next is filter certain words from the text file. I have been looking at online resources for a couple of hours and still can't find what I'm looking for!</p>\n\n<p>I have provided my code for the program so far below: </p>\n\n<pre><code>lowercase = map toLower\ntop doc = wordPairs\n    where\n        listOfWords = words (lowercase doc)\n        wordGroups  = group (sort listOfWords)\n        wordPairs   = reverse\n                    $ sort\n                    $ map (\\x -&gt; (length x, head x))\n                    $ filterWords\n                    wordGroups\n\nfilterWords :: String -&gt; String\nfilterWords = filter (all (`elem` [\"poultry outwits ants\"])) . words\n</code></pre>\n"}, {"tags": ["haskell", "monads"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1431104015, "post_id": 30128299, "comment_id": 48368000, "body": "<i>Never, never, never</i> use <code>liftIO</code>! If you&#39;re using <code>liftIO</code>, you&#39;re practicing awful Haskell. I realise that you&#39;re new, but you need to learn!"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 8, "creation_date": 1431107188, "post_id": 30128299, "comment_id": 48369683, "body": "@AJFarmar What the heck? <code>liftIO</code> is very useful, and certainly not awful Haskell. It&#39;s not necessarily helpful here, but your advice to avoid it at all costs seems way off target."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1431107624, "post_id": 30128299, "comment_id": 48369912, "body": "I&#39;m having trouble finding a canonical <code>IO a -&gt; a</code> question; but I&#39;ve found one that is pretty close. If you can find a better one, please ping me."}, {"owner": {"reputation": 1767, "user_id": 1546268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4fba394918b979fcd94bd0071969407?s=128&d=identicon&r=PG&f=1", "display_name": "stian", "link": "https://stackoverflow.com/users/1546268/stian"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1431114477, "post_id": 30128299, "comment_id": 48373493, "body": "@daniel wagner. I agree that the other question offer an answer applicable for me - should I delete my question?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1431115764, "post_id": 30128299, "comment_id": 48374084, "body": "@hotGopher No reason to delete it, I think. Marking as duplicate is sufficient (which is already done)."}], "answers": [{"comments": [{"owner": {"reputation": 1767, "user_id": 1546268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4fba394918b979fcd94bd0071969407?s=128&d=identicon&r=PG&f=1", "display_name": "stian", "link": "https://stackoverflow.com/users/1546268/stian"}, "edited": false, "score": 0, "creation_date": 1431102951, "post_id": 30128421, "comment_id": 48367364, "body": "thank you. I guess I need it in tea spoons sometimes. The logic is that filter applies the function match (with a pattern) on each element in content, right? when I add a t.zip file to my folder this still returns an empty list.."}, {"owner": {"reputation": 1767, "user_id": 1546268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4fba394918b979fcd94bd0071969407?s=128&d=identicon&r=PG&f=1", "display_name": "stian", "link": "https://stackoverflow.com/users/1546268/stian"}, "edited": false, "score": 0, "creation_date": 1431104015, "post_id": 30128421, "comment_id": 48367999, "body": "I found out I needed to use (compile &quot;*.zip&quot;) (wildcard)."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 6, "last_activity_date": 1431101788, "creation_date": 1431101788, "answer_id": 30128421, "question_id": 30128299, "link": "https://stackoverflow.com/questions/30128299/how-to-transform-a-io-filepath-into-a-filepath/30128421#30128421", "title": "how to transform a IO [FilePath] into a [FilePath]?", "body": "<p>You don't want to use <code>liftIO</code> here, that's for lifting an <code>IO</code> action to a more complex monad, not for extracting a value from an <code>IO</code> action.  In short, you can't turn <code>IO a</code> into <code>a</code>.  The whole point of <code>IO</code> is to <em>prevent</em> you from doing this.  You can work with the <code>a</code> value directly using <code>do</code> notation, though:</p>\n\n<pre><code>listCompressedImages :: FilePath -&gt; IO [FilePath]\nlistCompressedImages folder = do\n    -- getDirectoryContents :: FilePath -&gt; IO [FilePath]\n    -- contents :: [FilePath]\n    contents &lt;- getDirectoryContents folder\n    -- filter (match (compile \".zip\")) :: [FilePath] -&gt; [FilePath]\n    return $ filter (match (compile \".zip\")) contents\n\nmain :: IO ()\nmain = do\n    -- compressedImages :: [FilePath]\n    compresssedImages &lt;- listCompressedImages \".\"\n    print compressedImages\n</code></pre>\n\n<p>Whenever you have something with the type <code>IO a</code> and you want to get the value of type <code>a</code> from it, use <code>do</code> notation and extract it using <code>&lt;-</code>.  For a more in-depth explanation I'll defer to <a href=\"http://learnyouahaskell.com/chapters\">Learn You a Haskell</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1431103035, "creation_date": 1431103035, "answer_id": 30128772, "question_id": 30128299, "link": "https://stackoverflow.com/questions/30128299/how-to-transform-a-io-filepath-into-a-filepath/30128772#30128772", "title": "how to transform a IO [FilePath] into a [FilePath]?", "body": "<p>You can not extract anything from <code>IO</code>, but you can adapt the other functions to work on <code>IO</code> values</p>\n\n<pre><code>listCompressedImages folder = \n   filter (match (compile \".zip\")) `fmap` getDirectoryContents folder\n</code></pre>\n\n<p>The above <code>fmap</code> applies a pure function (as <code>filter ...</code>) to some <code>IO</code> value. Note that the resulting type will still be <code>IO</code> -- again, you can never escape the <code>IO</code> monad.</p>\n"}], "owner": {"reputation": 1767, "user_id": 1546268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4fba394918b979fcd94bd0071969407?s=128&d=identicon&r=PG&f=1", "display_name": "stian", "link": "https://stackoverflow.com/users/1546268/stian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 450, "favorite_count": 0, "closed_date": 1431107639, "accepted_answer_id": 30128772, "answer_count": 2, "score": 0, "last_activity_date": 1431105444, "creation_date": 1431101370, "last_edit_date": 1431105444, "question_id": 30128299, "link": "https://stackoverflow.com/questions/30128299/how-to-transform-a-io-filepath-into-a-filepath", "closed_reason": "Duplicate", "title": "how to transform a IO [FilePath] into a [FilePath]?", "body": "<p>I would like to look in my current directory and only print <code>.zip</code> files.</p>\n\n<p>My strategy (shown below) is to get the FilePaths as an <code>IO [FilePath]</code>. I thought I could lift the <code>IO</code> so that it would be possible to filter on string elements.</p>\n\n<p>What is wrong in my thinking? I wonder if it is a problem that I use <code>liftIO</code> on an <code>IO [FilePath]</code> instead of <code>IO FilePath</code>.    </p>\n\n<pre><code>import System.Directory \nimport System.FilePath.Glob\nimport Control.Monad.IO.Class\n\nmain :: IO()\n\nlistCompressedImages folder = \n  filter (match (compile \".zip\")) (liftIO (getDirectoryContents folder))\n\nmain = listCompressedImages \".\" &gt;&gt;= print\n</code></pre>\n"}, {"tags": ["list", "haskell", "merge", "compare"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1431100301, "post_id": 30127957, "comment_id": 48365676, "body": "What is it supposed to do?"}, {"owner": {"reputation": 125, "user_id": 4857400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-UW9ZJNmUMf0/AAAAAAAAAAI/AAAAAAAAAD4/hYGd4E7pLhg/photo.jpg?sz=128", "display_name": "Merche", "link": "https://stackoverflow.com/users/4857400/merche"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1431100683, "post_id": 30127957, "comment_id": 48365905, "body": "I have two lists. And the first list compared with the second. If the item exists in the second list makes me a (Item 5.5) If only it exists in the first list (Element 5.0) If only exists in the second list (Item 0.5). But only it shows me the repeated elements."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1431100763, "post_id": 30127957, "comment_id": 48365958, "body": "What are <code>Item 5.5</code>, <code>Element 5.0</code>, and <code>Item 0.5</code>?"}, {"owner": {"reputation": 125, "user_id": 4857400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-UW9ZJNmUMf0/AAAAAAAAAAI/AAAAAAAAAD4/hYGd4E7pLhg/photo.jpg?sz=128", "display_name": "Merche", "link": "https://stackoverflow.com/users/4857400/merche"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1431100859, "post_id": 30127957, "comment_id": 48366013, "body": "is (string, Float, Float) where String depend of de list that exists. Float is value calculate in other operation."}, {"owner": {"reputation": 125, "user_id": 4857400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-UW9ZJNmUMf0/AAAAAAAAAAI/AAAAAAAAAD4/hYGd4E7pLhg/photo.jpg?sz=128", "display_name": "Merche", "link": "https://stackoverflow.com/users/4857400/merche"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1431100941, "post_id": 30127957, "comment_id": 48366065, "body": "I have simplified the problem to see if it operates more simply."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1431100961, "post_id": 30127957, "comment_id": 48366080, "body": "Can you provide some sample input and write what you want the output to be?"}, {"owner": {"reputation": 125, "user_id": 4857400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-UW9ZJNmUMf0/AAAAAAAAAAI/AAAAAAAAAD4/hYGd4E7pLhg/photo.jpg?sz=128", "display_name": "Merche", "link": "https://stackoverflow.com/users/4857400/merche"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1431101317, "post_id": 30127957, "comment_id": 48366293, "body": "Input <code>List1=[([&quot;variety&quot;], 4.50),([&quot;vegetable&quot;], 3.50),([&quot;velvet&quot;], 2.50)]</code>   <code>List2= [([&quot;variety&quot;], 4.50),([&quot;ve&quot;], 3.50),([&quot;velvet&quot;], 2.50)]</code>    Output = ` [([&quot;variety&quot;], 4.50, 4.50 ), ([&quot;vegetable&quot;], 3.50, 0), ([&quot;velvet&quot;], 2.50 2.50) ,([&quot;ve&quot;], 0, 3.50) `"}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1431102066, "post_id": 30127957, "comment_id": 48366772, "body": "Can you add that to your question?  The formatting is messed up in a comment and it&#39;s much easier to read with full markdown."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1431111287, "post_id": 30127957, "comment_id": 48371860, "body": "I have a hard time understanding this question. My guess is: if the first list contains <code>(x,y1)</code> and the second <code>(x,y2)</code>, generate <code>(x,y1,y2)</code> Otherwise, if the first contains <code>(x,y1)</code> but no <code>(x,_)</code> is in the second, generate <code>(x,y1,0)</code>. Further, for those <code>(x,y2)</code> in the second list without any <code>(x,_)</code> in the first, generate <code>(x,0,y2)</code>. This is basically what a <code>FULL OUTER JOIN</code> does in SQL, I think, except that we use <code>0</code> instead of <code>NULL</code>"}], "answers": [{"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 1, "last_activity_date": 1431111992, "creation_date": 1431111992, "answer_id": 30131119, "question_id": 30127957, "link": "https://stackoverflow.com/questions/30127957/compare-two-list-sorted/30131119#30131119", "title": "Compare two List sorted", "body": "<p>Since you want to combine the elements of both lists, keeping the keys unique I would recommend using a <code>Map</code> from <code>Data.Map</code>.  You can then combine two maps using <code>union</code>, <code>unionWith</code>, or <code>unionWithKey</code>.  The second one will be more useful here, though.  Since you also want to indicate when a value is from the first or second list only using <code>0</code>, it would be better to have a data type that represents that explicitly:</p>\n\n<pre><code>import qualified Data.Map as M\n\ndata Those a b\n    = This a        -- Only left\n    | Those a b     -- Both\n    | That b        -- Only right\n    deriving (Eq, Show)\n\nthis :: a -&gt; Those a b -&gt; a\nthis def (This a)    = a\nthis def (Those a b) = a\nthis def _           = def\n\nthat :: b -&gt; Those a b -&gt; b\nthat def (That b)    = b\nthat def (Those a b) = b\nthat def _           = def\n\n-- Give this a better name than Items\ntype Items k = M.Map k (Those Float Float)\n</code></pre>\n\n<p>This just sets up a couple types and tools that we'll use later.  The <code>Those</code> type represents left, right, or both, and the <code>this</code> and <code>that</code> combinators help us extract values from them easily, just like the <code>maybe</code> combinator in <code>Prelude</code>.</p>\n\n<pre><code>listToLeftItems :: Ord a =&gt; [(a, Float)] -&gt; Items a\nlistToLeftItems = M.fromList . map (fmap This)\n\nlistToRightItems :: Ord a =&gt; [(a, Float)] -&gt; Items a\nlistToRightItems = M.fromList . map (fmap That)\n\ncosinesim :: Ord a =&gt; [(a, Float)] -&gt; [(a, Float)] -&gt; [(a, Float, Float)]\ncosinesim left right\n    = map (\\(key, those) -&gt; (key, this 0 those, that 0 those))\n    $ M.toList\n    $ M.unionWith go (listToLeftItems left)\n                     (listToRightItems right)\n    where\n        go leftVal rightVal = case (leftVal, rightVal) of\n            (This a, That b) -&gt; Those a b\n            (x, y) -&gt; y  -- We know we won't have any other combinations,\n                         -- this just keeps the compiler from throwing a warning\n</code></pre>\n\n<p>The <code>listToLeftItems</code> just applies <code>This</code> to every <code>Float</code> in the list, then converts it to a <code>Map</code>, and similarly for <code>listToRightItems</code>.  Now your function just converts the input lists to <code>Map</code>s, unions them using <code>go</code> (which I think is simple enough to understand), converts back to a list, then flattens out the <code>(a, Those Float Float)</code> to <code>(a, Float, Float)</code>.  It gives you the results you want, but not in the same order.  You can use this as a basis for getting it in the order you want, if that matters.</p>\n"}], "owner": {"reputation": 125, "user_id": 4857400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-UW9ZJNmUMf0/AAAAAAAAAAI/AAAAAAAAAD4/hYGd4E7pLhg/photo.jpg?sz=128", "display_name": "Merche", "link": "https://stackoverflow.com/users/4857400/merche"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 30131119, "answer_count": 1, "score": 1, "last_activity_date": 1431111992, "creation_date": 1431100254, "last_edit_date": 1431102314, "question_id": 30127957, "link": "https://stackoverflow.com/questions/30127957/compare-two-list-sorted", "title": "Compare two List sorted", "body": "<p>I have this codec but, it shows no repeated elements, why?</p>\n\n<pre><code>cosinesim :: Ord a =&gt; [(a,Float)] -&gt; [(a,Float)] -&gt; [(a,Float,Float)]\ncosinesim a b = go a b\n    where\n       go [] b = map (\\l -&gt; (fst l, 0, snd l)) b\n       go a [] = map (\\l -&gt; (fst l, snd l, 0)) a\n       go a@((x,n):t) b@((y,m):r) = case compare x y of\n           LT -&gt; (x,n,0) : go t b\n           EQ -&gt; (x,n,m) : go t r\n           GT -&gt; (y,0,m) : go a r\n</code></pre>\n\n<p>Input : Two list sorted.</p>\n\n<p>List1= <code>[([\"variety\"], 4.50),([\"vegetable\"], 3.50),([\"velvet\"], 2.50)]</code> </p>\n\n<p>List2= <code>[([\"variety\"], 4.50),([\"ve\"], 3.50),([\"velvet\"], 2.50)]</code></p>\n\n<p>Output :</p>\n\n<p><code>[([\"variety\"], 4.50, 4.50 ), ([\"vegetable\"], 3.50, 0), ([\"velvet\"], 2.50 2.50) ,([\"ve\"], 0, 3.50)]</code></p>\n\n<p>My question is because only show the element that repeat in two list, because what I want is that all elements appear.</p>\n"}, {"tags": ["haskell", "applicative"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1431095329, "post_id": 30126111, "comment_id": 48362079, "body": "I don&#39;t believe this is possible because applicative actions can not depend on a previous result.  To do this I think you have to have a monad to get the output you want."}, {"owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1431095621, "post_id": 30126111, "comment_id": 48362315, "body": "You don&#39;t need monads. The applicative instance for <code>State</code> works fine, but I&#39;m hoping there&#39;s a better way."}], "answers": [{"comments": [{"owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "edited": false, "score": 0, "creation_date": 1431097661, "post_id": 30126907, "comment_id": 48363892, "body": "This is a good solution, but it is ultimately the thing that I&#39;m trying to avoid doing. I will wait a while and accept this if no one can come up with a better way (one that doesn&#39;t require hiding the data constructor to preserve the invariant)."}, {"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "reply_to_user": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "edited": false, "score": 7, "creation_date": 1431097940, "post_id": 30126907, "comment_id": 48364090, "body": "@Andrew Thaddeus Martin I think it will be difficult to pull the invariant into the Applicative while preserving Applicative laws. If <code>(&lt;*&gt;)</code> always increments the count, what to make of the law <code>pure id &lt;*&gt; v = v</code> ?"}, {"owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "edited": false, "score": 0, "creation_date": 1431098173, "post_id": 30126907, "comment_id": 48364264, "body": "You are correct. The instance I am looking for is provably impossible. Thanks."}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": true, "score": 10, "last_activity_date": 1431097462, "last_edit_date": 1431097462, "creation_date": 1431097108, "answer_id": 30126907, "question_id": 30126111, "link": "https://stackoverflow.com/questions/30126111/applicative-that-increments-the-environment-in-haskell/30126907#30126907", "title": "Applicative that increments the environment in haskell", "body": "<p><code>(,) a</code> is an <code>Applicative</code> when <code>a</code> is a <code>Monoid</code>. We can compose <code>(,) (Sum Int)</code> with other applicative using <code>Data.Functor.Compose</code>, and get an applicative that lets us estimate the \"cost\" assigned to a computation before running it.</p>\n\n<p>To count the steps, we need a lift function from the base applicative that always assigns a cost of 1:</p>\n\n<pre><code>module Main where\n\nimport Data.Monoid\nimport Control.Applicative\nimport Data.Functor.Compose\n\ntype CountedIO a = Compose ((,) (Sum Int)) IO a\n\n-- lift from IO\nstep :: IO a -&gt; CountedIO a\nstep cmd = Compose (Sum 1, cmd)\n\ncountSteps :: CountedIO a -&gt; Int\ncountSteps = getSum . fst . getCompose\n\nexec :: CountedIO a -&gt; IO a\nexec =  snd . getCompose\n\nprogram :: CountedIO () \nprogram = step (putStrLn \"aaa\") *&gt;  step (putStrLn \"bbb\") *&gt; step (putStrLn \"ccc\")\n\nmain :: IO ()\nmain = do\n    putStrLn $ \"Number of steps: \" ++ show (countSteps program)\n    exec program \n</code></pre>\n\n<p>For greater safety, we could hide the composed aplicative behind a newtype, and not export the constructor, only the <code>step</code> function.</p>\n\n<p>(Actions created with <code>pure</code> have cost 0 and do not count as a step.)</p>\n"}], "owner": {"reputation": 3032, "user_id": 1405768, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/WnFhY.jpg?s=128&g=1", "display_name": "Andrew Thaddeus Martin", "link": "https://stackoverflow.com/users/1405768/andrew-thaddeus-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 1, "accepted_answer_id": 30126907, "answer_count": 1, "score": 4, "last_activity_date": 1431097462, "creation_date": 1431094824, "question_id": 30126111, "link": "https://stackoverflow.com/questions/30126111/applicative-that-increments-the-environment-in-haskell", "title": "Applicative that increments the environment in haskell", "body": "<p>I'm wondering if there is an <code>Applicative</code> that can track how many applicative operations have occurred. I tried to implement it as follows:</p>\n\n<pre><code>import Control.Applicative\n\nmain :: IO ()\nmain = print $ run 1 $ (,,,) &lt;$&gt; FromInt id &lt;*&gt; FromInt id &lt;*&gt; FromInt id &lt;*&gt; FromInt id\n\ndata FromInt a = FromInt (Int -&gt; a)\n\nrun :: Int -&gt; FromInt a -&gt; a\nrun i (FromInt f) = f i\n\ninstance Functor FromInt where\n  fmap g (FromInt f) = FromInt (g . f)\n\ninstance Applicative FromInt where\n  pure a = FromInt (const a)\n  FromInt f &lt;*&gt; FromInt g = FromInt (\\i -&gt; f i (g (i + 1)))\n</code></pre>\n\n<p>But, this of course does not work. If we call runhaskell on the file, we get this:</p>\n\n<pre><code>(1,2,2,2)\n</code></pre>\n\n<p>And what I want is this:</p>\n\n<pre><code>(1,2,3,4)\n</code></pre>\n\n<p>I've seen people accomplish this effect by pushing the requirement to increment into the actual data (this is how yesod-forms does its formlet-style implementation). This more-or-less uses a variation on <code>State</code>, and it allows people to break assumed invariants if they don't use particular helper functions (I think the yesod one is called <code>mhelper</code>). I want to know if the incrementing can be pulled into the applicative instance as I have tried to do. This would make violating this particular invariant impossible.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 10281, "user_id": 1033448, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d64fdbd293e80580b1c702998cb6e740?s=128&d=identicon&r=PG", "display_name": "Anton Guryanov", "link": "https://stackoverflow.com/users/1033448/anton-guryanov"}, "edited": false, "score": 1, "creation_date": 1431089082, "post_id": 30124035, "comment_id": 48357911, "body": "Seems that you want to combine two monads (in your case, <code>Maybe</code> and <code>IO</code>). This is usually done using monad transformers (<a href=\"http://book.realworldhaskell.org/read/monad-transformers.html\" rel=\"nofollow noreferrer\">book.realworldhaskell.org/read/monad-transformers.html</a>). There is an existing <code>MaybeT</code> monad transformer, it should help (<a href=\"https://hackage.haskell.org/package/transformers-0.3.0.0/docs/Control-Monad-Trans-Maybe.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/transformers-0.3.0.0/docs/&hellip;</a>)"}, {"owner": {"reputation": 7942, "user_id": 516188, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/934a553983eaca4c3f8f939daf6d2faa?s=128&d=identicon&r=PG", "display_name": "Emmanuel Touzery", "link": "https://stackoverflow.com/users/516188/emmanuel-touzery"}, "reply_to_user": {"reputation": 10281, "user_id": 1033448, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d64fdbd293e80580b1c702998cb6e740?s=128&d=identicon&r=PG", "display_name": "Anton Guryanov", "link": "https://stackoverflow.com/users/1033448/anton-guryanov"}, "edited": false, "score": 0, "creation_date": 1431089211, "post_id": 30124035, "comment_id": 48358004, "body": "I know about monad transformers but for simple one-off cases it&#39;s going to be overkill i think. The case is then shorter and more readable."}], "answers": [{"comments": [{"owner": {"reputation": 7942, "user_id": 516188, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/934a553983eaca4c3f8f939daf6d2faa?s=128&d=identicon&r=PG", "display_name": "Emmanuel Touzery", "link": "https://stackoverflow.com/users/516188/emmanuel-touzery"}, "edited": false, "score": 0, "creation_date": 1431092364, "post_id": 30124332, "comment_id": 48360151, "body": "exactly what I wanted and thank you for the extra explanations!"}, {"owner": {"reputation": 7942, "user_id": 516188, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/934a553983eaca4c3f8f939daf6d2faa?s=128&d=identicon&r=PG", "display_name": "Emmanuel Touzery", "link": "https://stackoverflow.com/users/516188/emmanuel-touzery"}, "edited": false, "score": 0, "creation_date": 1431106824, "post_id": 30124332, "comment_id": 48369482, "body": "looking at it now. In fact with GHC 4.10 (base 4.8) I could even use the usual <code>mapM</code>, which doesn&#39;t anymore necessarily work on lists but on any <code>Traversable</code>, including <code>Maybe</code>. And <code>traverse</code> makes it working even on <code>Applicative</code> not only <code>Monad</code> functions. I think I got it now :-)"}], "tags": [], "owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "is_accepted": true, "score": 6, "last_activity_date": 1431089375, "creation_date": 1431089375, "answer_id": 30124332, "question_id": 30124035, "link": "https://stackoverflow.com/questions/30124035/using-the-maybe-monad-with-monadic-actions/30124332#30124332", "title": "using the Maybe monad with monadic actions", "body": "<p>You're looking for <code>traverse</code> from <code>Data.Traversable</code> -- it's sort of a <code>sequence</code>/<code>mapM</code> construct applied to monads which are not the list monad (except it's applied to \"traversables\" and works for things which are weaker than \"monads\"). So for your particular case the function is just:</p>\n\n<pre><code>traverseMaybe f Nothing = return Nothing\ntraverseMaybe f (Just x) = fmap Just (f x)\n</code></pre>\n\n<p>but <code>Data.Traversable</code> defines a more general class:</p>\n\n<pre><code>class (Functor t, Foldable t) =&gt; Traversable t where\n    {-# MINIMAL traverse | sequenceA #-}\n\n    -- | Map each element of a structure to an action, evaluate these\n    -- these actions from left to right, and collect the results.\n    -- actions from left to right, and collect the results. For a\n    -- version that ignores the results see 'Data.Foldable.traverse_'.\n    traverse :: Applicative f =&gt; (a -&gt; f b) -&gt; t a -&gt; f (t b)\n    traverse f = sequenceA . fmap f\n\n    -- | Evaluate each action in the structure from left to right, and\n    -- and collect the results. For a version that ignores the results\n    -- see 'Data.Foldable.sequenceA_'.\n    sequenceA :: Applicative f =&gt; t (f a) -&gt; f (t a)\n    sequenceA = traverse id\n\n    -- | Map each element of a structure to a monadic action, evaluate\n    -- these actions from left to right, and collect the results. For\n    -- a version that ignores the results see 'Data.Foldable.mapM_'.\n    mapM :: Monad m =&gt; (a -&gt; m b) -&gt; t a -&gt; m (t b)\n    mapM = traverse\n\n    -- | Evaluate each monadic action in the structure from left to\n    -- right, and collect the results. For a version that ignores the\n    -- results see 'Data.Foldable.sequence_'.\n    sequence :: Monad m =&gt; t (m a) -&gt; m (t a)\n    sequence = sequenceA\n</code></pre>\n\n<p>This will also work for applicative functors that are not monads, like ZipLists. </p>\n"}, {"tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": false, "score": 3, "last_activity_date": 1431089555, "creation_date": 1431089555, "answer_id": 30124401, "question_id": 30124035, "link": "https://stackoverflow.com/questions/30124035/using-the-maybe-monad-with-monadic-actions/30124401#30124401", "title": "using the Maybe monad with monadic actions", "body": "<p><a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/Data-Traversable.html\" rel=\"nofollow\"><code>traverse</code></a> does what you want here:</p>\n\n<pre><code>c' &lt;- traverse readFile x\nprint c'\n</code></pre>\n"}], "owner": {"reputation": 7942, "user_id": 516188, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/934a553983eaca4c3f8f939daf6d2faa?s=128&d=identicon&r=PG", "display_name": "Emmanuel Touzery", "link": "https://stackoverflow.com/users/516188/emmanuel-touzery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 1, "accepted_answer_id": 30124332, "answer_count": 2, "score": 2, "last_activity_date": 1431089555, "creation_date": 1431088540, "question_id": 30124035, "link": "https://stackoverflow.com/questions/30124035/using-the-maybe-monad-with-monadic-actions", "title": "using the Maybe monad with monadic actions", "body": "<p>When I have for instance a <code>Maybe</code> value, and I want to apply something on it when it's a <code>Just</code> or just keep a <code>Nothing</code> if it was a <code>Nothing</code>, I have many ways to achieve that in haskell. However I did not find a concise way when I want to apply on it a monadic action.</p>\n\n<p>In this code, to get <code>d</code> I can just use <code>fmap</code>. But I can't use it to get <code>c</code> because that one requires a monadic (<code>IO</code> in this case) action to apply on the value in the <code>Maybe</code>.</p>\n\n<pre><code>import Control.Applicative\n\nmain = do\n    let x = Just \"test.txt\"\n    let d = reverse &lt;$&gt; x -- good\n    print d\n    c &lt;- case x of -- verbose\n     Nothing -&gt; return Nothing\n     Just y -&gt; Just &lt;$&gt; readFile y\n    print c\n</code></pre>\n\n<p>This is a way it can be done, but it's also too verbose.</p>\n\n<pre><code>    c' &lt;- maybe (return Nothing) (\\a -&gt; Just &lt;$&gt; readFile a) x\n    print c'\n</code></pre>\n\n<p>I'm sure there's a shorter way, I just can't see it right now...</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1134, "user_id": 4819857, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eTogf.jpg?s=128&g=1", "display_name": "Diogo Cunha", "link": "https://stackoverflow.com/users/4819857/diogo-cunha"}, "edited": false, "score": 0, "creation_date": 1431085194, "post_id": 30122862, "comment_id": 48355394, "body": "You must convert the IO integer to a int.    [Convert IO int to int][1]        [1]: <a href=\"http://stackoverflow.com/questions/4235348/converting-io-int-to-int\" title=\"converting io int to int\">stackoverflow.com/questions/4235348/converting-io-int-to-int</a>"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 1, "creation_date": 1431085815, "post_id": 30122862, "comment_id": 48355793, "body": "The compiler errror is pretty straightforward. <code>sumInts</code> is an IO action, so instead of <code>return</code>ing, <code>fmap (+x) sumInts</code> or similar."}, {"owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "edited": false, "score": 0, "creation_date": 1431088722, "post_id": 30122862, "comment_id": 48357648, "body": "If you need more help please ask :)"}, {"owner": {"reputation": 1257, "user_id": 4214719, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4f4851ca5304f2020ce92fa7ec69b48a?s=128&d=identicon&r=PG&f=1", "display_name": "Diana", "link": "https://stackoverflow.com/users/4214719/diana"}, "reply_to_user": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "edited": false, "score": 0, "creation_date": 1431088965, "post_id": 30122862, "comment_id": 48357821, "body": "@GabrielCiubotaru I understood what the problem was and it works now. Thank you very much!"}, {"owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "edited": false, "score": 0, "creation_date": 1431090173, "post_id": 30122862, "comment_id": 48358664, "body": "I mean if you need more help on learning Haskell :D"}], "answers": [{"tags": [], "owner": {"reputation": 16233, "user_id": 4253229, "user_type": "registered", "accept_rate": 83, "profile_image": "https://lh4.googleusercontent.com/-e2FAQvlj5CQ/AAAAAAAAAAI/AAAAAAAAAqM/TlSnekirgNE/photo.jpg?sz=128", "display_name": "Eugene Sh.", "link": "https://stackoverflow.com/users/4253229/eugene-sh"}, "is_accepted": false, "score": 1, "last_activity_date": 1431086041, "creation_date": 1431086041, "answer_id": 30123183, "question_id": 30122862, "link": "https://stackoverflow.com/questions/30122862/haskell-sum-of-integers-read-from-keyboard/30123183#30123183", "title": "Haskell - sum of integers read from keyboard", "body": "<p>Here:</p>\n\n<pre><code>x&lt;-getInt\nif x==0 then return 0 else return (x+sumInts)\n</code></pre>\n\n<p><code>x</code> has a type <code>Int</code>, but <code>sumInts</code> is <code>IO Int</code>. \nI would recommend separating the IO part and the calculation part into different functions. </p>\n"}, {"tags": [], "owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "is_accepted": true, "score": 6, "last_activity_date": 1431331129, "last_edit_date": 1431331129, "creation_date": 1431087536, "answer_id": 30123698, "question_id": 30122862, "link": "https://stackoverflow.com/questions/30122862/haskell-sum-of-integers-read-from-keyboard/30123698#30123698", "title": "Haskell - sum of integers read from keyboard", "body": "<p>You are trying to add Int with IO Int in <code>(x+sumInts)</code>.</p>\n\n<p>Let's take this step by step:</p>\n\n<p>getInt return an actions that when it's executed returns an \"Int\" and you execute it using <code>&lt;-</code> : </p>\n\n<pre><code>x&lt;-getInt\n</code></pre>\n\n<p>That means x have type <code>Int</code>.</p>\n\n<p>In expression <code>(x+sumInts)</code> you use <code>+</code> which have a type of:</p>\n\n<pre><code>(+) :: Num a =&gt; a -&gt; a -&gt; a \n</code></pre>\n\n<p>Haskell interfer the type and replace <code>a</code> with the type of x, which means <code>+</code> will have type of:</p>\n\n<pre><code> (+) :: Int -&gt; Int -&gt; Int\n</code></pre>\n\n<p>and will expect as second parameter an <code>Int</code>.</p>\n\n<p>You are providing as the second parameter <code>sumInts</code> which have a type <code>IO Int</code> and that's why you have that error <code>couldn't match expected type Int with actual type IO Int</code>.</p>\n\n<p>To make it works you have to \"get out\" the value from IO action using <code>&lt;-</code> like this:</p>\n\n<pre><code>sumInts :: IO Int\nsumInts = do\n  x&lt;-getInt\n  if x==0 \n    then return 0 \n    else do\n         rest &lt;- sumInts\n         return (x+rest)\n</code></pre>\n\n<p>Another approach to solve ths, in a more readable, is using Applicative:</p>\n\n<pre><code>import Control.Applicative\n\ngetInt :: IO Int          \ngetInt = do  \n  s &lt;- getLine\n  return (read s)\n\nsumInts :: IO Int\nsumInts = do\n  x&lt;-getInt\n  if x==0 then return 0 else (x+) &lt;$&gt; sumInts \n</code></pre>\n\n<p>The <code>&lt;$&gt;</code> function takes a function (in our case <code>x+</code>) an apply it on value inside an Applicative Functor (IO is instance of Applicative and Functor) and return that Functor with computation applied.\nType of <code>&lt;$&gt;</code> is:</p>\n\n<pre><code>&gt; :t (&lt;$&gt;)\n(&lt;$&gt;) :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b\n</code></pre>\n\n<p>and for IO this will be :</p>\n\n<pre><code>(&lt;$&gt;) :: (a -&gt; b) -&gt; IO a -&gt; IO b\n(&lt;$&gt;) :: (Int -&gt; Int) -&gt; IO Int -&gt; IO Int -- If we consider that a is an Int\n</code></pre>\n"}], "owner": {"reputation": 1257, "user_id": 4214719, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4f4851ca5304f2020ce92fa7ec69b48a?s=128&d=identicon&r=PG&f=1", "display_name": "Diana", "link": "https://stackoverflow.com/users/4214719/diana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1831, "favorite_count": 0, "accepted_answer_id": 30123698, "answer_count": 2, "score": 1, "last_activity_date": 1431331129, "creation_date": 1431084958, "last_edit_date": 1431085457, "question_id": 30122862, "link": "https://stackoverflow.com/questions/30122862/haskell-sum-of-integers-read-from-keyboard", "title": "Haskell - sum of integers read from keyboard", "body": "<p>I am trying to write a function that sums integers supplied one per line and stops when 0 is input. I have this so far:</p>\n\n<pre><code>getInt :: IO Int          \ngetInt = do  \n  s &lt;- getLine\n  return (read s)\n\nsumInts :: IO Int\nsumInts = do\n  x&lt;-getInt\n  if x==0 then return 0 else return (x+sumInts)\n</code></pre>\n\n<p>but I get an error when I try to run it:</p>\n\n<blockquote>\n  <p>couldn't match expected type Int with actual type IO Int</p>\n</blockquote>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 0, "creation_date": 1431090572, "post_id": 30122855, "comment_id": 48358930, "body": "Your architecture is bad and you should feel bad. Decouple parsing from evaluation."}, {"owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "reply_to_user": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 3, "creation_date": 1431090731, "post_id": 30122855, "comment_id": 48359044, "body": "@rightfold I have a workaround for this using a second where with <code>(x1:x2:xs) = stack</code> but i&#39;m not iterested in &quot;How can i solve this problem&quot; but &quot;How Haskell works and why this is not working&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "edited": false, "score": 0, "creation_date": 1431087739, "post_id": 30123436, "comment_id": 48357002, "body": "When using head $ resolveRPN &quot;2 4 +&quot; is working because of haskell lazyness on otherwise branch: it only evaluate (read el) and don&#39;t care at all about stack because this value is not required for printing the result"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "edited": false, "score": 0, "creation_date": 1431088156, "post_id": 30123436, "comment_id": 48357276, "body": "That&#39;s true. Is there perhaps somethings that&#39;s not clear to you in the answer?"}, {"owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "edited": false, "score": 0, "creation_date": 1431088518, "post_id": 30123436, "comment_id": 48357516, "body": "if u apply &quot;2 4 +&quot; to that function: for first 2 elements should only use stack and should not try to split it into elements (because of AS binding), at the moment &quot;+&quot; will be evaluated there are already 2 elements in the acc: 2 and 4. The problem is that, it is fails even for &quot;2 2&quot; because of the pattern but this shouldn&#39;t because i only use AT binding so it shouldn&#39;t care about if stack can be slipted or not"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "edited": false, "score": 0, "creation_date": 1431088925, "post_id": 30123436, "comment_id": 48357782, "body": "@GabrielCiubotaru it fails for &quot;2 2&quot; because the one-element list can&#39;t be matched. Your pattern matches only on lists with at least two elements. You can make the inner pattern irrefutable too, like <code>~stack@(x1: ~(x2:xs))</code>, and this way <code>take 2 $ resolveRPN &quot;2 2&quot;</code> works fine."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "edited": false, "score": 0, "creation_date": 1431089090, "post_id": 30123436, "comment_id": 48357916, "body": "The principle is the same: if you try to evaluate non-matching patterns, you get an error. Your code always returns a list with a non-matching pattern in the back."}, {"owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "edited": false, "score": 0, "creation_date": 1431090588, "post_id": 30123436, "comment_id": 48358940, "body": "I just add a simplified version of my problem at the end of the post"}, {"owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1431090948, "post_id": 30123436, "comment_id": 48359182, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/77310/discussion-between-gabriel-ciubotaru-and-andras-kovacs\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": false, "score": 0, "last_activity_date": 1431086751, "creation_date": 1431086751, "answer_id": 30123436, "question_id": 30122855, "link": "https://stackoverflow.com/questions/30122855/haskell-as-binding-on-irrefutable-pattern/30123436#30123436", "title": "Haskell AS binding on irrefutable pattern", "body": "<p>The irrefutable pattern fails when we try to print the resulting list:</p>\n\n<pre><code>head $ resolveRPN \"2 4 +\" -- 6, no error\nresolveRPN \"2 4 +\" -- error\n</code></pre>\n\n<p>In the above example, we don't have a proper <code>[]</code> at the end of the resulting list. Instead, we have an irrefutable <code>(:)</code> pattern, which throws an error. In other words, <code>~(x:xs)</code> can't function as an empty list, even if we don't actually try to access head or the tail in the pattern.</p>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1431098479, "post_id": 30125551, "comment_id": 48364441, "body": "I did a quick test in GHCi, and I had to use another pair of parentheses: <code>helper stack@(~(x1:x2:xs)) el ...</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1431101699, "post_id": 30125551, "comment_id": 48366528, "body": "You are right: I was using <code>stack@~(...</code> without the space in between."}], "tags": [], "owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "is_accepted": false, "score": 3, "last_activity_date": 1431093090, "creation_date": 1431093090, "answer_id": 30125551, "question_id": 30122855, "link": "https://stackoverflow.com/questions/30122855/haskell-as-binding-on-irrefutable-pattern/30125551#30125551", "title": "Haskell AS binding on irrefutable pattern", "body": "<p>The irrefutable pattern is appling for <code>stack@(x1:x2:xs)</code> not on each one so when you try to extract <code>stack</code> this will atuomatically evaluate <code>(x1:x2:xs)</code>.</p>\n\n<p>This problem can be FIXED using irrefutable only for pattern matching but not on as binding defining <code>hepler</code> like this:</p>\n\n<pre><code>helper stack@ ~(x1:x2:xs) el \n        | el == \"+\" = (x2 + x1) : xs\n        | el == \"-\" = (x2 - x1) : xs\n        | el == \"*\" = (x2 * x1) : xs\n        | el == \"/\" = (x2 `div` x1) : xs\n        | otherwise = (read el) : stack \n</code></pre>\n\n<p>and this will never fails on valid expressions.</p>\n"}, {"comments": [{"owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "edited": false, "score": 0, "creation_date": 1431101640, "post_id": 30128005, "comment_id": 48366497, "body": "My problem was not in understanding <code>thumb</code> but in using it in combination with as binding. I thought in this expression  <code>~stack @ (x1:x2:xs)</code> the thumb is applied just for <code>(x1:x2:xs)</code> not on <code>stack</code> as well. I was beginning to suspect that as binding is just syntactic sugar for <code>(x1:x2:xs)</code> and that&#39;s the reason for failure."}, {"owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "edited": false, "score": 0, "creation_date": 1431101719, "post_id": 30128005, "comment_id": 48366541, "body": "Can you please adapt your answer with <code>as pattern</code> so i can accept your answer ?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "edited": false, "score": 0, "creation_date": 1431102778, "post_id": 30128005, "comment_id": 48367244, "body": "@GabrielCiubotaru I added an example with as-patterns."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "edited": false, "score": 0, "creation_date": 1431110021, "post_id": 30128005, "comment_id": 48371196, "body": "@GabrielCiubotaru By the way, <code>~</code> is not called &quot;thumb&quot;. I referred to my quick rule as a &quot;thumb rule&quot; in the usual English meaning of &quot;quick, possibly not covering 100% of cases, but useful rule&quot; <a href=\"http://en.wikipedia.org/wiki/Rule_of_thumb\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Rule_of_thumb</a>"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 1, "last_activity_date": 1431109818, "last_edit_date": 1431109818, "creation_date": 1431100355, "answer_id": 30128005, "question_id": 30122855, "link": "https://stackoverflow.com/questions/30122855/haskell-as-binding-on-irrefutable-pattern/30128005#30128005", "title": "Haskell AS binding on irrefutable pattern", "body": "<p>The thumb rule is:</p>\n\n<ul>\n<li>an irrefutable/lazy pattern <code>~p</code> matches everything</li>\n<li>if a variable <code>x</code> in <code>p</code> is demanded, consider all the constructors in the syntactic tree of <code>p</code> reachable from <code>x</code> except for moving <em>downwards</em> across a <code>~</code>: the value being matched will be evaluated to match these constructors</li>\n<li>if the match above fails, raise an exception</li>\n</ul>\n\n<p>Example:</p>\n\n<pre><code>case value of ~(x,y:ys,~(z,w:ws)) -&gt; ...\n</code></pre>\n\n<ul>\n<li>if we do not demand anything, then <code>value</code> will not be evaluated</li>\n<li>if we demand <code>x</code> or <code>y</code> or <code>ys</code>, then <code>value</code> will be evaluated as much as needed to match <code>y:ys</code> (and the triple)</li>\n<li>if we demand <code>z</code> or <code>w</code> or <code>ws</code>, then <code>value</code> will be evaluated as much as needed to match <code>y:ys</code> and <code>w:ws</code> (and the triple and the pair)</li>\n</ul>\n\n<p>Tests:</p>\n\n<pre><code>&gt; case undefined of ~(x,y:ys,~(z,w:ws)) -&gt; \"hello\"\n\"hello\"\n&gt; case (3,undefined,(4,[1])) of ~(x,y:ys,~(z,w:ws)) -&gt; x\n*** Exception: Prelude.undefined\n&gt; case (3,[],(4,[1])) of ~(x,y:ys,~(z,w:ws)) -&gt; x\n*** Exception: Irrefutable pattern failed for pattern (x, y : ys, ~(z, w : ws))\n&gt; case (3,[0],(4,undefined)) of ~(x,y:ys,~(z,w:ws)) -&gt; x\n3\n&gt; case (3,[0],(4,[])) of ~(x,y:ys,~(z,w:ws)) -&gt; x\n3\n&gt; case (3,[],(4,[1])) of ~(x,y:ys,~(z,w:ws)) -&gt; z\n*** Exception: Irrefutable pattern failed for pattern (x, y : ys, ~(z, w : ws))\n&gt; case (3,[0],(4,[])) of ~(x,y:ys,~(z,w:ws)) -&gt; z\n*** Exception: Irrefutable pattern failed for pattern (z, w : ws)\n</code></pre>\n\n<p>In my opinion, the semantic could be nicer if every subpattern under a <code>~</code> behaved as if it had <code>~</code> above it. E.g. if <code>~(x,y:ys)</code> were equivalent to <code>~(x,~(y:ys))</code>. The current semantics does allow for more flexibility, though.</p>\n\n<hr>\n\n<p>The rule holds even in the presence of \"as\" patterns. For instance, in</p>\n\n<pre><code>case value of a@ ~(x,y:ys,~b@(z,c@(w:ws))) -&gt; ...\n</code></pre>\n\n<p>demanding <code>a</code> will not evaluate the <code>value</code> but demanding any other variable\nwill cause <code>value</code> to be evaluated so to match the triple.\nFurther, demanding any of <code>x,y,ys</code> will also cause the evaluation to match\nthe list constructor in <code>y:ys</code>. Instead, matching <code>b</code> or any of <code>z,c,w,ws</code> will cause <code>value</code> to be evaluated further, so to match the pair <code>(z,c@(w:ws))</code> as well as the list <code>w:ws</code>, which are under the second <code>~</code>.</p>\n\n<pre><code>--Here is an example with \"as\" pattern outside that will succeed\n&gt; case (1,[],(2,[3])) of a@ ~(x,y:ys,~b@(z,c@(w:ws))) -&gt; a\n(1,[],(2,[3]))\n\n--This will fail because the triple as well as y:ys will be evaluated along a\n&gt; case (1,[],(2,[3])) of ~a@(x,y:ys,~b@(z,c@(w:ws))) -&gt; a\n*** Exception: Irrefutable pattern failed for pattern a@(x, y : ys, ~b@(z, c@(w : ws)))\n</code></pre>\n\n<hr>\n\n<p>In your code you can simply put the \"as\" binding outside the <code>~</code> like this:</p>\n\n<pre><code>helper stack@ ~(x1:x2:xs) el \n    | el == \"+\" = (x2 + x1) : xs\n    | el == \"-\" = (x2 - x1) : xs\n    | el == \"*\" = (x2 * x1) : xs\n    | el == \"/\" = (x2 `div` x1) : xs\n    | otherwise = (read el) : stack \n</code></pre>\n\n<p>and will work fine for any valid RPN input.</p>\n"}], "owner": {"reputation": 982, "user_id": 2135043, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/83d3466bbc8f604f37ae6a2891c9e8c3?s=128&d=identicon&r=PG", "display_name": "Gabriel Ciubotaru", "link": "https://stackoverflow.com/users/2135043/gabriel-ciubotaru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 0, "accepted_answer_id": 30128005, "answer_count": 3, "score": 2, "last_activity_date": 1431109818, "creation_date": 1431084930, "last_edit_date": 1431090432, "question_id": 30122855, "link": "https://stackoverflow.com/questions/30122855/haskell-as-binding-on-irrefutable-pattern", "title": "Haskell AS binding on irrefutable pattern", "body": "<p>I'm trying to use both irrefutable pattern and AS bindings into a function that evaluate a reverse polish notation expression.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>resolveRPN :: String -&gt; [Integer]\nresolveRPN = foldl helper [] . words \n    where \n        helper ~stack@(x1:x2:xs) el \n            | el == \"+\" = (x2 + x1) : xs\n            | el == \"-\" = (x2 - x1) : xs\n            | el == \"*\" = (x2 * x1) : xs\n            | el == \"/\" = (x2 `div` x1) : xs\n            | otherwise = (read el) : stack            \n</code></pre>\n\n<p>Basically the irrefutable will fail if you give a list with less than 2 elements but this should be only used for \"+-*/\".\nIf the function is applied to \"10 10\" it should just use the \"otherwise\" and use the AS binding \"stack\" and should not try to break it into constructos, but is seems it doesn't work like that.</p>\n\n<p>If for instance I fold with helper and use [0,0] as accumulator, everithing works fine even if there is no need of this values.</p>\n\n<p>Can someone explain why this code still raise \"irrefutable pattern\" excepton ? Or how Haskell evaluate this ?</p>\n\n<p>Here is the simplified code :</p>\n\n<pre><code>notWorking :: [Int]\nnotWorking = helper [] \"10\" \n        where \n            helper ~stack@(x1:x2:xs) el = (read el) : stack  \n\nworking:: [Int]\nworking = helper [] \"10\" \n    where \n        helper ~stack el = (read el) : stack  \n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 4295, "user_id": 1916893, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/XTlc8.png?s=128&g=1", "display_name": "TobiMcNamobi", "link": "https://stackoverflow.com/users/1916893/tobimcnamobi"}, "edited": false, "score": 1, "creation_date": 1431077260, "post_id": 30119465, "comment_id": 48350647, "body": "Only one small detail: In OP the index begins at <code>0</code> so the infinite index list must be <code>[0..]</code>."}], "tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": false, "score": 2, "last_activity_date": 1431079581, "last_edit_date": 1431079581, "creation_date": 1431074582, "answer_id": 30119465, "question_id": 30119252, "link": "https://stackoverflow.com/questions/30119252/haskell-minimum-position/30119465#30119465", "title": "Haskell : Minimum position", "body": "<h2>Problem with your code</h2>\n\n<pre><code>findPos :: [Int] -&gt; Int-&gt; [Int]\nfindPos list minimum (list) = ...\n</code></pre>\n\n<p>That's just plain wrong. You're finding the minimum later (with <code>minimum list</code>); don't need to pass it:</p>\n\n<pre><code>findPos :: [Int] -&gt; [Int]\nfindPos list = ...\n</code></pre>\n\n<h2>My Solution</h2>\n\n<p>Not recursive, but it's how I would personally do it.</p>\n\n<p>I like the zipping solutions a lot, and I am not sure why you opted for the comprehension.</p>\n\n<ol>\n<li>Find the smallest element.</li>\n<li>Zip your data with <code>[0..]</code>.</li>\n<li>Filter out data basing on <code>snd</code> being equal to the smallest element.</li>\n<li>Take out the <code>fst</code> of resulting tuples.</li>\n</ol>\n\n<p><kbd><a href=\"http://coliru.stacked-crooked.com/a/56af6ace5f919378\" rel=\"nofollow\"><strong>Live on Coliru</strong></a></kbd></p>\n\n<hr>\n\n<h3>Spoiler alert</h3>\n\n<pre><code>xs = [1,2,3,1,1]\n\nfindPos = map fst . filter (\\e -&gt; snd e == x) . zip [0..]\n    where\n        x = minimum xs\n\nmain = print $ findPos xs\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 12035, "user_id": 603094, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/325af9a946cb4337c6640f0e95044be1?s=128&d=identicon&r=PG", "display_name": "kirelagin", "link": "https://stackoverflow.com/users/603094/kirelagin"}, "is_accepted": false, "score": 2, "last_activity_date": 1431077061, "last_edit_date": 1431077061, "creation_date": 1431075623, "answer_id": 30119825, "question_id": 30119252, "link": "https://stackoverflow.com/questions/30119252/haskell-minimum-position/30119825#30119825", "title": "Haskell : Minimum position", "body": "<p>The serious problem with your code is that you have something strange on the left of the function definitions.</p>\n\n<p>In the first case you have:</p>\n\n<pre><code>findPos :: [Int] -&gt; Int-&gt; [Int]\nfindPos list minimum (list) = \u2026\n</code></pre>\n\n<p>What does this mean? Judging by the signature you gave to <code>findPos</code>, it takes a list and the element that we are looking for. So the the definition has to be:</p>\n\n<pre><code>findPos list m = [index | (index, e) &lt;- zip [0..] list, e == m]\n</code></pre>\n\n<p>and in this case there is no need to call the <code>minim</code> function on the right hand side, but instead you\u2019ll have to call <code>minim</code> before calling <code>findPos</code> to pass it the minimal element like this:</p>\n\n<pre><code>findPos' :: [Int] -&gt; [Int]\nfindPos' list = findPos list (minim list)\n</code></pre>\n\n<p><strong>Or</strong> you can change your definition to:</p>\n\n<pre><code>findPos :: [Int] -&gt; [Int]\nfindPos list = [index | (index, e) &lt;- zip [0..] list, e == minim list]\n</code></pre>\n\n<p>and in this case you do call <code>minim</code> on the right hand side, but the signature of <code>findPos</code> becomes different.</p>\n\n<hr>\n\n<p>Now to the recursive minimum function. You should really use pattern matching as much as possible:</p>\n\n<pre><code>minim :: [Int] -&gt; Int\nminim (x : []) = x\nminim (x : xs) = if x &lt; m then x else m\n  where\n    m = minim xs\n</code></pre>\n\n<p>Otherwise your <code>minim</code> is almost correct except for the fact that you define <code>n</code> twice.</p>\n"}, {"tags": [], "owner": {"reputation": 4773, "user_id": 4148211, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/DiKJf.jpg?s=128&g=1", "display_name": "frasertweedale", "link": "https://stackoverflow.com/users/4148211/frasertweedale"}, "is_accepted": false, "score": 1, "last_activity_date": 1431084447, "last_edit_date": 1431084447, "creation_date": 1431083809, "answer_id": 30122501, "question_id": 30119252, "link": "https://stackoverflow.com/questions/30119252/haskell-minimum-position/30122501#30122501", "title": "Haskell : Minimum position", "body": "<p>As a variation on the earlier answers, let's consider a solution where we visit each element of the input list exactly once.  Like earlier answers, this is not an <em>explicitly</em> recursive solution, but it uses the recursive function <code>foldr</code>.</p>\n\n<pre><code>-- | Accumulate function\n--\nacc :: Ord a =&gt; (t, a) -&gt; ([t], a) -&gt; ([t], a)\nacc (i, x) z@(is, y) = case compare x y of\n  LT -&gt; ([i], x)   -- a new minimum! reinit the list of mins\n  EQ -&gt; (i:is, y)  -- equal minimum; add to the list of mins\n  _  -&gt; z          -- larger than min; accumulator unchanged\n\nfindPos = (Bounded a, Ord a) =&gt; [a] -&gt; [Int]\nfindPos = fst . foldr acc ([], maxBound) . zip [(0 :: Int)..]\n</code></pre>\n\n<p>So we <code>zip</code> the indicies (counting from zero) with our list of numbers, apply the fold with the accumulator initialised to <code>([], maxBound)</code> (the initial minimum is the largest possible value), then extract the list of indices of the minimum value in the input.</p>\n\n<p>To eliminate the <code>Bounded</code> type class constraint (so <code>findPos</code> could work with <code>Integer</code> or other unbounded ordered types) one could apply the <code>Maybe</code> type constructor, which I leave as an exercise.</p>\n\n<p>Tracking the \"minimum seen value\" as well as the indices where that value was seen makes it possible to build a stream processing machine of which you could ask at any time, \"what were the indices of the minimum value in the (<em>possibly infinite</em>) input stream <em>so far</em>.\"</p>\n"}], "owner": {"reputation": 51, "user_id": 4872398, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-rI__jx8whfA/AAAAAAAAAAI/AAAAAAAAAA8/TXlkCtXmh0Y/photo.jpg?sz=128", "display_name": "Gya", "link": "https://stackoverflow.com/users/4872398/gya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 573, "favorite_count": 0, "answer_count": 3, "score": 4, "last_activity_date": 1431084447, "creation_date": 1431073817, "last_edit_date": 1431073918, "question_id": 30119252, "link": "https://stackoverflow.com/questions/30119252/haskell-minimum-position", "title": "Haskell : Minimum position", "body": "<p>I'm beginner in Haskell terms. I have to do an exercise that shows all minimum positions.\n For example: [1,2,3,1,1] => 0,3,4 these are minimum positions.\n I tried to do this in 2 ways, but these doesn't work.\n Please can someone help me with a recursive version?</p>\n\n<p>First:</p>\n\n<pre><code>findPos :: [Int]-&gt;Int-&gt;[Int]\nfindPos list minimum (list) = [index | (index, e) &lt;- zip [0..] list, e == minimum (list)]\n</code></pre>\n\n<p>Second:</p>\n\n<pre><code>findPos :: [Int]-&gt;Int-&gt;[Int]\nfindPos list (minim el) = [index | (index, e) &lt;- zip [0..] list, e == (minim el)]\n\n\nminim :: [Int] -&gt; Int\nminim x = if (tail(x)==[]) then head(x)\n      else n \n      where n = minim (tail(x))\n            n = if n &lt; head(x) then n\n            else head(x)\n</code></pre>\n"}, {"tags": ["haskell", "yesod", "rawsql"], "answers": [{"comments": [{"owner": {"reputation": 557, "user_id": 4587327, "user_type": "registered", "accept_rate": 18, "profile_image": "https://lh6.googleusercontent.com/-eepjCZh3Ed8/AAAAAAAAAAI/AAAAAAAAAG8/qey1ipv0gxI/photo.jpg?sz=128", "display_name": "Ryan Monreal", "link": "https://stackoverflow.com/users/4587327/ryan-monreal"}, "edited": false, "score": 0, "creation_date": 1431227156, "post_id": 30118428, "comment_id": 48402717, "body": "i tried you&#39;re idea but it&#39;s the same, it&#39;s has an error. . . . ."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 1, "last_activity_date": 1431070825, "creation_date": 1431070825, "answer_id": 30118428, "question_id": 30118299, "link": "https://stackoverflow.com/questions/30118299/yesod-single-rawsql-and-return-it-as-json-format/30118428#30118428", "title": "Yesod Single RawSql and Return it as JSON Format", "body": "<p>The line</p>\n\n<pre><code>return map (\\(...) -&gt; [ ... ]) results\n</code></pre>\n\n<p>looks wrong, you probably mean</p>\n\n<pre><code>return $ map (\\(...) -&gt; [ ... ]) results\n</code></pre>\n\n<p>Also, this returns a list of lists, which is not a <code>Value</code> as in the type signature.</p>\n\n<p>Further, this is an <em>error</em>, not a warning:</p>\n\n<pre><code>Couldn't match type [[aeson-0.8.0.0:Data.Aeson.Types.Internal.Pair]]\n          with Value\nExpected type: HandlerT App IO Value\nActual type: HandlerT\n             App IO [[aeson-0.8.0.0:Data.Aeson.Types.Internal.Pair]] \u2026\n</code></pre>\n"}], "owner": {"reputation": 557, "user_id": 4587327, "user_type": "registered", "accept_rate": 18, "profile_image": "https://lh6.googleusercontent.com/-eepjCZh3Ed8/AAAAAAAAAAI/AAAAAAAAAG8/qey1ipv0gxI/photo.jpg?sz=128", "display_name": "Ryan Monreal", "link": "https://stackoverflow.com/users/4587327/ryan-monreal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1431070825, "creation_date": 1431070417, "question_id": 30118299, "link": "https://stackoverflow.com/questions/30118299/yesod-single-rawsql-and-return-it-as-json-format", "title": "Yesod Single RawSql and Return it as JSON Format", "body": "<p>hope you help me with this.</p>\n\n<p>i have a rawSql:</p>\n\n<pre><code>latestPrice :: Handler [(Single PricesId, Single PersistValue, Single    PersistValue, Single PersistValue, Single PersistValue, Single PersistValue)]\nlatestPrice = do\n  runDB $ rawSql qryStr []\n        where qryStr = \" SELECT prices.id,\\\n                            \\CONCAT(cities.name, '(', states.code, '), ', countries.name) as city, \\\n                            \\prices.s_id, \\\n                            \\prices.s_name, \\\n                            \\prices.quality, \\\n                            \\AVG(prices.amount) as amount \\\n                    \\FROM prices \\\n                    \\INNER JOIN cities ON cities.id = prices.city_id \\\n                    \\INNER JOIN states ON states.id = cities.state_id \\\n                    \\INNER JOIN countries ON countries.id = states.country_id \\\n                    \\WHERE prices.city_id &gt; 0 \\\n                    \\GROUP BY prices.id, city, prices.strain_id, prices.strain_name, prices.quality, prices.quality;\";\n</code></pre>\n\n<p>and i have a handler that call that function and should return a JSON Format:</p>\n\n<pre><code>getLatestPriceSubmissionR:: Handler (Value)\ngetLatestPriceSubmissionR  = do\n    results &lt;- latestPrice\n    return map (\n     \\(Single id, Single city, Single s_name, Single strain_id, Single quality, Single amount) -&gt; [ \"id\" .= id,\"city\" .=  city,\"s_id\" .=  s_id,\"s_name\" .=  s_name, \"quality\" .= quality,\"amount\" .= amount ]\n   ) results\n</code></pre>\n\n<p>my question is:\n does my code in Handler <code>getLatestPriceSubmissionR</code> is correct?\n it does give me only a warning message not an error message:</p>\n\n<pre><code>Couldn't match type [[aeson-0.8.0.0:Data.Aeson.Types.Internal.Pair]]\n          with Value\nExpected type: HandlerT App IO Value\nActual type: HandlerT\n             App IO [[aeson-0.8.0.0:Data.Aeson.Types.Internal.Pair]] \u2026\n</code></pre>\n\n<p>also</p>\n\n<pre><code>No instance for (ToTypedContent [Value])\narising from a use of yesodRunner\n</code></pre>\n\n<p>Hope you help me.</p>\n\n<p>thank you in advance</p>\n"}, {"tags": ["haskell", "optimization"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1431068675, "post_id": 30117396, "comment_id": 48345741, "body": "It&#39;s a bit hard to read what&#39;s going on in <code>ref</code> and <code>go</code> but it will most likely be lot&#39;s of thunks (sometimes <i>tail-recursion</i> is not the best with Haskell) - I would try to make those functions strict (should be easy with <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/bang-patterns.html\" rel=\"nofollow noreferrer\">BangPatterns</a>)"}], "answers": [{"comments": [{"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1431100819, "post_id": 30117755, "comment_id": 48365983, "body": "I find it very strange that the run time didn&#39;t change much after that. So allocating 6gb of memory costed no time at all?"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1431106783, "post_id": 30117755, "comment_id": 48369463, "body": "Well, allocation is pretty cheap with GHC. It seems be relatively cheap in comparison to the non-allocating computation here. I optimized your code to about <a href=\"http://lpaste.net/132236\" rel=\"nofollow noreferrer\">3.5x speed</a>, and in that case the allocating version of the code was ~20% slower, so it doesn&#39;t cost nothing."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1431171133, "post_id": 30117755, "comment_id": 48387628, "body": "Wow, very cool, thank you. Is there any reason not to replace Prelude&#39;s <code>(^)</code> and <code>even</code> with yours?"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1431175834, "post_id": 30117755, "comment_id": 48388985, "body": "I&#39;m pretty sure the functions are slow in <code>base</code> because <code>even</code> fails to inline in ghc-7.10. If you compile with ghc 7.8.4 with <code>base</code>-exported <code>^</code> and <code>even</code>, you still get no heap allocation and good speed. I found this out when I wrote <a href=\"http://stackoverflow.com/questions/29875886/haskell-why-does-int-performs-worse-than-word64-and-why-my-program-is-far-slow/29879538#29879538\">this answer</a>. So the issue is not with <code>base</code>. Although one could argue that <code>base</code> should define <code>even</code> as I did, because without LLVM we don&#39;t get the bitwise check in the machine code."}, {"owner": {"reputation": 325758, "user_id": 415784, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2WX9Z.jpg?s=128&g=1", "display_name": "Nawaz", "link": "https://stackoverflow.com/users/415784/nawaz"}, "edited": false, "score": 0, "creation_date": 1594768499, "post_id": 30117755, "comment_id": 111241144, "body": "<code>52,016 bytes allocated in the heap</code>. How come this value is so low here? I usually see a high value (in GBs) even if <code>total memory in use</code> is less than <code>10m</code>."}], "tags": [], "owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "is_accepted": true, "score": 14, "last_activity_date": 1431068678, "creation_date": 1431068678, "answer_id": 30117755, "question_id": 30117396, "link": "https://stackoverflow.com/questions/30117396/why-is-this-haskell-program-allocating-so-much-memory/30117755#30117755", "title": "Why is this Haskell program allocating so much memory?", "body": "<p>The allocation is coming from the <code>go</code> in <code>isPalindrome</code>:</p>\n\n<pre><code>go m x = x &lt;= 0 || div x m == mod x 10 &amp;&amp; go (div m 100) (div (x - m * mod x 10) 10)\n</code></pre>\n\n<p>We have a <code>||</code> on the right hand side. The short-circuit semantics of <code>||</code> is realized through lazy evaluation. GHC sees that the <code>m</code> argument is unused if <code>x &lt;= 0</code> evaluates to <code>True</code>, so it doesn't unbox <code>m</code>, allowing it to remain uncomputed. Of course, in this case we're better off unboxing <code>m</code> too, so let's do that.</p>\n\n<pre><code>{-# LANGUAGE BangPatterns #-}\ngo !m x = ...\n</code></pre>\n\n<p>Now with <code>ghc -O2</code> and <code>+RTS -s</code>:</p>\n\n<pre><code>      52,016 bytes allocated in the heap\n       3,408 bytes copied during GC\n      44,312 bytes maximum residency (1 sample(s))\n      17,128 bytes maximum slop\n           1 MB total memory in use (0 MB lost due to fragmentation)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 707, "user_id": 646408, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e62561db40e46118628b31cba87840d6?s=128&d=identicon&r=PG", "display_name": "lpsmith", "link": "https://stackoverflow.com/users/646408/lpsmith"}, "is_accepted": false, "score": 2, "last_activity_date": 1431069113, "last_edit_date": 1431069113, "creation_date": 1431068764, "answer_id": 30117793, "question_id": 30117396, "link": "https://stackoverflow.com/questions/30117396/why-is-this-haskell-program-allocating-so-much-memory/30117793#30117793", "title": "Why is this Haskell program allocating so much memory?", "body": "<p>GHC has sometimes been termed \"evaluation by allocation\".    What's more important is whether or not the memory is retained.    Just eyeballing the code,  I don't see any obvious space leaks.</p>\n\n<p>Have you looked at the <a href=\"https://downloads.haskell.org/~ghc/7.10.1/docs/html/users_guide/runtime-control.html#idp13323056\" rel=\"nofollow\">runtime stats</a>?   You don't even need profiling libraries for that.   What is of greater interest here is the GC bytes copied,  and maximum residency... both of which I would guess to be comparatively very small.</p>\n\n<p>Beyond the first-order concerns,  most of those allocations are probably closures.  Are you compiling <code>ghc -O</code> in order to run the strictness analyzer?  Even if you are,  I'm not sure that the strictness analyzer would be able to eliminate closure allocation for the <code>m</code> argument in the first <code>go</code> function or the <code>x</code> and <code>y</code> arguments in the second <code>go</code>.   My guess is that bang patterns would greatly reduce your allocations here.</p>\n\n<p>The practical consequences of tail recursion are very different in Haskell than a strict language;  so if you are familiar with tail calls in a strict language,  your intuitions are probably off.</p>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 1, "accepted_answer_id": 30117755, "answer_count": 2, "score": 6, "last_activity_date": 1431069113, "creation_date": 1431067389, "question_id": 30117396, "link": "https://stackoverflow.com/questions/30117396/why-is-this-haskell-program-allocating-so-much-memory", "title": "Why is this Haskell program allocating so much memory?", "body": "<p>Mind the following Haskell program:</p>\n\n<pre><code>-- (^) allocs memory so we define it using the native (**)\npow :: Int -&gt; Int -&gt; Int\npow x y = floor $ fromIntegral x ** fromIntegral y\n\n-- tail recursive, div and mod are native, I believe, so, no alloc\nisPalindrome :: Int -&gt; Bool\nisPalindrome x = go (pow 10 (floor $ logBase 10 $ fromIntegral x)) x\n    where go m x = x &lt;= 0 || div x m == mod x 10 &amp;&amp; go (div m 100) (div (x - m * mod x 10) 10)\n\n-- go is tail recursive too... no obvious allocation here\nwanderer :: Int -&gt; Int\nwanderer n = go 0 (pow 10 n - 1) (pow 10 n - 1) where\n    go p x y | p &gt; 0 &amp;&amp; div p x &gt;= pow 10 n  = p                \n    go p x y | p &gt; 0 &amp;&amp; y &lt; div p x || y &lt; x = go p (x-1) (pow 10 n - 1)\n    go p x y | isPalindrome (x*y)            = go (x*y) x (y-1) \n    go p x y                                 = go p x (y-1)     \n\nmain = print . wanderer $ 8\n</code></pre>\n\n<p>Profiling it, we get:</p>\n\n<pre><code>Fri May  8 03:36 2015 Time and Allocation Profiling Report  (Final)\n\n       aff +RTS -p -RTS\n\n    total time  =        7.34 secs   (7344 ticks @ 1000 us, 1 processor)\n    total alloc = 6,487,919,472 bytes  (excludes profiling overheads)\n\nCOST CENTRE     MODULE    %time %alloc\n\nisPalindrome    Main       41.9   18.5\nisPalindrome.go Main       22.6    1.4\nwanderer.go     Main       20.0   67.8\npow             Main       15.5   12.3\n\n\n                                                                individual     inherited\nCOST CENTRE           MODULE                  no.     entries  %time %alloc   %time %alloc\n\nMAIN                  MAIN                     47           0    0.0    0.0   100.0  100.0\n main                 Main                     95           0    0.0    0.0     0.0    0.0\n CAF:main1            Main                     92           0    0.0    0.0     0.0    0.0\n  main                Main                     94           1    0.0    0.0     0.0    0.0\n CAF:main2            Main                     91           0    0.0    0.0   100.0  100.0\n  main                Main                     96           0    0.0    0.0   100.0  100.0\n   wanderer           Main                     98           1    0.0    0.0   100.0  100.0\n    pow               Main                    101           1    0.0    0.0     0.0    0.0\n    wanderer.go       Main                     99    49995002   20.0   67.8   100.0  100.0\n     isPalindrome     Main                    102    49985002   41.9   18.5    80.0   32.2\n      pow             Main                    104    49985002   15.5   12.3    15.5   12.3\n      isPalindrome.go Main                    103    52207117   22.6    1.4    22.6    1.4\n     pow              Main                    100           1    0.0    0.0     0.0    0.0\n   pow                Main                     97           2    0.0    0.0     0.0    0.0\n CAF                  GHC.Conc.Signal          85           0    0.0    0.0     0.0    0.0\n CAF                  GHC.IO.Encoding          78           0    0.0    0.0     0.0    0.0\n CAF                  GHC.IO.Encoding.Iconv    76           0    0.0    0.0     0.0    0.0\n CAF                  GHC.IO.Handle.FD         69           0    0.0    0.0     0.0    0.0\n CAF                  GHC.Event.Thread         55           0    0.0    0.0     0.0    0.0\n</code></pre>\n\n<p>As far as I'm aware, it seems like all my functions are tail recursive and those prelude functions are asm operations. Yet this simple program allocs 7gb of memory. Where is all the allocation coming from?</p>\n"}, {"tags": ["parsing", "haskell", "time"], "answers": [{"comments": [{"owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "edited": false, "score": 0, "creation_date": 1431049411, "post_id": 30114372, "comment_id": 48339737, "body": "But <code>parseTime</code> is now deprecated. Suggestions? Perhaps force <code>parseTimeM</code> to return <code>Maybe UTCTime</code> and deal with it as before?"}, {"owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "reply_to_user": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "edited": false, "score": 0, "creation_date": 1431049580, "post_id": 30114372, "comment_id": 48339778, "body": "@Ana: Yeah, I think that&#39;s the best solution. The less you can rely on <code>fail</code> the better."}], "tags": [], "owner": {"reputation": 64805, "user_id": 286871, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/xNBpr.png?s=128&g=1", "display_name": "Tikhon Jelvis", "link": "https://stackoverflow.com/users/286871/tikhon-jelvis"}, "is_accepted": true, "score": 3, "last_activity_date": 1431048751, "creation_date": 1431048751, "answer_id": 30114372, "question_id": 30114318, "link": "https://stackoverflow.com/questions/30114318/how-to-properly-use-haskells-parsetimem-function/30114372#30114372", "title": "How to properly use Haskell&#39;s `parseTimeM` function?", "body": "<p><code>Except</code> is part of the <code>mtl</code>, which is a monad transformer library. The usual style with transformers is to define the transformer for some behavior (<code>ExceptT</code> in this case) and express the base version as a type synonym:</p>\n\n<pre><code>type Except e = ExceptT e Identity\n</code></pre>\n\n<p>So you are probably getting an exception because the <code>fail</code> for <code>Except</code> has to go through the <code>Identity</code> monad at the bottom of its little monad transformer stack.</p>\n\n<p>With <code>Except e</code> specifically, how would you implement <code>fail</code> for an <em>arbitrary</em> type <code>e</code>? Since we don't know anything at all about <code>e</code>, we can't just conjure up a value of <code>e</code> given a string, so <code>fail</code> would <em>have</em> to give you an exception or loop forever.</p>\n\n<p>All this is a pretty good argument against the <code>parseTimeM</code> style of relying on <code>fail</code> in the <code>Monad</code> class. </p>\n"}], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 785, "favorite_count": 0, "accepted_answer_id": 30114372, "answer_count": 1, "score": 4, "last_activity_date": 1431048751, "creation_date": 1431048315, "question_id": 30114318, "link": "https://stackoverflow.com/questions/30114318/how-to-properly-use-haskells-parsetimem-function", "title": "How to properly use Haskell&#39;s `parseTimeM` function?", "body": "<p>Haskell has the function <a href=\"https://hackage.haskell.org/package/time-1.5.0.1/docs/Data-Time-Format.html\" rel=\"nofollow\"><code>parseTimeM</code></a>, which replaces the deprecated <code>parseTime</code> function. I suppose the reason why the former is preferred over the latter is because it has better flexibility in reporting parse errors. Instead of a <code>Maybe</code>, it can call <code>fail</code> on the enclosing monad.</p>\n\n<p>So I tried it. First, the deprecated function:</p>\n\n<pre><code>&gt; parseTime defaultTimeLocale  \"%Y\" \"2015\" :: Maybe UTCTime\nJust 2015-01-01 00:00:00 UTC\n\n&gt; parseTime defaultTimeLocale  \"%Y\" \"201x\" :: Maybe UTCTime\nNothing\n</code></pre>\n\n<p>Great. As expected. Then, the <code>Identity</code> monad:</p>\n\n<pre><code>&gt; runIdentity $ parseTimeM  False defaultTimeLocale  \"%Y\" \"2015\" :: UTCTime\n2015-01-01 00:00:00 UTC\n\n&gt; runIdentity $ parseTimeM  False defaultTimeLocale  \"%Y\" \"201x\" :: UTCTime\n*** Exception: parseTimeM: no parse of \"201x\"\n</code></pre>\n\n<p>Also expected, since the <code>Identity</code> monad doesn't have an elegant failure mode. But, I expected something different with the <code>Except</code> monad, the purpose of which is to gracefully catch errors.</p>\n\n<pre><code>&gt; runExcept $ parseTimeM  False defaultTimeLocale  \"%Y\" \"2015\" :: Either () UTCTime\nRight 2015-01-01 00:00:00 UTC\n\n&gt; runExcept $ parseTimeM  False defaultTimeLocale  \"%Y\" \"201x\" :: Either () UTCTime\n*** Exception: parseTimeM: no parse of \"201y\"\n</code></pre>\n\n<p>Why is the exception being thrown here? Shouldn't it return <code>Left ()</code> ? How do I parse a time like I think it should, which is to gracefully return an error if the string to be parsed is poorly formatted?</p>\n"}, {"tags": ["haskell", "network-programming", "ghci", "cloud-haskell"], "owner": {"reputation": 51, "user_id": 4035416, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PPO6W.jpg?s=128&g=1", "display_name": "rdanitz", "link": "https://stackoverflow.com/users/4035416/rdanitz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 1, "answer_count": 0, "score": 5, "last_activity_date": 1507468732, "creation_date": 1431035660, "last_edit_date": 1507468732, "question_id": 30112341, "link": "https://stackoverflow.com/questions/30112341/strange-behaviour-in-ghci-using-cloud-haskell-platform", "title": "Strange behaviour in GHCi using Cloud Haskell Platform", "body": "<p>Following the tutorials (<a href=\"http://haskell-distributed.github.io\" rel=\"nofollow noreferrer\">http://haskell-distributed.github.io</a>), this code \u2013 after calling <code>dev</code> in GHCi \u2013 lets one CPU core spin up to 100% and stays at that level indefinitely. This seem to happen due to the call to <code>closeTransport</code>.</p>\n\n<p>However, evaluating the code in GHCi line by line, does not show this effect. So where does the difference come from and how can I correctly clean up?</p>\n\n<pre><code>import Network.Transport (closeTransport)\nimport Network.Transport.TCP (createTransport, defaultTCPParameters)\nimport Control.Distributed.Process.Node (newLocalNode, closeLocalNode, initRemoteTable)\n\ndev :: IO ()\ndev = do\n  Right t &lt;- createTransport \"localhost\" \"9000\" defaultTCPParameters\n  n &lt;- newLocalNode t initRemoteTable\n  -- do the work\n  closeLocalNode n -- &lt;- doesn't affect the observed behaviour\n  closeTransport t\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 122984, "user_id": 500104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/ff1143d80ee378720a879e79fe6da68f?s=128&d=identicon&r=PG", "display_name": "Xeo", "link": "https://stackoverflow.com/users/500104/xeo"}, "edited": false, "score": 7, "creation_date": 1431024831, "post_id": 30109368, "comment_id": 48329699, "body": "Because <code>(&lt;= 7)</code> is not a condition to <i>end</i> the filtering, but to throw out elements. There might be another element that is <code>&lt;= 7</code> at the 10 millionth position (as far as <code>filter</code> knows)."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 3, "creation_date": 1431025166, "post_id": 30109368, "comment_id": 48329909, "body": "If you have a situation like this, you should be using <code>takeWhile</code> instead."}, {"owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "edited": false, "score": 1, "creation_date": 1431030668, "post_id": 30109368, "comment_id": 48332998, "body": "Basically, GHC is not smart enough to prove that the sequence ends after the 7th element. In this case, Haskell&#39;s <code>filter</code> cannot &quot;reach inside&quot; the function to determine that it is <code>\\x -&gt; x &lt;= 7</code> (can stop after 7) and not, say <code>\\x -&gt; x &lt;= 7 || x == 1000000</code> (can stop after 1 million). It does not <i>analyze</i> the function you pass it, but rather it simply <i>calls</i> it until it can find an output to yield."}, {"owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "reply_to_user": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "edited": false, "score": 0, "creation_date": 1431046187, "post_id": 30109368, "comment_id": 48338877, "body": "@ChrisDrost: Strictly speaking, it&#39;s not that it&#39;s not &quot;smart enough,&quot; but rather that <i>it just doesn&#39;t work that way</i>. The definition of <code>filter</code> requires that filtering a non-finite list <i>must</i> produce a non-finite list as well; if <code>filter</code> returned <code>[]</code> on a list that doesn&#39;t have <code>[]</code> after a finite number of conses, it would be a violation of its equations."}, {"owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "reply_to_user": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "edited": false, "score": 0, "creation_date": 1431103484, "post_id": 30109368, "comment_id": 48367710, "body": "@LuisCasillas It&#39;s both. There is a direct implication from &quot;no function can work the way that you want&quot; to &quot;therefore, <i>this</i> function doesn&#39;t work the way that you want&quot; -- but I agree that it&#39;s really valuable also to see <i>how</i> the function doesn&#39;t work the way that he wants, which indeed requires analyzing the equations."}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 51, "favorite_count": 0, "closed_date": 1431024825, "answer_count": 0, "score": 0, "last_activity_date": 1431024634, "creation_date": 1431024634, "question_id": 30109368, "link": "https://stackoverflow.com/questions/30109368/filtering-over-infinite-list", "closed_reason": "Duplicate", "title": "Filtering over Infinite List", "body": "<p>From <code>ghci</code>, I tried to <code>filter</code> on numbers less than or equal to 7:</p>\n\n<pre><code>ghci&gt; filter (&lt;= 7) [1..]\n[1,2,3,4,5,6,7Interrupted.\n</code></pre>\n\n<p>But I had to cancel out of it (see <strong>Interrupted</strong>) since the program did not seem to terminate (at least that's what I understand it to mean).</p>\n\n<p>Why does the program hang in this code?</p>\n"}, {"tags": ["string", "haskell", "instance", "show"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1431024937, "post_id": 30109165, "comment_id": 48329766, "body": "<code>monstrarTaula</code> is <i>not</i> a type; it&#39;s a function. Only types can belong to typeclasses."}, {"owner": {"reputation": 125, "user_id": 4857400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-UW9ZJNmUMf0/AAAAAAAAAAI/AAAAAAAAAD4/hYGd4E7pLhg/photo.jpg?sz=128", "display_name": "Merche", "link": "https://stackoverflow.com/users/4857400/merche"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1431025176, "post_id": 30109165, "comment_id": 48329915, "body": "Okey but generate this error:    &#39;lastHaskell.hs:10:48:     Duplicate instance declarations:       instance Show Taula -- Defined at lastHaskell.hs:10:48       instance Show Taula -- Defined at lastHaskell.hs:175:10&#39;. becose?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1431025224, "post_id": 30109165, "comment_id": 48329940, "body": "You&#39;ve declared it twice - how is the compiler supposed to choose between the two?"}, {"owner": {"reputation": 125, "user_id": 4857400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-UW9ZJNmUMf0/AAAAAAAAAAI/AAAAAAAAAD4/hYGd4E7pLhg/photo.jpg?sz=128", "display_name": "Merche", "link": "https://stackoverflow.com/users/4857400/merche"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1431025463, "post_id": 30109165, "comment_id": 48330059, "body": "As I define it twice? defined data type, and not only the method instance? where is the second statement?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1431025578, "post_id": 30109165, "comment_id": 48330121, "body": "You haven&#39;t shown it here, so I can&#39;t help you, but the compiler doesn&#39;t lie."}, {"owner": {"reputation": 125, "user_id": 4857400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-UW9ZJNmUMf0/AAAAAAAAAAI/AAAAAAAAAD4/hYGd4E7pLhg/photo.jpg?sz=128", "display_name": "Merche", "link": "https://stackoverflow.com/users/4857400/merche"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1431025728, "post_id": 30109165, "comment_id": 48330202, "body": "where reason is this?  <code>data Taula = Taula String [[String]] </code> okey is for <code>deriving (show)</code>.  Now de poblem is other.. <code>Couldn&#39;t match expected type </code>[Char] -&gt; [Char]&#39;                 with actual type <code>[Char]&#39;     The function </code>show&#39; is applied to two arguments,     but its type <code>[String] -&gt; String&#39; has only one     In the second argument of </code>(++)&#39;, namely       <code>show (mostrarTaula (Taula sep lls)) &quot;&quot;&#39;     In the second argument of </code>(++)&#39;, namely       <code>&quot;&quot; ++ show (mostrarTaula (Taula sep lls)) &quot;&quot;&#39; </code>"}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 1, "last_activity_date": 1431029529, "creation_date": 1431029529, "answer_id": 30110795, "question_id": 30109165, "link": "https://stackoverflow.com/questions/30109165/instance-show-for-specific-data/30110795#30110795", "title": "Instance Show for specific data", "body": "<p>I don't completely understand what is the wanted output, but maybe you can adapt this:</p>\n\n<pre><code>instance Show Taula where\n  show (Taula sep []) = \"\"\n  show (Taula sep (k:lls)) = tractar sep k ++ \"\\n\" ++ show (Taula sep lls)\n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 4857400, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh6.googleusercontent.com/-UW9ZJNmUMf0/AAAAAAAAAAI/AAAAAAAAAD4/hYGd4E7pLhg/photo.jpg?sz=128", "display_name": "Merche", "link": "https://stackoverflow.com/users/4857400/merche"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 30110795, "answer_count": 1, "score": -4, "last_activity_date": 1431030096, "creation_date": 1431024009, "last_edit_date": 1431030096, "question_id": 30109165, "link": "https://stackoverflow.com/questions/30109165/instance-show-for-specific-data", "title": "Instance Show for specific data", "body": "<p>I have defined the following type:</p>\n\n<pre><code>   data Taula = Taula String [[String]]\n</code></pre>\n\n<p>And I created the following instance:</p>\n\n<pre><code>instance Show Taula   \n   where \n     show  Taula [( n , i , c )]  = show  Taula [( n , i , c )]++ \"\\n\" \n     show ( l : ls )  = show l ++  \"\\n\"  ++ show ls  \n</code></pre>\n\n<p>but it generates the following error:</p>\n\n<pre><code>  Equations for `show' have different numbers of arguments\n  lastHaskell.hs:184:18-82\n  lastHaskell.hs:185:18-63\n  In the instance declaration for `Show Taula'\n</code></pre>\n\n<p>then try to divide the problem into the following different methods:</p>\n\n<pre><code>  instance Show mostrarTaula where\n      show (Taula sep []) = \"\"\n      show (Taula sep (k:lls) ) =  show ([tractar sep k]) ++ \"\\n\" \n                                 ++ show (mostrarTaula (Taula sep lls))\n\n--[\"Hola\",\"Que\",\"fas\"] --&gt; \"HolakkQuekkfas\"\n tractar :: String -&gt; [String] -&gt; String\n tractar sep [] = \"\"\n tractar sep par = (head par) ++ sep ++ tractar sep (drop 1 par) \n\n  mostrarTaula :: Taula -&gt; [String] --[[String]] = lls i k=[String]\n  mostrarTaula (Taula sep []) = [\"\"]\n mostrarTaula (Taula sep (k:lls) ) =  [tractar sep k] ++ (mostrarTaula(Taula sep lls))\n</code></pre>\n\n<p>As I can do? What I try is to print a data type consisting of [(String, String, String)]? I would like to display the data in tabular form. with \\ n after each tuple.</p>\n\n<p>Output example:</p>\n\n<p><code>first element tuple1      Second element tuple1     third element tuple1\n    first element tuple2      Second element tuple2     third element tuple2\n    first element tuple3      Second element tuple3     third element tuple3</code></p>\n"}, {"tags": ["xml", "haskell", "hxt"], "comments": [{"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1431024988, "post_id": 30108630, "comment_id": 48329802, "body": "You could use <code>XmlPickler</code> to do this if you want to model the full grammar of a GPX file, since <code>XmlPickler</code> is designed to not ignore extra content.  There are other ways if you don&#39;t want all the information from the file, but I can put an example using <code>XmlPickler</code> as an answer if you&#39;d like, using only the subset of the GPX grammar you&#39;ve defined in your data types."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 1, "creation_date": 1431025488, "post_id": 30108630, "comment_id": 48330078, "body": "Actually, I was able to compile your code as is.  I had to put a type signature on <code>parseGpx</code> of <code>ArrowXml cat =&gt; cat XmlTree Gpx</code>, but it seemed to work just fine for me."}, {"owner": {"reputation": 2567, "user_id": 994206, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/699bacad8f85a069dda312cc29e03baa?s=128&d=identicon&r=PG", "display_name": "Mokosha", "link": "https://stackoverflow.com/users/994206/mokosha"}, "edited": false, "score": 0, "creation_date": 1431028759, "post_id": 30108630, "comment_id": 48331942, "body": "Why did GHC incorrectly infer the type though? Is this a GHC bug?"}, {"owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "edited": false, "score": 0, "creation_date": 1431044111, "post_id": 30108630, "comment_id": 48338286, "body": "So does this mean my code is actually right? I intend to get back a Gpx [Trk]."}, {"owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1431045484, "post_id": 30108630, "comment_id": 48338685, "body": "@bheklilr I&#39;d like to use the primitives instead of the picklers if possible. I&#39;m hoping at this point that someone can complete the basics of the code for me to demonstrate how to actually implement it. <code>HXT</code> sure is one mysterious, poorly documented beast."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 2567, "user_id": 994206, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/699bacad8f85a069dda312cc29e03baa?s=128&d=identicon&r=PG", "display_name": "Mokosha", "link": "https://stackoverflow.com/users/994206/mokosha"}, "edited": false, "score": 0, "creation_date": 1431046550, "post_id": 30108630, "comment_id": 48338960, "body": "@Mokosha I&#39;m guessing the monomorphism restriction."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1431046638, "post_id": 30108630, "comment_id": 48338977, "body": "@Ana The type will be <code>ArrowXml cat =&gt; cat XmlTree Gpx</code>, so you&#39;ll still have to run it using something like <code>runX</code> to get an actual <code>Gpx</code> out of it."}, {"owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "reply_to_user": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 0, "creation_date": 1431053457, "post_id": 30108630, "comment_id": 48340748, "body": "@bheklilr I&#39;ve explored it a bit more and now I think that adding the type actually fools the compiler into accepting the code, but it is not correct. This is because HXT returns lists of items through the arrows (like the <code>List</code> monad). If I pass the data through <code>arr Gpx</code>, it should apply <code>Gpx</code> to every item, not apply <code>Gpx</code> to the list of items. So the error is correct. In which case, my original question stands, which is how do I pass the list of items returned through a single arrow (the <code>Gpx</code> constructor) instead of passing each item through the <code>Gpx</code> constructor. Updated question."}], "answers": [{"comments": [{"owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "edited": false, "score": 0, "creation_date": 1431062587, "post_id": 30115082, "comment_id": 48343194, "body": "That&#39;s it! As you pointed out, the trick is <code>&gt;.</code>, which I never knew about before. Thank you very much for working this out."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "reply_to_user": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "edited": false, "score": 0, "creation_date": 1431091798, "post_id": 30115082, "comment_id": 48359761, "body": "@Ana In particular you are interested in the functions in <code>ArrowList</code>, there are a couple in there that are useful.  I also used <code>&gt;&gt;.</code> with <code>catMaybes</code> since it&#39;s designed to transform the entire list, preserving the <code>ArrowList</code>&#39;s structure.  There are some other useful combinators in there too that you may find useful for parsing in the future."}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 1, "last_activity_date": 1431054318, "creation_date": 1431054318, "answer_id": 30115082, "question_id": 30108630, "link": "https://stackoverflow.com/questions/30108630/how-to-wrap-a-the-entire-list-of-matches-from-hxt-with-a-datatype-constructor/30115082#30115082", "title": "How to wrap a the entire list of matches from HXT with a datatype constructor?", "body": "<p>Here's a solution that seems pretty good to me</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE Arrows #-}\n\nimport Data.Maybe\nimport Text.Read\nimport Text.XML.HXT.Core\nimport Control.Applicative\n\ndata Gpx    = Gpx [Trk]           deriving (Show)\ndata Trk    = Trk [TrkSeg]        deriving (Show)\ndata TrkSeg = TrkSeg [TrkPt]      deriving (Show)\ndata TrkPt  = TrkPt Double Double deriving (Show)\n</code></pre>\n\n<p>The trickiest one is probably the <code>parseTrkPt</code> because in order to do it right you have to handle parsing <code>String</code>s to <code>Double</code>, which can fail.  I've made the decision to have it return a <code>Maybe TrkPt</code> instead, and then handle that further down the line:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>elemsNamed :: ArrowXml cat =&gt; String -&gt; cat XmlTree XmlTree\nelemsNamed name = isElem &gt;&gt;&gt; hasName name\n\nparseTrkPt :: ArrowXml cat =&gt; cat XmlTree (Maybe TrkPt)\nparseTrkPt = elemsNamed \"trkpt\" &gt;&gt;&gt;\n    proc trkpt -&gt; do\n        lat &lt;- getAttrValue \"lat\" -&lt; trkpt\n        lon &lt;- getAttrValue \"lon\" -&lt; trkpt\n        returnA -&lt; TrkPt &lt;$&gt; readMaybe lat &lt;*&gt; readMaybe lon\n</code></pre>\n\n<p>I've also used the <code>proc</code> syntax here because I think it comes out a lot cleaner.  The <code>TrkPt &lt;$&gt; readMaybe lat &lt;*&gt; readMaybe lon</code> has the type <code>Maybe TrkPt</code> and will return <code>Nothing</code> if either of the <code>readMaybe</code>s returns <code>Nothing</code>.  We can now aggregate all the successful results:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>parseTrkSeg :: (ArrowXml cat, ArrowList cat) =&gt; cat XmlTree TrkSeg\nparseTrkSeg =\n    elemsNamed \"trkseg\" &gt;&gt;&gt;\n    (getChildren &gt;&gt;&gt; parseTrkPt &gt;&gt;. catMaybes) &gt;. TrkSeg\n</code></pre>\n\n<p>The parentheses are important here, it took me a while to figure that part out.  Depending on where you place the parens you'll get different results, such as <code>[TrkSeg [TrkPt a b], TrkSeg [TrkPt c d]]</code> instead of <code>[TrkSeg [TrkPt a b, TrkPt c d]]</code>.  The next to parsers are both straightforward following a similar pattern:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>parseTrk :: ArrowXml cat =&gt; cat XmlTree Trk\nparseTrk =\n    elemsNamed \"trk\" &gt;&gt;&gt;\n    (getChildren &gt;&gt;&gt; parseTrkSeg) &gt;. Trk\n\nparseGpx :: ArrowXml cat =&gt; cat XmlTree Gpx\nparseGpx =\n    elemsNamed \"gpx\" &gt;&gt;&gt;\n    (getChildren &gt;&gt;&gt; parseTrk) &gt;. Gpx\n</code></pre>\n\n<p>Then you can run it quite simply, although you'll have to still drill passed the root element:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>main :: IO ()\nmain = do\n    gpxs &lt;- runX $ readDocument [withRemoveWS yes] \"ana.gpx\"\n                &gt;&gt;&gt; getChildren\n                &gt;&gt;&gt; parseGpx\n    -- Pretty print the document\n    forM_ gpxs $ \\(Gpx trks) -&gt; do\n        putStrLn \"GPX:\"\n        forM_ trks $ \\(Trk segs) -&gt; do\n            putStrLn \"\\tTRK:\"\n            forM_ segs $ \\(TrkSeg pts) -&gt; do\n                putStrLn \"\\t\\tSEG:\"\n                forM_ pts $ \\pt -&gt; do\n                    putStr \"\\t\\t\\t\"\n                    print pt\n</code></pre>\n\n<p>The trick is to use the methods in the <code>ArrowList</code> typeclass, notably <code>&gt;.</code> which has the type <code>a b c -&gt; ([c] -&gt; d) -&gt; a b d</code>.  It aggregates the elements from the <code>ArrowList</code>, passes it to a function that converts it to a new type, then outputs a new <code>ArrowList</code> on that new type <code>d</code>.</p>\n\n<p>If you want you can even abstract this a bit for the last 3 parsers:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>nestedListParser :: ArrowXml cat =&gt; String -&gt; cat XmlTree a -&gt; ([a] -&gt; b) -&gt; cat XmlTree b\nnestedListParser name subparser constructor\n    =   elemsNamed name\n    &gt;&gt;&gt; (getChildren &gt;&gt;&gt; subparser)\n    &gt;.  constructor\n\nparseTrkSeg :: (ArrowXml cat, ArrowList cat) =&gt; cat XmlTree TrkSeg\nparseTrkSeg = nestedListParser \"trkseg\" (parseTrkPt &gt;&gt;. catMaybes) TrkSeg\n\nparseTrk :: ArrowXml cat =&gt; cat XmlTree Trk\nparseTrk = nestedListParser \"trk\" parseTrkSeg Trk\n\nparseGpx :: ArrowXml cat =&gt; cat XmlTree Gpx\nparseGpx = nestedListParser \"gpx\" parseTrk Gpx\n</code></pre>\n\n<p>This might come in handy if you want to complete the rest of the grammar of a GPX file.</p>\n"}], "owner": {"reputation": 11606, "user_id": 1002430, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/ufy7U.png?s=128&g=1", "display_name": "Ana", "link": "https://stackoverflow.com/users/1002430/ana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 30115082, "answer_count": 1, "score": 3, "last_activity_date": 1431054318, "creation_date": 1431022153, "last_edit_date": 1431053599, "question_id": 30108630, "link": "https://stackoverflow.com/questions/30108630/how-to-wrap-a-the-entire-list-of-matches-from-hxt-with-a-datatype-constructor", "title": "How to wrap a the entire list of matches from HXT with a datatype constructor?", "body": "<p>I'm learning <a href=\"https://hackage.haskell.org/package/hxt\" rel=\"nofollow\"><code>HXT</code></a> at the moment by using it to parse a <a href=\"http://www.topografix.com/gpx.asp\" rel=\"nofollow\">GPX</a> file. An example is <a href=\"https://gist.github.com/anonymous/c5685c18959cae2b37e6\" rel=\"nofollow\">here</a>. I've got the following so far:</p>\n\n<pre><code>import Data.Time\nimport Text.XML.HXT.Core\n\ndata Gpx    = Gpx [Trk]           deriving (Show)\ndata Trk    = Trk [TrkSeg]        deriving (Show)\ndata TrkSeg = TrkSeg [TrkPt]      deriving (Show)\ndata TrkPt  = TrkPt Double Double deriving (Show)\n\nparseGpx =\n  getChildren &gt;&gt;&gt; isElem &gt;&gt;&gt; hasName \"gpx\" &gt;&gt;&gt;\n  getChildren &gt;&gt;&gt; isElem &gt;&gt;&gt; hasName \"trk\" &gt;&gt;&gt;\n  parseGpxTrk &gt;&gt;&gt; arr Gpx\n\nparseGpxTrk = undefined\nparseGpxTrkSegs = undefined\n</code></pre>\n\n<p>You can see that it's incomplete, but it should still type-check. Unfortunately, I'm already running into an error:</p>\n\n<pre><code>Couldn't match type \u2018Trk\u2019 with \u2018[Trk]\u2019\nExpected type: Trk -&gt; Gpx\n  Actual type: [Trk] -&gt; Gpx\nIn the first argument of \u2018arr\u2019, namely \u2018Gpx\u2019\nIn the second argument of \u2018(&gt;&gt;&gt;)\u2019, namely \u2018arr Gpx\u2019\n</code></pre>\n\n<p>What this error says is that I'm trying to pass each matched item from the <code>parseGpxTrk</code> arrow through the <code>arr Gpx</code> constructor, but what I actually want is to pass the entire list of matches through the <code>arr Gpx</code> constructor.</p>\n\n<p>So, how do I get <code>HXT</code> (or arrows in general?) to pass the matches as a <em>list</em> through my <code>arr Gpx</code> constructor instead of passing each entry in the list through the <code>arr Gpx</code> constructor?</p>\n"}, {"tags": ["haskell", "symbols"], "comments": [{"owner": {"reputation": 34889, "user_id": 86604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/329af917389e6cf8e146c03012f5319a?s=128&d=identicon&r=PG", "display_name": "Ingo", "link": "https://stackoverflow.com/users/86604/ingo"}, "edited": false, "score": 0, "creation_date": 1431016609, "post_id": 30106883, "comment_id": 48324971, "body": "Answer from Radio Erewan: In principle yes, but -&gt; is not a function ... it&#39;s a type constructor."}, {"owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "edited": false, "score": 7, "creation_date": 1431016617, "post_id": 30106883, "comment_id": 48324978, "body": "You can use <a href=\"https://www.fpcomplete.com/hoogle\" rel=\"nofollow noreferrer\">hoogle</a> to search for Haskell functions, and it works well for operators.  However, the <code>-&gt;</code> won&#39;t come up because it&#39;s part of Haskell syntax, not an operator (as is <code>=&gt;</code>)."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 4, "creation_date": 1431016633, "post_id": 30106883, "comment_id": 48324991, "body": "use <a href=\"https://www.haskell.org/hoogle/?hoogle=(-%3E)\" rel=\"nofollow noreferrer\">Hoogle</a> or <a href=\"http://hayoo.fh-wedel.de/?query=-%3E\" rel=\"nofollow noreferrer\">Hayoo</a> but not that these are called operators"}], "answers": [{"comments": [{"owner": {"reputation": 7575, "user_id": 663299, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f3a117b27e019d6d19b46698a21c8a11?s=128&d=identicon&r=PG", "display_name": "mhwombat", "link": "https://stackoverflow.com/users/663299/mhwombat"}, "edited": false, "score": 0, "creation_date": 1431020707, "post_id": 30107808, "comment_id": 48327396, "body": "You can also skip the GHCi step of finding the package, by just going directly to <a href=\"https://www.haskell.org/hoogle/?hoogle=%28%3E%3E%3D%29\" rel=\"nofollow noreferrer\">hoogle</a> or <a href=\"http://hayoo.fh-wedel.de/?query=%28%3E%3E%3D%29\" rel=\"nofollow noreferrer\">hayoo</a> and searching for the operator (enclose it in parentheses)."}, {"owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "reply_to_user": {"reputation": 7575, "user_id": 663299, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f3a117b27e019d6d19b46698a21c8a11?s=128&d=identicon&r=PG", "display_name": "mhwombat", "link": "https://stackoverflow.com/users/663299/mhwombat"}, "edited": false, "score": 0, "creation_date": 1431020831, "post_id": 30107808, "comment_id": 48327472, "body": "@mhwombat I mentioned hoogle twice, though hayoo is also a good link that deserves to be mentioned here."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1431023352, "post_id": 30107808, "comment_id": 48328866, "body": "It&#39;s not a bug, it&#39;s a feature!"}, {"owner": {"reputation": 4645, "user_id": 1283954, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d123f9a0a3b56c4fc1b6f03cdc26eb9d?s=128&d=identicon&r=PG", "display_name": "Ilmo Euro", "link": "https://stackoverflow.com/users/1283954/ilmo-euro"}, "edited": false, "score": 1, "creation_date": 1432639893, "post_id": 30107808, "comment_id": 48995188, "body": "For the more general case of symbolic searches, Symbolhound (<a href=\"http://symbolhound.com/\" rel=\"nofollow noreferrer\">symbolhound.com</a>) can help."}], "tags": [], "owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "is_accepted": true, "score": 23, "last_activity_date": 1431020754, "last_edit_date": 1431020754, "creation_date": 1431019186, "answer_id": 30107808, "question_id": 30106883, "link": "https://stackoverflow.com/questions/30106883/function-names-with-symbol-characters-makes-googling-difficult/30107808#30107808", "title": "Function names with symbol characters makes Googling difficult", "body": "<p>Yes, this is a known bug with Google. You might consider a better search engine like <a href=\"https://www.haskell.org/hoogle/\">Hoogle</a>.</p>\n\n<p>In general you need to look up the documentation for the actual function. To do this, you need to know what <em>module</em> it's defined in. The easiest way to determine this is to load up your source file in GHCi (so that you have all of its imports etc.) and then ask for the operator's <code>:info</code> thusly:</p>\n\n<pre><code>Prelude&gt; :info (&gt;&gt;=)\nclass Monad (m :: * -&gt; *) where\n  (&gt;&gt;=) :: m a -&gt; (a -&gt; m b) -&gt; m b\n  ...\n    -- Defined in \u2018GHC.Base\u2019\ninfixl 1 &gt;&gt;=\nPrelude&gt; \n</code></pre>\n\n<p>If the type signature is not enough, then this also tells you that you need to google the <code>GHC.Base</code> module, and the <code>Monad</code> typeclass.  By itself that's pretty googleable, but if that typeclass keyword weren't there, what you would do is to google <code>GHC.Base</code>, the first result leading to <a href=\"https://hackage.haskell.org/package/base\">the <code>base</code> package overview page</a>. Once you are there<sup>1</sup> then you look for a little link labeled [<a href=\"https://hackage.haskell.org/package/base-4.8.0.0/docs/doc-index.html\">Index</a>] beneath the module listing (<code>GHC.Base</code> has a huge module listing so in this case it's easier to miss).</p>\n\n<p>Clicking that link takes you to an index of <em>all the public symbols in that package</em>; you can click the <code>&gt;</code> character to find all operators beginning with a greater than sign. You will then have three links of modules which export that function; click on one and Ctrl-F to find the following documentation:</p>\n\n<pre><code>(&gt;&gt;=) :: forall a b. m a -&gt; (a -&gt; m b) -&gt; m b  | infixl 1 | Source\n    Sequentially compose two actions, passing any value produced by the first \n    as an argument to the second.\n</code></pre>\n\n<p>Again, <a href=\"https://www.haskell.org/hoogle/\">Hoogle</a> does all of this rigamarole for you and has some other nifty features like searching-by-type-signature.</p>\n\n<p>For things like <code>&lt;-</code>, <code>-&gt;</code>, and <code>=&gt;</code> which are <strong>not</strong> functions, you will just have to know the language. The meaning of <code>&lt;-</code> (\"from\") is from \"do-notation\", which you can Google; the meaning of <code>-&gt;</code> (\"to\") varies depending on whether it appears in lambda-notation (like <code>\\a b -&gt; b</code>), case-expressions, or the type signature of a function (where <code>a -&gt; b -&gt; c</code> means \"a function which takes an <code>a</code> and returns a function which takes a <code>b</code> and returns some <code>c</code>\". The meaning of <code>=&gt;</code> is from \"constraints\" or \"type classes\" in Haskell.</p>\n\n<p>Other than <code>-&gt;</code>, you can sometimes see operators appearing in type signatures, too. These should be searchable by the above procedure.</p>\n\n<ol>\n<li>This is assuming a stable API for the package. If the API has changed you will need to look up with <code>ghc -v</code> which package version the file is using, then click on that version. </li>\n</ol>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2879704"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 659, "favorite_count": 0, "accepted_answer_id": 30107808, "answer_count": 1, "score": 11, "last_activity_date": 1432575944, "creation_date": 1431016428, "last_edit_date": 1432575944, "question_id": 30106883, "link": "https://stackoverflow.com/questions/30106883/function-names-with-symbol-characters-makes-googling-difficult", "title": "Function names with symbol characters makes Googling difficult", "body": "<p>In Haskell, many function names contain only symbol characters. Like <code>$$</code>, <code>&gt;&gt;=</code>, <code>&gt;&gt;</code>, <code>:</code>, <code>-&gt;</code>, <code>=&gt;</code>, <code>=~</code>. </p>\n\n<p>Since I am new to Haskell, I am finding it difficult to search their meanings in Google. For example, to understand what <code>-&gt;</code> means in Haskell, I need to use the search string <code>hyphen followed by greater than</code> which is not the best approach, as per me.</p>\n\n<p>Is there a place that I could search for functions with symbols only?</p>\n"}, {"tags": ["haskell", "types", "with-statement", "xmonad"], "comments": [{"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 1, "creation_date": 1431017422, "post_id": 30106827, "comment_id": 48325485, "body": "You&#39;d have to define a new monad and make <code>actionX</code> work on that monad and have <code>withGrabbedButtons</code>/<code>ungrabAllButtons</code> convert the value from one monad to the other... but <code>actionX</code> will <i>not</i> be <code>X()</code> actions."}, {"owner": {"reputation": 487, "user_id": 1732572, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/606b0e170b829d9e94d107d83d082fab?s=128&d=identicon&r=PG", "display_name": "spacingissue", "link": "https://stackoverflow.com/users/1732572/spacingissue"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1431061827, "post_id": 30106827, "comment_id": 48342922, "body": "Thanks; is there a good example of this?"}, {"owner": {"reputation": 1359, "user_id": 3346496, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b1230f0444613f0e8d74e5a71439d1e?s=128&d=identicon&r=PG&f=1", "display_name": "monocell", "link": "https://stackoverflow.com/users/3346496/monocell"}, "edited": false, "score": 0, "creation_date": 1431099251, "post_id": 30106827, "comment_id": 48364972, "body": "The stm monad might be a good example."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1431108996, "post_id": 30106827, "comment_id": 48370673, "body": "You may also want to read &quot;Kleisli Arrows of Outrageous Fortune&quot; for a more flexible approach to resource management."}], "answers": [{"comments": [{"owner": {"reputation": 487, "user_id": 1732572, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/606b0e170b829d9e94d107d83d082fab?s=128&d=identicon&r=PG", "display_name": "spacingissue", "link": "https://stackoverflow.com/users/1732572/spacingissue"}, "edited": false, "score": 0, "creation_date": 1431061397, "post_id": 30108519, "comment_id": 48342787, "body": "That wasn&#39;t quite what I was asking.  I can write the <code>withGrabbedButtons</code> function, though bracket might be better.  What I was asking was how to make it a type error to use the action outside of <code>withGrabbedButtons</code>."}], "tags": [], "owner": {"reputation": 7575, "user_id": 663299, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/f3a117b27e019d6d19b46698a21c8a11?s=128&d=identicon&r=PG", "display_name": "mhwombat", "link": "https://stackoverflow.com/users/663299/mhwombat"}, "is_accepted": false, "score": 0, "last_activity_date": 1431021721, "creation_date": 1431021721, "answer_id": 30108519, "question_id": 30106827, "link": "https://stackoverflow.com/questions/30106827/haskell-xmonad-what-is-the-natural-type-for-expressing-that-something-must-be-d/30108519#30108519", "title": "Haskell/XMonad: What is the natural type for expressing that something must be done after a sequence of actions?", "body": "<p>You might want to create your own version of <a href=\"http://hackage.haskell.org/package/base-4.8.0.0/docs/Control-Exception.html#v:bracket\" rel=\"nofollow\">bracket</a>. Bracket works in the <code>IO</code> monad, but based on a quick peek at the source code, I suspect you could make your own version that runs in the <code>X</code> monad. Bracket will ensure that any finalisation (e.g. ungrabbing all buttons) occurs, even if an exception is raised.</p>\n"}, {"comments": [{"owner": {"reputation": 487, "user_id": 1732572, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/606b0e170b829d9e94d107d83d082fab?s=128&d=identicon&r=PG", "display_name": "spacingissue", "link": "https://stackoverflow.com/users/1732572/spacingissue"}, "edited": false, "score": 0, "creation_date": 1431082877, "post_id": 30119966, "comment_id": 48353933, "body": "In this example, how would I convert an <code>X()</code> action to an <code>XNeedsCleanup()</code> action?"}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "reply_to_user": {"reputation": 487, "user_id": 1732572, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/606b0e170b829d9e94d107d83d082fab?s=128&d=identicon&r=PG", "display_name": "spacingissue", "link": "https://stackoverflow.com/users/1732572/spacingissue"}, "edited": false, "score": 0, "creation_date": 1431091215, "post_id": 30119966, "comment_id": 48359364, "body": "@spacingissue That&#39;s exactly what the <code>FromX</code> constructor does"}, {"owner": {"reputation": 487, "user_id": 1732572, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/606b0e170b829d9e94d107d83d082fab?s=128&d=identicon&r=PG", "display_name": "spacingissue", "link": "https://stackoverflow.com/users/1732572/spacingissue"}, "edited": false, "score": 0, "creation_date": 1431096763, "post_id": 30119966, "comment_id": 48363201, "body": "Oh, I get it.  Thank you!  (For future reference, <code>FromX { toX = action }</code>.)"}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "reply_to_user": {"reputation": 487, "user_id": 1732572, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/606b0e170b829d9e94d107d83d082fab?s=128&d=identicon&r=PG", "display_name": "spacingissue", "link": "https://stackoverflow.com/users/1732572/spacingissue"}, "edited": false, "score": 0, "creation_date": 1431112691, "post_id": 30119966, "comment_id": 48372576, "body": "@spacingissue Or just <code>FromX action</code>. The braces part is just syntactic sugar."}], "tags": [], "owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "is_accepted": true, "score": 1, "last_activity_date": 1431076101, "creation_date": 1431076101, "answer_id": 30119966, "question_id": 30106827, "link": "https://stackoverflow.com/questions/30106827/haskell-xmonad-what-is-the-natural-type-for-expressing-that-something-must-be-d/30119966#30119966", "title": "Haskell/XMonad: What is the natural type for expressing that something must be done after a sequence of actions?", "body": "<p>What you will want to do is make a newtype wrapper for <code>X</code>, using <code>GeneralizedNewtypeDeriving</code> to get a free <code>Monad</code> instance:</p>\n\n<pre><code>{-# LANGUAGE GeneralizedNewtypeDeriving #-}\n\nnewtype XNeedsCleanup a = FromX { toX :: X a }\n  deriving (Functor, Applicative, Monad)\n</code></pre>\n\n<p>Because <code>XNeedsCleanup</code> is a monad, you can bind multiple <code>XNeedsCleanup</code> together, as in your <code>action1 &gt;&gt; action2 &gt;&gt; action3</code> example; this will bind all of their wrapped <code>X</code> actions together inside the <code>FromX</code> wrapper. But you won't be able to bind the resulting action with an <code>X</code> action; that's where your <code>withGrabbedButtons</code> comes in:</p>\n\n<pre><code>withGrabbedButtons :: XNeedsCleanup () -&gt; X ()\nwithGrabbedButtons action = toX action &gt;&gt; ungrabAllButtons\n</code></pre>\n\n<p>If you don't export the <code>toX</code> unwrapper, your clients won't be able to use an <code>XNeedsCleanup</code> value without going through <code>withGrabbedButtons</code>. But if they have the ability to use arbitrary <code>X</code> actions, then presumably they can import whatever you use to define your various actions and could reimplement them as \"raw\" <code>X</code> actions. So just to be explicit: this isn't security-oriented safety, just preventing people from accidentally forgetting the cleanup.</p>\n"}], "owner": {"reputation": 487, "user_id": 1732572, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/606b0e170b829d9e94d107d83d082fab?s=128&d=identicon&r=PG", "display_name": "spacingissue", "link": "https://stackoverflow.com/users/1732572/spacingissue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 30119966, "answer_count": 2, "score": 1, "last_activity_date": 1431076101, "creation_date": 1431016287, "question_id": 30106827, "link": "https://stackoverflow.com/questions/30106827/haskell-xmonad-what-is-the-natural-type-for-expressing-that-something-must-be-d", "title": "Haskell/XMonad: What is the natural type for expressing that something must be done after a sequence of actions?", "body": "<p>I have a sequence of <code>X()</code> actions during which certain buttons might be grabbed (and not released afterwards).  In order to prevent buttons from ending up grabbed, I therefore have to ungrab every button at the end, for example:</p>\n\n<pre><code>action1 &gt;&gt; action2 &gt;&gt; action3 &gt;&gt; ungrabAllButtons\n</code></pre>\n\n<p>I wish to encode this requirement as a type, so that <code>action1</code>, <code>action2</code>, <code>action3</code> can only be used if the buttons are ungrabbed afterwards.  That is, even though <code>action1</code>, <code>action2</code>, are really <code>X()</code> actions, I would like them not to be usable as such unless they are wrapped in something like the following (borrowing Python's <code>with</code> keyword):</p>\n\n<pre><code>withGrabbedButtons :: ??? -&gt; X()\nwithGrabbedButtons action =\n  action &gt;&gt; ungrabAllButtons  \n\n\n-- correct ; complete_action does not leave the mouse grabbed\ncomplete_action :: X()\ncomplete_action = withGrabbedButtons (action1 &gt;&gt; action2 &gt;&gt; action3)\n\n-- type error!\nerroneous_single_action :: X()\nerroneous_single_action = action1\n\n-- type error!\nerroneous_action :: X()\nerroneous_action = action1 &gt;&gt; action2 &gt;&gt; action3\n</code></pre>\n\n<p>This is so that people do not accidentally use <code>action1</code>, <code>action2</code>, <code>action3</code> as <code>X()</code> actions, while forgetting to ungrab the buttons afterwards.</p>\n\n<p>Is this possible with Haskell's type system?  Thanks beforehand. </p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 215, "user_id": 3799790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a91ea8514d913aa6321af53739873c80?s=128&d=identicon&r=PG&f=1", "display_name": "Ken", "link": "https://stackoverflow.com/users/3799790/ken"}, "edited": false, "score": 0, "creation_date": 1431014138, "post_id": 30105781, "comment_id": 48323405, "body": "Wow, that&#39;s interesting. I saw that 7.8.1 change described in the link; needless to say, I&#39;m using a previous version. Thanks!"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 4, "last_activity_date": 1431013241, "creation_date": 1431013241, "answer_id": 30105781, "question_id": 30105691, "link": "https://stackoverflow.com/questions/30105691/why-is-it-that-sometimes-defining-a-value-in-haskell-changes-its-type/30105781#30105781", "title": "Why is it that sometimes defining a value in Haskell changes its type?", "body": "<p>This particular example is defaulted to <code>Integer</code> because of the <a href=\"https://wiki.haskell.org/MonomorphismRestriction\" rel=\"nofollow\">dreaded monomorphism restriction</a>.</p>\n\n<p>BTW this does <strong>not</strong> happen in GHCi, anymore: since ghc-7.8 it uses <code>-XNoMonomorphismRestriction</code> by default.</p>\n"}], "owner": {"reputation": 215, "user_id": 3799790, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a91ea8514d913aa6321af53739873c80?s=128&d=identicon&r=PG&f=1", "display_name": "Ken", "link": "https://stackoverflow.com/users/3799790/ken"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 1, "accepted_answer_id": 30105781, "answer_count": 1, "score": 0, "last_activity_date": 1431013241, "creation_date": 1431012954, "last_edit_date": 1431013092, "question_id": 30105691, "link": "https://stackoverflow.com/questions/30105691/why-is-it-that-sometimes-defining-a-value-in-haskell-changes-its-type", "title": "Why is it that sometimes defining a value in Haskell changes its type?", "body": "<p>Suppose we have</p>\n\n<pre><code>mylist = [1..5]\n</code></pre>\n\n<p>It's clear that</p>\n\n<pre><code>[1..5] :: (Num t, Enum t) =&gt; [t]\n</code></pre>\n\n<p>but why is it that</p>\n\n<pre><code>mylist :: [Integer]\n</code></pre>\n\n<p>instead of </p>\n\n<pre><code>mylist :: (Num t, Enum t) =&gt; [t]\n</code></pre>\n\n<p>in GHCi? (At least as reported by <code>:t</code>)</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 976, "user_id": 1274282, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nBRxs.png?s=128&g=1", "display_name": "Taylor Fausak", "link": "https://stackoverflow.com/users/1274282/taylor-fausak"}, "edited": false, "score": 3, "creation_date": 1431013255, "post_id": 30104802, "comment_id": 48322720, "body": "I think so. At least the major and minor versions of the <code>base</code> package (like 4.8) correspond to a particular version of GHC (like 7.10). Check out this wiki page for some older versions: <a href=\"https://wiki.haskell.org/Base_package#Versions\" rel=\"nofollow noreferrer\">wiki.haskell.org/Base_package#Versions</a>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1431015016, "post_id": 30104802, "comment_id": 48323996, "body": "Maybe you should comment about <i>why</i> you want to do this. E.g., in your context it may be possible to infer the ghc version from something else in a more reliable way."}, {"owner": {"reputation": 7872, "user_id": 440302, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e785baf6d4a2626b8649d5b538c51858?s=128&d=identicon&r=PG", "display_name": "Rufflewind", "link": "https://stackoverflow.com/users/440302/rufflewind"}, "edited": false, "score": 0, "creation_date": 1439592708, "post_id": 30104802, "comment_id": 51941822, "body": "There is an <a href=\"https://ghc.haskell.org/trac/ghc/wiki/Commentary/Libraries/VersionHistory\" rel=\"nofollow noreferrer\">official table of boot library versions (including the base package)</a> on GHC Trac."}], "answers": [{"tags": [], "owner": {"reputation": 1679, "user_id": 1362977, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/4b514db0fe12fa1baa8f099eb11de838?s=128&d=identicon&r=PG", "display_name": "Jan Mat\u011bjka", "link": "https://stackoverflow.com/users/1362977/jan-mat%c4%9bjka"}, "is_accepted": true, "score": 3, "last_activity_date": 1438293051, "creation_date": 1438293051, "answer_id": 31734707, "question_id": 30104802, "link": "https://stackoverflow.com/questions/30104802/how-base-package-version-relates-to-ghc-version/31734707#31734707", "title": "How base package version relates to GHC version?", "body": "<p>Core library version to GHC version is a 1:N relation.</p>\n\n<blockquote>\n  <p>Since base contains some GHC modules,\n  it looks like it may be coupled with certain GHC release.</p>\n</blockquote>\n\n<p><code>base</code> library is a <em>core library</em> defined as library which\n<a href=\"https://wiki.haskell.org/Library_submissions\" rel=\"nofollow\">ships with GHC itself</a>.</p>\n\n<p>The GHC and library versions are maintained independently but the\nshipped library version changes are documented in each\n<a href=\"https://downloads.haskell.org/~ghc/7.10.1/docs/html/users_guide/release-7-10-1.html#idp5879344\" rel=\"nofollow\">GHC release notes</a>.</p>\n\n<p><a href=\"https://wiki.haskell.org/Base_package#Versions\" rel=\"nofollow\">Base package haskell wiki page</a> lists changes to shipped <code>base</code>\nlibrary version and the GHC version where changed.</p>\n\n<blockquote>\n  <p>Suppose that I want to use library that depends on base:4.8.0.0,\n  does it mean it requires certain GHC release and I need to upgrade GHC?</p>\n</blockquote>\n\n<p>Mostly yes. It is not recommended to update core libraries alone though\nit is possible sometimes, ... by some people.</p>\n\n<p>As a side note GHC does not release odd minor <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/version-numbering.html\" rel=\"nofollow\">versions</a>.</p>\n\n<p>Also some libraries are defined by the haskell <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellpa2.html#x20-192000II\" rel=\"nofollow\">reports</a>. However,\nthere doesn't appear any mention of libraries.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1438293623, "creation_date": 1438293623, "answer_id": 31734834, "question_id": 30104802, "link": "https://stackoverflow.com/questions/30104802/how-base-package-version-relates-to-ghc-version/31734834#31734834", "title": "How base package version relates to GHC version?", "body": "<p>Upgrading <code>base</code> by minor version steps might be theoretically possible sometimes. However, there is really no guarantee, and I'm not sure it's ever actually possible. Furthermore, it's hard to imagine why one might want to do so-it's not likely to be faster or easier than upgrading GHC.</p>\n"}], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 622, "favorite_count": 1, "accepted_answer_id": 31734707, "answer_count": 2, "score": 6, "last_activity_date": 1438293623, "creation_date": 1431010738, "last_edit_date": 1431026031, "question_id": 30104802, "link": "https://stackoverflow.com/questions/30104802/how-base-package-version-relates-to-ghc-version", "title": "How base package version relates to GHC version?", "body": "<p>Since <code>base</code> contains some <code>GHC</code> modules, it looks like it may be coupled with certain GHC release. Suppose that I want to use library that depends on <code>base:4.8.0.0</code>, does it mean it requires certain GHC release and I need to upgrade GHC?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1431015277, "post_id": 30104293, "comment_id": 48324164, "body": "As a useful exercise, you can try to expand <code>map (+10) [1,2]</code> with both definitions and observe that the first one is not working, and possibly understand what&#39;s wrong with it."}], "answers": [{"tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": false, "score": 5, "last_activity_date": 1431010040, "creation_date": 1431010040, "answer_id": 30104496, "question_id": 30104293, "link": "https://stackoverflow.com/questions/30104293/haskell-write-map-function-using-foldr/30104496#30104496", "title": "Haskell- write map function using foldr", "body": "<p>The error you posted is not coming from your definition of <code>myMap</code>, it's coming from how you're using it.  The type of the first <code>myMap</code> is <code>([a] -&gt; [a]) -&gt; [a] -&gt; [a]</code>, which does not match the type of <code>Prelude.map</code>.  In the second one you've swapped your variable names and also which one you're applying <code>f</code> to.  The compiler doesn't care what you name the arguments in your lambda being passed to <code>foldr</code>, so <code>foldr (\\x acc -&gt; f x : acc)</code> is identical to <code>foldr (\\foo bar -&gt; f foo : bar)</code>.  That may be what's tripping you up here.</p>\n\n<p>The second one works because (to put it simply) it's correct.  In the first you're applying <code>f</code> to your accumulator list <code>x</code> (even though you have a variable named <code>acc</code> it's not your accumulator), so <code>f</code> must take a list and return a list.  In the second you're applying <code>f</code> to each element, then prepending that to your accumulator list.  If you had <code>myMap (+1)</code>, it would have the type</p>\n\n<pre><code>myMap (+1) :: Num [a] =&gt; [a] -&gt; [a]\n</code></pre>\n\n<p>Which says that you must pass it a list of values <code>[a]</code> where <code>[a]</code> implements <code>Num</code>, and currently there is no instance for <code>Num [a]</code>, nor will there ever be.</p>\n\n<p>TL;DR: In the first one you're applying your mapped function to your accumulator list, in the second one you're applying the mapped function to each element.</p>\n"}, {"tags": [], "owner": {"reputation": 1144, "user_id": 4245823, "user_type": "registered", "accept_rate": 90, "profile_image": "https://lh3.googleusercontent.com/-czWZC6KwKYU/AAAAAAAAAAI/AAAAAAAAAYI/yBtPVyZjU4M/photo.jpg?sz=128", "display_name": "felipez", "link": "https://stackoverflow.com/users/4245823/felipez"}, "is_accepted": true, "score": 5, "last_activity_date": 1431010392, "last_edit_date": 1431010392, "creation_date": 1431010055, "answer_id": 30104504, "question_id": 30104293, "link": "https://stackoverflow.com/questions/30104293/haskell-write-map-function-using-foldr/30104504#30104504", "title": "Haskell- write map function using foldr", "body": "<p>the type of foldr is</p>\n\n<pre><code>foldr :: (a -&gt; b -&gt; b) -&gt; b -&gt; [a] -&gt; b\n</code></pre>\n\n<p>therefore the binary operation that foldr uses to traverse and accumulate the list \nhas type <code>(a -&gt; b -&gt; b)</code>,it first take an element of the list (type <code>a</code>)then the accumulator (type <code>b</code>) resulting in an expression of type b.</p>\n\n<p>So, your first myMap function does not work becuase you are using \"acc\" and \"x\" in reverse order.\nYou want to apply <code>f</code> to x then append it to the acummulator of type <code>b</code> ( a list in this case)</p>\n"}], "owner": {"reputation": 1257, "user_id": 4214719, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4f4851ca5304f2020ce92fa7ec69b48a?s=128&d=identicon&r=PG&f=1", "display_name": "Diana", "link": "https://stackoverflow.com/users/4214719/diana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 469, "favorite_count": 0, "accepted_answer_id": 30104504, "answer_count": 2, "score": 1, "last_activity_date": 1431010392, "creation_date": 1431009518, "question_id": 30104293, "link": "https://stackoverflow.com/questions/30104293/haskell-write-map-function-using-foldr", "title": "Haskell- write map function using foldr", "body": "<p>I am trying to write the map function using foldr. The problem is that when I ran this code :</p>\n\n<pre><code>&gt; myMap f xs = foldr (\\ acc x -&gt; acc :(f x)) [] xs\n</code></pre>\n\n<p>I have the following problem:</p>\n\n<blockquote>\n  <p>No instance for (Num [a0]) arising from a use of 'it'</p>\n</blockquote>\n\n<p>but when I run</p>\n\n<pre><code>myMap f xs = foldr (\\x acc-&gt; (f x):acc) [] xs\n</code></pre>\n\n<p>It works perfectly. Any ideas why?</p>\n"}, {"tags": ["haskell", "gtk", "cabal", "glib"], "answers": [{"tags": [], "owner": {"reputation": 1084, "user_id": 3893319, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/wd9aa.jpg?s=128&g=1", "display_name": "Reygoch", "link": "https://stackoverflow.com/users/3893319/reygoch"}, "is_accepted": false, "score": 1, "last_activity_date": 1462095758, "last_edit_date": 1462095758, "creation_date": 1438039197, "answer_id": 31664947, "question_id": 30102877, "link": "https://stackoverflow.com/questions/30102877/problems-installing-gtk2hs-on-windows/31664947#31664947", "title": "Problems installing gtk2hs on windows", "body": "<p>If you are using 64 bit version of GHC, you want to use 64 bit version of gtk as well.</p>\n\n<p><del>You can download it on this link. Scroll down a bit and download 2.x (not 3.x) all in one bundle, don't download 2.16:\n<a href=\"http://www.gtk.org/download/win64.php\" rel=\"nofollow\">http://www.gtk.org/download/win64.php</a></del></p>\n\n<p>Above is no longer an option. You can try installing MSYS and than using MSYS console with pacman package manager to install gtk dev library on windows (I haven't tried it yet though). This pretty much sucks in my opinion.</p>\n"}], "owner": {"reputation": 63, "user_id": 912849, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/53cc0cedb728b58eced1498735daf6c3?s=128&d=identicon&r=PG", "display_name": "fedepiz", "link": "https://stackoverflow.com/users/912849/fedepiz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 521, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1462095758, "creation_date": 1431006106, "question_id": 30102877, "link": "https://stackoverflow.com/questions/30102877/problems-installing-gtk2hs-on-windows", "title": "Problems installing gtk2hs on windows", "body": "<p>I have decided to try to install gtk2hs on my Windows 8 (64 bit) machine. I am relying on the lastest Haskell Platform distribution.</p>\n\n<p>So, I go on the wiki, and follow the instructions. I get gtk+ 32-bit distribution, version 2.24, in the all in one bundle. I unpack it correclty, set up PATH to point to gtk/bin, and create INCLUDE and LIB variables to point respectively to gtk/include and gtk/lib (this step does not seem necessary, but it can't hurt!)</p>\n\n<p>I then verify all is in order by invoking</p>\n\n<pre><code>pkg-config --modversion gtk+-2.0 \n</code></pre>\n\n<p>and the terminal happly chirps back </p>\n\n<pre><code>2.24.10 \n</code></pre>\n\n<p>Great!</p>\n\n<p>Then, I run cabal install </p>\n\n<pre><code>gtk2hs-buildtools\n</code></pre>\n\n<p>and that also goes well.\nBut then, when I run cabal install gtk, it complains that glib fails to install, because it can't find some C dependencies. I try to isolate the problem by running</p>\n\n<pre><code>cabal install glib\n</code></pre>\n\n<p>and get the following:</p>\n\n<pre><code>C:\\Users\\Federico&gt;cabal install glib\nResolving dependencies...\nConfiguring glib-0.13.1.0...\nFailed to install glib-0.13.1.0\nLast 10 lines of the build log ( C:\\Users\\Federico\\AppData\\Roaming\\cabal\\logs\\gl\nib-0.13.1.0.log ):\n[1 of 2] Compiling Gtk2HsSetup      ( Gtk2HsSetup.hs, dist\\setup-wrapper\\Gtk2HsS\netup.o )\n[2 of 2] Compiling Main             ( SetupMain.hs, dist\\setup-wrapper\\Main.o )\nLinking dist/setup-wrapper\\setup.exe ...\nConfiguring glib-0.13.1.0...\nsetup.exe: Missing dependencies on foreign libraries:\n* Missing C libraries: gobject-2.0, gthread-2.0, glib-2.0, intl\nThis problem can usually be solved by installing the system packages that\nprovide these libraries (you may need the \"-dev\" versions). If the libraries\nare already installed but in a non-standard location then you can use the\nflags --extra-include-dirs= and --extra-lib-dirs= to specify where they are.\ncabal: Error: some packages failed to install:\nglib-0.13.1.0 failed during the configure step. The exception was:\nExitFailure 1\n</code></pre>\n\n<p>But this is utter crap! I KNOW the libraries are there. I can see them, in the gtk/bin folder! I re-check my path, and all is good. They are visible, in path. so is include, and lib. All of it. And yet, cabal complains it can't find them.</p>\n\n<p>But this isn't the scariest bit yet...I download the 64-bit of the library, version 2.16...simply swap the two gtk folders...and now, cabal happly builds the whole thing! Of course, it's unsuable, because ghc on the plaftorm is 32-bit and the libraries are 64-bit, so ghc fails to link against it...but at least cabal was pleased.</p>\n\n<p>I then remove glib, cairo, pango, gtk etc, and go about trying installing again, 2.16, 32-bit. And surely, cabal complains about C dependencies missing.</p>\n\n<p>At this point, befuddled by this kafkian situation, I turn to the wisdom of stack overflow!\nIs cabal trolling me? Are the error messages misleading? Or am I missing something obvious?\nThanks to all for the help!</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 45741, "user_id": 744178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3193139ea494c45e63752504f5ff1f2?s=128&d=identicon&r=PG", "display_name": "jwodder", "link": "https://stackoverflow.com/users/744178/jwodder"}, "is_accepted": true, "score": 3, "last_activity_date": 1431002789, "creation_date": 1431002789, "answer_id": 30101476, "question_id": 30101395, "link": "https://stackoverflow.com/questions/30101395/haskell-read-string-from-keyboard/30101476#30101476", "title": "Haskell - read string from keyboard", "body": "<p>If you're going to insist on writing everything on one line, you'll need to insert a semicolon between consecutive statements in <code>do</code> blocks:</p>\n\n<pre><code>getLine = do x &lt;- getChar; if x=='\\n' then return [] else do xs&lt;-getLine; return (x:xs)\n                         ^ here                                         ^ and here\n</code></pre>\n\n<p>It would be better to just split the whole thing across multiple lines, though:</p>\n\n<pre><code>getLine = do x &lt;- getChar\n             if x=='\\n' then return []\n                        else do xs&lt;-getLine\n                                return (x:xs)\n</code></pre>\n"}], "owner": {"reputation": 1257, "user_id": 4214719, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4f4851ca5304f2020ce92fa7ec69b48a?s=128&d=identicon&r=PG&f=1", "display_name": "Diana", "link": "https://stackoverflow.com/users/4214719/diana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 30101476, "answer_count": 1, "score": 0, "last_activity_date": 1431002789, "creation_date": 1431002531, "question_id": 30101395, "link": "https://stackoverflow.com/questions/30101395/haskell-read-string-from-keyboard", "title": "Haskell - read string from keyboard", "body": "<p>I am trying to read a string from keyboard. This is my code so far:</p>\n\n<pre><code>getLine :: IO String\ngetLine = do x &lt;- getChar if x=='\\n' then return [] else do xs&lt;-getLine return (x:xs)\n</code></pre>\n\n<p>The problem is that I get this error when compiling:</p>\n\n<blockquote>\n  <p>parse error on input 'if'</p>\n</blockquote>\n\n<p>Any ideas what I am doing wrong?</p>\n"}, {"tags": ["list", "haskell", "filter"], "comments": [{"owner": {"reputation": 204954, "user_id": 1903116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w6Ffg.jpg?s=128&g=1", "display_name": "thefourtheye", "link": "https://stackoverflow.com/users/1903116/thefourtheye"}, "edited": false, "score": 0, "creation_date": 1431000259, "post_id": 30100327, "comment_id": 48312411, "body": "Can you give an example of what you are trying to do?"}, {"owner": {"reputation": 1137, "user_id": 1058740, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/99a89a702a48067006ccef4f6d389c4c?s=128&d=identicon&r=PG", "display_name": "James Meade", "link": "https://stackoverflow.com/users/1058740/james-meade"}, "reply_to_user": {"reputation": 204954, "user_id": 1903116, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/w6Ffg.jpg?s=128&g=1", "display_name": "thefourtheye", "link": "https://stackoverflow.com/users/1903116/thefourtheye"}, "edited": false, "score": 0, "creation_date": 1431000550, "post_id": 30100327, "comment_id": 48312612, "body": "@thefourtheye I have updated my question with what I am doing and the full code that I have so far."}, {"owner": {"reputation": 4295, "user_id": 1916893, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/XTlc8.png?s=128&g=1", "display_name": "TobiMcNamobi", "link": "https://stackoverflow.com/users/1916893/tobimcnamobi"}, "edited": false, "score": 0, "creation_date": 1431001869, "post_id": 30100327, "comment_id": 48313575, "body": "What should <code>toWords</code> do? Please give some sample input and output. The way it is now <code>toWords = words</code> by the first line in <code>toWords</code> (the other lines are ignored) which makes no sense because then you could use <code>words</code> instead. BTW it won&#39;t even compile."}, {"owner": {"reputation": 1137, "user_id": 1058740, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/99a89a702a48067006ccef4f6d389c4c?s=128&d=identicon&r=PG", "display_name": "James Meade", "link": "https://stackoverflow.com/users/1058740/james-meade"}, "edited": false, "score": 0, "creation_date": 1431002373, "post_id": 30100327, "comment_id": 48313937, "body": "<code>toWords</code> splits a text file into a list of Strings. So &#39;hello my name is james&#39; would be - [hello, my, name, is, james]."}], "answers": [{"comments": [{"owner": {"reputation": 1137, "user_id": 1058740, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/99a89a702a48067006ccef4f6d389c4c?s=128&d=identicon&r=PG", "display_name": "James Meade", "link": "https://stackoverflow.com/users/1058740/james-meade"}, "edited": false, "score": 0, "creation_date": 1431000692, "post_id": 30100631, "comment_id": 48312715, "body": "Thank you, I have just updated my question with what I am doing and the full code if that is more helpful for understanding what I want to do."}, {"owner": {"reputation": 1134, "user_id": 4819857, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eTogf.jpg?s=128&g=1", "display_name": "Diogo Cunha", "link": "https://stackoverflow.com/users/4819857/diogo-cunha"}, "reply_to_user": {"reputation": 1137, "user_id": 1058740, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/99a89a702a48067006ccef4f6d389c4c?s=128&d=identicon&r=PG", "display_name": "James Meade", "link": "https://stackoverflow.com/users/1058740/james-meade"}, "edited": false, "score": 0, "creation_date": 1431000774, "post_id": 30100631, "comment_id": 48312789, "body": "Can you tell me what that to words is returning ? You shouldn&#39;t be appending to the list ?"}, {"owner": {"reputation": 1137, "user_id": 1058740, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/99a89a702a48067006ccef4f6d389c4c?s=128&d=identicon&r=PG", "display_name": "James Meade", "link": "https://stackoverflow.com/users/1058740/james-meade"}, "edited": false, "score": 0, "creation_date": 1431000831, "post_id": 30100631, "comment_id": 48312822, "body": "It&#39;s returning a list of Strings, so each word of the text from the .txt file in a list."}], "tags": [], "owner": {"reputation": 1134, "user_id": 4819857, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/eTogf.jpg?s=128&g=1", "display_name": "Diogo Cunha", "link": "https://stackoverflow.com/users/4819857/diogo-cunha"}, "is_accepted": false, "score": 0, "last_activity_date": 1431000471, "creation_date": 1431000471, "answer_id": 30100631, "question_id": 30100327, "link": "https://stackoverflow.com/questions/30100327/how-to-filter-strings-from-a-list-in-haskell/30100631#30100631", "title": "How to filter Strings from a list in Haskell", "body": "<p>Filter is what is known in Haskell as a higher-order function. You should read about it, that kind of functions can be very useful.</p>\n\n<p>Maybe what you are looking for is something like this:</p>\n\n<pre><code>toWords s = filter (condition) s \n</code></pre>\n\n<p>That \"condition\" is a function too, that function must contain the filter you want to apply.</p>\n\n<p>A little example would be if you have a lists of numbers and you wanted to take just the numbers >10, it would end up being something like this:</p>\n\n<pre><code>filterNUmbers n = filter (&gt;10) n\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1137, "user_id": 1058740, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/99a89a702a48067006ccef4f6d389c4c?s=128&d=identicon&r=PG", "display_name": "James Meade", "link": "https://stackoverflow.com/users/1058740/james-meade"}, "edited": false, "score": 0, "creation_date": 1431002920, "post_id": 30101417, "comment_id": 48314337, "body": "Thank you, that worked perfectly! The first function worked well and visually makes sense to me."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1431002617, "creation_date": 1431002617, "answer_id": 30101417, "question_id": 30100327, "link": "https://stackoverflow.com/questions/30100327/how-to-filter-strings-from-a-list-in-haskell/30101417#30101417", "title": "How to filter Strings from a list in Haskell", "body": "<p>This will keep each word but for the forbidden ones:</p>\n\n<pre><code>toWords s = filter (\\w -&gt; w `notElem` [\"an\",\"the\",\"for\"]) (words s)\n</code></pre>\n\n<p>Equivalent variants:</p>\n\n<pre><code>-- explicit not\ntoWords s = filter (\\w -&gt; not (w `elem` [\"an\",\"the\",\"for\"])) (words s)\n-- using and (&amp;&amp;) instead of elem\ntoWords s = filter (\\w -&gt; w/=\"an\" &amp;&amp; w/=\"the\" &amp;&amp; w/=\"for\") (words s)\n-- using where to define a custom predicate\ntoWords s = filter predicate (words s)\n     where predicate w = w/=\"an\" &amp;&amp; w/=\"the\" &amp;&amp; w/=\"for\") \n-- pointfree\ntoWords = filter (flip notElem [\"an\",\"the\",\"for\"]) . words\n</code></pre>\n"}], "owner": {"reputation": 1137, "user_id": 1058740, "user_type": "registered", "accept_rate": 39, "profile_image": "https://www.gravatar.com/avatar/99a89a702a48067006ccef4f6d389c4c?s=128&d=identicon&r=PG", "display_name": "James Meade", "link": "https://stackoverflow.com/users/1058740/james-meade"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2143, "favorite_count": 0, "accepted_answer_id": 30101417, "answer_count": 2, "score": 0, "last_activity_date": 1431002617, "creation_date": 1430999670, "last_edit_date": 1431000524, "question_id": 30100327, "link": "https://stackoverflow.com/questions/30100327/how-to-filter-strings-from-a-list-in-haskell", "title": "How to filter Strings from a list in Haskell", "body": "<p>I am trying to create a program that reads a text file and splits the text into a list and then creates a tuple containing each would with how many times it occurs in the text. I then need to be able to remove certain words from the list and print the final list.</p>\n\n<p>I have tried different ways to try and filter Strings from a list of Strings in Haskell with no success. I have found that the <code>filter</code> function is the best for what I want to do, but am not sure how to implement it.</p>\n\n<p>The code that I have so far is that splits up text read from a file into a list of Strings:</p>\n\n<pre><code>toWords :: String -&gt; [String]\ntoWords s = words s\n</code></pre>\n\n<p>I then added this to remove specific Strings from the list:</p>\n\n<pre><code>toWords :: String -&gt; [String]\ntoWords s = words s\ntoWords s = filter (`elem` \"an\")\ntoWords s = filter (`elem` \"the\")\ntoWords s = filter (`elem` \"for\")\n</code></pre>\n\n<p>Which I know is wrong, but am unsure as to how to do it. Please can anyone help me with this.</p>\n\n<p>Here is my full code so far:</p>\n\n<pre><code>main = do  \n       contents &lt;- readFile \"testFile.txt\"\n       let lowContents = map toLower contents\n       let outStr = countWords (lowContents)\n       let finalStr = sortOccurrences (outStr)\n       print outStr\n\n-- Counts all the words.\ncountWords :: String -&gt; [(String, Int)]\ncountWords fileContents = countOccurrences (toWords fileContents)\n\n-- Splits words.\ntoWords :: String -&gt; [String]\ntoWords s = words s\ntoWords s = filter (`elem` \"an\")\ntoWords s = filter (`elem` \"the\")\ntoWords s = filter (`elem` \"for\")\n\n-- Counts, how often each string in the given list appears.\ncountOccurrences :: [String] -&gt; [(String, Int)]\ncountOccurrences xs = map (\\xs -&gt; (head xs, length xs)) . group . sort $ xs\n\n-- Sort list in order of occurrences.\nsortOccurrences :: [(String, Int)] -&gt; [(String, Int)]\nsortOccurrences sort = sortBy comparing snd\n</code></pre>\n"}, {"tags": ["haskell", "parallel-processing", "coding-style", "infix-operator"], "comments": [{"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 0, "creation_date": 1430999738, "post_id": 30099731, "comment_id": 48312015, "body": "I use them only to combine predicates in point-free style like this: <code>p .&amp;&amp;. q = \\x -&gt; p x &amp;&amp; q x</code> and then write my filters in a readable way <code>filter (even .&amp;&amp;. (&lt;10))</code>. I have never seen them used anywhere else, but then I also haven&#39;t seen that much Haskell code."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1431000911, "post_id": 30099731, "comment_id": 48312892, "body": "The comment &quot;These are very handy when writing pipeline parallelism asa sequence of @$@, @$|@ and @$||@&#39;s&quot; seems to agree with your proposed style."}, {"owner": {"reputation": 4530, "user_id": 94687, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/ef249e4381c9d55297cddc4bd5b5c3c2?s=128&d=identicon&r=PG", "display_name": "imz -- Ivan Zakharyaschev", "link": "https://stackoverflow.com/users/94687/imz-ivan-zakharyaschev"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1431002836, "post_id": 30099731, "comment_id": 48314276, "body": "@chi Yes, but having a second <code>$</code> (as in my example) is a bit surprizing for a reader who expects to see some form of function application. The reader must learn that now function application can be written not with a single <code>$</code>, but with <code>$|| strategy</code> inserted in the middle. So, I thought perhaps, there was another clear way to write this down."}, {"owner": {"reputation": 7030, "user_id": 3032349, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3cd8d19756aa9bc73d8045ae988ae728?s=128&d=identicon&r=PG&f=1", "display_name": "ThreeFx", "link": "https://stackoverflow.com/users/3032349/threefx"}, "edited": false, "score": 1, "creation_date": 1431021073, "post_id": 30099731, "comment_id": 48327611, "body": "You can always parenthesise them: <code>(f $|| strategy) expr</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1431043889, "post_id": 30099731, "comment_id": 48338234, "body": "you can introduce an additional operator, equivalent to that <code>$</code>, which would &quot;read&quot; better, in the context (e.g. <code>f ~~&gt; h ||~ g == (f ~~&gt; h) g</code> from <a href=\"https://stackoverflow.com/questions/10843563/conda-condi-conde-condu/10848902#10848902\">here</a>). Give it the appropriately low precedence, maybe 1."}], "answers": [{"comments": [{"owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1431088263, "post_id": 30112198, "comment_id": 48357357, "body": "Thanks @WillNess, fixed!"}], "tags": [], "owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "is_accepted": false, "score": 6, "last_activity_date": 1431088249, "last_edit_date": 1431088249, "creation_date": 1431034984, "answer_id": 30112198, "question_id": 30099731, "link": "https://stackoverflow.com/questions/30099731/real-examples-using-3-arg-infix-operators-in-haskell-like/30112198#30112198", "title": "Real examples using 3-arg infix operators in Haskell? (Like $||.)", "body": "<h1>Precedence and <code>$</code></h1>\n\n<p>So Haskell has a very regular syntax. At the highest priority is parentheses; then comes applying a function to its argument. Function application is left-associative, or, as I prefer to call it, <strong>greedy nom</strong>: meaning that a function \"eats up\" the very first thing that it sees after it as its argument. So, if you write <code>f g h</code> this becomes <code>(f g) h</code>: <code>f</code> eats <code>g</code> first, and the return value eats <code>h</code> afterward. Often, especially when you're defining a function, you want to write something like <code>f (Constructor parameter1 parameter2) = ...</code> where you really need the explicit parentheses so that you're not accidentally writing <code>((f Constructor) parameter1) parameter2</code>. </p>\n\n<p>After parentheses and applications, we have operators: these which have a whole hierarchy of priorities and associativities given by the \"infix directives\". The lowest-priority operator is defined as:</p>\n\n<pre><code>f $ g = f g\ninfixr 0 $\n</code></pre>\n\n<p>This operator is a totally normal operator which seemingly does nothing at all: more precisely it applies the function on its left to the argument on its right. It is low-priority right-associative, so it is \"lazy nom\" (the function before the <code>$</code> is applied to everything after that <code>$</code>). There is an interesting syntax dispute over whether <code>f . g . h $ i</code> is more or less correct than <code>f $ g $ h $ i</code>, which does the same thing in a different way. </p>\n\n<p>Remember that <code>$</code> is actually just an ordinary operator/function. For example you can do things like this:</p>\n\n<pre><code>Prelude&gt; let factorial n = product [1..n]\nPrelude&gt; map ($ 3) [(5 +), (3 *), (3 +) . factorial . (2 *)]\n[8,9,723]\n</code></pre>\n\n<p>Here we are creating a function <code>($ 3)</code> which takes a function as its argument, applying it to 3. We map the resulting function over several other functions. We could also write this as <code>zipWith ($) functions (repeat 3)</code> if you really wanted, passing <code>($)</code> as the combining function that zipWith will use to zip two lists together. They're the same thing, and they're both fun tricks. You might even someday want to <code>map (flip ($))</code> over a list of values, to get a list of values in the form of functions. It's an isomorphism; you can get the values back with <code>id = map ($ id) . map (flip ($))</code>, but maybe that format will be more convenient for you someday. </p>\n\n<p>Lower priority than this are special forms like <code>if</code>, <code>let</code>, <code>case</code>, <code>do</code>, <code>where</code>, and <code>\\</code>. In general Haskell requires that these cannot appear immediately after a value or <code>)</code>, but may appear after a <code>(</code> or an operator. So if you want to write <code>f \\x -&gt; 3 + 2 * x</code> Haskell will complain until you make this into one of the following:</p>\n\n<pre><code>f ((3 +) . (2 *)) -- no special forms\nf (\\x -&gt; 3 + 2 * x) -- parenthesize the sub-expression\nf $ \\x -&gt; 3 + 2 * x -- use $ to make the syntax \"work\" effortlessly.\n</code></pre>\n\n<p>Similarly you might see things like:</p>\n\n<pre><code>main = complicatedProcessingStep . preprocessing $ do\n    input &lt;- io_input\n    ...\n</code></pre>\n\n<p>where the <code>$</code> is being used to avoid putting parentheses around the <code>do</code> so that you don't have to dangle a <code>)</code> token somewhere in the whitespace.</p>\n\n<h1>Functions have one argument</h1>\n\n<p>One huge way that Haskell differs from other languages is that <em>every function has exactly one argument</em>. This is probably going to confuse you at first: aren't operators functions of two arguments, and what about <code>\\a b c -&gt; ...</code>, doesn't it have three?</p>\n\n<p>The answer is no: <code>\\a b c -&gt; ...</code> is syntactic sugar for <code>\\a -&gt; \\b -&gt; \\c -&gt; ...</code> (this is not to mention the fact that you can pattern match on those arguments, too, so secretly <code>\\a -&gt; ...</code> is syntactic sugar for <code>\\random_token -&gt; case random_token of a -&gt; ...</code>). Each function has one argument, but some functions return a function. In Haskell we <em>can</em> do what other languages do, and accept a tuple; <code>\\(a, b) -&gt; a + b</code> works fine, and is equivalent to <code>uncurry (+)</code>. We just usually don't do that -- we usually pass <code>\\a b -&gt; a + b</code>.</p>\n\n<p>You can make an operator out of any function which returns a function. The resulting operator takes its left-hand-side as an argument for the first function and its right-hand-side for an argument to the second. The canonical way to do this is with backticks:</p>\n\n<pre><code>13 `mod` 7 == mod 13 7\n</code></pre>\n\n<p>but if the types are not polymorphic, or if you write an explicit type signature or disable the \"monomorphism restriction\", you can also write things like <code>(%%%) = mod</code>.</p>\n\n<h1>Three-argument operators.</h1>\n\n<p>So there's your answer about \"three-argument operators\": it returns a function which can then be applied to other values. When you write:</p>\n\n<pre><code>a x $|| b y $ c z\n</code></pre>\n\n<p>because of the above rules this parses as:</p>\n\n<pre><code>($) (($||) (a x) (b y)) (c z)\n</code></pre>\n\n<p>which by the definition of <code>($)</code> becomes:</p>\n\n<pre><code>($||) (a x) (b y) (c z)\n</code></pre>\n\n<p>Just using the operator on the sub-expression, <code>ax $|| b y</code>, produces a function, which could either be applied using parentheses, as in <code>(a x $|| b y) (c z)</code>, or with the <code>$</code> operator which applies its left-hand side to its right-hand-side.</p>\n"}], "owner": {"reputation": 4530, "user_id": 94687, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/ef249e4381c9d55297cddc4bd5b5c3c2?s=128&d=identicon&r=PG", "display_name": "imz -- Ivan Zakharyaschev", "link": "https://stackoverflow.com/users/94687/imz-ivan-zakharyaschev"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1130, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1431088249, "creation_date": 1430997962, "question_id": 30099731, "link": "https://stackoverflow.com/questions/30099731/real-examples-using-3-arg-infix-operators-in-haskell-like", "title": "Real examples using 3-arg infix operators in Haskell? (Like $||.)", "body": "<p>I've found <a href=\"http://hackage.haskell.org/package/parallel-3.2.0.6/docs/src/Control-Parallel-Strategies.html#%24|\" rel=\"nofollow\">a bunch of operators like <code>$||</code></a> in <code>parallel</code> package:</p>\n\n<pre><code>-- Strategic function application\n\n{-\nThese are very handy when writing pipeline parallelism asa sequence of\n@$@, @$|@ and @$||@'s. There is no need of naming intermediate values\nin this case. The separation of algorithm from strategy is achieved by\nallowing strategies only as second arguments to @$|@ and @$||@.\n-}\n\n-- | Sequential function application. The argument is evaluated using\n--   the given strategy before it is given to the function.\n($|) :: (a -&gt; b) -&gt; Strategy a -&gt; a -&gt; b\nf $| s  = \\ x -&gt; let z = x `using` s in z `pseq` f z\n\n-- | Parallel function application. The argument is evaluated using\n-- the given strategy, in parallel with the function application.\n($||) :: (a -&gt; b) -&gt; Strategy a -&gt; a -&gt; b\nf $|| s = \\ x -&gt; let z = x `using` s in z `par` f z\n</code></pre>\n\n<p>But they take 3 arguments. I've seen no examples using these operators, so I need to come up with a good style for writing them.</p>\n\n<p>Is the usual style for them like:</p>\n\n<pre><code>f $|| strategy $ expr\n</code></pre>\n\n<p>?</p>\n"}, {"tags": ["haskell", "opengl", "caching", "io", "shader"], "comments": [{"owner": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "edited": false, "score": 0, "creation_date": 1431036215, "post_id": 30099710, "comment_id": 48335791, "body": "This is way past my skill-grade, but you may not need IORefs. If Haskell is not already memoizing those things for you (which it only does occasionally at a very high-level, as far as I know), you can potentially allocate a Data.Array or Data.Map for the entire set of VAOs, if you have an ID for each possible vertex-array-object. Both of these structures are lazy, so when you create the structure it merely has thunks, and you don&#39;t access the elements of the structures until you absolutely need them: thus the array/map does exactly what you&#39;re trying to do with caching."}, {"owner": {"reputation": 678, "user_id": 3241118, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/519fc989bbf1c18ad275b427d3e4fda4?s=128&d=identicon&r=PG&f=1", "display_name": "Gentatsu", "link": "https://stackoverflow.com/users/3241118/gentatsu"}, "reply_to_user": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "edited": false, "score": 0, "creation_date": 1431040931, "post_id": 30099710, "comment_id": 48337385, "body": "Well, I ended up making using a map, but I couldn&#39;t use the VAO ids, since I had nowhere to reference it to each object. I ended up making a <code>IORef (Map (DObject, GLState) Drawable)</code> and modify the map anytime a new pair comes in."}, {"owner": {"reputation": 678, "user_id": 3241118, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/519fc989bbf1c18ad275b427d3e4fda4?s=128&d=identicon&r=PG&f=1", "display_name": "Gentatsu", "link": "https://stackoverflow.com/users/3241118/gentatsu"}, "reply_to_user": {"reputation": 8676, "user_id": 1113881, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sBc0F.jpg?s=128&g=1", "display_name": "CR Drost", "link": "https://stackoverflow.com/users/1113881/cr-drost"}, "edited": false, "score": 0, "creation_date": 1431041068, "post_id": 30099710, "comment_id": 48337421, "body": "It&#39;s not the best approach since DObject and GLState are annoying things to use as keys, but they&#39;re the only discernable things to relate it. It feels like I&#39;m normalising a damn database."}, {"owner": {"reputation": 1593, "user_id": 2287402, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/Q5Rvg.png?s=128&g=1", "display_name": "Elie G&#233;nard", "link": "https://stackoverflow.com/users/2287402/elie-g%c3%a9nard"}, "edited": false, "score": 0, "creation_date": 1436254648, "post_id": 30099710, "comment_id": 50520384, "body": "Hi @Gentatsu, I ran into a similar problem. Did you find an answer?"}, {"owner": {"reputation": 678, "user_id": 3241118, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/519fc989bbf1c18ad275b427d3e4fda4?s=128&d=identicon&r=PG&f=1", "display_name": "Gentatsu", "link": "https://stackoverflow.com/users/3241118/gentatsu"}, "edited": false, "score": 0, "creation_date": 1436346963, "post_id": 30099710, "comment_id": 50568436, "body": "Hey, not a foolproof way that fits everything, but there&#39;s a couple ways of doing it. Like I did before with the unique object that identifies each object for geometry and attributes/uniforms set, or use the VAO. The first one means recording A LOT more data potentially, strict or lazy you might end up having to go through a lot of stuff, but then if you have two objects with the same geom/attr/uniforms, you don&#39;t have duplicates. The second way is to record the VAO ID as an IORef in the object, and check it when you render, if it&#39;s the first time, record it, else just recover that VAO."}, {"owner": {"reputation": 678, "user_id": 3241118, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/519fc989bbf1c18ad275b427d3e4fda4?s=128&d=identicon&r=PG&f=1", "display_name": "Gentatsu", "link": "https://stackoverflow.com/users/3241118/gentatsu"}, "edited": false, "score": 0, "creation_date": 1436347102, "post_id": 30099710, "comment_id": 50568531, "body": "The issue with that, is that if it has all the same info, it&#39;ll treat it as a unique object. Personally, I think the second approach is better, unless you&#39;ve got loooads of objects (idk how many would make it less viable) that are the same, such that switching the VAO is slower than checking if they&#39;re equal. Even then, I&#39;m not sure if it would ever be, as you&#39;d have more objects to check anyway. Hope this helps!"}], "owner": {"reputation": 678, "user_id": 3241118, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/519fc989bbf1c18ad275b427d3e4fda4?s=128&d=identicon&r=PG&f=1", "display_name": "Gentatsu", "link": "https://stackoverflow.com/users/3241118/gentatsu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 142, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1431002823, "creation_date": 1430997873, "last_edit_date": 1431002823, "question_id": 30099710, "link": "https://stackoverflow.com/questions/30099710/caching-a-vertex-array-object-in-haskell-when-rendering", "title": "Caching a vertex array object in Haskell, when rendering", "body": "<p>Ok, the title is terrible, but I'm not sure how else to convey my problem at a glance.</p>\n\n<p>Currently, in my display callback when rendering using OpenGL, a function called <code>render</code> can be called on different types of geometry, which are stored as lists of vertices, normals, and/or texture coordinates (as a single, pair or triple, depending on which one is used). </p>\n\n<p>When I render, I flatten this out to be <code>[GLfloat]</code>, so that I can pass it to a VBO and VAO. I then store the VAO, and render that. Usually, this is done in the initialisation stage, and then transformations and such are applied in the display callback, but if a user wanted to do this in the display callback instead, it flattens the geometry EVERY time, and I set up the VBO, VAO, and attribute variables ever render pass. This is obviously making it super slow if there're any objects (geometry) in the display callback. </p>\n\n<p>What I want to do, is if it is an object, to flatten it, etc to a VAO, and then the next time it is encountered, use the VAO. I've got a constructor which takes the VAO as an argument of the same type, so it can be comfortably replaced. </p>\n\n<p><code>compile</code> does the same as render, except returns a <code>CompiledDrawable</code> which holds the VAO. </p>\n\n<p>I'm looking to use something like:</p>\n\n<pre><code>getObject :: Drawable -&gt; IORef Drawable\ngetObject drawable = unsafePerformIO $ compile drawable  \n</code></pre>\n\n<p>The only problem is, there isn't just one of these, I need to be able to do it for all my objects and have their own references. Any ideas? </p>\n"}, {"tags": ["haskell", "happstack"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4828533"}, "edited": false, "score": 0, "creation_date": 1430990904, "post_id": 30096863, "comment_id": 48305848, "body": "Happstack_Server.hs:29:43:     Couldn&#39;t match type <code>[Char]&#39; with </code>Text.Blaze.Internal.MarkupM ()&#39;     Expected type: [H.Html]       Actual type: [String]     In the second argument of <code>($)&#39;, namely </code>processResponse&#39;     In the second argument of <code>($)&#39;, namely       </code>makeList $ getResponse&#39;     In a stmt of a &#39;do&#39; block: H.toHtml $ makeList $ processResponse"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4828533"}, "edited": false, "score": 0, "creation_date": 1430990948, "post_id": 30096863, "comment_id": 48305896, "body": "getResponse returns a string :("}, {"owner": {"reputation": 1521, "user_id": 365807, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8c9db2824164d60fe55d2b0c1c361f20?s=128&d=identicon&r=PG", "display_name": "Fraser", "link": "https://stackoverflow.com/users/365807/fraser"}, "edited": false, "score": 0, "creation_date": 1430991355, "post_id": 30096863, "comment_id": 48306180, "body": "try <code>makeList xs = ul (mapM (li . H.toHtml) xs)</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user4828533"}, "edited": false, "score": 0, "creation_date": 1431336281, "post_id": 30096863, "comment_id": 48434431, "body": "Hi, sorry for the late reply, using the above code the error message I get                                                                                                                                  Couldn&#39;t match type <code>[()]&#39; with </code>()&#39;                       Expected type: H.Html                       Actual type: Text.Blaze.Internal.MarkupM [()]                       In the return type of a call of <code>mapM&#39;                       In the first argument of </code>H.ul&#39;, namely                       `(mapM (H.li . H.toHtml) xs)&#39;                      In the expression: H.ul (mapM (H.li . H.toHtml) xs)"}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 1, "last_activity_date": 1430990498, "creation_date": 1430990498, "answer_id": 30096863, "question_id": 30096729, "link": "https://stackoverflow.com/questions/30096729/haskell-blaze-html/30096863#30096863", "title": "Haskell Blaze HTML", "body": "<p>I don't know Blaze all that well, but isn't the correct way to do this something more like</p>\n\n<pre><code>makeList xs = ul (mapM_ li xs)\n</code></pre>\n\n<p>That's how this works, isn't it?</p>\n\n<p>(Also, don't use <code>Items</code> as a function name. It needs to start with a lowercase letter.)</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user4828533"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1433418995, "creation_date": 1430990135, "last_edit_date": 1433418995, "question_id": 30096729, "link": "https://stackoverflow.com/questions/30096729/haskell-blaze-html", "title": "Haskell Blaze HTML", "body": "<p>been writing an application that consumes JSON data and then displays it using Happstack. </p>\n\n<pre><code>   helloBlaze :: ServerPart Response\n   helloBlaze =\n   ok $ toResponse $\n   appTemplate \"Hello, Blaze!\"\n            [H.meta ! A.name \"keywords\"\n                    ! A.content \"happstack, blaze, html\"\n            ]\n            (do H.toHtml $ makeList $ getResponse)\n\n   makeList xs = \"&lt;ul&gt;\" ++ (Items xs) ++ \"&lt;/ul&gt;\"\n\n   Items [] = \"\"\n   Items (x:xs) = \"&lt;li&gt;\" ++ x ++ \"&lt;/li&gt;\" ++ (Items xs)\n</code></pre>\n\n<p>The problem is when I run Happstack the response generated is the results but with html tags still showing. Any suggestions would be much appreciated.</p>\n"}, {"tags": ["mysql", "haskell"], "comments": [{"owner": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "edited": false, "score": 2, "creation_date": 1430988926, "post_id": 30096085, "comment_id": 48304470, "body": "What are the types of <code>c</code>, <code>q</code> and <code>v</code> in your code? I&#39;m guessing your  <code>q</code> does <i>not</i> have type <code>Query</code>, as it&#39;s supposed to have. How is <code>q</code> defined?"}, {"owner": {"reputation": 3, "user_id": 4679742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8e1e2299dc199864f4f10a1641191e1?s=128&d=identicon&r=PG&f=1", "display_name": "rne", "link": "https://stackoverflow.com/users/4679742/rne"}, "reply_to_user": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "edited": false, "score": 1, "creation_date": 1430989043, "post_id": 30096085, "comment_id": 48304545, "body": "@gspr <code>c</code> is the Connection, <code>q</code> the Query and <code>v</code> a Tuple of values to replace the <code>?</code>s. In the tuple is the <code>IO String</code>."}, {"owner": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "edited": false, "score": 0, "creation_date": 1430989077, "post_id": 30096085, "comment_id": 48304570, "body": "How is <code>q</code> defined then?"}, {"owner": {"reputation": 3, "user_id": 4679742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8e1e2299dc199864f4f10a1641191e1?s=128&d=identicon&r=PG&f=1", "display_name": "rne", "link": "https://stackoverflow.com/users/4679742/rne"}, "reply_to_user": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "edited": false, "score": 0, "creation_date": 1430989122, "post_id": 30096085, "comment_id": 48304599, "body": "@gspr <code>let q = &quot;&lt;query&gt;&quot; :: Query</code>"}, {"owner": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "edited": false, "score": 1, "creation_date": 1430989153, "post_id": 30096085, "comment_id": 48304622, "body": "Alright, then <code>v</code> is the culprit. How is it defined?"}, {"owner": {"reputation": 3, "user_id": 4679742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8e1e2299dc199864f4f10a1641191e1?s=128&d=identicon&r=PG&f=1", "display_name": "rne", "link": "https://stackoverflow.com/users/4679742/rne"}, "reply_to_user": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "edited": false, "score": 0, "creation_date": 1430989461, "post_id": 30096085, "comment_id": 48304844, "body": "<a href=\"http://hackage.haskell.org/package/mysql-simple-0.2.2.5/docs/Database-MySQL-Simple.html#v:execute\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/mysql-simple-0.2.2.5/docs/&hellip;</a>, in my case <code>(h)</code> where <code>h</code> is of type <code>IO String</code>"}, {"owner": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "edited": false, "score": 2, "creation_date": 1430989564, "post_id": 30096085, "comment_id": 48304926, "body": "Ah, well, obviously, that won&#39;t do. <code>IO String</code> is not an instance of <code>QueryParams</code>. Look for yourself - define <code>v</code> to have one of the types listed as instances of <code>QueryParams</code> in the docs you just linked to."}, {"owner": {"reputation": 3, "user_id": 4679742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8e1e2299dc199864f4f10a1641191e1?s=128&d=identicon&r=PG&f=1", "display_name": "rne", "link": "https://stackoverflow.com/users/4679742/rne"}, "reply_to_user": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "edited": false, "score": 0, "creation_date": 1430989688, "post_id": 30096085, "comment_id": 48304993, "body": "I know, but I don&#39;t know how to do that with an <code>IO String</code>. It&#39;s not listed here: <a href=\"http://hackage.haskell.org/package/mysql-simple-0.2.2.5/docs/Database-MySQL-Simple-Param.html#t:Param\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/mysql-simple-0.2.2.5/docs/&hellip;</a>"}, {"owner": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "edited": false, "score": 1, "creation_date": 1431008655, "post_id": 30096085, "comment_id": 48319034, "body": "Although your question has been answered, I suggest you seriously consider looking into understanding monads. Knowing the difference between <code>IO String</code> and <code>String</code> is essential if you want to program in Haskell."}, {"owner": {"reputation": 3, "user_id": 4679742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8e1e2299dc199864f4f10a1641191e1?s=128&d=identicon&r=PG&f=1", "display_name": "rne", "link": "https://stackoverflow.com/users/4679742/rne"}, "reply_to_user": {"reputation": 10320, "user_id": 453616, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f5c35ad8a6275273c50d1274fd549d84?s=128&d=identicon&r=PG", "display_name": "gspr", "link": "https://stackoverflow.com/users/453616/gspr"}, "edited": false, "score": 0, "creation_date": 1431010793, "post_id": 30096085, "comment_id": 48320772, "body": "@gspr I&#39;ve understood IO but I couldn&#39;t find the error. Thanks for the help!"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 4679742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8e1e2299dc199864f4f10a1641191e1?s=128&d=identicon&r=PG&f=1", "display_name": "rne", "link": "https://stackoverflow.com/users/4679742/rne"}, "edited": false, "score": 0, "creation_date": 1431006639, "post_id": 30097358, "comment_id": 48317417, "body": "Thanks, that was it. By the way, is it possible to execute it inline?  Like <code>num &lt;- execute c q (&lt;- v)</code>?"}, {"owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "reply_to_user": {"reputation": 3, "user_id": 4679742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8e1e2299dc199864f4f10a1641191e1?s=128&d=identicon&r=PG&f=1", "display_name": "rne", "link": "https://stackoverflow.com/users/4679742/rne"}, "edited": false, "score": 0, "creation_date": 1431026882, "post_id": 30097358, "comment_id": 48330827, "body": "The beginner-friendly answer is \u201cno\u201d. You can write <code>v &gt;&gt;= execute c q</code>, though. But as @gspr says: There is some background here worth learning."}], "tags": [], "owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "is_accepted": true, "score": 2, "last_activity_date": 1430991794, "creation_date": 1430991794, "answer_id": 30097358, "question_id": 30096085, "link": "https://stackoverflow.com/questions/30096085/io-string-not-expected-in-mysql-simple-execute/30097358#30097358", "title": "IO String not expected in mysql-simple execute", "body": "<p>If <code>v</code> is an <code>IO String</code>, i.e. an IO action <em>producing</em> a <code>String</code>, and <code>execute</code> expects something of type <code>String</code>, you first have to \u201drun\u201d <code>v</code>. So instead of</p>\n\n<pre><code>num &lt;- execute c q v\n</code></pre>\n\n<p>you have to write</p>\n\n<pre><code>str &lt;- v\nnum &lt;- execute c q str\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 4679742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b8e1e2299dc199864f4f10a1641191e1?s=128&d=identicon&r=PG&f=1", "display_name": "rne", "link": "https://stackoverflow.com/users/4679742/rne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 30097358, "answer_count": 1, "score": 0, "last_activity_date": 1430991794, "creation_date": 1430988362, "last_edit_date": 1430990506, "question_id": 30096085, "link": "https://stackoverflow.com/questions/30096085/io-string-not-expected-in-mysql-simple-execute", "title": "IO String not expected in mysql-simple execute", "body": "<p>I'm using <code>mysql-simple</code> and when I build the program, I get the following error:</p>\n\n<pre><code>No instance for (Database.MySQL.Simple.Param.Param (IO String))\n  arising from a use of \u2018execute\u2019\nIn a stmt of a 'do' block: num &lt;- execute c q v\n</code></pre>\n\n<p>I guess it's the <code>IO String</code> which <code>mysql-simple</code> doesn't want in its parameters.</p>\n\n<p>What is the ideomatic way to handle this?</p>\n\n<p><strong>Edit:</strong> I tested it with <code>\"\"</code> and it worked fine. </p>\n"}, {"tags": ["haskell", "yesod", "classy-prelude"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2879704"}, "edited": false, "score": 0, "creation_date": 1430991892, "post_id": 30095156, "comment_id": 48306559, "body": "I tried changing the type. It gave this error -    Couldn&#39;t match expected type \u2018HandlerT App IO res0\u2019                 with actual type \u2018Value\u2019 . <code>getHome</code> is my HTTP GET handler that returns a json response. How can i wrap the <code>Value</code> type with <code>Handler</code> instead of changing the type?"}], "tags": [], "owner": {"reputation": 339851, "user_id": 149392, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7a561ec0875fcbbe3066ea8fe288ec77?s=128&d=identicon&r=PG", "display_name": "sepp2k", "link": "https://stackoverflow.com/users/149392/sepp2k"}, "is_accepted": true, "score": 2, "last_activity_date": 1430985650, "creation_date": 1430985650, "answer_id": 30095156, "question_id": 30093133, "link": "https://stackoverflow.com/questions/30093133/yeson-json-object-is-applied-to-too-many-arguments/30095156#30095156", "title": "Yeson.json.object is applied to too many arguments", "body": "<blockquote>\n  <p><code>object</code> is not in scope in prelude. Which package/module defines this?</p>\n</blockquote>\n\n<p><a href=\"https://hackage.haskell.org/package/yesod-json-1.1.0/docs/Yesod-Json.html#v:object\" rel=\"nofollow\">Yesod.Json</a></p>\n\n<blockquote>\n  <p>Why doesn't it take the key-value pair in the above case?</p>\n</blockquote>\n\n<p>It takes the key value pair just fine. The error message is telling you that <code>object</code> gives you a <code>Value</code>, but you declared <code>getHome</code> to be of type <code>String -&gt; Handler Value</code>, not <code>Value</code>.</p>\n\n<p>The \"possible cause\" seems to just be misleading in this case.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2879704"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 30095156, "answer_count": 1, "score": 0, "last_activity_date": 1430992004, "creation_date": 1430978842, "last_edit_date": 1430992004, "question_id": 30093133, "link": "https://stackoverflow.com/questions/30093133/yeson-json-object-is-applied-to-too-many-arguments", "title": "Yeson.json.object is applied to too many arguments", "body": "<pre><code>import Yesod\nimport Data.Text\n\ndata App = App\n\ninstance Yesod App\n\nmkYesod \"App\" [parseRoutes|\n               / Home GET\n               |]\n\ngetHome :: String -&gt; Handler Value\ngetHome  =  object [\"name\" .= (\"Adam\"::Text)]\n\nmain = warpDebug 2012 App\n</code></pre>\n\n<p>throws error as,</p>\n\n<pre><code> Couldn't match expected type \u2018String -&gt; Handler Value\u2019\n                with actual type \u2018Value\u2019\n    Possible cause: \u2018object\u2019 is applied to too many arguments\n    In the expression: object [\"name\" .= (\"Adam\" :: Text)]\n    In an equation for \u2018getHome\u2019:\n        getHome = object [\"name\" .= (\"Adam\" :: Text)]\n</code></pre>\n\n<p><code>object</code> is not in scope in prelude. Which package/module defines this? Why doesn't it take the key-value pair in the above case?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 0, "creation_date": 1430969835, "post_id": 30091357, "comment_id": 48295548, "body": "Does &quot;current value&quot; mean each element, or the entire [String]? I actually call sort on f, so I presume in that case that the whole list must live on the heap?"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "reply_to_user": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 0, "creation_date": 1430970107, "post_id": 30091357, "comment_id": 48295615, "body": "@KevinMeredith it depends on how you&#39;re going to use it. If you print it - only one <code>String</code> will be retained. For the <code>sort</code> without doubts it will be the whole <code>[String]</code> kept, since to sort a list you need to operate on the whole list*. * Technically some algorithms might be smarter and only do that in the worst case, but still be <code>O(N)</code> in memory consumption anyway."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "reply_to_user": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "edited": false, "score": 0, "creation_date": 1430970296, "post_id": 30091357, "comment_id": 48295670, "body": "@KevinMeredith as of where it&#39;s allocated - it&#39;s not what I know for sure, but my best guess would be that the list by itself is allocated in the heap and &quot;references&quot; are kept in the stack (as it would be in any other language with automatic memory management)"}], "tags": [], "owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "is_accepted": false, "score": 6, "last_activity_date": 1430968913, "creation_date": 1430968913, "answer_id": 30091357, "question_id": 30091060, "link": "https://stackoverflow.com/questions/30091060/understanding-haskells-map-stack-or-heap/30091357#30091357", "title": "Understanding Haskell&#39;s `map` - Stack or Heap?", "body": "<p>To be precise - when you \"just execute\" <code>f</code> it's not evaluated unless you use its result somehow. And when you do - it's stored according to how it's required to fulfill the caller requirements. </p>\n\n<p>As of this example - it's not stored anywhere: the function is applied to every number, the result is output to your terminal and is discarded. So at a given moment in time you only allocate enough memory to store the current value and the result (which is an approximation, but for the case it's precise enough).</p>\n\n<p>References:</p>\n\n<ul>\n<li><a href=\"https://wiki.haskell.org/Non-strict_semantics\" rel=\"noreferrer\">https://wiki.haskell.org/Non-strict_semantics</a></li>\n<li><a href=\"https://wiki.haskell.org/Lazy_vs._non-strict\" rel=\"noreferrer\">https://wiki.haskell.org/Lazy_vs._non-strict</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 2, "last_activity_date": 1430989918, "creation_date": 1430989918, "answer_id": 30096640, "question_id": 30091060, "link": "https://stackoverflow.com/questions/30091060/understanding-haskells-map-stack-or-heap/30096640#30096640", "title": "Understanding Haskell&#39;s `map` - Stack or Heap?", "body": "<p>First: To split hairs, the following answer applies to GHC. A different Haskell compiler could plausibly implement things differently.</p>\n\n<p>There is indeed a heap and a stack. Almost everything goes on the heap, and hardly anything goes on the stack.</p>\n\n<p>Consider, for example, the expression</p>\n\n<pre><code>let x = foo 17 in ...\n</code></pre>\n\n<p>Let's assume that the optimiser doesn't transform this into something completely different. The call to <code>foo</code> doesn't appear on the stack at all; instead, we create a note on the heap saying that we need to do <code>foo 17</code> at some point, and <code>x</code> becomes a pointer to this note.</p>\n\n<p>So, to answer your question: when you call <code>f</code>, a note that says \"we need to execute <code>map integerToWord [1..999999999]</code> someday\" gets stored on the heap, and you get a pointer to that. What happens next depends on what you <em>do</em> with that result.</p>\n\n<p>If, for example, you try to print the entire thing, then yes, the result of every call to <code>f</code> ends up on the heap. At any given moment, only a single call to <code>f</code> is on the stack.</p>\n\n<p>Alternatively, if you just try to access the 8th element of the result, then a bunch of \"call <code>f 5</code> someday\" notes end up on the heap, plus the result of <code>f 8</code>, plus a note for the rest of the list.</p>\n\n<p>Incidentally, there's a package out there (\"vacuum\"?) which lets you print out the actual object graphs for what you're executing. You might find it interesting.</p>\n"}, {"tags": [], "owner": {"reputation": 28456, "user_id": 1094403, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3770aa7eae5c211921493abd0d2c9f5a?s=128&d=identicon&r=PG", "display_name": "Luis Casillas", "link": "https://stackoverflow.com/users/1094403/luis-casillas"}, "is_accepted": false, "score": 0, "last_activity_date": 1431047388, "last_edit_date": 1431047388, "creation_date": 1431046933, "answer_id": 30114139, "question_id": 30091060, "link": "https://stackoverflow.com/questions/30091060/understanding-haskells-map-stack-or-heap/30114139#30114139", "title": "Understanding Haskell&#39;s `map` - Stack or Heap?", "body": "<p>GHC programs use a stack and a heap... but it doesn't work at all like the eager language stack machines you're familiar with.  Somebody else is gonna have to explain this, because I can't.</p>\n\n<p>The other challenge in answering your question is that GHC uses the following two techniques:</p>\n\n<ol>\n<li>Lazy evaluation</li>\n<li><a href=\"https://downloads.haskell.org/~ghc/7.8.1/docs/html/users_guide/rewrite-rules.html#idp25452160\" rel=\"nofollow\">List fusion</a></li>\n</ol>\n\n<p>Lazy evaluation in Haskell means that (as the default rule) expressions are only evaluated when their value is demanded, and even then they may only be partially evaluated\u2014only far enough as needed to resolve a pattern match that requires the value.  So we can't say what your <code>map</code> example does without knowing what is demanding its value.</p>\n\n<p>List fusion is a set of rewrite rules built into GHC, that recognize a number of situations where the output of a \"good\" list producer is only ever consumed as the input of a \"good\" list consumer.  In these cases, Haskell can fuse the producer and the consumer into an object-code loop without ever allocating list cells.</p>\n\n<p>In your case:</p>\n\n<ol>\n<li><code>[1..999999999]</code> is a good producer</li>\n<li><code>map</code> is both a good consumer and a good producer</li>\n<li>But you seem to be using ghci, which doesn't do fusion.  You need to compile your program with <code>-O</code> for fusion to happen.</li>\n<li>You haven't told us what would be consuming the output of the <code>map</code>.  If it's a good consumer it will fuse with the <code>map</code>.</li>\n</ol>\n\n<p>But there's a good chance that GHC would eliminate most or all of the list cell allocations if you compiled (with <code>-O</code>) a program that just prints the result of that code.  In that case, the list would not exist as a data structure in memory at all\u2014the compiler would generate object code that does something roughly equivalent to this:</p>\n\n<pre><code>for (int i = 1; i &lt;= 999999999; i++) {\n    print(integerToWord(i));\n}\n</code></pre>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1431047388, "creation_date": 1430966655, "question_id": 30091060, "link": "https://stackoverflow.com/questions/30091060/understanding-haskells-map-stack-or-heap", "title": "Understanding Haskell&#39;s `map` - Stack or Heap?", "body": "<p>Given the following function:</p>\n\n<pre><code>f :: [String]\nf = map integerToWord [1..999999999]\n\nintegerToWord :: Integer -&gt; String\n</code></pre>\n\n<p>Let's ignore the implementation. Here's a sample output:</p>\n\n<pre><code>ghci&gt; integerToWord 123999\n\"onehundredtwentythreethousandandninehundredninetynine\"\n</code></pre>\n\n<p>When I execute <code>f</code>, do all results, i.e. <code>f(0) through f(999999999)</code> get stored on the stack or heap?</p>\n\n<p><strong>Note</strong> - I'm assuming that Haskell has a stack and heap.</p>\n\n<p>After running this function for ~1 minute, I don't see the RAM increasing from its original usage.</p>\n"}, {"tags": ["haskell", "recursion", "list-comprehension"], "answers": [{"comments": [{"owner": {"reputation": 505, "user_id": 4612105, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/10205926013086481/picture?type=large", "display_name": "Syzorr", "link": "https://stackoverflow.com/users/4612105/syzorr"}, "edited": false, "score": 0, "creation_date": 1431005389, "post_id": 30091329, "comment_id": 48316336, "body": "Thank you very much for that."}], "tags": [], "owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "is_accepted": true, "score": 5, "last_activity_date": 1430968663, "creation_date": 1430968663, "answer_id": 30091329, "question_id": 30090969, "link": "https://stackoverflow.com/questions/30090969/explicit-recursion-for-determining-if-duplicates-in-haskell/30091329#30091329", "title": "Explicit Recursion for Determining If Duplicates in Haskell", "body": "<p>This is how to do it using explicit recursion:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>duplicated :: Eq a =&gt; a -&gt; [a] -&gt; Bool\nduplicated _ []     = False\nduplicated n (x:xs) = callback n xs\n    where callback  = if x == n then elem else duplicated\n</code></pre>\n\n<p>Here's how it works:</p>\n\n<ol>\n<li>If the list is empty then it means that we haven't found even one element <code>n</code> in the list. Hence, we return <code>False</code>.</li>\n<li>Otherwise, if the current element of the list is <code>n</code> then it means that we found one element <code>n</code>. Hence we return <code>elem n xs</code> which checks whether <code>n</code> is in <code>xs</code> as well.</li>\n<li>Otherwise, we recursively call <code>duplicated n xs</code>.</li>\n</ol>\n\n<p>Hope that helps.</p>\n"}], "owner": {"reputation": 505, "user_id": 4612105, "user_type": "registered", "accept_rate": 70, "profile_image": "https://graph.facebook.com/10205926013086481/picture?type=large", "display_name": "Syzorr", "link": "https://stackoverflow.com/users/4612105/syzorr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 202, "favorite_count": 0, "accepted_answer_id": 30091329, "answer_count": 1, "score": 2, "last_activity_date": 1430968663, "creation_date": 1430966036, "last_edit_date": 1592644375, "question_id": 30090969, "link": "https://stackoverflow.com/questions/30090969/explicit-recursion-for-determining-if-duplicates-in-haskell", "title": "Explicit Recursion for Determining If Duplicates in Haskell", "body": "<p>This is a small part of a tutorial assignment where we have been asked to define a function firstly using a list comprehension and then using explicit recursion.</p>\n<blockquote>\n<ol start=\"3\">\n<li>Using a list comprehension, define a function</li>\n</ol>\n<p>duplicated :: Eq\u00a0a =&gt; a -\u00ad\u2010&gt; [a] -\u00ad\u2010&gt; Bool</p>\n<p>that takes a list element and a list and returns True if there is more than one copy of the list element in the list. For example:</p>\n<p>duplicated 10 [1,2,11,11] = False</p>\n<p>duplicated 10 [1,2,10,11] = False</p>\n<p>duplicated 10 [1,2,10,10] = True</p>\n</blockquote>\n<p>For this I have the code of:</p>\n<pre><code>duplicated::Eq a =&gt; a -&gt; [a] -&gt; Bool\nduplicated n xs = length[x | x &lt;- xs, x == n] &gt; 1\n</code></pre>\n<p>But no matter how I seem to attack this, I can't figure out a way to do this with explicit recursion.</p>\n"}]