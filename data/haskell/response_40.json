[{"tags": ["haskell"], "comments": [{"owner": {"reputation": 27525, "user_id": 924313, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/14d86d9d0a97d8464d59eb42935838ae?s=128&d=identicon&r=PG", "display_name": "corazza", "link": "https://stackoverflow.com/users/924313/corazza"}, "reply_to_user": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 1, "creation_date": 1444924098, "post_id": 33137555, "comment_id": 54115324, "body": "@Bergi Whoops, was writing it in a hurry, added the link"}], "answers": [{"comments": [{"owner": {"reputation": 27525, "user_id": 924313, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/14d86d9d0a97d8464d59eb42935838ae?s=128&d=identicon&r=PG", "display_name": "corazza", "link": "https://stackoverflow.com/users/924313/corazza"}, "edited": false, "score": 0, "creation_date": 1444867375, "post_id": 33137600, "comment_id": 54086690, "body": "Why do you need <code>Ord</code> to figure out how to insert those actions into the resulting set? Wouldn&#39;t you only need <code>Eq</code>, and for example <code>==</code> could always be <code>False</code> for any two <code>IO ()</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 27525, "user_id": 924313, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/14d86d9d0a97d8464d59eb42935838ae?s=128&d=identicon&r=PG", "display_name": "corazza", "link": "https://stackoverflow.com/users/924313/corazza"}, "edited": false, "score": 0, "creation_date": 1444867654, "post_id": 33137600, "comment_id": 54086786, "body": "@jcora, it&#39;s impossible to implement an <i>efficient</i> set using just <code>Eq</code>. And making a dummy instance of <code>Eq</code> for <code>IO</code> would break all the expectations programmers have about what <code>==</code> means."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 2, "creation_date": 1444867985, "post_id": 33137600, "comment_id": 54086866, "body": "Whether you need <code>Eq</code> or <code>Ord</code> misses the point, of course. The point is that you can&#39;t have <i>any</i> typeclass constraints."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1444868271, "post_id": 33137600, "comment_id": 54086932, "body": "@ReinHenrichs, I think it&#39;s useful to point out why any particular constraint on <code>fmap</code> could be harmful."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "reply_to_user": {"reputation": 27525, "user_id": 924313, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/14d86d9d0a97d8464d59eb42935838ae?s=128&d=identicon&r=PG", "display_name": "corazza", "link": "https://stackoverflow.com/users/924313/corazza"}, "edited": false, "score": 1, "creation_date": 1444870690, "post_id": 33137600, "comment_id": 54087484, "body": "@jcora An <code>==</code> that always returns false isn&#39;t a valid equality relation (which requires that a thing is equal to itself). If you did it anyway, it would be useless to use as the basis of a Set, since it implies that when testing membership of an item in a set the item would never be equal to anything in the set, and thus the membership test would always return false. Which means that to stay consistent any such set must be empty; you can&#39;t even retrieve an item from it because any resulting item would fail the membership test and so actually isn&#39;t in the set after all."}, {"owner": {"reputation": 27525, "user_id": 924313, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/14d86d9d0a97d8464d59eb42935838ae?s=128&d=identicon&r=PG", "display_name": "corazza", "link": "https://stackoverflow.com/users/924313/corazza"}, "reply_to_user": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1444924035, "post_id": 33137600, "comment_id": 54115273, "body": "@Ben Yes yes, I know, I literally just wrote that off the top of my head without thinking. Such <code>==</code> would sort of make sense if two variables couldn&#39;t refer to the same <code>IO ()</code> tho, for example each <code>printStrLn</code> result <i>should</i> really be added to the Set as it&#39;s a new action, no matter what gets printed."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 8, "last_activity_date": 1444882594, "last_edit_date": 1444882594, "creation_date": 1444866743, "answer_id": 33137600, "question_id": 33137555, "link": "https://stackoverflow.com/questions/33137555/why-are-foldable-and-functor-separate-classes/33137600#33137600", "title": "Why are Foldable and Functor separate classes?", "body": "<p>Suppose I have <code>xs :: Set Int</code> and I want to map the function <code>putStrLn</code> over it. This will be a problem because <code>IO ()</code> doesn't have an <code>Ord</code> instance, so there's no way to figure out how to insert those actions into the result set. The type of <code>fmap</code> leaves no room for constraints on the type argument to the <code>Functor</code>.</p>\n\n<p><code>IO</code> also provides an example of something that's a <code>Functor</code> but that there isn't any meaningful way to <code>foldMap</code>.</p>\n\n<p>It's worth mentioning that <code>Foldable</code> and <code>Functor</code> come together in the <code>Traversable</code> class, which gives substantially more power than either.</p>\n"}, {"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 5, "last_activity_date": 1444867320, "last_edit_date": 1444867320, "creation_date": 1444866992, "answer_id": 33137635, "question_id": 33137555, "link": "https://stackoverflow.com/questions/33137555/why-are-foldable-and-functor-separate-classes/33137635#33137635", "title": "Why are Foldable and Functor separate classes?", "body": "<p>The <code>Functor</code> typeclass doesn\u2019t let you <code>fmap</code> over things that have constraints on the types of their elements. <code>Set</code> requires <code>Ord</code> and <code>StorableVector</code> requires <code>Storable</code>.</p>\n\n<p>It is possible to express a \u201cconstrained functor\u201d using GHC\u2019s <code>ConstraintKinds</code> extension, something like:</p>\n\n<pre><code>{-# LANGUAGE ConstraintKinds,\n             FunctionalDependencies,\n             MultiParamTypeClasses #-}\n\nimport GHC.Exts (Constraint)\nimport Data.Set (Set)\nimport qualified Data.Set as Set\n\nclass ConstrainedFunctor c f | f -&gt; c where\n  cfmap :: (c a, c b) =&gt; (a -&gt; b) -&gt; f a -&gt; f b\n\ninstance ConstrainedFunctor Ord Set where\n  cfmap = Set.map\n</code></pre>\n\n<p>But this machinery wasn\u2019t around when <code>Functor</code> first appeared.</p>\n\n<p>In addition, <code>Functor</code> is supposed to be \u201cshape-preserving\u201d, but e.g. mapping over a <code>Set</code> may change its size.</p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 7, "last_activity_date": 1444867360, "creation_date": 1444867360, "answer_id": 33137678, "question_id": 33137555, "link": "https://stackoverflow.com/questions/33137555/why-are-foldable-and-functor-separate-classes/33137678#33137678", "title": "Why are Foldable and Functor separate classes?", "body": "<p><code>Set</code> and <code>StorableVector</code> <em>are</em> functors, you can indeed map functions over them.</p>\n\n<p>But not <em>any</em> kind of function. For instance, you can't map <code>(+)</code> over a <code>StorableArray</code> of numbers: this would give an array of functions, and these are not storable.</p>\n\n<p>So, these functors are not (endo-)functors on all of <strong>Hask</strong>, but only on a subcategory including the types of a particular class. This can't be expressed in Haskell98, in fact it has only become possible quite recently with the advent of constraint kinds. <a href=\"https://github.com/leftaroundabout/constrained-categories/blob/master/examples/Set.hs\" rel=\"noreferrer\">See this example</a>:</p>\n\n<pre><code>instance Functor Set Ranking Ranking where\n  fmap = constrainedFmap Set.map\n</code></pre>\n\n<p>Actually, sets also form a monad in <strong>Hask</strong> if you use some clever <a href=\"http://hackage.haskell.org/package/set-monad\" rel=\"noreferrer\">GADT tricks</a>. But this isn't possible for all <code>Foldable</code> containers, hence the standard library doesn't require <code>Functor f =&gt; Foldable f</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": true, "score": 12, "last_activity_date": 1445015028, "last_edit_date": 1495542879, "creation_date": 1444868433, "answer_id": 33137818, "question_id": 33137555, "link": "https://stackoverflow.com/questions/33137555/why-are-foldable-and-functor-separate-classes/33137818#33137818", "title": "Why are Foldable and Functor separate classes?", "body": "<p><strong><code>Foldable</code> and <code>Functor</code> offer two separate abstractions for types with structures that can be <em>folded</em> (or <em>reduced</em>) and <em>mapped over</em>, respectively.</strong></p>\n\n<p>A Foldable holds values that can be enumerated and combined together<sup>1</sup>.  One can think of a Foldable as something that can be turned into a list (<code>toList :: Foldable f =&gt; f a -&gt; [a]</code>). Alternatively, one can think of Foldables as structures whose values can be combined monoidally: <code>(Foldable t, Monoid m) =&gt; (a -&gt; m) -&gt; t a -&gt; m</code> (of course, this requires the ability to enumerate them).</p>\n\n<p>Functors, on the other hand, are structures that allow one to \"lift\" a function <code>(a -&gt; b)</code> to apply to the <code>a</code>s held by the structure (<code>fmap :: (a -&gt; b) -&gt; (f a -&gt; f b)</code>). <code>fmap</code> must preserve the structure being mapped over: a tree must have the same shape before and after, a list must have the same number of elements in the same order, <code>Nothing</code> can't be turned into something, and so on. On the other hand, Foldables do not need to preserve this structure; the whole point is to discard the structure and produce a new one.</p>\n\n<p>The Wiki refers to the fact that there is no way to supply a typeclass constraint to <code>fmap</code>. <code>fmap :: (Ord a, Ord b) =&gt; (a -&gt; b) -&gt; Set a -&gt; Set b</code> does not unify with the type defined by the class, <code>fmap :: (a -&gt; b) -&gt; f a -&gt; f b</code>, which has no constraints. This makes an instance for <code>Set</code> impossible to write.</p>\n\n<p>However, this is just a language implementation issue and not a deeper mathematic statement about sets. The real reason that Foldable does not have a Functor superclass is simply that <a href=\"https://stackoverflow.com/questions/8359115/haskell-an-example-of-a-foldable-which-is-not-a-functor-or-not-traversable\">there are Foldable instances which are not Functor instances</a>.</p>\n\n<hr>\n\n<ol>\n<li>\"Hold\" is a bit loose and is intended to be interpreted in the <a href=\"http://bartoszmilewski.com/2014/01/14/functors-are-containers\" rel=\"nofollow noreferrer\">\"Functors are containers\"</a> sense where <code>Proxy s a</code> holds zero a's, <code>Identity a</code> holds one a, <code>Maybe a</code> holds zero or one a, <code>b -&gt; a</code> holds <code>|b|</code> a's, and so on.</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 169, "user_id": 1325960, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gB5mi.jpg?s=128&g=1", "display_name": "Philip Schwarz", "link": "https://stackoverflow.com/users/1325960/philip-schwarz"}, "is_accepted": false, "score": 0, "last_activity_date": 1552220567, "creation_date": 1552220567, "answer_id": 55087631, "question_id": 33137555, "link": "https://stackoverflow.com/questions/33137555/why-are-foldable-and-functor-separate-classes/55087631#55087631", "title": "Why are Foldable and Functor separate classes?", "body": "<p>Traverse is a  generalisation of map. Traverse can also express foldMap (&amp; so foldLeft/foldRight). So Traverse is both a Functor and a Foldable: </p>\n\n<p><a href=\"https://www.slideshare.net/pjschwarz/sequence-and-traverse-part-3\" rel=\"nofollow noreferrer\">https://www.slideshare.net/pjschwarz/sequence-and-traverse-part-3</a></p>\n"}], "owner": {"reputation": 27525, "user_id": 924313, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/14d86d9d0a97d8464d59eb42935838ae?s=128&d=identicon&r=PG", "display_name": "corazza", "link": "https://stackoverflow.com/users/924313/corazza"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 598, "favorite_count": 1, "accepted_answer_id": 33137818, "answer_count": 5, "score": 11, "last_activity_date": 1552220567, "creation_date": 1444866442, "last_edit_date": 1444924081, "question_id": 33137555, "link": "https://stackoverflow.com/questions/33137555/why-are-foldable-and-functor-separate-classes", "title": "Why are Foldable and Functor separate classes?", "body": "<p>The <a href=\"https://wiki.haskell.org/Foldable_and_Traversable\" rel=\"nofollow\">wiki page</a> says both classes deal with container operations, with Foldable being a class of containers that have <code>foldr</code> defined over them, and for Functor it's <code>fmap</code>.</p>\n\n<p>However, what is the fundamental difference between types that are Foldable and types that are Functors?</p>\n\n<p>The wiki hints at this distinction:</p>\n\n<blockquote>\n  <p>The class [Foldable] does not require Functor superclass in order to allow containers like Set or StorableVector</p>\n</blockquote>\n\n<p>But I'm still not sure why a Set couldn't be mapped over to obtain another set, if I'm interpreting that correctly.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2013, "user_id": 2704853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6658407c0b56fc68b8615c33767c8682?s=128&d=identicon&r=PG&f=1", "display_name": "jev", "link": "https://stackoverflow.com/users/2704853/jev"}, "edited": false, "score": 1, "creation_date": 1444865385, "post_id": 33137340, "comment_id": 54086214, "body": "what have you got so far? perhaps you could pass a function as an argument. have you got haskell installed? it is helpful to play around in ghci."}], "answers": [{"comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 4, "creation_date": 1444868829, "post_id": 33137456, "comment_id": 54087087, "body": "Ah but there <i>is</i> an answer. (I cheated with Lambdabot&#39;s <code>@djinn</code> command.) You missed the next obvious step: &quot;You can use <code>t1</code>&quot;. Once you have that you can start plugging that into the others. Doing that gave me the same answer djinn did: <code>\\a -&gt; a (\\ b -&gt; b (\\ c -&gt; a (\\ _ -&gt; c))) </code>."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 2, "last_activity_date": 1444865815, "creation_date": 1444865815, "answer_id": 33137456, "question_id": 33137340, "link": "https://stackoverflow.com/questions/33137340/term-with-this-type/33137456#33137456", "title": "Term with this type", "body": "<p>Note that in a chain <code>((... -&gt; x) -&gt; y) -&gt; z</code>, you flip back and forth between covariant and contravariant. What this means: you need to define a <code>... -&gt; z</code> function. What you can <em>use</em> in this function is a <code>... -&gt; y</code>. To actually do anything with that function, you must again supply a <code>... -&gt; x</code>.</p>\n\n<p>Applied to your task:</p>\n\n<ul>\n<li>You must define <code>((((t1 -&gt; t2) -&gt; t1) -&gt; t1) -&gt; t2) -&gt; t2</code>.</li>\n<li>You can use <code>(((t1 -&gt; t2) -&gt; t1) -&gt; t1) -&gt; t2</code>.</li>\n<li>You must supply <code>((t1 -&gt; t2) -&gt; t1) -&gt; t1</code></li>\n<li>You can use <code>(t1 -&gt; t2) -&gt; t1</code>.</li>\n<li>You must supply <code>t1 -&gt; t2</code>.</li>\n</ul>\n\n<p>If <code>t1</code> and <code>t2</code> are really unconstrained type variables, this isn't possible, but I suppose the signature you posted is a bit simplified. Perhaps it's obvious how to define the innermost function, and then the rest is easy too.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 3, "last_activity_date": 1444872166, "last_edit_date": 1495540328, "creation_date": 1444872166, "answer_id": 33138290, "question_id": 33137340, "link": "https://stackoverflow.com/questions/33137340/term-with-this-type/33138290#33138290", "title": "Term with this type", "body": "<p>leftaroundabout <a href=\"https://stackoverflow.com/a/33137456/1477667\">explained</a> the general outlines of what you need to do, but as \u00d8rjan Johansen <a href=\"https://stackoverflow.com/questions/33137340/term-with-this-type#comment54087087_33137456\">noted</a> they missed a key idea that comes in at the very end. I figured I'd expand on \u00d8rjan's comment by adding type signatures from leftaroundabout's development.</p>\n\n<pre><code>\\(a :: (((t1 -&gt; t2) -&gt; t1) -&gt; t1) -&gt; t2) -&gt; a $\n  \\(b :: (t1 -&gt; t2) -&gt; t1) -&gt; b $\n    \\(c :: t1) -&gt; a (\\ _ -&gt; c)\n</code></pre>\n\n<p>The magic here is that once we need to produce a <code>t2</code>, we have a <code>t1</code> we can use to provide an argument to <code>a</code> to get that <code>t2</code>.</p>\n"}], "owner": {"reputation": 31, "user_id": 5443800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/383f5e546146a30978c84d3aec747782?s=128&d=identicon&r=PG&f=1", "display_name": "Jack Petterson", "link": "https://stackoverflow.com/users/5443800/jack-petterson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1445016613, "creation_date": 1444865106, "last_edit_date": 1445016613, "question_id": 33137340, "link": "https://stackoverflow.com/questions/33137340/term-with-this-type", "title": "Term with this type", "body": "<p>I would like construct term with type</p>\n\n<p><code>((((t1 -&gt; t2) -&gt; t1) -&gt; t1) -&gt; t2) -&gt; t1</code></p>\n\n<p>But I dont know how start it. I know what I must do if I have something like\n<code>(t1-&gt;t2)-&gt;t1-&gt;t2</code>.\nBut in this situation  I have only one argument!  How can this be solved?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1444843225, "post_id": 33131720, "comment_id": 54074981, "body": "There&#39;s nothing wrong with your code. Maybe you GHCi installation does not work properly? Can you run other programs in GHCi without crashes? E.g. <code>zip [1,2] [3,4]</code> ? In Haskell, unless you&#39;re working with very low-level stuff, there&#39;s no way to cause a segfault. Something looks wrong in your GHCi, therefore."}, {"owner": {"reputation": 85, "user_id": 5446180, "user_type": "registered", "profile_image": "https://graph.facebook.com/1150101628338077/picture?type=large", "display_name": "Sid", "link": "https://stackoverflow.com/users/5446180/sid"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1444843348, "post_id": 33131720, "comment_id": 54075057, "body": "Yes, zip [1,2] [3,4] is ok."}, {"owner": {"reputation": 85, "user_id": 5446180, "user_type": "registered", "profile_image": "https://graph.facebook.com/1150101628338077/picture?type=large", "display_name": "Sid", "link": "https://stackoverflow.com/users/5446180/sid"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1444843440, "post_id": 33131720, "comment_id": 54075106, "body": "It gets seg fault only when defines a type which deriving Show."}, {"owner": {"reputation": 85, "user_id": 5446180, "user_type": "registered", "profile_image": "https://graph.facebook.com/1150101628338077/picture?type=large", "display_name": "Sid", "link": "https://stackoverflow.com/users/5446180/sid"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1444843800, "post_id": 33131720, "comment_id": 54075314, "body": "It works fine on my Mac, but it does not work on my Parallella. I guess something wrong with my Parallella."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1444843888, "post_id": 33131720, "comment_id": 54075353, "body": "I would run a memory test."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1444849532, "post_id": 33131720, "comment_id": 54078672, "body": "For what it&#39;s worth: I will not be voting to close this question. The question is clearly described, and obviously a problem. Is it an unusual problem? Absolutely! Is it actually a problem with Sid&#39;s understanding of Haskell? Nope. But is there a chance this will be helpful to somebody searching for &quot;segmentation fault [haskell]&quot; at some point in the future? I think so. I also don&#39;t think the current front-runner (&quot;a problem that can no longer be reproduced or a simple typographical error&quot;) describes this problem -- presumably it is at least intermittently reproducible, and it&#39;s not a typo."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1444851560, "post_id": 33131720, "comment_id": 54079832, "body": "@DanielWagner, it would be really nice to get a sense of whether this occurs consistently on the Parallella platform! If so, then this is a bug (in something) that needs to be fixed, and the question is useful for future searchers. If not, then it&#39;s a one-off issue with one board, and the question is not useful. I wouldn&#39;t personally vote to close as yet."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 3, "creation_date": 1444852215, "post_id": 33131720, "comment_id": 54080191, "body": "This looks like <a href=\"https://ghc.haskell.org/trac/ghc/ticket/10375\" rel=\"nofollow noreferrer\">ghc.haskell.org/trac/ghc/ticket/10375</a>."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444880673, "post_id": 33139214, "comment_id": 54089912, "body": "Sounds like yet another good reason to actually get a 7.10.3 release."}], "tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": true, "score": 3, "last_activity_date": 1444878892, "creation_date": 1444878892, "answer_id": 33139214, "question_id": 33131720, "link": "https://stackoverflow.com/questions/33131720/segmentation-fault-when-zip-2-self-defined-type-list/33139214#33139214", "title": "Segmentation fault when zip 2 self-defined type list", "body": "<p>Expanding on Reid Barton's comment:</p>\n\n<p>There was <a href=\"https://ghc.haskell.org/trac/ghc/ticket/10375\" rel=\"nofollow\">a serious bug</a> with GHC's support for ARM CPUs, related to ARM having two different instruction set modes (Arm and Thumb).  The GCC-compiled runtime system and LLVM compiled library/user code used different default choices.  GHCi's runtime linker didn't understand those properly, causing crashes when jumping from code written in one mode to code written in the other.</p>\n\n<p>The bug has just been fixed (by essentially forcing Arm mode everywhere), and the fix should be in the upcoming GHC 7.10.3 and 8.0.1 releases.</p>\n"}], "owner": {"reputation": 85, "user_id": 5446180, "user_type": "registered", "profile_image": "https://graph.facebook.com/1150101628338077/picture?type=large", "display_name": "Sid", "link": "https://stackoverflow.com/users/5446180/sid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 33139214, "answer_count": 1, "score": 6, "last_activity_date": 1444878892, "creation_date": 1444843095, "last_edit_date": 1444851602, "question_id": 33131720, "link": "https://stackoverflow.com/questions/33131720/segmentation-fault-when-zip-2-self-defined-type-list", "title": "Segmentation fault when zip 2 self-defined type list", "body": "<p>Under GHCi 7.10.2 on a <a href=\"https://www.parallella.org/\">Parallella</a>, I defined a data type <code>Peg</code> which derives <code>Show</code>. \nI got a segmentation fault when I tried to zip two <code>Peg</code> lists. \nDoes anyone have any clues?</p>\n\n<pre><code>sid@linaro-nano:~CIS192/hw_2$ ghci\nGHCi, version 7.10.2: http://haskell.org/ghc/  :? for help\nPrelude&gt;\nPrelude&gt;\nPrelude&gt; data Peg = Red | Green deriving (Show)\nPrelude&gt; zip [Red, Red] [Green, Green]\n[(Red,Green),(Segmentation fault\n</code></pre>\n"}, {"tags": ["haskell", "vim", "ghc-mod"], "comments": [{"owner": {"reputation": 2838, "user_id": 4959010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2QtsW.png?s=128&g=1", "display_name": "Sato Katsura", "link": "https://stackoverflow.com/users/4959010/sato-katsura"}, "edited": false, "score": 0, "creation_date": 1444849236, "post_id": 33131123, "comment_id": 54078490, "body": "Try this: <code>:help &#39;syntastic_mode_map&#39;</code>."}, {"owner": {"reputation": 16397, "user_id": 303939, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f3f6c98562c6d9bb188eacc2002af257?s=128&d=identicon&r=PG", "display_name": "Ming-Tang", "link": "https://stackoverflow.com/users/303939/ming-tang"}, "reply_to_user": {"reputation": 2838, "user_id": 4959010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2QtsW.png?s=128&g=1", "display_name": "Sato Katsura", "link": "https://stackoverflow.com/users/4959010/sato-katsura"}, "edited": false, "score": 0, "creation_date": 1445101088, "post_id": 33131123, "comment_id": 54184150, "body": "According to the changelog for 5.4.0.0: &quot;ghc-mod(i) executable must now be run in project directory for commands other than <code>root</code>&quot;. Guess the workaround is to install ghc-mod-5.3.0.0 for now. <a href=\"https://hackage.haskell.org/package/ghc-mod-5.4.0.0/changelog\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/ghc-mod-5.4.0.0/changelog</a>"}, {"owner": {"reputation": 2838, "user_id": 4959010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/2QtsW.png?s=128&g=1", "display_name": "Sato Katsura", "link": "https://stackoverflow.com/users/4959010/sato-katsura"}, "edited": false, "score": 0, "creation_date": 1445102666, "post_id": 33131123, "comment_id": 54184670, "body": "No.  The workaround is to stop running syntastic for filetypes you don&#39;t need to check with it."}], "owner": {"reputation": 16397, "user_id": 303939, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f3f6c98562c6d9bb188eacc2002af257?s=128&d=identicon&r=PG", "display_name": "Ming-Tang", "link": "https://stackoverflow.com/users/303939/ming-tang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 165, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1444841157, "creation_date": 1444841157, "question_id": 33131123, "link": "https://stackoverflow.com/questions/33131123/vim-hdevtools-error-message-about-ghc-mod-root", "title": "vim-hdevtools: error message about ghc-mod root", "body": "<p>Recently (after fixing my Haskell setup after upgrading to El Capitan), when I'm editing Haskell files for a moment in Vim, I get the following error:</p>\n\n<pre><code>\"FPRef.hs\" 13L, 316C written\nsyntastic: error: checker output:\nYou must run ghc-mod in the project directory as returned by `ghc-mod root`. Currently in: \"/Users/mingtang/Code/FP15/src/FP15/Evaluator\"but should be in \"/Users/mingtang/Code/FP15\".\nsyntastic: error: checker haskell/ghc_mod returned abnormal status 1\nPress ENTER or type command to continue\n</code></pre>\n\n<p>Googling this error message leads to this GitHub issue: <a href=\"https://github.com/atom-haskell/haskell-ghc-mod/issues/50\" rel=\"nofollow\">https://github.com/atom-haskell/haskell-ghc-mod/issues/50</a></p>\n\n<p>Here is the version of my ghc-mod:</p>\n\n<pre><code>$ ghc-mod --version\nghc-mod version 5.4.0.0 compiled by GHC 7.8.3\n</code></pre>\n\n<p>I have <code>vim-hdevtools</code> installed, and its last commit is in 2012, so I can't ask them for help.</p>\n\n<p>Is there a way to solve this problem?</p>\n"}, {"tags": ["postgresql", "haskell", "haskell-stack"], "answers": [{"comments": [{"owner": {"reputation": 1323, "user_id": 774493, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/ab18110403f01ae3773cf850239806b3?s=128&d=identicon&r=PG", "display_name": "parker.sikand", "link": "https://stackoverflow.com/users/774493/parker-sikand"}, "edited": false, "score": 0, "creation_date": 1444908671, "post_id": 33139983, "comment_id": 54104087, "body": "Thanks for your response. I forgot to mention I had already done that. See updated question. I will look at the build guide to see if there is something else I missed."}, {"owner": {"reputation": 1323, "user_id": 774493, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/ab18110403f01ae3773cf850239806b3?s=128&d=identicon&r=PG", "display_name": "parker.sikand", "link": "https://stackoverflow.com/users/774493/parker-sikand"}, "edited": false, "score": 0, "creation_date": 1444910653, "post_id": 33139983, "comment_id": 54105411, "body": "Using Postgres 9.4 seemed to work. I was trying 8.4 because it matched my remote server. Still investigating."}, {"owner": {"reputation": 1323, "user_id": 774493, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/ab18110403f01ae3773cf850239806b3?s=128&d=identicon&r=PG", "display_name": "parker.sikand", "link": "https://stackoverflow.com/users/774493/parker-sikand"}, "edited": false, "score": 0, "creation_date": 1445580279, "post_id": 33139983, "comment_id": 54390860, "body": "Using Postgres 9.4 as my &#39;client&#39; has made my haskell code work fine, even when communicating with a remote Postgres 8.4 database. It seems that the version requirements for the Postgres client libraries are undocumented. For me, everything is good now. Thank you for your attention Michael."}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": false, "score": 1, "last_activity_date": 1444883757, "creation_date": 1444883757, "answer_id": 33139983, "question_id": 33130252, "link": "https://stackoverflow.com/questions/33130252/stack-cannot-find-libpq-when-given-directory/33139983#33139983", "title": "Stack cannot find libpq when given directory", "body": "<p>I know that the Snowdrift project uses PostgreSQL and builds with Stack on Windows. They have <a href=\"https://github.com/snowdriftcoop/snowdrift/blob/master/BUILD.md#windows\" rel=\"nofollow\">a build guide</a> on their site. It looks like one difference is that they mention:</p>\n\n<blockquote>\n  <p>Add the PostgreSQL bin directory to the path <code>C:\\Program Files (x86)\\PostgreSQL\\9.4\\bin</code></p>\n</blockquote>\n\n<p>Can you try adding that to the PATH and see if that fixes it?</p>\n"}, {"tags": [], "owner": {"reputation": 1323, "user_id": 774493, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/ab18110403f01ae3773cf850239806b3?s=128&d=identicon&r=PG", "display_name": "parker.sikand", "link": "https://stackoverflow.com/users/774493/parker-sikand"}, "is_accepted": false, "score": 1, "last_activity_date": 1445579816, "creation_date": 1445579816, "answer_id": 33295713, "question_id": 33130252, "link": "https://stackoverflow.com/questions/33130252/stack-cannot-find-libpq-when-given-directory/33295713#33295713", "title": "Stack cannot find libpq when given directory", "body": "<p>There was some kind of version mismatch.</p>\n\n<p>Installing Postgres 9.4 instead of 8.4 allowed the <code>postgresql-simple</code> package to be built in the manner I was attempting.</p>\n\n<p>My stack project, without intervention by me, defaulted to using <code>resolver: 'lts-3.7'</code> This provided version <code>0.4.10.0</code> of the <code>postgresql-simple</code> package to my project. I wish I had a more detailed answer, but all I can tell is that this version of <code>postgresql-simple</code> (which is fairly recent) works fine with PostgreSQL 9.4 (which is also recent).</p>\n\n<p>And thankfully, using haskell and <code>postgresql-simple</code> built against Postgres 9.4 libraries is having no issue communicating with my 'remote' (virtualbox) database which is Postgres 8.4. </p>\n\n<p>I'm tempted to flag my question as not constructive unless others find this useful info.</p>\n"}], "owner": {"reputation": 1323, "user_id": 774493, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/ab18110403f01ae3773cf850239806b3?s=128&d=identicon&r=PG", "display_name": "parker.sikand", "link": "https://stackoverflow.com/users/774493/parker-sikand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1028, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1445579816, "creation_date": 1444838626, "last_edit_date": 1444909003, "question_id": 33130252, "link": "https://stackoverflow.com/questions/33130252/stack-cannot-find-libpq-when-given-directory", "title": "Stack cannot find libpq when given directory", "body": "<p>I am trying to set up a stack project that uses the <code>postgresql-simple</code> package among others. When trying to <code>stack build</code>, all of the dependencies for <code>postgresql-simple</code> installed without issue, but stack is having trouble installing <code>postgresql-simple</code> itself. I get the following error:</p>\n\n<pre><code>C:project&gt; stack build --extra-include-dirs=\"C:\\PostgreSQL\\8.4\\include\" --extra-lib-dirs=\"C:\\PostgreSQL\\8.4\\lib\"\n\n... omitted ...\n\n*****************\n--extra-include-dirs=C:\\PostgreSQL\\8.4\\include\n*****************\n--extra-include-dirs=C:\\Users\\User\\AppData\\Local\\Programs\\stack\\x86_64-windows\\msys2-20150512\\mingw32\\include \n--extra-include-dirs=C:\\Users\\User\\AppData\\Local\\Programs\\stack\\x86_64-windows\\msys2-20150512\\mingw64\\include \n*****************\n--extra-lib-dirs=C:\\PostgreSQL\\8.4\\lib\n***************************** \n--extra-lib-dirs=C:\\Users\\User\\AppData\\Local\\Programs\\stack\\x86_64-windows\\msys2-20150512\\mingw32\\lib \n--extra-lib-dirs=C:\\Users\\User\\AppData\\Local\\Programs\\stack\\x86_64-windows\\msys2-20150512\\mingw64\\lib\nProcess exited with code: ExitFailure 1\nLogs have been written to: C:\\Users\\User\\Desktop\\draftkings\\NFAccuracy\\.stack-work\\logs\\postgresql-libpq-0.9.1.1.log\n\nConfiguring postgresql-libpq-0.9.1.1...\nSetup.hs: Missing dependency on a foreign library:\n* Missing C library: pq\nThis problem can usually be solved by installing the system package that\nprovides this library (you may need the \"-dev\" version). If the library is\nalready installed but in a non-standard location then you can use the flags\n--extra-include-dirs= and --extra-lib-dirs= to specify where it is.\n</code></pre>\n\n<p>I've tried also specifying the paths in my <code>stack.yaml</code> file, same error.</p>\n\n<p>I've tried manually copying the library and include files from my postgres installation to the mentioned <code>...\\mingw64\\lib</code> and <code>...\\mingw64\\include</code> folders. Same error.</p>\n\n<p>I have the files <code>libpq.dll</code> and <code>libpq.lib</code> in my <code>C:\\PostgreSQL\\8.4\\lib</code> folder.</p>\n\n<p>I feel like I'm missing something obvious but I can't get this to work and I'm not sure what I'm doing wrong. Any help is appreciated.</p>\n\n<p><strong>Update</strong></p>\n\n<p>I forgot to mention two important details.</p>\n\n<p>First, I have added <code>C:\\PostgreSQL\\8.4\\bin</code> to my PATH. As far as I know, this works as expected, because I got past an error about <code>pg_config</code> missing, to the error I currently have.</p>\n\n<p>Second, I also tried adding the <code>lib</code> and <code>include</code> directories to my PATH, but this did not change the error.</p>\n\n<p>I should also mention my Postgres installation works fine on its own.</p>\n"}, {"tags": ["haskell", "error-handling", "interpreter", "either"], "answers": [{"comments": [{"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 0, "creation_date": 1444850845, "post_id": 33133614, "comment_id": 54079423, "body": "I have modified the question, hope it clarifies my intentions."}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 1, "last_activity_date": 1457842024, "last_edit_date": 1457842024, "creation_date": 1444849633, "answer_id": 33133614, "question_id": 33129941, "link": "https://stackoverflow.com/questions/33129941/is-it-possible-to-recover-from-an-erroneous-eval-in-hint/33133614#33133614", "title": "Is it possible to recover from an erroneous eval in hint?", "body": "<p>You didn't show any code so I don't know the problem.  The most straight-forward way I use hint handles errors fine:</p>\n\n<pre><code>import Language.Haskell.Interpreter\nlet doEval s = runInterpreter $ setImports [\"Prelude\"] &gt;&gt; eval s\n</code></pre>\n\n<p>has resulted in fine output for me...</p>\n\n<pre><code>Prelude Language.Haskell.Interpreter&gt; doEval \"1 + 2\"\nRight \"3\"\nPrelude Language.Haskell.Interpreter&gt; doEval \"1 + 'c'\"\n</code></pre>\n\n<p><strike></p>\n\n<pre><code>ghc: panic! (the 'impossible' happened)\n  (GHC version 7.10.2 for x86_64-apple-darwin):\n        nameModule doEval_a43r\n</code></pre>\n\n<p>... Except that now the impossible happens... that's a bug.  Notice you are supposed to get <code>Left someError</code> in cases like these:</p>\n\n<pre><code>data InterpreterError\n  = UnknownError String\n  | WontCompile [GhcError]\n  | NotAllowed String\n  | GhcException String\n        -- Defined in \u2018hint-0.4.2.3:Hint.Base\u2019\n</code></pre>\n\n<p>Have you looked through the ghchq bug list and/or submitted an issue?\n</strike></p>\n\n<p>EDIT:</p>\n\n<p>And the correct functionality is back, at least as of GHC 7.10.3 x64 on OS X with hint version 0.4.2.3.  In other words, it appears the bug went away from 7.10.2 to 7.10.3</p>\n\n<p>The output is:</p>\n\n<blockquote>\n  <p>Left (WontCompile [GhcError {errMsg = \":3:3:\\n    No instance for (Num Char) arising from a use of \\8216+\\8217\\n    In the expression: 1 + 'c'\\n    In an equation for \\8216e_11\\8217: e_11 = 1 + 'c'\\n    In the first argument of \\8216show_M439719814875238119360034\\8217, namely\\n      \\8216(let e_11 = 1 + 'c' in e_11)\\8217\"}])</p>\n</blockquote>\n\n<p>Though executing the <code>doEval</code> line <em>twice in GHCi does cause a panic</em>, things seem to work once in the interpreter and properly regardless when compiled.</p>\n"}], "owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1457842024, "creation_date": 1444837715, "last_edit_date": 1444851117, "question_id": 33129941, "link": "https://stackoverflow.com/questions/33129941/is-it-possible-to-recover-from-an-erroneous-eval-in-hint", "title": "Is it possible to recover from an erroneous eval in hint?", "body": "<p>I am trying to use <code>hint</code> package from <code>hackage</code> to create a simple environment where user can issue lines of code for evaluation (like in ghci). I expect some of the input lines to be erroneous (<code>eval</code> would end the session with an error). How can I create a robust session that ignores erroneous input (or better: it reports an error but can accept other input) and keeps the previously consistent state?</p>\n\n<p>Also, I would like to use it in <code>do</code> style, i.e. <code>let a = 3</code> as standalone input line makes sense.</p>\n\n<hr>\n\n<p>To clarify things: I have no problem with a single <code>eval</code>. What I would like to do, is allow continuing evaluation even after some step failed. Also I would like to incrementally extend a monadic chain (as you do in <code>ghci</code> I guess).</p>\n\n<p>In other words: I want something like this, except that I get to evaluate <code>3</code> and don't stop at <code>undefined</code> with the error.</p>\n\n<pre><code>runInterpreter $ setImports [ \"Prelude\" ] &gt;&gt; eval \"undefined\" &gt;&gt; eval \"3\"\n</code></pre>\n\n<p>More specifically I would like something like this to be possible:</p>\n\n<pre><code>runInterpreter $ setImports ... &gt;&gt; eval' \"let a = (1, 2)\" -- modifying context\n                                &gt;&gt; typeOf \"b\" -- error but not breaking the chain\n                                &gt;&gt; typeOf \"a\" -- (Num a, Num b) =&gt; (a, b)\n</code></pre>\n\n<p>I don't expect it to work this straightforwardly, this is just to show the idea. I basically would like to build up some context (as you do in ghci) and every addition to the context would modify it only if there is no failure, failures could be logged or explicitly retrieved after each attempt to modify the context.</p>\n"}, {"tags": ["haskell", "netwire"], "answers": [{"comments": [{"owner": {"reputation": 639, "user_id": 2786866, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/83d20464b8b297e4b289187bbfbd62c7?s=128&d=identicon&r=PG", "display_name": "crosser", "link": "https://stackoverflow.com/users/2786866/crosser"}, "edited": false, "score": 0, "creation_date": 1450301655, "post_id": 34253888, "comment_id": 56386770, "body": "It works for combining outputs of the existing set and a new wire. But on the next step I will obviously want to <i>remove</i> the wires from the set (using e.g. a map for representation). I can remove unwanted outputs the same way as you suggest, but won&#39;t that lead to memory leak?"}, {"owner": {"reputation": 639, "user_id": 2786866, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/83d20464b8b297e4b289187bbfbd62c7?s=128&d=identicon&r=PG", "display_name": "crosser", "link": "https://stackoverflow.com/users/2786866/crosser"}, "edited": false, "score": 0, "creation_date": 1450337309, "post_id": 34253888, "comment_id": 56399218, "body": "Commenting on own comment, perhaps using a lazy map would alleviate the memory leak problem? Would it?"}, {"owner": {"reputation": 2567, "user_id": 994206, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/699bacad8f85a069dda312cc29e03baa?s=128&d=identicon&r=PG", "display_name": "Mokosha", "link": "https://stackoverflow.com/users/994206/mokosha"}, "edited": false, "score": 1, "creation_date": 1451547659, "post_id": 34253888, "comment_id": 56827584, "body": "You can make <code>w &amp;&amp;&amp; ws</code> respond to an event that switches back to <code>ws</code> when you want to remove <code>w</code>."}], "tags": [], "owner": {"reputation": 116, "user_id": 3508648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f8fddda52c868d152a1d76914355589?s=128&d=identicon&r=PG&f=1", "display_name": "Mart&#237;nV", "link": "https://stackoverflow.com/users/3508648/mart%c3%adnv"}, "is_accepted": true, "score": 2, "last_activity_date": 1450026904, "creation_date": 1450026904, "answer_id": 34253888, "question_id": 33129623, "link": "https://stackoverflow.com/questions/33129623/haskell-netwire-wires-of-wires-done-properly/34253888#34253888", "title": "Haskell Netwire: wires of wires done properly", "body": "<p>I was using Netwire and I encountered the exact same problem, so I think it will be useful to answer this. I agree that using (safe) Events is the right way to go. However I don't like adding the <code>WCarry</code>, it doesn't seem very intuitive.</p>\n\n<p>You were actually extremely close to the answer. The key to make <code>addWire</code> relies in that you don't want to 'modify' the old wire. What you want is create a new wire with the given subwire's output added, so this may be what you were looking for:</p>\n\n<pre><code>addWire w ws = fmap (uncurry (:)) (w &amp;&amp;&amp; ws)\n</code></pre>\n\n<p>This wire feeds both wires and then joins the outputs. Hope it helps!</p>\n"}], "owner": {"reputation": 639, "user_id": 2786866, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/83d20464b8b297e4b289187bbfbd62c7?s=128&d=identicon&r=PG", "display_name": "crosser", "link": "https://stackoverflow.com/users/2786866/crosser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 1, "accepted_answer_id": 34253888, "answer_count": 1, "score": 4, "last_activity_date": 1450026904, "creation_date": 1444836811, "last_edit_date": 1495540324, "question_id": 33129623, "link": "https://stackoverflow.com/questions/33129623/haskell-netwire-wires-of-wires-done-properly", "title": "Haskell Netwire: wires of wires done properly", "body": "<p>I am trying to implement a dynamic set of wires in netwire 5 \"properly\".\nI've read the answer to <a href=\"https://stackoverflow.com/questions/28918915/haskell-netwire-wires-of-wires\">wires of wires</a> question, and I don't particularly like how the code in the example relies on the <code>Event</code> converted to a behaviour to show up non-empty on <em>exactly one execution</em> of <code>stepWire</code>.</p>\n\n<p>So, I want to add and remove wires in the dynamic set via <code>Event</code>s, and hopefully without tapping into <code>Unsafe.Event</code> or equivalent hackery. Let's drop the removing part for simplicity, and just make it possible to add <code>Wire</code>s:</p>\n\n<pre><code>dynWireSet1 :: (Monad m, Monoid s)\n            =&gt; Wire s e m (a, Event (Wire s e m a b)) [b]\n</code></pre>\n\n<p>Each event adds a new wire to the (initially empty) list (or other set) of wires hidden inside, and they all run, all getting the input of type <code>a</code>, and have their outputs collected into a list.</p>\n\n<p>The running part is relatively easy, with googleable examples, e.g.:</p>\n\n<pre><code>dynWireSet1 = runWires1 []\nrunWires1 :: (Monad m, Monoid s)\n          =&gt; [Wire s e m a b]\n          -&gt; Wire s e m (a, Event (Wire s e m a b)) [b]\nrunWires1 wires = mkGen $ \\session (input, event) -&gt; do\n  stepped &lt;- mapM (\\w -&gt; stepWire w session (Right input)) wires\n  let (outputs, newwires) = unzip stepped\n  return (sequence outputs, runWires1 newwires)\n</code></pre>\n\n<p>Example above ignores events. I suspect that it is impossible\nto use the event inside the transition function, other than by\nthe <code>event</code> function from <code>Unsafe.Event</code>. Is that correct? I\nwant to avoid <code>Unsafe.Event</code>.</p>\n\n<p>When I step back and look at the <em>suggested</em> ways of using events, I see a\nfunction that looks very promising:</p>\n\n<pre><code>krSwitch :: Monad m\n         =&gt; Wire s e m a b\n         -&gt; Wire s e m (a, Event (Wire s e m a b -&gt; Wire s e m a b)) b\n</code></pre>\n\n<p>Now, what if I start with simplified runWires:</p>\n\n<pre><code>runWires2 :: (Monad m, Monoid s)\n          =&gt; [Wire s e m a b]\n          -&gt; Wire s e m a [b]\nrunWires2 wires = mkGen $ \\session input -&gt; do\n  stepped &lt;- mapM (\\w -&gt; stepWire w session (Right input)) wires\n  let (outputs, newwires) = unzip stepped\n  return (sequence outputs, runWires2 newwires)\n</code></pre>\n\n<p>and make dynWireSet a krSwitch:</p>\n\n<pre><code>dynWireSet2 :: (Monad m, Monoid s)\n            =&gt; Wire s e m (a, Event (Wire s e m a b)) [b]\ndynWireSet2 = krSwitch (runWires2 []) . second (mkSF_ (fmap addWire))\naddWire :: Wire s e m a b -&gt; Wire s e m a [b] -&gt; Wire s e m a [b]\naddWire = undefined\n</code></pre>\n\n<p>I am almost there! Now if I only could <code>fmap</code> a <code>(:)</code> over <code>runWires2</code> and get the new wire inserted into <code>newwires</code>, I'd be all set! But this is not possible, in general case. In fact, <code>fmap</code> over <code>WGen</code> just <code>fmaps</code> over the output, if I get it right. Useless.</p>\n\n<p>And now, here is my idea. Let's introduce a new variant of <code>data Wire</code>, I'll provisionally call it <code>WCarry g st</code> because it will carry its internal state in a distinct data type. It's transition function will be of the type</p>\n\n<pre><code>((a, c) -&gt; m (b, c))\n</code></pre>\n\n<p>and, given the initial state, the constructor will produce a Wire like this:</p>\n\n<pre><code>mkCarry :: Monad m =&gt; ((a, c) -&gt; m (b, c)) -&gt; c -&gt; Wire s e m a b\nmkCarry transfun state = mkGenN $ \\input -&gt; do\n  (output, newstate) &lt;- transfun (input, state)\n  return (Right output, mkCarry transfun newstate)\n</code></pre>\n\n<p>only introducing <code>WCarry</code> type instead of <code>WGen</code> type into the resulting wire. It is easy to reformulate <code>runWires</code> in terms of <code>mkCarry</code>.</p>\n\n<p>Then, fmap instance would look something like this:</p>\n\n<pre><code>fmap f (WCarry g st) = WCarry g (fmap f st)\n</code></pre>\n\n<p>It will change the \"hidden inside\" state object, and we'll be able to use <code>krSwitch</code> function meaningfully on this sort of <code>Wire</code>s, to tweak their internal state without losing the previous value.</p>\n\n<p>Does this make sense? If what I am trying to do is possible in a simpler way, please advice! If what I am talking about makes sense, how could I go about it? Is is possible to locally extend the <code>data Wire</code> definition with WCarry, and extend add the interesting Class instances with corresponding definitions? Any other advice?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["haskell", "deployment", "web-deployment", "yesod", "keter"], "answers": [{"tags": [], "owner": {"reputation": 117, "user_id": 125305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8a549383bcb4a47a409c3d5fbc06b0f?s=128&d=identicon&r=PG", "display_name": "Daniel Gasienica", "link": "https://stackoverflow.com/users/125305/daniel-gasienica"}, "is_accepted": true, "score": 1, "last_activity_date": 1455507393, "creation_date": 1455507393, "answer_id": 35401109, "question_id": 33129097, "link": "https://stackoverflow.com/questions/33129097/passing-app-secrets-in-yesod-and-keter/35401109#35401109", "title": "Passing app secrets in Yesod and Keter", "body": "<p>Set your secrets as environment variables on your server and \u2018forward\u2019 them to your app using <code>forward-env</code> in <code>config/keter.yml</code> as seen in the following patch: <a href=\"https://github.com/snoyberg/keter/commit/9e9fca314fb78860fb5c9b08cad212d92b0b20d4\" rel=\"nofollow\">https://github.com/snoyberg/keter/commit/9e9fca314fb78860fb5c9b08cad212d92b0b20d4</a></p>\n"}], "owner": {"reputation": 29707, "user_id": 394167, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/5b8b4928a69d422138ed747c70e8553e?s=128&d=identicon&r=PG", "display_name": "Richard Cook", "link": "https://stackoverflow.com/users/394167/richard-cook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 394, "favorite_count": 1, "accepted_answer_id": 35401109, "answer_count": 1, "score": 17, "last_activity_date": 1455507393, "creation_date": 1444835398, "last_edit_date": 1445009975, "question_id": 33129097, "link": "https://stackoverflow.com/questions/33129097/passing-app-secrets-in-yesod-and-keter", "title": "Passing app secrets in Yesod and Keter", "body": "<p>I'm building a web app with Yesod and am currently passing in secrets such as API keys via environment variables (as per <a href=\"http://12factor.net/config\" rel=\"noreferrer\">The Twelve-Factor App</a>) to avoid storing these values in version-controlled configuration files. For example, I run my app in dev mode as follows:</p>\n\n<pre><code>SOME_API_KEY=value yesod devel\n</code></pre>\n\n<p>I have a value in my <code>config/settings.yml</code> file that is defined in terms of this environment variable with an empty value as follows:</p>\n\n<pre><code>meetup-api-key: \"_env:SOME_API_KEY:\"\n</code></pre>\n\n<p>To deploy using Keter, I'm building the Keter package using the <code>yesod keter</code> command and dropping the resulting file into Keter 's<code>incoming</code> directory. Since I'm using environment variable configuration, my app's <code>.keter</code> file does not contain the <code>SOME_API_KEY</code> value (which is intentional).</p>\n\n<p>How should I pass <code>SOME_API_KEY</code> into the instance of my app running inside Keter?</p>\n\n<p>I would like to avoid baking the value into my <code>keter-config.yaml</code> for at least the following three reasons:</p>\n\n<ol>\n<li>It is less secure than the environment variable approach.</li>\n<li>Being embedded directly into the configuration file for Keter itself, as opposed to the configuration to the app, the secret cannot be changed without stopping and restarting the entire Keter process.</li>\n<li>The environment variables are passed into <em>every</em> app being managed by Keter.</li>\n</ol>\n\n<p>I am hoping that there are some \"best practices\" out there for this scenario.</p>\n"}, {"tags": ["algorithm", "haskell", "tree", "lazy-evaluation", "fold"], "answers": [{"comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 3, "creation_date": 1444840048, "post_id": 33129689, "comment_id": 54073187, "body": "I&#39;ll note that you <i>can</i> fold an infinite depth and infinite width tree if you let the result be a function similar to <code>rindex</code>, except with infinite index list."}, {"owner": {"reputation": 891, "user_id": 99978, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/784837d98d18ff99681f612a62dddbcc?s=128&d=identicon&r=PG", "display_name": "j.p.", "link": "https://stackoverflow.com/users/99978/j-p"}, "edited": false, "score": 2, "creation_date": 1444840391, "post_id": 33129689, "comment_id": 54073363, "body": "How do you define depth? The supremum of the length of all paths? If all paths are finite (but maybe with unbounded length), then the number of paths is countable (as long the breadth at each node is countable)."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 5, "creation_date": 1444845346, "post_id": 33129689, "comment_id": 54076168, "body": "You can&#39;t list <i>all</i> paths. But you can have a single list of paths with a remarkable property: given any finite prefix of a path&#39;s indices, there is a finite index in the list of paths containing a path with an identical prefix. That&#39;s almost certainly good enough for computing, since vanishingly few infinite paths are representable in finite space anyway. See @dfeuer&#39;s answer for how to do it."}, {"owner": {"reputation": 891, "user_id": 99978, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/784837d98d18ff99681f612a62dddbcc?s=128&d=identicon&r=PG", "display_name": "j.p.", "link": "https://stackoverflow.com/users/99978/j-p"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1444850854, "post_id": 33129689, "comment_id": 54079427, "body": "@DanielWagner: You can list all paths as long each path has finite length, but you have to change their order."}, {"owner": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "edited": false, "score": 0, "creation_date": 1445056939, "post_id": 33129689, "comment_id": 54172503, "body": "I added my intuition for why this tree is unfoldable."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 5, "last_activity_date": 1444839266, "last_edit_date": 1495542214, "creation_date": 1444836974, "answer_id": 33129689, "question_id": 33128736, "link": "https://stackoverflow.com/questions/33128736/lazy-folding-of-infinite-depth-infinite-breadth-rose-tree-to-its-edge-paths/33129689#33129689", "title": "Lazy Folding of Infinite Depth &amp; Infinite Breadth Rose Tree to its Edge Paths", "body": "<p>Not a complete answer, but you might be interested in this detailed answer on how Haskell's <code>permutations</code> function is written so that it works on infinite lists:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/24484348/what-does-this-list-permutations-implementation-in-haskell-exactly-do/24564307#24564307\">What does this list permutations implementation in Haskell exactly do?</a></p>\n\n<p><strong>Update</strong></p>\n\n<p>Here's a simpler way to create an infinite Rose tree:</p>\n\n<pre><code>iRose x = Rose x [ iRose (x+i) | i &lt;- [1..] ]\n\nrindex (Rose a rs) [] = a\nrindex (Rose _ rs) (x:xs) = rindex (rs !! x) xs\n</code></pre>\n\n<p>Examples:</p>\n\n<pre><code>rindex (iRose 0) [0,1,2,3,4,5,6]     -- returns: 26\nrindex infiniteTree [0,1,2,3,4,5,6]  -- returns: 13\n</code></pre>\n\n<p><strong>Infinite Depth</strong></p>\n\n<p>If a Rose tree has infinite depth and non-trivial width (> 1) there can't be an algorithm to list all of the paths just using a counting argument - the number of total paths is uncountable.</p>\n\n<p><strong>Finite Depth &amp; Infinite Breadth</strong></p>\n\n<p>If the Rose tree has finite depth the number of paths is countable even if the trees have infinite breadth, and there is an algorithm which can produce all possible paths. Watch this space for updates.</p>\n"}, {"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1444845088, "post_id": 33130939, "comment_id": 54076007, "body": "Great answer! Although you must replace <code>concat</code> with <a href=\"http://hackage.haskell.org/package/universe-base-1.0.2.1/docs/Data-Universe-Helpers.html#v:diagonal\" rel=\"nofollow noreferrer\"><code>diagonal</code></a> or similar. Otherwise, since the first child will produce infinitely many paths, <code>concatMap paths children</code> will not contain any path from the second child at any finite index. So the recursive call should be <code>diagonal (map paths children)</code> instead."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 1, "creation_date": 1444845903, "post_id": 33130939, "comment_id": 54076512, "body": "Can you write <code>infTree</code> in terms of the <code>Rose</code> constructor? It would make it easier to test. I&#39;m getting a hang on: <code>head ((paths (iRose 0)) !! 2)</code>.  My code: <a href=\"http://lpaste.net/143025\" rel=\"nofollow noreferrer\">lpaste.net/143025</a>"}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1444846717, "post_id": 33130939, "comment_id": 54077032, "body": "I guess I should expect a hang for just the <code>concatMap</code> version. However, I&#39;m still getting a hang with the diagonals version - which might mean I&#39;ve implemented <code>diags</code> incorrectly."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1444847637, "post_id": 33130939, "comment_id": 54077542, "body": "@DanielWagner, I explicitly did not attempt, in this implementation, to reach any particularly interesting set of paths; I was just trying to show where the original code got stuck and to attempt to patch that up."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1444847678, "post_id": 33130939, "comment_id": 54077568, "body": "@ErikR Your <code>paths2</code> makes its recursive call to <code>paths</code> instead of <code>paths2</code>."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1444847761, "post_id": 33130939, "comment_id": 54077617, "body": "I figured out my problem with the <code>paths2</code> function. see this paste: <a href=\"http://lpaste.net/143025\" rel=\"nofollow noreferrer\">lpaste.net/143025</a>"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1444848098, "post_id": 33130939, "comment_id": 54077816, "body": "@ErikR There seems to be some problem with your <code>diags</code>, as well: I can confirm that replacing <code>diags</code> with <code>diagonal</code> in your second paste makes <code>test2</code> stop looping. Even if you don&#39;t want to install the <code>universe</code> package, you can just copy the definition of that function from <a href=\"http://hackage.haskell.org/package/universe-base-1.0.2.1/docs/src/Data-Universe-Helpers.html#diagonal\" rel=\"nofollow noreferrer\">here</a> -- it&#39;s only about eight lines of code."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1444848445, "post_id": 33130939, "comment_id": 54078019, "body": "I am puzzled by this, especially when you say &quot;from the left&quot;. Consider a binary tree when each node has exactly two children labelled <code>True,False</code> in that order. The first path you generate is <code>repeat True</code>. OK. What is, however, the <i>second</i> path? I fear that it is once again <code>repeat True</code>. Worse, you will never reach some different path (one with some <code>False</code> inside). The whole result is, I fear, <code>repeat (repeat True)</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1444848563, "post_id": 33130939, "comment_id": 54078091, "body": "@chi I believe you are reiterating my comment about using <code>diagonal</code> instead of <code>concat</code>. =)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1444848785, "post_id": 33130939, "comment_id": 54078233, "body": "@DanielWagner Correct. But I wonder which kinds of paths are actually produced using a fair <code>diagonal</code>. Maybe only those of the form <code>prefix ++ repeat True</code> ?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1444848830, "post_id": 33130939, "comment_id": 54078256, "body": "@chi I expect so, yes."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1444851383, "post_id": 33130939, "comment_id": 54079721, "body": "@chi, interesting point! Some &quot;fairness&quot; seems to be necessary to make any useful results at all."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 1, "creation_date": 1444854561, "post_id": 33130939, "comment_id": 54081597, "body": "@dfeuer, does your version produce anything except for the first path? I can&#39;t make it work with, say, <code>infiniteTree</code> from the question: <code>take 2 $ map (take 1) $ paths infiniteTree</code> loops."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 2, "last_activity_date": 1444851958, "last_edit_date": 1495541029, "creation_date": 1444840596, "answer_id": 33130939, "question_id": 33128736, "link": "https://stackoverflow.com/questions/33128736/lazy-folding-of-infinite-depth-infinite-breadth-rose-tree-to-its-edge-paths/33130939#33130939", "title": "Lazy Folding of Infinite Depth &amp; Infinite Breadth Rose Tree to its Edge Paths", "body": "<p>ErikR has explained why you can't produce a list that necessarily contains all the paths, but it is possible to list paths lazily from the left. The simplest trick, albeit a dirty one, is to recognize that the result is never empty and force that fact on Haskell.</p>\n\n<pre><code>paths (Rose x []) = [[x]]\npaths (Rose x children) = map (x :) (a : as)\n  where\n    a : as = concatMap paths children\n    -- Note that we know here that children is non-empty, and therefore\n    -- the result will not be empty.\n</code></pre>\n\n<p>For making very infinite rose trees, consider</p>\n\n<pre><code>infTree labels = Rose labels (infForest labels)\ninfForest labels = [Rose labels' (infForest labels')\n                      | labels' &lt;- map (: labels) [0..]]\n</code></pre>\n\n<p>As chi <a href=\"https://stackoverflow.com/questions/33128736/haskell-lazy-folding-of-infinite-depth-infinite-breadth-rose-tree-to-its-edge#comment54078019_33130939\">points out</a>, while this definition of <code>paths</code> is productive, it will in some cases repeat the leftmost path forever, and never reach any more. Oops! So some attempt at fairness or diagonal traversal is <em>necessary</em> to give interesting/useful results.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444857635, "post_id": 33135646, "comment_id": 54083131, "body": "I deleted my post because user3237465 pointed out that it too gets stuck. I couldn&#39;t quite figure out why, and couldn&#39;t come up with a quick fix."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444857713, "post_id": 33135646, "comment_id": 54083168, "body": "The part of my post I like best is the infinite tree construction. You might consider stealing it."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1444862085, "post_id": 33135646, "comment_id": 54085074, "body": "@dfeuer, I wasn&#39;t first: someone else said that the version with <code>concatMap</code> loops. The problem was with <code>concatMap</code>: <code>map paths</code> results in <code>[(x1 : th1), (x2 : th2),...]</code>, <code>concat</code> then yields only the first <code>x1</code>. If we replace <code>concat</code> with <code>shift xs = map head xs ++ concat (map tail xs)</code>, then <code>paths</code> does produce some non-interesting input. I guess <code>diagonal</code> works because paths are forced more deeply: e.g. if the depth of a <code>Rose</code> more than <code>2</code>, then we know that all paths have at least <code>2</code> elements."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1444862467, "post_id": 33135646, "comment_id": 54085222, "body": "@user3237465, the part I don&#39;t understand yet is why <code>th1 = _|_</code>."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1444865457, "post_id": 33135646, "comment_id": 54086229, "body": "*&quot;non-interesting output&quot; instead of &quot;non-interesting input&quot;. @dfeuer, <a href=\"http://lpaste.net/143037\" rel=\"nofollow noreferrer\">looks</a> like because in <code>a:as</code> <code>as</code> just never gets forced. But I don&#39;t understand how <code>diagonal</code> is different, and don&#39;t want to trace it manually."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444878368, "post_id": 33135646, "comment_id": 54089287, "body": "@dfeuer Oh, how nasty! I hadn&#39;t even tried to run your code, so that problem completely escaped my notice."}, {"owner": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "edited": false, "score": 0, "creation_date": 1445056945, "post_id": 33135646, "comment_id": 54172506, "body": "I added my intuition for why this tree is unfoldable."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 6, "last_activity_date": 1444857096, "creation_date": 1444857096, "answer_id": 33135646, "question_id": 33128736, "link": "https://stackoverflow.com/questions/33128736/lazy-folding-of-infinite-depth-infinite-breadth-rose-tree-to-its-edge-paths/33135646#33135646", "title": "Lazy Folding of Infinite Depth &amp; Infinite Breadth Rose Tree to its Edge Paths", "body": "<p>For some reason, dfeuer has deleted his answer, which included a very nice insight and only a minor, easily-fixed problem. Below I discuss his nice insight, and fix the easily-fixed problem.</p>\n\n<p>His insight is that the reason the original code hangs is because it is not obvious to <code>concat</code> that any of the elements of its argument list are non-empty. Since we can prove this (outside of Haskell, with paper and pencil), we can cheat just a little bit to convince the compiler that it's so.</p>\n\n<p>Unfortunately, <code>concat</code> isn't quite good enough: if you give <code>concat</code> a list like <code>[[1..], foo]</code>, it will never draw elements from <code>foo</code>. The <a href=\"http://hackage.haskell.org/package/universe\" rel=\"noreferrer\"><code>universe</code></a> collection of packages can help here with its <a href=\"http://hackage.haskell.org/package/universe-base-1.0.2.1/docs/Data-Universe-Helpers.html#v:diagonal\" rel=\"noreferrer\"><code>diagonal</code></a> function, which does draw elements from all sublists.</p>\n\n<p>Together, these two insights lead to the following code:</p>\n\n<pre><code>import Data.Tree\nimport Data.Universe.Helpers\n\npaths (Node x []) = [[x]]\npaths (Node x children) = map (x:) (p:ps) where\n    p:ps = diagonal (map paths children)\n</code></pre>\n\n<p>If we define a particular infinite tree:</p>\n\n<pre><code>infTree x = Node x [infTree (x+i) | i &lt;- [1..]]\n</code></pre>\n\n<p>We can look at how it behaves in ghci:</p>\n\n<pre><code>&gt; let v = paths (infTree 0)\n&gt; take 5 (head v)\n[0,1,2,3,4]\n&gt; take 5 (map head v)\n[0,0,0,0,0]\n</code></pre>\n\n<p>Looks pretty good! Of course, as observed by ErikR, we cannot have all paths in here. However, given any finite prefix <code>p</code> of an infinite path through <code>t</code>, there is a finite index in <code>paths t</code> whose element starts with prefix <code>p</code>.</p>\n"}], "owner": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 515, "favorite_count": 4, "accepted_answer_id": 33129689, "answer_count": 3, "score": 6, "last_activity_date": 1445057310, "creation_date": 1444834463, "last_edit_date": 1495542214, "question_id": 33128736, "link": "https://stackoverflow.com/questions/33128736/lazy-folding-of-infinite-depth-infinite-breadth-rose-tree-to-its-edge-paths", "title": "Lazy Folding of Infinite Depth &amp; Infinite Breadth Rose Tree to its Edge Paths", "body": "<p>This question <a href=\"https://stackoverflow.com/questions/24032137/haskell-fold-rose-tree-paths\">haskell fold rose tree paths</a> delved into the code for folding a rose tree to its paths. I was experimenting with infinite rose trees, and I found that the provided solution was not lazy enough to work on infinite rose trees with infinity in both depth and breadth.</p>\n\n<p>Consider a rose tree like:</p>\n\n<pre><code>data Rose a = Rose a [Rose a] deriving (Show, Functor)\n</code></pre>\n\n<p>Here's a finite rose tree:</p>\n\n<pre><code>finiteTree = Rose \"root\" [ \n    Rose \"a\" [ \n        Rose \"d\" [], \n        Rose \"e\" []\n    ], \n    Rose \"b\" [ \n        Rose \"f\" [] \n    ], \n    Rose \"c\" [] \n]\n</code></pre>\n\n<p>The output of the edge path list should be:</p>\n\n<pre><code>[[\"root\",\"a\",\"d\"],[\"root\",\"a\",\"e\"],[\"root\",\"b\",\"f\"],[\"root\",\"c\"]]\n</code></pre>\n\n<p>Here is an infinite Rose tree in both dimensions:</p>\n\n<pre><code>infiniteRoseTree :: [[a]] -&gt; Rose a\ninfiniteRoseTree ((root:_):breadthGens) = Rose root (infiniteRoseForest breadthGens)\n\ninfiniteRoseForest :: [[a]] -&gt; [Rose a]\ninfiniteRoseForest (breadthGen:breadthGens) = [ Rose x (infiniteRoseForest breadthGens) | x &lt;- breadthGen ]\n\ninfiniteTree = infiniteRoseTree depthIndexedBreadths where\n    depthIndexedBreadths = iterate (map (+1)) [0..]\n</code></pre>\n\n<p>The tree looks like this (it's just an excerpt, there's infinite depth and infinite breadth):</p>\n\n<pre><code>      0\n      |\n      |\n    [1,2..]\n    /  \\\n   /    \\\n  /      \\\n[2,3..]  [2,3..]\n</code></pre>\n\n<p>The paths would look like:</p>\n\n<pre><code>[[0,1,2..]..[0,2,2..]..] \n</code></pre>\n\n<p>Here was my latest attempt (doing it on GHCi causes an infinite loop, no streaming output):</p>\n\n<pre><code>rosePathsLazy (Rose x []) = [[x]]\nrosePathsLazy (Rose x children) = \n    concat [ map (x:) (rosePathsLazy child) | child &lt;- children ]\n\nrosePathsLazy infiniteTree\n</code></pre>\n\n<p>The provided solution in the other answer also did not produce any output:</p>\n\n<pre><code>foldRose f z (Rose x []) = [f x z]\nfoldRose f z (Rose x ns) = [f x y | n &lt;- ns, y &lt;- foldRose f z n]\n\nfoldRose (:) [] infiniteTree\n</code></pre>\n\n<p>Both of the above work for the finite rose tree.</p>\n\n<p>I tried a number of variations, but I can't figure out to make the edge folding operation lazy for infinite 2-dimensional rose tree. I feel like it has something to do with infinite amounts of <code>concat</code>.</p>\n\n<p>Since the output is a 2 dimensional list. I can run a 2 dimensional <code>take</code> and project with a depth-limit or a breadth-limit or both at the same time!</p>\n\n<p>Any help is appreciated!</p>\n\n<hr>\n\n<p>After reviewing the answers here and thinking about it a bit more. I came to the realisation that this is unfoldable, because the resulting list is <em>uncountably</em> infinite. This is because an infinite depth &amp; breadth rose tree is not a 2 dimensional data structure, but an infinite dimensional data structure. Each depth level confers an extra dimension. In other words, it is somewhat equivalent to an infinite dimensional matrix, imagine a matrix where each field is another matrix.. ad-infinitum. The cardinality of the infinite matrix is <code>infinity ^ infinity</code>, which has been proven (I think) to be uncountably infinite. This means any infinite dimensional data structure is not really computable in a useful sense.</p>\n\n<p>To apply this to the rose tree, if we have infinite depth, then the paths never enumerate past the far left of the rose tree. That is this tree:</p>\n\n<pre><code>      0\n      |\n      |\n    [1,2..]\n    /  \\\n   /    \\\n  /      \\\n[2,3..]  [2,3..]\n</code></pre>\n\n<p>Would produce a path like: <code>[[0,1,2..], [0,1,2..], [0,1,2..]..]</code>, and we'd never get past <code>[0,1,2..]</code>.</p>\n\n<p>Or in another way, if we have a list containing lists ad-infinitum. We can also never count (enumerate) it either, as there would be an infinite amount of dimensions that the code would jump to.</p>\n\n<p>This also has some relationship to real numbers being uncountably infinite too. In a lazy list of infinite real numbers would just infinitely produce <code>0.000..</code> and never enumerate past that.</p>\n\n<p>I'm not sure how to formalise the above explanation, but that's my intuition. (For reference see: <a href=\"https://en.wikipedia.org/wiki/Uncountable_set\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Uncountable_set</a>) It'd be cool to see someone expand on applying <a href=\"https://en.wikipedia.org/wiki/Cantor&#39;s_diagonal_argument\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Cantor's_diagonal_argument</a> to this problem.</p>\n\n<p>This book seems to expand on it: <a href=\"https://books.google.com.au/books?id=OPFoJZeI8MEC&amp;pg=PA140&amp;lpg=PA140&amp;dq=haskell+uncountably+infinite&amp;source=bl&amp;ots=Z5hM-mFT6A&amp;sig=ovzWV3AEO16M4scVPCDD-gyFgII&amp;hl=en&amp;sa=X&amp;redir_esc=y#v=onepage&amp;q=haskell%20uncountably%20infinite&amp;f=false\" rel=\"nofollow noreferrer\">https://books.google.com.au/books?id=OPFoJZeI8MEC&amp;pg=PA140&amp;lpg=PA140&amp;dq=haskell+uncountably+infinite&amp;source=bl&amp;ots=Z5hM-mFT6A&amp;sig=ovzWV3AEO16M4scVPCDD-gyFgII&amp;hl=en&amp;sa=X&amp;redir_esc=y#v=onepage&amp;q=haskell%20uncountably%20infinite&amp;f=false</a></p>\n"}, {"tags": ["haskell", "functional-programming", "pattern-matching"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1444846696, "post_id": 33125851, "comment_id": 54077020, "body": "Just a thing, you should change your error message to the standard form of <code>&quot;[name]: [cause]&quot;</code>, so this should be <code>error &quot;myMaximum: empty list&quot;</code>"}, {"owner": {"reputation": 1684, "user_id": 1036669, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/571ab7f825901a36afb1dd04d8deed52?s=128&d=identicon&r=PG", "display_name": "Metalcoder", "link": "https://stackoverflow.com/users/1036669/metalcoder"}, "reply_to_user": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1444928071, "post_id": 33125851, "comment_id": 54117777, "body": "@AJFarmar thanks for the tip!"}], "answers": [{"tags": [], "owner": {"reputation": 60956, "user_id": 8922, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/f1634a09333f7b391db92e1d2bea6253?s=128&d=identicon&r=PG", "display_name": "Sebastian Redl", "link": "https://stackoverflow.com/users/8922/sebastian-redl"}, "is_accepted": true, "score": 10, "last_activity_date": 1444827535, "creation_date": 1444827535, "answer_id": 33125988, "question_id": 33125851, "link": "https://stackoverflow.com/questions/33125851/non-exhaustive-patterns-using-if-then-else/33125988#33125988", "title": "Non-exhaustive patterns using if-then-else", "body": "<p>This isn't about your function. It's about range notation. Type <code>[5..1]</code> in ghci, and you'll find that you get an empty list.</p>\n\n<p>Haskell range notation defaults to adding one at each step unless you explicitly change it using the <code>[first,second..last]</code> notation. Use <code>[5,4..1]</code> to get the behavior you're looking for.</p>\n\n<p>If you remove the first version of your function, the pattern is non-exhaustive because no version of your function can match the empty list then.</p>\n"}], "owner": {"reputation": 1684, "user_id": 1036669, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/571ab7f825901a36afb1dd04d8deed52?s=128&d=identicon&r=PG", "display_name": "Metalcoder", "link": "https://stackoverflow.com/users/1036669/metalcoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 118, "favorite_count": 1, "accepted_answer_id": 33125988, "answer_count": 1, "score": 2, "last_activity_date": 1444827535, "creation_date": 1444827145, "question_id": 33125851, "link": "https://stackoverflow.com/questions/33125851/non-exhaustive-patterns-using-if-then-else", "title": "Non-exhaustive patterns using if-then-else", "body": "<p>I have the following function:</p>\n\n<pre><code>myMaximum [] = error \"There is no such thing as 'maximum' in an empty list.\"\nmyMaximum [x] = x\nmyMaximum (x:xs) = if x &gt;= tailMax\n                    then x\n                    else tailMax\n                where tailMax = myMaximum xs\n</code></pre>\n\n<p>I works just fine when I run <code>myMaximum [1..5]</code>, but it throws the error defined on the first line when I run <code>myMaximum [5..1]</code>. If I take the first line out, it will complain that there is a non-exhaustive pattern on <code>myMaximum</code>. But why this pattern is non-exhaustive? And how calling it with <code>[1..5]</code> works just fine and <code>[5..1]</code> apparently results in empty list argument to <code>myMaximum</code>?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1444818874, "post_id": 33122865, "comment_id": 54058706, "body": "You will have to pass an additional argument, the default value to use when some of the lists are exhausted."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1444818941, "post_id": 33122865, "comment_id": 54058750, "body": "usually that value is <code>0</code> when you sum up I think"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1444819032, "post_id": 33122865, "comment_id": 54058801, "body": "btw: you could extent the solution here if you just concat <code>repeat 0</code> to the smaller lists - but IMO this is to ugly to propose ;)"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1444819217, "post_id": 33122865, "comment_id": 54058905, "body": "@Carsten but how should zipWith know whether you are summing up or doing something else?"}, {"owner": {"reputation": 1390, "user_id": 1610765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/16b01bba5dacce95be27888670b7d218?s=128&d=identicon&r=PG", "display_name": "Chiffa", "link": "https://stackoverflow.com/users/1610765/chiffa"}, "edited": false, "score": 0, "creation_date": 1444819370, "post_id": 33122865, "comment_id": 54059006, "body": "Actually, I suspect that there&#39;s a solution that should work with any function normal <code>zipWith3</code> works with, not just addition."}, {"owner": {"reputation": 1390, "user_id": 1610765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/16b01bba5dacce95be27888670b7d218?s=128&d=identicon&r=PG", "display_name": "Chiffa", "link": "https://stackoverflow.com/users/1610765/chiffa"}, "edited": false, "score": 0, "creation_date": 1444819826, "post_id": 33122865, "comment_id": 54059277, "body": "Add <code>a</code> to the beginning of every element, resulting in <code>[ab,ac,ad]</code>"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1444819931, "post_id": 33122865, "comment_id": 54059340, "body": "Let&#39;s talk <code>zipWith</code> for simplicity (no 3). What should <code>zipWith (:) &quot;a&quot; [&quot;b&quot;, &quot;c&quot;]</code> do?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1444820193, "post_id": 33122865, "comment_id": 54059497, "body": "Sorry edited for correctness. But that&#39;s not what you specified for your sum function. It doesn&#39;t add the last element from the exhausted list, it adds zero. Please try to specify your desired result formally for generic arguments. Again start with the two-list version for simplicity."}], "answers": [{"comments": [{"owner": {"reputation": 1390, "user_id": 1610765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/16b01bba5dacce95be27888670b7d218?s=128&d=identicon&r=PG", "display_name": "Chiffa", "link": "https://stackoverflow.com/users/1610765/chiffa"}, "edited": false, "score": 0, "creation_date": 1444819027, "post_id": 33122936, "comment_id": 54058799, "body": "Quite nice, thanks! Still, it&#39;s interesting to implement it with <code>zipWith3</code>"}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 12, "last_activity_date": 1444818576, "creation_date": 1444818576, "answer_id": 33122936, "question_id": 33122865, "link": "https://stackoverflow.com/questions/33122865/sum3-with-zipwith3-in-haskell/33122936#33122936", "title": "sum3 with zipWith3 in Haskell", "body": "<p>a nice trick is to use <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Data-List.html#v:transpose\"><code>transpose</code></a>:</p>\n\n<pre><code>import Data.List (transpose)\n\nsum3 :: Num a =&gt; [a] -&gt; [a] -&gt; [a] -&gt; [a]\nsum3 as bs cs = map sum $ transpose [as,bs,cs]\n</code></pre>\n\n<p>because obviously you want to sum up the <em>columns</em> ;)</p>\n\n<hr>\n\n<pre><code>&gt; sum3 [1,2,3] [4,5] [6]\n[11,7,3]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": false, "score": 2, "last_activity_date": 1444824208, "last_edit_date": 1444824208, "creation_date": 1444822564, "answer_id": 33124262, "question_id": 33122865, "link": "https://stackoverflow.com/questions/33122865/sum3-with-zipwith3-in-haskell/33124262#33124262", "title": "sum3 with zipWith3 in Haskell", "body": "<p>Well if you <em>must</em> use <code>zipWith3</code>:</p>\n\n<pre><code>sum3 :: Num a =&gt; [a] -&gt; [a] -&gt; [a] -&gt; [a]\nsum3 xs ys zs = zipWith3 (\\x y z -&gt; x + y + z) xs' ys' zs'\n  where\n    xs' = pad nx xs;  nx = length xs\n    ys' = pad ny ys;  ny = length ys\n    zs' = pad nz zs;  nz = length zs\n    n   = nx `max` ny `max` nz\n    pad n' = (++ replicate (n-n') 0)\n</code></pre>\n\n<p>Some samples:</p>\n\n<pre><code>*&gt; sum3 [] [] []\n[]\n*&gt; sum3 [0] [] []\n[0]\n*&gt; sum3 [1] [1] [2, 2]\n[4,2]\n*&gt; sum3 [1,2,3] [4,5] [6]\n[11,7,3]\n</code></pre>\n\n<p>but I'd recommend going with Carsten's <code>transpose</code> based implementation.</p>\n"}, {"tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": false, "score": 2, "last_activity_date": 1444825324, "last_edit_date": 1444825324, "creation_date": 1444824809, "answer_id": 33124996, "question_id": 33122865, "link": "https://stackoverflow.com/questions/33122865/sum3-with-zipwith3-in-haskell/33124996#33124996", "title": "sum3 with zipWith3 in Haskell", "body": "\n\n<p>Perhaps you could get away with something that is <em>almost</em> <code>zipWith3</code> but which relies on <code>Default</code> to generate empty values on the fly if one of the lists runs out of elements:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.Default\n\nzipWith3' :: (Default a, Default b, Default c)\n          =&gt; ( a  -&gt;  b  -&gt;  c  -&gt;  r )\n          -&gt; ([a] -&gt; [b] -&gt; [c] -&gt; [r])\nzipWith3' f = go where\n  go  []     []     []    =           []\n  go (x:xs) (y:ys) (z:zs) = f x y z : go xs    ys    zs\n  go  []     ys     zs    =           go [def] ys    zs\n  go  xs     []     zs    =           go xs    [def] zs\n  go  xs     ys     []    =           go xs    ys    [def]\n</code></pre>\n\n<p>and 'sum3'`:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>sum3' :: (Default a, Num a) =&gt; [a] -&gt; [a] -&gt; [a] -&gt; [a]\nsum3' = zipWith3' (\\x y z -&gt; x + y + z)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1390, "user_id": 1610765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/16b01bba5dacce95be27888670b7d218?s=128&d=identicon&r=PG", "display_name": "Chiffa", "link": "https://stackoverflow.com/users/1610765/chiffa"}, "edited": false, "score": 0, "creation_date": 1444829475, "post_id": 33125831, "comment_id": 54065617, "body": "The previous answer seems correct, but this one is more general. Which should be accepted as the correct one?"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1444833194, "post_id": 33125831, "comment_id": 54068446, "body": "Whichever you prefer! it doesn&#39;t matter at all in this case."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1444838590, "last_edit_date": 1444838590, "creation_date": 1444827084, "answer_id": 33125831, "question_id": 33122865, "link": "https://stackoverflow.com/questions/33122865/sum3-with-zipwith3-in-haskell/33125831#33125831", "title": "sum3 with zipWith3 in Haskell", "body": "<p>One could generalize <code>zipWith</code> so to handle the excess tails, instead of discarding them silently.</p>\n\n<pre><code>zipWithK :: (a-&gt;b-&gt;c) -&gt; ([a]-&gt;[c]) -&gt; ([b]-&gt;[c]) -&gt; [a] -&gt; [b] -&gt; [c]\nzipWithK fab fa fb = go\n  where go [] [] = []\n        go as [] = fa as\n        go [] bs = fb bs\n        go (a:as) (b:bs) = fab a b : go as bs\n</code></pre>\n\n<p>The original <code>zipWith</code> is then</p>\n\n<pre><code>zipWith' :: (a-&gt;b-&gt;c) -&gt; [a] -&gt; [b] -&gt; [c]\nzipWith' f = zipWithK f (const []) (const [])\n</code></pre>\n\n<p>Back to the original problem,</p>\n\n<pre><code>sum2 :: Num a =&gt; [a] -&gt; [a] -&gt; [a]\nsum2 = zipWithK (+) id id\n\nsum3 :: Num a =&gt; [a] -&gt; [a] -&gt; [a] -&gt; [a]\nsum3 xs ys zs  = xs `sum2` ys `sum2` zs\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 2, "creation_date": 1444830468, "post_id": 33125969, "comment_id": 54066416, "body": "Is there a reason we can&#39;t simply write <code>(|pad0 [1,2,3] + pad0 [4,5] + pad0 [6]|)</code> (you missed the <code>[]</code> around <code>6</code>, BTW)? Or, more generally, can we treat <code>(...)</code> inside <code>(|...|)</code> as <code>(|...|)</code>?"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1444833428, "post_id": 33125969, "comment_id": 54068636, "body": "definitely not the answer the OP&#39;s looking for but a good advanced applicative tutorial nevertheless!"}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 2, "creation_date": 1444894123, "post_id": 33125969, "comment_id": 54094854, "body": "@user3237465 It&#39;s a moot point. The short, bad answer is that I never got around to adding precedence/associaitivity handling to the SHE parser. The better answer is that idiom brackets give you one top level application. But arguably, they should apply for a whole code region, provided there is a clear way to signal which subtrees have gone back to &quot;normal&quot;."}], "tags": [], "owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "is_accepted": false, "score": 6, "last_activity_date": 1444827480, "last_edit_date": 1495540771, "creation_date": 1444827480, "answer_id": 33125969, "question_id": 33122865, "link": "https://stackoverflow.com/questions/33122865/sum3-with-zipwith3-in-haskell/33125969#33125969", "title": "sum3 with zipWith3 in Haskell", "body": "<p>I've seen this sort of question before, here: <a href=\"https://stackoverflow.com/q/21349408/828361\">Zip with default value instead of dropping values?</a> <a href=\"https://stackoverflow.com/a/21350096/828361\">My answer</a> to that question also pertains here.</p>\n\n<p>The <code>ZipList</code> applicative \nLists with a designated padding element are applicative (the applicative grown from the 1 and max monoid structure on positive numbers).</p>\n\n<pre><code>data Padme m = (:-) {padded :: [m], padder :: m} deriving (Show, Eq)\n\ninstance Applicative Padme where\n  pure = ([] :-)\n  (fs :- f) &lt;*&gt; (ss :- s) = zapp fs ss :- f s where\n    zapp  []        ss        = map f ss\n    zapp  fs        []        = map ($ s) fs\n    zapp  (f : fs)  (s : ss)  = f s : zapp fs ss\n\n-- and for those of you who don't have DefaultSuperclassInstances\ninstance Functor Padme where fmap = (&lt;*&gt;) . pure\n</code></pre>\n\n<p>Now we can pack up lists of numbers with their appropriate padding</p>\n\n<pre><code>pad0 :: [Int] -&gt; Padme Int\npad0 = (:- 0)\n</code></pre>\n\n<p>And that gives</p>\n\n<pre><code>padded ((\\x y z -&gt; x+y+z) &lt;$&gt; pad0 [1,2,3] &lt;*&gt; pad0 [4,5] &lt;*&gt; pad0 [6])\n= [11,7,3]\n</code></pre>\n\n<p>Or, with the Idiom Brackets that aren't available, you vould write</p>\n\n<pre><code>padded (|pad0 [1,2,3] + (|pad0 [4,5] + pad0 6|)|)\n</code></pre>\n\n<p>meaning the same.</p>\n\n<p><code>Applicative</code> gives you a good way to bottle the essential idea of \"padding\" that this problem demands.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10831466, "user_type": "registered", "profile_image": "https://graph.facebook.com/1194715824010399/picture?type=large", "display_name": "Narek  Karapetyan", "link": "https://stackoverflow.com/users/10831466/narek-karapetyan"}, "is_accepted": false, "score": 0, "last_activity_date": 1595515659, "creation_date": 1595515659, "answer_id": 63057014, "question_id": 33122865, "link": "https://stackoverflow.com/questions/33122865/sum3-with-zipwith3-in-haskell/63057014#63057014", "title": "sum3 with zipWith3 in Haskell", "body": "<p>This is my solution:</p>\n<pre><code>sumLists :: Num a =&gt; [a] -&gt; [a] -&gt; [a]\nsumLists (x : xs) (y : ys) = (x + y) : sumLists xs ys\nsumLists _ _ = []\n\nsum3 :: (Num a, Enum a) =&gt; [a] -&gt; [a] -&gt; [a] -&gt; [a]\nsum3 xs ys zs = foldr sumLists defaultList (map addElems list)\n  where list = [xs, ys, zs]\n        defaultList = [] ++ [0, 0 ..]\n        maxLength = maximum $ map length list\n        addElems = \\x -&gt; if length x &lt; maxLength then x ++ [0, 0 ..] else x\n</code></pre>\n"}], "owner": {"reputation": 1390, "user_id": 1610765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/16b01bba5dacce95be27888670b7d218?s=128&d=identicon&r=PG", "display_name": "Chiffa", "link": "https://stackoverflow.com/users/1610765/chiffa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 856, "favorite_count": 1, "answer_count": 6, "score": 2, "last_activity_date": 1595515659, "creation_date": 1444818322, "question_id": 33122865, "link": "https://stackoverflow.com/questions/33122865/sum3-with-zipwith3-in-haskell", "title": "sum3 with zipWith3 in Haskell", "body": "<p>I'm trying to write a Haskell function that would take three lists and return a list of sums of their elements.\nCurrently I'm trying to do it using zipWith3:</p>\n\n<pre><code>sum3 :: Num a =&gt; [a] -&gt; [a] -&gt; [a] -&gt; [a]\nsum3 xs ys zs  = zipWith3 (\\x y z -&gt; x+y+z) xs ys zs \n</code></pre>\n\n<p>The problem is it only works for lists of equal lengths. But I wish <code>sum3</code> to work with lists of unequal lengths, so that </p>\n\n<pre><code>sum3 [1,2,3] [4,5] [6]\n</code></pre>\n\n<p>would return</p>\n\n<pre><code>[11,7,3]\n</code></pre>\n\n<p>I think that I should redefine zipWith3 to work with lists of unequal lengths, but can't figure out how to do it (I suspect that I have to exhaust all possibilities of empty lists).\nIs there a solution?</p>\n"}, {"tags": ["haskell", "haskell-snap-framework", "http-conduit", "lazy-io"], "comments": [{"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1444823548, "post_id": 33121251, "comment_id": 54061525, "body": "I don&#39;t have any details on what may be happening on the Snap side of things, but just to clarify <code>httpLbs</code> does not perform lazy I/O. It strictly performs its actions, and only uses a lazy ByteString for better memory usage (see the documentation for details)."}, {"owner": {"reputation": 1747, "user_id": 215381, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4ab17df223036dd5a9e9e93696a76525?s=128&d=identicon&r=PG", "display_name": "sigrlami", "link": "https://stackoverflow.com/users/215381/sigrlami"}, "edited": false, "score": 0, "creation_date": 1444840401, "post_id": 33121251, "comment_id": 54073371, "body": "how about <code>writeLBS $ L.pack $ &quot;{ \\&quot;data\\&quot;: \\&quot;&quot;++ resp ++ &quot;\\&quot; }&quot;</code> ?"}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 1747, "user_id": 215381, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4ab17df223036dd5a9e9e93696a76525?s=128&d=identicon&r=PG", "display_name": "sigrlami", "link": "https://stackoverflow.com/users/215381/sigrlami"}, "edited": false, "score": 0, "creation_date": 1444866756, "post_id": 33121251, "comment_id": 54086529, "body": "@Sigrlami resp is already a lazy <code>Bytestring</code>. therefore <code>L.pack</code> would introduce a type error - I am using &quot;OverloadedString&quot;."}, {"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "reply_to_user": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1444866817, "post_id": 33121251, "comment_id": 54086545, "body": "@MichaelSnoyman thanks for confirming that <code>httpLbs</code> is unlikely the culprit - I did some research on <code>writeLBS</code> see the edit"}], "answers": [{"tags": [], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "is_accepted": true, "score": 0, "last_activity_date": 1445415668, "creation_date": 1445415668, "answer_id": 33254262, "question_id": 33121251, "link": "https://stackoverflow.com/questions/33121251/http-conduit-snap-and-lazy-io/33254262#33254262", "title": "http-conduit, snap and lazy IO", "body": "<p>I have solved this issue - it actually was a problem with the javascript getting the handwritten json (note to self: never do that again). There was a non-breaking space at the end of the input data that was not encoded correctly, and I as I am a newbie at JS I didn't get that from the error message.</p>\n\n<p>The intermediate solution is to add <code>urlEncode</code> and make a strict <code>ByteString</code></p>\n\n<pre><code>               let respB = urlEncode . L.toStrict $ C.responseBody resp\n               modifyResponse $ setBufferingMode False\n                              . setHeader \"Content-Type\" \"application/json\"\n               writeBS $ \"{ \\\"data\\\": \\\"\" &lt;&gt; respB &lt;&gt; \"\\\" }\"\n</code></pre>\n\n<p>of course you have to change imports accordingly.</p>\n\n<p>The long term solution is: write a proper <code>from/toJSON</code> instance and let the library deal with this.</p>\n"}], "owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 1, "accepted_answer_id": 33254262, "answer_count": 1, "score": 2, "last_activity_date": 1445415668, "creation_date": 1444814082, "last_edit_date": 1444867045, "question_id": 33121251, "link": "https://stackoverflow.com/questions/33121251/http-conduit-snap-and-lazy-io", "title": "http-conduit, snap and lazy IO", "body": "<p>I have two http-servers working with a json api using the snap framework</p>\n\n<p>my first prototype contains a handler similar to this example handler</p>\n\n<pre><code>import           Data.ByteString (ByteString)\nimport           Data.ByteString.Char8 as B (unwords, putStrLn)\nimport           Data.ByteString.Lazy.Char8 as L (putStrLn)\nimport           Control.Monad.IO.Class (liftIO)\nimport           Data.Monoid ((&lt;&gt;))\nimport           Snap.Core (getParam, modifyResponse, setHeader, writeLBS) \nimport           Network.HTTP.Conduit\nimport           Network.HTTP.Client (defaultManagerSettings)\n\n\nexampleHandler :: AppHandler ()\nexampleHandler = do resp &lt;- liftIO\n                         $ do L.putStrLn \"Begin request ...\"\n                              initReq &lt;- parseUrl \"http://localhost:8001/api\"\n                              manager &lt;- newManager defaultManagerSettings\n                              let req  = initReq { method = \"GET\"\n                                                 , proxy = Nothing}\n                              r &lt;- httpLbs req manager\n                              L.putStrLn \"... finished request.\"\n                              return $ responseBody r\n                    liftIO . L.putStrLn $ \"resp: \" &lt;&gt; resp\n                    modifyResponse $ setHeader \"Content-Type\" \"application/json\"\n                    writeLBS $ \"{ \\\"data\\\": \\\"\"&lt;&gt; resp &lt;&gt;\"\\\" }\"\n</code></pre>\n\n<p>If I issue an ajax-request, the response is sent and received - i see this when the server writes <code>resp: testdata</code> on the console, but the response sent to the browser with <code>writeLBS</code> is not. Now if I change the last line to </p>\n\n<pre><code>                    writeLBS $ \"{ \\\"data\\\": \\\"\"&lt;&gt; \"something fixed\" &lt;&gt;\"\\\" }\"\n</code></pre>\n\n<p>everything works like a charm. I think I am meeting one of the pitfalls of lazy IO, but I don't know how to remedy this.</p>\n\n<p>I also tried a few variations with no singe <code>liftIO</code>-block but putting <code>liftIO</code> where necessary.</p>\n\n<h2>EDIT</h2>\n\n<p>based on the comment by @MichaelSnoyman I did some research regarding <code>writeLBS</code> and tried to </p>\n\n<pre><code>               modifyResponse $ setBufferingMode False\n                              . setHeader \"Content-Type\" \"application/json\"\n               writeLBS resp\n</code></pre>\n\n<p>as I thought maybe buffering could be the problem - no it is not</p>\n\n<p>Furthermore I tried to write explicitly a <code>setResponseBody</code></p>\n\n<pre><code>               let bb = enumBuilder . fromLazyByteString $ \"{ \\\"data\\\": \\\"\"&lt;&gt; resp &lt;&gt;\"\\\" }\"\n               modifyResponse $ setBufferingMode False\n                              . setHeader \"Content-Type\" \"application/json\"\n                              . setResponseBody bb\n</code></pre>\n\n<p>Which showed also no success.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1444812388, "post_id": 33120442, "comment_id": 54054283, "body": "I am 90% sure it&#39;s because <code>takeA</code> is implicitly existentially quantified."}], "answers": [{"comments": [{"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 1, "creation_date": 1444813333, "post_id": 33120798, "comment_id": 54054944, "body": "<i>promises that takeA can return Either A c for any c</i> - so essentially, it&#39;s the problem of <code>takeA</code> being declared as <code>forall b. AsToA b = a -&gt; a -&gt; Either A b</code>, where the <code>b</code> in the instance is rigid, right?"}, {"owner": {"reputation": 484, "user_id": 3539877, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/52926a415d282244cd022fcc313ef42b?s=128&d=identicon&r=PG&f=1", "display_name": "RhubarbAndC", "link": "https://stackoverflow.com/users/3539877/rhubarbandc"}, "edited": false, "score": 0, "creation_date": 1444813449, "post_id": 33120798, "comment_id": 54055043, "body": "So what do you suggest I do?  Is it possible to define this typeclass at all?"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 484, "user_id": 3539877, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/52926a415d282244cd022fcc313ef42b?s=128&d=identicon&r=PG&f=1", "display_name": "RhubarbAndC", "link": "https://stackoverflow.com/users/3539877/rhubarbandc"}, "edited": false, "score": 1, "creation_date": 1444813594, "post_id": 33120798, "comment_id": 54055155, "body": "@RhubarbAndC I am not sure what do you need that <code>Either</code> for"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1444813772, "post_id": 33120798, "comment_id": 54055262, "body": "@BartekBanachewicz Yes, exactly."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 484, "user_id": 3539877, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/52926a415d282244cd022fcc313ef42b?s=128&d=identicon&r=PG&f=1", "display_name": "RhubarbAndC", "link": "https://stackoverflow.com/users/3539877/rhubarbandc"}, "edited": false, "score": 1, "creation_date": 1444813991, "post_id": 33120798, "comment_id": 54055408, "body": "@RhubarbAndC I&#39;m not sure what should be the result you expect. What should be the exact result type for e.g. the case <code>A-&gt;A-&gt;A</code> ? Maybe if you can show some examples without typeclasses (on fixed types), someone can craft a generalization for that."}, {"owner": {"reputation": 484, "user_id": 3539877, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/52926a415d282244cd022fcc313ef42b?s=128&d=identicon&r=PG&f=1", "display_name": "RhubarbAndC", "link": "https://stackoverflow.com/users/3539877/rhubarbandc"}, "edited": false, "score": 0, "creation_date": 1444814636, "post_id": 33120798, "comment_id": 54055866, "body": "I don&#39;t want the typeclass to include A, but it should include anything of the type (A -&gt; A) .  takeA should return another AsToA for most instances, but has to return an A for (A -&gt; A).  So in general it should return Either A (Something in AsToA).  If it&#39;s not possible to define takeA like this, then can anyone think of another way of defining this typeclass?"}, {"owner": {"reputation": 484, "user_id": 3539877, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/52926a415d282244cd022fcc313ef42b?s=128&d=identicon&r=PG&f=1", "display_name": "RhubarbAndC", "link": "https://stackoverflow.com/users/3539877/rhubarbandc"}, "edited": false, "score": 0, "creation_date": 1444815078, "post_id": 33120798, "comment_id": 54056140, "body": "@chi Oh sorry - I want the instance for (A -&gt; A -&gt; A) to define takeA f a = f a, which has type (A -&gt; A).  This then defines takeA f a = f a, which has type A.  Basically, I want a function in this class to be able to take an arbitrary number of inputs, which I will keep giving it until I get an A back."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 484, "user_id": 3539877, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/52926a415d282244cd022fcc313ef42b?s=128&d=identicon&r=PG&f=1", "display_name": "RhubarbAndC", "link": "https://stackoverflow.com/users/3539877/rhubarbandc"}, "edited": false, "score": 0, "creation_date": 1444815904, "post_id": 33120798, "comment_id": 54056698, "body": "@RhubarbAndC How would <code>takeA</code> differ from <code>id</code> (note that <code>id f a1 a2 .. an = f a1 a2 .. an</code>) ?"}, {"owner": {"reputation": 484, "user_id": 3539877, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/52926a415d282244cd022fcc313ef42b?s=128&d=identicon&r=PG&f=1", "display_name": "RhubarbAndC", "link": "https://stackoverflow.com/users/3539877/rhubarbandc"}, "edited": false, "score": 0, "creation_date": 1444817741, "post_id": 33120798, "comment_id": 54057903, "body": "@chi takeA should work only on members of the class, and classify its output as either another member of the class or a value of type A.  id doesn&#39;t work this way, because I can&#39;t &quot;type match&quot; on a function to see how many inputs it has, can I?"}, {"owner": {"reputation": 484, "user_id": 3539877, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/52926a415d282244cd022fcc313ef42b?s=128&d=identicon&r=PG&f=1", "display_name": "RhubarbAndC", "link": "https://stackoverflow.com/users/3539877/rhubarbandc"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1444842785, "post_id": 33120798, "comment_id": 54074744, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/92294/discussion-between-rhubarbandc-and-chi\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 4, "last_activity_date": 1444824261, "last_edit_date": 1444824261, "creation_date": 1444812788, "answer_id": 33120798, "question_id": 33120442, "link": "https://stackoverflow.com/questions/33120442/haskell-all-functions-of-form-a-a-a/33120798#33120798", "title": "Haskell - All functions of form A -&gt; A -&gt; ... -&gt; A", "body": "<p>There is some confusion between the two <code>b</code>s:</p>\n\n<pre><code>class AsToA a where\n  takeA :: AsToA b =&gt; a -&gt; A -&gt; Either A b\n\ninstance AsToA b =&gt; AsToA (A -&gt; b) where\n  takeA f a = Right (f a)\n</code></pre>\n\n<p>These are not the same. Let's rename the first one to <code>c</code></p>\n\n<pre><code>class AsToA a where\n  takeA :: AsToA c =&gt; a -&gt; A -&gt; Either A c\n\ninstance AsToA b =&gt; AsToA (A -&gt; b) where\n  takeA f a = Right (f a)\n</code></pre>\n\n<p>Now, <code>Right (f a)</code> has type <code>Either A b</code> but should have type <code>Either A c</code> for any <code>c</code> such that <code>AsToA c</code> holds. This does not type check.</p>\n\n<p>The issue here is that the signature</p>\n\n<pre><code>  takeA :: AsToA c =&gt; a -&gt; A -&gt; Either A c\n</code></pre>\n\n<p>promises that <code>takeA</code> can return <code>Either A c</code> for <em>any</em> <code>c</code>, caller's choice. This is not what you want, I guess.</p>\n\n<hr>\n\n<p>I'm still not sure about what the actual intended result is, but I guess the problem is similar to the following one.</p>\n\n<blockquote>\n  <p>Given a function <code>f</code> of type <code>A-&gt;A-&gt;...-&gt;A</code> return a function \n  <code>\\x -&gt; f x x ...</code>, with one application of \n  <code>x</code> for each <code>-&gt;</code> in the type (hence of type <code>A-&gt;A</code>).</p>\n</blockquote>\n\n<p>A possible solution is</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances, OverlappingInstances #-}\ndata A = A -- could be anything\n\nclass C f where\n   takeA :: f -&gt; A -&gt; A\n\ninstance C (A -&gt; A) where\n   takeA f = f\n\ninstance C b =&gt; C (A -&gt; b) where\n    takeA f = \\x -&gt; takeA (f x) x\n</code></pre>\n\n<p>Note that this requires <code>OverlappingInstances</code> to be used, which is quite <em>evil</em>. I'd recommend to avoid it.</p>\n\n<p>To avoid it, in this case it's enough to define an instance even for the\ntype <code>A</code>.</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-}\ndata A = A -- could be anything\n\nclass C f where\n   takeA :: f -&gt; A -&gt; A\n\ninstance C A where\n   takeA a = \\_ -&gt; a\n\ninstance C b =&gt; C (A -&gt; b) where\n    takeA f = \\x -&gt; takeA (f x) x\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 484, "user_id": 3539877, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/52926a415d282244cd022fcc313ef42b?s=128&d=identicon&r=PG&f=1", "display_name": "RhubarbAndC", "link": "https://stackoverflow.com/users/3539877/rhubarbandc"}, "edited": false, "score": 0, "creation_date": 1444843529, "post_id": 33131234, "comment_id": 54075153, "body": "That second answer is perfect, thanks very much.  I&#39;m sorry if I wasn&#39;t being very clear before."}], "tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": true, "score": 2, "last_activity_date": 1444842735, "last_edit_date": 1444842735, "creation_date": 1444841545, "answer_id": 33131234, "question_id": 33120442, "link": "https://stackoverflow.com/questions/33120442/haskell-all-functions-of-form-a-a-a/33131234#33131234", "title": "Haskell - All functions of form A -&gt; A -&gt; ... -&gt; A", "body": "<p>As mentioned in the comments to the other answer, you might not really need the <code>Either</code>, and <code>takeA</code> is then basically always <code>id</code>, just with a type restriction.  If so you can make this a method-less class:</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances, FlexibleContexts #-}\n\ndata A = A\n\nclass AsToA a\n\ntakeA :: AsToA a =&gt; a -&gt; a\ntakeA = id\n\ninstance AsToA (A -&gt; A)\n\ninstance AsToA (A -&gt; b) =&gt; AsToA (A -&gt; (A -&gt; b))\n</code></pre>\n\n<p>Alternatively, you might want to convert the functions to a common type that allows you to pass in <code>A</code>s dynamically. If so <code>Either</code> won't be enough, but you can define your own:</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances, FlexibleContexts #-}\n\ndata A = A\n\ndata R = Result A | MoreArgs (A -&gt; R)\n\nclass AsToA a where\n    takeA :: a -&gt; A -&gt; R\n\ninstance AsToA (A -&gt; A) where\n    takeA f a = Result (f a)\n\ninstance AsToA (A -&gt; b) =&gt; AsToA (A -&gt; (A -&gt; b)) where\n    takeA f a = MoreArgs (takeA $ f a)\n</code></pre>\n"}], "owner": {"reputation": 484, "user_id": 3539877, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/52926a415d282244cd022fcc313ef42b?s=128&d=identicon&r=PG&f=1", "display_name": "RhubarbAndC", "link": "https://stackoverflow.com/users/3539877/rhubarbandc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 0, "accepted_answer_id": 33131234, "answer_count": 2, "score": 6, "last_activity_date": 1444842735, "creation_date": 1444811764, "question_id": 33120442, "link": "https://stackoverflow.com/questions/33120442/haskell-all-functions-of-form-a-a-a", "title": "Haskell - All functions of form A -&gt; A -&gt; ... -&gt; A", "body": "<p>I have a type (call it A) and I want to make a typeclass of the functions of type A -> A, A -> A -> A, A -> A -> A -> ... etc.  This doesn't work:</p>\n\n<pre><code>{-# LANGUAGE FlexibleInstances #-}\n\ndata A = A\n\nclass AsToA a where\n  takeA :: AsToA b =&gt; a -&gt; A -&gt; Either A b\n\ninstance AsToA (A -&gt; A) where\n  takeA f a = Left (f a)\n\ninstance AsToA b =&gt; AsToA (A -&gt; b) where\n  takeA f a = Right (f a)\n</code></pre>\n\n<p>I get the following error message: </p>\n\n<pre><code>AsToA.hs:12:22:\n    Couldn't match expected type \u2018b1\u2019 with actual type \u2018b\u2019\n      \u2018b\u2019 is a rigid type variable bound by\n          the instance declaration at AsToA.hs:11:10\n      \u2018b1\u2019 is a rigid type variable bound by\n          the type signature for\n\n             takeA :: AsToA b1 =&gt; (A -&gt; b) -&gt; A -&gt; Either A b1\n          at AsToA.hs:12:3\n    Relevant bindings include\n      f :: A -&gt; b (bound at AsToA.hs:12:9)\n      takeA :: (A -&gt; b) -&gt; A -&gt; Either A b1 (bound at AsToA.hs:12:3)\n    In the first argument of \u2018Right\u2019, namely \u2018(f a)\u2019\n    In the expression: Right (f a)\n</code></pre>\n\n<p>Any ideas?  Thanks very much for any advice.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 528, "user_id": 4890944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6584bf69ef530c04cc2f2abc2bba08e3?s=128&d=identicon&r=PG&f=1", "display_name": "\u6c38\u52ab\u56de\u5e30", "link": "https://stackoverflow.com/users/4890944/%e6%b0%b8%e5%8a%ab%e5%9b%9e%e5%b8%b0"}, "edited": false, "score": 0, "creation_date": 1444805216, "post_id": 33118112, "comment_id": 54050188, "body": "Thank you for your explanation and pointing out the Monad instance of <code>(-&gt;) a</code> it removes the magic."}], "tags": [], "owner": {"reputation": 12941, "user_id": 292731, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/e3f90adedab79538799e2375a9731920?s=128&d=identicon&r=PG", "display_name": "Justin L.", "link": "https://stackoverflow.com/users/292731/justin-l"}, "is_accepted": true, "score": 7, "last_activity_date": 1444805066, "last_edit_date": 1444805066, "creation_date": 1444804172, "answer_id": 33118112, "question_id": 33117978, "link": "https://stackoverflow.com/questions/33117978/why-does-it-typecheck-and-how/33118112#33118112", "title": "Why does it typecheck and how?", "body": "<p>If you are writing</p>\n\n<pre><code>return (:) `ap` c `ap` sequence cs\n</code></pre>\n\n<p>Then, with explicit parenthesization, it's</p>\n\n<pre><code>((return (:)) `ap` c) `ap` (sequence cs)\n</code></pre>\n\n<p>So,</p>\n\n<pre><code>(:)                           :: a -&gt; [a] -&gt; [a]\nreturn (:)                    :: IO (a -&gt; [a] -&gt; [a])\nc                             :: IO a\n(return (:)) `ap` c           :: IO ([a] -&gt; [a])\nsequence cs                   :: IO [a]\n((return (:)) `ap` c) `ap` cs :: IO [a]\n</code></pre>\n\n<p>For your second question, <code>ap (:)</code> is using the Monad instance for <code>(-&gt;) a</code>, where</p>\n\n<pre><code>-- Monad instance for ((-&gt;) a)\nreturn x = \\_ -&gt; x\nx &gt;&gt;= f  = \\y -&gt; f (x y) y\n</code></pre>\n\n<p>so, you have:</p>\n\n<pre><code>ap :: (a -&gt; (b -&gt; c)) -&gt; (a -&gt; b) -&gt; (a -&gt; c)\nap f g = \\x -&gt; f x (g x)\n</code></pre>\n\n<p>If you just looked at the do-block definition of <code>ap</code> and expanded out the definitions.</p>\n\n<p>Chances are that this second question probably isn't going to be too important or critical for now; focus on the answer to the first one for now :)</p>\n"}], "owner": {"reputation": 528, "user_id": 4890944, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6584bf69ef530c04cc2f2abc2bba08e3?s=128&d=identicon&r=PG&f=1", "display_name": "\u6c38\u52ab\u56de\u5e30", "link": "https://stackoverflow.com/users/4890944/%e6%b0%b8%e5%8a%ab%e5%9b%9e%e5%b8%b0"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 108, "favorite_count": 0, "accepted_answer_id": 33118112, "answer_count": 1, "score": 1, "last_activity_date": 1444812147, "creation_date": 1444803602, "last_edit_date": 1444812147, "question_id": 33117978, "link": "https://stackoverflow.com/questions/33117978/why-does-it-typecheck-and-how", "title": "Why does it typecheck and how?", "body": "<p>I am reading the paper <em>Applcative programming with effects</em> from Conor McBride and Ross Paterson and I can't figure out why their first piece of code typechecks. (I have a strong OCaml background and a weak haskell background).</p>\n\n<p>There is a function <code>ap</code> from <code>Control.Monad</code> with the following type:</p>\n\n<pre><code>ap :: Monad m =&gt; m (a -&gt; b) -&gt; m a -&gt; m b\n</code></pre>\n\n<p>This function can easily be written like this:</p>\n\n<pre><code>ap mf mx = do { f &lt;- mf ; x &lt;- mx ; return (f x) }\n</code></pre>\n\n<p>Then they write the following:</p>\n\n<pre><code>sequence :: [IO a] \u2192 IO [a]\nsequence [] = return []\nsequence (c : cs) = return (:) `ap` c `ap` sequence cs\n</code></pre>\n\n<p>My problem is that I can't figure out how to work out the type of <code>(:) `ap` c `ap` sequence cs</code> by hand because the type of <code>(:)</code> is nowhere close to <code>m (a -&gt; b)</code> since it is <code>a -&gt; ([a] -&gt; [a])</code>.</p>\n\n<p>The type of <code>ap (Just (:))</code> is <code>Maybe a -&gt; (Maybe ([a] -&gt; [a]))</code> just as expected but the typechecker tells me that the type of <code>ap (:)</code> is <code>(a -&gt; [a]) -&gt; a -&gt; [a]</code>. How is this possible?</p>\n"}, {"tags": ["haskell", "time"], "comments": [{"owner": {"reputation": 1384, "user_id": 2916232, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OTZpa.jpg?s=128&g=1", "display_name": "Pavel P&#225;ja Halbich", "link": "https://stackoverflow.com/users/2916232/pavel-p%c3%a1ja-halbich"}, "edited": false, "score": 0, "creation_date": 1444801149, "post_id": 33117152, "comment_id": 54048444, "body": "Have you tried? And where is your code with error?"}], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 1, "last_activity_date": 1444803286, "last_edit_date": 1444803286, "creation_date": 1444801812, "answer_id": 33117552, "question_id": 33117152, "link": "https://stackoverflow.com/questions/33117152/haskell-convert-time-milliseconds-to-utctime/33117552#33117552", "title": "Haskell Convert Time milliseconds to UTCTime", "body": "<p>Here's how to create a UTCTime and add a number of seconds to it:</p>\n\n<pre><code>import Data.Time.Calendar\nimport Data.Time.Clock\n\n-- 1/1/1900 as a Day\njan_1_1900_day = fromGregorian 1900 1 1 :: Day\n\n-- 1/1/1900 as a UTCTime\njan_1_1900_time = UTCTime jan_1_1900_day 0\n\nsecs = 86400+3600  -- number of seconds to add to 1/1/1900\n                   -- = 1 day + 1 hour\n\n-- add some seconds to 1/1/1900 00:00:00\nmyTime = addUTCTime (fromIntegral secs) jan_1_1900_time\n\nshowTime t = (utctDay t, utctDayTime t) -- to see inside a UTCTime\n\nmain = do\n  print $ showTime jan_1_1900_time\n  print $ showTime myTime\n</code></pre>\n\n<p>The output is:</p>\n\n<pre><code>(1900-01-01,0s)\n(1900-01-02,3600s)\n</code></pre>\n\n<p>The first argument to <code>addUTCTime</code> is a NominalDiffTime which has both a <code>Num</code> instance and an <code>Enum</code> instance.</p>\n\n<p>Using the <code>Num</code> instance, <code>fromIntegral x</code> will create a NominalDiffTime of <code>x</code> seconds.</p>\n\n<p>Using the <code>Enum</code> instance, <code>toEnum x</code> will create a NominalDiffTime of <code>x</code> picoseconds.</p>\n\n<p>So if you want millisecond resolution on your times, you can use this recipe:</p>\n\n<pre><code>millis = (2*86400+3600)*1000  -- milliseconds to add = 2 days + 1 hour\n\nmyTime' = addUTCTime (toEnum (millis*10^9)) jan_1_1900_time\n</code></pre>\n\n<p>And then <code>print $ showtime myTime'</code> results in:</p>\n\n<pre><code>(1900-01-03,3600s)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 208, "user_id": 1919394, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc537a770ab9eae8847c072c098a3438?s=128&d=identicon&r=PG", "display_name": "Jann M&#252;ller", "link": "https://stackoverflow.com/users/1919394/jann-m%c3%bcller"}, "is_accepted": true, "score": 1, "last_activity_date": 1444808056, "creation_date": 1444808056, "answer_id": 33119292, "question_id": 33117152, "link": "https://stackoverflow.com/questions/33117152/haskell-convert-time-milliseconds-to-utctime/33119292#33119292", "title": "Haskell Convert Time milliseconds to UTCTime", "body": "<p>You can use the function <code>posixSecondsToUTCTime</code> in <a href=\"http://hackage.haskell.org/package/time-1.5.0.1/docs/Data-Time-Clock-POSIX.html\" rel=\"nofollow\">Data.Time.Clock.POSIX</a>. As your value is in milliseconds you need to divide it by 1000 first. Here's an example:</p>\n\n<pre><code>import Data.Time.Clock.POSIX\nimport Data.Time.Clock.UTC\n\nmillisToUTC :: Integer -&gt; UTCTime\nmillisToUTC t = posixSecondsToUTCTime $ (fromInteger t) / 1000\n</code></pre>\n"}], "owner": {"reputation": 375, "user_id": 5287908, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/w0QJd.png?s=128&g=1", "display_name": "QSpider", "link": "https://stackoverflow.com/users/5287908/qspider"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1260, "favorite_count": 0, "accepted_answer_id": 33119292, "answer_count": 2, "score": 2, "last_activity_date": 1444808056, "creation_date": 1444800074, "last_edit_date": 1444803359, "question_id": 33117152, "link": "https://stackoverflow.com/questions/33117152/haskell-convert-time-milliseconds-to-utctime", "title": "Haskell Convert Time milliseconds to UTCTime", "body": "<p>I have time as milliseconds since 1970-01-01 00:00 UTC.\nHow can I convert it to  UTCTime (Integer -> UTCTime)?\nI need UTCTime for inserting it in MongoDB.</p>\n\n<p>Thank you!</p>\n"}, {"tags": ["haskell", "command-prompt"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1444800406, "post_id": 33117046, "comment_id": 54048182, "body": "&quot;doesn&#39;t recognize commands&quot;. Please report what you directly observe (e.g. &quot;the command window displays <i>this message</i>, I type <i>this comnand</i>, the comnand window displays <i>this other message</i>&quot;)."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1444802321, "post_id": 33117046, "comment_id": 54048879, "body": "Please tell us where you are getting the windows installer from. And what is your PATH after you run the installer?"}, {"owner": {"reputation": 929, "user_id": 4560015, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/9190fdd256e98c401eeaf26d571e8e05?s=128&d=identicon&r=PG&f=1", "display_name": "B A", "link": "https://stackoverflow.com/users/4560015/b-a"}, "edited": false, "score": 0, "creation_date": 1444806936, "post_id": 33117046, "comment_id": 54051114, "body": "it says &quot;... is not recognized as an internal or external command, operable program or batch file&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 929, "user_id": 4560015, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/9190fdd256e98c401eeaf26d571e8e05?s=128&d=identicon&r=PG&f=1", "display_name": "B A", "link": "https://stackoverflow.com/users/4560015/b-a"}, "edited": false, "score": 0, "creation_date": 1444831084, "post_id": 33119243, "comment_id": 54066873, "body": "thanks for replying.the installation succeeded. I also ran a hello world program successfully by doing ghci to load the haskell console."}], "tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": false, "score": 1, "last_activity_date": 1444807873, "creation_date": 1444807873, "answer_id": 33119243, "question_id": 33117046, "link": "https://stackoverflow.com/questions/33117046/i-installed-haskells-windows-installer-obtained-from-their-website-after-which/33119243#33119243", "title": "I installed haskell&#39;s windows installer obtained from their website after which the command prompt doesn&#39;t recognize commands", "body": "<blockquote>\n  <p>.is not recognized as an internal or external command, operable program or batch file</p>\n</blockquote>\n\n<p>This is what windows states when the binary location isn't in the system (or user) <code>PATH</code> variable. You'd need to add the location of the <code>ghc</code> and other binaries to that variable; it can be done either by Windows dialog in <code>Control Panel -&gt; System -&gt; Advanced -&gt; Environment Variables</code>, or by using a tool such as <a href=\"http://www.rapidee.com/en/about\" rel=\"nofollow\">Rapid Environment Editor</a>.</p>\n\n<hr>\n\n<p>That being said the location <em>should</em> be added after the default installation, which might suggest the installation failed in one way or another. You could try simply reinstalling and see if it fixes it.</p>\n\n<hr>\n\n<p>To simply see the <code>PATH</code> variable set for the command line, type</p>\n\n<pre><code>echo %PATH%\n</code></pre>\n\n<p>and see if the Haskell-related folder is there.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 14554901, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/c76a8c32deb4cd2037128d5598d41d48?s=128&d=identicon&r=PG", "display_name": "Keryth", "link": "https://stackoverflow.com/users/14554901/keryth"}, "is_accepted": false, "score": 1, "last_activity_date": 1604159392, "creation_date": 1604159392, "answer_id": 64623578, "question_id": 33117046, "link": "https://stackoverflow.com/questions/33117046/i-installed-haskells-windows-installer-obtained-from-their-website-after-which/64623578#64623578", "title": "I installed haskell&#39;s windows installer obtained from their website after which the command prompt doesn&#39;t recognize commands", "body": "<p>I had a similar error and it was because I didn't run the program as an administrator. Afterwords it ran fine.</p>\n"}], "owner": {"reputation": 929, "user_id": 4560015, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/9190fdd256e98c401eeaf26d571e8e05?s=128&d=identicon&r=PG&f=1", "display_name": "B A", "link": "https://stackoverflow.com/users/4560015/b-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3058, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1604159392, "creation_date": 1444799469, "last_edit_date": 1444806964, "question_id": 33117046, "link": "https://stackoverflow.com/questions/33117046/i-installed-haskells-windows-installer-obtained-from-their-website-after-which", "title": "I installed haskell&#39;s windows installer obtained from their website after which the command prompt doesn&#39;t recognize commands", "body": "<p>It doesn't even recognize the default commands like cd etc. I uninstalled haskell and it works fine now. What should i do to get it working with haskell?</p>\n\n<p>EDIT: It says:\n..........is not recognized as an internal or external command, operable program or batch file</p>\n"}, {"tags": ["haskell", "haskell-lens", "lenses"], "comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1444789797, "post_id": 33115595, "comment_id": 54045329, "body": "Try composing with <code>(.)</code> instead of using <code>(^?)</code>."}, {"owner": {"reputation": 790, "user_id": 334632, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/SL2Mb.jpg?s=128&g=1", "display_name": "Joe Hillenbrand", "link": "https://stackoverflow.com/users/334632/joe-hillenbrand"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1444789922, "post_id": 33115595, "comment_id": 54045358, "body": "@ReinHenrichs tried that. &quot;Could not deduce (Applicative f) arising from a use of \u2018ix\u2019 from the context (Functor f)&quot;"}, {"owner": {"reputation": 790, "user_id": 334632, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/SL2Mb.jpg?s=128&g=1", "display_name": "Joe Hillenbrand", "link": "https://stackoverflow.com/users/334632/joe-hillenbrand"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 2, "creation_date": 1444790020, "post_id": 33115595, "comment_id": 54045377, "body": "Wait, that means it&#39;s a Traversal! I got it!"}], "answers": [{"tags": [], "owner": {"reputation": 790, "user_id": 334632, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/SL2Mb.jpg?s=128&g=1", "display_name": "Joe Hillenbrand", "link": "https://stackoverflow.com/users/334632/joe-hillenbrand"}, "is_accepted": true, "score": 5, "last_activity_date": 1444790202, "creation_date": 1444790202, "answer_id": 33115686, "question_id": 33115595, "link": "https://stackoverflow.com/questions/33115595/how-can-i-use-ix-0-in-an-independent-getter/33115686#33115686", "title": "How can I use (^? ix 0) in an independent Getter?", "body": "<p>Turns out I just have to replace the <code>^?</code> with <code>.</code> and change <code>Lens'</code> to <code>Traversal'</code></p>\n\n<pre><code>instPublicIP' :: Traversal' Instance (Maybe Text)\ninstPublicIP' = insNetworkInterfaces . ix 0 . iniAssociation . _Just . iniaPublicIP\n</code></pre>\n"}], "owner": {"reputation": 790, "user_id": 334632, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/SL2Mb.jpg?s=128&g=1", "display_name": "Joe Hillenbrand", "link": "https://stackoverflow.com/users/334632/joe-hillenbrand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 87, "favorite_count": 0, "accepted_answer_id": 33115686, "answer_count": 1, "score": 4, "last_activity_date": 1444790202, "creation_date": 1444789683, "last_edit_date": 1444789773, "question_id": 33115595, "link": "https://stackoverflow.com/questions/33115595/how-can-i-use-ix-0-in-an-independent-getter", "title": "How can I use (^? ix 0) in an independent Getter?", "body": "<p>Sorry for the poorly worded title, but I don't even know how to ask it properly.</p>\n\n<p>How can I turn this?</p>\n\n<pre><code>instPublicIP :: Instance -&gt; Maybe Text\ninstPublicIP inst =\n  inst ^. insNetworkInterfaces ^? ix 0 . iniAssociation . _Just . iniaPublicIP . _Just\n</code></pre>\n\n<p>into this</p>\n\n<pre><code>instPublicIP' :: Lens' Instance (Maybe Text)\ninstPublicIP' = insNetworkInterfaces ^? ix 0 . iniAssociation . _Just . iniaPublicIP . _Just\n</code></pre>\n\n<p>When I try that I get the following error:</p>\n\n<pre><code>Main.hs:198:3:\n    Couldn't match expected type \u2018(Maybe Text -&gt; f (Maybe Text))\n                                  -&gt; Instance -&gt; f Instance\u2019\n                with actual type \u2018Maybe Text\u2019\n    Relevant bindings include\n      instPublicIP' :: (Maybe Text -&gt; f (Maybe Text))\n                       -&gt; Instance -&gt; f Instance\n        (bound at app/Main.hs:197:1)\n    In the expression:\n      insNetworkInterfaces\n      ^? ix 0 . iniAssociation . _Just . iniaPublicIP . _Just\n    In an equation for \u2018instPublicIP'\u2019:\n        instPublicIP'\n          = insNetworkInterfaces\n            ^? ix 0 . iniAssociation . _Just . iniaPublicIP . _Just\n\nMain.hs:198:27:\n    Couldn't match type \u2018InstanceNetworkInterface\u2019\n                   with \u2018Instance -&gt; f0 Instance\u2019\n    Expected type: (InstanceNetworkInterface\n                    -&gt; Const (Data.Monoid.First Text) InstanceNetworkInterface)\n                   -&gt; (([InstanceNetworkInterface] -&gt; f0 [InstanceNetworkInterface])\n                       -&gt; Instance -&gt; f0 Instance)\n                   -&gt; Const\n                        (Data.Monoid.First Text)\n                        (([InstanceNetworkInterface] -&gt; f0 [InstanceNetworkInterface])\n                         -&gt; Instance -&gt; f0 Instance)\n      Actual type: (IxValue\n                      (([InstanceNetworkInterface] -&gt; f0 [InstanceNetworkInterface])\n                       -&gt; Instance -&gt; f0 Instance)\n                    -&gt; Const\n                         (Data.Monoid.First Text)\n                         (IxValue\n                            (([InstanceNetworkInterface] -&gt; f0 [InstanceNetworkInterface])\n                             -&gt; Instance -&gt; f0 Instance)))\n                   -&gt; (([InstanceNetworkInterface] -&gt; f0 [InstanceNetworkInterface])\n                       -&gt; Instance -&gt; f0 Instance)\n                   -&gt; Const\n                        (Data.Monoid.First Text)\n                        (([InstanceNetworkInterface] -&gt; f0 [InstanceNetworkInterface])\n                         -&gt; Instance -&gt; f0 Instance)\n    In the first argument of \u2018(.)\u2019, namely \u2018ix 0\u2019\n    In the second argument of \u2018(^?)\u2019, namely\n      \u2018ix 0 . iniAssociation . _Just . iniaPublicIP . _Just\u2019\n</code></pre>\n"}, {"tags": ["performance", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1444949760, "post_id": 33117381, "comment_id": 54128635, "body": "You reminded me of the existence of <code>$!</code>, that&#39;s going to be useful."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 6, "last_activity_date": 1444801125, "creation_date": 1444801125, "answer_id": 33117381, "question_id": 33115551, "link": "https://stackoverflow.com/questions/33115551/is-it-possible-to-improve-the-asymptotics-of-functional-containers/33117381#33117381", "title": "Is it possible to improve the asymptotics of functional containers?", "body": "<p>On my machine, the following runs only three times slower than your fast code:</p>\n\n<pre><code>mkBox n box  = box n\ngetter' box  = box (\\ x -&gt; x)\ninitial'     = mkBox 1\nstepper' box = mkBox $! getter' box+1\nrun' 0 state = []\nrun' n state = getter' state : run' (n-1) (stepper' state)\nmain         = print $ sum $ run' 50000000 initial'\n</code></pre>\n\n<p>There are two key differences: first, I mirrored the definition <code>stepper (Box x) = Box (x+1)</code>, which could also be written as <code>stepper box = Box (getter box + 1)</code>. To mirror it, I defined a <code>mkBox</code> which mirrors <code>Box</code>. The second key difference is that I explicitly made the argument to <code>mkBox</code> strict; I believe in your fast version GHC's strictness analysis does this behind the scenes.</p>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 3, "accepted_answer_id": 33117381, "answer_count": 1, "score": 6, "last_activity_date": 1444801125, "creation_date": 1444789389, "last_edit_date": 1444789807, "question_id": 33115551, "link": "https://stackoverflow.com/questions/33115551/is-it-possible-to-improve-the-asymptotics-of-functional-containers", "title": "Is it possible to improve the asymptotics of functional containers?", "body": "<p>Mind the following program:</p>\n\n<pre><code>data Box = Box Int\ninitial         = Box 1\nstepper (Box x) = Box (x+1)\ngetter  (Box x) = x\nrun 0 state     = []\nrun n state     = getter state : run (n-1) (stepper state)\nmain            = print $ sum $ run 50000000 initial\n</code></pre>\n\n<p>Here, <code>run</code> is obviously linear, since it is a recurses from <code>0</code> to <code>n</code> and <code>stepper</code> is a constant time function. You can verify that by changing the constant - the runtime changes linearly proportional. Now, mind this code:</p>\n\n<pre><code>initial' box      = box 1\nstepper' box box_ = box (\\ x -&gt; (box_ (x+1)))\ngetter' box       = box (\\ x -&gt; x)\nrun' 0 state      = []\nrun' n state      = getter' state : run' (n-1) (stepper' state)\nmain              = print $ sum $ run' 8000 initial'\n</code></pre>\n\n<p>This is the very same algorithm as the program above, the only thing changed is that a function is used as the container, instead of a datatype. Yet, it is quadratic: <code>stepper' state</code> is never executed, creating a bigger and bigger thunk that is re-evaluated at each step. Both programs take the same amount of time to run, regardless of hugely different constants. I believe the second program could be fixed with a mean of evaluating a term to normal form, but GHC doesn't provide that, so, <strong>is it possible to fix the second program so it is not quadratic anymore?</strong></p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1444777867, "post_id": 33114054, "comment_id": 54042521, "body": "Your code is full of point-free unreadability. Somehow or other, <code>fac</code> is being called with an argument less than 1, causing the list argument to <code>foldr1</code> (a terribly shady function) to be empty."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1444778021, "post_id": 33114054, "comment_id": 54042571, "body": "@dfeuer Bah, I think the only hard to read part is the <code>(==) =&lt;&lt;</code>."}, {"owner": {"reputation": 1381, "user_id": 1936416, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e7314f391870688f6808f07e859927ae?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/1936416/ben"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 1, "creation_date": 1444778789, "post_id": 33114054, "comment_id": 54042772, "body": "@&#216;rjanJohansen I wouldn&#39;t necessarily write it like that in actual &#39;production&#39; code; I do these kinds of exercises mainly to experiment with Haskell. The same goes for the use <code>foldr1 (*)</code> instead of <code>product</code>; your point about <code>foldl&#39;</code> vs <code>foldr</code> however, and @dfeur&#39;s point of the &#39;shadiness&#39; of <code>foldr1</code> is certainly a good one . Had I used <code>product</code> here, I wouldn&#39;t have run into that problem but I also wouldn&#39;t have learnt these things. :)"}], "answers": [{"tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": true, "score": 6, "last_activity_date": 1444777720, "creation_date": 1444777720, "answer_id": 33114080, "question_id": 33114054, "link": "https://stackoverflow.com/questions/33114054/why-does-this-haskell-code-fail/33114080#33114080", "title": "Why does this Haskell code fail?", "body": "<p>Your <code>fac</code> fails with digit <code>0</code>, for which its list is empty. You can try</p>\n\n<pre><code>fac = foldr (*) 1 . enumFromTo 1\n</code></pre>\n\n<p>By the way <code>foldl'</code> (from <code>Data.List</code>) is probably better than <code>foldr</code> here, also there's a predefined <code>product</code> function.</p>\n"}], "owner": {"reputation": 1381, "user_id": 1936416, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e7314f391870688f6808f07e859927ae?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/1936416/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 33114080, "answer_count": 1, "score": 1, "last_activity_date": 1444777720, "creation_date": 1444777545, "question_id": 33114054, "link": "https://stackoverflow.com/questions/33114054/why-does-this-haskell-code-fail", "title": "Why does this Haskell code fail?", "body": "<p>I have the following code (related to Project Euler's problem 34):</p>\n\n<pre><code>fac :: Int -&gt; Int\nfac = foldr1 (*) . enumFromTo 1\n\nfe :: Int -&gt; Bool\nfe = (==) =&lt;&lt; (sum . map fac . digits 10)\n\nfes :: [Int]\nfes = filter fe [3..]\n</code></pre>\n\n<p><code>fac</code> works fine, <code>fe</code> works fine, yet <code>fes</code> gives:</p>\n\n<pre><code>*** Exception: Prelude.foldr1: empty list\n</code></pre>\n\n<p>Interestingly, if I start the list with 145 (<code>fe</code> returns True here), it works for that number, then raises the Exception. </p>\n\n<p>Why does this code fail? It seems like a perfectly normal application of <code>filter</code> with a function that clearly works and a regular list of numbers that work with that function individually.</p>\n"}, {"tags": ["string", "list", "haskell", "char"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1444775400, "post_id": 33113642, "comment_id": 54041734, "body": "The are functionally working the same."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1709237"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1444775682, "post_id": 33113642, "comment_id": 54041842, "body": "I have tried this, it returns that <code>String</code> is <code>Ambiguous</code>"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1444775719, "post_id": 33113642, "comment_id": 54041852, "body": "@anon <code>String</code> is already defined in the standard library, so when you define another <code>String</code> GHC isn&#39;t sure which to use (that&#39;s what the error here means)."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1709237"}, "edited": false, "score": 0, "creation_date": 1444775795, "post_id": 33113642, "comment_id": 54041875, "body": "Ah, so how would I go about clarifying to the compiler which <code>String</code> I mean?"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 1, "creation_date": 1444775910, "post_id": 33113642, "comment_id": 54041915, "body": "@anon It doesn&#39;t really make sense to define <code>String</code> as you have it though. A string is conceptually a list of characters, not a list of lists of characters. That also doesn&#39;t fit with the first part of your question (if <code>String</code> was a synonym for <code>[[Char]]</code> then <code>[String]</code> would not be <code>[[Char]]</code>). With the normal standard library version, <code>[String]</code> and <code>[[Char]]</code> are already identical and interchangeable with each other."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1709237"}, "edited": false, "score": 0, "creation_date": 1444776276, "post_id": 33113642, "comment_id": 54042035, "body": "@DavidYoug When I try to perform a <code>[String]</code> function on the <code>[[Char]]</code> I get an error"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1444776677, "post_id": 33113642, "comment_id": 54042159, "body": "@anon This is not the problem. It looks like you are using something as a function which is not a function or passing too many or too few arguments to a function. Could you post the code causing the error? Note that it is trying to match the <i>entire type</i> on that first line with the type <code>[[Char]]</code>, not just the <code>[String]</code> part."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1709237"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1444776792, "post_id": 33113642, "comment_id": 54042201, "body": "@DavidYoung Yep, no problem, thanks for your help and patients!"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1709237"}, "reply_to_user": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1444777362, "post_id": 33113642, "comment_id": 54042365, "body": "@DavidYoung Nevermind, I was being silly and placed a function in the wrong place, sorry to waste everyone&#39;s time but I appreciate it all the same!"}], "answers": [{"tags": [], "owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "is_accepted": true, "score": 1, "last_activity_date": 1444775378, "creation_date": 1444775378, "answer_id": 33113700, "question_id": 33113642, "link": "https://stackoverflow.com/questions/33113642/how-to-convert-a-nested-list-of-chars-to-a-string-haskell/33113700#33113700", "title": "How to convert a nested list of Chars to a String Haskell", "body": "<p>Those two types are completely identical, because <code>String</code> is a type synonym for <code>[Char]</code>. The definition of <code>String</code> is</p>\n\n<pre><code>type String = [Char]\n</code></pre>\n\n<p>The <code>type</code> keyword means it's a type synonym. A type synonym is always interchangeable with the type it is defined to be.</p>\n\n<p>You can see this in GHCi like this (note that Haskell does not allow casting):</p>\n\n<pre><code>ghci&gt; let test :: [Char];   test = \"abc\"\nghci&gt; test :: String\n\"abc\"\nghci&gt; :t (test :: [Char]) :: String\n(test :: [Char]) :: String :: String\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "is_accepted": false, "score": 0, "last_activity_date": 1444775776, "creation_date": 1444775776, "answer_id": 33113779, "question_id": 33113642, "link": "https://stackoverflow.com/questions/33113642/how-to-convert-a-nested-list-of-chars-to-a-string-haskell/33113779#33113779", "title": "How to convert a nested list of Chars to a String Haskell", "body": "<blockquote>\n  <p>When I try to declare that <code>type String = [[Char]]</code> I get:</p>\n\n<pre><code>Ambiguous occurrence `String'\nIt could refer to either `Main.String', defined at Testing.hs:19:1\n                      or `Prelude.String',\n                         imported from `Prelude' at Testing.hs:16:1-14\n                         (and originally defined in `GHC.Base')\n</code></pre>\n</blockquote>\n\n<p>You are getting this error because your definition of <code>String</code> conflicts with the one already defined in <code>base</code> and exported by the <code>Prelude</code>. Remove your definition and use the one that already exists instead.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1709237"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 650, "favorite_count": 0, "accepted_answer_id": 33113700, "answer_count": 2, "score": 0, "last_activity_date": 1444776208, "creation_date": 1444775089, "last_edit_date": 1444776208, "question_id": 33113642, "link": "https://stackoverflow.com/questions/33113642/how-to-convert-a-nested-list-of-chars-to-a-string-haskell", "title": "How to convert a nested list of Chars to a String Haskell", "body": "<p>I have a simple question, although Lists of <code>Char</code>s seem equivalent to <code>String</code>s, they are not functionally working the same. if I have a nested List of <code>Char</code>s, of type <code>[[Char]]</code> that I would like to convert to a <code>[String]</code>, how would I go about doing this?</p>\n\n<p>When I try to perform a function on the <code>[[Char]]</code> and treat it as though it is a string I get:</p>\n\n<pre><code>Couldn't match expected type `([String] -&gt; (Int, Int, Board)) -&gt; t'\n                with actual type `[[Char]]'\n</code></pre>\n\n<p>When I try to declare that <code>type String = [[Char]]</code> I get:</p>\n\n<pre><code>Ambiguous occurrence `String'\nIt could refer to either `Main.String', defined at Testing.hs:19:1\n                      or `Prelude.String',\n                         imported from `Prelude' at Testing.hs:16:1-14\n                         (and originally defined in `GHC.Base')\n</code></pre>\n"}, {"tags": ["haskell", "guard", "parse-error"], "comments": [{"owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 2, "creation_date": 1444773973, "post_id": 33113428, "comment_id": 54041205, "body": "You appear to be indenting with tabs. Use spaces and it has a higher chance of working. (If you want to use tabs, you have to split things across more lines. Tabs are also bad for alignment.)"}, {"owner": {"reputation": 475, "user_id": 2023986, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/WRgBD.jpg?s=128&g=1", "display_name": "i .", "link": "https://stackoverflow.com/users/2023986/i"}, "reply_to_user": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "edited": false, "score": 0, "creation_date": 1444774122, "post_id": 33113428, "comment_id": 54041260, "body": "replaced tabs with spaces, now have parse error on input &#39;assign&#39; on the third line. so I guess that would be a new question then."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1444774151, "post_id": 33113428, "comment_id": 54041271, "body": "All your <code>assign</code>s have to line up with each other, as do the <code>sameKind</code>s."}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 2, "creation_date": 1444774182, "post_id": 33113428, "comment_id": 54041284, "body": "Your first <code>where</code> (under <code>exec</code>) should be indented more."}, {"owner": {"reputation": 475, "user_id": 2023986, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/WRgBD.jpg?s=128&g=1", "display_name": "i .", "link": "https://stackoverflow.com/users/2023986/i"}, "edited": false, "score": 0, "creation_date": 1444774216, "post_id": 33113428, "comment_id": 54041295, "body": "that one is indented, something must have happened during the copy and paste. Anyways I aligned it and it works great. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 4328, "user_id": 1473927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AO6Ui.jpg?s=128&g=1", "display_name": "Jonathan Cast", "link": "https://stackoverflow.com/users/1473927/jonathan-cast"}, "is_accepted": false, "score": 5, "last_activity_date": 1444774546, "creation_date": 1444774546, "answer_id": 33113547, "question_id": 33113428, "link": "https://stackoverflow.com/questions/33113428/haskell-parse-error-on-input/33113547#33113547", "title": "Haskell: parse error on input &#39;|&#39;", "body": "<p>According to the <a href=\"https://www.haskell.org/onlinereport/syntax-iso.html\" rel=\"noreferrer\">Haskell 98 report</a>:</p>\n\n<blockquote>\n  <p>Tab stops are 8 characters apart.</p>\n</blockquote>\n\n<p>Your code appears to be designed for 5 (?) space tabs; change your editor's tab settings or stop using tabs and the problem will go away.</p>\n\n<p>The reason is: Haskell thinks you indented it like this:</p>\n\n<pre><code>where assign _ _ [] = error (\"undef var \" ++ s)\n        assign s v (x:xs)\n</code></pre>\n\n<p>which, as you can see, means the start of the second definition is still inside the RHS of the first definition.</p>\n\n<p>Also:</p>\n\n<p>Don't do this:</p>\n\n<pre><code>where f [] = one_expr\n      f (x:xn) = another_expr\n</code></pre>\n\n<p>since it can make it hard to pick the <code>where</code> keyword and the first equation apart from each other, and also since it means you depend on what Haskell thinks the relative width of the <code>where</code> keyword and your indentation is, which is what bit you this time.  Tabs are fine in Haskell as long as you only depend on the leading indentation on a given line and are consistent, but that means you <em>always</em> need to have a line break (and further indent) after <code>where</code>, <code>let</code>, <code>case</code>/<code>of</code>, <code>do</code>, and possibly others I'm forgetting.  (Except <code>do</code> and <code>let</code> when the whole construct is on one line, of course).</p>\n"}], "owner": {"reputation": 475, "user_id": 2023986, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/WRgBD.jpg?s=128&g=1", "display_name": "i .", "link": "https://stackoverflow.com/users/2023986/i"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2986, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1444774546, "creation_date": 1444773841, "question_id": 33113428, "link": "https://stackoverflow.com/questions/33113428/haskell-parse-error-on-input", "title": "Haskell: parse error on input &#39;|&#39;", "body": "<p>I have the following code, designed to take a duple from <code>m</code> and replace the the duple that starts with <code>s</code> with the evaluation of expression <code>e</code></p>\n\n<pre><code>exec (Assign s e) m = assign s (eval e m) m\nwhere assign _ _ [] = error (\"undef var \" ++ s)\n    assign s v (x:xs)\n        | fst x == s = if sameKind v (fst x)\n                        then (fst x,v):xs\n                        else error \"type error in assign\"\n        | otherwise = x:(assign s v xs)\n            where sameKind (VInt a) (VInt b) = True\n                sameKind (VBool a) (VBool b) = True\n                sameKind _ _ = False\n</code></pre>\n\n<p>When compiling, I get the error: <code>parse error on input '|'</code></p>\n\n<p>Does anybody know how to fix this?</p>\n"}, {"tags": ["haskell", "ghc", "ghci"], "comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 2, "creation_date": 1444776974, "post_id": 33112477, "comment_id": 54042261, "body": "<code>lens</code> can be bad about this, and often its documentation helpfully lists several alternative simpler types to give intuition. Other than looking at documentation, my tip is to use <code>:i</code> rather than <code>:t</code> for library identifiers, then you get the actual written type signature, which is sometimes less expanded."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1499212953, "post_id": 33112477, "comment_id": 76806918, "body": "Yeah, most of the things in <code>lens</code> in particular are more easily understood as &quot;you can choose this to be any one of this family of types&quot;, rather than the &quot;real&quot; type that manages to unify all of them. Uninformative <code>:type</code> results is just something you have to live with to use <code>lens</code>, unless/until you actually learn a lot more of the theory underpinning its construction (which is otherwise unnecessary to use it effectively)."}, {"owner": {"reputation": 56659, "user_id": 450128, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2f72b3fdc99fe9fd1bbeb2f9da1d2c0a?s=128&d=identicon&r=PG", "display_name": "Ben", "link": "https://stackoverflow.com/users/450128/ben"}, "edited": false, "score": 0, "creation_date": 1499213240, "post_id": 33112477, "comment_id": 76806977, "body": "Regarding &quot;Is it good practice to basically avoid type inferencer with non-trivial types and lookup documentation instead?&quot;, it&#39;s not a matter of &quot;good practice&quot;. I would expect most people use whichever is more helpful/convenient at the time, without worrying about either option being &quot;better&quot;. I use the interpreter a lot while developing, so I will often start with <code>:t</code> if I happen to have a ghci session going. If that doesn&#39;t help (possibly because the type is confusing, but often because the type alone isn&#39;t a complete description of what the thing does), I look up the docs."}], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 4, "last_activity_date": 1444783045, "last_edit_date": 1444783045, "creation_date": 1444773526, "answer_id": 33113359, "question_id": 33112477, "link": "https://stackoverflow.com/questions/33112477/how-to-interpret-types-reported-by-ghci/33113359#33113359", "title": "How to interpret types reported by GHCI", "body": "<p>How ghci describes the type depends on:</p>\n\n<ol>\n<li>Is the referenced module in scope?</li>\n<li>Is the referenced package part of your cabal project?</li>\n</ol>\n\n<p>Here's a situation where you will see an internal type instead of the expected exported type:</p>\n\n<pre><code>=== file B.hs ===\n\nmodule B (hello) where\nimport Data.Text\nhello = pack \"Hello, world\"\n\n=== file A.hs ===\nmodule A where\nimport B\n</code></pre>\n\n<p>and then running <code>ghci A.hs</code> and the command <code>:t hello</code> will report:</p>\n\n<pre><code>ghci&gt; :t hello\nhello :: Data.Text.Internal.Text\n</code></pre>\n\n<p>However, if module A imports Data.Text:</p>\n\n<pre><code>module A where\nimport B\nimport Data.Text\n</code></pre>\n\n<p>then ghci responds to the type inquiry with:</p>\n\n<pre><code>ghci&gt; :t hello\nhello :: Text\n</code></pre>\n\n<p>As for the specific package name appearing in the type's name, that can occur if <code>text</code> is not explicitly mentioned as a dependency in your cabal file, but you import a Data.Text value from another package.</p>\n\n<p>For example, suppose the module B above was part of the <code>hello</code> package, and module A part of a separate package, say <code>uses-hello</code>.</p>\n\n<p>Let's say the <code>uses-hello.cabal</code> file looks like:</p>\n\n<pre><code>=== file uses-hello.cabal ===\n...\nlibrary:\n  exposed-modules: A\n  build-depends: base, hello\n...\n</code></pre>\n\n<p>Note that <code>uses-hello</code> does <em>not</em> list <code>text</code> as a package dependency, but it can use a Text value by importing <code>B</code> from the <code>hello</code> package. If you run <code>cabal repl</code> in the <code>uses-hello</code> package you will get output like this:</p>\n\n<pre><code>$ cabal repl\n*A&gt; :t hello\nhello :: text-1.2.1.1:Data.Text.Internal.Text\n</code></pre>\n"}], "owner": {"reputation": 4471, "user_id": 3858142, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/4c27dead2edf0b6dc28833a694c42ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sevo", "link": "https://stackoverflow.com/users/3858142/sevo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "accepted_answer_id": 33113359, "answer_count": 1, "score": 1, "last_activity_date": 1444783045, "creation_date": 1444769785, "question_id": 33112477, "link": "https://stackoverflow.com/questions/33112477/how-to-interpret-types-reported-by-ghci", "title": "How to interpret types reported by GHCI", "body": "<p>When asking <code>GHCI</code> for a type, I tend to get far from ideal types (e.g. not exactly the thing to put into my function signatures or syntactically similar to documented types of library combinators).</p>\n\n<pre><code>*Main Control.Monad.Shell&gt; :t script\nscript :: Script f -&gt; text-1.2.1.3:Data.Text.Internal.Lazy.Text\n\n*Main Control.Monad.Shell&gt; :t cmd \"echo\" \"foo\"\ncmd \"echo\" \"foo\" :: CmdParams t =&gt; t\n</code></pre>\n\n<p>Why does <code>GHCI</code> show a hidden, internal type (and even package version), but in second case a general type when package was (probably) designed to work with an alias?</p>\n\n<p>Is it good practice to basically avoid type inferencer with non-trivial types and lookup documentation instead?</p>\n\n<p>A more \"popular\" library example:</p>\n\n<pre><code>*Main Control.Lens&gt; :t _2\n_2 :: (Functor f, Field2 s t a b) =&gt; (a -&gt; f b) -&gt; s -&gt; f t\n*Main Control.Lens&gt; :t over\nover :: Profunctor p =&gt; Setting p s t a b -&gt; p a b -&gt; s -&gt; t\n*Main Control.Lens&gt; :t over _2\nover _2 :: Field2 s t a b =&gt; (a -&gt; b) -&gt; s -&gt; t\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 0, "creation_date": 1444812447, "post_id": 33112439, "comment_id": 54054319, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/29970012/in-function-variable-and-application\">() in Function Variable and Application</a>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 0, "creation_date": 1445007018, "post_id": 33112439, "comment_id": 54154248, "body": "@Elyse, I don&#39;t see that question as an ideal dup target. It&#39;s a bit muddled."}], "answers": [{"comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 3, "creation_date": 1444773125, "post_id": 33112489, "comment_id": 54040890, "body": "FTR, it&#39;s Haskell&#39;s equivalent of <i>what C-like languages call <code>void</code></i>... except it&#39;s not really a type at all in those languages. Also, \u201cvoid\u201d a bit of a misnomer, since the unit type is not in fact empty. Haskell also has a <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Data-Void.html\" rel=\"nofollow noreferrer\"><code>Void</code> type</a>, which is really empty (and that means, it behaves very different from <code>()</code> or C-style <code>void</code>)."}, {"owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 3, "creation_date": 1444788472, "post_id": 33112489, "comment_id": 54045043, "body": "The whole <code>Void</code> in Haskell versus <code>void</code> in C and <code>()</code> in Agda versus <code>()</code> in Haskell makes me sad. When I proposed the type that is now <code>Void</code> in Haskell, I called it <code>Zero</code> which is more evocative, if only by counting its (non-bottom) inhabitants. I&#39;m (pleasantly) surprised that it&#39;s in the library at all. It was a practical joke, by which I mean I suggested it as a joke, but it&#39;s also practical."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "edited": false, "score": 2, "creation_date": 1444812221, "post_id": 33112489, "comment_id": 54054192, "body": "@pigworker: perhaps your practical jokes <a href=\"https://xkcd.com/516/\" rel=\"nofollow noreferrer\">need to get a bit less subtle</a>... \u2014 I agree that <code>Zero</code> would probably be a less confusing name to the general programmer populace, but if it weren&#39;t for C, the <code>Void</code> name would be perfectly fine. Of course, what would be really good is if Haskell named the free ADT types consequently \u2013 in particular, <code>Either</code> should always have been <code>+</code>!"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1535008217, "post_id": 33112489, "comment_id": 90909929, "body": "&quot;<code>Either</code>&quot; is better than &quot;<code>+</code>&quot;, for the general programmer populace. You need to be a mathematician to understand what &quot;<code>+</code>&quot; type means, but &quot;<code>Either</code>&quot; actually <i>explains</i> what it is."}], "tags": [], "owner": {"reputation": 357162, "user_id": 28804, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/015c999a9db79ffb3030b3cc207d0be8?s=128&d=identicon&r=PG", "display_name": "mipadi", "link": "https://stackoverflow.com/users/28804/mipadi"}, "is_accepted": false, "score": 5, "last_activity_date": 1444769825, "creation_date": 1444769825, "answer_id": 33112489, "question_id": 33112439, "link": "https://stackoverflow.com/questions/33112439/what-does-mean-in-haskell/33112489#33112489", "title": "What does () mean in Haskell", "body": "<p>It's called the <a href=\"https://en.wikipedia.org/wiki/Unit_type\" rel=\"noreferrer\">\"unit type\"</a>. You can think of it as Haskell's equivalent of <code>void</code>, in some respects. It's a type that has only one value (also <code>()</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 20, "last_activity_date": 1444959867, "last_edit_date": 1444959867, "creation_date": 1444771145, "answer_id": 33112815, "question_id": 33112439, "link": "https://stackoverflow.com/questions/33112439/what-does-mean-in-haskell/33112815#33112815", "title": "What does () mean in Haskell", "body": "<p>If not for the weird special syntax, it could be defined as</p>\n\n<pre><code>data () = ()\n</code></pre>\n\n<p>It's about the most boring type there is. The syntax is supposed to make you think of tuples: <code>(a,b)</code> is a pair, <code>(a,b,c)</code> is a triple, etc., and <code>()</code> is a 0-tuple. The only thing missing is a 1-tuple, which can't have that syntax because it would clash with the usual use of parentheses.</p>\n\n<p><code>()</code> is very often used as the result of something that has no interesting result. For example, an <code>IO</code> action that is supposed to perform some I/O and terminate without producing a result will typically have type <code>IO ()</code>. It can also be used when you need some uninteresting input; GHC has special syntax for this, but in Haskell 98 the way to mimic Lisp's <code>cond</code> is like this:</p>\n\n<pre><code>case () of\n  () | c1 -&gt; e1\n     | c2 -&gt; e2\n     ...\n     | otherwise -&gt; e3\n</code></pre>\n\n<p>It's perfectly valid, but also perfectly boring, to ask what value of type <code>()</code> you have; there's only one legitimate one that you could have.</p>\n\n<p>From the \"Haskell-as-almost-category\" standpoint, <code>()</code> is a <em>final object</em>. That is, for any type <code>X</code>, there is <em>exactly one</em> legitimate function of type <code>X -&gt; ()</code>, namely <code>const ()</code>. From the other direction, the <code>Void</code> type pigworker mentions is an <em>initial object</em>. For any type <code>X</code>, there is <em>exactly one</em> legitimate function of type <code>Void -&gt; X</code>, namely <code>absurd</code>. If you're in the mood for categorical reasoning, initial and final objects can be useful to have around.</p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 5, "last_activity_date": 1444773913, "last_edit_date": 1444773913, "creation_date": 1444773595, "answer_id": 33113370, "question_id": 33112439, "link": "https://stackoverflow.com/questions/33112439/what-does-mean-in-haskell/33113370#33113370", "title": "What does () mean in Haskell", "body": "<p>There are excellent search engines specialised for Haskell.</p>\n\n<p><a href=\"http://hayoo.fh-wedel.de/?query=%28%29\" rel=\"nofollow\">http://hayoo.fh-wedel.de/?query=()</a> will give you immediately the correct answer:</p>\n\n<blockquote>\n  <p><code>Data</code> <a href=\"http://hackage.haskell.org/package/ghc-prim/docs/GHC-Tuple.html#t:-40--41-\" rel=\"nofollow\"><code>()</code></a>\n  <br>ghc-prim -GHC.Tuple<br>\n  <hr>\n  The unit datatype <code>()</code> has one non-undefined member, the nullary constructor <code>()</code>.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1444805987, "post_id": 33115522, "comment_id": 54050579, "body": "What was your suggestion? <code>False</code>? <code>Initial</code>? <code>Ridiculous</code>?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1444807047, "post_id": 33115522, "comment_id": 54051179, "body": "May I suggest &quot;died in an explosion and gone to heaven&quot;?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 3, "creation_date": 1446902860, "post_id": 33115522, "comment_id": 54942752, "body": "The only place where <code>()</code> is <code>Reassuring</code> rather than <code>Boring</code> would be <a href=\"https://hackage.haskell.org/package/deepseq-1.4.1.2/docs/Control-DeepSeq.html#v:rnf\" rel=\"nofollow noreferrer\"><code>rnf</code></a>."}, {"owner": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1448485945, "post_id": 33115522, "comment_id": 55613851, "body": "@dfeuer The principle of explosion, I presume."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 9455, "user_id": 1172541, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/LROoN.png?s=128&g=1", "display_name": "PyRulez", "link": "https://stackoverflow.com/users/1172541/pyrulez"}, "edited": false, "score": 0, "creation_date": 1448510616, "post_id": 33115522, "comment_id": 55621427, "body": "@PyRulez, yes, that&#39;s the idea. Ex falso quodlibet."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1519418516, "post_id": 33115522, "comment_id": 84918598, "body": "I just realized that <code>Void</code> is itself dually boring as a contravariant argument. Having something of type <code>Void -&gt; A</code> is as boring as having something of type <code>()</code>. This can also be used to think about surrounding structure. For example, given <code>data Foo a = Foo Int (a -&gt; Bool)</code>, <code>Foo Void</code> is pretty much the same a <code>Int</code>; there&#39;s a function in there, but you can never call it."}], "tags": [], "owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "is_accepted": false, "score": 35, "last_activity_date": 1444789196, "creation_date": 1444789196, "answer_id": 33115522, "question_id": 33112439, "link": "https://stackoverflow.com/questions/33112439/what-does-mean-in-haskell/33115522#33115522", "title": "What does () mean in Haskell", "body": "<p><code>()</code> means \"Boring\". It means the boring type which contains one thing, also boring. There is nothing interesting to be gained by comparing one element of the boring type with another, because there is nothing to learn about an element of the boring type by giving it any of your attention.</p>\n\n<p>It is very different from the empty type, called (by people I wish had chosen a better name like the one I suggested) in Haskell <code>Void</code>. The empty type is very exciting, because if somebody ever gives you a value belonging to it, you know that you are already dead and in Heaven and that anything you want is yours.</p>\n\n<p>But if somebody gives you a value in <code>()</code>, don't get excited. Just throw it away.</p>\n\n<p>Sometimes it's fun to take type constructors parametrised by an \"element type\" and fill the parameter in with <code>()</code>. You can see just what information is inherent in the type constructor, rather than coming from the elements. E.g, <code>Maybe ()</code> is a version of <code>Bool</code>, with <code>Just ()</code> or <code>Nothing</code>. Also, <code>[()]</code> amounts to the (possibly infinite) natural numbers: the only information you have is a length.</p>\n\n<p>So, <code>()</code> means \"Boring\", but it's often a clue that something interesting is happening somewhere else.</p>\n"}], "owner": {"reputation": 1642, "user_id": 1816721, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/emgtc.png?s=128&g=1", "display_name": "Lara", "link": "https://stackoverflow.com/users/1816721/lara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4373, "favorite_count": 2, "accepted_answer_id": 33112815, "answer_count": 4, "score": 12, "last_activity_date": 1446902727, "creation_date": 1444769642, "last_edit_date": 1446902727, "question_id": 33112439, "link": "https://stackoverflow.com/questions/33112439/what-does-mean-in-haskell", "title": "What does () mean in Haskell", "body": "<p>In some Haskell code I came across:</p>\n\n<pre><code>put :: s -&gt; m ()\n</code></pre>\n\n<p>What does the <code>()</code> mean here?</p>\n\n<p>I'd use a search engine, but I can't find one that handles <code>()</code> correctly.</p>\n"}, {"tags": ["haskell", "serialization"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1444770590, "post_id": 33111789, "comment_id": 54039621, "body": "You might want to look through the full <a href=\"https://hackage.haskell.org/packages/#cat:Serialization\" rel=\"nofollow noreferrer\">Serialization category</a> on Hackage if you haven&#39;t yet. How confident are you that the problem is with serialization per se, and not with the way the serialized data are output? Can you show a code sample? Also, if you need to serialize a huge amount of data you almost never need to read, that suggests it might be worth the time to consider some sort of asymmetric compression algorithm that makes encoding very fast, if space matters to you."}, {"owner": {"reputation": 7714, "user_id": 149901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d1a6db7a9fb5385fde6ba426e27d5ac6?s=128&d=identicon&r=PG", "display_name": "ondra", "link": "https://stackoverflow.com/users/149901/ondra"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444775371, "post_id": 33111789, "comment_id": 54041726, "body": "I went through it and the only interesting is <code>beamable</code> (based on bytestring builder, so there is good chance it would work fast), that is unfortunately unmaintained and it doesn&#39;t compile on ghc 7.10. As for the performance - I am sure. I have written a test case that encodes the array and output ByteString length on the result."}, {"owner": {"reputation": 155, "user_id": 1109806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74a1ed4e0d62a902b973b41c0bbc7ad4?s=128&d=identicon&r=PG", "display_name": "CLF", "link": "https://stackoverflow.com/users/1109806/clf"}, "edited": false, "score": 0, "creation_date": 1445421739, "post_id": 33111789, "comment_id": 54313941, "body": "What is your bottleneck? Writing to disk or the CPU time spent marshalling the data?"}, {"owner": {"reputation": 155, "user_id": 1109806, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/74a1ed4e0d62a902b973b41c0bbc7ad4?s=128&d=identicon&r=PG", "display_name": "CLF", "link": "https://stackoverflow.com/users/1109806/clf"}, "edited": false, "score": 0, "creation_date": 1445422199, "post_id": 33111789, "comment_id": 54314241, "body": "Why I asked:  If you have fast disks then you can Show the data in its full bloat and then compress later on. I seem to remember that Show performs well if output size is not a concern, but I can&#39;t find the reference."}, {"owner": {"reputation": 7714, "user_id": 149901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d1a6db7a9fb5385fde6ba426e27d5ac6?s=128&d=identicon&r=PG", "display_name": "ondra", "link": "https://stackoverflow.com/users/149901/ondra"}, "edited": false, "score": 0, "creation_date": 1445426622, "post_id": 33111789, "comment_id": 54317109, "body": "The bottleneck is CPU when serializing the data. Show will be very slow as it outputs to String; aeson outputs to ByteString Builder which is very fast these days. I am sending the output to other process (postgresql) so smaller output would obviously improve performance (less data to manipulate - less CPU cycles burned), but the main concern is CPU cycles, compression wouldn&#39;t help here. I will write a serializer based on msgpack when I get some time off."}], "owner": {"reputation": 7714, "user_id": 149901, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d1a6db7a9fb5385fde6ba426e27d5ac6?s=128&d=identicon&r=PG", "display_name": "ondra", "link": "https://stackoverflow.com/users/149901/ondra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1094, "favorite_count": 0, "answer_count": 0, "score": 6, "last_activity_date": 1444891436, "creation_date": 1444767216, "last_edit_date": 1444891436, "question_id": 33111789, "link": "https://stackoverflow.com/questions/33111789/efficient-data-serialization-in-haskell", "title": "Efficient data serialization in haskell", "body": "<p>I need to serialize a long list of relatively flat structures (it can be recursive, but most of time it isn't) - it's just a <code>Map</code> with sum types for number, text, bytestring, bool, utctime (and some sets and lists) as values. The key is that most of the time I will be just serializing the data and almost never read it so I need the serialization to be as fast as possible.</p>\n\n<p>Originally I used <code>safecopy</code>, then I switched to <code>binary</code> (<code>Generic</code> instances), and in the end I tried <code>aeson</code> (0.10.0.0 HEAD - 0.10 has significantly faster encoding, the HEAD has a fixed instance for <code>UTCTime</code>). The <code>aeson</code> serialization outperforms both binary and <code>safecopy</code> (that's based on <code>cereal</code>) by a factor of 2, while providing shorter output.</p>\n\n<p>I don't want to encode it to JSON, as by default my JSON encoding is lossy, so I would have to write a second encoder and parser to handle the sum types, but it's probably doable - maybe I could even use the generic instance from the <code>aeson</code> package. But I still wonder - is there any serialization method that would provide shorter output (the output is sent to DB, shorter output - better) while being faster than aeson? I didn't try <code>msgpack</code> yet, but it is based on <code>binary</code> so I don't have much faith in it.</p>\n\n<p>Update: Provisionally, I ended up using <code>aeson</code>. Surprisingly it was faster than <code>BufferBuilder</code> (which was still faster than <code>binary</code>). I couldn't use the generic instance as I didn't want to define <code>ToJSON</code> for <code>ByteString</code> - so I ended writing the whole instance by hand. It seem to me that something like <code>msgpack</code> built on the same base as <code>aeson</code> would be a nice way to serialize data.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 1, "creation_date": 1444766850, "post_id": 33111620, "comment_id": 54037565, "body": "<a href=\"http://stackoverflow.com/questions/33110098/i-nee-to-convert-lower-case-char-into-an-uppercase-list-string-in-haskell\" title=\"i nee to convert lower case char into an uppercase list string in haskell\">stackoverflow.com/questions/33110098/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 0, "creation_date": 1444767121, "post_id": 33111730, "comment_id": 54037728, "body": "Thanks @karakfa, I noticed that just a second before your comment."}, {"owner": {"reputation": 27, "user_id": 4275883, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/XJMWh.jpg?s=128&g=1", "display_name": "caz", "link": "https://stackoverflow.com/users/4275883/caz"}, "edited": false, "score": 0, "creation_date": 1444767610, "post_id": 33111730, "comment_id": 54038002, "body": "yes I&#39;m &quot;trying&quot; to use                                                                                                                    <code>up :: Char -&gt; Char       up x = chr ((ord x)- 32)</code> to change lower case into uppercase and use this as an auxiliary function to compensate for the capitalisation. How would I use the up function within this to do so?"}, {"owner": {"reputation": 27, "user_id": 4275883, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/XJMWh.jpg?s=128&g=1", "display_name": "caz", "link": "https://stackoverflow.com/users/4275883/caz"}, "edited": false, "score": 0, "creation_date": 1444767701, "post_id": 33111730, "comment_id": 54038058, "body": "also I&#39;m getting this error: <code>Inferred type is not general enough *** Expression    : letter *** Expected type : a -&gt; [String] *** Inferred type : Char -&gt; [String] </code>"}], "tags": [], "owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "is_accepted": true, "score": 0, "last_activity_date": 1444768487, "last_edit_date": 1444768487, "creation_date": 1444766983, "answer_id": 33111730, "question_id": 33111620, "link": "https://stackoverflow.com/questions/33111620/i-need-a-function-to-change-any-lower-case-letter-typed-inand-will-only-be-one/33111730#33111730", "title": "I need a function to change any lower case letter typed in(and will only be one) into a list of strings", "body": "<p>You have several issues. GHC should have given you a warning about overlapping definitions for <code>letter</code>, which should tip you off:</p>\n\n<p><code>a</code> and <code>b</code> are <em>patterns</em>, not the characters <code>'a'</code> and <code>'b'</code>. </p>\n\n<p>You need something more like:</p>\n\n<pre><code>letter :: Char -&gt; [String] \nletter 'a' = [\"AAA\",\"A A\"]\nletter 'b' = [\"BBB\",\"BBBB\"]\n</code></pre>\n\n<p>There are other options such as pattern guards or case statements, but simple pattern matching seems simplest here.</p>\n\n<p>Also note the capitalization on <code>Char</code>. Types that start with a letter must be upper case.</p>\n"}], "owner": {"reputation": 27, "user_id": 4275883, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/XJMWh.jpg?s=128&g=1", "display_name": "caz", "link": "https://stackoverflow.com/users/4275883/caz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 33111730, "answer_count": 1, "score": 0, "last_activity_date": 1444768487, "creation_date": 1444766621, "last_edit_date": 1444766760, "question_id": 33111620, "link": "https://stackoverflow.com/questions/33111620/i-need-a-function-to-change-any-lower-case-letter-typed-inand-will-only-be-one", "title": "I need a function to change any lower case letter typed in(and will only be one) into a list of strings", "body": "<p>I need a function to change any lower case letter typed in(and will only be one) into a list of strings. Here is what I have so far:</p>\n\n<pre><code>letter :: char -&gt; [String] \nletter a = ([\"AAA\",\"A A\"])\nletter b = ([\"BBB\",\"BBBB\"])\n</code></pre>\n\n<p>When I type in 'b' it still give me the output of a i.e. </p>\n\n<pre><code>  letter 'b'\n [\"AAA\",\"A A\"]\n</code></pre>\n\n<p>Why is this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 2, "creation_date": 1444762601, "post_id": 33110483, "comment_id": 54035245, "body": "What is <code>m</code> in your <code>transform</code> method?  Is it an arbitrary monad?  Could you just use the <code>Identity</code> monad?"}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1444762601, "post_id": 33110483, "comment_id": 54035248, "body": "If you really mean <code>transform :: Monad m =&gt; (Exp -&gt; m Exp) -&gt; Exp -&gt; m Exp</code>, then you can instantiate <code>m</code> with <code>Identity</code> and get your <code>map</code>."}, {"owner": {"reputation": 878, "user_id": 1655480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/39c0e81573717c00f8f89f3525f00e46?s=128&d=identicon&r=PG", "display_name": "Lykos", "link": "https://stackoverflow.com/users/1655480/lykos"}, "edited": false, "score": 0, "creation_date": 1444762769, "post_id": 33110483, "comment_id": 54035327, "body": "Yes, m is an arbitrary monad, so I can choose it for the implementation of the map function. But how exactly would I do that? Sorry, it is probably really obvious, but I am somehow confused because I probably thought too long about it already."}], "answers": [{"comments": [{"owner": {"reputation": 878, "user_id": 1655480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/39c0e81573717c00f8f89f3525f00e46?s=128&d=identicon&r=PG", "display_name": "Lykos", "link": "https://stackoverflow.com/users/1655480/lykos"}, "edited": false, "score": 0, "creation_date": 1444763486, "post_id": 33110622, "comment_id": 54035739, "body": "No, there are no constraints on m. After all, I wrote my transform operation in this way in order to support different kinds of monads. Thanks a lot. The key part that I didn&#39;t see was how to &quot;take it out&quot; of the monad again. But runIdentity solves this, so thanks for that!"}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 5, "last_activity_date": 1444762952, "creation_date": 1444762952, "answer_id": 33110622, "question_id": 33110483, "link": "https://stackoverflow.com/questions/33110483/transform-stateless-function-to-stateful-one/33110622#33110622", "title": "Transform stateless function to stateful one", "body": "<p>If that is the actual type of <code>transform</code>, then you should be able to do something like this:</p>\n\n<pre><code>Control.Monad.Identity&gt; :t transform\ntransform :: (Exp -&gt; m Exp) -&gt; Exp -&gt; m Exp\nControl.Monad.Identity&gt; :t \\f -&gt; runIdentity . transform (Identity . f)\n\\f -&gt; runIdentity . transform (Identity . f)\n  :: (Exp -&gt; Exp) -&gt; Exp -&gt; Exp\n</code></pre>\n\n<p>However, it's possible that you have other constraints on <code>m</code> that you haven't written in the question that may rule out <code>Identity</code>.</p>\n"}], "owner": {"reputation": 878, "user_id": 1655480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/39c0e81573717c00f8f89f3525f00e46?s=128&d=identicon&r=PG", "display_name": "Lykos", "link": "https://stackoverflow.com/users/1655480/lykos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 33110622, "answer_count": 1, "score": 0, "last_activity_date": 1444762952, "creation_date": 1444762487, "question_id": 33110483, "link": "https://stackoverflow.com/questions/33110483/transform-stateless-function-to-stateful-one", "title": "Transform stateless function to stateful one", "body": "<p>I am currently writing a compiler in Haskell as a toy project and I have a function that does a stateful transformation with the signature:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>transform :: (Exp -&gt; m Exp) -&gt; Exp -&gt; m Exp\n</code></pre>\n\n<p>This allows me to implement the following types of operations on top of it:</p>\n\n<ul>\n<li>Accumulate results, e.g. get a list of functions that are called inside an expression.</li>\n<li>Do transformations that can return errors, e.g. type annotation that either returns an AST with types or with an error describing type problems.</li>\n<li>transformations that depend on previously done transformations, e.g. deduplicating variable names when generating test input.</li>\n<li>I hope it will also allow me to do stateless computations in an elegant way.</li>\n</ul>\n\n<p>But somehow, even though this must be really easy, I am stuck on creating a stateless map function based upon the aforementioned transform method that has the following signature:</p>\n\n<pre><code>map :: (Exp -&gt; Exp) -&gt; Exp -&gt; Exp\n</code></pre>\n\n<p>I would prefer not to have the same logic on how to traverse the children in map again but really implement it on top of transform.</p>\n"}, {"tags": ["arrays", "list", "haskell", "flatten"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1709237"}, "edited": false, "score": 0, "creation_date": 1444767039, "post_id": 33110238, "comment_id": 54037684, "body": "I have updated the question I asked prior to this so it is no longer a repeat, the previous question did not go over flattening in a manner which worked for my code."}], "answers": [{"tags": [], "owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "is_accepted": true, "score": 0, "last_activity_date": 1444762485, "creation_date": 1444762485, "answer_id": 33110481, "question_id": 33110238, "link": "https://stackoverflow.com/questions/33110238/flattening-a-2d-array-haskell/33110481#33110481", "title": "Flattening a 2D array Haskell", "body": "<p>You can generalize this functionality quite a bit, for any tuple of indices, any array type and any element type:</p>\n\n<pre><code>import Data.Array.Unboxed \n\nflatten2D :: (Enum i0, Enum i1, Ix i0, Ix i1, IArray arr x) \n          =&gt; arr (i0, i1) x -&gt; [[x]]\nflatten2D arr = [ [ arr ! (i0, i1) | i0 &lt;- [min0..max0] ] | i1 &lt;- [min1..max1] ]\n  where ((min0, min1), (max0, max1)) = bounds arr \n</code></pre>\n\n<p>The implementation is straightforward: the indices lists are constructed using the <code>Enum</code> instance from a minimum and maximum bound. Then you simply get the element at each index. A nested list comprehension accomplishes this in a very nice way.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1709237"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 416, "favorite_count": 0, "closed_date": 1444763050, "accepted_answer_id": 33110481, "answer_count": 1, "score": 1, "last_activity_date": 1563081156, "creation_date": 1444761646, "last_edit_date": 1563081156, "question_id": 33110238, "link": "https://stackoverflow.com/questions/33110238/flattening-a-2d-array-haskell", "closed_reason": "Duplicate", "title": "Flattening a 2D array Haskell", "body": "<p>I currently have a 2D array of the form <code>UArray (Int, Int) Char</code>, I would like to turn this into a <code>List</code> like so:</p>\n\n<pre><code>[\"ffffffffff\",\n\"ffffffffff\",\n\"ffffffffff\",\n\"ffffffffff\",\n\"ffffffffff\",\n\"ffffffffff\",\n\"ffffffffff\",\n\"ffffffffff\",\n\"ffffffffff\",\n\"ffffffffff\"]\n</code></pre>\n\n<p>Each <code>f</code> is originally a character in the UArray.</p>\n\n<p>Where the <code>Char</code>s for each line in the 2D array is turned into a <code>String</code>, which, in turn is parsed into a <code>List</code> as such <code>[String]</code>, however, I have had no luck with the <code>toList</code> method from <code>Data.Foldable</code>, what functions should I be looking at to achieve this?</p>\n\n<p>Thanks for any help!</p>\n"}, {"tags": ["loops", "haskell", "for-loop", "while-loop"], "answers": [{"tags": [], "owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "is_accepted": false, "score": 3, "last_activity_date": 1444761634, "creation_date": 1444761634, "answer_id": 33110235, "question_id": 33110161, "link": "https://stackoverflow.com/questions/33110161/while-and-return-in-a-loop-haskell/33110235#33110235", "title": "while and return in a loop (Haskell)", "body": "<p>Assuming with <code>return</code> you actually mean Python-like <code>yield</code>, otherwise the algorithm wouldn't make sense.</p>\n\n<p>Using <code>do</code> notation, this is very straightforward:</p>\n\n<pre><code>do\n    i &lt;- [0..100]\n    j &lt;- [0..100]\n    k &lt;- takeWhile (\\k -&gt; f i j k &gt; 0) [0..]\n    return (i, j, k)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 2, "last_activity_date": 1444761767, "creation_date": 1444761767, "answer_id": 33110277, "question_id": 33110161, "link": "https://stackoverflow.com/questions/33110161/while-and-return-in-a-loop-haskell/33110277#33110277", "title": "while and return in a loop (Haskell)", "body": "<p>Untested:</p>\n\n<pre><code>[ (i,j,k) |\n  i &lt;- [0 .. 100],\n  j &lt;- [0 .. 100],\n  k &lt;- takeWhile (\\k -&gt; f i j k &gt; 0) [0 ..] ]\n</code></pre>\n\n<p>This is a list comprehension that loops over <code>i</code>/<code>j</code> in the obvious way, and uses <code>takeWhile</code> to limit <code>k</code> by the result of <code>f</code>.</p>\n"}], "owner": {"reputation": 579, "user_id": 5217363, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/afdb988af8695ba91b4cc8fbaba47eef?s=128&d=identicon&r=PG&f=1", "display_name": "CYC", "link": "https://stackoverflow.com/users/5217363/cyc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "closed_date": 1444762718, "accepted_answer_id": 33110277, "answer_count": 2, "score": 0, "last_activity_date": 1444761767, "creation_date": 1444761392, "question_id": 33110161, "link": "https://stackoverflow.com/questions/33110161/while-and-return-in-a-loop-haskell", "closed_reason": "Duplicate", "title": "while and return in a loop (Haskell)", "body": "<p>How to code the following pseudo-code elegantly in Haskell?</p>\n\n<pre><code>for (i from 0 to 100):\n    for (j from 0 to 100):\n        k=0\n        while ( f(i,j,k) &gt;0 ):\n            return (i,j,k)\n            k+=1\n</code></pre>\n\n<p>where <code>f</code> is an unimportant function of <code>i</code>,<code>j</code>and <code>k</code>.</p>\n\n<p>So it should output something like this: <code>[(0,0,0),(0,0,1)..]</code>, a list with each element a tuple formed by <code>i</code>,<code>j</code>and<code>k</code>. (It's fine if it were of the form <code>[[0,0,0],[0,0,1]...]</code> instead of tuples.)</p>\n"}, {"tags": ["loops", "haskell", "for-loop", "while-loop"], "answers": [{"tags": [], "owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "is_accepted": true, "score": 2, "last_activity_date": 1444757415, "last_edit_date": 1444757415, "creation_date": 1444757060, "answer_id": 33108874, "question_id": 33108717, "link": "https://stackoverflow.com/questions/33108717/while-in-a-loop-in-haskell/33108874#33108874", "title": "While in a loop in Haskell", "body": "<p>Here's a way that only computes <code>f</code> once for each pair:</p>\n\n<pre><code>inner i = sum $ takeWhile (&gt; 0) $ map (f i) [0..]\nx= sum $ map inner [0..100]\n</code></pre>\n\n<p>I dislike list comprehensions, especially for more complex expressions, so I found your solution difficult to read. The primary difference is that instead of storing a list of <code>j</code>s such that <code>f i j &gt; 0</code>, I stored the actual function value. This does no more work due to laziness.</p>\n"}, {"tags": [], "owner": {"reputation": 4185, "user_id": 1424121, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c6f5c5cd761b9ce4493fd875cc041ac3?s=128&d=identicon&r=PG", "display_name": "ryachza", "link": "https://stackoverflow.com/users/1424121/ryachza"}, "is_accepted": false, "score": 0, "last_activity_date": 1444762129, "last_edit_date": 1444762129, "creation_date": 1444760902, "answer_id": 33110010, "question_id": 33108717, "link": "https://stackoverflow.com/questions/33108717/while-in-a-loop-in-haskell/33110010#33110010", "title": "While in a loop in Haskell", "body": "<p>For fun the most direct translation I could come up with was:</p>\n\n<pre><code>f i j = 100 - i - j\n\ntest x =\n  foldr (\\i -&gt;\n      foldr (\\j g -&gt;\n          let y = f i j in\n          if y &gt; 0 then g . (+ y) else id\n        ) id [0..]\n    ) x [0..100]\n\nx = test 0\n</code></pre>\n\n<p>Or with some helpers:</p>\n\n<pre><code>f i j = 100 - i - j\n\nfor :: (Enum i) =&gt; i -&gt; i -&gt; (i -&gt; a -&gt; a) -&gt; a -&gt; a\nfor i1 i2 f x = foldr f x [i1..i2]\n\nwhile :: i -&gt; (i -&gt; i) -&gt; (i -&gt; Bool) -&gt; (i -&gt; a -&gt; a) -&gt; a -&gt; a\nwhile i s p f x =\n  foldr (\\i g x -&gt;\n      if p i then g (f i x) else x\n    ) id (iterate s i) x\n\ntest =\n  for 0 100 $ \\i -&gt;\n    while 0 (+ 1) (\\j -&gt; f i j &gt; 0) $ \\j x -&gt;\n      x + f i j\n\nx = test 0\n</code></pre>\n"}], "owner": {"reputation": 579, "user_id": 5217363, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/afdb988af8695ba91b4cc8fbaba47eef?s=128&d=identicon&r=PG&f=1", "display_name": "CYC", "link": "https://stackoverflow.com/users/5217363/cyc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 165, "favorite_count": 0, "accepted_answer_id": 33108874, "answer_count": 2, "score": 0, "last_activity_date": 1444762129, "creation_date": 1444756530, "last_edit_date": 1444756846, "question_id": 33108717, "link": "https://stackoverflow.com/questions/33108717/while-in-a-loop-in-haskell", "title": "While in a loop in Haskell", "body": "<p>How to code the following pseudo-code in Haskell?</p>\n\n<pre><code>x=0\nfor (i from 0 to 100):\n    j=0\n    while ( f(i,j) &gt;0 ):\n      x+= f(i,j)\n      j+=1\n</code></pre>\n\n<p>(<code>f</code> some unimportant function.)</p>\n\n<p>I came up with something like this:</p>\n\n<pre><code>a= [x| i&lt;-[0..100], let s = takeWhile (\\k-&gt; (f i k &gt; 0)) [0..],\n        j&lt;- s, let x = f i j ]\n</code></pre>\n\n<p>Then <code>Sum a</code> does the work, but I need to compute <code>f i j</code> two times which is a little bit redundant. </p>\n\n<p>Can this be done with <code>f</code> computed only once or some better codes that run faster?  </p>\n"}, {"tags": ["haskell", "assert"], "comments": [{"owner": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 1, "creation_date": 1444757038, "post_id": 33108566, "comment_id": 54032191, "body": "You could always write <code>verify cond result = if cond then result else error &quot;Failure&quot;</code> and use that..."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 171740, "user_id": 869736, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/671f732e3c68c387c702112a30e5ebd8?s=128&d=identicon&r=PG&f=1", "display_name": "Louis Wasserman", "link": "https://stackoverflow.com/users/869736/louis-wasserman"}, "edited": false, "score": 0, "creation_date": 1444757340, "post_id": 33108566, "comment_id": 54032352, "body": "@LouisWasserman: Yeah, I guess I just wasn&#39;t understanding the <code>assert</code> idiom in Haskell (which really isn&#39;t that different from some other languages actually): it&#39;s a &quot;never should happen&quot; test that&#39;s verified during development, but isn&#39;t really intended for release \u2014 I gather."}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 6, "last_activity_date": 1444761242, "last_edit_date": 1444761242, "creation_date": 1444757747, "answer_id": 33109070, "question_id": 33108566, "link": "https://stackoverflow.com/questions/33108566/is-there-a-way-to-leave-assert-enabled-in-my-hackage-package/33109070#33109070", "title": "Is there a way to leave &#39;assert&#39; enabled in my Hackage package?", "body": "<p>If you want to, you can specify <code>-fno-ignore-asserts</code>. This is probably best done per-file, with a pragma:</p>\n\n<pre><code>{-# OPTIONS_GHC -fno-ignore-asserts #-}\n</code></pre>\n\n<p>You really shouldn't leave assertions active in any module that uses them in anything that could potentially be used in a tight loop.</p>\n"}], "owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 1, "accepted_answer_id": 33109070, "answer_count": 1, "score": 3, "last_activity_date": 1444761242, "creation_date": 1444756055, "last_edit_date": 1495541671, "question_id": 33108566, "link": "https://stackoverflow.com/questions/33108566/is-there-a-way-to-leave-assert-enabled-in-my-hackage-package", "title": "Is there a way to leave &#39;assert&#39; enabled in my Hackage package?", "body": "<p>I have a Haskell package in which I perform some checks using <code>assert</code>, but when my package is built on clients' machines, these are generally \u2014\u00a0<a href=\"https://stackoverflow.com/q/32727418/656912\">because of, I gather, optimizations</a> \u2014 turned into no-ops.</p>\n\n<p>Is there a way to persevere <code>assert</code> my Hackage package when it is installed on others' machines; or perhaps an alternate approach I can use with the same effect?</p>\n"}, {"tags": ["postgresql", "haskell", "exception"], "answers": [{"comments": [{"owner": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "edited": false, "score": 0, "creation_date": 1444755341, "post_id": 33108374, "comment_id": 54031256, "body": "What if I only want to catch them if they are one of those 4 types?"}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "edited": false, "score": 0, "creation_date": 1444756179, "post_id": 33108374, "comment_id": 54031713, "body": "@SeanClarkHess Added some about that."}], "tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": true, "score": 6, "last_activity_date": 1444756158, "last_edit_date": 1444756158, "creation_date": 1444755317, "answer_id": 33108374, "question_id": 33108196, "link": "https://stackoverflow.com/questions/33108196/catching-exceptions-of-multiple-types/33108374#33108374", "title": "Catching exceptions of multiple types", "body": "<p>GHC's <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/libraries/base-4.8.1.0/Control-Exception.html\"><code>Exception</code> class forms a hierarchy</a>, with the <code>SomeException</code> type at the top. So to catch any exception whatsoever, use that:</p>\n\n<pre><code>postgresErr :: SomeException -&gt; ServantErr\n</code></pre>\n\n<p>(Ideally <code>postgresql-simple</code> could have added its own intermediate catch-all exception type that you could use, but I couldn't see any.)</p>\n\n<p>If you want to catch <em>exactly</em> those four, the best way I know is to use the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/libraries/base-4.8.1.0/Control-Exception.html#v:catches\"><code>catches</code></a> function:</p>\n\n<pre><code>catches :: IO a -&gt; [Handler a] -&gt; IO a\n</code></pre>\n\n<p>Unfortunately this requires you to provide one <code>Handler</code> for each of them (although probably they'll only differ in their type signature).</p>\n"}], "owner": {"reputation": 14449, "user_id": 105678, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/859da59b3e4097fa659aabb55412de10?s=128&d=identicon&r=PG", "display_name": "Sean Clark Hess", "link": "https://stackoverflow.com/users/105678/sean-clark-hess"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 189, "favorite_count": 0, "accepted_answer_id": 33108374, "answer_count": 1, "score": 2, "last_activity_date": 1444756158, "creation_date": 1444754720, "last_edit_date": 1444755380, "question_id": 33108196, "link": "https://stackoverflow.com/questions/33108196/catching-exceptions-of-multiple-types", "title": "Catching exceptions of multiple types", "body": "<p>When I query <a href=\"https://hackage.haskell.org/package/postgresql-simple-0.5.0.1/docs/Database-PostgreSQL-Simple.html\" rel=\"nofollow\">my database</a>, it might throw <a href=\"https://hackage.haskell.org/package/postgresql-simple-0.5.0.1/docs/Database-PostgreSQL-Simple.html#v:query\" rel=\"nofollow\">one of four different kinds of exceptions</a>. </p>\n\n<pre><code>FormatError\nQueryError\nResultError\nSqlError\n</code></pre>\n\n<p>I want to write a function that catches any of those 4 exceptions generated by <code>query</code> and lifts them into <code>ExceptT</code>.</p>\n\n<pre><code>runQuery :: (ToRow q, FromRow r) =&gt; Query -&gt; q -&gt; ExceptT ServantErr IO [r]\nrunQuery conn q sub = do\n    res &lt;- liftIO $ try $ Postgres.query conn q sub\n    case res of\n      Left err -&gt; throwError (postgresErr err)\n      Right r -&gt; return r\n\npostgresErr :: ??? -&gt; ServantErr\npostgresErr e = err500 { errBody = ByteString.pack (show e) }\n</code></pre>\n\n<p>This doesn't work. <code>try</code> isn't catching anything. How can I catch any of the 4 exception types, and map it to a <code>ServantErr</code> depending on the type, but still allow any exceptions I don't handle to pass through? </p>\n"}, {"tags": ["haskell", "reactive-programming", "reactive-banana"], "answers": [{"tags": [], "owner": {"reputation": 11009, "user_id": 403805, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/bcf3c21ce05cfb6788e25dcc3821b3c7?s=128&d=identicon&r=PG", "display_name": "Heinrich Apfelmus", "link": "https://stackoverflow.com/users/403805/heinrich-apfelmus"}, "is_accepted": false, "score": 1, "last_activity_date": 1445004511, "last_edit_date": 1495540317, "creation_date": 1445004511, "answer_id": 33172535, "question_id": 33107871, "link": "https://stackoverflow.com/questions/33107871/implementing-game-states-using-reactive-banana/33172535#33172535", "title": "Implementing game states using reactive-banana", "body": "<p>You are probably looking for <em>dynamic event switching</em>, in particular the <code>switchB</code> combinator.</p>\n\n<p>See also <a href=\"https://stackoverflow.com/questions/27816012/performing-a-single-switch-in-reactive-banana\">this question</a>.</p>\n\n<p>Note that the pseudocode for your <code>newPaddlePosition</code> function does not make much sense: It says that when the <code>gameOverEvent</code> never occurs, then the new paddle position is equal to <code>paddlePosition</code>, otherwise it is constant and equal to the value of <code>paddlePosition</code> at the time that the event occurs. This is impossible to express in a causal FRP library. You probably mean something else.</p>\n"}], "owner": {"reputation": 301, "user_id": 5440167, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6e384a22ee7c87006ae3d29082aa5ecb?s=128&d=identicon&r=PG&f=1", "display_name": "Philipp Middendorf", "link": "https://stackoverflow.com/users/5440167/philipp-middendorf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1445004511, "creation_date": 1444753517, "question_id": 33107871, "link": "https://stackoverflow.com/questions/33107871/implementing-game-states-using-reactive-banana", "title": "Implementing game states using reactive-banana", "body": "<p>In my breakout implementation there are two main behaviors that describe the \ngame's main state:</p>\n\n<pre><code>paddlePosition :: Behavior t Point\nballPosition :: Behavior t Point\n</code></pre>\n\n<p>Both are implemented in terms of <code>tickEvent :: Event t ()</code> which discretely\nupdates them.</p>\n\n<p>The <code>gameOverEvent :: Event t ()</code> filters all tick events where the ball\nposition is below the screen. </p>\n\n<p>I would like to replace <code>paddlePosition</code> by a new behavior as soon as there\nis a <code>gameOverEvent</code>, leaving the paddle in place, in pseudo code:</p>\n\n<pre><code>newPaddlePosition = \\t -&gt; case gameOverEvent of\n    [] -&gt; paddlePosition t\n    ((t',()) : _) -&gt; paddlePosition t'\n</code></pre>\n\n<p>The first question is: How do I express <code>newPaddlePosition</code> using\nreactive-banana?</p>\n\n<p>The second is question is a bit more vague: What is a good way to organize the\nwhole program depending on if the game is over or not? There are other\nconsiderations like: How to handle <code>ballPosition</code>, how to draw the game, and so\non.</p>\n"}, {"tags": ["macos", "haskell", "gtk", "haskell-platform", "threadscope"], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 5441239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675296536cf4b894a3d4d23a1fa86bc9?s=128&d=identicon&r=PG&f=1", "display_name": "G. A. Newman", "link": "https://stackoverflow.com/users/5441239/g-a-newman"}, "edited": false, "score": 0, "creation_date": 1445454129, "post_id": 33105802, "comment_id": 54335588, "body": "Hi, thank you for your response!  Sadly this resulted in the same errors as above during the build of gtk."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 61, "user_id": 5441239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675296536cf4b894a3d4d23a1fa86bc9?s=128&d=identicon&r=PG&f=1", "display_name": "G. A. Newman", "link": "https://stackoverflow.com/users/5441239/g-a-newman"}, "edited": false, "score": 0, "creation_date": 1445455607, "post_id": 33105802, "comment_id": 54336362, "body": "Are you using GHC 7.10.2? The above recipe builds threadscope in a sandbox, so you can follow it without disturbing your installed packages if you are currently on a different version of GHC."}, {"owner": {"reputation": 61, "user_id": 5441239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675296536cf4b894a3d4d23a1fa86bc9?s=128&d=identicon&r=PG&f=1", "display_name": "G. A. Newman", "link": "https://stackoverflow.com/users/5441239/g-a-newman"}, "edited": false, "score": 0, "creation_date": 1445545299, "post_id": 33105802, "comment_id": 54380091, "body": "Yes, I&#39;m using GHC 7.10.2, and I&#39;m very confused why the recipe didn&#39;t work, since a sandbox was my sure thing of last resort."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 61, "user_id": 5441239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675296536cf4b894a3d4d23a1fa86bc9?s=128&d=identicon&r=PG&f=1", "display_name": "G. A. Newman", "link": "https://stackoverflow.com/users/5441239/g-a-newman"}, "edited": false, "score": 0, "creation_date": 1445550980, "post_id": 33105802, "comment_id": 54383158, "body": "Some ideas: perform a <code>cabal update</code>; use a cabal.config to lock down the versions of the above packages."}, {"owner": {"reputation": 798, "user_id": 893982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/997fe670bc45cb9f3898acf9eb18ab03?s=128&d=identicon&r=PG", "display_name": "George Co", "link": "https://stackoverflow.com/users/893982/george-co"}, "edited": false, "score": 0, "creation_date": 1480120256, "post_id": 33105802, "comment_id": 68847769, "body": "The key for me was to do cabal install gtk -fhave-quartz-gtk as suggested above"}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 1, "last_activity_date": 1444750666, "last_edit_date": 1444750666, "creation_date": 1444747768, "answer_id": 33105802, "question_id": 33105562, "link": "https://stackoverflow.com/questions/33105562/haskell-gtk-install-type-conflicts/33105802#33105802", "title": "Haskell gtk Install Type Conflicts", "body": "<p>There is a recipe for installing GTK and threadscope at edsko's blog:</p>\n\n<p><a href=\"http://www.edsko.net/2015/03/09/sandboxes-revisited/\" rel=\"nofollow\">http://www.edsko.net/2015/03/09/sandboxes-revisited/</a></p>\n\n<p>Search the page for \"GTK sandbox\".</p>\n\n<p><strong>Update</strong></p>\n\n<p>I was able to build threadscope using the above instructions with ghc-7.10.2.</p>\n\n<p>The specific commands I used:</p>\n\n<pre><code>export PATH=/opt/X11/lib/pkgconfig\nbrew install gtk+                      # installed gtk+-2.24.25\nbrew install poppler                   # installed poppler-0.35.0\ncabal sandbox init\ncabal install gtk2hs-buildtools\ncabal install gtk\ncabal install poppler --with-gcc=gcc-4.9 --extra-include-dirs=/usr/local/include\ncabal install threadscope\n</code></pre>\n\n<p>The specific versions of packages installed in the sandbox:</p>\n\n<pre><code>cairo-0.13.1.0\nghc-events-0.4.4.0\ngio-0.13.1.0\nglib-0.13.2.1\ngtk-0.13.9\nhashtables-1.2.0.2\npango-0.13.1.0\npoppler-0.13.1\nutf8-string-1.0.1.1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3422, "user_id": 1988505, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f3281bec4f80318de1f897786661f9e4?s=128&d=identicon&r=PG", "display_name": "Wesley Baugh", "link": "https://stackoverflow.com/users/1988505/wesley-baugh"}, "edited": false, "score": 2, "creation_date": 1466299150, "post_id": 35155680, "comment_id": 63259200, "body": "Stack variant: <code>stack install --flag gtk:have-quartz-gtk threadscope</code>"}], "tags": [], "owner": {"reputation": 151, "user_id": 5872882, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/fc8fcfe6e5954b67ec74d3408e807c45?s=128&d=identicon&r=PG&f=1", "display_name": "Max K", "link": "https://stackoverflow.com/users/5872882/max-k"}, "is_accepted": false, "score": 3, "last_activity_date": 1454422144, "creation_date": 1454422144, "answer_id": 35155680, "question_id": 33105562, "link": "https://stackoverflow.com/questions/33105562/haskell-gtk-install-type-conflicts/35155680#35155680", "title": "Haskell gtk Install Type Conflicts", "body": "<p>maybe you could try to install gtk with this line </p>\n\n<p><code>cabal install gtk -fhave-quartz-gtk</code></p>\n"}], "owner": {"reputation": 61, "user_id": 5441239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/675296536cf4b894a3d4d23a1fa86bc9?s=128&d=identicon&r=PG&f=1", "display_name": "G. A. Newman", "link": "https://stackoverflow.com/users/5441239/g-a-newman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 422, "favorite_count": 2, "answer_count": 2, "score": 6, "last_activity_date": 1454422144, "creation_date": 1444747134, "last_edit_date": 1444747696, "question_id": 33105562, "link": "https://stackoverflow.com/questions/33105562/haskell-gtk-install-type-conflicts", "title": "Haskell gtk Install Type Conflicts", "body": "<p>The basic problem: </p>\n\n<p>I'm attempting to install Haskell's <a href=\"https://hackage.haskell.org/package/gtk\" rel=\"noreferrer\"><code>gtk</code></a> package using the <a href=\"https://wiki.haskell.org/Gtk2Hs/Mac\" rel=\"noreferrer\">standard mac instructions</a> on OSX 10.10.4.  Specifically, I want to run <a href=\"https://hackage.haskell.org/package/threadscope\" rel=\"noreferrer\"><code>threadscope</code></a>, so I need <a href=\"https://hackage.haskell.org/package/gtk\" rel=\"noreferrer\"><code>gtk</code></a>. Early stages with <code>homebrew</code> and the <code>gtk buildtools</code> work fine, but when I </p>\n\n<pre><code>cabal install gtk\n</code></pre>\n\n<p>or use</p>\n\n<pre><code>cabal install --with-gcc=gcc-4.8 gtk\n</code></pre>\n\n<p>I get the following compilation error:</p>\n\n<pre><code>Graphics/UI/Gtk/Embedding/Plug.chs:120:6:\nCouldn't match expected type \u2018Ptr ()\u2019\n            with actual type \u2018Maybe DrawWindow\u2019\nIn the first argument of \u2018gtk_plug_new\u2019, namely\n  \u2018(fromNativeWindowId (fromMaybe nativeWindowIdNone socketId))\u2019\nIn the second argument of \u2018($)\u2019, namely\n  \u2018gtk_plug_new\n     (fromNativeWindowId (fromMaybe nativeWindowIdNone socketId))\u2019\n\nGraphics/UI/Gtk/Embedding/Plug.chs:137:6:\nCouldn't match expected type \u2018Ptr ()\u2019\n            with actual type \u2018Maybe DrawWindow\u2019\nIn the second argument of \u2018\\ (Display arg1) arg2\n                             -&gt; withForeignPtr arg1\n                                $ \\ argPtr1 -&gt; gtk_plug_new_for_display argPtr1 arg2\u2019, namely\n  \u2018(fromNativeWindowId (fromMaybe nativeWindowIdNone socketId))\u2019\nIn the second argument of \u2018($)\u2019, namely\n  \u2018(\\ (Display arg1) arg2\n      -&gt; withForeignPtr arg1\n         $ \\ argPtr1 -&gt; gtk_plug_new_for_display argPtr1 arg2)\n     display\n     (fromNativeWindowId (fromMaybe nativeWindowIdNone socketId))\u2019\n\nGraphics/UI/Gtk/Embedding/Plug.chs:151:3:\nCouldn't match type \u2018Ptr ()\u2019 with \u2018Maybe DrawWindow\u2019\nExpected type: IO (Maybe DrawWindow)\n  Actual type: IO (Ptr ())\nIn the second argument of \u2018($)\u2019, namely\n  \u2018(\\ (Plug arg1)\n      -&gt; withForeignPtr arg1 $ \\ argPtr1 -&gt; gtk_plug_get_id argPtr1)\n     (toPlug self)\u2019\nIn the expression:\n  liftM toNativeWindowId\n  $ (\\ (Plug arg1)\n       -&gt; withForeignPtr arg1 $ \\ argPtr1 -&gt; gtk_plug_get_id argPtr1)\n      (toPlug self)\ncabal: Error: some packages failed to install:\n</code></pre>\n\n<p>I previously had Haskell's <a href=\"https://hackage.haskell.org/package/gtk\" rel=\"noreferrer\"><code>gtk</code></a> library and <a href=\"https://hackage.haskell.org/package/threadscope\" rel=\"noreferrer\"><code>threadscope</code></a> application installed and running before I updated my Haskell platform from <code>ghc 7.8.4</code> to <code>ghc 7.10.2</code>.  At first I assumed an installation conflict, but I've repeatedly removed the Haskell platform from my system using the <a href=\"https://mail.haskell.org/pipermail/haskell-cafe/2011-March/090170.html\" rel=\"noreferrer\">thorough removal instructions</a> and reattempted the <a href=\"https://hackage.haskell.org/package/threadscope\" rel=\"noreferrer\"><code>threadscope</code></a> installation with no success. I've even removed and re-installed the underlying <code>gtk+</code> and related packages using <code>homebrew</code>, again no success. </p>\n\n<p>I'm not sure where the types <code>Ptr ()</code> and <code>Maybe DrawWindow</code> originate and therefore where the conflict could be coming from. Any ideas on what could be going wrong would be welcome!</p>\n"}, {"tags": ["scala", "haskell", "set"], "answers": [{"comments": [{"owner": {"reputation": 3647, "user_id": 371191, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e1caa49eebfe37ffe3ef64e19364b0b3?s=128&d=identicon&r=PG", "display_name": "Silly Freak", "link": "https://stackoverflow.com/users/371191/silly-freak"}, "edited": false, "score": 0, "creation_date": 1444747983, "post_id": 33105549, "comment_id": 54026610, "body": "Are (both of) you talking about <i>insertion</i> order or <i>natural</i> order of elements?"}, {"owner": {"reputation": 185247, "user_id": 135589, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dbd98f264c64096af168747c3ae71a7d?s=128&d=identicon&r=PG", "display_name": "Jesper", "link": "https://stackoverflow.com/users/135589/jesper"}, "reply_to_user": {"reputation": 3647, "user_id": 371191, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e1caa49eebfe37ffe3ef64e19364b0b3?s=128&d=identicon&r=PG", "display_name": "Silly Freak", "link": "https://stackoverflow.com/users/371191/silly-freak"}, "edited": false, "score": 0, "creation_date": 1444748376, "post_id": 33105549, "comment_id": 54026881, "body": "@SillyFreak <code>TreeSet</code> orders elements by natural order, not by insertion order."}, {"owner": {"reputation": 3647, "user_id": 371191, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e1caa49eebfe37ffe3ef64e19364b0b3?s=128&d=identicon&r=PG", "display_name": "Silly Freak", "link": "https://stackoverflow.com/users/371191/silly-freak"}, "edited": false, "score": 0, "creation_date": 1444756577, "post_id": 33105549, "comment_id": 54031923, "body": "I know, my comment was meant to point out the ambiguity in the (now deleted) comment, and to a lesser degree in the answer."}], "tags": [], "owner": {"reputation": 11890, "user_id": 2083327, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/jRF9x.jpg?s=128&g=1", "display_name": "R&#252;diger Klaehn", "link": "https://stackoverflow.com/users/2083327/r%c3%bcdiger-klaehn"}, "is_accepted": true, "score": 8, "last_activity_date": 1444748123, "last_edit_date": 1444748123, "creation_date": 1444747104, "answer_id": 33105549, "question_id": 33105446, "link": "https://stackoverflow.com/questions/33105446/difference-when-putting-lower-cased-alphabet-into-set/33105549#33105549", "title": "Difference when Putting Lower-cased Alphabet into Set", "body": "<p>The default set implementation of scala is a hash set, so it is not ordered. The default set implementation in Haskell is a sorted set, which is ordered. (You need an <code>Ord</code> instance to insert a new element: <code>insert :: Ord a =&gt; a -&gt; Set a -&gt; Set a</code>)</p>\n\n<p>To preserve order in scala, you would have to use a SortedSet, like this:</p>\n\n<pre><code>scala&gt; import scala.collection.immutable._\nscala&gt; ('a' to 'z').to[SortedSet]\nres4: scala.collection.immutable.SortedSet[Char] = TreeSet(a, b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z)\n</code></pre>\n\n<p>Here is a bit of background about the different choices: </p>\n\n<p>Scala chooses a hash-based implementation because that is common in the JVM world, and because hashtables are usually quite a bit faster than sorted collections. The downside of this is that hash codes introduce some non-determinism, especially when combined with classes that use the default hash code implementation.</p>\n\n<p>Haskell places purity over performance, so it chooses the more deterministic sorted collections.</p>\n"}, {"comments": [{"owner": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 2, "creation_date": 1444747901, "post_id": 33105791, "comment_id": 54026542, "body": "The Haskell <code>Set</code> doesn&#39;t preserve insertion order; it stores the elements of the set in order. It&#39;s implemented with a size balanced binary tree."}, {"owner": {"reputation": 3647, "user_id": 371191, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e1caa49eebfe37ffe3ef64e19364b0b3?s=128&d=identicon&r=PG", "display_name": "Silly Freak", "link": "https://stackoverflow.com/users/371191/silly-freak"}, "reply_to_user": {"reputation": 23444, "user_id": 414413, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/6de2113f01432aa844dc85070ff33e89?s=128&d=identicon&r=PG", "display_name": "Cirdec", "link": "https://stackoverflow.com/users/414413/cirdec"}, "edited": false, "score": 0, "creation_date": 1444748096, "post_id": 33105791, "comment_id": 54026697, "body": "Thanks, I wasn&#39;t sure about that. I removed the irrelevant information"}], "tags": [], "owner": {"reputation": 3647, "user_id": 371191, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/e1caa49eebfe37ffe3ef64e19364b0b3?s=128&d=identicon&r=PG", "display_name": "Silly Freak", "link": "https://stackoverflow.com/users/371191/silly-freak"}, "is_accepted": false, "score": 2, "last_activity_date": 1444748343, "last_edit_date": 1444748343, "creation_date": 1444747746, "answer_id": 33105791, "question_id": 33105446, "link": "https://stackoverflow.com/questions/33105446/difference-when-putting-lower-cased-alphabet-into-set/33105791#33105791", "title": "Difference when Putting Lower-cased Alphabet into Set", "body": "<p><code>Set</code> is only a name, describing a data structure that isn't ordered and doesn't allow duplicate elements. Everything else is basically implementation dependent.</p>\n\n<p>You have now experienced that a Set in Haskell is ordered, i.e. its elements need an <code>Ord</code> instance that defines the less-than relation for them. Scala's default implementation of the <code>Set</code> trait seems to be a HashSet, therefore the order seems random; actually it reflects the order of buckets elements are put in.</p>\n\n<p>In many cases when a set is the right data structure, ordering doesn't matter (checking membership, keeping track of the number of distinct objects, ...). If it does, there are specialized options in Scala that have a stricter contract than the <code>Set</code> trait, just like Java: <code>SortedSet</code> for elements that have a logical ordering, or <code>LinkedHashSet</code>, which preserves insertion order for iteration, but uses the hash set data structure for the usual set operations.</p>\n"}], "owner": {"reputation": 37991, "user_id": 409976, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9ccda0b49cc974197399eae01ebd6850?s=128&d=identicon&r=PG", "display_name": "Kevin Meredith", "link": "https://stackoverflow.com/users/409976/kevin-meredith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 33105549, "answer_count": 2, "score": 1, "last_activity_date": 1444748343, "creation_date": 1444746856, "question_id": 33105446, "link": "https://stackoverflow.com/questions/33105446/difference-when-putting-lower-cased-alphabet-into-set", "title": "Difference when Putting Lower-cased Alphabet into Set", "body": "<p>Why the difference when putting the lower-cased alphabet into a <code>Set</code>?</p>\n\n<p><strong>Haskell</strong></p>\n\n<pre><code>\u03bb: import Data.Set as S\n\u03bb: Prelude.foldr (\\e acc -&gt; S.insert e acc) S.empty ['a' .. 'z']\nfromList \"abcdefghijklmnopqrstuvwxyz\"\n</code></pre>\n\n<p><strong>Scala</strong></p>\n\n<pre><code>scala&gt; ('a' to 'z').toList.toSet\nres5: scala.collection.immutable.Set[Char] = Set(e, s, x, n, j, y, t,               \n     u, f, a, m, i, v, q, b, g, l, p, c, h, r, w, k, o, z, d)\n</code></pre>\n"}, {"tags": ["haskell", "hugs"], "answers": [{"comments": [{"owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "edited": false, "score": 1, "creation_date": 1444738750, "post_id": 33102467, "comment_id": 54019785, "body": "Well it causes a bit of a mess when you make functions an instance of <code>Num</code>, but I wouldn&#39;t say nobody would ever do that. It is useful in the same sense that a <code>Monoid</code> instance of functions is useful: you can for example write something like <code>(+5) * (+3)</code> and get a new function that does <code>\\x -&gt; (x + 5) * (x + 3)</code>, I think that is pretty cool. See also <a href=\"https://wiki.haskell.org/Num_instance_for_functions\" rel=\"nofollow noreferrer\">here</a>."}], "tags": [], "owner": {"reputation": 58792, "user_id": 1006010, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/f683d229f3673c9dcc3f3f2796d75c09?s=128&d=identicon&r=PG", "display_name": "MathematicalOrchid", "link": "https://stackoverflow.com/users/1006010/mathematicalorchid"}, "is_accepted": false, "score": 5, "last_activity_date": 1444738535, "creation_date": 1444738535, "answer_id": 33102467, "question_id": 33102290, "link": "https://stackoverflow.com/questions/33102290/what-is-the-type-of-1-2-in-haskell/33102467#33102467", "title": "What is the type of (1 2) in Haskell?", "body": "<p>In Haskell, <code>1</code> doesn't have a fixed type. It is \"any numeric type\". More exactly, any type that implements the <code>Num</code> class.</p>\n\n<p>In particular, it is technically valid for a <em>function type</em> to be an instance of <code>Num</code>. Nobody would ever do that, but technically it's possible.</p>\n\n<p>So the compiler is assuming that the <em>first</em> <code>1</code> is some sort of numeric function type, and then the <em>second</em> <code>1</code> is any other number type (maybe the same type, maybe a different one). If we change the expression to, say, <code>3 6</code>, then the compiler is assuming</p>\n\n<pre><code>3 :: Num (x -&gt; y) =&gt; x -&gt; y\n6 :: Num x =&gt; x\n3 6 :: (Num (x -&gt; y), Num x) =&gt; y\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1444741671, "post_id": 33102496, "comment_id": 54021825, "body": "By the way, are there any practical examples of an expression such as <code>1 2</code> or <code>True &quot;hello&quot;</code> or <code>&quot;hello&quot; [1,2,3]</code> etc being useful? DSLs I guess?"}, {"owner": {"reputation": 1521, "user_id": 365807, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/8c9db2824164d60fe55d2b0c1c361f20?s=128&d=identicon&r=PG", "display_name": "Fraser", "link": "https://stackoverflow.com/users/365807/fraser"}, "edited": false, "score": 1, "creation_date": 1444742116, "post_id": 33102496, "comment_id": 54022154, "body": "<code>True</code> is not overloaded \u2013 it is an actual constructor of the <code>data Bool = False | True</code> data type"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1444742202, "post_id": 33102496, "comment_id": 54022217, "body": "@ErikAllik I have never seen this used in this way. It may be possible but AFAIK isn&#39;t used."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1444751441, "post_id": 33102496, "comment_id": 54028928, "body": "Small but important nitpick of &quot;It&#39;s anything of type <code>Num</code>.&quot;: <code>Num</code> is not a type. <code>Num</code> is a <i>typeclass</i>."}], "tags": [], "owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "is_accepted": true, "score": 12, "last_activity_date": 1444738627, "creation_date": 1444738627, "answer_id": 33102496, "question_id": 33102290, "link": "https://stackoverflow.com/questions/33102290/what-is-the-type-of-1-2-in-haskell/33102496#33102496", "title": "What is the type of (1 2) in Haskell?", "body": "<p>No it is not ill-formed. The type is strange and there probably cannot be any meaningful values for which it makes sense but it's still allowed.</p>\n\n<p>Keep in mind that literals are overloaded. <code>1</code> is <strong>not</strong> an integer. It's anything of type <code>Num</code>.  Functions are <em>not</em> excluded from this. There is no rule saying <code>a -&gt; t</code> <em>cannot</em> be \" a number\" (i.e. an instance of <code>Num</code>).</p>\n\n<p>For example you could have an <code>instance</code> declaration like:</p>\n\n<pre><code>instance Num a =&gt; Num (a -&gt; b) where\n    fromInteger x = undefined\n    [...]\n</code></pre>\n\n<p>now <code>1 1</code> would simply be equal <code>undefined</code>. Not very useful but still valid.</p>\n\n<p>You <em>can</em> have useful definitions of <code>Num</code> for functions. For example, from the <a href=\"https://wiki.haskell.org/Num_instance_for_functions\" rel=\"noreferrer\">wiki</a></p>\n\n<pre><code>instance Num b =&gt; Num (a -&gt; b) where\n     negate      = fmap negate\n      (+)         = liftA2 (+)\n      (*)         = liftA2 (*)\n      fromInteger = pure . fromInteger\n      abs         = fmap abs\n      signum      = fmap signum\n</code></pre>\n\n<p>With this you can write things like:</p>\n\n<pre><code>f + g\n</code></pre>\n\n<p>where <code>f</code> and <code>g</code> are functions returning numbers.</p>\n\n<p>Using the above instance declaration <code>1 2</code> would be equal to <code>1</code>.\nBasically a literal used as a function with the above instance is equal to <code>const &lt;that-literal&gt;</code>.</p>\n"}], "owner": {"reputation": 8075, "user_id": 2169853, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/68b89009f4066d3e1adbe72d4329c8d3?s=128&d=identicon&r=PG", "display_name": "Jens", "link": "https://stackoverflow.com/users/2169853/jens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 0, "accepted_answer_id": 33102496, "answer_count": 2, "score": 6, "last_activity_date": 1444738627, "creation_date": 1444737994, "last_edit_date": 1444738324, "question_id": 33102290, "link": "https://stackoverflow.com/questions/33102290/what-is-the-type-of-1-2-in-haskell", "title": "What is the type of (1 2) in Haskell?", "body": "<p>I was playing around with hugs today and got stuck at a very simple question:</p>\n\n<pre><code>\u03bb 1 1\n:: (Num a, Num (a -&gt; t)) =&gt; t\n</code></pre>\n\n<p>What would that type be? I am having trouble to read this.</p>\n\n<p>And if it has a type, why? I would guess that the expression <code>1 1</code> is ill-formed and thus type-checking fails, which is supported by the Haskell compiler.</p>\n"}, {"tags": ["haskell", "infinite-loop", "periodic-task", "periodic-processing"], "comments": [{"owner": {"reputation": 8853, "user_id": 1022260, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/27a141cb4a1a2f49d43bc09a5fa742b2?s=128&d=identicon&r=PG&f=1", "display_name": "mikeb", "link": "https://stackoverflow.com/users/1022260/mikeb"}, "edited": false, "score": 0, "creation_date": 1444736675, "post_id": 33101730, "comment_id": 54018331, "body": "CRON, nohup or set it up as a service that can be started."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 1, "creation_date": 1444736780, "post_id": 33101730, "comment_id": 54018393, "body": "What does <i>via key in CLI</i> mean?"}, {"owner": {"reputation": 291, "user_id": 5385301, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-0U4TwNfi86g/AAAAAAAAAAI/AAAAAAAAAA8/F2R9qN64wMs/photo.jpg?sz=128", "display_name": "Filip van Hoft", "link": "https://stackoverflow.com/users/5385301/filip-van-hoft"}, "reply_to_user": {"reputation": 8853, "user_id": 1022260, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/27a141cb4a1a2f49d43bc09a5fa742b2?s=128&d=identicon&r=PG&f=1", "display_name": "mikeb", "link": "https://stackoverflow.com/users/1022260/mikeb"}, "edited": false, "score": 0, "creation_date": 1444736858, "post_id": 33101730, "comment_id": 54018449, "body": "@mikeb I want it in pure Haskell, user might change time, like 3 min, 10min so I have keys in CLI to do so, but don&#39;t know how to run it properly. In C you could do <code>while(1) ...</code>"}, {"owner": {"reputation": 291, "user_id": 5385301, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-0U4TwNfi86g/AAAAAAAAAAI/AAAAAAAAAA8/F2R9qN64wMs/photo.jpg?sz=128", "display_name": "Filip van Hoft", "link": "https://stackoverflow.com/users/5385301/filip-van-hoft"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1444736909, "post_id": 33101730, "comment_id": 54018485, "body": "@BartekBanachewicz <code>.&#47;app -e -t 5</code> , <code>e</code> key for endless run, <code>t</code>- time interval"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1444736919, "post_id": 33101730, "comment_id": 54018491, "body": "@FilipvanHoft so you essentially want a CLI thread for setup and another thread for the program itself? Or are you going to restart the program? What does &quot;endless run&quot; mean? Do you want to start the app <i>once</i> but then allow the interval of processing to be changed?"}, {"owner": {"reputation": 291, "user_id": 5385301, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-0U4TwNfi86g/AAAAAAAAAAI/AAAAAAAAAA8/F2R9qN64wMs/photo.jpg?sz=128", "display_name": "Filip van Hoft", "link": "https://stackoverflow.com/users/5385301/filip-van-hoft"}, "reply_to_user": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "edited": false, "score": 0, "creation_date": 1444737045, "post_id": 33101730, "comment_id": 54018569, "body": "@BartekBanachewicz CLI is set at first run. how can I run thread with logic endlessly?"}], "answers": [{"comments": [{"owner": {"reputation": 291, "user_id": 5385301, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-0U4TwNfi86g/AAAAAAAAAAI/AAAAAAAAAA8/F2R9qN64wMs/photo.jpg?sz=128", "display_name": "Filip van Hoft", "link": "https://stackoverflow.com/users/5385301/filip-van-hoft"}, "edited": false, "score": 0, "creation_date": 1444738247, "post_id": 33102035, "comment_id": 54019412, "body": "thanks! That is what I was looking for, I didn&#39;t know about <code>forever</code>"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 291, "user_id": 5385301, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-0U4TwNfi86g/AAAAAAAAAAI/AAAAAAAAAA8/F2R9qN64wMs/photo.jpg?sz=128", "display_name": "Filip van Hoft", "link": "https://stackoverflow.com/users/5385301/filip-van-hoft"}, "edited": false, "score": 0, "creation_date": 1444739537, "post_id": 33102035, "comment_id": 54020349, "body": "@FilipvanHoft forever&#39;s implementation is pretty straighforward, but just calling e.g. <code>process var</code> at the end of <code>process</code> would make it infinitely recursive (thus looped) as well."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1444742604, "post_id": 33102035, "comment_id": 54022478, "body": "Any reasons for choosing <code>TVar</code>s instead of, say, <code>IORef</code>s ? Is there some atomicity issue in the code above?"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1444743010, "post_id": 33102035, "comment_id": 54022786, "body": "@chi I plainly forgot about them. I almost never use &quot;raw&quot; <code>IORef</code>s, but of course the code shown has no possible races. I&#39;ll edit it."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 1, "creation_date": 1444751595, "post_id": 33102035, "comment_id": 54029027, "body": "I&#39;m not sure why you&#39;d use an <code>IORef</code> or a <code>TVar</code> at all. Just pass <code>5000</code> to process directly,"}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1444752622, "post_id": 33102035, "comment_id": 54029709, "body": "@ReinHenrichs And how do you propose the changed value of the interval is propagated to the process thread then?"}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1444752985, "post_id": 33102035, "comment_id": 54029935, "body": "I don&#39;t see a requirement to do so. OP said &quot;CLI is set at first run&quot;, which I take to mean that the timeout value does not need to be changed after the program starts."}, {"owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1444753097, "post_id": 33102035, "comment_id": 54030004, "body": "@ReinHenrichs it&#39;s in the comments."}, {"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1444753169, "post_id": 33102035, "comment_id": 54030038, "body": "@BartekBanachewicz Can you be specific? I don&#39;t see any comment to that effect but I see multiple comments that indicate otherwise, like &quot;./app -e -t 5 , e key for endless run, t- time interval &quot; where it is set via a command line flag. In fact, I see you suggesting it and OP disagreeing with you."}], "tags": [], "owner": {"reputation": 36513, "user_id": 752976, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/j7Uis.jpg?s=128&g=1", "display_name": "Bartek Banachewicz", "link": "https://stackoverflow.com/users/752976/bartek-banachewicz"}, "is_accepted": true, "score": 9, "last_activity_date": 1444743064, "last_edit_date": 1444743064, "creation_date": 1444737253, "answer_id": 33102035, "question_id": 33101730, "link": "https://stackoverflow.com/questions/33101730/how-to-run-a-haskell-program-endlessly-using-only-haskell/33102035#33102035", "title": "How to run a Haskell program endlessly using only Haskell?", "body": "<p>I presume you'll want something like that (more or less pseudocode):</p>\n\n<pre><code>import Control.Concurrent (forkIO, threadDelay)\nimport Data.IORef\nimport Control.Monad (forever)\n\nmain = do\n    var &lt;- newIORef 5000\n    forkIO (forever $ process var)\n    forever $ readInput var\n\nprocess var = do\n    doActualProcessing\n\n    interval &lt;- readIORef var\n    _ &lt;- threadDelay interval\n\nreadInput var = do\n    newInterval &lt;- readLn\n    writeIORef var newInterval\n</code></pre>\n\n<p>If you need to pass some more complex data from the input thread to the processing thread, <code>MVar</code>s or <code>TVar</code>s could be a better choice than <code>IORef</code>s.</p>\n"}], "owner": {"reputation": 291, "user_id": 5385301, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-0U4TwNfi86g/AAAAAAAAAAI/AAAAAAAAAA8/F2R9qN64wMs/photo.jpg?sz=128", "display_name": "Filip van Hoft", "link": "https://stackoverflow.com/users/5385301/filip-van-hoft"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 818, "favorite_count": 2, "accepted_answer_id": 33102035, "answer_count": 1, "score": 7, "last_activity_date": 1444743064, "creation_date": 1444736411, "last_edit_date": 1444741968, "question_id": 33101730, "link": "https://stackoverflow.com/questions/33101730/how-to-run-a-haskell-program-endlessly-using-only-haskell", "title": "How to run a Haskell program endlessly using only Haskell?", "body": "<p>I have small program that need to be executed every 5 minutes. </p>\n\n<p>For now, I have shell script that perform that task, but I want to provide for user ability to run it without additional scripts via key in CLI. </p>\n\n<p>What is the best way to achieve this?</p>\n"}, {"tags": ["haskell", "generics"], "answers": [{"comments": [{"owner": {"reputation": 19024, "user_id": 286335, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/6882f075e155c96b4ff0fe3bcab951f3?s=128&d=identicon&r=PG&f=1", "display_name": "cibercitizen1", "link": "https://stackoverflow.com/users/286335/cibercitizen1"}, "edited": false, "score": 0, "creation_date": 1444746018, "post_id": 33102476, "comment_id": 54025163, "body": "Yes, that  could be an option. Thanks. (In C++ I would have defined template functions, depending on the types tAction, tState, tReaction). Thanks."}], "tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 2, "last_activity_date": 1444742078, "last_edit_date": 1444742078, "creation_date": 1444738571, "answer_id": 33102476, "question_id": 33101162, "link": "https://stackoverflow.com/questions/33101162/a-case-with-generic-programming-in-haskell/33102476#33102476", "title": "A case with generic programming in Haskell", "body": "<p>not sure what you are trying to do here - but if you just want to parametrize over  the state, action, reaction... then you can lift those as type-paramters in your types:</p>\n\n<pre><code>-- aply an action to an state gives a new state\ntype TFunction_ChangeState tState tAction = tState -&gt; tAction -&gt; tState \n\n-- when a state is entered, a reaction is produced\ntype TFunction_WhatReaction tState tReaction = tState -&gt; tReaction\n\n-- the model is a function  from an action and a state into a new state and a reaction\ntype TFunction_ChangeModel tState tAction tReaction =  (tAction, tState) -&gt; (tReaction, tState)\n\n-- given the functions for changing state and finding out what reaction is produced\n-- it is straightforward to define the function for change a model\ncreateModelChangeFunction :: TFunction_ChangeState tState tAction\n                           -&gt; TFunction_WhatReaction tState tReaction\n                           -&gt; TFunction_ChangeModel tState tAction tReaction\ncreateModelChangeFunction changeState whatReaction = \\(ac, st) -&gt; let\n        ns = changeState  st ac\n        re = whatReaction ns\n        in (re, ns)\n\n-- show a view of a transition to a new state and the associated reaction\ntype TFunction_View tState tReaction = (tReaction, tState) -&gt; IO ()\n\n-- change model and view functions can be easily combined\ntype TFunction_ModelAndViewCombined tState tAction = (tAction, tState) -&gt; IO tState\n\ncombineModelAndView :: TFunction_ChangeModel tState tAction tReaction\n                     -&gt; TFunction_View tState tReaction\n                     -&gt; TFunction_ModelAndViewCombined tState tAction\ncombineModelAndView change view = \\(a, s) -&gt; do\n                   let (r, s') = change (a, s)\n                   view (r, s')\n                   return s'\n\n--\ntype TFunction_ControllerLoop tState tAction =\n  tState -&gt; TFunction_ModelAndViewCombined tState tAction -&gt; IO tState\n</code></pre>\n\n<p>I'm not saying that this is beautiful ;)</p>\n"}, {"tags": [], "owner": {"reputation": 19024, "user_id": 286335, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/6882f075e155c96b4ff0fe3bcab951f3?s=128&d=identicon&r=PG&f=1", "display_name": "cibercitizen1", "link": "https://stackoverflow.com/users/286335/cibercitizen1"}, "is_accepted": false, "score": 0, "last_activity_date": 1444835572, "last_edit_date": 1495542215, "creation_date": 1444835572, "answer_id": 33129160, "question_id": 33101162, "link": "https://stackoverflow.com/questions/33101162/a-case-with-generic-programming-in-haskell/33129160#33129160", "title": "A case with generic programming in Haskell", "body": "<p>I've managed to refactor the code to a simpler, readable and usable version using multi param typeclasses in <a href=\"https://stackoverflow.com/questions/4029455/is-there-a-haskell-equivalent-of-oops-abstract-classes-using-algebraic-data-ty/33128734#33128734\">this answer</a></p>\n"}], "owner": {"reputation": 19024, "user_id": 286335, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/6882f075e155c96b4ff0fe3bcab951f3?s=128&d=identicon&r=PG&f=1", "display_name": "cibercitizen1", "link": "https://stackoverflow.com/users/286335/cibercitizen1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 33102476, "answer_count": 2, "score": 0, "last_activity_date": 1444835572, "creation_date": 1444734721, "last_edit_date": 1444742357, "question_id": 33101162, "link": "https://stackoverflow.com/questions/33101162/a-case-with-generic-programming-in-haskell", "title": "A case with generic programming in Haskell", "body": "<p>Trying to write a simplistic \"model-view-controller\" app in Haskell (just to learn):</p>\n\n<p>Given the general types <code>TState</code> <code>TAction</code> <code>TReaction</code>,\nthe key definition is that the function for change the model is</p>\n\n<p><code>(TAction, TState) -&gt; (TReaction, TState)</code> (<code>:: TFunction_ChangeModel</code>)</p>\n\n<p>The code to create a function <code>:: TFunction_ChangeModel</code> or a function\n<code>:: TFunction_ModelAndViewCombined</code> is fixed and can be easily generalized (when the necessary functions are provided, see the program below).</p>\n\n<p>I would like (this is the question) to get rid of having to define\ndummy types like <code>type TState = Int</code> with a note 'please customize'. </p>\n\n<p>Thus, </p>\n\n<p><strong>can the following code be written without the first three <code>type Txxxx =</code> ?</strong> </p>\n\n<p>(Note: any suggestion and criticism is welcome).</p>\n\n<pre><code>-- just to make this compile\ntype TState = Int\ntype TAction = Char\ntype TReaction = Double\n\n-- aply an action to an state gives a new state\ntype TFunction_ChangeState = TState -&gt; TAction -&gt; TState \n\n-- when a state is entered, a reaction is produced\ntype TFunction_WhatReaction = TState -&gt; TReaction\n\n-- the model is a function  from an action and a state into a new state and a reaction\ntype TFunction_ChangeModel =  (TAction, TState) -&gt; (TReaction, TState)\n\n-- given the functions for changing state and finding out what reaction is produced\n-- it is straightforward to define the function for change a model\ncreateModelChangeFunction :: TFunction_ChangeState -&gt; TFunction_WhatReaction -&gt; TFunction_ChangeModel\ncreateModelChangeFunction changeState whatReaction = \\(ac, st) -&gt; let\n        ns = changeState  st ac\n        re = whatReaction ns\n        in (re, ns)\n\n-- show a view of a transition to a new state and the associated reaction\ntype TFunction_View = (TReaction, TState) -&gt; IO ()\n\n-- change model and view functions can be easily combined\ntype TFunction_ModelAndViewCombined = (TAction, TState) -&gt; IO TState\n\ncombineModelAndView :: TFunction_ChangeModel -&gt; TFunction_View -&gt; TFunction_ModelAndViewCombined\ncombineModelAndView change view = \\(a, s) -&gt; do\n                   let (r, s') = change (a, s)\n                   view (r, s')\n                   return s'\n\n--\ntype TFunction_ControllerLoop = TState -&gt; TFunction_ModelAndViewCombined -&gt; IO TState\n\n--\nmain = do\n     print \"hi\"\n</code></pre>\n"}, {"tags": ["shell", "haskell", "process", "io"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1444725590, "post_id": 33097448, "comment_id": 54011222, "body": "Your method is bad because you don&#39;t know when to stop reading and start sending more commands. A human shell user knows that because he sees the prompt. Your program has no idea where <code>ls</code> output ends and the prompt starts. You can in principle parse the output and detect the prompt but it is very hard and error-prone. Better organize it in such a way that you only run one command that first reads all the input and then produces all the output, and does not require any input in the middle of its output. The language you use is irrelevant."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1444726159, "post_id": 33097448, "comment_id": 54011547, "body": "Having said that, you can try sending <code>&quot;ls\\nexit\\n&quot;</code> first and then read the output. But it&#39;s easier to just execute <code>ls</code> directly with no shell at all."}, {"owner": {"reputation": 133, "user_id": 1723296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e9be4d59d99f8066018becec630ab00?s=128&d=identicon&r=PG", "display_name": "Thomas Junier", "link": "https://stackoverflow.com/users/1723296/thomas-junier"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1444726343, "post_id": 33097448, "comment_id": 54011666, "body": "I see. I was hoping (mistakenly, as it turns out) that disabling buffering would help with that, but I should have seen that it wouldn&#39;t (how can the program know when the shell is done writing?). The thing is, I was hoping to write to and read from the same shell several times, not launch a new shell for each command, in order to keep the same environment.  Anyway, thanks very much."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1444735335, "post_id": 33097448, "comment_id": 54017463, "body": "You should create another question with more details about your use case and why it&#39;s important to keep the same environment. Perhaps you&#39;ll get some ideas of alternative approaches to the problem. And then post a link to the new question in the comments here."}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 1723296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e9be4d59d99f8066018becec630ab00?s=128&d=identicon&r=PG", "display_name": "Thomas Junier", "link": "https://stackoverflow.com/users/1723296/thomas-junier"}, "edited": false, "score": 0, "creation_date": 1444726912, "post_id": 33097749, "comment_id": 54012036, "body": "Indeed , this does not hang. But I was wondering if I could create a process that I could keep around and pass to other functions, which would themselves write to and read from it. As @n.m. pointed out however, this wouldn&#39;t work. Thanks all the same."}], "tags": [], "owner": {"reputation": 2152, "user_id": 1103600, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7830fb399137c319ff68dca3e3b6f7e2?s=128&d=identicon&r=PG", "display_name": "Arnon", "link": "https://stackoverflow.com/users/1103600/arnon"}, "is_accepted": true, "score": 3, "last_activity_date": 1444725040, "creation_date": 1444725040, "answer_id": 33097749, "question_id": 33097448, "link": "https://stackoverflow.com/questions/33097448/haskell-read-from-process/33097749#33097749", "title": "Haskell read from process", "body": "<p>I have a bit of haskell code that reads content from a shell process, and it doesn't hang.... Give it a shot:</p>\n\n<pre><code>import System.Process\nimport GHC.IO.Handle.Text\n\nmain :: IO ()\nmain = do\n   (_,Just ho1, _, hp1) &lt;- createProcess (shell \"find -iname \\\"*.lhs\\\"\"){std_out=CreatePipe}\n   sOut &lt;- hGetContents ho1\n   _ &lt;- waitForProcess hp1\n</code></pre>\n\n<p>Then, <code>sOut</code> will have the content of the shell process</p>\n"}], "owner": {"reputation": 133, "user_id": 1723296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e9be4d59d99f8066018becec630ab00?s=128&d=identicon&r=PG", "display_name": "Thomas Junier", "link": "https://stackoverflow.com/users/1723296/thomas-junier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 514, "favorite_count": 0, "accepted_answer_id": 33097749, "answer_count": 1, "score": 3, "last_activity_date": 1444725040, "creation_date": 1444723959, "question_id": 33097448, "link": "https://stackoverflow.com/questions/33097448/haskell-read-from-process", "title": "Haskell read from process", "body": "<p>I'm not quite sure where the problem is, so I'm uncertain if the title is really accurate. I want to open a shell process, and write to it then read the output:</p>\n\n<pre><code>import System.IO (hPutStr, hGetContents, hSetBuffering, hClose,\n            BufferMode(NoBuffering))\nimport System.Process (runInteractiveProcess)\n\nmain = do\n        (hIn, hOut, _, _) &lt;- runInteractiveProcess\n                                \"/bin/sh\" [] Nothing Nothing\n        hSetBuffering hIn NoBuffering\n        hPutStr hIn \"ls /\\n\"\n        hGetContents hOut &gt;&gt;= putStrLn\n        hClose hIn\n        hClose hOut\n</code></pre>\n\n<p>This seems to work (sort of):</p>\n\n<pre><code>$ ./mwe\nbin\nboot\ncdrom\ndev\netc\n...\n</code></pre>\n\n<p>The problem is, the program hangs (I need to kill it with Ctrl-C). I suppose the shell is still running, which prevents the Haskell prohramfrom exiting. So I tried to terminate the shell explicitly with <code>terminateProcess</code>:</p>\n\n<pre><code>main = do\n        (hIn, hOut, _, sh) &lt;- runInteractiveProcess\n                                \"/bin/sh\" [] Nothing Nothing\n        hSetBuffering hIn NoBuffering\n        hPutStr hIn \"ls /\\n\"\n        hGetContents hOut &gt;&gt;= putStrLn\n        terminateProcess sh\n        hClose hIn\n        hClose hOut\n</code></pre>\n\n<p>but to no avail. I also tried to send <code>exit</code> to the shell:</p>\n\n<pre><code>    ...\n    hGetContents hOut &gt;&gt;= putStrLn\n    hPutStr hIn \"exit\\n\"\n    ...\n</code></pre>\n\n<p>which does not work either. </p>\n\n<p>I'm sure the solution is embarrassingly simple, but I couldn't find it (tried searching for \"haskell kill process\", among others , but perhaps the problem is not what I think). Apologies in advance if this has been asked already. Any help much appreciated!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444716735, "post_id": 33095304, "comment_id": 54006411, "body": "<code>gte</code> usually stands for &quot;greater than or equal to&quot;, not &quot;greater than&quot;."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1444716783, "post_id": 33095304, "comment_id": 54006436, "body": "Remark: Your <code>lt</code> is partial. Try <code>lt Z Z</code> or <code>lt (S Z) Z</code>."}, {"owner": {"reputation": 31, "user_id": 5439031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35ad94b396b650488007bb9de5766ac7?s=128&d=identicon&r=PG&f=1", "display_name": "ntb457", "link": "https://stackoverflow.com/users/5439031/ntb457"}, "edited": false, "score": 0, "creation_date": 1444716838, "post_id": 33095304, "comment_id": 54006462, "body": "You&#39;re right. It is greater than or equal too."}, {"owner": {"reputation": 31, "user_id": 5439031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35ad94b396b650488007bb9de5766ac7?s=128&d=identicon&r=PG&f=1", "display_name": "ntb457", "link": "https://stackoverflow.com/users/5439031/ntb457"}, "edited": false, "score": 0, "creation_date": 1444717201, "post_id": 33095304, "comment_id": 54006620, "body": "When I tried <code>lt Z Z</code> or <code>lt (S Z)  Z</code> I received this error <code>Non-exhaustive patterns in function lt</code>. Do I need to add conditions for these cases as well?"}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 1, "creation_date": 1444722545, "post_id": 33095304, "comment_id": 54009523, "body": "Yes, you need to cover all cases."}], "answers": [{"tags": [], "owner": {"reputation": 680, "user_id": 307129, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/df4d446a8aba477c919155ba5ba6e8c1?s=128&d=identicon&r=PG", "display_name": "mpeac", "link": "https://stackoverflow.com/users/307129/mpeac"}, "is_accepted": false, "score": 2, "last_activity_date": 1444727426, "last_edit_date": 1444727426, "creation_date": 1444716748, "answer_id": 33095356, "question_id": 33095304, "link": "https://stackoverflow.com/questions/33095304/define-greater-than-for-nats-in-haskell/33095356#33095356", "title": "Define &quot;greater than&quot; for nats in Haskell", "body": "<p>What about using the fact that <code>A &gt;= B</code> is the same as <code>not (A &lt; B)</code>, since you have already implemented <code>lt</code>?</p>\n"}, {"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 1, "last_activity_date": 1444734212, "creation_date": 1444734212, "answer_id": 33101004, "question_id": 33095304, "link": "https://stackoverflow.com/questions/33095304/define-greater-than-for-nats-in-haskell/33101004#33101004", "title": "Define &quot;greater than&quot; for nats in Haskell", "body": "<p>It looks like <code>Nat</code> is defined like this:</p>\n\n<pre><code>data Nat = Z | S Nat\n</code></pre>\n\n<p>so to define a function <code>f :: Nat -&gt; ...</code> you have to specify what happens to both constructors:</p>\n\n<pre><code>f Z     = ...\nf (S a) = ...\n</code></pre>\n\n<p>Likewise, for a function of two <code>Nat</code> variables, you have to consider the four possible combinations of constructors:</p>\n\n<pre><code>g Z     Z     = ...\ng Z     (S a) = ...\ng (S a) Z     = ...\ng (S a) (S b) = ...\n</code></pre>\n\n<p>It might turn out that you can combine some of theses cases, but this is a good way to start out on the problem.</p>\n"}], "owner": {"reputation": 31, "user_id": 5439031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35ad94b396b650488007bb9de5766ac7?s=128&d=identicon&r=PG&f=1", "display_name": "ntb457", "link": "https://stackoverflow.com/users/5439031/ntb457"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "accepted_answer_id": 33101004, "answer_count": 2, "score": 1, "last_activity_date": 1444734212, "creation_date": 1444716513, "question_id": 33095304, "link": "https://stackoverflow.com/questions/33095304/define-greater-than-for-nats-in-haskell", "title": "Define &quot;greater than&quot; for nats in Haskell", "body": "<p>So I believe I have the less than(lt) function correct, but I'm not sure what to do with the greater than(gte)</p>\n\n<pre><code>lt :: Nat -&gt; Nat -&gt; Bool\nlt Z     (S b) = True\nlt (S a) (S b) = lt a b\n\ngte :: Nat -&gt; Nat -&gt; Bool\ngte Z     b = False\ngte (S a) b = \n</code></pre>\n"}, {"tags": ["haskell", "higher-order-functions"], "answers": [{"comments": [{"owner": {"reputation": 4761, "user_id": 2277395, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/09841ca82e49f998ea0b8f159dea87c1?s=128&d=identicon&r=PG", "display_name": "Martin Drautzburg", "link": "https://stackoverflow.com/users/2277395/martin-drautzburg"}, "edited": false, "score": 0, "creation_date": 1444716263, "post_id": 33095197, "comment_id": 54006208, "body": "One reason why I want the narrow interface is that I can test the function more easily, because I don&#39;t need a full System at hand. The Classy method looks like it safely prevents the function from modifying things it is not supposed to modify, but I still have to provide a full System for testing. Am I right?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 4761, "user_id": 2277395, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/09841ca82e49f998ea0b8f159dea87c1?s=128&d=identicon&r=PG", "display_name": "Martin Drautzburg", "link": "https://stackoverflow.com/users/2277395/martin-drautzburg"}, "edited": false, "score": 1, "creation_date": 1444716420, "post_id": 33095197, "comment_id": 54006293, "body": "@MartinDrautzburg, you actually can add a dummy type that&#39;s an instance of the <code>HasProcess</code> and <code>HasItemDb</code> classes, say, and that doesn&#39;t have anything except those fields."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 3, "last_activity_date": 1444717176, "last_edit_date": 1444717176, "creation_date": 1444716038, "answer_id": 33095197, "question_id": 33095052, "link": "https://stackoverflow.com/questions/33095052/how-to-modify-parts-of-a-state-in-haskell/33095197#33095197", "title": "How to modify parts of a State in Haskell", "body": "<p>One common solution is to use a class, possibly created by the Template Haskell magic of <a href=\"https://hackage.haskell.org/package/lens-4.13/docs/Control-Lens-TH.html\" rel=\"nofollow\"><code>Control.Lens.TH.makeClassy</code></a>. The gist is that you pass in the whole <code>System</code>, but you don't let the function <em>know</em> that that's what you're giving it. All it's allowed to know is that what you're giving it offers methods for getting and/or modifying the pieces it's supposed to handle.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1446066087, "post_id": 33400961, "comment_id": 54594309, "body": "Yeah, <code>lens</code> would have you add a <code>HasWhatever s</code> context to constrain the state to something that &quot;has&quot; whatever piece of info you&#39;re looking for. A custom class could offer only a <code>Getter</code> or only a <code>Setter</code>."}, {"owner": {"reputation": 29444, "user_id": 3072788, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/220a45c2fcff7e7358d144551b116205?s=128&d=identicon&r=PG&f=1", "display_name": "Alec", "link": "https://stackoverflow.com/users/3072788/alec"}, "edited": false, "score": 0, "creation_date": 1475652310, "post_id": 33400961, "comment_id": 67022888, "body": "Your function <code>focus</code> already exists in <code>lens</code>. It is <a href=\"http://hackage.haskell.org/package/lens-4.14/docs/Control-Lens-Zoom.html#v:zoom\" rel=\"nofollow noreferrer\"><code>zoom</code></a>. It lets you embed the &quot;smaller&quot; <code>State</code> inside a bigger one."}], "tags": [], "owner": {"reputation": 4761, "user_id": 2277395, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/09841ca82e49f998ea0b8f159dea87c1?s=128&d=identicon&r=PG", "display_name": "Martin Drautzburg", "link": "https://stackoverflow.com/users/2277395/martin-drautzburg"}, "is_accepted": true, "score": 0, "last_activity_date": 1446064374, "last_edit_date": 1446064374, "creation_date": 1446063919, "answer_id": 33400961, "question_id": 33095052, "link": "https://stackoverflow.com/questions/33095052/how-to-modify-parts-of-a-state-in-haskell/33400961#33400961", "title": "How to modify parts of a State in Haskell", "body": "<p>I ended up writing a function which work on any State and which requires a \"Lens\" which captures the specfic transformation from the bigger State to the smaller State and back</p>\n\n<pre><code>focus :: (Lens s' s) -&gt; State s' a -&gt; State s a\nfocus lens ms'= do\n    s &lt;- get\n    let (s', set) = lens s\n        (a, s'')  = runState ms' s'\n    put (set s'')\n    return a\n</code></pre>\n\n<p>It allows me to write things like</p>\n\n<pre><code>run :: ExitP -&gt; State SimState Log\n...\n   do\n       evqs' &lt;-focus onSys $ step (t,evt)\n       ...\n</code></pre>\n\n<p>Where step operates on the \"smaller\" state</p>\n\n<pre><code>step :: Timed Event -&gt; State Sys.System [EventQu]\n</code></pre>\n\n<p>Here onSys is a \"Lens\" and it works like this:</p>\n\n<pre><code>onSys :: Lens Sys.System SimState \nonSys (Sis e s) = (s, Sis e)\n</code></pre>\n\n<p>where</p>\n\n<pre><code>data SimState = Sis {\n            events  :: EventQu,\n            sisSys  :: Sys.System\n</code></pre>\n\n<p>I suppose the existing Lens libraries follow a similar approach, but do much more magic, like creating lenses automatically. I did shy away from lenses. Instead I was pleased to realise that all it takes was a few lines of codes to get what I need. </p>\n"}], "owner": {"reputation": 4761, "user_id": 2277395, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/09841ca82e49f998ea0b8f159dea87c1?s=128&d=identicon&r=PG", "display_name": "Martin Drautzburg", "link": "https://stackoverflow.com/users/2277395/martin-drautzburg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 33400961, "answer_count": 2, "score": 2, "last_activity_date": 1446064374, "creation_date": 1444715404, "question_id": 33095052, "link": "https://stackoverflow.com/questions/33095052/how-to-modify-parts-of-a-state-in-haskell", "title": "How to modify parts of a State in Haskell", "body": "<p>I have a number of operations which modify a <code>System</code>. System is defined like this:</p>\n\n<pre><code>data System = Sys {\n            sysId   :: Int,\n            sysRand :: StdGen,\n            sysProcesses :: ProcessDb,\n            sysItems :: ItemDb\n}  \n</code></pre>\n\n<p>with e.g.</p>\n\n<pre><code>type ProcessDb = M.Map Int Process\n</code></pre>\n\n<p>But I also have some functions, which do not need access to the full System, but have types like this:</p>\n\n<pre><code>foo' :: (Process, ItemDb) -&gt; ((Process, ItemDb),[Event])\n</code></pre>\n\n<p>Currently I gave them types like</p>\n\n<pre><code>foo: System -&gt; (System, [Event])\n</code></pre>\n\n<p>But this is a needlessly broad interface. To use the narrow interface above in conjuntion with <code>System</code> I would have to extract a single <code>Process</code> and the <code>ItemDb</code> from <code>System</code>, run <code>foo'</code> and then modify <code>System</code> with the results. </p>\n\n<p>This is quite some unwrapping and wrapping and results in more lines of code than just passing system as a whole and let <code>foo</code> extract whatever it needs. In the latter case, the wrapping and unwrapping is mingled with the actual <code>foo'</code> operation and I have the feeling that these two aspects should be separated.</p>\n\n<p>I suppose I need some kind of lifting operation which turns a narrow <code>foo'</code> into a <code>foo</code>. I suppose I could write this, but I would have to write such a lifter for every signature of the narrow functions, resulting is lots of different lifters.</p>\n\n<ul>\n<li>is there an idiom how to solve such problems?</li>\n<li>is it worth bothering?</li>\n</ul>\n"}, {"tags": ["haskell", "bots", "irc"], "answers": [{"comments": [{"owner": {"reputation": 147, "user_id": 4301448, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3f0f317c8f0211d406091f5b8353988b?s=128&d=identicon&r=PG&f=1", "display_name": "user4301448", "link": "https://stackoverflow.com/users/4301448/user4301448"}, "edited": false, "score": 0, "creation_date": 1444743089, "post_id": 33100648, "comment_id": 54022859, "body": "About type checking the code I had: can&#39;t believe I was so close! But doesn&#39;t <code>loop st = runReaderT run st</code> return a monad and not unit? Or did it work because the inner monad&#39;s type was <code>IO ()</code>?"}, {"owner": {"reputation": 147, "user_id": 4301448, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3f0f317c8f0211d406091f5b8353988b?s=128&d=identicon&r=PG&f=1", "display_name": "user4301448", "link": "https://stackoverflow.com/users/4301448/user4301448"}, "edited": false, "score": 0, "creation_date": 1444743590, "post_id": 33100648, "comment_id": 54023263, "body": "I also re-jigged your new <code>eval &quot;!update time&quot;</code> code so it&#39;s inside privmsg and it works excellently. Thank you, I shall accept your answer."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 147, "user_id": 4301448, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3f0f317c8f0211d406091f5b8353988b?s=128&d=identicon&r=PG&f=1", "display_name": "user4301448", "link": "https://stackoverflow.com/users/4301448/user4301448"}, "edited": false, "score": 2, "creation_date": 1444744156, "post_id": 33100648, "comment_id": 54023714, "body": "You could also fix the type check error by using <code>evalStateT</code>. <code>run</code> returns a compatible value - <code>()</code>, but <code>runStateT</code> expands it into a pair."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 2, "last_activity_date": 1444733417, "last_edit_date": 1444733417, "creation_date": 1444733091, "answer_id": 33100648, "question_id": 33094381, "link": "https://stackoverflow.com/questions/33094381/extending-the-irc-bot-from-wiki-haskell-org-with-state/33100648#33100648", "title": "Extending the IRC bot from wiki.haskell.org with state", "body": "<p>I got your code to compile by simply adding a <code>&gt;&gt; return ()</code> to the definition of <code>loop</code> in your main:</p>\n\n<pre><code>main :: IO ()\nmain = bracket connect disconnect loop\n  where\n    disconnect = hClose . socket\n    loop st    = (runStateT run st) &gt;&gt; return ()\n</code></pre>\n\n<p>This effectively ignores the return value of <code>runStateT</code>. Here are all of the variants of runState/runStateT:</p>\n\n<ul>\n<li><code>runStateT</code> - return both the final state and returned value</li>\n<li><code>evalStateT</code> - return only the final value</li>\n<li><code>execStateT</code> - return only the final state</li>\n</ul>\n\n<p>Your original definition of <code>loop</code> was returning a pair (from runStateT), and this didn't type check since <code>main</code> wants a computation which returns just <code>()</code>.</p>\n\n<p>To update the <code>lastPosted</code> field, consider this addition to the <code>eval</code> function which is triggered when the bot is sent the message <code>!update time</code>:</p>\n\n<pre><code>eval \"!update time\"\n     = do t &lt;- liftIO getClockTime\n          bot &lt;- get\n          put (bot { lastPosted = t })\n</code></pre>\n\n<p>We need to <code>liftIO getClockTime</code> since we are operating in the <code>Net</code> monad.\nThen we <code>get</code> the old state and <code>put</code> the updated state. You can add this logic wherever you want to update the lastPosted time in the <code>Net</code> monad.</p>\n\n<p>Full code is available at: <a href=\"http://lpaste.net/142931\" rel=\"nofollow\">http://lpaste.net/142931</a></p>\n"}], "owner": {"reputation": 147, "user_id": 4301448, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3f0f317c8f0211d406091f5b8353988b?s=128&d=identicon&r=PG&f=1", "display_name": "user4301448", "link": "https://stackoverflow.com/users/4301448/user4301448"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 33100648, "answer_count": 1, "score": 1, "last_activity_date": 1444733417, "creation_date": 1444711980, "question_id": 33094381, "link": "https://stackoverflow.com/questions/33094381/extending-the-irc-bot-from-wiki-haskell-org-with-state", "title": "Extending the IRC bot from wiki.haskell.org with state", "body": "<h1>Problem</h1>\n\n<p>I'm attempting to extend the IRC bot from <a href=\"https://wiki.haskell.org/Roll_your_own_IRC_bot\" rel=\"nofollow\">https://wiki.haskell.org/Roll_your_own_IRC_bot</a> with some state that's updated every time the bot posts a message in the channel it's connected to.</p>\n\n<p>The feature is: every time the command <code>!last said</code> is issued in the IRC channel, the bot should respond with a time stamp. To support this, the <code>privmsg</code> function needs to update the bot's state -- specifically the <code>lastPosted</code> record -- with a new timestamp every time it is called.</p>\n\n<h1>Work so far</h1>\n\n<p>I took the code from the bottom of the Haskell wiki page (which used a ReaderT to access information about the bot's environment) and tried to change out the ReaderT for a State Transformer (StateT). The results are below and as you can see, I didn't get very far.</p>\n\n<pre><code>import Data.List\nimport Network\nimport System.IO\nimport System.Exit\nimport System.Time\nimport Control.Arrow\nimport Control.Monad.State\nimport Control.Exception\nimport Text.Printf\n\nserver = \"irc.freenode.org\"\nport   = 6667\nchan   = \"#testbot-test\"\nnick   = \"testbottest\"\n\n-- The 'Net' monad, a wrapper over IO, carrying the bot's immutable state.\ntype Net = StateT Bot IO\ndata Bot = Bot { socket :: Handle, lastPosted :: ClockTime }\n\n-- Set up actions to run on start and end, and run the main loop\nmain :: IO ()\nmain = bracket connect disconnect loop\n  where\n    disconnect = hClose . socket\n    loop st    = runStateT run st\n\n-- Connect to the server and return the initial bot state\nconnect :: IO Bot\nconnect = notify $ do\n  h &lt;- connectTo server (PortNumber (fromIntegral port))\n  t &lt;- getClockTime\n  hSetBuffering h NoBuffering\n  return (Bot h t)\n    where\n      notify a = bracket_\n        (printf \"Connecting to %s ... \" server &gt;&gt; hFlush stdout)\n        (putStrLn \"done.\")\n        a\n\n-- We're in the Net monad now, so we've connected successfully\n-- Join a channel, and start processing commands\nrun :: Net ()\nrun = do\n  write \"NICK\" nick\n  write \"USER\" (nick ++ \" 0 * :test bot\")\n  write \"JOIN\" chan\n  gets socket &gt;&gt;= listen\n\n-- Process each line from the server\nlisten :: Handle -&gt; Net ()\nlisten h = forever $ do\n  s &lt;- init `fmap` liftIO (hGetLine h)\n  liftIO (putStrLn s)\n  if ping s then pong s else eval (clean s)\n  where\n    forever a = a &gt;&gt; forever a\n    clean     = drop 1 . dropWhile (/= ':') . drop 1\n    ping x    = \"PING :\" `isPrefixOf` x\n    pong x    = write \"PONG\" (':' : drop 6 x)\n\n-- Dispatch a command\neval :: String -&gt; Net ()\neval     \"!quit\"               = write \"QUIT\" \":Exiting\" &gt;&gt; liftIO (exitWith ExitSuccess)\n-- Posting when something was last posted shouldn't count as last posted.\neval     \"!last said\"          = getLastPosted &gt;&gt;= (\\t -&gt; write \"PRIVMSG\" (chan ++ \" :\" ++ t))\neval x | \"!id \" `isPrefixOf` x = privmsg (drop 4 x)\neval     _                     = return () -- ignore everything else\n\ngetLastPosted :: Net String\ngetLastPosted = do\n  t &lt;- gets lastPosted\n  return $ show t\n\n-- Send a privmsg to the current chan + server\nprivmsg :: String -&gt; Net ()\nprivmsg s = write \"PRIVMSG\" (chan ++ \" :\" ++ s)\n\n-- Send a message out to the server we're currently connected to\nwrite :: String -&gt; String -&gt; Net ()\nwrite s t = do\n    h &lt;- gets socket\n    liftIO $ hPrintf h \"%s %s\\r\\n\" s t\n    liftIO $ printf    \"&gt; %s %s\\n\" s t\n</code></pre>\n\n<h2>Other support avenues explored</h2>\n\n<ul>\n<li><p>spent a couple of days reading up on ReaderT, StateT and their non-transformer friends Reader and State,</p></li>\n<li><p>checking Stack Overflow for anyone with a similar problem, but the only other IRC bot question threaded the socket as an argument to every function that needed it (instead of using a ReaderT),</p></li>\n<li><p><a href=\"https://twitter.com/toiletgoodies/status/653044698945163264\" rel=\"nofollow\">Tweeted Don S.</a> the original author of the wiki page</p></li>\n<li><p>asked in the Haskell IRC channel.</p></li>\n</ul>\n\n<h1>Question</h1>\n\n<p>How can the Haskell wiki IRC bot be extended to post a message, containing the date and time stamp of the last message posted? Preferably using an abstraction like ReaderT (only allowing mutable state) rather than passing  state around in function arguments.</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 5439031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35ad94b396b650488007bb9de5766ac7?s=128&d=identicon&r=PG&f=1", "display_name": "ntb457", "link": "https://stackoverflow.com/users/5439031/ntb457"}, "edited": false, "score": 0, "creation_date": 1444712610, "post_id": 33093516, "comment_id": 54004750, "body": "I had to make a slight edit, but I believe your answer still applies. I understand the first two parts, but what exactly does _ == _ mean?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 31, "user_id": 5439031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35ad94b396b650488007bb9de5766ac7?s=128&d=identicon&r=PG&f=1", "display_name": "ntb457", "link": "https://stackoverflow.com/users/5439031/ntb457"}, "edited": false, "score": 1, "creation_date": 1444713082, "post_id": 33093516, "comment_id": 54004930, "body": "@ntb457, <code>_</code> is a pattern that matches anything and binds nothing. <code>_ == _ = ...</code> is basically the same as <code>x == y = ...</code> but it explicitly says we won&#39;t use those values."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 5, "last_activity_date": 1444707938, "last_edit_date": 1444707938, "creation_date": 1444706169, "answer_id": 33093516, "question_id": 33093403, "link": "https://stackoverflow.com/questions/33093403/defined-eq-and-neq-in-haskell/33093516#33093516", "title": "Defined eq and neq in Haskell", "body": "<p>There is no need to define <code>/=</code> explicitly, because its default definition is perfectly good. There's also no real need for a special <code>eq</code> function&mdash;you can define <code>==</code> directly. Here's a template (with a hint!) to start off.</p>\n\n<pre><code>instance Eq Nat where\n  Z == Z = ?\n  S m == S n = ???\n  _ == _ = ?\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 5439031, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/35ad94b396b650488007bb9de5766ac7?s=128&d=identicon&r=PG&f=1", "display_name": "ntb457", "link": "https://stackoverflow.com/users/5439031/ntb457"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 364, "favorite_count": 0, "accepted_answer_id": 33093516, "answer_count": 1, "score": 0, "last_activity_date": 1444712496, "creation_date": 1444705285, "last_edit_date": 1444712496, "question_id": 33093403, "link": "https://stackoverflow.com/questions/33093403/defined-eq-and-neq-in-haskell", "title": "Defined eq and neq in Haskell", "body": "<p>I'm a complete beginner in Haskell. I need to define eq and neq.</p>\n\n<pre><code>data Nat = Z | S Nat\nderiving (Show)\n\ntoInt :: Nat -&gt; Int\ntoInt Z = 0\ntoInt (S n) = 1 + toInt n\n\ntoNat :: Int -&gt; Nat\ntoNat n | n &lt; 0 = error \"Nats do not support negative numbers!\"\ntoNat 0 = Z\ntoNat n = S (toNat (n-1))\n\ninstance Eq Nat where\n(==) = eq\n(/=) = neq\n</code></pre>\n\n<p>Didn't mean to post instance. Correct code below: </p>\n\n<pre><code>eq :: Nat -&gt; Nat -&gt; Bool\neq a b =\n</code></pre>\n"}, {"tags": ["arrays", "haskell", "setter"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444705781, "post_id": 33093283, "comment_id": 54002790, "body": "You probably want to look at the <code>Ixed</code> class in <a href=\"https://hackage.haskell.org/package/lens-4.13/docs/Control-Lens-At.html\" rel=\"nofollow noreferrer\"><code>Control.Lens.At</code></a>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1709237"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444705807, "post_id": 33093283, "comment_id": 54002800, "body": "Thanks, I&#39;ll look at it right now"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1709237"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444706040, "post_id": 33093283, "comment_id": 54002847, "body": "It appears that Control.Lens.At is used for Lists, not Arrays unfortunately"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444706238, "post_id": 33093283, "comment_id": 54002892, "body": "it can be used for lots of things, but you need <code>Ixed</code>, which can be used for even more."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444706292, "post_id": 33093283, "comment_id": 54002907, "body": "The examples in the documentation may show lists, but there are many other instances, including for arrays. Look at the instance list right under the class definition."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444714953, "post_id": 33093283, "comment_id": 54005626, "body": "Related, but perhaps more depth than necessary: <a href=\"http://stackoverflow.com/questions/18414177/what-is-the-difference-between-ix-and-at-in-the-lens-library-of-haskell\" title=\"what is the difference between ix and at in the lens library of haskell\">stackoverflow.com/questions/18414177/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 1, "last_activity_date": 1444711692, "last_edit_date": 1444711692, "creation_date": 1444711330, "answer_id": 33094272, "question_id": 33093283, "link": "https://stackoverflow.com/questions/33093283/how-to-make-setters-in-2d-array-haskell/33094272#33094272", "title": "How to make setters in 2D Array Haskell", "body": "<p>The simplest <a href=\"http://hackage.haskell.org/package/array-0.5.1.0/docs/Data-Array-IArray.html#g:5\" rel=\"nofollow\">update function</a> for arrays is <code>(//)</code>, which has this type:</p>\n\n<pre><code>(//) :: (IArray a e, Ix i) =&gt; a i e -&gt; [(i, e)] -&gt; a i e \n</code></pre>\n\n<p>For example:</p>\n\n<pre><code>Data.Array.Unboxed&gt; listArray (0, 4) \"abcde\" // [(1, 'f')] :: UArray Int Char\narray (0,4) [(0,'a'),(1,'f'),(2,'c'),(3,'d'),(4,'e')]\n</code></pre>\n\n<p>You can access particular elements with <code>(!)</code>:</p>\n\n<pre><code>Data.Array.Unboxed&gt; it ! 1\n'f'\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1709237"}, "edited": false, "score": 0, "creation_date": 1444714532, "post_id": 33094735, "comment_id": 54005439, "body": "Unfortunately, I get <code>Not in scope: ^?</code> <code>Perhaps you meant one of these:</code> <code>^ (imported from Prelude), ^^ (imported from Prelude)</code> From that statement"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444715048, "post_id": 33094735, "comment_id": 54005660, "body": "@anon, that&#39;s defined elsewhere; you&#39;ll get that <i>and</i> <code>Ixed</code> if you import <code>Control.Lens</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1709237"}, "edited": false, "score": 0, "creation_date": 1444715448, "post_id": 33094735, "comment_id": 54005837, "body": "Final error (I hope) <code>parse error in let binding: missing required &quot;in&quot;</code> I believe this is simply because I am doing something stupid with binding the value using <code>let</code>"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444715587, "post_id": 33094735, "comment_id": 54005899, "body": "@anon, that was part of a GHCi session, which handles <code>let</code> differently. In a module, you&#39;d just write <code>fooArray&#39; = fooArray &amp; ix (1,2) .~ &#39;t&#39;</code> (preferably with a type signature above it), and leave out the <code>let</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1709237"}, "edited": false, "score": 0, "creation_date": 1444715826, "post_id": 33094735, "comment_id": 54006004, "body": "That fixed it, thanks so much for your time and patients!"}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 0, "last_activity_date": 1444713891, "creation_date": 1444713891, "answer_id": 33094735, "question_id": 33093283, "link": "https://stackoverflow.com/questions/33093283/how-to-make-setters-in-2d-array-haskell/33094735#33094735", "title": "How to make setters in 2D Array Haskell", "body": "<p>To access individual elements of an array with <code>lens</code>, you need to use the <code>ix</code> method of the <code>Ixed</code> class, defined in <a href=\"https://hackage.haskell.org/package/lens/docs/Control-Lens-At.html\" rel=\"nofollow\"><code>Control.Lens.At</code></a>. If you define</p>\n\n<pre><code>fooArray :: UArray (Int, Int) Char\nfooArray = listArray ((0,0), (9,9)) (replicate 100 'f')\n</code></pre>\n\n<p>then, firing up GHCi,</p>\n\n<pre><code>&gt; fooArray ^? ix (1,2)\nJust 'f'\n&gt; let fooArray' = fooArray &amp; ix (1,2) .~ 't'\n&gt; fooArray' ^? ix (1,2)\nJust 't'\n</code></pre>\n\n<p>Note that editing arrays like this is pretty inefficient if the arrays are large; if you need high speed or lots of array edits, you may want to consider a different structure.</p>\n\n<p>The easiest ways to smash an array flat are the <code>elems</code> function from <code>Data.Array.Unboxed</code> or <code>toList</code> from <code>Data.Foldable</code>. If what those give you is sideways, you can probably patch it up with <code>ixmap</code>.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1709237"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 407, "favorite_count": 0, "accepted_answer_id": 33094735, "answer_count": 2, "score": 1, "last_activity_date": 1444767863, "creation_date": 1444704380, "last_edit_date": 1444767863, "question_id": 33093283, "link": "https://stackoverflow.com/questions/33093283/how-to-make-setters-in-2d-array-haskell", "title": "How to make setters in 2D Array Haskell", "body": "<p>I currently have a 2D array declared as:</p>\n\n<pre><code>import Data.Array.Unboxed\nlistArray ((0,0), (9,9)) (replicate 100 'f') \u2237  UArray (Int, Int) Char\n</code></pre>\n\n<p>I am trying to set a value in this array from a set of coordinates, <code>(x, y)</code> stored as a tuple, changing the value into a <code>t</code>, instead of an <code>f</code>.  I have fooled around with lenses, however, I have had no success with them.</p>\n\n<p>Any help is appreciated!</p>\n"}, {"tags": ["haskell", "type-theory"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444710071, "post_id": 33093888, "comment_id": 54003919, "body": "There aren&#39;t any good terms of type <code>forall a . a</code>, but there are plenty of sensible polymorphic terms. I don&#39;t see why I wouldn&#39;t want <i>those</i>..."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 3, "creation_date": 1444710185, "post_id": 33093888, "comment_id": 54003956, "body": "@dfeuer Yep, there&#39;s plenty of sensible polymorphic terms. But (in a predicative system) there aren&#39;t any terms whose type is a list with polymorphic element type, no matter which polymorphic element type you pick!"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444710269, "post_id": 33093888, "comment_id": 54003983, "body": "@DanielWagner, ah, I think I see what you mean now."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444710381, "post_id": 33093888, "comment_id": 54004013, "body": "@dfeuer Now, an objection on the other side of the argument might be that <code>forall a. a</code> is a useful type to allow <i>despite</i> the fact that it has no inhabitants; and so <code>[forall a. a]</code> might also be useful despite having no inhabitants. To that I can only sadly agree."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444711822, "post_id": 33093888, "comment_id": 54004463, "body": "I&#39;m also curious if you know why higher-rank types are easier than general impredicativity."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444712200, "post_id": 33093888, "comment_id": 54004596, "body": "<code>[forall a . a]</code> is inhabited by <code>[]</code>."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 4, "creation_date": 1444714793, "post_id": 33093888, "comment_id": 54005539, "body": "@dfeuer In a predicative system, <code>[forall a. a]</code> is <i>not</i> inhabited by <code>[]</code>; for that to be true, we would have to instantiate <code>[] :: forall b. [b]</code> by substituting a polymorphic type for <code>b</code>, which is not allowed in predicative systems. I discuss this explicitly in my answer."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444755277, "post_id": 33093888, "comment_id": 54031220, "body": "To whoever suggested the &quot;principle types -&gt; principal types&quot; edit, you&#39;re absolutely right and I&#39;m sorry your edit was rejected. I&#39;ve updated the answer myself."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1444755412, "post_id": 33093888, "comment_id": 54031296, "body": "@dfeuer Also, to answer your question: I do not know why higher-rank types are easier than general impredicativity. If you want to find out, I suggest you look for a good paper on bidirectional type checking (which I believe is the general technique used for type-checking higher-rank terms) and compare it to the boxy types paper I linked in the answer."}], "tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": false, "score": 44, "last_activity_date": 1613772808, "last_edit_date": 1613772808, "creation_date": 1444708855, "answer_id": 33093888, "question_id": 33092864, "link": "https://stackoverflow.com/questions/33092864/what-is-predicativity/33093888#33093888", "title": "What is predicativity?", "body": "<p>The central question of these type systems is: &quot;Can you substitute a polymorphic type in for a type variable?&quot;. Predicative type systems are the no-nonsense schoolmarm answering, &quot;ABSOLUTELY NOT&quot;, while impredicative type systems are your carefree buddy who thinks that sounds like a fun idea and what could possibly go wrong?</p>\n<p>Now, Haskell muddies the discussion a bit because it believes polymorphism should be useful but invisible. So for the remainder of this post, I will be writing in a dialect of Haskell where uses of <code>forall</code> are not just allowed but required. This way we can distinguish between the type <code>a</code>, which is a monomorphic type which draws its value from a typing environment that we can define later, and the type <code>forall a. a</code>, which is one of the harder polymorphic types to inhabit. We'll also allow <code>forall</code> to go pretty much anywhere in a type -- as we'll see, GHC restricts its type syntax as a &quot;fail-fast&quot; mechanism rather than as a technical requirement.</p>\n<p>Suppose we have told the compiler <code>id :: forall a. a -&gt; a</code>. Can we later ask to use <code>id</code> as if it had type <code>(forall b. b) -&gt; (forall b. b)</code>? Impredicative type systems are okay with this, because we can instantiate the quantifier in <code>id</code>'s type to <code>forall b. b</code>, and substitute <code>forall b. b</code> for <code>a</code> everywhere in the result. Predicative type systems are a bit more wary of that: only monomorphic types are allowed in. (So if we had a particular <code>b</code>, we could write <code>id :: b -&gt; b</code>.)</p>\n<p>There's a similar story about <code>[] :: forall a. [a]</code> and <code>(:) :: forall a. a -&gt; [a] -&gt; [a]</code>. While your carefree buddy may be okay with <code>[] :: [forall b. b]</code> and <code>(:) :: (forall b. b) -&gt; [forall b. b] -&gt; [forall b. b]</code>, the predicative schoolmarm isn't, so much. In fact, as you can see from the only two constructors of lists, there <em>is</em> no way to produce lists containing polymorphic values without instantiating the type variable in their constructors to a polymorphic value. So although the type <code>[forall b. b]</code> is <em>allowed</em> in our dialect of Haskell, it isn't really sensible -- there's no (terminating) terms of that type. This motivates GHC's decision to complain if you even think about such a type -- it's the compiler's way of telling you &quot;don't bother&quot;.*</p>\n<p>Well, what makes the schoolmarm so strict? As usual, the answer is about keeping type-checking and type-inference doable. Type inference for impredicative types is right out. Type checking <a href=\"http://repository.upenn.edu/cgi/viewcontent.cgi?article=1291&amp;context=cis_papers\" rel=\"nofollow noreferrer\">seems like it might be possible</a>, but it's bloody complicated and nobody wants to maintain that.</p>\n<p>On the other hand, some might object that GHC is perfectly happy with some types that appear to require impredicativity:</p>\n<pre><code>&gt; :set -Rank2Types\n&gt; :t id :: (forall b. b) -&gt; (forall b. b)\n{- no complaint, but very chatty -}\n</code></pre>\n<p>It turns out that some slightly-restricted versions of impredicativity are not too bad: specifically, type-checking higher-rank types (which allow type variables to be substituted by polymorphic types when they are only arguments to <code>(-&gt;)</code>) is relatively simple. You do lose type inference above rank-2, and principal types above rank-1, but sometimes higher rank types are just what the doctor ordered.</p>\n<p>I don't know about the etymology of the word, though.</p>\n<p>* You might wonder whether you can do something like this:</p>\n<pre><code>data FooTy a where\n     FooTm :: FooTy (forall a. a)\n</code></pre>\n<p>Then you would get a term (<code>FooTm</code>) whose type had something polymorphic as an argument to something other than <code>(-&gt;)</code> (namely, <code>FooTy</code>), you don't have to cross the schoolmarm to do it, and so the belief &quot;applying non-<code>(-&gt;)</code> stuff to polymorphic types isn't useful because you can't make them&quot; would be invalidated. GHC doesn't let you write <code>FooTy</code>, and I will admit I'm not sure whether there's a principled reason for the restriction or not.</p>\n<p>(Quick update some years later: there <em>is</em> a good, principled reason that <code>FooTm</code> is still not okay. Namely, the way that GADTs are implemented in GHC is via type equalities, so the expanded type of <code>FooTm</code> is actually <code>FooTm :: forall a. (a ~ forall b. b) =&gt; FooTy a</code>. Hence to actually use <code>FooTm</code>, one would indeed need to instantiate a type variable with a polymorphic type. Thanks to Stephanie Weirich for pointing this out to me.)</p>\n"}, {"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": true, "score": 25, "last_activity_date": 1444716044, "creation_date": 1444716044, "answer_id": 33095199, "question_id": 33092864, "link": "https://stackoverflow.com/questions/33092864/what-is-predicativity/33095199#33095199", "title": "What is predicativity?", "body": "<p>Let me just add a point regarding the \"etymology\" issue, since the other answer by @DanielWagner covers much of the technical ground.</p>\n\n<p>A predicate on something like <code>a</code> is <code>a -&gt; Bool</code>. Now a predicate logic is one that can in some sense reason about predicates -- so if we have some predicate <code>P</code> and we can talk about, for a given <code>a</code>, <code>P(a)</code>, now in a \"predicate logic\" (such as first-order logic) we can also say <code>\u2200a. P(a)</code>. So we can quantify over variables and discuss the behavior of predicates over such things.</p>\n\n<p>Now, in turn, we say a statement is predicative if all of the things a predicate is applied to are introduced <em>prior</em> to it. So statements are \"predicated on\" things that already exist. In turn, a statement is impredicative if it can in some sense refer to itself by its \"bootstraps\".</p>\n\n<p>So in the case of e.g. the <code>id</code> example above, we find that we can give a type to <code>id</code> such that it takes something of the <em>type</em> of <code>id</code> to something else of the <em>type</em> of <code>id</code>. So now we can give a function a type where an quantified variable (introduced by <code>forall a.</code>) can \"expand\" to be the same type as that of the entire function itself!</p>\n\n<p>Hence impredicativity introduces a possibility of a certain \"self reference\". But wait, you might say, wouldn't such a thing lead to contradiction? The answer is: \"well, sometimes.\" In particular, \"System F\" which is the polymorphic lambda calculus and the essential \"core\" of GHC's \"core\" language allows a form of impredicativity that nonetheless has two levels -- the value level, and the type level, which is allowed to quantify over itself. In this two-level stratification, we can have impredicativity and <em>not</em> contradiction/paradox.</p>\n\n<p>Although note that this neat trick is <em>very</em> delicate and easy to screw up by the addition of more features, as this collection of articles by Oleg indicates: <a href=\"http://okmij.org/ftp/Haskell/impredicativity-bites.html\">http://okmij.org/ftp/Haskell/impredicativity-bites.html</a></p>\n"}, {"comments": [{"owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "edited": false, "score": 2, "creation_date": 1444841634, "post_id": 33119077, "comment_id": 54074068, "body": "Thanks for that added historical context here. Much appreciated!"}, {"owner": {"reputation": 3295, "user_id": 388010, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/f6c6f0feb5cb53e7023d5d9ecc443767?s=128&d=identicon&r=PG", "display_name": "Sebastian Graf", "link": "https://stackoverflow.com/users/388010/sebastian-graf"}, "edited": false, "score": 0, "creation_date": 1492525318, "post_id": 33119077, "comment_id": 74004639, "body": "So, for some lax restriction <code>R</code>, it doesn&#39;t buy us much to be <code>R</code>-predicative in terms of consistency, right? &#39;Predicative&#39; in that sense doesn&#39;t imply consistency, as in &#39;paradox-free&#39;, if I&#39;m not mistaken..."}], "tags": [], "owner": {"reputation": 629, "user_id": 358069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y3Mi3.jpg?s=128&g=1", "display_name": "wren romano", "link": "https://stackoverflow.com/users/358069/wren-romano"}, "is_accepted": false, "score": 16, "last_activity_date": 1444807357, "creation_date": 1444807357, "answer_id": 33119077, "question_id": 33092864, "link": "https://stackoverflow.com/questions/33092864/what-is-predicativity/33119077#33119077", "title": "What is predicativity?", "body": "<p>I'd like to make a comment on the etymology issue, since @sclv's answer isn't quite right (etymologically, not conceptually).</p>\n\n<p>Go back in time, to the days of Russell when everything is set theory\u2014 including logic. One of the logical notions of particular import is the \"principle of comprehension\"; that is, given some logical predicate <code>\u03c6:A\u21922</code> we would like to have some principle to determine the set of all elements satisfying that predicate, written as \"<code>{x | \u03c6(x) }</code>\" or some variation thereon. The key point to bear in mind is that \"sets\" and \"predicates\" are viewed as being fundamentally different things: predicates are mappings from objects to truth values, and sets are objects. Thus, for example, we may allow quantifying over sets but not quantifying over predicates.</p>\n\n<p>Now, Russell was rather concerned by his eponymous paradox, and sought some way to get rid of it. There are numerous fixes, but the one of interest here is to restrict the principle of comprehension. But first, the formal definition of the principle: <code>\u2203S.\u2200x.S x \u2194\ufe0e \u03c6(x)</code>; that is, for our particular <code>\u03c6</code> there exists some object (i.e., set) <code>S</code> such that for every object (also a set, but thought of as an element) <code>x</code>, we have that <code>S x</code> (you can think of this as meaning \"<code>x\u2208S</code>\", though logicians of the time gave \"<code>\u2208</code>\" a different meaning than mere juxtaposition) is true just in case <code>\u03c6(x)</code> is true. If we take the principle exactly as written then we end up with an impredicative theory. However, we can place restrictions on which <code>\u03c6</code> we're allowed to take the comprehension of. (For example, if we say that <code>\u03c6</code> must not contain any second-order quantifiers.) Thus, for any restriction <code>R</code>, if a set <code>S</code> is determined (i.e., generated via comprehension) by some <code>R</code>-predicate, then we say that <code>S</code> is \"<code>R</code>-predicative\". If every set in our language is <code>R</code>-predicative then we say that our language is \"<code>R</code>-predicative\". And then, as is often the case with hyphenated prefix things, the prefix gets dropped off and left implicit, whence \"predicative\" languages. And, naturally, languages which are not predicative are \"impredicative\".</p>\n\n<p>That's the old school etymology. Since those days the terms have gone off and gotten lives of their own. The ways we use \"predicative\" and \"impredicative\" today are quite different, because the things we're concerned about have changed. So it can sometimes be a bit hard to see how the heck our modern usage ties back to this stuff. Honestly, I don't think knowing the etymology really helps any in terms of figuring out what the words are really about (these days).</p>\n"}], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2185, "favorite_count": 16, "accepted_answer_id": 33095199, "answer_count": 3, "score": 44, "last_activity_date": 1613772808, "creation_date": 1444701055, "last_edit_date": 1444702608, "question_id": 33092864, "link": "https://stackoverflow.com/questions/33092864/what-is-predicativity", "title": "What is predicativity?", "body": "<p>I have pretty decent intuition about types Haskell prohibits as \"impredicative\": namely ones where a <code>forall</code> appears in an argument to a type constructor other than <code>-&gt;</code>. But just what is predicativity? What makes it important? How does it relate to the word \"predicate\"?</p>\n"}, {"tags": ["haskell", "lambda"], "comments": [{"owner": {"reputation": 21417, "user_id": 925978, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/06e4467a5bd1538a92cefb20db07897a?s=128&d=identicon&r=PG&f=1", "display_name": "crockeea", "link": "https://stackoverflow.com/users/925978/crockeea"}, "edited": false, "score": 3, "creation_date": 1444692109, "post_id": 33091532, "comment_id": 53999373, "body": "You should <i>ALWAYS</i> use type signatures, especially when you are learning. If you had, you would realize that your code creates a list of functions. Haskell&#39;s type system is powerful and helpful; use it! In your case, you wanted <code>firstall :: [(a,b)] -&gt; [a]</code>. See what happens when you add that."}, {"owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "edited": false, "score": 0, "creation_date": 1444692257, "post_id": 33091532, "comment_id": 53999415, "body": "What you want is <code>map fst</code>."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1444697773, "post_id": 33091578, "comment_id": 54000894, "body": "An alternative fix to providing the lambda with an argument is to drop the lambda entirely, writing <code>a : firstall xs</code> instead of <code>\\(a, b) -&gt; a : firstall xs</code> (so that the whole line becomes <code>firstall ((a,b) : xs) = a : firstall xs</code>).  I think that&#39;s probably closer to what DcCoO had in mind."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1444728893, "last_edit_date": 1444728893, "creation_date": 1444691089, "answer_id": 33091578, "question_id": 33091532, "link": "https://stackoverflow.com/questions/33091532/using-lambda-to-implement-list-function-in-haskell/33091578#33091578", "title": "using lambda to implement list function in haskell", "body": "<p>Your lambda expression simply is never called, you only define a lambda expression, you can call it with:</p>\n\n<pre><code>firstall ((a,b) : xs) = ((\\(a,b) -&gt; a) (a,b) : firstall(xs))\n</code></pre>\n\n<p>Now since you use <code>a</code> and <code>b</code> in your lambda expression as well, this is asking for trouble, a more accessible version is:</p>\n\n<pre><code>firstall ((a,b) : xs) = ((\\(c,d) -&gt; c) (a,b) : firstall(xs))\n</code></pre>\n\n<p>In other words you \"unify\" <code>(c,d)</code> with <code>(a,b)</code>. You can use <code>a</code> and <code>b</code> in your lambda expression, but it makes things for yourself.</p>\n\n<hr>\n\n<p>This being said, you can perform this task way easier:</p>\n\n<pre><code>firstall = map fst\n</code></pre>\n\n<p>which is short for:</p>\n\n<pre><code>firstall = map (\\(a,b) -&gt; a)\n</code></pre>\n\n<p>note that you don't need to specify an input parameter for <code>firstall</code>, since <code>map fst</code> is a function that will take as input a list.</p>\n\n<hr>\n\n<p>Finally, as @DanielWagner suggests, you can simply drop the lambda expression:</p>\n\n<pre><code>firstall ((a,_) : xs) = (a : firstall(xs))\n</code></pre>\n\n<p>the underscore (<code>_</code>) means you are not interested in the value: you only need the first element of the tuple.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5162677"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2023, "favorite_count": 1, "accepted_answer_id": 33091578, "answer_count": 1, "score": 1, "last_activity_date": 1444728893, "creation_date": 1444690784, "last_edit_date": 1444691183, "question_id": 33091532, "link": "https://stackoverflow.com/questions/33091532/using-lambda-to-implement-list-function-in-haskell", "title": "using lambda to implement list function in haskell", "body": "<p>I want to use lambda to create a function that gets as parameter a list of pairs and returns a list of the first elements of the first list. Example:</p>\n\n<pre><code>function [ (1,2), (3,4) (5,6) ] = [1,3,5]\n</code></pre>\n\n<p>I'm using lambda like this but it doesn't seem to work:</p>\n\n<pre><code>firstall [] = []\nfirstall ((a,b) : xs) = (\\(a,b) -&gt; a : firstall(xs))\n</code></pre>\n\n<p>maybe I'm doing it totally wrong. Can someone help me?</p>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 2, "creation_date": 1444685583, "post_id": 33090450, "comment_id": 53997118, "body": "I don&#39;t think this is even possible. We&#39;d have to go (operationally) from <code>Functor f -&gt; [LensLike f s t a b]</code> to <code>[Functor f -&gt; LensLike f s t a b]</code>. We need to pass in a <code>Functor f</code> to pull out a list to begin with, and there isn&#39;t one around."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 2, "creation_date": 1444685708, "post_id": 33090450, "comment_id": 53997172, "body": "@Andr&#225;sKov&#225;cs Perhaps we can use a parametricity argument to convince ourselves that functions of type <code>Functor f -&gt; [LensLike f s t a b]</code> must choose the length of their result list without inspecting the <code>Functor f</code> argument in a meaningful way. Then it&#39;s easy to get the rest of the way from there. (Of course this claim is clearly not true of functions of type <code>Functor F -&gt; [LensLike F s t a b]</code> for some particular <code>F</code>.)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1444685812, "post_id": 33090450, "comment_id": 53997207, "body": "@Andr&#225;sKovacs, that was my fear. We&#39;d need some kind of &quot;superfunctor&quot; dictionary we could pass in that would magically be able to take on the identity of any other <code>Functor</code> dictionary."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1444685900, "post_id": 33090450, "comment_id": 53997235, "body": "@DanielWagner, those were the vague outlines of my thinking."}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1444687082, "post_id": 33090450, "comment_id": 53997680, "body": "Still doesn&#39;t seem good to me. The returned lenslikes certainly depend on the functor instance. If we passed some dummy functor instance, they wouldn&#39;t work, and anyway we can only abstract over <code>Functor f</code> in <code>ReifiedLens</code> if we ignore the input instances, which again results in nonsense."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 1, "creation_date": 1444688997, "post_id": 33090450, "comment_id": 53998405, "body": "I&#39;d like to point out for the specific case of lenses, you can use <code>ALens</code> instead of <code>ReifiedLens</code>. I&#39;m wondering if there&#39;s a similar trick that works generally..."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1444689001, "post_id": 33090450, "comment_id": 53998407, "body": "@DanielWagner Assuming we do have such a parametricity guarantee, how to perform the conversion in Haskell? unsafe coercion? Would that be type-safe at runtime, in this case?"}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1444689682, "post_id": 33090450, "comment_id": 53998634, "body": "In fact, <code>ALens</code> is based on <a href=\"http://hackage.haskell.org/package/lens-4.13/docs/Control-Lens-Internal-Context.html#t:Pretext\" rel=\"nofollow noreferrer\"><code>Pretext</code></a>, which looks very much like a kind of &quot;superfunctor&quot;."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1444692956, "post_id": 33090450, "comment_id": 53999607, "body": "@chi, something like <a href=\"http://lpaste.net/142876\" rel=\"nofollow noreferrer\">this</a> perhaps."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1444694370, "post_id": 33090450, "comment_id": 53999952, "body": "@user3237465, that&#39;s a really neat trick, at least for lists. I can&#39;t tell if there&#39;s a way to generalize it."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 0, "creation_date": 1444698102, "post_id": 33090450, "comment_id": 54000976, "body": "I guess we can do the same for any polynomial functor and its least fixpoint. And when the shape is known statically (e.g. <code>Vec</code>) or fixpoint is the greatest (e.g. <code>Stream</code>), it&#39;s <a href=\"http://stackoverflow.com/a/27343524/3237465\">easier</a> (just take <code>m = (-&gt;) (Functor f)</code>)."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444751669, "post_id": 33091455, "comment_id": 54029074, "body": "I still find <code>Pretext</code> baffling. As applied to <code>(-&gt;)</code>, I can sort of see it as a partially applied lens, but its utility and generality still confuse me."}], "tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": true, "score": 5, "last_activity_date": 1444690633, "last_edit_date": 1444690633, "creation_date": 1444690302, "answer_id": 33091455, "question_id": 33090450, "link": "https://stackoverflow.com/questions/33090450/how-can-i-push-polymorphism-into-a-data-structure/33091455#33091455", "title": "How can I push polymorphism into a data structure?", "body": "<p>Testing out my idea in the comments, you can in fact write this directly by passing through <code>ALens</code>:</p>\n\n<pre><code>convert :: (forall f. Functor f =&gt; [LensLike f s t a b]) -&gt; [ReifiedLens s t a b]\nconvert ls = [Lens (cloneLens l) | l &lt;- ls]\n</code></pre>\n\n<p><code>ALens</code> is based on the <a href=\"http://hackage.haskell.org/package/lens-4.13/docs/Control-Lens-Internal-Context.html#t:Pretext\"><code>Pretext</code></a> functor:</p>\n\n<pre><code>type ALens s t a b = LensLike (Pretext (-&gt;) a b) s t a b\n\nnewtype Pretext p a b t = Pretext { runPretext :: forall f. Functor f =&gt; p a (f b) -&gt; f t }\n</code></pre>\n\n<p>This allows using a single <code>Functor</code> to represent all of them, at least for lens usage.</p>\n\n<p>I'm still wondering whether there's a method that works generally and not just for lenses.</p>\n"}], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 2, "accepted_answer_id": 33091455, "answer_count": 1, "score": 8, "last_activity_date": 1444690633, "creation_date": 1444684990, "last_edit_date": 1495541671, "question_id": 33090450, "link": "https://stackoverflow.com/questions/33090450/how-can-i-push-polymorphism-into-a-data-structure", "title": "How can I push polymorphism into a data structure?", "body": "<p>A <a href=\"https://stackoverflow.com/questions/33088563/why-do-we-need-control-lens-reified\">recent question</a> led me to wonder how to convert a</p>\n\n<pre><code>forall f . Functor f =&gt; [LensLike f s t a b]\n</code></pre>\n\n<p>into a</p>\n\n<pre><code>[ReifiedLens s t a b]\n</code></pre>\n\n<p>There's an easy way to do it really slowly, by indexing into the list with <code>!!</code>, but it's quite incredibly inefficient. It feels like there should be enough parametricity to pull a trick similar to the one used in <code>reflection</code>, but I can't seem to figure anything out. Is it possible to do this efficiently at all?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 5, "creation_date": 1444685251, "post_id": 33090412, "comment_id": 53996963, "body": "That&#39;s quite a strange assignment. You would never want <code>map</code> or <code>filter</code> to be tail recursive in Haskell!"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1444685322, "post_id": 33090412, "comment_id": 53996993, "body": "As for your question, I think you&#39;d best write it out by hand to satisfy your teacher--using <code>foldl</code> might seem like a cop-out."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444686022, "post_id": 33090412, "comment_id": 53997292, "body": "@dfeuer: I might just be tired, but I&#39;m not seeing it: why <i>you would never want <code>map</code> or <code>filter</code> to be tail recursive</i>...?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1444686175, "post_id": 33090412, "comment_id": 53997343, "body": "@ErikAllik, you lose spine laziness, which makes the functions less useful while also (for long lists) slowing them down."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1444686220, "post_id": 33090412, "comment_id": 53997363, "body": "so you mean tail recursion as opposed to what?"}, {"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 1, "creation_date": 1444702561, "post_id": 33090412, "comment_id": 54001994, "body": "@ErikAllik as opposed to <a href=\"http://blog.sigfpe.com/2007/07/data-and-codata.html\" rel=\"nofollow noreferrer\">guarded recursion</a>. Note that <code>map f (x:xs) = f x : map f xs</code> is not tail recursive"}], "answers": [{"tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": false, "score": 2, "last_activity_date": 1444685857, "last_edit_date": 1444685857, "creation_date": 1444685529, "answer_id": 33090579, "question_id": 33090412, "link": "https://stackoverflow.com/questions/33090412/if-i-can-define-a-function-in-terms-of-foldl-would-it-make-it-tail-recursive/33090579#33090579", "title": "If I can define a function in terms of foldl, would it make it tail recursive?", "body": "<p>I'm suspecting the professor/lecturer is expecting solutions where tail recursion is used \"directly\", i.e. lexically, within the source code of the function, not indirectly, or \"dynamically\", where tail recursion only happens at runtime within the scope of some subroutine call.</p>\n\n<p>Otherwise, you might as well supply e.g. <code>Prelude.foldl</code> as the implementation for a custom <code>foldl</code> of yours, since it, possibly, uses tail recursion under the hood, and thus does yours:</p>\n\n<pre><code>import Prelude as P\n\nfoldl = P.foldl\n</code></pre>\n\n<p>but obviously something like that wouldn't be accepted.</p>\n"}, {"tags": [], "owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "is_accepted": false, "score": 6, "last_activity_date": 1444692330, "last_edit_date": 1444692330, "creation_date": 1444691927, "answer_id": 33091713, "question_id": 33090412, "link": "https://stackoverflow.com/questions/33090412/if-i-can-define-a-function-in-terms-of-foldl-would-it-make-it-tail-recursive/33091713#33091713", "title": "If I can define a function in terms of foldl, would it make it tail recursive?", "body": "<p>There are two ways to make a recursive function tail recursive:</p>\n\n<ol>\n<li>Convert the function to accumulator passing style. This only works in some cases.</li>\n<li>Convert the function to continuation passing style. This works in all cases.</li>\n</ol>\n\n<p>Consider the definition of the <code>map</code> function:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]\nmap _ []     = []\nmap f (x:xs) = f x : map f xs\n</code></pre>\n\n<p>In accumulator passing style, we have an additional argument which accumulates the result:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>mapA :: (a -&gt; b) -&gt; [a] -&gt; [b] -&gt; [b]\nmapA _ []     = id\nmapA f (x:xs) = mapA f xs . (f x :)\n</code></pre>\n\n<p>The original <code>map</code> function can be recovered as follows:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]\nmap f xs = reverse $ mapA f xs []\n</code></pre>\n\n<p>Note that we need to <code>reverse</code> the result. This is because <code>mapA</code> accumulates the result in reverse:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>&gt; mapA (+1) [1,2,3,4,5] []\n&gt; mapA (+1) [2,3,4,5]  [2]\n&gt; mapA (+1) [3,4,5]  [3,2]\n&gt; mapA (+1) [3,5]  [4,3,2]\n&gt; mapA (+1) [5]  [5,4,3,2]\n&gt; mapA (+1) [] [6,5,4,3,2]\n&gt; [6,5,4,3,2]\n</code></pre>\n\n<p>Now, consider continuation passing style:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>mapK :: (a -&gt; b) -&gt; [a] -&gt; ([b] -&gt; r) -&gt; r\nmapK _ []     k = k []\nmapK f (x:xs) k = mapK f xs (k . (f x :))\n</code></pre>\n\n<p>The original <code>map</code> function can be recovered as follows:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]\nmap f xs = mapK f xs id\n</code></pre>\n\n<p>Note that we do not need to <code>reverse</code> the result. This is because although <code>mapK</code> accumulates the continuations in reverse, yet when finally applied to the base case the continuations are unfolded to produce the result in the correct order:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>&gt; mapK (+1) [1,2,3,4,5] id\n&gt; mapK (+1) [2,3,4,5]  (id . (2:))\n&gt; mapK (+1) [3,4,5]    (id . (2:) . (3:))\n&gt; mapK (+1) [4,5]      (id . (2:) . (3:) . (4:))\n&gt; mapK (+1) [5]        (id . (2:) . (3:) . (4:) . (5:))\n&gt; mapK (+1) []         (id . (2:) . (3:) . (4:) . (5:) . (6:))\n&gt; (id . (2:) . (3:) . (4:) . (5:) . (6:)) []\n&gt; (id . (2:) . (3:) . (4:) . (5:))       [6]\n&gt; (id . (2:) . (3:) . (4:))            [5,6]\n&gt; (id . (2:) . (3:))                 [4,5,6]\n&gt; (id . (2:))                      [3,4,5,6]\n&gt;  id                            [2,3,4,5,6]\n&gt; [2,3,4,5,6]\n</code></pre>\n\n<p>Note, that in both cases we're doing twice the required amount of work:</p>\n\n<ol>\n<li>First, we accumulate an intermediate result in reverse order.</li>\n<li>Next, we produce the final result in the correct order.</li>\n</ol>\n\n<p>Some functions can be written efficiently in the accumulator passing style (e.g. the <code>sum</code> function):</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>sumA :: Num a =&gt; [a] -&gt; a -&gt; a\nsumA []     = id\nsumA (x:xs) = sumA xs . (+ x)\n</code></pre>\n\n<p>The original <code>sum</code> function can be recovered as follows:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>sum :: Num a =&gt; [a] -&gt; a\nsum xs = sumA xs 0\n</code></pre>\n\n<p>Note that we don't need to do any post processing on the result.</p>\n\n<p>However, list functions written in tail recursive style always need to be reversed. Hence, we do not write list functions in tail recursive style. Instead, we depend upon laziness to process only as much of the list as required.</p>\n\n<p>It should be noted that continuation passing style is just a special case of accumulator passing style. Since <code>foldl</code> is both tail recursive and uses an accumulator, you can write <code>mapA</code> and <code>mapK</code> using <code>foldl</code> as follows:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>mapA :: (a -&gt; b) -&gt; [a] -&gt; [b] -&gt; [b]\nmapA f xs acc = foldl (\\xs x -&gt; f x : xs) acc xs\n\nmapK :: ([b] -&gt; r) -&gt; (a -&gt; b) -&gt; [a] -&gt; r\nmapK k f xs = foldl (\\k x xs -&gt; k (f x : xs)) k xs []\n</code></pre>\n\n<p>For, <code>mapK</code> if you take the <code>k</code> to be <code>id</code> then you get <code>map</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]\nmap f xs = foldl (\\k x xs -&gt; k (f x : xs)) id xs []\n</code></pre>\n\n<p>Similarly, for <code>filter</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>filter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]\nfilter p xs = foldl (\\k x xs -&gt; k (if p x then x : xs else xs)) id xs []\n</code></pre>\n\n<p>There you have it, tail recursive <code>map</code> and <code>filter</code> functions. However, don't forget that they are actually doing twice the work. In addition, they won't work for infinite lists because the result will not be generated until the end of the list is reached (which will never happen for infinite lists).</p>\n"}], "owner": {"reputation": 51, "user_id": 4556703, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/ddb3e451925a47750a10b8b200b6aa20?s=128&d=identicon&r=PG&f=1", "display_name": "pcd13", "link": "https://stackoverflow.com/users/4556703/pcd13"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1444692330, "creation_date": 1444684820, "last_edit_date": 1444686182, "question_id": 33090412, "link": "https://stackoverflow.com/questions/33090412/if-i-can-define-a-function-in-terms-of-foldl-would-it-make-it-tail-recursive", "title": "If I can define a function in terms of foldl, would it make it tail recursive?", "body": "<p>I was given an assignment in my functional programming course that asks me to rewrite several functions, like <code>map</code> and <code>filter</code> to be tail recursive. </p>\n\n<p>I'm not 100% sure how to go about this yet but I know that you can define functions by calling <code>foldr</code> and <code>foldl</code>. I know <code>foldl</code> is tail recursive, so if I can define say, <code>filter</code> with <code>foldl</code>, would it become tail recursive, too?</p>\n"}, {"tags": ["haskell", "member", "fold"], "comments": [{"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "edited": false, "score": 4, "creation_date": 1444681309, "post_id": 33089505, "comment_id": 53995192, "body": "Try giving <code>member</code> the type signature you think it should have and see what the compiler tells you."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1444681447, "post_id": 33089505, "comment_id": 53995254, "body": "The last version is close to <code>foldr</code>: try using <code>if..then..else</code> instead of guards as an intermediate step. Use lambdas accordingly."}, {"owner": {"user_type": "does_not_exist", "display_name": "user5162677"}, "edited": false, "score": 0, "creation_date": 1444682062, "post_id": 33089505, "comment_id": 53995517, "body": "the mission is to make &quot;member&quot; using &quot;foldr&quot;, I don&#39;t think its necessary to use &quot;if...else...then&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1444698175, "post_id": 33089774, "comment_id": 54000992, "body": "Isn&#39;t it much better to flip the arguments to <code>||</code> in <code>foldr (\\x acc -&gt; acc || e == x) False</code>, to avoid searching past the first match? Or, using the equivalent section, <code>foldr (\\x -&gt; (x == e ||) False</code>? I think that must be what you intended, since you mention in your answer that it is lazy, which it&#39;s actually not."}, {"owner": {"reputation": 144, "user_id": 1808054, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/GLsdL.png?s=128&g=1", "display_name": "Ori", "link": "https://stackoverflow.com/users/1808054/ori"}, "edited": false, "score": 0, "creation_date": 1444736448, "post_id": 33089774, "comment_id": 54018162, "body": "Did you mean <code>member e xs = foldr (\\x acc -&gt; if x == e then True else acc) False xs</code> ? @bheklilr"}], "tags": [], "owner": {"reputation": 51584, "user_id": 839246, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9b0573c2b936b12828dd1e4cc04206dc?s=128&d=identicon&r=PG&f=1", "display_name": "bheklilr", "link": "https://stackoverflow.com/users/839246/bheklilr"}, "is_accepted": true, "score": 7, "last_activity_date": 1444682528, "last_edit_date": 1444682528, "creation_date": 1444682156, "answer_id": 33089774, "question_id": 33089505, "link": "https://stackoverflow.com/questions/33089505/implementation-of-function-member-using-foldr-in-haskell/33089774#33089774", "title": "Implementation of function &quot;member&quot; using &quot;foldr&quot; in Haskell", "body": "<p>You're almost there, but as you can see your types don't line up.  It would have been better if you had given <code>member</code> an explicit type signature, I'm guessing that you want something like</p>\n\n<pre><code>member :: (Eq a) =&gt; a -&gt; [a] -&gt; Bool\n</code></pre>\n\n<p>This would have made the compiler complain that this doesn't type check instead of failing when you tried to use it.  The problem is that <code>foldr (==)</code> has the type <code>Bool -&gt; [Bool] -&gt; Bool</code>, not quite what you were expecting.</p>\n\n<p>Instead, what you want is something more like</p>\n\n<pre><code>member e xs\n    = foldr (||)\n            False\n            (map (e ==) xs)\n</code></pre>\n\n<p>I've split up the arguments onto separate lines here so that it's easier to see what the arguments to <code>foldr</code> actually are.  The big idea here is to convert the list of values into a list of <code>Bool</code>s, then use the or operator (<code>||</code>) to reduce the list into a single <code>Bool</code>.  Since Haskell is lazy by default, <code>map (e ==) xs</code> won't actually compute anything until elements are needed by <code>foldr</code>, so you won't necessarily compare every element in the list to <code>e</code>.</p>\n\n<p>You could implement this directly with only <code>foldr</code> with a more complicated accumulator (the first argument to <code>foldr</code>):</p>\n\n<pre><code>member e xs = foldr (\\x acc -&gt; if acc then x else e == x) False xs\n</code></pre>\n\n<p>Which can equivalently be written as</p>\n\n<pre><code>member e xs = foldr (\\x acc -&gt; acc || e == x) False xs\n</code></pre>\n\n<p>Notice how in this case we have to perform <code>e == x</code> for every <code>x</code> in <code>xs</code> until we find a case where <code>acc</code> is <code>True</code>.  This is why I chose <code>map (e ==)</code> earlier, I just separated the step of performing the comparison from the step of accumulating the values.</p>\n\n<p>One thing to keep in mind with <code>foldr</code> (and most other folds) is that the second argument, also called the initial value, has to have the same type as final result of <code>foldr</code>.  In this case you're wanting <code>foldr</code> to return a <code>Bool</code>, so the second argument must be a <code>Bool</code> as well.</p>\n\n<p>A trick for working through these problems, provided you have a new enough version of GHC, is typed holes.  These allow you to put in \"holes\" in an expression and the compiler will tell you what type that hole should be, so if you do</p>\n\n<pre><code>member :: Eq a =&gt; a -&gt; [a] -&gt; Bool\nmember e xs = foldr _1 _2 xs\n</code></pre>\n\n<p>GHC will print out</p>\n\n<pre><code>Found hole `_1` with type: a -&gt; Bool -&gt; Bool\n...\nRelevant bindings include\n  xs :: [a]\n  e :: a\n\nFound hole `_2` with type: Bool\n...\nRelevant bindings include\n  xs :: [a]\n  e :: a\n</code></pre>\n\n<p>This tells you that the function given to <code>foldr</code> must have the type <code>a -&gt; Bool -&gt; Bool</code> and the initial value must have type <code>Bool</code>.  Since <code>e</code> has type <code>a</code> you can't put it as is in that hole.  This technique can help guide you through defining your functions, particularly when you aren't sure of all the types, with the compiler telling you what to use for each argument.</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 0, "last_activity_date": 1612877970, "creation_date": 1612877970, "answer_id": 66120130, "question_id": 33089505, "link": "https://stackoverflow.com/questions/33089505/implementation-of-function-member-using-foldr-in-haskell/66120130#66120130", "title": "Implementation of function &quot;member&quot; using &quot;foldr&quot; in Haskell", "body": "<p>We know that, with a pseudocode syntax,</p>\n<pre><code>foldr g z []            = z\nfoldr g z [a,b,c,...,n] = g a (foldr g z [b,c,...,n])\n</code></pre>\n<p>and we know that we want it to be</p>\n<pre><code>member x []            = False\nmember x [a,b,c,...,n] = (x==a) || member x   [b,c,...,n]\n                       = foldr g z [a,b,c,...,n] \n                       = g   a     (foldr g z [b,c,...,n])\n                                   ------------------------ r\n                       = (x==a) || (foldr g z [b,c,...,n])\n                       = foldr g z [a,b,c,...,n] \n                           where \n                               { z     = False ; \n                                 g a r = (x==a) || r }  --- r\n</code></pre>\n<p>and so with the regular Haskell syntax we define</p>\n<pre><code>member x  =  foldr g False  where  { g a r = (x==a) || r }\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5162677"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1513, "favorite_count": 1, "accepted_answer_id": 33089774, "answer_count": 2, "score": 3, "last_activity_date": 1612877970, "creation_date": 1444681112, "last_edit_date": 1444682154, "question_id": 33089505, "link": "https://stackoverflow.com/questions/33089505/implementation-of-function-member-using-foldr-in-haskell", "title": "Implementation of function &quot;member&quot; using &quot;foldr&quot; in Haskell", "body": "<p>I tried like that:</p>\n\n<pre><code>member e [] = False\nmember e xs = foldr (==) e xs\n</code></pre>\n\n<p>and then:</p>\n\n<pre><code>member 3 [1,2,3,4,5]\n</code></pre>\n\n<p>and I get this error message:</p>\n\n<pre><code>No instance for (Num Bool) arising from the literal `3'\nIn the first argument of `memb', namely `3'\n</code></pre>\n\n<p>I don't know what it means... can someone help me?</p>\n\n<p>PS: member is a function that, given a element and a list of elements, returns whether the element belongs to that list or not. The usual implementation is:</p>\n\n<pre><code>member a [] = False\nmember a (x:xs) | (a == x)  = True\n                | otherwise = member a xs\n</code></pre>\n\n<p>PS2: full code</p>\n\n<pre><code>-- member:: Int -&gt; [Int] -&gt; Bool (Not necessary)\nmember e [] = False\nmember e xs = foldr (==) e xs\n\nmain = do\n    putStrLn (show( member 3 [1,2,3] ) )\n</code></pre>\n"}, {"tags": ["macos", "haskell", "pcre", "cabal"], "answers": [{"tags": [], "owner": {"reputation": 6165, "user_id": 325268, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4a90b91a8bf2215ff649191b4fd9a436?s=128&d=identicon&r=PG", "display_name": "Luke Maurer", "link": "https://stackoverflow.com/users/325268/luke-maurer"}, "is_accepted": false, "score": 1, "last_activity_date": 1444680613, "creation_date": 1444680613, "answer_id": 33089385, "question_id": 33089384, "link": "https://stackoverflow.com/questions/33089384/how-can-i-install-pcre-light-on-os-x-without-root-access/33089385#33089385", "title": "How can I install pcre-light on OS X without root access?", "body": "<p>As it happens, Homebrew works perfectly well from inside <code>$HOME</code>:</p>\n\n<p><a href=\"http://www.acloudtree.com/how-to-install-the-homebrew-package-management-utility-locally-on-mac-osx/\" rel=\"nofollow\">http://www.acloudtree.com/how-to-install-the-homebrew-package-management-utility-locally-on-mac-osx/</a></p>\n\n<p>In short, you can install Homebrew simply by cloning the GitHub repo into <code>$HOME</code>, then adding <code>$HOME/homebrew/bin</code> to your <code>$PATH</code>. Then you can just say:</p>\n\n<pre><code>$ brew install pcre\n</code></pre>\n\n<p>Then tweak <code>$HOME/.cabal/config</code> like so:</p>\n\n<pre><code>extra-include-dirs: $HOME/homebrew/include\nextra-lib-dirs: $HOME/homebrew/lib\n</code></pre>\n\n<p>(but use the actual directory instead of <code>$HOME</code>). Now <code>cabal install pcre-light</code> should work normally.</p>\n"}], "owner": {"reputation": 6165, "user_id": 325268, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/4a90b91a8bf2215ff649191b4fd9a436?s=128&d=identicon&r=PG", "display_name": "Luke Maurer", "link": "https://stackoverflow.com/users/325268/luke-maurer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1444680613, "creation_date": 1444680613, "question_id": 33089384, "link": "https://stackoverflow.com/questions/33089384/how-can-i-install-pcre-light-on-os-x-without-root-access", "title": "How can I install pcre-light on OS X without root access?", "body": "<p>I'm working on a shared system where I don't have root access, but where the admins have installed the Haskell Platform. Most Cabal packages install perfectly happily, but I need a library with a dependency on <code>pcre-light</code>, which of course depends on the C library <code>pcre</code>. Is there an easy way to install <code>pcre</code> under <code>$HOME</code> so that I can get on with my work?</p>\n"}, {"tags": ["arrays", "haskell", "get", "set"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1444680876, "post_id": 33089293, "comment_id": 53995009, "body": "It&#39;s not really clear to me what you&#39;re asking. What exactly do you have, and what do you want? (Type signatures plz!) And what do you mean by \u201cwhich is a 2D list\u201d? I don&#39;t see any lists here."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1709237"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1444681065, "post_id": 33089293, "comment_id": 53995094, "body": "yup, no problem, let me update. sorry for the inconvenience."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1444682184, "post_id": 33089293, "comment_id": 53995575, "body": "Ok... now, is you question \u201chow do I get <code>progress</code> to work\u201d? (Note that you don&#39;t use <code>w</code> and <code>h</code> at all, at the moment \u2013 in fact the only thing you use of the old grid are the dimensions. That seems a bit weird.) Or are you just asking how to generate a <code>UArray (Int,Int) Bool</code> of given size, initialised to all <code>False</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1709237"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1444682771, "post_id": 33089293, "comment_id": 53995857, "body": "The only thing I am trying to do is generate a blank board, then set certain values to true."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1444687329, "post_id": 33089293, "comment_id": 53997760, "body": "Well, perhaps you&#39;d better post the entire code, because it&#39;s rather a puzzle right now, and still not clear where precisely you have a problem in achieving your goal."}], "answers": [{"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 0, "last_activity_date": 1444688630, "creation_date": 1444688630, "answer_id": 33091172, "question_id": 33089293, "link": "https://stackoverflow.com/questions/33089293/how-to-populate-a-2d-array-in-haskell/33091172#33091172", "title": "How to populate a 2D Array in Haskell", "body": "<p>You can make a <code>UArray</code> using the <code>array</code> function or the <code>listArray</code> function.  The first expects a list of indices and elements while the second expects a tuple indicating the index range and a list of elements that are paired with an index automatically (lexicographic order).</p>\n\n<pre><code>Data.Array.Unboxed&gt; listArray ((0,0), (9,9)) (replicate 100 False) :: UArray (Int,Int) Bool\narray ((0,0),(9,9)) [((0,0),False),((0,1),False),((0,2),False),((0,3),False),((0,4),False),((0,5),False),((0,6),False),((0,7),False),((0,8),False),((0,9),False),((1,0),False),((1,1),False),((1,2),False),((1,3),False),((1,4),False),((1,5),False),((1,6),False),((1,7),False),((1,8),False),((1,9),False),((2,0),False),((2,1),False),((2,2),False),((2,3),False),((2,4),False),((2,5),False),((2,6),False),((2,7),False),((2,8),False),((2,9),False),((3,0),False),((3,1),False),((3,2),False),((3,3),False),((3,4),False),((3,5),False),((3,6),False),((3,7),False),((3,8),False),((3,9),False),((4,0),False),((4,1),False),((4,2),False),((4,3),False),((4,4),False),((4,5),False),((4,6),False),((4,7),False),((4,8),False),((4,9),False),((5,0),False),((5,1),False),((5,2),False),((5,3),False),((5,4),False),((5,5),False),((5,6),False),((5,7),False),((5,8),False),((5,9),False),((6,0),False),((6,1),False),((6,2),False),((6,3),False),((6,4),False),((6,5),False),((6,6),False),((6,7),False),((6,8),False),((6,9),False),((7,0),False),((7,1),False),((7,2),False),((7,3),False),((7,4),False),((7,5),False),((7,6),False),((7,7),False),((7,8),False),((7,9),False),((8,0),False),((8,1),False),((8,2),False),((8,3),False),((8,4),False),((8,5),False),((8,6),False),((8,7),False),((8,8),False),((8,9),False),((9,0),False),((9,1),False),((9,2),False),((9,3),False),((9,4),False),((9,5),False),((9,6),False),((9,7),False),((9,8),False),((9,9),False)]\n</code></pre>\n\n<p>Going one step further, you can parse your input <code>[String]</code> into a board by simply concatenating and mapping a test for <code>== 't'</code>:</p>\n\n<pre><code>stringsToGrid :: [String] -&gt; Grid\nstringsToGrid = listArray ((0,0), (9,9)) . map (== 't') . concat\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1709237"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1903, "favorite_count": 0, "accepted_answer_id": 33091172, "answer_count": 1, "score": 0, "last_activity_date": 1444703119, "creation_date": 1444680207, "last_edit_date": 1444703119, "question_id": 33089293, "link": "https://stackoverflow.com/questions/33089293/how-to-populate-a-2d-array-in-haskell", "title": "How to populate a 2D Array in Haskell", "body": "<p>I am currently working on populating a grid in Haskell defined as <code>type Grid = UArray (Int, Int) Bool</code> where the two <code>Int</code>s are the x and y coordinates.  I am trying to turn this into a 10 by 10 data structure where the data types are Boolean.  I can get the values as such the listArray is part of the <code>Data.Array.Unboxed</code> package</p>\n\n<pre><code>import System.IO\nimport Control.Monad\nimport Data.Array.Unboxed\nimport Data.List (unfoldr)\ntype Board = UArray (Int, Int) Bool\nprogress :: Int -&gt; Int -&gt; Board -&gt; Board\nprogress  width height previous = \n    listArray b (map f (range b))\n  where b@((y1,x1),(y2,x2)) = bounds previous\n  -- some basic math functions performed here\n\ntotal :: [Bool] -&gt; Int\ntotal = length . filter id\n\nboard :: [String] -&gt; (Int, Int, Board)\nboard l = (width, height, a)\n  where (width, height) = (length $ head l, length l)\n        a = listArray ((1, 1), (height, width)) $ concatMap f l\n        f = map g\n        g 'f' = False\n        g _   = True\n\nprintGrid :: Int -&gt; Board -&gt; IO ()\nprintGrid width = mapM_ f . split width . elems\n  where f = putStrLn . map g\n        g False = 'f'\n        g _     = 't'\n\nsplit :: Int -&gt; [a] -&gt; [[a]]\nsplit n = takeWhile (not . null) . unfoldr (Just . splitAt n)\n\n-- used only as a test trying to create same structure programatically\ntestBoard = board\n   [\"ffffffffff\",\n   \"ffffffffff\",\n   \"ffffffffff\",\n   \"ffffffffff\",\n   \"ffffffffff\",\n   \"ffffffffff\",\n   \"ffffffffff\",\n   \"ffffffffff\",\n   \"ffffffffff\",\n   \"ffffffffff\"]\n\nprintProgress :: Int -&gt; (Int, Int, Board) -&gt; IO ()\nprintProgress n (width, height, g) = mapM_ f $ take n $ iterate (progress width height) g\n  where f g = do\n            putStrLn \"------------------------------\"\n            printGrid width g\n\nmain :: IO ()\nmain = do\n    printProgress times testBoard\n</code></pre>\n"}, {"tags": ["haskell", "lenses"], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 13, "last_activity_date": 1444680673, "last_edit_date": 1444680673, "creation_date": 1444678640, "answer_id": 33088896, "question_id": 33088563, "link": "https://stackoverflow.com/questions/33088563/why-do-we-need-control-lens-reified/33088896#33088896", "title": "Why do we need Control.Lens.Reified?", "body": "<p>We need reified lenses because Haskell's type system is predicative. I don't know the technical details of exactly what that means, but it prohibits types like</p>\n\n<pre><code>[Lens s t a b]\n</code></pre>\n\n<p>For some purposes, it's acceptable to use</p>\n\n<pre><code>Functor f =&gt; [(a -&gt; f b) -&gt; s -&gt; f t]\n</code></pre>\n\n<p>instead, but when you reach into that, you don't get a <code>Lens</code>; you get a <code>LensLike</code> specialized to some functor or another. The <code>ReifiedBlah</code> newtypes let you hang on to the full polymorphism.</p>\n\n<p>Operationally, <code>[ReifiedLens s t a b]</code> is a list of functions each of which takes a <code>Functor f</code> dictionary, while <code>forall f . Functor f =&gt; [LensLike f s t a b]</code> is a function that takes a <code>Functor f</code> dictionary and returns a list.</p>\n\n<p>As for what \"reify\" means, well, the dictionary will say something, and that seems to translate into a rather stunning variety of specific meanings in Haskell. So no comment on that.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1444769526, "post_id": 33106169, "comment_id": 54039064, "body": "I love this explanation; I wish your answer hadn&#39;t missed the initial new-question vote wave. The bit about the immediate application of type lambdas seems likely to relate to the reason higher-rank types are easier to handle than general impredicativity. One minor quibble: I believe <code>lensHead</code> would not be considered a lens in <code>lens</code> terminology, but rather a traversal, because it requires <code>Applicative f</code> and not just <code>Functor f</code>."}], "tags": [], "owner": {"reputation": 4328, "user_id": 1473927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AO6Ui.jpg?s=128&g=1", "display_name": "Jonathan Cast", "link": "https://stackoverflow.com/users/1473927/jonathan-cast"}, "is_accepted": false, "score": 8, "last_activity_date": 1444769841, "last_edit_date": 1444769841, "creation_date": 1444748710, "answer_id": 33106169, "question_id": 33088563, "link": "https://stackoverflow.com/questions/33088563/why-do-we-need-control-lens-reified/33106169#33106169", "title": "Why do we need Control.Lens.Reified?", "body": "<p>The problem is that, in Haskell, type abstraction and application are completely implicit; the compiler is supposed to insert them where needed.  Various attempts at designing 'impredicative' extensions, where the compiler would make clever guesses where to put them, have failed; so the safest thing ends up being relying on the Haskell 98 rules:</p>\n\n<ul>\n<li>Type abstractions occur only at the top level of a function definition.</li>\n<li>Type applications occur immediately whenever a variable with a polymorphic type is used in an expression.</li>\n</ul>\n\n<p>So if I define a simple lens:[1]</p>\n\n<pre><code>lensHead f [] = pure []\nlensHead f (x:xn) = (:xn) &lt;$&gt; f x\n</code></pre>\n\n<p>and use it in an expression:</p>\n\n<pre><code>[lensHead]\n</code></pre>\n\n<p><code>lensHead</code> gets <em>automatically</em> applied to some set of type parameters; at which point it's no longer a lens, because it's not polymorphic in the functor anymore.  The take-away is: an expression <em>always</em> has some monomorphic type; so it's not a lens.  (You'll note that the <code>lens</code> functions take arguments of type <code>Getter</code> and <code>Setter</code>, which are monomorphic types, for similar reasons to this.  But a <code>[Getter s a]</code> isn't a list of lenses, because they've been specialized to <em>only</em> getters.)</p>\n\n<p>What does <code>reify</code> mean?  The dictionary definition is 'make real'.  'Reifying' is used in philosophy to refer to the act of regarding or treating something as real (rather than ideal or abstract).  In programming, it tends to refer to taking something that normally can't be treated as a data structure and representing it as one.  For example, in really old Lisps, there didn't use to be first-class functions; instead, you had to use S-Expressions to pass 'functions' around, and <code>eval</code> them when you needed to call the function.  The S-Expressions represented the functions in a way you could manipulate in the program, which is referred to as <em>reification</em>.</p>\n\n<p>In Haskell, we don't typically need such elaborate reification strategies as Lisp S-Expressions, partly because the language is designed to avoid needing them; but since</p>\n\n<pre><code>newtype ReifiedLens s t a b = ReifiedLens (Lens s t a b)\n</code></pre>\n\n<p>has the same effect of taking a polymorphic value and turning it into a true first-class value, it's referred to as reification.</p>\n\n<p>Why does this work, if expressions always have monomorphic types?  Well, because the Rank2Types extension adds a third rule:</p>\n\n<ul>\n<li>Type abstractions occur at the top-level of the arguments to certain functions, with so-called rank 2 types.</li>\n</ul>\n\n<p><code>ReifiedLens</code> is such a rank-2 function; so when you say</p>\n\n<pre><code>ReifiedLens l\n</code></pre>\n\n<p>you get a type lambda around the argument to <code>ReifiedLens</code>, and then <code>l</code> is applied immediately to the the lambda-bound type argument.  So <code>l</code> is effectively just eta-expanded.  (Compilers are free to eta-reduce this and just use <code>l</code> directly).</p>\n\n<p>Then, when you say</p>\n\n<pre><code>f (ReifiedLens l) = ...\n</code></pre>\n\n<p>on the right-hand side, <code>l</code> is a variable with polymorphic type, so every use of <code>l</code> is immediately implicitly assigned to whatever type arguments are needed for the expression to type-check.  So everything works the way you expect.</p>\n\n<p>The other way to think about is that, if you say</p>\n\n<pre><code>newtype ReifiedLens s t a b = ReifiedLens { unReify :: Lens s t a b }\n</code></pre>\n\n<p>the two functions <code>ReifiedLens</code> and <code>unReify</code> act like explicit type abstraction and application operators; this allows the compiler to identify where you want the abstractions and applications to take place well enough that the issues with impredicative type systems don't come up.</p>\n\n<p>[1] In <code>lens</code> terminology, this is apparently called something other than a 'lens'; my entire knowledge of lenses comes from SPJ's presentation on them so I have no way to verify that.  The point remains, since the polymorphism is still necessary to make it work as both a getter and a setter.</p>\n"}], "owner": {"reputation": 949, "user_id": 1017252, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/90e3d67b15c2573bfc3821746de04dc0?s=128&d=identicon&r=PG", "display_name": "Omari Norman", "link": "https://stackoverflow.com/users/1017252/omari-norman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 305, "favorite_count": 3, "answer_count": 2, "score": 12, "last_activity_date": 1444769841, "creation_date": 1444677265, "question_id": 33088563, "link": "https://stackoverflow.com/questions/33088563/why-do-we-need-control-lens-reified", "title": "Why do we need Control.Lens.Reified?", "body": "<p>Why do we need <a href=\"http://haddock.stackage.org/lts-3.8/lens-4.12.3/Control-Lens-Reified.html\">Control.Lens.Reified</a>?  Is there some reason I can't place a <code>Lens</code> directly into a container?  What does <code>reify</code> mean anyway?</p>\n"}, {"tags": ["haskell", "lazy-evaluation", "denotational-semantics"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 1, "creation_date": 1444665529, "post_id": 33084018, "comment_id": 53987145, "body": "By the way, there&#39;s no way at all to polymorphically (without a type class) evaluate a value beyond WHNF."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1444666593, "post_id": 33084018, "comment_id": 53987764, "body": "@ReidBarton: Can you explain that a bit further (or is it <a href=\"http://stackoverflow.com/a/33070412/656912\">this</a>)?"}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 2, "creation_date": 1444668855, "post_id": 33084018, "comment_id": 53988954, "body": "It&#39;s not the same as in that link, it&#39;s just that without a type class, you have no way to get the information about how to access the subparts of a value of unknown type. (Hm, no high-level way, anyway - maybe there&#39;s some hideously unsafe way using the garbage collector&#39;s data)"}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1444668978, "post_id": 33084018, "comment_id": 53989022, "body": "@&#216;rjanJohansen: Is that relevant here, to <code>x</code>, for example?"}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1444669703, "post_id": 33084018, "comment_id": 53989428, "body": "Not much, since clearly you <i>do</i> know <code>x</code>&#39;s precise type."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1444669835, "post_id": 33084018, "comment_id": 53989484, "body": "@&#216;rjanJohansen: Good, I was confused about why it had been brought up in this context."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1444669881, "post_id": 33084018, "comment_id": 53989510, "body": "@raxacoricofallapatorius Presumably it had been brought up as a general statement of which one specialization is that <code>evaluate</code> -- which accepts a fully polymorphic argument -- does not evaluate a value beyond WHNF."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1444670293, "post_id": 33084018, "comment_id": 53989748, "body": "Whereas <a href=\"http://hackage.haskell.org/package/deepseq-1.4.1.2/docs/Control-DeepSeq.html#t:NFData\" rel=\"nofollow noreferrer\">NFData</a> enables you to fully evaluate a value to normal form (as long as the instance follows the rules)."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1444671358, "post_id": 33084018, "comment_id": 53990362, "body": "Right, what @DanielWagner said. It&#39;s an answer to the question in the title. Not just <code>evaluate</code>, but <i>any</i> function of the same type <code>a -&gt; IO a</code> can evaluate its argument no further than to WHNF."}], "answers": [{"comments": [{"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1444667111, "post_id": 33084304, "comment_id": 53988036, "body": "Perfect! As soon as I posted I wondered about this, but I&#39;m still vague enough on IO actions and how they work (especially when they are &quot;embedded&quot; as they are in interactions with GHCi) that I couldn&#39;t quite nail it down."}], "tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": true, "score": 15, "last_activity_date": 1444668090, "last_edit_date": 1444668090, "creation_date": 1444662099, "answer_id": 33084304, "question_id": 33084018, "link": "https://stackoverflow.com/questions/33084018/does-haskells-evaluate-reduce-to-normal-or-whnf/33084304#33084304", "title": "Does Haskell&#39;s &#39;evaluate&#39; reduce to normal or WHNF?", "body": "<p>What you are missing is that GHCi also <em>prints</em> the result of IO actions (if they can be shown and are not <code>()</code>), which <em>does</em> cause it to evaluate to normal form.  Try instead:</p>\n\n<pre><code>\u03bb&gt; let x = (trace \"foo\" Foo (trace \"bar\" Bar 100)) in evaluate x &gt;&gt; return ()\nfoo\n</code></pre>\n"}], "owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 216, "favorite_count": 2, "accepted_answer_id": 33084304, "answer_count": 1, "score": 8, "last_activity_date": 1444668090, "creation_date": 1444661184, "last_edit_date": 1495535431, "question_id": 33084018, "link": "https://stackoverflow.com/questions/33084018/does-haskells-evaluate-reduce-to-normal-or-whnf", "title": "Does Haskell&#39;s &#39;evaluate&#39; reduce to normal or WHNF?", "body": "<p>I understand (<a href=\"https://stackoverflow.com/a/33055462/656912\">I think</a>) that Haskell's <code>seq</code>, will (generally) <a href=\"https://hackhands.com/lazy-evaluation-works-haskell/\" rel=\"nofollow noreferrer\">reduce</a> its first argument to <a href=\"https://stackoverflow.com/a/6889335/656912\">WHNF</a>, and see this behavior as expected in GHCi:</p>\n\n<pre><code>\u03bb&gt; let x = (trace \"foo\" Foo (trace \"bar\" Bar 100)) in seq x 0\nfoo\n0\n</code></pre>\n\n<p>However, though the <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Control-Exception-Base.html#v:evaluate\" rel=\"nofollow noreferrer\">documentation for <code>evaluate</code></a> says that it also reduces its argument to WHNF, it looks like it actually fully reduces its argument to normal form:</p>\n\n<pre><code>\u03bb&gt; let x = (trace \"foo\" Foo (trace \"bar\" Bar 100)) in evaluate x\nfoo\nFoo bar\n(Bar 100)\n</code></pre>\n\n<p>I can confirm this (apparent) discrepancy with</p>\n\n<pre><code>\u03bb&gt; let y = (trace \"foo\" Foo (trace \"bar\" Bar 100))\n\u03bb&gt; seq y 0\nfoo\n0\n\u03bb&gt; :sprint y\ny = &lt;Foo&gt; _\n</code></pre>\n\n<p>and</p>\n\n<pre><code>\u03bb&gt; let z = (trace \"foo\" Foo (trace \"bar\" Bar 100))\n\u03bb&gt; evaluate z\nfoo\nFoo bar\n(Bar 100)\n\u03bb&gt; :sprint z\nz = &lt;Foo&gt; (&lt;Bar&gt; 100)\n</code></pre>\n\n<p>If the documentation for <code>evaluate</code> is correct, shouldn't the behavior of <code>seq</code> and <code>evaluate</code> be the same? What am I missing here (as a Haskell beginner)?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1444660201, "post_id": 33083581, "comment_id": 53983635, "body": "you don&#39;t - in Haskell there is no type-information at runtime - instead you constraint your functions: <code>myFun :: Num a =&gt; NewType a -&gt; ...</code>"}, {"owner": {"reputation": 46235, "user_id": 2541573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z1qtP.png?s=128&g=1", "display_name": "jub0bs", "link": "https://stackoverflow.com/users/2541573/jub0bs"}, "edited": false, "score": 3, "creation_date": 1444660230, "post_id": 33083581, "comment_id": 53983662, "body": "<code>data NewType a = Int | a (NewType a)</code> is illegal. You&#39;re using type variable <code>a</code> as if it were a value constructor; you can&#39;t do that."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 5, "creation_date": 1444661305, "post_id": 33083581, "comment_id": 53984403, "body": "You&#39;ve changed your question (<code>Num</code> -&gt; a certain type). That means there&#39;s now a technically correct answer to your question, the <code>Data.Typeable</code> API. You may still have an X/Y problem here: Without seeing your exact usecase, my hunch is that you <i>shouldn&#39;t</i> actually use <code>Typeable</code> for it, as it&#39;s bad style to use it when proper static typing is enough."}], "answers": [{"tags": [], "owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "is_accepted": true, "score": 6, "last_activity_date": 1444661159, "last_edit_date": 1444661159, "creation_date": 1444660538, "answer_id": 33083804, "question_id": 33083581, "link": "https://stackoverflow.com/questions/33083581/check-if-it-is-a-specific-type-haskell/33083804#33083804", "title": "Check if it is a specific type - haskell", "body": "<p>First, your <code>data</code> declaration will not work. Let's assume you're using this type:</p>\n\n<pre><code>data MyType a = MyInt Int | MyOther a (MyType a)\n</code></pre>\n\n<p>then you can have functions that take a <code>MyType a</code>, some specific <code>MyType</code> (e.g. <code>MyType Int</code>) or a constrained <code>MyType</code> (e.g. <code>Num a =&gt; MyType a</code>).</p>\n\n<p>If you want to know whether you have a <code>MyInt</code> or a <code>MyOther</code>, you can simply use pattern matching:</p>\n\n<pre><code>whichAmI :: MyType a -&gt; String\nwhichAmI (MyInt i) = \"I'm an Int with value \" ++ show i\nwhichAmI (MyOther _ _) = \"I'm something else\"\n</code></pre>\n\n<p>When you want to know if the type in the parameter <code>a</code> is a <code>Num</code>, or what type it is, you will run into a fundamental Haskell limitation. Haskell is statically typed so there is no such dynamic checking of what the <code>a</code> in <code>MyType a</code> is.</p>\n\n<p>The solution is to limit your function if you need a certain type of <code>a</code>. For example we can have:</p>\n\n<pre><code>mySum :: Num a =&gt; MyType a -&gt; a\nmySum (MyInt i) = fromIntegral i\nmySum (MyOther n m) = n + mySum m\n</code></pre>\n\n<p>or we can have a function that only works if <code>a</code> is a <code>Bool</code>:</p>\n\n<pre><code>trueOrGE10 :: MyType Bool -&gt; Bool\ntrueOrGE10 (MyInt i) = i &gt;= 10\ntrueOrGE10 (MyOther b _) = b\n</code></pre>\n\n<p>As with all Haskell code, it will need to be possible to determine at compile-time whether a particular expression you put into one of these functions has the right type.</p>\n"}], "owner": {"reputation": 907, "user_id": 2917666, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0868ffbc32d665832e38f956a1509bf2?s=128&d=identicon&r=PG&f=1", "display_name": "Rakim", "link": "https://stackoverflow.com/users/2917666/rakim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7188, "favorite_count": 0, "accepted_answer_id": 33083804, "answer_count": 1, "score": 1, "last_activity_date": 1444661159, "creation_date": 1444659841, "last_edit_date": 1444660736, "question_id": 33083581, "link": "https://stackoverflow.com/questions/33083581/check-if-it-is-a-specific-type-haskell", "title": "Check if it is a specific type - haskell", "body": "<p>I thought it would be really easy to find the answer online but I had no luck with that. Which means that my question should't be a question but I am sure more people new to Haskell might come up with the same question.</p>\n\n<p>So how do I check if a value is of a certain type?</p>\n\n<p>I have the following data type defined and I wanna check whether the input on a function is of a specific type.</p>\n\n<p><code>data MyType a = MyInt Int | MyOther a (MyType a)</code></p>\n"}, {"tags": ["haskell", "lazy-evaluation", "criterion"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1444680712, "post_id": 33083527, "comment_id": 53994943, "body": "Well your child process&#39;s CPU time is not your CPU time, so no surprise that <code>measCpuTime</code> doesn&#39;t do what you want. Not sure how to measure the child process&#39;s CPU time, though it is obviously possible since <code>time</code> does it."}, {"owner": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1444769860, "post_id": 33083527, "comment_id": 54039249, "body": "I&#39;m thinking to use the GHC API to do the profile, but not sure where to start looking"}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": false, "score": 0, "last_activity_date": 1458457415, "last_edit_date": 1495542227, "creation_date": 1458457415, "answer_id": 36111085, "question_id": 33083527, "link": "https://stackoverflow.com/questions/33083527/profiling-executable-with-criterion/36111085#36111085", "title": "Profiling executable with criterion", "body": "<p>I took a look at <a href=\"https://stackoverflow.com/questions/12871090/how-to-calculate-cpu-utilization-of-a-process-all-its-child-processes-in-linux\">this</a> SO question and got some ideas. First note that <code>criterion</code> uses <a href=\"https://github.com/bos/criterion/tree/master/cbits\" rel=\"nofollow noreferrer\">cbits</a> to enable system-dependent cpu time functions. Let's pretend you're on unix. The simplest thing to do is to directly read from <code>/proc/PID/stat/cutime</code> at the start and end of your runs and take the difference. Beyond that, you can actually use the <code>c</code> code provided in that question, link it in yourself as a foreign import, and then call that directly from your own code.</p>\n"}], "owner": {"reputation": 865, "user_id": 3694032, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/32d8fabde29edf207ac92275275af90a?s=128&d=identicon&r=PG&f=1", "display_name": "rem", "link": "https://stackoverflow.com/users/3694032/rem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 199, "favorite_count": 2, "answer_count": 1, "score": 4, "last_activity_date": 1458457415, "creation_date": 1444659684, "last_edit_date": 1444662212, "question_id": 33083527, "link": "https://stackoverflow.com/questions/33083527/profiling-executable-with-criterion", "title": "Profiling executable with criterion", "body": "<p>I need to profile a large number of haskell executables, hopefully in parallel. I was able to get the clock time with <a href=\"http://hackage.haskell.org/package/criterion-1.1.0.0/docs/Criterion-Measurement.html/#v:measure\" rel=\"nofollow\"><code>measure</code></a> and <a href=\"http://hackage.haskell.org/package/criterion-1.1.0.0/docs/Criterion-Types.html#t:Measured\" rel=\"nofollow\"><code>measTime</code></a> from the Criterion library, but couldn't get <code>measCpuTime</code> or any GC report to work (<code>measCpuTime</code> returns a time that's impossibly short). The code looks like: </p>\n\n<pre><code>buildProj :: FilePath -&gt; IO ExitCode\nbuildProj projDir = system $ \"cd \" ++ projDir ++ \"; cabal sandbox init; cabal configure; cabal build\"\n\n-- Time a project\ninstance NFData ExitCode\n  where \n    rnf ExitSuccess = ()\n    rnf (ExitFailure _) = ()\n\n\nbenchmark :: FilePath -&gt; Int64 -&gt; IO Double\nbenchmark projDir runs =  do  \n  let runProj = \"./\" ++ projDir ++ \"/dist/build/\" ++ projDir ++ \"/\" ++ projDir ++ \"&gt; /dev/null\"\n  exit &lt;- timeout 17000000 $ system runProj -- TODO hardcode timeout\n  case exit of\n       Just ExitSuccess     -&gt; do {(m, _) &lt;- measure (nfIO $ system runProj) runs; \n                              return $! measTime m}\n       Just (ExitFailure _) -&gt; return 100 \n       Nothing              -&gt; return 100 \n</code></pre>\n\n<p>In short, I'm running the executables with <code>System.Process.system</code> as an IO action and I've declared <code>ExitCode</code> as <code>NFData</code> in order to get <a href=\"http://hackage.haskell.org/package/criterion-1.1.0.0/docs/Criterion-Main.html#v:nfIO\" rel=\"nofollow\"><code>nfIO</code></a> to work. What have I done wrong? Are there better tools to do the task? </p>\n\n<p>The file's <a href=\"https://gist.github.com/remysucre/d260af535a6cf683bccd\" rel=\"nofollow\">here</a> if you want to play with it. </p>\n"}, {"tags": ["haskell", "maybe"], "comments": [{"owner": {"reputation": 4516, "user_id": 1937198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b97a3ec92aed1c16e35c1bf532465d6b?s=128&d=identicon&r=PG", "display_name": "user1937198", "link": "https://stackoverflow.com/users/1937198/user1937198"}, "edited": false, "score": 3, "creation_date": 1444657041, "post_id": 33082542, "comment_id": 53981473, "body": "Use a case statement."}, {"owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "edited": false, "score": 2, "creation_date": 1444657105, "post_id": 33082542, "comment_id": 53981516, "body": "in Haskell normal functions (not constructors) normally start in lowercase."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1444657998, "post_id": 33082542, "comment_id": 53982143, "body": "Not only <i>do they normally</i> start in lowercase, they <i>must</i> start in lowercase to be allowed in Haskell. I edited the question accordingly. \u2014 \u2014 (In principle, an underscore is also allowed as the first character of a variable name, but don&#39;t do that \u2013 <a href=\"http://stackoverflow.com/questions/21282515/is-using-pattern-names-starting-with-underscore-for-ignored-results-docume\">the underscore has a special meaning</a>."}], "answers": [{"comments": [{"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 1, "creation_date": 1444658087, "post_id": 33082698, "comment_id": 53982207, "body": "Don&#39;t call it <code>maybe</code>. That&#39;s the name of a function in the Prelude."}, {"owner": {"reputation": 874, "user_id": 3842022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71d9729ff4035657e7d6366611c28614?s=128&d=identicon&r=PG&f=1", "display_name": "C. Quilley", "link": "https://stackoverflow.com/users/3842022/c-quilley"}, "reply_to_user": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "edited": false, "score": 0, "creation_date": 1444661727, "post_id": 33082698, "comment_id": 53984672, "body": "@Zeta Thank you, changed."}], "tags": [], "owner": {"reputation": 874, "user_id": 3842022, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/71d9729ff4035657e7d6366611c28614?s=128&d=identicon&r=PG&f=1", "display_name": "C. Quilley", "link": "https://stackoverflow.com/users/3842022/c-quilley"}, "is_accepted": false, "score": 2, "last_activity_date": 1444661737, "last_edit_date": 1444661737, "creation_date": 1444657272, "answer_id": 33082698, "question_id": 33082542, "link": "https://stackoverflow.com/questions/33082542/get-value-of-maybe-in-haskell/33082698#33082698", "title": "Get value of Maybe in Haskell", "body": "<p>You won't be able to use <code>==</code> unless you have the constraint <code>Eq a =&gt; Maybe a</code> in the signature. The best way to do this type of thing is to use a <code>case</code> statement:</p>\n\n<pre><code>case m of\n    Just x -&gt; anotherFunction x\n    Nothing -&gt; Nothing\n</code></pre>\n\n<p>This pattern is so common for <code>Maybe</code> that it forms the <code>Monad</code> instance for <code>Maybe</code>, giving you the functions <code>return x = Just x</code> and <code>f &gt;&gt;= x = case x of Just a -&gt; f a; Nothing -&gt; Nothing</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": true, "score": 2, "last_activity_date": 1444657358, "creation_date": 1444657358, "answer_id": 33082730, "question_id": 33082542, "link": "https://stackoverflow.com/questions/33082542/get-value-of-maybe-in-haskell/33082730#33082730", "title": "Get value of Maybe in Haskell", "body": "<p>You can match on the value returned from <code>MyFunction</code> using <code>case</code>:</p>\n\n<pre><code>case (myFunction a) of\n  Nothing -&gt; Nothing\n  Just x -&gt; anotherFunction x\n</code></pre>\n\n<p>however a more concise method is to use <code>&gt;&gt;=</code>:</p>\n\n<pre><code>(&gt;&gt;=) :: Maybe a -&gt; (a -&gt; Maybe b) -&gt; Maybe b\nmyFunction (f a) = (myFunction a) &gt;&gt;= anotherFunction\n</code></pre>\n\n<p>or you can use <code>do</code> notation:</p>\n\n<pre><code>myFunction (f a) = do\n  x &lt;- myFunction a\n  anotherFunction x\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2231, "user_id": 1027321, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/KkFZC.jpg?s=128&g=1", "display_name": "jakubdaniel", "link": "https://stackoverflow.com/users/1027321/jakubdaniel"}, "is_accepted": false, "score": 1, "last_activity_date": 1444659293, "last_edit_date": 1444659293, "creation_date": 1444657498, "answer_id": 33082787, "question_id": 33082542, "link": "https://stackoverflow.com/questions/33082542/get-value-of-maybe-in-haskell/33082787#33082787", "title": "Get value of Maybe in Haskell", "body": "<p>Suppose you have <code>f</code> and <code>g</code> that both produce values wrapped into type <code>Maybe</code> (<code>Just 3</code>, <code>Just \"three\"</code>, <code>Nothing</code>). You can compose the two like:</p>\n\n<pre><code>import Control.Monad\n\nf :: a -&gt; Maybe b -- suppose these two are signatures of the given two functions\ng :: b -&gt; Maybe c\n\nh :: a -&gt; Maybe c -- this is the way you pass values from one\nh = f &gt;=&gt; g       -- to the other and bail out when you see Nothing\n</code></pre>\n\n<p>I have used convenient names for the types <code>a</code>, <code>b</code>, and <code>c</code> to make the composition more clear, but notice that the types are not constraint and <code>a</code> in one signature has nothing to do with <code>a</code> in another signature, the actual type is decided when the two functions are used in concrete context.</p>\n\n<p>As you don't seem to put any constraint on what <code>a</code> in <code>F a</code> constructor is, I suppose you want it to be possibly different from <code>A</code>. In that case the function <code>myFunction</code> cannot have type <code>A -&gt; ...</code> because you are trying to pass <code>a</code> as the argument.</p>\n"}], "owner": {"reputation": 271, "user_id": 3545752, "user_type": "registered", "accept_rate": 53, "profile_image": "https://graph.facebook.com/100005658153616/picture?type=large", "display_name": "user3545752", "link": "https://stackoverflow.com/users/3545752/user3545752"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1853, "favorite_count": 0, "closed_date": 1444659174, "accepted_answer_id": 33082730, "answer_count": 3, "score": 0, "last_activity_date": 1444661737, "creation_date": 1444656828, "last_edit_date": 1444657610, "question_id": 33082542, "link": "https://stackoverflow.com/questions/33082542/get-value-of-maybe-in-haskell", "closed_reason": "Duplicate", "title": "Get value of Maybe in Haskell", "body": "<p>I am implementing a function <code>myFunction</code> which uses <code>anotherFunction</code>. </p>\n\n<p><code>anotherFunction</code> is an external function which cannot be modified. It returns a value of type <code>Maybe</code>.</p>\n\n<p><code>myFunction</code> is a recursive function that checks whether the value returned by another <code>myFunction</code> is a <code>Just</code> value or <code>Nothing</code>. If it's a <code>Nothing</code> then return <code>Nothing</code>, otherwise it will use the pure value returned by <code>myFunction</code> as an argument of <code>anotherFunction</code>.</p>\n\n<p>Basically something like this:</p>\n\n<pre><code>--These cannot be modified\n\ndata A = B | F a\n\nanotherFunction :: x -&gt; Maybe x\n--Something here\n\nmyFunction :: A -&gt; Maybe x \n\n--These can be modified\nmyFunction (F a) = {- if (myFunction a == Nothing) \n                        then Nothing \n                        else anotherFunction (pure value of (myFunction a)) -}\n</code></pre>\n\n<p>How can this be achieved?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 14781, "user_id": 630160, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/4445f21326af525a8ad19af7e3ae41a8?s=128&d=identicon&r=PG", "display_name": "epsilonhalbe", "link": "https://stackoverflow.com/users/630160/epsilonhalbe"}, "edited": false, "score": 4, "creation_date": 1444638167, "post_id": 33076119, "comment_id": 53969868, "body": "+1 for the <code>ZipList</code> abstraction, which generalizes <code>zipWithX</code>. Side note for newcomers: <code>pure x = [x,x,x,x,...]</code> for <code>ZipList</code>, which is the right choice for this <code>Applicative</code> instance, but not obvious."}], "tags": [], "owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "is_accepted": true, "score": 12, "last_activity_date": 1444637547, "last_edit_date": 1444637547, "creation_date": 1444637169, "answer_id": 33076119, "question_id": 33076075, "link": "https://stackoverflow.com/questions/33076075/whats-a-convenient-way-to-call-lists-of-arguments-but-each-time-only-using-ite/33076119#33076119", "title": "What&#39;s a convenient way to call lists of arguments, but each time only using items at the same positions?", "body": "<p>Use <code>zipWith</code>:</p>\n\n<pre><code>zipWith rem [23, 45] [7, 11]\n</code></pre>\n\n<p>If you have more lists, there are <code>zipWith3</code>, <code>zipWith4</code> etc.</p>\n\n<p>You can also use the <code>ZipList</code> applicative:</p>\n\n<pre><code>getZipList $ rem &lt;$&gt; ZipList [23, 45] &lt;*&gt; ZipList [7,11]\n</code></pre>\n"}], "owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 1, "accepted_answer_id": 33076119, "answer_count": 1, "score": 2, "last_activity_date": 1444637547, "creation_date": 1444636993, "question_id": 33076075, "link": "https://stackoverflow.com/questions/33076075/whats-a-convenient-way-to-call-lists-of-arguments-but-each-time-only-using-ite", "title": "What&#39;s a convenient way to call lists of arguments, but each time only using items at the same positions?", "body": "<p>I know that there's a very useful concise pattern in Haskell for applying a function to a list of arguments:</p>\n\n<pre><code>\u03bb&gt; rem &lt;$&gt; [23, 45] &lt;*&gt; [7, 11]\n[2,1,3,1]\n</code></pre>\n\n<p>is there a similar convenient way to only call the the items in the same corresponding indices? In the above example, it would be only <code>rem 23 7</code> and <code>rem 45 11</code>, instead of all possibilities.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444630036, "post_id": 33074125, "comment_id": 53966000, "body": "There are several ways to do that. What trouble are you having?"}, {"owner": {"reputation": 1390, "user_id": 1610765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/16b01bba5dacce95be27888670b7d218?s=128&d=identicon&r=PG", "display_name": "Chiffa", "link": "https://stackoverflow.com/users/1610765/chiffa"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444630299, "post_id": 33074125, "comment_id": 53966111, "body": "Conceptual. If I define, say, <code>a = &quot;127&quot;</code>, <code>show</code> adds all the quotes and escape sequences, and the concatenation result is wrong. If I make <code>a = 127.</code>, Haskell treats the dot as a function. And so on."}, {"owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "edited": false, "score": 0, "creation_date": 1444630615, "post_id": 33074125, "comment_id": 53966230, "body": "So what other type could you use?"}, {"owner": {"reputation": 1390, "user_id": 1610765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/16b01bba5dacce95be27888670b7d218?s=128&d=identicon&r=PG", "display_name": "Chiffa", "link": "https://stackoverflow.com/users/1610765/chiffa"}, "edited": false, "score": 0, "creation_date": 1444631508, "post_id": 33074125, "comment_id": 53966598, "body": "I don&#39;t see it as a question of types, I see it as a way <code>show</code> turns arguments into <code>String</code>s. Maybe that&#39;s my problem."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1444631708, "post_id": 33074125, "comment_id": 53966679, "body": "This sounds more like a puzzle than a programming problem. Have you tried <a href=\"http://codegolf.stackexchange.com\">codegolf.stackexchange.com</a> ?"}, {"owner": {"reputation": 1390, "user_id": 1610765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/16b01bba5dacce95be27888670b7d218?s=128&d=identicon&r=PG", "display_name": "Chiffa", "link": "https://stackoverflow.com/users/1610765/chiffa"}, "edited": false, "score": 0, "creation_date": 1444632138, "post_id": 33074125, "comment_id": 53966837, "body": "Not yet. Can someone migrate it there?"}, {"owner": {"reputation": 35849, "user_id": 1424875, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/HFA9w.png?s=128&g=1", "display_name": "nanofarad", "link": "https://stackoverflow.com/users/1424875/nanofarad"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1444653513, "post_id": 33074125, "comment_id": 53979091, "body": "@dfeuer It was <a href=\"http://codegolf.stackexchange.com/q/60466/4256\">not a good fit for ppcg</a>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 35849, "user_id": 1424875, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/HFA9w.png?s=128&g=1", "display_name": "nanofarad", "link": "https://stackoverflow.com/users/1424875/nanofarad"}, "edited": false, "score": 0, "creation_date": 1444661585, "post_id": 33074125, "comment_id": 53984594, "body": "@hexafraction, that is because it&#39;s not a good fit anywhere."}, {"owner": {"reputation": 35849, "user_id": 1424875, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/HFA9w.png?s=128&g=1", "display_name": "nanofarad", "link": "https://stackoverflow.com/users/1424875/nanofarad"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444674564, "post_id": 33074125, "comment_id": 53992003, "body": "@dfeuer Then a vote to close would be more appropriate than a migration suggestion. However, although I&#39;m not familiar with Haskell, the fact that a good answer could be given that was rated well by both asker and community leads me to believe that it was fine here."}], "answers": [{"comments": [{"owner": {"reputation": 1390, "user_id": 1610765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/16b01bba5dacce95be27888670b7d218?s=128&d=identicon&r=PG", "display_name": "Chiffa", "link": "https://stackoverflow.com/users/1610765/chiffa"}, "edited": false, "score": 0, "creation_date": 1444630792, "post_id": 33074396, "comment_id": 53966290, "body": "I don&#39;t have control over <code>show</code>, I can only provide the right arguments. Otherwise your solutions are great, and I&#39;ve already thought of those."}, {"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "reply_to_user": {"reputation": 1390, "user_id": 1610765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/16b01bba5dacce95be27888670b7d218?s=128&d=identicon&r=PG", "display_name": "Chiffa", "link": "https://stackoverflow.com/users/1610765/chiffa"}, "edited": false, "score": 0, "creation_date": 1444631168, "post_id": 33074396, "comment_id": 53966448, "body": "You know what the types of a,b,c,d are. You can&#39;t define <code>ip</code> where sometimes <code>a</code> is an Int and sometimes it is a String. Show us more of what you are trying to do."}, {"owner": {"reputation": 1390, "user_id": 1610765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/16b01bba5dacce95be27888670b7d218?s=128&d=identicon&r=PG", "display_name": "Chiffa", "link": "https://stackoverflow.com/users/1610765/chiffa"}, "edited": false, "score": 0, "creation_date": 1444631426, "post_id": 33074396, "comment_id": 53966564, "body": "I&#39;m trying to choose <code>a</code>, <code>b</code> and so on in such a way that <code>show</code> doesn&#39;t add any extra symbols to them."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 1, "last_activity_date": 1444632229, "last_edit_date": 1444632229, "creation_date": 1444630605, "answer_id": 33074396, "question_id": 33074125, "link": "https://stackoverflow.com/questions/33074125/dealing-with-show-in-haskell/33074396#33074396", "title": "Dealing with `show` in Haskell", "body": "<p>Your <code>ip</code> function will be different depending on what you want to use for <code>a</code>, <code>b</code>, <code>c</code> and <code>d</code>:</p>\n\n<p>If you choose Strings:</p>\n\n<pre><code>ip1 :: String -&gt; String -&gt; String -&gt; String -&gt; String\nip1 a b c d = a ++ \".\" ++ b ++ \".\" ++ c ++ \".\" ++ d\n</code></pre>\n\n<p>and if you choose Ints:</p>\n\n<pre><code>ip2 :: Int -&gt; Int -&gt; Int -&gt; Int -&gt; String\nip2 a b c d = show a ++ \".\" ++ show b ++ \".\" ++ show c ++ \".\" ++ show d\n</code></pre>\n\n<p><strong>Update</strong></p>\n\n<p>Maybe these examples of creating new types and Show instances for them\nwill help:</p>\n\n<pre><code>data Foo = F String\n\ninstance Show Foo where\n    show (F string) = \"a string of length \" ++ show (length string)\n\ndata Bar = B Double\n\ninstance Show Bar where\n    show (B adouble) = if adouble &gt; 0 then \"(positive)\" else \"(not positive)\"\n\na = F \"abc\"\nb = B 14.0\n</code></pre>\n\n<p>Then:</p>\n\n<pre><code>show a ++ show b\n</code></pre>\n\n<p>results in:</p>\n\n<pre><code>\"a string of length 3(positive)\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1390, "user_id": 1610765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/16b01bba5dacce95be27888670b7d218?s=128&d=identicon&r=PG", "display_name": "Chiffa", "link": "https://stackoverflow.com/users/1610765/chiffa"}, "edited": false, "score": 0, "creation_date": 1444636789, "post_id": 33075757, "comment_id": 53969169, "body": "I&#39;m pretty sure that&#39;s not the solution that was expected, but it&#39;s clever and it works, so thanks."}, {"owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "reply_to_user": {"reputation": 1390, "user_id": 1610765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/16b01bba5dacce95be27888670b7d218?s=128&d=identicon&r=PG", "display_name": "Chiffa", "link": "https://stackoverflow.com/users/1610765/chiffa"}, "edited": false, "score": 1, "creation_date": 1444636989, "post_id": 33075757, "comment_id": 53969284, "body": "@Chiffa: I would be interested in hearing about the expected solution if it&#39;s very different. I can&#39;t really think of another way than using a custom <code>Show</code> instance."}, {"owner": {"reputation": 1390, "user_id": 1610765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/16b01bba5dacce95be27888670b7d218?s=128&d=identicon&r=PG", "display_name": "Chiffa", "link": "https://stackoverflow.com/users/1610765/chiffa"}, "edited": false, "score": 0, "creation_date": 1444637440, "post_id": 33075757, "comment_id": 53969500, "body": "I&#39;ll definitely post it once I get it."}, {"owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "reply_to_user": {"reputation": 1390, "user_id": 1610765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/16b01bba5dacce95be27888670b7d218?s=128&d=identicon&r=PG", "display_name": "Chiffa", "link": "https://stackoverflow.com/users/1610765/chiffa"}, "edited": false, "score": 0, "creation_date": 1444662244, "post_id": 33075757, "comment_id": 53985030, "body": "@Chiffa: I suggest you accept chi&#39;s answer instead, it&#39;s better."}], "tags": [], "owner": {"reputation": 2271, "user_id": 4994500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/233389523330bec1d6e95f4c480d5741?s=128&d=identicon&r=PG&f=1", "display_name": "Sam van Herwaarden", "link": "https://stackoverflow.com/users/4994500/sam-van-herwaarden"}, "is_accepted": true, "score": 5, "last_activity_date": 1444635798, "creation_date": 1444635798, "answer_id": 33075757, "question_id": 33074125, "link": "https://stackoverflow.com/questions/33074125/dealing-with-show-in-haskell/33075757#33075757", "title": "Dealing with `show` in Haskell", "body": "<p>There are different ways you can do this. In any case, the default <code>Show</code> instances are probably unsuitable to you, this is the core of the problem: you will want to define your own type, with a custom <code>Show</code> instance. The common way to redefine types with custom instances (or hiding instances) is using <code>newtype</code>.</p>\n\n<p>We can use a different <code>Show</code> instance with a <code>String</code>-like type, so that there is no escaping or addition of <code>\"</code>:</p>\n\n<pre><code>newtype MyStr = MyStr String\n\ninstance Show MyStr where\n  show (MyStr s) = s\n\nip a b c d = show a ++ show b ++ show c ++ show d\n\na = MyStr \"127.\"\nb = MyStr \"224.\"\nc = MyStr \"120.\"\nd = MyStr \"12\"\n\nmain = print $ ip a b c d\n</code></pre>\n\n<p>Another possibility would be to define an alternative for the <code>Int</code> type where a <code>.</code> is appended when using <code>show</code>. We then use this type for the first three arguments of <code>ip</code> and use a regular <code>Int</code> for the last argument (<code>a</code>, <code>b</code>, <code>c</code> and <code>d</code> can have different types).</p>\n\n<pre><code>newtype MyInt = MyInt Int\n\ninstance Show MyInt where\n  show (MyInt s) = show s ++ \".\"\n\nip a b c d = show a ++ show b ++ show c ++ show d\n\na = MyInt 127\nb = MyInt 224\nc = MyInt 120\nd = 12\n\nmain = print $ ip a b c d\n</code></pre>\n\n<p>Note that in both cases the solution is a bit of a hack, but this is because of the nature of the problem. Normally you would want instances of <code>Show</code> to be technical rather than \"stylistic\" in nature: you want to show all information on a value, preferably in a way that can be read back with <code>read</code> (by defining a corresponding <code>Read</code> instance). For styling output a pretty printer is more suitable.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444661802, "post_id": 33076850, "comment_id": 53984725, "body": "This is exactly the sort of answer I had in mind when I recommended CodeGolf instead of this site. Sadly, others saw it differently."}, {"owner": {"reputation": 1390, "user_id": 1610765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/16b01bba5dacce95be27888670b7d218?s=128&d=identicon&r=PG", "display_name": "Chiffa", "link": "https://stackoverflow.com/users/1610765/chiffa"}, "edited": false, "score": 0, "creation_date": 1444673319, "post_id": 33076850, "comment_id": 53991345, "body": "Could you go to codegolf, find my question there and copypaste this answer? I&#39;d say that&#39;s exactly it."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1390, "user_id": 1610765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/16b01bba5dacce95be27888670b7d218?s=128&d=identicon&r=PG", "display_name": "Chiffa", "link": "https://stackoverflow.com/users/1610765/chiffa"}, "edited": false, "score": 0, "creation_date": 1444674086, "post_id": 33076850, "comment_id": 53991776, "body": "@Chiffa The question on codegolf has been put on hold, so no answers can be posted."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1444674620, "post_id": 33076850, "comment_id": 53992025, "body": "@dfeuer I guess that the &quot;puzzle&quot; aspect of this question is only understandable by Haskellers, since it depends on how <code>show</code> is defined. Non-haskellers would probably guess that <code>show=id</code> on <code>String</code>, since e.g. <code>someString.toString()</code> is the same as <code>someString</code> in some OOP languages. If that were the case, there would be no challenge at all to solve this. I&#39;m not surprised if CodeGolfers simply thought that this was a regular general programming question."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 10, "last_activity_date": 1444639680, "creation_date": 1444639680, "answer_id": 33076850, "question_id": 33074125, "link": "https://stackoverflow.com/questions/33074125/dealing-with-show-in-haskell/33076850#33076850", "title": "Dealing with `show` in Haskell", "body": "<p>With floating point numbers:</p>\n\n<pre><code>&gt; let ip a b c d = show a ++ show b ++ show c ++ show d\n&gt; ip 127.2 24.12 0.1 2\n\"127.224.120.12\"\n</code></pre>\n"}], "owner": {"reputation": 1390, "user_id": 1610765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/16b01bba5dacce95be27888670b7d218?s=128&d=identicon&r=PG", "display_name": "Chiffa", "link": "https://stackoverflow.com/users/1610765/chiffa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 251, "favorite_count": 1, "accepted_answer_id": 33075757, "answer_count": 3, "score": 1, "last_activity_date": 1444654135, "creation_date": 1444629273, "last_edit_date": 1444654135, "question_id": 33074125, "link": "https://stackoverflow.com/questions/33074125/dealing-with-show-in-haskell", "title": "Dealing with `show` in Haskell", "body": "<p>I have a function <code>ip</code>, which I can not change:</p>\n\n<pre><code>ip = show a ++ show b ++ show c ++ show d\n</code></pre>\n\n<p>and I have to define <code>a</code>, <code>b</code>, <code>c</code> and <code>d</code> so that:</p>\n\n<pre><code>GHCi&gt; ip\n\"127.224.120.12\"\n</code></pre>\n\n<p>holds. How do I do that? </p>\n"}, {"tags": ["haskell", "vector", "tuples", "setter", "getter"], "comments": [{"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1444619677, "post_id": 33072325, "comment_id": 53963284, "body": "What &#39;Vector&#39; are you referring to? Which library and module? What is the full code required for <code>a</code> to compile (or even scope check)?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1709237"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1444620015, "post_id": 33072325, "comment_id": 53963357, "body": "Allow me to edit my question."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1709237"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1444621626, "post_id": 33072325, "comment_id": 53963691, "body": "Also, I am only trying to make a 2D Vector which stores the data 0 or 1."}, {"owner": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 2, "creation_date": 1444622705, "post_id": 33072325, "comment_id": 53963902, "body": "You can access the values inside simply by pattern matching, for example <code>f (FullBoard x y) = x + y</code>. You cannot use lens functions without creating lenses for your datatypes, or generating them automatically with template haskell. You&#39;ll have to look to lens tutorials for that. The simplest thing you can do is <code>data V2 = V2 { v2_a, v2_b :: a }</code>; then you have <code>v2_a, v2_b :: V2 a -&gt; a</code> which get the two coordinates; and you have <code>V2 True False :: V2 Bool</code> to represent 2D vectors which store only 0 or 1 at each coordinate."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1709237"}, "reply_to_user": {"reputation": 13807, "user_id": 2407038, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/538f6f4a9aa43841841de7d8e8b169fc?s=128&d=identicon&r=PG&f=1", "display_name": "user2407038", "link": "https://stackoverflow.com/users/2407038/user2407038"}, "edited": false, "score": 0, "creation_date": 1444623820, "post_id": 33072325, "comment_id": 53964163, "body": "Thanks, that helped a lot!"}], "owner": {"user_type": "does_not_exist", "display_name": "user1709237"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 302, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1444621222, "creation_date": 1444616494, "last_edit_date": 1444621222, "question_id": 33072325, "link": "https://stackoverflow.com/questions/33072325/how-to-get-a-specific-index-for-a-2d-vector-in-haskell", "title": "How to get a specific index for a 2d vector in Haskell", "body": "<p>I am currently trying to access an element from a 2d Vector declared as such:</p>\n\n<pre><code>data Board = FullBoard Int Int\n:t FullBoard\nFullBoard :: Int -&gt; Int -&gt; Board\n</code></pre>\n\n<p>(FullBoard x y)</p>\n\n<p>If I am correct, the two Ints Are the size of the board, in this 2d Vector.\nMy issue is that I cannot seem to find a way to access the (x, y) element and changing the data that is currently stored as <code>0</code> in a nested tuple. I have tried using several things including using the <code>lens</code> library, however I have had no luck with <code>a^._2</code> or similar getter functions.</p>\n\n<p>Any help is appreciated!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 9, "creation_date": 1444618105, "post_id": 33072147, "comment_id": 53962945, "body": "This doesn&#39;t answer the &quot;why&quot; question, but: compile with optimizations. I observe 25s in ghci; 20s when compiled with <code>-O0</code>; but only 0.3s when compiled with <code>-O2</code>."}, {"owner": {"reputation": 1556, "user_id": 1392943, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/606e0a60eca298e29ce56b5544de4950?s=128&d=identicon&r=PG&f=1", "display_name": "Kamel", "link": "https://stackoverflow.com/users/1392943/kamel"}, "edited": false, "score": 1, "creation_date": 1444631128, "post_id": 33072147, "comment_id": 53966431, "body": "Why the final answer is 10^8 not 100 as there is an assignment <code>let x = a</code>?"}, {"owner": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "reply_to_user": {"reputation": 1556, "user_id": 1392943, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/606e0a60eca298e29ce56b5544de4950?s=128&d=identicon&r=PG&f=1", "display_name": "Kamel", "link": "https://stackoverflow.com/users/1392943/kamel"}, "edited": false, "score": 0, "creation_date": 1444632975, "post_id": 33072147, "comment_id": 53967232, "body": "@Kamel <code>let x = a</code> is after all the binds, so <code>x</code> must be still replicated 10^8 times."}, {"owner": {"reputation": 1556, "user_id": 1392943, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/606e0a60eca298e29ce56b5544de4950?s=128&d=identicon&r=PG&f=1", "display_name": "Kamel", "link": "https://stackoverflow.com/users/1392943/kamel"}, "reply_to_user": {"reputation": 28873, "user_id": 1068232, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2a0a145ce58c20013969fe3f203531da?s=128&d=identicon&r=PG", "display_name": "Andr&#225;s Kov&#225;cs", "link": "https://stackoverflow.com/users/1068232/andr%c3%a1s-kov%c3%a1cs"}, "edited": false, "score": 0, "creation_date": 1444634340, "post_id": 33072147, "comment_id": 53967895, "body": "@Andr&#225;sKov&#225;cs Then what does <code>let x = a</code> mean if it does not take effects on the final <code>test</code> result?"}, {"owner": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "reply_to_user": {"reputation": 1556, "user_id": 1392943, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/606e0a60eca298e29ce56b5544de4950?s=128&d=identicon&r=PG&f=1", "display_name": "Kamel", "link": "https://stackoverflow.com/users/1392943/kamel"}, "edited": false, "score": 2, "creation_date": 1444636844, "post_id": 33072147, "comment_id": 53969204, "body": "@Kamel It means that <code>x</code> is now bound to <code>a</code>. The thing is that because of the definition of <code>(&gt;&gt;=)</code> in lists, the value of <code>a</code> (hence <code>x</code>) depends on all the binds. For example and to really demonstrate the effect of how merely having a binding affects the result: <code>[5| _ &lt;- [1..10]]</code> outputs <code>[5,5,5,5,5,5,5,5,5,5]</code>."}, {"owner": {"reputation": 1556, "user_id": 1392943, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/606e0a60eca298e29ce56b5544de4950?s=128&d=identicon&r=PG&f=1", "display_name": "Kamel", "link": "https://stackoverflow.com/users/1392943/kamel"}, "reply_to_user": {"reputation": 18999, "user_id": 825637, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/825a58fde1ef99db42c5354dab6cd472?s=128&d=identicon&r=PG", "display_name": "MasterMastic", "link": "https://stackoverflow.com/users/825637/mastermastic"}, "edited": false, "score": 0, "creation_date": 1444636999, "post_id": 33072147, "comment_id": 53969287, "body": "@MasterMastic Great example and info, thanks!"}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1444618548, "post_id": 33072480, "comment_id": 53963035, "body": "You&#39;re probably underestimating the total amount of memory that&#39;s eventually allocated for this. But I really don&#39;t think that&#39;s the problem: 1GB isn&#39;t going to force you to swap on any modern system; and even so, we should only need to keep at most 10^6 elements in memory at any given time. GHC&#39;s allocator will eat a million allocations for breakfast; wait until you see how many gigabytes of allocation/deallocation appear in the profiling output of even simple, short-running programs."}, {"owner": {"reputation": 28776, "user_id": 2314532, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/90ade367b50c6f2a4796a03c82b1a4a1?s=128&d=identicon&r=PG", "display_name": "rmunn", "link": "https://stackoverflow.com/users/2314532/rmunn"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1444618646, "post_id": 33072480, "comment_id": 53963054, "body": "No doubt; I&#39;m not a Haskell expert (I know more about F#, and even there I&#39;m only dabbling yet). @CYC, if anything Daniel Wagner says contradicts me, listen to him, not me. I&#39;m mostly guessing."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1444639189, "post_id": 33072480, "comment_id": 53970388, "body": "@DanielWagner Why would it only need to keep 10^6 elements in memory at any given time?"}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1444661486, "post_id": 33072480, "comment_id": 53984527, "body": "@immibis it doesn&#39;t need to keep that many, but it might collect that many at once since the GC isn&#39;t going to execute after every element is consumed."}], "tags": [], "owner": {"reputation": 28776, "user_id": 2314532, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/90ade367b50c6f2a4796a03c82b1a4a1?s=128&d=identicon&r=PG", "display_name": "rmunn", "link": "https://stackoverflow.com/users/2314532/rmunn"}, "is_accepted": false, "score": 4, "last_activity_date": 1444617712, "creation_date": 1444617712, "answer_id": 33072480, "question_id": 33072147, "link": "https://stackoverflow.com/questions/33072147/why-is-xx-1-10-method-so-slow-in-haskell/33072480#33072480", "title": "Why is [x|x&lt;-[1..10]] method so slow in Haskell?", "body": "<p>You're not just running a loop 10^8 times, you're creating a list with 10^8 elements. Since you're using <code>length</code>, Haskell has to actually evaluate the entire list to return its length. Each element in the list takes one word, which might be 32 bits or might be 64 bits. On the optimistic assumption that it's 32 bits (4 bytes), you've just allocated 400 MB (about 381.5 MiB) of memory. If it's 64 bits, then that's 800 MB (about 763 MiB) of memory you've just allocated. Depending on what else is going on on your system, you might have just hit the swap file / swap partition by allocating that much RAM at a chunk.</p>\n\n<p>If there are other subtleties going on, I'm not aware of them, but memory usage is my first suspicion for why this is so slow.</p>\n"}, {"tags": [], "owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "is_accepted": true, "score": 5, "last_activity_date": 1444656104, "creation_date": 1444656104, "answer_id": 33082265, "question_id": 33072147, "link": "https://stackoverflow.com/questions/33072147/why-is-xx-1-10-method-so-slow-in-haskell/33082265#33082265", "title": "Why is [x|x&lt;-[1..10]] method so slow in Haskell?", "body": "<p>Are you running this in ghci or in a compiled program? It makes a big difference.</p>\n\n<p>If in ghci, then ghci will keep the computed value of <code>test</code> around in case you want to use it later. Normally this is a good idea, but not in this case where <code>test</code> is a huge value that would be cheap to recompute anyways. How huge? For starters it's a list of 10^8 elements, and (on a 64-bit system) a list costs 24 bytes per element, so that's 2.4G already. Then there is space usage of the values themselves. One might think the values are all taken from <code>[1..100]</code>, so they should be shared and use a negligible amount of space in total. But the values in the list are really of the form <code>x</code>, which could depend on <code>a</code>, <code>b</code>, <code>c</code> and <code>d</code>, and <code>length</code> never examines the values in the list as it traverses it. So each element is going to be represented as a closure that refers to <code>a</code>, <code>b</code>, <code>c</code> and <code>d</code>, which takes at least 8*(4+1) = 40 more bytes, bringing us to a total of 6.4G.</p>\n\n<p>That's rather a lot, and the garbage collector has to do quite a lot of copying when you allocate 6.4G of data, all of it permanently live. That's what takes so long, not actually computing the list or its length.</p>\n\n<p>If you compile the program</p>\n\n<pre><code>test = [x|a&lt;-[1..100],b&lt;-[1..100],c&lt;-[1..100],d&lt;-[1..100],let x = a]\n\nmain = print $ length test\n</code></pre>\n\n<p>then <code>test</code> does not have to be kept live as its length is being computed, as clearly it is never going to be used again. So now the GC has almost no work to do, and the program runs in a couple seconds (reasonable for ~10^8 list node allocations and computations on <code>Integer</code>).</p>\n"}], "owner": {"reputation": 579, "user_id": 5217363, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/afdb988af8695ba91b4cc8fbaba47eef?s=128&d=identicon&r=PG&f=1", "display_name": "CYC", "link": "https://stackoverflow.com/users/5217363/cyc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 220, "favorite_count": 3, "accepted_answer_id": 33082265, "answer_count": 2, "score": 6, "last_activity_date": 1444656104, "creation_date": 1444614951, "last_edit_date": 1444653847, "question_id": 33072147, "link": "https://stackoverflow.com/questions/33072147/why-is-xx-1-10-method-so-slow-in-haskell", "title": "Why is [x|x&lt;-[1..10]] method so slow in Haskell?", "body": "<p>Why is something like this runs extremely slow in Haskell?</p>\n\n<pre><code>test = [x|a&lt;-[1..100],b&lt;-[1..100],c&lt;-[1..100],d&lt;-[1..100],let x = a]\n\nprint $ length test\n</code></pre>\n\n<p>There are only about <code>10^8</code> numbers to run, it should be done in a blink of eye, but it seems like running forever and almost crashed.</p>\n"}, {"tags": ["haskell", "lazy-evaluation", "evaluation"], "comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 1, "creation_date": 1444599410, "post_id": 33070240, "comment_id": 53958851, "body": "<code>two</code> probably stays unevaluated because of its type, <code>(Num a) =&gt; a</code>. The literal <code>2</code> is secretly <code>fromInteger 2</code>, and the exact <code>fromInteger</code> function used depends on the type expected by the surrounding context."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1444599572, "post_id": 33070240, "comment_id": 53958899, "body": "@melpomene: Interesting! That makes sense."}], "answers": [{"comments": [{"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1444599641, "post_id": 33070353, "comment_id": 53958922, "body": "Aha! And <code>foo</code> is &quot;available&quot; once it has been evaluated once (at the top level) \u2014 i.e., it doesn&#39;t need to be evaluated again (at least not as far as it already has been)?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1444600419, "post_id": 33070353, "comment_id": 53959135, "body": "@raxacoricofallapatorius The &quot;as far as it already has been&quot; is exactly the important part in <code>foo&#39;s</code> case. You can check this with <code>:sprint</code>: <code>let k = map Bar [1..100]; length k; :sprint k</code> (replace the semicolons with enter during your GHCi session)."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1444600473, "post_id": 33070353, "comment_id": 53959150, "body": "@raxacoricofallapatorius Yes. Since it has a monomorphic type, and is bound at the top-level it will be evaluated once. Note that this is a choice of GHCi, not one mandated by the Haskell report."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 5, "last_activity_date": 1444599396, "creation_date": 1444599396, "answer_id": 33070353, "question_id": 33070240, "link": "https://stackoverflow.com/questions/33070240/when-is-my-haskell-expression-evaluated/33070353#33070353", "title": "When is my Haskell expression evaluated?", "body": "<pre><code>&gt; :t foo\nfoo :: Foo\n&gt; :t two\ntwo :: Num a =&gt; a\n</code></pre>\n\n<p>The second one is <em>polymorphic</em>, so it's a function in disguise! Every time you use it, you will evaluate a new <code>trace</code> call.</p>\n"}, {"comments": [{"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1444659256, "post_id": 33070412, "comment_id": 53983002, "body": "That clears things up, except that the name is a but confusing, so just to be sure: With the restriction <i>disabled</i>, types like the that for the <code>two</code> example will <i>not</i> be inferred, and will thus remain polymorphic (so that they will be recomputed when a type is imposed)."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 9, "last_activity_date": 1444644254, "last_edit_date": 1495539889, "creation_date": 1444599802, "answer_id": 33070412, "question_id": 33070240, "link": "https://stackoverflow.com/questions/33070240/when-is-my-haskell-expression-evaluated/33070412#33070412", "title": "When is my Haskell expression evaluated?", "body": "<p>That's due to <code>two</code>'s type. Lets check all the type's so far:</p>\n\n<pre><code>ghci&gt; :t foo\nfoo :: Foo\nghci&gt; :t two\ntwo :: Num a =&gt; a\n</code></pre>\n\n<p>Aha! <code>two</code> is polymorphic. Therefore, its behaviour depends on the <em>actual <code>Num</code> instance</em>. Therefore, it needs to get re-evaluated in <code>g</code>. We can check this by using <code>:sprint</code>:</p>\n\n<pre><code>ghci&gt; :sprint foo\nfoo = Foo _             -- simplified\n</code></pre>\n\n<p>Which indicates that we never looked at the contents of <code>Foo</code>. <code>foo</code> is in <a href=\"https://wiki.haskell.org/Weak_head_normal_form\" rel=\"nofollow noreferrer\">weak head normal form</a>. This answers your second question. But back to your first. What happens on <code>:sprint two</code>?</p>\n\n<pre><code>ghci&gt; :sprint two\ntwo = _\n</code></pre>\n\n<p>As you can see, due to its polymorphic nature, <code>two</code> doesn't get to WHNF. After all, <em>which</em> WHNF should it take? You might want to use it as <code>Integer</code>, or <code>Currency</code>, or <code>Complex Triple</code>.</p>\n\n<p>This is, by the way, a reason for the existence of the monomorphism restriction, see <a href=\"http://research.microsoft.com/en-us/um/people/simonpj/papers/history-of-haskell/history.pdf\" rel=\"nofollow noreferrer\">\"A History of Haskell\", section 6.2</a>:</p>\n\n<blockquote>\n  <h2>6.2 The monomorphism restriction</h2>\n  \n  <p>A major source of controversy in the early stages was the so-called\n  \u201cmonomorphism restriction.\u201d Suppose that <code>genericLength</code> has\n  this overloaded type:</p>\n\n<pre><code>genericLength` :: Num a =&gt; [b] -&gt; a\n</code></pre>\n  \n  <p>Now consider this definition:</p>\n\n<pre><code>f xs = (len, len)\n  where\n    len = genericLength xs\n</code></pre>\n  \n  <p>It looks as if len should be computed only once, but it can actually be computed twice. Why? Because we can infer the type\n  <code>len :: (Num a) =&gt; a</code>; when desugared with the dictionary-\n  passing translation, <code>len</code> becomes a function that is called once\n  for each occurrence of <code>len</code>, each of which might used at a different\n  type.</p>\n</blockquote>\n\n<p>See also <a href=\"https://stackoverflow.com/questions/32496864/what-is-the-monomorphism-restriction\">this Q&amp;A for more information about the restriction</a>.</p>\n\n<p>That being said, we can easily change this if we fix <code>two</code>'s type:</p>\n\n<pre><code>ghci&gt; let foo = trace \"foo\" Foo (trace \"bar\" Bar 100)\nghci&gt; let two = trace \"two\" (2 :: Integer)\nghci&gt; let g (Foo x)  y = y\n</code></pre>\n\n<p>Now the output will be exactly as you've expected. Alternatively, you can enable the monomorphism restriction with <code>:set -XMonomorphismRestriction</code>, as it is disabled in current GHCi versions by default:</p>\n\n<pre><code>ghci&gt; :set -XMonomorphismRestriction\nghci&gt; let two = trace \"two\" 2\nghci&gt; :t two\ntwo :: Integer -- due to defaulting rules\n</code></pre>\n"}], "owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 2, "accepted_answer_id": 33070412, "answer_count": 2, "score": 5, "last_activity_date": 1444644254, "creation_date": 1444598472, "question_id": 33070240, "link": "https://stackoverflow.com/questions/33070240/when-is-my-haskell-expression-evaluated", "title": "When is my Haskell expression evaluated?", "body": "<p>If I define</p>\n\n<pre><code>\u03bb&gt; data Bar = Bar Int deriving Show\n\u03bb&gt; data Foo = Foo Bar deriving Show\n</code></pre>\n\n<p>and</p>\n\n<pre><code>\u03bb&gt; let foo = trace \"foo\" Foo (trace \"bar\" Bar 100)\n\u03bb&gt; let two = trace \"two\" 2\n\u03bb&gt; let g (Foo x)  y = y\n</code></pre>\n\n<p>then I think I understand why I get</p>\n\n<pre><code>\u03bb&gt; g foo two\nfoo\ntwo\n2\n</code></pre>\n\n<p>But if I then repeat this, I get</p>\n\n<pre><code>\u03bb&gt; g foo two\ntwo\n2\n</code></pre>\n\n<p>and I don't understand why <code>foo</code> appears not to have been evaluated for the second invocation of <code>g</code>, especially since it is clearly not (yet) somehow already available, as I can verify with</p>\n\n<pre><code>\u03bb&gt; foo\nFoo bar\n(Bar 100)\n</code></pre>\n\n<p>though \u2014\u00a0again, to my confusion \u2014 repeating the previous gives</p>\n\n<pre><code>\u03bb&gt; foo\nFoo (Bar 100)\n</code></pre>\n\n<p>Why does my <code>foo</code> expression  appear to be already evaluated in some cases, and not evaluated in others? And for that matter why does my <code>two</code> expression <em>always</em> need to be evaluated?</p>\n"}, {"tags": ["haskell", "pointfree"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 4, "creation_date": 1444591921, "post_id": 33069232, "comment_id": 53956622, "body": "well <code>gcd</code> there will produce another function if given only one argument - and in your point-free version you hand this <i>function</i>  on to <code>(== 1)</code> which of course does not know how to handle functions ;)"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 2, "creation_date": 1444592071, "post_id": 33069232, "comment_id": 53956680, "body": "maybe you understand when you first <i>remove</i>  one <i>point</i> : <code>relativePrime x = (== 1) . gcd x</code> this works! Now you cannot <i>remove</i>  <code>x</code> anymore as it is <i>tied</i> to fast to <code>gcd</code> - you could if you had <code>(== 1) $ gcd x</code>"}, {"owner": {"reputation": 21422, "user_id": 333698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca080b4ef1c6cb4df9bc123d3b3af61?s=128&d=identicon&r=PG", "display_name": "psmears", "link": "https://stackoverflow.com/users/333698/psmears"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1444592117, "post_id": 33069232, "comment_id": 53956696, "body": "@Carsten&#39;s comment is correct. One option would be to use <code>uncurry</code> to turn <code>gcd</code> into a single-argument function (taking a tuple of two integers)."}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "reply_to_user": {"reputation": 21422, "user_id": 333698, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ca080b4ef1c6cb4df9bc123d3b3af61?s=128&d=identicon&r=PG", "display_name": "psmears", "link": "https://stackoverflow.com/users/333698/psmears"}, "edited": false, "score": 0, "creation_date": 1444592253, "post_id": 33069232, "comment_id": 53956737, "body": "@psmears exactly <code>curry ((== 1) . (uncurry gcd))</code> should work ... but really IMO now point-free is point-less as the original version was easy to read and understand - this one is cluttered with useless parts just to make it point-free"}, {"owner": {"reputation": 1381, "user_id": 1936416, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e7314f391870688f6808f07e859927ae?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/1936416/ben"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1444592345, "post_id": 33069232, "comment_id": 53956761, "body": "@Carsten It does work indeed and I understand my error now. Feel free to expand this into an answer, since I think it deserves an up vote and accepted answer mark. Thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 5, "last_activity_date": 1444592504, "creation_date": 1444592504, "answer_id": 33069334, "question_id": 33069232, "link": "https://stackoverflow.com/questions/33069232/why-does-this-point-free-definition-not-work-in-haskell/33069334#33069334", "title": "Why does this point free definition not work in Haskell?", "body": "<p>as you commented on it - if you really want a point-free version you can first use <code>uncurry gcd</code> to transform <code>gcd</code> into a version that accepts a single input (a tuple):</p>\n\n<pre><code>Prelude&gt; :t uncurry gcd\nuncurry gcd :: Integral c =&gt; (c, c) -&gt; c\n</code></pre>\n\n<p>then check with <code>(== 1)</code> and finally <code>curry</code> it again for the original signature:</p>\n\n<pre><code>relativeelyPrime = curry ((== 1) . (uncurry gcd))\n</code></pre>\n\n<p>your version did not work just because <code>gcd</code> produces a function if given only the first argument and this is no legal input for <code>(== 1)</code> which awaits a number.</p>\n"}, {"tags": [], "owner": {"reputation": 67060, "user_id": 783743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/835bdcdab3e4bf466f0d59f809c50035?s=128&d=identicon&r=PG", "display_name": "Aadit M Shah", "link": "https://stackoverflow.com/users/783743/aadit-m-shah"}, "is_accepted": true, "score": 7, "last_activity_date": 1444593581, "last_edit_date": 1495541759, "creation_date": 1444593581, "answer_id": 33069506, "question_id": 33069232, "link": "https://stackoverflow.com/questions/33069232/why-does-this-point-free-definition-not-work-in-haskell/33069506#33069506", "title": "Why does this point free definition not work in Haskell?", "body": "<p>It doesn't work because <code>gcd</code> requires two inputs whereas function composition only provides <code>gcd</code> one input. Consider the definition of function composition:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>f . g = \\x -&gt; f (g x)\n</code></pre>\n\n<p>Hence, the expression <code>(== 1) . gcd</code> is equivalent to:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>\\x -&gt; (== 1) (gcd x)\n</code></pre>\n\n<p>This is not what you want. You want:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>\\x y -&gt; (== 1) (gcd x y)\n</code></pre>\n\n<p>You could define a new operator to compose a unary function with a binary function:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>f .: g = \\x y -&gt; f (g x y)\n</code></pre>\n\n<p>Then, your expression becomes:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>relativelyPrime = (== 1) .: gcd\n</code></pre>\n\n<p>In fact, the <code>(.:)</code> operator can be defined in terms of function composition:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>(.:) = (.) . (.)\n</code></pre>\n\n<p>It looks kind of like an owl, but they are indeed equivalent. Thus, another way to write the expression:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>relativelyPrime = ((== 1) .) . gcd\n</code></pre>\n\n<p>If you want to understand what's happening then see: <a href=\"https://stackoverflow.com/q/20279306/783743\">What does (f .) . g mean in Haskell?</a></p>\n"}], "owner": {"reputation": 1381, "user_id": 1936416, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e7314f391870688f6808f07e859927ae?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/1936416/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 158, "favorite_count": 0, "accepted_answer_id": 33069506, "answer_count": 2, "score": 6, "last_activity_date": 1444593581, "creation_date": 1444591789, "last_edit_date": 1444591966, "question_id": 33069232, "link": "https://stackoverflow.com/questions/33069232/why-does-this-point-free-definition-not-work-in-haskell", "title": "Why does this point free definition not work in Haskell?", "body": "<p>I tried to make the following function definition:</p>\n\n<pre><code>relativelyPrime x y = gcd x y == 1\n</code></pre>\n\n<p>point-free:</p>\n\n<pre><code>relativelyPrime = (== 1) . gcd\n</code></pre>\n\n<p>However, this gives me the following error:</p>\n\n<pre><code>Couldn't match type \u2018Bool\u2019 with \u2018a -&gt; Bool\u2019\nExpected type: (a -&gt; a) -&gt; a -&gt; Bool\n  Actual type: (a -&gt; a) -&gt; Bool\nRelevant bindings include\n  relativelyPrime :: a -&gt; a -&gt; Bool (bound at 1.hs:20:1)\nIn the first argument of \u2018(.)\u2019, namely \u2018(== 1)\u2019\nIn the expression: (== 1) . gcd\nIn an equation for \u2018relativelyPrime\u2019:\n    relativelyPrime = (== 1) . gcd\n</code></pre>\n\n<p>I don't quite understand. <code>gcd</code> takes two Ints/Integer, returns one Ints/Integer, then that one Int/Integer is checked for equality to '1'. I don't see where my error is.</p>\n"}, {"tags": ["haskell", "instances"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1444656139, "post_id": 33069143, "comment_id": 53980860, "body": "BTW, this is a type error, not a syntax error."}], "answers": [{"comments": [{"owner": {"reputation": 1390, "user_id": 1610765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/16b01bba5dacce95be27888670b7d218?s=128&d=identicon&r=PG", "display_name": "Chiffa", "link": "https://stackoverflow.com/users/1610765/chiffa"}, "edited": false, "score": 0, "creation_date": 1444592338, "post_id": 33069241, "comment_id": 53956758, "body": "That&#39;s it. Thanks. I should re-read some things about instances, probably."}], "tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": true, "score": 5, "last_activity_date": 1444591832, "creation_date": 1444591832, "answer_id": 33069241, "question_id": 33069143, "link": "https://stackoverflow.com/questions/33069143/haskell-syntax-for-instance/33069241#33069241", "title": "Haskell syntax for instance", "body": "<p>You need <code>a</code> and <code>b</code> to be instances of <code>Printable</code>:</p>\n\n<pre><code>instance (Printable a, Printable b) =&gt; Printable ( a, b ) where\n    toString (a,b) = \"(\" ++ toString a ++ \",\"++ toString b ++ \")\"\n</code></pre>\n"}], "owner": {"reputation": 1390, "user_id": 1610765, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/16b01bba5dacce95be27888670b7d218?s=128&d=identicon&r=PG", "display_name": "Chiffa", "link": "https://stackoverflow.com/users/1610765/chiffa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "accepted_answer_id": 33069241, "answer_count": 1, "score": 0, "last_activity_date": 1444591832, "creation_date": 1444591284, "question_id": 33069143, "link": "https://stackoverflow.com/questions/33069143/haskell-syntax-for-instance", "title": "Haskell syntax for instance", "body": "<p>I'm trying to make a pair an instance of <code>Printable</code>, but I can't figure out the correct syntax.\nMy Printable is this:</p>\n\n<pre><code>class Printable a where\n    toString :: a -&gt; [Char]\n\ninstance Printable Bool where\n    toString True = \"true\"\n    toString False = \"false\"\ninstance Printable () where\n    toString () = \"unit type\"\n</code></pre>\n\n<p>and my instance for pairs is this:</p>\n\n<pre><code>instance  Printable ( a, b ) where\n    toString (a,b) = \"(\" ++ toString a ++ \",\"++ toString b ++ \")\"\n</code></pre>\n\n<p>which, upon compiling, gives me a <code>No instance for (Printable a) arising from a use of \u2018toString\u2019</code>.\nWhat am I doing wrong?</p>\n"}, {"tags": ["parsing", "haskell", "if-statement"], "comments": [{"owner": {"reputation": 3632, "user_id": 856079, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/79f1d8ae198abbfd00068fd36cde5eda?s=128&d=identicon&r=PG", "display_name": "rafalio", "link": "https://stackoverflow.com/users/856079/rafalio"}, "edited": false, "score": 1, "creation_date": 1444588855, "post_id": 33068677, "comment_id": 53955639, "body": "What&#39;s the error? I think you might need to wrap the calls in the last line in parentheses, ie <code>((length (y:ys)) - 1) : (listaind x ys)</code>"}, {"owner": {"reputation": 1, "user_id": 4529439, "user_type": "registered", "profile_image": "https://graph.facebook.com/949032991774543/picture?type=large", "display_name": "joao12021996", "link": "https://stackoverflow.com/users/4529439/joao12021996"}, "reply_to_user": {"reputation": 3632, "user_id": 856079, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/79f1d8ae198abbfd00068fd36cde5eda?s=128&d=identicon&r=PG", "display_name": "rafalio", "link": "https://stackoverflow.com/users/856079/rafalio"}, "edited": false, "score": 0, "creation_date": 1444589856, "post_id": 33068677, "comment_id": 53955934, "body": "the error continues. i tried your solution and it fails as well"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1444590306, "post_id": 33068677, "comment_id": 53956080, "body": "Btw, <code>length (y : ys) - 1</code> is <code>length ys</code>."}, {"owner": {"reputation": 1, "user_id": 4529439, "user_type": "registered", "profile_image": "https://graph.facebook.com/949032991774543/picture?type=large", "display_name": "joao12021996", "link": "https://stackoverflow.com/users/4529439/joao12021996"}, "edited": false, "score": 0, "creation_date": 1444590431, "post_id": 33068677, "comment_id": 53956132, "body": "error:  parse error on input (name of next function i have in the file)"}], "answers": [{"tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 4, "last_activity_date": 1444590539, "creation_date": 1444590539, "answer_id": 33069006, "question_id": 33068677, "link": "https://stackoverflow.com/questions/33068677/parse-error-and-no-clue-about-the-error/33069006#33069006", "title": "Parse error and no clue about the error", "body": "<p>Your <code>if</code> is missing a corresponding <code>else</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 1, "user_id": 4529439, "user_type": "registered", "profile_image": "https://graph.facebook.com/949032991774543/picture?type=large", "display_name": "joao12021996", "link": "https://stackoverflow.com/users/4529439/joao12021996"}, "edited": false, "score": 0, "creation_date": 1444591115, "post_id": 33069038, "comment_id": 53956354, "body": "i would, but i can&#39;t change the heading of the function. i mean, my professors gave me this heading &quot;elemIndices&#39; :: Eq a =&gt; a -&gt; [a] -&gt; [Int]&quot; so i can&#39;t change it. i really would like to use a variable for the index, but i can&#39;t. thx for the tip anyway. :D"}, {"owner": {"reputation": 1, "user_id": 4529439, "user_type": "registered", "profile_image": "https://graph.facebook.com/949032991774543/picture?type=large", "display_name": "joao12021996", "link": "https://stackoverflow.com/users/4529439/joao12021996"}, "edited": false, "score": 0, "creation_date": 1444688995, "post_id": 33069038, "comment_id": 53998401, "body": "ohhh ok got it. a secondary function. thx for the tip as well :)"}], "tags": [], "owner": {"reputation": 17837, "user_id": 1923190, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/D0JyZ.jpg?s=128&g=1", "display_name": "Simon H", "link": "https://stackoverflow.com/users/1923190/simon-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1444595167, "last_edit_date": 1444595167, "creation_date": 1444590735, "answer_id": 33069038, "question_id": 33068677, "link": "https://stackoverflow.com/questions/33068677/parse-error-and-no-clue-about-the-error/33069038#33069038", "title": "Parse error and no clue about the error", "body": "<p>I would do it this way, and once your comfortable with recursion, try to do it as a fold</p>\n\n<pre><code>elemIndices :: Eq a =&gt; a -&gt; [a] -&gt; [Int]\nelemIndices = elemIndices' 0\n\nelemIndices' :: Int -&gt; a -&gt; [a] -&gt; [Int]\nelemIndices' _ _ [] = []\nelemIndices' idx s (x:xs) =\n    if s == x\n    then idx : elemIndices' (idx + 1) s xs\n    else elemIndices' (idx + 1) s xs\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4529439, "user_type": "registered", "profile_image": "https://graph.facebook.com/949032991774543/picture?type=large", "display_name": "joao12021996", "link": "https://stackoverflow.com/users/4529439/joao12021996"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 33069006, "answer_count": 2, "score": -5, "last_activity_date": 1444595167, "creation_date": 1444588678, "last_edit_date": 1444591033, "question_id": 33068677, "link": "https://stackoverflow.com/questions/33068677/parse-error-and-no-clue-about-the-error", "title": "Parse error and no clue about the error", "body": "<p>I dont know what is wrong in the code below. \nThe objective of this code is to give me a list of the indexes of a character in a list.</p>\n\n<p>Example: <code>elemIndices 3 [1,2,3,4,3,2,3,4,5]</code> means <code>[2,4,6]</code>  </p>\n\n<pre><code>elemIndices' :: Eq a =&gt; a -&gt; [a] -&gt; [Int]\nelemIndices' x [] = []\nelemIndices' x l = reverse (listaind x l)\n\nlistaind :: Eq a =&gt; a -&gt; [a] -&gt;[Int]\nlistaind x [] = []\nlistaind x (y:ys) = if x == y then (length ys) : listaind x ys\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 3024, "user_id": 3154996, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2031da3bb3fc999ec22e677995debd7b?s=128&d=identicon&r=PG&f=1", "display_name": "Elliot Gorokhovsky", "link": "https://stackoverflow.com/users/3154996/elliot-gorokhovsky"}, "edited": false, "score": 0, "creation_date": 1444587514, "post_id": 33068465, "comment_id": 53955209, "body": "Oh, I didn&#39;t know you could pattern match like that! Where can I find the full restrictions on pattern matching?"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 3024, "user_id": 3154996, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2031da3bb3fc999ec22e677995debd7b?s=128&d=identicon&r=PG&f=1", "display_name": "Elliot Gorokhovsky", "link": "https://stackoverflow.com/users/3154996/elliot-gorokhovsky"}, "edited": false, "score": 0, "creation_date": 1444587666, "post_id": 33068465, "comment_id": 53955244, "body": "@Ren&#233;G Added to the answer."}, {"owner": {"reputation": 3024, "user_id": 3154996, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2031da3bb3fc999ec22e677995debd7b?s=128&d=identicon&r=PG&f=1", "display_name": "Elliot Gorokhovsky", "link": "https://stackoverflow.com/users/3154996/elliot-gorokhovsky"}, "edited": false, "score": 0, "creation_date": 1444587869, "post_id": 33068465, "comment_id": 53955306, "body": "Also: you should change <code>(x:_:[])</code> to <code>[x,_]</code>"}, {"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "reply_to_user": {"reputation": 3024, "user_id": 3154996, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2031da3bb3fc999ec22e677995debd7b?s=128&d=identicon&r=PG&f=1", "display_name": "Elliot Gorokhovsky", "link": "https://stackoverflow.com/users/3154996/elliot-gorokhovsky"}, "edited": false, "score": 0, "creation_date": 1444587951, "post_id": 33068465, "comment_id": 53955340, "body": "@Ren&#233;G I think the first form is easier for beginners (fewer special cases in patterns)."}], "tags": [], "owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "is_accepted": true, "score": 8, "last_activity_date": 1444587648, "last_edit_date": 1444587648, "creation_date": 1444587434, "answer_id": 33068465, "question_id": 33068428, "link": "https://stackoverflow.com/questions/33068428/second-to-last-element-of-a-list-in-haskell/33068465#33068465", "title": "Second to last element of a list in Haskell", "body": "<p>The easiest way is to avoid <code>length</code>:</p>\n\n<pre><code>myButLast (x : _ : []) = x  -- base case\nmyButLast (_ : xs)     = myButLast xs\n</code></pre>\n\n<p>The definitive reference on patterns in Haskell is the language report: <a href=\"https://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-580003.17\" rel=\"noreferrer\">https://www.haskell.org/onlinereport/haskell2010/haskellch3.html#x8-580003.17</a></p>\n\n<p>GHC implements a few extensions described at <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/syntax-extns.html#pattern-guards\" rel=\"noreferrer\">https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/syntax-extns.html#pattern-guards</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": false, "score": 6, "last_activity_date": 1444587473, "creation_date": 1444587473, "answer_id": 33068470, "question_id": 33068428, "link": "https://stackoverflow.com/questions/33068428/second-to-last-element-of-a-list-in-haskell/33068470#33068470", "title": "Second to last element of a list in Haskell", "body": "<p>what about</p>\n\n<pre><code>myButLast []     = error \"oho\"\nmyButLast [x,_]  = x\nmyButLast (_:xs) = myButLast xs\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 78982, "user_id": 1848654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84180c0f3c9c04f8b8f0613fc0129dac?s=128&d=identicon&r=PG", "display_name": "melpomene", "link": "https://stackoverflow.com/users/1848654/melpomene"}, "edited": false, "score": 0, "creation_date": 1444587691, "post_id": 33068477, "comment_id": 53955254, "body": "<code>fst . last . ap zip tail</code> - no parens!"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1444587743, "post_id": 33068477, "comment_id": 53955266, "body": "yeah for the Kleene <i>trick</i> :D (... did you know that I cannot start a comment with &quot;+1&quot; here anymore?)"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 4, "creation_date": 1444595952, "post_id": 33068477, "comment_id": 53957900, "body": "If you&#39;re going to go partial, why not <code>last . init</code>?"}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1444600159, "post_id": 33068477, "comment_id": 53959070, "body": "@Carsten: +1/-1 comments <a href=\"https://meta.stackoverflow.com/questions/277314/should-we-discourage-leading-1-on-comments\">have been</a> disabled <a href=\"http://meta.stackoverflow.com/questions/278161/users-working-around-the-1-comment-block\">for a while</a>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1444611353, "post_id": 33068477, "comment_id": 53961545, "body": "One great thing is that this generalizes <i>efficiently</i> to nth-from-last."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 5, "last_activity_date": 1444588587, "last_edit_date": 1444588587, "creation_date": 1444587497, "answer_id": 33068477, "question_id": 33068428, "link": "https://stackoverflow.com/questions/33068428/second-to-last-element-of-a-list-in-haskell/33068477#33068477", "title": "Second to last element of a list in Haskell", "body": "<p>Exploiting <code>zip</code>:</p>\n\n<pre><code>\\l -&gt; fst . last $ zip l (tail l)\n</code></pre>\n\n<p>Also available in a pointless, obfuscated style:</p>\n\n<pre><code>fst . last . (zip &lt;*&gt; tail)\n</code></pre>\n\n<p>or even without parentheses (thanks to @melpomene):</p>\n\n<pre><code>fst . last . ap zip tail\n</code></pre>\n\n<p>Other variants:</p>\n\n<pre><code>last . ap (zipWith const) tail\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10220, "user_id": 2720372, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/olQxk.jpg?s=128&g=1", "display_name": "w.b", "link": "https://stackoverflow.com/users/2720372/w-b"}, "is_accepted": false, "score": 4, "last_activity_date": 1444597009, "last_edit_date": 1444597009, "creation_date": 1444588410, "answer_id": 33068629, "question_id": 33068428, "link": "https://stackoverflow.com/questions/33068428/second-to-last-element-of-a-list-in-haskell/33068629#33068629", "title": "Second to last element of a list in Haskell", "body": "<p>Another solution:</p>\n\n<pre><code>myButLast [] = error \"List is empty\"\nmyButLast [x] = error \"List is a singleton\"\nmyButLast xs = last $ init xs\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1538815665, "post_id": 52663193, "comment_id": 92283529, "body": "(correction to my previous comment:) calling <code>myButLast [1]</code> will cause an error, because <code>tail []</code> is an error. This could be fixed with <code>not (null xs) &amp;&amp; null (tail xs)</code>, for example."}, {"owner": {"reputation": 33, "user_id": 9282443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec27afd669197cacddfe1852f7684bd5?s=128&d=identicon&r=PG&f=1", "display_name": "MyLifeisPi", "link": "https://stackoverflow.com/users/9282443/mylifeispi"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1538820333, "post_id": 52663193, "comment_id": 92284695, "body": "Thanks @WillNess . The code now returns the sole entry when it can&#39;t find the penultimate element. The fix was in using ((null xs) || null (tail xs))"}], "tags": [], "owner": {"reputation": 33, "user_id": 9282443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec27afd669197cacddfe1852f7684bd5?s=128&d=identicon&r=PG&f=1", "display_name": "MyLifeisPi", "link": "https://stackoverflow.com/users/9282443/mylifeispi"}, "is_accepted": false, "score": 1, "last_activity_date": 1538820447, "last_edit_date": 1538820447, "creation_date": 1538734023, "answer_id": 52663193, "question_id": 33068428, "link": "https://stackoverflow.com/questions/33068428/second-to-last-element-of-a-list-in-haskell/52663193#52663193", "title": "Second to last element of a list in Haskell", "body": "<p>Here is my solution using the tail function from prelude</p>\n\n<pre><code>myButLast :: [Int] -&gt; Maybe Int\nmyButLast (x:xs) | ((null xs) || null (tail xs)) = Just x\n                 | otherwise                     = myButLast(xs)\nmyButLast []                                     = Nothing\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 1, "last_activity_date": 1538752922, "creation_date": 1538752922, "answer_id": 52668821, "question_id": 33068428, "link": "https://stackoverflow.com/questions/33068428/second-to-last-element-of-a-list-in-haskell/52668821#52668821", "title": "Second to last element of a list in Haskell", "body": "<p>Another zip-based solution, without exlicitly zipping. Throw in some safety for good measure.</p>\n\n<pre><code>import Data.Maybe\n\ng :: Int -&gt; [a] -&gt; Maybe a\ng i = (head &lt;$&gt;) . listToMaybe . reverse         -- quick'n'dirty safe-last\n                 . getZipList . traverse ZipList \n                 . sequence [id, drop i] \n\ng  1 [1..10] =&gt; Just 9\ng  3 [1..10] =&gt; Just 7\ng 13 [1..10] =&gt; Nothing\n</code></pre>\n"}], "owner": {"reputation": 3024, "user_id": 3154996, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2031da3bb3fc999ec22e677995debd7b?s=128&d=identicon&r=PG&f=1", "display_name": "Elliot Gorokhovsky", "link": "https://stackoverflow.com/users/3154996/elliot-gorokhovsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2474, "favorite_count": 0, "accepted_answer_id": 33068465, "answer_count": 6, "score": 4, "last_activity_date": 1538820447, "creation_date": 1444587243, "question_id": 33068428, "link": "https://stackoverflow.com/questions/33068428/second-to-last-element-of-a-list-in-haskell", "title": "Second to last element of a list in Haskell", "body": "<p>Consider the following function for finding the second-to-last element of a list:</p>\n\n<pre><code>myButLast (x:xs) = if length xs &gt; 1 then myButLast xs else x\n</code></pre>\n\n<p>This is an O(n^2) algorithm, because <code>length xs</code> is O(n) and is called O(n) times. What is the most elegant way to write this in Haskell such that <code>length</code> stops once it gets past 1, so that the algorithm is O(n)?</p>\n"}, {"tags": ["haskell", "yesod"], "answers": [{"tags": [], "owner": {"reputation": 1657, "user_id": 4183787, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/XedpJ.png?s=128&g=1", "display_name": "zigazou", "link": "https://stackoverflow.com/users/4183787/zigazou"}, "is_accepted": false, "score": 5, "last_activity_date": 1444586721, "creation_date": 1444586721, "answer_id": 33068344, "question_id": 33068018, "link": "https://stackoverflow.com/questions/33068018/yesod-css-not-in-scope-variable/33068344#33068344", "title": "Yesod css - not in scope variable", "body": "<p>From the <a href=\"https://github.com/yesodweb/yesod/wiki/yesod_tutorial-filling_in_the_layout\">Yesod tutorial</a>:</p>\n\n<blockquote>\n  <p>Whenever you modify your static folder, touch StaticFiles.hs and you\n  should be good to go.</p>\n  \n  <p>So, run this command in the console:</p>\n  \n  <p><code>touch Settings/StaticFiles.hs</code></p>\n</blockquote>\n\n<p>The <code>StaticFiles.hs</code> file needs to be compiled in order to have the <code>css_style_css</code> definition. If you modify you static folder, this file is out of sync with the folder content but GHC/Stack has no mean to find out.</p>\n"}, {"comments": [{"owner": {"reputation": 1163, "user_id": 1582607, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5ed8ab69f97e22877cc1cc7db0cb06c?s=128&d=identicon&r=PG", "display_name": "Dario Oddenino", "link": "https://stackoverflow.com/users/1582607/dario-oddenino"}, "edited": false, "score": 1, "creation_date": 1508332853, "post_id": 33105621, "comment_id": 80569415, "body": "In recent templates this has to be added to the <code>package.yaml</code> file, as the cabal file is generated automatically."}], "tags": [], "owner": {"reputation": 620, "user_id": 2576287, "user_type": "registered", "accept_rate": 56, "profile_image": "https://lh5.googleusercontent.com/-VegFz4P9Ovc/AAAAAAAAAAI/AAAAAAAAATo/Z-69W9rBCno/photo.jpg?sz=128", "display_name": "mrLSD", "link": "https://stackoverflow.com/users/2576287/mrlsd"}, "is_accepted": true, "score": 1, "last_activity_date": 1444747275, "creation_date": 1444747275, "answer_id": 33105621, "question_id": 33068018, "link": "https://stackoverflow.com/questions/33068018/yesod-css-not-in-scope-variable/33105621#33105621", "title": "Yesod css - not in scope variable", "body": "<ol>\n<li>Open your Cabal file</li>\n<li>FInd block:</li>\n</ol>\n\n<blockquote>\n<pre><code>if flag(dev) || flag(library-only)\n    cpp-options:   -DDEVELOPMENT\n    ghc-options:   -Wall -fwarn-tabs -O0\nelse\n    ghc-options:   -Wall -fwarn-tabs -O2\n</code></pre>\n</blockquote>\n\n<p>and add <strong>-fforce-recomp</strong> to <strong>ghc-options</strong> for needed line.</p>\n"}], "owner": {"reputation": 15, "user_id": 4964236, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3b9bc2798abfc89b1de938e05ba05e0?s=128&d=identicon&r=PG&f=1", "display_name": "John Do", "link": "https://stackoverflow.com/users/4964236/john-do"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 378, "favorite_count": 0, "accepted_answer_id": 33105621, "answer_count": 2, "score": 1, "last_activity_date": 1444747275, "creation_date": 1444584847, "last_edit_date": 1444650076, "question_id": 33068018, "link": "https://stackoverflow.com/questions/33068018/yesod-css-not-in-scope-variable", "title": "Yesod css - not in scope variable", "body": "<p>I initialize Yesod project from template.\nI got error when try change css variable at Foundation.hs</p>\n\n<pre><code>$ stack new s1 yesod-simple\n$ cd s1\n$ mv static/css/bootstrap.css static/css/style.css\n</code></pre>\n\n<p>Change <strong>Foundation.hs</strong></p>\n\n<pre><code>pc &lt;- widgetToPageContent $ do\n    addStylesheet $ StaticR css_bootstrap_css\n    $(widgetFile \"default-layout\")\n</code></pre>\n\n<p>to</p>\n\n<pre><code>     pc &lt;- widgetToPageContent $ do\n         addStylesheet $ StaticR css_style_css\n         $(widgetFile \"default-layout\")\n\n$ stack build\n...\n[4 of 8] Compiling Foundation       ( Foundation.hs, .stack-work/dist/x86_64-linux/Cabal-1.22.4.0/build/Foundation.o )\n\nFoundation.hs:64:37: Not in scope: \u2018css_style_css\u2019\n</code></pre>\n\n<p>But as I know at compile time css_style_css should automatically appeared.\nWhat I do wrong? And what can I do if we need added several css files to default layout?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user824425"}, "edited": false, "score": 3, "creation_date": 1444577131, "post_id": 33066635, "comment_id": 53951986, "body": "As the examples on the wiki (should) imply, you need a <code>forall s</code> in the type signature of <code>foo</code> to actually use it with <code>ScopedTypeVariables</code>."}], "answers": [{"tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": false, "score": 5, "last_activity_date": 1444577153, "creation_date": 1444577153, "answer_id": 33066688, "question_id": 33066635, "link": "https://stackoverflow.com/questions/33066635/haskell-are-type-variables-in-where-clauses-in-the-same-namespace-with-their/33066688#33066688", "title": "Haskell: Are type variables in &quot;where&quot; clauses in the same namespace with their parents?", "body": "<p><code>ScopedTypeVariables</code> are indeed the solution, but there's an extra requirement to use them: You must put explicit <code>forall</code>s in the type signatures declaring the variables you want to scope, like this:</p>\n\n<pre><code>foo :: forall s. T s -&gt; s -&gt; s\n</code></pre>\n\n<p>This is so that the meaning of signatures in code doesn't depend on whether the extension is enabled or not.</p>\n"}, {"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1444580546, "post_id": 33066770, "comment_id": 53952995, "body": "While one could have used <code>bar `typeOf` typeOf</code>, I find the above explicit <code>idType</code> definition much more readable. I&#39;d probably have defined it as <code>idType _ a = a</code>, or even as <code>idType = undefined</code>, but after all its actual definition is immaterial."}, {"owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1444588692, "post_id": 33066770, "comment_id": 53955593, "body": "I thought about <code>idType = undefined </code>, but even though we&#39;re just using its type, I wouldn&#39;t feel comfortable with a partial function in this case. But yes, <code>idType = asTypeOf</code>."}], "tags": [], "owner": {"reputation": 94713, "user_id": 1139697, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5f136ddb684f39aaee1c028ee1950f6f?s=128&d=identicon&r=PG", "display_name": "Zeta", "link": "https://stackoverflow.com/users/1139697/zeta"}, "is_accepted": true, "score": 7, "last_activity_date": 1444578585, "last_edit_date": 1444578585, "creation_date": 1444577643, "answer_id": 33066770, "question_id": 33066635, "link": "https://stackoverflow.com/questions/33066635/haskell-are-type-variables-in-where-clauses-in-the-same-namespace-with-their/33066770#33066770", "title": "Haskell: Are type variables in &quot;where&quot; clauses in the same namespace with their parents?", "body": "<blockquote>\n  <p>Are type variables in \u201cwhere\u201d clauses in the same namespace with their parents?</p>\n</blockquote>\n\n<p>No*. This gets a little bit easier if you think of <code>foo :: s -&gt; s</code> in terms of <code>foo :: forall s. s -&gt; s</code>. After all, a type variable indicates that the function works for any type <code>s</code>. Let's add explicit quantifications to your code:</p>\n\n<pre><code>{-# LANGUAGE ExplicitForAll #-}\n\ndata T s = T (s -&gt; s)\n\nfoo :: forall s. T s -&gt; s -&gt; s\nfoo (T f) x = bar x where\n    bar :: forall s. s -&gt; s\n    bar a = f a\n</code></pre>\n\n<p>As you can see, there are two <code>forall s.</code> there. But the one in <code>bar</code> is wrong. After all, you cannot choose <em>any</em> <code>s</code> there, but the one already used in <code>s</code>. This can be done by enabling <code>ScopedTypeVariables</code>:</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables #-}\n\ndata T s = T (s -&gt; s)\n\n--     vvvvvvvv  explicit here\nfoo :: forall s. T s -&gt; s -&gt; s\nfoo (T f) x = bar x where\n    --     vvvvvv  same as above here\n    bar :: s -&gt; s\n    bar a = f a\n</code></pre>\n\n<p>However, there are some tricks to get rid of <code>ScopedTypeVariables</code>. For example the following in this case:</p>\n\n<pre><code>data T s = T (s -&gt; s)\n\nfoo :: T s -&gt; s -&gt; s\nfoo (T f) x = (bar `asTypeOf` idType x) x where\n\n    bar a = f a\n\n    idType :: a -&gt; a -&gt; a\n    idType a _ = a\n\n-- For completion, definition and type of 'asTypeOf'\n-- asTypeOf :: a -&gt; a -&gt; a\n-- asTypeOf x _ = x\n</code></pre>\n\n<p>For any <code>x :: s</code> the term <code>idType x</code> has type <code>s -&gt; s</code>, and <code>asTypeOf</code> enforces both to have the same type.</p>\n\n<p>Depending on your actual code, something like this might be more or less feasible.</p>\n\n<hr>\n\n<p><sup>* Well, in this case, since it's possible to use <code>ScopedTypeVariables</code>, see later part of the answer.</sup></p>\n"}], "owner": {"reputation": 1332, "user_id": 3262785, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/XqvLk.jpg?s=128&g=1", "display_name": "sqd", "link": "https://stackoverflow.com/users/3262785/sqd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 1, "accepted_answer_id": 33066770, "answer_count": 2, "score": 5, "last_activity_date": 1444578585, "creation_date": 1444576813, "question_id": 33066635, "link": "https://stackoverflow.com/questions/33066635/haskell-are-type-variables-in-where-clauses-in-the-same-namespace-with-their", "title": "Haskell: Are type variables in &quot;where&quot; clauses in the same namespace with their parents?", "body": "<p>In the following snippet (I have abstracted all other trivial parts)</p>\n\n<pre><code>data T s = T (s -&gt; s)\n\nfoo :: T s -&gt; s -&gt; s\nfoo (T f) x = bar x where\n    bar :: s -&gt; s\n    bar a = f a\n</code></pre>\n\n<p>I got following error</p>\n\n<pre><code>Couldn't match expected type `s1' with actual type `s'\n  `s1' is a rigid type variable bound by\n       the type signature for bar :: s1 -&gt; s1 at /tmp/test.hs:5:12\n  `s' is a rigid type variable bound by\n      the type signature for foo :: T s -&gt; s -&gt; s at /tmp/test.hs:3:8\nIn the return type of a call of `f'\nIn the expression: f a\nIn an equation for `bar': bar a = f a\n</code></pre>\n\n<p>my guess was that the type variables in <code>bar</code>'s signature don't share the namespace with <code>foo</code>, so the compiler can't infer that the two <code>s</code> actually mean the same type.</p>\n\n<p>Then I found this page <a href=\"https://wiki.haskell.org/Scoped_type_variables\">Scoped type variables</a>, which suggests that I can use <code>{-# LANGUAGE ScopedTypeVariables #-}</code>, which didn't help. I got the same error.</p>\n"}, {"tags": ["haskell", "agda", "dependent-type", "idris", "type-theory"], "comments": [{"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1444573107, "post_id": 33065965, "comment_id": 53950843, "body": "@closer I understand the question might not be clear, but would you comment on what you didn&#39;t understand and/or suggest how I could improve it?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 13, "creation_date": 1444575473, "post_id": 33065965, "comment_id": 53951534, "body": "The mentioned issue - &quot;how to tell my spec is right&quot; - is sometimes used by detractors of formal methods. In the worst case the argument goes as far as saying &quot;having a formal spec is useless since it is no simpler than the actual implementation&quot;. While there&#39;s indeed some truth in that, the argument conveniently neglects the fact that there are <i>partial</i> specs (e.g. &quot;no runtime errors, ever&quot;) which are very simple, important, and frequently violated by complex software."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1444576241, "post_id": 33065965, "comment_id": 53951760, "body": "@chi I understand , but I don&#39;t know about that. It is just a legit question I had."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1444579865, "post_id": 33065965, "comment_id": 53952777, "body": "Indeed it is! I was only trying to provide some context to the question."}, {"owner": {"reputation": 792, "user_id": 3550444, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8a06f855d0b44ead04edffa576cd943e?s=128&d=identicon&r=PG", "display_name": "Musa Al-hassy", "link": "https://stackoverflow.com/users/3550444/musa-al-hassy"}, "edited": false, "score": 2, "creation_date": 1444605712, "post_id": 33065965, "comment_id": 53960373, "body": "@Viclib <a href=\"http://mazzo.li/posts/AgdaSort.html\" rel=\"nofollow noreferrer\">mazzo.li/posts/AgdaSort.html</a>, read that. Very accessible and a wonderful delight."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1444617777, "post_id": 33065965, "comment_id": 53962869, "body": "@chi I know! I was just clarifying my intentions."}, {"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "reply_to_user": {"reputation": 792, "user_id": 3550444, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/8a06f855d0b44ead04edffa576cd943e?s=128&d=identicon&r=PG", "display_name": "Musa Al-hassy", "link": "https://stackoverflow.com/users/3550444/musa-al-hassy"}, "edited": false, "score": 0, "creation_date": 1444617898, "post_id": 33065965, "comment_id": 53962894, "body": "@Moses that was a delightful read, indeed. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 1, "creation_date": 1444575360, "post_id": 33066205, "comment_id": 53951502, "body": "So you&#39;d need a way to express on the types that both lists have the same elements..."}, {"owner": {"reputation": 5054, "user_id": 548515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55624bebc921a03713d00a91c9e58a36?s=128&d=identicon&r=PG", "display_name": "Hans Lub", "link": "https://stackoverflow.com/users/548515/hans-lub"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 5, "creation_date": 1444578699, "post_id": 33066205, "comment_id": 53952418, "body": "Yes. You could prove a lemma (i.e. construct a term with type:) <code>\u2200 (xs : List A) \u2192 (IsSortedList (sort xs), IsPermutation xs (sort xs))</code>. Again, see the <a href=\"http://www.twanvl.nl/blog/agda/sorting\" rel=\"nofollow noreferrer\">blog post</a> mentioned above."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 3, "creation_date": 1444580072, "post_id": 33066205, "comment_id": 53952855, "body": "@Viclib <code>forall list, c. length (filter (==c) list) == length (filter (==c) (sort list))</code> is a way to express the permutation requirement."}], "tags": [], "owner": {"reputation": 5054, "user_id": 548515, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55624bebc921a03713d00a91c9e58a36?s=128&d=identicon&r=PG", "display_name": "Hans Lub", "link": "https://stackoverflow.com/users/548515/hans-lub"}, "is_accepted": false, "score": 19, "last_activity_date": 1444607061, "last_edit_date": 1444607061, "creation_date": 1444574211, "answer_id": 33066205, "question_id": 33065965, "link": "https://stackoverflow.com/questions/33065965/dependent-types-can-prove-your-code-is-correct-up-to-a-specification-but-how-do/33066205#33066205", "title": "Dependent types can prove your code is correct up to a specification. But how do you prove the specification is correct?", "body": "<p>This is a problem with any specification language (even English), not just dependent types. Your own post is a good example: it contains an informal specification of \"sort function\" that only requires the result to be sorted, which is <em>not</em> what you want (<code>\\xs -&gt; []</code> would qualify). See e.g. <a href=\"http://www.twanvl.nl/blog/agda/sorting\">this post</a> from Twan van Laarhoven's blog.</p>\n"}, {"comments": [{"owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 1, "creation_date": 1444574446, "post_id": 33066217, "comment_id": 53951244, "body": "This makes a lot of sense to me, mostly the part of the specification being simpler than the implementation. To anyone willing, a great addition would be showing some real-world examples where a specification is very simple, yet the implementation is unwieldy complex."}, {"owner": {"reputation": 34875, "user_id": 72508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/698e94ec61aae18a4cae067ad645b3fb?s=128&d=identicon&r=PG", "display_name": "Jeremy W. Sherman", "link": "https://stackoverflow.com/users/72508/jeremy-w-sherman"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1444575775, "post_id": 33066217, "comment_id": 53951639, "body": "I don&#39;t have an example ready to hand, but you might be able to find some by looking at the seL4 project, CompCert, or research papers using Agda or Coq, like \u201cTowards native higher-order remote procedure calls.\u201d"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 2, "creation_date": 1444578597, "post_id": 33066217, "comment_id": 53952393, "body": "@Viclib, one theme is verification of compiler optimizations by proving they preserve program meaning according to some formalization of program meaning."}, {"owner": {"reputation": 2915, "user_id": 1295154, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9687b362fd1d4754033efc0b19001e81?s=128&d=identicon&r=PG", "display_name": "Dominique Devriese", "link": "https://stackoverflow.com/users/1295154/dominique-devriese"}, "edited": false, "score": 4, "creation_date": 1444595238, "post_id": 33066217, "comment_id": 53957669, "body": "Sorting (mentioned in the original question) is also a good example, I think.  The specification of sortedness of a list can be significantly easier than the implementation of a non-trivial sorting algorithm."}], "tags": [], "owner": {"reputation": 34875, "user_id": 72508, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/698e94ec61aae18a4cae067ad645b3fb?s=128&d=identicon&r=PG", "display_name": "Jeremy W. Sherman", "link": "https://stackoverflow.com/users/72508/jeremy-w-sherman"}, "is_accepted": true, "score": 37, "last_activity_date": 1444574302, "creation_date": 1444574302, "answer_id": 33066217, "question_id": 33065965, "link": "https://stackoverflow.com/questions/33065965/dependent-types-can-prove-your-code-is-correct-up-to-a-specification-but-how-do/33066217#33066217", "title": "Dependent types can prove your code is correct up to a specification. But how do you prove the specification is correct?", "body": "<p>This is the static, type-system version of, <a href=\"https://stackoverflow.com/questions/561485/how-do-you-tell-that-your-unit-tests-are-correct\">How do you tell that your tests are correct?</a></p>\n\n<p>The only answer I can honestly give is, yes, the more complex and unwieldy your specification, the more likely you are to have made a mistake. You can mess up in writing something in a type theoretic formalism just as well as you can in formalizing the description of your program as an executable function.</p>\n\n<p>The hope is that your specification is simple and small enough to judge by examination, while your implementation of that might be far larger. It helps that, once you have some \"seed\" ideas formalized, you can show that the ideas derived from these are correct. From that point of view, the more readily you can mechanically and provably derive parts of your specification from simpler parts, and ultimately derive your implementation from your specification, the more likely you are to get a correct implementation.</p>\n\n<p>But it can be unclear how to formalize something, which has the effect that either you might make a mistake in translating your ideas into the formalism \u2013 you might <a href=\"https://jeremywsherman.com/blog/2015/10/02/when-is-proof-not-proof/\">think you proved one thing, when actually you proved another</a> \u2013 or you might find yourself doing type theory research in order to formalize an idea.</p>\n"}, {"comments": [{"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "edited": false, "score": 0, "creation_date": 1444583746, "post_id": 33066992, "comment_id": 53953972, "body": "@Viclib, I clarified my point of view a bit. I guess not many people would agree with me."}, {"owner": {"reputation": 1227, "user_id": 418772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812e307892de3240c2b50a3e66295f84?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/418772/rob"}, "edited": false, "score": 0, "creation_date": 1444645481, "post_id": 33066992, "comment_id": 53974190, "body": "The scope of consistency checks is the main difference between code and specification.  Mere code allows you to divide by zero to produce a program that halts.  Specifications complain that possible zero divides contradict the assertion that the result is a number.  Sufficiently strongly typed programs are exactly the same as proofs.  Proofs are only deep consistency checks."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "reply_to_user": {"reputation": 1227, "user_id": 418772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812e307892de3240c2b50a3e66295f84?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/418772/rob"}, "edited": false, "score": 0, "creation_date": 1444654362, "post_id": 33066992, "comment_id": 53979659, "body": "@Rob, &quot;proofs&quot; correspond to semantics. Strongly typed programs are pure syntactic constructions, and they have no semantics until you supply some informal treatment. A bird is nothing more than a physical object (which is a default trusted informal treatment) until you provide some classification and can call it the &quot;mockingbird&quot;. So well-typed programs are not &quot;checks&quot; \u2014 they ontologically exist before any relations are established."}, {"owner": {"reputation": 1227, "user_id": 418772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812e307892de3240c2b50a3e66295f84?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/418772/rob"}, "edited": false, "score": 0, "creation_date": 1444703132, "post_id": 33066992, "comment_id": 54002144, "body": "@user3237465, I mean proofs in the Constructive Type Theory sense, which fit well with the creation of well-specified code using dependent types.  I generally agree with the answer you gave.    When people want to &quot;prove the code correct&quot;, what they are really saying is that they have a long list of specific - but not entirely enumerated - assertions like &quot;does not segfault&quot;, &quot;ints behave like integers&quot;, &quot;code doesn&#39;t contradict itself&quot;, &quot;unsupported input is rejected&quot;, etc."}], "tags": [], "owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "is_accepted": false, "score": 14, "last_activity_date": 1444654453, "last_edit_date": 1444654453, "creation_date": 1444578950, "answer_id": 33066992, "question_id": 33065965, "link": "https://stackoverflow.com/questions/33065965/dependent-types-can-prove-your-code-is-correct-up-to-a-specification-but-how-do/33066992#33066992", "title": "Dependent types can prove your code is correct up to a specification. But how do you prove the specification is correct?", "body": "<p>I think it's the other way around: a well-typed program can't prove nonsense (assuming the system is constistent), while specifications can be inconsistent or just silly. So it's not \"how to make sure this piece of code reflects my platonic ideas?\", but rather \"how to make sure my ideas meaningfully project onto a well-founded plane of pure syntactic rules?\". How to make sure the bird you see is a mockingbird [for some supplied notion of mockingbirdness]? Well, study birds and raise you chances to be right. But as <a href=\"https://en.wikipedia.org/wiki/Brain_in_a_vat\">always</a> with <a href=\"https://en.wikipedia.org/wiki/Cognitive_distortion\">humans</a>, you <a href=\"https://en.wikipedia.org/wiki/Hallucination\">can't</a> be 100% sure.</p>\n\n<p>Type theory is a way to mitigate the imperfectness of human mind by introducing formal rules, <a href=\"http://homepages.inf.ed.ac.uk/rpollack/export/believing.ps.gz\">machine-checked proofs</a> (it's a very relevant paper) and other stuff, that allows to focus and thus to simplify problems a lot (as Brouwer said: \"Mathematics is nothing more, nothing less, than the exact part of our thinking\"), but you can't expect any tool to make your thoughts \"right\", because there is just no uniform notion of rightness. IOW, there is no way to formally connect informal and formal: being informal is like being inside the <code>IO</code> monad \u2014 there is no escape.</p>\n\n<p>So it's not \"does this syntax reflects my very precise semantics?\", but rather \"can I attach my raw semantics to this strongly structured syntax?\". Programs are proper material objects, while ideas are cumbersome approximations, that can become proper material objects only by convention. So we form some basis using conventions, and then we just trust it, because it's much more sensible to trust to a small subset of all your numerous ideas than to all of them.</p>\n"}, {"tags": [], "owner": {"reputation": 4328, "user_id": 1473927, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AO6Ui.jpg?s=128&g=1", "display_name": "Jonathan Cast", "link": "https://stackoverflow.com/users/1473927/jonathan-cast"}, "is_accepted": false, "score": 6, "last_activity_date": 1444588761, "creation_date": 1444588761, "answer_id": 33068687, "question_id": 33065965, "link": "https://stackoverflow.com/questions/33065965/dependent-types-can-prove-your-code-is-correct-up-to-a-specification-but-how-do/33068687#33068687", "title": "Dependent types can prove your code is correct up to a specification. But how do you prove the specification is correct?", "body": "<p>How do you prove that math is correct?  That is, how do you prove that integer addition is the correct way to count apples, or how do you prove that real addition is the correct way to add weights?  There is always an interface between the formal / mathematical and the informal / real.  It requires skill and mathematical / physical taste to find the appropriate formalism for solving a particular problem.  Formal methods won't eliminate that.</p>\n\n<p>The value of formal methods is twofold:</p>\n\n<ol>\n<li><p>You're not going to know if your program is correct, unless you know what properties it actually satisfies.  Before you know if your sort routine is \"correct\", you first have to know what it actually does.  Any procedure for finding that out is going to be a formal method (even unit testing!), so people who reject \"formal methods\" are really just limiting themselves to a tiny subset of the available methods.</p></li>\n<li><p>Even when you know how to find out what a program actually does, people make mistakes in their mathematical reasoning (we are <em>not</em> rational creatures, whatever certain ideologies may claim); so it's helpful to have a machine check us.  This is the same reason we use unit tests --- it's nice to run a desk check and make sure the program does what we want; but having the computer do the check and tell us whether the result is correct helps prevent mistakes.  Letting the computer check our proofs about the behavior of the program is helpful for exactly the same reason.</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 7, "last_activity_date": 1444598430, "creation_date": 1444598430, "answer_id": 33070235, "question_id": 33065965, "link": "https://stackoverflow.com/questions/33065965/dependent-types-can-prove-your-code-is-correct-up-to-a-specification-but-how-do/33070235#33070235", "title": "Dependent types can prove your code is correct up to a specification. But how do you prove the specification is correct?", "body": "<p>One thing formal methods can do that I don't think others have touched on is help relate simple things to more complex ones. You may not know for sure how to specify exactly how a <code>Set</code> data structure should behave, but if you can write a simple version based on sorted lists, you can then prove that your fancy version based on balanced search trees relates to it correctly through the <code>toList</code> function. That is, you can use formal methods to transfer your confidence in sorted lists to balanced search trees.</p>\n"}, {"tags": [], "owner": {"reputation": 922, "user_id": 4094574, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4AcNf.png?s=128&g=1", "display_name": "Alexey Birukov", "link": "https://stackoverflow.com/users/4094574/alexey-birukov"}, "is_accepted": false, "score": 1, "last_activity_date": 1445169357, "creation_date": 1445169357, "answer_id": 33197663, "question_id": 33065965, "link": "https://stackoverflow.com/questions/33065965/dependent-types-can-prove-your-code-is-correct-up-to-a-specification-but-how-do/33197663#33197663", "title": "Dependent types can prove your code is correct up to a specification. But how do you prove the specification is correct?", "body": "<p>Suppose your function is not top level one, but used by somebody else as part of some module, which also has correctness proof. The latter must use correctness proof of your function, and if it is bad, module will not compile. The module itself still can have mistakes, but it is not problem of yours anymore.</p>\n"}, {"tags": [], "owner": {"reputation": 26618, "user_id": 1283394, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6d7d7689f9562293f6106353a6b1a905?s=128&d=identicon&r=PG", "display_name": "Stefan", "link": "https://stackoverflow.com/users/1283394/stefan"}, "is_accepted": false, "score": 2, "last_activity_date": 1490390702, "creation_date": 1490390702, "answer_id": 43009388, "question_id": 33065965, "link": "https://stackoverflow.com/questions/33065965/dependent-types-can-prove-your-code-is-correct-up-to-a-specification-but-how-do/43009388#43009388", "title": "Dependent types can prove your code is correct up to a specification. But how do you prove the specification is correct?", "body": "<p>Coming late to the party, but AFAICT, noone has yet mentioned another important aspect: in the context of program verification, having a bug in the spec is not always too terrible, because you can use the <em>code</em> to check the <em>spec</em>.</p>\n\n<p>IOW, the proof doesn't say \"the code is right\", but \"the code and the spec are mutually consistent\".  So, in order for a bug in the spec to go unnoticed, it has to be one of:</p>\n\n<ul>\n<li>an underspecified spec.</li>\n<li>a bug in the spec matched by a corresponding bug in the code.</li>\n</ul>\n\n<p>As someone else pointed out: the problem is the same for tests.</p>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2100, "favorite_count": 9, "accepted_answer_id": 33066217, "answer_count": 7, "score": 47, "last_activity_date": 1490390702, "creation_date": 1444572569, "last_edit_date": 1444573073, "question_id": 33065965, "link": "https://stackoverflow.com/questions/33065965/dependent-types-can-prove-your-code-is-correct-up-to-a-specification-but-how-do", "title": "Dependent types can prove your code is correct up to a specification. But how do you prove the specification is correct?", "body": "<p>Dependent types are often advertised as a way to enable you to assert that a program is correct up to a specification. So, for  example, you are asked to write a code that <strong>sorts a list</strong> - you are able to prove that code is correct by encoding the notion of \"sort\" as a type, and writing a function such as <code>List a -&gt; SortedList a</code>. But how do you prove that the specification, <code>SortedList</code>, is correct? Wouldn't it be the case that, the more complex your specification is, the more likely it would be that your encoding of that specification as a type is incorrect?</p>\n"}, {"tags": ["haskell", "category-theory", "type-theory"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1444568086, "post_id": 33065046, "comment_id": 53949179, "body": "Well, there&#39;s <a href=\"http://hackage.haskell.org/package/lens-4.13/docs/Control-Lens-Traversal.html#v:scanl1Of\" rel=\"nofollow noreferrer\"><code>scanl1Of</code></a>. With a suitable <code>Traversal</code> this might do the trick."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1444568125, "post_id": 33065046, "comment_id": 53949194, "body": "I&#39;m not sure whether this extended <code>scanl</code> should pass the same <code>init</code> to all children, as done above, or chain them as <code>fold</code> does."}, {"owner": {"reputation": 11986, "user_id": 3237465, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/vOArX.png?s=128&g=1", "display_name": "user3237465", "link": "https://stackoverflow.com/users/3237465/user3237465"}, "edited": false, "score": 2, "creation_date": 1444571516, "post_id": 33065046, "comment_id": 53950291, "body": "<b>chi</b>&#39;s <code>scanl</code> is <code>scan :: Traversable f =&gt; (b -&gt; a -&gt; b) -&gt; b -&gt; f a -&gt; f b; scan f z a = evalState (traverse (\\x -&gt; modify (flip f x) &gt;&gt; get) a) z</code>."}], "answers": [{"tags": [], "owner": {"reputation": 37486, "user_id": 371753, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/znFEK.jpg?s=128&g=1", "display_name": "sclv", "link": "https://stackoverflow.com/users/371753/sclv"}, "is_accepted": false, "score": 1, "last_activity_date": 1457074895, "creation_date": 1457074895, "answer_id": 35789924, "question_id": 33065046, "link": "https://stackoverflow.com/questions/33065046/is-this-a-meaningful-generalization-of-scans-for-arbitrary-adts/35789924#35789924", "title": "Is this a meaningful generalization of `scan`s for arbitrary ADTs?", "body": "<p>If you move to the fixpoint-of-functors \"generic\" representation of data, you can view a scan (or rather its slight generalization, a <code>mapAccum</code>) as a special type of generic fold.</p>\n\n<p>Here's some code that sketches a pattern that you should be able to continue:</p>\n\n<pre><code>data Fix f a = Roll (f a (Fix f a))\n\ncata :: Functor (f a) =&gt; (f a b -&gt; b) -&gt; Fix f a -&gt; b\ncata alg (Roll x) = alg $ fmap (cata alg) x\n\nscan :: Functor (f a) =&gt; (f a (acc, Fix f b) -&gt; (acc, f b (Fix f b))) -&gt; Fix f a -&gt; Fix f b\nscan alg = snd . cata (fmap Roll . alg)\n\ndata ListF a b = NilF | ConsF a b deriving Functor\n\nscanAlgList f z NilF = (z, NilF)\nscanAlgList f z (ConsF a (acc,b)) =\n            let val = f a acc\n            in (val, ConsF val b)\n\ndata TreeF a b = LeafF a | BranchF a b b deriving Functor\n\nscanAlgTree f (LeafF x) = (x, LeafF x)\nscanAlgTree f (BranchF v (accL,l) (accR,r)) =\n            let val = f v accL accR\n            in (val, BranchF v l r)\n</code></pre>\n\n<p>Gibbons discusses this in passing in his <a href=\"https://patternsinfp.wordpress.com/2011/05/05/horners-rule/\" rel=\"nofollow\">article</a> on Horners rule. He actually first described such things as \"downward accumulations\" in an <a href=\"https://researchspace.auckland.ac.nz/bitstream/handle/2292/3464/TR061.pdf?sequence=2\" rel=\"nofollow\">article from 1992</a> on \"Upwards and Downwards Accumulations on Trees\".</p>\n"}], "owner": {"reputation": 44680, "user_id": 1031791, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/fb710534fda446d2286074bb7692e65a?s=128&d=identicon&r=PG", "display_name": "MaiaVictor", "link": "https://stackoverflow.com/users/1031791/maiavictor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 2, "answer_count": 1, "score": 7, "last_activity_date": 1457074895, "creation_date": 1444567117, "last_edit_date": 1444568617, "question_id": 33065046, "link": "https://stackoverflow.com/questions/33065046/is-this-a-meaningful-generalization-of-scans-for-arbitrary-adts", "title": "Is this a meaningful generalization of `scan`s for arbitrary ADTs?", "body": "<p>I've been thinking how one could generalize <code>scanl</code> to arbitrary ADTs. The Prelude approach is just to treat everything as a list (i.e., <code>Foldable</code>) and apply the <code>scanl</code> on the flatened view of the structure. Instead, I tend to think of <code>scanl</code> as an operation that passes a state from each node of the tree to its children, while applying a monoidal op as it travels down from root to the leaves. So, for example, on <code>Data.Tree</code>, we have:</p>\n\n<pre><code>scan :: (b -&gt; a -&gt; b) -&gt; b -&gt; Tree a -&gt; Tree b\nscan fn init (Node element children) \n    = Node (fn init element) \n        $ map (treeScan fn (fn init element)) children\n</code></pre>\n\n<p>So that, for example:</p>\n\n<pre><code>main = do\n    prettyPrint $ scan (+) 0 $\n        Node 1 [\n            Node 1 [\n                Node 1 [], \n                Node 1 []],\n            Node 1 [\n                Node 1 [], \n                Node 1 []]]\n</code></pre>\n\n<p>Results in:</p>\n\n<pre><code>1\n|\n+- 2\n|  |\n|  +- 3\n|  |\n|  `- 3\n|\n`- 2\n   |\n   +- 3\n   |\n   `- 3\n</code></pre>\n\n<p>Which is the same as applying <code>scanl</code> through each path of the tree independently, preserving the original structure.</p>\n\n<p>The question is rather simple: is this a meaningful generalization? I.e., is it commonly used, with a categorical explanation, and perhaps with a different name?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 2, "creation_date": 1444560382, "post_id": 33064040, "comment_id": 53947038, "body": "You have to indent your program properly. Indentation in Haskell isn&#39;t optional."}, {"owner": {"reputation": 101, "user_id": 4911399, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jEpYo.jpg?s=128&g=1", "display_name": "Balkis", "link": "https://stackoverflow.com/users/4911399/balkis"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1444561243, "post_id": 33064040, "comment_id": 53947243, "body": "Thank you for help, i didn&#39;t know that before (now there is no error ^^ )"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 1, "creation_date": 1444768760, "post_id": 33064040, "comment_id": 54038644, "body": "@Abir, I don&#39;t mean to blow my own horn, but you should really accept an answer by clicking the tick underneath it if it satisfies your requirements."}], "answers": [{"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 3, "last_activity_date": 1444560521, "last_edit_date": 1495542594, "creation_date": 1444560521, "answer_id": 33064099, "question_id": 33064040, "link": "https://stackoverflow.com/questions/33064040/indentation-error-in-haskell/33064099#33064099", "title": "Indentation error in Haskell", "body": "<p>It's just formatting and indentation:</p>\n\n<pre><code>ha :: (Bool, Bool) -&gt; (Bool, Bool)\nha (n, m) = (n &amp;&amp; m, (n || m) &amp;&amp; not (n &amp;&amp; m)) \n\n\nfa :: (Bool, Bool, Bool) -&gt; (Bool, Bool)\nfa (a,b,r) = (c,s)\n  where\n    (y,x) = ha (a, b)\n    (z,s) = ha (x, r)\n    c     =  y || z \n</code></pre>\n\n<p>Apart from the pointless bracket's that I've removed, you need to indent your <code>where</code> clause further than the column that the <code>where</code> is written. This is called the offside rule, and is explained in <a href=\"https://stackoverflow.com/questions/2223468/haskell-where-indentation-why-must-it-be-indented-past-identifier\">this answer</a>.</p>\n\n<hr>\n\n<p>On a side-note, you're not writing idiomatic Haskell. We would usually write <code>ha</code> like so:</p>\n\n<pre><code>ha :: Bool -&gt; Bool -&gt; (Bool, Bool)\nha n m = (n &amp;&amp; m, (n || m) &amp;&amp; not (n &amp;&amp; m))\n</code></pre>\n\n<p>And <code>fa</code> like so:</p>\n\n<pre><code>fa :: Bool -&gt; Bool -&gt; Bool -&gt; (Bool, Bool)\nfa a b r = (c, s)\n  where\n    (y,x) = ha a b\n    (z,s) = ha x r\n    c     =  y || z \n</code></pre>\n"}], "owner": {"reputation": 101, "user_id": 4911399, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/jEpYo.jpg?s=128&g=1", "display_name": "Balkis", "link": "https://stackoverflow.com/users/4911399/balkis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "accepted_answer_id": 33064099, "answer_count": 1, "score": -1, "last_activity_date": 1444763792, "creation_date": 1444560072, "last_edit_date": 1444763792, "question_id": 33064040, "link": "https://stackoverflow.com/questions/33064040/indentation-error-in-haskell", "title": "Indentation error in Haskell", "body": "<p>i'm new with functionnal programing, so please if someone could tell me where am i wrong: in a file named add.hs i wrote :</p>\n\n<pre><code>ha :: (Bool,Bool) -&gt; (Bool,Bool)\nha (n,m) = ((n &amp;&amp; m),((n || m) &amp;&amp; not(n &amp;&amp; m))) \n\n\nfa :: (Bool,Bool,Bool) -&gt; (Bool,Bool)\nfa (a,b,r) = (c,s) where\n(y,x) = ha(a,b)\n(z,s) = ha(x,r)\nc =(y||z)\n</code></pre>\n\n<p>( I know that probably there is a more appropriate type than Bool, but I just wanted to test it )</p>\n\n<p>this what I get when I load the file:\n<a href=\"http://i.stack.imgur.com/m1ofK.png\" rel=\"nofollow\">outupt</a></p>\n"}, {"tags": ["haskell", "existential-type"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 3, "creation_date": 1444564160, "post_id": 33063853, "comment_id": 53948041, "body": "I think the reason why <code>exists a. D a</code> is not a part of Haskell is a simple desire to avoid redundancy. This type is equivalent to <code>forall r. (forall a. D a -&gt; r) -&gt; r</code>, so one can just as well use that to represent existential values."}, {"owner": {"reputation": 2110, "user_id": 424978, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bff8eb16ab33e8e44e3175bd54ecc0e?s=128&d=identicon&r=PG", "display_name": "narthi", "link": "https://stackoverflow.com/users/424978/narthi"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1444564557, "post_id": 33063853, "comment_id": 53948167, "body": "@n.m. while strictly speaking it&#39;s not equivalent, I agree that the only useful thing that can be done to such existential value is application of a function <code>forall a. D a -&gt; r</code>, so inability to express this ad-hoc existential makes sense -- thanks."}], "answers": [{"comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1444561785, "post_id": 33064175, "comment_id": 53947371, "body": "You don&#39;t have to circumvent the type system. Of course anything could happen if you do <code>unsafeCoerce</code>, but why do that?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1444562080, "post_id": 33064175, "comment_id": 53947448, "body": "@n.m. because the OP asked for it."}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 1, "creation_date": 1444562315, "post_id": 33064175, "comment_id": 53947522, "body": "I don&#39;t see where OP asks about <code>unsafeCoerce</code>."}, {"owner": {"reputation": 2110, "user_id": 424978, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bff8eb16ab33e8e44e3175bd54ecc0e?s=128&d=identicon&r=PG", "display_name": "narthi", "link": "https://stackoverflow.com/users/424978/narthi"}, "edited": false, "score": 0, "creation_date": 1444563399, "post_id": 33064175, "comment_id": 53947826, "body": "Indeed, that&#39;s not what I was after. I&#39;ve added a bit of clarification."}, {"owner": {"reputation": 2110, "user_id": 424978, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bff8eb16ab33e8e44e3175bd54ecc0e?s=128&d=identicon&r=PG", "display_name": "narthi", "link": "https://stackoverflow.com/users/424978/narthi"}, "edited": false, "score": 1, "creation_date": 1444563564, "post_id": 33064175, "comment_id": 53947861, "body": "&quot;there&#39;s nothing you can do with a value of unknown type.&quot; -- the type is not <i>completely</i> unknown, the compiler knows it&#39;s a <code>exists a. D a</code> so, as far as I understand, should be able to apply a function <code>forall a. (D a -&gt; E)</code>"}, {"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 4, "creation_date": 1444569250, "post_id": 33064175, "comment_id": 53949549, "body": "Please, never use <code>unsafeCoerce</code> when answering a Haskell question. It&#39;s not part of the language and should be avoided at almost any cost."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 1, "creation_date": 1444574962, "post_id": 33064175, "comment_id": 53951402, "body": "@augustss: that&#39;s why I said \u201cyou can <i>convince GHC</i>\u201d, and demonstrated how it completely fails to be a solution here. \u2014 But then again, I think <code>unsafeCoerce</code> can actually be reasonable in Haskell answers (unlike <code>unsafePerformIO</code>): when it&#39;s about something where GHC can&#39;t confirm two types are equal, but you can actually prove it."}, {"owner": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 4, "creation_date": 1444578611, "post_id": 33064175, "comment_id": 53952401, "body": "@leftroundabout I would never mention something as ugly and unsafe to someone who is obviously a beginner."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 22266, "user_id": 649287, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c0ea0055b84020bf860c05f53ba53d5?s=128&d=identicon&r=PG", "display_name": "augustss", "link": "https://stackoverflow.com/users/649287/augustss"}, "edited": false, "score": 0, "creation_date": 1472877396, "post_id": 33064175, "comment_id": 65940363, "body": "@augustss, <code>unsafeCoerce</code> is much less frightening than <code>unsafePerformIO</code>, IMO, and there&#39;s no other way to state useful postulates like <code>forall (a :: ()) . a :~: &#39;()</code>. Of course, you&#39;re right anyway."}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1498834029, "post_id": 33064175, "comment_id": 76679011, "body": "@dfeuer I mean they are equally frightening. If you have one you can define the other fairly easily: <code>unsafeCoerce a = let r = unsafePerformIO (newIORef undefined) in unsafePeformIO (writeIORef r a) `seq` unsafePerformIO (readIORef r)</code>, and <code>unsafePerformIO a = runST $ unsafeCoerce a</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "edited": false, "score": 1, "creation_date": 1498838941, "post_id": 33064175, "comment_id": 76682252, "body": "@semicolon, well, the latter does rely on GHC representing <code>IO</code> and <code>ST</code> the same under the hood, while the former seems more portable. But what I really meant was that I think it&#39;s generally easier to reason about the safety requirements of <i>typical uses</i> of <code>unsafeCoerce</code> than about <i>typical uses</i> of <code>unsafePerformIO</code>. Typically, <code>unsafeCoerce</code> is used either to shift between a typed representation and an untyped one (where the user knows they have to track the types themselves), to state a reasonable axiom, or to short-cut the proof of a theorem. (cont)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1498839302, "post_id": 33064175, "comment_id": 76682469, "body": "<code>unsafePerformIO</code> <i>can</i> be used in a manner easily seen to be safe to perform a conceptually pure action in an impure fashion. For example, <code>unsafePerformIO $ fmap f newStdGen</code>, where <code>f</code> is a Las Vegas algorithm,is obviously safe. However, <code>unsafePerformIO</code> is also often used to maintain hidden state; in that usage it is extremely easy to screw everything up."}, {"owner": {"reputation": 2313, "user_id": 1513295, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/bc00550a36e3d751bee5e0027f929cbf?s=128&d=identicon&r=PG", "display_name": "semicolon", "link": "https://stackoverflow.com/users/1513295/semicolon"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1498846392, "post_id": 33064175, "comment_id": 76685918, "body": "@dfeuer I mean if you are arguing about typical uses then honestly I would say I disagree. I&#39;d say they are pretty equally unsafe, because knowing what things are &quot;morally pure&quot; to me is no harder than knowing what things are &quot;truly bit-for-bit identical&quot;. Both can be violated in ways that you might not expect, for example making unique keys for separate values is often done by beginners with unsafePeformIO and is unsafe, and if <code>x</code> isn&#39;t monomorphic <code>x == unsafeCoerce x</code> might not even be safe (it might segfault)."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 7, "last_activity_date": 1444563812, "last_edit_date": 1444563812, "creation_date": 1444561082, "answer_id": 33064175, "question_id": 33063853, "link": "https://stackoverflow.com/questions/33063853/haskell-function-returning-existential-type/33064175#33064175", "title": "Haskell function returning existential type", "body": "<p>Yes, you can convince GHC that you do not care for the exact type with which <code>D</code> is parameterised. Just, it's a horrible idea.</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n\nimport Unsafe.Coerce\n\ndata D a = D a deriving (Show)\n\ndata Wrap where       -- this GADT is equivalent to your `ExistentialQuantification` version\n   Wrap :: D a -&gt; Wrap\n\nunwrap :: Wrap -&gt; D a\nunwrap (Wrap (D a)) = D (unsafeCoerce a)\n\nmain = print (unwrap (Wrap $ D \"bla\") :: D Integer)\n</code></pre>\n\n<p>This is what happens when I execute that simple program:</p>\n\n<p><a href=\"https://i.stack.imgur.com/t5fzJ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/t5fzJ.png\" alt=\"enter image description here\"></a></p>\n\n<p>and so on, until memory consumption brings down the system.</p>\n\n<p><strong>Types are important!</strong> If you circumvent the type system, you circumvent any predictability of your program (i.e. anything can happen, including <a href=\"http://hackage.haskell.org/package/acme-missiles/docs/Acme-Missiles.html#v:launchMissiles\" rel=\"nofollow noreferrer\">thermonuclear war</a> or the famous <a href=\"http://www.catb.org/jargon/html/N/nasal-demons.html\" rel=\"nofollow noreferrer\">demons flying out of your nose</a>).</p>\n\n<hr>\n\n<p>Now, evidently you thought that types somehow work differently. In dynamic languages such as Python, and also to a degree in OO languages like Java, a type is in a sense a <em>property</em> that a value can have. So, (reference-) values don't just carry around the information needed to distinguish different values <em>of a single type</em>, but also information to distinguish different (sub-)types. That's in many senses rather inefficient &ndash; it's a major reason why Python is so slow and Java needs such a huge VM.</p>\n\n<p>In Haskell, types <em>don't exist</em> at runtime. A function never knows what type the values have it's working with. Only because the <em>compiler</em> knows all about the types it will have, the function doesn't <em>need</em> any such knowledge &ndash; the compiler has already hard-coded it! (That is, unless you circumvent it with <code>unsafeCoerce</code>, which as I demonstrated is as unsafe as it sounds.)</p>\n\n<p>If you do want to attach the type as a &ldquo;property&rdquo; to a value, you need to do it explicitly, and that's what those existential wrappers are there for. However, there are usually better ways to do it in a functional language. What's really the application you wanted this for?</p>\n\n<hr>\n\n<p>Perhaps it's also helpful to recall what a signature with polymorphic result means. <code>unwrap :: Wrap -&gt; D a</code> doesn't mean &ldquo;the result is some <code>D a</code>... and the caller better don't care for the <code>a</code> used&rdquo;. That would be the case in Java, but it would be rather useless in Haskell because there's nothing you can do with a value of unknown type.</p>\n\n<p>Instead it means: <em>for whatever</em> type <code>a</code> the caller requests, this function is able to supply a suitable <code>D a</code> value. Of course this is tough to deliver &ndash; without extra information it's just as impossible as doing anything with a value of given unknown type. But if there are already <code>a</code> values in the <em>arguments</em>, or <code>a</code> is somehow constrained to a type class (e.g. <code>fromInteger :: Num a =&gt; Integer -&gt; a</code>, then it's quite possible and very useful.</p>\n\n<hr>\n\n<p>To obtain a <code>String</code> field &ndash; independent of the <code>a</code> parameter &ndash; you can just operate directly on the wrapped value:</p>\n\n<pre><code>data D a = D\n    { dLabel :: String\n    , dValue :: a\n    }\n\ndata Wrap where Wrap :: D a -&gt; Wrap\n\nlabelFromWrap :: Wrap -&gt; String\nlabelFromWrap (Wrap (D l _)) = l\n</code></pre>\n\n<p>To write such functions on <code>Wrap</code> more generically (with any &ldquo; label accesor that doesn't care about <code>a</code>&rdquo;), use Rank2-polymorphism as shown in n.m.'s answer.</p>\n"}, {"tags": [], "owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "is_accepted": true, "score": 13, "last_activity_date": 1472871987, "last_edit_date": 1472871987, "creation_date": 1444562949, "answer_id": 33064451, "question_id": 33063853, "link": "https://stackoverflow.com/questions/33063853/haskell-function-returning-existential-type/33064451#33064451", "title": "Haskell function returning existential type", "body": "<p>Yes, you can, but not in a straightforward way.</p>\n\n<pre><code>{-# LANGUAGE ExistentialQuantification #-}\n{-# LANGUAGE RankNTypes #-}\n\ndata D a = D a\n\ndata Wrap = forall a. Wrap (D a)\n\nunwrap :: Wrap -&gt; forall r. (forall a. D a -&gt; r) -&gt; r\nunwrap (Wrap x) k = k x\n\ntest :: D a -&gt; IO ()\ntest (D a) = putStrLn \"Got a D something\"\n\nmain = unwrap (Wrap (D 5)) test\n</code></pre>\n\n<p>You cannot return a <code>D something_unknown</code> from your function, but you can extract it and immediately pass it to another function that accepts <code>D a</code>, as shown. &nbsp;</p>\n"}], "owner": {"reputation": 2110, "user_id": 424978, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/9bff8eb16ab33e8e44e3175bd54ecc0e?s=128&d=identicon&r=PG", "display_name": "narthi", "link": "https://stackoverflow.com/users/424978/narthi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 600, "favorite_count": 6, "accepted_answer_id": 33064451, "answer_count": 2, "score": 9, "last_activity_date": 1472871987, "creation_date": 1444558553, "last_edit_date": 1444632210, "question_id": 33063853, "link": "https://stackoverflow.com/questions/33063853/haskell-function-returning-existential-type", "title": "Haskell function returning existential type", "body": "<p>Is it possible to write a Haskell function that yields a parameterised type where the exact type parameter is hidden? I.e. something like <code>f :: T -&gt; (exists a. U a)</code>? The obvious attempt:</p>\n\n<pre><code>{-# LANGUAGE ExistentialQuantification #-}\n\ndata D a = D a\n\ndata Wrap = forall a. Wrap (D a)\n\nunwrap :: Wrap -&gt; D a\nunwrap (Wrap d) = d\n</code></pre>\n\n<p>fails to compile with:</p>\n\n<pre><code>Couldn't match type `a1' with `a'\n  `a1' is a rigid type variable bound by\n       a pattern with constructor\n         Wrap :: forall a. D a -&gt; Wrap,\n       in an equation for `unwrap'\n       at test.hs:8:9\n  `a' is a rigid type variable bound by\n      the type signature for unwrap :: Wrap -&gt; D a at test.hs:7:11\nExpected type: D a\n  Actual type: D a1\nIn the expression: d\nIn an equation for `unwrap': unwrap (Wrap d) = d\n</code></pre>\n\n<p>I know this is a contrived example, but I'm curious if there is a way to convince GHC that I do not care for the exact type with which <code>D</code> is parameterised, without introducing another existential wrapper type for the result of <code>unwrap</code>.</p>\n\n<p>To clarify, I do want type safety, but also would like to be able to apply a function <code>dToString :: D a -&gt; String</code> that does not care about <code>a</code> (e.g. because it just extracts a String field from <code>D</code>) to the result of <code>unwrap</code>. I realise there are other ways of achieving it (e.g. defining <code>wrapToString (Wrap d) = dToString d</code>) but I'm more interested in whether there is a fundamental reason why such hiding under existential is not permitted.</p>\n"}, {"tags": ["haskell", "quickcheck"], "comments": [{"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 1, "creation_date": 1444558646, "post_id": 33063730, "comment_id": 53946632, "body": "you already have this in <code>quickcheck</code>: <a href=\"https://hackage.haskell.org/package/QuickCheck-2.8.1/docs/Test-QuickCheck-Modifiers.html#v:Positive\" rel=\"nofollow noreferrer\">Positive</a> ... of course you should use it like this: <code>prop :: Positive -&gt; Bool</code> and then <code>prop (Positive n) = ...</code> (deconstruct it with patternmatching to get out the number itself!) - or use <code>getPositive</code> inside your property to get the number"}, {"owner": {"reputation": 79, "user_id": 2032169, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2f06307d81831517af6fd445074eb4d5?s=128&d=identicon&r=PG", "display_name": "Phaeton", "link": "https://stackoverflow.com/users/2032169/phaeton"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1444582833, "post_id": 33063730, "comment_id": 53953694, "body": "@carsten thanks i made it work using the tips you gave me."}], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 2032169, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2f06307d81831517af6fd445074eb4d5?s=128&d=identicon&r=PG", "display_name": "Phaeton", "link": "https://stackoverflow.com/users/2032169/phaeton"}, "edited": false, "score": 0, "creation_date": 1444583102, "post_id": 33065695, "comment_id": 53953778, "body": "thanks I did change the Gen Integer to Gen Positives but did not realize i had to change x as well.  I dropped the idea of using my own gen and thanks to the tips from @Carsten got it to work."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 3, "last_activity_date": 1444571053, "creation_date": 1444571053, "answer_id": 33065695, "question_id": 33063730, "link": "https://stackoverflow.com/questions/33063730/compare-two-functions-using-quickcheck-to-generate-positive-integers/33065695#33065695", "title": "Compare two functions using quickcheck to generate positive integers", "body": "<p>The problem with your code is that in <code>positives</code> the variable <code>x</code> has type <code>Integer</code>, so your return statements need to include the <code>Positives</code> constructor:</p>\n\n<pre><code>positives :: Gen Positives\npositives =\n   do -- Pick an arbitrary integer:\n     x &lt;- arbitrary\n     if (x == 0)\n       then return $ Positives 1\n     else if (x &lt; 0)\n       then return $ Positives (-x)\n     else\n       return $ Positives x\n</code></pre>\n\n<p>If it helps, here is another way to write (a similarly working) <code>positives</code> function:</p>\n\n<pre><code>positives' :: Gen Positives\npositives' = fmap (\\x -&gt; Positives (1 + abs x)) arbitrary\n</code></pre>\n\n<p>Here the <code>arbitrary</code> call is a <code>Gen Integer</code>, so the function argument to <code>fmap</code> has type <code>Integer -&gt; Positives</code>.</p>\n\n<p>To use your <code>Positives</code> newtype with QuickCheck you would use the <code>Positives</code> (de-)constructor to get at the Integer values:</p>\n\n<pre><code>prop_addition :: Positives -&gt; Positives -&gt; Bool\nprop_addition (Positives a) (Positives b) = a + b &gt;= 2\n\nghci&gt; quickCheck prop_addtion\n</code></pre>\n\n<p>As @Carsten mentions in the comments, QuickCheck as a <code>Positive a</code> type which has an arbitrary instance for numeric and ordered types <em>a</em>.</p>\n"}, {"tags": [], "owner": {"reputation": 798, "user_id": 893982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/997fe670bc45cb9f3898acf9eb18ab03?s=128&d=identicon&r=PG", "display_name": "George Co", "link": "https://stackoverflow.com/users/893982/george-co"}, "is_accepted": false, "score": 0, "last_activity_date": 1550626991, "last_edit_date": 1550626991, "creation_date": 1550626577, "answer_id": 54777529, "question_id": 33063730, "link": "https://stackoverflow.com/questions/33063730/compare-two-functions-using-quickcheck-to-generate-positive-integers/54777529#54777529", "title": "Compare two functions using quickcheck to generate positive integers", "body": "<p>Here's a quick way that doesn't require much understanding of QuickCheck but is a bit of a hack:</p>\n\n<pre><code>prop_CompareAnswerExMFM :: Integer -&gt; Integer -&gt; Integer -&gt; Bool\nprop_CompareAnswerExMFM b e m =\n   exMFM absB absE absM == exM absB absE absM\n   where -- following guarantees args are positive integers &gt; 0\n      absB = 1 + abs b\n      absE = 1 + abs e\n      absM = 1 + abs m\n</code></pre>\n\n<p>and then you can just use</p>\n\n<pre><code>quickCheck prop_factored\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 2032169, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2f06307d81831517af6fd445074eb4d5?s=128&d=identicon&r=PG", "display_name": "Phaeton", "link": "https://stackoverflow.com/users/2032169/phaeton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 556, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1550626991, "creation_date": 1444557562, "question_id": 33063730, "link": "https://stackoverflow.com/questions/33063730/compare-two-functions-using-quickcheck-to-generate-positive-integers", "title": "Compare two functions using quickcheck to generate positive integers", "body": "<p>I have the following Haskell functions:</p>\n\n<pre><code>  expM ::  Integer -&gt; Integer -&gt; Integer -&gt; Integer\n  expM x y = rem (x^y)\n</code></pre>\n\n<p>And</p>\n\n<pre><code>  exMME :: Integer -&gt; Integer -&gt; Integer -&gt; Integer\n  exMME b 0 m = 1\n  exMME b e m = exMME' b e m 1 0 where    \n    exMME' b e m c e'        \n      | e' &lt; e = exMME' b e m ((b * c) `mod` m) (e'+1)\n      | otherwise = c\n</code></pre>\n\n<p>What I want to do is use quickCheck to compare these two functions so i can see that they produce the same answer and which one is the fastest.</p>\n\n<p>To test if they have the same answers I want to let QuickCheck create random positive integers with the exception of 0. So I created a Gen:</p>\n\n<pre><code>positives :: Gen Integer\n  positives = \n    do -- Pick an arbitrary integer:\n      x &lt;- arbitrary    \n      if (x == 0) \n        then return 1\n      else if (x &lt; 0)\n        then return (-x)\n      else \n        return x\n</code></pre>\n\n<p>This works from the command line (ghci) but I have a prop:</p>\n\n<pre><code>  prop_CompareAnswerExMFM :: Integer -&gt; Integer -&gt; Integer -&gt; Bool\n  prop_CompareAnswerExMFM b e m =exMFM b e m == exM b e m\n</code></pre>\n\n<p>And each time i call this with QuickCheck prop_CompareAnswerExMFM it doesn't us my gen. After reading some stuff i toughed that i needed to define a instance:</p>\n\n<pre><code>  instance Arbitrary Integer where\n    arbitrary = positives\n</code></pre>\n\n<p>This doesn't work because a arbitrary instance of Integer already exist. Again after some googling I say that the standard way to solve this is to use a wrapper: </p>\n\n<pre><code>  newtype Positives = Positives Integer\n    deriving (Eq, Ord, Show)\n\n  instance Arbitrary Positives where\n    arbitrary = positives\n\n  positives :: Gen Positives\n  positives = \n    do -- Pick an arbitrary integer:\n      x &lt;- arbitrary    \n      if (x == 0) \n        then return 1\n      else if (x &lt; 0)\n        then return (-x)\n      else \n        return x\n</code></pre>\n\n<p>But after playing around i keep getting errors like can't resolve this, No instance for (Num Positives) arising from the literal '0' or Can't make a derived instance of 'Num Positives'.</p>\n\n<p>I think i'm making it way to complex for what i want but I just can't figure it out. I hope someone can help me or send me in the right direction.</p>\n\n<p>Thanks </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 1747, "user_id": 1971462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qCUpC.jpg?s=128&g=1", "display_name": "Michael Rawson", "link": "https://stackoverflow.com/users/1971462/michael-rawson"}, "edited": false, "score": 0, "creation_date": 1444551524, "post_id": 33062813, "comment_id": 53944963, "body": "...<code>j</code> will never be 0 if it starts at 0.5, as it always decreases by 1 in the translated recurrence relation (so it will be 0.5 -&gt; -0.5 -&gt; -1.5...). I think <code>u</code> is supposed to be indexed by the natural numbers, not the real numbers?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1444551819, "post_id": 33062813, "comment_id": 53945034, "body": "Pattern matching in floating point is bogus. You probably just shouldn&#39;t do that."}, {"owner": {"reputation": 30761, "user_id": 779200, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5b39b49e078967924f816af14a536994?s=128&d=identicon&r=PG", "display_name": "lvc", "link": "https://stackoverflow.com/users/779200/lvc"}, "reply_to_user": {"reputation": 1747, "user_id": 1971462, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/qCUpC.jpg?s=128&g=1", "display_name": "Michael Rawson", "link": "https://stackoverflow.com/users/1971462/michael-rawson"}, "edited": false, "score": 0, "creation_date": 1444552993, "post_id": 33062813, "comment_id": 53945281, "body": "@Michael that was a mistake as you suspect. <code>u_ij</code> in the recurrence is defined as <code>u(i*h, j*k)</code>, so that i and j are integers, but u is defined for real x and t. I&#39;ve fixed that and updated the code in the question, but it shows the same problem."}, {"owner": {"reputation": 30761, "user_id": 779200, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5b39b49e078967924f816af14a536994?s=128&d=identicon&r=PG", "display_name": "lvc", "link": "https://stackoverflow.com/users/779200/lvc"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444553488, "post_id": 33062813, "comment_id": 53945402, "body": "@dfeuer I thought that might be the case, but what can I do instead?"}, {"owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1444554138, "post_id": 33062813, "comment_id": 53945544, "body": "@lvc nobody forces you do use pattern matching everywhere - you can do the same as you used to: don match on the second parameter but use it to calculate you difference to epsilon and then use <code>if ... then ... else ...</code> ;) (you could use guards too - but IMO you should start by getting the algorithm to work before you get fancy if you just started with the language - focus on one thing: the lang. or the algorithm first)"}, {"owner": {"reputation": 30761, "user_id": 779200, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5b39b49e078967924f816af14a536994?s=128&d=identicon&r=PG", "display_name": "lvc", "link": "https://stackoverflow.com/users/779200/lvc"}, "reply_to_user": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "edited": false, "score": 0, "creation_date": 1444557389, "post_id": 33062813, "comment_id": 53946326, "body": "@Carsten guards did the trick; thanks for the pointer. It honestly never occurred to me to use an <code>if</code> statement (or even look into whether Haskell has them); I looked into Haskell for this problem exactly because of how directly the algebra translates into code."}], "answers": [{"tags": [], "owner": {"reputation": 30761, "user_id": 779200, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5b39b49e078967924f816af14a536994?s=128&d=identicon&r=PG", "display_name": "lvc", "link": "https://stackoverflow.com/users/779200/lvc"}, "is_accepted": true, "score": 4, "last_activity_date": 1444556785, "creation_date": 1444556785, "answer_id": 33063619, "question_id": 33062813, "link": "https://stackoverflow.com/questions/33062813/pattern-matching-and-floating-point-representation/33063619#33063619", "title": "Pattern matching and floating point representation", "body": "<p>It turns out the solution was to read a little further into the tutorial and use <em>guards</em> instead of pattern matching; they make checking against an epsilon quite trivial:</p>\n\n<pre><code>u :: (Floating a, Ord a) =&gt; a -&gt; a -&gt; a\nu x t \n    | abs t &lt;= 0.1 = x*x\n    | otherwise =  a*k / b*h * (u (x-h) (t-k))\n                   + (1 - (3*k/2*h))*(u x (t-k))\n                   + k/b * cos x\n      where\n          a = 3\n          b = 2\n          k = 0.1\n          h = 0.2\n\nmain = putStrLn (show (u 1 0.5))\n</code></pre>\n\n<p>Gives an answer very quickly.</p>\n"}], "owner": {"reputation": 30761, "user_id": 779200, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/5b39b49e078967924f816af14a536994?s=128&d=identicon&r=PG", "display_name": "lvc", "link": "https://stackoverflow.com/users/779200/lvc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 33063619, "answer_count": 1, "score": 5, "last_activity_date": 1444556785, "creation_date": 1444550766, "last_edit_date": 1444553437, "question_id": 33062813, "link": "https://stackoverflow.com/questions/33062813/pattern-matching-and-floating-point-representation", "title": "Pattern matching and floating point representation", "body": "<p>I'm doing a problem involving using numeric methods to solve a differential equation, and thought this might be a good opportunity to learn some basic Haskell. I have the following recurrence relation:</p>\n\n<p><a href=\"https://i.stack.imgur.com/FAmd1.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/FAmd1.png\" alt=\"recurrence relation\"></a></p>\n\n<p>and the initial condition <code>u(x, 0) = x^2</code>. I translated these into Haskell like so (putting in appropriate values for a,b,c,h and k from the specific problem, and noting that u_ij is defined as <code>u(i*h, j*k)</code>):</p>\n\n<pre><code>u :: (Floating a, Eq a) =&gt; a -&gt; a -&gt; a\nu x 0 = x*x\nu x t = a*k / b*h * (u (x-h) (t-k)) \n      + (1 - (3*k/2*h))*(u x (t-k)) \n      + k/b * cos x\n    where \n        a = 3\n        b = 2\n        k = 0.1\n        h = 0.2\n\nmain = putStrLn (show (u 1 0.5))\n</code></pre>\n\n<p>This appears to run indefinitely. My best guess as to why is that floating point representation means the <code>u x 0</code> pattern never actually matches. The way I'm used to dealing with this in other languages is to check if the absolute difference between the values is within some suitable epsilon, but this doesn't appear to be available for pattern matching. So it seems that floating point and pattern matching are fundamentally incompatible. Is this the likely problem, and if so, is there a canonical way to avoid one or the other in a situation like this?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1444558185, "post_id": 33061444, "comment_id": 53946530, "body": "When reading Haskell code for a function, I&#39;d strongly recommend you start from its type. Knowing, for instance, the types of the arguments of <code>map</code> can greatly help understanding. Even if the type can be automatically inferred by the compiler, most programmers still make it explicit in the code."}], "answers": [{"tags": [], "owner": {"reputation": 3644, "user_id": 1465116, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/1987d0ba73cb23a47a25dbfe0b36106e?s=128&d=identicon&r=PG", "display_name": "Athan Clark", "link": "https://stackoverflow.com/users/1465116/athan-clark"}, "is_accepted": false, "score": 2, "last_activity_date": 1444537197, "creation_date": 1444537197, "answer_id": 33061471, "question_id": 33061444, "link": "https://stackoverflow.com/questions/33061444/haskell-explanation-of-function-syntax/33061471#33061471", "title": "Haskell: Explanation of function syntax", "body": "<p>In your <code>map</code> definition, <code>f</code> is the first argument you're supplying to it. Your first pattern match could also be defined with a lambda to denote <em>where</em> the parameter is coming from:</p>\n\n<pre><code>map f [] = -- ...\nmap \\f -&gt; \\[] -&gt; -- ...\n</code></pre>\n\n<p>In the second definition, you're recursing down the contents of the <code>(:)</code> pattern match:</p>\n\n<pre><code>map f (x:xs) = (f x) : (map f xs)\n</code></pre>\n\n<p>I'm applying <code>f</code> to the first element we see <code>x</code>, then <em>prepending</em> that result to the recursed call of <code>map</code> through the rest of <code>xs</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 489, "user_id": 3457759, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/dbc9ffc952d1b9de0db160785e7377e0?s=128&d=identicon&r=PG&f=1", "display_name": "Miguelme", "link": "https://stackoverflow.com/users/3457759/miguelme"}, "is_accepted": true, "score": 5, "last_activity_date": 1444540200, "creation_date": 1444540200, "answer_id": 33061776, "question_id": 33061444, "link": "https://stackoverflow.com/questions/33061444/haskell-explanation-of-function-syntax/33061776#33061776", "title": "Haskell: Explanation of function syntax", "body": "<p>f is a function that is a parameter of the map function since map has the following type:</p>\n\n<pre><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]\n</code></pre>\n\n<p>That it is, a function from a to b and a list of elements of type a and then using the function passed as the first parameter to convert the list (passed as second parameter) in a list of element of type b by using the function (passed as first parameter)</p>\n\n<p>This function is very useful for traversing a list applying a function.</p>\n\n<p>Let's say I have a list of numbers </p>\n\n<p>For example:</p>\n\n<pre><code>[2,3,4,5] \n</code></pre>\n\n<p>If i want to add 1 to each element of the list I could use map as following:</p>\n\n<pre><code>map (+1) [2,3,4,5]\n</code></pre>\n\n<p>Or if you prefer the lambda use:</p>\n\n<pre><code>map (\\x -&gt; x+1) [2,3,4,5]\n</code></pre>\n\n<p>And we'll get as an answer:</p>\n\n<pre><code>[3,4,5,6]\n</code></pre>\n\n<p>So in the implementation of map </p>\n\n<pre><code>map f [] = []\nmap f (a:b) = f a:map f b\n</code></pre>\n\n<p>We can see that the f is this function that is used to transform the list by applying it to each element of the list </p>\n\n<p>The implementation is recursive goes until the end of the list converting element by element and appending them to the list so the list has the same order as before the function was applied.</p>\n"}], "owner": {"reputation": 1895, "user_id": 3621754, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/2dc5c4eed3ed0e149b0bd6783a07fe0b?s=128&d=identicon&r=PG&f=1", "display_name": "sanic", "link": "https://stackoverflow.com/users/3621754/sanic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 33061776, "answer_count": 2, "score": 0, "last_activity_date": 1444540200, "creation_date": 1444536823, "last_edit_date": 1444536990, "question_id": 33061444, "link": "https://stackoverflow.com/questions/33061444/haskell-explanation-of-function-syntax", "title": "Haskell: Explanation of function syntax", "body": "<p>In this custom made version of the map function, there is an \"f\" is a few spots. I'm not sure what the f means in the function (I'm a beginner in Haskell). Is it something to do with higher order functions? Can someone explain what f means and then explain what the actual function is doing to create the map functionality?</p>\n\n<pre><code>map f [] = []\nmap f (a:b) = f a:map f b\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 2, "creation_date": 1444529668, "post_id": 33060779, "comment_id": 53941383, "body": "Have you tried it? <code>sum</code> is a little weird, but imagine defining <code>sum&#39; = foldl&#39; (+) 0</code>. Can you see why that won&#39;t run out of memory?"}, {"owner": {"reputation": 3024, "user_id": 3154996, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2031da3bb3fc999ec22e677995debd7b?s=128&d=identicon&r=PG&f=1", "display_name": "Elliot Gorokhovsky", "link": "https://stackoverflow.com/users/3154996/elliot-gorokhovsky"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444530185, "post_id": 33060779, "comment_id": 53941468, "body": "@dfeuer I&#39;m a complete noob, you&#39;re going to have to explain :)."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444537920, "post_id": 33060779, "comment_id": 53942574, "body": "The reason that <code>sum</code> does not run out of memory is complicated--it depends on compiler optimizations. But you can write your own version of <code>sum</code> that is easily seen to be space-safe."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1444540895, "post_id": 33060779, "comment_id": 53943041, "body": "When you say, &quot;lazy evaluation can make things like this more efficient&quot;, what does &quot;more efficient&quot; mean? More efficient than what, exactly? What are you hoping will happen that means you can compute a sum without computing all the numbers that go into the sum? (There <i>are</i> cases where that can make sense -- but I want to make sure to answer the question you&#39;re actually asking, and it&#39;s not clear at the moment exactly what you&#39;re asking about.)"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1444541760, "post_id": 33060779, "comment_id": 53943191, "body": "Search for &quot;list fusion&quot;. It&#39;s a general technique that allows to completely remove all intermediate lists from that kind of computation, effectively turning the functional code into imperative for loops. See: <a href=\"https://wiki.haskell.org/GHC_optimisations#Fusion\" rel=\"nofollow noreferrer\">wiki.haskell.org/GHC_optimisations#Fusion</a>   and   the paper <i>Stream Fusion: From Lists to Streams to Nothing at All, Coutts, Leshchinskiy and Stewart, 2007</i>.  But this kind of approach is a bit limited. It works fine when you use functions defined in terms of <code>fold</code>s and built-in functions, but will fail when you use recursive definitions."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1444542174, "post_id": 33060779, "comment_id": 53943258, "body": "@Bakuriu, at this level, I think it means &quot;won&#39;t blow the cache if the list is long, and won&#39;t blow the heap if it&#39;s longer&quot;."}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1444543866, "last_edit_date": 1444543866, "creation_date": 1444542092, "answer_id": 33061943, "question_id": 33060779, "link": "https://stackoverflow.com/questions/33060779/memory-use-when-replacing-for-loops-with-list-comprehensions-in-haskell/33061943#33061943", "title": "Memory use when replacing for loops with list comprehensions in Haskell", "body": "<p>As I mentioned in my comment, the reason <code>sum</code> tends not to run programs out of memory is complicated, and relies on compiler trickery. Therefore, I'll answer your question based on a let's-pretend world where <code>sum</code> is defined differently. GHC tries very hard to turn the real version into something more like the let's-pretend version whenever it can, so this is not too far from the truth. Let's pretend:</p>\n\n<pre><code>sum :: Num a =&gt; [a] -&gt; a\nsum xs = sumWith 0 xs\n\nsumWith :: Num a =&gt; a -&gt; [a] -&gt; a\nsumWith acc [] = acc\nsumWith acc (x : xs) =\n  let acc' = acc + x\n  in acc' `seq` sumWith acc' xs\n</code></pre>\n\n<p>The detailed mechanics of <code>[x | x &lt;- [1..n], p x]</code> are also a bit complicated, but you seem to be okay with the assumption that its elements are generated lazily, which is about all you need to know to consider the sum. For simplicity's sake, let's drop the predicate and just consider <code>sum [1..3]</code>:</p>\n\n<pre><code>sum [1..3]\n==&gt;\nsumWith 0 [1..3]\n==&gt;  -- pattern match on [1..3], forcing the first `(:)` constructor\nlet acc' = 0 + 1\nin acc' `seq` sumWith acc' [2..3]\n==&gt; -- forcing acc' `seq` ... forces acc'\nsumWith 1 [2..3]\n==&gt; -- pattern match on the list\nlet acc' = 1 + 2\nin acc' `seq` sumWith acc' [3..3]\n==&gt; force acc'\nsumWith 3 [3..3]\n==&gt;\nlet acc' = 3 + 3\nin acc' `seq` sumWith acc' []\n==&gt;\nsumWith 6 []\n==&gt;\n6\n</code></pre>\n\n<p>As you can see, the <code>seq</code> forces the term to collapse down to its original size each time we take a step, so we operate in constant memory. In fact, GHC can do even better&mdash;various optimizations can often lead to this allocating no memory at all and operating entirely in CPU registers.</p>\n\n<h3>The real <code>sum</code></h3>\n\n<p>The real <code>sum</code> is peculiar; I'd call it a historical artifact. It is <em>missing</em> the critical <code>seq</code>, so its definition is roughly equivalent to</p>\n\n<pre><code>sum :: Nom a =&gt; [a] -&gt; a\nsum xs = sumWith 0 xs\n\nsumWith :: Num a =&gt; a -&gt; [a] -&gt; a\nsumWith acc [] = acc\nsumWith acc (x : xs) = sumWith (acc + x) xs\n</code></pre>\n\n<p>If you go through this step by step like I did above, you'll see that it <em>doesn't</em> operate in constant space, because the accumulator term will keep growing. It starts at <code>0</code>, then goes to <code>0 + 1</code>, then <code>0 + 1 + 2</code>, then <code>0 + 1 + 2 + 3</code>. Whoops! Fortunately, GHC can generally patch this problem up. It uses something called \"demand analysis\", a variety of \"strictness analysis\", to figure out that it can force the accumulator on each step without changing the meaning of the program. So it does that, and everything generally works out okay.</p>\n\n<h3>The <em>real</em> real <code>sum</code></h3>\n\n<p>I've still been lying a bit, because the <em>real</em> <code>sum</code> is actually defined, these days, for all <code>Foldable</code> containers, and its definition for lists is really</p>\n\n<pre><code>sum = foldl (+) 0\n</code></pre>\n\n<p><code>foldl</code>, in turn, is actually defined (for lists) as</p>\n\n<pre><code>foldl :: forall a b. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b\nfoldl k z0 xs =\n  foldr (\\(v::a) (fn::b-&gt;b) -&gt; oneShot (\\(z::b) -&gt; fn (k z v))) (id :: b -&gt; b) xs z0\n</code></pre>\n\n<p>Whaaaaat? Well, that <code>oneShot</code> is a bit of primitive magic to guide the optimizer. We can take it out and simplify things a bit:</p>\n\n<pre><code>foldl :: (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b\nfoldl k z0 xs = foldr (\\v fn z -&gt; fn (k z v)) id xs z0\n</code></pre>\n\n<p>I'm not going to go into detail here about how this \"<code>foldl</code> as <code>foldr</code>\" definition works&mdash;you can find various explanations around. But this strange definition is tied up with the list fusion magic Bakuriu mentioned in a comment. In particular, <code>foldr</code> combines nicely with lots of things by way of compiler rewrite rules in the list library.</p>\n"}], "owner": {"reputation": 3024, "user_id": 3154996, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2031da3bb3fc999ec22e677995debd7b?s=128&d=identicon&r=PG&f=1", "display_name": "Elliot Gorokhovsky", "link": "https://stackoverflow.com/users/3154996/elliot-gorokhovsky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444543866, "creation_date": 1444528208, "question_id": 33060779, "link": "https://stackoverflow.com/questions/33060779/memory-use-when-replacing-for-loops-with-list-comprehensions-in-haskell", "title": "Memory use when replacing for loops with list comprehensions in Haskell", "body": "<p>Often in Haskell, one writes code like <code>sum [x|x&lt;-[1..n],x satisfies some predicate]</code>. I understand that lazy evaluation can make things like this more efficient, for example the <code>and</code> function will stop evaluating a list as soon as it sees a single <code>false</code>. So will Haskell evaluate the entire list in the first case I mentioned, wasting tons of memory, or will lazy evaluation somehow make it as efficient as a tail-recursive or iterative approach?</p>\n"}, {"tags": ["haskell", "error-handling"], "comments": [{"owner": {"reputation": 61029, "user_id": 625914, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f1932d8bf4e9dbf779a48b41bbf21592?s=128&d=identicon&r=PG", "display_name": "behzad.nouri", "link": "https://stackoverflow.com/users/625914/behzad-nouri"}, "edited": false, "score": 0, "creation_date": 1444528034, "post_id": 33060716, "comment_id": 53941191, "body": "there are like 8 ways to that: <a href=\"http://www.randomhacks.net/2007/03/10/haskell-8-ways-to-report-errors/\" rel=\"nofollow noreferrer\">randomhacks.net/2007/03/10/haskell-8-ways-to-report-errors</a>   and <a href=\"http://blog.ezyang.com/2011/08/8-ways-to-report-errors-in-haskell-revisited/\" rel=\"nofollow noreferrer\">blog.ezyang.com/2011/08/&hellip;</a>"}, {"owner": {"reputation": 84731, "user_id": 510937, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/70b13a9ae1aae1ca1aa6ac8dab4643f2?s=128&d=identicon&r=PG", "display_name": "Bakuriu", "link": "https://stackoverflow.com/users/510937/bakuriu"}, "edited": false, "score": 0, "creation_date": 1444542956, "post_id": 33060716, "comment_id": 53943396, "body": "Note that the <code>Bool</code> in <code>Either SomeException Bool</code> should be the type of the return value (i.e. <code>Int</code> in this case). Also what the error message is telling you is that you are trying to return a <code>Bool</code> when the type inferencer wants an <code>IO something</code>. In fact the type of your function will be <code>Int -&gt; Int -&gt; IO Bool</code> because you cannot escape the <code>IO</code> monad. Also, instead of using pattern matching you could use the function <code>Data.Either.isRight</code>"}], "answers": [{"tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": false, "score": 2, "last_activity_date": 1444573141, "last_edit_date": 1495540784, "creation_date": 1444573141, "answer_id": 33066048, "question_id": 33060716, "link": "https://stackoverflow.com/questions/33060716/how-to-catch-exception/33066048#33066048", "title": "How to catch exception", "body": "<p>Couple of problems with your code:</p>\n\n<ul>\n<li><code>di</code> runs in the IO monad, so the result type needs to be <code>IO Bool</code></li>\n<li><code>try</code> needs an IO computation, but <code>div a b</code> is a pure value, so you need to lift it with <code>return</code>.</li>\n<li>Again, <code>di</code> returns an <code>IO Bool</code>, so the last case statement needs a <code>return</code> to lift the case expression to an IO computation.</li>\n</ul>\n\n<p>Here's a version of <code>di</code> which type checks:</p>\n\n<pre><code>di' :: Int -&gt; Int -&gt; IO Bool\ndi' a b = do\n  r &lt;- try (return (div a b)) :: IO (Either SomeException Int)\n  return $ case r of\n             Left _ -&gt; False\n             Right _ -&gt; True\n</code></pre>\n\n<p>However, this version will return <code>True</code> for all inputs. The reason is that  due to lazy evaluation the <code>div</code> function is never actually called.</p>\n\n<p>One way to fix this is to use the <code>BangPatterns</code> pragma to force the evaluation:</p>\n\n<pre><code>{-# LANGUAGE BangPatterns #-}\n\ndi' :: Int -&gt; Int -&gt; IO Bool\ndi' a b = do\n  r &lt;- try (let !x = div a b in return x) :: IO (Either SomeException Int)\n  return $ case r of\n            Left _ -&gt; False\n            Right _ -&gt; True\n\nghci&gt; di' 3 0\nFalse\n\nghci&gt; di' 3 1\nTrue\n</code></pre>\n\n<p>Also see this SO question: <a href=\"https://stackoverflow.com/q/20822365/866915\">How to catch a divide by zero error in Haskell?</a> for details on how to catch only arithmetic exceptions.</p>\n"}], "owner": {"reputation": 1443, "user_id": 3742750, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/15f53fbbfc39fbfcbec14bf8693dff5c?s=128&d=identicon&r=PG&f=1", "display_name": "KMC", "link": "https://stackoverflow.com/users/3742750/kmc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 991, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1444573141, "creation_date": 1444527387, "last_edit_date": 1444530477, "question_id": 33060716, "link": "https://stackoverflow.com/questions/33060716/how-to-catch-exception", "title": "How to catch exception", "body": "<p>How do you handle error in Haskell? Let's say I have function that does division. It returns true if division can be performed otherwise return false.</p>\n\n<pre><code>di :: Int -&gt; Bool\ndi a b = a `div` b\n</code></pre>\n\n<p>How do I catch the exception in this type of scenario so that I can return boolean value? How do I catch all exception not just particular type of exception? I know I can check if b is zero or not but I just want to know error handling.</p>\n\n<p>Update : \nHere's what I have done so far. However I'm getting type mismatch error. Can anyone point out how I can fix this? </p>\n\n<pre><code>di :: Int -&gt; Int -&gt; Bool\ndi a b = do\n    result &lt;- try (a `div` b) :: IO (Either SomeException Bool)\n    case result of\n       Left ex  -&gt; False\n       Right val -&gt; True\n</code></pre>\n\n<p>Error</p>\n\n<pre><code>Couldn't match type \u2018IO b0\u2019 with \u2018Bool\u2019\nExpected type: IO (Either SomeException Bool)\n               -&gt; (Either SomeException Bool -&gt; IO b0) -&gt; Bool\n  Actual type: IO (Either SomeException Bool)\n               -&gt; (Either SomeException Bool -&gt; IO b0) -&gt; IO b0\n</code></pre>\n"}, {"tags": ["list", "haskell", "indexing"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1444527058, "post_id": 33060683, "comment_id": 53941060, "body": "Can you let us know what you have tried so far ? We can then help you better."}, {"owner": {"reputation": 1, "user_id": 5327384, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206437920140187/picture?type=large", "display_name": "Lupita De La Cruz M&#225;rquez", "link": "https://stackoverflow.com/users/5327384/lupita-de-la-cruz-m%c3%a1rquez"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1444527673, "post_id": 33060683, "comment_id": 53941135, "body": "All I know so far is that this is the way to find an element in an specific position but I don&#39;t know how to show all elements in the impair positions or in the pair positions:                                     <code>show_in_index::Ord a=&gt;[a]-&gt;Int-&gt;a show_in_index l n = l!!n</code>"}], "answers": [{"tags": [], "owner": {"reputation": 489, "user_id": 3457759, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/dbc9ffc952d1b9de0db160785e7377e0?s=128&d=identicon&r=PG&f=1", "display_name": "Miguelme", "link": "https://stackoverflow.com/users/3457759/miguelme"}, "is_accepted": false, "score": 0, "last_activity_date": 1444541231, "creation_date": 1444541231, "answer_id": 33061851, "question_id": 33060683, "link": "https://stackoverflow.com/questions/33060683/haskell-how-to-show-all-elements-in-impair-and-pair-indexes-from-a-list/33061851#33061851", "title": "Haskell: How to show all elements in impair and pair indexes from a list?", "body": "<p>You could map the function for indexing</p>\n\n<p>For pospair the following works:</p>\n\n<pre><code>map ([1, 3, 9, 2, 5, 7, 1, 11] !! ) [0,2..length [1, 3, 9, 2, 5, 7, 1, 11]-1]\n</code></pre>\n\n<p>For posimpair we only have to change the second list that is the one that holds the indexing numbers, previously we had the series of pairs and now we want the series of impairs, so instead of having 0,2,.. until the length of the list -1 we have to do it with 1,3,..until the length of the list-1.</p>\n\n<pre><code>map ([1, 3, 9, 2, 5, 7, 1, 11] !! ) [1,3..length [1, 3, 9, 2, 5, 7, 1, 11]-1]\n</code></pre>\n\n<p>The general implementation is </p>\n\n<p>pospairs = map (list !!) [0,2..length list - 1]</p>\n\n<p>posimpairs = map (list !!) [1,3..length list - 1]</p>\n\n<p>I tested your example and works.</p>\n"}, {"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": false, "score": 1, "last_activity_date": 1444562840, "creation_date": 1444562840, "answer_id": 33064439, "question_id": 33060683, "link": "https://stackoverflow.com/questions/33060683/haskell-how-to-show-all-elements-in-impair-and-pair-indexes-from-a-list/33064439#33064439", "title": "Haskell: How to show all elements in impair and pair indexes from a list?", "body": "<p>The most simple way to do this is using recursion:</p>\n\n<pre><code>pospair :: [a] -&gt; [a]\npospair xs = aux xs [] True\n    where\n      aux [] acc _ = acc\n      aux (y:ys) acc True = aux ys (acc ++ [y]) False\n      aux (y:ys) acc False = aux ys acc True\n</code></pre>\n\n<p>Note how I use <code>True</code> or <code>False</code> value to keep track of what value to eliminate. If it's False, I don't include the value in <code>acc</code> (accumulator). If it's <code>True</code>, I include the value. Using the same idea, you can implement <code>posimpair</code>.</p>\n"}], "owner": {"reputation": 1, "user_id": 5327384, "user_type": "registered", "profile_image": "https://graph.facebook.com/10206437920140187/picture?type=large", "display_name": "Lupita De La Cruz M&#225;rquez", "link": "https://stackoverflow.com/users/5327384/lupita-de-la-cruz-m%c3%a1rquez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1444562840, "creation_date": 1444526812, "last_edit_date": 1444528179, "question_id": 33060683, "link": "https://stackoverflow.com/questions/33060683/haskell-how-to-show-all-elements-in-impair-and-pair-indexes-from-a-list", "title": "Haskell: How to show all elements in impair and pair indexes from a list?", "body": "<p><strong>It will need to get the next imput and output:</strong></p>\n\n<pre><code>pospair [1, 3, 9, 2, 5, 7, 1, 11]\n        [1, 9, 5, 1]\n\nposimpair [1, 3, 9, 2, 5, 7, 1, 11]\n          [3, 2, 7, 11]\n</code></pre>\n\n<p>This is the way to obtain the element on the specified index:</p>\n\n<pre><code>show_in_index::Ord a=&gt;[a]-&gt;Int-&gt;a\nshow_in_index l n = l!!n\n</code></pre>\n\n<p>It shows a result like this:</p>\n\n<pre><code>*Main&gt; show_in_index [1,4,2,7,9] 3\n7\n</code></pre>\n"}, {"tags": ["haskell", "binary"], "comments": [{"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1444523028, "post_id": 33060220, "comment_id": 53940346, "body": "Does <code>show</code> work ? You can see how it&#39;s instance is implemented in <code>base</code>."}], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 1, "last_activity_date": 1444524122, "creation_date": 1444524122, "answer_id": 33060464, "question_id": 33060220, "link": "https://stackoverflow.com/questions/33060220/parsing-strings-from-a-binary-file-in-haskell/33060464#33060464", "title": "Parsing Strings from a Binary File in Haskell", "body": "<p>The package <a href=\"http://haddock.stackage.org/lts-3.8/utf8-light-0.4.2/Codec-Binary-UTF8-Light.html#v:w2c\" rel=\"nofollow\">utf8-light</a> has a function named <code>w2c</code> function whose type is:</p>\n\n<pre><code>w2c ::Word32 -&gt; Char\n</code></pre>\n\n<p>You can see how it's implemented:</p>\n\n<pre><code>w2c :: Word32 -&gt; Char\n{-# INLINE w2c #-}\n#if defined(__GLASGOW_HASKELL__)\nw2c (W32# w) = C#(chr#(word2Int# w))\n#else\nw2c = unsafeChr . fromIntegral\n#endif\n</code></pre>\n\n<p>You can write a wrapper around it:</p>\n\n<pre><code>w2s :: Word32 -&gt; String\nw2s xs = [xs]\n</code></pre>\n\n<p>Alternatively, you can also use the <code>show</code> function since <code>Word32</code> has an instance for it. But I guess, it has a performance penalty.</p>\n"}], "owner": {"reputation": 739, "user_id": 832271, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0a746eab395b2add21ec029e5e2916c7?s=128&d=identicon&r=PG", "display_name": "SirensOfTitan", "link": "https://stackoverflow.com/users/832271/sirensoftitan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 33060464, "answer_count": 1, "score": 0, "last_activity_date": 1444524122, "creation_date": 1444521507, "question_id": 33060220, "link": "https://stackoverflow.com/questions/33060220/parsing-strings-from-a-binary-file-in-haskell", "title": "Parsing Strings from a Binary File in Haskell", "body": "<p>I'm using the <code>Data.Binary.Get</code> monad to read data from a file in Haskell.  How would I go about converting some Word32 grabbed from getWord32** into a [Char] or String?</p>\n\n<p>I've tried breaking the Word32 into four octets and converting that way, but I'm having trouble getting the conversion working. How would I best convert a Word32 into a string (assuming four characters).</p>\n"}, {"tags": ["haskell", "pattern-matching"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 1, "creation_date": 1444524127, "post_id": 33060211, "comment_id": 53940520, "body": "You have not covered the cases where the list has exactly 1 or 2 elements.  In addition to Sibi&#39;s answer"}, {"owner": {"reputation": 1767, "user_id": 1546268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4fba394918b979fcd94bd0071969407?s=128&d=identicon&r=PG&f=1", "display_name": "stian", "link": "https://stackoverflow.com/users/1546268/stian"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1444553438, "post_id": 33060211, "comment_id": 53945388, "body": "sorry I did not mention that the list is always a multiple of three.."}], "answers": [{"tags": [], "owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "is_accepted": true, "score": 5, "last_activity_date": 1444523625, "creation_date": 1444523625, "answer_id": 33060421, "question_id": 33060211, "link": "https://stackoverflow.com/questions/33060211/why-the-illegal-non-exchastive-pattern-matching-in-this-code/33060421#33060421", "title": "why the illegal non-exchastive pattern-matching in this code?", "body": "<p>The problem is with this line:</p>\n\n<blockquote>\n  <p>mutate (f:s:t:rest) = case (f:s:t:rest) of</p>\n</blockquote>\n\n<p>You are pattern matching in the first line itself. So this case will be only entered when the list has a minimum elements of 3. Something like this should work:</p>\n\n<pre><code>mutate :: [Char] -&gt; Int\nmutate xs = case xs of\n               ('P':'E':'R':rest) -&gt; 0\n               ('P':'E':_:rest) -&gt; 1 \n               ('P':_:'R':rest) -&gt; 1\n               (_:'E':'R':rest) -&gt; 1\n               (_:_:'R':rest) -&gt; 2\n               (_:'E':_:rest) -&gt; 2\n               ('P':_:_:rest) -&gt; 2\n               (_:_:_:rest) -&gt; 3\n               ([]) -&gt; 0\n</code></pre>\n"}], "owner": {"reputation": 1767, "user_id": 1546268, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b4fba394918b979fcd94bd0071969407?s=128&d=identicon&r=PG&f=1", "display_name": "stian", "link": "https://stackoverflow.com/users/1546268/stian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 33060421, "answer_count": 1, "score": 1, "last_activity_date": 1444523625, "creation_date": 1444521402, "question_id": 33060211, "link": "https://stackoverflow.com/questions/33060211/why-the-illegal-non-exchastive-pattern-matching-in-this-code", "title": "why the illegal non-exchastive pattern-matching in this code?", "body": "<p>I wrote a pattern matching based code (commented out), which worked fine. I wanted to use \"case of\" in the hope of compacting my code a bit, but then it doesn't like how I have declared the empty list case (last one). I looked at some case of examples, and although not identical they seemed to support my declaration. Therefore I am not sure what I am doing wrong, and help is very much appreciated.   </p>\n\n<pre><code>--1st way\nmutate::[Char] -&gt;Int\n--mutate::[Char] -&gt;[Int]\n--mutate ('P':'E':'R':rest) = 0:mutate rest\n--mutate ('P':'E':_:rest) = 1:mutate rest \n--mutate ('P':_:'R':rest) = 1:mutate rest\n--mutate (_:'E':'R':rest) = 1:mutate rest\n--mutate (_:_:'R':rest) = 2:mutate rest\n--mutate (_:'E':_:rest) = 2:mutate rest\n--mutate ('P':_:_:rest) = 2:mutate rest\n--mutate (_:_:_:rest) = 3:[]\n--mutate [] = [0]\n--2nd way\n\nmutate (f:s:t:rest) = case (f:s:t:rest) of\n('P':'E':'R':rest) -&gt; 0\n('P':'E':_:rest) -&gt; 1 \n('P':_:'R':rest) -&gt; 1\n(_:'E':'R':rest) -&gt; 1\n(_:_:'R':rest) -&gt; 2\n(_:'E':_:rest) -&gt; 2\n('P':_:_:rest) -&gt; 2\n(_:_:_:rest) -&gt; 3\n([]) -&gt; 0\n\nmain = print $ mutate []\n</code></pre>\n"}, {"tags": ["debugging", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444546945, "post_id": 33060517, "comment_id": 53944015, "body": "Couldn&#39;t it <code>evaluate $ force msg</code> first to avoid interference?"}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444576600, "post_id": 33060517, "comment_id": 53951839, "body": "@dfeuer You&#39;re right, this <i>could</i> be done directly from Haskell. It&#39;s just already available as a C function. I&#39;ve edited my answer with a note on this."}], "tags": [], "owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "is_accepted": false, "score": 4, "last_activity_date": 1444576518, "last_edit_date": 1444576518, "creation_date": 1444524871, "answer_id": 33060517, "question_id": 33059675, "link": "https://stackoverflow.com/questions/33059675/whats-the-difference-between-traceio-and-hputstrln-stderr/33060517#33060517", "title": "What&#39;s the difference between `traceIO` and `hPutStrLn stderr`?", "body": "<p>One thing I can think of is that it might ensure that the string is printed as a unit, without any other trace messages inside. Indeed an experiment seems to confirm this:</p>\n\n<pre><code>Prelude Debug.Trace System.IO&gt; traceIO $ \"1\" ++ trace \"2\" \"3\"\n2\n13\nPrelude Debug.Trace System.IO&gt; hPutStrLn stderr $ \"1\" ++ trace \"2\" \"3\"\n12\n3\n</code></pre>\n\n<p>Another difference is that it seems to remove characters that cannot safely be printed to stderr:</p>\n\n<pre><code>Prelude Debug.Trace System.IO&gt; hPutStrLn stderr \"\\9731\"\n*** Exception: &lt;stderr&gt;: hPutChar: invalid argument (invalid character)\nPrelude Debug.Trace System.IO&gt; traceIO \"\\9731\"\n\nPrelude Debug.Trace System.IO&gt; \n</code></pre>\n\n<p>As @dfeuer reminds me of, none of these features would be impossible to write in Haskell.  So the deciding factor is probably this: <a href=\"https://github.com/ghc/ghc/blob/c5911479f295242e16e396eb5d1369f2e4ce8de0/includes/rts/Messages.h#L78\" rel=\"nofollow\"><code>debugBelch</code></a> is already a predefined C function, used <a href=\"https://github.com/ghc/ghc/search?utf8=%E2%9C%93&amp;q=debugBelch\" rel=\"nofollow\">all over the place</a> in GHC's runtime system, which is written in C and C--, not Haskell.</p>\n"}], "owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "answer_count": 1, "score": 6, "last_activity_date": 1444576518, "creation_date": 1444516554, "last_edit_date": 1444517430, "question_id": 33059675, "link": "https://stackoverflow.com/questions/33059675/whats-the-difference-between-traceio-and-hputstrln-stderr", "title": "What&#39;s the difference between `traceIO` and `hPutStrLn stderr`?", "body": "<p>Looking at the description for <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Debug-Trace.html#v:traceIO\" rel=\"noreferrer\"><code>traceIO</code></a>, I feel that it does exactly what <code>hPutStrLn stderr</code> does. However when I looked into its source code:</p>\n\n<pre><code>traceIO :: String -&gt; IO ()\ntraceIO msg = do\n    withCString \"%s\\n\" $ \\cfmt -&gt; do\n     -- NB: debugBelch can't deal with null bytes, so filter them\n     -- out so we don't accidentally truncate the message.  See Trac #9395\n     let (nulls, msg') = partition (=='\\0') msg\n     withCString msg' $ \\cmsg -&gt;\n      debugBelch cfmt cmsg\n     when (not (null nulls)) $\n       withCString \"WARNING: previous trace message had null bytes\" $ \\cmsg -&gt;\n         debugBelch cfmt cmsg\n</code></pre>\n\n<p>It seems it uses a foreign routine called <code>debugBelch</code>, which I failed to find any documentation about. So what does <code>traceIO</code> do that can't be done by <code>hPutStrLn stderr</code>?</p>\n"}, {"tags": ["haskell", "io", "monads", "arrows"], "answers": [{"tags": [], "owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "is_accepted": false, "score": 1, "last_activity_date": 1444527312, "last_edit_date": 1444527312, "creation_date": 1444520541, "answer_id": 33060129, "question_id": 33059636, "link": "https://stackoverflow.com/questions/33059636/can-i-take-snapshots-for-the-io-monad/33060129#33060129", "title": "Can I take &quot;snapshots&quot; for the IO Monad?", "body": "<p><del>OK, I think I get it work by adding this signal:</del> </p>\n\n<pre><code>onceSwitch = mkPureN $ (\\_ -&gt; (Just (), mkEmpty))\n</code></pre>\n\n<p>I generalized the switch to the following function (and added to <code>Prefab</code> of <code>timeless</code>):</p>\n\n<pre><code>occursFor :: b -&gt; Int -&gt; Signal s m a b\noccursFor b n\n    | n == 0 = mkEmpty\n    | n &gt; 0 = mkPureN $ \\_ -&gt; (Just b, occursFor b $ n-1)\n    | otherwise = error \"[ERROR] occursFor: Nothing occurs for less than zero times!\"\n</code></pre>\n\n<p><del>Whose output is <code>()</code> for the first time it is run, then inhibits, and this signal:</del></p>\n\n<pre><code>onceIO = SGen $ f\n  where\n    f _ ma = return (ma, SArr $ const ma)\n</code></pre>\n\n<p><del>Which becomes a constant after first run. Chaining an <code>IO</code> action like this:</del></p>\n\n<pre><code>file &lt;- onceIO &lt;&lt;&lt; sc &lt;&lt;&lt; () `occursFor` 1 -&lt; ()\n</code></pre>\n\n<p><del>seems to work intended. (Updated: now uses <code>occursFor</code>)</del></p>\n\n<p>After tweaking around, it looks like this. Notice that the API of <code>timeless</code> <em>will</em> change violently as I develop, but it is likely that the functions I use underneath will not change. Anyway, the same thing applies to <code>netwire</code>, which is the origin of <code>timeless</code>, with some minor changes. If you need to make some applications, use that for now. </p>\n\n<pre><code>{-# LANGUAGE Arrows #-}\n\nmodule Main where\n\nimport FRP.Timeless\nimport Debug.Trace\n\nsc = mkKleisli_ $ \\_ -&gt; do\n  putStrLn \"SC\"\n  return \"A\"\nsp = mkKleisli_ putStrLn\n\nbox :: Signal s IO () ()\nbox = proc _ -&gt; do\n  file &lt;- snapOnce &lt;&lt;&lt; sc &lt;&lt;&lt; inhibitsAfter 1 -&lt; ()\n  sp -&lt; file\n  returnA -&lt; ()\n\nbox2 = proc _ -&gt; do\n  box -&lt; ()\n\nmain = do\n  runBox clockSession_ box2\n</code></pre>\n"}], "owner": {"reputation": 1221, "user_id": 2353597, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bd9a1e25ba73d9fdfa8c87013ac122da?s=128&d=identicon&r=PG", "display_name": "Carl Dong", "link": "https://stackoverflow.com/users/2353597/carl-dong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1444527312, "creation_date": 1444516278, "last_edit_date": 1444518535, "question_id": 33059636, "link": "https://stackoverflow.com/questions/33059636/can-i-take-snapshots-for-the-io-monad", "title": "Can I take &quot;snapshots&quot; for the IO Monad?", "body": "<p>I am currently writing an FRP library built on Arrows (namely, <a href=\"https://github.com/carldong/timeless\" rel=\"nofollow\">timeless</a>). However, I encountered a problem:</p>\n\n<p>If I wrap an <code>IO</code> action inside the arrow, (<code>Signal s IO a b</code> in this case, which is a Kleisli arrow), I would like to take a \"snapshot\" of the final returned value, instead of running the action every time. For example, I have an action involving reading a file and parsing into some data structure, and currently this action is running every frame of update. I tried a bit to make use of Haskell's lazy evaluation to prevent it from running again and again, but it did not work.</p>\n\n<p>Conceptually, <code>Signal</code> is basically (but not exactly)</p>\n\n<pre><code>a -&gt; IO (b, Signal)\n</code></pre>\n\n<p>Each update, the signal itself is replaced by the new signal. Now, I think if I feed an <code>IO</code> action with type <code>IO a</code> in (using Kleisli arrows), I can somehow replace the <code>Signal</code> with something else that holds the final result of the previous action. However, I cannot find a way to do it because I can't extract anything from <code>IO</code>, and simply replacing the signal to a constant one doesn't seem to stop the action from being reevaluated. </p>\n\n<p>This is a minimal test program:</p>\n\n<pre><code>{-# LANGUAGE Arrows #-}\n\nmodule Main where\n\nimport FRP.Timeless\nimport Debug.Trace\n\ns1 :: (Monad m) =&gt; Signal s m a Int\ns1 = mkConst $ trace \"Signal 1\" $ Just 5\ns2 :: (Monad m) =&gt; Signal s m Int Int\ns2 = arr $ trace \"Signal 2\" (+1)\ns3 :: (Monad m) =&gt; Signal s m a ()\ns3 = arr $ \\_ -&gt; ()\n\nsc = mkKleisli_ $ \\_ -&gt; do\n  putStrLn \"SC\"\n  readFile \"test.txt\"\nsp = mkKleisli_ putStrLn\n\nbox :: Signal s IO () ()\nbox = proc _ -&gt; do\n  file &lt;- sc -&lt; ()\n  sp -&lt; file\n  returnA -&lt; ()\n\nbox2 = proc _ -&gt; do\n  box -&lt; ()\n\nmain = do\n  runBox clockSession_ box2\n</code></pre>\n\n<p>Here, <code>sc</code> reads a file \"Test.txt\". It is evaluated every time. I would like to find a way to evaluate only once, and keep the value.</p>\n\n<p>BTW, <code>unsafePerformIO</code> would probably work, but, as its name suggests, it is probably \"unsafe\", so I don't want to use it</p>\n"}, {"tags": ["debugging", "haskell"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 2, "creation_date": 1444514891, "post_id": 33059378, "comment_id": 53938737, "body": "<code>traceMsg = trace</code>..."}, {"owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "reply_to_user": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1444515386, "post_id": 33059378, "comment_id": 53938853, "body": "@ErikAllik: Sorry I edited the question."}], "answers": [{"comments": [{"owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "edited": false, "score": 0, "creation_date": 1444515757, "post_id": 33059494, "comment_id": 53938934, "body": "Hummm ... interesting view. (BTW technically <code>traceId&#39;</code> is not exactly <code>traceId</code> in the <code>String</code> case, as <code>traceId</code> uses <code>id</code> instead of <code>show</code>, which means the string is unescaped and unquoted when printed)"}, {"owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "edited": false, "score": 0, "creation_date": 1444515890, "post_id": 33059494, "comment_id": 53938972, "body": "I guess the reason is more of a consistency consideration. <code>traceId</code> should be exactly as its name indicated -- <code>trace</code> with its first argument identical to its second."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "edited": false, "score": 0, "creation_date": 1444516342, "post_id": 33059494, "comment_id": 53939064, "body": "actually I&#39;m curious if somebody can give a better explanation about <code>traceId</code> \u2014 like why it&#39;s not <code>Show a =&gt; a -&gt; a</code> in the first place."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 4, "creation_date": 1444521348, "post_id": 33059494, "comment_id": 53940097, "body": "I think <code>traceId&#39;</code> is <code>traceShowId</code>, which is in <code>Debug.Trace</code>"}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "edited": false, "score": 0, "creation_date": 1444521478, "post_id": 33059494, "comment_id": 53940117, "body": "Also, <code>traceId&#39;</code>/<code>traceShowId</code> would have double quotes while <code>traceId</code> (I suspect) would not. Haven&#39;t tried it though."}], "tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": false, "score": 2, "last_activity_date": 1444563875, "last_edit_date": 1444563875, "creation_date": 1444515352, "answer_id": 33059494, "question_id": 33059378, "link": "https://stackoverflow.com/questions/33059378/why-does-traceid-return-the-message-string-itself/33059494#33059494", "title": "Why does `traceId` return the message string itself?", "body": "\n\n<p><strong>EDIT:</strong></p>\n\n<p>Credits to David who drew attention on the fact that my <code>traceId'</code> is exactly <code>traceShowId</code>.</p>\n\n<p>Hence, <code>traecId</code> is simply the <code>String -&gt; String</code> monomorphic version of the polymorphic <code>traceShowId :: Show a -&gt; a -&gt; a</code>, which also strips the printed string from quotes.</p>\n\n<p><strong>Old answer:</strong></p>\n\n<p>One way to interpret <code>traceId</code> is that it's a <code>String</code>-specialized version of a more general <code>traceId'</code> which is not in the stdlib:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>traceId' :: Show a =&gt; a -&gt; a\ntraceId' x = trace (show x) x\n</code></pre>\n\n<p>so that</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>traceId = traceId' :: String -&gt; String\n</code></pre>\n\n<p><strong>Example:</strong></p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>my = id; func = id; chain = id; value = 3\n\nmain = do\n  print $ length $ traceId \"chain is called!\"\n  print $ length $ traceId' [1,2,3]\n</code></pre>\n\n<p>but for some reason the general version of <code>traceId</code>, which I've called <code>traceId'</code>, is not in the stdlib.</p>\n"}], "owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1444563875, "creation_date": 1444514347, "last_edit_date": 1444515293, "question_id": 33059378, "link": "https://stackoverflow.com/questions/33059378/why-does-traceid-return-the-message-string-itself", "title": "Why does `traceId` return the message string itself?", "body": "<p>I found it really weird that <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Debug-Trace.html#v:traceId\" rel=\"nofollow\"><code>traceId</code></a> returns the message string itself. Why would anyone want to do that?</p>\n\n<p>Is there a common scenario where <code>traceId</code> would come in handy?</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1444514265, "post_id": 33059249, "comment_id": 53938589, "body": "What should happen if the user types a random string, instead?"}, {"owner": {"reputation": 906, "user_id": 5299539, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/9f41c4053ec442fe9d5fa1e2b2e19c6f?s=128&d=identicon&r=PG&f=1", "display_name": "Charana", "link": "https://stackoverflow.com/users/5299539/charana"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1444514487, "post_id": 33059249, "comment_id": 53938641, "body": "didn&#39;t think about that,throw an error maybe?"}], "answers": [{"comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 2, "creation_date": 1444602014, "post_id": 33059407, "comment_id": 53959571, "body": "Instead of defining your own validator, why not use <code>readMaybe</code> from <code>Text.Read</code>? <a href=\"https://hackage.haskell.org/package/base-4.8.1.0/docs/Text-Read.html#v:readMaybe\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/base-4.8.1.0/docs/&hellip;</a>"}, {"owner": {"reputation": 311, "user_id": 3932019, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/caa87dc02ccd35f92887caca786e866e?s=128&d=identicon&r=PG&f=1", "display_name": "DanielRS", "link": "https://stackoverflow.com/users/3932019/danielrs"}, "reply_to_user": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1444626128, "post_id": 33059407, "comment_id": 53964753, "body": "@ReinHenrichs Yeah, it is absolutely valid to go that way (or even better)."}], "tags": [], "owner": {"reputation": 311, "user_id": 3932019, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/caa87dc02ccd35f92887caca786e866e?s=128&d=identicon&r=PG&f=1", "display_name": "DanielRS", "link": "https://stackoverflow.com/users/3932019/danielrs"}, "is_accepted": true, "score": 2, "last_activity_date": 1444515417, "last_edit_date": 1444515417, "creation_date": 1444514550, "answer_id": 33059407, "question_id": 33059249, "link": "https://stackoverflow.com/questions/33059249/how-to-set-getline-to-only-receive-strings-that-can-be-converted-to-numbers/33059407#33059407", "title": "How to set getLine to only receive strings that can be converted to numbers?", "body": "<p>Here's a quick idea that could help you:</p>\n\n<pre><code>import Control.Applicative\nimport Data.Char\n\ngetNum :: (Num a, Read a) =&gt; IO (Maybe a)\ngetNum = do\n  (x, xs) &lt;- break (not . isDigit ) &lt;$&gt; getLine\n  case xs of\n    [] -&gt; return $ Just $ read x\n    _ -&gt; return Nothing\n\nmain :: IO ()\nmain = do\n  x &lt;- getNum :: IO (Maybe Double)\n  case x of\n    Nothing -&gt; do\n      putStrLn \"Not a number, try again\"\n      main\n    Just x' -&gt;\n      putStrLn $ \"Your number: \" ++ show x'\n  return ()\n</code></pre>\n\n<p>You cannot \"make\" getLine accept only numbers, you make a function that does. You can even modify this function to accept only the first set of numbers before a non-digit (right now it returns <code>Nothing</code> if any non-digit is in the string).</p>\n\n<p><strong>Update</strong></p>\n\n<p>Here's a program that asks for two numbers and an operation, doing some value checking:</p>\n\n<pre><code>import Control.Applicative\nimport Data.Char\nimport Data.Maybe\n\ngetNum :: (Num a, Read a) =&gt; IO (Maybe a)\ngetNum = do\n  (x, xs) &lt;- break (not . isDigit ) &lt;$&gt; getLine\n  case xs of\n    [] -&gt; return $ Just $ read x\n    _ -&gt; return Nothing\n\nmain :: IO ()\nmain = do\n  putStr \"First: \"\n  x &lt;- getNum :: IO (Maybe Double)\n\n  putStr \"Operation: \"\n  op &lt;- getLine\n\n  putStr \"Second: \"\n  y &lt;- getNum :: IO (Maybe Double)\n\n  if isJust x &amp;&amp; isJust y then do\n    let\n      x' = fromJust x\n      y' = fromJust y\n    putStr \"Result: \"\n    case op of\n      \"divide\" -&gt; putStrLn $ show $ x' / y'\n      \"sum\" -&gt; putStrLn $ show $ x' + y'\n      _ -&gt; putStrLn \"No operation\"\n  else\n    putStrLn \"Invalid numbers\"\n\n  return ()\n</code></pre>\n"}], "owner": {"reputation": 906, "user_id": 5299539, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/9f41c4053ec442fe9d5fa1e2b2e19c6f?s=128&d=identicon&r=PG&f=1", "display_name": "Charana", "link": "https://stackoverflow.com/users/5299539/charana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 1, "accepted_answer_id": 33059407, "answer_count": 1, "score": 0, "last_activity_date": 1444515417, "creation_date": 1444513340, "question_id": 33059249, "link": "https://stackoverflow.com/questions/33059249/how-to-set-getline-to-only-receive-strings-that-can-be-converted-to-numbers", "title": "How to set getLine to only receive strings that can be converted to numbers?", "body": "<pre><code>main = do \nputStrLn \"Hello,Name please?\"\nfirst &lt;- getLine\nsecond &lt;- getLine\nthird &lt;- getLine\nif (second == \"divide\") then putStrLn (show (read first ::Double )/ (read third :: Double))\n    else putStrLn \"Cannot do\"\n</code></pre>\n\n<p>So i want a number in first and third variables,and the second variable will be given the work <code>divide</code> and the if statement will begin and convert the <code>String</code> in first to a <code>Double</code>.But i think the issue is that the variable <code>First</code> is expecting a String like \"one\" that cannot be converted to a Double.How to fix this to allow getLine to only receive Strings that can be changed in numbers </p>\n"}, {"tags": ["string", "list", "haskell", "io"], "comments": [{"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1444511734, "post_id": 33059026, "comment_id": 53937987, "body": "perhaps you want to use <code>read</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1709237"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1444511809, "post_id": 33059026, "comment_id": 53938010, "body": "I have tried <code>read coord::list</code> and <code>read coord</code>, I get errors on both."}, {"owner": {"reputation": 620, "user_id": 2584221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d093dc953c307e20883be41dd6faa702?s=128&d=identicon&r=PG", "display_name": "dsemi", "link": "https://stackoverflow.com/users/2584221/dsemi"}, "edited": false, "score": 1, "creation_date": 1444512297, "post_id": 33059026, "comment_id": 53938134, "body": "If you want a list of something you have to surround it in brackets.  You want a list of <code>Int</code> tuples, so <code>read coord :: [(Int, Int)]</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1709237"}, "edited": false, "score": 0, "creation_date": 1444512776, "post_id": 33059026, "comment_id": 53938247, "body": "Thanks so much, that worked!"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1709237"}, "is_accepted": false, "score": 1, "last_activity_date": 1444603315, "last_edit_date": 1444603315, "creation_date": 1444513328, "answer_id": 33059246, "question_id": 33059026, "link": "https://stackoverflow.com/questions/33059026/string-to-list-of-tuples-from-file-in-haskell/33059246#33059246", "title": "String to list of tuples from file in Haskell", "body": "<p>As dsemi pointed out, all I needed to use <code>read coord :: [(Int, Int)]</code>.  Thanks for the help</p>\n"}, {"tags": [], "owner": {"reputation": 311, "user_id": 3932019, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/caa87dc02ccd35f92887caca786e866e?s=128&d=identicon&r=PG&f=1", "display_name": "DanielRS", "link": "https://stackoverflow.com/users/3932019/danielrs"}, "is_accepted": false, "score": 0, "last_activity_date": 1444513335, "creation_date": 1444513335, "answer_id": 33059247, "question_id": 33059026, "link": "https://stackoverflow.com/questions/33059026/string-to-list-of-tuples-from-file-in-haskell/33059247#33059247", "title": "String to list of tuples from file in Haskell", "body": "<p>Something like this works fine:</p>\n\n<pre><code>import Control.Applicative ((&lt;$&gt;))\nimport System.IO\n\nmain :: IO ()\nmain = do\n  handle &lt;- openFile \"test.txt\" ReadMode\n  cords &lt;-  map read &lt;$&gt; lines &lt;$&gt; hGetContents handle :: IO [(Int, Int)]\n  putStrLn $ show cords\n  return ()\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1709237"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 563, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1444603315, "creation_date": 1444511355, "question_id": 33059026, "link": "https://stackoverflow.com/questions/33059026/string-to-list-of-tuples-from-file-in-haskell", "title": "String to list of tuples from file in Haskell", "body": "<p>I am currently reading from an input file with a randomly sized list of tuples, I am trying to get the incoming data as a list, however ever, whenever I try to parse it as anything other than a string i receive error messages.  The input files look something like this:</p>\n\n<pre><code>[(2, 2), (2, 3), (3, 2), (3, 3)]\n</code></pre>\n\n<p>or</p>\n\n<pre><code>[(4, 2), (5, 2), (6, 2)]\n</code></pre>\n\n<p>I am able to handle the input as follows:</p>\n\n<pre><code>handle &lt;- openFile \"test.txt\" ReadMode\ncoord &lt;- hGetLine handle\nlet alive = coord\nprint alive\n</code></pre>\n\n<p>However, this produces a simple string.</p>\n\n<p>Any help would be appreciated!</p>\n"}, {"tags": ["debugging", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "edited": false, "score": 0, "creation_date": 1444511553, "post_id": 33058989, "comment_id": 53937938, "body": "That&#39;s an interesting way of doing it. I didn&#39;t know I could use <code>join</code> this way."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "reply_to_user": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "edited": false, "score": 0, "creation_date": 1444511965, "post_id": 33058989, "comment_id": 53938048, "body": "@trVoldemort Yup. It&#39;s surprising how often we forget that the function is indeed a monad."}], "tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": false, "score": 4, "last_activity_date": 1444511191, "creation_date": 1444511191, "answer_id": 33058989, "question_id": 33058924, "link": "https://stackoverflow.com/questions/33058924/whats-a-shorter-way-of-writing-x-traceshow-x-x/33058989#33058989", "title": "What&#39;s a shorter way of writing `(\\ x -&gt; traceShow x x )`?", "body": "<p>Yes. <code>join traceShow</code>.</p>\n\n<pre><code>\u03bb&gt;  import Control.Monad\n\u03bb&gt; :t join\njoin :: Monad m =&gt; m (m a) -&gt; m a\n\u03bb&gt; :t join (+)\njoin (+) :: Num a =&gt; a -&gt; a\n</code></pre>\n\n<p>In the case of the function monad, <code>join f x = f x x</code>, so <code>join traceShow</code> is equivalent to <code>\\x -&gt; traceShow x x</code>.</p>\n\n<p>Or make a <code>where</code> clause that provides a new definition of <code>(.)</code>:</p>\n\n<pre><code>--...your code without the nasty bits...\n    where\n       (.) f g a = f ( join traceShow (g a))\n</code></pre>\n\n<p>Which may just help, though there will be one more <code>traceShow</code> call than previously.</p>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1444513463, "post_id": 33058994, "comment_id": 53938402, "body": "What, you&#39;re not going to generalize from lists of endomorphisms to type-aligned sequences of morphisms???"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1444513719, "post_id": 33058994, "comment_id": 53938465, "body": "@dfeuer I almost did - I had a GADT called <code>Path</code> all ready to go - but then I realised it was rather an excessive answer to the question :P. (Also, I don&#39;t know of a clean way to enforce <code>Show</code>ability for all the intermediate types of a TAS without shoving the constraint into the GADT itself.)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1444514535, "post_id": 33058994, "comment_id": 53938647, "body": "You can force the arrow type to cough up instances, I suppose. <code>data Showorph x y where Showorph :: (Show x, Show y) =&gt; (x -&gt; y) -&gt; Showorph x y</code>"}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444518351, "post_id": 33058994, "comment_id": 53939507, "body": "@dfeuer Thanks for the suggestion! I ended up sticking it in my answer after all."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1444603986, "post_id": 33058994, "comment_id": 53960017, "body": "<code>Showoff</code> is a great name. I was trying to suggest &quot;shawarma&quot; in the great Haskell sandwich tradition. My double-sided constraint was a cop-out: I didn&#39;t want to have to think about which end should be <code>Show</code>. Glad you worked that out."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1464187233, "post_id": 33058994, "comment_id": 62383406, "body": "I noticed you mentioned <code>Path</code> is parameterized by a category, which is often true. But this is not generally the case, and doesn&#39;t seem to be the case in the rest of the discussion. <code>Path c</code> is a category <i>no matter what <code>c</code> is</i>."}, {"owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1464189553, "post_id": 33058994, "comment_id": 62385233, "body": "@dfeuer Yes, that&#39;s what I was trying to get at with my comment about <code>Path c</code> being <code>c</code>&#39;s reflexive transitive closure. I guess I didn&#39;t do a good job of explaining that. I used the word &quot;category&quot; to emphasise the fact that in this example we&#39;re using <code>Path</code> as a sequence of morphisms"}], "tags": [], "owner": {"reputation": 37219, "user_id": 1523776, "user_type": "moderator", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b3e0b5c8e42a8c38009ef2d969f8dabb?s=128&d=identicon&r=PG", "display_name": "Benjamin Hodgson", "link": "https://stackoverflow.com/users/1523776/benjamin-hodgson"}, "is_accepted": false, "score": 1, "last_activity_date": 1464192099, "last_edit_date": 1464192099, "creation_date": 1444511202, "answer_id": 33058994, "question_id": 33058924, "link": "https://stackoverflow.com/questions/33058924/whats-a-shorter-way-of-writing-x-traceshow-x-x/33058994#33058994", "title": "What&#39;s a shorter way of writing `(\\ x -&gt; traceShow x x )`?", "body": "<p>You could write a higher-order function which takes a function of two arguments and uses the same value for both arguments.</p>\n\n<pre><code>applyBoth :: (a -&gt; a -&gt; b) -&gt; a -&gt; b\napplyBoth f x = f x x\n</code></pre>\n\n<p>(Aside: this is <code>join</code> for the \"reader\" monad <code>(-&gt;) a</code>.)</p>\n\n<p>Then you can use that combinator in curried form:</p>\n\n<pre><code>applyBoth traceShow\n    . my\n    . applyBoth traceShow\n    . super\n    . applyBoth traceShow\n    . cool\n    . applyBoth traceShow\n    . fUnCtIoN\n    . applyBoth traceShow\n    . chain\n    $ value\n</code></pre>\n\n<p>Or define an alias for <code>applyBoth traceShow</code>.</p>\n\n<pre><code>traceS = applyBoth traceShow\n\ntraceS\n    . my\n    . traceS\n    . super\n    . traceS\n    . cool\n    . traceS\n    . fUnCtIoN\n    . traceS\n    . chain\n    $ value\n</code></pre>\n\n<p>For maximum terseness points, you can automatically interleave <code>traceS</code> into a list of functions by folding it up:</p>\n\n<pre><code>showSteps :: Show a =&gt; [a -&gt; a] -&gt; a -&gt; a\nshowSteps = foldr (\\f g -&gt; f . traceS . g) id\n\nshowSteps [my, super, cool, fUnCtIoN, chain] value\n</code></pre>\n\n<hr>\n\n<p><strong>Edit</strong> Eh, what the hell... It's not entirely relevant, but here's how to make <code>showSteps</code> work when you want to pipeline your data through a number of types. It's an example of a program we wouldn't be able to write without GHC's advanced type system features (<code>GADTs</code> and <code>RankNTypes</code> in this instance).</p>\n\n<p><code>Path</code> is a GADT which explains how to walk through a directed graph of types, starting at the source type <code>x</code> and ending at the destination type <code>y</code>. It's parameterised by a category <code>c :: * -&gt; * -&gt; *</code>.</p>\n\n<pre><code>infixr 6 :-&gt;\ndata Path c x y where\n    End :: Path c z z\n    (:-&gt;) :: c x y -&gt; Path c y z -&gt; Path c x z\n</code></pre>\n\n<p><code>:-&gt;</code> reminds us that a journey of a thousand miles begins with a single step: if the category you're working in lets you go from <code>x</code> to <code>y</code>, and you can take a path from <code>y</code> to <code>z</code>, you can go from <code>x</code> to <code>z</code>.\n<code>End</code> is for when you have reached your destination - it's pretty easy to walk from <code>z</code> to <code>z</code> by not walking at all.</p>\n\n<p>So <code>Path</code> has the same recursive structure as a linked list, but with a more flexible approach to the things inside it. Rather than requiring all of its elements to have the same type, it gives you a way to join up arrows like dominos, as long as the return type of one arrow matches the input type of the next. (To use the mathematical jargon: if you view the underlying category <code>c</code> as a logical relation, then <a href=\"https://en.wikipedia.org/wiki/Reflexive_closure\" rel=\"nofollow\"><code>End</code> augments <code>c</code> with reflexivity</a> and <a href=\"https://en.wikipedia.org/wiki/Transitive_closure#Existence_and_description\" rel=\"nofollow\"><code>:-&gt;</code> augments <code>c</code> with transitivity</a>. <code>Path c</code> thus constructs the <em>reflexive transitive closure</em> of <code>c</code>. Another way of looking at this is that <code>Path</code> is the <em>free category</em>, much like <code>[]</code> is the <em>free monoid</em>; you can define <code>instance Category (Path c)</code> without any constraint on <code>c</code>.)</p>\n\n<p>You can fold up a <code>Path</code> with exactly the same code as you use to fold up a list, but the type is more precise: the folding function can't know anything <em>a priori</em> about the types of the arrows inside the path.</p>\n\n<pre><code>foldr :: (forall x y. c x y -&gt; r y z -&gt; r x z) -&gt; r z z -&gt; Path c x z -&gt; r x z\nfoldr f z End = z\nfoldr f z (x :-&gt; xs) = f x $ foldr f z xs\n</code></pre>\n\n<p>At this point, I could define type-aligned sequences of functions (<code>type TAS = Path (-&gt;)</code>) and show you how <code>f :-&gt; g :-&gt; h :-&gt; End</code> can be folded up into <code>h . g . f</code>, but since our goal is to print out all the intermediate values, we have to use a category with a tiny bit more structure than plain old <code>-&gt;</code>. (Thanks to @dfeuer in the comments for the suggestion - I've adjusted the name he gave to better reflect the attention-seeking nature of my behaviour.)</p>\n\n<pre><code>data Showoff x y where\n    Showoff :: Show y =&gt; (x -&gt; y) -&gt; Showoff x y\n</code></pre>\n\n<p><code>Showoff</code> is just like a regular function, except it assures you that the return value <code>y</code> will be <code>Show</code>able. We can use this extra bit of knowledge to write <code>showSteps</code> for paths in which each step is a <code>Showoff</code>.</p>\n\n<pre><code>type ShowTAS = Path Showoff\n\nshowSteps :: ShowTAS a b -&gt; a -&gt; b\nshowSteps path = foldr combine id path . traceS\n    where combine (Showoff f) g = g . traceS . f\n</code></pre>\n\n<p>It strikes me as a bit of a shame to use the <em>impure</em> <code>traceS</code> right in the midst of all this strongly typed fun. In real life I'd probably return a <code>String</code> along with the answer.</p>\n\n<p>To prove that it does actually work, here is a chain of functions with varying types. We take in a <code>String</code>, <code>read</code> it into an <code>Int</code>, add one to it, convert it to a <code>Float</code>, then divide it by 2.</p>\n\n<pre><code>chain :: ShowTAS String Float\nchain = Showoff read :-&gt; plusOne :-&gt; toFloat :-&gt; divideTwo :-&gt; End\n\n    where plusOne :: Showoff Int Int\n          plusOne = Showoff (+1)\n\n          toFloat :: Showoff Int Float\n          toFloat = Showoff fromIntegral\n\n          divideTwo :: Showoff Float Float\n          divideTwo = Showoff (/2)\n\nghci&gt; showSteps chain \"4\"\n\"4\"\n4\n5\n5.0\n2.5\n2.5  -- this last one is not from a traceShow call, it's just ghci printing the result\n</code></pre>\n\n<p>Fun!</p>\n"}, {"comments": [{"owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "edited": false, "score": 0, "creation_date": 1444513829, "post_id": 33059029, "comment_id": 53938493, "body": "Is there a function that does <code>(\\ x -&gt; trace msg x )</code>? The function <code>traceId</code> is oddly returning <code>msg</code> itself. Why would anyone want to do that?"}, {"owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "edited": false, "score": 0, "creation_date": 1444514459, "post_id": 33059029, "comment_id": 53938633, "body": "I asked the above question <a href=\"http://stackoverflow.com/questions/33059378/why-does-traceid-return-the-message-string-itself\">here</a>."}, {"owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "reply_to_user": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "edited": false, "score": 1, "creation_date": 1444571900, "post_id": 33059029, "comment_id": 53950444, "body": "@trVoldemort You can eta reduce that to <code>(trace msg)</code>"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 7, "last_activity_date": 1444511372, "creation_date": 1444511372, "answer_id": 33059029, "question_id": 33058924, "link": "https://stackoverflow.com/questions/33058924/whats-a-shorter-way-of-writing-x-traceshow-x-x/33059029#33059029", "title": "What&#39;s a shorter way of writing `(\\ x -&gt; traceShow x x )`?", "body": "<p>Just use <a href=\"http://hackage.haskell.org/package/base-4.8.1.0/docs/Debug-Trace.html#v:traceShowId\"><code>traceShowId</code></a>! It does exactly what you're asking for.</p>\n\n<pre><code>my . super . cool . traceShowId . fUnCtIoN . chain $ value\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": false, "score": 2, "last_activity_date": 1444512703, "last_edit_date": 1444512703, "creation_date": 1444512035, "answer_id": 33059107, "question_id": 33058924, "link": "https://stackoverflow.com/questions/33058924/whats-a-shorter-way-of-writing-x-traceshow-x-x/33059107#33059107", "title": "What&#39;s a shorter way of writing `(\\ x -&gt; traceShow x x )`?", "body": "\n\n<p>How about a helper function for adding a trace call to a function:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>dbg :: Show a =&gt; String -&gt; a -&gt; a\ndbg name x = trace (name ++ \": \" ++ show x) x\n\nmain = do\n  let x = dbg \"my\"    . my\n        . dbg \"super\" . super\n        . dbg \"cool\"  . cool\n        . dbg \"func\"  . fUnCtIoN\n        . dbg \"chain\" . chain\n        $ value\n  print x\n\nmy       = (+1)\nsuper    = (+2)\ncool     = (+3)\nfUnCtIoN = (+4)\nchain    = (+5)\nvalue = 3\n</code></pre>\n\n<p>Output:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>chain: 3\nfunc: 8\ncool: 12\nsuper: 15\nmy: 17\n18\n</code></pre>\n"}], "owner": {"reputation": 5447, "user_id": 667027, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/2cc242c4ce73c7e429f9f86f262d1844?s=128&d=identicon&r=PG", "display_name": "xzhu", "link": "https://stackoverflow.com/users/667027/xzhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 33059029, "answer_count": 4, "score": 3, "last_activity_date": 1464192099, "creation_date": 1444510741, "last_edit_date": 1444512352, "question_id": 33058924, "link": "https://stackoverflow.com/questions/33058924/whats-a-shorter-way-of-writing-x-traceshow-x-x", "title": "What&#39;s a shorter way of writing `(\\ x -&gt; traceShow x x )`?", "body": "\n\n<p>Printing the value of an expression is a common practice in debugging. For example, if I have a piece of code like this</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>my . super . cool . fUnCtIoN . chain $ value\n</code></pre>\n\n<p>and I am trying to see the output of <code>fUnCtIoN . chain</code>, I would add</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>my . super . cool . (\\ x -&gt; traceShow x x ) . fUnCtIoN . chain $ value\n</code></pre>\n\n<p>which is mouthful for a simple task like this, not to mention if I want to print many intermediate results:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>(\\ x -&gt; traceShow x x )\n    . my\n    . (\\ x -&gt; traceShow x x )\n    . super\n    . (\\ x -&gt; traceShow x x )\n    . cool\n    . (\\ x -&gt; traceShow x x )\n    . fUnCtIoN\n    . (\\ x -&gt; traceShow x x )\n    . chain\n    $ value\n</code></pre>\n\n<p>It would just look awful. Is there a better way to do this?</p>\n"}, {"tags": ["haskell", "gcc", "yesod", "haskell-stack"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444512366, "post_id": 33057924, "comment_id": 53938150, "body": "You might need to install gcc. I don&#39;t know if Stack comes with that on Windows (most Linux boxes already have it)."}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1444538613, "post_id": 33057924, "comment_id": 53942682, "body": "gcc is shipped with GHC itself on Windows. This includes installations via GHC"}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444540512, "post_id": 33061602, "comment_id": 53942983, "body": "What a strange OS limitation!"}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1444549349, "post_id": 33061602, "comment_id": 53944518, "body": "Wait till you hear that filepaths are limited to 260 characters, unless of course your prefix them with the highly intuitive <code>\\\\?\\</code>."}, {"owner": {"reputation": 51, "user_id": 5430197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rPZIl.png?s=128&g=1", "display_name": "rere", "link": "https://stackoverflow.com/users/5430197/rere"}, "edited": false, "score": 0, "creation_date": 1444575772, "post_id": 33061602, "comment_id": 53951638, "body": "I tried but still got the same error.   1. I deleted all the stack folders to clear the environment.   2. I unzipped &quot;stack-0.1.5.0-x86_64-windows.zip&quot; to &quot;C:\\stack_root&quot;.   3. I set &quot;STACK_ROOT=c:\\stack_root&quot; in the system environment variable.   4. I opened the command prompt and move to &quot;C:\\&quot; to create the project under &quot;C:\\&quot;   5. I executed &quot;stack new my-project yesod-sqlite &amp;&amp; cd my-project&quot;.   6. I executed &quot;stack install yesod-bin cabal-install --install-ghc&quot;.   7. I executed &quot;stack build&quot;.      Then, I got the same error. Did I miss any steps?"}, {"owner": {"reputation": 51, "user_id": 5430197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rPZIl.png?s=128&g=1", "display_name": "rere", "link": "https://stackoverflow.com/users/5430197/rere"}, "edited": false, "score": 0, "creation_date": 1444576387, "post_id": 33061602, "comment_id": 53951789, "body": "The error said  <code>ghc.exe: could not execute: C:\\Users\\xxxxx\\AppData\\Local\\Programs\\stack\\x86_64-windows\\g&zwnj;&#8203;hc-7.10.2\\lib&#47;..&#47;min&zwnj;&#8203;gw&#47;bin&#47;gcc.exe</code>."}, {"owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "edited": false, "score": 0, "creation_date": 1444576696, "post_id": 33061602, "comment_id": 53951867, "body": "There&#39;s no guarantee that this will solve the problem. <i>However</i>: are you certain that the STACK_ROOT environment variable change actually affected the command window you were using?"}, {"owner": {"reputation": 51, "user_id": 5430197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rPZIl.png?s=128&g=1", "display_name": "rere", "link": "https://stackoverflow.com/users/5430197/rere"}, "edited": false, "score": 0, "creation_date": 1444578195, "post_id": 33061602, "comment_id": 53952255, "body": "Yes. I did <code>echo %STACK_ROOT%</code> and got &#39;C:\\stack_root&#39; before I executed <code>stack build</code>. Also, I added &#39;C:\\stack_root&#39; to PATH environment variable. I did <code>echo %PATH%</code> and the result contained &#39;&#39;C:\\stack_root&#39;."}, {"owner": {"reputation": 1323, "user_id": 774493, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/ab18110403f01ae3773cf850239806b3?s=128&d=identicon&r=PG", "display_name": "parker.sikand", "link": "https://stackoverflow.com/users/774493/parker-sikand"}, "edited": false, "score": 0, "creation_date": 1447421932, "post_id": 33061602, "comment_id": 55159372, "body": "I have the same problem. I tried the <code>STACK_ROOT</code> thing, but it is not changing where the compiler is looking for <code>gcc.exe</code>. There was stuff created in the new stack root folder, but the main installation is still in the same place."}], "tags": [], "owner": {"reputation": 30377, "user_id": 369198, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/71596bb1ca3ba3aa4400c3f407baec9f?s=128&d=identicon&r=PG", "display_name": "Michael Snoyman", "link": "https://stackoverflow.com/users/369198/michael-snoyman"}, "is_accepted": false, "score": 1, "last_activity_date": 1444538549, "creation_date": 1444538549, "answer_id": 33061602, "question_id": 33057924, "link": "https://stackoverflow.com/questions/33057924/ghc-could-not-execute-gcc-exe-in-yesod-installation/33061602#33061602", "title": "GHC could not execute gcc.exe in Yesod Installation", "body": "<p>This is caused by the argument length limit on Windows. Starting in GHC 7.10.3, GHC will support response files for sending linker arguments in order to bypass this limitation. In the meanwhile, a workaround is to manually make the path to your stack root shorter by setting the STACK_ROOT environment variable.</p>\n\n<p>For more information, see <a href=\"https://www.fpcomplete.com/blog/2015/08/stack-ghc-windows\" rel=\"nofollow\">https://www.fpcomplete.com/blog/2015/08/stack-ghc-windows</a></p>\n"}], "owner": {"reputation": 51, "user_id": 5430197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rPZIl.png?s=128&g=1", "display_name": "rere", "link": "https://stackoverflow.com/users/5430197/rere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 371, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1444538549, "creation_date": 1444504258, "question_id": 33057924, "link": "https://stackoverflow.com/questions/33057924/ghc-could-not-execute-gcc-exe-in-yesod-installation", "title": "GHC could not execute gcc.exe in Yesod Installation", "body": "<p>I followed <a href=\"http://www.yesodweb.com/page/quickstart\" rel=\"nofollow\">\"Yesod quick start guide\"</a> to install Yesod in Windows 10.\nBut, when I issued the <code>stack build</code> command, it failed.</p>\n\n<h3>Environment</h3>\n\n<ul>\n<li>Windows 10 (64bits)</li>\n<li><code>stack-0.1.5</code> (for Windows10 64bits)</li>\n<li>No Haskell Platform</li>\n</ul>\n\n<p>I executed these commands</p>\n\n<ol>\n<li>stack new my-project yesod-sqlite &amp;&amp; cd my-project</li>\n<li>stack install yesod-bin cabal-install --install-ghc</li>\n<li>stack setup</li>\n<li>stack build &lt;--- the error occured</li>\n</ol>\n\n<p>In 'stack build' command, the package installations were done. But, when it build the project, the error occured.</p>\n\n<h3>Command Prompt</h3>\n\n<pre><code>&gt;stack build\n\nSetting codepage to UTF-8 (65001) to ensure correct output from GHC\nmy-project-0.0.0: build\nPreprocessing library my-project-0.0.0...\nIn-place registering my-project-0.0.0...\nPreprocessing executable 'my-project' for my-project-0.0.0...\nLinking .stack-work\\dist\\x86_64-windows\\Cabal-1.22.4.0\\build\\my-project\\my-project.exe ...\nghc.exe: could not execute: C:\\Users\\xxxxx\\AppData\\Local\\Programs\\stack\\x86_64-windows\\ghc-7.10.2\\lib/../mingw/bin/gcc.exe\n\n--  While building package my-project-0.0.0 using:\n      C:\\Users\\xxxxx\\AppData\\Roaming\\local\\bin\\stack-0.1.5.0\\setup-exe-cache\\setup-Simple-Cabal-1.22.4.0-x86_64-windows-ghc-7.10.2.exe --builddir=.stack-work\\dist\\x86_64-windows\\Cabal-1.22.4.0\\ build lib:my-project exe:my-project --ghc-options  -ddump-hi -ddump-to-file\n    Process exited with code: ExitFailure 1\n</code></pre>\n"}, {"tags": ["haskell", "parsec"], "answers": [{"comments": [{"owner": {"reputation": 653, "user_id": 1589512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99c377c5d122f33e6d79298fce14a627?s=128&d=identicon&r=PG", "display_name": "mandark", "link": "https://stackoverflow.com/users/1589512/mandark"}, "edited": false, "score": 4, "creation_date": 1444502415, "post_id": 33057582, "comment_id": 53935093, "body": "But in my case the first parser does not succeed. It is activated since the first character matches, but fails afterwards as it doesn&#39;t find the next expected character. I expect that the next parser should be activated but that doesn&#39;t happen as you can see from the output I have pasted."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 653, "user_id": 1589512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99c377c5d122f33e6d79298fce14a627?s=128&d=identicon&r=PG", "display_name": "mandark", "link": "https://stackoverflow.com/users/1589512/mandark"}, "edited": false, "score": 0, "creation_date": 1444502507, "post_id": 33057582, "comment_id": 53935127, "body": "@mandark This is because of how parsec works. I&#39;ll edit."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444502722, "post_id": 33057582, "comment_id": 53935183, "body": "More surprisingly, I&#39;ve seen <code>attoparsec</code> parsers that can succeed or fail depending on the order of arguments to <code>&lt;|&gt;</code>. I&#39;ll have to ask my own question about that."}, {"owner": {"reputation": 136, "user_id": 3880977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43aed8b7d334a374dd7949f755355bab?s=128&d=identicon&r=PG&f=1", "display_name": "skainswo", "link": "https://stackoverflow.com/users/3880977/skainswo"}, "edited": false, "score": 0, "creation_date": 1608705082, "post_id": 33057582, "comment_id": 115659939, "body": "&quot;Read carefully:&quot;  I don&#39;t think that segment of the docs is clear at all."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1444503512, "last_edit_date": 1444503512, "creation_date": 1444502163, "answer_id": 33057582, "question_id": 33057481, "link": "https://stackoverflow.com/questions/33057481/why-does-it-seem-that-the-parsec-choice-operator-depends-on-order-of-the-parsers/33057582#33057582", "title": "Why does it seem that the Parsec Choice operator depends on order of the parsers?", "body": "<p>Read carefully:</p>\n\n<blockquote>\n  <p>[The choice operator] tries the first parser, then if it fails, tries\n  the second. If either succeeds, then it returns the value returned by\n  that parser..</p>\n</blockquote>\n\n<p>This implies that the first parser is tried first, and if it succeeds, the second parser is NOT tried at all! This means that the first parser has a higher priority, so <code>&lt;|&gt;</code> is not commutative, in general.</p>\n\n<p>A simple counterexample can be crafted with some always-succeeding parsers, e.g.</p>\n\n<pre><code>dummy :: Parser Bool\ndummy = return True &lt;|&gt; return False\n</code></pre>\n\n<p>The above is equivalent to <code>return True</code>: since the first succeeds, the second is immaterial.</p>\n\n<hr>\n\n<p>On top of that, parsec is designed to commit early on the first branch when that has successfully consumed some input. This design sacrifices perfect nondeterminism for efficiency. Otherwise, parsec would often need to keep in memory all the file being parsed, because if a parse error happens, some new alternative needs to be tried.</p>\n\n<p>For instance,</p>\n\n<pre><code>p = (char 'a' &gt;&gt; char 'b' &gt;&gt; ...) &lt;|&gt;\n    (char 'a' &gt;&gt; char 'c' &gt;&gt; ...)\n</code></pre>\n\n<p>will not work as one might expect. As soon as <code>'a'</code> is consumed successfully by the first branch, parsec commits on it. This means that if <code>'c'</code> follows, then the first branch will fail but it's too late for the second one to be tried. The whole parser simply fails.</p>\n\n<p>To solve this one can factor out the common prefix, e.g.</p>\n\n<pre><code>p = char 'a' &gt;&gt; ( (char 'b' &gt;&gt; ...) &lt;|&gt; (char 'c' &gt;&gt; ...) )\n</code></pre>\n\n<p>or resort to <code>try</code>,</p>\n\n<pre><code>p = (try (char 'a' &gt;&gt; char 'b') &gt;&gt; ...) &lt;|&gt;\n    (char 'a' &gt;&gt; char 'c' &gt;&gt; ...)\n</code></pre>\n\n<p><code>try</code> basically tells parsec not to commit to the branch until the whole parser under <code>try</code> succeeds. If abused, it can cause parsec to keep in memory a large portion of the file, but the user at least has some control on that. Theoretically, perfect nondeterminism can be recovered by always adding <code>try</code> to the whole left branch of <code>&lt;|&gt;</code>. This however is not recommended, since it prods the programmer into writing an inefficient parser, both because of the memory issue and the fact that one can easily write a grammar requiring an exponential number of backtracks to successfully parse.</p>\n"}, {"tags": [], "owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "is_accepted": true, "score": 7, "last_activity_date": 1444502978, "creation_date": 1444502978, "answer_id": 33057698, "question_id": 33057481, "link": "https://stackoverflow.com/questions/33057481/why-does-it-seem-that-the-parsec-choice-operator-depends-on-order-of-the-parsers/33057698#33057698", "title": "Why does it seem that the Parsec Choice operator depends on order of the parsers?", "body": "<p>Parsec has two kinds of \"failure\": there are failures that consume input, and failures that don't. To avoid backtracking (and therefore holding onto inputs longer than necessary/being generally unfriendly to the garbage collector), <code>(&lt;|&gt;)</code> commits to the first parser as soon as it consumes input; so that if its first argument consumes input and fails, its second parser never gets a chance to succeed. You can explicitly request backtracking behavior with <code>try</code>, thus:</p>\n\n<pre><code>Text.Parsec&gt; parse (string \"ab\" &lt;|&gt; string \"ac\") \"\" \"ac\"\nLeft (line 1, column 1):\nunexpected \"c\"\nexpecting \"ab\"\nText.Parsec&gt; parse (try (string \"ab\") &lt;|&gt; string \"ac\") \"\" \"ac\"\nRight \"ac\"\n</code></pre>\n\n<p>Unfortunately, <code>try</code> has some pretty annoying performance penalties, which means that if you want a performant parser, you will have to refactor your grammar a bit. I would do that with the above parser this way:</p>\n\n<pre><code>Text.Parsec&gt; parse (char 'a' &gt;&gt; ((\"ab\" &lt;$ char 'b') &lt;|&gt; (\"ac\" &lt;$ char 'c'))) \"\" \"ac\"\nRight \"ac\"\n</code></pre>\n\n<p>In your case, you will need to factor out the \"#\" mark similarly.</p>\n"}], "owner": {"reputation": 653, "user_id": 1589512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99c377c5d122f33e6d79298fce14a627?s=128&d=identicon&r=PG", "display_name": "mandark", "link": "https://stackoverflow.com/users/1589512/mandark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 870, "favorite_count": 0, "closed_date": 1444504551, "accepted_answer_id": 33057698, "answer_count": 2, "score": 7, "last_activity_date": 1444503512, "creation_date": 1444501514, "question_id": 33057481, "link": "https://stackoverflow.com/questions/33057481/why-does-it-seem-that-the-parsec-choice-operator-depends-on-order-of-the-parsers", "closed_reason": "Duplicate", "title": "Why does it seem that the Parsec Choice operator depends on order of the parsers?", "body": "<p>I am trying to parse a very simple language that consists of only decimal or binary numbers. For example, here are some valid inputs:</p>\n\n<pre><code>#b1\n#d1\n#b0101\n#d1234\n</code></pre>\n\n<p>I am having a problem using Parsec's choice operator: <code>&lt;|&gt;</code>. According to the tutorial: <a href=\"https://en.wikibooks.org/wiki/Write_Yourself_a_Scheme_in_48_Hours/Parsing\">Write yourself a Scheme in 48 hours</a>:</p>\n\n<blockquote>\n  <p>[The choice operator] tries the first parser, then if it fails, tries the second. If either succeeds, then it returns the value returned by that parser..</p>\n</blockquote>\n\n<p>But in my experience, I see that the order of the parsers supplied matters. Here is my program:</p>\n\n<pre><code>import System.Environment\nimport Text.ParserCombinators.Parsec\n\nmain :: IO ()\nmain = do\n  (x:_) &lt;- getArgs \n  putStrLn ( \"Hello, \" ++ readExp x)\n\nbin :: Parser String\nbin = do string \"#b\"\n         x &lt;- many( oneOf \"01\")\n         return x\n\ndec :: Parser String\ndec = do string \"#d\"\n         x &lt;- many( oneOf \"0123456789\")\n         return x\n\n-- Why does order matter here?\nparseExp = (bin &lt;|&gt; dec) \n\nreadExp :: String -&gt; String\nreadExp input = case parse parseExp \"test\" input of\n                      Left error -&gt; \"Error: \" ++ show error\n                      Right val  -&gt; \"Found val\" ++ show val \n</code></pre>\n\n<p>Here is how I am running the program:</p>\n\n<h1>Installing dependencies</h1>\n\n<pre><code>$ cabal sandbox init\n$ cabal install parsec\n</code></pre>\n\n<h1>Compiling</h1>\n\n<pre><code>$ cabal exec ghc Main\n</code></pre>\n\n<h1>Run</h1>\n\n<pre><code>$ ./Main \"#d1\"\nHello, Error: \"test\" (line 1, column 1):\nunexpected \"d\"\nexpecting \"#b\"\n\n$ ./Main \"#b1\"\nHello, Found val\"1\"\n</code></pre>\n\n<p>If I change the order of the parsers as follows:</p>\n\n<pre><code>parseExp = (dec &lt;|&gt; bin) \n</code></pre>\n\n<p>then only binary numbers are detected and the program fails to identify the decimal numbers.</p>\n\n<p>With the tests that I have performed, I see this problem only happens when one of the parsers has started parsing an input e.g. if a hash character <code>#</code> is found, the bin parser is activated ending up in failing as the next character expected is <code>b</code> and not <code>d</code>. It seems like there should be some kind of backtracking that should happen, which I am not aware of.</p>\n\n<p>Appreciate the help!</p>\n"}, {"tags": ["html", "haskell", "design-patterns", "token", "matching"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 5431597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ce17a64d6d20ee6b4b506918d58cae8?s=128&d=identicon&r=PG&f=1", "display_name": "NORIFURIKAKE", "link": "https://stackoverflow.com/users/5431597/norifurikake"}, "edited": false, "score": 0, "creation_date": 1444506941, "post_id": 33057469, "comment_id": 53936558, "body": "Thanks, you&#39;re a live saver! Yeah I&#39;m not allowed to use any libraries for this, and my knowledge of Haskell can be summed up with the 5 minute tutorial on their site and a bit of readings on pattern matching. Cheers!"}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 1, "last_activity_date": 1444507162, "last_edit_date": 1444507162, "creation_date": 1444501427, "answer_id": 33057469, "question_id": 33057248, "link": "https://stackoverflow.com/questions/33057248/lexer-in-haskell-how-to-pattern-match-specific-case/33057469#33057469", "title": "Lexer in Haskell - How to Pattern Match specific case?", "body": "<p>First note that the idiomatic way to approach such a task in Haskell is to use a <em>parser combinator library</em>, such as <a href=\"http://hackage.haskell.org/package/parsec\" rel=\"nofollow\">parsec</a>. <sub>(It may make sense to go the traditional parser/lexer route for some applications, but this isn't really something you should code by hand &ndash; use a lexer <em>generator</em>, i.e. <a href=\"https://www.haskell.org/alex/\" rel=\"nofollow\">alex</a>.)</sub></p>\n\n<p>Now, if you determined to do this by hand, and without more expressive parser combinators... you'll need to handle that special case in <code>lexDigit</code>, rather than <code>lexString</code>:</p>\n\n<pre><code>lexDigit :: String -&gt; [Token] -- Always use type signatures!\nlexDigit cs\n  | (\"000...\",s2) &lt;- splitAt 6 cs  = Zero : lexer s2\nlexDigit cs = ... -- your original definition of `lexDigit`\n\nlexString :: String -&gt; [Token]\nlexString cs = case s1 of\n  \"if\"   -&gt; IfToken : lexer s2 \n  \"else\" -&gt; ElseToken : lexer s2 \n  \"then\" -&gt; ThenToken : lexer s2\n  -- no clause for \"000...\", since it can't happen here anyway\n  _      -&gt; StringToken s1 : lexer s2 \n where (s1,s2) = (span isAlphaNum cs)\n\nlexer :: String -&gt; [Token]\nlexer cs@(c:cs')\n  | isSpace c    = lexer cs'\n  | isDigit c    = lexDigit cs\n  | isAlphaNum c = lexString cs\n  | otherwise    = InvalidToken c : lexer cs'\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 5431597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7ce17a64d6d20ee6b4b506918d58cae8?s=128&d=identicon&r=PG&f=1", "display_name": "NORIFURIKAKE", "link": "https://stackoverflow.com/users/5431597/norifurikake"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 469, "favorite_count": 0, "accepted_answer_id": 33057469, "answer_count": 1, "score": 0, "last_activity_date": 1444507162, "creation_date": 1444500111, "question_id": 33057248, "link": "https://stackoverflow.com/questions/33057248/lexer-in-haskell-how-to-pattern-match-specific-case", "title": "Lexer in Haskell - How to Pattern Match specific case?", "body": "<p>I'm currently working on a lexer written in Haskell, and am almost finished, but am running into a problem for a special case token. Currently, my lexer takes an input string and breaks down the statement into tokens for numbers, variable names, and specific tokens such as \"if\", \"else\", and \"then\". </p>\n\n<p>It works great for all of my tokens, except for one that is \"000...\". </p>\n\n<p>I was taught to use the span function, so I have my lexer use the isDigit and isAlphaNum boolean functions to parse the input. However, because \"000...\" starts with a zero, it automatically returns as a number. Additionally, the period is a token in the grammar as well, so the result of inputting \"000...\" in my lexer currently results in \"0\" \".\" \".\" \".\". </p>\n\n<p>I'm not proficient in the language of Haskell, but is it possible to match a string using isPrint, and use cases to handle instances of strings and integers? I'm at a loss for words right now, and it seems everything I have tried broke my program. My current pattern matching part looks like this:</p>\n\n<pre><code>lexer (c:cs)\n| isSpace c = lexer cs\n| isDigit c = lexDigit (c:cs)\n| isAlphaNum c = lexString (c:cs)\n| True = InvalidToken c : lexer cs\n\nlexString \n| s1 == \"if\" = IfToken : lexer s2 \n| s1 == \"else\" = ElseToken : lexer s2 \n| s1 == \"then\" = ThenToken : lexer s2 \n| s1 == \"000...\" = Zero : lexer s2\n| True = StringToken s1 : lexer s2 \nwhere (s1,s2) = (span isAlphaNum cs)\n</code></pre>\n\n<p>Any help is appreicated!</p>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 1, "creation_date": 1444499829, "post_id": 33057111, "comment_id": 53934310, "body": "This question is too broad. You might try another tutorial or haskell book that explains <code>IO</code> in a different way that makes more sense to you."}, {"owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "reply_to_user": {"reputation": 15757, "user_id": 176841, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/45a168cb9eb8454d66c78f18e29d9342?s=128&d=identicon&r=PG", "display_name": "jberryman", "link": "https://stackoverflow.com/users/176841/jberryman"}, "edited": false, "score": 2, "creation_date": 1444500232, "post_id": 33057111, "comment_id": 53934451, "body": "The accepted answer to the question @jberryman suggested is a nicer explanation than the one in terms of taints that you quoted. To it, we might also add that when you do <code>name &lt;- getLine</code> and then use <code>name</code> elsewhere in the do-block you are specifying what <i>will</i> be done with the value obtained through <code>getLine</code>, whatever it turns out to be, once the recipe it specifies is executed."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 3, "creation_date": 1444502820, "post_id": 33057111, "comment_id": 53935220, "body": "I will be a bit more blunt than others. The paragraph you quoted is not a good way to think about <code>IO</code>. (How would you understand <code>[IO a]</code> or <code>IO a -&gt; IO b</code> or <code>IO (IO a)</code> in this model?) You should find a different explanation of what the <code>IO</code> type constructor means."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1444500288, "last_edit_date": 1444500288, "creation_date": 1444499948, "answer_id": 33057228, "question_id": 33057111, "link": "https://stackoverflow.com/questions/33057111/pure-code-and-impure-code-i-o-data-type-related/33057228#33057228", "title": "pure code and impure code? I/O data type related", "body": "<p>The paragraph hints to the fact that you can't use <code>getLine</code> in a function which has a \"pure\" type, without the <code>IO</code> monad occurring in it. E.g. if we try to run</p>\n\n<pre><code>lineLength :: Int -&gt; Int\nlineLength n = n + length getLine\n</code></pre>\n\n<p>the compiler will complain because <code>length</code> expects a <code>String</code> (or any other list type) but <code>getLine</code> is an <code>IO String</code>. So there's a type mismatch.</p>\n\n<p>But this does not mean that <code>length</code> and <code>getLine</code> can not be composed: here's how</p>\n\n<pre><code>lineLength :: Int -&gt; IO Int\nlineLength n = do\n    line &lt;- getLine\n    return (n + length line)\n</code></pre>\n\n<p>Above we temporarily \"remove the <code>IO</code>\" since <code>line :: String</code>, so that <code>length</code> can be applied to it, and <code>n</code> added to the result. However, then we are forced to use <code>return</code> to transform a pure <code>Int</code> result into an <code>IO Int</code>.</p>\n\n<p>Notice how the <code>IO</code> also ends up in the function signature: this is unavoidable.\nIn Haskell, if a function does impure things such as using <code>IO</code>, then the type system forces you to use <code>IO</code> in the type. This is the \"taint\" the quote is referring to: once you use an impure function/value with an <code>IO</code> type, then you have to use <code>IO</code> in the type of your own code, and any caller of that in turn will have to use <code>IO</code>. Impurity must be propagated in the type signatures.</p>\n\n<p>This also means that if you see <code>f :: Int -&gt; Int</code>, you can rely one the fact that the compiler proved the function to be pure: it will return the same result for the same input. (There are a few low-level ways to circumvent this, but they are not meant to be used in regular code.)</p>\n"}], "owner": {"reputation": 906, "user_id": 5299539, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/9f41c4053ec442fe9d5fa1e2b2e19c6f?s=128&d=identicon&r=PG&f=1", "display_name": "Charana", "link": "https://stackoverflow.com/users/5299539/charana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "closed_date": 1444997220, "answer_count": 1, "score": 0, "last_activity_date": 1444501512, "creation_date": 1444499330, "last_edit_date": 1444501512, "question_id": 33057111, "link": "https://stackoverflow.com/questions/33057111/pure-code-and-impure-code-i-o-data-type-related", "closed_reason": "Duplicate", "title": "pure code and impure code? I/O data type related", "body": "<pre><code>name &lt;- getLine\n</code></pre>\n\n<p>The following paragraph is about how the line works. Can someone explain to me what this means? Thank you in advance.</p>\n\n<blockquote>\n  <p>getLine is in a sense impure because its result value is not\n  guaranteed to be the same when performed twice. That's why it's sort\n  of tainted with the IO type constructor and we can only get that data\n  out in I/O code. And because I/O code is tainted too, any computation\n  that depends on tainted I/O data will have a tainted result.</p>\n  \n  <p>When I say tainted, I don't mean tainted in such a way that we can\n  never use the result contained in an I/O action ever again in pure\n  code. No, we temporarily un-taint the data inside an I/O action when\n  we bind it to a name. When we do name &lt;- getLine, name is just a\n  normal string, because it represents what's inside the box. </p>\n</blockquote>\n"}, {"tags": ["haskell", "dynamic", "vector", "monads"], "comments": [{"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1444497199, "post_id": 33056539, "comment_id": 53933398, "body": "When recursive functions start eating up all your memory, that usually means they keep calling themselves without returning. You should, whenever possible, make them tail-recursive so they do not have this problem."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1444497593, "post_id": 33056539, "comment_id": 53933537, "body": "The <code>Control.Monad</code> package has <code>when</code> and <code>guard</code>, but my gut feeling here is that, if you\u2019re not comfortable with monads yet, that\u2019s not the best solution for you."}, {"owner": {"reputation": 1216, "user_id": 2682133, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/e6O9c.jpg?s=128&g=1", "display_name": "Hennes", "link": "https://stackoverflow.com/users/2682133/hennes"}, "reply_to_user": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1444497631, "post_id": 33056539, "comment_id": 53933552, "body": "In fact I tried this as well, so that the last call returned the complete result, but it still keeps eating up all the memory. Nevertheless I want to understand the dynamic approach as well. An example would be really helpful."}, {"owner": {"reputation": 12194, "user_id": 4474419, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04ce27f0ebe4713b51911cd8475c3b42?s=128&d=identicon&r=PG", "display_name": "Davislor", "link": "https://stackoverflow.com/users/4474419/davislor"}, "edited": false, "score": 0, "creation_date": 1444502167, "post_id": 33056539, "comment_id": 53935017, "body": "Were each of the intermediate calls tail-recursive as well?  If you write <code>f [] = &quot;&quot;</code> and <code>f (x:xs) = (show x) ++ (f xs)</code>, the runtime can\u2019t optimize any but the base case.  If you write,  <code>f xs = f&#39; xs []</code>, <code>f&#39; [] acc = acc</code> and <code>f&#39; (x:xs) acc = f&#39; xs (acc ++ (show x))</code>,  it can clean up all the temporaries."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444505660, "post_id": 33056539, "comment_id": 53936127, "body": "What &quot;dynamic approach&quot; do you mean?"}], "answers": [{"comments": [{"owner": {"reputation": 1216, "user_id": 2682133, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/e6O9c.jpg?s=128&g=1", "display_name": "Hennes", "link": "https://stackoverflow.com/users/2682133/hennes"}, "edited": false, "score": 0, "creation_date": 1444498620, "post_id": 33056895, "comment_id": 53933899, "body": "A sequence sounds great. There are so many classes to explore... Is there a kind of table or map with all that useful classes grouped by function?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 1216, "user_id": 2682133, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/e6O9c.jpg?s=128&g=1", "display_name": "Hennes", "link": "https://stackoverflow.com/users/2682133/hennes"}, "edited": false, "score": 0, "creation_date": 1444498955, "post_id": 33056895, "comment_id": 53934016, "body": "@Hennes, for <i>classes</i> (not relevant here), there&#39;s Typeclassopedia. For basic libraries, you might want to look at what&#39;s included in the Haskell Platform, whether or not you actually decide to <i>install</i> the Platform."}, {"owner": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "edited": false, "score": 1, "creation_date": 1444551118, "post_id": 33056895, "comment_id": 53944875, "body": "Shouldn&#39;t we use a set? How can we filter out duplicates with a queue?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 7558, "user_id": 448496, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/BZtrd.png?s=128&g=1", "display_name": "rubik", "link": "https://stackoverflow.com/users/448496/rubik"}, "edited": false, "score": 0, "creation_date": 1444551738, "post_id": 33056895, "comment_id": 53945010, "body": "@rubik, good point! We should probably have both, using the set to represent the visited list and using it to filter which things are added to the queue."}, {"owner": {"reputation": 1216, "user_id": 2682133, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/e6O9c.jpg?s=128&g=1", "display_name": "Hennes", "link": "https://stackoverflow.com/users/2682133/hennes"}, "edited": false, "score": 0, "creation_date": 1444573424, "post_id": 33056895, "comment_id": 53950935, "body": "Come on, don&#39;t let me fall on my knees begging for a simple working example for this task. I really spent this entire day googling for some help but found nothing. It would help me a lot to understand all this."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 1216, "user_id": 2682133, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/e6O9c.jpg?s=128&g=1", "display_name": "Hennes", "link": "https://stackoverflow.com/users/2682133/hennes"}, "edited": false, "score": 0, "creation_date": 1444576513, "post_id": 33056895, "comment_id": 53951815, "body": "@Hennes, last night I was out a-wooing, and I have plans this afternoon. Perhaps this evening I&#39;ll have time. You may want to check out the #haskell IRC channel for live help."}, {"owner": {"reputation": 1216, "user_id": 2682133, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/e6O9c.jpg?s=128&g=1", "display_name": "Hennes", "link": "https://stackoverflow.com/users/2682133/hennes"}, "edited": false, "score": 0, "creation_date": 1444746118, "post_id": 33056895, "comment_id": 54025242, "body": "Seems to be a lot more difficult than expected, huh?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 1216, "user_id": 2682133, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/e6O9c.jpg?s=128&g=1", "display_name": "Hennes", "link": "https://stackoverflow.com/users/2682133/hennes"}, "edited": false, "score": 0, "creation_date": 1444747453, "post_id": 33056895, "comment_id": 54026224, "body": "@Hennes, nope. Just haven&#39;t had a chance to work it up."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 1, "last_activity_date": 1444498220, "creation_date": 1444498220, "answer_id": 33056895, "question_id": 33056539, "link": "https://stackoverflow.com/questions/33056539/dynamic-programming-with-vectors-in-haskell/33056895#33056895", "title": "Dynamic Programming with Vectors in Haskell", "body": "<p>The natural data structure for your <code>toVisitList</code> is a <em>queue</em>. There are a few implementations of queues around, but for this purpose, the simplest thing is to just use <code>Data.Sequence.Seq</code>. This lets you add things to the end with <code>|&gt;</code> or <code>&lt;&gt;</code>, and to view the beginning with <code>viewl</code>. Consider something like</p>\n\n<pre><code>crawlOnce :: Seq Url -&gt; [Url] -&gt; IO (Either [Url] (Seq Url, [Url]))\n</code></pre>\n\n<p><code>crawlOnce toVisitList visitedList</code> uses <code>viewl</code> to look at the front of the list of URLs to visit. If it's empty, it returns <code>Left visitedList</code>. Otherwise, it visits the first URL, appends it to the visited list, and adds the newly discovered URLS to the list to visit, then wraps them up in <code>Right</code>.</p>\n\n<p>There are several reasonable variations. For instance, you could go for a type like <code>ExceptT [Url] (StateT (Seq Url, [Url]) IO) a</code> that \"throws\" its final result.</p>\n"}], "owner": {"reputation": 1216, "user_id": 2682133, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/e6O9c.jpg?s=128&g=1", "display_name": "Hennes", "link": "https://stackoverflow.com/users/2682133/hennes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 177, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1444544038, "creation_date": 1444496189, "last_edit_date": 1444544038, "question_id": 33056539, "link": "https://stackoverflow.com/questions/33056539/dynamic-programming-with-vectors-in-haskell", "title": "Dynamic Programming with Vectors in Haskell", "body": "<p>I'm trying to code a kind of a simple web crawler in haskell just for practice. To my own astonishment neither the web request itself nor parsing the web site was any complicated. \nI coded the program purely functional with a recursive function, but only some fourty or fifty web requests later, the program eats up all the memory.</p>\n\n<p>So I tried to do the task with dynamic programming, but here I'm totally stuck, which means, I have no idea where to begin. In this tiny program I got so many errors, that I'm not able to figure out, where to start. </p>\n\n<p>This is my current concept:</p>\n\n<pre><code>scanPage :: String -&gt; IO (String,String,[String])\nscanPage url = ....\n\ncrawler :: String -&gt; IO [(String, Int)]\ncrawler startUrl = runST $ do\n    toVisit &lt;- newSTRef [startUrl] :: ST s (STRef s [String])\n    visited &lt;- newSTRef [] :: ST s (STRef s [String])\n    result  &lt;- newSTRef [] :: ST s (STRef s [(String, Int)])\n    -- Iterate over urls to visit\n    while (liftM not $ liftM null $ readSTRef toVisit) $ do\n        url &lt;- fmap (head) (readSTRef toVisit)            \n        (moreUrls, value_a, value_b) &lt;- scanPage url\n        -- Mark page as visited\n        vis &lt;- readSTRef visited\n        writeSTRef visited (url : vis)\n        -- Add Results\n        res &lt;- readSTRef result\n        writeSTRef result ((value_a, value_b) : res)\n        -- Extend urls to visit\n        nextUrls &lt;- readSTRef toVisit\n        writeSTRef toVisit (nextUrls ++ (moreUrls \\\\ vis))\n    -- End of while\n    return =&lt;&lt; readSTRef result\n\nmain = do\n    putStrLn =&lt;&lt; fmap show (crawler \"http://starturl.com\")\n</code></pre>\n\n<p>I already wrote a lot of programs like this with arrays, which are much more convenient, as I can simply write or read from or to array elements. So I thought I could use mutable vectors for these lists, but they can't grow (at least in the same <em>instance</em>) or shrink. So I ended up with simple lists in STRef.</p>\n\n<p>The first line I can't get to work is the line with the <em>while</em> command. I wrote my own while function like this</p>\n\n<pre><code>while :: (Monad m) =&gt; m Bool -&gt; m a -&gt; m ()\nwhile cond action = do\n    c &lt;- cond\n    when c $ do\n        action\n        while cond action\n</code></pre>\n\n<p>because I couldn't find any other while command. I googled many days for mutable vectors, but was not able to find a single tutorial or even example that I could use here. Please, can anyone tell me, how to write a syntactical correct <em>crawler</em> function? Yes, a pure functional solution would be nicer and more \"haskellish\", but I'm considering me still as a beginner and all this monad-stuff is still a bit strange for me. I'm willing to learn, but a hint or even an example would be really awesome.</p>\n\n<p><strong>EDIT:</strong>\nHere comes some pseudocode of my messy code.</p>\n\n<pre><code>toVisitList = startURL\nvisitedList = []\nresultList = []\nwhile (length toVisitList /= 0) {\n    url = head toVisitList   -- Get the 1st element\n    toVisitList -= url       -- Remove this url from list\n    visitedList += url       -- Append url to visitedList\n    (moreUrls, val_a, val_b) = scanPage url\n    resultList += (val_a, val_b) -- append the result\n    toVisitList += (moreUrls - visitedList)\n}\nreturn resultList\n</code></pre>\n\n<p><strong>EDIT:</strong>\nI still haven't any clue, how to put this pseudocode into real code, especially the while-statement. Any hints appreciacted.</p>\n"}, {"tags": ["haskell", "lazy-evaluation"], "comments": [{"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1444487729, "post_id": 33055125, "comment_id": 53930302, "body": "@Heinrich Apfelmus: A question about the <a href=\"https://hackhands.com/lazy-evaluation-works-haskell/\" rel=\"nofollow noreferrer\">laziness tutorial</a>."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1444488537, "post_id": 33055125, "comment_id": 53930560, "body": "Well... one says &#39;the argument will not be evaluated, unless needed&#39; and the other one specifically says &#39;this WILL be evaluated to WHNF&#39;. In what way does this sound the same to you?"}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1444488749, "post_id": 33055125, "comment_id": 53930647, "body": "@Cubic: In every way, of or course; that&#39;s why I asked, clearly. (drip, drip) If you read the whole tutorial (with a beginners eyes, thanks), you&#39;ll see that &quot;needed&quot; is perhaps the critical but not explicitly elaborated distinction."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1444489504, "post_id": 33055125, "comment_id": 53930915, "body": "The first sentence fragment of your second quote is arguably ambiguous (does &quot;their topmost nodes&quot; refer to the single topmost node of each argument, or some indefinite quantity of nodes at the top of each argument? In fact, the latter.) But &quot;If the pattern is a simple variable, then the argument is not evaluated&quot; seems pretty explicit to me..."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "reply_to_user": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1444489618, "post_id": 33055125, "comment_id": 53930966, "body": "@ReidBarton: Yes, I&#39;m learning a lot about how things seem to others."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 3, "creation_date": 1444490720, "post_id": 33055125, "comment_id": 53931314, "body": "Maybe we just don&#39;t understand what your question is about? It&#39;s true that <code>seq</code> and the text&#39;s example of <code>(&amp;&amp;)</code> both reduce their first argument to WHNF. However this is not true of all Haskell function in general. For example <code>one x = 1</code> does not ever evaluate its argument at all. Similarly <code>notseq x y = y</code> does not ever evaluate <code>x</code> because doing so is not necessary to produce the value <code>y</code>."}], "answers": [{"comments": [{"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1444491074, "post_id": 33055462, "comment_id": 53931425, "body": "So is it correct to say (perhaps at the risk of oversimplifying) that the difference is that in general, evaluation happens only to the extent needed to find a pattern match, while <code>seq</code> first determines whether its first argument is not <code>\u22a5</code>, which will (generally, aways?) require further evaluation?"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1444492233, "post_id": 33055462, "comment_id": 53931756, "body": "@raxacoricofallapatorius, vaguely, at least. It forces things that it does not pattern match on, and in many cases <i>cannot</i> pattern match on."}, {"owner": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 0, "creation_date": 1444495253, "post_id": 33055462, "comment_id": 53932697, "body": "Can you expand upon on <code>primitive numerical operations</code> ? I don&#39;t think <code>let a = 2 * 3</code> forces evaluation."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 43759, "user_id": 1651941, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/a513bc1fa519d2fcf5e4e0d9b5500101?s=128&d=identicon&r=PG", "display_name": "Sibi", "link": "https://stackoverflow.com/users/1651941/sibi"}, "edited": false, "score": 1, "creation_date": 1444495471, "post_id": 33055462, "comment_id": 53932794, "body": "@Sibi, if <code>x * y</code> is forced, that forces <code>x</code> and also <code>y</code>."}], "tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 10, "last_activity_date": 1444551086, "last_edit_date": 1444551086, "creation_date": 1444489695, "answer_id": 33055462, "question_id": 33055125, "link": "https://stackoverflow.com/questions/33055125/how-is-haskells-seq-different-from-other-functions/33055462#33055462", "title": "How is Haskell&#39;s &#39;seq&#39; different from other functions?", "body": "<p>Without <code>seq</code>, <code>evaluate</code>, bang patterns, etc., the following rule applies:</p>\n\n<blockquote>\n  <p>All evaluation is driven directly by pattern matching, evaluation of <code>if</code> conditions, or primitive numerical operations.</p>\n</blockquote>\n\n<p>As it turns out, we can squint a bit and make <em>all</em> of those look like pattern matching:</p>\n\n<pre><code>if c then x else y\n=\ncase c of\n  True -&gt; x\n  False -&gt; y\n\nx &gt; y = case x of\n          0 -&gt; case y of ...\n\n0 + y = y\n1 + 1 = 2\n</code></pre>\n\n<p>etc. Ultimately, the thing being evaluated at any time is the very next primitive <code>IO</code> action the program will take, and everything else is just recursively driven by pattern matching.</p>\n\n<p>The left-to-right business means that, for instance,</p>\n\n<pre><code>foo False 'd' = ...\nfoo True _ = ...\n</code></pre>\n\n<p>is equivalent to</p>\n\n<pre><code>foo x y = case x of\n            False -&gt; case y of\n                       'd' -&gt; ...\n            True -&gt; ...\n</code></pre>\n\n<p>So if <code>foo</code> is applied to <code>True</code> and some other value, it doesn't bother forcing that value because it checks the left pattern first.</p>\n\n<p><code>seq</code>, when applied to data, acts just like a silly <code>case</code>. If <code>x :: Bool</code>, then</p>\n\n<pre><code>x `seq` y = case x of\n              True -&gt; y\n              False -&gt; y\n</code></pre>\n\n<p>But <code>seq</code> can, rather shadily, be applied to functions as well, or to things of unknown type. It offers a way to force evaluation of things <em>aside from</em> the usual chain of pattern matching.</p>\n\n<p>In the early days of Haskell, <code>seq</code> was a method of a <code>Seq</code> class, and this made good sense. Unfortunately, the implementers found it annoying to have to deal with that class when it was easier to just \"cheat\" and make <code>seq</code> work for everything. So they cheated, and certain aspects of program analysis and transformation have been harder ever since. </p>\n"}, {"comments": [{"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1444497974, "post_id": 33056377, "comment_id": 53933665, "body": "That makes sense, but how does it map to the second <code>case</code> statement in <a href=\"http://stackoverflow.com/a/33055462/656912\">defeuer&#39;s answer</a> \u2014 where is evaluation of <code>x</code> forced there?"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1444501119, "post_id": 33056377, "comment_id": 53934694, "body": "that&#39;s because pattern matching forces the evaluation of the first &quot;layer&quot; in the chain of unevaluated chunks. same with <code>seq</code> btw."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1444501362, "post_id": 33056377, "comment_id": 53934767, "body": "So both <code>case</code> statements evaluate their first argument? The two examples aren&#39;t don&#39;t exhibit different behavior with respect to their first arguments?"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1444513847, "post_id": 33056377, "comment_id": 53938500, "body": "I&#39;ve added a more elaborate example of how pattern matching forces the evaluation of different parts of a nested data structure."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1444573025, "post_id": 33056377, "comment_id": 53950820, "body": "Does <code>case x</code> force evaluation though?"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1444574088, "post_id": 33056377, "comment_id": 53951138, "body": "yes; evaluation of the first level. there&#39;s a more scientific term as well but it doesn&#39;t matter here."}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1444574956, "post_id": 33056377, "comment_id": 53951401, "body": "But <code>g x y = case x of otherwise -&gt; y</code> does not evaluate <code>x</code> (at least not according to <code>trace</code>)."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1444578355, "post_id": 33056377, "comment_id": 53952313, "body": "<code>case (trace &quot;x&quot; x) of foo -&gt; y</code>?"}, {"owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "edited": false, "score": 0, "creation_date": 1444578841, "post_id": 33056377, "comment_id": 53952470, "body": "Yes, but not with <code>otherwise</code>. It&#39;s the matching, within the <code>case</code>, not the <code>case</code> itself. So the <code>case</code> examples aren&#39;t distinguishing evaluation of the first argument: both do."}], "tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": false, "score": 2, "last_activity_date": 1444514483, "last_edit_date": 1444514483, "creation_date": 1444495276, "answer_id": 33056377, "question_id": 33055125, "link": "https://stackoverflow.com/questions/33055125/how-is-haskells-seq-different-from-other-functions/33056377#33056377", "title": "How is Haskell&#39;s &#39;seq&#39; different from other functions?", "body": "\n\n<p><code>seq</code> evaluates its first argument immediately, not only when it's needed \u2014 this is not at all the same as the general function evaluation.</p>\n\n<p>For example</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>let x = 1+1\n    y = 2+2\nin seq x (x, y)\n</code></pre>\n\n<p>immediately evaluates the expression <code>1+1</code> but not <code>2+2</code> even though neither would need to be evaluated immediately. Figuratively, what's returned is</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>(2, 2+2)\n</code></pre>\n\n<p>not <code>(1+1, 2+2)</code>. </p>\n\n<p>This is sometimes useful if instead of <code>1+1</code> you have something like <code>1+2+3+...+1000000</code> which is a relatively cheap computation but its unevaluated, lazy form is very very long and takes up a lot of memory, which, if the expression isn't evaluated quickly enough, will effectively start leaking memory; this situatation is called a <em>space leak</em> in Haskell terminology.</p>\n\n<hr>\n\n<p><strong>EDIT:</strong></p>\n\n<p>To address your comment, here's a bogus scenario wherein a nested data structure is pattern matched to various depth. The data structure has been interspersed with <code>trace</code> calls at every level so that you could monitor how it's being evaluated:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Debug.Trace (trace)\n\ndata Age    = Age Int\ndata Name   = Name String\ndata Person = Person Name Age\n\nname   = trace \"!NAME!\"   $ Name $ trace \"!NAME CONTENT!\" $ \"John \" ++ \"Doe\"\nage    = trace \"!AGE!\"    $ Age  $ trace \"!AGE CONTENT!\"  $ 10 + 18\nperson = trace \"!PERSON!\" $ Person name age\n-- person = trace \"!PERSON!\" $ Person (trace \"!n!\" name) (trace \"!a!\" age)\n\nmain = do\n  case person of p -&gt; print \"hello\"\n  putStrLn \"---\"\n  case person of Person name age -&gt; print \"hello\"\n  putStrLn \"---\"\n  case person of Person (Name str) age -&gt; print \"hello\"\n  putStrLn \"---\"\n  case person of Person (Name str) (Age i) -&gt; print \"hello\"\n  putStrLn \"---\"\n  case person of Person (Name str) (Age i) -&gt; putStrLn $ \"hello: \" ++ str\n  putStrLn \"---\"\n  case person of Person (Name str) (Age i) -&gt; putStrLn $ \"hello: \" ++ show (str, i)\n</code></pre>\n\n<p><strong>Output:</strong></p>\n\n<pre class=\"lang-none prettyprint-override\"><code>\"hello\"\n---\n!PERSON!\n\"hello\"\n---\n!NAME!\n\"hello\"\n---\n!AGE!\n\"hello\"\n---\nhello: !NAME CONTENT!\nJohn Doe\n---\nhello: (\"John Doe\",!AGE CONTENT!\n28)\n</code></pre>\n\n<p><em>Note that the output from the <code>trace</code> calls \"interferes\" with the output from the <code>putStrLn</code>/<code>print</code> calls, but it actually demonstrates quite well how the evaluation is happening at runtime.</em></p>\n\n<p><strong>Furthermore</strong>, if you define <code>Name</code> and <code>Age</code> using <code>newtype</code> instead of <code>data</code>, the evaluation will be slightly different as <code>newtype</code> values don't have a runtime wrapper so the runtime memory representation of <code>person</code> will be one \"level\" thinner:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>newtype Age = Age Int\nnewtype Name = Name String\ndata Person = Person Name Age\n</code></pre>\n\n<pre class=\"lang-none prettyprint-override\"><code>\"hello\"\n---\n!PERSON!\n\"hello\"\n---\n\"hello\"\n---\n\"hello\"\n---\nhello: !NAME!\n!NAME CONTENT!\nJohn Doe\n---\nhello: (\"John Doe\",!AGE!\n!AGE CONTENT!\n28)\n</code></pre>\n"}], "owner": {"reputation": 35444, "user_id": 656912, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ce95c01cbd4f90f014d988ae5c8a422d?s=128&d=identicon&r=PG", "display_name": "orome", "link": "https://stackoverflow.com/users/656912/orome"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 320, "favorite_count": 3, "accepted_answer_id": 33055462, "answer_count": 2, "score": 7, "last_activity_date": 1444551086, "creation_date": 1444487663, "last_edit_date": 1444488779, "question_id": 33055125, "link": "https://stackoverflow.com/questions/33055125/how-is-haskells-seq-different-from-other-functions", "title": "How is Haskell&#39;s &#39;seq&#39; different from other functions?", "body": "<p>I'm confused about the description of how Haskell's <code>seq</code> works in a <a href=\"https://hackhands.com/lazy-evaluation-works-haskell/\">tutorial I'm reading</a>.</p>\n\n<p>The tutorial states that </p>\n\n<blockquote>\n  <p>evaluating the expression <code>seq x y</code> will first evaluate <code>x</code> to WHNF and only then continue with the evaluation of <code>y</code></p>\n</blockquote>\n\n<p>But earlier the same tutorial, in explaining how Haskell's lazy evaluation works in general, states that in evaluating a function, argues are \"evaluated, but only as far as necessary\" which means that its</p>\n\n<blockquote>\n  <p>arguments will be evaluated from left to right until their topmost nodes are constructors that match the pattern. If the pattern is a simple variable, then the argument is not evaluated; if the pattern is a constructor, this means evaluation to WHNF.</p>\n</blockquote>\n\n<p>This description of function evaluation in general, seems no different from the description given for <code>seq</code>. Both \u2014 in my beginner's reading \u2014 just reduce their first argument to WHNF. </p>\n\n<p>Is that correct? How is <code>seq</code> different \u2014\u00a0specifically in how it processes its first argument \u2014\u00a0from any other Haskell function?</p>\n"}, {"tags": ["haskell", "yesod"], "answers": [{"comments": [{"owner": {"reputation": 976, "user_id": 1274282, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nBRxs.png?s=128&g=1", "display_name": "Taylor Fausak", "link": "https://stackoverflow.com/users/1274282/taylor-fausak"}, "edited": false, "score": 1, "creation_date": 1444484675, "post_id": 33054624, "comment_id": 53929434, "body": "You can link directly to a section in the GHC documentation. For example: <a href=\"https://downloads.haskell.org/~ghc/7.10.2/docs/html/users_guide/syntax-extns.html#record-wildcards\" rel=\"nofollow noreferrer\">downloads.haskell.org/~ghc/7.10.2/docs/html/users_guide/&hellip;</a>"}], "tags": [], "owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "is_accepted": true, "score": 10, "last_activity_date": 1444484770, "last_edit_date": 1444484770, "creation_date": 1444484350, "answer_id": 33054624, "question_id": 33054382, "link": "https://stackoverflow.com/questions/33054382/x-getyesod-notation/33054624#33054624", "title": "X {..} &lt;- getYesod notation", "body": "<p>These are called <a href=\"https://downloads.haskell.org/~ghc/7.10.2/docs/html/users_guide/syntax-extns.html#record-wildcards\" rel=\"noreferrer\">record wildcards</a> - given a record definition (<code>App</code> in this case), the pattern <code>App { .. }</code> brings all the field names into scope. For example given the following record definition</p>\n\n<pre><code>{-# LANGUAGE RecordWildCards #-}\ndata Test = Test { a :: Int, b :: Int }\n</code></pre>\n\n<p>you can match on it in a pattern, bringing the <code>a</code> and <code>b</code> fields into scope e.g.</p>\n\n<pre><code>sumTest :: Test -&gt; Int\nsumTest Test {..} = a + b\n</code></pre>\n"}], "owner": {"reputation": 29707, "user_id": 394167, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/5b8b4928a69d422138ed747c70e8553e?s=128&d=identicon&r=PG", "display_name": "Richard Cook", "link": "https://stackoverflow.com/users/394167/richard-cook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 184, "favorite_count": 1, "accepted_answer_id": 33054624, "answer_count": 1, "score": 8, "last_activity_date": 1444499874, "creation_date": 1444482681, "last_edit_date": 1444499874, "question_id": 33054382, "link": "https://stackoverflow.com/questions/33054382/x-getyesod-notation", "title": "X {..} &lt;- getYesod notation", "body": "<p>I'm seeing this kind of notation all over sample code for Yesod web applications and have no idea what it means:</p>\n\n<pre><code>getHomeR :: Handler Html\ngetHomeR = do\n    App {..} &lt;- getYesod\n</code></pre>\n\n<p>What does this syntax mean?</p>\n\n<p>I'm also seeing the following, I assume related, notation:</p>\n\n<pre><code>getHomeR :: Handler Html\ngetHomeR = do\n    App x &lt;- getYesod\n</code></pre>\n\n<p>i.e. Some identifier <code>x</code> in place of the cryptic <code>{..}</code>.</p>\n"}, {"tags": ["haskell", "functional-programming", "monomorphism-restriction"], "answers": [{"tags": [], "owner": {"reputation": 48129, "user_id": 76051, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/AGDxz.jpg?s=128&g=1", "display_name": "Carsten", "link": "https://stackoverflow.com/users/76051/carsten"}, "is_accepted": true, "score": 2, "last_activity_date": 1444484745, "last_edit_date": 1444484745, "creation_date": 1444484430, "answer_id": 33054631, "question_id": 33054341, "link": "https://stackoverflow.com/questions/33054341/confusing-types-in-ghci/33054631#33054631", "title": "Confusing types in ghci", "body": "<p>you can use <code>div</code> instead of <code>(/)</code>:</p>\n\n<pre><code>calcBmis xs = [ bmi | (w,h) &lt;- xs, let bmi = (w `div` h)^2 ]\n\nPrelude&gt; :t calcBmis\ncalcBmis :: Integral t =&gt; [(t, t)] -&gt; [t]\n\nPrelude&gt; calcBmis n\n[1,0,0,0,0,4,1,0,0,0,9,1,1,0,0,16,4,1,1,0,25,4,1,1,1]\n</code></pre>\n\n<p>as you can see this version can deal with all <code>Integral</code> values - but of course will truncate (because of <code>div</code>).</p>\n\n<p>or you can map everything with <code>fromIntegral</code>:</p>\n\n<pre><code>calcBmis xs = [ bmi | (w,h) &lt;- xs, let bmi = (fromIntegral w / fromIntegral h)^2 ]\n\nPrelude&gt; :t calcBmis\ncalcBmis:: (Fractional t, Integral t1, Integral t2) =&gt; [(t1, t2)] -&gt; [t]\n</code></pre>\n\n<p>Which then will produce fractional values:</p>\n\n<pre><code>Prelude&gt; calcBmis n\n[1.0,0.25,0.1111111111111111\n,6.25e-2\n,4.000000000000001e-2\n,4.0\n,1.0\n,0.4444444444444444\n, ... ]\n</code></pre>\n\n<p>in either case it will work with all inputs as long as they are an instance of <code>Integral</code> - the second version will even accept pairs of different integrals ;)</p>\n"}], "owner": {"reputation": 906, "user_id": 5299539, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/9f41c4053ec442fe9d5fa1e2b2e19c6f?s=128&d=identicon&r=PG&f=1", "display_name": "Charana", "link": "https://stackoverflow.com/users/5299539/charana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 33054631, "answer_count": 1, "score": 0, "last_activity_date": 1444484745, "creation_date": 1444482464, "last_edit_date": 1444483734, "question_id": 33054341, "link": "https://stackoverflow.com/questions/33054341/confusing-types-in-ghci", "title": "Confusing types in ghci", "body": "<p>Here is my code:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>n = [(a,b) | a &lt;- [1..5],b &lt;- [1..5]]\ncalcBmis xs = [bmi | (w, h) &lt;- xs,let bmi = w / h ^ 2]  \n</code></pre>\n\n<p>When trying to apply <code>calcBmis</code> to <code>n</code>, I get the following error:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>*Charana&gt; calcBmis n\n\n&lt;interactive&gt;:220:1:\n    No instance for (Fractional Integer)\n    arising from a use of \u2018calcBmis\u2019\n    In the expression: calcBmis n\n    In an equation for \u2018it\u2019: it = calcBmis n\n</code></pre>\n\n<p>Further investigation in ghci:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>*Charana&gt; :t calcBmis\ncalcBmis :: Fractional t =&gt; [(t, t)] -&gt; [t]\n*Charana&gt; :t n\nn :: [(Integer, Integer)]\n</code></pre>\n\n<p>What I'm assuming is that the list I produce is of type <code>(Integer,Integer)</code>, but that cannot be processed in the <code>calcBmis</code>, which only takes in <code>Fractional</code>. Any idea how to fix this problem?</p>\n"}, {"tags": ["haskell", "error-handling", "either"], "comments": [{"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 1, "creation_date": 1444478637, "post_id": 33053682, "comment_id": 53927614, "body": "Well, for one... there is a dot at the end of the last line that&#39;s not supposed to be there. Although you&#39;d get a parse rather than a type error if that was in the actual code you were using. The real problem seems to be <code>Right . func . elements columnIndex</code> though - <code>elements ci</code> is a list, not a function. Also, you need parentheses there otherwise the precedence doesn&#39;t work out."}, {"owner": {"reputation": 672, "user_id": 2224973, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/864d8f904b79e9773eee4e6597deac7a?s=128&d=identicon&r=PG", "display_name": "Cut&#250; Chique&#241;o", "link": "https://stackoverflow.com/users/2224973/cut%c3%ba-chique%c3%b1o"}, "reply_to_user": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 0, "creation_date": 1444479050, "post_id": 33053682, "comment_id": 53927743, "body": "the dot was a mistake when I copied the code and text into the form. Sorry, I corrected this now since it is not related to the problem."}, {"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1444479224, "post_id": 33053682, "comment_id": 53927802, "body": "Yes, you need parentheses. Function application binds tighter than an operator like <code>.</code>, and line breaks are immaterial in the middle of an expression. You wrote <code>(either Left Right) . func . (elements columnIndex)</code>."}, {"owner": {"reputation": 672, "user_id": 2224973, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/864d8f904b79e9773eee4e6597deac7a?s=128&d=identicon&r=PG", "display_name": "Cut&#250; Chique&#241;o", "link": "https://stackoverflow.com/users/2224973/cut%c3%ba-chique%c3%b1o"}, "edited": false, "score": 0, "creation_date": 1444479590, "post_id": 33053682, "comment_id": 53927906, "body": "thx. in fact changing the line to <code>either Left (Right . func . elements) columnIndex</code> does the trick. This is NOT printed in the book which kind of makes me angry. Since you solved the problem do you want to get the credits for answering it, otherwise I answer it today in the evening."}, {"owner": {"reputation": 13734, "user_id": 938694, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/b6678a430a805dd78366d6e135b49f2d?s=128&d=identicon&r=PG", "display_name": "Cubic", "link": "https://stackoverflow.com/users/938694/cubic"}, "edited": false, "score": 3, "creation_date": 1444479736, "post_id": 33053682, "comment_id": 53927946, "body": "Honestly... I&#39;d just close it as &#39;not reproducible&#39; because it&#39;s just a typo."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 3, "creation_date": 1444482780, "post_id": 33053682, "comment_id": 53928861, "body": "Doesn&#39;t sound like a typo to me. Sounds like the code example in this book was incorrect. That&#39;s a question someone else using this book will have again in the future, and it will be nice to have a question with the answer, not a &quot;too localized&quot; closed question."}, {"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 2, "creation_date": 1444492035, "post_id": 33053682, "comment_id": 53931680, "body": "I just have to mention that <code>either Left (Right . f)</code> is the same as <code>fmap f</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 0, "creation_date": 1444492612, "post_id": 33053682, "comment_id": 53931887, "body": "What @&#216;rjanJohansen said. That&#39;s not really a good way to use <code>either</code>, because <code>fmap</code> is the obvious way to do that."}, {"owner": {"reputation": 672, "user_id": 2224973, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/864d8f904b79e9773eee4e6597deac7a?s=128&d=identicon&r=PG", "display_name": "Cut&#250; Chique&#241;o", "link": "https://stackoverflow.com/users/2224973/cut%c3%ba-chique%c3%b1o"}, "edited": false, "score": 0, "creation_date": 1444666944, "post_id": 33053682, "comment_id": 53987953, "body": "I agree on rephrasing the question to relate it to the book but I am not sure what&#39;s appropriate. What about: How to make the applyToColumnInCSV exmpl. from &#39;Learning Haskel Data Analysis work?&#39;"}], "owner": {"reputation": 672, "user_id": 2224973, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/864d8f904b79e9773eee4e6597deac7a?s=128&d=identicon&r=PG", "display_name": "Cut&#250; Chique&#241;o", "link": "https://stackoverflow.com/users/2224973/cut%c3%ba-chique%c3%b1o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 299, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1444479076, "creation_date": 1444478062, "last_edit_date": 1444479076, "question_id": 33053682, "link": "https://stackoverflow.com/questions/33053682/how-does-the-either-function-work-and-is-used-appropriately-in-haskell", "title": "How does the either function work and is used appropriately in Haskell?", "body": "<p>I am trying to learn Haskell with <a href=\"https://www.packtpub.com/big-data-and-business-intelligence/learning-haskell-data-analysis\" rel=\"nofollow\">Learning Haskell Data Analysis</a> at the moment (I read some other things like Learn You a Haskell... before though). There is a listing to parse and modify csv Data that does not work the way the book proposes, ie. it throughs an error. Unfortunately, I am not good enough to be able to correct the listing. I somehow get what does not work but don't know how the correct version would look like. I also did not realy found expressive examples which use the <code>either</code> function to see if I can derive the correct version from it</p>\n\n<pre><code>module LearningDataAnalysis02 where\n\nimport Data.List\nimport Data.Either\nimport Text.CSV\n\n-- compute the average of List values\naverage' :: Fractional a =&gt; [a] -&gt; a\naverage' xs = sum xs / genericLength xs\n\nreadColumn :: [String] -&gt; [Double]\nreadColumn xs = map read xs\n\ngetColumnInCSV :: CSV -&gt; String -&gt; Either String Integer\ngetColumnInCSV csv columnName = case lookupResponse of\n    Nothing -&gt; Left \"The column does not exist in this csv file.\"\n    Just x  -&gt; Right (fromIntegral x)\n  where\n    lookupResponse = findIndex (== columnName) (head csv)\n\napplyToColumnInCSV :: ([String] -&gt; b) -&gt; CSV -&gt; String -&gt; Either String b\napplyToColumnInCSV func csv column = either\n    Left\n    Right . func . elements columnIndex\n  where\n    columnIndex = getColumnInCSV csv column\n    nfieldsInFile = length $ head csv\n    records = tail $ filter (\\record -&gt; nfieldsInFile == length record) csv\n    elements ci = map (\\record -&gt; genericIndex record ci) records\n</code></pre>\n\n<p>The error message I get when loading it into ghci is:</p>\n\n<pre><code>LearningDataAnalysis02.hs:22:38:\n    Couldn't match expected type \u2018Either String b\u2019\n                with actual type \u2018a0 -&gt; Either a1 b0\u2019\n    Relevant bindings include\n      func :: [String] -&gt; b (bound at LearningDataAnalysis02.hs:22:20)\n      applyToColumnInCSV :: ([String] -&gt; b)\n                            -&gt; CSV -&gt; String -&gt; Either String b\n        (bound at LearningDataAnalysis02.hs:22:1)\n    In the expression: either Left Right . func . elements columnIndex\n    In an equation for \u2018applyToColumnInCSV\u2019:\n        applyToColumnInCSV func csv column\n          = either Left Right . func . elements columnIndex\n          where\n              columnIndex = getColumnInCSV csv column\n              nfieldsInFile = length $ head csv\n              records\n                = tail $ filter (\\ record -&gt; nfieldsInFile == length record) csv\n              elements ci = map (\\ record -&gt; genericIndex record ci) records\n\nLearningDataAnalysis02.hs:24:20:\n    Couldn't match expected type \u2018a0 -&gt; [String]\u2019\n                with actual type \u2018[Field]\u2019\n    Possible cause: \u2018elements\u2019 is applied to too many arguments\n    In the second argument of \u2018(.)\u2019, namely \u2018elements columnIndex\u2019\n    In the second argument of \u2018(.)\u2019, namely\n      \u2018func . elements columnIndex\u2019\nFailed, modules loaded: none.\n</code></pre>\n\n<p>Is anyone so kind and can explain to me how I have to modify the listing to make it work and why it does not work the way the book suggest it?</p>\n"}, {"tags": ["haskell", "haskell-stack"], "comments": [{"owner": {"reputation": 391, "user_id": 5298455, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zEzWj_qaO7I/AAAAAAAAAAI/AAAAAAAAACw/A7lGVwEZUYs/photo.jpg?sz=128", "display_name": "Emanuel Borsboom", "link": "https://stackoverflow.com/users/5298455/emanuel-borsboom"}, "edited": false, "score": 1, "creation_date": 1444490658, "post_id": 33053124, "comment_id": 53931287, "body": "Did you try following its advice of using <code>stack init --resolver</code> and then adding <code>extra-deps</code>?  Or using <code>stack init --solver</code>?  Because Stack, by default, uses of sets of package versions that are known to work together (known as &quot;Stackage snapshots&quot;), there are combinations of packages that do work that it does not know about.  You can override those using <code>extra-deps</code>."}], "answers": [{"tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": true, "score": 3, "last_activity_date": 1444920129, "last_edit_date": 1444920129, "creation_date": 1444474454, "answer_id": 33053180, "question_id": 33053124, "link": "https://stackoverflow.com/questions/33053124/stack-build-tool-compatibility-issue-with-lts-resolver/33053180#33053180", "title": "Stack build tool: compatibility issue with LTS resolver", "body": "\n\n<p>I would suggest giving a non-LTS solver a try:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ stack init --resolver=ghc-7.10 --force\n</code></pre>\n\n<p>or</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>$ stack init --resolver=ghc-7.8 --force\n</code></pre>\n\n<p>This usually gives working results much more easily than with an <code>lts-*</code> solver, except you don't get to benefit from the stability of LTS. But since you're coming from Cabal, you didn't have LTS prior to now anyway, so you might as well start out with a regular <code>ghc-7.10</code> or <code>ghc-7.8</code> resolver and see if you can move to LTS later on.</p>\n\n<p><em>P.S.</em> you can also try the nightlies, which is somewhere between <code>lts-*</code> and <code>ghc-*</code> I guess, but I haven't tried that myself.</p>\n\n<p><strong>EDIT:</strong> after a <code>stack init</code> command you typically also need to run  <code>stack solver --modify-stack-yaml</code> to populate the <code>extra-deps</code> section in your <code>stack.yaml</code> with build dependencies computed from the <code>build-depends</code> section in your <code>.cabal</code> file. I think what's happening is that <code>init</code> only configures the project with a specified solver but doesn't invoke the actual dependency resolution. (I'd appreciate any corrections to this information.)</p>\n"}, {"tags": [], "owner": {"reputation": 31243, "user_id": 2751851, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4ddc0.png?s=128&g=1", "display_name": "duplode", "link": "https://stackoverflow.com/users/2751851/duplode"}, "is_accepted": false, "score": 3, "last_activity_date": 1444497841, "last_edit_date": 1444497841, "creation_date": 1444497529, "answer_id": 33056757, "question_id": 33053124, "link": "https://stackoverflow.com/questions/33053124/stack-build-tool-compatibility-issue-with-lts-resolver/33056757#33056757", "title": "Stack build tool: compatibility issue with LTS resolver", "body": "<p>Your project, <em>SnapFull</em>, asks for too old versions of its dependencies (e.g. <code>base &lt; 4.4</code> and <code>lens &lt; 3.8</code>). Those versions are older than what the first Stackage snapshot offers, which explains why stack is unable to find a build plan. In all likelihood, the easiest way to solve your problem is updating the .cabal file of your project to use the latest versions of those dependencies. Additionally, the <em>snap-loader-*</em> packages are not in Stackage, so they need to be added to the <code>extra-deps</code> field of <code>stack.yaml</code>. The <code>stack solver --modify-stack-yaml</code> command can do that for you.</p>\n\n<p>P.S.: <a href=\"http://www.stackage.org/lts\" rel=\"nofollow\">This page</a> tells which packages and versions are included in the latest Stackage LTS snapshot. You can also check other snapshots through the \"Snapshots\" link at the top of the page.</p>\n"}], "owner": {"reputation": 703, "user_id": 2688424, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/c854b2c7c2dc30bd2ee91dd7f53e6589?s=128&d=identicon&r=PG&f=1", "display_name": "madison54", "link": "https://stackoverflow.com/users/2688424/madison54"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 3, "accepted_answer_id": 33053180, "answer_count": 2, "score": 2, "last_activity_date": 1444920129, "creation_date": 1444474093, "last_edit_date": 1444477223, "question_id": 33053124, "link": "https://stackoverflow.com/questions/33053124/stack-build-tool-compatibility-issue-with-lts-resolver", "title": "Stack build tool: compatibility issue with LTS resolver", "body": "<p>Being advertised as a breakthrough in Haskell tooling, I tried switching from Cabal to Stack. However, I still have a problem getting projects to run with stack that run with cabal. I believe the issue is that there are global constraints set by the resolver (e.g. long term support packages from stackage) that don't comply with local package dependencies.</p>\n\n<p>For a concrete example, I used the snap framework (<a href=\"http://snapframework.com/\" rel=\"nofollow\">http://snapframework.com/</a>) in version 0.14.0.6. After creating a full snap project with <code>snap init</code>, I tried to instantiate a stack build plan from the cabal file with <code>stack init</code>. However, there was no build plan found by stack that satisfies the constraints.\nOn the other hand, a <code>cabal install</code> successfully builds the project.</p>\n\n<p>Is there a mistake in my understanding of stack? How can one resolve this issue?</p>\n\n<p>The complete error log is show below, where the project's name is SnapFull:</p>\n\n<pre><code>Checking against build plan lts-3.7\n\n* Build plan did not match your requirements:\n    base version 4.8.1.0 found\n    - SnapFull requires &gt;=4 &amp;&amp; &lt;4.4\n\n    lens version 4.12.3 found\n    - SnapFull requires &gt;=3.7.6 &amp;&amp; &lt;3.8\n\n    snap-loader-dynamic not found\n    - SnapFull requires ==0.10.*\n\n    snap-loader-static not found\n    - SnapFull requires &gt;=0.9 &amp;&amp; &lt;0.10\n\n\nChecking against build plan lts-2.22\n\n* Build plan did not match your requirements:\n    base version 4.7.0.2 found\n    - SnapFull requires &gt;=4 &amp;&amp; &lt;4.4\n\n    lens version 4.7.0.1 found\n    - SnapFull requires &gt;=3.7.6 &amp;&amp; &lt;3.8\n\n    snap-loader-dynamic not found\n    - SnapFull requires ==0.10.*\n\n    snap-loader-static not found\n    - SnapFull requires &gt;=0.9 &amp;&amp; &lt;0.10\n\n\nChecking against build plan lts-3.8\n\n* Build plan did not match your requirements:\n    base version 4.8.1.0 found\n    - SnapFull requires &gt;=4 &amp;&amp; &lt;4.4\n\n    lens version 4.12.3 found\n    - SnapFull requires &gt;=3.7.6 &amp;&amp; &lt;3.8\n\n    snap-loader-dynamic not found\n    - SnapFull requires ==0.10.*\n\n    snap-loader-static not found\n    - SnapFull requires &gt;=0.9 &amp;&amp; &lt;0.10\n\n\nChecking against build plan nightly-2015-10-09\n\n* Build plan did not match your requirements:\n    base version 4.8.1.0 found\n    - SnapFull requires &gt;=4 &amp;&amp; &lt;4.4\n\n    lens version 4.12.3 found\n    - SnapFull requires &gt;=3.7.6 &amp;&amp; &lt;3.8\n\n    snap-loader-dynamic not found\n    - SnapFull requires ==0.10.*\n\n    snap-loader-static not found\n    - SnapFull requires &gt;=0.9 &amp;&amp; &lt;0.10\n\n\nThere was no snapshot found that matched the package bounds in your .cabal files.\nPlease choose one of the following commands to get started.\n\n    stack init --resolver lts-3.7\n    stack init --resolver lts-2.22\n    stack init --resolver lts-3.8\n    stack init --resolver nightly-2015-10-09\n\nYou'll then need to add some extra-deps. See:\n\n    https://github.com/commercialhaskell/stack/blob/master/doc/yaml_configuration.md#extra-deps\n\nYou can also try falling back to a dependency solver with:\n\n    stack init --solver\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 906, "user_id": 5299539, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/9f41c4053ec442fe9d5fa1e2b2e19c6f?s=128&d=identicon&r=PG&f=1", "display_name": "Charana", "link": "https://stackoverflow.com/users/5299539/charana"}, "edited": false, "score": 0, "creation_date": 1444471641, "post_id": 33052758, "comment_id": 53925864, "body": "So sorry for wasting your time,at least you get points for answering my question"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 906, "user_id": 5299539, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/9f41c4053ec442fe9d5fa1e2b2e19c6f?s=128&d=identicon&r=PG&f=1", "display_name": "Charana", "link": "https://stackoverflow.com/users/5299539/charana"}, "edited": false, "score": 2, "creation_date": 1444471677, "post_id": 33052758, "comment_id": 53925870, "body": "well about 30 seconds of my life!"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 906, "user_id": 5299539, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/9f41c4053ec442fe9d5fa1e2b2e19c6f?s=128&d=identicon&r=PG&f=1", "display_name": "Charana", "link": "https://stackoverflow.com/users/5299539/charana"}, "edited": false, "score": 1, "creation_date": 1444472592, "post_id": 33052758, "comment_id": 53926062, "body": "@Charana: I can see you haven&#39;t accepted almost any of the answers to your questions, including this one \u2014 you should change that habit!"}, {"owner": {"reputation": 906, "user_id": 5299539, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/9f41c4053ec442fe9d5fa1e2b2e19c6f?s=128&d=identicon&r=PG&f=1", "display_name": "Charana", "link": "https://stackoverflow.com/users/5299539/charana"}, "edited": false, "score": 0, "creation_date": 1444472968, "post_id": 33052758, "comment_id": 53926150, "body": "wait,how do i do that,aren&#39;t i just supposed to up vote?"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "reply_to_user": {"reputation": 906, "user_id": 5299539, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/9f41c4053ec442fe9d5fa1e2b2e19c6f?s=128&d=identicon&r=PG&f=1", "display_name": "Charana", "link": "https://stackoverflow.com/users/5299539/charana"}, "edited": false, "score": 1, "creation_date": 1444473007, "post_id": 33052758, "comment_id": 53926162, "body": "there is a checkbox by the side of all answers, which, when you click it, will turn green. you must have seen it... once you find it, it would be nice if you went back to your older questions and accepted the best answers, if they solved your issue."}], "tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": true, "score": 9, "last_activity_date": 1444471504, "creation_date": 1444471504, "answer_id": 33052758, "question_id": 33052747, "link": "https://stackoverflow.com/questions/33052747/parse-error-on-guards/33052758#33052758", "title": "Parse error on guards", "body": "<p>you need to use <code>=</code> not <code>==</code> in a function definition:</p>\n\n<pre><code>factorial :: Int -&gt; Int \nfactorial 0 = 1\nfactorial n \n   | n &lt; 0     = error \"Cant call a nagative number\"\n   | otherwise = n * factorial (n-1)\n</code></pre>\n\n<ul>\n<li><code>=</code> is a syntactic atom used for defining things;</li>\n<li><code>==</code> is a function/operator used for comparing values.</li>\n</ul>\n"}], "owner": {"reputation": 906, "user_id": 5299539, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/9f41c4053ec442fe9d5fa1e2b2e19c6f?s=128&d=identicon&r=PG&f=1", "display_name": "Charana", "link": "https://stackoverflow.com/users/5299539/charana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 371, "favorite_count": 0, "accepted_answer_id": 33052758, "answer_count": 1, "score": 0, "last_activity_date": 1444525493, "creation_date": 1444471437, "last_edit_date": 1444525493, "question_id": 33052747, "link": "https://stackoverflow.com/questions/33052747/parse-error-on-guards", "title": "Parse error on guards", "body": "<pre><code>factorial :: Int -&gt; Int \n\nfactorial 0 = 1\n\nfactorial n \n   | n &lt; 0 == error \"Cant call a nagative number\"\n   | otherwise = n * factorial (n-1)\n</code></pre>\n\n<p>Can anybody explain why I am getting this error?</p>\n\n<pre><code>haskell.hs:77:2: parse error on input \u2018|\u2019\n</code></pre>\n"}, {"tags": ["haskell", "cabal", "ffi", "template-haskell"], "comments": [{"owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "edited": false, "score": 0, "creation_date": 1444486795, "post_id": 33052652, "comment_id": 53930003, "body": "I&#39;ve looked at your cabal file and it seems you are following the recipe for using <code>inline-c</code>.  What exactly doesn&#39;t work?"}], "answers": [{"comments": [{"owner": {"reputation": 702, "user_id": 2890063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/07aeeae7c14c12cefde16bf826eceb4a?s=128&d=identicon&r=PG", "display_name": "ocramz", "link": "https://stackoverflow.com/users/2890063/ocramz"}, "edited": false, "score": 0, "creation_date": 1444489581, "post_id": 33055286, "comment_id": 53930946, "body": "Nice, thank you very much; I&#39;ll look into all these things asap."}], "tags": [], "owner": {"reputation": 49959, "user_id": 866915, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/09242131d6e17cbbe31e8547514da6e5?s=128&d=identicon&r=PG", "display_name": "ErikR", "link": "https://stackoverflow.com/users/866915/erikr"}, "is_accepted": true, "score": 2, "last_activity_date": 1444488701, "last_edit_date": 1495541671, "creation_date": 1444488701, "answer_id": 33055286, "question_id": 33052652, "link": "https://stackoverflow.com/questions/33052652/haskell-inline-c-multi-step-build-link-with-cabal/33055286#33055286", "title": "Haskell inline-c multi-step build/link with Cabal", "body": "<blockquote>\n  <p>How does one control the build/link sequence in Cabal?</p>\n</blockquote>\n\n<p>You can use <code>Build-Type: Custom</code> in your cabal file and control everything with a custom <code>Setup.hs</code>.</p>\n\n<p>Have a look at the <a href=\"http://hackage.haskell.org/package/Cabal-1.22.4.0/docs/Distribution-Simple.html#t:UserHooks\" rel=\"nofollow noreferrer\"><code>UserHooks</code> data type</a> for all of the phases of cabal which you can control.</p>\n\n<p>Some examples:</p>\n\n<ul>\n<li>SDL - uses <code>autoconfUserHooks</code> to have cabal run a <code>configure</code> script</li>\n<li>this SO answer contains links to packages which override the <code>confHook</code>: <a href=\"https://stackoverflow.com/a/32679607/866915\">https://stackoverflow.com/a/32679607/866915</a></li>\n<li>See this paste for links to more custom Setup.hs files: <a href=\"http://lpaste.net/142696\" rel=\"nofollow noreferrer\">http://lpaste.net/142696</a></li>\n</ul>\n\n<blockquote>\n  <p>Are relative paths supported in Cabal? couldn't find this mentioned in the guide and bash-like ~ doesn't work</p>\n</blockquote>\n\n<p>If your library is external to your cabal package, I would consider using <code>pkg-config</code> on Unix/Linux systems to have cabal locate the library. See the answers to this SO question: <a href=\"https://stackoverflow.com/q/4959802/866915\">How to specify dependency on external C library in .cabal?</a></p>\n\n<p>If your library is part of your cabal package, check out this blog post and related github repo which shows how to write a custom Setup.hs file to build and install the library in the right place for cabal:</p>\n\n<ul>\n<li><a href=\"http://codinginfinity.me/post/2015-04-18/haskell_and_cpp\" rel=\"nofollow noreferrer\">Haskell and external C++ library - the easy way</a></li>\n<li><a href=\"https://github.com/jakubfijalkowski/haskell-and-cpp\" rel=\"nofollow noreferrer\">https://github.com/jakubfijalkowski/haskell-and-cpp</a></li>\n</ul>\n"}], "owner": {"reputation": 702, "user_id": 2890063, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/07aeeae7c14c12cefde16bf826eceb4a?s=128&d=identicon&r=PG", "display_name": "ocramz", "link": "https://stackoverflow.com/users/2890063/ocramz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 151, "favorite_count": 1, "accepted_answer_id": 33055286, "answer_count": 1, "score": 1, "last_activity_date": 1444488701, "creation_date": 1444470760, "last_edit_date": 1444471458, "question_id": 33052652, "link": "https://stackoverflow.com/questions/33052652/haskell-inline-c-multi-step-build-link-with-cabal", "title": "Haskell inline-c multi-step build/link with Cabal", "body": "<p>I am writing an FFI-heavy library that uses <code>inline-c</code>, and the build process is:</p>\n\n<ul>\n<li>run GHC on the <code>inline-c</code> files, produce C</li>\n<li>compile C produced in previous step into dynamic libraries</li>\n<li>compile Haskell interface while linking both the object files produced in step 2 and the dynlibs of the wrapped library.</li>\n</ul>\n\n<p>QUESTION: Currently I'm doing the above in a makefile (see <a href=\"https://github.com/ocramz/petsc-hs/blob/master/makefile\" rel=\"nofollow\">https://github.com/ocramz/petsc-hs/blob/master/makefile</a> ), but I'd like to package it up in a Cabal file (working version : <a href=\"https://github.com/ocramz/petsc-hs/blob/master/petsc-hs.cabal\" rel=\"nofollow\">https://github.com/ocramz/petsc-hs/blob/master/petsc-hs.cabal</a>).</p>\n\n<p>SUB-QUESTIONS: </p>\n\n<ul>\n<li>How does one control the build/link sequence in Cabal? </li>\n<li>Are relative paths supported in Cabal? couldn't find this mentioned in the guide and bash-like <code>~</code> doesn't work</li>\n</ul>\n\n<p>Thank you in advance for all pointers</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 2559, "user_id": 2660970, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/31deb30c1f8cf14c92fdf597e38568a8?s=128&d=identicon&r=PG", "display_name": "ig-melnyk", "link": "https://stackoverflow.com/users/2660970/ig-melnyk"}, "edited": false, "score": 5, "creation_date": 1444468604, "post_id": 33052192, "comment_id": 53925067, "body": "What&#39;s your desired output for list [1,5,10,13] ?"}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 3, "creation_date": 1444468837, "post_id": 33052192, "comment_id": 53925118, "body": "Why are you capitalising <code>Index</code>? Only data values start with capital letters."}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1444470366, "post_id": 33052192, "comment_id": 53925540, "body": "@peace: not sure what you&#39;re asking, and I think you should be spending a couple of days reading a Haskell tutorial/book."}, {"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 0, "creation_date": 1444488813, "post_id": 33052192, "comment_id": 53930667, "body": "I&#39;m voting to close this question because it is unclear, and no effort to improve it by the asker has been made in over 5 hours."}], "answers": [{"comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 3, "creation_date": 1444469468, "post_id": 33052387, "comment_id": 53925313, "body": "Maybe with a <code>zip</code>? That might be what we&#39;re looking for... as in <code>index :: [a] -&gt; [(Int, a)]</code>."}], "tags": [], "owner": {"reputation": 27561, "user_id": 214446, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5deb6b87326686b1f2e9fdb37ceac210?s=128&d=identicon&r=PG", "display_name": "mb21", "link": "https://stackoverflow.com/users/214446/mb21"}, "is_accepted": false, "score": 1, "last_activity_date": 1444469070, "creation_date": 1444469070, "answer_id": 33052387, "question_id": 33052192, "link": "https://stackoverflow.com/questions/33052192/print-out-the-index-of-elements-in-a-list-in-haskell/33052387#33052387", "title": "Print out the index of elements in a list in haskell", "body": "<p>You mean the following?</p>\n\n<pre><code>index :: [a] -&gt; [Int]\nindex x = [1 .. length x]\n</code></pre>\n\n<p><code>[1..4]</code> is shorthand for <code>[1,2,3,4]</code>...</p>\n"}], "owner": {"reputation": 1, "user_id": 5430475, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c22a36b9c6679216fe552c802ca24a31?s=128&d=identicon&r=PG&f=1", "display_name": "peace", "link": "https://stackoverflow.com/users/5430475/peace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 507, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1444469070, "creation_date": 1444467817, "last_edit_date": 1444468777, "question_id": 33052192, "link": "https://stackoverflow.com/questions/33052192/print-out-the-index-of-elements-in-a-list-in-haskell", "title": "Print out the index of elements in a list in haskell", "body": "<p>I am new to haskell programming and I am trying to write a program that prints out the index of elements in a list.</p>\n\n<p>Here is the code I have:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>Index :: [Int]-&gt;[Int]\n\nIndex []= []\nIndex(x:xs)= 0:index (xs+1)\n</code></pre>\n"}, {"tags": ["haskell", "yesod", "haskell-stack"], "comments": [{"owner": {"reputation": 14485, "user_id": 190376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd8280c5e1491b8cf55760750ed97dec?s=128&d=identicon&r=PG", "display_name": "Reid Barton", "link": "https://stackoverflow.com/users/190376/reid-barton"}, "edited": false, "score": 0, "creation_date": 1444482244, "post_id": 33051373, "comment_id": 53928683, "body": "This kind of error usually arises from having two versions of the same package installed, presumably the <code>primitive</code> package in this case. But I thought that was supposed to be impossible with stack..."}], "answers": [{"tags": [], "owner": {"reputation": 51, "user_id": 5430197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rPZIl.png?s=128&g=1", "display_name": "rere", "link": "https://stackoverflow.com/users/5430197/rere"}, "is_accepted": false, "score": 1, "last_activity_date": 1444499641, "creation_date": 1444499641, "answer_id": 33057166, "question_id": 33051373, "link": "https://stackoverflow.com/questions/33051373/yesod-build-error-because-of-the-duplicate-definition-for-symbol-hsprimitive-me/33057166#33057166", "title": "Yesod build error because of the duplicate definition for symbol &quot;hsprimitive_memcpy&quot;", "body": "<p>It seems that the cause of the error were the duplicated GHC installation. \nThanks for @Reid comment, I realized that I installed Haskel Platform from exe file before and I also installed GHC through stack by folloing the guide. </p>\n\n<p>I unisatlled GHC of Haskel Platform and executed 'stack setup' command. \nThen, I executed 'stack build' command and it seemed worked. \nI still have problems with the 'stack build' command, but I solved this issue. </p>\n"}], "owner": {"reputation": 51, "user_id": 5430197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rPZIl.png?s=128&g=1", "display_name": "rere", "link": "https://stackoverflow.com/users/5430197/rere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1444499795, "creation_date": 1444461322, "last_edit_date": 1444499795, "question_id": 33051373, "link": "https://stackoverflow.com/questions/33051373/yesod-build-error-because-of-the-duplicate-definition-for-symbol-hsprimitive-me", "title": "Yesod build error because of the duplicate definition for symbol &quot;hsprimitive_memcpy&quot;", "body": "<p>I followed \"Yesod quick start guide\" to install Yesod in Windows 10.\nBut, when I issued the <code>stack build</code> command, it failed.</p>\n\n<h3>Environment</h3>\n\n<ul>\n<li>Windows 10 (64bits)</li>\n<li><code>stack-0.1.5</code> (for Windows10 64bits)</li>\n<li>Haskell Platform 7.10.2-a (from HaskellPlatform-7.10.2-a-x86_64-setup.exe)</li>\n</ul>\n\n<h3>alex-3.1.4.log</h3>\n\n<pre><code>GHC runtime linker: fatal error: I found a duplicate definition for symbol\n   hsprimitive_memcpy\nwhilst processing object file\n   C:\\Users\\xxxxx\\AppData\\Roaming\\stack\\snapshots\\x86_64-windows\\lts-3.8\\7.10.2\\lib\\x86_64-windows-ghc-7.10.2\\primitive-0.6.1.0-5Jnw7oEuYtM9dmKXelGXVb\\HSprimitive-0.6.1.0-5Jnw7oEuYtM9dmKXelGXVb.o\nThis could be caused by:\n   * Loading two different object files which export the same symbol\n   * Specifying the same object file twice on the GHCi command line\n   * An incorrect `package.conf' entry, causing some object to be\n     loaded twice.\nghc: panic! (the 'impossible' happened)\n  (GHC version 7.10.2 for x86_64-unknown-mingw32):\n    loadObj \"C:\\\\Users\\\\xxxxx\\\\AppData\\\\Roaming\\\\stack\\\\snapshots\\\\x86_64-windows\\\\lts-3.8\\\\7.10.2\\\\lib\\\\x86_64-windows-ghc-7.10.2\\\\primitive-0.6.1.0-5Jnw7oEuYtM9dmKXelGXVb\\\\HSprimitive-0.6.1.0-5Jnw7oEuYtM9dmKXelGXVb.o\": failed\n</code></pre>\n"}, {"tags": ["haskell", "currying", "function-composition", "partial-application", "map-function"], "answers": [{"tags": [], "owner": {"reputation": 17641, "user_id": 16800, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea1de76c4c343fc844135e18da8a80f1?s=128&d=identicon&r=PG", "display_name": "Guvante", "link": "https://stackoverflow.com/users/16800/guvante"}, "is_accepted": false, "score": 4, "last_activity_date": 1444447691, "creation_date": 1444447691, "answer_id": 33049935, "question_id": 33049909, "link": "https://stackoverflow.com/questions/33049909/partial-application-of-functions-and-currying-how-to-make-a-better-code-instead/33049935#33049935", "title": "Partial application of functions and currying, how to make a better code instead of a lot of maps?", "body": "<p>Assuming you don't mind variables you simply define a new function that takes <code>x</code> and calls <code>f</code>. If you don't have a function definition there (you can generally use <code>let</code> or <code>where</code>) you can use a lambda instead.</p>\n\n<pre><code>f' x = f x 1 2 3 4\n</code></pre>\n\n<p>Or with a lambda</p>\n\n<pre><code>\\x -&gt; f x 1 2 3 4\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2513, "user_id": 4725625, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/YwH49.png?s=128&g=1", "display_name": "Kwarrtz", "link": "https://stackoverflow.com/users/4725625/kwarrtz"}, "is_accepted": false, "score": 4, "last_activity_date": 1444449741, "creation_date": 1444449741, "answer_id": 33050126, "question_id": 33049909, "link": "https://stackoverflow.com/questions/33049909/partial-application-of-functions-and-currying-how-to-make-a-better-code-instead/33050126#33050126", "title": "Partial application of functions and currying, how to make a better code instead of a lot of maps?", "body": "<p>Currying won't do you any good here, because the argument you want to vary (enumerate) isn't the last one. Instead, try something like this.</p>\n\n<pre><code>map (\\x -&gt; f x 1 2 3 4) [1..10]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 7, "last_activity_date": 1444455279, "last_edit_date": 1444455279, "creation_date": 1444453911, "answer_id": 33050547, "question_id": 33049909, "link": "https://stackoverflow.com/questions/33049909/partial-application-of-functions-and-currying-how-to-make-a-better-code-instead/33050547#33050547", "title": "Partial application of functions and currying, how to make a better code instead of a lot of maps?", "body": "<p>Others have shown ways you can do it, but I think it's useful to show how to transform your version into something a little nicer. You wrote</p>\n\n<pre><code>map ($ 4) $ map ($ 3) $ map ($ 2) $ map ($ 1) (map f [1..10])\n</code></pre>\n\n<p><code>map</code> obeys two fundamental laws:</p>\n\n<ol>\n<li><code>map id = id</code>. That is, if you map the identity function over any list, you'll get back the same list.</li>\n<li>For any <code>f</code> and <code>g</code>, <code>map f . map g = map (f . g)</code>. That is, mapping over a list with one function and then another one is the same as mapping over it with the <em>composition</em> of those two functions.</li>\n</ol>\n\n<p>The second <code>map</code> law is the one we want to apply here.</p>\n\n<pre><code>map ($ 4) $ map ($ 3) $ map ($ 2) $ map ($ 1) (map f [1..10])\n=\nmap ($ 4) . map ($ 3) . map ($ 2) . map ($ 1) . map f $ [1..10]\n=\nmap (($ 4) . ($ 3) . ($ 2) . ($ 1) . f) [1..10]\n</code></pre>\n\n<p>What does <code>($ a) . ($ b)</code> do? <code>\\x -&gt; ($ a) $ ($ b) x = \\x -&gt; ($ a) $ x b = \\x -&gt; x b a</code>. What about <code>($ a) . ($ b) . ($ c)</code>? That's <code>(\\x -&gt; x b a) . ($ c) = \\y -&gt; (\\x -&gt; x b a) $ ($ c) y = \\y -&gt; y c b a</code>. The pattern now should be clear: <code>($ a) . ($ b) ... ($ y) = \\z -&gt; z y x ... c b a</code>. So ultimately, we get</p>\n\n<pre><code>map ((\\z -&gt; z 1 2 3 4) . f) [1..10]\n=\nmap (\\w -&gt; (\\z -&gt; z 1 2 3 4) (f w)) [1..10]\n=\nmap (\\w -&gt; f w 1 2 3 4) [1..10]\n=\nmap (\\x -&gt; ($ 4) $ ($ 3) $ ($ 2) $ ($ 1) $ f x) [1..10]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10378, "user_id": 2476735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39e9447bbc32246fcd23b76b5e946618?s=128&d=identicon&r=PG&f=1", "display_name": "David Young", "link": "https://stackoverflow.com/users/2476735/david-young"}, "is_accepted": false, "score": 5, "last_activity_date": 1444454556, "creation_date": 1444454556, "answer_id": 33050614, "question_id": 33049909, "link": "https://stackoverflow.com/questions/33049909/partial-application-of-functions-and-currying-how-to-make-a-better-code-instead/33050614#33050614", "title": "Partial application of functions and currying, how to make a better code instead of a lot of maps?", "body": "<p>In addition to what the other answers say, it might be a good idea to reorder the parameters of your function, especially <code>x</code> is usually the parameter that you vary over like that:</p>\n\n<pre><code>f y w z a x = x - y - w - z - a\n</code></pre>\n\n<p>If you make it so that the <code>x</code> parameter comes last, you can just write</p>\n\n<pre><code>map (f 1 2 3 4) [1..10]\n</code></pre>\n\n<p>This won't work in all circumstances of course, but it is good to see what parameters are more likely to vary over a series of calls and put them towards the end of the argument list and parameters that tend to stay the same towards the start. When you do this, currying and partial application will usually help you out more than they would otherwise.</p>\n"}, {"comments": [{"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 3, "creation_date": 1444472194, "post_id": 33051830, "comment_id": 53925982, "body": "one of the best applicative tutorials I&#39;ve seen!"}, {"owner": {"reputation": 11826, "user_id": 480674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fad9d486ce723011505e86c2136937ca?s=128&d=identicon&r=PG", "display_name": "pedrofurla", "link": "https://stackoverflow.com/users/480674/pedrofurla"}, "edited": false, "score": 0, "creation_date": 1444488090, "post_id": 33051830, "comment_id": 53930421, "body": "Don&#39;t really get how nondeterminism fits in applicatives"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1444494094, "post_id": 33051830, "comment_id": 53932322, "body": "I don&#39;t yet understand what idiom brackets add aside from more syntax to learn. You seem to feel rather differently about them. Could you explain?"}, {"owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "edited": false, "score": 0, "creation_date": 1444494949, "post_id": 33051830, "comment_id": 53932593, "body": "@pedrofuria: nondeterminism is simply when you have many outputs from the same logic for potentially many inputs, whereas it all seems to happen in a single expression. as is exactly the case with the list applicative/monad, also known as the indeterminism monad (or smth)."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1451437812, "post_id": 33051830, "comment_id": 56784628, "body": "@dfeuer I think this is explained in the last bit, about boundaries. I can imagine this as writing <code>{IO| ..... {List| .... } ..... {Maybe| ....} .... }</code> or something like that. (?)"}], "tags": [], "owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "is_accepted": false, "score": 14, "last_activity_date": 1444472410, "last_edit_date": 1444472410, "creation_date": 1444464795, "answer_id": 33051830, "question_id": 33049909, "link": "https://stackoverflow.com/questions/33049909/partial-application-of-functions-and-currying-how-to-make-a-better-code-instead/33051830#33051830", "title": "Partial application of functions and currying, how to make a better code instead of a lot of maps?", "body": "<p>All the suggestions so far are good. Here's another, which might seem a bit weird at first, but turns out to be quite handy in lots of other situations.</p>\n\n<p>Some type-forming operators, like <code>[]</code>, which is the operator which maps a type of elements, e.g. <code>Int</code> to the type of lists of those elements, <code>[Int]</code>, have the property of being <code>Applicative</code>. For lists, that means there is some way, denoted by the operator, <code>&lt;*&gt;</code>, pronounced \"apply\", to turn <em>lists</em> of functions and <em>lists</em> of arguments into <em>lists</em> of results.</p>\n\n<pre><code>(&lt;*&gt;) :: [s -&gt; t] -&gt; [s] -&gt; [t]    -- one instance of the general type of &lt;*&gt;\n</code></pre>\n\n<p>rather than your ordinary application, given by a blank space, or a <code>$</code></p>\n\n<pre><code>($)   :: (s -&gt; t) -&gt;  s  -&gt;  t\n</code></pre>\n\n<p>The upshot is that we can do ordinary functional programming with lists of things instead of things: we sometimes call it \"programming in the list <em>idiom</em>\". The only other ingredient is that, to cope with the situation when some of our components are individual things, we need an extra gadget</p>\n\n<pre><code>pure :: x -&gt; [x]   -- again, one instance of the general scheme\n</code></pre>\n\n<p>which wraps a thing up as a list, to be compatible with <code>&lt;*&gt;</code>. That is <code>pure</code> moves an ordinary value into the applicative idiom.</p>\n\n<p>For lists, <code>pure</code> just makes a singleton list and <code>&lt;*&gt;</code> produces the result of every pairwise application of one of the functions to one of the arguments. In particular</p>\n\n<pre><code>pure f &lt;*&gt; [1..10] :: [Int -&gt; Int -&gt; Int -&gt; Int -&gt; Int]\n</code></pre>\n\n<p>is a list of functions (just like <code>map f [1..10]</code>) which can be used with <code>&lt;*&gt;</code> again. The rest of your arguments for <code>f</code> are not listy, so you need to <code>pure</code> them. </p>\n\n<pre><code>pure f &lt;*&gt; [1..10] &lt;*&gt; pure 1 &lt;*&gt; pure 2 &lt;*&gt; pure 3 &lt;*&gt; pure 4\n</code></pre>\n\n<p>For lists, this gives</p>\n\n<pre><code>[f] &lt;*&gt; [1..10] &lt;*&gt; [1] &lt;*&gt; [2] &lt;*&gt; [3] &lt;*&gt; [4]\n</code></pre>\n\n<p>i.e. the list of ways to make an application from the f, one of the [1..10], the 1, the 2, the 3 and the 4.</p>\n\n<p>The opening <code>pure f &lt;*&gt; s</code> is so common, it's abbreviated <code>f &lt;$&gt; s</code>, so</p>\n\n<pre><code>f &lt;$&gt; [1..10] &lt;*&gt; [1] &lt;*&gt; [2] &lt;*&gt; [3] &lt;*&gt; [4]\n</code></pre>\n\n<p>is what would typically be written. If you can filter out the <code>&lt;$&gt;</code>, <code>pure</code> and <code>&lt;*&gt;</code> noise, it kind of looks like the application you had in mind. The extra punctuation is only necessary because Haskell can't tell the difference between a listy computation of a bunch of functions or arguments and a non-listy computation of what's intended as a single value but happens to be a list. At least, however, the components are in the order you started with, so you see more easily what's going on.</p>\n\n<p><strong>Esoterica.</strong> (1) in my (not very) <a href=\"https://personal.cis.strath.ac.uk/conor.mcbride/pub/she/idiom.html\" rel=\"noreferrer\">private dialect</a> of Haskell, the above would be</p>\n\n<pre><code>(|f [1..10] (|1|) (|2|) (|3|) (|4|)|)\n</code></pre>\n\n<p>where each <em>idiom bracket</em>, <code>(|f a1 a2 ... an|)</code> represents the application of a pure function to zero or more arguments which live in the idiom. It's just a way to write</p>\n\n<pre><code>pure f &lt;*&gt; a1 &lt;*&gt; a2 ... &lt;*&gt; an\n</code></pre>\n\n<p>Idris has idiom brackets, but Haskell hasn't added them. Yet.</p>\n\n<p>(2) In languages with algebraic effects, the idiom of nondeterministic computation is not the same thing (to the typechecker) as the data type of lists, although you can easily convert between the two. The program becomes</p>\n\n<pre><code>f (range 1 10) 2 3 4\n</code></pre>\n\n<p>where range nondeterministically chooses a value between the given lower and upper bounds. So, nondetermism is treated as a <em>local</em> side-effect, not a data structure, enabling operations for failure and choice. You can wrap nondeterministic computations in a <em>handler</em> which give meanings to those operations, and one such handler might generate the list of all solutions. That's to say, the extra notation to explain what's going on is pushed to the boundary, rather than peppered through the entire interior, like those <code>&lt;*&gt;</code> and <code>pure</code>. </p>\n\n<p>Managing the boundaries of things rather than their interiors is one of the few good ideas our species has managed to have. But at least we can have it over and over again. It's why we farm instead of hunting. It's why we prefer static type checking to dynamic tag checking. And so on...</p>\n"}, {"comments": [{"owner": {"reputation": 17809, "user_id": 1088108, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/63781cd38e91aa346a3849bc3ef3e550?s=128&d=identicon&r=PG&f=1", "display_name": "&#216;rjan Johansen", "link": "https://stackoverflow.com/users/1088108/%c3%98rjan-johansen"}, "edited": false, "score": 1, "creation_date": 1444492843, "post_id": 33052641, "comment_id": 53931965, "body": "Sorry, but <code>($ 1 2 3 4)</code> does <i>not</i> work. <code>$</code> only handles one argument."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1444495083, "post_id": 33052641, "comment_id": 53932631, "body": "<code>for</code> only works for applicative actions. You&#39;d need to stick <code>Identity</code> and <code>runIdentity</code> and all that nonsense in."}], "tags": [], "owner": {"reputation": 33184, "user_id": 247623, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/bb9e67348d3e0e93ef12dd97c41a6c22?s=128&d=identicon&r=PG&f=1", "display_name": "Erik Kaplun", "link": "https://stackoverflow.com/users/247623/erik-kaplun"}, "is_accepted": false, "score": 1, "last_activity_date": 1444496488, "last_edit_date": 1444496488, "creation_date": 1444470707, "answer_id": 33052641, "question_id": 33049909, "link": "https://stackoverflow.com/questions/33049909/partial-application-of-functions-and-currying-how-to-make-a-better-code-instead/33052641#33052641", "title": "Partial application of functions and currying, how to make a better code instead of a lot of maps?", "body": "<p>The general solution in this situation is a lambda:</p>\n\n<pre><code>\\x -&gt; f x 1 2 3 4\n</code></pre>\n\n<p>however, if you're seeing yourself doing this very often, with the same argument, it would make sense to move that argument to be the last argument instead:</p>\n\n<pre><code>\\x -&gt; f 1 2 3 4 x\n</code></pre>\n\n<p>in which case currying applies perfectly well and you can just replace the above expression with</p>\n\n<pre><code>f 1 2 3 4\n</code></pre>\n\n<p>so in turn you could write:</p>\n\n<pre><code>map (f 1 2 3 4) [1..10]\n</code></pre>\n"}], "owner": {"reputation": 489, "user_id": 3457759, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/dbc9ffc952d1b9de0db160785e7377e0?s=128&d=identicon&r=PG&f=1", "display_name": "Miguelme", "link": "https://stackoverflow.com/users/3457759/miguelme"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 364, "favorite_count": 1, "answer_count": 6, "score": 5, "last_activity_date": 1444496488, "creation_date": 1444447401, "last_edit_date": 1444470871, "question_id": 33049909, "link": "https://stackoverflow.com/questions/33049909/partial-application-of-functions-and-currying-how-to-make-a-better-code-instead", "title": "Partial application of functions and currying, how to make a better code instead of a lot of maps?", "body": "<p>I am a beginner at Haskell and I am trying to grasp it.</p>\n\n<p>I am having the following problem:</p>\n\n<p>I have a function that gets 5 parameters, lets say </p>\n\n<pre><code>f x y w z a = x - y - w - z - a\n</code></pre>\n\n<p>And I would like to apply it while only changing the variable <code>x</code> from <code>1</code> to <code>10</code> whereas <code>y</code>, <code>w</code>, <code>z</code> and <code>a</code> will always be the same. The implementation I achieved was the following but I think there must be a better way.</p>\n\n<p>Let's say I would like to use:</p>\n\n<pre><code>x from 1 to 10\ny = 1 \nw = 2 \nz = 3 \na = 4\n</code></pre>\n\n<p>Accordingly to this I managed to apply the function as following: </p>\n\n<pre><code>map ($ 4) $ map ($ 3) $ map ($ 2) $ map ($ 1) (map f [1..10])\n</code></pre>\n\n<p>I think there must be a better way to apply a lot of missing parameters to partially applied functions without having to use too many maps.</p>\n"}, {"tags": ["haskell", "polymorphism", "typeclass", "existential-type", "higher-rank-types"], "comments": [{"owner": {"reputation": 976, "user_id": 1274282, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nBRxs.png?s=128&g=1", "display_name": "Taylor Fausak", "link": "https://stackoverflow.com/users/1274282/taylor-fausak"}, "edited": false, "score": 0, "creation_date": 1444484564, "post_id": 33049458, "comment_id": 53929396, "body": "This has always bugged me. I hate that <code>[show 1, show &quot;a&quot;]</code> and <code>map show [1, &quot;a&quot;]</code> aren&#39;t the same."}], "answers": [{"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": true, "score": 13, "last_activity_date": 1444456244, "last_edit_date": 1444456244, "creation_date": 1444446136, "answer_id": 33049807, "question_id": 33049458, "link": "https://stackoverflow.com/questions/33049458/why-is-1-a-forall-a-show-a-a-not-allowed/33049807#33049807", "title": "Why is `[1, &quot;a&quot;] :: [forall a. Show a =&gt; a]` not allowed?", "body": "<p>Your understanding is not right. A big part of the problem is that the traditional existential quantification syntax you've used is pretty confusing to anyone who isn't thoroughly familiar with it. I therefore strongly recommend that you use GADT syntax instead, which also has the benefit of being strictly more powerful. The easy thing to do is just to enable <code>{-# LANGUAGE GADTs #-}</code>. While we're at it, let's turn on <code>{-# LANGUAGE ScopedTypeVariables #-}</code>, because I hate wondering what <code>forall</code> means in any given spot. Your <code>V</code> definition means exactly the same thing as</p>\n\n<pre><code>data V where\n  V :: forall a . Show a =&gt; a -&gt; V\n</code></pre>\n\n<p>We can actually drop the explicit <code>forall</code> if we like:</p>\n\n<pre><code>data V where\n  V :: Show a =&gt; a -&gt; V\n</code></pre>\n\n<p>So the <code>V</code> data constructor is a function that takes something of <em>any</em> showable type and produces something of type <code>V</code>. The type of <code>map</code> is pretty restrictive:</p>\n\n<pre><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]\n</code></pre>\n\n<p>All the elements of the list passed to <code>map</code> have to have the same type. So the type of <code>map V</code> is just</p>\n\n<pre><code>map V :: Show a =&gt; [a] -&gt; [V]\n</code></pre>\n\n<p>Let's get back to your first expression now:</p>\n\n<pre><code>[1, \"a\"] :: [forall a. Show a =&gt; a]\n</code></pre>\n\n<p>Now what this actually says is that <code>[1, \"a\"]</code> is a list, each of whose elements has type <code>forall a . Show a =&gt; a</code>. That is, if I provide any <code>a</code> that's an instance of <code>Show</code>, each element of the list should have that type. This is simply not true. <code>\"a\"</code> does not, for example, have type <code>Bool</code>. There's yet another problem here; the type <code>[forall a . Show a =&gt; a]</code> is \"impredicative\". I don't understand the details of what that means, but loosely speaking you've stuck a <code>forall</code> in the argument of a type constructor other than <code>-&gt;</code>, and that's not allowed. GHC might suggest that you enable the <code>ImpredicativeTypes</code> extension, but this really doesn't work right, so you shouldn't. If you want a list of existentially quantified things, you need to wrap them up first in existential datatypes or use a specialized existential list type. If you want a list of universally quantified things, you need to wrap them up first (probably in newtypes).</p>\n"}], "owner": {"reputation": 2418, "user_id": 1232832, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/2c492983af89b49d44250c79579a2641?s=128&d=identicon&r=PG", "display_name": "Shou Ya", "link": "https://stackoverflow.com/users/1232832/shou-ya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 1, "accepted_answer_id": 33049807, "answer_count": 1, "score": 13, "last_activity_date": 1605629936, "creation_date": 1444442221, "last_edit_date": 1605629936, "question_id": 33049458, "link": "https://stackoverflow.com/questions/33049458/why-is-1-a-forall-a-show-a-a-not-allowed", "title": "Why is `[1, &quot;a&quot;] :: [forall a. Show a =&gt; a]` not allowed?", "body": "<p>In my (might incorrect) understanding, following two lists should be equivalent:</p>\n\n<pre><code>[1, \"a\"] :: [forall a. Show a =&gt; a]\n\ndata V = forall a. Show a =&gt; V a\n[V 1, V \"a\"] :: [V]\n</code></pre>\n\n<p>However, the first one is not accepted but the second one works fine (with <code>ExistentialQuantification</code>).</p>\n\n<p>If the first list doesn't exist, what would be the type in the blank of <code>map V :: ??? -&gt; [V]</code>? What type mechanism enforces the existence of the wrapper? </p>\n"}]