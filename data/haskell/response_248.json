[{"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 58, "user_id": 12043137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a510f94f15116ec9e7574f94bc5c419?s=128&d=identicon&r=PG&f=1", "display_name": "user12043137", "link": "https://stackoverflow.com/users/12043137/user12043137"}, "edited": false, "score": 0, "creation_date": 1570734543, "post_id": 58318261, "comment_id": 103017216, "body": "Thank you, this was my initial thought although I was suspicious because I figured state monads are supposed to eliminate explicit state passing everywhere, so I thought maybe I&#39;m missing something.  I suppose that <code>ST s</code> isn&#39;t really a traditional state monad though."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 58, "user_id": 12043137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a510f94f15116ec9e7574f94bc5c419?s=128&d=identicon&r=PG&f=1", "display_name": "user12043137", "link": "https://stackoverflow.com/users/12043137/user12043137"}, "edited": false, "score": 0, "creation_date": 1570738414, "post_id": 58318261, "comment_id": 103018796, "body": "@user12043137 Indeed it is not. It is most often used when we want to have many references around, instead of just one as in your case. I guess you could use <code>ReaderT (STRef s State) (ST s) a</code> as a monad which implicitly gives you read access to the state pointer (hence read/write access to the state). One could even make this into a <code>MonadState</code>-class type, using a wrapper. I wonder if this already exists in the libraries somewhere. Note that one should also benchmark this -- it could be slower than the basic state monad for simple state types."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 0, "last_activity_date": 1570695098, "creation_date": 1570695098, "answer_id": 58318261, "question_id": 58313493, "link": "https://stackoverflow.com/questions/58313493/using-st-monad-for-efficiency-purposes/58318261#58318261", "title": "Using ST monad for efficiency purposes", "body": "<p>Only approach 1 seems to be viable, in the general case.</p>\n\n<p>When <code>runST action</code> returns and delivers its result, it will deallocate all the memory which has been allocated running the <code>action</code> using <code>newSTRef</code>. If you use one <code>runST</code> per function, you can't have any reference persist across function calls. Even if you don't need that, making each function call allocate its mutable state on entry only to deallocate it on exit (as in your option 2) looks pointless. I would just pass a <code>STRef s State</code> around, and mutate the state through that.</p>\n\n<p>There might be other aspects to consider, though. If a function performs many mutations inside, option 2 might still be OK, since the extra cost of entering/leaving would be negligible.</p>\n\n<p>(I probably don't completely understand your option 3. Isn't it option 1, essentially?)</p>\n"}], "owner": {"reputation": 58, "user_id": 12043137, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a510f94f15116ec9e7574f94bc5c419?s=128&d=identicon&r=PG&f=1", "display_name": "user12043137", "link": "https://stackoverflow.com/users/12043137/user12043137"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 58318261, "answer_count": 1, "score": 1, "last_activity_date": 1570695098, "creation_date": 1570663551, "question_id": 58313493, "link": "https://stackoverflow.com/questions/58313493/using-st-monad-for-efficiency-purposes", "title": "Using ST monad for efficiency purposes", "body": "<p>I have some traditional state-passing code which I need to optimize.  I've heard that if you're maintaining and updating state a lot that using the <code>ST</code> monad can help improve efficiency.  However, after looking into the <code>ST</code> stuff a bit I'm a bit unclear as to how/where the <code>ST</code> monad should be used.  </p>\n\n<p>A couple of approaches that come to mind:</p>\n\n<ol>\n<li><p>Instead of passing state everywhere, pass <code>STRef</code>'s instead.  So for instance, <code>foo :: State -&gt; a -&gt; b -&gt; (State,c)</code> becomes <code>foo :: STRef s State -&gt; a -&gt; b -&gt; ST s c</code> and so on.</p></li>\n<li><p>Keep my function signatures the same but use <code>ST</code> under the hood using <code>runST</code>.</p></li>\n<li><p>Only use <code>ST</code> when updating the state in my main execution loop and escape <code>ST</code> using either <code>runST</code> or <code>stToIO</code>.</p></li>\n</ol>\n\n<p>Obviously, these questions will ultimately depend on the specifics of my project but I'm wondering if there are any rule-of-thumb type guidelines that might be helpful before more detail is required.</p>\n"}, {"tags": ["haskell", "installation"], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 12016848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07eda1809ab44c2fb483c41f3408edf8?s=128&d=identicon&r=PG&f=1", "display_name": "Hannah_McDermott", "link": "https://stackoverflow.com/users/12016848/hannah-mcdermott"}, "edited": false, "score": 0, "creation_date": 1570659189, "post_id": 58312920, "comment_id": 102986853, "body": "I am getting &#39;Permission denied&#39; and I am not sure why?"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 5, "user_id": 12016848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07eda1809ab44c2fb483c41f3408edf8?s=128&d=identicon&r=PG&f=1", "display_name": "Hannah_McDermott", "link": "https://stackoverflow.com/users/12016848/hannah-mcdermott"}, "edited": false, "score": 0, "creation_date": 1570659241, "post_id": 58312920, "comment_id": 102986867, "body": "When running <code>echo XYZ &gt;&gt; ~&#47;.bashrc</code>?"}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1570661660, "post_id": 58312920, "comment_id": 102987424, "body": "Given that <code>PATH</code> is inherited, something that modifies it should probably just go in <code>.bash_profile</code> so that it only gets added once, when you first log in. (This goes doubly for macOS, since by default most terminal emulators start a login shell instead of an ordinary interactive shell.)"}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1570692848, "post_id": 58312920, "comment_id": 102995103, "body": "@chepner makes sense, why not explain in a separate answer."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1570715797, "post_id": 58312920, "comment_id": 103007850, "body": "I think the issue of <i>which</i> file to update is borderline off-topic here, and trying to cater everyone&#39;s possible shell blows up too quickly. (Very shortly, it&#39;s no longer going to be a valid assumption that a macOS user&#39;s shell <i>is</i> <code>bash</code>, as macOS 10.15 makes <code>zsh</code> the default user shell.) Also, I don&#39;t know what&#39;s actually in the file, so I don&#39;t know if there&#39;s a <i>reason</i> for it to appear in the interactive shell configuration file rather than the login file."}], "tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": false, "score": 1, "last_activity_date": 1570658850, "creation_date": 1570658850, "answer_id": 58312920, "question_id": 58312451, "link": "https://stackoverflow.com/questions/58312451/haskell-installation/58312920#58312920", "title": "Haskell installation", "body": "<p>What the instructions are literally telling you is to add the line</p>\n\n\n\n<pre class=\"lang-sh prettyprint-override\"><code>source /Users/hannahmcdermott/.ghcup/env\n</code></pre>\n\n<p>(or shorter, <code>. ~/.ghcup/env</code>) to the file <code>~/.bashrc</code>. You can do that with one interactive command:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>echo '. ~/.ghcup/env' &gt;&gt; ~/.bashrc\n</code></pre>\n\n<p>Then, whenever you open a new bash terminal window (which always loads the <code>~/.bashrc</code> file), the necessary environment variable should be loaded. At least this works in a Linux system; not sure if it needs adaption on MacOS.</p>\n\n<p>What that <code>env</code> script you're invoking there does is in turn simply adding some stuff to bash's <code>$PATH</code> environment variable, which means you get to call programs in the <code>~/.cabal/bin</code> directory without needing to specify their exact path.</p>\n"}], "owner": {"reputation": 5, "user_id": 12016848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07eda1809ab44c2fb483c41f3408edf8?s=128&d=identicon&r=PG&f=1", "display_name": "Hannah_McDermott", "link": "https://stackoverflow.com/users/12016848/hannah-mcdermott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1004, "favorite_count": 1, "answer_count": 1, "score": -2, "last_activity_date": 1570658850, "creation_date": 1570655895, "question_id": 58312451, "link": "https://stackoverflow.com/questions/58312451/haskell-installation", "title": "Haskell installation", "body": "<p>I am trying to install Haskell, and the installation was successfull, but it tells me that I have to adjust my PATH variable? Here are the instructions to finalize the installations and be able to run Haskell: </p>\n\n<pre><code>In order to run ghc and cabal, you need to adjust your PATH \nvariable.\nYou may want to source '/Users/hannahmcdermott/.ghcup/env' in \nyour shell configuration to do so (e.g. ~/.bashrc).\n</code></pre>\n\n<p>Could someone tell me what to type into the terminal?:) Thankyou!</p>\n"}, {"tags": ["haskell", "recursion", "lazy-evaluation", "fibonacci", "memoization"], "answers": [{"tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 1, "last_activity_date": 1570663095, "creation_date": 1570663095, "answer_id": 58313442, "question_id": 58312364, "link": "https://stackoverflow.com/questions/58312364/how-does-haskell-manage-memory-of-recursive-function-calls/58313442#58313442", "title": "How does haskell manage memory of recursive function calls", "body": "<p>The list defined by <code>map fib [0..]</code> is defined as part of the <em>definition</em> of the function, rather than being created each time the function is called. Due to laziness, though, the list is only \"realized\" as necessary for any given call.</p>\n\n<p>Say your first call is <code>memoized_fib 10</code>. This will cause the first 10 Fibonacci numbers to actually be computed and stored in memory, and they will stay in memory for the duration of the program. Subsequent calls with a smaller argument don't need to compute anything; subsequent calls with larger arguments need only compute those elements that occur later in the list than the largest existing element.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1570711000, "post_id": 58317749, "comment_id": 103004772, "body": "BTW, <a href=\"https://stackoverflow.com/a/11466959/849891\">apparently</a>, older GHC with -O2 would compile even the <code>not_memoized_fib</code> as a memoizing one. do we know for sure what the more current versions do? perhaps this is related to the CSE changes..."}, {"owner": {"reputation": 34158, "user_id": 7203016, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybAMw.png?s=128&g=1", "display_name": "K. A. Buhr", "link": "https://stackoverflow.com/users/7203016/k-a-buhr"}, "edited": false, "score": 0, "creation_date": 1571081031, "post_id": 58317749, "comment_id": 103113929, "body": "With GHC 8.6.4 and <code>-O2</code>, both <code>memoized_fib</code> and <code>not_memoized_fib</code> are equally fast.  Switching to <code>last $ map fib [0..m]</code> makes it (extremely) slow."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 2, "last_activity_date": 1570710038, "last_edit_date": 1570710038, "creation_date": 1570693048, "answer_id": 58317749, "question_id": 58312364, "link": "https://stackoverflow.com/questions/58312364/how-does-haskell-manage-memory-of-recursive-function-calls/58317749#58317749", "title": "How does haskell manage memory of recursive function calls", "body": "<p>I think it's easier to understand if you compare your definition to this:</p>\n\n<pre><code>not_memoized_fib :: Int -&gt; Integer\nnot_memoized_fib m = map fib [0 ..] !! m\n   where fib 0 = 0\n         fib 1 = 1\n         fib n = not_memoized_fib (n-2) + not_memoized_fib (n-1)\n</code></pre>\n\n<p>The definition above is essentially the same as yours, except that it takes an explicit argument <code>m</code>. It is a so-called eta-expansion of the previous function, and is <em>semantically</em> equivalent to it. Yet, operationally, this has drastically worse performance, since memoization here does not take place.</p>\n\n<p>Why? Well, your function defines the list <code>map fib [0..]</code> <em>before</em> taking the (implicit) input parameter <code>m</code>, so there is only one list around, for all <code>m</code> we may pass later on as arguments. Instead, in <code>not_memoized_fib</code> we first take <code>m</code> as input, and then define the list, making the function create a list for every call to <code>not_memoized_fib</code>, destroying performance.</p>\n\n<p>It is even easier to see if we use <code>let</code> and lambdas instead of <code>where</code>. Compare</p>\n\n<pre><code>memoized :: Int -&gt; Integer\nmemoized = let\n   list = map fib [0..]\n   fib 0 = 0\n   fib 1 = 1\n   fib n = memoized (n-1) + memoized (n-2)\n   in \\m -&gt; list !! m\n   -- ^^ here we take m, after everything is defined,\n</code></pre>\n\n<p>with its <i>let over lambda<sup>&hairsp;(*)</sup></i> code structure, to</p>\n\n<pre><code>not_memoized :: Int -&gt; Integer\nnot_memoized = \\m -&gt; let\n            -- ^^ here we take m, before everything is defined, so\n            -- we define local bindings {list,fib} at every call\n   list = map fib [0..]\n   fib 0 = 0\n   fib 1 = 1\n   fib n = not_memoized (n-1) + not_memoized (n-2)\n   in list !! m\n</code></pre>\n\n<p>with the let <em>inside</em> the lambda.</p>\n\n<p>In the former case, there is only one list around, while in the latter there is one list for each call.</p>\n\n<hr>\n\n<p><sub><sup>(*)</sup> a <em>searchable</em> term.</sub></p>\n"}], "owner": {"reputation": 1570, "user_id": 3324507, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/653f2f879a98a201288ef32e6e344163?s=128&d=identicon&r=PG&f=1", "display_name": "sgp667", "link": "https://stackoverflow.com/users/3324507/sgp667"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1570710038, "creation_date": 1570655444, "last_edit_date": 1570703667, "question_id": 58312364, "link": "https://stackoverflow.com/questions/58312364/how-does-haskell-manage-memory-of-recursive-function-calls", "title": "How does haskell manage memory of recursive function calls", "body": "<p>I have been working on a problem that benefits a lot from catching results of my functions and in my research I came across <a href=\"https://wiki.haskell.org/Memoization\" rel=\"nofollow noreferrer\">this</a> article. I am stunned at how simple is the core in \"Memoization with recursion\" section namely:</p>\n\n<pre><code>memoized_fib :: Int -&gt; Integer\nmemoized_fib = (map fib [0 ..] !!)\n   where fib 0 = 0\n         fib 1 = 1\n         fib n = memoized_fib (n-2) + memoized_fib (n-1)\n</code></pre>\n\n<p>I feel like I understand <strong>how</strong> it work but do correct me if I'm wrong - this function saves a list which is populated using same function. </p>\n\n<p>What bothers me is that I don't understand <strong>why</strong> this works, originally I was under impression that once haskell evaluates a function it releases memory that was used to store variables inside this function, but here it seems that if part of the list was evaluated by one call of this function those values are still available to another call of the same function. </p>\n\n<p>Just typing this up makes my head hurt, because I don't understand why value used in calculation of <code>fib 2</code> should be available in calculation of <code>fib 3</code> or better yest <code>fib 100</code>?</p>\n\n<p>My gut feeling tells me that this behavior has two problems(I'm probably wrong but again not sure why):</p>\n\n<ul>\n<li>purity of this function we are evaluating one call using variable that did not arrive from parameters of this function</li>\n<li>memory leaks no longer sure when will haskell release memory from this list</li>\n</ul>\n"}, {"tags": ["haskell", "recursion", "list-comprehension"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1570654825, "post_id": 58311829, "comment_id": 102985533, "body": "Consider that <code>subsetsOfThree [1,2,3,4]</code> makes one recursive call <code>subsetsOfThree [4]</code>, which results in <code>[]</code>. Since <code>xs1</code> is drawing from an empty list, none of the other generators are used."}], "answers": [{"comments": [{"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 0, "creation_date": 1570654763, "post_id": 58312118, "comment_id": 102985502, "body": "You even make my function make sense and work properly, I will quote you in an answer of mine, and give to you a bounty if stack overflow let me"}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 0, "creation_date": 1570655088, "post_id": 58312118, "comment_id": 102985624, "body": "I add the bounty in this question <a href=\"https://stackoverflow.com/questions/58262463/filter-subsets-based-on-length\" title=\"filter subsets based on length\">stackoverflow.com/questions/58262463/&hellip;</a> because I cannot add it in this one, if you answer there you get the bounty for you help, thanks so much"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 0, "creation_date": 1570657054, "post_id": 58312118, "comment_id": 102986287, "body": "@Dami&#225;nRafaelLattenero Thank you, but don&#39;t worry about giving me a bounty. Quoting with credit, as you did, is already enough."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1570724923, "post_id": 58312118, "comment_id": 103013012, "body": "@chi the bounty is already there. the rep is already spent. :)"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 4, "last_activity_date": 1570654377, "creation_date": 1570654377, "answer_id": 58312118, "question_id": 58311829, "link": "https://stackoverflow.com/questions/58311829/convert-recursion-into-list-comprehension/58312118#58312118", "title": "Convert recursion into list comprehension", "body": "<p>I think you might want to exploit the <code>tails</code> helper function:</p>\n\n<pre><code>subsetsOfThree ws = [ [x,y,z] | (x:xs) &lt;- tails ws, (y:ys) &lt;- tails xs, z &lt;- ys ]\n</code></pre>\n\n<p>This relies on <code>(_:_) &lt;- list</code> generating nothing when <code>list</code> is empty, rather than throwing a runtime error.</p>\n"}], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 1, "accepted_answer_id": 58312118, "answer_count": 1, "score": 1, "last_activity_date": 1570654377, "creation_date": 1570653003, "question_id": 58311829, "link": "https://stackoverflow.com/questions/58311829/convert-recursion-into-list-comprehension", "title": "Convert recursion into list comprehension", "body": "<p>I have this function:</p>\n\n<pre><code>subsetsOfThree [] = []\nsubsetsOfThree [x,y,z] = [[x,y,z]]\nsubsetsOfThree fls@(x:y:z:xs) = ([x,y,z] : subsetsOfThree (xs))  ++ \n  (subsetsOfThree (x:xs)) ++\n  (subsetsOfThree (y:xs)) ++ \n  (subsetsOfThree (z:xs)) ++ \n  (subsetsOfThree (x:y:xs)) ++\n  (subsetsOfThree (x:z:xs)) ++ \n  (subsetsOfThree (y:z:xs)) \nsubsetsOfThree _ = []\n</code></pre>\n\n<p>And it take only the subsets of length 3, but I cannot get rid of converting it in equivalent list comprehension, I tryed:</p>\n\n<pre><code>subsetsOfThree [] = []\nsubsetsOfThree [x,y,z] = [[x,y,z]]\nsubsetsOfThree (x:y:z:xs) = [xs6 | xs1 &lt;- subsetsOfThree xs,\n xs2 &lt;- [xs1, (x:xs)],\n xs3 &lt;- [xs2, (y:xs)],\n xs4 &lt;- [xs3, (z:xs)],\n xs5 &lt;- [xs4, (x:y:xs)],\n xs6 &lt;- [xs5, (y:z:xs)]\n ]\nsubsetsOfThree _ = [] \n</code></pre>\n\n<p>But it always returns <code>[]</code></p>\n\n<p>Any clue will be appreciated </p>\n"}, {"tags": ["scala", "haskell", "crud", "generic-programming"], "answers": [{"comments": [{"owner": {"reputation": 1510, "user_id": 2142728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b3ca006aaf7a1160f11d133c2762e75f?s=128&d=identicon&r=PG", "display_name": "Alejandro Navas", "link": "https://stackoverflow.com/users/2142728/alejandro-navas"}, "edited": false, "score": 0, "creation_date": 1570646771, "post_id": 58310205, "comment_id": 102982333, "body": "What does &quot;c&quot; represent in your example?"}, {"owner": {"reputation": 380, "user_id": 1635672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdd0c9e0a1fd1b3f1bb3e1184eb01b64?s=128&d=identicon&r=PG", "display_name": "Zhu Jinxuan", "link": "https://stackoverflow.com/users/1635672/zhu-jinxuan"}, "reply_to_user": {"reputation": 1510, "user_id": 2142728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b3ca006aaf7a1160f11d133c2762e75f?s=128&d=identicon&r=PG", "display_name": "Alejandro Navas", "link": "https://stackoverflow.com/users/2142728/alejandro-navas"}, "edited": false, "score": 0, "creation_date": 1570655071, "post_id": 58310205, "comment_id": 102985618, "body": "If you like to use <code>StateT IO</code>, then you can just remove <code>c</code>.  But if you want to put some infomation as bifunctor, perhaps putting <code>c</code> here is useful."}, {"owner": {"reputation": 380, "user_id": 1635672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdd0c9e0a1fd1b3f1bb3e1184eb01b64?s=128&d=identicon&r=PG", "display_name": "Zhu Jinxuan", "link": "https://stackoverflow.com/users/1635672/zhu-jinxuan"}, "reply_to_user": {"reputation": 1510, "user_id": 2142728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b3ca006aaf7a1160f11d133c2762e75f?s=128&d=identicon&r=PG", "display_name": "Alejandro Navas", "link": "https://stackoverflow.com/users/2142728/alejandro-navas"}, "edited": false, "score": 0, "creation_date": 1570655694, "post_id": 58310205, "comment_id": 102985854, "body": "For example, you may like to put entity id into process.  And intercept <code>Curd Id a</code> as <code>IO (Id,a)</code>, which gives the new entity id of the Create operation."}, {"owner": {"reputation": 380, "user_id": 1635672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdd0c9e0a1fd1b3f1bb3e1184eb01b64?s=128&d=identicon&r=PG", "display_name": "Zhu Jinxuan", "link": "https://stackoverflow.com/users/1635672/zhu-jinxuan"}, "reply_to_user": {"reputation": 1510, "user_id": 2142728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b3ca006aaf7a1160f11d133c2762e75f?s=128&d=identicon&r=PG", "display_name": "Alejandro Navas", "link": "https://stackoverflow.com/users/2142728/alejandro-navas"}, "edited": false, "score": 0, "creation_date": 1570655871, "post_id": 58310205, "comment_id": 102985910, "body": "My mistake, I shall put c in Delete and Insert."}, {"owner": {"reputation": 1510, "user_id": 2142728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b3ca006aaf7a1160f11d133c2762e75f?s=128&d=identicon&r=PG", "display_name": "Alejandro Navas", "link": "https://stackoverflow.com/users/2142728/alejandro-navas"}, "edited": false, "score": 0, "creation_date": 1570804614, "post_id": 58310205, "comment_id": 103042124, "body": "But that doesn&#39;t answer my question. I&#39;m not that knowledgeable about Haskell, but regardless of that, my question is about how to represent typesafely that the CRUD service implemented will provide certain values on creation (such as creation timestamp and/or id)"}, {"owner": {"reputation": 380, "user_id": 1635672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdd0c9e0a1fd1b3f1bb3e1184eb01b64?s=128&d=identicon&r=PG", "display_name": "Zhu Jinxuan", "link": "https://stackoverflow.com/users/1635672/zhu-jinxuan"}, "reply_to_user": {"reputation": 1510, "user_id": 2142728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b3ca006aaf7a1160f11d133c2762e75f?s=128&d=identicon&r=PG", "display_name": "Alejandro Navas", "link": "https://stackoverflow.com/users/2142728/alejandro-navas"}, "edited": false, "score": 0, "creation_date": 1571073225, "post_id": 58310205, "comment_id": 103110853, "body": "Sorry, I misunderstood your question.  Do you mean something like servant (for RESTful) or like bean (for database)?  Servant: <a href=\"https://docs.servant.dev/en/stable/tutorial/Server.html\" rel=\"nofollow noreferrer\">docs.servant.dev/en/stable/tutorial/Server.html</a>. Beam: <a href=\"https://tathougies.github.io/beam/\" rel=\"nofollow noreferrer\">tathougies.github.io/beam</a>"}], "tags": [], "owner": {"reputation": 380, "user_id": 1635672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdd0c9e0a1fd1b3f1bb3e1184eb01b64?s=128&d=identicon&r=PG", "display_name": "Zhu Jinxuan", "link": "https://stackoverflow.com/users/1635672/zhu-jinxuan"}, "is_accepted": false, "score": 3, "last_activity_date": 1570655846, "last_edit_date": 1570655846, "creation_date": 1570645871, "answer_id": 58310205, "question_id": 58309976, "link": "https://stackoverflow.com/questions/58309976/how-to-deal-with-automatically-generated-values-in-strongly-types-languages-when/58310205#58310205", "title": "How to deal with automatically generated values in strongly types languages when defining a generic CRUD?", "body": "\n\n<ol>\n<li><p>Normally you can use a typeclass in a tagless way, where</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>class (MonadIO mio) =&gt; Crud a mio where\n  read :: ? -&gt; mio a\n</code></pre>\n\n<p>Personally I do not like it</p></li>\n<li><p>But I would recommend you use Free Monad that</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data Crud c a where\n  Read :: c -&gt; Crud c a\n  Insert :: c -&gt; a -&gt; Crud c a\n  Create :: a -&gt; Crud c a\n  Delete :: c -&gt; Crud c a\n  deriving Functor\n</code></pre>\n\n<p>Then intercept the algebra to <code>IO</code>.</p></li>\n</ol>\n"}], "owner": {"reputation": 1510, "user_id": 2142728, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b3ca006aaf7a1160f11d133c2762e75f?s=128&d=identicon&r=PG", "display_name": "Alejandro Navas", "link": "https://stackoverflow.com/users/2142728/alejandro-navas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1570655846, "creation_date": 1570644777, "question_id": 58309976, "link": "https://stackoverflow.com/questions/58309976/how-to-deal-with-automatically-generated-values-in-strongly-types-languages-when", "title": "How to deal with automatically generated values in strongly types languages when defining a generic CRUD?", "body": "<p>So I imagine that a generic CRUD has all basic operations on some type. Insert, read, delete, etc.\nYet how do I define an \"insert\" operation on such generic type if the crud internally will generate some of the values?</p>\n\n<pre><code>trait GenericCrud[E]{\n    def insert(value:E): Unit // but in the insert I really don't want to provide a value E, but some incomplete version of it.\n}\n</code></pre>\n"}, {"tags": ["list", "haskell"], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 5, "last_activity_date": 1570644870, "creation_date": 1570644870, "answer_id": 58310004, "question_id": 58309925, "link": "https://stackoverflow.com/questions/58309925/count-non-empty-lists-in-a-lists-of-lists/58310004#58310004", "title": "Count non-empty lists in a lists of lists", "body": "<p>I think your base case, can be simplified. As a base-case, we can take the empty list <code>[]</code>, not a singleton list with an empty list. For the recursive case, we can consider <code>(x:xs)</code>. Here we will need to make a distinction between <code>x</code> being an empty list, and <code>x</code> being a non-empty list. We can do that with pattern matching, or with guards:</p>\n\n<pre><code>nonEmptyCount :: [[a]] -&gt; Int\nnonEmptyCount <b>[]</b> = 0\nnonEmptyCount (x:xs) = -- &hellip;</code></pre>\n\n<p>That being said, you do not need recursion at all. You can first <em>filter</em> your list, to omit empty lists, and then call length on that list:</p>\n\n<pre><code>nonEmptyCount :: [[a]] -&gt; Int\nnonEmptyCount = length . filter (&hellip;)</code></pre>\n\n<p>here you still need to fill in <code>&hellip;</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1570719694, "post_id": 58310366, "comment_id": 103010236, "body": "or, more <i>value-oriented</i>, <code>nonEmptyCount (x:xs) = (if null x then 1 else 0) + nonEmptyCount xs</code>. less &quot;how&quot;, more &quot;what&quot;. :)"}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1572888289, "post_id": 58310366, "comment_id": 103692917, "body": "@WillNess, or even <code>nonEmptyCount (x:xs) = fromEnum (null x) + nonEmptyCount xs</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1572892534, "post_id": 58310366, "comment_id": 103694646, "body": "@dfeuer like in C, huh. <code>fromEnum</code> here can feel a bit opaque though, needs a bit getting used to. (?) another, more visually apparent possibility: <code>bool 0 1</code>."}], "tags": [], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "is_accepted": false, "score": 2, "last_activity_date": 1570646583, "creation_date": 1570646583, "answer_id": 58310366, "question_id": 58309925, "link": "https://stackoverflow.com/questions/58309925/count-non-empty-lists-in-a-lists-of-lists/58310366#58310366", "title": "Count non-empty lists in a lists of lists", "body": "<p>Old fashion pattern matching should be:</p>\n\n<pre><code>import Data.List\n\nnonEmptyCount :: [[a]] -&gt; Int\nnonEmptyCount []     = 0\nnonEmptyCount (x:xs) = if null x then 1 + (nonEmptyCount xs) else nonEmptyCount xs \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 1, "last_activity_date": 1572936028, "last_edit_date": 1572936028, "creation_date": 1570714299, "answer_id": 58324178, "question_id": 58309925, "link": "https://stackoverflow.com/questions/58309925/count-non-empty-lists-in-a-lists-of-lists/58324178#58324178", "title": "Count non-empty lists in a lists of lists", "body": "<p>The following was posted in a comment, now deleted:</p>\n\n<pre><code>countNE = sum&lt;$&gt;(1&lt;$)&lt;&lt;&lt;(&gt;&gt;=(1`take`))\n</code></pre>\n\n<p>This most certainly will look intimidating to the non-initiated, but actually, it is equivalent to</p>\n\n<pre><code>        = sum &lt;$&gt; (1 &lt;$) &lt;&lt;&lt; (&gt;&gt;= (1 `take`))\n        = sum &lt;$&gt; (1 &lt;$) . (take 1 =&lt;&lt;)\n        = sum . fmap (const 1) . concatMap (take 1)\n        = sum . map (const 1) . concat . map (take 1)\n</code></pre>\n\n<p>which is further equivalent to</p>\n\n<pre><code>countNE xs  =  sum . map (const 1) . concat $ map (take 1) xs\n            =  sum . map (const 1) $ concat [take 1 x | x &lt;- xs]\n            =  sum . map (const 1) $ [ r | x &lt;- xs, r &lt;- take 1 x]\n            =  sum $ [const 1 r | (y:t) &lt;- xs, r &lt;- take 1 (y:t)]   -- sneakiness!\n            =  sum   [const 1 r | (y:_) &lt;- xs, r &lt;- [y]]\n            =  sum   [const 1 y | (y:_) &lt;- xs]\n            =  sum   [ 1        | (_:_) &lt;- xs]    -- replace each\n                         --   non-empty list\n                         --             in \n                         --                xs\n               -- with 1, and\n           --  sum all the 1s up!\n            =  (length . (take 1 =&lt;&lt;)) xs\n            =  (length . filter (not . null)) xs\n</code></pre>\n\n<p>which should be much clearer, even if in a bit sneaky way. It isn't recursive in itself, yes, but both <code>sum</code> and the <a href=\"/questions/tagged/list-comprehension\" class=\"post-tag\" title=\"show questions tagged &#39;list-comprehension&#39;\" rel=\"tag\">list-comprehension</a> would be implemented recursively by a given Haskell implementation.</p>\n\n<p>This reimplements <code>length</code> as <code>sum . (1 &lt;$)</code>, and <code>filter p xs</code> as <code>[x | x &lt;- xs, p x]</code>, and uses the equivalence <code>not (null xs) === (length xs) &gt;= 1</code>.</p>\n\n<p>See? Haskell is fun. Even if it doesn't yet feel like it, but it will be. :)</p>\n"}], "owner": {"reputation": 189, "user_id": 12118780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1672f667ef2e09d09ff3f4d20079fce?s=128&d=identicon&r=PG&f=1", "display_name": "Beszteri", "link": "https://stackoverflow.com/users/12118780/beszteri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 0, "accepted_answer_id": 58310004, "answer_count": 3, "score": 1, "last_activity_date": 1572936028, "creation_date": 1570644571, "last_edit_date": 1572883537, "question_id": 58309925, "link": "https://stackoverflow.com/questions/58309925/count-non-empty-lists-in-a-lists-of-lists", "title": "Count non-empty lists in a lists of lists", "body": "<p>I am trying to count the number of non-empty lists in a list of lists with recursive code.\nMy goal is to write something simple like:</p>\n\n<pre><code>prod :: Num a =&gt; [a] -&gt; a\nprod [] = 1\nprod (x:xs) = x * prod xs\n</code></pre>\n\n<p>I already have the deifniton and an idea for the edge condition:</p>\n\n<pre><code>nonEmptyCount :: [[a]] -&gt; Int\nnonEmptyCount [[]] = 0\n</code></pre>\n\n<p>I have no idea how to continue, any tips?</p>\n"}, {"tags": ["haskell", "recursion", "tree"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1570644527, "post_id": 58309884, "comment_id": 102981309, "body": "Hint: If <code>key &lt; a</code>, you still return a <code>BSNode</code> that <i>contains</i> the <code>key</code>. The same for <code>b &lt; key</code>."}, {"owner": {"reputation": 62252, "user_id": 1435869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/TrEd9.jpg?s=128&g=1", "display_name": "karakfa", "link": "https://stackoverflow.com/users/1435869/karakfa"}, "edited": false, "score": 1, "creation_date": 1570644756, "post_id": 58309884, "comment_id": 102981433, "body": "what&#39;s it to do with the height of the tree?"}, {"owner": {"reputation": 77, "user_id": 12153461, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-v3T0oc6csTw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdJ_yKXt7W9RyNRLbo2vYpqsi3rEA/photo.jpg?sz=128", "display_name": "Aditya Subramanian", "link": "https://stackoverflow.com/users/12153461/aditya-subramanian"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1570644942, "post_id": 58309884, "comment_id": 102981527, "body": "Apologies, Brain fade on the title. @WillemVanOnsem That is true but Im not sure what I should be using instead."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1570645372, "post_id": 58309884, "comment_id": 102981719, "body": "@AdityaSubramanian: you recurse on the right subtree, <i>without</i> constructing a node at that level."}, {"owner": {"reputation": 77, "user_id": 12153461, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-v3T0oc6csTw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdJ_yKXt7W9RyNRLbo2vYpqsi3rEA/photo.jpg?sz=128", "display_name": "Aditya Subramanian", "link": "https://stackoverflow.com/users/12153461/aditya-subramanian"}, "edited": false, "score": 0, "creation_date": 1570645913, "post_id": 58309884, "comment_id": 102981965, "body": "Alright ofcourse! Thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "is_accepted": false, "score": 1, "last_activity_date": 1570647610, "creation_date": 1570647610, "answer_id": 58310594, "question_id": 58309884, "link": "https://stackoverflow.com/questions/58309884/subtrees-of-binary-trees-in-a-range-haskell/58310594#58310594", "title": "Subtrees of Binary Trees in a range Haskell", "body": "<p>I  each step of the recursion, you should provide <code>a</code> and <code>b</code> arguments:</p>\n\n<pre><code>data BSTree = Void | BSNode BSTree Integer BSTree deriving Show\n\nsubTree:: Integer -&gt; Integer -&gt; BSTree -&gt; BSTree\nsubTree a b Void = Void\nsubTree a b (BSNode leftTree key rightTree) \n | key &lt; a = --your logic here\n | b &lt; key = -- your logic here\n | a &lt;= key &amp;&amp; b &gt; key = BSNode (subTree a b leftTree) key (subTree a b rightTree)\n\nt1 = BSNode Void 5 Void\nt2 = BSNode Void 6 Void\nt3 = BSNode Void 7 Void\nt4 = BSNode t1 8 (BSNode t1 7 t2)\n</code></pre>\n\n<p>With this example:</p>\n\n<pre><code>   subTree 6 10 t4\n=&gt; BSNode Void 8 (BSNode Void 7 (BSNode Void 6 Void))\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 12153461, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-v3T0oc6csTw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdJ_yKXt7W9RyNRLbo2vYpqsi3rEA/photo.jpg?sz=128", "display_name": "Aditya Subramanian", "link": "https://stackoverflow.com/users/12153461/aditya-subramanian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1570663250, "creation_date": 1570644373, "last_edit_date": 1570663250, "question_id": 58309884, "link": "https://stackoverflow.com/questions/58309884/subtrees-of-binary-trees-in-a-range-haskell", "title": "Subtrees of Binary Trees in a range Haskell", "body": "<p>I have a Binary Tree defined as the following:</p>\n\n<pre><code>data BSTree = Void | BSNode BSTree Integer BSTree\n</code></pre>\n\n<p>and would like to write a function</p>\n\n<pre><code>subTree:: Integer -&gt; Integer -&gt; BSTree -&gt; BSTree\n</code></pre>\n\n<p>which returns all subset of trees with a &lt;= key &lt; b. </p>\n\n<p>I tried the following</p>\n\n<pre><code>subTree:: Integer -&gt; Integer -&gt; BSTree -&gt; BSTree\nsubTree a b Void = Void\nsubTree a b (BSNode leftTree key rightTree) \n    | key &lt; a = BSNode Void key (subTree key b rightTree)\n    | b &lt; key = BSNode (subTree a key leftTree) key Void\n    | a &lt;= key &amp;&amp; b &gt; key = BSNode (subTree a key leftTree) key (subTree key b rightTree)\n</code></pre>\n\n<p>but do not get the correct output. Could someone point out the flaw in my logic?</p>\n"}, {"tags": ["list", "haskell"], "answers": [{"comments": [{"owner": {"reputation": 200, "user_id": 12174294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff5a9f269ee5f6948c98584fc17a9556?s=128&d=identicon&r=PG&f=1", "display_name": "Ramux05", "link": "https://stackoverflow.com/users/12174294/ramux05"}, "edited": false, "score": 0, "creation_date": 1570637151, "post_id": 58308065, "comment_id": 102977948, "body": "but the list it receives will be the <code>[[element, randomNumber, randomNumber], etc]</code>, won&#39;t this give me a list like <code>[[randomNumber, randomNumber, etc], etc]</code>?"}, {"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "reply_to_user": {"reputation": 200, "user_id": 12174294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff5a9f269ee5f6948c98584fc17a9556?s=128&d=identicon&r=PG&f=1", "display_name": "Ramux05", "link": "https://stackoverflow.com/users/12174294/ramux05"}, "edited": false, "score": 0, "creation_date": 1570637400, "post_id": 58308065, "comment_id": 102978062, "body": "@Ramux05 , Yes, add to the question a whole example of input and output algong side with some kind of real data, is hard to understand the question."}, {"owner": {"reputation": 200, "user_id": 12174294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff5a9f269ee5f6948c98584fc17a9556?s=128&d=identicon&r=PG&f=1", "display_name": "Ramux05", "link": "https://stackoverflow.com/users/12174294/ramux05"}, "edited": false, "score": 0, "creation_date": 1570638066, "post_id": 58308065, "comment_id": 102978381, "body": "well the input on the function <code>addRandomN</code> would be something like <code>[[4 3], [4 3], [4 3]] 2 5 </code> and the output should be something like (for example): <code>[[4 3, 5 6], [4 3, 7 3], [4 3, 6 4]]</code>. if we used <code>3</code> instead of  <code>2</code> on the input, we should get something like: <code>[[4 3, 5 6, 5 4], [4 3, 7 3, 9 3], [4 3, 6 4, 2 1]]</code>"}], "tags": [], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "is_accepted": false, "score": 2, "last_activity_date": 1570636848, "creation_date": 1570636848, "answer_id": 58308065, "question_id": 58307843, "link": "https://stackoverflow.com/questions/58307843/need-help-adding-elements-to-the-list-haskell/58308065#58308065", "title": "Need help adding elements to the list (Haskell)", "body": "<p>Yes I get the issue, you need several changes, to start, the basis cases of recursion:</p>\n\n<pre><code>genRandom x y = undefined\n\naddRandomN :: [[Int]] -&gt; Int -&gt; Int -&gt; [[Int]]\naddRandomN _ 0 _  = []\naddRandomN [] _ _ = []\naddRandomN (x:xs) c seed = (genRandom 2 seed) : (addRandomN xs (c-1) seed)\n</code></pre>\n\n<p>with this, the code compiles, and you will be able to fit the empty holes, I don't know the exact type of genRandom, but the function as you are telling, should be approximately something like that </p>\n"}], "owner": {"reputation": 200, "user_id": 12174294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff5a9f269ee5f6948c98584fc17a9556?s=128&d=identicon&r=PG&f=1", "display_name": "Ramux05", "link": "https://stackoverflow.com/users/12174294/ramux05"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1572883429, "creation_date": 1570636018, "last_edit_date": 1572883429, "question_id": 58307843, "link": "https://stackoverflow.com/questions/58307843/need-help-adding-elements-to-the-list-haskell", "title": "Need help adding elements to the list (Haskell)", "body": "<p>i have an assignment in which i have a list of lists , in which every first element of the lists inside the list are always the same, for example: <code>[[element, ....], [element, ...], [element, ...]]</code>. I also have a function that was given to me by the professor, that generates a random list of numbers between 0 and 9 called <code>genRandom</code>. The way it works is you give it an <code>Int</code> such as <code>5</code>, and you also give it a seed and it gives you <code>[2,6,3,6,8]</code> (for example). What i need to do is, for example, given an <code>Int</code> by the user, let's use <code>3</code> for this example, it should return someting like this: <code>[[element, genRandom 2 seed, genRandom 2 seed], [element, genRandom 2 seed, genRandom 2 seed]]</code>. In this example everytime that <code>genRandom 2</code>appears it should appear 2 random numbers generated by the function.\nThis is my attempt so far: </p>\n\n<pre><code>    gerlists :: Int -&gt; Int -&gt; [[Int]]\n    gerlists 0 _ = [[]]\n    gerlists _ 0 = [[]]\n    gerlists n c = replicate n [Reta Terra 0]\n</code></pre>\n\n<p>In this function I'm creating the list with the first element already defined as I show above.</p>\n\n<pre><code>    addRandomN :: [[Int]] -&gt; Int -&gt; Int -&gt; [[Int]]\n    addRandomN (x:xs) c seed = (x ++ addRandomN(genRandom 2 seed): addRandomN(c-1) (genRandom 2 seed)\n</code></pre>\n\n<p>This is the Function in which I'm trying to concatenate.</p>\n\n<p>I'm so sorry if it's hard to understand what i'm trying to say, english isn't my main language.\nThanks in advance :)</p>\n"}, {"tags": ["haskell", "compiler-warnings"], "comments": [{"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1570632233, "post_id": 58306529, "comment_id": 102975292, "body": "Would you be okay with issuing a compiler error instead of warning when this instance is used? In that case, there&#39;s a solution."}, {"owner": {"reputation": 1882, "user_id": 2882307, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ec8370b53eef1b4e53bccdcdf605a282?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/2882307/john-smith"}, "reply_to_user": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1570632358, "post_id": 58306529, "comment_id": 102975350, "body": "@Shersh No then I could use <code>TypeError</code>... But I really want users to be able to use that instance if they want to. But it has siginificant problems."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1570632513, "post_id": 58306529, "comment_id": 102975440, "body": "Yes, <code>TypeError</code> can produce a compile time error. I believe there&#39;s no way to add a warning to instance usage. You probably have better luck opening a ticket to GHC; this might be a good feature request."}, {"owner": {"reputation": 194, "user_id": 4856316, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GMUS6.jpg?s=128&g=1", "display_name": "lzbernardo", "link": "https://stackoverflow.com/users/4856316/lzbernardo"}, "edited": false, "score": 0, "creation_date": 1570633214, "post_id": 58306529, "comment_id": 102975863, "body": "You can force some predefined warnings by using &quot;questionable&quot; code yourself (Even though this might not be a very didactic solution). If I&#39;m not mistaken, using <code>show _ = _</code> will cause a <code>-Wtyped-holes</code> warning"}, {"owner": {"reputation": 1882, "user_id": 2882307, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ec8370b53eef1b4e53bccdcdf605a282?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/2882307/john-smith"}, "edited": false, "score": 1, "creation_date": 1570633386, "post_id": 58306529, "comment_id": 102975952, "body": "@izbernardo Yeah but that warning is hardly descriptive. I would like to say something instructive to the user. Besides that warning won&#39;t be given once the library is build. The warning is for users of the library."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1570635314, "post_id": 58306529, "comment_id": 102976986, "body": "It looks impossible to me. I tried to use <code>DEPRECATE</code>, but that only works on identifiers which are mentioned in the file importing the module, and we don&#39;t want to trigger the warning on <code>Show</code>, <code>show</code>, or <code>Foo</code>. Perhaps we need a type family (roughly) <code>TypeWarning :: String -&gt; Type -&gt; Type</code>, as a sort of type-level <code>trace</code>. Edit: <a href=\"https://gitlab.haskell.org/ghc/ghc/issues/17027\" rel=\"nofollow noreferrer\">already existing ticket</a>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1570642916, "post_id": 58306529, "comment_id": 102980555, "body": "Based on the <code>{-# WARNING ... #-}</code> syntax, <code>{-# WARNING (show :: Foo -&gt; String) ... #-}</code> looked like the most logical candidate, but that does not work. I think it was not designed to be used with type class methods."}], "owner": {"reputation": 1882, "user_id": 2882307, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/ec8370b53eef1b4e53bccdcdf605a282?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/2882307/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "answer_count": 0, "score": 7, "last_activity_date": 1570640444, "creation_date": 1570631542, "last_edit_date": 1570640444, "question_id": 58306529, "link": "https://stackoverflow.com/questions/58306529/issue-warning-on-usage-of-specific-instance", "title": "Issue warning on usage of specific instance", "body": "<p>I have created an instance of a type class:</p>\n\n<pre><code>data Foo = Foo\n\ninstance Show Foo where\n  show _ = \"Foo\"\n</code></pre>\n\n<p>Now this is part of a library and I want to issue a warning if a user of the library uses this instance. I have tried various things with the <code>WARNING</code> pragma but I can't get it to work.</p>\n"}, {"tags": ["list", "function", "haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1570630978, "post_id": 58306295, "comment_id": 102974521, "body": "With <code>map</code>, but here you probably want to use <code>any</code> or <code>all</code>."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 0, "last_activity_date": 1570631156, "creation_date": 1570631156, "answer_id": 58306410, "question_id": 58306295, "link": "https://stackoverflow.com/questions/58306295/how-to-apply-a-function-to-each-element-of-a-list-of-chars/58306410#58306410", "title": "How to apply a function to each element of a list of chars", "body": "<p>There are some problems here. You here define a function <code>isValid</code> that takes a string. This thus means that <code>x</code> is the first character of the string, and <code>xs</code> are the remaining characters.</p>\n\n<pre><code>isValid :: String -&gt; Bool\nisValid (x:xs) = isIdentifierStart x && all isIdentifierPart xs</code></pre>\n\n<p>You furthermore want to call <code>isReserved</code> on the <em>entire</em> string. We can do that by making use of an \"<em>as-pattern</em>\".</p>\n\n<pre><code>isValid :: String -&gt; Bool\nisValid <b>xa@</b>(x:xs) = isIdentifierStart x && all isIdentifierPart xs && <b>not (isReserved xa)</b></code></pre>\n\n<p>Finally we need to cover the empty string case here. If an empty string is considered not valid, we can write this as:</p>\n\n<pre><code>isValid :: String -&gt; Bool\nisValid <b>\"\"</b> = False\nisValid xa@(x:xs) = isIdentifierStart x && all isIdentifierPart xs && not (isReserved xa)</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 12189211, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/916d741c3407c241c286e5b38d11478f?s=128&d=identicon&r=PG&f=1", "display_name": "vNSkyline", "link": "https://stackoverflow.com/users/12189211/vnskyline"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 58306410, "answer_count": 1, "score": 0, "last_activity_date": 1570631156, "creation_date": 1570630815, "question_id": 58306295, "link": "https://stackoverflow.com/questions/58306295/how-to-apply-a-function-to-each-element-of-a-list-of-chars", "title": "How to apply a function to each element of a list of chars", "body": "<p>I would like to test an input String if its verified by a few conditions. I got stuck when i need to apply a function to the rest of the list elements. How should i approach this situation?</p>\n\n<p>My code looks like:</p>\n\n<pre><code>import Data.Char\n\nlistLower = ['a'..'z']\nlistUpper = ['A'..'Z']\nlistNum = ['0'..'9']\nlistRes = [\"if\",\"then\",\"else\",\"module\",\"import\"]\n\n\nisIdentifierStart :: Char -&gt; Bool\nisIdentifierStart x = x `elem` listLower\nisIdentifierStart _ = False\n\nisIdentifierPart :: Char -&gt; Bool\nisIdentifierPart x = x `elem` listLower || x `elem` listUpper || x `elem` listNum\nisIdentifierPart _ = False\n\nisReserved :: String -&gt; Bool\nisReserved x = x `elem` listRes\nisReserved _ = False\n\nisValid :: String -&gt; Bool\nisValid (x:xs) = (isIdentifierStart x) &amp;&amp; (isIdentifierPart xs) &amp;&amp; (not (isReserved [x]))\n</code></pre>\n\n<p>And the error message i got :</p>\n\n<pre><code>hf4.hs:22:61: error:\n    \u2022 Couldn't match expected type \u2018Char\u2019 with actual type \u2018[Char]\u2019\n    \u2022 In the first argument of \u2018isIdentifierPart\u2019, namely \u2018xs\u2019\n      In the first argument of \u2018(&amp;&amp;)\u2019, namely \u2018(isIdentifierPart xs)\u2019\n      In the second argument of \u2018(&amp;&amp;)\u2019, namely\n        \u2018(isIdentifierPart xs) &amp;&amp; (not (isReserved [x]))\u2019\n   |\n22 | isValid (x:xs) = (isIdentifierStart x) &amp;&amp; (isIdentifierPart xs) &amp;&amp; (not (isReserved [x]))    |\n</code></pre>\n"}, {"tags": ["haskell", "tree", "binary-tree", "binary-search-tree", "predicate"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1570627499, "post_id": 58304077, "comment_id": 102972514, "body": "I wouldn&#39;t define <code>flattenTree</code> first. You can return <code>False</code> early if a node violates the search property without having to traverse the entire subtree rooted at that node."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1570631547, "post_id": 58304077, "comment_id": 102974873, "body": "@chepner the problem is with <code>sort</code>, not with <code>flattenTree</code>, which is lazy enough."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1570631724, "post_id": 58304077, "comment_id": 102974979, "body": "Yeah, that occurred to me after looking at some of the other answers."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 3, "last_activity_date": 1570624487, "last_edit_date": 1570624487, "creation_date": 1570624149, "answer_id": 58304160, "question_id": 58304077, "link": "https://stackoverflow.com/questions/58304077/find-whether-a-tree-is-a-binary-search-tree-in-haskell/58304160#58304160", "title": "Find whether a tree is a binary search tree in Haskell", "body": "<p><strong>Yes</strong>, you do not need to sort the list. You can check if every element is less than or equal to the next element. This is more efficient since we can do this in <em>O(n)</em>, whereas evaluating the sorted list <em>completely</em> takes <em>O(n</em> log <em>n)</em>.</p>\n\n<p>We thus can check this with:</p>\n\n<pre><code>ordered :: Ord a =&gt; [a] -&gt; Bool\nordered [] = True\nordered xa@(_:xs) = and (zipWith (&lt;=) xa xs)</code></pre>\n\n<p>So we can check if the binary tree is a binary search tree with:</p>\n\n<pre><code>isBSTree :: Ord a =&gt; BinaryTree a -&gt; Bool\nisBSTree = ordered . flattenTree</code></pre>\n\n<p>I think one can claim that <code>Null</code> itself is a binary search tree, since it is an empty tree. This thus means that for every node (there are no nodes) the elements in the left subtree are less than or equal to the value in the node, and the elements in the right subtree are all greater than or equal to the value in the node.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1570630166, "post_id": 58304198, "comment_id": 102974073, "body": "or define the obvious Monoid for <code>BSTResult a</code> and fold into it. :) (or even if it&#39;s not a lawful Monoid ....)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1570631025, "post_id": 58304198, "comment_id": 102974550, "body": "(but it is lawful, anyway, I think)"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 6, "last_activity_date": 1570636206, "last_edit_date": 1570636206, "creation_date": 1570624297, "answer_id": 58304198, "question_id": 58304077, "link": "https://stackoverflow.com/questions/58304077/find-whether-a-tree-is-a-binary-search-tree-in-haskell/58304198#58304198", "title": "Find whether a tree is a binary search tree in Haskell", "body": "<p>Here's a hint: make an auxiliary function</p>\n\n<pre><code>isBSTree' :: (Ord a) =&gt; BinaryTree a -&gt; BSTResult a\n</code></pre>\n\n<p>where <code>BSTResult a</code> is defined as</p>\n\n<pre><code>data BSTResult a\n   = NotBST             -- not a BST\n   | EmptyBST           -- empty tree (hence a BST)\n   | NonEmptyBST a a    -- nonempty BST with provided minimum and maximum\n</code></pre>\n\n<p>You should be able to proceed recursively, exploiting results on subtrees to drive the computation, in particular the minimum and maximum.</p>\n\n<p>For instance, if you have <code>tree = Node left 20 right</code>, with <code>isBSTree' left = NonEmptyBST 1 14</code> and <code>isBSTree' right = NonEmptyBST 21 45</code>, then <code>isBSTree' tree</code> should be <code>NonEmptyBST 1 45</code>.</p>\n\n<p>In the same case except for <code>tree = Node left 24 right</code>, we should instead have <code>isBSTree' tree = NotBST</code>.</p>\n\n<p>Converting the result to <code>Bool</code> is then trivial.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1601139303, "post_id": 58305672, "comment_id": 113315068, "body": "(just a suggestion,) you could flag this answer (or any other) and ask moderators to merge your older account <a href=\"https://stackoverflow.com/users/733183/conor\">stackoverflow.com/users/733183/conor</a> into this one, so people could see those two other answers from there as well. (I tried asking the mods to do this, but they said only the user themself could request the merging of accounts). :) (hope me pinging you here is not too much of a bother)"}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1605429588, "post_id": 58305672, "comment_id": 114642921, "body": "Why wait until Null to compare bounds? It seems more natural to me to, at each Node, check that the value is within the already-established bounds before recursing. This tweak should be lazier: it can correctly produce <code>False</code> for the tree <code>Node (Node undefined 10 undefined) 5 Null</code>."}], "tags": [], "owner": {"reputation": 42094, "user_id": 828361, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/6a82397672dcc1fca31c32508ef0798b?s=128&d=identicon&r=PG", "display_name": "pigworker", "link": "https://stackoverflow.com/users/828361/pigworker"}, "is_accepted": false, "score": 13, "last_activity_date": 1570635967, "last_edit_date": 1570635967, "creation_date": 1570628848, "answer_id": 58305672, "question_id": 58304077, "link": "https://stackoverflow.com/questions/58304077/find-whether-a-tree-is-a-binary-search-tree-in-haskell/58305672#58305672", "title": "Find whether a tree is a binary search tree in Haskell", "body": "<p>Here's a way to do it without flattening the tree.</p>\n\n<p>From the definition, here,</p>\n\n<pre><code>data BinaryTree a = Null | Node (BinaryTree a) a (BinaryTree a)\n     deriving Show\n</code></pre>\n\n<p>one can see that traversing the tree left to right, ignoring <code>Node</code> and parentheses, gives you an alternating sequence of <code>Null</code>s and <code>a</code>s. That is, between every two values, there is a <code>Null</code>.</p>\n\n<p>My plan is to check that each subtree satisfies suitable <em>requirements</em>: we can <em>refine</em> the requirements at each <code>Node</code>, remembering which values we are between, then <em>test</em> them at each <code>Null</code>. As there is a <code>Null</code> between every in order pair of values, we will have tested that all in order (left-to-right) pairs are non-decreasing.</p>\n\n<p>What is a requirement? It's a <em>loose</em> lower and upper bound on the values in the tree. To express requirements, including those at the leftmost and rightmost ends, we may extend any ordering with <code>Bot</code>tom and <code>Top</code> elements, as follows:</p>\n\n<pre><code>data TopBot a = Bot | Val a | Top deriving (Show, Eq, Ord)\n</code></pre>\n\n<p>Now let us check that a given tree satisfies the requirements of being both in order and between given bounds.</p>\n\n<pre><code>ordBetween :: Ord a =&gt; TopBot a -&gt; TopBot a -&gt; BinaryTree a -&gt; Bool\n  -- tighten the demanded bounds, left and right of any Node\nordBetween lo hi (Node l x r) = ordBetween lo (Val x) l &amp;&amp; ordBetween (Val x) hi r\n  -- check that the demanded bounds are in order when we reach Null\nordBetween lo hi Null         = lo &lt;= hi\n</code></pre>\n\n<p>A binary search tree is a tree that is in order and between <code>Bot</code> and <code>Top</code>.</p>\n\n<pre><code>isBSTree :: Ord a =&gt; BinaryTree a -&gt; Bool\nisBSTree = ordBetween Bot Top\n</code></pre>\n\n<p>Computing the <em>actual</em> extremal values in each subtree, bubbling them outwards, gives you more information than you need, and is fiddly in the edge cases where a left or right subtree is empty. Maintaining and checking the <em>requirements</em>, pushing them inwards, is rather more uniform.</p>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 1, "last_activity_date": 1570663797, "last_edit_date": 1570663797, "creation_date": 1570641362, "answer_id": 58309178, "question_id": 58304077, "link": "https://stackoverflow.com/questions/58304077/find-whether-a-tree-is-a-binary-search-tree-in-haskell/58309178#58309178", "title": "Find whether a tree is a binary search tree in Haskell", "body": "<p>We can proceed left-to-right over the tree like this:</p>\n\n<pre><code>isBSTtreeG :: Ord a =&gt; BinaryTree a -&gt; Bool\nisBSTtreeG t = gopher Nothing [Right t]\n    where\n    gopher  _   []                        =  True\n    gopher  x   (Right Null:ts)           =  gopher x ts\n    gopher  x   (Right (Node lt v rt):ts) =  gopher x (Right lt:Left v:Right rt:ts)\n    gopher Nothing   (Left v:ts)          =  gopher (Just v) ts\n    gopher (Just y)  (Left v:ts)          =  y &lt;= v &amp;&amp; gopher (Just v) ts\n</code></pre>\n\n<p>Inspired by <a href=\"https://dreamsongs.com/10ideas.html\" rel=\"nofollow noreferrer\">John McCarthy's <code>gopher</code></a>.</p>\n\n<p>The explicit push-down list can be eliminated with continuation-passing,</p>\n\n<pre><code>isBSTtreeC :: Ord a =&gt; BinaryTree a -&gt; Bool\nisBSTtreeC t = gopher Nothing t (const True)\n    where\n    gopher  x   Null           g  =  g x \n    gopher  x   (Node lt v rt) g  =  gopher x lt (\\case\n                                       Nothing -&gt; gopher (Just v) rt g\n                                       Just y  -&gt; y &lt;= v &amp;&amp; gopher (Just v) rt g)\n</code></pre>\n\n<p>Maintaining just one, <em>largest-so-far</em> element, is enough.</p>\n"}], "owner": {"reputation": 215, "user_id": 12036912, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Bs1MMku7W04/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcRX-T31D-fLdCF5w6i9pacNreJ9w/photo.jpg?sz=128", "display_name": "Jayyyyyy", "link": "https://stackoverflow.com/users/12036912/jayyyyyy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 772, "favorite_count": 0, "answer_count": 4, "score": 10, "last_activity_date": 1570663797, "creation_date": 1570623864, "last_edit_date": 1570631389, "question_id": 58304077, "link": "https://stackoverflow.com/questions/58304077/find-whether-a-tree-is-a-binary-search-tree-in-haskell", "title": "Find whether a tree is a binary search tree in Haskell", "body": "<pre><code>  type BSTree a = BinaryTree a\n\n  data BinaryTree a = Null | Node (BinaryTree a) a (BinaryTree a)\n                      deriving Show\n\n  flattenTree :: BinaryTree a -&gt; [a]\n  flattenTree  tree = case tree of\n      Null -&gt; []\n      Node left val right -&gt; (flattenTree left) ++ [val] ++ (flattenTree right)\n\n  isBSTree :: (Ord a) =&gt; BinaryTree a -&gt; Bool\n  isBSTree btree = case btree of\n      Null -&gt; False\n      tree -&gt; (flattenTree tree) == sort (flattenTree tree)\n</code></pre>\n\n<p>What I want to do is to write a function to determine whether the given tree is a binary search tree, my method is to group all of the values in a list and import <code>Data.List</code> and then sort the list to find whether they are equal, but it is a little complicated. Can we do this without importing other module?</p>\n"}, {"tags": ["haskell", "type-signature"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1570609478, "post_id": 58299916, "comment_id": 102962587, "body": "Hint: lookup the signatures of <code>elem</code>, <code>(+)</code> and <code>(&amp;&amp;)</code>."}, {"owner": {"reputation": 215, "user_id": 12036912, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Bs1MMku7W04/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcRX-T31D-fLdCF5w6i9pacNreJ9w/photo.jpg?sz=128", "display_name": "Jayyyyyy", "link": "https://stackoverflow.com/users/12036912/jayyyyyy"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1570609613, "post_id": 58299916, "comment_id": 102962649, "body": "may be &quot;elem&quot; is used to find whether x&amp;&amp;y is in the list of Z? I am not very sure, so I used Bool."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1570609812, "post_id": 58299916, "comment_id": 102962750, "body": "you do not need to know <i>what</i> a function is doing in order to determine the types. Signatures can be inferenced, just by looking at the signatures of the functions you use."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 2, "creation_date": 1570610887, "post_id": 58299916, "comment_id": 102963341, "body": "<code>cow</code> is also wrong."}], "answers": [{"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1570648040, "post_id": 58300769, "comment_id": 102982852, "body": "And of course the <code>Foldable f</code> may be specialised to <code>[]</code>, giving <code>Bool -&gt; a -&gt; [a] -&gt; Bool</code>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1570648173, "post_id": 58300769, "comment_id": 102982901, "body": "@JonPurdy: yes correct. The problem is more with the <code>x</code> in the proposed signature in the question."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 3, "last_activity_date": 1570612381, "creation_date": 1570612381, "answer_id": 58300769, "question_id": 58299916, "link": "https://stackoverflow.com/questions/58299916/type-signature-of-haskell/58300769#58300769", "title": "type signature of Haskell", "body": "<p>In order to determine the type signatures. You do not need to know <em>what</em> a function is doing. You can use the type signatures of the functions you use, and do inference on that.</p>\n\n<p>Since the type signature of your <code>cow</code> function is not entirely correct, we will show how to derive the type signature of the <code>cow</code> function, and then leave the two others as exercises.</p>\n\n<p>We see that <code>cow</code> here has three parameters: <code>x</code>, <code>y</code> and <code>z</code>. At the moment, we do not know much about <code>x</code>, <code>y</code> and <code>z</code>. So we will assign a different type variable for these variables. So <code>x :: a</code>, <code>y :: b</code> and <code>z :: c</code>.</p>\n\n<p>Next we can start to derive the types. The function definition of <code>cow</code>:</p>\n\n<pre><code>cow x y z = x &amp;&amp; y `elem` z\n</code></pre>\n\n<p>can be written in a more canonical format as:</p>\n\n<pre><code>cow x y z = (&amp;&amp;) x (elem y z)\n</code></pre>\n\n<p>We thus see that we make use of two functions here: <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:-38--38-\" rel=\"nofollow noreferrer\"><strong><code>(&amp;&amp;) :: Bool -&gt; Bool -&gt; Bool</code></strong></a>, and <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:elem\" rel=\"nofollow noreferrer\"><strong><code>elem :: (Eq e, Foldable f) =&gt; e -&gt; f e -&gt; Bool</code></strong></a>, we here use <code>e</code> instead of <code>f</code> to avoid \"name clashes\" with our already defined type variable <code>a</code>. Since we use <code>x</code> as argument of the <code>(&amp;&amp;) :: Bool -&gt; Bool -&gt; Bool</code> function, we know that <code>x</code> should have type <code>Bool</code>, and thus that <code>a ~ Bool</code> (<code>a</code> is the same type as <code>Bool</code>). Furthermore we thus know that <code>(&amp;&amp;) x :: Bool -&gt; Bool</code>.</p>\n\n<p>Next we see that we call <code>elem :: (Eq e, Foldable f) =&gt; e -&gt; f e -&gt; Bool</code>. This thus means that <code>y</code>, which is the first parameter applied to <code>elem</code> thus has type <code>e</code>, and therefore <code>b ~ e</code>.</p>\n\n<p>It furthermore means that <code>elem x</code> thus has type <code>(Eq e, Foldable f) =&gt; f e -&gt; Bool</code>, and we apply this function to the <code>z</code> parameter. This thus means that <code>c ~ (Eq e, Foldable f) =&gt; f e</code>, and that the type of <code>elem y z</code> is <code>Bool</code>.</p>\n\n<p>Since the type of <code>elem y z</code> is <code>Bool</code>, this matches with the function <code>(&amp;&amp;) x</code>, and thus the type of <code>(&amp;&amp;) x (elem y z)</code> is thus <code>Bool</code>.</p>\n\n<p>We thus have derived that:</p>\n\n<pre><code>x :: Bool\ny :: e\nz :: f e\n</code></pre>\n\n<p>with as type constraints <code>Eq e</code> and <code>Foldable f</code>. This thus means that <code>cow</code> has as function:</p>\n\n<pre><code>cow :: (Eq e, Foldable f) =&gt; Bool -&gt; e -&gt; f e -&gt; Bool\ncow x y z = x &amp;&amp; y `elem` z\n</code></pre>\n"}], "owner": {"reputation": 215, "user_id": 12036912, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Bs1MMku7W04/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcRX-T31D-fLdCF5w6i9pacNreJ9w/photo.jpg?sz=128", "display_name": "Jayyyyyy", "link": "https://stackoverflow.com/users/12036912/jayyyyyy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1570612381, "creation_date": 1570609444, "question_id": 58299916, "link": "https://stackoverflow.com/questions/58299916/type-signature-of-haskell", "title": "type signature of Haskell", "body": "<pre><code>cow :: (Eq a) =&gt; a -&gt; a -&gt; [a] -&gt; Bool\ncow x y z = x &amp;&amp; y `elem` z\n\n foo ::\n foo x y z = x `elem` y &amp;&amp; y `elem` z\n\n bar::\n bar x y = case y of\n    Nothing -&gt; x\n    Just z  -&gt; x + z\n</code></pre>\n\n<p>I don't know what the type signature should be.</p>\n"}, {"tags": ["haskell", "random", "time"], "answers": [{"tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": true, "score": 3, "last_activity_date": 1570650605, "last_edit_date": 1570650605, "creation_date": 1570603275, "answer_id": 58298402, "question_id": 58297876, "link": "https://stackoverflow.com/questions/58297876/basic-pseudorandom-number-generator-function-in-haskell/58298402#58298402", "title": "Basic pseudorandom number generator function in Haskell", "body": "<p>It's just</p>\n\n<pre><code>pseudorand :: Int -&gt; Int -&gt; IO Int\npseudorand i m = do\n  t &lt;- round &lt;$&gt; getPOSIXTime -- infix fmap is (&lt;$&gt;), evoking \"fancy function application\"\n  -- here, t :: Int, i :: Int, m :: Int, so generator t i m :: Int\n  -- t IS NOT an IO Int: the whole point of do-notation is \"unwrapping\" (&lt;-)\n  -- monadic values and using them like normal ones\n  -- return (generator t i m) :: IO Int; we're done\n  return $ generator t i m\n</code></pre>\n\n<p>You can also write this in the applicative style:</p>\n\n<pre><code>pseudorand i m = generator &lt;$&gt; (round &lt;$&gt; getPOSIXTime) &lt;*&gt; pure i &lt;*&gt; pure m\n-- read this as: generator(round(getPOSIXTIME()), i, m)\n-- as you would write in an imperative language\n</code></pre>\n\n<p>Or with just a single infix fmap:</p>\n\n<pre><code>pseudorand i m = (\\t -&gt; generator (round t) i m) &lt;$&gt; getPOSIXTime\n</code></pre>\n"}], "owner": {"reputation": 57, "user_id": 11370915, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5jFyn.jpg?s=128&g=1", "display_name": "Andrii Kozytskyi", "link": "https://stackoverflow.com/users/11370915/andrii-kozytskyi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 58298402, "answer_count": 1, "score": 0, "last_activity_date": 1570650605, "creation_date": 1570600814, "question_id": 58297876, "link": "https://stackoverflow.com/questions/58297876/basic-pseudorandom-number-generator-function-in-haskell", "title": "Basic pseudorandom number generator function in Haskell", "body": "<p>I'm trying to write a simple Lehmer algorithm pseudorandom number generator to get a better understanding of how to handle IO values in Haskell and I keep getting type mismatches.</p>\n\n<p>My code looks as follows:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>import Data.Time.Clock.POSIX\n\ngenerator :: Int -&gt; Int -&gt; Int -&gt; Int\ngenerator x i m\n  | i &lt;= 0 = error \"Index out of bounds\"\n  | i == 1 = x * ( x `mod` m )\n  | otherwise = generator (generator x (i - 1) m) 1 m\n\npseudorand :: Int -&gt; Int -&gt; IO Int\npseudorand i m = do t &lt;- round `fmap` getPOSIXTime\n                    return ( \\ i m -&gt; generator t i m )\n</code></pre>\n\n<p>The generator function receives a seed, a number of iterations and a modulo parameter and runs a recursive modulo calculation where <code>x_(i+1) = x_0 * x_i mod m</code>, simple enough. Getting millisecond time as an IO Int is also doable. The trouble I'm running into is passing the IO Int onto my generator function afterwards.</p>\n\n<p>The above code expects the an 'IO Int' but gets 'IO (Int -> Int -> Int)'. That is obviously the type of my generator function, so I tried</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>pseudorand :: Int -&gt; Int -&gt; IO Int\npseudorand i m = do t &lt;- round `fmap` getPOSIXTime\n                    return ( fmap generator t i m )\n</code></pre>\n\n<p>which expects an 'Int' but gets an 'Int -> Int'.</p>\n\n<p>Why does it not expect inputs? Why does it not see the <code>i</code> and <code>m</code>?</p>\n\n<p>Would also appreciate your input on how you'd write a code for this</p>\n"}, {"tags": ["algorithm", "haskell", "sequence", "lazy-sequences"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 3, "creation_date": 1570586459, "post_id": 58295842, "comment_id": 102955640, "body": "I can&#39;t make heads nor tails of your description of the sequence you want to generate."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1570629313, "post_id": 58295842, "comment_id": 102973591, "body": "turns out it&#39;s an infinite sequence of symbols {1,2}, which starts with <code>[1,2, ...]</code>, and is a sequence of run lengths from its own RLE encoding: <code>ks == ([1,2] ++) . drop 2 . map fst . rle $ ks</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1570711556, "post_id": 58295842, "comment_id": 103005155, "body": "(<a href=\"https://en.wikipedia.org/wiki/Kolakoski_sequence\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/Kolakoski_sequence</a>)"}], "answers": [{"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1570711675, "post_id": 58295976, "comment_id": 103005228, "body": "(<a href=\"https://stackoverflow.com/questions/58295842/implementing-an-unusual-sequence-as-an-infinite-list-in-haskell#comment102973591_58295842\" title=\"implementing an unusual sequence as an infinite list in haskell%23comment102973591_58295842\">stackoverflow.com/questions/58295842/&hellip;</a>)"}], "tags": [], "owner": {"reputation": 2501, "user_id": 598892, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8a22954b638ce69b9994c9e3623953a5?s=128&d=identicon&r=PG", "display_name": "Chris Smith", "link": "https://stackoverflow.com/users/598892/chris-smith"}, "is_accepted": false, "score": 2, "last_activity_date": 1570585516, "creation_date": 1570585516, "answer_id": 58295976, "question_id": 58295842, "link": "https://stackoverflow.com/questions/58295842/implementing-an-unusual-sequence-as-an-infinite-list-in-haskell/58295976#58295976", "title": "Implementing an unusual sequence as an infinite list in Haskell", "body": "<p>The first thing you can do it get your types right.  <code>replicate</code> builds a list, so the <code>x</code> in your list comprehension has the type <code>[Int]</code>, and the entire list comprehension is a list of all the <code>x</code> values, and its type is <code>[[Int]]</code>.  You cannot use a list of <em>lists</em> of <code>Int</code> as the tail of a list, when the first two elements are <code>1</code> and <code>2</code>.  The types just don't match: you need to decide whether this is a list of <code>Int</code>, or a list of <em>lists</em> of <code>Int</code>.</p>\n\n<p>Based on your description, I suspect you want to fix this by flattening the list comprehension using <code>concat</code>, like so:</p>\n\n<pre><code>selfrie = 1 : 2 : concat [x | a &lt;- [0..],\n                              let x = replicate (selfrie !! a) (selfrie !! (a + 1))]\n</code></pre>\n\n<p>If you try this, you won't get the list you described.  I don't know how to help with the next part, and that's because I don't understand your description of the desired list.  This isn't a programming question so much as a specification question, so perhaps you could go back to the original source and see how it's explained there?</p>\n"}, {"tags": [], "owner": {"reputation": 67048, "user_id": 388787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f786b1ad349a30e02802ae61b4518fc?s=128&d=identicon&r=PG", "display_name": "Dan D.", "link": "https://stackoverflow.com/users/388787/dan-d"}, "is_accepted": true, "score": 5, "last_activity_date": 1570586460, "creation_date": 1570586460, "answer_id": 58296076, "question_id": 58295842, "link": "https://stackoverflow.com/questions/58295842/implementing-an-unusual-sequence-as-an-infinite-list-in-haskell/58296076#58296076", "title": "Implementing an unusual sequence as an infinite list in Haskell", "body": "<p>Not that unusual as it appears in the OEIS at <a href=\"https://oeis.org/A000002\" rel=\"noreferrer\">https://oeis.org/A000002</a> and is named there as the Kolakoski sequence. There they even give a Haskell program by John Tromp dated 2011:</p>\n\n<pre><code>a = 1:2: drop 2 (concat . zipWith replicate a . cycle $ [1, 2])\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 0, "last_activity_date": 1570616546, "creation_date": 1570616546, "answer_id": 58302025, "question_id": 58295842, "link": "https://stackoverflow.com/questions/58295842/implementing-an-unusual-sequence-as-an-infinite-list-in-haskell/58302025#58302025", "title": "Implementing an unusual sequence as an infinite list in Haskell", "body": "<p>We can write this slightly more elegant than <a href=\"https://stackoverflow.com/a/58296076/67579\">@DanD's answer</a>, by using an extra variable <code>b</code> on which we \"tie a knot\":</p>\n\n<pre><code>a :: [Int]\na = 1 : 2 : b\n    where b = 2 : concat (zipWith replicate b (cycle [1, 2]))\n</code></pre>\n\n<p>We here thus first yield <code>1 : 2 : b</code>, with <code>b</code> that starts with <code>2</code> and then the concatenation of the replicates of <code>b</code> with an endless list with <code>[1, 2, 1, 2, &hellip;]</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 18798, "user_id": 4543207, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed6f11c827fa7cef811f141a84cc14b?s=128&d=identicon&r=PG&f=1", "display_name": "Redu", "link": "https://stackoverflow.com/users/4543207/redu"}, "is_accepted": false, "score": 0, "last_activity_date": 1573646437, "last_edit_date": 1573646437, "creation_date": 1573586607, "answer_id": 58825361, "question_id": 58295842, "link": "https://stackoverflow.com/questions/58295842/implementing-an-unusual-sequence-as-an-infinite-list-in-haskell/58825361#58825361", "title": "Implementing an unusual sequence as an infinite list in Haskell", "body": "<p>The accepted answer seems concise and very efficient but hard to reason with especially if you are a beginner and neglect Haskell's laziness.</p>\n\n<p>We can rephrase it like</p>\n\n<pre><code>a = 1:2:2: (concat . zipWith replicate (drop 2 a) . cycle) [1, 2]\n</code></pre>\n\n<p>We must remember that <code>a</code> is just a semi constructed list like <code>1:2:2:?: ... ?:[]</code> and we start using it just by discarding the first two items <code>(drop 2 a)</code> which leaves us with <code>2:?: ... ?:[]</code> to apply to <code>zipWith replicate</code> and this is sufficient for us to run our logic indefinitelly. Keep in mind <code>2:?: ... ?:[]</code> is a list to be calculated just like <code>cycle [1,2]</code>. The availability of the initial item <code>2</code> enables the next item to be calculated and then the next item and then the next and so forth.</p>\n\n<p>This is a beautiful pattern in Haskell to generate infinite lists if you know the initial items. Take for instance the fibonacci series</p>\n\n<pre><code>fib = 1:1: (zipWith (+) fib (tail fib))\n</code></pre>\n\n<p>All you need to do is to tweak your mindset to think like <code>fib</code> is already there but not yet calculated.</p>\n\n<p><strong>Another Approach with State Monad:</strong></p>\n\n<p>However, i believe that the given Kolakoski series could also be a good case study to learn the State monad. Let's see if we can get the same performance..?</p>\n\n<pre><code>import Control.Monad.Trans.State\n\ninvert :: Int -&gt; Int\ninvert = (+1) . (`mod` 2)\n\nrle :: Int -&gt; State Int [Int]\nrle n = state $ \\s -&gt; (replicate n s, invert s)\n\nkolakoski :: [Int] -&gt; Int -&gt; [Int]\nkolakoski ps s = ps ++ kolakoski xs i\n                 where (xs,i) = runState (mapM rle ps &gt;&gt;= pure . concat) s\n</code></pre>\n\n<ul>\n<li>We have an <code>invert</code> function when fed with <code>1</code> gives <code>2</code> and when fed with <code>2</code> gives <code>1</code>.</li>\n<li><code>rle</code> takes an <code>Int</code> type and returns a <code>State</code> type, a function which takes the state and replicates it by <code>n</code> and returns the replicated list along with a new state, <code>invert s</code>. So our state alternates like <code>1,2,1,2...</code> along the way.</li>\n</ul>\n\n<p>However when tested with ghci (<code>:set +s</code>), while both show linear time complexity, this takes 10 times longer to finalize. Anybody care to comment..?</p>\n"}], "owner": {"reputation": 43, "user_id": 12185290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27b748551fa03ad2cca0926d9d96da32?s=128&d=identicon&r=PG&f=1", "display_name": "ArnieOnStack", "link": "https://stackoverflow.com/users/12185290/arnieonstack"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 1, "accepted_answer_id": 58296076, "answer_count": 4, "score": 4, "last_activity_date": 1573646437, "creation_date": 1570583852, "question_id": 58295842, "link": "https://stackoverflow.com/questions/58295842/implementing-an-unusual-sequence-as-an-infinite-list-in-haskell", "title": "Implementing an unusual sequence as an infinite list in Haskell", "body": "<p>I have two elements as the beginning of the list [1, 2]</p>\n\n<p>This unusual sequence is that it replicates the digits in the number of digits of a certain type that follows the three elements. For example, after 1 and 2, we would have another 2, followed by two 1's.\nThe first few elements of the desired list would yield </p>\n\n<p>[1, 2, 2, 1, 1, 2, 1, 2, 2, 1, 2, 2, 1, 1, 2, 1, 1, 2, 2] because</p>\n\n<pre><code>1  2   2  1 1   2  1  2   2  1   2   2\n</code></pre>\n\n<p>where the previous digits represent the length of the mini-sequences of the same digit.</p>\n\n<p>So far I've tried using the <code>replicate</code> function for repeating the same digit based on an element earlier in the list.</p>\n\n<pre><code>selfrle :: [Int]\nselfrle = 1 : 2 : [x | a &lt;- [0..], let x = replicate (selfrle !! a) (selfrle !! (a + 1))) ]\n</code></pre>\n\n<p>The problem is I can't figure out why it's not working.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "edited": false, "score": 7, "creation_date": 1570554307, "post_id": 58290914, "comment_id": 102946275, "body": "You appear to be a Haskell beginner. Before asking questions like this, I&#39;d strongly suggest you read <a href=\"http://learnyouahaskell.com/chapters\" rel=\"nofollow noreferrer\">LYAH</a> to completion. This question is covered within that book, namely <a href=\"http://learnyouahaskell.com/making-our-own-types-and-typeclasses#typeclasses-102\" rel=\"nofollow noreferrer\">here</a>."}], "answers": [{"tags": [], "owner": {"reputation": 11366, "user_id": 3922954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/76ba47d2fdd24ab56b0b273cce2075e5?s=128&d=identicon&r=PG&f=1", "display_name": "AJF", "link": "https://stackoverflow.com/users/3922954/ajf"}, "is_accepted": true, "score": 8, "last_activity_date": 1570554673, "creation_date": 1570554673, "answer_id": 58291030, "question_id": 58290914, "link": "https://stackoverflow.com/questions/58290914/what-is-the-meaning-of-integral-a-enum-ratio-a-in-documentation-of-haskel/58291030#58291030", "title": "What is the meaning of &quot;Integral a =&gt; Enum (Ratio a)&quot; in documentation of haskell?", "body": "<p><code>Integral a =&gt; Enum (Ratio a)</code> simply means that we require <code>a</code> to be an instance of the typeclass <code>Integral</code> when we declare the instance for <code>Enum (Ratio a)</code>.</p>\n\n<p>That is, if <code>Ratio a</code> is an instance of <code>Enum</code>, then we must have that <code>a</code> is an instance of <code>Integral</code>.</p>\n\n<p>Here is a simplified example, with a silly datatype:</p>\n\n<pre><code>data Representation a = R a\n\ninstance Show a =&gt; Eq (Representation a) where\n  (R a) == (R b) = show a == show b\n</code></pre>\n\n<p>Notice how my restriction of <code>a</code> being a member of <code>Show</code> allows me to use the <code>show</code> function. A similar thing happens in the declaration of <code>Enum (Ratio a)</code>.</p>\n"}], "owner": {"reputation": 31, "user_id": 6361960, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09ccbfe7b3778464f72ff242588f2e1e?s=128&d=identicon&r=PG&f=1", "display_name": "Ativ Joshi", "link": "https://stackoverflow.com/users/6361960/ativ-joshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 58291030, "answer_count": 1, "score": 0, "last_activity_date": 1570554673, "creation_date": 1570554130, "question_id": 58290914, "link": "https://stackoverflow.com/questions/58290914/what-is-the-meaning-of-integral-a-enum-ratio-a-in-documentation-of-haskel", "title": "What is the meaning of &quot;Integral a =&gt; Enum (Ratio a)&quot; in documentation of haskell?", "body": "<p>I am having difficulty reading the Haskell documentation of <code>Data.Ratio</code> (<a href=\"https://www.haskell.org/hugs/pages/libraries/base/Data-Ratio.html\" rel=\"nofollow noreferrer\">link</a>). \nWhat is the meaning of an instance <code>Integral a =&gt; Enum (Ratio a)</code> of <code>data Ratio a</code>? I read about the declaration of instances but did not find any example that have <code>=&gt;</code> while declaring an instance.</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 2, "creation_date": 1570550358, "post_id": 58289927, "comment_id": 102944447, "body": "Hint: what is the length of your list? And how many numbers are you summing?"}], "answers": [{"tags": [], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "is_accepted": false, "score": 6, "last_activity_date": 1570550248, "creation_date": 1570550248, "answer_id": 58290010, "question_id": 58289927, "link": "https://stackoverflow.com/questions/58289927/average-of-list-of-doubles/58290010#58290010", "title": "Average of list of doubles", "body": "<p>You are missunderstanding your own type function, the avarage is always over 3, because you have a list of triplets (or tuples of three?):</p>\n\n<pre><code>averages :: [(Double, Double, Double)] -&gt; [Double]\naverages xs = [ (x+y+z) / 3 | (x,y,z) &lt;- xs ]\n\n\n$&gt; averages [(8,6,7), (4,4,10), (1,1,1)]\n=&gt; [7.0,6.0,1.0]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "is_accepted": false, "score": 4, "last_activity_date": 1570550435, "creation_date": 1570550435, "answer_id": 58290055, "question_id": 58289927, "link": "https://stackoverflow.com/questions/58289927/average-of-list-of-doubles/58290055#58290055", "title": "Average of list of doubles", "body": "<p>Note that <code>length xs</code> will evaluate to <code>1</code> when you evaluate <code>averages [(2.0,1.0,3.0)]</code>. The list contains a single element: a tuple. Since you are averaging the elements of a triplet, you can just divide by <code>3</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "is_accepted": false, "score": 0, "last_activity_date": 1570567159, "creation_date": 1570567159, "answer_id": 58293787, "question_id": 58289927, "link": "https://stackoverflow.com/questions/58289927/average-of-list-of-doubles/58293787#58293787", "title": "Average of list of doubles", "body": "<p>Others have explained why you're getting the wrong answers, but I would like to urge you to break up your problem into two pieces.</p>\n\n<pre><code>averageTriple :: (Double, Double, Double) -&gt; Double\naverageTriple (x,y,z) = ...\n\naverageTriples :: [(Double, Double, Double)] -&gt; [Double]\naverageTriples ts = ... -- use averageTriple here\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 10604784, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SoL72.jpg?s=128&g=1", "display_name": "CS146R", "link": "https://stackoverflow.com/users/10604784/cs146r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 113, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1572883107, "creation_date": 1570549950, "last_edit_date": 1572883107, "question_id": 58289927, "link": "https://stackoverflow.com/questions/58289927/average-of-list-of-doubles", "title": "Average of list of doubles", "body": "<p>I am having some issues writing a Haskell function. I am trying to get the average of a list of triples of doubles. when I divide by just the ' length xs ' ,  I get an error that the length is an Int, so I tried using fromIntegeral and its not giving me an error but not giving the right answer. For example if I test, \n<code>averages [(2.0,1.0,3.0)]</code> it returns <code>[6.0]</code></p>\n\n<pre><code>averages :: [(Double, Double, Double)] -&gt; [Double]\naverages xs = [ (x+y+z) / fromIntegral (length xs) | (x,y,z) &lt;- xs ]\n\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1570534076, "post_id": 58285479, "comment_id": 102935796, "body": "Shouldn&#39;t this be <code>tw x = f (f x)</code>? or even <code>tw f x = f (f x)</code>? Right now the <code>tw</code> function does not make much sense."}, {"owner": {"reputation": 63, "user_id": 12181940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd3e0500c7eba4256ee4650535e26a08?s=128&d=identicon&r=PG&f=1", "display_name": "lsval", "link": "https://stackoverflow.com/users/12181940/lsval"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1570534305, "post_id": 58285479, "comment_id": 102935904, "body": "sorry i missed that. edited in this post."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 6, "last_activity_date": 1570534406, "creation_date": 1570534406, "answer_id": 58285546, "question_id": 58285479, "link": "https://stackoverflow.com/questions/58285479/how-do-i-determine-type-of-haskell-functions/58285546#58285546", "title": "How do I determine type of Haskell functions?", "body": "<p>Let us analyze the function <code>tw</code>:</p>\n\n<pre><code>tw f x = f (f x)\n</code></pre>\n\n<p><code>tw</code> takes as parameters <code>f</code> and <code>x</code>. At the moment we dot not know much about these parameters, so we will give these as types <code>f :: a</code> and <code>x :: b</code>.</p>\n\n<p>Now we see a function application with <code>f</code> the function and <code>x</code> the parameter. This thus means that <code>f</code> is a function that takes a value of type <code>b</code> (the type of <code>x</code>), and returns something. We thus specify that <code>f</code> has as type <code>f :: b -&gt; c</code>, with <code>c</code> a new type variable we introduce. We thus know that <code>f x :: c</code>.</p>\n\n<p>We furthermore see, that there is a function application with <code>f :: b -&gt; c</code> the function, and <code>f x :: c</code> the parameter. Since the type of the parameter of <code>f</code> is <code>b</code>, and <code>f x</code> has as type <code>c</code>. We thus come to the conclusion, that <code>b</code> and <code>c</code> must be the same type.</p>\n\n<p>This thus means that we derived as types:</p>\n\n<pre><code>x :: b\nf :: b -&gt; b\n</code></pre>\n\n<p>We can furthermore analyze the type of <code>tw f x</code> by determining the type of <code>f (f x)</code>. Since <code>f x</code> has type <code>f x :: b</code>, and <code>f</code> has type <code>f :: b -&gt; b</code>, we know that <code>f (f x)</code> has type <code>f (f x) :: b</code>. So that means that the type for <code>tw</code> is:</p>\n\n<pre><code>tw :: (b -&gt; b) -&gt; b -&gt; b\n</code></pre>\n\n<p>If we substitute <code>b</code> for <code>t</code>, then we obtain the expected type signature. But since <code>b</code> and <code>t</code> are just variables, that does not matter much.</p>\n"}], "owner": {"reputation": 63, "user_id": 12181940, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cd3e0500c7eba4256ee4650535e26a08?s=128&d=identicon&r=PG&f=1", "display_name": "lsval", "link": "https://stackoverflow.com/users/12181940/lsval"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 1, "closed_date": 1570565771, "accepted_answer_id": 58285546, "answer_count": 1, "score": 6, "last_activity_date": 1570534406, "creation_date": 1570534019, "last_edit_date": 1570534247, "question_id": 58285479, "link": "https://stackoverflow.com/questions/58285479/how-do-i-determine-type-of-haskell-functions", "closed_reason": "Duplicate", "title": "How do I determine type of Haskell functions?", "body": "<p>I'm preparing for my exams but there is something I can't understand.</p>\n\n<p>functions:</p>\n\n<pre><code>tw f x = f (f x)\nf x y = (y, x)\n</code></pre>\n\n<p>I am able to determine the type of 'f' which is</p>\n\n<pre><code>f :: t1 -&gt; t -&gt; (t, t1)\n</code></pre>\n\n<p>but can't determine the type of 'tw'.</p>\n\n<p>Supposed type of tw:</p>\n\n<pre><code>tw :: (t -&gt; t) -&gt; t -&gt; t\n</code></pre>\n\n<p>thanks!</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1570532954, "post_id": 58285094, "comment_id": 102935269, "body": "If <code>MyItem</code> is an instance of <code>Generic</code>, we can implement something like <a href=\"https://hackage.haskell.org/package/hashable-1.3.0.0/docs/Data-Hashable-Generic.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/hashable-1.3.0.0/docs/&hellip;</a> but then to an <code>UUID</code> instead of an <code>Int</code>."}, {"owner": {"reputation": 208473, "user_id": 126014, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/33526616d4a11f1630d4939b769cfbf9?s=128&d=identicon&r=PG", "display_name": "Mark Seemann", "link": "https://stackoverflow.com/users/126014/mark-seemann"}, "edited": false, "score": 0, "creation_date": 1570542286, "post_id": 58285094, "comment_id": 102940011, "body": "FWIW, <code>fromWords</code> deterministically converts from four <code>Word32</code> values to <code>UUID</code>. <a href=\"http://hackage.haskell.org/package/uuid-1.3.13/docs/Data-UUID.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/uuid-1.3.13/docs/Data-UUID.html</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3892, "user_id": 1236045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cdfcff173a4487d2a73a29e177930ec?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Politowski", "link": "https://stackoverflow.com/users/1236045/micha%c5%82-politowski"}, "edited": false, "score": 1, "creation_date": 1570534369, "post_id": 58285192, "comment_id": 102935931, "body": "Some UUIDs are more deterministic than others: <a href=\"https://en.wikipedia.org/wiki/Universally_unique_identifier#Versions_3_and_5_(namespace_name-based)\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/&hellip;</a> <a href=\"https://tools.ietf.org/html/rfc4122#section-4.3\" rel=\"nofollow noreferrer\">tools.ietf.org/html/rfc4122#section-4.3</a> <a href=\"https://hackage.haskell.org/package/uuid-1.3.13/docs/Data-UUID-V5.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/uuid-1.3.13/docs/Data-UUID-V5.ht&zwnj;&#8203;ml</a>"}, {"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 0, "creation_date": 1570534641, "post_id": 58285192, "comment_id": 102936060, "body": "@julodnik, I need a UUID... now that it requires an intermediary hash make sense to me... but I don&#39;t know how you could guess I don&#39;t need a UUID...."}, {"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "reply_to_user": {"reputation": 3892, "user_id": 1236045, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cdfcff173a4487d2a73a29e177930ec?s=128&d=identicon&r=PG&f=1", "display_name": "Micha\u0142 Politowski", "link": "https://stackoverflow.com/users/1236045/micha%c5%82-politowski"}, "edited": false, "score": 0, "creation_date": 1570534685, "post_id": 58285192, "comment_id": 102936077, "body": "@Micha\u0142Politowski, yeah I have seen this link, but I don&#39;t understand how I could use it so far..."}, {"owner": {"reputation": 309, "user_id": 9110855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/095efb44879a1fc5921b00656042d81b?s=128&d=identicon&r=PG&f=1", "display_name": "julodnik", "link": "https://stackoverflow.com/users/9110855/julodnik"}, "reply_to_user": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 1, "creation_date": 1570536409, "post_id": 58285192, "comment_id": 102936817, "body": "@NicolasHenin: I guess you don&#39;t need a UUID, because semantically an UUID is used as an unique identifier which guarantees uniqueness when properly generated. If you want it to depend on a certain data then it is not unique anymore. It might look like a UUID but it is not anymore. The definition of what you need is a hash function. You can of course format the hash to look like an UUID but it will still not be a UUID."}, {"owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 1, "creation_date": 1570536850, "post_id": 58285192, "comment_id": 102937047, "body": "I don&#39;t follow your logic @julodnik ... It&#39;s a well known concept called Deterministic UUID.... if it&#39;s translated from a Hash to a UUID, at the end this is a UUID.... a UUID is a format..."}, {"owner": {"reputation": 3683, "user_id": 330242, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c9f3ffc3e30d25eb64e2e464f0a86bd7?s=128&d=identicon&r=PG", "display_name": "przemo_li", "link": "https://stackoverflow.com/users/330242/przemo-li"}, "edited": false, "score": 1, "creation_date": 1570539396, "post_id": 58285192, "comment_id": 102938360, "body": "UUID is a thing that&#39;s unique across time and space. By <code>myItem -&gt; UUID</code> as a pure function breaks those guarantees. Please add &quot;Need UUID format - not it&#39;s guarantees&quot; to the question for clarification."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 3683, "user_id": 330242, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c9f3ffc3e30d25eb64e2e464f0a86bd7?s=128&d=identicon&r=PG", "display_name": "przemo_li", "link": "https://stackoverflow.com/users/330242/przemo-li"}, "edited": false, "score": 1, "creation_date": 1570548032, "post_id": 58285192, "comment_id": 102943305, "body": "@przemo_li Like a UUID, a hash is also probabilistically unique.  If <code>myItem</code> hashes to the same value and thus the same UUID.  It is still pseudo-random as asked for by the RFC and it is still universally unique.  Specifically see section 4.3 of RFC 4122 as well as the uniqueness considerations in section 3."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 2, "creation_date": 1570548480, "post_id": 58285192, "comment_id": 102943540, "body": "In other words: &quot;unique across time&quot; is actually not a defining characteristic of UUID these days, quoting the RFC &quot;The UUIDs generated at different times from the same name in the same namespace MUST be equal.&quot;."}], "tags": [], "owner": {"reputation": 309, "user_id": 9110855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/095efb44879a1fc5921b00656042d81b?s=128&d=identicon&r=PG&f=1", "display_name": "julodnik", "link": "https://stackoverflow.com/users/9110855/julodnik"}, "is_accepted": false, "score": 2, "last_activity_date": 1570533460, "last_edit_date": 1570533460, "creation_date": 1570532970, "answer_id": 58285192, "question_id": 58285094, "link": "https://stackoverflow.com/questions/58285094/deterministic-generation-of-uuid-in-haskell/58285192#58285192", "title": "Deterministic Generation of UUID in haskell", "body": "<p>I don't think the UUID is what you need. An UUID is as its name says universally unique, so you should not be getting the same UUID twice (or at least the probability of this happening is negligible).</p>\n\n<p>What you probably need is a <a href=\"https://en.wikipedia.org/wiki/Hash_function\" rel=\"nofollow noreferrer\">hashing method</a>, Haskell has surely support for most of these functions</p>\n\n<p>--- EDIT ---</p>\n\n<p>Take a look at <a href=\"https://stackoverflow.com/questions/30536583/compute-md5-digest-of-file-in-haskell\">this</a> question for a way of computing a hash out of a file. I think you can easily adapt this to your needs.</p>\n"}, {"comments": [{"owner": {"reputation": 3683, "user_id": 330242, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c9f3ffc3e30d25eb64e2e464f0a86bd7?s=128&d=identicon&r=PG", "display_name": "przemo_li", "link": "https://stackoverflow.com/users/330242/przemo-li"}, "reply_to_user": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "edited": false, "score": 0, "creation_date": 1570539252, "post_id": 58285197, "comment_id": 102938272, "body": "<code>fromString</code> may be useful: <a href=\"http://hackage.haskell.org/package/uuid-1.3.13/docs/Data-UUID.html\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/uuid-1.3.13/docs/Data-UUID.html</a>"}], "tags": [], "owner": {"reputation": 3683, "user_id": 330242, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c9f3ffc3e30d25eb64e2e464f0a86bd7?s=128&d=identicon&r=PG", "display_name": "przemo_li", "link": "https://stackoverflow.com/users/330242/przemo-li"}, "is_accepted": false, "score": 1, "last_activity_date": 1570532978, "creation_date": 1570532978, "answer_id": 58285197, "question_id": 58285094, "link": "https://stackoverflow.com/questions/58285094/deterministic-generation-of-uuid-in-haskell/58285197#58285197", "title": "Deterministic Generation of UUID in haskell", "body": "<p>Pick sufficiently unique set of attributes of <code>myItem</code> - generate hash - you got your UUID. Chance of clashing hashes depend of course on hash algorithm and quality of attributes you pick.</p>\n"}, {"tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": true, "score": 3, "last_activity_date": 1570543564, "creation_date": 1570543564, "answer_id": 58288027, "question_id": 58285094, "link": "https://stackoverflow.com/questions/58285094/deterministic-generation-of-uuid-in-haskell/58288027#58288027", "title": "Deterministic Generation of UUID in haskell", "body": "<p>Just hash the data with a Hash that is at least 128 bits then use <code>Data.Binary.decode :: ByteString -&gt; UUID</code>.  For example:</p>\n\n<pre><code>#!/usr/bin/env cabal\n{- cabal:\n    build-depends: base, binary, uuid-types, cryptohash-sha256, bytestring\n-}\n{-# LANGUAGE DeriveAnyClass #-}\n{-# LANGUAGE DeriveGeneric  #-}\n{-# LANGUAGE TypeApplications #-}\nimport Data.Binary (decode,encode,Binary)\nimport Crypto.Hash.SHA256 (hashlazy)\nimport Data.UUID.Types\nimport GHC.Generics\nimport Data.ByteString.Lazy (fromStrict)\n\ndata Foo = Foo Int String\n    deriving (Eq,Ord,Show,Generic,Binary)\n\nmain :: IO ()\nmain = print (decode @UUID (fromStrict (hashlazy (encode (Foo 1 \"hello\")))))\n</code></pre>\n\n<p>And:</p>\n\n<pre><code>chmod +x so.hs ; ./so.hs\n...\nf32f6f68-2131-8c5e-babd-f7e1dc190163\n</code></pre>\n"}], "owner": {"reputation": 2970, "user_id": 1298865, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/hOaaf.png?s=128&g=1", "display_name": "Nicolas Henin", "link": "https://stackoverflow.com/users/1298865/nicolas-henin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 149, "favorite_count": 0, "accepted_answer_id": 58288027, "answer_count": 3, "score": 1, "last_activity_date": 1570543564, "creation_date": 1570532593, "question_id": 58285094, "link": "https://stackoverflow.com/questions/58285094/deterministic-generation-of-uuid-in-haskell", "title": "Deterministic Generation of UUID in haskell", "body": "<p>I'm looking for a deterministic way to get UUID from a datatype, like I always get the same UUID... </p>\n\n<p><code>myItem -&gt; UUID</code></p>\n"}, {"tags": ["haskell", "recursion", "tree", "binary-tree"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1570531472, "post_id": 58284794, "comment_id": 102934632, "body": "But you are already using recursion."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 6, "last_activity_date": 1570533045, "last_edit_date": 1570533045, "creation_date": 1570531673, "answer_id": 58284870, "question_id": 58284794, "link": "https://stackoverflow.com/questions/58284794/transform-a-tree-in-haskell/58284870#58284870", "title": "Transform a tree in Haskell", "body": "<p>You are already solving this recursively. Indeed you call <code>binaryTreeToRose</code> on the children <code>left</code> and <code>right</code>. So you define <code>binaryTreeToRose</code> in terms of itself.</p>\n\n<p>Your function is however not total. Since for <code>binaryTreeToRose Null</code> it will error. We can make the return type a <code>Maybe (RoseTree a)</code>:</p>\n\n<pre><code>import Data.Maybe(catMaybes)\n\nbinaryTreeToRose :: BinaryTree a -&gt; <b>Maybe</b> (RoseTree a)\nbinaryTreeToRose Null = Nothing\nbinaryTreeToRose (Node l a r) = Just (RoseNode a (<b>catMaybes</b> (map binaryTreeToRose [l, r])))</code></pre>\n\n<p>or even shorter:</p>\n\n<pre><code>import Data.Maybe(mapMaybe)\n\nbinaryTreeToRose :: BinaryTree a -&gt; Maybe (RoseTree a)\nbinaryTreeToRose Null = Nothing\nbinaryTreeToRose (Node l a r) = Just (RoseNode a (<b>mapMaybe</b> binaryTreeToRose [l, r]))</code></pre>\n"}, {"tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 2, "last_activity_date": 1570551581, "last_edit_date": 1570551581, "creation_date": 1570545986, "answer_id": 58288792, "question_id": 58284794, "link": "https://stackoverflow.com/questions/58284794/transform-a-tree-in-haskell/58288792#58288792", "title": "Transform a tree in Haskell", "body": "<p>Change </p>\n\n<pre><code>           [binaryTreeToRose left]++[binaryTreeToRose right]\n</code></pre>\n\n<p>(it's an error, anyway) in your last code line to </p>\n\n<pre><code>           (binaryTreeToRose left ++ binaryTreeToRose right)\n</code></pre>\n\n<p>, change the function's type to </p>\n\n<pre><code>binaryTreeToRose :: BinaryTree a -&gt; [RoseTree a]\n</code></pre>\n\n<p>and amend the other cases accordingly (also adding a new clause, for the  <code>Null</code> case).</p>\n\n<p>Your <code>BinaryTree</code> can be empty (represented by <code>Null</code>), but <code>RoseTree</code> can't. This means we can't transform the former into the latter, but rather into a <em>list</em> of them. </p>\n\n<p>The Haskell library calls the type <code>[RoseTree a]</code> a <em>\"Forest\"</em>. So the result of the conversion will be a <em>forest of rose trees</em>, containing either one, or zero of them (representing the empty binary tree case).</p>\n\n<p>Having an empty tree is like having no trees at all. There's no fruit either way.</p>\n"}, {"tags": [], "owner": {"reputation": 380, "user_id": 1635672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdd0c9e0a1fd1b3f1bb3e1184eb01b64?s=128&d=identicon&r=PG", "display_name": "Zhu Jinxuan", "link": "https://stackoverflow.com/users/1635672/zhu-jinxuan"}, "is_accepted": false, "score": 1, "last_activity_date": 1615739593, "last_edit_date": 1615739593, "creation_date": 1570548731, "answer_id": 58289580, "question_id": 58284794, "link": "https://stackoverflow.com/questions/58284794/transform-a-tree-in-haskell/58289580#58289580", "title": "Transform a tree in Haskell", "body": "<p>If you want to have fun, you can use recursion-schemes for recursion.  In this scenario, recursion schemes provides an automatic recursion by providing an one-layer deduction.</p>\n<p>For example:</p>\n<pre><code>data BT a = BNil | BN (BT a) a (BT a)\n             deriving Show\ndata RT a = RN a [RT a]\n             deriving Show\n\n-- data BTF a f = BNilF | BNF f a f deriving Functor\nmakeBaseFunctor ''BT   --BinaryTree\n\n-- binaryTreeToRose :: BinaryTree a -&gt; Maybe (RoseTree a)\nbinaryTreeToRose :: BT a -&gt; Maybe (RT a)\nbinaryTreeToRose = cata alg where\n  alg BNilF = Nothing\n  alg BNF l a r = Just $ RN a $ catMaybes (l ++ r)\n</code></pre>\n"}], "owner": {"reputation": 215, "user_id": 12036912, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Bs1MMku7W04/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcRX-T31D-fLdCF5w6i9pacNreJ9w/photo.jpg?sz=128", "display_name": "Jayyyyyy", "link": "https://stackoverflow.com/users/12036912/jayyyyyy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 330, "favorite_count": 1, "answer_count": 3, "score": 5, "last_activity_date": 1615739593, "creation_date": 1570531384, "last_edit_date": 1570546274, "question_id": 58284794, "link": "https://stackoverflow.com/questions/58284794/transform-a-tree-in-haskell", "title": "Transform a tree in Haskell", "body": "<pre><code>  data BinaryTree a = Null | Node (BinaryTree a) a (BinaryTree a)\n             deriving Show\n  data RoseTree a = RoseNode a [RoseTree a]\n     deriving Show\n  binaryTreeToRose :: BinaryTree a -&gt; RoseTree a\n         binaryTreeToRose btree = case btree of\n         Node Null a Null -&gt; RoseNode a []\n         Node left a Null -&gt; RoseNode a [binaryTreeToRose left]\n         Node Null a right -&gt; RoseNode a [binaryTreeToRose right]\n         Node left a right -&gt; RoseNode a [binaryTreeToRose left]++[binaryTreeToRose right]\n</code></pre>\n\n<p>I try to write a function to transform Binary tree into Rose tree in Haskell. But I have not idea about how to solve this with recursion.</p>\n"}, {"tags": ["haskell", "state", "immutability"], "answers": [{"tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": false, "score": 2, "last_activity_date": 1570521934, "creation_date": 1570521934, "answer_id": 58282397, "question_id": 58281577, "link": "https://stackoverflow.com/questions/58281577/state-with-io-in-haskell-for-cli-application/58282397#58282397", "title": "State with IO in Haskell for CLI application", "body": "<p>A simple solution to this problem which doesn't involve using monads besides <code>IO</code> is to use inner <code>loop</code> function which keeps its state as an argument. I'm going to provide an artificial example below:</p>\n\n<pre><code>myProgram :: IO [Char]\nmyProgram = loop []\n  where\n    loop :: [Char] -&gt; IO [Char]\n    loop state = do\n        input &lt;- getLine\n        case input of\n            \"A\" -&gt; do\n                putStrLn \"Advancing state with A\"\n                loop ('A' : state)\n            \"B\" -&gt; do\n                putStrLn \"State didn't change\"\n                loop state\n            _ -&gt; do\n                putStrLn \"Finishing game\"\n                pure state  -- recursion ends here\n</code></pre>\n\n<p>So a combination of recursion and pattern-matching allows you to change your state depending on your input. So when you call <code>loop</code> next time, it's given a possible new <code>state</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "is_accepted": false, "score": 1, "last_activity_date": 1570528522, "creation_date": 1570528522, "answer_id": 58284053, "question_id": 58281577, "link": "https://stackoverflow.com/questions/58281577/state-with-io-in-haskell-for-cli-application/58284053#58284053", "title": "State with IO in Haskell for CLI application", "body": "<p>Provided that don't know how do you to keep the state. Here just provide a simple example show how to use <code>StateT</code> with reading characters from standard input. </p>\n\n<p>Firstly, to define the <code>advanceState</code> function as:</p>\n\n<pre><code>advanceState::StateT [Char] IO [Char]\nadvanceState = StateT readInput where\n    readInput cs = do c &lt;- getChar\n                      let newState = (c:cs)\n                      return (newState, newState)\n</code></pre>\n\n<p>The function embedded in <code>StateT</code> is <code>readInput</code>, it has type: </p>\n\n<pre><code>[Char]-&gt;IO ([Char], [Char])\n</code></pre>\n\n<p>The first element of pair <code>([Char], [Char])</code> is input that what we want, and the second element of that is the \"state\" will pass to <code>readInput</code> whenever <code>advanceState</code> is called again.</p>\n\n<p>Now, below is an example show how to use <code>advanceState</code>:</p>\n\n<pre><code>getChar10::StateT [Char] IO [Char]\ngetChar10 = do s &lt;- advanceState\n               if (length s) &lt;= 10\n               then getChar10\n               else do put []\n                       return (reverse s)\n</code></pre>\n\n<p>This example show how to get 10 character from standard input when the user press enter, note that <code>put []</code> reset the state so that next call of <code>advanceState</code> will not has the previous input.</p>\n\n<p>Finally, we can play around with them:</p>\n\n<pre><code>playState::IO ()\nplayState = print =&lt;&lt; evalStateT loop [] where\n    loop  = do s1 &lt;- getChar10\n               s2 &lt;- getChar10\n               return (s1 ++ \"::\" ++ s2)  \n</code></pre>\n\n<p>The <code>playState</code> function will print first 20 characters (included new line character \\n, \\r) whatever how many characters user has inputted before press enter. If input not enough 20 characters, <code>playState</code> will request user to input more characters.</p>\n"}], "owner": {"reputation": 702, "user_id": 4330449, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/100006825462602/picture?type=large", "display_name": "Niklas Vest", "link": "https://stackoverflow.com/users/4330449/niklas-vest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1570528522, "creation_date": 1570518260, "last_edit_date": 1570521603, "question_id": 58281577, "link": "https://stackoverflow.com/questions/58281577/state-with-io-in-haskell-for-cli-application", "title": "State with IO in Haskell for CLI application", "body": "<p>I am trying to write a simple implementation of the game Hangman in Haskell and one problem I have is keeping the state of the game.</p>\n\n<p>A simplified / abstract version of my problem looks like this:</p>\n\n<pre><code>advanceState :: Char -&gt; [Char] -&gt; [Char]\nadvanceState = (:)\n</code></pre>\n\n<p>My question seems simple but I can't figure out the answer: How can I invoke this function after each character supplied via the standard input and how can I terminate the loop once a certain set of characters was read?</p>\n\n<p>Note that I have also tried versions with <code>State [Char] a</code> and <code>StateT [Char] IO a</code> to no avail.</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1570521793, "post_id": 58281327, "comment_id": 102930135, "body": "Maybe <code>:i Enum</code> shows it? I&#39;m unsure, though."}], "answers": [{"tags": [], "owner": {"reputation": 1602, "user_id": 5947247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5212b96ae435bb73b9980f34b2913e8?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac van Bakel", "link": "https://stackoverflow.com/users/5947247/isaac-van-bakel"}, "is_accepted": true, "score": 3, "last_activity_date": 1570549935, "creation_date": 1570549935, "answer_id": 58289918, "question_id": 58281327, "link": "https://stackoverflow.com/questions/58281327/how-to-query-the-type-of-a-default-method/58289918#58289918", "title": "How to query the type of a default method?", "body": "<p><code>:info Enum</code> will do it.</p>\n\n<p>For your example, this will produce the output</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>class Enum a where\n  enum :: [a]\n  default enum :: (Generic a, GEnum (Rep a)) =&gt; [a]\n        -- Defined at ...\n</code></pre>\n"}], "owner": {"reputation": 17170, "user_id": 1671066, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/bd4c9461f2d17a884fba66eeed20e320?s=128&d=identicon&r=PG", "display_name": "Micha Wiedenmann", "link": "https://stackoverflow.com/users/1671066/micha-wiedenmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 42, "favorite_count": 0, "accepted_answer_id": 58289918, "answer_count": 1, "score": 3, "last_activity_date": 1570549935, "creation_date": 1570517141, "question_id": 58281327, "link": "https://stackoverflow.com/questions/58281327/how-to-query-the-type-of-a-default-method", "title": "How to query the type of a default method?", "body": "<p>The GHC extension <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#ghc-flag--XDefaultSignatures\" rel=\"nofollow noreferrer\">DefaultSignatures</a> allows to change the type of a default method:</p>\n\n<pre><code>class Enum a where\n  enum :: [a]\n  default enum :: (Generic a, GEnum (Rep a)) =&gt; [a]\n  enum = map to genum\n</code></pre>\n\n<p>Is it possible to ask the compiler for the type of the default method? What is the syntax to do so? <code>:t enum</code> is not enough (since it obviously reports <code>enum :: Enum a =&gt; [a]</code>).</p>\n"}, {"tags": ["haskell", "module", "hmatrix"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 4, "creation_date": 1570518154, "post_id": 58280550, "comment_id": 102928570, "body": "Browsing through the versions and the changelog at <a href=\"http://hackage.haskell.org/package/hmatrix\" rel=\"nofollow noreferrer\">hackage.haskell.org/package/hmatrix</a> it looks like the <code>Data.Packed.*</code> modules were removed in 0.17 (having been kept only for backwards compatibility for a few versions before that). Looks like you&#39;ll have to use an earlier version, or find another way of doing what you want. (I&#39;m not familiar with the package so can&#39;t help with that.)"}, {"owner": {"reputation": 115, "user_id": 3680029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2f9062247d1bcf616e8a6cf493c00fc?s=128&d=identicon&r=PG&f=1", "display_name": "user3680029", "link": "https://stackoverflow.com/users/3680029/user3680029"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1570521354, "post_id": 58280550, "comment_id": 102929956, "body": "I didn&#39;t noticed that, ok that&#39;s explaining why. I will search for another package if I fail to access matrix position."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1570531533, "post_id": 58280550, "comment_id": 102934659, "body": "That shouldn&#39;t be necessary \u2013 I&#39;m sure you <i>can</i> get the functionality with newer hmatrix versions as well. That said, do search for other packages as well. I&#39;m not a fan on hmatrix, it is rather un-Haskellish, more like Matlab or R as a library. If you don&#39;t need linear algebra but just matrices as 2d arrays, <a href=\"http://hackage.haskell.org/package/repa\" rel=\"nofollow noreferrer\">repa</a> should do. If you want \u201cclassical matrix LA\u201d, <a href=\"http://hackage.haskell.org/package/lapack\" rel=\"nofollow noreferrer\">lapack</a> might be a better choice. ..."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 1, "creation_date": 1570531539, "post_id": 58280550, "comment_id": 102934662, "body": "... And if you want to delve into <i>really</i> Haskell-ish approaches, note that it can be a good idea to get rid of the standard plain-matrix view entirely. The <a href=\"http://hackage.haskell.org/package/linear\" rel=\"nofollow noreferrer\">linear</a> package deals with free vector spaces as representable functors. The <a href=\"http://hackage.haskell.org/package/vector-space\" rel=\"nofollow noreferrer\">vector-space</a> and <a href=\"http://hackage.haskell.org/package/linearmap-category\" rel=\"nofollow noreferrer\">linearmap-category</a> abandon the idea of freeness / finite basis entirely, and do abstract functional analysis."}, {"owner": {"reputation": 115, "user_id": 3680029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2f9062247d1bcf616e8a6cf493c00fc?s=128&d=identicon&r=PG&f=1", "display_name": "user3680029", "link": "https://stackoverflow.com/users/3680029/user3680029"}, "edited": false, "score": 0, "creation_date": 1570531811, "post_id": 58280550, "comment_id": 102934783, "body": "Ok. Thx. My idea is to play a little bit with neural network with haskell biuld some intuition around them at a rather low level but not to much."}, {"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1570533288, "post_id": 58280550, "comment_id": 102935429, "body": "Then you could of course also look into something ready-built like <a href=\"http://hackage.haskell.org/package/grenade\" rel=\"nofollow noreferrer\">grenade</a> (based on hmatrix) \u2013 either as a library or as a reference."}, {"owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "edited": false, "score": 0, "creation_date": 1570552263, "post_id": 58280550, "comment_id": 102945289, "body": "Just to through it out there, another option for a high performance array library is <a href=\"https://github.com/lehins/massiv\" rel=\"nofollow noreferrer\">massiv</a>. Bogdan Penkovsky has been experimenting recently with it for dealing with neural networks: <a href=\"http://penkovsky.com/post/neural-networks-4/\" rel=\"nofollow noreferrer\">penkovsky.com/post/neural-networks-4</a>"}], "owner": {"reputation": 115, "user_id": 3680029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2f9062247d1bcf616e8a6cf493c00fc?s=128&d=identicon&r=PG&f=1", "display_name": "user3680029", "link": "https://stackoverflow.com/users/3680029/user3680029"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1570511776, "creation_date": 1570511776, "question_id": 58280550, "link": "https://stackoverflow.com/questions/58280550/couldnt-import-data-packed-matrix", "title": "Couldn&#39;t import Data.Packed.Matrix", "body": "<p>This is my package.yaml:</p>\n\n<pre><code>   dependencies:\n      - base &gt;= 4.7 &amp;&amp; &lt; 5\n      - hmatrix\n      - vector\n</code></pre>\n\n<p>my imports:</p>\n\n<pre><code>import Prelude hiding ( (&lt;&gt;) )\n\nimport Numeric.LinearAlgebra\nimport **Data.Packed.Matrix**\nimport qualified Data.Vector as V\n</code></pre>\n\n<p>I would like to import Data.Packed.Matrix to use the @@> accessor, GHC is complaining: <code>Could not find module `Data.Packed.Matrix'</code></p>\n\n<p>I googled with no success, probably I must be doing a stupid error. Data.Packed.Matrix is referred in the hmatrix package a simple import should be enough.</p>\n"}, {"tags": ["haskell", "graph", "functional-programming"], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 12151860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDzSn6OW34aHl_xg7YF7kz32Jz-b-dU3b3x6Ktl=k-s128", "display_name": "Velyyn S", "link": "https://stackoverflow.com/users/12151860/velyyn-s"}, "edited": false, "score": 0, "creation_date": 1570550344, "post_id": 58281899, "comment_id": 102944434, "body": "Hey, thanks a lot for your answer, i tried this code <code>unlabelGraph :: Ord v =&gt; Graph v -&gt; Graph v unlabelGraph  (Graph arcs labels styles) =     (Graph arcs (mapWithKey f labels) styles)     where f key value = &quot;sdhjfgkuewhdoji&quot;    </code>  I did this to understand what the function does, I do not know why it does not show sdhjfgkuewhdoji in the values \u200b\u200bof my label map(its empty). Do you have any idea why?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 87, "user_id": 12151860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDzSn6OW34aHl_xg7YF7kz32Jz-b-dU3b3x6Ktl=k-s128", "display_name": "Velyyn S", "link": "https://stackoverflow.com/users/12151860/velyyn-s"}, "edited": false, "score": 0, "creation_date": 1570551058, "post_id": 58281899, "comment_id": 102944770, "body": "@VelyynS <code>map</code> / <code>mayWithKey</code> replace <i>existing</i> values in the map. If you start from an empty map, the result is still empty. Perhaps what you want instead is to replace the values in the <code>arcs</code> map, so that you use those keys instead of the one in the <code>labels</code> map?"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 2, "last_activity_date": 1570519759, "creation_date": 1570519759, "answer_id": 58281899, "question_id": 58279934, "link": "https://stackoverflow.com/questions/58279934/where-clause-in-haskell-using-data-map/58281899#58281899", "title": "Where clause in Haskell using Data.Map", "body": "<p>This should work:</p>\n\n<pre><code>import qualified Data.Map as M\n\nunlabelGraph  (Graph arcs labels styles) =\n   (Graph arcs (M.mapWithKey f labels) styles)\n   where f _key _value = \"\"\n</code></pre>\n\n<p>Still, you don't really need the key in your <code>f</code>, since it will always return the empty string. Hence, we can use</p>\n\n<pre><code>unlabelGraph  (Graph arcs labels styles) =\n   (Graph arcs (M.map f labels) styles)\n   where f _value = \"\"\n</code></pre>\n\n<p>or even</p>\n\n<pre><code>unlabelGraph  (Graph arcs labels styles) =\n   (Graph arcs (M.map (const \"\") labels) styles)\n</code></pre>\n\n<p>or even</p>\n\n<pre><code>unlabelGraph g = g{labelMap = M.map (const \"\") (labelMap g)}\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 12151860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDzSn6OW34aHl_xg7YF7kz32Jz-b-dU3b3x6Ktl=k-s128", "display_name": "Velyyn S", "link": "https://stackoverflow.com/users/12151860/velyyn-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 58281899, "answer_count": 1, "score": 0, "last_activity_date": 1570519759, "creation_date": 1570506278, "last_edit_date": 1570508837, "question_id": 58279934, "link": "https://stackoverflow.com/questions/58279934/where-clause-in-haskell-using-data-map", "title": "Where clause in Haskell using Data.Map", "body": "<p>I have a little question in a specific senario in Haskell.</p>\n\n<p>My graph :</p>\n\n<pre><code>import Data.Map (Map,empty,member,insert,keys,findWithDefault,assocs ,fromList,(!),union,mapWithKey,adjust)\nimport Graphviz\n\n-- | A directed graph\ndata Graph v = Graph\n    { arcsMap :: Map v [v]     -- A map associating a vertex with its successors\n    , labelMap :: Map v String -- The Graphviz label of each node\n    , styleMap :: Map v String -- The Graphviz style of each node\n    }\n</code></pre>\n\n<p>My function :</p>\n\n<pre><code>-- | Replaces the labels of each vertex by an empty string\n--\n-- &gt;&gt;&gt; g = addArcs emptyGraph [(1,2),(2,3),(1,3)]\n-- &gt;&gt;&gt; putStrLn $ graphvizString $ unlabelGraph g\n-- digraph {\n--     1 [label=\"\"];\n--     2 [label=\"\"];\n--     3 [label=\"\"];\n--     1 -&gt; 2;\n--     1 -&gt; 3;\n--     2 -&gt; 3;\n-- }\n-- ...\nunlabelGraph :: Ord v =&gt; Graph v -&gt; Graph v\nunlabelGraph  (Graph arcs labels styles)= (Graph arcs (mapWithKey f labels ) styles)\n                                         where f  = adjust \"\" *the actual key*\n</code></pre>\n\n<p>I want to reach every value of the Map labels to replace them by \"\".\nHow can i specify that i want the key of the Map inside the where clause of my function?\nIs this the best way to write this function ?</p>\n"}, {"tags": ["regex", "haskell", "posix"], "comments": [{"owner": {"reputation": 4614, "user_id": 1378868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84a42920594ee2a0cc33012c407fd9d5?s=128&d=identicon&r=PG", "display_name": "snak", "link": "https://stackoverflow.com/users/1378868/snak"}, "edited": false, "score": 1, "creation_date": 1570497148, "post_id": 58278655, "comment_id": 102923930, "body": "It works as you expected on macOS 10.14.6 with Stackage LTS 14.7 (GHC 8.6.5, regex-base-0.93.2, regex-posix-0.95.2)."}, {"owner": {"reputation": 778, "user_id": 6499999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48bb54922bb8f6ad1b5ba41fd3e9bf1b?s=128&d=identicon&r=PG", "display_name": "JoL", "link": "https://stackoverflow.com/users/6499999/jol"}, "edited": false, "score": 1, "creation_date": 1570497318, "post_id": 58278655, "comment_id": 102923963, "body": "It also works as you expected on Archlinux using the same GHC and package versions. I got the answer immediately."}], "answers": [{"tags": [], "owner": {"reputation": 1602, "user_id": 5947247, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5212b96ae435bb73b9980f34b2913e8?s=128&d=identicon&r=PG&f=1", "display_name": "Isaac van Bakel", "link": "https://stackoverflow.com/users/5947247/isaac-van-bakel"}, "is_accepted": false, "score": 0, "last_activity_date": 1577124488, "creation_date": 1577124488, "answer_id": 59459572, "question_id": 58278655, "link": "https://stackoverflow.com/questions/58278655/text-regex-posixs-operator-cannot-get-the-return-value-in-some-patterns/59459572#59459572", "title": "Text.Regex.Posix&#39;s =~ operator cannot get the return value in some patterns", "body": "<p>Given both the comments and the nature of the package, this is likely to be due to a bug in the underlying C library on your particular system which provides RegEx logic.</p>\n\n<p>This is not the first bug specific to Windows reported for this package (see <a href=\"https://stackoverflow.com/questions/39047317/simple-regular-expression-substitution-crashes-on-windows-using-regex-compat/\">here</a> and <a href=\"https://github.com/haskell-hvr/regex-posix/issues/1\" rel=\"nofollow noreferrer\">here</a>). You can open an issue on the <code>regex-posix</code> repository and see if they can find the culprit.</p>\n"}], "owner": {"reputation": 31, "user_id": 12179537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89ae57f9fee2676a2cd87db7bf4ef8b6?s=128&d=identicon&r=PG&f=1", "display_name": "satun", "link": "https://stackoverflow.com/users/12179537/satun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 60, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1577124488, "creation_date": 1570493951, "last_edit_date": 1570494351, "question_id": 58278655, "link": "https://stackoverflow.com/questions/58278655/text-regex-posixs-operator-cannot-get-the-return-value-in-some-patterns", "title": "Text.Regex.Posix&#39;s =~ operator cannot get the return value in some patterns", "body": "<p>Text.Regex.Posix's =~ operator cannot get the return value in some patterns.</p>\n\n<p>For example,</p>\n\n<pre><code>&gt; import Text.Regex.Posix\n&gt; \"y2019m10d08\" =~ \"y([0-9]{4})?m([0-9]{1,2})?d([0-9]{1,2})?\" :: Bool \nTrue\n&gt; \"y2019m10d08\" =~ \"y([0-9]{4})?m([0-9]{1,2})?d([0-9]{1,2})?\" :: Int \n1\n&gt; \"y2019m10d08\" =~ \"y([0-9]{4})?m([0-9]{1,2})?d([0-9]{1,2})?\" :: [[String]]\n</code></pre>\n\n<p>What I expected</p>\n\n<pre><code>[[\"y2019m10d08\",\"2019\",\"10\",\"08\"]]\n</code></pre>\n\n<p>But after the last entry, the calculation doesn't seem to end.</p>\n\n<p>Why?</p>\n\n<p>My environment:</p>\n\n<ul>\n<li>Windows 10</li>\n<li>GHC 8.6.5</li>\n<li>regex-base-0.93.2</li>\n<li>regex-posix-0.95.2</li>\n</ul>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 649, "user_id": 3034580, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b79832c826b77bab56982225b17901df?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/3034580/joe"}, "edited": false, "score": 1, "creation_date": 1570495156, "post_id": 58278538, "comment_id": 102923590, "body": "I see there are some caveats and mixed opinions on RecordWildCards extension because if not used carefully it can cause you to lose type checking (and other negatives). However, I found a nice blog post discussing tradeoffs and design considerations: <a href=\"https://kodimensional.dev/recordwildcards\" rel=\"nofollow noreferrer\">kodimensional.dev/recordwildcards</a>"}], "tags": [], "owner": {"reputation": 7033, "user_id": 288201, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/b4b21f0f66f55fe614e7eeac6807f7f4?s=128&d=identicon&r=PG", "display_name": "Koterpillar", "link": "https://stackoverflow.com/users/288201/koterpillar"}, "is_accepted": false, "score": 3, "last_activity_date": 1570492859, "creation_date": 1570492859, "answer_id": 58278538, "question_id": 58278480, "link": "https://stackoverflow.com/questions/58278480/set-value-of-record-field-to-calculation-involving-another-field-in-same-record/58278538#58278538", "title": "Set value of record field to calculation involving another field in same record", "body": "<p>One possibility is <a href=\"http://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#record-wildcards\" rel=\"nofollow noreferrer\"><code>RecordWildCards</code> extension</a>:</p>\n\n<pre><code>{-# LANGUAGE RecordWildCards #-}\n\nfoo = Foo {..}\n  where\n    batz = 1.0\n    zoinx = batz * 2\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "is_accepted": false, "score": 2, "last_activity_date": 1570493547, "last_edit_date": 1570493547, "creation_date": 1570492917, "answer_id": 58278545, "question_id": 58278480, "link": "https://stackoverflow.com/questions/58278480/set-value-of-record-field-to-calculation-involving-another-field-in-same-record/58278545#58278545", "title": "Set value of record field to calculation involving another field in same record", "body": "<p>It's not entirely clear what the general intention is here. Obviously, you could define this value simply as:</p>\n\n<pre><code>foo =\n  Foo \n    { batz = 1.0\n    , zoinx = 2.0\n    }\n</code></pre>\n\n<p>but I'm sure you don't need to be told that, and it's probably not at all helpful.</p>\n\n<p>If you want to be able to create several different <code>Foo</code> values each with this relation between the fields, then you could simply define a function like this:</p>\n\n<pre><code>makeFoo :: Double -&gt; Foo\nmakeFoo x = Foo { batz = x, zoinx = 2 * x }\n</code></pre>\n\n<p>and then of course <code>foo = makeFoo 1</code></p>\n\n<p>And this could be generalised further in a few ways - firstly by changing the multiplier:</p>\n\n<pre><code>makeFoo2 :: Int -&gt; Double -&gt; Foo\nmakeFoo2 n x = Foo { batz = x, zoinx = n * x }\n</code></pre>\n\n<p>or you could indeed use an arbitrary function:</p>\n\n<pre><code>makeFoo3 :: (Double -&gt; Double) -&gt; Double -&gt; Foo\nmakeFoo3 f x = Foo { batz = x, zoinx = f x }\n</code></pre>\n\n<p>Hopefully these solutions can meet whatever real life situation inspired this question.</p>\n"}, {"comments": [{"owner": {"reputation": 649, "user_id": 3034580, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b79832c826b77bab56982225b17901df?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/3034580/joe"}, "edited": false, "score": 0, "creation_date": 1570651429, "post_id": 58311055, "comment_id": 102984245, "body": "Thanks Jon. Do you ever prefer the desugared version? I only ask because I see there are caveats with both RecordWildCards and NamedFieldPuns, for example: <a href=\"https://www.reddit.com/r/haskell/comments/aq961k/recordwildcards_no_namedfieldpuns_also_no_maybe_eh/\" rel=\"nofollow noreferrer\">reddit.com/r/haskell/comments/aq961k/&hellip;</a>"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 649, "user_id": 3034580, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b79832c826b77bab56982225b17901df?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/3034580/joe"}, "edited": false, "score": 1, "creation_date": 1570652757, "post_id": 58311055, "comment_id": 102984713, "body": "@Joe Yeah, by default I use no record-related extensions, so I\u2019d write something like <code>Foo { batz = b, zoinx = z }</code>, or use accessor functions or lenses. I typically only reach for <code>NamedFieldPuns</code> when dealing with large records, and even then confine the scope as much as possible, within a short <code>case</code> branch or <code>let</code>\u2026<code>in</code>\u2026 expression. It\u2019s a matter of style and the tradeoffs between writability and readability, but I tend to err on the side of the latter, and often that means spending a bit more time and code to be explicit, for instance, using <code>qualified</code> or named imports."}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 649, "user_id": 3034580, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b79832c826b77bab56982225b17901df?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/3034580/joe"}, "edited": false, "score": 1, "creation_date": 1570652941, "post_id": 58311055, "comment_id": 102984782, "body": "@Joe Indeed you can also use accessor functions here: <code>foo = Foo { batz = 1.0, zoinx = batz foo * 2 }</code> or <code>foo = fix $ \\ self -&gt; Foo { batz = 1.0, zoinx = batz self * 2 }</code> (<code>$</code> omittable with <code>BlockArguments</code>)"}], "tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": true, "score": 2, "last_activity_date": 1570649463, "creation_date": 1570649463, "answer_id": 58311055, "question_id": 58278480, "link": "https://stackoverflow.com/questions/58278480/set-value-of-record-field-to-calculation-involving-another-field-in-same-record/58311055#58311055", "title": "Set value of record field to calculation involving another field in same record", "body": "<p>As an alternative to <code>RecordWildCards</code>, you can use <code>NamedFieldPuns</code> to list the fields explicitly:</p>\n\n<pre><code>{-# LANGUAGE NamedFieldPuns #-}\n\nfoo = Foo { batz, zoinx }\n  where\n    batz = 1.0\n    zoinx = batz * 2\n</code></pre>\n\n<p>This is syntactic sugar for:</p>\n\n<pre><code>foo = Foo { batz = batz, zoinx = zoinx }\n--          (1)    (2)   (3)     (4)\n  where\n    batz = 1.0\n    zoinx = batz * 2\n</code></pre>\n\n<p>(1) and (3) refer to the fields of <code>Foo</code> while (2) and (4) refer to the bindings in the <code>where</code> clause.</p>\n\n<p>I find this more readable because it\u2019s clearer which names come from where, and it\u2019s more resilient to changes in the code\u2014in particular: which names are in scope, and the names of the fields of the data type.</p>\n\n<p><code>NamedFieldPuns</code> can also be used similarly in patterns:</p>\n\n<pre><code>let Foo { batz, zoinx } = foo in batz + zoinx\n\ncase foo of { Foo { batz, zoinx } -&gt; batz + zoinx }\n</code></pre>\n\n<p>Likewise these are syntactic sugar for:</p>\n\n<pre><code>let Foo { batz = batz, zoinx = zoinx } = foo in batz + zoinx\n\ncase foo of { Foo { batz = batz, zoinx = zoinx } -&gt; batz + zoinx }\n</code></pre>\n"}], "owner": {"reputation": 649, "user_id": 3034580, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/b79832c826b77bab56982225b17901df?s=128&d=identicon&r=PG", "display_name": "Joe", "link": "https://stackoverflow.com/users/3034580/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 58311055, "answer_count": 3, "score": 1, "last_activity_date": 1570649463, "creation_date": 1570492357, "question_id": 58278480, "link": "https://stackoverflow.com/questions/58278480/set-value-of-record-field-to-calculation-involving-another-field-in-same-record", "title": "Set value of record field to calculation involving another field in same record", "body": "<p>How to calculate a derived value based on another field in the same\nrecord, in this case the zoinx field? Obviously this doesn't compile and so it calls for a different design. How do you approach this?</p>\n\n<pre><code>  module Main where\n\n  data Foo = Foo\n    { batz  :: Double\n    , zoinx :: Double\n    } deriving (Show)\n\n\n  foo =\n    Foo \n      { batz = 1.0\n      , zoinx = batz * 2\n      }\n\n  main :: IO ()\n  main = do\n    print foo\n</code></pre>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1570484149, "post_id": 58277395, "comment_id": 102921217, "body": "I don&#39;t see any way you can. (You can rewrite the function in a number of ways but all involve specifying an argument to the function.) I&#39;m not sure why it&#39;s such a problem though, sure &quot;pointfree&quot; style is nice but there&#39;s no great loss here in making the last line <code>cycleNext x = succ x</code>"}, {"owner": {"reputation": 177, "user_id": 1602742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ca6c8bb38e6ada4fbb5a7cb417bbcbf?s=128&d=identicon&r=PG", "display_name": "Arkady Rost", "link": "https://stackoverflow.com/users/1602742/arkady-rost"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1570484546, "post_id": 58277395, "comment_id": 102921330, "body": "I&#39;m just trying to deal with HLint warn <code>Pattern match is redundant</code> that happens on <code>cycleNext x = succ x</code>"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 3, "creation_date": 1570484632, "post_id": 58277395, "comment_id": 102921355, "body": "@ArkadyRost: that is because <code>maxBound</code> is treated as a variable, not as the <code>maxBound</code> <i>value</i>."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1570485303, "post_id": 58277395, "comment_id": 102921565, "body": "@WillemVanOnsem oops, not sure how I didn&#39;t spot that..."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 5, "last_activity_date": 1570484469, "creation_date": 1570484469, "answer_id": 58277489, "question_id": 58277395, "link": "https://stackoverflow.com/questions/58277395/resolve-equations-for-cyclenext-have-different-numbers-of-arguments/58277489#58277489", "title": "Resolve &#39;Equations for \u2018cycleNext\u2019 have different numbers of arguments&#39;", "body": "<p>You can't, the number of parameters should be the same. Note that your <code>maxBound</code> will <em>not</em> work. Indeed, <code>maxBound</code> starts with a lowercase, and is thus treated as a variable (if you turn on warnings, it will warn that <code>maxBound</code> is shadowing an existing binding).</p>\n\n<p>You thus can implement this with:</p>\n\n<pre><code>cycleNext :: (Eq a, Enum a, Bounded a) =&gt; a -&gt; a\ncycleNext x | x == maxBound = minBound\n            | otherwise = succ x</code></pre>\n"}], "owner": {"reputation": 177, "user_id": 1602742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ca6c8bb38e6ada4fbb5a7cb417bbcbf?s=128&d=identicon&r=PG", "display_name": "Arkady Rost", "link": "https://stackoverflow.com/users/1602742/arkady-rost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "accepted_answer_id": 58277489, "answer_count": 1, "score": 1, "last_activity_date": 1570484534, "creation_date": 1570483854, "last_edit_date": 1570484534, "question_id": 58277395, "link": "https://stackoverflow.com/questions/58277395/resolve-equations-for-cyclenext-have-different-numbers-of-arguments", "title": "Resolve &#39;Equations for \u2018cycleNext\u2019 have different numbers of arguments&#39;", "body": "<p>Any ideas how to resolve the error <code>Equations for \u2018cycleNext\u2019 have different numbers of arguments</code> without adding redundant argument to the last line?</p>\n\n<pre><code>cycleNext :: (Eq a, Enum a, Bounded a) =&gt; a -&gt; a\ncycleNext maxBound = minBound\ncycleNext = succ\n</code></pre>\n"}, {"tags": ["haskell", "geometry", "coordinates"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1570482629, "post_id": 58277187, "comment_id": 102920716, "body": "Can you show what you tried, and what was not working?"}, {"owner": {"reputation": 85, "user_id": 11514521, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2OJcM4zNtUQ/AAAAAAAAAAI/AAAAAAAAB1c/h1tmB8tQFDs/photo.jpg?sz=128", "display_name": "Augusto Dias", "link": "https://stackoverflow.com/users/11514521/augusto-dias"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1570482907, "post_id": 58277187, "comment_id": 102920819, "body": "I didn&#39;t tried anything in Haskell yet, I just have a Kotlin sample."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1570483178, "post_id": 58277187, "comment_id": 102920915, "body": "Haskell has list comprehensions, and it has pairs. Give it a try, and when you actually run into a problem come back and ask about that problem."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 1, "last_activity_date": 1570483161, "creation_date": 1570483161, "answer_id": 58277287, "question_id": 58277187, "link": "https://stackoverflow.com/questions/58277187/generating-coordinates-of-a-n-sized-diamond-for-haskell/58277287#58277287", "title": "Generating Coordinates of a N-sized diamond for Haskell", "body": "<p>We can make an analysis of the items in the coordinate. If the center is at <code>(x,y)</code>, then we know that there is one symbol exactly <code>n</code> places above the center, and <code>3</code> symbols exactly <code>n-1</code> above the center. etc.</p>\n\n<p>We thus can use list comprehension here:</p>\n\n<pre><code>coordinates :: Integral i =&gt; i -&gt; i -&gt; i -&gt; [(i,i)]\ncoordinates x y n = [(x+dx, y+dy) | dy &lt;- [-n .. n], let ay = n - abs dy, dx &lt;- [-ay .. ay]]\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 11514521, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-2OJcM4zNtUQ/AAAAAAAAAAI/AAAAAAAAB1c/h1tmB8tQFDs/photo.jpg?sz=128", "display_name": "Augusto Dias", "link": "https://stackoverflow.com/users/11514521/augusto-dias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 58277287, "answer_count": 1, "score": 2, "last_activity_date": 1570505113, "creation_date": 1570482569, "last_edit_date": 1570505113, "question_id": 58277187, "link": "https://stackoverflow.com/questions/58277187/generating-coordinates-of-a-n-sized-diamond-for-haskell", "title": "Generating Coordinates of a N-sized diamond for Haskell", "body": "<p>So, I have to generate the coordinates to create a diamond on a grid.\nI will receive the <code>center (x, y)</code> and the height <code>n</code> from center to top, then I need to generate the coordinates <code>[(x, y),..]</code> to print something like this (<code>n = 4</code> and <code>center = (4, 4)</code>):</p>\n\n<pre><code>        #\n      # # #\n    # # # # #\n  # # # # # # #\n# # # # # # # # #\n  # # # # # # #\n    # # # # #\n      # # #\n        #\n</code></pre>\n\n<p>Where each # represents a position of the returned list. I don't have any clue about how to do this.</p>\n\n<p>This is how I do it in kotlin:</p>\n\n<pre><code>fun diamond(n: Int, coord: Coord): List&lt;Coord&gt; {\n  val coords = mutableSetOf&lt;Coord&gt;()\n  for (i in 0..n) {\n    for (j in 0..(n - i)) {\n      coords.add(Coord((coord.x + i).absoluteValue, (coord.y + j).absoluteValue))\n      coords.add(Coord((coord.x + i).absoluteValue, (coord.y - j).absoluteValue))\n      coords.add(Coord((coord.x - i).absoluteValue, (coord.y + j).absoluteValue))\n      coords.add(Coord((coord.x - i).absoluteValue, (coord.y - j).absoluteValue))\n    }\n  }\n  return coords.toList()\n}\n</code></pre>\n\n<p>P.S.: Printing is not a problem, I just need the coordinates.</p>\n"}, {"tags": ["haskell", "compiler-errors"], "answers": [{"tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": true, "score": 3, "last_activity_date": 1570477192, "creation_date": 1570477192, "answer_id": 58276125, "question_id": 58276032, "link": "https://stackoverflow.com/questions/58276032/trying-to-understand-types-in-haskell-library-fused-effects/58276125#58276125", "title": "Trying to understand types in haskell library fused-effects", "body": "<p>As you can see from the signature of <code>hmap</code>, it expects a function of type <code>forall x. m x -&gt; n x</code>. The <code>forall x</code> in there means that it needs to work <em>for all possible <code>x</code></em>, but your function only works for <code>Int</code>. It has the type <code>m Int -&gt; n Int</code> (where <code>m=Maybe</code> and <code>n=[]</code>), but <code>hmap</code> requires <code>m x -&gt; n x</code> for all possible <code>x</code>.</p>\n\n<p>In order to use <code>f</code> with <code>hmap</code>, you need to define it in a generic way, such that it works for any argument type, for example</p>\n\n<pre><code>f :: forall x. Maybe x -&gt; [] x\nf (Just x) = [x]\nf Nothing = []\n</code></pre>\n\n<p>(NOTE: <code>forall x.</code> is not necessary in this signature, but I included it to illustrate how <code>f</code> needs to match the first argument of <code>hmap</code>)</p>\n"}, {"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": false, "score": 3, "last_activity_date": 1570477201, "creation_date": 1570477201, "answer_id": 58276130, "question_id": 58276032, "link": "https://stackoverflow.com/questions/58276032/trying-to-understand-types-in-haskell-library-fused-effects/58276130#58276130", "title": "Trying to understand types in haskell library fused-effects", "body": "<p><code>hmap</code> has NOT this type</p>\n\n<pre><code>hmap :: Functor m =&gt; (m x -&gt; n x) -&gt; (h m a -&gt; h n a)\n</code></pre>\n\n<p>but has this type instead:</p>\n\n<pre><code>hmap :: Functor m =&gt; (forall x . m x -&gt; n x) -&gt; (h m a -&gt; h n a)\n</code></pre>\n\n<p>The difference is that, in the first (fake) type, you can choose the value of <code>x</code>. In the latter type, instead <code>x</code> is chosen by <code>hmap</code> (and not by you).</p>\n\n<p>In your code, you pass <code>f</code> to <code>hmap</code>, which amounts to choosing <code>x = Int</code>, but you are not allowed to do that. You need to define an <code>f</code> which is able to work with any <code>x</code>, e.g.</p>\n\n<pre><code>f :: Maybe x -&gt; [] x\nf mi = []\n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 9274783, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-pnYm-XfrwBQ/AAAAAAAAAAI/AAAAAAAAAP4/0wAUPrYQX_E/photo.jpg?sz=128", "display_name": "\u0391\u03c7\u03b9\u03bb\u03bb\u03ad\u03b1\u03c2 \u039c\u03c0\u03b1\u03bb\u03b1\u03ba\u03c4\u03c3\u03ae\u03c2", "link": "https://stackoverflow.com/users/9274783/%ce%91%cf%87%ce%b9%ce%bb%ce%bb%ce%ad%ce%b1%cf%82-%ce%9c%cf%80%ce%b1%ce%bb%ce%b1%ce%ba%cf%84%cf%83%ce%ae%cf%82"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 58276125, "answer_count": 2, "score": 2, "last_activity_date": 1570477201, "creation_date": 1570476796, "question_id": 58276032, "link": "https://stackoverflow.com/questions/58276032/trying-to-understand-types-in-haskell-library-fused-effects", "title": "Trying to understand types in haskell library fused-effects", "body": "<p>I am trying to understand hmap.</p>\n\n<pre><code>module Main where\n\nimport Control.Effect.Fresh\nimport Control.Effect.Carrier\n\na :: Fresh Maybe Int\na = Fresh (\\n -&gt; Just 5)\n\nb :: Fresh Maybe [Int]\nb = fmap (\\n -&gt; [7::Int]) a\n\nf :: Maybe Int -&gt; [] Int\nf mi = [1]\n\nc :: Fresh Maybe Int -&gt; Fresh [] Int\nc = hmap f\n\n\nmain :: IO ()\nmain = do\n  putStrLn \"Just testing types\"\n\n</code></pre>\n\n<p><strong>ghc error:</strong></p>\n\n<pre><code>\u2022 Couldn't match type \u2018x\u2019 with \u2018Int\u2019\n      \u2018x\u2019 is a rigid type variable bound by\n        a type expected by the context:\n          forall x. Maybe x -&gt; [x]\n        at src/Main.hs:16:5-10\n      Expected type: Maybe x -&gt; [x]\n        Actual type: Maybe Int -&gt; [Int]\n    \u2022 In the first argument of \u2018hmap\u2019, namely \u2018f\u2019\n      In the expression: hmap f\n      In an equation for \u2018c\u2019: c = hmap f\n   |\n16 | c = hmap f\n   |          ^\n</code></pre>\n\n<p>Why is there no match of x with Int?\nThe type signature of hmap is:</p>\n\n<pre><code>hmap :: Functor m =&gt; (forall x . m x -&gt; n x) -&gt; (h m a -&gt; h n a)\n</code></pre>\n\n<p>My f function is declared in my code as:</p>\n\n<pre><code>f :: Maybe Int -&gt; [] Int\nf mi = [1]\n</code></pre>\n\n<p>Why is there no match between <strong><code>m x -&gt; n x</code></strong> and <strong><code>Maybe Int -&gt; [] Int</code></strong></p>\n"}, {"tags": ["haskell", "liquid-haskell", "refinement-type"], "answers": [{"comments": [{"owner": {"reputation": 2025, "user_id": 1946002, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/rpIgZ.png?s=128&g=1", "display_name": "Nathan BeDell", "link": "https://stackoverflow.com/users/1946002/nathan-bedell"}, "edited": false, "score": 0, "creation_date": 1590256535, "post_id": 58847952, "comment_id": 109615276, "body": "Thank you for your in depth response!"}], "tags": [], "owner": {"reputation": 1152, "user_id": 729775, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/70ec20c66713dc2fe7ce050263961685?s=128&d=identicon&r=PG", "display_name": "Ranjit Jhala", "link": "https://stackoverflow.com/users/729775/ranjit-jhala"}, "is_accepted": true, "score": 0, "last_activity_date": 1573693799, "creation_date": 1573693799, "answer_id": 58847952, "question_id": 58275592, "link": "https://stackoverflow.com/questions/58275592/simple-liquidhaskell-example-fails-expected-behavior/58847952#58847952", "title": "Simple liquidhaskell example fails expected behavior", "body": "<p>sorry for the late reply! I should find some way to get notified about questions. Ok, there are two things going on, both of which we should fix!</p>\n\n<p>First, there is something glitchy happening with</p>\n\n<pre><code>{-@ measure p :: MaybePerson -&gt; Bool @-}                                                             \n</code></pre>\n\n<p>The right syntax is just</p>\n\n<pre><code>{-@ measure p @-}\np :: MaybePerson -&gt; Bool\n</code></pre>\n\n<p>But there was no error message, so there's no way for you to know!</p>\n\n<p>Second, when I change the above I still get some strange error about \n<code>GHC.Maybe</code> -- I can't recall the exact issue right now, will fix \non my laptop, but for illustration, I tweaked your code to:</p>\n\n<pre><code>{-@ LIQUID \"--exact-data-cons\" @-}\n\nimport Prelude hiding (Maybe (..))\n\ndata Maybe a = Just a | Nothing \n</code></pre>\n\n<p>To redefine <code>Maybe</code>. <em>This should not be needed will figure out a fix ASAP</em></p>\n\n<p>With this, your code works as is, e.g. see here</p>\n\n<p><a href=\"http://goto.ucsd.edu/liquid/index.html#?demo=permalink%2F1573693313_399.hs\" rel=\"nofollow noreferrer\">http://goto.ucsd.edu/liquid/index.html#?demo=permalink%2F1573693313_399.hs</a></p>\n\n<p>So you can now define</p>\n\n<pre><code>{-@ getPerson :: JustPerson -&gt; Person @-}                                               \ngetPerson (MaybePerson (Just name) (Just age)) = Person name age\n</code></pre>\n\n<p>and just remove the equation for the other cases. Further,</p>\n\n<pre><code>test1 = getPerson (MaybePerson Nothing Nothing)         -- error\n</code></pre>\n\n<p>yields a type error, but the below is safe</p>\n\n<pre><code>test2 = getPerson (MaybePerson (Just \"bob\") (Just 25))  -- ok\n</code></pre>\n\n<p>Thanks for pointing this out, will fix!</p>\n"}], "owner": {"reputation": 2025, "user_id": 1946002, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/rpIgZ.png?s=128&g=1", "display_name": "Nathan BeDell", "link": "https://stackoverflow.com/users/1946002/nathan-bedell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 58847952, "answer_count": 1, "score": 3, "last_activity_date": 1573693799, "creation_date": 1570474697, "question_id": 58275592, "link": "https://stackoverflow.com/questions/58275592/simple-liquidhaskell-example-fails-expected-behavior", "title": "Simple liquidhaskell example fails expected behavior", "body": "<p>I have recently started playing around with liquid haskell, and from all of the tutorials I could find, I could not find any examples like the following. </p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>data MaybePerson = MaybePerson {                                                                        \n  name' :: Maybe String,                                                                                \n  age'  :: Maybe Int                                                                                    \n}                                                                                                       \n\ndata Person = Person {                                                                                  \n  name :: String,                                                                                       \n  age  :: Int                                                                                           \n}                                                                                                       \n\n{-@ measure p :: MaybePerson -&gt; Bool @-}                                                                \np (MaybePerson (Just _) (Just _)) = True                                                                \np _ = False                                                                                             \n\n{-@ type JustPerson = {x:MaybePerson | p x} @-}                                                 \n\n-- Attempts to instantiate a maybe person into a concrete Person                                    \n{-@ getPerson :: JustPerson -&gt; Person @-}                                               \ngetPerson (MaybePerson (Just name) (Just age)) = Person name age                             \ngetPerson _ = undefined \n</code></pre>\n\n<p>If I try the following, my module does not type-check, as expected:</p>\n\n<pre><code>test = getPerson (MaybePerson Nothing Nothing) \n</code></pre>\n\n<p>However, for some reason, the following still does not type check:</p>\n\n<pre><code>test2 = getPerson (MaybePerson (Just \"bob\") (Just 25))\n</code></pre>\n\n<p>and I get the error</p>\n\n<pre><code>Error: Liquid Type Mismatch\n\n 36 | test2 = getPerson (MaybePerson (Just \"bob\") (Just 25))\n                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\n   Inferred type\n     VV : {v : MaybePerson | v == ?a}\n\n   not a subtype of Required type\n     VV : {VV : MaybePerson | Blank.p VV}\n\n   In Context\n     ?a : MaybePerson\n</code></pre>\n\n<p>Moreover, if I leave out the <code>getPerson _ = undefined</code> line, I get </p>\n\n<pre><code>Your function is not total: not all patterns are defined.\n</code></pre>\n\n<p>Even though clearly this function is total because of the precondition specified with liquidhaskell.</p>\n\n<p>What am I doing wrong here? I essentially just want to be able to reason with subtypes of a <code>Maybe a</code> type which are coming from the <code>Just</code> constructor, but I couldn't find any examples anywhere of where to do this properly.</p>\n"}, {"tags": ["shell", "haskell", "haskell-stack", "codecov"], "answers": [{"comments": [{"owner": {"reputation": 2352, "user_id": 4518180, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/HQeHB.png?s=128&g=1", "display_name": "mkUltra", "link": "https://stackoverflow.com/users/4518180/mkultra"}, "edited": false, "score": 0, "creation_date": 1570605385, "post_id": 58291147, "comment_id": 102960520, "body": "I have dropped him an email, asking about the current project status."}], "tags": [], "owner": {"reputation": 2352, "user_id": 4518180, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/HQeHB.png?s=128&g=1", "display_name": "mkUltra", "link": "https://stackoverflow.com/users/4518180/mkultra"}, "is_accepted": true, "score": 1, "last_activity_date": 1570555158, "creation_date": 1570555158, "answer_id": 58291147, "question_id": 58274683, "link": "https://stackoverflow.com/questions/58274683/stack-install-codecov-haskell-failed-with-error/58291147#58291147", "title": "stack install codecov-haskell failed with error", "body": "<p>There is a <a href=\"https://github.com/guillaume-nargeot/codecov-haskell/issues/13\" rel=\"nofollow noreferrer\">bug</a> and <a href=\"https://github.com/guillaume-nargeot/codecov-haskell/pull/14\" rel=\"nofollow noreferrer\">merge request</a> ready to be merged from Jul 26, 2017, for it.</p>\n\n<p>Looks like the author doesn't support this project anymore.</p>\n"}, {"tags": [], "owner": {"reputation": 6187, "user_id": 2834553, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/lRVAY.jpg?s=128&g=1", "display_name": "Kutyel", "link": "https://stackoverflow.com/users/2834553/kutyel"}, "is_accepted": false, "score": 1, "last_activity_date": 1571321697, "creation_date": 1571321697, "answer_id": 58434727, "question_id": 58274683, "link": "https://stackoverflow.com/questions/58274683/stack-install-codecov-haskell-failed-with-error/58434727#58434727", "title": "stack install codecov-haskell failed with error", "body": "<p>You can fix this by doing something like this in cabal and stack:</p>\n\n<pre><code>resolver: lts-13.25\nextra-deps:\n  - github: guillaume-nargeot/codecov-haskell\n    commit: 8448801f8d01624e4cd60420beb3fdc85c099576\npackages:\n  - .\n</code></pre>\n\n<p>You basically anchor a specific commit from github as your dependency that actually compiles!</p>\n"}], "owner": {"reputation": 2352, "user_id": 4518180, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/HQeHB.png?s=128&g=1", "display_name": "mkUltra", "link": "https://stackoverflow.com/users/4518180/mkultra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 58291147, "answer_count": 2, "score": 0, "last_activity_date": 1571321697, "creation_date": 1570470439, "question_id": 58274683, "link": "https://stackoverflow.com/questions/58274683/stack-install-codecov-haskell-failed-with-error", "title": "stack install codecov-haskell failed with error", "body": "<p>I am trying to install <a href=\"https://hackage.haskell.org/package/codecov-haskell\" rel=\"nofollow noreferrer\">codecov-haskell</a> via <a href=\"/questions/tagged/stack\" class=\"post-tag\" title=\"show questions tagged &#39;stack&#39;\" rel=\"tag\">stack</a> using <code>stack install codecov-haskell -v</code>, I've got the following error:</p>\n\n<pre><code>2019-10-07 19:31:22.039891: [info] codecov-haskell&gt; build\n2019-10-07 19:31:22.040092: [debug] Run process within /tmp/stack30689/codecov-haskell-0.5.0/: /home/mkultra/.stack/setup-exe-cache/x86_64-linux-tinfo6/Cabal-simple_mPHDZzAJ_2.4.0.1_ghc-8.6.5 --builddir=.stack-work/dist/x86_64-linux-tinfo6/Cabal-2.4.0.1 build --ghc-options \" -fdiagnostics-color=always\"\n2019-10-07 19:31:22.129625: [info] codecov-haskell&gt; Preprocessing library for codecov-haskell-0.5.0..\n2019-10-07 19:31:22.129758: [info] codecov-haskell&gt; Building library for codecov-haskell-0.5.0..\n2019-10-07 19:31:22.264569: [warn] codecov-haskell&gt; \n2019-10-07 19:31:22.264773: [warn] codecov-haskell&gt; &lt;no location info&gt;: warning: [-Wmissing-home-modules]\n2019-10-07 19:31:22.264869: [warn] codecov-haskell&gt;     These modules are needed for compilation but not listed in your .cabal file's other-modules: \n2019-10-07 19:31:22.264938: [warn] codecov-haskell&gt;         Paths_codecov_haskell\n2019-10-07 19:31:22.265078: [info] codecov-haskell&gt; [1 of 9] Compiling Paths_codecov_haskell\n2019-10-07 19:31:22.494452: [info] codecov-haskell&gt; [2 of 9] Compiling Trace.Hpc.Codecov.Config\n2019-10-07 19:31:22.534420: [info] codecov-haskell&gt; [3 of 9] Compiling Trace.Hpc.Codecov.Paths\n2019-10-07 19:31:22.714734: [info] codecov-haskell&gt; [4 of 9] Compiling CodecovHaskellCmdLine\n2019-10-07 19:31:24.097299: [info] codecov-haskell&gt; [5 of 9] Compiling Trace.Hpc.Codecov.Types\n2019-10-07 19:31:24.245865: [info] codecov-haskell&gt; [6 of 9] Compiling Trace.Hpc.Codecov.Curl\n2019-10-07 19:31:25.632324: [warn] codecov-haskell&gt; \n2019-10-07 19:31:25.632698: [warn] codecov-haskell&gt; /tmp/stack30689/codecov-haskell-0.5.0/src/Trace/Hpc/Codecov/Curl.hs:55:20: error:\n2019-10-07 19:31:25.632804: [warn] codecov-haskell&gt;     \u2022 Couldn't match type \u2018IO (Maybe a)\u2019\n2019-10-07 19:31:25.632879: [warn] codecov-haskell&gt;                      with \u2018RetryStatus -&gt; IO (Maybe a)\u2019\n2019-10-07 19:31:25.632955: [warn] codecov-haskell&gt;       Expected type: IO (Maybe a) -&gt; IO (Maybe a)\n2019-10-07 19:31:25.633025: [warn] codecov-haskell&gt;         Actual type: (RetryStatus -&gt; IO (Maybe a)) -&gt; IO (Maybe a)\n2019-10-07 19:31:25.633090: [warn] codecov-haskell&gt;     \u2022 In the expression: retrying expRetryPolicy isNothingM\n2019-10-07 19:31:25.633165: [warn] codecov-haskell&gt;       In an equation for \u2018performWithRetry\u2019:\n2019-10-07 19:31:25.633236: [warn] codecov-haskell&gt;           performWithRetry\n2019-10-07 19:31:25.633310: [warn] codecov-haskell&gt;             = retrying expRetryPolicy isNothingM\n2019-10-07 19:31:25.633382: [warn] codecov-haskell&gt;             where\n2019-10-07 19:31:25.633464: [warn] codecov-haskell&gt;                 isNothingM _ = return . isNothing\n2019-10-07 19:31:25.633537: [warn] codecov-haskell&gt;     \u2022 Relevant bindings include\n2019-10-07 19:31:25.633610: [warn] codecov-haskell&gt;         performWithRetry :: IO (Maybe a) -&gt; IO (Maybe a)\n2019-10-07 19:31:25.633685: [warn] codecov-haskell&gt;           (bound at src/Trace/Hpc/Codecov/Curl.hs:55:1)\n2019-10-07 19:31:25.633758: [warn] codecov-haskell&gt;    |\n2019-10-07 19:31:25.633831: [warn] codecov-haskell&gt; 55 | performWithRetry = retrying expRetryPolicy isNothingM\n2019-10-07 19:31:25.633905: [warn] codecov-haskell&gt;    |                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n2019-10-07 19:31:25.703733: [warn] codecov-haskell&gt; \n2019-10-07 19:31:25.703992: [info] Completed 2 action(s).\n2019-10-07 19:31:25.794909: [error] \n--  While building package codecov-haskell-0.5.0 using:\n      /home/mkultra/.stack/setup-exe-cache/x86_64-linux-tinfo6/Cabal-simple_mPHDZzAJ_2.4.0.1_ghc-8.6.5 --builddir=.stack-work/dist/x86_64-linux-tinfo6/Cabal-2.4.0.1 build --ghc-options \" -fdiagnostics-color=always\"\n    Process exited with code: ExitFailure 1\n</code></pre>\n\n<p>I had a similar error using <code>cabal install codecov-haskell</code> and the same error on CI using <code>stack install codecov-haskell</code>.\nPreviously I had a <a href=\"https://stackoverflow.com/questions/58259602/stack-install-curl-fails\">problem with curl</a> during codecov-haskell installation on my local machine. On CI didn't have any problem with it.</p>\n\n<p>Any suggestion?</p>\n\n<pre><code>Stack version: 2.1.3\nDescription:    Ubuntu 19.04\n</code></pre>\n"}, {"tags": ["haskell", "cabal"], "comments": [{"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 0, "creation_date": 1570463893, "post_id": 58272366, "comment_id": 102913038, "body": "Did you really mean <code>cabal exec bash</code> and not... ghci or something else?"}, {"owner": {"reputation": 548, "user_id": 1247325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f642860e89e481f4542a51c77152df43?s=128&d=identicon&r=PG", "display_name": "pbarill", "link": "https://stackoverflow.com/users/1247325/pbarill"}, "reply_to_user": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "edited": false, "score": 1, "creation_date": 1570465549, "post_id": 58272366, "comment_id": 102913858, "body": "In my limited understanding, once I do <code>cabal exec bash</code>, the stuff in the sandbox become available everywhere in that bash session, whether I subsequently call ghc or ghci. And in the case where I use <code>ihaskell</code>, it is neither ghc nor ghci, so what would I <code>exec</code> for that?"}], "answers": [{"comments": [{"owner": {"reputation": 548, "user_id": 1247325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f642860e89e481f4542a51c77152df43?s=128&d=identicon&r=PG", "display_name": "pbarill", "link": "https://stackoverflow.com/users/1247325/pbarill"}, "edited": false, "score": 0, "creation_date": 1570474569, "post_id": 58273908, "comment_id": 102917666, "body": "That&#39;s very interesting. So instead of nuking (repeatedly) the old cabal-sandbox, it seems I only deal with a simple file. Now I installed a couple of modules this way, and install was a success. Then I try to compile/interpret some programs, I get infinitely many <code>Could not load module ... It is a member of the hidden package</code>. Ok, so I need to manually add each and every module using the <code>cabal v2-install --lib</code> whenever I want to use it, even if it already is installed system-wide?? For the purpose of using Haskell to try stuff on one&#39;s system, that is nonsensical."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 548, "user_id": 1247325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f642860e89e481f4542a51c77152df43?s=128&d=identicon&r=PG", "display_name": "pbarill", "link": "https://stackoverflow.com/users/1247325/pbarill"}, "edited": false, "score": 0, "creation_date": 1570475320, "post_id": 58273908, "comment_id": 102917998, "body": "What workflow has you compiling or interpreting project that lack a build file?  If you repeatedly want things then use a <code>cabal.project</code> or <code>*.cabal</code> file.  If the project is small or even a toy then consider making a stand-alone <code>#!&#47;usr&#47;bin&#47;env cabal</code> script.  Worthy of a separate question if your workflow is still painful."}, {"owner": {"reputation": 548, "user_id": 1247325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f642860e89e481f4542a51c77152df43?s=128&d=identicon&r=PG", "display_name": "pbarill", "link": "https://stackoverflow.com/users/1247325/pbarill"}, "edited": false, "score": 0, "creation_date": 1570475681, "post_id": 58273908, "comment_id": 102918172, "body": "I was not aware that to be a seasoned software engineer is a necessary condition to use Haskell (I see that some people work very hard to make the language unusable to as many people as possible). I don&#39;t have a clue what is a &quot;stand-alone cabal script&quot; nor what it is intended to do."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "reply_to_user": {"reputation": 548, "user_id": 1247325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f642860e89e481f4542a51c77152df43?s=128&d=identicon&r=PG", "display_name": "pbarill", "link": "https://stackoverflow.com/users/1247325/pbarill"}, "edited": false, "score": 0, "creation_date": 1570476067, "post_id": 58273908, "comment_id": 102918345, "body": "@p_barill, that is a valid criticism. In my experience, it&#39;s actually possible to go <i>further</i> in Haskell than most other modern language environments without really understanding its build tools. But pretty soon, you really do need to learn the basics of <code>cabal</code> if you want to get things done without pulling your hair out. A side question to Thomas M. DuBuisson: is there an easy way to start a GHCi session on a particular module in a project? <code>cabal new-repl</code> seems to start in whatever module(s) it feels like."}, {"owner": {"reputation": 548, "user_id": 1247325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f642860e89e481f4542a51c77152df43?s=128&d=identicon&r=PG", "display_name": "pbarill", "link": "https://stackoverflow.com/users/1247325/pbarill"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1570476526, "post_id": 58273908, "comment_id": 102918544, "body": "@dfeuer What I&#39;m looking for is something similar to <code>virtualenv</code> in python. It&#39;s simple, it&#39;s lean and it&#39;s fast. And I believe it is documented, unlike Cabal where it&#39;s documentation is meaningless techno-babble. The old behavior of cabal was the closest to this I saw. Why there is no such simple tool in Haskell is beyond my understanding."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 548, "user_id": 1247325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f642860e89e481f4542a51c77152df43?s=128&d=identicon&r=PG", "display_name": "pbarill", "link": "https://stackoverflow.com/users/1247325/pbarill"}, "edited": false, "score": 0, "creation_date": 1570477102, "post_id": 58273908, "comment_id": 102918779, "body": "@p_barill I still am not clear what is needed, which is why I suggested a separate question.  You can use environments in Haskell much like virtualenv in Python (I think, I&#39;ve not used that much).  You install with a named environment then use that environment <code>cabal v2-install --package-env myenv --lib &lt;packages&gt; ; ghci -package-env myenv</code> and <code>import &lt;module&gt;</code>.  Feel free to ask a question on the cabal specifics and @ me as desired."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1570477251, "post_id": 58273908, "comment_id": 102918841, "body": "@dfeuer No, there is actually an underlying GHC issue one could hunt down that prevents all the modules from being loaded by default.  You do have to <code>cabal v2-repl [project]</code> and <code>import &lt;module&gt;</code>."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1570477787, "post_id": 58273908, "comment_id": 102919053, "body": "Having to import the needed module is annoying enough. Having to unload whatever it happened to pick for me is much more maddening."}, {"owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "reply_to_user": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1570477940, "post_id": 58273908, "comment_id": 102919117, "body": "@dfeuer It sounds like you want <code>cabal v2-exec ghci</code> which means cabal is passing the environment for the cabal project to ghci."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1570492937, "post_id": 58273908, "comment_id": 102923217, "body": "I&#39;ve had extremely mixed results with that, though I can&#39;t say off the top of my head what problems I&#39;ve encountered."}, {"owner": {"reputation": 5359, "user_id": 582917, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/98a347823cd1db90af884b227a29c29e?s=128&d=identicon&r=PG", "display_name": "CMCDragonkai", "link": "https://stackoverflow.com/users/582917/cmcdragonkai"}, "edited": false, "score": 0, "creation_date": 1576808244, "post_id": 58273908, "comment_id": 105025371, "body": "I used to use cabal v1 commands and the sandbox to cache the builds in CI/CD. This was located in <code>.cabal-sandbox</code>. Now with v2 commands, the cache is located somewhere else, where should I be caching the builds for my CI/CD for v2 commands?"}], "tags": [], "owner": {"reputation": 62421, "user_id": 216164, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/786f224adbe0784cdf7d0f15476061fe?s=128&d=identicon&r=PG", "display_name": "Thomas M. DuBuisson", "link": "https://stackoverflow.com/users/216164/thomas-m-dubuisson"}, "is_accepted": false, "score": 2, "last_activity_date": 1570466950, "creation_date": 1570466950, "answer_id": 58273908, "question_id": 58272366, "link": "https://stackoverflow.com/questions/58272366/haskell-cabal-v2-and-sandbox/58273908#58273908", "title": "Haskell Cabal v2 and Sandbox", "body": "<p>There are no sandboxes.  You can install packages and they end up in the user's cabal store using <code>v2-install</code> and <code>v2-install --lib</code>.  Let's use cabal to install a few packages:</p>\n\n<pre><code>cabal v2-udpate\ncabal v2-install --lib generic-trie containers\n</code></pre>\n\n<p>Now we can load modules from these packages in GHCi:</p>\n\n<pre><code>ghci\n&gt; import Data.GenericTrie\n&gt; import Data.Map\n</code></pre>\n\n<p>Why does this work?  Because the <code>cabal v2-install --lib</code> modifies the default environment GHCi looks at to load packages.  This file is found at <code>.ghc/x86_64-linux-8.6.5/environments/default</code>.</p>\n\n<p>You can delete the environment file any time to start mostly fresh.  This is handy if cabal is telling you some set of packages have conflicting dependencies with prior packages.  Think of it as a global store but as just pointers to the nix-style builds, so it's cheap to blow away and redo.</p>\n"}], "owner": {"reputation": 548, "user_id": 1247325, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f642860e89e481f4542a51c77152df43?s=128&d=identicon&r=PG", "display_name": "pbarill", "link": "https://stackoverflow.com/users/1247325/pbarill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 908, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1570466950, "creation_date": 1570460981, "question_id": 58272366, "link": "https://stackoverflow.com/questions/58272366/haskell-cabal-v2-and-sandbox", "title": "Haskell Cabal v2 and Sandbox", "body": "<p>We are told that this is now legacy mode of cabal, to manage a user-defined sandbox:</p>\n\n<pre><code>cabal init sandbox\ncabal install &lt;some stuff&gt;\n</code></pre>\n\n<p>Which is later loaded at your discretion using</p>\n\n<pre><code>cabal exec bash\n</code></pre>\n\n<p><strong>Question:</strong> How is an equivalent operation performed using the new implementation of Cabal?</p>\n\n<p>The documentation is (as it currently stands) very cryptic with zero usage example. That would be helpful to facilitate migration.</p>\n\n<p>Currently contemplating Cabal 2.4.0.0 with GHC 8.6.5.</p>\n"}, {"tags": ["arrays", "haskell", "optimization", "ghc"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1570459325, "post_id": 58271862, "comment_id": 102910611, "body": "You can make use of a <i>mutable array</i> (<a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/libraries/stm-2.5.0.0/Control-Concurrent-STM-TArray.html\" rel=\"nofollow noreferrer\">downloads.haskell.org/~ghc/latest/docs/html/libraries/&hellip;</a>) for example in an <code>STM</code> monad."}, {"owner": {"reputation": 99, "user_id": 10829064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5363cd15ef02e5f9dc90b3e5a011ca02?s=128&d=identicon&r=PG&f=1", "display_name": "Home3", "link": "https://stackoverflow.com/users/10829064/home3"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1570460727, "post_id": 58271862, "comment_id": 102911342, "body": "Is there a way that ghc optimizes the code automatically?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1570473257, "post_id": 58271862, "comment_id": 102917097, "body": "In ancient times, we had <code>Data.Array.Diff</code> which was a pure array implementation with O(1) access and update. The catch was that when you updated an array using <code>let new = old &#47;&#47; [(index,value)]</code> accessing <code>old</code> became slower. Essentially, after N updates, accessing the newest array costed O(1), while the oldest copy costed O(N). The implementation under the hood used mutation to redefine the older copies as the newest plus some &quot;difference&quot;, so to have a pure interface. This was removed from the libraries at some point. We now use mutable vectors, when needed."}], "answers": [{"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1570461561, "post_id": 58272287, "comment_id": 102911762, "body": "arguably, <a href=\"https://wiki.haskell.org/Prime_numbers#Accumulating_Array\" rel=\"nofollow noreferrer\">it should</a>. if the array is a loop variable, linearity is guaranteed."}], "tags": [], "owner": {"reputation": 24266, "user_id": 946226, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5823d09208b1e4b63bbfcd189492032c?s=128&d=identicon&r=PG", "display_name": "Joachim Breitner", "link": "https://stackoverflow.com/users/946226/joachim-breitner"}, "is_accepted": false, "score": 4, "last_activity_date": 1570460702, "creation_date": 1570460702, "answer_id": 58272287, "question_id": 58271862, "link": "https://stackoverflow.com/questions/58271862/inplace-array-modification-in-haskell/58272287#58272287", "title": "Inplace array modification in Haskell?", "body": "<p>No, the compiler does not detect \u201cmodification\u201d of pure data structures, turning them into an in-place modification. If you really need the performance characteristics of mutable arrays, you have to use them explicitly (as Willem mentions in the comment).</p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1570484389, "last_edit_date": 1570484389, "creation_date": 1570461598, "answer_id": 58272533, "question_id": 58271862, "link": "https://stackoverflow.com/questions/58271862/inplace-array-modification-in-haskell/58272533#58272533", "title": "Inplace array modification in Haskell?", "body": "<p>I'm not entirely sure that <em>O(log n)</em> is that slow. In fact <em>O(log n)</em> is frequently seen as \"fast\". Most database indexes use <a href=\"https://en.wikipedia.org/wiki/B-tree\" rel=\"nofollow noreferrer\"><em>B-tree</em>s [wiki]</a> or similar datastructures. Although most databases do not update the trees in a functional-like style, the time complexity to insert, retrieve, update, remove, etc. are <em>O(log n)</em> as well. Unless the amount of data really scales gigantic, <em>O(log n)</em>, is likely sufficient, given of course the algorithm is implemented reasonably well.</p>\n\n<p>A popular package that is shipped with most distributions is <a href=\"https://hackage.haskell.org/package/array/\" rel=\"nofollow noreferrer\"><strong><code>array</code></strong> [hackage]</a> that allows fast editing of arrays. It makes use of an <code>IO</code> or <code>ST</code> monad such that \"outside\" the container it is still pure, while under the hood it of course makes modifications to the array.</p>\n\n<p>The <a href=\"https://wiki.haskell.org/Arrays#Mutable_arrays_in_ST_monad_.28module_Data.Array.ST.29\" rel=\"nofollow noreferrer\">Haskell wiki</a> has an example on an <code>ST</code> array. Here we make :</p>\n\n<blockquote><pre><code>buildPair :: ST s (Integer, Integer)\nbuildPair = do\n    arr &lt;- newArray (1,10) 37 :: ST s (STArray s Int Integer)\n    a &lt;- readArray arr 1\n    writeArray arr 1 64\n    b &lt;- readArray arr 1\n    return (a,b)</code></pre></blockquote>\n\n<p>Here we thus first make an array with bounds <code>(1,10)</code> and we initialize all elements with <code>37</code>. Next we read the value on the first line, then we change it to 64, and then we read the value again.</p>\n\n<p>Note that the <code>ST s (Integer, Integer)</code> itself does <em>not</em> make modifications, you can see it as a recipe to obtain a 2-tuple <code>(Integer, Integer)</code>. If we then use <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Monad-ST.html#v:runST\" rel=\"nofollow noreferrer\"><code>runST :: (forall s . ST s a) -&gt; a</code></a> we will run the recipe and thus produce the result.</p>\n\n<p>For example:</p>\n\n<pre><code>Prelude Control.Monad Control.Monad.ST Data.Array.ST&gt; runST buildPair\n(37,64)\n</code></pre>\n"}], "owner": {"reputation": 99, "user_id": 10829064, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5363cd15ef02e5f9dc90b3e5a011ca02?s=128&d=identicon&r=PG&f=1", "display_name": "Home3", "link": "https://stackoverflow.com/users/10829064/home3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 210, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1570484389, "creation_date": 1570459205, "question_id": 58271862, "link": "https://stackoverflow.com/questions/58271862/inplace-array-modification-in-haskell", "title": "Inplace array modification in Haskell?", "body": "<p>We all know that modifying a member of a list in a functional style is pretty slow (O(n) for vector, O(log n) for trees), so is there an optimization in the ghc compiler which optimizes this operation to in-place modification? If so, what circumstances does it need? Does it work if the modification happens in a function, and the list you want to modify is one of its arguments?</p>\n"}, {"tags": ["list", "haskell", "functional-programming", "infinite", "enumerate"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1570457613, "post_id": 58271345, "comment_id": 102909690, "body": "<code>filter</code> will not result in an infinite loop, since it works in a lazy manner. It is only if you would evaluate the list entirely, that it of course will get stuck in an infinite loop."}, {"owner": {"reputation": 77, "user_id": 9846020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/047f8fe7686d13943599f64329e5a976?s=128&d=identicon&r=PG&f=1", "display_name": "T.Naz", "link": "https://stackoverflow.com/users/9846020/t-naz"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1570457790, "post_id": 58271345, "comment_id": 102909799, "body": "allStrings =  [ c : s | s &lt;- &quot;&quot; : allStrings, c &lt;- [&#39;R&#39;, &#39;T&#39;, &#39;P&#39;]]   that&#39;s my function that generates the list of strings. If I try the following code (which I assume is the same as filter) my ghci starts to hang.  allStrings =  [ x| x &lt;-[ c : s | s &lt;- &quot;&quot; : allStrings, c &lt;- [&#39;R&#39;, &#39;T&#39;, &#39;P&#39;]], length x == 4]"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1570457890, "post_id": 58271345, "comment_id": 102909850, "body": "@WillemVanOnsem wouldn&#39;t <code>print . filter (&gt;0) $ [0..]</code> &quot;evaluate the list entirely&quot;?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1570458008, "post_id": 58271345, "comment_id": 102909918, "body": "@T.Naz: that is because your <code>allStrings</code> will never emit something, because you say it should be length <code>4</code>, but in order to construct a list of length <code>4</code> here, you first need <code>allString</code>s to construct a list of length <code>3</code>, etc."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1570458057, "post_id": 58271345, "comment_id": 102909941, "body": "@WillNess: yes, since, as said before, <code>print</code> will entirely evaluate the list, and thus once you start <code>print</code>ing, you will never escape from that anymore so to speak."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1570458128, "post_id": 58271345, "comment_id": 102909988, "body": "@WillemVanOnsem I just think &quot;evaluate the list entirely&quot; can be confusing. I wouldn&#39;t refer to that process as &quot;stuck&quot;. &quot;stuck&quot; implies <i>non-productive</i> loops, like <code>sum . filter (&gt;0) $ [0..]</code>."}, {"owner": {"reputation": 77, "user_id": 9846020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/047f8fe7686d13943599f64329e5a976?s=128&d=identicon&r=PG&f=1", "display_name": "T.Naz", "link": "https://stackoverflow.com/users/9846020/t-naz"}, "edited": false, "score": 0, "creation_date": 1570458423, "post_id": 58271345, "comment_id": 102910133, "body": "Well if I change the &#39;==4&#39; to &#39;&lt;4&#39; , my ghci is still stuck. Could you recomend another way to extract the substrings of length 4?"}, {"owner": {"reputation": 77, "user_id": 9846020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/047f8fe7686d13943599f64329e5a976?s=128&d=identicon&r=PG&f=1", "display_name": "T.Naz", "link": "https://stackoverflow.com/users/9846020/t-naz"}, "edited": false, "score": 0, "creation_date": 1570458556, "post_id": 58271345, "comment_id": 102910202, "body": "The function fulfills its dut but it doesnt terminate"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 4, "last_activity_date": 1570458742, "creation_date": 1570458742, "answer_id": 58271718, "question_id": 58271345, "link": "https://stackoverflow.com/questions/58271345/getting-all-substrings-with-length-4-out-of-infinite-list/58271718#58271718", "title": "Getting all Substrings with length 4 out of infinite list", "body": "<p>The problem is that your filter makes it impossible to generate any solutions. In order to generate a string of length <code>4</code>, you first will need to generate a string of length <code>3</code>, since you each time prepend <em>one</em> character to it. In order to generate a list of length <code>3</code>, it thus will need to generate strings of length <code>2</code>, and so on, until the base case: an empty string.</p>\n\n<p>It is not the filter itself that is the main problem, the problem is that you filter in such a way that emitting values is now impossible.</p>\n\n<p>We can fix this by using a different list that will build strings, and filter that list like:</p>\n\n<pre><code>allStrings = filter ((==) 4 . length) vals\n    where vals = [x | x &lt;- [ c : s | s &lt;- \"\" : vals, c &lt;- \"RTP\"]]\n</code></pre>\n\n<p>This will emit all lists of length <code>4</code>, and then get stuck in an infinite loop, since <code>filter</code> will keep searching for more strings, and fail to find these.</p>\n\n<p>We can however do better, for example by using <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Monad.html#v:replicateM\" rel=\"nofollow noreferrer\"><strong><code>replicateM :: Monad m =&gt; Int -&gt; m a -&gt; m [a]</code></strong></a> here:</p>\n\n<pre><code>Prelude Control.Monad&gt; replicateM 4 \"RTP\"\n[\"RRRR\",\"RRRT\",\"RRRP\",\"RRTR\",\"RRTT\",\"RRTP\",\"RRPR\",\"RRPT\",\"RRPP\",\"RTRR\",\"RTRT\",\"RTRP\",\"RTTR\",\"RTTT\",\"RTTP\",\"RTPR\",\"RTPT\",\"RTPP\",\"RPRR\",\"RPRT\",\"RPRP\",\"RPTR\",\"RPTT\",\"RPTP\",\"RPPR\",\"RPPT\",\"RPPP\",\"TRRR\",\"TRRT\",\"TRRP\",\"TRTR\",\"TRTT\",\"TRTP\",\"TRPR\",\"TRPT\",\"TRPP\",\"TTRR\",\"TTRT\",\"TTRP\",\"TTTR\",\"TTTT\",\"TTTP\",\"TTPR\",\"TTPT\",\"TTPP\",\"TPRR\",\"TPRT\",\"TPRP\",\"TPTR\",\"TPTT\",\"TPTP\",\"TPPR\",\"TPPT\",\"TPPP\",\"PRRR\",\"PRRT\",\"PRRP\",\"PRTR\",\"PRTT\",\"PRTP\",\"PRPR\",\"PRPT\",\"PRPP\",\"PTRR\",\"PTRT\",\"PTRP\",\"PTTR\",\"PTTT\",\"PTTP\",\"PTPR\",\"PTPT\",\"PTPP\",\"PPRR\",\"PPRT\",\"PPRP\",\"PPTR\",\"PPTT\",\"PPTP\",\"PPPR\",\"PPPT\",\"PPPP\"]\n</code></pre>\n\n<p>Note that here the <em>last</em> character first changes when we generate the next string. I leave it as an exercise to obtain the reversed result.</p>\n"}, {"comments": [{"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1570459529, "post_id": 58271799, "comment_id": 102910729, "body": "<code>allStrings</code> here refers to your <i>first</i> definition. <i>Never</i> use same name to refer to different things. Always number them: <code>allStrings</code>, <code>allStrings2</code>, etc., so there&#39;s no confusion."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 1, "creation_date": 1570484732, "post_id": 58271799, "comment_id": 102921391, "body": "&quot;Never use same name to refer to different things&quot; is a bit of a difficult guideline to understand. We typically use <code>xs</code> to refer to many different things throughout the course of a program. I don&#39;t know exactly what you meant, so I can&#39;t suggest a good clarification for you."}, {"owner": {"reputation": 381, "user_id": 4779636, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XfZbZzafRNw/AAAAAAAAAAI/AAAAAAAADqc/jZKyixgEiK4/photo.jpg?sz=128", "display_name": "David Fox", "link": "https://stackoverflow.com/users/4779636/david-fox"}, "edited": false, "score": 0, "creation_date": 1570485821, "post_id": 58271799, "comment_id": 102921730, "body": "I think a better guideline is to avoid name shadowing unless you are very sure you want to do it.  The compiler will warn you about this if you enable <code>-Wall</code> or <code>-Wname-shadowing</code>."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "edited": false, "score": 0, "creation_date": 1570485934, "post_id": 58271799, "comment_id": 102921758, "body": "@amalloy  I meant &quot;in the same question&quot;, ultimately. or more broadly, during exploration &quot;interactive play&quot; at the GHCi prompt."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1570486752, "post_id": 58271799, "comment_id": 102921948, "body": "(I&#39;m very surprised it was unclear BTW. <i>obviously</i> the remark was made in context, I thought, the OP asks about two different definitions with the same name, which is confusing, etc. -- all mentioned in that same comment)"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 381, "user_id": 4779636, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XfZbZzafRNw/AAAAAAAAAAI/AAAAAAAADqc/jZKyixgEiK4/photo.jpg?sz=128", "display_name": "David Fox", "link": "https://stackoverflow.com/users/4779636/david-fox"}, "edited": false, "score": 0, "creation_date": 1570487584, "post_id": 58271799, "comment_id": 102922142, "body": "@DavidFox nothing wrong with intentional shadowing in finished code, obviously, it&#39;s just that we lose easy access to the previously defined entity, and lose the ability to easily distinguish between them in speech, while still in the interactive developing / exploring stage."}, {"owner": {"reputation": 381, "user_id": 4779636, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XfZbZzafRNw/AAAAAAAAAAI/AAAAAAAADqc/jZKyixgEiK4/photo.jpg?sz=128", "display_name": "David Fox", "link": "https://stackoverflow.com/users/4779636/david-fox"}, "edited": false, "score": 0, "creation_date": 1570554587, "post_id": 58271799, "comment_id": 102946400, "body": "@WillNess at various times in the past name shadowing has caused me trouble when one declaration of the symbol got removed or renamed, silently revealing the other one, thereby leading to mayhem."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 5, "last_activity_date": 1570460216, "last_edit_date": 1570460216, "creation_date": 1570459029, "answer_id": 58271799, "question_id": 58271345, "link": "https://stackoverflow.com/questions/58271345/getting-all-substrings-with-length-4-out-of-infinite-list/58271799#58271799", "title": "Getting all Substrings with length 4 out of infinite list", "body": "<p>This</p>\n\n<pre><code>allStrings4 = takeWhile ((== 4) . length) . \n                dropWhile ((&lt; 4) . length) $ allStrings\n</code></pre>\n\n<p>does the trick.</p>\n\n<p>It works because your (first) <code>allStrings</code> definition cleverly generates all strings containing <code>'R'</code>, <code>'T'</code>, and <code>'P'</code> letters  in <em>productive</em> manner, in the <em>non-decreasing length</em> order.</p>\n\n<p>Instead of trying to cram it all into <em>one</em> definition, <em>separate your concerns!</em> Build a solution to the more general problem first (this is your <code>allStrings</code> definition), then <em>use</em> it to solve the more restricted problem. This will often be much simpler, especially with the lazy evaluation of Haskell.</p>\n\n<p>We just need to take care that our streams are always productive, never <em>stuck</em>.</p>\n"}], "owner": {"reputation": 77, "user_id": 9846020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/047f8fe7686d13943599f64329e5a976?s=128&d=identicon&r=PG&f=1", "display_name": "T.Naz", "link": "https://stackoverflow.com/users/9846020/t-naz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 144, "favorite_count": 0, "accepted_answer_id": 58271799, "answer_count": 2, "score": 4, "last_activity_date": 1571685703, "creation_date": 1570457492, "last_edit_date": 1571685703, "question_id": 58271345, "link": "https://stackoverflow.com/questions/58271345/getting-all-substrings-with-length-4-out-of-infinite-list", "title": "Getting all Substrings with length 4 out of infinite list", "body": "<p>I'm quite new to Haskell and I'm trying to solve the following problem:</p>\n\n<p>I have a function, that produces an infinite list of strings with different lengths. But the number of strings of a certain length is restricted. </p>\n\n<p>Now I want to extract all substrings of the list with a certain length n . Unfortunately I did a lot of research and tried a lot of stuff, but nothing worked for me.</p>\n\n<p>I know that <code>filter()</code> won't work, as it checks every part of the lists and results in an infinite loop.</p>\n\n<p>This is my function that generates the infinite list:</p>\n\n<pre><code>allStrings =  [ c : s | s &lt;- \"\" : allStrings, c &lt;- ['R', 'T', 'P']]\n</code></pre>\n\n<p>I've already tried this:</p>\n\n<pre><code>allStrings = [x | x &lt;- [ c : s | s &lt;- \"\" : allStrings, \n                  c &lt;- ['R', 'T', 'P']], length x == 4] \n</code></pre>\n\n<p>which didn't terminate.</p>\n\n<p>Thanks for your help!</p>\n"}, {"tags": ["haskell", "monads", "maybe"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1570457550, "post_id": 58271326, "comment_id": 102909655, "body": "I think you do not need a <code>Maybe</code> here in the first place. A <code>Maybe</code> is usually used for non-total functions (so some input that is non-sensical for example)."}], "answers": [{"tags": [], "owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "is_accepted": false, "score": 6, "last_activity_date": 1570457879, "last_edit_date": 1570457879, "creation_date": 1570457861, "answer_id": 58271453, "question_id": 58271326, "link": "https://stackoverflow.com/questions/58271326/how-to-make-it-better-maybe-bool-doesnt-look-great/58271453#58271453", "title": "How to make it better? &quot;Maybe Bool&quot; doesn&#39;t look great", "body": "<p><code>isSpecialLine</code> never produces <code>Nothing</code>, so that\u2019s a good hint that <code>Maybe</code> might not make sense for it either.</p>\n\n<pre><code>isSpecialLine :: String -&gt; String -&gt; Bool\nisSpecialLine t s = ((\"[\" ++ t ++ \":\") `isPrefixOf` s) &amp;&amp; (\"]::\" `isSuffixOf` s)\n\ngetLinesWith :: String -&gt; String -&gt; [String]\ngetLinesWith t = filter (isSpecialLine t) . lines\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 193, "user_id": 9390914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a683dd069e2a770cb60dff1fdd5ac767?s=128&d=identicon&r=PG&f=1", "display_name": "Pantone877", "link": "https://stackoverflow.com/users/9390914/pantone877"}, "edited": false, "score": 0, "creation_date": 1570458041, "post_id": 58271459, "comment_id": 102909933, "body": "Sure, and it was a first version of <code>getLinesWith</code>. But I want to get <code>Maybe [String]</code>, not <code>[String]</code>. What to do in that case?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 193, "user_id": 9390914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a683dd069e2a770cb60dff1fdd5ac767?s=128&d=identicon&r=PG&f=1", "display_name": "Pantone877", "link": "https://stackoverflow.com/users/9390914/pantone877"}, "edited": false, "score": 1, "creation_date": 1570458617, "post_id": 58271459, "comment_id": 102910240, "body": "@Pnatone887: under what conditions would <code>getLinesWith</code> return <code>Nothing</code>?"}, {"owner": {"reputation": 193, "user_id": 9390914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a683dd069e2a770cb60dff1fdd5ac767?s=128&d=identicon&r=PG&f=1", "display_name": "Pantone877", "link": "https://stackoverflow.com/users/9390914/pantone877"}, "edited": false, "score": 0, "creation_date": 1570458897, "post_id": 58271459, "comment_id": 102910398, "body": "It should return <code>Nothing</code> if there is no lines that conform to the condition."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "reply_to_user": {"reputation": 193, "user_id": 9390914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a683dd069e2a770cb60dff1fdd5ac767?s=128&d=identicon&r=PG&f=1", "display_name": "Pantone877", "link": "https://stackoverflow.com/users/9390914/pantone877"}, "edited": false, "score": 5, "creation_date": 1570459393, "post_id": 58271459, "comment_id": 102910650, "body": "@Pantone877 What difference do you see between <code>Nothing</code> and <code>Just []</code>?"}, {"owner": {"reputation": 193, "user_id": 9390914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a683dd069e2a770cb60dff1fdd5ac767?s=128&d=identicon&r=PG&f=1", "display_name": "Pantone877", "link": "https://stackoverflow.com/users/9390914/pantone877"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1570467930, "post_id": 58271459, "comment_id": 102914931, "body": "@chepner eh, that&#39;s a question. Thanks!  I rewrote the function which get the result of <code>getLinesWith</code> and now it all looks much better."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 193, "user_id": 9390914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a683dd069e2a770cb60dff1fdd5ac767?s=128&d=identicon&r=PG&f=1", "display_name": "Pantone877", "link": "https://stackoverflow.com/users/9390914/pantone877"}, "edited": false, "score": 3, "creation_date": 1570468273, "post_id": 58271459, "comment_id": 102915061, "body": "@Pantone877: usually <code>Maybe</code> can be seen as a <code>1+</code> on type level: we construct <i>one</i> extra value. But usually it only makes sense to do that, well, if we need an extra value, to represent something that can not be represented with the <i>n</i> other values. I remember a talk by <i>Tom Schrijvers</i> about this, but somehow I&#39;m not able to find this immediately."}, {"owner": {"reputation": 193, "user_id": 9390914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a683dd069e2a770cb60dff1fdd5ac767?s=128&d=identicon&r=PG&f=1", "display_name": "Pantone877", "link": "https://stackoverflow.com/users/9390914/pantone877"}, "edited": false, "score": 0, "creation_date": 1570468787, "post_id": 58271459, "comment_id": 102915265, "body": "Thanks @Willem-Van-Onsem. Please take a look at the solution I&#39;ve provided; I wish I&#39;d written it before."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 4, "last_activity_date": 1570457867, "creation_date": 1570457867, "answer_id": 58271459, "question_id": 58271326, "link": "https://stackoverflow.com/questions/58271326/how-to-make-it-better-maybe-bool-doesnt-look-great/58271459#58271459", "title": "How to make it better? &quot;Maybe Bool&quot; doesn&#39;t look great", "body": "<p>It looks to me that you do not need a <code>filterM</code> here. You can make use of <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:filter\" rel=\"nofollow noreferrer\"><strong><code>filter :: (a -&gt; Bool) -&gt; [a] -&gt; [a]</code></strong></a> instead:</p>\n\n<pre><code>isSpecialLine :: String -&gt; String -&gt; Bool\nisSpecialLine t s = isPrefixOf (\"[\" ++ t ++ \":\") s && isSuffixOf \"]::\" s\n\ngetLinesWith :: String -&gt; String -&gt; [String]\ngetLinesWith t = <b>filter</b> (isSpecialLine t) . lines</code></pre>\n\n<p>Indeed, this will return a list of <code>String</code>s, where each string that matches the <code>isSpecialLine</code> filter will be retained.</p>\n"}, {"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1570471193, "post_id": 58274235, "comment_id": 102916155, "body": "If you use <code>date = getLinesWith t s ++ [&quot;01-01-1971&quot;]</code> (or whatever string would be processed down to <code>&quot;01-01-1971&quot;</code>), you can guarantee that <code>date</code> is a non-empty list, and <code>head</code> becomes safe to use."}, {"owner": {"reputation": 193, "user_id": 9390914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a683dd069e2a770cb60dff1fdd5ac767?s=128&d=identicon&r=PG&f=1", "display_name": "Pantone877", "link": "https://stackoverflow.com/users/9390914/pantone877"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1570472300, "post_id": 58274235, "comment_id": 102916669, "body": "Bravo, @chepner! That&#39;s even more elegant. I appreciate it very much!"}], "tags": [], "owner": {"reputation": 193, "user_id": 9390914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a683dd069e2a770cb60dff1fdd5ac767?s=128&d=identicon&r=PG&f=1", "display_name": "Pantone877", "link": "https://stackoverflow.com/users/9390914/pantone877"}, "is_accepted": false, "score": 1, "last_activity_date": 1570468375, "creation_date": 1570468375, "answer_id": 58274235, "question_id": 58271326, "link": "https://stackoverflow.com/questions/58271326/how-to-make-it-better-maybe-bool-doesnt-look-great/58274235#58274235", "title": "How to make it better? &quot;Maybe Bool&quot; doesn&#39;t look great", "body": "<p>Instead of using <code>Maybe</code> and unwrap data from <code>getLinesWith</code> like this,</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>getLinesWith :: String -&gt; String -&gt; Maybe [String]\n...\n\ngetDate :: String -&gt; String -&gt; UTCTime\ngetDate t s =\n    timeFromString\n    . filter (/= ' ')\n    . getBetweenColons\n    . maybe \":01-01-1971:\" head $ getLinesWith t s\n</code></pre>\n\n<p>I finished with much better looking (I hope so) solution without <code>Maybe</code>:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>getLinesWith :: String -&gt; String -&gt; [String]\n...\n\ngetDate :: String -&gt; String -&gt; UTCTime\ngetDate t s\n  | null date = timeFromString \"01-01-1971\"\n  | otherwise = timeFromString\n              . filter (/= ' ')\n              . getBetweenColons\n              . head $ date\n  where date = getLinesWith t s    \n</code></pre>\n\n<p>Actually, all the dancing around <code>Maybe</code> began when GHC complained about <code>head []</code>.\nThank you all for input!</p>\n"}], "owner": {"reputation": 193, "user_id": 9390914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a683dd069e2a770cb60dff1fdd5ac767?s=128&d=identicon&r=PG&f=1", "display_name": "Pantone877", "link": "https://stackoverflow.com/users/9390914/pantone877"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1570468375, "creation_date": 1570457429, "question_id": 58271326, "link": "https://stackoverflow.com/questions/58271326/how-to-make-it-better-maybe-bool-doesnt-look-great", "title": "How to make it better? &quot;Maybe Bool&quot; doesn&#39;t look great", "body": "<p>First of all, I'm a novice in Haskell, so if I'm asking somewhat silly question please tell me how can I do better. Thanks :)</p>\n\n<p>My task is to get a list of strings, conforming to specific condition. If no strings conform, I'd like to evaluate to <code>Nothing</code>. So I write two functions:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>isSpecialLine :: String -&gt; String -&gt; Maybe Bool\nisSpecialLine t s = Just $ ((\"[\" ++ t ++ \":\") `isPrefixOf` s) &amp;&amp; (\"]::\" `isSuffixOf` s)\n\ngetLinesWith :: String -&gt; String -&gt; Maybe [String]\ngetLinesWith t = filterM (isSpecialLine t) . lines\n</code></pre>\n\n<p>This code works, but I find that <code>Maybe Bool</code> looks a bit weird. Hey, it's binary! It's always <code>True</code> or <code>False</code>, so value of <code>isSpecialLine</code> will always be <code>Just True</code> or <code>Just False</code>. It can never be <code>Nothing</code> in my case!</p>\n\n<p>But if I change <code>isSpecialLine</code> output type to <code>Bool</code>, following problem appears: <code>filterM</code> expects <code>Maybe Bool</code> instead of <code>Bool</code>.</p>\n\n<p>Ok, so I do that:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>getLinesWith :: String -&gt; String -&gt; Maybe [String]\ngetLinesWith t = filterM (Just $ isSpecialLine t) . lines\n</code></pre>\n\n<p>Now compiler complains about unmatching type: <code>Maybe (String -&gt; Bool)</code> doesn't match expected <code>String -&gt; Maybe Bool</code>. Ok, pretty reasonable. So I:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>getLinesWith :: String -&gt; String -&gt; Maybe [String]\ngetLinesWith t = Just $ filter (isSpecialLine t) . lines\n</code></pre>\n\n<p>And again type mismatching, this time <code>Maybe (String -&gt; [String])</code> is not <code>String -&gt; Maybe [String]</code>. What's the correct syntax to wrap <code>[String]</code> to <code>Maybe</code> monad?</p>\n"}, {"tags": ["list", "haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1570456965, "post_id": 58271177, "comment_id": 102909322, "body": "Your signature suggests that this would be a <code>Point</code> as result, so something like <code>(4,6)</code>?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1570457132, "post_id": 58271177, "comment_id": 102909425, "body": "Furthermore what did you try? What is not working?"}, {"owner": {"reputation": 83, "user_id": 11745489, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xkC4qTgl6tE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfO76XHRX3OAdfGo26E-yHgT7WCoA/photo.jpg?sz=128", "display_name": "cLax", "link": "https://stackoverflow.com/users/11745489/clax"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1570457242, "post_id": 58271177, "comment_id": 102909486, "body": "I am just having a hard time trying to understand how to work with this because I know to work with a list you use (x:xs), but I do not understand how to work with this list."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1570457278, "post_id": 58271177, "comment_id": 102909504, "body": "not per se, you can use functions like <code>map</code>, <code>foldr</code>, etc. as well."}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1570459952, "creation_date": 1570459952, "answer_id": 58272078, "question_id": 58271177, "link": "https://stackoverflow.com/questions/58271177/adding-a-list-of-points-together/58272078#58272078", "title": "Adding a list of points together", "body": "<p>Probably the easiest way to do this, is by first making a function that can extract the <em>x</em>-coordinate of a point. For example with <code>xPt</code>:</p>\n\n<pre><code>xPt :: Point -&gt; Double\nxPt (Pt x _) = x</code></pre>\n\n<p>then we can make use of <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:sum\" rel=\"nofollow noreferrer\"><strong><code>sum :: (Foldable f, Num a) =&gt; f a -&gt; a</code></strong></a> and <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:map\" rel=\"nofollow noreferrer\"><strong><code>map :: (a -&gt; b) -&gt; [a] -&gt; [b]</code></strong></a> to map a list of points to a list of <em>x</em>-coordinates:</p>\n\n<pre><code>xSum :: [Point] -&gt; Double\nxSum = <b>sum</b> . <b>map</b> xPt</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1570590545, "creation_date": 1570590545, "answer_id": 58296525, "question_id": 58271177, "link": "https://stackoverflow.com/questions/58271177/adding-a-list-of-points-together/58296525#58296525", "title": "Adding a list of points together", "body": "<p>You can use a list comprehension for this:</p>\n\n<pre><code>xSum :: [Point] -&gt; Double\nxSum pts = sum [x | Pt x _ &lt;- pts]\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 11745489, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xkC4qTgl6tE/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfO76XHRX3OAdfGo26E-yHgT7WCoA/photo.jpg?sz=128", "display_name": "cLax", "link": "https://stackoverflow.com/users/11745489/clax"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 0, "accepted_answer_id": 58272078, "answer_count": 2, "score": 1, "last_activity_date": 1570590545, "creation_date": 1570456887, "last_edit_date": 1570460446, "question_id": 58271177, "link": "https://stackoverflow.com/questions/58271177/adding-a-list-of-points-together", "title": "Adding a list of points together", "body": "<p>How do I  add all of the  <code>x</code> coordinates together in a list of points type <code>Pt</code>?</p>\n\n<p>Example:</p>\n\n<pre><code> [Pt 1 2, Pt 3 4]  =&gt;  1 + 3  =&gt;  4\n</code></pre>\n\n<p>Here is the data-type and function declaration that I am using:</p>\n\n<pre><code>data Point = Pt Double Double\n\nx :: [Point] -&gt; Point\n</code></pre>\n\n<p>This is what I have tried.</p>\n\n<pre><code>x :: [Point] -&gt; Point\nx  [Pt x y] = Pt(x+x)\n</code></pre>\n"}, {"tags": ["list", "haskell", "boolean", "tuples"], "comments": [{"owner": {"reputation": 133611, "user_id": 152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f370b4bd787fc68f9f62d9c6781cb79?s=128&d=identicon&r=PG", "display_name": "Lee", "link": "https://stackoverflow.com/users/152602/lee"}, "edited": false, "score": 8, "creation_date": 1570449473, "post_id": 58269061, "comment_id": 102905230, "body": "<code>null [1] == []</code> is a type error."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1570460738, "post_id": 58269061, "comment_id": 102911348, "body": "yes, <code>let { xs = tail [(undefined,undefined)] } in null xs</code>."}], "answers": [{"tags": [], "owner": {"reputation": 488, "user_id": 3265362, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXfiq.jpg?s=128&g=1", "display_name": "nader.h", "link": "https://stackoverflow.com/users/3265362/nader-h"}, "is_accepted": false, "score": 2, "last_activity_date": 1570449638, "creation_date": 1570449638, "answer_id": 58269163, "question_id": 58269061, "link": "https://stackoverflow.com/questions/58269061/compare-a-null-list-with-a-b-haskell/58269163#58269163", "title": "Compare a null list with [(a,b)] Haskell", "body": "<p>i would declare my list like below : </p>\n\n<pre><code>let myList = [] :: [(Integer, Integer)]\n</code></pre>\n\n<p>then <code>myList</code> will have the type <code>:t myList</code> will yield <code>myList :: [(Integer, Integer)]</code></p>\n\n<p>When evaluating <code>null myList</code> it yields <code>True</code></p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 5, "last_activity_date": 1570449662, "creation_date": 1570449662, "answer_id": 58269171, "question_id": 58269061, "link": "https://stackoverflow.com/questions/58269061/compare-a-null-list-with-a-b-haskell/58269171#58269171", "title": "Compare a null list with [(a,b)] Haskell", "body": "<blockquote>\n  <p>Is there a way to define an empty list with type <code>[(a,b)]</code>?</p>\n</blockquote>\n\n<p>Simply <strong><code>[]</code></strong>. Indeed <code>[]</code> is an empty list, but the type of elements is free. It has type <code>[a]</code>, but <code>a</code> can be the same as <code>(b, c)</code> so a 2-tuple with two different types.</p>\n\n<blockquote>\n  <p>For example I know that <code>null [1] == []</code> will give us <code>True</code></p>\n</blockquote>\n\n<p><a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:null\" rel=\"noreferrer\"><strong><code>null :: Foldable f =&gt; f a -&gt; Bool</code></strong></a> is a function that takes an <code>f a</code> (in this case an <code>[a]</code>), and <em>returns a <code>Bool</code></em>. It <em>checks</em> if a list is empty. It does <em>not</em> generate a list.</p>\n"}, {"tags": [], "owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "is_accepted": true, "score": 7, "last_activity_date": 1570453373, "last_edit_date": 1570453373, "creation_date": 1570449933, "answer_id": 58269234, "question_id": 58269061, "link": "https://stackoverflow.com/questions/58269061/compare-a-null-list-with-a-b-haskell/58269234#58269234", "title": "Compare a null list with [(a,b)] Haskell", "body": "<blockquote>\n  <p>I know that <code>[]</code> is an empty list with type <code>[a]</code></p>\n</blockquote>\n\n<p>Yes, but it's important to understand what \u201ctype <code>[a]</code>\u201d actually means. Really it means type <code>forall a . [a]</code>, i.e. this is not a list of elements of some particular type \u201ca\u201d but rather, <em>given any choice of type <code>a</code></em>, it is a list of that type. In particular, it can also be a list of tuple type. Thus, <code>null</code> works just as fine with lists of tuples as with lists of any other type.</p>\n\n<p>To actually see <code>null</code> in action on such a tuple list, you just need to supply one. For instance, <code>null [(1,2)]</code> uses it for a tuple-list. But in case of the empty list, there's no content of the list with which you would constrain the type. It may either be clear from the context, as in</p>\n\n<pre><code>Prelude&gt; [null l | l &lt;- [ [], [(1,2)], [(1,3)] ]]\n[True,False,False]\n</code></pre>\n\n<p>or you may explicitly specify it with a signature</p>\n\n<pre><code>Prelude&gt; null ([] :: [(String, Double)])\nTrue\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 381, "user_id": 4779636, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-XfZbZzafRNw/AAAAAAAAAAI/AAAAAAAADqc/jZKyixgEiK4/photo.jpg?sz=128", "display_name": "David Fox", "link": "https://stackoverflow.com/users/4779636/david-fox"}, "is_accepted": false, "score": 0, "last_activity_date": 1570486288, "creation_date": 1570486288, "answer_id": 58277784, "question_id": 58269061, "link": "https://stackoverflow.com/questions/58269061/compare-a-null-list-with-a-b-haskell/58277784#58277784", "title": "Compare a null list with [(a,b)] Haskell", "body": "<p>Every type of list is represented as <code>[]</code>.  If you want to specify the type you can use a signature (<code>[] :: [(a, b)]</code>), but often the compiler can infer the type from context:</p>\n\n<pre><code>\u03bb&gt; [] == [(1, 'x')]\nFalse\n</code></pre>\n"}], "owner": {"reputation": 157, "user_id": 5608517, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9eed034d912be0a2c2ef78e9b37500d2?s=128&d=identicon&r=PG&f=1", "display_name": "Noopty", "link": "https://stackoverflow.com/users/5608517/noopty"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 58269234, "answer_count": 4, "score": 2, "last_activity_date": 1570486288, "creation_date": 1570449253, "question_id": 58269061, "link": "https://stackoverflow.com/questions/58269061/compare-a-null-list-with-a-b-haskell", "title": "Compare a null list with [(a,b)] Haskell", "body": "<p>I am a bit confused on how the lists in Haskell works.\nI know that <code>[]</code> is an empty list with type [a].Is there a way to define an empty list with type [(a,b)]?</p>\n\n<p>For example I know that <code>null [1] == []</code> will give us <code>True</code></p>\n\n<p><code>null [(1,2)] == []</code> gave me the mismatched type error that's what I am assuming.</p>\n\n<p>I want to know if it is possible to say something like <code>null [(1,2)] == [(,)]</code> will give us <code>True</code></p>\n"}, {"tags": ["haskell", "recursion", "tree", "map-function"], "comments": [{"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 2, "creation_date": 1570445631, "post_id": 58268054, "comment_id": 102903381, "body": "Hint: What should happen to the value at the top of the rose tree, and what should happen to each of the sub-trees?"}, {"owner": {"reputation": 215, "user_id": 12036912, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Bs1MMku7W04/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcRX-T31D-fLdCF5w6i9pacNreJ9w/photo.jpg?sz=128", "display_name": "Jayyyyyy", "link": "https://stackoverflow.com/users/12036912/jayyyyyy"}, "reply_to_user": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1570445954, "post_id": 58268054, "comment_id": 102903534, "body": "It should change the element in the top of the rose tree at the first, and then apply the same function to the rest of elements but I don&#39;t know how to translate this into function."}], "answers": [{"comments": [{"owner": {"reputation": 215, "user_id": 12036912, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Bs1MMku7W04/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcRX-T31D-fLdCF5w6i9pacNreJ9w/photo.jpg?sz=128", "display_name": "Jayyyyyy", "link": "https://stackoverflow.com/users/12036912/jayyyyyy"}, "edited": false, "score": 0, "creation_date": 1570447550, "post_id": 58268271, "comment_id": 102904314, "body": "Thank you for you answer. I still have a question. The recursion of haskell is difficult to imagine, I mean I cannot imagine  the implementation process of the recursion. So writing a correct recursion expression is hard. Can I expand the execution of function on paper, or something like that to make me better understand recursion."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1570454489, "post_id": 58268271, "comment_id": 102907833, "body": "Recursion in Haskell works no differently from recursion in any other language. It&#39;s just a lot more common in Haskell (and functional languages in general), both because it&#39;s often the only way to accomplish things that you&#39;d use loops for in an imperative language, and because it&#39;s much more efficient in Haskell than in imperative languages. (I couldn&#39;t give you a detailed explanation as to why, but laziness is a big part of it.)"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1570454745, "post_id": 58268271, "comment_id": 102907995, "body": "As for how the recursion works in this specific case: a rosetree consists of a label of type <code>a</code>, and a list of other (sub)trees. Applying <code>roseMap f</code> to such a tree simply replaces the <code>a</code> with <code>f a</code>, and each subtree <code>sub</code> with <code>roseMap f sub</code>. The recursion eventually ends (at least in practice, it doesn&#39;t have to in theory) when the list of subtrees is empty. If you try working through this with your example tree, or simpler ones, I&#39;m confident you&#39;ll soon understand how it works."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 4, "last_activity_date": 1570446131, "creation_date": 1570446131, "answer_id": 58268271, "question_id": 58268054, "link": "https://stackoverflow.com/questions/58268054/how-to-apply-a-function-to-all-elements-of-a-tree/58268271#58268271", "title": "How to apply a function to all elements of a tree?", "body": "<p>You <em>are</em> already using recursion. Indeed, you use <code>roseMap f</code> in terms of itself:</p>\n\n<pre><code>roseMap :: (a -&gt; b) -&gt; RoseTree a -&gt; RoseTree b\n<b>roseMap f</b>  rtree = case rtree of\n    RoseNode a [] -> allCaps a\n    RoseNode a sub -> Rose (allCaps a) (map (<b>roseMap f</b> sub))</code></pre>\n\n<p>But the above will not work for several reasons:</p>\n\n<ol>\n<li>you do not make use of <code>f</code> here. Indeed you write <code>Rose (allCaps a)</code>, so you do not use <code>f</code> to map the elements;</li>\n<li>the <code>sub</code> should <em>not</em> be passed in the brackets of <code>roseMap f</code>;</li>\n<li>you should use <code>RoseNode</code> instead of <code>Rose</code>; and</li>\n<li>your first case, you return <code>allCaps a</code>, instead of <code>RoseNode (allCaps a) []</code>.</li>\n</ol>\n\n<p>Making a distinction between a node with no children, or with children, is not necessary anway. We can define the mapping as:</p>\n\n<pre><code>roseMap :: (a -&gt; b) -&gt; RoseTree a -&gt; RoseTree b\nroseMap f (RoseNode a xs) = RoseNode (f a) (map (roseMap f) xs)</code></pre>\n\n<p>So here we use <code>f a</code> instead, and we perform a mapping on the children.</p>\n\n<p>If we then perform a <code>roseMap</code> with <code>allCaps</code> as function, we get:</p>\n\n<pre><code>Prelude Data.Char&gt; roseMap allCaps things\nRoseNode \"THING\" [RoseNode \"ANIMAL\" [RoseNode \"CAT\" [],RoseNode \"DOG\" []],RoseNode \"METAL\" [RoseNode \"ALLOY\" [RoseNode \"STEEL\" [],RoseNode \"BRONZE\" []],RoseNode \"ELEMENT\" [RoseNode \"GOLD\" [],RoseNode \"TIN\" [],RoseNode \"IRON\" []]],RoseNode \"FRUIT\" [RoseNode \"APPLE\" [RoseNode \"GRANNY SMITH\" [],RoseNode \"PINK LADY\" []],RoseNode \"BANANA\" [],RoseNode \"ORANGE\" []],RoseNode \"ASTRONOMICAL OBJECT\" [RoseNode \"PLANET\" [RoseNode \"EARTH\" [],RoseNode \"MARS\" []],RoseNode \"STAR\" [RoseNode \"THE SUN\" [],RoseNode \"SIRIUS\" []],RoseNode \"GALAXY\" [RoseNode \"MILKY WAY\" []]]]\n</code></pre>\n\n<p>We do not need to implement the mapping ourself, we can enable the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#extension-DeriveFunctor\" rel=\"nofollow noreferrer\"><strong><code>DeriveFunctor</code></strong> extension [ghc-doc]</a>, and let Haskell do the work for us:</p>\n\n<pre><code>{-# LANGUAGE <b>DeriveFunctor</b> #-}\n\ndata RoseTree a = RoseNode a [RoseTree a] deriving (<b>Functor</b>, Show)</code></pre>\n\n<p>the we can call this with <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:fmap\" rel=\"nofollow noreferrer\"><strong><code>fmap :: Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b</code></strong></a>:</p>\n\n<pre><code>Prelude Data.Char&gt; fmap (map toUpper) things\nRoseNode \"THING\" [RoseNode \"ANIMAL\" [RoseNode \"CAT\" [],RoseNode \"DOG\" []],RoseNode \"METAL\" [RoseNode \"ALLOY\" [RoseNode \"STEEL\" [],RoseNode \"BRONZE\" []],RoseNode \"ELEMENT\" [RoseNode \"GOLD\" [],RoseNode \"TIN\" [],RoseNode \"IRON\" []]],RoseNode \"FRUIT\" [RoseNode \"APPLE\" [RoseNode \"GRANNY SMITH\" [],RoseNode \"PINK LADY\" []],RoseNode \"BANANA\" [],RoseNode \"ORANGE\" []],RoseNode \"ASTRONOMICAL OBJECT\" [RoseNode \"PLANET\" [RoseNode \"EARTH\" [],RoseNode \"MARS\" []],RoseNode \"STAR\" [RoseNode \"THE SUN\" [],RoseNode \"SIRIUS\" []],RoseNode \"GALAXY\" [RoseNode \"MILKY WAY\" []]]]\n</code></pre>\n"}], "owner": {"reputation": 215, "user_id": 12036912, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Bs1MMku7W04/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcRX-T31D-fLdCF5w6i9pacNreJ9w/photo.jpg?sz=128", "display_name": "Jayyyyyy", "link": "https://stackoverflow.com/users/12036912/jayyyyyy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 488, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1570464614, "creation_date": 1570445357, "last_edit_date": 1570464614, "question_id": 58268054, "link": "https://stackoverflow.com/questions/58268054/how-to-apply-a-function-to-all-elements-of-a-tree", "title": "How to apply a function to all elements of a tree?", "body": "<pre><code>data RoseTree a = RoseNode a [RoseTree a] deriving Show\n\nthings :: RoseTree String\nthings = \n    RoseNode \"thing\" [\n        RoseNode \"animal\" [\n            RoseNode \"cat\" [], RoseNode \"dog\" []\n        ],\n\n        RoseNode \"metal\" [\n            RoseNode \"alloy\" [\n                RoseNode \"steel\" [], RoseNode \"bronze\" []\n            ],\n            RoseNode \"element\" [\n                RoseNode \"gold\" [], RoseNode \"tin\" [], RoseNode \"iron\" []\n            ]\n        ],       \n    ] \n-- Turns string into all upper case\nallCaps :: String -&gt; String\nallCaps x = map toUpper x\n-- This function uses allCaps as a helper function \n--  to turn the elements in tree into upper case\nroseMap :: (a -&gt; b) -&gt; RoseTree a -&gt; RoseTree b\nroseMap  f  rtree = case rtree of\n    RoseNode a []    -&gt;  allCaps a\n    RoseNode a sub   -&gt;  Rose (allCaps a) (map (roseMap f sub)\n</code></pre>\n\n<p>that takes a function, and applies it to every element of a rosetree. Test the result by mapping the function <code>allCaps</code> to the rosetree <code>things</code>. All the elements should now be written in uppercase.</p>\n\n<p>I have no idea about how to use recursion to write this function.</p>\n"}, {"tags": ["haskell", "containers", "gadt", "data-kinds"], "comments": [{"owner": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 2, "creation_date": 1570433950, "post_id": 58265110, "comment_id": 102898179, "body": "It&#39;s a list, but that&#39;s kind of orthogonal to being able to write a <code>Storable</code> instance."}, {"owner": {"reputation": 1889, "user_id": 4540658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/9vCJz.jpg?s=128&g=1", "display_name": "Dannyu NDos", "link": "https://stackoverflow.com/users/4540658/dannyu-ndos"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1570435940, "post_id": 58265110, "comment_id": 102899004, "body": "@leftaroundabout I&#39;d like to see why. (As an answer)"}, {"owner": {"reputation": 1889, "user_id": 4540658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/9vCJz.jpg?s=128&g=1", "display_name": "Dannyu NDos", "link": "https://stackoverflow.com/users/4540658/dannyu-ndos"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1570436273, "post_id": 58265110, "comment_id": 102899133, "body": "@leftaroundabout To be specific, I don&#39;t know how Haskell knows this is &quot;orthogonal&quot;."}, {"owner": {"reputation": 1889, "user_id": 4540658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/9vCJz.jpg?s=128&g=1", "display_name": "Dannyu NDos", "link": "https://stackoverflow.com/users/4540658/dannyu-ndos"}, "reply_to_user": {"reputation": 100892, "user_id": 745903, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/50933f6638836741e620669b3940410e?s=128&d=identicon&r=PG", "display_name": "leftaroundabout", "link": "https://stackoverflow.com/users/745903/leftaroundabout"}, "edited": false, "score": 0, "creation_date": 1570436584, "post_id": 58265110, "comment_id": 102899239, "body": "@leftaroundabout Also, if this is a list, wouldn&#39;t that mean the elements will stored in noncontinuous addresses (just like C++&#39;s <code>std::list</code>)?"}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 2, "creation_date": 1570437589, "post_id": 58265110, "comment_id": 102899631, "body": "@DannyuNDos The distinction between \u2018lists\u2019 and \u2018arrays\u2019 is not as important in Haskell as it is in C++, since the location in which data is stored is of importance in C (and C++) but not in Haskell. In Haskell, \u2018true\u2019 arrays (stored continuously) are very rare; they can be found in the <code>array</code> and <code>vector</code> libraries, but are not generally used unless performance becomes important. The normal Haskell type <code>[]</code> is a linked list; most other containers are implemented internally as some form of tree. In this case, you are implementing <code>Symmetric</code> as a linked list."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 1, "creation_date": 1570437632, "post_id": 58265110, "comment_id": 102899649, "body": "@DannyuNDos And as for the \u2018orthogonal\u2019 comment, leftaroundabout is simply saying that whether or not it is a list is of no relevance to the issue of writing a <code>Storable</code> instance."}, {"owner": {"reputation": 1889, "user_id": 4540658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/9vCJz.jpg?s=128&g=1", "display_name": "Dannyu NDos", "link": "https://stackoverflow.com/users/4540658/dannyu-ndos"}, "reply_to_user": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1570437926, "post_id": 58265110, "comment_id": 102899768, "body": "@bradrn It&#39;s confusing. I thought <code>[]</code> isn&#39;t <code>Storable</code> because it has unbounded size."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1570438153, "post_id": 58265110, "comment_id": 102899854, "body": "@DannyuNDos I don\u2019t know much about <code>Storable</code>, but some cursory research seems to confirm what you say. In particular, a <code>Storable</code> type seems to require a <i>fixed</i> size, so e.g. <code>Int8</code>, <code>Int16</code>, \u2026 are <code>Storable</code>, but <code>Integer</code> isn\u2019t."}, {"owner": {"reputation": 789, "user_id": 8120642, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-OX8-_3nAbeE/AAAAAAAAAAI/AAAAAAAAAAA/of7PUZBmbk4/photo.jpg?sz=128", "display_name": "hegel5000", "link": "https://stackoverflow.com/users/8120642/hegel5000"}, "reply_to_user": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 0, "creation_date": 1570468718, "post_id": 58265110, "comment_id": 102915238, "body": "@bradrn It&#39;s funny because in proper, idiomatic C++, the difference between lists and arrays isn&#39;t any more important than it is in Haskell.  It&#39;s just that everybody tries to program C++ like it&#39;s C :\\"}], "answers": [{"comments": [{"owner": {"reputation": 1889, "user_id": 4540658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/9vCJz.jpg?s=128&g=1", "display_name": "Dannyu NDos", "link": "https://stackoverflow.com/users/4540658/dannyu-ndos"}, "edited": false, "score": 0, "creation_date": 1570493018, "post_id": 58273773, "comment_id": 102923232, "body": "Is it irrelevent that <code>Cyclic n</code> has <code>Integer</code>, an unbounded size?"}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "reply_to_user": {"reputation": 1889, "user_id": 4540658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/9vCJz.jpg?s=128&g=1", "display_name": "Dannyu NDos", "link": "https://stackoverflow.com/users/4540658/dannyu-ndos"}, "edited": false, "score": 1, "creation_date": 1570495209, "post_id": 58273773, "comment_id": 102923597, "body": "A <code>Cyclic n</code> represents a number from <code>0</code> to <code>n-1</code>. Logically, that&#39;s a finite number of values, therefore there is a finite-sized encoding. The fact that you&#39;ve decided to <i>implement</i> it as an <code>Integer</code> is irrelevant. You could e.g. say <code>data Cyclic n where CZ :: Cyclic 1; CS :: Cyclic n -&gt; Cyclic (S n)</code> and build the same logic on top of it. Depending on how you&#39;re dealing with it, e.g. a <code>Cyclic 10 :: Cyclic 5</code> is either just invalid, or is considered equal to <code>Cyclic 0</code>. Either way, you don&#39;t care about anything outside the range <code>0</code> to <code>n-1</code>."}], "tags": [], "owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "is_accepted": true, "score": 1, "last_activity_date": 1570466411, "creation_date": 1570466411, "answer_id": 58273773, "question_id": 58265110, "link": "https://stackoverflow.com/questions/58265110/what-is-the-exact-criteria-for-a-type-to-be-storable/58273773#58273773", "title": "What is the exact criteria for a type to be Storable?", "body": "<p><code>Storable</code> is meant to evoke the idea of C <code>struct</code>s. As a <code>struct</code>, any type that is <code>Storable</code> is bounded in size. <code>Storable (Symmetric n)</code> is possible because <code>Symmetric n</code> is, in fact, bounded-size. (Assuming that <code>Cyclic n</code>s are equivalent modulo <code>n</code>,) It has <code>n!</code> values, which is finite, and so you don't need unbounded space. More specifically, just <code>log2(n!)</code> bits will suffice. Note that I'm talking about <code>Symmetric n</code> <em>for some specific <code>n</code></em>. For different <code>Nat</code>s <code>n</code>, <code>m</code>, etc. <code>Symmetric n</code>, <code>Symmetric m</code>, etc. are different types, and so they may therefore have different sizes. For a <em>single</em> <code>n :: Nat</code>, <code>Symmetric n</code> has a fixed size.</p>\n\n<p>The real issue is picking an encoding. For ease of implementation, you could use a recursive encoding, where a <code>Storable n</code> consists of <code>ceil(log2(n) / 8)</code> bytes to hold the first number followed by a <code>Storable (n - 1)</code>. Then, <code>Symmetric 1</code> will be 0 bytes, <code>Symmetric 2</code> will be 1 byte (with only one bit of it used), <code>Symmetric 3</code> will be 2 bytes, ..., <code>Symmetric 256</code> will be 255 bytes, <code>Symmetric 257</code> will be 257 bytes (because the first number has 257 choices and therefore needs two bytes). This is certainly not efficient, but you can clearly see that there's a well-defined size for every <code>Symmetric n</code>. If you want to get down to the bound of <code>log2(n!)</code> bits (really, <code>ceil(log2(n!)/8)</code> bytes), you'd have to do some ~~funky&nbsp;math~~ (which I'm not familar with), but you can do it.</p>\n\n<p>You need singletons to make this work; it's possible to write</p>\n\n<pre><code>instance KnownNat n =&gt; Storable (Symmetric n)\n</code></pre>\n\n<p>but not</p>\n\n<pre><code>instance Storable (Symmetric n)\n</code></pre>\n\n<p>Types are erased, so the second <code>instance</code> is not told what <code>n</code> is and thus can't read anything (or implement <code>sizeof</code>, etc.). It <em>can</em> write, because <code>Symmetric</code> is a GADT and thus contains information about what <code>n</code> is.</p>\n\n<hr/>\n\n<p>Side note: should not <code>Symmetric 0</code> be nonempty?</p>\n\n<pre><code>data Symmetric (n :: Nat) where\n    S0 :: Symmetric 0\n    (:.) :: Cyclic n -&gt; Symmetric (n - 1) -&gt; Symmetric n\n</code></pre>\n\n<p><code>Symmetric 0</code> is the set of bijections from the empty set to itself, and there's just one function (the empty set) in that set.</p>\n"}], "owner": {"reputation": 1889, "user_id": 4540658, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/9vCJz.jpg?s=128&g=1", "display_name": "Dannyu NDos", "link": "https://stackoverflow.com/users/4540658/dannyu-ndos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 78, "favorite_count": 0, "accepted_answer_id": 58273773, "answer_count": 1, "score": 1, "last_activity_date": 1570466411, "creation_date": 1570433066, "last_edit_date": 1570440829, "question_id": 58265110, "link": "https://stackoverflow.com/questions/58265110/what-is-the-exact-criteria-for-a-type-to-be-storable", "title": "What is the exact criteria for a type to be Storable?", "body": "<p>I implemented a data type for symmetric groups (and cyclic groups) long time ago:</p>\n\n<pre><code>newtype Cyclic (n :: Nat) = Cyclic {cIndex :: Integer}\n\ndata Symmetric (n :: Nat) where\n    S1 :: Symmetric 1\n    (:.) :: Cyclic n -&gt; Symmetric (n-1) -&gt; Symmetric n \n</code></pre>\n\n<p>This is an inhomogeneous container, <s>but I'm not sure whether this is an array or a list.</s> As the comments clarify, this is not an issue.</p>\n\n<p><s>If this is an array,</s> it would be possible to implement <code>instance Storable (Symmetric n)</code>. Why exactly is it possible to do so?</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 19480, "user_id": 2491900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/W8FMW.jpg?s=128&g=1", "display_name": "shree.pat18", "link": "https://stackoverflow.com/users/2491900/shree-pat18"}, "is_accepted": true, "score": 2, "last_activity_date": 1570422352, "creation_date": 1570422352, "answer_id": 58263523, "question_id": 58263323, "link": "https://stackoverflow.com/questions/58263323/checking-if-a-given-integer-is-the-first-element-of-a-tuple-in-a-list-of-tuples/58263523#58263523", "title": "Checking if a given Integer is the first element of a tuple in a list of tuples", "body": "<p>Here's how you can modify the function:</p>\n\n<pre><code>isFirst :: (Eq a) =&gt; a -&gt; [(a,b)] -&gt; Bool\nisFirst _ [] = False\nisFirst x [(y1, y2)] = x == y1\nisFirst x  ((y1, y2):l) = (x == y1) || isFirst x l\n</code></pre>\n\n<p><strong>What was wrong with the earlier implementation?</strong></p>\n\n<p>Writing <code>y1 : isFirst l</code> means you want to add <code>y</code> to the start of the list generated by <code>isFirst l</code>. But <code>isFirst</code> should return a <code>Bool</code>, so that wouldn't work.</p>\n\n<p><strong>What's the fix?</strong></p>\n\n<p>Explicitly check for the first tuple, and then recursively call <code>isFirst</code> on the rest of the list. Joining the two checks with an OR will be a logically correct operation, since each check returns a <code>Bool</code> result.</p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1570431866, "creation_date": 1570431866, "answer_id": 58264833, "question_id": 58263323, "link": "https://stackoverflow.com/questions/58263323/checking-if-a-given-integer-is-the-first-element-of-a-tuple-in-a-list-of-tuples/58264833#58264833", "title": "Checking if a given Integer is the first element of a tuple in a list of tuples", "body": "<p>We can make use of <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:any\" rel=\"nofollow noreferrer\"><strong><code>any :: Foldable f =&gt; (a -&gt; Bool) -&gt; f a -&gt; Bool</code></strong></a> here to check if any of the 2-tuples has a first element that is equal to the one we are looking for:</p>\n\n<pre><code>isFirst :: Eq a =&gt; a -&gt; [(a,b)] -&gt; Bool\nisFirst x ys = any (\\(y, _) -&gt; x == y) ys\n</code></pre>\n\n<p>or shorter:</p>\n\n<pre><code>isFirst :: Eq a =&gt; a -&gt; [(a,b)] -&gt; Bool\nisFirst x = any ((==) x . fst)\n</code></pre>\n"}], "owner": {"reputation": 200, "user_id": 12174294, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff5a9f269ee5f6948c98584fc17a9556?s=128&d=identicon&r=PG&f=1", "display_name": "Ramux05", "link": "https://stackoverflow.com/users/12174294/ramux05"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "accepted_answer_id": 58263523, "answer_count": 2, "score": 2, "last_activity_date": 1570431866, "creation_date": 1570420254, "question_id": 58263323, "link": "https://stackoverflow.com/questions/58263323/checking-if-a-given-integer-is-the-first-element-of-a-tuple-in-a-list-of-tuples", "title": "Checking if a given Integer is the first element of a tuple in a list of tuples", "body": "<p>I have an assignment in which I need to check if a given Int is the first element of any tuple in a list of tuples. For example, if I want to check if <code>1</code> is the first element of any tuple on the list <code>[(2,3), (3,3), (2,7)]</code> it should return <code>False</code>, however, if I want to check if <code>1</code> is the first element on the list <code>[(2,2), (1,2), (3,4)]</code>, it should return <code>True</code>.\nThis is my attempt: </p>\n\n<pre><code>    isFirst :: (Eq a) =&gt; a -&gt; [(a,b)] -&gt; Bool\n    isFirst _ [] = False\n    isFirst x [(y1, y2)] = x == y1\n    isFirst x  ((y1, y2):l) = if y1 : isFirst l then True \n                                else False\n</code></pre>\n\n<p>I'm still new to Haskell so I really have no clue if I'm even close to the right solution, Thanks for your help!</p>\n"}, {"tags": ["dictionary", "haskell", "graph", "functional-programming", "non-exhaustive-patterns"], "comments": [{"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 1, "creation_date": 1570422859, "post_id": 58263235, "comment_id": 102895155, "body": "You may need to use <code>assocs</code> function change the <code>Map</code> to list of key/value list and then find second element of the pair. just a hint like: <code>map fst . filter ((== 3) . snd)</code>"}, {"owner": {"reputation": 87, "user_id": 12151860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDzSn6OW34aHl_xg7YF7kz32Jz-b-dU3b3x6Ktl=k-s128", "display_name": "Velyyn S", "link": "https://stackoverflow.com/users/12151860/velyyn-s"}, "reply_to_user": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 0, "creation_date": 1570424587, "post_id": 58263235, "comment_id": 102895424, "body": "Ahhh i just found the assocs function : O(n). Return all key/value pairs in the map in ascending key order. But i&#39;m not used to the . thing, I can&#39;t visualize it yet."}, {"owner": {"reputation": 87, "user_id": 12151860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDzSn6OW34aHl_xg7YF7kz32Jz-b-dU3b3x6Ktl=k-s128", "display_name": "Velyyn S", "link": "https://stackoverflow.com/users/12151860/velyyn-s"}, "reply_to_user": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 0, "creation_date": 1570426095, "post_id": 58263235, "comment_id": 102895737, "body": "@assembly.jc I tried this but my syntax is obviously wrong <code>predecessors v  (Graph arcs _ _) = map (fst)  ( filter (snd==v)  (assocs arcs) ) </code>"}, {"owner": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 0, "creation_date": 1570426984, "post_id": 58263235, "comment_id": 102895943, "body": "<code>snd</code> is a function and cannot use to compare the value <code>v</code> immediately, it need to composed with function <code>(== v)</code> like ((== v) . snd). or lambda form <code>(\\p-&gt; snd p == v)</code>"}, {"owner": {"reputation": 87, "user_id": 12151860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDzSn6OW34aHl_xg7YF7kz32Jz-b-dU3b3x6Ktl=k-s128", "display_name": "Velyyn S", "link": "https://stackoverflow.com/users/12151860/velyyn-s"}, "reply_to_user": {"reputation": 2194, "user_id": 7940614, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b697c574cc5dfb3a4d5e4aff46a1721a?s=128&d=identicon&r=PG&f=1", "display_name": "assembly.jc", "link": "https://stackoverflow.com/users/7940614/assembly-jc"}, "edited": false, "score": 0, "creation_date": 1570427648, "post_id": 58263235, "comment_id": 102896106, "body": "@assembly.jc This function has compiled :<code>predecessors v  (Graph arcs _ _) = map (fst)  (filter (\\(x,[y]) -&gt; elem v [y]) (assocs arcs) )  </code> But when i try to run <code>predecessors 3 $ addArcs emptyGraph [(1,2),(2,3),(1,3)]</code> It tells me : Non-exhaustive patterns in lambda"}], "answers": [{"tags": [], "owner": {"reputation": 445, "user_id": 8919942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/df193de377da686960f0109f46a80bf2?s=128&d=identicon&r=PG", "display_name": "MorJ", "link": "https://stackoverflow.com/users/8919942/morj"}, "is_accepted": false, "score": 2, "last_activity_date": 1570422968, "creation_date": 1570422968, "answer_id": 58263579, "question_id": 58263235, "link": "https://stackoverflow.com/questions/58263235/find-a-key-by-having-its-value-using-data-map-in-haskell/58263579#58263579", "title": "Find a key by having its value using Data.Map in Haskell", "body": "<p>Haskell's Maps and Hashmap don't have efficient key lookups. The best you can do is O(n), and you have to write it yourself. I have something like this in my projects, which we can edit a bit to find all keys:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>lookupKey :: Eq v =&gt; v -&gt; Map.Map k v -&gt; [k]\nlookupKey val = Map.foldrWithKey go [] where\n  go key value found =\n    if value == val\n    then val:found\n    else found\n</code></pre>\n\n<p>You might want to use strict folds if you use strict maps.</p>\n"}], "owner": {"reputation": 87, "user_id": 12151860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDzSn6OW34aHl_xg7YF7kz32Jz-b-dU3b3x6Ktl=k-s128", "display_name": "Velyyn S", "link": "https://stackoverflow.com/users/12151860/velyyn-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 647, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1570430031, "creation_date": 1570419528, "last_edit_date": 1570430031, "question_id": 58263235, "link": "https://stackoverflow.com/questions/58263235/find-a-key-by-having-its-value-using-data-map-in-haskell", "title": "Find a key by having its value using Data.Map in Haskell", "body": "<p>I just started using Haskell some weeks ago and I lack of imagination to resolve a function in this situation.</p>\n\n<p>So I am trying to find the predecessors of a vertex in a graph implemented in Haskell.</p>\n\n<p>My graph :</p>\n\n<pre><code>-- | A directed graph\ndata Graph v = Graph\n    { arcsMap :: Map v [v]     -- A map associating a vertex with its successors\n    , labelMap :: Map v String -- The Graphviz label of each node\n    , styleMap :: Map v String -- The Graphviz style of each node\n    }\n</code></pre>\n\n<p>The function <code>successors</code> :</p>\n\n<pre><code>-- | Returns the successors of a vertex in a graph in ascending order\n--\n-- We say that `v` is a successor of `u` in a graph `G` if the arc `(u,v)`\n-- belongs to `G`.\n-- Note: Returns the empty list if the vertex does not belong to the graph.\nsuccessors :: Ord v =&gt; v -&gt; Graph v -&gt; [v]\nsuccessors v (Graph arcs _ _) = findWithDefault [] v arcs\n</code></pre>\n\n<p>And the function I'm currently trying to resolve :</p>\n\n<pre><code>-- | Returns the predecessors of a vertex in a graph in ascending order\n--\n-- We say that `u` is a predecessor of `v` in a graph `G` if the arc `(u,v)`\n-- belongs to `G`.\n-- Note: Returns the empty list if the vertex does not belong to the graph.\npredecessors :: Ord v =&gt; v -&gt; Graph v -&gt; [v]\npredecessors v  (Graph arcs _ _) = \n     map (fst)  (filter (\\(x,[y]) -&gt; elem v [y]) (assocs arcs) ) \n</code></pre>\n\n<p>I need to find a way to get the keys (the vertices) by having the value (the successor) of those  vertices. For example :</p>\n\n<pre><code>-- &gt;&gt;&gt; predecessors 3 $ addArcs emptyGraph [(1,2),(2,3),(1,3)]\n-- [1,2]\n</code></pre>\n\n<p>But when I run that line, I get  <em>Non-exhaustive patterns in lambda</em>.</p>\n\n<p>What is that and how can I fix it?\nThank you!</p>\n\n<ul>\n<li>Edit : Never mind I corrected it but I still do not really understand how haha</li>\n</ul>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 0, "creation_date": 1570730977, "post_id": 58263572, "comment_id": 103015654, "body": "Your answer also answer my question <a href=\"https://stackoverflow.com/questions/58262463/filter-subsets-based-on-length/58262504#58262504\" title=\"filter subsets based on length\">stackoverflow.com/questions/58262463/&hellip;</a> , I&#39;ll mark it as duplicate, but if you want to add it there also, the bounty I think should be yours"}], "tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": true, "score": 2, "last_activity_date": 1570422843, "creation_date": 1570422843, "answer_id": 58263572, "question_id": 58263178, "link": "https://stackoverflow.com/questions/58263178/subset-of-length-k/58263572#58263572", "title": "Subset of length k?", "body": "<p>The equivalent in Python. Note that this very bad in CPython since recursion is so poorly implemented there, and pretty bad in all flavors of Python since lists aren't constructed the same way (<code>1: [2, 3, 4])</code> is straightforward in Haskell, but doing the same in Python requires some <code>dequeues</code> or ugly <code>[1] + [2,3,4]</code> stuff)</p>\n\n<pre class=\"lang-py prettyprint-override\"><code>from typing import TypeVar, List\n\nA = TypeVar('A')\ndef combinations(k: int, xs: List[A]) -&gt; List[List[A]]:\n    def helper(n: int, k2: int, lst: List[A]) -&gt; List[List[A]]:\n        # base cases\n        if k2 == 0: return [[]]     # if the requested subsequence length is zero\n        elif k2 &gt;= n: return [lst]  # if the requested subsequence length is longer than the whole sequence\n        elif not lst: return []     # if the sequence itself is empty\n\n        y, ys = lst[0], lst[1:]\n        return [[y] + rest for rest in helper(n-1, k2-1, ys)]\n\n    return helper(len(xs), k, xs)\n</code></pre>\n\n<p>Note that the overuse of guards in the Haskell strikes me as somewhat ugly. I would probably rewrite as:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>combinations :: Int -&gt; [a] -&gt; [[a]]\ncombinations k xs = combinations' (length xs) k xs\n  where\n    combinations' _ 0  _  = [[]]\n    combinations' _ _  [] = []\n    combinations' n k' l@(y:ys)\n      | k' &gt;= n           = [l]\n      | otherwise         = map (y :) (combinations' (n - 1) (k' - 1) ys) \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "is_accepted": false, "score": 0, "last_activity_date": 1570730827, "creation_date": 1570730827, "answer_id": 58328763, "question_id": 58263178, "link": "https://stackoverflow.com/questions/58263178/subset-of-length-k/58328763#58328763", "title": "Subset of length k?", "body": "<p>There is a simple alternative way equivalent with pattern matching provided by Khuldraeseth na'Barya <a href=\"https://stackoverflow.com/questions/58262463/filter-subsets-based-on-length/58262504#58262504\">in this question</a> :</p>\n\n<pre><code>subsetsOfLength 0 _  = [[]]\nsubsetsOfLength _ [] = []\nsubsetsOfLength n (x:xs) = map (x:) (subsetsOfLength (n-1) xs) ++ subsetsOfLength n xs\n</code></pre>\n"}], "owner": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 71, "favorite_count": 0, "accepted_answer_id": 58263572, "answer_count": 2, "score": 1, "last_activity_date": 1570730827, "creation_date": 1570418916, "last_edit_date": 1570421981, "question_id": 58263178, "link": "https://stackoverflow.com/questions/58263178/subset-of-length-k", "title": "Subset of length k?", "body": "<p>This following code works in an optimized way and i would like to understand it but failing. I understand first line but second line i get lost. If someone can explain it in C or Python that would be great or even general idea. Thank you</p>\n\n<pre><code>combinations :: Int -&gt; [a] -&gt; [[a]]\ncombinations k xs = combinations' (length xs) k xs\n  where combinations' n k' l@(y:ys) \n    | k' == 0   = [[]] \n    | k' &gt;= n   = [l] \n    | null l    = [] \n    | otherwise = map (y :) (combinations' (n - 1) (k' - 1) ys) \n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "is_accepted": false, "score": 5, "last_activity_date": 1570414719, "last_edit_date": 1570414719, "creation_date": 1570413437, "answer_id": 58262669, "question_id": 58262623, "link": "https://stackoverflow.com/questions/58262623/combining-two-lists-in-haskell/58262669#58262669", "title": "Combining two lists in Haskell", "body": "<p>First of all, you have a type error in the arguments of the function:</p>\n\n<pre><code>join :: ([t],[t]) -&gt; [t]\njoin x y = [ z | z &lt;- x, a &lt;- y]\n</code></pre>\n\n<p>it should be:</p>\n\n<pre><code>join :: ([t],[t]) -&gt; [t]\njoin (x,y) = [ z | z &lt;- x, a &lt;- y]\n</code></pre>\n\n<p>but that will return to you:</p>\n\n<pre><code>  join' (\"hello\", \"world\")\n=&gt; \"hhhhheeeeellllllllllooooo\"\n</code></pre>\n\n<p>because list comprehension combines all values from the two lists, so, don't use it in this case. Instead:</p>\n\n<p>Why don't you use recursion over the structure of <code>(,)</code> and <code>[]</code>? it should be easy as:</p>\n\n<pre><code>join :: ([a], [a]) -&gt; [a]\njoin ([], ys) = ys\njoin (xs, []) = xs\njoin ((x:xs), ys) = x : (join (xs, ys))\n</code></pre>\n\n<p>example:</p>\n\n<pre><code>join (\"hello\", \"world\")\n=&gt; \"helloworld\"\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 67048, "user_id": 388787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f786b1ad349a30e02802ae61b4518fc?s=128&d=identicon&r=PG", "display_name": "Dan D.", "link": "https://stackoverflow.com/users/388787/dan-d"}, "reply_to_user": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 0, "creation_date": 1570415151, "post_id": 58262685, "comment_id": 102893908, "body": "I saw that before the edit which is why I wrote the answer the way I did."}], "tags": [], "owner": {"reputation": 67048, "user_id": 388787, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f786b1ad349a30e02802ae61b4518fc?s=128&d=identicon&r=PG", "display_name": "Dan D.", "link": "https://stackoverflow.com/users/388787/dan-d"}, "is_accepted": false, "score": 1, "last_activity_date": 1570413630, "creation_date": 1570413630, "answer_id": 58262685, "question_id": 58262623, "link": "https://stackoverflow.com/questions/58262623/combining-two-lists-in-haskell/58262685#58262685", "title": "Combining two lists in Haskell", "body": "<p>They want you to implement <code>++</code>.</p>\n\n<p>If you could use <code>++</code>, the implementation would be:</p>\n\n<pre><code>join (x, y) = x ++ y\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 10016696, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Wtgk7Rnfo58/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq3MXvf2oucJ8eJI4lCR72LqNCLUPQ/mo/photo.jpg?sz=128", "display_name": "Pravallika Kastala", "link": "https://stackoverflow.com/users/10016696/pravallika-kastala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1570414719, "creation_date": 1570412834, "last_edit_date": 1570414146, "question_id": 58262623, "link": "https://stackoverflow.com/questions/58262623/combining-two-lists-in-haskell", "title": "Combining two lists in Haskell", "body": "<blockquote>\n  <p>NOTE: <b> prohibited from using ++ in your code. </b></p>\n</blockquote>\n\n<pre><code>join :: ([t],[t]) -&gt; [t]\n</code></pre>\n\n<p>which takes a pair of lists of some type t, (xs,ys) and returns a single list that contains all the elements\nsome testcases : </p>\n\n<pre><code>join ([],[])) \"==\" [])\njoin ([],[5,6,5])) \"==\" [5,6,5]\njoin ([7],[5,6,5])) \"==\" [7,5,6,5]\njoin ([3,7],[5,6,5])) \"==\" [3,7,5,6,5]\njoin (\"be\",\"happy\")) \"==\" \"behappy\"\n</code></pre>\n\n<p>This is what I currently have </p>\n\n<pre><code>module Sum where \njoin :: ([t],[t]) -&gt; [t]\njoin x y = [ z | z &lt;- x, a &lt;- y]\n</code></pre>\n\n<p>the error I get is </p>\n\n<pre><code>Sum.hs:3:1: error:\n    * Couldn't match expected type `[t]'\n                  with actual type `[t0] -&gt; [a0]'\n    * The equation(s) for `join' have two arguments,\n      but its type `([t], [t]) -&gt; [t]' has only one\n    * Relevant bindings include\n        join :: ([t], [t]) -&gt; [t] (bound at Sum.hs:3:1)\n  |\n3 | join x y = [ z | z &lt;- x, a &lt;- y]\n  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n\nSum.hs:3:23: error:\n    * Couldn't match expected type `[a0]' with actual type `([t], [t])'\n    * In the expression: x\n      In a stmt of a list comprehension: z &lt;- x\n      In the expression: [z | z &lt;- x, a &lt;- y]\n    * Relevant bindings include\n        x :: ([t], [t]) (bound at Sum.hs:3:6)\n        join :: ([t], [t]) -&gt; [t] (bound at Sum.hs:3:1)\n  |\n3 | join x y = [ z | z &lt;- x, a &lt;- y]\n  |                       ^\n\n</code></pre>\n"}, {"tags": ["list", "haskell", "lambda", "function-call", "pointfree"], "comments": [{"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 0, "creation_date": 1570724675, "post_id": 58262463, "comment_id": 103012900, "body": "Related answer here <a href=\"https://stackoverflow.com/questions/58311829/convert-recursion-into-list-comprehension/58312118#58312118\" title=\"convert recursion into list comprehension\">stackoverflow.com/questions/58311829/&hellip;</a>"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1570739003, "post_id": 58262463, "comment_id": 103019047, "body": "cf. <a href=\"https://stackoverflow.com/questions/54129886/a-faster-way-of-generating-combinations-with-a-given-length-preserving-the-orde\" title=\"a faster way of generating combinations with a given length preserving the orde\">stackoverflow.com/questions/54129886/&hellip;</a>"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 1, "creation_date": 1570809605, "post_id": 58262463, "comment_id": 103044692, "body": "also <a href=\"https://stackoverflow.com/questions/26727673/haskell-comparison-of-techniques-for-generating-combinations\" title=\"haskell comparison of techniques for generating combinations\">stackoverflow.com/questions/26727673/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "is_accepted": true, "score": 6, "last_activity_date": 1570731119, "last_edit_date": 1570731119, "creation_date": 1570411087, "answer_id": 58262504, "question_id": 58262463, "link": "https://stackoverflow.com/questions/58262463/filter-subsets-based-on-length/58262504#58262504", "title": "Filter subsets based on length?", "body": "<p>When I get stuck with a little confusion in filtering, I go a level up and use <code>foldr</code> in this case would be as simple as:</p>\n\n<pre><code>filterLength3 = foldr (\\x rs -&gt; if (length x) == 3 then  x : rs else rs) [] \n\nfilterLength3 (subsets [1,2,3,4,5])\n</code></pre>\n\n<blockquote>\n  <p>output</p>\n</blockquote>\n\n<pre><code>=&gt; [[1,2,3],[1,2,4],[1,3,4],[2,3,4],[1,2,5],[1,3,5],[2,3,5],[1,4,5],[2,4,5],[3,4,5]]\n</code></pre>\n\n<p>With <code>filter</code> should be:</p>\n\n<pre><code>filter ((==3) . length) (subsets [1,2,3,4,5])\n\n=&gt; [[1,2,3],[1,2,4],[1,3,4],[2,3,4],[1,2,5],[1,3,5],[2,3,5],[1,4,5],[2,4,5],[3,4,5]]\n</code></pre>\n\n<blockquote>\n  <p>Edit</p>\n</blockquote>\n\n<p>After thinking a lot, and with the help of chi, and asking <a href=\"https://stackoverflow.com/questions/58311829/convert-recursion-into-list-comprehension/58312118#58312118\">this question</a> I was able to solve it:</p>\n\n<pre><code>import Data.List\n\nsubsetsOfThree ws = [ [x,y,z] | (x:xs) &lt;- tails ws, (y:ys) &lt;- tails xs, z &lt;- ys ]\n</code></pre>\n\n<p>some examples:</p>\n\n<pre><code>  subsetsOfThree [1..3]\n=&gt; [[1,2,3]]\n   subsetsOfThree [1..4]\n=&gt; [[1,2,3],[1,2,4],[1,3,4],[2,3,4]]\n   subsetsOfThree [1..5]\n=&gt; [[1,2,3],[1,2,4],[1,2,5],[1,3,4],[1,3,5],[1,4,5],[2,3,4],[2,3,5],[2,4,5],[3,4,5]]\n   subsetsOfThree [1..10]\n=&gt; [[1,2,3],[1,2,4],[1,2,5],[1,2,6],[1,2,7],[1,2,8],[1,2,9],[1,2,10],[1,3,4],[1,3,5],[1,3,6],[1,3,7],[1,3,8],[1,3,9],[1,3,10],[1,4,5],[1,4,6],[1,4,7],[1,4,8],[1,4,9],[1,4,10],[1,5,6],[1,5,7],[1,5,8],[1,5,9],[1,5,10],[1,6,7],[1,6,8],[1,6,9],[1,6,10],[1,7,8],[1,7,9],[1,7,10],[1,8,9],[1,8,10],[1,9,10],[2,3,4],[2,3,5],[2,3,6],[2,3,7],[2,3,8],[2,3,9],[2,3,10],[2,4,5],[2,4,6],[2,4,7],[2,4,8],[2,4,9],[2,4,10],[2,5,6],[2,5,7],[2,5,8],[2,5,9],[2,5,10],[2,6,7],[2,6,8],[2,6,9],[2,6,10],[2,7,8],[2,7,9],[2,7,10],[2,8,9],[2,8,10],[2,9,10],[3,4,5],[3,4,6],[3,4,7],[3,4,8],[3,4,9],[3,4,10],[3,5,6],[3,5,7],[3,5,8],[3,5,9],[3,5,10],[3,6,7],[3,6,8],[3,6,9],[3,6,10],[3,7,8],[3,7,9],[3,7,10],[3,8,9],[3,8,10],[3,9,10],[4,5,6],[4,5,7],[4,5,8],[4,5,9],[4,5,10],[4,6,7],[4,6,8],[4,6,9],[4,6,10],[4,7,8],[4,7,9],[4,7,10],[4,8,9],[4,8,10],[4,9,10],[5,6,7],[5,6,8],[5,6,9],[5,6,10],[5,7,8],[5,7,9],[5,7,10],[5,8,9],[5,8,10],[5,9,10],[6,7,8],[6,7,9],[6,7,10],[6,8,9],[6,8,10],[6,9,10],[7,8,9],[7,8,10],[7,9,10],[8,9,10]]\n</code></pre>\n\n<p>And now you are able to make your monster a little puppet:</p>\n\n<pre><code>  length $ subsetsOfThree [1..10]\n=&gt; 120\n   length $ subsetsOfThree [1..20]\n=&gt; 1140\n   length $ subsetsOfThree [1..50]\n=&gt; 19600\n   length $ subsetsOfThree [1..100]\n=&gt; 161700\nlength $ subsetsOfThree [1..500]\n=&gt; 20708500\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 700, "user_id": 5499914, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fz53h.png?s=128&g=1", "display_name": "Khuldraeseth na&#39;Barya", "link": "https://stackoverflow.com/users/5499914/khuldraeseth-nabarya"}, "is_accepted": false, "score": 2, "last_activity_date": 1570726859, "creation_date": 1570726859, "answer_id": 58327808, "question_id": 58262463, "link": "https://stackoverflow.com/questions/58262463/filter-subsets-based-on-length/58327808#58327808", "title": "Filter subsets based on length?", "body": "<p>Here's a general solution for length-n subsets not using filter.</p>\n\n<p>Where our initial list is <code>x:xs</code>, notice that we can partition these subsets into those containing <code>x</code> and those not containing <code>x</code>. This shows us a nice recursive structure; the first partition is <code>x</code> prepended to each length-(n-1) subset of <code>xs</code>, and the second is just the length-n subsets of <code>xs</code>.</p>\n\n<pre><code>subsetsOfLength n (x:xs) = map (x:) (subsetsOfLength (n-1) xs) ++ subsetsOfLength n xs\n</code></pre>\n\n<p>All we need are the base cases. There is a single length-0 subset, and no subset is larger than the original:</p>\n\n<pre><code>subsets 0 _  = [[]]\nsubsets _ [] = []\n</code></pre>\n\n<p>Stick these bases above the recursive step and throw an appropriate type signature on it, and we're done.</p>\n\n<pre><code>\u03bb&gt; subsetsOfLength 3 [1..5]\n[[1,2,3],[1,2,4],[1,2,5],[1,3,4],[1,3,5],[1,4,5],[2,3,4],[2,3,5],[2,4,5],[3,4,5]]\n\n\u03bb&gt; length $ subsetsOfLength 5 [1..100]\n252\n</code></pre>\n\n<p>Nice.</p>\n\n<p>Be careful. <code>(++)</code> is slow; if you know at compile-time the length you'll be using, <a href=\"https://stackoverflow.com/a/58262504/5499914\">Dami\u00e1n Rafael Lattenero's <code>tails</code> approach</a> may be more performant. Not entirely sure about this, though. Also, depending on the values, you might do well to swap the operands of <code>(++)</code>. I haven't yet done the math.</p>\n"}, {"tags": [], "owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "is_accepted": false, "score": 3, "last_activity_date": 1572562367, "last_edit_date": 1572562367, "creation_date": 1571006093, "answer_id": 58368298, "question_id": 58262463, "link": "https://stackoverflow.com/questions/58262463/filter-subsets-based-on-length/58368298#58368298", "title": "Filter subsets based on length?", "body": "<p>The number of subsets for a list of 100 elements is about 2<sup>100</sup> \u2243 1.26*10<sup>30</sup>, a really huge number. So the <code>filter</code> approach does not seem practical. The problem should be solved by manipulating lists containing just a few numbers between 1 and 100.</p>\n\n<p>So we aim to write a function to be named <code>kSubsets</code> which returns the list of all subsets of cardinality k:</p>\n\n<pre><code>kSubsets :: Int -&gt; [a] -&gt; [[a]]\n</code></pre>\n\n<p>where k is the first argument. </p>\n\n<h2>A solution based on recursive list processing:</h2>\n\n<p>A possible way to build the functionality of <code>kSubsets</code> consists in using an auxiliary <code>kIndexSubsets</code> function which computes the zero-based indexes of the elements, instead of the elements themselves. The <code>kIndexSubsets</code> function can be written in a recursive fashion.</p>\n\n<p>In that case, the <code>kSubsets</code> function is essentially a wrapper which maps the element indexes to the actual list elements. This gives the following code:</p>\n\n<pre><code>import qualified  Data.Map    as  M\nimport qualified  Data.Maybe  as  Mb\nimport qualified  Data.List   as  L\n\nkIndexSubsets :: Int -&gt; Int -&gt; [[Int]]\nkIndexSubsets 0 _  = [[]]\nkIndexSubsets k nn =\n    -- first element chosen must leave room for (k-1) elements after itself\n    let lastChoice = if (k &gt; nn)\n                     then error \"k above nn in kIndexSubsets\"\n                     else (nn -k)\n        choices = [0 .. lastChoice]\n        -- for each possible first element, recursively compute\n        -- all the possible tails:\n        fn hd   = let tails1 = kIndexSubsets (k-1) (nn - (hd+1))\n                      -- rebase subsequent indexes:\n                      tails2 = map (map (\\x -&gt; (x+hd+1))) tails1\n                  in  -- add new leftmost element:\n                      map  (\\ls -&gt; hd:ls)  tails2\n    in\n        concatMap fn choices\n\n\n-- return the list of all subsets of ls having k elements:\nkSubsets :: Int -&gt; [a] -&gt; [[a]]\nkSubsets 0 _  = [[]]\nkSubsets k ls = \n    let  nn = length ls\n         -- need a map for fast access to elements of ls:\n         ma = M.fromList $ zip [0..] ls\n         extractor ix = Mb.fromJust(M.lookup ix ma)\n         indexSubSets = kIndexSubsets k nn\n    in\n         map  (map extractor)  indexSubSets\n</code></pre>\n\n<p>We can now test our <code>kSubsets</code> function. This involves checking that the length of the resulting output list conforms to the classic combinatorics formula, that is n!/(k! * (n-k)!) where n is the length of the input list.</p>\n\n<pre><code>*Main&gt; let ls = \"ABCDEFGH\"\n*Main&gt; kSubsets 0 ls\n[\"\"]\n*Main&gt; kSubsets 1 ls\n[\"A\",\"B\",\"C\",\"D\",\"E\",\"F\",\"G\",\"H\"]\n\n*Main&gt; kSubsets 2 ls\n[\"AB\",\"AC\",\"AD\",\"AE\",\"AF\",\"AG\",\"AH\",\"BC\",\"BD\",\"BE\",\"BF\",\"BG\",\"BH\",\"CD\",\"CE\",\"CF\",\"CG\",\"CH\",\"DE\",\"DF\",\"DG\",\"DH\",\"EF\",\"EG\",\"EH\",\"FG\",\"FH\",\"GH\"]\n\n*Main&gt; kSubsets 3 ls\n[\"ABC\",\"ABD\",\"ABE\",\"ABF\",\"ABG\",\"ABH\",\"ACD\",\"ACE\",\"ACF\",\"ACG\",\"ACH\",\"ADE\",\"ADF\",\"ADG\",\"ADH\",\"AEF\",\"AEG\",\"AEH\",\"AFG\",\"AFH\",\"AGH\",\"BCD\",\"BCE\",\"BCF\",\"BCG\",\"BCH\",\"BDE\",\"BDF\",\"BDG\",\"BDH\",\"BEF\",\"BEG\",\"BEH\",\"BFG\",\"BFH\",\"BGH\",\"CDE\",\"CDF\",\"CDG\",\"CDH\",\"CEF\",\"CEG\",\"CEH\",\"CFG\",\"CFH\",\"CGH\",\"DEF\",\"DEG\",\"DEH\",\"DFG\",\"DFH\",\"DGH\",\"EFG\",\"EFH\",\"EGH\",\"FGH\"]\n\n*Main&gt; \n*Main&gt; kSubsets 7 ls\n[\"ABCDEFG\",\"ABCDEFH\",\"ABCDEGH\",\"ABCDFGH\",\"ABCEFGH\",\"ABDEFGH\",\"ACDEFGH\",\"BCDEFGH\"]\n*Main&gt; \n*Main&gt; kSubsets 8 ls\n[\"ABCDEFGH\"]\n*Main&gt; \n*Main&gt; \n*Main&gt; div ((100*99*98)::Integer)  ((2*3)::Integer)\n161700\n*Main&gt; \n*Main&gt; length $ kSubsets 3 [ 1 .. 100 ]\n161700\n*Main&gt; \n*Main&gt; div ((100*99*98*97*96)::Integer)  ((2*3*4*5)::Integer)\n75287520\n*Main&gt; length $ kSubsets 5 [ 1 .. 100 ]\n75287520\n*Main&gt;\n</code></pre>\n\n<p>The evaluation of  <code>kSubsets 3 [ 1 .. 100 ]</code> takes less than 50 msec on a plain vanilla x86-64 Linux machine.</p>\n\n<h2>An alternative solution based on a state machine:</h2>\n\n<p>The (reversed) list of chosen indexes is taken to be the state of an automaton, and we advance the state step by step, until this is no longer possible, at which point the list of sublists is complete.</p>\n\n<p>Basically, if there is room to advance the rightmost index, fine, otherwise we recurse to advance the rest of the list, and then move the rightmost index as far left as possible.</p>\n\n<p>The approach gives this alternative source code for <code>kIndexSubsets</code>, in which the key piece is the <code>ksAdvance</code> stepping function:</p>\n\n<pre><code>import qualified  Data.Map    as  M\nimport qualified  Data.Maybe  as  Mb\nimport qualified  Data.List   as  L\n\n\n-- works on the *reversed* list of chosen indexes:\nksAdvance :: Int -&gt; Int -&gt; Maybe [Int] -&gt; Maybe [Int]\nksAdvance k nn Nothing        = Nothing\nksAdvance k nn (Just [])      = Nothing\nksAdvance k nn (Just (h:rls)) =\n    if (h == (nn-1))\n    then -- cannot advance rightmost index, so must recurse\n        let mbols2 = ksAdvance (k-1) (nn-1) (Just rls)\n        in\n            case mbols2 of\n            Nothing   -&gt; Nothing\n            Just ols2 -&gt; let  y = ((head ols2)+1)  in  Just (y:ols2)\n    else -- just advance rightmost index:\n        Just ((h+1):rls)\n\n\nkIndexSubsets :: Int -&gt; Int -&gt; [[Int]]\nkIndexSubsets 0 _  = [[]]\nkIndexSubsets k nn =\n    let startList = reverse  $  [ 0 .. (k-1) ]\n        cutList = takeWhile  Mb.isJust\n        mbls    = cutList $ iterate  (ksAdvance k nn)  (Just startList)\n    in\n        map  (reverse . Mb.fromJust)  mbls\n</code></pre>\n\n<p>This algorithm seems less memory-hungry and faster than the first one.</p>\n\n<p>Using this main program for a quick performance test, with subsets of 5 elements out of 100, generating 75287520 subsets:</p>\n\n<pre><code>kSubsets :: Int -&gt; [a] -&gt; [[a]]\nkSubsets 0 _  = [[]]\nkSubsets k ls = \n    let  nn = length ls\n         -- need a map for fast access to elements of ls:\n         ma = M.fromList $ zip [0..] ls\n         eltFromIndex = \\ix -&gt; Mb.fromJust (M.lookup ix ma)\n         indexSubSets = kIndexSubsets k nn\n    in\n         map  (map eltFromIndex)  indexSubSets\n\n\nmain = do\n    let nn  = 100\n    let  k  = 5\n    let ls  = [ 1 .. nn ]::[Int]\n    let str = \"count of \" ++ (show k) ++ \" out of \" ++ (show nn) ++\n          \" elements subsets = \" ++ (show $ length (kSubsets k ls))\n    putStrLn $ str\n</code></pre>\n\n<p>Memory performance is improved:</p>\n\n<pre><code>$ /usr/bin/time ./kSubsets03.x +RTS -s\n    count of 5 out of 100 elements subsets = 75287520\n       4,529,861,272 bytes allocated in the heap\n             623,240 bytes copied during GC\n              44,504 bytes maximum residency (2 sample(s))\n              29,224 bytes maximum slop\n                   2 MB total memory in use (0 MB lost due to fragmentation)\n ...\n      Productivity  98.4% of total user, 98.5% of total elapsed\n\n    0.70user 0.00system 0:00.72elapsed 99%CPU (0avgtext+0avgdata 4724maxresident)k\n    0inputs+0outputs (0major+436minor)pagefaults 0swaps\n$ \n</code></pre>\n\n<p>Not yet as good as Fortran but getting close :-)</p>\n"}], "owner": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 271, "favorite_count": 1, "accepted_answer_id": 58262504, "answer_count": 3, "score": 7, "last_activity_date": 1572883141, "creation_date": 1570410454, "last_edit_date": 1572883141, "question_id": 58262463, "link": "https://stackoverflow.com/questions/58262463/filter-subsets-based-on-length", "title": "Filter subsets based on length?", "body": "<p>Trying to extract the subsets with length k using filter. Not sure how to approach it? The list has <strong>100 elements</strong>.</p>\n\n<pre><code>subsets :: [a] -&gt; [[a]]\nsubsets [] = [[]]\nsubsets (x:xs) = [zs | ys &lt;- subsets xs, zs &lt;- [ys, (x:ys)]]\n</code></pre>\n\n<p>If i use filter this is what i thought it would be:</p>\n\n<pre><code>filter (length(3)) subsets [1,2,3,4,5]\n</code></pre>\n\n<p>But i'm probably wrong. If there is a different approach rather than filter? I'm new to haskell so not exactly sure.</p>\n"}, {"tags": ["haskell", "integer-overflow"], "answers": [{"comments": [{"owner": {"reputation": 101, "user_id": 10659157, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-B_Z0zjUbTmA/AAAAAAAAAAI/AAAAAAAAB9U/vch1ABqRa0Q/photo.jpg?sz=128", "display_name": "Jesse Sainz", "link": "https://stackoverflow.com/users/10659157/jesse-sainz"}, "edited": false, "score": 1, "creation_date": 1570408719, "post_id": 58262324, "comment_id": 102892991, "body": "Ah gotcha. Thanks so much! I didn&#39;t realize there was a difference between Int and Integer. Just looked it up and found the difference. You&#39;re a lifesaver \ud83d\ude4f\ud83c\udffc"}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": true, "score": 4, "last_activity_date": 1570408393, "creation_date": 1570408393, "answer_id": 58262324, "question_id": 58262287, "link": "https://stackoverflow.com/questions/58262287/haskell-length-list-factorial/58262324#58262324", "title": "Haskell length list + factorial", "body": "<p>Your <code>factorial</code> function is polymorphic: it has type <code>(Eq p, Num p) =&gt; p -&gt; p</code>. When you just call it like <code>factorial 60</code>, <code>p</code> gets instantiated as <code>Integer</code> (this choice is called \"type defaulting\"), which is arbitrary-precision and has no upper bound. However, <code>length</code> is not polymorphic in its output: it always returns an <code>Int</code>. Haskell won't automatically convert between numeric types for you, so when you call <code>factorial</code> with the result of <code>length</code>, it uses <code>Int</code> too, which does have an upper bound, which in your case appears to be <code>9223372036854775807</code> (which you can verify by doing <code>maxBound :: Int</code>). To work around this problem, you can either convert from <code>Int</code> to <code>Integer</code> yourself:</p>\n\n<pre><code>subsets k list = factorial (toInteger n) where\n    n = length list\n</code></pre>\n\n<p>or use <code>genericLength</code>, which is the same as <code>length</code> except for being polymorphic in its output type:</p>\n\n<pre><code>import Data.List\n\nsubsets k list = factorial n where\n    n = genericLength list\n</code></pre>\n\n<p>Note that if you use the latter option, you need to be careful not to do anything else that would force use of <code>Int</code> instead of defaulting to <code>Integer</code>.</p>\n"}], "owner": {"reputation": 101, "user_id": 10659157, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-B_Z0zjUbTmA/AAAAAAAAAAI/AAAAAAAAB9U/vch1ABqRa0Q/photo.jpg?sz=128", "display_name": "Jesse Sainz", "link": "https://stackoverflow.com/users/10659157/jesse-sainz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 58262324, "answer_count": 1, "score": 2, "last_activity_date": 1570435364, "creation_date": 1570407971, "last_edit_date": 1570435364, "question_id": 58262287, "link": "https://stackoverflow.com/questions/58262287/haskell-length-list-factorial", "title": "Haskell length list + factorial", "body": "<p>I'm very new to Haskell. I've been trying to implement <code>n_choose_r</code> but for some reason my factorial function is returning strange values.</p>\n\n<p>Main.hs</p>\n\n<pre><code>factorial 0 = 1\nfactorial n = n * factorial (n-1)\n\nsubsets k list = factorial n where\n    n = length list\n</code></pre>\n\n<p>some different cases</p>\n\n<pre><code>&gt; subsets 3 [1..4]\n24 // correct value\n&gt; factorial 60\n8320987112741390144276341183223364380754172606361245952449277696409600000000000000\n&gt; subsets 3 [1..60]\n-8718968878589280256 // wrong value\n&gt; subsets 3 [1..100]\n0 // wrong value\n</code></pre>\n\n<p>It seems the numbers get wonkier the longer the list. Can anyone explain?</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 1, "creation_date": 1570399293, "post_id": 58261554, "comment_id": 102891604, "body": "Exactly how do you run this?"}, {"owner": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1570399340, "post_id": 58261554, "comment_id": 102891613, "body": "<code>:r</code> then use <code>ksubsets 3 [1,2,3,4,5]</code> @WillemVanOnsem"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1570399418, "post_id": 58261554, "comment_id": 102891627, "body": "and you did use a file to specify these functions? Or did you load these in <code>ghci</code> itself, since an <code>:r</code> will indeed clean the memory, and thus remove the ones not in the file."}, {"owner": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1570399493, "post_id": 58261554, "comment_id": 102891638, "body": "used a file and ran it through ghci @WillemVanOnsem"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1570399673, "post_id": 58261554, "comment_id": 102891658, "body": "can&#39;t reproduce. the code is working as is."}, {"owner": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1570399743, "post_id": 58261554, "comment_id": 102891670, "body": "@WillNess is it possible to provide steps on how you ran it? I&#39;m not sure where the issue is tbh"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1570399810, "post_id": 58261554, "comment_id": 102891682, "body": "<code>ghci&gt; :{</code>, then copy-paste your lines, then <code>ghci&gt; :}</code>. (that&#39;s multi-line input mode)"}, {"owner": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "reply_to_user": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 0, "creation_date": 1570399968, "post_id": 58261554, "comment_id": 102891712, "body": "@WillNess That worked. But why is it not loading from file?"}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "edited": false, "score": 2, "creation_date": 1570400007, "post_id": 58261554, "comment_id": 102891718, "body": "you probably have some mix-up. carefully create new file, and load it. :)"}], "answers": [{"comments": [{"owner": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "edited": false, "score": 0, "creation_date": 1570411098, "post_id": 58262470, "comment_id": 102893286, "body": "Thank you for the summary! Another problem i don&#39;t know how to solve, how would i filter subsets based on length of k elements? AGain, Thanks!"}], "tags": [], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "is_accepted": true, "score": 1, "last_activity_date": 1570411446, "last_edit_date": 1570411446, "creation_date": 1570410736, "answer_id": 58262470, "question_id": 58261554, "link": "https://stackoverflow.com/questions/58261554/haskell-variable-not-in-scope/58262470#58262470", "title": "Haskell: Variable not in scope?", "body": "<p>Summarizing the comments, and possible problems and solutions:</p>\n\n<ol>\n<li>There are no errors in your code, you can even try it online <a href=\"https://repl.it/repls/UnsungKnownDistributeddatabase\" rel=\"nofollow noreferrer\">here</a></li>\n<li>If you are using a text editor, check if you save your changes.</li>\n<li><p>run ghci, and load your file </p>\n\n<p>$> ghci</p>\n\n<p>Prelude> :l path/to/your/file.hs</p></li>\n<li><p>It should compile fine.</p></li>\n</ol>\n"}], "owner": {"reputation": 669, "user_id": 6675878, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/29885f3542cb5b00a06b1175caa1736e?s=128&d=identicon&r=PG&f=1", "display_name": "STOPIMACODER", "link": "https://stackoverflow.com/users/6675878/stopimacoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 320, "favorite_count": 0, "accepted_answer_id": 58262470, "answer_count": 1, "score": 1, "last_activity_date": 1570411446, "creation_date": 1570399201, "question_id": 58261554, "link": "https://stackoverflow.com/questions/58261554/haskell-variable-not-in-scope", "title": "Haskell: Variable not in scope?", "body": "<p>I'm trying to run the following code to get subsets of k-elements but getting <code>variable not in scope:ksubsets</code> Not exactly sure whY?</p>\n\n<p>Code:</p>\n\n<pre><code>subsets :: [a] -&gt; [[a]]\nsubsets [] = [[]]\nsubsets (x:xs) = [zs | ys &lt;- subsets xs, zs &lt;- [ys, (x:ys)]]\n\n\nksubsets k xs = [ys | ys&lt;-subsets xs, length ys==k]\n</code></pre>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 4004, "user_id": 1498178, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2a7f53f1d991f2ab18a4957a1f192960?s=128&d=identicon&r=PG", "display_name": "toraritte", "link": "https://stackoverflow.com/users/1498178/toraritte"}, "is_accepted": false, "score": 9, "last_activity_date": 1570392863, "creation_date": 1570392863, "answer_id": 58260886, "question_id": 58260885, "link": "https://stackoverflow.com/questions/58260885/how-to-find-a-haskell-function-based-on-its-type-signature/58260886#58260886", "title": "How to find a Haskell function based on its type signature?", "body": "<p>Use <a href=\"https://hoogle.haskell.org\" rel=\"noreferrer\">Hoogle</a> or <a href=\"https://www.stackage.org\" rel=\"noreferrer\">Stackage</a>. (See also <a href=\"https://stackoverflow.com/a/49291575/1498178\">related Stackoverflow answer</a>.)</p>\n\n<p><sup>As far as I know, Stackage uses Hoogle underneath, but one may find its representation easier to read.</sup></p>\n\n<p>Just type any type signature that would be acceptable by Haskell, and browse the results. </p>\n"}], "owner": {"reputation": 4004, "user_id": 1498178, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/2a7f53f1d991f2ab18a4957a1f192960?s=128&d=identicon&r=PG", "display_name": "toraritte", "link": "https://stackoverflow.com/users/1498178/toraritte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1570392863, "creation_date": 1570392863, "question_id": 58260885, "link": "https://stackoverflow.com/questions/58260885/how-to-find-a-haskell-function-based-on-its-type-signature", "title": "How to find a Haskell function based on its type signature?", "body": "<p>For example, I haven't used Haskell in a while, and forgot the name of the <code>const</code> function, but remembered that its type signature is <code>a -&gt; b -&gt; a</code>.</p>\n"}, {"tags": ["haskell", "palindrome"], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 12170465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae2b338af2c4181e1f5f06671cc06958?s=128&d=identicon&r=PG&f=1", "display_name": "Piamoon", "link": "https://stackoverflow.com/users/12170465/piamoon"}, "edited": false, "score": 0, "creation_date": 1570389832, "post_id": 58260471, "comment_id": 102889769, "body": "So, do you mean when I don&#39;t write (Eq a) =&gt; the compiler doesn&#39;t have any assumption about typeclass of a?"}, {"owner": {"reputation": 3706, "user_id": 2018455, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e75a41fc224930ef1fa9ddcc9c714174?s=128&d=identicon&r=PG", "display_name": "Neil Locketz", "link": "https://stackoverflow.com/users/2018455/neil-locketz"}, "reply_to_user": {"reputation": 85, "user_id": 12170465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae2b338af2c4181e1f5f06671cc06958?s=128&d=identicon&r=PG&f=1", "display_name": "Piamoon", "link": "https://stackoverflow.com/users/12170465/piamoon"}, "edited": false, "score": 0, "creation_date": 1570389898, "post_id": 58260471, "comment_id": 102889779, "body": "Correct. All it knows is there is some time <code>a</code>, it knows nothing else about the type. You need to tell it what is safe to assume. This is so it can enforce the required instance at the call site."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 85, "user_id": 12170465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae2b338af2c4181e1f5f06671cc06958?s=128&d=identicon&r=PG&f=1", "display_name": "Piamoon", "link": "https://stackoverflow.com/users/12170465/piamoon"}, "edited": false, "score": 2, "creation_date": 1570399542, "post_id": 58260471, "comment_id": 102891644, "body": "@Piamoon if you would&#39;ve omitted the type signature, GHC would&#39;ve inferred the correct type, with the constraint. But user-supplied signature takes precedence, and it disagrees (says there&#39;s no <code>Eq</code> constraint) with the inferred type (which says there must be the <code>Eq</code> constraint). Unable to follow your command, the compiler errors out. It assumes the user knew what they were doing supplying that signature."}], "tags": [], "owner": {"reputation": 3706, "user_id": 2018455, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e75a41fc224930ef1fa9ddcc9c714174?s=128&d=identicon&r=PG", "display_name": "Neil Locketz", "link": "https://stackoverflow.com/users/2018455/neil-locketz"}, "is_accepted": true, "score": 6, "last_activity_date": 1570389798, "last_edit_date": 1570389798, "creation_date": 1570389222, "answer_id": 58260471, "question_id": 58260444, "link": "https://stackoverflow.com/questions/58260444/ispalindrome-function-in-haskell-gives-an-error/58260471#58260471", "title": "isPalindrome function in Haskell gives an error", "body": "<p>The problem is you need to constrain the polymorphic type <code>a</code>. Right now, the compiler has no information about the type, so it can't even know if <code>(==)</code> is defined for <code>a</code> (this is where the <code>No instance for (Eq a) arising from a use of ``=='</code> comes from. It is trying to infer an instance of <code>Eq</code> for <code>a</code>, but it is unable to. You need to help it along).</p>\n\n<p>You should make the type:</p>\n\n<pre><code>isPalindrome :: (Eq a) =&gt; [a] -&gt; Bool\n</code></pre>\n\n<p>Now you're telling it that <code>isPalindrome</code> can only be given lists of things that are instances of <code>Eq</code>.</p>\n\n<p>It points out this piece because your are trying to compare two <code>a</code>'s for equality:</p>\n\n<pre><code>(head xs) == (last xs)\n</code></pre>\n\n<p>A little bit about the error message:</p>\n\n<pre><code> Possible fix:\n    add (Eq a) to the context of\n      the type signature for:\n        isPalindrome :: forall a. [a] -&gt; Bool\n</code></pre>\n\n<p>The stuff before the <code>=&gt;</code> in my suggestion is called the context, and it is where you can add constraints to your types. The suggestion here is telling you to do exactly what I said above (albeit in a much more verbose way).</p>\n"}, {"tags": [], "owner": {"reputation": 75, "user_id": 4428059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7b75f971b6dd0e4a4c68035ecb79e9a?s=128&d=identicon&r=PG&f=1", "display_name": "cealex", "link": "https://stackoverflow.com/users/4428059/cealex"}, "is_accepted": false, "score": 0, "last_activity_date": 1606473477, "creation_date": 1606473477, "answer_id": 65035895, "question_id": 58260444, "link": "https://stackoverflow.com/questions/58260444/ispalindrome-function-in-haskell-gives-an-error/65035895#65035895", "title": "isPalindrome function in Haskell gives an error", "body": "<pre><code>import Data.List\n\nisPalindrome :: (Eq a) =&gt; [a] -&gt; Bool\nisPalindrome [] = True\nisPalindrome [x] = True\nisPalindrome xs    \n                | (head xs /= head (reverse xs)) = False\n                | otherwise = isPalindrome ( tail (init xs) )\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 12170465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ae2b338af2c4181e1f5f06671cc06958?s=128&d=identicon&r=PG&f=1", "display_name": "Piamoon", "link": "https://stackoverflow.com/users/12170465/piamoon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 250, "favorite_count": 0, "accepted_answer_id": 58260471, "answer_count": 2, "score": 3, "last_activity_date": 1606473477, "creation_date": 1570389038, "question_id": 58260444, "link": "https://stackoverflow.com/questions/58260444/ispalindrome-function-in-haskell-gives-an-error", "title": "isPalindrome function in Haskell gives an error", "body": "<p>I was trying to write a program that checks whether a list is palindrome and returns Bool.</p>\n\n<pre><code>isPalindrome :: [a] -&gt; Bool\nisPalindrome [] = True\nisPalindrome [x] = True\nisPalindrome xs | (head xs) == (last xs) = isPalindrome (init(tail xs))\n                | otherwise = False\n</code></pre>\n\n<p>And I recieved an error message like this:</p>\n\n<pre><code>problem6.hs:4:19: error:\n    * No instance for (Eq a) arising from a use of `=='\n      Possible fix:\n        add (Eq a) to the context of\n          the type signature for:\n            isPalindrome :: forall a. [a] -&gt; Bool\n    * In the expression: (head xs) == (last xs)\n      In a stmt of a pattern guard for\n                     an equation for `isPalindrome':\n        (head xs) == (last xs)\n      In an equation for `isPalindrome':\n          isPalindrome xs\n            | (head xs) == (last xs) = isPalindrome (init (tail xs))\n            | otherwise = False\n  |\n4 | isPalindrome xs | (head xs) == (last xs) = isPalindrome (init(tail xs))\n  |                   ^^^^^^^^^^^^^^^^^^^^^^\nFailed, no modules loaded.\n</code></pre>\n\n<p>Because I am not very experienced, I don't understand a thing from error message. So I don't see where the mistake is in my code. Thanks for helping.</p>\n"}, {"tags": ["shell", "haskell", "record", "read-eval-print-loop"], "answers": [{"tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": true, "score": 3, "last_activity_date": 1570385980, "last_edit_date": 1570385980, "creation_date": 1570385352, "answer_id": 58260009, "question_id": 58259919, "link": "https://stackoverflow.com/questions/58259919/repl-error-when-modifying-record-arguments/58260009#58260009", "title": "REPL error when modifying record arguments", "body": "<p>You have two problems in your code.</p>\n\n<ol>\n<li><code>cwd</code> has type <code>Maybe String</code>, not just <code>String</code>, you need to use the <code>Just</code> constructor explicitly.</li>\n<li>By default <code>{}</code> are attached to the closest argument, in this case, this is the <code>\"cwd\"</code> string. However, you want to specify a field of the function call result.</li>\n</ol>\n\n<p>Writing your code like this works for me:</p>\n\n<pre><code>ghci&gt; (shell \"cwd\") { cwd = Just \"/home\" }\nCreateProcess \n    { cmdspec = ShellCommand \"cwd\" \n    , cwd = Just \"/home\" \n    , env = Nothing\n    , std_in = Inherit\n    , std_out = Inherit\n    , std_err = Inherit\n    , close_fds = False\n    , create_group = False\n    , delegate_ctlc = False\n    , detach_console = False\n    , create_new_console = False\n    , new_session = False\n    , child_group = Nothing\n    , child_user = Nothing\n    , use_process_jobs = False\n    } \n</code></pre>\n"}], "owner": {"reputation": 5821, "user_id": 1770201, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/46bcb5d2018194c9beb884b6797e57e0?s=128&d=identicon&r=PG", "display_name": "George", "link": "https://stackoverflow.com/users/1770201/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18, "favorite_count": 0, "accepted_answer_id": 58260009, "answer_count": 1, "score": 1, "last_activity_date": 1570385980, "creation_date": 1570384678, "last_edit_date": 1570385229, "question_id": 58259919, "link": "https://stackoverflow.com/questions/58259919/repl-error-when-modifying-record-arguments", "title": "REPL error when modifying record arguments", "body": "<p>Consider <code>shell :: String -&gt; CreateProcess</code>. For example:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>Prelude System.IO System.Process&gt; shell \"pwd\"\nCreateProcess {cmdspec = ShellCommand \"pwd\", cwd = Nothing, env = Nothing, std_in = Inherit, std_out = Inherit, std_err = Inherit, close_fds = False, create_group = False, delegate_ctlc = False, detach_console = False, create_new_console = False, new_session = False, child_group = Nothing, child_user = Nothing, use_process_jobs = False}\n</code></pre>\n\n<p>I'm trying to modify the record arguments of <code>CreateProcess</code>, but am getting a REPL error:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>Prelude System.IO System.Process&gt; shell \"pwd\" { cwd = \"/home\" }\n\n&lt;interactive&gt;:7:7: error:\n    \u2022 Couldn't match type \u2018CreateProcess\u2019 with \u2018[Char]\u2019\n      Expected type: String\n        Actual type: CreateProcess\n    \u2022 In the first argument of \u2018shell\u2019, namely \u2018\"pwd\" {cwd = \"/home\"}\u2019\n      In the expression: shell \"pwd\" {cwd = \"/home\"}\n      In an equation for \u2018it\u2019: it = shell \"pwd\" {cwd = \"/home\"}\n\n&lt;interactive&gt;:7:21: error:\n    \u2022 Couldn't match expected type \u2018Maybe FilePath\u2019\n                  with actual type \u2018[Char]\u2019\n    \u2022 In the \u2018cwd\u2019 field of a record\n      In the first argument of \u2018shell\u2019, namely \u2018\"pwd\" {cwd = \"/home\"}\u2019\n      In the expression: shell \"pwd\" {cwd = \"/home\"}\n</code></pre>\n"}, {"tags": ["shell", "haskell", "cabal", "haskell-stack"], "answers": [{"tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": true, "score": 1, "last_activity_date": 1570385598, "creation_date": 1570385598, "answer_id": 58260051, "question_id": 58259602, "link": "https://stackoverflow.com/questions/58259602/stack-install-curl-fails/58260051#58260051", "title": "stack install curl fails", "body": "<p>As the error message you got says, \"This problem can usually be solved by installing the system package that provides this library (you may need the \"-dev\" version)\". In your case, you need a <code>libcurl-dev</code> package. Depending on your preferred TLS library, run one of <code>sudo apt-get install libcurl4-openssl-dev</code>, <code>sudo apt-get install libcurl4-nss-dev</code>, or <code>sudo apt-get install libcurl4-gnutls-dev</code>.</p>\n"}], "owner": {"reputation": 2352, "user_id": 4518180, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/HQeHB.png?s=128&g=1", "display_name": "mkUltra", "link": "https://stackoverflow.com/users/4518180/mkultra"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 289, "favorite_count": 0, "accepted_answer_id": 58260051, "answer_count": 1, "score": 2, "last_activity_date": 1570400496, "creation_date": 1570382344, "last_edit_date": 1570400496, "question_id": 58259602, "link": "https://stackoverflow.com/questions/58259602/stack-install-curl-fails", "title": "stack install curl fails", "body": "<p>I am trying to install curl via <a href=\"/questions/tagged/stack\" class=\"post-tag\" title=\"show questions tagged &#39;stack&#39;\" rel=\"tag\">stack</a> using <code>stack install curl-1.3.8 -v</code>, and I am stuck with the following error:</p>\n\n<pre><code>2019-10-06 19:01:22.673216: [info] curl&gt; Configuring curl-1.3.8...\n2019-10-06 19:01:22.910469: [warn] curl&gt; setup: Missing dependency on a foreign library:\n2019-10-06 19:01:22.910594: [warn] curl&gt; * Missing (or bad) C library: curl\n2019-10-06 19:01:22.910679: [warn] curl&gt; This problem can usually be solved by installing the system package that\n2019-10-06 19:01:22.910776: [warn] curl&gt; provides this library (you may need the \"-dev\" version). If the library is\n2019-10-06 19:01:22.910892: [warn] curl&gt; already installed but in a non-standard location then you can use the flags\n2019-10-06 19:01:22.910970: [warn] curl&gt; --extra-include-dirs= and --extra-lib-dirs= to specify where it is.If the\n2019-10-06 19:01:22.911056: [warn] curl&gt; library file does exist, it may contain errors that are caught by the C\n2019-10-06 19:01:22.911192: [warn] curl&gt; compiler at the preprocessing stage. In this case you can re-run configure\n2019-10-06 19:01:22.911261: [warn] curl&gt; with the verbosity flag -v3 to see the error messages.\n2019-10-06 19:01:22.911335: [warn] curl&gt; \n2019-10-06 19:01:22.918187: [error] \n--  While building package curl-1.3.8 using:\n      /tmp/stack13678/curl-1.3.8/.stack-work/dist/x86_64-linux/Cabal-\n2.2.0.1/setup/setup --builddir=.stack-work/dist/x86_64-linux/Cabal-2.2.0.1 \nconfigure --user --package-db=clear --package-db=global --package-db=/home\n/mkultra/.stack/snapshots/x86_64-\nlinux/275af25936ba6904cf7ea80d2b338c41bfce558acfce69b4ef46c0a85fc0b78b  /8.4.3\n/pkgdb --libdir=/home/mkultra/.stack/snapshots/x86_64-\nlinux/275af25936ba6904cf7ea80d2b338c41bfce558acfce69b4ef46c0a85fc0b78b\n/8.4.3/lib --bindir=/home/mkultra/.stack/snapshots/x86_64-\nlinux/275af25936ba6904cf7ea80d2b338c41bfce558acfce69b4ef46c0a85fc0b78b\n/8.4.3/bin --datadir=/home/mkultra/.stack/snapshots/x86_64-\nlinux/275af25936ba6904cf7ea80d2b338c41bfce558acfce69b4ef46c0a85fc0b78b   /8.4.3\n/share --libexecdir=/home/mkultra/.stack/snapshots/x86_64-\nlinux/275af25936ba6904cf7ea80d2b338c41bfce558acfce69b4ef46c0a85fc0b78b/8.4.3\n/libexec --sysconfdir=/home/mkultra/.stack/snapshots/x86_64-\nlinux/275af25936ba6904cf7ea80d2b338c41bfce558acfce69b4ef46c0a85fc0b78b\n/8.4.3/etc --docdir=/home/mkultra/.stack/snapshots/x86_64-\nlinux/275af25936ba6904cf7ea80d2b338c41bfce558acfce69b4ef46c0a85fc0b78b  /8.4.3\n/doc/curl-1.3.8 --htmldir=/home/mkultra/.stack/snapshots/x86_64-\nlinux/275af25936ba6904cf7ea80d2b338c41bfce558acfce69b4ef46c0a85fc0b78b/8.4.3\n/doc/curl-1.3.8 --haddockdir=/home/mkultra/.stack/snapshots/x86_64-\nlinux/275af25936ba6904cf7ea80d2b338c41bfce558acfce69b4ef46c0a85fc0b78b/8.4.3\n/doc/curl-1.3.8 --dependency=base=base-4.11.1.0 \n--dependency=bytestring=bytestring-0.10.8.2 \n--dependency=containers=containers-0.5.11.0 -fnew-base --exact-configuration\n--ghc-option=-fhide-source-paths\n\n    Process exited with code: ExitFailure 1\n</code></pre>\n\n<p>Any idea how can I fix it?</p>\n\n<pre><code>Stack version: 2.1.3\nDescription:    Ubuntu 19.04\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "pattern-matching", "conditional-statements"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1570382762, "post_id": 58259575, "comment_id": 102887938, "body": "What is the answer you came across?"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 6, "creation_date": 1570383144, "post_id": 58259575, "comment_id": 102888042, "body": "<a href=\"http://www.vex.net/~trebla/haskell/crossroad.xhtml\" rel=\"nofollow noreferrer\">A Crossroad at A Branch</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user12173013"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 1, "creation_date": 1570387256, "post_id": 58259575, "comment_id": 102889147, "body": "@DanielWagner Thanks! V. nice link"}, {"owner": {"user_type": "does_not_exist", "display_name": "user12173013"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1570387367, "post_id": 58259575, "comment_id": 102889173, "body": "@WillemVanOnsem I cannot find the exact link I referred to in my qu, but I&#39;d also looked at: <a href=\"https://www.reddit.com/r/elixir/comments/34jyto/what_are_the_benefits_of_pattern_matching_as/\" rel=\"nofollow noreferrer\">reddit.com/r/elixir/comments/34jyto/&hellip;</a>"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1570388655, "post_id": 58259575, "comment_id": 102889501, "body": "I also recommend to read about <a href=\"https://existentialtype.wordpress.com/2011/03/15/boolean-blindness/\" rel=\"nofollow noreferrer\">boolean blindness</a>."}], "answers": [{"tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 10, "last_activity_date": 1571165353, "last_edit_date": 1571165353, "creation_date": 1570384806, "answer_id": 58259933, "question_id": 58259575, "link": "https://stackoverflow.com/questions/58259575/what-are-advantages-of-pattern-matching-over-conditionals-in-fp-in-laymans-ter/58259933#58259933", "title": "What are advantages of pattern matching over conditionals in FP (in layman&#39;s terms)?", "body": "<p>One of the most useful aspects of using pattern matching instead of conditionals is to allow APIs involving only <em>total</em> operations, i.e. operations which never cause runtime exceptions / errors.</p>\n\n<p>Consider this code, exploiting an hypothetical function <code>runOperationOn</code>, returning <code>Maybe String</code>. </p>\n\n<pre><code>case runOperationOn someData of\n   Just res -&gt; putStrLn (\"The operation was successful: \" ++ res)\n   Nothing  -&gt; putStrLn \"The operation failed!\"\n</code></pre>\n\n<p>Here, pattern matching allows to check whether the operation succeeded and get the result on success, <em>at the same time</em>. The last part is crucial. Using booleans, we would need to use something like:</p>\n\n<pre><code>if canRunOperationOn someData\nthen putStrLn (\"The operation was successful: \" ++ doRunOperationOn someData)\nelse putStrLn \"The operation failed!\"\n</code></pre>\n\n<p>This looks similar, but it has significant drawbacks compared to pattern matching:</p>\n\n<ul>\n<li>It splits the functionality into two functions: one to check if we can perform the operation, and one to actually do it.</li>\n<li>It involves a <em>partial</em> function <code>doRunOperationOn</code> which returns a <code>String</code>, but will crash on invalid inputs. </li>\n</ul>\n\n<p>The latter is quite bad, since it puts some burden on the programmer, who has to remember to ask \"can I?\", or risk a crash.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user12173013"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 145, "favorite_count": 4, "accepted_answer_id": 58259933, "answer_count": 1, "score": 4, "last_activity_date": 1571165353, "creation_date": 1570382126, "last_edit_date": 1570384592, "question_id": 58259575, "link": "https://stackoverflow.com/questions/58259575/what-are-advantages-of-pattern-matching-over-conditionals-in-fp-in-laymans-ter", "title": "What are advantages of pattern matching over conditionals in FP (in layman&#39;s terms)?", "body": "<p>In <strong>layman's terms</strong>, what exactly are the benefits of pattern matching, other than historical reasons? The answers I came across are mostly beyond my level (e.g I don't understand what heap allocation has to do with this).</p>\n\n<p>I have a background in Python, only recently picking up Haskell again. </p>\n\n<p>So I had a hard time understanding other answers given in the context of other languages.</p>\n"}, {"tags": ["haskell"], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 2, "last_activity_date": 1570379496, "creation_date": 1570379496, "answer_id": 58259220, "question_id": 58259119, "link": "https://stackoverflow.com/questions/58259119/how-to-use-map-with-a-regular-expression-in-haskell/58259220#58259220", "title": "How to use map with a regular expression in Haskell", "body": "<p>You are quite close. The only problem is that your type signature will generate some trouble here. The type of <code>(=~ rexExp)</code> you want is probably <code>String -&gt; String</code>. Indeed the type of the mapping function is a function that takes a <code>String</code> as parameter, and returns a <code>String</code> here. Not a <code>String</code> itself.</p>\n\n<p>We can thus create a <code>map</code> with:</p>\n\n<pre><code>result = map ((=~ regExp) :: <b>String -&gt; String</b>) test</code></pre>\n\n<p>This produces:</p>\n\n<pre><code>Prelude Text.Regex.TDFA&gt; map ((=~ regExp) :: String -&gt; String) test\n[\"&gt;The CrisCom Company&lt;/\",\"&gt;2013&lt;/\"]\n</code></pre>\n\n<p>That being said, I strongly advice <em>not</em> to parse HTML, XML, JSON, etc. with a regex. Indeed <a href=\"https://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454#1732454\"><em>regexes can not parse HTML</em></a> and other recursive languages. This is the consequence of the <a href=\"https://en.wikipedia.org/wiki/Pumping_lemma_for_regular_languages\" rel=\"nofollow noreferrer\"><em>Pumping lemma for regular languages</em> [wiki]</a>. You can never <em>fully</em> parse HTML. You might indeed parse some sublanguages, etc. But even then the regex will easily get (very) complicated. You therefore better use a library like <a href=\"http://hackage.haskell.org/package/tagsoup\" rel=\"nofollow noreferrer\"><strong><code>tagsoup</code></strong> [hackage]</a>, or a scraper library like <a href=\"http://hackage.haskell.org/package/scalpel\" rel=\"nofollow noreferrer\"><strong><code>scalpel</code></strong> [hackage]</a>.</p>\n"}], "owner": {"reputation": 41, "user_id": 11979580, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mBD6Sbct7-uBduiZObtwAlFzRmExJHma2owThSVug=k-s128", "display_name": "VALENTINA YUSTY MOSQUERA", "link": "https://stackoverflow.com/users/11979580/valentina-yusty-mosquera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 58259220, "answer_count": 1, "score": 3, "last_activity_date": 1570379496, "creation_date": 1570378731, "question_id": 58259119, "link": "https://stackoverflow.com/questions/58259119/how-to-use-map-with-a-regular-expression-in-haskell", "title": "How to use map with a regular expression in Haskell", "body": "<p>While trying to apply the regular expression below to each element in a list (test), I get an error. This is what I am trying to do in ghci</p>\n\n<pre><code>import Text.Regex.TDFA\nlet test = [\"&lt;lobbying_firm&gt;The CrisCom Company&lt;/lobbying_firm&gt;\",\"&lt;registration_year&gt;2013&lt;/registration_year&gt;\"]\nlet regExp = \"\\\\&gt;(.)*\\\\&lt;\"\nlet result = map (=~ regExp :: String) test\n</code></pre>\n\n<p>How can I do this? Any ideas?</p>\n"}, {"tags": ["haskell", "syntax", "list-comprehension", "primes", "guard-clause"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 12172435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37183b06fec9bba7a98032fc77bbc556?s=128&d=identicon&r=PG&f=1", "display_name": "aralk", "link": "https://stackoverflow.com/users/12172435/aralk"}, "edited": false, "score": 0, "creation_date": 1570376053, "post_id": 58258271, "comment_id": 102886174, "body": "Thank you for your help. Where would you put all?"}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 4, "last_activity_date": 1570372403, "creation_date": 1570372403, "answer_id": 58258271, "question_id": 58257935, "link": "https://stackoverflow.com/questions/58257935/parse-error-with-my-haskell-function-to-identify-if-a-number-is-prime/58258271#58258271", "title": "Parse error with my haskell function to identify if a number is prime", "body": "<p>List comprehensions are different in Haskell than they are in Python. Instead of <code>expr for var in list</code>, it's <code>[expr | var &lt;- list]</code>. Also, you need an <code>all</code> to make it verify they're all true. Further, <code>floor x^0.5</code> will parse as <code>(floor x)^0.5</code>, which you don't want. Use parentheses to fix it. Finally, to raise something to a non-integer power, you need to use <code>**</code> instead of <code>^</code>, but this will introduce complexity you don't want, so just use <code>sqrt</code> instead.</p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1570373772, "creation_date": 1570373772, "answer_id": 58258454, "question_id": 58257935, "link": "https://stackoverflow.com/questions/58257935/parse-error-with-my-haskell-function-to-identify-if-a-number-is-prime/58258454#58258454", "title": "Parse error with my haskell function to identify if a number is prime", "body": "<p>The condition <code>x `mod` y == 0 for y in [2, 3 .. floor x^0.5]</code> is not syntactically valid in Haskell. Haskell for example has no <code>for</code> keyword. Furthermore even in Python the above would not work, since then you are constructing a <em>generator</em>.</p>\n\n<p>You can make use of <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:all\" rel=\"nofollow noreferrer\"><strong><code>all :: Foldable f =&gt; (a -&gt; Bool) -&gt; f a -&gt; Bool</code></strong></a> to check if <code>x</code> is not dividable by all values in a list. That list is then a list <code>[ 2 .. &radic;x ]</code>.</p>\n\n<p>Working with <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:-94-\" rel=\"nofollow noreferrer\"><strong><code>(^) :: (Num a, Integral b) =&gt; a -&gt; b -&gt; a</code></strong></a> will not work, since the exponent should be of a type that is a member of the <code>Integral</code> typeclass. If we make use of <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:-42--42-\" rel=\"nofollow noreferrer\"><strong><code>(**) :: Floating a =&gt; a -&gt; a -&gt; a</code></strong></a> the first operand should be of a type that is a member of the <code>Floating</code> typeclass. We can convert <code>Int</code>s to a <code>Float</code>, but that is usually not very safe, since there can be rounding errors.</p>\n\n<p>It therefore might be better to make use of <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:takeWhile\" rel=\"nofollow noreferrer\"><strong><code>takeWhile :: (a -&gt; Bool) -&gt; [a] -&gt; [a]</code></strong></a> to take elements, as long as a certain condition holds. So we can here check with:</p>\n\n<pre><code>Prelude&gt; takeWhile (\\y -&gt; y*y &lt;= 20) [2 ..]\n[2,3,4]\n</code></pre>\n\n<p>So we can implement the prime checker as:</p>\n\n<pre><code>isPrime :: Int -&gt; Bool\nisPrime x\n   | x &lt;= 1 = False\n   | otherwise = all ((/=) 0 . mod x) (takeWhile (\\y -&gt; y*y &lt;= x) [2 .. ])</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 12172435, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37183b06fec9bba7a98032fc77bbc556?s=128&d=identicon&r=PG&f=1", "display_name": "aralk", "link": "https://stackoverflow.com/users/12172435/aralk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 89, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1570380386, "creation_date": 1570370110, "last_edit_date": 1570380386, "question_id": 58257935, "link": "https://stackoverflow.com/questions/58257935/parse-error-with-my-haskell-function-to-identify-if-a-number-is-prime", "title": "Parse error with my haskell function to identify if a number is prime", "body": "<p>I am a beginner with Haskell and I can't seem to understand what is wrong with my function. I keep getting a parse error and I don't understand what is wrong with my code.</p>\n\n<pre><code>isPrime :: Int -&gt; Bool \nisPrime x\n   | x &lt;= 1 = False\n   | x `mod` y == 0 for y in [2, 3 .. floor x^0.5] = False\n   | otherwise = True\n</code></pre>\n"}, {"tags": ["haskell", "functional-programming", "purely-functional"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 4, "creation_date": 1570361406, "post_id": 58256726, "comment_id": 102882596, "body": "You can&#39;t, not if it&#39;s simply an <code>Integer</code>. That&#39;s part of what &quot;purely functional&quot; means. There are ways to have a mutable variable in Haskell but then the type system needs to warn users of the potential mutability - a &quot;pure type&quot; such as <code>Integer</code> is strictly immutable."}, {"owner": {"reputation": 3248, "user_id": 5707684, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/wrGFn.jpg?s=128&g=1", "display_name": "Elmex80s", "link": "https://stackoverflow.com/users/5707684/elmex80s"}, "edited": false, "score": 0, "creation_date": 1570405583, "post_id": 58256726, "comment_id": 102892588, "body": "You can use <code>succ</code> instead of <code>f</code>."}], "answers": [{"comments": [{"owner": {"reputation": 19, "user_id": 10894861, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-B4Srb-t58No/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcawejy-wDgz8n3SCBoNJ-yfsKA1Jg/mo/photo.jpg?sz=128", "display_name": "Lellson", "link": "https://stackoverflow.com/users/10894861/lellson"}, "edited": false, "score": 0, "creation_date": 1570366823, "post_id": 58257200, "comment_id": 102883737, "body": "The task says: &quot;Consider an extension of Haskell by a single non-pure constant <code>next_nat :: Integer</code>, which on first evaluation results in 0, then results in 1, in 2, etc&quot;. For me it is contradictory too, because constants should be immutable. Any idea what that means?"}, {"owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "reply_to_user": {"reputation": 19, "user_id": 10894861, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-B4Srb-t58No/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcawejy-wDgz8n3SCBoNJ-yfsKA1Jg/mo/photo.jpg?sz=128", "display_name": "Lellson", "link": "https://stackoverflow.com/users/10894861/lellson"}, "edited": false, "score": 0, "creation_date": 1570366954, "post_id": 58257200, "comment_id": 102883765, "body": "@Felix: it is a variable sort of constant then :-) No, formally this has to be an IO action returning an Integer value. It  <b>cannot</b> be called a constant, I agree with the other commenters on that point. The language used is faulty. If the type is really Integer, it will always be the same value."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "reply_to_user": {"reputation": 19, "user_id": 10894861, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-B4Srb-t58No/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcawejy-wDgz8n3SCBoNJ-yfsKA1Jg/mo/photo.jpg?sz=128", "display_name": "Lellson", "link": "https://stackoverflow.com/users/10894861/lellson"}, "edited": false, "score": 1, "creation_date": 1570367025, "post_id": 58257200, "comment_id": 102883786, "body": "@FelixErlacher some wider context would be helpful, but to me the phrase &quot;consider...&quot; makes it clear that it&#39;s talking about a hypothetical (not actually existing) &quot;extension&quot; of Haskell which would allow you to do this. I presume to then point out how this would break a lot of the things Haskell relies on - but as I said, the context is missing."}, {"owner": {"reputation": 19, "user_id": 10894861, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-B4Srb-t58No/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcawejy-wDgz8n3SCBoNJ-yfsKA1Jg/mo/photo.jpg?sz=128", "display_name": "Lellson", "link": "https://stackoverflow.com/users/10894861/lellson"}, "edited": false, "score": 0, "creation_date": 1570367329, "post_id": 58257200, "comment_id": 102883869, "body": "Ok then I probably don&#39;t even understand the task... This is the rest of the task description: &quot;Define a single pure Haskell function f in a script, i.e., in the script next_nat must not appear, such that the evaluation of the expression f next_nat evaluates to at least three different values, depending on whether one uses call-by-value, call-by-name, left-to-right argument evaluation or right-to-left argument evaluation.&quot; Any idea?"}, {"owner": {"reputation": 19, "user_id": 10894861, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-B4Srb-t58No/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcawejy-wDgz8n3SCBoNJ-yfsKA1Jg/mo/photo.jpg?sz=128", "display_name": "Lellson", "link": "https://stackoverflow.com/users/10894861/lellson"}, "edited": false, "score": 0, "creation_date": 1570367470, "post_id": 58257200, "comment_id": 102883911, "body": "I know about call-by-name, call-by-value. But not much about the pure haskell function stuff in combination with this task."}, {"owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "reply_to_user": {"reputation": 19, "user_id": 10894861, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-B4Srb-t58No/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcawejy-wDgz8n3SCBoNJ-yfsKA1Jg/mo/photo.jpg?sz=128", "display_name": "Lellson", "link": "https://stackoverflow.com/users/10894861/lellson"}, "edited": false, "score": 0, "creation_date": 1570370302, "post_id": 58257200, "comment_id": 102884639, "body": "@Felix It is obscure for me too. You might start by asking to the powers that be how comes left-to-right versus right-to-left evaluation can be relevant if f has a single argument, and also what is the accepted set of types for f."}, {"owner": {"reputation": 19, "user_id": 10894861, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-B4Srb-t58No/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcawejy-wDgz8n3SCBoNJ-yfsKA1Jg/mo/photo.jpg?sz=128", "display_name": "Lellson", "link": "https://stackoverflow.com/users/10894861/lellson"}, "edited": false, "score": 0, "creation_date": 1570370354, "post_id": 58257200, "comment_id": 102884650, "body": "I think i found a solution:  <code>f :: Integer -&gt; Integer f x = do     let unused_var = x     (x - 1 + 1)</code>  This should be the results: call-by-value: 1 call-by-name: 0 left-to-right: 1 or 0 (depending on call-by-value or call-by-name is used) right-to-left: -1 or -2 (depending on call-by-value or call-by-name is used).  Is this correct?"}, {"owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "reply_to_user": {"reputation": 19, "user_id": 10894861, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-B4Srb-t58No/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcawejy-wDgz8n3SCBoNJ-yfsKA1Jg/mo/photo.jpg?sz=128", "display_name": "Lellson", "link": "https://stackoverflow.com/users/10894861/lellson"}, "edited": false, "score": 0, "creation_date": 1570372117, "post_id": 58257200, "comment_id": 102885123, "body": "@Felix At this point I think you would be better off just asking a <b>new</b> SO question, this time about <b>f</b> not next_nat. That might attract answers from Haskell people who have suffered thru this kind of rather theoretical exercises before."}], "tags": [], "owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "is_accepted": false, "score": 2, "last_activity_date": 1570388487, "last_edit_date": 1570388487, "creation_date": 1570364687, "answer_id": 58257200, "question_id": 58256726, "link": "https://stackoverflow.com/questions/58256726/non-pure-constant-which-increases-by-1-for-each-evaluation/58257200#58257200", "title": "non-pure constant which increases by 1 for each evaluation", "body": "<p>Welcome to Stackoverflow. Unfortunately, what you are asking for is a bit contradictory. As mentioned by Robin, if the type is Integer, the value will always be the same in Haskell.</p>\n\n<p>As you say the answer has to be \"<em>non-pure</em>\", a possible solution is to involve the IO monad. That is, you would have to house your mutable entity in the \"external world\", that is the IO monad as far as the Haskell runtime is concerned.</p>\n\n<p>Something like this:</p>\n\n<pre><code>$ ghci\nGHCi, version 8.2.2: http://www.haskell.org/ghc/  :? for help\nPrelude&gt; \nPrelude&gt; import Data.IORef\nPrelude Data.IORef&gt; mv &lt;- newIORef ((0)::Integer)\nPrelude Data.IORef&gt; let next_nat = do { val &lt;- readIORef mv ; modifyIORef' mv (\\x -&gt; 1+x) ; return val ; }\nPrelude Data.IORef&gt; \nPrelude Data.IORef&gt; next_nat\n0\nPrelude Data.IORef&gt; next_nat\n1\nPrelude Data.IORef&gt; next_nat\n2\nPrelude Data.IORef&gt; next_nat\n3\nPrelude Data.IORef&gt; \n</code></pre>\n\n<p>More details in the <a href=\"http://hackage.haskell.org/package/base-4.12.0.0/docs/Data-IORef.html\" rel=\"nofollow noreferrer\">Data.IORef</a> documentation.</p>\n\n<p>Typing infos:</p>\n\n<pre><code>Prelude Data.IORef&gt; :t mv\nmv :: IORef Integer\nPrelude Data.IORef&gt; :t next_nat\nnext_nat :: IO Integer\nPrelude Data.IORef&gt; \n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 10894861, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-B4Srb-t58No/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcawejy-wDgz8n3SCBoNJ-yfsKA1Jg/mo/photo.jpg?sz=128", "display_name": "Lellson", "link": "https://stackoverflow.com/users/10894861/lellson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 214, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1570388487, "creation_date": 1570360754, "question_id": 58256726, "link": "https://stackoverflow.com/questions/58256726/non-pure-constant-which-increases-by-1-for-each-evaluation", "title": "non-pure constant which increases by 1 for each evaluation", "body": "<p>I'm very new to Haskell and trying to understand the basics of functional programming. I need to create a non-pure constant <code>next_nat :: Integer</code> which on first evaluation results in <code>0</code> and then increases by <code>1</code> for each evaluation. I then also need to call this as a parameter on a pure function <code>f</code> like <code>f next_nat</code> and check the result depending on argument evaluation.</p>\n\n<p>I'm not sure how to do this. How can I increase it for each evaluation? Do I need other variables for this task? I only came up with this at the moment:</p>\n\n<pre><code>next_nat :: Integer\nnext_nat = 0\n\nf :: Integer -&gt; Integer\nf x = x+1\n</code></pre>\n\n<p>I don't think this is right in this way..</p>\n"}, {"tags": ["haskell", "opengl", "glsl"], "answers": [{"tags": [], "owner": {"reputation": 29, "user_id": 12171571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd5cf36ca4fb39087fd1d1625668fef?s=128&d=identicon&r=PG&f=1", "display_name": "Sonny Jansson", "link": "https://stackoverflow.com/users/12171571/sonny-jansson"}, "is_accepted": false, "score": 1, "last_activity_date": 1570373504, "creation_date": 1570373504, "answer_id": 58258421, "question_id": 58255751, "link": "https://stackoverflow.com/questions/58255751/shader-fails-to-compile-without-error-message-haskell-opengl-bindings/58258421#58258421", "title": "Shader fails to compile without error message (Haskell OpenGL bindings)", "body": "<p>I finally found the problem. I tried to compile the shaders and make the program before I had actually done some other initialisation, which is what caused the error. I am now compiling the shaders and linking the program after setting up the window and specifying various OpenGL options.</p>\n"}], "owner": {"reputation": 29, "user_id": 12171571, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8fd5cf36ca4fb39087fd1d1625668fef?s=128&d=identicon&r=PG&f=1", "display_name": "Sonny Jansson", "link": "https://stackoverflow.com/users/12171571/sonny-jansson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1570373504, "creation_date": 1570352499, "question_id": 58255751, "link": "https://stackoverflow.com/questions/58255751/shader-fails-to-compile-without-error-message-haskell-opengl-bindings", "title": "Shader fails to compile without error message (Haskell OpenGL bindings)", "body": "<p>I am trying to draw a sphere using the Haskell GLUT and OpenGL bindings (essentially a direct translation of the normal OpenGL types and functions). I followed <a href=\"https://github.com/haskell-opengl/GLUT/blob/master/examples/Misc/ColorTriangle/ColorTriangle.hs\" rel=\"nofollow noreferrer\">an example</a> written by Sven Panne (the author of the OpenGL bindings) when writing the code, and since his <a href=\"https://github.com/haskell-opengl/GLUT/blob/master/examples/RedBook8/common/LoadShaders.hs\" rel=\"nofollow noreferrer\">shader loading code</a> supported error logging, I just decided to copy it over to my project. However, when I try to compile my vertex shader, compilation  fails with the message \"user error (compile log: )\" and no actual compile log. </p>\n\n<p>I tried running Sven Panne's triangle example on its own to make sure that there was no problem with the library or with my version of OpenGL, and it worked flawlessly. I have copy-pasted other people's shaders and tried to compile them with little success. I have made sure that the program is able to actually open the shader file and read the source code, by printing it to console.</p>\n\n<p>My vertex shader looks like so:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#version 430 core\n\nlayout(location = 0) in vec3 vPosition;\n\nout vec4 color;\n\nvoid main()\n{\n   gl_Position = vec4(vPosition, 1.0);\n   color = vec4(1.0f, 0.5f, 0.2f, 1.0f);\n}\n</code></pre>\n\n<p>and if anyone is curious, my fragment shader looks like:</p>\n\n<pre class=\"lang-c prettyprint-override\"><code>#version 430 core\n\nin vec4 color;\nout vec4 fColor;\n\nvoid main()\n{\n   fColor = color;\n}\n</code></pre>\n\n<p>and if anyone is interested to see the rest of my code, it is uploaded on <a href=\"https://github.com/SonnyJansson/EEStuff/blob/master/src/Main.hs\" rel=\"nofollow noreferrer\">Github</a> (sorry about the mess, but I have been trying to debug this for some time now).</p>\n"}, {"tags": ["parsing", "haskell", "abstract-syntax-tree", "pretty-print"], "comments": [{"owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "edited": false, "score": 1, "creation_date": 1570356581, "post_id": 58255700, "comment_id": 102881498, "body": "Forgot to say, <code>showw ast = prettyPrintAST 3 0 ast</code>"}, {"owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "edited": false, "score": 1, "creation_date": 1570357264, "post_id": 58255700, "comment_id": 102881643, "body": "Perhaps you could use an auxiliary recursive printing function that takes current indentation depth as an extra parameter ? Like: <code>prettyPrintAST :: Int -&gt; Int -&gt; Ast -&gt; String</code> and then recursively, for example: <code>prettyPrintAST indentStep indentLevel (Sum ast1 ast2) = (blanks indentLevel) ++ &quot;Sum\\n&quot; ++ prettyPrintAST indentStep (indentLevel+indentStep) ast1 ++ prettyPrintAST indentStep (indentLevel+indentStep) ast2</code> And something similar for the remaining operations."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 13349883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c354cab44ffd6c68ba23c28320bced55?s=128&d=identicon&r=PG&f=1", "display_name": "Markiy99", "link": "https://stackoverflow.com/users/13349883/markiy99"}, "edited": false, "score": 0, "creation_date": 1601308151, "post_id": 58256723, "comment_id": 113360319, "body": "How can you implement a word here? I&#39;ve tried adding: showw3 :: String -&gt; Char -&gt; String showw3 (Word str) n = spacing n ++ &quot;Word&quot;   ++ &quot;\\n&quot; ++ showw3 str (n+1), but I&#39;m not really sure how to do it.. @user2012588"}], "tags": [], "owner": {"reputation": 36, "user_id": 2012588, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7252667a2b85a821d07563981b3102e1?s=128&d=identicon&r=PG", "display_name": "user2012588", "link": "https://stackoverflow.com/users/2012588/user2012588"}, "is_accepted": true, "score": 1, "last_activity_date": 1570360725, "creation_date": 1570360725, "answer_id": 58256723, "question_id": 58255700, "link": "https://stackoverflow.com/questions/58255700/haskell-ast-io/58256723#58256723", "title": "Haskell Ast -&gt; IO ()", "body": "<p>Newlines and increasing spacing with depth is what you need.</p>\n\n<pre><code>spacing n = concat $ take n (repeat \"   \")\n\nshoww :: Ast -&gt; String\nshoww ast = showw2 ast 0\n\nshoww2 :: Ast -&gt; Int -&gt; String\nshoww2 (Mult a a') n = spacing n ++ \"Mult\"  ++ \"\\n\" ++ showw2 a (n+1) ++ showw2 a' (n+1)\nshoww2 (Sum a a' ) n = spacing n ++ \"Sum\"   ++ \"\\n\" ++ showw2 a (n+1) ++ showw2 a' (n+1)\nshoww2 (Min a a' ) n = spacing n ++ \"Min\"   ++ \"\\n\" ++ showw2 a (n+1) ++ showw2 a' (n+1)\nshoww2 (Int i    ) n = spacing n ++ \"Int \" ++ show i ++ \"\\n\"\n</code></pre>\n\n<p>Example output</p>\n\n<pre><code>putStr $ showw $ parse \"+ 8 * 9 10\"\n\nSum\n   Int 8\n   Mult\n      Int 9\n      Int 10\n*Main&gt;\n</code></pre>\n"}], "owner": {"reputation": 190, "user_id": 12105730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0733efb1cec773dd7b2a6bab463b11cc?s=128&d=identicon&r=PG&f=1", "display_name": "DonnumS", "link": "https://stackoverflow.com/users/12105730/donnums"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 391, "favorite_count": 0, "accepted_answer_id": 58256723, "answer_count": 1, "score": 0, "last_activity_date": 1570360725, "creation_date": 1570352061, "question_id": 58255700, "link": "https://stackoverflow.com/questions/58255700/haskell-ast-io", "title": "Haskell Ast -&gt; IO ()", "body": "<p>I've been working on an assignment about parsing in Haskell. I've made the function to parse a string to an abstract syntax tree an this is working as it should. </p>\n\n<p>Short example of how the parser works with the code I've previously made:</p>\n\n<pre><code>tokenize :: String -&gt; [String]\ntokenize [] = []\ntokenize xs @ (x : xs')\n    | x `elem` t = [x] : tokenize xs'\n    | isDigit x = [y | y &lt;- takeWhile isDigit xs] : (tokenize (dropWhile isDigit xs))\n    | otherwise = tokenize xs'\n        where t = ['+', '-', '*']\n\n--parseExpr recursively goes through list and produces ast\nparseExpr :: [String] -&gt; (Ast,[String])\nparseExpr [] = error \"Error!\"\nparseExpr (s:ss) | all isDigit s = (Int (read s),ss)\n             | s == \"-\" = let (e,ss') = parseExpr ss in (Min e,ss')\n             | s == \"*\" = (Mult e e',ss'')\n             | s == \"+\" = (Sum e e',ss'') where\n                          (e,ss') = parseExpr ss\n                          (e',ss'') = parseExpr ss'\n\n-- parse returns the first in the tuple returned from parseExpr\nparse :: String -&gt; Ast\nparse [] = error \"Empty string\"\nparse str = fst $ parseExpr x\n  where x = tokenize str\n\nparse \"+ 8 * 9 10\"\n&gt;&gt; Sum (Int 8) (Mult (Int 9) (Int 10))\n\n</code></pre>\n\n<p>Now what I have to do is to write a function that prints given ast with the correct indentation.</p>\n\n<p>Here are the functions:</p>\n\n<pre><code>showw :: Ast -&gt; String\n\nshoww ast = ???\n\nshow :: Ast -&gt; IO ()\n\nshow ast = putStr (showw ast)\n</code></pre>\n\n<p>So: </p>\n\n<pre><code>show (parse \"+ 8 * 9 10\")\nSum\n   Int 8\n   Mult\n      Int 9\n      Int 10 \n</code></pre>\n\n<p>Do I need to write <code>showw :: Ast -&gt; String</code> so that it returns the string <code>\"Sum\\n---Int 8\\n---Mult\\n------Int9\\n------Int10\"</code> (\"-\" only here to visualize spaces) (Am I on the right track here? Will this even be possible without some incredibly complex code?). I also have to make it so that the printed tree has an increasing indentation of 3 spaces (How would I go about doing this?). From my research, I've come across something called prettyprint, but the problem is that I'm not allowed to import anything other than Data.Char.</p>\n\n<p>Btw, I'm not allowed to change any functions</p>\n\n<p>Help is greatly appreciated</p>\n"}, {"tags": ["haskell", "monads", "ghc", "applicative", "do-notation"], "comments": [{"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 1, "creation_date": 1570347512, "post_id": 58254890, "comment_id": 102879742, "body": "Before reading the answers here, I thought this was because of the call to <code>return</code>. So, for future readers, I think it\u2019s worthwhile noting that this still gives an error even when <code>pure</code> is used instead of <code>return</code>."}], "answers": [{"comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1570348033, "post_id": 58255096, "comment_id": 102879837, "body": "In principle, <code>do x1 &lt;- e1; ... ; xn &lt;- en ; let y = eY ; return eR</code> could desugar to <code>do x1 &lt;- e1; ... ; xn &lt;- en ; return (let y = eY in eR)</code> and from there to applicative notation (when possible). We could also do that for <code>let y=eY; xi &lt;- ei</code> part, but we would need to require that <code>eY</code> does not use <code>x(i-1),...</code>. A lot of constraints on &quot;what can be used where&quot; would need to be required, which could be confusing. Hence, it does not look as a very convenient feature."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1570349195, "post_id": 58255096, "comment_id": 102880045, "body": "Isn&#39;t this the same as desugaring to a <code>let</code> around the entire <code>do</code> expression, since the variable being bound can&#39;t depend on any of the previous bindings, and can&#39;t be used by any following bindings?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1570349734, "post_id": 58255096, "comment_id": 102880139, "body": "I think so, except for the final <code>return</code>, where you can use the previous bindings."}, {"owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1570352803, "post_id": 58255096, "comment_id": 102880718, "body": "@chi Actually when I was writing this example, I thought like, <i>duh, of course it should desugar into a <code>let ... in ...</code> expression</i>. I am still not sure why not."}, {"owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "reply_to_user": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "edited": false, "score": 0, "creation_date": 1570353836, "post_id": 58255096, "comment_id": 102880923, "body": "@IgnatInsarov But what <i>specific</i> let/in expression? For the straw man of <code>unrelated</code>, of course you can put it anywhere, but that&#39;s not very interesting. For the version with <code>t&#39;</code> there is no obvious let/in expression with the same meaning. The closest is <code>(\\y&#39; -&gt; let t&#39; = Tuple x y&#39; in t&#39;) &lt;$&gt; f y</code>, which I guess seems reasonable for this simple case but doesn&#39;t generalize well, as chi explains."}], "tags": [], "owner": {"reputation": 75362, "user_id": 625403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/786eed7da67079cb5d63a49d469af25b?s=128&d=identicon&r=PG", "display_name": "amalloy", "link": "https://stackoverflow.com/users/625403/amalloy"}, "is_accepted": false, "score": 4, "last_activity_date": 1570346438, "creation_date": 1570346438, "answer_id": 58255096, "question_id": 58254890, "link": "https://stackoverflow.com/questions/58254890/why-does-a-let-statement-force-an-applicative-do-block-into-requiring-a-mona/58255096#58255096", "title": "Why does a &quot;let&quot; statement force an &quot;applicative do&quot; block into requiring a monad constraint?", "body": "<p>What applicative expression would you like this to desugar to? A monadic expression is a series of chained scopes, so it makes sense for a <code>let</code> to introduce a binding that extends over all the remaining scopes, but with applicative the various expressions can't really depend on each other, so there's no scope that it makes sense to desugar the <code>let</code> into.</p>\n"}, {"tags": [], "owner": {"reputation": 153048, "user_id": 9204, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/c79937a093ff9e963c563e22cd385f30?s=128&d=identicon&r=PG", "display_name": "Alexey Romanov", "link": "https://stackoverflow.com/users/9204/alexey-romanov"}, "is_accepted": true, "score": 5, "last_activity_date": 1570352828, "last_edit_date": 1570352828, "creation_date": 1570346570, "answer_id": 58255108, "question_id": 58254890, "link": "https://stackoverflow.com/questions/58254890/why-does-a-let-statement-force-an-applicative-do-block-into-requiring-a-mona/58255108#58255108", "title": "Why does a &quot;let&quot; statement force an &quot;applicative do&quot; block into requiring a monad constraint?", "body": "<p>It would translate into </p>\n\n<pre><code>let unrelated = 1 in return $ Tuple x y'\n</code></pre>\n\n<p>which doesn't have the form <code>return &lt;something&gt;</code>, and applicative do <a href=\"http://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html#applicative-do-notation\" rel=\"nofollow noreferrer\">requires the last statement to be a <code>return</code> or <code>pure</code></a>:</p>\n\n<blockquote>\n  <p>In general, the rule for when a do statement incurs a <code>Monad</code> constraint is as follows. If the do-expression has the following form:</p>\n\n<pre><code>do p1 &lt;- E1; ...; pn &lt;- En; return E\n</code></pre>\n  \n  <p>where none of the variables defined by <code>p1...pn</code> are mentioned in <code>E1...En</code>, and <code>p1...pn</code> are all variables or lazy patterns, then the expression will only require <code>Applicative</code>. Otherwise, the expression will require <code>Monad</code>. The block may return a pure expression <code>E</code> depending upon the results <code>p1...pn</code> with either <code>return</code> or <code>pure</code>.</p>\n  \n  <p>Note: the final statement must match one of these patterns exactly:</p>\n\n<pre><code>return E\nreturn $ E\npure E\npure $ E\n</code></pre>\n  \n  <p>otherwise GHC cannot recognise it as a return statement, and the transformation to use <code>&lt;$&gt;</code> that we saw above does not apply. In particular, slight variations such as <code>return . Just $ x</code> or <code>let x = e in return x</code> would not be recognised.</p>\n</blockquote>\n\n<p>If you look at the description of desugaring in <a href=\"https://gitlab.haskell.org/ghc/ghc/wikis/applicative-do\" rel=\"nofollow noreferrer\">https://gitlab.haskell.org/ghc/ghc/wikis/applicative-do</a>, it also doesn't support <code>let</code> in any way.</p>\n"}], "owner": {"reputation": 4416, "user_id": 2108477, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/f30268b2a1d0a8a18012e602cd3cb783?s=128&d=identicon&r=PG", "display_name": "Ignat Insarov", "link": "https://stackoverflow.com/users/2108477/ignat-insarov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 58255108, "answer_count": 2, "score": 5, "last_activity_date": 1570352828, "creation_date": 1570344346, "last_edit_date": 1570352041, "question_id": 58254890, "link": "https://stackoverflow.com/questions/58254890/why-does-a-let-statement-force-an-applicative-do-block-into-requiring-a-mona", "title": "Why does a &quot;let&quot; statement force an &quot;applicative do&quot; block into requiring a monad constraint?", "body": "<p>Consider this example:</p>\n\n<pre><code>{-# language ApplicativeDo #-}\n\nmodule X where\n\ndata Tuple a b = Tuple a b deriving Show\n\ninstance Functor (Tuple a) where\n    fmap f (Tuple x y) = Tuple x (f y)\n\ninstance Foldable (Tuple a) where\n    foldr f z (Tuple _ y) = f y z\n\ninstance Traversable (Tuple a) where\n    traverse f (Tuple x y) = do\n        y' &lt;- f y\n        let t' = Tuple x y'\n        return $ t'\n</code></pre>\n\n<p>Looks nice! But no:</p>\n\n<pre><code>[1 of 1] Compiling X                ( X.hs, interpreted )\n\nX.hs:15:9: error:\n    \u2022 Could not deduce (Monad f) arising from a do statement\n      from the context: Applicative f\n        bound by the type signature for:\n                   traverse :: forall (f :: * -&gt; *) a1 b.\n                               Applicative f =&gt;\n                               (a1 -&gt; f b) -&gt; Tuple a a1 -&gt; f (Tuple a b)\n        at X.hs:14:5-12\n      Possible fix:\n        add (Monad f) to the context of\n          the type signature for:\n            traverse :: forall (f :: * -&gt; *) a1 b.\n                        Applicative f =&gt;\n                        (a1 -&gt; f b) -&gt; Tuple a a1 -&gt; f (Tuple a b)\n    \u2022 In a stmt of a 'do' block: y' &lt;- f y\n      In the expression:\n        do y' &lt;- f y\n           let t' = Tuple x y'\n           return $ t'\n      In an equation for \u2018traverse\u2019:\n          traverse f (Tuple x y)\n            = do y' &lt;- f y\n                 let t' = ...\n                 return $ t'\n   |\n15 |         y' &lt;- f y\n   |         ^^^^^^^^^\nFailed, no modules loaded.\n</code></pre>\n\n<p>Even this fails:</p>\n\n<pre><code>instance Traversable (Tuple a) where\n    traverse f (Tuple x y) = do\n        y' &lt;- f y\n        let unrelated = 1\n        return $ Tuple x y'\n</code></pre>\n\n<p>So, introducing any <code>let</code> statement removes the <em>\"applicative\"</em> from the <em>\"applicative do\"</em>. Why?</p>\n"}, {"tags": ["haskell", "exception", "io-monad", "free-monad", "haskell-polysemy"], "comments": [{"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1570343820, "post_id": 58254304, "comment_id": 102879145, "body": "I think you may want to do something with <a href=\"https://hackage.haskell.org/package/polysemy-1.2.1.0/docs/Polysemy.html#v:intercept\" rel=\"nofollow noreferrer\"><code>intercept</code></a>."}], "answers": [{"tags": [], "owner": {"reputation": 61, "user_id": 5745174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lYEni.jpg?s=128&g=1", "display_name": "incertia", "link": "https://stackoverflow.com/users/5745174/incertia"}, "is_accepted": true, "score": 1, "last_activity_date": 1570507973, "creation_date": 1570507973, "answer_id": 58280102, "question_id": 58254304, "link": "https://stackoverflow.com/questions/58254304/extracting-multiple-io-exceptions-into-polysemy/58280102#58280102", "title": "Extracting multiple IO exceptions into polysemy", "body": "<p>We can solve this with a <code>lower</code> interpreter. Thanks @KingoftheHomeless.</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>withException :: forall e r a . (E.Exception e, Member IOError r, Member (Error e) r) =&gt; Sem r a -&gt; Sem r a\nwithException action = catchIO @r @e action throw\n\nlowerIOError :: Member (Embed IO) r =&gt; (forall x. Sem r x -&gt; IO x) -&gt; Sem (IOError ': r) a -&gt; Sem r a\nlowerIOError lower = interpretH $ \\case\n  ThrowIO e -&gt; embed $ E.throwIO e\n  CatchIO m h -&gt; do\n    m' &lt;- lowerIOError lower &lt;$&gt; runT m\n    h' &lt;- (lowerIOError lower .) &lt;$&gt; bindT h\n    s  &lt;- getInitialStateT\n    embed $ lower m' `E.catch` \\e -&gt; lower (h' (e &lt;$ s))\n</code></pre>\n\n<p>See this <a href=\"https://gist.github.com/incertia/ef626297ae541f71c1caf9350fb7e09f\" rel=\"nofollow noreferrer\">gist</a> for it in action.</p>\n"}], "owner": {"reputation": 61, "user_id": 5745174, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lYEni.jpg?s=128&g=1", "display_name": "incertia", "link": "https://stackoverflow.com/users/5745174/incertia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "accepted_answer_id": 58280102, "answer_count": 1, "score": 4, "last_activity_date": 1591454385, "creation_date": 1570337273, "last_edit_date": 1591454385, "question_id": 58254304, "link": "https://stackoverflow.com/questions/58254304/extracting-multiple-io-exceptions-into-polysemy", "title": "Extracting multiple IO exceptions into polysemy", "body": "<p>Let's say I have some very complex set of computations of the form <code>computation :: IO a</code> that I cannot modify, due to it being from some library code or other reasons. Let's also say I want to provide some type-level guarantees that we aren't able to launch nuclear missiles in the midst of using these computations, so we use <code>polysemy</code> and wrap all these up into its own DSL <code>Library</code>. We can naively interpret this with</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>runLibraryIO :: Member (Embed IO) r =&gt; Sem (Library ': r) a -&gt; Sem r a\nrunLibraryIO = interpret $ \\case\n  Computation -&gt; embed computation\n  -- ...\n</code></pre>\n\n<p>This is all well and good, but <code>computation</code> can throw exceptions! We quickly throw up some code and are able to lift a <strong>single</strong> type of exception into <code>polysemy</code>. We write the helper</p>\n\n<pre><code>withIOError :: forall e r a . (Exception e, Members '[Embed IO, Error e] r) =&gt; IO a -&gt; Sem r a\nwithIOError action = do\n  res &lt;- embed $ try action\n  case res of\n       Left e  -&gt; throw @e e\n       Right x -&gt; pure x\n</code></pre>\n\n<p>and then our interpreter becomes</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>runLibraryIO :: Members '[Embed IO, Error MyException] r =&gt; Sem (Library ': r) a -&gt; Sem r a\nrunLibraryIO = interpret $ withIOError @MyException . \\case\n  Computation -&gt; computation\n  -- ...\n</code></pre>\n\n<p>but we quickly notice this is not extensible. In particular, we are only able to lift a single type of exception, and it's limited to computations in <code>IO</code>. We cannot dive arbitrarily deep into a monad that contains exceptions and transfer it out in a nice and pure manner. If for whatever reason we discover a corner case where <code>computation</code> may throw <code>MyException'</code>, we have no way of inserting support for this and catching it elsewhere in our code!</p>\n\n<p>Is there something I am missing in the library that allows me to do this? Am I stuck with dealing with exceptions in <code>IO</code>? Some guidance on where to go forward from here and make this sufficiently polymorphic would be greatly appreciated.</p>\n"}, {"tags": ["haskell", "error-handling", "functional-programming"], "answers": [{"comments": [{"owner": {"reputation": 507143, "user_id": 1048572, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7f2c4de95e8f4f8f5a71c3aaf0ed312a?s=128&d=identicon&r=PG", "display_name": "Bergi", "link": "https://stackoverflow.com/users/1048572/bergi"}, "edited": false, "score": 2, "creation_date": 1570309611, "post_id": 58252328, "comment_id": 102874804, "body": "<a href=\"https://hackage.haskell.org/package/containers-0.6.2.1/docs/Data-Map-Internal.html#v:findWithDefault\" rel=\"nofollow noreferrer\"><code>findWithDefault</code></a> might be even easier to use"}, {"owner": {"reputation": 87, "user_id": 12151860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDzSn6OW34aHl_xg7YF7kz32Jz-b-dU3b3x6Ktl=k-s128", "display_name": "Velyyn S", "link": "https://stackoverflow.com/users/12151860/velyyn-s"}, "edited": false, "score": 0, "creation_date": 1570310922, "post_id": 58252328, "comment_id": 102875090, "body": "Heyy, thank you so much for the explanation. I just tried the operator !? with fromMaybe and it seems to work very well. I was curious for an easier way to do the same job and i also tried findWithDefault but this error appears :Occurs check: cannot construct the infinite type:         v ~ Map (Map v [v]) [v]"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 87, "user_id": 12151860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDzSn6OW34aHl_xg7YF7kz32Jz-b-dU3b3x6Ktl=k-s128", "display_name": "Velyyn S", "link": "https://stackoverflow.com/users/12151860/velyyn-s"}, "edited": false, "score": 1, "creation_date": 1570311169, "post_id": 58252328, "comment_id": 102875132, "body": "@VelyynS: sorry, I swapped the last two parameters, now it should (hopefully) work."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 3, "last_activity_date": 1570311147, "last_edit_date": 1570311147, "creation_date": 1570309330, "answer_id": 58252328, "question_id": 58252298, "link": "https://stackoverflow.com/questions/58252298/how-to-catch-and-ignore-an-error-call-in-haskell/58252328#58252328", "title": "How to catch and ignore an Error call in Haskell", "body": "<p>You can make use of <a href=\"https://hackage.haskell.org/package/containers-0.6.2.1/docs/Data-Map-Internal.html#v:-33--63-\" rel=\"nofollow noreferrer\"><strong>the <code>!?</code> operator</strong> (<code>Ord k =&gt; Map k a -&gt; k -&gt; Maybe a</code>)</a> here. This will return a <code>Nothing</code> in case the key does not exist, and <code>Just v</code> with <code>v</code> the value in case that exists, as specified by the documentation:</p>\n\n<blockquote>\n  <p><em>O(log n)</em>. Find the value at a key. <strong>Returns <code>Nothing</code> when the element can not be found</strong>.</p>\n</blockquote>\n\n<p>Then we still need to convert that to an empty list. We can use <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Maybe.html#v:fromMaybe\" rel=\"nofollow noreferrer\"><strong><code>fromMaybe :: a -&gt; Maybe a -&gt; a</code></strong></a> for that, here we first give a \"default\" value to use in case of a <code>Nothing</code>, and then we pass it a <code>Maybe a</code>. In case it is a <code>Nothing</code>, we use the default, in case it is a <code>Just v</code>, it will return <code>v</code>:</p>\n\n<pre><code>import Data.Map (Map,empty,member,insert,keys,<b>(!?)</b>)\nimport Data.Maybe(<b>fromMaybe</b>)\n\nsuccessors :: Ord v =&gt; v -&gt; Graph v -&gt; [v]\nsuccessors v (Graph arcs _ _) = fromMaybe [] (arcs <b>!?</b> v)</code></pre>\n\n<p>or as <a href=\"https://stackoverflow.com/questions/58252298/how-to-catch-and-ignore-an-error-call-in-haskell/58252328?noredirect=1#comment102874804_58252328\">@Bergi says</a>, we can use <a href=\"https://hackage.haskell.org/package/containers-0.6.2.1/docs/Data-Map-Internal.html#v:findWithDefault\" rel=\"nofollow noreferrer\"><strong><code>findWithDefault :: Ord k =&gt; a -&gt; k -&gt; Map k a -&gt; a</code></strong></a>:</p>\n\n<pre><code>import Data.Map (Map,empty,member,insert,keys,<b>findWithDefault</b>)\nimport Data.Maybe(fromMaybe)\n\nsuccessors :: Ord v =&gt; v -&gt; Graph v -&gt; [v]\nsuccessors v (Graph arcs _ _) = <b>findWithDefault</b> [] v arcs</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 12151860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDzSn6OW34aHl_xg7YF7kz32Jz-b-dU3b3x6Ktl=k-s128", "display_name": "Velyyn S", "link": "https://stackoverflow.com/users/12151860/velyyn-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 58252328, "answer_count": 1, "score": 3, "last_activity_date": 1570311147, "creation_date": 1570309097, "question_id": 58252298, "link": "https://stackoverflow.com/questions/58252298/how-to-catch-and-ignore-an-error-call-in-haskell", "title": "How to catch and ignore an Error call in Haskell", "body": "<p>I'm trying to understand how to handle calls error in Haskell. For example:\nI have this graph</p>\n\n<pre><code>import Data.Map (Map,empty,member,insert,keys,(!))\nimport Graphviz\n\n-- | A directed graph\ndata Graph v = Graph\n    { arcsMap :: Map v [v]     -- A map associating a vertex with its successors\n    , labelMap :: Map v String -- The Graphviz label of each node\n    , styleMap :: Map v String -- The Graphviz style of each node\n    }deriving (Show,Eq, Ord)\n</code></pre>\n\n<p>And I have the function</p>\n\n<pre><code>-- | Returns the successors of a vertex in a graph in ascending order\n--\n-- We say that `v` is a successor of `u` in a graph `G` if the arc `(u,v)`\n-- belongs to `G`.\n--\n-- Note: Returns the empty list if the vertex does not belong to the graph.\n--\n-- &gt;&gt;&gt; successors 1 emptyGraph\n-- []\n-- &gt;&gt;&gt; successors 1 $ addArc (1,2) emptyGraph\n-- [2]\n-- &gt;&gt;&gt; successors 1 $ addArcs emptyGraph [(1,2),(2,3),(1,3)]\n-- [2,3]\nsuccessors :: Ord v =&gt; v -&gt; Graph v -&gt; [v]\nsuccessors v (Graph arcs labels styles) = arcs ! v\n\n</code></pre>\n\n<p>The documentation of the operator (!) says :  \"O(log n). Find the value at a key. Calls error when the element cannot be found.\"</p>\n\n<p>I want to return an empty list [] when the element can't be found</p>\n\n<p>How should I handle this ?\nThank you very much.</p>\n"}, {"tags": ["haskell", "graph", "functional-programming", "custom-data-type"], "comments": [{"owner": {"reputation": 396, "user_id": 2951059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/306b73823397b4e4e9b511229689f5e0?s=128&d=identicon&r=PG", "display_name": "Garrison", "link": "https://stackoverflow.com/users/2951059/garrison"}, "edited": false, "score": 1, "creation_date": 1570299771, "post_id": 58250759, "comment_id": 102872637, "body": "Are all the vertices keys? You could try <code>vertices = keys . arcsMap</code> (You got to import keys from Data.Map)"}, {"owner": {"reputation": 87, "user_id": 12151860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDzSn6OW34aHl_xg7YF7kz32Jz-b-dU3b3x6Ktl=k-s128", "display_name": "Velyyn S", "link": "https://stackoverflow.com/users/12151860/velyyn-s"}, "reply_to_user": {"reputation": 396, "user_id": 2951059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/306b73823397b4e4e9b511229689f5e0?s=128&d=identicon&r=PG", "display_name": "Garrison", "link": "https://stackoverflow.com/users/2951059/garrison"}, "edited": false, "score": 0, "creation_date": 1570301863, "post_id": 58250759, "comment_id": 102873116, "body": "@Garrison OHHHH it worked, I never would have figured it out. How should I think to come up with some reasoning like this? I didn&#39;t know the existence of keys in Data.Map and I never found it in the documentation of Data.Map. Thank you."}, {"owner": {"reputation": 396, "user_id": 2951059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/306b73823397b4e4e9b511229689f5e0?s=128&d=identicon&r=PG", "display_name": "Garrison", "link": "https://stackoverflow.com/users/2951059/garrison"}, "edited": false, "score": 1, "creation_date": 1570302082, "post_id": 58250759, "comment_id": 102873173, "body": "Nice :) I&#39;m not sure, I knew about keys. I usually just think about what type I am looking for and search for it on hoogle <a href=\"https://hoogle.haskell.org/?hoogle=Map%20k%20a%20-%3E%20%5Bk%5D\" rel=\"nofollow noreferrer\">hoogle.haskell.org/?hoogle=Map%20k%20a%20-%3E%20%5Bk%5D</a>"}], "answers": [{"tags": [], "owner": {"reputation": 396, "user_id": 2951059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/306b73823397b4e4e9b511229689f5e0?s=128&d=identicon&r=PG", "display_name": "Garrison", "link": "https://stackoverflow.com/users/2951059/garrison"}, "is_accepted": true, "score": 3, "last_activity_date": 1570302327, "creation_date": 1570302327, "answer_id": 58251467, "question_id": 58250759, "link": "https://stackoverflow.com/questions/58250759/extracting-elements-of-a-graph-in-haskell/58251467#58251467", "title": "Extracting elements of a graph in Haskell", "body": "<p>The function <a href=\"https://hackage.haskell.org/package/containers-0.6.2.1/docs/Data-Map-Strict.html#v:keys\" rel=\"nofollow noreferrer\"><code>keys</code></a> returns all keys of the map. So you could implement <code>vertices</code> like this:</p>\n\n<pre><code>vertices :: Graph v -&gt; [v]\nvertices = keys . arcsMap\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 12151860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDzSn6OW34aHl_xg7YF7kz32Jz-b-dU3b3x6Ktl=k-s128", "display_name": "Velyyn S", "link": "https://stackoverflow.com/users/12151860/velyyn-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "accepted_answer_id": 58251467, "answer_count": 1, "score": -1, "last_activity_date": 1570302327, "creation_date": 1570296935, "question_id": 58250759, "link": "https://stackoverflow.com/questions/58250759/extracting-elements-of-a-graph-in-haskell", "title": "Extracting elements of a graph in Haskell", "body": "<p>I have a little question concerning Haskell.\nIf I have data type representing a graph like this one :</p>\n\n<pre><code>import Data.Map (Map,empty,member,insert)\n\nimport Graphviz\n\n-- | A directed graph\n    data Graph v = Graph\n    { arcsMap :: Map v [v]     -- A map associating a vertex with its \n                                  successors\n    , labelMap :: Map v String -- The Graphviz label of each node\n    , styleMap :: Map v String -- The Graphviz style of each node\n    }\n</code></pre>\n\n<p>And i want to create a list by accessing every vertices of a given graph.</p>\n\n<p>Like this:</p>\n\n<pre><code>-- | Returns the list of vertices of a graph in ascending order\n--\n-- &gt;&gt;&gt; vertices emptyGraph\n-- []\n-- &gt;&gt;&gt; vertices $ addVertices emptyGraph [1,4,5,2,1]\n-- [1,2,4,5]\nvertices :: Graph v -&gt; [v]\n</code></pre>\n\n<p>My question is how can I tell Haskell to look into every vertices in arcsMap and create a list with it ?\nThankyou !!!</p>\n"}, {"tags": ["haskell", "type-mismatch", "guard-clause"], "answers": [{"comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 2, "creation_date": 1570297239, "post_id": 58250419, "comment_id": 102871954, "body": "Another reason to prefer pattern matching: if you start with a very large list, you don&#39;t need to spend O(n) time determining the actual length of the list when you only care that its length is &lt;= 1."}, {"owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "reply_to_user": {"reputation": 33, "user_id": 11636791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0cb2e21050c56870c196107a815c94e?s=128&d=identicon&r=PG&f=1", "display_name": "MC3D", "link": "https://stackoverflow.com/users/11636791/mc3d"}, "edited": false, "score": 0, "creation_date": 1570297958, "post_id": 58250419, "comment_id": 102872147, "body": "@MC3D you&#39;re welcome. :) so indeed it was &quot;something simple&quot; -- no need to use those Booleans as arguments to any function, but just use them as they are, in the guards."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": true, "score": 5, "last_activity_date": 1570347992, "last_edit_date": 1570347992, "creation_date": 1570294296, "answer_id": 58250419, "question_id": 58250294, "link": "https://stackoverflow.com/questions/58250294/beginner-haskell-problem-couldnt-match-type-bool-with-char/58250419#58250419", "title": "Beginner Haskell problem - Couldn&#39;t match type \u2018Bool\u2019 with \u2018[Char]\u2019", "body": "<p><code>f x</code> is a function call to the function <code>f</code> with the argument <code>x</code>. But you don't need to call that function, if the test expression <code>x</code> is already all that you need:</p>\n\n<pre><code>isPalindrome :: String -&gt; Bool\nisPalindrome s\n  --   f               x\n  | {- isPalindrome -} ((null s) || (length s == 1))        -- here\n              = True\n  | {- isPalindrome -} ((s !! 0) /= (s !! (length s - 1)))  -- and here\n              = False\n  | otherwise = isPalindrome (tail (init s))  \n</code></pre>\n\n<p><code>isPalindrome :: String -&gt; Bool</code> means <code>isPalindrom</code>'s first argument is  expected to be a <code>String</code>. But what is really meant to be there is a Boolean value, used as a guard, to select the appropriate course of action. Hence the error message. We already have that <code>Bool</code>.</p>\n\n<p>The function call in the last line is the recursive call that indeed must be done.</p>\n\n<p><code>{- ... -}</code> are multiline comments, in Haskell.</p>\n\n<hr>\n\n<p>The usual, more idiomatic Haskell way is to not perform those tests explicitly, but rather arrange for the equivalent pattern matching in the function definition by clauses:</p>\n\n<pre><code>isPalindrome :: String -&gt; Bool\nisPalindrome []     = True           -- (null s)\nisPalindrome [_]    = True           -- (length s == 1)\nisPalindrome -- [a, ..., b] | a /= b\n             (x:xs) | x /= last xs\n                    = False          --  ((s !! 0) /= (s !! (length s - 1))) \nisPalindrome -- [a, ...xs, b] \n             (_:xs) = isPalindrome   --  xs\n                                   (init xs)\n</code></pre>\n\n<p>The above code contains some imaginary list patterns in the comments, and their Haskell equivalents in the code itself. </p>\n\n<p>In fact, as <a href=\"https://stackoverflow.com/users/1126841/chepner\">@chepner</a> points out in the comments, patterns can often help avoid inefficiency: calculating <code>length</code> is <em>O(n)</em> whereas the pattern matching with <code>[_]</code> is <em>O(1)</em>. </p>\n\n<p>Of course this specific code is very inefficient still as the other two clauses also perform <em>O(n)</em> operations (<code>last</code> and <code>init</code>). An <em>O(n)</em> algorithm exists.</p>\n"}], "owner": {"reputation": 33, "user_id": 11636791, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f0cb2e21050c56870c196107a815c94e?s=128&d=identicon&r=PG&f=1", "display_name": "MC3D", "link": "https://stackoverflow.com/users/11636791/mc3d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 58250419, "answer_count": 1, "score": 3, "last_activity_date": 1570347992, "creation_date": 1570293327, "last_edit_date": 1570296455, "question_id": 58250294, "link": "https://stackoverflow.com/questions/58250294/beginner-haskell-problem-couldnt-match-type-bool-with-char", "title": "Beginner Haskell problem - Couldn&#39;t match type \u2018Bool\u2019 with \u2018[Char]\u2019", "body": "<p>I need to make a palindrome checker using recursion in Haskell for a homework assignment. The function should take in a string and return a <code>Bool</code>. When attempting to compile, I get the error, <code>\"Couldn't match type \u2018Bool\u2019 with \u2018[Char]\u2019.\"</code> </p>\n\n<p>I'm very new to Haskell, so I'm sure I'm just overlooking something silly, but I figured I'd ask for some help anyway. I've pasted my code below, as well as the full error I'm receiving.</p>\n\n<pre><code>isPalindrome :: String -&gt; Bool\nisPalindrome s\n  | isPalindrome ((null s) || (length s == 1)) = True\n  | isPalindrome ((s !! 0) /= (s !! (length s - 1))) = False\n  | otherwise = isPalindrome (tail (init s))\n</code></pre>\n\n<p>My implementation checks to see if the input string is either empty or of size one, and returns true if it is. If it is not, it checks to see if the first character and last character are different, and if they are, returns false. Otherwise, it calls itself again, passing in the string with the first and last characters cut off.</p>\n\n<pre><code>main.hs:15:19: error:\n    \u2022 Couldn't match type \u2018Bool\u2019 with \u2018[Char]\u2019\n      Expected type: String\n        Actual type: Bool\n    \u2022 In the first argument of \u2018isPalindrome\u2019, namely\n        \u2018((null s) || (length s == 1))\u2019\n      In the expression: isPalindrome ((null s) || (length s == 1))\n      In a stmt of a pattern guard for\n                     an equation for \u2018isPalindrome\u2019:\n        isPalindrome ((null s) || (length s == 1))\n   |\n15 |   | isPalindrome ((null s) || (length s == 1)) = True\n   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^\nmain.hs:16:19: error:\n    \u2022 Couldn't match type \u2018Bool\u2019 with \u2018[Char]\u2019\n      Expected type: String\n        Actual type: Bool\n    \u2022 In the first argument of \u2018isPalindrome\u2019, namely\n        \u2018((s !! 0) /= (s !! (length s - 1)))\u2019\n      In the expression: isPalindrome ((s !! 0) /= (s !! (length s - 1)))\n      In a stmt of a pattern guard for\n                     an equation for \u2018isPalindrome\u2019:\n        isPalindrome ((s !! 0) /= (s !! (length s - 1)))\n   |\n16 |   | isPalindrome ((s !! 0) /= (s !! (length s - 1))) = False\n   |                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n</code></pre>\n"}, {"tags": ["haskell", "typeclass"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1570303754, "post_id": 58249649, "comment_id": 102873588, "body": "It would be simpler to just define the <code>Enum</code> instance first, then define the <code>Ord</code> instance. Also, there is a difference between <i>needing</i> an <code>Enum</code> instance and simply <i>using</i> it to define the <code>Ord</code> instance."}], "answers": [{"comments": [{"owner": {"reputation": 1263, "user_id": 5817767, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/209584382725014/picture?type=large", "display_name": "Pawan Kumar", "link": "https://stackoverflow.com/users/5817767/pawan-kumar"}, "edited": false, "score": 0, "creation_date": 1570293748, "post_id": 58249949, "comment_id": 102871031, "body": "Thanks for the help. What is FlexibleContexts and can you please suggest any beginner friendly sites for learning haskell."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1263, "user_id": 5817767, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/209584382725014/picture?type=large", "display_name": "Pawan Kumar", "link": "https://stackoverflow.com/users/5817767/pawan-kumar"}, "edited": false, "score": 1, "creation_date": 1570294741, "post_id": 58249949, "comment_id": 102871285, "body": "@PKChem Haskell was initially designed 20+ years ago so that it could handle only very simple cases like <code>instance C variable =&gt; C (T variable)</code>. Here, the context <code>C variable</code> really requires <code>variable</code> to be a type variable. This restriction and many others were removed with time. GHC by default still applies many restrictions, but allows to remove most of them through extensions. Most code nowadays exploits at least a few extensions. Flexible context allow non-variables in the context above, e.g. <code>instance C Char =&gt; ...</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 1263, "user_id": 5817767, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/209584382725014/picture?type=large", "display_name": "Pawan Kumar", "link": "https://stackoverflow.com/users/5817767/pawan-kumar"}, "edited": false, "score": 1, "creation_date": 1570295038, "post_id": 58249949, "comment_id": 102871370, "body": "@PKChem The most beginner-friendly tutorial seems to be <a href=\"http://learnyouahaskell.com/chapters\" rel=\"nofollow noreferrer\">LYAH</a> right now, even if it does not cover advanced topics. Your question is not beginner level, IMO, being based on some typeclass technicality. Don&#39;t be afraid to read the <a href=\"https://downloads.haskell.org/~ghc/latest/docs/html/users_guide/glasgow_exts.html?highlight=flexiblecontext#extension-FlexibleContexts\" rel=\"nofollow noreferrer\">GHC docs</a> on extensions. Usually it is undestandable, even if it&#39;s a bit technical, and often comes with examples."}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 5, "last_activity_date": 1570290814, "creation_date": 1570290814, "answer_id": 58249949, "question_id": 58249649, "link": "https://stackoverflow.com/questions/58249649/non-type-variable-argument-in-the-constraint-enum-a-ord-a/58249949#58249949", "title": "Non type-variable argument in the Constraint: Enum A =&gt; Ord A", "body": "<p>Your code compiles if we enable a pair of extensions, writing in the first line of the file:</p>\n\n<pre><code>{-# LANGUAGE FlexibleContexts, UndecidableInstances #-}\n</code></pre>\n\n<p>Still, I think it's not worth it. I'd remove the context instead, since that is what most existing code does.</p>\n\n<p>Further, I'm not sure about why do you think it's important to document the fact that one instance depends on the other. I would regard that as an implementation detail, hence something I'd like to <em>hide</em> from the user, rather than to point out.</p>\n"}], "owner": {"reputation": 1263, "user_id": 5817767, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/209584382725014/picture?type=large", "display_name": "Pawan Kumar", "link": "https://stackoverflow.com/users/5817767/pawan-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 58249949, "answer_count": 1, "score": 0, "last_activity_date": 1570290814, "creation_date": 1570288495, "question_id": 58249649, "link": "https://stackoverflow.com/questions/58249649/non-type-variable-argument-in-the-constraint-enum-a-ord-a", "title": "Non type-variable argument in the Constraint: Enum A =&gt; Ord A", "body": "<p>I am new to Haskell.</p>\n\n<p>I want to implement <strong>Ord</strong> class for a Custom Data type using <strong>Enum</strong> class.</p>\n\n<p>It works fine if I implement <strong>Enum</strong> class and use the <strong>fromEnum</strong> function directly in the implementation of <strong>compare</strong> function required for <strong>Ord</strong> class.</p>\n\n<p>But as <strong>Type Signatures</strong> and <strong>Type Level Constraints</strong> are for <strong>Readability</strong> and <strong>Documentation</strong>. I want to Specify the <strong>Ord</strong> instance of my custom data <strong>depends</strong> on <strong>Enum</strong> instance.\nWhen I write the below code it throws an error.</p>\n\n<pre><code>data DayOfWeek\n  = Mon | Tue | Weds | Thu | Fri | Sat | Sun\n  deriving (Eq, Show)    \n\ninstance Enum DayOfWeek =&gt; Ord DayOfWeek where\n  compare a b = compare (fromEnum a) (fromEnum b)\n\ninstance Enum DayOfWeek where\n  toEnum 1 = Mon\n  toEnum 2 = Tue\n  toEnum 3 = Weds\n  toEnum 4 = Thu\n  toEnum 5 = Fri\n  toEnum 6 = Sat\n  toEnum 7 = Sun\n\n  fromEnum Mon = 1\n  fromEnum Tue = 2\n  fromEnum Weds = 3\n  fromEnum Thu = 4\n  fromEnum Fri = 5\n  fromEnum Sat = 6\n  fromEnum Sun = 7\n</code></pre>\n\n<p><strong>Error</strong>:</p>\n\n<pre><code>* Non type-variable argument in the constraint: Enum DayOfWeek\n  (Use FlexibleContexts to permit this)\n* In the context: Enum DayOfWeek\n  While checking an instance declaration\n  In the instance declaration for `Ord DayOfWeek'\n</code></pre>\n\n<p>Can we write Constraints on Concrete Types</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "edited": false, "score": 0, "creation_date": 1570335688, "post_id": 58249072, "comment_id": 102878125, "body": "It is very honorable from you to provide such a good answer from a not perfect formed question, and to a new user... I admire that."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 5, "last_activity_date": 1570285054, "last_edit_date": 1570285054, "creation_date": 1570284272, "answer_id": 58249072, "question_id": 58248814, "link": "https://stackoverflow.com/questions/58248814/simple-function-error-variable-not-in-scope-haskell/58249072#58249072", "title": "simple function error &quot;Variable not in scope&quot; haskell", "body": "<p>I/O has to be handled explicitly in Haskell, as <code>readLn</code> is not a function; it's an IO action. It is simpler to start with a true function that takes the value to check as an argument:</p>\n\n<pre><code>checkIfEven :: Int -&gt; Bool\ncheckIfEven x = even (x*3 + 1)\n</code></pre>\n\n<p>Note that the parentheses are not part of the call to <code>even</code>, but rather \"grouping\" the expression <code>x * 3 + 1</code>, as <code>even x*3 + 1</code> is parsed as <code>(even x) * 3 + 1</code>.</p>\n\n<p>Now that we have a pure function, we can apply it to a value input by the user.</p>\n\n<pre><code>program :: IO Bool\nprogram = do\n    x &lt;- readLn\n    return (checkIfEven (read x))\n</code></pre>\n\n<p>A few things to note:</p>\n\n<ol>\n<li><code>&lt;-</code> is not an assignment operator; it's special syntax inside a <code>do</code> construct with \"extracts\" a value from (in this context) an IO action.</li>\n<li><code>x</code> will be a string, so you need to parse it to get an <code>Int</code> value for <code>checkIfEven</code>. <code>read</code> is a simple way to do that; we're ignoring the possibility that the user may enter a string that can <em>not</em> be parsed as an <code>Int</code>.</li>\n<li><code>return</code> doesn't return a value from a function (note we did not use it in the definition of <code>checkIfEven</code>. Rather, it \"lifts\" a value into a new IO action, has <code>program</code> has to be value of type <code>IO Bool</code>, not <code>Bool</code>.</li>\n</ol>\n\n<p>Note that a <code>do</code> construct provides an imperative-looking way to work with IO actions. You can work directly with the underlying functions and values; in this case, we could have simply written</p>\n\n<pre><code>program = fmap (checkIfEven . read) readLn\n</code></pre>\n\n<p>The full explanation of how IO (and monads in general) work is beyond the scope of this question; hopefully, this will give you an idea of what to focus on as you study the topic further.</p>\n"}], "owner": {"reputation": 1, "user_id": 12168813, "user_type": "registered", "profile_image": "https://graph.facebook.com/10221098572713618/picture?type=large", "display_name": "user12168813", "link": "https://stackoverflow.com/users/12168813/user12168813"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 255, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1570286385, "creation_date": 1570282423, "last_edit_date": 1570286385, "question_id": 58248814, "link": "https://stackoverflow.com/questions/58248814/simple-function-error-variable-not-in-scope-haskell", "title": "simple function error &quot;Variable not in scope&quot; haskell", "body": "<p>I have just started to code Haskell today, stuck on building function that takes an integer from user, multiply it by 3, adds one and checks if it is Even. returns the output as Boolean, true if even.\nSorry if the code is too faulty, I'm a Haskell newbie. </p>\n\n<pre><code>checkIfEven :: Int -&gt; Bool\nx &lt;- readLn\nlet checkIfEven x = (even ((x*3)+1))\nprint checkIfEven   \n\n error:\n    Variable not in scope: checkIfEven :: Int -&gt; Bool\n</code></pre>\n"}, {"tags": ["parsing", "haskell", "tree", "abstract-syntax-tree"], "comments": [{"owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "edited": false, "score": 2, "creation_date": 1570283697, "post_id": 58248598, "comment_id": 102868552, "body": "Well done so far ! Next, as parseExpr returns a <code>(Ast,[String])</code> pair (or 2-tuple) object, and you just want the first component (the AST), you just need to pass the result of parseExpr to Haskell built-in function <code>fst</code>, which returns the first element of the pair, that is your AST. BTW there is also a <code>snd</code> function for the 2nd component."}, {"owner": {"reputation": 190, "user_id": 12105730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0733efb1cec773dd7b2a6bab463b11cc?s=128&d=identicon&r=PG&f=1", "display_name": "DonnumS", "link": "https://stackoverflow.com/users/12105730/donnums"}, "reply_to_user": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "edited": false, "score": 0, "creation_date": 1570284917, "post_id": 58248598, "comment_id": 102868857, "body": "Thanks!! The fact that it returned a tuple just slipped my mind. Got it to work in a matter of seconds :)"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1570286169, "post_id": 58248598, "comment_id": 102869185, "body": "Minor note: <code>[y | y &lt;- takeWhile isDigit xs]</code> is equivalent to <code>takeWhile isDigit xs</code>."}, {"owner": {"reputation": 431, "user_id": 3042847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20812bf59589551344aeae214de49f6a?s=128&d=identicon&r=PG&f=1", "display_name": "xgrommx", "link": "https://stackoverflow.com/users/3042847/xgrommx"}, "edited": false, "score": 1, "creation_date": 1570289123, "post_id": 58248598, "comment_id": 102869913, "body": "Make <code>parseExpr</code> (probably u should named it like <code>go</code>) as inner function and use outer function like <code>parseExpr = fst . go</code> Sorry I don&#39;t checked it, just written it from my mind"}, {"owner": {"reputation": 431, "user_id": 3042847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20812bf59589551344aeae214de49f6a?s=128&d=identicon&r=PG&f=1", "display_name": "xgrommx", "link": "https://stackoverflow.com/users/3042847/xgrommx"}, "edited": false, "score": 0, "creation_date": 1570289176, "post_id": 58248598, "comment_id": 102869924, "body": "Also u can rewrite it via some monad like Writer"}], "answers": [{"tags": [], "owner": {"reputation": 396, "user_id": 2951059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/306b73823397b4e4e9b511229689f5e0?s=128&d=identicon&r=PG", "display_name": "Garrison", "link": "https://stackoverflow.com/users/2951059/garrison"}, "is_accepted": true, "score": 1, "last_activity_date": 1570292573, "creation_date": 1570292573, "answer_id": 58250188, "question_id": 58248598, "link": "https://stackoverflow.com/questions/58248598/parse-string-to-ast/58250188#58250188", "title": "Parse String to Ast", "body": "<p><code>(Sum (Num 1) (Num 4),[])</code> is a tuple and you want the first element.</p>\n\n<p>You can get the first element out of a tuple with the function <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:fst\" rel=\"nofollow noreferrer\"><code>fst</code></a>.</p>\n\n<pre><code>parse :: String -&gt; Ast\nparse [] = error \"Empty string\"\nparse str = fst $ parseExpr x\n  where x = tokenize str\n</code></pre>\n"}], "owner": {"reputation": 190, "user_id": 12105730, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0733efb1cec773dd7b2a6bab463b11cc?s=128&d=identicon&r=PG&f=1", "display_name": "DonnumS", "link": "https://stackoverflow.com/users/12105730/donnums"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 636, "favorite_count": 0, "accepted_answer_id": 58250188, "answer_count": 1, "score": 1, "last_activity_date": 1570292573, "creation_date": 1570280949, "question_id": 58248598, "link": "https://stackoverflow.com/questions/58248598/parse-string-to-ast", "title": "Parse String to Ast", "body": "<p>I need some guidance on a few functions I made to do some parsing.</p>\n\n<p>Here's my grammar (I can't change this):</p>\n\n<pre><code>Expr -&gt; Int | - Expr | + Expr Expr | * Expr Expr\nInt -&gt; Digit | Digit Int\nDigit -&gt; 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9\n</code></pre>\n\n<p>My data type (I was supposed to fill out for Min and Mult, and I think I got this correct):</p>\n\n<pre><code>data Ast = Num Int | Sum Ast Ast | Mult Ast Ast | Min Ast | Var String  deriving (Eq, Show)\n\n</code></pre>\n\n<p>So first up I made a tokenizer method, to split the string into a list of the characters:</p>\n\n<pre><code>tokenize :: String -&gt; [String]\ntokenize [] = []\ntokenize xs @ (x : xs')\n    | x `elem` t = [x] : tokenize xs'\n    | isDigit x = [y | y &lt;- takeWhile isDigit xs] : (tokenize (dropWhile isDigit xs))\n    | otherwise = tokenize xs'\n        where t = ['+', '-', '*']\n</code></pre>\n\n<p>This works as it should.</p>\n\n<p>Next up I made the <code>parseExpr :: [String] -&gt; (Ast, [String])</code>. What this is doing is going through a list made by <code>tokenize :: String -&gt; [String]</code> and produces the Ast recursively (I think at least) </p>\n\n<pre><code>parseExpr :: [String] -&gt; (Ast,[String])\nparseExpr [] = error \"Error!\"\nparseExpr (s:ss) | all isDigit s = (Num (read s),ss)\n             | s == \"-\" = let (e,ss') = parseExpr ss in (Min e,ss')\n             | s == \"*\" = (Mult e e',ss'')\n             | s == \"+\" = (Sum e e',ss'') where\n                          (e,ss') = parseExpr ss\n                          (e',ss'') = parseExpr ss'\n</code></pre>\n\n<p>What I'm struggling with now is how I can combine these into the function <code>parse :: String -&gt; Ast</code>. My attempt at doing this (which might be way off) is something like this. <code>parseExpr</code> produces an output of the form <code>(Ast, [String])</code>:</p>\n\n<pre><code>parse :: String -&gt; Ast\nparse [] = error \"Empty string\"\nparse str = parseExpr x\n  where x = tokenize str\n</code></pre>\n\n<p>My problem here is this:</p>\n\n<p>Lets say I have the simple string <code>str = \"+ 1 4\"</code>. </p>\n\n<pre><code>tokenize str = [\"+\", \"1\", \"4\"]\n</code></pre>\n\n<p>Running this into parseExpr recursively goes through the list from tokenize and produces this output:</p>\n\n<p><code>(Sum (Num 1) (Num 4),[])</code></p>\n\n<p>It outputs the Ast and an empty list of strings. </p>\n\n<p>Now the question at hand. I need to make it so that <code>parse \"+ 1 4\"</code> returns <code>(Sum (Num 1) (Num 4))</code> What are the ways I can do this? Do I treat the output from <code>parseExpr</code>as a list and take the Ast from the 0th index, or is this not possible? Do I have to change the way my <code>parseExpr</code> goes through the list?\nAny help is greatly appreciated! BTW I cannot change any of the definitions of the functions, nor the grammar or datatype for the Ast.</p>\n"}, {"tags": ["haskell", "ghc"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 7, "creation_date": 1570273775, "post_id": 58247592, "comment_id": 102866373, "body": "What is &quot;<i>not fast enough</i>&quot;. I would be supprised if this is really a bottleneck."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1570274171, "post_id": 58247592, "comment_id": 102866459, "body": "I am not convinced you here run banchmarks on <code>fromEnum</code>. At first sight you run benchmarks on the <code>pure</code> itself, at first sight <code>fromEnum R</code>, etc. are never evaluated. Likely <code>unsafeCoerce R</code> and <code>fromEnum R</code> will produce (approximately) the same results, since we never really make the evaluation."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "edited": false, "score": 1, "creation_date": 1570275933, "post_id": 58247592, "comment_id": 102866825, "body": "Note: When profiling times in Haskell, the easiest method to do so is usually by using <a href=\"http://www.serpentine.com/criterion/\" rel=\"nofollow noreferrer\">criterion</a>. I recommend using this library to ensure that your benchmarks are as accurate as possible."}, {"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 3, "creation_date": 1570287485, "post_id": 58247592, "comment_id": 102869542, "body": "Note that <code>unsafeCoerce</code> is 100% incorrect here and liable to crash your program at surprising times. GHC does not represent <code>Int8</code> and a 3-constructor sum type in anything resembling the same memory layout."}, {"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1576548440, "post_id": 58247592, "comment_id": 104927064, "body": "Derived <code>toEnum</code> and <code>fromEnum</code> are really, really fast. They are, in fact, the fastest way the GHC developers have found to &quot;convert an enum into <code>Int</code> or vice [versa], i.e. implement an bidirectional mapping between the tag of sum type and <code>Int</code>.&quot; In the event that you find a faster way, you should submit a merge request to GHC; the performance of this code has always been a pretty high priority."}], "answers": [{"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 1, "creation_date": 1576548888, "post_id": 59341099, "comment_id": 104927146, "body": "<code>toEnum a | (fromIntegral a :: Word) &lt;= fromIntegral maxColor = ...</code> is likely better using the native code generator. I imagine LLVM will do that automatically."}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 1, "last_activity_date": 1576381904, "creation_date": 1576381904, "answer_id": 59341099, "question_id": 58247592, "link": "https://stackoverflow.com/questions/58247592/the-fastest-way-to-convert-between-enum-and-int-in-ghc/59341099#59341099", "title": "The fastest way to convert between enum and Int in GHC?", "body": "<p>Is the <code>Enum</code> you actually care about your type, or someone else's? If it's someone else's, then you're not guaranteed any methods you can use besides <code>fromEnum</code>, so you're out of luck. If it's your own type, then you can reimplement it with a <code>newtype</code> and pattern synonyms instead of deriving, so that <code>fromEnum</code> is literally free (provided the compiler can specialize it wherever you use it):</p>\n\n<pre><code>{-# LANGUAGE PatternSynonyms #-}\n\nmodule ColorEnum (Color(R,G,B)) where\n\nimport Data.Coerce (coerce)\n\nnewtype Color = UnsafeColor Int\n\npattern R, G, B :: Color\npattern R = UnsafeColor 0\npattern G = UnsafeColor 1\npattern B = UnsafeColor 2\n\nmaxColor :: Int\nmaxColor = 2\n\ninstance Enum Color where\n  succ (UnsafeColor a)\n    | a == maxColor = error \"succ{Color}: tried to take `succ' of last tag in enumeration\"\n    | otherwise = UnsafeColor (a + 1)\n  pred (UnsafeColor a)\n    | a == 0 = error \"pred{Color}: tried to take `pred' of first tag in enumeration\"\n    | otherwise = UnsafeColor (a - 1)\n  toEnum a\n    | a &gt;= 0 &amp;&amp; a &lt;= maxColor = UnsafeColor a\n    | otherwise = error $ \"toEnum{Color}: tag (\" ++ show a ++ \") is outside of enumeration's range (0,\" ++ show maxColor ++ \")\"\n  enumFrom (UnsafeColor a) = coerce [a..maxColor]\n  enumFromThen (UnsafeColor a) (UnsafeColor b) = coerce [a,b..if a &gt; b then 0 else maxColor]\n  fromEnum = coerce\n</code></pre>\n\n<p>Caveats:</p>\n\n<ul>\n<li>This is not an endorsement of how you did your benchmark (in fact, it probably is wrong, as commenters pointed out)</li>\n<li>There's a good chance that things other than <code>fromEnum</code> will be made slower by this change</li>\n<li>All of that code is just to replace <code>data Color = R | G | B deriving (Enum)</code></li>\n</ul>\n"}], "owner": {"reputation": 3074, "user_id": 1608276, "user_type": "registered", "accept_rate": 28, "profile_image": "https://i.stack.imgur.com/XiZ2q.jpg?s=128&g=1", "display_name": "luochen1990", "link": "https://stackoverflow.com/users/1608276/luochen1990"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1576381904, "creation_date": 1570272631, "question_id": 58247592, "link": "https://stackoverflow.com/questions/58247592/the-fastest-way-to-convert-between-enum-and-int-in-ghc", "title": "The fastest way to convert between enum and Int in GHC?", "body": "<p>I want to convert an enum into Int or vice verse, i.e. implement an bidirectional mapping between the tag of sum type and Int. I have tried <code>fromEnum</code> but it seems not fast enough, and then I tried <code>unsafeCoerce</code> but it doesn't works as expected:</p>\n\n<pre><code>import Data.Time.Clock\nimport Data.Int\nimport Unsafe.Coerce\nimport Control.Monad (replicateM_)\n\ndata Color = R | G | B\n    deriving (Enum)\n\nmain = do\n    printT 1 $ (unsafeCoerce R :: Int8)\n    printT 1000 $ (unsafeCoerce G :: Int8)\n    printT 1000000 $ (unsafeCoerce B :: Int8)\n    printT 1000000000 $ (unsafeCoerce R :: Int8)\n\n    printT 1 $ (fromEnum R)\n    printT 1000 $ (fromEnum G)\n    printT 1000000 $ (fromEnum B)\n    printT 1000000000 $ (fromEnum B)\n\n---------- profile tools ------------\n\nprintT :: Show a =&gt; Int -&gt; a -&gt; IO ()\nprintT n x = print =&lt;&lt; timeIt n (pure x)\n\ntimeIt :: Int -&gt; IO a -&gt; IO a\ntimeIt n _ | n &lt;= 0 = error \"timeIt n | n &lt;= 0\"\ntimeIt n proc = do\n    t0 &lt;- getCurrentTime\n    replicateM_ (n-1) proc\n    x &lt;- proc\n    t1 &lt;- getCurrentTime\n    putStrLn (\"-- Time Used (repeat \" ++ show n ++ \" times): \" ++ show (t1 `diffUTCTime` t0))\n    return x\n</code></pre>\n\n<p>So what is the fastest way to do this?</p>\n"}, {"tags": ["haskell", "monads", "function-composition"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1570266722, "post_id": 58246794, "comment_id": 102864998, "body": "I don&#39;t have time for a full answer, and I&#39;m also not totally sure what you&#39;re asking (eg <code>liftM</code>, aka <code>fmap</code>, seems unrelated to this composition). But in short, the output of <code>mapM</code> is a function <code>t a -&gt; m (t b)</code>, and <code>join</code> needs a monadic value of the form <code>m ( m c)</code> as input. The only way for these types to unify is for the Monad <code>m</code> to be the function type <code>t a -&gt; b</code>, where <code>t</code> and <code>a</code> are fixed. (It&#39;s actually rather surprising to me that this works at all, but the types all match up.)"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 1, "creation_date": 1570267327, "post_id": 58246794, "comment_id": 102865089, "body": "To avoid any possible doubt, when I say &quot;the Monad m (is) the function type t a -&gt; b&quot;, I mean the Monad formally denoted as <code>(-&gt;) t a</code>, whose values are functions with input <code>t a</code>. (Sometime I wonder why Haskell has both a direct Monad instance for &quot;functions with a fixed input&quot;, and one called the &quot;reader monad&quot; which is exactly the same but in a <code>newtype</code> wrapper. I think it would work better without the &quot;unwrapped&quot; version having a monad/applicative instance - but I&#39;m getting off topic...)"}, {"owner": {"reputation": 91, "user_id": 7240331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4602e8aaf3f05b9509c90358d0507cc5?s=128&d=identicon&r=PG&f=1", "display_name": "Xcode23", "link": "https://stackoverflow.com/users/7240331/xcode23"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1570267505, "post_id": 58246794, "comment_id": 102865115, "body": "Yes you&#39;re right the whole liftM thing has nothing to do with the actual question it was just some context on why I was trying to do this composition, I will edit it out to make the actual question more clear. So if I understood what you said correctly rather than deciding that the m and t types were the same like I though it would it decided that m would become a function of type t a -&gt; b? How would that show up in mapM output type? (t a -&gt; b) (t b)? how is this a joinable thing specifically an m (m a)?"}, {"owner": {"reputation": 91, "user_id": 7240331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4602e8aaf3f05b9509c90358d0507cc5?s=128&d=identicon&r=PG&f=1", "display_name": "Xcode23", "link": "https://stackoverflow.com/users/7240331/xcode23"}, "reply_to_user": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 0, "creation_date": 1570268013, "post_id": 58246794, "comment_id": 102865224, "body": "Ok given your extended explanation which I hadn&#39;t seen when I was writing my comment. m becomes ((-&gt;) t a) and the output of mapM becomes (t a -&gt; t b)? How would (t a -&gt; t b) be a case of (m ( m a))?"}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1570268519, "post_id": 58246794, "comment_id": 102865321, "body": "Again I don&#39;t have much time (might make this into an answer later if no-one else has done it yet), but the output of <code>mapM</code> is <code>t a -&gt; m (t b)</code>. If <code>m</code> is the monad <code>(-&gt;) (t a)</code> then that&#39;s the same as <code>t a - &gt; t a -&gt; t b</code> - or <code>m (m (t b))</code> for the same monad. <code>join</code> turns that into <code>m (t b)</code>, or <code>t a -&gt; t b</code>."}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 7240331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4602e8aaf3f05b9509c90358d0507cc5?s=128&d=identicon&r=PG&f=1", "display_name": "Xcode23", "link": "https://stackoverflow.com/users/7240331/xcode23"}, "edited": false, "score": 0, "creation_date": 1570269810, "post_id": 58247162, "comment_id": 102865546, "body": "Oh join is counting the second input of mapM as part of its output because of currying and that matches with the chosen m to create an m(m a) situation. So the second t a in the type of  (join.mapM) isn&#39;t the second input of mapM as I though but the input of the function returned by the composition. So (a -&gt; t a -&gt; b) -&gt; (t a -&gt; t b) It makes sense when I stop thinking of mapM as a binary function, not very intuitive but it makes sense. Thanks"}], "tags": [], "owner": {"reputation": 43134, "user_id": 1726343, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/55744f355c4714fd473c50e799165a70?s=128&d=identicon&r=PG", "display_name": "Asad Saeeduddin", "link": "https://stackoverflow.com/users/1726343/asad-saeeduddin"}, "is_accepted": true, "score": 5, "last_activity_date": 1570269158, "creation_date": 1570269158, "answer_id": 58247162, "question_id": 58246794, "link": "https://stackoverflow.com/questions/58246794/why-can-function-composition-with-join-change-function-inputs/58247162#58247162", "title": "Why can function composition with `join` change function inputs?", "body": "<p>First you specialize <code>mapM</code> to:</p>\n\n<pre><code>mapM' :: Traversable t =&gt; (a -&gt; x -&gt; b) -&gt; t a -&gt; x -&gt; t b\n</code></pre>\n\n<p>(since <code>(-&gt;) x</code> is a monad)</p>\n\n<p>Then you specialize it further to:</p>\n\n<pre><code>mapM'' :: Traversable t =&gt; (a -&gt; t a -&gt; b) -&gt; t a -&gt; t a -&gt; t b\n</code></pre>\n\n<p>(we're just fixing the <code>x</code> to be <code>t a</code>)</p>\n\n<p>Finally we specialize <code>join</code> appropriately:</p>\n\n<pre><code>join' :: (x -&gt; x -&gt; r) -&gt; x -&gt; r\n</code></pre>\n\n<p>(again, <code>(-&gt;) x</code> is a monad)</p>\n\n<p>And hopefully it becomes more apparent why the composition <code>join' . mapM''</code> is</p>\n\n<pre><code>join' . mapM'' :: Traversable t =&gt; (a -&gt; t a -&gt; b) -&gt; t a -&gt; t b\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1570309671, "post_id": 58247382, "comment_id": 102874821, "body": "<code>mapT</code> is called <code>Data.Traversable.fmapDefault</code>."}], "tags": [], "owner": {"reputation": 61419, "user_id": 849891, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MbEO3.png?s=128&g=1", "display_name": "Will Ness", "link": "https://stackoverflow.com/users/849891/will-ness"}, "is_accepted": false, "score": 2, "last_activity_date": 1570313807, "last_edit_date": 1570313807, "creation_date": 1570270702, "answer_id": 58247382, "question_id": 58246794, "link": "https://stackoverflow.com/questions/58246794/why-can-function-composition-with-join-change-function-inputs/58247382#58247382", "title": "Why can function composition with `join` change function inputs?", "body": "<p>Maybe the following will be more illuminating, instead :</p>\n\n<pre><code>flip mapT :: (Traversable t, Monad m) =&gt; t a -&gt; (a -&gt; m b) -&gt; t (m b)\nsequenceA :: (Traversable t, Monad m) =&gt;                      t (m b) -&gt; m (t b)\nflip mapM :: (Traversable t, Monad m) =&gt; t a -&gt; (a -&gt; m b)            -&gt; m (t b)\n\n           flip liftM :: Monad m      =&gt; m a -&gt; (a -&gt; m b) -&gt; m (m b)\n join                 :: Monad m      =&gt;                      m (m b) -&gt; m    b\n(join .) . flip liftM :: Monad m      =&gt; m a -&gt; (a -&gt; m b)            -&gt; m    b\n(&gt;&gt;=)                 :: Monad m      =&gt; m a -&gt; (a -&gt; m b)            -&gt; m    b\n</code></pre>\n\n<p>(using some more specialized types than the most general ones, here and there; also with the <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Traversable.html#v:fmapDefault\" rel=\"nofollow noreferrer\">renamed</a> <code>mapT f = runIdentity . traverse (Identity . f)</code>).</p>\n\n<p>Your specific question is less interesting. Type derivation is a fully mechanical process. Some entities must be compatible for the whole expression to make sense, so their types must unify:</p>\n\n<pre><code> (join . mapM) a_mb  x  =       -- a_mb :: a -&gt; m b\n = join (mapM  a_mb) x\n = join   ta_mtb     x          -- ta_mtb :: t a -&gt; m (t b)\n</code></pre>\n\n<p>To join a function is to call it twice,</p>\n\n<pre><code> =        ta_mtb     x  x\n</code></pre>\n\n<p>which means <code>x</code> is a <code>t a</code> and so <code>m</code> is <code>t a -&gt;</code>: </p>\n\n<pre><code>        x :: t a \n ta_mtb   :: t a -&gt; m   (t b)\n ----------------------------\n ta_mtb x ::        m   (t b)\n          ~       t a -&gt; t b\n          x ::    t a \n ----------------------------\n ta_mtb x x ::           t b\n</code></pre>\n\n<p>thus <code>a_mb :: a -&gt; m b  ~  a -&gt; t a -&gt; b</code>.</p>\n"}], "owner": {"reputation": 91, "user_id": 7240331, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4602e8aaf3f05b9509c90358d0507cc5?s=128&d=identicon&r=PG&f=1", "display_name": "Xcode23", "link": "https://stackoverflow.com/users/7240331/xcode23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 58247162, "answer_count": 2, "score": 2, "last_activity_date": 1570313807, "creation_date": 1570265845, "last_edit_date": 1570287734, "question_id": 58246794, "link": "https://stackoverflow.com/questions/58246794/why-can-function-composition-with-join-change-function-inputs", "title": "Why can function composition with `join` change function inputs?", "body": "<p>I have recently started learning Haskell, and I was trying to do the following function composition (<code>join . mapM</code>) but got some weird types out of this function that I don't understand. I thought that either GHC would assume that <code>t == m</code> in the <code>mapM</code> type and the output of <code>mapM</code> would become <code>m (m b)</code> which would be join-able or it would not and this would error out because of type mismatch. Instead the following happened:</p>\n\n<pre><code>mapM :: (Traversable t, Monad m) =&gt; (a -&gt; m b) -&gt; t a -&gt; m (t b)\njoin :: Monad m =&gt; m (m a) -&gt; m a\njoin . mapM :: Traversable t =&gt; (a -&gt; t a -&gt; b) -&gt; t a -&gt; t b\n</code></pre>\n\n<p>I don't understand how this is possible. The way I understand it, function composition should use the inputs of the first (or the second depending how you look at it) function and the outputs of the second function. But here the expected input function for <code>mapM</code> changes from a unary function to a binary function and I have no clue why. Even if GHC can't just make the assumption that <code>t == m</code> like I did, which I half expected, it should error out because of type mismatch, not change the input function type, right? What is happening here? </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 24028, "user_id": 383200, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a9dc722f936cb1059adaae4fe39c07f0?s=128&d=identicon&r=PG", "display_name": "Carl", "link": "https://stackoverflow.com/users/383200/carl"}, "edited": false, "score": 3, "creation_date": 1570248245, "post_id": 58244653, "comment_id": 102862359, "body": "In general, yes. This is exactly the sort of thing the <code>pipes</code> and <code>conduit</code> libraries (and several others too) exist to do. I don&#39;t have experience with either myself, so examples will have to come from others."}], "answers": [{"comments": [{"owner": {"reputation": 8697, "user_id": 1055165, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d7c25776b0ca1c13212eea512370102d?s=128&d=identicon&r=PG", "display_name": "zoran119", "link": "https://stackoverflow.com/users/1055165/zoran119"}, "edited": false, "score": 0, "creation_date": 1570244869, "post_id": 58244932, "comment_id": 102861983, "body": "Yes, but I see <code>getContents</code> as one action that&#39;s lazy. I&#39;m specifically interested in multiple actions."}], "tags": [], "owner": {"reputation": 33166, "user_id": 7509065, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RZLo7.png?s=128&g=1", "display_name": "Joseph Sible-Reinstate Monica", "link": "https://stackoverflow.com/users/7509065/joseph-sible-reinstate-monica"}, "is_accepted": false, "score": 0, "last_activity_date": 1570243256, "creation_date": 1570243256, "answer_id": 58244932, "question_id": 58244653, "link": "https://stackoverflow.com/questions/58244653/lazy-evaluation-of-io-actions/58244932#58244932", "title": "Lazy evaluation of IO actions", "body": "<p>This seems to be in that spirit:</p>\n\n<pre><code>let (|&gt;) = flip ($)\nlet (.&gt;) = flip (.)\n\ngetContents &gt;&gt;= lines .&gt; takeWhile (/= \"quit\") .&gt; length .&gt; print\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "edited": false, "score": 0, "creation_date": 1570268032, "post_id": 58246976, "comment_id": 102865228, "body": "Related: <a href=\"https://stackoverflow.com/questions/47133634/the-haskell-way-to-do-io-loops-without-explicit-recursion/47143862#47143862\" title=\"the haskell way to do io loops without explicit recursion\">stackoverflow.com/questions/47133634/&hellip;</a> <a href=\"https://stackoverflow.com/questions/40317431/haskell-replace-mapm-in-a-monad-transformer-stack-to-achieve-lazy-evaluation-n/40317623#40317623\" title=\"haskell replace mapm in a monad transformer stack to achieve lazy evaluation n\">stackoverflow.com/questions/40317431/&hellip;</a> <a href=\"https://stackoverflow.com/questions/50178815/can-io-actions-be-sequenced-while-keeping-the-logic-in-a-pure-function/50181766#50181766\" title=\"can io actions be sequenced while keeping the logic in a pure function\">stackoverflow.com/questions/50178815/&hellip;</a>"}, {"owner": {"reputation": 8697, "user_id": 1055165, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d7c25776b0ca1c13212eea512370102d?s=128&d=identicon&r=PG", "display_name": "zoran119", "link": "https://stackoverflow.com/users/1055165/zoran119"}, "edited": false, "score": 0, "creation_date": 1570317184, "post_id": 58246976, "comment_id": 102876166, "body": "Sure, that will work, but my question is why do I need a streaming library? Why isn&#39;t the &quot;normal&quot; Haskell lazyness enough here?"}], "tags": [], "owner": {"reputation": 24211, "user_id": 1364288, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/JVtNl.png?s=128&g=1", "display_name": "danidiaz", "link": "https://stackoverflow.com/users/1364288/danidiaz"}, "is_accepted": false, "score": 1, "last_activity_date": 1570268592, "last_edit_date": 1570268592, "creation_date": 1570267370, "answer_id": 58246976, "question_id": 58244653, "link": "https://stackoverflow.com/questions/58244653/lazy-evaluation-of-io-actions/58246976#58246976", "title": "Lazy evaluation of IO actions", "body": "<p>Using the <a href=\"http://hackage.haskell.org/package/streaming-0.2.3.0/docs/Streaming-Prelude.html#v:repeatM\" rel=\"nofollow noreferrer\"><code>repeatM</code></a>, <a href=\"http://hackage.haskell.org/package/streaming-0.2.3.0/docs/Streaming-Prelude.html#v:takeWhile\" rel=\"nofollow noreferrer\"><code>takeWhile</code></a> and <a href=\"http://hackage.haskell.org/package/streaming-0.2.3.0/docs/Streaming-Prelude.html#v:length_\" rel=\"nofollow noreferrer\"><code>length_</code></a> functions from the <a href=\"http://hackage.haskell.org/package/streaming-0.2.3.0\" rel=\"nofollow noreferrer\">streaming</a> library:</p>\n\n<pre><code>import Streaming\nimport qualified Streaming.Prelude as S\n\ncount :: IO ()\ncount = do r &lt;- S.length_ . S.takeWhile (/= \"quit\") . S.repeatM $ getLine\n           print r\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 20310, "user_id": 525980, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/8dafe66793ee2f32192e9fcefb389a12?s=128&d=identicon&r=PG", "display_name": "Clinton", "link": "https://stackoverflow.com/users/525980/clinton"}, "is_accepted": false, "score": 0, "last_activity_date": 1575351928, "creation_date": 1575351928, "answer_id": 59150850, "question_id": 58244653, "link": "https://stackoverflow.com/questions/58244653/lazy-evaluation-of-io-actions/59150850#59150850", "title": "Lazy evaluation of IO actions", "body": "<p>The issue here is that <code>Monad</code> is not the right abstraction for this, and attempting to do something like this results in a situation where referential transparency is broken.</p>\n\n<p>Firstly, we can do a lazy IO read like so:</p>\n\n<pre><code>module Main where\n\nimport System.IO.Unsafe (unsafePerformIO)\nimport Control.Monad(forM_)\n\nlazyIOSequence :: [IO a] -&gt; IO [a]\nlazyIOSequence = pure . go where\n    go :: [IO a] -&gt; [a]\n    go (l:ls) = (unsafePerformIO l):(go ls)\n\n\nmain :: IO ()\nmain = do\n    l &lt;- lazyIOSequence (repeat getLine)\n    forM_ l putStrLn \n</code></pre>\n\n<p>This when run will perform <code>cat</code>. It will read lines and output them. Everything works fine. </p>\n\n<p>But consider changing the main function to this:</p>\n\n<pre><code>main :: IO ()\nmain = do\n    l &lt;- lazyIOSequence (map (putStrLn . show) [1..])\n    putStrLn \"Hello World\"\n</code></pre>\n\n<p>This outputs <code>Hello World</code> only, as we didn't need to evaluate any of <code>l</code>. But now consider replacing the last line like the following:</p>\n\n<pre><code>main :: IO ()\nmain = do\n    x &lt;- lazyIOSequence (map (putStrLn . show) [1..])\n    seq (head x) putStrLn \"Hello World\"\n</code></pre>\n\n<p>Same program, but the output is now:</p>\n\n<pre><code>1\nHello World\n</code></pre>\n\n<p>This is bad, we've changed the results of a program just by evaluating a value. This is not supposed to happen in Haskell, when you evaluate something it should just evaluate it, not change the outside world.</p>\n\n<p>So if you restrict your IO actions to something like reading from a file nothing else is reading from, then you might be able to sensibly lazily evaluate things, because when you read from it in relation to all the other IO actions your program is taking doesn't matter. But you don't want to allow this for IO in general, because skipping actions or performing them in a different order can matter (and above, certainly does). Even in the reading a file lazily case, if something else in your program writes to the file, then whether you evaluate that list before or after the write action will affect the output of your program, which again, breaks referential transparency (because evaluation order shouldn't matter). </p>\n\n<p>So for a restricted subset of IO actions, you can sensibly define Functor, Applicative and Monad on a stream type to work in a lazy way, but doing so in the IO Monad in general is a minefield and often just plain incorrect. Instead you want a specialised streaming type, and indeed <a href=\"https://hackage.haskell.org/package/conduit-1.3.1.1/docs/Data-Conduit.html\" rel=\"nofollow noreferrer\">Conduit</a> defines Functor, Applicative and Monad on a lot of it's types so you can still use all your favourite functions. </p>\n"}], "owner": {"reputation": 8697, "user_id": 1055165, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/d7c25776b0ca1c13212eea512370102d?s=128&d=identicon&r=PG", "display_name": "zoran119", "link": "https://stackoverflow.com/users/1055165/zoran119"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1575351928, "creation_date": 1570238577, "question_id": 58244653, "link": "https://stackoverflow.com/questions/58244653/lazy-evaluation-of-io-actions", "title": "Lazy evaluation of IO actions", "body": "<p>I'm trying to write code in <code>source -&gt; transform -&gt; sink</code> style, for example:</p>\n\n<pre><code>let (|&gt;) = flip ($)\nrepeat 1 |&gt; take 5 |&gt; sum |&gt; print\n</code></pre>\n\n<p>But would like to do that using <code>IO</code>. I have this impression that my source can be an infinite list of IO actions, and each one gets evaluated once it is needed downstream. Something like this:</p>\n\n<pre><code>-- prints the number of lines entered before \"quit\" is entered\n[getLine..] &gt;&gt;= takeWhile (/= \"quit\") &gt;&gt;= length &gt;&gt;= print\n</code></pre>\n\n<p>I think this is possible with the streaming libraries, but can it be done along the lines of what I'm proposing?</p>\n"}, {"tags": ["haskell", "type-conversion"], "comments": [{"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1570216540, "post_id": 58242024, "comment_id": 102856315, "body": "I do not think that is sufficient, since <code>(%)</code> has type <code>(%) :: Integral a =&gt; a -&gt; a -&gt; Ratio a</code>, it thus can not take a <code>Ratio Integer</code> as second parameter."}, {"owner": {"reputation": 133, "user_id": 10376932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9457766f88a4a77bd70b8e5ca9b32679?s=128&d=identicon&r=PG&f=1", "display_name": "oldsailorpopoye", "link": "https://stackoverflow.com/users/10376932/oldsailorpopoye"}, "reply_to_user": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 0, "creation_date": 1570217083, "post_id": 58242024, "comment_id": 102856503, "body": "Alright. Is Rational and Ratio Integer the same thing?"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 2, "creation_date": 1570217110, "post_id": 58242024, "comment_id": 102856515, "body": "yes, <code>type Rational = Ratio Integer</code>."}], "answers": [{"comments": [{"owner": {"reputation": 133, "user_id": 10376932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9457766f88a4a77bd70b8e5ca9b32679?s=128&d=identicon&r=PG&f=1", "display_name": "oldsailorpopoye", "link": "https://stackoverflow.com/users/10376932/oldsailorpopoye"}, "edited": false, "score": 0, "creation_date": 1570217615, "post_id": 58242112, "comment_id": 102856709, "body": "I see, makes so sense now. Could you also tell me why &quot;(((toRational 1)%1) % f xs)&quot; is treated as Rational while &quot;1 % f xs&quot; is treated as Ratio Rational? I believe that the second is treated so because f yields rationals and so the (%) coupled, gives you the Ratio Rational. How did the first one become a pure Rational?"}, {"owner": {"reputation": 133, "user_id": 10376932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9457766f88a4a77bd70b8e5ca9b32679?s=128&d=identicon&r=PG&f=1", "display_name": "oldsailorpopoye", "link": "https://stackoverflow.com/users/10376932/oldsailorpopoye"}, "edited": false, "score": 0, "creation_date": 1570217685, "post_id": 58242112, "comment_id": 102856735, "body": "As Willem Van Onsem commented before, the type has to be Integral, which isn&#39;t the case here apparently."}, {"owner": {"reputation": 133, "user_id": 10376932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9457766f88a4a77bd70b8e5ca9b32679?s=128&d=identicon&r=PG&f=1", "display_name": "oldsailorpopoye", "link": "https://stackoverflow.com/users/10376932/oldsailorpopoye"}, "edited": false, "score": 0, "creation_date": 1570217878, "post_id": 58242112, "comment_id": 102856795, "body": "Additionally, I could have just changed the (%) in the last statement of my post to (/) and write the x as &quot;x%1&quot; (or &quot;toRational x&quot;) in all places. Thank you nonetheless!"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 133, "user_id": 10376932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9457766f88a4a77bd70b8e5ca9b32679?s=128&d=identicon&r=PG&f=1", "display_name": "oldsailorpopoye", "link": "https://stackoverflow.com/users/10376932/oldsailorpopoye"}, "edited": false, "score": 0, "creation_date": 1570217952, "post_id": 58242112, "comment_id": 102856826, "body": "@charles: note the difference between <code>(%)</code> and <code>(&#47;)</code>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "reply_to_user": {"reputation": 133, "user_id": 10376932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9457766f88a4a77bd70b8e5ca9b32679?s=128&d=identicon&r=PG&f=1", "display_name": "oldsailorpopoye", "link": "https://stackoverflow.com/users/10376932/oldsailorpopoye"}, "edited": false, "score": 0, "creation_date": 1570220427, "post_id": 58242112, "comment_id": 102857669, "body": "@charlesh Not sure about why that is a <code>Rational</code>. It doesn&#39;t look as such to me. (?)"}], "tags": [], "owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "is_accepted": true, "score": 3, "last_activity_date": 1570220351, "last_edit_date": 1570220351, "creation_date": 1570216808, "answer_id": 58242112, "question_id": 58242024, "link": "https://stackoverflow.com/questions/58242024/haskell-how-to-convert-from-ratio-integer-to-ratio-rational/58242112#58242112", "title": "(Haskell) How to convert from Ratio Integer to Ratio Rational?", "body": "<p>No type conversion needed, use proper division between rationals.</p>\n\n<pre><code>import Data.Ratio\n\nf :: [Integer] -&gt; Rational\nf []           = error \"empty list\"\nf [x]          = x % 1\nf (x:xs@(_:_)) = x % 1 + 1 / f xs\n</code></pre>\n\n<p>Here, <code>x % 1</code> makes <code>x</code> into a <code>Rational</code> (ok, that's conversion, if you want). We could also have used <code>fromInteger</code>, I think.</p>\n\n<p>Then, between <code>Rational</code> values, we do not use <code>%</code> which produces a weird <code>Ratio Rational</code>, but we exploit <code>/</code> which produces a <code>Rational</code> instead.</p>\n"}, {"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": false, "score": 2, "last_activity_date": 1570217917, "last_edit_date": 1570217917, "creation_date": 1570217065, "answer_id": 58242155, "question_id": 58242024, "link": "https://stackoverflow.com/questions/58242024/haskell-how-to-convert-from-ratio-integer-to-ratio-rational/58242155#58242155", "title": "(Haskell) How to convert from Ratio Integer to Ratio Rational?", "body": "<p>Converting <code>x</code> to a <code>Rational</code> will not be sufficient here. Since you here write <code>1 % f xs</code>. The type of <code>(%)</code> is <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Ratio.html#v:-37-\" rel=\"nofollow noreferrer\"><strong><code>(%) :: Integral a =&gt; a -&gt; a -&gt; Ratio a</code></strong></a>, and since <code>f xs</code> is a <code>Rational</code>, and <code>Rational</code> is not an instance of <code>Integral</code>, we thus need to fix a second issue.</p>\n\n<p>It is however not that hard. We can for example make a function that calculates the inverse:</p>\n\n<pre><code>inverseR :: Integral a =&gt; Ratio a -&gt; Ratio a\ninverseR r = denominator r % numerator r</code></pre>\n\n<p>Since <code>Ratio a</code> is an instance of <code>Num</code> given <code>a</code> is an instance of <code>Integral</code>, we can use <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Data-Ratio.html#v:fromInteger\" rel=\"nofollow noreferrer\"><strong><code>fromInteger :: Num a =&gt; Integer -&gt; a</code></strong></a>:</p>\n\n<pre><code>f :: [Integer] -&gt; Rational\nf [x] = fromInteger x\nf (x:xs) = fromInteger x + inverseR (f xs)\n</code></pre>\n\n<p>For example:</p>\n\n<pre><code>Prelude Data.Ratio&gt; f [1,4,2,5]\n60 % 49\n</code></pre>\n\n<p>Since 1 + 1/(4 + 1/(2 + 1/5)) = 1 + 1/(4 + 1/(11/5)) = 1 + 1/(4 + 5/11) = 1 + 1/(49/11) = 1 + 11/49 = 60 / 49.</p>\n\n<p>We can further improve this by:</p>\n\n<ol>\n<li>using <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:fromIntegral\" rel=\"nofollow noreferrer\"><strong><code>fromIntegral :: (Integral a, Num b) =&gt; a -&gt; b</code></strong></a> to convert any integral to a <code>Ratio</code>; and</li>\n<li>by using <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:-47-\" rel=\"nofollow noreferrer\"><strong><code>(/) :: Fractional a =&gt; a -&gt; a -&gt; a</code></strong></a>.</li>\n</ol>\n\n<p>We thus can generalize this to a function:</p>\n\n<pre><code>f :: (Integral a, Fractional b) =&gt; [a] -&gt; b\nf [x] = fromIntegral x\nf (x:xs) = fromIntegral x + 1 / f xs\n</code></pre>\n\n<p>Which yields the same value:</p>\n\n<pre><code>Prelude Data.Ratio&gt; f [1,4,2,5] :: Rational\n60 % 49\n</code></pre>\n\n<p>We can use a <code>foldr</code> pattern, and avoid the explicit recursion:</p>\n\n<pre><code>f :: (Integral a, Fractional b) =&gt; [a] -&gt; b\nf = foldr1 (\\x -&gt; (x +) . (1 /)) . map fromIntegral\n</code></pre>\n"}], "owner": {"reputation": 133, "user_id": 10376932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9457766f88a4a77bd70b8e5ca9b32679?s=128&d=identicon&r=PG&f=1", "display_name": "oldsailorpopoye", "link": "https://stackoverflow.com/users/10376932/oldsailorpopoye"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 473, "favorite_count": 0, "accepted_answer_id": 58242112, "answer_count": 2, "score": 1, "last_activity_date": 1570220351, "creation_date": 1570216336, "question_id": 58242024, "link": "https://stackoverflow.com/questions/58242024/haskell-how-to-convert-from-ratio-integer-to-ratio-rational", "title": "(Haskell) How to convert from Ratio Integer to Ratio Rational?", "body": "<p>How does addition of two different ratios work? For instance, ratio integer and ratio rationals don't seem to get added. I tried evaluating the continued fraction for a given list.</p>\n\n<p>Here's the code :</p>\n\n<pre><code>import Data.Ratio\nf :: [Integer] -&gt; Rational\nf(x:xs)\n  | (null xs == True) = x\n  | otherwise       = x + (1 % f xs)\n</code></pre>\n\n<p>What is the correct version of the code supposed to be? Since f yields a Ratio Rational, I feel that x, if type-casted to a Ratio rational number, will suffice.</p>\n"}, {"tags": ["haskell", "cabal"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 8739253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e14134b6575b2909b4feac386aac9354?s=128&d=identicon&r=PG&f=1", "display_name": "poopsmith", "link": "https://stackoverflow.com/users/8739253/poopsmith"}, "edited": false, "score": 0, "creation_date": 1570383810, "post_id": 58241864, "comment_id": 102888228, "body": "awesome thank you! looks like that worked. I&#39;m not totally sure about what you mean about &#39;managing GHC&#39;. In the error messages, the say to use new-install, but I still run into issues when I do that."}, {"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "reply_to_user": {"reputation": 21, "user_id": 8739253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e14134b6575b2909b4feac386aac9354?s=128&d=identicon&r=PG&f=1", "display_name": "poopsmith", "link": "https://stackoverflow.com/users/8739253/poopsmith"}, "edited": false, "score": 0, "creation_date": 1570384777, "post_id": 58241864, "comment_id": 102888509, "body": "@poopsmith By managing GHC I mean the ability to install different versions of GHC, set the default GHC version, remove installed versions, see all installed versions, etc. If you have <code>cabal-install</code> version &gt;= 3.0, then you can use <code>cabal build</code> command (<code>new-build</code> became the default in the 3.0 version). <code>new-build</code> is better in general and doesn&#39;t have some problems of the old build. But it doesn&#39;t solve all problems automatically."}, {"owner": {"reputation": 21, "user_id": 8739253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e14134b6575b2909b4feac386aac9354?s=128&d=identicon&r=PG&f=1", "display_name": "poopsmith", "link": "https://stackoverflow.com/users/8739253/poopsmith"}, "edited": false, "score": 0, "creation_date": 1570402137, "post_id": 58241864, "comment_id": 102892038, "body": "Ok I understand. I&#39;ve never really dealt or had to worry about things like versions, package/library managers, and different &#39;production&#39; or &#39;larger project&#39; -type issues for any programming language. Most of it has been plug n play, but I&#39;d like to learn haskell and the ecosystem deeper, so thanks for helping!"}], "tags": [], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "is_accepted": false, "score": 2, "last_activity_date": 1570215495, "creation_date": 1570215495, "answer_id": 58241864, "question_id": 58240576, "link": "https://stackoverflow.com/questions/58240576/cabal-install-trouble-resolving-dependencies/58241864#58241864", "title": "Cabal Install trouble resolving dependencies", "body": "<p>You can find the following guide to build tools in Haskell useful:</p>\n\n<ul>\n<li><a href=\"https://kowainik.github.io/posts/2018-06-21-haskell-build-tools\" rel=\"nofollow noreferrer\">https://kowainik.github.io/posts/2018-06-21-haskell-build-tools</a></li>\n</ul>\n\n<p>According the error message, it looks like in your <code>.cabal</code> file you have a line like</p>\n\n<pre><code>build-depends: base == 4.6.*\n</code></pre>\n\n<p>This version of the standard library <code>base</code> is very old, it corresponds to GHC-7.6, however, according to the error message, you have GHC-8.6.5 installed. Since <code>base</code> versions are bundled with GHC, you can't use <code>base</code> for GHC you didn't install. See the following list of matching <code>base</code> and GHC versions:</p>\n\n<ul>\n<li><a href=\"https://wiki.haskell.org/Base_package\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Base_package</a></li>\n</ul>\n\n<p>It looks like your error can be resolved by the following fix:</p>\n\n<pre><code>build-depends: base == 4.12.*\n</code></pre>\n\n<p>For the future, I can recommend using <code>ghcup</code> tool to manage GHC and <code>cabal-install</code> versions on macOS:</p>\n\n<ul>\n<li><a href=\"https://www.haskell.org/ghcup/\" rel=\"nofollow noreferrer\">https://www.haskell.org/ghcup/</a></li>\n</ul>\n\n<p>Alternatively, you can use <code>stack</code> build tool, it manages GHC versions for you in a sandboxed location.</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 12149371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfa84517b8a8d5dc87fdaddfe3b24abf?s=128&d=identicon&r=PG&f=1", "display_name": "thmnd", "link": "https://stackoverflow.com/users/12149371/thmnd"}, "is_accepted": false, "score": -1, "last_activity_date": 1570436514, "creation_date": 1570436514, "answer_id": 58265814, "question_id": 58240576, "link": "https://stackoverflow.com/questions/58240576/cabal-install-trouble-resolving-dependencies/58265814#58265814", "title": "Cabal Install trouble resolving dependencies", "body": "<blockquote>\n  <p><em>Famous \"cabal hell\".</em></p>\n</blockquote>\n\n<p>You're better use newest package manager <a href=\"https://docs.haskellstack.org/en/stable/README/\" rel=\"nofollow noreferrer\">https://docs.haskellstack.org/en/stable/README/</a> .</p>\n"}], "owner": {"reputation": 21, "user_id": 8739253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e14134b6575b2909b4feac386aac9354?s=128&d=identicon&r=PG&f=1", "display_name": "poopsmith", "link": "https://stackoverflow.com/users/8739253/poopsmith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1498, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1570436514, "creation_date": 1570208746, "question_id": 58240576, "link": "https://stackoverflow.com/questions/58240576/cabal-install-trouble-resolving-dependencies", "title": "Cabal Install trouble resolving dependencies", "body": "<p>I'm following this tutorial trying to set up a Haskell project: <a href=\"http://shuklan.com/haskell/lec10.html#/0/9\" rel=\"nofollow noreferrer\">http://shuklan.com/haskell/lec10.html#/0/9</a></p>\n\n<p>I've had this issue before with 'cabal install'. </p>\n\n<p>I get the message below. I read to try 'rm -rf ~/.ghc ~/.cabal'. I tried that and 'cabal install' again, along with 'cabal new-build' but I still get the same message. </p>\n\n<p>How can I fix this? I'm on Mac OS X 10.11.4. I can make and run .hs files and us ghci. I've never created a \"file structure\" or anything like that with other programming languages, so I'm not familiar with what's involved.</p>\n\n<p>Thank you!!</p>\n\n<pre><code>\nPlease switch to using either the new project style and the new-install\ncommand or the legacy v1-install alias as new-style projects will become the\ndefault in the next version of cabal-install. Please file a bug if you cannot\nreplicate a working v1- use case with the new-style commands.\n\nFor more information, see: https://wiki.haskell.org/Cabal/NewBuild\n\nResolving dependencies...\ncabal: Could not resolve dependencies:\n[__0] trying: FirstCabalInit-0.1.0.0 (user goal)\n[__1] next goal: base (dependency of FirstCabalInit)\n[__1] rejecting: base-4.12.0.0/installed-4.1... (conflict: FirstCabalInit =&gt;\nbase==4.6.*)\n[__1] rejecting: base-4.12.0.0, base-4.11.1.0, base-4.11.0.0, base-4.10.1.0,\nbase-4.10.0.0, base-4.9.1.0, base-4.9.0.0, base-4.8.2.0, base-4.8.1.0,\nbase-4.8.0.0, base-4.7.0.2, base-4.7.0.1, base-4.7.0.0, base-4.6.0.1,\nbase-4.6.0.0, base-4.5.1.0, base-4.5.0.0, base-4.4.1.0, base-4.4.0.0,\nbase-4.3.1.0, base-4.3.0.0, base-4.2.0.2, base-4.2.0.1, base-4.2.0.0,\nbase-4.1.0.0, base-4.0.0.0, base-3.0.3.2, base-3.0.3.1 (constraint from\nnon-upgradeable package requires installed instance)\n[__1] fail (backjumping, conflict set: FirstCabalInit, base)\nAfter searching the rest of the dependency tree exhaustively, these were the\ngoals I've had most trouble fulfilling: base, FirstCabalInit ```\n</code></pre>\n"}, {"tags": ["haskell", "math"], "comments": [{"owner": {"reputation": 2360, "user_id": 367332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6D0rd.png?s=128&g=1", "display_name": "DarthFennec", "link": "https://stackoverflow.com/users/367332/darthfennec"}, "edited": false, "score": 5, "creation_date": 1570208106, "post_id": 58240377, "comment_id": 102853231, "body": "Looks very close to zero to me. Perhaps a rounding or floating point error?"}, {"owner": {"reputation": 73919, "user_id": 44309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iL4TW.png?s=128&g=1", "display_name": "High Performance Mark", "link": "https://stackoverflow.com/users/44309/high-performance-mark"}, "edited": false, "score": 7, "creation_date": 1570208130, "post_id": 58240377, "comment_id": 102853236, "body": "Quickly, before someone recommends that you familiarise yourself with <i>What Every Computer Scientist Should Know About Floating Point Arithmetic</i>, do some research on how floating point numbers work and why you might think that <code>-6.252776074688882e-13</code> is a good approximation to <code>0</code>."}, {"owner": {"reputation": 8621, "user_id": 1848029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qfjAy.jpg?s=128&g=1", "display_name": "lehins", "link": "https://stackoverflow.com/users/1848029/lehins"}, "edited": false, "score": 4, "creation_date": 1570208258, "post_id": 58240377, "comment_id": 102853285, "body": "Also note that Wolfram tells you an approximate solution for <code>x \u2243 0.331478863194230</code>"}, {"owner": {"reputation": 73919, "user_id": 44309, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iL4TW.png?s=128&g=1", "display_name": "High Performance Mark", "link": "https://stackoverflow.com/users/44309/high-performance-mark"}, "edited": false, "score": 4, "creation_date": 1570208406, "post_id": 58240377, "comment_id": 102853344, "body": "And this is a good place to start your research ...  <a href=\"https://stackoverflow.com/questions/588004/is-floating-point-math-broken\">Is floating point math broken?</a>"}, {"owner": {"reputation": 69207, "user_id": 1440565, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/ec430cc01ef4cf4ae63ebbe9e8596f72?s=128&d=identicon&r=PG", "display_name": "Code-Apprentice", "link": "https://stackoverflow.com/users/1440565/code-apprentice"}, "edited": false, "score": 0, "creation_date": 1570211698, "post_id": 58240377, "comment_id": 102854618, "body": "<code>x \u2243 0.331478863194230</code> Since this is an approximation of a root of the polynomial, you shouldn&#39;t be surprised that <code>f(x)</code> is also <i>approximately</i> zero. Note the <code>e-13</code> on the end. This means that the answer is on the order of <code>10^-13</code>, so very small."}, {"owner": {"reputation": 2485, "user_id": 11282404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c1e3829cb91cc6be3541a37381b5ff21?s=128&d=identicon&r=PG&f=1", "display_name": "jpmarinier", "link": "https://stackoverflow.com/users/11282404/jpmarinier"}, "edited": false, "score": 2, "creation_date": 1570211830, "post_id": 58240377, "comment_id": 102854671, "body": "What if <b>inside Wolfram</b> you ask back for the value of the polynomial function at its <i>approximate</i> root ? Does Wolfram tell you it is exactly zero ??"}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1570214562, "post_id": 58240377, "comment_id": 102855647, "body": "Using <a href=\"https://en.wikipedia.org/wiki/Horner&#39;s_method\" rel=\"nofollow noreferrer\">Horner&#39;s Method</a> (using <code>k x = (((27*x + 1792)*x + 2592)*x - 324)*x - 243)</code>) will get you the slightly more accurate answer <code>-5.684341886080801e-13</code>."}, {"owner": {"reputation": 21073, "user_id": 3088138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/114f33fdece969de35d41038fb0eeb46?s=128&d=identicon&r=PG&f=1", "display_name": "Lutz Lehmann", "link": "https://stackoverflow.com/users/3088138/lutz-lehmann"}, "edited": false, "score": 0, "creation_date": 1570531372, "post_id": 58240377, "comment_id": 102934592, "body": "Using more digits the Horner formula gives 0.0 for the floating point evaluation at x=0.33147886319423027. The original monomial formula gives there the value -2.84e-14 while a little to the right x=0.33147886319423033 the floating point evaluation gives 5.68e-14. At about x=0.331478863194230283 the value jumps from the lower to the higher."}], "answers": [{"comments": [{"owner": {"reputation": 14582, "user_id": 2225384, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f30b04ed4d0b3fc4bc791a28815f34ca?s=128&d=identicon&r=PG", "display_name": "Rein Henrichs", "link": "https://stackoverflow.com/users/2225384/rein-henrichs"}, "edited": false, "score": 0, "creation_date": 1570293158, "post_id": 58241128, "comment_id": 102870875, "body": "You could go even further than <code>Rational</code> with <code>CReal</code> here, I think, if you wanted to."}, {"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1570297472, "post_id": 58241128, "comment_id": 102872013, "body": "@Daniel Wagner could you share some complete code that I could put into <a href=\"https://repl.it/languages/haskell\" rel=\"nofollow noreferrer\">repl.it/languages/haskell</a> or <a href=\"https://www.tryhaskell.org/\" rel=\"nofollow noreferrer\">tryhaskell.org</a>, I have not been able to get your edits to my answer to work, and not sure how to respond to Rein Henrichs suggestion."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1570310549, "post_id": 58241128, "comment_id": 102875022, "body": "@AmitKumarGupta The only additional line of code needed is from the question itself: <code>k x = 27 * x ^ 4 + 1792 * x ^ 3 + 2592 * x ^ 2 - 324 * x - 243</code>. (No modifications are needed for this to support both <code>Double</code> and <code>Rational</code>.) I think <code>CReal</code> is not a super interesting next step from <code>Rational</code>, personally; I suspect it was suggested because it is another type for arbitrary-precision calculations, but <code>Rational</code> already gives an exact answer, so why bother with the extra complications/slowness of <code>CReal</code>?"}], "tags": [], "owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "is_accepted": false, "score": 6, "last_activity_date": 1570313858, "last_edit_date": 1570313858, "creation_date": 1570211477, "answer_id": 58241128, "question_id": 58240377, "link": "https://stackoverflow.com/questions/58240377/haskell-incorrect-math-results/58241128#58241128", "title": "Haskell: incorrect math results", "body": "<p>By the <a href=\"https://en.wikipedia.org/wiki/Rational_root_theorem\" rel=\"nofollow noreferrer\">Rational Root Theorem</a>, it's easy to see this polynomial has no rational roots. So Wolfram would never be able to show you an exact answer in decimal form. It of course has to round to a near approximation, and even indicates it's doing so with the <code>\u2243</code> symbol. It's not surprising that plugging that approximate root into your function doesn't output 0.</p>\n\n<p>In fact, if you avoid floating point numbers you can see with arbitrary precision what the output would be when passing that input:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code> &gt; k x = 27 * x ^ 4 + 1792 * x ^ 3 + 2592 * x ^ 2 - 324 * x - 243\n &gt; k 0.331478863194230 :: Rational\n=&gt; (-54003681976002235123002052941041334918065893) % 100000000000000000000000000000000000000000000000000000000\n</code></pre>\n\n<p>which is</p>\n\n<pre><code>-5.4003681976002235123002052941041334918065893e-13\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 12165561, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-CwzzwmxUuDI/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcHMMCIzeLkxetu1fca-GfqpL2TiQ/photo.jpg?sz=128", "display_name": "Tomasz Surowiec", "link": "https://stackoverflow.com/users/12165561/tomasz-surowiec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 117, "favorite_count": 0, "closed_date": 1570214326, "answer_count": 1, "score": 4, "last_activity_date": 1570313858, "creation_date": 1570207694, "question_id": 58240377, "link": "https://stackoverflow.com/questions/58240377/haskell-incorrect-math-results", "closed_reason": "Duplicate", "title": "Haskell: incorrect math results", "body": "<p>I'm trying to use Haskell for evaluating a few functions.\nOne of them is:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>k x = 27 * x ^ 4 + 1792 * x ^ 3 + 2592 * x ^ 2 - 324 * x - 243\n</code></pre>\n\n<p>Using wolfram alpha I've found it's root:</p>\n\n<pre><code>27x^4 + 1792x^3 + 2592x^2 - 324x - 243 = 0\n=&gt; x \u2243 0.331478863194230\n</code></pre>\n\n<p>But haskell gives the wrong answer when evaluated with the root:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>k 0.331478863194230 == -6.252776074688882e-13\n</code></pre>\n\n<p>I'm sure it's not Wolfram's issue, as Desmos gives the same <a href=\"https://www.desmos.com/calculator/bti09px9ng\" rel=\"nofollow noreferrer\">result</a>.\nI'm not that familiar with Haskell and I wonder what might be the cause of this quirky behavior.</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 2, "creation_date": 1570203305, "post_id": 58239344, "comment_id": 102851357, "body": "The code, as written, does not compile. Show us your real code."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1570203432, "post_id": 58239344, "comment_id": 102851424, "body": "After the obvious fix, it <a href=\"https://ideone.com/e0iHM0\" rel=\"nofollow noreferrer\">seems to work fine</a>."}, {"owner": {"reputation": 19, "user_id": 12165245, "user_type": "registered", "profile_image": "https://graph.facebook.com/2468103800127281/picture?type=large", "display_name": "Sherry Usman", "link": "https://stackoverflow.com/users/12165245/sherry-usman"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1570203997, "post_id": 58239344, "comment_id": 102851649, "body": "What is the obvious fix?"}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1570204153, "post_id": 58239344, "comment_id": 102851727, "body": "Check the link I posted above for the full code."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1570206982, "post_id": 58239344, "comment_id": 102852777, "body": "Using <code>null</code> to check for an empty list is more efficient than computing its length, then comparing that to 0."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1570207013, "post_id": 58239344, "comment_id": 102852793, "body": "Also, you don&#39;t need two cases. <code>isPrime n = not (null [x | ...])</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1830, "user_id": 3343753, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aY4qS.jpg?s=128&g=1", "display_name": "Pedro Rodrigues", "link": "https://stackoverflow.com/users/3343753/pedro-rodrigues"}, "is_accepted": false, "score": 0, "last_activity_date": 1570208721, "creation_date": 1570208721, "answer_id": 58240570, "question_id": 58239344, "link": "https://stackoverflow.com/questions/58239344/isprime-function-in-haskell-is-generating-non-exhaustive-patterns-error-what-is/58240570#58240570", "title": "isPrime function in Haskell is generating non-exhaustive patterns error. What is wrong?", "body": "<p>Posting on behalf of @chi</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>isPrime :: Int -&gt; Bool\nisPrime 1 = False \nisPrime 2 = True\nisPrime n\n  | (length [x | x&lt;-[2 .. n-1],  mod n x == 0]) &gt; 0 = False \n  | otherwise = True \n\n\nmain = do\n  print (isPrime 7)\n  print (isPrime 8)\n  print (isPrime 9)\n  print (isPrime 10)\n  print (isPrime 11)\n  print (isPrime 12)\n</code></pre>\n\n<p>Stdout</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>True\nFalse\nFalse\nFalse\nTrue\nFalse\n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 12165245, "user_type": "registered", "profile_image": "https://graph.facebook.com/2468103800127281/picture?type=large", "display_name": "Sherry Usman", "link": "https://stackoverflow.com/users/12165245/sherry-usman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1570208721, "creation_date": 1570202821, "last_edit_date": 1570203191, "question_id": 58239344, "link": "https://stackoverflow.com/questions/58239344/isprime-function-in-haskell-is-generating-non-exhaustive-patterns-error-what-is", "title": "isPrime function in Haskell is generating non-exhaustive patterns error. What is wrong?", "body": "<p>I am writing an isPrime function in Haskell and I keep getting errors like \"Non-exhaustive patterns in function isPrime\". What cases am I not considering?</p>\n\n<pre><code>isPrime :: Int -&gt; Bool\nisPrime 1 = False \nisPrime 2 = True\nisPrime n = (length [x | x&lt;-[2 .. n-1],  mod n x == 0]) &gt; 0 = False \n| otherwise = True \n</code></pre>\n"}, {"tags": ["haskell", "floating-point", "rounding"], "comments": [{"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1570206018, "post_id": 58239327, "comment_id": 102852440, "body": "What do you currently use to display these numbers?"}, {"owner": {"reputation": 109, "user_id": 10628180, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-7bTVQYf2k74/AAAAAAAAAAI/AAAAAAAADCM/l_PdWAySHfg/photo.jpg?sz=128", "display_name": "Osa", "link": "https://stackoverflow.com/users/10628180/osa"}, "reply_to_user": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "edited": false, "score": 0, "creation_date": 1570208706, "post_id": 58239327, "comment_id": 102853436, "body": "I use printf, and I can display 5.545 as 5.54, but I want it to be 5.55 since the 3rd decimal is a 5"}, {"owner": {"reputation": 139300, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 2, "creation_date": 1570211986, "post_id": 58239327, "comment_id": 102854736, "body": "When your implementation uses IEEE-754 binary64 for floating-point, <b>there is no number 5.545</b> in the type. That format represents numbers in a binary format, and the nearest number to 5.545 it can represent is 5.5449999999999999289457264239899814128875732421875. So display methods may show you \u201c5.545\u201d, but they are not showing the actual number. The fact that the number is <b>not</b> 5.545 is why rounding it to two decimal digits produces \u201c5.54\u201d and not \u201c5.55\u201d."}, {"owner": {"reputation": 139300, "user_id": 298225, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef102f4ee36e58d09e0b27cd5393a1d8?s=128&d=identicon&r=PG", "display_name": "Eric Postpischil", "link": "https://stackoverflow.com/users/298225/eric-postpischil"}, "edited": false, "score": 1, "creation_date": 1570212153, "post_id": 58239327, "comment_id": 102854809, "body": "A consequence of this is that, as long as you are using the IEEE-754 binary64 format, <b>no rounding technique can cause 5.545 to be displayed as \u201c5.55\u201d</b> because it is impossible to pass 5.545 as a number to be rounded\u2014that number does not exist in IEEE-754 binary64, and no algorithm can work on an input that is never passed to it. There may be other solutions, such as using formats other than the built-in floating-point type (e.g., use integer arithmetic as a manual fixed-point solution and format the results with your own code). You should explain more about the context of this problem."}], "answers": [{"comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1570213815, "post_id": 58240690, "comment_id": 102855412, "body": "Adding 0.005 doesn&#39;t really work right, either... <code>printf &quot;%.2f&quot; (5.544 + 0.005)</code> produces <code>5.55</code>, but the correctly rounded answer is <code>5.54</code>."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1570214493, "post_id": 58240690, "comment_id": 102855625, "body": "Yes, @DanielWagner, I have totally misread the question, not once, but twice! :-/   Thank you for pointing out."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1570215011, "post_id": 58240690, "comment_id": 102855818, "body": "No matter how much you want it to work, adding a small epsilon before rounding simply <i>isn&#39;t correct</i>. It will give wrong answers for numbers near the rounding boundary. For example, try <code>displayDecimal 0.5441</code> or <code>displayRounded 0.544995</code>."}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1570215192, "post_id": 58240690, "comment_id": 102855887, "body": "@DanielWagner With <code>displayDecimal</code> I just missed a zero (the delta needs to be two orders smaller than the rounding precision; corrected now), and <code>displayRounded</code> is explicitly prefixed with &quot;If you just need this for numbers with three decimal places...&quot;, so the test case of <code>0.544995</code> doesn&#39;t count."}, {"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1570215311, "post_id": 58240690, "comment_id": 102855928, "body": "Making the epsilon smaller just means the bad cases have to be closer to the rounding boundary; it doesn&#39;t actually fix the problem. If you round <code>x + e</code> instead of rounding <code>x</code>, then setting <code>x = 0.5 - e&#47;2</code> will produce a counterexample in the reals. (Admittedly this doesn&#39;t hold of <code>Double</code>; but by the time you make <code>e</code> small enough that this particular counterexample doesn&#39;t work for <code>Double</code>, you start causing yourself rounding errors for very large <code>x</code> instead.)"}, {"owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "reply_to_user": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 0, "creation_date": 1570215966, "post_id": 58240690, "comment_id": 102856110, "body": "@DanielWagner Ok, you&#39;re right, the banker&#39;s round can&#39;t be defeated by the delta. But I <i>can</i> just compensate for it as a special case."}], "tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": false, "score": 0, "last_activity_date": 1570216457, "last_edit_date": 1570216457, "creation_date": 1570209267, "answer_id": 58240690, "question_id": 58239327, "link": "https://stackoverflow.com/questions/58239327/round-a-float-to-a-specific-number-of-decimal-places/58240690#58240690", "title": "Round a float to a specific number of decimal places", "body": "<p>This happens because of the way floating-point numbers are represented in the computer: they're actually in base-2, rather than base-10 (a bit of oversimplification, but good enough). As a consequence, when you type in <code>0.545</code>, the computer actually records that as <code>0.5499999999...</code> - very close to <code>0.545</code>, but slightly smaller. And since it's smaller than <code>0.545</code>, it's no wonder it gets rounded to <code>0.54</code>.</p>\n\n<p><strong>If you really have to have exact base-10 numbers,</strong> you should use <a href=\"https://www.stackage.org/haddock/lts-14.7/Decimal-0.5.1/Data-Decimal.html\" rel=\"nofollow noreferrer\"><code>Decimal</code></a> instead of <code>Float</code> or <code>Double</code>. That package specifically takes care to represent floating-point numbers in base-10 without loss.</p>\n\n<pre><code>x :: Decimal\nx = 0.545\n\nshow x\n&gt; \"0.545\"\n</code></pre>\n\n<p>The caveat is that <code>printf</code> does not support <code>Decimal</code>, so you'd have to display it by rounding via <a href=\"https://www.stackage.org/haddock/lts-14.7/Decimal-0.5.1/Data-Decimal.html#v:roundTo\" rel=\"nofollow noreferrer\"><code>roundTo</code></a> and converting to string via <code>show</code>. Another caveat that <code>roundTo</code> does \"banker's rounding\" - if the last digit is five, it rounds to the nearest <em>even</em> digit, so we'd need to counteract that as a special case (I couldn't find a ready-to-use function that rounds by arithmetic rules):</p>\n\n<pre><code>displayDecimal :: Decimal -&gt; String\ndisplayDecimal x = show (rounded + compensate)\n    where rounded = roundTo 2 x\n          compensate = if (x - rounded) == 0.005 then 0.01 else 0\n\ndisplayDecimal 0.545\n&gt; \"0.55\"\n\ndisplayDecimal 0.5450000000001\n&gt; \"0.55\"\n\ndisplayDecimal 0.544\n&gt; \"0.54\"\n\ndisplayDecimal 0.5449999999999\n&gt; \"0.54\"\n</code></pre>\n\n<p><strong>However, if you just want this to work for numbers with three decimal places</strong>, you can get away with just adding a very small value before rounding, like <code>0.00001</code>. This value is small enough that it won't mess up your actual numbers, but large enough to compensate for the base-2 vs. base-10 discrepancy:</p>\n\n<pre><code>displayRounded :: Double -&gt; String            \ndisplayRounded x = printf \"%.2f\" (x + 0.00001)\n\ndisplayRounded 0.544\n&gt; \"0.54\"\n\ndisplayRounded 0.545\n&gt; \"0.55\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 109, "user_id": 10628180, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-7bTVQYf2k74/AAAAAAAAAAI/AAAAAAAADCM/l_PdWAySHfg/photo.jpg?sz=128", "display_name": "Osa", "link": "https://stackoverflow.com/users/10628180/osa"}, "is_accepted": true, "score": 0, "last_activity_date": 1572879390, "creation_date": 1572879390, "answer_id": 58695929, "question_id": 58239327, "link": "https://stackoverflow.com/questions/58239327/round-a-float-to-a-specific-number-of-decimal-places/58695929#58695929", "title": "Round a float to a specific number of decimal places", "body": "<p>So I didn't quite find a real solution to this, but I realised something : </p>\n\n<p>Printf already does the job, but not exactly how I wanted.\nLet's say I want to round 1.445, it will display 1.44. But if the number was 1.446, then it would have displayed 1.45.</p>\n\n<p>Not exactly what I wanted, but close enough.</p>\n"}], "owner": {"reputation": 109, "user_id": 10628180, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-7bTVQYf2k74/AAAAAAAAAAI/AAAAAAAADCM/l_PdWAySHfg/photo.jpg?sz=128", "display_name": "Osa", "link": "https://stackoverflow.com/users/10628180/osa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 709, "favorite_count": 0, "accepted_answer_id": 58695929, "answer_count": 2, "score": 0, "last_activity_date": 1573715799, "creation_date": 1570202771, "last_edit_date": 1573715799, "question_id": 58239327, "link": "https://stackoverflow.com/questions/58239327/round-a-float-to-a-specific-number-of-decimal-places", "title": "Round a float to a specific number of decimal places", "body": "<p>I'm trying to display a float but rounding it, so that</p>\n\n<pre><code>f = 5.545\n</code></pre>\n\n<p>Displays as : <code>5.55</code> while </p>\n\n<pre><code>f = 5.544 \n</code></pre>\n\n<p>displays as : <code>5.54</code></p>\n\n<p>I've seen method to display only the two first decimals, but I want to have it rounded.</p>\n\n<p>Thank you !</p>\n"}, {"tags": ["parsing", "haskell"], "answers": [{"tags": [], "owner": {"reputation": 1237, "user_id": 3416536, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/33e660f9b48e97aa96c9029e9645f15d?s=128&d=identicon&r=PG&f=1", "display_name": "user3416536", "link": "https://stackoverflow.com/users/3416536/user3416536"}, "is_accepted": false, "score": 0, "last_activity_date": 1570216423, "creation_date": 1570216423, "answer_id": 58242044, "question_id": 58239206, "link": "https://stackoverflow.com/questions/58239206/haskell-how-to-implement-data-textual-for-algebraic-sum-datatypes/58242044#58242044", "title": "Haskell: How to implement Data.Textual for algebraic (sum) datatypes", "body": "<p>So I'm pleased to say, I worked this out for myself; for the benefit of others:</p>\n\n<pre><code>textual = try (DThis &lt;$&gt; textual) &lt;|&gt; DThat &lt;$&gt; textual\n</code></pre>\n\n<p>Seems to work nicely!</p>\n"}], "owner": {"reputation": 1237, "user_id": 3416536, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/33e660f9b48e97aa96c9029e9645f15d?s=128&d=identicon&r=PG&f=1", "display_name": "user3416536", "link": "https://stackoverflow.com/users/3416536/user3416536"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 21, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1570216423, "creation_date": 1570202407, "question_id": 58239206, "link": "https://stackoverflow.com/questions/58239206/haskell-how-to-implement-data-textual-for-algebraic-sum-datatypes", "title": "Haskell: How to implement Data.Textual for algebraic (sum) datatypes", "body": "<p>I am trying to implement a <a href=\"https://hackage.haskell.org/package/data-textual-0.3.0.2/docs/Data-Textual.html#g:2\" rel=\"nofollow noreferrer\">Data.Textual</a>.Textual instance for an algebraic (sum) datatype.</p>\n\n<p>I have two datatypes: <code>This</code> and <code>That</code>.  Each individually has their own instance of <code>Textual</code> from Data.Textual.  I would like to create an new algebraic data type, ThisOrThat, being </p>\n\n<pre><code>data ThisOrThat = DThis This | DThat That\n</code></pre>\n\n<p>and an associated instance of Data.Textual.Textual, that discriminates on the first character; that is, something like</p>\n\n<pre><code>instance Textual ThisOrThat where\n  textual = if head t == '/'\n            then DThis &lt;$&gt; textual\n            else DThat &lt;$&gt; textual\n</code></pre>\n\n<p>But I have blatantly misused <code>textual</code> here, because I cannot see where to start with this one.</p>\n\n<p>I did try cobbling something together using <code>fromString</code> to try to parse a value, but that fell flat, and I feel flailing around rather.</p>\n\n<p>Thanks,</p>\n"}, {"tags": ["haskell", "heroku", "build", "limit"], "answers": [{"comments": [{"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 1, "creation_date": 1570463380, "post_id": 58260577, "comment_id": 102912757, "body": "I can confirm that this solution worked for me. It&#39;s not automatic, because I have to spend a lot of time manually first time and each time I perform a significant dependencies upgrade. But it works. And it is what it is. I will accept this answer if there will be no more convenient solutions."}], "tags": [], "owner": {"reputation": 966, "user_id": 2065432, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JLSLc.jpg?s=128&g=1", "display_name": "Mikhail Melnik", "link": "https://stackoverflow.com/users/2065432/mikhail-melnik"}, "is_accepted": true, "score": 2, "last_activity_date": 1570390098, "creation_date": 1570390098, "answer_id": 58260577, "question_id": 58238508, "link": "https://stackoverflow.com/questions/58238508/how-to-overcome-build-time-limit-for-haskell-projects-on-heroku/58260577#58260577", "title": "How to overcome build time limit for Haskell projects on Heroku?", "body": "<p>Just split dependencies in half and make a push with only part of the dependencies enabled. Then make a push with all of them enabled. The latter build will use cached dependencies from the former build. If the project is super heavy on dependencies it would probably require more than two steps though.</p>\n"}, {"comments": [{"owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "edited": false, "score": 0, "creation_date": 1570686406, "post_id": 58315017, "comment_id": 102992447, "body": "This is a solid solution. However, it doesn&#39;t work if you have different systems. Like Windows locally and Linux on a deployment service. Also, I&#39;m not sure how to upload build artefacts with heroku."}], "tags": [], "owner": {"reputation": 3796, "user_id": 5458806, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/W2bL0.jpg?s=128&g=1", "display_name": "Ahmad Mobaraki", "link": "https://stackoverflow.com/users/5458806/ahmad-mobaraki"}, "is_accepted": false, "score": 0, "last_activity_date": 1570677959, "creation_date": 1570677959, "answer_id": 58315017, "question_id": 58238508, "link": "https://stackoverflow.com/questions/58238508/how-to-overcome-build-time-limit-for-haskell-projects-on-heroku/58315017#58315017", "title": "How to overcome build time limit for Haskell projects on Heroku?", "body": "<p>I faced a similar issue with my angular project in a VPS with 1GB ram. I solved it by building the project in my local environment first and then uploading build files to the server.</p>\n"}], "owner": {"reputation": 8237, "user_id": 2900502, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/R1OjD.jpg?s=128&g=1", "display_name": "Shersh", "link": "https://stackoverflow.com/users/2900502/shersh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "accepted_answer_id": 58260577, "answer_count": 2, "score": 6, "last_activity_date": 1570677959, "creation_date": 1570199910, "question_id": 58238508, "link": "https://stackoverflow.com/questions/58238508/how-to-overcome-build-time-limit-for-haskell-projects-on-heroku", "title": "How to overcome build time limit for Haskell projects on Heroku?", "body": "<p>I'm trying to deploy Haskell application to Heroku using the following buildpack:</p>\n\n<ul>\n<li><a href=\"https://github.com/mfine/heroku-buildpack-stack\" rel=\"noreferrer\">https://github.com/mfine/heroku-buildpack-stack</a></li>\n</ul>\n\n<p>The build is going well until it hits the build time limit with the following error:</p>\n\n<pre><code>-----&gt; Timed out running buildpack Haskell\n !     Push failed\n</code></pre>\n\n<p>Is there any way to increase this limit or to speed up the build?</p>\n"}, {"tags": ["haskell", "bind", "monads", "applicative", "replicate"], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 2, "last_activity_date": 1570217263, "last_edit_date": 1570217263, "creation_date": 1570194601, "answer_id": 58237122, "question_id": 58236829, "link": "https://stackoverflow.com/questions/58236829/how-to-run-an-arbitrary-number-of-generations-in-the-bunny-invasion-problem/58237122#58237122", "title": "how to run an arbitrary number of generations in the bunny invasion problem", "body": "<p>You can make use of <a href=\"https://hackage.haskell.org/package/utility-ht-0.0.14/docs/Control-Monad-HT.html#v:nest\" rel=\"nofollow noreferrer\"><strong><code>nest :: Monad m =&gt; Int -&gt; (a -&gt; m a) -&gt; a -&gt; m a</code></strong></a>, or implement this yourself. <code>nest</code> makes use of the <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Control-Monad.html#v:foldM\" rel=\"nofollow noreferrer\"><strong><code>foldM :: (Foldable t, Monad m) =&gt; (b -&gt; a -&gt; m b) -&gt; b -&gt; t a -&gt; m b</code></strong></a>, where it is passed a list of \"units\" <code>()</code>:</p>\n\n<p><blockquote><pre><code>nest :: (Monad m) =&gt; Int -&gt; (a -&gt; m a) -&gt; a -&gt; m a\nnest n f x0 = M.foldM (\\x () -&gt; f x) x0 (List.replicate n ())</blockquote></code></pre></p>\n\n<p>this then works with:</p>\n\n<pre><code>Prelude Control.Monad.HT&gt; nest 2 generation \"bunny\"\n[\"bunny\",\"bunny\",\"bunny\",\"bunny\",\"bunny\",\"bunny\",\"bunny\",\"bunny\",\"bunny\"]\n</code></pre>\n\n<p>Note that the initial value is not a list of <code>\"bunny\"</code>, but <code>\"bunny\"</code> itself.</p>\n\n<p>We can implement a function, for example through <code>foldl</code> recursion:</p>\n\n<pre><code>foldN :: Monad m =&gt; Int -&gt; (a -&gt; m a) -&gt; m a -&gt; m a\nfoldN n x0 = foldl (&gt;&gt;=) x0 . replicate n\n</code></pre>\n\n<p>We then obtain:</p>\n\n<pre><code>Prelude Control.Monad&gt; foldN 2 [\"bunny\"] generation\n[\"bunny\",\"bunny\",\"bunny\",\"bunny\",\"bunny\",\"bunny\",\"bunny\",\"bunny\",\"bunny\"]\n</code></pre>\n\n<p>we can, like <a href=\"https://stackoverflow.com/questions/58236829/how-to-run-an-arbitrary-number-of-generations-in-the-bunny-invasion-problem/58237122?noredirect=1#comment102856074_58237122\">@DanielWagner says</a>, define this with recursion with:</p>\n\n<pre><code>import Control.Monad(&gt;=&gt;)\n\nmanyGenerations :: Integral n =&gt; n -&gt; [a] -&gt; [a]\nmanyGenerations 0 = id\nmanyGenerations n = generation &gt;=&gt; manyGenerations (n-1)\n</code></pre>\n"}], "owner": {"reputation": 139, "user_id": 5000941, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10101245875547528/picture?type=large", "display_name": "Joe Williamson", "link": "https://stackoverflow.com/users/5000941/joe-williamson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 58237122, "answer_count": 1, "score": 1, "last_activity_date": 1570217263, "creation_date": 1570193514, "question_id": 58236829, "link": "https://stackoverflow.com/questions/58236829/how-to-run-an-arbitrary-number-of-generations-in-the-bunny-invasion-problem", "title": "how to run an arbitrary number of generations in the bunny invasion problem", "body": "<p>I'm working through a problem in the haskell wikibook and am totally stuck. They ask to \"Generalize the bunny invasion example in the list monad chapter for an arbitrary number of generations.\"</p>\n\n<p>The description of the bunny invasion example:</p>\n\n<p>\"It is easy to incorporate the familiar list processing functions in monadic code. Consider this example: rabbits raise an average of six kits in each litter, half of which will be female. Starting with a single mother, we can model the number of female kits in each successive generation (i.e. the number of new kits after the rabbits grow up and have their own litters):\"   </p>\n\n<pre><code>Prelude&gt; let generation = replicate 3\nPrelude&gt; [\"bunny\"] &gt;&gt;= generation\n[\"bunny\",\"bunny\",\"bunny\"]\nPrelude&gt; [\"bunny\"] &gt;&gt;= generation &gt;&gt;= generation\n[\"bunny\",\"bunny\",\"bunny\",\"bunny\",\"bunny\",\"bunny\",\"bunny\",\"bunny\",\"bunny\"]\n</code></pre>\n\n<p>My attempt generates nested lists instead of a flat list</p>\n\n<p>There are functions mentioned in the chapter which i guess I'm supposed to use including: sequence, replicate, replicateM, mapM, forM and their underscore versions which do not pass the context to the next bound monad.</p>\n\n<pre><code>[\"bunny\"] &gt;&gt;= replicateM 2 gen\n</code></pre>\n\n<p>I get </p>\n\n<pre><code>[[\"bunny\",\"bunny\",\"bunny\"],[\"bunny\",\"bunny\",\"bunny\"]]\n</code></pre>\n\n<p>but it should be </p>\n\n<pre><code>[\"bunny\",\"bunny\",\"bunny\",\"bunny\",\"bunny\",\"bunny\",\"bunny\",\"bunny\",\"bunny\"]\n</code></pre>\n"}, {"tags": ["string", "parsing", "haskell", "abstract-syntax-tree"], "comments": [{"owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "reply_to_user": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "edited": false, "score": 0, "creation_date": 1570173987, "post_id": 58231414, "comment_id": 102837371, "body": "@n.m. good point.  Vpe, can you clarify what an input string in this language is supposed to look like?"}, {"owner": {"reputation": 94553, "user_id": 775806, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/XNd2C.png?s=128&g=1", "display_name": "n. &#39;pronouns&#39; m.", "link": "https://stackoverflow.com/users/775806/n-pronouns-m"}, "reply_to_user": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "edited": false, "score": 0, "creation_date": 1570176064, "post_id": 58231414, "comment_id": 102838236, "body": "@luqui apparently it is indeed supposed to be the prefix Polish notation. Weird. It&#39;s a very easy language to parse but not the easiest one to use."}, {"owner": {"reputation": 37, "user_id": 12057972, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-eSHK37NWs6w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfSfwtRJhBDGxP7WPqr2muWATA_RQ/photo.jpg?sz=128", "display_name": "Vpe", "link": "https://stackoverflow.com/users/12057972/vpe"}, "edited": false, "score": 0, "creation_date": 1570178938, "post_id": 58231414, "comment_id": 102839432, "body": "sorry for being unclear. The input could for example  look like &quot;+ 5 6&quot;, so yes I suppose it is the prefix Polish notation. I did not know the term if it, so thank you :)"}], "answers": [{"tags": [], "owner": {"reputation": 57219, "user_id": 33796, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/08727b23ba62e634b32988cdff082663?s=128&d=identicon&r=PG", "display_name": "luqui", "link": "https://stackoverflow.com/users/33796/luqui"}, "is_accepted": true, "score": 6, "last_activity_date": 1570174122, "last_edit_date": 1570174122, "creation_date": 1570173221, "answer_id": 58231595, "question_id": 58231414, "link": "https://stackoverflow.com/questions/58231414/parsing-function-in-haskell-trouble-making-a-map-function/58231595#58231595", "title": "Parsing function in Haskell, trouble making a map function", "body": "<p><code>parseEx</code> can only return <em>two</em> things, as per the type signature, so</p>\n\n<pre><code>let (ast, ast', ss') = parseEx ...\n</code></pre>\n\n<p>doesn't make sense.  You need to <em>chain</em> the <code>let</code>s -- that is, feed a variable bound in one to the input of the next parse:</p>\n\n<pre><code>let (ast, ss') = parseEx ss\n    (ast', ss'') = parseEx ss'\nin ...\n</code></pre>\n\n<p>(Make sure to align the clauses of the let, this matters in Haskell!)</p>\n\n<p>Notice how we have passed <code>ss'</code>, the remainder from the first parse, as the input to the second.  This says \"parse an <code>AST</code> from <code>ss</code>, and give me back the remainder of the string in <code>ss'</code>; and <em>in that remainder</em>, parse another <code>AST</code>\".</p>\n\n<p>Think carefully about what remainder you will return after parsing a complete <code>+</code>-expression.</p>\n\n<p>Also, since this function is fairly involved, I suggest to develop it you sprinkle <code>undefined</code> around in order to get it to type check little by little.  For example, start with</p>\n\n<pre><code>parseEx :: [String] -&gt; (Ast, [String])\nparseEx [] = error \"empty string\"\nparseEx (s:ss) | all isDigit s = (Tall (read s), ss)\n               | otherwise     = undefined\n</code></pre>\n\n<p>compile it, (fix it), and test it in <code>ghci</code> (interpreting the results may require a bit of nuance understanding <code>undefined</code> and laziness -- but it will also build this intuition).  Then do the next clause, compile, test, rinse and repeat.</p>\n"}, {"comments": [{"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 1, "creation_date": 1570211425, "post_id": 58239355, "comment_id": 102854506, "body": "I believe you want <code>| not (null digits) = tokDigit digits : tokenize (c : cs) []</code>, so that a non-digit character terminates a number but doesn\u2019t consume that character. E.g. <code>+1*2 3</code> will incorrectly consume <code>*</code>. Your <code>| otherwise = case c of</code> guard looks like it ought to be removed as well, or else the <code>c == \u2026</code> guards turned into <code>case</code> branches."}, {"owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "reply_to_user": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "edited": false, "score": 0, "creation_date": 1570288512, "post_id": 58239355, "comment_id": 102869761, "body": "@JonPurdy: Thanks for noticing. I did that in a hurry, it seems."}], "tags": [], "owner": {"reputation": 14543, "user_id": 235908, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/rTstt.jpg?s=128&g=1", "display_name": "Simon Shine", "link": "https://stackoverflow.com/users/235908/simon-shine"}, "is_accepted": false, "score": 1, "last_activity_date": 1570288483, "last_edit_date": 1592644375, "creation_date": 1570202894, "answer_id": 58239355, "question_id": 58231414, "link": "https://stackoverflow.com/questions/58231414/parsing-function-in-haskell-trouble-making-a-map-function/58239355#58239355", "title": "Parsing function in Haskell, trouble making a map function", "body": "<blockquote>\n<p>I am not sure how to begin on that, since it would have to be on the form <code>[String] -&gt; Ast</code>.</p>\n<p>And is it easier to simply stick with the code that I have, and try to make it work?</p>\n</blockquote>\n<p>One thing is the type signature you export, and the other is your internal implementation.</p>\n<p>You could, for example, build up your parser like so:</p>\n<pre class=\"lang-hs prettyprint-override\"><code>parseEx :: String -&gt; Ast\nparseEx s = parseTokens (tokenize s [])\n\ndata Token = TokDigit Int | TokPlus | TokMinus | TokMult\ntype DigitStack = String\n\ntokDigit :: DigitStack -&gt; Token\ntokDigit s = TokDigit (read (reverse s))\n\ntokenize :: String -&gt; DigitStack -&gt; [Token]\ntokenize [] digits =\n  if null digits\n  then []\n  else [tokDigit digits]\n\ntokenize (c:cs) digits\n  | isDigit c = tokenize cs (c:digits)\n  | not (null digits) = tokDigit digits : tokenize (c:cs) []\n  | isSpace c = tokenize cs digits\n  | otherwise = case c of\n      '+' -&gt; TokPlus : tokenize cs digits\n      '-' -&gt; TokMinus : tokenize cs digits\n      '*' -&gt; TokMult : tokenize cs digits\n      _ -&gt; error (&quot;Unknown symbol &quot; + show c)\n\nparseTokens :: [Token] -&gt;  Ast\nparseTokens (t:ts) = ...\n</code></pre>\n<p>Not that tokenizing is strictly necessary for your simple grammar, but the point is that the inner representation of your parser does not have to be restricted by the <code>[String] -&gt; Ast</code> signature. You could even use a parser combinator library like <a href=\"https://markkarpov.com/megaparsec/parsing-simple-imperative-language.html\" rel=\"nofollow noreferrer\">Megaparsec</a> and still export the function <code>[String] -&gt; Ast</code>.</p>\n"}], "owner": {"reputation": 37, "user_id": 12057972, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-eSHK37NWs6w/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rfSfwtRJhBDGxP7WPqr2muWATA_RQ/photo.jpg?sz=128", "display_name": "Vpe", "link": "https://stackoverflow.com/users/12057972/vpe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 163, "favorite_count": 0, "accepted_answer_id": 58231595, "answer_count": 2, "score": 3, "last_activity_date": 1570288483, "creation_date": 1570172474, "last_edit_date": 1570175504, "question_id": 58231414, "link": "https://stackoverflow.com/questions/58231414/parsing-function-in-haskell-trouble-making-a-map-function", "title": "Parsing function in Haskell, trouble making a map function", "body": "<p>I am new to Haskell and working on an assignment where I'm trying to make a parsing function for a simple calculator language. </p>\n\n<p>I have been given a grammar, and I am not allowed to change it. I have tried to solve it by going thru the string and using my parsing function recursively. </p>\n\n<p>The grammar is supposed to be </p>\n\n<pre><code>Expr -&gt; Int | -Expr | + Expr Expr | * Expr Expr\nInt -&gt; Digit | Digit Int \nDigit -&gt; 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9\n</code></pre>\n\n<p>So my function takes a string in the language Expr as an argument and produces an abstract syntax tree in this format </p>\n\n<pre><code>data Ast = Tall Int | Sum Ast Ast | Mult Ast Ast| Min Ast| Var String deriving (Eq, Show)\n</code></pre>\n\n<p>Ast is supposed to be an abstract syntax tree</p>\n\n<p>And this is what I have got so far in my parsing function </p>\n\n<pre><code>parseEx :: [String] -&gt; (Ast, [String])\nparseEx [] = error \"empty string\"\nparseEx (s:ss) | all isDigit s = (Tall (read s), ss)\n               | s == \"-\"      = let (ast, ss') = parseEx ss in (Min ast, ss') \n               | s == \"+\"      = let (ast, ss'), let(ast',ss'') = parseEx ss in (Sum ast ast', ss') parseEx ss' (ast', ss'')  \n               | s == \"*\"      = (Mult ast ast', ss'') where\n                   (ast, ss'')   = parseEx ss'\n                   (ast', ss''') = parseEx ss'' \n</code></pre>\n\n<p>I can see clearly that the conditional with the <code>+</code> is wrong, and that I can not have two <code>let</code>'s there. Also I am kind of lost in all of those lists. I was thinking that a <code>map</code>-function might be a solution to my problem, and maybe it would make my code look a bit more neat. But I am not sure how to begin on that, since it would have to be on the form <code>[String]-&gt;Ast</code>. And is it easier to simply stick with the code that I have, and try to make it work?</p>\n"}, {"tags": ["haskell", "dependent-type", "gadt", "data-kinds"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1570139925, "post_id": 58227012, "comment_id": 102829736, "body": "Haskell doesn&#39;t have dependent types."}, {"owner": {"reputation": 7817, "user_id": 7345298, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/9477d048c5c29b16307b3356146d497a?s=128&d=identicon&r=PG&f=1", "display_name": "bradrn", "link": "https://stackoverflow.com/users/7345298/bradrn"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 5, "creation_date": 1570140344, "post_id": 58227012, "comment_id": 102829830, "body": "To expand on @chepner\u2019s comment: You can definitely <i>simulate</i> dependent types using libraries like <code>singletons</code>, and by using various language features. However, Haskell doesn\u2019t (yet) support dependent types themselves, so even though you can get quite close to using them, you can\u2019t actually use dependent types in the same way you\u2019re trying to use them."}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 1, "creation_date": 1570141461, "post_id": 58227012, "comment_id": 102830088, "body": "The type <code>Char</code> contains no types (though it does contain many values). That is, it is currently not useful to write <code>data CharRange :: Char -&gt; Char -&gt; Type</code> (BTW, <code>*</code> is deprecated, please use <code>Type</code> from <code>Data.Kind</code>), because you can never actually construct the type <code>CharRange x y</code> for some <code>x, y :: Char</code>. <code>DataKinds</code> basically works only for ADTs, plus the (unbearably wonky, IMO) built-ins <code>Nat</code> and <code>Symbol</code>."}, {"owner": {"reputation": 7012, "user_id": 834176, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/jsN88.png?s=128&g=1", "display_name": "Keith Pinson", "link": "https://stackoverflow.com/users/834176/keith-pinson"}, "reply_to_user": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 0, "creation_date": 1570144162, "post_id": 58227012, "comment_id": 102830723, "body": "@HTNW &quot;The type <code>Char</code> contains no types (though it does contain many values)&quot;...rather, &quot;The kind <code>Char</code> contains no types (though the type <code>Char</code> does contain many values)&quot;, right?"}, {"owner": {"reputation": 22091, "user_id": 5684257, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5090cde8ea066a1fda67ed52dd5084?s=128&d=identicon&r=PG&f=1", "display_name": "HTNW", "link": "https://stackoverflow.com/users/5684257/htnw"}, "edited": false, "score": 1, "creation_date": 1570149146, "post_id": 58227012, "comment_id": 102831695, "body": "No, it&#39;s the same <code>Char</code> on both sides. Values have types. Types have types. It&#39;s a historical accident that we sometimes say the word &quot;kind&quot;, because there used to be difference, and now there isn&#39;t. <code>Char</code> is an example of a type that&#39;s full of values but devoid of types. <code>Type</code> is an example of a type that&#39;s devoid of values and full of types. Most types are the same on both sides."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1570192364, "post_id": 58227012, "comment_id": 102845858, "body": "In Haskell, when we write <code>ofChar : forall min max .  .....etc etc</code> the type-level arguments <code>min</code> and <code>max</code> are used during type-checking, and then <i>erased</i> at runtime (unlike Idris). This means that <code>ofChar</code>, at runtime, receives no information about what <code>min</code> and <code>max</code> are. To circumvent that, we usually resort to <code>singletons</code>, and write something like <code>ofChar :: forall min max . SChar min -&gt; SChar max -&gt; ....etc etc</code> where <code>SChar c</code> is a &quot;singleton&quot; type which preserves, at run-time, the information that would be lost. You&#39;ll find many examples in the <code>singletons</code> library."}, {"owner": {"reputation": 7012, "user_id": 834176, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/jsN88.png?s=128&g=1", "display_name": "Keith Pinson", "link": "https://stackoverflow.com/users/834176/keith-pinson"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1570197575, "post_id": 58227012, "comment_id": 102848535, "body": "@chi my understanding was that in Idris, they were erased as well."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1570197846, "post_id": 58227012, "comment_id": 102848685, "body": "@KeithPinson I don&#39;t know Idris very well, but if they are erased, how can <code>min &lt; c</code> be computed at runtime? That test requires to have <code>min</code> available at runtime, somewhere."}, {"owner": {"reputation": 7012, "user_id": 834176, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/jsN88.png?s=128&g=1", "display_name": "Keith Pinson", "link": "https://stackoverflow.com/users/834176/keith-pinson"}, "reply_to_user": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 0, "creation_date": 1570198071, "post_id": 58227012, "comment_id": 102848785, "body": "@chi I&#39;ve always assumed there was some kind of defunctionalization or something going on. I honestly don&#39;t know much about the implementation. But maybe I&#39;m <a href=\"https://github.com/idris-lang/Idris-dev/wiki/Egg-%232%3A-Erasure-annotations\" rel=\"nofollow noreferrer\">wrong</a>."}, {"owner": {"reputation": 100185, "user_id": 3234959, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/93bb12ca0f93dfddb33880316f7e66c2?s=128&d=identicon&r=PG&f=1", "display_name": "chi", "link": "https://stackoverflow.com/users/3234959/chi"}, "edited": false, "score": 1, "creation_date": 1570201522, "post_id": 58227012, "comment_id": 102850517, "body": "Interesting, thanks. Right now, I think that erasure in Idris can be performed in certain cases, but not always. If you explicitly use <code>min</code> in your function, I can&#39;t see how that can be erased. If <code>min</code> only appears on types as an index, and its value has no direct effect on running the code, then it can be erased, I think. &quot;Proofs&quot; can be erased, but data can not. <a href=\"https://idris.readthedocs.io/en/latest/reference/erasure.html#changes-to-idris\" rel=\"nofollow noreferrer\">This</a> clarifies a bit what Idris does, and indeed it claims it erases the &quot;things&quot; which are not &quot;being used&quot; / do not affect run-time behavior."}], "answers": [{"comments": [{"owner": {"reputation": 7012, "user_id": 834176, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/jsN88.png?s=128&g=1", "display_name": "Keith Pinson", "link": "https://stackoverflow.com/users/834176/keith-pinson"}, "edited": false, "score": 0, "creation_date": 1570197703, "post_id": 58237260, "comment_id": 102848600, "body": "Appreciate both the option and the &quot;not convinced it is worth the trouble&quot;."}], "tags": [], "owner": {"reputation": 11001, "user_id": 727667, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2e2cbd3a202d8d1cfe0cc2a9fff86733?s=128&d=identicon&r=PG", "display_name": "gallais", "link": "https://stackoverflow.com/users/727667/gallais"}, "is_accepted": true, "score": 1, "last_activity_date": 1570197654, "last_edit_date": 1570197654, "creation_date": 1570195180, "answer_id": 58237260, "question_id": 58227012, "link": "https://stackoverflow.com/questions/58227012/pull-type-level-value-out-of-dependent-type-using-type-level-bindings-at-value-l/58237260#58237260", "title": "Pull type-level value out of dependent type/using type-level bindings at value-level", "body": "<p>One possibility (however I am not convinced it is worth the trouble) is to index your <code>CharRange</code> with <code>Nat</code>ural numbers rather than the <code>Char</code> they encode.</p>\n\n<p>This way you get use <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/GHC-TypeNats.html\" rel=\"nofollow noreferrer\"><code>GHC.TypeNats</code></a> to gain the ability to obtain a copy of these type levels bounds.</p>\n\n<p>The worked out solution goes something like this:</p>\n\n<pre><code>{-# LANGUAGE GADTs #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE DataKinds #-}\n{-# LANGUAGE TypeApplications #-}\n{-# LANGUAGE ScopedTypeVariables #-}\n\nmodule Ranged (CharRange, ofChar, asChar) where\n\nimport GHC.TypeNats\nimport Data.Char\nimport Data.Proxy\n\ndata CharRange :: Nat -&gt; Nat -&gt; * where\n  C :: Char -&gt; CharRange min max\n\nofChar :: forall min max. (KnownNat min, KnownNat max)\n       =&gt; Char -&gt; CharRange min max\nofChar c =\n  let min = fromIntegral $ natVal (Proxy :: Proxy min) in\n  let max = fromIntegral $ natVal (Proxy :: Proxy max) in\n  if min &lt;= fromEnum c &amp;&amp; fromEnum c &lt;= max\n  then C c\n  else C (toEnum min)\n\nasChar :: forall min max. (KnownNat min, KnownNat max)\n       =&gt; CharRange min max -&gt; Char\nasChar (C c) =\n  let min = fromIntegral $ natVal (Proxy :: Proxy min) in\n  let max = fromIntegral $ natVal (Proxy :: Proxy max) in\n  if min &lt;= fromEnum c &amp;&amp; fromEnum c &lt;= max\n  then c\n  else toEnum min\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4369, "user_id": 3102935, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/22985d9fffff3b76a11b1f2bccbf2f42?s=128&d=identicon&r=PG&f=1", "display_name": "WorldSEnder", "link": "https://stackoverflow.com/users/3102935/worldsender"}, "is_accepted": false, "score": 1, "last_activity_date": 1571906405, "creation_date": 1571906405, "answer_id": 58537459, "question_id": 58227012, "link": "https://stackoverflow.com/questions/58227012/pull-type-level-value-out-of-dependent-type-using-type-level-bindings-at-value-l/58537459#58537459", "title": "Pull type-level value out of dependent type/using type-level bindings at value-level", "body": "<p>If you do not want to do any fancy arithmetic on the bounds, but use them as configurable constants, enforcing an invariant throughout a computation, you can also use the reflection package.</p>\n\n<p>The upside is that your constants do not have to be known at compile time. Have a look at the documentation for the <a href=\"https://hackage.haskell.org/package/reflection-2.1.5/docs/Data-Reflection.html\" rel=\"nofollow noreferrer\">reflection package</a> to learn more. For example, there is an instance <code>KnownNat n =&gt; Reifies (n :: Nat) Integer</code> so there is some interoperability (in one direction, at least), e.g. using <code>reifyNat</code> instead of <code>reify</code> to configure your terms.</p>\n\n<pre><code>{-# LANGUAGE ScopedTypeVariables, TypeApplications, FlexibleContexts -#}\n{-# LANGUAGE AllowAmbiguousTypes #-}\nimport Data.Reflection\nimport Data.Char\nimport Data.Proxy\n\nnewtype CharRange min max = C Char\n\n--| this is the only thing that needs AllowAmbiguousTypes, but we don't need to write\n-- Proxy everywhere. Choose your poison.\nreflect' :: forall s a. Reifies s a =&gt; a\nreflect' = reflect @s Proxy\n\nofChar :: forall min max. (Reifies min Char, Reifies max Char)\n       =&gt; Char -&gt; CharRange min max\nofChar c =\n  if reflect' @min &lt;= c &amp;&amp; c &lt;= reflect' @max\n  then C c\n  else C $ reflect' @min\n\nasChar :: forall min max. (Reifies min Char, Reifies max Char)\n       =&gt; CharRange min max -&gt; Char\nasChar (C c) =\n  if reflect' @min &lt;= c &amp;&amp; c &lt;= reflect' @max\n  then c\n  else reflect' @min\n\n-- At the toplevel, you need to configure your 'constants'.\n-- using reify you get Proxy parameters, that allows you to capture\n-- the type variable that is used to reflect the arguments back inside\n-- your computation.\n-- this might seem like a lot of code, but since it's toplevel needs only\n-- be done once.\nmain = print $ show $ reify 'a' $\n            \\(_ :: Proxy min) -&gt; reify 'z' $\n              \\(_ :: Proxy max) -&gt; asChar (ofChar @min @max '_')\n</code></pre>\n"}], "owner": {"reputation": 7012, "user_id": 834176, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/jsN88.png?s=128&g=1", "display_name": "Keith Pinson", "link": "https://stackoverflow.com/users/834176/keith-pinson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 218, "favorite_count": 1, "accepted_answer_id": 58237260, "answer_count": 2, "score": 5, "last_activity_date": 1571906405, "creation_date": 1570137485, "last_edit_date": 1570137866, "question_id": 58227012, "link": "https://stackoverflow.com/questions/58227012/pull-type-level-value-out-of-dependent-type-using-type-level-bindings-at-value-l", "title": "Pull type-level value out of dependent type/using type-level bindings at value-level", "body": "<p>When I have a dependent type in Haskell, how do I use the value stored in the type in a function? Example Haskell program that I would want to write (which <strong>does not compile</strong>, because the <code>min</code> and <code>max</code> typelevel bindings do not extend to value level):</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>{-# LANGUAGE GADTs #-}\n{-# LANGUAGE KindSignatures #-}\n{-# LANGUAGE DataKinds #-}\nmodule CharRange (CharRange, ofChar, asChar) where\n\ndata CharRange :: Char -&gt; Char -&gt; * where\n  C :: Char -&gt; CharRange min max\n\nofChar :: Char -&gt; CharRange min max\nofChar c =\n  if min &lt;= c &amp;&amp; c &lt;= max\n  then C c\n  else C min\n\nasChar :: CharRange min max -&gt; Char\nasChar (C c) =\n  if min &lt;= c &amp;&amp; c &lt;= max\n  then c\n  else min\n</code></pre>\n\n<p>I can do this in Idris:</p>\n\n<pre><code>module CharRange\n\n%default total\n%access export\n\ndata CharRange : Char -&gt; Char -&gt; Type where\n  C : Char -&gt; CharRange min max\n\nofChar : Char -&gt; CharRange min max\nofChar c =\n  if min &lt;= c &amp;&amp; c &lt;= max\n  then C c\n  else C min\n\nasChar : CharRange min max -&gt; Char\nasChar (C c) =\n  if min &lt;= c &amp;&amp; c &lt;= max\n  then c\n  else min\n</code></pre>\n\n<p>Which compiles and works as expected:</p>\n\n<pre><code>\u03bb\u03a0&gt; the (CharRange 'a' 'z') $ ofChar 'M'\nC 'a' : CharRange 'a' 'z'\n\u03bb\u03a0&gt; the (CharRange 'a' 'z') $ ofChar 'm'\nC 'm' : CharRange 'a' 'z'\n</code></pre>\n\n<p>How do I translate this Idris program to Haskell without reducing the amount of information in the type?</p>\n"}, {"tags": ["haskell", "graph", "functional-programming"], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 12151860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDzSn6OW34aHl_xg7YF7kz32Jz-b-dU3b3x6Ktl=k-s128", "display_name": "Velyyn S", "link": "https://stackoverflow.com/users/12151860/velyyn-s"}, "edited": false, "score": 0, "creation_date": 1570137215, "post_id": 58225897, "comment_id": 102828932, "body": "hmmm and if I want to keep this signature <code>addVertices :: Ord v =&gt; Graph v -&gt; [v] -&gt; Graph v</code> and do the same thing with foldr? it&#39;s possible?                                       I also tried something like this: <code>addVertices (Graph arcs labels styles) [v] = [addVertex x (Graph arcs labels styles) | x &lt;- [v]]  !!  0</code>                                                                           In my head, it should work because it returns a graph but it does not work o_O"}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 87, "user_id": 12151860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDzSn6OW34aHl_xg7YF7kz32Jz-b-dU3b3x6Ktl=k-s128", "display_name": "Velyyn S", "link": "https://stackoverflow.com/users/12151860/velyyn-s"}, "edited": false, "score": 0, "creation_date": 1570137328, "post_id": 58225897, "comment_id": 102828972, "body": "@VelyynS: you can simply keep the same signature, we here constructed a <i>more generic</i> signature. Using list comprehension here will not work, since it is in  essence just a mapping you made, and you do not use the graph you obtain after adding the first vertex, to add the second vertex to the graph."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 2, "last_activity_date": 1570134965, "last_edit_date": 1570134965, "creation_date": 1570131772, "answer_id": 58225897, "question_id": 58225776, "link": "https://stackoverflow.com/questions/58225776/understanding-simple-functions-applied-to-graphs/58225897#58225897", "title": "Understanding simple functions applied to graphs", "body": "<p>This is usually done with a \"fold\" like <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:foldr\" rel=\"nofollow noreferrer\"><strong><code>foldr :: Foldable f =&gt; (a -&gt; b -&gt; b) -&gt; b -&gt; f a -&gt; b</code></strong></a>. Indeed we can add the elements of a list of vertices (or in fact a <code>Foldable f =&gt; f</code> of items):</p>\n\n<pre><code>addVertices :: (Foldable f, Ord v) =&gt; Graph v -&gt; f v -&gt; Graph v\naddVertices g0 = foldr addVertex g0</code></pre>\n\n<p>For a list, you can see <code>foldr</code> as a way to replace the empty list <code>[]</code> with the base element <code>g0</code>, and we replace all \"cons\" <code>(:)</code> with the function <code>addVertex</code> here. So that means that for a list:</p>\n\n<pre><code>v<sub>1</sub> : v<sub>2</sub> : v<sub>3</sub> : []</code></pre>\n\n<p>or more verbose:</p>\n\n<pre><code>(:) v<sub>1</sub> ((:) v<sub>2</sub> ((:) v<sub>3</sub> []))</code></pre>\n\n<p>we will calculate the result as:</p>\n\n<pre><code>addVertex v<sub>1</sub> (addVertex v<sub>2</sub> (addVertex v<sub>3</sub> g<sub>0</sub>))</code></pre>\n\n<p>and thus each time add one vertex to the graph.</p>\n\n<p>We can use <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:foldl\" rel=\"nofollow noreferrer\"><strong><code>foldl :: Foldable f =&gt; (b -&gt; a -&gt; b) -&gt; b -&gt; f a -&gt; b</code></strong></a> instead to pass the accumulator left-to-right:</p>\n\n<pre><code>addVertices :: (Foldable f, Ord v) =&gt; Graph v -&gt; f v -&gt; Graph v\naddVertices g0 = foldl (flip addVertex) g0</code></pre>\n\n<p>Then we will fold the list as:</p>\n\n<pre><code>addVertex v<sub>3</sub> (addVertex v<sub>2</sub> (addVertex v<sub>1</sub> g<sub>0</sub>))</code></pre>\n\n<p>Since we use a <code>Foldable</code> here, we can add the vertices in all sorts of data structures, like <code>Maybe v</code>, <code>[v]</code>, <code>Tree v</code>, etc.</p>\n\n<p>We can here use an &eta;-reduction, and implement the functions as:</p>\n\n<pre><code>addVertices1 :: (Foldable f, Ord v) =&gt; Graph v -&gt; f v -&gt; Graph v\naddVertices1 = foldr addVertex\n\naddVertices2 :: (Foldable f, Ord v) =&gt; Graph v -&gt; f v -&gt; Graph v\naddVertices2 = foldl (flip addVertex)</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 12151860, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mDzSn6OW34aHl_xg7YF7kz32Jz-b-dU3b3x6Ktl=k-s128", "display_name": "Velyyn S", "link": "https://stackoverflow.com/users/12151860/velyyn-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 58225897, "answer_count": 1, "score": 1, "last_activity_date": 1570171899, "creation_date": 1570131212, "last_edit_date": 1570171899, "question_id": 58225776, "link": "https://stackoverflow.com/questions/58225776/understanding-simple-functions-applied-to-graphs", "title": "Understanding simple functions applied to graphs", "body": "<p>I have a question about how to manipulate a function in Haskell. I have this graph:</p>\n\n<pre><code>import Data.Map (Map,empty,member,insert)\nimport Graphviz\n-- | A directed graph\ndata Graph v = Graph\n    { arcsMap :: Map v [v]     -- A map associating a vertex with its successors\n    , labelMap :: Map v String -- The Graphviz label of each node\n    , styleMap :: Map v String -- The Graphviz style of each node\n    }deriving (Show,Eq, Ord)\n</code></pre>\n\n<p>And I have those functions</p>\n\n<pre><code>-- | Adds a vertex to a graph\naddVertex :: Ord v =&gt; v -&gt; Graph v -&gt; Graph v\naddVertex _ (Graph arcs labels styles)= (Graph arcs labels styles)\naddVertex v (Graph arcs labels styles) = Graph (insert v [] arcs) labels styles\n</code></pre>\n\n<pre><code>-- | Adds vertices to a graph\naddVertices :: Ord v =&gt; Graph v -&gt; [v] -&gt; Graph v\naddVertices (Graph arcs labels styles) [v] = map addVertex [v]\n</code></pre>\n\n<p>My problem is that I try to send all the vertices of my list to my <code>addVertex</code> function using <code>map</code>. But I do not know how to write it correctly (maybe I'm completely wrong and the map function is a very bad idea).</p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 0, "creation_date": 1570129646, "post_id": 58225425, "comment_id": 102825948, "body": "That&#39;s intentional; not all arguments will correspond to a triangle, hence the return type of <code>Maybe Float</code> instead of <code>Float</code>."}, {"owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 9, "creation_date": 1570129698, "post_id": 58225425, "comment_id": 102825971, "body": "The &quot;otherwise&quot; case should return <code>Nothing</code> instead of calling <code>error</code>, though."}, {"owner": {"reputation": 25, "user_id": 12161047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cdbe4c94e7c0057611675acbb5afd19?s=128&d=identicon&r=PG&f=1", "display_name": "hanzn98", "link": "https://stackoverflow.com/users/12161047/hanzn98"}, "reply_to_user": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "edited": false, "score": 1, "creation_date": 1570129873, "post_id": 58225425, "comment_id": 102826038, "body": ", as part of the task, we must return the error &quot;Not a triangle!&quot;  if it isn&#39;t valid. That&#39;s why i put maybe float there. I&#39;m not sure if I was right in doing so though."}, {"owner": {"reputation": 13772, "user_id": 379311, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c993f4f111e6ff3211ccda1b98828253?s=128&d=identicon&r=PG", "display_name": "Yann Vernier", "link": "https://stackoverflow.com/users/379311/yann-vernier"}, "edited": false, "score": 3, "creation_date": 1570130271, "post_id": 58225425, "comment_id": 102826176, "body": "It is redundant; <code>error</code> causes an <a href=\"https://wiki.haskell.org/Exception\" rel=\"nofollow noreferrer\">exception</a>, while <code>Maybe</code> offers a functional approach to the same dichotomy. <code>Either</code> is sometimes used to provide information with the failure case."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "edited": false, "score": 4, "creation_date": 1570130498, "post_id": 58225425, "comment_id": 102826288, "body": "One usually either uses a <code>Maybe ...</code> and returns a <code>Just x</code> or a <code>Nothing</code>; <i>or</i>, one returns a value or an error, but not the two combined."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 12161047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cdbe4c94e7c0057611675acbb5afd19?s=128&d=identicon&r=PG&f=1", "display_name": "hanzn98", "link": "https://stackoverflow.com/users/12161047/hanzn98"}, "edited": false, "score": 0, "creation_date": 1570130502, "post_id": 58225514, "comment_id": 102826291, "body": "Thank you, I understand it a lot better now! :)"}], "tags": [], "owner": {"reputation": 6633, "user_id": 392025, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7ac8fa292707d21768f9ebe17de4b523?s=128&d=identicon&r=PG", "display_name": "Aurel B&#237;l&#253;", "link": "https://stackoverflow.com/users/392025/aurel-b%c3%adl%c3%bd"}, "is_accepted": false, "score": 3, "last_activity_date": 1570130067, "creation_date": 1570130067, "answer_id": 58225514, "question_id": 58225425, "link": "https://stackoverflow.com/questions/58225425/remove-just-from-just-0-631-when-printing-a-float/58225514#58225514", "title": "Remove &quot;Just&quot; from &quot;Just 0.631&quot; when printing a float", "body": "<pre class=\"lang-hs prettyprint-override\"><code>triangleArea :: Float -&gt; Float -&gt; Float -&gt; Maybe Float\n</code></pre>\n\n<p>This line declares that <code>triangleArea</code> will be a function that takes 3 <code>Float</code> numbers, and returns a <code>Maybe Float</code>. A <code>Maybe</code> of anything is simply a type in Haskell that can have be <code>Nothing</code>, indicating the absence of a value, or <code>Just x</code> indicating that there is a value and it is <code>x</code>.</p>\n\n<p>This is why in your function you have:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>(condition) = Just (sqrt(s*(s-a)*(s-b)*(s-c)))\n</code></pre>\n\n<p>What is important is that the <code>(condition)</code> is when there <em>will</em> be a value.</p>\n\n<p>The <code>otherwise</code> part is a bit stranger \u2013 you probably don't want it to throw an <code>error</code> at all. Instead, you can indicate that there is no value (area) for the given parameters, by using <code>Nothing</code> as a result:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>triangleArea :: Float -&gt; Float -&gt; Float -&gt; Maybe Float\ntriangleArea a b c\n  | a + b &gt;= c &amp;&amp; b + c &gt;= a &amp;&amp; a + c &gt;= b = Just (sqrt (s * (s - a) * (s - b) * (s - c)))\n  | otherwise = Nothing\n  where\n    s=(a+b+c)/2\n</code></pre>\n\n<p>Alternatively, the function could have been declared as simply returning <code>Float</code>, and throwing an error when given invalid parameters. Make sure to read carefully what the tasks asks you to do, whether you can change the signature, and if so, document what the function does (typical requirement in courseworks/introductory assignments).</p>\n"}, {"comments": [{"owner": {"reputation": 25, "user_id": 12161047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cdbe4c94e7c0057611675acbb5afd19?s=128&d=identicon&r=PG&f=1", "display_name": "hanzn98", "link": "https://stackoverflow.com/users/12161047/hanzn98"}, "edited": false, "score": 0, "creation_date": 1570130471, "post_id": 58225526, "comment_id": 102826273, "body": "Thank you, we had to return error &quot;not a triangle&quot; if it didnt correspond to a traingle. What would be the reccomended approach?"}, {"owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "reply_to_user": {"reputation": 25, "user_id": 12161047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cdbe4c94e7c0057611675acbb5afd19?s=128&d=identicon&r=PG&f=1", "display_name": "hanzn98", "link": "https://stackoverflow.com/users/12161047/hanzn98"}, "edited": false, "score": 1, "creation_date": 1570168033, "post_id": 58225526, "comment_id": 102835242, "body": "@hanzn98: If your assignment indicates to use <code>error</code>, then simply omit <code>Maybe</code> and <code>Just</code>. It\u2019s generally better to avoid <code>error</code> in a larger codebase, because it doesn\u2019t have the benefit of using types to enforce explicit error handling. The typical approach is to use <code>Maybe</code> if there\u2019s a single possible error, or <code>Either</code> if there are multiple\u2014e.g., <code>Either String Float</code> (or <code>Either ShapeError Float</code> with some structured data type <code>data ShapeError = InvalidTriangle</code>), with <code>Right area</code> for success and <code>Left &quot;not a triangle&quot;</code> (resp. <code>Left InvalidTriangle</code>) for failure."}], "tags": [], "owner": {"reputation": 384463, "user_id": 1126841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa05233b2357f8d11c22ef4cfc7bb85c?s=128&d=identicon&r=PG", "display_name": "chepner", "link": "https://stackoverflow.com/users/1126841/chepner"}, "is_accepted": false, "score": 8, "last_activity_date": 1570193875, "last_edit_date": 1570193875, "creation_date": 1570130143, "answer_id": 58225526, "question_id": 58225425, "link": "https://stackoverflow.com/questions/58225425/remove-just-from-just-0-631-when-printing-a-float/58225526#58225526", "title": "Remove &quot;Just&quot; from &quot;Just 0.631&quot; when printing a float", "body": "<p>Not all sets of side lengths will correspond to a real triangle. You have two choices:</p>\n\n<ol>\n<li><p>Define a <em>partial</em> function that returns a <code>Float</code>, and call <code>error</code> to signal an invalid set of lengths. This is <strong>not</strong> the recommended approach in Haskell, though.</p>\n\n<pre><code>triangleArea :: Float -&gt; Float -&gt; Float -&gt; Float\ntriangleArea a b c | a + b &gt;= c &amp;&amp; a + c &gt;= b &amp;&amp; a + c &gt;= b = area                           \n                   | otherwise = error \"Not a triangle!\"\n  where s = (a + b + c) / 2\n        area = sqrt $ s*(s-a)*(s-b)*(s-c)\n</code></pre></li>\n<li><p>Recommended: use <code>Maybe Float</code> as the return type, and return <code>Nothing</code> when the arguments don't define a triangle.</p>\n\n<pre><code>triangleArea :: Float -&gt; Float -&gt; Float -&gt; Maybe Float\ntriangleArea a b c | a + b &gt;= c &amp;&amp; a + c &gt;= b &amp;&amp; a + c &gt;= b = Just area\n                   | otherwise = Nothing\n  where s = (a + b + c) / 2\n        area = sqrt $ s*(s-a)*(s-b)*(s-c)\n</code></pre>\n\n<p>This forces anyone calling <code>triangleArea</code> to deal with the possibility of an undefined triangle, rather than simply crashing the program.</p></li>\n</ol>\n\n<p>(For completeness, there are other options, namely <code>Either SomeType Float</code>, but they are generalizations of #2, where you can provide more specific \"error\" values than just <code>Nothing</code>.)</p>\n"}], "owner": {"reputation": 25, "user_id": 12161047, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cdbe4c94e7c0057611675acbb5afd19?s=128&d=identicon&r=PG&f=1", "display_name": "hanzn98", "link": "https://stackoverflow.com/users/12161047/hanzn98"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1570193875, "creation_date": 1570129511, "last_edit_date": 1570171880, "question_id": 58225425, "link": "https://stackoverflow.com/questions/58225425/remove-just-from-just-0-631-when-printing-a-float", "title": "Remove &quot;Just&quot; from &quot;Just 0.631&quot; when printing a float", "body": "<p>I'm new to Haskell and I was given a task to return the area of a valid triangle. However whenever is run my code it prints <code>Just &lt;float&gt;</code>. i.e <code>Just 0.631</code>. Here is my code:</p>\n\n<pre><code>triangleArea :: Float -&gt; Float -&gt; Float -&gt; Maybe Float\n\ntriangleArea a b c\n  | a+b&gt;=c &amp;&amp; b+c&gt;=a &amp;&amp; a+c&gt;=b = Just (sqrt(s*(s-a)*(s-b)*(s-c)))\n  | otherwise = error \"Not a triangle!\"\n  where\n    s=(a+b+c)/2\n</code></pre>\n"}, {"tags": ["haskell", "amazon-s3"], "answers": [{"tags": [], "owner": {"reputation": 608, "user_id": 4417894, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/b167616728ad1b28658665b14863fc99?s=128&d=identicon&r=PG&f=1", "display_name": "emg184", "link": "https://stackoverflow.com/users/4417894/emg184"}, "is_accepted": false, "score": 1, "last_activity_date": 1570157375, "creation_date": 1570157375, "answer_id": 58229295, "question_id": 58225056, "link": "https://stackoverflow.com/questions/58225056/how-to-get-signed-put-object-url-with-amazonka/58229295#58229295", "title": "How to get signed put object url with Amazonka", "body": "<p>The issue was based on not setting the Region inside of the Env variable you can generate signed URL's with the following:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>getPresignedURL :: Region\n                -&gt; BucketName\n                -&gt; ObjectKey\n                -&gt; IO ByteString\ngetPresignedURL r b k = do\n    lgr &lt;- newLogger Trace stdout\n    env &lt;- newEnv $ FromKeys (AccessKey $ encodeUtf8 $ aKeyE) (SecretKey $ encodeUtf8 $ sKeyE)\n    let nEnv = env &amp; envRegion .~ r\n    ts  &lt;- getCurrentTime \n    runResourceT . runAWST nEnv $ presignURL ts 900 (putObject b k \"Content-Type=image/jpeg\")\n</code></pre>\n\n<p>Im not very familiar with lenses so i am sure there is a more succinct way to do the following:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>    env &lt;- newEnv $ FromKeys (AccessKey $ encodeUtf8 $ aKeyE) (SecretKey $ encodeUtf8 $ sKeyE)\n    let nEnv = env &amp; envRegion .~ r\n</code></pre>\n"}], "owner": {"reputation": 608, "user_id": 4417894, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/b167616728ad1b28658665b14863fc99?s=128&d=identicon&r=PG&f=1", "display_name": "emg184", "link": "https://stackoverflow.com/users/4417894/emg184"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 142, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1570157375, "creation_date": 1570127716, "last_edit_date": 1570130219, "question_id": 58225056, "link": "https://stackoverflow.com/questions/58225056/how-to-get-signed-put-object-url-with-amazonka", "title": "How to get signed put object url with Amazonka", "body": "<p>I am trying to get a presigned url to PUT an object to my s3 bucket. I know the bucket configuration is fine as I've used it for this many times with node and have had no issues. I am currently trying to convert my upload endpoint over to a haskell endpoint as a personal project.</p>\n\n<p>I've tried to use amazonka to egt this however i keep get error messages from AWS and i haven't been able to find a good tutorial on how this might be done. The error messages i am getting are the following:</p>\n\n<p>The bucket you are attempting to access must be addressed using the specified endpoint. Please send all future requests to this endpoint.</p>\n\n<p>I receive a url with the following:\n<a href=\"https://s3.amazonaws.com/(my-bucket-name)\" rel=\"nofollow noreferrer\">https://s3.amazonaws.com/(my-bucket-name)</a> </p>\n\n<p>So i change it to this:\n<a href=\"https://(my-bucket-name).s3.us-east-2.amazonaws.com\" rel=\"nofollow noreferrer\">https://(my-bucket-name).s3.us-east-2.amazonaws.com</a>\nAfter fixing the prefix from the above issue I get the folowing:</p>\n\n<p>Error parsing the X-Amz-Credential parameter; the region 'us-east-1' is wrong; expecting 'us-east-2'</p>\n\n<p>However I am setting my Secret Key, Access Key, and the bucket.</p>\n\n<p>Here is a reproducible example:</p>\n\n<pre class=\"lang-hs prettyprint-override\"><code>module Lib\n    ( main\n    ) where\n\nimport ClassyPrelude\nimport           Network.AWS.S3\nimport           Network.AWS.S3.PutObject\nimport           Control.Monad.Trans.AWS\nimport           Network.AWS.Data\nimport           Control.Lens\n\nbNameE :: BucketName\nbNameE = BucketName &lt;my-bucket-name&gt;\n\noKeyE :: ObjectKey\noKeyE = ObjectKey (\"101/12345-12345-12345-12345.jpg\")\n-- oKeyE = ObjectKey \"photo-106399.jpeg\"\n\nsKeyE :: Text\nsKeyE = &lt;my-bucket-secret&gt;\n\naKeyE :: Text\naKeyE = &lt;my-bucket-public&gt;\n\nmain :: IO ()\nmain = do\n  r &lt;- getPresignedURL Ohio bNameE oKeyE\n  print r\n\ngetPresignedURL :: Region\n                -&gt; BucketName\n                -&gt; ObjectKey\n                -&gt; IO ByteString\ngetPresignedURL r b k = do\n    lgr &lt;- newLogger Trace stdout\n    env &lt;- newEnv $ FromKeys (AccessKey $ encodeUtf8 $ aKeyE) (SecretKey $ encodeUtf8 $ sKeyE)\n    ts  &lt;- getCurrentTime\n    let p = (putObject b k \"\") -- &amp; poContentType .~ (Just \"Content-Type=image/jpeg\")\n    print p\n    runResourceT . runAWST env $\n        presignURL ts 900 p --(poContentType (Lens'  (Just \"Content-Type=jpeg\")))\n</code></pre>\n"}, {"tags": ["haskell", "recursion-schemes"], "answers": [{"tags": [], "owner": {"reputation": 431, "user_id": 3042847, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20812bf59589551344aeae214de49f6a?s=128&d=identicon&r=PG&f=1", "display_name": "xgrommx", "link": "https://stackoverflow.com/users/3042847/xgrommx"}, "is_accepted": true, "score": 1, "last_activity_date": 1571502900, "creation_date": 1571502900, "answer_id": 58465769, "question_id": 58224467, "link": "https://stackoverflow.com/questions/58224467/how-to-update-a-structure-with-recursion-schemes/58465769#58465769", "title": "How to update a structure with recursion schemes?", "body": "<p>Recursion schemes is flexible approach. You can also implement your own variant.</p>\n\n<p>(Reuse <code>cata</code>)</p>\n\n<pre><code>zipo :: (Recursive g, Recursive h) =&gt; (Base g (h -&gt; c) -&gt; Base h h -&gt; c) -&gt; g -&gt; h -&gt; c\nzipo alg = cata zalg\n where\n  zalg x = alg x &lt;&lt;&lt; project\n\nupdate :: forall a. [a] -&gt; Natural -&gt; a -&gt; [a] \nupdate xs n a = zipo alg n xs \n  where\n    alg :: Maybe ([a] -&gt; [a]) -&gt; ListF a [a] -&gt; [a]\n    alg _ Nil = []\n    alg Nothing (Cons y ys) = a:ys\n    alg (Just n') (Cons y ys) = y:(n' ys)\n</code></pre>\n\n<p>Also u can implement some parallel version like</p>\n\n<pre><code>zipCata :: (Recursive g, Recursive h) =&gt; ((g -&gt; h -&gt; r) -&gt; Base g g -&gt; Base h h -&gt; r) -&gt; g -&gt; h -&gt; r\nzipCata phi x y = phi (zipCata phi) (project x) (project y)\n\nupdate' :: forall a. [a] -&gt; Natural -&gt; a -&gt; [a]    \nupdate' xs n a = zipCata alg n xs \n  where\n    alg :: (Natural -&gt; [a] -&gt; [a]) -&gt; Maybe Natural -&gt; ListF a [a] -&gt; [a]\n    alg _ _ Nil = []\n    alg _ Nothing (Cons _ ys) = a:ys\n    alg f (Just n) (Cons y ys) = y:(f n ys)\n</code></pre>\n\n<p>Both variants (also as your) will be get the same result</p>\n\n<p>PS. I hate approach for code sample on SO </p>\n"}], "owner": {"reputation": 380, "user_id": 1635672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdd0c9e0a1fd1b3f1bb3e1184eb01b64?s=128&d=identicon&r=PG", "display_name": "Zhu Jinxuan", "link": "https://stackoverflow.com/users/1635672/zhu-jinxuan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 58465769, "answer_count": 1, "score": 6, "last_activity_date": 1571502900, "creation_date": 1570125177, "question_id": 58224467, "link": "https://stackoverflow.com/questions/58224467/how-to-update-a-structure-with-recursion-schemes", "title": "How to update a structure with recursion schemes?", "body": "<p>In recursion schemes, how can I construct something with type definition like <code>(Recursive t, CoRecursive t) -&gt; t -&gt; ? -&gt; t</code></p>\n\n<p>I try to use recursion-schemes to update nodes.  Taking list as an example, I can come up with two methods like:</p>\n\n<pre><code>update :: [a] -&gt; Natural -&gt; a -&gt; [a]\nupdate = para palg where\n  palg Nil _ _ = []\n  palg (Cons a (u, _)) 0 b = b : u\n  palg (Cons a (u, f)) n b = a : f (n-1) b\n\nupdate' :: [a] -&gt; Natural -&gt; a -&gt; [a]\nupdate' = c2 (apo acoalg) where\n  c2 f a b c = f (a,b,c)\n  acoalg ([], _, _) = Nil\n  acoalg (_:as , 0, b) = Cons b $ Left as\n  acoalg (a:as , n, b) = Cons a $ Right (as, n-1, b)\n</code></pre>\n\n<p>However, these two implementations are good.  In these two implementations, the constructor of <code>ListF</code> and <code>[]</code> appears in both sides of the equation.  And the definition does not appear to be unique.  Is there a better way to perform List update with recursion schemes?</p>\n"}, {"tags": ["haskell"], "answers": [{"comments": [{"owner": {"reputation": 1378, "user_id": 1788863, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/213de177dcd75280fd4212dcd7f6dced?s=128&d=identicon&r=PG&f=1", "display_name": "Flowryn", "link": "https://stackoverflow.com/users/1788863/flowryn"}, "edited": false, "score": 0, "creation_date": 1570099902, "post_id": 58217384, "comment_id": 102811174, "body": "Can you also explain why for the case *TypeInference1&gt; :t f 1.0 we obtain: f 1.0 :: Fractional a =&gt; a -&gt; a;  despite function f has been declared as f :: Num a =&gt; a -&gt; a -&gt; a ? I understand what you explained, but this aspect still keeps me confused."}, {"owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "reply_to_user": {"reputation": 1378, "user_id": 1788863, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/213de177dcd75280fd4212dcd7f6dced?s=128&d=identicon&r=PG&f=1", "display_name": "Flowryn", "link": "https://stackoverflow.com/users/1788863/flowryn"}, "edited": false, "score": 2, "creation_date": 1570100024, "post_id": 58217384, "comment_id": 102811232, "body": "Becuase <code>Fractional</code> is a subtype of <code>Num</code>, so that works. It thus derives that your parameter <code>1.0 :: Fractional b =&gt; b</code> is the same as <code>a</code> in <code>Num a =&gt; a -&gt; a -&gt; a</code> and therefore that thus the type of the result is <code>(Fractional a, Num a) =&gt; a -&gt; a</code> or more simpler <code>Fractional a =&gt; a -&gt; a</code>. Therefore <code>f 1.0</code> can only work for all types that are <code>Fractional</code>."}, {"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 3, "creation_date": 1570100385, "post_id": 58217384, "comment_id": 102811419, "body": "The basic principle with polymorphic types is that the caller of the function gets to choose what type to supply, within the constraints given in the function&#39;s type. Your original <code>f</code> can work on any numeric type, and all its arguments must be of the same type. When it is supplied with <code>1.0</code>, which can be any Fractional type, this is fine, and leads to the <code>Fractional</code> constraint, since all <code>a</code>s in <code>f</code>&#39;s definition are the same. But your second <code>f</code>, by using the <code>&#47;</code> operator, can suddenly no longer work on all numeric types. Your type signature says it can, and this is why GHC rejects it."}, {"owner": {"reputation": 1378, "user_id": 1788863, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/213de177dcd75280fd4212dcd7f6dced?s=128&d=identicon&r=PG&f=1", "display_name": "Flowryn", "link": "https://stackoverflow.com/users/1788863/flowryn"}, "edited": false, "score": 0, "creation_date": 1570101007, "post_id": 58217384, "comment_id": 102811751, "body": "Thank you all for the detailed explanations. Now I understood."}], "tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 8, "last_activity_date": 1570099159, "creation_date": 1570099159, "answer_id": 58217384, "question_id": 58217240, "link": "https://stackoverflow.com/questions/58217240/why-i-get-could-not-deduce-fractional-a-arising-from-a-use-of/58217384#58217384", "title": "Why I get: Could not deduce (Fractional a) arising from a use of \u2018/\u2019?", "body": "<p><strong>Short answer</strong>: by specifying <code>Num a =&gt; a -&gt; a -&gt; a</code> you claim that <code>f</code> can deal with <em>all</em> <code>a</code>s that are members of the <code>Num</code> typeclass, but the <code>(/)</code> can only work with types that are members of the <code>Fractional</code> typeclass.</p>\n\n<p><a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#t:Fractional\" rel=\"noreferrer\"><strong><code>Fractional</code></strong></a> is a \"sub\" typeclass of <code>Num</code>. That means that all types that are a member of <code>Fractional</code> are a member of <code>Num</code>, but this does <em>not</em> hold vice versa.</p>\n\n<p>By specifying as type for f:</p>\n\n<pre><code>f :: Num a =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>You say that <code>f</code> can deal with <em>all</em> types <code>a</code> that are members of the <code>Num</code> typeclass. But that is incorrect if you define <code>f</code> as <code>f x y = x/2 + y + 3</code>, since <code>x/2</code> means that <code>x</code> should be a type that is a member of <code>Fractional</code>. Indeed <code>(/)</code> has type <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:-47-\" rel=\"noreferrer\"><strong><code>(/) :: Fractional a =&gt; a -&gt; a -&gt; a</code></strong></a>. You thus should make <code>f</code> more restrictive, such that you can only pass values that are of type <code>a</code> with <code>a</code> a member of the <code>Fractional</code> typeclass:</p>\n\n<pre><code>f :: <b>Fractional a</b> =&gt; a -&gt; a -&gt; a\nf x y = x/2 + y + 3</code></pre>\n"}, {"tags": [], "owner": {"reputation": 14537, "user_id": 7128034, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/T8aRg.jpg?s=128&g=1", "display_name": "Dami&#225;n Rafael Lattenero", "link": "https://stackoverflow.com/users/7128034/dami%c3%a1n-rafael-lattenero"}, "is_accepted": false, "score": 2, "last_activity_date": 1570125228, "creation_date": 1570125228, "answer_id": 58224483, "question_id": 58217240, "link": "https://stackoverflow.com/questions/58217240/why-i-get-could-not-deduce-fractional-a-arising-from-a-use-of/58224483#58224483", "title": "Why I get: Could not deduce (Fractional a) arising from a use of \u2018/\u2019?", "body": "<p>Let's have in mind this <strong>kind of</strong> typeclass hierarchy:</p>\n\n<pre><code>             Num a\n             /   \\  \n            /     \\ \n           /       \\\n  (Fractional a)  (Integral a)\n      /   \\           /   \\  \n     /     \\         /     \\ \n    /       \\       /       \\\n Double   Float   Integer   Int\n</code></pre>\n\n<p>Now if you say:</p>\n\n<pre><code>f :: Num a =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>You are telling that all the <strong>functions</strong> that will be used by <code>a</code> will be from the <code>Num</code> typeclass, these here:</p>\n\n<pre><code>(+), (*), abs, signum, fromInteger, (negate | (-))\n</code></pre>\n\n<p>If you check the body of your function:</p>\n\n<pre><code>f :: Num a =&gt; a -&gt; a -&gt; a\nf x y = x/2 + y + 3\n</code></pre>\n\n<p>you are using <code>(/)</code> function, and that function belongs to the \"sub\" typeclass of <code>Num</code>, <code>Fractional</code> and <code>Fractional</code> has these functions allowed:</p>\n\n<pre><code>fromRational, (recip | (/))\n</code></pre>\n\n<blockquote>\n  <p>Conclusion: </p>\n</blockquote>\n\n<p>If you use one <strong>function</strong> that belongs from one o the bottom in the hierarchy, you are restricting the type to that level.</p>\n\n<blockquote>\n  <p>Fix</p>\n</blockquote>\n\n<p>The good thing is, if you read carefully the stack error, in some part of it says:</p>\n\n<pre><code>  Possible fix:\n    add (Fractional a) to the context of\n      the type signature for:\n</code></pre>\n\n<p>And let's try it:</p>\n\n<pre><code>f :: Fractional a =&gt; a -&gt; a -&gt; a\nf x y = x/2 + y + 3\n</code></pre>\n"}], "owner": {"reputation": 1378, "user_id": 1788863, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/213de177dcd75280fd4212dcd7f6dced?s=128&d=identicon&r=PG&f=1", "display_name": "Flowryn", "link": "https://stackoverflow.com/users/1788863/flowryn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 691, "favorite_count": 1, "accepted_answer_id": 58217384, "answer_count": 2, "score": 3, "last_activity_date": 1570125228, "creation_date": 1570098655, "question_id": 58217240, "link": "https://stackoverflow.com/questions/58217240/why-i-get-could-not-deduce-fractional-a-arising-from-a-use-of", "title": "Why I get: Could not deduce (Fractional a) arising from a use of \u2018/\u2019?", "body": "<p>I have the following code in a <em>.hs</em> file </p>\n\n<pre><code>module TypeInference1 where\nf :: Num a =&gt; a -&gt; a -&gt; a\nf x y = x + y + 3\n</code></pre>\n\n<p>Then if I check the type of <strong>f</strong>, I obtain the following result, which is ok: </p>\n\n<pre><code>*TypeInference1&gt; :t f\nf :: Num a =&gt; a -&gt; a -&gt; a\n</code></pre>\n\n<p>If I pass to <strong>f</strong> one parameter of type fractional and check its type I obtain:</p>\n\n<pre><code>*TypeInference1&gt; :t f 1.0\nf 1.0 :: Fractional a =&gt; a -&gt; a\n</code></pre>\n\n<p>But on the other hand if I change the <strong>f</strong> by setting a division operation on one of its arguments, as follows:\n<code>f x y = x/2 + y + 3</code></p>\n\n<p>I obtain the following error: </p>\n\n<pre><code>5-typeInference1.hs:4:9: error:\n    \u2022 Could not deduce (Fractional a) arising from a use of \u2018/\u2019\n      from the context: Num a\n        bound by the type signature for:\n                   f :: forall a. Num a =&gt; a -&gt; a -&gt; a\n        at 5-typeInference1.hs:3:1-25\n      Possible fix:\n        add (Fractional a) to the context of\n          the type signature for:\n            f :: forall a. Num a =&gt; a -&gt; a -&gt; a\n    \u2022 In the first argument of \u2018(+)\u2019, namely \u2018x / 2\u2019\n      In the first argument of \u2018(+)\u2019, namely \u2018x / 2 + y\u2019\n      In the expression: x / 2 + y + 3\n</code></pre>\n\n<p>Why does this happen and why the type can not be deduced when I change the function <strong>f</strong> as above? </p>\n"}, {"tags": ["list", "haskell", "tree"], "comments": [{"owner": {"reputation": 14030, "user_id": 8475054, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edbf41c4b5aecb1a949936e06368a7c2?s=128&d=identicon&r=PG&f=1", "display_name": "Robin Zigmond", "link": "https://stackoverflow.com/users/8475054/robin-zigmond"}, "edited": false, "score": 2, "creation_date": 1570098093, "post_id": 58215554, "comment_id": 102810238, "body": "I assume the type is supposed to be <code>data Tree a = Node a [Tree a]</code> with <code>a</code> in place of the unspecified type variable <code>label</code>"}], "answers": [{"tags": [], "owner": {"reputation": 314794, "user_id": 67579, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/BJXub.png?s=128&g=1", "display_name": "Willem Van Onsem", "link": "https://stackoverflow.com/users/67579/willem-van-onsem"}, "is_accepted": true, "score": 4, "last_activity_date": 1570092942, "creation_date": 1570092942, "answer_id": 58215594, "question_id": 58215554, "link": "https://stackoverflow.com/questions/58215554/labels-of-a-tree/58215594#58215594", "title": "Labels of a tree", "body": "<p>Your function <code>labels</code> has type <code>Tree a -&gt; [a]</code>. This thus means that if you construct a <code>map labels</code>, it has type <code>map labels :: [Tree a] -&gt; [[a]]</code>. You thus need to concatenate these items, such that we produce a list <code>[a]</code> instead of <code>[[a]]</code>.</p>\n\n<p>You can use <a href=\"https://hackage.haskell.org/package/base-4.12.0.0/docs/Prelude.html#v:concatMap\" rel=\"nofollow noreferrer\"><strong><code>concatMap :: Foldable f =&gt; (a -&gt; [b]) -&gt; f a -&gt; [b]</code></strong></a> instead:</p>\n\n<pre><code>labels :: Tree a -&gt; [a]\nlabels (Node label children) = label : <b>concatMap</b> labels children</code></pre>\n\n<blockquote>\n  <p>Having <code>children</code> as <code>x:xs</code> didnt help either as <code>xs</code> would still be a list of trees and not a single tree.</p>\n</blockquote>\n\n<p>Indeed, furthermore by using <code>(x:xs)</code> you will (unnecessary) restrict yourself to trees with a non-empty list of children. It is a common misconception that <code>x</code> and <code>xs</code> are \"special\" variable names in <code>(x:xs)</code>. You just pattern match on the \"cons\" data constructor <code>(:)</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 380, "user_id": 1635672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fdd0c9e0a1fd1b3f1bb3e1184eb01b64?s=128&d=identicon&r=PG", "display_name": "Zhu Jinxuan", "link": "https://stackoverflow.com/users/1635672/zhu-jinxuan"}, "is_accepted": false, "score": 1, "last_activity_date": 1570131929, "creation_date": 1570131929, "answer_id": 58225931, "question_id": 58215554, "link": "https://stackoverflow.com/questions/58215554/labels-of-a-tree/58225931#58225931", "title": "Labels of a tree", "body": "<p>You need <code>join</code> to convert <code>[[a]]</code> to <code>[a]</code>, which comes from monad laws.</p>\n\n<p>For example:</p>\n\n<pre><code>module Tree where\n\nimport Data.Functor.Foldable.TH\nimport Data.Functor.Foldable\nimport Control.Monad (join)\n\ndata Tree a = Tree a [Tree a] deriving stock Show\n\nmakeBaseFunctor ''Tree\n\nlabels :: Tree a -&gt; [a]\nlabels = cata $ \\case\n  TreeF a y -&gt; a : join y\n\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 12153461, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-v3T0oc6csTw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdJ_yKXt7W9RyNRLbo2vYpqsi3rEA/photo.jpg?sz=128", "display_name": "Aditya Subramanian", "link": "https://stackoverflow.com/users/12153461/aditya-subramanian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 96, "favorite_count": 0, "accepted_answer_id": 58215594, "answer_count": 2, "score": 2, "last_activity_date": 1570131929, "creation_date": 1570092797, "last_edit_date": 1570101797, "question_id": 58215554, "link": "https://stackoverflow.com/questions/58215554/labels-of-a-tree", "title": "Labels of a tree", "body": "<p>With the following data type </p>\n\n<pre><code>data Tree a = Node a [Tree a]\n</code></pre>\n\n<p>I would like to create the following function:</p>\n\n<pre><code>labels:: Tree a -&gt; [a]\nlabels (Node label children) = label: (map labels children)\n</code></pre>\n\n<p>but this fals as </p>\n\n<pre><code>   * Occurs check: cannot construct the infinite type: a ~ [a]\n      Expected type: [a]\n        Actual type: [[a]]\n</code></pre>\n\n<p>Having children as x:xs didnt help either as xs would still be a list of trees and not a single tree. </p>\n"}, {"tags": ["haskell"], "comments": [{"owner": {"reputation": 44013, "user_id": 1477667, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/trgKM.jpg?s=128&g=1", "display_name": "dfeuer", "link": "https://stackoverflow.com/users/1477667/dfeuer"}, "edited": false, "score": 0, "creation_date": 1570165874, "post_id": 58212109, "comment_id": 102834733, "body": "An aside: <code>streamRepeat x = let r = Cons x r in r</code>, or <code>streamRepeat x = fix (Cons x)</code>, is better because it produces a <i>cyclical</i> structure instead of one that grows without bound."}], "answers": [{"tags": [], "owner": {"reputation": 198293, "user_id": 707111, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oXZkh.jpg?s=128&g=1", "display_name": "Ry-", "link": "https://stackoverflow.com/users/707111/ry"}, "is_accepted": true, "score": 5, "last_activity_date": 1570076776, "last_edit_date": 1570076776, "creation_date": 1570076269, "answer_id": 58212244, "question_id": 58212109, "link": "https://stackoverflow.com/questions/58212109/self-referential-function-in-haskell-interleavestreams/58212244#58212244", "title": "Self-referential function in Haskell (interleaveStreams)", "body": "<p>Suppose you need only the head of <code>Cons x (Cons y (streamInterleave xs ys))</code>. The hanging implementation of <code>interleaveStreams</code> still says it needs to match both <code>Cons x xs</code> and <code>Cons y ys</code> to do that. This is enough to break some operations you\u2019d probably like to be valid, when the value that matches <code>Cons y ys</code> is a function of <code>x</code>.</p>\n\n<p>That\u2019s the case for <code>ruler = interleaveStreams (streamRepeat 0) (streamMap (+1) $ ruler)</code>! To simplify, <code>streamMap</code> doesn\u2019t change anything about this:</p>\n\n<pre><code>ruler = interleaveStreams (streamRepeat 0) ruler\n</code></pre>\n\n<p>and ignoring <code>streamRepeat</code>:</p>\n\n<pre><code>interleaveStreams (Cons y ys) = Cons 0 (Cons y (streamInterleave xs ys))\nruler = interleaveStreams ruler\n</code></pre>\n\n<p>you can see why Haskell can\u2019t figure out what <code>y</code> is.</p>\n\n<p>Another option is to use a lazy pattern:</p>\n\n<pre><code>interleaveStreams (Cons x xs) ~(Cons y ys) = Cons x (Cons y (streamInterleave xs ys))\n</code></pre>\n\n<p>Or you could give <code>ruler</code> a head start:</p>\n\n<pre><code>ruler = Cons 0 (interleaveStreams (streamMap (+1) ruler) (streamRepeat 0))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 66224, "user_id": 180286, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/tAXU2.jpg?s=128&g=1", "display_name": "Fyodor Soikin", "link": "https://stackoverflow.com/users/180286/fyodor-soikin"}, "is_accepted": false, "score": 2, "last_activity_date": 1570079470, "creation_date": 1570079470, "answer_id": 58212656, "question_id": 58212109, "link": "https://stackoverflow.com/questions/58212109/self-referential-function-in-haskell-interleavestreams/58212656#58212656", "title": "Self-referential function in Haskell (interleaveStreams)", "body": "<p>Before the body of <code>interleaveStreams</code> can be evaluated, both parameters need to be destructured.</p>\n\n<p>But when you call <code>interleaveStreams</code> from <code>ruler</code>, the second parameter is <code>ruler</code> itself.</p>\n\n<p>And so it turns out that before the body of <code>interleaveStreams</code> can be evaluated, <code>ruler</code> needs to be evaluated at least partially, at least enough to be destructured.</p>\n\n<p>But the whole body of <code>ruler</code> is a call to <code>interleaveStreams</code>, so <code>ruler</code> cannot be evaluated until <code>interleaveStreams</code> is evaluated. That's your infinite loop.</p>\n\n<p>In the alternative definition of <code>interleaveStreams</code>, you produce a <code>Cons</code> result without needing to destructure the second parameter, so evaluation can proceed.</p>\n"}], "owner": {"reputation": 129, "user_id": 11940374, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sHjkCuSC4Ig/AAAAAAAAAAI/AAAAAAAAABE/jyw9QYcSD2Y/photo.jpg?sz=128", "display_name": "Agent 008", "link": "https://stackoverflow.com/users/11940374/agent-008"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 1, "accepted_answer_id": 58212244, "answer_count": 2, "score": 3, "last_activity_date": 1570091873, "creation_date": 1570075086, "question_id": 58212109, "link": "https://stackoverflow.com/questions/58212109/self-referential-function-in-haskell-interleavestreams", "title": "Self-referential function in Haskell (interleaveStreams)", "body": "<p>My code caused some sort of infinite recursion so I decided to look through this post (OP was doing the same problem as me: implementing the ruler function on an infinite Stream):</p>\n\n<p><a href=\"https://stackoverflow.com/questions/55330709/implementing-the-ruler-function-using-streaminterleave\">Implementing the ruler function using `streamInterleave`</a></p>\n\n<p>My code looked like this:</p>\n\n<pre><code>data Stream a = Cons a (Stream a)\n\nstreamRepeat :: a -&gt; Stream a\nstreamRepeat x = Cons x (streamRepeat x)\n\ninterleaveStreams :: Stream a -&gt; Stream a -&gt; Stream a\ninterleaveStreams (Cons x xs) (Cons y ys) = Cons x (Cons y (streamInterleave xs ys))\n\nruler :: Stream Integer\nruler = interleaveStreams (streamRepeat 0) (streamMap (+1) $ ruler)\n</code></pre>\n\n<p>Now, it turns out that if I change the definition of interleaveStreams to</p>\n\n<pre><code>interleaveStreams :: Stream a -&gt; Stream a -&gt; Stream a\ninterleaveStreams (Cons x xs) ys = Cons x (interleaveStreams ys xs)\n</code></pre>\n\n<p>and leave everything else as is, there is no infinite recursion and it works properly. As far as I know, the two versions of interleaveStreams are equivalent. Why does one of them hang, while the other one works properly?</p>\n"}, {"tags": ["haskell", "polymorphism", "programming-languages", "parametric-polymorphism", "impredicativetypes"], "comments": [{"owner": {"reputation": 126897, "user_id": 791604, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/ce991df7a056248d5e4f6fc3659ba733?s=128&d=identicon&r=PG", "display_name": "Daniel Wagner", "link": "https://stackoverflow.com/users/791604/daniel-wagner"}, "edited": false, "score": 7, "creation_date": 1570066502, "post_id": 58211077, "comment_id": 102799838, "body": "By the way, in the future, you can save yourself some heartache (and me a few seconds of effort) by explicitly linking questions you have already read which do not answer your question, and explaining why they aren&#39;t answers. (This is also <a href=\"https://stackoverflow.com/help/how-to-ask\">officially recommended</a>, so this is not just a sour grapes request.)"}], "answers": [{"tags": [], "owner": {"reputation": 48938, "user_id": 246886, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/dd1ebaade6623fc538fb8af3338e730d?s=128&d=identicon&r=PG", "display_name": "Jon Purdy", "link": "https://stackoverflow.com/users/246886/jon-purdy"}, "is_accepted": false, "score": 6, "last_activity_date": 1570127310, "creation_date": 1570127310, "answer_id": 58224961, "question_id": 58211077, "link": "https://stackoverflow.com/questions/58211077/what-is-the-relationship-between-polymorphisms-rank-and-impredicativity/58224961#58224961", "title": "What is the relationship between polymorphism&#39;s rank and (im)predicativity?", "body": "<blockquote>\n  <p>Can rank-1 polymorphism be either predicative or impredicative?</p>\n</blockquote>\n\n<p>No, rank-1 polymorphism is always predicative, because any <code>forall</code> quantifiers do not appear as arguments to type constructors, that is, quantifiers are \u201cprenex\u201d.</p>\n\n<blockquote>\n  <p>Can rank-k polymorphism with k > 1 be either predicative or impredicative?</p>\n</blockquote>\n\n<p>Higher-rank polymorphism is always impredicative; the <code>RankNTypes</code> extension enables impredicative polymorphism <em>only</em> for the <code>(-&gt;)</code> constructor, that is, given a type <code>a -&gt; b</code>, <code>a</code> or <code>b</code> may be instantiated with a type containing <code>forall</code>s. We typically refer to such types as higher-rank only when <code>a</code> contains <code>forall</code>s, because (except for <code>TypeApplications</code>) <code>X -&gt; forall t. Y</code> is equivalent to <code>forall t. X -&gt; Y</code>.</p>\n\n<p>General impredicative polymorphism (with the broken <code>ImpredicativeTypes</code> extension) is not supported. For example, you can\u2019t write <code>Maybe (forall a. [a] -&gt; [a])</code>. This is essentially because it\u2019s difficult to automatically determine when to generalise and when to instantiate that quantifier. Fortunately, you can make this explicit using a <code>newtype</code> wrapper to \u201chide\u201d the impredicativity, or rather, make it clear to the compiler what you want to do about quantifiers, e.g.:</p>\n\n<pre><code>{-# LANGUAGE RankNTypes #-}\n\nnewtype ListTransform = ListTransform { unLT :: forall a. [a] -&gt; [a] }\n\nf :: Maybe ListTransform -&gt; [Int] -&gt; [Char] -&gt; ([Int], [Char])\nf Nothing is cs = (is, cs)\nf (Just (ListTransform t)) is cs = (t is, t cs)\n-- or: f (Just lt) is cs = (unLT lt is, unLT lt cs)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 156458, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/3PCjR.png?s=128&g=1", "display_name": "Tim", "link": "https://stackoverflow.com/users/156458/tim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 350, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1570127310, "creation_date": 1570064249, "last_edit_date": 1570104363, "question_id": 58211077, "link": "https://stackoverflow.com/questions/58211077/what-is-the-relationship-between-polymorphisms-rank-and-impredicativity", "title": "What is the relationship between polymorphism&#39;s rank and (im)predicativity?", "body": "<p>What is the relationship between polymorphism's rank and (im)predicativity?</p>\n\n<p>Can rank-1 polymorphism be either predicative or impredicative?</p>\n\n<p>Can rank-k polymorphism with <em><code>k &gt; 1</code></em> be either predicative or impredicative?</p>\n\n<p>My confusions come from:</p>\n\n<p>Why does <a href=\"https://en.wikipedia.org/wiki/Parametric_polymorphism\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Parametric_polymorphism</a> mention predicativity under rank-1 polymorphism? (Seems to me rank-1 implies predicativity)</p>\n\n<blockquote>\n  <p><strong>Rank-1 (prenex) polymorphism</strong>  </p>\n  \n  <p>In a prenex polymorphic system, <strong>type variables may not be instantiated with polymorphic types</strong>.[4] This is very similar to what is called \"ML-style\" or\n  \"Let-polymorphism\" (technically ML's Let-polymorphism has a few other\n  syntactic restrictions). This restriction makes the distinction\n  between polymorphic and non-polymorphic types very important; thus in\n  predicative systems polymorphic types are sometimes referred to as\n  type schemas to distinguish them from ordinary (monomorphic) types,\n  which are sometimes called monotypes. A consequence is that <strong>all\n  types can be written in a form that places all quantifiers at the\n  outermost (prenex) position</strong>. For example, consider the append\n  function described above, which has type</p>\n\n<pre><code>forall a. [a] \u00d7 [a] -&gt; [a]\n</code></pre>\n  \n  <p>In order to apply this function to a pair of lists, a type must be\n  substituted for the variable <code>a</code> in the type of the function such that\n  the type of the arguments matches up with the resulting function type.</p>\n  \n  <p>In an impredicative system, the type being substituted may be any type\n  whatsoever, including a type that is itself polymorphic; thus append\n  can be applied to pairs of lists with elements of any type\u2014even to\n  lists of polymorphic functions such as append itself. Polymorphism in\n  the language ML is predicative.<sup>[citation needed]</sup> This is because\n  predicativity, together with other restrictions, makes the type system\n  simple enough that full type inference is always possible.</p>\n  \n  <p>As a practical example, OCaml (a descendant or dialect of ML) performs\n  type inference and supports impredicative polymorphism, but in some\n  cases when impredicative polymorphism is used, the system's type\n  inference is incomplete unless some explicit type annotations are\n  provided by the programmer. </p>\n  \n  <p>...</p>\n  \n  <p><strong>Predicative polymorphism</strong></p>\n  \n  <p>In a predicative parametric polymorphic system, a type <code>\u03c4</code> containing\n  <strong>a type variable <code>\u03b1</code> may not be used in such a way that <code>\u03b1</code> is\n  instantiated to a polymorphic type</strong>. Predicative type theories include\n  Martin-L\u00f6f Type Theory and NuPRL.</p>\n</blockquote>\n\n<p><a href=\"https://wiki.haskell.org/Impredicative_types\" rel=\"nofollow noreferrer\">https://wiki.haskell.org/Impredicative_types</a> :</p>\n\n<blockquote>\n  <p>Impredicative types are an advanced form of polymorphism, to be\n  contrasted with rank-N types.</p>\n  \n  <p>Standard Haskell allows polymorphic types via the use of type\n  variables, which are understood to be universally quantified: <code>id :: a -&gt; a</code> means \"for all types <code>a</code>, <code>id</code> can take an argument and return a result of that type\". All universal quantifiers (\"for all\"s) must\n  appear at the beginning of a type.</p>\n  \n  <p>Higher-rank polymorphism (e.g. rank-N types) allows universal\n  quantifiers to appear inside function types as well. It turns out that\n  appearing to the right of function arrows is not interesting: <code>Int -&gt; forall a. a -&gt; [a]</code> is actually the same as <code>forall a. Int -&gt; a -&gt; [a]</code>.</p>\n  \n  <p>However, higher-rank polymorphism allows quantifiers to the left of\n  function arrows, too, and <code>(forall a. [a] -&gt; Int) -&gt; Int</code> really is\n  different from <code>forall a. ([a] -&gt; Int) -&gt; Int</code>.</p>\n  \n  <p>Impredicative types take this idea to its natural conclusion:\n  universal quantifiers are allowed anywhere in a type, even inside\n  normal datatypes like lists or <code>Maybe</code>.</p>\n</blockquote>\n\n<p>Thanks.</p>\n"}]